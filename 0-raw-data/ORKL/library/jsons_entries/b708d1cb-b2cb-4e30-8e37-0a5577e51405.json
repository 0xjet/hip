{
    "id": "b708d1cb-b2cb-4e30-8e37-0a5577e51405",
    "created_at": "2023-01-12T15:08:33.729174Z",
    "updated_at": "2025-03-27T02:16:26.350415Z",
    "deleted_at": null,
    "sha1_hash": "4b58d1b0033e7fe087d9d9516318ecc662a95109",
    "title": "2020-02-27 - Roaming Mantis, part V- Distributed in 2019 using SMiShing and enhanced anti-researcher techniques",
    "authors": "",
    "file_creation_date": "2022-07-18T18:22:03Z",
    "file_modification_date": "2022-07-18T18:22:03Z",
    "file_size": 1833910,
    "plain_text": "# Roaming Mantis, part V\n\n**securelist.com/roaming-mantis-part-v/96250/**\n\nAuthors\n\n[Suguru Ishimaru](https://securelist.com/author/suguru/)\n\n## Distributed in 2019 using SMiShing and enhanced anti-researcher techniques\n\nKaspersky has continued to track the Roaming Mantis campaign. The group’s attack\nmethods have improved and new targets continuously added in order to steal more funds.\nThe attackers’ focus has also shifted to techniques that avoid tracking and research: allowlist\nfor distribution, analysis environment detection and so on. We’ve also observed new\nmalware families: Fakecop (also known as SpyAgent by McAfee) and Wroba.j (also known\nas Funkybot by Fortinet).\n\n## Distribution of Wroba.g via SMiShing with impersonated brands\n\nIn 2018, the group added a distribution method for Wroba.g (aliases: Moqhao and XLoader),\nin addition to the original method of DNS hijacking. It was SMiShing using a spoofed delivery\nnotice from a logistics company. In 2019, we confirmed another new method where a\n\n\n-----\n\ndownloaded malicious APK file has an icon that impersonates a major courier company\nbrand. The spoofed brand icon is customized for the country it targets, for example, Sagawa\nExpress for Japan; Yamato Transport and FedEx for Taiwan; CJ Logistics for South Korea\nand Econt Express for Russia.\n\n_Examples of SMiShing with Android malware icons impersonating brands_\n\nIn February 2020, the attacker modified a SMiShing message from a spoofed absence\nnotification to “delivering free masks for the coronavirus issue” in Japan, according to a\nwarning by Japan Cybercrime Control Center (JC3). This once again shows that criminals\nalways make use of hot topics in their activities.\n\n## Allowlist feature of Wroba.g landing page for Korea only\n\nThe Roaming Mantis actor also employed a new feature in their Wroba.g landing page –\ncurrently only on the Korean page. It’s a allowlist feature to evade security researchers.\nWhen a user visits the landing page, they have to enter their phone number for confirmation.\nIf the phone number is on the allowlist, the landing page distributes a malicious app.apk:\n\n\n-----\n\n_The fake CJ Logistics landing page includes an allowlist_\n\nThe actor has a habit of trying out their new methods in Korean first. It means the method\ndescribed above may be applied later on landing pages in other languages as well. If that\nhappens, it would make it almost impossible for researchers to obtain a sample, because it\nwould require a specific phone number in the actor’s allowlist database.\n\n## Multidex obfuscation trick in a loader module of Wroba.g\n\nA single Dalvik Executable (DEX) has a 64K reference limit. As a workaround, a\nconfiguration of Mutidex allows the application to build and read multiple DEX files. In 2019,\nthe actor used Multidex in an APK file to hide a malicious loader module as an obfuscation\ntrick. Our analysis shows that it has been modified little by little:\n\n\n-----\n\n_Transition of obfuscation using Multidex_\n\nThe classes${num}.dex marked with a red square is the actual malicious loader module. All\nthe other DEX files are simply junk code. However, the encrypted payload of Wroba.g is still\nunder the assets directory and can be decrypted by the simple python script described in our\nprevious blogpost.\n\n## Wroba.g is targeting carrier billing and online banks in Japan\n\nThe actor has a strong financial motivation. They are targeting carrier billing and online bank\naccounts. They have implemented redirection to phishing sites to steal credentials in the\ndecrypted payload of Wroba.g:\n\n_Hardcoded pkg name, URL of pinterest.com and pop-up message_\n\n\n-----\n\nWhen the malware detects a specific package of a Japanese online bank or specific mobile\ncarriers on the infected device, it connects in the background to a hardcoded malicious\naccount of pinterest.com to fetch a phishing site with an alert message. The message claims\nthat it has blocked unauthorized access from a third party and asks the user to click on a\nbutton to confirm they want to proceed. If the user clicks the button, they will be redirected to\na phishing site:\n\n_Redirecting to a phishing site via malicious account on pinterest.com_\n\nThe targeted packages for online banks and mobile carriers correspond to the relevant\naccounts on pinterest.com that lead to phishing sites:\n\n\n**Phishing site**\n**in Dec 2019**\n\n\n**Phishing site**\n**in Jan 2020**\n\nN/A\n\nN/A\n\nN/A\n\n\n**Pkgs or mobile carrier**\n\n\n**Accounts on**\n**pinterest.com**\n\n\njp.co.japannetbank.smtapp.balance nor********** jnb.jpbankq[.]com\n\njp.co.jibunbank.jibunmain abi******** jibun.jpbankq[.]com\n\njp.co.netbk.smartkey.SSNBSmartkey sin************* sbi.jpbankq[.]com\n\n\n-----\n\njp.co.rakuten_bank.rakutenbank kel*************** rakuten.jpbankq[.]com\n\njp.co.sevenbank.AppPassbook gh6****** seven.jpbankq[.]com\n\njp.co.smbc.direct eme************* smbc.jpbankq[.]com\n\njp.japanpost.jp_bank.FIDOapp fel*************** jppost.jpbankq[.]com\n\njp.mufg.bk.applisp.app sho************* mufg.jpbankq[.]com\n\nDocomo ami*********** nttdocomouh[.]com\n\n\nN/A\n\nN/A\n\nsmbc.bksecurityo[.]com\n\nN/A\n\nN/A\n\nnttdocomoxm[.]com\n\n\nau pos*********** au-ul[.]com au-xm[.]com\n\nSoftbank ash************ epos-ua[.]com N/A\n\nAs can be seen in the table above, all the accounts have corresponding phishing sites as of\nDecember 2019 (data provided by @ninoseki on Twitter). These destination URLs are\ncontinuously changed by the attackers. In January 2020, only three of these accounts were\nenabled for some reason. However, as it’s easy for the criminals to modify the phishing page\naddress, apps without corresponding phishing sites are also likely to be attacked again in the\nnear future.\n\n## Wroba.j and Fakecop discovered in 2019\n\nRoaming Mantis has been using Wroba.g and Wroba.f as its main Android malware. In April\n2019, we observed two more malware families, Wroba.j and Fakecop. These two malware\nfamilies have some similarities with the other families in terms of infrastructure, distribution\nchannel, etc. We have created some slides, Roaming Mantis: A melting pot of Android bots\nin Botconf2019, showing the timeline, impersonated brands, malware features and money\nlaundering method.\n\nBased on our telemetry data, detection rates of both malicious programs were very low. We\nbelieve that this was a test by the attacker. However, the most alarming thing we discovered\nwas the following SMS spamming function in Wroba.j:\n\n\n-----\n\n_Generating feedback for SMS spamming results_\n\nThe function automatically creates a sophisticated list of phone numbers from the feedback\nfor SMS spamming results. This malware also has another function that checks the\nInternational Mobile Subscriber Identifier (IMSI) to identify mobile carriers in Japan and add\nthe phone number to a relevant spamming list.\n\n_Checking the IMSI of mobile carrier Docomo_\n\nAccording to the hardcoded IMSIs and strings shown below, the attacker seems to be\ntargeting Docomo and Softbank mobile carriers.\n\nIMSI of Docomo:\n\n44001 4401 44058\n\n44002 4402 4406\n\n44003 4403 44087\n\n\n-----\n\n44009 44049 44099\n\nIMSI of Softbank:\n\n44020 44021\n\n44005 44101\n\n## Conclusion\n\nThe Roaming Mantis actor is strongly motivated by financial gain and is eager to evade\ntracking by researchers. It is now employing yet another method – allowlisting – to achieve\nthis. This new method is currently only being applied for Korean pages, but it’s only a matter\nof time before it’s implemented for other languages.\n\nThe actor is still very active in using SMiShing for Android malware distribution. This is\nparticularly alarming, because it means all infected mobile devices could form a botnet for\nmalware delivery, SMiShing, and so on. ISPs, together with security companies, need to\nkeep a close eye on the Roaming Mantis campaign to understand how to combat it.\n\n## Further reading\n\nFurther information about the Fakecop and Wroba.j families has also appeared in the\nfollowing blogs published by McAfee and Fortinet respectively:\n\n[MoqHao Related Android Spyware Targeting Japan and Korea Found on Google Play](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/moqhao-related-android-spyware-targeting-japan-and-korea-found-on-google-play/)\n[FunkyBot: A New Android Malware Family Targeting Japan](https://www.fortinet.com/blog/threat-research/funkybot-malware-targets-japan.html)\n\nThese blogposts provide some interesting updates on Roaming Mantis activities during\n2019.\n\n## Example of md5 hashes for each APK\n\ne6ae4277418323810505c28d2b6b3647 Wroba.g\n\n939770e5a14129740dc57c440afbf558 Wroba.f\n\n521312a8b5a76519f9237ec500afd534 Wroba.j\n\n6d29caaa8b30cc8b454e74a75d33c902 Fakecop\n\n\n-----\n\n[Botnets](https://securelist.com/tag/botnets/)\n[Google Android](https://securelist.com/tag/google-android/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Mobile Malware](https://securelist.com/tag/mobile-malware/)\n[Phishing](https://securelist.com/tag/phishing/)\n\nAuthors\n\n[Suguru Ishimaru](https://securelist.com/author/suguru/)\n\nRoaming Mantis, part V\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-27 - Roaming Mantis, part V- Distributed in 2019 using SMiShing and enhanced anti-researcher techniques.pdf"
    ],
    "report_names": [
        "2020-02-27 - Roaming Mantis, part V- Distributed in 2019 using SMiShing and enhanced anti-researcher techniques.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9bc28d0-ce98-4991-84ae-5036e5f9d4e3",
            "created_at": "2022-10-25T16:07:24.546437Z",
            "updated_at": "2025-03-27T02:02:10.277573Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group",
                "Shaoye"
            ],
            "source_name": "ETDA:Roaming Mantis",
            "tools": [
                "MoqHao",
                "Roaming Mantis",
                "SmsSpy",
                "Wroba",
                "XLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c94cb0e9-6fa9-47e9-a286-c9c9c9b23f4a",
            "created_at": "2023-01-06T13:46:38.823793Z",
            "updated_at": "2025-03-27T02:00:02.928254Z",
            "deleted_at": null,
            "main_name": "Roaming Mantis",
            "aliases": [
                "Roaming Mantis Group"
            ],
            "source_name": "MISPGALAXY:Roaming Mantis",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536113,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1658168523,
    "ts_modification_date": 1658168523,
    "files": {
        "pdf": "https://archive.orkl.eu/4b58d1b0033e7fe087d9d9516318ecc662a95109.pdf",
        "text": "https://archive.orkl.eu/4b58d1b0033e7fe087d9d9516318ecc662a95109.txt",
        "img": "https://archive.orkl.eu/4b58d1b0033e7fe087d9d9516318ecc662a95109.jpg"
    }
}