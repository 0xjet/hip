{
    "id": "e88f7f54-aca4-4922-b13d-9ea7c1ddecce",
    "created_at": "2023-01-12T15:09:07.858481Z",
    "updated_at": "2025-03-27T02:14:39.217911Z",
    "deleted_at": null,
    "sha1_hash": "0b8ebd2b70be369c356dab7868517865c71d6f2c",
    "title": "2021-09-22 - GoSecure Titan Labs Technical Report- BluStealer Malware Threat",
    "authors": "",
    "file_creation_date": "2022-05-28T01:58:16Z",
    "file_modification_date": "2022-05-28T01:58:16Z",
    "file_size": 1866598,
    "plain_text": "# GoSecure Titan Labs Technical Report: BluStealer Malware Threat\n\n**[gosecure.net/blog/2021/09/22/gosecure-titan-labs-technical-report-blustealer-malware-threat/](https://www.gosecure.net/blog/2021/09/22/gosecure-titan-labs-technical-report-blustealer-malware-threat/)**\n\nGoSecure September 22, 2021\n\nGoSecure Titan Labs obtained a sample of the high-profile malware identified as BluStealer\n– that can steal credentials, passwords, credit card data, and more. The expert investigators\nat Titan Labs developed this detailed analysis that examines the infection vector,\ncomponents, methods of exfiltration and capabilities.\nThis sample of an optical disc image (ISO) file (01d4b90cc7c6281941483e1cccd438b2) from\nGoSecure’s Inbox Detection and Response (IDR) team embedded within the ISO file is a 32bit executable (6f7302e24899d1c05dcabbc8ec3e84d4) compiled in Visual Basic 6. The\nfollowing is an in-depth analysis of the portable executable (PE).\n\nGoSecure Titan Labs obtained a sample of the high-profile malware identified as BluStealer\n– that can steal credentials, passwords, credit card data, and more. The expert investigators\nat Titan Labs developed this detailed analysis that examines the infection vector,\ncomponents, methods of exfiltration and capabilities.\nThis sample of an optical disc image (ISO) file (01d4b90cc7c6281941483e1cccd438b2) from\nGoSecure’s Inbox Detection and Response (IDR) team embedded within the ISO file is a 32bit executable (6f7302e24899d1c05dcabbc8ec3e84d4) compiled in Visual Basic 6. The\nfollowing is an in-depth analysis of the portable executable (PE).\n\n## Analysis\n\n### 2.0.1 Infection Vector\n\nThe initial infection vector is via malspam containing links to cdn.discord.com. Using\nDiscord’s content delivery network (CDN) as a malware distribution system continues to grow\nin popularity among threat actors. The email (1010589761b3051eec33681d0513242a) in this\ncase, shown in Figure 1, purports to be from DHL Express, stating that a shipment is on the\nway and that it can be tracked or changed by clicking the link labelled here, which downloads\n\n\n-----\n\nthe malicious ISO file from hxxps://cdn[.]discordapp[.]com/attachments/\n829530662406193185/882109821736865832/Your_DHL_Shipment_Notification.pdf.iso. This\nparticular campaign does not exclusively use DHL spoofed emails, as emails spoofing other\ncompanies have also been observed dropping the same final payload.\n\nFigure 1: Malspam\n\n### 2.0.2 BluStealer’s Main Component\n\nAs displayed in Figure 2, the resource section of the PE contains data with extremely high\nentropy, indicating that it is encrypted. This, along with the large size of the resource section,\nsuggests that the PE is a loader. Examining the resource section reveals two large arrays of\nencrypted data contained within a segment of the resource section named CUSTOM.\n\n\n-----\n\nFigure 2: Packed Resource Section\nOpening the PE in x64dbg, we can see that the first instruction at the entry point is a call to\n_MSVBVM60.ThunRTMain. Executables compiled in VB6 and lower begin with a call to_\n_ThunRTMain, which takes an address as its only argument. This address points to a_\nstructure, beginning with VB5!, that contains information about the given program. At an\noffset of 45 bytes, the structure normally contains the address of aSubMain, which is the\nprogram’s main function. However, as displayed in Figure 3, the address in this instance\nconsists of only null bytes, indicating that the executable had either been obfuscated or had\nits compilation routine modified.\n\n\n-----\n\nFigure 3: Call to ThunRTMain\nOnce inside user-defined code, it can be seen that an encryption key is created with a call to\n_bcrypt.BCryptGenerateSymm etricKey. Next, an array is created that contains the hex values_\n1 through 1300. Each element of the array is allotted 16 bytes, as depicted in Figure 4.\n\nFigure 4: Initialized Array\nUsing the encryption key that was created previously, the malware encrypts the newly\ninitialized array with a call to bcrypt.BCryptEncrypt. These encrypted bytes will be used as\nXOR keys, and are shown in Figure 5.\n\n\n-----\n\nFigure 5: XOR Keys\nThe malware then loads the first array of ciphertext from its resource section into memory\nand proceeds to decrypt it. As can be observed from the decryption routine, depicted in\n_Figure 6, a byte from the ciphertext, pointed to by the address stored in the ESI register, is_\nmoved into the BL register. This value is then XORed with a XOR key, pointed to by the\naddress stored in the EAX register. The resulting value is then moved back to its original\nplace in the ciphertext array. The pointers to both the ciphertext and XOR keys are\nincremented by one and the process continues in a loop until the ciphertext is fully\ndecrypted.\n\nFigure 6: Decryption Routine\nThe decrypted ciphertext yields a PE. As shown in Figure 7, the malware loads the PE with a\ncall to user32.CallWindowProcW, with\n_C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\AppLaunch.exe as its second argument_\nand the PE’s address as its third. In this manner, the PE is executed with AppLaunch.exe,\nwhich is a Microsoft .NET launch utility. This confirms our suspicions that the malware is\nindeed a loader.\n\n\n-----\n\nFigure 7: Call to CallWindowProcW\n\n### 2.0.3 ChromeRecovery.exe Stealing Module\n\n_Figure 8 displays the loaded PE, a 32-bit .NET assembly with the internal name_\n_ChromeRecovery.exe and the MD5 hash 53e09987f7b648fb5c594734a8f7c4e4, opened in_\n_dnSpy, a .NET debugger and decompiler. ChromeRecovery.exe begins by gathering system_\ninformation, such as the computer name, username, Windows version, antivirus solution,\nCPU name, GPU name, the amount of RAM, internal IP, and external IP. This information is\nwritten to C:\\Users\\<username> \\AppData \\Roaming \\Microsoft \\Windows \\Templates\n_\\credentials.txt. It steals login credentials and credit card data from numerous web browsers,_\nsuch as Chrome, Edge, FireFox, Opera, and Yandex, by targeting the Cookies and Web\n_Data caches. It also steals login credentials from Pidgin, NordVPN, SQLite, FileZilla and_\nCoreFTP, and numerous email clients, such as Outlook, ThunderBird, and Foxmail. It\nappends all data to credentials.txt. Also depicted in Figure 8 is the format in which stolen\ncredentials are written. Contained within ChromeRecovery.exe’s resource section is a 32-bit\n.Net assembly with the internal name ConsoleApp8.exe\n(4509c33c251e8e075e4aa95001e35cdf), which is saved to the Templates directory,\nexecuted and then deleted. ConsoleApp8.exe steals credentials from Windows Vault and\nWinSCP and appends them to credentials.txt. One of our file detection signatures entitled\n_malware_blustealer_0, listed below in the Detections section, alerted on_\nChromeRecovery.exe as BluStealer. Interestingly, the malware sample that the signature\nwas based on was a 32-bit VB6-compiled executable\n(a1329dab78d5bac41e39034d840c30f1), analyzed in June of this year. Comparing both\nsamples, we found that BluStealer’s full functionality was originally contained within a single\nPE file. However, it would appear as though BluStealer’s authors have opted for a more\nmodular malware, spreading its functionality, as well as enhancing it, across multiple\nbinaries.\n\n\n-----\n\nFigure 8: ChromeRecovery.exe Credential Stealing Module\n\n### 2.0.4 ThunderFox.exe Stealing Module\n\nWhen execution is transferred back to the loader, it loads the second array of ciphertext from\nits resource section into memory and proceeds to decrypt it in the exact same manner as it\nemployed with the first one. This also results in a 32-bit .NET assembly\n(00cdcfc91db339be14f441be75e0dec7), which is also loaded with AppLaunch.exe via\n_user32.CallWindowProcW. Opening the file, internally named 5.exe, in dnSpy reveals that it_\ndecompresses the file entitled app from its resource section and reflectively loads it via a call\nto MethodBase.Invoke, as shown in Figure 9.\n\n\n-----\n\nFigure 9: 5.exe\nThe decompressed file is yet another 32-bit .NET Assembly\n(6ae510da968ebcbf5a8661c080ac12fd). Its name, Thunder-Fox.exe, is an amalgamation of\n_ThunderBird and FireFox since it targets Mozilla products, which also includes Waterfox, K-_\n_Meleon, IceDragon, Cyberfox, BlackHawK, Pale Moon. These products are also targeted by_\nChromeRecovery.exe but in a different manner. As depicted in Figure 10, ThunderFox\nextracts login credentials from logins.json, key4.db, signons.sqlite, and key3.db. logins.json\nstores encrypted passwords for Mozilla products, while key4.db is the Network Security\nServices (NSS) key database used to store Mozilla encryption data, which is required to\ndecrypt the encrypted passwords in logins.json. signons.sqlite and key3.db have the same\nfunctionality just described but are used with legacy versions of Mozilla products. The stolen\ndata is formatted the same as with ChromeRecovery and is also appended to credentials.txt.\n\n\n-----\n\nFigure 10: ThunderFox Credentials Stealing Module\n\n### 2.0.5 Exfiltration Traffic\n\nOnce ThunderFox is finished and execution is transferred back to BluStealer’s main module,\nit makes a call to winhttp.WinHttpConnect, which returns a connection handle to an HTTP\nsession. As displayed in Figure 11, the second argument, specifying the target server, is\n_api.telegram.org, which is being used as BluStealer’s C2 infrastructure._\n\nFigure 11: Call to winhttp.WinHttpConnect\nThe Final POST request and response from its C2 server can be viewed in Figure 12 and\n_Figure 13, respectively. The request’s URL begins with the BotID_\n_1901905375:AAFoPAvBxaWxmDiYbdJWH-OdsUuObDY0pjs, followed by the directory_\n\n\n-----\n\nentitled sendDocument with the arguments chat_id and caption. The value of caption is the\nname of the text document containing the stolen information, followed by the delimiter :::, and\nthe victim’s computer name and username.\n\nFigure 12: Multipart/Form-Data Credentials Exfiltration\n\nFigure 13: C2 Response\n_BluStealer sends another HTTP POST request, which unlike the first one, is not of the_\nContent-Type multipart/form-data. As observed in Figure 14, it sends the stolen data as in\nthe first request. However, the URL is different from that of the first one, as it ends in the\ndirectory sendMessage instead of sendDocument and is without arguments. Moreover, the\nvictim’s computer name and username are now contained within the text parameter and\nfollow the value Passwords. It should be noted that the network traffic from BluStealer’s June\nsample shares many similarities with the present sample. However, it is sent over Simple\nMail Transfer Protocol (SMTP) rather than HTTP.\n\n\n-----\n\nFigure 14: Credentials Exfiltration\n\n### 2.0.6 BluStealer’s Main Component’s Stealing Capabilities\n\nBesides the ability to load stealing modules and exfiltrate data, the main component also\ncomes with its own stealing capabilities. As shown in Figure 15, it makes a call to\n_msvbvm60.rtcDir, an undocumented VB runtime function that returns file names from a_\ndirectory. The directory being inquired about is Zcash, which is a cryptocurrency.\n\n\n-----\n\nFigure 15: Cryptocurreny Query\n_Figure 16 portrays all the processes, captured by Process Monitor, that query cryptocurrency_\nfolders. The cryptocurrency wallets targeted include Zcash, Armory, Bytecoin, Jaxx Liberty,\nExodus, Ethereum, Electrum, Guarda, and Coinomi.\n\nFigure 16: Cryptocurrency Wallets\n_BluStealer’s main component also has keylogging functionality, which is achieved by_\nemploying the commonly used method of polling user32.getAsyncKeyState, which\ndetermines whether a key is pressed or not at the time of the call.\n\n## Conclusion\n\nThe newly discovered threat BluStealer is equipped with a robust credential stealing tool set\nand is following the unfortunate trend of utilizing legitimate services, such as Telegram and\n_Discord, for its malware infrastructure, which makes detection increasingly challenging._\n\nBy closely monitoring, analyzing, and reverse engineering, GoSecure Titan Labs, as part of\nour MDR offering, have created signatures to detect the emerging threats discussed in this\nreport.\n\n## Indicators of Compromise\n\n**Indicators of**\n**Compromise**\n\n**Type** **Indicator** **Description**\n\nMD5 1010589761b3051eec33681d0513242a Malspam Email\n\nMD5 01d4b90cc7c6281941483e1cccd438b2 ISO File\n\n\n-----\n\nMD5 6f7302e24899d1c05dcabbc8ec3e84d4 BluStealer’s Main\nComponent\n\nMD5 53e09987f7b648fb5c594734a8f7c4e4 ChromeRecovery.exe\n\nMD5 4509c33c251e8e075e4aa95001e35cdf ConsoleApp8.exe\n\nMD5 00cdcfc91db339be14f441be75e0dec7 5.exe\n\nMD5 6ae510da968ebcbf5a8661c080ac12fd ThunderFox.exe\n\nMD5 a1329dab78d5bac41e39034d840c30f1 BluStealer June\nSample\n\n## Detection\n\nGoSecure Titan Labs are providing the following signatures to help the community in\ndetecting and identifying the threats discussed in this report.\n\n\n-----\n\n```\nalert smtp any any > $EXTERNAL_NET any (\n   msg:\"GS MALWARE BluStealer SMTP Exfiltration\";\n   content:\"Subject|3a 20|Passwords::::\"; nocase; fast_pattern;\n   content:\"\\\"; distance:0;\n   flow:to_server, established;\n   metadata:created 2021-07-02, type malware.stealer, os windows, tlp white, id 0;\nclasstype:trojan-activity;\n   sid:300001712;\n   rev:1;\n)\nalert http any any -> $EXTERNAL_NET any (\n   msg:\"GS MALWARE BluStealer HTTP Exfiltration Group 1\";\n   content:\"POST\"; http_method;\n   content:\"caption=credentials.txt:::\"; http_uri; nocase; fast_pattern;\n   flow:to_server, established;\n   metadata:created 2021-09-10, type malware.stealer, os windows, tlp white, id 1;\nclasstype:trojan-activity;\n   sid:300001775;\n   rev:1;\n)\nalert http any any -> $EXTERNAL_NET any\n   msg:\"GS MALWARE BluStealer HTTP Exfiltration Group 2\";\n   content:\"POST\"; http_method;\n   content:\"text=Passwords:::\"; http_client_body; depth:17; nocase; fast_pattern;\nflow:to_server, established;\n   metadata:created 2021-09-16, type malware.stealer, os windows, tlp white, id 2;\nclasstype:trojan-activity;\n   sid:300001776;\n   rev:1;\n)\nrule malware_other_vb5_loader_0 {\n  meta:\n   author = \"Titan Labs\"\n   company = \"GoSecure\"\n   description = \"VB5/6-based Loaders\"\n   reference = \"https://zero2auto.com/2020/06/22/unpacking-visual-basic-packers/\"\n   hash = \"6f7302e24899d1c05dcabbc8ec3e84d4\"\n   created = \"2021-09-10\"\n   os = \"windows\"\n   type = \"malware.loader\"\n   tlp = \"white\"\n   rev = 1\n  strings:\n   $obfuscated_aSubMain = { 56 42 35 21 [40] 00 00 00 00 }\n  condition:\n   uint16(0) == 0x5a4d and\n   uint32(uint32(0x3c)) == 0x00004550 and\n   math.entropy(0, filesize) >= 7.0 and\n   pe.imports(\"MSVBVM60.dll\", 100) and\n   $obfuscated_aSubMain\n}\n\n```\n\n-----\n\n```\nrule malware_blustealer_0{\n  meta:\n   author = \"Titan Labs\"\n   company = \"GoSecure\"\n   description = \"Blustealer Unpacked Infostealer\"\n   created = \"2020-06-29\"\n   type = \"malware.stealer\"\n   hash = \"a1329dab78d5bac41e39034d840c30f1\"\n   os = \"windows\"\n   tlp = \"white\"\n   rev = 1\n  strings:\n   $string1 = \"::::\" ascii wide\n   $string2 = \"CompName: \" ascii wide\n   $string3 = \" - 64-bit\" ascii wide\n   $string4 = \"=============================\" ascii wide\n   $stealer1 = \"COREFTP\" ascii wide\n   $stealer2 = \"Outlook\" ascii wide\n   $stealer3 = \"signons.sqlite\" nocase ascii wide\n   $stealer4 = \"filezilla\" nocase ascii wide\n   $stealer5 = \"nordvpn\" nocase ascii wide\n   $stealer6 = \"firefox\" nocase ascii wide\n  condition:\n   uint16(0) == 0x5a4d and\n   uint32(uint32(0x3c)) == 0x00004550 and\n   filesize < 464KB and\n   2 of ($string*) and\n   3 of ($stealer*)\n}\nrule malware_blustealer_1 {\n  meta:\n   author = \"Titan Labs\"\n   company = \"GoSecure\"\n   description = \"BluStealer Main Component\"\n   hash = \"6f7302e24899d1c05dcabbc8ec3e84d4\"\n   created = \"2021-09-10\"\n   os = \"windows\"\n   type = \"malware.stealer\"\n   tlp = \"white\"\n   rev = 1\n  strings:\n   $obfuscated_aSubMain = { 56 42 35 21 [40] 00 00 00 00 }\n   $MSVBVM60 = \"MSVBVM60.dll\" ascii wide nocase\n   $decryption_routine = { 8b [5] 8b [2] 03 [5] 0f 80 [4] 8b [5] 89 [2] 8b [5] 8b\n             [2] 3b [5] 7f ?? ff 7? ?? 8b [2] ff 3? e8 [4] 8b ?? 8b\n             [5] ff 7? ?? 8b [5] ff 7? ?? e8 [4] 8a ?? 32 ?? ff 7?\n             ?? 8b [2] ff 3? e8 [4] 88 ?? 8b [2] 83 c? ?? 0f 80 [4]\n             89 [2] eb }\n   $behavior_0 = \"https://api.telegram.org/bot\" ascii wide\n   $behavior_1 = \"/sendDocument?chat_id=\" ascii wide\n   $behavior_2 = \"&caption=\" ascii wide\n   $behavior_3 = \"text=\" ascii wide\n   $behavior_4 = \"&chat_id=\" ascii wide\n   $behavior_5 = \"Content-Disposition: form-data; name=\\\"document\\\"; filename=\\\"\"\n\n```\n\n-----\n\n```\nascii wide\n   $behavior_6 = \"\\\\Ethereum\\\\keystore\" ascii wide\n   $behavior_7 = \"RegWrite\" ascii wide\n   $behavior_8 = \"\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\AppLaunch.exe\" ascii wide\n   $behavior_9 = \"\\\\Microsoft.NET\\\\Framework\\\\v2.0.50727\\\\InstallUtil.exe\" ascii\nwide\n   $behavior_10 =\n\"HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\*RD_\" ascii wide\n   $behavior_11 = \"GetAsyncKeyState\" ascii wide\n   $behavior_12 = \"SHFileOperationA\" ascii wide\n   $behavior_13 = \"GetDesktopWindow\" ascii wide\n   $behavior_14 = \"SHGetSpecialFolderLocation\" ascii wide\n   $behavior_15 = \"SHGetPathFromIDListA\" ascii wide\n   $behavior_16 = \"CallWindowProcW\" ascii wide\n  condition:\n   uint16(0) == 0x5a4d and\n   uint32(uint32(0x3c)) == 0x00004550 and\n   $obfuscated_aSubMain and\n   $MSVBVM60 and\n   ($decryption_routine or 13 of ($behavior_*))\n}\nrule malware_thunder_fox_gzip_0 {\n  meta:\n   author = \"Titan Labs\"\n   company = \"GoSecure\"\n   description = \"Gzip Compressd ThunderFox Stealer\"\n   hash = \"00cdcfc91db339be14f441be75e0dec7\"\n   created = \"2021-09-15\"\n   os = \"windows\"\n   type = \"malware.stealer\"\n   tlp = \"white\"\n   rev = 1\n  strings:\n   $compressed_payload = { 00 00 00 00 00 20 FA 48 04 00 1F 8B 08 00 00 00\n             00 00 04 00 AC BD 09 80 1C 47 75 37 3E D3 77 CF\n             B5 5B D3 B3 3D B3 BB D2 CE 4A F2 4A AD E9 99 95\n             76 57 C7 4A 3E 24 1F F8 C4 B6 6C 0B 7B 46 3E 24 }\n  condition:\n   uint16(0) == 0x5a4d and\n   uint32(uint32(0x3c)) == 0x00004550 and\n   $compressed_payload\n}\nrule malware_thunder_fox_0 {\n  meta:\n   author = \"Titan Labs\"\n   company = \"GoSecure\"\n   description = \"ThunderFox Stealer\"\n   hash = \"6ae510da968ebcbf5a8661c080ac12fd\"\n   created = \"2021-09-15\"\n   os = \"windows\"\n   type = \"malware.stealer\"\n   tlp = \"white\"\n   rev = 1\n  strings:\n\n```\n\n-----\n\n```\n   $browser_0 Pale Moon nocase ascii wide\n   $browser_1 = \"Firefox\" nocase ascii wide\n   $browser_2 = \"Waterfox\" nocase ascii wide\n   $browser_3 = \"K-Meleon\" nocase ascii wide\n   $browser_4 = \"Thunderbird\" nocase ascii wide\n   $browser_5 = \"IceDragon\" nocase ascii wide\n   $browser_6 = \"Cyberfox\" nocase ascii wide\n   $browser_7 = \"BlackHawK\" nocase ascii wide\n   $data_store_0 = \"logins.json\" nocase ascii wide\n   $data_store_1 = \"key4.db\" nocase ascii wide\n   $data_store_2 = \"signons.sqlite\" nocase ascii wide\n   $data_store_3 = \"key3.db\" nocase ascii wide\n   $data_store_4 = \"moz_logins\" nocase ascii wide\n   $user_cred_0 = \"hostname\" nocase ascii wide\n   $user_cred_1 = \"encryptedUsername\" nocase ascii wide\n   $user_cred_2 = \"encryptedPassword\" nocase ascii wide\n  condition:\n   uint16(0) == 0x5a4d and\n   uint32(uint32(0x3c)) == 0x00004550 and\n   5 of ($browser_*) and\n   3 of ($data_store_*) and\n   2 of ($user_cred_*)\n}\nrule malware_other_stealer_2 {\n  meta:\n   author = \"Titan Labs\"\n   company = \"GoSecure\"\n   description = \"Generic Windows Vault Credential Stealer\"\n   reference =\n\"https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/GetVaultCredential.hash = \"4509c33c251e8e075e4aa95001e35cdf\"\n   created = \"2021-09-10\"\n   os = \"windows\"\n   type = \"malware.stealer\"\n   tlp = \"white\"\n   rev = 1\n  strings:\n   $s1 = \"2F1A6504-0641-44CF-8BB5-3612D865F2E5\" ascii wide\n   $s2 = \"Windows Secure Note\" ascii wide\n   $s3 = \"3CCD5499-87A8-4B10-A215-608888DD3B55\" ascii wide\n   $s4 = \"Windows Web Password Credential\"ascii wide\n   $s5 = \"154E23D0-C644-4E6F-8CE6-5069272F999F\" ascii wide\n   $s6 = \"Windows Credential Picker Protector\" ascii wide\n   $s7 = \"4BF4C442-9B8A-41A0-B380-DD4A704DDB28\" ascii wide\n   $s8 = \"Web Credentials\" ascii wide\n   $s9 = \"77BC582B-F0A6-4E15-4E80-61736B6F3B29\" ascii wide\n   $s10 = \"Windows Credentials\" ascii wide\n   $s11 = \"E69D7838-91B5-4FC9-89D5-230D4D4CC2BC\" ascii wide\n   $s12 = \"Windows Domain Certificate Credential\" ascii wide\n   $s13 = \"3E0E35BE-1B77-43E7-B873-AED901B6275B\" ascii wide\n   $s14 = \"Windows Domain Password Credential\" ascii wide\n   $s15 = \"3C886FF3-2669-4AA2-A8FB-3F6759A77548\" ascii wide\n   $s16 = \"Windows Extended Credential\" ascii wide\n   $s17 = \"00000000-0000-0000-0000-000000000000\" ascii wide\n\n```\n\n-----\n\n```\n  condition:\n   uint16(0) == 0x5a4d and\n   uint32(uint32(0x3c)) == 0x00004550 and\n   all of them\n}\nrule malware_other_stealer_3 {\n  meta:\n   author = \"Titan Labs\"\n   company = \"GoSecure\"\n   description = \"Generic WinSCP Credential Stealer\"\n   reference = \"https://gist.github.com/jojonas/07c3771711fb19aed1f3\"\n   hash = \"4509c33c251e8e075e4aa95001e35cdf\"\n   created = \"2021-09-10\"\n   os = \"windows\"\n   type = \"malware.stealer\"\n   tlp = \"white\"\n   rev = 1\n  strings:\n   $s1 = \"Software\\\\Martin Prikryl\\\\WinSCP 2\\\\Sessions\" ascii wide nocase\n   $s2 = \"HostName\" ascii wide nocase\n   $s3 = \"UserName\" ascii wide nocase\n   $s4 = \"Password\"ascii wide nocase\n  condition:\n   uint16(0) == 0x5a4d and\n   uint32(uint32(0x3c)) == 0x00004550 and\n   all of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-22 - GoSecure Titan Labs Technical Report- BluStealer Malware Threat.pdf"
    ],
    "report_names": [
        "2021-09-22 - GoSecure Titan Labs Technical Report- BluStealer Malware Threat.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536147,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653703096,
    "ts_modification_date": 1653703096,
    "files": {
        "pdf": "https://archive.orkl.eu/0b8ebd2b70be369c356dab7868517865c71d6f2c.pdf",
        "text": "https://archive.orkl.eu/0b8ebd2b70be369c356dab7868517865c71d6f2c.txt",
        "img": "https://archive.orkl.eu/0b8ebd2b70be369c356dab7868517865c71d6f2c.jpg"
    }
}