{
    "id": "ca0ad522-6727-4d1b-9184-438422853d3e",
    "created_at": "2023-01-12T15:07:51.738513Z",
    "updated_at": "2025-03-27T02:17:05.828294Z",
    "deleted_at": null,
    "sha1_hash": "04a3a74641a621dff731e82897fa0fb136d65d44",
    "title": "2021-10-28 - THREAT ANALYSIS REPORT- Snake Infostealer Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T16:05:25Z",
    "file_modification_date": "2022-05-28T16:05:25Z",
    "file_size": 2087864,
    "plain_text": "# THREAT ANALYSIS REPORT: Snake Infostealer Malware\n\n**cybereason.com/blog/threat-analysis-report-snake-infostealer-malware**\n\nWritten By\nCybereason Global SOC Team\n\nOctober 28, 2021 | 16 minute read\n\nThe Cybereason Global Security Operations Center (GSOC) issues Cybereason Threat Analysis reports to inform on impacting threats. The\nThreat Analysis reports investigate these threats and provide practical recommendations for protecting against them.\n\nIn this Threat Analysis report, the GSOC investigates Snake, a feature-rich information-stealing malware. This report provides an overview of\nkey information-stealing features of the Snake malware and discusses similarities that we discovered in the staging mechanisms of samples\nfrom Snake and two common information-stealing malware programs, FormBook and Agent Tesla.\n\n\n-----\n\n## Key Findings:\n\n**Serious threat to privacy and security: Snake is a feature-rich information-stealing malware. Snake has keystroke logging as**\nwell as clipboard data, screenshot, and credential theft capabilities. Snake can steal credentials from over 50 applications, which\ninclude File Transfer Protocol (FTP) clients, email clients, communication platforms, and web browsers. Snake can exfiltrate stolen\ndata through a variety of protocols, such as FTP, Simple Mail Transfer Protocol (SMTP), and Telegram.\n**No industry or geographical preferences: Snake has been present in the threat landscape since November 2020 and has been**\na constant threat to users’ privacy and security since then. The Cybereason GSOC observed a spike in infections using the Snake\nmalware in late August 2021 with no specific trend in the industry or the geographical locations of the targeted victims.\n**Detected and prevented: The** [Cybereason Defense Platform effectively detects and prevents the Snake malware.](https://www.cybereason.com/platform)\n**Cybereason Managed Detection and Response (MDR): The Cybereason GSOC has zero tolerance towards attacks that involve**\ninformation-stealing malware, such as Snake, and categorizes such attacks as critical, high-severity incidents. The Cybereason\nGSOC MDR Team issues a comprehensive report to customers when such an incident occurs. The report provides an in-depth\noverview of the incident, which helps to scope the extent of compromise and the impact on the customer’s environment. In addition,\nthe report provides attribution information when possible as well as recommendations for mitigating and isolating the threat.\n\n## Introduction\n\nThe Snake malware is an information-stealing malware that is implemented in the .NET programming language. We suspect that the malware\nauthors themselves named the malware Snake, since the malware’s name is present in the data that Snake exfiltrates from compromised\nsystems. Malicious actors distribute Snake as attachments to phishing emails with various themes, such as payment requests.\n\nThe attachments are typically archive files with file name extensions such as img, zip, tar, and rar, and store a .NET executable that\nimplements the Snake malware. Users have to first decompress and then start the .NET executable to infect their systems. The executable\nstages the information-stealing features of the Snake malware on compromised systems and establishes persistence:\n\n_The data that the Snake malware exfiltrates contains the malware’s name_\n\n[Snake first appeared on the threat landscape in late November 2020. The malware is currently available for purchase in the underground](https://blog.checkpoint.com/2021/08/12/july-2021s-most-wanted-malware-snake-keylogger-enters-top-10-for-first-time/)\nscene for a price range between US $25 and $500. Malicious actors have been distributing Snake continuously through phishing campaigns\nsince November 2020. The Cybereason GSOC observed a spike in infections using the Snake malware in late August 2021 with no specific\ntrend in the industry or the geographical locations of the targeted victims.\n\nSnake is a feature-rich malware and poses a significant threat to users’ privacy and security. Snake has keystroke logging as well as clipboard\ndata, screenshot, and credential theft capabilities. We observed that Snake can steal credentials from over 50 applications, which include FTP\nclients, mail clients, communication platforms, and web browsers. Snake supports data exfiltration through a variety of protocols, such as FTP,\nSMTP, and Telegram.\n\n[Researchers have identified many similarities between the code of the information-stealing features of Snake and the code of the Matiex](https://threatresearch.ext.hp.com/the-many-skins-of-snake-keylogger/)\nmalware. Although the source code of Matiex has been available for purchase in the underground scene since February 2021, the informationstealing features of Snake samples that date earlier than February 2021 have code that is very similar to Matiex code.\n\nIn this report, we show that in addition to the information-stealing features of Snake, the staging mechanism of Snake samples is almost\nidentical to that of two common information-stealing malware programs, FormBook and Agent Tesla.\n\n## Analysis\n\n### The Snake Staging Mechanism\n\nMalicious actors distribute the Snake malware as attachments in phishing emails. These attachments are typically archive files that store a\n.NET Windows executable, which stages the information-stealing features of Snake on compromised systems and establishes persistence.\n\nIn this report, we focus on a Snake sample with a secure hash algorithm (SHA)-1 hash 392597dabf489b682dd10c20d2d84abc3b49abaa and a\nfilename SeptemberOrderlist.pdf.exe:\n\n\n-----\n\n_Phishing emails that distribute the Snake malware_\n\nWhen a user runs the compressed .NET Snake executable, SeptemberOrderlist.pdf.exe, the executable unpacks (i.e., decodes and decrypts)\na base-64 encoded and encrypted .NET assembly. The Snake executable stores the encoded and encrypted code of this assembly in a string\nvariable. SeptemberOrderlist.pdf.exe decrypts the code of the .NET assembly by using a symmetric encryption key of the  Triple Data\nEncryption Standard (DES) encryption algorithm.\n\nThe name of the decrypted .NET assembly is representative. SeptemberOrderlist.pdf.exe then loads and executes the representative\nassembly by instantiating an Panamera.Porsche object that the assembly implements:\n\n\n-----\n\n_Snake decrypts the .NET assembly representative using the Triple DES encryption algorithm_\n\nOne of the functionalities of the representative assembly is decoding and loading an image resource of SeptemberOrderlist.pdf.exe called\n_TaskWrapperAsyncResu . To avoid detection by sandbox analysis engines, the representative assembly decodes TaskWrapperAsyncResu_\nafter a random sleep time of 38–47 seconds. The decoded TaskWrapperAsyncResu image resource is another .NET assembly named\n_CF_Secretaria:_\n\n_The representative assembly decodes and loads the CF_Secretaria assembly_\n\n\n-----\n\n_The CF_Secretaria assembly is encoded as an image resource_\n\nAmong other activities, the  CF_Secretaria assembly establishes persistence of the Snake malware on the compromised system as follows:\n\n_CF_Secretaria copies the Snake executable, SeptemberOrderlist.pdf.exe, in the user’s AppData folder under a random name, such_\nas C:\\Users\\User\\AppData\\Roaming\\vxhnIvyvbHAK.exe. The name vxhnIvyvbHAK may differ for different samples of the Snake\nmalware.\n_CF_Secretaria creates an Extensible Markup Language (XML)-formatted scheduled task configuration file with the file name_\nextension .tmp in the user’s temporary folder, such as C:\\Users\\User\\AppData\\Local\\Temp\\tmp55AB.tmp.\n_CF_Secretaria creates a scheduled task named, for example,  Updates\\vxhnIvyvbHAK. To create this scheduled task,_\n_CF_Secretaria issues the following command:_\n\n_C:\\Windows\\System32\\schtasks.exe /Create /TN Updates\\vxhnIvyvbHAK /XML C:\\Users\\User\\AppData\\Local\\Temp\\tmp55AB.tmp_\n\nThe scheduled task executes the C:\\Users\\User\\AppData\\Roaming\\vxhnIvyvbHAK.exe executable—that is, the Snake malware—at user\nlogon:\n\n_CF_Secretaria creates an XML-formatted scheduled task configuration file_\n\nThe staging process results in the execution of another instance of SeptemberOrderlist.pdf.exe. This instance of SeptemberOrderlist.pdf.exe\nmaps in its context and executes the final payload, an obfuscated .NET assembly that implements the information-stealing features of Snake,\nwhich we discuss in the The Features of Snake section below:\n\n### Snake Meets FormBook and Agent Tesla\n\nThe staging mechanisms of recent samples of the FormBook and Agent Tesla malware are almost identical to those of Snake samples.\nFormBook has extensive information-stealing capabilities, such as keystroke logging, credential theft, and screenshot theft. The FormBook\nmalware has been available for sale in the underground scene since early 2016 as a one-time purchase or as malware-as-a-service following\na subscription model. Agent Tesla is a common remote access tool (RAT) and information-stealing malware, first discovered in late 2014.\nAgent Tesla is also available for sale in the underground scene.\n\n\n-----\n\ne o o g tab e p ese ts e a p e S a e, o oo, a d ge t es a sa p es t at a e s a stag g ec a s s e o p o de a\ndetailed overview of the similarities between the staging mechanisms of the Snake and FormBook samples:\n\n**Snake**\n\n**SHA-1 Hash** [392597dabf489b682dd10c20d2d84abc3b49abaa](https://www.virustotal.com/gui/file/132482335f028ceb6094d9c29442faf900d838fb054eebbbf39208bb39ccf5ae)\n\n**First submission to VirusTotal** 2021-09-09\n\n**FormBook**\n\n**SHA-1 Hash** [43d8881c9bda6344a352d2744913dda5c64ea843](https://www.virustotal.com/gui/file/8c84e97b71aa8d34be8742cd4b6c0b86abdfb92379b099465eb751b0882efb23)\n\n**First submission to VirusTotal** 2021-08-26\n\n**Agent Tesla**\n\n**SHA-1 Hash** [ae2e277a848421b4be46f1c6ccff727b5a07d90c](https://www.virustotal.com/gui/file/d82098335a9c8d105f145c404633541be0dc8e2c4749026cd7b29f6ea8044f44)\n\n**First submission to VirusTotal** 2021-08-26\n\nThe Snake and FormBook samples unpack the same .NET assembly, representative, from a string variable. The way in which the actors\nbehind Snake and FormBook samples pack the representative assembly in the variable may differ across samples. In addition, both samples\nload and execute the representative assembly by instantiating a Panamera.Porsche object that the assembly implements:\n\n(a) (b)\n\n_The representative assembly loaded by Snake (a) and FormBook (b)_\n\n\n-----\n\n(a)\n\n(b)\n\n_Snake (a) and FormBook (b) instantiate a Panamera.Porsche object_\n\nThe representative assemblies unpacked by the Snake and the FormBook sample decode image resources of the respective samples. The\ndecoded image resources are the same .NET assembly, called CF_Secretaria, which the representative assemblies load after decoding:\n\n(a) (b)\n\n_The CF_Secretaria assembly loaded by Snake (a) and FormBook (b)_\n\n\n-----\n\ne stag g ec a s s o t e S a e a d o oo sa p es s g ca t y d e ge at t e po t o dep oy e t o t e a pay oads, o t e\ninformation-stealing features of Snake and FormBook. The final payload of the Snake sample is a .NET assembly that runs in the context of a\nseparate instance of the sample, while the final payload of the FormBook sample is a native Windows executable.\n\nThe FormBook sample injects its final payload in legitimate Windows processes, such as explorer.exe and wlanext.exe. Previous research\ndocuments the deployment of the final payload of the FormBook sample in greater detail:\n\n(b)\n\n(a)\n\n_Process tree: The deployment of the final payload of the Snake sample (a) and the FormBook_\n_sample (b)_\n\nThe fact that the staging mechanisms of the Snake and other common information-stealing malware, such as FormBook and Agent Tesla, are\nalmost identical indicates that the actors behind the Snake sample that we analyzed may have purchased or otherwise obtained the staging\nmechanism from other actors on the malware marketplace. The same actors might also distribute the Snake, FormBook and Agent Tesla\nsamples that share the staging mechanism.\n\n[Adding the strong indications that the staged information-stealing features of the Snake malware themselves are based on the Matiex](https://threatresearch.ext.hp.com/the-many-skins-of-snake-keylogger/)\nmalware, the former scenario shows how easy it is for malware developers to create new malware by code reuse. Although this report focuses\non samples of the Snake, FormBook, and Agent Tesla malware, other malware could use the same staging mechanism as the samples that\nwe analyzed.\n\n## The Features of Snake\n\nThis section provides an overview of key information-stealing features of the Snake sample that we analyzed, SeptemberOrderlist.pdf.exe. We\n[emphasize that different Snake samples do not use all implemented features. Previous research indicates that malicious actors build Snake](https://threatresearch.ext.hp.com/the-many-skins-of-snake-keylogger/)\nsamples by using a builder tool that integrates all Snake features in built samples, but enables only the features selected by the actors.\n\nFor persistence, in addition to creating a scheduled task by using its staging mechanism, Snake can also edit the registry key:\n\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run to execute itself at user logon._\n\nTo avoid detection, Snake can disable solutions that may detect the malware’s operation by killing associated processes, such as the avastui\nprocess, which is related to the Avast antivirus, and the wireshark process, which is related to the Wireshark network traffic analyzer.\n\nThe table below lists the names of the processes that Snake stops. In addition, Snake can add itself to the exclusion list of the Windows\nDefender security mechanism by executing the PowerShell command powershell.exe Add-MpPreference _-ExclusionPath and specifying the_\npath to the Snake executable:\n\n\nzlclient\n\negui\n\nbdagent\n\nnpfmsg\n\nolydbg\n\nanubis\n\nwireshark\n\navastui\n\n_Avp32\n\nvsmon\n\nmbam\n\nkeyscrambler\n\n\nIcload95\n\nIcloadnt\n\nIcmon\n\nIcsupp95\n\nIcsuppnt\n\nIface\n\nIomon98\n\nJedi\n\nLockdown2000\n\nLookout\n\nLuall\n\nMCAFEE\n\n\nVsecomr\n\nVshwin32\n\nVsstat\n\nWebscanx\n\nWEBTRAP\n\nWfindv32\n\nZonealarm\n\nLOCKDOWN2000\n\nRESCUE32\n\nLUCOMSERVER\n\navgcc\n\navgcc\n\n\n-----\n\n_ p\n\n_Avpm\n\nAckwin32\n\nOutpost\n\nAnti-Trojan\n\nANTIVIR\n\nApvxdwin\n\nATRACK\n\nAutodown\n\nAvconsol\n\nAve32\n\nAvgctrl\n\nAvkserv\n\nAvnt\n\nAvp\n\nAvp32\n\nAvpcc\n\nAvpdos32\n\nAvpm\n\nAvptc32\n\nAvpupd\n\nAvsched32\n\nAVSYNMGR\n\nAvwin95\n\nAvwupd32\n\nBlackd\n\nBlackice\n\nCfiadmin\n\nCfiaudit\n\nCfinet\n\nCfinet32\n\nClaw95\n\nClaw95cf\n\nCleaner\n\nCleaner3\n\nDefwatch\n\nDvp95\n\nDvp95_0\n\nEcengine\n\nEsafe\n\nEspwatch\n\nF Agnt95\n\n\nMpftray\n\nN32scanw\n\nNAVAPSVC\n\nNAVAPW32\n\nNAVLU32\n\nNavnt\n\nNAVRUNR\n\nNavw32\n\nNavwnt\n\nNeoWatch\n\nNISSERV\n\nNisum\n\nNmain\n\nNormist\n\nNORTON\n\nNupgrade\n\nNvc95\n\nOutpost\n\nPadmin\n\nPavcl\n\nPavsched\n\nPavw\n\nPCCIOMON\n\nPCCMAIN\n\nPccwin98\n\nPcfwallicon\n\nPersfw\n\nPOP3TRAP\n\nPVIEW95\n\nRav7\n\nRav7win\n\nRescue\n\nSafeweb\n\nScan32\n\nScan95\n\nScanpm\n\nScrscan\n\nServ95\n\nSmc\n\nSMCSERVICE\n\nSnort\n\n\ng\n\navgupsvc\n\navgw\n\navgcc32\n\navgserv\n\navgserv9\n\navgserv9schedapp\n\navgemc\n\nashwebsv\n\nashdisp\n\nashmaisv\n\nashserv\n\naswUpdSv\n\nsymwsc\n\nnorton\n\nNorton Auto-Protect\n\nnorton_av\n\nnortonav\n\nccsetmgr\n\nccevtmgr\n\navadmin\n\navcenter\n\navgnt\n\navguard\n\navnotify\n\navscan\n\nguardgui\n\nnod32krn\n\nnod32kui\n\nclamscan\n\nclamTray\n\nclamWin\n\nfreshclam\n\noladdin\n\nsigtool\n\nw9xpopen\n\nWclose\n\ncmgrdian\n\nalogserv\n\nmcshield\n\nvshwin32\n\navconsol\n\n\n-----\n\nFprot\n\nF-Prot\n\nF-Prot95\n\nFp-Win\n\nFrw\n\nF-Stopw\n\nIamapp\n\nIamserv\n\nIbmasn\n\nIbmavsp\n\n\np\n\nSweep95\n\nSYMPROXYSVC\n\nTbscan\n\nTca\n\nTds2-98\n\nTds2-Nt\n\nTermiNET\n\nVet95\n\nVettray\n\nVscan40\n\n\navsynmgr\n\navcmd\n\navconfig\n\nlicmgr\n\nsched\n\npreupd\n\nMsMpEng\n\nMSASCui\n\nAvira.Systray\n\n\n_The names of the processes that the Snake malware kills_\n\n_The Snake malware kills processes_\n\nSnake has a self-deletion feature such that the malware deletes itself using the del command after a timeout of three seconds once Snake has\nstarted the self-deletion process:\n\n\n-----\n\n_e S a e_ _a_ _a e ca_ _de ete tse_\n\nSnake can gather the following type of information about the compromised environment in which the malware runs:\n\nOperating system and hardware information: Snake obtains the operating system name and version, amount of hard disk and\nphysical memory, and machine name.\nGeolocation and date-time information: Snake issues requests to the web services checkip.dyndns.org and freegeoip.app to\ndiscover the IP address of the operating system on which Snake runs, and the system’s geolocation based on the IP address.\n\n[Previous research states that the Snake malware uses the above information to decide whether to fully execute on a compromised system.](https://threatresearch.ext.hp.com/the-many-skins-of-snake-keylogger/)\nThe Snake sample that we analyzed does not do this, but only exfiltrates the geolocation and date/time information among other stolen data:\n\n_The Snake malware gathers operating system, hardware, geolocation, and date-time information_\n\nSnake has many information-stealing features and poses a significant threat to users’ privacy and security. The figure below depicts a\nsystematization of the information-stealing features of the Snake malware:\n\n\n-----\n\n_A systematization of the information-stealing features of Snake_\n\n### Keystroke Logging\n\n[The Snake malware uses the SetWindowsHookExA and](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowshookexa) _[CallNextHookEx functions to capture key press events. Snake logs the key when a](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-callnexthookex)_\nuser presses a system key, that is, a key that a user presses after the F10 key or together with the ALT key. Snake also logs the key when a\nuser presses a non-system key—a key that a user presses without pressing the ALT key at the same time. Snake stores logged keystrokes in\na variable:\n\n\n-----\n\n_e S a e_ _a_ _a e ogs eyst o es_\n\n### Clipboard Data Theft\n\n[Snake invokes the IsClipboardFormatAvailable function to determine whether clipboard data in Unicode text format (Microsoft Standard](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-isclipboardformatavailable)\n[Clipboard Format CF_UNICODETEXT) is available. Snake then invokes the OpenClipboard function to open and lock the Clipboard data,](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-openclipboard)\n[followed by the GetClipboardData function to retrieve the data in Unicode text format.](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getclipboarddata)\n\n[In addition, the Snake malware uses the ClipboardProxy.GetText function to retrieve clipboard data in standard American National Standards](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualbasic.myservices.clipboardproxy.gettext?view=windowsdesktop-5.0)\nInstitute (ANSI) or Unicode text format. Snake stores clipboard data in a variable:\n\n_The Snake malware retrieves clipboard data_\n\n### Screenshot Theft\n\n[The Snake malware uses the Graphics.CopyFromScreen function to take a screenshot of the entire screen. Snake stores the screenshot in](https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.copyfromscreen?view=windowsdesktop-5.0)\nthe %MyDocuments%\\SnakeKeylogger\\Screenshot.png file. Snake creates the %MyDocuments%\\SnakeKeylogger directory if the directory\ndoes not exist. After taking a screenshot, Snake first exfiltrates the Screenshot.png file as we describe in the Data Exfiltration section, and then\ndeletes the file:\n\n_The Snake malware takes and stores screenshots_\n\n### Credential Theft\n\nSnake can steal saved credentials from credential databases of communication platforms, FTP clients, email clients, and web browsers. The\ntable below lists the applications (column ‘Application’) from which Snake can steal saved credentials and the locations of the applications’\ncredential databases (column ‘Credential database’) that Snake accesses to retrieve credentials. The sample of the Snake malware we\nanalyzed can steal credentials from 59 applications, out of which 52 are web browsers. In the table below:\n\n_%AppData% and %LocalAppData% are Windows environment variables that resolve to filesystem paths, such as_\n_C:\\Users\\user\\AppData and C:\\Users\\user\\AppData\\Local_\n_%FoxmailInstallation% refers to an installation directory of the Foxmail email client, such as C:\\Program Files\\Foxmail 7.2, and_\n_[$email refers to a configured email address, such as test@domain.com](http://10.10.0.46/mailto:test@domain.com)_\n\n**Application** **Credential databa**\n\n**Communication platforms**\n\nDiscord _%AppData%\\disco_\n\n\n-----\n\nPidgin _%AppData%\\.purp_\n\n**FTP clients**\n\nFileZilla _%AppData%\\FileZ_\n\n**Mail clients**\n\nFoxmail _$FoxmailInstallatio_\n\nOutlook _HKEY_CURRENT_\n\n_[Email\\IMAP Pass_\n\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging_\n_Subsystem\\Profiles\\Outlook\\9375CFF0413111d3B88A00104B2A6676\\[Email\\IMAP Password\\POP3 Password\\HTTP_\n_Password\\SMTP Password]_\n\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Windows Messaging_\n_Subsystem\\Profiles\\9375CFF0413111d3B88A00104B2A6676\\[Email\\IMAP Password\\POP3 Password\\HTTP_\n_Password\\SMTP Password]_\n\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\Outlook\\Profiles\\Outlook\\9375CFF0413111d3B88A00104B2A6676\\_\n\n_[Email\\IMAP Password\\POP3 Password\\HTTP Password\\SMTP Password]_\n\nPostBox _%AppData%\\Post_\n\nThunderbird _%AppData%\\Thun_\n\n**Web browsers**\n\n360 Browser _%LocalAppData%_\n\n360Chrome _%LocalAppData%_\n\n7 Star _%LocalAppData%_\n\nAmigo _%LocalAppData%_\n\nAvast Secure Browser _%LocalAppData%_\n\nBlackHawk _%LocalAppData%_\n\nBlisk _%LocalAppData%_\n\nBrave _%LocalAppData%_\n\nCentBrowser _%LocalAppData%_\n\nChedot _%LocalAppData%_\n\nChrome _%LocalAppData%_\n\nChrome Canary _%LocalAppData%_\n\nChromePlus _%LocalAppData%_\n\n\n-----\n\nChromium _%LocalAppData%_\n\nCitrio _%LocalAppData%_\n\nCoc Coc _%LocalAppData%_\n\nComodo Dragon _%LocalAppData%_\n\nCoowon _%LocalAppData%_\n\nCyberfox _%AppData%\\8pec_\n\nEdge _%LocalAppData%_\n\nElements _%LocalAppData%_\n\nEpic _%LocalAppData%_\n\nFirefox _%AppData%\\Mozi_\n\nGhost Browser _%LocalAppData%_\n\nIceCat _%AppData%\\Mozi_\n\nIceDragon _%AppData%\\Com_\n\nIridium _%LocalAppData%_\n\nKinza _%LocalAppData%_\n\nKometa _%LocalAppData%_\n\nLiebao _%LocalAppData%_\n\nNichrome _%LocalAppData%_\n\nOpera _%AppData%\\Oper_\n\nOpera _%AppData%\\Oper_\n\nOrbitum _%LocalAppData%_\n\nPale Moon _%AppData%\\Moo_\n\nQIP Surf _%LocalAppData%_\n\nQQBrowser _%LocalAppData%_\n\nSalamWeb _%LocalAppData%_\n\nSeaMonkey _%AppData%\\Mozi_\n\nSleipnir _%AppData%\\Fenr_\n\n\n-----\n\nSlimBrowser _%AppData%\\Flash_\n\nSlimjet _%LocalAppData%_\n\nSputnik _%LocalAppData%_\n\nSuperBird _%LocalAppData%_\n\nTorch _%LocalAppData%_\n\nUC Browser _%LocalAppData%_\n\nUran _%LocalAppData%_\n\nVivaldi _%LocalAppData%_\n\nWaterfox _%AppData%\\Wate_\n\nXpom _%LocalAppData%_\n\nXvast _%LocalAppData%_\n\nYandex _%LocalAppData%_\n\n_Applications and their credential databases from which Snake can steal credentials_\n\nIn addition to communication platforms, FTP clients, email clients, and web browsers, Snake can steal saved credentials of wireless networks.\nTo do this, Snake first invokes the netsh wlan show profile command to list existing wireless network profiles and then retrieves these from the\ncommand output.\n\nWireless network profiles are sets of network settings that include saved credentials. Snake then invokes the netsh wlan show profile\n_name=”%name%” key=clear command for each profile, where %name is the profile name, and retrieves from the command output the_\nunencrypted saved password stored as part of the profile.\n\nThe Snake malware can steal the Product Key of the Windows instance on which the malware runs. To do this, Snake retrieves and decodes\nthe registry value HKEY_LOCAL_MACHINE\\ Software\\Microsoft\\Windows NT\\CurrentVersion\\DigitalProductID.\n\nThe credential databases of the communication platforms, FTP clients, email clients, and web browsers that Snake targets typically store\ncredentials in encrypted form. Snake decrypts credentials, stores the decrypted credentials in a variable, and exfiltrates the credentials as we\ndescribe in the Data Exfiltration section. Most of the web browsers from which Snake steals credentials store credentials either in Login Data\nfiles (primarily used by Chromium-based browsers) or logins.json files (primarily used by Gecko-based browsers).\n\n_Login Data files are SQLite databases. These databases have a logins table that stores credential-protected Uniform Resource Locators_\n(URLs) in the origin_url field, and the saved usernames and passwords for the URLs in the username_value and password_value fields,\nrespectively. The passwords are encrypted. Recent versions of Chromium-based browsers encrypt saved passwords with a symmetric\nAdvanced Encryption Standard (AES)-256 encryption key.\n\nThe browsers store the AES key in an encrypted form on the file system, in a Local State file placed in the %LocalAppData% directory, for\nexample, %LocalAppData%\\Google\\Chrome\\User Data\\Local State. Browsers encrypt the AES key using the Microsoft Data Protection\nApplication Programming Interface (DPAPI) encryption mechanism, which supports two data protection (encryption) scopes: i) user, which\nencrypts data using a user-specific encryption key such that only a specific logged in user can decrypt the data, and ii) machine, which\nencrypts data using a machine-specific encryption key such that any user logged in a specific machine can decrypt the data. Older versions of\nChromium-based browsers do not use AES to encrypt saved passwords, but encrypt saved passwords directly using the DPAPI mechanism in\n_user protection scope._\n\nThe Snake malware can decrypt passwords that a Chromium-based browser has encrypted directly using DPAPI or an AES key first:\n\n\n-----\n\nS a e dec ypts pass o ds by us g _use p otect o_ scope a d o [g t e C yptU p otect ata u ct o](https://docs.microsoft.com/en-us/windows/win32/api/dpapi/nf-dpapi-cryptunprotectdata)\n\nSnake first decrypts an AES encryption key stored in a Local State file by using DPAPI in user protection mode and invoking the\n_[ProtectedData.Unprotect function, and then decrypts the saved password by using the AES encryption key and invoking the](https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.protecteddata.unprotect?view=windowsdesktop-5.0&viewFallbackFrom=net-5.0)_\n_[BCryptDecrypt function:](https://docs.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptdecrypt)_\n\n_The Snake malware decrypts passwords stored in a Login Data file_\n\nThe logins.json files are JavaScript Object Notation(JSON)-formatted files that store encrypted usernames in the encryptedUsername field and\nencrypted passwords in the encryptedPassword field. Gecko-based browsers encrypt saved usernames and passwords using the Triple-DES\nalgorithm.\n\nMozilla’s [Network Security Services (NSS) library implements the PKCS11_Decrypt function that decrypts credentials encrypted by Gecko-](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/Introduction_to_Network_Security_Services)\nbased browsers:\n\n\n-----\n\n_The Snake malware decrypts credentials stored in a logins.json file_\n\nThe Snake malware decrypts credentials that logins.json files store as follows:\n\n1. Snake locates and loads the dynamic-link library (DLL) file that implements the NSS library, nss3.dll, and initializes NSS by invoking the\n\nNSS_Init function.\n2. Snake searches for nss3.dll in multiple locations in the %ProgramFilesX86% and %ProgramFiles% directories.\n3. Snake decrypts encrypted usernames and passwords by invoking the PK11SDR_Decrypt function.\n4. Snake shuts down the NSS library by invoking the NSS_Shutdown function.\n\n### Data Exfiltration\n\nSnake can exfiltrate logged keystrokes and stolen credentials, clipboard data, and screenshots using the following protocols:\n\nFTP: Snake logs into an attacker-controlled FTP server and issues the STOR command to upload the stolen data to the server.\nSnake stores the uploaded data on the FTP server in:\n\na file with the file name extension .txt and a name that contains Passwords ID, keystroke Logs ID, or Clipboard Logs ID, when\nthe data is credentials, logged keystrokes, or clipboard data, respectively.\na file with the file name extension .png and a name that contains Screenshot Logs ID, when the data is a screenshot.\nSMTP: Snake logs into an attacker-controlled SMTP server, and then composes and sends to a malicious email address an email\nmessage that has attachments. The attachments store the stolen data. The attachments are files:\n\nwith the filename Clipboard.txt or Keystrokes.txt, when the stolen data is clipboard data or logged keystrokes, respectively.\nwith the file name Passwords.txt and User.txt, when the stolen data is credentials, that is, passwords and usernames,\nrespectively.\nwith the filename Screenshot.png, when the stolen data is a screenshot.\nTelegram/HyperText Transfer Protocol Secure (HTTPS): Snake issues a POST request to the Telegram endpoint api.telegram.org\nto send a document to an attacker-controlled Telegram chat. The document contains the stolen data. The document has the file\nname Clipboard.txt, Screenshot.png, SnakeKeylogger.txt, or SnakePW.txt, when the data is clipboard data, screenshot, logged\nkeystrokes, or credentials, respectively.\n\nSnake can exfiltrate logged keystrokes, screenshots, clipboard data, and credentials on a regularly timed interval:\n\n\n-----\n\n## The Snake malware exfiltrates stolen credentials through\n\n SMTP\n\n Cybereason Detects and Prevents Snake Malware\n\nThe [Cybereason Defense Platform is able to detect and prevent the execution of the Snake malware using multi-layer protection that detects](https://www.cybereason.com/platform)\nand blocks malware with threat intelligence, machine learning, and next-gen antivirus (NGAV) capabilities:\n\n_The Cybereason Defense Platform detects and blocks Snake malware_\n\n## Cybereason GSOC MDR Recommendations\n\nThe Cybereason GSOC recommends the following:\n\n\n-----\n\nab e t e _t_ _a_ _a e eatu e o_ t e Cybe easo G a d e ab e t e _[etect a d](https://nest.cybereason.com/documentation/product-documentation/190/anti-malware-settings)_ _e e t_ odes o t s eatu e\nSecurely handle email messages that originate from external sources. This includes disabling hyperlinks and investigating the\ncontent of email messages to identify phishing attempts.\nUse secure passwords, regularly rotate passwords, and use multi-factor authentication where possible.\nRegularly monitor outgoing network traffic for data exfiltration activities.\nThreat Hunting with Cybereason: The Cybereason MDR team provides its customers with custom hunting queries for detecting\n[specific threats - to find out more about threat hunting and Managed Detection and Response with the Cybereason Defense](https://www.cybereason.com/platform/managed-detection-response-mdr)\nPlatform, [contact a Cybereason Defender here.](https://www.cybereason.com/services/managed-detection-response-mdr#form)\n\n[For Cybereason customers: More details available on the NEST including custom threat hunting queries for detecting this](https://nest.cybereason.com/knowledgebase/3502086)\nthreat.\n\nCybereason is dedicated to teaming with defenders to end cyber attacks from endpoints to the enterprise to everywhere. Schedule a demo\n[today to learn how your organization can benefit from an operation-centric approach to security.](https://www.cybereason.com/blog/the-cybereason-malop-achieving-operation-centric-security)\n\n## MITRE ATT&CK Techniques\n\n\n**Initial Access** **Execution** **Persistence** **Defense Evasion** **Credential**\n**Access**\n\n\n**Discovery** **Collection** **Exfiltration**\n\n\nPhishing:\n[Spearphishing](https://attack.mitre.org/techniques/T1566/001/)\nAttachment\n\n\nUser\nExecution:\nMalicious\nFile\n\n\nScheduled Task/Job:\nScheduled Task\n\nBoot or Logon Autostart\n[Execution: Registry Run](https://attack.mitre.org/techniques/T1547/001/)\nKeys / Startup Folder\n\n\nIndicator Removal\n[on Host: File](https://attack.mitre.org/techniques/T1070/004/)\nDeletion\n\n\n[Modify registry](https://attack.mitre.org/techniques/T1112/) Unsecured\nCredentials:\nCredentials in\nRegistry\n\nImpair Defenses:\n[Disable or Modify](https://attack.mitre.org/techniques/T1562/001/)\nTools\n\nImpair Defenses:\n[Disable or Modify](https://attack.mitre.org/techniques/T1562/004/)\nSystem Firewall\n\n\nUnsecured\nCredentials:\nCredentials In\nFiles\n\n\nFile and\n[Directory](https://attack.mitre.org/techniques/T1083/)\nDiscovery\n\nSystem\n[Information](https://attack.mitre.org/techniques/T1082/)\nDiscovery\n\nSystem\n[Location](https://attack.mitre.org/techniques/T1614/)\nDiscovery\n\nSystem\nNetwork\nConfiguration\nDiscovery\n\nSystem Time\nDiscovery\n\n\nClipboard\nData\n\nData from\n[Local](https://attack.mitre.org/techniques/T1005/)\nSystem\n\nInput\n[Capture:](https://attack.mitre.org/techniques/T1056/001/)\nKeylogging\n\nScreen\nCapture\n\n\nAutomated\nExfiltration\n\nExfiltration\nOver\nAlternative\nProtocol\n\nScheduled\nTransfer\n\n\n## About the Researchers:\n\n**Aleksandar Milenkoski,Senior Threat and Malware Analyst, Cybereason Global SOC**\n\nAleksandar Milenkoski is a Senior Threat and Malware Analyst with the Cybereason Global SOC team. He is involved primarily in reverse\nengineering and threat research activities. Aleksandar has a PhD in system security. Prior to Cybereason, his work focussed on research in\nintrusion detection and reverse engineering security mechanisms of the Windows 10 operating system.\n\n**Brian Janower, Security Analyst, Cybereason Global SOC**\n\nBrian Janower is a Security Analyst with the Cybereason Global SOC (GSOC) team. He is involved in malware analysis and triages security\nincidents effectively and precisely. Brian has a deep understanding of the malicious operations prevalent in the current threat landscape. He is\nin the process of obtaining a Bachelor of Science degree in Systems Information & Cyber\n\n\n-----\n\n### d cato s o Co p o se\n\n**Executables** SHA-256 hash: 132482335f028ceb6094d9c29442faf900d838fb054eebbbf39208bb39ccf5ae\n\nFile size: 691200 bytes\n\n**Scheduled tasks** _Updates\\vxhnIvyvbHAK_\n\nNote: The name vxhnIvyvbHAK may differ for different samples of the Snake malware\n\n**Domains** _checkip.dyndns.org_\n\n_freegeoip.app_\n\nAbout the Author\n\n**Cybereason Global SOC Team**\n\nThe Cybereason Global SOC Team delivers 24/7 Managed Detection and Response services to customers on every continent. Led by\ncybersecurity experts with experience working for government, the military and multiple industry verticals, the Cybereason Global SOC Team\ncontinuously hunts for the most sophisticated and pervasive threats to support our mission to end cyberattacks on the endpoint, across the\nenterprise, and everywhere the battle moves.\n\n[All Posts by Cybereason Global SOC Team](https://www.cybereason.com/blog/authors/cybereason-global-soc-team)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-28 - THREAT ANALYSIS REPORT- Snake Infostealer Malware.pdf"
    ],
    "report_names": [
        "2021-10-28 - THREAT ANALYSIS REPORT- Snake Infostealer Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e90ec9cb-9959-455d-b558-4bafef64d645",
            "created_at": "2022-10-25T16:07:24.222081Z",
            "updated_at": "2025-03-27T02:02:10.14365Z",
            "deleted_at": null,
            "main_name": "Sphinx",
            "aliases": [
                "APT-C-15"
            ],
            "source_name": "ETDA:Sphinx",
            "tools": [
                "AnubisSpy",
                "Backdoor.Oldrea",
                "Bladabindi",
                "Fertger",
                "Havex",
                "Havex RAT",
                "Jorik",
                "Oldrea",
                "PEACEPIPE",
                "njRAT",
                "yellowalbatross"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536071,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653753925,
    "ts_modification_date": 1653753925,
    "files": {
        "pdf": "https://archive.orkl.eu/04a3a74641a621dff731e82897fa0fb136d65d44.pdf",
        "text": "https://archive.orkl.eu/04a3a74641a621dff731e82897fa0fb136d65d44.txt",
        "img": "https://archive.orkl.eu/04a3a74641a621dff731e82897fa0fb136d65d44.jpg"
    }
}