{
    "id": "8f5d7ca6-7905-4ba9-9f16-c3a0c806f985",
    "created_at": "2023-01-12T15:08:30.706213Z",
    "updated_at": "2025-03-27T02:16:25.565925Z",
    "deleted_at": null,
    "sha1_hash": "5f2ddb571d8e04c6b63e9bf9ac26eba69f2bf07c",
    "title": "2021-09-09 - FluBot Variant Masquerading As The Default Android Voicemail App",
    "authors": "",
    "file_creation_date": "2022-05-27T23:05:45Z",
    "file_modification_date": "2022-05-27T23:05:45Z",
    "file_size": 1355003,
    "plain_text": "# FluBot Variant Masquerading As The Default Android Voicemail App\n\n**[blog.cyble.com/2021/09/09/flubot-variant-masquerading-as-the-default-android-voicemail-app/](https://blog.cyble.com/2021/09/09/flubot-variant-masquerading-as-the-default-android-voicemail-app/)**\n\nSeptember 9, 2021\n\nDuring our routine threat hunting exercise, Cyble Research Labs came across a sample of the FluBot\nmalware from our OSINT research. This variant calls itself “Voicemail” to trick users into thinking that it’s the\ndefault Voicemail app.\n\nFluBot is a type of malware that operates by taking over devices, collecting sensitive information from them,\nand even sending messages to the victim’s contacts.\n\nThe application uses Smishing (a combination of SMS+Phishing) attacks to spread the malware. In the case\nof phishing, attackers send fraudulent emails that trick recipients into opening an attachment which includes\nmalware, or by clicking on a malicious link. In the case of Smishing, emails are replaced by text messages.\n\nCyble Research Labs downloaded the malware sample and performed a detailed analysis. Through our\nanalysis, we determined that the malware performs suspicious activities such as reading Contact data, SMS\ndata, and device notifications.\n\nThe malware explicitly requests users for complete control of their devices. After gaining full access and\npermissions, the malware further enhances its functionalities.\n\nThe image below shows the statistical view of FluBot samples distributed by the attackers observed through\nour open-source analysis from one of our Threat hunting sources. Refer to Figure 1.\n\nFigure 1: Statistical View\n\n## Technical Analysis\n\n\n-----\n\n### APK Metadata Information\n\nFigure 2 shows the metadata information of the application.\n\nFigure 2: Metadata Information\nWe have outlined the flow of the application and the various activities conducted by it. Refer to Figure 3.\n\nThe application asks the users to turn on the accessibility service.\nThe application asks for complete control of the device.\nThe application asks the users to allow access to notifications.\nThe application asks the users to allow it to replace the default SMS app. Once it gets this permission,\nthe application can handle SMS data.\n\nFigure 3: Application Start Flow\nUpon simulating the application, it requests that users enable the Accessibility service. Attackers can abuse\nthis service to carry out malicious activities such as clicking buttons remotely to gain admin privileges and\ntrick users into clicking on overlay content over the screen. Refer to Figure 4.\n\n\n-----\n\nFigure 4: Requests Accessibility\n\nService\nFigure 5 shows the malware asking users to give them complete access to the device. Once the malware\ngains complete control over the device, it can perform the following activities:\n\nView and control screen.\nControl device data, including contacts, SMSs, and pictures.\nDelete or manipulate the device’s data.\n\n\n-----\n\nFigure 5: Asks for Full Control\n\nFigure 6 shows that the malware asks the users to enable Notification access for the application. Once the\napplication gets notification access, it can read all notifications on the device, including the SMS data of the\ndevice.\n\n\n-----\n\nFigure 6: Asks for Notification\n\nAccess\nUpon receiving notification access, the application requests users to make the application their default SMS\napp. Upon becoming the default SMS app, the app proceeds with its malicious activities. Refer to Figure 7.\n\n\n-----\n\nFigure 7: Asks for Default SMS\n\nApp Permission\n\n## Manifest Description\n\n**Voicemail requests sixteen different permissions, of which the attackers could abuse seven. In this case, the**\nmalware can:\n\nReads SMS and Contacts data.\nMake calls without user intervention\nDelete SMS data\nCan kill background process of other apps\nReceive and send SMSs\n\nWe have listed the dangerous permissions below.\n\n**Permissions** **Description**\n\nREAD_SMS Access phone messages.\n\n\n-----\n\nREAD_CONTACTS Access phone contacts.\n\nWRITE_SMS Allows applications to write SMS messages. Malicious apps may\nmanipulate SMS data.\n\nKILL_BACKGROUND_PROCESSES Allows applications to kill the background processes of other apps.\n\nCALL_PHONE Allows an application to initiate a phone call without going through\nthe Dialer user interface to confirm the call.\n\nRECEIVE_SMS Allows an application to receive SMS messages.\n\nSEND_SMS Allows an application to send SMS messages.\n\nTable 1: Permissions’ Description\nUpon reviewing the code of the application, we identified the launcher activity of the malicious app as shown\nin Figure 8.\n\nFigure 8: Launcher Activity\nWe were able to identify that the permissions and services defined in the manifest file can replace the\ndefault Messages app. After getting default app permissions, this app will be able to handle sending and\nreceiving SMSs and MMSs. Refer to Figure 9.\n\nFigure 9: Handles SMS and MMS\nFigure 10 demonstrates that the malware has defined customized services that leverage the\n**BROADCAST_WAP_PUSH service. Using this service, an application can broadcast a notification stating**\nthat a WAP Push message has been received.\n\nFigure 10: Using Broadcast WAP Push Permission\nThreat Actors (TAs) can abuse this service to generate false MMS message receipts or replace the original\n[content with malicious content. As per Google, this service is not for use by third-party applications.](https://developer.android.com/reference/android/Manifest.permission#SEND_RESPOND_VIA_MESSAGE)\n\n\n-----\n\nFigure 11 demonstrates that the malware has defined customized services that leverage the permission\n**SEND_RESPOND_VIA_MESSAGE, permitting the application to send a request to other messaging apps**\nto handle Respond-via-Message action for incoming calls.\n\nFigure 11: Using Send Respond VIA Message\n\n## Source Code Description\n\nThe code given in Figure 12 shows that the malware is capable of reading Contact data.\n\nFigure 12: Reads Contact Data\nThe code shown in Figure 13 demonstrates that the malware is capable of sending text messages as well.\n\nFigure 13: Sending SMS\nThe code in Figure 14 shows that the malware is capable of reading notification data and removing the\nnotifications altogether.\n\n\n-----\n\nFigure 14: Reads Notification Data\nThe code shown in Figure 15 demonstrates the encryption technique used by the malware to encrypt the\ndata.\n\nFigure 15: Encryption Technique Used by the Malware\nThe below code shows encrypted strings. After decrypting some strings, we determined that they also\ncontain the FluBot malware variant version information. Refer to Figure 16.\n\n\n-----\n\nFigure 16: Encrypted Strings\nThe malware obfuscates certain data such as strings, Command and Control (C&C) Commands, malicious\nAPIs using custom encryption techniques.\n\nUpon analyzing the sample, we found that the malware uses a simple XOR algorithm. The input to the\nalgorithm has been stored in the form of integers. Refer to Figure 17.\n\nFigure 17: Decryption Code\n\n\n-----\n\n## Traffic Analysis Description\n\nDuring our traffic analysis, we observed the malware communicating with various IP addresses. Refer to\nFigure 18.\n\nFigure 18: Communicates with the Server\nFigure 19 shows that the malware has hardcoded data, i.e., the malicious URL, based out of Russia.\n\nFigure 19: Hardcoded Data\n\n## Conclusion\n\nThreat Actors constantly adapt their methods to avoid detection and find new ways to target users through\nsophisticated techniques. Such malicious applications often masquerade as legitimate applications to\nconfuse users into installing them.\n\nUsers should install applications only after verifying their authenticity and install them exclusively from the\nofficial Google Play Store to avoid exposure to such attacks.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\nDownload and install software only from official app stores like Google Play Store.\nEnsure that Google Play Protect is enabled on Android devices.\nUsers should be careful while enabling any permissions on their devices.\nIf you find any suspicious applications on your device, uninstall, or delete them immediately.\nUse the shared IOCs to monitor and block the malware infection.\nKeep your anti-virus software updated to detect and remove malicious software.\nKeep your Android device, OS, and applications updated to the latest versions.\nUse strong passwords and enable two-factor authentication.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Execution** [T1204.002](https://attack.mitre.org/techniques/T1204/002) User Execution: Malicious File\n\n\n-----\n\n**Defense Evasion** [T1418](https://attack.mitre.org/techniques/T1418) Application Discovery\n\n\n**Credential Access** [T1412](https://attack.mitre.org/techniques/T1412)\n\n[T1432](https://attack.mitre.org/techniques/T1432/)\n\n\nCapture SMS Messages\n\nAccess Contacts List\n\n\n**Impact** [T1565](https://attack.mitre.org/techniques/T1565/) Manipulation\n\n## Indicators of Compromise (IOCs) \n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\n**9624131c01da6d5b61225a465a83efd32291fa3f2352445c3c052d9d8cfb2daa** SHA256 Malicious APK\n\n**hxxp://85.214.228[].]140/p.php** IP Communicating\nURL\n\n**asfnfpfibhtrafy[].]ru** URL C2 Domain\n\n**hxxp://87.106.18[].]146/p.php** IP Communicating\nURL\n\n**kkwpifwkkxilltk[.]ru** URL C2 Domain\n\n**hxxp://181.129.180[].]251/p.php** IP Communicating\nURL\n\n**poceeubeciuqyto[].]ru** URL C2 Domain\n\n## About Us\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves from](https://cyble.com/)\ncybercrimes and exposure in the Darkweb. Its prime focus is to provide organizations with real-time visibility\nto their digital risk footprint. Backed by Y Combinator as part of the 2021 winter cohort, Cyble has also been\nrecognized by Forbes as one of the top 20 Best Cybersecurity Start-ups To Watch In 2020. Headquartered in\nAlpharetta, Georgia, and with offices in Australia, Singapore, and India, Cyble has a global presence. To\n[learn more about Cyble, visit https://cyble.com.](https://cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-09 - FluBot Variant Masquerading As The Default Android Voicemail App.pdf"
    ],
    "report_names": [
        "2021-09-09 - FluBot Variant Masquerading As The Default Android Voicemail App.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536110,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653692745,
    "ts_modification_date": 1653692745,
    "files": {
        "pdf": "https://archive.orkl.eu/5f2ddb571d8e04c6b63e9bf9ac26eba69f2bf07c.pdf",
        "text": "https://archive.orkl.eu/5f2ddb571d8e04c6b63e9bf9ac26eba69f2bf07c.txt",
        "img": "https://archive.orkl.eu/5f2ddb571d8e04c6b63e9bf9ac26eba69f2bf07c.jpg"
    }
}