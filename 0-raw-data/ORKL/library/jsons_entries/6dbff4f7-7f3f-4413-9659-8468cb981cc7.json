{
    "id": "6dbff4f7-7f3f-4413-9659-8468cb981cc7",
    "created_at": "2022-10-25T16:48:14.475397Z",
    "updated_at": "2025-03-27T02:17:00.003707Z",
    "deleted_at": null,
    "sha1_hash": "3a34d6152f2d287f58e67a03d96408b74d5c470e",
    "title": "Winnti: More Than Just A Game",
    "authors": "Kaspersky",
    "file_creation_date": "2013-04-10T17:36:36Z",
    "file_modification_date": "2013-04-10T17:36:36Z",
    "file_size": 4817479,
    "plain_text": "# “Winnti”\n\n#### More than just a game\n\n###### April 2013 Kaspersky Lab Global Research and Analysis Team\n\n Contents\n\n Executive Summary ............................................................................................... 2\n\n Winnti 1.0 Technical Analysis ............................................................................... 10\n\n Real Case Investigation (Winnti 2.0) .................................................................... 26\n\n Source of Attacks ................................................................................................. 51\n\n The Search for Attackers (XYZ incident) .............................................................. 53\n\n Conclusions .......................................................................................................... 80\n\n Appendix .............................................................................................................. 81\n\n\n-----\n\n### Executive Summary\n\nThis research, which started in autumn of 2011 by Kaspersky Lab, is still ongoing. The subject of this research\nproject is a series of targeted attacks against private companies around the world.\n\nIn the research, we reveal activity of one of the hacking groups which has Chinese origins. This group was named\n\"Winnti\".\n\nAccording to our estimates, the Winnti group has been active for several years and specializes in cyber-attacks\nagainst the online video game industry. The main objective of the group is to steal source code of online game\nprojects as well as digital certificates of legitimate software vendors. Besides that, they are deeply interested in\nthe set-up of network infrastructure (including production gaming servers) and new developments such as\nconceptual ideas, design and more.\n\nWe aren’t the first to investigate the attacks attributed to the Winnti group.. It is known that, at least in 2010, the\nU.S.- based company HBGary investigated information security incidents related to the Winnti group at one of\nHBGary's customers – an American video game production company.\n\n###### In the beginning …\n\nIn the autumn of 2011, a Trojan was detected on a large number of computers – all of them linked by the fact that\nthey were used by players of a popular online game. It emerged that the piece of malware landed on users’\ncomputers as part of a regular update from the game’s official update server. Some even suspected that the\npublisher itself was spying on its customers. However, it later became clear that the malicious program ended up\non the users’ computers by mistake: the cybercriminals were in fact targeting the companies that develop and\nrelease computer games.\n\nThe computer game publisher whose servers spread the Trojan asked Kaspersky Lab to analyze the malicious\nprogram that was found on its update server. It turned out to be a DLL library compiled for a 64-bit Windows\nenvironment and even used a properly signed malicious driver.\n\nThe malicious DLL infected gamers’ computers running under either 32-bit or 64-bit operating systems. It could not\nstart in 32-bit environments, but it could, under certain conditions, launch without the user’s knowledge or\nconsent in 64-bit environments, though no such accidental launches have been detected.\n\nThe DLL contained a backdoor payload, or, to be exact, the functionality of a fully-fledged Remote Administration\nTool (RAT), which gave the cyber-criminals the ability to control the victim computer without the user’s knowledge.\n\nThe malicious module turned out to be the first Trojan for the 64-bit version of Microsoft Windows with valid\ndigital signature that we have seen. We used to see similar cases before, but in all previous incidents we have seen\ndigital signature abuse, there were only 32-bit applications.\n\nAt an early stage of our research, we identified a number of similar backdoors, both 32-bit and 64-bit, in our\ncollection of malware samples. Thesewere detected under various verdicts. We grouped them together into a\nseparate family. Symantec appears to be the first to name these malicious programs; we kept Symantec’s name –\n\n\n-----\n\nWinnti – in the name of the malware family we created: Backdoor.Win32(Win64).Winnti. As for the people behind\nthese attacks involving this remote administration tool, we ended up calling them “the Winnti group”.\n\nInterestingly, the digital signature belonged to another video game vendor - a private company known as KOG,\nbased in South Korea. The main business of this company was MMRPG (massively multi player online role-playing\ngames) games, which was identical to the business area of the first victim.\n\nWe contacted KOG, whose certificate was used to sign malicious software and notified Verisign, which issued the\ncertificate for KOG. As a result, the certificate was revoked.\n\n##### Digital Certificates\n\nWhen we discovered the first stolen digital certificate, we didn't realize that stealing the certificates and signing\nmalware for  upcoming attacks against other victims was the modus operandi of that group. In eighteen months,\nwe manage to discover more than a dozen  compromised digital certificates.\n\nMoreover, we found that those digital certificates seemed to have been used in attacks organized by other hacking\ngroups, presumably coming from China.\n\nFor example, an attack against South Korean social networks Cyworld and Nate in 2011\n[(http://www.bbc.co.uk/news/technology-14323787)](http://www.bbc.co.uk/news/technology-14323787) - the attackers used a Trojan that was digitally signed using\nthe certificate of YNK Japan Inc gaming company.)\n\nA digital certificate of the same company was used recently (March 2013) in Trojans targeting Tibetan and Uyghur\nactivists\n[(https://www.securelist.com/en/blog/208194165/New_Uyghur_and_Tibetan_Themed_Attacks_Using_PDF_Exploi](https://www.securelist.com/en/blog/208194165/New_Uyghur_and_Tibetan_Themed_Attacks_Using_PDF_Exploits)\n[ts).](https://www.securelist.com/en/blog/208194165/New_Uyghur_and_Tibetan_Themed_Attacks_Using_PDF_Exploits)\nIn fact, this story has long roots dating back to 2011. We highly recommend reading this Norman blog post of a\n[similar incident here: http://blogs.norman.com/2011/security-research/invisible-ynk-a-code-signing-conundrum.](http://blogs.norman.com/2011/security-research/invisible-ynk-a-code-signing-conundrum)\n\n\n-----\n\nAt the same time, in March 2013, Uyghur activists were targeted by another malware which was digitally signed by\nanother gaming company called MGAME Corp according to http://www.f[secure.com/weblog/archives/00002524.html](http://www.f-secure.com/weblog/archives/00002524.html)\n\nWe believe that the source of all these stolen certificates is same group which we call Winnti. This group either has\nclose contacts with other Chinese hacker groups or sells the certificates on the black market in China.\n\nBelow is the list of known compromised companies and digital certificates used by the Winnti group in different\ncampaigns:\n\n**Company** **Serial number** **Country**\n\n**ESTsoft Corp** 30 d3 fe 26 59 1d 8e ac 8c 30 66 7a c4 99 9b d7 South Korea\n\n**Kog Co., Ltd.** 66 e3 f0 b4 45 9f 15 ac 7f 2a 2b 44 99 0d d7 09 South Korea\n\n**LivePlex Corp** 1c aa 0d 0d ad f3 2a 24 04 a7 51 95 ae 47 82 0a South Korea/\nPhilippines\n\n**MGAME Corp** 4e eb 08 05 55 f1 ab f7 09 bb a9 ca e3 2f 13 cd South Korea\n\n**Rosso Index KK** 01 00 00 00 00 01 29 7d ba 69 dd Japan\n\n**Sesisoft** 61 3e 2f a1 4e 32 3c 69 ee 3e 72 0c 27 af e4 ce South Korea\n\n**Wemade** 61 00 39 d6 34 9e e5 31 e4 ca a3 a6 5d 10 0c 7d Japan/South Korea/US\n\n**YNK Japan** 67 24 34 0d db c7 25 2f 7f b7 14 b8 12 a5 c0 4d Japan\n\n**Guangzhou YuanLuo** 0b 72 79 06 8b eb 15 ff e8 06 0d 2c 56 15 3c 35 China\n\n**Fantasy Technology Corp** 75 82 f3 34 85 aa 26 4d e0 3b 2b df 74 e0 bf 32 China\n\n**Neowiz** 5c 2f 97 a3 1a bc 32 b0 8c ac 01 00 59 8f 32 f6 South Korea\n\n##### Victims\n\n[It’s tempting to assume that Advanced Persistent Threats (APTs) primarily target high-level institutions:](https://en.wikipedia.org/wiki/Advanced_Persistent_Threat)\ngovernment agencies, ministries, military and political organizations, power stations, chemical plants, critical\ninfrastructure networks, and so on. In this context, it seems unlikely that a commercial company would be at risk\nunless it was operating on the scale of Google, Adobe or The New York Times, which was recently targeted by a\ncyber-attack, and this perception is reinforced by the publicity that attacks on corporations and government\norganizations usually receive. However, any company with data that can be effectively monetized is at risk from\nAPTs. This is exactly what we encountered here: it was not a governmental, political, military, or industrial\norganization. The target was specifically gaming companies.\n\nAnalyzing the Winnti samples helped to identify who and what were the targets. We found that we were dealing\nwith targeted attacks: the Winnti team infects companies that develop and release computer games. It appears the\nteam has been active for quite a while – since 2009.\n\n\n-----\n\nIt’s difficult to name all the victims of the Winnti team. Judging by the information that we have at our disposal –\nnamely the tags within malicious programs, the names of the C&C domains, the companies whose digital\ncertificates were stolen to sign malware, and the countries where detection notifications came from – we can say\nthat at least 35 companies were infected by the Winnti malware at some time.\n\nCountries where the affected companies are located:\n\nAsia Europe South America North America\n\n\nChina\nIndia\nIndonesia\nJapan\nPhilippines\nS. Korea\nTaiwan\nThailand\nVietnam\n\n\nBelarus\nGermany\nRussia\n\n\nBrazil\nPeru\n\n\nUSA\n\n\nThis data demonstrates that the Winnti team targets gaming companies located in various parts of the world,\nalbeit with a strong focus on South East Asia.\n\n_Countries where gaming companies have been affected_\n\nThis geographic diversity is hardly surprising. Often, gaming companies (both publishers and developers) are\ninternational, having representatives and offices worldwide. Also, it is common practice for gaming companies\nfrom various regions to cooperate. The developers of a game may be located in a different country from its\npublisher. When a game eventually reaches markets in regions away from its initial ‘home’, it is often localized and\nreleased by other publishers. In the course of this cooperation, the partner companies often grant each other\naccess to network resources to exchange data associated with the gaming content, including distribution kits,\n\n\n-----\n\ngaming resources, resource assembly kits, etc. If one company in the network gets infected, it’s easy for the\ncybercriminals to spread the infection throughout the partnership chain.\n\n##### Winnti C&C Structure\n\nDuring the investigation, we identified more than a hundred malicious programs, each individually compiled to\nattack a particular company. Typically, separate command-and-control (C&C) domains were assigned to each\ntargeted company. Virtually all the C&C domains were arranged as follows: a second-level domain was created\nwithout a DNS A-record, i.e., there was no IP address assigned to it.\n\nIn cases where there was an A-record, the assigned IP address was typically 127.0.0.1. It is also noteworthy that\nsome of the second-level domains that the cybercriminals created for their C&C had very similar names to the\ndomain hosting the site of a certain real gaming company. And the malicious users’ domain was resolved to the\nsame IP address which the site of the real gaming company used. In any case, the third-level domains resolved to IP\naddresses assigned to the attackers’ actual C&C servers.\n\n_C&C domain naming and resolution_\n\nSometimes the Winnti team registered their C&C units with public hosts. Judging by the samples identified, these\nC&C centers were subdomains of such domains as 6600.org, 8866.org, 9966.org or ddns.net.\n\nFrom the names of the C&C domains or subdomains, the attack targets or countries of residence could be guessed,\nas in:\n\n**ru.gcgame.info**\n**kr.zzsoft.info**\n**jp.xxoo.co**\n**us.nhntech.com**\n**fs.nhntech.com**\n**as.cjinternet.us**\n\nThe subdomains “ru”, “kr”, ”jp” and “us” most probably mean that these C&C servers manage bots hosted on the\ncomputers of companies located in Russia, South Korea, Japan and the U.S. respectively, while “fs” and “as” are\nacronyms for the names of the companies being attacked.\n\n\n-----\n\nSometimes Winnti’s malicious programs had a local IP address, such as 192.168.1.136, specified in the settings for\nthe C&C. This could mean that, at some point in time, there was an infected computer that did not have a\nconnection to the Internet, but the cybercriminals needed control over it (it may have been infected while malware\nwas spread via a corporate network). In this case, the cybercriminals deployed a dedicated local C&C server on\nanother compromised computer within the same local network which did have an Internet connection; via that\nC&C, the first victim computer could be controlled. System administrators often try to isolate critical computers\nfrom the outside world. This decreases the probability of haphazard infection, but, apparently, does not always\nhelp in a targeted attack.\n\nIn the Winnti samples that were detected and analyzed, we found 36 unique C&C domains. Most probably, this is\nonly a small portion of all existing Winnti C&C domains, as we only managed to obtain some of the samples from\nthis malware family. This is hardly surprising since these malicious programs are used to execute targeted attacks,\nso no information is available about many instances of infection; for this reason, we have no way of obtaining\nsamples of the malware used in these undisclosed attacks.\n\n\nDomain names used in the attacks we discovered\n\n\nnewpic.dyndns.tv\nupdate.ddns.net\nnd.jcrsoft.com\ncc.nexoncorp.us\nkr.zzsoft.info\nas.cjinternet.us\nca.zzsoft.info\nsn.jcrsoft.com\nlp.apanku.com\nsshd.8866.org\nftpd.6600.org\ntcpiah.googleclick.net\nrss.6600.org\nlp.zzsoft.info\nlp.gasoft.us\neya.jcrsoft.com\nftpd.9966.org\nkr.xxoo.co\nwi.gcgame.info\ntcp.nhntech.com\nka.jcrsoft.com\nmy.zzsoft.info\njp.jcrsoft.com\nsu.cjinternet.us\nvn.gcgame.info\nap.nhntech.com\nru.gcgame.info\nkr.jcrsoft.com\nwm.ibm-support.net\nfs.nhntech.com\ndocs.nhnclass.com\nrh.jcrsoft.com\nwm.nhntech.com\n\n\n-----\n\nwm.myxxoo.com\nka.zzsoft.info\nad.jcrsoft.com\nmy.gasoft.us\n\nKnowing the 2[nd] level domains used by Winnti, we brute forced through all third level sub-domains up to 4 symbols\nlong, and identified those that have the IP addresses of real servers assigned to them. Having searched through\nsubdomains for a total of 12 second level domains, we identified 227 “live” third level domains. Many of them are\nC&C servers for Winnti-class malware that have hitherto remained unidentified.\n\nAnalyzing the WHOIS data for the 12 second level domains, we found the following list of email addresses used for\nregistration:\n\n**evilsex@gmail.com**\n**jslee.jcr@gmail.com**\n**whoismydns@gmail.com**\n**googl3@live.com**\n**wzcc@cnkker.com**\n**apanku2009@gmail.com**\n\nFor some of these domains, registration data proved to be the same as those for the domain google.com:\n\n_Registrant: Google Inc._\n_1600 Amphitheatre Parkway_\n_Mountain View, California 94043_\n_United States_\n_+1.6503300100_\n\nJudging by the domain registration data, the Winnti team started their criminal activities as far back as 2007. The\nearly domains were involved in spreading rogue anti-virus programs (FakeAV). From 2009 onwards, domains began\nto emerge hosting C&C servers for bots used to infect gaming companies. Apparently, the cybercriminals\ngraduated to relatively large-scale penetrations into the corporate networks of gaming companies starting from\n2010.\n\n##### Known Malware\n\nThe favorite tool of the attackers is a malicious program we call \"Winnti\". It has evolved since the first use, but we\ndivide all variants into two generations: 1.x and 2.x. Our publication describes both variants of this tool. The second\ngeneration (2.x) was used in one of the attacks that we investigated in the active stage and helped the victim to\ninterrupt data transfer and isolate infections in a corporate network.\n\nIn addition to that, we observed usage of a popular backdoor known as PlugX, which is believed to have Chinese\norigins, however used only previously in attacks against Tibetan activists.\n\n\n-----\n\n##### The Commercial Interest \n\nAs has been stated above, APTs can target any commercial company if cyber-criminals find a way to financially\nprofit from the attack.\n\nSo what methods do cyber-criminals use to generate illicit earnings from attacks on gaming companies?\n\nBased on the available information, we have singled out three main monetization schemes that could be used by\nthe Winnti team.\n\n  - **The unfair accumulation of in-game currency/“gold” in online games and the conversion of virtual funds**\n**into real money.**\n\n  - **Theft of source code from the online games server to search for vulnerabilities in games – often linked to**\n**point 1.**\n\n  - **Theft of source code from the server part of popular online games to further deploy pirate servers.**\n\nLet’s look at an example. During our investigation of an infection at a computer gaming company, we found that\nmalware had been created for a particular service on the company’s server. The malicious program was looking for\na specific process running on the server, injected code into it, and then sought out two places in the process code\nwhere it could conceal call commands for its function interceptors. Using these function interceptors, the malicious\nprograms modified process data which was processed in those two places, and returned control back. Thus, the\nattackers change the normal execution of the server processes. Unfortunately, the company was not able to share\nits targeted application with us, and we cannot say exactly how this malicious interference affected gaming\nprocesses. The company concerned told us that the attackers’ aim was to acquire gaming “gold” illegally.\n\nMalicious activity like this has an adverse impact on the game itself, tilting the balance in favor of cheats. But any\nchanges the Winnti team introduces into the game experience are unlikely to be very noticeable. After all,\nmaintaining a skillful balance is the main attribute of online games. Users will simply stop playing if they feel that\nother players are using non-standard methods to create an advantage beyond normal gameplay or if the game\nloses its intrinsic competitiveness due to resources or artifacts appearing in the game without the developers’\nknowledge. At the same time, the attackers are keen for the game to remain popular; otherwise, they would be\nunable to effectively turn all the time and effort of infecting a gaming company into financial gain.\n\nMembers of the Winnti team are patient and cautious. Cyber-criminals have affected the processes of the online\ngames from the infected companies and stolen money from them for years, but they have found ways of doing this\nwithout attracting attention to themselves.\n\n\n-----\n\n## Winnti 1.0 Technical Analysis\n\n##### The Initial DLL\n\nEverything starts with a DLL. The DLL mimics one of the standard Windows libraries, winmm.dll or apphelp.dll.\nSince, in the vast majority of cases the samples that we detected disguised themselves as winmm.dll, we would like\nto fix this name for this malicious library at the end of this document.\n\nLegitimate winmm.dll is a Windows system library that provides multimedia functions. It is located in\nthe %WINDIR%\\System32 folder. The attackers counted on this being a library providing basic system functions\nand hence the probability of it being loaded by some program is very high (this is also valid for apphelp.dll). For\nexample, winmm.dll is loaded by explorer.exe, which is launched during operating system startup and is essential\nfor Windows user interface.\n\nThe mechanism to start the malware is simple: if some benign application depends on Windows winmm.dll\n(located in %WINDIR%\\System32\\winmm.dll) but the evil twin library with the same name (winmm.dll) is located\nin the folder of benign application, the malicious library will be loaded instead of the system one.\n\nTaking advantage of their control of an infected computer, the attackers place a malicious library in the %WINDIR%\nfolder. The same folder also contains explorer.exe. This enables the attackers to ensure that the malicious DLL is\nloaded at system startup: explorer.exe loads the malicious winmm.dll from the %WINDIR% folder as soon as it\nlaunches during system startup.\n\nBut how can a program which depends on the original library work correctly if a malicious winmm.dll is loaded\ninstead of the original library? Very easy: the malicious library is designed to work as a proxy for the original\nwinmm.dll from the %WINDIR%\\System32 folder.\n\nThe cyber-criminals did not reinvent the wheel to make sure that everything works properly. They relied on a tool\nknown as AheadLib, which was developed by security researchers to analyze malware.\n\n\n-----\n\nThis program, which is designed to facilitate the analysis of malicious libraries, was created by a Chinese developer\nemployed by an Asian anti-virus vendor. The program accepts a DLL on input and produces a C code which hooks\nthe functions included in the library. The C code is compiled back into a DLL, which can then be used as a proxy and\nprovide flexible way to analyze behavior of malicious file.\n\n\n-----\n\n_Hook functions (code generated by the legitimate program AheadLib)_\n\nThe flexibility of this tool allows to customize the logics of malicious application during analysis and overload\nfunctions code to provide some debugging output. Some code can be added to display parameters of the hooked\nfunctions in order to find out which values are passed to the original functions when they are called. This method is\nused in so called dynamic analysis of malicious applications.\n\n\n-----\n\n_Determining the addresses of the real functions_\n_(error message in the frame: “Function %hs cannot be found,_\n\n_the program will not operate correctly”)_\n\n\n-----\n\n_Modified module loading the original DLL_\n_(error message in the frame: “%s cannot be loaded, the program will not operate correctly”)_\n\nIronically, the malware authors have found this to be a convenient application for creating malicious proxylibraries. They specified a system library (winmm.dll) as a parameter for AheadsLib tool and produced a source\ncode template to create a proxy DLL – in the form of C file. By overloading some functions with the malicious\npayload, the attackers created a complete piece of malware that included all the features of the system DLL.\n\nStrangely, the attackers kept the code for AheadLib debug messages in the early versions of their malware (marked\nwith red in the screenshots above). These strings can also be found in compiled malicious binaries:\n\n_The function %hs cannot be found, the program will not operate correctly_\n\n\n-----\n\n_%s cannot be loaded, the program will not operate correctly_\n\nLater, these fragments were removed from the C file generated by AheadLib.\n\n##### Control DLL\n\nThe winmm.dll malicious library maintains another library in its body, which is decrypted and loaded into the\nprocess memory without creating any files on local disk. According to file version info the original name of this\nlibrary is \"PlusDLL.dll\". This is the platform’s main control component. When the additional DLL has been properly\nallocated in the memory, winmm.dll passes control to it with a parameter – a string which contains bot settings.\nThe settings string, in encrypted form, is also located in the winmm.dll body – after the magic word \"PLUSUNIT\".\n\n_Encrypted bot settings_\n\nAfter decryption, the string contains the following:\n\n**url=lp.gasoft.us:80|ver=1018|tag=33|group=lp80wi**\n\nApparently, when the Winnti malware managed to get into focus of security researchers: the authors made\nmodifications of the methods used to store these initial settings. In some samples, the settings were hidden even\nin the executable file’s header:\n\n\n-----\n\n_Encrypted settings in the header of malicious executable_\n\nIn other variants, the ‘PLUSUNIT’ magic string was modified:\n\n_UUUSUN”” instead of PLUSUNIT_\n\nThe PlusDLL library has an embedded driver. The driver is stored in %WINDIR%\\System32\\<drivername.sys> file,\nregistered as a service and started by NtLoadDriver system API function. Immediately after that, the driver’s file is\nremoved, as well as all the registry entries created during service registration. The executable preserved the\noriginal driver names which are \"PortLess\" and \"PointFilter\"; however, the driver files used during infection are\nsaved  as \"sp1itter.sys\" and \"acplec.sys\".\n\nThe purpose of the driver is to hide network connections established by the malware. For example, if the user\ndecides to check a list of established connections (e.g., using the ‘netstat –a’ command or the tcpview program)\nwhile the bot is communicating to the control center, the driver will protect and hide the malware connections.\nThis approach is used by many rootkits on the Windows platform.\n\nThe driver uses an interesting method to get the list of addresses to protect connections with. This information is\navailable in the PlusDLL control library, which normally operates in the context of the explorer.exe process when\nthe infection is active on the computer. The address information is sent from the user space (from PlusDLL) to the\nkernel space, where the driver works, via call to NtSetQuotaInformationFile API function.\n\n\n-----\n\nDuring initialization, the driver hooks the NtSetQuotaInformationFile function:\n\n_Hook on NtSetQuotaInformationFile function_\n\nEvery time the function is called, the driver checks its parameters: to be precise it is HANDLE FileHandle and PVOID\nBuffer parameters.\n\nThe FileHandle parameter holds a descriptor of the partition on the hard drive where the function is expected to\nset disk quotas.\n\nThe Buffer parameter is a memory buffer with information of new quotas to be set. The driver checks whether the\nvalue of the FileHandle parameter is equal to minus two. When the system calls the NtSetQuotaInformationFile\nfunction to actually change the quotas, the descriptor must be associated with one of the disks. Normally such\ndescriptors in the Windows system are positive integers which obviously means that it cannot be equal to minus\ntwo. The negative value is set by the PlusDLL library in order to make the driver detect that the\nNtSetQuotaInformationFile function was called by that library. When calling NtSetQuotaInformationFile, PlusDLL\nsends information about the network addresses to be protected by the driver via the Buffer parameter. If\nFileHandle is not equal to minus two, the hook function in the driver passes control to system's original code of\nNtSetQuoataInformationFile API function and everyhin works as it should be on an uninfected system.\n\n\n-----\n\n_Sending data from the PlusDLL.dll library to the sp1itter.sys driver_\n\nNote that 64-bit versions of Windows do not allow unsigned drivers to run. The malicious driver’s 64-bit versions\nwere signed using stolen certificates. During the time that we have been tracking the Winnti group, we found 11\ncertificates that were used to sign the malware used by the group (not necessarily drivers only). Ten of them\nbelong to various companies in the gaming industry.\n\n###### Launching the main function\nAs mentioned above, the PlusDLL library is a control module. Let’s look at how the cybercriminals implemented the\ntransition to perform the malicious DLL’s main tasks. They could have simply called an appropriate function directly\nor created a separate thread in which to execute it, but for some reason they resorted to a trick: the code of the\nSetWindowStationUser function in the user32.dll library was modified. After modification, the function’s first\ncommand became jmp <addr>, where <addr> is the address of the function in the PlusDLL library which\nimplements the malicious library’s main features.\n\n\n-----\n\n_Hook on SetWindowStationUser_\n\nImmediately after this modification, a thread is created (CreateThread) executing code starting from the\nSetWindowStationUser function address. As a result, when control is eventually passed to this function, the\ninserted command jmp <addr> returns control back to the PlusDLL code.\n\n\n-----\n\n_Malicious DLL launching its own code by creating a thread that supposedly calls SetWindowStationUser_\n\nThe same method is used to execute two more functions in the PlusDLL library. One of them is used to initialize\nnetwork routines; the other executes procedures terminating the malicious program at the very end. The only\ndifference is that instead of SetWindowStationUser, the code of two other functions from user32.dll is modified –\nEndTask and WinHelpW, respectively.\n\nIt is likely that this was done in order to hide the real addresses of functions in PlusDLL in case its code was\nanalyzed based on its execution logs using an automatic system (sandbox) that looks at all function calls. If this trick\nis used, an execution log would only show threads launched from the addresses of the functions\nSetWindowStationUser, EndTask and WinHelpW, which could potentially confuse researchers.\n\nAnother possibility is that this is an anti-emulation feature. Perhaps the emulators built into some anti-virus\nproducts are unable to cope with these ‘leaps’ – in this case, emulation will not result in the execution of malicious\nfunctions, which also suits the cybercriminals’ purposes.\n\n###### Target Functionality\n\nSo what does PlusDLL control? It turns out that the target functionality is implemented in different files. Each file\nprovides a specific remote control feature and is downloaded from the attackers’ server every time the system\nstarts up. These files are not saved on disk or in the registry but are loaded directly into the memory.\n\nAt the very start of the operation, after launching the driver, PlusDLL collects information about the infected\nsystem. A unique identifier for the infected computer is generated based on information about the hard drive and\nthe network adapter’s MAC address, e.g., TKVFP-XZTTL-KXFWH-RBJLF-FXWJR. The attackers are interested\nprimarily in the computer’s name, the program which loaded the malicious library, as well as information about\n\n\n-----\n\nremote desktop sessions (session name, client name, user name and session time). All of this data is collected in a\nbuffer, which is then compressed and sent to the attackers’ control center. The buffer may look like this:\n\n_The bot sends information about an infected system to the control center_\n\nIn reply to this initial message from the bot, the control center sends the list of available plugins. Plugins are DLL\nlibraries that provide specific remote control functions. Upon receiving the list of plugins, the bot downloads them,\nallocates them in the memory and passes control to these libraries.\n\nDifferent C2 servers could push different plugins. In total we have discovered eight functional libraries:\n\n**Plugin Name** **Plugin Purpose**\n\nCmdPlus Provide access to the system command line.\n\nListFileManager Provide access to the file system: list directory contents, manipulate files.\n\nListProc List or kill running processes.\n\nListService List system services.\n\nPortMap Redirect traffic using port forwarding.\n\nRemoteDesktop Enable Remote Desktop service on the infected machine.\n\nSocks5Client Library for transferring data over the network using a SOCKS5 proxy server.\n\nTransPlus Enables the attacker to transfer files: receive files from the infected machine,\ndownload/create/save files, as well as execute programs on the infected\ncomputer.\n\nThese plugins form the core toolkit which is used by the perpetrators during attack.\n\n\n-----\n\n###### Operation of the malicious platform\n\n_Operation flowchart at the initial stage_\n\nAs you can see, the cybercriminals use an entire inventory of malicious tools to effectively control the remote\ncomputer. Moreover, they have taken measures to conceal their activities: the plugins do not explicitly appear\nanywhere except in the computer’s memory; they do not get saved to the hard drive; the driver is deleted\nimmediately after launch; all traces in the registry that could indicate this launch get deleted. Only the initial DLL\nremains on the disk that kick starts the entire process and contains an encrypted version of PlusDLL which is the\ncontrol DLL.\n\nOne of the weak points in this architecture is that the driver does get saved to the hard drive before it launches, so\nanti-virus products can detect the emergence of this file. The situation is further exacerbated by the fact that the\nmalicious drivers may be signed (although not all drivers in the Winnti samples that we detected were in fact\nsigned). An unsigned driver in itself does not have the means to counter antivirus products and its code can be\neasily recognized as malicious, whereas signed drivers stand a better chance of remaining undetected by antivirus\nproducts: certain anti-virus products consider properly signed programs legitimate by default, so as to minimize\nthe chances of false positive responses.\n\n\n-----\n\n**Kaspersky Lab’s products detect the malicious programs described above under the following verdicts:**\n\n**The initial DLLs winmm.dll and apphelp.dll, the PlusDll.dll control DLLs, and functional loadable modules**\n**(CmdPlus.dll etc.) are detected as Backdoor.Win32.Winnti or Backdoor.Win64.Winnti.**\n\n**The drivers sp1itter.sys and acplec.sys are detected as Rootkit.Win32.Winnti or Rootkit.Win64.Winnti.**\n\n##### Communication with the C&C Server\n\nThe data transmitted during the communication between the bot and the C&C server, naturally, do not manifest\nthemselves in any explicit form in online data traffic. Since an active remote control practice can generate\nsubstantial traffic, cybercriminals compress communication data with the algorithm LZMA, though they do not\ninclude the appropriate header inherent to this algorithm.\n\nThe data is transmitted over the TCP protocol. The samples that we analyzed established connections between\nC&C servers and ports 53, 80 and 443. This port selection is not surprising: they are associated with the protocols\nDNS, HTTP and HTTPS respectively. All three are routinely used in everyday operations, so they are enabled under\nmost firewall policies. Besides, large amounts of data typically pass through these ports (with the possible\nexception of port 53), which makes it easier for the malicious traffic to remain inconspicuous.\n\nAlthough the ports are associated with certain protocols, the actual content of the traffic generated by the\nmalicious program does not correspond to them. Early versions of the Winnti platform exhibited the following\ntraffic structure when communicating with C&C: each block of transmitted data started with the magic number\n0xdeadface, followed by the number of blocks (in a DWORD), then the hash of the transmitted block (8 bytes), the\nsize of compressed data (DWORD), the size of source data (DWORD) and, finally, the actual compressed data.\n\n_The unit structure of a data block transmitted online in early versions of Winnti_\n\nThis is where another weak point of the Winnti family of backdoors becomes apparent. With this data structure,\nmalicious network traffic could easily be spotted by, for example, the magic number 0xdeadface. The\ncybercriminals probably lost control over victim computers fairly frequently as corporate system administrators\nidentified the intrusion by the unique headers in data packets with the help of IDS/IPS systems, and cleaned their\nnetworks. In 2011, new versions of Winnti backdoors appeared that, while still based on the same platform,\nstarted to use an updated protocol which included extra encryption to communicate with C&C, so the transmitted\n\n\n-----\n\ndata no longer had static marks in them. Prior to encryption, the data has the following structure (very similar to\nthe earlier format): the first 4 bytes are taken by the magic number 0xaced1984, then a DWORD of data packet\ndescription, the next DWORD carries a zero value, 8 bytes of the hash of the transmitted block, then a DWORD\nwith the size of the compressed data, a DWORD with the size of the source data and then the actual compressed\ndata:\n\n_The unit structure of a data block transmitted online in newer versions of Winnti_\n\nThen the data is encrypted with regular XOR with a random DWORD size value, and in this form transmitted to the\nC&C. Knowing that the first four bytes in the source data must represent the value 0xaced1984, it is easy to restore\nthe key for the XOR operation when the data were encrypted. This is how the above data (the XOR value was\n0x002a7b2e) looked when it was intercepted in network traffic:\n\n_Encrypted data block transmitted online, in the newer versions of Winnti_\n\nSince the encryption key (the value with which the source data are encrypted with the XOR operation) is different\neach time a fragment of data is transmitted, no more static unique labels can be found in the network traffic which\nwould quickly identify the transmitted data as belonging to the Winnti backdoor. Employing this fast, basic\nmethod, the cybercriminals have made it much harder to expose their programs’ traffic.\n\n\n-----\n\nWhichever protocol is used (with or without extra encryption), the workflow of communication between the bot\nand the C&C stays the same at the initial stage of operation:\n\n###### ● The bot sends the first data block, thus signaling itself;\n\n ● In response, the C&C sends back the list of available plugins \n\n ● The bot starts to download plugins, sending one request at a time to download each plugin \n\n ● The C&C sends the requested plugin\n\n ● The bot sends a message that the plugin has arrived.\n\nWe should note here that, to expedite data downloading, the creators of this platform have quite skillfully\nimplemented asynchronous data transmission in their protocol. For instance, the message that the bot has\nreceived the first plugin may only arrive at the C&C when nearly all the plugins have been already sent to the bot.\n\nHaving downloaded the malicious payload, the bot deploys the plugins in the memory and initializes them. Now it’s\nall set for complete remote control over the victim computer, and the bot switches to standby mode, waiting for\nthe operator to connect and maintaining communication with the C&C by sending “empty” messages every 15\nseconds or so.\n\nApart from supplying the plugins, no more automatic actions are performed by the C&C: all of the work to examine\nthe infected computers is done manually by the attackers.\n\n\n-----\n\n## Real Case Investigation (Winnti 2.0)\n\n_Please note, that the following is published with approval from one of the attacked companies which preferred to_\n_remain anonymous. The real company name was replaced with \"CompanyXYZ\" or simply \"XYZ\"._\n\nOn 21st September 2012, a Security Officer of CompanyXYZ contacted Kaspersky Lab and reported a cyber-attack\nincident. Anomalous activity was spotted at one of the corporate servers. One of the employees noticed a\nsuspicious directory on the server which was created under his account. The folder had a large archived file with\ninformation that was regarded as company's intellectual property.\n\nThe anomalies were also confirmed in the network traffic by monitoring software. Several suspicious network\nconnections were established from several computer systems, including network domain controllers, to IP\naddresses which were not associated with any corporate resources or any other known trusted networks.\n\nThe suspicious connections were established on ports 443 and 53. Below is the list of reported IP addresses:\n\n**211.60.126.164 (Seoul, South Korea)**\n**113.196.70.169 (Taipei Taiwan)**\n\nThe security officer at CompanyXYZ did an on-site analysis and managed to locate the process which initiated the\nsuspicious connections using SysInternals Process Explorer tool. The connections were initiated by a system\nprocess (svchost.exe). A full process dump using Process Explorer was made and shared with Kaspersky Lab. Our\nteam immediately started searching for malware in the provided process dump.\n\nA next day, one more dump of svchost.exe from another presumably infected machine was provided.\n\nWe also received an IP address and port that was spotted in the suspicious connections coming from infected\nmachines: 188.120.246.88:80 (Russia).\n\n##### First Step Analysis\n\nQuick search through the dumped processes revealed IP addresses mentioned by the company's security officers.\n\n_Suspected malicious IP address in svchost.exe memory of Machine #1._\n\n_Suspected malicious IP address in svchost.exe memory of Machine #2._\n\n\n-----\n\nWe checked memory around location of the IP address and found no signs of executable code. The memory was\nmost likely dynamically allocated on process heap and used as a temporary storage of resolved domain name. That\nis why we had to find another indicator of malicious module related to those IP addresses.\n\nWe initiated a port scan of the suspected hosts in parallel to memory analysis. Below is the result on the time of\nscanning:\n\nNmap scan report for 113.196.70.169\nHost is up (0.29s latency).\nNot shown: 997 filtered ports\nPORT   STATE SERVICE    VERSION\n21/tcp  open  ftp      Xlight ftpd 2.0\n80/tcp  closed http\n**3389/tcp open  ms-wbt-server Microsoft Terminal Service**\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nThe server was running Windows Terminal Service or was used as a proxy linked to some Terminal Server.\nEstablishing connection via RDP client usually reveals default system locale which is used on welcome screen.\nBelow is what we found upon connection:\n\n_Chinese locale on terminal server welcome screen at 113.196.70.169_\n\n\n-----\n\nChecking one of IP addresses on robtex.com brought two possible domain names:\n\n_Robtex shared host names for IP 113.196.70.169._\n\nOne of these domains was found in the memory of dumped svchost process.\n\n_Domain name related to the suspected IP address on Machine #2._\n\n_Part of executable configuration seen in svchost memory dump of Machine #1._\n\n\n-----\n\n**Googlefiles.net domain was also found in svchost dump of the Machine #1. Besides that, several other domain**\nnames were discovered in the same memory block:\n\n**service.interdriver.net**\n**service.googlefiles.net**\n**service.dell-support.org**\n**service.hp-supports.com**\n\nNext step was to locate the nearest PE header in the memory of svchost and extract the executable module. After\nfixing alignment of the sections the file was ready for further static analysis.\n\nDate and time from PE header showed that the executable was prepared about a year before current attack was\nrevealed:\n\n**TimeDateStamp:  \"2011-10-13 07:21:50\"**\n\nThe executable was a 64-bit application which means that the attackers had already known that CompanyXYZ used\n64-bit systems.\n\nThe IP address 188.120.246.88, which was seen in suspicious connection was also checked. Connecting to the port\n80 of that address with simple TCP client displayed an HTTP GET request:\n\nGET /G-Content_XYZ.rar HTTP/1.1\nAccept: */*\nCache-Control: no-cache\nConnection: Keep-Alive\nHost: 127.0.0.1:81\nPragma: no-cache\nRange: bytes=23021988299-27335921161\nReferer: http://127.0.0.1:81\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\n\nUsually the request is sent by the connecting client, but here the chat between client and server is obviously\ninversed. That is probably done by the attackers’ tunneling setup which established a TCP connection with some\nlocal web server within the company network and an external host that received the stolen data. According to the\nrequest, the attackers were downloading a file called G-Content_XYZ.rar, which seems to be an archive of over\n25Gb long. The transfer process was instantly interrupted by Security Officers of the company.\n\n##### Tactical Pattern Recognition\n\nThe embedded configuration shows some file names. C_20100.NLS was discovered later as the file hosting the\nsame malicious code on the hard drive. WinIo.sys is a driver module on Microsoft Windows Server systems used to\nprocess networking requests.\n\nAnother interesting piece of data was in a short string “xyz”, which probably refers to the attack campaign name\nand was defined by the attackers, who deliberately put that name to tag the malware. The word “xyz” most likely\nstands for the campaign name which comes from the attacked company's name “CompanyXYZ”.\n\nThat was the first evidence that we were dealing with a well-prepared targeted attack against CompanyXYZ. From\nour previous experience, we have seen several targeted attacks against gaming companies and some of them were\nalso tagged after the name of the companies. In all those attacks there was a recognizable pattern of the attackers:\nthey always used third-level domain names for the command and control server of the malware while second-level\n\n\n-----\n\ndomain name usually resolved to 127.0.0.1 or was a public DDNS domain. A quick check confirmed that this tactical\npattern was present in this case as well. Since then, we believed that it is the same attackers we  already knew\nabout. This group of attackers was internally labeled “Winnti” by one of our researchers, who named it after one of\nthe very first discovered executable malicious modules.\n\n##### Active Attack Countermeasures\n\nAs soon as we discovered additional configuration, secondary domain names and IP addresses that could be used\nto control the infected hosts, we instantly reported it to the CompanyXYZ’s Security Officer, who instantly adjusted\nnetwork firewall rules to block all connections to the attackers’ hosts.\n\nAssisted remote system analysis of another infected machine resulted in discovery of C_20100.NLS file in the\nWindows system directory and a reference in the system registry to start malicious module as system service:\n\nHKLM\\System\\CurrentControlSet\\services\\Nwsapagent\\Parameters\\\n\nServiceDll = C:\\Windows\\system32\\c_20100.NLS\n\nServiceMain = StartMain\n\nServiceDllUnloadOnStop = 1\n\nDate of registry key creation was the first discovered time of the attack (however, we found an earlier date later):\n\nThu Sep 6 04:26:19 2012\n\nMalicious service registry settings were hidden by a rootkit module, however it helped to identify an infection as\nthe registry key name was the same on all the affected computers. Simple creation of a key named\nHKLM\\System\\CurrentControlSet\\services\\Nwsapagent could fail if the system was infected.\n\n_Rootkit detection method - registry key renaming fails if the key already exists._\n\nThe rootkit module protected the registry key, but it didn't protect the executable module stored on the hard\ndrive. It was possible to rename c_20100.NLS file, reboot the machine and clean the registry.\n\nAlternative and even more reliable method was to reboot into Windows Safe Mode, clean the registry key and\ndelete the c_20100.NLS file. This method was used by company's System Administrators to find other modules that\nwere not in c_20100.NLS.\n\n##### The Infection Vector\n\nSince the infection was located and cleaned, the next step was to locate the breach used by the attackers to\npenetrate the network. Security Officers of the company suggested to start checking from a distinct host they have\n\n\n-----\n\nsuspected. The host (lets call it Machine #3) belong to an employee without network administrators rights. It was\nknown that it had connected to the attackers' IPs like the server systems.\nThe affected company’s security officers obtained a copy of the hard drive of the suspected machine and provided\na remote access to the disk image. Browsing through the directory structure based on the suspected and adjacent\ndates of infection (01-06 September 2012) revealed a couple of suspicious files that could have been related to the\nattack:\n\nC:\\RECYCLER\\en.exe\nType: PE file\nCreated: 2012-09-06 04:08:53 UTC\nSize: 405504\nMD5: cf119a66d4c3e2355c1ec4ac316a7130\n\nC:\\WINDOWS\\system32\\drivers\\tcprelay.sys\nType: PE file (native)\nCreated: 2012-09-05 17:27:04 UTC\nSize: 99912\nMD5: 0b105cd6ecdfe5724c7db52135aa47ef\n\nPreliminary analysis of tcprelay.sys proved that it was a malicious file which had another encrypted executable file\nembedded in it. This gave an even earlier suspected timestamp of infection:\n\n2012-09-05 17:27:04 UTC or 2012-09-05 20:27:04 (local system timezone, UTC+3)\n\nAt the time of check there was no reference in the registry that was linked to tcprelay.sys, perhaps due the fact\nthat system administrators had already cleaned the registry. This was confirmed by a file in local Administrator's\nDesktop folder:\n\nC:\\Documents and Settings\\Administrator\\Desktop\\1.reg (created on 2012-09-24 12:44:07 UTC)\n\nThe file had an exported registry data, which had been removed from the registry during system cleanup on 24th\nSeptember 2012. Here is the original contents of the registry key\n(HKLM\\SYSTEM\\CurrentControlSet\\Services\\tcprelay) before it was removed:\n\n_Tcprelay.sys registry settings with original file path._\n\nOnce the infection on the machine was confirmed we started looking for the origins of the malicious files. From our\nprevious experience of Winnti gang tactics, we knew that they are keen on sending targeted emails with attached\nexecutables. Security Officers helped us check all the emails stored in local Outlook database file on suspected\ndates of infection, however that didn't reveal anything suspicious.\n\nWe have also found system event log files which were copied and analyzed. Event logs had records of tcprelay\nservice start timestamps which confirmed the discovered date of infection. User SID corresponded to the local user\naccount according to the registry.\n\n\n-----\n\n_Tcprelay service first start time from the Event Log_\n\nThe Machine #3 had an anti-virus program installed. Checking detection logs of the anti-virus on the suspected\ndate of infection (05.09.2012) showed that there was a single detection right before tcprelay service first start.\n\n_Part of the antivirus quarantine log._\n\nWe recovered the PDF document called “Transmission with Steps, Realited and Compressed.pdf” from the antivirus quarantine and prepared to find an exploit inside. The PDF had a lot of obfuscated JavaScript code inside,\nhowever we believe that it was not related to the original infection of the system. It was clean and the anti-virus\ndetected it by mistake, probably because of some suspicious obfuscated JavaScript code.\n\n\n-----\n\n_PDF document detected by the antivirus as malicious._\n\nThe JavaScript code inside the PDF was used to process an interactive form inside the PDF and support dynamic\ninteractive 3D model embedded in the document using Adobe 3D technology.\n\nAfter that, we checked the infected machine’s browser history. The Internet Explorer history log files showed that\nthe user was reading  email right before the infection of his machine.\n\n_Internet Explorer log history record: html file from Outlook._\n\n\n-----\n\nWith that in mind, we analyzed the Outlook local database again. This time we used several techniques to recover\nemails that were deleted from the Trash folder. This helped to partly recover a message which arrived on the day\nof infection.\n\n_Recovered targeted attack email on Machine#3._\n\nThe text of the message supposed to contain an attachment, however the attachment and MIME headers of the\nemail were completely lost and couldn't be recovered. However, it was clear that the email was a targeted attack\nagainst the employee of the company. It was sent from companyxxyz@163.com and replaced “From” field in the\nemail body which made it look like a legitimate email in the list of messages in Outlook.\n\n_Targetted attack email in the list of Outlook messages._\n\n\n-----\n\nWe discovered a Windows prefetch file in the system directory, that was created when the malicious attachment\nwas opened. The timestamp correlates with the time of infection.\n\nC:\\WINDOWS\\Prefetch\\CompanyXYZ EMPLOYEE SALARY ADJ-1AF9D56A.pf\n\nTime of creation: 2012-09-05 19:52:00 (local timezone, UTC+03)\n\nUnfortunately, the prefetch file format is proprietary and there is nothing interesting in those files, except the\noriginal executable file name. Full path of the malicious executable that infected the first computer in the company\nwas:\n\nC:\\Documents and Settings\\<Username>\\LocalSettings\\Temp\\RAR$EX00.156\\CompanyXYZ EMPLOYEE SALARY\nADJUSTMENTS EBOOK.EXE\n\nAccording to the file path, this executable was a part of an archive, which was opened with WinRAR installed on\nthe system.\n\nUpon discovery, we requested the Security Officers to provide us with full MIME  as well as to check who else may\nhave received the same message. The check discovered series of emails sent to several publicly known email\naddresses. In all cases the text message was the same as shown above, however sent from different mailboxes. The\nReturn-Path MIME filed seemed to have the original email addresses of the attackers:\n\n**companyxxyz@163.com**\n**company.xyz@gmx.com**\n\nThe attackers used the same IP to send out emails: 118.142.11.114\n\ninetnum: 118.140.0.0 - 118.143.255.255\nnetname: HGC\ndescr: Hutchison Global Communications\ncountry: HK\nperson: ITMM HGC\nnic-hdl: IH17-AP\ne-mail: hgcnetwork@hgc.com.hk\naddress: 9/F Low Block,\naddress: Hutchison Telecom Tower,\naddress: 99 Cheung Fai Rd, Tsing Yi,\naddress: HONG KONG\nphone: +852-21229555\nfax-no: +852-21239523\n\nThe emails we checked had the same attachment of 96782 bytes named “Salary adjustments.zip”. There was only\none file inside ZIP archive, called “CompanyXYZ Employee Salary Adjustments Ebook.exe”. Full details about this\napplication are provided further down in current report.\n\nTo summarize, the targeted attack started from an email sent at 05.09.2012 19:12 (UTC+03).\nIt resulted in system infection at 05.09.2012 19:52 (UTC+03).\n\n\n-----\n\n##### Full File Analysis\n\n###### Salary adjustments.zip File\n\nSize: 96782\nMD5: 1b56416fefa2d2c863f3b46dfb6dc353\nLocation: targeted attack email message attachment\nCreation time (author's timezone): 2012-09-05 14:29:10\n\nThis file is just a container for “CompanyXYZ Employee Salary Adjustments Ebook.exe”.\n\n###### CompanyXYZ Employee Salary Adjustments Ebook.exe File\nSize: 122880\nMD5: 6ef66c2336b2b5aaa697c2d0ab2b66e2\nLocation: “Salary adjustments.zip”\nCreation time: unavailable\nLink time (UTC): 2012-07-21 18:50:18\n\nInternal name: FlashUpdate.EXE\n\nThis application is a wrapper for another embedded executable modules. It serves as a dropper of malware.\n\n_Malware dropper file structure_\n\nNotable fact: this application has a resource section inside and the default locale is set to Chinese Simplified.\n\nThe file creates three long binary data registry keys, two of which are encrypted executable modules and one\nencrypted config from the body of the original dropper. These values are encrypted with simple 1-byte XOR.\n\n\n-----\n\n_Decrypted sysinfo config contents_\n\nSysinfo config module is used by sysbin01. Apparently it starts with the company name and has three domain\nnames, one of which is most likely used to check Internet connectivity (update.microsoft.com).\n\nSysbin01 module is a loader component. It creates several threads running various jobs.\n\n**Sysbin01.thread#1 attempts to load %TEMP%\\<ComputerName>.ax file and decrypts it.**\n\n_<ComputerName>.ax file structure_\n\nWe  checked the system but couldn't find <ComputerName>.ax file in the Temp folder of the user, however we\nfound other .ax-files that seemed to be related because of the date of file creation.\n\nFile name: C:\\Documents and Settings\\%User%\\Local Settings\\Temp\\%ComputerName%_p.ax\nFile size: 2660\nCreation time (UTC): 2012-09-06 06:22:42\nMD5: unavailable (the system went offline before we discovered the filepath).\n\nFile name: C:\\Documents and Settings\\%User%\\Local Settings\\Temp\\uid.ax\nFile size: 16\nCreation time (UTC): 2012-09-06 05:03:06\nMD5: unavailable (the system went offline before we discovered the filepath).\n\nAccording to the code that loads <ComputerName>.ax it is an encrypted executable file, which is decrypted and\nloaded to memory by own loader routine in the sysbin01 module.\n\n**Sysbin01.thread#2 spawns a new instance of Sysbin01.thread#3 every 10 seconds during, that is done 3 times.**\n\n\n-----\n\n**Sysbin01.thread#3**\n\nThis thread is the most important. It reads the configuration from the registry and connects to the C&C servers\nspecified in the config via direct tcp connection or via proxy that is fetched from the the settings of locally logged in\nuser profile. The config had the following C&C: tank.hja63.com. It sends a “POST /<HEXNUMBER>” request with\nUser-Agent “lynx”, the data after HTTP header is just “AA”, expected answer is also “AA”.\n\nThis thread also creates %TEMP%\\uid.ax and stores current system unique ID, which is generated by CoCreateGuid\nsystem API (16 bytes). It is able to receive and save data from the C&C server to a file. It also monitors windows of\nexplorer.exe and copies textual data from password fields if the user types in, stolen data is saved to a file first.\n\nAfter all threads are launched, the main thread waits for termination of Sysbin01.thread#3, which is created first\nand then exits.\n\n**sysbin02 module behaviors depends on currently running processes. There is an embedded DLL file according to**\nFigure 15 in sysbin02.\n\nIf the system has a running process named “360tray.exe”, then the embedded file is stored\nin %SYSTEM%\\MFC42LOC.DLL, then copies the source executable (FlashUpdate.exe) to %TEMP%\\Flash.tmp and\nruns a new process from that location via WMI Win32_Process.Create method.\n\nIf the system has a running process named “bdagent.exe”, then it copies the source executable (FlashUpdate.exe)\nto %TEMP%\\Flash.tmp, decodes an embedded Base64 string and executes. The string has the following text after\ndecoding:\n\n_reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v FlashUpdate /t_\n_REG_EXPAND_SZ /d \"\"\"\"%APPDATA%\\FlashUpdate.exe\"\"\" -update activex\" /f_\n\nThe module also saves current module file path to the registry in the following key location:\nHKCU\\Software\\Classes\\path\n\nNext it patches the tmp file with two dword “AAAA” values which looks like corruption of embedded encrypted\nsysbin modules inside. The meaning of this action is currently unclear.\n\nThen it moves Flash.tmp file to FlashUpdate.exe by and starts a new process from new location.\n\nFinally, if there is not “qqpctray.exe” process running, and this seemed to be the case for the analyzed system, it\ncopies the source executable (FlashUpdate.exe) to %TEMP%\\Flash.tmp, patches the new file and increases its size\nby adding system explorer.exe file contents to the resource section “RC Data” 20 times. The purpose of this is to\nmake the new executable look like the real update service of Adobe Flash, it simply stuffs the file with executable\ncode of another application. Then it moves the file to new location %APPDATA%\\FlashUpdate.exe, saves new\nmodule file path to the registry in the following key location: HKCU\\Software\\Classes\\path and starts a new\nprocess from there.\n\n###### c_20100.NLS (aka SrvCore.dll) File\n\nSize: 15847156\nMD5: 5778178a1b259c3127b678a49cd23e53\nLocation: C:\\WINDOWS\\system32\\c_20100.NLS\nCreation time (UTC): unavailable\nLink time (UTC): 2011-09-16 13:23:34\n\n\n-----\n\n###### Summary\n\nc_20100.NLS works in two modes. The first mode is a load as a dynamic library and the second is a launch as a\nservice. Both branches have the same core functionality.\n\nThis module is a universal executable code loader with no embedded payload. Its main purpose is to connect to the\nC&C server, download and store the encrypted payload in the system registry. It is also responsible for loading,\ndecrypting and running the payload module from the registry after system restart.\n\n###### Details\n\nc_20100.NLS contains a ciphered block with initial settings. This ciphered block resides at the very end of the file of\nthis malicious program and is decrypted in the beginning of execution. Structure of block:\n\n_Initial settings in the end of file_\n\nThe malicious program XORs the magic number with a hardcoded value 0x19860609, converts a resulted value into\na HEX-string and uses that string as a key for RC4 cipher algorithm. In this case string-key represents “00000000”\nbecause of the magic number is equal to the hardcoded XORing value. With that key malicious program decrypts\n(RC4) ciphered archive. The archive has the following data:\n\n_Archive of initial settings_\n\nCustom LZ-like compression algorithm resembling was used to pack initial settings. After unpacking the following\ndata appears:\n\n\n-----\n\n_The Initial settings_\n\nThe malicious program tries to read registry value “SrvCode” by registry path:\n_HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion. That value is expected to contain ciphered with RC4 data._\nTo decrypt it program uses 2[nd] integer of initial settings (in this case 0x3514) XORed by hardcoded byte 0x12. Result\nis converted into a HEX-string and is used as RC4 key for further decryption (here it is “00003506”). That registry\nvalue appears if this malicious program had already worked on the system and received data from the C&C server\nin the past. Content of “SrvCode” poses a ciphered executable which should be loaded into the memory and run.\n\nIf “SrvCode” is not found malware makes attempts to connect to one of the specified C&C servers.\n\n\n-----\n\n###### C&C Server Address Selection\n\nInitial settings define the type of C&C format. Byte at offset 0x24C stores the C&C type value:\n\n**0x00: the malware uses 4 URL-based C&Cs placed at 0x4C, 0x8C, 0xCC and 0x10C offsets. By all appearances these**\nare public resources (forums, blog platforms and so on) where the attackers leave messages with specially crafted\ncontent for a bot. If connection fails, the malware tries another approach.\n\n**0x01: the malware uses attackers’ hardcoded servers and connects to host and port specified at offsets: 0x14C,**\n0x18C, 0x1CC and 0x20C. If connection fails the malware tries another approach.\n\nIf URL-based scheme is used then malware loads a web-page by specified in settings URL. The target text has to\nbegin and end with special hardcoded delimiters: “B9273C17” – start, “B6A74634” – end. The malware reads\ncontents of the webpages until it finds a proper page with delimiters. If found, the malware takes the text between\ndelimiters and treats it as data of hex string, converts it to the binary data and decrypts resulted data using RC4\nalgorithm with hardcoded key “rtyr_45_trf”. For example:\n\n“B9273C17E67024277AE02E2A8A780B243C0BCA88FE85A1B6A7463”,\n\nThe data between delimiters:\n\n“E67024277AE02E2A8A780B243C0BCA88FE85A1”,\n\nIt is converted into binary: 0xe6 0x70 0x24 … 0xa1 and this buffer is decrypted with RC4 key “rtyr_45_trf”. Result is\na host and port of C&C: “nx2.intercpu.com:25”.\n\nIf the host-port schema is used then malware simply connects to the hardcoded C&C servers directly.\n\n###### Communication with C&C Server\n\nOnce a working C&C server is found the malware sends specially crafted ciphered buffer to via TCP/IP. On request\nfrom a bot a C&C server replies with several blocks of data described below:\n\n**_1[st] block_**\n\n_0xC bytes of header: 0x1000010, 0x1000010, <reserved 4 bytes>._\n\n**_2[nd] block_**\n\n_0x1C bytes (due to absence of real respond from the C&C I’m presenting an example buffer of this block containing_\nbytes 0x00, 0x11, 0x22, …, 0xFF, 0x00, 0x0, 0x0, …, 0x00):\n\n_2[nd] block of 0x1c bytes: example_\n\nFirst DWORD of this buffer (here, 0x33221100) is a magic number which is XORed with the value 0x1986052.\nResulted lowest byte is used to XOR unpacked data.\n\n\n-----\n\nWord at offset 0x4 (here, 0x5544) poses a checksum of unpacked data which should correspond with actual\nreceived content.\n\nDWORD starting at offset 0x8 (here, 0xBBAA9988) represents a size of unpacked data.\n\nValue at marked place at 0xC offset (in example picture it is dword 0xFFEEDDCC) represents a size of next block of\ndata to be received. That data will pose an archive, hence this value represents a size of packed data.\n\n**_3[rd] block_**\n\nThe 3[rd] block poses an archive of ciphered data. Being received, unpacked and decrypted, data is ciphered again\nwith RC4 and stored into “SrvCode” value of registry by mentioned above registry path.\n\nThe eceived data is processed as an executable file to run. The malware places the executable in memory,\nprepares for running and makes call to the entry point of the new code. Then it waits when following event will be\ntriggered:\n\n_Global\\D5ACF9F6-C8B3-47d1-9768-57162E1F5FDB_\n\nWhen triggered, the malware finishes execution. During the process of finishing it deletes registry value “SrvCode”\nalong with values “DrvCode” and “KeyCode” from the same registry path although this malware was not creating\nthem.\n\n###### Tcprelay.sys File\n\nSize: 99912\nMD5: 0b105cd6ecdfe5724c7db52135aa47ef\nLocation: C:\\WINDOWS\\system32\\drivers\\tcprelay.sys\nCreation time (UTC): 2012-09-05 17:27:04\nLink time (UTC): 2011-12-21 13:55:03\n\nThis file is a Microsoft Windows native application, which is loaded as a driver and had a valid digital signature in\n2012.\n\nThe certificate was issued by LivePlex Corp, which can be found online by searching for the company name. One of\n[their webpages is here: http://www.linkedin.com/company/liveplex](http://www.linkedin.com/company/liveplex)\n\n\n-----\n\n_Digital certificate of Tcprelay.sys_\n\n_LivePlex profile page on LinkedIn_\n\n\n-----\n\nWhen the driver is loaded it decrypts an embedded DLL file, which is immediately injected into the address space\nof services.exe process. Then the driver sets up some rootkit functionality to hide TCP connections by patching the\nsystem tcp/ip driver.\n\nThe injected DLL was called s.dll at the time of compilation and is yet another module for analysis.\n\n###### S.dll File\n\nSize: 77825\nMD5: 1716889fcee461e7cde5128c14d206cb\nLocation: inside tcprelay.sys\nCreation time (UTC): 2012-09-05 17:27:04\nLink time (UTC): 2011-03-01 09:07:12\n\nThis opens system event named “401d-b49a-93cf7a18e5b3” and sets event to fired state if it exists. The code\nchecks for proxy server configuration by impersonating a logged in user and fetching settings from the registry. It\ncan work both with Socks and HTTP proxies. The module attempts to connect to the list of 8 domains, consisting of\nthe following command and control servers (some of them are used more than once):\n\n**a1.googletrait.com**\n**a1.nexongame.net**\n**a1.reegame.net**\n**mail.nexongame.net**\n\nIt automatically looks for open C&C ports in the following order 53,443,8080,25,80,3690,1433,80.\n\nDuring connection over HTTP proxy it uses the following User-Agent string: “MyApp/0”.\n\nThe application is linked with libmysql.dll and Zlib (v.1.2.3). Current Zlib version is 1.2.7 and was released on 2nd\nMay 2012, while version 1.2.3 seems to be released in July 2005. Zlib version 1.2.4 was released on March 2010, so\nthe original module was probably designed somewhere after July 2005 and before March 2010.\n\nThen it collects system information, which includes the following:\n\nHost name\nOS Service Pack version\nSystem default language ID and Code page\nList of local drives with free space\nInternal hardcoded identifier (“12-21”)\nProcess commandline\nLogged in user name\nSystem directory path\nAmount of free system memory\nCPU name\nTerminal services port number\n\n\n-----\n\nThe information is stored in a buffer that begins with hardcoded header magic number: 0xDF1F1ED3. The block is\ncompressed using Zlib (v.1.2.3) compress2 method with compression level 8. The data is compressed later and\nprepended by a 4-bytes header as shown below.\n\n_Format of a message sent to C&C_\n\nAfter submitting system information the module expects 4 byte response code from the server after which it sends\none 00 byte to complete the handshake procedure.\n\nThen the module expects an interactive communication session with the remote operator. It provides capability to\nrun various commands including (command names were defined during reverse engineering):\n\nprocess_list\nkill_process\ndir_list\nsmbshare_list\nsmbshare_mount\ndir_make\nfile_delete\nfile_move\nfile_upload\nfile_open\nfile_write\nfile_close\nfile_find\nurl_download_to_file\nprocess_start\nprocess_start_and_get_output\ndll_load\ndll_call_export\nscreen_getsnapshot\nscreen_set_cursor_position\nscreen_send_input\ntcpproxy_open_connection\ntcpproxy_close_connection\nmysql_connect\nmysql_fetch\nmysql_disconnect\ndriver_tcpreplay_interact\ntcpsession_close\nquit\n\nA command output is compressed using Zlib and sent to the server in asynchronous mode. To summarize, it is\nobvious that this executable module is a backdoor, capable of taking screenshots, stealing files, downloading new\n\n\n-----\n\nfiles from the Internet, starting and killing processes, including interactive Windows shell commands, file search\nand interaction with mysql database server.\n\n\n-----\n\n###### En.exe File\n\nSize: 405504\nMD5: cf119a66d4c3e2355c1ec4ac316a7130\nLocation: C:\\RECYCLER\\en.exe\nCreation time (UTC): 2012-09-06 04:08:53\nLink time (UTC): 2009-11-17 16:02:04\n\n_An icon embedded in en.exe is a default application icon from MS Visual Studio_\n\nThis application is a dropper, it fetches a resource called EXEFILE from current application and saves it into\nfollowing paths:\n\n<CURRENT DIR>\\dllcache\\sethc.exe\n\nC:\\WINDOWS\\system32\\sethc.exe\n\nThen the module uses undocumented Windows API from SFC_OS.dll, a function called SfcFileException to update\nthe system version of C:\\WINDOWS\\system32\\sethc.exe.\n\nThe file C:\\WINDOWS\\system32\\sethc.exe (SET High Contrast) is to enable the High Contrast accessibility feature in\norder to allow people with visual impairments to log in. SETHC is activated at logon screen with\nLeftAlt+LeftShift+PrintScreen key combination.\n\nBy replacing C:\\Windows\\SYSTEM32\\SETHC.EXE with a custom application an attacker can run an arbitrary\napplication with SYSTEM privileges running in zero session (in separate desktop space from normal applications).\n\nAfter the new file replaced the system sethc.exe application, current module adjusts the privileges of sethc.exe to\ndisable access to the file from any other application. This is achieved by calling external system tools cacls.\n\nReplace access rights to the files, allow everyone full access:\n\ncacls C:\\WINDOWS\\system32\\sethc.exe /c /e /p everyone:f\n\ncacls <CURRENT DIR>\\dllcache\\sethc.exe /c /e /p everyone:f\n\n\n-----\n\nRevoke access to the file for everyone, leave only system readonly access:\n\ncacls C:\\WINDOWS\\system32\\sethc.exe /t /c /e /r everyone\n\ncacls C:\\WINDOWS\\system32\\sethc.exe /t /c /e /r administrators\n\ncacls C:\\WINDOWS\\system32\\sethc.exe /t /c /e /r users\n\ncacls C:\\WINDOWS\\system32\\sethc.exe /t /c /e /r system\n\ncacls C:\\WINDOWS\\system32\\sethc.exe /t /c /e /r “Power Users”\n\ncacls C:\\WINDOWS\\system32\\sethc.exe /c /e /p system:r\n\nThe dropper also changes the file timestamp. It is set identical to C:\\WINDOWS\\system32\\ntvdm.exe.\n\nThe dropper application has a resource section with Menu, Dialog templates and other information put by the MS\nVisual Studio Application Wizard. It includes default system locale from the developer's system, which is Chinese\nSimplified.\n\n_Chinese locale in resource section of En.exe_\n\nThe dropped application (from resource EXEFILE) is described below as sethc.exe.\n\n###### Sethc.exe File\n\nSize: 20480\nMD5: 3ba06424e8244f17a8d269c4d40c39c9\nLocation: resource section of En.exe\nLink time (UTC): 2009-05-16 07:09:35\n\nThis small file has very basic functionality. It is written using MS Visual C++ with MFC and is used to render a simple\ndialog window. Like En.exe it has resource section, describing the dialog window and default locale is set to\nChinese Simplified.\n\nOnce it replaced local system sethc.exe tool it can be invoked when the desktop is locked with\nLeftCtrl+LeftShift+PrintScr key combination. This brings a dialog Window similar to system StickyKeys application.\nHowever, if you press Ctrl+Alt+F you will immediately see a hidden input box. If you enter “ydteam” in the input\nbox and press Ctrl+Alt+K, the application will welcome you with a message box and will execute a TaskManager.\n\n\n-----\n\n_Fake SetHighContrast application in action_\n\nAs far as sethc.exe is executed with privileges of local system, the task manager also inherits these privileges and is\ncapable of killing any other process as well as starting any other application with system rights. Apparently, this is a\nbackdoor to the system. An attacker can run cmd.exe, add local users with administrative privileges and log in. We\nchecked if the tool was publicly shared on the Internet, but couldn't find a page distributing it freely. That is why\nwe assume that it is developed and used privately.\n\n##### Full list of C&Cs\n\nBelow is full list of all collected domains and IP-addresses of C&C servers have they been mentioned in initial\nsettings of c_20100.nls or hidden in text messages at public places in Internet:\n\n_C&Cs from public resources:_\n\n27.115.103.198:8885\n27.115.103.195:8885\n114.222.36.32:10000\n27.115.103.195:23456\n27.115.103.195:10000\nnx2.joymax.in:80\nnx3.joymax.in:80\n\nnx2.intercpu.com:25 (174.36.138.30)\nnx3.intercpu.com:25 (174.36.138.30)\nnx3.interdriver.net:53 (119.240.212.110)\nstan227.guicp.net:8008\n\n\n-----\n\nHardcoded C&C from the malware:\n\nservice.interdriver.net:443 (98.126.218.64, 199.188.106.231)\nservice.googlefiles.net:53 (98.126.218.64, 199.188.106.231)\nservice.dell-support.org:25\nservice.hp-supports.com:80\ntank.hja63.com\na1.googletrait.com\na1.nexongame.net\na1.reegame.net\nmail.nexongame.net\n\nInterestingly, there is an overlap of C&Cs from public resources and hardcoded domains:\n\n**nx3.interdriver.net:53 <===> service.interdriver.net:443**\n\n_The nx3.interdriver.net was published by awertasegfae@yahoo.com and was discovered at_\n\n_[http://awertasegfae.blogspot.ru/2011/10/first-test.html. This means that at least the individual who owns](http://awertasegfae.blogspot.ru/2011/10/first-test.html)_\n_awertasegfae@yahoo.com for sure belongs to the same gang who attacked CompanyXYZ._\n\n\n-----\n\n## Source of Attacks\n\nSo, who is behind Winnti? While analyzing the malicious files that we detected during our investigations we found\nsome details which may cast some light on the source of the attacks.\n\nAs part of our investigation, we monitored exactly what the cybercriminals did on an infected PC. In particular, they\ndownloaded an auxiliary program ff._exe to the Config.Msi folder on the infected machine. This code searches for\nHTML, MS Excel, MS Word, Adobe, PowerPoint and MS Works documents and text files (.txt) on the hard drive.\n\nDebugging lines were found in ff._exe_ that possibly point to the nationality of the cybercriminals. They were not\nimmediately noticeable because they looked like this in the editor:\n\nHowever, during a detailed analysis it emerged that the text is in Chinese Simplified GBK coding. This is what these\nlines look in Chinese:\n\n\n-----\n\nBelow is a machine translation of this text into English:\n\n_Not identify the type of file system_\n_Below is a translation of the text by interpreter_\n_Open the volume failed_\n_Failed to get the file system type_\n_Failed to read volume_\n_Volumes do not open or open failed_\n_Navigate to the root directory of the error_\n_Error memory read pointer_\n_Memory is too small_\n_File does not exist_\n_Failed to get the file mft index sector_\n_Access to file data fail_\n_Volume and open volumes are not the same_\n_The same volume and open volume_\n\nIn addition, cybercriminals used the AheadLib program to create malicious libraries (for details, see the second part\nof the article). This is a program with a Chinese interface.\n\nChinese text was also found in one of the components of the malicious program CmdPlus.dll plug-in:\n\n_Translation: The process is complete!!_\n\nIt would appear that the attackers can at least speak Chinese. However, not everything is so clear cut: because the\nfile transfer plug-in has not been implemented entirely safely, a command which includes the attackers’ local path\n(where the file comes from and where it is saved to) arrives during the process of downloading/uploading files on\nthe infected system. While monitoring the cybercriminals’ activity on the infected machine, we noticed they\nuploaded the certificate they found in the infected system, and the network traffic reflected the local path\nindicating the place where they saved the file on their computer:\n\nThese characters appear to be Korean, meaning “desktop”. This means the attackers were working on a Korean\nWindows operating system. Therefore, we can presume that the attack is not exclusively the work of Chinesespeaking cybercriminals.\n\n\n-----\n\n## The Search for Attackers (XYZ incident)\n\nLocating the attacker is one of the most non-trivial parts of the research. The attackers normally do not leave any\ntraces in the malware that can be directly bound to their real identities. That is why we have to use all available\nbits of information that seems to find other unique related content on the Internet or any other available data\nsources. One of the important stages is to extract unique identifiers/nicknames/tags that can be discovered on the\nInternet and after that find individuals who are related to creation or distribution of this content.\n\n##### YDTeam Hacking Group\n\nThe string “ydteam” looked non-random and we decided to check it on the Internet. It turned out that YDteam is a\nhackers group name and has a lot of references on Chinese segment of the Internet:\n\n[http://zhikou.yo2.cn/](http://zhikou.yo2.cn/) - probably a team member web blog\n\n[http://www.exploit-db.com/exploits/11053/](http://www.exploit-db.com/exploits/11053/) - PoC exploit for Chinese media player by the team member called “tbag”\n\nAnother team member called “b4che10r” according to\n\n[http://zzsky.5d6d.net/archiver/tid-127.html](http://zzsky.5d6d.net/archiver/tid-127.html)\n\n[http://hi.baidu.com/0x255/item/22cbbfe97ca9963c87d9de41](http://hi.baidu.com/0x255/item/22cbbfe97ca9963c87d9de41)\n\n[http://www.indetectables.net/viewtopic.php?f=87&t=22185&view=print](http://www.indetectables.net/viewtopic.php?f=87&t=22185&view=print)\n\nb4che10r's personal blog: [http://blog.taskkill.net/](http://blog.taskkill.net/)\n\nAnother team member called “Shalyse” according to\n\n[http://forum.cnsec.org/thread-50222-1-1.html](http://forum.cnsec.org/thread-50222-1-1.html)\n\nAnother team member called “killer” according to\n\n[http://zzsky.5d6d.net/archiver/tid-127.html](http://zzsky.5d6d.net/archiver/tid-127.html)\n\nThere was a website ydteam.cn that seems to be related to the activity of the group. According to the\ndomaintools.com database, it was registered on 2009-10-06 15:12 and put on hold around 2010-10-08. The\noriginal WHOIS information from domaintools.com:\n\nDomain Name: ydteam.cn\nROID: 20091006s10001s23027085-cn\nDomain Status: ok\nRegistrant Organization: 魏楠\nRegistrant Name: 魏楠\nAdministrative Email: wn6805@126.com\nSponsoring Registrar: 北京新网数码信息技术有限公司\nName Server:ns.xinnetdns.com\nName Server:ns.xinnet.cn\n\n\n-----\n\nRegistration Date: 2009-10-06 15:12\nExpiration Date: 2010-10-06 15:12\n\n[Registrant name 魏楠 (Wei Nan) seems to be represented in the mailbox wn6805@126.com, which could mean](mailto:wn6805@126.com)\nthe owner of the website used real identity. The domain was most likely registered by the team leader.\n\nThe email itself was used on several other websites. For example\n\n[http://tieba.baidu.com/f?ct=335544320&lm=0&rn=30&tn=baiduPostBrowser&sc=0&z=633089789&pn=0&](http://tieba.baidu.com/f?ct=335544320&lm=0&rn=30&tn=baiduPostBrowser&sc=0&z=633089789&pn=0&word=%BC%AF%C4%FEһ%D6%D0)\n[word=%BC%AF%C4%FE%D2%BB%D6%D0](http://tieba.baidu.com/f?ct=335544320&lm=0&rn=30&tn=baiduPostBrowser&sc=0&z=633089789&pn=0&word=%BC%AF%C4%FEһ%D6%D0)\n\nThe webpage above has a post offering to “help with cheap shopping online”. That is most likely related to a\nfraudulent activity of the email owner (stolen Internet-banking credentials or credit card information). The same\npage reveals a QQ id of that individual and a username:\n\nQQ: 97676416\nUsername: `大头禹`\n\n[Another page http://www.gtvod.com/gtvod/jsp/public/personal/index.jsp?id=20100127213936126005 shows](http://www.gtvod.com/gtvod/jsp/public/personal/index.jsp?id=20100127213936126005)\ninformation about the user registered with name “wn3118” and the same email:\n\nE-mail: [wn6805@126.com](mailto:wn6805@126.com)\nDate of Birth: 1992-12-21\nMarital Status: Unmarried\n\n[Another page http://tieba.baidu.com/p/652667782 has a message from profile “灬low-key, wn” (which links to](http://tieba.baidu.com/p/652667782)\n[wn6805@126.com). Profile information reveals gender of the individual:](mailto:wn6805@126.com)\n[http://www.baidu.com/p/%E7%81%AC%E4%BD%8E%E8%B0%83%E4%B8%B6wn/detail](http://www.baidu.com/p/灬低调丶wn/detail)\n\nGender: Male\n\nThere are few essays in Chinese probably written by the individual owning wn6805@126.com while studying at\nJunior High School:\n\n[(posted on 2008-09-24): http://www.zww.cn/zuowen/html/25/258151.htm](http://www.zww.cn/zuowen/html/25/258151.htm)\n\n[(posted on 2008-10-05) http://www.zww.cn/zuowen/html/25/263081.htm](http://www.zww.cn/zuowen/html/25/263081.htm)\n\n[(posted on 2009-04-08): http://www.zww.cn/zuowen/html/51/350029.htm](http://www.zww.cn/zuowen/html/51/350029.htm)\n\nA page from zww.cn also shows some details about the author:\n[http://www.zww.cn/zw/myzw.asp?u=%CA%A7%C8%A5%B0%AE](http://www.zww.cn/zw/myzw.asp?u=ʧȥ%B0%AE)\n\nBirthday: 1992-12-21 (confirms previous finding)\nQQ: 251985076\nJoined: 2008-09-16 22:35:00\nLast login: 2009-06-09 10:37:00\n\n\n-----\n\n[Searching for the QQ id 251985076 brings to http://blog.sina.com.cn/dahuadl](http://blog.sina.com.cn/dahuadl) that has\nUser mobile number: 13847416805\n\nThe hackers team also seemed to own ydteam.com for some time according to reference at\n[http://zzsky.5d6d.net/archiver/tid-127.html](http://zzsky.5d6d.net/archiver/tid-127.html)\n\nDomaintools.com shows that the domain was registered to a Chinese individual from 2009-06-03 to 2011-08-22.\nAfter that WHOIS information was protected by a Privacy protection service. Here is WHOIS data at the time of\ndomain registration:\n\nAdmin Name........... zheng wenlong\nAdmin Address........ tianjin jiefangdongjie 63hao\nAdmin Address........ yancheng\nAdmin Address........ 300560\nAdmin Address........ fujian\nAdmin Address........ CHINA\n[Admin Email.......... vydteam@yahoo.cn](mailto:vydteam@yahoo.cn)\nAdmin Phone.......... +86.13652452428\n\n###### Please note, that +8613652452428 is a Chinese local cell phone number.\n\nDomaintools.com has also preserved a screenshot of the website while it was online on 2010-02-25. It shows some\nof the team member names mentioned above.\n\n\n-----\n\n_Ydteam website as it was in 2010_\n\nAnother trace to the source of attack is based on email sender IP address. The emails were sent from\n118.142.11.114. According to robtex.com, there are 2 domain names that share this IP:\n\n**pad62.com**\n**ru.pad62.com**\n\nPad62.com was created in 2011-06-05, on the date of registration if had non-protected WHOIS information,\naccording to domaintools.com:\n\nRegistrant: ji shao\nXuan Die Xiao Jie 418 Kao\npeng hu, xiang gang 064562\nChina\n\n\n-----\n\nRegistered through: GoDaddy.com, Inc.\nDomain Name: PAD62.COM\nCreated on: 05-Jun-11\nExpires on: 05-Jun-12\nLast Updated on: 05-Jun-11\n\nAdministrative Contact:\nshao, ji huisengaunr@sina.com\nXuan Die Xiao Jie 418 Kao\npeng hu, xiang gang 064562\nChina\n1-330-040-0367\n\nWe checked which other domains are associated with the WHOIS information above and found the following\ndomain names:\n\n**100-d.com**\n**sm08.com**\n**cx-cx.com**\n**6-pro.com**\n**aohoe.info**\n**besheo.info**\n**dyyerre.info**\n**jiaoyouliaotian.org**\n**tao5178.info**\n\nOne more route is to check the C&C of the initial dropper/downloader module. This was tank.hja63.com.\nAcccording to domain tools, hja63.com had non-protected WHOIS information in 2011:\n\nRegistrant: ji shao\nXuan Die Xiao Jie 418 Kao\npeng hu, xiang gang 064562\nChina\n\nRegistered through: GoDaddy.com, Inc.\nDomain Name: HJA63.COM\nCreated on: 05-Jun-11\nExpires on: 05-Jun-12\nLast Updated on: 05-Jun-11\n\nAdministrative Contact:\nshao, ji huisengaunr@sina.com\nXuan Die Xiao Jie 418 Kao\npeng hu, xiang gang 064562\nChina\n1-330-040-0367\n\nWhen we checked, tank.hja63.com resolved to 173.234.184.45 (owned by DiaHosting Limited, USA), while\nhja63.com resolved to 68.178.232.100 (GoDaddy ISP server).\n\n\n-----\n\n##### Bot Control Messages On Public Resources\n\nAnalysis of the file c_20100.nls revealed additional information leading to probable attackers. Looking for\nidentifiers (used as message boundaries, or delimiters) B9273C17 and B6A74634 specified in this malicious file on\nInternet we found the following pages where the attackers left messages for the bots:\n\n[http://osdir.com/ml/openmeetings-dev/2011-10/msg00214.html](http://osdir.com/ml/openmeetings-dev/2011-10/msg00214.html)\n[http://osdir.com/ml/openmeetings-dev/2011-10/msg00215.html](http://osdir.com/ml/openmeetings-dev/2011-10/msg00215.html)\n[http://osdir.com/ml/openmeetings-dev/2011-10/msg00241.html](http://osdir.com/ml/openmeetings-dev/2011-10/msg00241.html)\n\n_An encoded C&C address for a bot on a public webpage_\n\nAnother place of just mentioned forum thread:\n\nhttps://groups.google.com/group/openmeetings[dev/browse_thread/thread/ccfeb8242a4f11ec/a700f22be192482a?show_docid=a700f22be192482a&pli=1](https://groups.google.com/group/openmeetings-dev/browse_thread/thread/ccfeb8242a4f11ec/a700f22be192482a?show_docid=a700f22be192482a&pli=1)\n[https://groups.google.com/group/openmeetings-dev/tree/browse_frm/month/2011-](https://groups.google.com/group/openmeetings-dev/tree/browse_frm/month/2011-10/a8509400cef9a8ac?rnum=221&_done=%2Fgroup%2Fopenmeetings-dev%2Fbrowse_frm%2Fmonth%2F2011-10%3F)\n[10/a8509400cef9a8ac?rnum=221&_done=%2Fgroup%2Fopenmeetings-dev%2Fbrowse_frm%2Fmonth%2F2011-](https://groups.google.com/group/openmeetings-dev/tree/browse_frm/month/2011-10/a8509400cef9a8ac?rnum=221&_done=%2Fgroup%2Fopenmeetings-dev%2Fbrowse_frm%2Fmonth%2F2011-10%3F)\n[10%3F](https://groups.google.com/group/openmeetings-dev/tree/browse_frm/month/2011-10/a8509400cef9a8ac?rnum=221&_done=%2Fgroup%2Fopenmeetings-dev%2Fbrowse_frm%2Fmonth%2F2011-10%3F)\n\n\n-----\n\n_Some more server addresses for the bot_\n\nHere, we see these emails used as commenters’ identifiers:\n\n_Jimycoco…@gmail.com_\n_[awertase...@yahoo.com](https://groups.google.com/groups/unlock?_done=/group/openmeetings-dev/browse_thread/thread/ccfeb8242a4f11ec/a700f22be192482a%3Fshow_docid%3Da700f22be192482a&msg=1aa911d328125f32#_blank)_\n\n_Jimycoco…@gmail.com most probably refers to Jimycocowell which is a username that pops up further._\n\nSearching for “awertase” brought another forum thread where ciphered data for the same bot appeared:\n\n[http://osdir.com/ml/openmeetings-dev/2011-09/msg00364.html](http://osdir.com/ml/openmeetings-dev/2011-09/msg00364.html)\n\n_Yet another message for bots from awertase..._\n\n\n-----\n\nThe full email behind awertase...@xxxxxxxx seems to be awertasegfae@yahoo.com according to\n[http://awertasegfae.blogspot.ru/2011/10/first-test.html](http://awertasegfae.blogspot.ru/2011/10/first-test.html)\n\n[http://hi.baidu.com/alonecode/item/6936f85a3d98ce3533e0a9ed](http://hi.baidu.com/alonecode/item/6936f85a3d98ce3533e0a9ed)\n\n_Another webpage with message for bots_\n\nAccording to Figure 32, “mer4en7y” and “alonecode” (from the URL of the page) are nicknames which are related\nto the user of the Baidu blog platform where messages for a bot were left. Google Search for the nickname\n“mer4en7y” returned 5490 results. This is a very active user that posts messages for this type of bot. The first\nresults lead to hacker forums and IT-security specific web-platforms. The same nickname has appeared on a wellknown Romanian Security Team forum.\n\n###### Mer4en7y Individual Activity\n\n_mer4en7y username at Romanian hackers forum_\n\n\n-----\n\n_Mer4en7y at Silic Group Hacker Forum_\n\n**According to the following, Mer4en7y submitted a vulnerability found in Weihai City Commercial**\n**Bank system:**\n\n[http://wooyun.org/bugs/wooyun-2010-011002](http://wooyun.org/bugs/wooyun-2010-011002)\n\n\n-----\n\n_Mer4en7y's activity on vulnerability research_\n\n**Favorite videos and tutorials of Mer4en7y:**\n\n[http://www.tdcqjslt.com/u.php?uid=1918](http://www.tdcqjslt.com/u.php?uid=1918)\n\n_Mer4en7y's favorites confirm malware-related activities_\n\n_[Mer4en7y’s micro-blogging page at t.qq.com: http://t.qq.com/mer4en7y](http://t.qq.com/mer4en7y)_\n\nAlias of that profile is translated as “watching a rain”.\n\n\n-----\n\n_Mer4en7y's microblogging profile_\n\n[A user with nickname “d4nr4n” (http://t.qq.com/d4nr4n) is posting a message where mer4en7y is mentioned:](http://t.qq.com/d4nr4n)\n\n_Mer4en7y's relation to Nanjing_\n\nGoogle translation: “%mentioned individuals% go to Nanjing tomorrow xx training institutions to maintain four\n_months … C++ learning, seeking Nanjing-based friends of the exchange”_\n\n**Mer4en7y at yoyo2008.com:**\n\n[http://www.yoyo2008.com/home.php?mod=space&uid=41498](http://www.yoyo2008.com/home.php?mod=space&uid=41498)\n\n\n-----\n\n_Mer4en7y profile at yoyo2008.com_\n\nOne of two friends of Mer4en7y in yoyo2008 social network is a user named “mayuan” which seems to be from\nXinjiang and a graduate of Judicial Police School according to shared private information out there:\n\n_Mer4en7y's contact profile at yoyo2008.com_\n\n[http://u.pintour.com/uid-b1bf56e230cc42d9bfa003a7718888d2/](http://u.pintour.com/uid-b1bf56e230cc42d9bfa003a7718888d2/)\n\n\n-----\n\n_Another Mer4en7y profile show Nanjing as a hometown_\n\nMer4en7y’s exploit has been involved in the penetration of public radio service ftp server (according to WHOIS\ninformation this domain belongs to Xi'an Municipal Bureau of Radio and Television).\n\n_A trace of cyberattack based on Mer4en7y's code_\n\nAs we can see here Mer4en7y had an email address associated with 90sec hackers team.\n\nAnother reference on the net shows that Mer4en7y is after sourcecode of proprietary products (probably udf.dll\nfrom Roxio Inc):\n\n[http://www.uedbox.com/udf-dll-source/](http://www.uedbox.com/udf-dll-source/)\n\n_Mer4en7y discussing udf.dll source-code and cmdshell_\n\n\n-----\n\nThe following confirms that Mer4en7y is a member of 90sec group. The group website is located at\n[http://www.90sec.org/:](http://www.90sec.org/)\n\n_90Sec team about-page_\n\n_Mer4en7y replies on job offer posted at 90sec forum (someone wanted to hire computer exerts with very special_\n**knowledge):**\n\n[https://forum.90sec.org/viewthread.php?action=printable&tid=2012](https://forum.90sec.org/viewthread.php?action=printable&tid=2012)\n\nRough translation of job offer from Chinese:\n\n_“Subject: Looking for information security researcher_\n_From: Southland sword_\n\n_Time: 2012-04-06 00:38_\n\n_Subject: Security researcher job_\n_Responsibilities:_\n\n_1._ _Full target penetration alone or with a team depending on available resources;_\n_2._ _Penetration testing report and recommendations_\n\n_Technical requirements:_\n\n_1._ _Knowledge of penetration testing, methods, processes, proficiency in a variety of penetration testing tools;_\n_2._ _Knowledge of common Web development languages (asp, php, jsp), experience with SQL-injection, XSS,_\n\n_common websecurity exploits and patches;_\n_3._ _Experience with all kinds of operating systems and databases for common security vulnerabilities;_\n_4._ _Good verbal and written language skills ;_\n_5._ _Be able to work in a team; individuals who lose trust, do not listen to the teamleader and not accepting the_\n\n_rules will be kicked out;_\n\n\n-----\n\n_Work Location: Guangdong (OR Guangzhou Shenzhen)_\n\n_Baochibaozhu package, Relatively free playing time._\n_Salary: monthly allocation of the total amount of work and cooperation share more than 1W._\n_Vacancies: 5 people_\n_For candidates: first contact me (preferably work resume), after my check the resume will be passed to the head_\n_coordinator for arranging a personal meeting._\n_Salary: free meal and apartments, office location is in a senior villa suite of 200 square meters, computers are_\n_available but please bring your own hard drive with environment and tools you are familiar with. Even a single_\n_completed project will provide you with money for your monthly expenses._\n_Powerful background. No comments!_\n\n_Tho who are competent, please contact:_\n_Email: Infosec@cntv.cn QQ: admin@inessus.com”_\n\nAnd Mer4en7y’s replied to this job offer:\n\n**Mer4en7y's comment about job offer**\n\nWhich can be translated as: “Aren’t you recruiting people for APT? Guangzhou is too far, but anyway I support it”.\n\nThere are some interesting comments in the mentioned forum thread regarding reference “Powerful background”\nin job offer. People in the thread speculated that it could mean the work is supported by the government.\n\n_Mer4en7y is publishing an exploit:_\n\n[http://www.hackqing.com/index.asp?FoxNews=129.html](http://www.hackqing.com/index.asp?FoxNews=129.html)\n\n\n-----\n\n_Mer4en7y's exploit code in PHP_\n\n_Mer4en7y published a modified Perl script for network scan:_\n\n[http://www.2cto.com/kf/201110/109200.html](http://www.2cto.com/kf/201110/109200.html)\n\n\n-----\n\n_Mer4en7y's network scanner on Perl_\n\n###### Jimmycocowell Individual Activity\n\nLet’s continue with other places where delimiters have been found:\n[https://www.myspace.com/574064782/blog](https://www.myspace.com/574064782/blog)\n\n_Another bot control message by Wz_\n\n\n-----\n\n[http://www.wuhanbike.net/home.php?mod=space&uid=15845&do=profile](http://www.wuhanbike.net/home.php?mod=space&uid=15845&do=profile)\n\n_Another bot control message by 奔跑 (Run)_\n\n[http://jimycocowell.blogspot.ru/](http://jimycocowell.blogspot.ru/)\n\n_Another bot control message by Jimmycocowell_\n\n\n-----\n\nThe attacker left two messages. The very first one is labeled as “first home”/ “first love” and contains a ciphered\nC&C domain as described above, i.e. C&C domain is encrypted with RC4 algorithm and its hex binary value is\npresented in text format between delimiters.\n\nBut the next message dubbed “second” contains a ciphered C&C domain too but it is encoded in another way: The\ninitial C&C domain is XORed with fixed byte value and the resulted data is transformed using BASE64 encoding. The\nresulted text is inserted between the same delimiters. By all appearances this method is used in the next version of\nthe backdoor which is the subject of current research (see c_20100.NLS). It is also possible that programs with\nsupport of either this or that encryption could be used simultaneously in the frame of one attack. Between all\nfound messages for the bot the second type of messages (BASE64) is significantly prevalent.\n\nA link to this “Jimycocowell home” is also present at following place of “bitgodgod” user:\n[http://www.blogger.com/profile/06442609461818597659](http://www.blogger.com/profile/06442609461818597659)\n\n_Jimmycocowell registration date and alias_\n\n###### Bitgodgod and Bitbugbug\n\nWe have located one sample of Winnti malware with a hardcoded C&C: mail.7niu.com.\nDomaintools information about the domain:\n\nDomain Name   : 7niu.com\nPunnyCode    : 7niu.com\nCreation Date  : 2006-06-11 00:00:00\nUpdated Date   : 2012-01-27 21:35:57\nExpiration Date : 2016-06-11 00:00:00\n\nRegistrant:\nOrganization  : qi tou niu\nName      : xibei jiao\nAddress    : beijing\nCity      : beijing\nProvince/State : Beijing\nCountry    : CN\nPostal Code  : 100000\n\n\n-----\n\nAdministrative Contact:\nName      : xibei jiao\nOrganization  : qi tou niu\nAddress    : beijing\nCity      : beijing\nProvince/State : Beijing\nCountry    : beijing\nPostal Code  : 100000\nPhone Number  : 86--1321333333\nFax      : 86--010555555\n[Email     : bit_bugbug@tom.com](http://reversewhois.domaintools.com/?email=acb9a265f882adc0eee5704ee16ce081)\n\nTechnical Contact:\nName      : xibei jiao\nOrganization  : qi tou niu\nAddress    : beijing\nCity      : beijing\nProvince/State : Beijing\nCountry    : CN\nPostal Code  : 100000\nPhone Number  : 86--1321333333\nFax      : 86--010555555\n[Email     : rain@etang.com](http://reversewhois.domaintools.com/?email=b86506cc453566ac7ad151417f4fdaa8)\n\nYou can see how similar “bitbugbug” and “bitgodgod”. Both are directly related to Winnti activity.\nThe email address “bit_bugbug@tom.com” also can be found on Chinese websites about home rentals:\n\n[http://oldhouse.0379home.com/RentView-1108.html](http://oldhouse.0379home.com/RentView-1108.html)\n\n\n-----\n\n###### Yang Individual Activity\n\nWe have located another individual calling himself Yang. He distributed bot control commands and was quite\nactive on the internet as well.\n\n[http://yang8559420.blog.163.com/](http://yang8559420.blog.163.com/)\n\n_Yang8559420 blog_\n\nSearch for “yang8559420” brought some results:\n\nYang is a distributor of resources (maps or programs) for applications based on ArcGIS Engine\n[(http://www.esri.com/software/arcgis/arcgisengine)](http://www.esri.com/software/arcgis/arcgisengine)\n\n[http://shop65775432.taobao.com/?spm=a1z0b.7.2-2442034955.3.rfLsIS](http://shop65775432.taobao.com/?spm=a1z0b.7.2-2442034955.3.rfLsIS)\n\n\n-----\n\n_Yang offered ArcGIS engine sourcecode for sale_\n\nInformation about the seller:\n\n[http://shop65775432.taobao.com/view_page-74445421.htm](http://shop65775432.taobao.com/view_page-74445421.htm)\n\n_Yang8559420 trader profile (Chinese)_\n\n\n-----\n\n_Yang8559420 trader profile (English Google-translation)_\n\nYang is certified at alipay.com (see field “Certification” above):\n\n[http://help.alipay.com/lab/help_detail.htm?help_id=211779](http://help.alipay.com/lab/help_detail.htm?help_id=211779)\n\n_Alipay certification_\n\nYang left some feedback about a coat:\n\n[http://www.yifa8.com/4/766/770/763311.html](http://www.yifa8.com/4/766/770/763311.html)\n\n\n-----\n\n_Yang comments on the internet (private life related)_\n\nYang is selling glasses:\n\n[http://webcache.googleusercontent.com/search?q=cache:susBSuR_5zoJ:re.taobao.com/search%3Frefpid%3Dmm_](http://webcache.googleusercontent.com/search?q=cache:susBSuR_5zoJ:re.taobao.com/search%3Frefpid%3Dmm_16823808_2252954_8791633%26keyword%3D%2525D5%2525E6%2525CB%2525BF%252520%2525C1%2525AC%2525D2%2525C2%2525C8%2525B9%252520%2525C7%2525E5%2525B2%2525D6%26back%3Dlo1%25253D0%252526lo2%25253D0%252526nt%25253D1%26isinner%3D1%26yp4p_page%3D3%26posid%3D7+)\n[16823808_2252954_8791633%26keyword%3D%2525D5%2525E6%2525CB%2525BF%252520%2525C1%2525AC%](http://webcache.googleusercontent.com/search?q=cache:susBSuR_5zoJ:re.taobao.com/search%3Frefpid%3Dmm_16823808_2252954_8791633%26keyword%3D%2525D5%2525E6%2525CB%2525BF%252520%2525C1%2525AC%2525D2%2525C2%2525C8%2525B9%252520%2525C7%2525E5%2525B2%2525D6%26back%3Dlo1%25253D0%252526lo2%25253D0%252526nt%25253D1%26isinner%3D1%26yp4p_page%3D3%26posid%3D7+)\n[2525D2%2525C2%2525C8%2525B9%252520%2525C7%2525E5%2525B2%2525D6%26back%3Dlo1%25253D0%252](http://webcache.googleusercontent.com/search?q=cache:susBSuR_5zoJ:re.taobao.com/search%3Frefpid%3Dmm_16823808_2252954_8791633%26keyword%3D%2525D5%2525E6%2525CB%2525BF%252520%2525C1%2525AC%2525D2%2525C2%2525C8%2525B9%252520%2525C7%2525E5%2525B2%2525D6%26back%3Dlo1%25253D0%252526lo2%25253D0%252526nt%25253D1%26isinner%3D1%26yp4p_page%3D3%26posid%3D7+)\n[526lo2%25253D0%252526nt%25253D1%26isinner%3D1%26yp4p_page%3D3%26posid%3D7+%22yang8559420%2](http://webcache.googleusercontent.com/search?q=cache:susBSuR_5zoJ:re.taobao.com/search%3Frefpid%3Dmm_16823808_2252954_8791633%26keyword%3D%2525D5%2525E6%2525CB%2525BF%252520%2525C1%2525AC%2525D2%2525C2%2525C8%2525B9%252520%2525C7%2525E5%2525B2%2525D6%26back%3Dlo1%25253D0%252526lo2%25253D0%252526nt%25253D1%26isinner%3D1%26yp4p_page%3D3%26posid%3D7+)\n[2&cd=14&hl=ru&ct=clnk&gl=ru](http://webcache.googleusercontent.com/search?q=cache:susBSuR_5zoJ:re.taobao.com/search%3Frefpid%3Dmm_16823808_2252954_8791633%26keyword%3D%2525D5%2525E6%2525CB%2525BF%252520%2525C1%2525AC%2525D2%2525C2%2525C8%2525B9%252520%2525C7%2525E5%2525B2%2525D6%26back%3Dlo1%25253D0%252526lo2%25253D0%252526nt%25253D1%26isinner%3D1%26yp4p_page%3D3%26posid%3D7+)\n\n\n-----\n\n_Glasses for sale by Yang_\n\n[http://bbs.iaixue.com/home.php?mod=space&uid=217&do=profile](http://bbs.iaixue.com/home.php?mod=space&uid=217&do=profile)\n\nUser: lovemeyang (probably related to Yang). Signature is a message for a bot:\n\n_Another message for bot by lovemeyang_\n\nSo, both Yang8559420 and Lovemeyang messages go with signature:\n\n[http://bbs.iaixue.com/forum.php?mod=viewthread&tid=261](http://bbs.iaixue.com/forum.php?mod=viewthread&tid=261)\n\n\n-----\n\n_Same signature used by Yang8559420 and Lovemeyang_\n\n[http://bbs.iaixue.com/forum.php?mod=viewthread&tid=612](http://bbs.iaixue.com/forum.php?mod=viewthread&tid=612)\n\n…\n\n_Signature by Lovemeyang_\n\nSearch for “lovemeyang” returned too much data, making it difficult tofilter out those identifying possible attackers\n– false positives are highly-probable. However, it’s worth mentioning that the following link refers to an account\n\n\n-----\n\nwith the “lovemeyang” username and the user has earlier posted blogs relating to IT-security, so possibly the user\nis that Yang who is involved in the attack:\n\n[http://lovemeyang.blog.51cto.com/659880/195451](http://lovemeyang.blog.51cto.com/659880/195451)\n\n_Yang and relation to a malware_\n\n\n-----\n\n## Conclusions\n\nOur research revealed long-term oriented large scale cyber-espionage campaign of a criminal group with Chinese\norigins. These attacks are not new, many other security researchers have published details of various cybercriminal\ngroups coming from China. However, the current hacking group has distinguishable features that make it stand out\namong others:\n\n   - Massive abuse of digital signatures; the attackers used digital signatures of one victim company to attack\nother companies and steal more digital certificates;\n   - Usage of kernel level 64-bit signed rootkit;\n   - Abusing great variety of public Internet resources to store control commands for the malware in an\nencrypted form;\n   - Sharing/selling stolen certificates to other groups that had different objectives (attacks against Uyghur and\nTibetan activists);\n   - Stealing source code and other intellectual property of software developers in online gaming industry.\n\nThe Winnti hacking group is not the first and not the last. By making our research paper available to the public, we\nhope that it will not only spread the knowledge among security researchers but also will help system\nadministrators and security officials in all type of organizations around the world to learn the tactics and tools of\nthe perpetrators. We hope that our shared knowledge will help to better protect IT infrastructure. We also hope\nthat our message will reach Chinese law enforcement agencies. If the current research is not enough to initiate\ncriminal investigation, we hope that it will be enough at least to make some checks and probably prevent other\nmalicious activity from reaching out foreign countries and business within China.\n\n\n-----\n\n## Appendix\n\n##### Winnti MD5s:\n\n**Winnti 1.0**\n\n006c4561499da562a4e337e2c146cf1a\n024CC9872D9F413292D0F952920547CA\n0613d67070679fb97ddefc5973c4d604\n0630a443bd0102647ca1707cdf7f8c35\n0751ca6f8b652cae6f2b650f0cf9036a\n095a6a3b6eba996d2786b5ec919b1a7e\n0af3761919bffa0019e7899333846b27\n0f3c15de074f934499f5bbc095d5557f\n11ed89f0ab17cf3973e2bf970879661a\n128cb2a5de0d0422d69bab6d23ebb0aa\n17c72e0cde2e4019a6b885f8188ac410\n18813863417608b4ad14babebcafcb57\n1a5da850993681e685893547d1aa2eaf\n1ab7360a9438fb816f01ac00c17c9da4\n1d688ca3148df378a15796f43242b77c\n2128b6c7ec7848b73aeb6f211cef7615\n296220a85742a8722b1335977dd98251\n379251974ebcd5c397f92ca45bb9620d\n38fb6993c3c94ea6df01235f44be4e77\n3c722f0bea82e5bb8958f7fab012c911\n3ecbc145dd593ec431145dd84e1e50cb\n4038fb208d4b50e1f5f765811fdac174\n41ff77ea7d4960c75d272a6a6fc31e7c\n4402db68df6682bfe3e1e855a2474444\n4722c665196fb6c7450980eafde6ac86\n4e8f1c053dbe449c93f04e11d4afa352\n4f213f9f187a65ce437157a3e7d253c0\n50635147a579a8c8859a49c609f9d3d2\n50678adefc49735a4f236e06e83c089d\n5156bc9f1dd8ef1c1055933bb9c89c91\n516fe9d2fe8b047fa8ba993692f44482\n5171b030750f364a3459d5de22bc875d\n5a93c03ddfe3edeb2573b72d12ebe0e5\n5db7ba6e771cef48c623ae48fbb4740b\n629c0a9d3d0f471005c87d06aed45113\n64d225a757686db6263e5df919e9dfd6\n6db0e662dad6407f666aa0ea4b995e7f\n7460f35e3b24db9b92bc4cccb6c3f3ac\n7529e41a101170eadb83bcb77bf29e65\n814001293e4a50d12cf55563e0b95ffe\n81b27822a6619a7c78eebbd6dc4b889d\n9251ff253c38c437bad4926378981ad0\n9a575f37ffa684d56d1f5ffebc24b8f3\n\n\nWin32 samples\n\n\n-----\n\na2c3fa86d43eca498c2b6ee8b5ecafb1\na62afe6d59ae1ac32e8afbb88345ba03\na91f69fc4b353d4228990464ca791705\nada3fb277229d6a12df364fd856f00c3\nb01145e9d0c0f9d2822a250df95d888e\nb28a68036b34e5d74672b289591aefa4\nbabd625bb2284d58a9c1884a80f07bdd\nbb79348412e72e77a8254fc289244829\nbc3ffe2761d210fa05dde9ced4ed4869\nbe8b2bf704a1165d5b8b4e26fff4180c\nc050c1ca31e8509f7b12824824ba2ddd\nc181065a366ea6f8c6791fd87fcb86d6\nc248c15622cfb0985fb421c29771d6ae\nc2ac3d2f0299633e2c588d2fa43d0d63\nc2c2eb5f0762db8068bd4031bd6b59bc\nc35180bd2138fd81469805d8eb3480bf\nca69ffc76e74e9d17f26f5f5b20a1db7\nd202ca2b2e04b2b730c43e5a13927096\nd8e289fba6a22cb853d737676ab1545d\ne0df537f91f3bc3713a5ec5cf41f9e2d\ne2e314cbdcf493bcd14cea9cdd887786\ne464e0d0893add9d71bb951502ae738a\ne58c7b9b2576c63ac60743a99310664b\neda0eb9e5c08729f12ddb64f6ec7ae2f\nf06ec81a1f416812ffcc47fd5f709b50\nf39fda34f2e332ddb1363f5e0e541c26\nfaa77eacaa7de27b0f04c3139066d73c\n01f1204f54c645a13368e1ba54179779\n099116c83c9b95ea71e75e1760fced28\n2ad67673a4facf2b493ca5989839d8e3\n2ec43703cc80323ae32fed751bedfff1\n4a02ce3d6c6696ddda2a673298870e16\n4b8fd1ee47f17164e61194f6b2dbfa40\n508f0af84d83e093bf6910dbab45421f\n5c865404f27f5e5b83b6fcfd94068118\n8a0a00b1676c3b65b3c56dab7f8feb99\n91ae694e565f4a2f52d5f792d8353fcd\n95DF76F2ABDB9B133003D4DB637DC67B\nbe594ee2a7e4b11878de020cf724205f\nce3f94fea7f57ce5a9a5a26e51b617fb\nd07f8aa768f7886400bb725c23fd2421\nd9792b5f7bf497a3584d0c0d388f6b16\nefdda5d0a14810ff86e60a70c5baa6b0\nf975d016b83880c898b334714c1291b0\nfc293476226d1471c8de65ab65af7b2f\n\n24c846e935d1efdd090469a69e01da65\n604c8b4f2f82e016cff74ebc4a359e34\n\n\nWin64 samples\n\n\n-----\n\n624db864fe644bc08c16cdbdb8f4bdfb\n677c3236b3acac70f528de8b4cf62539\n6e83c0e6739a2782ce385632f5e982c3\n6e927175a6224add534a6072bc6a6170\n7ea57ad96cee3db9baf5a36b43ba9abc\n92fd35efabf8d774cf5bb4c2be8b733c\n9642c7ee5819f5f8f3f8354da0845190\na00c66d502453524a7fe411ce7bbfea4\nb062063cf2d5b7fcc4abd8390e4f0090\nc9e55d71b7d8f05324c3ad041a943103\nc9e9b8103077d9a9bb21e563f14ef738\nce3eecc1cc27e753b3eeae50074c3edd\nd194316fc5a7f7b433d26ed9da09b249\nde1ea8d6c20d8ecdd1c29219e30d4984\ne5338b89c4721482df24f9aa5a3c6389\nec6d53e1a030e166acbc6f357362c195\n66de2aaad67446aabbe5adeb873b4b24\n8505e92a2c3812ec298acd6bb20437a2\n9f5b4f39699fda67ffa65f98086f7451\nB8F03B556AE4255BA8D828B6D9909B08\nefb16a33a0c9da12a71ef44e7d688233\n\n5ce790274b7507740e9983d2efe69c17\n679ba94211a4e027c2b56b959e62c8e3\n6b4ab6ca6808e955a6fd11ae5ffea1f6\n6f5a10edc2c7319b8d7abc0a606e5ce6\nca04aa367e6f090903018131245296ce\ne8e1f133ef1a303e2e901e59329af1dd\n4591d01a291b700efbc5b263c67a266c\n\n**Winnti 1.1**\n\n1014374a0b4972adec93a015df6e4558\n582f84b21978cab7d190aef663a268ea\n2d0950f69e206486c5272f2b0fc3aa22\na374be9091ed1791424fc236144e9d81\ne867dba9d96acae55552777a8729a45a\nf809eea8170afacd2dfe2c45ba86861e\n\n07a18ad4d859c67f208ccb76a7e6a184\n0996b71f1364acde317881810c5912f0\n97f64270b59b0f6b83ec93efc41543fd\n\n\nDrivers\n\n\nWin32 samples\n\n\nDrivers\n\n\n-----\n\nDroppers\n\n\n509c562db69f8332b9fc3298236e8ffa\n130a799edeb0753164cdb76ccf8fd64c\n5654424ea88de69d5c6031f7009f0428\n\n**Winnti 1.2**\n\n0393eebedbde6e5ee868f81ac024b401\n36711896cfeb67f599305b590f195aec\n43da75e7f8e7e1893dce276bd5b2e680\n535ede2d69a7e07a097ef6648b12e417\n8acb42de94427141f7caffed74f9fc43\na0a96138b57ee24eed31b652ddf60d4e\nd350ae5dc15bcc18fde382b84f4bb3d0\ne252d9ec48bca3d261f5acdd33bfd1cb\nf454ba447eef28f96dafe3398df82a7e\n011815cb37f49a1d14d3db895a5e705f\n115dc2627483aba7119ad4ceab1e042a\n18677c3a2af1476aa8cbc73cfb74d8c1\n1b0753f717d7a33defc389e399b20d57\n29525be71ba4846739e553a0835ab460\n2989b78ac3a752bf6792ac9ac606fdf0\n2ffc739a927b62d4b7096e636951b77d\n3047ed57acac30c2327e74070b3864b7\n3d107d5bdf554c6ae8d05c886080a18d\n4197499923ab6125e2ee5e950b21ec91\n453021b8cc10f9077fa80d60d09c631d\n4732d2056060c66f46caded82954836e\n4d028c7a47c1b0d00e894ad351a61996\n6e9b47f2ae1f9e7260b8793f35fbbd3a\n8a1d1965b2d8501e692394bb801f58ca\na0629962c34ed9594b18493f459560a7\nada515709be09e495bc9c1206069e796\nbfcd3417b513a6c3fed4b5466055d939\n\n60bd5a9ab78f6c614b824ddcb47dfd7c\n8f54cf08ee45a8d5eb31d05dbab4b561\n15d6249e0e7e03b3e00cc3917431cf64\n4fbb502ba8c7e8d81ec98a5974b9001a\n5618bc41af50c790c8e8680ba30030ed\n7d51ea0230d4692eeedc2d5a4cd66d2d\n961954bbc411d4eafd72efad94a6e160\nc206992f7c6836ec6a227a6e29ae7609\n\n\nSamples\n\n\nDroppers\n\n\n-----\n\n##### Winnti 2.0\n\n06d8b1468f09d10aa5c4b115544ccc6e\n0cd07490fc02e2a602781bb939d0bc3d\n2d0950f69e206486c5272f2b0fc3aa22\n3358c54a22d186ec9de0f15bc4bb2698\n35bdc5a2acf35bdf9fb9169e1a47d3e7\n5778178a1b259c3127b678a49cd23e53\n6dfcdc4c8edc77642f15592143f34569\n9a83cd3f8e619c8b1b38b0b5ceeea357\nafe4ec9a88f84fbf9c1eb0f3ff47a12b\nB0BD6C215A7C20B23FD23D77FA26F3BA\nbbbb9bb5c7a59b98f18b06344ac8980f\nd23237edbdcc4118b538454b45c00021\nd4a2060a5086c56f7ff65eaa65de81ff\ndc22d742a15f8d6d8edf49d1c8cc8be9\ne7e5c5c991e6d66fca16c988c891e10f\nf4c9bc4f045b90c496df4b75398dfa5c\n\n04f3fbaaaf5026df29e0d7d317194043\n07e40089cdf338e8d1423b3d97332a4d\n0b105cd6ecdfe5724c7db52135aa47ef\n7024ea8285cee098829ac8f2b1de4455\n\n##### Compromised certificates\n\n\nSamples\n\n\nDrivers\n\n\nCompany Serial number\n\nESTsoft Corp 30 d3 fe 26 59 1d 8e ac 8c 30 66 7a c4 99 9b d7\n\nKog Co., Ltd. 66 e3 f0 b4 45 9f 15 ac 7f 2a 2b 44 99 0d d7 09\n\nLivePlex Corp 1c aa 0d 0d ad f3 2a 24 04 a7 51 95 ae 47 82 0a\n\nMGAME Corp 4e eb 08 05 55 f1 ab f7 09 bb a9 ca e3 2f 13 cd\n\nRosso Index KK 01 00 00 00 00 01 29 7d ba 69 dd\n\nSesisoft 61 3e 2f a1 4e 32 3c 69 ee 3e 72 0c 27 af e4 ce\n\nWemade 61 00 39 d6 34 9e e5 31 e4 ca a3 a6 5d 10 0c 7d\n\nYNK Japan 67 24 34 0d db c7 25 2f 7f b7 14 b8 12 a5 c0 4d\n\nGuangzhou YuanLuo 0b 72 79 06 8b eb 15 ff e8 06 0d 2c 56 15 3c 35\n\nFantasy Technology Corp 75 82 f3 34 85 aa 26 4d e0 3b 2b df 74 e0 bf 32\n\nNeowiz 5c 2f 97 a3 1a bc 32 b0 8c ac 01 00 59 8f 32 f6\n\n\n-----\n\n##### Winnti C&Cs\n\nnewpic.dyndns.tv\nupdate.ddns.net\nnd.jcrsoft.com\ncc.nexoncorp.us\n98.126.36.202\nkr.zzsoft.info\nas.cjinternet.us\nca.zzsoft.info\nsn.jcrsoft.com\nlp.apanku.com\nsshd.8866.org\nftpd.6600.org\ntcpiah.googleclick.net\nrss.6600.org\nlp.zzsoft.info\nlp.gasoft.us\neya.jcrsoft.com\nftpd.9966.org\nkr.xxoo.co\nwi.gcgame.info\ntcp.nhntech.com\nka.jcrsoft.com\nmy.zzsoft.info\njp.jcrsoft.com\nsu.cjinternet.us\nvn.gcgame.info\nap.nhntech.com\nru.gcgame.info\nkr.jcrsoft.com\nwm.ibm-support.net\nfs.nhntech.com\ndocs.nhnclass.com\nrh.jcrsoft.com\nwm.nhntech.com\nwm.myxxoo.com\nka.zzsoft.info\nad.jcrsoft.com\nmy.gasoft.us\n\n\nWinnti 1.0\n\n\n-----\n\nWinnti, all, unsorted\n\n\ngunz.gcgame.info\ndell-support.org\nt3.jcrsoft.com\nkr.hja63.com\ndbo.gcgame.info\n2m.reegame.net\nns1.msftncsl.com\nupdate.reegame.net\npop.hja63.com\nimap.gasoft.us\ndns.naverpulic.com\npda.zzsoft.info\npop.cjinternet.us\nbar.gasoft.us\nhja63.com\ngod.zzsoft.info\ngoqc.xxoo.co\napps.mynetav.net\nns3.nhnclass.com\ntug.mynetav.net\nvip-webmail.com\nmail.7niu.com\ngame.joymax.in\ntho.hja63.com\nzb.mynetav.net\nvtc.gasoft.us\ntv3.mynetav.net\nhk.hja63.com\nad.gasoft.us\nns5.msftncsl.com\nftp.zzsoft.info\nsm.gcgame.info\neudb.reegame.net\ntech.ibm-support.net\ngm.gcgame.info\nwinlogon.net\niyy.conimes.com\nru.gcgame.info\noa.nexoncorp.us\ncjinternet.us\nwm.ibm-support.net\nhp-supports.com\npass1.hangame.co.uk\nmail.cjinternet.us\ntt.xxoo.co\ne.jcrsoft.com\ngamenow.8800.org\ngooglefiles.net\nns4.msftncsl.com\n\n\n-----\n\ngf.jcrsoft.com\nsg.xxoo.co\nns3.nhnclub.com\nwog.zzsoft.info\nssl.msftncsl.com\nns7.msftncsl.com\nudp.nhntech.com\nad.jcrsoft.com\nns6.msftncsl.com\nibm-support.net\ngh.zzsoft.info\nkerberos.dnsalias.com\nns1.nhnclub.com\nimap.zzsoft.info\ngongyi.co\njcrsoft.com\nuni.vip-webmail.com\nsmtp.jcrsoft.com\ncc.nexoncorp.us\nimm.conimes.com\nmail.hja63.com\npass2.googletrait.com\nclub.cjinternet.us\nmail.nexoncorp.us\nas.cjinternet.us\nservice.dell-support.org\nservice.googlefiles.net\nftp.nexoncorp.us\ne.gcgame.info\nhansoft.sunsb.net\nwww.jcrsoft.com\nftpd.6600.org\nsshd.8866.org\ncpu.4pu.com\nnx2.joymax.in\nav.gcgame.info\ndl-adobe.com\ncj.jcrsoft.com\nro.myxxoo.com\nrh.gcgame.info\ncc.xxoo.co\nswordwind.net\nlp.xxoo.co\nbrqc.xxoo.co\nava.apanku.com\nwi.gcgame.info\nzm.gasoft.us\nas.xxoo.co\ngh.gasoft.us\nbaesystems.conimes.com\nns2.nhnclub.com\n\n\n-----\n\nintercpu.com\ne.hja63.com\npda.gasoft.us\nwsafelogin.com\nmail.nexongame.net\nsmtp.cjinternet.us\nwm.nhntech.com\nwww.gcgame.info\nix.xxoo.co\nsupport.dell-support.org\nhan.zzsoft.info\nimap.hja63.com\nnhntech.com\nqc.xxoo.co\nip.xxoo.co\nsl.myxxoo.com\nmail.joymax.in\nhelp.googleclick.net\nwww.nexoncorp.us\nconimes.com\nusa.xxoo.co\nmy.reegame.net\nlogin.joymax.in\nhsb.mynetav.net\ndocs.naverpulic.com\nfax.nexoncorp.us\nmail.jcrsoft.com\nguys.mynetav.net\ngoogle.x3322.org\njc.nhntech.com\nroqc.xxoo.co\nws.gcgame.info\nxss.gongyi.co\nnew.java-ssl.com\nava.zzsoft.info\neya.jcrsoft.com\ngn.xxoo.co\ncrl.nhntech.com\ntah.xxoo.co\ndns.nhnclass.com\nzzsoft.info\nnx.xxoo.co\nns2.naverpulic.com\npop.zzsoft.info\non.xxoo.co\npwd.nhntech.com\nftp.gcgame.info\nnx2.hangame.co.uk\nhe.xxoo.co\nhk.zzsoft.info\nnhnclass.com\n\n\n-----\n\nnexoncorp.us\nw.gasoft.us\nkr-mail.com\nns1.nhnclass.com\nsmtp.nexoncorp.us\nxv.apanku.com\nimap.nexoncorp.us\nstmp.msftncsl.com\nnx3.hangame.co.uk\nmsftncsl.com\nsoft.hja63.com\nbcc.hja63.com\nwm.myxxoo.com\nns3.msftncsl.com\nus.msftncsl.com\ndns--google.com\nt3.myxxoo.com\nau.msftncsl.com\nsupport.nexononline.com\nsg.java-ssl.com\nl53.xxoo.co\nudp.myxxoo.com\nq.gasoft.us\nnx2.interdriver.net\na.gcgame.info\nmg.zzsoft.info\njp.xxoo.co\nros.zzsoft.info\nx64.reegame.net\nversiontt.no-ip.org\nimap.cjinternet.us\nrf.gcgame.info\nca.zzsoft.info\npda.hja63.com\ntw.java-ssl.com\njava-ssl.com\nsn.jcrsoft.com\nservice.interdriver.net\ndb.nexongame.net\nid.java-ssl.com\nperl.mynetav.net\nosk.jcrsoft.com\nmini.googletrait.com\nmail.gcgame.info\nnc.feelids.com\ntcpiah.googleclick.net\ngoogleclick.net\npop.hangame.co.uk\nwww.gasoft.us\nnxeu.jcrsoft.com\neya.zzsoft.info\n\n\n-----\n\nsellsads.sells-it.net\nwapqq.3322.org\nkr.reegame.net\nnt.nexoncorp.us\ntcp.nhntech.com\nwww.hja63.com\naion.reegame.net\nsu.cjinternet.us\nget.java-ssl.com\neudb.nexongame.net\nnsqc.xxoo.co\nmail.gasoft.us\nkr.jcrsoft.com\nads01.mynetav.net\ngm.gasoft.us\na1.reegame.net\nsmtp.gcgame.info\npda.jcrsoft.com\nkor.xxoo.co\nns9.msftncsl.com\nnx.jcrsoft.com\nnexon.hangame.co.uk\nsmtp.gasoft.us\nns2.java-ssl.com\nalta.apanku.com\nnexon.joymax.in\nmy.gasoft.us\ndns2.msftncsl.com\nckts.mynetav.net\npass1.googletrait.com\ndns.nhnclub.com\nkr.zzsoft.info\nmir.reegame.net\njrun.hja63.com\nwm.googleclick.net\nbot.dongevil.info\nmail.zzsoft.info\nnexononline.com\ntv.mynetav.net\ne.gasoft.us\nxy.hja63.com\nwww.apanku.com\nusa.nexongame.net\nftp.gasoft.us\nogp.reegame.net\nkog.jcrsoft.com\nwww.joymax.in\nbr.xxoo.co\nftp.cjinternet.us\nqc.zzsoft.info\npay.gcgame.info\n\n\n-----\n\nhangame.co.uk\ntest.reegame.net\ngs.xxoo.co\nxx.hja63.com\nap.myxxoo.com\ncg.apanku.com\nns1.naverpulic.com\nree.reegame.net\njp.jcrsoft.com\ninterdriver.net\nns1.java-ssl.com\nwww.googletrait.com\nwww.zzsoft.info\nqs.nexongame.net\nnx3.joymax.in\na1.nexongame.net\nwi.zzsoft.info\nmx.hja63.com\nga.nhntech.com\nnx.cjinternet.us\nftp.jcrsoft.com\nfm.hja63.com\nlftv.mynetav.net\ne.zzsoft.info\nudp.ibm-support.net\nnx3.intercpu.com\nwh.jcrsoft.com\nzz.xxoo.co\nshoes.sellClassics.com\nar.apanku.com\nka.zzsoft.info\njjevil.com\nnexongame.net\nest.gcgame.info\nimc.zzsoft.info\nnewpic.dyndns.tv\nmini.reegame.net\nupdate.ddns.net\njs.nexoncorp.us\nnd.jcrsoft.com\ned.xxoo.co\nalso.msftncsl.com\nsupport.interdriver.net\nru.cjinternet.us\nsmtp.zzsoft.info\npda.gcgame.info\nth.xxoo.co\nnhnclub.com\nwww.cjinternet.us\nssh.joymax.in\ntvads01.dyndns.tv\n\n\n-----\n\npp.ibm-support.net\nblog.mynetav.net\nijj.conimes.com\ntank.hja63.com\nlp.gasoft.us\nnx3.googlefiles.net\npass1.nexongame.net\ngcqc.xxoo.co\nbr.reegame.net\nftpd.9966.org\nkr.xxoo.co\noffices.dyndns-office.com\nhansoft.does-it.net\ngasoft.us\ndocs.nhnclub.com\nsf.cjinternet.us\npass2.nexongame.net\nupdata-microsoft.com\nka.jcrsoft.com\nus.xxoo.co\nmyav.mynetav.net\nw53.myxxoo.com\nisatap.dyndns.org\ntt.conimes.com\nvn.gcgame.info\nap.nhntech.com\nbot.jgame.in\nl.xxoo.co\nftp.hja63.com\nmail.msftncsl.com\ndns01.dyndns-work.com\nservice.hp-supports.com\nns2.nhnclass.com\nfax.cjinternet.us\nnx2.intercpu.com\nwindows.doomdns.com\nbtg.mynetav.net\nxxoo.co\nmynetav.net\nmini.msftncsl.com\npass2.hangame.co.uk\nwebadmin.dnsdojo.net\nimap.gcgame.info\njoymax.in\nudp.jjevil.com\nwww.reegame.net\nmyxxoo.com\niss.conimes.com\nads01.dyndns-web.com\nwww.mynetav.net\ndns.msftncsl.com\n\n\n-----\n\npop.jcrsoft.com\nball.reegame.net\nlyto.zzsoft.info\nrw.nhntech.com\nels.jcrsoft.com\na1.googletrait.com\ngoogletrait.com\nw80.xxoo.co\nscvhosts.com\nnexon.nexongame.net\npic.4pu.com\nq.gcgame.info\ndbo.jcrsoft.com\nns2.msftncsl.com\nynk.xxoo.co\ntw.hja63.com\npass1.reegame.net\nmy.zzsoft.info\nwww2.mynetav.net\nwww.nexongame.net\nid.naverpulic.com\nroap.myxxoo.com\nopenhost.webhop.net\nmir2.nexongame.net\nimap.jcrsoft.com\npop.gasoft.us\nbar.zzsoft.info\ngame.nexongame.net\nfs.nhntech.com\nosk.zzsoft.info\ndocs.nhnclass.com\nt3.nhntech.com\nahn.gasoft.us\nofficess.dyndns-office.com\nnew.nexoncorp.us\ndbo.zzsoft.info\nw.zzsoft.info\nlp.gcgame.info\nro.hja63.com\ngcgame.info\nxl.apanku.com\nweb-games.us\nsl.xxoo.co\nlogin.hangame.co.uk\nro.xxoo.co\ndbo.gasoft.us\nmoon.reegame.net\negi.mynetav.net\nvn.jcrsoft.com\nftp.mynetav.net\nus.nhntech.com\n\n\n-----\n\nmasternow.webhop.net\nfile.googlefiles.net\nholleword.3322.org\nest.zzsoft.info\napanku.com\nhelp.ibm-support.net\ntw.reegame.net\nest.gasoft.us\nmg.jcrsoft.com\nlp.apanku.com\nsmtp.hja63.com\nxnews.myPicture.info\nlp.zzsoft.info\nnx3.interdriver.net\nrss.6600.org\nfn.hja63.com\nusp.xxoo.co\nads01.dyndns-pics.com\noky.mynetav.net\npop.nexoncorp.us\nnaverpulic.com\npop.gcgame.info\nap.googleclick.net\nhaj.mynetav.net\nac.xxoo.co\nmini.nexongame.net\nudp.googleclick.net\nnd.xxoo.co\nnew.myxxoo.com\nrh.jcrsoft.com\nwm.xxoo.co\ndns.java-ssl.com\nwyqc.xxoo.co\nq.zzsoft.info\npass1.joymax.in\nitem.ItemDB.com\nreegame.net\nmailes.dyndns-mail.com\nnd.gasoft.us\na.zzsoft.info\nw53.xxoo.co\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/dlzp6f7hv9q3r0kreqvu8yyt36lzdbxw",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.04.13.Winnti/winnti-more-than-just-a-game-130410.pdf",
        "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134508/winnti-more-than-just-a-game-130410.pdf"
    ],
    "report_names": [
        "winnti-more-than-just-a-game-130410",
        "winnti-more-than-just-a-game-130410.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2c7ecb0e-337c-478f-95d4-7dbe9ba44c39",
            "created_at": "2022-10-25T16:07:23.690871Z",
            "updated_at": "2025-03-27T02:02:09.921431Z",
            "deleted_at": null,
            "main_name": "Goblin Panda",
            "aliases": [
                "1937CN",
                "Conimes",
                "Cycldek",
                "Goblin Panda"
            ],
            "source_name": "ETDA:Goblin Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "BackDoor-FBZT!52D84425CDF2",
                "BlueCore",
                "BrowsingHistoryView",
                "ChromePass",
                "CoreLoader",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "DropPhone",
                "FoundCore",
                "HDoor",
                "HTTPTunnel",
                "JsonCookies",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NBTscan",
                "NewCore RAT",
                "PlugX",
                "ProcDump",
                "PsExec",
                "QCRat",
                "RainyDay",
                "RedCore",
                "RedDelta",
                "RoyalRoad",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Win32.Staser.ytq",
                "USBCulprit",
                "Win32/Zegost.BW",
                "Xamtrav",
                "ZeGhost",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7d553b83-a7b2-431f-9bc9-08da59f3c4ea",
            "created_at": "2023-01-06T13:46:39.444946Z",
            "updated_at": "2025-03-27T02:00:03.093712Z",
            "deleted_at": null,
            "main_name": "GOBLIN PANDA",
            "aliases": [
                "Conimes",
                "Cycldek"
            ],
            "source_name": "MISPGALAXY:GOBLIN PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1365615396,
    "ts_modification_date": 1365615396,
    "files": {
        "pdf": "https://archive.orkl.eu/3a34d6152f2d287f58e67a03d96408b74d5c470e.pdf",
        "text": "https://archive.orkl.eu/3a34d6152f2d287f58e67a03d96408b74d5c470e.txt",
        "img": "https://archive.orkl.eu/3a34d6152f2d287f58e67a03d96408b74d5c470e.jpg"
    }
}