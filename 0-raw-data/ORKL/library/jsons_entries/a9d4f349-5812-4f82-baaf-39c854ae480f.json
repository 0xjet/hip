{
    "id": "a9d4f349-5812-4f82-baaf-39c854ae480f",
    "created_at": "2023-01-12T14:59:11.995033Z",
    "updated_at": "2025-03-27T02:10:54.47984Z",
    "deleted_at": null,
    "sha1_hash": "82879db102b38ec818b19521dc6133147418dd06",
    "title": "2017-06-22 - Following the Trail of BlackTech’s Cyber Espionage Campaigns",
    "authors": "",
    "file_creation_date": "2022-05-27T21:29:22Z",
    "file_modification_date": "2022-05-27T21:29:22Z",
    "file_size": 186818,
    "plain_text": "# The Trail of BlackTech’s Cyber Espionage Campaigns\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/following-trail-blacktech-cyber-espionage-campaigns/](https://blog.trendmicro.com/trendlabs-security-intelligence/following-trail-blacktech-cyber-espionage-campaigns/)**\n\nJune 22, 2017\n\nBlackTech is a cyber espionage group operating against targets in East Asia, particularly\nTaiwan, and occasionally, Japan and Hong Kong. Based on the mutexes and domain names\nof some of their C&C servers, BlackTech’s campaigns are likely designed to steal their\ntarget’s technology.\n\nFollowing their activities and evolving tactics and techniques helped us uncover the\nproverbial red string of fate that connected three seemingly disparate campaigns: PLEAD,\nShrouded Crossbow, and of late, Waterbear.\n\nOver the course of their campaigns, we analyzed their modus operandi and dissected their\ntools of the trade—and uncovered common denominators indicating that PLEAD, Shrouded\nCrossbow, and Waterbear may actually be operated by the same group.\n\n**PLEAD**\n\nPLEAD is an information theft campaign with a penchant for confidential documents. Active\nsince 2012, it has so far targeted Taiwanese government agencies and private organizations.\nPLEAD’s toolset includes the self-named PLEAD backdoor and the DRIGO exfiltration tool.\nPLEAD uses spear-phishing emails to deliver and install their backdoor, either as an\n\n\n-----\n\nattachment or through links to cloud storage services. Some of the cloud storage accounts\nused to deliver PLEAD are also used as drop off points for exfiltrated documents stolen by\nDRIGO.\n\n[PLEAD’s installers are disguised as documents using the right-to-left-override (RTLO)](http://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/)\ntechnique to obfuscate the malware’s filename. They are mostly accompanied by decoy\ndocuments to further trick users. We’ve also seen PLEAD use exploits for these\nvulnerabilities:\n\n[CVE-2015-5119,](http://blog.trendmicro.com/trendlabs-security-intelligence/unpatched-flash-player-flaws-more-pocs-found-in-hacking-team-leak/) [patched by Adobe last July, 2015](https://helpx.adobe.com/security/products/flash-player/apsa15-03.html)\n[CVE-2012-0158,](http://blog.trendmicro.com/trendlabs-security-intelligence/cve-2012-0158-exploitation-seen-in-various-global-campaigns/) [patched by Microsoft last April, 2012](https://technet.microsoft.com/en-us/library/security/ms12-027.aspx)\n[CVE-2014-6352,](http://blog.trendmicro.com/trendlabs-security-intelligence/microsoft-windows-hit-by-new-zero-day-attack/) [patched by Microsoft last October, 2014](https://technet.microsoft.com/en-us/library/security/3010060.aspx)\n[CVE-2017-0199,](http://blog.trendmicro.com/trendlabs-security-intelligence/april-patch-tuesday-microsoft-patches-office-vulnerability-used-zero-day-attacks/) [patched by Microsoft last April, 2017](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199)\n\nPLEAD also dabbled with a short-lived, fileless version of their malware when it obtained an\n[exploit for a Flash vulnerability (CVE-2015-5119) that was](http://blog.trendmicro.com/trendlabs-security-intelligence/unpatched-flash-player-flaws-more-pocs-found-in-hacking-team-leak/) leaked during the Hacking Team\nbreach.\n\n_Figure 1: How PLEAD utilizes compromised routers_\n\nPLEAD actors use a router scanner tool to scan for vulnerable routers, after which the\nattackers will enable the router’s VPN feature then register a machine as virtual server. This\nvirtual server will be used either as a C&C server or an HTTP server that delivers PLEAD\nmalware to their targets.\n\nPLEAD also uses CVE-2017-7269, a buffer overflow vulnerability Microsoft Internet\nInformation Services (IIS) 6.0 to compromise the victim’s server. This is another way for them\nto establish a new C&C or HTTP server.\n\n_Figure 2: One of the methods PLEAD operators use to distribute their malware_\n\nPLEAD’s backdoor can:\n\nHarvest saved credentials from browsers and email clients like Outlook\nList drives, processes, open windows, and files\nOpen remote Shell\nUpload target file\nExecute applications via ShellExecute API\nDelete target file\n\nPLEAD also uses the document-targeting exfiltration tool DRIGO, which mainly searches the\ninfected machine for documents. Each copy of DRIGO contains a refresh token tied to\nspecific Gmail accounts used by the attackers, which are in turn linked to a Google Drive\naccount. The stolen files are uploaded to these Google Drives, where the attackers can\nharvest them.\n\n\n-----\n\n**Shrouded Crossbow**\n\nThis campaign, first observed in 2010, is believed to be operated by a well-funded group\n[given how it appeared to have purchased the source code of the BIFROST backdoor, which](http://blog.trendmicro.com/trendlabs-security-intelligence/new-targeted-attack-group-buys-bifrose-code-works-in-teams/)\nthe operators enhanced and created other tools from. Shrouded Crossbow targeted\nprivatized agencies and government contractors as well as enterprises in the consumer\nelectronics, computer, healthcare, and financial industries.\n\nShrouded Crossbow employs three BIFROST-derived backdoors: BIFROSE, KIVARS, and\nXBOW. Like PLEAD, Shrouded Crossbow uses spear-phishing emails with backdoor-laden\nattachments that utilize the RTLO technique and accompanied by decoy documents.\n\nBIFROSE, known for evading detection by communicating with its C&C servers via Tor\n[protocol, also has a version targeting UNIX-based operating systems, which are usually used](http://blog.trendmicro.com/trendlabs-security-intelligence/threat-actors-behind-shrouded-crossbow-creates-bifrose-for-unix/)\nin servers, workstations, and mobile devices. KIVARS has less functionality than BIFROSE,\nbut its modular structure made it easier to maintain. KIVARS enabled attackers to download\nand execute files, list drives, uninstall malware service, take screenshots, activate/deactivate\nkeylogger, show/hide active windows, and trigger mouse clicks and keyboard inputs. A 64-bit\nversion of KIVARS also emerged to keep pace with the popularity of 64-bit systems. XBOW’s\ncapabilities are derived from BIFROSE and KIVARS; Shrouded Crossbow gets its name from\nits unique mutex format.\n\n**Waterbear**\n\nWaterbear has actually been operating for a long time. The campaign’s name is based on its\nmalware’s capability to equip additional functions remotely.\n\nWaterbear similarly employs a modular approach to its malware. A loader component\nexecutable will connect to the C&C server to download the main backdoor and load it in\nmemory. A later version of this malware appeared and used patched server applications as\nits loader component, while the main backdoor is either loaded from an encrypted file or\ndownloaded from the C&C server.\n\nThe tactic it later adopted required prior knowledge of their targets’ environment. It’s possible\nattackers used Waterbear as a secondary payload to help maintain presence after gaining\nsome levels of access into the targets’ systems.\n\n**All Roads Lead to BlackTech**\n\nBased on the use of the same C&C servers, the campaigns’ coordinated efforts, and\nsimilarities in tools, techniques, and objectives, we can conclude that they are operated by\nthe same group. It is not uncommon, for instance, for a group—especially a well-funded one\n—to split into teams and run multiple campaigns. While most of the campaigns’ attacks are\nconducted separately, we’ve seen apparently joint operations conducted in phases that entail\nthe work of different teams at each point in the infection chain.\n\n\n-----\n\n**_Use of the Same C&C Servers. In several instances, we found the campaigns malware_**\ncommunicating with the same C&C servers. In targeted attacks, C&C servers are typically\nnot shared with other groups. Here are some of the C&C servers we found that are shared\nby the campaigns:\n\n**C&C Server** **PLEAD** **Shrouded Crossbow** **Waterbear**\n\nitaiwans[.]com Yes No Yes\n\nmicrosoftmse[.]com Yes Yes No\n\n211[.]72[.]242[.]120 Yes Yes No\n\n_Table 1: C&C servers shared by PLEAD, Shrouded Crossbow, and Waterbear_\n\nAdditionally, the IP 211[.]72 [.]242[.]120 is one of the hosts for the domain\nmicrosoftmse[.]com, which has been used by several KIVARS variants.\n\n**_Joint Operations. We also found incidents where the backdoors were used on the same_**\ntargets. While it’s possible for separate groups to attack at the same time, we can construe at\nthey are at least working together:\n\n**PLEAD** **Shrouded Crossbow**\n\n\n_Samples from different_\n_groups using the same_\n_filename_\n\n_Backdoors using the_\n_same C&C servers_\n\n_Timeline indicating_\n_arrival order_\n\n\nLoader component named\nafter its target, i.e. {target\n_name}.exe_\n\nConnected to\n211[.]72[.]242[.]120:53\n\nArrived two days after\ninitial infection by SC\n\n\nLoader component named after its\ntarget, i.e. {target name}.exe or\n_{target name}64.exe_\n\nConnected to\n211[.]72[.]242[.]120:443\n\nEstablished presence two years\nprior, but re-infected at a recent time\n\n\n_Table 2: Incident where PLEAD and KIVARS attack the same target_\n\n**PLEAD** **Shrouded Crossbow** **Waterbear**\n\n_Samples found in same machine_ _vmdks.exe_ _cfbcjtqx.dll_ _tpauto.dll_\n\n_Timeline of infection_ 3/16/2017 2/23/2017 3/8/2017\n\n_Table 3: Incidents where PLEAD, KIVARS, and Waterbear were used on the same target_\n\n**_Similarities between tools and techniques. PLEAD and KIVARS, for instance, share the_**\nuse of RTLO techniques to disguise their installers as documents. Both also use decoy\ndocuments to make the RTLO attack more convincing. Another similarity is the use of a small\n\n\n-----\n\nloader component to load encrypted backdoors into memory.\n\n**_Similar Objectives. The ulterior motive of these campaigns is to steal important documents_**\nfrom their victims; initial recipients of their attacks are not always their primary target. For\ninstance, we saw several decoy documents stolen by the attackers that are then used\nagainst another target. This indicates that document theft is most likely the first phase of an\nattack chain against a victim with ties to the intended target. While PLEAD and KIVARS are\nmost likely to be used in first phase attacks, Waterbear can be seen as a secondary\nbackdoor installed after attackers have gained a certain level of privilege.\n\nBased on the type of documents stolen by these campaigns, we can get a clearer view of\nwho they’re targeting and compromising, the purpose of their campaigns, and when they\ntake place. Below are some of the categories or labels of the stolen documents:\n\nAddress book\nBudget\nBusiness\nContract\nCulture\nDefense\nEducation\nEnergy\nForeign affairs\nFunding application\nHuman affairs\n\nInternal affairs\nLaws\nLivelihood economy\nMeeting\nOfficial letter\nPassword list\nPerformance appraisal\nPhysical culture\nPress release\nPublic security\nSchedule\n\n**Enterprises Need to be Proactive**\n\nPLEAD, Shrouded Crossbow, and Waterbear are still actively mounting their campaigns\nagainst its targets, which is why organizations must proactively secure their perimeter.\n\n\n-----\n\nIT/system administrators and information security professionals can consider making a\nchecklist of what to look out for in the network for any signs of anomalies and suspicious\n[behavior that can indicate intrusions. Adopting best practices and employing multilayered](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/form-strategies-based-on-these-targeted-attack-stages)\n[security mechanisms and strategies against targeted attacks are also recommended.](http://blog.trendmicro.com/trendlabs-security-intelligence/four-steps-to-an-effective-targeted-attack-response/)\n[Network traffic analysis,](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/network-traffic-analysis-can-stop-targeted-attacks) [deployment of firewalls and intrusion detection and prevention](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/backdoors-what-they-are-and-how-to-defend-networks-against-them)\nsystems, [network segmentation, and](http://blog.trendmicro.com/trendlabs-security-intelligence/identifying-and-dividing-networks-and-users/) [data categorization are just some of them.](http://blog.trendmicro.com/trendlabs-security-intelligence/identifying-and-dividing-networks-and-users/)\n\n**Trend Micro Solutions**\n\n[Trend Micro™ Deep Discovery™ provides detection, in-depth analysis, and proactive](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/deep-discovery-threat-intelligence-network-analytics.html)\nresponse to today’s stealthy malware, and targeted attacks in real-time. It provides a\ncomprehensive defense tailored to protect organizations against targeted attacks and\n[advanced threats through specialized engines, custom sandboxing, and seamless](http://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-unknown-threats-and-zero-day-attacks/)\ncorrelation across the entire attack lifecycle, allowing it to detect threats like the above\nmentioned zero-day attacks even without any engine or pattern update.\n\n[Trend Micro™ Deep Security™ and Vulnerability Protection provide virtual patching that](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html)\nprotects endpoints from threats that abuses unpatched vulnerabilities. OfficeScan’s\nVulnerability Protection shield endpoints from identified and unknown vulnerability exploits\neven before patches are deployed.\n\n[Trend Micro™ Smart Protection with Maximum XGen™ security infuses high-fidelity machine](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\nlearning into a blend of threat protection techniques to eliminate security gaps across user\nactivity and any endpoint—the broadest possible protection against advanced attacks. An\noverview and analysis of the various malware used by PLEAD, Shrouded Crossbow, and\nWaterbear, along with their Indicators of Compromise (hashes, C&Cs), can be found in this\n**[technical brief.](https://documents.trendmicro.com/assets/appendix-following-the-trail-of-blacktechs-cyber-espionage-campaigns.pdf)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-22 - Following the Trail of BlackTech’s Cyber Espionage Campaigns.pdf"
    ],
    "report_names": [
        "2017-06-22 - Following the Trail of BlackTech’s Cyber Espionage Campaigns.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c93a7f58-3f75-487c-9bd6-e705b73fc07f",
            "created_at": "2023-01-06T13:46:38.330916Z",
            "updated_at": "2025-03-27T02:00:02.806744Z",
            "deleted_at": null,
            "main_name": "RADIO PANDA",
            "aliases": [
                "Shrouded Crossbow"
            ],
            "source_name": "MISPGALAXY:RADIO PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535551,
    "ts_updated_at": 1743041454,
    "ts_creation_date": 1653686962,
    "ts_modification_date": 1653686962,
    "files": {
        "pdf": "https://archive.orkl.eu/82879db102b38ec818b19521dc6133147418dd06.pdf",
        "text": "https://archive.orkl.eu/82879db102b38ec818b19521dc6133147418dd06.txt",
        "img": "https://archive.orkl.eu/82879db102b38ec818b19521dc6133147418dd06.jpg"
    }
}