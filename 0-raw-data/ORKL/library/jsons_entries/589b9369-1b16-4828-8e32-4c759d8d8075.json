{
    "id": "589b9369-1b16-4828-8e32-4c759d8d8075",
    "created_at": "2023-01-12T14:59:43.205531Z",
    "updated_at": "2025-03-27T02:11:43.467376Z",
    "deleted_at": null,
    "sha1_hash": "e4ec1293147d868b2b48a1e6372bb744cb2ea3dd",
    "title": "2020-04-13 - The Blame Game - About False Flags and overwritten MBRs",
    "authors": "",
    "file_creation_date": "2022-05-28T01:28:45Z",
    "file_modification_date": "2022-05-28T01:28:45Z",
    "file_size": 969468,
    "plain_text": "# The Blame Game - About False Flags and overwritten MBRs\n\n**[dissectingmalwa.re/the-blame-game-about-false-flags-and-overwritten-mbrs.html](https://dissectingmalwa.re/the-blame-game-about-false-flags-and-overwritten-mbrs.html)**\n\nMon 13 April 2020 in [Ransomware](https://dissectingmalwa.re/category/ransomware.html)\n\nMBR Lockers have become popular again with Skids. Let's look at a sample that was spread\nyesterday and caught a lot of attention.\n\nLet's start right off with a short introduction: The Malware analyzed here is a so-called MBR\n(Master Boot Record) Locker. It is targeting (like most of the time) only PCs running\nWindows. The good news is: in this case there is neither encryption nor deletion happening\non the file system so there's a good chance for victims to recover their files. A possible\n[mitigation for suers woulds be running MBRFilter which is developed by Talos Intelligence.](https://talosintelligence.com/mbrfilter)\nNow to the Message displayed in the VM below: Pressing CTRL+ALT+ESC for a possible\n[bypass / failsafe to boot the OS (described in this BleepingComputer article) doesn't seem to](https://www.bleepingcomputer.com/news/security/new-wiper-malware-impersonates-security-researchers-as-prank/)\nwork for this sample.\n\n\n-----\n\nAfter Vitali published the tweet below a whole crowd formed in the emerging thread to please\nunlock their PCs. Both Vitali Kremez and MalwareHunterTeam made it clear multiple times\nthat they are not affiliated with this campaign in any way, but some of the victims still seemed\nto miss this fact and got quite worked up about their PCs being compromised. Unfortunately\nthis was not the first and won't be the last time that respected ethical researchers are\ntargeted in such decreditation acts. I'm not qualified to talk about any psychological\nreasoning behind such actions, but it's either an attempt to a Denial of Service (Vitalis Twitter\nDMs and Mentions were filled with complaints and accusations) or looking for attention (not\n[in this case because there were no hints on the malware actors) like the Maze Team.](https://twitter.com/CryptoInsane/status/1222907566365257729)\n\n[*] Beware: Some scams utilize my name and impersonate myself to amplify extortions.\n[pic.twitter.com/wk9Mxkqxpz](https://t.co/wk9Mxkqxpz)\n\n[â€” Vitali Kremez (@VK_Intel) April 12, 2020](https://twitter.com/VK_Intel/status/1249149943702568960?ref_src=twsrc%5Etfw)\n\nAfter talking to a victim to clarify the infection method and origin of the malware I received a\nlink to this pirated Version of Adobe Illustrator. Lures like this one are often trojanized with\nmalware or straight-up malicious from the start like in this case. Obviously this cannot be\nconsidered common knowledge for every user and this is what criminals are taking\nadvantage of for years and years to come.\n\n\n-----\n\nA quick check confirmed my suspicion that every download on this site is \"spiked\" with\nmalware. The Filenames of the executables contain a unique-per-download string. The\nvictim will be redirected to a second site where a user agent check for Windows and\nmatching Browsers (IE, Edge) is performed. The executable is downloaded from another\nURL from a directory called ru53332 which might give us a hint as to where the malware\noriginated from (this looks like a client subfolder, this host might spread other strains as well).\n\nBelow you can see a process graph of the Glupteba Infection generated by Any.Run. This is\njust a subsection of the whole graph and since there was so much going on it was pretty\ndifficult to make out if the MBR Locker actually was delivered with this installer. None of my\ntests in VMs or on a physical test machine resulted in a corrupted MBR, so at the moment I\ncan neither confirm nor deny that the Locker was actually delivered via crackedion[.]com.\n\n\n-----\n\nInterestingly all the executables named WinmonX.sys had broken certificate chains which\nshould be a red flag for AVs running on the vicitims system. There were startup tasks\nscheuduled for all three of these files.\n\nWinMonProcessManager contains a list of ca. 600 Anti-Virus executable names and it's only\npurpose is to disable all AV services while the trojan does its \"magic\":\n```\nexantivirus-cnet.exe, zonealarm.exe, ldnetmon.exe, norton_internet_secu_3.0_407.exe,\nantivirus.exe, netmon.exe, AvastPE2.exe, avast_free_antivirus_setup_online.exe,\nEmsisoftAntiMalwareSetup.exe, drweb32.exe, nod32.exe, f-prot95.exe, f-prot.exe,\ndrwebupw.exe, AvastUI.exe, mcshield.exe ... and so on ðŸ˜‰\n\n```\n\n-----\n\nThe Detection Signatures from different engines on VT and the Intezer Analysis declared the\ndropped executables as parts of the Glupteba Trojan, which has been around for some time\nnow. Additionally there were hints to another Strain called RanumBot that I have not\nivestigated further up until now. In the screenshot you can see the windefender.exe sample\nthat was submitted to Intezer. It was written in Go, packed with UPX and was stuffed with\nstrings. I did not investigate this executable further, but at first I thought that this could have\nbeen the MBR Locker because it contains strings related to Poly1305/ChaCha20.\n\nTo show the effect of the MBR Locker on the OS Drive I simply used a live system to write\nthe first sector of the Disk to a file ( sudo dd if=/dev/sdX of=mbrdump.bin bs=512 count=1 ).\nThe top dump shows the standard MBR contents and below is the corrupted version\ndisplaying only the message to the user.\n\n\n-----\n\nReading the imports with Rabin2 there s nothing out of the ordinary, but there are a few\nthings I wanted to see here. I expected to see CreateFile, which would be used to write the\nMBR Text playload to the first sector of the disk (\\\\.\\PhysicalDrive0) later. Unlike Petya,\nwhich checked whether the PartitionStyle of the drive is actually an MBR (via\nDeviceIoControl), this MBR Locker isn't too concerned about that. There is also some\ngeneric anti-debugging via IsDebuggerPresent, but I didn't expect any further measures\nsince the overall design of the malware is very poor.\n\nTaking a look at the sections of the binary we can spot a .upx section. This looks suspicious\nbecause a sample packed with UPX would have three sections named upx0 (packed), upx1\n(stub) and optionally upx2 (unpacked) like in the image below.\n\nPrinting the contents of the .upx section we can see that the text payload is encrypted.\n\n\n-----\n\nThe decryption routine is found very quickly since the executable only contains three\nfunctions in total. As one might have guessed already the text payload is XORed and\ntherefore has to be decrypted before writing to the MBR. The screenshot below shows the\ndecryption function and south of that you can see the text extraction out of the .upx section\nwe discussed earlier.\n\n\n-----\n\nThe good-ish news is, that in this case the changes made to the Master Boot Record are\nreversible with a Backup of the MBR Sector. Alternatively victims can try to repair the MBR\nwith Microsoft's bootrec /fixmbr and /fixboot. Sucess in this case depends on the partition\nstyle of the Windows install (since the MBR in GPT layouts is reserved for protective\nReasons; on MBR installs bootrec may not be able to recover the Partition table because the\nwhole sector is overwritten. See Vitalis Tweet [here). I verified on a physical GPT install that](https://twitter.com/VK_Intel/status/1249724110663532546)\nLBA 1 and following is not affected by the MBRLocker and should keep the GPT\n[recoverable. TestDisk is theoretically capable of recovering both partitioning layouts. I'd](https://www.cgsecurity.org/wiki/TestDisk)\n[advise victims to use File Recovery software like Photorec as an option for data recovery if a](https://www.cgsecurity.org/wiki/PhotoRec)\nclean install is necessary.\n\n\n-----\n\nIn one case a victim contacted me about an additional STOP Ransomware Infection (.mpaj\nextension, online keyed), but at the moment I can't confirm that this incident happend in\nconjunction with the pirated Software Installer / MBRLocker.\n\n**As there is currently no public sample of the second version of the MBR Locker I will**\n**update this article once it is available. Stay tuned :)**\n\n## MITRE ATT&CK\n\n_T1059 --> Command-Line Interface --> Execution_\n\n_T1179 --> Hooking --> Persistence_\n\n_T1215 --> Kernel Modules and Extensions --> Persistence_\n\n_T1179 --> Hooking --> Privilege Escalation_\n\n_T1112 --> Modify Registry --> Defense Evasion_\n\n_T1179 --> Hooking --> Credential Access_\n\n_T1012 --> Query Registry --> Discovery_\n\n## IOCs\n\n### VK-Wiper MBR Locker\n\n\n-----\n\n```\nGlupteba related:\n=================\nAdobe+Illustrator+CS6+Full+Crack+With+Serial+Keygen+{Latest+2019}+FreeUNIQUESTRING.exe --> SHA256:\n5e00e50d04130b470825d6c1bd58542d32a0a4f52c4d6e6ff01ea1cfad8fce3e\nSSDEEP: 98304:luH/zVSNmGHjYKNC/qPqaMy25WJTZsRvO6Y:8HBymGDY/O4ikvO\nwindefender.exe --> SHA256:\n28e8776a07789daf08629815da0a6eb69613410912447c189a51002f54d956ca\n          SSDEEP:\n49152:mFeWvXwa1xkJrwBskK0CCD/ozKc3k8HxmYfJpz4U+TiAGTeI6h6gHquAb7/i:CvXwaerwBIbKcrxmYfJ\nWinmon.exe --> SHA256:\n889fb266c4c01bb4ef67635249c8daeb641fc86ce62fc280b34beec415fb6129\n        SSDEEP:\n96:/XAUM8mqN18vwLvVfjm3ZAeyRYOiRIfad/WrJ37CgES:7pNuv2LSZA1fEWrR7vES\nWinmonFS.exe --> SHA256:\neb0be2ac3833c843214a55b14c31125a7b600d5272bdf322c4871f42627576e4\n         SSDEEP:\n384:WVYr1nH9XRl8iueNYUaNhuqO3t6PsPJVPswHEvDdvHqciss+E96Vg:vrRlFpaNhuqO3njovpPTtTK\nWinmonProcessMonitor.exe --> SHA256:\nf609c6656a0c451dafa5173df0cd848f7cb7f22c4f150f8d16716c12593de66c\n               SSDEEP:\n384:s+B62cfu4RaQNDEiULv/oGUOY1wR7OLwOMEP5PkdkQE:sOmu4RLNAiUL/oGGS7OLDP5PkdkQE\nMBR Locker V1:\n==============\nsentinelone.scr --> SHA256:\n4cd23a989a8f196b1f49e5e66c6ecfa0cebf63f04950ae4d64127aaedda9e89c\n          SSDEEP:\n48:Zvt+BLdtWU2ew9FRCfH8BArSXXmzdh4vMASG2HvzqEsG8V:Z1+9dtWU2ew9rC/8Kiidh4vMASNHvzB\n\n### URLs\nhxxp://crackedion[.]com\nhxxp://dataf0ral1[.]com\nhxxp://1podcast[.]best/ru53332/\n\n Ransomnote V1\n\n```\n\n-----\n\n```\n SentinelOne Labs Ransomware \nYour system was unprotected, so we locked down access to Windows.\nYou need to buy SentinelOne antivirus in orer to restore your computer.\nMy name is Vitali Kremez. Contacts are below.\nPhone: [Redacted]\nE-mail 1: [Redacted]\nE-mail 2: [Redacted]\nAfter you buy my antivirus I will send you unlock code.\nEnter Unlock code: \n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-13 - The Blame Game - About False Flags and overwritten MBRs.pdf"
    ],
    "report_names": [
        "2020-04-13 - The Blame Game - About False Flags and overwritten MBRs.pdf"
    ],
    "threat_actors": [
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e9f85280-337c-4321-b872-0919f8ef64a6",
            "created_at": "2022-10-25T16:07:24.261761Z",
            "updated_at": "2025-03-27T02:02:10.153781Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Gold Village",
                "Maze Team",
                "TA2101",
                "Twisted Spider"
            ],
            "source_name": "ETDA:TA2101",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BokBot",
                "Buran",
                "ChaCha",
                "Cobalt Strike",
                "CobaltStrike",
                "Egregor",
                "IceID",
                "IcedID",
                "Mimikatz",
                "PsExec",
                "SharpHound",
                "VegaLocker",
                "WinSCP",
                "cobeacon",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535583,
    "ts_updated_at": 1743041503,
    "ts_creation_date": 1653701325,
    "ts_modification_date": 1653701325,
    "files": {
        "pdf": "https://archive.orkl.eu/e4ec1293147d868b2b48a1e6372bb744cb2ea3dd.pdf",
        "text": "https://archive.orkl.eu/e4ec1293147d868b2b48a1e6372bb744cb2ea3dd.txt",
        "img": "https://archive.orkl.eu/e4ec1293147d868b2b48a1e6372bb744cb2ea3dd.jpg"
    }
}