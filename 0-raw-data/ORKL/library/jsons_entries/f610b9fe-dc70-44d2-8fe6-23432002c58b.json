{
    "id": "f610b9fe-dc70-44d2-8fe6-23432002c58b",
    "created_at": "2023-01-12T15:08:03.101044Z",
    "updated_at": "2025-03-27T02:05:27.42466Z",
    "deleted_at": null,
    "sha1_hash": "aa0450638dd96a31901681927fd604ba19f45e0e",
    "title": "2022-12-16 - Agenda Ransomware Uses Rust to Target More Vital Industries",
    "authors": "",
    "file_creation_date": "2022-12-29T00:33:19Z",
    "file_modification_date": "2022-12-29T00:33:19Z",
    "file_size": 3369190,
    "plain_text": "# Agenda Ransomware Uses Rust to Target More Vital Industries\n\n**[trendmicro.com/en_us/research/22/l/agenda-ransomware-uses-rust-to-target-more-vital-industries.html](https://www.trendmicro.com/en_us/research/22/l/agenda-ransomware-uses-rust-to-target-more-vital-industries.html)**\n\nDecember 16, 2022\n\nRansomware\n\nThis year, various ransomware-as-a-service groups have developed versions of their ransomware in Rust, including\nAgenda. Agenda's Rust variant has targeted vital industries like its Go counterpart. In this blog, we will discuss how\nthe Rust variant works.\n\nBy: Nathaniel Morales, Ivan Nicole Chavez, Nathaniel Gregory Ragasa, Don Ovid Ladores, Jeffrey Francis\nBonaobra, Monte de Jesus\nDecember 16, 2022\nRead time: ( words)\n\nThis year, [ransomware-as-a-service (RaaS) groups like BlackCat,](https://www.trendmicro.com/vinfo/us/security/definition/ransomware-as-a-service-raas) [Hive, and](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-hive) [RansomExx have developed versions](https://www.darkreading.com/threat-intelligence/slippery-ransomexx-malware-moves-rust-virustotal)\nof their ransomware in Rust, a cross-platform language that makes it easier to tailor malware to different operating\n[systems like Windows and Linux. In this blog entry, we shed light on Agenda (also known as Qilin), another](https://www.trendmicro.com/en_us/research/22/h/new-golang-ransomware-agenda-customizes-attacks.html)\nransomware group that has started using this language.\n\nAccording to our observations in the past month, the Agenda ransomware’s activities included posting numerous\ncompanies on its leak site. The threat actors not only claimed that they were able to breach the servers of these\n[companies but also threatened to publish their files. The companies that the ransomware group posts on its leak](https://www.trendmicro.com/vinfo/us/security/definition/ransomware)\nsite are located in different countries and belong mostly in the manufacturing and IT industries, with a combined\nrevenue that surpasses US$550 million.\n\nRecently, we found a sample of the Agenda ransomware written in Rust language and detected as\n[Ransom.Win32.AGENDA.THIAFBB. Notably, the same ransomware, originally written in Go language, was known](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/Ransom.Win32.AGENDA.THIAFBB)\nfor targeting healthcare and education sectors in countries like Thailand and Indonesia. The actors customized\nprevious ransomware binaries for the intended victim through the use of confidential information such as leaked\naccounts and unique company IDs as the appended file extension. The Rust variant has also been seen using\nintermittent encryption, one of the emerging tactics that threat actors use today for faster encryption and detection\nevasion.\n\n\n-----\n\nFigure 1. Submission details of the binary in VirusTotal, including the submission date and region it was uploaded.\n\nFigure 2. Strings viewed on BinText showing Rust modules/functions used by the binary\n**Blackbox analysis**\n\nWhen executed, the Rust binary prompts the following error requiring a password to be passed as an argument.\nThis command-line feature is similar to the Agenda ransomware binaries written in Golang.\n\nFigure 3. Error prompt when the sample was executed\nUpon execution of the sample with “—password” as its parameter in conjunction with a dummy password\n“AgendaPass,” the ransomware sample runs its malicious routine starting with the termination of various processes\nand services.\n\n\n-----\n\nFigure 4. Termination of applications and services\nSpecific to the sample we analyzed, the ransomware appends the extension \"MmXReVIxLV” to encrypted files. It\nalso displays activity logs on the command prompt, including the file it has encrypted and the elapsed time.\n\nFigure 5. Examples of encrypted files\n\nFigure 6. Logs in encrypting files\nThe ransomware will then proceed to drop its ransom note on every directory it encrypts. As observed in its ransom\nnote, the password used to execute the ransomware will also be used as the password for logging in to the support\nchat site of the ransomware group.\n\n\n-----\n\nFigure 7. Agenda ransom note\n**Agenda ransomware analysis**\n\n[Unlike Agenda’s Golang variant, which accepts 10 arguments, its Rust variant only accepts three arguments:](https://www.trendmicro.com/en_us/research/22/h/new-golang-ransomware-agenda-customizes-attacks.html)\n\nArgument Description\n\n\n-password\n{string}\n\n-ips {IP\naddress}\n\n-paths\n{directory}\n\n\nDefines the password to enter landing\n\nAllows for providing IP addresses\n\nDefines the path that parses directories; if this flag is used and left empty, all directories will be\nscanned\n\n\nTable 1. Arguments used by the Agenda ransomware’s Rust variant\n\nThe Rust variant also contains hard-coded configuration inside its binaries like the earlier samples compiled in\nGolang.\n\nFigure 8. Function inside the binary containing the configuration\n\n\n-----\n\nFigure 9. Strings containing the configuration\nIt also added the -n, -p, fast, skip, and step flags on its configurations, which are not present in the Golang variant\nconfiguration and only used via command-line argument. Upon further analysis, we have learned that these flags\nare used for intermittent encryption. This tactic enables the ransomware to encrypt the victim’s files faster by\npartially encrypting the files depending on the values of the flags. This tactic is becoming more popular among\nransomware actors as it lets them encrypt faster and avoid detections that heavily rely on read/write file operations.\n\nFlags Description\n\nfast Encrypts the first (N*0x200000h) of the file\n\nskip (N) – step (Y) Skip encryption for N bytes after encrypting Y bytes of the file\n\nn: {N} p: {P} Encrypt (N*0x200000h) of the file and skips p bytes (P - percentage of the file size)\n\nTable 2. Flags used for intermittent encryption\n\n\n-----\n\nFigure 10. Flags used for intermittent encryption\n\nFigure 11. Command-line arguments accepted by the Golang variant of the Agenda ransomware\nWe tried to mimic its encryption behavior using some of the flags present on its configuration. For this simulation,\nwe used a dummy file filled with “A” as its content.\n\nFor fast mode:\n\nValue: 1\n\nFigure 12. Fast flag set to 1\nEncrypted bytes: 1 * 0x200000h, where 1 is the value set in the fast flag\n\n\n-----\n\nFigure 13. 0x200000h bytes encrypted\nFor N-P mode:\n\nFigure 14. flags set to n = 1; p = 1\nTotal size = 88,082,336 bytes\n\nBytes encrypted = 1 * 0x200000,h where 1 is the value set in the n flag\n\nBytes skipped = 880,818 bytes (1% of the whole file), where 1 is the value set in the p flag\n\n\n-----\n\nFigure\n\n\n15. 0x200000h of bytes encrypted\n\n\n-----\n\nFigure 16. 880,818 bytes (equivalent to 1% of the file) encrypted\nAside from the additional flags used for different encryption modes, the Rust variant has included AppInfo to its\nroster of services to terminate. It disables User Account Control (UAC), a Windows feature that helps prevent\nmalware from executing with administrative rights, resulting in the inability to run other applications with\nadministrative privileges.\n\nFigure 17. Function used to\n\nstop service using parameter 0x01 equivalent to SERVICE_CONTROL_STOP\n\n\n-----\n\nFigure 18. Function used for disabling services using parameter 0x04 equivalent to SERVICE_DISABLED\n\nFigure 19. Unable to run an application with administrative\n\nrights after disabling AppInfo service\nThe Agenda ransomware is also known to deploy customized ransomware for each victim, and we have seen that\nits Rust variants have an allocated space for adding accounts in their configuration to be used mostly for privilege\nescalation.\n\nFigure 20. Allocated accounts in the Rust\n\nvariant configuration of the Agenda ransomware\nThe file extension to be appended on the encrypted files is hard-coded in its configuration.\n\nFigure 21. File extension to be appended\nUnlike the previous Golang variant, however, the threat actors did not include the credentials of the victim in the\nconfiguration of the Rust variant. This feature of the latter prevents other researchers not only from visiting the\nransomware’s chat support site but also accessing the threat actors’ conversations when a sample becomes\navailable externally. It also prevents unsolicited messages from other people besides the victim.\n\nFigure 22. The Agenda ransomware chat support site\n**Conclusion**\n\n\n-----\n\nAn emerging ransomware family, Agenda has recently been targeting critical sectors such as healthcare and\neducation industries. At present, its threat actors appear to be migrating their ransomware code to Rust as recent\nsamples still lack some features seen in the original binaries written in the Golang variant of the ransomware. Rust\nlanguage is becoming more popular among threat actors as it is more difficult to analyze and has a lower detection\nrate by antivirus engines.\n\nThreat actors continue to favor ransomware as their tool of choice for conducting their operations, reiterating the\n[call for enterprises and organizations to rely on a multilayered solution to secure data. Trend Micro Vision One™](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nprovides visibility, correlated detection, and behavior monitoring across multiple layers: email, endpoints, servers,\ncloud workloads to help enterprises and organizations protect their systems from different threats, including\nransomware.\n\n**Indicators of Compromise (IOCs)**\n\n**SHA256** **Detection**\n\ne90bdaaf5f9ca900133b699f18e4062562148169b29cb4eb37a0577388c22527 Ransom.Win32.AGENDA.THIAFBB\n\n55e070a86b3ef2488d0e58f945f432aca494bfe65c9c4363d739649225efbbd1 Ransom.Win32.AGENDA.THIAHBB\n\n37546b811e369547c8bd631fa4399730d3bdaff635e744d83632b74f44f56cf6 Ransom.Win32.AGENDA.THIAHBB\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-16 - Agenda Ransomware Uses Rust to Target More Vital Industries.pdf"
    ],
    "report_names": [
        "2022-12-16 - Agenda Ransomware Uses Rust to Target More Vital Industries.pdf"
    ],
    "threat_actors": [
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536083,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1672273999,
    "ts_modification_date": 1672273999,
    "files": {
        "pdf": "https://archive.orkl.eu/aa0450638dd96a31901681927fd604ba19f45e0e.pdf",
        "text": "https://archive.orkl.eu/aa0450638dd96a31901681927fd604ba19f45e0e.txt",
        "img": "https://archive.orkl.eu/aa0450638dd96a31901681927fd604ba19f45e0e.jpg"
    }
}