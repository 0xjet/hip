{
    "id": "69c3de18-50c7-49f8-95db-3204447ce7ae",
    "created_at": "2022-10-25T16:48:23.177628Z",
    "updated_at": "2025-03-27T02:16:57.918607Z",
    "deleted_at": null,
    "sha1_hash": "6b2579a0886d2a14bb3f4a86cb5f18782da63fe3",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-10-10T18:21:05Z",
    "file_modification_date": "2019-10-10T18:21:11Z",
    "file_size": 4453991,
    "plain_text": "-----\n\n## ASEC REPORT\n#### VOL.96 [Q3 2019]\n\n\n###### ASEC (AhnLab Security Emergency-response Center) is a global security response group consisting of malware\n\n analysts and security experts. This report is published by ASEC and focuses on the most significant security\n\n threats and latest security technologies to guard against such threats. For further details, please visit AhnLab,\n\n Inc.’s homepage (www.ahnlab.com).\n\n\n###### SECURITY TREND OF Q3 2019\n\n\n###### Table of Contents\n\n\n-----\n\n-----\n\n###### Security Issue\n\n\n### Analysis Report on Operation Red Salt\n\n\n###### During an analysis of the attacks made on July 2019 against the South Korean government\n\n agencies, ASEC (AhnLab Security Emergency-response Center) observed a series of activities\n\n suspected as targeted email attacks. Although these attacks did not exploit a new weakness\n\n or use a high-level of attack methods, it was highlighted due to its activity of targeting specific\n\n personnel of the the South Korean government agencies with the intention of stealing\n\n personal information.\n\n It appeared that these attacks were not one-time but rather closely related to the previous\n\n attacks that have been targeting the South Korean government agencies since early 2015.\n\n Moreover, similar malware being used during attacks in the following year suggest that it is\n\n a continuation of attacks that have gone on for years against the South Korean government\n\n agencies and major diplomatic organizations. Because of the file names used during attacks,\n\n such as, ‘WinSAT.exe,’ ASEC has named the series of attacks as ‘Operation Red Salt.’\n\n This analysis report contains information on the relationship between the malware and files\n\n used during the attacks while also focusing on the attack method of 'Operation Red Salt'\n\n analyzed by ASEC.\n\n\n-----\n\n###### 1. Attack method used during Operation Red Salt\n\n First, let’s take a look at the attack method used during Operation Red Salt, which targeted the\n\n South Korean government agencies in July, 2019. Although the details regarding the attack\n\n method is still unknown, the attacker carried out targeted email attacks.\n\n [Fig 1-1] shows the relationship of the malware used during the attack towards the South\n\n Korean government agencies in July 2019.\n\nFigure 1-1 | Relationship of the malware used during the attack towards the South Korean government agencies in July 2019\n\n###### When the user executes the attached malicious script file, “참고.txt.wsf (translated as ‘reference.\n\n txt.wsf’),” a malware is activated. Then it downloads ‘ChromeDrop.rar’ after accessing a hacked\n\n website that belonged to a specific law firm. The downloaded file is a password-protected RAR\n\n archive and cannot be unzipped without a password. It can be unzipped using a password if an\n\n archiving software, such as WinRAR, exists on the system.\n\n After the archive is unzipped, ‘ChromeDrop.dat’ accesses a specific FTP server and downloads\n\n\n-----\n\n###### ‘ChromeSearch.dat’ when ‘ChromeDrop.dat’ inside the RAR archive is executed. ‘ChromeSearch.\n\n dat’ saves user input, and collects screenshot and file list to steal.\n\n 2. Detailed analysis of the files\n\n Now, let’s look at the analysis on the downloader and the stealer files used during the attacks.\n\n 2-1. Downloader file analysis (1) – 참고.txt.wsf (translated as reference.txt.wsf)\n\n [Table 1-1] shows detailed information about the downloader file, “참고.txt.wsf (translated as\n\n ‘reference.txt.wsf’).”\n\nFile name 참고.txt.wsf (translated as ‘reference.txt.wsf’)\n\nFile Length 3,284 bytes\n\nTime Created     \nMD5 e3ffe08efc006f54e0d206bf656af414\n\nSHA1 ada95f65fed4c445d035f92038519fe2f018a443\n\nSHA256 40d1685e4e38b624e4a5856c2de2c316239d0ddadf0aa04a72af6020c739ec87\n\nKey Features and\n\nDownload file\n\nCharacteristics\n\nAhnLab Alias JS/Downloader\n\nTable 1-1 | File information\n\n|File name|참고.txt.wsf (translated as ‘reference.txt.wsf’)|\n|---|---|\n|File Length|3,284 bytes|\n|Time Created|-|\n|MD5|e3ffe08efc006f54e0d206bf656af414|\n|SHA1|ada95f65fed4c445d035f92038519fe2f018a443|\n|SHA256|40d1685e4e38b624e4a5856c2de2c316239d0ddadf0aa04a72af6020c739ec87|\n|Key Features and Characteristics|Download file|\n|AhnLab Alias|JS/Downloader|\n\n\n###### It is a Javascript file, which downloads ‘ChromeDrop.rar’ from a hacked corporate website.\n\n Based on the file name used, the attacker attempted to disguise the file as a Chrome-related\n\n file. However, according to the analysis, the file was not related to the Chrome browser.\n\n\n-----\n\n###### [Fig 1-2] shows the script used in the downloader.\n\nFigure 1-2 | Downloader script\n\n###### The downloaded file, ‘ChromeDrop.rar’ is a password-protected archive. A pre-defined\n\n password is used to unzip the archive, as shown in [Fig 1-3], if an archiving software, such as\n\n ALZip or WinRAR, is installed on the system. When the archive is unzipped, ‘ChromeDrop.dat’\n\n is created and the DLL file is loaded.\n\nFigure 1-3 | Unzipping codes\n\n###### 2-2. Downloader file analysis (2) - ChromeDrop.dat\n\n [Table 1-2] shows detailed information about another downloader file, ‘ChromeDrop.dat.’\n\n\n-----\n\n|File name|ChromeDrop.dat|\n|---|---|\n|File Length|75,776 bytes|\n|Time Created|2019/7/7 13:01:49 (UTC)|\n|MD5|b8c63340b2fc466ea6fe168000fedf2d|\n|SHA1|066a4ed05d868932cdecd9b79b60b7aad3787fe3|\n|SHA256|eeb11d63878f8577674be30dcdfeda82b97a99743a9c1e2768e5be927f8c2771|\n|Key Features and Characteristics|Accesses a specific FTP server and downloads a file|\n|AhnLab Alias|Downloader/Win32.Agent|\n\n\nTable 1-2 | File information\n\n###### As shown in [Fig 1-4], ‘ChromeDrop.dat’ examines the process it loaded, and terminates the\n\n process that are not ‘notepad.exe,’ ‘winword.exe,’ or ‘cmd.exe.’ Such behavior is assumed to\n\n ensure that the downloader is not analyzed by a scanning software, such as an automatic\n\n analysis system.\n\nFigure 1-4 | Examination of a running process\n\n###### Also, it registers itself in the registry and runs the chromeCheck function in the DLL file\n\n through ‘rundll32.exe.’ This function downloads ‘ChromeSearch.dat’ from a specific FTP site.\n\n\n-----\n\n###### [Fig 1-5] shows the download code. The exact file information is unknown because the file\n\n was no longer available at the time of analysis.\n\n 2-3. Stealer file analysis - ChromeSearch.dat\n\n [Table 1-3] shows detailed information about the stealer file, ‘ChromeSearch.dat.’\n\n|File name|ChromeSearch.dat|\n|---|---|\n|File Length|134,656 bytes|\n|Time Created|2019/7/7 13:01:39 (UTC)|\n|MD5|f82c07feea45f745fa1e7be834f92bdb|\n|SHA1|2a5e848ff95df52950b2b8c55a0a2cd6b0a71a7c|\n|SHA256|9fc8d922fe99cf83954b31a8af5a41a8dac0e14c55724cd62cbcda5c3689ab90|\n|Key Features and Characteristics|Collects system information, such as key logs|\n|AhnLab Alias|Trojan/Win32.Akdoor|\n\n\nTable 1-3 | File information\n\n\n###### ‘ChromeSearch.dat’ was not available on the FTP server at the time of analysis. However,\n\n ‘ChromeSearch.dat,’ which was identical to the file downloaded from the attacked site,\n\n was additionally found. Thus. It is assumed that ‘ChromeDrop.dat’ had downloaded\n\n ‘ChromeSearch.dat.’\n\n\n-----\n\n###### After the DLL file is loaded, ‘ChromeSearch.dat’ determines if it is running as 'explorer.exe’\n\n process, as shown in [Fig 1-6], and terminates the process if the ‘explorer.exe’ has not already\n\n been loaded.\n\nFigure 1-6 | Main function\n\n###### Afterward, ‘ChromeSearchRealMutex’ creates a mutex to prevent duplicate execution. Also,\n\n as shown in [Fig 1-7], it collects data such as user input key strings, system screen, and\n\n system information and stores it in files, such as, 'ChromeSearch.klg,' 'ChromeSearch.scf,'\n\n 'ChromeSearch.cif,' and 'ChromeSearch.lst.'\n\nFigure 1-7 | System information stealing function\n\n\n-----\n\n###### 3. Malware used during the attack\n\n The malware used in Operation Red Salt can be classified into three categories: downloader,\n\n dropper, and stealer.\n\n 3-1. Downloader\n\n A downloader first made its appearance in September 2015. Its file size is about 70 KB and\n\n is sometimes packed with a UPX file, which results in a file size of about 35 KB. File names, \n\n mainly used for downloader files, include ‘wsat.dll,’ ‘WinSAT.dll,’ ‘WinSat64.dll,’ and ‘Mcx2Svc.dat.’\n\n [Fig 1-8] shows the main function of the downloader.\n\nFigure 1-8 | Main function of the downloader\n\n###### According to the initial analysis of the file, variants were mostly in the form of DLL files, with\n\n only a few being PE file format. Commonly, downloaders download files from a web server.\n\n However, as shown in [Fig 1-9], this variant downloads the file from an FTP server.\n\n\n-----\n\n###### 3-2. Dropper\n\n A dropper is a malware that generates a stealer for stealing user information. It was first\n\n discovered in September 2015. Its file size is about 230 KB, and includes names, such as\n\n ‘WINWORD.exe’ and ‘WinSAT.exe.’\n\n As shown in [Fig 1-10], it compresses and stores the 32-bit and 64-bit malware file in a\n\n resource called ‘LUCK.’\n\nFigure 1-10 | Disabling stored code in a resource\n\n###### Then, it checks the operating system and generates the file accordingly. The generated file is\n\n\n-----\n\n###### the stealer, which is then used to steal user information.\n\n 3-3. Stealer\n\n A stealer is malware, generated by the dropper or the downloader to steal data and has a file\n\n size of 120 KB. Frequently used file names in 2015 by the stealer were ‘wsat.dll,’ ‘WinSAT.dll,’\n\n and ‘HwpUpdateCheck.dll.’ In 2019, they disguised as Chrome-related files, such as ‘ChromInst.\n\n dat’ and ‘ChromeSearch.dat.’\n\n [Fig 1-4] shows the changes in the names of stealer codes\n\nwsat.dl -> WinSAT.dll -> HwpUpdateCheck.dll -> WinSat.dat -> ChromInst.dat -> ChromeSearch.dat\n\nTable 1-4 | Changes in malware names\n\n\n###### The malware collects and stores user key inputs, screen captures, and system information in\n\n files with similar names of its own.\n\n\napkmng.db\n\nChromeSearch.cif\n\nChromeSearch.dat\n\nChromeSearch.klg\n\nChromeSearch.lst\n\nChromeSearch.scf\n\nChromInst.cif\n\nChromInst.klg\n\nChromInst.lst\n\nChromInst.scf\n\nIEUpdate.cif\n\n\nIEUpdate.klg\n\nIEUpdate.lst\n\nIEUpdate.scf\n\nNaverAddress.db\n\nsponge.apk\n\nWinSat.cif\n\nWinSat.klg\n\nWinSAT.lst\n\nWinSAT.rem\n\nWinSat.scf\n\n\n###### From 2015 to 2019, the attacker has been continually attempting to attack both the South\n\n Korean government agencies and major diplomatic organizations. However, because similar\n\n codes and files names were used, the malware used during the attacks can be easily identified.\n\n\n-----\n\n###### 4. Response and prevention via AhnLab solutions\n\n AhnLab’s V3 solutions detect the malware used during the Operation Red Salt under the\n\n following product aliases.\n\n <V3 Product Aliases>\n\n - Backdoor/Win32.Akdoor\n\n - Downloader/Win32.Agent\n\n - JS/Downloader\n\n - Trojan/Win32.Agent\n\n - Trojan/Win32.Downloader\n\n 5. IoC (Indicators of Compromise)\n\n Names of major file samples\n\n The names of the major file sample used during the Operation Red Salt are as follows.\n\n\nChromeDrop.dat\n\nChromeSearch.dat\n\nChromInst.dat\n\nChromSrch.dat\n\nHncCheck64.dll\n\nHncUpdate.dll\n\nHwpUpdateCheck.dll\n\nMcx2Svc.dat\n\n###### Hashes - md5\n\n\nOfficeFontMgr.dll\n\nOfficeFontMgr64.dll\n\nWinSAT.dll\n\nWinSAT.exe\n\nWinSAT64.dll\n\nWINWORD.exe\n\nwsat.dll\n\nwsat.exe\n\n\n###### Hash codes for Operation Red Salt are as follows.\n\n\n01f80d36583501db80ee35a8722a32c3\n\n0763768e90f7f553b64023dc406a07bd\n\n0bae7be10be7eed4a1cf0d8046ad7144\n\n\n11ffe6cf023aa33650f8016a1d6c22e7\n\n146ffca3460faf639ee016524120de82\n\n1a2ea344a20788d82cf806023b05ccdd\n\n\n-----\n\n1b8306cf9ffe54b1402f3399de35dc30\n\n244d3ed9ff4585caf79edbf097ae727b\n\n25039b0c0c64e3083ee375489bebcdfc\n\n2516fd16d39e745170a06a68670e5fc0\n\n2df292523d6ce61b93c90d7b08374845\n\n50e1a9c1aaf0c48db4fe12ff0618ace5\n\n51c3102cf3fe667a1a763989c32fa4da\n\n57b0f442ab1eb3801311536b6fa6fc7c\n\n5904a38b1cc66bc64f4b1e7019a71004\n\n5bc87519b3e86402b6edef5275b73597\n\n5fa632889b1979302db69db715972c90\n\n60f933a94447617331e5b9e7f6573170\n\n62ef65f5712649716d71f6ccf90bf696\n\n660329868b60099e2593f315a2c09269\n\n6934fccd887142772bace30613c8407d\n\n70acdc9a8b5467da439cf8cb081ec9c1\n\n7662a7d4ab1dcc6c914c01ac4079d5a0\n\n807d99fb54b1bc70e3d5f3bdc6629c09\n\n81737a04a99a51dacca6dc9f8f10ebb9\n\n87399c869bf4c0205406acdaa9adbed9\n\n8b4550f588037ad726c469b1674a585a\n\n8dd9d62f8091d826cd438c9dcd595123\n\n9035b0127fbd611ebdf916690136b646\n\n92ea31fe6a3b6af0b9407a06350579ef\n\n93ceb72e35c88d51fc9947a14d8164d1\n\n###### Export functions\n\n\na80703e792de3390cd54a6100a4a381d\n\naa82334ed38b3adb2c7f28377c1b550d\n\nab3428f7f3340ae107096f9a1d4a8f90\n\naeea0915f0b59335a80e0096bf932b63\n\naf8ee6ccd13a1f41305607ed84e18a27\n\nb66466a51d9efc2b418cedb966301be2\n\nb8c63340b2fc466ea6fe168000fedf2d\n\nba4bb480eff2610a04d8ba55fbdd6520\n\nbc7bb996d48b4c6a4013d23aad600848\n\nbf1a9df237014925c89af1d248916dfc\n\nc86efec98f69cc3a178b48436fdb5936\n\nccc0724347e1c7996fb7a150b56cce47\n\nccd417a4d0f5ad82aa2bbae63043783f\n\ncdc2c5b0d2b462a450720909c715030c\n\ncf5d05a9627c3b6fb52a7aca7e82eef0\n\ncfac51f1a10d6a176617ffd3a3a261cb\n\nd393c064418db59c60b76e375d9cbc49\n\ndac025ede5f8dba11c5f7398167df083\n\ne318fe6a58ba06e53e4c1f4811a2b3ca\n\ne3ffe08efc006f54e0d206bf656af414\n\nef6ed9bb1549954e8a6c07cb52fd767d\n\nf5d4e4726a0d41ceda1599cf2b3da4aa\n\nf82c07feea45f745fa1e7be834f92bdb\n\nfa4a623f4d3dcca2dd54d7549791e2de\n\nfdf9be8cf45b07f61c3e0380241b580c\n\n\n###### The export functions used during the Operation Red Salt are as follows. One of the most\n\n frequently used exploit function is RunAssessment.\n\n\nCheckUpdate\n\nchromeCheck\n\nExportName\n\n\nIEUpdate\n\ninsrchmdl\n\nRunAssessment\n\n\n-----\n\n-----\n\n###### ANALYSIS-IN-DEPTH\n\n\n### Analysis on the Malicious SDB File Found in Ammyy Hacking Tool\n\n\n###### Early this year, there was a major distribution of Clop ransomware, mainly targeting Korean\n\n government agencies. Clop ransomware distributed using a hack tool called ‘Ammyy,’ is unlike\n\n common ransomware and attacks after a period of latency. Since the end of May 2019, Clop\n\n ransomware has emerged again with the sudden increase in the distribution of Ammyy hack\n\n tool.\n\n While analyzing Ammyy, ASEC found a malware utilizing the SDB (Shim Database) file,\n\n created during the installation and uninstallation of Ammyy. Let’s take a closer look at the\n\n operation, flow, and features of the SDB-based malware, based on the analysis made by ASEC\n\n (AhnLab Security Emergency-response Center).\n\n 1. Distribution flow of Clop ransomware via Ammyy downloader\n\n Let’s begin with the distribution flow of Clop ransomware using the Ammyy hacking tool.\n\n Ammyy hacking tool uses social engineering and distributes ransomware via email. As shown\n\n in [Fig 2-1], the ransomware downloads the Ammyy downloaders, and installs the malicious\n\n backdoor as a result.\n\n\n-----\n\n###### As shown in [Fig 2-1] flowchart, processes that lead up to Ammyy installation are explicit.\n\n However, how the installation of ransomware is carried out is still under study. The installation\n\n and uninstallation of Ammyy backdoor has a short cycle period. Among the files that are\n\n found to have been created during this period, ASEC found and analyzed the SDB-based\n\n malware, which is quite rare in Korea.\n\n 2. The operation, flow, and features of the SDB-based malware\n\n Let’s take a look at the operation flow of the SDB-based malware. Ammyy backdoor uses\n\n an SDB(Shim Database) file to generate malware to install other backdoors on the system\n\n in a way that the users can hardly notice. The created malware include injectors, commonly\n\n named as ‘loader32.exe,’ and malware, such as ‘SDB_msf_32_crypted.dll,’ which installs the\n\n malicious SDB file.\n\n The SDB file is a Windows mechanism to support backward compatibility, which accepts\n\n\n-----\n\n###### various types of ‘compatibility fixes.’ When an application calls a DLL file, it uses the codes in\n\n the SDB file to maintain compatibility.\n\n [Fig 2-2] shows the installation process of a backdoor utilizing the SDB file.\n\nFigure 2-2 | Backdoor installation process utilizing the SDB file\n\n###### [Table 2-1] shows an overview of malware flow utilizing the SDB file.\n\n1. Ammyy backdoor generates loader32.exe and SDB_msf_32_crypted.dll.\n\n2. loader32.exe directly loads SDB_msf_32_crypted.dll or injects it into another process.\n\n3. loader32.exe writes encoded backdoor PE on a specific registry.\n\n4. Then it generates a malicious SDB file and registers it using sdbinst.exe. The SDB file targets services.exe, or its program function\n\n‘ScRegisterTCPEndpoint()’ to be more specific.\n\n5. At system reboot, services.exe is executed, and the registered malicious SDB codes are applied.\n\n6. Function ‘ScRegisterTCPEndpoint()’ is executed during the initial routines of services.exe. This means that the patched shellcode of\n\n**services.exe is executed as soon as services.exe is executed.**\n\n7. The shellcode reads the registry, which includes encoded backdoor PE, decodes it, then launches it on the memory.\n\n8. Finally, following a system reboot, the malicious backdoor code is running inside services.exe.\n\n\nTable 2-1 | Flow of SDB-based malware\n\n\n###### This way, the SDB-based malware writes the encoded backdoor malware in the registry, as\n\n\n-----\n\n###### shown in [Fig2-3]. The encoded backdoor is registered to the registry path ‘HKLM\\SOFTWARE\\\n\n Microsoft\\[randum string].’\n\nFigure 2-3 | Encoded backdoor PE registered in the registry\n\n###### Then, it generates a malicious SDB file and registers it using the ‘sdbinst.exe’ utility software.\n\n The registered SDB file is located at ‘C:\\Windows\\AppPatch\\Custom.’\n\n Observation on the generated SDB file structure reveals that the SDB file is targeting a\n\n ‘services.exe’ process, as shown in [Fig 2-4]. The ‘services.exe’ process is capable of overwriting\n\n a specific offset with its shellcode, which is not an official feature supported by ‘Shim,’ but is\n\n used nonetheless by the attacker to patch a specific address within the memory.\n\nFigure 2-4 | Structure of the malicious SDB file\n\n\n-----\n\n###### The ScRegisterTCPEndpoint() function is one of the internal features of ‘services.exe.’ If\n\n this function is called while ‘services.exe’ is running, the shellcode is executed instead. The\n\n shellcode decodes the encoded PE file that has already been registered and launches it on\n\n the memory.\n\nFigure 2-5 | Offset address to be patched by ‘services.exe’ in the memory\n\n###### [Fig 2-5] shows the offset address to be patched by ‘services.exe’ in the memory, and [Fig 2-6]\n\n shows the ‘ScRegisterTCPEndpoint()’ function used during this process.\n\nFigure 2-6 | ‘ScRegisterTCPEndpoint()’ function\n\n\n###### The malware defines the offset address while generating the SDB file because the offset\n\n address of the ‘ScRegisterTCPEndpoint()’ function may vary depending on the version of the\n\n operating system. In the routine, ‘services.exe’ is read onto the memory from the Windows\n\n system path, as shown in [Fig 2-7].\n\n\n-----\n\n###### Then, the code seeks a hard-coded string, ‘DisableRPCOverTCP,’ which is specific to the\n\n ‘ScRegisterTCPEndpoint()’ function. As shown in [Fig 2-8], this string is located at the end of\n\n the ‘ScRegisterTCPEndpoint()’ function. Then, from this location, the code searches upwards\n\n to initiate the start routine of the function.\n\nFigure 2-8 | Hard-coded string at the end of the ‘ScRegisterTCPEndpoint()’ function\n\n\n###### Shim is applied when a process is generated. Because the code is targeting ‘services.exe,’ a\n\n normal system process, ‘services.exe’ will become the agent of the malicious behavior for the\n\n SDB file after the system reboot.\n\n The malicious backdoor learns the necessary information of the infected system and sends\n\n it to a C&C server, then runs commands after a connection to the server is established. These\n\n commands include features such as searching, generating, and deleting files. Besides this, the\n\n\n-----\n\n###### backdoor can carry out basic functions, such as running CMD commands through a pipe and\n\n sending the result to the C&C server.\n\n The backdoor also searches for related files. First, it checks the ‘ip.txt’ file in the ‘system32’\n\n folder (where ‘services.exe’ is located) or the system root path (C:\\). In the file, additional\n\n C&C server addresses are assumed to be added. If such addresses do not exist in the file, the\n\n backdoor will attempt to access the basic C&C server address that is hard-coded.\n\n Prior to sending the basic information to the server, the backdoor searches for ‘BotInfo.txt’ in\n\n the ‘system 32’ folder. This file is assumed to contain information about the infected system.\n\n If such file does not exist, it accesses http://ip-api.com/json and obtains various information,\n\n such as the IP address, city, country, and Internet Service Provider, then acquires additional\n\n system information, such as the operating system version, PID, and user name before sending\n\n it to the C&C server.\n\n [Fig 2-9] shows the routine to acquire information about the infected system.\n\nFigure 2-9 | Routine to acquire information about the infected system\n\n\n-----\n\n###### Therefore, other than removing the Ammyy and injector codes, disinfection must be\n\n performed for the installed SDB file if a malicious SDB file has already been installed by\n\n Ammyy backdoor. Otherwise, the backdoor will continue to run within the ‘services.exe’\n\n process. Users can hardly recognize the infection because a normal system process, ‘services.\n\n exe,’ has become an agent for the backdoor’s malicious behavior.\n\n Such attacks utilizing the malicious SDB file are similar to the previous attacks made by FIN7\n\n attack group, also known as the Carbanak attack group. (Reference URL: https://www.fireeye.\n\n com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html)\n\n 3. Malicious factors based on the SDB file structure\n\n To fight against such attacks utilizing the SDB file, ASEC invented a diagnostics process to\n\n detect malicious SDB files. As it was stated earlier, the SDB file is a database file designed to\n\n support the backward compatibility of software applications. It operates when the function\n\n operation changes, calling API functions and converting the codes given to it. The malware\n\n that we found this time manipulates the operation of ‘services.exe’ to launch the SDB file with\n\n a shellcode when ‘ScRegisterTCPEndpoint()’ is called.\n\n Then the question is, how is the SDB file composed, and how did the shellcode operate\n\n when the ‘services.exe’ process is loaded? The previous example of [Fig 2-4] explains how a\n\n significant amount of data is located in the SDB file.\n\n First, the SDB file is composed of a header (0xC sized) and a repeated pair of tags and data\n\n following it. The data that follows may vary depending on the tag, and the ‘tag and data’ pair\n\n\n-----\n\n###### is listed in that exact order. Therefore, to understand the complete structure, the data must\n\n be read from the first offset although the preceding tag may predict the following data. As\n\n shown in [Table 2-2], the 4 upper bytes determine the tag type.\n\n|Tag types|Description TAG_TYPE_NULL|\n|---|---|\n|0x1000||\n|0x2000|TAG_TYPE_BYTE|\n|0x3000|TAG_TYPE_WORD|\n|0x4000|TAG_TYPE_DWORD|\n|0x5000|TAG_TYPE_QWORD|\n|0x6000|TAG_TYPE_STRINGREF (string table attribute)|\n|0x7000|TAG_TYPE_LIST (list of items)|\n|0x8000|TAG_TYPE_STRING (unicode string ending with NULL)|\n|0x9000|TAG_TYPE_BINARY|\n\n\nTable 2-2 | SDB file tag types\n\n\n###### After the header (0xC sized), a 4-byte tag and matching data are listed. For example, in the\n\n case of the ‘0x7007’ tag in [Table 2-2], the data for list of items can be predicted to follow the\n\n first part, ‘0x7.’ The ‘0x7007’ tag is used to list information about ‘TAG-EXE.’\n\n [Fig 2-10] shows the structure of the SDB file used for the malware based on this information.\n\n\n-----\n\n###### The highlighted section in red is the 0xC sized header, where the version information takes\n\n the upper 0x8 bytes, and the succeeding data, ‘0x73646266,’ is for a string, ‘sdbf,’ which stands\n\n for SDB file. The subsequent tag, ‘0x7802,’ stands for TAG_INDEXS, which indicates that the\n\n index list data of the file will follow.\n\n The next section, ‘0x26,’ indicates that the ‘0x26’ sized data will be contained. This way, we\n\n can figure out that TAG_DATABASE and TAG_STRINGTABLE information will follow afterward,\n\n and that the SDB file is composed of four main sections: HEADER, INDEXS, DATABASE, and\n\n STRINGTABLE.\n\n TAG_DATABASE section provides information including shellcode and SDB file execution\n\n target process. [Fig 2-11] shows the data listed within the TAG_DATABASE section.\n\n\n-----\n\n###### There is a tag, ‘0x7005,’ in the database, which stands for TAG_PATCH. This means that patch\n\n data will follow this tag. In the HEX table, ‘0x2EE’ following the ‘0x7005’ tag indicates the size\n\n of the patch data that will follow. Information on shellcode is also included in this data. In\n\n the offset after ‘0x2EE,’ there is another tag, ‘0x7008,’ which stands for TAG_MACHING_FILE.\n\n This tag indicates that the following data includes information about the target process.\n\n Tag ‘0x6001’ represents the TAG_NAME, which is the names of these tags, thereby it can be\n\n assumed that the following ‘0x5E’ will be data related to the target process information.\n\n Tags are generally followed by the ‘data-size’ or ‘actual data.’ However, the values in the string\n\n table must be referenced to identify tags starting with ‘0x6,’ as shown by the SDB file tag\n\n types in [Table 2-2].\n\nFigure 2-12 | Data within the TAG_DATABASE section\n\n\n-----\n\n###### As was explained earlier in [Fig 2-11], we figured out that ‘0x5E’ indicated information about\n\n the target process name, and [Fig 2-12] indicates that the target process name, ‘service\n\n exe,’ will be located at a spot that is ‘0x5E’ away from the start of the string table. Now, we\n\n understand that a patch on the ‘services.exe’ process is made using this structure, and that\n\n the patched data will be the shellcode within the TAG-PATCH section.\n\n This way, SDB file data is identified and operated based on the tags. After figuring out the\n\n structure of such SDB files, ASEC made a generic detection available for the malicious SDB\n\n files to prevent infection before an SDB file operates in the ‘sdbinst.exe’ process.\n\n The AhnLab’s V3 product aliases related to the Ammyy hack tool and the malicious SDB files\n\n are as follows.\n\n <V3 Product Aliases>\n\n - FlawedAmmyy RAT: Backdoor/Win32.Flawedammyy\n\n - SDB file installation code: Trojan/Win32.Injector\n\n - Malicious SDB file: BinImage/Sdb.Gen, BinImage/Malsdb.S1, BimImage/Malsdb.S2\n\n - Backdoor code: Backdoor/Win32.Agent\n\n ASEC always keeps its eyes on the distribution processes for various malware, including Clop\n\n ransomware. ASEC endlessly analyzes newly found or rare malware to develop preventive\n\n measures and have it reflected on AhnLab products.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/Report/AhnLab/ASEC_REPORT_vol.96_ENG.pdf"
    ],
    "report_names": [
        "ASEC_REPORT_vol.96_ENG"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1570731665,
    "ts_modification_date": 1570731671,
    "files": {
        "pdf": "https://archive.orkl.eu/6b2579a0886d2a14bb3f4a86cb5f18782da63fe3.pdf",
        "text": "https://archive.orkl.eu/6b2579a0886d2a14bb3f4a86cb5f18782da63fe3.txt",
        "img": "https://archive.orkl.eu/6b2579a0886d2a14bb3f4a86cb5f18782da63fe3.jpg"
    }
}