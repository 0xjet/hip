{
    "id": "e57330ab-8f74-4b70-9d4a-7b1540669b68",
    "created_at": "2023-01-12T15:02:33.203766Z",
    "updated_at": "2025-03-27T02:05:20.712695Z",
    "deleted_at": null,
    "sha1_hash": "cc49dfdbd948cf85dc09b2c057b440342da76cc8",
    "title": "2022-01-30 - Point-of-Sale malware - RTPOS",
    "authors": "",
    "file_creation_date": "2022-05-28T03:10:38Z",
    "file_modification_date": "2022-05-28T03:10:38Z",
    "file_size": 156115,
    "plain_text": "# Point-of-Sale malware - RTPOS\n\n**reversing.fun/posts/2022/01/30/rtpos.html**\n\n.. January 30, 2022\n\nJan 30, 2022\n\nRTPOS is a ram scraper used to find credit card data within a process memory address\nspace. Credit card data is saved into a log file that needs to be manually grabbed by the\nmalware operators.\n\nSample:\n```\nFilename: alohae.exe\nSHA256: fb749c32b58fd1238f21d48ba1deb60e6fb4546f3a74e211f80a3ed005f9e046\n\n```\nIt supports two command-line options to either install itself as a service or remove the\nexisting installation:\n\nWhen executed with the install argument, RTPOS installs itself as a service named\n**WinLogon with the start type set to auto start:**\n\nService details:\n\n\n-----\n\nRTPOS creates a file mapping to store the credit card data before saving it to disk:\n\nRTPOS saves the logs with credit card data in a file named sql8514.dat inside the folder\nC:\\Windows\\System32 or C:\\Windows\\SysWOW64\\ if the malware runs in a 64-bit machine:\n\nThe malware enters in a loop where it will keep scanning the running processes for credit\ncard data:\n\n\n-----\n\nTo read the memory of the targeted processes, RTPOS uses the classic combinations of\nWindows APIS:\n\nCreateToolhelp32Snapshot\nProcess32FirstW/Process32NextW\nOpenProcess\nVirtualQueryEx\nReadProcessMemory\n\nIt will avoid scanning vmtoolsd.exe, System, windbg.exe, and ntsd.exe processes:\n\nThe credit card tracks are validated with the Luhn algorithm:\n\n\n-----\n\nExample of the content of sql8514.dat:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-30 - Point-of-Sale malware - RTPOS.pdf"
    ],
    "report_names": [
        "2022-01-30 - Point-of-Sale malware - RTPOS.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535753,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1653707438,
    "ts_modification_date": 1653707438,
    "files": {
        "pdf": "https://archive.orkl.eu/cc49dfdbd948cf85dc09b2c057b440342da76cc8.pdf",
        "text": "https://archive.orkl.eu/cc49dfdbd948cf85dc09b2c057b440342da76cc8.txt",
        "img": "https://archive.orkl.eu/cc49dfdbd948cf85dc09b2c057b440342da76cc8.jpg"
    }
}