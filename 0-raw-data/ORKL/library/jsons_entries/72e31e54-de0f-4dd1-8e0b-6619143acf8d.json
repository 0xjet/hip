{
    "id": "72e31e54-de0f-4dd1-8e0b-6619143acf8d",
    "created_at": "2023-01-12T15:01:01.078504Z",
    "updated_at": "2025-03-27T02:09:08.00458Z",
    "deleted_at": null,
    "sha1_hash": "34630d282ecd14f8396cfeb394c7ec2742f99df2",
    "title": "2021-12-09 - The Evolution of IoT Linux Malware Based on MITRE ATT&CK TTPs",
    "authors": "",
    "file_creation_date": "2022-05-27T22:36:43Z",
    "file_modification_date": "2022-05-27T22:36:43Z",
    "file_size": 316795,
    "plain_text": "# The Evolution of IoT Linux Malware Based on MITRE ATT&CK TTPs\n\n**[trendmicro.com/en_us/research/21/l/the-evolution-of-iot-linux-malware-based-on-mitre-att&ck-ttps.html](https://www.trendmicro.com/en_us/research/21/l/the-evolution-of-iot-linux-malware-based-on-mitre-att&ck-ttps.html)**\n\nDecember 9, 2021\n\n[In this blog entry, we share the findings of an investigation on the internet of things (IoT)](https://www.trendmicro.com/vinfo/us/security/definition/internet-of-things)\nLinux malware and analyzed how these malware families have been evolving. We relied on\nthe tactics, techniques, and procedures (TTPs) of MITRE ATT&CKto define the malware\ncapabilities and characteristics that we saw.\n\nOur study showed that IoT Linux malware has been steadily evolving, particularly those that\nare used to create [IoT botnets. Capabilities were both added and removed over time.](https://www.trendmicro.com/vinfo/us/security/definition/iot-botnet)\nNotably, neither data exfiltration nor lateral movement has been successful for the authors,\nand they have pivoted instead to centralized infection.\n\nTable 1 shows the 10 most implemented capabilities (or techniques) in our malware data set.\n\n**ATT&CK Tactic** **Technique (TTP)** **Number of**\n**malware families**\n\nDiscovery File and Directory Discovery (T1083) 10\n\n\nCommand and\nControl\n\n\nApplication Layer Protocol: Web Protocols\n(T1071.001)\n\n\n9\n\n\nInitial Access External Remote Services (T1133) 8\n\n\n-----\n\nExecution Command and Scripting Interpreter: Unix\nShell (T1059.004)\n\nImpact Network Denial of Service: Direct Network\nFlood (T1498.001)\n\n\n7\n\n\nCredential\nAccess\n\n\nBrute Force: Password Guessing (T1110.001) 6\n\n\nDiscovery Process Discovery (T1057)\n\nExecution Native API (T1106) 5\n\nImpact Data Encrypted for Impact (T1486)\n\n\nDefense\nEvasion\n\nLateral\nMovement\n\n\nIndicator Removal on Host: File Deletion\n(T1070.004)\n\nExploitation of Remote Services (T1210)\n\n\n4\n\n\nPersistence Scheduled Task/Job: Cron (T1053.003)\n\nTable 1. The top 10 most implemented techniques\n\n**Methodology**\n\nThe results presented in this entry are the outcome of a methodology that takes advantage\nof the power of the [MITRE ATT&CK framework to characterize the capabilities of IoT Linux](https://attack.mitre.org/)\nmalware. The ATT&CK framework allowed us to describe threats in a structured way and to\nhave an implementation-independent representation that let us compare malware\ncapabilities. The capabilities were extracted by using both static and dynamic analysis, after\nwhich we mapped them into the ATT&CK Techniques, Tactics, and Procedures (TTPs).\n\nThe methodology is comprised of four steps:\n\n1. Malware collection. We selected malware discovered between January 2019 and\n\nAugust 2021.\n2. Malware analysis. We employed both static (Ghidra, IDA Pro) and dynamic analysis\n\n(strace, ltrace, GDB) to discover malware capabilities. We looked for all aspects of\neach malware sample including the pre and post exploitation steps, such as initial\naccess vector, lateral movement, and impact.\n3. Mapping. We mapped the malware capabilities to MITRE ATT&CK TTPs.\n4. Analysis. We analyzed the mapped TTPs to retrieve changes and similarities in our\n\nmalware set.\n\nFigure 1 illustrates the steps used in this methodology.\n\n\n-----\n\nFigure 1. Analysis methodology based on MITRE ATT&CK TTPs.\nNew IoT botnet techniques\n\nDuring the observation period, we noted four new techniques added to threat actors’\narsenals. One is a newly implemented technique in botnet families called Masquerading:\n_Match Legitimate Name or Location (T1036.005). It is_ a Defense Evasion technique that\nlikely reflect the manufacturers’ increasing interest and efforts in securing these IoT devices\nor appliances. The technique involves adversaries trying to match the name and location of\nlegitimate and trusted programs to hide malicious executables and evade detection.\n\nAnother new technique that diverges from the more common technique being used in IoT\nLinux malware (Indicator Removal on Host: File Deletion (T1070.004) is File and Directory\n_Permissions Modification: Linux and Mac File and Directory Permissions Modification_\n_(T1222.002) introduced in a malware discovered in mid-2020. We observed these additions_\n[especially in the Dark Nexus malware. Most of the platforms provide two primary commands](https://thehackernews.com/2020/04/darknexus-iot-ddos-botnet.html)\nused to manipulate file and directory ACLs: chown (change owner) and chmod (change\nmode).\n\n[Furthermore, among the 2021 discovered families, is a variant of StealthWorker GO, a](https://blog.malwarebytes.com/botnets/2021/08/check-your-passwords-synology-nas-devices-under-attack-from-stealthworker/)\nmalware written in the Golang language, where we observed the addition of the Scheduled\n_Task/Job: Cron (T1053.003) technique. This is an execution tactic which also allows malware_\nto achieve persistence in the system. This software utility maintains persistence in the\nsystem by enabling an attacker to achieve time-based command execution.\n\nDropped techniques\n\nOn the other hand, we found three techniques relating to the lateral movement tactic to have\nbeen dropped. We observed a trend in recently discovered families that gives the\nresponsibility for propagation back to the C&C server. In the Dark Nexus family, for example,\n\n\n-----\n\nwe found that it is the C&C server that takes steps to propagate the malware. Our analysis\nhighlighted the drop of two techniques linked to the Lateral Movement tactic, which are\n_Remote Services (T1021) and Exploitation of Remote Services (T1210). In relation to this,_\nthe technique for the discovery of network information, System Network Configuration\n_Discovery (T1016), is also no longer enforced._\n\nUncommon techniques\n\nAdditionally, we noticed that IoT Linux malware authors are not interested in stealing data. In\n[our data set, there is only one malware (QSnatch) that implements typical tactics for data](https://www.zdnet.com/article/cisa-says-62000-qnap-nas-devices-have-been-infected-with-the-qsnatch-malware/)\nleakages, such as collection and exfiltration. Moreover, we also found that privilege\nescalation is not among the interests of IoT malware authors. It is likely because, from a\nmalware author’s standpoint, the benefits of executing malware that require higher privileges\nare not worth the effort of implementation. Furthermore, the default accounts on targeted\ndevices usually already come with all the privileges needed to run programs, write to the\nfilesystem, and establish new connections.\n\nDifferences between ransomware and botnet malware\n\nThe characterization through the ATT&CK matrix also allowed us to compare different\nmalware classes that target IoT devices which in our data set are ransomware and botnet\nfamilies.\n\nThe findings highlight some common techniques, such as the Credential Access\nmethodology where Brute Force: Password Guessing (T1110.001) is the most common\ntechnique that both malware classes fall under. This finding is not a surprise since it is\ncommon to find default usernames and passwords still being used in these kinds of devices.\nUsually, users are not aware of the risks of exposing IoT devices to the internet. Indeed,\nmany devices are still installed without changing the default credentials or securing remote\naccess.\n\nAnother common capability for both classes is External Remote Services (T1133) from the\nInitial Access Tactic, which confirms unsecured and exposed internet services, such as\nTelnet and SSH. This technique allows attackers to exploit external-facing remote services to\ninitially access and/or persist within a network; they also often use exposed services that do\nnot require authentication.\n\nAnother similarity is in the two classes’ Command and Control implementation, as both\nimplement Application Layer Protocol: Web protocol (T1071.001). This is likely because the\nmarket for malware-as-a-service is growing. Thus, having a simple UI that the “customers” or\nother threat actors can use to control the malware is an important aspect.\n\nBy comparing the number of unique TTPs implemented, we studied the implementation\nvariations among different malware families and noticed that while different ransomware\nfamilies share many common techniques botnets tend to innovate more and implement a\n\n\n-----\n\nvariety of different TTPs to exploit many services. This may be because detection of botnet\nmalware is more mature, so they require more frequent changes to avoid being easily\ndetected. These differences are illustrated in Figure 2.\n\nFigure 2. Differences in number of implemented unique TTPs.\nConclusion\n\nAs the number of connected devices grow, linked threats also increase. Knowing the\nevolution of malware that targets IoT devices is fundamental to implementing effective\ncountermeasures and defenses.\n\nWe saw how IoT malware has been slowly developing over the years. Botnet threats, in\nparticular, is an active field where capabilities are being added and removed, reflecting not\nonly the behavior of threat actors but also the defenses being implemented in these devices.\nThe MITRE ATT&CK framework helps create a standardized way of listing down techniques\nand characterizing threats found today. It is easy to see how the awareness of common\nTTPs can help organizations and users better protect their devices and networks. For\nexample, our findings further stress the importance of changing default passwords in all\nconnected devices.\n\nOrganizations and users can also consider these steps to secure their devices:\n\nManage vulnerabilities and apply patches as soon as possible. Applying patches as\nsoon as they are released can reduce the chances for potential exploits.\nUse secure configurations. A secure device configuration narrows openings for\ncompromise or remote attacks.\n\n\n-----\n\nUse strong, hard-to-guess passwords. Aside from changing default passwords, users\ncan circumvent brute force techniques by using strong passwords and enabling twofactor authentication if it is an option.\n\nIoT\n\nIn our study, we relied on the tactics, techniques, and procedures of MITRE ATT&CK to\ndefine the malware capabilities and characteristics of IoT Linux malware. We describe our\nfindings and how IoT malware has been evolving.\n\nBy: Veronica Chierzi December 09, 2021 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-09 - The Evolution of IoT Linux Malware Based on MITRE ATT&CK TTPs.pdf"
    ],
    "report_names": [
        "2021-12-09 - The Evolution of IoT Linux Malware Based on MITRE ATT&CK TTPs.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535661,
    "ts_updated_at": 1743041348,
    "ts_creation_date": 1653691003,
    "ts_modification_date": 1653691003,
    "files": {
        "pdf": "https://archive.orkl.eu/34630d282ecd14f8396cfeb394c7ec2742f99df2.pdf",
        "text": "https://archive.orkl.eu/34630d282ecd14f8396cfeb394c7ec2742f99df2.txt",
        "img": "https://archive.orkl.eu/34630d282ecd14f8396cfeb394c7ec2742f99df2.jpg"
    }
}