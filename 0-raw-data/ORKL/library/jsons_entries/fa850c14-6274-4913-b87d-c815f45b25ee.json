{
    "id": "fa850c14-6274-4913-b87d-c815f45b25ee",
    "created_at": "2023-01-12T15:08:01.644345Z",
    "updated_at": "2025-03-27T02:16:26.043929Z",
    "deleted_at": null,
    "sha1_hash": "52b52ce06756b549b8827e5d2614ecd0529c17d7",
    "title": "2018-10-29 - GPlayed's younger brother is a banker — and it's after Russian banks",
    "authors": "",
    "file_creation_date": "2022-05-29T01:10:33Z",
    "file_modification_date": "2022-05-29T01:10:33Z",
    "file_size": 1113891,
    "plain_text": "# GPlayed's younger brother is a banker — and it's after Russian banks\n\n**blog.talosintelligence.com/2018/10/gplayerbanker.html**\n\n[This blog post is authored by Vitor Ventura.](https://twitter.com/_vventura)\n\n## Introduction\n\n[Cisco Talos published its findings on a new Android trojan known as \"GPlayed\" on Oct. 11. At](https://blog.talosintelligence.com/2018/10/gplayedtrojan.html)\nthe time, we wrote that the trojan seemed to be in the testing stages of development, based\non the malware's code patterns, strings and telemetry visibility. Since then, we discovered\nthat there's already a predecessor to GPlayed, which we are calling \"GPlayed Banking.\"\nUnlike the first version of GPlayed, this is not an all-encompassing banking trojan. It is\nspecifically a banking trojan that's looking to target Sberbank AutoPay users, a service\noffered by the Russian state-owned bank.\n\nGPlayed Banking is spread in a similar way to the original GPlayed. It's disguised as a fake\nGoogle app store, but actually installs the malware once it's launched. This further illustrates\nthe point that Android users need to be educated on how to spot a malicious app, and that\nthey should be careful as to what privileges they assign to certain programs.\n\n\n-----\n\nThe malicious application is on the left-hand side.\n\n## Trojan architecture and capabilities\n\nThis malware is written in .NET using the GPlayed environment for mobile applications. The\nmalware code is implemented in a DLL called \"PlayMarket.dll.\"\nGPlayed Banking issues its package certificate under a fake name that's not related to the\napplication's name, nor the package's name.\n\n\n-----\n\nCertificate information\n\nThe Android package is named \"lola.catgirl.\" The application uses the label \"Play Google\nMarket,\" with an icon designed to look like the legitimate Google app store, and its name is\n\"android.app.Application.\"\n\nPackage permissions\n\n\n-----\n\nThe trojan declares numerous permissions in the manifest, from which we wish to highlight\nthe BIND_DEVICE_ADMIN, which provides nearly full control of the device to the trojan.\nThe working capabilities of this trojan are limited to the ones needed to perform its objective\nas a banking trojan. The only exception is that it also contains the ability to exfiltrate all of the\nuser's received SMS messages to the command and control (C2).\n\n## Trojan details\n\nOnce executed, the trojan will start to obtain administrator privileges on the device by\nrequesting that the user change its settings.\n\nPrivilege escalation requests\n\n\n-----\n\nIf the user cancels the device's administration request, the request dialog will appear again\nafter five seconds repeatedly until the user finally gives it administrator privileges. The\nmalware contains code that could lock the device's screen, but it's never called. The same\nhappens with another feature that needs the device's administrator privilege.\n\nUnused code\n\nNotably, in order to perform its activities as a banking trojan, none of these privileges are\nneeded.\n\nIn the next step in its initialization process, the trojan will create a timer with a random value\nthat will range between 900 and 1,800 seconds. When triggered, this timer will start a\nWebView that is loaded from the URL hxxp://sub1[.]tdsworker[.]ru:6565/index_main.html.\nThis WebView will inject an amount of 500, which given the victim's profile, it is safe to\nassume that there will be rubbles.\n\n\n-----\n\nThe overlay will completely cover the screen which, depending on the device, can make the\nmobile device unusable until reboot or the WebView is closed. The WebView code couldn't\nbe determined because the C2 was never online during the investigation.\n\nWebView blocking device\n\nThis WebView overlay technique is the same used by the GPlayed trojan, from the same\nfamily. However, GPlayed trojan loaded the WebView from local resources contained in the\napplication package. In that case, the webview would request the user's credit card\ninformation to pay for supposed \"Google Services.\" Given the similarities, it is safe to\nassume that this WebView would have same sort of objective. This change from having the\nWebView code hosted in the C2 or having it as a resource on the package shows that the\nauthors want to remain independent from the C2.\n\nAfter the malware creates the WebView, it sends an SMS to the Sberbank AutoPay\n(+79262000900) service with the word \"баланс,\" which means \"balance\" in Russian. Upon\nreceiving an answer, the trojan will parse it to determine the account balance. If it is lower\nthan 3,000, the trojan won't do anything. If it is larger than 68,000 the trojan requests a value\nof 66,000, otherwise it will request the available amount minus 1,000.\n\n\n-----\n\nBalance checking and amount decision\n\nFinally, with the available amount determined, the trojan will create a new WebView object\nand request the amount defined according to the rules previously shown.\n\nPassword extraction code\n\nIn order to complete financial transactions, a validation code is necessary. So, the following\naction is the registration of an SMS handler that will parse any arriving SMS messages and\nlook for the word \"пароль,\" which means \"password\" in Russian. The malware parses the\nSMS containing that word to extract the password, which will then be injected into the\npreviously created WebView. We believe this malware is specifically designed to evade the\n[3-D Secure anti-fraud mechanism because it injects a variable called \"s3dscode\" with the](https://en.wikipedia.org/wiki/3-D_Secure)\nextracted value to the WebView object. The password is actually the validation code needed\nto validate the transaction.\nThe SMS receiver handler, beside parsing the 3-D secure validation code, will also send all\nSMSs to the C2.\n\n\n-----\n\nSMS exfiltration code\n\nThe SMSs are exfiltrated using a simple GET request to the REST-based URL\nhxxp://sub1[.]tdsworker[.]ru:5555/sms/\", the format for this request is as follows:\n\n<URL><device id>/<sender address>/<message content>\n\n## Trojan activity\n\nThis trojan hasn't been observed in the wild yet, and it's not being detected by many antivirus\nprograms at the time of this writing. However, the samples were submitted for detection\nanalysis in nearly the same week as when Talos discovered the malware. Just like in the\nGPlayed trojan case, the ratio detection verification method was the same. First, the package\nwas submitted followed by the DLL that holds the code. In the case of the DLL, GPlayed and\nthis sample share one of the submission sources, further strengthening the link between the\ntwo. Given the architecture, organization and maturity of the code, the most likely relation is\nthat this banking trojan was created based on an early version of the GPlayed trojan code\nbase, by the same author(s) given that they also share a C2.\n\nCode comparison (above banking trojan, below, the original GPlayed trojan)\n\nJust like GPlayed, the C2 was never online during our research, but it would be easy to\nadapt this trojan to a new C2. Therefore, we don't know what was displayed in the WebView\n\n\n-----\n\nstep mentioned previously. The icon file used by both malware families is the same, which\ncan be considered another link between the packages.\n\n## Conclusion\n\nThis trojan was designed with a very specific group of victims in mind, namely Sberbank\ncustomers who use the AutoPay service. However, adapting it to fit other banks would be a\ntrivial activity for the developers of the GPlayed malware family.\n\nThis malware family is just another example of why mobile users need to be critical about the\npermissions they accept to certain apps. There's no specific exploit that GPlayed family uses\nto infect its victims — it can be installed on a device just through a simple spam campaign.\nAndroid users need to be aware of two important points: By installing applications from\nuntrusted application stores, they are putting themselves and their data in jeopardy. Also,\ngiving the wrong permissions can make a difference between a malware and a legitimate\napp. Users cannot trust permissions justifications, as they are provided by the developer,\nthey must be critic about the permissions and assign them on a case by case.\n\nThe interception of SMS validation codes technique is not new for banking trojans. But this\nbanking trojan followed by the GPlayed trojan shows a clear evolution of the actors behind\nthis malware families. They went from a simple banking trojan to a full-fledged trojan with\ncapabilities never seen before.\n\nThe DLLs used in the malware, which hold the majority of the code, have a low detection\nratio and show that anti-virus solutions are not looking at the code in a file and are more so\nfocused on Android packages' permissions and resources. While we have not yet seen these\nfiles in the wild, they certainly have the potential to infect a large number of users and could\nquickly hijack a user's banking credentials.\n\n## Coverage\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware used by these threat actors.\n\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity](https://meraki.cisco.com/products/appliances)\n[associated with this threat. AMP Threat Grid helps identify malicious binaries and build](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\n[protection into all Cisco Security products. Umbrella, our secure internet gateway (SIG),](https://umbrella.cisco.com/)\nblocks users from connecting to malicious domains, IPs, and URLs, whether users are on or\noff the corporate network. Open Source SNORTⓇ Subscriber Rule Set customers can stay\n[up to date by downloading the latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## Indicators of compromise (IOC)\n\nURLs\n\nhxxp://sub1[.]tdsworker[.]ru:5555/sms/\n\nhxxp://sub1[.]tdsworker[.]ru:6565/index_main.html\n\nHashes\n\nPackage.apk - 81d4f6796509a998122817aaa34e1c8c6de738e1fff5146009c07be8493f162c\n\nPlayMarket.dll 3c82d98f63e5894f53a5d2aa06713e9212269f5f55dcb30d78139ae9da21e212\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-10-29 - GPlayed's younger brother is a banker — and it's after Russian banks.pdf"
    ],
    "report_names": [
        "2018-10-29 - GPlayed's younger brother is a banker — and it's after Russian banks.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536081,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653786633,
    "ts_modification_date": 1653786633,
    "files": {
        "pdf": "https://archive.orkl.eu/52b52ce06756b549b8827e5d2614ecd0529c17d7.pdf",
        "text": "https://archive.orkl.eu/52b52ce06756b549b8827e5d2614ecd0529c17d7.txt",
        "img": "https://archive.orkl.eu/52b52ce06756b549b8827e5d2614ecd0529c17d7.jpg"
    }
}