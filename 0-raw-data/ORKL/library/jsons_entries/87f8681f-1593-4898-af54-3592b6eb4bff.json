{
    "id": "87f8681f-1593-4898-af54-3592b6eb4bff",
    "created_at": "2023-01-12T15:10:20.797478Z",
    "updated_at": "2025-03-27T02:16:25.836276Z",
    "deleted_at": null,
    "sha1_hash": "12613209cd4b2e44815241721e0b77b3efccbdf3",
    "title": "2020-06-05 - New Tekya Ad Fraud Found on Google Play",
    "authors": "",
    "file_creation_date": "2022-05-28T17:47:48Z",
    "file_modification_date": "2022-05-28T17:47:48Z",
    "file_size": 105659,
    "plain_text": "# New Tekya Ad Fraud Found on Google Play\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/new-tekya-ad-fraud-found-on-google-play/](https://blog.trendmicro.com/trendlabs-security-intelligence/new-tekya-ad-fraud-found-on-google-play/)**\n\nJune 5, 2020\n\nIn late March, researchers from [CheckPoint found the Tekya malware family, which was being used to carry](https://research.checkpoint.com/2020/google-play-store-played-again-tekya-clicker-hides-in-24-childrens-games-and-32-utility-apps/)\nout ad fraud, on Google Play. These apps have since been removed from the store, but we recently found a\nvariant of this family that had made its way onto Google Play via five malicious apps, although these have\nalso been removed. (We detect these as AndroidOS_Tekya.HRX.)\n\n_Figures 1 and 2. Apps with Tekya malware (Click to enlarge)_\n\n**Connections between two versions**\n\nThis variant of Tekya shares many similarities with the previously found version. For example, the encryption\nremains essentially identical. The same algorithms and keys are used in both versions.\n\n_Figure 3. Encryption code from previous Tekya version_\n\n_Figure 4. Encryption code from this Tekya version_\n\n**How this Tekya variant works**\n\nThe malware registered a receiver that responds to the actions “com.tenjin.RECEIVE” or\n“android.intent.action.BOOT_COMPLETED”. The latter action gives the malware the ability to wake after the\ndevice boots:\n\n_Figure 5. Registered receiver_\n\n\n-----\n\nThe functionality of the receiver is implemented in libtenjin.so. Once called, it would then call a method which\nhides itself in a common package — specifically, com/google/android/gms/internal/ads/.\n\n_Figure 6. Malicious method call_\n\nThe method called is responsible for downloading a .dex file and loading it. In the case we were analyzing, the\nsaid file would be downloaded twelve hours after the malware was installed. The downloaded file is encrypted;\nit is decrypted and loaded by libtenjin.so.\n\n_Figure 7. Decryption and loading of decrypted file_\n\nOnce the downloaded .dex file been loaded, it would attempt to register itself with a configuration server. The\ninformation that is part of the registration includes device ID, user accounts, location, MAC address, and\nothers (as seen below):\n\n_Figure 8. Properties uploaded to the configuration server_\n\nIf the server did not reject the registration, an encrypted configuration file would be downloaded. This contains\ninformation about the ads to be loaded and control flags. (The blurred text contains information about about\nthe ad accounts potentially used by the attacker, which we have opted to remove.)\n\n_Figure 9. Contents of downloaded configuration file_\n\nThe malware would do various checks, including time, control flags, and so on based on the downloaded\nconfiguration. If those checks passed, Tekya would hide itself.\n\n_Figure 10. Code to hide icon_\n\nAccording to its code, Tekya would target up to 11 advertising networks, including: Admob, Facebook, and\nUnity. Advertisements from these networks would be displayed, and user touch events imitated through\nInputManager.\n\n_Figure 11. Code to load Admob_\n\n_Figure 12. Code to inject input event_\n\nTekya would try to trick victims into believing those advertisements were opened by other applications by\nchanging its icon and label to that of another app on the device.\n\n_Figure 13. Code for Tekya to choose which icon and label to imitate_\n\nWe originally found several of these apps on Google Play, but Google removed these from the App Store\nwhile our research was underway. We are still watching for any similar threats that may emerge in the wild.\n\n**Trend Micro solutions**\n\n\n-----\n\nUsers can install security solutions, such as Trend Micro [Mobile Security, that can block malicious apps.](https://blog.trendmicro.com/en_us/forHome/products/mobile-security.html)\nEnd users can also benefit from their multilayered security capabilities that secure the device owner’s data\nand privacy, and features that protect them from ransomware, fraudulent websites, spyware, and identity theft.\n\n[For organizations, the Trend Micro™ Mobile Security for Enterprise suite provides device, compliance and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\napplication management, data protection, and configuration provisioning. The suite also protects devices from\nattacks that exploit vulnerabilities, prevents unauthorized access to apps, and detects and blocks\nmalware. [Trend Micro’s Mobile App Reputation Service (MARS) covers Android and iOS threats using leading](https://mars.trendmicro.com/)\n[sandbox and machine learning technologies to protect users against malware, zero-day and known exploits,](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/machine-learning)\nprivacy leaks, and application vulnerability.\n\n**Indicators of Compromise (IOCs)**\n\nAll of the malicious files below are detected as AndroidOS_Tekya.HRX.\n\nPackage name SHA256 hash\n\nawakens.download.mp3pro 35f9077b4774456526b088496413bd5559c293b7ae49da89c5b7b51132667879\n\ncom.waygame.hoppingcat 359f581980faa4e27acf19a9bfae0214d6e92690bcbce0d19e9b0053200f6cd2\n\ncom.halfbrain.trafficjam 114b8f6a345ee403487e79d4110fcd28e5a9b67ebe5821cd2f7a296d06ae1de2\n\ncom.halfbrain.petjumping c4e00591e0eb947fded1ea925c3aa4e5e2f47a8adbfc096f174a84a2205bbf5a\n\ncom.runninggame.squarefish 0d58e04908a506adf06ec49e55227892d1abbe4ad245a822ff0dab15c774f2f4\n\nMobile\n\nWe observed a Tekya variant that had made its way onto Google Play via five malicious apps. Said apps were\nalready removed from the Play Store.\n\nBy: Ford Quin June 05, 2020 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-05 - New Tekya Ad Fraud Found on Google Play.pdf"
    ],
    "report_names": [
        "2020-06-05 - New Tekya Ad Fraud Found on Google Play.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536220,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653760068,
    "ts_modification_date": 1653760068,
    "files": {
        "pdf": "https://archive.orkl.eu/12613209cd4b2e44815241721e0b77b3efccbdf3.pdf",
        "text": "https://archive.orkl.eu/12613209cd4b2e44815241721e0b77b3efccbdf3.txt",
        "img": "https://archive.orkl.eu/12613209cd4b2e44815241721e0b77b3efccbdf3.jpg"
    }
}