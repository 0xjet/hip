{
    "id": "dbfb9d2b-99a3-4211-8527-5537c1c2d39b",
    "created_at": "2023-01-12T15:04:54.918095Z",
    "updated_at": "2025-03-27T02:05:39.091753Z",
    "deleted_at": null,
    "sha1_hash": "cde40d31004ee0d5ba83a54433a099f2ad3086f4",
    "title": "2020-06-18 - Office 365 Phishing Campaign Exploits Samsung, Adobe and Oxford Servers",
    "authors": "",
    "file_creation_date": "2022-05-28T18:09:14Z",
    "file_modification_date": "2022-05-28T18:09:14Z",
    "file_size": 1913152,
    "plain_text": "# Office 365 Phishing Campaign Exploits Samsung, Adobe and Oxford Servers\n\n**[research.checkpoint.com/2020/phishing-campaign-exploits-samsung-adobe-and-oxford-servers/](https://research.checkpoint.com/2020/phishing-campaign-exploits-samsung-adobe-and-oxford-servers/)**\n\nJune 18, 2020\n\nJune 18, 2020\n\n## Introduction\n\nOver the last few years, the adoption of Office 365 in the corporate sector has significantly increased. Its popularity\nhas attracted the attention of cybercriminals who launch phishing campaigns specifically to attack the platform. As\n[90% of cyber-attacks start with a phishing campaign, Office 365 is an attractive target for threat actors who work to](https://blog.checkpoint.com/2020/03/30/covid-19-impact-cyber-criminals-target-zoom-domains/)\nevade the continuously introduced security solutions.\n\nRecently, a seemingly unsophisticated Office 365 phishing campaign caught our attention. The attackers abused an\n[Adobe Campaign redirection mechanism, using a Samsung domain to redirect victims to an O365 themed phishing](https://www.adobe.com/il_en/marketing/campaign/email-marketing.html)\nwebsite. The hackers took advantage of the fact that access to a reputable domain, such as Samsung’s, would not be\nblocked by security software.\n\nTo expand their campaign, the attackers also compromised several websites to inject a script that imitates the same\nmechanism offered by the Adobe redirection service. Further investigation revealed that the actors behind the\ncampaign implemented a few other interesting tricks to hide the phishing kit and avoid detection at each stage of the\nattack. This report will describe what we discovered about this Office 365 phishing campaign which used trusted\nservices to allow a new attack.\n\n## Before we start\n\n\n-----\n\nNeither Adobe nor Samsung were compromised in the sense of exploiting a vulnerability. Samsung s Adobe\nCampaign server was left available for managing campaigns that were not necessarily part of the company’s\nmarketing efforts.\n\nA redirection mechanism redirects users to a destination specified in the URL they just clicked. This allows campaign\nmanagers, for example, to gauge and monitor ongoing advertisement efforts by logging every successful visit before\nredirecting the user to an ad page.\n\n## Attack Flow\n\nIn early April of 2020, we detected a phishing campaign that delivered “missed voice message” emails to its victims.\nRoughly 43% of these attacks targeted European companies while the rest were seen in Asia and the Middle East.\nThe emails prompted users to click on a button that would allegedly take them to their Office 365 account. These\nemails use some very basic customization, such as a subject line with the target domain name and the username\nincluded in the body of the email. Despite the “Message from Trusted server” notification at the top, a vigilant user\nwould have noticed some inaccuracies. Here is an example of one of the phishing emails:\n\n_Office 365 Voice-Mail phishing email._\n\nAfter the victims clicked the button, they were redirected to a phishing page masquerading as the Office 365 login\npage. Behind the scenes, this redirection consists of two stages: the first stage abused an existing redirection\nscheme on the legitimate domain (e.g. `samsung[.]ca ), and the second stage redirected the user to a compromised`\nWordPress site.\n\n\n-----\n\n_Phishing attack scheme._\n\nMost of the emails came from multiple generated addresses belonging to legitimate subdomains from different\ndepartments in the University of Oxford (UK).\n\n**_[[email protected]x.ac.uk](https://research.checkpoint.com/cdn-cgi/l/email-protection)_**\n\nExample of an auto-generated email address used in this campaign.\n\nThe email headers showed that the attackers found a way to abuse one of Oxford’s SMTP servers. The email\noriginated from the NordVPN IP address `194.35.233.10 and then passed to the Oxford SMTP server and the`\nOxford Relay server as displayed below:\n```\nAuthentication-Results: spf=pass (sender IP is 129.67.1.166)\n smtp.mailfrom=paediatrics.ox.ac.uk; xxx; dkim=none (message not\n signed) header.d=none; xxx; dmarc=bestguesspass action=none\n header.from=paediatrics.ox.ac.uk;compauth=pass reason=109\nReceived-SPF: Pass (protection.outlook.com: domain of paediatrics.ox.ac.uk\n designates 129.67.1.166 as permitted sender) receiver=protection.outlook.com;\n client-ip=129.67.1.166; helo=relay13.mail.ox.ac.uk;\nReceived: from relay13.mail.ox.ac.uk (129.67.1.166) by\n MR2FRA01FT016.mail.protection.outlook.com (10.152.50.130) \nReceived: from smtp5.mail.ox.ac.uk ([163.1.2.207])\n     by relay13.mail.ox.ac.uk with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)\n     (Exim 4.89)\n     (envelope-from <[email protected]x.ac.uk>)\nReceived: from [194.35.233.10] (helo=[127.0.0.1])\n     by smtp5.mail.ox.ac.uk with esmtpsa (TLS1.2:ECDHE_RSA_AES_128_GCM_SHA256:128)\n     (Exim 4.89)\n     (envelope-from <[email protected]x.ac.uk>)\nFrom: \"XXX VOIP\"\n <[email protected]x.ac.uk>\n\n```\nUsing legitimate Oxford SMTP servers allowed the attackers to pass the reputation check for the sender domain. In\naddition, there was no need to compromise actual email accounts to send phishing emails because they could\ngenerate as many email addresses as they wanted.\n\n## First Stage: Abusing Samsung’s Email Redirect\n\n[The technique of using Adobe Campaign open redirect was initially discovered in September 2019 on the domain](https://www.notion.so/Adobe-campaign-568c2e278a244865a718db30b9d71b85#bb5147421b9a46f086d0d8ad53520fa3)\nbelonging to Adobe itself. In the last few months, it’s been widely abused for phishing purposes. To evade detection,\nattackers abuse open and reputable Adobe Campaign servers to redirect potential victims to their own phishing\nwebsites. This means that the link embedded in the phishing email is part of a trusted domain – one that\nunknowingly redirects victims to the phishing website.\n\nIn this case, the Adobe Campaign server belongs to Samsung Canada.\n\n**_https://t.email1.samsung[.]ca/r/?_**\n_id=ff1b346f,303d531,303d53e&p1=8107023398&p2=8107023398&p3=DM15290&p4=https://compromised.site#_\n\n**_[[email protected]](https://research.checkpoint.com/cdn-cgi/l/email-protection)_**\n\nHow does this work?\n```\nt.email1.samsung[.]ca is a subdomain for Samsung-Canada email campaigns, which hosts an Adobe Campaign\n\n```\nserver. The specially crafted URL contains a parameter called `p4 which provides the server with a different redirect`\ndestination for each victim.\n\n\n-----\n\nIn our case, the attackers took the existing link from an old, but legitimate Samsung Cyber Monday themed email\ncampaign dating back to 2018. By changing the `p4 parameter, they repurposed it to redirect the victim to a domain`\nthey controlled instead of `https://samsung.com/ca/ :`\n\n**_https://t.email1.samsung.ca/r/?_**\n_id=hf1b346f,303d531,303d53e&p1=8107023398&p2=8107023398&p3=DM15290&p4=https://www.samsung.com/ca/?_\n**_mkm_rid=8107023398&mkm_mid=DM15290&cid=ca_email_newsletter_holidaycybermonday_20181126_fr-x-_**\n**_x-viewproducts-x-x_**\n\n[By using the specific Adobe Campaign link format and the legitimate domain, the attackers increased the chances for](https://helpx.adobe.com/campaign/kb/tracking-personnalized-links.html)\nthe email to bypass email security solutions based on reputation, blacklists and URL patterns.\n\nHowever, this is not the first time an Adobe Campaign on Samsung infrastructure was used as a relay for phishing.\nAccording to [urlscan, the](https://urlscan.io/search/#t.info.samsungusa.com) `t.info.samsungusa[.]com domain has been used for phishing-related redirects since`\nFebruary 2020.\n\n## Second stage: Redirect the User to a compromised WordPress site\n\nThe second layer of redirection is used to distance the final phishing page from the original email.\n\nIn this case, the attackers used several compromised WordPress sites which contain malicious redirect code.\n\nIntroducing another redirection layer enables the attackers to circumvent security solutions that investigate the links\nwithin the email. Thus the URL within the email points to a WordPress site instead of a suspicious-looking phishing\npage.\n\nThe redirect code, which is added to the compromised site’s homepage HTML code, also checks if the requested\nURL contains a `# sign followed by an email address. If this condition is met, it redirects the victim to the final`\nphishing kit.\n\n_Redirection code on compromised WordPress sites._\n\nAs a result, only users that have an email address in the link will be redirected, while users that enter the WordPress\nsite directly do not notice any changes. This trick can prevent the site owners from detecting the abuse of their pages.\n\n## More redirects\n\nA few days after the campaign launched, the attackers changed the URL inside the emails to the following one:\n\n**_https://t-email1.ottawashowers[.]ca/r/?_**\n_id=ff1b346f,303d531,303d53e&p1=8107023398&p2=8107023398&p3=DM15290&p4=https://compromised.site&_\n\n**_[[email protected]](https://research.checkpoint.com/cdn-cgi/l/email-protection)_**\n\nThis time, the compromised WordPress site was ottawashowers[.]ca . The attacker set up the subdomain `t-`\n```\nemail1 and a redirection script in the /r/ folder to mimic Adobe Campaign URLs. The parameters from the\n\n```\noriginal Samsung campaign were left unchanged.\n\n\n-----\n\nIndication that the domain `t-email1.ottawashowers[.]ca was created for the purpose of the campaign.`\n\n_Phishing attack scheme with compromised WordPress site for first redirect._\n\nLater on in the campaign, the attackers changed the redirection method to be independent of a specific domain or\nAdobe Campaign server. They compromised and set up a similar redirect on multiple WordPress sites (to see the full\nlist, go the IOCs section).\n\n_Timeline of campaign with different redirect servers._\n\nIn addition to changing the redirect domains, the threat actors started to change other (previously constant)\nparameters in the URL while preserving the basic Adobe URL structure. The parameters are used to check the\nintegrity of the link, as well as to avoid detection by pattern-based engines (which will not automatically block all\nAdobe Campaign redirects). If a parameter is manually changed in this link, the server returns the message: `AUTH`\n```\nFAILED .\n\n```\n\n-----\n\n_Opendir on one of compromised WordPress sites contains newly created redirect folder r/._\n\n## Phishing Kit\n\nThe final phishing kit was located on compromised WordPress sites. In some cases, the phishing kit was located on\nsites designed to look like a Microsoft login page. A separate virtual directory is created for each victim, so the final\nURL is different for every victim, even on the same server.\n\n\n-----\n\n_Microsoft phishing page._\n\nMost of the HTML code of the phishing pages is generated by JavaScript. The phishing page is divided into multiple\n[sections, and each section is obfuscated with multi-byte XOR. For example, the <HEAD> section of the HTML page](https://www.proofpoint.com/sites/default/files/proofpoint-obfuscation-techniques-phishing-attacks-threat-insight-en-v1.pdf)\nis a piece of JavaScript code containing 2 hex blobs that are unescaped and evaluated.\n\n_Part of an obfuscated phishing page._\n\nDecoding the first eval() statement reveals the decoding function.\n\n_First eval() statement after hex decoding._\n\nThis decoding function extracts encoded data (stored in tmp[0]) and XOR key (stored in tmp[1]) from the argument\nand performs XOR between the data and the key (loop in the code above).\n\nThe second eval() statement calls this decoding function and writes the final HTML to the page with document.write():\n\n\n-----\n\n_Second eval() statement after hex decoding_\n\n_Decoded <HEAD> section of HTML code_\n\nGenerated HTML code means that all the pages look the same, but they have completely different source codes.\nTogether with obfuscation, this method helps hide the code and its malicious intents from security software.\n\n## Conclusion\n\nIn this campaign, the attackers used multiple mechanisms to bypass security solutions at each stage.\n\nUtilizing an Oxford email server to send spam allows them to bypass the sender reputation filters and use\ngenerated email accounts instead of compromised actual accounts.\nLinks within the email point to a high reputation domain owned by Samsung.\nA chain of redirects lead to a fully-obfuscated phishing page.\n\nDuring the short campaign period, the attackers continuously developed and improved the redirection method to be\nindependent of a specific domain and the Adobe Campaign servers.\n\n**Check Point recommends organizations to use** **[cloud and mail security solutions. The fact these campaigns](https://www.checkpoint.com/products/email-security/)**\nthrive proves native security solution are easy to bypass – such solutions are essential to remove threats getting into\nyour email and protecting you cloud infrastructure.\n\n**Adobe took the relevant actions to prevent this type of attack through its server across all customers.**\n\n## Appendix A: IOCs\n\n**Redirect servers:**\n\nt.email1.samsung[.]ca/r/\n\nt-email1.ottawashowers[.]ca/r/\n\nt-email1.instantytpresence[.]com/r/\n\nflycloud.co[.]il/r/\n\ncosmos.org[.]in/r/\n\niyak.org[.]tr/o/\n\nankit-gupta.co[.]in/r/\n\nistern.co[.]il/r/\n\n**Compromised WP sites hosting Office 365 phishing kits or intermediate redirects:**\n\n\n-----\n\njunestore[.]club\npopskill[.]net\nyourhindinews[.]com\nmrdigitalduniya[.]com\nvrpublicnews[.]com\nlearndigitalseo[.]com\nghassociates.co[.]in\nyournewstv[.]com\ncodewithjustin[.]com\npretrendy[.]com\ndalelaganj[.]com\ngetfasternews[.]com\nbloggingthenews[.]com\nwpbasket.co[.]il\nacornmagic[.]club\nheaccountabilitycollective[.]com\nlegaltax[.]in\ncbcvietnam[.]org\nzeriio[.]com\nww.indoxxi[.]pl\nespinozaweb[.]net\nrumahcendekiaunj[.]com\nbeatanyinvestment[.]club\nactivedomain53[.]com\nabsoluteaesthetics.co[.]uk\ntremplinedu[.]com\niamkongu[.]com\nwww.kwentongnoypi[.]com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-18 - Office 365 Phishing Campaign Exploits Samsung, Adobe and Oxford Servers.pdf"
    ],
    "report_names": [
        "2020-06-18 - Office 365 Phishing Campaign Exploits Samsung, Adobe and Oxford Servers.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535894,
    "ts_updated_at": 1743041139,
    "ts_creation_date": 1653761354,
    "ts_modification_date": 1653761354,
    "files": {
        "pdf": "https://archive.orkl.eu/cde40d31004ee0d5ba83a54433a099f2ad3086f4.pdf",
        "text": "https://archive.orkl.eu/cde40d31004ee0d5ba83a54433a099f2ad3086f4.txt",
        "img": "https://archive.orkl.eu/cde40d31004ee0d5ba83a54433a099f2ad3086f4.jpg"
    }
}