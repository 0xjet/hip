{
    "id": "93f1fb83-e618-4746-9dfa-e38a6376b67c",
    "created_at": "2023-01-12T15:00:25.643602Z",
    "updated_at": "2025-03-27T02:05:51.263446Z",
    "deleted_at": null,
    "sha1_hash": "2a0fa0e22c77312b633c17207ff61255b85353dd",
    "title": "2021-11-18 - Netskope Threat Coverage- The Return of Emotet",
    "authors": "",
    "file_creation_date": "2022-05-28T17:13:03Z",
    "file_modification_date": "2022-05-28T17:13:03Z",
    "file_size": 1127401,
    "plain_text": "# Netskope Threat Coverage: The Return of Emotet\n\n**[netskope.com/blog/netskope-threat-coverage-the-return-of-emotet](https://www.netskope.com/blog/netskope-threat-coverage-the-return-of-emotet)**\n\nGustavo Palazolo November 18, 2021\n\n_[Co-authored by Gustavo Palazolo and Ghanashyam Satpathy](https://www.netskope.com/blog/author/gsatpathy)_\n\n## Summary\n\n[At the beginning of 2021, Emotet was considered to be the world’s most dangerous malware](https://www.netskope.com/blog/netskope-threat-coverage-emotet)\n[by Europol. The threat was first discovered in 2014 when it was acting as a banking trojan.](https://www.europol.europa.eu/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action)\nOver the years, the malware evolved into one of the most relevant botnets in the threat\n[landscape, often used to deliver other threats, such as](https://blog.malwarebytes.com/malwarebytes-news/2020/10/new-emotet-delivery-method-spotted-during-downward-detection-trend/) [Trickbot and](https://malpedia.caad.fkie.fraunhofer.de/details/win.trickbot) [Ryuk ransomware.](https://malpedia.caad.fkie.fraunhofer.de/details/win.ryuk)\n[Netskope detected Emotet during Oct 2020, using PowerShell and WMI to download and](https://www.netskope.com/blog/you-can-run-but-you-cant-hide-detecting-malicious-office-documents)\nexecute its payload.\n\nAfter massive collaboration between law enforcement agencies around the world, Emotet\nwas taken down in January 2021, where the malware’s infrastructure was disrupted from the\ninside. This was extremely important, as infected machines were redirected towards law\nenforcement-controlled infrastructure, preventing further actions from Emotet’s threat actors.\n\nAfter almost a year, Emotet (a.k.a. Geodo, Heodo) [was spotted again in the wild, being](https://cyber.wtf/2021/11/15/guess-whos-back/)\n[delivered by Trickbot. This new campaign is being tracked by MalwareBazaar /](https://bazaar.abuse.ch/browse/tag/Emotet/) Feodo\nTracker, where we can see an increase since November 15, 2021.\n\n\n-----\n\nScreenshot of Emotet tracker from MalwareBazaar.\nIn this threat coverage, we will analyze a malicious Microsoft Office document from a set of\nfiles that are delivering the new Emotet payload.\n\n## Analysis\n\nOnce we open the document, we can see a fake message that lures the victim into enabling\nthe macros, by clicking the “Enable Editing” and “Enable Content” buttons.\n\n\n-----\n\nMalicious document that delivers Emotet.\nThe threat actors protected the VBA project with a password to prevent viewing the macro in\nthe VBA editor, likely to slow down analysis.\n\nProtected VBA project.\n\nAfter bypassing this protection, we can see that the document contains an obfuscated macro\ncode.\n\n\n-----\n\nMacro code executed by the document.\nThere are a few functions that are not used at all, possibly added as decoys. The main code\n[is triggered by the “Document_Open()” function.](https://docs.microsoft.com/en-us/office/vba/api/word.document.open)\n\nFunction triggered\n\nonce the document is opened.\nBy looking at the function called by this entry point, we can see the threat actors attempt to\nhide a PowerShell script by using string concatenation and replace, which can all be easily\nremoved.\n\n\n-----\n\nThe VBA code goal is to execute a PowerShell script, that basically iterates over a URL list,\nand tries to download the content into “ C:\\ProgramData\\ ”.\n\nPrettyfied\n\nPowerShell script executed by the malicious document.\nOnce an online URL is found, Emotet’s DLL is written into the disk with a random name, for\nexample: “ C:\\ProgramData\\1856230245.dll ”.\n\nAt the time of our analysis, three of the URLs were offline.\n\n\n-----\n\nOnline and Offline URLs from Emotet’s document.\nThe downloaded file is a 32-bit DLL, and although this information is not 100% reliable, it\nlooks like the file was compiled on November 16, 2021.\n\nEmotet’s payload downloaded by the malicious document.\nThe final payload is another DLL, which is unpacked and executed in memory by the\ndownloaded file.\n\n\n-----\n\nEmotet being unpacked in memory.\nOnce running, Emotet starts the communication with its C2 servers.\n\n\n-----\n\nEmotet C2 communication.\nAt the moment of this analysis, there are [19 online servers linked to Emotet.](https://feodotracker.abuse.ch/browse/emotet/)\n\n## Protection\n\nNetskope Threat Labs is actively monitoring this campaign and has ensured coverage for all\nknown threat indicators and payloads.\n\n**Netskope Threat Protection**\n```\n      Document-Word.Trojan.Emotet\n      Win32.Trojan.Emotet\n\n```\n**Netskope Advanced Threat Protection provides proactive coverage against this**\nthreat.\n```\n      Gen.Malware.Detect.By.StHeur indicates a sample that was detected using\n\n```\nstatic analysis\n```\n      Gen.Malware.Detect.By.Sandbox indicates a sample that was detected by\n\n```\nour cloud sandbox\n\n## IOCs\n\n\n-----\n\n**Emotet Document Hashes**\n\nSHA256\n\n4938ef80579abd3efdb5caa81ccd37648e771dfcd8eb6fb59789faf5c29002d9\n\nfcdc52a70e95e9e1979db1a9145ca43135ad7b1497a6c62b606989734680cd5d\n\neeabaea8e1a978fb94bbb03a4dd20c9259c9a65bdaee42ab5a777ca1ccba27a0\n\n7ba276ef23853e8a1bc1b32b8fa67ff845d9fa78c2820aa68c4907aead76fd06\n\nMD5\n\n97b18705eb20d678681e39cc877b3d2a\n\n93288048b2d674437e5d8adcf13d1169\n\n7d987aac2dba9450640fb15d860be5dc\n\n356252e7a07ec1a807795cfb77629ea7\n\n[The full list of IOCs analyzed in this campaign can be found in our Git repository.](https://github.com/netskopeoss/NetskopeThreatLabsIOCs/tree/main/Emotet/IOCs)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-18 - Netskope Threat Coverage- The Return of Emotet.pdf"
    ],
    "report_names": [
        "2021-11-18 - Netskope Threat Coverage- The Return of Emotet.pdf"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535625,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1653757983,
    "ts_modification_date": 1653757983,
    "files": {
        "pdf": "https://archive.orkl.eu/2a0fa0e22c77312b633c17207ff61255b85353dd.pdf",
        "text": "https://archive.orkl.eu/2a0fa0e22c77312b633c17207ff61255b85353dd.txt",
        "img": "https://archive.orkl.eu/2a0fa0e22c77312b633c17207ff61255b85353dd.jpg"
    }
}