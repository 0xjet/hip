{
    "id": "d6590890-23cb-4bde-a8f5-88697ba748b7",
    "created_at": "2023-01-12T15:07:58.558331Z",
    "updated_at": "2025-03-27T02:14:39.238348Z",
    "deleted_at": null,
    "sha1_hash": "02e77ad28b9daebd7ac59611b768608aac800c8d",
    "title": "2018-04-17 - SquirtDanger- The Swiss Army Knife Malware from Veteran Malware Author TheBottle",
    "authors": "",
    "file_creation_date": "2022-05-28T02:13:57Z",
    "file_modification_date": "2022-05-28T02:13:57Z",
    "file_size": 2694230,
    "plain_text": "# SquirtDanger: The Swiss Army Knife Malware from Veteran Malware Author TheBottle\n\n**researchcenter.paloaltonetworks.com/2018/04/unit42-squirtdanger-swiss-army-knife-malware-veteran-malware-**\nauthor-thebottle/\n\nJosh Grunzweig, Brandon Levene, Kyle Wilhoit, Pat Litke April 17, 2018\n\nBy [Josh Grunzweig,](https://unit42.paloaltonetworks.com/author/joshgruznweig/) [Brandon Levene,](https://unit42.paloaltonetworks.com/author/brandon-levene/) [Kyle Wilhoit and](https://unit42.paloaltonetworks.com/author/kyle-wilhoit/) [Pat Litke](https://unit42.paloaltonetworks.com/author/pat-litke/)\n\nApril 17, 2018 at 1:00 PM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [Dendi,](https://unit42.paloaltonetworks.com/tag/dendi/) [Foxovsky,](https://unit42.paloaltonetworks.com/tag/foxovsky/) [Omagarable,](https://unit42.paloaltonetworks.com/tag/omagarable/) [SquirtDanger,](https://unit42.paloaltonetworks.com/tag/squirtdanger/) [TheBottle](https://unit42.paloaltonetworks.com/tag/thebottle/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-squirtdanger-swiss-army-knife-malware-veteran-malware-author-thebottle/)\n\nFinding and investigating new malware families or campaigns is a lot like pulling a loose\nthread from an article of clothing. Once you start tugging gently on the thread, everything\nstarts to unravel. In this particular case we began by investigating a new malware family,\nwhich we are calling SquirtDanger based on a DLL, SquirtDanger.dll, used in the attacks.\nThere is strong evidence to indicate that this malware family was created by a prolific\nRussian malware author that goes by the handle of ‘TheBottle’. By pulling on a few strings\nwe were eventually led to TheBottle's unraveling. In this post we will delve into how we\nunraveled TheBottle's activities and his newest malware family.\n\nMalware Overview\n\nSquirtDanger is a commodity botnet malware family that comes equipped with a number of\n\n\n-----\n\n[characteristics and capabilities. The malware is written in C# (C Sharp) and has multiple](https://en.wikipedia.org/wiki/C_Sharp_(programming_language))\nlayers of embedded code. Once run on the system, it will persist via a scheduled task that is\nset to run every minute. SquirtDanger uses raw TCP connections to a remote command and\ncontrol (C2) server for network communications.\nSquirtDanger comes with a wealth of functionality, including the following:\n\nTake screenshots\nDelete malware\nSend file\nClear browser cookies\nList processes\nKill process\nList drives\nGet directory information\nDownload file\nUpload file\nDelete file\nSteal wallets\nSteal browser passwords\nSwap identified wallets in the victim’s clipboard\nExecute file\n\nThe ability to swap out identified wallets with a predetermined wallet owned by the attacker is\nnot a new one, as we have previously reported on it when analyzing the ComboJack\nmalware family. For more information on how the SquirtDanger malware family operates,\nplease refer to an in-depth analysis within the Appendix of this post.\nUsing various analytic techniques, Palo Alto Networks Unit 42 researchers were able to\nextract an embedded identifier from roughly 400 SquirtDanger samples, which we attribute to\nseparate campaigns. Broadly, we identify two subsets of this malware which are divided by\ndistinct mutexes and other indicators that we observed in WildFire. As we dug into this\nmalware, we discovered a code repository which coincided with the capabilities and style of\nthe samples we had observed. A screenshot of this repository's base page is reproduced in\nfigure 1 below:\n\n\n-----\n\n_Figure 1 Source code of SquirtDanger hosted on GitHub_\n\nFurther analysis of the code in this repository indicated that our initial assessment was\ncorrect, and that this repository was the source code for SquirtDanger. While exploring the\ncode, we discovered that TheBottle had posted this repository (and others) as a companion\nto a \"confession\" blog posted on telegra.ph.\n\nTheBottle Connection\n\nTheBottle, a well-known Russian cybercriminal has been active on global underground\nmarketplaces for years Distributing selling and trading malware and source code has been\n\n\n-----\n\nTheBottle s modus operandi on underground marketplaces and forums. It appears, however,\nthat TheBottle has encountered several issues throughout his career as a malware author.\nAccording to Vitali Kremez of Flashpoint:\n\"Previously, TheBottle was banned unanimously by the underground arbitrators for customer\n_infractions. His underground infractions were very costly leading to multiple disputes_\n_accusing him of not delivering malware support that was needed for long-term criminal_\n_operations.\"_\nWhile investigating SquirtDanger, we came across a confessional blog post claiming to be\nTheBottle. In the post, the individual claimed responsibility for creating several malware\nfamilies, including Odysseus Project, Evrial, Ovidiy Stealer, and several others. Again, Vitali\nof Flashpoint:\n_\"In his latest confession on telegraph, the actor walks through their life in underground_\n_lamenting on his challenges of being a malware developer with real-life issues... His sense of_\n_guilt pushed him to release all of his malware creations that were used in many cybercrime_\n_operations in the past from \"Ovidiy Stealer\" to \"Reborn Stealer.\"_\nBelow is a screenshot of TheBottle's original post in his native Russian:\n\n\n-----\n\n_Figure 2 Screenshot of TheBottle s blog post, confessing to authorship of malware families._\n_TheBottle is ultimately expressing regret for creating many of the malware families._\n\nLooking closer at TheBottle's blog posting revealed a Telegram channel exposing a group of\nroughly 900 individuals most of whom appear to be Russian. Here the channel members are\ncoordinating attacks, developing code, and trading/selling access to several different botnets\nand builders. Additionally, this Telegram group appears to be a common haunt of some\ninteresting prolific actors, some with high-profile ties; such as foxovsky, an underground\nactor who is famous in underground communities for developing malware. Readers may\n[recall foxovsky as being the author of a previously reported malware family called Rarog.](https://blog.paloaltonetworks.com/2018/04/unit42-smoking-rarog-mining-trojan/)\nAdditionally, the ‘1MSORRY‘ actor was identified as being a member of this community, who\nis behind the 1MSORRY cryptocurrency botnet and other malware families being distributed\naround the globe.\n\n\n-----\n\n_Figure 3 Screenshot of Telegram channel with prolific underground actors communicating_\n\nAfter some online sleuthing, we were able to find additional accounts across several social\nmedia sites TheBottle frequented. Across most of the social media sites we located, it was\napparent TheBottle took his hacking persona seriously.\n\n_Figure 4 Screenshot of TheBottle's Twitter feed_\n\nAlso, looking closer into TheBottle's Twitter conversations helped shed some light on how\nTheBottle feels about individuals using their malware.\n\n\n-----\n\n_Figure 5 Screenshot of TheBottle's conversation with @malwarhunterteam_\n\nInfection Vector/Victimology\n\nIn total, we saw 1,277 unique SquirtDanger samples used across multiple campaigns.\nSquirtDanger is likely delivered via illicit software downloads also known as \"Warez\".\n\nAs of the time of writing, we witnessed 119 unique C2 servers that were geographically\ndispersed:\n\n\n-----\n\n_Figure 9 Geographic distribution of identified C2 servers_\n\nAdditionally, in the wild, we were able to identify 52 unique IP's or domains acting as delivery\ninfrastructure. This infrastructure acts as a dissemination point for this malware. Some of this\ndelivery infrastructure appeared to be compromised legitimate websites unwittingly\ndistributing SquirtDanger.\n\nWe have witnessed SquirtDanger being used against individuals across the globe, such as a\nTurkish university, an African telecommunications company, and a Japanese Information and\ncommunication technology provider in Singapore.\n\nConclusion\n\nThe SquirtDanger malware family is just one of many commodity families being created\ntoday. It comes equipped with a wealth of features that allow attackers to quickly perform\nvarious actions on a compromised machine. While the malware itself proved to be\ninteresting, it was the actor behind it that provided a much more interesting story.\n\nAs we pulled on TheBottle's thread, we slowly started to realize that what we've found is just\nthe tip of the proverbial iceberg. As we looked deeper into TheBottle's malware and online\nactivity, we noticed this was just minor activity taking place in a larger web of criminals\nworking together. In fact, just recently, one of TheBottle's allies was outed by the researcher\nknown as [Benkow.](https://benkowlab.blogspot.com/2018/04/sorry-not-sorry-1ms0rry-atsamaz-gatsoev.html)\n\nUltimately, as we unraveled a small portion of criminal activity, we were able to observe a\nmalware author evolve into what seemed a somewhat remorseful individual, posting on a\nnear personal level. Ultimately, will TheBottle change his ways? We will watch and see.\n\nUsing several sources of intelligence were key to the investigation of this actor and malware,\nand Palo Alto Networks customers are protected from this threat by:\n\n\n-----\n\n1. WildFire detects all SquirtDanger files with malicious verdicts\n[2. AutoFocus customers can track these samples with the SquirtDanger tag](https://autofocus.paloaltonetworks.com/#/tag/Unit42.SquirtDanger)\n3. Traps blocks all of the files associated with SquirtDanger\n\nAppendix\n\n**Malware Analysis**\nThe SquirtDanger malware family comes equipped with a wealth of features by the author.\n[The malware is coded using C#. The malware author chose to make use of the Costura add-](https://github.com/Fody/Costura)\nin to embed the SquirtDanger payload into the compiled executable.\nOnce the main module is loaded and subsequently executed, it will begin by creating an\ninstallation directory, where the malware will copy itself. The following directories and their\ncorresponding installation executables have been observed in the samples analyzed:\n\n%TEMP%\\Microsoft_SQL_SDKs\\AzureService.exe\n%TEMP%\\MonoCecil\\Fazathron.exe\n\nAfter SquirtDanger is copied to the necessary path, a new instance of this malware will be\nspawned prior to killing the current process.\nOnce the installation phase has completed and the malware is found to be executed from the\ncorrect location, a new mutex will be created to ensure only one instance of the malware is\nrun at a given time. The following two mutexes have been observed across all analyzed\nsamples:\n\nOmagarable\nAweasomeDendiBotnet\n\nAfter the mutex has spawned, SquirtDanger will proceed to check for the existence of\nanother executable, which will act as a persistence mechanism. This simple executable will\nsimply check for the existence of the SquirtDanger payload, and if the payload cannot be\nfound, a new copy is written to disk and a new instance will be spawned. This executable is\nembedded within the SquirtDanger payload, and has been observed dropped to the following\nlocation:\n\n%TEMP%\\MSBuild.exe\n%TEMP%\\OmagarableQuest.exe\n\nThis dropped file is given both SYSTEM and HIDDEN attributes to prevent victims from\ndiscovering it. A new scheduled task is created with a name of ‘CheckUpdate’ to run this file.\nThis scheduled task checks every minute after it is initially setup.\nSquirtDanger proceeds to communicate with the remote C2 server using raw TCP sockets.\nData sent between the client and server is serialized, however, it is not obfuscated. When the\nmalware initially communicates with the remote server, it will attempt to obtain a list of\nadditional modules to install An example of this communication may be seen below:\n\n\n-----\n\n_Figure 6 Example communication between malware client and C2 server_\n\nAfter the list of modules and their associated URLs are collected, SquirtDanger will download\nthese modules via HTTP communication.\n\nSquirtDanger comes with a wealth of functionality, including the following:\n\nTake screenshots\nDelete malware\nSend file\nClear browser cookies\nList processes\nKill process\nList drives\nGet directory information\nDownload file\n\n\n-----\n\nUpload file\nDelete file\nSteal wallets\nSteal browser passwords\nSwap identified wallets in the victim’s clipboard\nExecute file\n\nIn the case of stealing passwords from browsers, a number of browsers are supported,\nincluding the following:\n\nChrome\nFirefox\nYandex Browser\nKometa\nAmigo\nTorch\nOpera\n\n_Figure 7 Malware attempting to collect passwords from various popular browsers_\n\nSquirtDanger also has the ability to seek out wallets for various cryptocurrencies, including\nthe following:\n\nLitecoin\nBitcoin\nBytecoin\nDash\nElectrum\nEthereum\nMonero\n\n\n-----\n\n_Figure 8 Malware attempting to identify various cryptocurrency wallets on the victim machine_\n\nIn addition to stealing wallets, the malware contains the ability to swap a victim’s clipboard\ndata in the event a specific regular expression is encountered. The following regular\nexpressions were present within the malware:\n\n**Type** **Regular Expression**\n\nQIWI (^\\+\\d{1,2})?((\\(\\d{3}\\))|(\\-?\\d{3}\\-)|(\\d{3}))((\\d{3}\\-\\d{4})|(\\d{3}\\-\\d\\d\\-\\d\\d)|(\\d{7})|\n(\\d{3}\\-\\d\\-\\d{3}))\n\nBTC ^([13][a-km-zA-HJ-NP-Z1-9]{25,34})$\n\nETH ^(0x[0-9a-fA-F]{40})$\n\nLTC ^(L[a-zA-Z0-9]{26,33})$\n\nXRP ^(r[rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz]\n{27,35})$\n\nDOGE ^(t[0-9a-zA-Z]{34})$\n\nZEC ^(D{1}[5-9A-HJ-NP-U]{1}[1-9A-HJ-NP-Za-km-z]{32})$\n\nXMR ^(4[0-9AB][1-9A-Za-z]{93,104})$\n\n\n-----\n\nIn the event one of these digital currency addresses are encountered, the malware is\nconfigured to swap the value with one that is pre-determined. A number of digital currency\naddresses were able to be retrieved from our sample set, which have been included in the\nAppendix of this blog post. This feature is not a new one, as we have previously reported on\n[it when analyzing the ComboJack malware family.](https://blog.paloaltonetworks.com/2018/03/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/)\n\n**SquirtDanger Samples**\nFor a full list of SquirtDanger hashes, as well as their first seen timestamps, please refer to\n[the following link.](https://github.com/pan-unit42/iocs/blob/master/squirtdanger/squirtdanger_samples.csv)\n\n**C2 Servers**\nFor a full list of C2 servers, as well as their first seen timestamps, please refer to the\n[following link.](https://github.com/pan-unit42/iocs/blob/master/squirtdanger/squirtdanger_c2.csv)\n\n**Distribution Servers**\nFor a full list of distribution servers, as well as their first seen timestamps, please refer to the\n[following link.](https://github.com/pan-unit42/iocs/blob/master/squirtdanger/squirtdanger_distribution.csv)\n\n**Updates:**\nwww.msftconnecttest[.]com was erroneously included in the IoC and that has been corrected\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-04-17 - SquirtDanger- The Swiss Army Knife Malware from Veteran Malware Author TheBottle.pdf"
    ],
    "report_names": [
        "2018-04-17 - SquirtDanger- The Swiss Army Knife Malware from Veteran Malware Author TheBottle.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536078,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653704037,
    "ts_modification_date": 1653704037,
    "files": {
        "pdf": "https://archive.orkl.eu/02e77ad28b9daebd7ac59611b768608aac800c8d.pdf",
        "text": "https://archive.orkl.eu/02e77ad28b9daebd7ac59611b768608aac800c8d.txt",
        "img": "https://archive.orkl.eu/02e77ad28b9daebd7ac59611b768608aac800c8d.jpg"
    }
}