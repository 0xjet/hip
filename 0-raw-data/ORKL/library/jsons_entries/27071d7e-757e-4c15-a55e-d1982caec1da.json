{
    "id": "27071d7e-757e-4c15-a55e-d1982caec1da",
    "created_at": "2023-01-12T15:04:20.355636Z",
    "updated_at": "2025-03-27T02:05:28.642135Z",
    "deleted_at": null,
    "sha1_hash": "bf8b70ab838471bfa7f15a26766c006c5ae5c047",
    "title": "2020-09-03 - The Bitcoin Ransomware Detective Strikes Again- The UCSF Case",
    "authors": "",
    "file_creation_date": "2022-05-27T21:28:18Z",
    "file_modification_date": "2022-05-27T21:28:18Z",
    "file_size": 126205,
    "plain_text": "# The Bitcoin Ransomware Detective Strikes Again: The UCSF Case\n\n**zengo.com/bitcoin-ransomware-detective-ucsf/**\n\nSeptember 3, 2020\n\n**TL;DR: Hunting for real-world incidents in blockchain data sometimes leads to**\n**interesting insights and findings. In this case, we were able to find UCSF’s $1.14M**\n**ransom payment on the blockchain and correlate it to an additional $700K transaction.**\n**This potentially increases the paid UCSF ransom to over $1.8M.**\n\n[Following our recent article on the $4M Bitcoin CWT ransomware payment, we continued to](https://zengo.com/cwt-ransomware-crypto-laundering/)\nhone our blockchain hunting skills. Usually, these skills are used to protect ZenGo\ncustomers.\n\nThis time, however, we had a different focus. We managed to track down the $1.14M ransom\npaid by the University of California San Francisco (UCSF).\n\nYou might remember this case.\n\nIt gained widespread exposure because ransom negotiations between UCSF’s negotiator\n[and hackers were made public and covered by popular media outlets like BBC and](https://www.bbc.com/news/technology-53214783)\n[Bloomberg.](https://www.bloomberg.com/news/features/2020-08-19/ucsf-hack-shows-evolving-risks-of-ransomware-in-the-covid-era?sref=Pqfp0AgC)\n\nIn this article, we’ll share our findings and some additional insights we were able to infer from\nthe [Bitcoin blockchain data. We’ll also describe our methods so other security researchers](https://zengo.com/assets/bitcoin-wallet/)\ncan explore similar incidents in the future and possibly create a safer environment for all of\nus.\n\n## How to find a ransomware transaction\n\n\n-----\n\nAccording to the [threatpost, UCSF paid a $1.14 million ransom to recover data related to](https://threatpost.com/ucsf-pays-1-14m-after-netwalker-ransomware-attack/157015/)\n[academic work. This data was encrypted after the NetWalker ransomware hit the medical](https://threatpost.com/netwalker-ransomware-gang-top-notch-affiliates/155946/)\nschool at the university.\n\nUnlike the CWT case linked to above, public reports on UCSF ransomware did not include\nthe attackers’ Bitcoin address, supposedly preventing researchers from analyzing the money\ntrail. This made our investigations a little more cumbersome. However, we did not give in.\n\nAs we should all know by now, Bitcoin data is pseudonymous, not anonymous. Users are\nrepresented by mostly meaningless addresses, however all transactions between these\naddresses can be watched by anyone. With this in mind, we knew it would be possible to find\nthe address if we could obtain enough information on the transaction details and money trail\n“pattern” (more on that below).\n\nDiving into the media stories, we found two technical details that assisted in our\ninvestigation. The paid ransom sum was 116.4 BTC ($1.14M at the time), and the payment\ntook place on the 12th of June.\n\nWhile sending such a large and specific amount of money in a particular time period may\nseem like enough to identify the transaction, we wanted to be sure. To have an even higher\nlevel of certainty, we required the transaction to be part of the following blockchain “pattern”.\n\nRansomware payments usually follow a distinct pattern:\n\n1. Negotiators buy the exact amount of Bitcoin requested by attackers, from a large\n\nliquidity provider. The negotiators use a “fresh” address, with no previous history to\nprevent any data leakage, for this transaction.\n\n1. Negotiators then immediately transfer this full amount to the attackers’ fresh address.\n\nThe transfer is done rapidly as negotiators don’t want to keep so much money in their\npossession for a long time. (Sometimes, negotiators will send a small transaction first\nto make sure they have the right address and then send the full amount.)\n\n1. Once the payout lands in the attackers’ initial address, the attackers split the loot. In the\n\ncase of the NetWalker ransomware, this split is very distinct. The NetWalker gang\nworked in a “Ransomware-as-a-service” (RaaS) model. The gang operates the\ninfrastructure, while the affiliate drives the operation and infects the victim. Thanks to\n[ciphertrace research, we know that this model creates a “four arms” pattern, depicted](https://ciphertrace.com/tracing-ransomware-ciphertrace-helps-mcafee-follow-netwalker-funds/)\nbelow. The NetWalker gang operators get 20% of the loot, split into 10%, 5%, and 5%\npayments to known addresses. The remaining 80% goes to the RaaS affiliate.\n\n[NetWalker’s “four arms” Bitcoin payment pattern (source: ciphertrace)](https://ciphertrace.com/wp-content/uploads/2020/08/Netwalker-RaaS.png)\n\n## Finding the transaction\n\n\n-----\n\nUsing [BlockChair s interface, we could query the Bitcoin blockchain for transactions on the](https://blockchair.com/)\ndate and the reported sum. We provided a slightly bigger range for both dates and sums to\nallow some flexibility in case the details in the story were not exact. We created a query to\nretrieve transactions where the sum is between 116 and 117 Bitcoin, and the date is between\nthe 12th and 13th of June:\n\nhttps://blockchair.com/bitcoin/outputs?\n[s=spending_time(desc)&q=value(11600000000..11700000000),spending_time(2020-06-](https://blockchair.com/bitcoin/outputs?s=spending_time(desc)&q=value(11600000000..11700000000),spending_time(2020-06-12..2020-06-13)#)\n12..2020-06-13)#\n\n[Blockchair query results](https://blockchair.com/bitcoin/outputs?s=spending_time(desc)&q=value(11600000000..11700000000),spending_time(2020-06-12..2020-06-13)#)\nResults returned six possible candidates, but it was easy to identify the relevant ransom\ntransaction, as it followed our assumptions detailed above.\n\nThe ransom money trail: Binance → Negotiator → NetWalker → NetWalker Affiliate (all times\nUTC)\n[As we had expected, we found the Negotiators (address 36YWNH, shortened for readability)](https://blockchair.com/bitcoin/address/36YWNHUPJZ48dshHcQsY6nHucVRezpRd6y)\nbuying 116.4 BTC from [Binance exchange (address 19JyAkHKh, associated with Binance](https://www.binance.com/)\n[according to Clank) into a fresh address on the 12th of June at 20:13 (All times UTC), then](https://clankapp.com/bitcoin/address/19JyAkHKh36sFduqK4hMsMZhU6ZDoLotW)\n[paying immediately to a fresh NetWalker address (address 36kmJZj).](https://blockchair.com/bitcoin/address/36kmJZjqcLdJ77KWUeFFCGm8Cys4rHuhej)\n\n[Negotiators (address 36YWNH) purchasing 116.4 BTC from Binance (address 19JyAkHKh)](https://blockchair.com/bitcoin/address/36YWNHUPJZ48dshHcQsY6nHucVRezpRd6y)\n[then paying to NetWalker (address 36kmJZj)](https://blockchair.com/bitcoin/address/36kmJZjqcLdJ77KWUeFFCGm8Cys4rHuhej)\nThe NetWalker address immediately split the ransom money, sending 20% to the known\nNetWalker address in the usual split (5%, 5%,10%) and 80% to the NetWalker affiliate\n(address [1C7FeXMf1).](https://blockchair.com/bitcoin/address/1C7FeXMf18mGrcF59DJTkmxnRfkKeG1KFZ)\n\n[The “four arms” payment: 80% goes to the NetWalker affiliate (address 1C7FeXMf1)](https://blockchair.com/bitcoin/address/1C7FeXMf18mGrcF59DJTkmxnRfkKeG1KFZ)\n\n## The additional “four arms” transaction\n\nWe discovered the ransom money trail, and verified the media story by cross-checking it with\nBitcoin blockchain data.\n\nHowever, we weren’t done yet.\n\nWe discovered a similar “four arms” payment to the same affiliate address, made only 19\nhours before the UCSF payment.\n\nThe two payments to the NetWalker affiliate, with only 19 hours between them (source:\n[blockchair)](https://blockchair.com/bitcoin/address/1C7FeXMf18mGrcF59DJTkmxnRfkKeG1KFZ)\nOddly enough, the money trail followed a similar path from the same Binance address to the\nsame NetWalker affiliate. The Negotiators bought 70.5 BTC (about $700K) from the same\n[provider (Binance, address 19JyAkHKh) and put it into a fresh address on the 11th of June at](https://blockchair.com/bitcoin/address/19JyAkHKh36sFduqK4hMsMZhU6ZDoLotW)\n\n\n-----\n\n23:41. They then transferred it immediately to a fresh NetWalker address, that was split to\n[the same NetWalker affiliate (address 1C7FeXMf1).](https://blockchair.com/bitcoin/address/1C7FeXMf18mGrcF59DJTkmxnRfkKeG1KFZ)\n\nThe two ransom paths: On the top side the known UCSF payment (addresses denoted as\n#2), on the bottom side the unknown payment (addresses denoted as #1)\nThis extra payment to the same attacker could be related to the UCSF incident or another\nunrelated ransomware incident. However, after talking to ransom negotiation experts, the\nformer option is much more likely. This puts the total ransom paid by UCSF to the\n**attackers closer to $2M (187 BTC, or $187K at the time).**\n\nAccording to these experts, in many cases, payments are not paid at once but tranched in\nreturn for certain “milestones” to build rapport between parties—for example, one payment to\ndelete exfiltrated information or get more information on the penetration method used by\nattackers and a second to receive a decryption key.\n\nHaving the same liquidity provider (Binance), the same negotiator wallet “technology” (type\nof address and other technical optional fields) together with the payment to the same affiliate,\nwhich was conducted only 19 hours before the UCSF payment provides a strong, albeit\ncircumstantial, support to this theory too. .\n\nAdditionally, the alternative explanation, that connects the first payment to another unrelated\nransomware incident by the same NetWalker affiliate happening in parallel is unlikely. These\ntwo ransom transactions are the only NetWalker “four arms” transactions for this NetWalker\naffiliate. It doesn’t seem likely this NetWalker affiliate would have conducted two independent\nransomware campaigns in parallel with the same address, and then completely disappeared.\n\n## Summing up\n\n[“Big game hunting” ransomware incidents targeting large enterprises are all over the](https://medium.com/@TalBeerySec/enterprise-ransomware-attacks-these-violent-delights-have-violent-ends-e0a1925e7d80)\nfinancial news. However, in many cases, the details are often left in the shadows, as both\nattackers and victims want to keep the incidents from public view. Using Bitcoin blockchain\nresearch can help fill this information gap and reveal vital information on ransomware\nincidents.\n\nAt ZenGo, our customers’ security is our top priority. That’s why we try to learn from every\ncrypto-related security incident. In our experience, we’ve found that observing incidents is\nalways useful and often leads to some interesting insights. We believe understanding this\nincident may increase the awareness of law enforcement and help them detect and stop\nsuch underworld payments in the future.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-03 - The Bitcoin Ransomware Detective Strikes Again- The UCSF Case.pdf"
    ],
    "report_names": [
        "2020-09-03 - The Bitcoin Ransomware Detective Strikes Again- The UCSF Case.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535860,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653686898,
    "ts_modification_date": 1653686898,
    "files": {
        "pdf": "https://archive.orkl.eu/bf8b70ab838471bfa7f15a26766c006c5ae5c047.pdf",
        "text": "https://archive.orkl.eu/bf8b70ab838471bfa7f15a26766c006c5ae5c047.txt",
        "img": "https://archive.orkl.eu/bf8b70ab838471bfa7f15a26766c006c5ae5c047.jpg"
    }
}