{
    "id": "564c620f-3e93-4a99-83c1-aca65ef0f5fe",
    "created_at": "2022-10-25T16:48:11.290246Z",
    "updated_at": "2025-03-27T02:09:33.373758Z",
    "deleted_at": null,
    "sha1_hash": "8d9af4bb8b4bafcb9e58ab21e1419abd2eed46b2",
    "title": "Espionage toolkit targeting Central and Eastern Europe uncovered",
    "authors": "ESET",
    "file_creation_date": "2016-07-17T14:09:46Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 484621,
    "plain_text": "# uncovered\n\n**welivesecurity.com/2016/07/01/espionage-toolkit-targeting-central-eastern-europe-uncovered/**\n\nBy Tomáš Gardoň\n\nOver the course of the last year, ESET has detected and analyzed several instances of malware used for targeted\nespionage – dubbed SBDH toolkit. Using powerful filters, various methods of communication with its operators and\nan interesting persistence technique, it aims to exfiltrate selected files from governmental and public institutions,\nwhich are mostly focused on economic growth and cooperation in Central and Eastern Europe. ESET’s SBDH\nfindings were presented during the Copenhagen Cybercrime Conference 2016 by researchers Tomáš Gardoň and\nRobert Lipovský.\n\n\n-----\n\nThis toolkit – actually only its initial part – was spreading as an executable with a double extension attached to a\nphishing email (counting on Windows’ default behavior of hiding an extension). To further increase its chances of\nbeing run by the receiver, it uses legitimate looking icons of several Microsoft applications or a Word document.\n\n\n-----\n\nUpon successful execution, the malware contacts a remote location in order to download two other main\ncomponents of the toolkit: a backdoor and a data stealer. The combination of these modules provides the attacker\nnot only with full remote control of the compromised computer, but also with an advanced method of data exfiltration.\n\nThanks to powerful filters the operator can specify in great detail which data should be exfiltrated, using conditions\nsuch as file extension, date of creation, file size and others. These can be modified via the malware configuration\nfiles.\n\nBecause all of the components of this espionage toolkit require connection to the C&C server, the malware depends\n\n\n-----\n\nthe SBDH malware opts for a second method and tries to communicate via SMTP protocol using a free external\ngateway.\n\nAs a last resort, it has the capability to communicate by injecting specially crafted emails into Microsoft Outlook\nExpress. This way, injected emails were sent under the account of the currently logged user, allowing the malware to\nbypass security measures (assuming the user had rights to send and receive emails). These malicious messages\ncreated by the malware were then placed directly in a victim’s outbox, to avoid their attention.\n\nIn cases of incoming communication, the malware searched the victim’s inbox in order to identify emails received\nwith a specific subject. If the toolkit found such emails, they were parsed and checked for malware commands.\nFinally, the subjects of these emails were changed to prevent any further examination by the malware.\n\nHowever, this last option was only used up until 2006, when Outlook Express was replaced by the newer Windows\nMail application. Since then, the developers of this toolkit have increasingly focused on improving the HTTP\ncommunication method and started camouflaging communications with the C&C server by using fake image files\n(.JPG, .GIF) to carry the data.\n\nIn case of the C&C server’s unavailability, the backdoor component had yet another “backup solution” – a hardcoded URL pointing to a fake image (hosted on a free blog webpage) that contained the address of an alternative\nC&C server.\n\n\n-----\n\nSome of the analyzed samples of this component implemented an interesting persistence method; the malware was\nreplacing the handler for Word documents. It means, whenever the infected system tries to open/edit a Word\ndocument, the malware gets executed.\n\nLast but not least, if you are asking yourself where the name of the toolkit comes from, the “SBDH” string found in\ncompilation paths of its downloader and – more interestingly – the string “B64SBDH”, acts as a trigger to download\nits remaining components from a remote server.\n\n[Using similar techniques as the malware in Operation Buhtrap, the SBDH espionage toolkit proves that even](http://www.welivesecurity.com/2015/04/09/operation-buhtrap/)\nadvanced threats are still being spread via simple vectors, such as malicious email attachments. Yet, such risks can\nbe spotted by properly trained staff in organizations and further mitigated by implementing a reliable multi layered\n\n\n-----\n\n**Hashes**\n\n1345B6189441CD1ED9036EF098ADF12746ECF7CB\n15B956FEEE0FA42F89C67CA568A182C348E20EAD\nF2A1E4B58C9449776BD69F62A8F2BA7A72580DA2\n7F32CAE8D6821FD50DE571C40A8342ACAF858541\n5DDBDD3CF632F7325D6C261BCC516627D772381A\n4B94E8A10C5BCA43797283ECD24DF24421E411D2\nD2E9EB26F3212D96E341E4CBA7483EF46DF8A1BE\n09C56B14DB3785033C8FDEC41F7EA9497350EDAE\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/kmb22xnoniwxfkhsw8r3tkpo5rko0w1a"
    ],
    "report_names": [
        "ESET_targeting-Central-and-EasternEurope(07-01-2016)"
    ],
    "threat_actors": [
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041373,
    "ts_creation_date": 1468764586,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/8d9af4bb8b4bafcb9e58ab21e1419abd2eed46b2.pdf",
        "text": "https://archive.orkl.eu/8d9af4bb8b4bafcb9e58ab21e1419abd2eed46b2.txt",
        "img": "https://archive.orkl.eu/8d9af4bb8b4bafcb9e58ab21e1419abd2eed46b2.jpg"
    }
}