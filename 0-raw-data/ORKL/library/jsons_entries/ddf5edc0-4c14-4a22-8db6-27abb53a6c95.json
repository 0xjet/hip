{
    "id": "ddf5edc0-4c14-4a22-8db6-27abb53a6c95",
    "created_at": "2022-10-25T16:48:13.982483Z",
    "updated_at": "2025-03-27T02:15:18.790419Z",
    "deleted_at": null,
    "sha1_hash": "12c62600afe97d1309bc920524391e9ab9f4b01e",
    "title": "techdoc_lite-deliverables-numbered option.dotx",
    "authors": "",
    "file_creation_date": "2018-01-16T10:55:39Z",
    "file_modification_date": "2018-01-16T10:55:39Z",
    "file_size": 1062785,
    "plain_text": "Dept. No.: J83L\nProject No.: 0717MM09-AA\n\nThe views, opinions and/or findings\ncontained in this report are those of The\nMITRE Corporation and should not be\nconstrued as an official government position,\npolicy, or decision, unless designated by\nother documentation.\n\nApproved for Public Release;\n\nDistribution Unlimited. Case Number 173569. ©2018 The MITRE Corporation. All\nRights Reserved\n\n**Annapolis Junction, MD**\n\n\nMTR 1 7 04 4 6\n\nMIT RE TEC HN IC AL R EP ORT\n\n# APT3 Adversary Emulation Plan \n\n#### Authors: Christopher A. Korban Douglas P. Miller Adam Pennington Cody B. Thomas\n September 2017\n\n\n-----\n\n-----\n\n## Abstract\n\nTo advance the practice of security testing through adversary emulation, we present this\nemulation plan to be used by a team looking to emulate the APT3 threat group. It includes their\ncommonly known behavior through the tactics, techniques, and procedures that have been\ndocumented in publicly available reporting. To ground the plan in a common taxonomy, it is\nbased on the MITRE ATT&CK model. The scope covers the adversary lifecycle, from initial\nnetwork compromise through exfiltration. It discusses tools, methods, style, tradecraft, and endgoals. To fill intel gaps, best-estimates based on experience in threat intelligence and adversary\nemulation are provided.\n\niii\n\n\n-----\n\n## Acknowledgments\n\nWe would like to acknowledge the people that contributed to the content, review, and format of\nthis document. This includes: Frank Duff, Katie Nickels, and Blake Strom.\n\ni\n\n\n-----\n\n## Table of Contents\n\nOverview 1-1\n\nAPT3 Overview .................................................................................................................... 2-1\n2.1 APT3 Tools ................................................................................................................... 2-2\n2.2 APT3 Tool Functionality .............................................................................................. 2-4\n2.2.1 Pirpi Functions ........................................................................................................ 2-4\n2.2.2 PlugX Functions...................................................................................................... 2-6\n2.2.3 OSInfo Functions .................................................................................................... 2-7\n2.2.4 Pwdump Functions.................................................................................................. 2-9\n2.2.5 Mimikatz Functions ................................................................................................ 2-9\n2.2.6 RemoteCMD Functions .......................................................................................... 2-9\n2.2.7 Dsquery Functions .................................................................................................. 2-9\n2.2.8 LaZagne Functions................................................................................................ 2-10\n2.2.9 ScanBox Functions ............................................................................................... 2-10\n\nEmulation Phases ............................................................................................................... 3-10\n3.1 Phase 1 – Initial Compromise ..................................................................................... 3-11\n3.1.1 Implant Command and Control ............................................................................ 3-11\n3.1.2 Defense Evasion.................................................................................................... 3-11\n3.1.3 Initial Access ......................................................................................................... 3-11\n3.1.3.1 Case 1 – Spear Phishing with Browser Exploit [2] ...................................... 3-11\n3.1.3.2 Spear Phishing with Malicious RAR Attachment [3] .................................. 3-12\n3.1.3.3 Spear Phishing with Malicious RAR Attachment [21] ................................ 3-12\n3.1.3.4 Spear Phishing with Malicious RAR Attachment [21] ................................ 3-13\n3.1.3.5 Flash Exploit with Malware Concealed Within GIF [12] ............................ 3-13\n3.1.3.6 Victim Profiling [14] .................................................................................... 3-13\n3.2 Phase 2 - Network Propagation................................................................................... 3-13\n3.2.1 Machine Operations .............................................................................................. 3-14\n3.2.1.1 Discovery ...................................................................................................... 3-14\n3.2.1.2 Local Privilege Escalation ............................................................................ 3-15\n3.2.1.3 Persistence .................................................................................................... 3-16\n3.2.1.4 Credential Access ......................................................................................... 3-16\n3.2.2 Lateral Movement ................................................................................................. 3-17\nRemote Copy and Execution ......................................................................................... 3-17\n3.3 Phase 3 - Exfiltration .................................................................................................. 3-17\n\nBibliography ............................................................................................................................ 1\n\n\n-----\n\n## List of Figures\n\nFigure 1 APT3's Three Phases of Action ..................................................................................... 2-2\nFigure 2 APT3 Phase 2 Flow Chart ........................................................................................... 3-14\nFigure 3 APT3 Discovery ATT&CK Techniques ..................................................................... 3-15\nFigure 4 APT3 Privilege Escalation ATT&CK Techniques ...................................................... 3-15\nFigure 5 APT3 Persistence ATT&CK Techniques .................................................................... 3-16\nFigure 6 APT3 Credential Access ATT&CK Techniques ......................................................... 3-16\nFigure 7 APT3 Lateral Movement and Execution ATT&CK Techniques ................................ 3-17\nFigure 8 APT3 Exfiltration ATT&CK Techniques ................................................................... 3-17\n\ni\n\n\n-----\n\n## List of Tables\n\nTable 1 APT3 Tool Usage ........................................................................................................... 2-3\nTable 2 Pirpi Functions and Emulation ....................................................................................... 2-4\nTable 3 PlugX Functions and Emulation ..................................................................................... 2-6\nTable 4 OSInfo Functionality and Emulation .............................................................................. 2-7\nTable 5 Pwdump Functions and Emulation ................................................................................. 2-9\nTable 6 Mimikatz Functions and Emulation ................................................................................ 2-9\nTable 7 RemoteCMD Functions and Emulation .......................................................................... 2-9\nTable 8 Dsquery Function and Emulation ................................................................................... 2-9\nTable 9 LaZagne Functions and Emulation ............................................................................... 2-10\nTable 10 ScanBox Functions and Emulation ............................................................................. 2-10\n\nii\n\n\n-----\n\n## Overview \n\nIn an effort to advance the practice of security testing through adversary emulation and\nadversarial engineering, we present this emulation plan to be used by an adversary emulation\nteam looking to emulate the threat group commonly known as APT3. The plan includes the\ngroup’s commonly known behavior through the tactics, techniques, and procedures (TTPs) that\nhave been documented in publicly available threat reporting. To ground the plan in a common\ntaxonomy, it is based on the MITRE ATT&CK model[1]. The scope of this emulation plan covers\nthe adversary lifecycle, beginning with initial network compromise and ending with exfiltration.\nIt discusses tools, methods, style, tradecraft, and end state objectives. Historically, information\nabout attackers’ on-target actions and goals have been difficult to obtain and APT3 reporting is\nno exception; however, the document bases instructions off publicly accessible sources whenever\npossible, focusing on sources that could be cross-referenced to some degree. To fill the intel\ngaps, the authors relied on their experience in threat intelligence and adversary emulation for\nbest-estimates.\n\nThreat reporting sources vary widely, and correlation of activity to a threat group is not\nstraightforward, and as such the authors have worked to ensure reputable sources are referenced.\nWhile many threat intelligence sources work to provide information that is as accurate as\npossible to the community, there is still an inherent risk that third-party threat reporting may\nprovide inaccurate information.\n\n_Note: Within this document, italicized text represents notes. These notes represent comments that_\nare not supported by evidence but represent the author’s opinion. For example, they discuss\nconcessions that have been made to make the emulation instructions practical or to indicate\nwhere inconsistent or nonexistent reporting has required gaps to be filled in with best-guess\nestimates of adversary behavior.\n\nReferences are indicated in-line with bracketed numbers [#] and listed at the end of this\ndocument.\n\n## APT3 Overview\n\n**[ATT&CK Group ID: Group/G0022](https://attack.mitre.org/wiki/Group/G0022)**\n\n**Aliases: APT3, Gothic Panda, Pirpi, UPS Team, Buckeye, Threat Group-0110, TG-0110**\n\n**Operations: Clandestine Wolf, Clandestine Fox [1], Operation Double Tap [2]**\n\n**Target Industries: Aerospace and Defense, Construction and Engineering, High Tech,**\nTelecommunications, Transportation [1]\n\n**Adversary Objectives: Reporting indicates APT3 actors are interested in exfiltration of**\ndocuments [3]. They have been known to target printers and file shares [3]. They also target\nintellectual property, often industrial in nature. [4].\n\n1 https://attack.mitre.org\n\n2 1\n\n\n-----\n\n**Background: APT3 is a China-based threat group. APT3 has traditionally targeted a myriad of**\nUS and international targets; however, reporting dated September 2016 indicates the group\nshifted focus around March 2016 to target Hong Kong organizations [3].\n\nAPT3’s process can be broken up into three main phases as shown below:\n\n1. Initial Setup of command and control (C2), defense evasion techniques, and getting initial\n\ncompromise\n2. Discovery, privilege escalation, lateral movement, persistence, and execution\n3. Collection, data staging, and exfiltration\n\n**Figure 1 APT3's Three Phases of Action**\nThese phases are broken up into more detail in the following sections. The next section is about\nthe tools that APT3 uses for their operations, how to emulate them, and what ATT&CK tactics\nand techniques they correspond to. Command-line examples, as well as descriptions of what the\ntools do, are included in the accompanying “APT3 Adversary Emulation Field Manual” for\nreference.\n\n### 2.1 APT3 Tools\n\nAPT3 uses a combination of custom and openly available tools. Because custom adversary tools\ncan have hidden functionality, be difficult to tailor to new environments, or utilize server-side\ncontrollers which may be unavailable, recommendations are made for replacements that can\naccurately perform similar activity. Adversary emulators and defenders should be aware that\nreplacement tools will typically leave different footprints than adversary tools, specifically\ndifferent file hashes, command line arguments, Antivirus detection, API calls, and network\nsignatures. There are lots of ways to accomplish the same objectives with built-in Windows\ntools, but the focus for APT3 tends to be on more simplistic tools rather than more advanced\nWindows utilities like WMIC, WinRM, and PowerShell. The following table describes how to\nemulate the tools as well as detailing which ATT&CK Tactics are represented by them.\n\n2 2\n\n\n-----\n\n|Table 1 APT3 Tool Usage|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|Name Software Availability Emulation Notes ATT&CK Tactic Type|||||\n|Pirpi, SHOTPUT, Backdoor.APT.C ookieCutter|RAT|Custom|Standard Windows Binary based post- compromise toolkits such as MetaSploit (free) [5] or Cobalt Strike (paid) [6]|Defense Evasion, Credential Access, Discovery,|\n|PlugX [7] [8]|RAT|Custom, but seen across multiple groups|||\n|OSInfo [3]|Information Discovery|Custom|Several Windows commands can be used to gather similar information (net use, systeminfo, set), also PowerShell scripts [9]|Discovery|\n|Customized pwdump [3]|Windows Password Dumper|Unmodified version openly available|Standard version of pwdump or mimikatz|Credential Access|\n|Customized Mimikatz|Windows Password Dumper|Unmodified version openly available|Standard version of mimikatz [10]|Credential Access|\n|Keylogger [3]|Keylogger|Custom|Numerous publicly available keyloggers|Collection, Credential Access|\n|RemoteCMD [3]|Remote Execution|Custom|Operates similarly to PsExec [11]|Execution, Lateral Movement|\n|Dsquery|Information Discovery|Openly Available, default on Windows Server|A copy of Dsquery can be brought onto a system if it doesn’t have it by default.|Discovery|\n|ChromePass [3]|Browser Password Dumper|Openly Available|ChromePass [12] is a publicly available program from NirSoft|Credential Access, Collection|\n\n\n2 3\n\n\n-----\n\n|Lazagne [3]|Application Password Dumper|Openly Available|Lazagne [13] source code is freely available on Github|Credential Access|\n|---|---|---|---|---|\n|ScanBox [3]|ExploitKit/ Host Profiler, and JavaScript Keylogger|Custom|Used just before initial exploit, effectively out of scope since pre - initial network compromise.|N/A (Case could be made for “Collection” for Keylogger part however)|\n\n\n### 2.2 APT3 Tool Functionality\n\nAPT3’s custom tools provide a breadth of functionality. This section aims to break down these\ncustom tools from the table above a bit further into their specific functions and show how they\nrelate to ATT&CK, Windows utilities, and toolkits that are open source and commercially\navailable.\n\n#### 2.2.1 Pirpi Functions\n\n**Table 2 Pirpi Functions and Emulation**\n**Pirpi Function Windows** **Cobalt** **Metasploit/Meterpreter ATT&CK**\n\n**Built-in** **Strike/Beacon** **Technique**\n\n**List processes** tasklist ps, shell ps [T1057 - Process](https://attack.mitre.org/wiki/Technique/T1057)\nqprocess * [Discovery](https://attack.mitre.org/wiki/Technique/T1057)\n\n**Download file** ftp download Download [filename] T1041 \n[filename] [Exfiltration over](https://attack.mitre.org/wiki/Technique/T1041)\n\n[Command and](https://attack.mitre.org/wiki/Technique/T1041)\n[Control Channel](https://attack.mitre.org/wiki/Technique/T1041)\n\n**Execute file** cmd.exe /c shell Execute –f [filename] [– T1059 file.exe [filename] i] [-H] [Command-Line](https://attack.mitre.org/wiki/Technique/T1059)\n\nshell cmd.exe [Interface](https://attack.mitre.org/wiki/Technique/T1059)\n/c [filename]\n\n**Load/execute** Rundll32.exe shell rundll32 post/windows/manage/ [T1085 - Rundll32](https://attack.mitre.org/wiki/Technique/T1085)\n**DLL (from** [filename.dll], [filename.dll], reflective_dll_inject\n**disk)** entry entry\n\n**Load/execute** post/windows/manage/\n**DLL (from** reflective_dll_inject\n**memory)**\n\n2 4\n\n|Pirpi Function|Windows Built-in|Cobalt Strike/Beacon|Metasploit/Meterpreter|ATT&CK Technique|\n|---|---|---|---|---|\n|List processes|tasklist|ps, shell qprocess *|ps|T1057 - Process Discovery|\n|Download file|ftp|download [filename]|Download [filename]|T1041 - Exfiltration over Command and Control Channel|\n|Execute file|cmd.exe /c file.exe|shell [filename] shell cmd.exe /c [filename]|Execute –f [filename] [– i] [-H]|T1059 - Command-Line Interface|\n|Load/execute DLL (from disk)|Rundll32.exe [filename.dll], entry|shell rundll32 [filename.dll], entry|post/windows/manage/ reflective_dll_inject|T1085 - Rundll32|\n|Load/execute DLL (from memory)|||post/windows/manage/ reflective_dll_inject||\n\n\n-----\n\n|List servers in domain|net group “Domain Computers” /domain|shell net group “Domain Computers” /domain|post/windows/gather/ enum_ad_computers|T1018 - Remote System Discovery|\n|---|---|---|---|---|\n|List TCP connections|Netstat -ano|shell netstat - ano|post/windows/gather/ tcpnetstat|T1049 - System Network Connections Discovery|\n|List connected users|Net session|shell net session|post/windows/gather/ enum_logged_on_users|T1049 - System Network Connections Discovery|\n|List domain controllers|Net group “Domain Controllers” /domain, Nltest /dclist|shell net group “Domain Controllers” /domain, shell nltest /dclist, net dclist||T1049 - Remote System Discovery|\n|List directories|Dir, tree|shell dir|ls|T1083 - File and Directory Discovery|\n|Terminate Process|Taskkill|shell taskkill /pid [pid]|kill [pid]||\n|Delete file|Del [filename]|shell del [filename]|execute –f cmd.exe “del [filename]”|T1107 - File Deletion|\n|Sleep||sleep [time in seconds]|||\n|Get Network Adapter Info|Ipconfig /all, netsh config|shell ipconfig /all|execute –f cmd.exe “ipconfig /all”|T1016 - System Network Configuration Discovery|\n|Upload file|ftp|upload [filename]|upload [filename] [destination]|T1105 - Remote File Copy|\n\n\n2 5\n\n\n-----\n\n#### 2.2.2 PlugX Functions\n\n**Table 3 PlugX Functions and Emulation**\nNote: The PlugX table differs from the other tables in that each row refers to a module, not\nfunction, of PlugX. Modules within PlugX leverage other PlugX modules to perform functions,\nfor example, the Disk module allows other modules to use any of the functions it provides on the\ndisk, such as execute, create new files, copy, delete, etc..\n\n**PlugX** **Windows** **Cobalt** **Metasploit/** **ATT&CK**\n**Modules [8]** **Built-in** **Strike/Beacon** **Meterpreter** **Technique**\n\n**Disk** .\\[file], type shell execute -f cmd.exe “shell T1059 –\n\n[file], del, copy [file/type/del/c [file/type/del/copy]”, Command-Line\n\nopy], upload upload Interface,\n\nT1083 – File\nand Directory\nDiscovery\n\n**Process** Tasklist, ps, shell ps, Kill [pid] T1057 –\ntaskkill taskkill /pid Process\n\n[pid] Discovery\n\n**Service** sc shell sc execute –f cmd.exe “sc T1050 – New\n\n[query/start/sto [query/start/sto [query/start/stop/config/c Service, T1031\np/ p/ reate/delete]” – Modify\nconfig/create/ config/create/ Existing\ndelete] delete] Service, T1035\n\n– Service\nExecution\n\n**Regedit** regedit shell regedit reg T102 – Query\nRegistry, T1112\n– Modify\nRegistry\n\n**Netstat** netstat shell netstat post/windows/gather/tcpn T1049 – System\netstat Network\n\nConnections\nDiscovery\n\n**Nethood** net view shell net view execute -f cmd.exe “net T1018 –\n\n[/domain] [/domain] view [/domain]” Remote System\n\nDiscovery\n\n**Option** shutdown shell shutdown execute -f cmd.exe N/A\n\n[/l,/r,/t] [/l,/r/t] “shutdown [/l,/r,/t]”\n\n2 6\n\n|PlugX Windows Cobalt Metasploit/ ATT&CK Modules [8] Built-in Strike/Beacon Meterpreter Technique|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|Disk|.\\[file], type [file], del, copy|shell [file/type/del/c opy], upload|execute -f cmd.exe “shell [file/type/del/copy]”, upload|T1059 – Command-Line Interface, T1083 – File and Directory Discovery|\n|Process|Tasklist, taskkill|ps, shell taskkill /pid [pid]|ps, Kill [pid]|T1057 – Process Discovery|\n|Service|sc [query/start/sto p/ config/create/ delete]|shell sc [query/start/sto p/ config/create/ delete]|execute –f cmd.exe “sc [query/start/stop/config/c reate/delete]”|T1050 – New Service, T1031 – Modify Existing Service, T1035 – Service Execution|\n|Regedit|regedit|shell regedit|reg|T102 – Query Registry, T1112 – Modify Registry|\n|Netstat|netstat|shell netstat|post/windows/gather/tcpn etstat|T1049 – System Network Connections Discovery|\n|Nethood|net view [/domain]|shell net view [/domain]|execute -f cmd.exe “net view [/domain]”|T1018 – Remote System Discovery|\n|Option|shutdown [/l,/r,/t]|shell shutdown [/l,/r/t]|execute -f cmd.exe “shutdown [/l,/r,/t]”|N/A|\n\n\n-----\n\n|PortMap|Details still N/A.|Details still N/A.|Details still N/A.|Details still N/A.|\n|---|---|---|---|---|\n|Screen|PrintScreen key if GUI available|screenshot PID [x64]|migrate PID | use espia | screengrab|T1113 – Screen Capture|\n|Shell|cmd.exe /c [command]|shell [command]|shell or “execute -f cmd.exe -c -I”|T1059 – Command-Line Interface|\n|Telnet|pkgmgr /iu:”TelnetServ er”*|shell pkgmgr /iu:”TelnetServ er”|run metsvc|T1050 – New Service, T1108 Redundant Access|\n|SQL|Osql**|shell osql|auxiliary/admin/mssql/m ssql_sql|N/A|\n|Keylog|N/A|keylogger [pid] [x86|x64]|Keyscan_start, keyscan_dump|T1056 – Input Capture|\n\n\n*Note: pkgmgr has been archived and may not be on newer Windows systems.\n\n**Note: osql is usually found on Windows Server systems and will be replaced with sqlcmd\ninstead.\n\n#### 2.2.3 OSInfo Functions\n\n**Table 4 OSInfo Functionality and Emulation**\n**OSInfo** **Windows** **Cobalt** **Metasploit/Meterpreter** **ATT&CK**\n**Function** **Built-in** **Strike/Beacon** **Technique**\n\nDomain Ipconfig, Shell ipconfig ipconfig [T1016 - System](https://attack.mitre.org/wiki/Technique/T1016)\nwhoami, [Network](https://attack.mitre.org/wiki/Technique/T1016)\nnet config [Configuration](https://attack.mitre.org/wiki/Technique/T1016)\nworkstation [Discovery](https://attack.mitre.org/wiki/Technique/T1016)\n\nOsinfo systeminfo, systemprofiler Sysinfo, get_env.rb, run [T1082 - System](https://attack.mitre.org/wiki/Technique/T1082)\nver, set winenum [Information](https://attack.mitre.org/wiki/Technique/T1082)\n\n[Discovery](https://attack.mitre.org/wiki/Technique/T1082)\n\nTsinfo Reg query Shell reg Reg (built into meterpreter, [T1012 - Query](https://attack.mitre.org/wiki/Technique/T1012)\nquery not windows reg) [Registry](https://attack.mitre.org/wiki/Technique/T1012)\n\nNetuseinfo net use Shell net use Enum_shares.rb [T1049 - System](https://attack.mitre.org/wiki/Technique/T1049)\n[Network](https://attack.mitre.org/wiki/Technique/T1049)\n[Connections](https://attack.mitre.org/wiki/Technique/T1049)\n[Discovery](https://attack.mitre.org/wiki/Technique/T1049)\n\n2 7\n\n|OSInfo Function|Windows Built-in|Cobalt Strike/Beacon|Metasploit/Meterpreter|ATT&CK Technique|\n|---|---|---|---|---|\n|Domain|Ipconfig, whoami, net config workstation|Shell ipconfig|ipconfig|T1016 - System Network Configuration Discovery|\n|Osinfo|systeminfo, ver, set|systemprofiler|Sysinfo, get_env.rb, run winenum|T1082 - System Information Discovery|\n|Tsinfo|Reg query|Shell reg query|Reg (built into meterpreter, not windows reg)|T1012 - Query Registry|\n|Netuseinfo|net use|Shell net use|Enum_shares.rb|T1049 - System Network Connections Discovery|\n\n\n-----\n\n|ShareInfo|net share, net view|Shell net share|Enum_shares.rb, auxiliary/scanner/smb/ smb_enumshares|T1135 - Network Share Discovery|\n|---|---|---|---|---|\n|Connect Test|ping|Shell ping|Netenum.rb|T1018 - Remote System Discovery|\n|Local Group User Info|net user, net localgroup|Net localgroup, shell net user|Post/windows/gather/ enum_domain_tokens, auxiliary/scanner/smb/ smb_enumusers|T1087 - Account Discovery, T1069 - Permission Groups Discovery|\n|Global Group User Info|net user, net group|Net group, shell net user|Domain_list_gen.rb, post/windows/gather enum_domain_group_users, auxiliary/scanner/smb/ smb_enumusers|T1087 - Account Discovery, T1069 - Permission Groups Discovery|\n|Group Administrators|net localgroup, net group|Net localgroup, net group|Domain_list_gen.rb, post/windows/gather enum_domain_group_users, auxiliary/scanner/smb/ smb_enumusers|T1087 - Account Discovery, T1069 - Permission Groups Discovery|\n|Group Power Users|net localgroup, net group|Net localgroup, net group|Domain_list_gen.rb, post/windows/gather enum_domain_group_users, auxiliary/scanner/smb/ smb_enumusers|T1087 - Account Discovery, T1069 - Permission Groups Discovery|\n|Group Domain Admins|net localgroup, net group|Net localgroup, net group|Domain_list_gen.rb, post/windows/gather enum_domain_group_users, auxiliary/scanner/smb/ smb_enumusers|T1087 - Account Discovery, T1069 - Permission Groups Discovery|\n\n\n2 8\n\n\n-----\n\n#### 2.2.4 Pwdump Functions\n\n**Table 5 Pwdump Functions and Emulation**\n**pwdump** **Cobalt Strike/Beacon** **Metasploit/Meterp** **ATT&CK Technique**\n**Function** **reter**\n\nDump creds Mimikatz !lsadump:sam Run hashdump, [T1003 - Credential](https://attack.mitre.org/wiki/Technique/T1003)\nfrom SAM hashdump [Dumping](https://attack.mitre.org/wiki/Technique/T1003)\n\nInject into Logonpasswords, [Mimikatz’s wdigest T1003 -Credential](https://attack.mitre.org/wiki/Technique/T1003)\nLSASS hashdump, mimikatz [Dumping](https://attack.mitre.org/wiki/Technique/T1003)\n\n#### 2.2.5 Mimikatz Functions\n\n**Table 6 Mimikatz Functions and Emulation**\n**Mimikatz** **Cobalt Strike/Beacon** **Metasploit/Meterpreter ATT&CK Technique**\n**Function**\n\nDump creds Mimikatz !lsadump:sam Run hashdump, [T1003 - Credential](https://attack.mitre.org/wiki/Technique/T1003)\nfrom SAM hashdump [Dumping](https://attack.mitre.org/wiki/Technique/T1003)\n\nInject into Logonpasswords, Mimikatz’s wdigest [T1003 -Credential](https://attack.mitre.org/wiki/Technique/T1003)\nLSASS hashdump, mimikatz [Dumping](https://attack.mitre.org/wiki/Technique/T1003)\n\n#### 2.2.6 RemoteCMD Functions\n\n**Table 7 RemoteCMD Functions and Emulation**\n**RemoteCMD** **Windows Built-in** **Other Tools** **ATT&CK Technique**\n**Function**\n\n**SMB Copy** net use, copy, xcopy, PsExec [T1105 - Remote File Copy](https://attack.mitre.org/wiki/Technique/T1105)\nexplorer.exe\n\n**Remote Service** sc PsExec [T1021 - Remote Services](https://attack.mitre.org/wiki/Technique/T1021)\n\n**Remote Schtasks** schtasks, at [T1053 - Scheduled Task](https://attack.mitre.org/wiki/Technique/T1053)\n\n#### 2.2.7 Dsquery Functions\n\n**Table 8 Dsquery Function and Emulation**\n**Dsquery** **Cobalt** **Metasploit/Meterpreter ATT&CK Technique**\n**Function** **Strike/Beacon**\n\nAccount and shell Dsquery* shell / dsquery [T1087 – Account](https://attack.mitre.org/wiki/Technique/T1087)\nPermission [Discovery, T1069 –](https://attack.mitre.org/wiki/Technique/T1087)\nGroups [Permission Groups](https://attack.mitre.org/wiki/Technique/T1069)\nDiscovery [Discovery](https://attack.mitre.org/wiki/Technique/T1069)\n\n- Note : Dsquery is found on Windows Server systems and may not be on all machines by\ndefault.\n\n2 9\n\n|pwdump Function|Cobalt Strike/Beacon|Metasploit/Meterp reter|ATT&CK Technique|\n|---|---|---|---|\n|Dump creds from SAM|Mimikatz !lsadump:sam|Run hashdump, hashdump|T1003 - Credential Dumping|\n|Inject into LSASS|Logonpasswords, hashdump, mimikatz|Mimikatz’s wdigest|T1003 -Credential Dumping|\n\n|Mimikatz Function|Cobalt Strike/Beacon|Metasploit/Meterpreter|ATT&CK Technique|\n|---|---|---|---|\n|Dump creds from SAM|Mimikatz !lsadump:sam|Run hashdump, hashdump|T1003 - Credential Dumping|\n|Inject into LSASS|Logonpasswords, hashdump, mimikatz|Mimikatz’s wdigest|T1003 -Credential Dumping|\n\n|RemoteCMD Function|Windows Built-in|Other Tools|ATT&CK Technique|\n|---|---|---|---|\n|SMB Copy|net use, copy, xcopy, explorer.exe|PsExec|T1105 - Remote File Copy|\n|Remote Service|sc|PsExec|T1021 - Remote Services|\n|Remote Schtasks|schtasks, at||T1053 - Scheduled Task|\n\n|Dsquery Function|Cobalt Strike/Beacon|Metasploit/Meterpreter|ATT&CK Technique|\n|---|---|---|---|\n|Account and Permission Groups Discovery|shell Dsquery*|shell / dsquery|T1087 – Account Discovery, T1069 – Permission Groups Discovery|\n\n\n-----\n\n#### 2.2.8 LaZagne Functions\n\n**Table 9 LaZagne Functions and Emulation**\n**LaZagne Function Cobalt** **Metasploit/Meterpreter** **ATT&CK**\n\n**Strike/Beacon** **Technique**\n\nGather credentials Post/windows/gather/credentials/ [T1081 - Credentials](https://attack.mitre.org/wiki/Technique/T1081)\nfrom browsers, IM credential_collector, [in Files, T1003 –](https://attack.mitre.org/wiki/Technique/T1081)\nsoftware, [Credential](https://attack.mitre.org/wiki/Technique/T1003)\n\nPost/multi/gather/firefox_creds\n\ndatabases, memory, [Dumping](https://attack.mitre.org/wiki/Technique/T1003)\nand other software\n\n#### 2.2.9 ScanBox Functions\n\n**Table 10 ScanBox Functions and Emulation**\n**ScanBox Function** **Function Notes** **Emulation Notes**\n\nExploitKit-style recon Software, browser plugins, flash, N/A since this is used before\nand profiling SharePoint, Adobe PDF reader, initial compromise.\n\nChrome security plugins, Java,\nInternal IP address\n\nKeylogger Written in JavaScript, only logs N/A since this is used before\nwhat’s typed while on the page initial compromise.\nthat loads the keylogger JS.\n\n## Emulation Phases\n\nAPT3 disseminates spam-like phishing campaigns with various payload delivery methods [1].\nOnce on a machine, the actors collect information about the victim such as connected users [14]\nand analyze it for its value, trying to determine where they landed and what access they have.\nAdmin access is an obvious main target due to the increased access it will likely provide. The\nactors then drop multiple backdoors, usually 2-4 on the initial system and 5+ versions within the\n[first few hops, with independent C2 profiles for redundancy [Redundant Access – T1108]. Next](https://attack.mitre.org/wiki/Technique/T1108)\nthey then dump as many credentials as possible, and quickly continue spreading throughout the\nnetwork. They specifically go after file servers and print servers [1] [3]. Once they’re moved to\nall the machines they think have value, they collect all the documents they want, package them\nup and password protect them, and exfiltrate them out of the organization [15]. In some cases,\nhowever, they’ve been known to persist within a network for very lengthy periods without ever\nexfiltrating data.\n\nThe sections below show how APT3 acts through their entire lifecycle. Phase 1 documents what\nhappens during initial compromise, phase 2 highlights techniques used during network\npropagation, and phase 3 documents one way they have been known to perform exfiltration.\n\n3 10\n\n|LaZagne Function|Cobalt Strike/Beacon|Metasploit/Meterpreter|ATT&CK Technique|\n|---|---|---|---|\n|Gather credentials from browsers, IM software, databases, memory, and other software||Post/windows/gather/credentials/ credential_collector, Post/multi/gather/firefox_creds|T1081 - Credentials in Files, T1003 – Credential Dumping|\n\n|ScanBox Function|Function Notes|Emulation Notes|\n|---|---|---|\n|ExploitKit-style recon and profiling|Software, browser plugins, flash, SharePoint, Adobe PDF reader, Chrome security plugins, Java, Internal IP address|N/A since this is used before initial compromise.|\n|Keylogger|Written in JavaScript, only logs what’s typed while on the page that loads the keylogger JS.|N/A since this is used before initial compromise.|\n\n\n-----\n\n### 3.1 Phase 1 – Initial Compromise\n\nThe goal of the Initial Compromise phase is to achieve successful code execution and control of\na system within the target environment.\n\nAPT3 primarily conducts initial compromise using spear phishing, delivering implants through\nboth malicious attachments and malicious links. They have used new 0-days on multiple\nbrowsers [15]. They have targeted existing 0-days in Internet Explorer [2], Windows [2], and\nFlash [14]. They have also been known to compromise weakly secured legitimate websites to\nwhich users are directed through spear phishing emails [16].\n\n#### 3.1.1 Implant Command and Control\n\nAPT3 implants issue command and control (C2) traffic as HTTP GET requests that beacon at set\nintervals [14]. The HTTP Cookie field contains information for the C2 server, which responds\nwith a webpage that contains the command encoded within a specific HTML tag [15]. APT3\nimplants have also been known to use custom binary protocols [2]. Pirpi.2014 and Pirpi.2015\nboth contain several kinds of sleep and anti-sandbox strategies that cause the RAT to pause\nbetween executions [15]. Some of the Pirpi instances have been known to also use SSL for their\ncommunications and even include public/private keys within the binaries [17]. This level of C2\ncustomization can be achieved with Cobalt Strike’s malleable C2 profiles, as seen in the\naccompanying Malleable C2 profile modeled on [14].\n\n#### 3.1.2 Defense Evasion\n\nMany of APT3’s open source tools are customized or modified to prevent detection.\nAdditionally, APT3’s malware uses a series of anti-disassembly techniques [3], including\nrequiring certain command line parameters to run [17]. These are defense evasion techniques that\nAPT3 sets up before getting initial access to the target environment.\n\n_It is recommended to use anti-antivirus (AV) capabilities to prevent AV detection of commonly_\n_available tools. If Sandboxing is a problem, possibly encrypt tools to bypass sandboxing. An_\n_[example of this would be Veil-Evasion [18] or Artifact Kit [19]. ATTACK techniques: T1027 –](https://attack.mitre.org/wiki/Technique/T1027)_\n[Obfuscated Files or Information, T1045 – Software Packing, T1066 – Indicator Removal from](https://attack.mitre.org/wiki/Technique/T1027)\n[Tools.](https://attack.mitre.org/wiki/Technique/T1066)\n\n#### 3.1.3 Initial Access\n\n_For Initial Compromise, both web server drive-by and malicious attachments are within APT3’s_\n_tradecraft. The Social Engineering Toolkit (free) [20] and Cobalt Strike (paid) [6] have features_\n_that support these methods._\n\n**3.1.3.1** **Case 1 – Spear Phishing with Browser Exploit [2]**\n\nIn late November 2014 an APT3 campaign used a spear phishing email (see Appendix A)\ncontaining a link to a malicious site. The site contained JavaScript that triggered CVE-2014-6332\n(an Internet Explorer exploit [21]) which launched a VBscript and PowerShell based payload.\nThe PowerShell script in turn downloaded and ran a stager which dropped two files, “doc.exe”\n\n3 11\n\n\n-----\n\nand “test.exe”. “doc.exe” attempts to trigger CVE-2014-4113 (a Windows Kernel exploit [22])\nand run “test.exe” with the resultant elevated privileges. “test.exe” runs two commands:\n\n```\ncmd.exe /C whoami\n\n```\n```\nschtasks /create /tn \"mysc\" /tr C:\\Users\\Public\\test.exe /sc ONLOGON /ru \"System\" \n\n```\n\n_The first command is used to check that the process is running as SYSTEM. The second_\n_establishes persistence via Schtasks._\n\nIn addition, the implant connected to a command and control server over port 1913 using the\nSOCKS5 protocol. This dropper supports writing to or executing files at the following locations:\n\n```\nC:\\Users\\[Username]\\AppData\\Local\\Temp\\notepad1.exe\n\n```\n```\nC:\\Users\\[Username]\\AppData\\Local\\Temp\\notepad.exe\n\n```\n```\nC:\\Users\\[Username]\\AppData\\Local\\Temp\\notepad2.exe\n\n```\n```\nC:\\Users\\[Username]\\AppData\\Local\\Temp\\newnotepad.exe\n\n```\n\n[In addition, the software supports exfiltrating the file written at the following location [T1074 –](https://attack.mitre.org/wiki/Technique/T1074)\n[Data Staged]:](https://attack.mitre.org/wiki/Technique/T1074)\n\n```\nC:\\Users\\[Username]\\AppData\\Local\\Temp\\note.txt\n\n```\n\nIn October 2014, a downloader like “test.exe” was observed to download Pirpi.\n\n**3.1.3.2** **Spear Phishing with Malicious RAR Attachment [3]**\n\nIn attacks dating late 2015 to early 2016 APT3 has been known to use a zip archive containing a\nWindows shortcut file with an Internet Explorer logo. Clicking on this link led to a download of\nAPT3’s Pirpi RAT.\n\n**3.1.3.3** **Spear Phishing with Malicious RAR Attachment [7]**\n\nIn attacks reported in June 2014, APT3 actors sent a RAR archive as an email attachment. It\ncontained a resume and program purported to be written by the job candidate. The program,\nttcalc.exe, contained a legitimate version of TTCalc but also dropped Pirpi to:\n\n```\n%USERPROFILE%/Application Data/mt.dat\n\n```\n\n[And a bat file that was saved at [T1064 – Scripting]:](https://attack.mitre.org/wiki/Technique/T1064)\n\n```\n%USERPROFILE%/Start Menu/Programs/Startup/vc.bat\n\n```\n\nThe bat file contained the following script:\n\n```\n@echo off\n\n```\n```\ncmd.exe /C start rundll32.exe \"C:\\Documents and Settings\\admin\\Application\nData\\mt.dat\" UpdvaMt\n\n```\nThe bat file will be triggered when the user logged in and would have caused Pirpi to start with\n[rundll32 [T1085 – Rundll32].](https://attack.mitre.org/wiki/Technique/T1085)\n\n3 12\n\n\n-----\n\n**3.1.3.4** **Spear Phishing with Malicious RAR Attachment [7]**\n\nReported in June 2014, APT3 actors sent an encrypted self-extracting RAR attachment. The\nRAR contained a trojanized setup program which attempts to drop and run ttcalcBAK.exe\nanother self-extracting RAR which drops a DLL version of the PlugX RAT at:\n\n```\n%ALLUSERSPROFILE%\\chrome_frame_helper\n\n```\n\n[The RAT is loaded via DLL side-loading with a valid version of Chrome [T1073 – DLL Side-](https://attack.mitre.org/wiki/Technique/T1073)\n[Loading].](https://attack.mitre.org/wiki/Technique/T1073)\n\n**3.1.3.5** **Flash Exploit with Malware Concealed Within GIF [14]**\n\nReported in 2015, two different APT3 campaigns targeted Flash exploits, CVE-2014-1776 and\nCVE-2015-3113. In both cases the Flash exploit loaded the payload (the Pirpi RAT) from\nspecially crafted GIF images.\n\n**3.1.3.6** **Victim Profiling [16]**\n\nReported in July 2015, APT3 used spear phising to direct targets to a compromised site. This site\nhad ScanBox installed which was used to profile the victims and in some cases, deliver exploits\nto selected victims.\n\n### 3.2 Phase 2 - Network Propagation\n\nThe goal of the Network Propagation phase is to identify and move to desired systems within the\ntarget environment with the intention of discovering credentials and documents for exfiltration.\n\n_Publicly reported direct observation of APT3’s Network Propagation techniques is almost non-_\n_existent. One report that discusses general characteristics of APT3 is [23], but it is uncertain_\n_what data sources were used to compile the listed TTPs. Aside from that report we draw_\n_conclusions of how APT3 operates based on_ _the capabilities of Pirpi and other tools that they_\n_are reported to use. There are some persistence techniques that they have used during Initial_\n_Compromise that can be applied to Network Propagation. Despite this, there are significant_\n_gaps in the public knowledge of APT3’s tradecraft. Where necessary we fill in details with best_\n_guesses or recommendations._\n\nThe process within this phase can be described with the below diagram. Each step within this\nphase is broken out by ATT&CK tactic and the corresponding APT3 specific techniques\ndocumented in reports. A command-line reference for emulating the specific ATT&CK\ntechniques with built-in Windows utilities, Cobalt Strike, and Metasploit can be found in the\naccompanying “APT3 Adversary Emulation Field Manual”.\n\n3 13\n\n\n-----\n\n**Figure 2 APT3 Phase 2 Flow Chart**\n\n#### 3.2.1 Host Operations\n\n**3.2.1.1** **Discovery**\n\nAPT3 can perform discovery with its OSInfo tool and by running built-in Windows utilities on\nthe command-line using cmd.exe. Based on the commands available in APT3’s toolset, there is a\nlot of time spent enumerating domain groups with elevated permissions like “Domain Admins”,\n[“Enterprise Admins”, and “Power Users” [T1069 - Permission Groups Discovery]. There’s also](https://attack.mitre.org/wiki/Technique/T1069)\na heavy emphasis on enumerating users in these special groups with the “net user” command\n\n[[T1087 – Account Discovery].](https://attack.mitre.org/wiki/Technique/T1087)\n\n3 14\n\n\n-----\n\n_When doing discovery, certain actions are very closely intertwined_\n_(as shown grouped together in the above diagram). Querying the_\n_[domain for the “Domain Admins” group [T1069 – Permission](https://attack.mitre.org/wiki/Technique/T1069)_\n[Groups Discovery] returns the users that are members of that](https://attack.mitre.org/wiki/Technique/T1069)\n_group, which then involves looking up those users to see if they’re_\n_[part of any other interesting groups [T1087 – Account Discovery].](https://attack.mitre.org/wiki/Technique/T1087)_\n_This process can repeat for a while as all interesting users and_\n_groups are enumerated. Similarly, querying systems for their_\n_[configuration [T1016 – System Network Configuration Discovery]](https://attack.mitre.org/wiki/Technique/T1016)_\n_[and their current network connections [T1049 – System Network](https://attack.mitre.org/wiki/Technique/T1049)_\n[Connections Discovery] are heavily integrated.](https://attack.mitre.org/wiki/Technique/T1049)\n\n\n**Figure 3 APT3 Discovery**\n\n**ATT&CK Techniques**\n\n\n**3.2.1.2** **Local Privilege Escalation**\n\nCredential dumping and persistence may require local privilege escalation if the attacker does\n\nnot have control of a high integrity process; however, the\nonly reporting available on local privilege escalation\nmethods used by APT3 is CVE-2014-4113 [2]. It is\npossible that their strong reliance on credential access\n(detailed later) allows them to use credentials with\nincreasing levels of access in place of other local\nprivilege escalation mechanisms. Their perceived focus\nduring this phase, however, is on finding credentials that\nallow direct admin permissions. In this case, control falls\nthrough to credential access or persistence.\n\n**Figure 4 APT3 Privilege Escalation**\n\n**ATT&CK Techniques** _During an engagement, adversary emulators may find it_\n\n_necessary to perform local privilege escalation due to_\n_time constraints. Most common frameworks (including Metasploit and Cobalt Strike) contain_\n_some methods for privilege escalation. Also, UACBypass [24] and PowerUp [9] are common and_\n_freely available tools that may be used to perform Privilege Escalation._\n\n3 15\n\n\n-----\n\n**3.2.1.3** **Persistence**\n\n\nAPT3 has used multiple methods for persistence: creating a\n[service [23] (T1050 - New Service), creating a scheduled task](https://attack.mitre.org/wiki/Technique/T1050)\n\n[2] (T1053 - Scheduled Task), and also by placing scripts in the\n[Startup Folder [7] [T1060 - Registry Run Keys/Start Folder].](https://attack.mitre.org/wiki/Technique/T1060)\n\nAPT3 has replaced the Sticky Keys binary\n[(C:\\Windows\\System32\\sethc.exe) with cmd.exe [T1015 -](https://attack.mitre.org/wiki/Technique/T1015)\n[Accessibility Features] and enabled Remote Desktop Protocol](https://attack.mitre.org/wiki/Technique/T1015)\n[(RDP) if it is not already enabled [T1076 – Remote Desktop](https://attack.mitre.org/wiki/Technique/T1076)\n[Protocol]. This specific Persistence technique has an added](https://attack.mitre.org/wiki/Technique/T1076)\nbenefit of allowing an operator to open a command prompt\nwhen connected over RDP without having to provide valid\ncredentials [23].\n\nAPT3 has been known to create or enable accounts, for\nexample “support_388945a0”, and add them to the local admin\n[group [23] [T1136 – Create Account]. Presumably this is done](https://attack.mitre.org/wiki/Technique/T1136)\nfor easier future access.\n\n**Figure 5 APT3**\n**Persistence ATT&CK**\n\n_Recommendation: On new hosts, establish persistence by creating a_\n\n**Techniques**\n\n_service or schtasks. On systems where RDP capabilities are desired,_\n_it might also be useful to enable sticky keys and RDP._\n\n\n**3.2.1.4** **Credential Access**\n\n\n**Figure 6 APT3 Credential Access**\n\n**ATT&CK Techniques**\n\n\nAPT3 uses many forms of credential access. They used\ncustomized versions of pwdump, and later a custom\ncompiled version of mimikatz, to search for cached\n[Windows credentials [T1003 - Credential Dumping] as well](https://attack.mitre.org/wiki/Technique/T1003)\n[as ChromePass and Lazagne [(T1081 - Credentials in](https://attack.mitre.org/wiki/Technique/T1081)\n[Files], to search though browser and other credential](https://attack.mitre.org/wiki/Technique/T1081)\ncaches. Their pwdump tool injects itself into lsass.exe and\nis executed by running the GetHash export of the\nlsremora.dll [3] Mimikatz is used to dump plaintext\n[credentials by injecting into lsass.exe. [T1003 - Credential](https://attack.mitre.org/wiki/Technique/T1003)\n[Dumping].](https://attack.mitre.org/wiki/Technique/T1003)\n\nThey also install a keylogger, which can be used to\n[discover credentials and remote systems [T1056 - Input](https://attack.mitre.org/wiki/Technique/T1056)\n[Capture]. This keylogger installs itself as a service and](https://attack.mitre.org/wiki/Technique/T1056)\nrecords keystrokes in encrypted files such as\n[thumbcache_96.dbx [T1027 – Obfuscated Files or](https://attack.mitre.org/wiki/Technique/T1027)\n[Information] [3].](https://attack.mitre.org/wiki/Technique/T1027)\n\n3 16\n\n\n-----\n\n#### 3.2.2 Lateral Movement\n\n\nThough publicly reported information on how APT3\nenumerates machines aside from related commands in\nAPT3’s tools, they’ve been known to use “net view” and\ndsquery to do so. This may be due to a lack of available\ninformation on how APT3 operates during an operation\nsince most reports tend to be focused on forensic\ninformation. Pirpi has commands that list servers in the\ndomain, list TCP connections and retrieve connected users\n(T1049 - Network Connections Discovery), and list Domain\nControllers (T1018 - Remote System Discovery). Some of\nthis information may be used to identify target hosts for\nlateral movement. In addition to built-in Windows utilities,\nthere are some open source tools which collect similar\ninformation. APT3 will quickly spread to other machines as\nfast as possible, often checking for easy password reuse by\ntrying to mount shares from other machines via “net use”\n\n[[T1078 – Valid Accounts] [T1077 - Windows Admin](https://attack.mitre.org/wiki/Technique/T1078)\n[Shares] [T1110 – Brute Force].](https://attack.mitre.org/wiki/Technique/T1077)\n\n_APT3 prioritizes file and printer servers._\n\n**Remote Copy and Execution**\n\nAPT3 uses a custom tool called RemoteCMD that can run\ncommands on a remote system. It’s not clear what\nprotocol(s) are being used, but RemoteCMD supports file\n\n**Figure 7 APT3 Lateral Movement**\n\noperations (upload, download, delete and rename) service\n\n**and Execution ATT&CK Techniques**\n\noperations (creation, deletion, start and stop) and scheduled\ntasks (AT,schtasks). Presumably these are done over SMB (files), Remote Service (services) and\nRemote Schtasks (AT).\n\n### 3.3 Phase 3 - Exfiltration\n\n_It’s likely that APT3 will compromise a_\n_network to a certain degree of satisfaction_\n_before starting to exfil, due to stealth_\n_concerns. Depending on the defensive setup,_\n_exfiltration could be much noisier and_\n_noticeable than attempting to hide in the_\n_noise with lay-of-the-land tools._\n\n\nThe only source we were able to find for\nAPT3 exfiltration methods is from 2012. For\nexfiltration, they will identify Office\n[documents on the computer [23] [T1005 -](https://attack.mitre.org/wiki/Technique/T1005)\n\n**Figure 8 APT3 Exfiltration ATT&CK Techniques** [Data from Local System]. They then drop the](https://attack.mitre.org/wiki/Technique/T1005)\n\ncommand-line Chinese language version of\n[WinRAR and use it to compress and encrypt the discovered documents [T1002 - Data](https://attack.mitre.org/wiki/Technique/T1110)\n\n3 17\n\n\n-----\n\n[Compressed]. This archive will then be stored in the recycle bin [23], usually on a machine](https://attack.mitre.org/wiki/Technique/T1110)\n[designated as a staging server, which they move the exfiltration through [T1074 - Data Staged].](https://attack.mitre.org/wiki/Technique/T1074)\nData is exfiltrated over port 443 which is typically HTTPS traffic, however they have used SSL\n[encryption [17] and normal HTTP [23] [T1043 - Commonly Used Port] .](https://attack.mitre.org/wiki/Technique/T1043)\n\n3 18\n\n\n-----\n\n## Bibliography\n\n[1] [Online]. Available: https://www.fireeye.com/blog/threat-research/2015/06/operation\nclandestine-wolf-adobe-flash-zero-day.html.\n\n[2] [Online]. Available: https://www.fireeye.com/blog/threat\nresearch/2014/11/operation_doubletap.html.\n\n[3] [Online]. Available: https://www.symantec.com/connect/blogs/buckeye-cyberespionage\ngroup-shifts-gaze-us-hong-kong.\n\n[4] [Online]. Available: https://threatpost.com/emergency-adobe-flash-patch-fixes-zero-day\nunder-attack/113434/.\n\n[5] [Online]. Available: https://www.metasploit.com/.\n\n[6] [Online]. Available: https://www.cobaltstrike.com/.\n\n[7] [Online]. Available: https://www.fireeye.com/blog/threat-research/2014/06/clandestine\nfox-part-deux.html.\n\n[8] [Online]. Available: https://www.lastline.com/labsblog/an-analysis-of-plugx-malware/.\n\n[9] [Online]. Available: https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon.\n\n[10] [Online]. Available: https://github.com/gentilkiwi/mimikatz.\n\n[11] [Online]. Available: https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx.\n\n[12] [Online]. Available: http://www.nirsoft.net/utils/chromepass.html.\n\n[13] [Online]. Available: https://github.com/AlessandroZ/LaZagne.\n\n[14] [Online]. Available: http://researchcenter.paloaltonetworks.com/2015/07/ups-observations\non-cve-2015-3113-prior-zero-days-and-the-pirpi-payload/.\n\n[15] [Online]. Available: https://www.fireeye.com/blog/threat-research/2014/04/new-zero-day\nexploit-targeting-internet-explorer-versions-9-through-11-identified-in-targetedattacks.html.\n\n[16] [Online]. Available: http://pwc.blogs.com/cyber_security_updates/2015/07/pirpi\nscanbox.html.\n\n[17] [Online]. Available: https://recon.cx/2017/montreal/resources/slides/RECON-MTL-2017\nevolution_of_pirpi.pdf.\n\n[18] [Online]. Available: https://github.com/Veil-Framework.\n\n[19] [Online]. Available: https://www.cobaltstrike.com/help-artifact-kit.\n\n[20] [Online]. Available: https://github.com/trustedsec/social-engineer-toolkit/.\n\n[21] [Online]. Available: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6332.\n\n[22] [Online]. Available: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4113.\n\n[23] [Online]. Available: http://carnal0wnage.attackresearch.com/2012/09/more-on\naptsim.html.\n\n[24] [Online]. Available: https://github.com/hfiref0x/UACME.\n\n\n-----\n\nThis page intentionally left blank\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.09.XX.APT3_Adversary_Emulation_Plan/APT3_Adversary_Emulation_Plan.pdf"
    ],
    "report_names": [
        "APT3_Adversary_Emulation_Plan"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61c4ddc4-156b-4828-8570-0979da81f3d0",
            "created_at": "2022-10-25T16:47:55.593828Z",
            "updated_at": "2025-03-27T02:05:17.275161Z",
            "deleted_at": null,
            "main_name": "BRONZE MAYFAIR",
            "aliases": [
                "Gothic Panda ",
                "TG-0110 ",
                "APT3 "
            ],
            "source_name": "Secureworks:BRONZE MAYFAIR",
            "tools": [
                " HUC Proxy Malware (Htran)",
                " Pirpi",
                " SplitVPN",
                " ctt",
                " ctx",
                "Cookiecutter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1516100139,
    "ts_modification_date": 1516100139,
    "files": {
        "pdf": "https://archive.orkl.eu/12c62600afe97d1309bc920524391e9ab9f4b01e.pdf",
        "text": "https://archive.orkl.eu/12c62600afe97d1309bc920524391e9ab9f4b01e.txt",
        "img": "https://archive.orkl.eu/12c62600afe97d1309bc920524391e9ab9f4b01e.jpg"
    }
}