{
    "id": "139cade7-c994-47d9-9487-f423bec1ba5b",
    "created_at": "2023-01-12T14:59:05.177396Z",
    "updated_at": "2025-03-27T02:09:18.700778Z",
    "deleted_at": null,
    "sha1_hash": "95f473a4d00e324831f1822652ab1fbae64843b1",
    "title": "2020-12-15 - Tactics, Techniques, and Procedures (TTPs) Used in the SolarWinds Breach",
    "authors": "",
    "file_creation_date": "2022-05-29T10:38:42Z",
    "file_modification_date": "2022-05-29T10:38:42Z",
    "file_size": 1976696,
    "plain_text": "# Tactics, Techniques, and Procedures (TTPs) Used in the SolarWinds Breach\n\n**[picussecurity.com/resource/blog/ttps-used-in-the-solarwinds-breach](https://www.picussecurity.com/resource/blog/ttps-used-in-the-solarwinds-breach)**\n\n### Keep up to date with latest blog posts\n\n## EXECUTIVE SUMMARY\n\nSolarWinds announced on Sunday that the SolarWinds Orion Platform network monitoring\nproduct had been modified by a state-sponsored threat actor via embedding backdoor code\ninto a legitimate SolarWinds library. This leads to the attacker having remote access into the\nvictim’s environment and a foothold in the network, which can be used by the attacker to\nobtain privileged credentials. SolarWinds breach is also connected to the FireEye breach. In\nthis article, we analyzed tactics, techniques, and procedures utilized by threat actors of the\nSolarWinds incident to understand their attack methods and the impact of this breach.\n\n**Key Findings**\n\nIt is a global attack campaign that started in March 2020 and is ongoing.\nThe attack campaign has the potential to affect thousands of public and private\norganizations.\nThe attack started with a software supply chain compromise attack.\n\n\n-----\n\nThreat actors trojanized a component of the SolarWinds Orion Platform software,\ndubbed as SUNBURST by FireEye [1].\nThe backdoored version of the software was distributed via its automatic update\nmechanism.\nAttackers heavily used various defense evasion techniques such as masquerading,\ncode signing, obfuscated files or information, indicator removal on host, and\nvirtualization/sandbox evasion.\nThe threat actor leverages ten different MITRE ATT&CK tactics, including Lateral\nMovement, Command and Control, and Data Exfiltration.\nUsed techniques indicate that the threat actors are highly skilled.\n\n## Tactic, Techniques and Procedures used in SolarWinds Breach (Mapped to MITRE ATT&CK Framework)\n\nOur analysis uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge\n[(ATT&CK®) version 8.1 framework. See the ATT&CK for Enterprise version 8.1 for all](https://attack.mitre.org/techniques/enterprise/)\nreferenced threat actor tactics and techniques.\n\n## 1. Resource Development\n\n### 1.1. T1587.001 Develop Capabilities: Malware\n\nAdversaries create malware and malware components before compromising a victim, such\nas payloads, droppers, backdoors, and post-compromise tools [2]. They may create malware\nfrom scratch or use publicly available tools.\n\nIn the SolarWinds incident, attackers embedded their malicious payload on a legitimate\ncomponent of the SolarWinds Orion Platform software. This component is a DLL library,\nSolarWinds.Orion.Core.BusinessLayer.dll. FireEye named the backdoored version of the\nDLL file as SUNBURST [1]. The SUNBURST backdoor delivers different payloads, such as a\npreviously unseen memory-only dropper dubbed TEARDROP by FireEye [1]. The\nTEARDROP dropper deploys an infamous post-compromise tool, Cobalt Strike Beacon.\nApparently, attackers used Beacon in the FireEye breach and stole FireEye’s Red Team\ntools that include Beacon.\n\n### 1.2. T1583.003 Acquire Infrastructure: Virtual Private Server\n\nIn this MITRE ATT&CK technique, adversaries rent Virtual Private Servers (VPSs) that can\nbe used during the attack campaign [3]. According to the FireEye research, the threat actor\nleverages VPSs to use only IP addresses originating from the same country as the victim [1].\nFireEye has provided two Yara rules to detect TEARDROP available on GitHub [4].\n\n**2. Initial Access**\n\n\n-----\n\n### 2.1. T1195.002 Supply Chain Compromise: Compromise Software Supply Chain\n\nIn the software supply chain compromise attack technique, adversaries modify software prior\nto receipt by a final user by manipulating the software's:\n\nsource code\nsource code repositories (public or private)\nopen-source dependencies' source code\nbuild & distribution systems\nupdate mechanism\ndevelopment environment, or\ncompiled release [5]\n\nIn the SolarWinds Orion breach, adversaries embedded malicious code into a SolarWinds\nlibrary file, SolarWinds.Orion.Core.BusinessLayer.dll. According to SolarWinds security\nadvisory, attackers backdoored three versions of the Orion Platform software: 2019.4 HF 5,\n2020.2 with no hotfix, and 2020.2 HF 1 [6].\n\nHowever, it is not clear how attackers could tamper this file. According to Microsoft's\nresearch, adversaries might have compromised and manipulated build or distribution\n**systems and embedded malicious code [7]. Another claim is that attackers might have**\nuploaded the malicious DLL file to the source code repository of SolarWinds using leaked\nFTP credentials [8].\n\nThe backdoored SolarWinds Orion Platform software update file that includes the malicious\nDLL file was distributed via its automatic update mechanism.\n\nAs a countermeasure, check whether the manipulated\nSolarWinds.Orion.Core.BusinessLayer.dll file exists in the following locations:\n\n%PROGRAMFILES%\\SolarWinds\\Orion\\\n%WINDIR%\\System32\\config\\systemprofile\\AppData\\Local\\assembly\\tmp\\<random>\\\n\nIf the DLL has one of the following SHA256 hashes, it is a manipulated and malicious version\n\n[7]:\n\n32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\ndab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b\neb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed\nc09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77\nac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c\n019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134\nce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6\na25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc\n\n\n-----\n\nThen, scan the above folders with up-to-date antivirus products, and run EDRs to detect\nmaliciously tampered SolarWinds files and their (potentially) anomalous behavior.\n\n## 3. Execution\n\n### 3.1. T1569.002 System Services: Service Execution\n\nIn this MITRE ATT&CK technique, adversaries execute their malware as a Windows service\n\n[6]. During the installation of the SolarWinds application or update, the tampered DLL file is\nloaded by the legitimate SolarWinds.BusinessLayerHost.exe or\nSolarWinds.BusinessLayerHostx64.exe and installed as a Windows service.\n\n## 4. Persistence\n\n### 4.1. T1543.003 Create or Modify System Process: Windows Service\n\nAs part of persistence, adversaries can create or change Windows services to repeatedly\nexecute malicious payloads [4], [9]. When Windows boots up, the malicious code starts as a\nservice. The TEARDROP malware loaded by the modified DLL runs as a service in the\nbackground.\n\n## 5. Privilege Escalation\n\n### 5.1. T1078 Valid Accounts\n\nAccording to this MITRE ATT&CK technique, adversaries may obtain and abuse legitimate\ncredentials to gain Initial Access, Persistence, Privilege Escalation, Defense Evasion, or\nLateral Movement [10]. Threat actors use multiple valid accounts for lateral movement in this\nattack campaign [1].\n\n## 6. Defense Evasion\n\n### 6.1. T1553.002 Subvert Trust Controls: Code Signing\n\nTo bypass application control technologies, adversaries sign their malware with valid\nsignatures by creating, acquiring, or stealing code-signing materials [11].\n\nIn the SolarWinds incident, attackers have compromised digital certificates of SolarWinds.\n\nRemove compromised SolarWinds certificates:\n\n\n-----\n\n\"Signer\": \"Solarwinds Worldwide LLC\"\n\n\"SignerHash\": \"47d92d49e6f7f296260da1af355f941eb25360c4\"\n\n### 6.2. T1036.005 Masquerading: Match Legitimate Name or Location\n\nAs a defense evasion technique, adversaries change features of their malicious artifacts with\nlegitimate and trusted ones. Code signatures, names and location of malware files, names of\ntasks and services are some examples of these features. After masquerading, malicious\nartifacts of adversaries such as malware files appear legitimate to users and security controls\n\n[[12]. You can read our blog post to find out more information about the masquerading](https://www.picussecurity.com/resource/blog/picus-10-critical-mitre-attck-techniques-t1036-masquerading?hsLang=en-gb)\ntechnique.\n\nAccording to the FireEye report, the threat actor of the SolarWinds breach uses a legitimate\nhostname found within the victim’s environment as the hostname on their Command and\nControl (C2) infrastructure to avoid detection [1]. Moreover, the malware masquerades its\nC2 traffic as the Orion Improvement Program (OIP) protocol [1].\n\n### 6.3. T1036.003 Masquerading: Rename System Utilities\n\nTo avoid name-based detection, adversaries may rename system utilities. Moreover, the\nthreat actor replaces a legitimate utility with theirs, executes their payload, and then restores\nthe legitimate original file [1].\n\n### 6.4. T1036.004 Masquerading: Masquerade Task or Service\n\nAdversaries masquerade the name of a task/service with the name of a legitimate\ntask/service to make it appear benign and evade detection [12]. Adversaries commonly use\nidentical or similar names of legitimate tasks/services executed by the Windows Task\nScheduler, at (Linux and Windows), Windows services, and Linux systemd services.\n\n### 6.5. T1497.003 Virtualization/Sandbox Evasion: Time Based Evasion\n\nAdversaries employ various time-based evasion methods, such as delaying malware\nfunctionality upon initial execution, to avoid virtualization and analysis environments [13]. In\nthe Solarwinds case, attackers delay Command and Control communication two weeks after\nthe installation.\n\n### 6.6. T1027.003 Obfuscated Files or Information: Steganography\n\nIn this MITRE ATT&CK technique, adversaries hide data in digital media such as images,\naudio, video, and text to prevent the detection of hidden information [14]. The TEARDROP\nmalware used in the breach reads from the file gracious_truth.jpg that includes a malicious\npayload.\n\n\n-----\n\n**6.7. T1070.004 Indicator Removal on Host: File Deletion**\n\nAdversaries delete their malicious files to clear traces and minimize the adversary’s footprint\nto avoid detection and inspection [15]. The threat actor removes their malicious files,\nincluding backdoors, after the remote access [1].\n\n**7. Discovery**\n\n### 7.1. T1057 Process Discovery\n\nAdversaries obtain information about running processes on a system to understand common\nsoftware and applications running on systems within the network [16]. The threat actor gets a\nlist of processes to shape follow-on behaviors [1].\n\n### 7.2 T1012 Query Registry\n\nAdversaries query the Windows Registry to get information about the system, configuration,\nand installed software [17]. The threat actor obtains Cryptographic Machine GUID by\nquerying the value of MachineGuid in the\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography key to generate a unique\nuserID for each victim.\n\n**8. Lateral Movement**\n\n### 8.1. T1021 Remote Services\n\nIn this MITRE ATT&CK technique, adversaries use valid accounts to log into a remote\nservice, such as remote desktop protocol (RDP), SSH, and VNC. The threat actor uses valid\naccounts and legitimate remote access to move laterally in the target network.\n\n## 9. Command and Control\n\n### 9.1. T1071.001 Application Layer Protocol: Web Protocols\n\nAccording to this technique, adversaries communicate using application layer (L7) protocols\nand blend Command and Control traffic with existing web traffic to avoid detection and\nnetwork filtering [18]. The malware used in this breach utilizes:\n\nHTTP GET or HEAD requests when data is requested\nHTTP PUT or HTTP POST requests when data is sent [1].\n\nThe malicious DLL avsvmcloud.com domain to call out a remote network infrastructure [7].\nBlock this domain and check network connection logs.\n\n### 9.2. T1568.002 Dynamic Resolution: Domain Generation Algorithms\n\n\n-----\n\nAdversaries use Domain Generation Algorithms (DGAs) to dynamically generate a C2\ndomain rather than relying on a list of static IP addresses or domains [19]. The backdoor\nused in this attack campaign uses a DGA to determine its C2 server [1].\n\n## 10. Exfiltration\n\n### T1041 Exfiltration Over C2 Channel\n\nIn this MITRE ATT&CK technique, adversaries steal data by exfiltrating it over an existing C2\nchannel [20]. The threat actor uses HTTP PUT or HTTP POST requests when the collected\ndata is being exfiltrated to the C2 server [1]. If the payload is bigger than 10000 bytes; the\nPOST method is used. Otherwise, the PUT method is used.\n\n## References\n\n[1] FireEye, “Highly Evasive Attacker Leverages SolarWinds Supply Chain to Compromise\nMultiple Global Victims With SUNBURST Backdoor.” https://www.fireeye.com/blog/threat[research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\nsunburst-backdoor.html. [Accessed: 15-Dec-2020]\n\n[[2] “Develop Capabilities: Malware.” https://attack.mitre.org/techniques/T1587/001/.](https://attack.mitre.org/techniques/T1587/001/)\n\n[Accessed: 15-Dec-2020]\n\n[3] “Acquire Infrastructure: Virtual Private Server.”\n[https://attack.mitre.org/techniques/T1583/003/. [Accessed: 15-Dec-2020]](https://attack.mitre.org/techniques/T1583/003/)\n\n[4] fireeye, “fireeye/sunburst_countermeasures.”\n[https://github.com/fireeye/sunburst_countermeasures. [Accessed: 15-Dec-2020]](https://github.com/fireeye/sunburst_countermeasures)\n\n[5] “Supply Chain Compromise: Compromise Software Supply Chain.”\n[https://attack.mitre.org/techniques/T1195/002/.](https://attack.mitre.org/techniques/T1195/002/)\n\n[[6] “System Services: Service Execution.” https://attack.mitre.org/techniques/T1569/002/.](https://attack.mitre.org/techniques/T1569/002/)\n\n[7] msrc, “Customer Guidance on Recent Nation-State Cyber Attacks – Microsoft Security\nResponse Center.” https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-onrecent-nation-state-cyber-attacks.\n\n[8] “[No title].” [https://twitter.com/vinodsparrow/status/1338431183588188160?s=20.](https://twitter.com/vinodsparrow/status/1338431183588188160?s=20.)\n\n[9] “Create or Modify System Process: Windows Service.”\n[https://attack.mitre.org/techniques/T1543/003/.](https://attack.mitre.org/techniques/T1543/003/)\n\n[[10] “Valid Accounts.” https://attack.mitre.org/techniques/T1078/.](https://attack.mitre.org/techniques/T1078/)\n\n[[11] “Subvert Trust Controls: Code Signing.” https://attack.mitre.org/techniques/T1553/002/.](https://attack.mitre.org/techniques/T1553/002/)\n\n[12] “MITRE ATT&CK T1036 Masquerading.”\nhttps://www.picussecurity.com/resource/blog/picus-10-critical-mitre-attck-techniques-t1036masquerading.\n\n[13] “Virtualization/Sandbox Evasion: Time Based Evasion.”\n[https://attack.mitre.org/techniques/T1497/003/.](https://attack.mitre.org/techniques/T1497/003/)\n\n[14] “Obfuscated Files or Information: Steganography.”\n[https://attack mitre org/techniques/T1027/003/](https://attack.mitre.org/techniques/T1027/003/)\n\n\n-----\n\n[15] Indicator Removal on Host: File Deletion.\n[https://attack.mitre.org/techniques/T1070/004/.](https://attack.mitre.org/techniques/T1070/004/)\n\n[16] “Process Discovery.” [https://attack.mitre.org/techniques/T1057/.](https://attack.mitre.org/techniques/T1057/)\n\n[17] “Query Registry.” [https://attack.mitre.org/techniques/T1012/.](https://attack.mitre.org/techniques/T1012/)\n\n[18] “Application Layer Protocol: Web Protocols.”\n[https://attack.mitre.org/techniques/T1071/001/.](https://attack.mitre.org/techniques/T1071/001/)\n\n[19] “Dynamic Resolution: Domain Generation Algorithms.”\n[https://attack.mitre.org/techniques/T1568/002/.](https://attack.mitre.org/techniques/T1568/002/)\n\n[[20] “Exfiltration Over C2 Channel.” https://attack.mitre.org/techniques/T1041/.](https://attack.mitre.org/techniques/T1041/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-15 - Tactics, Techniques, and Procedures (TTPs) Used in the SolarWinds Breach.pdf"
    ],
    "report_names": [
        "2020-12-15 - Tactics, Techniques, and Procedures (TTPs) Used in the SolarWinds Breach.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535545,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653820722,
    "ts_modification_date": 1653820722,
    "files": {
        "pdf": "https://archive.orkl.eu/95f473a4d00e324831f1822652ab1fbae64843b1.pdf",
        "text": "https://archive.orkl.eu/95f473a4d00e324831f1822652ab1fbae64843b1.txt",
        "img": "https://archive.orkl.eu/95f473a4d00e324831f1822652ab1fbae64843b1.jpg"
    }
}