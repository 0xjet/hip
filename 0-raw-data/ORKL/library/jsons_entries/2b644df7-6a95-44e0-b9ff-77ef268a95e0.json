{
    "id": "2b644df7-6a95-44e0-b9ff-77ef268a95e0",
    "created_at": "2023-01-12T15:05:09.936182Z",
    "updated_at": "2025-03-27T02:05:56.697324Z",
    "deleted_at": null,
    "sha1_hash": "b74166d821acae67a61add74e328c297d1ab115b",
    "title": "2021-03-17 - Alert (AA21-076A)- TrickBot Malware",
    "authors": "",
    "file_creation_date": "2022-05-29T01:06:28Z",
    "file_modification_date": "2022-05-29T01:06:28Z",
    "file_size": 343615,
    "plain_text": "# Alert (AA21-076A)\n\n**us-cert.cisa.gov/ncas/alerts/aa21-076a**\n\n## Summary\n\n_This Joint Cybersecurity Advisory uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK®)_\n_[framework, Version 8. See the ATT&CK for Enterprise for all referenced threat actor tactics and techniques.](https://attack.mitre.org/versions/v8/techniques/enterprise/)_\n\nThe Cybersecurity and Infrastructure Security Agency (CISA) and Federal Bureau of Investigation (FBI) have observed\ncontinued targeting through spearphishing campaigns using TrickBot malware in North America. A sophisticated group of\ncybercrime actors is luring victims, via phishing emails, with a traffic infringement phishing scheme to download TrickBot.\n\nTrickBot—first identified in 2016—is a Trojan developed and operated by a sophisticated group of cybercrime actors.\nOriginally designed as a banking Trojan to steal financial data, TrickBot has evolved into highly modular, multi-stage malware\nthat provides its operators a full suite of tools to conduct a myriad of illegal cyber activities.\n\nTo secure against TrickBot, CISA and FBI recommend implementing the mitigation measures described in this Joint\nCybersecurity Advisory, which include blocking suspicious Internet Protocol addresses, using antivirus software, and\nproviding social engineering and phishing training to employees.\n\n[Click here for a PDF version of this report.](https://us-cert.cisa.gov/sites/default/files/publications/AA21-076A-TrickBot_Malware_508_0.pdf)\n\n## Technical Details\n\nTrickBot is an advanced Trojan that malicious actors spread primarily by spearphishing campaigns using tailored emails that\ncontain malicious attachments or links, which—if enabled—execute malware (Phishing: _Spearphishing Attachment_\n\n[[T1566.001], Phishing: Spearphishing Link](https://attack.mitre.org/versions/v8/techniques/T1566/001/) [[T1566.002]). CISA and FBI are aware of recent attacks that use phishing emails,](https://attack.mitre.org/versions/v8/techniques/T1566/002)\nclaiming to contain proof of a traffic violation, to steal sensitive information. The phishing emails contain links that redirect to a\nwebsite hosted on a compromised server that prompts the victim to click on photo proof of their traffic violation. (User\n_Execution: Malicious Link_ [[T1204.001], User Execution: Malicious File](https://attack.mitre.org/versions/v8/techniques/T1204/001/) [[T1204.002]). In clicking the photo, the victim](https://attack.mitre.org/versions/v8/techniques/T1204/002/)\nunknowingly downloads a malicious JavaScript file that, when opened, automatically communicates with the malicious\nactor’s command and control (C2) server to download TrickBot to the victim’s system (Command and Scripting Interpreter:\n_JavaScript_ [[T1059.007]).](https://attack.mitre.org/versions/v8/techniques/T1059/007/)\n\nAttackers can use TrickBot to:\n\nDrop other malware, such as Ryuk and Conti ransomware, or\n\nTrickBot uses person-in-the-browser attacks to steal information, such as login credentials (Man in the Browser [[T1185]).](https://attack.mitre.org/versions/v8/techniques/T1185/)\nAdditionally, some of TrickBot’s modules spread the malware laterally across a network by abusing the Server Message\nBlock (SMB) Protocol. TrickBot operators have a toolset capable of spanning the entirety of the MITRE ATT&CK framework,\n[from actively or passively gathering information that can be used to support targeting (Reconnaissance [TA0043]), to trying to](https://attack.mitre.org/tactics/TA0043/)\n[manipulate, interrupt, or destroy systems and data (Impact [TA0040]).](https://attack.mitre.org/tactics/TA0040/)\n\nTrickBot is capable of data exfiltration over a hardcoded C2 server, cryptomining, and host enumeration (e.g.,\nreconnaissance of Unified Extensible Firmware Interface or Basic Input/Output System [UEFI/BIOS] firmware) (Exfiltration\n_[Over C2 Channel [T1041], Resource Hijacking](https://attack.mitre.org/versions/v8/techniques/T1041/)_ [[T1496], System Information Discovery.[2] For host enumeration, operators](https://attack.mitre.org/versions/v8/techniques/T1496)\ndeliver TrickBot in modules containing a configuration file with specific tasks.\n\nFigure 1 lays out TrickBot’s use of enterprise techniques.\n\n\n-----\n\n_Figure 1: MITRE ATT&CK enterprise techniques used by TrickBot_\n\n## MITRE ATT&CK Techniques\n\nAccording to MITRE, TrickBot [[S0266] uses the ATT&CK techniques listed in table 1.](https://attack.mitre.org/software/S0266/)\n\n_Table 1: TrickBot ATT&CK techniques for enterprise_\n\n_Initial Access_ [[TA0001]](https://attack.mitre.org/versions/v8/tactics/TA0001/)\n\n**Technique Title**\n\n**ID** **Use**\n\n\nPhishing: Spearphishing\nAttachment\n\nPhishing: Spearphishing\nLink\n\n_Execution_ [[TA0002]](https://attack.mitre.org/versions/v8/tactics/TA0002/)\n\n\n[T1566.001](https://attack.mitre.org/versions/v8/techniques/T1566/001/) TrickBot has used an email with an Excel sheet containing a malicious macro\nto deploy the malware.\n\n[T1566.002](https://attack.mitre.org/versions/v8/techniques/T1566/002) TrickBot has been delivered via malicious links in phishing emails.\n\n\n**Technique Title** **ID** **Use**\n\n\nScheduled Task/Job:\nScheduled Task\n\nCommand and Scripting\nInterpreter: Windows\nCommand Shell\n\nCommand and Scripting\nInterpreter:\nJavaScript/JScript\n\n\n[T1053.005](https://attack.mitre.org/versions/v8/techniques/T1053/005/) TrickBot creates a scheduled task on the system that provides persistence.\n\n[T1059.003](https://attack.mitre.org/versions/v8/techniques/T1059/003/) TrickBot has used macros in Excel documents to download and deploy the\nmalware on the user’s machine.\n\n[T1059.007](https://attack.mitre.org/versions/v8/techniques/T1059/007/) TrickBot victims unknowingly download a malicious JavaScript file that, when\nopened, automatically communicates with the malicious actor’s C2 server to\ndownload TrickBot to the victim’s system.\n\n\n-----\n\n**Technique Title** **ID** **Use**\n\nNative API [T1106](https://attack.mitre.org/versions/v8/techniques/T1106) TrickBot uses the Windows Application Programming Interface (API) call,\nCreateProcessW(), to manage execution flow.\n\n\nUser Execution: Malicious\nLink\n\nUser Execution: Malicious\nFile\n\n_Persistence_ [[TA0003]](https://attack.mitre.org/versions/v8/tactics/TA0003/)\n\n\n[T1204.001](https://attack.mitre.org/versions/v8/techniques/T1204/001/) TrickBot has sent spearphishing emails in an attempt to lure users to click on a\nmalicious link.\n\n[T1204.002](https://attack.mitre.org/versions/v8/techniques/T1204/002/) TrickBot has attempted to get users to launch malicious documents to deliver its\npayload.\n\n\n**Technique Title** **ID** **Use**\n\n\nScheduled Task/Job: Scheduled\nTask\n\nCreate or Modify System Process:\nWindows Service\n\n_[Privilege Escalation [TA0004]](https://attack.mitre.org/versions/v8/tactics/TA0004/)_\n\n\n[T1053.005](https://attack.mitre.org/versions/v8/techniques/T1053/005/) TrickBot creates a scheduled task on the system that provides\npersistence.\n\n[T1543.003](https://attack.mitre.org/versions/v8/techniques/T1543/003/) TrickBot establishes persistence by creating an autostart service that\nallows it to run whenever the machine boots.\n\n\n**Technique Title** **ID** **Use**\n\n\nScheduled Task/Job: Scheduled\nTask\n\nProcess Injection: Process\nHollowing\n\nCreate or Modify System Process:\nWindows Service\n\n_Defense Evasion_ [[TA0005]](https://attack.mitre.org/versions/v8/tactics/TA0005/)\n\n\n[T1053.005](https://attack.mitre.org/versions/v8/techniques/T1053/005/) TrickBot creates a scheduled task on the system that provides\npersistence.\n\n[T1055.012](https://attack.mitre.org/versions/v8/techniques/T1055/012/) TrickBot injects into the svchost.exe process.\n\n[T1543.003](https://attack.mitre.org/versions/v8/techniques/T1543/003/) TrickBot establishes persistence by creating an autostart service that\nallows it to run whenever the machine boots.\n\n\n**Technique Title** **ID** **Use**\n\n\nObfuscated Files or\nInformation\n\nObfuscated Files or\nInformation: Software\nPacking\n\n\n[T1027](https://attack.mitre.org/versions/v8/techniques/T1027) TrickBot uses non-descriptive names to hide functionality and uses an AES\nCBC (256 bits) encryption algorithm for its loader and configuration files.\n\n[T1027.002](https://attack.mitre.org/versions/v8/techniques/T1027/002/) TrickBot leverages a custom packer to obfuscate its functionality.\n\n\nMasquerading [T1036](https://attack.mitre.org/versions/v8/techniques/T1036) The TrickBot downloader has used an icon to appear as a Microsoft Word\ndocument.\n\n\nProcess Injection: Process\nHollowing\n\n\n[T1055.012](https://attack.mitre.org/versions/v8/techniques/T1055/012/) TrickBot injects into the svchost.exe process.\n\n\nModify Registry [T1112](https://attack.mitre.org/versions/v8/techniques/T1112/) TrickBot can modify registry entries.\n\n\nDeobfuscate/Decode Files\nor Information\n\nSubvert Trust Controls:\nCode Signing\n\nImpair Defenses: Disable or\nModify Tools\n\n_[Credential Access [TA0006]](https://attack.mitre.org/versions/v8/tactics/TA0006/)_\n\n\n[T1140](https://attack.mitre.org/versions/v8/techniques/T1140) TrickBot decodes the configuration data and modules.\n\n[T1553.002](https://attack.mitre.org/versions/v8/techniques/T1553/002/) TrickBot has come with a signed downloader component.\n\n[T1562.001](https://attack.mitre.org/versions/v8/techniques/T1562/001/) TrickBot can disable Windows Defender.\n\n\n**Technique Title** **ID** **Use**\n\n\n-----\n\n**Technique Title** **ID** **Use**\n\n\nInput Capture: Credential\nAPI Hooking\n\nUnsecured Credentials:\nCredentials in Files\n\nUnsecured Credentials:\nCredentials in Registry\n\nCredentials from Password\nStores\n\nCredentials from Password\nStores: Credentials from\nWeb Browsers\n\n_Discovery_ [[TA0007]](https://attack.mitre.org/versions/v8/tactics/TA0007/)\n\n\n[T1056.004](https://attack.mitre.org/versions/v8/techniques/T1056/004/) TrickBot has the ability to capture Remote Desktop Protocol credentials by\ncapturing the CredEnumerateA API.\n\n[T1552.001](https://attack.mitre.org/versions/v8/techniques/T1552/001/) TrickBot can obtain passwords stored in files from several applications such as\nOutlook, Filezilla, OpenSSH, OpenVPN and WinSCP. Additionally, it searches\nfor the .vnc.lnk affix to steal VNC credentials.\n\n[T1552.002](https://attack.mitre.org/versions/v8/techniques/T1552/002/) TrickBot has retrieved PuTTY credentials by querying the\nSoftware\\SimonTatham\\Putty\\Sessions registry key.\n\n[T1555](https://attack.mitre.org/versions/v8/techniques/T1555) TrickBot can steal passwords from the KeePass open-source password\nmanager.\n\n[T1555.003](https://attack.mitre.org/versions/v8/techniques/T1555/003/) TrickBot can obtain passwords stored in files from web browsers such as\nChrome, Firefox, Internet Explorer, and Microsoft Edge, sometimes using\nesentutl.\n\n\n**Technique**\n**Tactic** **ID** **Use**\n\n\nSystem\nService\nDiscovery\n\nSystem\nNetwork\nConfiguration\nDiscovery\n\nRemote\nSystem\nDiscovery\n\nSystem\nOwner/User\nDiscovery\n\nPermission\nGroups\nDiscovery\n\nSystem\nInformation\nDiscovery\n\nFile and\nDirectory\nDiscovery\n\nAccount\nDiscovery:\nLocal Account\n\nAccount\nDiscovery:\nEmail Account\n\nDomain Trust\nDiscovery\n\n\n[T1007](https://attack.mitre.org/versions/v8/techniques/T1007/) TrickBot collects a list of install programs and services on the system’s machine.\n\n[T1016](https://attack.mitre.org/versions/v8/techniques/T1016) TrickBot obtains the IP address, location, and other relevant network information from the\nvictim’s machine.\n\n[T1018](https://attack.mitre.org/versions/v8/techniques/T1018) TrickBot can enumerate computers and network devices.\n\n[T1033](https://attack.mitre.org/versions/v8/techniques/T1033) TrickBot can identify the user and groups the user belongs to on a compromised host.\n\n[T1069](https://attack.mitre.org/versions/v8/techniques/T1069) TrickBot can identify the groups the user on a compromised host belongs to.\n\n[T1082](https://attack.mitre.org/versions/v8/techniques/T1082) TrickBot gathers the OS version, machine name, CPU type, amount of RAM available from\nthe victim’s machine.\n\n[T1083](https://attack.mitre.org/versions/v8/techniques/T1083) TrickBot searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg,\n.mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip. It can\nalso obtain browsing history, cookies, and plug-in information.\n\n[T1087.001](https://attack.mitre.org/versions/v8/techniques/T1087/001) TrickBot collects the users of the system.\n\n[T1087.003](https://attack.mitre.org/versions/v8/techniques/T1087/003) TrickBot collects email addresses from Outlook.\n\n[T1482](https://attack.mitre.org/versions/v8/techniques/T1482) TrickBot can gather information about domain trusts by utilizing Nltest.\n\n\n_Lateral Movement_ [[TA0008]](https://attack.mitre.org/versions/v8/tactics/TA0008/)\n\n**Technique Tactic** **ID** **Use**\n\n\n-----\n\n**Technique Tactic** **ID** **Use**\n\n\nLateral Tool\nTransfer\n\n_Collection_ [[TA0009]](https://attack.mitre.org/versions/v8/tactics/TA0009/)\n\n\n[T1570](https://attack.mitre.org/versions/v8/techniques/T1570) Some TrickBot modules spread the malware laterally across a network by abusing the SMB\nProtocol.\n\n\n**Technique Tactic** **ID** **Use**\n\nData from Local System [T1005](https://attack.mitre.org/versions/v8/techniques/T1005) TrickBot collects local files and information from the victim’s local machine.\n\n\nInput\nCapture:Credential API\nHooking\n\n\n[T1056.004](https://attack.mitre.org/versions/v8/techniques/T1056/004/) TrickBot has the ability to capture Remote Desktop Protocol credentials by\ncapturing the CredEnumerateA API.\n\n\nPerson in the Browser [T1185](https://attack.mitre.org/versions/v8/techniques/T1185) TrickBot uses web injects and browser redirection to trick the user into providing\ntheir login credentials on a fake or modified webpage.\n\n_Command and Control_ [[TA0011]](https://attack.mitre.org/versions/v8/tactics/TA0011/)\n\n**Technique Tactic** **ID** **Use**\n\nFallback Channels [T1008](https://attack.mitre.org/versions/v8/techniques/T1008) TrickBot can use secondary command and control (C2) servers for communication\nafter establishing connectivity and relaying victim information to primary C2 servers.\n\n\nApplication Layer\nProtocol: Web\nProtocols\n\n\n[T1071.001](https://attack.mitre.org/versions/v8/techniques/T1071/001) TrickBot uses HTTPS to communicate with its C2 servers, to get malware updates,\nmodules that perform most of the malware logic and various configuration files.\n\n\nIngress Tool Transfer [T1105](https://attack.mitre.org/versions/v8/techniques/T1105) TrickBot downloads several additional files and saves them to the victim's machine.\n\n\nData Encoding:\nStandard Encoding\n\n\n[T1132.001](https://attack.mitre.org/versions/v8/techniques/T1132/001) TrickBot can Base64-encode C2 commands.\n\n\nNon-Standard Port [T1571](https://attack.mitre.org/versions/v8/techniques/T1571) Some TrickBot samples have used HTTP over ports 447 and 8082 for C2.\n\n\nEncrypted Channel:\nSymmetric\nCryptography\n\n_Exfiltration_ [[TA0010]](https://attack.mitre.org/versions/v8/tactics/TA0010/)\n\n\n[T1573.001](https://attack.mitre.org/versions/v8/techniques/T1573/001) TrickBot uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2\ntraffic.\n\n\n**Technique Tactic** **ID** **Use**\n\n\nExfiltration Over C2\nChannel\n\n_Impact_ [[TA0040]](https://attack.mitre.org/versions/v8/tactics/TA0040/)\n\n**Technique**\n**Tactic** **ID** **Use**\n\n\n[T1041](https://attack.mitre.org/versions/v8/techniques/T1041) TrickBot can send information about the compromised host to a hardcoded C2\nserver.\n\n\nResource\nHijacking\n\n## Detection\n\n**Signatures**\n\n\n[T1496](https://attack.mitre.org/versions/v8/techniques/T1496) TrickBot actors can leverage the resources of co-opted systems for cryptomining to validate\ntransactions of cryptocurrency networks and earn virtual currency.\n\n\nCISA developed the following snort signature for use in detecting network activity associated with TrickBot activity.\n\n\n-----\n\nalert tcp any [443,447] > any any (msg: TRICKBOT:SSL/TLS Server X.509 Cert Field contains example.com (Hex) ; sid:1;\nrev:1; flow:established,from_server; ssl_state:server_hello; content:\"|0b|example.com\"; fast_pattern:only; content:\"Global\nSecurity\"; content:\"IT Department\";\npcre:\"/(?:\\x09\\x00\\xc0\\xb9\\x3b\\x93\\x72\\xa3\\xf6\\xd2|\\x00\\xe2\\x08\\xff\\xfb\\x7b\\x53\\x76\\x3d)/\"; classtype:bad-unknown;\nmetadata:service ssl,service and-ports;)\n\nalert tcp any any -> any $HTTP_PORTS (msg:\"TRICKBOT_ANCHOR:HTTP URI GET contains '/anchor'\"; sid:1; rev:1;\nflow:established,to_server; content:\"/anchor\"; http_uri; fast_pattern:only; content:\"GET\"; nocase; http_method;\npcre:\"/^\\/anchor_?.{3}\\/[\\w_-]+\\.[A-F0-9]+\\/?$/U\"; classtype:bad-unknown; priority:1; metadata:service http;)\n\nalert tcp any $SSL_PORTS -> any any (msg:\"TRICKBOT:SSL/TLS Server X.509 Cert Field contains 'C=XX, L=Default City,\nO=Default Company Ltd'\"; sid:1; rev:1; flow:established,from_server; ssl_state:server_hello; content:\"|31 0b 30 09 06 03 55\n04 06 13 02|XX\"; nocase; content:\"|31 15 30 13 06 03 55 04 07 13 0c|Default City\"; nocase; content:\"|31 1c 30 1a 06 03 55\n04 0a 13 13|Default Company Ltd\"; nocase; content:!\"|31 0c 30 0a 06 03 55 04 03|\"; classtype:bad-unknown;\nreference:url,www.virustotal.com/gui/file/e9600404ecc42cf86d38deedef94068db39b7a0fd06b3b8fb2d8a3c7002b650e/detection;\nmetadata:service ssl;)\n\nalert tcp any any -> any $HTTP_PORTS (msg:\"TRICKBOT:HTTP Client Header contains 'boundary=Arasfjasu7'\"; sid:1;\nrev:1; flow:established,to_server; content:\"boundary=Arasfjasu7|0d 0a|\"; http_header; content:\"name=|22|proclist|22|\";\nhttp_header; content:!\"Referer\"; content:!\"Accept\"; content:\"POST\"; http_method; classtype:bad-unknown; metadata:service\nhttp;)\n\nalert tcp any any -> any $HTTP_PORTS (msg:\"TRICKBOT:HTTP Client Header contains 'User-Agent|3a 20|WinHTTP\nloader/1.'\"; sid:1; rev:1; flow:established,to_server; content:\"User-Agent|3a 20|WinHTTP loader/1.\"; http_header;\nfast_pattern:only; content:\".png|20|HTTP/1.\"; pcre:\"/^Host\\x3a\\x20(?:\\d{1,3}\\.){3}\\d{1,3}(?:\\x3a\\d{2,5})?$/mH\";\ncontent:!\"Accept\"; http_header; content:!\"Referer|3a 20|\"; http_header; classtype:bad-unknown; metadata:service http;)\n\nalert tcp any $HTTP_PORTS -> any any (msg:\"TRICKBOT:HTTP Server Header contains 'Server|3a 20|Cowboy'\"; sid:1;\nrev:1; flow:established,from_server; content:\"200\"; http_stat_code; content:\"Server|3a 20|Cowboy|0d 0a|\"; http_header;\nfast_pattern; content:\"content-length|3a 20|3|0d 0a|\"; http_header; file_data; content:\"/1/\"; depth:3; isdataat:!1,relative;\nclasstype:bad-unknown; metadata:service http;)\n\nalert tcp any any -> any $HTTP_PORTS (msg:\"TRICKBOT:HTTP URI POST contains C2 Exfil\"; sid:1; rev:1;\nflow:established,to_server; content:\"Content-Type|3a 20|multipart/form-data|3b 20|boundary=------Boundary\"; http_header;\nfast_pattern; content:\"User-Agent|3a 20|\"; http_header; distance:0; content:\"Content-Length|3a 20|\"; http_header; distance:0;\ncontent:\"POST\"; http_method; pcre:\"/^\\/[a-z]{3}\\d{3}\\/.+?\\.[A-F0-9]{32}\\/\\d{1,3}\\//U\"; pcre:\"/^Host\\x3a\\x20(?:\\d{1,3}\\.)\n{3}\\d{1,3}$/mH\"; content:!\"Referer|3a|\"; http_header; classtype:bad-unknown; metadata:service http;)\n\nalert tcp any any -> any $HTTP_PORTS (msg:\"HTTP URI GET/POST contains '/56evcxv' (Trickbot)\"; sid:1; rev:1;\nflow:established,to_server; content:\"/56evcxv\"; http_uri; fast_pattern:only; classtype:bad-unknown; metadata:service http;)\n\nalert icmp any any -> any any (msg:\"TRICKBOT_ICMP_ANCHOR:ICMP traffic conatins 'hanc'\"; sid:1; rev:1; itype:8;\ncontent:\"hanc\"; offset:4; fast_pattern; classtype:bad-unknown;)\n\nalert tcp any any -> any $HTTP_PORTS (msg:\"HTTP Client Header contains POST with 'host|3a 20|*.onion.link' and 'data='\n(Trickbot/Princess Ransomeware)\"; sid:1; rev:1; flow:established,to_server; content:\"POST\"; nocase; http_method;\ncontent:\"host|3a 20|\"; http_header; content:\".onion.link\"; nocase; http_header; distance:0; within:47; fast_pattern; file_data;\ncontent:\"data=\"; distance:0; within:5; classtype:bad-unknown; metadata:service http;)\n\nalert tcp any any -> any $HTTP_PORTS (msg:\"HTTP Client Header contains 'host|3a 20|tpsci.com' (trickbot)\"; sid:1; rev:1;\nflow:established,to_server; content:\"host|3a 20|tpsci.com\"; http_header; fast_pattern:only; classtype:bad-unknown;\nmetadata:service http;)\n\n## Mitigations\n\nCISA and FBI recommend that network defenders—in federal, state, local, tribal, territorial governments, and the private\nsector—consider applying the following best practices to strengthen the security posture of their organization's systems.\nSystem owners and administrators should review any configuration changes prior to implementation to avoid negative\nimpacts.\n\n\n-----\n\nProvide social engineering and phishing training to employees.\nConsider drafting or updating a policy addressing suspicious emails that specifies users must report all suspicious\nemails to the security and/or IT departments.\nMark external emails with a banner denoting the email is from an external source to assist users in detecting spoofed\nemails.\nImplement Group Policy Object and firewall rules.\nImplement an antivirus program and a formalized patch management process.\nImplement filters at the email gateway and block suspicious IP addresses at the firewall.\nAdhere to the principle of least privilege.\nImplement a Domain-Based Message Authentication, Reporting & Conformance validation system.\nSegment and segregate networks and functions.\nLimit unnecessary lateral communications between network hoses, segments, and devices.\nConsider using application allowlisting technology on all assets to ensure that only authorized software executes, and\nall unauthorized software is blocked from executing on assets. Ensure that such technology only allows authorized,\ndigitally signed scripts to run on a system.\nEnforce multi-factor authentication.\nEnable a firewall on agency workstations configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nImplement an Intrusion Detection System, if not already used, to detect C2 activity and other potentially malicious\nnetwork activity\nMonitor web traffic. Restrict user access to suspicious or risky sites.\nMaintain situational awareness of the latest threats and implement appropriate access control lists.\nDisable the use of SMBv1 across the network and require at least SMBv2 to harden systems against network\npropagation modules used by TrickBot.\nVisit the MITRE ATT&CK Techniques pages (linked in table 1 above) for additional mitigation and detection strategies.\nSee CISA’s Alert on [Technical Approaches to Uncovering and Remediating Malicious Activity for more information on](https://us-cert.cisa.gov/ncas/alerts/aa20-245a)\naddressing potential incidents and applying best practice incident response procedures.\n\nFor additional information on malware incident prevention and handling, see the National Institute of Standards and\n[Technology Special Publication 800-83, Guide to Malware Incident Prevention and Handling for Desktops and Laptops.](https://csrc.nist.gov/publications/detail/sp/800-83/rev-1/final)\n\n## Resources\n\n References\n\n Revisions\n\nMarch 17, 2021: Initial Version\n\nMarch 24, 2021: Added MITRE ATT&CK Technique T1592.003 used for reconnaissance\n\nMay 20, 2021: Added new MITRE ATT&CKs and updated Table 1\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/alerts/aa21-076a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-17 - Alert (AA21-076A)- TrickBot Malware.pdf"
    ],
    "report_names": [
        "2021-03-17 - Alert (AA21-076A)- TrickBot Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535909,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653786388,
    "ts_modification_date": 1653786388,
    "files": {
        "pdf": "https://archive.orkl.eu/b74166d821acae67a61add74e328c297d1ab115b.pdf",
        "text": "https://archive.orkl.eu/b74166d821acae67a61add74e328c297d1ab115b.txt",
        "img": "https://archive.orkl.eu/b74166d821acae67a61add74e328c297d1ab115b.jpg"
    }
}