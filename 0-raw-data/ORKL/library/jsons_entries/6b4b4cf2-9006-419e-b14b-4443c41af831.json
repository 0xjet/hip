{
    "id": "6b4b4cf2-9006-419e-b14b-4443c41af831",
    "created_at": "2023-01-12T15:08:02.053872Z",
    "updated_at": "2025-03-27T02:10:04.300455Z",
    "deleted_at": null,
    "sha1_hash": "6f5432e826b97bbd6d4267b13e2e00aab4c133b1",
    "title": "2016-04-14 - Meet GozNym- The Banking Malware Offspring of Gozi ISFB and Nymaim",
    "authors": "",
    "file_creation_date": "2022-05-28T03:51:55Z",
    "file_modification_date": "2022-05-28T03:51:55Z",
    "file_size": 1380222,
    "plain_text": "# The Banking Malware Offspring of Gozi ISFB and Nymaim\n\n**[securityintelligence.com/meet-goznym-the-banking-malware-offspring-of-gozi-isfb-and-nymaim/](https://securityintelligence.com/meet-goznym-the-banking-malware-offspring-of-gozi-isfb-and-nymaim/)**\n\n[Home&nbsp/](https://securityintelligence.com/) [Malware](https://securityintelligence.com/category/x-force/malware-threat/)\nMeet GozNym: The Banking Malware Offspring of Gozi ISFB and Nymaim\n\n\nApril 14, 2016\n\n\n-----\n\n[Malware April 14, 2016](https://securityintelligence.com/category/x-force/malware-threat/)\nBy [Limor Kessem co-authored by Lior Keshet 5 min read](https://securityintelligence.com/author/limor-kessem/)\n[IBM X-Force Research uncovered a Trojan hybrid spawned from the Nymaim and](https://blog.threatstop.com/2016/04/07/nymaim/) [Gozi ISFB](https://securityintelligence.com/gozi-banking-trojan-upgrades-build-to-inject-into-windows-10-edge-browser/)\nmalware. It appears that the operators of Nymaim have recompiled its source code with part\nof the [Gozi ISFB source code, creating a combination that is being actively used in attacks](http://www.govcert.admin.ch/blog/18/gozi-isfb-when-a-bug-really-is-a-feature)\nagainst more than 24 U.S. and Canadian banks, stealing millions of dollars so far. X-Force\nnamed this new hybrid GozNym.\n\nThe new GozNym hybrid takes the best of both the Nymaim and Gozi ISFB malware to\ncreate a powerful Trojan. From the Nymaim malware, it leverages the dropper’s stealth and\npersistence; the Gozi ISFB parts add the banking Trojan’s capabilities to facilitate fraud via\ninfected Internet browsers. The end result is a new banking Trojan in the wild.\n\nInternally, GozNym works like a double-headed beast, where the two codes rely on one\nanother to carry out the malware’s internal operations. More information about the hybrid’s\nintertwined operation appears in the technical section of this blog.\n\n## Targeting North America\n\nIn terms of its current targets, X-Force noted that the GozNym hybrid’s configuration is\npresently focused on the U.S., targeting 22 banks, credit unions and popular e-commerce\nplatforms. Two financial institutions based in Canada are also on the list. GozNym’s\noperators’ top target is business accounts.\n\n## When Source Codes Collide\n\n\n-----\n\nHow was this hybrid created? GozNym s source code is composed of two known malware\n[codes, one of which is Gozi ISFB, which leaked in 2010. Gozi ISFB was actually leaked](http://blog.phishlabs.com/the-unrelenting-evolution-of-vawtrak)\nmore than once: A second disclosure took place in late 2015, when a modified ISFB code\nwas rumored to have been compromised yet again.\n\nOn the Nymaim side, the only group known to possess its source code is the original\ndevelopment team. The most likely scenario is that the Nymaim team obtained the leaked\nGozi ISFB code and successfully incorporated it into their own malware to create a\ncombination Trojan for financial fraud attacks.\n\n## From Nymaim to GozNym\n\nNymaim is a two-stage malware dropper. It usually infiltrates computers through exploit kits\nand then executes the second stage of its payload once it is on the machine, effectively\nusing two executables for the infection routine.\n\nOn its own, the Nymaim Trojan is a stealthy, persistent dropper that uses evasion techniques\nsuch as encryption, anti-VM, anti-debugging and control flow obfuscation. Although it has\ndabbled with other banking Trojans in the past, its first tight connection with banking malware\nbegan in November 2015; up until then, Nymaim was almost exclusively used as a\nransomware dropper.\n\nNymaim is believed to be operated by a closed group and developed on an ongoing basis by\nwhat appears to be the same developer(s). The Trojan has a global reach and launched an\nuntold number of ransomware attacks using its own generic locker on users in Europe, North\n[America and South America, PCWorld reported.](https://www.pcworld.com/article/2043661/darkleech-malware-undertakes-ransomware-campaign.html)\n\nCampaigns linked with the malware were not all documented. However, related data from an\nindependent blogger cited over 2.5 million infections via the Blackhole Exploit Kit (BHEK) in\nlate 2013.\n\n_Source: Malware don’t need Coffee_\n\nX-Force researchers noticed that Nymaim started fetching a Gozi ISFB module, a\nwebinjection dynamic link library (DLL), and using it to launch online banking attacks in late\n2015.\n\nAs for the infection vector, some recent cases from 2016 revealed that the Pony loader\nexecuted Nymaim, which then fetched Gozi ISFB as a third step in the infection flow. The\n[resulting online banking fraud attempts were detected as Gozi ISFB attacks, even though](https://securityintelligence.com/the-new-bank-heist-the-financial-industrys-top-threats/)\nthey originated with Nymaim.\n\n\n-----\n\nThe [first merged variant, GozNym, was detected in early April 2016, when new Nymaim](https://exchange.xforce.ibmcloud.com/collection/X-FORCE-ADVISORY-GozNym-Malware-75bc0d26351c35b375b242f848cab507)\nsamples came embedded with Gozi ISFB code and were recompiled into one malware. In\nthe hybrid form, Nymaim is the first executable launched. It then launches the Gozi ISFB\ncomponent as the second stage of the malware deployment.\n\n## Some Technical Details\n\nBefore merging into an actual hybrid, earlier versions of Nymaim used to fetch and inject\nGozi ISFB’s financial module as a complete DLL into the infected victim’s browser to enable\nwebinjections on online banking sites. That DLL is about 150 KB and was a valid Portable\nExecutable (PE) file.\n\nMore recent versions of Nymaim include altered Gozi ISFB code. Instead of the 150 KB DLL,\nit now injects a 40 KB buffer into the browser. This buffer still performs Gozi ISFB’s\nfunctionality. For example, when it comes to the Export Address Table (EAT), which contains\nthe addresses of modules exposed for consumption by other applications and services,\nGozNym uses the same hook engine to perform webinjections.\n\nHowever, there are some pointed differences. For one, the new buffer is not a valid PE file —\nit has more of a shellcode structure. It constructs its own Import Address Table (IAT) and has\nno PE headers.\n\nAnother difference is that the new buffer is intertwined with Nymaim’s code. We have at least\ntwo examples that demonstrate that interoperability: One is where Gozi ISFB calls Nymaim\ncode to obtain strings; the other is where Gozi ISFB’s buffer code needs to perform actions\nsuch as memory allocations.\n\nThis intertwined construction led us to the conclusion that Nymaim and Gozi ISFB were in\nfact compiled into one project.\n\n### Analyzing the Gozi ISFB Code\n\nTo illustrate that, let’s have a look at a comparison between the earlier Gozi ISFB DLL\nversion and the new GozNym buffer code. Both pieces perform the same essential action\nand are taken from the ISFB hook engine.\n\nHere is the original Gozi ISFB DLL that used to be fetched by Nymaim:\n\nHere is the new GozNym buffer:\n\nIn this last figure, we see the new hybrid version’s function jmp_nymaim_code:\n\n\n-----\n\nThis piece of code is called whenever Gozi ISFB requires Nymaim to perform an operation.\nIn our example, it is calling HeapAlloc. The function prepares the required arguments,\noperation type, allocation size, etc. for Nymaim. Nymaim then performs the action and\nreturns the result to the Gozi ISFB code.\n\n### Relevant Sample MD5\n\nThe MD5 hash is 2A9093307E667CDB71884ECC1B480245.\n\n## Detecting and Stopping GozNym Attacks\n\nThe merging of Nymaim and parts of Gozi ISFB has resulted in a new banking Trojan in the\nwild. This malware is as stealthy and persistent as the Nymaim loader while possessing the\nGozi ISFB Trojan’s ability to manipulate Web sessions, resulting in advanced online banking\nfraud attacks.\n\nIBM Security has studied the GozNym malware and its attack schemes and can help banks\nand other targeted organizations learn more about this high-risk threat. To help stop threats\n[like GozNym, banks and service providers can use adaptive malware detection solutions and](https://www.ibm.com/software/products/en/trusteer-pinpoint-malware-detection?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US)\n[protect customer endpoints with malware intelligence that provides real-time insight into](https://www.ibm.com/software/products/en/trusteer-rapport?ce=ISM0484&ct=SWG&cmp=IBMSocial&cm=h&cr=Security&ccy=US)\nfraudster techniques and capabilities, designed to address the relentless evolution of the\nthreat landscape.\n\n[Read the white paper: Accelerating growth and digital adoption with seamless identity trust](https://www.ibm.com/account/reg/us-en/signup?formid=urx-33205)\n\n_For technical details on this research and related indicators of compromise, see the X-Force_\n_Advisory on X-Force Exchange._\n\n[Limor Kessem](https://securityintelligence.com/author/limor-kessem/)\nExecutive Security Advisor, IBM\n\nLimor Kessem is an Executive Security Advisor at IBM Security. She is a widely sought-after\nsecurity expert, speaker and author and a strong advocate for wom...\n\n\n-----\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-04-14 - Meet GozNym- The Banking Malware Offspring of Gozi ISFB and Nymaim.pdf"
    ],
    "report_names": [
        "2016-04-14 - Meet GozNym- The Banking Malware Offspring of Gozi ISFB and Nymaim.pdf"
    ],
    "threat_actors": [
        {
            "id": "b753c6a8-a83d-47bc-829d-45e56136eb7d",
            "created_at": "2023-01-06T13:46:38.97802Z",
            "updated_at": "2025-03-27T02:00:02.967861Z",
            "deleted_at": null,
            "main_name": "GozNym",
            "aliases": [],
            "source_name": "MISPGALAXY:GozNym",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536082,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1653709915,
    "ts_modification_date": 1653709915,
    "files": {
        "pdf": "https://archive.orkl.eu/6f5432e826b97bbd6d4267b13e2e00aab4c133b1.pdf",
        "text": "https://archive.orkl.eu/6f5432e826b97bbd6d4267b13e2e00aab4c133b1.txt",
        "img": "https://archive.orkl.eu/6f5432e826b97bbd6d4267b13e2e00aab4c133b1.jpg"
    }
}