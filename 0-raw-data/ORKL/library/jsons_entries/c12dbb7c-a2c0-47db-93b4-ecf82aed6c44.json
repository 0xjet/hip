{
    "id": "c12dbb7c-a2c0-47db-93b4-ecf82aed6c44",
    "created_at": "2022-10-25T16:48:23.102598Z",
    "updated_at": "2025-03-27T02:16:20.897814Z",
    "deleted_at": null,
    "sha1_hash": "bfa9143ed25f03e8a3273a392583de3292d64e35",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1168094,
    "plain_text": "# Destructive Attack “DUSTMAN”\n\n## Technical Report\n\n**TLP:** **WHITE**\n\n\n-----\n\n**Technical Report**\n\n**Traffic Light Protocol (TLP) Marking**\nThe TLP system was created by USCERT to enable greater sharing of sensitive material and is widely used across CERTs and\nindustry. There are four colors (traffic lights):\n\n  - **RED - Personal for named recipients only**\n\nRecipients may not share TLP: RED information with any parties outside of the specific exchange, meeting or\nconversation in which it is originally disclosed.\n\n  - **AMBER – limited distribution**\n\nRecipients may only share TLP: AMBER information with members of their own organization who need to know,\nand only as widely as necessary to act on that information.\n\n  - **GREEN – community wide**\n\nRecipients may share TLP: GREEN information with peers and partner organizations within their sectors or\ncommunity, but via publicly accessible channels.\n\n  - **WHITE – unlimited:**\n\nInformation may be distributed without restriction, subject to copyright controls.\n\n1\n\n\n-----\n\n**Technical Report**\n\n### Contents\n\n1. Overview ............................................................................................................................................................ 3\n\n2. Attack Life Cycle ................................................................................................................................................ 4\n\n3. Dustman Analysis Overview ............................................................................................................................. 7\n\n4. Host Indicator of Comprise ........................................................................................................................... 14\n\n5. Tactical Recommendations ........................................................................................................................... 15\n\n6. Appendix ........................................................................................................................................................ .18\n\n2\n\n\n-----\n\n**Technical Report**\n\n### 1. Overview \n\nDestructive attacks are quite extraordinary as threat actors employ their malware to disrupt\nor disable availability of the victim’s resources by wiping contents on storage devices of the\ntargeted systems. In these attacks, threat actors have already compromised the victim’s\nnetwork and gained privilege access to the internal infrastructure prior to the destruction\nactivities.\n\nIn 2019, multiple destructive attacks were observed targeting entities within the Middle East.\nThe National Cyber Security Centre (NCSC), a part of the National Cybersecurity Authority\n(NCA), detected a new malware named “DUSTMAN” that was detonated on December 29,\n2019. Based on analyzed evidence and artifacts found on machines in a victim’s network that\nwere not wiped by the malware. NCSC assess that the threat actor behind the attack had\nsome kind of urgency on executing the files on the date of the attack due to multiple OPSEC\nfailures observed on the infected network. NCSC is calling the malware used in this attack\n“DUSTMAN” after the filename and string embedded in the malware.\n\n“DUSTMAN” has different characteristics when compared to the multiple wiper malwares\nthat have been observed through the years, especially the “Shamoon” variants although they\nall use the same third-party driver “Eldos RawDisk”. Furthermore, “DUSTMAN” varies in terms\nof techniques and capability when compared to “Shamoon” and from the observed behavior\nand capabilities, “DUSTMAN” can be considered as a new variant of “ZeroCleare” malware,\npublished in December 2019[(1)].\n\nThis report will shed the light on the attack life cycle, technical analysis of the malware, and\nthe preventive recommendation with the Yara rules. It is worth mentioning that NCSC is still\ncoordinating all efforts in understanding the extent of the attack, malware and attribution.\n\n(1): New Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East, December 2019, IBM X-Force.\n\n3\n\n\n-----\n\n**Technical Report**\n\n### 2. Attack Life Cycle\n\nBased on the analysis of the collected artifacts, NCSC found artifacts that shows early signs of\ncompromise of the network that dates back few months prior to the destructive attack. This\nillustrates the determination and persistence of the threat actor behind this attack that\nfollows the typical attack life cycle of nation-state threat actor. “Figure 1” below\ndemonstrates the high-level phases of the attack life cycle.\n\n**Initial Access** **Establish Foothold** **Credential Harvesting**\n\nPossible exploit Exploit VPN Obtained domain\n\nVPN access to the admin/service\n\nVPN vulnerability\n\nnetwork\n\nVulnerability credentials\n\n**Credential**\n**Harvesting** `\n\n**Execution** **Installment** **Weaponization**\n\nCopy DustMan on\n\nExecuation of Compilation of\n\nthe Victim’s\n\nDUSTMAN DUSTMAN\n\nnetwork\n\n**Cover Tracks**\n\nDownload a cleaner\n\ntool\nDelete VPN Logs\n\n**FIGURE 1:** **ATTACK LIFE CYCLE**\n\n4\n\n\n-----\n\n**Technical Report**\n\n**2.1.** **Initial Access:**\n\nNCSC assess with moderate confidence that the initial access of the attack occurred by\n\nexploiting one of the remote execution vulnerabilities in a VPN appliance that was disclosed\n\nin July 2019.\n\n**2.2.** **Establish Foothold:**\n\nIn this phase, the threat actor has gained access to the VPN server.\n\n**2.3.** **Credential Harvesting and Lateral Movement:**\n\nThe threat actor obtained domain admin and service accounts on the victim’s network, which\n\nwas used to run “DUSTMAN” malware on all of the victim’s systems. The attacker utilized the\n\nanti-virus management console service account to distribute the malware across the network.\n\n**2.4.** **Weaponization**\n\nDUSTMAN malware was compiled, possibly on the threat actor infrastructure, few minutes\n\nbefore deploying it on the victim’s network. This is inconsistent with known destructive\n\nattacks as they usually tested f before being deployed.\n\n**2.5.** **Installment**\n\nThe threat actor accessed the victim’s network and copied the malware and the remote\n\nexecution tool “PSEXEC” into the anti-virus management console server, which was\n\nconnected to all machines within the victim’s network due to the nature of its functionality.\n\nFew minutes later, the attacker accessed the storage server of the victims and deleted all\n\nvolumes manually.\n\n**2.6.** **Execution**\n\nThe attackers then executed a set of commands on the anti-virus management control to\n\ndistribute the malware to all connected machines, and through (PSEXEC) the malware\n\nexecuted and dropped (3) additional files, two drivers and the wiper. Most of the connected\n\nmachines were wiped.\n\n5\n\n\n-----\n\n**Technical Report**\n\nNCSC believes that the dropped files from “DUSTMAN” would be detected by the current\n\nAnti-Virus, However the files bypassed the antivirus detection and were executed\n\nsuccessfully. The threat actor either disabled the Anti-Virus or whitelisted the “Eldos\n\nRawDisk” driver in order to allow the wiper execution. Fortunately, few machines were in the\n\nsleeping mode at the time of this action and once these machines were started, the anti-virus\n\ndetected and prevented the execution of the “Eldos RawDisk” driver.\n\n**2.7.** **Covering Tracks**\n\nAfter the wiping mission is accomplished, the attacker logged to the VPN server and deleted\n\nthe recent VPN access log and downloaded a legitimate file deletion tool and used it to cover\n\ntheir tracks. This download indicates that the threat actor identified few failed wipes on some\n\nsystems and attempted to clean any left artifact on these systems.\n\n**2.8.** **Wiping Sequence Timeline**\n\nActivity\nagent.exe was compiled\nDustman.exe was compiled\nAccessing the victim domain through VPN\nDustman.exe was copied to the victim’s Anti-Virus management console.\nManually deleting all volumes of the storage server.\nDisabling the anti-virus on all connected machines\nInitiated the attack remotely utilizing PSEXE from the ani-virus management console.\nDustman.exe was copied and executed on all machine connected to the network.\nelrawdsk.sys and assisstant.sys were dropped\nVBoxDrv driver service was created and utilized to install the unsigned driver\nelrawdsk.sys\n\n**TABLE 1:** **WIPING SEQUENCE TIMELINE**\n\n6\n\n\n-----\n\n**Technical Report**\n\n### 3. Dustman Analysis Overview\n\nFew wiping activities have been observed in the year 2019. The below “Figure 2” shows the\n\ntimeline of these activities. The attribution and the threat actor behind these attacks is still\n\nnot determined. However, commitment, persistence and TTPs observed indicates that these\n\nare possibly an act of one nation state actor.\n\nModified \"Turla IBM published an IBM published\n\n\"DUSTMAN\"\n\nDriver Loader (TDL)\" initial alert about full analysis of\n\ndetected on on\n\nposted on GitHub \"ZeroCleare\" on \"ZeroCleare\" on\n\non March, 2019 September, 2019 December, 2019 December, 2019\n\n**FIGURE 2:** **TIMELINE OF ACTIVITIES RELATED TO WIPING ATTACKS IN 2019**\n\n1. In March 2019, a modified version of “Turla Driver Loader (TDL)” was published. This\n\nmodified variant exploits a vulnerable legitimate signed driver to bypass “Window’s\n\nDriver Signature Enforcement (DSE)” that prevents loading unsigned drivers such as\n\nthe raw disk driver utilized by the threat actor destructive malware samples.\n\n2. In September 2019, IBM posted an alert on its intelligence portal about “ZeroCleare”\n\nattacks as it responded to incidents occurred to organizations within the Middle East.\n\n3. In early December 2019, IBM published a detailed analysis report about “ZeroCleare”.\n\n4. On December 29, 2019, NCSC identified “DUSTMAN” that was used by an adversary,\n\nthat shares similarities with “ZeroCleare”.\n\n### 3.1. DUSTMAN vs ZeroCleare\n\nDUSTMAN seems to be a new variant of “ZeroCleare” as the raw disk driver used by it shares\n\nthe same exact digital fingerprint as the one utilized by “ZeroCleare”. Furthermore, both\n\n“DUSTMAN” and “ZeroCleare” utilized a skeleton of the modified “Turla Driver Loader (TDL)”\n\npublished on March 2019 on GitHub. “Turla Driver Loader (TDL)” exploits a vulnerability in a\n\nlegitimate singed but vulnerable driver which allows the attackers to overcome the operating\n\nsystem protection against loading unsigned drivers.\n\n7\n\n\n-----\n\n**Technical Report**\n\nEven though the same exact raw disk driver was used in the “ZeroCleare” attack, the\n\ntechniques utilized by “DUSTMAN” is different. First, an optimization mechanism has been\n\nadded to “DUSTMAN” that is considered an optimization from “ZeroCleare”, where the\n\ndestructive capability and all needed drivers and loaders are delivered in one executable file\n\nas opposed to two files as was the case with “ZeroCleare”. Another difference is that\n\n“ZeroCleare” wipes the volume by overwriting it with garbage data (0x55) while “DUSTMAN”\n\noverwrites the volume.\n\n### 3.2. Technical Analysis\n\nThe malware executable file “dustman.exe” is not the actual wiper, however, it contains all\nthe needed resources and drops three other files upon execution. These files are two drivers\nand the wiper. These 3 files are resident as encrypted resources in the “DUSTMAN” malware.\nThe malware decrypts these resources and writes them to the same folder where the\nmalware is executed. The characteristics of these files and resources are listed in the “Table\n2” below:\n\nFile Name Resource Name Objective Resource/File Size (Bytes)\n\nVulnerable signed driver used to\n\nassistant.sys 1 exploit the operating system to load 68,288\n\nunsigned drivers\n\nUnsigned driver by Eldos that is used\nelrawdisk.sys 103 24,576\nto access and write raw volume data\n\nWiper process that overwrites a\n\nagent.exe 106 volume passed to it as an argument 116,224\n\nwith a preconfigured string\n\n**TABLE 2:** **FILES DROPPED** **BY** **THE** **DUSTMAN** **MALWARE**\n\nAs those resources can be seen after performing static analysis of the files attributes in “Figure 3”\nbelow:\n\n**FIGURE 3:** **RESOURCES CONTAINED IN THE FILE DUSTMAN.EXE**\n\n8\n\n|File Name Resource Name Objective Resource/File Size (Bytes)|Col2|Col3|Col4|\n|---|---|---|---|\n|Vulnerable signed driver used to assistant.sys 1 exploit the operating system to load 68,288 unsigned drivers||||\n|Unsigned driver by Eldos that is used elrawdisk.sys 103 24,576 to access and write raw volume data||||\n|agent.exe|106|Wiper process that overwrites a volume passed to it as an argument with a preconfigured string|116,224|\n\n\n-----\n\n**Technical Report**\n\nOnce the “DUSTMAN” executable is executed, the two drivers gets dropped and installed and\nthen the agent.exe (the wiper) gets executed with the assistance of the recently installed\ndrivers. The sequence can be seen in the “Figure 4” below:\n\n**FIGURE 4:** **TECHNICAL DETAILS**\n\n### 3.2.1. Dustman.exe\nThe malware sample “dustman.exe” follows the below steps to achieve its destructive\npurposes:\n\n**1.** Checks if the malware was executed previously on the system by creating a mutex. If\n\nthe mutex is found, it means the malware was previously executed on a system,\nmalware jumps to step 8.\n\n**FIGURE 5:** **CREATING MUTEX TO TRACK MACHINES FOR WHICH THE MALWARE WAS EXECUTED**\n\n9\n\n\n-----\n\n**Technical Report**\n\n**2.** Extracts the resource “elrawdsk.sys”, decrypts it, and then writes the decrypted\n\nresource to a file on the current directory of the malware “dustman.exe”.\n\n**FIGURE 6:** **DECRYPTION ROUTINE USED TO DECRYPT THE DIFFERENT RESOURCED EMBEDDED IN THE MALWARE**\n\n**FIGURE 7: ELRAWDSK.SYS IS THE FIRST FILE TO BE DROPPED**\n\n**3.** Checks if “VirtualBox” service is running on the system, If the service is running, the\n\nmalware tries to stop it. The checks happens by looking for the registry key\n“Software\\Oracle\\VirtualBox” in the registry.\n\n**FIGURE 8:** **ROUTINE TO CHECK IF VIRTUALBOX IS INSTALLED BY QUERYING THE REGISTRY**\n\n**4.** Extracts the vulnerable singed driver resource (“assistant.sys”), decrypts it, and then\n\nwrites the decrypted resource to a file on the current directory of the dropper\nmalware “dustman.exe”.\n\n\n10\n\n\n-----\n\n**Technical Report**\n\n**FIGURE 9: ASSISTANT.SYS IS THE SECOND FILE TO BE DROPPED**\n\n**5.** Creates and starts a driver service “VBoxDrv” backed by signed vulnerable driver\n\n“assistant.sys”.\n\n**FIGURE 10:** **LISTING VBOXDRV UPON ITS INSTALLATION**\n\n**6.** Exploits the vulnerable service driver “assistant.sys” to overcome “Windows Driver\n\nSignature Enforcement (DSE)” and loads the unsigned raw disk driver “elrawdsk.sys”\nby writing shellcode to the vulnerable signed driver which would cause the unsigned\ndriver to be loaded into the system.\n\n**FIGURE 11:** **SHELLCODE USED TO EXPLOIT THE VULNERABLE SINGED DRIVER**\n\n**FIGURE 12:** **UNSIGNED DRIVER ELRAWDSK UPON ITS LOADING IN THE SYSTEM.** **SCREENSHOT FROM WINOBJEX64.EXE.**\n\n11\n\n\n-----\n\n**Technical Report**\n\n**7.** Unloads the vulnerable signed driver and removes the driver service that was\n\ncreated.\n\n**FIGURE 13:** **UNSIGNED DRIVER ELRAWDSK UPON ITS LOADING IN THE SYSTEM.** **SCREENSHOT FROM WINOBJEX64.EXE.**\n\n**8.** Extracts the wiper malware resource “agent.exe”, decrypts it, and then writes the\n\nresource to a file on the current directory of the dropper malware “dustman.exe”.\n\n**FIGURE 14: AGENT.EXE IS THE LAST FILE TO BE DROPPED**\n\n**9.** Enumerates the different volumes on the system using the system call\n\n“GetLogicalDriveStringsW”.\n\n**FIGURE 15:** **GETLOGICALDRIVESTRINGW IS USED TO ENUMERATE ALL VOLUMES ON A WINDOWS SYSTEM**\n\n**10.** Starts the wiping process “agent.exe” for every volume on the system. The command\n\nused to wipe the volume will have the volume letter appended to the command, for\nexample, to wipe the C drive, the command would be\n“$:\\windows\\system32\\cmd.exe /c agent.exe C” where the “C” at the end of the\ncommand indicates the volume to be wiped.\n\n**FIGURE 16: DUSTMAN.EXE STARTING AGENT.EXE TO WIPE OUT THE C VOLUME**\n\n12\n\n\n-----\n\n**Technical Report**\n\n#### 3.2.2. Agent.exe\n\nThe wiper “agent.exe” follows the below steps to achieve its destructive purposes:\n\n**1.** Reads the command line arguments to determine the disk to be wiped.\n\n**FIGURE 17:** **SYSTEM CALL TO READ THE COMMAND LINE ARGUMENTS**\n\n**2.** Initialize a buffer that contains a message.\n\n**3.** Creates a handle to the Eldo RawDisk driver. The driver was already loaded by\n\n“dustman.exe” as a system driver and should be ready for usage. When creating a\nhandle to the driver, the string:\n(b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d)\nis appended to the driver name “ElRawDisk” and the volume to be accessed utilizing\nthe drive “C”. We believe this string to be the license key for Eldos.\n\n**4.** Retrieves information about the disk to be wiped including its geometry and length\n\nusing multiple calls of “DeviceIOControl” with different control codes.\n\n**5.** Starts a loop to overwrite all data in the volume utilizing the Eldos RawDisk driver and\n\nthe system call “DeviceIOControl”. In each loop iteration, 40,960 (40 KB) bytes are\noverwritten.\n\n**FIGURE 18:** **LOOP TO OVERWRITE THE VOLUME**\n\n**6.** If successful, a blue screen will be displayed to the user as shown in “Figure 19”.\n\n**FIGURE 19:** **COMPUTER SCREEN UPON CRASHING THE SYSTEM AFTER IT IS WIPED**\n\n13\n\n\n-----\n\n**Technical Report**\n\n### 4. Host Indicator of Comprise \n\nName dustman.exe\nMD5 Hash 8AFA8A59EEBF43EF223BE52E08FCDC67\nSHA-1 Hash E3AE32EBE8465C7DF1225A51234F13E8A44969CC\nSHA-256 Hash F07B0C79A8C88A5760847226AF277CF34AB5508394A58820DB4DB5A8D0340FC7\nSize 264,704 (bytes)\nType 64-bit EXE\nCompilation Date Sun Dec 29 08:57:19 2019 (GMT+3)\n\nName elrawdsk.sys\nMD5 Hash 993E9CB95301126DEBDEA7DD66B9E121\nSHA-1 Hash A7133C316C534D1331C801BBCD3F4C62141013A1\nSHA-256 Hash 36A4E35ABF2217887E97041E3E0B17483AA4D2C1AEE6FEADD48EF448BF1B9E6C\nSize 24,576 (bytes)\nType 64-bit EXE\nCompilation Date Sun Oct 14 10:43:19 2012(GMT+3)\n\nName assistant.sys\nMD5 Hash EAEA9CCB40C82AF8F3867CD0F4DD5E9D\nSHA-1 Hash 7C1B25518DEE1E30B5A6EAA1EA8E4A3780C24D0C\nSHA-256 Hash CF3A7D4285D65BF8688215407BCE1B51D7C6B22497F09021F0FCE31CBEB78986\nSize 68,288 (bytes)\nType 64-bit EXE\nCompilation Date Sat May 31 05:18:53 2008 (GMT+3)\n\nName agent.exe\nMD5 Hash F5F8160FE8468A77B6A495155C3DACEA\nSHA-1 Hash 20D61C337653392EA472352931820DC60C37B2BC\nSHA-256 Hash 44100C73C6E2529C591A10CD3668691D92DC0241152EC82A72C6E63DA299D3A2\nSize 116,224 (bytes)\nType 64-bit EXE\nCompilation Date Sun Dec 29 08:56:27 2019 (GMT+3)\n\n14\n\n|Name dustman.exe|Col2|\n|---|---|\n|MD5 Hash 8AFA8A59EEBF43EF223BE52E08FCDC67||\n|SHA-1 Hash E3AE32EBE8465C7DF1225A51234F13E8A44969CC||\n|SHA-256 Hash F07B0C79A8C88A5760847226AF277CF34AB5508394A58820DB4DB5A8D0340FC7||\n|Size 264,704 (bytes)||\n|Type 64-bit EXE||\n|Compilation Date|Sun Dec 29 08:57:19 2019 (GMT+3)|\n\n|Name elrawdsk.sys|Col2|\n|---|---|\n|MD5 Hash 993E9CB95301126DEBDEA7DD66B9E121||\n|SHA-1 Hash A7133C316C534D1331C801BBCD3F4C62141013A1||\n|SHA-256 Hash 36A4E35ABF2217887E97041E3E0B17483AA4D2C1AEE6FEADD48EF448BF1B9E6C||\n|Size 24,576 (bytes)||\n|Type 64-bit EXE||\n|Compilation Date|Sun Oct 14 10:43:19 2012(GMT+3)|\n\n|Name assistant.sys|Col2|\n|---|---|\n|MD5 Hash EAEA9CCB40C82AF8F3867CD0F4DD5E9D||\n|SHA-1 Hash 7C1B25518DEE1E30B5A6EAA1EA8E4A3780C24D0C||\n|SHA-256 Hash CF3A7D4285D65BF8688215407BCE1B51D7C6B22497F09021F0FCE31CBEB78986||\n|Size 68,288 (bytes)||\n|Type 64-bit EXE||\n|Compilation Date|Sat May 31 05:18:53 2008 (GMT+3)|\n\n|Name agent.exe|Col2|\n|---|---|\n|MD5 Hash F5F8160FE8468A77B6A495155C3DACEA||\n|SHA-1 Hash 20D61C337653392EA472352931820DC60C37B2BC||\n|SHA-256 Hash 44100C73C6E2529C591A10CD3668691D92DC0241152EC82A72C6E63DA299D3A2||\n|Size 116,224 (bytes)||\n|Type 64-bit EXE||\n|Compilation Date|Sun Dec 29 08:56:27 2019 (GMT+3)|\n\n\n-----\n\n**Technical Report**\n\n### 5. Tactical Recommendations:\n\n##### Preventative measures:\n\n**1.** Update all security devices, windows servers and workstations with the latest updates\n\nand signatures.\n**2.** Ensure to block VirtualBox’s driver (i.e. vboxdrv.sys) from loading on all systems. This\n\ncan be done by blocking the following hash on EDR/Anti-virus system:\n\n     - eaea9ccb40c82af8f3867cd0f4dd5e9d, The driver might be renamed so\n\nblocking the filename would not be sufficient.\n**3.** Ensure that service accounts are not member of the Domain/Enterprise Admins or\n\nAdministrators groups.\n**4.** Ensure that privileged accounts are not shared or used as service accounts.\n**5.** Implement privileged access workstations (PAWs) for personnel with administrative\n\nprivileges. PAWs should be physically secured devices, and cannot be accessed\nremotely. Administrative tasks, such as Remote access, can only be performed from\nthese workstations.\n**6.** Implement Local Administrator Password Solution (LAPS) on servers and workstations\n\nto prevent Pass-the-hash attacks and other similar internal pivoting attacks, it\nmitigates the risk of lateral escalation that results when you have the same\nadministrative local account and password combination on many computers.\n**7.** Prevent the local admin account from authenticating over the network as specified in:\n\nhttps://blogs.technet.microsoft.com/secguide/2014/09/02/blocking-remote-use-of-localaccounts/\n**8.** Validate the business requirements and the risks of allowing Virtual Private Network\n\n(SSL VPN) connections. By checking the following:\n\n     - Ensure the access control list is properly configured (Unused accounts,\n\ndefault accounts, resigned users, test accounts.)\n\n     - Block access for administrators and management users with high privileges.\n\n     - Implement Multi-factor authentication (MFA) for allowed users.\n\n     - Prevent access from countries known for malicious activities.\n\n     - Implement a Lockout mechanism for failed attempts after a specific number\n\ne.g 3 failed attempts.\n\n     - Enable access logging for successful and failed attempts.\n\n     - Review (if enabled) the access logs for at least six months for any uncommon\n\nor suspicious logs. For example: unusual access times, unusual source\nlocations, unusual users from different location, high number of failed\nattempts to logon, access from external VPN services or infrastructure of\nother compromised organizations.\n\n15\n\n\n-----\n\n**Technical Report**\n\n     - If the used SSLVPN solution is a product of Palo Alto, Pulse Secure or Fortinet,\n\nPerform a comprehensive review on logs, account usage and any\nconfiguration changes.\n**9.** Reset passwords for all privileged accounts including domain administrators’\n\naccounts, network devices accounts.\n**10.** Prevent workstation-to-workstation communications using host-based firewalls. The\n\ndefault policy should be to deny all incoming connection requests. Exceptions should\nbe made for connections originating from domain controllers, patch management or\nconfiguration servers, systems belonging to helpdesk personnel, and other systems\nthat have a business need to connect to workstations.\n**11.** Disable and delete PowerShell V2, and Ensure to only allow PowerShell V5, or\n\nPowerShell V6 across the organization. If possible, prevent the execution of\nPowerShell on machines not requiring the usage of PowerShell.\n**12.** Ensure that all privileged activities are logged, also ensure to enable Command-line\n\nLogging through: https://docs.microsoft.com/en-us/windowsserver/identity/adds/manage/componentupdates/command-line-process-auditing\n**13.** It's critical to review any generated data to detect active compromises\n**14.** If MFA is not present, it is highly recommended to disable all Remote Access Services\n\nuntil it is properly implemented.\n**15.** If SMS is used as an MFA method, ensure that users cannot change the assigned\n\nnumber without being reviewed and verified by an administrator.\n**16.** Backup all Critical servers/data and make sure to have an offline backup isolated from\n\nthe network and perform a restore test to validate the backups\n\n##### Detective measures: \n\n**1.** Review and validate any recently created accounts (normal users and high privileged\n\naccounts).\n**2.** Review and validate all Domain/Enterprise Admin accounts and service accounts; all\n\nunused accounts should be disabled or deleted.\n**3.** Perform Yara Rules scanning on all internet facing and critical servers.\n**4.** Search of any new scheduled tasks on critical servers in which suspicious\n\ncommands/activities are configured to run.\n\n     - Enable PowerShell’s module logging, script block logging, and transcription\n\nlogging and review all generated logs.\n\n     - Enable PowerShell constrained-mode for both interactive input and user\nauthorized scripts.\n**5.** Review/scan for any usage of PSExec or any similar tool within the network in the last\n\ntwo months.\n**6.** Increase monitoring activities looking for the following events:\n\n16\n\n\n-----\n\n**Technical Report**\n\n    - Usage of Guest and/or VMware accounts.\n\n    - Creation of high-privileged accounts.\n\n    - Unusual authentication activities on multiple servers by high-privileged\n\naccounts.\n\n    - Network devices logs (DNS, DHCP, Netflow and proxy).\n\n    - Newly registered schedule task :EventID:106\n\n    - usage of WinRM (if enabled):\n\n        - EventID: 6 - Creating WSMAN Session\n\n        - EventID: 169 - User Authentication: authenticated successfully\n\n    - Usage of RDP Authentication: EventID 21: Remote Desktop Services: Session\n\nlogon succeeded\n\n    - Account logon: EventID: 4624 - An account was successfully logged on.\n\npossibly dangerous Logon types are:\n\n        - 3 = Network,\n\n        - 10 =Remote Interactive\n\n    - A specified logon attempt by particular account: EventID 4648 - A logon was\n\nattempted using explicit credentials. possibly dangerous Logon types are:\n\n        - 3 = Network,\n\n        - 10 =Remote Interactive\n\n    - If Sysmon is installed and deployed, review Sysmon log for EventID\n\n        - 1 = Process Creation\n\n        - 8 = CreateRemoteThread detected\n\n    - Deletion of Windows Event logs, Event ID 1102.\n**7.** Ensure proper configuration of the Security Information Event Management (SIEM) or\n\nlog analytics system so that events can be correlated from all devices on the network.\nThis should also include VPN logs.\n**8.** Ensure that alerts are generated for all suspicious activity on the network (e.g. port\n\nscanning, remote connections, using local administrator accounts over the network).\n**9.** Configure all IIS logs, and other similar systems, to log the external IP addresses\n\ninstead of the load balancer/proxy internal IP by enabling the X-forwarded function.\n**10.** Export security related logs to secure offline location periodically.\n**11.** Perform regular scanning for unauthorized software. This includes alerting when\n\nunrecognized binaries (executable files, DLL's and other libraries, etc.) are found on a\nsystem, even inside of compressed archives.\n**12.** Ensure that all IOCs shared by NCSC and other security vendors have been consumed\n\nby the available security products.\n\n\n17\n\n\n-----\n\n**Technical Report**\n\n### Appendix\n\n##### YARA Rules\n\n**Dustman.exe**\nimport \"pe\"\n\nrule dustman {\nmeta:\nhash1 = \"f07b0c79a8c88a5760847226af277cf34ab5508394a58820db4db5a8d0340fc7\"\nstrings:\n$x1 = \"C:\\\\windows\\\\system32\\\\cmd.exe\" fullword ascii\n$x2 = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\Dustman\\\\x64\\\\Release\\\\Dustman.pdb\" fullword ascii\n$s3 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s4 = \"elrawdsk.sys\" fullword wide\n$s5 =\n\"qpppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp\npppppppppppppppppppppppppppqphppphpp\" fullword ascii\n$s6 =\n\"Wpppppppppppppppqpppfppprppprpppsppprppptppphpppuppp}pppvpppypppwppp|pppxppp|pppyppp|pp\npzpppwppp{pppxppp|pppfppp}pppfppp\" fullword ascii\n$s7 =\n\"ipppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp\npppppppppppppppppppppppppppppppppOp0qppp\" fullword ascii\n$s8 =\n\"!q0qpppyPppppppp\\\"q0qpppzPpppppp`\\\"q0qpppKPppppppP\\\"q0qpppqTpppppp@\\\"q0qpppyTpppppp0\\\"q0\nqpppzTpppppp \\\"q0qpppKTpppppp\" fullword ascii\n$s9 =\n\"qppppp{0x.pppp~ppppppppppppppppqpppppppppppppppppppppppppppppppppppppppppppppppppppppp\npppppppppppppppppppppppppppppppp0\" fullword ascii\n$s10 =\n\"ppLSppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp\nppppppppppppppppppppp8\" fullword ascii\n$s11 =\n\"\\\"q0qpppqDppppppp#q0qpppyDpppppp`#q0qpppzDppppppP#q0qpppqHpppppp@#q0qpppzHpppppp0#q0q\npppqLpppppp #q0qpppzLpppppp\" fullword ascii\n$s12 = \"zpppppp\" fullword ascii /* reversed goodware string 'ppppppz' */\n$s13 = \"ppprppp`ppp}pppapppbpppbppprpppQppp}pppEppprppp1ppp}ppp3ppprppp\npppappp\\\"ppp}ppp#ppp}ppp'pppfppp)ppp{ppp\" fullword ascii\n$s14 = \"/c agent.exe A\" fullword ascii\n$s15 =\n\"<q0qpppOtppppppp=q0qppp0tpppppp`=q0qppp1tppppppP=q0qppp3tpppppp@=q0qppp4tpppppp8=q0qppp\n5tpppppp(=q0qppp6tpppppp\" fullword ascii\n$s16 = \"<pp[=ppq?pppeeeqeeereeeseeeteeeueeeveeeweeexeeeyeeezeee{eee|eee}eee~eee\" fullword\nascii\n$s17 = \"\\\\assistant.sys\" fullword wide\n$s18 =\n\":q0qpppitppppppx;q0qpppjtpppppph;q0qpppktppppppX;q0qpppltppppppH;q0qpppmtpppppp8;q0qpppntpp\npppp(;q0qpppotpppppp\" fullword ascii\n\n18\n\n\n-----\n\n**Technical Report**\n\n$s19 =\n\">q0qpppjxppppppx?q0qpppmxppppppP?q0qppp\\\\xpppppp@?q0qpppKxpppppp8?q0qpppNxpppppp(?q0qpp\np3xpppppp\" fullword ascii\n$s20 = \";q0qpppZtppppppx<q0qppp[tpppppph<q0qppp\\\\tppppppX<q0qppp]tpppppp0<q0qppp_tpppppp\n<q0qpppBtpppppp\" fullword ascii\ncondition:\n( uint16(0) == 0x5a4d and\nfilesize < 800KB and\npe.imphash() == \"47cb8a71a145ac31ea5df1b531c7fa09\" and\n( 1 of ($x*) or 4 of ($s*) )\n) or ( all of them )\n}\n\n**elrawdsk.sys**\nimport \"pe\"\n\nrule elrawdsk {\nmeta:\nhash1 = \"36a4e35abf2217887e97041e3e0b17483aa4d2c1aee6feadd48ef448bf1b9e6c\"\nstrings:\n$x1 = \"c:\\\\projects\\\\rawdisk\\\\bin\\\\wnet\\\\fre\\\\amd64\\\\elrawdsk.pdb\" fullword ascii\n$s2 = \"elrawdsk.sys\" fullword wide\n$s3 = \"RawDisk Driver. Allows write access to files and raw disk sectors for user mode applications in\nWindows 2000 and later.\" fullword wide\n$s4 = \"\\\\DosDevices\\\\ElRawDisk\" fullword wide\n$s5 = \"Copyright (C) 2007-2012, EldoS Corporation \" fullword wide\n$s6 = \"IoGetDiskDeviceObject\" fullword wide\n$s7 = \"\\\\#{9A6DB7D2-FECF-41ff-9A92-6EDA696613DF}#\" fullword wide\n$s8 = \"\\\\#{8A6DB7D2-FECF-41ff-9A92-6EDA696613DE}#\" fullword wide\n$s9 = \"EldoS Corporation\" fullword wide\n$s10 = \"{25EC4453-AB06-4b3f-BCF0-B260A68B64C9}\" fullword ascii\n$s11 = \"\\\\Device\\\\ElRawDisk\" fullword wide\n$s12 = \"###ElRawDiskAMD64###\" fullword ascii\ncondition:\n( uint16(0) == 0x5a4d and\nfilesize < 70KB and\npe.imphash() == \"6863bacaac5428e1e55a107a613c0717\" and\n( 1 of ($x*) or 4 of ($s*) )\n) or ( all of them )\n}\n\n**assistant.sys**\nimport \"pe\"\n\nrule assistant {\nmeta:\nhash1 = \"cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986\"\nstrings:\n$x1 = \"C:\\\\vbox\\\\branch\\\\w641.6\\\\out\\\\win.amd64\\\\release\\\\obj\\\\src\\\\VBox\\\\HostDrivers\\\\VBoxDrv\\\\VBoxDrv.pdb\" fullword ascii\n$s2 = \"C:\\\\vbox\\\\branch\\\\w64-1.6\\\\src\\\\VBox\\\\Runtime\\\\r0drv\\\\memobj-r0drv.cpp\" fullword ascii\n\n19\n\n\n-----\n\n**Technical Report**\n\n$s3 = \"VBoxDrv.sys\" fullword ascii\n$s4 = \"vboxdrv: Bad ioctl request header; cbIn=%#lx cbOut=%#lx fFlags=%#lx\" fullword ascii\n$s5 = \"SUP_IOCTL_COOKIE: Version mismatch. Requested: %#x Min: %#x Current: %#x\" fullword ascii\n$s6 = \"SUP_IOCTL_QUERY_FUNCS: Invalid input/output sizes. cbIn=%ld expected %ld. cbOut=%ld expected\n%ld.\" fullword ascii\n$s7 = \"SUP_IOCTL_PAGE_ALLOC: Invalid input/output sizes. cbIn=%ld expected %ld. cbOut=%ld expected\n%ld.\" fullword ascii\n$s8 = \"SUP_IOCTL_LOW_ALLOC: Invalid input/output sizes. cbIn=%ld expected %ld. cbOut=%ld expected\n%ld.\" fullword ascii\n$s9 = \"SUP_IOCTL_LDR_LOAD: Invalid input/output sizes. cbIn=%ld expected %ld. cbOut=%ld expected\n%ld.\" fullword ascii\n$s10 = \"SUP_IOCTL_PAGE_LOCK: Invalid input/output sizes. cbIn=%ld expected %ld.\" fullword ascii\n$s11 = \"SUP_IOCTL_CALL_VMMR0: Invalid input/output sizes. cbIn=%ld expected %ld. cbOut=%ld expected\n%ld.\" fullword ascii\n$s12 = \"VBoxDrvLinuxIOCtl: too much output! %#x > %#x; uCmd=%#x!\" fullword ascii\n$s13 = \"supdrvLdrFree: Image '%s' has %d dangling objects!\" fullword ascii\n$s14 = \"SUP_IOCTL_PAGE_LOCK: Invalid input/output sizes. cbOut=%ld expected %ld.\" fullword ascii\n$s15 = \"!supdrvCheckInvalidChar(pReq->u.In.szName, \\\";:()[]{}/\\\\\\\\|&*%#@!~`\\\\\\\"'\\\")\" fullword ascii\n$s16 = \"\\\\DosDevices\\\\VBoxDrv\" fullword wide\n$s17 = \"SUP_IOCTL_LDR_GET_SYMBOL: %s\" fullword ascii\n$s18 = \"pReq->Hdr.cbIn <= SUP_IOCTL_PAGE_ALLOC_SIZE_IN\" fullword ascii\n$s19 = \"pReq->Hdr.cbIn <= SUP_IOCTL_LOW_ALLOC_SIZE_IN\" fullword ascii\n$s20 = \"SUP_IOCTL_LDR_LOAD: sym #%ld: unterminated name! (%#lx / %#lx)\" fullword ascii\ncondition:\n( uint16(0) == 0x5a4d and\nfilesize < 200KB and\npe.imphash() == \"b262e8d078ede007ebd0aa71b9152863\" and pe.exports(\"AssertMsg1\") and\npe.exports(\"RTAssertDoBreakpoint\") and pe.exports(\"RTMpDoesCpuExist\") and pe.exports(\"SUPR0ContAlloc\")\nand pe.exports(\"SUPR0ContFree\") and pe.exports(\"SUPR0GipMap\") and\n( 1 of ($x*) or 4 of ($s*) )\n) or ( all of them )\n}\n\n**agent.exe**\nimport \"pe\"\n\nrule agent {\nmeta:\nhash1 = \"44100c73c6e2529c591a10cd3668691d92dc0241152ec82a72c6e63da299d3a2\"\nstrings:\n$x1 = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\Dustman\\\\Furutaka\\\\drv\\\\agent.plain.pdb\" fullword ascii\n$s2 = \"************** “The Political Statement” ************** \" fullword ascii\n$s3 = \"api-ms-win-core-synch-l1-2-0.dll\" fullword wide\n$s4 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s5 = \"b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\" fullword wide\n$s6 = \"operator co_await\" fullword ascii\n$s7 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s8 = \"bad array new length\" fullword ascii\n$s9 = \".CRT$XIAC\" fullword ascii\n$s10 = \".?AVERDError@@\" fullword ascii\n$s11 = \".?AVbad_array_new_length@std@@\" fullword ascii\n$s12 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide\n\n20\n\n\n-----\n\n**Technical Report**\n\n\n$s13 = \"api-ms-win-core-file-l1-2-2\" fullword wide\n$s14 = \".CRT$XCL\" fullword ascii\ncondition:\n( uint16(0) == 0x5a4d and\nfilesize < 300KB and\npe.imphash() == \"75f159bf634600808810849f244592eb\" and\n( 1 of ($x*) or 4 of ($s*) )\n) or ( all of them )\n}\n\n21\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.01.07_Destructive_Attack_DUSTMAN/Saudi-Arabia-CNA-report.pdf"
    ],
    "report_names": [
        "Saudi-Arabia-CNA-report"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/bfa9143ed25f03e8a3273a392583de3292d64e35.pdf",
        "text": "https://archive.orkl.eu/bfa9143ed25f03e8a3273a392583de3292d64e35.txt",
        "img": "https://archive.orkl.eu/bfa9143ed25f03e8a3273a392583de3292d64e35.jpg"
    }
}