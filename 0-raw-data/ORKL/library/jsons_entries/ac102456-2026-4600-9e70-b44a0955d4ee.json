{
    "id": "ac102456-2026-4600-9e70-b44a0955d4ee",
    "created_at": "2023-01-12T15:06:31.436448Z",
    "updated_at": "2025-03-27T02:17:05.697331Z",
    "deleted_at": null,
    "sha1_hash": "9a8e88b6a68a9a9311dece07d37246e16c792546",
    "title": "2022-12-22 - New RisePro Stealer distributed by the prominent PrivateLoader",
    "authors": "",
    "file_creation_date": "2022-12-29T00:40:14Z",
    "file_modification_date": "2022-12-29T00:40:14Z",
    "file_size": 1475502,
    "plain_text": "# New RisePro Stealer distributed by the prominent PrivateLoader\n\n**[blog.sekoia.io/new-risepro-stealer-distributed-by-the-prominent-privateloader/](https://blog.sekoia.io/new-risepro-stealer-distributed-by-the-prominent-privateloader/)**\n\n22 December 2022\n\n### Log in\n\nWhoops! You have to login to access the Reading Center functionalities!\n\n[Forgot password?](https://blog.sekoia.io/wp-login.php?action=lostpassword)\n\n### Search the site...\n\nAll categories\n[Blogpost](https://blog.sekoia.io/category/blogpost/)\n[Blogpost](https://blog.sekoia.io/category/blogpost-en/)\n\nReset\n\n[Threat & Detection Research Team\nDecember 22 2022](https://blog.sekoia.io/author/tdr/)\n300\n0\n\nRead it later\nRemove\n\n18 minutes reading\n\n\n-----\n\n## Context\n\n**PrivateLoader is an active malware in the loader market, used by multiple threat actors to**\n[deliver various payloads, mainly information stealer. Since our previous investigation, we keep](https://blog.sekoia.io/privateloader-the-loader-of-the-prevalent-ruzki-ppi-service/)\ntracking the malware to map its ecosystem and delivered payloads. Starting from this tria.ge\nsubmission, we recognized a now familiar first payload, namely PrivateLoader. However, the\ndropped stealer was not part of our stealer growing collection, notably including RedLine or\n**Raccoon. Eventually SEKOIA.IO realised it was a new undocumented stealer, known as**\n**RisePro. This article aims at presenting SEKOIA.IO RisePro information stealer analysis.**\n\n## Quick infection review\n\nBased on the tria.ge submission, the first payload is a PrivateLoader. The sample fetches a\ndocument hosted on sun6-23.userapi.com. This dropped file is the starting point of this\nanalysis.\n\nThe downloaded file is obfuscated using bytes substitution followed by a XOR operation with\na fixed key. (See: deobfuscation script in the annex). Tria.ge automatic analysis suggests a\nstealer.\n\nPrivateLoader SHA-1: da3aea62ddf57c895acf630b62e972ef70defb60\nDownload BMP SHA-1: d94e061e93f7ac003b01c0c9d12dbbb26f87d13e\nDeobfuscated BMP SHA-1: 17ba58fcfe47c49baeaba9aaebd8f888ed2d9473\n\n_NB-1: The PCAP of the initial payload shows requests to RisePro infrastructure before_\n_PrivateLoader communication. Hypotheses about the future of the Stealer are presented in_\n_the conclusion._\n\n_NB-2: The name of the distributed payload by PrivateLoader is StealerClient.bmp._\n\n## Malware analysis\n\nThe stealer offers similar functionalities as other malware of the family. It targets a wide range\nof web browsers for credentials, cookies, credit cards and crypto wallet via web browser\n**extensions and 2FA software, and a file grabber functionality. To reduce its detection,**\nRisePro hides its configuration such as string or imported DLLs using XOR instructions using\ndifferent keys. The malware communicates over HTTP and content of the communication is\nobfuscated using bytes substitutions and XOR operations. Finally, the malware has the\ncapability to load **other** **payloads.**\n\n\n-----\n\n_Figure 1._\n\n_Overview of RisePro stealer delivered by Privateloader_\n\n## Dynamic lookup of APIs via GetProcAddress\n\nThe malware obfuscates its strings using XORed 128 bits (representing integer data). The\nimage below highlights the deobfuscation routine, as well as the dynamic function loading\nusing the technique GetModuleHandle technique associated with GetProcAddress.\n\n\n-----\n\n_Figure 2. String deobfuscation routine used to load RtlGetVersion from ntdll.dll_\n\n## Embedded DLLs\n\nSome samples of RisePro embed legitimate DLLs such as sqlite3.dll and mozglue.dll used to\naccess the web browsers data. Theses DLLs are stored in cleartext in the PE, they are\ndumped on the disk in the working directory of the malware: (working directory is composed of\n_C:\\Users\\Admin\\AppData\\Local\\Temp\\ followed by LocalSimbaD and ten random alphanum_\ncharacters).\n\n\n-----\n\n_Figure 3. DLLs dumping into the malware working directory_\nIn case these DLLs are not embedded in the malware, it fetches them on its C2 by requesting\nthe /get_library endpoint with a POST request, where the body of the request is ‘name=<dll\n_name>’. The server answers the URL to download the requested DLLs. Every C2 tracked by_\nSEKOIA.IO host the DLLs under the /static/ directory:\n\n_Figure 4. Hosted DLLs under /static/_\n\n_web directory_\n\n## Host fingerprinting\n\nRisePro Stealer has a fingerprint capability, all information are retrieved in the following\nregistry keys:\n\nSOFTWARE\\Microsoft\\Cryptography\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\nHARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\n\n\n-----\n\nThe fingerprinting is gathered and saved at the beginning of the file informations.txt exfiltrated\nto the C2 at a later stage during the infection process.\n\nRisePro retrieves the infected host public IP address with a fallback functionality. It attempts to\nget this information from ipinfo.io fails, it tries on api.db-ip.com. Should this also fail, a last\noption is to contact maxmind.com which is a service for IP address geolocalisation.\n\nThe stealer also takes a screenshot of the infected host.\n\n_Figure_\n\n_5. Analysis of the screenshot functionality_\nIf the screenshot is saved in the working directory of the malware as screenshot.png, the file\nwill also be exfiltrated by the malware in the ZIP file.\n\n## Stolen Information\n\nThe stealer targets cookies, saved passwords, saved credit cards and crypto wallets and also\ninstalled softwares for credentials.\n\n**Web browsers: Google Chrome, Firefox, Maxthon3, K-Melon, Sputnik, Nichrome, Uran,**\nChromodo, Netbox, Comodo, Torch, Orbitum, QIP Surf, Coowon, CatalinaGroup Citrio,\nChromium, Elements, Vivaldi, Chedot, CentBrowser, 7start, ChomePlus, Iridium, Amigo,\nOpera, Brave, CryptoTab, Yandex, IceDragon, BlackHaw, Pale Moon, Atom.\n\n**Browser extensions: Authenticator, MetaMask, Jaxx Liberty Extension, iWallet, BitAppWallet,**\nSaturnWallet, GuildWallet, MewCx, Wombat, CloverWallet, NeoLine, RoninWallet, LiqualityWallet,\nEQUALWallet, Guarda, Coinbase, MathWallet, NiftyWallet, Yoroi, BinanceChainWallet,\n\n\n-----\n\nTronLink, Phantom, Oxygen, PaliWallet, PaliWallet, Bolt X, ForboleX, XDEFI Wallet, Maiar\nDeFi Wallet.\n\n**Software: Discord, battle.net, Authy Desktop.**\n\n**Cryptocurrency assets : Bitcoin, Dogecoin, Anoncoin, BBQCoin, BBQCoin, DashCore,**\nFlorincoin, Franko, Freicoin, GoldCoin (GLD), IOCoin, Infinitecoin, Ixcoin, Megacoin, Mincoin,\nNamecoin, Primecoin, Terracoin, YACoin, Zcash, devcoin, digitalcoin, Litecoin, Reddcoin.\n\nThe stealer also looks for particular file patterns, for example receipt with credit card\ninformation in common folders (for instance, Desktop, Download, %TEMP%).\n\nAs previously introduced, stolen data are copied to the working directory of the malware to be\ncompressed in a ZIP file, exfiltrated during the late HTTP message.\n\n_Figure 6. RisePro working directory snapshot at the late stage of its infection_\nThe filename of the stolen data respects the format: `country code_victim ip address.zip`.\n\n## Command and Control communication\n\nMethod Endpoint Parameter(s) Response\n\nGET /pingmap.php Constant string : 918_tok\n\nGET /freezeStats.php uid\n\nPOST /get_marks.php uid {“success”:true,”result”:{“marks”:[]}}\n\n\n-----\n\nPOST /get_settings.php uid {“success”:true,”result”:{“settings”:\n\n{\n“_id”:”62b109591bde0e1b356c4c3b”,\n\n“HWIDduplicatesDay”:true,\n\n“HWIDduplicates”:false,\n\n“IPduplicates”:false,\n\n“telegram”:true,\n\n“discord”:true,\n\n“screenshot”:true,\n\n“cryptoWallets”:true,\n\n“netHistory”:true,\n\n“staticMarks”:””,\n\n“telegramIds”:”463473532″],\n\n“createdAt”:”2022-0620T23:57:13.984Z”,\n\n“__v”:0}}}\n\nPOST /get_grabbers.php uid {“success”:true,”result”:{“grabbers”:\n\n[]}}\n\nPOST /get_loaders.php uid {“success”:true,”result”:{“loaders”:[]}}\n\n\nPOST /set_file.php Multi form, first one is\nthe uid, the second\nform is a boundary\nfile which contains a\nZIP file obfuscated\n\n_Table 1. HTTP endpoint of the Command and Control_\n\n\nJSON with status\n\n\n_Figure 7. Summary of RisePro HTTP communication with its C2_\nWhile RisePro communicates over HTTP in JSON format, the exchanged messages are\nobfuscated, with bytes substitution and a XOR operation.\n\n\n-----\n\nThis obfuscation is interesting because it uses the same byte substitution tables as\nPrivateLoader. The only difference is the value of the XOR key, PrivateLoader uses the value\n_0x9d and RisePro uses 0x36. The similarity between these two malwares is detailed in the_\ndedicated section (c.f:. Similiarities)\n\nOriginal byte Replacement byte\n\n0x00 0x80\n\n0x80 0x0a\n\n0x0a 0x01\n\n0x01 0x05\n\n0x05 0xde\n\n0xde 0xfd\n\n0xfd 0xff\n\n0xff 0x55\n\n0x55 0x00\n\n_Table 2. Byte substitution_\n\n## Loader capability\n\nIt is likely that RisePro is able to load and execute a next stage, whose configuration is\ndynamically set by C2 communication on the /get_loader.php endpoint. This endpoint\nprovides the next payload to execute. As none of the RisePro samples analysed by\nSEKOIA.IO downloaded a next stage payload or used this functionality, we assess this feature\nis still under development.\n\n\n-----\n\n_Figure 8. Analysis of the_\n\n_next stage execution using ShellExecute function from shell32.dll_\nIn case RisePro is configured with a next stage, the PE will be written in the same malware\nworking directory.\n\n## Similarities\n\n Code & functionalities\n\nDuring our investigation, we observed PrivateLoader and RisePro Stealer’s behaviours\npartially overlap. Here is a list of specific functionalities shared by the two malware:\n\nStrings obfuscation technique: (xor operation on 128 bits (representing integer data),\npxor) with the same key for a set of functionalities;\nHTTP method and port setup;\nHTTP message obfuscated with the same mode (byte substitution with same\nreplacement values followed by a XOR operation);\n\nThe similarity spotted between these two malware is buttressed by the output of Bindiff, which\nshows more than 30% of code similarity.\n\n\n-----\n\n_Figure 9. Similarity of the function used to set up HTTP port._\nRisePro SHA-1: [f6f143269c430a30003b9027c0f90f59388d65e4](https://bazaar.abuse.ch/sample/0072e816b5cf54ce2f8105e3645c62b2eb1b4cf3903ef39b9964b9d801d8c62f/)\n\n[PrivateLoader SHA-1: d231903de12e11e94f3b52c5b71fe8a6ecf30458](https://bazaar.abuse.ch/sample/077225467638a420cf29fb9b3f0241416dcb9ed5d4ba32fdcf2bf28f095740bb/)\n\n## Infrastructure\n\nStarting from PrivateLoader wfsdragon.]ru domain, it is possible to pivot on the nameserver of\nthe domain (which is hosted on cloudflare) which return a long list of domain distributing\nPrivateLoader samples (cf.: Annexe: IoCs – Shared domains based on NS) and three\ndomains related to RisePro:\n\n_m-rise.]pro_\n_my-rise.]pro_\n_myrise.]pro_\n\n_PS: The previous query can be improved by a_record:104.21.0.0./16 to filter domains related_\n_to RisePro and PrivateLoader on the same NS`_\n\nFrom the list of domains returned by the first query, a new part PL infrastructure could be\nhighlighted by searching domains on this AS containing ‘files‘.\n\nAnother query used to increase visibility into PrivateLoader infrastructure is to search for\nURLs with the parameter ‘zip?c=‘ which translates into the following query: ‘entity:url url:”.zip?\n_c=”‘ hostname:file’. Moreover, since early December, the threat actors expanded their_\ninfrastructure to include a new pattern for its delivery domain, which can be retrieved with the\nfollowing query: ‘entity:url url:”.zip?c=” hostname:soft‘.\n\n_NB: A majority of the domains with the ‘file’ pattern where used during October and November_\n_but are down by now._\n\n\n-----\n\nBesides, the two domains extracted from RisePro samples:\n\n_gamefilescript.]com_\n_neo-files.]com_\n\nSEKOIA.IO analysts pivot on the whois record with the following virus total query:\n‘entity:domain ( whois:be03d85074711f86 OR whois:b4208f2c291398c5 )‘ yielding a long list\nof domain that again contains ‘file‘. (cf.: Annexe: IoCs – Domains share same whois)\n\nWhile browsing the domains, it appears there are download link managers, the final payload\nare password protected archives hosted on compromised WordPress. As shown by figure 10,\nwebsites are only used to provide instructions (Download URL and archive password).\n\n_Figure 10. Example of a distribution website._\nThe redirect URL to download the malware changed regularly, at least once a day. Most of the\ndistribution domains are now down or for sale, which highlights the volatility of their\ninfrastructure.\n\n\n-----\n\nThe payload available for download on compromised WordPress is PrivateLoader that installs\na package of information stealer (RedLine, MixLoader, Vidar, etc…) for instance: Tria.ge :\n2507f7ca248884372a3088bf6413bd8292f898ca.\n\n## Accesses & Support – Contacts\n\nRisePro is available for sale on the Telegram account of the developper:\n_hxxps://t.]me/RiseProSUPPORT which is an obfuscated string embedded in the PE. There is_\nalso a Telegram channel to interact with infected hosts: hxxps://t.]me/RisePro (name: Rise\nbot). To interact with the host, attackers must provide the bot ID defined by the bot itself, and\nsent to the C2 during the infection c.f.: Table 1, endpoint: /set_file.php response.\n\nThreat Actors have access to the stolen data on the administration panel hosted at:\n_hxxps://my-rise.]cc. To create an account the provided email address must be trusted by the_\nsolution. The domain my-rise.cc serves as a front end, and all requests are sent to the\nsubdomain api.my-rise.]cc.\n\n\n-----\n\n_Figure 11. Authentication page of the Command and Control panel of RisePro Stealer_\n\n\n-----\n\n_Figure 12. Screenshot of the telegram bot used to interact with the infected host_\n\n## Conclusion\n\nSEKOIA.IO analysts understanding of the threat is that PrivateLoader is still active and\ncomes with a set of new capabilities. Similarities between the stealer and PrivateLoader\ncould not be ignored and provides additional insight into the threat actor expansion.\n\nSEKOIA.IO analysts first hypothesis is that RisePro Stealer might be a simple PrivateLoader\n**version with pre-configured build to download its own stealer (NB: Side note, this version**\n_does not use a Dead Drop Resolver technique). A second hypothesis is that PrivateLoader_\nsimply evolved and a different unidentified PPI vendor provides RisePro installation via\nPrivateLoader. At the time of writing, it is not clear whether RisePro is authored by\nPrivateLoader developers. Another intelligence gap is whether RisePro is offered by the same\nPPI service as PrivateLoader, or whether PrivateLoader authors maintain links with RisePro\nauthors. SEKOIA.IO analysts will keep tracking this threat to gain more knowledge into this\nspecific question, and welcome any input that could help us to fill the gap. SEKOIA.IO will\nkeep tracking this threat to provide as much as possible information to this question.\n\n## IoCs & Technical Details\n\n IoCs\n\n### RisePro C2\n\n108.174.199.]249\n108.174.200.]11\n108.174.198.]132\n\n\n-----\n\nmy-rise.]cc\napi.my-rise.]cc\n\n### Shared domains based on NS\n\ngreatsofteasy.]com\nfixgroupfactor.]com\nwebproduct25.]com\ngs24softeasy.]com\ntorggissoft.]com\nteleportsoft.]com\ntestitsoft.]com\nfactor1right.]com\nbest24-files.]com\nfirst-mirror.]com\nelite-hacks.]ru\njojo-files.]com\nmy-rise.]cc\nxx1-files.]com\nhero-files.]com\nmy-rise.]pro\nm-rise.]pro\npu-file.]com\npickofiles.]com\nvi-files.]com\nqd-file.]com\nuc-files.]com\nmyrise.]pro\nuni-files.]com\nfvp-files.]com\n\n### Domains sharing same whois\n\nget-files24.]com\nsofts-portal.]com\nboost-files.]com\nfiles-rate.]com\nget-24files.]com\nupxlead.]com\ngg-download.]com\nfiles-sender.]com\nrate-files.]com\ngg-loader.]com\n\n\n-----\n\nneo-files.]com\nvip-space.c]om\npin-files.]com\n\n### URLs with pattern zip?c=\n\nfilesuk.]com\nfilecryptobur.]com\nsocialfiletest.]com\nwww.filefactory.]com\nvi-files.]com\npu-file.]com\ntopfilesstorage.]com\nclubfiletyc.]com\nfilessoftpc.]com\nsmartfilegen.]com\nfilessite.]com\nspeedtestfile.]com\nfilesredproflex.]com\nfilefactory.]com\naccesstostofilestorage.]com\ngetfileasap1.]com\nfileswhiteprosoft.]com\nyfilesstorage1.]com\n\n### Samples\n\na5076f73a1cfd10fedf1368a26f9f358, 77270de2b41a639e9ca285f9014502a1a5b0b020,\nc70e26edeacbf1fa052f073959403ee9337a4aed13833553f8a3856fae013c9e\n76ef5db3addbe357e753de73e7db258e,\nc126c8cc75f6f6ac4b4af125b85c499814053094,\n478e97b727eb82979087c1d4c2450be18c2d3413ca8c648e7e2a067595ef8511\n9b98ec558eb6fe1e4055d7535e17e37c, 1e416f2c40dfc44e60a65df8fd57524bf8e6f5ad,\n5facf25f6b0d35a79444949b3175fabf3d788cbfbbbbb6551a867e1ddceb00a5\n2ecae8d74f6cedfe5f06fd424c3cdc77, 0812df9653b27d994eb5f62e243a63d3ea28b1ec,\n75b395cc766351e6f44f36dcbfdbabc2c4b43ef6fb26f845fb55569a57ebdbdd\na0dfcfb9936669128353663b82fa01b3,\n400d3908600b45a8e27f9133cb4950f1e11d5b8d,\n3fea5da905fb8cdb9ef203f85a2b0d37d9cbc8067fbf64d3e1849e84d99de3ee\ne6b0e14676e5b72a638a142e46f658d9,\n77723f0e3c933eff00e0ce1c823aee668d5c3bea,\n2d34e214cbb14456357d2e3381692d188b1004d8ff26280e430c716e6e3730b6\n\n\n-----\n\nac2eae79e66ddf808900b5e2e261da9b,\n69a403b81608457ad7106d4215e48e9207367f66,\n49fea24c6d2f6340755a22687a6daf63ff2692fe81e6e067b8b2465bc21f49f9\n12db8a9a0fb6baec2f801c640a8a4197, afa864c0d0fde050fd0d8694bf895b72d449969b,\nae8becfd65df0625c7e4f2069cb57e6f3c022aff24db51666b4d8b8c6ab15a15\nb3fbff1358ce82bc71009634c19ba2bf,\n4b3d77895cd313db37793db0e5eb5fa2859c01b2,\n28820e270265796566d6651f16651a5fd6c412b9290be07d2829c444d9392a02\ndbe7d59705f5f919cc6354b81d746584,\ncc6284365d1d47460bed78dce4e237b95166a859,\n3e38c14c9a27966b7768fa6a61a0bc86b79fdf8f554d232c26d0a13cd8dcdc36\n46847232153f38a0326fe0e677a25b9e, f2303a12b73b6b033dde297ef8bdaf3f4cba6864,\naa80643e117a896314fe6b1785cb65ab53561f66f5b679ba9f16a05f36e28674\n319e5fbf83add883095fef277ac8e092, 8ae961c6b93f01bb6d7927223041f2d18ed3a2f9,\nb295631063a6186a09a9dfee224bca7af6d4ab1650e9d63cdc325cf3fe1cd3d6\n5ab956806ec2e729b2c9c260ee3139f2,\ncb80fb19380b3dd20032763daa460af4452eebd7,\nffae7d880fcb139d03941e1bc658ce463e179435f438d945c74067fe291beb23\ndbe7d59705f5f919cc6354b81d746584,\ncc6284365d1d47460bed78dce4e237b95166a859,\n3e38c14c9a27966b7768fa6a61a0bc86b79fdf8f554d232c26d0a13cd8dcdc36\ne7cba894426bd9ca2cdc8b6d7ef31aae, 44afc3c4f62f062a746710440dde3ff7f29b4440,\nad75f79f985b4ec690fe9280108ae51cec8ef1650581ed4e26497a5e2c2f3ef9\n5df54fe48769bae887eaacb70eb23742, 0a20d79f8de58a088624f964f448846f5fe74afa,\n4107f3166ce3c67f375514ed039d663f197261126724f229e8d3cda2e62728d0\n0fc293ca3b73d1166ab149213ff1a240,\n8b2a98870e2a1bd02bf72fc262068d07e620a233,\n440cec1dd86d03c4e9a29a7b297a30a211f17d48828934a5a7121f1f4b97ef43\n0fc293ca3b73d1166ab149213ff1a240,\n8b2a98870e2a1bd02bf72fc262068d07e620a233,\n440cec1dd86d03c4e9a29a7b297a30a211f17d48828934a5a7121f1f4b97ef43\n0fc293ca3b73d1166ab149213ff1a240,\n8b2a98870e2a1bd02bf72fc262068d07e620a233,\n440cec1dd86d03c4e9a29a7b297a30a211f17d48828934a5a7121f1f4b97ef43\n5df54fe48769bae887eaacb70eb23742, 0a20d79f8de58a088624f964f448846f5fe74afa,\n4107f3166ce3c67f375514ed039d663f197261126724f229e8d3cda2e62728d0\n0fc293ca3b73d1166ab149213ff1a240,\n8b2a98870e2a1bd02bf72fc262068d07e620a233,\n440cec1dd86d03c4e9a29a7b297a30a211f17d48828934a5a7121f1f4b97ef43\n5df54fe48769bae887eaacb70eb23742, 0a20d79f8de58a088624f964f448846f5fe74afa,\n4107f3166ce3c67f375514ed039d663f197261126724f229e8d3cda2e62728d0\n\n\n-----\n\n0fc293ca3b73d1166ab149213ff1a240,\n8b2a98870e2a1bd02bf72fc262068d07e620a233,\n440cec1dd86d03c4e9a29a7b297a30a211f17d48828934a5a7121f1f4b97ef43\n5df54fe48769bae887eaacb70eb23742, 0a20d79f8de58a088624f964f448846f5fe74afa,\n4107f3166ce3c67f375514ed039d663f197261126724f229e8d3cda2e62728d0\nfd1cabdc949d19b07ca9bfa206ae8560,\nf0eea0d1acca29bc82bcfe94b1ccb28d04581579,\n057b33d69a28fb08733bb710ca22036aaee853791b958e8c4e0c81ae5eed6fcd\n95fa2ab112ca196dfe5bdf0c13dd9396,\nd1e5ad285bb4506ae77c589682a5bc0a2afdec35,\n58b1210213ac1cb9c4efe63d43390dfd43bf094408b16033f176e6700ad0fb29\n95fa2ab112ca196dfe5bdf0c13dd9396,\nd1e5ad285bb4506ae77c589682a5bc0a2afdec35,\n58b1210213ac1cb9c4efe63d43390dfd43bf094408b16033f176e6700ad0fb29\n03366311b4fbe98c0a919b210cf2fa2b, c3f5b4a2203bf7769963852070f75ae7540fd180,\n9564a7f5d7132fe8a97450e0fa4b628b7d802c885f034dc5d094260ff6a76716\n\n## Script\n\n\n-----\n\n```\nimport sys\n\nfrom copy import copy\n\n\ndef deobfuscate(filename: str) -> None:\n\n\n  print(f\"deobfuscate RisePro data: `{filename}`\")\n\n  with open(filename, \"rb\" )as f:\n\n    data = bytearray(f.read())\n\n  data2 = copy(data)\n\n  data2 = replace_all(data, data2, 0x00, 0x80)\n\n  data2 = replace_all(data, data2, 0x80, 0x0a)\n\n  data2 = replace_all(data, data2, 0x0a, 0x01)\n\n  data2 = replace_all(data, data2, 0x01, 0x05)\n\n  data2 = replace_all(data, data2, 0x05, 0xde)\n\n  data2 = replace_all(data, data2, 0xde, 0xfd)\n\n  data2 = replace_all(data, data2, 0xfd, 0xff)\n\n  data2 = replace_all(data, data2, 0xff, 0x55)\n\n  data2 = replace_all(data, data2, 0x55, 0x00)\n\n  unxored = bytearray()\n\n  for byte in data2:\n\n    unxored.append(byte ^ 0x36) # 0x36: RisePro and 0x9d for PrivateLoader\n\n  with open(f\"unxored.zip\", \"wb\") as f:\n\n    f.write(unxored)\n\ndef replace_all(data: bytearray, data2: bytearray, x: int, y: int) -> bytearray:\n\n  print(f\"replace all {hex(x)} by {hex(y)}\")\n\n  for index, byte in enumerate(copy(data)):\n\n    if byte == x:\n\n      data2[index] = y\n\n```\n\n-----\n\n```\n  return data2\n\nif __name__ == \"__main__\":\n\n  deobfuscate(sys.argv[1])\n\n## YARAs\nrule RisePro_stealer {\n\nmeta:\n\n   version = \"1.0\"\n\n   malware = \"RisePro\"\n\n   description = \"RisePro Stealer detection base on deobfuscation routine\nrepetition\"\n\n   source = \"SEKOIA.IO\"\n\n   classification = \"TLP:GREEN\"\n\nstrings:\n\n   $pxor = {66 0f ef 85}     // invoke xor between key and data\n\n   $mov_dword_ptr1 = {c7 85}   // one way to load data\n\n   $mov_dword_ptr2 = {c7 45}   // one way to load data\n\ncondition:\n\n   uint16be(0) == 0x4d5a and #mov_dword_ptr1 > 5000 and #mov_dword_ptr2 > 800 and\n#pxor > 1000\n\n}\n\n TTPs\n\n```\n\n**Tactic**\n\n\n**Technique**\n\n\nCollection T1213 – Data from Information Repositories\n\nCollection T1113 – Screen Capture\n\n\nCredential\nAccess\n\n\nT1555.004 – Credentials from Password Stores: Windows Credential\nManager\n\n\n-----\n\nDefense\nEvasion\n\nDefense\nEvasion\n\nDefense\nEvasion\n\nDefense\nEvasion\n\n\nT1140 – Deobfuscate/Decode Files or Information\n\nT1222 – File and Directory Permissions Modification\n\nT1027 – Obfuscated Files or Information\n\nT1027.005 – Obfuscated Files or Information: Indicator Removal from\nTools\n\n\nDiscovery T1087 – Account Discovery\n\nDiscovery T1083 – File and Directory Discovery\n\nDiscovery T1057 – Process Discovery\n\nDiscovery T1012 – Query Registry\n\nDiscovery T1518 – Software Discovery\n\nDiscovery T1082 – System Information Discovery\n\nDiscovery T1614 – System Location Discovery\n\nDiscovery T1614.001 – System Location Discovery: System Language Discovery\n\nDiscovery T1033 – System Owner/User Discovery\n\nExecution T1129 – Shared Modules\n\nPersistence T1547.001 – Boot or Logon Autostart Execution: Registry Run Keys /\nStartup Folder\n\n_Table 3 – MITRE ATT&CK TTPs for RisePro Stealer_\n\n## External References\n\nYou can also read other blog post :\n\n**Comments are closed.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-22 - New RisePro Stealer distributed by the prominent PrivateLoader.pdf"
    ],
    "report_names": [
        "2022-12-22 - New RisePro Stealer distributed by the prominent PrivateLoader.pdf"
    ],
    "threat_actors": [
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535991,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1672274414,
    "ts_modification_date": 1672274414,
    "files": {
        "pdf": "https://archive.orkl.eu/9a8e88b6a68a9a9311dece07d37246e16c792546.pdf",
        "text": "https://archive.orkl.eu/9a8e88b6a68a9a9311dece07d37246e16c792546.txt",
        "img": "https://archive.orkl.eu/9a8e88b6a68a9a9311dece07d37246e16c792546.jpg"
    }
}