{
    "id": "3c939eaf-691a-41a4-8f55-af8fcbb7cb06",
    "created_at": "2023-01-12T15:06:00.13468Z",
    "updated_at": "2025-03-27T02:05:28.169344Z",
    "deleted_at": null,
    "sha1_hash": "74ee69950fa61c2512da8fb6fdda5729bea6487d",
    "title": "2021-09-16 - Threat Thursday- NetWire RAT is Coming Down the Line",
    "authors": "",
    "file_creation_date": "2022-05-28T23:15:59Z",
    "file_modification_date": "2022-05-28T23:15:59Z",
    "file_size": 1648875,
    "plain_text": "# Threat Thursday: NetWire RAT is Coming Down the Line\n\n**[blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line](https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line)**\n\nThe BlackBerry Research & Intelligence Team\n\nNetWire is a publicly available, multi-platform Remote Access Trojan (RAT) that is designed\nto target victims on Windows®, MacOS®, and Linux®. This threat has been distributed in\nphishing campaigns via weaponized Microsoft® documents, PDFs containing download\nlinks, and archive files containing payloads. It has also been seen for sale on the dark net,\ntypically ranging in price from $40 to $140 USD.\n\nThe goal of NetWire is to perform surveillance or take control of the infected system. Once\nthe RAT has compromised a machine, the attacker can execute a variety of remote actions\nfrom its command and control (C2) server.\n\nThe malware’s surveillance abilities include logging keystrokes, capturing screenshots, and\nstealing passwords, as well as accessing web cameras and microphones.\n\n### Operating System\n\n\n-----\n\n### Risk & Impact\n\n Technical Analysis\n\nNetWire was first discovered in the wild in 2012, and it has been used since then by\nfinancially motivated cyber-criminals, as well as advanced persistent threat (APT) groups.\n\nTypically, the infection vector used to distribute this malware is via phishing campaigns\nwhere victims are lured into clicking on malicious Microsoft® Office files that contain\nembedded macros, which then launch a payload. The malware has also been seen\nspreading via malicious URLs in PDF files, as well as through malicious attachments in\nemails.\n\nThe variant analyzed in this report was a binary created to target Windows machines. The\nfile would arrive as a Win32 executable that is UPX-packed to help impede analysis.\n\nThe malware also uses an anti-analysis technique to avoid execution in a sandbox. The\n“GetCursorPos” function is called twice, as seen below, and the cursor positions are\ncompared. The malware will not run until there is a difference in the mouse cursor positions.\n\n_Figure 1: Anti-sandbox technique_\n\nThese are not the only tricks NetWire uses to hide its activity. When executed, the malicious\nbinary creates a child process, and its code is then overwritten into this process. Because\nthis is where the malicious activity spawns from, this makes analysis more difficult.\n\nThe parent process drops the child process into the “User/AppData/Roaming/Install”\ndirectory and exits itself. This is shown in the image below, with the filename “Host.exe.”\n\n\n-----\n\n_Figure 2: Copy of Host.exe in “User/AppData/Roaming/Install”_\n\nNetWire creates a registry key and adds it to the auto-run group to achieve persistence.\nThis will ensure that the malicious file will run automatically when the victim’s machine is\nbooted up.\n\n_Figure 3: NetWire RegKey for maintaining persistence on victim’s machine_\n\nBy analyzing the strings in memory, we can see some of the functionality carried out by\nNetWire, and the information that it is attempting to gather.\n\nIt tries to gather user login data from web browsers such as Google Chrome™ and Brave®\nBrowser.\n\n_Figure 4: NetWire browser credential-harvesting functionality_\n\nThe malware also scans the directories of Microsoft® Outlook® profiles on the victim’s\nmachine to gather credentials. It also collects and logs both keystrokes and mouse\nmovements.\n\nThe keystrokes are of particular interest to the attacker as a potential source of sensitive\ninformation that can be used for malicious activity or financial gain. This could include data\nsuch as login details for online banking sites, credit card information, corporate network\n\n\n-----\n\naccess credentials, or crypto wallets. This harvested information can often fetch a hefty\nprice on underground forums and the dark web.\n\nNetWire creates a log file on the victim’s machine in the\n“User/Analyst/AppData/Roaming/Logs” directory, where it stores all captured data. As\nshown below, the log file is named using the format DAY-MONTH-YEAR, matching the date\nthe victim’s machine was infected.\n\n_Figure 5: File created in the /Roaming/Logs directory, which contains all captured data_\n\nThe data contained within the log file is encrypted using an RC4 cryptographic algorithm,\nthe same algorithm the malware uses to encrypt strings and DLLs. NetWire also uses this\nobfuscation technique to hide registry keys, APIs, DLL names, and other strings.\n\nFigure 6 shows the contents of the encrypted log file. The file grows larger the longer the\nmalware remains on the machine, as it gathers more data.\n\n\n-----\n\n_Figure 6: Encrypted log file containing harvested data_\n\nThe malware also creates a mutex called “OqvAvPni” on the target machine. This is used\nby the malware author to avoid reinfection of the same host.\n\n_Figure 7: Mutex “OqvAvPni” created by NetWire_\n\n\n-----\n\nNetWire will attempt to create a TCP connection with a remote C2 server. In the sample\nused in this analysis, there were continuous attempts to create a connection over port 3382\nwith the IP Address 192[.]169[.].69[.]25.\n\nFrom the strings in memory, we can see the DNS of the C2 server that this variant is\nattempting to reach is “love82[.]duckdns[.]org”.\n\n_Figure 8: C2 URL “love82[.]duckdns[.]org” visible in strings in memory_\n\nIf this connection is successful, the attacker can transfer captured data or perform further\nmalicious actions, such as downloading and executing additional malicious payloads.\n\nIn the instance shown below, the connection is unsuccessful as the RST flag is being\nreturned. A TCP segment is sent with a RST flag when a connection request is received on\nthe destination port, but no process is listening at that port. This likely means that the C2\nserver shown is no longer online and active.\n\n_Figure 9: Wireshark results showing continuous TCP connection attempts with C2_\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\n\n-----\n\nimport \"pe\"\n\nrule NetWire_RAT {\n\nmeta:\ndescription = \"Detects NetWire Remote Access Trojan\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2021-09-06\"\n\nSHA256 =\n\"021323e02e618769aab03cd9d5dea602ff684c2ff64ef592d69b119e78502fd9\"\n\nstrings:\n\n$s1 = \"test.exe\"\n\n$s2 = \"key_dtor_list\"\n\n$s3 = \"new_key\"\n\n$s4 = \"./mingw-w64-crt/crt/natstart.c\"\n\n$s5 = \"./mingw-w64-crt/crt/tlssup.c\"\n\n$s6 = \"./mingw-w64-crt/crt/tlsmcrt.c\"\n\n$s7 = \"cygming-crtbegin.c\"\n\n$s8 = \"tagCOINITBASE\"\n\n$s9 = \"IID_IWinInetFileStream\"\n\n$s10 = \"winnt.h\"\n\n$s11 = \"fwrite\"\n\ncondition:\n\n( uint16(0) == 0x5a4d and filesize < 1500KB and\n\npe.imphash() == \"084fafd5fea9d39b4ff35f2d82f0908b\" and pe.number_of_sections\n== 15 and ( all of them )\n\n)\n\n}\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n**SHA256**\n\n021323e02e618769aab03cd9d5dea602ff684c2ff64ef592d69b119e78502fd9\n\n**Files Created**\n\nUser/AppData/Roaming/Install/Host.exe\nUser/AppData/Roaming/Logs/<Date-Of-Attack>\n\n**Domains**\n\nlove82[.]duckdns[.]org\n\n**C2**\n\n192[.]169[.].69[.]25\n\n**Mutex**\n\nOqvAvPni\n\n**Registry**\n\nHKCU\\SOFTWARE\\NetWire\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you with around-the-clock support,\nif required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n## About The BlackBerry Research & Intelligence Team\n\n\n-----\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-16 - Threat Thursday- NetWire RAT is Coming Down the Line.pdf"
    ],
    "report_names": [
        "2021-09-16 - Threat Thursday- NetWire RAT is Coming Down the Line.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535960,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653779759,
    "ts_modification_date": 1653779759,
    "files": {
        "pdf": "https://archive.orkl.eu/74ee69950fa61c2512da8fb6fdda5729bea6487d.pdf",
        "text": "https://archive.orkl.eu/74ee69950fa61c2512da8fb6fdda5729bea6487d.txt",
        "img": "https://archive.orkl.eu/74ee69950fa61c2512da8fb6fdda5729bea6487d.jpg"
    }
}