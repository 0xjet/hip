{
    "id": "d3cb32d3-e2ef-47a7-b3e9-82a5cab4eb40",
    "created_at": "2023-01-12T15:07:09.286846Z",
    "updated_at": "2025-03-27T02:05:33.550133Z",
    "deleted_at": null,
    "sha1_hash": "1ee4813b6138a093c959769de64e332bde50799a",
    "title": "2018-01-26 - FriedEx- BitPaymer ransomware the work of Dridex authors",
    "authors": "",
    "file_creation_date": "2022-05-28T17:42:54Z",
    "file_modification_date": "2022-05-28T17:42:54Z",
    "file_size": 270620,
    "plain_text": "# FriedEx: BitPaymer ransomware the work of Dridex authors\n\n**[welivesecurity.com/2018/01/26/friedex-bitpaymer-ransomware-work-dridex-authors/](https://www.welivesecurity.com/2018/01/26/friedex-bitpaymer-ransomware-work-dridex-authors/)**\n\nJanuary 26, 2018\n\nESET research has found that the ransomware FriedEx, also known as BitPaymer, is\nactually the work of the notorious gang responsible for the Dridex banking trojan.\n\n[Michal Poslušný](https://www.welivesecurity.com/author/mposlusny/)\n26 Jan 2018 - 02:57PM\n\nESET research has found that the ransomware FriedEx, also known as BitPaymer, is\nactually the work of the notorious gang responsible for the Dridex banking trojan.\n\nDridex has been a nightmare for computer users, companies and financial institutions for\nseveral years now, so much so that for many, it has become the first thing that comes to\nmind when talking about banking trojans.\n\nRecent ESET research shows that the authors of the infamous Dridex banking trojan are\nalso behind another high-profile malware family – a sophisticated ransomware detected by\nESET products as Win32/Filecoder.FriedEx and Win64/Filecoder.FriedEx, and also known\nas BitPaymer.\n\n## Dridex\n\nThe Dridex banking trojan first appeared in 2014 as a relatively simple bot inspired by older\nprojects, but the authors quickly turned this bot into one of the most sophisticated banking\ntrojans on the market. The development seems to be steady, with new versions of the bot\nincluding minor fixes and updates being released on a weekly basis, with occasional\nbreaks. From time to time, the authors introduce a major update that adds some crucial\nfunctionality or larger changes. The last major update from version 3 to version 4, released\n\n\n-----\n\nat the beginning of 2017, gained attention for adopting the Atom Bombing injection\n[technique, and later in the year also introducing a new MS Word zero-day exploit, which](https://www.proofpoint.com/us/threat-insight/post/dridex-campaigns-millions-recipients-unpatched-microsoft-zero-day)\nhelped spread the trojan to millions of victims.\n\nAs of this writing, the most recent version of Dridex is 4.80 and includes support for\nwebinjects into Chrome version 63. Dridex 4.80 was released on December 14th 2017.\n\nNote: Last year [we released a tool that helps identify malicious hooks in popular web](https://github.com/eset/volatility-browserhooks)\nbrowsers. The tool is designed to help incident responders discover potential banking trojan\ninfections, including Dridex.\n\n## FriedEx\n\nInitially dubbed BitPaymer, based on text in its ransom demand web site, this ransomware\nwas [discovered in early July 2017 by Michael Gillespie. In August, it returned to the](https://twitter.com/demonslay335/status/884545841691844608)\n[spotlight and made headlines by infecting NHS hospitals in Scotland.](https://www.bleepingcomputer.com/news/security/bit-paymer-ransomware-hits-scottish-hospitals/)\n\nFriedEx focuses on higher profile targets and companies rather than regular end users and\nis usually delivered via an RDP brute force attack. The ransomware encrypts each file with\na randomly generated RC4 key, which is then encrypted using a hardcoded 1024-bit RSA\npublic key and saved in the corresponding .readme_txt file.\n\nIn December 2017, we took a closer look at one of the FriedEx samples and almost\ninstantly noticed the resemblance of the code to Dridex. Intrigued by the initial findings, we\ndug deep into the FriedEx samples, and found out that FriedEx uses the same techniques\nas Dridex to hide as much information as possible about its behavior.\n\nIt resolves all system API calls on the fly by searching for them by hash, stores all strings in\nencrypted form, looks up registry keys and values by hash, etc. The resulting binary is very\nlow profile in terms of static features and it’s very hard to tell what the malware is doing\nwithout a deeper analysis.\n\nThis prompted yet further analysis, which revealed a number of additional attributes that\nconfirmed our initial suspicions – the two malware families were created by the same\ndevelopers.\n\n## Code Similarities\n\n\n-----\n\n_Figure 1. Comparison of GetUserID function present in both Dridex and FriedEx samples_\n\nIn Figure 1, we can see a part of a function used for generating UserID that can be found\nacross all Dridex binaries (both loaders and bot modules). As we can see, the very same\nDridex-specific function is also used in the FriedEx binaries. The function produces the\nsame results – it generates a string from several attributes of the victim’s machine that\nserves as a unique identifier of the given victim, either in the botnet in the case of Dridex, or\nof the ransomware with FriedEx. Indeed, the screenshots would make for a good “Spot the\ndifference” game!\n\nThis kind of similarity to Dridex is present throughout the FriedEx binaries and only very few\nfunctions that mostly correspond to the specific ransomware functionality are not found in\nthe Dridex sample (i.e. the file encryption loop and creation of ransom message files).\n\n\n-----\n\n_Figure 2. Comparison of function order in Dridex and FriedEx samples. Functions that are missing_\n\n_in the other sample are highlighted in the corresponding color_\n\nAnother shared feature is the order of the functions in the binaries, which occurs when the\nsame codebase or static library is used in multiple projects. As we can see in Figure 2,\nwhile the FriedEx sample seems to be missing some of the functions present in the Dridex\nsample and vice versa (which is caused by the compiler omitting unreferenced/unused\nfunctions), the order remains the same.\n\nNote: Auto-generated function name pairs, based on code addresses (sub_CA5191 and\nsub_2A56A2, etc), obviously do not match, but the code they refer to does.\n\nIt’s also worth mentioning that both Dridex and FriedEx use the same malware packer.\nHowever, since the packer is very popular nowadays (probably due to its effectiveness in\navoiding detection and hampering analysis) and used by other well-known families like\nQBot, Emotet or Ursnif, we don’t really consider that alone strong evidence.\n\n## PDB paths\n\nWhen building a Windows executable, the linker may include a PDB (Program Database)\npath pointing to a file that contains debug symbols that help the developer with debugging\nand identifying crashes. The actual PDB file is almost never present in malware, because\nit’s a separate file that doesn’t get into distribution. However, sometimes even just the path,\n\n\n-----\n\nif included, can provide valuable information, because PDB files are located in the same\ndirectory as the compiled executable by default and usually also have the same base name\nfollowed by the .pdb extension.\n\nAs one might guess, PDB paths are not included in malware binaries very often, as the\nattackers don’t want to give away any information. Fortunately, some samples of both\nfamilies do include PDB paths.\n\n_Figure 3. List of all PDB paths found in the Dridex and FriedEx projects_\n\nAs you can see in Figure 3, the binaries of both projects are being built in the same,\ndistinctively named directory. Based on a search across all of our malware sample\nmetadata, we have concluded that the path S:\\Work\\_bin\\ is unique to the Dridex and\nFriedEx projects.\n\n## Timestamps\n\nWe found several cases of Dridex and FriedEx with the same date of compilation. This\ncould, of course, be coincidence, but after a closer look, we quickly ruled out the “just a\ncoincidence” theory.\n\nNot only do the compilations with the same date have time differences of several minutes at\nmost (which implies Dridex guys probably compile both projects concurrently), but the\nrandomly generated constants are also identical in these samples. These constants change\nwith each compilation as a form of polymorphism, to make the analysis harder and to help\navoid detection.\n\nThis might be completely randomized in each compilation or based on some variable like\nthe current date.\n\n\n-----\n\n_Figure 4. GetAPIByHash function in Dridex samples with compilation time difference of 3 days. The_\n\n_highlighted constant is different_\n\nIn Figure 4, we have the comparison of two Dridex loader samples with a three-day\ndifference between compilation timestamps. While the loaders are almost identical with the\nonly difference being their hardcoded data, such as encryption keys and C&C IPs, the\nconstants are different, and so are all the hashes that are based on them. On the other\nhand, in Figure 5, we can see the comparison of the FriedEx and Dridex loader from the\nsame day (in fact, with timestamps just two minutes apart). Here, the constants are the\nsame, meaning both were probably built during the same compilation session.\n\n_Figure 5. GetAPIByHash function in Dridex and FriedEx binaries compiled the same day. The_\n\n_highlighted constant is the same in both samples_\n\n## Compiler information\n\n\n-----\n\nThe compiler information only further supports all the evidence we found so far – the\nbinaries of both Dridex and FriedEx are compiled in Visual Studio 2015. This is confirmed\nby both the linker version found in the PE Header and Rich Header data.\n\n_Figure 6. Rich header data found in Dridex and FriedEx samples_\n\nApart from the obvious similarities with Dridex, we came across a previously unreported 64bit variant of the ransomware. As the usual 32-bit version of the ransomware can target\nboth x86 and x64 systems, we consider this variant to be a bit of a curiosity.\n\n### Conclusion\n\nWith all this evidence, we confidently claim that FriedEx is indeed the work of the Dridex\ndevelopers. This discovery gives us a better picture of the group’s activities – we can see\nthat the group continues to be active and not only consistently updates their banking trojan\nto maintain its webinject support for the latest versions of Chrome and to introduce new\nfeatures like Atom Bombing, but that it also follows the latest malware “trends”, creating\ntheir own ransomware.\n\nWe can only guess what the future will bring, but we can be sure that the Dridex gang isn’t\ngoing anywhere anytime soon and that they will keep innovating their old project and\npossibly extend their portfolio with a new piece here and there.\n\nFor a long time, it was believed that the Dridex gang was a one-trick pony that kept their\nfocus on their banking trojan. We have now found that this is not the case and that they can\neasily adapt to the newest trends and create a different kind of malware that can compete\nwith the most advanced in its category.\n\n### IoCs\n\n**Win32/Dridex.BE** **C70BD77A5415B5DCF66B7095B22A0DEE2DDA95A0**\n\n**Win64/FriedEx.A** **CF1038C9AED9239B6A54EFF17EB61CAB2EE12141**\n\n**Win32/FriedEx.A** **8AE1C1869C42DAA035032341804AEFC3E7F3CAF1**\n\n\n-----\n\n26 Jan 2018 - 02:57PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-01-26 - FriedEx- BitPaymer ransomware the work of Dridex authors.pdf"
    ],
    "report_names": [
        "2018-01-26 - FriedEx- BitPaymer ransomware the work of Dridex authors.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536029,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653759774,
    "ts_modification_date": 1653759774,
    "files": {
        "pdf": "https://archive.orkl.eu/1ee4813b6138a093c959769de64e332bde50799a.pdf",
        "text": "https://archive.orkl.eu/1ee4813b6138a093c959769de64e332bde50799a.txt",
        "img": "https://archive.orkl.eu/1ee4813b6138a093c959769de64e332bde50799a.jpg"
    }
}