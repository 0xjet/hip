{
    "id": "a4b9e5a3-efab-42d3-95d1-e90001cb9502",
    "created_at": "2023-01-12T15:05:19.825488Z",
    "updated_at": "2025-03-27T02:05:28.121693Z",
    "deleted_at": null,
    "sha1_hash": "cf2a71e3c066933485a6e03602c42cf037aa7a96",
    "title": "2020-06-23 - New Mirai variant Aisuru detects Cowrie opensource honeypots",
    "authors": "",
    "file_creation_date": "2022-05-28T04:58:06Z",
    "file_modification_date": "2022-05-28T04:58:06Z",
    "file_size": 1846593,
    "plain_text": "# New Mirai variant Aisuru detects Cowrie opensource honeypots\n\n**[insights.oem.avira.com/new-mirai-variant-aisuru-detects-cowrie-opensource-honeypots/](https://insights.oem.avira.com/new-mirai-variant-aisuru-detects-cowrie-opensource-honeypots/)**\n\nJune 23, 2020\n\nA well-known honeypot used by malware researchers has been compromised by an\nevolution in the IoT botnet, Mirai. The new variant, named Aisuru, was first identified by\nresearchers in Avira’s IoT Labs.\n\nThe research team at Avira have followed the evolution of the Mirai botnet that caused so\n[much disruption to internet services in 2017: from its HolyMirai re-incarnation, through its](https://www.avira.com/en/blog/the-evolution-of-mirai-into-holymirai/)\n[Corona phase, and now into a complete new variant, Aisuru.](https://www.avira.com/en/blog/how-is-the-mirai-variant-infecting-the-iot-landscape)\n\nAisuru is the first variant discovered with the capability to detect one of the most popular\n[open source honeypots projects; Cowrie. Although opensource security projects are very](https://github.com/cowrie/cowrie)\nworthwhile, this evolution is further evidence that they cannot be relied upon to provide full\nprotection.\n\nHamidreza Ebtehaj, specialist researcher at Avira’s IoT labs takes a deep dive into this\nnew, and up until now, previously unidentified variant of Mirai.\n\n## Introducing Aisuru\n\nIn this article, we will analyze the newly identified Mirai variant and describe the honeypot\ndetection methods that occur during Aisuru’s scanning phase.\n\nIn traditional Mirai, the scanning phase happens in three steps. An infected node:\n\n1. Scans the internet for open ports (mostly Telnet and in some cases, SSH)\n2. When an open port is found it tries to brute-force the login credentials.\n\n\n-----\n\n3. After a successful guess it infects the new target by employing various techniques.\n\nHowever, this new sample found in Avira’s IoT Labs has an additional step prior to infection:\nIt checks if the target is a true device or a honeypot. If it identifies a honeypot, the infection\noperation is terminated, and the honeypot details are sent to the C&C server. The\ninformation obtained by this reconnaissance can be used later to avoid future interaction\nwith the honeypot, or for a variety of other uses.\n\nThis honeypot detection mechanism should not be confused with honeypot evasion\ntechniques. Honeypot evasion techniques have been used for a long time and are still\ncommon. Such techniques are briefly reviewed in the next section before we move on an\nanalysis of the main sample\n\n\n-----\n\n## A brief review on honeypot evasion techniques\n\nHoneypot evasion techniques are a set of passive methods designed to prevent execution\nof malware when it is in a honeypot system. These methods are designed to prevent the\ndisclosure of malware samples to security firms. A multi-layered infection vector is the most\ncommon evasion technique, and is used by various malware, including variants of Mirai and\nHajime. This method leverages the fact that most common honeypots are simulation-based.\nThey are incapable of executing payloads by infecting a device by a malware downloader\nfirst. This way, the downloader fails to run on a honeypot, and the actual malware will not be\ndownloaded or exposed. However, the malware downloader will effectively operate on a\nreal device and infect it.\n\nBelow, is an example of a malware downloader evading a honeypot. The code is selfexplanatory and does not require any further investigation.\n\n## Analysis of the Aisuru bot\n\nAisuru bot, the new variant of Mirai, can detect and report back honeypots to its C&C. For\nthat purpose, it has a function named “init_honeypot_report“.\n\n\n-----\n\nAs shown in the figure above, this function stores the honeypot address and port in a string\nof the form “IP:port” and sends it to the C&C server on port 5768, where a service runs to\ngather reconnaissance information. This function is triggered when one of three conditions\nare met:\n\n1. The device name is “LocalHost“\n2. Any service on the device is started on Jun 22nd, or Jun 23rd\n3. A user exists on the device named “richard“\n\n### First condition: the existence of “@LocalHost:]”:\n\n\n-----\n\nAs shown in the figure below, the first honeypot indicator is the existence of **@LocalHost:]**\nin any of the command responses\n\nWhen a shell is invoked, a prompt is the first thing displayed on every line. A user prompt\nlooks like this:\n\n**user@computername:~$**\n\nSome honeypots use LocalHost as a default computer name when being set up while real\ndevices are using more specific names. Logging into a computer named “LocalHost”\nindicates the existence of a honeypot.\n\n### Second condition: the existence of a service, started on Jun 22nd, or Jun 23rd:\n\nThe figure below shows the conditions when met, triggers honeypot detection\n\nThe existence of “Jun22” or “Jun23” in response to any commands sent to the device\nindicates the presence of a Cowrie honeypot. Cowrie is a well-known open-source Telnet\nand SSH honeypot project. Looking at Cowrie’s [source code, we observe that in the](https://github.com/cowrie/cowrie/blob/master/share/cowrie/cmdoutput.json)\nresponse to “ps” command (process snapshot), We will receive a list of services that are all\nstarted on “Jun22″ or Jun23”.\n\n\n-----\n\nIn reality, there is little chance a device was rebooted or started on these two specific dates.\n\n### Third condition: when a user exists on the device named “richard“:\n\nLooking at the last condition, the offset “.text:00012BBC”, we observe that honeypot\ndetection is triggered when a string at the index of 162 of strings table is found in response\nto any of issued commands.\n\n\n-----\n\nIn the figure above, “table” is an array of string pointers. In the received versions of Aisuru\nbot, the strings table is initialized with 164 encrypted strings as shown below.\n\n\n-----\n\nThe encryption algorithm used in Aisuru botnet is simple, but unique. Is has never been\nused in any other Mirai variants before, and does not exist in the original Mirai. As shown in\nthe figure below, the decryptor is implemented by having three iterations on strings. In each\niteration, the ASCII code of each character is subtracted by one and the order of characters\nin the string is reversed.\n\n\n-----\n\nWith a simple decryption script, we can unveil the list of strings, particularly the string at\nindex 162.\n\n\n-----\n\nThe string at the index 162 of Aisuru botnet is “richard“. An another look into the list of\nusers at Cowrie honeypot shows that, a user exists in the Cowrie honeypot named\n“richard“.\n\n\n-----\n\n## Conclusion\n\nCowrie is one of the best honeypot projects ever with over 3000 stars at its GitHub\nrepository and thousands of installations. The smarter generation of IoT malware,\nparticularly the Aisuru botnet, proves that open-source security projects in cybersecurity\nspace, although very worthwhile, can fail in providing full protection.\n\nAt the Avira IoT Lab, we have developed our own honeypot and we regularly maintain it to\nensure up-to-date protection for our customers. Our research team monitors such new\nmalware families or variants and provide detections for them. Integrating Avira\n\n\n-----\n\n[SafeThings and](https://oem.avira.com/en/solutions/white-label) [anti-malware technologies can help protect customers from such attacks.](https://oem.avira.com/en/solutions/software-development-kits)\n\n## Decryption script\n\n Malware Hashes:\n\nbf260b0b7c95cfdcc53b12bbda6c88fa5ec8552400799dacd41cbdc969e9f145\n\n84c958db6a042d0d18d35485670237358fd38cdd17acfd46c528d66e90d0b5d1\n\ne0c7460e21fadd107a1d044b25a3c65c93e554e78dec8a85488a83f2bb86908e\n\n\n-----\n\nAvira Protection Labs\n\nProtection Lab is the heart of Avira’s threat detection and protection unit. The researchers\nat work in the Labs are some of the most qualified and skilled anti-malware researchers in\nthe security industry. They conduct highly advance research to provide the best detection\nand protection to nearly a billion people world-wide.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-23 - New Mirai variant Aisuru detects Cowrie opensource honeypots.pdf"
    ],
    "report_names": [
        "2020-06-23 - New Mirai variant Aisuru detects Cowrie opensource honeypots.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535919,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653713886,
    "ts_modification_date": 1653713886,
    "files": {
        "pdf": "https://archive.orkl.eu/cf2a71e3c066933485a6e03602c42cf037aa7a96.pdf",
        "text": "https://archive.orkl.eu/cf2a71e3c066933485a6e03602c42cf037aa7a96.txt",
        "img": "https://archive.orkl.eu/cf2a71e3c066933485a6e03602c42cf037aa7a96.jpg"
    }
}