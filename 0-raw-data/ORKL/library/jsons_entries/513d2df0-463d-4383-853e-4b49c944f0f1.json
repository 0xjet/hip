{
    "id": "513d2df0-463d-4383-853e-4b49c944f0f1",
    "created_at": "2023-01-12T15:05:46.87956Z",
    "updated_at": "2025-03-27T02:06:14.863031Z",
    "deleted_at": null,
    "sha1_hash": "b6d6aabf73a5f7330ef26ea33691c5f6348a2ad1",
    "title": "2020-09-10 - Recent Dridex activity",
    "authors": "",
    "file_creation_date": "2022-05-28T00:21:40Z",
    "file_modification_date": "2022-05-28T00:21:40Z",
    "file_size": 2391463,
    "plain_text": "# SANS ISC: Recent Dridex activity - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training SANS ISC InfoSec Forums\n\n**isc.sans.edu/forums/diary/Recent+Dridex+activity/26550/**\n\n**_Introduction_**\n\nFor the past month or so, I hadn't had any luck finding active malspam campaigns pushing\n[Dridex malware. That changed starting this week, and I've since found several examples.](https://us-cert.cisa.gov/ncas/alerts/aa19-339a)\nToday's diary reviews an infection from Wednesday September 9th, 2020.\n\n**_The Word documents_**\n\nWhile searching VirusTotal, I found three documents with the same template that generated\nthe same type of traffic (read: SHA256 hash - name):\n\n[fee5bb973112d58445d9e267e0ceea137d9cc1fb8a7140cf9a67472c9499a30f - Info-](https://app.any.run/tasks/f61904b6-4919-4260-a618-e4fb9983d19a/)\n3948683568.doc\n[9b747e89874c0b080cf78ed61a1ccbd9c86045dc61b433116461e3e81eee1348 -](https://app.any.run/tasks/d2d4aa3d-8cca-4814-90d5-ee3be8247c79/)\nInform-34674869.doc'\n[27379612c139d3c4a0c6614ea51d49f2495213c867574354d7851a86fdec2428 - Rep-](https://app.any.run/tasks/a32deb52-3c9d-45ca-919c-a9dc4fd12b44/)\nSept2020.doc\n\n\n-----\n\n_Shown above: Screenshot with template used by all three of the above listed Word_\n_documents._\n\nMy lab environment revealed these documents are designed to infect a vulnerable Windows\nhost with Dridex.\n\nEnabling macros caused Powershell to retrieve a DLL file from one of the following URLs\nover encrypted HTTPS traffic:\n```\nhxxps://teworhfoundation[.]com/4jvmow.zip\nhxxps://teworhfoundation[.]com/zd0pcc.rar\nhxxps://thecandidtales[.]com/doakai.zip\nhxxps://safaktasarim[.]com/7zcsfo.txt\nhxxps://thecandidtales[.]com/wuom4a.rar\n\n```\nAfter the DLL was saved under the victim's profile, it was run using rundll32.exe. The DLL is\nan installer for Dridex, and it was run using the following command:\n```\n\"C:\\Windows\\system32\\rundll32.exe\" C:\\Users\\[username]\\Mqfzqp8\\Opzvzn2\\Qzpic6r.dll 0\n\n```\n\n-----\n\n_Shown above: Location of the initial DLL to install Dridex on an infected Windows host._\n\n**_Dridex infection traffic_**\n\nDridex post-infection traffic is all HTTPS. In this case, we saw HTTPS traffic over the\nfollowing IP addresses and ports:\n```\n67.213.75[.]205 port 443\n54.39.34[.]26 port 453\n\n```\n_Shown above: Traffic from the Dridex infection filtered in Wireshark._\n\nMost of the Dridex post-infection traffic I've seen uses IP addresses without domain names,\nand issuer data for the SSL/TLS certificates is somewhat unusual. Certificate issuer data for\nthe Dridex post-infection traffic:\n\n\n-----\n\n```\nCERTIFICATE ISSUER DATA FOR HTTPS TRAFFIC TO 67.213.75[.]205 OVER TCP PORT 443:\nid-at-countryName=HR\nid-at-localityName=Zagreb\nid-at-organizationName=Wageng Unltd.\nid-at-organizationalUnitName=obendmma\nid-at-commonName=Livedthtsthw.flights\nCERTIFICATE ISSUER DATA FOR HTTPS TRAFFIC TO 54.39.34[.]26 OVER TCP PORT 453:\nid-at-countryName=DE\nid-at-stateOrProvinceName=Sheso thanthefo\nid-at-localityName=Berlin\nid-at-organizationName=Thedelor Tbrra SICAV\nid-at-organizationalUnitName=5Coiesily Begtherdr istwarscon\nid-at-commonName=Bath7epran.toshiba\n\n```\n_Shown above: Certificate issuer data for HTTPS traffic to 67.213.75[.]205 over TCP port 443_\n_found in Wireshark._\n\n\n-----\n\n_Shown above: Certificate issuer data for HTTPS traffic to 54.39.34[.]26 over TCP port 453_\n_found in Wireshark._\n\n**_Dridex persistent on an infected Windows host_**\n\nDridex is made persistent on an infected Windows host using 3 methods simultaneously:\n\nWindows registry update\nScheduled task\nWindows startup menu shortcut\n\nDridex uses copies of legitimate Windows system files (EXEs) to load and run malware.\nDridex DLL files are named as DLLs that would normally be run by these copied system\nEXEs.\n\nFor this infection, all of the persistent Dridex DLL files were 64-bit DLL files.\n```\nWINDOWS REGISTRY UPDATE:\n- Registry Key: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n- Value name: Vwqmkqmr\n- Value type: REG_SZ\n- Value data: C:\\Users\\\n[username]\\AppData\\Roaming\\Thunderbird\\Profiles\\1ovarfyl.default-release\\\n       ImapMail\\.outlook.com\\Uw0NWHoOi\\DWWIN.EXE\nNOTE: DWWIN.EXE loads and runs a Dridex DLL file named VERSION.dll in the same\ndirectory.\n\n```\n\n-----\n\n_Shown above: Windows registry update used to keep Dridex persistent on an infected host._\n\n_Shown above: Legitimate EXE called by registry update, and Dridex DLL in the same_\n_directory._\n```\nSCHEDULED TASK:\n- Task name: Qgdopf\n- Action: Start a program\n- Details: C:\\Users\\[username]\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Accessories\\\n      0pFtxbOGXwr\\DmNotificationBroker.exe\nNOTE: DmNotificationBroker.exe loads and runs a Dridex DLL file named DUI70.dll in\nthe same directory.\n\n```\n\n-----\n\n_Shown above: Scheduled task on the same infected Windows host also used to keep Dridex_\n_persistent._\n\n_Shown above: Legitimate EXE called by scheduled task, and Dridex DLL in the same_\n_directory._\n```\nWINDOWS STARTUP MENU SHORTCUT:\nShortcut: C:\\Users\\[username]\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Somdjvzvjfch.lnk\nTarget: C:\\Users\\[username]\\AppData\\Roaming\\Mozilla\\Extensions\\r0F\\msinfo32.exe\nNOTE: msinfo32.exe loads and runs a Dridex DLL file named MFC42u.dll in the same\ndirectory.\n\n```\n\n-----\n\n_Shown above: Windows start menu shortcut also used to keep Dridex persistent on the_\n_same infected Windows host._\n\n_Shown above: Legitimate EXE called by start menu shortcut, and Dridex DLL in the same_\n_directory._\n\n**_Indicators of Compromise (IOCs)_**\n\nThree examples of Microsoft Word documents with macros for Dridex:\n\n[SHA256 hash: fee5bb973112d58445d9e267e0ceea137d9cc1fb8a7140cf9a67472c9499a30f](https://bazaar.abuse.ch/sample/fee5bb973112d58445d9e267e0ceea137d9cc1fb8a7140cf9a67472c9499a30f/)\n\nFile size: 136,262 bytes\nFile name: Info-3948683568.doc\n\n\n-----\n\nSHA256 hash:\n[9b747e89874c0b080cf78ed61a1ccbd9c86045dc61b433116461e3e81eee1348](https://bazaar.abuse.ch/sample/9b747e89874c0b080cf78ed61a1ccbd9c86045dc61b433116461e3e81eee1348/)\n\nFile size: 136,182 bytes\nFile name: Inform-34674869.doc\n\nSHA256 hash:\n[27379612c139d3c4a0c6614ea51d49f2495213c867574354d7851a86fdec2428](https://bazaar.abuse.ch/sample/27379612c139d3c4a0c6614ea51d49f2495213c867574354d7851a86fdec2428/)\n\nFile size: 135,053 bytes\nFile name: Rep-Sept2020.doc\n\nInstaller DLL for Dridex called by Word macro:\n\nSHA256 hash:\n[790b0d9e2b17f637c3e03e410aa22d16eccfefd28d74b226a293c9696edb60ad](https://bazaar.abuse.ch/sample/790b0d9e2b17f637c3e03e410aa22d16eccfefd28d74b226a293c9696edb60ad/)\n\nFile size: 331,776 bytes\nFile location: hxxps://thecandidtales[.]com/doakai.zip\nFile location: C:\\Users\\[username]\\MqFZqp8\\OpZVzn2\\Qzpic6r.dll\nRun method: rundll32.exe [file name] 0\n\nDridex 64-bit DLL files persistent on the infected Windows host:\n\n[SHA256 hash: fd8049d573c056b92960ba7b0949d9f3a97416d333fa602ce683ef822986ad58](https://bazaar.abuse.ch/sample/fd8049d573c056b92960ba7b0949d9f3a97416d333fa602ce683ef822986ad58/)\n\nFile size: 1,580,032 bytes\nFile location: C:\\Users\\[username]\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Accessories\\0pFtxbOGXwr\\DUI70.dll\nRun method: Loaded and run by legitimate system file DmNotificationBroker.exe in the\nsame directory\nNote: Made persistent through scheduled task\n\n[SHA256 hash: 719a8634a16beb77e6d5c6bb7f82a96c6a49d5cfa64463754fd5f0e5eb0581be](https://bazaar.abuse.ch/sample/719a8634a16beb77e6d5c6bb7f82a96c6a49d5cfa64463754fd5f0e5eb0581be/)\n\nFile size: 1,325,056 bytes\nFile location: C:\\Users\\\n\n_[username]\\AppData\\Roaming\\Mozilla\\Extensions\\r0F\\MFC42u.dll_\nRun method: Loaded and run by legitimate system file msinfo32.exe in the same\ndirectory\nNote: Made persistent through start menu shortcut\n\nSHA256 hash:\n[4d7d8d1790d494a1a29dae42810a3a10864f7c38148c3600c76491931c767c5c](https://bazaar.abuse.ch/sample/4d7d8d1790d494a1a29dae42810a3a10864f7c38148c3600c76491931c767c5c/)\n\nFile size: 1,297,920 bytes\n\n\n-----\n\nFile location: C:\\Users\\\n\n_[username]\\AppData\\Roaming\\Thunderbird\\Profiles\\1ovarfyl.default-_\nrelease\\ImapMail\\.outlook.com\\Uw0NWHoOi\\VERSION.dll\nRun method: Loaded and run by legitimate system file DWWIN.EXE in the same\ndirectory\nNote: Made persistent through Windows registry update\n\nURLs from Word macro to retrieve Dridex DLL installer:\n\nhxxps://teworhfoundation[.]com/4jvmow.zip\nhxxps://teworhfoundation[.]com/zd0pcc.rar\nhxxps://thecandidtales[.]com/doakai.zip\nhxxps://safaktasarim[.]com/7zcsfo.txt\nhxxps://thecandidtales[.]com/wuom4a.rar\n\nCertificate data for Dridex HTTPS traffic to 67.213.75[.]205 port 443:\n\nid-at-countryName=HR\nid-at-localityName=Zagreb\nid-at-organizationName=Wageng Unltd.\nid-at-organizationalUnitName=obendmma\nid-at-commonName=Livedthtsthw.flights\n\nCertificate data for Dridex HTTPS traffic to 54.39.34[.]26 port 453:\n\nid-at-countryName=DE\nid-at-stateOrProvinceName=Sheso thanthefo\nid-at-localityName=Berlin\nid-at-organizationName=Thedelor Tbrra SICAV\nid-at-organizationalUnitName=5Coiesily Begtherdr istwarscon\nid-at-commonName=Bath7epran.toshiba\n\n**_Final words_**\n\nAfter a period of inactivity, malspam pushing Dridex malware is back, so this blog post\nreviewed traffic and malware from an infected Windows host. While not much has changed,\nit's always good to have a refresher.\n\nAs usual, up-to-date Windows hosts with the latest security patches and users who follow\nbest security practices are not likely to get infected with this malware. However, I've seen so\nmuch come through in the past two or three days that even a small percentage of success\nwill likely be profitable for the criminals behind it.\n\n\n-----\n\n--Brad Duncan\nbrad [at] malware-traffic-analysis.net\n\nBrad\n\n433 Posts\nISC Handler\nSep 10th 2020\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-10 - Recent Dridex activity.pdf"
    ],
    "report_names": [
        "2020-09-10 - Recent Dridex activity.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535946,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653697300,
    "ts_modification_date": 1653697300,
    "files": {
        "pdf": "https://archive.orkl.eu/b6d6aabf73a5f7330ef26ea33691c5f6348a2ad1.pdf",
        "text": "https://archive.orkl.eu/b6d6aabf73a5f7330ef26ea33691c5f6348a2ad1.txt",
        "img": "https://archive.orkl.eu/b6d6aabf73a5f7330ef26ea33691c5f6348a2ad1.jpg"
    }
}