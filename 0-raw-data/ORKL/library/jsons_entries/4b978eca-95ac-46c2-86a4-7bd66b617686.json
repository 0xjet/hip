{
    "id": "4b978eca-95ac-46c2-86a4-7bd66b617686",
    "created_at": "2023-01-12T15:09:57.90182Z",
    "updated_at": "2025-03-27T02:05:31.257439Z",
    "deleted_at": null,
    "sha1_hash": "ce65f481b9df5534048f23385ba94eef965990f2",
    "title": "2015-01-13 - New Carberp variant heads down under",
    "authors": "",
    "file_creation_date": "2022-05-28T19:48:10Z",
    "file_modification_date": "2022-05-28T19:48:10Z",
    "file_size": 377587,
    "plain_text": "# Endpoint Protection\n\n**[symantec.com/connect/blogs/new-carberp-variant-heads-down-under](https://www.symantec.com/connect/blogs/new-carberp-variant-heads-down-under)**\n\n[Migration User](https://community.broadcom.com/symantecenterprise/network/members/profile?UserKey=909a8e41-f1e7-45af-914a-628128e3819f)\n\n\nJan 13, 2015 05:00 PM\n\n\n[When the source code for the botnet creation kit known as Carberp (Trojan.Carberp) was](http://www.symantec.com/security_response/writeup.jsp?docid=2010-101313-5632-99)\nleaked in June 2013, security experts predicted it would only be a matter of time before the\ninformation-stealing malware code would be modified and reused. Those experts were\n[proven right when Trojan.Carberp.B was uncovered in late 2014. Symantec has now](http://www.symantec.com/security_response/writeup.jsp?docid=2014-112019-1116-99)\n[observed yet another modified version of Carberp (Trojan.Carberp.C) being spread through](http://www.symantec.com/security_response/writeup.jsp?docid=2014-121816-3818-99)\na spam campaign mainly targeting Australia.\n\nThis latest version of the malware is still focused on stealing information and has the ability\nto download additional plugins that add to its functionality.\n\nThe Carberp malware likes to travel, it would seem. In its early days, Carberp was\nexclusively used to swipe online banking credentials and other valuable information in\nRussian-speaking countries but was later modified to allow the malware to target US banks.\n\n\n-----\n\nJust like any successful business, expansion is the key and now Carberp is exploring yet\nanother continent.\n\nThe fact that the new variant is mainly targeting Australia may also point to a wider trend in\nmalware authors venturing into the land down under, as recently highlighted by a significant\n[increase in cryptomalware hitting Australian computers.](https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=c878f0a5-5416-46ca-8a73-8889a53cff2f&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\n\n_Figure 1. Carberp variant mainly targeting Australia_\n\n**Analysis**\nThe spam email used to spread Trojan.Carberp.C claims to be a payment reminder and\nincludes an attachment that poses as an invoice. The following is an example of the file\nname normally used for the attachment:\n\ninvoice.[RANDOM NUMBERS]_2014.12.11.doc.zip\n\n\n-----\n\n_Figure 2. Spam email with malicious attachment_\n\nAs you've probably already guessed, the attachment isn't an invoice and is actually\nmalware packed with Visual Basic. Interestingly, after discovering this spam campaign on\nDecember 15, 2014, we noticed during our analysis that the compilation date of the\nmalware was just one day previous on December 14. The malware authors obviously didn’t\nwaste much time between coding up and releasing (however, this date can’t always be\ntrusted).\n\n_Figure 3. Malware compilation date_\n\nWhat's interesting about this Carberp variant is the number of components involved in the\nattack, which are used to hide the infection and to silently download additional encrypted\npayloads that are then injected stealthily into processes. Additional components are\n[embedded in the dropper (detected as Trojan.Dropper) and compressed.](http://www.symantec.com/security_response/writeup.jsp?docid=2002-082718-3007-99)\n\nThe attackers behind this threat know that 64-bit architecture is now becoming the standard\nso they embedded components that are able to infect both 32-bit and 64-bit computers, a\n[tactic that is increasingly common, as seen in other threats such as W64.Xpiro and](http://www.symantec.com/security_response/writeup.jsp?docid=2013-071018-3714-99)\n[Trojan.Poweliks.](http://www.symantec.com/security_response/writeup.jsp?docid=2014-080408-5614-99)\n\nIn Carberp.C, we identified the following embedded components:\n\nMyFault—A Windows driver developed by Sysinternals that is normally used to trigger\nsystem crashes. This module on its own is not malicious and is used for\ntroubleshooting. But the malware authors may have implemented it in order to trigger\na blue screen of death (BSoD) in case the malware is being analyzed.\n\n\n-----\n\nDownloader—A silent payload downloader (detected as Trojan.Carberp.C)\nCarberp Driver—Can be used to kill processes and to inject into memory malicious\npayloads with the aim to hide the infection (detected as Trojan.Carberp.C)\n\nA typical attack scenario works in the following way:\n\n1. User receives a spam email and opens the malicious attachment which executes the\n\nTrojan\n2. The Trojan injects code into a Windows process and decrypts and decompresses\n\nembedded 32-bit or 64-bit modules (depending on the operating system)\n3. The Trojan then contacts the command-and-control (C&C) server with information\n\nabout the infection and requests additional 32-bit or 64-bit payloads (depending on the\noperating system)\n4. The payload is then downloaded, decrypted, and loaded into memory so that it is not\n\nvisible\n\nAs I’ve already noted, the malicious attachment drops additional components (32-bit or 64bit) depending on the computer architecture. These malicious files will contact the C&C\nserver and send back details from the compromised computer such as:\n\nFile system type\nUser name of user that executed the malware\nName and path of the executed file\nTime and date of the infection\nProcess ID and parent PID\n\nThe malware is also able to download additional plugins that are injected into a newly\ncreated svchost.exe process in order to keep the infection hidden. We were able to identify\nplugins for different CPU architecture such as the following:\n\nhost.dat\nupdate.dat\n\n[VOLUME SERIAL NUMBER]_32.dat\n\n[VOLUME SERIAL NUMBER]_64.dat\nlist32.dat\nlist64.dat\n\nDuring our analysis, we were able to download list32.dat, which is a plugin used to hook\nspecific APIs in order to steal confidential information such as user names and passwords\nfrom different internet browsers.\n\n**Symantec and Norton protection**\nSymantec advises users to be cautious when dealing with suspicious emails and to avoid\nclicking on suspicious links or opening attachments in unsolicited email.\n\n\n-----\n\nSymantec has the following detections in place to protect against this threat:\n\n**Antivirus:**\n\n[Trojan.Dropper](http://www.symantec.com/security_response/writeup.jsp?docid=2002-082718-3007-99)\n[Trojan.Carberp.C](http://www.symantec.com/security_response/writeup.jsp?docid=2014-121816-3818-99)\n\n**Intrusion prevention system:**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-01-13 - New Carberp variant heads down under.pdf"
    ],
    "report_names": [
        "2015-01-13 - New Carberp variant heads down under.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536197,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1653767290,
    "ts_modification_date": 1653767290,
    "files": {
        "pdf": "https://archive.orkl.eu/ce65f481b9df5534048f23385ba94eef965990f2.pdf",
        "text": "https://archive.orkl.eu/ce65f481b9df5534048f23385ba94eef965990f2.txt",
        "img": "https://archive.orkl.eu/ce65f481b9df5534048f23385ba94eef965990f2.jpg"
    }
}