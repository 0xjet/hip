{
    "id": "cf1f48ec-3b26-4e64-be81-f769df18a42b",
    "created_at": "2023-01-12T15:01:52.018296Z",
    "updated_at": "2025-03-27T02:06:01.475726Z",
    "deleted_at": null,
    "sha1_hash": "64051b402558afeaa07b5e53ed5c98c14972d6c7",
    "title": "2019-03-12 - Nymaim config decoded",
    "authors": "",
    "file_creation_date": "2022-05-28T16:10:07Z",
    "file_modification_date": "2022-05-28T16:10:07Z",
    "file_size": 1620338,
    "plain_text": "# Nymaim config decoded\n\n**proofpoint.com/us/threat-insight/post/nymaim-config-decoded**\n\n\nMarch 12, 2019\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nNymaim config decoded\n\nMarch 12, 2019 Georgi Mladenov\n\n\n-----\n\n**O e** **e**\n\nFirst documented in 2013 [1], Nymaim was originally identified as both a first-stage downloader and second-stage locking malware. Primarily\ndistributed via the Blackhole exploit kit, most users found out they were infected because of the screen lock that demanded varying ransoms.\nIn 2016, we documented distribution of the Ursnif banking Trojan via email campaigns and the presence of webinjects within Nymaim itself [2].\nMore recently, Nymaim has evolved into an even more robust downloader that includes a range of information stealing and system profiling\ncapabilities. This incarnation of Nymaim has appeared in both global campaigns as well as attacks targeting North America, Germany, Italy,\nand Poland. In this respect, Nymaim is following global malware trends, with a focus on persistent, non-destructive infection to collect\ninformation long-term and flexibly download additional malware of the threat actor’s choosing.\n\nDespite its long history and increasing incidence of spreading via email, many aspects of Nymaim are not well understood, including its\nownership and availability to groups of threat actors. Moreover, the configuration file format outlined in this blog and the config’s interaction\nwith a virtual machine running within the malware itself appears to be unique. While CERT.pl described the configuration encryption algorithms\npreviously [3], recent samples now employ a bytecode language with its own logic that is interpreted by the malware, running in a virtual\nmachine managed by Nymaim. Technical details of the config file and its interaction with the Nymaim interpreter are outlined below.\n\n**Analysis**\n\n_Config parsing_\n\nAs other researchers have noted for various components of Nymaim [4], the configuration data is stored in an encrypted and, in some cases,\naPLib-compressed format.\n\nThe configuration data consists of a binary structure composed of multiple config components or chunks. Each data component has a\nrecognizable pattern that is structured in the following format:\n\nstruct CONFIG_LINE {\n\nDWORD     opcode;\n\nDWORD     params_length;\n\nbyte   params[params_length];\n\n}\n\nUpon further analysis, we found that the configuration is compiled bytecode-like data that runs in a custom virtual machine environment inside\nNymaim. The config has its own CODE and DATA sections, stack, local variables, registers, conditional cases, procedures, and API calls.\n\nAdditionally, the config parser includes a built-in integrity check of the params data, such that on initialization, the structure outlined above is\nexpanded in memory to four parameters:\n\nstruct CONFIG_LINE_PARSED {\n\nDWORD     opcode;\n\nDWORD     crc;\n\nDWORD     params_length;\n\nbyte   params[params_length];\n\n}\n\nThe integrity check uses a checksum algorithm that is widely used in the malware and this is its implementation:\n\ndef crc(data, data_len):\n\ndelta = 0x9AF598DC\n\ncrc = 0\n\nfor i in range(0, data_len // 4):\n\ncrc += struct.unpack_from(\"<L\", data, i * 4)[0]\n\ncrc  += data_len\n\ncrc  += delta\n\nreturn crc & 0xFFFFFFFF\n\n\n-----\n\ne st e t es o t e co g co ta t e co p e t esta p, e s o, a d p ese t t e e p at o date t oug t e tua ac e\nskips these entries, they allow us to precisely date each sample from the day it was first distributed to the day on which the campaign ended.\n\nThe virtual machine parses the rest of the config file line by line from top to bottom, first reading the code section and then reading the data\nsection at the bottom of the file.\n\n_Config execution_\n\nAs part of the virtual machine, the config interpreter can use its own stack and local variables, along with six general purpose registers.\nAdditionally there is designated space for instruction pointers and flags used by the IF-THEN-GOTO code and API/procedure results.\n\nThe config interpreter running on the virtual machine can communicate with other parts of the Nymaim code using a structure holding initial\ndata, which includes:\n\nIsAdmin flag;\nSystem version from a OSVERSIONINFOEXW structure;\nSubAuthID;\nLocale obtained by GetLocaleInfoA;\nPointer to the PEB;\nEvent handles;\nMany additional flags;\n\nIn the samples we analyzed, the interpreter did not necessarily use all of these parameters. However they are all accessible from the config's\ncode.\n\nThe interpreter itself uses a limited number of basic code logic instructions, including flexible variable and register assignments represented in\npseudocode below:\n\n// &ADDR:**** is the addressing, line by line of the config code\n\n// SP_00 to SP_** are represented as stack pointers\n\n// R0 to R5 are general purpose registers\n\n// Additionally local variables decompiled as LOC_** can be used\n\n&ADDR:0003  SP_00 = 0xFFFFFFFF; // immediate value to stack pointer assignment\n\n&ADDR:0004  SP_04 = 0x00000000;\n\n&ADDR:0005  SP_08 = 0x00000002;\n\n&ADDR:0006  SP_0C = 0x00000004;\n\n&ADDR:0007  SP_10 = 0x00000008;\n\n&ADDR:0008  SP_14 = 0x0000000C;\n\n&ADDR:0009  SP_18 = 0x00000010;\n\n...\n\n&ADDR:0017  R0 = &CPU; // pointer to the CPU data to stack pointer assignment\n\n&ADDR:0018  R1 = 0x0000003C; // immediate value to register assignment\n\n&ADDR:0019  R2 = 0x00000004;\n\n&ADDR:001A  R3 = &SP_04; // stack pointer to register assignment\n\n&ADDR:001B  R4 = 0x00000000;\n\n&ADDR:001C  R5 = 0x00000004;\n\nData initialization for the next stage, using labels as delimiters, is shown below:\n\n&ADDR:006D  InitData(start=&ADDR:007A, end=&ADDR:0081);\n\n...\n\n&ADDR:0079  LABEL_79:\n\n\n-----\n\n&ADDR:0082  LABEL_82:\n\nTEST and IF-THEN-GOTO instructions for conditional branching:\n\n&ADDR:0021  TEST &SP_34 == &SP_44;\n\n&ADDR:0022  IF True GOTO LABEL_4B;\n\n...\n\n&ADDR:002D  IF &R0[R1] == &R3[R4] GOTO LABEL_4B;\n\nProcedure calls using entry point LABEL and RET instruction:\n\n&ADDR:001F  CALL PROC_69;\n\n...\n\n&ADDR:0069  PROC_69:\n\n...\n\n&ADDR:006E  RET;\n\nAPI-like functions can call into other Nymaim code for more complicated jobs as outlined below:\n\nDetermine presence of a Environment strings (IsEnvStringSet())\nDetermine presence of certain processes running (IsProcessRunning())\nTerminate config code execution (Exit())\nSignaling events created by Nymaim (SignalEvent())\nSending debug messages to Nymaim (DebugMessage())\nDetecting sandboxing and debugging environment (IsDebugged())\n\nUpon further analysis, we were able to decode the checksums for the following processes:\n\nupdatesrv.exe\nvsserv.exe\npchooklaunch32.exe\nbdagent.exe\nseccenter.exe\naswidsagenta.exe\navastui.exe\navastsvc.exe\n\nAll of these point to executables associated with antivirus applications, suggesting that IsProcessRunning() is used to detect installed AV\nutilities.\n\nThe virtual machine uses IsDebugged() for anti-debugging checks, looking for blacklisted items associated with research environments:\n\nMAC addresses associated with virtual machine platform vendors VmWare, Dell, PCS Computer Systems GmbH, Microsoft Corporation,\nParallels, and Xensource.\nLoaded libraries \"dbghelp.dll\" and \"SbieDll.dll\" (parts of Debugging Tools For Windows and Sandboxie).\nUser names \"currentuser\" and \"sandbox\" along with computer names including \"sandbox\"\n\nNymaim does not appear to currently use the DebugMessage() function, but passes the argument to the two occurrences of this API call in\nplaintext:\n\n\"own inside started\" // on stage 1 initialization\n\"no known av detected\" // self explanatory\n\n_Typical decompiled configuration_\n\nWith this information, we were able to decompile Nymaim's config bytecode to a more human-readable pseudocode script. For reference, a\ncomplete implementation of the decompiler that generates the following output is available here [6].\n\n// VM &CPU @ B2564545\n\n// VM &TIME @ 06C742A3\n\n\n-----\n\n// & G @ 58 8305\n\n&ADDR:0000  // compile timestamp: 2018-11-20T16:36:01.263625\n\n&ADDR:0001  // version: 2.1.20.21\n\n&ADDR:0002  // expiration date: 23 November 2018\n\n&ADDR:0003  SP_00 = 0xFFFFFFFF;\n\n&ADDR:0004  SP_04 = 0x00000000;\n\n&ADDR:0005  SP_08 = 0x00000002;\n\n&ADDR:0006  SP_0C = 0x00000004;\n\n&ADDR:0007  SP_10 = 0x00000008;\n\n&ADDR:0008  SP_14 = 0x0000000C;\n\n&ADDR:0009  SP_18 = 0x00000010;\n\n&ADDR:000A  SP_1C = &SP_00;\n\n&ADDR:000B  SP_20 = &SP_04;\n\n&ADDR:000C  SP_24 = &SP_0C;\n\n&ADDR:000D  SP_28 = &SP_10;\n\n&ADDR:000E  SP_2C = &SP_14;\n\n&ADDR:000F  SP_30 = &SP_18;\n\n&ADDR:0010  SP_34 = &FLAG;\n\n&ADDR:0011  SP_38 = 0x00000000;\n\n&ADDR:0012  SP_3C = 0x0DDD766C;\n\n&ADDR:0013  SP_40 = 0x0CD874EC;\n\n&ADDR:0014  SP_44 = &SP_3C;\n\n&ADDR:0015  SP_48 = &SP_40;\n\n&ADDR:0016  InitData(start=&ADDR:0084, end=&ADDR:0091);\n\n&ADDR:0017  R0 = &CPU;\n\n&ADDR:0018  R1 = 0x0000003C;\n\n&ADDR:0019  R2 = 0x00000004;\n\n&ADDR:001A  R3 = &SP_04;\n\n&ADDR:001B  R4 = 0x00000000;\n\n&ADDR:001C  R5 = 0x00000004;\n\n&ADDR:001D  IF &R0[R1] == &R3[R4] GOTO LABEL_5F;\n\n&ADDR:001E  DebugMessage(\"own inside started\"); // not processed in any way\n\n&ADDR:001F  CALL PROC_69;\n\n&ADDR:0020  IsProcessRunning(0x9BC217C0); // Enabled\n\n&ADDR:0021  TEST &SP_34 == &SP_44;\n\n&ADDR:0022  IF True GOTO LABEL_4B;\n\n&ADDR:0023  IsEnvStringSet(0xDD076E3D);\n\n\n-----\n\n& 00 S &S _3 &S _ ;\n\n&ADDR:0025  IF True GOTO LABEL_4B;\n\n&ADDR:0026  IsDebugged(TODO flags); // 00000000 00000001 0000000F 00000000\n\n&ADDR:0027  R0 = &FLAG;\n\n&ADDR:0028  R1 = 0x00000010;\n\n&ADDR:0029  R2 = 0x00000004;\n\n&ADDR:002A  R3 = &SP_04;\n\n&ADDR:002B  R4 = 0x00000000;\n\n&ADDR:002C  R5 = 0x00000004;\n\n&ADDR:002D  IF &R0[R1] == &R3[R4] GOTO LABEL_4B;\n\n&ADDR:002E  R0 = &FLAG;\n\n&ADDR:002F  R1 = 0x00000004;\n\n&ADDR:0030  R2 = 0x00000004;\n\n&ADDR:0031  R3 = &SP_04;\n\n&ADDR:0032  R4 = 0x00000000;\n\n&ADDR:0033  R5 = 0x00000004;\n\n&ADDR:0034  IF &R0[R1] == &R3[R4] GOTO LABEL_66;\n\n&ADDR:0035  R0 = &FLAG;\n\n&ADDR:0036  R1 = 0x00000008;\n\n&ADDR:0037  R2 = 0x00000004;\n\n&ADDR:0038  R3 = &SP_04;\n\n&ADDR:0039  R4 = 0x00000000;\n\n&ADDR:003A  R5 = 0x00000004;\n\n&ADDR:003B  IF &R0[R1] == &R3[R4] GOTO LABEL_66;\n\n&ADDR:003C  SP_4C = 0xFFFFFFF7;\n\n&ADDR:003D  R0 = &FLAG;\n\n&ADDR:003E  R1 = 0x0000000C;\n\n&ADDR:003F  R2 = 0x00000004;\n\n&ADDR:0040  R3 = &SP_4C;\n\n&ADDR:0041  R4 = 0x00000000;\n\n&ADDR:0042  R5 = 0x00000004;\n\n&ADDR:0043  LOC_00 = &R0[R1] & &R3[R4];\n\n&ADDR:0044  R0 = &LOC_00;\n\n&ADDR:0045  R1 = 0x00000000;\n\n&ADDR:0046  R2 = 0x00000004;\n\n&ADDR:0047  R3 = &SP_04;\n\n&ADDR:0048  R4 = 0x00000000;\n\n\n-----\n\n& 00 9 5 0 0000000 ;\n\n&ADDR:004A  IF &R0[R1] == &R3[R4] GOTO LABEL_66;\n\n&ADDR:004B  LABEL_4B:\n\n&ADDR:004C  IsProcessRunning(\"updatesrv.exe\", \"vsserv.exe\", \"pchooklaunch32.exe\", \"bdagent.exe\", \"seccenter.exe\"); // Enabled\n\n&ADDR:004D  TEST &SP_34 == &SP_44;\n\n&ADDR:004E  IF True GOTO LABEL_5D;\n\n&ADDR:004F  R0 = 0x00000100;\n\n&ADDR:0050  R1 = 0x00000400;\n\n&ADDR:0051  R2 = 0x00000000;\n\n&ADDR:0052  R3 = 0x00000003;\n\n&ADDR:0053  // TODO ID:7DD14382 DATA:b'00000000'\n\n&ADDR:0054  TEST &SP_34 == &SP_44;\n\n&ADDR:0055  IF True GOTO LABEL_5D;\n\n&ADDR:0056  R0 = &FLAG;\n\n&ADDR:0057  R1 = 0x00000004;\n\n&ADDR:0058  R2 = 0x00000004;\n\n&ADDR:0059  R3 = &SP_04;\n\n&ADDR:005A  R4 = 0x00000000;\n\n&ADDR:005B  R5 = 0x00000004;\n\n&ADDR:005C  IF &R0[R1] == &R3[R4] GOTO LABEL_63;\n\n&ADDR:005D  LABEL_5D:\n\n&ADDR:005E  GOTO LABEL_61;\n\n&ADDR:005F  LABEL_5F:\n\n&ADDR:0060  CALL PROC_69;\n\n&ADDR:0061  LABEL_61:\n\n&ADDR:0062  Exit(0); // Exit process\n\n&ADDR:0063  LABEL_63:\n\n&ADDR:0064  SignalEvent(); // pre-process termination\n\n&ADDR:0065  Exit(0); // Exit process\n\n&ADDR:0066  LABEL_66:\n\n&ADDR:0067  SignalEvent(); // pre-process termination\n\n&ADDR:0068  Exit(0); // Exit process\n\n&ADDR:0069  PROC_69:\n\n&ADDR:006A  IsProcessRunning(\"aswidsagenta.exe\", \"avastui.exe\", \"avastsvc.exe\"); // Enabled\n\n&ADDR:006B  TEST &SP_34 == &SP_44;\n\n&ADDR:006C  IF True GOTO LABEL_6F;\n\n&ADDR:006D  InitData(start=&ADDR:007A, end=&ADDR:0081);\n\n\n-----\n\n& 006 ;\n\n&ADDR:006F  LABEL_6F:\n\n&ADDR:0070  DebugMessage(\"no known av detected\"); // not processed in any way\n\n&ADDR:0071  InitData(start=&ADDR:007A, end=&ADDR:0081);\n\n&ADDR:0072  RET;\n\n&ADDR:0073  LABEL_73:\n\n&ADDR:0074  DATA_DFE8715B = [0x00001F40, 0x00000001, 0x00000004, 0x00000001, 0x00001770, 0x00002000, 0x00000000,\n0x000000C8, 0x00000064];\n\n&ADDR:0075  DATA_97AC42CB = [0x00000000];\n\n&ADDR:0076  DATA_PAYLOAD_TARGET_ENUMERATOR = [0x00000000, 0x00000000,\n\"*'%ProgramFiles(x86)%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*instal#*;#!#*setup#*;#!#*config#*;#!#*iexplore.exe;#!#*chrome\n%!rndl_0_0_2_1_3%';$'#*';!'0;0;%!rndl_0_0_2_1_3%';*'%ProgramW6432%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*install#*;#!#*setup#*;#!#*config#*';$'#!#*win\n%!rndl_0_0_2_1_3%';$'#*';!'0;0;-%!rndl_0_0_2_1_3%'\"];\n\n&ADDR:0077  DATA_D3955141 = [0x00000001, 0x00000000, \"%!system32W6432%\\rundll32.exe; -%!rndl_0_0_2_1_3%\n%!rndl_0_0_2_3_8%.dll\"];\n\n&ADDR:0078  LABEL_78:\n\n&ADDR:0079  LABEL_79:\n\n&ADDR:007A  DATA_DFE8715B = [0x00001F40, 0x00000001, 0x00000004, 0x00000001, 0x00001770, 0x00002000, 0x00000000,\n0x000000C8, 0x00000064];\n\n&ADDR:007B  DATA_97AC42CB = [0x00000001];\n\n&ADDR:007C  DATA_BB98FAB8 = [0x00000400];\n\n&ADDR:007D  DATA_3FEF1B94 = [0x00000004];\n\n&ADDR:007E  DATA_PAYLOAD_DROPPATH = \"%SystemRoot%#*\";\n\n&ADDR:007F  DATA_PAYLOAD_DROPFILE = \"#!#*flashutil32#*;#!#*flashplayerpl#*;#!#*windowslivemail#*\";\n\n&ADDR:0080  DATA_PROCLIST_EXCLUDE_EXT = [\"iexplore.exe\", \"firefox.exe\", \"chrome.exe\", \"winword.exe\", \"outlook.exe\", \"excel.exe\",\n\"powerpnt.exe\", \"iexplore.exe\", \"firefox.exe\", \"chrome.exe\", \"winword.exe\", \"outlook.exe\", \"excel.exe\", \"powerpnt.exe\", \"acrord32.exe\",\n\"java.exe\", \"javaw.exe\", \"regsvr32.exe\", \"wscript.exe\", \"cscript.exe\", \"powershell.exe\", \"mshta.exe\", \"certutil.exe\", \"sqlservr.exe\", \"opera.exe\",\n\"msaccess.exe\", \"sysprep.exe\", \"setupsqm.exe\", \"cliconfg.exe\", \"winsat.exe\", \"mmc.exe\", \"oobe.exe\", \"inetmgr.exe\", \"taskhost.exe\",\n\"inetmgr.exe\", \"dism.exe\", \"dismhost.exe\", \"taskeng.exe\", \"cmd.exe\", \"wscript.exe\", \"cscript.exe\", \"java.exe\", \"powershell.exe\", \"mshta.exe\",\n\"winlogon.exe\", \"services.exe\", \"svchost.exe\", \"spoolsv.exe\", \"explorer.exe\", \"explorer.exe\", \"cmd.exe\", \"rundll32.exe\", \"msiexec.exe\",\n\"mspaint.exe\", \"notepad.exe\", \"calc.exe\", \"taskhost.exe\", \"dwm.exe\", \"taskmgr.exe\", \"msnmsgr.exe\", 0xF6FE5321, \"dllhost.exe\",\n\"runouce.exe\", \"vds.exe\", \"mstsc.exe\", \"mysqld.exe\", \"onenotem.exe\", \"dropbox.exe\", \"conhost.exe\", \"jusched.exe\", \"sihost.exe\",\n\"splwow64.exe\", \"msdt.exe\", \"onedrive.exe\", \"skype.exe\", \"solitaire.exe\", \"steam.exe\"];\n\n&ADDR:0081  DATA_PAYLOAD_TARGET_ENUMERATOR = [0x00000000, 0x00000000,\n\"*'%ProgramFiles(x86)%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*instal#*;#!#*setup#*;#!#*config#*;#!#*iexplore.exe;#!#*chrome\n%!rndl_0_0_2_1_3%';$'#*';!'0;0;%!rndl_0_0_2_1_3%';*'%ProgramW6432%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*install#*;#!#*setup#*;#!#*config#*';$'#!#*win\n%!rndl_0_0_2_1_3%';$'#*';!'0;0;-%!rndl_0_0_2_1_3%'\"];\n\n&ADDR:0082  LABEL_82:\n\n&ADDR:0083  LABEL_83:\n\n&ADDR:0084  DATA_8568A01D = [0x00000001, 0x00000001];\n\n&ADDR:0085  DATA_14A8D56E = [0x00, 0x02, 0x00, 0x00, 0xD4, 0x30, 0x37, 0xBF, 0x80, 0x4B, 0x8F, 0xE0, 0xE5, 0xCC, 0x27, 0xE7, 0x23,\n0xCF, 0x53, 0x37, 0xB1, 0x46, 0xD8, 0x03, 0xCA, 0xEE, 0x29, 0x4B, 0x66, 0x8A, 0x9A, 0xCA, 0x51, 0xA8, 0x95, 0x81, 0x28, 0x93, 0x01,\n0xF9, 0x60, 0x7D, 0x9A, 0x6C, 0xB2, 0x93, 0x15, 0x2B, 0x44, 0xC0, 0x6F, 0x6F, 0xB7, 0x1A, 0xC8, 0x12, 0x52, 0x1A, 0xC7, 0x28, 0x0A,\n0x46, 0x0D, 0x2E, 0x84, 0x50, 0x9B, 0xFD, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n\n\n-----\n\n0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00, 0 00,\n0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,\n0x00, 0x01];\n\n&ADDR:0086  DATA_56B437D3 = [\"system\", \"lsass.exe\", \"smss.exe\", \"csrss.exe\", \"wininit.exe\", \"services.exe\", \"lsm.exe\", \"audiodg.exe\",\n\"svchost.exe\", \"winlogon.exe\", \"spoolsv.exe\", \"searchindexer.exe\", \"msdtc.exe\", \"searchprotocolhost.exe\", \"dllhost.exe\"];\n\n&ADDR:0087  DATA_DBED7DFB = [\"system\", \"lsass.exe\", \"smss.exe\", \"csrss.exe\", \"wininit.exe\", \"services.exe\", \"lsm.exe\", \"audiodg.exe\",\n\"svchost.exe\", \"winlogon.exe\", \"spoolsv.exe\", \"searchindexer.exe\", \"msdtc.exe\", \"explorer.exe\", \"dwm.exe\"];\n\n&ADDR:0088  DATA_PROCLIST_EXCLUDE = [\"wininit.exe\", \"csrss.exe\", \"smss.exe\", \"avp.exe\", \"avpui.exe\", \"avgnt.exe\", \"avguard.exe\",\n\"sched.exe\", \"aswidsagenta.exe\", \"avastsvc.exe\", \"avastui.exe\", \"ccsvchst.exe\", \"avgcsrvx.exe\", \"avgnsx.exe\", \"avgrsx.exe\", \"avgtray.exe\",\n0x6EEA1E2D, \"avgwdsvc.exe\", \"ekrn.exe\", \"egui.exe\", \"msmpeng.exe\", \"msseces.exe\", \"mpcmdrun.exe\", \"psimsvc.exe\", \"apvxdwin.exe\",\n\"avengine.exe\", \"pavfnsvr.exe\", \"pavprsrv.exe\", \"pavsrvx86.exe\", \"psctrls.exe\", \"psksvc.exe\", \"fpavserver.exe\", 0xBAA21E23, \"fpwin.exe\",\n\"cmdagent.exe\", \"cfp.exe\", \"gdscan.exe\", \"gdsc.exe\", \"avktray.exe\", \"avkservice.exe\", \"avkproxy.exe\", \"pctsgui.exe\", \"pctssvc.exe\",\n\"pctsauxs.exe\", \"update.exe\", \"updatesrv.exe\", \"vsserv.exe\", \"pchooklaunch32.exe\", \"bdagent.exe\", \"seccenter.exe\", \"mrt.exe\",\n\"mcupdate.exe\", \"mcagent.exe\", \"mcmscsvc.exe\", \"mcnasvc.exe\", \"mcproxy.exe\", \"mcsacore.exe\", \"mcshell.exe\", \"mcshield.exe\",\n\"mcsysmon.exe\", \"mpfsrv.exe\", \"msksrver.exe\", \"udaterui.exe\", \"engineserver.exe\", \"frameworkservice.exe\", \"engineserver.exe\",\n\"frameworkservice.exe\", \"mctray.exe\", \"naprdmgr.exe\", \"shstat.exe\", \"vstskmgr.exe\", \"almon.exe\", \"alsvc.exe\", \"savadminservice.exe\",\n0x12FCC4EB, \"savservice.exe\", \"swi_service.exe\", 0xBC6D3196, \"protoolbarupdate.exe\", \"sfctlcom.exe\", \"tmbmsrv.exe\", \"tmpfw.exe\",\n\"tmproxy.exe\", \"tscfplatformcomsvr.exe\", 0xAEF84E17, \"ufseagnt.exe\", 0x3DC44746, 0x13F2ED0D, 0x4B4EA20C, \"umxagent.exe\",\n\"umxcfg.exe\", \"umxpol.exe\", \"caav.exe\", \"casc.exe\", \"cavrid.exe\", \"ccprovsp.exe\", \"vetmsg.exe\", \"vmwaretray.exe\", \"vmwareuser.exe\",\n0xBD157242, \"vmtoolsd.exe\", \"wrsa.exe\"];\n\n&ADDR:0089  DATA_5DD00BF4 = [\"winlogon.exe\"];\n\n&ADDR:008A  DATA_87045172 = [\"explorer.exe\", \"dwm.exe\", \"taskhost.exe\", \"conhost.exe\"];\n\n&ADDR:008B  DATA_0B7EEE53 = [0x00000000];\n\n&ADDR:008C  DATA_FFF28C72 = \"zepter.com;carfax.com;\";\n\n&ADDR:008D  DATA_GOOGLE_DNS = [0x00000003, timeout_write=8000, timeout_read=8000, 0x00000001, 0x00000002,\n\"8.8.8.8:53;8.8.4.4:53\"];\n\n&ADDR:008E  DATA_992CC894 = [0x00000000, 0x00000001, 0x00000001, 0x00000002, 0x00000001, 0x00000001, 0x00000000,\n0x00000000, 0x00000000, 0x00000000, \"gx3Gd93kdXdjd]dGdg573\"];\n\n&ADDR:008F  DATA_8DB1E244 = [0x00000001, 0x18482642, 0x78643587, 0x87568289, 0x00000010];\n\n&ADDR:0090  DATA_C9393B40 = \"~[duewosgems.com];fiosbewos.com;\";\n\n&ADDR:0091  DATA_F50DF89A = [0x00000019, 0x000493E0, 0x00000001, 0x00000001, \"~\n\n[duewosgems.com]/pkbn74is/index.php;fiosbewos.com/pkbn74is/index.php;\"];\n\n&ADDR:0092  LABEL_92:\n\n&ADDR:0093  END;\n\n**Conclusion**\n\nNymaim is one of a number of downloaders appearing regularly in the wild, reflecting the trend of installing persistent malware on victim\ndevices. Although Nymaim has a long history as a downloader and earlier incarnations as ransomware and a desktop locker, little is known\nabout its ownership or availability to other threat actors. We were, however, able to decode the unique config, providing additional insight for\ndefenders and potential victims of increasingly frequent Nymaim campaigns.\n\n**References**\n\n[1] [https://www.welivesecurity.com/2013/08/26/nymaim-obfuscation-chronicles/](https://www.welivesecurity.com/2013/08/26/nymaim-obfuscation-chronicles/)\n\n[2] [https://www.proofpoint.com/us/what-old-new-again-nymaim-moves-past-its-ransomware-roots-0](https://www.proofpoint.com/us/what-old-new-again-nymaim-moves-past-its-ransomware-roots-0)\n\n[3] [https://www.welivesecurity.com/2013/10/23/nymaim-browsing-for-trouble/](https://www.welivesecurity.com/2013/10/23/nymaim-browsing-for-trouble/)\n\n[4] [http://www.eset.com/int/about/press/articles/article/nymaim-ransomware-still-active-finding-new-infection-vector-to-spread-black-hat-seo/](http://www.eset.com/int/about/press/articles/article/nymaim-ransomware-still-active-finding-new-infection-vector-to-spread-black-hat-seo/)\n\n[5] [https://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Ransom:Win32/Nymaim.F#tab=2](https://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Ransom:Win32/Nymaim.F#tab=2)\n\n[6] [https://github.com/EmergingThreats/threatresearch/blob/master/Nymaim/config_decompiler.py](https://github.com/EmergingThreats/threatresearch/blob/master/Nymaim/config_decompiler.py)\n\n\n-----\n\n**d cato s o Co** **p o** **se ( OCs)**\n\n**IOC** **IOC Type** **Description**\n\n76b855f4822c0b26e098d7395723b31ad73c1606aebdb972380ef6c9f0bb4936 SHA256 Nymaim sample (2019)\n\n8cb27fca6cf68888126a82c304083ebd78bba2b9f6fb241d2a177a3a80f12e8a SHA256 Nymaim sample (2019)\n\n0f115ff9d7ecbe2b4872a18c14e97d6071a61435690729c9aa741cecc8982383 SHA256 Nymaim sample (2019)\n\n7541c32d82b17e9d3a993f6721a1b84221dfbee6cbe7f060413a118c48ae64ee SHA256 Nymaim sample (2019)\n\n43c19be78773a14196abb4ecb6436b54729373eacf84da7a9a2c3592ad960cae SHA256 Nymaim sample (2019)\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-12 - Nymaim config decoded.pdf"
    ],
    "report_names": [
        "2019-03-12 - Nymaim config decoded.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535712,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1653754207,
    "ts_modification_date": 1653754207,
    "files": {
        "pdf": "https://archive.orkl.eu/64051b402558afeaa07b5e53ed5c98c14972d6c7.pdf",
        "text": "https://archive.orkl.eu/64051b402558afeaa07b5e53ed5c98c14972d6c7.txt",
        "img": "https://archive.orkl.eu/64051b402558afeaa07b5e53ed5c98c14972d6c7.jpg"
    }
}