{
    "id": "e5e5f67e-2add-4594-bda1-00687b543b34",
    "created_at": "2023-01-12T15:05:25.972629Z",
    "updated_at": "2025-03-27T02:17:11.235211Z",
    "deleted_at": null,
    "sha1_hash": "cdfed0c8abf707b13738bb4b61514374fc330147",
    "title": "2020-10-02 - Graphology of an Exploit – Hunting for exploits by looking for the author’s fingerprints",
    "authors": "",
    "file_creation_date": "2022-05-27T22:55:17Z",
    "file_modification_date": "2022-05-27T22:55:17Z",
    "file_size": 853075,
    "plain_text": "# Graphology of an Exploit – Hunting for exploits by looking for the author’s fingerprints\n\n**[research.checkpoint.com/2020/graphology-of-an-exploit-volodya/](https://research.checkpoint.com/2020/graphology-of-an-exploit-volodya/)**\n\nOctober 2, 2020\n\nOctober 2, 2020\n**Research by: Itay Cohen, Eyal Itkin**\n\nIn the past months, our Vulnerability and Malware Research teams joined efforts to focus on\nthe exploits inside the malware and specifically, on the exploit writers themselves. Starting\nfrom a single Incident Response case, we built a profile of one of the most active exploit\ndevelopers for Windows, known as “Volodya” or “BuggiCorp”. Up until now, we managed to\ntrack down more than 10 (!) of their Windows Kernel Local Privilege Escalation (LPE)\nexploits, many of which were zero-days at the time of development.\n\n## Background\n\nOur story begins, as all good stories do, with an incident response case. When analyzing a\ncomplicated attack against one of our customers, we noticed a very small 64-bit executable\nthat was executed by the malware. The sample contained unusual debug strings that pointed\nat an attempt to exploit a vulnerability on the victim machine. Even more importantly, the\nsample had a leftover PDB path which proclaimed loud and clear the goal of this binary:\n```\n...\\cve-2019-0859\\x64\\Release\\CmdTest.pdb . With the absence of any online\n\n```\n\n-----\n\n[resource with this implementation of CVE-2019-0859, we realized that we are not looking at](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0859)\na publicly available PoC, but rather a real-world exploitation tool. This intrigued us to dig\ndeeper.\n\nReverse-engineering the exploit was pretty straight forward. The binary was small, and the\ndebug messages were there to guide us. It exploited a use-after-free (UAF) vulnerability in\n```\nCreateWindowEx to gain elevated privileges to the parent process. We quickly made an\n\n```\ninteresting observation: it seemed like the exploit and the malware itself weren’t written by\nthe same people. The code quality, lack of obfuscation, PDBs, and timestamps, all pointed to\nthis conclusion.\n\n**Figure 1: A call to** `CreateWindowEx, as can be seen in Cutter.`\n\n## Exploits Distribution 101\n\nWe tend to look at the people behind a specific malware family as one unbroken unit. It’s\neasier to envision that each and every component was written by a single person, team, or\ngroup. Truth is, writing an advanced malware, by nation-states or criminals, involves different\ngroups of people with various skills. A cyber-espionage organization of a nation-state, is\nlikely to have hundreds or even thousands of employees in different groups and branches.\nEach worker in the organization has a specific role, fine-tuned by special technological\ntraining and years of expertise. In such an organization, the workload of writing the common\ncomponents is broken down among specialized teams, with different ones responsible for\nthe initial access, collecting sensitive data, lateral movement, and more.\n\nAn operational entity whose goal is to embed an exploit module in its malware can’t rely on\nmalware developers alone. Finding a vulnerability, and reliably exploiting it, will most\nprobably be done by specific teams or individuals who specialize in a particular role. The\nmalware developers for their part don’t really care how it works behind the scenes, they just\nwant to integrate this module and be done with it.\n\n\n-----\n\nFor this division of labor to work, both teams need to agree on some API that will be the\nbridge between the different components. This integration API isn’t unique to state actors,\nbut is a common feature in the “free market” of exploits. Whether it involves underground\nforums, exploit brokers, or offensive cyber companies, they all provide their customers with\ninstructions on how to integrate the exploit in their malware.\n\nIn essence, this integration point is the key aspect that we would like to focus on in our\nresearch. Assuming that exploit authors work independently, and only distribute their\ncode/binary module to the malware authors, we decided to focus on them for a change. By\nanalyzing the exploits embedded in malware samples, we can learn more about the exploit\nauthors, hopefully distinguishing between them by studying their coding habits and other\nfingerprints left as clues on their identity, when distributing their products to their malware\nwriting counterparts.\n\n## Fingerprinting Exploit Developers\n\nInstead of focusing on an entire malware and hunting for new samples of the malware family\nor actor, we wanted to offer another perspective and decided to concentrate on these few\nfunctions that were written by an exploit developer. Having this small 64-bit binary from the\nincident response case looked like a promising start.\n\nThe binary did nothing other than exploiting CVE-2019-0859 and wasn’t based on a sourcecode or a POC that was shared publicly. It made a great candidate for us to fingerprint, as\nthe executable was refined from code written by someone other than the exploit author.\nMoreover, the executable was separated from the main binary of the malware, an infamous\ncrimeware, which made us believe that this exploit wasn’t developed in-house by the\nmalware developers. With this hope, we set out to find more exploits written by the same\nauthor.\n\nWe started by gathering simple artifacts from the binary we already had: strings, internal file\nname, timestamps, and the PDB path. The first result came immediately — a 32-bit\nexecutable that was an exact match to the 64-bit sample. Specifically, as their timestamps\nand embedded PDB path showed, they were compiled together, at the same time and from\nthe same source code. Now that we had these two samples, we were able to formulate what\nwe should look for.\n\nTo fingerprint the author of this exploit, we set our sights on the following:\n\nUnique artifacts in the binaries\n\nHard-coded values (Crypto constants, “garbage” values such as 0x11223344)\nData tables (Usually version-specific configurations)\nStrings (GDI object names: “MyWindow”, “MyClass_56”, “findme1”, …)\nPDB path\n\n\n-----\n\nCode snippets\n\nUnique implementation of functions\n\nSyscall wrappers\nInline assembly\nProprietary crypto functions / implementations\nTechniques and habits\n\nPreferred leaking technique ( HMValidateHandle, `gSharedInfo, etc.)`\nPreferred elevation technique (How is the token replacement performed?)\nHeap spraying technique (Using AcceleratorTables? Windows? Bitmaps?)\nFramework\n\nThe flow of the exploits\n\n**Option #1: Main exploit flow with almost no side-branches**\n**Option #2: Multiple twists and knobs for different versions of the OS**\nThe structure of the code and functions in it\n\n**Modularity: Separation to functions**\n**Structure: Separation to clear phases (Init, config, spray, token swap,**\n…)\n**Global Variables: What information is stored in global variables? (OS**\nversion? OS version enum? Just a specific field offset?)\nVersion-specific configurations:\n\n**Field offsets: What fields are of special interest?**\n**Preferred system calls: Preferred set of syscalls**\nAPI provided to the customer\n\n**Figure 2: The set of exploit-related artifacts that we will be looking for.**\n\n\n-----\n\nWith these properties in mind, we looked back at the two samples we had and marked some\nartifacts we thought were unique. Even though we had only two small binaries (which were\nessentially the same) we were able to create hunting rules to find more samples written by\nthis developer. To our surprise, we were able to find more of them than we could have\nimagined.\n\nOne after the other, dozens of samples started to appear, and with each one, we improved\nour hunting rules and methodologies. With a careful analysis of the samples, we were able to\nunderstand which samples exploited which CVE, and based on that created a timeline to\nunderstand whether the exploit was written as a 0-day before it was exposed, or was it a 1day that was implemented based on patch-diffing and similar techniques.\n\nAt this point, we had more than 10 CVEs that we were able to attribute to the same exploit\ndeveloper, based on our fingerprinting technique alone and without further intelligence. Later\non, public reports revealed the name of our target exploit seller: Volodya (a.k.a Volodimir),\npreviously known as BuggiCorp. It seemed we were not the only ones to track this exploit\nseller, as Kaspersky [reported some relevant information about them on several](https://www.zdnet.com/article/mysterious-hacker-has-been-selling-windows-0-days-to-apt-groups-for-three-years/) [occasions. In](https://twitter.com/craiu/status/1118756989503406082)\n[addition, ESET also mentioned some of Volodya’s incriminating trails in their VB2019 talk](https://www.youtube.com/watch?v=fsbLLAlC7sE)\nabout Buhtrap.\n\nAccording to Kaspersky, Volodya first made headlines under their “BuggiCorp” nickname,\nwhen they [advertised a Windows 0-day for sale on the infamous Exploit[.]in cyber-crime](https://slack-redir.net/link?url=https%3A%2F%2Fwww.trustwave.com%2Fen-us%2Fresources%2Fblogs%2Fspiderlabs-blog%2Fzero-day-auction-for-the-masses%2F)\nforum with a starting price of $95,000. Across the years, the price went up and some of their\nWindows LPE 0-day exploits were sold at a price as high as $200,000. As published in\nKaspersky’s report, and later confirmed by us, Volodya sold exploits to both crimeware and\nAPT groups. We discuss the actor’s clients in more detail under the chapter “The\nCustomers”.\n\n## Our actor’s exploits\n\nAlthough a few of our initial hunting rules needed some fine-tuning, even the immediate\nresults we received were quite surprising. After further calibration, we managed to find\nnumerous samples, all of which were Local Privilege Escalation (LPE) exploits in Windows.\nOut of these samples, we were able to identify the following list of CVEs that were exploited\nby our actor.\n\n**_Side note:_**\n\n_During the classification of the exploits, we chose to take a conservative approach when_\n_deciding if a given vulnerability was exploited as a 0-Day or 1-Day. If other security vendors_\n_attributed the in-the-wild exploit to our actor, then it was a 0-Day. If we found sufficient_\n_evidence that one of our samples is indeed the exploit circulating in the wild, exactly as was_\n_described by a vendor in their report, then we also flagged it as such._\n\n\n-----\n\n_In all other cases, we marked the vulnerability as an exploited 1-Day, preferring to have a_\n_lower bound of the 0-Day count instead of mistakenly overshooting the correct number._\n\n### CVE-2015-2546\n\n**Classification: 1-Day**\n\n**Basic Description: Use-After-Free in** `xxxSendMessage ( tagPOPUPMENU )`\n\n**[0-Day vendor report: FireEye](https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/twoforonefinal.pdf)**\n\n**Found in the following Malware samples: Ursnif, Buhtrap**\n\nOur exploit samples use a different memory shaping technique than the one described in the\ninitial report: spraying Windows instead of Accelerator Tables. In addition, our earliest and\nmost basic exploit sample contains the following PDB path, suggesting the author already\nknew the CVE-ID for this vulnerability: “C:\\…\\volodimir_8\\c2\\CVE-2015**2546_VS2012\\x64\\Release\\CmdTest.pdb”**\n\n### CVE-2016-0040\n\n**Classification: 1-Day**\n\n**Basic Description: Uninitialized kernel pointer in** `WMIDataDevice IOControl`\n\n**0-Day vendor report: N/A. Was never exploited as a 0-Day in the wild**\n\n**Found in the following Malware samples: Ursnif**\n\nThis exploit was used in a single sample that also contained the previously described exploit\nfor CVE-2015-2546. This exploit is selected if the target is a Windows version earlier than\nWindows 8. Otherwise, CVE-2015-2546 is used.\n\n### CVE-2016-0167\n\n**Classification: 0-Day**\n\n**Basic Description: Use-After-Free in** `Win32k!xxxMNDestroyHandler`\n\n**[0-Day vendor report: FireEye.](https://www.fireeye.com/blog/threat-research/2016/05/windows-zero-day-payment-cards.html)**\n\n**Found in the following Malware samples: PUNCHBUGGY**\n\nOur exploit samples align perfectly with the technical report about the in-the-wild exploit.\n\n### CVE-2016-0165*\n\n**Classification: 1-Day**\n\n**Basic Description: Use-After-Free in** `Win32k!xxxMNDestroyHandler`\n\n**0-Day vendor report: Found by Kaspersky, but no report was published publicly**\n\n**Found in the following Malware samples: Ursnif**\n\n\n-----\n\nThis is an interesting case. Our actor s 0-Day (CVE-2016-0167) was patched by Microsoft in\nApril 2016. The same patch also fixed CVE-2016-0165 which was also used in the wild.\nSearching for a new vulnerability to exploit, our actor probably patch-diffed Microsoft’s fixes\nand found a vulnerability that they thought was the patched 0-Day. This vulnerability\noriginates in the patched function used in their previous vulnerability:\n```\nWin32k!xxxMNDestroyHandler .\n\n```\n*We have multiple indications from their exploit samples for this vulnerability that either the\nexploit author or at least their customers were certain that they were sold an exploit for CVE2016-0165. The sad truth is, after analyzing the exploit, we can say that the exploited\nvulnerability is a different one.\n\n**Figure 3: Debug string indicating the confusion around CVE-2016-0165, as can be seen in**\nCutter.\n\nThis confusion is probably due to the fact that Microsoft releases a single fix that addresses\nmultiple vulnerabilities, and they are the only ones with the full mapping between each code\nfix and the CVE that was issued for it.\n\n### CVE-2016-7255\n\n**Classification: 0-Day**\n\n**Basic Description: Memory corruption in** `NtUserSetWindowLongPtr`\n\n**[0-Day vendor report: Reported by Google, a technical report by](https://security.googleblog.com/2016/10/disclosing-vulnerabilities-to-protect.html)** [TrendMicro](https://blog.trendmicro.com/trendlabs-security-intelligence/one-bit-rule-system-analyzing-cve-2016-7255-exploit-wild/)\n\n**Found in the following Malware samples: Attributed to APT28 (aka Fancy Bear, Sednit).**\nUsed later by Ursnif, Dreambot, GandCrab, Cerber, Maze\n\n\n-----\n\nOur exploit samples align perfectly with the technical report about the in-the-wild exploit. This\nspecific exploit was later widely used by different ransomware actors. In addition, we’ve seen\nother exploits for this specific vulnerability that were sold as 1-Days to other ransomware\nactors as well.\n\n**Note: We have multiple circumstantial evidence to believe that this 0-Day was the one that**\n[was mentioned by BuggiCorp in the famous ad posted to the exploit[.]in forum in May 2016.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/zero-day-auction-for-the-masses/)\n\n### CVE-2017-0001\n\n**Classification: 1-Day**\n\n**Basic Description: Use-After-Free in** `RemoveFontResourceExW`\n\n**0-Day vendor report: N/A. Was never exploited as a 0-Day in the wild**\n\n**Found in the following Malware samples: Attributed to Turla. Later used by Ursnif**\n\n[Used as a 1-Day in operations attributed to Turla (FireEye).](https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html)\n\n### CVE-2017-0263\n\n**Classification: 0-Day**\n\n**Basic Description: Use-After-Free in** `win32k!xxxDestroyWindow`\n\n**[0-Day vendor report: ESET](https://www.welivesecurity.com/2017/05/09/sednit-adds-two-zero-day-exploits-using-trumps-attack-syria-decoy/)**\n\n**Found in the following Malware samples: Attributed to APT28 (aka Fancy Bear, Sednit)**\n\nOur exploit samples align perfectly with the technical report about the in-the-wild exploit.\n\n### CVE-2018-8641*\n\n**Classification: 1-Day**\n\n**Basic Description: Double Free in** `win32k!xxxTrackPopupMenuEx`\n\n**0-Day vendor report: N/A. Was never exploited as a 0-Day in the wild**\n\n**Found in the following Malware samples: Magniber**\n\nOnce again, identifying the used 1-Days is usually harder than identifying 0-Days. This time,\nwe couldn’t find any sample that might hint as to what was the vulnerability the actor thought\nthey were exploiting.\n\n*We identified that this specific vulnerability was patched by Microsoft in December 2018.\nAfter scanning the list of vulnerabilities that were addressed in this patch, we are pretty\ncertain that Microsoft labeled this vulnerability as CVE-2018-8641, but we can’t know for\nsure.\n\n**[Update: On June 24, 2020 Kaspersky published in their blog an analysis of exploits](https://securelist.com/magnitude-exploit-kit-evolution/97436/)**\ndistributed through the Magnitude exploit kit. In their blog post, Kaspersky analyzed the LPE\nexploit used by Magniber, attributed it to Volodya and estimated it is probably CVE-2018\n\n-----\n\n8641. This independent conclusion on behalf of Kaspersky strengthens our initial estimate.\n\n### CVE-2019-0859\n\n**Classification: 0-Day**\n\n**Basic Description: Use-After-Free in** `CreateWindowEx`\n\n**[0-Day vendor report: Kaspersky](https://securelist.com/new-win32k-zero-day-cve-2019-0859/90435/)**\n\n**Found in the following Malware samples: Used as a standalone component to be injected**\nor loaded. We couldn’t attribute it to any specific APT/malware.\n\nOur exploit samples align perfectly with the technical report about the in-the-wild exploit. Our\nresearch started with a single sample of this exploit that was found in a customer’s network.\nIn one of the samples we found later on, we could see this clear PDB string:\n“X:\\tools\\0day\\09-08-2018\\x64\\Release\\RunPS.pdb”, as opposing to the PDB string in our\ninitial sample: “S:\\Work\\Inject\\cve-2019-0859\\Release\\CmdTest.pdb“.\n\n### CVE-2019-1132*\n\n**Classification: 0-Day**\n\n**Basic Description: NULL pointer dereference at** `win32k!xxxMNOpenHierarchy`\n( tagPOPUPMENU )\n\n**[0-Day vendor report: ESET](https://www.welivesecurity.com/2019/07/10/windows-zero-day-cve-2019-1132-exploit/)**\n\n**Found in the following Malware samples: Attributed to Buhtrap**\n\n*We have multiple reasons to believe that this was another 0-Day exploit from Volodya, as\nmultiple technical details in the report match their typical ways of exploitation. In addition, the\nexploit reported having the following PDB path embedded in it: “C:\\work\\volodimir_65\\…\npdb”. However, this is the only exploit in our list that we have not yet found a sample of, and\nso we can’t be sure in our attribution for this exploit.\n\n### CVE-2019-1458\n\n**Classification: 1-Day**\n\n**Basic Description: Memory corruption in window switching**\n\n**[0-Day vendor report: Kaspersky (Initial Report,](https://securelist.com/windows-0-day-exploit-cve-2019-1458-used-in-operation-wizardopium/95432/)** [Detailed Report)](https://securelist.com/the-zero-day-exploits-of-operation-wizardopium/97086/)\n\n**Found in the following Malware samples: Attributed to operation WizardOpium**\n\nOur exploit doesn’t align with the technical report about the in-the-wild exploit. In addition, in\ntheir detailed report, Kaspersky noted that “it was also interesting that we found another 1day exploit for this vulnerability just one week after the patch, indicating how simple it is to\nexploit this vulnerability.” And indeed, our sample is dated to 6 days after Kaspersky’s initial\nreport.\n\n### Vulnerabilities Summary\n\n\n-----\n\nHere is a table summarizing the vulnerabilities we ve listed:\n\n**CVE** **Is 0-Day?**\n\nCVE-2015-2546 No\n\nCVE-2016-0040 No\n\nCVE-2016-0165* No\n\nCVE-2016-0167 **Yes**\n\nCVE-2016-7255 **Yes**\n\nCVE-2017-0001 No\n\nCVE-2017-0263 **Yes**\n\nCVE-2018-8641* No\n\nCVE-2019-0859 **Yes**\n\nCVE-2019-1132* **Yes**\n\nCVE-2019-1458 No\n\n**Total Count** **5 out of 11**\n\n## The author’s fingerprints\n\nNow that we found more than 10 different exploits from Volodya, we can review them in\ngreater detail and familiarize ourselves with the actor’s work habits. It was clear to us from\nthe beginning that our actor probably has a simple template they deploy for the different\nexploits, as the function flow of each exploit, and even the order of the different functions,\nwere shared between most of the exploits.\n\n\n-----\n\nThroughout this section, we describe a collection of key characteristics, that reflect the\ndifferent implementation choices made by Volodya when creating the exploit template. We\ncompare their implementation to that of another exploit writer, known by the nickname\n_PlayBit. By this comparison we aim to outline the wide variety of implementation options that_\nare present in each part of the exploit, making each author’s set of implementation choices a\nunique “signature” of their way of thinking and working.\n\n### PlayBit (a.k.a luxor2008)\n\nUsing the same technique we used to hunt Volodya’s exploits, we managed to track down 5\nWindows LPE 1-Day exploits that were written by PlayBit, in addition to other tools that the\nauthor sold throughout the years. We started from a single sample, CVE-2018-8453 which is\nused by REvil ransomware, and used PlayBits’ unique fingerprints to seek out more exploits.\n\nWe found the following Windows LPE exploits implemented as 1-days by this author:\n\nCVE-2013-3660\nCVE-2015-0057\nCVE-2015-1701\n**CVE-2016-7255 – This is a 0-Day of Volodya**\nCVE-2018-8453\n\n[Technically, PlayBit also sold two exploits for CVE-2019-1069 (a SandboxEscaper](https://twitter.com/sandboxbear?lang=en)\nvulnerability) and CVE-2020-0787. However, we ignore these exploits as they aren’t memory\ncorruption vulnerabilities, but rather a vulnerability in different services, and as such have a\ndifferent structure.\n\n**Note: A deeper analysis of PlayBit, and the different exploits they developed and sold, will**\nbe released in an upcoming blog post.\n\n### bool elevate(int target_pid)\n\nThe API in all of Volodya’s exploit samples is always the same. Regardless of whether it was\nembedded inside a malware sample, or was a standalone POC, the exploit had a single API\nfunction of the following signature:\n\n```\nbool elevate(int target_pid)\n\n```\n\n-----\n\n**Figure 4: Invoking the elevate(target_pid) function, as can be seen in Cutter.**\n\nThe exploit itself doesn’t include any feature for injecting shellcode into another process or\nanything fancy of this sort. It grants SYSTEM privileges to the desired process, taking\nnothing other than its PID as an argument.\n\n### Sleep(200)\n\nThe very first thing that the `elevate() function does, right after it’s invoked by the`\nmalware, is to `Sleep() for a constant time period of 200 milliseconds.`\n\n**Figure 5: Starting the exploit with a call to** `Sleep(200), as can be seen in Cutter.`\n\n\n-----\n\nIt is not absolutely clear why the `Sleep(200) is there in the template of the exploits. We`\nsuspect it is to avoid unnecessary instability, especially because most of these exploits are\nbased on timing (UAF, races). Therefore, waiting a short while for the I/O and memory\naccess related activities to end could improve stability. As the exploits are part of malware, all\nthis malware-related code before the exploit’s execution will cause a short spike in\nCPU/disk/RAM, and it might make sense to let things calm down a bit before moving on to\nthe actual exploit. For short-term spike load (that naturally occurs when starting new\nprocesses, reading/writing files from disk, etc.), it should be enough to wait 200ms.\n\nAlthough we’ve noticed a change in this pattern in the most recent samples, this feature can\nstill be found in 9 of the exploits we’ve seen.\n\n**Comparison to PlayBit: PlayBit doesn’t have any such feature in their exploits.**\n\n### OS Fingerprinting\n\nRight after waking from its beauty sleep, the exploit identifies and calibrates itself to the\ntarget’s Windows version, so as to facilitate the support for as many OS versions as possible.\nFrom our samples, it seems that the author queries the OS using two techniques:\n\n**Parsing ntdll.dll’s header**\n\nThis is the most commonly used technique. A handle into `ntdll.dll is used to find the`\noffset into the `IMAGE_NT_HEADERS, from which the` `MajorOperatingSystemVersion and`\nthe `MinorOperatingSystemVersion fields are parsed.`\n\n**GetVersionEx()**\n\nThis technique is usually used together with the previous one and was only used in samples\nfrom 2016 to the beginning of 2017. This is probably due to the fact that this API is now\n[deprecated.](https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getversionexa)\n\n**Figure 6: Calling** `GetVersionExW() to get Windows’s version, as can be seen in Cutter.`\n\nIn both of these techniques, the goal is to query both the major and minor version of the OS,\nand configure the exploit’s global variables accordingly.\n\n\n-----\n\nWhile most exploits support a wide range of Windows versions, Volodya never seems to care\nabout the specific service pack of the target, nor about whether it is a Windows server or not.\nAside from the interest in specific Windows 10 build versions, used only in the exploit for\nCVE-2019-1458, our actor only uses the major and minor versions, and that’s it.\n\n**Comparison to PlayBit: Once again,** `GetVersionEx() is used, usually with a later`\nadditional parsing of the major and minor numbers from the Process Environment Block\n(PEB) itself, as can be seen in Figure 7. Not only is PEB used instead of `ntdll.dll,`\nPlayBit also extracts additional information from the `GetVersionEx() output such as the`\ncomputer’s Service Pack, and even checks if the target computer uses a server operating\nsystem.\n\n**Figure 7: Extracting the major and minor versions from the PEB, as can be seen in Cutter.**\n\nThis is a clear difference in the modus operandi of both actors. Not only do they extract the\nsame information in different ways, Volodya is interested in far less information than PlayBit,\neven when they both exploit the same vulnerability (CVE-2016-7255).\n\nIn general, both actors hold detailed version-specific configurations from which they load the\nrelevant information once the OS version is determined. The main difference between the\ntwo is that the code flow in Volodya’s exploits rarely depends on the OS version, while\nPlayBit incorporates multiple twists and knobs using various if-checks that depend on the OS\nversion. This in turn affects their different interest in the exact version details.\n\n### Leaking Kernel Addresses\n\nIn the vast majority of exploits, the actor tunes the exploit using a kernel-pointer-leak\nprimitive. In all exploits except CVE-2019-1458, this leak primitive is the well-known\n[HMValidateHandle technique.](https://theevilbit.github.io/posts/a_simple_protection_against_hmvalidatehandle_technique/)\n```\nHMValidateHandle() is an internal unexported function from user32.dll, that is\n\n```\nleveraged by various functions such as `isMenu(), and can be used to get the kernel`\naddress of different Window objects in all Windows versions up to Windows 10 RS4. This\n\n\n-----\n\ntechnique was well known and used even back in 2011, whereby most exploitation tutorials\nchose to specifically parse `isMenu() to find the address of` `HMValidateHandle() .`\n\nIt is surprising to see that out of dozens of different functions that could be used for finding\n```\nHMValidateHandle(), the actor simply followed the well-known tutorials and chose to use\nisMenu() as well. It is even more surprising to see that this common exploitation technique\n\n```\nstill worked quite well throughout the years, giving the actor no incentive to try to “hide” by\npicking a less known function such as `CheckMenuRadioItem() .`\n\nThe leak gives us the following:\n\nKernel address of our window.\nKernel address of our `THREAD_INFO (the` `pti field).`\n\nThis information is used in several steps during the exploit:\n\nAddresses are used when pointing to / creating fake kernel structs.\nMaking sure our kernel address is a valid Unicode string (doesn’t contain two\nconsecutive ‘\\x00’ bytes).\nThe `pti is used to locate a valid EPROCESS, which is then used during the Token`\nSwap phase.\n\n**Comparison to PlayBit: PlayBit chose to implement this feature via direct access to the**\nuser-mode Desktop Heap. More on this subject could be found in the future blog post\nfocusing on this actor.\n\n### Token Swap\n\nThe ultimate goal of the exploit is to grant SYSTEM privileges to the desired process,\naccording to the given PID argument. Traditionally, the way to achieve this is by replacing the\nprocess’s token in the EPROCESS/KPROCESS structure with the token of the SYSTEM\nprocess.\n\nHere are some common techniques for doing exactly that. You’d be surprised to see how\nmany different options there are for implementing this feature.\n\n**Using Ps* symbols**\n\nThe Windows kernel contains the following functions and global variables for process-related\nfunctionality:\n```\n   PsLookupProcessByProcessId – Retrieves a pointer to the process’s EPROCESS.\n   PsInitialSystemProcess – Global variable holding a pointer to the SYSTEM’s\n\n```\nEPROCESS.\n```\n   PsReferencePrimaryToken – Returns a pointer to the primary token of the process.\n\n```\n\n-----\n\nBy executing these functions in kernel-mode, a given shellcode can easily locate SYSTEM s\ntoken, but it still doesn’t solve the issue of how to assign it in the required EPROCESS.\n\nFor this purpose there are 2 common solutions:\n\nDirectly access the correct offset inside the EPROCESS using a version-specific offset.\nScan the EPROCESS in search of our own pointer (known by the previous call to\n```\n   PsReferencePrimaryToken ) and replace the entry once a match is found.\n\n```\nThis technique requires executing code in kernel-mode, and so will be blocked by the SMEP\nprotection, unless an additional SMEP bypass is deployed.\n\n**Scanning the PsList**\n\nThe common alternative for locating the EPROCESS of both the target and SYSTEM\nprocesses, is to scan the doubly-linked process list, referred to as PsList. The steps involved\nin this technique are:\n\n1. Locate an initial EPROCESS (using the leaked pti field).\n2. Scan the PsList in search of an EPROCESS with the target PID.\n3. Scan the PsList in search of the EPROCESS of SYSTEM by looking for a PID of 4, or a\n\nname of `SYS* .`\n4. Extract the token and place it in the matching offset in the target process.\n5. Cautiously update the reference count of SYSTEM’s token.\n\n**Figure 8: Volodya exploit using an Arbitrary-Read primitive in search for** `SYS*, as can be`\nseen in Cutter.\n\nThis technique requires the offset to both the primary token and the `LIST_ENTRY for the`\nPsList, pretty much mandating that they are both stored as part of a version-specific\nconfiguration.\n\n\n-----\n\nThe major advantage of this technique is that while it can still be executed as a simple\nshellcode in kernel-mode (as done in the exploit of CVE-2017-0263), it can also be\nimplemented completely in user-mode. To do so, you need two exploit primitives, one for an\nArbitrary-Read (from kernel-space) and the other for an Arbitrary-Write (into kernel-space).\nRunning in user-mode solves the issues we detailed before in regards to SMEP, rendering\nthis protection useless against such exploit primitives.\n\nAs the token is a reference-counted object, it is important to properly register the reference\nthat was just added so as to avoid a Blue-Screen-Of-Death (BSOD) when the elevated\nprocess terminates. In fact, there are two different reference counts:\n\nThe token is an `EX_FAST_REF object – the lower pointer bits are used as a ref-count.`\nAn `OBJECT_HEADER is stored before the token, holding yet another ref-count.`\n\nAs out actor chose to update the latter ref-count field, the following steps will be needed:\n\n1. Mask out the ref-count bits from the token’s pointer – should be aligned to 8 bytes on\n\n32-bit processes, and 16 bytes on 64-bit processes.\n2. Subtract the constant needed in order to point at `OBJECT_HEADER ’s ref-count field.`\n3. Read the value (using an Arbitrary-Read exploit primitive).\n4. Increment it accordingly.\n5. Write back the updated value.\n\nHowever, as can be seen in Figure 9, we found the following bug in all of the 32-bit exploits\nthat contained this feature:\n\n**Figure 9: An implementation bug in the reference-count update used in 32-bit exploits.**\n\n\n-----\n\nThe alignment mask when reading the reference-count value is an alignment to 8 bytes,\nwhile a different mask is used when writing back the updated value. If the token will be\nstored in a memory address that is aligned to 8 bytes and is not aligned to 16 bytes, the write\noperation will update the wrong field.\n\nWhile CVE-2016-0040 and CVE-2016-0167 use the Ps* technique, scanning the PsList is\nby-far our actor’s favorite way of performing a token swap, used in 8 of their exploits. In 7 of\nthese, they used Arbitrary-Read and Arbitrary-Write from user-mode.\n\n**Comparison to PlayBit: In all of their samples, we’ve always seen PlayBit use the Ps***\nfunctions for a token swap. This decision forced the actor to implement a few SMEP\nbypasses they integrated into their later exploits for CVE-2016-7255 and CVE-2018-8453.\nThis design choice explains why the actor doesn’t bother implementing a proper ArbitraryRead primitive as part of the exploit. Instead of using a version-specific configuration for the\noffset of the token in the EPROCESS, PlayBit always scans the EPROCESS to search for it,\nusually using 0x300 or 0x600 as the upper limit for the search.\n\nIt is worth noting that the memory corruption technique that is used by PlayBit in the different\nexploits was also used by Duqu 2.0 and was analyzed in Microsoft’s previous VB talk from\n2015. Through this memory corruption, they can trigger a few memory read/writes from/to\nKernel memory that will help during the exploit.\n\n**Figure 10: PlayBit exploit scanning the EPROCESS in search for the token, as can be seen**\nin Cutter.\n\n### Wrapping it up\n\n\n-----\n\nWhile there are additional aspects we could discuss such as different syscalls that each actor\nprefers to use during the exploitation process, naming conventions for created objects like\nWindows and ScrollBars, we believe that the list above clearly demonstrates the\nefficiency/validity of our approach. As can be seen from the list above, almost every aspect in\nan exploit can be implemented in several different ways. Still, both of our actors were very\nconsistent in their respective exploitation routines, each sticking to their favorite way.\n\n## The Customers\n\nDuring our entire research process, we wanted to focus on the exploit authors themselves,\nwhether Volodya, PlayBit or others. And yet, we think that there is also much to learn by\nlooking at these exploit authors’ clientele. The list of Volodya’s clients is diverse and includes\nbanker trojan authors such as Ursnif, ransomware authors such as GandCrab, Cerber and\nMagniber, and APT groups such as Turla, APT28 and Buhtrap (which started from cybercrime and later shifted to cyber-espionage). Interestingly, we can see that Volodya’s 0-days\nare more likely to be sold to APT groups while 1-days are purchased by multiple crimeware\ngroups. Without further intel, we can only assume that once a 0-day is detected by the\nsecurity industry, the exploit is then recycled and sold at a lower price as a non-exclusive 1day.\n\nThe APT customers, Turla, APT28, and Buhtrap, are all commonly attributed to Russia and it\nis interesting to find that even these advanced groups purchase exploits instead of\ndeveloping them in-house. This is another point which further strengthens our hypothesis\nthat the written exploits can be treated as a separate and distinct part of the malware.\n\nThe following table summarizes and shows the CVEs we were able to attribute to Volodya,\nas well as the customers or the malware groups we found using these exploits. CVEs that\nare marked with blue are 0-days, and naturally more expensive. The highlighted groups on\nthe left are considered APTs.\n\n\n-----\n\n**Figure 11: Volodya s customers and the CVEs that were used by them.**\n\n## They grow up so fast\n\nBefore reviewing different trends we noted while examining the exploit samples over a period\nof time, we should emphasize that we have limited visibility as we can’t discuss 0-Days that\nweren’t caught yet. In addition, we can only attempt to date samples to the period before\nthey were caught, but the sad truth is that we are usually pretty much bound to the date in\nwhich the exploit was actually first seen in the wild. Moreover, it is important for us to mention\nthat it was clear from the start that Volodya was already quite professional when developing\nthe first exploit we were able to attribute to them – CVE-2015-2546. For example, it had a\nunique Arbitrary-Write primitive that we couldn’t trace to any other exploit tutorial / exploit.\n\nDuring the analysis of the exploits, as well as the analysis of dozens of malware samples we\ncollected, we noticed an interesting shift. While the earlier Volodya exploits were sold as\nsource code to be embedded in the malware, the later exploits were sold as an external\nutility that accepts a certain API. This change can suggest that Volodya is taking more\nprecautions.\n\nDuring the time between 2015 and 2019, we also noticed significant improvements in\nVolodya’s technical skills. As they got better and more experienced, Volodya started using\nmore effective Arbitrary Read and Write primitives and they even fixed a bug in these\nprimitives between\n\nCVE-2015-2546 and CVE-2016-0165*. Moreover, the code of the exploits became more\nmodular, as large functions were split into smaller sub-routines. Also, their technique to\nsearch and access specific offsets in various structs was also improved and in recent\nimplementations it became more dynamic and safe, as it better-handled changes in minor\nversions of Windows.\n\nNot only does this show the learning curve and development of our actor, but it also hints at\ntheir skills. The ability to find and reliably exploit Windows Kernel vulnerabilities is really not\nthat straightforward. We can see in comparison that PlayBit was pretty much very active in\nthis market between the years 2015-2018, and their focus was on selling exploits for 1-Day\nvulnerabilities, one of which was a 0-Day of Volodya (CVE-2016-7255).\n\n## Conclusion\n\nOur research methodology was to fingerprint an exploit writer’s characteristics and later on\nuse these properties as a unique hunting signature. We deployed this technique twice when\ntracking down Volodya’s exploits and those of PlayBit. Having these two successful test\ncases, we believe that this research methodology can be used to identify additional exploit\nwriters. We recommend other researchers try our suggested technique and adopt it as an\nadditional tool in their arsenal.\n\n\n-----\n\nDuring this research, we focused on the exploits that are used by or embedded in different\nmalware families, both in APT attacks and in commodity malware (especially ransomware).\nAlthough they are widespread, we often found detailed malware reports that neglected to\nmention that the malware at hand also uses an exploit for escalating its privilege.\n\nThe fact that we were able to use our technique, repeatedly, to track 16 Windows LPE\nexploits, written and sold by two different actors, was very surprising. Considering that 15 of\nthem date to the timeframe of 2015-2019, it is plausible to assume that they constitute a\nsignificant share of the exploitation market, specifically for Windows LPE exploits.\n\nFinally, it is impossible to tell the overall number of Windows kernel 0-day vulnerabilities that\nare being actively exploited in the wild. Nation-state actors are less likely to get caught and\nthus the infosec community does not have clear visibility to their ammo crate. That said, we\ncan still get insights by looking at the exploits that were caught, while remembering this\nsurvivorship bias. Last year, Kaspersky [reported a single actor who distributed an exploit](https://www.youtube.com/watch?v=UixFnBdIEzY)\nframework that includes 3 more 0-Days. Adding up these numbers, we see that 8 out of 15\nzero-day exploits, more than half of the “market-share”, are attributed to only two actors(!).\nThis means that our research technique could potentially be used to track down many of the\nactors in the seen market, if not all of them.\n\n## Recommendation for Protection\n\nCheck Point [Threat Emulation provides protection against this threat:](https://www.checkpoint.com/products/threat-emulation-sandboxing/)\n\nTrojan.Wins.Generic.F\nTrojan.Wins.Generic.G\n\n## Appendix – IOC Table\n\n### Volodya\n\n**CVE-2015-2546: 3f6fe68981157bf3e267148ec4abf801a0983f4cea64d1aaf50fecc97ae590d3**\n\n**CVE-2016-0040:**\n0ea43ba3e1907d1b5655a665b54ad5295a93bda660146cf7c8c302b74ab573e9\n**CVE-2016-0165*:**\nf1842080b38b3b990ba3ccc1d55ceedd901d423b6b8625633e1885f0dadee4c2\n\n**CVE-2016-0167:**\n6224efee6665118fe4b5bfbc0c4b1dbe611a43a4b385f61ae33b0a0af230da4e\n\n**CVE-2016-7255:**\na785ad170a38280fc595dcc5af0842bd7cabc77b86deb510aa6ebb264bf2c092\n\n**CVE-2017-0001:**\ned7532c77d2e5cf559a23a355e62d26c7a036f2c51b1dd669745a9a577f831a0\n\n**CVE-2017-0263:**\n\n\n-----\n\nf9dca02aa877ad36f05df1ebb16563c9dd07639a038b9840879be4499f840a10\n**CVE-2018-8641*:**\n0829f90a94aea5f7a56d6ebf0295e3d48b1dffcfefe91c7b2231a7108fe69c5e\n**CVE-2019-0859 – Initial 64bit sample:**\n895ab681351439ee4281690df21c4a47bdeb6691b9b828fdf8c8fed3f45202d8\n**CVE-2019-0859 – Matching 32bit sample:**\neea10d513ae0c33248484105355a25f80dc9b4f1cfd9e735e447a6f7fd52b569\n**CVE-2019-1458:**\n8af2cf1a254b1dafe9e15027687b0315493877524c089403d3ffffa950389a30\n\n### PlayBit\n\n**CVE-2013-3660:**\n9f1a235eb38291cef296829be4b4d03618cd21e0b4f343f75a460c31a0ad62d3\n\n**CVE-2015-0057:**\n8869e0df9b5f4a894216c76aa5689686395c16296761716abece00a0b4234d87\n\n**CVE-2015-1701 (yes, it is the same sample as CVE-2015-0057):**\n8869e0df9b5f4a894216c76aa5689686395c16296761716abece00a0b4234d87\n\n**CVE-2016-7255:**\n5c27e05b788ba3b997a70df674d410322c3fa5e97079a7bf3aec369a0d397164\n\n**CVE-2018-8453:**\n50da0183466a9852590de0d9e58bbe64f22ff8fc20a9ccc68ed0e50b367d7043\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-02 - Graphology of an Exploit – Hunting for exploits by looking for the author’s fingerprints.pdf"
    ],
    "report_names": [
        "2020-10-02 - Graphology of an Exploit – Hunting for exploits by looking for the author’s fingerprints.pdf"
    ],
    "threat_actors": [
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2008a79d-2f3a-475f-abef-3bc119a1bf38",
            "created_at": "2022-10-25T16:07:24.028651Z",
            "updated_at": "2025-03-27T02:02:10.084983Z",
            "deleted_at": null,
            "main_name": "Operation WizardOpium",
            "aliases": [],
            "source_name": "ETDA:Operation WizardOpium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5cd3fcb0-eb56-49ac-8125-47ebee93311d",
            "created_at": "2023-01-06T13:46:39.065814Z",
            "updated_at": "2025-03-27T02:00:02.988828Z",
            "deleted_at": null,
            "main_name": "Operation WizardOpium",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation WizardOpium",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535925,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653692117,
    "ts_modification_date": 1653692117,
    "files": {
        "pdf": "https://archive.orkl.eu/cdfed0c8abf707b13738bb4b61514374fc330147.pdf",
        "text": "https://archive.orkl.eu/cdfed0c8abf707b13738bb4b61514374fc330147.txt",
        "img": "https://archive.orkl.eu/cdfed0c8abf707b13738bb4b61514374fc330147.jpg"
    }
}