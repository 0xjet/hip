{
    "id": "3f445ae0-bedc-4a5b-93d7-681a65581f70",
    "created_at": "2023-01-12T15:08:55.15948Z",
    "updated_at": "2025-03-27T02:05:21.243024Z",
    "deleted_at": null,
    "sha1_hash": "a39debf89b02695c3e5a5edde3bc234ab9ac86ec",
    "title": "2018-06-23 - Malware Analysis- Kardon Loader",
    "authors": "",
    "file_creation_date": "2022-05-28T23:35:45Z",
    "file_modification_date": "2022-05-28T23:35:45Z",
    "file_size": 608356,
    "plain_text": "# Malware Analysis: Kardon Loader\n\n**[engineering.salesforce.com/kardon-loader-malware-analysis-adaaaab42bab](https://engineering.salesforce.com/kardon-loader-malware-analysis-adaaaab42bab)**\n\nVishal Thakur July 13, 2021\n\n[Vishal Thakur](https://malienist.medium.com/?source=post_page-----adaaaab42bab--------------------------------)\n[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbacf5a190f41&operation=register&redirect=https%3A%2F%2Fengineering.salesforce.com%2Fkardon-loader-malware-analysis-adaaaab42bab&user=Vishal+Thakur&userId=bacf5a190f41&source=post_page-bacf5a190f41----adaaaab42bab---------------------follow_byline-----------)\nJun 22, 2018\n\n\n4 min read\n\nKardon is a new malware that has just hit the market. At this moment, the developers are\nadvertising it as a new Trojan Downloader — which has the capabilities of delivering and\nexecuting any payload that the actor wants to use in a campaign. The malware is fully\nfunctional and is ready to be deployed with custom or commodity malware.\n\nLet’s take a look at its binary and analyze it to extract some usable IOC but mostly the\nexecution flow, as this malware is still in development.\n\n## Quick Analysis\n\nFirst of all, let’s take a quick look at the PE and list some of the basic information about the\nmalware.\n\nAs we can see from the image below, the PE is a VC++ build. Quite small in size, which sets\nit apart from most of the loaders available on the market today (which could change as it is\nfine-tuned and functionality is added to it in the future).\n\nThe PE is a VC++ build and quite small in size\nFollowing is the list of OS versions this malware runs on:\n\n\n-----\n\nNow, let s take a quick look (statically) at the DLLs that this malware loads on execution:\n\nTo dig out more interesting DLLs, let’s start the dynamic analysis of this malware. Once\nlaunched and suspended, we look into the memory and see that some more interesting DLLs\n(Anti-VM and Anti-AV) have now been launched. Take a look at the image below:\n\n\n-----\n\nAnt-VM and Anti-AV functions listed from the memory\nWe can also see more Anti-VM features in the code as we dig deeper:\n\nThese strings are passed into the memory for Virtual Machine detection. As we can see,\nmost of the common platforms have been taken into account.\n\nLet’s have a look at the execution now. We start with looking into the CPU.\n\nCPU view\nAnd then the values are passed on to the stack as variables.\n\nStack view\n\n\n-----\n\nThe malware has a list of common AV and VM DLLs that it checks for — if they re loaded or\nnot. This is to detect the AV running on the machine or if the machine is a VM — which can\nthen be used to alter the execution flow as required. Let’s have a look at the CPU and the\nDisassembler to see how this looks like in execution and code.\n\nCPU view of the DLL list\n\nCode showing the list of DLLs\n\n## Network IOC\n\nAt this time, what would end up being the URI for the final payload (malware to be distributed\nby this loader) can be seen hardcoded into the loader itself. We can have a look at the\nstrings output and see it. We will also have a look at the disassembler output and also in the\ndebugger to show different ways of looking up the URI.\n\nProcess Strings\n\n\n-----\n\nDisassembler view\n\nCPU view of the URI ready to go into the stack\nSo, as seen above, this is the URI that is supposed to serve the final payload for download,\nexecution and infection:\n\nkardon.ddns[.]net/kardon/gate.php\n\nThere are different URIs found on different samples of this malware at this time, which will\nchange as it goes into distribution and the URIs start serving active (live) payloads.\n\nLet’s also quickly take a look at the POST request (which is likely to remain the same for the\nnext version).\n\nCPU view of the POST request\nLastly, we can also see some features where the malware extracts information about the\nmachine and it looks like this information will be posted back to the admin once this malware\nis in distribution.\n\n\n-----\n\nAnd here we can see the function that will be used to download the payload ultimately.\n\n## Conclusion\n\nKardon is a new loader that is being marketed for sale at this time. We will surely see it being\nused in active campaigns soon, with more features enabled/added and downloading\nsecondary payloads for further infection of the victim machines.\n\nKardon is a basic, simple and lightweight Loader Malware. We will keep an eye on this\nmalware and see how it evolves and progresses in the future.\n\nSample used for this analysis:\n\nhttps://www.virustotal.com/#/file/fd0dfb173aff74429c6fed55608ee99a24e28f64ae600945e15\nbf5fce6406aee/detection\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-06-23 - Malware Analysis- Kardon Loader.pdf"
    ],
    "report_names": [
        "2018-06-23 - Malware Analysis- Kardon Loader.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536135,
    "ts_updated_at": 1743041121,
    "ts_creation_date": 1653780945,
    "ts_modification_date": 1653780945,
    "files": {
        "pdf": "https://archive.orkl.eu/a39debf89b02695c3e5a5edde3bc234ab9ac86ec.pdf",
        "text": "https://archive.orkl.eu/a39debf89b02695c3e5a5edde3bc234ab9ac86ec.txt",
        "img": "https://archive.orkl.eu/a39debf89b02695c3e5a5edde3bc234ab9ac86ec.jpg"
    }
}