{
    "id": "a86c36cc-6a70-4a69-81db-99cbeb4a37dd",
    "created_at": "2023-01-12T15:08:05.532629Z",
    "updated_at": "2025-03-27T02:10:03.243844Z",
    "deleted_at": null,
    "sha1_hash": "96abfb31482a7d5a2d4a420543c0977d27e7b59b",
    "title": "2016-04-08 - CryptoHost Decrypted Locks files in a password protected RAR File",
    "authors": "",
    "file_creation_date": "2022-05-25T14:42:18Z",
    "file_modification_date": "2022-05-25T14:42:18Z",
    "file_size": 603107,
    "plain_text": "# CryptoHost Decrypted: Locks files in a password protected RAR File\n\n**[bleepingcomputer.com/news/security/cryptohost-decrypted-locks-files-in-a-password-protected-rar-file](https://www.bleepingcomputer.com/news/security/cryptohost-decrypted-locks-files-in-a-password-protected-rar-file/)**\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nApril 8, 2016\n01:52 PM\n13\n\n[A new ransomware called CryptoHost was discovered by security researcher Jack that states that it](https://twitter.com/intent/user?screen_name=malwareforme)\nencrypts your data and then demands a ransom of .33 bitcoins or approximately 140 USD to get\nyour files back. In reality, though, your data is not encrypted, but rather copied into a password\nprotected RAR archive . Thankfully, the password created by this infection is easily discovered so\ninfected users can get their files back. This infection is currently being detected\nas Ransom:MSIL/Manamecrypt.A and Ransom_CRYPTOHOST.A.\n\n[I would also like to thank Michael Gillespie and MalwareHunterTeam for their additional analysis.](https://twitter.com/demonslay335)\n\n**The CryptoHost Ransomware**\n\n## How to Decrypt or get your data back from the CryptoHost Ransomware\n\n\n-----\n\nNormally I would not disclose a vulnerability in a ransomware as it will just lead to the developer\nfixing it in a future version. Unfortunately, a certain site who will not be named, irresponsibly\nrevealed the method that can be used to decrypt these files, so the secret is already out.\n\nWhen CryptoHost infects your computer it will move certain data files, which is detailed in the\ntechnical analysis below, into a password protected RAR archive located in the C:\\Users\\\n\n[username]\\AppData\\Roaming folder. This file will have a 41 character name and no extension.\nAn example file is 3854DE6500C05ADAA539579617EA3725BAAE2C57. The password for\nthis archive is the name of the archive combined with the logged in user name. So for example, if the\nname of the user is Test and the RAR archive is located\nat C:\\Users\\Test\\AppData\\Roaming\\3854DE6500C05ADAA539579617EA3725BAAE2C57,\nthe password would be 3854DE6500C05ADAA539579617EA3725BAAE2C57Test.\n\nFor those who do not want to deal with figuring out the password, you can use this password\n[generator created by Michael Gillespie.](https://twitter.com/demonslay335)\n\nBefore we begin, we want to first terminate the cryptohost.exe process. To do this, open the Start\n**Menu and type Task Manager. When the Task Manager search results appears, click on it to start**\nthe program. Now click on the Processes tab and select the cryptohost.exe process as shown\nbelow. Then click on the End Process button to terminate it.\n\n**End the Cryptohost.exe Process**\n\nNow to to extract the password protected RAR archive with your files in it, we first need to install\n[the 7-Zip application. Once it is installed, open up the C:\\Users\\](http://www.7-zip.org/)\n\n**[username]\\AppData\\Roaming folder and locate the archive file using the info described**\n\n\n-----\n\nabove. Now right-click on it and then select the Extract to foldername option as shown in the\nimage below.\n\n**Extraction Wizard**\n\nWhen the 7-Zip prompts you for the password, enter the password as described above and press\nenter. You data will now be extracted into a folder name that is the same name as the RAR archive.\nWhen done, open that folder and copy all of the folders in it to the root of your C: drive. Your data\nfiles should now be restored.\n\n## How to remove the CryptoHost Ransomware\n\nWhen CryptoHost is installed it will create a file called cryptohost.exe and store it in the C:\\Users\\\n\n[username]\\AppData\\Roaming folder. It will alsocreate an autorun called software that executes\nthe ransomware on login. To remove this infection, simply end the cryptohost.exe process using\nTask Manager and then delete the cryptohost.exe file. To remove the autorun you can delete this\nregistry key:\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\software %AppData%\\cryptohost.exe\n\n```\nMost security products should detect this infection at this point and remove it automatically if you\ndo not wish to remove CryptoHost manually.\n\n## CryptoHost Ransomware Technical Analysis\n\nCryptoHost is currently being bundled with a uTorrent installer that when installed extracts the\n**cryptohost.exe to the %AppData% folder and executes it. Once executed, CryptoHost will move**\nall files that match certain extensions into a password protected RAR archive located in the\n\n\n-----\n\n%AppData% folder. The name of the archive will be a SHA1 hash of the following information with\nany dashes removed.\n```\nprocessorId + volume_serial_number_of_c: + motherboard_serial_number\n\n```\nThe password for this archive will be in the form of the SHA1 hash+username. So if the SHA1\nhash is 3854DE6500C05ADAA539579617EA3725BAAE2C57 and the user is Test the\npassword would be 3854DE6500C05ADAA539579617EA3725BAAE2C57Test.\n\nThe file extensions that will be moved into the password protected archive by CryptoHost are:\n```\njpg, jpeg, png, gif, psd, ppd, tiff, flv, avi, mov, qt, wmv, rm, asf, mp4, mpg, mpeg, m4v,\n3gp, 3g2, pdf, docx, pptx, doc, 7z, zip, txt, ppt, pps, wpd, wps, xlr, xls, xlsl\n\n```\nWhen the archive is finished being created, the ransomware will then perform a listing of the files in\nthe archive and save that list to the %AppData%\\Files file. CryptoHost will now display\nthe ransomware screen as shown below.\n\n**CryptoHost Ransomware Screen**\n\nThis screen is broken up into four subscreens that allow you to get various information about the\ninfection and to list the affected data files. Below are two of these screens.\n\n\n-----\n\n**How it Works Screen**\n\n**Check Payment Screen**\n\nWhen a victim wants to decrypt their files, they need to click the Check Payment Status button,\nwhich simply checks blockchain.info for any payments to the assigned bitcoin address. If the text\nreturned by the blockchain query contains the exact numbers listed in the Fee label of the\nCryptoHost interface, then the ransomware will extract your files. This means that a victim has to\npay the exact amount and if more is paid, the ransomware will still not decrypt the files.\n\nWhen first started CryptoHost will also try to delete the\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot key in order to make it impossible to boot\ninto safe mode. Thankfully, this process does not run under the required privileges that are\nnecessary to remove this key.\n\nCryptoHost will also monitor process names and Window titles for certain strings. If these strings\nare detected the associated process will be terminated. In my tests this method only worked on\nprocess names and not Window titles. The list of strings that it searches for are:\n\n\n-----\n\n```\nanti virus, anti virus, antivirus, avg, bitdefender, eset, mcafee, dr.web, f secure,\ninternet security, obfuscator, debugger, monitor, registry, system restore, kaspersky,\nnorton, ad-aware, sophos, comodo, avira, bullguard, trend micro, eset, vipre, task manager,\nsystem configuration, registry editor, game, steam, lol, rune, facebook, instagram, youtube,\nvimeo, twitter, pinterest, tumblr, meetme, netflix, amazon, ebay, shop, origin\n\n```\nIt is interesting to note that the dev not only targets security products, but also common sites and\nprocesses that a victim may want to visit or use for games. This is done to further aggravate the\nvictim into paying the ransom.\n\nLast, but not least, this ransomware does not communicate with the malware developer in any way\nand the only network communications is when it checks the blockchain.info site for payment.\n\n## Files associated with the CryptoHost Ransomware:\n```\n%Temp%\\uTorrent.exeuTorrent.exe\n%AppData%\\cryptohost.exe\n%AppData%\\files\n%AppData%\\processor.exe\n\n### Registry entries associated with the CryptoHost Ransomware:\nHKCU\\Software\\Classes\\FalconBetaAccount\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\software %AppData%\\cryptohost.exe\n\n Related Articles:\n\n```\n[Indian airline SpiceJet's flights impacted by ransomware attack](https://www.bleepingcomputer.com/news/security/indian-airline-spicejets-flights-impacted-by-ransomware-attack/)\n\n[US Senate: Govt’s ransomware fight hindered by limited reporting](https://www.bleepingcomputer.com/news/security/us-senate-govt-s-ransomware-fight-hindered-by-limited-reporting/)\n\n[New RansomHouse group sets up extortion market, adds first victims](https://www.bleepingcomputer.com/news/security/new-ransomhouse-group-sets-up-extortion-market-adds-first-victims/)\n\n[Ransomware attack exposes data of 500,000 Chicago students](https://www.bleepingcomputer.com/news/security/ransomware-attack-exposes-data-of-500-000-chicago-students/)\n\n[The Week in Ransomware - May 20th 2022 - Another one bites the dust](https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-may-20th-2022-another-one-bites-the-dust/)\n\n[CryptoHost](https://www.bleepingcomputer.com/tag/cryptohost/)\n[Decrypted](https://www.bleepingcomputer.com/tag/decrypted/)\n[Manamecrypt](https://www.bleepingcomputer.com/tag/manamecrypt/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's area of\nexpertise includes Windows, malware removal, and computer forensics. Lawrence Abrams is a coauthor of the Winternals Defragmentation, Recovery, and Administration Field Guide and the\ntechnical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/offer/deals/90-percent-off-a-complete-c-coding-bootcamp/)\n[Next Article](https://www.bleepingcomputer.com/news/security/petya-ransomwares-encryption-defeated-and-password-generator-released/)\n\n### Comments\n\n\n-----\n\n[Demonslay335 - 6 years ago](https://www.bleepingcomputer.com/forums/u/726225/demonslay335/)\n\nAlso as a note to potential victims, do NOT CLOSE the program by trying to simply \"X\" it out.\nIt will prompt you if you really wish to lose your data, and if you continue, it will try to delete\nthe entire RAR file. This is why it is recommended to kill it from Task Manager. If this does\noccur, however, you may be able to use \"undelete\" software such as Recuva to recover the\narchive, as it does not do a secure wipe of the file.\n\n[Lawrence Abrams - 6 years ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nI left that out as I do not think its active in the build. There is no close button.\n\n[Demonslay335 - 6 years ago](https://www.bleepingcomputer.com/forums/u/726225/demonslay335/)\n\nAh, gotcha. I see it now when I double-checked the source. There is indeed a button with the\ntext \"Remove This Software and Delete All Locked Files\" that triggers the delete. It is not\nvisible and is disabled. Supposed to show with the other buttons I believe.\n\n\n-----\n\n[ScathEnfys - 6 years ago](https://www.bleepingcomputer.com/forums/u/983120/scathenfys/)\n\n\"CryptoHost is currently being bundled with a uTorrent installer...\"\nYet another reason not to use μTorrent or other p2p software\n\n[Lawrence Abrams - 6 years ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nIts not a legit utorrent installer from the company themselves.\n\n[ScathEnfys - 6 years ago](https://www.bleepingcomputer.com/forums/u/983120/scathenfys/)\n\nI understand that. But the people who use p2p programs are also more likely to use alternative\ndownload sites.\n\n\n-----\n\n[ScathEnfys - 6 years ago](https://www.bleepingcomputer.com/forums/u/983120/scathenfys/)\n\nThis RW screams \"skiddie\" all over... the cheesy password protected RARFile rather than a\nreal encryption method, the easy to find password, and the \"meh\" graphics.\n\n[Curie - 6 years ago](https://www.bleepingcomputer.com/forums/u/976061/curie/)\n\nAh, I had hoped to tell you something new, but you got lots of people helping out already. :)\n\n[peterracine - 6 years ago](https://www.bleepingcomputer.com/forums/u/943000/peterracine/)\n\nThese scripts are sold to script kiddies and that is why they sometimes are easily decripted or\nsometimes do not make any sense. Its the authors that we should somehow go after. we will\neventually win so, don't worry.\n\n[AaroniusLeonius - 6 years ago](https://www.bleepingcomputer.com/forums/u/999237/aaroniusleonius/)\n\nScript Kiddies. \"Oh no! my files have been archived in a RAR file that is protected with an easy\nto find password. What am I going to do?\" Also, why aren't they actually encrypting files?\nArchiving them isn't encrypting them but the creator clearly doesn't know that.\n\n\n-----\n\n[Demonslay335 - 6 years ago](https://www.bleepingcomputer.com/forums/u/726225/demonslay335/)\n\nWinRAR actually technically uses AES encryption on the final compressed stream when you\nuse a password. The password is stored as a protected hash (I think it's SHA1) in the file. If the\npassword is securely generated, it is actually a fairly secure \"encryption\" since the RAR format\nimplements it properly (WinZIP formats are a bit easier to crack).\n\n[AaroniusLeonius - 6 years ago](https://www.bleepingcomputer.com/forums/u/999237/aaroniusleonius/)\n\nWow. I did not know that. You learn new things every day. Thanks.\n\n[sometri - 2 years ago](https://www.bleepingcomputer.com/forums/u/1133296/sometri/)\n\nhelp me how to recover my files with extension \".format\". thanks.\n\n[Post a Comment Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-04-08 - CryptoHost Decrypted Locks files in a password protected RAR File.pdf"
    ],
    "report_names": [
        "2016-04-08 - CryptoHost Decrypted Locks files in a password protected RAR File.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "921cea27-4410-42e4-8c11-7d40ba313225",
            "created_at": "2023-01-06T13:46:39.375789Z",
            "updated_at": "2025-03-27T02:00:03.067286Z",
            "deleted_at": null,
            "main_name": "RansomHouse",
            "aliases": [],
            "source_name": "MISPGALAXY:RansomHouse",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536085,
    "ts_updated_at": 1743041403,
    "ts_creation_date": 1653489738,
    "ts_modification_date": 1653489738,
    "files": {
        "pdf": "https://archive.orkl.eu/96abfb31482a7d5a2d4a420543c0977d27e7b59b.pdf",
        "text": "https://archive.orkl.eu/96abfb31482a7d5a2d4a420543c0977d27e7b59b.txt",
        "img": "https://archive.orkl.eu/96abfb31482a7d5a2d4a420543c0977d27e7b59b.jpg"
    }
}