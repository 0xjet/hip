{
    "id": "c191576a-2829-4fd3-9e06-d34390fac314",
    "created_at": "2022-10-25T16:48:16.223643Z",
    "updated_at": "2025-03-27T02:09:30.887035Z",
    "deleted_at": null,
    "sha1_hash": "1cd7c6502a22702e4e05e1708ce2662534cb3e32",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-08-11T14:55:40Z",
    "file_modification_date": "2016-08-11T14:55:40Z",
    "file_size": 2350846,
    "plain_text": "[Blog Home](http://researchcenter.paloaltonetworks.com/)\n[Applipedia](http://applipedia.paloaltonetworks.com/)\n[Threat Vault](http://researchcenter.paloaltonetworks.com/threat-vault/)\n[Reports](https://www.paloaltonetworks.com/resources/research.html)\n[Tools](http://researchcenter.paloaltonetworks.com/tools/)\nEnglish\n1.866.320.4788\n[Support](https://support.paloaltonetworks.com/)\n[Resources](https://www.paloaltonetworks.com/resources.html)\n[Research](http://researchcenter.paloaltonetworks.com/)\n\nSearch Search\n\n#### 70\n\n**Like**\n\n[Tweet](https://twitter.com/intent/tweet?original_referer=http%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2016%2F01%2Fnettraveler-spear-phishing-email-targets-diplomat-of-uzbekistan%2F&ref_src=twsrc%5Etfw&text=NetTraveler%20Spear-Phishing%20Email%20Targets%20Diplomat%20of%20Uzbekistan&tw_p=tweetbutton&url=http%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2016%2F01%2Fnettraveler-spear-phishing-email-targets-diplomat-of-uzbekistan%2F&via=PaloAltoNtwks)\n\n### 2\n\n# NetTraveler Spear­Phishing Email Targets Diplomat of Uzbekistan\n[posted by: Vicky Ray and Robert Falcone on January 21, 2016 8:45 AM](http://researchcenter.paloaltonetworks.com/author/vicky-khan/)\n[filed in: Malware, Threat Prevention, Unit 42](http://researchcenter.paloaltonetworks.com/malware-2/)\n[tagged: AutoFocus, NetTraveler, spearphishing, Trojan, Ufa, Ufe, Uzbekistan, WildFire](http://researchcenter.paloaltonetworks.com/tag/autofocus/)\nUnit 42 recently identified a targeted attack against an individual working for the Foreign Ministry of Uzbekistan in China. A spear­\nphishing email was sent to a diplomat of the Embassy of Uzbekistan who is likely based in Beijing, China. In this report, we’ll review\nhow the actors attempted to exploit CVE­2012­0158 to install the NetTraveler Trojan.\nOn December 12, 2015, a spear­phishing email was sent to a diplomat of the Embassy of Uzbekistan. The body and subject of the\nemail suggests that the email was spoofed to look like it was sent by the Russian Foreign Ministry and the attachment may contain an\n[official annual report on CHS (Council of Heads of Member States), who form the SCO (Shanghai Cooperation Organization).](https://en.wikipedia.org/wiki/Shanghai_Cooperation_Organisation)\n_Filename: “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” (translated to: “2015.12.11_sroki CHS in 2015 Ufe.doc.doc”)_\n_Body: “С уважением, ДАТС МИД России” (translated to: “Yours faithfully, ACSD Russian Foreign Ministry”)_\n[It is interesting to note the reference of Ufa in the file name, as the city of Ufa in Russia hosted the SCO BRICS Summit on July 9 and](http://ufa2015.com/)\n10, 2015. SCO and BRICS (Brazil, Russia, India, China and South Africa) are intergovernmental international organizations focused on\nissues of regional security and economic cooperation.\n\n_Figure 1 Leaders of member nations at the 2015 Summit in Ufa_\n### TARGETING AND MALWARE ANALYSIS\nOur analysis shows that actors attempted to exploit CVE­2012­0158 to install NetTraveler Trojan.\n\n\n-----\n\n_Figure 2 Email containing the malicious attachment_\nThe malicious attachment “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” is a malicious document created by the MNKit toolkit and\nexploits CVE­2012­0158.\n[Upon successful exploitation, the attachment will install the trojan known as NetTraveler using a DLL side­loading attack technique.](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-dll-sideloading.pdf)\n[The NetTraveler trojan has been known to be used in targeted cyber espionage attacks for more than a decade by nation state threat](http://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/kaspersky-the-net-traveler-part1-final.pdf)\nactors and continues to be used to target its victims and exfiltrate data.\nThe DLL side­loading attack technique has been gaining adoption within the cyber espionage realm by threat actors to bypass\n[traditional security systems. Unit 42 also published a blog last year discussing an unrelated attack where the DLL side­loading](http://researchcenter.paloaltonetworks.com/2015/05/plugx-uses-legitimate-samsung-application-for-dll-side-loading/)\ntechnique was used.\nFigure 3 illustrates the exploitation and the infection flow of the malware.\n\n\n-----\n\n_Figure 3 Overview of the infection flow_\nThe document “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” exploits CVE­2012­0158 to drop a decoy file “~$.doc” and the actual\npayload “DW20.exe”. The decoy is a blank document with the meta data stripped.\nThe payload (DW20.exe) is a self­extracting (SFX) RAR archive that contains the following files:\n_RasTls.exe_\n_rastls.dll_\n_Sycmentec.config_\n\n\n-----\n\n_Figure 4 The payload(DW20.exe) is a SFX RAR archive_\nThe SFX RAR uses the following configuration to launch the embedded executable, which is a legitimate application created by\nSymantec that will side load the rastls.dll DLL:\n_Setup=RasTls.exe_\n_TempMode_\n_Silent=1_\n_Overwrite=1_\nThe figure below shows that the config file, ‘Sycmentec.config’ is encrypted.\nThe ‘Sycmentec.config’ file can be decrypted using a single byte XOR algorithm using ‘0x77’ as a key.\n\n_Figure 5 Encrypted ‘Sycmentec.config’file_\nThe ‘rastls.dll’ DLL will load and decrypt this file. The decrypted data starts with shellcode that is responsible for loading an embedded\nDLL and executing it.\nFigure 6 shows the decrypted ‘Sycmentec.config’file containing an embedded DLL.\n\n\n-----\n\n_Figure 6 Decrypted ‘Sycmentec.config’ file contains an embedded DLL_\nThe embedded DLL is the functional payload, which is a variant of the NetTraveler Trojan that has the following attributes:\n**Size** 52736 bytes\n**Type** PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n**Architecture32 Bits binary**\n**MD5** 3e3df4fe831d87d7f52f14933e464fc3\n**SHA1** cce65a0b67674a313091a947506ceb91d30605ad\n**SHA256** 3b4e4d7a0b1185a45968d90ffe6346f4621116d14dbf88b5138040acc022c757\n**ssdeep** 1536:jxKW1S8mWKFU7U9lYjhjXwVqTvS/G405:wCBmUw9lAhLWqW/G40\n**imphash** 85ce31f87f06b02fec915d33d82958e8\n**Date** 0x564B2B07 [Tue Nov 17 13:26:31 2015 UTC]\n**CRC:** 0x0, (Actual): 0x19be0 [SUSPICIOUS]\n**(Claimed)**\n\n**Packers** Armadillo v1.xx – v2.xx\n**Entry Point 0x1000970b .text 1/5**\n_Table 1 Attributes of the embedded DLL (NetTraveler)_\nThe first execution of this NetTraveler Trojan starts off with an installation process. Like previous versions, this NetTraveler sample\nwrites its configuration to a file, in this case the configuration is written to a file named “config.dat”.\n\n_Figure 7 NetTraveler writes the configuration to ‘config.dat’ file_\nDuring execution, NetTraveler creates a mutex of ‘YOYWOW!657’, as shown in Figure 8 below to avoid running multiple instances of\nits code.\n\n\n-----\n\n_Figure 8 Mutex created for this NetTraveler payload_\nThe code then enumerates the ‘netsvcs’ services, which are services that run within the process space of svchost.exe, specifically\nignoring services named ‘6to4’ and ‘Ias’ as these services have been used by other malware families.\nWhen it finds another netsvcs service with a name not matching these two names, it will delete the file associated with the service and\ncopy the ‘rastls.dll’ file to that folder using ‘<service name>ve.dll’ as the filename as shown in Figure 9 below.\n\n_Figure 9 Code enumerating ‘netsvcs’ services_\n\n\n-----\n\n_Figure 10 Renamed ‘rastls.dll’ DLL_\nThe malware will then change the binary path of the service to point to this new filename and copies the “Sycmentec.config” file to the\nsame folder and the ‘config.dat’ file to the following location:\n_c:\\windows\\system\\CERTAPL.DLL_\nThe NetTraveler payload relies on the ‘rastls.dll’ file to obtain its C2 server. At first glance, the NetTraveler payload appears as if it will\nuse the following URL for its C2 server:\n_http://192.168.3[.]201/downloader2013/asp/downloader.asp_\nHowever, the NetTraveler payload reads the last ‘0xb0’ bytes from the rastls.dll file and uses it to create the “config.dat” file that is later\nsaved to “CERTAPL.DLL”. This technique hides the true C2 server from researchers that do not have access to both the rastls.dll and\nSycmentec.config files.\n\n\n-----\n\n_Figure 11 Code snippet showing NetTraveler obtaining its configuration from rastls.dll._\nThe configuration file is structured as an “.ini” file as the Trojan uses GetPrivateProfileStringA to parse the contents. The configuration\nfile has the following contents:\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n[OOOOOO]\nU00P=r^?<80>}H>?<88><89><8A>B<8B><85>|<86><87><89><91><8B><90><92><88>N<84><91><90>S<94><96><9B><\nK00P=XLMNOPQRSTUVWXYZ[\\]^_`abcdefghiv\nP00D=5\nF00G=True\nMM1=0\nMM6=1\n\n\nUnit 42 analyzed the sample and found the following configuration fields that could appear in the CERTAPL.DLL configuration file and a\nbrief description of each field:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nU00P = C2 URL\nK00P = Key for DES\nP00D = Sleep interval in minutes\nF00G = Boolean to determine if sample should use proxy to communicate with C2 server\nMM1 = 0 or 1 if proxy is configured or not.\nMM3 = Port for configured proxy\nMM4 = Username for configured proxy\nMM5 = Password for configured proxy\nMM6 = 1 if Trojan is installed correctly\n\n\nThe “U00P” and “K00P” values are decrypted using a simple algorithm that subtracts the index and then subtracts ten from each\ncharacter, which is depicted in the following:\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\ndef subtraction_algo(ct):\nout = \"\"\ni = 0\nfor e in ct:\nout += chr(ord(e)-i-10)\ni += 1\nreturn out\n\n\n-----\n\n_U00P: http://www.voennovosti.com/optdet/index.asp (decrypted)_\n_K00P: NAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM (decrypted)_\nThe C2 server will respond to requests issued by the Trojan with commands to carry out activities on the compromised system. We\nanalyzed the code within NetTraveler that handles commands issued by the C2 server and found four available commands that are\nlisted in Table 2.\n**Command** **Description**\n<Unique System ID>:UNINSTALL Deletes\n%APPDATA%\\cert2013.dat and\n%STARTUP%\\consent.lnk and\nexits the process. This attempts to\nuninstall the Trojan, but will not\nwork as the filenames are not\nused by this version of NetTraveler\n<Unique System ID>:RUN_REBOOTReboots the system\n<Unique System Downloads a file to\nID>:RUN_STARTUP %TEMP%\\Temp.bmp and copies it\n\nto the startup folder\n<Unique System ID>:RUN_DIRECT Download a file to\n\n%TEMP%\\tmp.bmp and execute it\n_Table 2 Commands available within NetTraveler and a description of their functionality_\n### INFRASTRUCTURE\nAt the time of analysis, the domain voennovosti[.]com was resolving to IP ‘98.126.38[.]107’, which is hosted by Krypt Technologies. A\n[report published by Kaspersky Labs in 2011 on NetTraveler also mentions the C2 servers were being hosted by Krypt Technolgies.](http://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/kaspersky-the-net-traveler-part1-final.pdf)\nThis web hosting service provider continues to be the hosting provider of choice for the threat actors behind NetTraveler.\n\n_Figure 12 DNS query for voennovosti[.]com resolves to ‘98.126.38.107’_\n\n_Figure 13 Encoded network communications_\n### CONCLUSION\nNetTraveler has been used to target diplomats, embassies and government institutions for over a decade, and remains the tool of\nchoice by the adversaries behind these cyber espionage campaigns. The use of NetTraveler for such a long period of time shows its\n\n\n-----\n\ntraditional security systems.\nIt is essential to raise awareness on such attacks to better protect organizations from adversaries who maybe backed by nation states.\n[WildFire correctly classifies NetTraveler as malicious. AutoFocus tags are created to identify NetTraveler samples and respective IOCs](https://www.paloaltonetworks.com/products/technologies/wildfire.html)\n[are added to Palo Alto Networks Threat Prevention.](https://paloaltonetworks.com/solutions/initiative/threat-prevention.html)\n### INDICATORS\n**SHA256 Hash** **File Name**\n3f4fcde99775b83bc88d30ca99f5c70c1dd8b96d970dbfd5a846b46c6ea3e534 2015.12.11_сроки\nСГГ 2015 в\nУфе.doc.doc\n001fff6c09497f56532e83e998aaa80690a668883b6655129d408dd098bd1b4b DW20.exe\n74db11900499aa74be9e62d51889e7611eb8161cd141b9379e05eeca9d7175c9rastls.dll\n8f6af103bf7e3201045ce6c2af41f7a17ef671f33f297d36d2aab8640d00b0f0 Sycmentec.config\n495bb9c680f114b255f92448e784563e4fd34ad19cf616cc537bec6245931b7e config.dat\n41650cb6b4ae9f06c92628208d024845026c19af1ab3916c99c80c6457bd4fa9 CERTAPL.DLL\n3b4e4d7a0b1185a45968d90ffe6346f4621116d14dbf88b5138040acc022c757 (NetTraveler DLL\npayload)\n**Command and Control**\nvoennovosti[.]com\n98.126.38[.]107\n### REFERENCES\n[https://securelist.com/blog/research/35936/nettraveler­is­running­red­star­apt­attacks­compromise­high­profile­victims/](https://securelist.com/blog/research/35936/nettraveler-is-running-red-star-apt-attacks-compromise-high-profile-victims/)\n[https://www.fireeye.com/blog/threat­research/2014/04/dll­side­loading­another­blind­spot­for­anti­virus.html](https://www.fireeye.com/blog/threat-research/2014/04/dll-side-loading-another-blind-spot-for-anti-virus.html)\n[http://researchcenter.paloaltonetworks.com/2015/05/plugx­uses­legitimate­samsung­application­for­dll­side­loading/](http://researchcenter.paloaltonetworks.com/2015/05/plugx-uses-legitimate-samsung-application-for-dll-side-loading/)\n[http://indianexpress.com/article/business/business­others/10­years­on­sco­decides­to­induct­india­as­full­member/](http://indianexpress.com/article/business/business-others/10-years-on-sco-decides-to-induct-india-as-full-member/)\n[https://en.wikipedia.org/wiki/Shanghai_Cooperation_Organisation](https://en.wikipedia.org/wiki/Shanghai_Cooperation_Organisation)\n[http://ufa2015.com/](http://ufa2015.com/)\n\n# 3 Pingbacks & Trackbacks\nJune 4, 2016 9:58 PM\n### Automated Infrastructure Alerts ­ RiskIQ\nJune 4, 2016 9:58 PM\n### Automated Infrastructure Alerts ­ RiskIQ\nAugust 2, 2016 6:40 AM\n### NetTraveler ­ La menace persistante avancée (APT) cible les intérêts russes et européens | UnderNews Post Your Comment\n\nName *\n\nEmail *\n\nWebsite\n\nPost Comment\n\n[Home](http://researchcenter.paloaltonetworks.com/)\n[Government](http://researchcenter.paloaltonetworks.com/government)\n[Partners](http://researchcenter.paloaltonetworks.com/partners)\n[Unit 42 Threat Intelligence](http://researchcenter.paloaltonetworks.com/unit42)\n[Technical Documentation](http://researchcenter.paloaltonetworks.com/technical-documentation)\n[Advanced Endpoint Protection](http://researchcenter.paloaltonetworks.com/endpoint-2)\n\n**Get Updates**\nSign up to receive the latest news, cyber threat intelligence and research from Unit 42.\n\n\n-----\n\nSubmit\n\n\n## Subscribe to the Research Center Blog\n\n Categories & Archives\n\nSelect a Category Select a Month\n[More →](http://researchcenter.paloaltonetworks.com/archives/)\n## Recent Posts\n[Traps v3.4: Good News for Breach Prevention in Government Environments posted by Pamela Warren on August 11, 2016](http://researchcenter.paloaltonetworks.com/2016/08/traps-v3-4-good-news-for-breach-prevention-in-government-environments/)\n[Are the Security Issues Facing the Industrial IoT Over­Hyped? posted by Rick Howard on August 10, 2016](http://researchcenter.paloaltonetworks.com/2016/08/cso-are-the-security-issues-facing-the-industrial-iot-over-hyped/)\n[Traps v3.4: New Features Help Prevent Cyberattacks on Banks posted by Lawrence Chin on August 9, 2016](http://researchcenter.paloaltonetworks.com/2016/08/traps-v3-4-new-features-help-prevent-cyberattacks-on-banks/)\n[New Traps v3.4 Features Improve Protection in Healthcare Environments posted by Matt Mellen on August 8, 2016](http://researchcenter.paloaltonetworks.com/2016/08/new-traps-v3-4-features-improve-protection-in-healthcare-environments/)\n[A Powerful Combination: New Cyber Breach Prevention Offering posted by Eric Schou on August 8, 2016](http://researchcenter.paloaltonetworks.com/2016/08/a-powerful-combination-new-cyber-breach-prevention-offering/)\n[More →](http://researchcenter.paloaltonetworks.com/archives/)\n\n# About Palo Alto Networks\nPalo Alto Networks is the network security company. Our innovative platform allows enterprises, service providers, and government\nentities to secure their networks and safely enable the increasingly complex and rapidly growing number of applications running on\ntheir networks.\nThe core of Palo Alto Networks' platform is our next­generation firewall, which delivers application, user, and content visibility and\ncontrol integrated within the firewall through its proprietary hardware and software architecture. Palo Alto Networks products and\nservices can address a broad range of network security requirements, from the datacenter to the network perimeter, as well as the\ndistributed enterprise, which includes branch offices and a growing number of mobile devices.\n# FOLLOW US\n[Facebook](https://www.facebook.com/PaloAltoNetworks)\n[Twitter](https://twitter.com/PaloAltoNtwks)\n[Linked In](http://www.linkedin.com/company/palo-alto-networks)\n[You Tube](http://www.youtube.com/)\n# Learn More\n[Firewalls](https://www.paloaltonetworks.com/resources/learning-center/what-is-a-firewall.html)\n[VPN](https://www.paloaltonetworks.com/resources/learning-center/what-is-a-vpn.html)\n[Malware](https://www.paloaltonetworks.com/resources/learning-center/what-is-malware.html)\n[Intrusion Prevention System](https://www.paloaltonetworks.com/resources/learning-center/what-is-an-intrusion-prevention-system-ips.html)\n[Intrusion Detection System](https://www.paloaltonetworks.com/resources/learning-center/what-is-an-intrusion-detection-system-ids.html)\n[Denial of Service Attack](https://www.paloaltonetworks.com/resources/learning-center/what-is-a-denial-of-service-attack-dos.html)\n[Security Policy](https://www.paloaltonetworks.com/resources/learning-center/what-is-an-it-security-policy.html)\n[Network Security](https://www.paloaltonetworks.com/resources/learning-center/what-is-network-security.html)\n[Data Center](https://www.paloaltonetworks.com/resources/learning-center/what-is-a-data-center.html)\n1.866.320.4788\n[Privacy Policy](https://www.paloaltonetworks.com/legal/privacy.html)\n[Legal Notices](https://www.paloaltonetworks.com/legal.html)\n[Site Index](https://www.paloaltonetworks.com/site-index.html)\n[Subscriptions](https://www.paloaltonetworks.com/company/subscriptions.html)\nCopyright © 2007­2013 Palo Alto Networks\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.21.NetTraveler_Uzbekistan/NetTraveler%20Spear-Phishing%20Email%20Targets%20Diplomat%20of%20Uzbekistan%20-%20Palo%20Alto%20Networks%20BlogPalo%20Alto%20Networks%20Blog.pdf"
    ],
    "report_names": [
        "NetTraveler Spear-Phishing Email Targets Diplomat of Uzbekistan - Palo Alto Networks BlogPalo Alto Networks Blog"
    ],
    "threat_actors": [
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "254f2fab-5834-4d90-9205-d80e63d6d867",
            "created_at": "2023-01-06T13:46:38.31544Z",
            "updated_at": "2025-03-27T02:00:02.802896Z",
            "deleted_at": null,
            "main_name": "APT21",
            "aliases": [
                "HAMMER PANDA",
                "TEMP.Zhenbao",
                "NetTraveler"
            ],
            "source_name": "MISPGALAXY:APT21",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1470927340,
    "ts_modification_date": 1470927340,
    "files": {
        "pdf": "https://archive.orkl.eu/1cd7c6502a22702e4e05e1708ce2662534cb3e32.pdf",
        "text": "https://archive.orkl.eu/1cd7c6502a22702e4e05e1708ce2662534cb3e32.txt",
        "img": "https://archive.orkl.eu/1cd7c6502a22702e4e05e1708ce2662534cb3e32.jpg"
    }
}