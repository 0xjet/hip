{
    "id": "c9cfcfbd-2bfe-49b7-9ac8-2f9c8adb3c58",
    "created_at": "2023-01-12T15:06:13.97162Z",
    "updated_at": "2025-03-27T02:16:16.829254Z",
    "deleted_at": null,
    "sha1_hash": "e35574875d156ab03fd0c433294a4f7acbb66701",
    "title": "2017-01-25 - Detecting threat actors in recent German industrial attacks with Windows Defender ATP",
    "authors": "",
    "file_creation_date": "2022-05-28T21:53:34Z",
    "file_modification_date": "2022-05-28T21:53:34Z",
    "file_size": 1178048,
    "plain_text": "# Detecting threat actors in recent German industrial attacks with Windows Defender ATP\n\n**microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-**\ndefender-atp/\n\nJanuary 25, 2017\n\nWhen a Germany-based industrial conglomerate disclosed in December 2016 that it was\nbreached early that year, the breach was revealed to be a professionally run industrial\n[espionage attack. According to the German press, the intruders used the Winnti family of](http://www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Win32/Winnti)\nmalware as their main implant, giving them persistent access to the conglomerate’s network\nas early as February 2016.\n\nIn this blog, we look at the Winnti malware implant as used by two known activity groups\nBARIUM and LEAD. We look at how these activity groups introduce the implant to various\ntargets and techniques used by Microsoft researchers to track the implant.\n\nTo show how this breach and similar breaches can be mitigated, we look at how Windows\nDefender Advanced Threat Protection (Windows Defender ATP) flags activities associated\nwith BARIUM, LEAD, and other known activity groups and how it provides extensive threat\nintelligence about these groups. We go through the Winnti implant installation process and\nexplore how Windows Defender ATP can capture such attacker methods and tools and\nprovide visualized contextual information that can aid in actual attack investigation and\nresponse. We then discuss how centralized response options, provided as enhancements to\nWindows Defender ATP with the [Windows 10 Creators Update, can be used to quickly stop](https://blogs.windows.com/business/2016/12/06/windows-10-creators-update-advances-security-best-class-modern-tools)\nthreats, including stopping command and control (C&C) communication and preventing\nexisting implants from installing additional components or from moving laterally to other\ncomputers on the network.\n\n\n-----\n\nTo test how Windows Defender ATP can help your organization detect, investigate, and\n[respond to advanced attacks, sign up for a free trial.](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)\n\n## Winnti activity groups: BARIUM and LEAD\n\nMicrosoft Threat Intelligence associates Winnti with multiple activity groups—collections of\nmalware, supporting infrastructure, online personas, victimology, and other attack artifacts\nthat the Microsoft intelligent security graph uses to categorize and attribute threat activity.\nMicrosoft labels activity groups using code names derived from elements in the periodic\ntable. In the case of this malware, the activity groups strongly associated with Winnti are\nBARIUM and LEAD. But even though they share the use of Winnti, the BARIUM and LEAD\nactivity groups are involved in very different intrusion scenarios.\n\nBARIUM begins its attacks by cultivating relationships with potential victims—particularly\nthose working in Business Development or Human Resources—on various social media\nplatforms. Once BARIUM has established rapport, they spear-phish the victim using a variety\nof unsophisticated malware installation vectors, including malicious shortcut (.lnk) files with\nhidden payloads, compiled HTML help (.chm) files, or Microsoft Office documents containing\n[macros or exploits. Initial intrusion stages feature the Win32/Barlaiy implant—notable for its](https://www.microsoft.com/security/portal/threat/encyclopedia/Entry.aspx?Name=Trojan:Win32/Barlaiy.A!dha)\nuse of social network profiles, collaborative document editing sites, and blogs for C&C. Later\nstages of the intrusions rely upon Winnti for persistent access. The majority of victims\nrecorded to date have been in electronic gaming, multimedia, and Internet content industries,\nalthough occasional intrusions against technology companies have occurred.\n\nIn contrast, LEAD has established a far greater reputation for industrial espionage. In the\npast few years, LEAD’s victims have included:\n\nMultinational, multi-industry companies involved in the manufacture of textiles,\nchemicals, and electronics\nPharmaceutical companies\nA company in the chemical industry\nUniversity faculty specializing in aeronautical engineering and research\nA company involved in the design and manufacture of motor vehicles\nA cybersecurity company focusing on protecting industrial control systems\n\nDuring these intrusions, LEAD’s objective was to steal sensitive data, including research\nmaterials, process documents, and project plans. LEAD also steals code-signing certificates\nto sign its malware in subsequent attacks.\n\nIn most cases, LEAD’s attacks do not feature any advanced exploit techniques. The group\nalso does not make special effort to cultivate victims prior to an attack. Instead, the group\noften simply emails a Winnti installer to potential victims, relying on basic social engineering\ntactics to convince recipients to run the attached malware. In some other cases, LEAD gains\n\n\n-----\n\naccess to a target by brute-forcing remote access login credentials, performing SQL\ninjection, or exploiting unpatched web servers, and then they copy the Winnti installer directly\nto compromised machines.\n\n## Tracking Winnti\n\nMicrosoft Analytics shows that Winnti has been used in intrusions carried out throughout\nAsia, Europe, Oceania, the Middle East, and the United States in the last six months (Figure\n1). The most recent series of attacks observed was in December 2016.\n\n_Figure 1. Winnti encounters from July to December 2016_\n\nAlthough tracking threats like Winnti involves old-fashioned investigative work, Microsoft\nThreat Intelligence analysts take advantage of machine learning to work at scale. When\nattackers used Winnti to maintain access to web servers, they hid the implant in plain sight\nby masquerading it as a trusted, legitimate file. This was the case in two known intrusions in\n2015, where attackers named the implant DLL “ASPNET_FILTER.DLL” to disguise it as the\nDLL for the ASP.NET ISAPI Filter (Table 1). Although there are obvious differences between\nthe legitimate file and the malicious one, filtering out the malicious file would involve going\nthrough a data set with noise from millions of possible file names, software publishers, and\ncertificates. Microsoft researchers used a combination of anomaly detection and supervised\nmachine learning to reduce the data set and separate meaningful, malware-related\nanomalies from benign data.\n\n\n-----\n\n_Table 1. Legitimate ASPNET_FILTER.dll vs. disguised Winnti sample_\n\n## Dealing with Winnti intrusions\n\nWindows Defender ATP helps network security professionals deal with intrusions from\nactivity groups like LEAD and BARIUM in several ways. The following examples were\ndeveloped using a Winnti installer that was used in attacks in December 2016.\n\n### Alerts for breach activity\n\nMicrosoft Threat Intelligence continually tracks activity groups such as LEAD and BARIUM\nand documents the tactics, techniques, and procedures they employ in their attacks, with a\nspecial focus on the tools and infrastructure they use to facilitate those attacks. Windows\nDefender ATP continuously monitors protected systems for such indicators of hostile activity\nand alerts security operations center (SOC) personnel to their presence (Figure 2).\n\n_Figure 2. Threat intelligence alert in Windows Defender ATP_\n\nTo provide context around such alerts, Windows Defender ATP also features a short\nsummary of the group’s history, goals, methods, and tools (Figure 3), with links to extensive\ndocumentation for technically minded users.\n\n\n-----\n\n_Figure 3. Lead activity group summary and extensive documentation_\n\nWindows Defender ATP is also capable of detecting previously unknown attacks by\nmonitoring system behavior indicative of hostile activity, including:\n\nMalware installation, persistence, and activation\nBackdoor command and control\nCredential theft\nLateral movement to other machines on the network\n\nFor example, numerous malware families register themselves as services during installation\nto guarantee persistence across reboots. A majority of malware that perform this persistence\ntechnique modify the necessary registry keys in ways that do not fit the profile of a legitimate\nprogram. Winnti is no exception, and so, during Winnti’s installation process, Windows\nDefender ATP is able to raise behavioral alerts (Figure 4).\n\n_Figure 4. Abnormal service creation alert_\n\nTo improve coverage while minimizing false positives, Windows Defender ATP uses the\nintelligent security graph to differentiate between suspicious and benign behavior before\ngenerating alerts. It considers the age of the file, its global prevalence, and the presence and\nvalidity of a digital signature along with the method of service creation.\n\n### Visualized contextual information\n\n\n-----\n\nFor alerts raised either by specific threat intelligence tied to activity groups or by more\ngeneric suspicious behaviors, Windows Defender ATP provides rich, visualized technical\ncontext. This visual context enables SOC personnel to investigate alerts with all related\nartifacts, understand the scope of the breach, and prepare a comprehensive action plan. In\nthe screenshots below, Windows Defender ATP clearly presents the Winnti installation where\nan installer drops a DLL to disk (Figure 5), loads the DLL using rundll32 (Figure 6), sets the\nDLL as a service (Figure 7), and saves a copy of itself in C:\\Windows\\Help (Figure 8).\n\n_Figure 5. Winnti installer drops a DLL_\n\n_Figure 6. Winnti installer loads DLL with rundll32_\n\n\n-----\n\n_Figure 7. Winnti sets itself as a service for persistence_\n\n_Figure 8. Installer copied to C:\\Windows\\Help\\_\n\nWindows Defender ATP displays these activities as process trees in a machine timeline for\nthe infected computer. Analysts can easily extract detailed information from these trees, such\nas the implant DLL dropped by the installer, the command used to call rundll32.exe and load\nthe DLL, and the registry modifications that set the DLL as a service. This information can\nprovide an initial means by which to assess the scope of the breach.\n\n### Response options\n\nThe [Windows 10 Creators Update will bring several enhancements to Windows Defender](https://blogs.windows.com/business/2016/12/06/windows-10-creators-update-advances-security-best-class-modern-tools)\nATP that will provide SOC personnel with options for immediate mitigation of a detected\nthreat. If an intruder compromises a computer that has been onboarded to Windows\nDefender ATP, SOC personnel can isolate the computer from the network, blocking\ncommand and control of the implant and preventing attackers from installing additional\nmalware and moving laterally to other computers in the network. Meanwhile, connectivity to\nthe Windows Defender ATP service is maintained. While the machine is in isolation, SOC\npersonnel can direct the infected machine to collect live investigation data, such as the DNS\ncache or security event logs, which they can use to verify alerts, assess the state of the\nintrusion, and support follow-up actions.\n\n\n-----\n\n_Figure 9. Response options for the compromised machine_\n\nAnother option is to simply halt and quarantine the Winnti implant itself, stopping the\nintrusion on a single machine. LEAD and BARIUM are not known for large-scale spearphishing, so it is unlikely that SOC personnel would have to deal with multiple machines\nhaving been compromised by these groups at the same time. Nevertheless, Windows\nDefender ATP also supports blocking the implant across the entire enterprise, stopping\nlarge-scale intrusions in the early stages (Figure 10).\n\n\n-----\n\n_Figure 10. Response options for the Winnti implant file_\n\n## Conclusion: Shorten breach detection times to reduce impact\n\nAccording to news reports, the incident affecting the industrial conglomerate may have taken\nseveral months to detect and mitigate. The time between the actual breach and its detection\nmay have given attackers enough time to locate sensitive information and exfiltrate this\ninformation.\n\nWith the enhanced post-breach detection capabilities of Windows Defender ATP, SOC\npersonnel are able to reduce this period to hours or even minutes, significantly lessening the\npotential impact of persistent attacker access to their network. Windows Defender ATP\nprovides extensive information about activity groups responsible for the attacks, enabling\ncustomers to understand aspects of the attack that may not be obtained by network and\nendpoint sensors, such as common social engineering lures and the regional nature of an\nattack. With relevant visualized information, analysts are able to study malware behavior on\nimpacted machines, so they can investigate further and plan out their response. And, finally,\nwith the upcoming Creators Update, Windows Defender ATP will provide additional\ncapabilities for detecting threats such as Winnti, as well as centralized response options,\nsuch as machine isolation and file blocking, that will enable fast containment of known attack\njump off points.\n\n\n-----\n\nWindows Defender ATP is built into the core of Windows 10 Enterprise and can be\n**[evaluated free of charge.](https://www.microsoft.com/en-us/WindowsForBusiness/windows-atp)**\n\n_Peter Cap, Mathieu Letourneau, Ben Koehl, and Milad Aslaner_\n\n_[This blogpost is also available in German.](https://blogs.technet.microsoft.com/windowsfurunternehmen/2017/01/25/cyber-angriff-auf-deutsche-industrie-mithilfe-von-windows-defender-atp-aufgedeckt/)_\n\n**Talk to us**\n\n[Questions, concerns, or insights on this story? Join discussions at the Microsoft community](https://answers.microsoft.com/en-us/protect)\n[and Windows Defender Security Intelligence.](https://www.microsoft.com/en-us/wdsi)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-01-25 - Detecting threat actors in recent German industrial attacks with Windows Defender ATP.pdf"
    ],
    "report_names": [
        "2017-01-25 - Detecting threat actors in recent German industrial attacks with Windows Defender ATP.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "49822165-5541-423d-8808-1c0a9448d588",
            "created_at": "2022-10-25T16:07:23.384093Z",
            "updated_at": "2025-03-27T02:02:09.772829Z",
            "deleted_at": null,
            "main_name": "Barium",
            "aliases": [
                "Brass Typhoon",
                "Pigfish"
            ],
            "source_name": "ETDA:Barium",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Barlaiy",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "POISONPLUG",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535973,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653774814,
    "ts_modification_date": 1653774814,
    "files": {
        "pdf": "https://archive.orkl.eu/e35574875d156ab03fd0c433294a4f7acbb66701.pdf",
        "text": "https://archive.orkl.eu/e35574875d156ab03fd0c433294a4f7acbb66701.txt",
        "img": "https://archive.orkl.eu/e35574875d156ab03fd0c433294a4f7acbb66701.jpg"
    }
}