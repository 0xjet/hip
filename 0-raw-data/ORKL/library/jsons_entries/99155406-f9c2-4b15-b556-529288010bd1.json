{
    "id": "99155406-f9c2-4b15-b556-529288010bd1",
    "created_at": "2023-01-12T15:03:17.737954Z",
    "updated_at": "2025-03-27T02:09:14.24855Z",
    "deleted_at": null,
    "sha1_hash": "589cf1096183a5609885d4ada2b9a223022e6fd1",
    "title": "2014-10-14 - CrowdStrike Discovers Use of 64-bit Zero-Day Privilege Escalation Exploit (CVE-2014-4113) by Hurricane Panda",
    "authors": "",
    "file_creation_date": "2022-05-27T18:59:21Z",
    "file_modification_date": "2022-05-27T18:59:21Z",
    "file_size": 1124746,
    "plain_text": "# CrowdStrike Discovers Use of of 64-bit Exploit by Hurricane Panda\n\n**crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-**\npanda/\n\nOctober 14, 2014\n\n## CrowdStrike Discovers Use of 64-bit Zero-Day Privilege Escalation Exploit (CVE-2014-4113) by Hurricane Panda\n\nOctober 14, 2014\n\n[CrowdStrike Content Team](https://www.crowdstrike.com/blog/author/crowdstrike-content-team/) [Executive Viewpoint](https://www.crowdstrike.com/blog/category/executive-viewpoint/)\n\nEvery once in a while an adversary does something unique or interesting that really\ncaptures our attention. The majority of the remote access tools we come across generally\nrun with limited privileges when instantiated on a compromised machine. Privileged access\nis not required if you are, for example, only going after files that are accessed by general\nusers. However, adversaries who intend to perform more advanced actions that require\n\n\n-----\n\nadministrative access, such as loading a kernel driver that acts as a rootkit or conducting\npassword dumping, needed to elevate their privileges on the victim machine and move\naround laterally across the network.\n\nAdversaries often use known privilege escalation vulnerabilities to gain administrator-level\naccess but true zero-day exploits are rare and therefore particularly interesting when\nobserved in the wild. They demonstrate that an attacker has knowledge about non-public\nexploitable security bugs, which usually means that the exploit was either bought from a\nsupplier or developed in-house. Either way, each time we observe zero-day exploits in the\n[wild, they help us better understand an adversary’s capabilities. CrowdStrike Falcon Host](http://www.crowdstrike.com/falcon-host/)\nEndpoint Threat Detection & Response (ETDR) technology recently detected suspicious\nactivity on a 64-bit Windows Server 2008 R2 machine that was attributed to a compromise\nby HURRICANE PANDA\n\n## HURRICANE PANDA\n\nHURRICANE PANDA is a highly advanced adversary believed to be of Chinese origin and\nknown to be targeting infrastructure companies. They have been known to use three other\nlocal privilege escalation vulnerabilities in addition to the zero-day discussed here. Their\nRAT of choice has been PlugX configured to use the DLL side-loading technique that has\nbeen recently popularized among Chinese adversaries. Perhaps their most outstanding\ntechnique has been the use of free DNS services provided by Hurricane Electric to return\nan attacker-controlled IP address for lookups for popular third-party domain names.\nHURRICANE PANDA is known to use the “ChinaChopper” Webshell, a common initial\nfoothold for many different actors. Once uploading this webshell, the actor will typically\nattempt to escalate privileges and then use a variety of password dumping utilities to obtain\nlegitimate credentials for use in accessing their intelligence objectives.\n\nCrowdStrike has been battling HURRICANE PANDA on a daily basis since earlier this\nspring, when the adversary was first detected on a victim network and evicted from that\n[network by CrowdStrike Services Incident Response team. Since then, they have been](http://services.crowdstrike.com/)\ntrying to regain access on a daily basis. These attempts begin with compromising web\nservers and deploying Chopper webshells and then moving laterally and escalating\nprivileges using the newly discovered Local Privilege Escalation tool. When these attempts\noccur, they are instantly detected by Falcon Host and the adversary is stopped in their\ntracks. This oftentimes resulted in attackers humorously mistyping their commands as they\nfeverishly worked to try to bury themselves into the network knowing that they have\npreciously little time to work with before being shut down. Several times the attacker called\nthe wrong single-letter executable (“hsotname” instead of “hostname” and “romote” instead\nof “remote”) in a panic to achieve their objective before they were kicked out.\n\n\n-----\n\nOne of many unique capabilities of Falcon host is its lateral movement and credential theft\nactivity detection, which provided us and the victims with instantaneous full visibility into all\nadversary activity and preventing the adversary from getting a foothold in the network.\n\n## Falcon Host provides full visibility into the attack – Discovery of Local Privilege Escalation Vulnerability (CVE-2014-4113)\n\nThrough Falcon Host technology, we observed that the attackers were using a specific\nexecutable to invoke other programs with administrative privileges from the account of an\nunprivileged user. An example is shown below:\n\nFalcon Host detection screen showing the use of Win64.exe from a webshell to elevate privileges\n\nfor ‘net localgroup administrators admin /add” command\n\nnet command now running as Local System\n\n\n-----\n\nSubsequent analysis of the `Win64.exe binary revealed that it exploits a previously`\nunknown vulnerability to elevate its privileges to those of the SYSTEM user and then create\na new process with these access rights to run the command that was passed as argument.\nThe file itself is just 55 kilobytes in size and contains just a few functions. Here is a highlevel description of its functionality:\n\n1. Create a memory section and store a pointer to a function that will be called from the\n\nkernel when the vulnerability is triggered\n2. Utilize a memory corruption vulnerability in the window manager, simulating user\n\ninteraction to invoke a callback function\n3. Replace the access token pointer in the EPROCESS structure with the one from the\n\nSYSTEM process\n4. Execute the command from the first argument as a new process with SYSTEM\n\nprivileges\n\nThe following output demonstrates how this tool can be used to start a command shell with\nadministrative access rights.\n\nThe exploit code is extremely well and efficiently written, and it is 100 percent reliable. The\nadversary has gone through considerable effort to minimize the chance of its discovery —\nthe win64.exe tool was only deployed when absolutely necessary during the intrusion\noperations and it was deleted immediately after use. The build timestamp of the Win64.exe\nbinary of May 3, 2014 suggests that the vulnerability was actively exploited in the wild for at\nleast five months.\n\n\n-----\n\nOne of the other interesting elements of the tool is an embedded string woqunimalegebi,\nwhich is a popular Chinese swearword that is also often misspelled when written in Chinese\ncharacters in order to evade online censors and can be translated as “Fertile Grass Mud\nHorse in the Mahler Gobi Desert”\n\nBolivian Alpaca aka “Grass Mud Horse”\n\n## Affected Windows Versions, Identification and Patches\n\nThis security bug affects all x64 Windows variants up to and including Windows 7 and\nWindows Server 2008 R2. On systems with Windows 8 and later variants with Intel Ivy\nBridge or later generation processors, SMEP (Supervisor Mode Execution Prevention) will\nblock attempts to exploit the bug and result in a blue screen.\n\nWe reported this vulnerability to Microsoft who assigned the common identifier CVE-2014[4113 to it. Today, Microsoft published security bulletin MS14-058 and issued a patch that](https://technet.microsoft.com/library/security/ms14-oct)\nfixes the vulnerability. The YARA signature below fires on samples that attempt to exploit\nthis bug.\n```\nrule CrowdStrike_CVE_2014_4113 {\nmeta:\ncopyright = \"CrowdStrike, Inc\"\ndescription = \"CVE-2014-4113 Microsoft Windows x64 Local Privilege\nEscalation Exploit\"\nversion = \"1.0\"\nlast_modified = \"2014-10-14\"\nin_the_wild = true\nstrings:\n\n```\n\n-----\n\n```\n$const1 = { fb ff ff ff }\n$const2 = { 0b 00 00 00 01 00 00 00 }\n$const3 = { 25 00 00 00 01 00 00 00 }\n$const4 = { 8b 00 00 00 01 00 00 00 }\ncondition:\nall of them\n}\n\n```\n[Detection for this attack is already available for all CrowdStrike Falcon Host and](http://www.crowdstrike.com/falcon-host/) Falcon\nManaged Protect customers – no further action is needed. Analysis of the weapons and\ntechniques of an adversary allow us to better understand the Tactics, Techniques, and\nProcedures used. With this understanding, we can leverage intelligence and nextgeneration security tools such as Falcon Host to stay one step ahead of the adversary. If\nyou want to hear more about HURRICANE PANDA and their tradecraft or any of the other\n[adversaries that CrowdStrike tracks, please contact: sales@crowdstrike.com and inquire](http://10.10.0.46/mailto:sales@crowdstrike.com)\nabout [Falcon Host, our next-generation endpoint technology,](http://www.crowdstrike.com/falcon-host/) [Falcon Intelligence, our Cyber](http://www.crowdstrike.com/falcon-intelligence/)\n[Threat Intelligence service, or CrowdStrike Services, our incident-response and proactive](http://services.crowdstrike.com/)\nresponse service offerings.\n\nRelated Content\n\n\n-----\n\nCrowdStrike Delivers Adversary-Focused, Platform Approach to CNAPP and Cloud Security\n\n\n-----\n\nCrowdStrike Dominates in Endpoint Detection and Response\n\nCrowdStrike Achieves 100% Prevention in Recent MITRE Engenuity ATT&CK Evaluation Emulating\nRussia-based Threat Groups\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-10-14 - CrowdStrike Discovers Use of 64-bit Zero-Day Privilege Escalation Exploit (CVE-2014-4113) by Hurricane Panda.pdf"
    ],
    "report_names": [
        "2014-10-14 - CrowdStrike Discovers Use of 64-bit Zero-Day Privilege Escalation Exploit (CVE-2014-4113) by Hurricane Panda.pdf"
    ],
    "threat_actors": [
        {
            "id": "722b693d-cfdc-489e-a540-78c7d52ac5a8",
            "created_at": "2022-10-25T16:07:23.713768Z",
            "updated_at": "2025-03-27T02:02:09.940058Z",
            "deleted_at": null,
            "main_name": "Hurricane Panda",
            "aliases": [
                "Operation Poisoned Hurricane"
            ],
            "source_name": "ETDA:Hurricane Panda",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "Mimikatz",
                "SinoChopper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4636526b-b3f7-4e75-8ad9-fb7ef0261b76",
            "created_at": "2023-01-06T13:46:38.295889Z",
            "updated_at": "2025-03-27T02:00:02.797486Z",
            "deleted_at": null,
            "main_name": "HURRICANE PANDA",
            "aliases": [],
            "source_name": "MISPGALAXY:HURRICANE PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535797,
    "ts_updated_at": 1743041354,
    "ts_creation_date": 1653677961,
    "ts_modification_date": 1653677961,
    "files": {
        "pdf": "https://archive.orkl.eu/589cf1096183a5609885d4ada2b9a223022e6fd1.pdf",
        "text": "https://archive.orkl.eu/589cf1096183a5609885d4ada2b9a223022e6fd1.txt",
        "img": "https://archive.orkl.eu/589cf1096183a5609885d4ada2b9a223022e6fd1.jpg"
    }
}