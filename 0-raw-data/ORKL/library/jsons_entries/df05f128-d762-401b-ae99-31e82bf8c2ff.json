{
    "id": "df05f128-d762-401b-ae99-31e82bf8c2ff",
    "created_at": "2023-01-12T15:05:13.386626Z",
    "updated_at": "2025-03-27T02:05:49.979903Z",
    "deleted_at": null,
    "sha1_hash": "d5c8dc3ed8d6469eee7c57978c874a942cf5cf72",
    "title": "2022-07-15 - Stealthy OpenDocument Malware Deployed Against Latin American Hotels",
    "authors": "",
    "file_creation_date": "2022-11-28T18:53:37Z",
    "file_modification_date": "2022-11-28T18:53:37Z",
    "file_size": 2739588,
    "plain_text": "# Recent Posts\n\n**[threatresearch.ext.hp.com/stealthy-opendocument-malware-targets-latin-american-hotels/](https://threatresearch.ext.hp.com/stealthy-opendocument-malware-targets-latin-american-hotels/#)**\n\nJuly 15, 2022\n\n[HP Threat Research Blog • Stealthy OpenDocument Malware Deployed Against Latin](https://threatresearch.ext.hp.com/blog/)\nAmerican Hotels\n\n## Stealthy OpenDocument Malware Deployed Against Latin American Hotels\n\n[In late June 2022, HP Wolf Security isolated an unusually stealthy malware campaign that](https://www.hp.com/uk-en/security/endpoint-security-solutions.html)\nused OpenDocument text (.odt) files to distribute malware. OpenDocument is an open,\nvendor-neutral file format compatible with several popular office productivity suites, including\nMicrosoft Office, LibreOffice and Apache OpenOffice. As described in a blog post by Cisco\nTalos, the campaign targets the hotel industry in Latin America. The targeted hotels are\ncontacted by email with fake booking requests. In the case below, the attached document\nwas purportedly a guest registration document.\n\n\n-----\n\nFigure 1 – Email lure making a booking request.\n\n## Infection chain\n\nThe malicious document was sent as an email attachment. If the user opens the document,\nthey are shown a prompt asking whether fields with references to other files should be\nupdated. An Excel file opens if they click ‘Yes’ to this cryptic message.\n\nFigure 2 – OpenDocument file asking to update fields in the document.\n\n\n-----\n\nAfterwards, the user is shown another prompt asking whether macros should be enabled or\ndisabled. If the user allows macros, this triggers the infection chain, eventually leading to the\n[execution of the malware payload, AsyncRAT.](https://malpedia.caad.fkie.fraunhofer.de/details/win.asyncrat)\n\nFigure 3 – Excel spreadsheet asking the user to enable macros.\n\nIt’s interesting to see OpenDocument files being used to distribute malware because we\nseldom see malware in the wild that uses this file format. Strikingly, the document used in the\ncampaign is poorly detected by anti-virus scanners, with a 0% detection rate on VirusTotal as\nof 7 July.\n\nFigure 4 – OpenDocument VirusTotal detection.\n\nUnlike many malicious documents, analyzing the OpenDocument file reveals no hidden\n[macros. However, the document references Object Linking and Embedding (OLE) objects](https://en.wikipedia.org/wiki/Object_Linking_and_Embedding)\nhosted remotely, as shown in the styles.xml file. The document references 20 documents\nhosted on the same domain, webnar[.]info.\n\n\n-----\n\nFigure 5 – OpenDocument referencing external document.\n\nWhen opening the document, these references are downloaded and opened. Based on our\nanalysis, the same document is always downloaded and contains no macro code. However,\nthe downloaded document contains ten embedded Excel spreadsheets. If the user chose to\nenable macros at the prompt in Figure 3, each of these Excel files opens and asks the user if\nmacros should be activated. It is unclear what purpose is served by opening so many\nduplicate files.\n\nFigure 6 – Externally referenced Word document contains 10 Excel files.\n\nThe Visual Basic for Applications (VBA) macro inside the Excel documents is lean, running a\n[command using the mshta.exe (T1218.005) tool built into Windows that downloads and](https://attack.mitre.org/techniques/T1218/005/)\nexecutes additional code from the web.\n\n\n-----\n\nFigure 7 – VBA macro code within the Excel document.\n\nAt this point, a complex chain of PowerShell, VBScript and batch scripts are started, finally\ndecoding and executing AsyncRAT, an open-source remote access trojan written in C#. A\nscheduled task is created to make the malware persistent on the infected PC. The task relaunches the malware every two hours. The significant part of this infection chain is how the\nattacker evaded detection by relying on the OpenDocument format to load malware using\nexternal OLE objects.\n\nFigure 8 – Complex infection chain leading to AsyncRAT.\n\n\n-----\n\n## Links to other campaign activity\n\nTo see if the same lure was used in other campaigns, we compared the images in the\nmalicious document to a corpus of historical malicious document images from the last three\nyears.\n\nFigure 9 – Campaign using the same lure image.\n\nIn July, another malicious document was spotted in the wild that contained the logo of a\nlegitimate organization mimicked by the threat actor. The main difference between the two\ncampaigns is that the second one relied on Microsoft Word documents instead of\nOpenDocument files. Interestingly, the detection rate of the malicious Microsoft Word\ndocument is far higher than the OpenDocument file.\n\nFigure 10 – Detection rate of Microsoft Word document on VirusTotal.\n\nBoth campaigns used the same lure and targeted Latin American hotels by email. We found\nevidence of similar activity that has been ongoing for several months based on the targeted\norganizations and lure languages (Portuguese and Spanish).\n\n## Conclusion\n\nAttackers are always hunting for stealthy ways of delivering malware that evades endpoint\nsecurity. This campaign illustrates how OpenDocument text files can be abused to deliver\nmalware through external OLE references with extremely low detection rates. Documents\nthat arrive from outside an organization should always be treated with suspicion, especially if\nthey try to load external content from the web – but in practice this isn’t always\nstraightforward advice to follow, especially in industries that rely on exchanging electronic\n\n\n-----\n\ndocuments between suppliers and clients. However, since HP Wolf Security works by\nisolating high-risk tasks like opening email attachments inside secure micro-virtual machines\nthat does not rely on detection, this stopped the malware in this campaign from infecting the\nhost system.\n\n## Indicator of Compromise\n\nOpenDocument files:\n\n_Relação de Hospedes HPLUS.odt (English translation: “Guest List HPLUS.odt”):_\n\n74d8bc5023f8d56e5b9fb46a5da5f1ce7e3e04826ca543274d7f6205866490b9\n\n_CNPJ – HPLUS SISTEMA DE ENSINO LTDA.odt_\n\nb13ce271e58dff54bccf92dbccc17414af168efc2d47d44554a883ca0b2e8e08\n\nMicrosoft Word document\n\n85007a9921ef08cae11e27944fcf0a1897c78dd9f26b6801f17b3b2f80d8f794\n\nExternally referenced Word document:\n\n598ee4b45b38e5d3485e0d6da9e4369c91c5e9981d869ab4745e4df1f9ac14b2\n\nEmbedded Excel files:\n\n2c783d33c0f86fd266efab7dc2f135e83de49472914fc4646f94f590104c0dfa\n\nb88fcd15369df470634ec02ee42392ac948520b4c55b7a7b2c5f979c94cd43d5\n\n6a9c9855bdef4e811610f78385c2deca1f898610de1827f55b92458d157a1788\n\nd46bad7b5f3bf546f70ea1e5caddd1974b06d1befa26f6bca54c98c1431e5276\n\n559eb36bf8ebcb34156972e3eb77bc2c103c9320ef09f31d945532deed73fb87\n\n46503673cf5a603f12cf01d7a6ef232a2bad791201e17d0b449e5e094c63bca3\n\n35e16501438467a0649210473d2527310575a302471778989568b1ef40766b46\n\n1d266e5c8036b48136d9585040c6f85cb61a8b8693997cc0e9ed88e55e1157ea\n\nc402e4b0fa8c7742d6ad086160a71d5d2b0e23d6531dd739076cc10922da5076\n\ndb76cf9623b1f2b1750d75fa2502af7e4f1f6050000bbcedef6379e9d5cb9408\n\nDomains hosting malware stages:\n\nwebnar[.]info\n\nwww.unimed-corporated[.]com\n\nTags\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-15 - Stealthy OpenDocument Malware Deployed Against Latin American Hotels.pdf"
    ],
    "report_names": [
        "2022-07-15 - Stealthy OpenDocument Malware Deployed Against Latin American Hotels.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535913,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1669661617,
    "ts_modification_date": 1669661617,
    "files": {
        "pdf": "https://archive.orkl.eu/d5c8dc3ed8d6469eee7c57978c874a942cf5cf72.pdf",
        "text": "https://archive.orkl.eu/d5c8dc3ed8d6469eee7c57978c874a942cf5cf72.txt",
        "img": "https://archive.orkl.eu/d5c8dc3ed8d6469eee7c57978c874a942cf5cf72.jpg"
    }
}