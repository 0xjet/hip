{
    "id": "4da2b777-4332-4938-8d19-5b6fd23466f0",
    "created_at": "2023-01-12T15:00:21.990045Z",
    "updated_at": "2025-03-27T02:05:28.728362Z",
    "deleted_at": null,
    "sha1_hash": "e071b652e695d495761d4ce530cf8220461a0dfa",
    "title": "2018-01-15 - New KillDisk Variant Hits Financial Organizations in Latin America",
    "authors": "",
    "file_creation_date": "2022-05-28T19:37:34Z",
    "file_modification_date": "2022-05-28T19:37:34Z",
    "file_size": 134665,
    "plain_text": "# KillDisk Variant Hits Latin American Financial Groups\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/new-killdisk-variant-hits-financial-organizations-in-latin-america/](https://blog.trendmicro.com/trendlabs-security-intelligence/new-killdisk-variant-hits-financial-organizations-in-latin-america/)**\n\nJanuary 15, 2018\n\n_Updated as of January 15, 11:58 PM PDT to clarify that the new variant of KillDisk we found_\n_does not have a ransom note._\n\nWe came across a new variant of the disk-wiping KillDisk targeting financial organizations in\n[Latin America. Trend Micro detects it as TROJ_KILLDISK.IUB. Trend Micro™ Deep](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_KILLDISK.IUB)\nDiscovery™ proactively blocks any intrusions or attacks associated with this threat. Initial\nanalysis (which is still ongoing) reveals that it may be a component of another payload, or\npart of a bigger attack. We are still analyzing this new KillDisk variant and we will update this\npost as we uncover more details about this threat.\n\n[KillDisk, along with the multipurpose, cyberespionage-related BlackEnergy, was used in](http://blog.trendmicro.com/trendlabs-security-intelligence/killdisk-and-blackenergy-are-not-just-energy-sector-threats/)\ncyberattacks in late December 2015 against Ukraine’s [energy sector as well as its](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/first-malware-driven-power-outage-reported-in-ukraine) [banking,](https://www.theregister.co.uk/2016/12/15/ukraine_banks_apt/)\nrail, and [mining industries. The malware has since metamorphosed into a threat used for](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/cyber-threats-to-the-mining-industry)\n[digital extortion, affecting Windows and](https://www.trendmicro.com/vinfo/tmr/?/us/security/research-and-analysis/predictions/2018) [Linux platforms. The note accompanying the](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/ransomware-recap-january-1-13-2017)\n[ransomware versions, like in the case of Petya, was a ruse: Because KillDisk also overwrites](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/frequently-asked-questions-the-petya-ransomware-outbreak)\nand deletes files (and don’t store the encryption keys on disk or online), recovering the\nscrambled files was out of the question. The new variant we found, however, does not\ninclude a ransom note.\n\n_Figure 1. KillDisk’s infection chain_\n\n\n-----\n\n**How is it dropped in the system?**\n\nThis KillDisk variant looks like it is intentionally dropped by another process/attacker. Its file\npath is hardcoded in the malware (c:\\windows\\dimens.exe), which means that it is tightly\ncoupled with its installer or is a part of a bigger package.\n\n_Figure 2. The new KillDisk variant’s parameter to shut down the affected machine_\n\nKillDisk also has a self-destruct process, although it isn’t really deleting itself. It renames its\nfile to c:\\windows\\0123456789 while running. This string is hardcoded in the sample we\nanalyzed. It expects its file path to be c:\\windows\\dimens.exe (also hardcoded). Accordingly,\nif disk forensics is performed and dimens.exe is searched, the file that will be retrieved will be\nthe newly created file with 0x00 byte content.\n\n**How does it delete files?**\n\nThis new KillDisk variant goes through all logical drives (fixed and removable) starting from\ndrive b:. If the logical drive contains the system directory, the files and folders in the following\ndirectories and subdirectories are exempted from deletion:\n\nWINNT\nUsers\nWindows\nProgram Files\nProgram Files (x86)\nProgramData\nRecovery (case-sensitive check)\n$Recycle.Bin\nSystem Volume Information\nold\nPerfLogs\n\nBefore a file is deleted, it is first randomly renamed. KillDisk will overwrite the first 0x2800\nbytes of the file and another block that’s 0x2800-bytes big with 0x00.\n\n_Figure 3. Code snippets showing how KillDisk overwrites then deletes files_\n\n**How does it wipe the disk?**\n\n\n-----\n\nThe malware attempts to wipe \\\\.\\PhysicalDrive0 to \\\\.\\PhysicalDrive4. It reads the Master\nBoot Record (MBR) of every device it successfully opens and proceeds to overwrite the first\n0x20 sectors of the device with “0x00”. It uses the information from the MBR to do further\ndamage to the partitions it lists. If the partition it finds is not an extended one, it overwrites\nthe first 0x10 and last sectors of the actual volume. If it finds an extended partition, it will\noverwrite the Extended Boot Record (EBR) along with the two extra partitions it points to.\n\n_Figure 4. Code snippets showing how KillDisk reads/scans the MBR (top, center), and_\n_overwrites the EBR (bottom)_\n\n**What happens after the MBR, files, and folders are overwritten and/or deleted?**\n\nKillDisk has a numeric parameter that denotes the number of minutes (15 being the default)\nit will wait before it shuts down the affected machine. To try to reboot the machine, it will try to\nterminate these processes:\n\nClient/server run-time subsystem (csrss.exe)\nWindows Start-Up Application (wininit.exe)\nWindows Logon Application (winlogon.exe)\nLocal Security Authority Subsystem Service (lsass.exe)\n\nThis is done most likely to force a reboot or dupe the user into restarting the machine.\nTerminating csrss.exe and wininit.exe, for instance, will cause a blue screen of death\n(BSOD). Terminating winlogon.exe will prompt the user to log in again, while terminating\n[lsass.exe will cause a reboot. KillDisk also uses the ExitWindowsEx function to forcefully](https://msdn.microsoft.com/en-us/library/windows/desktop/aa376868(v=vs.85).aspx)\nrestart the machine.\n\n_Figure 5. Code showing KillDisk forcefully rebooting the system_\n\n**What can organizations do?**\n\nKillDisk’s destructive capabilities, and how it could be just a part of a bigger attack, highlight\nthe significance of defense in depth: securing the perimeters — from gateways, endpoints,\nand networks to servers — to further reduce the attack surface. Here are some best\npractices for organizations.\n\nKeep the system and its applications updated/patched to deter attackers from\nexploiting security gaps; consider virtual patching for legacy systems.\n[Regularly back up data and ensure its integrity.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/best-practices-backing-up-data)\n[Enforce the principle of least privilege. Network segmentation and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/protecting-data-through-network-segmentation) data\ncategorization help prevent lateral movement and further exposure.\n[Deploy security mechanisms such as application control/whitelisting and behavior](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nmonitoring, which can block suspicious programs from running and thwart anomalous\nsystem modifications.\n\n\n-----\n\n[Proactively monitor the system and network; enable and employ firewalls as well as](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/best-practices-deploying-an-effective-firewall)\nintrusion prevention and detection systems.\n[Implement a managed incident response policy that will drive proactive remediation](http://blog.trendmicro.com/trendlabs-security-intelligence/four-steps-to-an-effective-targeted-attack-response/)\nstrategies; further strengthen the organization’s security posture by cultivating a\ncybersecurity-aware workplace.\n\n[Trend Micro™ XGen™ security provides a cross-generational blend of threat defense](https://blog.trendmicro.com/en_us/business/products/all-solutions.html)\n[techniques against a full range of threats for data centers,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/security-data-center-virtualization.html) [cloud environments,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html) [networks,](https://blog.trendmicro.com/en_us/business/products/network.html)\n[and endpoints. It features high-fidelity machine learning to secure](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\nthe gateway and endpoint data and applications, and protects physical, virtual, and cloud\nworkloads. With capabilities like web/URL filtering, behavioral analysis, and custom\nsandboxing, XGen protects against today’s purpose-built threats that bypass traditional\ncontrols and exploit known, unknown, or undisclosed vulnerabilities. Smart, optimized, and\nconnected, XGen powers Trend Micro’s suite of security solutions: Hybrid Cloud Security,\nUser Protection, and Network Defense.\n\n**Related Hash (SHA-256):**\n\n8a81a1d0fae933862b51f63064069aa5af3854763f5edc29c997964de5e284e5\n— [TROJ_KILLDISK.IUB](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_KILLDISK.IUB)\n\nCyber Threats\n\nTrend Micro Research came across a new variant of the disk-wiping KillDisk targeting\nfinancial organizations in Latin America. Initial analysis reveals that it may be a component of\nanother payload, or part of a bigger attack.\n\nBy: Gilbert Sison, Rheniel Ramos, Jay Yaneza, Alfredo Oliveira January 15, 2018 Read\ntime: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-01-15 - New KillDisk Variant Hits Financial Organizations in Latin America.pdf"
    ],
    "report_names": [
        "2018-01-15 - New KillDisk Variant Hits Financial Organizations in Latin America.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535621,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653766654,
    "ts_modification_date": 1653766654,
    "files": {
        "pdf": "https://archive.orkl.eu/e071b652e695d495761d4ce530cf8220461a0dfa.pdf",
        "text": "https://archive.orkl.eu/e071b652e695d495761d4ce530cf8220461a0dfa.txt",
        "img": "https://archive.orkl.eu/e071b652e695d495761d4ce530cf8220461a0dfa.jpg"
    }
}