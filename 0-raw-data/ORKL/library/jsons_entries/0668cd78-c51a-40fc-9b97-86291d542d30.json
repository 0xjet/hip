{
    "id": "0668cd78-c51a-40fc-9b97-86291d542d30",
    "created_at": "2023-01-12T15:10:22.295924Z",
    "updated_at": "2025-03-27T02:05:19.407865Z",
    "deleted_at": null,
    "sha1_hash": "85f2506a2c9b79941196dac555b108c395883f6b",
    "title": "2021-06-15 - Use YARA math Module Extension in THOR TechPreview and THOR Lite",
    "authors": "",
    "file_creation_date": "2022-05-28T21:41:27Z",
    "file_modification_date": "2022-05-28T21:41:27Z",
    "file_size": 324598,
    "plain_text": "# Use YARA math Module Extension in THOR TechPreview and THOR Lite\n\n**[nextron-systems.com/2021/06/15/use-yara-math-module-extension-in-thor-techpreview-and-thor-lite/](https://www.nextron-systems.com/2021/06/15/use-yara-math-module-extension-in-thor-techpreview-and-thor-lite/)**\n\nJune 15, 2021\n\n[Not long ago, we’ve created a pull request for the official YARA repository on Github, that](https://github.com/VirusTotal/yara/pull/1483)\nwould introduce new functions in the `math` module to improve the flexibility in cases in\nwhich a sample is heavily scrambled or obfuscated. These cases require further statistical\nevaluations that go beyond the currently available “entropy”, “mean” or “deviation” functions.\n\nThe example on the right shows a heavily obfuscated PHP web shell, as used by a Chinese\nactor.\n\nYou immediately notice the high amount of “%” characters, but since each of them is\npreceded and followed by different characters, it’s difficult to find atoms that are long enough\nto maintain an acceptable performance / stability of that rule.\n\n\n-----\n\nIf you could, you would formulate a rule like this: “Detect files smaller 400 bytes, that begin\nwith ‘<?’ and consist of at least 25 percent ‘%’ characters”.\n\nWell, the new module extension allows you to do exactly that.\n\nRead [the documentation provided with the pull request for details on all three new functions:](https://www.nextron-systems.com/2020/08/31/introduction-thor-techpreview/)\n\ncount(byte/string, offset, size)\npercentage(byte, offset, size)\nmode(offset, size)\n\n\n-----\n\n[While the first two functions are self-explanatory, the mode function isn t. It is is a term used](https://en.wikipedia.org/wiki/Mode_(statistics))\nin statistics for the most common value.\n\n[For your convenience, we’ve already patched our versions of THOR TechPreview and](https://www.nextron-systems.com/2020/08/31/introduction-thor-techpreview/) THOR\nLite to support these extensions of the “math” module. You need at least v10.6.6 to use the\nnew function in your rules.\n\nWe wish you good hunting.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-15 - Use YARA math Module Extension in THOR TechPreview and THOR Lite.pdf"
    ],
    "report_names": [
        "2021-06-15 - Use YARA math Module Extension in THOR TechPreview and THOR Lite.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536222,
    "ts_updated_at": 1743041119,
    "ts_creation_date": 1653774087,
    "ts_modification_date": 1653774087,
    "files": {
        "pdf": "https://archive.orkl.eu/85f2506a2c9b79941196dac555b108c395883f6b.pdf",
        "text": "https://archive.orkl.eu/85f2506a2c9b79941196dac555b108c395883f6b.txt",
        "img": "https://archive.orkl.eu/85f2506a2c9b79941196dac555b108c395883f6b.jpg"
    }
}