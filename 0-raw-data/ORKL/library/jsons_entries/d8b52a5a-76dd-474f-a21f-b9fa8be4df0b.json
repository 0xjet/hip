{
    "id": "d8b52a5a-76dd-474f-a21f-b9fa8be4df0b",
    "created_at": "2022-10-25T16:48:19.498358Z",
    "updated_at": "2025-03-27T02:17:01.696955Z",
    "deleted_at": null,
    "sha1_hash": "fde9e8d0f714d9d0fafd16a78cd99b12d2a88b40",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-09-03T19:26:24Z",
    "file_modification_date": "2020-09-03T19:26:24Z",
    "file_size": 5691659,
    "plain_text": "## Evasive Panda\n\n###### A new Chinese APT “Evasive Panda” group targets India and Hong Kong using a variant of MgBot malware\n\n By Hossein Jazi and Jérôme Segura September 2020\n\n\n-----\n\n#### Hossein Jazi\n###### Senior Threat Intelligence Analyst\n\n Special interest in tracking APT campaigns\n\n Twitter: @h2jazi\n\n\n-----\n\n#### Jérôme Segura\n###### Director Threat Intelligence\n\n Special interest in web threats\n\n Twitter: @jeromesegura\n\n\n-----\n\n### Agenda\n\n###### Introduction\n Discovery\n\n Campaign Analysis\n Analysis of discovered campaign\n\n Attribution\n Tracking and Attribution\n\n TTPs and Toolsets\n Overview of TTPs and tools\n\n Conclusion\n\n\n-----\n\n##### Discovery\n\n###### • July 2[nd]:\n – Found the first mal doc dropping Cobalt Strike\n • July 3[rd]:\n – Same document dropped MgBot\n • July 5[th]:\n – New mal doc dropped MgBot\n\n\n-----\n\n## Campaign Analysis\n\n###### Targeting Hong Kong and India\n\n\n-----\n\n##### Variant 1: Cobalt Strike\n\n\n-----\n\n##### Variant 1: Cobalt Strike\n\n\n###### Malicious document injecting Cobalt Strike into Rundll32.exe\n\n\n-----\n\n##### Variant 1: Cobalt Strike\n\n###### Injects CobaltStrike into rundll32.exe using reflective DLL injection\n\n • Remote template: Dynamic Data Exchange\n\n\n-----\n\n##### Variant 1: Cobalt Strike (cont.)\n\n###### • Squiblydoo\n (MITRE T1218)\n\n • Payload injection\n\n\n-----\n\n##### Variant 2: MgBot\n\n\n-----\n\n###### Malicious document dropping a new variant of\n##### Variant 2: MgBot\n###### MgBot\n\n\n-----\n\n##### Variant 2: MgBot\n\n###### Dropping new variant of MgBot\n\n\n\n###### • Malicious document: Template Injection\n\n • Remote template: Dynamic Data Exchange\n\n\n-----\n\n## MgBot\n\n###### MgBot Overview\n\n\n-----\n\n# Loader\n\n\n-----\n\n##### Privilege Escalation UAC Bypass\n\n###### • Auto-elevated COM interface\n\n Name CLSID DLL\n\n CMSTPLUA {3E5FC7F9-9A51-4367-9063-A120244FBEC7} system32\\cmstplua.dll\n\n Color Management {D2E7041B-2927-42fb-8E9F-7CE93B6DC937} system32\\colorui.dll\n\n • COM interface IARPUninstallStringLauncher (Appwiz.cpl)\n – Uses windows uninstall interface to bypass UAC\n\n\n-----\n\n##### Anti Analysis\n\n###### • Self-modification\n\n • VM detection\n\n • AV detection\n\n\n-----\n\n##### Resolve API calls\n\n###### • builds a function pointer table\n\n\n-----\n\n##### Process\n\n###### • Calls CreateFileW to create iot7D6E.tmp\n\n • Calls WriteFile to populate its content\n\n • Calls CreateProcessInternalW to invoke expand.exe\n\n • Calls CopyFileW to copy tmp.dat into pMsrvd.dll\n\n • Calls DeleteFileW to delete tmp.dat\n\n • Drops DBEngin.EXE and WUAUCTL.EXE in\n\n • Modifies the registry hive of\n of HKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\n\n\n-----\n\n##### APP management\n\n###### • svchost.exe -k netsvcs -p -s AppMgmt\n\n\n\n###### • Net start AppMgmt\n\n • net start StiSvc\n\n\n-----\n\n##### Clean up\n\n###### • Change codepage (1252 – Windows Western)\n\n • Ping 127.0.0.1 –n 5 -> Wait for 5 seconds\n\n • Delete\n\n\n-----\n\n# Final payload\n\n###### pMsrvd.dll (VideoTeam.dll)\n\n\n-----\n\n##### Final Payload\n\n###### • C2 communications\n\n • Screen capture\n\n • File and directory management\n\n • Process management\n\n • Get drive type\n – FAT, FAT32, NTFS, CDFS – Free space\n\n\n-----\n\n##### String obfuscation\n\n\n-----\n\n##### API Calls\n\n\n-----\n\n##### API Calls\n\n\n-----\n\n##### System Services\n\n\n-----\n\n##### Screen Capture\n\n\n-----\n\n##### Injection\n\n\n-----\n\n##### C2 Communications\n\n\n-----\n\n## Attribution\n\n###### Evasive Panda\n\n\n-----\n\n##### Attribution\n\n###### • TTPs\n\n • Document contents\n\n • Past campaigns\n\n • Toolsets\n\n\n-----\n\n##### Evasive Panda Campaigns history\n\nIdentified several variant of\nKsRemote Android Rat\n\nIdentified several new\nvariants of MgBot\n\nCVE-2018-8174\nIdentified several different variants of\nMgBot\n\nNeedle in haystack Identified several variant of\nCVE-2012-0158 KsRemote Android Rat\n\n###### 2016- Jan\n 2012 2014 2018 2019\n 2020\n\n\nDistributed several MgBot\npretended to be legit AV\nrelated files and other\napplications such as Google\nChrome\n\nTarget India and Hong Kong\nTemplate injection, DDE\n\n\n**Use of Covid19 pandemic to distribute MgBot**\n疫情下勞工生生存現狀文章視頻匯總.rar\n**\"list of texts and videos regarding the current situation of workers during the**\n**pandemic\"**\n**Target: Hong Kong, Taiwan, and Malaysia**\n\n\n-----\n\n##### TTPs\n\n###### Initial Access Execution Persistence Privilege Escalation Defense Evasion\n\n Command line Windows service Phishing New service File deletion\n interface\n\n\n###### Execution through\n module load\n\n\n###### Modify existing\n services\n\n\n###### Bypass UAC Run32.dll\n\n\n###### Rundll32 Bypass UAC\n\n\n###### Virtualization/Sandbox Scripting\n evasion\n\n Service execution Template injection\n\n Signed Binary Proxy Mshta\n Execution\n\n\n###### PowerShell\n\n\n###### Inter-Process communication\n\n\n-----\n\n##### TTPs\n\n###### Lateral Discovery C&C Collection Exfiltration Impact Movement\n\n\n###### Automatic Screen Capture Exfiltration\n\n Exfiltration Over C2\n Channel\n\n\n###### Remote File Query Registry\n Copy\n\n System Information Discovery\n\n\n###### Application\n Layer Protocol\n\n\n###### Non- Standard\n Ports\n\n\n###### System Service Discovery\n\n\n-----\n\n##### Evasive Panda\n\n###### • Initial infection vector\n – Documents\n\n • Template injection\n • Exploit vulnerabilities (CVE-2012-0158) – Archive file – VB script vulnerability (CVE-2018-8174)\n\n • Toolsets\n – MgBot – KsRemote Android Rat – Cobalt Strike\n\n\n-----\n\n##### CVE-2012-0158\n\n\n\n###### • One of the most exploited vulnerabilities at its time\n\n • Buffer overflow vulnerability in the ListView / TreeView ActiveX controls in the MSCOMCTL.OCX library.\n\n • Binary data appended to the end of the Word file.\n\n\n-----\n\n##### CVE 2018 8174\n\n\n-----\n\n-----\n\n# KsRemote Android Rat\n\n\n-----\n\n##### KsRemote Android Rat\n\n\n-----\n\n-----\n\n###### KsRemote Android Rat\n\n • Recording screen and audio\n using the phone’s camera/mic\n\n • Locating phone with\n coordinates\n\n • Stealing phone contacts, call\n log, SMS, web history\n\n • Sending SMS messages\n\n\n###### Recording screen and audio\n using the phone’s\n\n Locating phone with\n\n Stealing phone contacts, call\n log, SMS, web history\n\n Sending SMS messages\n\n\n-----\n\n##### Conclusion\n\n###### • Uncovered a new Chinese APT group that has been active at least since 2012\n\n • Targets: Hong Kong, Taiwan, India and Malaysia\n\n • Initial infection vector: Spear phishing\n\n • Main tool: MgBot\n\n • Capable of targeting Android users\n\n\n-----\n\n# Questions?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://vb2020.vblocalhost.com/uploads/VB2020-43.pdf"
    ],
    "report_names": [
        "VB2020-43.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f35997d9-ca1e-453f-b968-0e675cc16d97",
            "created_at": "2023-01-06T13:46:39.490819Z",
            "updated_at": "2025-03-27T02:00:03.108718Z",
            "deleted_at": null,
            "main_name": "Evasive Panda",
            "aliases": [
                "BRONZE HIGHLAND"
            ],
            "source_name": "MISPGALAXY:Evasive Panda",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e7f23eea-259a-4e0d-8eec-d3feb53ab621",
            "created_at": "2024-05-01T02:03:07.956779Z",
            "updated_at": "2025-03-27T02:05:17.269484Z",
            "deleted_at": null,
            "main_name": "BRONZE HIGHLAND",
            "aliases": [
                "Evasive Panda "
            ],
            "source_name": "Secureworks:BRONZE HIGHLAND",
            "tools": [
                " KsRemote",
                " mgbot",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "19ac84cc-bb2d-4e0c-ace0-5a7659d89ac7",
            "created_at": "2022-10-25T16:07:23.422755Z",
            "updated_at": "2025-03-27T02:02:09.791931Z",
            "deleted_at": null,
            "main_name": "Bronze Highland",
            "aliases": [
                "Daggerfly",
                "Evasive Panda",
                "Storm Cloud",
                "StormBamboo",
                "TAG-102",
                "TAG-112"
            ],
            "source_name": "ETDA:Bronze Highland",
            "tools": [
                "Agentemis",
                "CDDS",
                "CloudScout",
                "Cobalt Strike",
                "CobaltStrike",
                "DazzleSpy",
                "KsRemote",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MacMa",
                "Macma",
                "MgBot",
                "Mgmbot",
                "NetMM",
                "Nightdoor",
                "POCOSTICK",
                "RELOADEXT",
                "Suzafk",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "05cb998c-6e81-47f0-9806-ee4fda72fe0a",
            "created_at": "2024-11-01T02:00:52.763555Z",
            "updated_at": "2025-03-27T02:00:55.548035Z",
            "deleted_at": null,
            "main_name": "Daggerfly",
            "aliases": [
                "Daggerfly",
                "Evasive Panda",
                "BRONZE HIGHLAND"
            ],
            "source_name": "MITRE:Daggerfly",
            "tools": [
                "PlugX",
                "MgBot",
                "BITSAdmin",
                "MacMa",
                "Nightdoor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "812f36f8-e82b-41b6-b9ec-0d23ab0ad6b7",
            "created_at": "2023-01-06T13:46:39.413725Z",
            "updated_at": "2025-03-27T02:00:03.082529Z",
            "deleted_at": null,
            "main_name": "BRONZE HIGHLAND",
            "aliases": [
                "Evasive Panda",
                "Daggerfly"
            ],
            "source_name": "MISPGALAXY:BRONZE HIGHLAND",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1599161184,
    "ts_modification_date": 1599161184,
    "files": {
        "pdf": "https://archive.orkl.eu/fde9e8d0f714d9d0fafd16a78cd99b12d2a88b40.pdf",
        "text": "https://archive.orkl.eu/fde9e8d0f714d9d0fafd16a78cd99b12d2a88b40.txt",
        "img": "https://archive.orkl.eu/fde9e8d0f714d9d0fafd16a78cd99b12d2a88b40.jpg"
    }
}