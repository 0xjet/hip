{
    "id": "fde2587d-5fca-46fe-816f-c3f9f3507a43",
    "created_at": "2024-03-08T02:06:49.4154Z",
    "updated_at": "2025-03-27T02:17:22.894255Z",
    "deleted_at": null,
    "sha1_hash": "e068b70ef67160b37b71409aa342bf640588ef0c",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-10-06T09:20:12Z",
    "file_modification_date": "2022-10-06T09:20:12Z",
    "file_size": 1009923,
    "plain_text": "TLP: GREEN\n\n# Analysis Report on Lazarus Group's \n\n Rootkit Malware That Uses BYOVD\n\nAhnLab Security Emergency Response Center (ASEC)\n\nOctober 05, 2022\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n##### Classification\n\nPublications or provided content can only be used within the scope allowed for each\n\nclassification as shown below.\n\n|Classification|Distribution Targets|Precautions|\n|---|---|---|\n|TLP: RED|Reports only provided for certain clients and tenants|Documents that can only be accessed by the recipient or the recipient department Cannot be copied or distributed except by the recipient|\n|TLP: AMBER|Reports only provided for limited clients and tenants|Can be copied and distributed within the recipient organization (company) of reports Must seek permission from AhnLab to use the report outside the organization, such as for educational purposes|\n|TLP: GREEN|Reports that can be used by anyone within the service|Can be freely used within the industry and utilized as educational materials for internal training, occupational training, and security manager training Strictly limited from being used as presentation materials for the public|\n|TLP: WHITE|Reports that can be freely used|Cite source Available for commercial and non- commercial uses Can produce derivative works by changing the content|\n\n\n2\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n\n###### Remarks\n\n\nIf the report includes statistics and indices, some data may be rounded,\n\nmeaning that the sum of each item may not match the total.\n\nThis report is a work of authorship protected by the Copy Right Act\n\nUnauthorized copying or reproduction for profit is strictly prohibited under any\n\ncircumstances.\n\nSeek permission from AhnLab in advance\n\nif you wish to use a part or all of the report.\n\nIf you reprint or reproduce the material without the permission of the organization\n\nmentioned above, you may be held accountable for criminal or civil liabilities.\n\n\nThe version information of this report is as follows:\n\n|Version|Date|Details|\n|---|---|---|\n|1.0|9/22/2022|Analysis report on Lazarus group's rootkit malware that uses BYOVD|\n|2.0|10/5/2022|Information on the disabling of Windows prefetch added|\n\n\n3\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### Contents\n\n1. Overview ............................................................................................................................................................................... 6\n\n2. ene.sys Analysis ................................................................................................................................................................. 8\n\n2.1. Physical Memory Mapping .................................................................................................................................. 8\n\n2.2. Caller and Data Validity Verification .............................................................................................................. 10\n\n2.2.1. SB_SMBUS_SDK.dll Module Loading Verification ............................................................................ 10\n\n2.2.2. AES Encrypted IOCTL Communication and Call Time Verification .......................................... 11\n\n2.3. ene.sys Driver (WinIO Library) Vulnerability ............................................................................................... 13\n\n3. Rootkit Malware Analysis ............................................................................................................................................ 14\n\n3.1. Rootkit Loader (~BIT353.tmp) .......................................................................................................................... 15\n\n3.2. Rootkit (Advance Preparation Stage) ............................................................................................................ 16\n\n3.2.1. Rootkit Export Function............................................................................................................................... 18\n\n3.2.2. Infection Target Verification Routine .................................................................................................... 19\n\n3.2.3. Checking OS Version .................................................................................................................................... 19\n\n3.2.4. Loading Vulnerable Driver Modules ...................................................................................................... 20\n\n3.2.5. Obtaining the Kernel DTB (Directory Table Base) Address ......................................................... 22\n\n3.2.6. Address Conversion (Virtual Address > Physical Address) ......................................................... 24\n\n3.2.7. Modification of the Thread Object's PreviousMode Field ........................................................... 26\n\n3.3. Rootkit (Security Product Disabling Stage) ................................................................................................ 28\n\n3.3.1. Disabling Mini File Filter (fltmgr.sys) ..................................................................................................... 28\n\n3.3.2. Disabling Process/Thread/Module Detection .................................................................................... 30\n\n3.3.3. Disabling Registry Callback ....................................................................................................................... 32\n\n3.3.4. Disabling Object Callback .......................................................................................................................... 33\n\n3.3.5. Disabling WFP Network Filter ................................................................................................................... 34\n\n3.3.6. Disabling Event Tracing ............................................................................................................................... 35\n\n3.3.7. Disabling Windows Prefetch File Creation.......................................................................................... 37\n\nAhnLab Response Overview ........................................................................................................................................... 39\n\n4\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\nConclusion .............................................................................................................................................................................. 40\n\nIoC (Indicators of Compromise) .................................................................................................................................... 41\n\nFile path and name ........................................................................................................................................................ 41\n\nFile hashes (MD5) ........................................................................................................................................................... 41\n\nReferences............................................................................................................................................................................... 42\n\n\n##### CAUTION\n\n###### This report contains a number of opinions given by the analysts based on the \n\n information that has been confirmed so far. Each analyst may have a different\n\n\n###### opinion and the content of this report \n\n\n5\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n## 1. Overview\n\nSince 2009, Lazarus Group, known to be a group of hackers in North Korea, has been\n\nattacking not only Korea but various countries of America, Asia, and Europe. According to\n\nAhnLab's ASD (AhnLab Smart Defense) infrastructure, in early 2022, the Lazarus Group\n\nperformed APT (Advanced Persistent Threat) attacks on Korea's defense, finance, media, and\n\npharmaceutical industries.\n\nAhnLab closely tracked these APT attacks and discovered that these attacks incapacitate\n\nsecurity products in the attack process. An analysis of the attack process revealed that the\n\nLazarus Group exploits an old version of the INITECH process to perform the initial\n\ncompromise before downloading and executing the rootkit malware from the attacker's server.\n\nThe rootkit malware identified in the recent product-disabling attack abused vulnerable driver\n\nkernel modules to directly read and write to the kernel memory area and accordingly, all\n\nmonitoring systems inside the system including AV (Anti-Virus) were disabled.\n\nThis technique is called the \"BYOVD (Bring Your Own Vulnerable Driver)\" method and is\n\nknown to be performed mainly on vulnerable driver modules of hardware supply companies.\n\nWith the latest Windows OS, unsigned drivers can longer be loaded, however, attackers can\n\nuse such legally-signed vulnerable drivers to control kernel area easily.\n\nThe vulnerable driver module used by the Lazarus Group, in this case, was a hardware-related\n\nmodule manufactured by \"ENE Technology\". This module used the original form of an open\n\nsource library called \"WinIO,\" developed by Yariv Kaplan in 1999. The problems with this\n\nmodule include not only the fact that it uses an old open source code but also the fact that\n\nthe verification condition for calling modules is weak, which enables reading and writing to\n\nan arbitrary kernel memory area via a simple bypassing process.\n\n6\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\nThus, the attacker was able to read and write to an arbitrary kernel memory area through\n\nthis module and by modifying data in all areas related to the kernel including files, processes,\n\nthreads, registries, and event filters, disabled all monitoring programs within the system\n\nincluding AV.\n\n7\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n## 2. ene.sys Analysis\n\n### 2.1. Physical Memory Mapping\n\nThe ene.sys driver module developed by \"ENE Technology\" was created with the WinIO\n\nlibrary[1], an open-source code, and it is a module that allows direct access to the physical\n\nkernel memory and the I/O port from the user area. The driver's method of accessing the\n\nphysical memory is the shared memory mapping method via the \"ZwMapViewOfSection\" API\n\nas seen in Figure 1.\n\nThus, the user process that communicates with ene.sys becomes able to map the physical\n\nmemory of kernel areas through IOCTL communication. This in turn means that an arbitrary\n\nphysical kernel memory area can be controlled from the user area.\n\n1 [1] https://swapcontext.blogspot.com/2020/08/ene-technology-inc-vulnerable-drivers.html\n\n8\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n**Figure 1. Physical memory mapping code of ene.sys (WinIO library)**\n\nThe feature to map directly onto the physical memory area may be needed by certain drivers\n\ndepending on their features. However, as it can become a huge risk if abused, drivers using\n\nthis feature must undergo extensive caller verification processes.\n\n9\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n### 2.2. Caller and Data Validity Verification\n\nThe caller verifications process of ene.sys is designed in a way that attackers can easily bypass\n\nit. The process through which a driver verifies the caller and the validity of the data is shown\n\nin the following Figure 2.\n\n**Figure 2. Caller and data validity verification process of ene.sys**\n\n#### 2.2.1. SB_SMBUS_SDK.dll Module Loading Verification\n\nene.sys calls \"PsSetLoadImageNotifyRoutine\" API when the driver is loaded and registers a\n\ncallback routine related to module processing to the kernel. When the module callback is\n\nregistered, the kernel provides a feature that allows the execution of a callback routine when\n\nthe module is loaded in the process.\n\nThe callback routine registered by ene.sys checks if the loaded module in the process is\n\nSB_SMBUS_SDK.dll, and if it is confirmed to be SB_SMBUS_SDK.dll, the routine recognizes the\n\nprocess in question as one that can be trusted and saves its PID information onto the global\n\nvariable of the ene.sys driver.\n\nAs a result, the process which has loaded SB_SMBUS_SDK.dll can undertake IOCTL\n\n10\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\ncommunication with the ene.sys driver.\n\n#### 2.2.2. AES Encrypted IOCTL Communication and Call Time Verification\n\nIn order for a user area process to request physical memory mapping to ene.sys, it must\n\ntransmit a specific IOCTL value (0x80102040). The buffer transmitted to the driver alongside\n\nIOCTL can be seen in Table 1's struct information below.\n\n\n**WinIO Driver Memory Mapping Struct**\n\n\ntypedef struct\n\n_WINIO_PHYSICAL_MEMORY_INFO_EX {\n\nULONG_PTR CommitSize;\n\nULONG_PTR BusAddress;\n\nHANDLE SectionHandle;\n\nPVOID BaseAddress;\n\nPVOID ReferencedObject;\n\nUCHAR EncryptedKey[16];\n\n} WINIO_PHYSICAL_MEMORY_INFO_EX, *\n\nPWINIO_PHYSICAL_MEMORY_INFO_EX;\n\n**Table 1. WinIO driver memory mapping struct**\n\nOut of the struct members, the physical memory address requiring memory mapping is saved\n\nto the BusAddress variable, and the current time value encrypted with AES-ECB is saved to\n\nthe EncryptedKey variable.\n\nIn order to verify the valid IOCTL value requested by the user area, ene.sys calculates the\n\ndifference between the time of IOCTL calling and the time this IOCTL was received by the\n\ndriver and processed. If the difference in time is less than 2ms, the driver recognizes it as\n\nbeing valid and processes the requested IOCTL.\n\n11\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n**Figure 3. Call time verification routine**\n\n\n12\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n### 2.3. ene.sys Driver (WinIO Library) Vulnerability\n\nPutting together the aforementioned, the ene.sys driver is a driver that can map the physical\n\nmemory area from the user area and is also a vulnerable driver with inadequate verifications\n\nfor callers and data.\n\nUpon analyzing the distribution routes of the driver with AhnLab's ASD infrastructure, it was\n\nconfirmed that it is mainly distributed as an RGB RAM module control module of MSI, a\n\nlaptop manufacturer. If ene.sys is installed in the user PC environment, it has the risk of being\n\nabused by the attacker. Thus, if it doesn't affect performance, it must be removed.\n\n13\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n## 3. Rootkit Malware Analysis\n\nThe execution flow (①~⑤) of the rootkit malware used by the Lazarus Group to disable\n\nsecurity products is described in Figure 4 below.\n\n**Figure 4. Rootkit execution flow (①~⑤)**\n\nThe rootkit operates as a DLL on the rootkit loader process memory and upon execution,\n\ngenerates a vulnerable driver module (ene.sys) on the system drive path. It then loads the\n\ngenerated driver and modifies a specific address value in the kernel memory area.\n\nThe address area modified by the vulnerable kernel driver is the PreviousMode address of\n\nthe rootkit thread object running as a DLL, and this value is changed to 0. When the\n\nPreviousMode value of the user thread object is changed to 0, the driver is able to access\n\nthe kernel area from the user area through the \"NtWriteVirtualMemory\" API.\n\nAfterward, the attacker manipulated the kernel memory from the user area and disabled the\n\nsecurity system within the system.\n\n14\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n### 3.1. Rootkit Loader (~BIT353.tmp)\n\nAccording to AhnLab's ASD infrastructure, the Lazarus Group distributed the rootkit in 2\n\nformats: DLL (~BIT353.tmp) and fileless formats. This report analyzes the DLL rootkit in Figure\n\n5.\n\n**Figure 5. DLL distribution method**\n\n**Figure 6. Fileless distribution method**\n\n~BIT353.tmp saves the rootkit DLL internally with XOR encryption, which is decrypted on\n\nmemory upon execution. Thus, the rootkit itself is designed to operate on the memory. Figure\n\n7 below shows the code with which the rootkit loader assigns new memories and executes\n\nthe rootkit export function (Create(), Close()) by XOR decrypting the rootkit in the target\n\nspace.\n\n15\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n**Figure 7. Rootkit execution code of the rootkit loader**\n\n### 3.2. Rootkit (Advance Preparation Stage)\n\nThe rootkit is compressed into a Vmprotect executable to disrupt analysis and contains the\n\nfollowing two export functions.\n\n⚫ Compile time: 05/24/2022 12:15:32 (UTC)\n\n⚫ Close(): Executes rootkit\n\n⚫ Create(): Verifies rootkit load process memory environment\n\n⚫ DLL name: FudModule.dll\n\n16\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n**Figure 8. Rootkit compile time and export function information**\n\n\n17\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.2.1. Rootkit Export Function\n\n###### a. Close()\n\nThe Close function verifies the image and memory areas where the rootkit was loaded\n\nthrough the \"NtQueryVirtualMemory\" API.\n\n⚫ Type of pages in the region (DLL base path) & 0x20000 == 0 (MEM_PRIVATE\n\nverification)\n\n⚫ Type of pages in the region (DLL base path) & 0x1000000 == 0 (MEM_IMAGE\n\nverification)\n\n⚫ Check if the mapped file name exists in the DLL BASE address\n\n⚫ Check if the running OS is Win 10 RS3 or more recent\n\n⚫ Check if the ImageSignatureLevel includes at least one of the following:\n\n◼ SE_SIGNING_LEVEL_MICROSOFT\n\n◼ SE_SIGNING_LEVEL_WINDOWS\n\n◼ SE_SIGNING_LEVEL_WINDOWS_TCB\n\n**Figure 9. Close() function**\n\n###### b. Create()\n\nCreate is the core function of the rootkit responsible for ene.sys driver creation, service\n\nexecution, and disabling of security products.\n\n18\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.2.2. Infection Target Verification Routine\n\nThe rootkit calculates the result value of the \"GetComputerNameW\" API call with SHA256\n\nand only when it matches the value below, performs the malicious behaviors. This signifies\n\nthat the infection target is clear, and it can be deduced that this is an APT attack.\n\n⚫ **05/24/2022 compile date file : A1 53 1C 4B FE 51 78 E3 E1 2F 10 35 9D 54 BF 29**\n\n42 3C BD 3D 24 F7 71 3D BC 9B D9 0D FA 60 DF C6\n\n⚫ **07/13/2022 compile date file: B4 2D CA BA A0 8D 91 6D F3 B9 66 11 62 24 3F B9**\n\nCB 94 DD 08 BD E9 A6 72 30 8D B2 88 AF 73 DA 04\n\n#### 3.2.3. Checking OS Version\n\nThe rootkit refers to the OSBuildNumber field of the PEB struct to obtain the OS information\n\nof the current system. The purpose of the rootkit is to disable security products by modifying\n\nthe global kernel data (callbacks and global variables). In order to successfully disable the\n\nsystem, the kernel area offset data, which is different for each OS, must be precisely modified.\n\nTherefore, the offset information is saved to the memory space for the purpose of modifying\n\nglobal kernel data based on the obtained OS information.\n\nFor example, in the case of the PreviousMode field of ETHREAD object which the rootkit of\n\nLazarus Group modifies, the offset is different for each OS version.\n\n⚫ Win7 (7601) PreviousMode field: ETHREAD struct's 0x1F6 location\n\n⚫ Win10 (1809) PreviousMode field: ETHREAD struct's 0x232 location\n\n19\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.2.4. Loading Vulnerable Driver Modules\n\nIn order to obtain read and write permissions for the kernel memory area, the rootkit utilizes\n\nvulnerable kernel driver modules. The kernel driver module used in the attack is called ene.sys,\n\nmanufactured by \"ENE Technology\". As the details on this driver have already been discussed\n\nthoroughly in the \"2. ene.sys Analysis” chapter, an analysis of its features will be omitted.\n\nAfter verifying the infection target and checking the OS version, the rootkit generates the\n\nene.sys driver on the system path. Also, in order to execute the driver, it modified the binary\n\npath of the preregistered service.\n\nFigure 10 below shows the binary path of the Windows service registry after it has been\n\nmodified by the rootkit.\n\n⚫ Before: \\SystemRoot\\System32\\drivers\\umpass.sys\n\n⚫ After: \\SystemRoot\\System32\\drivers\\umpassmgr.sys\n\n**Figure 10. Modification of the existing Windows service registry key (umpass.sys -> umpassmgr.sys)**\n\nThe rootkit modifies the binary path, then calls the \"NtLoadDriver\" API to run the appropriate\n\nservice.\n\nFor reference, Lazarus Group not only has used the ene.sys driver but also has been found\n\nto have exploited the DELL vulnerability (CVE-2021-21551) depending on the variation of\n\n20\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\nrootkit used.\n\n**Figure 11. A case of exploiting DELL vulnerability (CVE-2021-21551)**\n\nSimilarly, if the CVE-2021-21551 vulnerability is exploited, the driver can obtain read and write\n\npermissions for the kernel memory area. This means that although only two cases of driver\n\nmodule exploitation have been identified until now, there is a potential for various drivers to\n\nbe abused to disable systems.\n\n21\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.2.5. Obtaining the Kernel DTB (Directory Table Base) Address\n\nThrough the processes above, the rootkit uses the ene.sys module to obtain read and write\n\npermissions with physical memory mapping on arbitrary kernel memory areas. However, as\n\nmemory mapping is only possible for physical memory addresses, the rootkit must know the\n\nphysical memory address of the PreviousMode field of the ETHREAD object which it\n\nultimately aims to modify.\n\n**Figure 12. ETHREAD object's PreviousMode field address information (rootkit's modification target**\n\n**value)**\n\nThe rootkit transmitted SystemExtendedHandleInformation as a function argument to the\n\n\"NtQuerySystemInformation\" API and obtained the virtual address (Figure 12) of the\n\nPreviousMode of the currently running ETHREAD object. Then, in order to convert this address\n\ninto a physical address, the rootkit implemented a code[2] that finds the DirBase value of the\n\nSystem process to directly obtain the Kernel DTB address as shown in Figure 13.\n\n2 [https://public.cnotools.studio/bring-your-own-vulnerable-kernel-driver-byovkd/utilities/loading-device-](https://public.cnotools.studio/bring-your-own-vulnerable-kernel-driver-byovkd/utilities/loading-device-driver)\n\n[driver](https://public.cnotools.studio/bring-your-own-vulnerable-kernel-driver-byovkd/utilities/loading-device-driver)\n\n22\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n**Figure 13. Code to obtain the Kernel DTB**\n\n\n23\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.2.6. Address Conversion (Virtual Address > Physical Address)\n\nThe reason the rootkit obtained the Kernel DTB (CR3 register) address of the system process\n\nis to implement a code that can directly convert the virtual address to a physical address.\n\nFigure 14 shows the process through which the Kernel DTB (CR3 register) value is used to\n\nconvert the virtual address to a physical address.\n\n3\n\n**Figure 14. Virtual address - physical address conversion process**\n\nThe rootkit implemented the process in Figure 14 into a code, and as a result, it was able to\n\ncalculate the physical address of the PreviousMode field's virtual address obtained from this\n\nprocess.\n\n3\nWindows Internals: System Architecture, Processes, Threads, Memory Management, and More, Part 1\n\n24\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n**Figure 15. Virtual address - physical address conversion code**\n\n\n25\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.2.7. Modification of the Thread Object's PreviousMode Field\n\nThe PreviousMode field is a field that verifies in the kernel whether the thread object has\n\nbeen called from the user area.\n\nThus, if this member variable is set to \"0\", one can access the kernel area even from the user\n\narea.\n\n**Figure 16. Explanation of PreviousMode - msdn**\n\nIn order to modify the PreviousMode field, the rootkit used the virtual address-physical\n\naddress conversion code and physical kernel memory mapping to change the PreviousMode\n\nfield value from \"1\" to \"0\".\n\n**Figure 17. PreviousMode modification using physical memory mapping**\n\nThe thread where the PreviousMode is set to \"0\" enters a sort of \"GOD MODE\" where through\n\nthe \"ZwWriteVirtualMemory\" API, it can access both user and kernel areas.\n\n26\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\nThe rootkit uses the \"ZwWriteVirtualMemory\" API to modify the global kernel data to\n\nultimately disable the system.\n\n**Figure 18. Example of using the \"ZwWriteVirtualMemory\" API to write to kernel area from user area**\n\n**(GOD MODE)**\n\n27\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n### 3.3. Rootkit (Security Product Disabling Stage)\n\nDisabling of security products by the rootkit is based on a whitelist system. Thus, all\n\nmonitoring systems, excluding the crucial normal system driver files, are removed. The\n\nremoval process involves using the \"ZwWriteVirtualMemory\" API to control the global kernel\n\ndata.\n\n#### 3.3.1. Disabling Mini File Filter (fltmgr.sys)\n\nDisabling of the mini file filter involves the checking of whether the callback address registered\n\nto the mini file filter (FltMgr) is included in the whitelist drivers shown in the table below. If\n\nthe registered driver is not on this driver list and the Altitude of the driver is included in\n\n\"Anti-virus, Activity-Monitor, or Content Screener altitude\", it becomes a target of disablement.\n\n\n**List of normal drivers verified for file filter**\n\n**disabling**\n\n\nscvtrig.sys\n\nfileinfo.sys\n\nafv.sys\n\ncng.sys\n\nfilecrypt.sys\n\nstorqosflt.sys\n\nbindflt.sys\n\nwcifs.sys\n\n**Table 2. Normal system drivers (whitelist)**\n\n\n28\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\nDisabling is done by modifying the object data of the filter manager (FltMgr). The modified\n\nobjects are \"_FLT_FILTER\", \"_FLT_VOLUME\", and \"_FLT_INSTANCE\".\n\n\n**Disabling _FLT_FILTER object**\n\n\nModify InstanceList field\n\n(Remove instance of the target filter)\n\n**Table 3. Method of disabling the _FLT_FILTER object**\n\n\n**_FLT_VOLUME object**\n\n\nModify InstanceList field\n\n(Remove instance of the target filter)\n\n**Table 4. Method of disabling the _FLT_VOLUME object**\n\n\n**_FLT_INSTANCE object**\n\n\nList connection link of PrimaryLink – Volume\n\n(_FLT_VOLUME)\n\nList connection link of FilterLink – Volume\n\n(_FLT_VOLUME)\n\nThe instance itself is untouched.\n\n**Table 5. Method of disabling the _FLT_INSTANCE object**\n\n\n29\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.3.2. Disabling Process/Thread/Module Detection\n\nThe kernel offers a feature to monitor whenever a process, thread, or module is newly created\n\nor loaded. Normally, this monitoring feature offered by the kernel is used to detect malware\n\nby the security products.\n\nFor example, the kernel driver calls the \"PsSetCreateProcessNotifyRoutine\" kernel API and\n\nregisters a \"callback routine\" for process monitoring. Afterward, the kernel enables the\n\nexecution of the callback routine registered by the kernel driver when a process is created.\n\nBy comparing the binary pattern of the ntoskrnl.exe process, the rootkit obtains the address\n\ninformation of the global variable shown below, where the callback routine is registered in. It\n\nthen manipulates the data of the address to remove all process/thread/module callbacks. Like\n\nin the case of file filters, disabling of the process/thread/module detection is performed based\n\non whitelist. Table 6 below shows the whitelist that the rootkit verifies.\n\n⚫ nt!PspNotifyEnableMask\n\n⚫ nt!PspLoadImageNotifyRoutine (Disables module load detection)\n\n⚫ nt!PspCreateThreadNotifyRoutine (Disables thread creation/end detection)\n\n⚫ nt!PspCreateProcessNotifyRoutine (Disables process creation/end detection)\n\n30\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n\n**List of drivers verified for process, image, and thread**\n\n**disabling**\n\n\nntoskrnl.exe\n\nahcache.sys\n\nmmcss.sys\n\ncng.sys\n\nksecdd.sys\n\ntcpip.sys\n\niorate.sys\n\nci.dll\n\ndxkrnl.sys\n\npeauth.sys\n\n**Table 6. Normal system drivers (whitelist)**\n\nThe following is an example of a thread callback routine being disabled. Before the global\n\ndata of nt!PspCreateThreadNotifyRoutine was changed, Windows Defender had been saved\n\nin the global data, but after it was disabled, all callback routines excluding a white driver\n\n(mmcss.sys) were removed.\n\n\n**<Before disabling thread callback>**\n\nfffff801`47cec3e0 ffffd60c4804baaf -> WdFilter!MpCreateThreadNotifyRoutine\n\nfffff801`47cec3e8 ffffd60c4804ba7f -> WdFilter!MpCreateThreadNotifyRoutineEx\n\nfffff801`47cec3f0 ffffd60c48de643f -> mmcss!CiThreadNotification\n\n\n**<After disabling thread callback>**\n\nfffff801`47cec3e0 ffffd60c48de643f -> mmcss!CiThreadNotification\n\nfffff801`47cec3e8 0000000000000000 -> Remove !!\n\nfffff801`47cec3f0 0000000000000000 -> Remove !!\n\n\n31\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.3.3. Disabling Registry Callback\n\nThe rootkit checks the starting byte of \"CmUnRegisterCallback\" by comparing the binary\n\npattern of the ntoskrnl.exe process. Similar to the disabling of processes/threads/modules, it\n\nmodifies the global kernel data named nt!CallbackListHead to disable the registry callback\n\nregistered on the system.\n\nAfter the registry callback is disabled, monitoring of registry-related behaviors becomes\n\nimpossible.\n\nFigures 19 and 20 below show the nt!CallbackListHead data before and after it has been\n\nmodified.\n\n**Figure 19. Before disabling registry callback**\n\n**Figure 20. After disabling registry callback**\n\nAs a result, the rootkit disabled the registry scan of security products and Windows Defender\n\nby modifying nt!CallbackListHead.\n\n32\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.3.4. Disabling Object Callback\n\nThe rootkit modified the object callback list to disable the security products' access control\n\nover process and thread objects.\n\nFirst, it acquired the starting byte address of ObGetObjectType by comparing ntoskrnl.exe\n\nbyte patterns and subsequently obtained the global data address information named\n\n\"nt!ObTypeIndexTable\". Then, among each factor saved in the table, the rootkit manipulated\n\nthe callback list for process and thread objects.\n\nFigures 21 and 22 below show callback list of the process object before and after it has been\n\nmodified.\n\n**Figure 21. Before disabling object callback**\n\n**Figure 22. After disabling object callback**\n\nBy removing the callback connection list, the rootkit was able to disable the security products'\n\naccess control over process objects.\n\n33\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.3.5. Disabling WFP Network Filter\n\nWindows Filtering Platform (WFP) is a platform offered by the kernel which enables network\n\npacket control within the application. Thus, security products can use WFP in features such\n\nas firewall and intrusion detection.\n\nThe rootkit searches the WFP driver's callout and disables the network monitoring system\n\ninstalled on the system through object flag manipulation. As in the case of mini file filters\n\nand process/image/module callback manipulation, only the flag value of the callout drivers\n\nexcluding the normal Windows driver callout is modified on a whitelist-basis.\n\n\n**List of drivers verified for network disabling**\n\n\nndu.exe\n\ntcpip.sys\n\nmpsdrv.sys\n\n**Table 7. Normal system drivers (whitelist)**\n\nThe callout search process is similar to past methods. First, the rootkit finds the starting byte\n\naddress of the “WfpProcessFlowDelete” function in NETIO.sys. After finding the\n\n\"NETIO!gwfpGlobal\" address, it circulates the callout entries and checks the names of\n\nregistered drivers.\n\nIf the callout driver is not a whitelisted driver of Table 7, the rootkit computes \"1\" with OR\n\ninto a specific byte, as shown below, to attempt to disable it.\n\n**Figure 23. Network filter disabling code**\n\n34\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.3.6. Disabling Event Tracing\n\nWindows offers the feature to record and trace various events that occur in the kernel and\n\nuser areas. These events are used in security products such as EDR and help trace behaviors\n\nof malware.\n\nThe rootkit disabled relevant handles and variables to disable event tracing. The disabling\n\nmethod is similar to the past methods. Through the internal ntoskrnl.exe binary pattern\n\ncomparison, the rootkit found the starting address of \"EtwRegister\" function and obtained\n\nthe registered handle information as shown below. Then, it filled all addresses where handle\n\nvalues were saved to with \"NULL\", disabling handle information.\n\n\n**<Saved address of ETW event handles>**\n\nFFFFF80147C19990 ; nt!EtwpEventTracingProvRegHandle\n\nFFFFF80147C19780 ; nt!EtwKernelProvRegHandle\n\nFFFFF80147C19940 ; nt!EtwpPsProvRegHandle\n\nFFFFF80147C19938 ; nt!EtwpNetProvRegHandle\n\nFFFFF80147C19930 ; nt!EtwpDiskProvRegHandle\n\nFFFFF80147C19928 ; nt!EtwpFileProvRegHandle\n\n…\n\nFFFFF80147C19968 ; nt!EtwSecurityMitigationsRegHandle\n\n\nAside from these, it found the address of nt!EtwpHostSiloState, a global kernel data, and\n\nmodified the 4 byte value at a 0x1080 offset distance from the address to 0x0 to disable the\n\nevent tracing related variables.\n\n\n**<Before disabling nt!EtwpHostSiloState>**\n\nffffd60c`469d4080 0001230500000006\n\nffffd60c`469d4088 0000000000004080\n\n\n35\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n\n**<After disabling nt!EtwpHostSiloState>**\n\nffffd60c`469d4080 0001230500000000 > Modified !!\n\nffffd60c`469d4088 0000000000004080\n\n\nThe offset that the rootkit modifies at the \"nt!EtwpHostSiloState\" address is different for each\n\nWindows OS version as described in \"3.2.3. Checking OS Version\".\n\n⚫ Offset when infection target is Windows Server 2022: 0x1088\n\n⚫ Offset when infection target is Windows 11: 0x1098\n\n⚫ Offset for all other OS: 0x1080\n\n**Figure 24. Offset information saved to the memory space of each OS**\n\n36\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n#### 3.3.7. Disabling Windows Prefetch File Creation\n\nWindows prefetch is a feature offered in Windows XP and later OS versions. This feature\n\nenables Windows to save data required for starting up and for running programs on the\n\nmemory, speeding up the boot time and reducing the time needed to run programs.\n\nAside from performance, prefetch is very useful for forensics. Upon a security incident, the\n\nanalyzer can use prefetch to find the execution time of applications and necessary factors in\n\nanalyzing the timeline, including the number of times the application was executed, and the\n\nlast execution time.\n\n**Figure 25. Windows prefetch information (WinPrefetchView program by Nirsoft)**\n\nIn order to disable Windows prefetch tracing, the rootkit modified the\n\n“nt!PfSnNumActiveTraces” kernel global variable value to “0xFFFFFF”, stopping the system\n\nfrom generating any further Windows prefetch files.\n\nAn operating system with an active prefetch tracing feature attempts to create a prefetch file\n\nwhenever a program is executed internally, through an API call routine shown below.\n\n\n**<Kernel function call routine for prefetch creation>**\n\n\nPfPorcessCreateNotification -> PfSnBeginAppLaunch -> PfSnBeginScenario ->\n\nPfSnBeginTrace -> PfSnActivateTrace -> PfSnAddProcessTrace\n\n\n37\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\nThe rootkit forcibly modifies the value (“nt!PfSnNumActiveTraces”) verified in the code in\n\nFigure 26 below to “0xFFFFFF”, instantly stopping the “PfSnBeginTrace” function and\n\npreventing future kernel function calls for prefetch creation.[4]\n\n**Figure 26. Windows prefetch creation verifying code (PfSnNumActiveTraces)**\n\n4 https://www.virusbulletin.com/uploads/pdf/conference/vb2022/VB2022-Kalnai-Havranek.pdf\n\n38\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n## AhnLab Response Overview\n\nThe alias and the engine version information of AhnLab products are shown below.\n\n**[File Detection]**\n\nTrojan/Win.Lazardoor.C5157217 (2022.06.04.01)\n\nRootkit/Win.Agent.C5192169 (2022.07.04.02)\n\nRootkit/Win.Agent.C5177679 (2022.06.23.00)\n\n**[Behavior Detection]**\n\nInitialAccess/MDP.Event.M4419 (2022.09.21.01)\n\nInitialAccess/MDP.Event.M4422 (2022.08.08.02)\n\nAlthough the activities of this threat group have been announced recently, some of their\n\nmalware was being diagnosed in AhnLab products. The ASEC team tracked the activities of\n\nthe identified group and responded to the malware, but there may be variants that have not\n\nbeen detected yet.\n\n39\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n## Conclusion\n\nThe Lazarus Group used vulnerable drivers in the APT attack process to disable all internal\n\nmonitoring systems. There are currently two vulnerable drivers that have been identified, but\n\nit is expected that cases of abuse will increase as there are many more normally-signed\n\nvulnerable drivers.\n\nEver since the DSE (Driver Signature Enforcement) policy was applied from Windows Vista,\n\nattacks using rootkit seemed to decrease, however, BYOVD (Bring Your Own Vulnerable Driver)\n\nattack cases have been continuously identified since 2014. The BYOVD attacks until now were\n\nknown as acts of abuse for privilege escalation, but as can be seen in this case, Lazarus Group\n\nis the first to design an elaborate rootkit to disable all systems from the old Windows 7 to\n\nthe most recent OS, Windows Server 2022.\n\nIn order to respond to BYOVD attacks, Microsoft has been blocking unauthorized drivers\n\nfrom being loaded based on the block rules[5] in Window 10’s hypervisor code integrity (HVCI)\n\nmode and S mode. As such, the best method of prevention for this type of attack at the\n\nmoment seems to be strictly blocking drivers from being loaded.\n\nThus, corporate security managers must restrict drivers from being loaded in normal user\n\nenvironments and update security software to the latest version to prevent APT attacks that\n\nuse BYOVD.\n\n5 [https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules)\n\n[control/microsoft-recommended-driver-block-rules](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules)\n\n40\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n## IoC (Indicators of Compromise)\n\n### File path and name\n\nThe file paths and names used by the malware are as follows. Some may be identical to the\n\nnames of normal files.\n\n**[Rootkit loader]**\n\n⚫ %SystemRoot%\\Comms.bin\n\n⚫ %SystemRoot%\\miblib.bin\n\n**[Rootkit]**\n\n⚫ %SystemRoot%\\miblib.dat\n\n⚫ %SystemRoot%\\temp\\~bit353.tmp\n\n⚫ %SystemRoot%\\bf.dat\n\n**[Rootkit related module] – SB_SMBUS_SDK.dll**\n\n⚫ %USERPROFILE%\\appdata\\local\\temp\\1b6955_sb_smbus_sdk.dll\n\n⚫ %SystemRoot%\\temp\\206778_sb_smbus_sdk.dll\n\n⚫ %SystemRoot%\\temp\\4018a066_sb_smbus_sdk.dll\n\n⚫ %SystemRoot%\\temp\\6d0b88f_sb_smbus_sdk.dll\n\n⚫ %SystemRoot%\\temp\\4ab916_sb_smbus_sdk.dll\n\n⚫ %SystemRoot%\\temp\\18532412_sb_smbus_sdk.dll\n\n⚫ %SystemDrive%\\users\\%ASD%\\appdata\\local\\temp\\9e1126_sb_smbus_sdk.dll\n\n### File hashes (MD5)\n\nThe MD5 of the related files are as follows. (However, it is omitted if there is a sensitive\n\nsample.)\n\n41\n\n\n-----\n\nAnalysis Report on Lazarus Group's Rootkit Malware\n\n**[Rootkit loader]**\n\n⚫ 013b4c4e9387d8fe1eab738c42c451da\n\n**[Rootkit]**\n\n⚫ 98e58a39ede26af7980ed4de2873caab\n\n⚫ a6e309f97ffada2d4d0d4aecfb255a91\n\n**[Rootkit related module] – SB_SMBUS_SDK.dll**\n\n⚫ c40643751b426dec01bd390e192b4542\n\n## References\n\n[1] [https://swapcontext.blogspot.com/2020/08/ene-technology-inc-vulnerable-drivers.html](https://swapcontext.blogspot.com/2020/08/ene-technology-inc-vulnerable-drivers.html)\n\n[[2]https://public.cnotools.studio/bring-your-own-vulnerable-kernel-driver-byovkd/utilities/loading-device-driver](https://public.cnotools.studio/bring-your-own-vulnerable-kernel-driver-byovkd/utilities/loading-device-driver)\n\n[3] Windows Internals: System Architecture, Processes, Threads, Memory Management, and More, Part 1\n\n[[4]https://www.amazon.com/Windows-Internals-Part-architecture-management-ebook-dp-](https://www.amazon.com/Windows-Internals-Part-architecture-management-ebook-dp-B0711FDMRR/dp/B0711FDMRR/ref=mt_other?_encoding=UTF8&me=&qid=)\n\n[B0711FDMRR/dp/B0711FDMRR/ref=mt_other?_encoding=UTF8&me=&qid=](https://www.amazon.com/Windows-Internals-Part-architecture-management-ebook-dp-B0711FDMRR/dp/B0711FDMRR/ref=mt_other?_encoding=UTF8&me=&qid=)\n\n[5] https://www.virusbulletin.com/uploads/pdf/conference/vb2022/VB2022-Kalnai-Havranek.pdf\n\n42\n\n\n-----\n\nAhnLab Cyber Threat Intelligence Report\n\nAhnLab, Inc.\n\n220 Pangyoyeok-ro, Bundang-gu, Seongnam-si, Gyeonggi-do (P) 13493\n\nTel: 031-722-8000  | Purchase Inquiry: 1588-3096  |  Fax: 031-722-8901\n\nwww.ahnlab.com\n\nThis report is a work of authorship protected by the Copyright Act. Unauthorized copying or reproduction for profit is\n\nstrictly prohibited.\n\nWhen citing or editing the entirety or a part of the report, you must disclose that this is a report published by AhnLab\n\n     - If you have any inquiries about the information about the report or its distribution, please contact AhnLab (031-722-\n\n8000).\n\nThis report can be viewed at https://atip.ahnlab.com.\n\n© AhnLab, Inc. All rights reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        }
    ],
    "references": [
        "https://download.ahnlab.com/global/brochure/Analysis-Report-on-Lazarus-Groups-Rootkit-Attack-Using-BYOVD.pdf"
    ],
    "report_names": [
        "Analysis-Report-on-Lazarus-Groups-Rootkit-Attack-Using-BYOVD.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1709863609,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1665048012,
    "ts_modification_date": 1665048012,
    "files": {
        "pdf": "https://archive.orkl.eu/e068b70ef67160b37b71409aa342bf640588ef0c.pdf",
        "text": "https://archive.orkl.eu/e068b70ef67160b37b71409aa342bf640588ef0c.txt",
        "img": "https://archive.orkl.eu/e068b70ef67160b37b71409aa342bf640588ef0c.jpg"
    }
}