{
    "id": "39833ad2-1d71-4131-be63-01cffde75eb1",
    "created_at": "2023-01-12T15:09:06.19666Z",
    "updated_at": "2025-03-27T02:09:17.783447Z",
    "deleted_at": null,
    "sha1_hash": "ce9c5ebd873654f2d0cd0392aeab4ca8664eced7",
    "title": "2021-05-12 - Conti Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T18:03:48Z",
    "file_modification_date": "2022-05-28T18:03:48Z",
    "file_size": 3140595,
    "plain_text": "# Conti Ransomware\n\n**thedfirreport.com/2021/05/12/conti-ransomware/**\n\n## Introduction\n\n\nMay 12, 2021\n\n\n### First seen in May 2020, Conti ransomware has quickly become one of the most common ransomware variants, according to Coveware. As per Coveware‚Äôs Quarterly Ransomware Report (Q1 2021), Conti has the 2nd highest market share after Sodinokibi, which we wrote about here.\n\n In April, we saw a threat actor go from an initial IcedID infection to deploying Conti ransomware domain wide in two days and 11 hours. The threat actors stayed dormant for most of this time, before jumping into action on an early Saturday morning. The hands on keyboard activity lasted for two and a half hours. They utilized RDP, PsExec, and Cobalt Strike to move laterally within the environment before executing Conti in memory across all active systems.\n\n## Summary\n\n### We assess with moderate confidence that the initial vector used by the threat actor was a zip file, which included a malicious JavaScript file, delivered through a phishing campaign. The JavaScript file would eventually download and execute the IcedID malware. Discovered in 2017, what started as a commodity malware is now currently being deployed as an initial access broker by ransomware threat actors. \n\n While there was some initial discovery activity from the IcedID malware, it went quiet, just beaconing to command and control but not performing any other activity. After being dormant for over two days, a Cobalt Strike Beacon was dropped and executed on the system infected with IcedID The threat actors then ran another round of discovery activity with native\n\n\n-----\n\n### windows utilities such as nltest.exe, whoami.exe, and net.exe. They then successfully escalated to SYSTEM privileges via Cobalt Strike‚Äôs built-in ‚Äúnamed pipe impersonation‚Äù (GetSystem) functionality.  \n\n The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon. During that time, we observed port scanning activity from one of the domain controllers, to identify open ports such as SSH, SMB, MSSQL, RDP and WinRM. After a brief gap of 15 minutes, the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.\n\n Later in the attack, the threat actor was seen establishing RDP connections from the beachhead host to the domain controller and other systems throughout the environment. This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.\n\n To establish persistence, the attackers created a new local user on one of the domain controllers and added it to the Administrators group. Additionally, in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender via a group policy modification.\n\n Within two and a half hours of Cobalt Strike showing up in the environment and just over two days after the initial IcedID infection, the threat actors completed their objective of encrypting all systems. Conti was executed in memory with the help of the Cobalt Strike Beacons domain wide. The ransomware note left by the infection included a link to their Tor site for further details.\n\n After further review of the environment (post encryption), we realized multiple systems (including a domain controller) were unable to be accessed and would not have been restorable even if the ransom had been paid.\n\n## Services\n\n### We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found here.\n\n We also have artifacts available from this case such as pcaps, memory captures, files, Kape packages, and more, under our Security Researcher and Organization services.\n\n## Timeline\n\n\n-----\n\n-----\n\n### Analysis and reporting completed by @pigerlin, @MetallicHack, @yatinwad, and 1 unnamed contributor.\n\n Reviewed by @kostastsale, @RoxpinTeddy, and @TheDFIRReport\n\n## MITRE ATT&CK\n\n Initial Access\n\n### The IcedID DLL that we executed was most likely dropped through a zip file, which included a JavaScript file within it. Brad had a few posts about these around the time of this intrusion. 1 2 Thanks Brad!\n\n Various attributes including the computer name and the OS version of the compromised system were sent through encoded cookie values.\n\n IcedID was executed via rundll32.exe and ran command and control over port 443 for the duration of the intrusion.\n```\nrundll32.exe \"C:\\Users\\REDACTED\\AppData\\Local\\Temp\\rate_x32.dat\",update\n/i:\"LaborBetray\\license.dat\"\n\n## Discovery\n\n```\n\n-----\n\n### IcedID ran initial discovery after being executed on the beachhead. Various commands were executed to gather more information about the compromised environment; including the currently logged on user, domain trusts, groups, etc .\n```\nipconfig /all\nsysteminfo\nwhoami /groups\nnet config workstation \nnltest /domain_trusts \nnltest /domain_trusts /all_trusts\nnet view /all /domain\nnet view /all\nnew group \"Domain Admins\" /domain\n\n Additional discovery commands were executed by Cobalt Strike.\n\n```\n\n-----\n\n```\ncmd.exe /C whoami /groups\ncmd.exe /C query session\ncmd.exe /C dir %HOMEDRIVE%%HOMEPATH%\ncmd.exe /C nltest /domain_trusts\ncmd.exe /C nltest /dclist:\ncmd.exe /C net group \"Enterprise admins\" /domain\ncmd.exe /C net group \"Domain admins\" /domain\n\n### After moving laterally to a domain controller, they began looking for what networks were present in the environment using dsquery.\ncmd.exe /C dsquery subnet -limit 0\n\n Shortly thereafter, port scanning was observed coming from a domain controller looking for common ports (such as SSH, SMB, MSSQL, WinRM and RDP, etc.) on systems residing in the same subnet.\n\n## Privilege Escalation\n\n### In order to obtain SYSTEM level privileges, Cobalt Strike‚Äôs built-in named piped impersonation (GetSystem) was used:\nImage: ‚ÄúC:\\Windows\\System32\\cmd.exe‚Äù\nCommandLine: ‚ÄúC:\\Windows\\system32\\cmd.exe /c echo 4d64fbbbf34 > \\\\.\\pipe\\b4312c‚Äù\nParentImage: ‚ÄúC:\\Windows\\System32\\runonce.exe‚Äù\nParentCommandLine: ‚ÄúC:\\Windows\\system32\\runonce.exe\"\n\n## Lateral Movement\n\n### The threat actor began lateral movement using remote execution of Cobalt Strike Beacon service binaries.\nImage: C:\\Windows\\system32\\services.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\d8d6deb\\ImagePath\nDetails: \\\\HOSTNAME\\ADMIN$\\d8d6deb.exe\n\n```\n\n-----\n\n### After this initial activity, Cobalt Strike was used to enable RDP, and allow it through the firewall, on the domain controllers.\n```\ncmd.exe /C reg add \"hklm\\system\\currentControlSet\\Control\\Terminal Server\" /v\n\"fDenyTSConnections\" /t REG_DWORD /d 0x0 /f\ncmd.exe /C netsh firewall set service type = remotedesktop mode = enable\ncmd.exe /C netsh firewall set rule group=\"remote desktop\" new enable=Yes\ncmd.exe /C netsh advfirewall set rule group=\"remote desktop\" new enable=Yes\n\n Following this, the threat actors then copied a Cobalt Strike Beacon DLL to the ADMIN$ share; and then, distributed it throughout the environment using PsExec.\ncmd.exe /C copy 192145.dll \\\\<INTERNAL_IP>\\ADMIN$ /Y /Z\npsexec.exe -accepteula -d -s \\\\<INTERNAL_IP> rundll32.exe\nC:\\windows\\192145.dll,StartW\n\n```\n\n-----\n\n### From here, RDP connections were established from the beachhead host to systems throughout the environment. The connections were proxied through the IcedID process.\n\n The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed through the IcedID process. The below traffic shows more details of the RDP session, including the username in the cookie.\n\n\n-----\n\n### This proxied traffic reported back the hostname of the threat actors machine as ‚Äúmikespc‚Äù. We‚Äôre looking for you Mike! üòâ\n\n## Defense Evasion\n\n### To evade detection, the threat actors disabled Windows Defender by adding the below to an already linked GPO. They then force updated the GPO on all clients using Cobalt Strike.\n\n\n-----\n\n### ParentCommandLine CommandLine\n\n C:\\Windows\\System32\\dllhost.exe C:\\Windows\\system32\\cmd.exe /C gpupdate /force\n\n C:\\Users\\USER\\AppData\\Local\\Temp\\icju1.exe C:\\Windows\\system32\\cmd.exe /C gpupdate /force\n\n C:\\Windows\\System32\\dllhost.exe C:\\Windows\\system32\\cmd.exe /C gpupdate /force\n\n ‚Äúrundll32.exe‚Äù c:\\windows\\192145.dll,StartW C:\\Windows\\system32\\cmd.exe /C gpupdate /force\n\n Registry Keys Action\n\n\n### HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware\n\n HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableRealtimeMonitoring\n\n HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableBehaviorMonitoring\n\n HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableIntrusionPreventionSystem\n\n HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\n\n In addition, other security services were stopped or uninstalled.\n```\nNET STOP \"redacted\"\nEventID: 13\nDescription: RegistryEvent (Value Set)\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\<redacted>\\Start\nValue: DWORD (0x00000004)\n\n## Command and Control\n\n### IcedID\n\n 68.183.20[.]194:80\n vaclicinni[.]xyz\n\n 83.97.20[.]160:443\n oxythuler[.]cyou\n expertulthima[.]club\n\n```\n\n### DeleteValue\n\n DeleteValue\n\n DeleteValue\n\n DeleteValue\n\n DeleteKey\n\n\n-----\n\n### dictorecovery[.]cyou thulleultinn[.]club\n```\nKey identifier: 82:92:07:FD:86:23:FE:26:0E:4A:42:5A:F7:C7:70:2A:45:4E:01:5B\nNot Before: Apr 22 15:27:02 2021 GMT \nNot After : Apr 22 15:27:02 2022 GMT \nCommonName: localhost\nCity= AU\nState= Some-State\nOrg = Internet Widgits Pty Ltd\nja3: a0e9f5d64349fb13191bc781f81f42e1\nja3s: ec74a5c51106f0419184d0dd08fb05bc\n\n 159.89.140[.]116:443 oxythuler[.]cyou thulleultinn[.]club\nKey Identifier: A4:EB:95:C2:04:91:E3:AF:67:7C:5D:B3:CB:DB:E3:38:90:5E:A7:68\nNot Before: Apr 13 14:59:41 2021 GMT\nNot After : Apr 13 14:59:41 2022 GMT\nCommonName: localhost\nCity= AU\nState= Some-State\nOrg = Internet Widgits Pty Ltd\nja3: a0e9f5d64349fb13191bc781f81f42e1\nja3s: ec74a5c51106f0419184d0dd08fb05bc\n\n Cobalt Strike 192.99.178[.]145:80 dimentos[.]com\n\n Config:\n\n```\n\n-----\n\n```\nPort 443:\n\"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce[.]exe\",\n\"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce[.]exe\",\n\"Jitter\": 39,\n\"Method 2\": \"POST\", \"Port\": 443,\n\"Beacon Type\": \"8 (HTTPS)\",\n\"Polling\": 62719,\n\"HTTP Method Path 2\": \"/btn_bg\",\n\"Method 1\": \"GET\",\n\"C2 Server\": \"dimentos[.]com,/FAQ\"\n\"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce[.]exe\",\n\"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce[.]exe\",\n\"Jitter\": 39,\n\"Method 2\": \"POST\",\n\"Port\": 443,\n\"Beacon Type\": \"8 (HTTPS)\",\n\"Polling\": 62719,\n\"HTTP Method Path 2\": \"/btn_bg\",\n\"Method 1\": \"GET\",\n\"C2 Server\": \"dimentos[.]com,/bg\"\nPort 80:\n\"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce[.]exe\",\n\"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce[.]exe\",\n\"Jitter\": 39,\n\"Method 2\": \"POST\",\n\"Port\": 80,\n\"Beacon Type\": \"0 (HTTP)\",\n\"Polling\": 62719,\n\"HTTP Method Path 2\": \"/btn_bg\",\n\"Method 1\": \"GET\",\n\"C2 Server\": \"192[.]99[.]178[.]145,/r-arrow\"\n\"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce[.]exe\",\n\"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce[.]exe\",\n\"Jitter\": 39,\n\"Method 2\": \"POST\",\n\"Port\": 80,\n\"Beacon Type\": \"0 (HTTP)\",\n\"Polling\": 62719,\n\"HTTP Method Path 2\": \"/btn_bg\",\n\"Method 1\": \"GET\",\n\"C2 Server\": \"192[.]99[.]178[.]145,/bg\"\n\n### Machine beaconing out to Cobalt Strike using the above profile\n\n```\n\n-----\n\n## Persistence\n\n### An account named ‚Äúnuuser‚Äù was created by one of the Cobalt Strike Beacons. As these commands were run on a domain controller, it essentially added the account to the Built-in Administrators domain group, granting it administrative privileges in the AD domain.\n```\nnet user /add /Y nuuser [email protected]\nnet localgroup administrators nuuser /add\n\n```\n\n-----\n\n## Credential Access\n\n### LSASS was accessed by an unusual process ‚Äúrunonce.exe‚Äù on multiple hosts, including a domain controller.\n```\nEventID: 10\nDescription: Process Access\nSourceImage: ‚ÄúC:\\Windows\\System32\\runonce.exe‚Äù\nTargetImage: ‚ÄúC:\\Windows\\system32\\lsass.exe‚Äù\nSourceImage: C:\\Windows\\system32\\runonce.exe\"\nTargetImage: \"C:\\Windows\\system32\\lsass.exe\"\nGrantedAccess: 0x1010\nCallTrace:\n\"C:\\Windows\\SYSTEM32\\ntdll.dll+9c584|C:\\Windows\\System32\\KERNELBASE.dll+2730e|UNKNOWN(\n\n The overpass-the hash technique was used to acquire a valid Kerberos ticket for the administrator user.\n\n```\n\n-----\n\n## Impact\n\n### About two and a half hours after initial hands on keyboard activity, the Cobalt Strike Beacon processes running across the target systems injected the Conti DLL into memory. Conti deployments using a DLL seem to have first started showing up in December 2020.\n\n First time that I see #Conti ransomware spread as a DLL :\n Hash : 5c278c04bb19196dc8559d45b9728b3ba0c1bc5cdd20a766f56248e561c6f5a6\n Pdb : A:sourceconti_v3x64Releasecryptor_dll.pdb\n (cc @GrujaRS @malwrhunterteam ) pic.twitter.com/gH3uCpVMpB\n\n ‚Äî The Brofessor (@Glacius_) December 8, 2020\n\n Some traces of this particular DLL were found in the memory dump taken from one of the compromised systems.\n\n\n-----\n\n### We were unable to reconstruct the DLL from memory but Maxime Thiebaut (@0xThiebaut) from NVISO helped us out. The Yara rule, located in the detections section below was made possible due to him reconstructing the DLL. Thanks Maxime!\n\n Conti scans the network for 445/SMB, looking for machines to encrypt.\n\n Ransom note\n\n Which leads you here.\n\n\n-----\n\n### The threat actors asked for 150k and could have been talked down at least ~20%.\n\n Multiple machines within the environment were not usable after being ransomed including a domain controller. The machines were left like this and you were not able to do anything but press control+alt+delete. Paying the ransom will not help you here.\n\n## Pivots\n\n### While researching the infrastructure related to this campaign, we found the threat actor revealed further infrastructure. The domain associated with the Cobalt Strike C2 (dimentos[.]com) has an unredacted Whois record that reveals several other domains also registered by the address pokix19891[@]kindbest[.]com. You‚Äôll notice the fake address and fake phone number as well.\n\n\n-----\n\n### All the domains were registered on 2021-03-30, and according to public data available in VirusTotal, three of them have been associated with Cobalt Strike infrastructure so far; the domain seen in this intrusion, powelin[.]com and awesents[.]com.\n\n\n-----\n\n### The two other domains (jocinet[.]com, ilimennt[.]com) have subdomains that look like name servers (ns1 and ns2), which were pointed to two of the Cobalt Strike hosting IP‚Äôs. All of this infrastructure was hosted on the VPS provider OVH.\n\n## IOCs\n\n### Files\n```\nb52c0640957e5032b5160578f8cb99f9b066fde4f9431ee6869b2eea67338f28.dll.exe \nb52c0640957e5032b5160578f8cb99f9b066fde4f9431ee6869b2eea67338f28 \nicju1.exe \ne54f38d06a4f11e1b92bb7454e70c949d3e1a4db83894db1ab76e9d64146ee06 \nrate_x32.dat \neb79168391e64160883b1b3839ed4045b4fd40da14d6eec5a93cfa9365503586\n192145.dll \nf29bc338e63a62c24c301c04961084013816733dad446a29c20d4413c5c818af9\n\n Network\n\n IcedID\n vaclicinni[.]xyz \n thulleultinn[.]club\n oxythuler[.]cyou\n dictorecovery[.]cyou\n expertulthima[.]club\n\n```\n\n-----\n\n### 68.183.20[.]194:80 159.89.140[.]116:443 83.97.20[.]160:443\n\n Cobalt Strike dimentos[.]com 192.99.178[.]145:80\n\n Proxy 38.135.122[.]194:8080\n\n## Detections\n\n### Suricata\n ET MALWARE Win32/IcedID Requesting Encoded Binary M4\n ET MALWARE W32/Photoloader.Downloader Request Cookie\n ET POLICY PE EXE or DLL Windows file download HTTP\n ET INFO Executable Retrieved With Minimal HTTP Headers ‚Äì Potential Second Stage Download\n ET INFO Packed Executable Download\n ET POLICY OpenSSL Demo CA ‚Äì Internet Widgits Pty\n ATTACK [PTsecurity] Overpass the hash. Encryption downgrade activity to ARCFOUR- HMAC-MD5\n ET SCAN Behavioral Unusual Port 135 traffic Potential Scan or Infection\n ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection\n ET SCAN Behavioral Unusual Port 1434 traffic Potential Scan or Infection\n ET SCAN Behavioral Unusual Port 1435 traffic Potential Scan or Infection\n\n Sigma\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_meterpreter_or_co baltstrike_getsystem_service_installation.yml\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_c ommands_recon_activity.yml\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/other/win_defender_disabled. yml\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/other/win_tool_psexec.yml\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/sysmon_in_ memory_assembly_execution.yml\n\n\n-----\n\n### https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/sysmon_ rundll32_net_connections.yml\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_net_us er_add.yml\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_psexes vc_start.yml\n\n https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_p sexec_eula.yml\n\n Sigma Rule Converter for SIEMs and EDRs: https://uncoder.io/\n\n YARA\n\n\n-----\n\n```\n/\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2021-05-09\nIdentifier: 3584\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule icedid_rate_x32 {\nmeta:\ndescription = \"files - file rate_x32.dat\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-05-09\"\nhash1 = \"eb79168391e64160883b1b3839ed4045b4fd40da14d6eec5a93cfa9365503586\"\nstrings:\n$s1 = \"UAWAVAUATVWSH\" fullword ascii\n$s2 = \"UAWAVVWSPH\" fullword ascii\n$s3 = \"AWAVAUATVWUSH\" fullword ascii\n$s4 = \"update\" fullword ascii /* Goodware String - occured 207 times */\n$s5 = \"[email protected]@YAHXZ\" fullword ascii\n$s6 = \"[email protected]@YAHXZ\" fullword ascii\n$s7 = \"PluginInit\" fullword ascii\n$s8 = \"[]_^A\\\\A]A^A_\" fullword ascii\n$s9 = \"e8[_^A\\\\A]A^A_]\" fullword ascii\n$s10 = \"[_^A\\\\A]A^A_]\" fullword ascii\n$s11 = \"Kts=R,4iu\" fullword ascii\n$s12 = \"mqr55c\" fullword ascii\n$s13 = \"R,4i=Bj\" fullword ascii\n$s14 = \"Ktw=R,4iu\" fullword ascii\n$s15 = \"Ktu=R,4iu\" fullword ascii\n$s16 = \"Kt{=R,4iu\" fullword ascii\n$s17 = \"KVL.Mp\" fullword ascii\n$s18 = \"Kt|=R,4iu\" fullword ascii\n$s19 = \"=8c[Vt8=\" fullword ascii\n$s20 = \"Ktx=R,4iu\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 700KB and\n( pe.imphash() == \"15787e97e92f1f138de37f6f972eb43c\" and ( pe.exports(\"\n[email protected]@YAHXZ\") and pe.exports(\"[email protected]@YAHXZ\") and\npe.exports(\"PluginInit\") and pe.exports(\"update\") ) or 8 of them )\n}\nrule conti_cobaltstrike_192145 {\nmeta:\ndescription = \"files - file 192145.dll\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-05-09\"\nhash1 = \"29bc338e63a62c24c301c04961084013816733dad446a29c20d4413c5c818af9\"\nstrings:\n\n```\n\n-----\n\n```\n$x1 cmd.exe /c echo NGAtoDgLpvgJwPLEPFdj>\\ %s\\ &exit fullword ascii\n$s2 = \"veniamatquiest90.dll\" fullword ascii\n$s3 = \"Quaerat magni assumenda nihil architecto labore ullam autem unde temporibus\nmollitia illum\" fullword ascii\n$s4 = \"Quaerat tempora culpa provident\" fullword ascii\n$s5 = \"Velit consequuntur quisquam tempora error\" fullword ascii\n$s6 = \"Quo omnis repellat ut expedita temporibus eius fuga error\" fullword ascii\n$s7 = \"Dolores ullam tempora error distinctio ut natus facere quibusdam\" fullword\nascii\n$s8 = \"Corporis minima omnis qui est temporibus sint quo error magnam\" fullword ascii\n$s9 = \"Officia sit maiores deserunt nobis tempora deleniti aut et quidem fugit\"\nfullword ascii\n$s10 = \"Rerum tenetur sapiente est tempora qui deserunt\" fullword ascii\n$s11 = \"Sed nulla quaerat porro error excepturi\" fullword ascii\n$s12 = \"Aut tempore quo cumque dicta ut quia in\" fullword ascii\n$s13 = \"Doloribus commodi repudiandae voluptates consequuntur neque tempora ut neque\nnemo ad ut\" fullword ascii\n$s14 = \"Tempore possimus aperiam nam mollitia illum hic at ut doloremque\" fullword\nascii\n$s15 = \"Dolorum eum ipsum tempora non et\" fullword ascii\n$s16 = \"Quas alias illum laborum tempora sit est rerum temporibus dicta et\" fullword\nascii\n$s17 = \"Et quia aut temporibus enim repellat dolores totam recusandae repudiandae\"\nfullword ascii\n$s18 = \"Sed velit ipsa et dolor tempore sunt nostrum\" fullword ascii\n$s19 = \"Veniam voluptatem aliquam et eaque tempore tenetur possimus\" fullword ascii\n$s20 = \"Possimus suscipit placeat dolor quia tempora voluptas qui fugiat et\naccusantium\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"5cf3cdfe8585c01d2673249153057181\" and pe.exports(\"StartW\") or ( 1\nof ($x*) or 4 of them ) )\n}\nrule conti_cobaltstrike_icju1 {\nmeta:\ndescription = \"files - file icju1.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-05-09\"\nhash1 = \"e54f38d06a4f11e1b92bb7454e70c949d3e1a4db83894db1ab76e9d64146ee06\"\nstrings:\n$x1 = \"cmd.exe /c echo NGAtoDgLpvgJwPLEPFdj>\\\"%s\\\"&exit\" fullword ascii\n$s2 = \"veniamatquiest90.dll\" fullword ascii\n$s3 = \"Quaerat magni assumenda nihil architecto labore ullam autem unde temporibus\nmollitia illum\" fullword ascii\n$s4 = \"Quaerat tempora culpa provident\" fullword ascii\n$s5 = \"Velit consequuntur quisquam tempora error\" fullword ascii\n$s6 = \"Quo omnis repellat ut expedita temporibus eius fuga error\" fullword ascii\n$s7 = \"Dolores ullam tempora error distinctio ut natus facere quibusdam\" fullword\nascii\n$s8 = \"Corporis minima omnis qui est temporibus sint quo error magnam\" fullword ascii\n$s9 = \"Officia sit maiores deserunt nobis tempora deleniti aut et quidem fugit\"\nfullword ascii\n$s10 = \"Rerum tenetur sapiente est tempora qui deserunt\" fullword ascii\n\n```\n\n-----\n\n```\n$s11 Sed nulla quaerat porro error excepturi fullword ascii\n$s12 = \"Aut tempore quo cumque dicta ut quia in\" fullword ascii\n$s13 = \"Doloribus commodi repudiandae voluptates consequuntur neque tempora ut neque\nnemo ad ut\" fullword ascii\n$s14 = \"Tempore possimus aperiam nam mollitia illum hic at ut doloremque\" fullword\nascii\n$s15 = \"Dolorum eum ipsum tempora non et\" fullword ascii\n$s16 = \"Quas alias illum laborum tempora sit est rerum temporibus dicta et\" fullword\nascii\n$s17 = \"Et quia aut temporibus enim repellat dolores totam recusandae repudiandae\"\nfullword ascii\n$s18 = \"Sed velit ipsa et dolor tempore sunt nostrum\" fullword ascii\n$s19 = \"Veniam voluptatem aliquam et eaque tempore tenetur possimus\" fullword ascii\n$s20 = \"Possimus suscipit placeat dolor quia tempora voluptas qui fugiat et\naccusantium\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"a6d9b7f182ef1cfe180f692d89ecc759\" or ( 1 of ($x*) or 4 of them ) )\n}\nrule conti_v3 {\nmeta:\ndescription = \"conti_yara - file conti_v3.dll\"\nauthor = \"pigerlin\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-05-09\"\nhash1 = \"8391dc3e087a5cecba74a638d50b771915831340ae3e027f0bb8217ad7ba4682\"\nstrings:\n$s1 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s2 = \"conti_v3.dll\" fullword ascii\n$s3 = \" <requestedExecutionLevel level='asInvoker' uiAccess='false' />\" fullword\nascii\n$s4 = \" Type Descriptor'\" fullword ascii\n$s5 = \"operator co_await\" fullword ascii\n$s6 = \" <trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\\\">\" fullword ascii\n$s7 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s8 = \" Base Class Descriptor at (\" fullword ascii\n$s9 = \" Class Hierarchy Descriptor'\" fullword ascii\n$s10 = \" Complete Object Locator'\" fullword ascii\n$s11 = \" delete[]\" fullword ascii\n$s12 = \" </trustInfo>\" fullword ascii\n$s13 = \"__swift_1\" fullword ascii\n$s15 = \"__swift_2\" fullword ascii\n$s19 = \" delete\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 700KB and\nall of them\n}\nrule conti_cobaltstrike_192145_icju1_0 {\nmeta:\n\n```\n\n-----\n\n```\ndescription files from files 192145.dll, icju1.exe\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-05-09\"\nhash1 = \"29bc338e63a62c24c301c04961084013816733dad446a29c20d4413c5c818af9\"\nhash2 = \"e54f38d06a4f11e1b92bb7454e70c949d3e1a4db83894db1ab76e9d64146ee06\"\nstrings:\n$x1 = \"cmd.exe /c echo NGAtoDgLpvgJwPLEPFdj>\\\"%s\\\"&exit\" fullword ascii\n$s2 = \"veniamatquiest90.dll\" fullword ascii\n$s3 = \"Quaerat magni assumenda nihil architecto labore ullam autem unde temporibus\nmollitia illum\" fullword ascii\n$s4 = \"Quaerat tempora culpa provident\" fullword ascii\n$s5 = \"Dolores ullam tempora error distinctio ut natus facere quibusdam\" fullword\nascii\n$s6 = \"Velit consequuntur quisquam tempora error\" fullword ascii\n$s7 = \"Corporis minima omnis qui est temporibus sint quo error magnam\" fullword ascii\n$s8 = \"Quo omnis repellat ut expedita temporibus eius fuga error\" fullword ascii\n$s9 = \"Officia sit maiores deserunt nobis tempora deleniti aut et quidem fugit\"\nfullword ascii\n$s10 = \"Rerum tenetur sapiente est tempora qui deserunt\" fullword ascii\n$s11 = \"Sed nulla quaerat porro error excepturi\" fullword ascii\n$s12 = \"Aut tempore quo cumque dicta ut quia in\" fullword ascii\n$s13 = \"Doloribus commodi repudiandae voluptates consequuntur neque tempora ut neque\nnemo ad ut\" fullword ascii\n$s14 = \"Tempore possimus aperiam nam mollitia illum hic at ut doloremque\" fullword\nascii\n$s15 = \"Et quia aut temporibus enim repellat dolores totam recusandae repudiandae\"\nfullword ascii\n$s16 = \"Dolorum eum ipsum tempora non et\" fullword ascii\n$s17 = \"Quas alias illum laborum tempora sit est rerum temporibus dicta et\" fullword\nascii\n$s18 = \"Sed velit ipsa et dolor tempore sunt nostrum\" fullword ascii\n$s19 = \"Veniam voluptatem aliquam et eaque tempore tenetur possimus\" fullword ascii\n$s20 = \"Possimus suscipit placeat dolor quia tempora voluptas qui fugiat et\naccusantium\" fullword ascii\ncondition:\n( uint16(0) == 0x5a4d and filesize < 2000KB and ( 1 of ($x*) and 4 of them )\n) or ( all of them )\n}\n\n### MITRE:\n\n Command and Scripting Interpreter ‚Äì T1059 External Proxy ‚Äì T1090.002 Remote Desktop Protocol ‚Äì T1021.001 OS Credential Dumping ‚Äì T1003 Pass the Hash ‚Äì T1550.002 Service Execution ‚Äì T1569.002 SMB/Windows Admin Shares ‚Äì T1021.002 Data Encrypted for Impact ‚Äì T1486 System Owner/User Discovery ‚Äì T1033 Permission Groups Discovery ‚Äì T1069\n\n```\n\n-----\n\n### Application Layer Protocol ‚Äì T1071 Process Injection ‚Äì T1055 Group Policy Modification ‚Äì T1484 Access Token Manipulation ‚Äì T1134 Create Account ‚Äì T1136 Remote System Discovery ‚Äì T1018 Network Service Scanning ‚Äì T1046 Domain Account ‚Äì T1087.002 Impair Defenses ‚Äì T1562\n\n Internal case: 3584\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-12 - Conti Ransomware.pdf"
    ],
    "report_names": [
        "2021-05-12 - Conti Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536146,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653761028,
    "ts_modification_date": 1653761028,
    "files": {
        "pdf": "https://archive.orkl.eu/ce9c5ebd873654f2d0cd0392aeab4ca8664eced7.pdf",
        "text": "https://archive.orkl.eu/ce9c5ebd873654f2d0cd0392aeab4ca8664eced7.txt",
        "img": "https://archive.orkl.eu/ce9c5ebd873654f2d0cd0392aeab4ca8664eced7.jpg"
    }
}