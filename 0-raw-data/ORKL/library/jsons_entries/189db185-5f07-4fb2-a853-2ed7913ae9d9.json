{
    "id": "189db185-5f07-4fb2-a853-2ed7913ae9d9",
    "created_at": "2023-01-12T15:04:28.226128Z",
    "updated_at": "2025-03-27T02:09:18.186443Z",
    "deleted_at": null,
    "sha1_hash": "40c4d083713875cc5346aae2d849a767aa32ac01",
    "title": "2022-01-20 - Log4j Exploit Hits Again- Vulnerable VMWare Horizon Servers at Risk",
    "authors": "",
    "file_creation_date": "2022-05-28T01:58:03Z",
    "file_modification_date": "2022-05-28T01:58:03Z",
    "file_size": 1257653,
    "plain_text": "# Log4j Exploit Hits Again: Vulnerable VMWare Horizon Servers at Risk\n\n**[blog.morphisec.com/log4j-exploit-hits-again-vulnerable-vmware-horizon-servers-at-risk](https://blog.morphisec.com/log4j-exploit-hits-again-vulnerable-vmware-horizon-servers-at-risk)**\n\n[Tweet](https://twitter.com/share)\n\nOn December 9th, 2021, reports surfaced about a new zero-day vulnerability, termed Log4j\n[(Log4Shell), impacting Minecraft servers. [see “Protecting Against the Log4J Vulnerability”]](https://blog.morphisec.com/protection-against-log4j-vulnerability-what-actions-to-take)\nCountless millions of devices instantly became at risk of attack, and Log4j ranked among the\n\n\n-----\n\nworst vulnerabilities yet seen. The fear of the Log4j security flaw has once again returned as\nthreat actors have started to exploit vulnerable VMWare Horizon Servers. Learn more about\nLog4j and this new threat in this Morphisec blog post.\n\nLog4j is a logging framework for java applications and has been an integral part of many\nprograms since the mid-1990s. Cloud storage companies like Google, Amazon, and\nMicrosoft, which are the digital hotline for millions of other applications, have been hit hard.\nThe same goes for other IT giants like IBM, Oracle, and Salesforce, as well as thousands of\nInternet-connected devices like televisions and security cameras.\n\n## Trouble on the VMWare Horizon\n\nDecember 2021 was challenging for many vendors rushing to patch log4j vulnerabilities and it\nwasn’t clear if this patching cycle had an end. More recently, attackers have been scanning\nthe web for easily accessible java services and attacks by known and unknown threat actors\nagainst popular distributed applications vulnerable to Log4j escalated, including several\ntargeting VMware Horizon servers.\n\nVMware Horizon server versions 7.x and 8.x are susceptible to two of the Log4j vulnerabilities\n[(CVE-2021-44228 and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228) [CVE-2021-45046). United Kingdom National Health Service digital](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)\nexperts stated that an attack group has been exploiting these flaws to install webshells on\ncompromised servers. This allows them to create advanced persistent threats (APTs) that\nmove laterally to spread infections. Using webshells has become a popular tactic employed by\nthreat actors as it’s an easy way to land APTs on internet servers containing sensitive data.\nAttackers leverage small, relatively simple files that often don’t trigger alerts with traditional\nnext generation antivirus (NGAV), endpoint protection platforms (EPP), or endpoint detection\nand response (EDR). If an attacker can bypass these defenses and gain access to a server,\nthey can use remote access to execute further commands. The Log4j saga has opened the\ndoor to these attackers, who have installed webshells after exploiting flaws in the logging\nservice.\n\nPerpetrators have exploited the Apache Tomcat service running on vulnerable VMware\nHorizon servers by using specific PowerShell commands spawned from the Tomcat service.\nAttackers then restart the VMBLastSG service to initiate a listener that communicates with the\ncommand-and-control server. The listener runs commands from the server that contain a\nspecific hardcoded key. This process is then used to establish persistent communications with\na command and control server that executes ransomware or other malicious activities. Various\nlone actors, APT groups, and cybercrime organizations have exploited the Log4j flaws, which\nhave led to ransomware attacks.\n\nMorphisec Labs identified the active VMWare Horizon Tomcat service exploitation through the\nlog4j vulnerability that started on January 3, 2022. Similar to other vendors, we released an\nupdate for known indicators of compromise (IOCs) as we identified these within customer\nenvironments.\n\n\n-----\n\nFollowing an exploitation of the Tomcat service (ws_TomcatService.exe), attackers executed\n[the powershell.exe process, and in some cases, as reported by Microsoft, attackers deployed](https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/)\n[Cobalt Strike backdoors following an exploitation of a McAfee application mfeann.exe side](https://blog.morphisec.com/how-to-stop-ransomware-breach-prevention-vs-cobalt-strike-backdoor)\nloading dll vulnerability.\n\nOrganizations downloaded the McAfee application into different persistent folders, such as\n**_Users\\public, programdata, windows\\help directories on the virtualization servers_**\n(persistent across profiles), together with the Cobalt Strike loader that was downloaded in the\nsame folder and loaded by the McAfee process as it was executed (LockDown.dll).\n\nIn some instances, Morphisec observed that the same attackers tried to drop these files\ndirectly into the VMware folder.\n\n\n-----\n\nOther attackers, as reported by [Rapid7, have downloaded Cobalt directly into the PowerShell](https://www.rapid7.com/blog/post/2022/01/18/active-exploitation-of-vmware-horizon-servers/)\nprocess, which was identified and prevented by Morphisec’s patented Moving Target Defense\n(MTD) technology.\n\n### Indicators of Compromise (IOCs)\n\nIPs hxxp://139.180.217[.]203:443/mac.ini\n\nhxxp://139.180.217[.]203:443/mac.tmp\n\nhxxp://139.180.217[.]203:443/tna.conf\n\nhxxp://139.180.217[.]203:443/LockDown.dll\n\nhxxp://api.rogerscorp[.]org:80\n\nhxxp://185.112.83[.]116:8080/drv\n\nLockDown.dll a8e4c7a7a786572398c0f504b3c5df58ea02ca1865e0dd57e5c7ab6ac21177f6\n\n8fd635ff70b99b4be59b149af86d1519d2047213b518501328b2add221b01372\n\nDed5ce04637c2114a0740b83623c0746adc645c3f5cb1a66e14bc6b59a648894\n\ne7e7b19c255ea052bb3c59b5597cdc92e76abe4dab72dacb92b16b7029e0d72f\n\n\nmfeann.exe\n\n(McAfee)\n\n\n07bbd8a80b5377723b13dbb40a01ca44cbc203369f5e5652a25b448e27ca108c\n\n\n### We Are Here to Help\n\nThese new vulnerabilities are bad news, but the good news for Morphisec customers is that\nour MTD technology prevents the execution of these backdoor attacks. Leading analysts,\nsuch as Gartner, are calling MTD a “game-changer” as it can uniquely detect and stop these\n\n\n-----\n\ntypes of zero-day attacks that often bypass NGAV, EDR, and other defenses. [Learn more](https://blog.morphisec.com/gartner-report-moving-target-defense-recognized-emerging-technology-application-security)\nabout Moving Target Defense and why Gartner cited this technology in its Emerging Trends\nand Technologies Impact Radar for Security.\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-20 - Log4j Exploit Hits Again- Vulnerable VMWare Horizon Servers at Risk.pdf"
    ],
    "report_names": [
        "2022-01-20 - Log4j Exploit Hits Again- Vulnerable VMWare Horizon Servers at Risk.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535868,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653703083,
    "ts_modification_date": 1653703083,
    "files": {
        "pdf": "https://archive.orkl.eu/40c4d083713875cc5346aae2d849a767aa32ac01.pdf",
        "text": "https://archive.orkl.eu/40c4d083713875cc5346aae2d849a767aa32ac01.txt",
        "img": "https://archive.orkl.eu/40c4d083713875cc5346aae2d849a767aa32ac01.jpg"
    }
}