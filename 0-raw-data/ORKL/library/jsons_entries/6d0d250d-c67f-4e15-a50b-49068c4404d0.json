{
    "id": "6d0d250d-c67f-4e15-a50b-49068c4404d0",
    "created_at": "2023-01-12T15:01:44.86235Z",
    "updated_at": "2025-03-27T02:16:04.307818Z",
    "deleted_at": null,
    "sha1_hash": "4376f75a751e11328aa408c2b6905282ddbb5d31",
    "title": "2020-05-12 - Tropic Trooper’s Back- USBferry Attack Targets Air-gapped Environments",
    "authors": "",
    "file_creation_date": "2022-05-27T22:34:29Z",
    "file_modification_date": "2022-05-27T22:34:29Z",
    "file_size": 128595,
    "plain_text": "# Tropic Trooper’s USBferry Targets Air-Gapped Networks\n\n**blog.trendmicro.com/trendlabs-security-intelligence/tropic-troopers-back-usbferry-attack-targets-air-gapped-**\nenvironments/\n\nMay 12, 2020\n\n[Tropic Trooper, a threat actor group that targets government, military, healthcare,](https://blog.trendmicro.com/en_us/research/18/c/tropic-trooper-new-strategy.html)\ntransportation, and high-tech industries in Taiwan, the Philippines, and Hong Kong, has been\n[active since 2011. The group was reportedly using spear-phishing emails with weaponized](https://documents.trendmicro.com/assets/wp/wp-operation-tropic-trooper.pdf)\nattachments to exploit known vulnerabilities. Primarily motivated by information theft and\nespionage, the group has also been seen adopting different strategies such as fine-tuning\n[tools with new behaviors and](https://blog.trendmicro.com/en_us/research/18/c/tropic-trooper-new-strategy.html) [going mobile with surveillanceware.](https://blog.lookout.com/titan-mobile-threat)\n\nWe found that Tropic Trooper’s latest activities center on targeting Taiwanese and the\nPhilippine military’s physically isolated networks through a USBferry attack (the name\nderived from a sample found in a related research). We also observed targets among\nmilitary/navy agencies, government institutions, military hospitals, and even a national bank.\nThe group employs USBferry, a USB malware that performs different commands on specific\ntargets, maintains stealth in environments, and steals critical data through USB storage. We\nstarted tracking this particular campaign in 2018, and our analysis shows that it uses a fake\nexecutable decoy and a USB trojan strategy to steal information.\n\nBased on data from the Trend Micro™ Smart Protection Network™ security infrastructure,\nUSBferry attacks have been active since 2014. We found the group was focused on stealing\ndefense-, ocean-, and ship-related documents from target networks, which led us to believe\nthat Tropic Trooper’s main purpose is to exfiltrate confidential information or intelligence.\n\n\n-----\n\n[Figure 1. A sample scenario of the USBferry attack](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/trendlabs-security-intelligence-07/files/2020/05/fig-1-tropic-trooper-usbferry-attack.jpg)\n\n_Figure 1. A sample scenario of the USBferry attack_\n\nTropic Trooper is well aware that military or government organizations may have more robust\nsecurity in their physically isolated environments (i.e., the use of biometrics or USB use in a\nquarantined machine before an air-gapped environment). The group then targets potentially\nunsecured related organizations that could serve as jumping-off points for attacks. For\ninstance, we observed Tropic Trooper move from a military hospital to the military’s\nphysically isolated network.\n\nThis blog post provides an overview of the USB malware called USBferry and its capabilities,\nas well as the other tools used to infiltrate physically isolated environments. Further details,\n[including indicators of compromise (IoCs), can be read in the technical brief.](https://documents.trendmicro.com/assets/Tech-Brief-Tropic-Trooper-s-Back-USBferry-Attack-Targets-Air-gapped-Environments.pdf)\n\n## A USB malware called USBferry\n\n[We first encountered the malware from a PricewaterhouseCoopers report that mentioned a](https://www.pwc.co.uk/issues/cyber-security-data-privacy/research/the-keyboys-are-back-in-town.html)\nsample related to Tropic Trooper but did not include a detailed analysis. We looked into it\nfurther and discovered many versions of it, including several program database (PDB)\nstrings. For one thing, the USBferry malware already has at least three versions, with\ndifferent variants and components, at the time of writing. Here are the noteworthy points we\ngathered during analysis:\n\n[The first version has a small component of TROJ_YAHOYAH. The malware tries to](https://documents.trendmicro.com/assets/wp/wp-operation-tropic-trooper.pdf)\ncheck if the target machine has a USB plug-in and copies the USBferry installer into\nthe USB storage. The activities vary in target environments; some execute commands,\nsource target files or folder lists, and copy files from physically isolated hosts to\ncompromised hosts, among other things.\n\n_Figure 2. USBferry malware’s first version, where the EXE file is the USBferry malware and_\n_the DLL file is trojan TROJ_YAHOYAH_\n\nThe second version has the same capabilities as the first and combines components\ninto one executable. This version also changes the malware location and its name to\nUF, an abbreviation for USBferry.\n\n_Figure 3. USBferry malware’s second version combined into one file_\n\nThe third version retains the previous versions’ capabilities and improves its stealth in\nthe target environment by residing in the rundll32.exe memory.\n\n\n-----\n\n_Figure 4. USBferry malware s third version becomes resident in memory_\n\n## How USBferry targets air-gapped systems\n\nIn our [technical brief, we broke down how Tropic Trooper has changed the way it uses the](https://documents.trendmicro.com/assets/Tech-Brief-Tropic-Trooper-s-Back-USBferry-Attack-Targets-Air-gapped-Environments.pdf)\nabovementioned USBferry versions in attacks. The group achieves infection by employing\nthe USB worm infection strategy and ferrying a malware installer via USB into an air-gapped\nhost machine.\n\n[Figure 5. USBferry malware using USB worm infection strategy](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/trendlabs-security-intelligence-07/files/2020/05/fig-5-tropic-trooper-usbferry-usb-worm-infection.png)\n\n_Figure 5. USBferry malware using USB worm infection strategy_\n\nHere we will discuss the notable changes in the group’s latest attack chain that uses version\nUF1.0 20160226 (detected by Trend Micro as TROJ_USBLODR.ZAHB-A):\n\n[Figure 6. USBferry attack scenario, version UF1.0 20160226](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/trendlabs-security-intelligence-07/files/2020/05/fig-6-tropic-trooper-usbferry-attack-uf-1-20160226.jpg)\n\n_Figure 6. USBferry attack scenario, version UF1.0 20160226_\n\n1. The decoy file first drops a flash_en.inf DLL file, which is a USBferry loader, and tries to\n\nload the encrypted USBferry malware\n2. The encrypted USBferry malware is embedded in the loader resource section, and the\n\nloader drops it into the C:\\Users\\Public\\Documents\\Flash folder and names it flash.dat\n3. After the encrypted payload is loaded, the loader injects a malicious DLL into\n\n_rundll32.exe. The USBferry malware also loads a C&C configuration file and_\n_flash_en.dat, which is also located in the C:\\Users\\Public\\Documents\\Flash_\n4. The USBferry malware then tries to connect to the download site and uses a Windows\n\ncommand to collect/copy target host data\n\nThis version checks for network connectivity; if it finds that the network is unavailable, it tries\nto collect information from the target machine and copy the collected data into USB storage.\nThis way, the USB exfiltrates the information and sends it back to the C&C server.\n\n## Backdoors and other tools used by Tropic Trooper\n\nSome backdoors used by Tropic Trooper use injection to execute its routines, while others\nexecute directly and run itself consistently. The group also uses steganography to mask their\nbackdoor routines and evade anti-malware and network perimeter detection. To find the full\n[list of the backdoors we analyzed, check out our technical brief. Here we will tackle some of](https://documents.trendmicro.com/assets/Tech-Brief-Tropic-Trooper-s-Back-USBferry-Attack-Targets-Air-gapped-Environments.pdf)\nthe noteworthy backdoors Tropic Trooper used.\n\n\n-----\n\n**WelCome To Svchost 3.2 20110818 s backdoor (detected as**\nBKDR_SVCSHELL.ZAHC-A) - This backdoor bears similarities with a payload we\n[discussed in our previous research. Based on the malware version number, this](https://documents.trendmicro.com/assets/wp/wp-operation-tropic-trooper.pdf)\nbackdoor’s first version was developed in or before 2011. This means that Tropic\nTrooper’s activities have been ongoing for at least ten years now.\n\n_Figure 7. The backdoor version name, registered service name, and malware components’_\n_filenames_\n\n**Welcome To IDShell 1.0 20150310’s backdoor (detected as BKDR_IDSHELL.ZTFC-**\nA) - The purpose of this backdoor, which has two types, including a steganography jpg\nversion, is to recon the target machine. Like other versions, it uses the DNS protocol to\ncommunicate with the backdoor controller. The traffic is encrypted to evade detection.\n\n_Figure 8. The backdoor’s communication traffic_\n\n**Hey! Welcome Server 2.0’s backdoor (detected as BKDR_TEBSHELL.ZTGK) – This**\nis the latest version of the backdoor, available in 32-bit and 64-bit versions, which uses\nan invisible web shell for remote control and network security evasion. It runs the\nprocess as a service, hides backdoor communication in normal traffic, and uses\ncustomized TCP protocol. It also improves the way it handles wrong input commands\nand unauthorized access.\n\nFigure 9. The executable version will install and name it as a Windows service, change\nregistry to disable error display, and launch the service\n\n_Figure 9. The executable version will install and name it as a Windows service, change_\n_registry to disable error display, and launch the service_\n\nTropic Trooper also used other tools in their attacks, such as:\n\nCommand-line remote control listener/port relay tool, which has different versions that\ncan communicate with the backdoor.\nBackdoor payload/steganography payload execution loaders, which have two versions\nthat can be used to successfully load the encrypted payload and subsequently delete\nitself and the payload.\nPort scanning tools, which are available on the internet.\n\nThe overview provided above highlights how putting critical information in physically isolated\nnetworks is not a bulletproof solution for defending against cyberespionage. Steganography\nisn’t just used to deliver encrypted payloads; it can also be used to transfer information to a\n\n\n-----\n\nC&C server. Multiple hacking tools and components can also help facilitate successful\nattacks on different networks and environments. Threat actors like Tropic Trooper can also\nuse an invisible web shell to hide its C&C server location and make incident response tricky.\n\n**MITRE ATT&CK Matrix**\n\n## Best practices and Trend Micro solutions\n\nThe latest developments with Tropic Trooper indicate that they are well-prepared to target\ngovernment institutions and military agencies for stolen intelligence. The group also takes a\nlong time to perform reconnaissance and consequently infiltrate physically isolated networks.\nThis research also underscores how threat actors could see potentially vulnerable targets as\nlaunch points for extending their attack attempts to other, more critical targets.\n\nUnderstanding attack tactics and techniques can provide the needed context for assessing\npotential impact and adopting defensive strategies. Here are some measures that\norganizations can practice to thwart advanced persistent threats with security that employs\nactionable threat intelligence, network-wide visibility, and timely threat protection:\n\n**Enforce the principle of least privilege. Employ** [network segmentation and data](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/protecting-data-through-network-segmentation)\ncategorization to deter lateral movement and mitigate exposure.\n**Keep the system and its applications up-to-date. Weaknesses in the network can**\n[serve as entry points for attacks. Enforce a strong patch management policy and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/vulnerabilities-and-exploits/patching-problems-and-how-to-solve-them)\nconsider virtual patching for legacy systems.\n**Regularly monitor your perimeter. Adopt** [cross-layer detection and response across](https://blog.trendmicro.com/en_us/business/products/detection-response.html)\ngateways, endpoints, networks, and servers to protect against a wide range of\n[cybersecurity threats. Firewalls and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/best-practices-deploying-an-effective-firewall) [intrusion detection and prevention systems can](https://blog.trendmicro.com/en_us/business/products/network/intrusion-prevention.html)\nhelp defend against network-based attacks.\n\n[Organizations can take advantage of the Trend Micro Apex One™ solution, which provides](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\nactionable insights, expanded investigative capabilities, and centralized visibility across the\nnetwork through a variety of threat detection capabilities such as behavioral analysis that\nprotects against malicious scripts, injection, ransomware, memory, and browser attacks.\n\n[A multilayered security solution such as Trend Micro™ Deep Discovery™ can also be](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html)\nconsidered; it provides in-depth analysis and proactive response to attacks using exploits\nand other similar threats through specialized engines, custom sandboxing, and seamless\ncorrelation across the entire attack lifecycle, allowing it to detect these attacks even without\nany engine or pattern updates.\n\n[Read our technical brief, which discusses in full our analyses of Tropic Trooper’s recent](https://documents.trendmicro.com/assets/Tech-Brief-Tropic-Trooper-s-Back-USBferry-Attack-Targets-Air-gapped-Environments.pdf)\nactivities, the USBferry malware, and IoCs.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-12 - Tropic Trooper’s Back- USBferry Attack Targets Air-gapped Environments.pdf"
    ],
    "report_names": [
        "2020-05-12 - Tropic Trooper’s Back- USBferry Attack Targets Air-gapped Environments.pdf"
    ],
    "threat_actors": [
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535704,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1653690869,
    "ts_modification_date": 1653690869,
    "files": {
        "pdf": "https://archive.orkl.eu/4376f75a751e11328aa408c2b6905282ddbb5d31.pdf",
        "text": "https://archive.orkl.eu/4376f75a751e11328aa408c2b6905282ddbb5d31.txt",
        "img": "https://archive.orkl.eu/4376f75a751e11328aa408c2b6905282ddbb5d31.jpg"
    }
}