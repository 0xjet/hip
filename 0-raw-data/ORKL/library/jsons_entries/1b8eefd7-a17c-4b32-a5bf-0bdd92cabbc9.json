{
    "id": "1b8eefd7-a17c-4b32-a5bf-0bdd92cabbc9",
    "created_at": "2023-01-12T15:09:07.985931Z",
    "updated_at": "2025-03-27T02:17:11.788221Z",
    "deleted_at": null,
    "sha1_hash": "82d9cfb7304320df997d825184fd5a072272c3e0",
    "title": "2016-12-29 - Some notes on IoCs",
    "authors": "",
    "file_creation_date": "2022-05-28T01:59:30Z",
    "file_modification_date": "2022-05-28T01:59:30Z",
    "file_size": 124294,
    "plain_text": "# Some notes on IoCs\n\n**blog.erratasec.com/2016/12/some-notes-on-iocs.html**\n\nObama \"sanctioned\" Russia today for those DNC/election hacks, kicking out 35 diplomats\n(**), closing diplomatic compounds (**), seizing assets of named individuals/groups (***).\nThey also published \"IoCs\" of those attacks, fingerprints/signatures that point back to the\nattackers, like virus patterns, file hashes, and IP addresses.\n\nThese IoCs are of low quality. They are published as a political tool, to prove they have\nevidence pointing to Russia. They have limited utility to defenders, or those publicly\nanalyzing attacks.\n\n[Consider the Yara rule included in US-CERT's \"GRIZZLY STEPPE\" announcement:](https://www.us-cert.gov/sites/default/files/publications/JAR_16-20296.pdf)\n\nWhat is this? What does this mean? What do I do with this information?\n\n\n-----\n\nIt s a YARA rule. YARA is a tool ostensibly for malware researchers, to quickly classify files.\nIt's not really an anti-virus product designed to prevent or detect an intrusion/infection, but to\nanalyze an intrusion/infection afterward -- such as attributing the attack. Signatures like this\nwill identify a well-known file found on infected/hacked systems.\n\nWhat this YARA rule detects is, as the name suggests, the \"PAS TOOL WEB KIT\", a web\n_shell tool that's popular among Russia/Ukraine hackers. If you google \"PAS TOOL PHP WEB_\n[KIT\", the second result points to the tool in question. You can download a copy here [*], or](http://profexer.name/pas/download.php)\n[you can view it on GitHub here [*].](https://github.com/robertdavidgraham/webshell/blob/master/php/pas/pas.php)\n\nOnce a hacker gets comfortable with a tool, they tend to keep using it. That implies the YARA\nrule is useful at tracking the activity of that hacker, to see which other attacks they've been\ninvolved in, since it will find the same web shell on all the victims.\n\nThe problem is that this P.A.S. web shell is popular, used by hundreds if not thousands of\nhackers, mostly associated with Russia, but also throughout the rest of the world (judging by\nhacker forum posts). This makes using the YARA signature for attribution problematic: just\nbecause you found P.A.S. in two different places doesn't mean it's the same hacker.\n\nA web shell, by the way, is one of the most common things hackers use once they've broken\ninto a server. It allows further hacking and exfiltration traffic to appear as normal web\nrequests. It typically consists of a script file (PHP, ASP, PERL, etc.) that forwards commands\nto the local system. There are hundreds of popular web shells in use.\n\nWe have little visibility into how the government used these IoCs. IP addresses and YARA\nrules like this are weak, insufficient for attribution by themselves. On the other hand, if\nthey've got web server logs from multiple victims where commands from those IP addresses\nwent to this specific web shell, then the attribution would be strong that all these attacks are\nby the same actor.\n\nIn other words, these rules can be a reflection of the fact the government has excellent\ninformation for attribution. Or, it could be a reflection that they've got only weak bits and\npieces. It's impossible for us outsiders to tell. IoCs/signatures are fetishized in the\ncybersecurity community: they love the small rule, but they ignore the complexity and context\naround the rules, often misunderstanding what's going on. (I've written thousands of the\nthings -- I'm constantly annoyed by the ignorance among those not understanding what they\nmean).\n\nI see on twitter people praising the government for releasing these IoCs. What I'm trying to\nshow here is that I'm not nearly as enthusiastic about their quality.\n\nNote#1: BTW, the YARA rule has to trigger on the PHP statements, not on the imbedded\n\n\n-----\n\nBASE64 encoded stuff. That s because it s encrypted with a password, so could be different\nfor every hacker.\n\nNote#2: Yes, the hackers who use this tool can evade detection by minor changes that avoid\nthis YARA rule. But that's not a concern -- the point is to track the hacker using this tool\nacross many victims, to attribute attacks. The point is not to act as an anti-virus/intrusiondetection system that triggers on \"signatures\".\n\nNote#3: Publishing the YARA rule burns it. The hackers it detects will presumably move to\ndifferent tools, like PASv4 instead of PASv3. Presumably, the FBI/NSA/etc. have a variety of\nYARA rules for various web shells used by know active hackers, to attribute attacks to\nvarious groups. They aren't publishing these because they want to avoid burning those rules.\n\nNote#4: The PDF from the DHS has pretty diagrams about the attacks, but it doesn't appears\nthis web shell was used in any of them. It's difficult to see where it fits in the overall picture.\n\n(**) No, not really. Apparently, kicking out the diplomats was punishment for something else,\nnot related to the DNC hacks. (***) It's not clear if these \"sanctions\" have any teeth.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-12-29 - Some notes on IoCs.pdf"
    ],
    "report_names": [
        "2016-12-29 - Some notes on IoCs.pdf"
    ],
    "threat_actors": [
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536147,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653703170,
    "ts_modification_date": 1653703170,
    "files": {
        "pdf": "https://archive.orkl.eu/82d9cfb7304320df997d825184fd5a072272c3e0.pdf",
        "text": "https://archive.orkl.eu/82d9cfb7304320df997d825184fd5a072272c3e0.txt",
        "img": "https://archive.orkl.eu/82d9cfb7304320df997d825184fd5a072272c3e0.jpg"
    }
}