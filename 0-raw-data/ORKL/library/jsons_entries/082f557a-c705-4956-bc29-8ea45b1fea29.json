{
    "id": "082f557a-c705-4956-bc29-8ea45b1fea29",
    "created_at": "2023-01-12T15:10:35.842679Z",
    "updated_at": "2025-03-27T02:16:22.132675Z",
    "deleted_at": null,
    "sha1_hash": "b5b27b1933cf0b0127024d22da19a88f480a5944",
    "title": "2017-09-05 - Rehashed RAT Used in APT Campaign Against Vietnamese Organizations",
    "authors": "",
    "file_creation_date": "2022-05-28T15:39:02Z",
    "file_modification_date": "2022-05-28T15:39:02Z",
    "file_size": 1008592,
    "plain_text": "# Rehashed RAT Used in APT Campaign Against Vietnamese Organizations\n\n**[blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations](https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations)**\n\nSeptember 5, 2017\n\nThreat Research\n\nBy [Jasper Manuel and](https://blog.fortinet.com/blog/search?author=Jasper+Manuel) [Artem Semenchenko | September 05, 2017](https://blog.fortinet.com/blog/search?author=+Artem+Semenchenko)\nRecently, FortiGuard Labs came across several malicious documents that exploit the\nvulnerability CVE-2012-0158. To evade suspicion from the victim, these RTF files drop decoy\ndocuments containing politically themed texts about a variety of Vietnamese government[related information. It was believed in a recent report that the hacking campaign where these](https://www.infosecurity-magazine.com/news/vietnam-lands-in-chinese-hackers/)\ndocuments were used was led by the Chinese hacking group 1937CN. The link to the group\nwas found through malicious domains used as command and control servers by the attacker.\nIn this blog, we will delve into the malware used in this campaign and will try to provide more\nclues as to the instigator of this campaign.\n\n\n-----\n\n_Sample decoy documents_\n\nWhen the documents are opened, they drop several files in one of the following folders:\n\n%AppData%\\Microsoft\\Credentials\n\n%AppData%\\Microsoft\\SystemCertificates\n\n%AppData%\\Microsoft\\Windows\\Templates\n\nSome samples drop the following files:\n\nTaskeng.exe – signed legitimate GoogleUpdate.exe version 1.3.33.5\n\nPsisrndrx.ebd – encrypted blob containing malware file\n\n\n-----\n\nGoopdate.dll – decrypter and loader of malware file\n\nSome drop the following files:\n\nSC&Cfg.exe – signed legitimate McAfee AV application\n\nVsodscpl.dll – contains the malware file\n\nOthers drop the following files:\n\nSystemm.exe - signed legitimate GoogleUpdate.exe version 1.3.30.3\n\nSystemsfb.ebd - encrypted blob containing malware file\n\nGoopdate.dll – decrypter and loader of malware file\n\nSimilar to other APT attacks, such as [MONSOON APT, this APT uses DLL hijacking to](https://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-1)\nevade the behavior monitoring technologies of security programs.\n\n## DLL Hijacking\n\nDLL hijacking is a technique used by some APT malware in which instead of the legitimate\napplication (.exe) loading the benign DLL, the application is tricked into loading a DLL\ncontaining malicious code. This technique is employed to evade Host Intrusion Prevention\nSystem (HIPS) of security programs that monitor the behaviors of executed files. Most HIPS\ntools whitelist signed or trusted files, thereby excluding malware loaded using DLL hijacking\nby signed files from behavior monitoring.\n\nIn the context of this attack, taskeng.exe and SC&Cfg.exe are signed legitimate applications;\nhowever, they are tricked into loading malware that are disguised as the legitimate\nGoopdate.dll and Vsodscpl.dll files.\n\n\n-----\n\n_Taskeng.exe and SC&Cfg.exe file information_\n\nNext, Taskeng.exe needs to load and import some functions from the original Goopdate.dll\nfile; however, the Goopdate.dll was hijacked to contain malicious code, effectively changing\nthe original code execution to execution of the malicious code.\n\n_Snippet from taskenge.exe that loads goopdate.dll_\n\nIn the same fashion, SC&Cfg.exe imports the “dll_wWinMain” function from the original\nvsodscpl.dll, but this DLL was hijacked as well, and also contains malicious code.\n\n\n-----\n\n_SC&Cfg.exe import table containing import from vsodscpl.dll_\n\nOnce the malicious DLLs are loaded, the DLLs decrypt (from psisrndrx.ebd (1 case) or fromst\nits body (2nd case)) and load a Trojan downloader. The Trojan downloader is a DLL file. It is\nnot dropped on disk but is only executed in memory. Also, the actual Trojan downloader in\nmemory when dumped will not run. This is because the ‘MZ’ in the IMAGE_DOS_HEADER,\nthe DOS stub, and the ‘PE’ signature were deliberately removed. This was done to prevent\nthe dumped file from being analyzed properly in a debugger and decompiler. However, we\ncan easily fix the dump by adding the ‘MZ’, a DOS stub, and the ‘PE’ signature.\n\n\n_Missing header items as anti-analysis_\n\nThis Trojan downloader downloads a RAT (Remote Access Trojan), which we will call\n“NewCore” RAT, from the following domains:\n\nweb.thoitietvietnam.org\n\ndalat.dulichovietnam.net\n\nhalong.dulichculao.com\n\n## Trojan Downloader\n\nThe Trojan downloader first creates an autostart registry entry so it runs whenever the\nmachine is rebooted:\n\nHKLM/HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n-----\n\nMicrosoft Windows Media = %AppData%\\Microsoft\\Credentials\\.exe\n\nAs an anti-VM, it checks whether the environment has the registry key:\n\nHKCR\\Applications\\VMwareHostOpen.exe\n\nBefore it can download the NewCore RAT, it needs to send the following information to the\nC&C server:\n\nOS version\nProcessor speed\nNumber of processors\nPhysical memory size\nComputer name\nUser name\nUser privilege\nComputer IP address\nVolume serial number\n\nThe above information is converted to its hex string representation, and then sent to the C&C\nserver via HTTP GET:\n\n_GET request to the C&C server_\n\nThe response is an XOR encrypted data that includes the encrypted NewCore RAT.\n\n\n-----\n\n_Response from the server_\n\n_XOR decryption of response from the C&C server_\n\n## NewCore Remote Access Trojan\n\nWe named this RAT ‘NewCore’ after we found the project name used by the author, which is\nindicated on the following PDB file string:\n\n\n-----\n\n_Malware project name_\n\nAccording to its compilation time stamp, this malware was compiled on March 16, 2017.\n\n_Compilation time_\n\nHowever, as of this writing, only a few Antivirus engines, including Fortinet detect this\nmalware according to VirusTotal.\n\n_VirusTotal positives_\n\nThis RAT is a DLL file. Its malicious routines are contained in its imported function\n“ProcessTrans”. However, executing the DLL without using the downloader will not work as\nthe C&C server string is not embedded in its body. When the downloader calls the function\n“ProcessTrans”, it supplies to the function the C&C server string and a handle to the C&C\nserver internet session. In this case, Heuristic detection based on behavior will not work on\nthe DLL alone.\n\nThis RAT is capable of the following:\n\nShutdown the machine\nRestart the machine\nGet disk list\nGet directory list\nGet file information\nGet disk information\nRename files\nCopy files\nDelete files\nExecute files\nSearch files\nDownload files\nUpload files\nScreen monitoring\n\n\n-----\n\nStart command shell\n\n_Shutdown and restart machine commands_\n\n_File manager, monitor screen, command shell commands_\n\n\n-----\n\n_File manager subcommands_\n\nBased on the strings found in its body, this malware may have been derived from the\nPcClient and PcCortr backdoors whose source codes are publicly available, especially on\nChinese language coding forums. PcClient detections usually include PcCortr.\n\n_Strings related to PcCortr modules_\n\n\n-----\n\n_PcClient and PcCortr source codes can be downloaded from Chinese coding forums_\n\n[PcClient was used in the past by some APT groups such as Nitro, which were also linked to](https://www.scmagazine.com/palo-alto-network-researchers-discover-further-nitro-attacks/article/539986/)\na China-based hacker.\n\nAccording to the PDB file string embedded in the NewCore RAT body, the creator of the\nproject is someone using the handle “hoogle168”.\n\n\n-----\n\nWe have little clue as to who this individual is, so we tried to look for information about this\nhandle. Our investigation led us to several Chinese language forum pages. Looking at these\nforums, it seems like a user using the handle “hoogle168” is very active on a certain coding\nforums, and is proficient in C and VC++. This user even replied to a thread and gave advice\non what to learn to develop remote control software. We don’t know for sure if this person is\nthe NewCore author.\n\n## Solution:\n\nTo prevent triggering this RTF exploit, it is important to apply the [patches released by](https://technet.microsoft.com/en-us/library/security/ms12-027.aspx)\nMicrosoft that cover CVE-2012-0158 vulnerability.\n\nFortinet also covers detection for these threats as MSOffice/Dropper!exploit.CVE20120158\nfor the malicious RTF files, and W32/NewCore.A!tr.bdr for the payload.\n\n[C&C URLs were also blocked using Fortinet's FortiGuard Web Filtering.](https://fortiguard.com/iprep?data=109.228.49.213)\n\n## Conclusion:\n\nNewCore RAT may just be a rehashed PcClient RAT, but it proves to be effective in evading\nAV detection by using a combination of simple techniques such as DLL-hijacking, file-less\nexecution of downloaded malware, and passing C&C information as parameter from\ndownloader to the downloaded file.\n\nAs always, Fortiguard Labs will keep an eye on threats like NewCore to protect our\ncustomers against these threats.\n\n_Thank you to Tien Phan for additional insights._\n\n-= FortiGuard Lion Team =\n## IOCs:\n\n**Lure:**\n\n2a4e8ae006be3a5ed2327b6422c4c6f8f274cfa9385c4a540bc617bff6a0f060\n\n3faacef20002f9deb1305c43ea75b8422fd29a1559c0cf01cf1cee6a1b94fc0e\n\n5bdbf536e12c9150d15ae4af2d825ff2ec432d5147b0c3404c5d24655d9ebe52\n\n14b4d8f787d11c7d72f66231e80997ef6ffa1d868d9d8f964bea36871e1c2ff2\n\n637c156508949c881763c019d2dca7c912da9ec63f01e3d3ba604f31b36e52ab\n\n5573f6ec22026b0c00945eec177f04212492bb05c33b4b80f73c65ce7fe5119a\n\n\n-----\n\n00466938836129a634b573d2b57311200ab04aba7252cfbf6b77f435612ca6c6\n\nc375946ba8abee48948f79a89ea5b4f823d8287c2feb3515755b22ba5bd8849d\n\nf6a4bab7d5664d7802f1007daa04ae71e0e2b829cd06faa9b93a465546837eb4\n\nfabf4debacb7950d403a84f4af25c084d0b576783006d334052ebf7ea432196e\n\n**Loader:**\n\n9cebae97a067cd7c2be50d7fd8afe5e9cf935c11914a1ab5ff59e91c1e7e5fc4\n\nea5b3320c5bbe2331fa3c0bd0adb3ec91f0aed97709e1b869b79f6a604ba002f\n\n**Trojan Downloader:**\n\nedbcc384b8ae0a2f52f239e2e599c3d2053f98cc1f4bc91548ec420bec063be6\n\n49efab1dedc6fffe5a8f980688a5ebefce1be3d0d180d5dd035f02ce396c9966\n\ndf8475669a14a335c46c802f642dd5569c52f915093a680175c30cc9f28aacdb\n\n**NewCore RAT:**\n\n37bd97779e854ea2fc43486ddb831a5acfd19cf89f06823c9fd3b20134cb1c35\n\n**Command and Control Servers:**\n\nweb.thoitietvietnam.org\n\ndalat.dulichovietnam.net\n\nhalong.dulichculao.com\n\n_[Sign up for weekly Fortinet FortiGuard Labs Threat Intelligence Briefs and stay on top of the](http://ftnt.net/2iT7Mcp%C2%A0)_\n_newest emerging threats._\n\n### Related Posts\n\nCopyright © 2022 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-05 - Rehashed RAT Used in APT Campaign Against Vietnamese Organizations.pdf"
    ],
    "report_names": [
        "2017-09-05 - Rehashed RAT Used in APT Campaign Against Vietnamese Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "ca292585-950c-400f-b632-c19fa3491fe1",
            "created_at": "2022-10-25T15:50:23.599765Z",
            "updated_at": "2025-03-27T02:00:55.504509Z",
            "deleted_at": null,
            "main_name": "MONSOON",
            "aliases": null,
            "source_name": "MITRE:MONSOON",
            "tools": [
                "TINYTYPHON",
                "BADNEWS",
                "Unknown Logger",
                "AutoIt backdoor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88854a9f-641a-4412-89db-449b4d5cbc51",
            "created_at": "2022-10-25T16:07:23.963599Z",
            "updated_at": "2025-03-27T02:02:10.051548Z",
            "deleted_at": null,
            "main_name": "Operation HangOver",
            "aliases": [
                "Monsoon",
                "Operation HangOver",
                "Viceroy Tiger"
            ],
            "source_name": "ETDA:Operation HangOver",
            "tools": [
                "AutoIt backdoor",
                "BADNEWS",
                "BackConfig",
                "JakyllHyde",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f21d7691-a720-46bb-81d7-11edb9f73eba",
            "created_at": "2023-11-08T02:00:07.126478Z",
            "updated_at": "2025-03-27T02:00:03.18984Z",
            "deleted_at": null,
            "main_name": "1937CN",
            "aliases": [],
            "source_name": "MISPGALAXY:1937CN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9041c438-4bc0-4863-b89c-a32bba33903c",
            "created_at": "2023-01-06T13:46:38.232751Z",
            "updated_at": "2025-03-27T02:00:02.778714Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove"
            ],
            "source_name": "MISPGALAXY:Nitro",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b44a04-a080-4465-973d-976ce53777de",
            "created_at": "2022-10-25T16:07:23.911791Z",
            "updated_at": "2025-03-27T02:02:10.025108Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove",
                "Nitro"
            ],
            "source_name": "ETDA:Nitro",
            "tools": [
                "AngryRebel",
                "Backdoor.Apocalipto",
                "Chymine",
                "Darkmoon",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Moudour",
                "Mydoor",
                "PCClient",
                "PCRat",
                "Poison Ivy",
                "SPIVY",
                "Spindest",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2c7ecb0e-337c-478f-95d4-7dbe9ba44c39",
            "created_at": "2022-10-25T16:07:23.690871Z",
            "updated_at": "2025-03-27T02:02:09.921431Z",
            "deleted_at": null,
            "main_name": "Goblin Panda",
            "aliases": [
                "1937CN",
                "Conimes",
                "Cycldek",
                "Goblin Panda"
            ],
            "source_name": "ETDA:Goblin Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "BackDoor-FBZT!52D84425CDF2",
                "BlueCore",
                "BrowsingHistoryView",
                "ChromePass",
                "CoreLoader",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "DropPhone",
                "FoundCore",
                "HDoor",
                "HTTPTunnel",
                "JsonCookies",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NBTscan",
                "NewCore RAT",
                "PlugX",
                "ProcDump",
                "PsExec",
                "QCRat",
                "RainyDay",
                "RedCore",
                "RedDelta",
                "RoyalRoad",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Win32.Staser.ytq",
                "USBCulprit",
                "Win32/Zegost.BW",
                "Xamtrav",
                "ZeGhost",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536235,
    "ts_updated_at": 1743041782,
    "ts_creation_date": 1653752342,
    "ts_modification_date": 1653752342,
    "files": {
        "pdf": "https://archive.orkl.eu/b5b27b1933cf0b0127024d22da19a88f480a5944.pdf",
        "text": "https://archive.orkl.eu/b5b27b1933cf0b0127024d22da19a88f480a5944.txt",
        "img": "https://archive.orkl.eu/b5b27b1933cf0b0127024d22da19a88f480a5944.jpg"
    }
}