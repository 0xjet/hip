{
    "id": "ce042935-2159-4c98-987c-2285bff9affb",
    "created_at": "2023-01-12T15:01:18.431141Z",
    "updated_at": "2025-03-27T02:08:04.811694Z",
    "deleted_at": null,
    "sha1_hash": "db6b251339c94d17817c786d731e5510374feece",
    "title": "2020-05-28 - Microsoft IIS servers hacked by Blue Mockingbird to mine Monero",
    "authors": "",
    "file_creation_date": "2022-05-28T19:27:28Z",
    "file_modification_date": "2022-05-28T19:27:28Z",
    "file_size": 800278,
    "plain_text": "# Microsoft IIS servers hacked by Blue Mockingbird to mine Monero\n\n**[bleepingcomputer.com/news/security/microsoft-iis-servers-hacked-by-blue-mockingbird-to-mine-monero/](https://www.bleepingcomputer.com/news/security/microsoft-iis-servers-hacked-by-blue-mockingbird-to-mine-monero/)**\n\nAx Sharma\n\nBy\n[Ax Sharma](https://www.bleepingcomputer.com/author/ax-sharma/)\n\nMay 28, 2020\n01:13 PM\n0\n\nThis month [news broke about a hacker group, namely Blue Mockingbird, exploiting a critical](https://redcanary.com/blog/blue-mockingbird-cryptominer/)\nvulnerability in Microsoft IIS servers to plant Monero (XMR) cryptocurrency miners on\ncompromised machines.\n\nAccording to the security firm Red Canary, the estimated number of infections is thought to\nhave surpassed 1,000.\n\n## Exploiting a Telerik vulnerability\n\nThe [CVE-2019-18935 vulnerability, with its](https://nvd.nist.gov/vuln/detail/CVE-2019-18935) [critical 9.8 severity score, is an untrusted](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)\n[deserialization vulnerability within the proprietary Progress Telerik UI (for ASP.NET AJAX)](https://www.telerik.com/products/aspnet-ajax.aspx)\nlibrary which is often bundled with .NET components, including some open-source ones.\n\nWhile originally published in December 2019, the flaw continues to be exploited even today\ndespite patches and fixes having been made available. The reason for this could be that\npatching production IIS systems running vulnerable Telerik UI DLLs may be a challenge in\npractice.\n\n\n-----\n\nAs previously highlighted by BleepingComputer, multiple government organisations\n[including the NSA and Australian authorities have issued warnings against this and related](https://www.bleepingcomputer.com/news/security/nsa-hackers-exploit-these-vulnerabilities-to-deploy-backdoors/)\nProgress Telerik UI vulnerabilities, because of their prominent exploitation by hackers to\ngain backdoor and web shell access.\n\nIt is interesting to note the vulnerability isn’t all that novel either. Versions of Telerik Web UI\nwere previously reported to have path traversal, remote code execution, and weak\n[encryption flaws such as CVE-2014-2217,](https://nvd.nist.gov/vuln/detail/CVE-2014-2217) [CVE-2017-11317, and](https://nvd.nist.gov/vuln/detail/CVE-2017-11317) [CVE-2017-11357, with](https://nvd.nist.gov/vuln/detail/CVE-2017-11357)\n[exploits and](https://www.exploit-db.com/exploits/43874) [PoCs readily available.](https://know.bishopfox.com/research/cve-2019-18935-remote-code-execution-in-telerik-ui)\n\nAll of these vulnerabilities and the current CVE-2019-18935 somewhat concern the same\nfunctionality, `RadAsyncUpload: the class responsible for asynchronously (via AJAX)`\nuploading files to a temporary folder and keeping them there up until a postback event\noccurs.\n\n_A screenshot taken from the decompiled Telerik UI DLL showing the default location of the_\n_uploaded temporary files. The DLL is often bundled with open source components e.g._\n_select versions of_ _[DotNetNuke.Web.](https://www.nuget.org/packages/DotNetNuke.Web/6.0.0)_\n\nThe asynchronous uploader uses encryption as a security mechanism to prevent an\nattacker from influencing sensitive settings: such as the ‘type’ of the uploaded file (used to\nprepare the deserializer), and the ultimate destination of the uploaded file on the server\n(values such as ‘TempTargetFolder’ and ‘TargetFolder’).\n\nTherefore, for a successful exploit to occur, an attacker needs to know beforehand the\nencryption keys being used by the Telerik UI async uploader. These could be obtained as a\n[result of the attacker exploiting older Telerik UI vulnerabilities on the same vulnerable IIS](https://www.telerik.com/support/kb/aspnet-ajax/upload-%28async%29/details/unrestricted-file-upload)\nserver.\n\nThere’s also an easier route: if the server is using the default encryption keys, which were\nnever regenerated afresh (see hardcoded PublicKeyToken below).\n\nOlder versions of Telerik.Web.UI.dll ship with a hardcoded PublicKeyToken and its\nprivate key counterpart in several places within the code. Unless these strings are manually\nchanged, the attacker can trivially obtain prior knowledge necessary to conduct this exploit.\n\n\n-----\n\n_Older Telerik Web UI DLLs using a hardcoded PublicKeyToken at several places_\n\nGiven the vulnerability isn’t entirely new and improvements have been made to Telerik UI\nover the years to remediate older CVEs, the actual exploitation involves two key steps.\n\n[The first, is to trick the uploader into accepting a POST request (a “rawData” object, also](https://know.bishopfox.com/research/cve-2019-18935-remote-code-execution-in-telerik-ui)\nreferred to as “rauPOSTData”) which looks legitimate but contains a carefully crafted DLL\n[file of the attacker’s choice rather than purely an “IAsyncUploadConfiguration” object that](https://docs.telerik.com/devtools/aspnet-ajax/controls/asyncupload/how-to/how-to-preserve-upload-configuration)\nthe deserializer is expecting. The second step involves influencing the application into\ndeserializing objects of types other than IAsyncUploadConfiguration, such as DLLs.\n\n**NOTE: The AsyncUploadConfiguration class is simply the implementation of the**\n```\nIAsyncUploadConfiguration interface. I’ve used these names interchangeably.\n\n```\n_The “rawData” object represents the POST request. The ‘&’ delimits the actual ‘obj’ (object)_\n_to be deserialized and its ‘type’ in the POST request. The ‘type’ parameter may be_\n_overridden to allow DLL deserialization, if the encryption keys are known to an attacker._\n\n[Having referred to the PoC, the exploit is conducted in the following steps:](https://github.com/noperator/CVE-2019-18935/blob/8ebecaf3b2619b5ac8c127d5e44c630b095bee72/CVE-2019-18935.py)\n\n1. The attacker first crafts a malicious POST request to the async upload file handler\n\n[(WebResource.axd), specifying the type as the normal](https://github.com/noperator/CVE-2019-18935/blob/master/CVE-2019-18935.py#L61)\n“Telerik.Web.UI.AsyncUploadConfiguration” which is what the deserializer expects.\nBut in the AsyncUploadConfiguration JSON ‘object’ itself, the attacker provides a\n[custom target directory path (where the file will be uploaded to on the server).](https://github.com/noperator/CVE-2019-18935/blob/master/CVE-2019-18935.py#L44)\nTherefore, this is a fully valid AsyncUploadConfiguration object expected by the\ndeserializer with the exception of a customized target upload path provided.\n[Additionally, in the same request the attacker sneaks in the malicious DLL file. The](https://github.com/noperator/CVE-2019-18935/blob/master/CVE-2019-18935.py#L77)\nDLL is simply uploaded in this step to the target directory (remote path) of the\nattacker’s choice, and not deserialized.\n\n\n-----\n\n2. The second step concerns the actual deserialization of the uploaded DLL. This time\n\naround, the attacker makes another request to the async file handler. Instead of\nsending a valid “AsyncUploadConfiguration” JSON object, however, the attacker\n[sends a JSON object specifying the remote path (on the server) of the previously](https://github.com/noperator/CVE-2019-18935/blob/master/CVE-2019-18935.py#L99)\n[uploaded DLL and nothing else. The ‘type’ of the object is now specified as](https://github.com/noperator/CVE-2019-18935/blob/master/CVE-2019-18935.py#L102)\nSystem.Configuration.Install.AssemblyInstaller (that of the DLL) with no other files\nuploaded in the request. Once the request is processed, the deserializer will attempt\nto load the malicious DLL present at the specified remote path, effectively resulting in\nremote code execution.\n\nTherefore, with the knowledge of encryption keys to craft malicious requests and after\nrunning a successful two-step exploit, an attacker has gained the ability to execute arbitrary\ncode on the enterprise server.\n\nIn malware campaigns involving the hacker group Blue Mockingbird, their choice of malice\ninvolves targeting enterprise IIS servers on a large scale, and turning them into Monero\n(XMR) cryptocurrency miners.\n\n**Remediation Guidance**\n\nIt is important that any vulnerable IIS instances running Telerik UI components be\nimmediately scanned, and patched for this vulnerability. Telerik’s [official advisory lists](https://www.telerik.com/support/kb/aspnet-ajax/details/allows-javascriptserializer-deserialization)\ncomprehensive scenarios in ways the vulnerability can be exploited and the appropriate\nremediation guidance.\n\nMarkus Wulftange of [Code White GmbH has been credited with the discovery of the flaw](https://www.code-white.com/)\n[and Paul Taylor (@bao7uo), for assisting with public disclosure and additional research.](https://github.com/bao7uo)\n\n### Related Articles:\n\n[New IceApple exploit toolset deployed on Microsoft Exchange servers](https://www.bleepingcomputer.com/news/security/new-iceapple-exploit-toolset-deployed-on-microsoft-exchange-servers/)\n\n[U.S. Treasury sanctions Russian cryptocurrency mining companies](https://www.bleepingcomputer.com/news/cryptocurrency/us-treasury-sanctions-russian-cryptocurrency-mining-companies/)\n\n[New malware targets serverless AWS Lambda with cryptominers](https://www.bleepingcomputer.com/news/security/new-malware-targets-serverless-aws-lambda-with-cryptominers/)\n\n[Blue Mockingbird](https://www.bleepingcomputer.com/tag/blue-mockingbird/)\n[IIS](https://www.bleepingcomputer.com/tag/iis/)\n[Miners](https://www.bleepingcomputer.com/tag/miners/)\n[Monero](https://www.bleepingcomputer.com/tag/monero/)\n\n[Ax Sharma](https://www.bleepingcomputer.com/author/ax-sharma/)\n\nAx Sharma is a Security Researcher and Tech Reporter. His works and expert analyses\nhave frequently been featured by leading media outlets including Fortune, Business Insider,\nThe Register, TechRepublic, etc. Ax's expertise lies in vulnerability research, malware\n\n\n-----\n\nanalysis, and open source software. He s an active community member of the OWASP\nFoundation, Open Source Security Foundation (OpenSSF), and the British Association of\nJournalists (BAJ). Send any tips via email or Twitter DM.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/michigan-state-university-network-breached-in-ransomware-attack/)\n[Next Article](https://www.bleepingcomputer.com/news/security/minted-discloses-data-breach-after-5m-user-records-sold-online/)\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-28 - Microsoft IIS servers hacked by Blue Mockingbird to mine Monero.pdf"
    ],
    "report_names": [
        "2020-05-28 - Microsoft IIS servers hacked by Blue Mockingbird to mine Monero.pdf"
    ],
    "threat_actors": [
        {
            "id": "e568e9d7-ae94-4ce5-9039-4fd17c731c1d",
            "created_at": "2022-10-25T15:50:23.491763Z",
            "updated_at": "2025-03-27T02:00:55.483586Z",
            "deleted_at": null,
            "main_name": "Blue Mockingbird",
            "aliases": [
                "Blue Mockingbird"
            ],
            "source_name": "MITRE:Blue Mockingbird",
            "tools": [
                "FRP",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535678,
    "ts_updated_at": 1743041284,
    "ts_creation_date": 1653766048,
    "ts_modification_date": 1653766048,
    "files": {
        "pdf": "https://archive.orkl.eu/db6b251339c94d17817c786d731e5510374feece.pdf",
        "text": "https://archive.orkl.eu/db6b251339c94d17817c786d731e5510374feece.txt",
        "img": "https://archive.orkl.eu/db6b251339c94d17817c786d731e5510374feece.jpg"
    }
}