{
    "id": "d82d425c-1087-4661-9a2d-7294e4c684bc",
    "created_at": "2023-01-12T15:10:18.165082Z",
    "updated_at": "2025-03-27T02:12:11.049137Z",
    "deleted_at": null,
    "sha1_hash": "024c6ec890b98ecac052d867212f293efa299a64",
    "title": "2021-05-18 - TeamTNT’s Extended Credential Harvester Targets Cloud Services, Other Software",
    "authors": "",
    "file_creation_date": "2022-05-28T00:42:15Z",
    "file_modification_date": "2022-05-28T00:42:15Z",
    "file_size": 255347,
    "plain_text": "# TeamTNT’s Extended Credential Harvester Targets Cloud Services, Other Software\n\n**[trendmicro.com/en_us/research/21/e/teamtnt-extended-credential-harvester-targets-cloud-services-other-software.html](https://www.trendmicro.com/en_us/research/21/e/teamtnt-extended-credential-harvester-targets-cloud-services-other-software.html)**\n\nMay 18, 2021\n\nWe found new evidence that the cybercriminal group TeamTNT has extended its credential harvesting\ncapabilities to include multiple cloud and non-cloud services.\n\nBy: David Fiser, Alfredo Oliveira May 18, 2021 Read time: ( words)\n\n[Keeping secrets safe is key to keeping systems secure and preventing supply-chain attacks. Malicious](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/identifying-weak-parts-of-a-supply-chain)\nactors often go after secrets in storage mechanisms and harvest credentials found in compromised\nsystems. And [credentials stored in plain text that are accessible even without user interaction are not](https://www.trendmicro.com/en_us/research/19/h/hiding-in-plain-text-jenkins-plugin-vulnerabilities.html)\nuncommon for DevOps software and are therefore a big security risk.\n\nMalicious actors have been known to harvest cloud service provider (CSP) credentials once they get into\ntheir [victims’](https://www.trendmicro.com/en_us/research/21/c/teamtnt-continues-attack-on-the-cloud--targets-aws-credentials.html) [systems. The cybercriminal group TeamTNT, for example, is no stranger to targeting cloud](https://www.trendmicro.com/en_us/research/21/a/malicious-shell-script-steals-cloud-credentials.html)\n[containers, expanding their arsenal to steal cloud credentials, and exploring other environments and](https://www.trendmicro.com/en_us/research/21/a/malicious-shell-script-steals-cloud-credentials.html)\n[intrusive activities. In the group’s latest attack routine, we found new evidence that TeamTNT has further](https://www.trendmicro.com/en_us/research/21/c/teamtnt-continues-attack-on-the-cloud--targets-aws-credentials.html)\nextended its credential harvesting capabilities to target multiple cloud and non-cloud services in victims’\ninternal networks and systems post-compromise.\n\nTechnical analysis\n\n\n-----\n\nFigure 1. TeamTNT’s infection chain for harvesting credentials\nTeamTNT’s malware is designed to harvest credentials from specific software and services. It infects\nLinux machines with openings such as exposed private keys and recycled passwords, and focuses on\nchecking the infected systems for cloud-related files.\n\nAs in the group’s other attacks, cloud misconfigurations and reused passwords provide easy entry to a\nvictim system. And as before, the group harvests credentials for Secure Shell (SSH) and Server Message\nBlock (SMB) to obtain access to other systems. Both intrusion techniques can spread their respective\npayloads in a wormlike manner. We found several scripts for this function (to ensure the spread of\n[payloads in different environments), one of which we had previously documented.](https://www.trendmicro.com/en_us/research/20/l/teamtnt-now-deploying-ddos-capable-irc-bot-tntbotinger.html)\n\nWith a .netrc file to automatically log in using the harvested credentials, the malware looks for app\nconfigurations and data based on a search list while going through the connected systems, and sends\nthem to the command-and-control (C&C) server.\n\nFigure 2. Scanning for\n\nconfigurations that the group is interested in\n\n\n-----\n\nFigure 3. Checking\n\nwhether any of the configuration files of targeted services are present in the infected system\nIf at least one of the sought-after configuration files is present in the infected system, the extended\ncredential harvester aggregates all the services’ configuration files into two arrays. Comparing this\nharvester with the group’s [previous](https://www.trendmicro.com/en_us/research/21/c/teamtnt-continues-attack-on-the-cloud--targets-aws-credentials.html) [versions, we saw a significant increase in targets.](https://www.trendmicro.com/en_us/research/21/a/malicious-shell-script-steals-cloud-credentials.html)\n\nFigure 4. Aggregating the targeted services’ configuration files into two arrays\nAs TeamTNT’s payloads focus on unauthorized mining of Monero, it’s no surprise that the malware also\nlooks for Monero configuration files in the infected system. The malware looks for the presence of Monero\nwallets in all the systems the group can access.\n\nAt the end of its routine, the malware tries to delete traces of itself from the infected system. However, our\nanalysis strongly indicates that this is not done effectively. While “history -c” clears the Bash history, some\ncommands continue with their activities and leave traces on other parts of the system.\n\nFigure 5. Attempting to clear traces of the routine from the\n\ninfected system\nConclusion\n\n\n-----\n\nMalicious actors actively look for legitimate users credentials in internal networks and systems to\nfacilitate their post-intrusion activities. If in possession of CSP credentials, they could use the cloud\nservices paid by legitimate entities for other malicious activities. Stolen credentials for version control\nsoftware such as Git also pose significant security risks, including supply chain compromise, since it is\nhighly likely that a malicious user will also have write capability into repositories, and can therefore\nperform source code modifications that will go unnoticed.\n\nIn addition, credentials stored in plain text serve as a gold mine for cybercriminals, especially when used\nin subsequent attacks. Harvested FTP credentials, for example, could lead to old-school website hacking\nor credential modifications, followed by ransom demands in exchange for access or data restoration. The\nsame goes for vulnerabilities, especially those in unpatched and otherwise unsecured internet-facing\nsystems.\n\nTo mitigate the risks of this TeamTNT routine and other similar threats, customers are advised to use the\nsecret vaults offered by their CSPs and to follow these best practices:\n\n[Enforce the principle of least privilege and adopt the](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/best-practices-deploying-an-effective-firewall) [shared responsibility model.](https://www.trendmicro.com/en_us/research/19/j/the-shared-responsibility-model.html)\n[Replace default credentials with strong and secure passwords, and ensure that security settings of](https://blog.trendmicro.com/are-your-passwords-secure-enough/)\ndifferent systems’ environments are customized to the organization’s needs.\nAvoid storing credentials in plain text, and enable multifactor authentication whenever available.\nUpdate and patch systems regularly. Consider the security, customization of credentials, and\npatching of front-facing systems to ensure no gaps can be abused for malicious activities.\n\nTrend Micro solutions\n\n[Cloud-specific security solutions such as Trend Micro Hybrid Cloud Security can help protect cloud-native](https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html)\nsystems and their various layers. Trend Micro Hybrid Cloud Security is powered by Trend Micro Cloud\nOne™, a security services platform for cloud builders that provides automated protection for continuousintegration and continuous-delivery (CI/CD) pipelines and applications. It also helps identify and resolve\nsecurity issues sooner and improve delivery time for DevOps teams. The Trend Micro Cloud One platform\nincludes:\n\n[Workload Security: runtime protection for workloads](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\n[Container Security: automated container image and registry scanning](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-container-image-security.html)\n[File Storage Security: security for cloud files and object storage services](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-file-storage-security.html)\n[Network Security: cloud network layer for intrusion prevention system (IPS) security](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-network-security.html)\n[Application Security: security for serverless functions, APIs, and applications](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-application-security.html)\n[Conformity: real-time security for cloud infrastructure — secure, optimize, comply](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-conformity.html)\n\nIndicator of compromise\n\n**SHA256** **Detection**\n\ned40bce040778e2227c869dac59f54c320944e19f77543954f40019e2f2b0c35 Trojan.SH.YELLOWDYE.A\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-18 - TeamTNT’s Extended Credential Harvester Targets Cloud Services, Other Software.pdf"
    ],
    "report_names": [
        "2021-05-18 - TeamTNT’s Extended Credential Harvester Targets Cloud Services, Other Software.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536218,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1653698535,
    "ts_modification_date": 1653698535,
    "files": {
        "pdf": "https://archive.orkl.eu/024c6ec890b98ecac052d867212f293efa299a64.pdf",
        "text": "https://archive.orkl.eu/024c6ec890b98ecac052d867212f293efa299a64.txt",
        "img": "https://archive.orkl.eu/024c6ec890b98ecac052d867212f293efa299a64.jpg"
    }
}