{
    "id": "3988f6f4-2ad7-47a6-b98d-f77a643616af",
    "created_at": "2023-01-12T15:05:14.426591Z",
    "updated_at": "2025-03-27T02:05:20.491254Z",
    "deleted_at": null,
    "sha1_hash": "0c23f4836dbcfbd7479d4b4d894fba15a84b23c8",
    "title": "2015-01-22 - New RATs Emerge from Leaked Njw0rm Source Code",
    "authors": "",
    "file_creation_date": "2022-05-28T15:39:31Z",
    "file_modification_date": "2022-05-28T15:39:31Z",
    "file_size": 188614,
    "plain_text": "# New RATs Emerge from Leaked Njw0rm Source Code\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/new-rats-emerge-from-leaked-njw0rm-source-code/](http://blog.trendmicro.com/trendlabs-security-intelligence/new-rats-emerge-from-leaked-njw0rm-source-code/)**\n\nJanuary 23, 2015\n\nIn the middle of my research on the remote access Trojan (RAT) known as “njrat” or\n“Njw0rm”, I stumbled upon dev-point.com, a site that disguises itself as a site for “IT\nenthusiasts” but actually hosts various downloaders, different types of spyware, and RATs. I\nexplored the site and found that they host malware under the “Protection Devices” section in\ntheir website. Under this section was a forum written in Arabic, which may suggest that an\nArabic-speaking country is behind it.\n\n_Figure 1. Screenshot of the “Protection Devices” section under dev-point.com. (Click the_\n_image above to enlarge)_\n\n**_Malware from Njw0rm Source Code One of the notable topics in the forum talked about_**\n[new malware “kjw0rm” (or HKTL_KJWORM) and a worm named “Sir DoOom,”](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/HKTL_KJWORM/)\n[(or HKTL_DOOMWORM) which both came about after the release of the Njw0rm malware](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/HKTL_DOOMWORM)\nsource code in the same forum. The leaking of Njw0rm’s source code last May 2013 in\nknown hacking websites like hackforums.net and dev-point.com led me to the conclusion\nthat cybercriminals found a way to leverage the worm and backdoor capabilities in Njw0rm to\ncreate new malware with added functionalities. We discovered two versions of Kjw0rm (V2.0\nand 0.5X) being shared in dev-point.com in January 2014 and December 2014 respectively.\nThe Sir DoOoM worm was also discovered in the same site last December 2014. The new\nmalware are coded in Visual Basic Script, unlike its earlier version, Njw0rm, which was\ncompiled with AutoIt. Checking the Malware Builder Similar to Njw0rm, the new malware\nwe found asks the attacker to assign a port to open for incoming traffic, with the default\nvalues being Port 1991, Port 1010 for kjw0rm, and Port 4000 for the Sir DoOom w0rm. The\nSir DoOom worm requires the builder to ‘Run as Administrator’ for it to work.\n\n\n-----\n\n_Figure 2. Top: Ports for kjw0rm V2.0 and Kjw0rm 0.5x, respectively, Bottom: port for Sir_\n_DoOom w0rm_\n\n**_Looking at Control Panels The new malware added a lot more information in the Control_**\nPanel view of the malware builder, compared to that of the Njw0rm version in May 2013.\n\n[Figure02_patchedunpatched](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2015/01/KJw0rm_fig3-2.png)\n\n_Figure 3. New fields for Kjw0rm and the Sir DoOom worm_\n\nWe’re also seeing new functions for both Kjw0rm versions and the Sir DoOom worm.\n\n[Figure02_patchedunpatched](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2015/01/KJw0rm_fig4-2.png)\n\n_Figure 4. New functions for Kjw0rm and the Sir DoOom worm_\n\n**_Propagation Routines The new malware based their propagation routines on njw0rm._**\nNjw0rm propagates via removable devices by getting a list of ten folders in the root directory,\nsetting them to ‘Hidden’ and making shortcut links using the folder names pointing to the\nmalware executable. Over a period a time, the malware tweak their propagation methods to\nmake the attack successful and employ social engineering tactics such as creating legitimate\nlooking folder to deceive the user.\n\n**Kjw0rm V2.0 This worm propagates in removable devices. The worm first drops a**\ncopy of itself (Hidden, System File Attribute) in the root directory of the removable\ndrive. It hides all folders, and creates shortcut files with folder icons with the same\nfolder names – all pointing to the malware executable. Kjw0rm V0.5X This malware\nhas the same routines as Kjw0rm V2.0. However, it gets a list of 20 folders on the\nremovable drive, hides the 20 folders, and creates shortcut files with folder icons with\nthe same folder names—all pointing to the malware executable. The malware then\ncreates a folder named Videos. After creating the folder, the malware redoes the\npropagation routine to get a list of 20 folders, but now includes the subfolders. Sir\n**DoOom worm The Sir DoOom worm has the same propagation method as Kjw0rm**\nV0.5x. The only difference is that the malware creates five folders namely: Videos,\n_Pictures, Movies, Games, and DCIM in the removable drive’s root directory._\n\n**_Payload/Unique Features_**\n\n\n-----\n\n**Kjw0rm V2.0 The propagation method of this malware targets all folders in the root**\ndirectory of the removable drive. Kjw0rm V0.5X This worm obfuscated some portions\nof the malware code. The malware author utilizes an obfuscator tool that converts\ncharacters to hex values, adds filler functions, and performs computations that make\nanalysis more difficult and time-consuming.\n_Figure 5. Sample code snippet_\n\nThis malware also has an anti-VM (virtual machine) routine. It first searches for a list of\nthe installed programs in the affected computer. If this variant found itself to be in a\ncomputer where a VM program is installed, it will uninstall and terminate itself from the\naffected system. This prevents analyst to do testing to determine malware behavior.\n**Sir DoOom worm This malware incorporates new functionalities that are unique to this**\nmalware.\n\nParsing of OS product key\nTermination of antivirus-related processes (terminates Tiger-Firewall.exe\nand bavtray.exe)\nAnti-VM routines (looks for the string ‘Virtual’ in the list of installed programs; if\nfound, it uninstalls and terminates itself)\nBitcoin mining\nLaunching of DDOS attacks\n\n**_Kjw0rm evolution from njRAT The first version of Kjw0rm was released on January 2014_**\n(V2.0X) followed by the second version (v0.5x) by the end of the year. The Sir DoOom worm\nwas released in December 21, 2014. This evolution shows that the malware authors are\nbecoming more active in developing new malware and using njw0rm as a template. Because\nof this pattern, we can expect to see more variants of this malware in the future.\n\n[Figure02_patchedunpatched](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2015/01/Njw0rm-timeline.png)\n\n_Figure 6. Malware evolution of njRAT_\n\n**_Solutions and best practices To stay protected against these new threats, we advise users_**\nto refrain from plugging removable drives that came from unknown computers or computers\nthat aren’t protected by security solutions. Avoid opening and installing programs from\nunknown web sources. Paying attention to small details also helps. For example, finding\nshortcut files in \"folder\" icons with your folder names is a strong indicator that the removable\ndrive is infected. Stay vigilant by keeping abreast of the latest cybercriminals tricks and\ntechniques. Finally, make sure your security software is always updated in order to detect\nand remove similar threats. Related hashes:\n\n5408477d7491d883251fa0fcbe7f6b4e6a9d4493 – HKTL_DOOMWORM\nb579ac4af93cc0212ed00c6468e948810bce0d27 – HKTL_KJWORM\n4fd150b489673ea089320811a533944416a4fd66 – HKTL_KJWORM\n\n\n-----\n\nContent added to Folio\n\nMalware\n\nBy: Trend Micro January 23, 2015 Read time: ( words)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-01-22 - New RATs Emerge from Leaked Njw0rm Source Code.pdf"
    ],
    "report_names": [
        "2015-01-22 - New RATs Emerge from Leaked Njw0rm Source Code.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535914,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1653752371,
    "ts_modification_date": 1653752371,
    "files": {
        "pdf": "https://archive.orkl.eu/0c23f4836dbcfbd7479d4b4d894fba15a84b23c8.pdf",
        "text": "https://archive.orkl.eu/0c23f4836dbcfbd7479d4b4d894fba15a84b23c8.txt",
        "img": "https://archive.orkl.eu/0c23f4836dbcfbd7479d4b4d894fba15a84b23c8.jpg"
    }
}