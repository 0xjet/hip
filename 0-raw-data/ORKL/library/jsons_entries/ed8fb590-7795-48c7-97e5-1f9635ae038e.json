{
    "id": "ed8fb590-7795-48c7-97e5-1f9635ae038e",
    "created_at": "2022-10-25T16:48:13.594172Z",
    "updated_at": "2025-03-27T02:16:25.817558Z",
    "deleted_at": null,
    "sha1_hash": "7a459f92c2ba0f37f6e378a60f00890953381338",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-02-08T17:29:50Z",
    "file_modification_date": "2018-02-08T17:29:50Z",
    "file_size": 2016972,
    "plain_text": "### A TrendLabs[SM] Research Deciphering Confucius:A Look at the Group’s Cyberespionage OperationsDaniel Lunghi and Jaromir HorejsiTrend Micro Cyber Safety Solutions (CSS) Team\n\n\n-----\n\nTREND MICRO LEGAL DISCLAIMER\n\nThe information provided herein is for general\n\ninformation and educational purposes only. It is not\n\nintended and should not be construed to constitute\n\nlegal advice. The information contained herein may\n\nnot be applicable to all situations and may not\n\nreflect the most current situation. Nothing contained\n\nherein should be relied on or acted upon without\n\nthe benefit of legal advice based on the particular\n\nfacts and circumstances presented and nothing\n\nherein should be construed otherwise. Trend Micro\n\nreserves the right to modify the contents of this\n\ndocument at any time without prior notice.\n\nTranslations of any material into other languages are\n\nintended solely as a convenience. Translation\n\naccuracy is not guaranteed nor implied. If any\n\nquestions arise related to the accuracy of a\n\ntranslation, please refer to the original language\n\nofficial version of the document. Any discrepancies\n\nor differences created in the translation are not\n\nbinding and have no legal effect for compliance or\n\nenforcement purposes.\n\nAlthough Trend Micro uses reasonable efforts to\n\ninclude accurate and up-to-date information herein,\n\nTrend Micro makes no warranties or representations\n\nof any kind as to its accuracy, currency, or\n\ncompleteness. You agree that access to and use of\n\n\nRomance Scams in Cyberespionage14\n\nA Web of Threats11\n\nTrojanized Documents16\n\nBackdoors and Shells22\n\nInformation Stealers26\n\nDefending AgainstTargeted Attacks\n\n\nContents5\n\n\n-----\n\nIn today’s online chat and datingscene, romance scams are not uncommon, what with catfishersand West African cybercriminalspotently toying with their victims’ emotions to cash in on their bank accounts. It’s quite odd (and probably underreported), however, to see it used as vectorfor cyberespionage.Confucius’ campaigns were reportedlyactive as early as 2013, abusing Yahoo! andQuora forumsas part of their command-and-control (C&C) communications. Westumbled upon Confucius, likely from South Asia, while delving into Patchwork’s cyberespionageoperations. Code in their custom malware bore similarities, for instance. And likePatchwork, Confucius targeted a particular set of individuals in South Asian countries, such as militarypersonnel, high-profile personalities, and businessmen.Delvinginto Confucius’ infrastructure, we came across websites offering Windows and Android chat applications, most likely iterations of its predecessor, Simple Chat Point:Secret Chat Point and Tweety Chat. Their operators exploited a vulnerability for which there is no patch: the human psyche. While we are admittedly uncertain of the extent —and success —of their use, they are one of the main ingredients of the group’s modi operandi.Confucius’ operations include deploying bespoke backdoors and stealing files from their victim’s systems with tailored file stealers. The stolen files are then exfiltrated by abusinga cloud service provider. Some of these file stealers specifically targetfiles from USB devices, probably to overcome air-gapped environments. Our research brief takes a closer, technical look at Confucius’ operations, the social engineeringmethodsand gamut of malware it uses, and the countermeasures that organizations can adopt to mitigate them.\n\n\n-----\n\nConfucius developed multiple chat software for Windows and Android based on a legitimate, opensource chat application. The chat applications they developed — Simple Chat Point, Secret Chat\nPoint, and Tweety Chat — have backdoor functionalities. The Android version, for instance, can steal\nSMS messages, accounts, contacts, and files, as well as record audio. We were able to access\nsome of the logs of these fake chat apps and saw romance used as a social engineering lure to urge\ntheir targets to install the malware on their mobile device.\n\n# Simple Chat Point\n\nSimple Chat Point was hosted directly on Google Play, but it was already removed from the app\nstore at the time of our research. We believe this was Secret Chat Point’s precursor, which we saw\npublished on Google Play on September 27, 2017. They are both consistent in their “privacy policy”\nthat tries to justify their intrusive Android permissions to unwitting victims.\n\nFigure 1: Screenshot of Simple Chat Point\n\n4  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations Romance Scams in Cyberespionage\n\n\n-----\n\nFigure 2: The application’s “privacy policy”\n\nFigure 3: Secret Chat Point’s homepage\nNote: The background image is available elsewhere as a stock photo\n\n5  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n# Secret Chat Point\n\nSecret Chat Point touted itself as an application that enforces anonymity and privacy (i.e., not storing\nchat logs), offered in Windows and Android platforms. At the time of our research, the download link\nwas already disabled in the HTML code, as Google already removed the application from their app\nstore. We managed to find versions 1.2 and 1.4 of the Android application in third-party app\nmarketplaces but found no installer for the Windows version. Version 1.2 was uploaded in October\n2017 and the latest known version, 1.4, was uploaded in November 2017. The Google cache page of\nthe application shows it was created by Simple Chat Point’s developer and installed by 10–50 users.\n\nWhile Secret Chat Point indeed has real chat features (although not anonymous at all), it also has\nundocumented routines, such as collecting and harvesting all SMS messages, contacts, and\naccounts, which get triggered when specific words are sent to the app. It can also list and get all files\npresent in Pictures, Download, Documents, DCIM/Camera, WhatsApp/Media/WhatsApp Documents,\nand WhatsApp/Media/WhatsApp Images.\n\nOnce a command is received and executed, its result is forwarded to a C&C server specified in the\nConfig class. Secret Chat Point’s website does not have Simple Chat Point’s privacy policy but\ninstead displays fake statistics and partnerships to lend itself credibility.\n\nFigure 4: Code snippets showing Secret Chat Point’s undocumented features\n\n6  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 5: Permissions required for the app to execute its hidden features\n\n# Tweety Chat\n\nTweety Chat is offered in 32-bit and 64-bit Windows systems as well as Android devices, flaunted as\ncapable of chatting directly through the web browser after registering an account. Its appearance\nresembles an old chat application in 2012 named TweetyChats, which still has a Facebook Page\nwith over 200 followers. Its domain expired by the end of 2015, however. Why Tweety? The string\n“Tweety” is in one of the python reverse shells we analyzed, so the python binary is probably related.\n\nFigure 6: Tweety Chat’s login page\n\n7  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 7: Facebook Page of the old application TweetyChats\n\nWe tested Tweety Chat’s Android version and noticed telltale signs indicating their targets of\ninterest: Verification emails with a physical address whose postal code is assigned to a provincial\ncapital that also appears (upon logging in) as a chat channel in Tweety Chat.\n\nTweety Chat’s Windows version works differently. After running the Windows Installer, an\nexecutable, created with Windows component [IExpress, is executed. It contains two binaries: a](https://technet.microsoft.com/en-us/library/gg598497.aspx)\nclean and functional TweetyChatSetup.exe, and a malicious intelsys.exe. In Resource Hacker, an\nopen-source resource editor and extraction utility, TweetyChatSetup.exe is marked as\nRUNPROGRAM while intelsys.exe is labeled as POSTRUNPROGRAM, indicating the latter executes\nafter the user installs TweetyChatSetup.exe.\n\nTweetyChatSetup.exe is almost the same as the binary available from a GitHub repository we found.\nIt can be downloaded as a 30MB installer of rocket.chat, an open-source chat application. Its\nJavaScript Object Notation (JSON) file, app-32\\resources\\servers.json, has the default setting:\n\nWhile the application itself is not malicious, the website, which gets opened in the Tweety Chat\napplication window, links to a Trojanized communication application.\n\n8  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 8: The Trojanized version of Tweety Chat (top),\n\nand the executable in Resource Hacker (bottom)\n\nintelsys.exe — a Python file compiled to an EXE with the internal name “Porky.py” — is a backdoor.\nIts supported commands are: quit, cd, cwd, pickup, drop, and exec; the backdoor will try to run\ncommands as shell commands using subprocess.Popen with the parameter, shell=True:\n\n  - If a bot operator enters the path to a file, it will be uploaded to the C&C server.\n\n  - If a bot operator enters a directory, the files with extensions .jpeg, .gif, .png, .doc, .docx,\n.ppt, .pptx, .xls, .xlsx, and .pdf are recursively searched then uploaded to the C&C server.\n\n9  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n|quit|Exit the session|\n|---|---|\n|cd|Change directory (folder or drive)|\n|cwd|Change working directory|\n|pickup|Steal file|\n|drop|Download a file from a specified URL|\n|exec|Execute shell command|\n\n\nTable 1: Supported commands on intelsys.exe\n\nIts decompiled source code reveals that English is not the attacker’s native language, e.g.,\ncoden_data string. In the course of our research, we saw that Tweety Chat’s Window version was\nconstantly updated, adding x32 and x64 versions, minor changes to the Porky backdoor — including\npersistence mechanism via the Run registry key — and updates related to exception handlings. One\nvariant, for instance, included a third EXE file embedded in the IExpress installer, which was a\ncompiled batch2exe file calling the backdoor binary.\n\nTweety Chat’s Android version is similar to Secret Chat Point’s, whose email/contact information\npoints to the latter’s developer. This iteration has two additional features: downloading and\nuploading parameters and recording audio by setting a new parameter. Version 1.0.1 was uploaded\nto Google Play on December 1, 2017, but it was eventually removed from the app store (its latest\nknown version is 1.0.3).\n\nFigure 9: The Google cache of the Android version of TweetyChat\n\n10  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 10: Code snippets showing its file retrieval feature, which is limited to file extensions related\n\nto documents and images (top, bottom)\n\n# Social Engineering \n\nThe applications’ user lists, chat room names, and content were stored on a remote server without\nany authentication. The chat logs shed light on the social engineering methods the operators used to\npersuade victims to install the malware on their Android devices. The first user and chatroom were\ncreated on August 27, 2017, and were probably the app authors’ testing ground. The succeeding\nusers and chatrooms were created on October 31, with December 12 the latest.\n\nA certain hayat22 and love piqued our interest. hayat22, purportedly a female student, engaged in an\nonline romance with a target whose handle was love, describing himself as living in South Asia\nworking in garments manufacturing and wholesaling.\n\nOver the course of their correspondence, love suggested using WhatsApp to communicate. hayat22\ndeclined, saying she felt safer using Tweety Chat. love refused, but when hayat22 demurred and\ngave love an online cold shoulder, love tried installing Tweety Chat — and failed. He claimed that he\nwasn’t able to install the app. hayat22 quickly lost interest and stopped replying to him altogether.\nNote their conversation below; hayat22 can speak Hindi and occasionally, English. She also sent him\na photo to show what Tweety Chat looked like.\n\n11  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 11: One of the conversations between love and hayat22\n\nWe’re not sure how love wound up in the chat room or how he met hayat22. He was probably either\nusing the Windows version of Secret Chat Point or its web interface, which explains why hayat22\nwas urging him to install Android Tweety Chat.\n\nIn an earlier chat group, an operator called Heena urged the members to install Secret Chat Point on\nother people's mobile devices to get perks like credits or the ability to “go invisible”. In another chat\nroom called “Maira’s room”, a target of interest disclosed he was a government officer traveling back\nfrom a northern city near the country’s provincial capital. A few days after, the operator stopped\nanswering in the chat room, and her user account was deleted from the server.\n\n12  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 12: hayat22 showing TweetyChat’s user interface (top),\nand a chat group operator urging members to install Secret Chat Point (bottom)\n\n13  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nWe dove deeper into Confucius’ operations—namely, the malware-ridden documents, backdoors,\nand file stealers they use in their campaigns. Of note are the resemblances of their malware to\nPatchwork’s. The use of an exploit for a security flaw disclosed in December 2017 and their rather\nrecent activities suggest Confucius’ campaigns are active.\n\n# Trojanized Documents\n\nConfucius’ backdoors are delivered through Office documents exploiting memory corruption\nvulnerabilities [CVE-2015-1641 and](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/vulnerability/7404/microsoft-office-memory-corruption-vulnerability-cve20151641) [CVE-2017-11882. The latter is a 17-year old security flaw in](https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2017-11882-exploited-deliver-cracked-version-loki-infostealer/)\nEquation Editor that was [actively exploited](https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/17-year-old-ms-office-flaw-cve-2017-11882-actively-exploited-in-the-wild) in the wild in December 2017. The sctrls backdoor we\n[came across is delivered via RTF files exploiting CVE-2015-1641. The documents that exploit CVE-](https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2017-11882-exploited-deliver-cracked-version-loki-infostealer/)\n[2017-11882](https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2017-11882-exploited-deliver-cracked-version-loki-infostealer/) download another payload — an HTML Application (HTA) file toting a malicious Visual\nBasic (VBS) script — from the server, which is executed accordingly by the command-line tool\nmshta.exe.\n\nFigure 13: Hex-decoded content of the exploit-laden RTF file, revealing the threat’s second stage\n\nThe abc.hta file (Figure 12) downloads a decoy document, which will be opened in Microsoft Word\n(WINWORD) that in turn downloads the executable payload (the sctrls backdoor). It’s worth noting\nthat the payload is missing the first 2 bytes, which are later added before it is executed. This is likely\ndone to bypass antivirus (AV) detection.\n\n14  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations A Web of Threats\n\n\n-----\n\nThe script also deletes Office resiliency registry keys. These keys have values that are designed to\ndisplay a warning to the user when Office does not terminate correctly. Deleting the resiliency keys\nwill ensure that no notification is displayed to the victim.\n\nAnother document, which exploits CVE-2017-11882, takes a more direct approach. It contains a\nsimple downloader in the form of a shellcode that downloads and executes the sip_telephone\nbackdoor.\n\nFigure 14: Screenshot of the decoy document with a picture of a fake prompt (top),\n\nand the decrypted shellcode containing the payload’s path\n\n# Backdoors and Shells\n\n## sctrls\n\nThe sctrls backdoor has these functions:\n\n  - Compute the unique identifier (hash) from the username and computer name.\n\n  - Register a new user on the C&C server; this registration creates a new folder with hash name\n(<some_name>.php?b=<hash>).\n\n  - Read contents of the folder with the hash name from the C&C server, then download and run\nexecutables from that particular folder.\n\nThe malware operators can then upload binaries of shells or file stealers that will be executed into\nthe respective folders. The directories of their C&C server were unsecured, and we were able to\naccess all their registered victims (hashes) — numbering around 50 — as well as the other\nbackdoors and file stealers in their employ.\n\n15  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 15: List of victims infected with sctrls in the open directory. Six directory names correspond to\n\na date, implying they are different campaigns\n\n## ByeBye Shell\n\nByeBye Shell is a custom shell usually bundled with decoy documents. For instance, when a dropper\nis executed, a decoy document is displayed and the backdoor runs in the background. ByeBye Shell\nsupports a few basic commands: shell, comd, sleep, quit, and kill.\n\nFigure 16: Commands implemented by ByeBye Shell\n\n16  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n|shell|create a cmd.exe process with redirected input and output|\n|---|---|\n|comd|supported commands: put, EXIT, dup, exe, fget, fput, getproc, listdir, copyfile, exec fget and fput are used for sending and receiving files|\n|sleep|sleep for 30 minutes; send the string “BYE BYE” back to the C&C server|\n|quit|disconnect the current connection, sleep for a while, then try to connect again|\n|kill|kill itself and exit the backdoor thread|\n\n\nTable 2: ByeBye Shell’s commands; note that there are variants of ByeBye Shell\n\nwith different subsets of commands, and not all are always implemented\n\nThe executables have two hardcoded strings that are sent back to the C&C server when a host is\ninfected. They probably serve as a sort of campaign name or tag, with some dating as far back as\n2014. A particular modification of ByeBye Shell tracks all the infected victims in a simple .php\ninterface. The machine names possibly indicate their targets: military officials and businessmen,\namong others. Confucius recently started tagging machines related to security researchers, probably\nto avoid sending commands to them.\n\nThe shell application kept regularly posting the base64-encoded machine name and volume serial\nnumber (Figure 15). “Terminal Status” can be enabled by anyone who has access to the control\npanel. When “On” is selected, the affected machine establishes a connection on the same domain to\nport 4443, which opens ByeBye Shell’s main functionality.\n\nFigure 17: ByeBye Shell’s interface showing Confucius’ campaigns\n\n17  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 18: ByeBye Shell’s binary contains the word “smurf” in its PDB path, too\n\n## remote-access-3\n\nThis backdoor (remote access tool) is internally named as “remote-access-c3” as shown in its PDB\npath:\n\nFigure 19: Internal name of remote-access-3\n\nThe remote-access-c3 backdoor seems to be inspired by Patchwork’s NDiskMonitor because they\nshare some behaviors, strings, and commands. remote-access-c3 is written in C++ using the\nStandard Template Library (STL) library. When remote-backdoor-c3 is executed, it waits for a certain\ntime, because of its long initial time delay. It later loads and executes all modules saved in the\nsystem registry, establishes persistence via Task Scheduler, and starts a beaconing thread.\n\nThe beaconing thread queries live.php script with parameters license, which is the username\nUnicode-encoded (\\uXXXX) then base64 encoded, with parameters current_license (base64encoded OS version) and bui, which is probably the backdoor ID.\n\n18  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nFigure 20: Beaconing request of remote-access-c3\n\nIn its C&C command processing loop, there are familiar commands also seen in NDiskMonitor, such\nas cme-update, which also splits the received response with the pipe (“ | ”) character and the of use\nof cmd /c to call the command. Like NDiskMonitor, it also sends the program running response to\ncomponent_update.php. Additionally, the ue| command for downloading and executing the payload\nis implemented in STL backdoor.\n\nThe command mod|, not found in NDiskMonitor, adds or removes modules. Each module is stored in\nthe registry. The backdoor also searches for one of three characters in the C&C response: 0 for\nloading the module into memory and executing it immediately; 1 for storing module binary data to\nthe registry; and 2 for deleting module binary data from the registry.\n\nIn one version of remote-access-c3, the strings inside the binary are not obfuscated and clearly\nvisible. Others had their strings encrypted by various simple algorithms, e.g. XOR with a constant\nvalue and subtracting a constant value from each byte, among others.\n\nFigure 21: Implemented backdoor commands of remote-access-c3\n\n19  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n## ReverseShellSimple and Tweety reverse shells\n\nReverseShellSimple, named as such from its PDB path, is a simple reverse shell that calls create\nprocess where standard input, output, and error handles are redirected to the socket. Tweety is\nwritten in Python, distributed as a Python file compiled to EXE. Decompilation shows that the shell\nwaits for commands and reports its name as “Tweety”.\n\nThe implemented commands are:\n\n  - uu — takes a file, encodes it with base64, and sends it to the C&C server\n\n  - cd — changes the directory\n\n  - quit — exits the shell session\n\nIf none of the predefined commands match, then the received command is passed to the\nsubprocess.Popen call. The parameter “shell=True” means “the specified command will be executed\nthrough the shell,” according to the documentation. The output value of the command executed via\nshell is sent back to the C&C server. Because of the “Tweety” string, we believe this is somehow\nlinked with the Tweety Chat application.\n\nFigure 22: Tweety’s reverse shell internal name (top), and shell command execution (bottom)\n\n## sip_telephone backdoor\n\nsip_telephone, also named in the PDB path as such, uses Windows Management Instrumentation\n(WMI) to get the AV installed in the machine, its computer name, and processor ID, among others. It\nperforms tasks in an endless loop, with 100 seconds of sleep time:\n\n1. Create a folder on the remote server.\n\n2. Create a file named COM_INFO.txt in the remote folder with the contents (installed AV\n\nsoftware, IP-machine name, etc.).\n\n3. Downloads app.jpg from a server’s directory whose name corresponds to the list of\n\nprocessor IDs – machine_name.\n\n20  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n4. If the corresponding directory contains app.jpg, then this file is downloaded and executed.\n\napp.jpg file is downloaded and executed into c:\\ProgramData\\<PC_name>\\<random_name>\nfrom a list:\n\n\n\n- word.exe\n\n- csvt.exe\n\n- steam.exe\n\n- PowerPoint.exe\n\n- daemon.exe\n\n\n\n- ntfs.exe\n\n- appsec.exe\n\n- geforce.exe\n\n- inteldriver.exe\n\n- windowsdrv.exe\n\n\n\n- drv.exe\n\n- svshot.exe\n\n- polsrv.exe\n\n- proxystr.exe\n\n\nIn at least one case, we noticed that putty.exe was uploaded instead into app.jpg, probably\nfor testing purposes.\n\n5. Delete the app.jpg file from the remote server.\n\nFigure 23: List of victims infected by sip_telephone backdoor\n\nMost of the directories were empty. Attackers control victims by uploading the app.jpg file into the\ndesired directory, but these files are eventually deleted. In a specific directory, this malware\ncompromised about 150 hosts, most of them on December 21, 2017.\n\n21  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n# Information stealers\n\n## file-sweeper\n\nBased on its internal strings (URL paths and parameters, etc.), it seems to be very similar to\nPatchwork’s Wintel stealer, which was written in .NET. However, file-sweeper is written in C++ using\nSTL library. file-sweeper steals Word documents (.docx, .doc), PowerPoint files and slideshows\n(.pptx, .pps), Excel spreadsheets (.xls, .xlsx), and Portable Document Format files (.pdf).\n\nFigure 24: file-sweeper’s strings are similar to the Wintel stealer (top);\n\nthe list of files it steals is also in the body (bottom)\n\n## swissknife2\n\nswissknife2 is a Python script compiled into an EXE file with open-source tool PyInstaller. It is\npossible to decompile the file into .py source code and analyze its functions, which are:\n\n1. Enumerating all files in ~\\Downloads, ~\\Document, ~\\Desktop and in DRIVE_REMOVABLE,\n\nDRIVE_FIXED, DRIVE_REMOTE, which are not A or C.\n\n22  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n2. Creating a folder username{volumeSerialNumber} in the cloud service for each victim:\n\n3. Uploading files with .pdf, .doc, .docx, .ppt, .pptx, .xls, and .xlsx to the cloud service.\n\nAs mentioned in the documentation from the cloud storage provider, an access token is required to\ncommunicate with the account. This token can be obtained from swissknife2’s decompiled script.\nAccess to the token allowed us to write a script that enumerates all the folders and files that were\nuploaded to the account. The third Boolean parameter, as per the documentation, is called\ninclude_deleted. If its value is True, “the results will include entries for files and folders that used to\nexist but were deleted.”\n\nDuring the research, data of around 60 victims was uploaded to a Confucius-owned cloud storage\nservice account. There were also a few thousand files in the account that were later deleted. We did\nnot get any of these files and only managed to obtain the metadata indicating they previously existed\nin the account.\n\n## svctrls and Winframe stealers\n\nThis file stealer is written in Delphi and pilfers images (.png, .jpg, .jpeg), spreadsheets (.xls, .xlsx),\ndocuments (.doc, .docx, .pdf), PowerPoint files (.ppt, .pptx), personal storage tables containing\nmessages, calendar events, and others in Microsoft software such as Exchange and Outlook (.pst),\noffline folder files in Outlook (.ost), and data record files (.csv). The stolen files are uploaded over\nHTTP via multipart request.\n\nWinframe is very similar to svctrls, which is also written in Delphi. It steals files with the same\nextensions, and uploads them to the C&C server over HTTP via multipart request.\n\nFigure 25: Multipart request that sends a stolen file to the C&C server\n\n23  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n## usctrls stealer\n\nusctrls is an external media file stealer that scans USB drives or CDs for certain extensions. It then\ncopies any file of interest it finds to %AppData%\\Roaming\\OffLogs\\. The file\n%AppData%\\Roaming\\OffLogs\\items.log will contain a list of file names that were copied from the\nremovable media. The binary file contains one timer that takes care of the persistence. It also has\ntwo callbacks (Aval = available, and Rved = removed), which are called when the external media is\ninserted or removed. usctrls searches for and copies PDFs, Word documents (.doc, docx),\nPowerPoint files (.ppt, .pptx), and Excel spreadsheets (.xls, .xlsx).\n\nFigure 26: List of the uscrtls’ stealer components\n\n## fileUpload stealer\n\nfileUpload is named after the PDB path in its malicious binary. Written in C++, its code shares\nsimilarities with a version of ByeBye Shell. It connects to a .php file to decide which functions should\nbe switched on or off for which users. When doing these POST requests, it sends two values in\nPOST parameters:\n\n  - teststr=base64(<user_name>{<volume_serial_number>})\n\n  - testval=eEBRQVoh\n\nFigure 27: fileUpload stealer’s parameters\n\n24  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\n|ZnJlZWludHJuZXQuY29t|freeintrnet[.]com|\n|---|---|\n|d2lubG9nLmZycA==|winlog.frp|\n|ZmF1bHRzdGF0dXMucHJm|faultstatus.prf|\n|c3RhdHVzLmZycA==|status.frp|\n|QnJvd3NlclVwZGF0ZS5sbms=|BrowserUpdate.lnk|\n|VXBkYXRlIEJyb3dzZXI=|Update Browser|\n|L2luZXRncmlkL3ByZXNlbnQucGhw|/inetgrid/present.php|\n|L2luZXRncmlkL2Fja3BvbGNtZC5waHA=|/inetgrid/ackpolcmd.php|\n|L3VwbG9hZGVyLnBocA==|/uploader.php|\n|b2ZmTG9nc1xc|offLogs\\\\|\n\n\nTable 3: fileUpload’s strings are base64-encoded\n\nfileUpload searches for and steals Word documents (.doc, .docx), PowerPoint files (.ppt, .pptx),\nExcel spreadsheets (.xls, .xlsx), and PDFs, then uploads them to the C&C server. We actually saw\nother versions of this file stealer. One version employed a hook that counted left mouse button\nclicks. Once it reaches a specified number, another function is activated, which we think serves as\nan anti-sandbox routine.\n\n25  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations\n\n\n-----\n\nConfucius illustrates the hazards of [targeted attacks: Patient, persistent, and raring to exploit](http://targetedattacks.trendmicro.com/cyoa/en/)\nvulnerabilities in people, processes, and technology. As organizations increasingly digitize\ninformation, their exposure to theft also broadens. Traditional defenses will be more challenging to\nmaintain, and these need to be complemented with defense in depth and improved awareness. Here\nare some countermeasures organizations can adopt:\n\n  - Mind the security gaps: Keep the system, its programs/applications, and network updated;\n[create more robust patch management](https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/patching-problems-and-how-to-solve-them) [and incident response and remediation policies that](http://blog.trendmicro.com/trendlabs-security-intelligence/four-steps-to-an-effective-targeted-attack-response/)\nwill highlight security without hindering business operations. Consider [virtual patching](https://www.trendmicro.com/en_us/business/capabilities/intrusion-prevention.html?cm_re=10_19_17-_-2d_Capabilities-_-IntrusionPrevention) for\nlegacy or end-of-life systems.\n\n  - Enforce the principle of least privilege: Remove the attackers’ leverage by preventing access\nto the organization’s crown jewels. [Network segmentation](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/protecting-data-through-network-segmentation) reduces traffic congestion while\nrestricting user privileges, thus preventing lateral movement. [Data categorization, which](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/keeping-digital-assets-safe-need-for-data-classification)\ndifferentiates data by their value, mitigates the damage in case of a breach.\n\n  - [Restrict and secure the use](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/best-practices-securing-sysadmin-tools) of tools such as [PowerShell and other](https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-101-the-rise-of-fileless-threats-that-abuse-powershell) [command-line tools](https://www.trendmicro.com/vinfo/us/security/news/security-technology/2017-notably-abused-system-administration-tools-and-protocols)\ntypically reserved for the organization’s system administrators and information security staff\nto prevent their abuse. Disable outdated and unnecessary extensions, plugins, and\ncomponents that interact with the system’s programs, as they can also be used as entry\npoints.\n\n  - As technology [broadens horizons, so will the attackers’. Proactively monitor your](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2018)\ninfrastructure, as each layer can be used as a doorway into the organization — from its\nphysical perimeters, and online [gateways,](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoints,](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) [network, and](https://www.trendmicro.com/en_us/business/products/network.html) [servers.](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security-data-center.html) [Firewalls](https://www.trendmicro.com/vinfo/us/security/news/security-technology/best-practices-deploying-an-effective-firewall) and\n[intrusion detection and prevention systems](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html) help block network-based threats. [Application](https://www.trendmicro.com/en_ph/business/products/user-protection/sps/endpoint/endpoint-application-control.html)\ncontrol and behavior monitoring prevent suspicious files and anomalous behaviors from\nexecuting within the system, while URL filtering/categorization blocks malicious URLs and\nmalware-hosting sites.\n\n  - Play it smart and don’t take the bait: [Email-borne](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/infosec-guide-email-threats) threats and [malicious mobile apps](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/-infosec-guide-bring-your-own-device-byod) rely\nheavily on social engineering to be successful. Empowering and nurturing the workplace\nwith stronger cybersecurity awareness helps — even something as simple as knowing how\nto identify red flags in spam email can stand between an attacker and the organization’s\nbottom line.\n\n26  |  Deciphering Confucius: A Look at the Group’s Cyberespionage Operations Defending Against Targeted Attacks\n\n\n-----\n\n# Trend Micro Solutions Trend Micro™Deep Discovery™ provides detection, in-depth analysis, and proactive response to today’s stealthy malware, and targeted attacks in real time. It provides a comprehensive defense tailored to protect organizations against targeted attacks and advanced threats through specialized engines, customsandboxing, and seamless correlation across the entire attack lifecycle, allowing it to detect threats delivered by Confuciuseven without any engine or pattern update.Trend Micro™ Deep Security™, Vulnerability Protection, and TippingPointprovidevirtual patchingthat protects endpoints from threats that abuses unpatched vulnerabilities.Confucius’ Trojanized documents can use email as an entry point, which makes securing the email gateway important. Trend Micro™Hosted Email Securityis a no-maintenance cloud solution that delivers continuously updated protection to stop spam, malware, spear phishing, ransomware, and advanced targeted attacks before they reach the network. Trend Micro™ Deep Discovery™ Email InspectorandInterScan™ Web Securityprevent malware from ever reaching end users. At the endpoint level,Trend Micro™ Smart Protection Suitesdeliver several capabilities that minimize the impact of Confucius’ attacks.End users and enterprises can also benefit from multilayered mobile security solutions such asTrend Micro™Mobile Security for Android™ which is also available on Google Play.Trend Micro™Mobile Security for Enterpriseprovides device, compliance and application management, data protection, and configuration provisioning, as well as protects devices from attacks that leverage vulnerabilities, preventing unauthorized access to apps, as well as detecting and blocking malware and fraudulent websites.Trend Micro’sMobile App Reputation Service(MARS) covers Android and iOS threats using leading sandbox and machine learning technologies. It can protect users against malware, zero-day and known exploits, privacy leaks, and application vulnerability.These solutions are powered by the Trend MicroXGen™ security, whichprovides a cross-generational blend of threat defense techniques against a full range of threats fordata centers,cloud environments,networks, andendpoints. It features high-fidelity machine learning to secure thegatewayandendpointdata and applications, and protects physical, virtual, and cloud workloads.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        }
    ],
    "references": [
        "https://documents.trendmicro.com/assets/research-deciphering-confucius-cyberespionage-operations.pdf"
    ],
    "report_names": [
        "research-deciphering-confucius-cyberespionage-operations.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1518110990,
    "ts_modification_date": 1518110990,
    "files": {
        "pdf": "https://archive.orkl.eu/7a459f92c2ba0f37f6e378a60f00890953381338.pdf",
        "text": "https://archive.orkl.eu/7a459f92c2ba0f37f6e378a60f00890953381338.txt",
        "img": "https://archive.orkl.eu/7a459f92c2ba0f37f6e378a60f00890953381338.jpg"
    }
}