{
    "id": "391f21cf-006e-4459-b7f9-aafcc7c8c5a5",
    "created_at": "2023-01-12T15:03:03.016571Z",
    "updated_at": "2025-03-27T02:16:44.904653Z",
    "deleted_at": null,
    "sha1_hash": "d3e6b42c4fae7387d3133860dfc8e998bf4cb8ad",
    "title": "2017-03-29 - Trojanized Adobe installer used to install DragonOK’s new custom backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T17:30:44Z",
    "file_modification_date": "2022-05-28T17:30:44Z",
    "file_size": 791048,
    "plain_text": "# Trojanized Adobe installer used to install DragonOK’s new custom backdoor\n\n**[forcepoint.com/de/blog/x-labs/trojanized-adobe-installer-used-install-dragonok-s-new-custom-backdoor](https://www.forcepoint.com/de/blog/x-labs/trojanized-adobe-installer-used-install-dragonok-s-new-custom-backdoor)**\n\nMarch 29, 2017\n\nSince January of this year, Forcepoint Security Labs™ have observed that the DragonOK\ncampaign have started to target political parties in Cambodia. DragonOK is an active\ntargeted attack that was first [discovered in 2014. It is](https://www.scmagazine.com/moafee-and-dragonok-apt-groups-leverage-similar-attack-tools-techniques/article/539927/) [known to target organizations from](http://www.securityweek.com/china-linked-dragonok-group-expands-operations)\nTaiwan, Japan, Tibet and Russia with spear-phishing emails containing malicious\nattachments.\n\nThe latest dropper they used is disguised as an Adobe Reader installer and installs yet\nanother new custom remote access tool (RAT). We have named this RAT “KHRAT” based on\none of the command and control servers used, kh[.]inter-ctrip[.]com, which pertained to\nCambodia’s country code.\n\n## Dropper\n\nThe trojanized installer is a RAR SFX file that has the filename\n“reader112_en_ha_install.exe”. It contains both a legitimate Adobe Reader installer and a\nmalicious VBScript file:\n\n\n-----\n\nAs a result, when the malware is executed, the user is presented with the legitimate Adobe\ninstaller prompt while the malicious VBScript executes in the background. Below is a code\nsnippet of the VBScript:\n\nUpon deobfuscating the script, the following code is revealed which installs of a portable\nexecutable (PE) file embedded in the script:\n\n\n-----\n\nAs can be seen above, the PE file is dropped as %USERPROFILE%\\USER.DAT and is\nexecuted with a parameter \"K1\". This PE file is KHRAT, which will be discussed in the next\nsection.\n\n## KHRAT\n\nKHRAT is a small backdoor that has three exports (functions), namely, K1, K2, and K3. K1\nchecks if the current user is an administrator. If not, it uninstalls itself by calling the K2\nfunction.\n\nOtherwise, it creates the following registry as a persistence mechanism and then calls the\nfunction K3:\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\nRun = \"\"%USERPROFILE%\\SysWOW64.com\" %USERPROFILE%\\USER.DAT,K1\"\n\n```\n\n-----\n\nK3 then elevates the malware s privilege, by giving itself SE_DEBUG_PRIVILEGE privileges\nvia a RtlAdjustPrivileges call, and proceeds to communicate to its command and control (C2)\nserver. The malware initially registers itself to the C2 server by sending the infected\nmachine’s username, system language, and local IP address.\n\nAll communication to and from the C2 server are encrypted in byte-wise XOR. Below is a\ncode snippet showing this routine prior to sending data to the malware C2:\n\nKHRAT is capable of executing the following backdoor commands:\n\nProvide access to the file system\nLog keystrokes\nCapture screenshots\nEnumerate processes\nOpen a remote DOS command access\n\nFurthermore, the following table provides a timeline of KHRAT's appearances, with one\nappearing earlier this month:\n\n\n**SHA-256**\n\n\n**Compilation**\n**Timestamp**\n\n\n17a07b1f5e573899c846edba801f1606ce8f77c2f52e3298d2d2b066730b0bf0 05/01/2017\n05:37\n\na5a9598e1d33331f5aeabb277122549d4a7cf1ddbfa00d50e272b57934a6696f 05/01/2017\n05:37\n\n540d6dd720514cf01a02b516a85d8f761d77fa90f0d05f06bfb90ed66beb235b 16/02/2017\n03:53\n\nffc0ebad7c1888cc4a3f5cd86a5942014b9e15a833e575614cd01a0bb6f5de2e 08/03/2017\n01:43\n\n## Protection statement\n\n\n-----\n\n[Forcepoint customers are protected against this threat via TRITON® ACE at the following](https://www.forcepoint.com/innovation/technology/triton-ace?cmpid=slbl)\nstages of attack:\n\nStage 5 (Dropper File) - Related malware components are prevented from being downloaded\nand/or executed.\n\nStage 6 (Call Home) - Connections to the KHRAT command and control servers are blocked.\n\n## Conclusion\n\n[KHRAT’s code is reminiscent of the backdoors used in HeartBeat and](http://blog.trendmicro.com/trendlabs-security-intelligence/pulsing-the-heartbeat-apt/) [Bioazih campaigns](https://blogs.technet.microsoft.com/mmpc/2015/04/13/bioazih-rat-how-clean-file-metadata-can-help-keep-you-safe/)\nwhere the coding style is straight forward and the malware itself provides basic backdoor\nfunctionalities to the attackers. This leads us to believe that KHRAT is simply a rehash of\ncodes that are available on Chinese code sharing sites. Nonetheless, this would seem\nenough for the attackers in this case as KHRAT variants currently have a low detection rate.\nWe have listed below the related IOCs to help augment industry coverage for this new threat.\n\n## Indicators of Compromise\n\n### Files\n```\nbba604effa42399ed6e91c271b78b442d01d36d1570a9574acacfc870e09dce2\n(\"reader112_en_ha_install.exe\", dropper)\nffc0ebad7c1888cc4a3f5cd86a5942014b9e15a833e575614cd01a0bb6f5de2e (“USER.DAT”, KHRAT)\n9cdebd98b7889d9a57e5b7ea584d7e03d8ba67c02519b587373204cae0603df0 (RTF dropper with\nCVE-2015-1641 exploit, unknown filename)\nd9ce24d627edb170145fb78e6acb5ea3cb44a87cd06c05842d78f4fc9b732ec5 (“KFC.exe”, KHRAT\nloader)\na5a9598e1d33331f5aeabb277122549d4a7cf1ddbfa00d50e272b57934a6696f (“MSKV.DAT”, KHRAT)\na6e22dfe21993678c6f1b0892c2db085bb8c4342bdf78628456f562d5db1181b (“The plan CPP split\nCNRP!.doc.exe”, dropper)\n77354141d22998d7166fd80a12d9b913199137b4725495bd9168beb5365f69e7 (“KFC.com”, KHRAT\nloader)\n540d6dd720514cf01a02b516a85d8f761d77fa90f0d05f06bfb90ed66beb235b (“MSKV.DAT”, KHRAT)\n17a07b1f5e573899c846edba801f1606ce8f77c2f52e3298d2d2b066730b0bf0 (“MSKV.DAT”, KHRAT)\n\n KHRAT C2s\ncookie[.]inter-ctrip[.]com\nhelp[.]inter-ctrip[.]com \nbit[.]inter-ctrip[.]com\nkh[.]inter-ctrip[.]com\n\n Über Forcepoint\n\n```\n\n-----\n\nForcepoint ist einer der weltweit führenden Anbieter von Cyber-Sicherheit im Bereich\nAnwender- und Datensicherheit und hat es sich zur Aufgabe gemacht, Organisationen zu\nschützen und gleichzeitig die digitale Transformation und das Wachstum voranzutreiben.\nUnsere Lösungen passen sich in Echtzeit an das Nutzerverhalten an und ermöglichen\nMitarbeitern einen sicheren Datenzugriff bei voller Produktivität.\n\n[Erfahren Sie mehr über Forcepoint](https://www.forcepoint.com/de/company/about-us)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-03-29 - Trojanized Adobe installer used to install DragonOK’s new custom backdoor.pdf"
    ],
    "report_names": [
        "2017-03-29 - Trojanized Adobe installer used to install DragonOK’s new custom backdoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "d7226f71-df4a-405e-9252-f8c4108303ae",
            "created_at": "2022-10-25T15:50:23.325171Z",
            "updated_at": "2025-03-27T02:00:55.442519Z",
            "deleted_at": null,
            "main_name": "Moafee",
            "aliases": [
                "Moafee"
            ],
            "source_name": "MITRE:Moafee",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5ffe400c-6025-44c2-9aa1-7c34a7a192b0",
            "created_at": "2023-01-06T13:46:38.469688Z",
            "updated_at": "2025-03-27T02:00:02.84172Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Moafee",
                "BRONZE OVERBROOK",
                "G0017",
                "G0002",
                "Shallow Taurus"
            ],
            "source_name": "MISPGALAXY:DragonOK",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ebda3c6-1789-4d84-97cf-47fb18a0cb28",
            "created_at": "2022-10-25T15:50:23.78829Z",
            "updated_at": "2025-03-27T02:00:55.547275Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "DragonOK"
            ],
            "source_name": "MITRE:DragonOK",
            "tools": [
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "60d9c778-488b-459e-a2f6-9e48c607ba45",
            "created_at": "2022-10-25T16:47:55.606462Z",
            "updated_at": "2025-03-27T02:05:17.281676Z",
            "deleted_at": null,
            "main_name": "BRONZE OVERBROOK",
            "aliases": [
                "DragonOK ",
                "Samurai Panda ",
                "Temp.DragonOK ",
                "Danti "
            ],
            "source_name": "Secureworks:BRONZE OVERBROOK",
            "tools": [
                " DDKONG",
                " HelloBridge",
                " IsSpace",
                " NFLog Trojan",
                " PLAINTEE",
                " PlugX",
                " Rambo",
                "Aveo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "340d1673-0678-4e1f-8b75-30da2f65cc80",
            "created_at": "2022-10-25T16:07:23.552036Z",
            "updated_at": "2025-03-27T02:02:09.85925Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Bronze Overbrook",
                "Shallow Taurus"
            ],
            "source_name": "ETDA:DragonOK",
            "tools": [
                "Agent.dhwf",
                "CT",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "HelloBridge",
                "IsSpace",
                "KHRAT",
                "Kaba",
                "Korplug",
                "Mongall",
                "NFlog",
                "NewCT",
                "NfLog RAT",
                "PlugX",
                "Poison Ivy",
                "Rambo",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "SysGet",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TidePool",
                "Xamtrav",
                "brebsd",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3c08eb0-cced-43ab-b126-fbe0c39a0698",
            "created_at": "2022-10-25T16:07:23.872885Z",
            "updated_at": "2025-03-27T02:02:10.00467Z",
            "deleted_at": null,
            "main_name": "Moafee",
            "aliases": [],
            "source_name": "ETDA:Moafee",
            "tools": [
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Mongall",
                "NFlog",
                "NewCT2",
                "Poison Ivy",
                "SPIVY",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535783,
    "ts_updated_at": 1743041804,
    "ts_creation_date": 1653759044,
    "ts_modification_date": 1653759044,
    "files": {
        "pdf": "https://archive.orkl.eu/d3e6b42c4fae7387d3133860dfc8e998bf4cb8ad.pdf",
        "text": "https://archive.orkl.eu/d3e6b42c4fae7387d3133860dfc8e998bf4cb8ad.txt",
        "img": "https://archive.orkl.eu/d3e6b42c4fae7387d3133860dfc8e998bf4cb8ad.jpg"
    }
}