{
    "id": "73211732-6b2c-4c08-a914-d10eaf88c37b",
    "created_at": "2023-01-12T15:10:30.900543Z",
    "updated_at": "2025-03-27T02:17:23.691555Z",
    "deleted_at": null,
    "sha1_hash": "042edef24d956630233466d41ecb7a4ba7d064e9",
    "title": "2022-06-12 - How SeaFlower 藏海花 installs backdoors in iOS-Android web3 wallets to steal your seed phrase",
    "authors": "",
    "file_creation_date": "2022-06-18T23:17:58Z",
    "file_modification_date": "2022-06-18T23:17:58Z",
    "file_size": 14311201,
    "plain_text": "# How SeaFlower 藏海花 installs backdoors in iOS/Android web3 wallets to steal your seed phrase\n\n**blog.confiant.com/how-seaflower-藏海花-installs-backdoors-in-ios-android-web3-wallets-to-steal-your-seed-phrase-**\nd25f0ccdffce\n\ntaha aka \"lordx64\" June 14, 2022\n\nPhoto by on\n[During the course of our work at Confiant, we see malicious activity on a daily basis. What](https://www.confiant.com/)\nmatters the most for us is the ability to:\n\nProtect our existing customers.\nShare unique threat intelligence.\nKeep finding unique vantage points for better detection.\n\nAt Confiant we monitor 2.5+ billion ads per day thanks to our 110+ integrations in the\nadvertising stack allowing us to protect 40K premium websites from bad ads.\n\n\n-----\n\nThat itself gives us great visibility on malicious activity infiltrating the ad stack and the\nbroader Internet, powered by our proprietary uncloaking technology. And that includes all the\nweb3 malicious activity funneling thru it.\n\nThe variety and the range of our detection enable us to detect unique malicious activity as\nsoon as it surfaces. SeaFlower is an example of this unique cluster of malicious activities\ntargeting web3 wallet users that we will document in this blog post.\n\n## What is SeaFlower?\n\nSeaFlower is a cluster of activity that we identified earlier this year in March 2022. We\nbelieve SeaFlower is the most technically sophisticated threat targeting web3 users, right\nafter the infamous Lazarus Group.\n\nThe cluster of activity named “SeaFlower” was chosen for a reason. One of the injected\n.dylib files in the original Mach-O of the metamask app, contained the full path to xcode\nderived data, that leaked a macOS username: “Zhang Haike”:\n\nAuthor username leak\n\nNote: this same mistake was made on other libraries that helped leaking more macOS\nusernames, and thus uncovering a set of personas related to SeaFlower\n\nNaturally, Googling “Zhang Haike” was the next step, which gave many Chinese-speaking\n[references, including this one that I found amusing: it is the name of a character in a Chinese](https://daomu-biji.fandom.com/wiki/Zhang_Haike)\n[novel called “Tibetan Sea Flower”.](https://daomu-biji.fandom.com/wiki/Tibetan_Sea_Flower_(Zang_Hai_Hua))\n\nThe Chinese-speaking references conform to the context of this large campaign, and hint to\na strong relationship with a Chinese-speaking entity yet to be uncovered:\n\nUncovered macOS usernames are Chinese names\nSource code comments in the backdoor code are written in Chinese.\nModding/hooking Frameworks used are common in the Chinese-speaking modding\ncommunity, based on the fact that many tutorials and usages example of these\nFrameworks are in Chinese and the authors of the tools are Chinese speaking.\nWe uncovered Provisioning profiles, signing infrastructure, and app provisioning\ninfrastructure hosted in the Chinese IP address space and the Hong Kong IP address\nspace in addition to the domains registered with .cn TLD. Note: signing infrastructure\nand provisioning infrastructure might or might not be directly related to SeaFlower as it\ncould be abused or just used as a service.\nWe uncovered multiple cloned websites (mimicking official wallet websites) initially\nhosted in Hong Kong IP address space\n\n\n-----\n\nCDN abused is Alibaba\nMost of the search engines targeted are Chinese search engines.\n\n[As of today, the main current objective of SeaFlower is to modify web3 wallets with backdoor](https://moralis.io/what-is-a-web3-wallet-web3-wallets-explained/)\ncode that ultimately exfiltrates the seed phrase.\n\nThe targeted web3 wallets are the following:\n\n(iOS, Android)\nwallet (iOS, Android)\n(iOS, Android)\n(iOS, Android)\n\nNote: The wallets above are 100% safe and you can use them safely. But like any\nother good and very popular software, they are exposed to modding, reverse\nengineering, and backdoors. SeaFlower distributes a backdoored version of these\nwallets by modifying the original ones.\n\nAny users lured into downloading SeaFlower backdoored wallets will ultimately lose their\nfunds. We provided SHA-256 of each analyzed backdoored wallet to help our community\nidentify these backdoored wallets and their multiple variants.\n\n## SeaFlower Modus operandi\n\nLooking at the various attacks in this new cluster, they have something in common:\nSeaFlower doesn’t alter the original functionality of the wallet in any way but adds **code to**\n**exfiltrate the seed phrase, and does it using different techniques increasing in complexity,**\nhopefully, documented in this blog post.\n\nThe user experience, the UI, and all the wallet functionality are unchanged, normal/advanced\nusers won’t notice anything while using the app on their phones: it is the legitimate app from\nthe AppStore/Play Store with a sneaking backdoor in it.\n\nBut if one is actively monitoring network requests, one will find out that there’s a single\nnetwork request that is sent to weird-looking domains, for example, we have seen\nbackdoored wallets sending traffic to trx.lnfura[.]org (mimicking infura.io) or metanask[.]cc\n(mimicking metamask.io) over HTTPS.\n\nSetting up a MITM proxy we could decrypt the HTTPS traffic and find out that the seed\nphrase, the wallet address, and the balance are sent out to the attacker:\n\n\n-----\n\nIntercepting HTTPS traffic of SeaFlower backdoor\nBut how this is possible? we will have to reverse engineer the apps to determine all the\ntechniques SeaFlower used to make these legitimate apps behave maliciously in the\nbackground.\n\nSeaFlower drastically differs from the other web3 intrusion sets we track, with little to no\noverlap from the Infrastructure in place, but also from the technical capability and\ncoordination point of view: Reverse engineering iOS and Android apps, modding them,\nprovisioning, and automated deployments.\n\nSeaFlower also takes care of the app distribution phase by setting up fake cloned websites\nwhere these backdoored wallets can be downloaded. The identified websites are perfect\nclones of legitimate websites, offering download links:\n\n\n-----\n\nimToken cloned website (courtesy of DomainTools) hosted at: appim[.]xyz\n\ncloned Metamask website, hosted at: https://74871011[.]huliqianbao[.]com/download.html\n\n\n-----\n\ncloned Coinbase Wallet website hosted at som-coinbase[.]com\n\ncloned token pocket website hosted at fastrpo[.]com\nNote: Surprisingly we didn’t find a backdoored chrome extension delivered from these clone\nwebsites, all the links point to the real chrome extension in the Chrome Webstore, so as of\nnow, fake chrome extension delivery isn’t part or wasn’t identified in the SeaFlower intrusionset.\n\n\n-----\n\nFor iOS, SeaFlower is using provisioning profiles. Once installed, the iOS apps are then\nsideloaded to the victim's phone and installed. Below are some of the steps we recorded of\ntypically what the victim will see when browsing one of the SeaFlower websites using an\niPhone:\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\niPhone with multiple installed backdoored wallets\n\nNote: We reported at very early stage of this campaign all the Apple developer id’s\nlinked to these provisioning profiles to Apple and they revoked them. We are planning\nto continue reporting this activity to Apple Threat intelligence teams on a regular basis.\n\nThe last question to be answered is how the users are targeted and redirected to these\nwebsites offering backdoored wallets? short answer: Search Engines. Indeed, search\nengines are one of the clear entry points for SeaFlower that we identified to this date,\nredirecting mobile users to fake/cloned wallet download websites. In particular, Baidu search\nengine results are one of the initial vectors for these attacks.\n\nBaidu, Inc is a Chinese multinational AI technology company with a search engine. We were\ninterested to see if there’s any SEO or targeting to coinbase or metamask users in that\nsearch engine.\n\nWe searched for “download metamask ios” and one of the baidu links on the first results\npage redirected us to token18[.]app website, which was SeaFlower Drive-by download page,\nsweet!\n\n\n-----\n\nSeaFlower targeting via search engine results\n\n\n-----\n\nWhile monitoring for results we started noticing that there was an intermediate website, that\ndoes a fingerprinting before redirecting to the SeaFlower drive-by download pages. We\nextracted the client-side fingerprinting from the HTML pages and we identified a code that\nchecks if the referer matches different search engines, in fact, multiple Chinese search\nengines :\n\nSeaFlower intermediate Fingerprinting\nMost of the search engines mentioned are all Chinese search engines:\n\nChinese search engines targeted by SeaFlower\n\n\n-----\n\nWe created a specific detection rule to hunt for any of the above js code, and we found\nanother piece of code that has bot/spider detections, by checking the userAgent strings, we\ncan see again references to Chinese search engines crawlers/spiders:\n```\nfunction isSpider() {   var flag = false;   var spider =\nnavigator.userAgent.toLowerCase();   var spiderSite = ['baiduspider', 'baidu.',\n'360Spider', 'sogou.', 'soso.', 'yisouspider', 'bingbot', 'bing.', 'google.',\n'googlebot'];   for (let i = 0, len = spiderSite.length; i < len; i++) {     \nif (spider.indexOf(spiderSite[i]) > 0) {       flag = true;       \nbreak;     }   }   if (!flag) {     goPAGE();   } }\n\n```\nThis particular campaign tells us more about the initial vector and the targeting that seems to\nbe search engine oriented, with the majority being Chinese search engines.\n\n\n-----\n\nAt this point, we defined some initial context and learned a bit more about who could be\npotentially targeted by SeaFlower.\n\nNext, is the backdoored wallets technical analysis part, we will shed some light on how\nSeaFlower is backdooring the web3 wallets. For readability, we will document in this blogpost\nhow iOS MetaMask wallet and Android Coinbase wallet were backdoored in great detail.\nThe other flavors of these wallets (iOS, Android) and the other wallets (imToken,\nTokenPocket) are using very similar backdoor code and won’t be all covered in this blogpost\nbut will be briefly documented especially the most relevant parts.\n\n## MetaMask wallet\n\n MetaMask iOS app\n\nSHA-256 .IPA file analyzed:\n9003d11f9ccfe17527ed6b35f5fe33d28e76d97e2906c2dbef11d368de2a75f8\n\nMetaMask for mobile is a React native app, meaning it can run on both iOS and Android.\nThe first signs of backdoor code can be found at the main.jsbundle.\n\nA conditional code block was added at the beginning of WriteFile() function. This code block\nis not present in the official metamask wallet:\n\nbackdoor code injected inside main.jsbundle\n\n\n-----\n\nzoomed in backdoor code injected inside main.jsbundle\nThis conditional backdoor code will execute anytime writeFile() is called on a file whose path\ncontains “persist-root”. If we look at where this file is located using a real iPhone, it is stored\nwithin the MetaMask app container, it is a configuration file, containing the seed phrase\nencrypted amongst other runtime configuration data. The file is specifically found at the\nfollowing path:\n```\n/private/var/mobile/Containers/Data/Application/{CONTAINER\nUID}/Documents/persistStore/persist-root\n\n```\nThis new information gives us a high-level understanding of when the backdoor code is\ncalled: right after the MetaMask seed-phrase is generated and about to be stored encrypted\nin the “persist-root” file. We confirmed this by installing MetaMask app on a real iOS device\nand indeed a network request with the seed phrase is sent right after the user confirms the\nseed phrase during the wallet's first setup installation, which is pretty neat as a backdoor\nimplementation, and completely invisible during the usage.\n\nThe only issue here is that the startupload() function highlighted above in the backdoor\ncode, isn’t present in the main.jsbundle() and there are 0 references to this function in any\njavascript file or any linked .dylib file exported symbols.\n\n## hunting for startupload()\n\nThis step required reverse engineering and digging into some Arm64 assembly and low-level\ncode as we will see. I will keep it brief to not confuse the readers, hopefully, it will make\nsense:\n\n\n-----\n\nSo I started looking at the MetaMask compiled Mach-O file, and noticed two injected .dylibs :\n\ninjected .dylib’s into MetaMask wallet iOS app\n**libmetaDylib.dylib and mn.dylib seems to be good candidates as these are not supposed**\nto be injected in the original MetaMask iOS Mach-O binary.\n\nTLDR; I am skipping the analysis of mn.dylib as this library is not relevant to the\ncurrent backdoor as we will see later, so I didn’t spend time analyzing it much.\n\n**libmetaDylib.dylib was signed with developer ID iPhone Distribution: pl li (259JS6979T)**\nand team-ID 259JS6979T\n\n**libmetaDylib.dylib contains references to 3 known modding/hooking frameworks: Cycript,**\nCydia Susbtrate, and the Reveal Framework. This is already a red flag, meaning that\nsomething has been done to alter the runtime behavior of the app:\n\nCycript, Susbtrate and Reveal linked/injected with libmetaDylib.lib\nI confirmed Reveal server running in the app container by connecting to it using Reveal app\n(newer versions of Reveal didn’t work, but got some luck with the version 14 10107, likely the\nversion used by SeaFlower) :\n\n\n-----\n\n-----\n\nReveal Framework installed on the backdoored metamask ios app\nFull path to Xcode Derived data was left on the compiled .dylib leaking a macOS username\n“lanyu”\n\nI’ve found multiple references to MonkeyDev Framework which is a hooking & modding utility\nwritten by [AloneMonkey. MonkeyDev has custom Xcode templates](https://github.com/AloneMonkey)\n[https://github.com/AloneMonkey/MonkeyDev-Xcode-Templates which make it fully integrated](https://github.com/AloneMonkey/MonkeyDev-Xcode-Templates)\nto Xcode during the development cycle of these backdoors!\n\n\n-----\n\nMonkeyDev xcode template\nAt this point, there are multiple tools for hooking or modding but still no sign of startupload()\nand its implementation.\n\n## A Backdoor inside a Backdoor\n\nAfter several checks identifying where a backdoor code could be injected I started looking at\nthe injected libraries, and ran the usual class-dump on the libmetaDylib.dylib revealed a\nweird class name FKKKSDFDFFADS, highlighted below:\n\n\n-----\n\nhighlighted weird looking class name\n\nOCMethodTrace is reference to the OCMethodTrace tool written by Michael Chen aka\n[omxcodec, enabling tracing of objective-C classes/methods. OCMethodTrace is also](https://github.com/omxcodec)\npart of MonkeyDev xcode templates: https://github.com/AloneMonkey/MonkeyDevXcode-Templates/blob/master/MonkeyAppLibrary.xctemplate/Trace/OCMethodTrace.h\n\nCross-referencing the class name FKKKSDFDFFADS I got a solid hit on a Logos tweak\ninstalled by the backdoor author, targeting the function\n**dataWithContentsOfFile:options:error the tweek was installed via ()**\n\ntweek defined in _logosLocalInit() function\n\n\n-----\n\nLogos is a Perl regex-based preprocessor that simplifies the boilerplate code needed\nto create hooks for Objective-C methods and C functions with an elegant Objective-C[like syntax. It’s most commonly used along with the Theos build system, which was](https://theos.dev/docs/)\noriginally developed to create jailbreak tweaks\n\nAt this point a malicious dataWithContentsOfFile:options:error implemented by the author\nwill get called right before the original one. The malicious\n**dataWithContentsOfFile:options:error contains the following code:**\n\nbackdoor code called\nat line 39 there’s a clear call to our weird class FKKKSDFDFFADS :)\n\nat line 29 there’s also a test checking a variable path against the string\n**/meta.app/main.jsbundle.**\n\n\n-----\n\nIt seems this function dataWithContentsOfFile:options:error is expecting a .jsbundle file to\nread from and return its content, but let’s take a step back and figure out why the author\nhooked the call of dataWithContentsOfFile:options:error it must be for a specific reason.\n\nGoing back to the initial Mach-O MetaMask there’s a reference to\n**dataWithContentsOfFile:options:error at the function 0x1001339cc:**\n\nthere’s a function at 0x1001339cc calling ::\nThis function is called by RCTJavascriptLoader::loadBundleAtURL\n\nAt this point, we can conclude that the author is trying to inject a backdoor in the form of a\nReact Native Bundle and have it loaded by used by the RCTBridge to load javascript.\n\nEvery react native app starts with the creation of an RCTBridge instance. In this, react\nnative loads the javascript, either from the local packager or a pre-built bundle, and executes\nthis inside JavascriptCore.\n\n\n-----\n\nWe are left with one last exercise to confirm all this and call it a wrap by analyzing the weird\nclass FKKKSDFDFFADS.\n\nBelow is the decompilation of the method FKKKSDFDFFADS::ddsdf:\n\ndecompilation of\nInteresting :) I can see base64 blob of typical RSA pivate key/ public keys What this function\ndoes is RSA decrypting an RSA encrypted blob encoded in b64. The author linked the library\nwith antoher library called SCRSACryptor and found reference to it in github here:\n[https://github.com/xialun/RSAClass](https://github.com/xialun/RSAClass)\n\n\n-----\n\nso I just created a project in xcode, extracted the b64 encrypted blob and the RSA keys,\nlinked it to this library, and wrote the following code snippet to decrypt the blob:\n\ncreated an iOS project and ran it :\n\ndecrypted SeaFlower backdoor\nwe finally got the missing startupload() function :) below is the code of this function:\n\nAbove is the source code startupload() function, all what it does is sending a POST request\nto the trx.lnfura.org domain with the seed phrase information that is stored in the variable\n**xlmnmonic.**\n\nstarting from line 59, we can see code starting with a __BUNDLE_START_TIME__\nconfirming that we are dealing with typical React Native Bundle. The code is basically related\nto the runtime loading of this bundle and to resolving module dependencies, etc:\n\n\n-----\n\ntaken from: Rafael de Oleza —\n**xlmnmonic stores the seed phrase passed to the function _initFromMnemonic we can find**\nit in the main.jsbundle:\n\n**Validating the backdoor code execution at runtime:**\n\nAs with any backdoor code found, it is important to validate it at runtime. I installed the\nbackdoored metamask app on a real iOS device, ran debugserver on iOS and waited with\nLLDB on my laptop to break right after the app is launched. I set a conditional breakpoint to\nbreak into anything “logos” :\n```\nbreak set -r \"logos\" -s libmetaDylib.dylib\n\n```\nthen got a first hit at _logosLocalInit():\n\ndebuging the backdoor code\n\n\n-----\n\nAfter that I stopped at the function I am interested in\n**_logos_meta_method$_ungrouped$NSData$dataWithContentsOfFile$options$error$**\n**(the one added by the backdoor author using ())**\n\nFrom there all I have to do is to find where the obj_msgSend() that will call the weird class\nname FKKKSDFDFFADS::ddsdf, and the backdoor code is finally about to be executed via\nobj_msgSend ()as we can see in the screenshot below:\n\nand that’s a wrap we confirmed statically, and dynamically the backdoor code and its\nexecution.\n\n## Other variants of the MetaMask iOS app backdoor:\n\nby analyzing multiple backdoored iOS MetaMask wallets I found other variants of the\nbackdoor code, with this one having source code comments in Chinese:\n\n**Note: this same backdoor React Native Bundle variant was re-used on the imToken**\nWallet iOS app as well.\n\n## Coinbase Wallet iOS app\n\nSHA-256 of the .IPA analyzed:\n2334e9fc13b6fe12a6dd92f8bd65467cf700f43fdb713a209a74174fdaabd2e2\n\nA single injected dylib libWalletDylib.dylib was used, below output of otool -L:\n```\n@executable_path/Frameworks/libWalletDylib.dylib (compatibility version 0.0.0,\ncurrent version 0.0.0)\n\n```\nThis .dylib is signed with Developper ID certificate : iPhone Distribution: Universitas\n**Muhammadiyah Malang** **(9MJG6A8RD7) and Team-ID 9MJG6A8RD7**\n\n\n-----\n\nDumping the strings, we found the same author macOS username **lanyu, as in the**\nmetamask Wallet iOS app, confirming we are dealing with the same author, and also\nconfirmed the usage of the same Monkeydev xcode templates:\n\n/Users/lanyu\nThe backdoor code wasn’t really hidden like in the MetaMask wallet iOS app, as we could\nsee more methods implemented directly in the injected .dylib:\n\nbackdoor code can be seen via class-dump of\nLogos was also used with multiple MSHookMessageEx() hooks at multiple ViewControllers\nof the app, calling back specific backdoor code methods each time:\n\n\n-----\n\ncoinbase Wallet iOS app with logos tweaks\n\n## imToken Wallet iOS app:\n\nSHA-256 of the .IPA analyzed:\n1e232c74082e4d72c86e44f1399643ffb6f7836805c9ba4b4235fedbeeb8bdca\n\nsimilar to the Coinbase iOS wallet, one .dylib libimtokenhookDylib.dylib was injected:\n```\n@executable_path/Frameworks/libimtokenhookDylib.dylib (compatibility version 0.0.0,\ncurrent version 0.0.0)\n\n```\nThis .dylib is signed with Developper ID certificate : Sjdbfbd Jdjffb (9J3Q9W2QG2) and\nTeam-ID 9J3Q9W2QG2\n\nWe also found reference to the same macOS username “lanyu” and references to the\nMonkeyDev framework:\n\n\n-----\n\nThe backdoor was hidden and encrypted same as in the Metamask iOS wallet and I found\nthe exact same backdoor React Native bundle that was loaded. We noticed additional hooks\nvia MSHookMessageEx() were added to the RCTJavaScriptLoader, ensuring eventually\nthe loading of the backdoor React Native bundle:\n\nSo it seems the Author didn’t do anything specific for imToken Wallet iOS app.\n\n## TokenPocket iOS Wallet:\n\nSHA-256 of the .IPA file analyzed :\n46002ac5a0caaa2617371bddbdbc7eca74cd9cb48878da0d3218a78d5be7a53a\n\na single .dylib libpocketDylib.dylib was injected:\n```\n@executable_path/Frameworks/libpocketDylib.dylib (compatibility version 0.0.0,\ncurrent version 0.0.0)\n\n```\nThis .dylib is signed with Developper ID certificate : hang Bai (GNY64NUGXC)\n```\nAuthority=iPhone Distribution: hang Bai (GNY64NUGXC)Authority=Apple Worldwide\nDeveloper Relations Certification AuthorityAuthority=Apple Root CASigned Time=Mar 3,\n2022 at 5:06:06 PMInfo.plist=not boundTeamIdentifier=GNY64NUGXC\n\n```\nA new author macOS username leaked named “trader”, we also confirmed the usage of the\nMonkeyDev Framework:\n\n\n-----\n\nLogos tweaks are used, in particular hooks to “setMnemonic:” were added:\n\nThe captured seed phrase is sent to a domain controlled by the attacker :\n\n## Coinbase Wallet android app\n\nIt is important to note that with every iOS app, delivered via provisioning profiles, there was\nan android app available to download on the same page setup by SeaFlower:\n\n\n-----\n\nWe will do a quick analysis for the Coinbase Wallet APK file to showcase how the backdoor\ncode has been added.\n\nSHA-256 of the APK:\n83dec763560049965b524932dabc6bd6252c7ca2ce9016f47c397293c6cd17a5\n\nI installed the APK and run it on an Android emulator, with the SSL interception in place. Not\nsuprisingly, and similar to the iOS flavour of this app, a network request is sent to an attacker\ncontrolled domain containing the seed phrase of the victim:\n\n\n-----\n\nexfiltrated seed phrase from backdoored Coinbase wallet\nAndroid APKs are extremely easy to backdoor, therefore we won’t be spending too much\ntime in this section and we will limit the analysis to the Coinbase Wallet APK, only.\n\nOne very known technique is injecting smali code. Looking at the HTTP request sent, and\nthe parameters names, it didn’t take me too much time to find out the backdoor code, that is\nimplemented in a class called XMPMetadata:\n\nThe author didn’t add anything fancy to their backdoor, and called this class when the seed\nphrase is about to be saved to the Storage with the seed phrase in parameters :)\n\nbackdoor code inside saveMnemonicToStorage()\nand they encoded the C2 domain/url in base64, how fancy :\n\n\n-----\n\n```\necho n aHR0cHM6Ly9jb2xuYmFzZS5ob21lcy91L3Ntcy8 | base64\ndhttps://colnbase.homes/u/sms/\n\n## Some Final thoughts about SeaFlower:\n\n```\nWhat I liked about this cluster of activity, is the fact that it is unique, it is web3 related, and\nnot reported before. It seems there was a lot of efforts in the iOS side of things, for example\nsetting up provisioning profiles, automatic deployments, sophisticated backdoor code, etc.\nMore work has been done compared to the Android side of things.\n\nThere are some notable challenges when it comes to SeaFlower attribution, for example\nfiguring out if the provisioning servers are run by the same group, and also identifying more\ninitial vectors of the attack beside the Chinese search engines. All these are difficult\nchallenges due to the geographical and language barrier aspects.\n\nWe are planning to release sometime in the near future a part 2 of this blog post, where we\nwill do a deep dive into the infrastructure used by SeaFlower and add more elements of\nattribution.\n\n## General security recommendations:\n\n For Web3 Wallet developers\n\nDefinitely not an easy one when it comes to protecting crypto-related software like mobile\nweb3 wallets used by millions of people.\n\nWhat we write in this section won’t prevent a skilled or determined attacker from tampering\nwith your apps, but there are some easy fixes that could cost money and time to your\nattackers.\n\nFirst of all, know and understand your attack surface (hopefully this blog can help), as well as\nreading this document listing different attack surfaces crypto wallets could be exposed to :\nhttps://github.com/OWASP/owasp-mstg/blob/master/Document/0x06c-Reverse-Engineeringand-Tampering.md\n\nSecondly, make your stuff harder to break :) detecting inline hooks, injected libraries,\ndetecting instrumentation tools, etc.. are well-known and documented topics.\n\n## For Web3 users\n\nAlways download mobile apps from official stores: Apple AppStore & Play Store.\n\nNever install or accept random provisioning profiles on your iPhone, as you saw in this blog\npost, they allow the download of unverified software that could potentially steal your crypto.\n\n\n-----\n\n## Final words — part 2 coming soon\n\n[if you like this content, please ensure to follow me on twitter @lordx64 and please stay tuned](https://twitter.com/lordx64?lang=en)\nfor the part 2.\n\nIf you are working at a security team please get in touch with us at security@confiant.com to\nget access to our web3 threat intelligence feeds, including access to more SeaFlower\nintrusion-set updates.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-12 - How SeaFlower 藏海花 installs backdoors in iOS-Android web3 wallets to steal your seed phrase.pdf"
    ],
    "report_names": [
        "2022-06-12 - How SeaFlower 藏海花 installs backdoors in iOS-Android web3 wallets to steal your seed phrase.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536230,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1655594278,
    "ts_modification_date": 1655594278,
    "files": {
        "pdf": "https://archive.orkl.eu/042edef24d956630233466d41ecb7a4ba7d064e9.pdf",
        "text": "https://archive.orkl.eu/042edef24d956630233466d41ecb7a4ba7d064e9.txt",
        "img": "https://archive.orkl.eu/042edef24d956630233466d41ecb7a4ba7d064e9.jpg"
    }
}