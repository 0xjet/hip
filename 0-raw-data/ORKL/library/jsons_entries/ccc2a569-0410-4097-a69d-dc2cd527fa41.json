{
    "id": "ccc2a569-0410-4097-a69d-dc2cd527fa41",
    "created_at": "2023-03-03T02:06:45.465443Z",
    "updated_at": "2025-03-27T02:05:29.56247Z",
    "deleted_at": null,
    "sha1_hash": "e6f18760f56627c2b351394243d4a5971b02f1c0",
    "title": "2016-09-29 - Want Tofsee My Pictures- A Botnet Gets Aggressive",
    "authors": "",
    "file_creation_date": "2023-03-01T09:37:20Z",
    "file_modification_date": "2023-03-01T09:37:20Z",
    "file_size": 814709,
    "plain_text": "# Want Tofsee My Pictures? A Botnet Gets Aggressive\n\n**blog.talosintelligence.com/tofsee-spam/**\n\nEdmund Brumaghin September 29, 2016\n\nBy [Edmund Brumaghin](https://blog.talosintelligence.com/author/edmund-brumaghin/)\n\nThursday, September 29, 2016 11:09\n\n_This post was authored by Edmund Brumaghin_\n\n## Summary\n\nTofsee is multi-purpose malware that has been in existence for several years, operating\n[since at least 2013. It features a number of modules that are used to carry out various](https://www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Win32%2FTofsee&ref=cisco-talos-blog)\nactivities such as sending spam messages, conducting click fraud, mining cryptocurrency,\nand more. Once infected, systems become part of the Tofsee spam botnet and are used to\nsend large volumes of spam messages in an effort to infect additional systems and increase\nthe overall size of the botnet under the operator’s control.\n\n\n-----\n\n[Earlier this year, Talos published a blog post discussing how the RIG exploit kit was](http://blog.talosintel.com/2016/01/rigging-compromise.html?ref=cisco-talos-blog)\ndelivering this malware to compromised endpoints using malvertising. Malvertising is a\ntechnique commonly used by exploit kits to infect users that browse web sites that are\nserving compromised advertisements. This activity seemed to disappear in June, however\nTalos has recently observed a marked increase in the volume and velocity of spam email\ncampaigns containing malicious attachments that are being used to distribute Tofsee.\n\n## Tofsee Spam Campaigns\n\nIn June 2016, following the disappearance of the Angler exploit kit from the threat\nlandscape, other major exploit kits began to shift to different payloads. The RIG exploit kit\nmoved from distributing Tofsee to other payloads, possibly because distributing them was\nmore attractive to cybercriminals from a monetization standpoint or simply because different\nactors began using this exploit kit as a distribution mechanism for their malware.\n\nGiven the volume of spam messages that infected hosts attempt to distribute, new nodes\nare quickly added to DNS-based Blackhole Lists (DNSBL) and most of the major email\nservice providers will not accept new message transmissions once this occurs. In order to\nkeep spam levels consistent new nodes must be added constantly. When RIG stopped\ndistributing Tofsee payloads, those responsible for Tofsee switched to alternative\ndistribution methods.\n\nWhile the Tofsee botnet has been known for sending spam messages, the messages have\nhistorically contained links to adult dating and pharmaceutical websites. Starting in August,\nTalos began to observe a change in the nature of the spam messages being sent by this\nbotnet. The Tofsee spam botnet has begun utilizing malicious attachments that function as\nmalware downloaders. This activity has increased in velocity and volume.\n\n\n-----\n\n**Figure 1: Number of Emails Containing Malware Downloaders**\n\n## Initial Infection Vector\n\nThe initial infection for this variant of Tofsee appears to be accomplished by convincing\nusers to open malicious attachments that are delivered via phishing emails. The phishing\nemails purport to be from women in Eastern Europe (namely Russia and Ukraine) and the\ntheme of the emails is adult dating. Each email contains slightly different text, however the\nsame format is used across all of the messages Talos analyzed. The messages purport to\ncontain an attached zip archive with pictures of the sender as well as links to a Russian\nadult dating website. Here is an example of a Tofsee message body:\n\n**Figure 2: Sample Tofsee Spam Message**\n\n## Javascript Downloader\n\n\n-----\n\nThe attachment is a zip archive named [Sender First Name]-photos.zip that contains a\nJavascript file. In all cases analyzed, the filename of the javascript file is a woman’s first\nname. The filename and hash changes across groups of emails with several being sent on\nany given day. The code in javascript attachment is obfuscated in an attempt to make\nanalysis more difficult.\n\nFigure 3: Sample Obfuscated Javascript Downloader\nThe above Javascript obfuscates a WScript downloader, which is used to retrieve and\nexecute a malicious PE32 executable from an attacker controlled web server. When\nexecuted, the downloader retrieves a malicious executable and runs it, infecting the system\nwith Tofsee.\n\n## Infection Details\n\nThe malware drops a randomly named PE32 executable into the %USERPROFILE%\ndirectory.\n\n\n-----\n\n**Figure 4: Dropped Tofsee Binary**\nThe dropped executable is registered to start whenever the infected user logs onto the\nsystem. This is performed by adding an entry to\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.\n\n**Figure 5: Persistence Mechanism**\n\nIt also deletes the initial binary using a batch file that is temporarily stored inside the\n%TEMP% directory.\n\n**Figure 6: Batch**\n\n**File Stored in Temp**\n\nOnce infected, systems will begin connecting to various SMTP relays and sending spam\nemail messages.\n\n\n-----\n\n**Figure 7: SMTP Connections**\nAdditionally, HTTP GET requests are generated periodically as the malware attempts to\nsimulate clicking on ads as part of its click fraud routine:\n\n**Figure 8: HTTP Connections**\n\n## Conclusion\n\nThreats are constantly evolving as attackers change the way in which they attempt to\ndistribute malware and attack systems. Threat actors also constantly strive to expand their\npresence by taking advantage of the ever increasing number of Internet users and devices.\nBy leveraging our vast visibility into the threat landscape, Talos is able to effectively monitor\nthese threats and quickly detect changes in the tactics, techniques, and procedures\nattackers are using so that we can continually protect our customer’s networks and data.\n\n## Coverage\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](http://www.cisco.com/c/en/us/support/security/amp-firepower-software-license/tsd-products-support-series-home.html?ref=cisco-talos-blog)\nmalware used by these threat actors.\n\n[CWS or](http://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html?ref=cisco-talos-blog) [WSA web scanning prevents access to malicious websites and detects malware](http://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html?ref=cisco-talos-blog)\nused in these attacks.\n\n[The Network Security protection of IPS and](http://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html?ref=cisco-talos-blog) [NGFW have up-to-date signatures to detect](http://www.cisco.com/c/en/us/products/security/asa-next-generation-firewall-services/index.html?ref=cisco-talos-blog)\n[malicious network activity by threat actors. ESA can block malicious emails sent by threat](http://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html?ref=cisco-talos-blog)\nactors as part of their campaign.\n\n## Indicators of Compromise\n\n### URLs:\n\nhXXp://franny.goadultgame[.]ru:80/js/boxun4.exe\n\nhXXp://getfile.myadultgame[.]ru:80/js/boxun4.exe\n\nhXXp://gsbooz.goadultgame[.]ru:80/js/boxun4.exe\n\nhXXp://ibvl.theadultgame[.]ru:80/js/boxun4.exe\n\nhXXp://oajwwh.goadultgame[.]ru:80/js/boxun4.exe\n\nhXXp://picshare.adultgamemedia[.]ru:80/js/boxun4.exe\n\nhXXp://pics.theadultgame[.]ru:80/js/boxun4.exe\n\nhXXp://reworder.adultgamesite[.]ru:80/js/boxun4.exe\n\nhXXp://rkeujctg.adultgamemedia[.]ru:80/js/boxun4.exe\n\nhXXp://video.theadultgame[.]ru:80/js/boxun4.exe\n\nhXXp://view.webadultgame[.]ru:80/js/boxun4.exe\n\n### Domains:\n\nmyadultgame[.]ru\ntheadultgame[.]ru\n\nwebadultgame[.]ru\n\nadultgamesite[.]ru\n\ngoadultgame[.]ru\n\n\n-----\n\nadultgamemedia[.]ru\ndatingst[.]ru\n\nglobalhotstore[.]ru\n\ndatingrg[.]ru\n\ndatingsd[.]ru\n\ndatingds[.]ru\n\ndatinghq[.]ru\n\ndatingfr[.]ru\n\ndatinghl[.]ru\n\ndategh[.]ru\n\n### IP Addresses:\n\n184[.]18[.]26[.]30\n\n103[.]232[.]222[.]57\n\n111[.]121[.]193[.]242\n\n### Downloader Filenames:\n\nSandi.js\n\nTessa.js\n\nDori.js\n\nDebbie.js\n\nLira.js\n\nGriselda.js\n\nChere.js\n\nJess.js\n\nBettie.js\n\nKaterine.js\n\nKarena.js\n\nBirdie.js\n\nBlondelle.js\n\nPansy.js\n\nThomasina.js\n\nNananne.js\n\nAbigail.js\n\nAdelaida.js\n\n### Downloader Hashes:\n\nfe6290253a02c231c07e8604c6b2a1b298520e112e0c0ba08f76c26724b3c820\n\nf706c9c0982c358a165c5d31b218140461e110662332c6c508a9a66305311b17\n\n7e3e4d33b9477f4d38934fdafa2203815950bef6d3b5b1011cd433035f9c0975\n\n\n-----\n\n83a5e5e319169ec0de90a3ffa3513bbfdcb169fcda57ee671b9c4d08893f5d86\n762be900fa19aff05fe6459da36b407b81cf08d2e95c8aa7b23870c2fe4178cc\n\n40f039b9bfedbe5829c9301b0f2b1f322191694961f54a34853d5b4ae5627355\n\n91e57da11ec889574aebd03f9a213d7154d899d2cf137ec7275e90201e62a170\n\nf524ed3077caf65891d8b2c56c0fd32a5f58bba53ff09ad805fef8e7818a9b71\n\nd9fa2cd39e8dd741a95bb83576e4f7a1e766e8e1ba6580676a5aad145b2ac56d\n\n0274427bae4e479c28e9f8f21460cd03947c4878038458aeca406b7564563dc0\n\n0931fc405a4bc660dc695f5da8f9e6c027832530e7ee48a5385ea6b43587ff52\n\n0d98ad52e4db0085fbcf7d87465a14883e64038923e164d27e23983d4bde290c\n\nf6d17a1034a08de4048ba3b5f3adea7aa7d11180277c74c3ea09e3826520f768\n\n979ca79de2e3f3bdfa2a202824b3d6070aca61908f1413413777efeee224869f\n\ne8072ee6e6007ba44071bee91bd25f88c3e9d5db8c49c59975946d8f421b7ab7\n\n23a37772ff69c0da4294f858ee1b50ef8f261c007fc5ae0a1216757d0a1a4148\n\n5d005f26295b05b7a9e8bf317c1452a616c362594e787d3bac5ecb2709059f2e\n\n### Binary Hashes:\n\n3100af215a1dbe16be91fa5ee4fd8def2c58623e5c7b3751e2a4c4df1263c5bc\n\n08eb7d50f070f84227ba9a7f55149bcd775d700636417c917a317248acd2f57d\n\n0904af6c04c349dddc1cdb1e76a7c0782dd750e36c3e2e9e84ea8e40f41905c6\n\n0aaea185e269923b4181951b3761a33a745f1ff8671f9a17ee69798c605b7aff\n\n25fae47b7959cfb5be90cffc9a33d0875a0f5cb8dc7f6bd1bfb926ca26e24ea3\n\n4529bc3de5ac1e5807d91dbe9883aca563dc845ef80cbddd835fd04a4b2d7ab8\n\n4cb9925bcc4d8e8e74f8a1288595b3775bc8a8e7cac3e2e05f4fe6fefceb8af2\n\n5ba6eb7748f1e01c8302f8a97c264e82256f5b7c796b5a893550673c5ca0e134\n\n5d06f55a5fb94d5717dfa798e670c3cdacbaa57a798fe917e0c69ee0e42cfcb8\n\n6c6b60b62b1090fee62336852ecf2e9999050de32ec7a9114a0fce54fe9fb177\n\n785c9f48829d0ac2958a403976346833d630e8eba24bf5fa4024d36e37d8f77d\n\n7c41a29a697dab21b7303baf75bf931bdc06123b339349268e5de0f124818364\n8204b8590b916268dd683a5d040225d1ec3836a473e79fda5463031da9cce632\n906cbae96a9d21d0dd692b858f11c7515d515773da854add7dc695e8b0f973d1\n\n9a7e3fda688862acbad677f62f99ac449c3df6b884408c80a34938dd18d5284f\n\n9e0550c4a5dbbb19c30fa82ff05d28971d8934f1a954b24a6335ed19aeba72d5\n\na77355c3dd7f65957aab46a586463762e02cbfc981817fdb95c44b144dea1842\n\nacb5bd713f0077725d754e98961eb4c691e1d68d45678597c5dbf1ff667e27ca\n\nb1f96a761338ec65ecfb385486c583f8677fb865735b8d839a4a7ff094cc9744\n\nb86c1f59060c6607f8da882ac45c9e4e82a899dbb57a77f007b15f8460d32a71\n\nbcf9256595fa8da550b479ccfd518a67a1fc53ff2bffe990c3789dda29cc5886\n\nc1a1b521a365402ec82adff554be11e22cdedce7d50dc49d47609b1b6aed2d79\n\nc4808689aaf69cee2db9783d9831abe568e0953f9f6f1e80e162e99fb9c664f0\n\nca8851bdb285c02fd1d5176cffc9cedafe8838610466df859b33e465f3a91572\n\n\n-----\n\nd2085fd53064953de40f9735ec31c09b479612cfa13597c9a30df4ebf06dd85b\ne522062d780fc38f89c463f0a2002b3646681a1582435276d2f81d75b9c7696b\n\nffc9744be0450e5ed8dd296798c2562f688d77c954ed976c9ccb723163fa7006\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-09-29 - Want Tofsee My Pictures- A Botnet Gets Aggressive.pdf"
    ],
    "report_names": [
        "2016-09-29 - Want Tofsee My Pictures- A Botnet Gets Aggressive.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1677809205,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1677663440,
    "ts_modification_date": 1677663440,
    "files": {
        "pdf": "https://archive.orkl.eu/e6f18760f56627c2b351394243d4a5971b02f1c0.pdf",
        "text": "https://archive.orkl.eu/e6f18760f56627c2b351394243d4a5971b02f1c0.txt",
        "img": "https://archive.orkl.eu/e6f18760f56627c2b351394243d4a5971b02f1c0.jpg"
    }
}