{
    "id": "e60bcd10-a59d-4e73-8764-e5eb716bced7",
    "created_at": "2023-02-02T02:08:50.852658Z",
    "updated_at": "2025-03-27T02:13:33.725162Z",
    "deleted_at": null,
    "sha1_hash": "490dd28b4442246bc45c157c3627966e43142bdb",
    "title": "2022-12-20 - Lazarus APT’s Operation Interception Uses Signed Binary",
    "authors": "",
    "file_creation_date": "2023-02-01T07:38:31Z",
    "file_modification_date": "2023-02-01T07:38:31Z",
    "file_size": 2281782,
    "plain_text": "# Lazarus APT’s Operation Interception Uses Signed Binary\n\n**[labs.k7computing.com/index.php/lazarus-apts-operation-interception-uses-signed-binary/](https://labs.k7computing.com/index.php/lazarus-apts-operation-interception-uses-signed-binary/)**\n\nBy Mellvin S December 20, 2022\n\nMalware authors have regularly used signed binaries to bypass the Apple security\nmechanism and infect macOS users. We came across one such sample and this time they\nare baiting users with job vacancies at Coinbase while silently pushing a signed binary in\nthe background and doing their malicious activity. This is an instance of Operation\nIn(ter)ception by Lazarus.\n\nThis malware under consideration is a fat binary containing x86_64 and ARM64\narchitecture compiled executable that can be executed in both Intel & Apple silicon\nmachines.\n\nFigure 1 : Fat binary\nThe malware is a signed executable. The developer id belonged to Shankey Nohria but it\nhas been revoked as of now.\n\nFigure 2 : Revoked certificate\nWhen executed, it drops 4 files in the folder ~/Library/Fonts (The ~ character stands for the\nuser’s home directory).\n\n1. A PDF document named Coinbase_online_careers_2022_07.pdf\n\n2. A package bundle named FinderFontsUpdater.app which contains a fat binary\n\n\n-----\n\n3. A downloader agent which connects to the C2 named safarifontsagent. This is also a fat\nbinary\n\n4. A zero byte file named Finder.\n\nThe PDF contains job details at Coinbase company. The PDF is created with Microsoft\nWord 2019, version 1.7. The author of the document is mentioned as “UChan”.\n\nFigure 3 : Dropped pdf properties\n\nAs the malware executes, the pdf pops up on the screen but in the background the\nmalware begins its malicious operation, starting with wiping the current saved state of the\nterminal.\n\n\n-----\n\nFigure 4 :\n\nRemoving the saved state of terminal\nThen it drops 2 files and then extracts those files using tar command into\nFinderFontsUpdater.app and safarifontsagent.\n\nFigure 5 : Extracting the dropped files into executable binaries\nOnce the 2 files have been extracted, LaunchAgent is created in the name of iTunes_trush\nwith the target binary set as safarifontsagent, using the function startDaemon().\n\n\n-----\n\nFigure 6 : LaunchAgent created\n\nFigure 7 : Dropped files\nAfter dropping the above files, the malware executes FinderFontsUpdater.app (2nd\nstage).\n\n\n-----\n\nFigure 8\n\n: The second stage file gets executed by the malware\nThe main function of FinderFontsUpdater.app is to execute safarifontsagent (3rd stage)\nbinary which communicates with the C2.\n\nFigure 9 : Function to execute the 3rd stage malware\nUpon execution, the safarifontsagent calls a user defined function named DownloadFile()\n[with couple of arguments, one of the arguments is an URL “hxxps(:)//concrecapital(.)com”](https://concrecapital.com/)\nappended with the user name of the victim machine which can be seen in Figure 10.\n\n\n-----\n\nFigure 10 : Argument of the DownloadFile() function\nThen the malware queries the system with commands like getuid, getpwuid, getuname\netc., to get information. After that, it uses the commands “sw_vers -productVersion” &\n“sysctlbyname hw.cpufrequency” to get information about the victim’s machine .\n\nAfter that the malware calls the curl_easy_init() function to get a curl handle for\ncommunication with C2.\n\n\n-----\n\nFigure 11 : Curl commands to receive the payload\nThen the malware opens the Finder file in ‘wb’ (Open for writing in binary) mode.\n\nThe malware uses the information that was gathered earlier, i.e. product version, cpu\n[speed etc. and appends it to the url hxxps(:)//concrecapital(.)com. Then the url with the](https://concrecapital.com/)\nappended data is passed as an argument to curl_easy_setopt() function.\n\nFigure 12 :URL to get the payload from the C2\nIt then uses functions like curl_easy_setopt & curl_easy_perform to connect to the C2 and\nget the payload that will be written in the Finder file.\n\n\n-----\n\nFigure 13 : Finder file is opened in write mode and Curl operations in motion\nThe C2 server was not alive to respond so we were unable to find out what the payload\nwas.\n\nThreat actors targeting macOS users are increasing everyday. So, as a user, one needs to\nbe cautious when executing unknown executables. Users are requested to use a reputable\nsecurity product such as “K7 Antivirus for Mac” and to keep it updated so as to stay safe\nfrom such threats.\n\n## IOCs\n\n**Hash : 4a7a1626b6baf8c917945b8fc414c8b9 (parent malware)**\n\n**Detection Name : Trojan ( 0040f2c11 )**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-20 - Lazarus APT’s Operation Interception Uses Signed Binary.pdf"
    ],
    "report_names": [
        "2022-12-20 - Lazarus APT’s Operation Interception Uses Signed Binary.pdf"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1675303730,
    "ts_updated_at": 1743041613,
    "ts_creation_date": 1675237111,
    "ts_modification_date": 1675237111,
    "files": {
        "pdf": "https://archive.orkl.eu/490dd28b4442246bc45c157c3627966e43142bdb.pdf",
        "text": "https://archive.orkl.eu/490dd28b4442246bc45c157c3627966e43142bdb.txt",
        "img": "https://archive.orkl.eu/490dd28b4442246bc45c157c3627966e43142bdb.jpg"
    }
}