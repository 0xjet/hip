{
    "id": "6d3d68c3-96df-470d-825b-a233e2ff298e",
    "created_at": "2023-01-12T15:05:16.594067Z",
    "updated_at": "2025-03-27T02:06:07.622092Z",
    "deleted_at": null,
    "sha1_hash": "f283c2bb8380a84c670208704e57a2db1348c4a5",
    "title": "2019-04-26 - A Closer Look at the RobbinHood Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-27T01:58:29Z",
    "file_modification_date": "2022-05-27T01:58:29Z",
    "file_size": 1863953,
    "plain_text": "# A Closer Look at the RobbinHood Ransomware\n\n**[bleepingcomputer.com/news/security/a-closer-look-at-the-robbinhood-ransomware/](https://www.bleepingcomputer.com/news/security/a-closer-look-at-the-robbinhood-ransomware/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nApril 26, 2019\n01:45 PM\n5\n\nThe RobbinHood Ransomware is the latest player in the ransomware scene that is targeting\ncompanies and the computers on their network. This ransomware is not being distributed\nthrough spam but rather through other methods, which could include hacked remote\ndesktop services or other Trojans that provide access to the attackers.\n\nSince it first came out, samples of the RobbinHood ransomware have not been easy to\ncome by. Yesterday, though, [MalwareHunterTeam was able to find a sample so that it could](https://twitter.com/malwrhunterteam)\nbe reverse engineered and tested to learn more about it.\n\n## Taking a look at RobbinHood\n\nAs we previously stated, it has not been confirmed how the ransomware gains access to a\nnetwork and the computer's on it.\n\n[Security researcher Vitali Kremez, who](https://twitter.com/VK_Intel) [reverse engineered the sample, told](https://twitter.com/VK_Intel/status/1121440931759128576)\nBleepingComputer that on execution, RobbinHood disconnects all network shares from the\ncomputer using the following command:\n```\n cmd.exe /c net use * /DELETE /Y\n\n```\n\n-----\n\nThis means that each computer is targeted individually and that other computers are not\nencrypted via connected shares. Kremez told us that this could indicate that the payload is\nbeing pushed to each individual machine via a domain controller or through a framework\nlike Empire PowerShell and PSExec.\n\n\"One of the most notable ones is \"cmd.exe /c net use * /DELETE /Y\" since the malware\ndoes not encrypt or crawl any shares and actually disconnects from network, which\nindicates each variant is likely pushed into each machine via the domain controller or some\nother automated means (maybe via psexec)\"\n\nBefore continuing, the ransomware will now attempt to read a public RSA encryption key\nfrom C:\\Windows\\Temp\\pub.key. If this key is not present, it will display the following\nmessage and the ransomware will exit.\n\n**Can't find pub.key error**\nIf a key is present, it will continue preparing the victim's computer for encryption. To test the\nransomware, BleepingComputer generated a test public key and saved it to\nC:\\Windows\\Temp.\n\nNext it will stop 181 Windows services associated with antivirus, database, mail server, and\nother software that could keep files open and prevent their encryption. It does this by\nissuing the \"sc.exe stop\" command as shown below.\n```\ncmd.exe /c sc.exe stop AVP /y\n\n```\nA full list of services stopped by RobbinHood are found at the end of the article.\n\nDuring this preparation stage, RobbinHood will also clear Shadow Volume Copies, clear\nevent logs, and disable the Windows automatic repair by executing the following\ncommands:\n\n\n-----\n\n```\nvssadmin.exe delete shadows /all /quiet\nWMIC shadowcopy delete\nwevtutil.exe cl Application\nwevtutil.exe cl Security\nwevtutil.exe cl System\nBcdedit.exe /set {default} recoveryenabled no\nBcdedit.exe /set {default} bootstatuspolicy ignoreallfailures\n\n```\nNow that the computer is prepped, it begins to encrypt the victim's targeted files.\n\nKremez told BleepingComputer that when encrypting files an AES key is created for each\nfile. The ransomware will then encrypt the AES key and the original filename with the public\nRSA encryption key and append it to the encrypted file.\n\nEach encrypted file will then be renamed using the format\n**Encrypted_[randomstring].enc_robbinhood as shown below.**\n\n**Encrypted RobbinHood Files**\nWhen encrypting files, RobbinHood will skip any files found in or under the following\ndirectories:\n\n\n-----\n\n```\nProgramData\nWindows\nbootmgr\nBoot\n$WINDOWS.~BT\nWindows.old\nTemp\ntmp\nProgram Files\nProgram Files (x86)\nAppData\n$Recycle.bin\nSystem Volume Information\n\n```\nWhile running, RobbinHood has the ability to send debug output to the console. This feature\nis currently disabled in distributed versions of the ransomware and does not have a runtime\nvalue to enable it.\n\nThe ransomware will, though, create numerous log files under the C:\\Windows\\Temp folder.\nThese files are called rf_, **ro_l, and ro_s.**\n\n**Log Files**\nIt is not currently known what each log file is for other than the rf_s file, which is used to log\nthe creation of ransom notes in each folder.\n\n\n-----\n\n**Example logfile for RobbinHood ransom note creation**\nAfter encryption has been completed, these log files will be deleted. Below is an example\nof some of the debug messages that would be displayed during this cleanup stage if\nconsole output was enabled.\n\n**Cleaning up Logs**\nFurthermore, if console output is enabled in the ransomware, when done encrypting a\ncomputer it will display a final message stating \"Enjoy buddy :)))\" as shown below.\n\n\n-----\n\n**Final message when RobbinHood is done encrypting**\nWhile encrypting the computer it will also create four different ransom note\nnamed _Decrypt_Files.html, _Decryption_ReadMe.html, _Help_Help_Help.html, and\n**_Help_Important.html.**\n\nThese ransom notes contains information as to what has happened to the victims files and\na bitcoin address that they can use to make a ransom payment. The ransom payments are\ncurrently set at 3 bitcoins per affected system or 13 bitcoins for the entire network.\n\n**RobbinHood Ransom Note**\nUnfortunately, at this time no weakness has been found in the ransomware and there is no\nway to decrypt files for free.\n\n## Protecting yourself from the RobbinHood Ransomware\n\n\n-----\n\nAs ransomware is only damaging if you have no way of recovering your data, the most\nimportant thing is to always have a reliable backup of your files. These backups should be\nstored offline and not made accessible to ransomware, which have been known to target\nbackups in the past.\n\nWhile this ransomware is not being spread via spam, it is possible that it is being installed\nby Trojans that are. Therefore, it is important that all users be trained on how to properly\nidentify malicious spam and to not open any attachments without first confirming who and\nwhy they were sent.\n\nFinally, it also important to make sure that your network does not make Remote Desktop\nServices publicly accessible via the Internet. Instead, you should put it behind a firewall and\nmake it only accessible through a VPN.\n\n**Update 4/27/19: Added further info about debug logs**\n\n## IOCs:\n\n### Hashes:\n```\n3bc78141ff3f742c5e942993adfbef39c2127f9682a303b5e786ed7f9a8d184b\n\n Associated File Names:\n_Decrypt_Files.html\n_Decryption_ReadMe.html\n_Help_Help_Help.html\n_Help_Important.html\nC:\\Windows\\Temp\\pub.key\nC:\\Windows\\Temp\\rf_s \nC:\\Windows\\Temp\\ro_l\nC:\\Windows\\Temp\\ro_s\n\n List of Stopped Services:\n\n```\n\n-----\n\n```\nAVP, MMS, ARSM, SNAC, ekrn, KAVFS, RESvc, SamSs, W3Svc, WRSVC, bedbg, masvc, SDRSVC,\nTmCCSF, mfemms, mfevtp, sacsvr, DCAgent, ESHASRV, KAVFSGT, MySQL80, POP3Svc,\nSMTPSvc, Smcinst, SstpSvc, TrueKey, mfefire, EhttpSrv, IISAdmin, IMAP4Svc, McShield,\nMySQL57, kavfsslp, klnagent, macmnsvc, ntrtscan, tmlisten, wbengine, Antivirus,\nMSSQL$TPS, SQLWriter, ShMonitor, UI0Detect, sophossps, MSOLAP$TPS, MSSQL$PROD,\nSAVService, SQLBrowser, SmcService, swi_filter, swi_update, AcrSch2Svc, EsgShKernel,\nMBAMService, MSSQLSERVER, MsDtsServer, SntpService, VeeamNFSSvc, swi_service,\nAcronisAgent, FA_Scheduler, MSExchangeES, MSExchangeIS, MSExchangeSA, MSSQL$ECWDB2,\nMSSQL$SOPHOS, MSSQL$TPSAMA, PDVFSService, ReportServer, SQLAgent$TPS, SQLTELEMETRY,\nVeeamRESTSvc, MSExchangeMTA, MSExchangeSRS, MSOLAP$TPSAMA, McTaskManager,\nSQLAgent$CXDB, SQLAgent$PROD, VeeamCloudSvc, VeeamMountSvc, SQL Backups,\nmozyprobackup, msftesql$PROD, swi_update_64, EraserSvc11710, MSExchangeMGMT,\nMSSQL$BKUPEXEC, MSSQL$SQL_2008, MsDtsServer100, MsDtsServer110, SQLSERVERAGENT,\nVeeamBackupSvc, VeeamBrokerSvc, VeeamDeploySvc, Sophos Agent, svcGenericHost,\nEPUpdateService, MBEndpointAgent, MSOLAP$SQL_2008, MSSQLFDLauncher, McAfeeFramework,\nSAVAdminService, SQLAgent$ECWDB2, SQLAgent$SOPHOS, SQLAgent$TPSAMA, VeeamCatalogSvc,\nMSSQL$SHAREPOINT, MSSQL$SQLEXPRESS, MSSQL$SYSTEM_BGC, NetMsmqActivator,\nReportServer$TPS, SepMasterService, TrueKeyScheduler, EPSecurityService,\nMSOLAP$SYSTEM_BGC, MSSQL$PRACTICEMGT, SQLAgent$BKUPEXEC, SQLAgent$SQL_2008,\nSQLSafeOLRService, VeeamTransportSvc, Zoolz 2 Service, MSSQL$PRACTTICEBGC,\nMSSQL$VEEAMSQL2012, Sophos MCS Agent, BackupExecJobEngine, MSSQL$SBSMONITORING,\nMSSQLFDLauncher$TPS, MSSQLServerADHelper, McAfeeEngineService, OracleClientCache80,\nReportServer$TPSAMA, SQLAgent$SHAREPOINT, SQLAgent$SQLEXPRESS, SQLAgent$SYSTEM_BGC,\nSQLTELEMETRY$ECWDB2, Sophos MCS Client, BackupExecRPCService, MSSQL$VEEAMSQL2008R2,\nTrueKeyServiceHelper, BackupExecVSSProvider, MSSQL$PROFXENGAGEMENT,\nReportServer$SQL_2008, SQLAgent$PRACTTICEBGC, SQLAgent$PRACTTICEMGT,\nSQLAgent$VEEAMSQL2012, BackupExecAgentBrowser, MSSQLFDLauncher$TPSAMA,\nMSSQLServerADHelper100, MSSQLServerOLAPService, SQLAgent$SBSMONITORING,\nVeeamDeploymentService, VeeamHvIntegrationSvc, Acronis VSS Provider, Sophos Clean\nService, ReportServer$SYSTEM_BGC, SQLAgent$VEEAMSQL2008R2, Sophos Health Service,\nSophos Message Router, MSSQLFDLauncher$SQL_2008, SQLAgent$PROFXENGAGEMENT, SQLsafe\nBackup Service, SQLsafe Filter Service, SQLAgent$CITRIX_METAFRAME,\nVeeamEnterpriseManagerSvc, BackupExecAgentAccelerator, MSSQLFDLauncher$SHAREPOINT,\nMSSQLFDLauncher$SYSTEM_BGC, Sophos Safestore Service, Symantec System Recovery,\nBackupExecManagementService, Enterprise Client Service, Sophos AutoUpdate Service,\nBackupExecDeviceMediaService, Sophos Web Control Service,\nMSSQLFDLauncher$SBSMONITORING, Sophos File Scanner Service,\nMcAfeeFrameworkMcAfeeFramework, MSSQLFDLauncher$PROFXENGAGEMENT, Sophos Device\nControl Service, Sophos System Protection Service, Veeam Backup Catalog Data\nService,\n\n### Ransom Note Text:\n\n```\n\n-----\n\n```\nWhat happened to your files?\nAll your files are encrypted with RSA-4096, Read more on\nhttps://en.wikipedia.org/wiki/RSA_(cryptosystem)\nRSA is an algorithm used by modern computers to encrypt and decrypt the data. RSA is\nan asymmetric cryptographic algorithm. Asymmetric means that there are two different\nkeys. This is also called public key cryptography, because one of the keys can be\ngiven to anyone:\n1 - We encrypted your files with our \"Public key\" \n2 - You can decrypt, the encrypted files with specific \"Private key\" and your\nprivate key is in our hands ( It's not possible to recover your files without our\nprivate key )\nIs it possible to get back your data?\nYes, We have a decrypter with all your private keys. We have two options to get all\nyour data back.\nFollow the instructions to get all your data back:\nOPTION 1\nStep 1 : You must send us 3 Bitcoin(s) for each affected system\nStep 2 : Inform us in panel with hostname(s) of the system you want, wait for\nconfirmation and get your decrypter\nOPTION 2\nStep 1 : You must send us 13 Bitcoin(s) for all affected system\nStep 2 : Inform us in panel, wait for confirmation and get all your decrypters\nOur Bitcoin address is: xxx \nBE CAREFUL, THE COST OF YOUR PAYMENT INCREASES $10,000 EACH DAY AFTER THE FOURTH DAY\nAccess to the panel ( Contact us )\nThe panel address: http://xbt4titax4pzza6w.onion/xx/\nAlternative addresses\nhttps://xbt4titax4pzza6w.onion.pet/xx/\nhttps://xbt4titax4pzza6w.onion.to/xx/\nAccess to the panel using Tor Browser\nIf non of our links are accessible you can try tor browser to get in touch with us:\nStep 1: Download Tor Browser from here:\nhttps://www.torproject.org/download/download.html.en\nStep 2: Run Tor Browser and wait to connect\nStep 3: Visit our website at: panel address\nIf you're having a problem with using Tor Browser, Ask Google: how to use tor\nbrowser\nWants to make sure we have your decrypter?\nTo make sure we have your decrypter you can upload at most 3 files (maximum size\nallowance is 10 MB in total) and get your data back as a demo.\nWhere to buy Bitcoin?\nThe easiest way is LocalBitcoins, but you can find more websites to buy bitcoin\nusing Google Search: buy bitcoin online\n\n### Interesting Strings:\n\n```\n\n-----\n\n```\nC:/Users/valery/go/src/oldboy/config.go\nC:/Users/valery/go/src/oldboy/functions.go\nC:/Users/valery/go/src/oldboy/main.go\n\n```\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[RobbinHood](https://www.bleepingcomputer.com/tag/robbinhood/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/vulnerable-confluence-servers-get-infected-with-ransomware-trojans/)\n[Next Article](https://www.bleepingcomputer.com/news/microsoft/windows-10-insider-build-18885-fixes-usb-drive-letter-reassignments/)\n\n### Comments\n\n[Amigo-A - 3 years ago](https://www.bleepingcomputer.com/forums/u/998576/amigo-a/)\n\nThanks for the details!\n\nIf we look closely at antivirus detections on VT, we will notice that almost all of\nantiviruses write the word Robin with one letter 'B'. But the extortionists decided to\nwrite it with two letters 'B'. This should be a funny. But there are two more\nRansomware named RobinHood, which were before.\n\n\n-----\n\n[Lawrence Abrams - 3 years ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nYes, writing it with one B is incorrect and companies should stop doing it.\n\n[Iconera - 3 years ago](https://www.bleepingcomputer.com/forums/u/1122475/iconera/)\n\nGreat analysis. Have you tried making a read only folder C:\\Windows\\Temp\\pub.key\nwhich will prevent the file of the same name being created to see if that is a\npreventitive method on clean systems\n\n\n-----\n\n[Lawrence Abrams - 3 years ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nNo, but those types of tricks last only as long as the developer doesn't know about it.\nAs these are targeted installs, the dev will prob notice something is amiss and work\naround it.\n\n[gooolero - 2 years ago](https://www.bleepingcomputer.com/forums/u/1132861/gooolero/)\n\nThanks for the details!\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-26 - A Closer Look at the RobbinHood Ransomware.pdf"
    ],
    "report_names": [
        "2019-04-26 - A Closer Look at the RobbinHood Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535916,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653616709,
    "ts_modification_date": 1653616709,
    "files": {
        "pdf": "https://archive.orkl.eu/f283c2bb8380a84c670208704e57a2db1348c4a5.pdf",
        "text": "https://archive.orkl.eu/f283c2bb8380a84c670208704e57a2db1348c4a5.txt",
        "img": "https://archive.orkl.eu/f283c2bb8380a84c670208704e57a2db1348c4a5.jpg"
    }
}