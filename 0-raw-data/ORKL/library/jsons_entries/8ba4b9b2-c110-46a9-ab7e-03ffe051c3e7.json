{
    "id": "8ba4b9b2-c110-46a9-ab7e-03ffe051c3e7",
    "created_at": "2023-01-12T15:03:09.620921Z",
    "updated_at": "2025-03-27T02:11:45.087938Z",
    "deleted_at": null,
    "sha1_hash": "567c2a740b891906c8ce8e12487ad8eec9eaaa2b",
    "title": "2016-09-06 - Blatsting C&C Transcript",
    "authors": "",
    "file_creation_date": "2022-05-28T04:50:30Z",
    "file_modification_date": "2022-05-28T04:50:30Z",
    "file_size": 95793,
    "plain_text": "# BLATSTING C&C transcript\n\n**laanwj.github.io/2016/09/09/blatsting-lp-transcript.html**\n\n## Laanwj's blog\n\n### Randomness\n\n Blog About This showterm session shows a transcript of a session controlling BLATSTING.\n\n (the site is not wide enough to embed the entire thing, so it’s better to follow the link).\n\n At the left side it shows the listening post output, this is what the operative controlling it would see.\n\n At the right side scrolls by corresponding debugging output of the emulation framework. This shows the (decrypted) packets in transfer and what the emulated implant is doing.\n\n No actual Fortinet/TOS routers were harmed in this process. The setup is the same as in previous post, however many more modules are succesfully loaded and emulated. Almost the entire framework besides TADAQUEOUS and SECONDDATE, which have their own means of C&C that I may come back to at some other time, and file and install which deal with affairs that are simply not part of the emulation.\n\n Overview:\n\n Connect to VM domain. Start listening post.\n```\n   1 : Open a session.\n\n LP connects to the implant, and loads the LP modules corresponding to the implant modules (to populate the menu). Apparently it fails to load the LP module for the sniffer ( m10000000 ). We don’t be sniffing any packets today.\n\n```\n\n-----\n\n```\nAttempting to open a session.\nCHALLENGE Type packet received.\nAUTH_RESP Type packet received. \nYou are accessing BLATSTING.\nSession opened.\ndlopen error: ./lpconfig/m10000000/m10000000.lpmod: undefined symbol:\nbp_bf_bpf_validateProgram\nCorresponding LP module not found for (16 0 0).\n...\nOperation succeeded.\nConnected to node 00000000\n   Firewall Type : 00000000   Firewall Version: 00000000\n   Remote Code Version: 666.6.6\n   Remote IP Addr: 192.168.001.002\n   Remote interface : 0000\n   Listen IP Addr : 000.000.000.000\n   Listen IP timeout (on remote node) : none\n   Remote IP Sticky?: True\n   LP IP: 192.168.001.001\n   Source Port: 4000 Destination Port: 3000\n   Session Start Time (on remote node): Thu Sep 8 11:44:36 2016\n\n### LP shows menu*:\n\n```\n\n-----\n\n```\n   Base Commands\n 1) Open a session with the remote node\n 2) List loaded LP modules\n 3) Toggle expert mode [currently OFF]\n 6) Re-synchronize LP module list (will not unload explicitly loaded modules)\n 7) Toggle logging [currently ON]\n 8) Toggle menu display [currently ON] (Recommended ON)\n 9) Close session\n999) BURN\n 0) Quit Program\n----- core interface\n  0,0,0) Retrieve the list of exported interfaces\n  0,0,1) Retrieve the current time on the remote node\n----- crypto interface\n----- network interface\n  3,0,0) Read interfaces\n  3,0,2) Send ARP\n----- command and control interface\n  7,0,0) Get comms state\n  7,0,1) Set filter addresses\n----- hash interface\n----- tunnel interface\n  9,0,0) Query tunnel module state\n  9,0,1) Add a tunnel via command line\n  9,0,2) Add a tunnel interactively\n  9,0,3) Remove a tunnel\n  9,0,4) Toggle printing active connections (expert only)\n----- bpf interface\n----- network profiler interface\n 13,0,0) Query state\n 13,0,1) Start scan\n 13,0,2) Stop scan\n 13,0,3) Restart scan\n 13,0,4) Reset\n 13,0,5) Get records\n 13,0,6) Get records; dump to file\n   8 : Toggle “show menu” off otherwise it will print the screen-full menu after every\n\n### command and it’s impossible to see any output without scrolling back all the time.\n   0,0,1 : Print time on remote node.\nTime on remote node (GMT): Thu Sep 8 15:44:48 2016\n   0,0,0 : Show the list of loaded modules and interfaces.\n\n```\n\n-----\n\n```\nExported interfaces:\n Module ID   Module type     Provider ID  Provider type\n  0  0  3  core          0  0  3  core\n  1  1  0  crypto         1  1  1  crypto\n  3  1  1  network        3  1  0  network\n  16  0  0  sniffer        16  0  1  sniffer\n  7  0  0  cnc          7  0  1  cnc\n  8  1  0  hash          8  1  1  hash\n  9  0  0  tunnel         9  0  2  tunnel\n  12  1  0  bpf          12  1  1  bpf\n  13  0  0  networkProfiler    13  0  1  networkProfiler\n   13,0,0 : Show networkProfiler configuration.\n(13 0 0) networkProfiler module configuration:\nnetworkProfiler module not configured.\n   13,0,1 : Start networkProfiler scan. This shows the command line option help output:\nPlease enter your networkProfiler command line (-h for help, CTRL-n to cancel)?\n -S/--scantype <scan name>  name of predefined scan (enter ? to be provided with a\nlist)\n -i/--interface <interface index (as from interface listing)> limit to the specified\ninterface\n -t/--traffictypes <traffic queue flags> receive traffic of the specified types only\n(enter ? to be provided with a list)\n -P/--prefilter netmask <netmask length> netmask length for prefilter (0-32, default\n0)\n -p/--prefilter <pcap filter string> pcap pre-filter definition (enclose this in\ndouble quotes)\n -s/--duration_seconds <seconds> test duration in seconds\n -m/--duration_minutes <minutes> test duration in minutes\n -r/--duration_hours <hours> test duration in hours\n -y/--duration_days <days>  test duration in days\n -N/--nperiods <# of scan periods> number of periods to scan (default: 1)\n -n/--maxNRecords <# of records> maximum number of records to keep per period\n --hashTableSize <# of entries> size of the hash table\n -h/--help          print this usage message\n\n### Show list of predefined scans (these are the files in\n   Firewall/BLATSTING/BLATSTING_201381/LP/lpconfig/m0d000000/predefinedScans ):\n\n```\n\n-----\n\n```\nTCPUDP_condense_bytes_512 IPv4 TCP/UDP connection information, ports above 512\ncondensed, with total byte count (IPs, IP protocol, condensed ports, ttl, byte count)\nTCPUDP_bytes     IPv4 TCP/UDP full connection information with byte count (IPs, IP\nprotocol, ports, ttl, byte count)\nTCPSYN_condense_256  IPv4 TCP/UDP connection information, ports above 256 condensed,\nwith SYN count (IPs, IP protocol, condensed ports, ttl, SYN count)\nTCPSYN        IPv4 TCP/UDP connection information with SYN count (IPs, IP\nprotocol, ports, ttl, SYN count)\nTCPSYN_condense_bytes_3072 IPv4 TCP/UDP connection information, ports above 3072\ncondensed, with SYN and total byte count (IPs, IP protocol, condensed ports, ttl, SYN\ncount, total byte count)\nTCPSYN_condense_1536 IPv4 TCP/UDP connection information, ports above 1536 condensed,\nwith SYN count (IPs, IP protocol, condensed ports, ttl, SYN count)\nTCPSYN_condense_2560 IPv4 TCP/UDP connection information, ports above 2560 condensed,\nwith SYN count (IPs, IP protocol, condensed ports, ttl, SYN count)\nTCPUDP_condense_1536 IPv4 TCP/UDP connection information, ports above 1536 condensed\n(IPs, IP protocol, condensed ports, ttl)\nTCPSYN_condense_bytes_1024 IPv4 TCP/UDP connection information, ports above 1024\ncondensed, with SYN and total byte count (IPs, IP protocol, condensed ports, ttl, SYN\ncount, total byte count)\nTCPUDP_condense_1024 IPv4 TCP/UDP connection information, ports above 1024 condensed\n(IPs, IP protocol, condensed ports, ttl)\nTCPUDP_condense_2560 IPv4 TCP/UDP connection information, ports above 2560 condensed\n(IPs, IP protocol, condensed ports, ttl)\nMAC2MAC        Ethernet (MAC) src/dst address collection\nTCPUDP_condense_bytes_256 IPv4 TCP/UDP connection information, ports above 256\ncondensed, with total byte count (IPs, IP protocol, condensed ports, ttl, byte count)\nIP2IP_bytes      source, destination IP collection with total byte count\nTCPUDP_condense_256  IPv4 TCP/UDP connection information, ports above 256 condensed\n(IPs, IP protocol, condensed ports, ttl)\nTCPSYN_condense_bytes_2048 IPv4 TCP/UDP connection information, ports above 2048\ncondensed, with SYN and total byte count (IPs, IP protocol, condensed ports, ttl, SYN\ncount, total byte count)\nIP2IP         IPv4 IP-to-IP address collection (who is calling whom?)\nTCPSYN_condense_bytes_2560 IPv4 TCP/UDP connection information, ports above 2560\ncondensed, with SYN and total byte count (IPs, IP protocol, condensed ports, ttl, SYN\ncount, total byte count)\nTCPUDP_condense_2048 IPv4 TCP/UDP connection information, ports above 2048 condensed\n(IPs, IP protocol, condensed ports, ttl)\nsrcMACIP       source Ethernet (MAC) and source IP address collection\nTCPSYN_condense_1024 IPv4 TCP/UDP connection information, ports above 1024 condensed,\nwith SYN count (IPs, IP protocol, condensed ports, ttl, SYN count)\nTCPUDP_condense_bytes_1536 IPv4 TCP/UDP connection information, ports above 1536\ncondensed, with total byte count (IPs, IP protocol, condensed ports, ttl, byte count)\nTCPSYN_condense_bytes_256 IPv4 TCP/UDP connection information, ports above 256\ncondensed, with SYN and total byte count (IPs, IP protocol, condensed ports, ttl, SYN\ncount, total byte count)\nTCPSYN_condense_bytes_1536 IPv4 TCP/UDP connection information, ports above 1536\ncondensed, with SYN and total byte count (IPs, IP protocol, condensed ports, ttl, SYN\ncount, total byte count)\nTCPUDP_condense_bytes_2560 IPv4 TCP/UDP connection information, ports above 2560\ncondensed, with total byte count (IPs, IP protocol, condensed ports, ttl, byte count)\nTCPUDP_condense_bytes_1024 IPv4 TCP/UDP connection information, ports above 1024\ncondensed, with total byte count (IPs, IP protocol, condensed ports, ttl, byte count)\nsrcIP         source IP address collection\nTCPUDP        IPv4 TCP/UDP full connection information (IPs, IP protocol,\n\n```\n\n-----\n\n```\nports, ttl)\nTCPSYN_condense_512  IPv4 TCP/UDP connection information, ports above 512 condensed,\nwith SYN count (IPs, IP protocol, condensed ports, ttl, SYN count)\nTCPSYN_condense_bytes_512 IPv4 TCP/UDP connection information, ports above 512\ncondensed, with SYN and total byte count (IPs, IP protocol, condensed ports, ttl, SYN\ncount, total byte count)\nTCPSYN_condense_3072 IPv4 TCP/UDP connection information, ports above 3072 condensed,\nwith SYN count (IPs, IP protocol, condensed ports, ttl, SYN count)\nTCPUDP_condense_3072 IPv4 TCP/UDP connection information, ports above 3072 condensed\n(IPs, IP protocol, condensed ports, ttl)\nTCPSYN_condense_2048 IPv4 TCP/UDP connection information, ports above 2048 condensed,\nwith SYN count (IPs, IP protocol, condensed ports, ttl, SYN count)\nTCPUDP_condense_bytes_3072 IPv4 TCP/UDP connection information, ports above 3072\ncondensed, with total byte count (IPs, IP protocol, condensed ports, ttl, byte count)\nTCPUDP_condense_512  IPv4 TCP/UDP connection information, ports above 512 condensed\n(IPs, IP protocol, condensed ports, ttl)\nTCPUDP_condense_bytes_2048 IPv4 TCP/UDP connection information, ports above 2048\ncondensed, with total byte count (IPs, IP protocol, condensed ports, ttl, byte count)\n\n### Create a -STCPUDP predefined scan, using default settings, and start it:\n traffic types: IP4\n total scanning time:  0 days 03:00:00\n scan period duration:  0 days 03:00:00\n number of scan periods: 1\n  record size:    18 table size:    96 hash table size:    64\n  memory usage for scan results:     1754 bytes\n  approximate run-time memory usage:   2266 bytes\n  Prefilter: n  Link layer filter: n  Network layer filter: y\nTracking the following elements:\n  IPv4 source address\n  IPv4 destination address\n  IPv4 protocol\n  TCP/UDP source port\n  TCP/UDP destination port\n  IPv4 TTL (recorded once, not tracked)\nThis configuration could be established with the following command line:\n -S <scan type> -t IP4 -s 10800 -N 1 -n 96 --hashTableSize 64 \nSending start request to implant. Are you sure (y/n) [y]? y\n networkProfiler scan started.\n   8 : Re-show menu.\n   13,0,5 : Show records of ongoing networkProfiler scan.\n\n```\n\n-----\n\n```\n(13 0 0) networkProfiler module data:\nScan period 0:\n  total packets collected:         2\n  packets discarded due to error:     0\n  number of records collected:       1\n  number of records dropped:        0\n  scan start (target box time, displayed as GMT): Thu Sep 8 15:45:37 2016\n  scan end (target box time, displayed as GMT) : Thu Sep 8 18:45:37 2016A\n    scan in progress\nRecords:\nIPv4 source address           : 192.168.001.001\nIPv4 destination address        : 192.168.001.002\nIPv4 protocol              : 0x11\nTCP/UDP source port           : 3000\nTCP/UDP destination port        : 4000\nIPv4 TTL (recorded once, not tracked)  : 64\n  count: 2\n\n### This shows one record which summarizes the two UDP packets exchanged between the implant and LP. Nothing else is happening on the simulated network. To get a better idea of what it is doing it would make sense to inject some fake traffic.\n   7,0,0 : Get comms state. This simply shows the same information again as when\n\n connecting.\nConnected to node 00000000\n   Firewall Type : 00000000   Firewall Version: 00000000\n   Remote Code Version: 666.6.6\n   Remote IP Addr: 192.168.001.002\n   Remote interface : 0000\n   Listen IP Addr : 000.000.000.000\n   Listen IP timeout (on remote node) : none\n   Remote IP Sticky?: True\n   LP IP: 192.168.001.001\n   Source Port: 4000 Destination Port: 3000\n   Session Start Time (on remote node): Thu Sep 8 11:44:36 2016\n   7,0,1 : Set a filter. Apparently I botched this as it loses contact to the implant.\nPlease enter the new filter IP/netmask [255.255.255.255/32]: 192.168.1.0/24\nPlease enter the filter timeout in minutes (0 for no timeout) [0]: 100\nAbout to install filter IP 192.168.001.000/24, timeout 100 minutes.\nAre you sure? (y/n) [n]? y\nOperation succeeded.\n2016-09-08 11:44:48 Menu Selection>? 0,0,0\n11:44:55 2016-09-08 ===> selection 0 0 0\nTimed Out\ncreateSendRecv_5iHelper: attempt 1 of 3 timed out.\n   0 : Exit session.\n\n```\n- 999) BURN sure sounds enticing, but can’t demonstrate it as the necessary interface is not simulated. Drats.\n\n\n-----\n\n### Written on September 9, 2016\n\n Tags: eqgrp malware Filed under Reverse-engineering\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-09-06 - Blatsting C&C Transcript.pdf"
    ],
    "report_names": [
        "2016-09-06 - Blatsting C&C Transcript.pdf"
    ],
    "threat_actors": [
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535789,
    "ts_updated_at": 1743041505,
    "ts_creation_date": 1653713430,
    "ts_modification_date": 1653713430,
    "files": {
        "pdf": "https://archive.orkl.eu/567c2a740b891906c8ce8e12487ad8eec9eaaa2b.pdf",
        "text": "https://archive.orkl.eu/567c2a740b891906c8ce8e12487ad8eec9eaaa2b.txt",
        "img": "https://archive.orkl.eu/567c2a740b891906c8ce8e12487ad8eec9eaaa2b.jpg"
    }
}