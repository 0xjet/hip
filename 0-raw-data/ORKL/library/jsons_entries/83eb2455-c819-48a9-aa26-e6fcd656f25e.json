{
    "id": "83eb2455-c819-48a9-aa26-e6fcd656f25e",
    "created_at": "2023-01-12T15:04:40.288833Z",
    "updated_at": "2025-03-27T02:09:18.34026Z",
    "deleted_at": null,
    "sha1_hash": "19f9e4c5b0628ec40ab252cc39905b2c08dd9a63",
    "title": "2022-02-21 - Cobalt Strike Being Distributed to Vulnerable MS-SQL Servers",
    "authors": "",
    "file_creation_date": "2022-05-27T20:00:31Z",
    "file_modification_date": "2022-05-27T20:00:31Z",
    "file_size": 1950354,
    "plain_text": "# Cobalt Strike Being Distributed to Vulnerable MS-SQL Servers\n\n**asec.ahnlab.com/en/31811/**\n\nFebruary 21, 2022\n\nThe ASEC analysis team has recently discovered the distribution of Cobalt Strike targeting\nMS-SQL servers that are vulnerable to malware attacks.\n\nMS-SQL server is a typical database server of the Windows environment, and it has\nconsistently been a target of attack from the past. Attacks that target MS-SQL servers\ninclude attacks to the environment where its vulnerability has not been patched, brute\n**forcing, and dictionary attack against poorly managed servers.**\n\nThe attacker or the malware usually scans port 1433 to check for MS-SQL servers open to\nthe public. It then performs brute forcing or dictionary attacks against the admin account,\na.k.a. “sa” account to attempt logging in. Even if the MS-SQL server is not open to the\npublic, there are types such as Lemon Duck malware that scans port 1433 and spreads for\nthe purpose of lateral movement in the internal network.\n\n\n-----\n\nFigure 1. List of Passwords for Dictionary Attack Used by LemonDuck\nManaging admin account credentials so that they’re vulnerable to brute forcing and\ndictionary attacks as above or failing to change the credentials periodically may make the\nMS-SQL server the main target of attackers. Other malware besides Lemon Duck that target\nMS-SQL server includes CoinMiner malware such as Kingminer and Vollgar.\n\nIf the attacker succeeds to log in to the admin account through these processes, they use\nvarious methods including the xp_cmdshell command to execute the command in the\ninfected system. Cobalt Strike that has recently been discovered was downloaded through\ncmd.exe and powershell.exe via the MS-SQL process as shown below.\n\n**Figure 2. Process Tree**\nCobalt Strike is a commercial penetration testing tool, and it is recently being used as a\nmedium to dominate the internal system in the majority of attacks including APT and\nransomware. Malware that has recently been discovered is an injector that decodes the\nencoded Cobalt Strike inside, and executes and injects the normal program MSBuild.exe.\n\n\n-----\n\n**Figure 3. Cobalt Strike settings data**\nCobalt Strike that is executed in MSBuild.exe has an additional settings option to bypass\ndetection of security products, where it loads the normal dll wwanmm.dll, then writes and\nexecutes a beacon in the memory area of the dll. As the beacon that receives the attacker’s\ncommand and performs the malicious behavior does not exist in a suspicious memory area\nand instead operates in the normal module wwanmm.dll, it can bypass memory-based\ndetection.\n\n**Figure 4. Shellcode and strings used for wwanmm.dll**\nAlthough it is not certain in which method the attacker dominated MS-SQL and installed the\nmalware, as the detection logs of Vollgar malware that was previously mentioned were\ndiscovered, it can be assumed that the targeted system had inappropriately managed the\naccount credentials.\n\n\n-----\n\nAhnLab s ASD infrastructure shows numerous logs of Cobalt Strike over the past month.\nSeeing that the download URLs and the C&C server URL are similar, it appears that most of\nthe attacks were by the same attacker. IOC of Cobalt Strike over the month is shown in the\nlist below.\n\nAhnLab products are equipped with process memory-based detection method and behaviorbased detection feature that can counter the beacon backdoor which is used from the Cobalt\nStrike’s initial invasion stage to spread internally.\n\n**[File Detection]**\n– Trojan/Win.FDFM.C4959286 (2022.02.09.00)\n– Trojan/Win.Injector.C4952559 (2022.02.04.02)\n– Trojan/Win.AgentTesla.C4950264 (2022.02.04.00)\n– Infostealer/Win.AgentTesla.R470158 (2022.02.03.02)\n– Trojan/Win.Generic.C4946561 (2022.02.01.01)\n– Trojan/Win.Agent.C4897376 (2022.01.05.02)\n– Trojan/Win32.CobaltStrike.R329694 (2020.11.26.06)\n\n**[Behavior Detection]**\n– Malware/MDP.Download.M1197\n\n**[IOC]**\n**MD5**\n**Cobalt Strike (Stageless)**\n– ae7026b787b21d06cc1660e4c1e9e423\n– 571b8c951febb5c24b09e1bc944cdf5f\n– e9c6c2b94fc83f24effc76bf84274039\n– 828354049be45356f37b34cc5754fcaa\n– 894eaa0bfcfcdb1922be075515c703a3\n– 4dd257d56397ec76932c7dbbc1961317\n– 450f7a402cff2d892a7a8c626cef44c6\n\n**CobaltStrike (Stager)**\n– 2c373c58caaaca0708fdb6e2b477feb2\n– bb7adc89759c478fb88a3833f52f07cf\n\n**C&C**\n– hxxp://92.255.85[.]83:7905/push\n– hxxp://92.255.85[.]83:9315/en_US/all.js\n– hxxp://92.255.85[.]86:80/owa/\n– hxxp://92.255.85[.]90:81/owa/\n– hxxp://92.255.85[.]90:82/owa/\n– hxxp://92.255.85[.]92:8898/dot.gif\n\n\n-----\n\n– hxxp://92.255.85[.]93:18092/match\n– hxxp://92.255.85[.]93:12031/j.ad\n– hxxp://92.255.85[.]94:83/ga.js\n\n**Beacon Download URL**\n– hxxp://92.255.85[.]93:18092/jRQO\n– hxxp://92.255.85[.]93:12031/CbCt\n\n**Download URL**\n– hxxp://45.64.112[.]51/dol.exe\n– hxxp://45.64.112[.]51/mr_robot.exe\n– hxxp://45.64.112[.]51/lion.exe\n– hxxp://81.68.76[.]46/kk.exe\n– hxxp://81.68.76[.]46/uc.exe\n– hxxp://103.243.26[.]225/acrobat.exe\n– hxxp://103.243.26[.]225/beacon.exe\n– hxxp://144.48.240[.]69/dola.exe\n– hxxp://144.48.240[.]85/core.exe\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:BruteForcing,](https://asec.ahnlab.com/tag/bruteforcing/) [Cobalt Strike,](https://asec.ahnlab.com/tag/cobalt-strike/) [CobaltStrike,](https://asec.ahnlab.com/tag/cobaltstrike/) [Database,](https://asec.ahnlab.com/tag/database/) [Dictionary Attack,](https://asec.ahnlab.com/tag/dictionary-attack/) [MS-SQL,](https://asec.ahnlab.com/tag/ms-sql/)\n[MSSQL](https://asec.ahnlab.com/tag/mssql/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-21 - Cobalt Strike Being Distributed to Vulnerable MS-SQL Servers.pdf"
    ],
    "report_names": [
        "2022-02-21 - Cobalt Strike Being Distributed to Vulnerable MS-SQL Servers.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535880,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653681631,
    "ts_modification_date": 1653681631,
    "files": {
        "pdf": "https://archive.orkl.eu/19f9e4c5b0628ec40ab252cc39905b2c08dd9a63.pdf",
        "text": "https://archive.orkl.eu/19f9e4c5b0628ec40ab252cc39905b2c08dd9a63.txt",
        "img": "https://archive.orkl.eu/19f9e4c5b0628ec40ab252cc39905b2c08dd9a63.jpg"
    }
}