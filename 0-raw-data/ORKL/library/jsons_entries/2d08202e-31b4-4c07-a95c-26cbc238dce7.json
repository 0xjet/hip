{
    "id": "2d08202e-31b4-4c07-a95c-26cbc238dce7",
    "created_at": "2023-03-03T02:05:43.771191Z",
    "updated_at": "2025-03-27T02:06:04.632709Z",
    "deleted_at": null,
    "sha1_hash": "1d4450ca8aa6672936a04567ffd5405b57768e9a",
    "title": "2023-02-09 - Technical analysis of Godfather android malware",
    "authors": "",
    "file_creation_date": "2023-03-01T09:13:07Z",
    "file_modification_date": "2023-03-01T09:13:07Z",
    "file_size": 1584346,
    "plain_text": "# Technical analysis of Godfather android malware\n\n**muha2xmad.github.io/malware-analysis/godfather/**\n\n### Muhammad Hasan Ali\n\nMalware Analysis learner\n\n7 minute read\n\n**بسم اهلل الرحمن الرحيم**\n\n**FreePalestine**\n\n## Introduction\n\n\nFebruary 8, 2023\n\n```\nGodfather is a malware that targets Android devices. It was first discovered in 2020 and is\n\n```\nknown for its sophisticated and aggressive behavior. The malware is designed to steal\nsensitive information such as banking credentials, passwords, and other personal data from\ninfected devices.\n\nThe Godfather Android banking malware is a threat to users in 16 countries, as it has been\ndesigned to steal account credentials from over 400 online banking sites and cryptocurrency\nexchanges. It accomplishes this by disguising itself as a login screen, overlaying the login\nforums of banking and cryptocurrency exchange apps.\n\n\n-----\n\n## Anti-emulator\n\nAfter installing The malware on the device, it checks the device if it’s an emulator or not. If\nthe malware is installed on the emulator, the malware will not run its malicious functions.\n\nFigure(1): The method that checks for emulator existence\n\nThe method retrun is boolean. When the malware checks for the emulator exitance, the\nreturn is 0 when there’s no emulator or the return is 1 when there’s an emulator\n\n## Collect vectim’s device info\n\nThe malware will collect information about the device that’s infected and send the collected\ninformation to the C2 server. The information which will be sent to the C2 server such as\n```\napplist which will collect all the applications installed on the device, ag to get the user\n\n```\nagent, sim to get the network operator name, phone to get the phone number of the device,\n```\nmodel, and ver of the device.\n\n```\n\n-----\n\nFigure(2): The method that collects info about the victim's device\n\n## USSD\n\nThis method can make the malware transfers meoney using money transfers by making\n```\nUSSD (Unstructured Supplementary Service Data) calls without even using the dialer user\n\n```\ninterface.\n\nFigure(3): The method that performs USSD\n\nWhen the malware communicate withe C2 server and the response from the C2 server\ncontains startUSSD command, the malware will start this method to transfer money using\n```\nUSSD.\n\n```\n\n-----\n\nFigure(4): The command that performs USSD\n\n## Call forwarding\n\nThe malware has the ability to forward incomming calls. This is used to bypass the two factor\nauthintication 2FA.\n\nFigure(5): The method that performs call fowrwarding\n\nWhen the malware communicate withe C2 server and the response from the C2 server\ncontains startforward command, the malware will start this method to start call forwarding.\n\nFigure(6): The command that performs call forwarding\n\n## Push notifications\n\nThe malware will push fake notifications as if the notification came from ligitmate application.\nWhen the user opens the fake notifications, this opens a fake Web page and the user may\nenter his/her inforamtions such as username, email, or password.\n\n\n-----\n\nFigure(7): The method that performs pushing fake notifications\n\nWhen the malware communicate withe C2 server and the response from the C2 server\ncontains startPush command, the malware will start this method to start pushing fake\nnotifications.\n\nFigure(8): The command that performs pushing fake notifications\n\n## Smishing\n\nThe malware will send message which contains malicous URLs to download malicous\napplications to victim’s contacts. This message is received from the C2 server and then the\nmalware will send it to all contacts.\n\nFigure(9): The method that query contacts\n\n\n-----\n\nWhen the malware communicate withe C2 server and the response from the C2 server\ncontains BookSMS command, the malware will start this method to start sending SMSs to the\nvictim’s contacts.\n\nFigure(10): The command that performs Smishing\n\n## Steal SMSs\n\nThe malware will collect the SMSs on the victim’s device and send the data to the C2 server.\nThis is used to bypass the two factor authintication 2FA.\n\nFigure(11): The method that performs collecting SMSs\n\nWhen the malware communicate withe C2 server and the response from the C2 server\ncontains sentSMS command, the malware will start this method to start sending the SMSs to\nthe C2 server.\n\nFigure(12): The command that performs stealing SMSs\n\n## Record the screen\n\nThe malware will record a video of the screen of the victim’s device then sends the video to\nthe C2 server. This technique is used to steal sensitive data as the same as overlay attack.\nWhen the user opens a targeted app, the malware send to the C2 server that the user\nopened a targeted app. The C2 server sends a command to start recording the screen.\n\n\n-----\n\nFigure(13): The method that performs recording a video\n\n## VNC\n```\nVNC, which stands for Virtual Network Computing, is a protocol for remote control of\n\n```\ncomputers. VNC can be used by the malware to gain remote control over an infected device,\nallowing the attacker to perform various malicious activities.\n\nFor example, a VNC-based Android malware might allow an attacker to remotely access the\ndevice’s screen, camera, microphone, and other resources, allowing them to steal sensitive\ninformation, carry out phishing attacks, or monitor the user’s activities. The malware may\nalso use the VNC connection to install additional malicious software on the device, making it\npart of a larger network of compromised devices (known as a botnet).\n\nFigure(14): The command that performs starting VNC\n\n\n-----\n\nsettings_port: The value of the port is 5900.\n\nsettings_password: the value of the password is 123.\n\nuser: the value of the user is bluetooth_name.\n\nvnc_host: the value of the host is 5500.\n\nThe settings_port, settings_password values are saved in the Shared Preferences.\n\n## Overlay attack\n\nWhen the user opens a targeted app, the malware displays a fake or malicious overlay on\ntop of the active window of the targeted app. The opened malicious window is the same as\nthe legitimate app. This allows the attacker to steal sensitive information, such as login\ncredentials, credit card numbers, or other sensitive data, by tricking the user into entering it\ninto the overlay.\n\nFigure(15): The method that performs overlay attack\n\n## Start/Kill the malware\n\nThe C2 server sends to the malware to start or terminate itself.\n\n\n-----\n\nFigure(16): The command that starts the malware\n\nFigure(17): The command that performs killing the bot\n\n## Cache cleaner\n\nThe malware will clean the cache of an app. The malware will send cachecleaner command\nfrom the C2 server and app name in the command.\n\nFigure(18): The command that clear the cache\n\n## Communications\n\nThe malware will get the C2 server URL from description of a Telegram channel. The\nmalware will send an HTTP reguest To https://t.me/varezotukomirza to get the encrypted\nC2 server zH7cPW3ZEHj5SDEKxFtXcoMXMJmMGlMGCH978whkdfQ. The C2 server is encrypted\nusing Blowfish algorithm with ECB_MODE and ABC as a key and encoded using Base64.\n\n\n-----\n\nFigure(19): The encrypted C2 server\n\nWhen we decrypt The C2 server:\n\nDecoded the Base64, then\n\nDecrypt the blowfish with ECB_MODE using ABC as a key\n\nThanks to [Witold Precikowski for helping to decrypt the C2 server. We use this script to](https://twitter.com/pr3wtd)\ndecrypt the encrypted C2 server obtained form the Telegram channel.\n\n\n-----\n\n```\nfrom Crypto.Cipher import Blowfish\n\nimport base64\n\nbs = Blowfish.block_size\n\nkey = b'ABC'\n\ndata = 'zH7cPW3ZEHj5SDEKxFtXcoMXMJmMGlMGCH978whkdfQ='\n\n# Base64 decode\n\nciphertext = base64.b64decode(data)\n\n# Decrypt Blowfish in ECB mode\n\ncipher = Blowfish.new(key, Blowfish.MODE_ECB)\n\nmsg = cipher.decrypt(ciphertext)\n\nlast_byte = msg[-1]\n\nmsg = msg[:- (last_byte if type(last_byte) is int else ord(last_byte))]\n\nprint(msg)\n\n```\nThe decrypted C2 server will be https://kalopterbomrassa.shop/.\n\nAfter the malware gets the C2 server the communication between the C2 server and the\nmalware will be decrypted using AES/CBC/NoPadding with fedcba9876543210 as IV and\n```\n0123456789abcdef as a key.\n\n```\nFigure(20): Algorithm to decrypt communication between the C2 server and the malware\n\n[Special thanks to Witold Precikowski,](https://twitter.com/pr3wtd) [Lasha kh., and](https://twitter.com/_qaz_qaz) [Re-ind for their continuous help and](https://twitter.com/ReBensk)\nsupport.\n\n## IoCs\n\nApp name: MYT Müzik\n\nPackage name: com.expressvpn.vpn\n\nSha256: 138551cd967622832f8a816ea1697a5d08ee66c379d32d8a6bd7fca9fdeaecc4\n\nTelegram channel: https://t.me/varezotukomirza\n\n\n-----\n\nC2 server: https://kalopterbomrassa.shop/\n\n## Yara rule\n```\nrule Godgather {\n\n meta:\n\n  author   = \"@muha2xmad\"\n\n  date    = \"2023-02-09\"\n\n  description = \"Godfather android malware\"\n\n  version   = \"1.0\"\n\n strings:\n\n  $str00 = \"main_wang\" nocase\n\n  $str01 = \"#21#\" nocase\n\n  $str02 = \"config\" nocase\n\n  $str03 = \"godfather\" nocase\n\n  $str04 = \"fafa.php\" nocase\n\n  $str05 = \"POPTR\" nocase\n\n  $str06 = \"patara.php\" nocase\n\n condition:\n\n  uint32be(0) == 0x504B0304 // APK file signature\n\n   and ( all of ($str*))\n\n}\n\n\n\n Article quote\n\n```\nماء زمزممن نبَت لحُمه من ماء الِبَرك كيف يستسيُ[غ]\n\n\n-----\n\n## REF\n\n[Godfather: A banking Trojan that is impossible to refuse](https://www.group-ib.com/blog/godfather-trojan/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-09 - Technical analysis of Godfather android malware.pdf"
    ],
    "report_names": [
        "2023-02-09 - Technical analysis of Godfather android malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1677809143,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1677661987,
    "ts_modification_date": 1677661987,
    "files": {
        "pdf": "https://archive.orkl.eu/1d4450ca8aa6672936a04567ffd5405b57768e9a.pdf",
        "text": "https://archive.orkl.eu/1d4450ca8aa6672936a04567ffd5405b57768e9a.txt",
        "img": "https://archive.orkl.eu/1d4450ca8aa6672936a04567ffd5405b57768e9a.jpg"
    }
}