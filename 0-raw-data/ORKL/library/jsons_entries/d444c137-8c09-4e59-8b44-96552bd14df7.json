{
    "id": "d444c137-8c09-4e59-8b44-96552bd14df7",
    "created_at": "2023-01-12T14:59:23.397867Z",
    "updated_at": "2025-03-27T02:16:25.788787Z",
    "deleted_at": null,
    "sha1_hash": "29a25893905ebdaff0f3948d6f8bbb99dfc45b31",
    "title": "2017-06-08 - Dvmap- the first Android malware with code injection",
    "authors": "",
    "file_creation_date": "2022-05-29T01:03:20Z",
    "file_modification_date": "2022-05-29T01:03:20Z",
    "file_size": 545176,
    "plain_text": "# Dvmap: the first Android malware with code injection\n\n**[securelist.com/dvmap-the-first-android-malware-with-code-injection/78648/](https://securelist.com/dvmap-the-first-android-malware-with-code-injection/78648/)**\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n08 Jun 2017\n\nminute read\n\n\n-----\n\nAuthors\n\n[Roman Unuchek](https://securelist.com/author/romanunuchek/)\n\n**In April 2017 we started observing new rooting malware being distributed through the**\n**Google Play Store. Unlike other rooting malware, this Trojan not only installs its**\n**modules into the system, it also injects malicious code into the system runtime**\n**libraries. Kaspersky Lab products detect it as Trojan.AndroidOS.Dvmap.a.**\n\nThe distribution of rooting malware through Google Play is not a new thing. For example, the\n[Ztorg Trojan has been uploaded to Google Play almost 100 times since September 2016.](https://securelist.com/analysis/publications/78325/ztorg-money-for-infecting-your-smartphone/)\nBut Dvmap is very special rooting malware. It uses a variety of new techniques, but the most\ninteresting thing is that it injects malicious code into the system libraries – libdmv.so or\nlibandroid_runtime.so.\n\nThis makes Dvmap the first Android malware that injects malicious code into the system\nlibraries in runtime, and it has been downloaded from the Google Play Store more than\n50,000 times. Kaspersky Lab reported the Trojan to Google, and it has now been removed\nfrom the store.\n\n\n-----\n\n_Trojan.AndroidOS.Dvmap.a on Google Play_\n\nTo bypass Google Play Store security checks, the malware creators used a very interesting\nmethod: they uploaded a clean app to the store at the end of March, 2017, and would then\nupdate it with a malicious version for short period of time. Usually they would upload a clean\nversion back on Google Play the very same day. They did this at least 5 times between 18\nApril and 15 May.\n\nAll the malicious Dvmap apps had the same functionality. They decrypt several archive files\nfrom the assets folder of the installation package, and launch an executable file from them\nwith the name “start.”\n\n\n-----\n\n_Encrypted archives in the assets folder_\n\nThe interesting thing is that the Trojan supports even the 64-bit version of Android, which is\nvery rare.\n\n_Part of code where the Trojan chooses between 32-bit and 64-bit compatible files_\n\nAll encrypted archives can be divided into two groups: the first comprises Game321.res,\nGame322.res, Game323.res and Game642.res – and these are used in the initial phase of\ninfection, while the second group: Game324.res and Game644.res, are used in the main\nphase.\n\n## Initial phase\n\nDuring this phase, the Trojan tries to gain root rights on the device and to install some\nmodules. All archives from this phase contain the same files except for one called “common”.\nThis is a local root exploit pack, and the Trojan uses 4 different exploit pack files, 3 for 32-bit\nsystems and 1 for 64-bit-systems. If these files successfully gain root rights, the Trojan will\ninstall several tools into the system. It will also install the malicious app\n“com.qualcmm.timeservices.”\n\nThese archives contain the file “.root.sh” which has some comments in Chinese:\n\n\n-----\n\n_Part of .root.sh file_\n\n## Main phase\n\nIn this phase, the Trojan launches the “start” file from Game324.res or Game644.res. It will\ncheck the version of Android installed and decide which library should be patched. For\nAndroid 4.4.4 and older, the Trojan will patch method\n_Z30dvmHeapSourceStartupBeforeForkv from libdvm.so, and for Android 5 and newer it will\npatch method nativeForkAndSpecialize from libandroid_runtime.so. Both of these libraries\n[are runtime libraries related to Dalvik and](https://en.wikipedia.org/wiki/Dalvik_(software)) [ART runtime environments. Before patching, the](https://en.wikipedia.org/wiki/Android_Runtime)\nTrojan will backup the original library with a name bak_{original name}.\n\n_Patched libdvm.so_\n\n\n-----\n\nDuring patching, the Trojan will overwrite the existing code with malicious code so that all it\ncan do is execute /system/bin/ip. This could be very dangerous and cause some devices to\ncrash following the overwrite. Then the Trojan will put the patched library back into the\nsystem directory. After that, the Trojan will replace the original /system/bin/ip with a malicious\none from the archive (Game324.res or Game644.res). In doing so, the Trojan can be sure\nthat its malicious module will be executed with system rights. But the malicious ip file does\nnot contain any methods from the original ip file. This means that all apps that were using\nthis file will lose some functionality or even start crashing.\n\n## Malicious module “ip”\n\nThis file will be executed by the patched system library. It can turn off “VerifyApps” and\nenable the installation of apps from 3 party stores by changing system settings.rd\nFurthermore, it can grant the “com.qualcmm.timeservices” app Device Administrator rights\nwithout any interaction with the user, just by running commands. It is a very unusual way to\nget Device Administrator rights.\n\n## Malicious app com.qualcmm.timeservices\n\nAs I mentioned before, in the “initial phase”, the Trojan will install the\n“com.qualcmm.timeservices” app. Its main purpose is to download archives and execute the\n“start” binary from them. During the investigation, this app was able to successfully connect\nto the command and control server, but it received no commands. So I don’t know what kind\nof files will be executed, but they could be malicious or advertising files.\n\n## Conclusions\n\nThis Trojan was distributed through the Google Play Store and uses a number of very\ndangerous techniques, including patching system libraries. It installs malicious modules with\ndifferent functionality into the system. It looks like its main purpose is to get into the system\nand execute downloaded files with root rights. But I never received such files from their\ncommand and control server.\n\nThese malicious modules report to the attackers about every step they are going to make.\nSo I think that the authors are still testing this malware, because they use some techniques\nwhich can break the infected devices. But they already have a lot of infected users on whom\nto test their methods.\n\nI hope that by uncovering this malware at such an early stage, we will be able to prevent a\nmassive and dangerous attack when the attackers are ready to actively use their methods.\n\n## MD5\n\n\n-----\n\n43680D1914F28E14C90436E1D42984E2\n20D4B9EB9377C499917C4D69BF4CCEBE\n\n[Code injection](https://securelist.com/tag/code-injection/)\n[Google Android](https://securelist.com/tag/google-android/)\n[Mobile Malware](https://securelist.com/tag/mobile-malware/)\n[Trojan](https://securelist.com/tag/trojan/)\n\nAuthors\n\n[Roman Unuchek](https://securelist.com/author/romanunuchek/)\n\nDvmap: the first Android malware with code injection\n\nYour email address will not be published. Required fields are marked *\n\nTable of Contents\n\nInitial phase\nMain phase\nMalicious module “ip”\nMalicious app com.qualcmm.timeservices\nConclusions\nMD5\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\n22 Jul 2020, 2:00pm\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\nReports\n\n### APT trends report Q1 2022\n\nThis is our latest summary of advanced persistent threat (APT) activity, focusing on events\nthat we observed during Q1 2022.\n\n### Lazarus Trojanized DeFi app for delivering malware\n\nWe recently discovered a Trojanized DeFi application that was compiled in November 2021.\nThis application contains a legitimate program called DeFi Wallet that saves and manages a\ncryptocurrency wallet, but also implants a full-featured backdoor.\n\n### MoonBounce: the dark side of UEFI firmware\n\n\n-----\n\nAt the end of 2021, we inspected UEFI firmware that was tampered with to embed a\nmalicious code we dub MoonBounce. In this report we describe how the MoonBounce\nimplant works and how it is connected to APT41.\n\n### The BlueNoroff cryptocurrency hunt is still on\n\nIt appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to\nsolely cryptocurrency businesses as the main source of the group’s illegal income.\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-08 - Dvmap- the first Android malware with code injection.pdf"
    ],
    "report_names": [
        "2017-06-08 - Dvmap- the first Android malware with code injection.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535563,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653786200,
    "ts_modification_date": 1653786200,
    "files": {
        "pdf": "https://archive.orkl.eu/29a25893905ebdaff0f3948d6f8bbb99dfc45b31.pdf",
        "text": "https://archive.orkl.eu/29a25893905ebdaff0f3948d6f8bbb99dfc45b31.txt",
        "img": "https://archive.orkl.eu/29a25893905ebdaff0f3948d6f8bbb99dfc45b31.jpg"
    }
}