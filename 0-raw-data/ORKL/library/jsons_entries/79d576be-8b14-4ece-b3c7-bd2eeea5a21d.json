{
    "id": "79d576be-8b14-4ece-b3c7-bd2eeea5a21d",
    "created_at": "2023-01-12T15:03:37.70028Z",
    "updated_at": "2025-03-27T02:16:34.792759Z",
    "deleted_at": null,
    "sha1_hash": "64ea623021b2b3186254b0e000de886b91b8325d",
    "title": "2021-06-25 - Investigating and Mitigating Malicious Drivers",
    "authors": "",
    "file_creation_date": "2022-05-28T23:12:39Z",
    "file_modification_date": "2022-05-28T23:12:39Z",
    "file_size": 63550,
    "plain_text": "# Investigating and Mitigating Malicious Drivers\n\n**[msrc-blog.microsoft.com/2021/06/25/investigating-and-mitigating-malicious-drivers/](https://msrc-blog.microsoft.com/2021/06/25/investigating-and-mitigating-malicious-drivers/)**\n\n[The security landscape continues to rapidly evolve as threat actors find](https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/) [new and innovative](https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/)\nmethods to gain access to environments across a wide range of vectors. As the industry\nmoves closer to the adoption of a Zero Trust security posture with broad and layered\ndefenses, we remain committed to sharing threat intelligence with the community to shine a\nlight on the latest techniques and exploits of attackers so the industry can better protect\nitself.\n\nMicrosoft is investigating a malicious actor distributing malicious drivers within gaming\nenvironments. The actor submitted drivers for certification through the Windows Hardware\nCompatibility Program. The drivers were built by a third party. We have suspended the\naccount and reviewed their submissions for additional signs of malware.\n\n## No Evidence of Certificate Exposure\n\nWe have seen no evidence that the WHCP signing certificate was exposed. The\ninfrastructure was not compromised. In alignment with our Zero Trust and layered defenses\nsecurity posture, we have built-in detection and blocking of this driver and associated files\nthrough Microsoft Defender for Endpoint. We are also sharing these detections with other AV\nsecurity vendors so they can proactively deploy detections.\n\nThe actor’s activity is limited to the gaming sector specifically in China and does not appear\nto target enterprise environments. We are not attributing this to a nation-state actor at this\ntime. The actor’s goal is to use the driver to spoof their geo-location to cheat the system and\nplay from anywhere. The malware enables them to gain an advantage in games and possibly\nexploit other players by compromising their accounts through common tools like keyloggers.\n\nIt’s important to understand that the techniques used in this attack occur post exploitation,\nmeaning an attacker must either have already gained administrative privileges in order to be\nable to run the installer to update the registry and install the malicious driver the next time the\nsystem boots or convince the user to do it on their behalf.\n\nWe will be sharing an update on how we are refining our partner access policies, validation\nand the signing process to further enhance our protections. There are no actions customers\nshould take other than follow security best practices and deploy Antivirus software such as\nWindows Defender for Endpoint.\n\nJust like our defenders, our adversaries are creative and determined. Because of this,\nMicrosoft approaches security with an assume breach mentality and layered defenses. We\nwork tirelessly alongside our industry partners to ensure the community as a whole is aware\n\n\n-----\n\nof new attack tools, tactics and procedures that we have observed or that have been\nreported through responsible disclosure. By sharing the information we’ve learned with this\nreport, we are raising awareness of these techniques so that more protections can be built in\nacross the industry and to increase the degree of difficulty for attackers.\n\n## Additional Information on the Windows Hardware Compatibility Program\n\nMicrosoft Defender and Windows Security teams work diligently with driver publishers to\ndetect security vulnerabilities before they can be exploited by malicious software. Microsoft\nDefender for Endpoint’s UEFI scanner is able to scan below the operating system where\nthese attacks occur to add further detection and protection from these kinds of low-level\nattacks. We also build automated mechanisms through Windows Update to block vulnerable\nversions of drivers and protect customers against vulnerability exploits based on ecosystem\nand partner engagement as this is an issue that challenges the industry at large.\n\nOur security teams continue to work closely with the OEM and driver publishers to analyze\nand patch any known vulnerabilities and to update affected devices prior to shipment. Once\nthe driver publisher patches the vulnerability, an update to all affected drivers is pushed out\nvia the Windows Update (WU) platform. Once affected devices receive the latest security\npatches, drivers with confirmed security vulnerabilities are blocked on Windows 10 devices\nusing Microsoft Defender for Endpoint Attack Surface Reduction (ASR) and Microsoft\nWindows Defender Application Control (WDAC) technologies to protect devices against\n[exploits. More information is available via our Microsoft recommended driver block rules](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-driver-block-rules)\ndocument.\n\n## Indicators of compromise\n\nIn addition to [creating antimalware signatures for Microsoft Defender antivirus, sharing key](https://www.microsoft.com/en-us/wdsi/threats/threat-search?query=Retliften)\ndetection guidance with our AV partners, we are also sharing these hashes and IP\naddresses for other defenders to leverage.\n\n## Known C2 IP addresses\n\n110.42.4[.]180\n\n45.113.202[.]180\n\n## Known malicious files\n\nThese are the list of SHA256 file hashes known to Microsoft as malicious:\n\n04a269dd0a03e32e5b2a1c8ab0768791962e040d080d44dc44dab01dd7954f2b\n0856a1da15b2b3e8999bf9fc51bbdedd4051e21fab1302e2ce766180b4931d86\n0c42fe45ffa9a9c36c87a7f01510a077da6340ffd86bf8509f02c6939da133c5\n\n\n-----\n\n0eace788e09c8d3f793a1fad94d35bcfd233f0777873412cd0c8172865562eec\n115034373fc0ec8f75fb075b7a7011b603259ecc0aca271445e559b5404a1406\n12656fc113b178fa3e6bfffc6473897766c44120082483eb8059ebff29b5d2df\n12c0002af719c6abbc1e726b409fce099fffb90f758477f5295c152bde504caa\n16b6be03495a4f4cf394194566bb02061fba2256cc04dcbde5aa6a17e41b7650\n18b923b169b2c3c7db5cbfda0db0999f04adb2cf6c917e5b1fb2ff04714ecac1\n1aa8ba45f9524847e2a36c0dc6fd80162923e88dc1be217dde2fb5894c65ff43\n1cd75de5f54b799b60789696587b56a4a793cf60775b81f236f0e65189d863af\n1d1f7e26109e6cb28c6b369c937b407d7b0cce3c4800ce9852eda94742b12259\n1d60819f0ab8547dcd4eb18d39a0c317ec826332afa19c0a6af94bc681a21f14\n1f05f74ebae7e65d389703d423445ffb269e657d8278b0523417e1f72b0228eb\n1f90d9c4d259c1fde4c7bb66a95d71ea0122e4dfb75883a6cb17b5c80ce6d18a\n22da5a055b7b17c69def9f5af54e257c751507e7b6b9a835fcf6245ab90ae750\n22f6fe6bd62fb03f7aee489cccbc918999f49596052ac0153c02cd7a3320de13\n23c061933d471c1f959c77806098ec0528d9b1d0130689bb3f417dd843138468\n24ea733bae1b8722841fb4c6cead93c4c4f0b1248ca9a21601b1ce6b95b06864\n26d67d479dafe6b33c980bd1eed0b6d749f43d05d001c5dcaaf5fcddb9b899fe\n26f2b9cf6e0fb50bad49a367bee63e808f1d53c476b38642d13c7db6e50687f4\n2fa78c2988f9580b0c18822b117d065fb419f9c476f4cfa43925ba6cd2dffac3\n314affdc86f62c8f8069ccd50a2cdf73bcd319773a031be700ba97a1ea4129a8\n34c890fa43ca0e5165a4960549828ba43d7f48a216a22fc46204548ebfc34f72\n3700b38d63d426ff0a985226b45eca6e24d052f4262d12aff529e62c2cb889c3\n40c45c9b1c764777096b59f99ae524cbd25b88c805187e615c3ed6840f3d4c15\n45ee083e28fbb33afa41b1b8cd00d94c29dea8cb7cee70bae4079e6c3dfb5501\n4ce61ad21f186cf10dbcc253feee31262203cb5c12c5a140d2dda5447c57aba1\n516159871730b18c2bddedb1a9da110577112d4835606ee79bb80e7a58784a13\n5cb1dc26159c6700d6cadece63f6defda642ec1a6d324daefb0965b4e3746f70\n5d0d5373c5e52c4405f4bd963413e6ef3490b7c4c919ec2d4e3fb92e91f397a0\n62d7c5465852cdb7b59a86c20b4de5991c8f4820ce11a7c01cf0dde6032e500d\n630d7bdc20f33e6f822f52533a324865694886b7b74dfaad1dc30c9aee4260a2\n635273eaa4c2e20c4ec320c6c8447ce2e881984e97c9ed6aeec4fad16b934e81\n63d61549030fcf46ff1dc138122580b4364f0fe99e6b068bc6a3d6903656aff0\n640eeb3128ae5c353034ee29cb656d38c41353743396c1c936afd4d04a782087\n6703400b490b35bcde6e41ce1640920251855e6d94171170ae7ea22cdd0938c0\n6a234a2b8eb3844f7b5831ee048f88e8a76e9d38e753cc82f61b234c79fe1660\n6a6db5febdaf3f1577bf97c6e1e24913e6c78b134062c02fd1f9875099c03a3f\n6c7f24d8ed000bc7ce842e4875b467f9de1626436e051bd351adf1f6f8bbacf8\n70b63dfc3ed2b89a4eb8a0aa6c26885f460e5686d21c9d32413df0cdc5f962c7\n79e7165e626c7bde546cd1bea4b9ec206de8bed7821479856bdb0a2adc3e3617\n7ff8fe4c220cf6416984b70a7e272006a018e5662da3cedc2a88efeb6411b4a4\n8249e9c0ac0840a36d9a5b9ff3e217198a2f533159acd4bf3d9b0132cc079870\n8e0b330a8df3076153638f5b76afc24d1083ebccc60e4d63ee0df5c11c45d58a\n\n\n-----\n\n93d99a5fbfc888c0a40a18946933121ae110229dcf206b4d17116a57e7cf4dc9\n97030f3c81906334429afebbf365a89b66804ed890cd74038815ca18823d626c\n9b55b35284346bbcdc2754e60517e1702f0286770a080ee6ff3e7eed1cab812a\n9f9315790d0b0cc5213ac9a8eff0968cccc0a6c469b50d6598ce759748fe74bf\n9f9ebd6cd9b5b33ab2780122ee9c5feec84927f362890a062d13ef9816c7b85f\na0050c33c8263da02618872d642617959b3564fe173985e078bfedb89df93724\naa97f4f98ff842b1bfd78e920fcb1dedaec3f882dd19311bba6037430868e7a7\nad2dd8a68ce22d0959f341e9269e8033b34362b34bdea50b8ee2390907f1a610\nb2cd9cca011064d03ddd8fe3521ce0e9f9d8b16f63e4ecaf03eacfef47d22dbf\nb7516dca419d087ef844c42e061a834908f34e7363577ab128094973896222c8\nb847e717215e0198cb4e863bd96390613f83eb92693171be50ca14255c5fb088\nbbc58fd69ce5fed6691dd8d2084e9b728add808ffd5ea8b42ac284b686f77d9a\nbfb4603902c6c9ff32bc36113280ee8b5687cc3ef4c0ff9fc56f2925c7f342f0\nc0e74f565237c32989cb81234f4b5ad85f9dd731c112847c0a143d771021cb99\nc2f23ad4e2f12c490cfd589764464e293d5d56c31b6b3f5081e2d677384cb2fe\nc95af9eb52111b72563875d85d593d96d7e54e19690827a052377c77cc80e06f\ncaa0d9bb7ed2d21a76b71dfc22ffaef80371de8af2a03b8103cbcec332897a88\nd0e1639e6386ef3c063bfae334fcc35cdfa85068ac1a65bb58f2463276c31ac9\nd1ac4d07ba6fe1dd988c471975e49e35b83d03a9b9d626fa524fd8300b80b14a\nd4335f4189240a3bcafa05fab01f0707cc8e3dd7a2998af734c24916d9e37ca8\nd60fdabaf5a0ab375361d2ed1a9b39832bdb8bd33466d6c43d42a48ba2ffd274\ne0afb8b937a5907fbe55a1d1cc7574e9304007ef33fa80ff3896e997a1beaf37\ne2449ccc74e745c0339850064313bdd8dc0eff17b3a4e0882184c9576ac93a89\ne8e7f2f889948fd977b5941e6897921da28c8898a9ca1379816d9f3fa9bc40ff\nedc6e32e3545f859e5b49ece1cabd13623122c1f03a2f7454a61034b3ff577ed\nee6d0d0ea24be622521ee1a4defa5d5729b99ee2217ac65701d38d05dbc0d4e6\nf1718a005232d1261894b798a60c73d971416359b70d0e545d7e7a40ed742b71\nf83c357106a7d1d055b5cb75c8414aa3219354deb16ae9ee7efe8ee4c8c670ca\nfd8a5313bf63f5013dc126620276fb4f0ef26416db48ee88cbaaca4029df1d73\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-25 - Investigating and Mitigating Malicious Drivers.pdf"
    ],
    "report_names": [
        "2021-06-25 - Investigating and Mitigating Malicious Drivers.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535817,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653779559,
    "ts_modification_date": 1653779559,
    "files": {
        "pdf": "https://archive.orkl.eu/64ea623021b2b3186254b0e000de886b91b8325d.pdf",
        "text": "https://archive.orkl.eu/64ea623021b2b3186254b0e000de886b91b8325d.txt",
        "img": "https://archive.orkl.eu/64ea623021b2b3186254b0e000de886b91b8325d.jpg"
    }
}