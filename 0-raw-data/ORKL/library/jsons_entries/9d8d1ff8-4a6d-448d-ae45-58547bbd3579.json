{
    "id": "9d8d1ff8-4a6d-448d-ae45-58547bbd3579",
    "created_at": "2022-10-25T16:48:12.387104Z",
    "updated_at": "2025-03-27T02:05:55.454819Z",
    "deleted_at": null,
    "sha1_hash": "4c2ac25935057d49fc9948c5a4785fb4d282d7c9",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-03-20T18:49:20Z",
    "file_modification_date": "2016-03-20T18:49:20Z",
    "file_size": 411432,
    "plain_text": "# PLC-Blaster: A Worm Living Solely in the PLC\n\n**Ralf Spenneberg, Maik Brüggemann, Hendrik Schwartke**\n\n1OpenSource Security Ralf Spenneberg\n\ninfo@os-s.de\n\n**_Abstract. Industrial processes are controlled by programmable logic controllers_**\n_(PLC). Many PLCs sold today are equipped with Ethernet ports and can commu-_\n_nicate using IP. Based on the Siemens SIMATIC S7-1200 we will demonstrate a_\n_worm. This worm does not require any additional PCs to proliferate. The worm_\n_lives and runs only on the PLC. The worm scans the network for new targets_\n_(PLCs), attacks these targets and replicates itself onto the found targets. The_\n_original main program running on the target is not modified. Once infected the_\n_worm on the target again starts the scan. We will analyze the impact of the worm_\n_on the target and possible mitigation techniques._\n\n## 1. Introduction\n\nIT systems are critical components in modern industrial processes. These processes would\nnot be possible without modern communication networks. Unfortunately with the adoption of modern IT systems and communication networks in industrial systems the users\nare exposed to attacks long known in the IT world. IT hacking attacks may harm industrial systems in several ways. They can cause outages and high financial losses but at the\nsame time may have negative on the health and life of their environment. The efficiency\nof these attacks has been demonstrated by Stuxnet [1]. Programmable logic controllers\nof Siemens were modified to hinder the Iran in the enrichment of fissile material. The\nworm spread amoung the PCs of the enrichment plant by exploiting vulnerabilities in the\nMicrosoft Windows operating system. The software of the PLCs was modified in such a\nway that the centrifuges used for the enrichment process were destroyed. The worm required a personal computer to spread and attacked the PLCs from the PC. This paper will\ndemonstrate a worm which spreads only among the PLCs themselves. No PC is required.\nThe worm may be introduced into the plant using a already manipulated PLC. The worm\nthen spreads to further PLCs by replicating itself and modifing the target PLCs to execute\nthe worm in addition to the already installed user program.. This paper is based on the\nSiemens SIMATIC S7-1200v3. The worm was written in Structured Text (ST), one of the\nlanguages used to develop PLC software.\n\n## 2. Related Work\n\n2015 at BlackHat USA 2015 Klick et. al. demonstrated malware running on a PLC [2].\nThey implemented a proxy using the communication features of the PLC. We are using\nthe same communication features to implement the protocol used to transfer the worm\nprogram. By using this protocol the worm may spread directly from one PLC to another\nPLC. The worm does not require any support by further systems. Instead of using the\nalready well known SIMATIC S7-300 we based our work on the new S7-1200v3. The\nprotocol used by these PLCs differs from the older models. This paper will document the\nnew protocol as well.\n\n\n-----\n\n## 3. PLC Architecture\n\nPLCs use a simple architecture. They are based on a central processing module (CPU) and\nfurther modules supporting digital inputs and outputs. The CPU executes the operating\nsystem of the PLC and runs the user program. Additionally the CPU is responsible for\nthe communication with additional devices and manages the process image.\n\nThe process image stores the state of all inputs and outputs. The user program operates\non the process image rather than on the physical inputs and outputs. The user program\nis run in cycles. The process image is refreshed by the CPU at the beginning and end of\neach cycle. The maximum limit for a cycle is the cycle time. If this limit is violated the\nPLC stops the user program and throws an exception.\n\n**Figure 1. Zyklus eines PLCs**\n\nThe user program is structered by Program Organization Units (POU). These units contain the instructions to control the PLC and thus the industrial process. Siemens SIMATIC\nS7-1200 support the following POUs:\n\n_• Organisation block (OB): Main entry into the user program_\n\n_• Data block (DB): Global memory_\n\n_• Function (FC): Function_\n\n_• Function block (FB): Function with persistent local memory_\n\nAdditionally to the userdefined POUs several functions provided by Siemens are available. This paper uses the system POUs TCON and TDISCON. Using these POUs the\nPLC may initiate and destroy TCP connections to arbitrary systems. Buffers may be send\nand received on these connections with TRCV und TSEND.\n\n\n-----\n\n## 4. Computer Worms\n\nComputer worms have been around since 1988 [3] and are a well known species of malware. Several different flavours exist but they all have the same basic structure [4]. Every worm attack can be structured in the following phases: Detection of possible targets,\nSpreading to the target, Execution on the target and a malware function. On PLCs a worm\nmust support these functions as well. This paper will demonstrate the implementation of\neach required component.\n\n## 5. Implementing a Worm on the S7 1200\n\n**5.1. Architecture**\n\nThe worm was written like any other worm software with some constraints. During the\ndevelopment the specific PLC constraints must be met. Especially the maximum cycle\nlimit needs to be kept. The worm has to interrupt its execution every few milliseconds.\nThe execution may be continued during the next cycle. To meet these requirements the\nworm was designed using a state machine. The current state is stored in a global variable.\nAt the start of each cycle the appropiate code in the worm is called. Thus the maximum\ncycle time is never violated.\n\nThe sequence of the steps are shown in figure 2. The worm starts by initiating a connection\nto a probable target. Once the connection is established the worm first checks whether the\ntarget is already infected. If no infection is detected the worm will stop the execution\nof the user program on the target to enable the transfer of its own code. The worm then\ncopies itself to the target and subsequently starts the target PLC again. The worm then\ntests the next probable target.\n\n**Figure 2. Execution sequence of the worm**\n\n\n-----\n\n**5.2. Target Detection**\n\nThe worm starts by scanning for probable targets. Siemens SIMATIC PLCs may be identified by the port 102/tcp. This port can only be closed by an external firewall. No other\ncommon service uses this port.\n\nThe S7-1200 manages TCP connections using the POU TCON. The usage of this POU\nis shown in listing 3 on line 3. An arbitrary IP address and port are passed on line 9.\nOnce the POU is called, the PLC will attempt to establish the connection. This happens\nasynchronously. In later cycles the current state of the connection can be verified. The\nreturn value DONE (Zeile 5) signals whether the connection was established. If true, the\ninfection will continue. If the IP address and port is unreachable no error is triggered. The\ntimeout needs to be implemented by the worm by incrementing a counter each cycle.\n\n1 IF \"data\".con_state = 10 THEN\n\n2\n\n3 \"TCON_DB\"(REQ:=\"data\".action,\n\n4 ID:=1,\n\n5 DONE=>\"data\".con_done,\n\n6 BUSY=>\"data\".con_busy,\n\n7 ERROR=>\"data\".con_error,\n\n8 STATUS=>\"data\".con_status,\n\n9 CONNECT:=\"data\".con_param);\n\n10\n\n11 IF \"data\".con_done = True THEN\n\n12 // connection open\n\n13 \"data\".con_state := 20;\n\n14 ELSE\n\n15 // connection not open\n\n16 \"data\".con_timeout := \"data\".con_timeout + 1;\n\n17 // connection timeout?\n\n18 IF \"data\".con_timeout > 200 THEN\n\n19 \"data\".con_state := 0;\n\n20 END_IF;\n\n21 END_IF;\n\n22\n\n23 GOTO CYCLE_END;\n\n24 END_IF;\n\n**Figure 3. Target Detection using SCL**\n\n\n-----\n\nIf no connection was established after 200 cycles the worm will continue in listing 4.\nAlthough no connection was established the POU TDISCON has to be called to free the\nresources for the next connections. In line 13 the IP adress is incremented. Thus a full /24\nsubnet is scanned for open ports 102/tcp.\n\n1 IF \"data\".con_state = 0 THEN\n\n2\n\n3 \"TDISCON_DB\"(REQ:=\"data\".action,\n\n4 ID:=1,\n\n5 DONE=>\"data\".con_done,\n\n6 BUSY=>\"data\".con_busy,\n\n7 ERROR=>\"data\".con_error,\n\n8 STATUS=>\"data\".con_status);\n\n9\n\n10 IF \"data\".con_error = True OR\n\n11 \"data\".con_done = True\n\n12 THEN\n\n13 \"data\".con_param.REM_STADDR[4] := \\\n\n14 (\"data\".con_param.REM_STADDR[4] + 1) MOD 255;\n\n15 \"data\".con_timeout := 0;\n\n16 \"data\".con_state := 10;\n\n17 END_IF;\n\n18\n\n19 GOTO CYCLE_END;\n\n20 END_IF;\n\n**Figure 4. Target detection in SCL**\n\n**5.3. Infection**\nDuring the infection phase the worm replicates itself to the target PLC. Normally software\nis transferred to the PLC using the Siemens TIA-Portal. The worm mimics the TIA-Portal\nand implements the proprietary Siemens protocol. While we analyzed the protocol on our\nown, the Wireshark plugin of Thomas Wiens can interpret the protocol as well [5].\n\n**5.3.1. Software Transfer Protocol**\n\nThe proprietary protocol will be called S7CommPlus for the rest of this paper. It is a\nbinary protocol which utilizes both TPKT [6] and ISO8073 [7]. Typically both of these\nprotocols use port 102/tcp.\n\nThe main features of S7CommPlus are:\n\n_• Configuration of the PLC_\n\n_• Starting and stopping the PLC_\n\n_• Reading and writing process variables_\n\n_• Program transfer (Up-/Download)_\n\n_• Debugging_\n\n_• Providing debugging information_\n\n_• Alerting_\n\n\n-----\n\n**5.3.2. Messages**\n\nEvery message used by S7CommPlus has a similar structure. Figure 5 presents the first\nmessage in a connection. The TIA portal sends this message to initiate a connection. The\ngeneral structure will be explained based on this message. The first two fields represent\nthe TPKT and ISO8073 protocol. Their contents is explained in the respective documentation. The following byte 0x72 represents the start of the S7CommPlus message. A\nversion number distinguishes between different variants of the protocol. The length field\ndoes not take into account the frame boundary. If the frame boundary is missing, further\ndata is following in additional messages. Following the length field the type field is transferred. The subtype further specifies the messages. The sequence number is incremented\nfor each message. Additional data is transferred in separate attribute blocks.\n\n03 00 00 e1 02 f0 80 72 01 00 d2 31 00 00 04 ca .......r ...1....\n00 00 00 02 00 00 01 20 36 00 00 01 1d 00 04 00 ....... 6.......\n00 00 00 00 a1 00 00 00 d3 82 1f 00 00 a3 81 69 ........ .......i\n00 15 16 53 65 72 76 65 72 53 65 73 73 69 6f 6e ...Serve rSession\n5f 36 42 36 31 38 32 46 31 a3 82 21 00 15 2c 31 _6B6182F 1..!..,1\n3a 3a 3a 36 2e 30 3a 3a 54 43 50 2f 49 50 20 2d :::6.0:: TCP/IP 3e 20 49 6e 74 65 6c 28 52 29 20 50 52 4f 2f 31 > Intel( R) PRO/1\n30 30 30 20 4d 54 20 44 2e 2e 2e a3 82 28 00 15 000 MT D .....(..\n00 a3 82 29 00 15 00 a3 82 2a 00 15 11 4d 41 49 ...).... .*...MAI\n4b 2d 50 43 5f 33 32 39 31 38 39 35 31 35 a3 82 K-PC_329 189515..\n2b 00 04 01 a3 82 2c 00 12 00 2d c6 c0 a3 82 2d +.....,. ..-....00 15 00 a1 00 00 00 d3 81 7f 00 00 a3 81 69 00 ........ ......i.\n15 15 53 75 62 73 63 72 69 70 74 69 6f 6e 43 6f ..Subscr iptionCo\n6e 74 61 69 6e 65 72 a2 a2 00 00 00 00 72 01 00 ntainer. .....r..\n00\n\nTPKT, ISO8073, Magic Byte, Version, Length, Type, Reserved, Subtype,\n\nSequence number,\n\nAttribute blocks, Frame boundary,\n\nUnknown\n\n**Figure 5. S7CommPlus message structure**\n\n**5.3.3. Attribute blocks**\n\nThe actual data is structured using attribute blocks. Figure 6 shows the first attribute\nblock of the preceding example. Each attribute block starts with the byte 0xA3. This\nblock contains a string. The actual string starts with its length and the value of the string.\n\n\n-----\n\na3 81 69 ........ .......i\n00 15 16 53 65 72 76 65 72 53 65 73 73 69 6f 6e ...Serve rSession\n5f 36 42 36 31 38 32 46 31 _6B6182F 1\n\nAttribute block start, Attribute ID, Format?, datatype, Length, Value,\n\n**Figure 6. Attribute block**\n\n**5.3.4. Coding numbers**\n\nWithin the attribute blocks numbers are coded in a special way. The number may have a\nvariable length. The first bit of each byte encodes whether further bytes follow. Figure 7\nexplains the decoding of the attribute id and the length field of the last example. If values\nare stored within the attribute block this encoding is not used.\n\n**Figure 7. Encoding of numbers**\n\n**5.3.5. Anti Replay Mechanism**\n\nThe S7CommPlus protocol detects replay attacks. To detect the replay attack the PLC\nsends a random byte in the 25th byte of its response message (figure 8). The value of the\nrandom byte ranges between 0x06 and 0x7f. This is the anti replay challenge.\n\nThe TIA portal needs to base the 24th and 29th byte in its response based on the challenge.\nThe anti replay byte is calculated by the following formula:\n\nantireplaybyte = challenge + 0x80\n\n03 00 00 89 02 f0 80 72 01 00 7a 32 00 00 04 ca .......r ..z2....\n00 00 00 02 36 11 02 87 22 87 3d a1 00 00 01 20 ....6... \".=....\n82 1f 00 00 a3 81 69 00 15 00 a3 82 32 00 17 00 ......i. ....2...\n00 01 3a 82 3b 00 04 82 00 82 3c 00 04 81 40 82 ..:.;... ..<...@.\n3d 00 04 84 80 c0 40 82 3e 00 04 84 80 c0 40 82 =.....@. >.....@.\n3f 00 15 1b 31 3b 36 45 53 37 20 32 31 32 2d 31 ?...1;6E S7 212-1\n42 45 33 31 2d 30 58 42 30 20 3b 56 33 2e 30 82 BE31-0XB 0 ;V3.0.\n40 00 15 05 32 3b 35 34 34 82 41 00 03 00 03 00 @...2;54 4.A.....\na2 00 00 00 00 72 01 00 00\n\nChallenge, Attribute block\n\n**Figure 8. Anti replay mechanim**\n\nAll further messages sent by the TIA portal to the S7-1200 need to use the anti replay\nbyte in their 24th byte. The grey attribute block needs to be mirrored as well.\n\n\n-----\n\n03 00 00 8c 02 f0 80 72 02 00 7d 31 00 00 05 42 .......r ..}1...B\n00 00 00 03 00 00 03 a2 34 00 00 03 a2 01 01 82 ........ 4.......\n32 01 00 17 00 00 01 3a 82 3b 00 04 82 00 82 3c 2......: .;.....<\n00 04 81 40 82 3d 00 04 00 82 3e 00 04 84 80 c0 ...@.=.. ..>.....\n40 82 3f 00 15 00 82 40 00 15 1a 31 3b 36 45 53 @.?....@ ...1;6ES\n37 20 32 31 32 2d 31 42 45 33 31 2d 30 58 42 30 7 212-1B E31-0XB0\n3b 56 33 2e 30 82 41 00 03 00 00 00 00 00 00 04 ;V3.0.A. ........\ne8 89 69 00 12 00 00 00 00 89 6a 00 13 00 89 6b ..i..... ..j....k\n00 04 00 00 00 00 00 00 72 02 00 00\n\nAnti replay byte, Attribute block\n\n**Figure 9. Anti replay Mechanism**\n\n**5.3.6. Transfer of the program**\n\nTo transfer the user program a specific message is used (Figure 10). Each message transfers one POU. The POU type distinguishes between the different POU variants. The block\nnumber specifies the place im memory on the PLC.\n\n03 00 04 00 02 f0 00 72 02 05 a9 31 00 00 04 ca .......r ...1....\n00 00 00 1d 00 00 03 a2 34 00 00 00 03 00 04 00 ........ 4.......\n00 00 00 00 a1 8a 32 00 01 94 57 20 00 a3 81 69 ......2. ..W ...i\n00 15 04 4d 61 69 6e\n...\n\nPOU type, Block number, Attribute block\n\n**Figure 10. Transferring the user program**\n\nSeveral attribute blocks follow the message header. Additionally to the actual byte code\nmeta information is stored on the S7. This meta information specifies the required memory, the creation date, block number, used language, source code and protection features.\nThe TIA portal may use this information to verify the code.\n\n**5.3.7. Determining the required messages**\n\nDuring the transfer of the user program several messages are exchanged which are not\nmandatory for the process. These irrelevant messages would increase the memory required by the worm and are therefore skipped.\n\nThe figure 11 displays the required messages for a successful infection. The communication is initiated. To avoid repeated infections the worm first tests the target and tries to\ndownload a copy of itself. The upload of additional code is only possible after halting the\nPLC. Then the program is transferred. At the end the PLC is started again.\n\n\n-----\n\n**Figure 11. Messages exchanged during infection**\n\n\n-----\n\n**5.3.8. Implementation**\n\nBased on the analysis of the protocol the transfer of a program may be recorded, modified\nand replayed to a PLC. All required messages are known. To store the messages within\nthe worm a static DB POU is used. Additional DBs are used to store temporary variables\nand the send/receive buffer.\n\nThe static DB has to store all messages required for the infection. This DB block cannot\nbe generated using the TIA portal but needs to be coded manually.\n\n**Figure 12. Manual generation of the DB**\n\n## 6. Starting the worm\n\nThe transferred code adds to the user program already running on the target PLC. An additional OB and the required DBs are added. The original code on the target is untouched.\nThe OB is automatically detected by the PLC and executed.\n\n**Figure 13. The worm is run as normal code**\n\n## 7. Malware Function\n\nWhile the worm is already functional we implemented different malware function to\ndemonstrate the possible impact.\n\n\n-----\n\n**7.1. Command & Control Server**\n\nOur worm will contact a command & control server. The communication is based on\nTCP. Different features within the worm may be triggered by the C&C server.\n\n**7.2. Socks4 Proxy**\n\nOur worm serves a Socks4 proxy. Once the worm connected to the C&C server, arbitrary\nconnections to additional clients within the network of the PLC may be initiated using the\nembedded Socks4 proxy.\n\n**7.3. Denial of Service**\n\nThe execution on the PLC can be stopped by violation the cycle time limit. The worm\nimplements an endless loop triggering an error condition within the PLC with the impact\nof a DoS.\n\n**7.4. Manipulating Outputs**\n\nThe worm may manipulate any outputs of the PLC. Using the POU POKE any value\nwithin the process image may be modified.\n\n## 8. Detection of the worm, Persistance and Resources\n\n**8.1. Detection of the worm**\n\n**8.1.1. TIA portal**\n\nThe TIA portal may verify the user program on the PLC and can detect modified and\nadded POUs (Figure 14). The red outlined area points at the POUs used by the worm.\nThe analysis of the POUs is not possible though, because the TIA portal only analyzes\nthe XML sourcecode. Additionally, by exploiting a bug in the TIA portal the worm may\ncrash the application.\n\n**8.1.2. Stopping the PLC**\n\nThe PLC is stopped during the infection for about 10 seconds. The original user program\ndoes not run during this time. This interruption may be noticed and is logged within the\nPLC.\n\n**8.1.3. Network traffic**\n\nThe worm generates unusual network traffic within an ICS environment. During the scan\nand infection phase many suspicous packets are sent.\n\n**8.2. Persistence**\n\n**8.2.1. Restart/Reboot**\n\nThe worm is stored on the PLC. It is part of the user program and will survive a Restart\nand even the removal of power.\n\n\n-----\n\n**Figure 14. TIA portal exposes the worm**\n\n**8.2.2. Factory Reset**\n\nThe TIA portal may trigger a factory reset of the PLC. All settings and the user program\nincluding the worm are cleared from the device.\n\n**8.2.3. Program transfer**\n\nOur worm is stored in OB9999. If this POU is overwritten the worm is removed from the\nPLC.\n\n**8.3. Resources**\n\n**8.3.1. Cycle time**\n\nThe maximum cycle limit is a hard quota. By default the limit is 150ms. The worm must\nnot violate this limit. We measured the cycle time of a PLC without any user program.\nThe cycle time is 0 ms. We then infected the S7 using our worm and measured again. The\nmaximum measured cycle time is 7ms. This represents 4.7% of the limit.\n\n**8.3.2. Memory**\n\nThe worm requires 38,5KB RAM for storing the worm. 9,0KB (23,3%) are needed by the\nmalware functions. Additionally 216,6KB flash is needed. Table 1 displays the available\n\n\n-----\n\nmemory of the different models.\n\n**Model** **RAM** **Flash**\nS7-1211 50KB (77%) 1MB (21%)\nS7-1212 75KB (51%) 1MB (21%)\nS7-1214 100KB (38%) 4MB (5%)\nS7-1215 125KB (30%) 4MB (5%)\nS7-1217 150KB (25%) 4MB (5%)\n\n**Table 1. Memory footprint**\n\n## 9. Protection Features\n\nThe PLC S7-1200v3 offers three different protection features. We will analyze each of\nthese features and will evaluate whether the feature will protect the PLC against the worm\ninfection. This analysis is based on TIA portal V11 SP2 Update 5 and the S7-1200 using\nfirmware 3.0.2.\n\n**9.1. Knowhow Protection**\n\nThe knowhow protection protects the user program from unauthorized access. Using a\npassword the unauthorized access and modification of a POU is prohibited.\n\nThe knowhow protection is implemented using an attribute block. This block is written on\nthe PLC during the program transfer. The block is displayed in figure 15. The flag toggles\nthe knowhow protection. The stored password hash is generated based on the password P\nusing the following formula:\n\nH = sha-1(encode_utf-16le(P))\n\nA3 93 5C 00 17 00 00 0D 77 9A 78 00 0B 00 01 9A .......w.x.....\n79 10 02 14 E8 F9 7F BA 91 04 D1 EA 50 47 94 8E y...........PG..\n6D FB 67 FA CD 9F 5B 73 00 m.g...[s.\n\nStart of the attribute block, datatype, container ID Attribute ID (container knowhow),\n\ndatatype, attribut-ID (flag) datatype, flag\n\nAttribut-ID (passwort hash) datatype, length, passwort hash,\n\n**Figure 15. Attribute block: knowhow protection**\n\nThe TIA portal evaluates the attribute block. If the flag is set the TIA portal prohibits read\nand write access to the corresponding program block without the correct password. The\npassword is checked using the hash.\n\nThe XML source code on PLC is encrypted using AES128-CBC. This prevents access to\nthe code. Figure 16 shows the encrypted source code.\n\n**9.1.1. Vulnerabilities**\n\n**Missing integrity protection**\nThe block may be read and modified despite the knowhow protection. The protection is\n\n\n-----\n\n<NetworkContainer>\n<Network Lang=\"SCL\" ProgrammingContext=\"Plain\"\nMnemonic=\"International\" RefID=\"1\">\n<EncryptedData Type=\"http://www.w3.org/2001/04/xmlenc#Element\"\nxmlns=\"http://www.w3.org/2001/04/xmlenc#\">\n<EncryptionMethod\nAlgorithm=\"http://www.w3.org/2001/04/xmlenc#aes128-cbc\" />\n<CipherData>\n<CipherValue>\nAQIDAQIDAQIDAQIDAQIDAS/acA/s+L3CoQYaeAQMOq ...\n</CipherValue>\n</CipherData>\n</EncryptedData>\n...\n\n**Figure 16. Encrypted source code**\n\nimplemented within the TIA portal and not within the PLC. Using self-written tools to\nread and write blocks on the PLC any access is granted. Even the knowhow protection\nflag may be reset resulting in full access using the TIA portal.\n\n**AES-key may be derived**\nThe key for the AES encryption may be derived from the password hash. The password\nhash may be read using self-written software. The key is calculated using the following\nformula:\n\nK = truncate128Bit(H) XOR M\n\nwith M :\n\nM = 0x28,0x6f,0x76,0x5c,0x6e,0x3b,0x1e,0x4c,\n0xd0,0x8e,0x42,0x31,0x43,0x7b,0x8e,0xbf\n\nFixed by the vendor in SSA-833048[1].\n\n**9.1.2. Evaluation of the protection in the context of the worm**\n\nThis feature does not protect against the worm attack.\n\n**9.2. Copy protection**\n\nThe copy protection prohibits the duplication of the user program to a second PLC. The\nserial number of the target PLC is stored within the user program preventing the TIA\nportal from transferring the user program to additional PLCs. The serial number is stored\nin a separate attribute block.\n\n1http://www.siemens.com/cert/pool/cert/siemens_security_advisory_\nssa-833048.pdf\n\n\n-----\n\n**9.2.1. Vulnerabilities**\n\n**Missing integrity protection**\nThe integrity of the attribute block is not protected. The stored serial number may be\nmodified or removed. The PLC does not check the serial number itself. The protection is\nonly implemented within the TIA portal.\n\nFixed by the vendor in SSA-833048[2].\n\n**9.2.2. Evaluation of the protection in the context of the worm**\n\nThis feature does not protect against the worm attack.\n\n**9.3. Access protection**\n\nThe access protection prevents access to the PLC using the S7CommPlus protocol without\na password. Three different protection levels are available. Table 2 lists the different\nlevels.\n\n**Function** **None** **Write** **Read/Write**\nStart/Stop CPU yes no no\nWrite Program yes no no\nRead Program yes yes no\nManipulate memory/output yes yes yes\nRead identification yes yes yes\nSetting IP address yes yes yes\nSetting date yes no no\nFactory reset yes no no\n\n**Table 2. Access based on the protection level**\n\nThe authenticaton uses a challenge response mechanism [8].\n\n**9.3.1. Evaluation of the protection in the context of the worm**\n\nThe access protection can protect the PLC against the worm attack. The write protection\nprevents anybody from modifying the code on the PLC. The used challenge response\nauthentication is probably secure. If the used password is not known to the worm the\nworm may not infect the PLC. By default the access protection ist turned off.\n\n## 10. Conclusion\n\nIn this paper we demonstrate the feasibility of a PLC worm. Such a worm represents a\nnew threat to industrial networks. Traditionally such networks are well protected against\nattacks from the outside. By introducing a PLC already infected with the worm the PLC\nis the origin of the attack and not just the target. Infected PLCs may be distributed by\n\n2http://www.siemens.com/cert/pool/cert/siemens_security_advisory_\nssa-833048.pdf\n\n\n-----\n\na supplier of an industrial component or during the transport of such a component. The\nworm may then spread internally and does not require any standard PCs or servers. It will\ntherefore not be detected by any antivirus product. Furthermore the plant operator has\nvery few options to detect the malware on the PLCs.\n\n## References\n\n[1] Eric Chien Nicolas Falliere, Liam O Murchu. W32.Stuxnet Dossier. Last accessed\nhttps://www.symantec.com/content/en/us/enterprise/media/\nsecurity_response/whitepapers/w32_stuxnet_dossier.pdf on\n06.02.2016, 2011.\n\n[2] Johannes Klick u.a. Internet-facing PLCs - A New Back Orifice.\nhttps://www.blackhat.com/docs/us-15/materials/\nus-15-Klick-Internet-Facing-PLCs-A-New-Back-Orifice-wp.\npdf, 2015.\n\n[3] pressetext.deutschland. Malware-Jubiläum: 20 Jahre Internet-Würmer. http://www.\npressetext.com/news/20081101001, 2008.\n\n[4] Nicholas Weaver u.a. A Taxonomy of Computer Worms. https://www1.icsi.\nberkeley.edu/~nweaver/papers/2003-taxonomy.pdf, 2003.\n\n[5] thomas_v2. S7comm Wireshark dissector plugin. http://sourceforge.net/\nprojects/s7commwireshark/files/.\n\n[6] Dwight E. Cass Marshall T. Rose. ISO Transport Service on top of the TCP. Last accessed\nhttps://tools.ietf.org/html/rfc1006 on 21.02.2016, 1987.\n\n[7] International Organization for Standardization. Connection oriented transport protocol.\n_ISO Std. 8073, 1988._\n\n[8] SCADAStrangeLove. S4x13 Releases: S7 password offline bruteforce tool. http:\n//scadastrangelove.blogspot.de/2013/01/s7brut.html, 2013.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.blackhat.com/docs/asia-16/materials/asia-16-Spenneberg-PLC-Blaster-A-Worm-Living-Solely-In-The-PLC-wp.pdf"
    ],
    "report_names": [
        "asia-16-Spenneberg-PLC-Blaster-A-Worm-Living-Solely-In-The-PLC-wp.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1458499760,
    "ts_modification_date": 1458499760,
    "files": {
        "pdf": "https://archive.orkl.eu/4c2ac25935057d49fc9948c5a4785fb4d282d7c9.pdf",
        "text": "https://archive.orkl.eu/4c2ac25935057d49fc9948c5a4785fb4d282d7c9.txt",
        "img": "https://archive.orkl.eu/4c2ac25935057d49fc9948c5a4785fb4d282d7c9.jpg"
    }
}