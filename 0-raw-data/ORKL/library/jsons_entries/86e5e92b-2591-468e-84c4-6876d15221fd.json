{
    "id": "86e5e92b-2591-468e-84c4-6876d15221fd",
    "created_at": "2023-01-12T15:02:28.264248Z",
    "updated_at": "2025-03-27T02:06:06.659122Z",
    "deleted_at": null,
    "sha1_hash": "99af09b37b7fe05e58e2caa009ec075dac55a386",
    "title": "2022-11-17 - Reconstructing the last activities of Royal Ransomware",
    "authors": "",
    "file_creation_date": "2022-11-28T19:06:35Z",
    "file_modification_date": "2022-11-28T19:06:35Z",
    "file_size": 1513476,
    "plain_text": "# Reconstructing the last activities of Royal Ransomware\n\n**yoroi.company/research/reconstructing-the-last-activities-of-royal-ransomware/**\n\n11/17/2022\n\n## Introduction\n\n\nNovember 17, 2022\n\n\n[Royal Ransomware is a new group first spotted on Bleeping Computer last September, where the cybersecurity news site revealed](https://www.bleepingcomputer.com/news/security/new-royal-ransomware-emerges-in-multi-million-dollar-attacks/)\na connection with another malware known as Zeon.\n\nAt the moment, we don’t have much information about the group and all its actual TTPs, but we know that they use the Double\nExtortion model to threaten the victims, as stated inside the ransom note.\n\nFigure 1: Ransom Note\n\n## About Royal Ransomware Group\n\nThe Cyber intelligence community has proof that the group started its malicious activities since January, with other ransomware\npayloads. So, we can say they started their malicious career as affiliated with other Ransomware-as-a-Service providers. But it\nonly the last two months, it started to apply the Double Extorsion model, with an ad-hoc website in the Dark Web.\n\n\n-----\n\nFigure 2: Royal Ransomware main page\nDuring its existence, it seems that the ransomware group didn’t adopt the Ransomware-as-a-Service model to recruit other\naffiliates to infect victims. The reason might be that the core team wants initially to create a malicious “brand positioning” inside the\nthreat landscape.\n\nFigure 3:\n\nDistribution of the Attacks\nAt the same time, we don’t know which toolkit is used to implement the exfiltration capability. We don’t know if the group uses\nsome custom malware, or if it leverages public storage platforms, such as Mega, Dropbox, etc.\n\n## Technical Analysis\n\n\n-----\n\nWe managed to obtain a recent specimen of this threat and analyzed its features and malicious capabilities, in order to create\nsignatures and provide technical insight to better detection.\n\nTha analyzed sample has the following static information:\n\nHash 9db958bc5b4a21340ceeeb8c36873aa6bd02a460e688de56ccbba945384b1926\n\nThreat Royal Ransomware\n\n\nBrief\nDescription\n\n\nRansomware payload\n\n\nSSDEEP 49152:cDVwASOLGtlqrRIU6i9+vazNqQlJZP1BMU2thA8mNtNCiJlrRUFcJ7HIPcLzk+5c:wm+GaNqqJJ12vlZol8cJ7rcl\n\nFigure 4: Static\n\nInformation about the sample\nRoyal Ransomware is written in C/C++ and it is launched by command line. That behavior suggests that there is a previous and\ntotally human-operated intrusion performed by a pen-testing team, which gained access to the internal network and performed\nprivilege escalation and lateral movement operation.\n\nWhen the executable is launched, it needs three parameters, otherwise the infection doesn't start:\n\n\n-----\n\nFigure 5: Parameters needed by Royal\n\nRansomware\nWe constructed a table with the three parameters found inside the sample and we provide a small description of that:\n\nParameter Description\n\n-path Specifies an exact path where to encrypt files\n\n-id Victim’s ID, needed to run the sample, must be 32 characters\n\n-ep Encryption percentage (feature not implemented in this sample)\n\nTable: Parameters description\nAfter that, the sample starts the preparation of the ransomware operation by deleting the shadow copies:\n\n\n-----\n\nFigure 6: Deleting\n\nShadow Copies\nThen, the malware starts the preparation for the encryption processes, by creating the lists of the elements to be excluded during\nthe fetching of files and folders. For the files’ extensions, the exclusions are:\n```\n.exe,.dll,.bat,.lnk,.royal,\n\n```\nFigure 7: Checking file extension\n\nInstead, for the folders exclusion there are the following:\n```\nwindows, royal, $recycle.bin, google, perflogs, mozilla, tor browser, boot, $windows.~ws, $windows.~bt, windows.old\n\n```\nFigure 8: Checking folder name\n\nRoyal Ransomware has also the capability to infect and encrypt the shared resources inside the internal network. It uses the\nNetShareEnum seeking the “ADMIN$” and “IPC$” records and then, it proceeds to encrypt the files contained inside the shared\nfolders\n\n\n-----\n\nFigure 9: Network shares encryption\n\nAt this point, we have the encryption phase. Royal Group uses a mixture of RSA and AES algorithms. The RSA public Key is\nhardcoded in the sample, and it is easy to retrieve that:\n\nFigure 10: Public RSA Key\n\nIn the following scheme, we highlight the encryption routine and the result of the encryption of a test file:\n\n\n-----\n\nFigure 11: Encryption routine\nThe encryption routine is assisted by the OpenSSL library. An AES key is randomly generated and then it is protected with the\nRSA public key. In this way, the ransomware operator the encryption conserves the RSA private key to decrypt the original AES\nkey and then the files could be restored.\n\n## Conclusion\n\nThe market of cyber extorsion is still growing and other threat actors are riding the wave of the most infamous 2022 trend. The\ncase Royal Ransomware Group is representative because it started by adopting the affiliation on the RaaS market, and when they\nreached an appropriate expertise and experience, it created an independent group with a “proprietary” ransomware payload.\n\nAs stated, at the moment we have no proof they adopt the Ransomware-as-a-Service model, but the group is formed only by\ntalented pen-testers and malware developers aimed at making money through the Double Extorsion model. However, this doesn't\nmean that in the near future the group will reach such a maturity that they will be capable of implementing the RaaS model.\n\n## Indicators of Compromise\n\n9db958bc5b4a21340ceeeb8c36873aa6bd02a460e688de56ccbba945384b1926\nc24c59c8f4e7a581a5d45ee181151ec0a3f0b59af987eacf9b363577087c9746\n5fda381a9884f7be2d57b8a290f389578a9d2f63e2ecb98bd773248a7eb99fa2\n312f34ee8c7b2199a3e78b4a52bd87700cc8f3aa01aa641e5d899501cb720775\n491c2b32095174b9de2fd799732a6f84878c2e23b9bb560cd3155cbdc65e2b80\n2598e8adb87976abe48f0eba4bbb9a7cb69439e0c133b21aee3845dfccf3fb8f\nf484f919ba6e36ff33e4fb391b8859a94d89c172a465964f99d6113b55ced429\n7cbfea0bff4b373a175327d6cc395f6c176dab1cedf9075e7130508bec4d5393\n\n## Yara Rules\n\n\n-----\n\n```\nmeta:\n\n  author = \"Yoroi Malware ZLab\"\n\n  description = \"Rule for Royal Ransomware\"\n\n  last_updated = \"2022-11-09\"\n\n  tlp = \"WHITE\"\n\n  category = \"informational\"\n\nstrings:\n\n  // x32\n\n  $1 = {8d 84 ?? ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 83 f8 20 74 ?? 6a 00 ff 15 ?? ?? ?? ??}\n\n  $2 = {68 ?? ?? ?? ?? ff 30 89 44 ?4 20 ff 15 ?? ?? ?? ?? 85 c0 75 ?? 8b 44 ?4 10 46 8b 0c b0 89 4c ?4 1c e9 ?? ?? ??\n?? 8b 44 ?4 18 68 ?? ?? ?? ?? ff 30 ff 15 ?? ?? ?? ??}\n\n  // x64\n\n  $3 = {4? 8d ?? ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 83 f8 20 74 ?? 33 c9 ff 15 ?? ?? ?? ??}\n\n  $4 = { 4? 8d 15 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 85 c0 75 ?? 4? 8b 7b 08 ff c6 4? 83 c3 08 e9 ?? ?? ?? ?? 4? 8b 0b 4? 8d\n15 ?? ?? ?? ?? ff 15 ?? ?? ?? ??}\n\ncondition:\n\n  (($1 and $2) or ($3 and $4)) and uint16(0) == 0x5A4D\n\n}\n\n```\n_This blog post was authored by Luigi Martire, Carmelo Ragusa of Yoroi Malware ZLAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-17 - Reconstructing the last activities of Royal Ransomware.pdf"
    ],
    "report_names": [
        "2022-11-17 - Reconstructing the last activities of Royal Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535748,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1669662395,
    "ts_modification_date": 1669662395,
    "files": {
        "pdf": "https://archive.orkl.eu/99af09b37b7fe05e58e2caa009ec075dac55a386.pdf",
        "text": "https://archive.orkl.eu/99af09b37b7fe05e58e2caa009ec075dac55a386.txt",
        "img": "https://archive.orkl.eu/99af09b37b7fe05e58e2caa009ec075dac55a386.jpg"
    }
}