{
    "id": "df009d47-cf30-441f-a562-5272b3a49d8a",
    "created_at": "2023-01-12T15:05:51.497745Z",
    "updated_at": "2025-03-27T02:06:07.118689Z",
    "deleted_at": null,
    "sha1_hash": "fba8e83fbd50a1b513869fe467b660dcca6475e3",
    "title": "2021-02-17 - Detect and prevent the SolarWinds build-time code injection attack",
    "authors": "",
    "file_creation_date": "2022-05-28T15:12:14Z",
    "file_modification_date": "2022-05-28T15:12:14Z",
    "file_size": 2824900,
    "plain_text": "# Detect and prevent the SolarWinds build-time code injection attack\n\n**[blog.apiiro.com/detect-and-prevent-the-solarwinds-build-time-code-injection-attack](https://blog.apiiro.com/detect-and-prevent-the-solarwinds-build-time-code-injection-attack)**\n\nFebruary 17, 2021\n\n[Go back](https://apiiro.com/blog/)\n\nFebruary 17 2021 | 3 min read\n\nTechnical | February 17 2021 | 3 min read\n\nWe have developed a patent-pending technology to detect and prevent SolarWinds-style\nattacks before shipping binaries to production, in both on-prem and cloud environments.\n\nIn order to understand how this new capability works technically, let’s briefly examine how\nthe attack was executed and why it went unnoticed for so long.\n\n## THE MOTIVATION\n\n\n-----\n\nIn late 2020, a complex supply chain attack against SolarWinds made headlines globally.\nMalicious code that implemented a back door was injected into the source code during the\nbuild process, exposing every SolarWinds customer to a significant threat. Although supply\nchain attacks are a known concept, this is the first disclosed detection of one at such\ncomplexity and vast scale.\n\nInternal and external investigations of the scenario discovered that malware was running on\nthe SolarWinds Orion IT management build environment and waiting for msbuild.exe (the C#\ncompiler) to run. When a build process started, the malware verified that the build target was\n_SolarWinds.Orion.Core.BusinessLayer.dll. If so, it immediately replaced the staged C# files_\nwith a version containing the back door’s code before compilation, resulting in malicious\ncode inside. This dll was later digitally-signed, which resulted in the file avoiding significant\n_scrutiny._\n\nOnce the build environment is penetrated, there are countless methods to influence the\nresulting product. While the pipeline’s input is readable (and testable) code, its output is\n**a digitally-signed binary. Comparing them in order to identify a build-level attack**\n**wasn’t possible … until now.**\n\n## THE CHALLENGE\n\nTaking binary code and restoring it to its original source code is a practically impossible task.\nCompilation is a complex, non-reversible action. A compiled binary is packed with\ninformation, optimizations, and metadata that are continuously changing. Even if you take\nthe same source code and compile it again a minute later, the binaries won’t be identical.\n\nIn addition to the non-readable binary challenge, the variety of CI/CD tools and\napproaches is extremely broad. These tools are used differently by every team (where each\napproach handles dependencies, common code, and additional resources in a unique way).\nAdd to this the fact that the CI/CD pipeline is designed to be invisible to its users and is\nalmost never inspected and you get a huge DevSecOps blind spot\n\n**We think about this from a totally different perspective**\n\n## THE SOLUTION\n\nWith a deep understanding of the source code, it is possible to determine whether or not it\nmatches the relevant binary file (based on patent-pending technology). By the time the build\nprocess starts, Apiiro will have already learned the source code and developer experience\nusing its risk-based AI engine. Once the Apiiro platform knows all the code components,\nsecurity controls, logical flows, data types, and their relations, the next phase is to analyze\nthe binary.\n\n\n-----\n\nLet s take a .NET binary, for example. The Apiiro platform will parse and perform the\nfollowing actions on the executable files:\n\nLearn all possible logic flows and symbols\nClean out all auto-generated compiler logic\nAdjust expected differences between runtime versions\nAnd more…\n\nWith the normalized entity relations from the binary, Apiiro runs graph comparison algorithms\nagainst the same data it learned from the source code.\n\nApiiro’s algorithm is also aware of all possible legitimate code changes during compilation\n(AOP frameworks, optimizations, etc.) and is able to distinguish only inserted malicious\n**functionality, be it a small configuration change or full back door code.**\n\nTo protect your organization from the next supply-chain attack, do not allow your vendors to\ndeploy or upgrade their products without:\n\nPerforming the above comparison for every compiled binary to detect source code\nmanipulation\nValidate included dependencies, external (using a digital signature) and internal (using\ncontextual knowledge of all the organization’s repositories)\nCompare additional resource files, if present, to their counterparts from the source\ncommit, taking into account potential build-time templating processes\n\nThese steps will be done simply by uploading the built binaries to the Apiiro platform using a\ndedicated API that can easily be integrated into every CI/CD pipeline and read-only access\nto the source control manager.\n\n**When Apiiro performs this process at the end of every build, you get end-to-end**\n**validation that no unwanted code is injected into your product before shipping to**\n**customers**\n\nAriel Levy\n\nSenior Software Engineer\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-17 - Detect and prevent the SolarWinds build-time code injection attack.pdf"
    ],
    "report_names": [
        "2021-02-17 - Detect and prevent the SolarWinds build-time code injection attack.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535951,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653750734,
    "ts_modification_date": 1653750734,
    "files": {
        "pdf": "https://archive.orkl.eu/fba8e83fbd50a1b513869fe467b660dcca6475e3.pdf",
        "text": "https://archive.orkl.eu/fba8e83fbd50a1b513869fe467b660dcca6475e3.txt",
        "img": "https://archive.orkl.eu/fba8e83fbd50a1b513869fe467b660dcca6475e3.jpg"
    }
}