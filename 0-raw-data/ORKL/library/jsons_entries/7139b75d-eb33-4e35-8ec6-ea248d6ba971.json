{
    "id": "7139b75d-eb33-4e35-8ec6-ea248d6ba971",
    "created_at": "2023-01-12T15:08:03.019672Z",
    "updated_at": "2025-03-27T02:09:07.357956Z",
    "deleted_at": null,
    "sha1_hash": "16d43436703c27d12cc6e4a50668bb9e6d645c26",
    "title": "2021-09-07 - Threat Alert- Mirai-Gafgyt Fork with New DDoS Modules Discovered",
    "authors": "",
    "file_creation_date": "2022-05-29T10:50:29Z",
    "file_modification_date": "2022-05-29T10:50:29Z",
    "file_size": 1348491,
    "plain_text": "# Threat Alert: Mirai/Gafgyt Fork with New DDoS Modules Discovered\n\n**[cujo.com/mirai-gafgyt-with-new-ddos-modules-discovered/](https://cujo.com/mirai-gafgyt-with-new-ddos-modules-discovered/)**\n\nSeptember 7, 2021\n\n\n-----\n\nAll posts\nSeptember 7, 2021\n\nOn the 27 of August, we have found evidence that an IoT device in one of our customerth\nenvironments had accessed a malicious software sample. We have investigated the sample\nand discovered that a Gafgyt fork has been updated and it is now being distributed with two\n**new Distributed Denial of Service (DDoS) modules to launch attacks against targeted**\nmachines.\n\nMirai and Gafgyt have been the go-to IoT malware for many years now in cybercrime circles:\ntheir versions have successfully infected millions of vulnerable IoT devices over the years.\nSince their source code have been released publicly, many threat actors use the Mirai or\n\n\n-----\n\nGafgyt code as a malware-skeleton and then retrofit it with their unique improvements,\ncreating their own special version of the botnet.\n\nIn this short threat alert, we will detail the most important findings related to this new\nmalicious campaign.\n\n## Overview of the New Mirai/Gafgyt Fork\n\nTwo interesting entries in our logs started the investigation. Previously, we have not\nobserved the name “Korpze” as a campaign tag. The set of numbers at the end of the\nfilename suggests a random keyboard typing with a reference to the l33t internet-slang with\n“1337”.\n```\n   Date: 27-08-2021 16:31 UTC\n   URL: http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]sparc\n   Date: 27-08-2021 15:47 UTC\n   URL: http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]mpsl\n\n## Technical Details\n\n```\nAll of the investigated malware samples had retained their debug information and symbols,\ntheir binaries had not been stripped, which is, as we have observed, standard with these\ncampaigns, as malware operators do not pay much attention to operational security.\n\nLack of stripping usually observed in immature campaigns\n\n## Origins of the New Botnet\n\nThere are two references in the binary to YakuzaBotnet and Scarface, the developer of a\nMirai variant:\n\n_YakuzaBotnet_\n\n_Scarface1337Self Rep Fucking NeTiS and Thisity 0n Ur FuCkInG FoReHeAd We BiG_\n_L33T HaxErS_\n\nIt suggests that the base of this variant was most likely taken from Yakuza botnet, a Mirai\nvariant leaked to the public:\n\n\n-----\n\n[https://github.com/m1lw0rm/Yakuza](https://github.com/m1lw0rm/Yakuza)\n\n## How the Botnet Gains an Initial Foothold\n\nThe function telnet_scanner_init is in charge of setting the initial foothold in vulnerable\ndevices. It scans randomly generated IPs and tries to log in with a list of pre-defined,\nhardcoded credentials on port 23 (Telnet).\n\nThese leaked credentials are the default credentials of many poorly secured IoT devices.\n**Users are strongly advised to change these passwords once they purchase the**\n**following appliances:**\n\n**Username** **Password** **Related appliance**\n\nadmin admin –\n\nadmin smcadmin SMC routers\n\ndefault default –\n\nftp ftp –\n\nguest 12345 –\n\nguest guest –\n\nmg3500 merlin Camtron IP cameras\n\nroot calvin Dell DRAC/iLO\n\nroot cat1029 HiSilicon IP cameras/DVRs/NVRs\n\nroot gm8182 Grain Media DVR\n\nroot hi3518 HiSilicon IP cameras/DVRs/NVRs\n\nroot icatch99 Lilin DVR\n\nroot pon521 GPON module DFP-34G-2C2\n\nroot root –\n\nroot root621 SNR-ONU-EPON-1G\n\nroot xc3511 VTA-83170 DVR\n\nroot xmhdipc HiSilicon IP cameras/DVRs/NVRs\n\nroot vizxv Dahua IP cameras\n\n\n-----\n\ntelnetadmin telnetadmin –\n\n## Important Functions in this Mirai/Gafgyt Fork\n\nThe following table lists all attack modules that were present in the investigated sample.\nBesides the Telnet dictionary attack module, it uses many different DoS modules. Most of\nthese have already been investigated by other researchers, but the last two modules are\nquite new:\n\n\n**Function**\n**entry**\n\n\n**Function name** **Description**\n\n\n080490fe sendCNC CNC Botnet flood, resource starvation\nattack\n\n0804b096 sendDOMINATE DoS attack with random gibberish data\n\n0804b804 sendJUNK Send junk data as DoS attack\n\n0804b488 sendHTTP HTTP DoS server resource exhaustion\nattack\n\n0804b5c3 sendHTTPCloudflare Attacking a site protected by Cloudflare\n\n080491a0 sendSTD DoS attack with random strings\n\n08049861 sendSTDHEX DoS attack with random hexadecimal\nbytes\n\n08049e39 sendTCP TCP DoS attack with random TCP\npacket parameters\n\n0804939d vseattack1 DoS attack against servers running\nValve’s Source Engine\n\n08049310 makevsepacket1 DoS attack against servers running\nValve’s Source Engine\n\n080508d4 telnet_scanner_init Telnet scanner attacks random IPs with\nhardcoded creds\n\n0804fe00 add_auth Wrapper for adding credentials to the\nauth function\n\n0804fedd init_auth Initializing hardcoded credentials\n\n0804b6fb UDPBYPASS UDP DoS flood with hardcoded hex\nbytes\n\n0804a7bf UDPRAW UDP DoS flood with raw copied bytes\n\n\n-----\n\n0804aa43 ovhl7 HTTP DDoS attack on OVH servers\nwith a specific payload\n\n0804c384 **attacks_vector_openvpn_swak** New\n\n0804bdd0 **attacks_vector_wabba_jack** New\n\n## Attacks_vector modules\n\nThis is the first time these modules have been observed in Gafgyt variants. The name of the\nfirst one suggests a module to DoS OpenVPN servers. The name choice for the second one\nis curious, as it is the name of a famous modding tool for PC games like Skyrim.\n\nHowever, the two functions work similarly by building the UDP header via\n**build_udp_header and then connecting to the target via socket_connect_raw_udp, and**\nlaunching the UDP flood.\n\nUDP Flood initialized in openvpn_swak function\n\nThe wabbajack function uses socket_connect_icmp to launch an ICMP flood at the target.\n\nICMP Flood initiated in wabba_jack function\n\n## Similar Naming to PBot Modules\n\n\n-----\n\nRecently, [CN-CERT has released an article on a new, emerging P2P botnet called PBot.](https://www.cert.org.cn/publish/main/11/2021/20210628133948926376206/20210628133948926376206_.html)\nPBot consists of 6 interesting DDoS modules that have similar goals to the two DDoS\nmodules we have observed in the Korpze campaign.\n\nattacks_vector_game_killer\nattacks_vector_nfo_v6\nattacks_vector_plainudp\nattacks_vector_plaintcp\nattacks_vector_l7_ghp\nattacks_vector_ovh_l7\n\nInterestingly, neither PBot, nor the Korpze variant uses each other’s DDoS modules, but their\nnaming convention is the same. Most likely these DDoS modules are now disseminated in\ncybercrime forums, and it is up to the malware developers, which ones they include in their\nown campaigns.\n\nThe less likely assumption is that PBot and this Korpze campaign are related as they share\nDDoS modules from the same attack corpus, but we cannot really attribute based on a poor\nstring match.\n\n## Updating nameservers\n\nThere is a specific function called UpdateNameSrvs to change nameservers on the infected\ndevice. The function is responsible for writing the file /etc/resolv.conf with Google’s DNS\nservers.\n```\n   void UpdateNameSrvs() {\n   uint16_t fhandler = open(\"/etc/resolv.conf\", O_WRONLY | O_TRUNC);\n   if (access(\"/etc/resolv.conf\", F_OK) != -1) {\n   const char* resd = \"nameserver 8.8.8.8\\nnameserver 8.8.4.4\\n\";\n   size_t resl = strlen(resd);\n   write(fhandler, resd, resl);\n   } else { return; }\n   close(fhandler);\n   }\n\n```\nThis is most likely to aid malware operators: the developer likely wanted to circumvent any\nDNS servers that block malicious IPs from reaching users, as Google’s 8.8.8.8 DNS does no\nblock malicious IPs:\n\n“Google Public DNS rarely performs blocking or filtering, though it may if we believe\nthis is necessary to protect our users from security threats.”\n\n_https://developers.google.com/speed/public-dns/docs/intro_\n\n## User-Agents Used in HTTP DoS Attacks\n\n\n-----\n\nThere are 60 hardcoded User-Agents included in the sample, which are used in the DoS\nmodule ovhl7, SendHTTP, and SendHTTPCloudflare. Once the DoS module is launched at\na target, the function randomly chooses a User-Agents to attack with.\n\nSendHTTPCloudflare DoS module uses randomized User-Agents\n\nThis mechanism is in place for evading security countermeasures: victims cannot simply\nblock the attack by denying a single specific User-Agent.\n\nHere’s a small excerpt of User-Agents used:\n\nFAST-WebCrawler/3.6 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)\nTheSuBot/0.2 (www.thesubot.de)\nOpera/9.80 (X11; Linux i686; Ubuntu/14.10) Presto/2.12.388 Version/12.16\nBillyBobBot/1.0 (+http://www.billybobbot.com/crawler/)\nFAST-WebCrawler/3.7 (atw-crawler at fast dot no; http://fast.no/support/crawler.asp)\nzspider/0.9-dev http://feedback.redkolibri.com/\n…\n\n## New Campaigns Appearing\n\nJust as we were investigating the Command-and-Control server, we have observed a new\n**campaign being switched on and all malicious binaries being exchanged with a new set of**\nbinaries for various architectures.\n\n\n-----\n\n-----\n\nA new campaign just launched with a new set of malicious binaries\n\nThis new campaign goes by the tag-name daddyl33t as it is revealed by its supposed\ncreator.\n\nDaddyl33t, the creator\n\nThe campaigns are short lived for many reasons:\n\nThe campaign operator might want to hold on to the surprise element as long as\npossible: traditional antivirus engines do not usually detect the samples on release, as\nthey need some time to build up detection.\nA compromised Command-and-Control server could be under siege from many\ndifferent threat actors: as they fight to keep their own ground, new players could come\nin by exploiting vulnerable servers and overwrite the malicious binaries with their own\ncampaign, distributing a different set of binaries from that point on.\nAlso, as new source codes are released on cybercrime or other underground forums,\ncampaign operators adjust and update their malicious tools whenever there is a better\nmalware version with more or better features.\n\n\n-----\n\nCreating a flavor of Mirai/Gafgyt has never been so easy. The leaked source codes of\nMirai and Gafgyt/QBot are all over GitHub and other repositories, and implementing\nnew functions, removing unnecessary features, and adjusting malicious tools with\nrecent exploits (as new vulnerabilities are discovered) is widely practiced by script_kiddies._\n\n## Coverage\n\nThe malicious IPs and URLs related to the Korpze campaign are blocked by CUJO AI\nSentry.\n\n## Indicators of Compromise\n\n### SHA256\n\n_2be9013823dbcb7dd4cbed30e37ffd51ac9b3a0f78d168879c6a59ff1b2704d8_\n\n_009f8f752458e6bbd340ca3cd34f5ebc520b2846fdbb5339add824d31f195413_\n\n### Campaign name\n\n_“Korpze1233121337”_\n\n### IP\n\n_103[.]161[.]17[.]233 – ASN 135967 – Vietnam_\n\n### C2\n\n_103[.]161[.]17[.]233:1227_\n\n_103[.]161[.]17[.]233:1228_\n\n_103[.]161[.]17[.]233:1229_\n\n### URL\n\n\n-----\n\n_http://103[.]161[.]17[.]233/bins[.]sh_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]arm_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]arm4_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]arm5_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]arm6_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]m68k_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]mips_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]x86_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]ppc_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]sparc_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]i586_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]i686_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]mpsl_\n\n_http://103[.]161[.]17[.]233/Korpze1233121337[.]sh4_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]arm_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]arm4_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]arm5_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]arm6_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]m68k_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]mips_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]x86_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]ppc_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]sparc_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]i586_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]i686_\n\n\n-----\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]mpsl_\n\n_http://103[.]161[.]17[.]233/bins/Korpze1233121337[.]sh4_\n\n### Albert Zsigovits\n\nMalware Researcher\n\n### CUJO AI Lens\n\nAn AI-powered analytics solution that, for the first time, gives operators an aggregated,\ndynamic and near real-time view into the way end users utilize their home or business\nnetworks\n\n[Learn more](https://cujo.com/lens/)\n\n### Explorer\n\nProvides complete, programmatic access to granular data via APIs to all the information\ncollected and processed by the CUJO AI Platform\n\n[Learn more](https://cujo.com/explorer/)\n\n\n-----\n\n### Compass\n\nAn advanced service that empowers families and businesses to define and manage how\ntheir members’ online activity affects their everyday lives\n\n[Learn more](https://cujo.com/compass/)\n\n### Other posts by Albert Zsigovits\n\n[All posts by Albert Zsigovits](https://cujo.com/author/albert-z/)\n\n**Privacy Overview**\n\nThis website uses cookies to improve your experience while you navigate through the\nwebsite. Out of these, the cookies that are categorized as necessary are stored on your\nbrowser as they are essential for the working of basic functionalities of the website. We also\nuse third-party cookies that help us analyze and understand how you use this website.\nThese cookies will be stored in your browser only with your consent. You also have the\noption to opt-out of these cookies. But opting out of some of these cookies may affect your\nbrowsing experience.\n\nNecessary cookies are absolutely essential for the website to function properly. These\ncookies ensure basic functionalities and security features of the website, anonymously.\n\n**Cookie** **Duration** **Description**\n\n\n_GRECAPTCHA 5 months\n27 days\n\n\nThis cookie is set by the Google recaptcha service to\nidentify bots to protect the website against malicious\nspam attacks.\n\n\ncookielawinfocheckboxadvertisement\n\ncookielawinfocheckbox-analytics\n\ncookielawinfocheckbox-analytics\n\n\n1 year Set by the GDPR Cookie Consent plugin, this cookie is\nused to record the user consent for the cookies in the\n\"Advertisement\" category .\n\n\n11\nmonths\n\n11\nmonths\n\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Analytics\".\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Analytics\".\n\n\n-----\n\n**Cookie** **Duration** **Description**\n\n\ncookielawinfocheckbox-functional\n\ncookielawinfocheckbox-necessary\n\ncookielawinfocheckbox-others\n\ncookielawinfocheckboxperformance\n\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n\nThe cookie is set by GDPR cookie consent to record\nthe user consent for the cookies in the category\n\"Functional\".\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookies is used to store the user consent for the\ncookies in the category \"Necessary\".\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Other.\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Performance\".\n\n\ncujo_cerber_* 1 day Secures the website by detecting and mitigating\nmalicious activity.\n\n\nviewed_cookie_policy 11\nmonths\n\n\nThe cookie is set by the GDPR Cookie Consent plugin\nand is used to store whether or not user has\nconsented to the use of cookies. It does not store any\npersonal data.\n\n\nFunctional cookies help to perform certain functionalities like sharing the content of the\nwebsite on social media platforms, collect feedbacks, and other third-party features.\n\nPerformance cookies are used to understand and analyze the key performance indexes of\nthe website which helps in delivering a better user experience for the visitors.\n\nAnalytical cookies are used to understand how visitors interact with the website. These\ncookies help provide information on metrics the number of visitors, bounce rate, traffic\nsource, etc.\n\n**Cookie** **Duration** **Description**\n\n_ga session The _ga cookie, installed by Google Analytics,\ncalculates visitor, session and campaign data\nand also keeps track of site usage for the site's\nanalytics report. The cookie stores information\nanonymously and assigns a randomly\ngenerated number to recognize unique visitors.\n\n_gat_gtag_UA_128580456_1 session Set by Google to distinguish users.\n\n\n-----\n\n**Cookie** **Duration** **Description**\n\n_gid session Installed by Google Analytics, _gid cookie\nstores information on how visitors use a\nwebsite, while also creating an analytics report\nof the website's performance. Some of the\ndata that are collected include the number of\nvisitors, their source, and the pages they visit\nanonymously.\n\nAdvertisement cookies are used to provide visitors with relevant ads and marketing\ncampaigns. These cookies track visitors across websites and collect information to provide\ncustomized ads.\n\nOther uncategorized cookies are those that are being analyzed and have not been classified\ninto a category as yet.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-07 - Threat Alert- Mirai-Gafgyt Fork with New DDoS Modules Discovered.pdf"
    ],
    "report_names": [
        "2021-09-07 - Threat Alert- Mirai-Gafgyt Fork with New DDoS Modules Discovered.pdf"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536083,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653821429,
    "ts_modification_date": 1653821429,
    "files": {
        "pdf": "https://archive.orkl.eu/16d43436703c27d12cc6e4a50668bb9e6d645c26.pdf",
        "text": "https://archive.orkl.eu/16d43436703c27d12cc6e4a50668bb9e6d645c26.txt",
        "img": "https://archive.orkl.eu/16d43436703c27d12cc6e4a50668bb9e6d645c26.jpg"
    }
}