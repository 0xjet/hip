{
    "id": "4f796bc8-85c6-494e-acad-fc0ae82efffe",
    "created_at": "2023-01-12T15:09:48.379966Z",
    "updated_at": "2025-03-27T02:15:35.661281Z",
    "deleted_at": null,
    "sha1_hash": "9a75ca9b3ec9b0e1ca4dca2479847bfa1bddd07d",
    "title": "2022-04-20 - Mars Stealer malware analysis",
    "authors": "",
    "file_creation_date": "2022-08-18T03:29:41Z",
    "file_modification_date": "2022-08-18T03:29:41Z",
    "file_size": 2919882,
    "plain_text": "# Mars Stealer malware analysis\n\n**[resources.infosecinstitute.com/topic/mars-stealer-malware-analysis/](https://resources.infosecinstitute.com/topic/mars-stealer-malware-analysis/)**\n\nMars Stealer is the latest variant of [Oski Stealer. This info stealer can gather data from the](https://www.cyberark.com/resources/threat-research-blog/meet-oski-stealer-an-in-depth-analysis-of-the-popular-credential-stealer)\nmost popular web browsers, including 2FA plugins and multiple cryptocurrency extensions\nand wallets.\n\n[Mars Stealer is a stealthy and powerful malware with only 95 KB but capable of stealing a](https://www.infosecinstitute.com/courses/reverse-engineering-boot-camp/?utm_source=resources&utm_medium=infosec%20network&utm_campaign=course%20pricing&utm_content=hyperlink)\n[large volume of data. According to 3xp0rt analysis, this is a redesigned variant of the Oski](https://3xp0rt.com/posts/mars-stealer#introduction)\ntrojan that stopped its operation in July 2020. Its authors closed the Telegram channel and\nstopped all activity, including communication with their clients. Later, in July 2021, Mars\nStealer began to be promoted on a Russian-speaking underground forum. [CLICK IMAGES\n**TO ENLARGE]**\n\n\n-----\n\n**_[Figure 1: Mars Sstealer announced on an underground forum in 2021 (source).](https://3xp0rt.com/posts/mars-stealer#introduction)_**\n\n## How Mars Stealer malware works\n\nMars Stealer takes advantage of several techniques to be stealthy. The malware strings are\nobfuscated and decrypted in run time using the RC4 algorithm and Base64 combinations.\n\n\n-----\n\n**_Figure 2: Mars Stealer obfuscated strings._**\n\nBy implementing a simple strings decryptor, obtaining all the plain-text strings is possible, as\nobserved in Figure 3. In detail, the RC4 key “86223203794583053453” is extracted from an\ninitialization function responsible for starting the decryption process. The “key” is also\nhighlighted below.\n\n\n-----\n\n**_[Figure 3: String’s decryptor of Mars Stealer malware (source).](https://github.com/sirpedrotavares/SI-LAB-malware/blob/master/mars_stealer_decryptor)_**\n\nAfter decrypting the malware strings, some internal procedures became more apparent. This\nnew variant uses anti-analysis techniques, namely anti-debug and emulation procedures.\n\n**_Figure 4: Anti analysis techniques found during the malware analysis._**\n\n\n-----\n\nIn detail, the malware obtains the computer name and compares it with a hardcoded string,\nprobably the development hostname. If it matches, then the malware stops its activity.\n\nAlso, queries to the GetUserDefaultLangID() WinCall are performed to skip machines’\ninfections from the Commonwealth of Independent States (CIS). This function can be\ndisabled when new samples are generated, as observed later.\n\nThe malware downloads some target DLLs from its C2 server during its execution. These\nDLLs are the malware dependencies used to support all the malicious operations when data\nis exfiltrated from popular web browsers. After decrypting the strings, it’s possible to see the\nflow responsible for downloading the DLL files into the “C:\\ProgramData” folder.\n\n**_Figure 5: Target DLLs download from Mars Stealer C2 server during the malware execution._**\n\n\n-----\n\nAs observed, all the addressed DLLs are available to download on the Mars stealer C2\nserver along with its web panel, also detailed towards the end of this article.\n\n**_Figure 6: Target DLLs (dependencies) available on the C2 server._**\n\n## Mars Stealer targets\n\nMars Stealer uses a custom capturer capable of retrieving its configuration on C2 to then\nattack the following applications:\n\n### Internet Applications\n```\n Google Chrome, Internet Explorer, Microsoft Edge (Chromium Version),\n Kometa, Amigo, Torch, Orbitium, Comodo Dragon, Nichrome, Maxxthon5,\n Maxxthon6, Sputnik Browser, Epic Privacy Browser, Vivaldi, CocCoc, Uran\n Browser, QIP Surf, Cent Browser, Elements Browser, TorBro Browser,\n CryptoTab Browser, Brave, Opera Stable, Opera GX, Opera Neon, Firefox,\n SlimBrowser, PaleMoon, Waterfox, CyberFox, BlackHawk, IceCat, K-Meleon and\n Thunderbird.\n\n```\n\n-----\n\n**_[Figure 7: Internet applications targeted by Mars Stealer (source).](https://3xp0rt.com/posts/mars-stealer#introduction)_**\n\n### 2FA applications\n```\n Authenticator, Authy, EOS Authenticator, GAuth Authenticator, and Trezor\n Password Manager.\n\n Crypto extensions\n\n```\n\n-----\n\n```\n TronLink, MetaMask, Binance Chain Wallet, Yoroi, Nifty Wallet, Math\n Wallet, Coinbase Wallet, Guarda, EQUAL Wallet, Jaox Liberty, BitAppWllet,\n iWallet, Wombat, MEW CX, Guild Wallet, Saturn Wallet, Ronin Wallet,\n Neoline, Clover Wallet, Liquality Wallet, Terra Station, Keplr, Sollet,\n Auro Wallet, Polymesh Wallet, ICONex, Nabox Wallet, KHC, Temple, TezBox\n Cyano Wallet, Byone, OneKey, Leaf Wallet, DAppPlay, BitClip, Steem\n Keychain, Nash Extension, Hycon Lite Client, ZilPay, and Coin98 Wallet.\n\n```\n**_[Figure 8: Browser extensions found inside the malware sample (source).](https://3xp0rt.com/posts/mars-stealer#introduction)_**\n\n### Crypto wallets\n```\n Bitcoin Core and all derivatives (Dogecoin, Zcash, DashCore, LiteCoin,\n etc), Ethereum, Electrum, Electrum LTC, Exodus, Electron Cash, MultiDoge,\n JAXX, Atomic, Binance, and Coinomi.\n\n```\n\n-----\n\n**_[Figure 9: Crypto wallets targeted by Mars Stealer (source).](https://3xp0rt.com/posts/mars-stealer#introduction)_**\n\n## Mars Stealer web-panel\n\nMars Stealer is being sold for approximately $160. The files include the web panel with all\nneeded data to propagate new campaigns and the malware builder to generate new\nsamples.\n\nRegarding the web panel, a PHP panel with a MySQL database engine is used by criminals\nto take control over all the exfiltrated information and victims’ machines. Figure 10 shows the\nweb-panel structure and the db.php file with the database configuration.\n\n**_Figure 10: Internal structure of the Mars stealer web panel (C2 server)._**\n\nThe main dashboard provides information on the collected information, as observed below.\n\n\n-----\n\n**_[Figure 11: Screenshots of Mars stealer web panel (source).](https://www.pcrisk.pt/guias-de-remocao/11281-mars-stealer)_**\n\nOn the other hand, a builder is also provided in the same bundle. This application is capable\nof generating new samples of this specific Mars Stealer version (6.1), and some fields can be\nintroduced, namely:\n\n**C2 hostname**\n\n\n-----\n\n**C2 gate.php file location (file that receives all the information from victims and**\n**parses them)**\n**Code encryption pass; and**\n**the possibility of disabling CIS check**\n\n**_Figure 12: Mars Stealer builder._**\n\n## The threat of Mars Stealer\n\nMars Stealer is a new and different malware in contrast to other popular and emergent\nthreats. This piece of software was designed within a stealthy approach, in order to maintain\nthe threat active for a long time. The real targets of this malware are crypto-wallets, and\nbecause of that, some steps need to be taken to prevent potential infections.\n\nIn the first place, backups are a rule of thumb to fight any cyberattack. It’s mandatory to keep\nbackup copies of your wallet files and their private keys safe and secure.\n\nTo circumvent the Mars Stealer’s intent, the usage of wallets that offer offline storage is the\nmost suitable solution. For instance, using a simple paper wallet for single keys can be very\neffective. However, if you need to store a larger volume of crypto assets, consider using a\nhardware wallet. These physical devices can store private keys away from your computer\noffline and provide an extra layer of security.\n\nYour assets will be safe from potential attacks with this approach in place.\n\n## Sources:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-20 - Mars Stealer malware analysis.pdf"
    ],
    "report_names": [
        "2022-04-20 - Mars Stealer malware analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536188,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1660793381,
    "ts_modification_date": 1660793381,
    "files": {
        "pdf": "https://archive.orkl.eu/9a75ca9b3ec9b0e1ca4dca2479847bfa1bddd07d.pdf",
        "text": "https://archive.orkl.eu/9a75ca9b3ec9b0e1ca4dca2479847bfa1bddd07d.txt",
        "img": "https://archive.orkl.eu/9a75ca9b3ec9b0e1ca4dca2479847bfa1bddd07d.jpg"
    }
}