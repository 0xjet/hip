{
    "id": "c787b698-9e9d-45ac-b28b-b2d9f26f884c",
    "created_at": "2023-01-12T15:01:11.398822Z",
    "updated_at": "2025-03-27T02:17:27.629798Z",
    "deleted_at": null,
    "sha1_hash": "f5522b9d97d03771cabf65e4607eecaf809afcb1",
    "title": "2018-04-20 - Researchers Discover New variants of APT34 Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T17:01:31Z",
    "file_modification_date": "2022-05-28T17:01:31Z",
    "file_size": 1228867,
    "plain_text": "# Researchers Discover New variants of APT34 Malware\n\n**boozallen.com/s/insight/blog/dark-labs-discovers-apt34-malware-variants.html**\n\n**Table 1. Relationship between original binary and three discovered variants. (Use the scrollbar to view the content on the far right.)**\n\nAs you can see from Table 1 above, these files exhibit many similar characteristics and behaviors. Most of the differences appear to be\ncosmetic and do not affect the underlying functionality. Our analysts took a closer look at the C2 domain poison-frog[.]club, which is used in 3\nof the 4 files, and found that it overlaps with the findings of the FireEye report. The domain resolved to 82.102.14.219 from at least August\n2017 until December 2017. Additional domains that resolved to that IP during that time frame are dns-update[.]club, hpserver[.]online, and\nanyportals[.]com which were all mentioned in the FireEye report. The other C2 domain used, proxycheker[.]pro, resolved to 94.23.172.164 and\n185.15.247.147, with 185.15.247.147 also hosting dns-update[.]club during that time frame. This new-found evidence, in combination with\nsimilar versions of POWRUNER and BONDUPDATER, the existence of the same debug strings in the code of each variant, and the\noverlapping infrastructure indicate that these three new binaries are also associated with APT34 operations.\n\nThe DGA domain generation algorithm used in one version of the BONDUPDATER backdoor is broken down into two parts: send and receive.\nIf data is being sent, then the following format is used:\n\nUse the scrollbar to view the content on the far right.\n\n1. This is created from combining a unique ID (generated from the MAC address or encoded version of whoami) along with two other\n\nparameters which are inserted at two different random offsets in the unique ID\n2. Random characters generated from: -join ((48 .. 57)+(65 .. 70) | Get-Random -Count (%{ Get-Random -InputObject (1 .. 7) }) | %{\n\n[char]$_ })\n3. Hardcoded \"A\"\n4. Two random offset values referenced in #1.\n5. Hardcoded \"7\"\n6. Data Chunk being sent\n7. Encoded Filename being sent\n8. Hardcoded domain \".poison-frog[.]club\"\n\nIf data is being received, then the following format is used:\n\n\n-----\n\n1. This is created from combining a unique ID (generated from the MAC address or encoded version of whoami) along with two other\n\nparameters which are inserted at two different random offsets in the unique ID\n2. Random characters generated from: -join ((48 .. 57)+(65 .. 70) | Get-Random -Count (%{ Get-Random -InputObject (1 .. 7) }) | %{\n\n[char]$_ })\n3. Hardcoded \"A\"\n4. Two random offset values referenced in #1.\n5. Hardcoded \"7\"\n6. Hardcoded domain \".poison-frog[.]club\"\n\nThe Domain Generating Algorithm (DGA) generation process is different than what was previously mentioned in the FireEye report. However,\nit would still be detected using DarkLabs' custom DGA detection mechanism.\n\n[In early January 2018, ClearSky Cyber Security tweeted about two new malware samples attributed to Oilrig/APT34. These samples were](https://twitter.com/ClearskySec/status/948183396064354304)\nbeing deployed via a malicious .chm (Compiled HTML Help File) file. ClearSky provides a link to a Google document they use for \"Raw Threat\nIntelligence\" which contained additional IOCs associated with this campaign. Two hashes provided in that document are for versions of\nPOWRUNER (MD5: BED81E58EF8FF0B073E371D433A08855) and BONDUPDATER (MD5: 63D6B1933F7330358A8FBFAF77532133).\nThese two backdoors contain a reference to another C2 domain, www.window5[.]win. Using the custom tool developed in DarkLabs, we were\nable to pivot from these samples and discover an additional sample each of POWRUNER and BONDUPDATER.\n\nThese two new samples exhibit similar behavior to the samples mentioned in the FireEye report. However, there are a few slight differences namely the use of a new C2 domain and URI, www.window5[.]win/update.aspx. At writing time of this post, that domain resolves to\n185.181.8.246. Current research indicates that IP does not host any other domains publicly available. Additionally, the %PUBLIC%\\Java\nlocation (e.g. C:\\Users\\Public\\Java) is used for a staging directory in this version of POWRUNER.\n\n\n-----\n\n000C20009204A601 7D A 56 7 6556666775466767667566765657661c79e4f73cd932f3f64ca161c45041 336662009e6a .poisonfrog.club\n\n1 2 3 4 5 6 7 8\n\n\n-----\n\n0800C0092904A601 02 A 51 7 .poison-frog.club\n\n1 2 3 4 5 6\n\n**Source** **Hash Value** **C2 Domain** **Details**\n\nClearSky Cyber BED81E58EF8FF0B073E371D433A08855 window5[.]win POWRUNER\nSecurity Communicates with C2 via\n\nwww.window5[.]win/update.aspx\n\nClearSky Cyber 63D6B1933F7330358A8FBFAF77532133 window5[.]win BOUNDATER\nSecurity Communicates via DGA based DNS to\n\nwondow5[.]win\n\nATH Tool CBE2F69D9EF39093D8645D3C93FD7F21 window5[.]win POWRUNER\nCommunicates with C2 via\nwww.window5[.]win/update.aspx\n\nATH Tool 277FF86501B98A4FF8C945AC4D4A7C53 window5[.]win BONDUPDATER\nCommunicates via DGA based DNS to\nwindow5[.]win\n\n**Table 2. Relationship between original two samples and two discovered variants. (Use the scrollbar to view the content on the far right.)**\n\n**IOC - Network**\n\n**Domain/IP Address** **Description**\n\nproxycheker[.]pro C2\n\npoison-frog[.]club C2\n\nwindow5[.]win C2\n\n82.102.14.219 Has resolved poison-frog[.]club, dns-update[.]club, hpserver[.]online & anyportals[.]com\n\n94.23.172.164 Has resolved proxycheker[.]pro\n\n185.15.247.147 Has resolved proxycheker[.]pro & dns-update[.]club\n\n185.181.8.246 Has resolved window5[.]win\n\n**IOC - Endpoint**\n\n**Filename** **Description** **MD5 Hash**\n\ndupdatechecker.exe Dropper of POWRUNER and BONDUPDATER C9F16F0BE8C77F0170B9B6\n\nexeruner_new.exe Dropper of POWRUNER and BONDUPDATER 87FB0C1E0DE46177390DE3\n\nexeruner.exe Dropper of POWRUNER and BONDUPDATER A602A7B6DEADC3DFB6473A\n\nexeruner_new.exe Dropper of POWRUNER 4EA656D10BE1D6EAC05D69\n\nGoogleUpdateschecker.vbs Deploys POWRUNER 6F2CA6D892CCA631C19123\n\n\n-----\n\nJavaUpdates Scheduled Task to run VBS script 0681F2459EDF28DCD99493A\n\nrUpdateChecker.ps1 Sets up scheduled task to deploy POWRUNER EE93A172937D37D3152D694\n\nGoogleUpdateTasks.vbs Deploys POWRUNER and BONDUPDATER F0B278427C8841C5D1A79E\n\nJavaUpdatesTasksHosts Scheduled Task to run VBS script 52973212E6373585F55B4DD\n\nrUpdateChecker.ps1 Sets up scheduled task to deploy POWRUNER and BONDUPDATER 06D537AF8C43F65FC467781\n\nGoogleUpdateschecker.vbs Deploys POWRUNER and BONDUPDATER 33E86AB6621F3DB7CD7E37\n\nJavaUpdates Scheduled Task to run VBS script 517D1D51414019272849E7C\n\nrUpdateChecker.ps1 Sets up scheduled task to deploy POWRUNER and BONDUPDATER 614DDCCDCAF73172C1216D\n\nUpdateCheckers.ps1 BONDUPDATER 1DE8F76404EB799C780DA5\n\ndUpdateCheckers.ps1 BONDUPDATER 27ACDFAB0A264B4EBD4DD\n\nGoogleUpdates.vbs Deploys POWRUNER and BONDUPDATER D9BBB27B0C5249D681179D\n\nJavaUpdatesTask Scheduled Task to run VBS script 347929555E8D7174D82356F\n\nrUpdateChecker.ps1 Sets up scheduled task to deploy POWRUNER and BONDUPDATER C3572009CA311F44A99C4FA\n\nhxyz.ps1 POWRUNER BED81E58EF8FF0B073E371\n\ndxyz.ps1 BONDUPDATER 63D6B1933F7330358A8FBFA\n\nunknown POWRUNER CBE2F69D9EF39093D8645D\n\nunknown BONDUPDATER 277FF86501B98A4FF8C945A\n\nYara Signature for the\ndropper {\nstrings:\n\n$exeruner_string_1 = \"C:\\\\Users\\\\aaa\\\\documents\\\\visual studio\n2015\\\\Projects\\\\exeruner\\\\exeruner\\\\obj\\\\Debug\\\\exeruner.pdb\"\n\n$exeruner_string_2 =\n\"C:\\\\Users\\\\aaa\\\\Desktop\\\\test\\\\exeruner\\\\exeruner\\\\obj\\\\Debug\\\\exeruner_new.pdb\"\n\ncondition:\n\n$exeruner_string_1 or $exeruner_string_2\n\n}\n\nUse the scrollbar to view the content on the far right.\n\nBy diving deeper and pivoting on known indicators using techniques developed and honed by our experienced analysts, the indicator lifecycle\ncan diversify discovery. In this case, analysts discovered additional unreported, yet campaign associated IOCs that can be used for further\ndetection. Additionally, our analysts also developed YARA signatures for static detection, and TTP based signatures to deploy to EDR tools or\nfor hunting through endpoint telemetry data.\n\nThe Booz Allen DarkLabs Threat Hunt team recommends deploying detection to endpoints for the hashes listed above and perform a\nretroactive search for the domains and IPs in SIEM logs. We also recommend the use of telemetry data collected via EDR tools to\ncontinuously hunt for this behavior. Monitoring for the behavior or TTP is a critical step because although IOCs can be used for detection and\ndiscovery, they can in many cases be changed cheaply and easily. Our advanced Threat Hunt team always recommends a robust proactive\napproach to threat hunting with a focus on behavioral detection.\n\nPlease [contact us if you would like to learn more about DarkLabs Threat Hunt team or if you are interested in joining our team.](https://www.boozallen.com/cdn-cgi/l/email-protection#e08481928b8c818293a0828188ce838f8d)\n\n\n-----\n\n## pe t t e e d\n\n[Garrettson Blight](https://www.boozallen.com/s/bio/professionals/garrettson-blight.html)\nDetecting A New Advanced Persistent Threat: Adware\nGet tips on how to identify a new, sophisticated adware variant, and learn what to do if you find it in your network. Read More\n\nWhat’s It Take to Be a Cyber Elite?\nOur ability to recruit and retain top-tier cyber talent allows us to build teams with the true diversity of skill sets required to overcome our clients’\ntoughest, most specialized cybersecurity challenges. Read More\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-04-20 - Researchers Discover New variants of APT34 Malware.pdf"
    ],
    "report_names": [
        "2018-04-20 - Researchers Discover New variants of APT34 Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535671,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653757291,
    "ts_modification_date": 1653757291,
    "files": {
        "pdf": "https://archive.orkl.eu/f5522b9d97d03771cabf65e4607eecaf809afcb1.pdf",
        "text": "https://archive.orkl.eu/f5522b9d97d03771cabf65e4607eecaf809afcb1.txt",
        "img": "https://archive.orkl.eu/f5522b9d97d03771cabf65e4607eecaf809afcb1.jpg"
    }
}