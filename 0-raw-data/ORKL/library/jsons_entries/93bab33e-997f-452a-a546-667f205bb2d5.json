{
    "id": "93bab33e-997f-452a-a546-667f205bb2d5",
    "created_at": "2023-01-12T14:59:49.191332Z",
    "updated_at": "2025-03-27T02:05:35.012003Z",
    "deleted_at": null,
    "sha1_hash": "5d959bd117f7fa7e4f015741c857e5c9b65fc456",
    "title": "2017-09-21 - New FinFisher surveillance campaigns- Internet providers involved-",
    "authors": "",
    "file_creation_date": "2022-05-28T03:40:57Z",
    "file_modification_date": "2022-05-28T03:40:57Z",
    "file_size": 327306,
    "plain_text": "# New FinFisher surveillance campaigns: Internet providers involved?\n\n**[welivesecurity.com/2017/09/21/new-finfisher-surveillance-campaigns/](https://www.welivesecurity.com/2017/09/21/new-finfisher-surveillance-campaigns/)**\n\nSeptember 21, 2017\n\nFinFisher has extensive spying capabilities, such as live surveillance through webcams and\nmicrophones, keylogging, and exfiltration of files. What sets FinFisher apart from other\nsurveillance tools, however, are the controversies around its deployments.\n\n[Filip Kafka](https://www.welivesecurity.com/author/fkafka/)\n\n\n-----\n\n21 Sep 2017 - 03:30PM\n\nFinFisher has extensive spying capabilities, such as live surveillance through webcams and\nmicrophones, keylogging, and exfiltration of files. What sets FinFisher apart from other\nsurveillance tools, however, are the controversies around its deployments.\n\nNew surveillance campaigns utilizing FinFisher, infamous spyware known also as FinSpy\nand sold to governments and their agencies worldwide, are in the wild. Besides featuring\ntechnical improvements, some of these variants have been using a cunning, previouslyunseen infection vector with strong indicators of major internet service provider (ISP)\ninvolvement.\n\n[FinFisher has extensive spying capabilities, such as live surveillance through webcams and](https://en.wikipedia.org/wiki/FinFisher)\nmicrophones, keylogging, and exfiltration of files. What sets FinFisher apart from other\nsurveillance tools, however, are the controversies around its deployments. FinFisher is\nmarketed as a law enforcement tool and is believed to have been used also by oppressive\nregimes.\n\nWe discovered these latest FinFisher variants in seven countries; unfortunately, we cannot\nname them so as not to put anyone in danger.\n\n## Infecting the targets\n\nFinFisher campaigns are known to have used various infection mechanisms, including\n[spearphishing, manual installations with physical access to devices, 0-day exploits, and so-](https://www.fireeye.com/blog/threat-research/2017/09/zero-day-used-to-distribute-finspy.html)\ncalled watering hole attacks – poisoning websites the targets are expected to visit (which\nwe observed to serve a mobile version of FinFisher, for example).\n\nWhat’s new – and most troubling – about the new campaigns in terms of distribution is the\nattackers’ use of a man-in-the-middle attack with the “man” in the middle most likely\noperating at the ISP level. We have seen this vector being used in two of the countries in\nwhich ESET systems detected the latest FinFisher spyware (in the five remaining countries,\nthe campaigns have relied on traditional infection vectors).\n\nWhen the user – the target of surveillance – is about to download one of several popular\n(and legitimate) applications, they are redirected to a version of that application infected\nwith FinFisher.\n\nThe applications we have seen being misused to spread FinFisher are WhatsApp, Skype,\nAvast, WinRAR, VLC Player and some others. It is important to note that virtually any\napplication could be misused in this way.\n\nThe attack starts with the user searching for one of the affected applications on legitimate\nwebsites. After the user clicks on the download link, their browser is served a modified link\nand thus redirected to a trojanized installation package hosted on the attacker’s server.\n\n\n-----\n\nWhen downloaded and executed, it installs not only the intended legitimate application, but\nalso the FinFisher spyware bundled with it.\n\nFigure 1: Infection mechanism of latest FinFisher variants\n\nThe redirection is achieved by the legitimate download link being replaced by a malicious\none. The malicious link is delivered to the user’s browser via an HTTP 307 Temporary\nRedirect status response code indicating that the requested content has been temporarily\nmoved to a new URL. The whole redirection process occurs without the user’s knowledge\nand is invisible to the naked eye.\n\n\n-----\n\nFigure 2: Detailed infection mechanism of latest FinFisher variants\n\n## FinFisher: All about flying under the radar\n\nThe latest version of FinFisher has also received technical improvements, its authors\nputting even greater focus on stealth. The spyware uses custom code virtualization to\nprotect the majority of its components, including the kernel-mode driver. In addition, the\nentire code is filled with anti-disassembly tricks. We found numerous anti-sandboxing, antidebugging, anti-virtualization and anti-emulation tricks in the spyware. All this makes the\nanalysis more complicated.\n\n\n-----\n\nAfter overcoming the first level of protection (anti-disassembly), the next level – code\nvirtualization – awaits. The virtual machine dispatcher has 34 handlers; the spyware is\nexecuted almost entirely within an interpreter, which adds another layer to be dealt with\nduring the analysis.\n\nFigure 3: Visualization of the many virtual machine handlers that complicate code analysis\n\n[We have also released a whitepaper to help malware analysts and security researchers](https://www.welivesecurity.com/wp-content/uploads/2018/01/WP-FinFisher.pdf)\novercome FinFisher’s advanced anti-disassembly and virtualization features.\n\n## Special treatment for privacy-concerned users\n\nWhile analyzing the recent campaigns, we discovered an interesting sample: FinFisher\nspyware masqueraded as an executable file named “Threema”. Such a file could be used to\ntarget privacy-concerned users, as the legitimate Threema application provides secure\ninstant messaging with end-to-end encryption. Ironically, getting tricked into downloading\nand running the infected file would result in the privacy-seeking user being spied upon.\n\nThis special focus on users seeking encryption software is not limited solely to end-to-end\ncommunicators, apparently. During our research, we have also found an installation file of\nTrueCrypt – the once-very-popular disk encryption software – trojanized with FinFisher.\n\n## Who is the “man” in the middle?\n\nIt would be technically possible for the “man” in these man-in-the-middle attacks to be\nsituated at various positions along the route from the target’s computer to the legitimate\nserver (e.g. compromised Wi-Fi hotspots). However, the geographical dispersion of ESET’s\ndetections of latest FinFisher variants suggests the MitM attack is happening at a higher\nlevel – an ISP arises as the most probable option.\n\n\n-----\n\nThis assumption is supported by a number of facts: First, according to leaked internal\n[materials that have been published by WikiLeaks, the FinFisher maker offered a solution](https://wikileaks.org/spyfiles4/documents/FinFly-ISP-Catalog.pdf)\ncalled “FinFly ISP” to be deployed on ISP networks with capabilities matching those\nnecessary for performing such a MitM attack. Second, the infection technique (using the\nHTTP 307 redirect) is implemented in the very same way in both of the affected countries,\nwhich is very unlikely unless it was developed and/or provided by the same source. Third,\nall affected targets within a country are using the same ISP. Finally, the very same\nredirection method and format have been used for internet content filtering by internet\nservice providers in at least one of the affected countries.\n\nThe deployment of the ISP-level MitM attack technique mentioned in the leaked documents\nhas never been revealed – until now. If confirmed, these FinFisher campaigns would\nrepresent a sophisticated and stealthy surveillance project unprecedented in its combination\nof methods and reach.\n\nHas my computer been infected? / Am I being spied on?\n\nAll ESET products detect and block this threat as Win32/FinSpy.AA and Win32/FinSpy.AB.\nUsing [ESET’s Free Online Scanner, you can check your computer for its presence and](https://www.eset.com/int/home/online-scanner/)\nremove it if detected. ESET customers are protected automatically.\n\n**IoCs**\n\n_ESET detection names:_\n\nWin32/FinSpy.AA\n\nWin32/FinSpy.AB\n\n_Redirect:_\n\nHTTP/1.1 307 Temporary Redirect\\r\\nLocation:URL\\r\\nConnection: close\\r\\n\\r\\n\n\n_List of URL’s we found during our investigation:_\n\nhxxp://108.61.165.27/setup/TrueCrypt-7.2.rar\n\nhxxp://download.downloading.shop/pcdownload.php?\na=dad2f8ed616d2bfe2e9320a821f0ee39\n\nhxxp://download.downloading.shop/pcdownload.php?\na=84619b1b3dc8266bc8878d2478168baa\n\nhxxp://download.downloading.shop/pcdownload.php?\na=ddba855c17da36d61bcab45b042884be\n\n\n-----\n\n**IoCs**\n\nhxxp://download.downloading.shop/pcdownload.php?\na=d16ef6194a95d4c8324c2e6673be7352\n\nhxxp://download.downloading.shop/pcdownload.php?\na=95207e8f706510116847d39c32415d98\n\nhxxp://download.downloading.shop/pcdownload.php?\na=43f02726664a3b30e20e39eb866fb1f8\n\nhxxp://download.downloading.shop/pcdownload.php?\na=cb858365d08ebfb029083d9e4dcf57c2\n\nhxxp://download.downloading.shop/pcdownload.php?\na=8f8383592ba080b81e45a8913a360b27\n\nhxxp://download.downloading.shop/pcdownload.php?\na=e916ba5c43e3dd6adb0d835947576123\n\nhxxp://download.downloading.shop/pcdownload.php?\na=96362220acc8190dcd5323437d513215\n\nhxxp://download.downloading.shop/pcdownload.php?\na=84162502fa8a838943bd82dc936f1459\n\nhxxp://download.downloading.shop/pcdownload.php?\na=974b73ee3c206283b6ee4e170551d1f7\n\nhxxp://download.downloading.shop/pcdownload.php?\na=cd32a3477c67defde88ce8929014573d\n\nhxxp://download.downloading.shop/pcdownload.php?\na=36a5c94ffd487ccd60c9b0db4ae822cf\n\nhxxp://download.downloading.shop/pcdownload.php?\na=0ebb764617253fab56d2dd49b0830914\n\nhxxp://download.downloading.shop/pcdownload.php?\na=f35e058c83bc0ae6e6c4dffa82f5f7e7\n\nhxxp://download.downloading.shop/pcdownload.php?\na=64f09230fd56149307b35e9665c6fe4c\n\nhxxp://download.downloading.shop/pcdownload.php?\na=b3cc01341cb00d91bcc7d2b38cedc064\n\nhxxp://download.downloading.shop/pcdownload.php?\na=5fc0440e395125bd9d4c318935a6b2b0\n\nhxxp://download.downloading.shop/pcdownload.php?\na=5ca93ad295c9bce5e083faab2e2ac97a\n\n\n-----\n\n**IoCs**\n\nhxxp://download.downloading.shop/pcdownload.php?\na=f761984bb5803640aff60b9bc2e53db7\n\nhxxp://download.downloading.shop/pcdownload.php?\na=5ca93ad295c9bce5e083faab2e2ac97a\n\nhxxp://download.downloading.shop/pcdownload.php?\na=514893fa5f3f4e899d2e89e1c59096f3\n\nhxxp://download.downloading.shop/pcdownload.php?\na=a700af6b8a49f0e1a91c48508894a47c\n\nhxxp://download.downloading.shop/pcdownload.php?\na=36a5c94ffd487ccd60c9b0db4ae822cf\n\nhxxp://download.downloading.shop/pcdownload.php?\na=a700af6b8a49f0e1a91c48508894a47c\n\nhxxp://download.downloading.shop/pcdownload.php?\na=395ce676d1ebc1048004daad855fb3c4\n\nhxxp://download.downloading.shop/pcdownload.php?\na=cd32a3477c67defde88ce8929014573d\n\nhxxp://download.downloading.shop/pcdownload.php?\na=49d6d828308e99fede1f79f82df797e9\n\nhxxp://download.downloading.shop/pcdownload.php?\na=d16ef6194a95d4c8324c2e6673be7352\n\n_Samples (SHA-1)_\n\nca08793c08b1344ca67dc339a0fb45e06bdf3e2f\n\n417072b246af74647897978902f7d903562e0f6f\n\nc4d1fb784fcd252d13058dbb947645a902fc8935\n\ne3f183e67c818f4e693b69748962eecda53f7f88\n\nd9294b86b3976ddf89b66b8051ccf98cfae2e312\n\na6d14b104744188f80c6c6b368b589e0bd361607\n\n417072b246af74647897978902f7d903562e0f6f\n\nf82d18656341793c0a6b9204a68605232f0c39e7\n\ndf76eda3c1f9005fb392a637381db39cceb2e6a8\n\n\n-----\n\n**IoCs**\n\n5f51084a4b81b40a8fcf485b0808f97ba3b0f6af\n\n4b41f36da7e5bc1353d4077c3b7ef945ddd09130\n\n1098ba4f3da4795f25715ce74c556e3f9dac61fc\n\nd3c65377d39e97ab019f7f00458036ee0c7509a7\n\nc0ad9c242c533effd50b51e94874514a5b9f2219\n\na16ef7d96a72a24e2a645d5e3758c7d8e6469a55\n\nc33fe4c286845a175ee0d83db6d234fe24dd2864\n\ncfa8fb7c9c3737a8a525562853659b1e0b4d1ba8\n\n9fc71853d3e6ac843bd36ce9297e398507e5b2bd\n\n66eccea3e8901f6d5151b49bca53c126f086e437\n\n400e4f843ff93df95145554b2d574a9abf24653f\n\nfb4a4143d4f32b0af4c2f6f59c8d91504d670b41\n\nf326479a4aacc2aaf86b364b78ed5b1b0def1fbe\n\n275e76fc462b865fe1af32f5f15b41a37496dd97\n\ndf4b8c4b485d916c3cadd963f91f7fa9f509723f\n\n220a8eacd212ecc5a55d538cb964e742acf039c6\n\n3d90630ff6c151fc2659a579de8d204d1c2f841a\n\n21 Sep 2017 - 03:30PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n\n-----\n\n### Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-21 - New FinFisher surveillance campaigns- Internet providers involved-.pdf"
    ],
    "report_names": [
        "2017-09-21 - New FinFisher surveillance campaigns- Internet providers involved-.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535589,
    "ts_updated_at": 1743041135,
    "ts_creation_date": 1653709257,
    "ts_modification_date": 1653709257,
    "files": {
        "pdf": "https://archive.orkl.eu/5d959bd117f7fa7e4f015741c857e5c9b65fc456.pdf",
        "text": "https://archive.orkl.eu/5d959bd117f7fa7e4f015741c857e5c9b65fc456.txt",
        "img": "https://archive.orkl.eu/5d959bd117f7fa7e4f015741c857e5c9b65fc456.jpg"
    }
}