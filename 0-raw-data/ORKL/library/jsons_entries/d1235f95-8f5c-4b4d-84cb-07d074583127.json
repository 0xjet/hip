{
    "id": "d1235f95-8f5c-4b4d-84cb-07d074583127",
    "created_at": "2023-01-12T14:59:38.516834Z",
    "updated_at": "2025-03-27T02:05:40.064082Z",
    "deleted_at": null,
    "sha1_hash": "427c2cc7445eb3bf4709dc5d7fce1a482f8d6798",
    "title": "2022-03-17 - Threat Thursday- HermeticWiper Targets Defense Sectors in Ukraine",
    "authors": "",
    "file_creation_date": "2022-05-28T23:23:31Z",
    "file_modification_date": "2022-05-28T23:23:31Z",
    "file_size": 3299526,
    "plain_text": "# Threat Thursday: HermeticWiper Targets Defense Sectors in Ukraine\n\n**[blogs.blackberry.com/en/2022/03/threat-thursday-hermeticwiper](https://blogs.blackberry.com/en/2022/03/threat-thursday-hermeticwiper)**\n\nThe BlackBerry Research & Intelligence Team\n\n### New Disk Wiper Malware Hits Hundreds of Ukrainian Computers\n\nIn addition to suffering a full-scale military invasion in recent weeks, Ukraine is also being\n[subjected to numerous cyberattacks aimed at crippling its organizations and digital](https://krebsonsecurity.com/2022/03/report-recent-10x-increase-in-cyberattacks-on-ukraine/)\ninfrastructure. One of the latest of these is [HermeticWiper, a new data wiper malware that](https://blogs.blackberry.com/en/2022/02/threat-alert-hermeticwiper-malware)\ntargets infrastructure and defense sectors in Ukraine, with additional reports of\ncompromised systems coming from Lithuania and Latvia.\n\n[HermeticWiper shares some similarities with the recently discovered WhisperGate malware,](https://blogs.blackberry.com/en/2022/01/threat-thursday-whispergate-wiper)\nin that it appears to function solely as a tool for destruction. After wiping the victim’s disk, it\nthen targets the Master Boot Record (MBR) before forcing a reboot, resulting in a total boot\nfailure and rendering the system inoperable.\n\n[First reported in a tweet by ESET Research on February 23,rd](https://twitter.com/ESETresearch/status/1496581903205511181?cxt=HHwWmsC93fnT9sQpAAAA) 2022, the threat intelligence\n[community subsequently named the new malware HermeticWiper, a reference to two of its](https://twitter.com/juanandres_gs/status/1496607141888724997?s=20&t=ZHj4Q4GDQrGDxx07ZHFz5w)\nmain activities. The wiper first hijacks a valid code-signing certificate from Hermetica Digital\n\n\n-----\n\nLtd. to gain the victim s trust. It then uses a legitimate disk recovery program from EaseUS\nData Recovery Wizard, packed by the threat authors as a driver, to overwrite data in the\nvictim’s Master Boot Record (MBR) and thus corrupt the file system.\n\nA decoy ransomware component has also been reported on some systems affected by\nHermeticWiper, to distract the victim while the main functionality occurs.\n\n### Operating System\n\n Risk & Impact\n\n Technical Analysis\n\n**Wiper Overview**\n\nIn this blog, BlackBerry researchers will analyze a sample hash of HermeticWiper, to see\nwhat lies under the hood.\n\n**Sample hash:**\n0385EEAB00E946A302B24A91DEA4187C1210597B8E17CD9E2230450F5ECE21DA\n\nThe file presents itself as “conhost.exe,” borrowing the filename of the Console Windows\nHost for Microsoft® Windows®. The executable file uses a standard Visual Studio Project\nicon, as seen in Figure 1, and displays the Hermetica certificate shown in Figure 2. This\ninclusion of a valid certificate helps the wiper to evade detection on the system by\nappearing to come from a legitimate and trusted source.\n\n\n-----\n\n_Figure 1 – Program icon_\n\n\n-----\n\n_Figure 2 – Hermetica certificate_\n\nA brief look into the file shows there are four drivers packaged inside. These drivers are\nnamed DRV_X64, DRV_X86, DRV_XP_X64, and DRV_XP_X86, with each having “SZDD”\nas the first few bytes of the file, as seen in Figure 3. This indicates that the drivers are\ncompressed with the built-in MS-DOS “compress.exe.”\n\n\n-----\n\n_Figure 3 – Compressed drivers_\n\nOnce each driver has been extracted and saved as their own file on the victim’s system, an\nunzipping program such as 7-Zip can be used to decompress the files and reveal what they\nreally are. An expired certificate shown in Figure 4 for CHENGDU YIWO Tech Development\nCo. Ltd. can be found in each driver. A quick Internet search links this certificate to a disk\nrecovery software program called EaseUS Data Recovery Wizard.\n\n\n-----\n\n_Figure 4 – CHENGDU YIWO Tech Development certificate_\n\n### Wiper Behavior\n\nThe files must be launched as Administrator for the wiper to execute. And for the system\nreboot to be triggered, the first character of the file name must be C.\n\nImmediately after launch, a new service with a four-character randomized name starts to\nrun, as seen in Figure 5.\n\n\n-----\n\n_Figure 5 – Service starts with random four-character name_\n\n[By using a hex editor like HxD before and after launching, you can reveal the damage that](https://mh-nexus.de/en/hxd/)\nHermeticWiper is causing to the C:\\ disk. Before execution, you can see the standard 52 90\n4E 54 46 53 20 bytes (shown in Figure 6) that represent the start of an NTFS formatted\ndrive. After HermeticWiper begins to run, the threat corrupts those bytes, as you can see in\nFigure 7. The malicious wiper will continue to change these values as it completes its\nexecution.\n\n_Figure 6 – C:\\ drive before HermeticWiper runs_\n\n\n-----\n\n_Figure 7 – C:\\ drive after HermeticWiper runs_\n\nWhen HermeticWiper has finished corrupting the C:\\ drive, the malware restarts the affected\nsystem, which results in the dreaded Blue Screen of Death (BSOD). After attempting to\nrestart again, the victim will be greeted with a new message indicating that their operating\nsystem is missing, as shown in Figure 8. The C:\\ drive is now wiped, and the system is\ninoperable.\n\n_Figure 8 – The last thing any user wants to see upon reboot_\n\n### Load Driver and Wipe Disk\n\n\n-----\n\nTaking a step back, let s take a look at the EaseUS Data Recovery Wizard. This is loaded\nby the malware as a compressed driver. The wiper contains four copies of this driver, with\neach corresponding to different OS versions (Windows XP or Windows 7+) and\narchitectures (32-bit or 64-bit). As shown in Figure 9, system information first needs to be\nloaded by the wiper so it can then choose to start the correct driver version.\n\n_Figure 9 – Driver selection by HermeticWiper_\n\nOnce the OS is identified by the malware, the corresponding compressed driver is loaded.\n\nDRV_X64 – Windows 7+ 64-bit\nDRV_X86 – Windows 7+ 32-bit\nDRV_XP_X64 – Windows XP 64-bit\n\n\n-----\n\nDRV_XP_X86 – Windows XP 32-bit\n\nHermeticWiper then decompresses the drivers with the LZMA algorithm. It uses\n“DeviceIoControl” for file operations such as finding the PhysicalDriveID to get information\non the victim’s disk partitions, as shown in Figure 10.\n\n\n-----\n\n-----\n\n_Figure 10 – Find PhysicalDriveID_\n\nWith the drive information loaded, the CryptGenRandom function then begins to overwrite\ndata in the Master File Table fields, $Bitmap and $LogFile files, recursively in the AppData,\nMyDocuments, Desktop, and Documents and Settings folders, and then the MBR. Once the\nmalware has finished overwriting this data with random bytes, the system will automatically\nrestart. This time, however, it will not boot because almost all the data on disk has been\nwiped. The victim’s device is now unrecoverable.\n\n### Ransomware Component\n\n[Decoys and false flags are deployed in many scenarios where the goal is to confuse and](https://en.wikipedia.org/wiki/False_flag)\nmisdirect victims, to buy the adversary time to conduct its real mission of destroying and\ndisabling their opponent’s systems and infrastructure.\n\nLet’s take a closer look at HermeticWiper’s decoy.\n\n**Sample hash:**\n4DC13BB83A16D4FF9865A51B3E4D24112327C526C1392E14D56F20D6F4EAF382\n\n[There is a ransomware component that, according to AVAST, sometimes comes along with](https://twitter.com/AvastThreatLabs/status/1496663206634344449)\nthe wiper as a tool of misdirection. Upon launch, the ransomware (written in the\nprogramming language “Go”) displays behavior typical of ransomware. The victim device’s\nCPU utilization jumps to 100% as their files are encrypted. Once files are encrypted, they\nare renamed with an “.encryptedJB” extension.\n\nThere is some good news, however. The encryption used by HermeticWiper is not strong,\n[and a free decryptor has already been made available for any files that victims are able to](https://decoded.avast.io/threatresearch/help-for-ukraine-free-decryptor-for-hermeticransom-ransomware/#howto)\nsalvage from their machines.\n\n### Conclusion\n\nHermeticWiper differentiates itself from other wipers by its creator’s efforts to help it evade\ndetection. This malware was created specifically to destroy the machines of victims.\nHermeticWiper was initially observed targeting Ukraine, but we are now hearing that it has\nalso spread to organizations in other countries. This sort of spillover was also observed with\nthe [NotPetya attack, which affected numerous organizations in countries outside Ukraine.](https://www.industrialcybersecuritypulse.com/throwback-attack-how-notpetya-accidentally-took-down-global-shipping-giant-maersk/)\n\nWhile we’re used to seeing financially motivated malware such as ransomware, wipers that\nexist solely for the purpose of data destruction have become a convenient tool for nefarious\nactors when their goal is to cripple individual organizations or even entire industries within a\ntarget area.\n\n### YARA Rule\n\n\n-----\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\n**rule HermeticWiper{**\n\n**meta:**\n**description = \"Detects HermeticWiper\"**\n**author = \"BlackBerry Threat Research Team\"**\n**date = \"2022-03-09\"**\n**license = \"This Yara rule is provided under the Apache License 2.0**\n**(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or**\n**organization, as long as you use it under this license and ensure originator credit**\n**in any derivative to The BlackBerry Research & Intelligence Team\"**\n\n**strings:**\n**_$s1 = \"\\\\\\\\.\\\\EPMNTDRV\\\\%u\" wide_**\n**_$s2 = \"\\\\\\\\.\\\\PhysicalDrive%u\" wide_**\n**_$s3 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\CrashControl\" wide_**\n\n**_$sd1 = \"DRV_X64\" wide_**\n**_$sd2 = \"DRV_X86\" wide_**\n**_$sd3 = \"DRV_XP_X64\" wide_**\n**_$sd4 = \"DRV_XP_X86\" wide_**\n\n**_$c = { 0C 48 73 28 73 AC 8C CE BA F8 F0 E1 E8 32 9C EC }_**\n\n**_$x = { 53 5A 44 44 88 F0 27 33 41 00 48 ?? 00 00 FF 4D_**\n**5A 90 00 03 00 00 00 7D 04 F5 F0 FF FF 00 00 B8**\n**F5 F0 ?? 01 01 40 01 04 0F 0D 1C 09 ?? ?? ?? ?? }**\n\n**condition:**\n**_uint16(0) == 0x5a4d and filesize < 150KB and all of them_**\n\n**}**\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n**HermeticWiper**\n\n06086C1DA4590DCC7F1E10A6BE3431E1166286A9E7761F2DE9DE79D7FDA9C397\n\n3C557727953A8F6B4788984464FB77741B821991ACBF5E746AEBDD02615B1767\n\n2C10B2EC0B995B88C27D141D6F7B14D6B8177C52818687E4FF8E6ECF53ADF5BF\n\n0385EEAB00E946A302B24A91DEA4187C1210597B8E17CD9E2230450F5ECE21DA\n\n1BC44EEF75779E3CA1EEFB8FF5A64807DBC942B1E4A2672D77B9F6928D292591\n\n4AA186B5FDCC8248A9672BF21241F77DD395872EC4876C90AF5D27AE565E4CB7\n\n**Resource.zip – contains the wiper**\n\n92B9198B4AED95932DB029236CB8879A01C73494B545BCACB1ED40596D56990C\n\n**DRV_X64 - Windows 7+ 64-bit**\nE5F3EF69A534260E899A36CEC459440DC572388DEFD8F1D98760D31C700F42D5\n\n**Decompressed Hash**\n\n96B77284744F8761C4F2558388E0AEE2140618B484FF53FA8B222B340D2A9C84\n\n**DRV_X86 - Windows 7+ 32-bit**\nB01E0C6AC0B8BCDE145AB7B68CF246DEEA9402FA7EA3AEDE7105F7051FE240C1\n\n**Decompressed Hash**\n\n8C614CF476F871274AA06153224E8F7354BF5E23E6853358591BF35A381FB75B\n\n**DRV_XP_X64 - Windows XP 64-bit**\nB6F2E008967C5527337448D768F2332D14B92DE22A1279FD4D91000BB3D4A0FD\n\n**Decompressed Hash**\n\n23EF301DDBA39BB00F0819D2061C9C14D17DC30F780A945920A51BC3BA0198A4\n\n**DRV_XP_X86 - Windows XP 32-bit**\nFD7EACC2F87ACEAC865B0AA97A50503D44B799F27737E009F91F3C281233C17D\n\n**Decompressed Hash**\n\n2C7732DA3DCFC82F60F063F2EC9FA09F9D38D5CFBE80C850DED44DE43BDB666D\n\n**Ransom Component**\n\n4DC13BB83A16D4FF9865A51B3E4D24112327C526C1392E14D56F20D6F4EAF382\n\n### BlackBerry Assistance\n\n\n-----\n\nIf you re battling this malware or a similar threat, you ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-17 - Threat Thursday- HermeticWiper Targets Defense Sectors in Ukraine.pdf"
    ],
    "report_names": [
        "2022-03-17 - Threat Thursday- HermeticWiper Targets Defense Sectors in Ukraine.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535578,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653780211,
    "ts_modification_date": 1653780211,
    "files": {
        "pdf": "https://archive.orkl.eu/427c2cc7445eb3bf4709dc5d7fce1a482f8d6798.pdf",
        "text": "https://archive.orkl.eu/427c2cc7445eb3bf4709dc5d7fce1a482f8d6798.txt",
        "img": "https://archive.orkl.eu/427c2cc7445eb3bf4709dc5d7fce1a482f8d6798.jpg"
    }
}