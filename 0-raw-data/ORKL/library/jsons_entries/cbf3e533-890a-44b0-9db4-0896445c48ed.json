{
    "id": "cbf3e533-890a-44b0-9db4-0896445c48ed",
    "created_at": "2022-10-25T16:48:19.643226Z",
    "updated_at": "2025-03-27T02:15:24.543487Z",
    "deleted_at": null,
    "sha1_hash": "425780581a76b844dce4c8817d1878171f138507",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-07T03:13:54Z",
    "file_modification_date": "2021-01-07T03:13:54Z",
    "file_size": 328400,
    "plain_text": "# ReconHellcat Uses NIST Theme as Lure To Deliver New BlackSoul Malware\n\n**[quointelligence.eu/2021/01/reconhellcat-uses-nist-theme-as-lure-to-deliver-new-blacksoul-malware](https://quointelligence.eu/2021/01/reconhellcat-uses-nist-theme-as-lure-to-deliver-new-blacksoul-malware/)**\n\nJanuary 5, 2021\n\n## Introduction\n\nOn 27 November, QuoIntelligence detected a new malware, seemingly uploaded to VirusTotal\nby a user in Turkmenistan, which shares multiple similarities to the threat actor we\npreviously dubbed ReconHellcat. The campaign ultimately delivers a previously\n**undocumented remote access Trojan (RAT), which we dubbed BlackSoul. After**\npromptly alerting our customers, we notified Cloudflare about the C2 infrastructure hosted on\n[their Workers service as per our responsible disclosure process.](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjk96Lux4buAhXUGFkFHeTyDCQQFjAAegQIARAC&url=https%3A%2F%2Fworkers.cloudflare.com%2F&usg=AOvVaw2Zt-uFSsvY_asdQQ5FHkKr)\n\nFurther analysis revealed the malware being part of a targeted campaign, that likely\n[originated with a spear phishing email delivering a CAB archive. Both the CAB and the file](https://www.virustotal.com/gui/file/690872b8d0205203029b2b388b27f15a7673e9c02dab99f76216efc4a305cd4c/detection)\ncontained within are named 1-10-20-hb44_final to impersonate one of the\n[documents available on the National Institute of Standards and Technology (NIST) website.](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjzuM7Vy4buAhUjGFkFHS83CiAQFjAAegQIARAD&url=https%3A%2F%2Fwww.nist.gov%2F&usg=AOvVaw0908J5PhTOUQuVLJt9JE9z)\n\n_Figure 1: CAB archive contents_\n\n_Figure 2: Legitimate NIST document URL and filename_\n\n## Technical Analysis\n\n Loader.ReconHellcat\n\n**File Name** 1-10-20-hb44_final.exe\n\n**SHA256** 3be1dd49f01e8b7ddf9af765693690d44356399b9e6043e51d5e13c82194b2a4\n\n\n**First**\n**Submission**\n**to VT**\n\n**First AV**\n**detection**\n**rate**\n\n\n2020-11-27 10:41:21\n\nLow (10/71)\n\n\n-----\n\nDuring our analysis, we determined 1-10-20-hb44_final.exe is a malicious loader, which uses\n[obfuscation similar to the variant observed in the previously reported ReconHellcat campaign](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/)\ndelivering BlackWater malware. Another similarity is that the loader utilizes C2 infrastructure\nhosted on the Cloudflare Workers service. Following a successful C2 connection, the loader\nretrieves two files: (1) an executable named blacksoul, and (2) a Dynamic-Link Library (DLL)\nnamed blacksoulLib. Additionally, the loader opens Microsoft Word with the aforementioned\nlegitimate document from the NIST website. Essentially, ReconHellcat uses this legitimate\ndocument as a decoy. The blacksoul and blacksoulLib files have compilation timestamps from\n27 and 26 November, respectively.\n\n## BlackSoul\n\n**File Name** Bl4ck_S0ul6s5_1d7704b469.blacksoul\n\n**SHA256** c49cad471a61adb5ea8a6d260887d1dd7f22de75d1143ce2a72828842ef4bb52\n\n\n**First**\n**Submission**\n**to VT**\n\n**First AV**\n**detection**\n**rate**\n\n\n2020-11-29 18:23:26\n\nLow (18/71)\n\n\nThe second stage executable is a newly observed malware family, which we linked to the\nReconHellcat threat actor. We named the malware “BlackSoul” to match its internal name,\nmain class name, and file name.\n\n_Figure 3: Class name “BlackSoul”_\nThe malware is a classical minimal RAT, which is capable of file transfers and running\narbitrary commands. Through static analysis, we determined that the executable’s main loop\nsupports handling the following commands from its C2 server:\n\n\nCommand Field\nNames\n\n\nActions Taken\n\n\n**1** **params** **Executes a command and return the result.**\n\n\n**2** url and path or\nmedia and\nalternativeText\n\n\nDownloads file(s) from a URL and stores them in a destination on\nthe machine. Creates a destination folder if it does\nnot already exist.\n\n\n**3** paths Likely retrieves a specified file from the machine and uploads it to\nthe C2.\n\n\n-----\n\nCommand Field\nNames\n\n\nActions Taken\n\n\n**4** config Updates the configuration file (UsrClass.json) which contains C2\nserver info and miscellaneous fields.\n\n_Table 1: BlackSoul Commands and Actions Taken_\nBlackSoul makes use of two files:\n\n**UsrClass.json: Contains a JSON configuration. It is unclear if this file is mandatory or**\nmerely used to save existing configurations between invocations of BlackSoul.\n**UsrClass.data: Observed as a DLL with an Init() export, which we refer to as**\nblacksoulLib and will describe in depth in the next section.\n\nBlackSoul uses information gathered by blacksoulLib to call back to the C2 over the RESTful\nStrapi protocol and JSON based data encoding.\n\nThe RAT’s string obfuscation applies only to strings in the main program but excludes strings\nof third-party compiled in libraries. BlackSoul additionally uses various other techniques for\nobfuscation. In particular, strings are constructed dynamically on the stack and deobfuscated\nwith a variety of mechanisms, such as a fixed key XOR cipher and a Caesar cipher using\nvariable shift values.\n\n## blacksoulLib\n\n**File Name** Bl4ck_S0ul6s5_faac59ebe2.blacksoulLib\n\n**SHA256** fdd310ce1b4f03a79f7a6eda8df793f4c0718766228a9a0700cf0b5a4ea648e2\n\n\n**First**\n**Submission**\n**to VT**\n\n**First AV**\n**detection**\n**rate**\n\n\n2020-11-26 23:45:57\n\nLow (18/71)\n\n\n_Figure 4: exports of the originally named blacksoulLib_\n\n\n-----\n\nThe file is a DLL with a single export, Init(), which is called by BlackSoul. In this instance, its\nprimary functions are:\n\nSearching the victim’s machine for Firefox, Chrome, and Opera data. If the browser data\nis not found, the program terminates early.\nDecoding a C2 URL later used by BlackSoul\nDecoding a Cloudflare DNS-over-HTTPS (DoH) URL.\nGenerating further login information for the C2 and returning gathered data to\nBlackSoul in JSON format, including:\n\nA username with three random appended characters.\nA password consisting of 24 random characters.\n\n\n-----\n\n_Figure 5: C2 URL decryption and setting of the URL parameter_\nBased on our observations, the DLL’s specific functionality adapts to various victims’\nenvironments, and the DLL outputs different C2 information for various targets.\n\n## Victimology\n\nQuoIntelligence was unfortunately unable to uncover the entities targeted by this campaign.\nThe only information at hand relies on:\n\nThe VirusTotal submitter’s country (Turkmenistan)\n\n\n-----\n\nThe theme used as a lure (NIST)\n\nDue to the limited information available to determine victimology, we cannot definitively\nstate a target. However, it is likely that the BlackSoul campaign targeted a governmentrelated body based on the theme lure, since NIST develops and publicizes security compliance\nstandard for the US Federal Government and any organization who handles government data.\nAs well, previously observed ReconHellcat campaign targets consisted of primarily defense\nand diplomatic government bodies.\n\n## Attribution\n\nWhen we initially discovered ReconHellcat, its campaign characteristics and Tactics,\nTechniques, and Procedures (TTPs) were unique enough to classify it as a new threat actor.\nDuring our analysis of the new BlackSoul campaign, we identified limited yet sufficient\nsimilarities overlapping with the earlier observed BlackWater campaign. As a result, we have\nhigh confidence attributing this attack to ReconHellcat.\n\n## Similarities to earlier ReconHellcat campaigns:\n\nLure themes of government related organization materials.\nUsage of compressed archives, likely via spear phishing email links or attachments, to\ndistribute the initial attack artifacts.\nA three-stage attack scheme.\n\nSimilarities between ReconHellcat‘s BlackSoul and BlackWater malware:\n\nSupports DNS-over-HTTPS (DoH) using cloudflare-dns.com.\nHas clear internal naming likely due to a lack of artifact cleanup in the malware build\nprocess.\nResolves the C2 hostnames via DNS over HTTPS (DoH) using a built-in feature of\nlibcurl, aclient-side URL transfer library.\nContains paths and parameters to use Strapi – a content management system (CMS).\nIdentical string obfuscation.\nUses Cloudflare Workers Service (*.workers[.]dev) to host C2 infrastructure.\nJSON–encoded communications.\nSimilar kind of randomized login (user registration) scheme with the C2 server.\nMalware samples contain a ‘Black’ prefix in their naming schemes.\n\nTo note, although we have not found a strong correlation or technical link between\nReconHellcat and APT28, there are shared characteristics between the two groups, which we\n[highlighted in our recent APT28 reporting.](https://quointelligence.eu/2020/09/apt28-zebrocy-malware-campaign-nato-theme/)\n\n## Appendix I – IOCs\n\nhxxps://noisy-hazeaf47.fromhell.workers.dev/uploads/Bl4ck_S0ul6s5_1d7704b469.blacksoul\n\nhxxps://noisy-hazeaf47.fromhell.workers.dev/uploads/Bl4ck_S0ul6s5_faac59ebe2.blacksoulLib\n\n\n-----\n\nhxxps://shrill-wave-90be.0black.workers.dev/\n\n**Loader.ReconHellcat**\n\n3be1dd49f01e8b7ddf9af765693690d44356399b9e6043e51d5e13c82194b2a4\n\n**BlackSoul**\n\nc49cad471a61adb5ea8a6d260887d1dd7f22de75d1143ce2a72828842ef4bb52\n\n**blacksoulLib**\n\nfdd310ce1b4f03a79f7a6eda8df793f4c0718766228a9a0700cf0b5a4ea648e2\n\n## MITRE ATT&CK\n\n**TACTIC** **TECHNIQUE**\n\n\n**Initial Access**\n\n**Execution**\n\n\n[T1566: Phishing](https://attack.mitre.org/techniques/T1566/)\n\n[T1204: User Execution](https://attack.mitre.org/techniques/T1204/)\n\n\n**Defense Evasion** [T1027: Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/)\n\n\n**Credential Access**\n\n\n[T1555: Credentials from Password Stores](https://attack.mitre.org/techniques/T1555/)\n\n\n**Discovery** [T1082 System Information Discovery](https://attack.mitre.org/techniques/T1082/)\n\n**Collection** [T1005: Data from Local System](https://attack.mitre.org/techniques/T1005/)\n\n**Command and Control** [T1132: Data Encoding](https://attack.mitre.org/techniques/T1132/)\n\n[T1105: Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/)\n\n[T1572: Protocol Tunneling](https://attack.mitre.org/techniques/T1572/)\n\n**Exfiltration** [T1041: Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041/)\n\n[T1020: Automated Exfiltration](https://attack.mitre.org/techniques/T1020/)\n\nDo you want to stay informed of cyber and geopolitical threats targeting your organization?\nAre you interested in receiving exclusive and unpublished intelligence?\n\n[Get in touch!](https://quointelligence.eu/talk-to-an-expert/)\n\n## Join Our Newsletter!\n\nSubscribe to our newsletter to receive Weekly Intelligence Summaries, cyber news, and\nexciting updates!\n\nOnly valid business emails will be approved.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.01.05.ReconHellcat_APT_BlackSoul_Malware/quointelligence.eu-ReconHellcat%20Uses%20NIST%20Theme%20as%20Lure%20To%20Deliver%20New%20BlackSoul%20Malware.pdf"
    ],
    "report_names": [
        "quointelligence.eu-ReconHellcat Uses NIST Theme as Lure To Deliver New BlackSoul Malware"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041724,
    "ts_creation_date": 1609989234,
    "ts_modification_date": 1609989234,
    "files": {
        "pdf": "https://archive.orkl.eu/425780581a76b844dce4c8817d1878171f138507.pdf",
        "text": "https://archive.orkl.eu/425780581a76b844dce4c8817d1878171f138507.txt",
        "img": "https://archive.orkl.eu/425780581a76b844dce4c8817d1878171f138507.jpg"
    }
}