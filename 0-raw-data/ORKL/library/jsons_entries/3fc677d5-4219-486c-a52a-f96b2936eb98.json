{
    "id": "3fc677d5-4219-486c-a52a-f96b2936eb98",
    "created_at": "2023-01-12T15:02:38.130106Z",
    "updated_at": "2025-03-27T02:17:14.477586Z",
    "deleted_at": null,
    "sha1_hash": "7cd3873a468773cec51a855d3f78bb3b4c8aa10c",
    "title": "2021-01-12 - Confucius APT deploys Warzone RAT",
    "authors": "",
    "file_creation_date": "2022-05-28T16:11:43Z",
    "file_modification_date": "2022-05-28T16:11:43Z",
    "file_size": 1050752,
    "plain_text": "# Confucius APT deploys Warzone RAT\n\n**uptycs.com/blog/confucius-apt-deploys-warzone-rat**\n\n_[Research by Abhijit Mohanta and](https://www.uptycs.com/blog/author/abhijit-mohanta)_ _[Ashwin Vamshi](https://www.uptycs.com/blog/author/ashwin-vamshi)_\n\n[Uptycs' threat research team published a piece about Warzone RAT and its advanced](https://www.uptycs.com/blog/warzone-rat-comes-with-uac-bypass-technique)\ncapabilities in November 2020. During the first week of January 2021, we discovered an\nongoing targeted attack campaign related to Confucius APT, a threat actor / group primarily\ntargeting government sectors in South Asia. This attack was identified by our in-house\nosquery-based sandbox that triggered a detection on Warzone RAT activity.\n\nBased on our threat intelligence systems, we were able to confirm that the threat actor is\ntrying to circumvent attacks with decoys that deliver the next stage payload via the template\ninjection technique and a short C2 TTL (Time to Live).\n\n## Technical analysis\n\nOur in-house sandbox, which uses Uptycs EDR for detection, detected a Warzone RAT\npayload in the attack kill chain of the decoy document “China Cruise Missiles CapabilitiesImplications for the Indian Army.docx” (hash:\nb9b5a9fa0ad7f802899e82e103a6c2c699c09390b1a79ae2b357cacc68f1ca8e).\n\nThis attack document was crafted by the attacker group to entice the victims or targets into\nopening a file related to the ongoing India China border tension.\n\n\n-----\n\n_Figure 1: Screenshot from the \"China Cruise Missiles Capabilities-Implications for the Indian_\n_Army.docx\" decoy._\n\n[We believe the decoy lure must have been copied from this PDF, which contains a study by](https://www.orfonline.org/wp-content/uploads/2020/12/ORF_IssueBrief_427_ChinaCruiseMissiles.pdf)\nKartik Bommakanti for the Observer Research Foundation (ORF).\n\n## Attack kill chain\n\nThe decoy lure was a 16-page document that would have skipped the eye of static heuristic\nengines because they generally scan suspicious files based on the number of pages\n(malicious documents are usually one page).\n\nUpon execution, the document used template injection to download the next stage RTF\nexploit that downloaded the final stage Warzone payload using a DLL embedded in the RTF\nexploit. The attack kill chain of the different phases of the attack is detailed in figure 2, below.\n\n\n-----\n\n_Figure 2: Attack kill chain of the different phases of the attack._\n\nThe various phases of the attack are as follows:\n\nVictim opens the Word document\nDocument downloads template RTF\nExploit in RTF is triggered and bing.dll is dropped and executed\nBing.dll downloads Warzone RAT\n\nUsing the template injection technique, the next stage payload is downloaded via the\nword/_rels/settings.xml.rels file present in the document structure as shown in figure 3,\nbelow.\n\n_Figure 3: setting.xmls.rels containing link to template._\n\nThe downloaded template (hash:\n2f5fc653550b0b5d093427263b26892e3468e125686eb41206319c7060212c40) is an RTF\nfile containing exploit code for the old vulnerability “CVE-2018-0802” in the Microsoft\n\n\n-----\n\nequation editor (EQNEDT32.exe). This is evident from the CLSID present in the RTF file\n“7b0002CE02-0000-0000-C000-000000000046,” which is related to the equation editor. The\nRTF contains a DLL embedded in an OLE object as shown in figure 4, below.\n\n_Figure 4: DLL embedded in OLE._\n\nThe embedded DLL file, bing.dll (SHA-256:\n07277c9f33d0ae873c2be3742669594acc18c7aa93ecadb8b2ce9b870baceb2f), which is\nexecuted upon successful exploitation, contains an export “mark” that is responsible for\ndownloading the Warzone payload. Figure 5, below, shows the code that downloads the\nWarzone payload.\n\n_Figure 5: Downloader code in DLL._\n\n\n-----\n\nThe Warzone payload is saved to the %ProgramData% folder as update.exe (SHA-256:\n4500851dad1ac87165fc938fe5034983c10423f800bbc2661741f39e43ab8c8d) as shown in\nthe above figure. In order to maintain persistence, an LNK file named update.lnk pointing to\nupdate.exe is dropped to startup folders - “%AppData%Microsoft\\Windows\\Start\nMenu\\Programs\\Startup”.\n\nWarzone RAT was caught by Uptycs in November. It has capabilities to log keystrokes, steal\npasswords, capture the webcam, and it has the ability to bypass UAC on Windows 10. You\ncan read more details about Warzone RAT in our [blog post.](https://www.uptycs.com/blog/warzone-rat-comes-with-uac-bypass-technique)\n\n## Similar themed attacks delivering Warzone RAT\n\nWe identified three similar DLL files in our threat intelligence systems with the same\nimphash: 58f8f4bdb6d7059247f4fe90a8ba9477. Using this data, we identified three more\ndecoy documents most likely used for different targets using these DLL files as the next\nstage payloads.\n\nThe first decoy document was observed in October 2020.\n\nFile name: Testing.docx\nHash: a3cd781b14d75de94e5263ce37a572cdf5fe5013ec85ff8daeee3783ff95b073\nRTF hash:\n686847b331ace1b93b48528ba50507cbf0f9b59aef5b5f539a7d6f2246135424\nDLL hash: 1c41a03c65108e0d965b250dc9b3388a267909df9f36c3fefffbd26d512a2126\nPDB path: C:\\Users\\admin\\Documents\\dll\\linknew\\Release\\linknew.pdb\nC2: recent[.]wordupdate[.]com\n\nThe decoy’s subject focused on China preparing for war in the Taiwan Strait—a topic sure to\nattract attention\n\n\n-----\n\n_Figure 6: China preparing for war in the Taiwan Strait decoy._\n\nThe second decoy was observed in November 2020. Interestingly, this decoy had the same\nhash of the next stage RTF and the DLL payloads used in the first decoy document.\n\nFile name: Suparco Vacancy Notification.docx\nHash: 59ccfff73bdb8567e7673a57b73f86fc082b0e4eeaa3faf7e92875c35bf4f62c\nRTF hash:\n686847b331ace1b93b48528ba50507cbf0f9b59aef5b5f539a7d6f2246135424\nDLL hash: 1c41a03c65108e0d965b250dc9b3388a267909df9f36c3fefffbd26d512a2126\nPDB path: C:\\Users\\admin\\Documents\\dll\\linknew\\Release\\linknew.pdb\nC2: recent[.]wordupdate.com\n\nThis decoy posed as a job application form for the Pakistan Space & Upper Atmosphere\nResearch Commission (SUPARCO).\n\n\n-----\n\n_Figure 7: SUPARCO vacancy notification decoy._\n\nAlso in November 2020, we identified another highly targeted decoy:\n\nHash: 59cd62ad204e536b178db3e2ea10b36c782be4aa4849c10eef8484433a524297\nRTF hash: 3ce48f371129a086935b031333387ea73282bda5f22ff78c85ee7f0f5e4625fe\nDLL hash: ea52d6358d53fc79e1ab61f64cb77bb47f773f0aa29223b115811e2f339e85f5\nPDB path: C:\\Users\\admin\\Documents\\dll\\linknew\\Release\\linknew.pdb\nC2: recent.wordupdate.com\n\nThis decoy focused on another attention-grabbing topic—what to expect from Joe Biden, the\nnew president of the United States, related to top nuclear weapons issues. The DLL file\nconnected to the same C2 and contained the same PDB path in the above two documents.\n\n\n-----\n\n_Figure 8: Top nuclear weapons issues decoy._\n\nBased on the decoys and the topics, we believe the campaign is ongoing with selected\ntargets. As the C2 TTL is short lived, we believe the threat actor is tailoring the attacks to\nselected targets and taking down their attack elements.\n\nTargeted attacks will always try to leverage the latest news with high media attention to tailor\nattacks. The Warzone RAT was deployed as the final stage payload to monitor and carry\nsurveillance on the victim's machine. While traditional solutions have a detection stance\nagainst such threats, it is always recommended to have a layered security approach that has\nadvanced analytics and granular visibility of targeted attacks and the next stage payloads\nused in their attack kill chains.\n\n## IOCs\n\n**Hashes**\n\nb9b5a9fa0ad7f802899e82e103a6c2c699c09390b1a79ae2b357cacc68f1ca8e\n\n2f5fc653550b0b5d093427263b26892e3468e125686eb41206319c7060212c40\n\n07277c9f33d0ae873c2be3742669594acc18c7aa93ecadb8b2ce9b870baceb2f\n\n4500851dad1ac87165fc938fe5034983c10423f800bbc2661741f39e43ab8c8d\n\na3cd781b14d75de94e5263ce37a572cdf5fe5013ec85ff8daeee3783ff95b073\n\n\n-----\n\n686847b331ace1b93b48528ba50507cbf0f9b59aef5b5f539a7d6f2246135424\n\n1c41a03c65108e0d965b250dc9b3388a267909df9f36c3fefffbd26d512a2126\n\n59ccfff73bdb8567e7673a57b73f86fc082b0e4eeaa3faf7e92875c35bf4f62c\n\n59cd62ad204e536b178db3e2ea10b36c782be4aa4849c10eef8484433a524297\n\n3ce48f371129a086935b031333387ea73282bda5f22ff78c85ee7f0f5e4625fe\n\nea52d6358d53fc79e1ab61f64cb77bb47f773f0aa29223b115811e2f339e85f5\n\n**URLs**\n\nmsoffice[.]user-assist[.]site\n\nrecent[.]wordupdate[.]com\n\n**YARA rule**\n```\nrule upt_Confucius_apt_dll {\n     meta:\n          description=\"DLL used by Confucius\"\n          author = \"abhijit mohanta\"\n          date = \"January 2021\"\n     strings:\n          $upt_APT_10 = { 61 00 00 ?? 61 00 00 ?? 67 00 00 ?? 66 00 00}\n          $upt_APT_11= { 62 00 00 ED 61 00 00 99 66 00 00 77 66 00 00}\n          $upt_APT_21 = \".gfids\" ascii wide \n     condition:\n          (any of ($upt_APT_1*)) and $upt_APT_21\n}\n\n```\nTag(s): [threat research](https://www.uptycs.com/blog/tag/threat-research)\n\n## Uptycs Threat Research\n\nResearch and updates from the Uptycs Threat Research team.\n\nConnect with the author\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-12 - Confucius APT deploys Warzone RAT.pdf"
    ],
    "report_names": [
        "2021-01-12 - Confucius APT deploys Warzone RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535758,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1653754303,
    "ts_modification_date": 1653754303,
    "files": {
        "pdf": "https://archive.orkl.eu/7cd3873a468773cec51a855d3f78bb3b4c8aa10c.pdf",
        "text": "https://archive.orkl.eu/7cd3873a468773cec51a855d3f78bb3b4c8aa10c.txt",
        "img": "https://archive.orkl.eu/7cd3873a468773cec51a855d3f78bb3b4c8aa10c.jpg"
    }
}