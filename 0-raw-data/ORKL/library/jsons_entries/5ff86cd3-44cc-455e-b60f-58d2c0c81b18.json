{
    "id": "5ff86cd3-44cc-455e-b60f-58d2c0c81b18",
    "created_at": "2023-01-12T15:04:37.52573Z",
    "updated_at": "2025-03-27T02:08:41.26174Z",
    "deleted_at": null,
    "sha1_hash": "421000c6782935872dc7ffa1b58a266b6d808b51",
    "title": "2017-04-06 - Sathurbot- Distributed WordPress password attack",
    "authors": "",
    "file_creation_date": "2022-05-28T18:05:48Z",
    "file_modification_date": "2022-05-28T18:05:48Z",
    "file_size": 2082938,
    "plain_text": "# Sathurbot: Distributed WordPress password attack\n\n**[welivesecurity.com/2017/04/06/sathurbot-distributed-wordpress-password-attack/](https://www.welivesecurity.com/2017/04/06/sathurbot-distributed-wordpress-password-attack/)**\n\nApril 6, 2017\n\nThis article sheds light on the current ecosystem of the Sathurbot backdoor trojan, in particular exposing its use of torrents as a\ndelivery medium and its distributed brute-forcing of weak WordPress administrator accounts.\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/)\n6 Apr 2017 - 03:00PM\n\nThis article sheds light on the current ecosystem of the Sathurbot backdoor trojan, in particular exposing its use of torrents as a\ndelivery medium and its distributed brute-forcing of weak WordPress administrator accounts.\n\n[This article sheds light on the current ecosystem of the Sathurbot backdoor trojan, in particular exposing its use of torrents as a](http://virusradar.com/en/Win32_Sathurbot.A/description)\ndelivery medium and its distributed brute-forcing of weak WordPress administrator accounts.\n\n## The torrent leecher\n\nLooking to download a movie or software without paying for it? There might be associated risks. It just might happen that your\nfavorite search engine returns links to torrents on sites that normally have nothing to do with file sharing. They may, however,\nrun WordPress and have simply been compromised.\n\nSome examples of search results:\n\n\n-----\n\nClicking on some of those links returns the pages below (notice how some even use HTTPS):\n\n\n-----\n\n-----\n\nThe movie subpages all lead to the same torrent file; while all the software subpages lead to another torrent file. When you\nbegin torrenting in your favorite torrent client, you will find the file is well-seeded and thus appears legitimate. If you download\nthe movie torrent, its content will be a file with a video extension accompanied by an apparent codec pack installer, and an\n\n\n-----\n\nexplanatory text file. The software torrent contains an apparent installer executable and a small text file. The objective of both is\nto entice get the victim to run the executable which loads the Sathurbot DLL.\n\nAfter you start the executable, you are presented with a message like this:\n\n[While you ponder your options, bad things start to happen in the background. You have just become a bot in the Sathurbot](https://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Win32/Sathurbot)\nnetwork.\n\n## Backdoor and downloader\n\nOn startup, Sathurbot retrieves its C&C with a query to DNS. The response comes as a DNS TXT record. Its hex string value is\ndecrypted and used as the C&C domain name for status reporting, task retrieval and to get links to other malware downloads.\n\n\n-----\n\n[Sathurbot can update itself and download and start other executables. We have seen variations of Boaxxe,](http://www.virusradar.com/en/Win32_Boaxxe.C/description) [Kovter and](http://www.virusradar.com/en/Win32_Kovter.A/description)\n[Fleercivet, but that is not necessarily an exhaustive list.](http://www.virusradar.com/en/Win64_Fleercivet.AE/description)\n\nThe Sathurbot then reports its successful installation along with a listening port to the C&C. Periodically, it reports to the C&C\nthat it is alive and well, waiting for additional tasks.\n\n## Web crawler\n\nSathurbot comes with some 5,000 plus basic generic words. These are randomly combined to form a 2-4 word phrase\ncombination used as a query string via the Google, Bing and Yandex search engines.\n\nFrom the webpages at each of those search result URLs, a random 2-4 word long text chunk is selected (this time it might be\nmore meaningful as it is from real text) and used for the next round of search queries.\n\nFinally, the second set of search results (up to first three pages) are harvested for domain names.\n\n\n-----\n\nThe extracted domain names are all subsequently probed for being created by the WordPress framework. The trick here is to\ncheck the response for the URL http://[domain_name]/wp-login.php.\n\nAfterward the root index page of the domain is fetched and probed for the presence of other frameworks. Namely, they are also\ninterested in: Drupal, Joomla, PHP-NUKE, phpFox, and DedeCMS.\n\nUpon startup, or at certain time intervals, the harvested domains are sent to the C&C (a different domain is used than the one\nfor the backdoor – a hardcoded one).\n\n## Distributed WordPress password attack\n\nThe client is now ready to get a list of domain access credentials (formatted as login:password@domain) to probe for\npasswords. Different bots in Sathurbot’s botnet try different login credentials for the same site. Every bot only attempts a single\nlogin per site and moves on. This design helps ensure that the bot doesn’t get its IP address blacklisted from any targeted site\nand can revisit it in the future.\n\nDuring our testing, lists of 10,000 items to probe were returned by the C&C.\n\n\n-----\n\nFor the attack itself, the XML-RPC API of WordPress is used. Particularly the wp.getUsersBlogs API is abused. A typical\nrequest looks like:\n\nThe sequence of probing a number of domain credentials is illustrated in the following figure:\n\nThe response is evaluated and results posted to the C&C.\n\n## Torrent client – seeder\n\nThe bot has the libtorrent library integrated and one of the tasks is to become a seeder – a binary file is downloaded, torrent\ncreated and seeded.\n\nThe BitTorrent bootstrap\n\n[That completes the cycle from a leecher to an involuntary seeder:](https://en.wikipedia.org/wiki/Glossary_of_BitTorrent_terms#Leech)\n\n\n-----\n\nNote: Not every bot in the network is performing all the functions, some are just web crawlers, some just attack the XML-RPC\nAPI, and some do both. Also, not every bot seems to be seeding a torrent.\n\n## Impact\n\nThe above-mentioned attempts on /wp-login.php from a multitude of users, even to websites that do not host WordPress, is the\ndirect impact of Sathurbot. Many web admins observe this and wonder why it is happening. In addition, WordPress sites can\nsee the potential attacks on wp.getUsersBlogs in their logs.\n\nThrough examination of logs, system artifacts and files, the botnet consists of over 20,000 infected computers and has been\nactive since at least June 2016.\n\nOccasionally, we have seen torrent links being sent by email as well.\n\n## Detection\n\nWeb Admins – Check for unknown subpages and/or directories on the server. If they contain any references to torrent\ndownload offers, check logs for attacks and possible backdoors.\n\nUsers – Run Wireshark with the filter http.request with no web browser open to see too many requests like GET /wp-login.php\nand/or POST /xmlrpc.php. Alternatively, check for files or registry entries listed in the IoC section, below.\n\nESET users are protected from this threat on multiple levels.\n\n## Removal\n\nWeb Admins – Change passwords, remove subpages not belonging to site, optionally wipe and restore the site from a backup.\n\nUsers – Using a third-party file manager find the suspect .DLL (note that the files and directories have the hidden attribute set),\nopen Process Explorer or Task Manager, kill explorer.exe and/or rundll32.exe, delete (quarantine) the affected .DLL, reboot.\n\n**Note: this will remove Sathurbot only, and not any other malware it may have also downloaded.**\n\n[Alternatively, consider a comprehensive anti-malware product, or at least an online scanner.](https://www.eset.com/int/home/online-scanner/)\n\n## Prevention\n\n\n-----\n\nWeb Admins – Should the normal functioning of the website not require the XML-RPC API, you are advised to disable it and\nuse complex passwords.\n\nUsers – Avoid both running executables downloaded from sources other than those of respected developers, and downloading\nfiles from sites not designed primarily as file-sharing sites.\n\n## IoCs\n\nCurrently, we have observed Sathurbot installing to:\n\n\\ProgramData\\Microsoft\\Performance\\Monitor\\PerformanceMonitor.dll\n\n\\ProgramData\\Microsoft\\Performance\\TheftProtection\\TheftProtection.dll\n\n\\ProgramData\\Microsoft\\Performance\\Monitor\\SecurityHelper.dll\n\n\\Users\\*****\\AppData\\Local\\Microsoft\\Protect\\protecthost.dll\n\nRuns in the context of rundll32.exe or explorer.exe process and locks files and registry keys from editing. It is present in both\nx32 and x64 bit versions in the installer.\n\nSubfolders to the above (contain the seeded files by torrent)\n\n\\SecurityCache\\cache\\resume\\\n\n\\SecurityCache\\cache\\rules\\\n\n\\SecurityCache\\data\\\n\n\\SecurityCache\\zepplauncher.mif – contains the DHT nodes\n\n\\temp\\\n\n%appdata%\\SYSHashTable\\ – contains folders representing the hashes of visited domains\n\n%appdata%\\SYSHashTable\\SyshashInfo.db – collection of interesting domains found incl. framework info\n\n## Samples (SHA-1)\n\n**Installers:**\n\n2D9AFB96EAFBCFCDD8E1CAFF492BFCF0488E6B8C\n\n3D08D416284E9C9C4FF36F474C9D46F3601652D5\n\n512789C90D76785C061A88A0B92F5F5778E80BAA\n\n735C8A382400C985B85D27C67369EF4E7ED30135\n\n798755794D124D00EAB65653442957614400D71D\n\n4F52A4A5BA897F055393174B3DFCA1D022416B88\n\n8EDFE9667ECFE469BF88A5A5EBBB9A75334A48B9\n\n5B45731C6BBA7359770D99124183E8D80548B64F\n\nC0F8C75110123BEE7DB5CA3503C3F5A50A1A055E\n\nC8A514B0309BCDE73F7E28EB72EB6CB3ABE24FDD\n\nAF1AE760F055120CA658D20A21E4B14244BC047D\n\nA1C515B965FB0DED176A0F38C811E6423D9FFD86\n\nB9067085701B206D2AC180E82D5BC68EDD584A8B\n\n77625ADEA198F6756E5D7C613811A5864E9874EA\n\n**Sathurbot dll:**\n\nF3A265D4209F3E7E6013CA4524E02D19AAC951D9\n\n0EA717E23D70040011BD8BD0BF1FFAAF071DA22C\n\n2381686708174BC5DE2F04704491B331EE9D630B\n\n2B942C57CEE7E2E984EE10F4173F472DB6C15256\n\n2F4FAA5CB5703004CA68865D8D5DACBA35402DE4\n\n4EBC55FDFB4A1DD22E7D329E6EF8C7F27E650B34\n\n0EF3ECD8597CE799715233C8BA52D677E98ABDFD\n\n0307BBAC69C54488C124235449675A0F4B0CCEFA\n\n149518FB8DE56A34B1CA2D66731126CF197958C3\n\n3809C52343A8F3A3597898C9106BA72DB7F6A3CB\n\n4A69B1B1191C9E4BC465F72D76FE45C77A5CB4B0\n\n\n-----\n\n5CCDB41A34ADA906635CE2EE1AB4615A1AFCB2F2\n6C03F7A9F826BB3A75C3946E3EF75BFC19E14683\n8DA0DC48AFB8D2D1E9F485029D1800173774C837\nAC7D8140A8527B8F7EE6788C128AFF4CA92E82C2\nE1286F8AE85EB8BD1B6BE4684E3C9E4B88D300DB\n\n**Additional payloads:**\n\nC439FC24CAFA3C8008FC01B6F4C39F6010CE32B6\nABA9578AB2588758AD34C3955C06CD2765BFDF68\nDFB48B12823E23C52DAE03EE4F7B9B5C9E9FDF92\nFAFF56D95F06FE4DA8ED433985FA2E91B94EE9AD\nB728EB975CF7FDD484FCBCFFE1D75E4F668F842F\n59189ABE0C6C73B66944795A2EF5A2884715772E\nC6BDB2DC6A48136E208279587EFA6A9DD70A3FAA\nBEAA3159DBE46172FC79E8732C00F286B120E720\n5ED0DF92174B62002E6203801A58FE665EF17B76\n70DFABA5F98B5EBC471896B792BBEF4DB4B07C53\n10F92B962D76E938C154DC7CBD7DEFE97498AB1E\n426F9542D0DDA1C0FF8D2F4CB0D74A1594967636\nAA2176834BA49B6A9901013645C84C64478AA931\n1C274E18A8CAD814E0094C63405D461E815D736A\n61384C0F690036E808F5988B5F06FD2D07A87454\nF32D42EF1E5ED221D478CFAA1A76BB2E9E93A0C1\n594E098E9787EB8B7C13243D0EDF6812F34D0FBA\n1AAFEBAA11424B65ED48C68CDEED88F34136B8DC\nBA4F20D1C821B81BC324416324BA7605953D0605\nE08C36B122C5E8E561A4DE733EBB8F6AE3172BF0\n7748115AF04F9FD477041CB40B4C5048464CE43E\n3065C1098B5C3FC15C783CDDE38A14DFA2E005E4\nFA25E212F77A06C0B7A62C6B7C86643660B24DDA\nFADADFFA8F5351794BC5DCABE301157A4A2EBBCF\nB0692A03D79CD2EA7622D3A784A1711ADAABEE8D\n9411991DCF1B4ED9002D9381083DE714866AEA00\n\n## Associated domains\n\n**DNS:**\n\nzeusgreekmaster.xyz\n\napollogreekmaster.xyz\n\n**C&C:**\n\njhkabmasdjm2asdu7gjaysgddasd.xyz\n\nboomboomboomway.xyz\n\nmrslavelemmiwinkstwo.xyz\n\nuromatalieslave.space\n\nnewforceddomainisherenow.club\n\njustanotherforcedomain.xyz\n\nartemisoslave.xyz\n\nasxdq2saxadsdawdq2sasaddfsdfsf4ssfuckk.xyz\n\nkjaskdhkaudhsnkq3uhaksjndkud3asds.xyz\n\nbadaboommail.xyz\n\n**Torrent trackers:**\n\nbadaboomsharetracker.xyz\n\nwebdatasourcetraffic.xyz\n\nsharetorrentsonlinetracker.xyz\n\nwebtrafficsuccess.xyz\n\n\n-----\n\n## Registry values\n\nYou may need to use a third-party tool, as Windows Regedit might not even show these:\n\nHKLM\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\\{variable GUID} =\n“v2.10|Action=Allow|Active=TRUE|Dir=In|Profile=Private|Profile=Public|App=C:\\\\Windows\\\\explorer.exe|Name=Windows\nExplorer|”\n\nHKLM\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules\\{variable GUID} =\n“v2.10|Action=Allow|Active=TRUE|Dir=In|Profile=Private|Profile=Public|App=C:\\\\Windows\\\\system32\\\\rundll32.exe|Name=Windows\nhost process (Rundll32)|”\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers\\0TheftProtectionDll = {GUID1}\nHKLM\\SOFTWARE\\Classes\\CLSID\\{GUID1} = “Windows Theft Protection”\nHKLM\\SOFTWARE\\Classes\\CLSID\\{GUID1}\\InprocServer32 =\n“C:\\\\ProgramData\\\\Microsoft\\\\Performance\\\\TheftProtection\\\\TheftProtection.dll”\nHKLM\\SOFTWARE\\Classes\\CLSID\\{GUID1}\\InprocServer32\\ThreadingModel = “Apartment”\n\nHKLM\\SOFTWARE\\Classes\\CLSID\\{GUID2}\n\nThe {GUID2} entries are variable across samples and have 6 char long subkeys, content is binary type and encrypted – used to\nstore variables, temporary values and settings, IP’s, C&C’s, UID\n\ne.g. {GUID2} entries look like\n\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000003\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000002\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000001\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000009\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000011\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00010001\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00010002\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000008\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000007\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000004\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00000010\nHKLM\\SOFTWARE\\Classes\\CLSID\\{8E577F7E-03C2-47D1-B4C0-BCE085F78F66}\\00020001\n\n6 Apr 2017 - 03:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-06 - Sathurbot- Distributed WordPress password attack.pdf"
    ],
    "report_names": [
        "2017-04-06 - Sathurbot- Distributed WordPress password attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535877,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653761148,
    "ts_modification_date": 1653761148,
    "files": {
        "pdf": "https://archive.orkl.eu/421000c6782935872dc7ffa1b58a266b6d808b51.pdf",
        "text": "https://archive.orkl.eu/421000c6782935872dc7ffa1b58a266b6d808b51.txt",
        "img": "https://archive.orkl.eu/421000c6782935872dc7ffa1b58a266b6d808b51.jpg"
    }
}