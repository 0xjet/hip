{
    "id": "6b953547-972f-4804-8dd3-bea7e81cc8a1",
    "created_at": "2023-01-12T15:05:35.020003Z",
    "updated_at": "2025-03-27T02:06:08.324102Z",
    "deleted_at": null,
    "sha1_hash": "f7088d778396d0c4a83b372f86a8dbebecca36c6",
    "title": "2022-04-13 - ESET takes part in global operation to disrupt Zloader botnets",
    "authors": "",
    "file_creation_date": "2022-05-27T21:49:33Z",
    "file_modification_date": "2022-05-27T21:49:33Z",
    "file_size": 971911,
    "plain_text": "# ESET takes part in global operation to disrupt Zloader botnets\n\n**welivesecurity.com/2022/04/13/eset-takes-part-global-operation-disrupt-zloader-botnets/**\n\nApril 13, 2022\n\nESET researchers provided technical analysis, statistical information, and known command and control server domain names and IP\naddresses\n\n[ESET has collaborated with partners Microsoft’s Digital Crimes Unit, Lumen’s Black Lotus Labs, Palo Alto Networks Unit 42, and others in an](https://blogs.microsoft.com/on-the-issues/?p=65141)\nattempt to disrupt known Zloader botnets. ESET contributed to the project by providing technical analysis, statistical information, and known\ncommand and control server domain names and IP addresses.\n\nZloader started life as a banking trojan, but lately evolved to become a distributor of several malware families, including various ransomware\nfamilies.\n\nThe coordinated disruption operation targeted three specific botnets, each one using a different version of the Zloader malware. ESET\nresearchers helped with identification of 65 domains that had been used by these botnet operators recently and that had been taken over for\nthis disruption operation to be effective. On top of that, Zloader bots rely on a backup communication channel that automatically generates\nunique domain names that can be used to receive commands from their botmasters. This technique, known as a domain generation algorithm\n(DGA), is used to generate 32 different domains per day, per botnet. To make sure that the botnet operators cannot use this side channel to\nregain control of their botnets, an additional 319 already registered domains generated by this algorithm were taken over and the working\ngroup is also taking measures to block registration of DGA domains possibly generated in the future. Microsoft’s investigation also identified\nDenis Malikov as a co-author of a malicious component used by the operators of one of the botnets.\n\n## Background\n\n[Zloader is one of the many banking trojan malware families heavily inspired by the famous Zeus banking trojan, whose source code was](https://zeusmuseum.com/)\nleaked in 2011. Many research papers have been published about this malware already, with the latest one from [Malwarebytes and HYAS](https://www.malwarebytes.com/resources/files/2020/05/the-silent-night-zloader-zbot_final.pdf)\nbeing the most detailed from the technical point of view.\n\nThis blogpost won’t focus on deep technical aspects of the trojan, but rather will cover the details of its operation and infrastructure.\n\nThe first version (1.0.0.0) of Zloader that we were able to find was compiled on November 9 2019, the same day it was announced andth\nadvertised in underground forums under the name “Silent Night”. ESET researchers have been closely monitoring its activity and evolution\never since then, giving us great insight into Zloader’s mode of operation and its infrastructure.\n\nThroughout Zloader’s existence, we have analyzed about 14,000 unique samples via our automatic tracking system, which helped us to\ndiscover more than 1,300 unique C&C servers. In March 2020, Zloader implemented a domain generation algorithm (DGA) that allowed us to\ndiscover about 300 additional active domains registered by Zloader operators and used as C&C servers.\n\n\n-----\n\ne a e see a coup e o pea s oade s popu a ty a o g t eat acto s, a y du g ts st yea o e ste ce, but ts use bega\ndeclining during 2021 with only a couple of actors left using it for their malicious intents. This may, however, change in the future as we have\nalready seen version 2.0 samples in the wild (compiled in July 2021). Our findings show that these were just test builds, but we will be closely\nmonitoring this new activity and its evolution. Due to low prevalence and the nature of this new version, all the following information applies to\nZloader version 1.x.\n\nAs already mentioned, Zloader, similar to other commodity malware, is being advertised and sold on underground forums. When purchased,\naffiliates are given all they need to set up their own servers with administration panels and to start building their bots. Affiliates are then\nresponsible for bot distribution and maintaining their botnets.\n\nAs you can see in Figure 1, we have observed Zloader infestations and campaigns in many countries with North America being the most\ntargeted.\n\n_Figure 1. Worldwide Zloader campaign detection rate (based on data since February 2020)_\n\nZloader has been used by various affiliate groups and each of them has used a different approach for the malware’s distribution, including:\n\nRIG exploit kit\nCOVID-19-themed spam emails with malicious Microsoft Word documents attached\nVariants of a fake invoice spam emails with malicious XLS macros\nMisuse of Google Ads\n\nThe development of the latest distribution methods will be covered in the next sections.\n\n## Zloader internals\n\nZloader has a modular architecture, downloading and utilizing its modules as needed. Supported Zloader modules are displayed in Table 1\nand Table 2.\n\n_Table 1. Overview of malicious modules used by Zloader_\n\n**Malicious modules** **Functionality**\n\nLoader module Loading the core module\n\nCore module (x86) Main functionality for x86 processes\n\nCore module (x64) Main functionality for x64 processes\n\nhvnc32 module Hidden VNC (x86) for remote PC control\n\nhvnc64 module Hidden VNC (x64) for remote PC control\n\n_Table 2. Legitimate tools abused by Zloader to support its malicious tasks_\n\n**Helper modules** **Functionality**\n\nzlib1 dll Used to support AitB (Adversary in the Browser) attacks\n\n\n-----\n\n**Helper modules** **Functionality**\n\nlibssl.dll Used to support AitB attacks\n\ncertutil.exe (+necessary DLL files) Used to support AitB attacks\n\nsqlite3.dll Used for processing browser data\n\nZloader’s first component is a loader that is used to download or load (if already downloaded) the core module. This core module is then\nresponsible for downloading and loading additional modules and performing its own malicious tasks.\n\nZloader’s notable features are:\n\nAbility to steal various data from browsers and Microsoft Outlook, steal cryptocurrency wallets\nKeystroke logging\nHiddenVNC support to allow the operator to remotely control compromised systems\nSupport for Zeus-like webinjects, form grabbing, and form screenshotting\nArbitrary command execution (e.g., download and execute other malware)\n\nAll communication between bots and their C&C servers is performed over HTTP/HTTPS, and regardless of which is used the data is\nencrypted using RC4. Some of the data is additionally encrypted using an XOR-based algorithm known as “Visual Encrypt”. The RC4 key is\nunique for each affiliate as described in the next section. Figure 2 shows a bot’s static configuration. It contains a list of up to ten hardcoded\nC&C URLs along with other important data for communication – such as the botnetID to help the operator easily filter data from different\ncampaigns, the signature for communications verification, etc. A bot’s C&C list can be easily updated by issuing a command from the\noperator’s administration panel if needed.\n\n\n-----\n\n_Figure 2. Zloader’s static configuration_\n\nIf none of the hardcoded servers responds, a Zloader bot can use its DGA as a fallback mechanism. Every day, a list of 32 new domains\nunique for every affiliate is generated based on the current day retrieved by GetLocalTime function. Generated URLs have the format\nhttps://<20_random_lowercase_ASCII_letters>.com/post.php\n\n## Botnet infrastructure and affiliates\n\nThe RC4 encryption key used in botnet communication is unique for every affiliate and tied to the affiliate’s administration panel installation.\nThis uniqueness gives us the opportunity to cluster Zloader samples and track affiliates’ distribution methods and the evolution of their\ncampaigns.\n\nSince the beginning of our tracking, we have observed more than 25 different RC4 keys. It is worth noting that some of these affiliates were\nactive for a very short period — some of them were probably just testing Zloader’s features. It is also possible that some operators just\nredeployed their administration panel installation at some point and continued their operation with a new RC4 key. A timeline of notable\naffiliate activity, as well as various Zloader version release dates, can be seen in Figure 3.\n\n\n-----\n\n_Figure 3. Activity of some of the notable affiliates_\n\nAs can be seen in Figure 5, from October 2020, most Zloader activity was due to only two affiliates. We can distinguish them by their RC4\nkeys – 03d5ae30a0bd934a23b6a7f0756aa504 and dh8f3@3hdf#hsf23\n\nWe cover these two affiliates’ activities in the next two sections.\n\n### dh8f3@3hdf#hsf23\n\nThis affiliate was active under this particular RC4 key starting in June 2020. The first Zloader version it used was 1.3.27.0 and then closely\nfollowed the newest version available up until the latest available Zloader version to this date – 1.8.30.0. However, its activity started to\ndecline in the second half of 2021 and we haven’t seen any new activity of this botnet since late November 2021.\n\nOne of the most interesting activities of this affiliate is that it used Zloader’s ability to deploy arbitrary payloads to distribute malicious payloads\n[to its bots. Most notably, it spread various ransomware families such as DarkSide, as highlighted by this research from Guidepoint Security.](https://www.guidepointsecurity.com/blog/from-zloader-to-darkside-a-ransomware-story)\nHowever, the botmasters did not deploy ransomware to all of their bots; they deployed this type of malware mostly on systems belonging to\ncorporate networks. When installed on a system, Zloader gathers various information about the network its compromised host belongs to.\nThis allows botnet operators to pick specific payloads depending on the victim’s network.\n\nThis affiliate was spreading their malicious Zloader samples mostly through spam emails with malicious documents attached to them. The\nZloader static configuration contains a botnetID, allowing the botmaster to cluster different bots in different sub-botnets. The most prevalent\nbotnetIDs for this affiliate in the last year of its operation were nut and kev.\n\nThis operator was also a bit more security aware compared to other Zloader customers and used a tiered architecture for their C&C servers.\nTypically, a simple proxy script was planted on an often legitimate but compromised website and it was used for tier1 C&C URLs in their bots.\nThis script simply forwards all HTTP/HTTPS traffic from the bot onto the tier2 server, keeping the location of the real administration panel\ninstallation secret.\n\nBesides using Zloader as an entry point for ransomware attacks, this affiliate also used Zloader’s AitB capabilities to steal victim information\nand alter the content of various financial institutions and e-commerce websites based in the USA and Canada.\n\n### 03d5ae30a0bd934a23b6a7f0756aa504\n\nThis affiliate has been using Zloader since its early versions and is still active as of today. Despite the latest available version of Zloader being\n1.8.30.0, this affiliate has stuck with version 1.6.28.0 since its release in October 2020. We can only speculate as to the reasons behind this.\nOne hypothesis is that this affiliate did not pay to extend their support coverage for Zloader and thus does not have access to later versions.\n\nThe operator of this botnet used to depend solely on C&C domains generated by Zloader’s DGA and did not update their bots with a new\nC&C list for more than a year, meaning that all hardcoded C&C servers in their bots were inactive for a long time. This changed in November\n2021 when this affiliate updated their bots with a list of new C&C servers and also updated the static configuration of newly distributed\nbinaries to reflect this change. This effort was probably motivated by the fear of losing access to their botnet should anyone register and\nsinkhole all future DGA-generated domains for this actor.\n\nFigure 4 shows the administration panel login page that was installed directly on the C&C server, hardcoded in the bot’s static configuration.\n\n\n-----\n\n_Figure 4. Administration panel login page_\n\nSome notable botnetIDs used by this operator were: personal, googleaktualizacija and more recently return, 909222, 9092ti and 9092us.\n\nThrough analysis of the webinjects downloaded by the bots in this affiliate botnet, the operator’s interests are very broad. They are apparently\ninterested in gathering victims’ login credentials and other personal data from various financial institution websites (banks, stock trading\nplatforms, etc.), e-commerce sites (such as Amazon, Best Buy, Walmart), cryptocurrency exchanges, and even various online platforms such\nas Google and Microsoft. Particular focus was put on customers of financial institutions from the USA, Canada, Japan, Australia, and\n**Germany.**\n\n[In addition to the login credential harvesting, this affiliate also used Zloader to distribute various malware families such as the Raccoon](https://malpedia.caad.fkie.fraunhofer.de/details/win.raccoon)\ninfostealer .\n\n**_Distribution_**\n\nThis threat actor uses various means to spread Zloader with misusing Google Ads and bogus adult sites being their latest distribution\nmethods of choice.\n\nStarting in October 2020, fake adult sites started to push to their visitors malicious payloads posing as a Java update in an MSI package (with\nfilename JavaPlug-in.msi), supposedly required to watch the requested video. This fake Java update package typically contained a\ndownloader that downloaded Zloader itself as the final payload. Since April 2021, this scheme has been enhanced by adding a script to\ndisable Microsoft Defender to further increase the chances of successfully compromising the system.\n\nIn June 2021, this affiliate also started to promote packages typically used in corporate environments. When internet users searched for a\npopular application to download, such as Zoom or TeamViewer, they might have been presented with a fake download site promoted via a\nGoogle Ad that tried to trick them into downloading a malicious package posing as the app they were searching for. This distribution method\nnot only installed Zloader but could also install other potentially malicious tools, notably if the compromised system was part of an Active\n[Directory domain. Atera Agent and the notorious Cobalt Strike Beacon were seen to be installed in such cases. These tools could grant the](https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike)\nattacker complete control of the compromised system and result in stealing of sensitive company data, installation of other malware such as\nransomware and other malicious activity incurring significant losses for the company.\n\nFigure 5 shows the logic to check whether a system belongs to a domain. As seen below, Cobalt Strike Beacon is installed if the list of the\nsystem’s trusted domains is non-empty.\n\n_Figure 5. PowerShell script responsible for Cobalt Strike Beacon installation_\n\nThe latest iteration of this distribution method relied heavily on the aforementioned Atera Agent, which was usually downloaded from bogus\nadult sites. An example of what a visitor would see is shown in Figure 6.\n\n\n-----\n\n_Figure 6. Fake adult site luring users into downloading Atera remote management tool_\n\nAtera Agent is a legitimate “remote monitoring and management” solution used by IT companies to administer their customers’ systems. One\nof its features – remote script execution – was used in this campaign to deliver Zloader payloads and other malicious helper files. The\npurpose of these helper files was to support the installation process by executing specific tasks such as privilege escalation, execution of\nfurther samples, disabling of Windows Defender, etc.\n\nThese tasks were usually achieved via simple BAT files, but it is worth mentioning that attackers also exploited a known digital signature\nverification vulnerability to use legitimate, signed Windows executable files with malicious VBScripts appended to the end of those files,\nwhere the signature section is located (see Figure 7). For the PE file to remain valid, attackers also need to alter the PE header to alter the\nsignature section length and checksum. This alteration of the file’s content does not revoke the validity of its digital signature during the\nverification process because the modified content is exempted from the verification process. Thus, the file’s new malicious content may\n[therefore stay off the radar. This vulnerability is described, for example, in CVE-2012-0151 or](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0151) [CVE-2013-3900, and also in this blogpost by](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-3900)\n[Check Point Research. Its fix is unfortunately disabled by default in Windows, and therefore, it still can be misused by attackers in a large](https://research.checkpoint.com/2022/can-you-trust-a-files-digital-signature-new-zloader-campaign-exploits-microsofts-signature-verification-putting-users-at-risk/)\nnumber of systems.\n\n_Figure 7. Example of a script appended to the PE file signature section_\n\nIn the recent campaign, a Ursnif trojan was sometimes installed instead of Zloader, showing that this affiliate group does not rely on a single\nmalware family but has more tricks up its sleeve. A typical scenario of this distribution method is displayed in Figure 8.\n\n\n-----\n\n_Figure 8. Typical distribution method using Atera Agent_\n\n## Closing remarks\n\n[We relentlessly continue to track threats that are used to spread ransomware, which is an ongoing threat to internet security. As Zloader is](https://www.welivesecurity.com/wp-content/uploads/2022/02/eset_threat_report_t32021.pdf#T3-2021_Threat-report_final-update.indd%3A.256035%3A2424)\navailable in underground forums, ESET Researchers will monitor any new activity tied to this malware family, following this disruption\noperation against its existing botnets.\n\n_For any inquiries about our research published on WeLiveSecurity, please contact us at threatintel@eset.com._\n_ESET Research now also offers private APT intelligence reports and data feeds. For any inquiries about this service, visit the ESET Threat_\n_Intelligence page._\n\n## IoCs\n\n### Samples\n\n**SHA-1** **Filename** **ESET detection name** **Description**\n\n4858BC02452A266EA3E1A0DD84A31FA050134FB8 9092.dll Win32/Kryptik.HNLQ trojan Zloader return botnet as dow\nhttps://teamworks455[.]com\n\n\n-----\n\n**SHA-1** **Filename** **ESET detection name** **Description**\n\n\nBEAB91A74563DF8049A894D5A2542DD8843553C2 9092.dll\n\nus.dll\n\n\nWin32/Kryptik.HODI trojan Zloader 9092us botnet as d\nhttps://endoftheendi[.]com/u\n\n\n462E242EF2E6BAD389DAB845C68DD41493F91C89 N/A Win32/Spy.Zbot.ADI trojan Unpacked initial loader com\nbotnet.\n\n30D8BA32DAF9E18E9E3CE564FC117A2FAF738405 N/A Win32/Spy.Zbot.ADI trojan Downloaded Zloader main c\n(x86).\n\nBD989516F902C0B4AFF7BCF32DB511452355D7C5 N/A Win64/Spy.Zbot.Q trojan Downloaded Zloader main c\n(x64).\n\nE7D7BE1F1FE04F6708EFB8F0F258471D856F8F8F N/A Win32/Hvnc.AO trojan Downloaded Zloader HVNC\n\n5AA2F377C73A0E73E7E81A606CA35BC07331EF51 N/A Win64/Hvnc.AK trojan Downloaded Zloader HVNC\n\n23D38E876772A4E28F1B8B6AAF03E18C7CFE5757 auto.bat BAT/Agent.PHM trojan Script used by Atera Agent\n\n9D3E6B2F91547D891F0716004358A8952479C14D new.bat BAT/Agent.PHL trojan Script used by Atera Agent\n\n33FD41E6FD2CCF3DFB0FCB90EB7F27E5EAB2A0B3 new1.bat BAT/Shutdown.NKA trojan Script used by Atera Agent\n\n5A4E5EE60CB674B2BFCD583EE3641D7825D78221 new2.bat BAT/Shutdown.NKA trojan Script used by Atera Agent\n\n\n3A80A49EFAAC5D839400E4FB8F803243FB39A513 adminpriv.exe Win64/NSudo.A potentially unsafe\napplication\n\n\nNSudo tool used for privileg\ndistribution scripts.\n\n\nF3B3CF03801527C24F9059F475A9D87E5392DAE9 reboot.dll Win32/Agent.ADUM trojan Signed file exploiting CVE-2\nmalicious script commands.\n\n\nA187D9C0B4BDB4D0B5C1D2BDBCB65090DCEE5D8C TeamViewer.msi Win64/TrojanDownloader.Agent.KY\ntrojan\n\nF4879EB2C159C4E73139D1AC5D5C8862AF8F1719 tvlauncher.exe Win64/TrojanDownloader.Agent.KY\ntrojan\n\n\nMalicious MSI installer cont\nused to deliver Zloader.\n\nDownloader used to deliver\n\n\nE4274681989347FABB22050A5AD14FE66FFDC000 12.exe Win32/Kryptik.HOGN trojan Raccoon infostealer downlo\n\nFA1DB6808D4B4D58DE6F7798A807DD4BEA5B9BF7 racoon.exe Win32/Kryptik.HODI trojan Raccoon infostealer downlo\n\n### Network\n\n**_Domains and URLs used in distribution_**\n\nhttps://endoftheendi[.]com\nhttps://sofftsportal[.]su\nhttps://pornokeyxxx[.]pw\nhttps://porno3xgirls[.]website\nhttps://porno3xgirls[.]space\nhttps://porno3xgirls[.]fun\nhttps://porxnoxxx[.]site\nhttps://porxnoxxx[.]pw\nhttps://pornoxxxguru[.]space\nhttps://helpdesksupport072089339.servicedesk.atera[.]com/GetAgent/Msi/?customerId=1&integratorLogin=izunogg1017@gmail.com\nhttps://helpdesksupport350061558.servicedesk.atera[.]com/GetAgent/Msi/?customerId=1&integratorLogin=Ario.hi@rover.info\nhttps://clouds222[.]com\nhttps://teamworks455[.]com\nhttps://commandaadmin[.]com\nhttps://cmdadminu[.]com\nhttps://checksoftupdate[.]com\nhttps://datalystoy[.]com\nhttps://updatemsicheck[.]com\n\n**_Latest Zloader C&C servers_**\n\nhttps://asdfghdsajkl[.]com/gate.php\nhttps://lkjhgfgsdshja[.]com/gate.php\nhttps://kjdhsasghjds[.]com/gate.php\nhttps://kdjwhqejqwij[.]com/gate.php\nhttps://iasudjghnasd[.]com/gate.php\nhtt //d k j dh [ ] / t h\n\n\n-----\n\nttps //d suaggdj a[ ]co /gate p p\nhttps://eiqwuggejqw[.]com/gate.php\nhttps://dquggwjhdmq[.]com/gate.php\nhttps://djshggadasj[.]com/gate.php\n\n**_URLs used to download arbitrary malware_**\n\nhttps://braves[.]fun/racoon.exe\nhttps://endoftheendi[.]com/12.exe\n\n**_Domains used in recent Zloader’s Webinjects attacks_**\n\nhttps://dotxvcnjlvdajkwerwoh[.]com\nhttps://aerulonoured[.]su\nhttps://rec.kindplanet[.]us\n\n## MITRE ATT&CK techniques\n\n_[This table was built using version 10 of the MITRE ATT&CK framework.](https://attack.mitre.org/resources/versions/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nResource\nDevelopment\n\n\n[T1583.001](https://attack.mitre.org/versions/v10/techniques/T1583/001/) Acquire Infrastructure: Domains Several domains were acquired by\nZloader to support C&C.\n\n\n[T1583.004](https://attack.mitre.org/versions/v10/techniques/T1583/004/) Acquire Infrastructure:\nServer\n\n[T1584.004](https://attack.mitre.org/versions/v10/techniques/T1584/004/) Compromise\nInfrastructure: Server\n\n[T1587.001](https://attack.mitre.org/versions/v10/techniques/T1587/001/) Develop Capabilities:\nMalware\n\n[T1587.002](https://attack.mitre.org/versions/v10/techniques/T1587/002/) Develop Capabilities:\nCode Signing Certificates\n\n[T1587.003](https://attack.mitre.org/versions/v10/techniques/T1587/003/) Develop Capabilities:\nDigital Certificates\n\n[T1588.001](https://attack.mitre.org/versions/v10/techniques/T1588/001/) Obtain Capabilities:\nMalware\n\n\nSeveral servers were used to host Zloader\ninfrastructure.\n\nSome legitimate websites were compromised to\nhost parts of Zloader infrastructure.\n\nZloader is malware targeting users of the\nWindows operating system.\n\nSome of Zloader's distribution methods use\nsigned malicious binaries.\n\nZloader used digital certificates in HTTPS traffic.\n\nVarious malware samples are used to distribute\nZloader or are distributed by Zloader itself.\n\n\n[T1588.002](https://attack.mitre.org/versions/v10/techniques/T1588/002/) Obtain Capabilities: Tool Various legitimate tools and libraries are used to\nsupport Zloader tasks.\n\n\n[T1588.006](https://attack.mitre.org/versions/v10/techniques/T1588/006/) Obtain Capabilities:\nVulnerabilities\n\n\nCVE-2013-3900 is exploited in one of Zloader's\ndistribution methods.\n\n\nInitial Access [T1189](https://attack.mitre.org/versions/v10/techniques/T1189/) Drive-by Compromise Zloader operators use Google Ads and\nfake websites to lure victims into\ndownloading malicious installers.\n\nExecution [T1059.001](https://attack.mitre.org/versions/v10/techniques/T1059/001/) Command and Scripting Interpreter: PowerShell PowerShell commands are used to\nsupport some of Zloader's distribution\nmethods.\n\n\n[T1059.003](https://attack.mitre.org/versions/v10/techniques/T1059/003/) Command and Scripting\nInterpreter: Windows\nCommand Shell\n\n[T1059.005](https://attack.mitre.org/versions/v10/techniques/T1059/005/) Command and Scripting\nInterpreter: Visual Basic\n\n\nBatch files are used to support some of Zloader's\ndistribution methods.\n\nVBScript is used to launch the main Zloader\npayload.\n\n\n[T1106](https://attack.mitre.org/versions/v10/techniques/T1106/) Native API Zloader makes heavy use of dynamic Windows\nAPI resolution.\n\n\n[T1204.001](https://attack.mitre.org/versions/v10/techniques/T1204/001/) User Execution: Malicious\nLink\n\n[T1204.002](https://attack.mitre.org/versions/v10/techniques/T1204/002/) User Execution: Malicious\nFile\n\n[T1047](https://attack.mitre.org/versions/v10/techniques/T1047/) Windows Management\nInstrumentation\n\n\nZloader is commonly distributed through\nmalicious links.\n\nZloader is commonly distributed via malicious\nMSI installers.\n\nZloader uses WMI to gather various system\ninformation.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nPersistence [T1547.001](https://attack.mitre.org/versions/v10/techniques/T1547/001/) Boot or Logon Autostart Execution: Registry Run\nKeys / Startup Folder\n\n\nZloader uses registry run key to establish\npersistence.\n\nSeveral methods are used to bypass UAC\nmechanisms during Zloader's deployment.\n\n\nPrivilege\nEscalation\n\nDefense\nEvasion\n\n\n[T1548.002](https://attack.mitre.org/versions/v10/techniques/T1548/002/) Abuse Elevation Control Mechanism: Bypass\nUser Account Control\n\n\n[T1055.001](https://attack.mitre.org/versions/v10/techniques/T1055/001/) Process Injection: Dynamic-link Library Injection Zloader injects its modules into several\nprocesses.\n\n\n[T1140](https://attack.mitre.org/versions/v10/techniques/T1140/) Deobfuscate/Decode Files\nor Information\n\n[T1562.001](https://attack.mitre.org/versions/v10/techniques/T1562/001/) Impair Defenses: Disable\nor Modify Tools\n\n[T1070.004](https://attack.mitre.org/versions/v10/techniques/T1070/004/) Indicator Removal on\nHost: File Deletion\n\n[T1036.001](https://attack.mitre.org/versions/v10/techniques/T1036/001/) Masquerading: Invalid\nCode Signature\n\n[T1036.005](https://attack.mitre.org/versions/v10/techniques/T1036/005/) Masquerading: Match\nLegitimate Name or\nLocation\n\n[T1027.002](https://attack.mitre.org/versions/v10/techniques/T1027/002/) Obfuscated Files or\nInformation: Software\nPacking\n\n[T1553.004](https://attack.mitre.org/versions/v10/techniques/T1553/004/) Subvert Trust Controls:\nInstall Root Certificate\n\n\nZloader stores its modules in an encrypted form\nto hide their presence.\n\nSome distribution methods disable Windows\nDefender prior to the installation of Zloader.\n\nSome components of Zloader or its distribution\nmethod are removed after successful installation.\n\nSome of the Zloader installers have been signed\nusing invalid certificates to make them seem\nmore legitimate.\n\nSome of the Zloader installers mimic names of\nlegitimate applications.\n\nZloader’s code is obfuscated and its payload is\nusually packed.\n\nZloader installs browser certificates are installed\nto support AitB attack.\n\n\nCredential\nAccess\n\n\n[T1557](https://attack.mitre.org/versions/v10/techniques/T1557/) Adversary-in-the-Middle Zloader leverages AitB techniques to\nintercept selected HTTP/HTTPS traffic.\n\n\n[T1555.003](https://attack.mitre.org/versions/v10/techniques/T1555/003/) Credentials from\nPassword Stores:\nCredentials from Web\nBrowsers\n\n\nZloader can gather saved credentials from\nbrowsers.\n\n\n[T1056.001](https://attack.mitre.org/versions/v10/techniques/T1056/001/) Input Capture: Keylogging Zloader can capture keystrokes and send them to\nits C&C server.\n\n\n[T1539](https://attack.mitre.org/versions/v10/techniques/T1539/) Steal Web Session\nCookie\n\n\nZloader can gather cookies saved by browsers.\n\n\nDiscovery [T1482](https://attack.mitre.org/versions/v10/techniques/T1482/) Domain Trust Discovery Zloader gathers information about domain\ntrust relationships.\n\n\n[T1083](https://attack.mitre.org/versions/v10/techniques/T1083/) File and Directory\nDiscovery\n\n\nZloader can search for various documents and\ncryptocurrency wallets.\n\n\n[T1057](https://attack.mitre.org/versions/v10/techniques/T1057/) Process Discovery Zloader enumerates running processes.\n\n[T1012](https://attack.mitre.org/versions/v10/techniques/T1012/) Query Registry Zloader queries registry keys to gather various\nsystem information.\n\n\n[T1518.001](https://attack.mitre.org/versions/v10/techniques/T1518/001/) Software Discovery:\nSecurity Software\nDiscovery\n\n[T1082](https://attack.mitre.org/versions/v10/techniques/T1082/) System Information\nDiscovery\n\n[T1016](https://attack.mitre.org/versions/v10/techniques/T1016/) System Network\nConfiguration Discovery\n\n[T1033](https://attack.mitre.org/versions/v10/techniques/T1033/) System Owner/User\nDiscovery\n\n\nZloader uses a WMI command to discover\ninstalled security software.\n\nZloader gathers various system information and\nsends it to its C&C.\n\nZloader gathers network interface information\nand sends to the C&C.\n\nZloader uses the victim's username to generate a\nbotID to identify a system in a botnet.\n\n\n[T1124](https://attack.mitre.org/versions/v10/techniques/T1124/) System Time Discovery Zloader gathers Information about the system’s\ntime zone and sends it to the C&C.\n\nCollection [T1560.003](https://attack.mitre.org/versions/v10/techniques/T1560/003/) Archive Collected Data: Archive via Custom\nMethod\n\n\nZloader uses RC4 and XOR to encrypt\ndata before sending them to the C&C.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1005](https://attack.mitre.org/versions/v10/techniques/T1005/) Data from Local System Zloader can collect documents and\ncryptocurrency wallets.\n\n\n[T1074.001](https://attack.mitre.org/versions/v10/techniques/T1074/001/) Data Staged: Local Data\nStaging\n\n\nZloader saves its collected data to file prior to\nexfiltration.\n\n\n[T1113](https://attack.mitre.org/versions/v10/techniques/T1113/) Screen Capture Zloader has the ability to create screenshots of\nwindows of interest.\n\n\nCommand\nand Control\n\n\n[T1071.001](https://attack.mitre.org/versions/v10/techniques/T1071/001/) Application Layer Protocol: Web Protocols Zloader uses HTTP/HTTPS for C&C\ncommunication.\n\n\n[T1568.002](https://attack.mitre.org/versions/v10/techniques/T1568/002/) Dynamic Resolution:\nDomain Generation\nAlgorithms\n\n[T1573.001](https://attack.mitre.org/versions/v10/techniques/T1573/001/) Encrypted Channel:\nSymmetric Cryptography\n\n\nZloader uses a DGA as a fallback in samples\nsince 2020-03.\n\nZloader uses RC4 for C&C traffic encryption.\nSome of the data is additionally XOR encrypted.\n\n\n[T1008](https://attack.mitre.org/versions/v10/techniques/T1008/) Fallback Channels Multiple C&C servers are usually present in\nZloader configurations to avoid relying on just\none. A DGA is also implemented.\n\n[T1219](https://attack.mitre.org/versions/v10/techniques/T1219/) Remote Access Software Zloader uses a HiddenVNC module is used to\nsupport remote access.\n\nExfiltration [T1041](https://attack.mitre.org/versions/v10/techniques/T1041/) Exfiltration Over C2 Channel Zloader exfiltrates gathered data over its\nC&C communication.\n\nImpact [T1490](https://attack.mitre.org/versions/v10/techniques/T1490/) Inhibit System Recovery Some of the Zloader distribution methods\ndisable Windows recovery function\nthrough bcdedit.exe.\n\n[T1489](https://attack.mitre.org/versions/v10/techniques/T1489/) Service Stop Some of the Zloader distribution methods disable\nthe Windows Defender service.\n\n[T1529](https://attack.mitre.org/versions/v10/techniques/T1529/) System Shutdown/Reboot Some of the Zloader distribution methods shut\ndown the system after the initial compromise.\n\n13 Apr 2022 - 06:00PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-13 - ESET takes part in global operation to disrupt Zloader botnets.pdf"
    ],
    "report_names": [
        "2022-04-13 - ESET takes part in global operation to disrupt Zloader botnets.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535935,
    "ts_updated_at": 1743041168,
    "ts_creation_date": 1653688173,
    "ts_modification_date": 1653688173,
    "files": {
        "pdf": "https://archive.orkl.eu/f7088d778396d0c4a83b372f86a8dbebecca36c6.pdf",
        "text": "https://archive.orkl.eu/f7088d778396d0c4a83b372f86a8dbebecca36c6.txt",
        "img": "https://archive.orkl.eu/f7088d778396d0c4a83b372f86a8dbebecca36c6.jpg"
    }
}