{
    "id": "b0fd5285-d47f-4338-8178-e959da56cd08",
    "created_at": "2022-10-25T16:48:19.757457Z",
    "updated_at": "2025-03-27T02:15:45.354473Z",
    "deleted_at": null,
    "sha1_hash": "2e7bfba595146d0274eaf32479cb7ea8eebda153",
    "title": "Threat Group-3390 Targets Organizations for Cyberespionage | Dell SecureWorks",
    "authors": "",
    "file_creation_date": "2015-10-31T11:55:55Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 640996,
    "plain_text": "### Managed Security\n\n Consulting\n\n Compliance\n\n Incident Response\n\n Intelligence\n\n Resources\n\n Company\n\n\n### Search Dell SecureWorks Search\n\n\n# Intelligence Home Intelligence Threat Analyses Threat Group-3390 Targets Organizations for\n\n**Cyberespionage**\n\n\n#### Advisories\n\n CTU Research Team\n\n Cyber Security Index\n\n Global Threat Intelligence\n\n Targeted Threat Intelligence\n\n Borderless Threat Monitoring\n\n Malware Code Analysis\n\n Research Blog\n\n Security Tools\n\n Threat Analyses\n\n Advanced Threat Resource Center\n\n Advanced Threat Services\n\n Advanced Persistent Threats\n\n\n## Threat Group-3390 Targets Organizations for Cyberespionage\n\n**Author: Dell SecureWorks Counter Threat Unit™ Threat Intelligence**\n\n**Date: 05 August 2015**\n\n**URL:** **www.secureworks.com/cyber-threat-intelligence/threats/threat-group-**\n**3390-targets-organizations-for-cyberespionage**\n\n**Summary**\n\n**Dell SecureWorks Counter Threat Unit(TM) (CTU) researchers investigated activities associated with**\n**Threat Group-3390[1] (TG-3390). Analysis of TG-3390's operations, targeting, and tools led CTU**\n**researchers to assess with moderate confidence the group is located in the People's Republic of**\n**China. The threat actors target a wide range of organizations: CTU researchers have observed TG-**\n**3390 actors obtaining confidential data on defense manufacturing projects, but also targeting other**\n**industry verticals and attacking organizations involved in international relations. The group**\n**extensively uses long-running strategic web compromises[2] (SWCs), and relies on whitelists to**\n**deliver payloads to select victims. In comparison to other threat groups, TG-3390 is notable for its**\n**tendency to compromise Microsoft Exchange servers using a custom backdoor and credential logger.**\n\n**CTU researchers divided the** **[threat intelligence about TG-3390 into two sections: strategic and](https://www.gartner.com/doc/2487216/definition-threat-intelligence)**\n**tactical. Strategic threat intelligence includes an assessment of the ongoing threat posed by the**\n**threat group. Executives can use this assessment to determine how to reduce risk to their**\n**organization's mission and critical assets. Tactical threat intelligence is based on incident response**\n**investigations and research, and is mapped to the kill chain. Computer network defenders can use**\n**this information to reduce the time and effort associated with responding to TG-3390.**\n\n**_Key points_**\n\n**Explanations of how CTU researchers identify attribution and gauge confidence levels are available**\n**in the Appendix A.**\n\n**CTU researchers assess with moderate confidence that TG-3390 is based in the**\n**People's Republic of China.**\n\n**CTU researchers have evidence that the threat group compromised U.S. and UK**\n**organizations in the following verticals: manufacturing (specifically aerospace**\n**(including defense contractors), automotive, technology, energy, and**\n**pharmaceuticals), education, and legal, as well as organizations focused on**\n**international relations. Based on analysis of the group's SWCs, TG-3390**\n**operations likely affect organizations in other countries and verticals.**\n\n**TG-3390 operates a broad and long-running campaign of SWCs and has**\n**compromised approximately 100 websites as of this publication. Through an IP**\n**address whitelisting process, the threat group selectively targets visitors to these**\n**websites.**\n\n**After the initial compromise, TG-3390 delivers the HttpBrowser backdoor to its**\n**victims. The threat actors then move quickly to compromise Microsoft Exchange**\n**servers and to gain complete control of the target environment.**\n\n**The threat actors are adept at identifying key data stores and selectively**\n**exfiltrating all of the high-value information associated with their goal.**\n\n**CTU researchers recommend the following practices to prevent or detect TG-3390**\n**intrusions:**\n\n**Search web log files for evidence of web server scanning using the URIs**\n**listed in the Exploitation section and evidence of exfiltration using the**\n**User-Agent in the Actions on objective section.**\n\n**Require two-factor authentication for all remote access solutions,**\n**including OWA.**\n\n**Audit ISAPI filters and search for web shells on Microsoft Exchange**\n**servers.**\n\n**i** **h** **i** **lli**\n\n\n**N** **E** **X** **T** **S** **T** **E** **P**\n\n**CALL US TODAY**\n**(877) 838-7947**\n**UK +44 131 260 3044**\n\n**S** **M** **B** **S** **O** **L** **U** **T**\n\n**[Incident Response](http://www.secureworks.com/assets/pdf-store/datasheets/datasheet-incident-response-for-smb.pdf)**\n\n**[Download the datasheet](http://www.secureworks.com/assets/pdf-store/datasheets/Datasheet_-_Threat_Intelligence_-_July_22_2013.pdf)**\n\n**O** **N** **L** **I** **N** **E** **T** **O**\n\n**[Print this Page](javascript:print();)**\n\n**Share This Resource**\n\n**50**\n\n#### H a v e a s s p e c i a l i s\n\n***First Name:**\n\n***Last Name:**\n\n***Company:**\n\n***Telephone:**\n\n***Email:**\n\n***Country:**\n\n**Select Country**\n\n***State/Province:**\n\n**Select State**\n\n***Job Department:**\n\n**Please Select One**\n\n***Job Level:**\n\n**Please Select One**\n\n***Industry:**\n\n**Please Select One**\n\n***What is the biggest security challenge**\n\n**your organization is currently facing?**\n\n**Please Select One**\n\n**Questions/Comments:**\n\n#### Send Request\n\n**_By completing this form you'll be opting in_**\n\n\n**50**\n\n\n-----\n\n**D** **O** **W** **N** **L** **O** **A** **D** **E**\n\n\n**Article: Threat Group-3390 Targets**\n**Organizations for Cyberespionage**\n\n\n**_Figure 1. Threat is based on a threat group's intent and capability. (Source: Dell SecureWorks)_**\n\n**_Intent_**\n\n**CTU researchers infer intent by aggregating observations, analyzing a threat group's activity, and**\n**placing the information in a wider context.**\n\n**Like many threat groups, TG-3390 conducts strategic web compromises (SWCs), also known as**\n**watering hole attacks, on websites associated with the target organization's vertical or demographic**\n**to increase the likelihood of finding victims with relevant information. CTU researchers assess with**\n**high confidence that TG-3390 uses information gathered from prior reconnaissance activities to**\n**selectively compromise users who visit websites under its control. Most websites compromised by**\n**TG-3390 actors are affiliated with five types of organizations around the world:**\n\n**large manufacturing companies, particularly those supplying defense**\n**organizations**\n\n**energy companies**\n\n**embassies in Washington, DC representing countries in the Middle East, Europe,**\n**and Asia, likely to target U.S.-based users involved in international relations**\n\n**non-governmental organizations (NGOs), particularly those focused on**\n**international relations and defense**\n\n**government organizations**\n\n**Based on this information, CTU researchers assess that TG-3390 aims to collect defense technology**\n**and capability intelligence, other industrial intelligence, and political intelligence from governments**\n**and NGOs.**\n\n**_Attribution_**\n\n**To assess attribution, CTU researchers analyze observed activity, third-party reporting, and**\n**contextual intelligence. For the following reasons, CTU researchers assess with moderate confidence**\n**that TG-3390 has a Chinese nexus:**\n\n**The SWC of a Uyghur cultural website suggests intent to target the Uyghur ethnic**\n**group, a Muslim minority group primarily found in the Xinjiang region of China.**\n**Threat groups outside of China are unlikely to target the Uyghur people.**\n\n**TG-3390 uses the PlugX remote access tool. The menus for PlugX's server-side**\n**component are written exclusively in Standard Chinese (Mandarin), suggesting**\n**that PlugX operators are familiar with this language.**\n\n**CTU researchers have observed TG-3390 activity between 04:00 and 09:00 UTC,**\n**which is 12:00 to 17:00 local time in China (UTC +8). The timeframe maps to the**\n**second half of the workday in China.**\n\n**The threat actors have used the Baidu search engine, which is only available in**\n**Chinese, to conduct reconnaissance activities.**\n\n**CTU researchers have observed the threat group obtaining information about**\n**specific U.S. defense projects that would be desirable to those operating within a**\n**country with a manufacturing base, an interest in U.S. military capability, or both.**\n\n**CTU researchers recognize that the evidence supporting this attribution is circumstantial. It is**\n**possible that TG-3390 is false-flag operation by a threat group outside of China that is deliberately**\n**planting indications of a Chinese origin.**\n\n**_Capability_**\n\n**To assess a threat group's capability, CTU researchers analyze its resources, technical proficiency,**\n**and tradecraft.**\n\n**_Resources_**\n\n**TG-3390 has access to proprietary tools, some of which are used exclusively by TG-3390 and others**\n**that are shared among a few Chinese threat groups. The complexity and continual development of**\n**these tools indicates a mature development process. TG-3390 can quickly leverage compromised**\n**network infrastructure during an operation and can conduct simultaneous intrusions into multiple**\n**environments. This ability is further demonstrated by analysis of interactions between TG-3390**\n**operators and a target environment. CTU researchers found no evidence of multiple operators**\n**working simultaneously against a single organization. This efficiency of operation (a 1:1 ratio of**\n**operator to observed activity) suggests that TG-3390 can scale to conduct the maximum number of**\n**simultaneous operations. These characteristics suggest that the threat group is well resourced and**\n**has access to a tools development team and a team focused on SWCs.**\n\n**_Technical proficiency_**\n\n**TG-3390's obfuscation techniques in SWCs complicate detection of malicious web traffic redirects.**\n**Malware used by the threat group can be configured to bypass network-based detection; however,**\n**the threat actors rarely modify host-based configuration settings when deploying payloads. CTU**\n**researchers have observed the threat actors installing a credential logger and backdoor on Microsoft**\n**[Exchange servers, which requires a technical grasp of Internet Information Services (IIS). TG-3390](http://en.wikipedia.org/wiki/Internet_Information_Services)**\n**uses older exploits to compromise targets, and CTU researchers have not observed the threat actors**\n**using zero-day exploits as of this publication. The threat actors demonstrated the ability to adapt**\n**when reentering a network after an eviction, overcoming technical barriers constructed by network**\n**defenders.**\n\n**_Tradecraft_**\n\n**In addition to using SWCs to target specific types of organizations, TG-3390 uses spearphishing**\n**emails to target specific victims. CTU researchers assess with high confidence that the threat actors**\n**follow an established playbook during an intrusion. They quickly move away from their initial access**\n**vector to hide their entry point and then target Exchange servers as a new access vector As of this**\n\n\n-----\n\n**y** **y** **,** **p** **p** **j**\n**by the target organization, indicating that they successfully obtained the information they sought.**\n**Data exfiltration occurred almost four weeks after the initial compromise and continued for two**\n**weeks (see Figure 2).**\n\n**_Figure 2. Data exfiltration timeline. (Source: Dell SecureWorks)_**\n\n**Note: The adversary's end goal is to exfiltrate, not infiltrate. Organizations often miss multiple**\n**opportunities to detect and disrupt the threat actors before they can achieve their objective.**\n**Alerts for credential theft tools and privileged account lockouts should be investigated.**\n\n**Tactical threat intelligence**\n\n**_Known tools_**\n\n**CTU researchers have observed TG-3390 actors using tools that are favored by multiple threat**\n**groups:**\n\n**PlugX — A remote access tool notable for communications that may contain HTTP**\n**headers starting with \"X-\" (e.g., \"X-Session: 0\"). Its presence on a compromised**\n**system allows a threat actor to execute a wide variety of commands, including**\n**uploading and downloading files, and spawning a reverse shell. The malware can**\n**be configured to use multiple network protocols to avoid network-based detection.**\n**DLL side loading is often used to maintain persistence on the compromised**\n**system.**\n\n**HttpBrowser (also known as TokenControl) — A backdoor notable for HTTPS**\n**communications with the HttpBrowser/1.0 User-Agent (see Figure 3).**\n**HttpBrowser's executable code may be obfuscated through structured exception**\n**handling and return-oriented programming. Its presence on a compromised**\n**system allows a threat actor to spawn a reverse shell, upload or download files,**\n**and capture keystrokes. Antivirus detection for HttpBrowser is extremely low and**\n**is typically based upon heuristic signatures. DLL side loading has been used to**\n**maintain persistence on the compromised system. More information about**\n**HttpBrowser is available in Appendix B.**\n\n**_Figure 3. HttpBrowser URI. (Source: Dell SecureWorks)_**\n\n**ChinaChopper web shell — A web-based executable script (see Figure 4) that**\n**allows a threat actor to execute commands on the compromised system. The**\n**server-side component provides a simple graphical user interface for threat actors**\n**interacting with web shells.**\n\n**_Figure 4. ChinaChopper web shell. (Source: Dell SecureWorks)_**\n\n**Passwords, like \"admin-na-google123!@#\" shown in Figure 4, are required to**\n**interact with the web shell. TG-3390 has used additional web shells containing**\n**similarly formatted passwords.**\n\n**Hunter — A web application scanning tool written by @tojen to identify**\n**vulnerabilities in Apache Tomcat, Red Hat JBoss Middleware, and Adobe**\n**ColdFusion (see Figure 5). It can also identify open ports, collect web banners,**\n**and download secondary files.**\n\n**_Figure 5. Hunter usage. (Source: Dell SecureWorks)_**\n\n**The following tools appear to be exclusive to TG-3390:**\n\n**OwaAuth web shell — A web shell and credential stealer deployed to Microsoft**\n**Exchange servers. It is installed as an ISAPI filter. Captured credentials are DES-**\n**encrypted using the password \"12345678\" and are written to the log.txt file in**\n**the root directory. Like the ChinaChopper web shell, the OwaAuth web shell**\n**requires a password. However, the OwaAuth web shell password contains the**\n**victim organization's name. More information about the OwaAuth web shell is**\n**available in Appendix C.**\n\n**ASPXTool — A modified version of the ASPXSpy web shell (see Figure 6). It is**\n**deployed to internally accessible servers running Internet Information Services**\n**(IIS).**\n\n\n-----\n\n**_Figure 6. ASPXTool web shell. (Source: Dell SecureWorks)_**\n\n**TG-3390 actors have also used the following publicly available tools:**\n\n**Windows Credential Editor (WCE) — obtains passwords from memory**\n\n**gsecdump — obtains passwords from memory**\n\n**winrar — compresses data for exfiltration**\n\n**nbtscan — scans NetBIOS name servers**\n\n**_Tactics, techniques, and procedures_**\n\n**Incident response engagements have given CTU researchers insight into the tactics TG-3390**\n**employs during intrusions.**\n\n**_Reconnaissance_**\n\n**CTU researchers have not observed TG-3390 actors performing reconnaissance prior to**\n**compromising organizations. As discussed in the Actions on objectives section, the threat actors**\n**appear to wait until they have established a foothold.**\n\n**_Development_**\n\n**TG-3390 actors use command and control (C2) domains for extended periods of time but frequently**\n**change the domains' IP addresses. The new IP addresses are typically on the same subnet as the**\n**previous ones.**\n\n**TG-3390 is capable of using a C2 infrastructure that spans multiple networks and registrars. The**\n**most common registrar used by the adversary is HiChina Zhicheng Technology Ltd. The threat actors**\n**have a demonstrated ability to move from one network provider to another, using some**\n**infrastructure for extended periods of time and other domains for only a few days. Seemingly**\n**random activity patterns in infrastructure deployment and usage, along with the ability to use a**\n**wide variety of geographically diverse infrastructure, help the threat actors avoid detection.**\n\n**TG-3390 SWCs may be largely geographically independent, but the group's most frequently used C2**\n**registrars and IP net blocks are located in the U.S. Using a U.S.-based C2 infrastructure (see Figure**\n**7) to compromise targets in the U.S. helps TG-3390 actors avoid geo-blocking and geo-flagging**\n**measures used in network defense.**\n\n**_Figure 7. Geolocation of TG-3390 infrastructure observed by CTU researchers. The dark green_**\n**_signifies a high count of C2 registrars and IP net blocks, while the light green represents a smaller_**\n**_count. (Source: Dell SecureWorks)_**\n\n**The threat actors create PlugX DLL stub loaders that will run only after a specific date. The compile**\n**dates of the samples analyzed by CTU researchers are all later than the hard-coded August 8, 2013**\n**date, indicating that the code might be reused from previous tools.**\n\n**The OwaAuth web shell is likely created with a builder, given that the PE compile time of the binary**\n**does not change between instances and the configuration fields are padded to a specific size. The**\n**adversaries modify publicly available tools such as ASPXSpy to remove identifying characteristics**\n**that network defenders use to identify web shells.**\n\n**_Weaponization_**\n\n**As of this publication, CTU researchers are unsure if TG-3390 relies on weaponizers to package tools**\n**and exploits.**\n\n**_Delivery_**\n\n**TG-3390 conducts SWCs or sends spearphishing emails with ZIP archive attachments. The ZIP**\n**archives have names relevant to the targets and contain both legitimate files and malware. One**\n**archive sample analyzed by CTU researchers contained a legitimate PDF file, a benign image of**\n**interest to targets (see Figure 8), and an HttpBrowser installer disguised as an image file.**\n\n\n-----\n\n**_Figure 9. SWC code. (Source: Dell SecureWorks)_**\n\n**As shown in Figure 10, the** **[unpacked JavaScript code reveals an iframe pointing to an IP address](http://dean.edwards.name/unpacker/)**\n**that is hosting the exploit.**\n\n**_Figure 10. Unpacked JavaScript code. (Source: Dell SecureWorks)_**\n\n**Both the redirect code on the compromised site and the exploit code appear and disappear,**\n**indicating that the adversaries add the code when they want to leverage the SWC and remove the**\n**code when it is not in use to limit the visibility of their operations. The threat actors have evolved to**\n**whitelisting IP addresses and only delivering the exploit and payload to specific targets of interest.**\n**CTU researchers have observed TG-3390 compromising a target organization's externally and**\n**internally accessible assets, such as an OWA server, and adding redirect code to point internal users**\n**to an external website that hosts an exploit and delivers malware.**\n\n**_Exploitation_**\n\n**TG-3390 actors have used Java exploits in their SWCs. In particular, the threat actors have exploited**\n**[CVE-2011-3544, a vulnerability in the Java Runtime Environment, to deliver the HttpBrowser](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-3544)**\n**[backdoor; and CVE-2010-0738, a vulnerability in JBoss, to compromise internally and externally](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-0738)**\n**accessible assets used to redirect users' web browsers to exploit code.**\n\n**In activity analyzed by CTU researchers, TG-3390 executed the Hunter web application scanning**\n**tool against a target server running IIS. Hunter queried the following URIs in a specific order to**\n**determine if the associated software configurations are insecure, and all queries contained the**\n**HttpClient User-Agent:**\n\n**GET /manager/html/ — Tomcat web application manager**\n\n**GET /jmx-console/ — JBoss configuration**\n\n**GET /CFIDE/administrator/login.cfm — ColdFusion configuration**\n\n**_Installation_**\n\n**TG-3390 uses DLL side loading, a technique that involves running a legitimate, typically digitally**\n**signed, program that loads a malicious DLL. CTU researchers have observed the threat actors**\n**employing legitimate Kaspersky antivirus variants in analyzed samples. The DLL acts as a stub**\n**loader, which loads and executes the shell code. The adversaries have used this technique to allow**\n**PlugX and HttpBrowser to persist on a system.**\n\n**Note: DLL side loading is a prevalent persistence technique that is used to launch a multitude of**\n**backdoors. The challenge is detecting known good software loading and running malware. As**\n**security controls have improved, DLL side loading has evolved to load a payload stored in a**\n**different directory or from a registry value.**\n\n**In other cases, threat actors placed web shells on externally accessible servers, sometimes behind a**\n**reverse proxy, to execute commands on the compromised system. TG-3390 actors have deployed**\n**the OwaAuth web shell to Exchange servers, disguising it as an ISAPI filter. The IIS w3wp.exe**\n**process loads the malicious DLL, which CTU researchers have observed in the Program**\n**Files\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Bin directory.**\n\n**_Command and control_**\n\n**To traverse the firewall, C2 traffic for most TG-3390 tools occurs over ports 53, 80, and 443. The**\n**PlugX malware can be configured to use HTTP, DNS, raw TCP, or UDP to avoid network-based**\n**detection. In one sample analyzed by CTU researchers, PlugX was configured with hard-coded user**\n**credentials to bypass a proxy that required authentication. Newer HttpBrowser versions use SSL**\n**with self-signed certificates to encrypt network communications.**\n\n**TG-3390 actors frequently change the C2 domain's A record to point to the loopback IP address**\n**127.0.0.1, which is a variation of a technique known as \"parking.\" Other variations of parking point**\n**the IP address to Google's recursive name server 8.8.8.8, an address belonging to Confluence, or to**\n**other non-routable addresses. When the adversaries' operations are live, they modify the record**\n**again to point the C2 domain to an IP address they can access. A domain name parking example is**\n**available in Appendix D.**\n\n**_Actions on objective_**\n\n**CTU researchers have discovered numerous details about TG-3390 operations, including how the**\n**adversaries explore a network, move laterally, and exfiltrate data. As shown in Figure 11, after**\n**compromising an initial victim's system (patient 0), the threat actors use the Baidu search engine to**\n**search for the victim's organization name. They then identify the Exchange server and attempt to**\n**install the OwaAuth web shell. If the OwaAuth web shell is ineffective because the victim uses two-**\n**factor authentication for webmail, the adversaries identify other externally accessible servers and**\n**deploy ChinaChopper web shells. Within six hours of entering the environment, the threat actors**\n**compromised multiple systems and stole credentials for the entire domain.**\n\n**_Figure 11 Timeline in Eastern Time of TG-3390's initial entry into a victim's network (Source: Dell_**\n\n\n-----\n\n**g** **y**\n\n**_Figure 12. nbtscan batch script (renamed ipcan.exe) used to profile network. (Source: Dell_**\n**_SecureWorks)_**\n\n**Over a few days' span, the threat actors install remote access tools on additional systems based**\n**upon the results of the network reconnaissance. They use At.exe to schedule tasks to run self-**\n**extracting RAR archives, which install either HttpBrowser or PlugX. CTU researchers observed the**\n**threat actors collecting Cisco VPN profiles to use when accessing the victim's network via VPN (see**\n**Figure 13).**\n\n**_Figure 13. Copying of .pcf files. (Source: Dell SecureWorks)_**\n\n**To facilitate lateral movement, the adversaries deploy ASPXTool web shells to internally accessible**\n**systems running IIS.**\n\n**CTU researchers have observed the threat actors encrypting data using the password \"admin-**\n**windows2014\" and splitting the RAR archives into parts in the recycler directory, with the same**\n**name as the uncompressed data (see Figure 14).**\n\n**_Figure 14. Batch script used to archive data. (Source: Dell SecureWorks)_**\n\n**The number at the end of the password corresponds to the year of the intrusion. For example, the**\n**password \"admin-windows2014\" shown in Figure 14 was changed to \"admin-windows2015\" for TG-**\n**3390 intrusions conducted in 2015.**\n\n**Note: CTU researchers frequently observe threat actors renaming archiving tools and storing data**\n**for exfiltration in uncommon directories. In some instances, adversaries exceed disk space limits**\n**during the exfiltration process, requiring the staging of archives on multiple systems. Unexplained**\n**disk quota alerts on typically underutilized systems warrants immediate investigation.**\n\n**Another batch script run by a scheduled task renames the archives on the file server (see Figure**\n**15).**\n\n**_Figure 15. Batch script used to rename exfiltrated data. (Source: Dell SecureWorks)_**\n\n**CTU researchers have observed TG-3390 actors staging RAR archives, renamed with a .zip file**\n**extension, on externally accessible web servers. The adversaries then issue HTTP GET requests,**\n**sometimes with the User-Agent MINIXL, to exfiltrate the archive parts from the victim's network**\n**(see Figure 16).**\n\n**_Figure 16. Example GET request from IIS log. (Source: Dell SecureWorks)_**\n\n**In other intrusions, data was exfiltrated using the PlugX remote access tool. Figure 17 shows**\n**network data transfer sizes for a month-long period beginning with TG-3390's re-entry into a**\n**network. Approximately 300 GB of data was exfiltrated during that span.**\n\n**_Figure 17. Network data transfer sizes to C2 servers after TG-3390 reentry into a network. (Source:_**\n**_Dell SecureWorks)_**\n\n**_CTU observations_**\n\n**Figure 18 is a UTC time wheel depicting which hours the threat actors actively operated in one**\n**target environment during a three-day intrusion observed by CTU researchers. The concentric bands**\n**represent the days of the week, with Saturday as the outside band and Sunday as the innermost**\n**band, and each cell represents an hour. The darker the cell color, the higher the activity level; white**\n**indicates no observed activity. TG-3390 was most active between 04:00 and 09:00 UTC.**\n\n\n-----\n\n**_Figure 18. Mapping of TG-3390's interactions with web shells during an intrusion responded to by_**\n**_CTU researchers. The legend across the bottom of the figure lists the upper bound of interactions_**\n**_that are represented by each color variation on the wheel. Times are based on UTC. (Source: Dell_**\n**_SecureWorks)_**\n\n**_Response to eviction_**\n\n**Successfully evicting TG-3390 from an environment requires a coordinated plan to remove all access**\n**points, including remote access tools and web shells. Within weeks of eviction, the threat actors**\n**attempt to access their ChinaChopper web shells from previously used IP addresses. Finding the**\n**web shells inaccessible, the adversaries search google.co.jp for remote access solutions. CTU**\n**researchers discovered the threat actors searching for \"[company] login,\" which directed them to**\n**the landing page for remote access. TG-3390 attempts to reenter the environment by identifying**\n**accounts that do not require two-factor authentication for remote access solutions, and then brute**\n**forcing usernames and passwords. After reestablishing access, the adversaries download tools such**\n**as gsecudmp and WCE that are staged temporarily on websites that TG-3390 previously**\n**compromised but never used. CTU researchers believe legitimate websites are used to host tools**\n**because web proxies categorize the sites as benign.**\n\n**Note: Numerous threat groups use legitimate remote access solutions (VPN, Citrix, OWA, etc.) to**\n**enter or reenter a network. After executing an eviction plan, it is paramount to reset all**\n**credentials, including those for third-party accounts, preferably after implementing two-factor**\n**authentication.**\n\n**TG-3390 actors keep track of and leverage existing ASPXTool web shells in their operations,**\n**preferring to issue commands via an internally accessible web shell rather than HttpBrowser or**\n**PlugX. After reentering an environment, the threat actors focus on obtaining the active directory**\n**contents. Figure 19 shows a timeline of TG-3390 attempting to regain a foothold in a network in a**\n**span of only five hours.**\n\n**_Figure 19. Timeline, in Eastern Time, of TG-3390's reentry into a compromised network. (Source:_**\n**_Dell SecureWorks)_**\n\n**Note: Relying primarily on network-based security controls will not deter most threat groups from**\n**achieving their objective. Adversaries can overcome blacklisted infrastructure in minutes, as TG-**\n**3390 actors did when they staged tools on compromised web servers.**\n\n**_Team member or team identifier_**\n\n**Analysis of the OwaAuth web shell revealed a PDB string with the \"SyberSpace\" username (see**\n**Figure 20).**\n\n**_Figure 20. OwaAuth web shell PDB string. (Source: Dell SecureWorks)_**\n\n**Further research revealed additional tools containing the same username (see Figure 21).**\n\n\n-----\n\n**Conclusion**\n\n**TG-3390 is known for compromising organizations via SWCs and moving quickly to install backdoors**\n**on Exchange servers. Despite the group's proficiency, there are still many opportunities to detect**\n**and disrupt its operation by studying its modus operandi** **. The threat actors work to overcome**\n**existing security controls, or those put in place during an engagement, to complete their mission of**\n**exfiltrating intellectual property. Due to TG-3390's determination, organizations should formulate a**\n**solid eviction plan before engaging with the threat actors to prevent them from reentering the**\n**network.**\n\n**Threat indicators**\n\n**The indicators in Table 1 are associated with TG-3390 activity. The domains and IP addresses may**\n**contain malicious content, so consider the risks before opening them in a browser.**\n\n**I** **N** **D** **I** **C** **A** **T** **O** **R** **T** **Y** **P** **E** **C** **O** **N** **T** **E** **X** **T**\n\n**TG-3390 infrastructure**\n**american.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**api.apigmail.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**apigmail.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**backup.darkhero.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**bel.updatawindows.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**binary.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**castle.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ctcb.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**darkhero.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**dav.local-test.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**test.local-test.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**dev.local-test.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ocean.local-test.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ga.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**helpdesk.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**helpdesk.csc-na.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**helpdesk.hotmail-onlines.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**helpdesk.lnip.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**hotmail-onlines.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**jobs.hotmail-onlines.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**justufogame.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**lnip.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**local-test.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**login.hansoftupdate.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**long.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**longlong.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**longshadow.dyndns.org** **Domain name**\n**Confidence** **High**\n\n\n-----\n\n**TG-3390 infrastructure**\n**longykcai.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**lostself.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**mac.navydocument.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**mail.csc-na.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**mantech.updatawindows.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**micr0soft.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**microsoft-outlook.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**mtc.navydocument.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**navydocument.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**mtc.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**news.hotmail-onlines.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**oac.3322.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ocean.apigmail.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**pchomeserver.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**registre.organiccrap.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**security.pomsys.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**services.darkhero.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**sgl.updatawindows.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**shadow.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**sonoco.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**test.logmastre.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**up.gtalklite.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**updatawindows.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**update.deepsoftupdate.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**update.hancominc.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**update.micr0soft.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**update.pchomeserver.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**urs.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**wang.darkhero.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**webs.local-test.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**word.apigmail.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**wordpress.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**working.blackcmd.com** **Domain name**\n**Confidence** **High**\n\n\n-----\n\n**TG-3390 infrastructure**\n**working.hotmail-onlines.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**www.trendmicro-update.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**www.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**x.apigmail.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ykcai.update-onlines.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ykcailostself.dyndns-free.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ykcainobody.dyndns.org** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**zj.blackcmd.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**laxness-lab.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**google-ana1ytics.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**www.google-ana1ytics.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**ftp.google-ana1ytics.com** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**hotmailcontact.net** **Domain name**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**208.115.242.36** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**208.115.242.37** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**208.115.242.38** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**66.63.178.142** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**72.11.148.220** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**72.11.141.133** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**74.63.195.236** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**74.63.195.236** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**74.63.195.237** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**74.63.195.238** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**103.24.0.142** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**103.24.1.54** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**106.187.45.162** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**192.151.236.138** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**192.161.61.19** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**192.161.61.20** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**192.161.61.22** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**103.24.1.54** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**67.215.232.179** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**96.44.177.195** **IP address**\n**Confidence: High**\n\n**TG-3390 infrastructure**\n**49.143.192.221** **IP address**\n**Confidence** **Mode ate**\n\n\n-----\n\n**TG-3390 infrastructure**\n**67.215.232.182** **IP address**\n**Confidence: Moderate**\n\n**TG-3390 infrastructure**\n**96.44.182.243** **IP address**\n**Confidence: Moderate**\n\n**TG-3390 infrastructure**\n**96.44.182.245** **IP address**\n**Confidence: Moderate**\n\n**TG-3390 infrastructure**\n**96.44.182.246** **IP address**\n**Confidence: Moderate**\n\n**TG-3390 infrastructure**\n**49.143.205.30** **IP address**\n**Confidence: Moderate**\n\n**TG-3390 email address**\n**working_success@163.com** **Email address**\n**Confidence: High**\n\n**TG-3390 email address**\n**ykcaihyl@163.com** **Email address**\n**Confidence: High**\n\n**TG-3390 email address**\n**working_success@163.com** **Email address**\n**Confidence: High**\n\n**TG-3390 email address**\n**yuming@yinsibaohu.aliyun.com** **Email address**\n**Confidence: Low**\n\n**1cb4b74e9d030afbb18accf6ee2bfca1** **MD5 hash** **HttpBrowser RAT dropper**\n\n**b333b5d541a0488f4e710ae97c46d9c2** **MD5 hash** **HttpBrowser RAT dropper**\n\n**86a05dcffe87caf7099dda44d9ec6b48** **MD5 hash** **HttpBrowser RAT dropper**\n\n**93e40da0bd78bebe5e1b98c6324e9b5b** **MD5 hash** **HttpBrowser RAT dropper**\n\n**f43d9c3e17e8480a36a62ef869212419** **MD5 hash** **HttpBrowser RAT dropper**\n\n**57e85fc30502a925ffed16082718ec6c** **MD5 hash** **HttpBrowser RAT dropper**\n\n**4251aaf38a485b08d5562c6066370f09** **MD5 hash** **HttpBrowser RAT dropper**\n\n**bbfd1e703f55ce779b536b5646a0cdc1** **MD5 hash** **HttpBrowser RAT dropper**\n\n**12a522cb96700c82dc964197adb57ddf** **MD5 hash** **HttpBrowser RAT dropper**\n\n**728e5700a401498d91fb83159beec834** **MD5 hash** **HttpBrowser RAT dropper**\n\n**2bec1860499aae1dbcc92f48b276f998** **MD5 hash** **HttpBrowser RAT dropper**\n\n**014122d7851fa8bf4070a8fc2acd5dc5** **MD5 hash** **HttpBrowser RAT**\n\n**0ae996b31a2c3ed3f0bc14c7a96bea38** **MD5 hash** **HttpBrowser RAT**\n\n**1a76681986f99b216d5c0f17ccff2a12** **MD5 hash** **HttpBrowser RAT**\n\n**380c02b1fd93eb22028862117a2f19e3** **MD5 hash** **HttpBrowser RAT**\n\n**40a9a22da928cbb70df48d5a3106d887** **MD5 hash** **HttpBrowser RAT**\n\n**46cf2f9b4a4c35b62a32f28ac847c575** **MD5 hash** **HttpBrowser RAT**\n\n**5436c3469cb1d87ea404e8989b28758d** **MD5 hash** **HttpBrowser RAT**\n\n**692cecc94ac440ec673dc69f37bc0409** **MD5 hash** **HttpBrowser RAT**\n\n**6a39a4e9933407aef31fdc3dfa2a2a95** **MD5 hash** **HttpBrowser RAT**\n\n**8b4ed3b392ee5da139c16b8bca38ea5e** **MD5 hash** **HttpBrowser RAT**\n\n**8ea5d8bb6b28191e4436456c35477e39** **MD5 hash** **HttpBrowser RAT**\n\n**9271bcfbba056c8f80c7f04d72efd62d** **MD5 hash** **HttpBrowser RAT**\n\n**996843b55a7c5c7a36e8c6956e599610** **MD5 hash** **HttpBrowser RAT**\n\n**a554efc889714c70e9362bdc81fadd6a** **MD5 hash** **HttpBrowser RAT**\n\n**c9c93c2d62a084031872aab96202ee3e** **MD5 hash** **HttpBrowser RAT**\n\n**ddbdf0efdf26e0c267ef6155edb0e6b8** **MD5 hash** **HttpBrowser RAT**\n\n**e7df18a17d8e7c2ed541a57020444068** **MD5 hash** **HttpBrowser RAT**\n\n**ea4dcafc224f604c096032dde33a1d6d** **MD5 hash** **HttpBrowser RAT**\n\n**f658bb17d69912404f34532901edad0e** **MD5 hash** **HttpBrowser RAT**\n\n**f869a1b40f6438dfdd89e73480103211** **MD5 hash** **HttpBrowser RAT**\n\n**81ed752590752016cb1c12f3e9ab3454** **MD5 hash** **HttpBrowser RAT**\n\n**5ef719f8aeb9bf97beb24a5c2ed19173** **MD5 hash** **HttpBrowser RAT**\n\n**7ec91768376324be2bad4fd30b1c2051** **MD5 hash** **HttpBrowser RAT**\n\n**20c446ad2d7d1586138b493ecddfbbc7** **MD5 hash** **HttpBrowser RAT**\n\n**44cf0793e05ba843dd53bbc7020e0f1c** **MD5 hash** **HttpBrowser RAT**\n\n**02826bb6636337963cc5162e6f87745e** **MD5 hash** **HttpBrowser RAT**\n\n**1606ab7a54735af654ee6deb7427f652** **MD5 hash** **HttpBrowser RAT**\n\n**1539b3a5921203f0e2b6c05d692ffa27** **MD5 hash** **HttpB o** **se RAT**\n\n\n-----\n\n**225e10e362eeee15ec64246ac021f4d6** **MD5 hash** **HttpBrowser RAT**\n\n**a631fc7c45cbdf80992b9d730df0ff51** **MD5 hash** **HttpBrowser RAT**\n\n**af785b4df71da0786bcae233e55cf6c1** **MD5 hash** **HttpBrowser RAT**\n\n**e3e0f3ad4ff3b981b513cc66b37583e8** **MD5 hash** **HttpBrowser RAT**\n\n**5cd0e97a1f09001af5213462aa3f7eb1** **MD5 hash** **HttpBrowser RAT**\n\n**15fd9c04d6099273a9acf8feab81acfe** **MD5 hash** **HttpBrowser RAT**\n\n**ea8b9e0bf95fc0c71694310cb685cd3b** **MD5 hash** **HttpBrowser RAT**\n\n**5c3ab475be110ec59257617ee1388e01** **MD5 hash** **HttpBrowser RAT**\n\n**6aac7417ea1eb60a869597af9049b8fa** **MD5 hash** **HttpBrowser RAT**\n\n**372f5370085a63f5b660fab635ce6cd7** **MD5 hash** **HttpBrowser RAT**\n\n**fac4885324cb67bd421d6250fdc9533c** **MD5 hash** **HttpBrowser RAT**\n\n**e7e555615a07040bb5dbe9ce59ac5d11** **MD5 hash** **HttpBrowser RAT**\n\n**ff34cb1d90d76a656546293e879afe22** **MD5 hash** **HttpBrowser RAT**\n\n**2abf7421c34c60d48e09325a206e720e** **MD5 Hash** **HttpBrowser RAT**\n\n**396b4317db07cc8a2480786160b33044** **MD5 hash** **HttpBrowser RAT**\n\n**e404873d3fcd0268db10657b53bdab64** **MD5 hash** **HttpBrowser RAT**\n\n**6e4189b20adb253b3c1ad7f8fdc95009** **MD5 hash** **HttpBrowser RAT**\n\n**bff424289c38d389a8cafb16b47dfe39** **MD5 hash** **HttpBrowser RAT**\n\n**7294c7f3860315d51f74152e8ad353df** **MD5 hash** **HttpBrowser RAT**\n\n**40092f76fea082b05e9631d91975a401** **MD5 hash** **HttpBrowser RAT**\n\n**e42fce74bbd637c35320cf4e95f5e055** **MD5 hash** **HttpBrowser RAT**\n\n**d0dafc3716a0d0ce393cde30b2b14a07** **MD5 hash** **HttpBrowser RAT**\n\n**ae66bad0c7de88ab0ab1050c4bec9095** **MD5 hash** **HttpBrowser RAT**\n\n**c7c2be1cd3780b2ba4638cef9a5422c7** **MD5 hash** **HttpBrowser RAT**\n\n**405949955b1cb65673c16bf7c8da2f4d** **MD5 hash** **HttpBrowser RAT**\n\n**ff4f052dbe73a81403df5e98313000fb** **MD5 hash** **HttpBrowser RAT**\n\n**b30fcd362c7b8ac75b7dddfe6cb448c7** **MD5 hash** **HttpBrowser RAT**\n\n**1d24f4d20b80562de46a8ac95d0ff8c2** **MD5 hash** **HttpBrowser RAT**\n\n**9538bbdb3a73201b40296e9d4dc80ade** **MD5 hash** **HttpBrowser RAT**\n\n**46bb2caeda30c09a6337fd46ec98c32c** **MD5 hash** **HttpBrowser RAT**\n\n**0c8842e48e80643d91dd290d0f786147** **MD5 hash** **HttpBrowser RAT**\n\n**0fc975c3c4e6c546b4f2b5aaed50dd78** **MD5 hash** **HttpBrowser RAT**\n\n**41be449f687828466ed7d87f0f30a278** **MD5 hash** **HttpBrowser RAT**\n\n**2b95caf3307ebd36cf405b1133b30aa8** **MD5 hash** **HttpBrowser RAT**\n\n**ccc715a4d9d0157b9776deacdb26bf78** **MD5 hash** **HttpBrowser RAT**\n\n**37933acfa8d8e78c54413d88ca705e17** **MD5 hash** **HttpBrowser RAT**\n\n**2813c5a1c87f7e3d33174fed8b0988a1** **MD5 hash** **HttpBrowser RAT**\n\n**8f22834efe52ccefb17e768569eb36b9** **MD5 hash** **HttpBrowser RAT**\n\n**6f01628a0b5de757a8dbe99020499d10** **MD5 hash** **HttpBrowser RAT**\n\n**7f8d9f12f41156512b60ab17f8d85fe9** **MD5 hash** **HttpBrowser RAT**\n\n**debe5ef2868b212f4251c58be1687660** **MD5 hash** **HttpBrowser RAT**\n\n**e136d4ebab357fd19df8afe221460571** **MD5 hash** **HttpBrowser RAT**\n\n**a86a906cfafaf1d7e3725bb0161b0cfe** **MD5 hash** **HttpBrowser RAT**\n\n**03e1eac3512a726da30fff41dbc26039** **MD5 hash** **HttpBrowser RAT**\n\n**baac5e5dd3ce7dae56cab6d3dac14e15** **MD5 hash** **HttpBrowser RAT**\n\n**0f7dde31fbeb5ddbb6230c401ed41561** **MD5 hash** **HttpBrowser RAT**\n\n**36d957f6058f954541450f5a85b28d4b** **MD5 hash** **HttpBrowser RAT**\n\n**42d874f91145bd2ddf818735346022d8** **MD5 hash** **HttpBrowser RAT**\n\n**3468034fc3ac65c60a1f1231e3c45107** **MD5 hash** **HttpBrowser RAT**\n\n**4e3b51a6a18bdb770fc38650a70b1883** **MD5 hash** **HttpBrowser RAT**\n\n**3647068230839f9cadf0fd4bd82ade84** **MD5 hash** **HttpBrowser RAT**\n\n**550922107d18aa4caad0267997709ee5** **MD5 hash** **HttpBrowser RAT**\n\n**d8f0a6450f9df637daade521dc90d29d** **MD5 hash** **HttpBrowser RAT**\n\n\n-----\n\n**e91d2464c8767552036dd0294fc7e6fb** **MD5 hash** **HttpBrowser RAT**\n\n**f627bc2db3cab34d97c8949931cb432d** **MD5 hash** **HttpBrowser RAT**\n\n**b313bbe17bd5ee9c00acff3bfccdb48a** **MD5 hash** **PlugX RAT dropper**\n\n**f7a842eb1364d1269b40a344510068e8** **MD5 hash** **PlugX RAT dropper**\n\n**8dacca7dd24844935fcd34e6c9609416** **MD5 hash** **PlugX RAT dropper**\n\n**7cffd679599fb8579abae8f32ce49026** **MD5 hash** **PlugX RAT dropper**\n\n**462fd01302bc40624a44b7960d2894cd** **MD5 hash** **PlugX RAT dropper**\n\n**_Table 1. TG-3390 indicators._**\n\n**Appendix A — Identifying attribution and gauging confidence**\n\n**_Identifying attribution_**\n\n**In most cases, CTU researchers not have intelligence to directly attribute a threat group, so**\n**attribution relies on circumstantial evidence and is an assessment rather than a fact. CTU**\n**researchers draw on three distinct intelligence bases for evidence of attribution:**\n\n**Observed activity is gathered from CTU researchers' observation and investigation**\n**of a threat group's activity on a target network and across Dell SecureWorks data,**\n**and analysis of tactics, techniques, and procedures (TTPs) the threat group**\n**employs.**\n\n**Third-party intelligence is gained from trusted relationships within the security**\n**industry and with other private and public sector organizations, as well as analysis**\n**of open source intelligence.**\n\n**Contextual analysis compares threat group targets against intelligence**\n**requirements of nation states and other threat actors and compares tradecraft**\n**employed by a threat group to tradecraft of known threat actors.**\n\n**_Gauging confidence level_**\n\n**CTU researchers have adopted the grading system** **[published by the U.S. Office of the Director of](http://www.dni.gov/files/documents/Newsroom/Press Releases/2007 Press Releases/20071203_release.pdf)**\n**National Intelligence to indicate confidence in their assessments:**\n\n**High confidence generally indicates that judgments are based on high-quality**\n**information, and/or that the nature of the issue makes it possible to render a solid**\n**judgment. A \"high confidence\" judgment is not a fact or a certainty, however, and**\n**such judgments still carry a risk of being wrong.**\n\n**Moderate confidence generally means that the information is credibly sourced**\n**and plausible but not of sufficient quality or corroborated sufficiently to warrant a**\n**higher level of confidence.**\n\n**Low confidence generally means that the information's credibility and/or**\n**plausibility is questionable, or that the information is too fragmented or poorly**\n**corroborated to make solid analytic inferences, or that [there are] significant**\n**concerns or problems with the sources.**\n\n**Appendix B — HttpBrowser analysis**\n\n**HttpBrowser is a remote access tool whose name originates from the hard-coded \"HttpBrowser/1.0\"**\n**[User-Agent. CTU researchers also identified a PDB string in the binaries,](http://support.microsoft.com/kb/121366)**\n**J:\\TokenControlV3\\ServerDll\\Release\\ServerDll.pdb, which implies that the threat actors may refer**\n**to the tool as \"TokenControl.\" Table 2 lists the commands available to threat actors in one of the**\n**HttpBrowser variants.**\n\n**C** **O** **M** **M** **FA** **UN** **ND** **C** **T** **I** **O** **N** **A** **L** **I** **T** **Y**\n\n**Init** **Create a reverse shell**\n\n**Write** **Write a file to the compromised system from the C2 server**\n\n**List** **List the files in a directory**\n\n**Upload** **Upload a file from the compromised system to the C2 server**\n\n**_Table 2. HttpBrowser command set. (Source: Dell SecureWorks)_**\n\n**Other variants of the backdoor may include additional commands such as setcmd, settime, uninstall,**\n**and down. Table 3 shows the unencrypted URL parameters, along with sample data and a**\n**description of the data.**\n\n**U** **R** **L**\n**S** **A** **M** **P** **L** **E** **DD** **EA** **ST** **CA** **R** **I** **P** **T** **I** **O** **N**\n**P** **A** **R** **A** **M** **E** **T** **E** **R**\n\n**c=** **Victim->Administrator** **Hostname and username**\n\n**l=** **192.168.1.100** **Compromised system's IP address**\n\n**Windows major and minor version, coupled with**\n**o=** **5,1,1,32**\n**architecture (32 v. 64)**\n\n**{B5B70BD7-87FC-499A-**\n\n**u=** **B4D1-** **A GUID**\n\n**98163306F0D8}**\n\n**Boolean value if the malware is running as injected**\n**r=** **1**\n**code**\n\n**Number of milliseconds the computer has been**\n**t=** **8035187**\n**running**\n\n**_Table 3. HttpBrowser parameters. (Source: Dell SecureWorks)_**\n\n**A** **di** **C** **O** **A th** **b** **h ll** **l** **i**\n\n\n-----\n\n**g** **\\** **\\** **g** **\\** **\\** **\\** **\\**\n**observed the backdoor using the same filename in the %ProgramFiles%\\Microsoft\\Exchange**\n**Server\\ClientAccess\\Owa\\bin\\ directory. In addition to acting as a web shell, the malware captures**\n**and DES-encrypts credentials before writing the username and password to disk. The OwaAuth web**\n**shell enables a threat actor to upload and download files, launch processes, and execute SQL**\n**queries.**\n\n**Each web shell instance is configured to contain SP, Key, and Log variables. The SP variable is a**\n**string containing the victim's username. When the malicious ISAPI filter captures a username**\n**matching this variable, it knows to handle the incoming HTTP request as a command to the web**\n**shell. The DES key to encrypt the credentials in the configuration observed by CTU researchers is**\n**12345678, and the log file is c:\\log.txt. The decrypted contents of the log file adhere to the format**\n**in Figure 22.**\n\n**_Figure 22. Decrypted OwaAuth log file format. (Source: Dell SecureWorks)_**\n\n**Table 4 lists the OwaAuth web shell commands available to the adversary.**\n\n**C** **O** **M** **FM** **UA** **NN** **CD** **T** **I** **O** **N** **A** **L** **I** **T** **Y**\n\n**A** **List logical drives**\n\n**B** **List directory (Z1 = directory name to list)**\n\n**C** **Read data from file (Z1 = filename to read)**\n\n**D** **Write content to file (Z1 = filename to write, Z2 = content to write)**\n\n**E** **Delete file in directory (Z1 = file)**\n\n**F** **Generate custom web response \"->|value in Z1|<-\"**\n\n**Write hex-encoded content to file (Z1 = filename to write, Z2 = hex encoded**\n**G**\n**content to write)**\n\n**H** **Call _Notice(Z1, Z2)**\n\n**I** **Move/rename file or directory (Z1 = target, Z2 = new name)**\n\n**J** **Create directory (Z1 = directory name)**\n\n**K** **Timestomp file or directory (Z1 = target, Z2 = time/date string to stomp to)**\n\n**L** **Download file from Internet (Z1 = URL, Z2 = filename to write to)**\n\n**M** **Launch process (Z1 = process name, Z2 = arguments)**\n\n**N** **Test connect to SQL database (Z1 = SqlConnect String)**\n\n**O** **SQL Get database table scheme (Z1 = \\r delimited parameters to command)**\n\n**SQL Get database table scheme with restrictions (Z1 = \\r delimited parameters to**\n**P**\n**command)**\n\n**Q** **SQL execute SQL command (Z1 = \\r delimited parameters to command)**\n\n**_Table 4. OwaAuth web shell command set. (Source: Dell SecureWorks)_**\n\n**Appendix D — Domain name parking example**\n\n**CTU researchers have observed TG-3390 parking domains by pointing their A record to a non-**\n**routable IP space, including the 127.0.0.[x] loopback address. Table 5 demonstrates how the threat**\n**actors change one of their C2 domains to point to routable and non-routable IP addresses over**\n**time.**\n\n**S** **T** **A** **R** **TE** **N** **D** **D** **A** **TD** **E** **A** **T** **E** **I** **P** **C** **H** **A** **L** **N** **O** **G** **C** **E** **A** **T** **I** **O** **N**\n\n**7/9/13** **7/31/13** **210.116.106.66** **Seoul, Korea**\n\n**7/31/13** **10/12/13** **127.0.0.1** **N/A**\n\n**10/12/13** **11/5/13** **122.10.10.196** **Hong Kong**\n\n**11/5/13** **1/12/14** **198.100.107.107** **California, U.S.**\n\n**1/12/14** **3/5/14** **127.0.0.1** **N/A**\n\n**3/5/14** **3/31/14** **103.24.0.142** **Hong Kong**\n\n**3/31/14** **10/27/14** **103.24.1.54** **Hong Kong**\n\n**10/27/14** **11/9/14** **127.0.0.1** **N/A**\n\n**11/9/14** **5/25/15** **127.0.0.3** **N/A**\n\n**5/25/15** **Current as of this publication** **127.0.0.1** **N/A**\n\n**_Table 5. Example parking of trendmicro-update . org (Source: Dell SecureWorks)_**\n\n**Endnotes**\n\n**[1] The Dell SecureWorks Counter Threat Unit(TM) (CTU) research team tracks threat groups by**\n**assigning them four-digit randomized numbers (3390 in this case), and compiles information from**\n**first-hand incident response observations and from external sources.**\n\n**[2] Threat groups use strategic web compromises (SWCs), also known as watering hole attacks, to**\n**target a wide array of potential victims. Threat actors compromise a website used by their target**\n**demographic (e.g., compromising a website specializing in oil and gas industry news when targeting**\n**the energy vertical). Visitors to the compromised website are redirected to a server under the threat**\n**group's control, where their system is compromised with the threat group's malware. With this**\n\n\n-----\n\n### Contact Information\n\n**Dell SecureWorks**\n\n**1 Concourse Pkwy NE #500**\n\n**Atlanta, GA 30328**\n\n**Main: 404-929-1795**\n\n**Toll-free:877-838-7947**\n\n**Fax:404-728-0144**\n\n**Incident Response: 1-877-884-1110**\n\n\n### Company\n\n**About Dell SecureWorks**\n\n**Awards & Recognition**\n\n**[Careers](http://jobs.dell.com/search/advanced-search/ASCategory/SecureWorks/ASPostedDate/-1/ASCountry/-1/ASState/-1/ASCity/-1/ASLocation/-1/ASCompanyName/-1/)**\n\n**Events**\n\n**In The Media**\n\n**Management Team**\n\n**Press Releases**\n\n**Contact Us**\n\n\n### Resources\n\n**Analyst Reports**\n\n**Case Studies**\n\n**Data Sheets**\n\n**eBooks**\n\n**Solution Briefs**\n\n**Tips & Articles**\n\n**Videos**\n\n**Webcasts**\n\n**White Papers**\n\n\n### Connect With Us\n\n**[Facebook](http://www.facebook.com/secureworks)**\n\n**[Linkedin](http://www.linkedin.com/company/secureworks)**\n\n**[Twitter](http://www.twitter.com/dellsecureworks)**\n\n**[Blog](http://www.secureworks.com/resources/blog/)**\n\n**[RSS Feeds](http://www.secureworks.com/rss/)**\n\n\n**Privacy Policy | Terms of Use | Site Map | Preference Center**\n\n**Copyright © 2015 Dell SecureWorks, Inc. | Information, Network & Managed IT Security Services**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.08.05.Threat_Group-3390/threat-group-3390-targets-organizations-for-cyberespionage.pdf"
    ],
    "report_names": [
        "threat-group-3390-targets-organizations-for-cyberespionage"
    ],
    "threat_actors": [
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1446292555,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/2e7bfba595146d0274eaf32479cb7ea8eebda153.pdf",
        "text": "https://archive.orkl.eu/2e7bfba595146d0274eaf32479cb7ea8eebda153.txt",
        "img": "https://archive.orkl.eu/2e7bfba595146d0274eaf32479cb7ea8eebda153.jpg"
    }
}