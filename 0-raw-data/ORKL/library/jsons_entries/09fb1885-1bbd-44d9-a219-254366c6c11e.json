{
    "id": "09fb1885-1bbd-44d9-a219-254366c6c11e",
    "created_at": "2023-01-12T15:01:18.487991Z",
    "updated_at": "2025-03-27T02:09:30.103006Z",
    "deleted_at": null,
    "sha1_hash": "c8db46c6b7a890148fee7b989546ebf2ff502212",
    "title": "2020-07-08 - New Mirai Variant Expands Arsenal, Exploits CVE-2020-10173",
    "authors": "",
    "file_creation_date": "2022-05-28T16:01:05Z",
    "file_modification_date": "2022-05-28T16:01:05Z",
    "file_size": 106805,
    "plain_text": "# New Mirai Variant Expands, Exploits CVE-2020-10173\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/new-mirai-variant-expands-arsenal-exploits-cve-2020-10173/](https://blog.trendmicro.com/trendlabs-security-intelligence/new-mirai-variant-expands-arsenal-exploits-cve-2020-10173/)**\n\nIoT\n\n\nJuly 8, 2020\n\n\nWe discovered a new Mirai variant that exploits nine vulnerabilities, most notable of which is CVE-2020-10173 in Comtrend VR-3033\nrouters which we have not observed exploited by past Mirai variants.\n\nBy: Augusto Remillano II, Jemimah Molina July 08, 2020 Read time: ( words)\n\nContent added to Folio\n\n[We discovered a new Mirai variant (detected as IoT.Linux.MIRAI.VWISI) that exploits nine vulnerabilities, most notable of which is](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/IoT.Linux.MIRAI.VWISI)\n[CVE-2020-10173 in Comtrend VR-3033 routers which we have not observed exploited by past Mirai variants.](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10173)\n\n[This discovery is a new addition to the Mirai variants that appeared in the past few months, that include SORA, UNSTABLE, and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/sora-and-unstable-2-mirai-variants-target-video-surveillance-storage-systems)\n[Mukashi. The case, however, showcases the ever-expanding arsenal of vulnerabilities new Mirai variants are equipped with by their](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/internet-of-things/mirai-updates-new-variant-mukashi-targets-nas-devices-new-vulnerability-exploited-in-gpon-routers-upx-packed-fbot)\ndevelopers.\n\n## The vulnerabilities\n\nThe vulnerabilities used by this Mirai variant consist of a combination of old and new that help cast a wide net encompassing\ndifferent types of connected devices. The nine vulnerabilities used in this campaign affect specific versions of IP cameras, smart\nTVs, and routers, among others.\n\nAs mentioned earlier, the most notable of these vulnerabilities is CVE-2020-10173, a Multiple Authenticated Command injection\nvulnerability found in Comtrend VR-3033 routers. Remote malicious attackers can use this vulnerability to compromise the network\nmanaged by the router.\n\n[Only a proof of concept (POC) has been released for this vulnerability, with no reported exploit at large before this Mirai variant.](https://www.exploit-db.com/exploits/48142)\nFigure 1 serves as evidence of how this vulnerability is used by the sample.\n\n[Code snippet showing the use of CVE-2020-10173](https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/07/Figure-1.jpg)\n\nFigure 1. Code snippet that shows the use of CVE-2020-10173\n\n[Another relatively recent vulnerability also used in this campaign is Netlink GPON Router 1.0.11 RCE. Discovered this year, it was](https://www.exploit-db.com/exploits/48225)\n[reportedly exploited by the Bashlite/Gafgyt variant Hoaxcalls.](https://blog.radware.com/security/botnets/2020/05/ghosting-bots-the-story-of-hoaxcalls-failures/)\n\n[Code snippet showing the use of Netlink GPON Router 1.0.11 RCE](https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/07/Figure-2.jpg)\n\nFigure 2 Code snippet that shows the use of Netlink GPON Router 1 0 11 RCE\n\n\n-----\n\nAside from the two, the variant makes use of mostly old vulnerabilities which have been used in past campaigns. The two code\nsnippets shown in figures 3 and 4 serve as examples of old vulnerabilities written in the variant’s code.\n\n[Code snippet showing the use of LG SuperSign EZ CMS 2.5 - Remote Code Execution](https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/07/Figure-3.jpg)\n\n[Figure 3. Code snippet that shows the use of LG SuperSign EZ CMS 2.5 - Remote Code Execution](https://www.exploit-db.com/exploits/45448)\n\n[Code snippet showing the use of Linksys E-series - Remote Code Execution](https://blog.trendmicro.com/trendlabs-security-intelligence/files/2020/07/Figure-4.jpg)\n\n[Figure 4. Code snippet that shows the use of Linksys E-series - Remote Code Execution](https://www.exploit-db.com/exploits/31683)\n\nIn addition to these examples, the remaining five old vulnerabilities that were exploited by the variant are the following:\n\n[AVTECH IP Camera / NVR / DVR Devices - Multiple Vulnerabilities](https://www.exploit-db.com/exploits/40500)\n[D-Link Devices - UPnP SOAP Command Execution](https://www.exploit-db.com/exploits/27044)\n[MVPower DVR TV-7104HE 1.8.4 115215B9 - Shell Command Execution](https://www.exploit-db.com/exploits/41471)\n[Symantec Web Gateway 5.0.2.8 Remote Code Execution](https://packetstormsecurity.com/files/157175/Symantec-Web-Gateway-5.0.2.8-Remote-Code-Execution.html)\n[ThinkPHP 5.0.23/5.1.31 - Remote Code Execution](https://www.exploit-db.com/exploits/45978)\n\n## Brute-force capabilities\n\nA hallmark of Mirai variants is the use of Telnet and Secure Shell (SSH) brute-forcing as evidenced by our sample. This variant also\nused the typical XOR encryption (with the XOR key: 0x04) to hide the credentials that it uses to attack vulnerable devices. The\ncredentials we extracted are listed here.\n\nExtracted credentials\n\n0 GM8182 ROOT500\n\n1001chin grouter solokey\n\n1111 guest svgodie\n\n1234 h3c swsbzkgn\n\n12345 hg2x0 system\n\n123456 hi3518 t0talc0ntr0l4!\n\n20080826 huigu309 taZz@23495859\n\n54321 hunt5759 telecomadmin\n\n5up iDirect telnet\n\n666666 ipcam_rt5350 telnetadmin\n\n88888888 iwkb tl789\n\nabc123 juantech tsgoingon\n\nadmin jvbzd twe8ehome\n\nahetzip8 klv123 user\n\nanko nflection vizxv\n\nantslq nmgx_wapia win1dows\n\nascend oelinux123 xc3511\n\nblender pass xmhdipc\n\ncat1029 password zhongxing\n\nchangeme private zlxx.\n\ndefault realtek zsun1188\n\ndreambox root Zte521\n\n\n-----\n\nConclusion and security recommendations\n\nThe use of CVE-2020-10173 in this variant’s code shows how botnet developers continue to expand their arsenal to infect as many\ntargets as possible and take advantage of the opening afforded by unpatched devices. Newly discovered vulnerabilities, in particular,\noffer better chances for cybercriminals. Users, not knowing that a vulnerability even exists, might be unable to patch the device\nbefore it is too late.\n\nIn the future, it would be wise to expect this vulnerability might be used in new DDoS botnets like Mirai. As monitoring of such\nbotnets show, handlers tend to copy each other’s techniques, including lists of vulnerabilities and credentials that increase their\nchance of success.\n\nFor devices to remain safe from the usual tactics of botnet malware, users need to follow best practices in securing their connected\ndevices. These include the following:\n\nPatch vulnerabilities and apply updates as soon as they become available.\nUse network segmentation to limit the spread of potential infections.\nUse strong passwords and quickly change default ones.\nApply secure configurations for devices to limit unforeseen openings for infection.\n\n[Connected devices can also be protected by security software such as the Trend Micro™ Home Network Security and](https://blog.trendmicro.com/en_us/forHome/products/homenetworksecurity.html) Trend\nMicro™ Home Network Security SDK solutions, which can check internet traffic between the router and all connected devices as\nwell as help users asses for vulnerabilities.\n\n[Trend Micro™ Deep Discovery™ Inspector also protects customers from this attack via these DDI rules:](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/inspector.html)\n\n2452 - Wget Commandline Injection\n2544 - JAWS Remote Code Execution Exploit - HTTP (Request)\n2575 - Command Injection via UPnP SOAP Interface - HTTP (Request)\n2692 - LINKSYS Unauthenticated Remote Code Execution Exploit - HTTP (Request)\n2713 - AVTECH Command Injection Exploit - HTTP (Request)\n2786 - ThinkPHP 5x Remote Code Execution - HTTP (Request)\n2865 - CVE-2018-17173 LG Supersign Remote Code Execution - HTTP (Request)\n4689 - Comtrend - Remote Command Execution Exploit - HTTP (REQUEST)\n\nIndicators of compromise (IoCs)\n\n**SHA256** **Old Detection** **New Detection**\n\n66545fffeed4f413827f9dc51d2444aaa772adf4d44f65662356b1301e45390d Backdoor.Linux.MIRAI.VWIUJ [IoT.Linux.MIRAI.VWISI](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/IoT.Linux.MIRAI.VWISI)\n\n**Command and control (C&C) servers**\n\nmethcnc[.]duckdns[.]org\nmethscan[.]duckdns[.]org\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-08 - New Mirai Variant Expands Arsenal, Exploits CVE-2020-10173.pdf"
    ],
    "report_names": [
        "2020-07-08 - New Mirai Variant Expands Arsenal, Exploits CVE-2020-10173.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535678,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653753665,
    "ts_modification_date": 1653753665,
    "files": {
        "pdf": "https://archive.orkl.eu/c8db46c6b7a890148fee7b989546ebf2ff502212.pdf",
        "text": "https://archive.orkl.eu/c8db46c6b7a890148fee7b989546ebf2ff502212.txt",
        "img": "https://archive.orkl.eu/c8db46c6b7a890148fee7b989546ebf2ff502212.jpg"
    }
}