{
    "id": "0ed4b076-9083-4d17-a7ca-92d4909f3727",
    "created_at": "2023-01-12T15:05:43.92455Z",
    "updated_at": "2025-03-27T02:08:36.039819Z",
    "deleted_at": null,
    "sha1_hash": "7e52e17c5567997803bb30b1f708f5b05149cdd5",
    "title": "2021-02-03 - Malvertising- Made in China",
    "authors": "",
    "file_creation_date": "2022-05-27T23:12:01Z",
    "file_modification_date": "2022-05-27T23:12:01Z",
    "file_size": 5434549,
    "plain_text": "# Malvertising: Made in China\n\n**[blog.confiant.com/malvertising-made-in-china-f5081521b3f0](https://blog.confiant.com/malvertising-made-in-china-f5081521b3f0)**\n\nJerome Dangu September 29, 2021\n\n[Jerome Dangu](https://medium.com/@synku?source=post_page-----f5081521b3f0--------------------------------)\n[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb695b22b2d84&operation=register&redirect=https%3A%2F%2Fblog.confiant.com%2Fmalvertising-made-in-china-f5081521b3f0&user=Jerome+Dangu&userId=b695b22b2d84&source=post_page-b695b22b2d84----f5081521b3f0---------------------follow_byline-----------)\nFeb 3, 2021\n\n\n10 min read\n\nvia Pixabay (creative commons)\nTwo loosely related cybercrime groups operating scores of fake ad agencies from China are\nso deeply embedded in the ad tech industry that they can launch attacks that surpass the\nscale of the largest advertisers. At a time when China is under intense international scrutiny,\nthese groups largely fly under the radar, raking in millions of victims in Europe and the US\nwithout drawing attention to their source.\n\nIn this article, we present eGobbler and their doppelganger Nephos7, their origins and what\nmade them successful over time.\n\n## Setting the stage — Rise to success, 2017–2018\n\n\n-----\n\nThe infamous Amazon gift card scam (eGobbler, iOS, July 2018)\n**eGobbler rose to success by being one of the first groups to leverage javascript**\nfingerprinting to target iOS. iOS being the least fragmented mobile environment, they\nunderstood that they could build very precise fingerprints for it, that would allow them to\nevade simulated environments as found in the security scanners of that time. Starting with\n[JavaScript Sensor APIs and quickly moving to WebGL based fingerprinting, they essentially](https://developer.mozilla.org/en-US/docs/Web/API/Sensor_APIs)\ndefeated user agent spoofing and gained unfettered Javascript execution on millions of endusers’ devices since then.\n\n## Stable scheme, with some twists\n\nSince 2018, eGobbler has settled on a relatively sophisticated but slow evolving stack:\n\n\n-----\n\nLeverage ad platforms hosting to embed malicious code in HTML5 ad code. This is\ntypically achieved by injecting the code in or dependencies — libraries commonly found\nin HTML5 ads.\nUse of WebGL-based fingerprinting (among other tricks) to activate on victims’ devices\nonly\nGeo-fencing, using basic server-side cloaking\nOne-time use of commercial CDNs as reverse proxies (namely Rackspace and Fastly)\nProgrammatic ad chains are typically made of an SSP call, a DSP call and optionally\nan adserver call. eGobbler is adept at creating artifical chains of ad tag redirections\nbetween multiple DSPs, which would never exist in the wild. The goal is likely to\nconfuse analysts on the actual source of the ad.\nThrough 2019, eGobbler slowly migrated to weekend activity. By 2020, they ended up\nexclusively running on weekends (and holidays) to maximize impact during off hours.\n\nConsidering eGobbler’s massive scale, this change of tactic alone is the main driver for\nthe rise in general malvertising weekend activity since 2019\n\n**Breaking the browsers**\n\nTop malvertising groups see increased browser security around forced redirects as a threat\nand invest in finding flaws. To boost the efficacy of their payloads, eGobbler came up with a\nnumber of zero day exploits.\n\nDetected by Confiant in 2019, CVE-2019–8771 and CVE-2019–5840 are browser\nvulnerabilities (Safari and Chrome) introduced by eGobbler and allowing them to bypass\npopup blocking and iframe sandboxing, which are protections against forced redirects (more\n[here and](https://blog.confiant.com/massive-egobbler-malvertising-campaign-leverages-chrome-vulnerability-to-target-ios-users-a534b95a037f) [here).](https://blog.confiant.com/malvertiser-egobbler-exploits-chrome-webkit-bugs-infects-over-1-billion-ads-6b8ccc41b0e6)\n\n## Enter Nephos7\n\nNephos7 started out in Q4 of 2019 with familiar tactics and techniques:\n\nUse of commercial ad servers to hide malicious code\nUse of commercial CDNs as reverse proxies (Cloudfront)\nMimick instantiation of popular JavaScript APIs (e.g. Hotjar, Snowplow, etc.) to hide in\nplain sight\nUse of WebGL-based fingerprinting (among other tricks) to activate on victims’ devices\nonly\nBy end-of-year 2019, Nephos7 had aligned with eGobbler’s weekend patterns with a\nlarge attack on December 29.\n\n\n-----\n\nNephos7 JS fingerprinting targeting the Edge browser on Windows with mainstream graphics\ncard vendors (April 2020) — comments added for clarity\n\n## Timeline of tactics and payloads\n\nFrom Gift Card Scam to Carrier-branded Scams to Drive-by downloads, Nephos7 tightly\nfollows eGobbler’s path across all dimensions.\n\nsource: Confiant\nNot only the types of payloads align very closely but the landing pages bear a striking\nresemblance. As an illustration, below is a comparison of carrier-branded “CC-Submit”\nscams where the victim is presented with a fake message from their ISP (or mobile phone\ncarrier) inviting them to enter their credit card information to confirm their prize.\n\n\n-----\n\n“You have won, enter your credit card information” — CC-Submit payloads in France and\nGermany, Nephos7, April 4 2020\n\nCC-Submit payloads in France and the UK, eGobbler, July 25 2020\nFrom June 2020, both attackers switched focus to the United States and introduced drive-by\ndownload payloads. Below is a comparison of landing pages pushed by each threat actor in\nthe US: Almost the same, dropping the same adware (different hashes), no overlap in\ninfrastructure. Nephos7 wins with its “Premier Software Updater” ™.\n\nFake Flash “Holcus” Drive-by Download — Left side: eGobbler, July 25, USA | Right side:\nNephos7, July 26, USA\n**Introducing “Holcus Installer”, the adware dropped by Nephos7 and eGobbler,**\n**research by - Lead Security Researcher, Confiant**\n\neGobbler July25 campaign downloads a .msi file with the following sha-256 hash\nc818fe4c3fd3b0dbcfc3f17440e110c5a6ce3729382ffc88db8f83f830a115f9\n\nNephos7 July 26 campaign downloads a .msi file with the following sha-256 hash\nfb7d3f3914bf1722b3b369b23509b3746a44496bd3c78de91f27f8ee8d0ebead\n\n\n-----\n\nBoth of these .msi files unpack and run the same variant of a signed installer we dubbed\n_Holcus Installer. The Holcus Installer samples we collected so far were all signed, and some_\nof their features include:\n\nC2 communications via https, with certificate pinning checks. For example checks are\nperformed on the certificate issuer string if it contains a substring,, or before a\ncommunication is established.\nAll Holcus Installer strings hinting to main functionality, C2 server, and executed\ncommands are all encrypted with a custom RC4-like algorithm using key\nHolcus Installer checks if PUA detection (PuaProtection field) is enabled in the current\nWindows Defender configuration. This is done by via the wmi query:\nOne variant of Holcus Installer we found, additionally checks the DeviceID of the\nkeyboard retreived via wmi query:\nHolcus Installer has the capability to download and execute binaries from the C2 server\nand sends hardcoded status messages to the C2 server by encoding them using a\nbin2hex encoding.\nHolcus Installer variants we collected have been observed communicating with the\nfollowing C&C servers:\nHolcus Installer uses a hardcoded User-Agent “” for C2 communications\nIn our test environment, Holcus Installer was seen downloading and installing a decoy\ncopy of notepad++ (sha256 hash\nbda85bc0bb7beb11dbb9e9a964a2e2f0e4d35d0fc1e6b769e32b6847bfed8296)\n\n## Explaining the striking resemblance\n\nWe think that the two groups are solely focused on redirecting visitors to malicious “offers”\nthat are operated by different groups, themselves specialized in operating these schemes.\nMalvertisers can shop around with different affiliate marketers to get the best yield for their\ntraffic. Somehow Nephos7 and eGobbler are shopping around at the same stores.\n\n## 2020’s Largest Digital Marketers\n\n\n-----\n\nMonthly activity by actor in 2020 (by number of malicious ads served)\nBoth actors maintained presence through 2020, with Nephos7 being wildly successful in the\nfirst half of the year in Europe, while eGobbler maintained a steady pace and more\nsuccessfully transitioned to targeting the US in the second half of the year.\n\nVolumes by month by country (Top 6 countries only)\nIn 2020, both actors achieved “web scale” on multiple occasions. No other malvertising\ngroup was (ever?) able to create anything comparable to this massive ecosystem disruption.\nHere are two examples:\n\n\n-----\n\nPeak activity in % of display advertising (source: Confiant)\n\n**Clocking at 5% of all display advertising on May 24th, Nephos7 arguably became**\n**(for an instant) the largest digital marketer in Europe. In comparison, eGobbler’s**\n**most significant spike “only” hit 2.3% on July 25th.**\n\nIn total, in 2020, Confiant blocked 112 million ads from eGobbler and 198 million ads from\nNephos7 on behalf of our online publisher clients. Extrapolating our data, we estimate 6\nbillion malicious ads were served by the two actors during the period.\n\n## Targeting\n\nDevice/OS targeting has been markedly different between the two actors. In 2020, eGobbler\nwas heavily focused on targeting desktop computers (76%) while Nephos7 was more evenly\nsplit between mobile devices (52%) and desktop (48%).\n\nAs presented earlier, Nephos7 specifically targets Windows, excluding Mac OS X from its\ntargeting.\n\nNotably, in 2020 iOS only received a small fraction of hits from eGobbler (1.8%) while being\ncompletely excluded by Nephos7. Both actors have favored Android as their mobile platform\nof choice. This is all the more striking as eGobbler started out back in 2017 with a strong iOS\nfocus.\n\n\n-----\n\nDevice/OS targeting by actor (2020)\nTo achieve the sort of persistent scale that both actors enjoyed in 2020, they became experts\nat building relationships with “DSP” ad platforms. To enter the ad tech ecosystem, they\nworked to look reputable from all perspectives. That includes:\n\nBuilding a reputable looking corporate identity, with a legal entity registered far from\n“home” - more on this below.\nUsing a commercial ad server to host ad creatives and give a semblance of buyer\nsophistication. In reality, well-tuned commercial ad servers can achieve incredibly\npowerful cloaking for malvertisers.\nRunning dummy ad campaigns for weeks or months at low volumes (to build\nreputation) before flipping the switch.\n\n## Hunting Corporations\n\nProgrammatic advertising has been architectured such that online publishers have little\noversight or visibility on campaigns that are running on their sites. What will start running at\nfull throttle at 8 am on a quiet Sunday morning (eGobbler’s and Nephos7’s favorite modus\noperandi) is left to sheer unpredictability.\n\nThe situation is quite different if you take the perspective of a DSP. To qualify for the kind of\nscale that these threat actors are craving for, customers typically go through a thorough\napproval process, mostly focused on assessing risk based on reputation.\n\n## Burn and Repeat\n\nOnce they’ve committed their deed, the abused DSP forever bans the offending entity used\nto finance the malicious ad campaign. This constraint shapes for our attackers a fairly simple\ngame plan:\n\nCreate many legal entities,\nBurn them one by one with each DSP\nRepeat.\n\n\n-----\n\nDue to the lack of industry-wide buyer transparency, malicious entities have the leisure to\nstrike repeatedly without fear of industry-wide ban. We at Confiant sponsor an initiative to\n**provide this transparency: .**\n\n## Network of Organized Crime\n\nOver time, Confiant’s security team started to methodically pin attacks to their corresponding\nlegal entities. This effort could not have been possible without the cooperation of many\nimpacted DSPs (thank you!).\n\n## Nephos7 Entities\n\nNephos7 entities active in 2020\nWe believe Wooden Ads started operating some time in Q4 of 2019 as the first Nephos7\nfront company making the rounds through the major DSPs. With an incorporation in\nNovember 2017, one can only wonder what this company was previously used for. The level\nof sophistication we’ve identified right from its inception is consistent with a previous life in\nmalvertising.\n\nDespite a remarkable streak of Wooden Ads activity, it soon became time to invoke more\nlegal entities to establish more DSP connections. By June, Nephos7 started rolling out a\nwide range of entities that had been patiently staged since 2018. Incorporated in Colorado in\nMarch and October 2018 respectively, AdSige and SignalAds both appeared on our radar\nin June 2020 in separate attacks. In total, between June and November, 8 entities were\nresponsible for Nephos7 attacks. Paradoxically, this is also a time of decreased success,\ncharacterized by an inability to generate any significant volumes after July.\n\n\n-----\n\nwebsite: an almost copycat of Appular’s\n\nbusiness personas and legal presence in Australia\n\n\n-----\n\ndirectors residing in China (Beijing and Fujian)\n\nbusiness personas and legal presence in the UK\n\n\n-----\n\ndirector residing in China and China-based CPA\nWhile looking up the directors of Nephos7 entities (all individuals residing in China), we\nidentified many more dormant companies based in the UK, also established in 2018 and in\ngood standing as of late 2020, likely ready for a slew of new attacks.\n\n## eGobbler Entities\n\neGobbler entities active in 2019 and 2020\n\n\n-----\n\nConfiant has been tracking eGobbler since 2017 but only started building consistent entity\nattribution in 2020. We know however that eGobbler started out by registering legal entities\nin Hong Kong and over time realized that registering in the US would carry more reputation\nand facilitate building business relationships with DSPs. Two entities were created in August\n2019 and another two in March 2020, all with Chinese-named directors.\n\nArticles of Incorporation\n\neGobbler leveraged the services of a CPA firm located in California and specialized in\nassisting Chinese entrepreneurs build a presence in the US.\n\nWe were also able to expand our visibility on eGobbler entities with basic OSINT, pivoting on\nfake business personas and identifying other ad companies with similar profiles:\n\n\n-----\n\nPivoting from business persona to and via LinkedIn\n\n## Wrapping up\n\nWe believe we’ve achieved a significant level of visibility in both eGobbler’s and Nephos7’s\ninfrastructure. By disclosing our findings, we are hoping to ⑴ wipe out a good amount of\ntheir infrastructure in a single blow and ⑵ educate on these threats and how to defend\nagainst them.\n\nOne burning question remains: Are Nephos7 and eGobbler two divisions of the same group?\nAre they competitors? Having collected hundreds of IOCs on both actors, we can confidently\nsay that both infrastructures are completely separated and do not overlap. However, the\nmodes of operation and evolution of tactics are strikingly aligned in unique ways, suggesting\nthat the two Chinese groups are probably aware of each other and tracking each other’s\niterations.\n\n## IOCs\n\n[� Download all IOCs as STIX](https://github.com/WeAreConfiant/security/blob/master/stix-feeds/egobbler-nephos7.json)\n\n\n-----\n\nSTIX Representation of Nephos7, eGobbler and Holcus\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-03 - Malvertising- Made in China.pdf"
    ],
    "report_names": [
        "2021-02-03 - Malvertising- Made in China.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535943,
    "ts_updated_at": 1743041316,
    "ts_creation_date": 1653693121,
    "ts_modification_date": 1653693121,
    "files": {
        "pdf": "https://archive.orkl.eu/7e52e17c5567997803bb30b1f708f5b05149cdd5.pdf",
        "text": "https://archive.orkl.eu/7e52e17c5567997803bb30b1f708f5b05149cdd5.txt",
        "img": "https://archive.orkl.eu/7e52e17c5567997803bb30b1f708f5b05149cdd5.jpg"
    }
}