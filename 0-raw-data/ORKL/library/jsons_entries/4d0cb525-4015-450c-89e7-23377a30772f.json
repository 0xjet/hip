{
    "id": "4d0cb525-4015-450c-89e7-23377a30772f",
    "created_at": "2023-01-12T14:59:25.360799Z",
    "updated_at": "2025-03-27T02:16:03.327361Z",
    "deleted_at": null,
    "sha1_hash": "d005f692b43055e3422d044ab127b6d166a3b759",
    "title": "2021-03-02 - ObliqueRAT returns with new campaign using hijacked websites",
    "authors": "",
    "file_creation_date": "2022-05-28T15:28:41Z",
    "file_modification_date": "2022-05-28T15:28:41Z",
    "file_size": 2781610,
    "plain_text": "# ObliqueRAT returns with new campaign using hijacked websites\n\n**[blog.talosintelligence.com/2021/02/obliquerat-new-campaign.html](https://blog.talosintelligence.com/2021/02/obliquerat-new-campaign.html)**\n\nBy [Asheer Malhotra.](https://twitter.com/asheermalhotra)\n\nCisco Talos has observed another malware campaign that utilizes malicious Microsoft\nOffice documents (maldocs) to spread the remote access trojan (RAT) ObliqueRAT.\n\n\n-----\n\nThis campaign targets organizations in South Asia.\nObliqueRAT has been linked to the Transparent Tribe APT group in the past.\nThis campaign hides the ObliqueRAT payload in seemingly benign image files hosted\non compromised websites.\n\n## What's new?\n\nCisco Talos recently discovered another new campaign distributing the malicious remote\n[access trojan (RAT) ObliqueRAT. In the past, Talos connected ObliqueRAT and another](https://blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html)\n[campaign from December 2019 distributing CrimsonRAT. These two malware families share](https://attack.mitre.org/software/S0115)\nsimilar maldocs and macros. This new campaign, however, utilizes completely different\nmacro code to download and deploy the ObliqueRAT payload. The attackers have also\nupdated the infection chain to deliver ObliqueRAT via adversary-controlled websites.\n\n## How did it work?\n\nHistorically, this RAT is dropped to a victim's endpoint using malicious Microsoft Office\ndocuments (maldocs). These new maldocs, however, do not contain the ObliqueRAT\npayload directly embedded in the maldoc, as observed in previous campaigns. Instead, the\nattackers utilize a technique novel to their infection chain to infect targeted endpoints by\npointing users instead to malicious URLs. New core technical capabilities of ObliqueRAT\ninclude:\n\nThe maldocs-based infection chain.\nChanges/updates to its payload.\nAdditional links to previously observed malware attacks in the wild.\n\n## So what?\n\nThis new campaign is a typical example of how adversaries react to attack disclosures and\nevolve their infection chains to evade detections. Modifications in the ObliqueRAT payloads\nalso highlight the usage of obfuscation techniques that can be used to evade traditional\nsignature-based detection mechanisms. While file-signature and network-based detection is\nimportant, it can be complemented with system behavior analysis and endpoint protections\nfor additional layers of security.\n\n## Analysis of maldocs\n\nThe maldocs utilized in previous ObliqueRAT attacks used mechanisms identical to the\nCrimsonRAT delivery maldocs. The latest campaign distributing ObliqueRAT now utilizes\ncompletely different macro code in their maldocs.\n\n\n-----\n\nThe attack has also evolved to include the following functionalities:\n\nPayloads are now hosted on compromised websites.\nThe payloads hosted on these websites consist of seemingly benign BMP image files.\nThe malicious macros download the images and the ObliqueRAT payload is extracted\nto disk.\nThe ObliqueRAT payload is renamed with the .pif file extension.\n\nObliqueRAT payload extracted, written to file on disk and renamed.\n\nAnother instance of a maldoc uses a similar technique with the difference being that the\npayload hosted on the compromised website is a BMP image containing a ZIP file that\ncontains ObliqueRAT payload. The malicious macros are responsible for extracting the ZIP\nand subsequently the ObliqueRAT payload on the endpoint.\n\n**Persistence**\n\nThe macros are also responsible for achieving reboot persistence for the ObliqueRAT\npayloads. This is done by creating a shortcut (.url file extension) in the infected user's Startup\n\n\n-----\n\ndirectory.\n\nMalicious shortcut in the infected user's startup directory to execute ObliqueRAT on startup.\n\n## Image files\n\nThe image files used are BMP files hosted on adversary-controlled websites. The image files\ncontain legitimate image data and malicious executable bytes concealed in the image data\nbytes.\n\nImage file containing executable data in the BITMAPLINES (RGB data).\n\n\n-----\n\nObliqueRAT infection chain.\n\n## ObliqueRAT payload\n\nTalos discovered three new versions of ObliqueRAT as part of this investigation. This section\ncovers changes and updates introduced in these versions. For a complete technical analysis\nof ObliqueRAT, refer to our [previous blog post.](https://blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html)\n\nAfter the discovery of the previous ObliqueRAT payload (version 5.2) we observed four new\nversions:\n\n6.1, developed April 2020\n6.3.2, developed September 2020\n6.3.4, developed October 2020\n6.3.5 developed November 2020\n\n## Version 6.1\n\nThe attackers made a few key updates with version 6.1:\n\n\n-----\n\nAdded a new command code hb to the RAT. Although this command code doesn t\nreally do anything, it is highly likely that the attackers are preparing to introduce a new\nRAT capability.\nThe attackers introduced anti-infection checks in version 6.1. The implant does two\nsets of checks:\n\nCheck for blocklisted usernames and computernames: The implant concatenates the\nusername and computer it acquires from the infected endpoint's environment variables.\nThis string is then checked against a list of blocklisted values to determine if the\nimplant should continue execution or exit out. See a full list of these keywords under\nthe IOC section.\nCheck for blocklisted process names: The following process names are blocklisted and\nif found running on the system, the RAT implant will simply exit. The blocklist consists\nof processes belonging to Virtual Machine software (such as VMWare) and analysis\ntools (such as ProcessHacker etc.)\n\nIf any of the blocklisted strings match the artifacts on the endpoint, the implant stops\nexecution (without cleaning up its persistence mechanisms).\n\n## Version 6.3.2\n\nThis version adds new RAT capabilities to the implant. One of these consists of extracting\nfiles of interest from hot-pluggable or removable drives connected to the endpoint.\nSpecifically, the implant looks for files with the following extensions in the removable drives:\n\ndoc, docx\npdf\nppt, pptx\ntxt\nxls, xlsx\n\nThe implant will look for files with these extensions in the removable drive and the\n\"Recycled\" folder. Any files found will be copied to its own file repository at locations\nC:\\ProgramData\\System\\Recycled (from <Drive_letter>:\\Recycled) and\nC:\\ProgramData\\System\\Dump (from <Drive_Letter>:\\*).\n\nAnother new ObliqueRAT capability involves recursively enumerating files in the drives\npresent on the endpoint. The file paths are all recorded to location\n\"C:\\ProgramData\\DirecTree.txt\" (for the implant to later exfiltrate). The implant contains a\nhard-coded list of drives to enumerate:\n\nC:\\, D:\\, F:\\, G:\\, H:\\, I:\\, J:\\, K:\\, L:\\, M:\\, N:\\, O:\\, P:\\, Q:\\, R:\\, S:\\, T:\\, U:\\, V:\\, W:\\, X:\\, Y:\\, Z:\\\n\nThere are also new capabilities triggered by specific command codes from the command and\ncontrol (C2) that were introduced in version 6.3.2:\n\n\n-----\n\n**Command code = wes ; Webcam screenshot**\n\nCapture current view of the webcam to a DIB file located at \"C:\\ProgramData\\wsc\".\n\n\n-----\n\nCode to grab webcam frames and save to a DIB file.\n\n**Command code = \"sss\" ; Desktop Screenshot**\n\nCapture current screen (screenshot) and save screenshot as a JPEG to\n\"C:\\ProgramData\\tsc\".\n\nThe contents of the file are subsequently read and sent to the C2.\n\n\n-----\n\nCode to capture a screenshot as bitmap and save to file.\n\n**Command code = \"pizz\" Command Data=<filename> & <ZIP_file_name>**\n\nSimilar to command code \"4\". Here, the implant accepts the names of the target file and an\narchive file. The target file is added to the archive file created at \"C:\\ProgramData\\\n<archive_name>.zip\". However, in this case, the archive file is not exfiltrated to the C2 and is\nonly created on the endpoint).\n\n**Command code = \"plit\" Command Data=<target filepath>**\n\nReceive a file path from the C2 for a file to read. The target file is read and then split into\nsmaller files named \"<target_filename>.part_<part_number>\" and stored on disk. This\ncapability can be used to break large files of interest into smaller chunks to prepare them for\nexfiltration.\n\n## Version 6.3.4\n\nThis version contains minor changes to the ObliqueRAT implant including:\n\nRemoval of the \"backed\" command from the implant. This command was used to back\nup the contents of one log file to another.\nAddition of more anti-infection keywords to check on the endpoint (specifically for\nOracle VirtualBox VM detection).\nAddition of the \".csv\" file extension to targeted file types list copied over from\nremovable drives.\n\n\n-----\n\n## Version 6.3.5\n\nThe only update seen in this minor version update of ObliqueRAT is a change in the naming\nconvention of the Mutex created by the RAT.\n\nThe initial version of ObliqueRAT discovered in the wild by Talos created a mutex named\n\"Oblique\" on the system. The attackers then changed their naming convention and\nsubsequent versions of ObliqueRAT discovered (and detailed in this post) follow a different\nnaming convention:\n\nv6.1 :\"t802\" - Naming convention changed for mutex\nv6.3.2 :\"t803\"\nv6.3.4 :\"t804\"\nv6.3.5 :\"gaia5\" - Another change in Mutex naming convention (possible randomization).\n\n## Evolution of implants\n\nThe following is a timeline of the evolution of capabilities of the ObliqueRAT implants\ndiscovered so far:\n\n1. November 2019\n\n1. Version 5.2 of ObliqueRAT created, eventually disclosed in February 2020 by\n\nTalos.\n2. Distributed via maldocs containing embedded ObliqueRAT payloads.\n\n2. April 2020\n\n1. Version 6.1 of ObliqueRAT created.\n2. Introduction of anti-infection techniques.\n3. Added an empty command code \"hb\".\n\n3. September 2020\n\n1. Version 6.3.2 of ObliqueRAT created.\n2. Additional file enumeration and stealing capabilities.\n3. Webcam and desktop screenshot and recording RAT capabilities and commands\n\nintroduced.\n4. Distribution via maldocs employing BMPs containing ObliqueRAT payloads.\n4.\n\nOctober 2020\n\n1. Version 6.3.4 of ObliqueRAT created â€” minor update.\n2. More keywords added to anti-infection checks.\n\n\n-----\n\n3. Housekeeping ability to backup log files removed.\n4. Continued distribution via maldocs employing BMPs containing ObliqueRAT\n\npayloads.\n\n5. November 2020\n\n1. Version 6.3.5 of ObliqueRAT created - minor update.\n2. Same functionalities as v6.3.4. Only mutex name changed.\n\nEvolution of ObliqueRAT.\n\n\n-----\n\n## Related campaigns\n\n[Our previous post on ObliqueRAT detailed its connections to CrimsonRAT and,](https://blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html)\nsubsequently, the links to the Transparent Tribe APT group targeting organizations in South\nAsia. We have also observed overlaps in the C2 infrastructure used between ObliqueRAT\n[and a RevengeRAT campaign. Talos assesses with low confidence that there is a possible](https://attack.mitre.org/software/S0379)\nlink between certain RevengeRAT campaigns and ObliqueRAT and its operators.\n\nRevengeRAT is a .NET-based RAT whose source code was leaked publicly a few years ago.\nIt has increasingly become a common practice for crimeware and state-sponsored groups to\nutilize leaked malware. This practice takes away the need to develop implants and C2\nservers from scratch and increases the chances of misattribution.\n\n## Conclusion\n\nThis campaign shows a threat actor evolving their infection techniques so that they no longer\nresemble those used previously. It is highly likely that these changes are in response to\n[previous disclosures to achieve evasion for these new campaigns. The usage of](https://blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html)\ncompromised websites is another attempt at detection evasion. The adversaries have also\nintroduced steganography as a way to hide the ObliqueRAT payloads in image files. This\ntechnique is novel to ObliqueRAT's distribution chain (not observed in the past). This new\ncampaign distributing ObliqueRAT started in April 2020 and is still ongoing. This campaign\nalso highlights that while network-based detection is important, it must be complemented\nwith system behavior analysis and endpoint protections.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware detailed in this post. Below is a screenshot showing how AMP can protect\ncustomers from this threat. Try AMP for free [here.](https://cisco.com/go/tryamp)\n\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), and](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html) [Meraki MX can detect malicious activity](https://meraki.cisco.com/products/appliances)\nassociated with this threat.\n\n[Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs and URLs, whether users are on or off the corporate network.\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Firepower Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/)\n\n\n-----\n\nCisco AMP users can use Orbital Advanced Search to run complex OSqueries to see if their\nendpoints are infected with this specific threat. For specific OSqueries on this threat, click\n[here.](https://github.com/Cisco-Talos/osquery_queries/blob/master/packs/win_malware.conf)\n\n## IOCs\n\n**Maldocs**\n\n2ad362e25989b0b1911310345da90473df9053190737c456494b0c26613c8d1f\n\n0196bc9ac3db6f02cfa97323c8fce6cc7318b8f8fadb3e73bdf7971b3c541964\n\nb85536589c79648a10868b58075d7896ec09bbde43f9c4bad95ed82a200652bc\n\n**Image files**\n\n553502bfe265a7e75a1d2202776fd816cabccfcdb200cc180dc507f4d45668d2\n\nec85e270c5cb159255a3178117197d275a6a90295fd31248b397dc03bcc4f3e4\n\n84aa777badab889d066e3a57c6a3d2096bc978c01499ea3dd8dd65fe44a3c98f\n\n**ObliqueRAT payloads**\n\n5a425372fac8e62d4b5d5be8054967eabe1e41894bcb8c10e431dd2e06203ca0\nbdb184f4c8416c271ad2490c1165ee4d6e2efcf82a1834ba828393c74e190705\n926d3f258fe2278bd1d220fafb33f246f9db9014204337f05a25d072bb644b6d\n\n0ade4e834f34ed7693ebbe0354c668a6cb9821de581beaf1f3faae08150bd60d\n\n**Malicious domains**\n\nlarsentobro[.]com\n\n**URLs**\n\nhxxp://iiaonline[.]in/DefenceLogo/theta.bmp\n\nhxxp://iiaonline[.]in/timon.jpeg\n\nhxxp://iiaonline[.]in/9999.jpg\n\nhxxp://iiaonline[.]in/merj.bmp\n\nhxxp://iiaonline[.]in/111.jpg\n\nhxxp://iiaonline[.]in/sasha.jpg\n\nhxxp://iiaonline[.]in/111.png\n\nhxxp://iiaonline[.]in/camela.bmp\n\nhxxp://larsentobro[.]com/mbda/goliath1.bmp\n\nhxxp://larsentobro[.]com/mbda/mundkol\n\nhxxp://drivestransfer[.]com/myfiles/Dinner%20Invitation.doc/win10/Dinner%20Invitation.doc\n\n**ObliqueRAT CnCs**\n\n\n-----\n\nmicrsoft[.]ddns.net\n185[.]183.98.182:4701\n\n**Related RevengeRAT payloads**\n\n47bed59051a727911b050c2922874ae817e05860e4eee83b323f9feab710bf5c\n\n23577ceb59f606ae17d9bdabaccefcb53dc2bac19619ce8a2d3d18ecb84bcacd\n\na9d9d7f6dd297af2bb3165ad0bfe3bbb88969393a3534bd33ef9aad062aefd05\n\n**RevengeRAT CnC**\n\nmicrsoft[.]ddns.net:4313\n\nyepp[.]ddns.net:4315\n\n**Blocklisted Usernames and Computer names**\n\nBlocklisted keywords for username and computername:\n\n15pb\n7man2\nstella\nf4kh9od\nwillcarter\nbiluta\nehwalker\nhong lee\njoe cage\njonathan\nkindsight\nmalware\npeter miller\npetermiller\nphil\nrapit\nr0b0t\ncuckoo\nvm-pc\nanalyze\n\nroslyn\nvince\ntest\nsample\nmcafee\nvmscan\n\n\n-----\n\nmallab\nabby\nelvis\nwilbert\njoe smith\nhanspeter\njohnson\nplacehole\ntequila\npaggy sue\nklone\noliver\nstevens\nieuser\nvirlab\nbeginer\nbeginner\nmarkos\nsemims\ngregory\ntom-pc\nwill carter\nangelica\neric johns\njohn ca\nlebron james\nrats-pc\nrobot\nserena\nsofynia\nstraz\nbea-ch\n\nBlocklisted process names\n\npython\nvmacthlp\nVGAuthService\nvmtoolsd\nTPAutoConnSvc\nftnlsv\nftscanmgrhv\nvmwsprrdpwks\nusbarbitrator\n\n\n-----\n\nhorizon_client_service\nProcessHacker\nprocexp\nAutoruns\npestudio\nWireshark\ndumpcap\nTSVNCache\ndnSpy\nConEmu\n010Editor\nida64\nProcmon\nollydbg\nLordPE\nFiddler\nCFF Explorer\nsample\nvboxservice\nvboxtray\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-02 - ObliqueRAT returns with new campaign using hijacked websites.pdf"
    ],
    "report_names": [
        "2021-03-02 - ObliqueRAT returns with new campaign using hijacked websites.pdf"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535565,
    "ts_updated_at": 1743041763,
    "ts_creation_date": 1653751721,
    "ts_modification_date": 1653751721,
    "files": {
        "pdf": "https://archive.orkl.eu/d005f692b43055e3422d044ab127b6d166a3b759.pdf",
        "text": "https://archive.orkl.eu/d005f692b43055e3422d044ab127b6d166a3b759.txt",
        "img": "https://archive.orkl.eu/d005f692b43055e3422d044ab127b6d166a3b759.jpg"
    }
}