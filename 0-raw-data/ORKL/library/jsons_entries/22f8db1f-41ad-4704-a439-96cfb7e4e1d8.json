{
    "id": "22f8db1f-41ad-4704-a439-96cfb7e4e1d8",
    "created_at": "2023-01-12T15:00:25.607982Z",
    "updated_at": "2025-03-27T02:17:11.384198Z",
    "deleted_at": null,
    "sha1_hash": "a24e023be6c0f3bf6ec94c5b700c7c4d8807ccba",
    "title": "2020-12-17 - Pawn Storm’s Lack of Sophistication as a Strategy",
    "authors": "",
    "file_creation_date": "2022-05-28T02:18:46Z",
    "file_modification_date": "2022-05-28T02:18:46Z",
    "file_size": 402432,
    "plain_text": "# Pawn Storm’s Lack of Sophistication as a Strategy\n\n**trendmicro.com/en_us/research/20/l/pawn-storm-lack-of-sophistication-as-a-strategy.html**\n\nDecember 17, 2020\n\nFigure 1. Spear phishing email from Pawn Storm – collected in August 2020.\nStarting from August 2020, Pawn Storm has sent several spear phishing emails with a malicious RAR attachment. Among the earliest samples\nwe received were two almost identical RAR files that contained a file called info.exe. Both versions of the info.exe files are self-extracting\narchives (SFX) that extract and execute two files: decrypt.exe and gdrive.exe. We have:\n\n**c4a61b581890f575ba0586cf6d7d7d3e0c7603ca40915833d6746326685282b7 installing**\n\ndecrypt.exe – 661d4a0d877bac9b813769a85c01bce274a77b29ccbd4b71e5b92df3c425b93b\ngdrive.exe – cbd9cb7b69f864ce8bae983ececb7cf8627f9c17fdaba74bd39baa5cdf605f79\n\n**3fd45b9b33ff5b6363ba0013178572723b0a912deb8235a951aa3f0aa3142509 installing**\n\ndecrypt.exe – 661d4a0d877bac9b813769a85c01bce274a77b29ccbd4b71e5b92df3c425b93b\ngdrive.exe – 2060f1e108f5feb5790320c38931e3dc6c7224edf925bf6f1840351578bbf9cc\n\n## Decoy File\n\n\n-----\n\ne ot ced t at t e e dec ypt e e s a decoy e t at u o ce o e e s e ecuted e app cat o o y s o a essage bo\nwherein a user can type a password for decryption. Checking the disassembly of this file reveals that it only shows another message box when\na password is entered on the main application.\n\nFigures 2-3. The message box that decrypt.exe displays\n\nAfter closing this application, the file gdrive.exe will be executed by the SFX archive. The different versions of gdrive.exe are almost identical,\nwith a minor addition to the file 2060f1e108f5feb5790320c38931e3dc6c7224edf925bf6f1840351578bbf9cc of base64 encoding on the victim’s\nid.\n\nFigure 4.\n\nDrive.exe code snippet showing comp_id\n\nFigure 5.\n\nDrive.exe code snippet showing comp_id and base64 encoding\n\n### Initial Run\n\nThe first thing this malware does is it copies itself to the startup directory for persistence. It does this via cmd.exe with the following command:\n\nmove /Y \"{malware_location}\"\n\n\"C:\\Users\\{username}\\AppData\\Roaming\\Microsoft\\Windows\\Start\n\nMenu\\Programs\\Startup\\gdrive.exe\"\n\nEvery time the malware runs a command using cmd.exe, the standard output (STDOUT) of the executed command is piped and written to a\nGoogle Drive account with the following filename format:\n\n{utcnow}_report_{victim’s id}\n\nFigure 6. Code snippet showing the execution of\n\ncommands\nThe client key and token used to read and write the attacker’s Google Drive account is hardcoded on the malware itself.\n\nFigures 7-8.\n\nCode snippets showing client key and token\nSending back the information through Google Drive will allow the attacker to check if the machine that executed the malware was the intended\nvictim they wanted to target.\n\n\n-----\n\n### ece g co a ds a d data e t at o\n\nEvery 20 minutes, the bot checks for a file in Google Drive. If a file with a corresponding filename format exist (cmd_{victim’s id}), it downloads\nthat file and runs the contents as a batch file.\n\nFigure 9. Code snippets showing waiting for commands\n\nAgain, the STDOUT of the commands will be written back to Google Drive as a result. This works as a reverse shell back to the attacker with\nGoogle Drive as the Command and Control (C&C) server.\n\nThe command file that the bot received from Google Drive will also be deleted once it is downloaded.\n\nFigure 10. Code snippets showing\n\nreadFile\nUsing the “reverse shell” method mentioned above, the attacker can exfiltrate data/documents using the following commands:\n\npowershell -command \"[Convert]::ToBase64String([IO.File]::ReadAllBytes('{filename}')\n\nFigure 11. Code snippets showing\n\nthe exfiltration of data\nThe secondary payload with the filename Google Drivemonitor.exe\n(0b94e123f6586967819fa247cdd58779b1120ef93fa1ea1de70dffc898054a09) is a keylogger. The collected keystrokes are stored in the same\ndirectory from which the malware was executed.\n\nFigure 12.\n\nCode snippets showing keylogs\nThis secondary payload does not have any function to upload the collected keystrokes back to the attacker. However, since the main malware\nacts as a “reverse shell,” the attacker can retrieve the collected keystrokes at a later time.\n\nEventually, the threat actor added improvements to the malware, like encryption. Later the actor started to use IMAP RATs as well.\n\n## Trend Micro solutions\n\n[Trend Micro recommends Trend MicroTM](https://www.trendmicro.com/en_us/business/products/detection-response.html) XDR for extensive monitoring across the connected layers of email, endpoints, cloud workloads, and\nnetworks. Powered by advanced AI and expert security analytics for correlating data, XDR allows earlier detection and response and lessens\nalert fatigue for IT security teams.\n\n\n-----\n\ne a so o e e d c o a aged, a / se ce t at a esses t e s s o ou e pe t a aged etect o a d espo se a a ysts o\nexpert threat monitoring, correlation, and analysis.\n\n## Indicators of compromise\n\nIP addresses\n\n**IP address** **Description** **Dates active**\n\n\n34.243.239[.]199 Connects to email servers of compromised accounts. IP address possibly\ncompromised by Pawn Storm.\n\n74.208.228[.]186 Connects to email servers of compromised accounts. IP address possibly\ncompromised by Pawn Storm.\n\n\nOctober 29, 2020 – December\n8, 2020\n\nOctober 15, 2020 – December\n14, 2020\n\n\n193.56.28[.]25 Scans TCP port 445 and 1433 May 21 – May 26, 2020\n\n195.191.235[.]155 Scans UDP port 389 August 22, 2020\n\nFiles\n\n**SHA256** **Filename** **Description** **Trend Micro Pattern Detecti**\n\n\nc4a61b581890f575ba0586cf6d7d7d3e0c7603ca40915833d6746326685282b7 info.exe Google\nDrive RAT\n\n3fd45b9b33ff5b6363ba0013178572723b0a912deb8235a951aa3f0aa3142509 info.exe Google\nDrive RAT\n\ncbd9cb7b69f864ce8bae983ececb7cf8627f9c17fdaba74bd39baa5cdf605f79 gdrive.exe Google\nDrive RAT\n\n2060f1e108f5feb5790320c38931e3dc6c7224edf925bf6f1840351578bbf9cc gdrive.exe Google\nDrive RAT\n\nf364729450cb91b2a4c4e378c08e555137028c63480a221bb70e7e179a03f5cc gdrive.exe Google\nDrive RAT\n\n\nTrojan.MSIL.DRIVEOCEAN.A\n\nTrojan.MSIL.DRIVEOCEAN.A\n\nTrojan.MSIL.DRIVEOCEAN.A\n\nTrojan.MSIL.DRIVEOCEAN.A\n\nTrojan.MSIL.DRIVEOCEAN.A\n\n\ne3894693eff6a2ae4fa8a8134b846c2acaf5649cd61e71b1139088d97e54236d info.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n83fbd76d298253932aa3e3a9bc48c201fe0b7089f0a7803e68f41792c05c5279 decrypt_v2.4.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\nfe00bd6fba209a347acf296887b10d2574c426fa962b6d4d94c34b384d15f0f1 email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\nb61e0f68772f3557024325f3a05e4edb940dbbe380af00f3bdaaaeabda308e72 igmtSX.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\nc8b6291fc7b6339d545cbfa99256e26de26fff5f928fef5157999d121fe46135 igmtSX.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n50b000a7d61885591ba4ec9df1a0a223dbceb1ac2facafcef3d65c8cbbd64d46 email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n3384a9ef3438bf5ec89f268000cc7c83f15e3cdf746d6a93945add300423f756 email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\nabf0c2538b2f9d38c98b422ea149983ca95819aa6ebdac97eae777ea8ba4ca8c email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\nfaf8db358e5d3dbe2eb9968d8b19f595f45991d938427124161f5ed45ac958d5 email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n4c1b8d070885e92d61b72dc9424d9b260046f83daf00d93d3121df9ed669a5f9 email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n\n-----\n\n770206424b8def9f6817991e9a5e88dc5bee0adb54fc7ec470b53c847154c22b email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n6fb2facdb906fc647ab96135ce2ca7434476fb4f87c097b83fd1dd4e045d4e47 email.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n31577308ac62fd29d3159118d1f552b28a56a9c039fef1d3337c9700a3773cbf photos.exe IMAP RAT Trojan.MSIL.OCEANMAP.A\n\n661d4a0d877bac9b813769a85c01bce274a77b29ccbd4b71e5b92df3c425b93b decrypt.exe decoy file N/A\n\n\n0b94e123f6586967819fa247cdd58779b1120ef93fa1ea1de70dffc898054a09 Google\nDrivemonitor.exe\n\n\nkeylogger TrojanSpy.MSIL.KEYLOGGR\n\n\nA defender who finds a simple remote access trojan (RAT) in the network won’t immediately think it was from an advanced persistent threat\n(APT) actor. Likewise, brute force attacks on internet-facing services like email, Microsoft Autodiscover, SMB, LDAP, and SQL are so common\nthat they may seem like background noise that can be ignored. But in 2020, the notorious APT actor Pawn Storm used exactly these nonsophisticated attack methods to such an extent that their attacks may get lost in the noise.\n\nIn 2020 Pawn Storm spread simple Google Drive and IMAP Remote Access Trojans (RATs) to attack their usual targets, such as ministries of\nforeign affairs, embassies, the defense industry and the military. The RATs were also sent to a wider net of targets including various industries\naround the world. The group also performed widespread brute force attacks to steal credentials such as those of corporate email accounts, as\nevidenced by network probes we attribute to Pawn Storm and the loose way the actor abused compromised email accounts in malware and in\nsending spear-phishing emails. Pawn Storm even hardcoded compromised military and government-related email addresses in their IMAP\nRAT malware to communicate with victims’ computers. Recently, Norwegian authorities announced that Pawn Storm hacked the Norwegian\nparliament through brute force attacks.\n\nAs shown in incremental improvements, subsequent versions of the malware hint towards a learning curve of the malware author that is more\ntypical for an inexperienced actor than for an advanced actor. First, the RATs were so simple that they did not even take into account\ninternational keyboards. This means it would be difficult for the attacker to enumerate the victims’ hard drives with files and folders that contain\ninternational characters. This mistake was corrected swiftly, but it shows the relative inexperience of this particular Pawn Storm operator. Later\nversions of the RAT malware started to use encryption, which could have been added right from the start. The only secondary payload we\nobserved was a simple keylogger that stores stolen information locally on the victims’ machines.\n\nAttribution to Pawn Storm of these malware samples would be difficult with only the samples at hand. Typically, a network defender would not\nattribute this kind of malware to an APT actor at all. However, we have solid attribution for these samples based on our long-term monitoring of\nPawn Storm’s activities.\n\nRecap of recent Pawn Storm activities\n**Compromising accounts of users from the Middle East**\n\n[Trend Micro has been closely and consistently monitoring the activities of Pawn Storm, and in March 2020, we released our latest research on](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/probing-pawn-storm-cyberespionage-campaign-through-scanning-credential-phishing-and-more)\nthe group. In the aforementioned research paper, we shared that Pawn Storm heavily abuses compromised accounts — mainly in the Middle\nEast — to send spear-phishing emails. The abuse of compromised email accounts in the Middle East continued in 2020. For example, in early\nDecember 2020 the group used a VPN service to connect to a compromised cloud server, then used the cloud server to connect to a\ncommercial business email service provider. The group then logged in to a compromised email account of a chicken farm in Oman, and then\nsent out credential phishing spam messages to high-profile targets around the world. This shows that Pawn Storm is careful at obfuscating\ntheir tracks on multiple levels.\n\nThe abuse of various compromised email accounts in the Middle East started in May 2019 and continues today. Since August 2020, they didn’t\nuse these email addresses to only send spear-phishing emails, but also as a way to communicate with compromised systems in IMAP RATs.\n\n**Brute force attacks**\n\nWe think that Pawn Storm compromises lots of email accounts through brute force attacks on internet-facing services like email, LDAP,\nMicrosoft Autodiscover, SMB, and SQL. For example, in May 2020, Pawn Storm scanned IP addresses worldwide, including IP addresses\nfrom the defense industry in Europe, on TCP port 445 and 1433, likely in an attempt to find vulnerable SMB and SQL servers or brute force\ncredentials. In August 2020, Pawn Storm also sent UDP probes to LDAP servers around the world from one of their dedicated IP addresses.\n\nIn 2020, Pawn Storm often tries to obfuscate these brute force attempts by routing their attack traffic over Tor and VPN servers. Yet this is not\n[always enough to hide these activities. In a Microsoft article about brute-forcing Office365 credentials over Tor, Microsoft attributed the](https://www.microsoft.com/security/blog/2020/09/10/strontium-detecting-new-patters-credential-harvesting/)\nactivities to Strontium, which is another name for Pawn Storm. We wrote about [related attacks in early 2020. These brute force attacks started](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/probing-pawn-storm-cyberespionage-campaign-through-scanning-credential-phishing-and-more)\nin 2019, and then we could firmly attribute them to Pawn Storm because we could cross-relate the extensive probing of Microsoft Autodiscover\nservers around the world with high-confidence indicators of the group’s more traditional attack methods (spear phishing and credential\nphishing).\n\nTo illustrate the simplicity of the malware in Pawn Storm’s recent spear-phishing attacks, we describe one example below:\n\n\n-----\n\nec ca a a ys s o Goog e e\n\nAPT & Targeted Attacks\n\nIn this entry we share Pawn Storm's recent activities, focusing on their use of some simple methods that typically won't get associated with\nAPT groups.\n\nBy: Feike Hacquebord, Lord Alfred Remorin December 17, 2020 Read time: ( words)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-17 - Pawn Storm’s Lack of Sophistication as a Strategy.pdf"
    ],
    "report_names": [
        "2020-12-17 - Pawn Storm’s Lack of Sophistication as a Strategy.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535625,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653704326,
    "ts_modification_date": 1653704326,
    "files": {
        "pdf": "https://archive.orkl.eu/a24e023be6c0f3bf6ec94c5b700c7c4d8807ccba.pdf",
        "text": "https://archive.orkl.eu/a24e023be6c0f3bf6ec94c5b700c7c4d8807ccba.txt",
        "img": "https://archive.orkl.eu/a24e023be6c0f3bf6ec94c5b700c7c4d8807ccba.jpg"
    }
}