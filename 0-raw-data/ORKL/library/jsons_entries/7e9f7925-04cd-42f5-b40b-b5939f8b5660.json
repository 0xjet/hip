{
    "id": "7e9f7925-04cd-42f5-b40b-b5939f8b5660",
    "created_at": "2023-01-12T15:06:32.272165Z",
    "updated_at": "2025-03-27T02:09:30.093192Z",
    "deleted_at": null,
    "sha1_hash": "de0836cb96d0f34cbe07b6e0a6de46ffad35f21b",
    "title": "2021-07-22 - Updated XCSSET Malware Targets Telegram, Other Apps",
    "authors": "",
    "file_creation_date": "2022-05-28T03:35:17Z",
    "file_modification_date": "2022-05-28T03:35:17Z",
    "file_size": 2720787,
    "plain_text": "# Updated XCSSET Malware Targets Telegram, Other Apps\n\n**[trendmicro.com/en_us/research/21/g/updated-xcsset-malware-targets-telegram--other-apps.html](https://www.trendmicro.com/en_us/research/21/g/updated-xcsset-malware-targets-telegram--other-apps.html)**\n\nMalware\n\n\nJuly 22, 2021\n\n\nIn our last update on the XCSSET campaign, we updated some of its features targeting latest macOS 11 (Big Sur). Since then,\nthe campaign added more features to its toolset, which we have continually monitored. We have also discovered the mechanism\nused to steal information from various apps, a behavior that has been present since we first discussed XCSSET.\n\nBy: Mickey Jin, Steven Du July 22, 2021 Read time: ( words)\n\nIn our last [update on the XCSSET campaign, we updated some of its features targeting latest macOS 11 (Big Sur). Since then,](https://www.trendmicro.com/en_us/research/21/d/xcsset-quickly-adapts-to-macos-11-and-m1-based-macs.html)\nthe campaign added more features to its toolset, which we have continually monitored. We have also discovered the mechanism\nused to steal information from various apps, a behavior that has been present since we first discussed XCSSET.\n\n**How XCSSET Malware Steals Information**\n\nFrom the first version of XCSSET, we noticed that it collects some data from various apps and sends these back to its commandand-control (C&C) server. However, we did not know how the threat actor would use the data. We recently found the mechanism\nused to steal the data, and learned that it contains valuable and sensitive information that can be used for various purposes.\n\nTake the malicious AppleScript file “telegram.applescript” as an example. As the name implies, Telegram is the target app in this\ncase. Its main logic is compressing the folder “~/Library/Group Containers/6N38VWS5BX.ru.keepcoder.Telegram” into a .ZIP file,\nand uploading the said file to a C&C server.\n\n\n-----\n\nFigure 1. Code of telegram.applescript\nTo find the purpose of collecting the folder, we performed a simple test using two Mac machines:\n\n1. Install Telegram on both machine A and B./li>\n2. On machine A, log in with a valid Telegram account. Do nothing using Telegram on machine B./li>\n3. Copy “~/Library/Group Containers/6N38VWS5BX.ru.keepcoder.Telegram” folder from machine A to machine B, and\n\nreplace the existing folder.\n4. Run Telegram on machine B. When this is done, it is already logged in with the same account used on machine A.\n\nOn macOS, the Application sandbox directory ~/Library/Containers/com.xxx.xxx and ~/Library/Group Containers/com.xxx.xxx\ncan be accessed (with READ/WRITE permissions) by common users. This differs from the practice on iOS. Not all executable\nfiles are sandboxed on macOS, which means a simple script can steal all the data stored in the sandbox directory. We\nrecommend that application developers refrain from storing sensitive data in the sandbox directory, particularly those related to\nlogin information.\n\n**Sensitive data targeted by XCSSET**\n\nXCSSET malware has stolen lots of critical privacy data of these applications, with most of them these stored in their sandbox\ndirectories. Here, we’ll show how it is done in Chrome.\n\nIn Chrome, the stolen data includes any passwords stored by the user to dump the data, XCSSET needs to get the\n_safe_storage_key using the command security find- generic-password -wa ‘Chrome’ . However, this command requires root_\nprivileges. To get around this requirement, the malware puts all the operations that need root privilege together in a single\nfunction, as seen in Figure 2:\n\nFigure 2. Operations requiring administrator privilege\nThe user is then prompted to grant these privileges via a fake dialog box.\n\nOnce it has obtained the Chrome safe_storage_key, it decrypts all the sensitive data and uploads it to the C&C server.\n\n\n-----\n\ntargeting Google Chrome\n\nChrome\n\n\nFigure 3. Information stealing code\n\nFigure 4. Information stealing code targeting Google\n\n\n-----\n\nSimilar scripts can be found targeting the following applications:\n\nContacts\nEvernote\nNotes\nOpera\nSkype\nWeChat\n\n**New C&C Domains**\n\nFrom April 20 to 22, 2021, some new domain names appeared, all of them resolve to the IP address 94.130.27.189, which\nXCSSET also used before.\n\natecasec.com\nlinebrand.xyz\nmantrucks.xyz\nmonotal.xyz\nnodeline.xyz\nsidelink.xyz\n\nSimilarly, the domain name below now resolves from a non-malicious IP address to 94.130.27.189.\n\nicloudserv.com\n\nAll these new domain names have an HTTPS certificate from “Let’s Encrypt,” which is valid from April 22 to July 21, 2021.\n\nFigure 5. HTTPS\n\ncertificate for C&C servers\n\n\n-----\n\nFrom April 22, 2021, onwards, all C&C domain names resolved to 194.87.186.66. On May 1, a new domain name (irc\nnbg.v001.com) was resolved to the original C&C IP address 94.130.27.189. This new domain name suggests an IRC server is\nnow located at the said IP address, which does not appear to be currently related to XCSSET.\n\nFrom June 9 to 10, 2021, all existing domain names related to XCSSET C&C servers were removed, Instead, the following new\ndomain names were added:\n\natecasec.info\ndatasomatic.ru\nicloudserv.ru\nlucidapps.info\nrelativedata.ru\nrevokecert.ru\nsafariperks.ru\n\nHowever, on June 24, these servers were taken offline by the attackers. Currently, we have been unable to locate the new\nservers of XCSSET.\n\n**Other Behavior Changes**\n\n_Bootstrap.applescript_\n\nIn bootstrap.applescript, the first noteworthy change is the use of the latest C&C domains:\n\nFigure 6. C&C domains used\nNote that aside from the available domain names, the IP address is also part of the list. Even if all the domains get suddenly shut\ndown in the future, the C&C server still can be reached via IP address.\n\nFigure 7. Modules in use\n\nA new module, “canary,” is added to perform XSS injection on the Chrome Canary browser from Google, which is an\nexperimental version of the Chrome browser.\n\n\n-----\n\nFigure 8. Modules in use, showing removed module\nCompared to the last version, the calling for “screen_sim” is removed.\n\n_Replicator.applescript_\n\nAs the first step of infecting local Xcode projects, from the last version, they changed the injected build phrase or build rule’s ID\nfrom a hardcoded ID to a randomly generated ID; however, the last six characters of the ID is still hardcoded as “AAC43A”. In the\nlatest version, the hardcoded postfix changed to “6D902C”.\n\nFigure 9. Changed postfix\nRegarding the logic of the script in injecting fake build phase and build rule: Previously, it called a malicious Mach-O file located\nin a hidden folder in the infected Xcode project. Now, it calls the curl command to download a shell script named “a” from the\nC&C server and passes its contents to “sh” to execute it. This way, any new infected Xcode projects from the latest version will\nnot contain additional malicious files.\n\nFigure 10. Code for downloading and running the shellcode\n\n\n-----\n\nHere are the contents of the shell script file downloaded from the C&C server. It downloads the landing Mach O component Pods\nfrom the C&C server, saves it as /tmp/exec.$$, adds an executable flag, and executes it.\n\nFigure 11. Downloaded code\nSame as before, the Mach-O file, “Pods,” is generated by the SHC tool. The primary logic of the shell script extracted from it is\nquite similar to the one used before. The following screenshots list some of the notable changes.\n\nFigure\n\n12. The working folder changed from “GemeKit” to “GeoServices”\n\nFigure\n\n13. The fake app’s name changed from Xcode.app to Mail.app\n\n\n-----\n\nFigure 14. Temp files are created for debugging\n\n**Defending against XCSSET**\n\nThe changes we’ve encountered in XCSSET do not reflect a fundamental change in its behavior but do constitute refinements in\nits tactics. The discovery of how it can steal information from various apps highlights the degree to which the malware\naggressively attempts to steal various kinds of information from affected systems.\n\nTo protect systems from this type of threat, users should only download apps from official and legitimate marketplaces. Users\n[can also consider multilayered security solutions such as Trend Micro Maximum Security, which provides comprehensive](https://www.trendmicro.com/en_us/forHome/products/antivirus-for-mac.html)\nsecurity and multidevice protection against cyberthreats.\n\nEnterprises can take advantage of Trend Micro’s [Smart Protection Suites with XGen™ security, which infuses high-](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\n[fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across any user activity or](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/machine-learning)\nendpoint.\n\n**Indicators of Compromise**\n\nFile Name SHA256 Trend Micro Detection\nName\n\nbootstrap.applescript f453e8ae426133ace544cd4bb1ab2435620a8d4d5f70b936d8f3118e22f254e8 Trojan.macOS.XCSSET.C\n\nreplicator.applescript 7a51fd3080ee5f65c9127603683718a3fd4f3e0b13de6141824908a6d3d4b558 Trojan.macOS.XCSSET.C\n\nPods bbcc8a101ae0e7fc546dab235387b0bf7461e097578fedcb25c4195bc973f895 Trojan.macOS.XCSSET.C\n\na d8f14247ef18edaaae2c20dee975cd98a914b47548105cfbd30febefe2fa2a6b Trojan.macOS.XCSSET.C\n\n_C&C Servers_\n\n194.87.186.66\natecasec.info\ndatasomatic.ru\nicloudserv ru\n\n\n-----\n\nlucidapps.info\nrelativedata.ru\nrevokecert.ru\nsafariperks.ru\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-22 - Updated XCSSET Malware Targets Telegram, Other Apps.pdf"
    ],
    "report_names": [
        "2021-07-22 - Updated XCSSET Malware Targets Telegram, Other Apps.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535992,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653708917,
    "ts_modification_date": 1653708917,
    "files": {
        "pdf": "https://archive.orkl.eu/de0836cb96d0f34cbe07b6e0a6de46ffad35f21b.pdf",
        "text": "https://archive.orkl.eu/de0836cb96d0f34cbe07b6e0a6de46ffad35f21b.txt",
        "img": "https://archive.orkl.eu/de0836cb96d0f34cbe07b6e0a6de46ffad35f21b.jpg"
    }
}