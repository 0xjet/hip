{
    "id": "25c94f7c-e064-4f92-8fcb-6ab2719326ff",
    "created_at": "2023-01-12T15:05:38.679482Z",
    "updated_at": "2025-03-27T02:05:54.587776Z",
    "deleted_at": null,
    "sha1_hash": "6b0a1ccaa37fa251291e7c417f367f0d6e038515",
    "title": "2018-07-20 - Alert (TA18-201A) Emotet Malware",
    "authors": "",
    "file_creation_date": "2022-05-27T23:04:33Z",
    "file_modification_date": "2022-05-27T23:04:33Z",
    "file_size": 384603,
    "plain_text": "# Alert (TA18-201A)\n\n**us-cert.gov/ncas/alerts/TA18-201A**\n\n### Systems Affected\n\nNetwork Systems\n\n### Overview\n\nEmotet is an advanced, modular banking Trojan that primarily functions as a downloader or\ndropper of other banking Trojans. Emotet continues to be among the most costly and\ndestructive malware affecting state, local, tribal, and territorial (SLTT) governments, and the\nprivate and public sectors.\n\nThis joint Technical Alert (TA) is the result of Multi-State Information Sharing & Analysis\nCenter (MS-ISAC) analytic efforts, in coordination with the Department of Homeland Security\n(DHS) National Cybersecurity and Communications Integration Center (NCCIC).\n\n### Description\n\nEmotet continues to be among the most costly and destructive malware affecting SLTT\ngovernments. Its worm-like features result in rapidly spreading network-wide infection, which\nare difficult to combat. Emotet infections have cost SLTT governments up to $1 million per\nincident to remediate.\n\nEmotet is an advanced, modular banking Trojan that primarily functions as a downloader or\ndropper of other banking Trojans. Additionally, Emotet is a polymorphic banking Trojan that\ncan evade typical signature-based detection. It has several methods for maintaining\npersistence, including auto-start registry keys and services. It uses modular Dynamic Link\nLibraries (DLLs) to continuously evolve and update its capabilities. Furthermore, Emotet is\nVirtual Machine-aware and can generate false indicators if run in a virtual environment.\n\nEmotet is disseminated through malspam (emails containing malicious attachments or links)\nthat uses branding familiar to the recipient; it has even been spread using the MS-ISAC\nname. As of July 2018, the most recent campaigns imitate PayPal receipts, shipping\nnotifications, or “past-due” invoices purportedly from MS-ISAC. Initial infection occurs when a\nuser opens or clicks the malicious download link, PDF, or macro-enabled Microsoft Word\ndocument included in the malspam. Once downloaded, Emotet establishes persistence and\nattempts to propagate the local networks through incorporated spreader modules.\n\n\n-----\n\nFigure 1: Malicious email distributing Emotet\n\nCurrently, Emotet uses five known spreader modules: NetPass.exe, WebBrowserPassView,\nMail PassView, Outlook scraper, and a credential enumerator.\n\n1. NetPass.exe is a legitimate utility developed by NirSoft that recovers all network\n\npasswords stored on a system for the current logged-on user. This tool can also\nrecover passwords stored in the credentials file of external drives.\n2. Outlook scraper is a tool that scrapes names and email addresses from the victim’s\n\nOutlook accounts and uses that information to send out additional phishing emails from\nthe compromised accounts.\n3. WebBrowserPassView is a password recovery tool that captures passwords stored by\n\nInternet Explorer, Mozilla Firefox, Google Chrome, Safari, and Opera and passes them\nto the credential enumerator module.\n4. Mail PassView is a password recovery tool that reveals passwords and account details\n\nfor various email clients such as Microsoft Outlook, Windows Mail, Mozilla Thunderbird,\nHotmail, Yahoo! Mail, and Gmail and passes them to the credential enumerator\nmodule.\n5. Credential enumerator is a self-extracting RAR file containing two components: a\n\nbypass component and a service component. The bypass component is used for the\nenumeration of network resources and either finds writable share drives using Server\nMessage Block (SMB) or tries to brute force user accounts, including the administrator\naccount. Once an available system is found, Emotet writes the service component on\nthe system, which writes Emotet onto the disk. Emotet’s access to SMB can result in\nthe infection of entire domains (servers and clients).\n\n\n-----\n\nFigure 2: Emotet infection process\n\nTo maintain persistence, Emotet injects code into explorer.exe and other running processes.\nIt can also collect sensitive information, including system name, location, and operating\nsystem version, and connects to a remote command and control server (C2), usually through\na generated 16-letter domain name that ends in “.eu.” Once Emotet establishes a connection\nwith the C2, it reports a new infection, receives configuration data, downloads and runs files,\nreceives instructions, and uploads data to the C2 server.\n\nEmotet artifacts are typically found in arbitrary paths located off of the AppData\\Local and\nAppData\\Roaming directories. The artifacts usually mimic the names of known executables.\nPersistence is typically maintained through Scheduled Tasks or via registry keys.\nAdditionally, Emotet creates randomly-named files in the system root directories that are run\nas Windows services. When executed, these services attempt to propagate the malware to\nadjacent systems via accessible administrative shares.\n\n**Note: it is essential that privileged accounts are not used to log in to compromised**\n**systems during remediation as this may accelerate the spread of the malware.**\n\n**Example Filenames and Paths:**\n\n```\nC:\\Users\\<username>\\AppData \\Local\\Microsoft\\Windows\\shedaudio.exe\n\n```\n\n-----\n\n```\nC:\\Users\\<username>\\AppData\\Roaming\\Macromedia\\Flash\nPlayer\\macromedia\\bin\\flashplayer.exe\n\n```\n**Typical Registry Keys:**\n\n```\nHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n```\n```\nHKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\n\n```\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n```\n\n**System Root Directories:**\n\n```\nC:\\Windows\\11987416.exe\n\n```\n```\nC:\\Windows\\System32\\46615275.exe\n\n```\n```\nC:\\Windows\\System32\\shedaudio.exe\n\n```\n```\nC:\\Windows\\SysWOW64\\f9jwqSbS.exe\n\n```\n\n### Impact\n\nNegative consequences of Emotet infection include\n\ntemporary or permanent loss of sensitive or proprietary information,\ndisruption to regular operations,\nfinancial losses incurred to restore systems and files, and\npotential harm to an organization’s reputation.\n\n### Solution\n\nNCCIC and MS-ISAC recommend that organizations adhere to the following general best\npractices to limit the effect of Emotet and similar malspam:\n\nUse Group Policy Object to set a Windows Firewall rule to restrict inbound SMB\ncommunication between client systems. If using an alternative host-based intrusion\nprevention system (HIPS), consider implementing custom modifications for the control\nof client-to-client SMB communication. At a minimum, create a Group Policy Object\nthat restricts inbound SMB connections to clients originating from clients.\nUse antivirus programs, with automatic updates of signatures and software, on clients\nand servers.\nApply appropriate patches and updates immediately (after appropriate testing).\nImplement filters at the email gateway to filter out emails with known malspam\nindicators, such as known malicious subject lines, and block suspicious IP addresses\nat the firewall.\n\n\n-----\n\nIf your organization does not have a policy regarding suspicious emails, consider\ncreating one and specifying that all suspicious emails should be reported to the security\nor IT department.\nMark external emails with a banner denoting it is from an external source. This will\nassist users in detecting spoofed emails.\nProvide employees training on social engineering and phishing. Urge employees not to\nopen suspicious emails, click links contained in such emails, or post sensitive\ninformation online, and to never provide usernames, passwords, or personal\ninformation in answer to any unsolicited request. Educate users to hover over a link\nwith their mouse to verify the destination prior to clicking on the link.\nConsider blocking file attachments that are commonly associated with malware, such\nas .dll and .exe, and attachments that cannot be scanned by antivirus software, such\nas .zip files.\nAdhere to the principle of least privilege, ensuring that users have the minimum level of\naccess required to accomplish their duties. Limit administrative credentials to\ndesignated administrators.\nImplement Domain-Based Message Authentication, Reporting & Conformance\n(DMARC), a validation system that minimizes spam emails by detecting email spoofing\nusing Domain Name System (DNS) records and digital signatures.\n\nIf a user or organization believes they may be infected, NCCIC and MS-ISAC recommend\nrunning an antivirus scan on the system and taking action to isolate the infected workstation\nbased on the results. If multiple workstations are infected, the following actions are\nrecommended:\n\nIdentify, shutdown, and take the infected machines off the network;\nConsider temporarily taking the network offline to perform identification, prevent\nreinfections, and stop the spread of the malware;\nDo not log in to infected systems using domain or shared local administrator accounts;\nReimage the infected machine(s);\nAfter reviewing systems for Emotet indicators, move clean systems to a containment\nvirtual local area network that is segregated from the infected network;\nIssue password resets for both domain and local credentials;\nBecause Emotet scrapes additional credentials, consider password resets for other\napplications that may have had stored credentials on the compromised machine(s);\nIdentify the infection source (patient zero); and\nReview the log files and the Outlook mailbox rules associated with the infected user\naccount to ensure further compromises have not occurred. It is possible that the\nOutlook account may now have rules to auto-forward all emails to an external email\naddress, which could result in a data breach.\n\n## Reporting\n\n\n-----\n\nMS-ISAC is the focal point for cyber threat prevention, protection, response, and recovery for\nthe nation’s SLTT governments. More information about this topic, as well as 24/7\ncybersecurity assistance for SLTT governments, is available by phone at 866-787-4722, by\n[email at SOC@cisecurity.org, or on MS-ISAC’s website at https://msisac.cisecurity.org/.](http://10.10.0.46/mailto:SOC@cisecurity.org)\n\nTo report an intrusion and request resources for incident response or technical assistance,\n[contact NCCIC by email at NCCICCustomerService@hq.dhs.gov or by phone at 888-282-](http://10.10.0.46/mailto:NCCICCustomerService@hq.dhs.gov)\n0870.\n\n### References\n\n Revisions\n\nJuly 20, 2018: Initial version\n\nJanuary 23, 2020: Fixed typo\n\n[This product is provided subject to this Notification and this](https://www.us-cert.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/alerts/TA18-201A)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-20 - Alert (TA18-201A) Emotet Malware.pdf"
    ],
    "report_names": [
        "2018-07-20 - Alert (TA18-201A) Emotet Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535938,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653692673,
    "ts_modification_date": 1653692673,
    "files": {
        "pdf": "https://archive.orkl.eu/6b0a1ccaa37fa251291e7c417f367f0d6e038515.pdf",
        "text": "https://archive.orkl.eu/6b0a1ccaa37fa251291e7c417f367f0d6e038515.txt",
        "img": "https://archive.orkl.eu/6b0a1ccaa37fa251291e7c417f367f0d6e038515.jpg"
    }
}