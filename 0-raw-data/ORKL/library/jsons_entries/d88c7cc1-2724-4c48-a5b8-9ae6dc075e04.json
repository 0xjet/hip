{
    "id": "d88c7cc1-2724-4c48-a5b8-9ae6dc075e04",
    "created_at": "2023-01-12T15:01:11.262169Z",
    "updated_at": "2025-03-27T02:17:01.038777Z",
    "deleted_at": null,
    "sha1_hash": "2226a04ca0f82b7141074adfeff8c339bf778b7f",
    "title": "2021-12-03 - Vulnerabilities Exploited for Monero Mining Malware Delivered via GitHub, Netlify",
    "authors": "",
    "file_creation_date": "2022-05-28T21:39:12Z",
    "file_modification_date": "2022-05-28T21:39:12Z",
    "file_size": 1267386,
    "plain_text": "# Vulnerabilities Exploited for Monero Mining Malware Delivered via GitHub, Netlify\n\n**trendmicro.com/en_us/research/21/l/vulnerabilities-exploited-for-monero-mining-malware-delivered-via-gitHub-**\nnetlify.html\n\nDecember 3, 2021\n\nWe looked into exploitation attempts we observed in the wild and the abuse of legitimate\nplatforms Netlify and GitHub as repositories for malware.\n\nBy: Nitesh Surana December 03, 2021 Read time: ( words)\n\n[Earlier this year, a security flaw identified as CVE-2021-41773 was](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-41773) [disclosed to Apache](https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2021-41773)\nHTTP Server Project, a path traversal and remote code execution (RCE) flaw in Apache\nHTTP Server 2.4.49. If this vulnerability is exploited, it allows attackers to map URLs to files\noutside the directories configured by Alias-like directives. Under certain configurations where\nCommon Gateway Interface (CGI) scripts are enabled for aliased paths, attackers can also\n[use it for RCE. As the initial fix was deemed insufficient, a bypass was later reported for the](https://httpd.apache.org/security/vulnerabilities_24.html#CVE-2021-42013)\n[fix and tracked as CVE-2021-42013.](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42013)\n\n[Official fixes have been rolled out by Apache HTTP Server Project. However, when we](https://httpd.apache.org/download.cgi#:~:text=Apache%20HTTP%20Server%202.4.51)\nlooked at the malicious samples abusing this vulnerability, we found more of these exploits\nbeing abused to target different gaps in products and packages for malicious mining of\n\n\n-----\n\nMonero. In this blog, we look into the abuse of GitHub and Netlify repositories and platforms\nfor hosting cryptocurrency-mining tools and scripts. We have already informed GitHub and\nNetlify of the malicious activities and they have taken down the accounts.\n\nTechnical details\n\nWe observed attackers targeting the following package and products via security\nvulnerabilities disclosed in 2020 and 2021 for malicious cryptocurrency-mining activities\nthrough samples caught in our honeypots:\n\n[1.    Atlassian Confluence (CVE-2021-26084 and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-26084) [CVE-2021-26085)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-26085)\n\n[2.    F5 BIG-IP (CVE-2020-5902 and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-5902) [CVE-2021-22986)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22986)\n\n[3.    VMware vCenter (CVE-2021-22005,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-22005) [CVE-2021-21985,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-21985) [CVE-2021-21972, and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-21972) CVE2021-21973)\n\n[4.    Oracle WebLogic Server (CVE-2020-14882,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-14882) [CVE-2020-14750, and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-14750) [CVE-2020-14883)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-14883)\n\n[5.    Apache HTTP Server (CVE-2021-40438,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-40438) [CVE-2021-41773, and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-41773) [CVE-2021-42013)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-42013)\n\nFigure 1. Exploits attempting to abuse servers for malicious cryptocurrency mining from\nOctober 19 to November 19, 2021. Data taken from Trend Micro Cloud One™ – Workload\nSecurity.\nWe found it interesting that all the products and the particular package have had widely\n[distributed public](https://github.com/Al1ex/CVE-2021-22986) [proofs of concept for](https://gist.github.com/testanull/5bb925179c4695e51ca400b7370bc252) [pre-auth](https://www.exploit-db.com/exploits/49479) [RCE. Looking at the Monero wallet from one](https://packetstormsecurity.com/files/164013/Confluence-Server-7.12.4-OGNL-Injection-Remote-Code-Execution.html)\nsuch mining pool, we saw that the operation is still ongoing and actively accumulating\n\n\n-----\n\nMonero as of this writing.\n\nFigure 2. Cryptocurrency-mining pool\nServices abused: Targeting Windows hosts\n\n\n-----\n\nFigure 3. Infection chain\nThe miner samples we found work on and abuse both Windows and Linux platforms. While\nthe exploits used differ according to the infrastructure targeted, the batch scripts we identified\nworks on both. We saw the usage of Netlify and GitHub as the malware file servers for\ndownloading batch scripts from an attacker-controlled account. The batch script is renamed\nas a temporary file and deleted after it starts running in the background.\n\nThe scripts (c3.bat) are a modified version of Monero-mining helper scripts abridged from\n[GitHub, and these begin checking if the current session has administrative privileges. If the](https://github.com/C3Pool)\nprivilege is of the Administrator, then the ADMIN flags are set. Afterward, the length of the\nMonero wallet address is calculated. If the length is not 106 or 95 characters, the script exits.\nIf it is 106 or 95, it jumps to “WALLET_LEN_OK” statement.\n\n\n-----\n\nFigure 4. The batch scripts observed are modified versions of helper scripts abridged from\nGitHub.\n\nFigure 5. Checks for administrative privileges and “XMR WALLET” flag to calculate address\nlength\nThe script further conducts a series of checks in the system, such as if the USERPROFILE\nenvironment variable is defined, and whether utilities like wmic, powershell, find, findstr, and\ntasklist are available or not.\n\n\n-----\n\nFigure 6. Checking the system for availability of environment variable and utilities\n\n\n-----\n\nFigure 7. Getting the results for utilities’ availability in the system\nThe wmic utility is used to further enumerate specific parameters in the system, such as the\nnumber of processors, maximum clock speed, L2 and L3 cache sizes, and CPU sockets.\nThese values are later used to calculate the Monero mining rate of the Windows host. For\ndifferent mining rates, different ports are used on the mining pool.\n\n\n-----\n\nFigure 8. Enumerating the system’s parameters to determine cryptocurrency mining rate\nAfter identifying the CPU’s computing power, the running c3pool_miner is removed from the\nhost. The zipped miner (c3.zip) is then downloaded from the attacker-controlled GitHub\nrepository and PowerShell is used to unzip the downloaded file. If the unzip attempt fails, 7z\nis downloaded to extract the zipped file, and both the downloaded files (7za.exe and c3.zip)\nare deleted after.\n\n\n-----\n\nFigure 9. Removing traces of the downloaded files after extraction\nThe script also goes on to install the latest version of XMRig for Windows from the official\nrepository. After unzipping the downloaded file, the 7z binary and XMRig ZIP files are\nremoved. Once the miner is successfully installed, the config files are modified using\nPowerShell.\n\nFigure 10. Installing the latest XMR version in the system\n\nFigure 11. Configuring and modifying the installed miner\n\n\n-----\n\nIf the miner is already running (c3.exe), the execution jumps to an ALREADY_RUNNING\nlabel. If not, the miner is executed using the “start” command in the IDLE priority class. If the\ncurrent user has administrative privileges, then execution jumps to the label\nADMIN_MINER_SETUP. If not, persistence is added by modifying the Startup directory with\nthe batch scripts to execute c3pool XMR miner with the configuration file.\n\nFigure 12. Configuring the miner’s admin privileges and persistence\nA service is created from the c3cache_worker using the Non-Sucking Service Manager\n[(NSSM). NSSM is a service helper program that helps install applications as services, and](https://nssm.cc/)\nwith it a user can specify logging to user-defined files.\n\n\n-----\n\nFigure 13. Using NSSM to constantly run the miner as a background application in the\ninfected system\nTargeting Linux hosts\n\nThe shell script starts with an infinite loop to remove all competing cryptominers found in the\ninfected system, such as kinsing, kdevtmpfsi, pty86, and .javae.\n\nFigure 14. Removing all the cryptocurrency-mining competitors and their components found\nin the infected system in a loop\n\n\n-----\n\nAfter all the competing miners are wiped out, the attribute of /var/spool/cron/root is made\nimmutable and crontab is reloaded. Then, if there are any processes except java, redis,\nweblogic, mongod, mysql, oracle, tomcat, grep, postgres, confluence, awk, and aux that are\nraking up more than 60% of CPU usage, they are terminated.\n\nFigure 15. Stopping all other processes except those necessary for running a miner in the\nsystem\nA function “func1” (redacted) is called and the loop is reiterated after every 30 seconds.\n\nWe observed two content delivery networks (CDNs) being used as the FILE_CC_SERVER in\nGitHub and Netlify. In func1, a process “java.xnk” is checked for and if the CPU usage is\nabove or equal to 60%, the process ID is fetched into a variable “p”. If the variable is empty,\nthen the process is killed and three directories are created, namely:\n\na.    /var/tmp/java.xnk\nb.    /var/lock/java.xnk\nc.    /tmp/java.xnk\n\n\n-----\n\nFigure 16. The variable DIR contains the value of the valid TMP directory that was created.\nDifferent paths for “wget” and “curl” binaries are checked for and assigned to variable Wget.\nA file “java.xnk.bionic” is checked in the path “$DIR”. If the file doesn’t exist, the valid Wget\ncommand is used to download and copy the file named “bionic” (a Monero miner) and\n“config.json,” which contains the Monero wallet address. Executable permissions are\nassigned for the downloaded binary and the binary is executed via nohup.\n\nSimilarly, the following binaries are downloaded and executed in place of the file “bionic” and\nrepeat the process:\n\n\n-----\n\n1. focal as java.xnk.focal\n2. freebsd as java.xnk.freebsd\n3. linuxstatic as java.xnk.linux\n4. xenial as java.xnk.xenial\n5. xmr-stak as java.xnk.stak\n\nFigure 17. Assigning binaries to Wget and executable permissions\nConclusion\n\nBased on the frequency of attempts on the targeted products and the particular package in\nthe past month, we believe there are more servers that remain unpatched and exposed to\nthese exploits. More importantly, malicious actors will continue targeting these products and\npackage for intrusion based on the availability of the proofs of concept, as well as the higher\nlikelihood that these servers have yet to be patched. Moreover, due to the wide usage of\nLinux and Windows platforms and the fact that all the miners identified here work on both,\nillicit cryptocurrency mining makes for a lucrative business with regard to the high volume of\nsystems that can be targeted.\n\nThe abuse of legitimate platforms such as GitHub and Netlify will continue due to the traffic\nbeing encrypted over HTTPS. If the machines targeted have intrusion detection and\nprevention solutions (IDS/IPS) in place, network artifacts will not contribute for detection.\nMoreover, IP reputation services will not flag these platforms as malicious because they are\nlegitimate sources of programs and organizations. The CDNs of both platforms also offer\nease and convenience in setting up an operation, as well as provide availability and speed —\nthus also aiding malicious actors with a wide and fast malware infection capability regardless\n\n\n-----\n\nof a victim s location. These two factors in CDNs will likely prompt a development in the\n[behavior of malicious actors who abuse these platforms for infection, even for routines and](https://threatpost.com/cryptocurrency-mining-malware-hosted-in-amazon-s3-bucket/127643/)\nattacks unrelated to cryptocurrency mining.\n\nFrom another perspective, the malicious actors targeting these devices can appear almost\nunsophisticated considering the use of public proofs for attacks. The actors also operate on a\nregular basis and target as many machines as they can, given that they continue operating\nand getting cryptocurrency in their respective wallets despite the suspension of their GitHub\nand Netlify accounts.\n\nTrend Micro solutions\n\nEnterprises should consider using security solutions such as the Trend Micro Cloud\nOne™ platform, which protects cloud-native systems by securing continuous integration and\ncontinuous delivery (CI/CD) pipelines and applications. The platform includes:\n\nWorkload Security: runtime protection for workloads. Trend Micro Cloud One clients are\nprotected from this threat under these rules:\n\n**Intrusion Prevention Rules**\n\n1. 1011171 - Apache HTTP Server Directory Traversal Vulnerability (CVE-2021-41773\n\nand CVE-2021-42013)\n2. 1011183 - Apache HTTP Server Server-Side Request Forgery Vulnerability (CVE-2021\n40438)\n3. 1011117 - Atlassian Confluence Server Remote Code Execution Vulnerability (CVE\n2021-26084)\n4. 1011177 - Atlassian Confluence Server Arbitrary File Read Vulnerability (CVE-2021\n26085)\n5. 1010850 - VMware vCenter Server Remote Code Execution Vulnerability (CVE-2021\n21972 and CVE-2021-21973)\n6. 1010983 - VMware vCenter Server Remote Code Execution Vulnerability (CVE-2021\n21985)\n7. 1011167 - VMware vCenter Server File Upload Vulnerability (CVE-2021-22005)\n8. 1005934 - Identified Suspicious Command Injection Attack\n9. 1005933 - Identified Directory Traversal Sequence In Uri Query Parameter\n10. 1010388 - F5 BIG-IP TMUI Remote Code Execution Vulnerability (CVE-2020-5902)\n\n11. 1010590 - Oracle WebLogic Server Remote Code Execution Vulnerabilities (CVE\n2020-14882, CVE-2020-14750 and CVE-2020-14883)\n12. 1011212 - F5 BIG-IP and BIG-IQ iControl REST Authentication Bypass Vulnerability\n\n(CVE-2021-22986)\n\n**Log Inspection Rules**\n\n1 1003447 – Web Server – Apache\n\n\n-----\n\n**Integrity Monitoring Rules**\n\n1. 1002851 - Application - Apache HTTP Server\n\nNetwork Security: cloud network layer intrusion prevention system (IPS) security. Trend\nMicro Cloud One clients are protected from this threat under these rules:\n\n1. 1125: HTTP: ../.. Directory Traversal\n2. 40260: HTTP: Atlassian Confluence Server and Data Center OGNL Injection\n\nVulnerability\n3. 40417: HTTP: Atlassian Confluence Server S Endpoint Information Disclosure\n\nVulnerability\n4. 39077: TCP: VMware vSphere Client vropspluginui Code Execution Vulnerability\n5. 39923: HTTP: VMware vCenter Server Remote Code Execution Vulnerability\n6. 40382: HTTP: VMware vCenter AsyncTelemetryController Arbitrary File Write\n\nVulnerability\n7. 40361: HTTP: VMware vCenter Analytics service File Upload\n8. 39352: HTTP: F5 BIG-IP iControl REST Interface Login Request\n9. 39364: HTTP: F5 BIG-IP bash Suspicious Command Execution Request\n10. 39313: HTTP: F5 BIG-IP TMM Buffer Overflow Vulnerability\n\n11. 22087: HTTPS: F5 iControl iCall Script Privilege Escalation Vulnerability\n12. 37841: HTTP: F5 BIG-IP TMUI Code Execution Vulnerability\n13. 39360: HTTP: F5 BIG-IP iControl REST filePath Command Injection Vulnerability\n14. 38380: HTTP: Oracle WebLogic Server Remote Code Execution Vulnerability\n\nIndicators of Compromise (IOCs)\n\nView the full list of IOCs [here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/21/l/vulnerabilities-exploited-for-monero-mining-malware-delivered-via-github-netlify/IOCs-vulnerabilities-exploited-for-monero-mining-malware-delivered-via-github-netlify.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-03 - Vulnerabilities Exploited for Monero Mining Malware Delivered via GitHub, Netlify.pdf"
    ],
    "report_names": [
        "2021-12-03 - Vulnerabilities Exploited for Monero Mining Malware Delivered via GitHub, Netlify.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535671,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1653773952,
    "ts_modification_date": 1653773952,
    "files": {
        "pdf": "https://archive.orkl.eu/2226a04ca0f82b7141074adfeff8c339bf778b7f.pdf",
        "text": "https://archive.orkl.eu/2226a04ca0f82b7141074adfeff8c339bf778b7f.txt",
        "img": "https://archive.orkl.eu/2226a04ca0f82b7141074adfeff8c339bf778b7f.jpg"
    }
}