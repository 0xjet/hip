{
    "id": "5c1cfabe-9b78-4d8d-9341-1bdc6c19ae6d",
    "created_at": "2023-01-12T15:07:57.85652Z",
    "updated_at": "2025-03-27T02:16:26.012069Z",
    "deleted_at": null,
    "sha1_hash": "ba2cd5cf15ea3b60690e79ec5fbd4febaf29d45e",
    "title": "2022-06-13 - Hydra Android Malware Distributed Via Play Store",
    "authors": "",
    "file_creation_date": "2022-06-18T23:17:38Z",
    "file_modification_date": "2022-06-18T23:17:38Z",
    "file_size": 1361297,
    "plain_text": "# Hydra Android Malware Distributed Via Play Store\n\n**blog.cyble.com/2022/06/13/hydra-android-malware-distributed-via-play-store/**\n\n## Fake Document Manager App Downloading Hydra Banking Trojan\n\n\nJune 13, 2022\n\n\n[During our routine threat hunting exercise, Cyble Research Labs came across a Twitter Post wherein the researcher](https://twitter.com/AndroidInSecure/status/1534175436187500548)\nmentioned an Android malware variant published on the Play Store. The variant in question acts as a Hostile Downloader and\ndownloads the Hydra Banking Trojan.\n\nThe downloaded app has the same functionality as recently encountered Hydra variants targeting Columbia. Hydra Android\nBanking Trojan was discovered in early 2019; since then, it has frequently changed its distribution campaign.\n\nThe malware currently pretends to be the Document Manager app and has gained over 10,000 downloads in a short period.\nAccording to the Play Store statistics, the app was updated on May 30, 2022, and released on June 3, 2022.\n\n\n-----\n\n_Figure 1 – Hostile Downloader app published on Play Store_\n\n## Technical Analysis \n\n### APK Metadata Information \n\nApp Name: Document Manager\nPackage Name: com.anatolijserba.docscanner\nSHA256 Hash: 70b9e0094ccb6a3e47bcb6fe66946dea4c233b5a6e9d7c5de29bfd852666a235\n\nFigure 2 shows the metadata information of an application.\n\n_Figure 2 – App Metadata Information_\n\n### Manifest Description \n\nThe malicious application mentions six permissions, of which the Threat Actor (TA) exploits one. The harmful permission\nrequested by the malware is:\n\n**Permission** **Description**\n\n**REQUEST_INSTALL_PACKAGES** Allows an application to request installing packages\n\n\n-----\n\n### Source Code Review \n\nUpon installation, the malware shows a fake update dialogue box that tricks the user into granting permission to download\nHydra malware from an unknown source.\n\nThe below figure shows the execution flow of the malware after installation, where the following events occur:\n\nThe application is installed\nThe victim is prompted with a fake update dialog box\nThe application requests permission to download further applications from unknown sources\nThe malicious application is downloaded\n\nThe application prompts the victim for Accessibility Services access\n\n_Figure 3 – Malware execution flow_\nThe below image showcases the malware communication to the TA’s Command & Control (C&C) server\n“hxxps://trackerpdfconnect[.]com/get_random_file“. After this, the Hostile Loader downloads the APK file named\n“doc_hy_0806_obf_3.apk,” – which is a variant of Hydra malware.\n\n\n-----\n\n_Figure 4 –_\n\n_Downloading the malicious APK file_\nThe TA’s C&C admin panel also has a list of Hydra variant APK files, which are downloaded by the Hostile Downloader app\nduring runtime. Our dynamic analysis indicates that the Hostile Downloader application chooses these hosted APK files\nseemingly at random.\n\n_Figure 5 – Hydra malware present on the admin panel_\nThe downloaded APK file “doc_hy_0806_obf_3.apk” is custom packed, which further drops a dex file “rfrNI.json” during\nexecution.\n\nThe downloaded malware then performs standard Hydra Banking Trojan activities such as:\n\nCollecting contact and SMS details\nStealing Cookies\n\n\n-----\n\nInjecting crypto applications\nStealing OTPs, device lock PINs, etc\nAbusing Accessibility Service to prevent uninstallation\nInitiating TOR connection\n\nThe below code has been used to create a TOR connection that will receive the C&C URL.\n\n_Figure 6 – TOR Communication_\n[Cyble Research Labs has analyzed the Hydra Android Banking trojan in the past, where we observed it targeting European](https://blog.cyble.com/2021/09/30/a-new-variant-of-hydra-banking-trojan-targeting-european-banking-users/)\nbanking users. The malware hosted on the Play Store distributes the same Hydra variant, which can affect any Android user.\n\nOver the course of our research, we were able to gain access to the Threat Actor’s C&C panel, which then gave us several\ninsights, such as metrics about the downloads and installation of the malicious applications.\n\nWe observed that the TA also collects the device ID, name, installation date, and status and stores them in the C&C panel, as\nshown below.\n\n\n-----\n\n_Figure 7 – C&C Admin Panel_\n\n## Conclusion\n\nRecently, we have observed increased Hydra malware activity. In April, the campaign started to target Columbia by\ndistributing the malware through various phishing sites. Interestingly, now the TA has opted for the Play Store as a medium for\ndistribution.\n\nTo avoid being detected, the TA has published the Hostile Downloader app, which will download the malware after installation.\nThis is one of the ways that the TA can bypass the Play Store automation or Machine Learning techniques and publish the\nmalware as it requires minimum permissions.\n\nThe TA has seemingly used this technique successfully as the malware gained over 10,000 downloads and affected several\nusers.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against attackers. We\nrecommend that our readers follow the best practices given below:\n\n**How to prevent malware infection?**\n\nDownload and install software only from official app stores like Play Store or the iOS App Store.\nUse a reputed anti-virus and internet security software package on your connected devices, such as PCs, laptops, and\nmobile devices.\nUse strong passwords and enforce multi-factor authentication wherever possible.\n\n\n-----\n\nEnable biometric security features such as fingerprint or facial recognition for unlocking the mobile device where\npossible.\nBe wary of opening any links received via SMS or emails delivered to your phone.\nEnsure that Google Play Protect is enabled on Android devices.\nBe careful while enabling any permissions.\nKeep your devices, operating systems, and applications updated.\n\n**How to identify whether you are infected?**\n\nRegularly check the Mobile/Wi-Fi data usage of applications installed on mobile devices.\nKeep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions accordingly.\n\n**What to do when you are infected?**\n\nDisable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the Mobile Data.\nPerform a factory reset.\nRemove the application in case a factory reset is not possible.\nTake a backup of personal media Files (excluding mobile applications) and perform a device reset.\n\n**What to do in case of any fraudulent transaction?**\n\nIn case of a fraudulent transaction, immediately report it to the concerned bank.\n\n**What should banks do to protect their customers?**\n\nBanks and other financial entities should educate customers on safeguarding themselves from malware attacks via\ntelephone, SMS, or emails.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Initial Access** [T1415](https://attack.mitre.org/techniques/T1475/) Deliver Malicious App via Authorised App Store\n\n**Initial Access** [T1444](https://attack.mitre.org/versions/v7/techniques/T1444) Masquerade as Legitimate Application\n\n**Defense Evasion** [T1406](https://attack.mitre.org/techniques/T1406/) Obfuscated Files or Information\n\n**Credential Access** [T1412](https://attack.mitre.org/techniques/T1636/004/) Capture SMS Messages\n\n**Discovery** [T1421](https://attack.mitre.org/techniques/T1421/) System Network Connections Discovery\n\n**Command and Control** [T1571](https://attack.mitre.org/techniques/T1571/) Non-Standard Port\n\n**Command and Control** [T1573](https://attack.mitre.org/techniques/T1573/) Encrypted Channel\n\n**Impact** [T1447](https://attack.mitre.org/techniques/T1630/002/) Deleting Device Data\n\n**Credential Access** [T1409](https://attack.mitre.org/techniques/T1409/) Access Stored Application Data\n\n## Indicators of Compromise (IOCs)\n\n\n**Indicators** **Indicator**\n**Type**\n\n\n**Description**\n\n\n**70b9e0094ccb6a3e47bcb6fe66946dea4c233b5a6e9d7c5de29bfd852666a235** SHA256 Hash of the\nHostile\nDownloader\nAPk file\n\n\n-----\n\n**3a1bcdb56fa736d25221e5a9ded91172ff96e0e5** SHA1 Hash of the\nHostile\nDownloader\nAPk file\n\n**dc4a4995535d628102ef4f286b867e49** MD5 Hash of the\nHostile\nDownloader\nAPk file\n\n**hxxps://trackerpdfconnect[.]com** URL Hydra\nDownloader\nURL\n\n**c7300e6de3d9c6f1ad622a1e884f00d43340c381fb87c87514ef3ca2156fdf5b** SHA256 Hash of the\nHydra\nmalware\n\n**4155c71ee1e03cefe5b67bc89c2235266327baa4** SHA1 Hash of the\nHydra\nmalware\n\n**116fea8c63bce4908ec1307e20ed96ba** MD5 Hash of the\nHydra\nmalware\n\n**hxxp://newdb5ge5dz5schqawxsxuomspxsyb5xqk65v4j2fdeynds4vsgstrad[.]onion/api/mirrors** URL TOR proxy\nserver\n\n**hxxp://servservfreeupdate[.]top** URL C&C server\n\n**hxxp://wayneconnectingservice[.]hk** URL C&C server\n\n**hxxp://allupdatesecuretynow[.]com** URL C&C server\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-13 - Hydra Android Malware Distributed Via Play Store.pdf"
    ],
    "report_names": [
        "2022-06-13 - Hydra Android Malware Distributed Via Play Store.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536077,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1655594258,
    "ts_modification_date": 1655594258,
    "files": {
        "pdf": "https://archive.orkl.eu/ba2cd5cf15ea3b60690e79ec5fbd4febaf29d45e.pdf",
        "text": "https://archive.orkl.eu/ba2cd5cf15ea3b60690e79ec5fbd4febaf29d45e.txt",
        "img": "https://archive.orkl.eu/ba2cd5cf15ea3b60690e79ec5fbd4febaf29d45e.jpg"
    }
}