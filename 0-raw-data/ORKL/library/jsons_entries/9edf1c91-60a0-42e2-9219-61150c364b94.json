{
    "id": "9edf1c91-60a0-42e2-9219-61150c364b94",
    "created_at": "2023-01-12T15:00:01.555584Z",
    "updated_at": "2025-03-27T02:16:26.298355Z",
    "deleted_at": null,
    "sha1_hash": "7177c630b2b3381415343d9f1ff1c676acc57a76",
    "title": "2019-12-25 - Let’s play (again) with Predator the thief",
    "authors": "",
    "file_creation_date": "2022-05-28T01:21:33Z",
    "file_modification_date": "2022-05-28T01:21:33Z",
    "file_size": 2252532,
    "plain_text": "# Let’s play (again) with Predator the thief\n\n**[fumik0.com/2019/12/25/lets-play-again-with-predator-the-thief/](https://fumik0.com/2019/12/25/lets-play-again-with-predator-the-thief/)**\n\nfumko December 25, 2019\n\nWhenever I reverse a sample, I am mostly interested in how it was developed, even if in the\nend the techniques employed are generally the same, I am always curious about what was\nthe way to achieve a task, or just simply understand the code philosophy of a piece of code.\nIt is a very nice way to spot different trending and discovering (sometimes) new tricks that\nyou never know it was possible to do. This is one of the main reasons, I love digging mostly\ninto stealers/clippers for their accessibility for being reversed, and enjoying malware analysis\nas a kind of game (unless some exceptions like Nymaim that is literally hell).\n\nIt’s been 1 year and a half now that I start looking into “Predator The Thief”, and this malware\nhas evolved over time in terms of content added and code structure. This impression could\nbe totally different from others in terms of stealing tasks performed, but based on my first indepth analysis,, the code has changed too much and it was necessary to make another post\non it.\n\nThis one will focus on some major aspects of the 3.3.2 version, but will not explain\neverything (because some details have already been mentioned in other papers, some\nsubjects are known). Also, times to times I will add some extra commentary about malware\nanalysis in general.\n\n## Anti-Disassembly\n\n\n-----\n\nWhen you open an unpacked binary in IDA or other disassembler software like GHIDRA,\nthere is an amount of code that is not interpreted correctly which leads to rubbish code, the\nincapacity to construct instructions or showing some graph. Behind this, it’s obvious that an\nanti-disassembly trick is used.\n\nThe technique exploited here is known and used in the wild by other malware, it requires just\na few opcodes to process and leads at the end at the creation of a false branch. In this case,\nit begins with a simple xor instruction that focuses on configuring the zero flag and forcing\nthe JZ jump condition to work no matter what, so, at this stage, it’s understandable that\nsomething suspicious is in progress. Then the MOV opcode (0xB8) next to the jump is a 5\nbytes instruction and disturbing the disassembler to consider that this instruction is the right\none to interpret beside that the correct opcode is inside this one, and in the end, by choosing\nthis wrong path malicious tasks are hidden.\n\nOf course, fixing this issue is simple, and required just a few seconds. For example with IDA,\nyou need to undefine the MOV instruction by pressing the keyboard shortcut “U”, to produce\nthis pattern.\n\n\n-----\n\nThen skip the 0xB8 opcode, and pushing on C at the 0xE8 position, to configure the\ndisassembler to interpret instruction at this point.\n\nReplacing the 0xB8 opcode by 0x90. with a hexadecimal editor, will fix the issue. Opening\nagain the patched PE, you will see that IDA is now able to even show the graph mode.\n\nAfter patching it, there are still some parts that can’t be correctly parsed by the disassembler,\nbut after reading some of the code locations, some of them are correct, so if you want to\ncreate a function, you can select the “loc” section then pushed on “P” to create a subfunction, of course, this action could lead to some irreversible thing if you are not sure about\nyour actions and end to restart again the whole process to remove a the ant-disassembly\ntricks, so this action must be done only at last resort.\n\n## Code Obfuscation\n\nWhenever you are analyzing Predator, you know that you will have to deal with some\nobfuscation tricks almost everywhere just for slowing down your code analysis. Of course,\nthey are not complicated to assimilate, but as always, simple tricks used at their finest could\nturn a simple fun afternoon to literally “welcome to Dark Souls”. The concept was already\nthere in the first in-depth analysis of this malware, and the idea remains over and over with\nfurther updates on it. The only differences are easy to guess :\n\nMore layers of obfuscation have been added\nTechniques already used are just adjusted.\nMore dose of randomness\n\nAs a reversing point of view, I am considering this part as one the main thing to recognized\nthis stealer, even if of course, you can add network communication and C&C pattern as other\nways for identifying it, inspecting the code is one way to clarify doubts (and I understand that\nthis statement is for sure not working for every malware), but the idea is that nowadays it’s\nincredibly easy to make mistakes by being dupe by rules or tags on sandboxes, due to\nsimilarities based on code-sharing, or just literally creating false flag.\n\n**GetModuleAddress**\n\n\n-----\n\nAlready there in a previous analysis, recreating the GetProcAddress is a popular trick to hide\nan API call behind a simple register call. Over the updates, the main idea is still there but the\nmain procedures have been modified, reworked or slightly optimized.\n\nFirst of all, we recognized easily the PEB retrieved by spotting fs[0x30] behind some extra\ninstructions.\n\nthen from it, the loader data section is requested for two things:\n\nGetting the InLoadOrderModuleList pointer\nGetting the InMemoryOrderModuleList pointer\n\nFor those who are unfamiliar by this, basically, the PEB_LDR_DATA is a structure is where is\nstored all the information related to the loaded modules of the process.\n\nThen, a loop is performing a basic search on every entry of the module list but in “memory\norder” on the loader data, by retrieving the module name, generating a hash of it and when\nit’s done, it is compared with a hardcoded obfuscated hash of the kernel32 module and\nobviously, if it matches, the module base address is saved, if it’s not, the process is repeated\nagain and again.\n\nThe XOR kernel32 hashes compared with the one created\n\nNowadays, using hashes for a function name or module name is something that you can see\nin many other malware, purposes are multiple and this is one of the ways to hide some\nactions. An example of this code behavior could be found easily on the internet and as I said\nabove, this one is popular and already used.\n\n**GetProcAddress / GetLoadLibrary**\n\nAlways followed by GetModuleAddress, the code for recreating GetProcAddress is by far the\nsame architecture model than the v2, in term of the concept used. If the function is\nforwarded, it will basically perform a recursive call of itself by getting the forward address,\n\n\n-----\n\nchecking if the library is loaded then call GetProcAddress again with new values.\n\n**Xor everything**\n\nIt’s almost unnecessary to talk about it, but as in-depth analysis, if you have never read the\nother article before, it’s always worth to say some words on the subject (as a reminder). The\nXOR encryption is a common cipher that required a rudimentary implementation for being\neffective :\n\nOnly one operator is used (XOR)\nit’s not consuming resources.\nIt could be used as a component of other ciphers\n\nThis one is extremely popular in malware and the goal is not really to produce strong\nencryption because it’s ridiculously easy to break most of the time, they are used for hiding\ninformation or keywords that could be triggering alerts, rules…\n\nCommunication between host & server\nHiding strings\nOr… simply used as an absurd step for obfuscating the code\netc…\n\nA typical example in Predator could be seeing huge blocks with only two instructions (XOR &\nMOV), where stacks strings are decrypted X bytes per X bytes by just moving content on a\ntemporary value (stored on EAX), XORed then pushed back to EBP, and the principle is\nreproduced endlessly again and again. This is rudimentary, In this scenario, it’s just part of\nthe obfuscation process heavily abused by predator, for having an absurd amount of\ninstruction for simple things.\n\n\n-----\n\nAlso for some cases, When a hexadecimal/integer value is required for an API call, it could\nbe possible to spot another pattern of a hardcoded string moved to a register then only one\nXOR instruction is performed for revealing the correct value, this trivial thing is used for some\nspecific cases like the correct position in the TEB for retrieving the PEB, an RVA of a specific\nmodule, …\n\nFinally, the most common one, there is also the classic one used by using a for loop for a\none key length XOR key, seen for decrypting modules, functions, and other things…\n```\nstr = ... # encrypted string\nfor i, s in enumerate(str):\n s[i] = s[i] ^ s[len(str)-1]\n\n```\n**Sub everything**\n\nLet’s consider this as a perfect example of “let’s do the same exact thing by just changing\none single instruction”, so in the end, a new encryption method is used with no effort for the\ndevelopment. That’s how a SUB instruction is used for doing the substitution cipher. The only\ndifference that I could notice it’s how the key is retrieved.\n\n\n-----\n\nBesides having something hardcoded directly, a signed 32-bit division is performed, easily\nnoticeable by the use of cdq & idiv instructions, then the dl register (the remainder) is used\nfor the substitution.\n\n**Stack Strings**\n\n\n-----\n\n**What’s the result in the end?**\n\nMerging these obfuscation techniques leads to a nonsense amount of instructions for a basic\ntask, which will obviously burn you some hours of analysis if you don’t take some time for\ncleaning a bit all that mess with the help of some scripts or plenty other ideas, that could\ntrigger in your mind. It could be nice to see these days some scripts released by the\ncommunity.\n\n\n-----\n\nSimple tricks lead to nonsense code\n\n## Anti-Debug\n\nThere are plenty of techniques abused here that was not in the first analysis, this is not\nanymore a simple PEB.BeingDebugged or checking if you are running a virtual machine, so\nlet’s dig into them. one per one except CheckRemoteDebugger! This one is enough to\n\n\n-----\n\nunderstand by itself : )\n\n**NtSetInformationThread**\n\nOne of the oldest tricks in windows and still doing its work over the years. Basically in a very\nsimple way (because there is a lot thing happening during the process),\nNtSetInformationThread is called with a value (0x11) obfuscated by a XOR operator. This\nparameter is a ThreadInformationClass with a specific enum called\nThreadHideFromDebugger and when it’s executed, the debugger is not able to catch any\ndebug information. So the supposed pointer to the corresponding thread is, of course, the\nmalware and when you are analyzing it with a debugger, it will result to detach itself.\n\n**CloseHandle/NtClose**\n\nInside WinMain, a huge function is called with a lot of consecutive anti-debug tricks, they\nwere almost all indirectly related to some techniques patched by TitanHide (or strongly looks\nlike), the first one performed is a really basic one, but pretty efficient to do the task.\n\nBasically, when CloseHandle is called with an inexistent handle or an invalid one, it will raise\nan exception and whenever you have a debugger attached to the process, it will not like that\nat all. To guarantee that it’s not an issue for a normal interaction a simple __try / __except\nmethod is used, so if this API call is requested, it will safely lead to the end without any issue.\n\nThe invalid handle used here is a static one and it’s L33T code with the value 0xBAADAA55\nand makes me bored as much as this face.\n\n\n-----\n\nThat’s not a surprise to see stuff like this from the malware developer. Inside jokes, l33t\nvalues, animes and probably other content that I missed are something usual to spot on\nPredator.\n\n**ProcessDebugObjectHandle**\n\nWhen you are debugging a process, Microsoft Windows is creating a “Debug” object and a\nhandle corresponding to it. At this point, when you want to check if this object exists on the\nprocess, NtQueryInformationProcess is used with the ProcessInfoClass initialized by 0x1e\n(that is in fact, ProcessDebugObjectHandle).\n\nIn this case, the NTStatus value (returning result by the API call) is an error who as the ID\n0xC0000353, aka STATUS_PORT_NOT_SET. This means, “An attempt to remove a\n_process’s DebugPort was made, but a port was not already associated with the process.”._\nThe anti-debug trick is to verify if this error is there, that’s all.\n\n**NtGetContextThread**\n\n\n-----\n\nThis one is maybe considered as pretty wild if you are not familiar with some hardware\nbreakpoints. Basically, there are some registers that are called “Debug Register” and they\nare using the DRX nomenclature (DR0 to DR7). When GetThreadContext is called, the\nfunction will retrieve al the context information from a thread.\n\nFor those that are not familiar with a context structure, it contains all the register data from\nthe corresponding element. So, with this data in possession, it only needs to check if those\nDRX registers are initiated with a value not equal to 0.\n\nOn the case here, it’s easily spottable to see that 4 registers are checked\n```\nif (ctx->Dr0 != 0 || ctx->Dr1 != 0 || ctx->Dr2 != 0 || ctx->Dr3 != 0)\n\n```\n**Int 3 breakpoint**\n\nint 3 (or Interrupt 3) is a popular opcode to force the debugger to stop at a specific offset. As\nsaid in the title, this is a breakpoint but if it’s executed without any debugging environment,\nthe exception handler is able to deal with this behavior and will continue to run without any\nissue. Unless I missed something, here is the scenario.\n\nBy the way, as another scenario used for this one (the int 3), the number of this specific\nopcode triggered could be also used as an incremented counter, if the counter is above a\nspecific value, a simplistic condition is sufficient to check if it’s executed into a debugger in\nthat way.\n\n**Debug Condition**\n\nWith all the techniques explained above, in the end, they all lead to a final condition step if of\ncourse, the debugger hasn’t crashed. The checking task is pretty easy to understand and it\nremains to a simple operation: “setting up a value to EAX during the anti-debug function”, if\n\n\n-----\n\neverything is correct this register will be set to zero, if not we could see all the different\nvalues that could be possible.\n\nbloc in red is the correct condition over all the anti-debug tests\n\n…And when the Anti-Debug function is done, the register EAX is checked by the test\noperator, so the ZF flag is determinant for entering into the most important loop that contains\nthe main function of the stealer.\n\n## Anti-VM\n\nThe Anti VM is presented as an option in Predator and is performed just after the first C&C\nrequests.\n\nTricks used are pretty olds and basically using Anti-VM Instructions\n\nSIDT\nSGDT\nSTR\nCPUID (Hypervisor Trick)\n\nBy curiosity, this option is not by default performed if the C&C is not reachable.\n\n## Paranoid & Organized Predator\n\n\n-----\n\nWhen entering into the big main function, the stealer is doing again extra validations if you\nhave a valid payload (and not a modded one), you are running it correctly and being sure\nagain that you are not analyzing it.\n\nThis kind of paranoid checking step is a result of the multiple cases of cracked builders\ndeveloped and released in the wild (mostly or exclusively at a time coming from XakFor.Net).\nPretty wild and fun to see when Anti-Piracy protocols are also seen in the malware scape.\n\nThen the malware is doing a classic organized setup to perform all the requested actions and\ncould be represented in that way.\n\n\n-----\n\n-----\n\nOf course as usual and already a bit explained in the first paper, the C&C domain is retrieved\nin a table of function pointers before the execution of the WinMain function (where the\npayload is starting to do tasks).\n\nYou can see easily all the functions that will be called based on the starting location (__xc_z)\nand the ending location (__xc_z).\n\nThen you can spot easily the XOR strings that hide the C&C domain like the usual old\npredator malware.\n\n\n-----\n\n## Data Encryption & Encoding\n\nBesides using XOR almost absolutely everywhere, this info stealer is using a mix of RC4\nencryption and base64 encoding whenever it is receiving data from the C&C. Without using\nspecialized tools or paid versions of IDA (or whatever other software), it could be a bit\nchallenging to recognize it (when you are a junior analyst), due to some modification of some\npart of the code.\n\n### Base64\n\nFor the Base64 functions, it’s extremely easy to spot them, with the symbol values on the\nregister before and after calls. The only thing to notice with them, it’s that they are using a\ntypical signature… A whole bloc of XOR stack strings, I believed that this trick is designed to\nhide an eventual Base64 alphabet from some Yara rules.\n\n\n-----\n\nBy the way, the rest of the code remains identical to standard base64 algorithms.\n\n### RC4\n\nFor RC4, things could be a little bit messy if you are not familiar at all with encryption\nalgorithm on a disassembler/debugger, for some cases it could be hell, for some case not.\nHere, it’s, in fact, this amount of code for performing the process.\n\nBlocs are representing the Generation of the array S, then performing the Key-Scheduling\nAlgorithm (KSA) by using a specific secret key that is, in fact, the C&C domain! (if there is no\ndomain, but an IP hardcoded, this IP is the secret key), then the last one is the Pseudorandom generation algorithm (PRGA).\n\nFor more info, some resources about this algorithm below:\n\n[Stack Overflow example](https://stackoverflow.com/questions/29607753/how-to-decrypt-a-file-that-encrypted-with-rc4-using-python)\n[RC4 Algorithm (Wikipedia)](https://en.wikipedia.org/wiki/RC4#Key-scheduling_algorithm_(KSA))\n\n## Mutex & Hardware ID\n\n\n-----\n\nThe Hardware ID (HWID) and mutex are related, and the generation is quite funky, I would\nsay, even if most of the people will consider this as something not important to investigate, I\nlove small details in malware, even if their role is maybe meaningless, but for me, every\ndetail counts no matter what (even the stupidest one).\n\nHere the hardware ID generation is split into 3 main parts. I had a lot of fun to understand\nhow this one was created.\n\nFirst, it will grab all the available logical drives on the compromised machine, and for each of\nthem, the serial number is saved into a temporary variable. Then, whenever a new drive is\nfound, the hexadecimal value is added to it. so basically if the two drives have the serial\nnumber “44C5-F04D” and “1130-DDFF”, so ESI will receive 0x44C5F04D then will add\n0x1130DFF.\n\nWhen it’s done, this value is put into a while loop that will divide the value on ESI by 0xA and\nsaved the remainder into another temporary variable, the loop condition breaks when ESI is\nbelow 1. Then the results of this operation are saved, duplicated and added to itself the last 4\nbytes (i.e 1122334455 will be 112233445522334455).\n\nIf this is not sufficient, the value is put into another loop for performing this operation.\n```\nfor i, s in enumerate(str):\n if i & 1:\n  a += chr(s) + 0x40\n else:\n  a += chr(s)\n\n```\nIt results in the creation of an alphanumeric string that will be the archive filename used\nduring the POST request to the C&C.\n\nthe generated hardware ID based on the serial number devices\n\nBut wait! there is more… This value is in part of the creation of the mutex name… with a\nsimple base64 operation on it and some bit operand operation for cutting part of the base64\nencoding string for having finally the mutex name!\n\n## Anti-CIS\n\n\n-----\n\nA classic thing in malware, this feature is used for avoiding infecting machines coming from\nthe Commonwealth of Independent States (CIS) by using a simple API call\nGetUserDefaultLangID.\n\nThe value returned is the language identifier of the region format setting for the user and\nchecked by a lot of specific language identifier, of courses in every situation, all the values\nthat are tested, are encrypted.\n\nLanguage ID SubLanguage Symbol Country\n\n0x0419 SUBLANG_RUSSIAN_RUSSIA Russia\n\n0x042b SUBLANG_ARMENIAN_ARMENIA Armenia\n\n\n-----\n\n0x082c SUBLANG_AZERI_CYRILLIC Azerbaijan\n\n0x042c SUBLANG_AZERI_LATIN Azerbaijan\n\n0x0423 SUBLANG_BELARUSIAN_BELARUS Belarus\n\n0x0437 SUBLANG_GEORGIAN_GEORGIA Georgia\n\n0x043f SUBLANG_KAZAK_KAZAKHSTAN Kazakhstan\n\n0x0428 SUBLANG_TAJIK_TAJIKISTAN Tajikistan\n\n0x0442 SUBLANG_TURKMEN_TURKMENISTAN Turkmenistan\n\n0x0843 SUBLANG_UZBEK_CYRILLIC Uzbekistan\n\n0x0443 SUBLANG_UZBEK_LATIN Uzbekistan\n\n0x0422 SUBLANG_UKRAINIAN_UKRAINE Ukraine\n\n## Files, files where are you?\n\nWhen I reversed for the first time this stealer, files and malicious archive were stored on the\ndisk then deleted. But right now, this is not the case anymore. Predator is managing all the\nstolen data into memory for avoiding as much as possible any extra traces during the\nexecution.\n\nPredator is nowadays creating in memory a lot of allocated pages and temporary files that\nwill be used for interactions with real files that exist on the disk. Most of the time it’s basically\ngetting handles, size and doing some operation for opening, grabbing content and saving\nthem to a place in memory. This explanation is summarized in a “very” simplify way\n**_because there are a lot of cases and scenarios to manage this._**\n\nAnother point to notice is that the archive (using ZIP compression), is also created in\nmemory by selecting folder/files.\n\n\n-----\n\nThe generated archive in memory\n\nIt doesn’t mean that the whole architecture for the files is different, it’s the same format as\nbefore.\n\nan example of archive intercepted during the C&C Communication\n\n## Stealing\n\nAfter explaining this many times about how this stuff, the fundamental idea is boringly the\nsame for every stealer:\n\nCheck\nAnalyzing (optional)\nParsing (optional)\nCopy\n\n\n-----\n\nProfit\nRepeat\n\nWhat could be different behind that, is how they are obfuscating the files or values to\ncheck… and guess what… every malware has their specialties (whenever they are not\ndecided to copy the same piece of code on Github or some whatever generic .NET stealer)\nand in the end, there is no black magic, just simple (or complex) enigma to solve. As a\nmalware analyst, when you are starting into analyzing stealers, you want literally to\nunderstand everything, because everything is new, and with the time, you realized the\nroutine performed to fetch the data and how stupid it is working well (as reminder, it might be\nnot always that easy for some highly specific stuff).\n\nIn the end, you just want to know the targeted software, and only dig into those you haven’t\nseen before, but every time the thing is the same:\n\nChecking dumbly a path\nChecking a register key to have the correct path of a software\nChecking a shortcut path based on an icon\netc…\n\nBeside that Predator the Thief is stealing a lot of different things:\n\n1. Grabbing content from Browsers (Cookies, History, Credentials)\n2. Harvesting/Fetching Credit Cards\n3. Stealing sensible information & files from Crypto-Wallets\n4. Credentials from FTP Software\n5. Data coming from Instant communication software\n6. Data coming from Messenger software\n7. 2FA Authenticator software\n8. Fetching Gaming accounts\n9. Credentials coming from VPN software\n10. Grabbing specific files (also dynamically)\n\n11. Harvesting all the information from the computer (Specs, Software)\n12. Stealing Clipboard (if during the execution of it, there is some content)\n13. Making a picture of yourself (if your webcam is connected)\n14. Making screenshot of your desktop\n15. It could also include a Clipper (as a modular feature).\n16. And… due to the module manager, other tasks that I still don’t have mentioned there\n\n(that also I don’t know who they are).\n\nLet’s explain just some of them that I found worth to dig into.\n\n### Browsers\n\n\n-----\n\nSince my last analysis, things changed for the browser part and it s now divided into three\nmajor parts.\n\nInternet Explorer is analyzed in a specific function developed due that the data is\ncontained into a “Vault”, so it requires a specific Windows API to read it.\nMicrosoft Edge is also split into another part of the stealing process due that this one is\nusing unique files and needs some tasks for the parsing.\nThen, the other browsers are fetched by using a homemade static grabber\n\n### Grabber n°1 (The generic one)\n\nIt’s pretty fun to see that the stealing process is using at least one single function for catching\na lot of things. This generic grabber is pretty “cleaned” based on what I saw before even if\nthere is no magic at all, it’s sufficient to make enough damages by using a recursive loop at a\nspecific place that will search all the required files & folders.\n\nBy comparing older versions of predator, when it was attempting to steal content from\nbrowsers and some wallets, it was checking step by step specific repositories or registry\nkeys then processing into some loops and tasks for fetching the credentials. Nowadays, this\nstep has been removed (for the browser part) and being part of this raw grabber that will\nparse everything starting to %USERS% repository.\n\n\n-----\n\nAs usual, all the variables that contain required files are obfuscated and encrypted by a\nsimple XOR algorithm and in the end, this is the “static” list that the info stealer will be\nfocused\n\nFile grabbed Type Actions\n\nLogin Data Chrome / Chromium based Copy & Parse\n\nCookies Chrome / Chromium based Copy & Parse\n\nWeb Data Browsers Copy & Parse\n\nHistory Browsers Copy & Parse\n\nformhistory.sqlite Mozilla Firefox & Others Copy & Parse\n\ncookies.sqlite Mozilla Firefox & Others Copy & Parse\n\n\n-----\n\nwallet.dat Bitcoin Copy & Parse\n\n.sln Visual Studio Projects Copy filename into Project.txt\n\nmain.db Skype Copy & Parse\n\nlogins.json Chrome Copy & Parse\n\nsignons.sqlite Mozilla Firefox & Others Copy & Parse\n\nplaces.sqlite Mozilla Firefox & Others Copy & Parse\n\nLast Version Mozilla Firefox & Others Copy & Parse\n\n### Grabber n°2 (The dynamic one)\n\nThere is a second grabber in Predator The Thief, and this not only used when there is\navailable config loaded in memory based on the first request done to the C&C. In fact, it’s\nalso used as part of the process of searching & copying critical files coming from wallets\nsoftware, communication software, and others…\n\nThe “main function” of this dynamic grabber only required three arguments:\n\nThe path where you want to search files\nthe requested file or mask\nA path where the found files will be put in the final archive sent to the C&C\n\n\n-----\n\nWhen the grabber is configured for a recursive search, it s simply adding at the end of the\npath the value “..” and checking if the next file is a folder to enter again into the same\nfunction again and again.\n\nIn the end, in the fundamentals, this is almost the same pattern as the first grabber with the\nonly difference that in this case, there are no parsing/analyzing files in an in-depth way. It’s\nsimply this follow-up\n\n1. Find a matched file based on the requested search\n2. creating an entry on the stolen archive folder\n3. setting a handle/pointer from the grabbed file\n4. Save the whole content to memory\n5. Repeat\n\nOf course, there is a lot of particular cases that are to take in consideration here, but the\nmain idea is like this.\n\n### What Predator is stealing in the end?\n\nIf we removed the dynamic grabber, this is the current list (for 3.3.2) about what kind of\nsoftware that is impacted by this stealer, for sure, it’s hard to know precisely on the browser\nall the one that is impacted due to the generic grabber, but in the end, the most important\none is listed here.\n\nVPN\n\nNordVPN\n\nCommunication\n\nJabber\nDiscord\nSkype\n\nFTP\n\nWinSCP\nWinFTP\nFileZilla\n\nMails\n\nOutlook\n\n2FA Software\n\n\n-----\n\nAuthy (Inspired by Vidar)\n\nGames\n\nSteam\nBattle.net (Inspired by Kpot)\nOsu\n\nWallets\n\nElectrum\nMultiBit\nArmory\nEthereum\nBytecoin\nBitcoin\nJaxx\nAtomic\nExodus\n\nBrowser\n\nMozilla Firefox (also Gecko browsers using same files)\nChrome (also Chromium browsers using same files)\nInternet Explorer\nEdge\nUnmentioned browsers using the same files detected by the grabber.\n\nAlso beside stealing other actions are performed like:\n\nPerforming a webcam picture capture\nPerforming a desktop screenshot\n\n## Loader\n\nThere is currently 4 kind of loader implemented into this info stealer\n\n1. RunPE\n2. CreateProcess\n3. ShellExecuteA\n4. LoadPE\n5. LoadLibrary\n\n\n-----\n\nFor all the cases, I have explained below (on another part of this analysis) what are the\noptions of each of the techniques performed. There is no magic, there is nothing to explain\nmore about this feature these days. There are enough articles and tutorials that are talking\nabout this. The only thing to notice is that Predator is designed to load the payload in\ndifferent ways, just by a simple process creation or abusing some process injections (i\nrecommend on this part, to [read the work from endgame).](https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process)\n\n## Module Manager\n\nSomething really interesting about this stealer these days, it that it developed a feature for\nbeing able to add the additional tasks as part of a module/plugin package. Maybe the name\nof this thing is wrongly named (i will probably be fixed soon about this statement). But now\nit’s definitely sure that we can consider this malware as a modular one.\n\n\n-----\n\n-----\n\nWhen decrypting the config from check.get, you can understand fast that a module will be\nlaunched, by looking at the last entry…\n\n[PREDATOR_CONFIG]#[GRABBER]#[NETWORK_INFO]#[LOADER]#[example]\n\nThis will be the name of the module that will be requested to the C&C. (this is also the\neasiest way to spot a new module).\n\n**example.get**\n**example.post**\n\nThe first request is giving you the config of the module (on my case it was like this), it’s saved\nbut NOT decrypted (looks like it will be dealt by the module on this part). The other request is\nfocused on downloading the payload, decrypting it and saving it to the disk in a random\nfolder in %PROGRAMDATA% (also the filename is generated also randomly), when it’s\ndone, it’s simply executed by ShellExecuteA.\n\nAlso, another thing to notice, you know that it’s designed to launch multiple modules/plugins.\n\n## Clipper (Optional module)\n\nThe clipper is one example of the Module that could be loaded by the module manager. As\nfar as I saw, I only see this one (maybe they are other things, maybe not, I don’t have the\nvisibility for that).\n\n\n-----\n\nDisclaimer: Before people will maybe mistaken, the clipper is proper to Predator the Thief\nand this is NOT something coming from another actor (if it’s the case, the loader part would\nbe used).\n\nClipper WinMain function\n\nThis malware module is developed in C++, and like Predator itself, you recognized pretty\nwell the obfuscation proper to it (Stack strings, XOR, SUB, Code spaghetti, GetProcAddress\nrecreated…). Well, everything that you love for slowing down again your analysis.\n\nAs detailed already a little above, the module is designed to grab the config from the main\nprogram, decrypting it and starting to do the process routine indefinitely:\n\n1. Open Clipboard\n2. Checking content based on the config loaded\n3. If something matches put the malicious wallet\n4. Sleep\n5. Repeat\n\nThe clipper config is rudimentary using “|” as a delimiter. Mask/Regex on the left, malicious\nwallet on the right.\n\n\n-----\n\n```\n1 :1Eh8gHDVCS8xuKQNhCtZKiE1dVuRQiQ58H|\n3*:1Eh8gHDVCS8xuKQNhCtZKiE1dVuRQiQ58H|\n0x*:0x7996ad65556859C0F795Fe590018b08699092B9C|\nq*:qztrpt42h78ks7h6jlgtqtvhp3q6utm7sqrsupgwv0|\nG*:GaJvoTcC4Bw3kitxHWU4nrdDK3izXCTmFQ|\nX*:XruZmSaEYPX2mH48nGkPSGTzFiPfKXDLWn|\nL*:LdPvBrWvimse3WuVNg6pjH15GgBUtSUaWy|\nt*:t1dLgBbvV6sXNCMUSS5JeLjF4XhhbJYSDAe|\n4*:44tLjmXrQNrWJ5NBsEj2R77ZBEgDa3fEe9GLpSf2FRmhexPvfYDUAB7EXX1Hdb3aMQ9FLqdJ56yaAhiXoRs\nD*:DUMKwVVAaMcbtdWipMkXoGfRistK1cC26C|\nA*:AaUgfMh5iVkGKLVpMUZW8tGuyjZQNViwDt|\n\n```\nThere is no communication with the C&C when the clipper is switching wallet, it’s an offline\none.\n\n## Self Removal\n\nWhen the parameters are set to 1 in the Predator config got by check.get, the malware is\nperforming a really simple task to erase itself from the machine when all the tasks are done.\n\nBy looking at the bottom of the main big function where all the task is performed, you can\nsee two main blocs that could be skipped. these two are huge stack strings that will generate\ntwo things.\n\nthe API request “ShellExecuteA”\nThe command “ping 127.0.0.1 & del %PATH%”\n\nWhen all is prepared the thing is simply executed behind the classic register call. By the way,\ndoing a ping request is one of the dozen way to do a sleep call and waiting for a little before\nperforming the deletion.\n\n\n-----\n\n_This option is not performed by default when the malware is not able to get data from the_\n_C&C._\n\n## Telemetry files\n\nThere is a bunch of files that are proper to this stealer, which are generated during the whole\ninfection process. Each of them has a specific meaning.\n\nInformation.txt\n\n1. Signature of the stealer\n2. Stealing statistics\n3. Computer specs\n4. Number of users in the machine\n5. List of logical drives\n6. Current usage resources\n7. Clipboard content\n8. Network info\n9. Compile-time of the payload\n\nAlso, this generated file is literally “hell” when you want to dig into it by the amount of\nobfuscated code.\n\n\n-----\n\n-----\n\nI can quote these following important telemetry files:\n\nSoftware.txt\n\nWindows Build Version\nGenerated User-Agent\nList of software installed in the machine (checking for x32 and x64 architecture folders)\n\nActions.txt\n\nList of actions & telemetry performed by the stealer itself during the stealing process\n\nProjects.txt\n\nList of SLN filename found during the grabber research (the static one)\n\nCookeList.txt\n\nList of cookies content fetched/parsed\n\n## Network\n\n### User-Agent “Builder”\n\nSometimes features are fun to dig in when I heard about that predator is now generating\ndynamic user-agent, I was thinking about some things but in fact, it’s way simpler than I\nthought.\n\nThe User-Agent is generated in 5 steps\n\n1. Decrypting a static string that contains the first part of the User-Agent\n2. Using GetTickCount and grabbing the last bytes of it for generating a fake builder\n\nversion of Chrome\n3. Decrypting another static string that contains the end of the User-Agent\n4. Concat Everything\n5. Profit\n\nTihs User-Agent is shown into the software.txt logfile.\n\n### C&C Requests\n\n\n-----\n\nThere is currently 4 kind of request seen in Predator 3.3.2 (it s always a POST request)\n\n_Request_ _Meaning_\n\napi/check.get Get dynamic config, tasks and network info\n\napi/gate.get ?…… Send stolen data\n\napi/.get Get modular dynamic config\n\napi/.post Get modular dynamic payload (was like this with the clipper)\n\n### The first step – Get the config & extra Infos\n\nFor the first request, the response from the server is always in a specific form :\n\nString obviously base64 encoded\nEncrypted using RC4 encryption by using the domain name as the key\n\nWhen decrypted, the config is pretty easy to guess and also a bit complex (due to the\nnumber of options & parameters that the threat actor is able to do).\n```\n[0;1;0;1;1;0;1;1;0;512;]#\n[[%userprofile%\\Desktop|%userprofile%\\Downloads|%userprofile%\\Documents;*.xls,*.xlsx,*\n[Trakai;Republic of Lithuania;54.6378;24.9343;85.206.166.82;Europe/Vilnius;21001]#[]#\n[Clipper]\n\n```\nIt’s easily understandable that the config is split by the “#” and each data and could be\nsummarized like this\n\n1. The stealer config\n2. The grabber config\n3. The network config\n4. The loader config\n5. The dynamic modular config (i.e Clipper)\n\nI have represented each of them into an array with the meaning of each of the parameters\n(when it was possible).\n\n**Predator config**\n\nArgs Meaning\n\nField 1 Webcam screenshot\n\nField 2 Anti VM\n\nField 3 Skype\n\n\n-----\n\nField 4 Steam\n\nField 5 Desktop screenshot\n\nField 6 Anti-CIS\n\nField 7 Self Destroy\n\nField 8 Telegram\n\nField 9 Windows Cookie\n\nField 10 Max size for files grabbed\n\nField 11 Powershell script (in base64)\n\n**Grabber config**\n\n[]#[GRABBER]#[]#[]#[]\n\nArgs Meaning\n\nField 1 %PATH% using “|” as a delimiter\n\nField 2 Files to grab\n\nField 3 Max sized for each file grabbed\n\nField 4 Whitelist\n\nField 5 Recursive search (0 – off | 1 – on)\n\n**Network info**\n\n[]#[]#[NETWORK]#[]#[]\n\nArgs Meaning\n\nField 1 City\n\nField 2 Country\n\nField 3 GPS Coordinate\n\nField 4 Time Zone\n\nField 5 Postal Code\n\n**Loader config**\n\n\n-----\n\n[]#[]#[]#[LOADER]#[]\n\n**Format**\n\n[[URL;3;2;;;;1;amazon.com;0;0;1;0;0;5]]\n\n**Meaning**\n\n1. Loader URL\n2. Loader Type\n3. Architecture\n4. Targeted Countries (“,” as a delimiter)\n5. Blacklisted Countries (“,” as a delimiter)\n6. Arguments on startup\n7. Injected process OR Where it’s saved and executed\n8. Pushing loader if the specific domain(s) is(are) seen in the stolen data\n9. Pushing loader if wallets are presents\n10. Persistence\n\n11. Executing in admin mode\n12. Random file generated\n13. Repeating execution\n14. ???\n\n**Loader type (argument 2)**\n\nValue Meaning\n\n1 RunPE\n\n2 CreateProcess\n\n3 ShellExecute\n\n4 LoadPE\n\n5 LoadLibrary\n\n**Architecture (argument 3)**\n\nValue Meaning\n\n1 x32 / x64\n\n2 x32 only\n\n3 x64 only\n\n\n-----\n\n**If it s RunPE (argument 7)**\n\nValue Meaning\n\n1 Attrib.exe\n\n2 Cmd.exe\n\n3 Audiodg.exe\n\n**If it’s CreateProcess / ShellExecuteA / LoadLibrary (argument 7)**\n\nValue Meaning\n\n1 %PROGRAMDATA%\n\n2 %TEMP%\n\n3 %APPDATA%\n\n### The second step – Sending stolen data\n\n**Format**\n```\n/api/gate.get?p1=X&p2=X&p3=X&p4=X&p5=X&p6=X&p7=X&p8=X&p9=X&p10=X\n\n```\n**Goal**\n\n1. Sending stolen data\n2. Also victim telemetry\n\n**Meaning**\n\nArgs Field\n\np1 Passwords\n\np2 Cookies\n\np3 Credit Cards\n\np4 Forms\n\np5 Steam\n\np6 Wallets\n\np7 Telegram\n\n\n-----\n\np8 ???\n\np9 ???\n\np10 OS Version (encrypted + encoded)*\n\nThis is an example of crafted request performed by Predator the thief\n\n### Third step – Modular tasks (optional)\n```\n/api/Clipper.get\n\n```\nGive the dynamic clipper config\n```\n/api/Clipper.post\n\n```\nGive the predator clipper payload\n\n## Server side\n\nThe C&C is nowadays way different than the beginning, it has been reworked with some\nfancy designed and being able to do some stuff:\n\n1. Modulable C&C\n2. Classic fancy index with statistics\n3. Possibility to configure your panel itself\n4. Dynamic grabber configuration\n5. Telegram notifications\n6. Backups\n7. Tags for specific domains\n\n### Index\n\n\n-----\n\nThe predator panel changed a lot between the v2 and v3. This is currently a fancy theme\none, and you can easily spot the whole statistics at first glance. the thing to notice is that the\npanel is fully in Russian (and I don’t know at that time if there is an English one).\n\nMenu on the left is divide like this (but I’m not really sure about the correct translation)\n\nМеню (Menu)\n\nСтатистика (Stats)\n\nЛогов (Logs)\nПо странам (Country stats)\nЛоадера (Loader Stats)\n\nЛоги (Logs)\n\nОбычная\n\nМодули (Modules)\n\nЗагрузить модуль (Download/Upload Module)\n\nНастройки (Settings)\n\nНастройки сайта (Site settings)\nТелеграм бот (Telegram Bot)\nКонфиг (Config)\n\nГраббер (Grabber)\n\nЛоадер (Loader)\nDomain Detect\n\n\n-----\n\nBackup\nПоиск (Search)\nКонвертация (Converter => Netscape Json converter)\n\n### Statistics / Landscape\n\n Predator Config\n\nIn term of configuring predator, the choices are pretty wild:\n\nThe actor is able to tweak its panel, by modifying some details, like the title and detail\nthat made me laugh is you can choose a dark theme.\n\nThere is also another form, the payload config is configured by just ticking options.\nWhen done, this will update the request coming from check.get\n\n\n-----\n\nAs usual, there is also a telegram bot feature\n\n### Creating Tags for domains seen\n\nSmall details which were also mentioned in Vidar, but if the actor wants specific attention for\nbots that have data coming from specific domains, it will create a tag that will help him to\nfilter easily which of them is probably worth to dig into.\n\n### Loader config\n\nThe loader configuration is by far really interesting in my point of view and even it has been\nexplained totally for its functionalities, I considered it pretty complete and user-friendly for the\nThreat Actor that is using it.\n\n\n-----\n\n## IoCs\n\nHashes for this analysis\n\n\n-----\n\np_pckd.exe – 21ebdc3a58f3d346247b2893d41c80126edabb060759af846273f9c9d0c92a9a\np_upkd.exe – 6e27a2b223ef076d952aaa7c69725c831997898bebcd2d99654f4a1aa3358619\np_clipper.exe – 01ef26b464faf08081fceeeb2cdff7a66ffdbd31072fe47b4eb43c219da287e8\n\nC&C\n\ncadvexmail19mn.world\n\nOther predator hashes\n\n9110e59b6c7ced21e194d37bb4fc14b2\n51e1924ac4c3f87553e9e9c712348ac8\nfe6125adb3cc69aa8c97ab31a0e7f5f8\n02484e00e248da80c897e2261e65d275\na86f18fa2d67415ac2d576e1cd5ccad8\n3861a092245655330f0f1ffec75aca67\ned3893c96decc3aa798be93192413d28\n\n## Conclusion\n\nInfostealer is not considered as harmful as recent highly mediatize ransomware attacks, but\nthey are enough effective to perform severe damage and they should not be underrated,\nfurthermore, with the use of cryptocurrencies that are more and more common, or something\ntotally normal nowadays, the lack of security hygiene on this subject is awfully insane. that I\nam not surprised at all to see so much money stolen, so they will be still really active, it’s\nalways interesting to keep an eye on this malware family (and also on clippers), whenever\nthere is a new wallet software or trading cryptocurrency software on the list, you know easily\nwhat are the possible trends (if you have a lack of knowledge in that area).\n\nNowadays, it’s easy to see fresh activities in the wild for this info stealer, it could be dropped\nby important malware campaigns where notorious malware like ISFB Gozi is also used. It’s\nunnecessary (on my side) to speculate about what will be next move with Predator, I have\nclearly no idea and not interested in that kind of stuff. The thing is the malware scene\nnowadays is evolving really fast, threat actor teams are moving/switching easily and it could\ntake only hours for new updates and rework of malware by just modifying a piece of code\nwith something already developed on some GitHub repository, or copying code from another\nmalware. Also, the price of the malware has been adjusted, or the support communication is\nmoved to something else.\n\nDue to this, I am pretty sure at that time, this current in-depth analysis could be already\noutdated by some modifications. it’s always a risk to take and on my side, I am only\ninterested in the malware itself, the main ideas/facts of the major version are explained and\nit’s plenty sufficient. There is, of course, some topics that I haven’t talk like nowadays\npredator is now being to work as a classic executable file or a DLL, but it was developed\n\n\n-----\n\nsome times ago and this subject is now a bit popular. Also, another point that I didn t find any\nexplanation, is that seeing some decrypting process for strings that leads to some encryption\nalgorithm related to Tor.\n\nThis in-depth analysis is also focused on showing that even simple tricks are an efficient way\nto slow down analysis and it is a good exercise to practice your skills if you want to improve\nyourself into malware analysis. Also, reverse engineering is not as hard as people could\nthink when the fundamental concepts are assimilated, It’s just time, practice and motivation.\n\nOn my side, I am, as usual, typically irregular into releasing stuff due to some stuff (again…).\nBy the way, updating projects are still one of my main focus, I still have some things that I\nwould love to finish which are not necessarily into malware analysis, it’s cool to change\ntopics sometimes.\n\n#HappyHunting\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-25 - Let’s play (again) with Predator the thief.pdf"
    ],
    "report_names": [
        "2019-12-25 - Let’s play (again) with Predator the thief.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535601,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653700893,
    "ts_modification_date": 1653700893,
    "files": {
        "pdf": "https://archive.orkl.eu/7177c630b2b3381415343d9f1ff1c676acc57a76.pdf",
        "text": "https://archive.orkl.eu/7177c630b2b3381415343d9f1ff1c676acc57a76.txt",
        "img": "https://archive.orkl.eu/7177c630b2b3381415343d9f1ff1c676acc57a76.jpg"
    }
}