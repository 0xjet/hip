{
    "id": "50dd94fb-e661-46c6-b3df-5235df6ed9c8",
    "created_at": "2023-01-12T15:00:18.964751Z",
    "updated_at": "2025-03-27T02:05:24.917092Z",
    "deleted_at": null,
    "sha1_hash": "1594b6597546e528ae9dd383aaf07e65ad418b07",
    "title": "2018-02-14 - Reversing Py2Exe binaries",
    "authors": "",
    "file_creation_date": "2022-11-28T18:58:56Z",
    "file_modification_date": "2022-11-28T18:58:56Z",
    "file_size": 976124,
    "plain_text": "# Reversing Py2Exe binaries\n\n**[biebermalware.wordpress.com/2018/02/14/reversing-py2exe-binaries/](https://biebermalware.wordpress.com/2018/02/14/reversing-py2exe-binaries/)**\n\nView all posts by biebsmalwareguy February 14, 2018\n\nWell, today, I came across an oddity that required digging a little deeper. I saw a\nC:\\boots\\syswin.exe, and I know that shouldn’t be there. A Virustotal check showed a high\ndetection rate, but nothing that really explained what the file is, or does.\n\n\n-----\n\nI used 7zip to open the file, and saw a lot of .pyc files inside, so this is Python related.\nProbably a Py2exe binary. Py2exe is a program which takes a Python script, compiles it,\nalong with any necessary modules, and packages them with a small Python interpreter, into\nan executable. To verify, I ran:\n\nPYTHONSCRIPT is the resource which contains the original Python script.\n\nNow…how to go about getting the original script out of the exe? A quick Google search\nshowed me that there are a lot of tools out there for this…and hours of reading and trial-anderror showed me that almost none of them work. Finally, I found [rePy2exe. Thankfully, this](https://github.com/4w4k3/rePy2exe)\none worked quite well.\n\nThe reverse ‘exe > py’ functionality errored out, but I was able to use unpy2exe to recover\nthe .pyc file for PYTHONSCRIPT.\n\nNow, I could use option 3 (Reverse Pyc -> Py) in rePy2exe to get the source code back.\n\n\n-----\n\n-----\n\nThen I saw “Segmentation fault,” which, if you don’t know, is a bad thing. After a moment,\nthough:\n\n\n-----\n\nSo…it looks like it worked…but I don’t expect to see a 250M Python script.\n\nStill…when I opened it, it looked like a Python script.\n\n\n-----\n\n-----\n\nOn scrolling down, it was clear that the only issue (and what caused the segfault) was that it\nprinted the Python script over and over and over until it segfaulted at 250M…so, all I had to\ndo is find where the first one ended, copy/pasta, and then I could tear it apart.\n\nThis is a bit more manageable.\n\nNow, to read the thing.\n\n\n-----\n\nSo, imports and var declarations, then we see that it’s got functionality to copy itself to USB.\nAwesome.\n\n\n-----\n\nThen we see functionality to, essentially, destroy every executable on disk by unlinking\nthem…but only if it’s a fixed disk. It won’t kill USB. After that, there’s some tasklist stuff…\nfrankly, I’m not a Python god, so I’m not certain what’s going on there.\n\n\n-----\n\nIt queries the runkey…and adds itself.\n\n\n-----\n\nSome more stuff for copying itself to USB…\n\nAnd closes with some conditionals…\n\n\n-----\n\nSo, basically, it checks to see if C:\\txt.txt exists, and whether the date is before 2016/4/3 or\nearlier. If not, it launches newthread1, which is the code to destroy all the executables.\nPretty fun stuff, right?\n\nNotice, there’s no backdoor/RAT functionality, or any network capability at all. There’s\nnothing to be gained here. This was written by an asshole, just to showcase his or her\nassholery. Presumably, it was initially written as a logic bomb, prior to 4/3/2016, and left to\npropagate via USB until that time, when it would explode and kill everyone’s files. Clearly,\nthis was written by a very nice guy, right? Anyway…after all the time spent figuring out\nhow…it turns out it’s pretty easy to tear these apart. So that much, at least, is a plus.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-02-14 - Reversing Py2Exe binaries.pdf"
    ],
    "report_names": [
        "2018-02-14 - Reversing Py2Exe binaries.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535618,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1669661936,
    "ts_modification_date": 1669661936,
    "files": {
        "pdf": "https://archive.orkl.eu/1594b6597546e528ae9dd383aaf07e65ad418b07.pdf",
        "text": "https://archive.orkl.eu/1594b6597546e528ae9dd383aaf07e65ad418b07.txt",
        "img": "https://archive.orkl.eu/1594b6597546e528ae9dd383aaf07e65ad418b07.jpg"
    }
}