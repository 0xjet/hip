{
    "id": "d84a42a5-90a9-43d6-9ab5-770ecf048d74",
    "created_at": "2023-01-12T15:10:56.094809Z",
    "updated_at": "2025-03-27T02:14:39.149769Z",
    "deleted_at": null,
    "sha1_hash": "1a95c997b2b420ce40d7c2dbf379fd4f1d2c561e",
    "title": "2022-09-29 - Doenerium- It’s Not a Crime to Steal From Thieves",
    "authors": "",
    "file_creation_date": "2022-10-02T12:26:12Z",
    "file_modification_date": "2022-10-02T12:26:12Z",
    "file_size": 2617254,
    "plain_text": "# Doenerium: It’s Not a Crime to Steal From Thieves\n\n**perception-point.io/doenerium-malware/**\n\nSeptember 29, 2022\n\nIn this blog, Perception Point’s resident malware hunter, Igal Lytzki, analyzes a sophisticated phishing campaign that uses the Doenerium\nmalware to execute its payload. Igal reviews the capabilities of the malware and a possible backdoor that its creator left inside the code to\n[benefit from the “script kiddies” using the malware.](https://perception-point.io/how-to-conduct-a-phishing-attack-5-easy-steps/)\n\n## Windows Defender Goes Phishing\n\nThis attack, like most others, begins with an email. The user receives a message, with the subject, “Important Windows Defender Update!” The\nbody of the email itself appears to be formatted in a Windows Defender template, informing the user that Windows Defender has recently\ndetected malicious software on the user’s computer. The user is prompted to download additional software in order to remove the malware.\n\n\n-----\n\nFigure 1: The phishing email\n\nUpon clicking on the download button, the user is redirected to a hosting site:\n**neon[.]page/Microsoft-Windows-MSRT**\n\nThis site is actually the landing page for the malware. It contains two “software removals tools”: one for a 32-bit system and the second one for\na 64-bit system. In reality, this is a social engineering technique the hacker uses to manipulate and convince the user that the site is legitimate.\n\nFigure 2: Malicious hosting site\n\nBoth “Removal Tool” URLs lead to a shared drive: microsoftwindows-drive.mycozy[.cloud. Each of the tools has a different sharecode, but the\nZIP payload remains the same, the only difference is the 32/64 bit words.\n\n\n-----\n\nFigure 3: Archive hosted on shared drive\n\n## Static Information\n\nThe ZIP archive contains two files inside of it: 1) a README.txt file that when opened explains to the user how to use the tool, and 2) the\nactual malware, a 64 bit C++ PE, compiled using Node.js with the size of 102mb.\n\nFigure 4: Static information about the archive and the files inside of it\n\n## The Origin of Doenerium Malware\n\nIgal ran the malware, dumped its memory, and searched for unique strings, eventually stumbling upon an unusual string:\n\n<================[t.me/doenerium]>================>\n\nFigure 5: Unique string found on the malware memory dump\n\nThis string is actually a short URL to a Telegram server. Igal opened the URL in the browser and noted a link to a Github repository created by\ndoener2323, called doenerium.\n\n\n-----\n\nFigure 6: Doenerium telegram channel\n\n[This is one of many instances of malware being hosted on Github. Usually, malware is taken down after usage by nation state actors, but this](https://github.com/doener2323/doenerium)\nwas different. In the repository we can see the malware capabilities and some of its additional features.\n\nFigure 7: Doenerium features on Github repository\n\n## Doenerium Source Code Analysis\n\nBecause the malware is publically available through Github, we can review its source code and analyze the malware’s capabilities. Read on to\nlearn more.\n\n### Anti-VM\n\nThe malware starts by calling two functions:\n\ndetect_malicious_processes()\ninVM()\n\n\n-----\n\nFigure 8: Anti-VM function calls\n\nThe detect_malicious_processes function loops through a predefined list of programs. By using the tasklist command, it searches whether\nor not one of the listed programs is running. If found, it will kill the program using the taskkill command: taskkill /IM ${executable}.exe /F\n\nFigure 9: Detect_malicious_processes function functionality\n\nThe inVM function checks if the malware is running in a virtual environment.\n\nThis function has several triggers that may lead to self termination of the malware:\n\n1. It checks if the malware is running on a blacklisted driver.\n2. It checks if the computer name is in a predefined blacklisted computer name list.\n3. In previous versions of the function, it also checked whether or not the computer has internet access by counting the number of WiFi\n\nconnections.\n\nIf one of these conditions is triggered, the return variable will be set to true and the malware will terminate itself.\n\nFigure 10: inVM function functionality\n\n### Persistence\n\nThe next thing the malware does is create a persistence for itself by simply copying the malware to the startup folder and renaming it to\n**“Updater.exe”. This causes the system to execute the malware upon the startup process of the system, every time the system reboots itself.**\n\nFigure 11: Startup folder persistence function\n\n### Data Harvesting\n\n\n-----\n\ne a a e sta ts by de t y g t e C U o t e ct s co pute c s su ed up t e ct s p o e, t at s se t to t e ac e d sco d\nserver.\n\nFigure 12: CPU details harvest function\n\nIt then creates an exfiltration folder on the victim’s computer. This folder is saved in the TEMPdirectory. Its name has a pattern: it contains the\nvictim’s computer name concatenated with an underscore and “36 char UUID” (universally unique identifier).\n\nFigure 13: Exfiltration folder creation function\n\nAnd next starts to look for crypto wallets stored in the victim’s computer. A folder called “Wallets” is created in the exfiltration folder to store any\nwallet that is located. Additionally, it creates a small text file that sums up the findings (regardless if there were any or not).\n\nThe Doenerium malware hunts for these crypto wallets:\n\nZcash\nArmory\nBytecoin\nJaxx\nExodus\nEthereum\nElectrum\nAtomicWallet\nGuarda\nCoinomi\n\nFigure 14: crypto wallets harvesting function\n\n[The malware then hunts for Discord tokens that may be stored in either the Discord configuration files or in one of the browser’s data files. It](https://linuxhint.com/get-discord-token/#:~:text=Discord%20tokens%20act%20as%20an,full%20access%20to%20their%20accounts.)\nwill then perform a ReGex pattern search and begin decryption processes.\n\n\n-----\n\nFigure 15: Discord token grabber function\n\n[Fun Fact: The ReGex pattern search contains the string: “dQw4w9WgXcQ” which is actually a Discord easter egg. All encrypted](https://www.reddit.com/r/discordapp/comments/tyb1u0/discord_easter_egg_all_encrypted_discord_tokens/)\nDiscord tokens begin with dQw4w9WgXcQ which is the ending of the shortened URL for Rick Astley’s “Never Gonna Give You Up”\nYoutube video.\n\nFigure 16: Discord Easter Egg\n\nAfter taking Discord tokens, the malware tries to validate the token by using discord API calls and checking whether or not the token has Nitro\n(a Discord subscription) and what the payment sources of the token are.\n\nFigure 17: Discord token validator function\n\nLast but not least, the malware harvests browser data. It will look for the following items in the browser:\n\nPasswords\nCookies\nBookmarks\nHistory\nAutofill\nWallets\n\n[Note: A full list of browser harvesting paths can be found here.](https://github.com/doener2323/doenerium/blob/doener/config/environ.js#L38)\n\n\n-----\n\nFigure 18: Browser data harvesting function\n\n## Clipper Function\n\nAn additional function executes itself every second. Doenerium copies the  victim’s current clipboard, and runs a ReGex pattern search for a\ncrypto wallet address. If one exists, the program sends the clipboard to the hacker’s preconfigured crypto wallet address.\n\n_This function’s main purpose is to have the victim send money to the hacker’s wallet address instead of the desired one._\n\nIn this sample, these were the hacker crypto wallet addresses:\n\n**BTC:bc1q605q2gcgc6eu8dz4vx5xg98cp2m87avvxdsdtm**\n**LTC:ltc1qrvjfhlk7acmxt672ytydwltrp0lfkf6rdkzwmq**\n**XMR:49QSYffaKSPE3sYtzj2LNJMhrcFujPv7RC8kvXwDTDA31m94jHq88jCBWoVcQ6daq6i8LDTvfdpEsfxhVnf8CZqKG5Unv2r**\n**ETH:0xfd87BB4EC7F0e470C9AbceEDe5281B7c1a47Ba73**\n**XRP:rEdtuiP5RSG6bFoMS6W9wfqsFD1k3KEEGA**\n**NEO:NcVAPdQfnoxvVGU16uJZjdzt7exwSGDu1v**\n**BCH:qpxtael7lhdgz8zfqnggslf5cxmlmzhjhsglmjgr79**\n**DOGE:DH6avoTu46DvZEX65BWQzC87FKZuMtDYwf**\n**DASH:XbV9Zk1MCExHtdx7s73BfXgnG5VxPLxi4M**\n**XLM:GAGBLWI74Y446TML2OKN4RTLBEBHC2MIE4RZYOBEMZ52CJJL6ERYR536**\n\nFigure 19: Clipper function\n\n### Exfiltration and Destruction of Evidences\n\nAfter the malware has harvested all the data it can, it creates a profile for the victim that includes CPU, architecture, temp/appdata paths, and\nmuch more. It will also create a profile for the malware executable process including its PID and PPID.\n\nFigure 20: Victim Profile buildup\n\nAll files are saved in the exfiltration folder previously created and then compressed to a zip archive that is saved in the temp directory.\n\n\n-----\n\nFigure 21: Archive Creation and exfiltration folder content\n\n[The archive is then uploaded to gofile.io, a free file sharing and storing platform with a focus on privacy.](https://gofile.io/)\n\nThe malware author leverages this service to host the archive and share it with the hacker, together with the Discord webhook that is sent to\nthe hacker’s Discord server.\n\nFigure 22: Exfiltration function\n\nFigure 23: Archive host on gofile.io\n\nFigure 24: Hacker Discord webhook\nFinally, the Doenerium malware sleeps for a minute. After it removes the previously created zip archive and the exfiltration folder.\n\nFigure 25: Evidence destruction\n\nThe webhook to the hacker’s Discord server will look similar to the following screenshots:\n\n\n-----\n\nFigures 26-28: Exfiltrated data webhook example\n\n## So, That’s It? Is There a Backdoor?\n\nWe covered the malware capabilities and potential impact. However, Igal worked with [@Iamdeadlyz to try and find a rumored backdoor. The](https://twitter.com/Iamdeadlyz)\nmalware author (doener2323) had an additional Github repository under a user named 1337wtf1337. The associated repository was called\n1337wtf1337; inside of it were several files that are called from the Doenerium repository.\n\nLooking back at the repository history of Doenerium, Igal noticed that Doener was accused with “Dual Hooking”, the explanation of this term is\nthat in addition to the webhook that the hacker applies to the malware (to which it copies the exfiltrated data) the malware contained an\nadditional Discord webhook that was associated with Doener itself.\n\n_This means that everything a hacker has achieved with this malware, will be shared with Doener._\n\nFigure 29: dual hook explanation\n\nThis was removed by Doener on September 3rd, 2022.\n\nFigure 30: Removal of suspicious webhook commit\n\nBut before removing this webhook, Doener and a partner in crime had a backup idea. They created a file named “extra.txt” – this file is a\nheavily obfuscated JavaScript file, invoked by the Doenerium malware. The first reference to it was made back in August 27th, 2022. This\ncomment had a very suspicious sentence in its title: “i also added a secret payload which doesnt do anything but confuses the\n**antiviruses :O”**\n\n\n-----\n\nFigure 31: Backdoor implementation\n\n## The Dual Hook\n\nLooking at the “extra.txt’ javascript file, the file is completely obfuscated and has no human readable string.\n\nFigure 32: Obfuscated javascript file\n\nBut something Igal could clearly see was the “webhooks” string followed up with a big unicode string. By trying to decode it, Igal managed to\nretrieve yet another reference to 1337wtf1337 repo:\n\n**“hxxps[://]raw[.]githubusercontent[.]com/1337wtf1337/1337wtf1337/main/webhook[.]txt”**\n\nFigure 33: Decoded unicode string\n\n[This URL leads to the content of webhook.txt on 1337wtf1337 repo, which contains a websec.services webhook (a discord webhook protection](https://github.com/1337wtf1337/1337wtf1337/blob/main/webhook.txt)\nservice).\n\nFigure 34: webhook.txt file on 1337wtf1337 repository\n\nOpening up this webhook in the browser shows that Doener is the owner of it.\n\nFigure 35: Websec Doener webhook\n\nAt this point Igal just wanted to double check that this websec webhook was being used in the malware itself. After checking the malware\ndumped strings, Igal managed to find locate it:\n\nFigure 36: Websec webhook in memory dump\nThis led Igal to the last part of this investigation.\n\n\n-----\n\n## The Truth Behind the Hook\n\nDoener presents an open Discord server for sharing the active hackers’ profits and updating the users about new features and fixes.\n\nFigure 37: Doener Discord server\n\nAfter sitting back for a while and waiting for someone else to notice the backdoor, it actually happened: a user named “mewso” asked Doener’s\npartner in crime what the purpose of the “extra.txt” file is and why it points to a websec webhook.\n\n_Doener’s partner didn’t hide anything and explained that the purpose of this webhook is monetization._\n\nIt’s being used as part of a bigger crypto mining operation for Doener and partner, which infects the victims that are lured by active hackers\nusing Doenerium.\n\nFigure 38-39: Doener’s partner crypto miner explanation\n\nAfter several hours the user “mewso” was banned by Doener and the chat log was wiped.\n\n\n-----\n\nFigure 40: Doener bans the backdoor finder\n\nThe 1337wtf1337 repo has two other files that may be associated with the crypto mining operation. These files are: “ethereum.json” and\n**“monero.json”. These files have configurations that may be used for crypto mining and the wallets that the miners mine for:**\n\nFigure 40-41: Ethereum and Monero crypto miners configurations\n\n## Conclusion\n\nA lot can be learned from this malware campaign, the first thing being that nothing comes free. The hackers that utilize this malware to steal\nsensitive data are actually being hacked by the malware author to grow their crypto mining operation.\n\n## Recommendations\n\nTo avoid becoming the next victim of the Doenerium malware, we recommend taking the following steps to mitigate your risk:\n\n[Educate employees on the need for email security and the risk of opening suspicious emails and attachments.](https://perception-point.io/channel-coverage/email-security/)\nRun email security drills every few months to ensure that employees know what to look for in a suspicious email.\nCreate a process for employees to follow when they receive a suspicious email or link.\nDo not open files with strange links or attachments.\nAlways double check the identity of the sender.\nDeploy an advanced email security solution that prevents these malicious emails from reaching users’ inboxes.\n\n[Learn more about advanced attacks like these on our resource page here.](https://perception-point.io/blog/)\n\n[A major thank you to @Iamdeadlyz for helping out by deobfuscating some of the code and pointing out things mentioned in this article.](https://twitter.com/Iamdeadlyz)\n\n### IOCs\n\nURLs:\n\nhxxps[://]neon[.]page/Microsoft-Windows-MSRT\nhxxps[://]microsoftwindows-drive[.]mycozy[.]cloud/public?sharecode=wZUuotxjnGrF#/\nhxxps[://]microsoftwindows-drive[.]mycozy[.]cloud/public?sharecode=bXWS2roRsZmy#/\nhxxps[://]t[.]me/doenerium\nhxxps[://]github[.]com/doener2323/doenerium\nhxxps[://]github[.]com/1337wtf1337/1337wtf1337\nhxxps[://]discord[.]com/api/webhooks/1010856552447619133/NxbHxd7iYxbfE9SO18zDoCCPWy242dJWSC3KozNctIaxACVJcPGHUBjgm7q\nhxxps[://]websec[.]services/send/6323a5bdd8bf9d473909190f\n\nFiles:\n\n\n-----\n\ndo s a c ous So t a e e o a oo (3 b t) p b005dd 6abc86ada 9 b6698d3cbbe 0bceb8 ee d9303 d689 609\n(sha256)\nWindows-KB890830-x32-V5.104.exe – 609cccf310e725ba4ff4d74edffa0c33d4640f3c391dbbac4e1d00dd3f9c249e (sha256)\n\n[All of our blogs IOC’s files can be found in malware bazaar under the tag PerceptionPoint](https://bazaar.abuse.ch/browse/tag/PerceptionPoint/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-29 - Doenerium- It’s Not a Crime to Steal From Thieves.pdf"
    ],
    "report_names": [
        "2022-09-29 - Doenerium- It’s Not a Crime to Steal From Thieves.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9041c438-4bc0-4863-b89c-a32bba33903c",
            "created_at": "2023-01-06T13:46:38.232751Z",
            "updated_at": "2025-03-27T02:00:02.778714Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove"
            ],
            "source_name": "MISPGALAXY:Nitro",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b44a04-a080-4465-973d-976ce53777de",
            "created_at": "2022-10-25T16:07:23.911791Z",
            "updated_at": "2025-03-27T02:02:10.025108Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove",
                "Nitro"
            ],
            "source_name": "ETDA:Nitro",
            "tools": [
                "AngryRebel",
                "Backdoor.Apocalipto",
                "Chymine",
                "Darkmoon",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Moudour",
                "Mydoor",
                "PCClient",
                "PCRat",
                "Poison Ivy",
                "SPIVY",
                "Spindest",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536256,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1664713572,
    "ts_modification_date": 1664713572,
    "files": {
        "pdf": "https://archive.orkl.eu/1a95c997b2b420ce40d7c2dbf379fd4f1d2c561e.pdf",
        "text": "https://archive.orkl.eu/1a95c997b2b420ce40d7c2dbf379fd4f1d2c561e.txt",
        "img": "https://archive.orkl.eu/1a95c997b2b420ce40d7c2dbf379fd4f1d2c561e.jpg"
    }
}