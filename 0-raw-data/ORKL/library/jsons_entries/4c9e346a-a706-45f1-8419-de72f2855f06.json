{
    "id": "4c9e346a-a706-45f1-8419-de72f2855f06",
    "created_at": "2023-01-12T15:01:25.366586Z",
    "updated_at": "2025-03-27T02:06:15.397861Z",
    "deleted_at": null,
    "sha1_hash": "77626001f29b14e7006e3bfcbcd94e5acae729d0",
    "title": "2013-03-21 - VSkimmer Botnet Targets Credit Card Payment Terminals",
    "authors": "",
    "file_creation_date": "2022-05-28T15:47:36Z",
    "file_modification_date": "2022-05-28T15:47:36Z",
    "file_size": 1751398,
    "plain_text": "# VSkimmer Botnet Targets Credit Card Payment Terminals\n\n**[securingtomorrow.mcafee.com/mcafee-labs/vskimmer-botnet-targets-credit-card-payment-terminals/](https://securingtomorrow.mcafee.com/mcafee-labs/vskimmer-botnet-targets-credit-card-payment-terminals/)**\n\nMarch 21, 2013\n\n[Chintan Shah](https://www.mcafee.com/blogs/author/chintan-shah/)\nMar 21, 2013\n\n6 MIN READ\n\n**April 2**\n\n**This blog has been updated with McAfee’s NSP detection. See end of blog.**\n\n\n-----\n\nWhile monitoring a Russian underground forum recently, we came across a discussion about\na Trojan for sale that can steal credit card information from machines running Windows for\nfinancial transactions and credit card payments. The malware, vSkimmer, can detect the\ncard readers, grab all the information from the Windows machines attached to these readers,\nand send that data to a control server. The author of the thread also discusses other\ncapabilities of this malware, which appears to be a successor of Dexter, but with additional\nfunctions.\n\nWe already know\nabout botnets such\nas Zeus and\nSpyEye, which\nperform financial\nfraud using\nextremely\nsophisticated\ntechniques including\nintercepting the\nvictims’ banking\n\ntransactions.\nVSkimmer is\nanother\nexample of how\nfinancial fraud\nis actively\nevolving and\nhow financial\nTrojans are\ndeveloped and\npassed around\nin the\nunderground\ncommunity.\nThis botnet is\nparticularly interesting because it directly targets card-payment terminals running Windows.\n\nOur Automated Botnet Replication Framework first saw this Trojan on January 18. We’ve\nanalyzed samples of this malware and figured out how it steals the credit card information\nand its additional control functionalities. While performing the API tracing, we found it uses\nfairly standard antidebugging techniques:\n\nThe malware collects the following information from the infected machine and sends it to the\ncontrol server:\n\n\n-----\n\nMachine GUID\nfrom the\nRegistry\nLocale info\nUsername\nHostname\nOS version\n\nThis malware\nuses a standard\ninstallation\nmechanism and\n\ncopies\nitself as\n\nsvchost.exe into %APPDATA%, modifies the registry key to add itself under the authorized\nlist of apps, and runs ShellExecute to launch the process. One function of vSkimmer if the\nInternet is not available is to wait for a USB device with the volume name KARTOXA007 to\nbe connected to the infected machine and to copy all the logs with the file name dumz.log\nand the card info collected from the victim to the USB drive.\n\nI checked by disconnecting from the Internet: The malware enumerated all the drives and\ncreated the file dumz.log in the drive with the preceding name.\n\n\n-----\n\n## Extracting credit card information\n\nVSkimmer maintains the whitelisted process, which it skips while enumerating the running\nprocesses on the infected machine.\n\nOnce vSkimmer finds any running process not in the whitelist, it runs OpenProcess and\nReadProcessMemory to read the memory pages of the process and invokes the patternmatching algorithm to match the regular expression “?[3-9]{1}[0-9]{12,19}[D=\\\\u0061][0-9]\n{10,30}\\\\??”)” and extract the card info read by the payment devices. This is done recursively\nfor every process running in the infected machine and not on the whitelist.\n\n\n-----\n\n## VSkimmer control\n\nBefore communicating with the control server, the malware B64-encodes all the machine\ninformation collected and appends it to the URI. The encoded string follow this format:\n\n\n-----\n\nmachine guid|build_id|bot_version|Windows_version|Host_name|User_Name\n\nNext,\nvSkimmer\ncreates the\nHTTP\nrequest and\nconnects to\nthe control\nserver:\n\nWhile this\nmalware ran,\nwe saw the\nfollowing\nresponse.\nNote that the\ncommands\nare within\nthe <cmd>\n</cmd> tag.\n\nOnce\nvSkimmer\nreceives a\nresponse\nfrom the server, it executes the following routine to parse the command:\n\nBecause the response from the server during execution was <cmd>null</cmd>, the malware\nextracts the 3-byte command and tries to match it with the other commands implemented by\nvSkimmer. First it checks if the command from the server is “dlx.”\n\nIf not, then vSkimmer checks for the “upd” command. These commands implement the\nHTTP download and execute (“dlx”) and update of the bot (“upd”), respectively.\n\nAs we saw earlier in this post, vSkimmer can also grab the Track 2 data stored on the\nmagnetic strip of the credit cards. This track stores all the card information including the card\n[number. (You can read more about the Track 2 data format on Wikipedia. The chief](http://en.wikipedia.org/wiki/Magnetic_stripe_card)\ninformation:\n\nPrimary Account Number: the number printed on the front of the card\nExpiration Date\nService Code: the three-digit number\n\n\n-----\n\n-----\n\n## VSkimmer bot control panel\n\nHere’s a look at the control panel of the command server:\n\n**UPDATE**\n\nMcAfee NSP detection:\n\n\n-----\n\nAttack ID: 0x4880a600\n\nAttack Name: BOT: VSkimmer Traffic Detected\n\nSigset: Intrushield Network Security Signature Set 7.5.34.10\n\n[Chintan Shah](https://www.mcafee.com/blogs/author/chintan-shah/)\nChintan Shah is currently working as a Security Researcher with McAfee Intrusion\nPrevention System team and holds broad experience in the network security industry. He\nprimarily focuses on Exploit and...\n\n### More from McAfee Labs\n\n[Crypto Scammers Exploit: Elon Musk Speaks on Cryptocurrency](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/crypto-scammers-exploit-talk-on-cryptocurrency/%20)\n\nBy Oliver Devane Update: In the past 24 hours (from time of publication) McAfee has\nidentified 15...\n\nMay 05, 2022 |  4 MIN READ\n\n[Instagram Credentials Stealer: Disguised as Mod App](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealer-disguised-as-mod-app/%20)\n\nAuthored by Dexter Shin McAfee’s Mobile Research Team introduced a new Android\nmalware targeting Instagram users who...\n\nMay 03, 2022 |  4 MIN READ\n\n[Instagram Credentials Stealers: Free Followers or Free Likes](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealers-free-followers-or-free-likes/%20)\n\nAuthored by Dexter Shin Instagram has become a platform with over a billion monthly active\nusers. Many...\n\nMay 03, 2022 |  6 MIN READ\n\n\n-----\n\n[Scammers are Exploiting Ukraine Donations](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/scammers-are-exploiting-ukraine-donations/%20)\n\nAuthored by Vallabh Chole and Oliver Devane Scammers are very quick at reacting to\ncurrent events, so...\n\nApr 01, 2022 |  7 MIN READ\n\n[Imposter Netflix Chrome Extension Dupes 100k Users](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/imposter-netflix-chrome-extension-dupes-100k-users/%20)\n\nAuthored by Oliver Devane, Vallabh Chole, and Aayush Tyagi McAfee has recently\nobserved several malicious Chrome Extensions...\n\nMar 10, 2022 |  8 MIN READ\n\n[Why Am I Getting All These Notifications on my Phone?](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/why-am-i-getting-all-these-notifications-on-my-phone/%20)\n\nAuthored by Oliver Devane and Vallabh Chole  Notifications on Chrome and Edge, both\ndesktop browsers, are commonplace,...\n\nFeb 25, 2022 |  5 MIN READ\n\n\n-----\n\n[Emotet’s Uncommon Approach of Masking IP Addresses](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/emotets-uncommon-approach-of-masking-ip-addresses/%20)\n\nIn a recent campaign of Emotet, McAfee Researchers observed a change in techniques. The\nEmotet maldoc was...\n\nFeb 04, 2022 |  4 MIN READ\n\n[HANCITOR DOC drops via CLIPBOARD](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/hancitor-doc-drops-via-clipboard/%20)\n\nHancitor, a loader that provides Malware as a Service, has been observed distributing\nmalware such as FickerStealer,...\n\nDec 13, 2021 |  6 MIN READ\n\n[‘Tis the Season for Scams](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/tis-the-season-for-scams/%20)\n\n‘Tis the Season for Scams\n\nNov 29, 2021 |  18 MIN READ\n\n\n-----\n\n[The Newest Malicious Actor: “Squirrelwaffle” Malicious Doc.](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/the-newest-malicious-actor-squirrelwaffle-malicious-doc/%20)\n\nAuthored By Kiran Raj Due to their widespread use, Office Documents are commonly used\nby Malicious actors...\n\nNov 10, 2021 |  4 MIN READ\n\n[Social Network Account Stealers Hidden in Android Gaming Hacking Tool](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/social-networks-account-stealer-hidden-in-android-gaming-hacking-tool/%20)\n\nAuthored by: Wenfeng Yu McAfee Mobile Research team recently discovered a new piece of\nmalware that specifically...\n\nOct 19, 2021 |  6 MIN READ\n\n[Malicious PowerPoint Documents on the Rise](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/malicious-powerpoint-documents-on-the-rise/%20)\n\nAuthored by Anuradha M McAfee Labs have observed a new phishing campaign that utilizes\nmacro capabilities available...\n\nSep 21, 2021 |  6 MIN READ\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-03-21 - VSkimmer Botnet Targets Credit Card Payment Terminals.pdf"
    ],
    "report_names": [
        "2013-03-21 - VSkimmer Botnet Targets Credit Card Payment Terminals.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535685,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653752856,
    "ts_modification_date": 1653752856,
    "files": {
        "pdf": "https://archive.orkl.eu/77626001f29b14e7006e3bfcbcd94e5acae729d0.pdf",
        "text": "https://archive.orkl.eu/77626001f29b14e7006e3bfcbcd94e5acae729d0.txt",
        "img": "https://archive.orkl.eu/77626001f29b14e7006e3bfcbcd94e5acae729d0.jpg"
    }
}