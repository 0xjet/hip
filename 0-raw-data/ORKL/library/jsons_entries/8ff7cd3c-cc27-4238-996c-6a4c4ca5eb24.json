{
    "id": "8ff7cd3c-cc27-4238-996c-6a4c4ca5eb24",
    "created_at": "2023-01-12T15:03:03.200507Z",
    "updated_at": "2025-03-27T02:16:39.937013Z",
    "deleted_at": null,
    "sha1_hash": "2a263076558c7f8aee63574f6205fd68bbfe20bb",
    "title": "2021-04-02 - A “txt file” can steal all your secrets",
    "authors": "",
    "file_creation_date": "2022-05-28T03:46:55Z",
    "file_modification_date": "2022-05-28T03:46:55Z",
    "file_size": 695835,
    "plain_text": "# A “txt file” can steal all your secrets\n\n**blog.360totalsecurity.com/en/a-txt-file-can-steal-all-your-secrets/**\n\nApr 2, 2021kate\n\n[Tweet](https://twitter.com/share)\n\n\nApril 2, 2021\n\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\nRecently, 360 Security Center’s threat monitoring platform has detected an email phishing attack. This attack uses a secret-stealing Trojan\ncalled Poulight. The Poulight Trojan has been put into use since last year and has complete and powerful functions. This attack proved that it\nhas begun to spread and use overseas.\n\n**Attack process analysis**\n\nThe attacker will first drop a phishing file using RLO (Right-to-Left Override) technology. Using RLO technology, the phishing file originally\nnamed “ReadMe_txt.lnk.lnk” will be displayed as “ReadMe_knl.txt” on the user’s computer. . At the same time, if the attacker sets the icon of\nthe lnk file as a notepad icon, it is easy for the user to mistake it for a txt file with no harm, which is extremely confusing.\n\nIn this way, the user originally thought to open a txt file, but actually executed the code prepared by the attacker. The system will execute the\npowershell command according to the content of the “target” customized by the attacker, download the malicious program\nhttps[:]//iwillcreatemedia[.]com/build.exe, set it as a hidden attribute, and run it.\n\nAfter analysis, the downloaded malicious program was compiled with .net and the internal name is Poullight.exe. The developer did not\nconfuse the code.\n\n**Code analysis**\n\nOperating environment detection\n\n\n-----\n\ne putty3 e e do oaded to t e oca st c ec et e t e cu e t e o e t s a tua ac e o a us a a ys s e o e t\nit is, it will exit. This action is used to combat some sample analysis sandboxes.\n\nAfter passing the environmental inspection, the Trojan starts to create threads to execute its real malicious function modules.\n\nFirst, the Trojan will load its own resources, and Base64 decode them, and finally get the configuration content:\n\n**<prog.params>YWRtaW4=|MQ==|MA==</prog.params>**\n\n**<title>UG91bGlnaHQ=</title>**\n\n**<cpdata>MHwwfDEyQ051S2tLSzF4TEZvTTlQNTh6V1hrRUxNeDF5NTF6Nll8MTJDTnVLa0tLMXhMRm9NOVA1OHpXWGtFTE14MXk1MXo2W**\n\n**<ulfile>aHR0cDovL3J1LXVpZC01MDczNTI5MjAucHAucnUvZXhhbXBsZS5leGU=</ulfile>**\n\n**<mutex>PL2d4vFEgVbQddddkms0ZhQiI0I</mutex>**\n\nThe value of <mutex> is converted to lowercase and “pl2d4vfegvbqddddkms0zhqii0i” is created as the file name under the %TEMP% directory,\nand the written content is a random value of 8 to 32 bytes. However, analysts found that there seems to be a problem with this part of the\ncode, or that the Trojan horse program we got is still in the pre-test stage, which makes it unable to run normally.\n\n**Data theft**\n\nIn addition to the detection of the operating environment, the Trojan will also record user names, machine names, system names, and other\nmachine information including installed anti-virus products, graphics card labels, and processor labels.\n\n\n-----\n\nte a t e abo e data to t e e % oca pp ata%\\\\ 8 byte a do c a acte s \\\\ C o at o t t t ca be see o t e deco p ed\ncode that a lot of Russian descriptions are used in the program.\n\nAfter that, the Trojan obtains the list of currently active processes and writes it into the file %LocalAppData%\\\\1z9sq09u\\\\ProcessList.txt, which\nwill also mark “(Injected)” after the Trojan process name.\n\nNext, get the third element in the item value of <prog.params> in the previously mentioned configuration file to be decoded and perform\nBase64 decoding again. If the value is “1”, execute the function clipper.Start(). This function will decrypt the resource named “cpp”, the\nconnection string:\n\n<clbase>0|0|12CNuKkKK1xLFoM9P58zWXkELMx1y51z6Y|12CNuKkKK1xLFoM9P58zWXkELMx1y51z6Y|0</clbase>\n\nWrite the file %TEMP%\\\\Windows Defender.exe and execute it (the file does not exist in the test environment). Among them, the value in\n<clbase> is decoded by Base64 again from the value of <cpdata> decoded in the previous section.\n\nThe following is the data stolen by Poulight and its actions:\n\nDesktop screenshot；\nFor documents in the following folders, if the file name contains strings such as password, login, account, аккаунт, парол, вход, важно,\nсайта, site, or the suffix is .txt, .rtf, .log, .doc,. docx, .rdp, .sql files, all copied to the directory “\\\\Stealer Files\\\\Disks Files\\\\”：\n\n� Desktop directory, documents, %AppData%, %LocalAppData%；\nExcept \\Windows\\, \\programdata\\, \\program files (x86)\\, \\program files\\, \\users\\, \\perflogs\\, \\пользователи\\ in the root directory of\nthe disk;\nWeb camera to take pictures;\nFileZilla server login credentials：FileZilla\\recentservers.xml；\nPidgin login configuration:.purple\\accounts.xml；\nDiscord data storage backup：discord\\Local Storage；\nTelegram data storage files:\nTelegram Desktop\\tdata\\D877F783D5D3EF8C1\nTelegram Desktop\\tdata\\D877F783D5D3EF8C0\nTelegram Desktop\\tdata\\D877F783D5D3EF8C\\\\map1\nTelegram Desktop\\tdata\\D877F783D5D3EF8C\\\\map0\nSkype data：Microsoft\\\\Skype for Desktop\\\\Local Storage；\nStealing steam ssfn authorization files；\nStealing various cryptocurrency wallet related documents, including:\n\nBTC-BitCoin key data file wallet.dat, including wallet address key pair, wallet transaction and other information；\nBTC-Bytecoin wallet key file, search with .wallet suffix；\nBTC-Dash wallet wallet.dat file；\nAll files in the storage directory of BTC-Ethereum wallet key related files under Ethereum\\\\keystore；\nBTC-Monero wallet related documents；\n\nSteal cookies, access URLs, accounts, passwords, Autofill data, payment card information, etc. of 25 browsers;The file name is searched\nby wildcard string: “co*es”, “log*ta”, “we*ata”, “loc*ate”, the search scope is three levels of directories starting from the browser directory:\n\n_google_\n\n_yandex_\n\n_opera software_\n\n_amigo_\n\n_orbitum_\n\n\n-----\n\n_o_ _eta_\n\n_maxthon_\n\n_torch_\n\n_epic browser_\n\n_comodo_\n\n_ucozmedia_\n\n_centbrowser_\n\n_go!_\n\n_sputnik_\n\n_titan browser_\n\n_acwebbrowser_\n\n_vivaldi_\n\n_flock_\n\n_srware iron_\n\n_sleipnir_\n\n_rockmelt_\n\n_baidu spark_\n\n_coolnovo_\n\n_blackhawk_\n\n_maplestudio_\n\nAll the stolen data is stored in the directory %LocalAppData%\\\\\\1z9sq09u\\\\ (the string “1z9sq09u” is randomly generated).\n\n\n-----\n\nAfterwards, upload the stolen data to one of two remote C&C servers:\n\nhttp[:]//poullight[.]ru/handle.php (unused)\n\nhttp[:]//gfl.com[.]pk/Panel/gate.php.\n\nAfter the data is encoded, it is uploaded to the server in order. After the remote end returns the string “good”, the subsequent code will be\nexecuted. Otherwise, an upload attempt will be made every 2 seconds until it succeeds.\n\nAfter the above action is over, the Trojan will download the URL resource hxxp://ru-uid-507352920.pp.ru/example.exe and save it as\n“%LocalAppData%\\\\<8 bytes random characters 1>\\\\<8 bytes Random characters 2>.exe”, for example:\n%LocalAppData%\\\\en0mp4o4\\8ej8q80s.exe.\n\nThe main function of the program is also to collect various information on the machine, but after the collection, the folder where it is located is\ndeleted. It is speculated that it is still in the testing stage.\n\n360 Total Security already supports the detection and killing of the virus. infected User is recommended to install from the official website:\n[https://www.360totalsecurity.com.](https://www.360totalsecurity.com/)\n\n**IOCs**\n\n**Hash**\n\ndcb4dfc4c91e5af6d6465529fefef26f\n\n083119acb60804c6150d895d133c445a\n\nb874da17a923cf367ebb608b129579e1\n\n**C2**\n\nhxxp://gfl.com.pk/Panel/gate.php\n\n\n-----\n\n_p //pou g t u/ a d e p p（U used）_\n\n**URL**\n\nhxxps://iwillcreatemedia.com/build.exe\n\nhxxp://ru-uid-507352920.pp.ru/example.exe\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-02 - A “txt file” can steal all your secrets.pdf"
    ],
    "report_names": [
        "2021-04-02 - A “txt file” can steal all your secrets.pdf"
    ],
    "threat_actors": [
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535783,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653709615,
    "ts_modification_date": 1653709615,
    "files": {
        "pdf": "https://archive.orkl.eu/2a263076558c7f8aee63574f6205fd68bbfe20bb.pdf",
        "text": "https://archive.orkl.eu/2a263076558c7f8aee63574f6205fd68bbfe20bb.txt",
        "img": "https://archive.orkl.eu/2a263076558c7f8aee63574f6205fd68bbfe20bb.jpg"
    }
}