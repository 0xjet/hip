{
    "id": "cf73fdae-3814-461a-9b93-acc590ff8615",
    "created_at": "2022-10-25T16:48:24.29528Z",
    "updated_at": "2025-03-27T02:05:40.208235Z",
    "deleted_at": null,
    "sha1_hash": "a37ad7a269aa47439eeae1ac551c13b932441181",
    "title": "PowerPoint プレゼンテーション",
    "authors": "",
    "file_creation_date": "2021-04-26T11:22:39Z",
    "file_modification_date": "2021-04-26T19:00:21Z",
    "file_size": 1075717,
    "plain_text": "## How Did the Adversaries Abusing Bitcoin Blockchain\n Evade Our Takeover\n\n###### Tsuyoshi Taniguchi\n\n Christian Doerr\n\n\n-----\n\n#### A Game Of Cat And Mouse: Malware Evolves When Detection Is Good Enough\n\n\n-----\n\n#### A Game Of Cat And Mouse: Malware Evolves When Detection Is Good Enough\n\n\n-----\n\n#### Three Main Angles for Today’s Mitigation\n\n###### Option 1: Predict the domain names and stop them\n\n malicious.com\n\n q8a3da.com\n\n C&C IP NXDomain\n DNS server\n Option 2: Detect lookup patterns, especially NXDomains\n\n Option 3: Locate and seize the\n\n\n-----\n\n#### Who Are We\n\n###### Tsuyoshi Taniguchi, Ph.D. Harm Griffioen Christian Doerr, Ph.D. Researcher PhD Candidate Professor Cybersecurity + Enterprise Security Fujitsu System Integration Laboratories Hasso Plattner Institute for Digital Engineering Hasso Plattner Institute for Digital Engineering\n\n\n-----\n\n#### Advertising C&C Information via the Blockchain\n\n###### Signaling wallet\n\n Fetch the last two payments from a specific bitcoin wallet\n\n C&C server 142 93 0 206\n\n\n-----\n\n#### Three Main Angles for Yesterday’s Mitigation\n\n###### This latest criminal evolution is a significant problem for cyber defense. Option 1: Predict the domain names and stop them\n\n There is nothing to predict anymore.\n\n# x\n\n###### Nobody can remove transactions from the blockchain.\n\n 142.93.0.206\n\n Blockchain\n Option 2: Detect lookup patterns, especially NXDomainsx\n Some hide behind TOR gateway.\n No DNS lookups to unusual sites. Never any NXDomains\n Option 3: Locate and seize the\n\n# x\n\n\n-----\n\n#### Criminals Continuously Experimented & Improved\n\n###### During our 12 month observation, the attackers went through many rounds of redesign and continuous improvement. Let’s look at two, for a full discussion refer to our report.\n\n\n-----\n\n#### Why? The Blockchain is not Predictable\n\n###### Attacker signals new IP\n 142.93 + 0.206\n Previous transaction on the blockchain:\n Client queries blockchain:\n 67.205 +\n C&C @ 0.206 + 142.93\n 148.45\n\n Incorrect order!\n\n time\n\n\n-----\n\n#### Why? The Blockchain is not Predictable\n\n###### How do you get payments to\n be confirmed as quickly as\n Attacker signals new IP\n possible and in the right order?\n 142.93 + 0.206\n Previous transaction on the blockchain:\n Client queries blockchain:\n 67.205 +\n C&C @ 0.206 + 142.93\n 148.45\n\n Incorrect order!\n\n time\n\n\n-----\n\n#### Higher Fees, More Incentive for Miners\n = Better Control over Your Transactions\n\n###### Source: bitcoinwiki.org\n\n\n-----\n\n#### Avoiding High Transaction Fees\n\n###### Bitcoin halving -> Fees soared\n\n Jan. 2021\n\n Aug. 2019\n Mar. 2020 May 2020 Aug. 2020 Adversaries shifted their activities into the night to benefit from lower transaction volume and cheaper fees\n\n\n-----\n\n|Confirmed time Ti|Col2|Col3|\n|---|---|---|\n||||\n\n\n#### Experimenting with Transactions\n\n###### • Time lag: the first and second transactions in different blocks\n\n • Fee order: the first and second transactions in the same block\n\n second C&C update transaction\n completion\n first transaction\n 10 minutes\n\n Confirmed time Time lag\n\n Time lag\n\n\n-----\n\n#### Experimenting with Transactions\n\n###### • Time lag: the first and second transactions in different blocks\n\n • Fee order: the first and second transactions in the same block\n\n C&C update\n first second completion\n\n Transactions in the same block and in the correct order Fee order\n\n\n-----\n\n#### Experimenting with Transactions\n\n###### Over 2 hours\n downtime\n\n Fee order: Same Block\n Time lag:\n Different Fees\n Different Blocks\n Same Fee\n\n Jan. 2021\n\n\n-----\n\n#### Malware Takeover by Sending BTC to the Wallet\n\n###### Although ingenious, the blockchain C&C contained a mistake: Signaling is done based on receiving money, not sending it.\n\n Ours\n\n Ours\n Our sinkhole server\n\n “Shutdown infection”\n\n C&C\n\n\n-----\n\n#### Takeover and Adversarial Evasion\n\n###### Aug. 14 3:37, 3:47: 142.93.0[.]206\n Takeover 1:\n Aug. 14 6:18, 6:23: 34.67.67.23\n Downtime 2 days\n Aug. 16 10:12, 10:12: 142.93.0[.]206\n\n Aug. 17 5:46, 5:48: 142.93.0[.]206 Takeover 2: Aug. 17 6:45, 6:47: 34.67.67.23 Adversaries noticed Aug. 17 13:54, 14:10: 142.93.0[.]206 and reset C&C Aug. 17 14:20, 14:26: 142.93.0[.]206\n Takeover 3:\n Aug. 19 7:02, 7:02: 34.67.67.23\n Adversaries stopped their malicious activity\n\n\n-----\n\n#### Takeover and Adversarial Evasion\n\n###### Aug. 14 3:37, 3:47: 142.93.0[.]206\n Takeover 1:\n Aug. 14 6:18, 6:23: 34.67.67.23\n Downtime 2 days\n Aug. 16 10:12, 10:12: 142.93.0[.]206\n\n Aug. 17 5:46, 5:48: 142.93.0[.]206 Takeover 2: Aug. 17 6:45, 6:47: 34.67.67.23 Adversaries noticed Aug. 17 13:54, 14:10: 142.93.0[.]206 and reset C&C Aug. 17 14:20, 14:26: 142.93.0[.]206\n Takeover 3: Adversaries stopped\n Aug. 19 7:02, 7:02: 34.67.67.23\n their malicious activity\n But this was only a suspension...\n Adversaries redesigned their C&C mechanism\n\n\n-----\n\n#### Takeover and Adversarial Evasion\n\n###### Aug. 14 3:37, 3:47: 142.93.0[.]206\n Takeover 1:\n Aug. 14 6:18, 6:23: 34.67.67.23\n Downtime 2 days\n Aug. 16 10:12, 10:12: 142.93.0[.]206\n Takeover 2:\n What did we accomplish?\n Aug. 17 5:46, 5:48: 142.93.0[.]206\n Adversaries\n 3 takeovers\n Aug. 17 6:45, 6:47: 34.67.67.23\n noticed and\n malware offline for 17 days\n Aug. 17 13:54, 14:10: 142.93.0[.]206\n reset C&C\n prevented 2 million USD\n Aug. 17 14:20, 14:26: 142.93.0[.]206\n in damages\n Takeover 3:\n Aug. 19 7:02, 7:02: 34.67.67.23 Adversaries stopped\n their malicious activity\n But this was only a suspension...\n Adversaries redesigned their C&C mechanism\n\n\n-----\n\n### How Did the Adversaries Evade our Takeover?\n\n###### Incoming but anyone can transaction send BTC and no\n Sending wallet encodes the one can prevent\n IP Signaling wallet\n Our wallet\n 1N94r C&C IP 1BkeG this...\n\n\n-----\n\n### How Did the Adversaries Evade our Takeover?\n\n###### The simple fix was rolled out in malware samples from\n Outgoing\n September 1 onwards\n transaction\n IP Signaling wallet encodes the Disposable wallet\n 1N94r 1BkeG\n C&C IP\n\n Clients are programmed to watch a bitcoin wallet for outgoing transactions\n\n\n-----\n\n### How Did the Adversaries Evade our Takeover?\n\n###### The simple fix was rolled out in malware samples from\n Outgoing\n September 1 onwards\n transaction\n IP Signaling wallet encodes the Disposable wallet\n but they eventually gave up.\n 1N94r 1BkeG\n C&C IP\n\n Our takeovers: Last update: Aug. 14 - 19, 2020 Jan. 13[th], 2021 The first C&C IP:\n\n Clients are programmed to\n Aug. 28[th], 2019\n watch a bitcoin wallet for outgoing transactions\n\n\n-----\n\n#### Concluding Remarks and Takeaways\n\n###### • Blockchain-based C&C is the next step in a long evaluation of criminal TTPs,\n but it will be very difficult to mitigate this technique in the future\n\n • We could study how the adversaries experimented, learned and improved their TTPs over\n time, and traded off performance with how much they had to pay for it\n\n • A simple design mistake allowed us to takeover their operation until they redesigned,\n but eventually they dropped their use of the Bitcoin blockchain for C&C coordination\n\n • This mechanism was ingenious, however, vulnerable to Bitcoin (fees) surge which cut their\n profit, as the result, they gave up when the cost was not worth it\n\n • After evading our takeover, we could track their malicious activity by monitoring Bitcoin\n behavior\n\n\n-----\n\n#### Citation\n\n##### 1. Pletinckx, Trap and Doerr, Malware Coordination using the Blockchain: An\n\n###### Analysis of the Cerber Ransomware, IEEE Conference on Communications and Network Security 2018, https://www.cyber-threat- intelligence.com/publications/CNS2018-Cerber.pdf\n##### 2. Taniguchi, Griffioen and Doerr, Analysis and Takeover of the Bitcoin-\n\n###### Coordinated Pony Malware, AsiaCCS 2021, download: https://www.cyber- threat-intelligence.com/publications/AsiaCCS2021-pony.pdf\n##### 3. Pony’s C&C servers hidden inside the Bitcoin blockchain,\n\n###### https://research.checkpoint.com/2019/ponys-cc-servers-hidden-inside-the- bitcoin-blockchain/\n##### 4. Metabase, https://www.metabase.com/ 5. Inside look at lifecycle of stolen credentials and extent of data breach\n\n###### damage https://www helpnetsecurity com/2018/07/19/credential-spill-\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://i.blackhat.com/asia-21/Thursday-Handouts/as21-Taniguchi-How-Did-The-Adversaries-Abusing-The-Bitcoin-Blockchain-Evade-Our-Takeover.pdf"
    ],
    "report_names": [
        "as21-Taniguchi-How-Did-The-Adversaries-Abusing-The-Bitcoin-Blockchain-Evade-Our-Takeover.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1619436159,
    "ts_modification_date": 1619463621,
    "files": {
        "pdf": "https://archive.orkl.eu/a37ad7a269aa47439eeae1ac551c13b932441181.pdf",
        "text": "https://archive.orkl.eu/a37ad7a269aa47439eeae1ac551c13b932441181.txt",
        "img": "https://archive.orkl.eu/a37ad7a269aa47439eeae1ac551c13b932441181.jpg"
    }
}