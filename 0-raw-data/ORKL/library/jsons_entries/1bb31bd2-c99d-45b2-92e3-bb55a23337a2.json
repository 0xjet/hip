{
    "id": "1bb31bd2-c99d-45b2-92e3-bb55a23337a2",
    "created_at": "2023-01-12T15:07:06.087661Z",
    "updated_at": "2025-03-27T02:09:30.445935Z",
    "deleted_at": null,
    "sha1_hash": "d7e1e1a40423e71cca3aca2f87c96c5954ac3294",
    "title": "2021-03-18 - Cybereason Exposes Campaign Targeting US Taxpayers with NetWire and Remcos Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T00:47:08Z",
    "file_modification_date": "2022-05-28T00:47:08Z",
    "file_size": 1858740,
    "plain_text": "# Cybereason Exposes Campaign Targeting US Taxpayers with NetWire and Remcos Malware\n\n**cybereason.com/blog/cybereason-exposes-malware-targeting-us-taxpayers**\n\nOver the past year, the [Cybereason Nocturnus Team has observed various trends among cyber criminals and nation-state groups leveraging](https://www.cybereason.com/company/nocturnus)\n[various global events such as COVID-19 and other topical themes and trending issues as phishing content to lure their victims into installing](https://www.cybereason.com/blog/just-because-youre-home-doesnt-mean-youre-safe)\ntheir malware of choice.\n\nAs the [tax season is already here, Cybereason detected a new campaign targeting US taxpayers with documents that purport to contain tax-](https://threatpost.com/tax-quickbooks-data-theft/164253/)\nrelated content, ultimately delivering NetWire and Remcos - two powerful and popular RATs (remote access trojans) which can allow attackers\nto take control of the victims’ machines and steal sensitive information.\n\n## Key Points\n\n**Leveraging US Tax Season to lure victims: Each year, by April 15th, all US citizens are expected to deliver their tax returns.**\nCybereason detected a phishing campaign targeting US taxpayers.\n\n**[Delivering two types of commodity malware: Two infamous remote access tools (RATs) are being used in this campaign, NetWire and](https://malpedia.caad.fkie.fraunhofer.de/details/win.netwire)**\n[Remcos, each manifesting as binaries delivered via malicious documents.](https://malpedia.caad.fkie.fraunhofer.de/details/win.remcos)\n\n**Evading heuristic and AV detection mechanisms: The malicious documents that infect the user are roughly 7MB in size, which allows**\nthem to evade traditional AV mechanisms and heuristic detection.\n\n**Abuse of legitimate cloud services: The infection chain uses cloud services such as “imgur” to store the Netwire and Remcos**\npayloads, hidden in image files\n\n**Steganography: Payloads are concealed and downloaded within image files, combined with the fact they are hosted on public cloud**\nservices makes them even harder to detect.\n\n**Exploiting legitimate OpenVPN clients: As a part of the infection process, a legitimate OpenVPN client is downloaded and executed**\nthen sideloads a malicious DLL that drops NetWire/Remcos.\n\n## Background\n\n[The campaign bears resemblance to another campaign observed in April of 2020 which also delivered the NetWire RAT. Both NetWire and](https://www.fortinet.com/blog/threat-research/netwire-rat-targeting-taxpayers-is-spreading-via-legacy-microsoft-excel-4-0-macro)\nRemcos are commercial RATs that are available for purchase online for rather affordable prices of as little as US$10 per month. Both offer\nvarious licensing plans and following the Malware-as-a-Service (MaaS) model, offering their customers a subscription-based model with\nservices such as 24/7 support and software updates:\n\n\n-----\n\n_Remcos and NetWire as offered on their websites_\n\n## campaign analysis\n\n\n-----\n\n## Infection Vector: Lure Documents Containing a Malicious Macro\n\nThe infection vector that lures the users into installing the malware is a tax return themed Word document containing a malicious macro:\n\n_Malicious documents submitted to VirusTotal_\n\nOnce the document has been opened, the content in the background is allegedly blurred, and the “Enable Editing” and “Enable Content”\nprompts must be manually confirmed by the user:\n\n_Malicious documents content_\n\n\n-----\n\ns s a o soc a e g ee g et od used to e cou age t e use to e ab e e bedded ac os to u o t e ac e O ce t e\n[malicious content is being executed, an embedded and heavily obfuscated macro is ran on the victim’s machine:](https://www.virustotal.com/gui/file/0676238b5564db39016ffe66eb7e9b77a47271eed46e23575286954b8b78739f/detection)\n\n_A part of the embedded macro obfuscated code_\n\nThe above code partially shows that the payload is eventually dropped in the users “Temp” directory:\n\n_The DLL dropped by the macro code_\n\nFinally, the DLL is injected into notepad and continues the infection chain.\n\n## Loaders\n\nThe “sid.dll” loader that was dropped by the macro was observed to have at least two different variants: one is a loader for Remcos, and the\nother is a loader for NetWire. Looking at their exports, both loaders share the same “payload” exported method:\n\n_The loader’s exported methods_\n\nUpon execution, the “payload” method starts decrypting data using a XOR key:\n\n_Dat decryption methods of the NetWire loader_\n\nThe first decrypted part is an additional executable code, and the second part is decrypting the URL the loader connects to in order to\ndownload the next execution stage:\n\n_The decrypted initial C2 URL_\n\nEventually, the malicious code is injected into “tracert.exe” that downloads the OpenVPN client along with a trojanized DLL file called\n“libcrypto-1_1.dll”, which will be side-loaded to the OpenVPN client upon execution. A similar process, most likely by the same threat actor,\nwas [mentioned earlier this year and describes documents that date back to middle 2020. It then creates a persistence for the VPN client by](https://twitter.com/h2jazi/status/1354851585210380290)\ncreating automatic execution of a lnk file (C:\\Users\\%username%\\AppData\\Local\\Temp\\openvpn gui lnk)\n\n\n-----\n\n## OpenVPN DLL Sideloading\n\nThe malicious code in the sideloaded DLL unpacks an additional DLL in-memory and injects it into “notepad.exe”. A secondary payload hidden\nin an image file is then downloaded from “imgur.com”, a well-known cloud image storage service. The decrypted payload can be either\nNetWire or Remcos:\n\n_Screenshot of an image concealing a malicious payload_\n\n## Remcos\n\nThe features for the Remcos RAT can be found on its official website, and includes:\n\n**• Remote execution of shell commands on the infected machine**\n\n**• Downloading and execution of additional payloads**\n\n**• Screen capture**\n\n**• Clipboard data management**\n\nThe version that is used in this campaign is 3.0.0 professional, which also offers support and software updates:\n\n_Remcos variant as seen in its code_\n\n## netwire\n\n[NetWire has been active for years, and in 2019 a new version was spotted in the wild. Some of the most notable features of NetWire include:](https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing)\n\n**• Downloading and execution of additional payloads**\n\n**• File and system managers**\n\n**• Screen capture**\n\n**• Browser credentials and history theft**\n\n**• Gathering information about the victim’s system**\n\n\n-----\n\nS a to e cos, t e et e a a e a so co ta s d cat e a dcoded st gs\n\n_NetWire hardcoded strings_\n\n## Cybereason Detection and Prevention\n\nThe [Cybereason Defense Platform detects the execution of a malicious Word document used in the operation:](https://www.cybereason.com/platform#graphic)\n\nOnce persistence is created in the first stage, the second stage of the attack is also detected, monitoring Remcos/NetWire injected into\ncmd.exe:\n\n[Corresponding Malops(™) are then triggered:](https://www.cybereason.com/platform#malop)\n\nWhen the malicious sideloaded DLL is loaded by “openvpn-gui” in Prevention Mode, the Cybereason Defense Platform also detects the code\ninjection into “notepad.exe” and prevents it from executing further:\n\n\n-----\n\n## Conclusion\n\nSocial engineering via phishing has been, and continues to be, the preferred infection method among cyber criminals and nation-state threat\nactors alike. In order to succeed, the threat actor must choose an interesting theme that is likely to lure its victim into opening the weaponized\ndocument or link.\n\nIn the campaign, we have demonstrated how cybercriminals are leveraging the US tax season to infect American taxpayers with the Remcos\nand NetWire remote access trojans, granting the malware operators full access and control over the victims’ machines. The sensitive\ninformation collected from the victims can be used by the attackers to carry out financial fraud or can be traded in the underground\ncommunities.\n\nCybereason also noticed efforts by the threat actor designed the campaign to stay under the radar, using various techniques such as\nsteganography, storing payloads on legitimate cloud-based services, and exploiting DLL sideloading against a legitimate software.\n\n**Looking for the IOCs? Click on the chatbot displayed in lower-right of your screen.**\n\n## MITRE ATT&CK BREAKDOWN\n\n\n**Execution** **Persistence** **Privilege**\n**Escalation**\n\n\n**Defense Evasion** **Credential**\n**Access**\n\n\n**Discovery** **Collection** **Command**\n**& Control**\n\n\n**[Native API](https://attack.mitre.org/techniques/T1106/)** **Hijack Execution**\n**[Flow: DLL](https://attack.mitre.org/techniques/T1574/002/)**\n**sideloading**\n\n\n**Process**\n**Injection**\n\n\n**Deobfuscate/Decode**\n**Files or Information**\n\n**Obfuscated Files or**\n**Information**\n\n\n**OS**\n**[Credential](https://attack.mitre.org/techniques/T1003/)**\n**Dumping**\n\n\n**System Time**\n**Discovery**\n\n**Account**\n**Discovery**\n\n\n**Ingress**\n**[Tool](https://attack.mitre.org/techniques/T1105/)**\n**Transfer**\n\n**Encrypted**\n**Channel**\n\n**Remote**\n**[Access](https://attack.mitre.org/techniques/T1219/)**\n**Software**\n\n**Non-**\n**Application**\n**Layer**\n**Protocol**\n\n**Application**\n**Layer**\n**Protocol**\n\n\n**Exploitation**\n**[for Client](https://attack.mitre.org/techniques/T1203/)**\n**Execution**\n\n**Command**\n**[and Scripting](https://attack.mitre.org/techniques/T1059/)**\n**Interpreter**\n\n**Scheduled**\n**Task/Job**\n\n**System**\n**Services:**\n**Service**\n**Execution**\n\n\n**Event Triggered**\n**Execution:**\n**Application**\n**Shimming**\n\n**Create or Modify**\n**[System Process:](https://attack.mitre.org/techniques/T1543/003/)**\n**Windows Service**\n\n\n**[Masquerading](https://attack.mitre.org/techniques/T1036/)** **System Service**\n**Discovery**\n\n\n**Credential**\n**API**\n**Hooking**\n\n**Input**\n**Capture:**\n**[Credential](https://attack.mitre.org/techniques/T1056/004/)**\n**API**\n**Hooking**\n\n**Screen**\n**Capture**\n\n**Video**\n**Capture**\n\n**Clipboard**\n**Data**\n\n\n**Virtualization/Sandbox**\n**Evasion**\n\n**[Obfuscated Files or](https://attack.mitre.org/techniques/T1027/003/)**\n**Information:**\n**Steganography**\n\n\n**File and**\n**[Directory](https://attack.mitre.org/techniques/T1083/)**\n**Discovery**\n\n**System**\n**[Information](https://attack.mitre.org/techniques/T1082/)**\n**Discovery**\n\n\n-----\n\n**Obfuscated Files or**\n**[Information: Software](https://attack.mitre.org/techniques/T1027/002/)**\n**Packing**\n\n## NetWire and Remcos Malware | Indicator's of Compromise\n\n### Files\n\n\n**Software**\n**Discovery:**\n**[Security](https://attack.mitre.org/techniques/T1518/001/)**\n**Software**\n**Discovery**\n\n**Process**\n**Discovery**\n\n**System**\n**Network**\n**Configuration**\n**Discovery**\n\n\nSHA1 SHA256 Type\n\n5e4577a28a42c29cbc10fe738652666e5363da1d 0676238b5564db39016ffe66eb7e9b77a47271eed46e23575286954b8b78739f VBA\n\n1e17bf14f3ca714cefecc3c4b053bba23466b669 db0a8b2e977f64d6ee08775c832dabd4e5e005047275f87efb6be1d8ff4e142e Malicious\ndocument\n\neac9b14781aec888b2008ee4f569265d30bbc231 1d44fe1b97e1de15c6b0d33630ce501ccecccd792a5e200979bd987fc7aea549 Malicious\ndocument\n\n597f31535e717ce873d789e208c1cb0adcdd2f0d 5a25eb67f9800dc9151847eca2a5a8e1ea8e9ae2f1a17d0f4cfa1e9da3c6c23c Malicious\ndocument\n\n80b46bd974c1392cc6d3ea27d12093ae7537be50 95725086d5d56e7015c0aaa405640eefb5d4d62d9614dce331880753266ffb51 Malicious\ndocument\n\nf0ac8d48ba43de1fc566d53597b2005496a3fcad a15f82c78c11b0a317ca1fb07fab110354e197af8036f6e915e031007647bdf4 Malicious\ndocument\n\n9bdfa52764d858b5f074a63ff7911a42dc12be93 5917635fc380adf07c49e632ae844225e7ff06a66fca5b20434c64cda0c875b5 Malicious\ndocument\n\nfa5322d971210ed9627833b0c1beb6aa03cd1f84 cce9d7a318c1a8ed40dd0d3a858600424f34dfe8e0b5c91ffefeb58b495c70cb Malicious\ndocument\n\n\nf4e0104333250e0c2a688a7eb9772228ef5eb377\n\nccb5903ae3706e133420936ca6ab32ccb216480c\n\nfb78e2ef5010e62d18825e2e2eeacf3edbf0e0c1\n\n5581ee470231d0a2a3f4a4778343e29423a91be0\n\nbc24701afa14f10f07ac01444c9abad6aaa346fd\n\n8dfb536a399adc93484e4d68d953c2f9e87811b0\n\n23376196f17eb5319ed663f1133447cf6f1f9441\n\n6c6e6c382e39c18a0f83fe09824a96239da43c34\n\nb3768b81cfa8813f1692963ea7308a19e213819a\n\n\n26074ef98027d222d6cff9fae12df04cd0beb8966da16c0a915326759a6f4de7\n\n23b0da3674d5c4d611e5d1660dfccf192c7a51a061e4e135bdd292d50b981ef8\n\n9b67fd995fb48fe19efb7d5610e1e5906e5d7c56ec02b59081e8a9d9875101ba\n\n09054f1dafb72ef8930a4366ca27e26b9d30b503ce35256435b1296fee8d0cbc\n\nf7f721266f0e31b107b782bb5f5672eda5262c6c8654c75ad573ae2845f3c889\n\n919b49583e0e3c8865f2c33d0ba566b4caf83c96a155f341ac46e6cfdb4daa39\n\nf72ad2afb781f309d6155817fbf7f013123fa8cc475e527c22d564ba130be2f4\n\nae73d880e9b48c7714448fc3f1bf5e5836dfa6cf297d2e77bef045e980a7adff\n\n6f248f6dd7ac467f8c9e39c7dda64825147df54cb2ae6a44e0d3c5e7530a3890\n\n\nRemcos\nloader\n\nNetWire\nloader\n\nNetWire\ninfection\nOpenVPN\nsideloaded\nDLL\n\n\n-----\n\n435820a063f5d400bcd044194fab148968a07df7\n\nd6123fb3b43ec3a64cb39ab1925539de1dc406e9\n\n155b7a512175f802512d800dbe13e884c95d349f\n\n826be84ef36bc065c4feaecaef0841fd7a2035a9\n\nd6cf40cf57e0af9de9ea4406ea048724972a6bce\n\ne681ea9f3a49bae13c375389eab45e34a9f4082f\n\n92ebe3ab3f4fa88d612365a954dd663522a8c45d\n\ndf12d7fcc43da256a11c80d7f581bb5b845e8fac\n\nf1049602ae147dbc3efb428da789619ca8f42fb4\n\n5cd11dde693f760b468a58a0db912cf5807ffbad\n\n### Remcos\n\n C2 IPs\n\n74.118.138[.]161\n\n45.61.136[.]57\n\n104.168.148[.]85\n\n### C2 Domains\n\npetebots[.]cloud\n\nwww.designitwithmary[.]com\n\nwww.sophosmail[.]club\n\n### C2 URLs\n\nhttps://i.imgur[.]com/6T75Qws.png\n\nhttps://i.imgur[.]com/HUTEMgu.png\n\n### NetWire\n\n C2 IPs\n\n23.106.124[.]111\n\n188.165.245[.]148\n\n### C2 Domains\n\neventsbypearce[.]host\n\nescusemoisco[.]com\n\n### C2 URLs\n\nhttps://i.imgur[.]com/Uef1u8s.png\n\nhttps://i.ibb[.]co/djCM4KB/a-Ic-Xr-TDjs-A.jpg\n\n\n8c74479d1b4d88b2f43b0e3589fbd4e7ffa0141c57011a2528205005ec657a86\n\nb16cd6ed20daf9cba1a6f68dcc2f6ab48ce1cef89148fb03f74760c84ca885f1\n\naa5c12465da1126efb8af40ad4377f2951df27adfd6bfdd9929f49eefb844632\n\n9a9975b28796eb5b5057a515cc49e4cd911ce734f80c4880f1455669cb14276e\n\n5926c6d07e78b5b48f18ff008d474e46b42a93c20302f391e90343f57e7aa02a\n\n56ef472cd74cd04afd42083c1d836767e7d4a48b991379420cda9317bf789a4a\n\n131990449868578b35f7f649aa62bf2fc5b553a12874ee3f893d02d8673582f1\n\nca1ca8bf30feda8853391fb59ded4e46265165f738a867ff20667bad0579f4ea\n\n04e0218dcad6ef6788eee1b1665bb413a7947844c01e9a157aa7c123f1cdced6\n\nc604b7babe96d2d853dcf89b5a4e5737c077d372ee48279ecbeede3a041129da\n\n\nRemcos\ninfection\nOpenVPN\nsideloaded\nDLL\n\nNetWire\ninjected\npayload\n\nRemcos\ninjected\npayload\n\n\n-----\n\nAbout the Author\n\n**Daniel Frank**\n\nDaniel Frank is a senior Malware Researcher at Cybereason. Prior to Cybereason, Frank was a Malware Researcher in F5 Networks and RSA\nSecurity. His core roles as a Malware Researcher include researching emerging threats, reverse-engineering malware and developing\nsecurity-driven code. Frank has a BSc degree in information systems.\n\n[All Posts by Daniel Frank](https://www.cybereason.com/blog/authors/daniel-frank)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-18 - Cybereason Exposes Campaign Targeting US Taxpayers with NetWire and Remcos Malware.pdf"
    ],
    "report_names": [
        "2021-03-18 - Cybereason Exposes Campaign Targeting US Taxpayers with NetWire and Remcos Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536026,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653698828,
    "ts_modification_date": 1653698828,
    "files": {
        "pdf": "https://archive.orkl.eu/d7e1e1a40423e71cca3aca2f87c96c5954ac3294.pdf",
        "text": "https://archive.orkl.eu/d7e1e1a40423e71cca3aca2f87c96c5954ac3294.txt",
        "img": "https://archive.orkl.eu/d7e1e1a40423e71cca3aca2f87c96c5954ac3294.jpg"
    }
}