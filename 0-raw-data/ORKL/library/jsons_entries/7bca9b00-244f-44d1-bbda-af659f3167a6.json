{
    "id": "7bca9b00-244f-44d1-bbda-af659f3167a6",
    "created_at": "2023-01-12T15:02:21.083427Z",
    "updated_at": "2025-03-27T02:09:18.203493Z",
    "deleted_at": null,
    "sha1_hash": "3e6443795674b4374f7a1ff9408fe36ddc58c85d",
    "title": "2022-03-30 - Hive ransomware uses new 'IPfuscation' trick to hide payload",
    "authors": "",
    "file_creation_date": "2022-05-28T23:46:50Z",
    "file_modification_date": "2022-05-28T23:46:50Z",
    "file_size": 1525618,
    "plain_text": "# Hive ransomware uses new 'IPfuscation' trick to hide payload\n\n**[bleepingcomputer.com/news/security/hive-ransomware-uses-new-ipfuscation-trick-to-hide-payload/](https://www.bleepingcomputer.com/news/security/hive-ransomware-uses-new-ipfuscation-trick-to-hide-payload/)**\n\nBill Toulas\n\nBy\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nMarch 30, 2022\n10:12 AM\n0\n\n\n-----\n\nThreat analysts have discovered a new obfuscation technique used by the Hive ransomware\ngang, which involves IPv4 addresses and a series of conversions that eventually lead to\ndownloading a Cobalt Strike beacon.\n\nCode obfuscation is what helps threat actors hide the malicious nature of their code from\nhuman reviewers or security software so that they can evade detection.\n\nThere are numerous ways to achieve obfuscation, each with its own set of pros and cons,\nbut a novel one discovered in a an incident response involving Hive ransomware shows that\nadversaries are finding new, stealthier ways to achieve their goal.\n\n[Sentinel Labs analysts report on the new obfuscation technique, that they call “IPfuscation”,](https://www.sentinelone.com/blog/hive-ransomware-deploys-novel-ipfuscation-technique/)\nand which is yet another example of how effective simple but smart methods can be in realworld malware deployment.\n\n## From IP to shellcode\n\nThe analysts discovered the new technique while analyzing 64-bit Windows executables,\neach containing a payload that delivers Cobalt Strike.\n\nThe payload itself is obfuscated by taking the form of an array of ASCII IPv4 addresses, so it\nlooks like an innocuous list of IP addresses.\n\nIn the context of malware analysis, the list may even be mistaken for hard-coded C2\ncommunication information.\n\n\n-----\n\n**The list of IPv4 addresses that will assemble the payload**\n\n_(Sentinel Labs)_\n[When the file is passed to a converting function (ip2string.h) that translates the string to](https://docs.microsoft.com/en-us/windows/win32/api/ip2string/nf-ip2string-rtlipv4stringtoaddressa)\nbinary, a blob of shellcode appears.\n\nOnce this step has been completed, the malware executes the shellcode either via direct\nSYSCALLs or by proxying execution via callback on the user interface language enumerator\n[(winnls.h), resulting in a standard Cobalt Strike stager.](https://docs.microsoft.com/en-us/windows/win32/api/winnls/nf-winnls-enumuilanguagesa)\n\nHere’s an example from the Sentinel Labs report:\n\nThe first hardcoded IP-formatted string is the ASCII string “252.72.131.228”, which has a\nbinary representation of 0xE48348FC (big endian), and the next “IP” to be translated is\n“240.232.200.0”, which has a binary representation of 0xC8E8F0.\n\nDisassembling these “binary representations” shows the start of shellcode generated by\ncommon penetration testing frameworks.\n\n\n-----\n\n**The resulting shellcode from two IP addresses**\n_(Sentinel Labs)_\nThe analysts have discovered additional IPfuscation variants that instead of IPv4 addresses\nuse IPv6, UUIDs, and MAC addresses, all operating in an almost identical manner as what\nwe described above.\n\n**Deobfuscated strings forming a Cobalt Strike stager**\n\n_(Sentinel Labs)_\nThe takeaway from this is that relying solely on static signatures for malicious payload\ndetection is not enough these days.\n\nBehavioral detection, AI-assisted analysis, and holistic endpoint security that aggregates\nsuspicious elements from multiple points would have a better chance at lifting the lid of\nIPfuscation, the researchers say.\n\n\n-----\n\n### Related Articles:\n\n[Malicious PyPI package opens backdoors on Windows, Linux, and Macs](https://www.bleepingcomputer.com/news/security/malicious-pypi-package-opens-backdoors-on-windows-linux-and-macs/)\n\n[Microsoft: Credit card stealers are getting much stealthier](https://www.bleepingcomputer.com/news/security/microsoft-credit-card-stealers-are-getting-much-stealthier/)\n\n[New Bumblebee malware replaces Conti's BazarLoader in cyberattacks](https://www.bleepingcomputer.com/news/security/new-bumblebee-malware-replaces-contis-bazarloader-in-cyberattacks/)\n\n[Quantum ransomware seen deployed in rapid network attacks](https://www.bleepingcomputer.com/news/security/quantum-ransomware-seen-deployed-in-rapid-network-attacks/)\n\n[Microsoft Exchange servers hacked to deploy Hive ransomware](https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-hacked-to-deploy-hive-ransomware/)\n\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nBill Toulas is a technology writer and infosec news reporter with over a decade of experience\nworking on various online publications. An open source advocate and Linux enthusiast, is\ncurrently finding pleasure in following hacks, malware campaigns, and data breach incidents,\nas well as by exploring the intricate ways through which tech is swiftly transforming our lives.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-30 - Hive ransomware uses new 'IPfuscation' trick to hide payload.pdf"
    ],
    "report_names": [
        "2022-03-30 - Hive ransomware uses new 'IPfuscation' trick to hide payload.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535741,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653781610,
    "ts_modification_date": 1653781610,
    "files": {
        "pdf": "https://archive.orkl.eu/3e6443795674b4374f7a1ff9408fe36ddc58c85d.pdf",
        "text": "https://archive.orkl.eu/3e6443795674b4374f7a1ff9408fe36ddc58c85d.txt",
        "img": "https://archive.orkl.eu/3e6443795674b4374f7a1ff9408fe36ddc58c85d.jpg"
    }
}