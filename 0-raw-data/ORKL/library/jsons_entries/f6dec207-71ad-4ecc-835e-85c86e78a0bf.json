{
    "id": "f6dec207-71ad-4ecc-835e-85c86e78a0bf",
    "created_at": "2022-10-25T16:48:24.281184Z",
    "updated_at": "2025-03-27T02:05:54.078674Z",
    "deleted_at": null,
    "sha1_hash": "e3a7c8074629b1dbf0f8e9d666b2ffb541c08be6",
    "title": "Microsoft Word - FLASH TLP WHITE CVE Zoho Desktop Servers v1.4 Updated template",
    "authors": "",
    "file_creation_date": "2021-12-20T08:04:15Z",
    "file_modification_date": "2021-12-20T08:04:15Z",
    "file_size": 1501460,
    "plain_text": "## 17 DEC 2021 The following information is being provided by the FBI, with no guarantees or warranties, for potential\n\n_use at the sole discretion of recipients to protect against cyber threats. This data is provided in order_\n_to help cyber security professionals and system administrators to guard against the persistent malicious_\n\nFLASH Number\n\n_actions of cyber actors. This FLASH was coordinated with DHS/CISA._\n\n#### AC-000159-MW This FLASH has been released TLP:WHITE\n\n\n**WE NEED YOUR HELP!** If you identify any suspicious activity within your enterprise or have related information,\n\nplease contact FBI CyWatch immediately with respect to the procedures outlined in the Reporting Notice\n\nsection of this message.\n\n*Note: By reporting any related information to FBI CyWatch, you are assisting in sharing information that allows the FBI to track\n_malicious actors and coordinate with private industry and the United States Government to prevent future intrusions and attacks._\n\n# APT Actors Exploiting Newly-Identified Zero Day in ManageEngine Desktop Central \n\n## Summary\nSince at least late October 2021, APT actors have been actively exploiting a zero-day, now\nidentified as CVE-2021-44515, on ManageEngine Desktop Central servers. The APT actors were\nobserved compromising Desktop Central servers, dropping a webshell that overrides a\nlegitimate function of Desktop Central, downloading post-exploitation tools, enumerating\ndomain users and groups, conducting network reconnaissance, attempting lateral movement\nand dumping credentials.\n\nCVE-2021-44515, which Zoho rated critical, addresses an authentication bypass vulnerability in\nManageEngine Desktop Central software that can allow an adversary to bypass authentication\nand execute arbitrary code on Desktop Central servers.\n\nZoho released a ManageEngine Desktop Central Security Advisory for the newly identified\nvulnerability CVE-2021-44515 on December 3, 2021:\nhttps://www.manageengine.com/products/desktop-central/cve-2021-44515-authenticationbypass-filter-configuration.html\n\n\n-----\n\nZoho also provided the following vulnerable build numbers for ManageEngine Desktop Central\ncustomers:\n\n_For Enterprise Customers:_\n\nFor builds 10.1.2127.17 and below, upgrade to 10.1.2127.18\n\nFor builds 10.1.2128.0 to 10.1.2137.2, upgrade to 10.1.2137.3\n\n_For MSP Customers:_\n\nFor builds 10.1.2127.17 and below, upgrade to 10.1.2127.18\n\nFor builds 10.1.2128.0 to 10.1.2137.2, upgrade to 10.1.2137.3\n\n## Technical Details\n\nInitial exploitation of a Desktop Central API URL allowed for an unauthenticated file upload of\ntwo different variants of webshells observed in this campaign with the filenames emsaler.zip\n(variant 1, late October 2021), eco-inflect.jar (variant 1, mid November 2021) and aaa.zip\n(variant 2, late November 2021).\n\nThe webshell overrides the legitimate Desktop Central API servlet endpoint,\n\n/fos/statuscheck, and filters inbound GET (webshell variant 2) or POST requests (webshell\nvariant 1) to that URL path and executes commands as the SYSTEM user with elevated\nprivileges if the inbound requests pass the filter check.\n\nInitial reconnaissance and domain enumeration was conducted through the webshell. After\ninitial reconnaissance, the actors use BITSAdmin to download a likely ShadowPad variant\ndropper with filename mscoree.dll, and a legitimate Microsoft AppLaunch binary, iop.exe. The\ndropper is sideloaded through AppLaunch execution, which creates a persistent service to\nexecute the AppLaunch binary moving forward. Upon execution, the dropper creates an\ninstance of svchost and injects code with RAT-like functionality that initiates a connection to a\ncommand and control server.\n\nFollow-on intrusion activity is then conducted through the RAT, including attempted lateral\nmovement to domain controllers and credential dumping techniques using Mimikatz,\ncomsvcs.dll LSASS process memory dumping, and a WDigest downgrade attack with subsequent\nLSASS dumping through pwdump.\n\nThe malicious samples were downloaded from likely compromised ManageEngine\nADSelfService Plus servers.\n\n## Indicators\n\n\n-----\n\n##### Log File Analysis \n\n1. Search access log files located at\n```\n%DesktopCentralInstallRoot%\\logs\\access_logs\\access* for: \n\n##### a. POST requests to the following URL(s):\n       i. /STATE_ID/123/agentLogUploader\n\n b. GET or POST requests to the following URL(s):\n       i. /fos/statuscheck\n\n```\n2. Search serverout log files located at\n```\n   %DesktopCentralInstallRoot%\\logs\\serverout\\* for log\n\n##### lines matching a format similar to the following:\n a. [<time>]|[<date>]|[com.adventnet.sym.webclien\n      t.statusu\n      pdate.AgentLogUploadServlet]|[WARNING]|[<num>\n      ]|[<guid>]: absolute Dir ..\\ds      logs\\1\\../../\\lib |\n\n b. [<time>]|[<date>]|[com.adventnet.sym.webclien\n      t.statusu\n      pdate.AgentLogUploadServlet]|[WARNING]|[<num>\n      ]|[<guid>]: absolute File Name aaa.zip |\n\n```\n`i.` Also replace aaa.zip with emsaler.zip, eco```\n         inflect.jar or remove it altogether to expand the\n\n##### search.\n\n```\n_NOTE: The /fos/statuscheck API URL is a legitimate Desktop Central function,_\n_but based on analysis appears to be rarely used, and only expects communications_\n_from other internal Desktop Central servers. Any requests between late October_\n_2021 and early December 2021, or those originating from external IP addresses,_\n_should be considered suspicious and investigated._\n\n##### Hashes \n```\nfebf7f32fed44a4a58a2e0ea402ea181a0e1a519ea41fab1d4ccfb097c8e538c\n44937538ff3a4316d60f672b7cddc9ba02cea2b991e25fafdb8b947622c8fe03\ne4297e74a59e1e9b125a0b7c0a0f34b1a22010086b302f88d25a5ce18b1b70d4\na9b6ef095e16373d914937377bebe78fa9ca319741a3c516c18171073336269e\nf6223d956df81dcb6135c6ce00ee14d0efede9fb399b56d2ee95b7b0538fe12c\n4fbc93dd537ca67c3aa0e9082dc5189f81968b26a0cc69f07424b47f27d52049\naaa77fffdb9f23ce13da059779cdb8df785e9f321bb2044be22213774e1af817\n\n```\n\n-----\n\n```\n4aeefe0140d7ea0a7e90f1027957ad4f3ae171116e2a255bdcb2a16b74209249\nede143975a065c04baa7df73a991a59aa090ae0c49f9d0b920fa263086b5f676\n1b80c6bf098be080c8275fe7d7234f2d34f50ed403541b9b60490ab2b704d4dd\n18ebe6045bedc9ed7cff6e6aae4326b97699eb5bc71f8a514b9e13857edb6a9f\n\n##### Services \n\n```\nName: MicrosoftFrameworkLaunchUtility\n\nExecutable Path: C:\\ProgramData\\MicroSoft\n```\nFramework\\Microsoft.Framework.AppLaunch.exe\n\n```\nRAT Path: C:\\ProgramData\\MicroSoft Framework\\mscoree.dll\n\n##### Processes\n```\nsvchost.exe running MicrosoftFrameworkLaunchUtility\n\n Domains\nns2.latincop[.]com\n\n Filepaths \n\\ManageEngine\\DesktopCentral_Server\\lib\\aaa.zip\n\\ManageEngine\\DesktopCentral_Server\\lib\\emsaler.zip\n\\ManageEngine\\DesktopCentral_Server\\lib\\eco-inflect.jar\nC:\\windows\\ime\\ssp.dll\nC:\\windows\\ime\\iop.exe\nC:\\windows\\ime\\mscoree.dll\nC:\\ProgramData\\MicroSoft\nFramework\\Microsoft.Framework.AppLaunch.exe\nC:\\ProgramData\\MicroSoft Framework\\mscoree.dll\n\n```\n\n-----\n\n## Tactics, Techniques, and Procedures \n\n  - DLL sideloading\n\n  - Executing “live off the land” tools, e.g. bitsadmin\n\n  - Network scanning, e.g. nbtscan, nb.exe\n\n  - Powershell for command execution\n\n  - Persistence through Windows Service\n\n  - Downloading staged post-exploitation tools from other victim infrastructure\n\n  - Credential dumping, e.g. Mimikatz, comsvcs.dll, WDigest downgrade and\n\n\npwdump\n\n\n## Yara Rules \n```\nimport \"pe\"\nrule mscoree_RAT_loader_func {\n  strings:\n    $s1 = { FF 15 ?? AF 00 00 80 B8 04 41 00 00 48} //\nGetModuleHandleA initial load\n    $s2 = { 33 C9 BA A3 4F 01 00 } // size allocation: 85923\nbytes, could vary\n    $s3 = { 41 B8 00 10 00 00 44 8D 49 40 } // 0x40 RWX\nallocation\n    $s4 = { FF 15 17 AF 00 00 }\n  condition:\n    (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) ==\n0x00004550) and filesize < 350KB and 3 of them\n}\nrule mscoree_RAT {\n  condition:\n    (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) ==\n0x00004550)\n    and filesize < 350KB\n    and pe.dll_name == \"MSCOREE.dll\"\n    and pe.exports(\"IEE\")\n    and pe.imports(\"kernel32.dll\", \"VirtualAlloc\") and\npe.imports(\"kernel32.dll\", \"IsDebuggerPresent\")\n\n```\n\n-----\n\n```\n}\nrule StatusCheck_backdoor_zip {\n  strings:\n    $s1 = \"com/zoho/clustering/agent/api/StatusCheck.class\"\n    $s2 = \"META-INF/MANIFEST.MF\"\n  condition:\n    uint32(0) == 0x04034B50 and filesize < 15KB and all of\nthem\n}\nrule aaa_fos_statuscheck_class {\n  strings:\n    $s1 = \"decodeBase64\"\n    $s2 = \"APIKEYS\" fullword\n    $s3 = \"slaveId\"\n    $s4 = \"processRequest\"\n    $s5 =\n\"com/zoho/clustering/agent/remotemonitor/MonitorPool\"\n    $s6 = \"destnAbsoluteFileName\"\n    $s7 = \"Fail\" fullword\n    $s8 = \"lognames\" fullword\n    $s9 = \"receivedFileSize\"\n    $s10 = \"<TITLE>ManageEngine Desktop Central</TITLE>\"\n  condition:\n    uint32(0) == 0xbebafeca and filesize < 15KB and 7 of\nthem\n}\nrule APT_backdoor_class {\n  strings:\n    $s1 = \"cmd.exe /c\"\n    $s2 = \"Authorization-Expires\"\n    $s3 = \"encrypt\"\n    $s4 = \"encodeBase64\"\n    $s5 = \"prepareDownload\"\n    $s6 = \"application/octet-stream;charset=UTF-8\"\n    $s7 = \"getUploadedFile\"\n    $s8 = \"Agent64Com\"\n    $s9 = \"cmd_flag\"\n  condition:\n\n```\n\n-----\n\n```\n    uint32(0) == 0xbebafeca and filesize < 15KB and 6 of\nthem\n}\nrule APT_backdoor_RC4_class {\n  strings:\n    $s1 = \"com/zoho/clustering/agent/api/RC4\"\n    $s2 = \"StackMapTable\"\n    $s3 = \"RC4.java\"\n    $s4 = \"in_offset\"\n    $s5 = \"out_offset\"\n    $s6 = \"encrypt\"\n  condition:\n    uint32(0) == 0xbebafeca and filesize < 5KB and 5 of them\n} \n\n## Information Requested:\n\n```\nPlease report to FBI the existence of any of the following:\n\n   - Identification of indicators of compromise (IOCs) as outlined above\n\n   - Presence of webshell code on compromised Desktop Central servers\n\n   - Unauthorized access to or use of accounts\n\n   - Evidence of lateral movement by malicious actors with access to compromised\n\nsystems\n\n   - Malicious IPs identified through conducted log file searches and session activity\n\n   - Malicious samples identified through IOCs\n\n   - Other indicators of unauthorized access or compromise\n\nRecipients of this information are encouraged to contribute any additional information that\nthey may have related to this threat.\n\n## Recommended Mitigations:\n\nOrganizations that identify any activity related to these IOCs within their networks should take\naction immediately.\n\nZoho released a ManageEngine Desktop Central Security Advisory for the newly identified\nvulnerability CVE-2021-44515 on December 3, 2021:\n\n\n-----\n\nhttps://www.manageengine.com/products/desktop-central/cve-2021-44515-authenticationbypass-filter-configuration.html\n\nZoho also provided the following vulnerable build numbers for ManageEngine Desktop Central\ncustomers:\n\n_For Enterprise Customers:_\n\nFor builds 10.1.2127.17 and below, upgrade to 10.1.2127.18\n\nFor builds 10.1.2128.0 to 10.1.2137.2, upgrade to 10.1.2137.3\n\n_For MSP Customers:_\n\nFor builds 10.1.2127.17 and below, upgrade to 10.1.2127.18 For builds 10.1.2128.0 to\n10.1.2137.2, upgrade to 10.1.2137.3\n\n## Reporting Notice\n\nThe FBI encourages recipients of this document to report information concerning suspicious or\n\ncriminal activity to their local FBI field office. With regards to specific information that appears\n\nin this communication; the context, individual indicators, particularly those of a non\ndeterministic or ephemeral nature (such as filenames or IP addresses), may not be indicative of\n\na compromise. Indicators should always be evaluated in light of your complete information\n\nsecurity situation.\n\nField office contacts can be identified at www.fbi.gov/contact-us/field-offices. When available,\n\neach report submitted should include the date, time, location, type of activity, number of\n\npeople, type of equipment used for the activity, the name of the submitting company or\n\norganization, and a designated point of contact.\n\n\n-----\n\n### Your Feedback Regarding this Product is Critical\n\n#### Was this product of value to your organization? Was the content clear and concise?  Your comments are very important to us and can be submitted anonymously. Please take a moment to complete the survey at the link below. Feedback should be specific to your experience with our written products to enable the FBI to make quick and continuous improvements to such products. Feedback may be submitted online here:\n\n## https://www.ic3.gov/PIFSurvey\n\n#### Please note that this survey is for feedback on content and value only. Reporting of technical information regarding FLASH reports must be submitted through FBI CYWATCH.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.ic3.gov/Media/News/2021/211220.pdf"
    ],
    "report_names": [
        "211220.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1639987455,
    "ts_modification_date": 1639987455,
    "files": {
        "pdf": "https://archive.orkl.eu/e3a7c8074629b1dbf0f8e9d666b2ffb541c08be6.pdf",
        "text": "https://archive.orkl.eu/e3a7c8074629b1dbf0f8e9d666b2ffb541c08be6.txt",
        "img": "https://archive.orkl.eu/e3a7c8074629b1dbf0f8e9d666b2ffb541c08be6.jpg"
    }
}