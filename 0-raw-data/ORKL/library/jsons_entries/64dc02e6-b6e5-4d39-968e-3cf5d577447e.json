{
    "id": "64dc02e6-b6e5-4d39-968e-3cf5d577447e",
    "created_at": "2023-01-12T15:01:25.139381Z",
    "updated_at": "2025-03-27T02:09:18.702891Z",
    "deleted_at": null,
    "sha1_hash": "0ae5fe08f77741b3b9402d268db86839fbc049ce",
    "title": "2021-02-16 - Conti ransomware- Evasive by nature",
    "authors": "",
    "file_creation_date": "2022-05-27T21:51:34Z",
    "file_modification_date": "2022-05-27T21:51:34Z",
    "file_size": 1203608,
    "plain_text": "# Conti ransomware: Evasive by nature\n\n**[news.sophos.com/en-us/2021/02/16/conti-ransomware-evasive-by-nature/](https://news.sophos.com/en-us/2021/02/16/conti-ransomware-evasive-by-nature/)**\n\nFebruary 16, 2021\n\n_Editor’s note: This is one of a series of articles focused on the Conti ransomware family,_\n_[which include a detailed analysis of a Conti attack, A Conti Ransomware Attack Day-By-Day,](https://news.sophos.com/en-us/2021/02/16/conti-ransomware-attack-day-by-day/)_\n_[and a guide for what IT administrators can expect when Conti ransomware hits.](https://news.sophos.com/en-us/2021/02/16/what-to-expect-when-youve-been-hit-with-conti-ransomware)_\n\nFor the past several months, both SophosLabs and the Sophos Rapid Response team have\nbeen collaborating on detection and behavioral analysis of a ransomware that emerged last\nyear and has undergone rapid growth. The ransomware, which calls itself Conti, is delivered\nat the end of a series of Cobalt Strike/meterpreter payloads that use reflective DLL injection\ntechniques to push the malware directly into memory.\n\nBecause the reflective loaders deliver the ransomware payload into memory, never writing\nthe ransomware binary to the infected computer’s file system, the attackers eliminate a\ncritical Achilles’ heel that affects most other ransomware families: There is no artifact of the\nransomware left behind for even a diligent malware analyst to discover and study.\n\nThat isn’t to say there aren’t artifacts and components to look at. The threat actors involved\nin attacks using Conti have built a complex set of custom tooling designed not only to\nobfuscate the malware itself, when it gets delivered, but conceal the internet locations from\nwhich the attackers have been downloading it during attacks, and prevent researchers from\nobtaining a copy of the malware that way as well.\n\n## Two-stage loading process\n\n\n-----\n\nThe first stage of the Conti ransomware process involves a Cobalt Strike DLL, roughly 200kb\nin size, that allocates the memory space needed to decrypt and load meterpreter shellcode\ninto system memory.\n\nA portion\n\nof meterpreter shellcode, extracted from memory on an infected machine.\nThe shellcode, XORed in the DLL, unfurls itself into the reserved memory space, then\ncontacts a command-and-control server to retrieve the next stage of the attack.\n\nThis C2 communication is distinctive for a number of reasons. First, the malware appears to\nbe using a sample Cobalt Strike configuration script named trevor.profile, published on a\npublic Github archive. The profile serves as a sort of homage to an incident in which security\n[researchers attending a conference found an insect in a milkshake at a restaurant outside](https://www.csoonline.com/article/3227910/hackers-create-memorial-for-a-cockroach-named-trevor.html)\nthe conference center.\n\nAn excerpt from the sample Cobalt Strike configuration script\nBut it doesn’t appear that the Conti attackers have modified this sample script very much,\nwhich makes the C2 communication notable in two ways: The script designates certain\ncharacteristics used during this phase of the attack, including a User-Agent string\n(“Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko)“) that mimics\nthat of a computer running Windows 7 but, distinctively, fails to identify the specific browser;\nand a static URI path (“/us/ky/louisville/312-s-fourth-st.html“) that includes the address of\nthe infamous restaurant where the researcher discovered the bug in their shake.\n\n\n-----\n\nThe sample Cobalt Strike configuration uses a URI path that includes “Menus” (with a capital\nM) to indicate that the infected machine is running a 64-bit operating system, and to deliver\nthe appropriate payload for that architecture.\nThe initial connection to the C2 server is to a page named Menus.aspx on the server; That\npage delivers the next payload, which the first one loads into memory — another Cobalt\nStrike shellcode loader that contains the reflective DLL loader instructions.\n\nIf that works successfully, the malware then contacts the “312-s-fourth-st.html” page on the\nsame C2 server. The attackers only trigger these chains of events during an active attack,\nplacing the ransomware binary on the C2 server so that it can be retrieved by this process\nonly while the attack is ongoing, and removing it immediately afterwards.\n\n## Elusive ransomware payloads\n\nBecause of the ephemeral nature of the placement of the ransomware payload, analysts had\ndifficulty obtaining samples for research. But we were able to salvage some of the in-memory\ncode from infected computers where the malware was still running.\n\nThe ransomware process is not particularly unique, but it does reveal the ransomware\ncreator’s ongoing interest in thwarting analysis by security researchers.\n\n\n-----\n\nThe ransomware itself uses a relatively common anti-analysis technique sometimes referred\n[to as “API-by-hash,” in which Conti uses hash values to call specific API functions; Conti has](http://sandsprite.com/blogs/index.php/index.php?uid=7&pid=52)\nan added layer of encryption over the top of these hashes to futher complicate the work of a\nreverse engineer. The malware has to perform two cycles of decryption on itself in order to\nperform those functions.\n\nAmong the behavior observed by responders, the ransomware immediately begins a process\nof encrypting files while, at the same time, sequentially attempting to connect to other\ncomputers on the same network subnet, in order to spread to nearby machines, using the\nSMB port.\n\nSMB scanning by Conti during the infection\nConti’s developers have hardcoded the RSA public key the ransomware uses to perform its\nmalicious encryption into the ransomware (files are encrypted using the AES-256 algorithm).\nThis isn’t unusual; It means that it can begin encrypting files even if the malware is unable to\ncontact its C2.\n\nUnfortunately, that isn’t the only threat this ransomware poses to its targets: Conti\nransomware has also adopted a “leaks” site like several other ransomware threat actor\ngroups. The attackers spend some time on the target network and exfiltrate sensitive,\nproprietary information to the cloud (in recent attacks, the threat actors have used the cloud\nstorage provider Mega).\n\n\n-----\n\nUnder a header labeled YOU SHOULD BE AWARE!, the ransom note threatens, “Just in\ncase, if you try to ignore us. We’ve downloaded a pack of your internal data and are ready to\npublish it on out (sic) news website if you do not respond. So it will be better for both sides if\nyou contact us as soon as possible.”\n\n## Detection guidance\n\nConti ransomware, on its own, is unable to bypass the CryptoGuard feature of Sophos\nIntercept X; Our endpoint products may detect components of Conti under one or more of\nthe following definitions: HPmal/Conti-B, Mem/Conti-B, Troj/Swrort-EZ, Troj/Ransom**GEM, or Mem/Meter-D. Network protection products like the Sophos XG firewall can also**\nblock the malicious C2 addresses to prevent the malware from retrieving its payloads and\ncompleting the infection process.\n\nIndicators of compromise for malware samples examined in this research has been posted to\nthe SophosLabs Github.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-16 - Conti ransomware- Evasive by nature.pdf"
    ],
    "report_names": [
        "2021-02-16 - Conti ransomware- Evasive by nature.pdf"
    ],
    "threat_actors": [
        {
            "id": "f276b8a6-73c9-494a-8ab2-13e2f1da4c53",
            "created_at": "2022-10-25T16:07:24.441133Z",
            "updated_at": "2025-03-27T02:02:10.231958Z",
            "deleted_at": null,
            "main_name": "Achilles",
            "aliases": [],
            "source_name": "ETDA:Achilles",
            "tools": [
                "RDP",
                "Remote Desktop Protocol"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535685,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653688294,
    "ts_modification_date": 1653688294,
    "files": {
        "pdf": "https://archive.orkl.eu/0ae5fe08f77741b3b9402d268db86839fbc049ce.pdf",
        "text": "https://archive.orkl.eu/0ae5fe08f77741b3b9402d268db86839fbc049ce.txt",
        "img": "https://archive.orkl.eu/0ae5fe08f77741b3b9402d268db86839fbc049ce.jpg"
    }
}