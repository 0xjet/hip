{
    "id": "c26513e4-38f5-4db5-ba23-e33b322d9e9d",
    "created_at": "2023-04-05T02:10:19.858653Z",
    "updated_at": "2025-03-27T02:09:18.049937Z",
    "deleted_at": null,
    "sha1_hash": "f5f510446aefaf51e9033acdf072d1f8e9750d3e",
    "title": "2023-02-15 - Paradise Ransomware Distributed Through AweSun Vulnerability Exploitation",
    "authors": "",
    "file_creation_date": "2023-04-03T08:31:13Z",
    "file_modification_date": "2023-04-03T08:31:13Z",
    "file_size": 2572597,
    "plain_text": "# Paradise Ransomware Distributed Through AweSun Vulnerability Exploitation\n\n**asec.ahnlab.com/en/47590/**\n\nBy Sanseo February 15, 2023\n\nThe ASEC analysis team has recently discovered the distribution of Paradise ransomware.\nThe threat actors are suspected to be utilizing a vulnerability exploitation of the Chinese\nremote control program AweSun. In the past, the team also found and covered the\ndistribution of Sliver C2 and BYOVD through a Sunlogin vulnerability, a remote control\nprogram developed in China.\n\n[Sliver Malware With BYOVD Distributed Through Sunlogin Vulnerability Exploitations](https://asec.ahnlab.com/en/47088/)\n\n## 1. AweSun Vulnerability Exploitation\n\nThe installation of Sliver C2 through the AweSun remote control program developed by\nAweRay was also discovered to have been carried out by threat actors while the team was\n[monitoring Sliver C2 attack cases. [1]](https://sun.aweray.com/en/)\n\n\n-----\n\nFigure 1. Remote control program AweSun\n\nFigure 2. Sliver C2 installed by PowerShell that was generated by AweSun\nDetailed information about the AweSun vulnerability exploitation has yet to be confirmed.\nHowever, considering that this is the same threat actor that exploited the Sunlogin\nvulnerability and the fact that Sliver C2 was installed by a PowerShell that was generated by\na child process of AweSun, we can speculate that this attack was also a vulnerability\nexploitation. Compared to the latest version of AweSun.exe which now exceeds v2.0, the\nAweSun used for the attacks were v1.5 and v1.6, versions that were released several years\nago.\n\nAdditionally, we can confirm through the command used in the attack that the attack\ncommand includes a ping that’s similar to the PoC used in the Sunlogin vulnerability.\nAlthough it is currently impossible to download anything from this address, we can infer from\nthe URL format that it is a command that installs Cobalt Strike.\n\n\n-----\n\nFigure 3. Command used to exploit AweSun vulnerability\nIt appears that the threat attacker is using the AweSun vulnerability exploitation at the same\ntime as the Sunlogin vulnerability exploitation. The Sliver and BYOVD malware mentioned\nabove have been found in both vulnerability exploitation cases along with a XMRig\nCoinMiner.\n\nThis post will focus on the Paradise attack case since it was the most recent case of this\nvulnerability exploitation. The following is AhnLab’s ASD (AhnLab Smart Defense) log, which\nshows that the Paradise ransomware, “DP_Main.exe,” was installed by the cmd and\nPowerShell generated by AweSun.\n\nFigure 4. Paradise ransomware installation log\n\nParadise ransomware download URL:\nhxxps://upload.paradisenewgenshinimpact[.]top/DP_Main.exe\n\n## 2. Analysis of Paradise Ransomware\n\nParadise, which is installed through an AweSun vulnerability exploitation, was first\ndiscovered in 2017 as a RaaS (Ransomware as a Service) type ransomware developed in\n.NET. **[[2]](https://www.acronis.com/en-us/blog/posts/paradise-ransomware-strikes-again/)**\n\n\n-----\n\nFigure 5. The main function of Paradise ransomware\n\n**Overview** **Description**\n\nEncryption method RSA-1024 / RSA-1024\n\n\nPaths excluded from\nencryption\n\n\n“windows”, “firefox”, “chrome”, “google”, “opera”,\n“%APPDATA%\\DP\\” (installation paths)\n\n\nExtension [id-EaObwi8A].[main@paradisenewgenshinimpact.top].honkai\n\nRansom note DECRYPT MY FILES#.html\n\nOthers Registers RUN key. Deletes volume shadow service\n\nTable 1. Ransomware overview\n\n\n-----\n\nParadise utilizes various configuration files. After the completion of the encryption process,\nthe “%APPDATA%DP\\welldone.dp” file is generated. If the file already exists, the encryption\nstage is skipped and the ransom note is shown. Paradise will restart with admin privilege if it\nis executed without the authority as the ransomware uses it to encrypt the system; at this\nstage the “%APPDATA%DP\\RunAsAdmin.dp” file is used. PCID is the value that represents\nthe infected system and is saved in the “id.dp” file that is generated on the current path. The\nvalue is also used later for the ransom note and sending the infection information to the C&C\nserver.\n\n**Settings File** **Description**\n\n%APPDATA%DP\\welldone.dp Encryption behavior completion\nstatus\n\n%APPDATA%DP\\RunAsAdmin.dp Admin privilege execution status\n\nCurrent Path\\id.dp PCID\n\n\n%USERPROFILE%\\documents\\DecryptionInfo.auth\n\n%PROGRAMFILES%\\DP\\DecryptionInfo.auth\n\n\nRSA private key (encrypted through\na master RSA public key),\n\nRSA public key\n\n\nTable 2. Settings file\nParadise generates a 1024-bit RSA key and uses it to encrypt files. The ransomware\nencrypts the RSA private key necessary for file decryption by using the threat actor’s master\nRSA public key that’s saved in the settings data.\n\nFigure 6. Settings file where the master RSA public key is saved\nAmong the settings files, “DecryptionInfo.auth” has a RSA private key that has been\nencrypted by the generated RSA public key and the threat actor’s master RSA public key.\n\n\n-----\n\nFigure 7. DecryptionInfo.auth file\nThe paths excluded from encryption are based on folder paths, so “windows”, “firefox”,\n“chrome”, “google”, “opera” and “%APPDATA%\\DP\\.”. This means that all paths are targeted\nexcluding the settings paths. A distinct characteristic of Paradise is the fact that it sets the\n“mysql,” “firebird,” “mssql,” “microsoft sql,” and “backup” paths as high priority encryption\ntargets.\n\nFigure 8. Encrypted files\nFurthermore, this ransomware can create a copy of itself in %APPDATA%DP\\DP_Main.exe\nand register it to the run key or delete the volume shadow service using the following\ncommand.\n\n“cmd.exe” /C sc delete VSS\n\n\n-----\n\nAfter the encryption process is finished, Paradise transfers basic information like the PCID\nand computer name along with information such as the number of encrypted files and the\ntime it took to finish encryption to the C&C server.\n\n**Item** **Description**\n\nv vector (hard-coded)\n\nfc Number of encrypted files\n\ncomputer_name Computer name\n\net Time taken for encryption\n\ndecryption_info RSA private key (encrypted through a master RSA public key)\n\nid PCID\n\nTable 3. Data delivered to C&C server\n\nFigure 9. Data delivered to C&C server\nUltimately, it executes a ransom note to notify the user that they have been infected by a\nransomware. The note includes an email address and Bitcoin wallet address as means of\ncontact.\n\nBitcoin wallet address: 392vKrpVxMF7Ld55TXyXpJ1FUE8dgKhFiv\nThreat actor’s email address: main@paradisenewgenshinimpact.top\n\n\n-----\n\nFigure 10. Ransom note – 1\n\n\n-----\n\nFigure 11. Ransom note – 2\n\n## 3. Conclusion\n\nWe have found recent cases where various ransomware, including Paradise, were installed\non vulnerable software that did not have recent patches applied. Therefore, users must\nupdate their installed software to the latest version to preemptively prevent vulnerability\nexploitations. Also, V3 should be updated to the latest version so that malware infection can\nbe prevented.\n\n**File Detection**\n\n– Trojan/Win.Agent.C4590824 (2021.08.15.00)\n\n**Behavior Detection**\n\n– Execution/MDP.Powershell.M1185\n\n– Execution/MDP.Powershell.M2514\n\n– Persistence/MDP.AutoRun.M224\n\n– Ransom/MDP.Decoy.M1171\n\n\n-----\n\n**IOC**\n**MD5**\n\n– 5cbbc1adfd22f852a37a791a2415c92c\n\n**Download URL**\n\n– hxxps://upload.paradisenewgenshinimpact[.]top/DP_Main.exe\n\n**C&C**\n\n– hxxp://upload.paradisenewgenshinimpact[.]top:2095/api/Encrypted.php\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information-en/)\n\n[Tagged as:AweSun,Paradise,Paradise Ransomware,Ransomware,Vulnerability](https://asec.ahnlab.com/en/tag/awesun-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-15 - Paradise Ransomware Distributed Through AweSun Vulnerability Exploitation.pdf"
    ],
    "report_names": [
        "2023-02-15 - Paradise Ransomware Distributed Through AweSun Vulnerability Exploitation.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1680660619,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1680510673,
    "ts_modification_date": 1680510673,
    "files": {
        "pdf": "https://archive.orkl.eu/f5f510446aefaf51e9033acdf072d1f8e9750d3e.pdf",
        "text": "https://archive.orkl.eu/f5f510446aefaf51e9033acdf072d1f8e9750d3e.txt",
        "img": "https://archive.orkl.eu/f5f510446aefaf51e9033acdf072d1f8e9750d3e.jpg"
    }
}