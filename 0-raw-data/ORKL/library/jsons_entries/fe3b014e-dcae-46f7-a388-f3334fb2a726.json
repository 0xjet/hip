{
    "id": "fe3b014e-dcae-46f7-a388-f3334fb2a726",
    "created_at": "2022-10-25T16:48:24.466918Z",
    "updated_at": "2025-03-27T02:16:28.738197Z",
    "deleted_at": null,
    "sha1_hash": "cc77d1604a80c26bfb1846a84a27dea99278242b",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-03-13T16:21:48Z",
    "file_modification_date": "2018-03-13T16:21:54Z",
    "file_size": 1900054,
    "plain_text": "# OceanLotus\n\n## Old techniques,\n new backdoor\n\n### ESET\n\nMarch 2018\n\n\n-----\n\n# OceanLotus\n\n## Old techniques,\n new backdoor\n\n### ESET\n\nMarch 2018\n\n\n-----\n\n##### TABLE OF CONTENT\n\n**OceanLotus: old techniques, new backdoor** **5**\n\nDistribution 5\n\nDouble extension and fake icon applications (Word, PDF, etc) 5\n\nFake installers 5\n\nTechnical analysis 6\n\nExecution flow overview 6\n\nA quick word on control flow obfuscation 7\n\nThe Dropper 9\n\nBackdoor component: rastlsc.exe side-loading 11\n\nCommunication 15\n\nCommands 17\n\n**Conclusion** **18**\n\nIoCs 19\n\nSamples 19\n\nNetwork 19\n\n\n-----\n\n##### LIST OF FIGURES\n\nFigure 1 Dropper execution flow 6\n\nFigure 2 Backdoor execution flow 6\n\nFigure 3 Complementary conditional jump 7\n\nFigure 4 PUSH/JMP technique 8\n\nFigure 5 Control flow obfuscation 9\n\nFigure 6 RobototFontUpdate icon 9\n\nFigure 7 Symantec rastlsc.exe digital signature 11\n\nFigure 8 All rasltls.dll exports lead to the same function 12\n\nFigure 9 Generated shellcode 13\n\nFigure 10 Configuration structure 14\n\nFigure 11 System fingerprint 17\n\n##### LIST OF TABLES\n\nTable 1. Initial Dropper 19\n\nTable 2. Sideloaded libraries 19\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\n##### OCEANLOTUS: OLD TECHNIQUES, NEW BACKDOOR\n\nThe OceanLotus group, also known as APT32 and APT-C-00, is infamous for its campaigns targeting\nthe eastern part of Asia. A great deal of research about this group was published last year, including\n[papers such as those from CyberReason, a lengthy global view from FireEye and the watering-hole](https://www.cybereason.com/labs-operation-cobalt-kitty-a-large-scale-apt-in-asia-carried-out-by-the-oceanlotus-group/)\n[explanation from Volexity. We see that this group keeps updating their backdoors, infrastructure,](https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/)\nand infection vectors.\n\nOceanLotus continues its activity particularly targeting company and government networks\nin East-Asian countries. A few months ago, we discovered and analyzed one of their latest backdoors.\nSeveral tricks are being used to convince the user to execute the backdoor, to slow down its analysis\nand to avoid detection. These techniques will be discussed in detail in this blog post.\n\n###### Distribution\n\n[Various methods are used to trick potential victims into running the malicious dropper.](http://virusradar.com/en/glossary/dropper-trojan)\nOur telemetry reveals that East-Asian countries such as Vietnam, the Philippines, Laos\nand Cambodia, are the most targeted.\n\n###### Double extension and fake icon applications (Word, PDF, etc)\n\nThe droppers are probably attached to an email message. Some file names we have seen include:\n\n- `Mi17 Technical issues - Phonesack Grp.exe. Mi-17 is a common Russian helicopter.`\n\n- `Chi tiet don khieu nai gui saigontel.exe, which translates from Vietnamese to`\n\n“Details of the complaint sent to Saigontel”. Saigontel is a telecommunication company in\nVietnam.\n\n- `Updated AF MOD contract - Jan 2018.exe`\n\n- `remove_pw_Reschedule of CISD Regular Meeting.exe`\n\n- `Sorchornor_with_PM_-_Sep_2017.exe`\n\n- `20170905-Evaluation Table.xls.exe`\n\n- `CV_LeHoangThing.doc.exe. Fake résumé (CV) documents were also seen in Canada.`\n\nAll these files have something in common: A decoy document is launched, but is password-protected.\nIt’s unclear whether this password is provided by any means, for example in the email it was attached\nto, or if the documents are simply not meant to work.\n\n###### Fake installers\n\nSeveral fake installers, claiming to be installers or updates for popular software were seen\nin watering hole campaigns. A good example of such an installer is the repackaged Firefox installer\n[described by 360 Labs on Freebuf (Chinese language).](http://www.freebuf.com/articles/others-articles/153666.html)\n\nAnother sample we saw had the name RobototFontUpdate.exe. It was also likely to have been\ndistributed via compromised websites, but we do not yet have enough evidence to confirm this.\n\nAll the files described here, whether they were sent in an email or downloaded while visiting\na compromised site, deliver the same (functionally equivalent) backdoor component. For the purpose\nof this article we will dissect the RobototFontUpdate.exe sample and show how it manages\nto execute its malicious payload on a system.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\n###### Technical analysis\n\nThe whole process of installation and execution relies heavily on multiple layers of obfuscation\nsuch as decryption of payloads, PE reconstruction and loading shellcode, and side-loading techniques.\n[The last technique was previously described in a previous ESET research article about Korplug.](https://www.welivesecurity.com/2014/11/12/korplug-military-targeted-attacks-afghanistan-tajikistan/)\n\n###### Execution flow overview\n\nThe attack is split in two parts: the dropper and backdoor launcher. Each step of each part\nof the process will be explained in detail in its respective section. The following two diagrams briefly\nsummarize the general flow of execution of the malware.\n\nThe dropper part has the following flow of execution:\n\nC:\\Program Files\\Symantec\\Symantec Endpoint\n\n%temp% Protection\\12.1.671.4971.104a\\\n\nDeviceAssociationService\\\n\nDrops\n& **1** RobotoSlab.ttf\nexecutes\n\nSyLog.bin\n\nEraser\n\nDeletes **6** Drops **4**\n\nVirtualAlloc Fake rastls.dll\n\nExecutes **2** RtlMoveMemoryRtlZeroMemory Executes **3**\n\nRobototFontUpdate.exe SHELLCODE Drops and executes **5**\n\nReal\nDropper RasTlsc.exe\n\nFigure 1 Dropper execution flow\n\nThe backdoor part has the following execution flow:\n\nC&C domains\nEncoding charset\nVersion ID\n\nDecrypts Decrypts Decrypts Registry keys\n& & &\n\nLoads executes loads Executes RtlMoveMemoryVirtualAlloc loads\n\nRtlZeroMemory\nSHELLCODE\n\nRasTlsc.exe Fake rastls.dll SyLog.bin Launcher\n\nshellcode BACKDOOR Loads HTTPProv\n\nlibrary\n\nC&C\n\nFigure 2 Backdoor execution flow\n\n|Col1|C:\\Program Files\\Symantec\\Symantec Endpoint Protection\\12.1.671.4971.104a\\ DeviceAssociationService\\ SyLog.bin Drops4 Fake rastls.dll Drops and executes5 RasTlsc.exe|\n|---|---|\n|Real Dropper||\n\n|Col1|Loads|\n|---|---|\n|||\n\n\nBACKDOOR\n\n\nVirtualAlloc\nRtlMoveMemory\nRtlZeroMemory\nSHELLCODE\n\n\n**5**\n\n\nLauncher\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\n###### A quick word on control flow obfuscation\n\nAlmost all of these components are obfuscated. The obfuscation is based on pairs of complementary\nconditional jump instructions. Every form is used: JZ/JNZ, JP/JNP, JO/JNO, etc, each pair jumping\nto the same target. The sequence is interleaved with junk code, which makes use of the stack pointer,\nbut does not change the conditional flag’s value. This means it will always end up in the same branch.\nThis causes problems during decompilation due to the use of positive stack pointer values.\n\nFigure 3 Complementary conditional jump\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\nMoreover, some basic blocks push one address on the stack, then end with a JMP/CALL while other\nbasic blocks push two addresses then end with a RET instruction. The second push is the function\nto call and the first one is the address of the next basic block to jump to. This creates basic blocks\nwith no parents.\n\nFigure 4 PUSH/JMP technique\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\nThe resulting combination of these two obfuscation techniques creates “beautiful” graphs:\n\nFigure 5 Control flow obfuscation\n\nThe junk code is pretty easy to spot and once the scheme is known, it can be ignored when analysing\nthe samples.\n\n###### The Dropper\n\n Stage 1 The decoy document\n\nOver the past few months, a number of decoy documents have been used. One of them was a fake\nTrueType font updater for the Roboto Slab regular font. This choice of font seems a bit odd since\nit does not support a lot of East-Asian languages.\n\nFigure 6 RobototFontUpdate icon\n\nWhen executed, this binary decrypts its resource (XOR with a 128-byte, hardcoded key)\nand decompresses the decrypted data (LZMA). The legitimate RobotoSlab-Regular.ttf\n(SHA1:912895e6bb9e05af3a1e58a1da417e992a71a324) file is written into the %temp% folder\nand run via Win32 API function ShellExecute.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\nThe shellcode decrypted from the resource is executed. After its execution, the fake font updater\ndrops another application whose sole purpose is to delete the dropper. This “eraser” application\nis dropped as %temp%\\[0-9].tmp.exe.\n\n###### Stage 2 The shellcode\n\n**The shellcode used is the same for every stage that uses shellcode**\n\nThe shellcode is a custom PE loader. It recreates an executable in memory: it decrypts all the sections\nand computes the necessary relocations and other offsets. The shellcode retrieves three Windows\nAPI functions: VirtualAlloc, RtlMoveMemory and RtlZeroMemory.\n\nThe RtlZeroMemory function is heavily used to zero-out fields in the PE header. Relying\non automatic memory dumping will not work since the MZ/PE headers are broken.\n\nThe shellcode calls the entry-point function of the decrypted PE and then the DLLEntry\nexport function.\n\n###### Stage 3 Real Dropper, {103004A5-829C-418E-ACE9-A7615D30E125}.dll\n\nThis executable decrypts its resource using the AES algorithm with CBC mode via the Windows\nAPI. The size of the hardcoded key is 256 bits. After decryption, the data are decompressed (LZMA\nalgorithm).\n\nIf the process is running with administrator privileges, then the malware achieves persistence by\ncreating a service, else the classic Windows “Run” registry key is used (HKCU\\SOFTWARE\\Microsoft\\\n```\nWindows\\CurrentVersion\\Run;DeviceAssociationService;rastlsc.exe).\n\n```\nIf the dropper is executed with administrator privileges, then it tries to write the following files in\nthe C:\\Program Files\\Symantec\\Symantec Endpoint Protection\\12.1.671.4971.104a\\\n```\nDeviceAssociationService\\ folder else it writes them in the %APPDATA%\\Symantec\\Symantec\nEndpoint Protection\\12.1.671.4971.104a\\DeviceAssociationService\\ folder:\n\n```\n- `rastlsc.exe (SHA1:2616da1697f7c764ee7fb558887a6a3279861fac, copy of legitimate`\n\nSymantec Network Access Control application, dot1xtra.exe)\n\n- `SyLog.bin (SHA1:5689448b4b6260ec9c35f129df8b8f2622c66a45, encrypted backdoor)`\n\n- `rastls.dll (SHA1:82e579bd49d69845133c9aa8585f8bd26736437b,malicious DLL side-`\n\nloaded by rastlsc.exe)\n\nThe path changes from sample to sample but the pattern is similar. Depending on its privileges, the\nmalware drops the files in %ProgramFiles% or %appdata%. We’ve also seen:\n\n- `\\Symantec\\CNG Key Isolation\\`\n\n- `\\Symantec\\Connected User Experiences and Telemetry\\`\n\n- `\\Symantec\\DevQuery Background Discovery Broker Tasks\\`\n\nThese paths are used by various Symantec products.\n\nAfter achieving persistence and dropping the executable, the legitimate Symantec executable,\n```\nrastlsc.exe, is executed using CreateProcessW.\n\n```\nWe’ve also seen another version ({BB7BDEC9-B59D-492E-A4AF-4C7B1C9E646B}.dll),\nwhich executes rastlsc.exe with the parameter krv. Its meaning is discussed below.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\n###### Backdoor component: rastlsc.exe side-loading\n\nThe OceanLotus group uses an old and publicly known technique on one of the Symantec product’s\nexecutable files. The trick, here, is to take advantage of the library loading process of a legitimate\nand signed executable by writing a malicious library inside the same folder. This way it will make\nmalicious behaviors look legitimate because these actions are made by the trusted executable process.\n\nAs mentioned earlier, the legitimate executable rastlsc.exe is dropped and executed.\nThis executable imports the rastls.dll file, which in this case contains the malicious payload.\n\nFigure 7 Symantec rastlsc.exe digital signature\n\nSide loading was also observed using other legitimate, signed executables including mcoemcpy.exe\nfrom McAfee, which loads McUtil.dll. This technique has also been used by PlugX before. This also\n[got the attention of the Vietnam CERT (Vietnamese language).](http://ttcntt.com/Appcation/NotifyViewHome/bf811ad7-8232-4cb1-9e26-891e894bcfa1)\n\n###### Stage 1 Library side-loading, rastls.dll\n\nThe internal name of this dll is {7032F494-0562-4422-9C39-14230E095C52}.dll but we’ve seen\nother versions like {5248F13C-85F0-42DF-860D-1723EEAA4F90}.dll. All exported functions lead\nto the execution of the same function.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\nFigure 8 All rasltls.dll exports lead to the same function\n\nThis export tries to read the SyLog.bin file located inside the same folder. Other versions tried\nto open the file OUTLFLTR.DAT. If that file exists, it is decrypted using AES in CBC mode with\na hardcoded, 256-bit key and then decompressed (LZMA compression).\n\nThe McUtil.dll variant uses a different technique. At first glance, it looks as if like the main function\ndoes nothing malicious, but in fact it replaces the .text section of the legitimate mcoemcpy.exe,\na side-loaded binary. It generates shellcode whose purpose is to call the function reading the encrypted\nstage-two shellcode in the mcscentr.adf file.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\nThe following pseudocode is used to create the shellcode:\n```\n        x = False\n        i = 0\n        buff = genRandom()\n        opc1 = [0x58,0x59,0x5a,0x5b]\n        opc2 = [0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57]\n        opc3 = [0x90,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,\n\n            0x49,0x4a,0x4b]\n        while i < len(buff):\n            currentChar = buff[i]\n            if currentChar < 0xc8:\n                buff[i] = opc1[currentChar % len(opc1)]\n            else:\n                if x:\n                    buff[i] = opc2[currentChar % len(opc2)]\n                else:\n                    buff[i] = opc3[currentChar % len(opc3)]\n                x = x == False\n            i+=1\n\n```\nThe result is the following assembly listing:\n\nFigure 9 Generated shellcode\n\n###### Stage 2 to Stage 4 Shellcode, Launcher and Shellcode again\n\nThe shellcode decrypts and loads the library {E1E4CBED-5690-4749-819D-24FB660DF55F}.dll.\nThe library retrieves its resource and tries to start the service “DeviceAssociationService”.\nThe decrypted data also contains shellcode. The latter decrypts the final layer: the backdoor.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\nThe variant {92BA1818-0119-4F79-874E-E3BF79C355B8}.dll checks whether rastlsc.exe\nwas executed with krv as the first parameter. If so, then a job is created and rastlsc.exe\nis executed again, but without the parameter.\n\n###### Stage 5 The backdoor, {A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll\n\nThe malware first tries to retrieve its resource and decrypt it using RC4. The decrypted resource\ncontains an interesting piece of information, used to configure the backdoor. The format of this\nconfiguration is straightforward to reverse. Using Kaitai struct and its structure dumper,\nthe following representation can be displayed:\n\nFigure 10 Configuration structure\n\nNOTES: except for the string domain_encoding_str and the httpprov library, all these data\n_change from one sample to another. The registry keys are almost the same but they follow a similar pattern:_\n```\n\\HKCU\\SOFTWARE\\Classes\\AppX[a-f0-9]{32}, which is quite generic.\n\n```\nThe malware retrieves the first 10 bytes of the username (UTF-16), XORs it with the 3-letter\nUTF-16 mutex_encoding_str string, and encodes it in hex. The result is used as a mutex name.\nFor instance, for a user whose name starts with abc and the key being vwx, the following mutex\nwill be created: \\Sessions\\1\\BaseNamedObjects\\170015001b.\n\nThe backdoor includes a PE loader that loads the library HTTPProv.dll in memory, calls its entrypoint and then calls the export function named CreateInstance.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\n###### Communication\n\nThe backdoor uses a classic TCP communication protocol over port 25123. In order to retrieve\nthe server IP address, the backdoor first creates a particular DNS query.\n\nThe malware chooses between one of the three domains from the configuration and adds a custom\nsub-domain generated using two values. The first value is the computer name up to a length\nof 16 bytes. The second value is the 4-byte version ID. The following Python 2 code implements\nthe encoding algorithm :\n```\n        letters=domain_encoding_str # “ghijklmnop”\n        hex_pc_name=pc_name.encode(“UTF-16LE”).encode(“hex”)\n        s=’’\n        for c in hex_pc_name:\n        if 0x2f < ord(c) < 0x3a:\n            s+=letters[ord(c) - 0x30]\n        else:\n            s+=c\n\n```\nFor instance, if the computer name is random-pc and the version ID is 0x0a841523 then the following\ndomain could be created:\n```\nniggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.dwarduong[.]com\n\n```\nThe following regular expression could be used to flag a C&C server for this backdoor:\n```\n[ghijklmnopabcdef]{4-60}\\.[ghijklmnopabcdef]{8}\\.[a-z]+\\.[a-z]+\n\n```\nIf an IP address is resolved for this particular domain, then the malware tries to establish a\nconnection on TCP port 25123. Each sample has three different domain names it can use to find its\nC&C server.\n\nAll communication is encrypted using RC4 and compressed with LZMA. It is possible to decrypt the\ntraffic because the key is prepended to the packets. The format is:\n```\n[RC4 key (4 bytes)][encrypted data]\n\n```\nEach byte of the key is generated using the rand function. Once the packet is decrypted and\ndecompressed, the data follow the format:\n```\n[dw:unknown][dw:unknown][dw:command number][dw:size of data][dw:unknown]\n[dw:data]\n\n```\nThe first time the client connects to the server, a UUID is returned and used as a session\nID. The latter is stored in the registry key as binary data: HKCU\\SOFTWARE\\Classes\\\n```\nAppXc52346ec40fb4061ad96be0e6cb7d16a\\DefaultIcon\n\n```\nAs mentioned earlier, the backdoor also contains a library called HTTPprov. This library is an\nalternative way, as a backup, to communicate with the server as a backup. This DLL sends a POST\nrequest over the HTTP protocol to communicate. It also supports HTTPS and the usage of a SOCKS5,\nSOCKS4a or SOCKS4 proxy. The library is statically linked with libcurl.\n\nOnce its initialization is done, the following registry key is created to instruct the backdoor\nto use HTTP in future communication with the C&C server: HKCU\\SOFTWARE\\Classes\\\n```\nCLSID{E3517E26-8E93-458D-A6DF-8030BC80528B}.\n\n```\nA generic user agent is used: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0;\n```\nTrident/4.0).\n\n```\n\n-----\n\n###### Old techniques, new backdoor\n\n\nThe most distinctive characteristic of this library is the custom URI encoding algorithm. The resource\npart of the URI is created using the following pseudocode:\n```\n        buffEnd = ((DWORD)genRand(4) % 20) + 10 + buff;\n        while (buff < buffEnd){\n            b=genRand(16);\n            if (b[0] - 0x50 > 0x50)\n                t=0;\n            else\n               *buf++= UPPER(vowels[b[1] % 5]);\n            v=consonants[b[1]%21]);\n            if (!t)\n                v=UPPER(v);\n           *buff++= v;\n            if (v!=’h’ && b[2] - 0x50 < 0x50)\n               *buff++= ‘h’;\n           *buff++= vowels[b[4] % 5];\n            if (b[5] < 0x60)\n               *buff++= vowels[b[6] % 5];\n           *buff++= consonants[b[7] % 21];\n            if (b[8] < 0x50)\n               *buff++= vowels[b[9] % 5];\n           *buff++= ‘-’;\n        };\n        *buff=’\\0’;\n\n```\nNOTE: For clarity, the length-checking part has been removed from the snippet.\n\nFrom this generated string, two numbers are computed based on the custom checksum to obtain a URI:\n```\n        checksum=crc32(buff)\n        num2=(checksum >> 16) + (checksum & 0xffff) * 2\n        num1=(num2 ^ 1) & 0xf\n        URL=GENERATED_DOMAIN+ “/” + num1 + “/” + num2 + “-” + buff\n\n```\nBy adding the URI generator of the HTTPprov library, the following URL could be generated:\n```\nhXXp://niggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.aisicoin[.]com/\n\n13/139756-Ses-Ufali-L\n\n```\n\n-----\n\n###### Old techniques, new backdoor\n\n\n###### Commands\n\nAfter receiving its SESSIONID, the backdoor does a fingerprint of the system. The packet is built\nin this fashion:\n\n\nOffset in the\n\npacket\n\n\nDescription\n\n\n0x000 byte: value varies in each version\n\n0x001 0x01: hardcoded byte\n\n0x002 bool: is elevation token present\n\n0x003 dword: version ID\n\n0x007 string (UTF-16), computer name (0x20 bytes max)\n\n0x027 string (UTF-16), user name\n\n0x079 registry query result of the HKLM\\SOFTWARE\\Microsoft\\Windows NT\\\n```\n            CurrentVersion values:ProductName, CSDVersion, CurrentVersion,\n            ReleaseId, CurrentBuildNumber and the result of the call to\n            IsWow64Process (x86|x64)\n\n```\n0x179 Following format string “%s(%s);” replaced with\n(GetVolumeInformationW:VolumeNameBuffer),VolumePathNames\n\n0x279 PhysicalDrive deviceIOControl 0x2D1400 (IOCTL_STORAGE_QUERY_\nPROPERTY) (VolSerialNumber)\n\n0x379 wmi SELECT SerialNumber FROM Win32_BaseBoard\n\n0x3f9 GetSystemTimeAsFileTime\n\n0x400 bool: unknown\n\n0x401 dword: obtained from the decryption of the resource\n\nHere’s an example of a fingerprint of a system:\n\nFigure 11 System fingerprint\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\nThis is a full-featured backdoor that offers its operators many capabilities, such as file, registry\nand process manipulation, loading additional components, and performing a system fingerprint.\nHere’s the list of supported commands:\n\n\nCommand\n\nnumber\n\n\nDescription\n\n\n0 Fingerprint\n\n1 Sets the session ID\n\n2 Creates a process and gets the output (using pipes)\n\n3 Sets the connection retry counter\n\n4 Delays polling time\n\n5 Reads a file or registry key and computes the MD5\n\n6 Creates a process\n\n7 Creates a file, a registry entry or a stream in memory\n\n8 Writes to the registry\n\n9 Queries the registry\n\n10 Searches for files on the system\n\n11 Moves files to another directory\n\n12 Deletes files from the disk\n\n13 List the drives mapped on the system using the\n```\n    GetLogicalDriveStringW function\n\n```\n14 Creates directory\n\n15 Deletes directory\n\n16 Reads a file from an offset\n\n17 Calls the PE Loader (switch to HTTPprov communication)\n\n18 [Unknown]\n\n19 0: Query a value from the registry, 1:Drop and execute a\nprogram\n\n20 Sets an environment variable\n\n21 Runs shellcode in a new thread\n\n22 Retrieves an environment variable\n\n\n+23 in new\n\nversion\n\n##### CONCLUSION\n\n\nRestarts itself if the “APPL” environment variable doesn’t exist\n\n\nOnce again, OceanLotus shows that the team is active and continues to update its toolset.\nThis also demonstrates its intention to remain hidden by picking its targets, limiting the distribution\nof their malware and using several different servers to avoid attracting attention to a single domain\nor IP address. The encryption of the payload, together with the side-loading technique – despite\nits age – is a good way to stay under the radar, since the malicious activities look like they come\nfrom the legitimate application.\n\n\n-----\n\n###### Old techniques, new backdoor\n\n\n###### IoCs\n\n Samples\n\n\nTable 1. Initial Dropper\n\n\nSHA1-1 Filename ESET Detection Name\n\nWin32/TrojanDropper.\n```\nfdcb35cd9cb8dc1474cbcdf1c9bb03200dcf3f18 RobototFontUpdate.exe\n```\nAgent.RUI\n\nWin32/TrojanDropper.\n```\na40ee8ff313e59aa92d48592c494a4c3d81449af Firefox Installer.exe\n```\nAgent.RUI\n\n```\n                         20170905-Evaluation\nc2eb1033bc01ab0fd732a7ba4967be02c0690bf0\n                         Table.xls.exe\n\n```\n\nWin32/TrojanDropper.\nAgent.RUI\n\n\nWin32/TrojanDropper.\n```\nd35695f2366a43628231e73ffa83ca106306a8fa CV_LeHoangThing.doc.exe\n```\nAgent.RUI\n\n```\n                         Chi tiet don khieu nai\nfe0161fb8a26a0bf4afad746c7ebf89499dcd3a7\n                         gui saigontel.exe\n                         Mi17 Technical issues 032ef58b7978d079287874044dc516af624ae5f5\n                         Phonesack Grp.exe\n                         Sorchornor_with_PM_-_\n2a387d7d47a63d6e47d9cc92d3dc69a53816c2c0\n                         Sep_2017.exe\n                         Updated AF MOD contract 7105caa6d4fd8a2c67523d385277528e556ae4f6\n                         Jan 2018.exe\n                         remove_pw_Reschedule of\nf96bcd875836da89800912de1e557891697c7cf4\n                         CISD Regular Meeting.ex_\n\n```\n\nWin32/TrojanDropper.\nAgent.RUI\n\nWin32/TrojanDropper.\nAgent.RUI\n\nWin32/TrojanDropper.\nAgent.RUI\n\nWin32/TrojanDropper.\nAgent.RUI\n\nWin32/TrojanDropper.\nAgent.RUI\n\n\nTable 2. Sideloaded libraries\n\n\nSHA1-1 Filename ESET Detection Name\n\n`82e579bd49d69845133c9aa8585f8bd26736437b` `rastls.dll` Win32/Salgorea.BD\n\n`202fb56edb2fb542e05c845d62ffbdcfbebed9ec` `McUtil.dll` Win32/Korplug.MK\n\n###### Network\n\nIP addresses\n```\n46.183.220.81\n46.183.220.82\n46.183.222.82\n46.183.222.83\n46.183.222.84\n46.183.223.106\n46.183.223.107\n74.121.190.130\n74.121.190.150\n79.143.87.230\n\n```\n\n-----\n\n###### Old techniques, new backdoor\n\n```\n79.143.87.233\n84.38.132.226\n84.38.132.227\n149.56.180.243\n158.69.100.199\n164.132.45.67\n192.34.109.163\n192.34.109.173\n198.50.191.194\n198.50.191.195\n198.50.234.96\n198.50.234.111\n\n```\nDomain names\n```\nadineohler[.]com\naisicoin[.]com\nalicervois[.]com\nanessallie[.]com\nantenham[.]com\narinaurna[.]com\narkoimmerma[.]com\naulolloy[.]com\navidilleneu[.]com\navidsontre[.]com\naximilian[.]com\nbiasatts[.]com\nbraydenhateaub[.]com\ncarosseda[.]com\nchascloud[.]com\ndreyoddu[.]com\ndwarduong[.]com\neckenbaue[.]com\neighrimeau[.]com\nerrellawle[.]com\nerstin[.]com\nfrahreiner[.]com\nhieryells[.]com\nhristophe[.]com\nichardt[.]com\nicmannaws[.]com\niecopeland[.]com\nirkaimboeuf[.]com\njamedalue[.]com\njamyer[.]com\njeanessbinder[.]com\njeffreyue[.]com\nkeoucha[.]com\nlaudiaouc[.]com\nlbertussbau[.]com\nloridanase[.]com\nmarrmann[.]com\nmeroque[.]com\nmoureuxacv[.]com\n\n```\n\n-----\n\n###### Old techniques, new backdoor\n\n```\nmyolton[.]com\nnasahlaes[.]com\nntjeilliams[.]com\nomasicase[.]com\nonnaha[.]com\nonteagle[.]com\norinneamoure[.]com\norresto[.]com\norrislark[.]com\nrackerasr[.]com\nrcuselynac[.]com\nsanauer[.]com\nstopherau[.]com\ntefanie[.]com\ntefanortin[.]com\ntephens[.]com\ntraveroyce[.]com\ntsworthoa[.]com\nucaargo[.]com\nucairtz[.]com\nurnage[.]com\nvenionne[.]com\nvirginiaar[.]com\n\n###### Host-based\n\n```\nWindows registry keys\n```\nHKCU\\SOFTWARE\\Classes\\AppXc52346ec40fb4061ad96be0e6cb7d16a\\\nHKCU\\SOFTWARE\\Classes\\AppX3bbba44c6cae4d9695755183472171e2\\\nHKCU\\SOFTWARE\\Classes\\CLSID{E3517E26-8E93-458D-A6DF-8030BC80528B}\\\nHKCU\\SOFTWARE\\Intel\\Display\\igfxcui\\igfxtray\\;[NUMBER];[DWORD] (set by command #19)\n\n```\n_Last IoC update: 2018-02-22 18:30:46 Eastern Standard Time_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.03.13.OceanLotus_Old_techniques_new_backdoor/ESET_OceanLotus.pdf",
        "https://www.welivesecurity.com/wp-content/uploads/2018/03/ESET_OceanLotus.pdf"
    ],
    "report_names": [
        "ESET_OceanLotus",
        "ESET_OceanLotus.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1520958108,
    "ts_modification_date": 1520958114,
    "files": {
        "pdf": "https://archive.orkl.eu/cc77d1604a80c26bfb1846a84a27dea99278242b.pdf",
        "text": "https://archive.orkl.eu/cc77d1604a80c26bfb1846a84a27dea99278242b.txt",
        "img": "https://archive.orkl.eu/cc77d1604a80c26bfb1846a84a27dea99278242b.jpg"
    }
}