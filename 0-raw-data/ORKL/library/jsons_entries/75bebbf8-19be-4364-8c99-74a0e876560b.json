{
    "id": "75bebbf8-19be-4364-8c99-74a0e876560b",
    "created_at": "2023-01-12T15:05:35.695133Z",
    "updated_at": "2025-03-27T02:05:50.249133Z",
    "deleted_at": null,
    "sha1_hash": "83ec3c21183c2a35b92278b1a5dd97f639e6a790",
    "title": "2021-09-27 - A guide to combatting human-operated ransomware- Part 2",
    "authors": "",
    "file_creation_date": "2022-05-27T23:12:32Z",
    "file_modification_date": "2022-05-27T23:12:32Z",
    "file_size": 271052,
    "plain_text": "# A guide to combatting human-operated ransomware: Part 2\n\n**[microsoft.com/security/blog/2021/09/27/a-guide-to-combatting-human-operated-ransomware-part-2/](https://www.microsoft.com/security/blog/2021/09/27/a-guide-to-combatting-human-operated-ransomware-part-2/)**\n\nSeptember 27, 2021\n\n_This blog is part two of a two-part series focused on how Microsoft DART helps customers_\n_with human-operated ransomware. For more guidance on human-operated ransomware and_\n_how to defend against these extortion-based attacks, refer to our human-operated_\n_ransomware docs page._\n\nIn [part one of this blog series, we described the process and execution used in our customer](https://www.microsoft.com/security/blog/2021/09/20/a-guide-to-combatting-human-operated-ransomware-part-1/)\nengagements to provide perspective on the unique issues and challenges regarding humanoperated ransomware. We also explained how Microsoft’s Detection and Response Team\n(DART) leverages Microsoft solutions to help combat this threat. In this post, we will tackle\nthe risks of human-operated ransomware and detail DART’s security recommendations for\ntactical containment actions and post-incident activities in the event of an attack.\n\n## Understanding the risks of human-operated ransomware\n\nBeyond the immediate threat of file encryption, there are several additional risks associated\nwith human-operated ransomware events, some of which may be observed well after an\ninvestigation and the removal of the threat from the network. These risks include:\n\n### 1. Disruption of business operations\n\nImmediate actions need to be taken to reduce the blast radius of a ransomware event. In\nthese cases, disabling portions of the network may feel like a self-inflicted denial of service,\nbut they are necessary to counter the ransomware spread. The resulting business disruption\n\n\n-----\n\nmay become public. If any affected systems are public-facing, it may require crisis\ncommunications.\n\n### 2. Data theft\n\nMost attackers are highly motivated to monetize their access to your network. In several\ncases investigated by DART, an attacker has performed reconnaissance for sensitive files\n(like contracts, financial documents, and internal communications), copied this data, and\nexfiltrated it before any ransomware was dropped. Taking this information before\nransomware is deployed allows the attacker to have data to sell, leak, or simply show as\nproof that the attacker has had access to sensitive files.\n\n### 3. Extortion\n\nData theft by ransomware operators opens an organization to extortion. It is not uncommon\nfor threat actors to demand payment to prevent the leak of stolen data. These threats are\ntypically sent via email with sample stolen documents attached as proof of possession. In\nsome cases where DART has observed this activity, a threat actor accessed a cloud-based\n[email account that was not protected by multifactor authentication (MFA) and sent](https://www.microsoft.com/en-us/security/business/identity-access-management/mfa-multi-factor-authentication/?&ef_id=Cj0KCQjwkIGKBhCxARIsAINMioKehnOAgRRbPeOcI9bORrUwgb7LkrGi142e1zwjuplDaiZWnLJSnm0aAnbQEALw_wcB:G:s&OCID=AID2200938_SEM_Cj0KCQjwkIGKBhCxARIsAINMioKehnOAgRRbPeOcI9bORrUwgb7LkrGi142e1zwjuplDaiZWnLJSnm0aAnbQEALw_wcB:G:s&gclid=Cj0KCQjwkIGKBhCxARIsAINMioKehnOAgRRbPeOcI9bORrUwgb7LkrGi142e1zwjuplDaiZWnLJSnm0aAnbQEALw_wcB)\nthreatening emails to the board of directors. The threat of extortion is still high, even when\nthe threat actors are unsuccessful at deploying ransomware.\n\nAt DART, we often get asked, “Can you tell us which data was stolen?” To prove this requires\nconcrete evidence, which would be either:\n\nA network capture that shows the actual data leaving the network (which rarely exists).\n\nOr\n\nFinding the data outside the organization’s network, typically on a public file-sharing\nsite. A log file showing ‘x’ bytes were transferred does not prove what data was stolen,\nand a command line history or event log showing a file archiving utility was run does\nnot prove that data was stolen.\n\n### 4. Follow-on attacks\n\nTo further their monetization efforts, attackers are also often observed deploying coin miners\nin compromised networks. This is a low-effort method to generate additional income from a\nvictim organization when data theft or extortion are insufficient for the attacker. Depending on\nthe attacker’s motivation, additional malware may be deployed that would allow other\ncriminals to gain access to the environment. This access is monetized, and the sale of\ncompromised network access is common in most human-operated ransomware cases,\nperformed after the primary attacker has obtained what they initially sought.\n\n### 5. Reputational damage\n\n\n-----\n\nThe risk of brand damage reputation is difficult to assess in the aftermath of a humanoperated ransomware event. The reputation of an organization’s brand may include lost\ncustomer and shareholder trust and loyalty, as well as current and future business. The risk\nof brand damage reputation is difficult to assess in the aftermath of a human-operated\nransomware event. Reputational damage may be more costly and require longer-term\nsolutions than the response to the human-operated ransomware event.\n\n### 6. Compliance and regulatory reporting\n\nPotential reporting requirements are another organizational risk depending on the industry or\naffiliation. This may include compliance or regulatory reporting in cases where sensitive\nfinancial information or personally identifiable information (PII) is stolen. Fines and loss of\naccreditation may further damage an organization’s reputation.\n\n## Recommendations and best practices\n\n### Containment\n\nContainment can only happen once we determine what needs to be contained. In the case of\nransomware, the adversary’s goal is to obtain credentials that allow administrative control\nover a highly available server and then deploy the ransomware. In some cases, the threat\nactor identifies sensitive data and exfiltrates it to a location they control.\n\nTactical recovery will be unique for each customer and tailored to the customer’s\nenvironment, industry, and level of IT expertise and experience. The steps outlined below are\nrecommended for short-term and tactical containment steps your organization can take. To\n[learn more about securing privileged access for long-term guidance, visit our securing](https://aka.ms/SPA)\nprivileged access docs page. For a comprehensive view of ransomware and extortion and\nhow to protect your organization, you can refer to our human-operated ransomware docs\npage.\n\n\n-----\n\n_Figure 1. Containment steps that can be done concurrently as new vectors are discovered._\n\nAfter the first step of containment (assessing the scope of the situation), the second step is\nto preserve existing systems:\n\n**Disable all privileged user accounts except for a few accounts used by your admins**\nto assist in resetting the integrity of your Active Directory infrastructure. If a user\naccount is believed to be compromised, disable it immediately.\n**Isolate compromised systems from the network, but do not shut them off.**\n**Isolate at least one known good domain controller in every domain—two is even**\n**better. Either disconnect them from the network or shut them down entirely. The object**\nhere is to stop the spread of ransomware to critical systems—identity being among the\nmost vulnerable. If all your domain controllers are virtual, ensure that the virtualization\nplatform’s system and data drives are backed to offline external media (not connected\nto the network) in case the virtualization platform itself is compromised.\nIsolate critical known good application servers (for example SAP, configuration\nmanagement database (CMDB), billing, and accounting systems).\n\nThese two steps can be done concurrently as new vectors are discovered. Disable those\nvectors and then try to find a known good system to isolate from the network.\n\nOther tactical containment actions can be accomplished:\n\n\n-----\n\n[Reset the krbtgt password, twice in rapid succession. Consider using a scripted,](https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/manage/ad-forest-recovery-resetting-the-krbtgt-password)\nrepeatable process. This script enables you to reset the krbtgt account password and\nrelated keys while minimizing the likelihood of Kerberos authentication issues being\ncaused by the operation. To minimize potential issues, the krbtgt lifetime can be\nreduced one or more times prior to the first password reset so that the two resets are\ndone relatively quickly. NOTE: All domain controllers that you plan to keep in your\nenvironment must be online.\nDeploy a Group Policy to the entire domain(s) that prevents privileged log on (Domain\nAdmins) to anything but Domain Controllers and privileged administrative-only\nworkstations (if any).\nInstall all missing security updates for operating systems and applications. Every\nmissing update is a potential threat vector that adversaries can quickly identify and\n[exploit. Microsoft Defender for Endpoint’s Threat and Vulnerability Management](https://www.microsoft.com/en-us/security/business/threat-protection/endpoint-defender)\nprovides an easy way to see exactly what is missing—as well as the potential impact of\nthe missing updates.\n\nFor Windows 10 (or higher) devices, confirm that the current version (or n-1) is\nrunning on every device.\n[Apply attack surface reduction (ASR) rules to prevent malware infection.](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction?view=o365-worldwide)\n[Enable all Windows 10 security features.](https://docs.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10)\nCheck that every external facing application, including VPN access, is protected by\nmultifactor authentication, preferably using an authentication application that is running\non a secured device.\nFor devices not using Defender for Endpoint as their primary antivirus software, run a\nfull scan with [Microsoft Safety Scanner on isolated “known good” systems before](https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/safety-scanner-download)\nreconnecting them to the network.\nFor any legacy operating systems, upgrade to a supported OS or decommission these\ndevices. If these options are not available, take every possible measure to isolate these\ndevices, including network/VLAN isolation, IPsec rules, and log on restrictions, so they\nare only accessible to the applications by the users/devices to provide business\ncontinuity.\n\nDART sometimes finds customers who are running mission critical systems on legacy\noperating systems (some as old as Windows NT 4) and applications, all on legacy hardware.\nThis is one of the riskiest configurations possible—not only are these operating systems and\napplications insecure, if that hardware fails, backups typically cannot be restored on modern\nhardware. Unless replacement legacy hardware is available, these applications will cease to\nfunction.\n\n## Post-incident activities\n\nDART recommends implementing the following security recommendations and best practices\nafter each incident.\n\n\n-----\n\n[Ensure that best practices are in place for email and collaboration solutions to make it](https://www.microsoft.com/en-us/security/business/threat-protection/office-365-defender)\nmore difficult for attackers to abuse them while allowing internal users to access\nexternal content easily and safely.\nFollow [Zero Trust security best practices for remote access solutions to internal](https://www.microsoft.com/en-us/security/business/zero-trust)\norganizational resources.\nStarting with critical impact administrators, follow best practices for account security\n[including using passwordless or MFA.](https://www.microsoft.com/security/blog/2021/09/15/the-passwordless-future-is-here-for-your-microsoft-account/)\nImplement a comprehensive strategy to reduce the risk of privileged access\ncompromise.\n\nFor cloud and forest/domain administrative access, see below for an overview of\nMicrosoft’s privileged access model (PAM).\nFor endpoint administrative management, see below for details on the local\nadministrative password solution (LAPS).\nImplement data protection to block ransomware techniques and to confirm rapid and\nreliable recovery from an attack.\nReview your critical systems. Check for protection and backups against deliberate\nattacker erasure/encryption. It’s important that these backups are periodically tested\nand validated.\nEnsure rapid detection and remediation of common attacks on endpoint, email, and\nidentity.\nActively discover and continuously improve the security posture of your environment.\nUpdate organizational processes to manage major ransomware events and streamline\noutsourcing to avoid friction.\n\n### Privileged access model (PAM)\n\nUsing the [privileged access model (formerly known as the tiered administration model)](https://docs.microsoft.com/en-us/security/compass/privileged-access-access-model)\nenhances Azure AD’s security posture. This involves:\n\nBreaking out administrative accounts in a “Planed” environment—one account for each\nlevel, usually four:\n\nControl Plane (formerly Tier 0): Administration of Domain Controllers and other\ncrucial identity services (like Active Directory Federation Service (ADFS) or Azure\nAD Connect). This also includes applications that require administrative\npermissions to Active Directory, such as Exchange Server.\nThe next two Planes were formerly Tier 1:\n\nManagement Plane: Asset management, monitoring, and security.\nData/Workload Plane: Applications and application servers.\nThe next two Planes were formerly Tier 2:\n\nUser Access: Access rights for users (such as accounts).\nApp Access: Access rights for applications.\n\n\n-----\n\nEach one of these Planes will have a separate administrative workstation for each\nPlane and will only have access to systems in that Plane. Other accounts from other\nPlanes will be denied access to workstations and servers in the other Planes through\nuser rights assignments set to those machines.\nThe net result of the PAM is that:\n\nA compromised user account will only have access to the Plane it is a part of.\nMore sensitive user accounts will not be logging into workstations and servers\nwith a lower Plane’s security level, thereby reducing lateral movement.\n\n### Local Administrative Password Solution (LAPS)\n\nBy default, Microsoft Windows and Active Directory have no centralized management of local\nadministrative accounts on workstations and member servers. This usually results in a\ncommon password that is given for all these local accounts, or at the very least in groups of\nmachines. This enables would-be attackers to compromise one local administrator account,\nand then use that account to gain access to other workstations or servers in the organization.\n\nMicrosoft’s [Local Administrator Password Solution (LAPS) mitigates this by using a Group](https://docs.microsoft.com/en-us/defender-for-identity/cas-isp-laps)\nPolicy client-side extension that changes the local administrative password at regular\nintervals on workstations and servers according to the policy set. Each of these passwords\nare different and stored as an attribute in the Active Directory computer object. This attribute\ncan be retrieved from a simple client application, depending on the permissions assigned to\nthat attribute.\n\nLAPS requires the Active Directory schema to be extended to allow for the additional\nattribute, the LAPS Group Policy templates to be installed, and a small client-side extension\nto be installed on every workstation and member server to provide the client-side\nfunctionality.\n\nDownload LAPS from the official [Microsoft Download Center.](https://www.microsoft.com/en-us/download/details.aspx?id=46899)\n\n## Harden your environment\n\nEach ransomware case is different and there is no one-size-fits-all approach. But there are\nthings you can do now to harden your environment and prepare for a worst-case scenario.\nAlthough, these changes may impact how your organization currently works, consider the\nrisk of not implementing them now versus dealing with a potential human-operated\nransomware event. An organization that has fallen victim to a ransomware attack should\nkeep the crucial human element in mind—real people are responding to the incident at the\nend of the day.\n\n## Learn more\n\n[Want to learn more about DART? Read our past blog posts.](https://www.microsoft.com/security/blog/microsoft-detection-and-response-team-dart-blog-series/)\n\n\n-----\n\n[To learn more about Microsoft Security solutions, visit our website. Bookmark the](https://www.microsoft.com/en-us/security/business/solutions) Security\nblog to keep up with our expert coverage on security matters. Also, follow us\nat [@MSFTSecurity for the latest news and updates on cybersecurity.](https://twitter.com/@MSFTSecurity)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-27 - A guide to combatting human-operated ransomware- Part 2.pdf"
    ],
    "report_names": [
        "2021-09-27 - A guide to combatting human-operated ransomware- Part 2.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535935,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1653693152,
    "ts_modification_date": 1653693152,
    "files": {
        "pdf": "https://archive.orkl.eu/83ec3c21183c2a35b92278b1a5dd97f639e6a790.pdf",
        "text": "https://archive.orkl.eu/83ec3c21183c2a35b92278b1a5dd97f639e6a790.txt",
        "img": "https://archive.orkl.eu/83ec3c21183c2a35b92278b1a5dd97f639e6a790.jpg"
    }
}