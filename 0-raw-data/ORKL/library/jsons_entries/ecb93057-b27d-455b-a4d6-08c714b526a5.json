{
    "id": "ecb93057-b27d-455b-a4d6-08c714b526a5",
    "created_at": "2022-10-25T16:48:20.030831Z",
    "updated_at": "2025-03-27T02:05:32.270535Z",
    "deleted_at": null,
    "sha1_hash": "f34ec411f0ce10f854e5a8c4ca90c9569217409b",
    "title": "Cisco Talos Blog: Rigging compromise - RIG Exploit Kit",
    "authors": "",
    "file_creation_date": "2016-01-25T20:49:50Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1106320,
    "plain_text": "**T** **H** **U** **R** **S** **D** **A** **Y** **,** **J** **A** **N** **U** **A** **R** **Y**\n\n# RIGGING COMPROMISE - RIG EXPLOIT KIT\n\n**_This post was authored by_** **_[Nick Biasini with contributions by Joel Esler.](http://blogs.cisco.com/author/NickBiasini)_**\n\n**Exploit Kits are one of the biggest threats that affects users, both inside and outside the**\n\n**enterprise, as it indiscriminately compromises simply by visiting a web site, delivering a**\n\n**malicious payload. One of the challenges with exploit kits is at any given time there are**\n\n**numerous kits active on the Internet. RIG is one of these exploit kits that is always around**\n\n**delivering malicious payloads to unsuspecting users. RIG first appeared in our telemetry�**\n\n**[back in November of 2013, back then we referred to it as](http://blog.talosintel.com/2013/11/im-calling-this-goon-exploit-kit-for-now.html)** **[Goon, today it's known as RIG.](http://blog.talosintel.com/2013/11/im-calling-this-goon-exploit-kit-for-now.html)**\n\n**We started focusing on RIG and found some interesting data similar to what we found**\n\n**[while analyzing Angler. This post will discuss RIG, findings in the data, and what actions�](http://www.talosintel.com/angler-exposed/)**\n\n**were taken as a result.**\n\n## THE EXPLOIT KIT OVERVIEW\n\n**RIG compromises users like any exploit kit. It starts with a user being redirected to a**\n\n**landing page. This is done via malicious iframes or malvertising and looks similar the**\n\n**following:**\n\n**It begins with an initial link to a javascript:**\n\n\n-----\n\n**This page is just a simple iframe that retrieves the actual landing page. The request for the**\n\n**landing page looks like:**\n\n**When the user is actually delivered a landing page, it is highly obfuscated and lacks some**\n\n**of the English based text we see in other exploit kits. Below is a small sample of the**\n\n**obfuscated landing page:**\n\n\n-----\n\n**After probing the browser RIG delivers an exploit to the end user. Below is an example of**\n\n**flash exploit that RIG was delivering:�**\n\n**One interesting aspect of RIG is the actual payload is obtained in a separate GET request.**\n\n**We usually see the exploit and payload delivered together or at least delivered in a highly**\n\n**obfuscated manner, not a GET request delivering an actual executable. This is not the**\n\n**case for RIG. Below is a sample of the GET request for the malicious payload:**\n\n\n-----\n\n**system. RIG tries to hide as legitimate services on Windows platforms. Common**\n\n**examples included defsrag.exe, dissdkchk.exe, systemrestore.exe. These are designed to**\n\n**look similar to defrag, diskchk, and the system restore functionality in Windows. However,**\n\n**in all cases these files were dropped in to TEMP folders instead of SYSTEM32 where they�**\n\n**would be expected to be located.**\n\n## THE DATA\n\n**RIG exploit kit is steadily compromising users, below is a sample of the data we gathered**\n\n**over two months related to systems serving RIG exploit kit. Users were being driven to**\n\n**RIG through malicious iframes and malvertising. The overall volume of activity was lower,**\n\n**affecting hundreds of users, instead of the thousands we saw impacted by Angler.**\n\n**DOMAIN ACTIVITY**\n\n**An analysis of the data associated with RIG revealed some familiar patterns. First was the**\n\n**use of domain shadowing. We found that domain shadowing is currently being used**\n\n**exclusively to host RIG, unlike with Angler, we were unable to find other domain activity�**\n\n**during the two month period. This particular use of domain shadowing has interesting**\n\n**aspects related to the subdomains themselves. RIG is using very short string based**\n\n**subdomains ranging from english based words like admin, user, news, and server. Also**\n\n\n-----\n\n**RIG over several months. The activity was spread evenly among those subdomains with**\n\n**few having more than 10 hits in the months of activity and the majority having less than**\n\n**five.�**\n\n**REFERERS**\n\n**RIG, like most exploit kits, is getting users infected via the use of malicious iframes**\n\n**injected in websites and malvertising. There were a couple of interesting things that we**\n\n**observed in the data. First is the use of Google and Bing in the redirection chain. We have**\n\n**seen this before in Nuclear exploit kit and this will provide an extra layer in the chain to**\n\n**help ensure users are getting to the landing pages. The second interesting fact dealt with**\n\n**the volume, there were more than 60 unique referers observed over the two month period**\n\n**but the average volume was low with most having less than five entries.�**\n\n**EXPLOITS**\n\n**During the two month period shown here we saw RIG using Flash to compromise**\n\n**systems. The primary exploit being used was CVE-2015-5119. We saw a total of 30**\n\n**unique hashes being used to compromise systems during the two month period. 70% of**\n\n**those hashes were known by VirusTotal and had some protection from an AV perspective.**\n\n**Despite that users were still being compromised and malicious payloads were being**\n\n**delivered.**\n\n**PAYLOADS**\n\n\n-----\n\n**g**\n\n**payload were variants of Tofsee which is a spam botnet. The way these payloads work is**\n\n**by sending large amounts of spam email related to various topics. Spambot payloads**\n\n**were very common to exploit kits several years ago, but most have moved on to payloads**\n\n**that guarantee quick monetization. The use of these payloads by RIG is an interesting**\n\n**differentiator from other exploit kits Talos has been observing.**\n\n**Most of the payloads we found had very good detection on VirusTotal with most being**\n\n**detected by more than half of the AV vendors. Again, despite this RIG continues to**\n\n**successfully compromise users that are primarily using versions of Internet Explorer on**\n\n**Windows platforms, based on the user agent information.**\n\n**IP Infrastructure**\n\n**This is the most interesting aspect of our RIG research. We observed 44 different IP**\n\n**addresses delivering some form of RIG. As shown above you can see that on most days**\n\n**there were only one or two IP's actively hosting RIG.**\n\n**When we resolved the IP's to the associated ASN we found something surprising. With the**\n\n**exception of a single IP address all IP's belonged to the same ASN (35415).**\n\n\n-----\n\n**This particular ASN is associated with Webzilla, a provider out of Russia. Further**\n\n**investigation actually revealed that all of the addresses were leased to Eurobyte, which is**\n\n**another Russian provider. Talos reached out to both providers giving them the information**\n\n**regarding the hosts that we observed serving RIG. Webzilla responded and identified the�**\n\n**customers that were generating the events and blocked the hosts successfully. Below is a**\n\n**graph showing the RIG activity we observed during our investigation:**\n\n\n-----\n\n**Monitoring the amount of RIG activity after our notification, we have consistently seen new�**\n\n**servers that are being hosted by Eurobyte being stood up and compromising users via**\n\n**RIG. We again reached out to Eurobyte to try and get a response directly from the**\n\n**provider where the malicious activity is being hosted. Despite multiple emails to Eurobyte**\n\n**RIG activity continued as new addresses get stood up after being reported to WebZilla.**\n\n**This underscores one of the major problems we face today, leaf providers. As providers**\n\n**could have multiple downstream leaf providers we find that we routinely have success in�**\n\n**dealing with larger providers. These providers help get systems shut down, but without the**\n\n**cooperation of the smaller downstream providers the adversaries just stand up new**\n\n**servers and move on. We were able to inflict some damage to RIG during our�**\n\n**investigation, but were unable to actually get the actors behind the activity stopped.**\n\n## RESPONSE\n\n**Since Eurobyte chose not to acknowledge or respond to our repeated messages we did a**\n\n**little further research on the activity associated with the provider. We worked with our**\n\n**research partners at OpenDNS Labs to get better visibility into the domains that were**\n\n**hosted. Based on our research we found a total of seven class C networks owned by the**\n\n**provider, with one of the class C's serving as their corporate network. Based on the**\n\n**information from OpenDNS provided we found approximately 25,000 domains being**\n\n**hosted on this address space. These domains were heavily leveraging the Russian TLD**\n\n**(.ru), as expected. Three of the class C networks were seen serving RIG during the**\n\n**period. We took the domains that OpenDNS provided and queried them against Talos’s**\n\n**automated web reputation. We found that of the six class C address spaces that are being**\n\n**used by Eurobyte five were scored significantly negatively in web reputation. The only�**\n\n**exception was one Class C network that was hosting the Russian payment platform e-**\n\n**autopay<dot>com.**\n\n**Based on all this information and Eurobytes failure to respond or even acknowledge abuse**\n\n**requests Talos and OpenDNS have decided to blacklist the five suspect subnets for a�**\n\n\n-----\n\n**address spaces to Cisco s IP and Domain intelligence blacklists. These blacklists are**\n\n**leveraged by multiple Cisco security products and will effectively protect our customers**\n\n**from any activity from this provider. This includes all technologies that consume our**\n\n**reputation services. The advantage of these blacklists, as well as our Advanced Malware**\n\n**Protection with our fantastic AMP line of products is, this detection adapts and changes in**\n\n**real time to the threat.**\n\n**Additionally, after reviewing the data provided by OpenDNS we worked with them to make**\n\n**sure that the threat was mitigated from their perspective as well. We found that the**\n\n**majority of the address space was already being blocked by OpenDNS, but we were able**\n\n**to round out the protection and make sure that Eurobyte won't be serving malicious**\n\n**content to both Cisco and OpenDNS customers. For additional information on how**\n\n**[OpenDNS has been tracking RIG please see the following blog  from the most recent talk](https://labs.opendns.com/2015/11/19/sprank-and-ip-space-monitoring/)**\n\n**[at Brucon.](https://www.youtube.com/watch?v=8edBgoHXnwg)**\n\n## DETECTION\n\n**Talos’s unparalleled visibility into threat data allows us to automatically adjust protection**\n\n**for our customers based upon real-world visibility into data. Convicting IPs, Domains,**\n\n**affecting the reputation of files in our AMP products, easily turning any of our data�**\n\n**collection systems against each other, each updating quickly to protect every single one of**\n\n**Cisco’s security customers against the threat in real-time, and continuously.**\n\n## IOC\n\n**IP INFORMATION**\n\n**46.30.42.0/24**\n\n**46.30.43.0/24**\n\n**46 30 44 0/24**\n\n\n-----\n\n**[DOMAIN INFORMATION (TEXT FILE)](http://blogs.cisco.com/wp-content/uploads/rig_domains_unique.txt)**\n\n## CONCLUSION\n\n**The exploit kit problem is larger than just Angler. However, the news related to exploit kits**\n\n**has been largely focused on Angler in 2015, now Angler seems to be on a temporary**\n\n**vacation since the end of 2015. This is expected with the sophistication, scope, and**\n\n**innovation that Angler incorporates. However, as evidenced by this research, it doesn't**\n\n**take innovation and sophistication to compromise users. RIG exploit kit is steadily and**\n\n**consistently compromising users and delivering malicious payloads. Visibility into the other**\n\n**exploit kits is valuable and necessary to help shed light on the behavior and identify the**\n\n**providers they are leveraging to help protect and educate the community.**\n\n**Additionally, this research shed light on the problem of leaf providers. Providers are in a**\n\n**tough spot with lots of systems and limited resources. That was one of the driving force**\n\n**behind** **[Project Aspis, to help aid providers by providing resources to help them identify](http://www.talosintel.com/aspis/)**\n\n**and mitigate these threats. It's understandable that malicious activity is going to occur at**\n\n**hosting providers. It's impossible for them to know the intentions of a customer when they**\n\n**are purchasing systems. At the same time when a provider is notified of malicious activity�**\n\n**it is their responsibility to at least acknowledge the abuse and work to validate and, if**\n\n**legitimate, take the system offline. Webzilla did just that in our experience, but Eurobyte�**\n\n**has not. This lack of response lead Talos to make the decision to blacklist large portions of**\n\n**the provider's network to ensure that our customers are protected since reporting the**\n\n**abuse alone is not enough.**\n\n## COVERAGE\n\n\n**[Advanced Malware Protection (AMP) is](http://www.cisco.com/c/en/us/support/security/amp-firepower-software-license/tsd-products-support-series-home.html)**\n\n**ideally suited to prevent the execution**\n\n**of the malware used by these threat**\n\n**actors.**\n\n**[CWS or](http://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)** **[WSA web scanning prevents](http://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)**\n\n**access to malicious websites and**\n\n**detects malware used in these attacks.**\n\n**[The Network Security protection of IPS](http://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html)**\n\n\n**and** **[NGFW have up-to-date signatures](http://www.cisco.com/c/en/us/products/security/asa-next-generation-firewall-services/index.html)**\n\n**to detect malicious network activity by threat actors.**\n\n\n-----\n\n**L** **A** **E** **B** **[X](http://blog.talosintel.com/search/label/exploit kit)** **E** **P** **L,** **M** **L** **[S](http://blog.talosintel.com/search/label/Malware)** **A** **O** **:** **,** **RL** **I** **,** **TWI** **T** **HGA** **RRK** **EEI** **AT** **T** **R** **E** **S**\n\n**S** **H** **A** **R** **E** **T** **H** **I** **S**\n\n**P** **O** **S** **T**\n\n**2 COMMENTS:**\n\n**[CONRAD LONGMORE JANUARY 9, 2016 AT 6:15 PM](https://www.blogger.com/profile/11751822299235747323)**\n\n**As it happens, I'm just running an analysis on sites hosted by Eurobyte LLC either**\n\n**currently on in the past, using a somewhat different data set. So far, out of 7500**\n\n**sites analysed, 35% are tagged by Google as being malicious. This probably**\n\n**means that many of the other 65% are also bad, but they just haven't been tagged.**\n\n**The Eurobyte LLC range is actually a bit bigger than you specify, they rent the**\n\n**entire 46.30.40.0/21 range from Webzilla. The /24s you are missing are:**\n\n**46.30.40.0/24**\n\n**46.30.41.0/24**\n\n**46.30.47.0/24**\n\n**Webzilla also provide services for the fairly notorious McHost.ru in the**\n\n**178.208.64.0/19 range.**\n\n\n**[Reply](javascript:;)**\n\n\n**[Replies](javascript:;)**\n\n**[NICK BIASINI JANUARY 11, 2016 AT 1:24 PM](https://www.blogger.com/profile/11420644688145888259)**\n\n**Thanks for the info Conrad. We chose not to block several of the ranges**\n\n**since they were either hosting legitimate activity or were the corporate**\n\n**address space for Eurobyte.**\n\n\n**Reply**\n\n\n-----\n\n**Comment as:** **[Select profile...]**\n\n\n\n**[Select profile...]**\n\n\n**PreviewPreview**\n\n\n**POST A COMMENT**\n\n**N** **E** **W** **E** **R**\n\n**P** **O** **S** **T**\n\n\n**PublishPublish**\n\n\n**H** **O** **M** **E**\n\n\n**O** **L**\n\n**P** **O**\n\n\n**S** **U** **B** **SP** **CO** **RS** **IT** **B** **EC** **O** **T** **M** **O** **M** **:** **E** **N** **T** **S**\n\n**S** **E** **A** **R** **C** **H** **T** **H** **E** **B** **L** **O** **G**\n\n**Search**\n\n**S** **U** **B** **S** **C** **R** **I** **B** **E** **T** **O** **O** **U** **R**\n\n**Posts**\n\n**Comments**\n\n**B** **L** **O** **G** **A** **R** **C** **H** **I** **V** **E**\n\n**[▼ 2](javascript:void(0))** **0(3)** **1** **6**\n\n**[▼ J](javascript:void(0))** **A** **(3)N** **U** **A** **R** **Y**\n\n**[Research Spotlight: Needles in a Haystack](http://blog.talosintel.com/2016/01/haystack.html)**\n\n**[Microsoft Patch Tuesday - January 2016](http://blog.talosintel.com/2016/01/ms-tuesday.html)**\n\n**Rigging compromise - RIG Exploit Kit**\n\n**[► 2](javascript:void(0))** **0(62)** **1** **5**\n\n**[► 2](javascript:void(0))** **0(67)** **1** **4**\n\n\n-----\n\n**[► 2](javascript:void(0))** **0(23)** **1** **1**\n\n**[► 2](javascript:void(0))** **0(94)** **1** **0**\n\n**[► 2](javascript:void(0))** **0(146)** **0** **9**\n\n**[► 2](javascript:void(0))** **0(41)** **0** **8**\n\n**R** **E** **C** **O** **M** **M** **E** **N** **D** **E** **D** **B** **L** **O** **G**\n\n**C** **I** **S** **C** **O** **B** **L** **O** **G**\n\n**[Cisco Partner Weekly Rewind – January 22, 2016](http://blogs.cisco.com/partner/cisco-partner-weekly-rewind-january-22-2016)**\n\n**S** **N** **O** **R** **T** **B** **L** **O** **G**\n\n**[Snort Subscriber Rule Set Update for 01/21/2016](http://feedproxy.google.com/~r/Snort/~3/yQE5HLUrqug/snort-subscriber-rule-set-update-for_21.html)**\n\n**C** **L** **A** **M** **A** **V** **®** **B** **L** **O** **G**\n\n**[ClamAV 0.99 Release is the largest ever!](http://feedproxy.google.com/~r/Clamav/~3/VYtOu9B9Dq8/clamav-099-release-is-largest-ever.html)**\n\n\n**[Software](http://talosintel.com/software)**\n\n**[Community](http://talosintel.com/community)**\n\n**[Vulnerability Reports](http://talosintel.com/vulnerability-reports)**\n\n**[Additional Resources](http://talosintel.com/additional-resources)**\n\n**[Microsoft to SID Mapping Archive](http://talosintel.com/ms-advisory-rules)**\n\n**[Shared Object Rule Generator](http://talosintel.com/so-rule-generator)**\n\n**[IP Blacklist Download](http://talosintel.com/feeds/ip-filter.blf)**\n\n**[AWBO Exercises](http://talosintel.com/awbo)**\n\n**[About Talos](http://talosintel.com/about)**\n\n**[Join Our Team](http://talosintel.com/careers)**\n\n**[Contact](http://talosintel.com/contact/)**\n\n**[Blog](http://blog.talosintel.com)**\n\n**CONNECT WITH US**\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.07.rigging-compromise/rigging-compromise.html.pdf"
    ],
    "report_names": [
        "rigging-compromise.html"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041132,
    "ts_creation_date": 1453754990,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/f34ec411f0ce10f854e5a8c4ca90c9569217409b.pdf",
        "text": "https://archive.orkl.eu/f34ec411f0ce10f854e5a8c4ca90c9569217409b.txt",
        "img": "https://archive.orkl.eu/f34ec411f0ce10f854e5a8c4ca90c9569217409b.jpg"
    }
}