{
    "id": "082c22b7-bf39-4613-acea-9d5eada47d66",
    "created_at": "2023-01-12T15:05:02.699349Z",
    "updated_at": "2025-03-27T02:05:43.23265Z",
    "deleted_at": null,
    "sha1_hash": "616cba26c556a86b6e0897b828a6f086688444a0",
    "title": "2021-02-19 - GitHub – Home to AsyncRAT Backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T03:29:31Z",
    "file_modification_date": "2022-05-28T03:29:31Z",
    "file_size": 1488837,
    "plain_text": "# GitHub – Home to AsyncRAT Backdoor\n\n**labs.k7computing.com/**\n\nBy K7 Labs February 19, 2021\n\nThese days threat actors are hosting their encrypted malware in user familiar places such\nas Google Drive, OneDrive, Discord CDN, Pastebin amongst others and target a huge\nvictim base. This abuse is not new for GitHub too, a popular code hosting platform. In\nthis blog, we will be getting into the nuances of AsyncRAT Backdoor hosted on the\nGitHub repository and its delivery mechanism, orchestrated in different stages.\n\nWhile monitoring the Twitter handles, we came across a tweet from @Glacius_\nmentioning about the availability of AsyncRAT payload on GitHub as depicted in Figure 1.\n\n\n-----\n\nFigure 1:\n\nTweet from @Glacius_ about AsyncRAT\nFrom Figure 2, we can notice that the above said attacker’s GitHub repository has multiple\nbinaries. Contents of all these binaries are encoded in decimal format to avoid being\nidentified and detected easily.\n\n\n-----\n\nFigure 2: GitHub repository where the malware binaries are present\nThis GitHub account was created on January 8, 2021 which is managed by Mohamed**Sayed with only 1 follower as shown in Figure 3. Also, we noticed that the attacker has**\nadded 2 new PE files on Jan 31st, 2021 in the “NEW” repository; possibly the threat actor\nis planning for another campaign. On digging deeper, we found that this attack has multistage payloads and finally executes the main payloads facebook.dll and stub.exe which\nwere not available in VirusTotal at the time of writing this blog.\n\n\n-----\n\nFigure 3: https://github.com/hbankers\nNow, let’s get into the details about the multi-stage scripts and the main payloads. The\ncomplete flow of this attack and the multi-stage scripts used to execute the final payload\nusing a process injector DLL has been depicted in Figure 4.\n\nFigure 4: Process Flow of this Malware\n\n\n-----\n\nThe initial binary fww.exe, a .NET file downloads the first stage payload **encoding.txt**\nfrom “hxxp[:]//f0509448[.]xsph[.]ru/hjebWnlfsjdlPz/encoding[.]txt” ( ip: 141.8.193.236\n**) and executes the encoding.txt, a VBScript using “mshta.exe” as depicted in Figure 5.**\n\nFigure 5: Initial binary which executes the VBScript\nDecoding the 1st stage VBScript, we could see that it uses Wscript.Shell command to\nexecute the PowerShell script using PowerShell.exe and download the second stage\npayload “all.txt” from the same URL and execute the downloaded file using Invoke**Expression** **(IEX) as depicted in Figure 6.**\n\nFigure 6: Use of VBScript to download second stage payload\nThe second stage payload all.txt; a PowerShell script, before proceeding further checks if\npredefined AV files are running in the system. For instance, “AVAST : AvastUI.exe”,\n**“ESET : ecmds.exe”, “KASPERSKY : avpui.exe”, “AVG : AVGUI.exe” as depicted in**\n\n\n-----\n\nFigure 7.\n\nFigure 7: Checks for Famous AVs existing in the system\nOnce it is confirmed that none of the specified AVs are present in the system, all.txt\ncontinues its execution. It sets Servicepointmanager as TLS 1.2 security protocol (3072\nrepresents TLS1.2 protocol) to communicate with its server through a secure channel and\ndownloads the third stage payload “ps1.txt” binary from the server. It converts the hex\nvalue to ascii character using “[char] [byte]” instruction and stores the string in\n**“asciiString” variable and executes it using Invoke-Expression as depicted in Figure 8.**\n\nFigure 8: PowerShell script is used to download ps1.txt\n\n\n-----\n\nRemoving all of the junk data from the PowerShell script, ps1.txt we can also see that it is\ndownloading the DLL\n**“hxxps[:]//raw[.]githubusercontent[.]com/hbankers/PE/main/PE03[.]txt” and the**\nHbanker exe file\n**“hxxps[:]//raw[.]githubusercontent[.]com/hbankers/v1/main/Server[.]txt” as strings**\nusing “downloadstring” function. Now, ps1.txt script executes\n**“Reflection.assembly::Load()” command**\n\nto load the “HAPPY” method from the DLL, PE03.txt and execute the binary Server.txt\n(stored in the argument HCrypt of HAPPY method)  as depicted in Figure 9 and Figure 10.\n\nFigure 9: 4th stage script after removing junks\n\nFigure 10: List of APIs for Process Injection\n\n\n-----\n\nAPIs **ResumeThread, Wow64SetThreadContext, SetThreadContext,**\n**Wow64GetThreadContext, GetthreadContext, VirtualAllocEx, WriteProcessMemory,**\n**ReadProcessMemory, ZwUnmapViewOfSection, CreateProcessA” are used to inject**\nthe AsyncRAT payload (server.txt) in the memory of another file and then execute the\nsame. This technique is called the ProcessHallowing – Injection Technique.\n\nAsyncRAT (Server.txt) carries multiple features like checking for Anti-analysing\ntechniques, network connection using SSL certificate, persistence techniques etc. The\nattacker pre-defines the domain name, port number, ssl certificate, version, mutex, key\netc., and its values are in a sophisticated base64 encoded format and to decode the string\nit uses aesCryptoServiceProvider in addition to base64 decoder to get the original value\nas depicted in Figure 11.\n\nFigure 11: Decoded string of pre-defined values\nThe domain which attacker tries to connect is “fat7e0recovery[.]ddns[.]net” via the port\nnumber 6666 as depicted in Figure 12. The Mutex value is “AsyncMutex_6SI8OkPnk”\nand it also has a server certificate “CN=AsyncRAT Server” valid from 17-01-2021 to 31**12-9999. This SSL certificate is used to encrypt the packets between the compromised**\nsystem and the server.\n\n\n-----\n\nFigure 12: Connecting the domain using the port specified\nIn order to detect virtual machines, AsyncRAT uses Anti-analysis techniques like\n\nChecks if the disk size is less than or equal to 50GB\nChecks whether the OS is XP\nLooks for the VM names like “Virtualbox”, “vm” or “Virtual” strings in system\nmanufacturing data\nChecks for SbieDll.dll in the system to detect sandboxie virtual machines\nUses CheckRemoteDebuggerPresent API to check for debugger as depicted in\nFigure 13.\n\nFigure 13: Anti\nanalysis Technique\nTo be persistent in the system, AsyncRAT confirms if the user login has admin privilege. If\nyes, it creates a scheduled task as depicted in Figure 14, where fileinfo.name represents\nthe currently running malware file.\n\n\n-----\n\nFigure 14: Creates scheduled task using cmd\nIf the AsyncRAT does not run with admin privilege, it creates a run entry under\n**CurrentUser\\Run for persistence. Run registry key is in reversed order and the**\nStrReversecommand is employed to retrieve the actual data\n**“Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run” as depicted in Figure 15.**\n\nFigure 15: Run registry key for persistence\n\n## Conclusion\n\nAttackers are not only very interested in creating new malware but also trying to use every\nsingle possibility to host/spread their payloads. In this case, AsyncRAT is spread using the\ncredibility of popular code hosting platforms to evade detection from Anti-Virus engines.\nWe are constantly monitoring such techniques and ensuring that we provide proactive\nprotection against such malware attacks. As always we recommend our customers to use\nthe K7 security products to protect your data and keep it updated to stay protected from\nthe latest threats.\n\n## Indicators Of Compromise (IOCs)\n\n\n-----\n\n**MD5** **File Name** **K7 Detection Name**\n\n527EE147DC7B2E5D768945DCC7D87326 fww.exe Trojan-Downloader\n(005771b51)\n\n4FAC2D80A7C3AEA83D61432F66A25B69 Facebook.dll Trojan (004cf1da1)\n\n416C48AEF6DDF720BE0D8B68DD2F0BD0 stub.exe Trojan (005678321)\n\n## URLs\n\nFat7e0recovery[.]ddns[.]net:6666\nhxxps[:]//raw[.]githubusercontent[.]com/hbankers/PE/main/PE03[.]txt\nhxxps[:]//raw[.]githubusercontent[.]com/hbankers/v1/main/Server[.]txt\nhxxp[:]//f0509448[.]xsph[.]ru/hjebWnlfsjdlPz/encoding[.]txt\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-19 - GitHub – Home to AsyncRAT Backdoor.pdf"
    ],
    "report_names": [
        "2021-02-19 - GitHub – Home to AsyncRAT Backdoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535902,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653708571,
    "ts_modification_date": 1653708571,
    "files": {
        "pdf": "https://archive.orkl.eu/616cba26c556a86b6e0897b828a6f086688444a0.pdf",
        "text": "https://archive.orkl.eu/616cba26c556a86b6e0897b828a6f086688444a0.txt",
        "img": "https://archive.orkl.eu/616cba26c556a86b6e0897b828a6f086688444a0.jpg"
    }
}