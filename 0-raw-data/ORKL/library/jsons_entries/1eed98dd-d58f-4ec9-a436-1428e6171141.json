{
    "id": "1eed98dd-d58f-4ec9-a436-1428e6171141",
    "created_at": "2023-01-12T14:59:11.827119Z",
    "updated_at": "2025-03-27T02:05:54.001614Z",
    "deleted_at": null,
    "sha1_hash": "e75195e46973806a47a349aa72e5589c0d3a800a",
    "title": "2022-04-19 - Stop Crypto Kleptos in Their Tracks",
    "authors": "",
    "file_creation_date": "2022-09-01T10:19:20Z",
    "file_modification_date": "2022-09-01T10:19:20Z",
    "file_size": 2184054,
    "plain_text": "# Stop Crypto Kleptos in Their Tracks\n\n**[domaintools.com/resources/blog/stop-crypto-kleptos-in-their-tracks](https://www.domaintools.com/resources/blog/stop-crypto-kleptos-in-their-tracks)**\n\n## A Brief History of a Targeted Attack\n\n\nApril 19, 2022\n\n\nUsing tools such as DomainTools Iris Detect, Iris Investigate, and DNSDB underscore the\nneed for cryptocurrency companies to engage with domain detection and passive DNS. Our\nrecent research illustrates that early detection of phishing campaigns and other malicious,\nbrand-threatening behavior are crucial as these organizations continue to gain in popularity.\n\nOn March 18, 2022, HubSpot suffered an attack in which a bad actor accessed dozens of\n[customer portals through an employee account. According to HubSpot this incident](https://www.hubspot.com/en-us/march-2022-security-incident)\nappeared to be a targeted harvesting attack on the contacts of cryptocurrency companies.\n[Those companies began issuing statements, including Blockfi,](https://twitter.com/BlockFi/status/1504982848771608586) [Pantera Capital,](https://decrypt.co/95586/hacker-steals-customer-data-circle-blockfi-big-crypto-firms) Swan\nBitcoin, and more.\n\n## Detection and Further Investigation Using Iris Detect and Farsight DNSDB\n\nDomainTools has always fostered a strong culture of security expertise and awareness which\ncontinued to grow with the acquisition of Farsight Security. This includes an active and\nthriving discussion channel on news from the information security world, along with a desire\n\n\n-----\n\nto effect positive change through what we do (such as our recent free threat-monitoring feed\nof newly-created Ukraine-related domains). Several of us immediately began talking about\nhow the March 18 Hubspot breach looked tailor-made to set a malicious actor up with targets\nfor cryptocurrency phishing campaigns. This has happened multiple times now, including\n[Pantera Capital’s HubSpot account being compromised for a fake token scam last year.](https://twitter.com/PanteraCapital/status/1362140521800622080)\n\n[DomainTools Iris Detect is an Internet infrastructure detection, monitoring, and enforcement](https://www.domaintools.com/products/iris-detect)\ntool (UI and API) built on the industry’s fastest and broadest domain discovery engine and\nthe largest databases of domain data. We chose to use Detect’s web browser UI in this case\nto show that everything involved in this kind of investigation can be accomplished in-browser,\nconstituting a major reduction in the technical barrier-to-entry for investigative tools of this\ncaliber. DomainTools Security Operations created a set of keyword monitors in Detect related\nto several of the affected companies.\n\n_A subset of domain monitors established after the HubSpot breach of March 18_\n\nA Detect search at the time showed a number of suspicious domains related to those\nkeywords — no surprise to anyone on the internet, especially anyone working in any\nfinancial capacity. Detect allowed us to choose domains in search results to monitor closely\nfor changes as well as to continue to see newly created domains appear as time went on.\nChanges tracked include hosting IP and company, registrar, nameservers, mailservers, and\nmore.\n\n\n-----\n\n_A subset of watchlisted domains under the blockfi monitor_\n\nFast-forward to April 3, 2022, when Trezor announced a MailChimp breach targeting\ncryptocurrency-related companies (having occurred on March 26). Coming so soon after the\nHubSpot breach, this new breach naturally piqued our interest. While malicious actors\ncontinue to be active across the Internet, they’re particularly active in the cryptocurrency\nspace. Why there? Well, as bank robber Willie Sutton once put it, “Because that’s where the\nmoney is.” The loose behavioral match to the March 18 breach appeared to perhaps not be\n“just a coincidence.”\n\nIn [one tweet Trezor mentioned several specific domains taken down as malicious, including](https://twitter.com/Trezor/status/1510558771944333312)\nxn--trzor-o51b[.]com. Sure, it looks garbled to human eyes – but this particular URL isn’t yet\nmeant for human eyes.\n\nYou see, the xn-- prefix in a URL is a technical mechanism that tells web browsers that that\n[domain name is an IDN, or Internationalized Domain Name. Since DNS doesn’t understand](https://en.wikipedia.org/wiki/Internationalized_domain_name#:~:text=An%20internationalized%20domain%20name%20(IDN,based%20characters%20with%20diacritics%20or)\nUnicode, domain names in other languages are represented in ASCII character form via\nPunycode, instead. While there are many benefits to this kind of a system, Farsight Security\nCo-founder and DNS expert Dr. Paul Vixie would nevertheless remind us, “Anything that can\nbe abused will be abused.” And so it is with IDN replacement. Bad actors often utilize\nPunycode (starting with that xn-- URL prefix) to create look-alike domains or to avoid\nkeyword filtering\n\nTake the above example, xn--trzor-o51b[.]com. What does that appear as in HTML-friendly\nemail or tweets?\n\nIt displays as trẹzor. Note the special unicode character that doesn’t quite look like an e (that\ntiny mark under what looks like an “e” is not just “dirt” on your screen – that’s actually part of\nthe letter!).\n\n\n-----\n\nThere are other ways to confuse recipients as well, including making the message visually\nbusy or architecting the message with more unicode so users miss the diacritical mark.\nClicking through, users expect they’re going to trezor[.]com and end up at xn--trzoro51b[.]com instead. It should be noted that malicious IDN replacement is not a new\ntechnique to fool users, and does not serve as a clear, solid indication on its own, as IDNs\nare used for legitimate domain internationalization.\n\nGiven this possible indicator we undertook a brief review of the previously-mentioned domain\nmonitors set up in Detect and looked for URLs with an xn-- prefix. Two were quickly found.\n```\nxn--blockf-1va[.]com\n\nxn--panteracaptal-5ib[.]com\n\n\n```\nWhat do these look like to humans when translated from punycode to unicode?\n```\nblockfì[.]com\n\npanteracapítal[.]com\n\n\n```\nNote the diacritical mark, a confusable IDN replacement in a cryptocurrency-related domain\nthat shows a high risk score in Detect.\n\nThis finding brought us back from the MailChimp breach to the March 18 HubSpot breach –\nboth Blockfi and Pantera Capital were impacted in the HubSpot breach. But did more\nconnections exist between these domains?\n\nFor that, we turn to passive DNS. DomainTools Iris cross-references multiple passive DNS\nsources, but we have direct access to Farsight Security’s DNSDB, the world’s largest DNS\nintelligence collection. By utilizing DNSDB Scout, we continue accessing powerful tools\nthrough a browser-based UI – an easy-to-use DNSDB interface that does not dilute the\npower of the tools involved.\n\n_[An example subset of results for an RRSet query of a suspicious punycode domain through](https://www.farsightsecurity.com/blog/txt-record/rrset-rdata-20150311/)_\n_DNSDB Scout_\n\n\n-----\n\nIn examining the three punycode addresses, an interesting trend emerges: after months or\nyears of inactivity, two of the URLs became active again and the third was newly created in\nthe last two weeks of March 2022.\n```\nxn--trzor-o51b[.]com - newly active as of 3/31/22\n\nxn--panteracaptal-5ib[.]com - newly active as of 3/28/22\n\nxn--blockf-1va[.]com - newly created as of 3/22/22\n\n\n```\nWe now have three URLs at least matching a behavioral template by exploiting punycode,\ntargeting the same industry (cryptocurrency), through similar mechanisms (insider/employee\naccess), chronologically close to but related to two separate breaches of contact data\n(HubSpot and MailChimp), created or retrofit within nine days of each other.\n\nOne company we know was targeted for customer phishing: Trezor. Through the data above\nit’s reasonable to infer that both Blockfi and Pantera Capital are undergoing or about to\nundergo phishing campaigns from the same actor. But it is important to note that is\n**indeed a behavioral inference, and not hard fact.**\n\nAs of April 11, 2022, quite a few more IDN replacement domains popped up targeting Trezor:\n```\nxn--treor-kib[.]biz\n\nxn--trezr-i91b[.]net\n\nxn--trer-sqa53f[.]com\n\nxn--trzr-cpa5d[.]net\n\nxn--trzor-csa[.]org\n\n\n```\nWhile multiple suspicious domains also emerged for Blockfi and Pantera Capital, no further\nxn– prefixed domains have been identified. And as noted above, Detect makes it simple to\ncontinue to monitor watchlisted domains in a holistic manner – seeing possible connections\nas well as differences between them.\n\n\n-----\n\n_A subset of watchlisted domains within a Trezor monitor in Iris Detect_\n\n## Recommendations\n\n\n-----\n\nGiven multiple recent breaches all targeting the cryptocurrency industry, cryptocurrencyrelated companies should immediately “step up their game.” Employ domain detection and\npassive DNS solutions to protect your brands and to detect suspicious domains and possible\nphishing campaign infrastructure before a campaign against your company begins in\nearnest.\n\nNewly created or newly-active IDN-replacement domains with high risk scores, among other\navailable indicators, can warn companies of imminent phishing or other imminent malicious\ncampaigns and allow them to preemptively request takedowns or perform other preventative\n[keyword monitoring, and regular expression and expandname features make complicated](https://www.farsightsecurity.com/news-events/press/DNSDB-2.0-GA-Press-Release-FINAL-20201020/)\nqueries easier.\n\nExpandname and regex also allow security partners or other researchers to more easily\nsearch passive DNS for pattern-matching results. These results need not be specific to a\nparticular brand or keyword in order to identify ongoing or upcoming malicious activity\ncampaigns. As another example of this, consider the domain-generating algorithm involved\nin SUNBURST and Farsight’s related report.\n\n[Download Now](https://info.farsightsecurity.com/sunburst-mapping-malicious-activity-using-passive-dns)\n© 2022 DomainTools\n\nDomainTools® and DomainTools™ are owned by DomainTools, all rights reserved.\n\nWe use cookies on our website to give you the most relevant experience by remembering\nyour preferences and repeat visits. By clicking “Accept All”, you consent to the use of ALL\nthe cookies. However, you may visit \"Cookie Settings\" to provide a controlled consent.\n\nCookie SettingsAccept All\n\n**Privacy Overview**\n\nThis website uses cookies to improve your experience while you navigate through the\nwebsite. Out of these, the cookies that are categorized as necessary are stored on your\nbrowser as they are essential for the working of basic functionalities of the website. We also\nuse third-party cookies that help us analyze and understand how you use this website.\nThese cookies will be stored in your browser only with your consent. You also have the\noption to opt-out of these cookies. But opting out of some of these cookies may affect your\nbrowsing experience.\n\nNecessary cookies are absolutely essential for the website to function properly. These\ncookies ensure basic functionalities and security features of the website, anonymously.\n\n**Cookie** **Duration** **Description**\n\n\n-----\n\n**Cookie** **Duration** **Description**\n\n\ncookielawinfocheckbox-analytics\n\ncookielawinfocheckbox-functional\n\ncookielawinfocheckbox-necessary\n\ncookielawinfocheckbox-others\n\ncookielawinfocheckboxperformance\n\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n11\nmonths\n\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Analytics\".\n\nThe cookie is set by GDPR cookie consent to record\nthe user consent for the cookies in the category\n\"Functional\".\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookies is used to store the user consent for the\ncookies in the category \"Necessary\".\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Other.\n\nThis cookie is set by GDPR Cookie Consent plugin.\nThe cookie is used to store the user consent for the\ncookies in the category \"Performance\".\n\nThe cookie is set by the GDPR Cookie Consent plugin\nand is used to store whether or not user has\nconsented to the use of cookies. It does not store any\npersonal data.\n\n\nviewed_cookie_policy 11\nmonths\n\n\nFunctional cookies help to perform certain functionalities like sharing the content of the\nwebsite on social media platforms, collect feedbacks, and other third-party features.\n\nPerformance cookies are used to understand and analyze the key performance indexes of\nthe website which helps in delivering a better user experience for the visitors.\n\nAnalytical cookies are used to understand how visitors interact with the website. These\ncookies help provide information on metrics the number of visitors, bounce rate, traffic\nsource, etc.\n\nAdvertisement cookies are used to provide visitors with relevant ads and marketing\ncampaigns. These cookies track visitors across websites and collect information to provide\ncustomized ads.\n\nOther uncategorized cookies are those that are being analyzed and have not been classified\ninto a category as yet.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-19 - Stop Crypto Kleptos in Their Tracks.pdf"
    ],
    "report_names": [
        "2022-04-19 - Stop Crypto Kleptos in Their Tracks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535551,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1662027560,
    "ts_modification_date": 1662027560,
    "files": {
        "pdf": "https://archive.orkl.eu/e75195e46973806a47a349aa72e5589c0d3a800a.pdf",
        "text": "https://archive.orkl.eu/e75195e46973806a47a349aa72e5589c0d3a800a.txt",
        "img": "https://archive.orkl.eu/e75195e46973806a47a349aa72e5589c0d3a800a.jpg"
    }
}