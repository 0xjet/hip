{
    "id": "bc32477c-cce8-4ae6-9178-b64598925cd5",
    "created_at": "2023-01-12T15:09:02.197919Z",
    "updated_at": "2025-03-27T02:16:25.973041Z",
    "deleted_at": null,
    "sha1_hash": "b104d29872c9fd9404b7cdcb8fd82963b4459ed5",
    "title": "2022-03-01 - TeaBot is now spreading across the globe",
    "authors": "",
    "file_creation_date": "2022-05-27T22:52:08Z",
    "file_modification_date": "2022-05-27T22:52:08Z",
    "file_size": 2912830,
    "plain_text": "# TeaBot is now spreading across the globe\n\n**[cleafy.com/cleafy-labs/teabot-is-now-spreading-across-the-globe](https://www.cleafy.com/cleafy-labs/teabot-is-now-spreading-across-the-globe)**\n\n## Download your PDF guide to TeaBot \n\nGet your free copy to your inbox now\n\nDownload PDF Version\n\n## Background and key points\n\nTeaBot is an Android banking trojan emerged at the beginning of 2021 designed for\nstealing victim’s credentials and SMS messages\nTeaBot RAT capabilities are achieved via the device screen’s live streaming (requested\non-demand) plus the abuse of Accessibility Services for remote interaction and keylogging. This enables Threat Actors (TAs) to perform ATO (Account Takeover) directly\nfrom the compromised phone, also known as “On-device fraud”.\nInitially TeaBot has been distributed through smishing campaigns using a predefined\nlist of lures, such as TeaTV, VLC Media Player, DHL and UPS and others.\nRecent samples show how TAs are evolving their side-loading techniques, including\nthe distribution of applications on the official Google Play Store, also known as\n“dropper applications”.\nIn the last months, we detected a major increase of targets which now count more than\n400 applications, including banks, crypto exchanges/wallets and digital insurance, and\nnew countries such as Russia, Hong Kong, and the US (Figure 1).\n\n\n-----\n\nThe following article is a major update of the previous TeaBot: a new Android malware\nemerged in Italy, targets banks in Europe published in May, 2021 in our blog “Cleafy Labs”.\n\nFigure 1 – Updated targeted of TeaBot (February 2022)\n\n## How TeaBot is evolving its distribution\n\nOne of the most interesting aspects of the TeaBot’s distribution are the latest techniques\nimplemented on its campaigns. During 2021, TeaBot appeared to be at its early stages of\ndevelopment and it was mainly distributed through smishing campaigns using a predefined\nlist of lures, such as TeaTV, VLC Media Player, DHL and UPS and others.\n\nOn February 21, 2022, the Cleafy Threat Intelligence and Incident Response (TIR) team was\nable to discover an application published on the official Google Play Store, which was acting\nas a dropper application delivering TeaBot with a fake update procedure. The dropper lies\nbehind a common QR Code & Barcode Scanner and, at the time of writing, it has been\ndownloaded +10.000 times. All the reviews display the app as legitimate and wellfunctioning.\n\n\n-----\n\nFigure 2 – TeaBot dropper published on the official Google Play Store (February 2022)\nHowever, once downloaded, the dropper will request immediately an update through a popup\nmessage. Unlike legitimate apps that perform the updates through the official Google Play\nStore, the dropper application will request to download and install a second application, as\ndisplayed in Figure 3. This application has been detected to be TeaBot.\n\nFigure 3 – TeaBot installation via a fake update (February 2022)\nTeaBot, posing as “QR Code Scanner: Add-On”, is downloaded from two specific GitHub\nrepositories created by the user feleanicusor. It has been verified that those repositories\ncontained multiple TeaBot samples starting from Feb 17, 2022:\n\n\n-----\n\nFigure 4 – Github repository used to store the TeaBot samples\nThe following graph will give you an overview of the actual infection chain developed by TAs\nand how they are improving their sideloading technique for distributing TeaBot, starting from\na dropper application spreaded via the official Google Play Store and abusing Github service\nfor hosting the actual malicious payload:\n\nFigure 5 – TeaBot infection chain\nOnce the users accept to download and execute the fake “update”, TeaBot will start its\ninstallation process by requesting the Accessibility Services permissions in order to obtain\nthe privileges needed:\n\n\n-----\n\n**View and control screen: used for retrieving sensitive information such as login**\ncredentials, SMS, 2FA codes from the device’s screen.\n**View and perform actions: used for accepting different kinds of permissions,**\nimmediately after the installation phase, and for performing malicious actions on the\ninfected device.\n\nFigure 6 – Permissions requested by TeaBot during the installation phases\n\n## New targets, new evasion techniques\n\n[One of the biggest difference, compared to the samples discovered during the May 2021 [1],](https://www.cleafy.com/cleafy-labs/teabot)\nis the increase of targeted applications which now include home banking applications,\n**insurances applications, crypto wallets and crypto exchanges. In less than a year, the**\nnumber of applications targeted by TeaBot have grown more than 500%, going from 60\ntargets to over 400.\n\n\n-----\n\nFigure 7 – Comparison between the TeaBot targets in May 2021 and Feb 2022\nDuring the last months, TeaBot has also started supporting new languages, such as Russian,\nSlovak and Mandarin Chinese, useful for displaying custom messages during the installation\nphases.\n\nFigure 8 – New languages supported by TeaBot (e.g. Russian, Slovak, Chinese, etc..)\n\n\n-----\n\nMoreover, it has been observed that TAs have been working on the sophistication of evasion\ntechniques, such as string obfuscation, used both for preventing a smooth static analysis,\nand for further lowering the detection rate by anti-malware solutions available on the market.\nAn example of the new evasion techniques introduced in recent TeaBot samples is given in\nFigure 9.\n\nFigure 9 – New evasion techniques introduced in recent TeaBot samples\nIt is also clear how the deobfuscation routine works: each class has been paired with a short\narray that is filled with pseudo-random codes. It is then manipulated by a function that uses\nthose codes to perform an XOR operation on its input and then returns the actual string.\n\nSince the dropper application distributed on the official Google Play Store requests only a\nfew permissions and the malicious app is downloaded at a later time, it is able to get\nconfused among legitimate applications and it is almost undetectable by common AV\nsolutions.\n\nFigure 10 – AV detection of the dropper uploaded in the Google Play Store (February 2022)\n\n[1] [https://www.cleafy.com/cleafy-labs/teabot](https://www.cleafy.com/cleafy-labs/teabot)\n\nAppendix 1: IOCs\n\n**IoC** **Description**\n\n\n-----\n\n**IoC** **Description**\n\nQR Code & Barcode - Scanner App Name (TeaBot dropper)\n\n\nhttps://play.google[.]com/store/apps/details?\nid=com.scanner.buratoscanner\n\n\nLink Google Play Store (TeaBot\ndropper)\n\n\n104046f5cf2fb5560acf541d4f9f6381 MD5 (TeaBot dropper)\n\nQR Code Scanner: Add-On App Name (TeaBot)\n\ncom.nnawozvvi.pamwhbawm Package Name (TeaBot)\n\nbf2ddaf430243461a8eab4aa1ed1e80d MD5 (TeaBot)\n\nhttps://github[.]com/leroynathanielxnlw GitHub repository (proxy)\n\nhttps://github[.]com/feleanicusor GitHub repository (hosting multiple\nTeaBot samples)\n\n185[.]215[.]113[.]31 C2 Server\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-01 - TeaBot is now spreading across the globe.pdf"
    ],
    "report_names": [
        "2022-03-01 - TeaBot is now spreading across the globe.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536142,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653691928,
    "ts_modification_date": 1653691928,
    "files": {
        "pdf": "https://archive.orkl.eu/b104d29872c9fd9404b7cdcb8fd82963b4459ed5.pdf",
        "text": "https://archive.orkl.eu/b104d29872c9fd9404b7cdcb8fd82963b4459ed5.txt",
        "img": "https://archive.orkl.eu/b104d29872c9fd9404b7cdcb8fd82963b4459ed5.jpg"
    }
}