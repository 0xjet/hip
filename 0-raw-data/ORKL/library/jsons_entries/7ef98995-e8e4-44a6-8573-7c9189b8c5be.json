{
    "id": "7ef98995-e8e4-44a6-8573-7c9189b8c5be",
    "created_at": "2023-01-12T15:05:19.869924Z",
    "updated_at": "2025-03-27T02:06:02.70854Z",
    "deleted_at": null,
    "sha1_hash": "f3b1db3aee1bf63ce2b53c1c20fc8558b349c66d",
    "title": "2021-01-26 - Phishing Campaign Leverages WOFF Obfuscation and Telegram Channels for Communication",
    "authors": "",
    "file_creation_date": "2022-05-28T19:06:04Z",
    "file_modification_date": "2022-05-28T19:06:04Z",
    "file_size": 100121,
    "plain_text": "# Phishing Campaign Leverages WOFF Obfuscation and Telegram Channels for Communication\n\n**[fireeye.com/blog/threat-research/2021/01/phishing-campaign-woff-obfuscation-telegram-communications.html](https://www.fireeye.com/blog/threat-research/2021/01/phishing-campaign-woff-obfuscation-telegram-communications.html)**\n\n## Breadcrumb\n\nThreat Research\n\nBernard Sapaden, Mohammed Mohsin Dalla, Rahul Mohandas, Sachin Shukla, Srini\nSeethapathy, Sujnani Ravindra\n\nJan 26, 2021\n\n5 mins read\n\nThreat Research\n\n\n-----\n\nFireEye [Email Security recently encountered various phishing campaigns, mostly in the](https://www.fireeye.com/content/fireeye-www/en_US/products/email-security.html)\nAmericas and Europe, using source code obfuscation with compromised or bad domains.\nThese domains were masquerading as authentic websites and stole personal information\nsuch as credit card data. The stolen information was then shared to cross-platform, cloudbased instant messaging applications.\n\nComing off a busy holiday season with a massive surge in deliveries, this post highlights a\nphishing campaign involving a fake DHL tracking page. While phishing attacks targeting\nusers of shipping services is not new, the techniques used in these examples are more\ncomplex than what would be found in an off-the-shelf phishing kit.\n\nThis campaign uses a WOFF-based substitution cypher, localization specific targeting, and\nvarious evasion techniques which we unravel here in this blog.\n\n**Attack Flow**\n\nThe attack starts with an email imitating DHL, as seen in Figure 1. The email tries to trick the\nrecipient into clicking on a link, which would take them to a fake DHL website. In Figure 2, we\ncan see the fake page asking for credit card details that, if submitted, would give the user a\ngeneric response while in the background the credit card data is shared with the attackers.\n\n\n-----\n\nDHL phishing attempt\n\n\nFigure 1: DHL phishing attempt\n\n\n-----\n\nFake website imitating DHL tracking\n\n\nFigure 2: Fake website imitating DHL tracking\nThis DHL phishing campaign uses a rare technique for obfuscating its source page. The\npage source contains proper strings, valid tags, and appropriate formatting, but contains\nencoded text that would render gibberish without decoding prior to loading the page, as seen\nin Figure 3. Typically, decoding such text is done by including script functions within the\ncode. Yet in this case, the decoding functions are not contained in the script.\n\n\n-----\n\nSnippet of the encoded text on page source\n\n\nFigure 3: Snippet of the encoded text on page source\nThe decoding is done by a Web Open Font Format (WOFF) font file, which happens upon\nloading the page in a browser and will not be visible in the page content itself. Figure 4\nshows the substitution cipher method and the WOFF font file. The attacker does this to\nevade detection by security vendors. Many security vendors use static or regex signaturebased rules, so this method will break those naïve-based conditions.\n\n\n-----\n\nWOFF substitution cipher\n\n\nFigure 4: WOFF substitution cipher\nLoading this custom font which decodes the text is done inside the Cascading Style Sheets\n(CSS). This technique is rare as JavaScript functions are traditionally used to encrypt and\ndecrypt HTML text.\n\n\n-----\n\nCSS file for loading WOFF font file\n\n\nFigure 5: CSS file for loading WOFF font file\nFigure 5 shows the CSS file used to load the WOFF font file. We have also seen the same\nCSS file, style.css, being hosted on the following domains:\n\nhxxps://www.lifepointecc[.]com/wp-content/sinin/style.css\nhxxps://candyman-shop[.]com/auth/DHL_HOME/style.css\nhxxps://mail.rsi-insure[.]com/vendor/ship/dhexpress/style.css\nhxxps://www.scriptarticle[.]com/thro/HOME/style.css\n\nThese legitimate-looking domains are not hosting any phishing websites as of now; instead,\nthey appear to be a repository for attackers to use in their phishing campaigns. We have\nseen similar phishing attacks targeting the banking sector in the past, but this is newer for\ndelivery websites.\n\n**Notable Techniques**\n\n\n-----\n\nLocalization\n\nThe phishing page displays the local language based on the region of the targeted user. The\nlocalization code (Figure 6) supports major languages spoken in Europe and the Americas\nsuch as Spanish, English, and Portuguese.\n\n\nLocalization code\n\n\nFigure 6: Localization code\nThe backend contains PHP resource files for each supported language (Figure 7), which are\npicked up dynamically based on the user’s IP address location.\n\n\n-----\n\nLanguage resource files\n\n\nFigure 7: Language resource files\nEvasion\n\nThis campaign employs a variety of techniques to evade detection. This will not serve up a\nphishing page if the request came from certain blocked IP addresses. The backend code\n(Figure 8) served the users with a \"HTTP/1.1 403 Forbidden\" response header under the\nfollowing conditions:\n\nIP has been seen five times (AntiBomb_User func)\nIP host resolves to its list of avoided host names ('google', 'Altavista', 'Israel', 'M247',\n'barracuda', 'niw.com.au' and more) (AntiBomb_WordBoot func)\nIP is on its own local blocklist csv (x.csv in the kit) (AntiBomb_Boot func)\nIP has seen POSTing three times (AntiBomb_Block func)\n\n\n-----\n\nBackend evasion code\n\n\nFigure 8: Backend evasion code\nAfter looking at the list of blocked hosts, we could deduce that the attackers were trying to\nblock web crawlers.\n\nData Theft\n\nThe attackers behind this phishing campaign attempted to steal credentials, credit card data,\nand other sensitive information. The stolen data is sent to email addresses and Telegram\nchannels controlled by the attacker. We uncovered a Telegram channel where data is being\nsent using the Telegram Bot API shown in Figure 9.\n\n\n-----\n\nChat log\n\n\nFigure 9: Chat log\nWhile using php mail() function to send stolen credentials is quite common, in the near past,\nencrypted instant messaging applications such as Telegram have been used for sending\nphished information back to command and control servers.\n\nWe were able to access one of the Telegram channels controlled by the attacker as shown in\nFigure 10. The sensitive information being sent in the chat includes IP addresses and credit\ncard data.\n\n\n-----\n\nTelegram channel with stolen information\n\n\nFigure 10: Telegram\n\nchannel with stolen information\n\n**Conclusion**\n\nAttackers (and especially phishers) are always on the hunt for new ways to evade detection\nby security products. Obfuscation gives the attackers an edge, and makes it harder for\nsecurity vendors to protect their customers.\n\nBy using instant messaging applications, attackers get user data in real time and victims\nhave little to respond once their personal information is compromised.\n\n**Indicators of Compromise (IOC)**\n\nFireEye Email Security utilizing FAUDE (FireEye Advanced URL Detection Engine) protects\ncustomers from these types of phishing threats. Unlike traditional anti-phishing techniques\ndependent on static inspection of phishing URL content, FAUDE uses multiple artificial\nintelligence (AI) and machine learning (ML) engines to more effectively thwart these attacks.\n\nFrom December 2020 until the time of posting, our FAUDE detection engine saw more than\n100 unique URLs hosting DHL phishing pages with obfuscated source code, including:\n\nhxxps://bit[.]ly/2KJ03RH\nhxxps://greencannabisstore[.]com/0258/redirect-new.php\n\n\n-----\n\nhxxps://directcallsolutions[.]co[.]za/CONTACT/DHL_HOME/\nhxxps://danapluss[.]com/wp-admin/dhl/home/\nhxxp://r.cloudcyberlink[.]digital/<path> (multiple paths using same domain)\n\nEmail Addresses\n\nmedmox2k@yandex[.]com\no.spammer@yandex[.]com\ncameleonanas2@gmail[.]com\n\nTelegram Users\n\n@Saitama330\n@cameleon9\n\nstyle.css\n\nMd5: 83b9653d14c8f7fb95d6ed6a4a3f18eb)\nSha256: D79ec35dc8277aff48adaf9df3ddd5b3e18ac7013e8c374510624ae37cdfba31\n\nfont-woff2\n\nMD5: b051d61b693c76f7a6a5f639177fb820\nSHA-256: 5dd216ad75ced5dd6acfb48d1ae11ba66fb373c26da7fc5efbdad9fd1c14f6e3\n\nDomains\n\nPradosdemojanda[.]com\n\nglobal-general-trackks.supercarhiredubai[.]com\n\ntracking-dhi.company\n\nTapolarivercamp[.]com\n\nRosariumvigil[.]com\n\nMydhlexpert[.]com\n\nAutorepairbyfradel[.]com\n\nURLs\n\nhxxps://wantirnaosteo[.]com[.]au/logon/home/MARKET/F004f19441/11644210b.php\n\n\n-----\n\nhxxps://ekartenerji[.]com[.]tr/wp-admin/images/dk/DHL/home.php\n\nhxxps://aksharapratishthan[.]org/admin/imagess/F004f19441/sms1.php\n\nhxxps://royalgateedu[.]com/wpcontent/plugins/elementor/includes/libraries/infos/package/F004f19441/00951124a.php\n\nhxxps://vandahering[.]com[.]br/htacess\n\nhxxps://hkagc[.]com/man/age/F004f19441/11644210b.php\n\nhxxps://fiquefitnes[s]comsaude[.]com/.wellknown/MARKET/MARKET/F004f19441/11644210b.php\n\nhxxps://juneispearlmonth[.]com/-/15454874518741212/dhltracking/F004f19441/00951124a.php\n\nhxxps://www.instantcopywritingscript[.]com/blog/wp-content/22/DHL/MARKET\n\nhxxps://isss[.]sjs[.]org[.]hk/wp-admin/includes/F004f19441/11644210b.php\n\nhxxps://www.concordceramic[.]com/fr/frais/F004f19441/11644210b.php\n\nhxxps://infomediaoutlet[.]com/oldsite/wp-content/uploads/2017/02/MARKET/\n\nhxxps://wema-wicie[.]pl/dh/l/en/MARKET\n\nhxxps://www.grupoindustrialsp[.]com/DHL/MARKET/\n\nhxxps://marrecodegoias[.]com[.]br/wpsnapshots/activat/MARKET/F004f19441/11644210b.php\n\nhxxps://villaluna[.]de/wp-content/info/MARKET/F004f19441/11644210b.php\n\nhxxp://sandur[.]dk/wp-content/upgrade/-/MARKET/\n\nhxxps://chistimvse[.]com/es/dhl/MARKET/\n\n\n-----\n\nhxxps://detmayviet[.]com/wp-includes/widgets/-/MARKET/F004f19441/11644210b.php\n\nhxxps://dartebreakfast[.]com/wp-content/plugins/dhl-espress/MARKET/\n\nhxxps://genesisdistributors[.]com/-/Tracking/dhl/Tracking/dhltracking/F004f19441/00951124a.php\n\nhxxps://www.goldstartechs[.]com/wp-admin/js/widgets/102/F004f19441/11644210b.php\n\nhxxps://universalpublicschooltalwandisabo[.]com/DHL\n\nhxxps://intranet[.]prorim[.]org[.]br/info/MARKET/F004f19441/11644210b.php\n\nhxxps://administrativos[.]cl/mail.php\n\nhxxps://nataliadurandpsicologa[.]com[.]br/upgrade/MARKET/F004f19441/11644210b.php\n\nhxxps://tanaxinvest[.]com/en/dhl/MARKET/\n\nhxxps://deepbluedivecenter[.]com/clear/item/\n\nhxxps://keystolivingafulfilledlife[.]com/wpadmin/includes/daspoe99i3mdef/DOCUNTRITING\n\nhxxps://juneispearlmonth[.]com/-/15454874518741212/dhltracking/F004f19441/00951124a.php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-26 - Phishing Campaign Leverages WOFF Obfuscation and Telegram Channels for Communication.pdf"
    ],
    "report_names": [
        "2021-01-26 - Phishing Campaign Leverages WOFF Obfuscation and Telegram Channels for Communication.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535919,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653764764,
    "ts_modification_date": 1653764764,
    "files": {
        "pdf": "https://archive.orkl.eu/f3b1db3aee1bf63ce2b53c1c20fc8558b349c66d.pdf",
        "text": "https://archive.orkl.eu/f3b1db3aee1bf63ce2b53c1c20fc8558b349c66d.txt",
        "img": "https://archive.orkl.eu/f3b1db3aee1bf63ce2b53c1c20fc8558b349c66d.jpg"
    }
}