{
    "id": "d12ddca4-b372-4bb5-9f21-6a40ceb2d3b5",
    "created_at": "2023-01-12T15:07:45.392569Z",
    "updated_at": "2025-03-27T02:14:34.208571Z",
    "deleted_at": null,
    "sha1_hash": "49eb88a22453a46036eb1feff39c21c41a5a8a1b",
    "title": "2022-08-31 - Asbit- An Emerging Remote Desktop Trojan",
    "authors": "",
    "file_creation_date": "2022-09-12T11:59:14Z",
    "file_modification_date": "2022-09-12T11:59:14Z",
    "file_size": 1578629,
    "plain_text": "# Asbit: An Emerging Remote Desktop Trojan\n\n**[blogs.juniper.net/en-us/threat-research/asbit-an-emerging-remote-desktop-trojan](https://blogs.juniper.net/en-us/threat-research/asbit-an-emerging-remote-desktop-trojan)**\n\n## Introduction\n\n\nAugust 31, 2022\n\n\nJuniper Threat Labs is currently monitoring an emerging Chinese Remote Desktop Trojan called\nAsbit. It’s a remote access Trojan being advertised on its developer’s website as a “Fast Remote\nDesktop”. This RAT first made its appearance in 2021 and kept updating its infrastructure and\nfeatures as it went along. It uses a number of strategies to avoid endpoint and network detection. By\nusing DNS over HTTPS (DoH) to resolve the IP addresses of its control servers, it aims to get past\nnetwork DNS filters.\n\nThe domain `asbit[.]cn was registered on January 31, 2021. This domain was used to host the`\nmalware and its modules. It also hosts the threat actor’s website. The website is still live at the time\nof this publication. Recently, the threat actor registered another domain and website,\n```\nrdlite[.]com . The new website looks like a copy of the previous website.\n\n```\n\n-----\n\nThe\n\nwebsite www.asbit.cn translated to English. It advertises itself as “Fast Desktop”, a secure remote\ndesktop application for IT professionals.\n\n## Timeline\n\nTo provide an understanding of the Asbit operation, below is a timeline of their infrastructure. The\ndomain, `asbit[.]cn was registered on January 31, 2021. At that time, it resolved to IP`\n```\n47.111.81.199 . Later in the year 2021, the threat actors registered mitm[.]work and\nfmt[.]ink . At this time, the servers are hosted on Linux servers. In 2022, they registered the\n\n```\ndomain `def[.]cab, rfb[.]ink and rdlite[.]com . Around June of 2022, we also see a shift of`\nthe OS they used in hosting these servers. Based on third-party server fingerprinting services like\nShodan and Cencys, we found that they shifted to Windows OS and used IIS. It’s unclear to us why\nthey shifted to Windows.\n\n\n**Domain** **Creation**\n**Date**\n\nasbit.cn January\n31, 2021\n\n\n**DNS**\n**Resolution**\n\n\n47.111.81.199 Hangzhou\nAlibaba\nAdvertising\nCo.,Ltd.\n\n43.128.31.158 Asia\nPacific\nNetwork\nInformation\nCenter,\nPty. Ltd.\n\n43.156.37.105 Tencent\nCloud\nComputing\n(Beijing)\nCo., Ltd\n\n\n**ASN** **Country** **First**\n**Seen**\n\n\n**OS**\n\nLinux\n\nLinux\n\nLinux\n\n\nChina 202101-31\n14:12:49\n\n\nHong\nKong\n\n\n202110-23\n0:35:40\n\n\nChina 202112-22\n15:42:42\n\n\n**Last**\n**Seen**\n\n202110-22\n5:50:25\n\n202112-21\n0:35:50\n\n202112-22\n15:42:42\n\n\n-----\n\nmitm.work May 24,\n2021\n\nfmt.ink September\n4, 2021\n\ndef.cab May 6,\n2022\n\n\n43.128.31.158 Asia\nPacific\nNetwork\nInformation\nCenter,\nPty. Ltd.\n\n43.154.232.199 Tencent\nCloud\nComputing\n(Beijing)\nCo., Ltd\n\n119.28.78.209 Tencent\ncloud\ncomputing\n(Beijing)\nCo., Ltd.\n\n43.128.31.158 Asia\nPacific\nNetwork\nInformation\nCenter,\nPty. Ltd.\n\n43.154.211.60 Tencent\nCloud\nComputing\n(Beijing)\nCo., Ltd\n\n43.154.232.199 Tencent\nCloud\nComputing\n(Beijing)\nCo., Ltd\n\n119.28.78.209 Tencent\ncloud\ncomputing\n(Beijing)\nCo., Ltd.\n\n43.128.31.158 Asia\nPacific\nNetwork\nInformation\nCenter,\nPty. Ltd.\n\n\nChina 202106-04\n18:11:34\n\nChina 202206-15\n5:41:34\n\n\nChina 202205-08\n23:00:04\n\n\nLinux\n\nWindows,\nIIS server\n\nWindows,\nIIS server\n\nLinux\n\nUnknown\n\nWindows,\nIIS server\n\nWindows,\nIIS server\n\nLinux\n\n\nHong\nKong\n\nHong\nKong\n\n\n202207-12\n4:30:38\n\n202109-06\n2:23:53\n\n\nChina 202205-20\n9:07:51\n\nChina 202206-15\n5:20:32\n\n\nHong\nKong\n\n\n202207-12\n5:10:32\n\n\n202112-15\n8:34:51\n\n202207-12\n4:04:09\n\n202208-01\n0:33:24\n\n202205-20\n8:39:50\n\n202206-19\n17:40:10\n\n202207-12\n4:27:52\n\n202208-01\n1:56:23\n\n202205-08\n23:00:04\n\n\n-----\n\nChina 202207-12\n9:55:52\n\n\nWindows,\nIIS server\n\nLinux\n\nUnknown\n\nWindows,\nIIS server\n\nWindows,\nIIS server\n\nUnknown\n\nUnknown\n\n\nrfb.ink February\n24, 2022\n\nrdlite.com June 8,\n2022\n\n\n43.154.232.199 Tencent\nCloud\nComputing\n(Beijing)\nCo., Ltd\n\n43.128.31.158 Asia\nPacific\nNetwork\nInformation\nCenter,\nPty. Ltd.\n\n43.154.211.60 Tencent\nCloud\nComputing\n(Beijing)\nCo., Ltd\n\n43.154.232.199 Tencent\nCloud\nComputing\n(Beijing)\nCo., Ltd\n\n119.28.78.209 Tencent\ncloud\ncomputing\n(Beijing)\nCo., Ltd.\n\n\n104.21.10.90 Cloudflare United\nStates\n\n172.67.162.192 Cloudflare United\nStates\n\n\nHong\nKong\n\n\n202205-14\n13:07:32\n\n\nChina 202205-21\n15:34:34\n\nChina 202206-03\n15:32:50\n\n\nHong\nKong\n\n\n202207-26\n21:07:26\n\n202205-18\n7:20:44\n\n202206-03\n2:41:55\n\n202207-12\n8:58:52\n\n202207-25\n11:51:59\n\n202208-10\n2:16:40\n\n202208-10\n2:16:40\n\n\n202207-12\n9:50:46\n\n202206-08\n17:26:55\n\n202206-08\n17:26:55\n\n\n## Early Version of asbit RAT\n\nThe earliest version of the malware we could find dates back to May 2021. It included a series of\nloader modules which will eventually download the core module. The malware is typically bundled\nwith installers. It starts by dropping the loader module that installs another DLL as a service. The\ninstalled service further downloads and executes the core module. The core module has remote\ndesktop functionality and other capabilities, including command execution and keystroke injection.\n\nThe malicious installer\n( 806523a9e4021cd72691fbdeb229339a24984b7ca79c3860ba468c832bf95c4d ) drops the loader\nmodules `C:\\2.0.50727 and` `C:\\4.0.30319 . The files appear to be folders of the .NET`\nframework, but they are in fact files. This is likely done by the author to obscure itself and try to\n\n\n-----\n\nevade endpoint detection. It also drops a malicious `libexpat.dll`\n( 018656e61c7c5fc8d5983a32507fbcf379dd9e2b5dd7d67b8e44590d46a8c51f ) and a benign\n```\nXLSP.dll ( cca2ea493c8402ed24c9c93328066ae0ce451059e2f954929f24ab7481119b6c ).\n\n```\nThe installer drops the\n\ncomponents in the C:\\ directory.\n\n## Loader Module\n\nThe loader module starts with the dropped C:\\2.0.50727 or C:\\4.0.30319. It executes either of these\n[files using RegAsm.exe, an assembly registration tool that is used to load .NET assembly files.](https://docs.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool)\n\n```\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe /u \"C:\\4.0.30319\"\n\n```\n\nThe `\"/u\" parameter, which means` `\"Unregister “, is part of the command to install this module.`\nThis could be interpreted as being used to remove the module. However, the module itself has an\n```\n“Unregister” function that does the opposite. It creates a service for libexpat.dll that further\n\n```\ndownloads additional modules, including the core module.\n\nUnregister function in the loader module that installs 2 DLLs as a service.\nOnce the `libexpat.dll service is installed and running, it downloads 2 additional modules. One`\nis a module that creates a web proxy\n( f223ceb9830ed18d823f42d9d8d5c09429782e0bcdbc62da5f00c881964e7041 ) and the other is\nthe core module ( 4b1efadc55c0cc3471e0945804125317b2a75772393541f680b1617f8a42773d ).\n\n## Second Loader Module\n\n[This module installs a browser proxy by downloading a Proxy Auto-Configuration (PAC) file from](https://developer.mozilla.org/en-US/docs/Web/HTTP/Proxy_servers_and_tunneling/Proxy_Auto-Configuration_PAC_file)\n```\n47.111.81.199 . This allows the threat actor to act as a Browser-in-the-Middle by making all\n\n```\nrequests from the browser proxied to the threat actor’s server. Installation of the PAC file also\n\n\n-----\n\nincludes installation of the threat actor s certificate.\n\nFunction that\n\ndownload and install a PAC file\n\nThe certificate installed by asbit malware.\nLastly, the module contacts `“rat.t.com” to report the newly infected system. The system`\ninformation which includes MAC address, OS, CPU and date is hashed and sent as the ID.\n\n## Core Module\n\n\n-----\n\nThe core module is a fully functional RAT. It has a hard coded server to where it connects to, which\nis `47.111.81.199:6000 . It also includes several functionalities including command execution and`\nkeystroke injection.\n\nBelow are the list of functions it can perform:\n\n1. Capture Screenshots\n2. Run TightVNC for Remote Desktop Control\n3. Control Mouse Movements\n4. Inject Keystrokes\n5. Kill Process by PID\n6. Download Files\n7. Execute Commands\n8. Collect Installed Certificates\n\nAn interesting function of this RAT is that it uses TightVNC for its remote desktop functions. We also\nfound other variants of this malware that use UltraVNC instead of TightVNC.\n\n\n-----\n\nFunction in the core module that uses TightVNCServer.\n\nprocess seen during execution of the malware.\n\n## Latest Version\n\n\nWinVNC.exe\n\n\nAs we noted in the “Timeline” section, the threat actor changed its infrastructure. It shifted to the\nfollowing domains for its download and control servers.\n\nink\nink\ncab\nwork\n\nThey have also added functionality to bypass network security using DNS over HTTPS (DoH) and\nadded a separate module solely for Remote Desktop using the RDPSession Class built in Windows.\n\n## Installer\n\nWe found the installer distributed as `.pif files. Some of these files were seen as discord`\nattachments, which indicates how the threat actors used Discord as an infection vector. Below are\nsome of the installer files we found:\n\n\n-----\n\n```\nFilename: Photo_2022 07 10_19 23 19.pif\n\nSha256: 754cc559a2c861c0ef8acfbbb632e79e04839ab9f8948fa3392c1cd69d14f026\n\nITW URL:\nhttps://cdn.discordapp.com/attachments/911561368359039026/995990526950117406/photo_2022-0710_19-23-19.pif\n\nFilename: Need to download attachments.pif\n\nSha256: C5a720c2460da4c49b912409b204fbec31c79af3f7aaa011a3e679645f060760\n\nITW URL: Unknown\n\nFilename: WhatsAppSMS reception.txt\n\nSha256: a2cdf57b6a1cbf36d0440feedb2d9593e81cf646fd6f736a66d32950c1fa6857\n\nITW URL: Unknown\n\n\n```\nThe following analysis is based on the installer\n```\n754cc559a2c861c0ef8acfbbb632e79e04839ab9f8948fa3392c1cd69d14f026 .\n\n```\nThe installer drops the loader module and `libexpat.dll .`\n\nIt has a slightly different install command than the first version. It still uses RegAsm.exe to load the\nloader module but now it drops it in `C:\\ with a random filename not with a .NET folder-like name.`\n```\nLibexpat.dll is also dropped in C:\\ProgramData.\n \"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe\" /u \"C:\\kfdjvzx5.5ie\"\n dd99e3acca16b02fa947b0742acfdc0a entry\n\n```\nThe loader module, `C:\\kfdjvzx5.5ie installs libexpat.dll as a service.`\n\nLibexpat.dll further downloads the following additional modules.\n\n\n-----\n\n**Core**\n\nDownloaded from http://106[.]12.129.126/build?project=loader.core&version=4.0.30319\nDownloads the core Module\nHas functions to uninstall itself and the malware\n**Core Module**\n\nDownloaded from http://106[.]12.129.126/build?project=client.core&version=4.0.30319\nas a gzip file\nUses DoH to determine the IP of ddns.b.rdlite.com where it can download the rdp\nmodule.\n**Rdp Client Module**\n\nDownloaded from http://222[.]210.157.249:1024/build?\nproject=rdp.client.core&version=4.0.30319&t=28069859\nUses DoH to determine the IP of its control server (v2.team.rfb.ink:5100)\n\n## Core Module\n\nThe new core module includes functions such as capture screenshots, inject keystrokes and\nexecute commands, but we noticed a much cleaner programming style hinting active development\nof the malware. We also noticed it added several functions, particularly handlers, for example, vnc,\nrfb and p2p functions.\n\nAnother interesting function is the use of DNS over HTTP (DoH) to query the ip address of its\ncontrol servers. For instance, the domain name of the file server where it hosts the rdp module\ncould be any of the following domains:\n\na.rdlite.com:1024\nb.rdlite.com:1024\nw.rdlite.com:1024\n\nHowever, it does not use the traditional way of getting the IP address, which is connecting to the\nDNS at port 53 using UDP. Rather, it gets the IP address using DNS over HTTP (DoH).\n\nBelow is a query for the IP address of `ddns.b.rdlite.com using Alibaba DoH server.`\n\n\n-----\n\n```\nGET /resolve?name=ddns.b.rdlite.com&short=true&_=28042000 HTTP/1.1\n\n```\n```\nHost: 223.5.5.5\n\n```\n```\n Connection: Keep-Alive [\"222.210.157.249\"]\n\n```\nCurrently, it can either use AliDns or DnsPod DoH servers.\n\nUsing DoH makes the malware more resilient against network filters that rely on traditional DNS\nqueries for blocking domains. For example, a network filter that blocks the domain ddns.b.rdlite.com\nwon’t be able to block the request because it can only see the HTTP request to DoH servers (e.g.,\nAlibaba or DnsPod). The way to block this request is to directly block the IP address associated with\nthe domain.\n\nIt’s interesting to note however that the malware author did not use HTTPS which will make it more\nresilient as such requests are encrypted.\n\n## RDP Client Module\n\nThis module is mainly for remote desktop control as the name implies. The old versions relied on\ncommercial or free remote desktop applications, such as TightVNC or UltraVNC while the latest\nversion implements its own RDP. It does this by using the built-in Windows RDP application. It\n\n\n-----\n\nworks by creating an RDP Session instance by using the CLSID ( 9B78F0E6-3E05-4A5B-B2E8```\nE743A8956B65 ) which is the RDPSession Class in Windows.\n\n```\nThe RDP modules control server is `v2.team.rfb.ink:5100, and it also uses DoH to determine`\nthe IP of its control server.\n\n## Conclusion\n\nIn this blog, we have detailed the evolution of an emerging Chinese remote desktop trojan. We have\nidentified some of its capabilities and its infrastructure and how it tries to evade endpoint and\nnetwork detection. We believe that this RAT is in its early development but it’s actively being\ndeveloped. It’s likely that we will see future versions of this malware with enhanced capabilities and\nnew ways of evading endpoint and network detection.\n\n[Juniper ATP Cloud detects this malware using Machine Learning based on behavioral analysis](https://www.juniper.net/us/en/products/security/advanced-threat-prevention.html)\nengine.\n\n\n-----\n\n## Indicators of Compromise\n\nasbit[.]cn\n\nmitm[.]work\n\nrdlite[.]com\n\nfmt[.]ink\n\ndef[.]cab\n\nrfb[.]ink\n\n47[.]111[.]81[.]199\n\n43[.]128[.]31[.]158\n\n43[.]156[.]37[.]105\n\n43[.]154[.]232[.]199\n\n119[.]28[.]78[.]209\n\n43[.]154[.]211[.]60\n104[.]21[.]10[.]90\n\n172[.]67[.]162[.]192\n\n806523a9e4021cd72691fbdeb229339a24984b7ca79c3860ba468c832bf95c4d\n\n018656e61c7c5fc8d5983a32507fbcf379dd9e2b5dd7d67b8e44590d46a8c51f\n\nf223ceb9830ed18d823f42d9d8d5c09429782e0bcdbc62da5f00c881964e7041\n\n4b1efadc55c0cc3471e0945804125317b2a75772393541f680b1617f8a42773d\n\n754cc559a2c861c0ef8acfbbb632e79e04839ab9f8948fa3392c1cd69d14f026\n\nC5a720c2460da4c49b912409b204fbec31c79af3f7aaa011a3e679645f060760\n\na2cdf57b6a1cbf36d0440feedb2d9593e81cf646fd6f736a66d32950c1fa6857\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-31 - Asbit- An Emerging Remote Desktop Trojan.pdf"
    ],
    "report_names": [
        "2022-08-31 - Asbit- An Emerging Remote Desktop Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536065,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1662983954,
    "ts_modification_date": 1662983954,
    "files": {
        "pdf": "https://archive.orkl.eu/49eb88a22453a46036eb1feff39c21c41a5a8a1b.pdf",
        "text": "https://archive.orkl.eu/49eb88a22453a46036eb1feff39c21c41a5a8a1b.txt",
        "img": "https://archive.orkl.eu/49eb88a22453a46036eb1feff39c21c41a5a8a1b.jpg"
    }
}