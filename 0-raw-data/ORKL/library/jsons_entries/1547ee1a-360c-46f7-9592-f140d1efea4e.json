{
    "id": "1547ee1a-360c-46f7-9592-f140d1efea4e",
    "created_at": "2023-01-12T15:07:59.394831Z",
    "updated_at": "2025-03-27T02:16:17.281837Z",
    "deleted_at": null,
    "sha1_hash": "4d65df27dbfd651efe8236558ee2f0c11753814d",
    "title": "2022-04-01 - New UAC-0056 activity- There’s a Go Elephant in the room",
    "authors": "",
    "file_creation_date": "2022-05-28T19:01:25Z",
    "file_modification_date": "2022-05-28T19:01:25Z",
    "file_size": 1861944,
    "plain_text": "# New UAC-0056 activity: There’s a Go Elephant in the room\n\n**[blog.malwarebytes.com/threat-intelligence/2022/04/new-uac-0056-activity-theres-a-go-elephant-in-the-room/](https://blog.malwarebytes.com/threat-intelligence/2022/04/new-uac-0056-activity-theres-a-go-elephant-in-the-room/)**\n\nThreat Intelligence Team April 1, 2022\n\n_This blog post was authored by Ankur Saini, Roberto Santos and Hossein Jazi._\n\n[UAC-0056 also known as SaintBear, UNC2589 and TA471 is a cyber espionage actor that](https://www.mandiant.com/resources/russia-invasion-ukraine-retaliation)\nhas been active since early 2021 and has mainly targeted Ukraine and Georgia. The group is\nknown to have performed a wiper attack in January 2022 on multiple Ukrainian government\ncomputers and websites.\n\n[Earlier in March, Cert-UA reported UAC-0056 activity that targeted state organizations in](https://cert.gov.ua/article/37704)\nUkraine using malicious implants called GrimPlant, GraphSteel as well as CobaltStrike\n[Beacon. Following up with that campaign, SOCPRIME and](https://socprime.com/blog/cobalt-strike-beacon-grimplant-and-graphsteel-malware-massively-spread-by-uac-0056-threat-actors-in-targeted-phishing-emails-cert-ua-alert/) [SentinelOne have reported some](https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/)\nsimilar activities associated with this actor.\n\n[In late March, the Malwarebytes Threat Intelligence Team identified new activity from this](https://twitter.com/h2jazi/status/1509382428296728580)\ngroup that targeted several entities in Ukraine, including ICTV, a private TV channel. Unlike\nprevious attacks that were trying to convince victims to open a url and download a first stage\npayload or distributing fake translation software, in this campaign the threat actor is using a\nspear phishing attack that contains macro-embedded Excel documents. In this blog post, we\nprovide a technical analysis of this new campaign.\n\n\n-----\n\n## Attack process\n\nThe following picture shows the overall attack procedure used by this actor. The attack starts\nwith malicious documents sent as attachment to a phishing email. The document contains a\nmalicious macro that drops an embedded payload within the document. The next stage\npayloads are being downloaded from the attacker server in Base64 format.\n\nFigure 1: Attack process\n\n## Phishing email\n\nThe actor has distributed phishing emails at least from March 23th to March 28th. The email\nsubject is Заборгованість по зарплаті (wage arrears) and the body of all the emails is the\nsame:\n_Заборгованість по зарплаті. Оновлюється автоматично. Просимо надіслати вашу_\n_пропозицію для скорочення заборгованості по зарплаті. (Wage arrears. Updated_\nautomatically. Please send your offer to reduce your salary arrears.)\n\n\n-----\n\nFigure\n\n2: Phishing email\n\n## Excel document:\n\nThe attached document has the same name as email subject “Заборгованість по\n_зарплаті” and it seems the actor has used a legit document as decoy._\n\nFigure 3: Macro-embedded excel document\nThis document contains an embedded macro that drops the first stage payload called “baseupdate.exe”. The payload has been saved in a “very hidden sheet” named\n“SheetForAttachedFile”. The sheet contains the filename, the date the payload is attached\n(21th March 2022), the file size and the content of the attached file in hex format.\n\n\n-----\n\nFigure 4: Hidden Sheet\nThe macro reads the content of the embedded file in the hidden sheet and writes it into the\ndefined location for this payload which is the “AppData\\Local\\Temp\\” directory. The macro\n[used by the actor is taken from a website that described and provided code for a method to](https://excelvba.ru/code/tools/Attachments)\nattach and extract the files from an Excel workbook.\n\nFigure 5: Macro\n\n## Elephant Dropper (Base-Update.exe)\n\nElephant Dropper is the initial executable deployed in this attack; as the name suggests this\nis a simple dropper which deploys further stages. This executable is written in the Go\nprogramming language and is signed with a stolen Microsoft certificate. The strings in the\nbinary suggest that it was actually named as Elephant Dropper by the attackers themselves.\n\nIt checks if the “C:\\Users\\{user}\\.java-sdk” directory exists on the system and creates it if it\ndoes not. The strings in the binary are encoded and are only decoded when they are\nrequired to be used.\n\nThe dropper decodes the C2 address from a string and then downloads a Base64 encoded\nbinary from the C2 and writes it to “C:\\Users\\{user}\\.java-sdk\\java-sdk.exe”. This downloaded\nbinary is named as Elephant Downloader by the attackers judging from the strings present.\n\n\n-----\n\njava-sdk.exe is then executed by the dropper with the following arguments, -a\n_0CyCcrhI/6B5wKE8XLOd+w==”. The argument “-a” refers to address and the Base64 string_\nis the C2 address in AES encrypted format.\n\nFigure 6: Elephant Dropper\n\n## Elephant Downloader (java-sdk.exe)\n\nElephant Downloader is also written in the Go Programming Language and is executed by\nthe Dropper. The main purpose of this payload is to maintain persistence on the system and\nalso deploy the next two stages of the attack. The strings in this executable are encoded in\nthe same way as in the Dropper. It makes itself persistent through the auto-run registry key.\nTo do so, it creates a registry key under “\\Software\\Microsoft\\Windows\\CurrentVersion\\Run”\nnamed as “Java-SDK” with value “C:\\Users\\{user}\\Desktop\\java-sdk.exe -a\n_0CyCcrhI/6B5wKE8XLOd+w==”._\n\nFigure 7: Registry Key for Persistence\n\n\n-----\n\nThe downloader is responsible for getting the implant and the client; the URL paths for the\npayloads are stored in encoded form in the binary. It downloads the implant and the client\nfrom http://194.31.98.124:443/m and http://194.31.98.124:443/p respectively in Base64\nencoded format.\n\nAfter this, it decodes the file names which are stored as well in encoded format and creates\nthe file in the earlier mentioned directory .java-sdk. The file name of the implant is oracle_java.exe and the client is microsoft-cortana.exe. The downloader executes both payloads_\nand passes “-addr 0CyCcrhI/6B5wKE8XLOd+w==” as arguments to both. Again the Base64\nstring is the C2 address in AES encrypted format.\n\nFigure 8: Implant and Client being dropped\n\n## Elephant Implant (oracle-java.exe)\n\nElephant Implant (also tracked as GrimPlant backdoor) seems to be one of the most\nimportant payloads in this attack. This executable communicates with the C2 on port 80.\nSimilar to earlier payloads, strings are encoded in the same fashion is in this binary as well,\nand it also gets the C2 address encrypted from its parent process. The implant makes use of\ngRPC to communicate with the C2, it has a TLS certificate embedded in the binary and\nmakes use of SSL/TLS integration in gRPC. This allows the malware to encrypt all the data\nthat is being sent to the C2 via gRPC.\n\n\n-----\n\nFigure 9: Embedded TLS Certificate in the Implant\n[The implant uses the MachineID library to derive a unique id for each machine. It also gets](https://github.com/denisbrodbeck/machineid)\nthe IP address of the machine by making a request to “https://api.ipify.org/”.\n\nIt also collects information related to the OS in a function named GetOSInfo, as part of this\nthe malware collects the hostname, OS name and number of CPUs in the system. A function\nnamed GetUserInfo collects the Name, Username and path to Home directory of the current\nuser.\n\nFigure 10: getSystemInfo function\nThe Implant can communicate with the C2 by using 4 types of RPC requests:\n\n\n-----\n\n**/Implant/Login – This is the initial RPC request that is sent to the C2. Along with this**\nRPC request the earlier retrieved ID and system information is sent to the C2 as well.\n**/Implant/FetchCommand – This RPC request is used to retrieve the command that**\nthe actor wants to execute on the target machine. The retrieved command is executed\nvia “%windir%\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe“. An AdminId and\n_Command to be executed is received as a response to this command._\n**/Implant/SendCmdOutput – This is used to send the output of an executed command**\nby sending a\nSendCmdOutput RPC request to the C2. An AdminId and Command Output is sent\nwith this request.\n**/Implant/Heartbeat – A Heartbeat RPC request is made to C2 to send the status to the**\nC2 at regular intervals. The machine id and system info retrieved earlier is sent with\nthis request.\n\nFigure\n\n11: RPC Requests\n\n## Elephant Client (microsoft-cortana.exe)\n\nThe last payload that will be described is this blog is the one named elephant_client by the\nactor (also tracked as GraphSteel backdoor). The functionality suggests that this final\npayload is a data stealer.\n\nSimilar to other payloads in this attack chain, this payload receives the C2 server as a\nparameter in Base64 format (0CyCcrhI/6B5wKE8XLOd+w==) which is AES encrypted format\nof the server. Decoding the Base64 string gives us the C2 IP address in AES encrypted\nformat: `d02c8272b848ffa079c0a13c5cb39dfb . The actor uses the following key to AES`\ndecrypt (ECB-NoPadding mode) the C2 address:\n```\nF1D21960D8EB2FDDF2538D29A5FD50B5F64A3F9BF06F2A3C4C950438C9A7F78E .\n\n```\nOnce the sample has established its connection with its C2 server, it starts collecting data\nand exfiltrating them into the server. At first it collects some basic info about the user and\nsend it to the server as shown in Figure 12. (some info has been removed for privacy). The\ncollected data is Base64 encoded, and includes hostname, OS name(windows), number of\nCPUs, IP address, Name, Username and home directory.\n\nFigure 12: Collect user info\n\n\n-----\n\nAfter that, the client tries to steal credentials from the victim s machine. The actor steals data\nfrom the following services:\n\nBrowser credentials\nWiFi information\nCredentials manager data\nMail accounts\nPutty connections data\nFilezilla credentials\n\nWe have installed some of these services for testing purposes. Figure 13 shows how the\nstolen data is being sent to C2 server:\n\nFigure 13: C2 communications\nBase64 decoding data shows what data has been exfiltrated:\n\nFigure 14: Stolen data\nFor example, to recover Wifi data, the command `netsh wlan show profiles (that list all`\nSSIDs saved in the machine) has been used. Once all the SSIDs are gathered, if any, it will\nlaunch the command netsh wlan show profile [SSID] key=clear, revealing all saved\nwifi passwords:\n\n\n-----\n\nFigure 15: Wifi data exfiltration commands\nThe following image shows an example of the command execution, where you can see some\nof the commands executed in the process:\n\nFigure 16: Used commands\nFigure 17 shows another example of exfiltration in which an encoded PowerShell command\nis used to steal the data from the Secure Vault:\n\nFigure 17: PS command for exfiltration\nIn addition to stealing credentials, the actor steals all the files from the victim’s machine. To\ncollect the data it iterates through all the files in the user directory and hashes each of them.\nAll of these collected hashes will be sent to the actor’s C2 server. Finally, the malware will\n**send to the attackers all these files.**\nNote that all the collected data are AES encrypted before being sent to C2 server, so packet\ninspection will not reveal any useful information.\n\n\n-----\n\nFigure 18: Stealing files activity\n\n## Conclusion\n\nUAC-0056 aka UNC2589, TA471, or SaintBear is an active actor that has been performing\ncyber espionage campaigns against Ukraine since 2021. The group is known to have\nperformed the WhisperGate disruptive attack against Ukraine government entities in early\n2022. Recently we have observed new activity associated with this actor that used macroembedded excel documents to drop its malicious software on victims machines. In this blog\nwe provided a technical analysis of this campaign.\n\n\n-----\n\nThe [Malwarebytes Threat Intelligence team continues to monitor cyber attacks related to the](https://twitter.com/MBThreatIntel)\nUkraine war. We are protecting our customers and sharing additional indicators of\ncompromise.\n\n## IOCs\n\n**Emails:**\n\n1ce85d7be2e0717b79fbe0132e6851d81d0478dba563991b3404be9e58d745b1\n\n58c93b729273ffa86ed7baa7f00ccd9664ab9b19727010a5a263066bff77cee8\n\ned0128095910fa2faa44e41f9623dc0ba26f00d84be178ef46c1ded003285ae3\n\n**Excel doc:**\n\nc1afb561cd5363ac5826ce7a72f0055b400b86bd7524da43474c94bc480d7eff\n\n**Elephant dropper (base-update.exe):**\n\n9e9fa8b3b0a59762b429853a36674608df1fa7d7f7140c8fccd7c1946070995a\n\n**Elephant downloader (java-sdk.exe):**\n\n8ffe7f2eeb0cbfbe158b77bbff3e0055d2ef7138f481b4fac8ade6bfb9b2b0a1\n\n**Elephant Implant (oracle-java.exe):**\n\n99a2b79a4231806d4979aa017ff7e8b804d32bfe9dcc0958d403dfe06bdd0532\n\n**Elephant Client (microsoft-cortana.exe):**\n\n60bdfecd1de9cc674f4cd5dd42d8cb3ac478df058e1962f0f43885c14d69e816\n\n**C2:**\n\n194.31.98.124\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-01 - New UAC-0056 activity- There’s a Go Elephant in the room.pdf"
    ],
    "report_names": [
        "2022-04-01 - New UAC-0056 activity- There’s a Go Elephant in the room.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c28760b2-5ec6-42ad-852f-be00372a7ce4",
            "created_at": "2022-10-27T08:27:13.172734Z",
            "updated_at": "2025-03-27T02:00:55.511386Z",
            "deleted_at": null,
            "main_name": "Ember Bear",
            "aliases": [
                "Ember Bear",
                "UNC2589",
                "Bleeding Bear",
                "DEV-0586",
                "Cadet Blizzard",
                "Frozenvista",
                "UAC-0056"
            ],
            "source_name": "MITRE:Ember Bear",
            "tools": [
                "P.A.S. Webshell",
                "CrackMapExec",
                "ngrok",
                "WhisperGate",
                "Saint Bot",
                "PsExec",
                "Rclone",
                "Impacket",
                "OutSteel"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "083d63b2-3eee-42a8-b1bd-54e657a229e8",
            "created_at": "2022-10-25T16:07:24.143338Z",
            "updated_at": "2025-03-27T02:02:10.12138Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "Ember Bear",
                "FROZENVISTA",
                "Lorec53",
                "Nascent Ursa",
                "Nodaria",
                "SaintBear",
                "Storm-0587",
                "TA471",
                "UAC-0056",
                "UNC2589"
            ],
            "source_name": "ETDA:SaintBear",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Elephant Client",
                "Elephant Implant",
                "GraphSteel",
                "Graphiron",
                "GrimPlant",
                "OutSteel",
                "Saint Bot",
                "SaintBot",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eecf54a2-2deb-41e5-9857-fed94a53f858",
            "created_at": "2023-01-06T13:46:39.349959Z",
            "updated_at": "2025-03-27T02:00:03.057647Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "UAC-0056",
                "Nascent Ursa",
                "Nodaria",
                "FROZENVISTA",
                "Storm-0587",
                "Lorec53",
                "Lorec Bear",
                "UNC2589",
                "TA471",
                "DEV-0587",
                "Saint Bear",
                "EMBER BEAR",
                "Bleeding Bear"
            ],
            "source_name": "MISPGALAXY:SaintBear",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "03a6f362-cbab-4ce9-925d-306b8c937bf1",
            "created_at": "2024-11-01T02:00:52.635907Z",
            "updated_at": "2025-03-27T02:00:55.474243Z",
            "deleted_at": null,
            "main_name": "Saint Bear",
            "aliases": [
                "Saint Bear",
                "Storm-0587",
                "TA471",
                "UAC-0056",
                "Lorec53"
            ],
            "source_name": "MITRE:Saint Bear",
            "tools": [
                "OutSteel",
                "Saint Bot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536079,
    "ts_updated_at": 1743041777,
    "ts_creation_date": 1653764485,
    "ts_modification_date": 1653764485,
    "files": {
        "pdf": "https://archive.orkl.eu/4d65df27dbfd651efe8236558ee2f0c11753814d.pdf",
        "text": "https://archive.orkl.eu/4d65df27dbfd651efe8236558ee2f0c11753814d.txt",
        "img": "https://archive.orkl.eu/4d65df27dbfd651efe8236558ee2f0c11753814d.jpg"
    }
}