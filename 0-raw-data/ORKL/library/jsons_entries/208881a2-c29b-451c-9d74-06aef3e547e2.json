{
    "id": "208881a2-c29b-451c-9d74-06aef3e547e2",
    "created_at": "2022-10-25T16:48:19.337566Z",
    "updated_at": "2025-03-27T02:05:46.86338Z",
    "deleted_at": null,
    "sha1_hash": "ab0989ee9b8e22bfb7221921e2a8717653e43251",
    "title": "Microsoft Word - LockBit_2.0_FLASH FINAL",
    "authors": "",
    "file_creation_date": "2022-02-04T10:38:28Z",
    "file_modification_date": "2022-02-04T11:28:56Z",
    "file_size": 1932405,
    "plain_text": "## 4 February 2022 The following information is being provided by the FBI, with no guarantees or warranties, for potential\n\n_use at the sole discretion of recipients to protect against cyber threats. This data is provided in order_\n_to help cyber security professionals and system administrators to guard against the persistent malicious_\n\nFLASH Number\n\n_actions of cyber actors. This FLASH was coordinated with DHS/CISA._\n\n#### CU-000162-MW This FLASH has been released TLP:WHITE\n\n\n**WE NEED YOUR HELP!** If you identify any suspicious activity within your enterprise or have related information,\n\nplease contact your local FBI Cyber Squad immediately with respect to the procedures outlined in the\n\nReporting Notice section of this message.\n\n*Note: By reporting any related information to FBI Cyber Squads, you are assisting in sharing information that allows the FBI to track\n\n_malicious actors and coordinate with private industry and the United States Government to prevent future intrusions and attacks._\n\n# Indicators of Compromise Associated with LockBit 2.0\n\n Ransomware\n\n## Summary\n\nLockBit 2.0 operates as an affiliate-based Ransomware-as-a-Service (RaaS) and employs a wide\nvariety of tactics, techniques, and procedures (TTPs), creating significant challenges for defense\nand mitigation. LockBit 2.0 ransomware compromises victim networks through a variety of\ntechniques, including, but not limited to, purchased access, unpatched vulnerabilities, insider\naccess, and zero day exploits.\n\nAfter compromising a victim network, LockBit 2.0 actors use publicly available tools such as\nMimikatz to escalate privileges. The threat actors then use both publicly available and custom\ntools to exfiltrate data followed by encryption using the Lockbit malware. The actors always\nleave a ransom note in each affected directory within victim systems, which provides\ninstructions on how to obtain the decryption software. The ransom note also threatens to leak\nexfiltrated victim data on the LockBit 2.0 leak site and demands a ransom to avoid these\nactions.\n\n\n-----\n\nIn July 2021, LockBit 2.0 released an update which featured the automatic encryption of devices\nacross windows domains by abusing Active Directory group policies. In August 2021, LockBit 2.0\nbegan to advertise for insiders to establish initial access into potential victim networks, while\npromising a portion of the proceeds from a successful attack. LockBit 2.0 also developed a\nLinux-based malware which takes advantage of vulnerabilities within VMWare ESXi virtual\nmachines.\n\n## Technical Details\n\nLockBit 2.0 is best described as a heavily obfuscated ransomware application leveraging bitwise\noperations to decode strings and load required modules to evade detection. Upon launch,\nLockBit 2.0 decodes the necessary strings and code to import the required modules followed by\ndetermining if the process has administrative privileges. If privileges are not sufficient, it\nattempts to escalate to the required privileges. Lockbit 2.0 then determines the system and\nuser language settings and only targets those not matching a set list of languages that are\nEastern European. If an Eastern European language is detected, the program exits without\ninfection. As infection begins, Lockbit 2.0 deletes log files and shadow copies residing on disk.\nLockbit 2.0 enumerates system information to include hostname, host configuration, domain\ninformation, local drive configuration, remote shares, and mounted external storage devices.\nLockbit 2.0 attempts to encrypt any data saved to any local or remote device but skips files\nassociated with core system functions. Once completed, Lockbit 2.0 deletes itself from disk and\ncreates persistence at startup.\n\nPrior to encryption, Lockbit affiliates primarily use the Stealbit application obtained directly\nfrom the Lockbit panel to exfiltrate specific file types. The desired file types can be configured\nby the affiliate to tailor the attack to the victim. The affiliate configures the application to target\na desired file path and, upon execution, the tool copies the files to an attacker-controlled server\nusing http. Due to the nature of the affiliate model, some attackers use other commercially\navailable tools such as rclone and MEGAsync to achieve the same results. Lockbit 2.0 actors\noften use publicly available file sharing services including, privatlab[.]net, anonfiles[.]com,\nsendspace[.]com, fex[.]net, transfer[.]sh, and send.exploit[.]in. While some of these\napplications and services can support legitimate purposes, they can also be used by threat\nactors to aid in system compromise or exploration of an enterprise.\n\n\n-----\n\n## Indicators\n\nThe indicators of compromise (IOCs) and malware characteristics outlined below were derived\nfrom field analysis and the following samples are as of February 2022.\n\n**_Language check:_**\n\n**Language Codes**\n2092 1068 1067 1059 1079\n1087 1088 2073 1049 1064\n1090 2115 1091\n\n**Figure 2 - Exit Process**\n\n**Figure 3 - Russian Language**\n\n**Figure 1 - Language List**\n\n**_Command Line Activity:_**\nThe activity below provides a listing of all observed command line activity during execution:\n\n**Recorded Commands**\ncmd.exe /c vssadmin Delete Shadows /All /Quiet\n_Description: Deletes Shadow Copies_\ncmd.exe /c bcdedit /set {default} recoveryenabled No\n_Description: Disables Win 10 recovery_\ncmd.exe /c bcdedit /set {default} bootstatuspolicy ignoreallfailures\n_Description: Ignore boot failures_\ncmd.exe /c wmic SHADOWCOPY /nointeractive\n_Description: This command has an invalid syntax and errors out_\ncmd.exe /c wevtutil cl security\n_Description: Deletes security log_\ncmd.exe /c wevtutil cl system\n_Description: Deletes system log_\n\n|Language check:|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|Language Codes|||||\n|2092 1068 1067 1059 1079|||||\n|1087 1088 2073 1049 1064|||||\n|1090|2115|1091|||\n\n\n-----\n\n**Recorded Commands**\ncmd.exe /c wevtutil cl application\n_Description: Deletes application log_\ncmd.exe \"C:\\Windows\\System32\\cmd.exe\" /C ping 127.0.0.7 -n 3 >Nul&fsutil file\nsetZeroData offset=0 length=524288 \"C:\\Users\\fred\\Desktop\\Lsystem-234-bit.exe\" & Del /f\n/q \"C:\\Users\\fred\\Desktop\\Lsystem-234-bit.exe\"\n_Description: Wipes and deletes itself_\ncmd.exe \"C:\\Windows\\System32\\cmd.exe\" /c vssadmin delete shadows /all /quiet & wmic\nshadowcopy delete & bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set\n{default} recoveryenabled no\n_Description: Lockbit 2.0 deletes all shadow copies on disc to prevent data recovery_\n\n**Registry Keys**\n**Created - UAC Bypass**\nKey: HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\nNT\\CurrentVersion\\ICM\\Calibration\nValue: Display Calibrator\nData: <LockBit 2.0 Ransomware path>\n**Created - LockBit 2.0 Wallpaper Change**\nKey: HKEY_CLASSES_ROOT\\Lockbit\\shell\\Open\\Command\nData: \"C:\\Windows\\system32\\mshta.exe\"\n\"C:\\Users\\<username>\\Desktop\\LockBit_Ransomware.hta\"\nKey: HKEY_CLASSES_ROOT\\Lockbit\\DefaultIcon\nData: C:\\Windows\\<First 6 characters of LockBit 2.0 Decryption ID>.ico\n**Created - Persistence**\nKey: HKEY_CURENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\{GUID}\nData: C:\\Users\\<Username>\\Desktop\\LockBit_Ransomware.hta\nData: <LockBit 2.0 Ransomware path>\n**Created - Encryption**\nKey: HKEY_CURRENT_USER\\Software\\< LockBit 2.0 ID >\\Private\nKey: HKEY_CURRENT_USER\\Software\\< LockBit 2.0 ID >\\Public\n**Created - LockBit 2.0 Icon Location**\nKey: HKEY_LOCAL_MACHINE\\Software\\Classes\\.lockbit\\DefaultIcon\n**Created / Modified - LockBit 2.0 Desktop**\nKEY: HKEY_CURRENT_USER\\Control Panel\\Desktop\nString Value: %APPDATA%\\Local\\Temp\\<LockBit 2.0 wallpaper>.tmp.bmp\nString Value: TitleWallpaper=0\nString Value: WallpaperStyle = 2\n\n\n-----\n\n**Files Created**\nC:\\Users\\<Username>\\Desktop\\LockBit_Ransomware.hta - LockBit 2.0 hta File\nC:\\Windows\\SysWOW64\\<First 6 characters of Decryption ID>.ico - LockBit 2.0 Icon\nC:\\Users\\<username>\\AppData\\Local\\Temp\\<LockBit 2.0 wallpaper> .tmp.bmp - LockBit 2.0\n**Wallpaper**\n\n**Group Policy Update – Windows Defender Disable**\n\n[General]\nVersion=%s\ndisplayName=%s\n\n[Software\\Policies\\Microsoft\\Windows Defender;DisableAntiSpyware]\n\n[Software\\Policies\\Microsoft\\Windows Defender\\Real-Time\nProtection;DisableRealtimeMonitoring]\n\n[Software\\Policies\\Microsoft\\Windows Defender\\Spynet;SubmitSamplesConsent]\n\n[Software\\Policies\\Microsoft\\Windows\nDefender\\Threats;Threats_ThreatSeverityDefaultAction]\n\n[Software\\Policies\\Microsoft\\Windows Defender\\Threats\\ThreatSeverityDefaultAction]\n\n[Software\\Policies\\Microsoft\\Windows Defender\\Threats\\ThreatSeverityDefaultAction]\n\n[Software\\Policies\\Microsoft\\Windows Defender\\Threats\\ThreatSeverityDefaultAction]\n\n[Software\\Policies\\Microsoft\\Windows Defender\\Threats\\ThreatSeverityDefaultAction]\n\n[Software\\Policies\\Microsoft\\Windows Defender\\UX Configuration;Notification_Suppress]\n**PowerShell Command – Force GPO Policy**\npowershell.exe -Command “Get-ADComputer -filter * -Searchbase ‘%s’ | foreach{ InvokeGPUpdate -computer $_.name -force -RandomDelayInMinutes 0}”\n\n**Anti-Recovery Command**\nC:\\Windows\\System32\\cmd.exe /c vssadmin delete shadows /all /quiet & wmic shadowcopy\ndelete & bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default}\nrecoveryenabled no\n\n**LockBit 2.0 Extension**\n.lockbit\n\n**LockBit 2.0 Ransom Note**\nRestore-My-Files.txt\n\n\n-----\n\n**LockBit 2.0 Wallpaper**\n\n\n**Figure 4 - Wallpaper**\n\n**_Hidden debug / Status Window:_**\n\nLockbit 2.0 Status / Debug Window is activated when Shift + F1 is pressed. This window is\navailable during the initial infection and provides real time information on process, status of\nuser data destruction and encryption.\n\n**Figure 5 - Screen Capture of Hidden Window**\n\n\n-----\n\n**Stealbit**\n\nAnalysis determined Stealbit is a heavily obfuscated application that uses bitwise operations to\nbuild strings and load required modules. The recorded behaviors and characteristics are\noutlined below, as of February 2022.\n\nExample String decode routine used throughout Lockbit 2.0 and its associated programs:\nIPs are decoded starting with the following bytes which are ANDed by the count stored in ECX.\n\nKey:0xF8 0x72 0x12 0x13 0xA6 0x25 0x3C 0xE3 0xF9 0x91 0x2E 0x18 0x20 0x22 0x76\n\n**Figure 6 - Encoded IP Address**\n\n**Figure 7 – Example String Decode Routine, Specifically Used for IPs**\n\n**IP Addresses**\n139.60.160.200 93.190.139.223 45.227.255.190 193.162.143.218\n168.100.11.72 93.190.143.101 88.80.147.102 193.38.235.234\n174.138.62.35 185.215.113.39 185.182.193.120\n\n|IP Addresses|Col2|Col3|Col4|\n|---|---|---|---|\n|139.60.160.200 93.190.139.223 45.227.255.190 193.162.143.218||||\n|168.100.11.72 93.190.143.101 88.80.147.102 193.38.235.234||||\n|174.138.62.35|185.215.113.39|185.182.193.120||\n\n\n-----\n\n**Figure 8 – IPs Decoded During Runtime**\n\n**Stealbit URL Example**\nhxxp://185.182.193.120/06599379103BD9028AB56AE0EBED457D0\n\n**Network Indicators**\nAfter a host establishes a connection to one of the command and control servers, a HTTP PUT\nrequest with hexadecimal value and a length of 32 or 33 characters is sent to the command and\ncontrol server.\nFor example, PUT /06599379103BD9028AB56AE0EBED457D0 HTTP/1.1.\n\n**Self-Delete Command**\nping 127.0.0.7 –n 7 > Nul & fsutil file setZeroData offset=0 length=<Stealbit file size>< Stealbit\nfile path > & Del /f /q <Stealbit executable>\n\n**Named Pipe**\nSTEALBIT-MASTER-PIPE\n\n## Information Requested:\n\nThe FBI is seeking any information that can be shared, to include boundary logs showing\ncommunication to and from foreign IP addresses, a sample ransom note, communications with\nthe threat actors, Bitcoin wallet information, the decryptor file, and/or a benign sample of an\nencrypted file. The FBI does not encourage paying ransoms. Payment does not guarantee files\nwill be recovered. It may also embolden adversaries to target additional organizations,\nencourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit\nactivities. However, the FBI understands that when victims are faced with an inability to\nfunction, all options are evaluated to protect shareholders, employees and customers.\nRegardless of whether you or your organization have decided to pay the ransom, the FBI urges\nyou to promptly report ransomware incidents to your local field office and/or file a complaint\non www.ic3.gov. Doing so provides the FBI with critical information needed to prevent future\n\n\n-----\n\nattacks by identifying and tracking ransomware attackers and holding them accountable under\nUS law.\n\n## Recommended Mitigations:\n\nFBI recommends network defenders apply the following mitigations to reduce the risk of\ncompromise by LockBit 2.0 ransomware:\n\n  - **Require all accounts with password logins (e.g., service account, admin accounts, and**\n\n**domain admin accounts) to have strong, unique passwords. Passwords should not be**\nreused across multiple accounts or stored on the system where an adversary may have\naccess. Note: Devices with local administrative accounts should implement a password\npolicy that requires strong, unique passwords for each individual administrative\naccount.\n\n  - **Require multi-factor authentication for all services to the extent possible, particularly**\n\nfor webmail, virtual private networks, and accounts that access critical systems.\n\n  - **Keep all operating systems and software up to date. Prioritize patching known**\n\nexploited vulnerabilities. Timely patching is one of the most efficient and cost-effective\nsteps an organization can take to minimize its exposure to cybersecurity threats.\n\n  - **Remove unnecessary access to administrative shares, especially ADMIN$ and C$. If**\n\nADMIN$ and C$ are deemed operationally necessary, restrict privileges to only the\nnecessary service or user accounts and perform continuous monitoring for anomalous\nactivity.\n\n  - **Use a host-based firewall to only allow** connections to administrative shares via server\n\nmessage block (SMB) from a limited set of administrator machines.\n\n  - **Enable protected files in the Windows Operating System to prevent unauthorized**\n\nchanges to critical files.\n\nAdversaries use system and network discovery techniques for network and system visibility and\nmapping. To limit an adversary from learning the organization’s enterprise environment, limit\ncommon system and network discovery techniques by taking the following actions:\n\n  - **Segment networks to prevent the spread of ransomware. Network segmentation can**\n\nhelp prevent the spread of ransomware by controlling traffic flows between—and\naccess to—various subnetworks and by restricting adversary lateral movement.\n\n  - **Identify, detect, and investigate abnormal activity and potential traversal of the**\n\n**indicated ransomware with a networking monitoring tool. To aid in detecting the**\nransomware, implement a tool that logs and reports all network traffic, including lateral\nmovement activity on a network. Endpoint detection and response (EDR) tools are\nparticularly useful for detecting lateral connections as they have insight into common\nand uncommon network connections for each host.\n\n\n-----\n\n  - **Implement time-based access for accounts set at the admin level and higher. For**\n\nexample, the Just-in-Time (JIT) access method provisions privileged access when needed\nand can support enforcement of the principle of least privilege (as well as the Zero Trust\nmodel). This is a process where a network-wide policy is set in place to automatically\ndisable admin accounts at the AD level when the account is not in direct need. When\nthe account is needed, individual users submit their requests through an automated\nprocess that enables access to a system, but only for a set timeframe to support task\ncompletion.\n\n  - **Disable command-line and scripting activities and permissions. Privilege escalation and**\n\nlateral movement often depend on software utilities that run from the command line. If\nthreat actors are not able to run these tools, they will have difficulty escalating\nprivileges and/or moving laterally.\n\n  - **Maintain offline backups of data, and regularly maintain backup and restoration. This**\n\npractice will ensure the organization will not be severely interrupted, have irretrievable\ndata.\n\n  - **Ensure all backup data is encrypted, immutable (i.e., cannot be altered or deleted) and**\n\ncovers the entire organization’s data infrastructure.\n\n## Additional Resources\n\nFor additional resources related to the prevention and mitigation of ransomware, go to\nhttps://www.stopransomware.gov as well as the CISA-Multi-State Information Sharing and\nAnalysis Center (MS-ISAC) Joint Ransomware Guide. Stopransomware.gov is the Government’s\nofficial one-stop location for resources to tackle ransomware more effectively.\n\nCISA’s Ransomware Readiness Assessment (RRA) is a no-cost self-assessment based on a tiered\nset of practices to help organizations better assess how well they are equipped to defend and\nrecover from a ransomware incident.\n\nCISA offers a range of no-cost cyber hygiene services to help critical infrastructure organizations\nassess, identify, and reduce their exposure to threats, including ransomware. By requesting\nthese services, organizations of any size could find ways to reduce their risk and mitigate attack\nvectors.\n\n\n-----\n\n## Reporting Notice\n\nThe FBI encourages recipients of this document to report information concerning suspicious or\ncriminal activity to their local FBI field office. With regards to specific information that appears\nin this communication; the context, individual indicators, particularly those of a nondeterministic or ephemeral nature (such as filenames or IP addresses), may not be indicative of\na compromise. Indicators should always be evaluated in light of your complete information\nsecurity situation.\n\nField office contacts can be identified at www.fbi.gov/contact-us/field-offices. When available,\neach report submitted should include the date, time, location, type of activity, number of\npeople, and type of equipment used for the activity, the name of the submitting company or\norganization, and a designated point of contact.\n\n## Administrative Note\n\nThis product is marked TLP:WHITE. Subject to standard copyright rules, the information in this product\nmay be shared without restriction.\n\n\n### Your Feedback Regarding this Product is Critical\n\n#### Was this product of value to your organization? Was the content clear and concise?  Your comments are very important to us and can be submitted anonymously. Please take a moment to complete the survey at the link below. Feedback should be specific to your experience with our written products to enable the FBI to make quick and continuous improvements to such products. Feedback may be submitted online here:\n\n## https://www.ic3.gov/PIFSurvey\n\n#### Please note that this survey is for feedback on content and value only. Reporting of technical information regarding FLASH reports must be submitted through your local FBI office.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.ic3.gov/Media/News/2022/220204.pdf"
    ],
    "report_names": [
        "220204.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1643971108,
    "ts_modification_date": 1643974136,
    "files": {
        "pdf": "https://archive.orkl.eu/ab0989ee9b8e22bfb7221921e2a8717653e43251.pdf",
        "text": "https://archive.orkl.eu/ab0989ee9b8e22bfb7221921e2a8717653e43251.txt",
        "img": "https://archive.orkl.eu/ab0989ee9b8e22bfb7221921e2a8717653e43251.jpg"
    }
}