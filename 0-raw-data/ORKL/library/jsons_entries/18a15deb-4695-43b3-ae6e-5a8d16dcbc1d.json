{
    "id": "18a15deb-4695-43b3-ae6e-5a8d16dcbc1d",
    "created_at": "2023-01-12T15:00:49.735121Z",
    "updated_at": "2025-03-27T02:14:42.831057Z",
    "deleted_at": null,
    "sha1_hash": "0dba4f94c5f8bb3165460f40dd960a253b06f954",
    "title": "2017-12-08 - StrongPity2 spyware replaces FinFisher in MitM campaign – ISP involved-",
    "authors": "",
    "file_creation_date": "2022-05-28T03:41:00Z",
    "file_modification_date": "2022-05-28T03:41:00Z",
    "file_size": 192730,
    "plain_text": "# StrongPity2 spyware replaces FinFisher in MitM campaign – ISP involved?\n\n**[welivesecurity.com/2017/12/08/strongpity-like-spyware-replaces-finfisher/](https://www.welivesecurity.com/2017/12/08/strongpity-like-spyware-replaces-finfisher/)**\n\nDecember 8, 2017\n\nAs we reported in September, in campaigns we detected in two different countries, man-inthe-middle attacks had been used to spread FinFisher, with the “man” in both cases most\nlikely operating at the ISP level.\n\n[Filip Kafka](https://www.welivesecurity.com/author/fkafka/)\n8 Dec 2017 - 02:58PM\n\n\n-----\n\nAs we reported in September, in campaigns we detected in two different countries, man-inthe-middle attacks had been used to spread FinFisher, with the “man” in both cases most\nlikely operating at the ISP level.\n\nContinuing our research into FinFisher – the infamous spyware known also as FinSpy and\nsold to governments and their agencies worldwide – we noticed that the FinFisher malware\nin our previously-documented campaign, which had strong indicators of internet service\nprovider (ISP) involvement, had been replaced by different spyware. Detected by ESET as\nWin32/StrongPity2, this spyware notably resembles one that was attributed to the group\ncalled StrongPity. As well as detecting and blocking this threat, all ESET products –\n[including the free ESET Online Scanner – thoroughly clean systems compromised by](https://www.eset.com/int/home/online-scanner/)\nStrongPity2.\n\nAs we reported in September, in campaigns we detected in two different countries, Man-inthe-Middle (MitM) attacks had been used to spread FinFisher, with the “man” in both cases\nmost likely operating at the ISP level. According to our telemetry, those campaigns were\nterminated on 21 September 2017 – the very day we published our research.\n\nOn 8 October 2017, the same campaign resurfaced in one of those two countries, using the\nsame (and very uncommon) structure of HTTP redirects to achieve “on-the-fly” browser\nredirection, only this time distributing Win32/StrongPity2 instead of FinFisher. We analyzed\nthe new spyware and immediately noticed several similarities to malware allegedly operated\nby the StrongPity group in the past.\n\nThe first similarity is the attack scenario – users trying to download a software installation\npackage were being redirected to a fake website serving a trojanized version of the\nexpected installation package. The StrongPity group was observed performing such\nwatering hole attacks in the summer of 2016, targeting mostly Italian and Belgian users of\nencryption software.\n\nDuring our research, we found several different software packages trojanized with\nWin32/StrongPity2:\n\nCCleaner v 5.34\nDriver Booster\nThe Opera Browser\nSkype\nThe VLC Media Player v2.2.6 (32bit)\nWinRAR 5.50\n\nSince the beginning of the campaign, our systems have recorded more than one hundred\ndetections of this malware.\n\n\n-----\n\nWe found a number of other similarities between StrongPity-operated malware, and the way\nin which Win32/StrongPity2 is implemented:\n\nSome parts of the code are exactly the same\nThe (not exactly common) structures of their configuration files share some notable\nsimilarities, as shown in Figure 1:\n\nFigure 1: Configuration file samples (top: StrongPity, bottom: StrongPity2)\n\nBoth use the same obfuscation algorithm (a very uncommon Byte ^= ((Byte & 0xF0)\n>> 4)\nBoth use the same (quite old) libcurl version 7.45\nBoth exfiltrate files in the same way (the main payload handles exfiltration of files\npreviously collected and saved by a dedicated module)\n\nSpeaking of stealing data, Win32/StrongPity2 has several file types with the following\nextensions in its crosshairs:\n\n.ppt\n.pptx\n.xls\n.xlsx\n.txt\n.doc\n.docx\n.pdf\n.rtf\n\nWhile searching for these files, it avoids the following folders:\n\n%Windows%\n%Windows.old%\n%AppData%\n%Program Files%\n\n\n-----\n\n%Program Files (x86)%\n%ProgramData%\n\nIn addition to data exfiltration, Win32/StrongPity2 is able to download and execute virtually\nany other (malicious) software of the attacker’s choice, with the privileges held by the\ncompromised account.\n\n## How to check your system for compromise, how to clean it and how to stay protected\n\nTo determine whether a system is infected with Win32/StrongPity2, the system can be\nscanned using the free ESET Online Scanner. If Win32/StrongPity2 is detected this tool is\nable to remove it.\n\nIt is also possible to check the system manually by verifying the existence of the folder\n\n%temp%\\lang_be29c9f3-83we, which the malware creates to stores its components, with\nthe file wmpsvn32.exe being the main one. Another easy-to-check indicator of compromise\nis the presence of Registry string value located in the path\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, named Help Manager with the\nstring\n\n%temp%\\lang_be29c9f3-83we\\wmpsvn32.exe in its data field:\n\nFigure 2: Registry entry used by the malware to gain persistence\n\nManual clean-up of an infected system includes the following steps:\n\n1. Killing the main component’s process, wmpsvn32.exe\n2. Deleting the folder %temp%\\lang_be29c9f3-83we and all its contents\n3. Deleting the ‘Help Manager’ value in the above-mentioned Registry entry\n\nIt is important to note that for real-time, continuous protection we recommend using a\nreputable multi-layered internet security suite.\n\n**Special thanks to Ivan Besina for his help with the research for this article.**\n\n\n-----\n\n### IoCs\n\n**Hashes of analyzed samples:**\n\n4ad3ecc01d3aa73b97f53e317e3441244cf60cbd\n\n8b33b11991e1e94b7a1b03d6fb20541c012be0e3\n\n49c2bcae30a537454ad0b9344b38a04a0465a0b5\n\ne17b5e71d26b2518871c73e8b1459e85fb922814\n\n76fc68607a608018277afa74ee09d5053623ff36\n\n87a38a8c357f549b695541d603de30073035043d\n\n9f2d9d2131eff6220abaf97e2acd1bbb5c66f4e0\n\nf8009ef802a28c2e21bce76b31094ed4a16e70d6\n\na0437a2c8c50b8748ca3344c38bc80279779add7\n\n**Domain serving the software packages trojanized by Win32/StrongPity2**\n\nhxxps://downloading.internetdownloading.co\n\n**URLs used to exfiltrate stolen data**\n\nhxxps://updserv-east-cdn3.com/s3s3sxhxTuDSrkBQb88wE99Q.php\n\nhxxps://updserv-east-cdn3.com/kU2QLsNB6TzexJv5vGdunVXT.php\n\nhxxps://updserv-east-cdn3.com/p55C3xhxTuD5rkBQbB8wE99Q.php\n\n**Folder created by the malware to store its components**\n\n%temp%\\lang_be29c9f3-83we\n\n8 Dec 2017 - 02:58PM\n\n\n-----\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-08 - StrongPity2 spyware replaces FinFisher in MitM campaign – ISP involved-.pdf"
    ],
    "report_names": [
        "2017-12-08 - StrongPity2 spyware replaces FinFisher in MitM campaign – ISP involved-.pdf"
    ],
    "threat_actors": [
        {
            "id": "67fbc7d7-ba8e-4258-b53c-9a5d755e1960",
            "created_at": "2022-10-25T16:07:24.077859Z",
            "updated_at": "2025-03-27T02:02:10.101173Z",
            "deleted_at": null,
            "main_name": "Promethium",
            "aliases": [
                "APT-C-41",
                "Promethium",
                "StrongPity"
            ],
            "source_name": "ETDA:Promethium",
            "tools": [
                "StrongPity",
                "StrongPity2",
                "StrongPity3",
                "Truvasys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cbede712-4cc3-47c6-bf78-92fd9f1beac6",
            "created_at": "2022-10-25T15:50:23.777222Z",
            "updated_at": "2025-03-27T02:00:55.544919Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "PROMETHIUM",
                "StrongPity"
            ],
            "source_name": "MITRE:PROMETHIUM",
            "tools": [
                "Truvasys",
                "StrongPity"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4660477f-333f-4a18-b49b-0b4d7c66d482",
            "created_at": "2023-01-06T13:46:38.511962Z",
            "updated_at": "2025-03-27T02:00:02.852307Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "StrongPity",
                "G0056"
            ],
            "source_name": "MISPGALAXY:PROMETHIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535649,
    "ts_updated_at": 1743041682,
    "ts_creation_date": 1653709260,
    "ts_modification_date": 1653709260,
    "files": {
        "pdf": "https://archive.orkl.eu/0dba4f94c5f8bb3165460f40dd960a253b06f954.pdf",
        "text": "https://archive.orkl.eu/0dba4f94c5f8bb3165460f40dd960a253b06f954.txt",
        "img": "https://archive.orkl.eu/0dba4f94c5f8bb3165460f40dd960a253b06f954.jpg"
    }
}