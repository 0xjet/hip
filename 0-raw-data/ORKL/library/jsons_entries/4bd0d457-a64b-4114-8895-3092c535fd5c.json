{
    "id": "4bd0d457-a64b-4114-8895-3092c535fd5c",
    "created_at": "2023-01-12T15:07:27.521123Z",
    "updated_at": "2025-03-27T02:06:05.903479Z",
    "deleted_at": null,
    "sha1_hash": "c2ead87ba48644f8d75f7d532be7fcbfda6786e1",
    "title": "2019-03-27 - PsiXBot- The Evolution Of A Modular .NET Bot",
    "authors": "",
    "file_creation_date": "2022-05-27T19:09:17Z",
    "file_modification_date": "2022-05-27T19:09:17Z",
    "file_size": 518273,
    "plain_text": "# PsiXBot: The Evolution Of A Modular .NET Bot\n\n**[blog.fox-it.com/2019/03/27/psixbot-the-evolution-of-a-modular-net-bot/](https://blog.fox-it.com/2019/03/27/psixbot-the-evolution-of-a-modular-net-bot/)**\n\n## Summary\n\n\nMarch 27, 2019\n\n\nIn this blog we will share our analysis of a modular piece of malware which is referred to by the author as\nPsiXBot. The malware first surfaced in 2017 but has recently undergone significant developments of its core\nand modules, which include the logging of keystrokes and stealing of Outlook and browser credentials. With\nthese new developments done and the first large scale distributions observed in the wild, PsiXBot has\nofficially made its debut in the malware ecosystem.\n\n## Introduction\n\nFox-IT actively monitors cyber criminal activity on a daily basis in order to proactively identify threats that are\nrelevant to our customers. On the 21st of February 2019 we noticed SmokeLoader, a popular bot used to\ninstall additional malware on infected machines for a fee, push a task in order to distribute a .NET malware\nsample. Further research on the sample revealed a bot with a modular nature and capabilities, such as\nstealing data from infected hosts as well as receiving download & execute tasks. Our interest was further\n[peaked when the Spelevo Exploit Kit started distributing the same malware on the 16th of March at which](http://www.malware-traffic-analysis.net/2019/03/16/index.html)\npoint we decided to further investigate this piece of malware, resulting in the findings below.\n\nHaving seen it evolve since 2017 to now getting out from beta versioning, we observe its being distributed by\nmultiple infection vectors, such as exploit kits and malware loaders.\n\n\n-----\n\n## Analysis\n\n[During routine threat research activity, we stumbled upon a tweet on what seemed to be an early version of](https://twitter.com/James_inthe_box/status/1035209707244244997)\n[the malware known as PsiXBot. In the same Twitter thread a link was also shared to a very early version of](https://twitter.com/mesa_matt/status/1035213536258080768)\nthat same malware.\n\nAn overview of the versions are found below:\n\nMid 2017: First version spotted in the wild (SHA256:\n_d2ee07bf04947cac64cc372123174900725525c20211e221110b9f91b7806332);_\nAugust 2018: Updated version spotted (SHA256:\n_ce0e46fa1c5b463ed4a070a05594a79203ed2dd5df96cece9f875e2957fda4fa);_\nEarly 2019: The latest version is now being distributed via different infection vectors (SHA256:\n_ca30c42334fcc693320772b4ce1df26fe5f1d0110bc454ec6388d79dffea4ae8)._\n\nThe illustration below displays the code structure of the versions: the first version to the left and the most\nrecent one to the right.\n\n\n-----\n\nNote that the name PsiX is derived from the name of the assembly. Taking a look to the PDB path, the same\nnaming is again present: `G:\\WORK\\MONEY\\BOT\\NoName\\PsiX\\obj\\Release\\NoNameBot.pdb`\n\nAdditionally, taking a look at the sample displayed in the center of the image above, the name “Radius” can\nbe spotted as well. Part or whole name can be also observed among the C&Cs such as: `radcall.bit,`\n```\nradbot.bit and rrradiusspace.bit .\n\n```\nThe differences we observed across the versions are mostly:\n\nNew commands supported by adding different modules;\nEncryption of the strings with AES;\n\n\n-----\n\nVersion number updated from `Beta 1.0.0 to` `1.0.1 .`\n\nThe analysis below is centered on the most recent version.\n\nAs you could have already seen, the malware is written in .NET and it is not obfuscated. Typically it’s\ndistributed within a dropper which hides the main payload. Once executed the Main() function is invoked. It\nfirst verifies that it is the only running instance by looking to a hardcoded mutex (for the sample analyzed:\n```\ngfdhfyf543543cdsdfsdf ), then it executes a loop to mimic sleep function before activating.\n\n```\nMost of the strings are encrypted with AES by a hardcoded string key. For this sample the key is:\n\n```\n1243hewqr8n1220g321&amp;^*&amp;^Tb0\n\n```\n\nThe malware also checks the language settings of the victim, if the language is set to `ru-RU (Russian) the`\nmalware will exit. For all other language settings the malware will continue its malicious activity.\n\nAn additional check is relating the filename to ensure it is matching the one configured. In instances where it\nis not, it proceeds with the installation process, which is done by invoking the CopyEx method via WMI and\ninvoking the copied binary again via WMI. The installation path is: `Local\\Microsoft\\.exe in the`\n```\n%APPDATA% folder.\n\n```\nAfter the installation the malware contacts the configured C&Cs, that are initialized by the following code:\n\n[code lang=c]\npublic static string[] valid = new string[]\n{\n\"pppoe.bit\",\n\"weather0.bit\",\n\"mygranny.bit\",\n\"six6.bit\",\n\"learncpp.bit\"\n};\n\n[/code]\n\nIn order to communicate with the .bit domains it uses hardcoded DNS servers ( 193.37.213.223 for the\nsample used in this analysis). Upon the DNS resolution, it sends a ping to the C&Cs in order to identify the\nfirst one that is up.\n\nThe bot reports to its C&C some information gathered from the infected host. An example of the string used\nin the request is:\n\n[code lang=text]\naction=call&user_name=john&bot_id=D63BAFF79F3A3504C70DC3298EE74C68&av=N/A&os_major=Microsoft\nWindows 7 Home Basic N &permissions=User&os_bit=64&cpu=Intel(R) Core(TM) i7-6820HQ CPU @\n2.70GHz&gpu=Standard VGA Graphics\nAdapter&ram=2048&hdd=C:12345/67890&version=1.0.1&user_group=Admin&pc_net=4.0\n\n[/code]\n\nThe meaning of the parameters are:\n\n_action: the purpose of the request;_\n_user_name: username of the victim’s host;_\n_bot_id: unique string to identify the infected host;_\n_av: name of the AntiVirus software installed;_\n\n\n-----\n\n_os_major: name of the OS installed;_\n_permissions: username’s permissions;_\n_os_bit: OS architecture;_\n_cpu: CPU model;_\n_gpu: GPU model;_\n_ram: RAM available;_\n_hdd: HDD Serial Number;_\n_version: version number of the malware (latest one is 1.0.1);_\n_user_group: User group name the username is part of;_\n_pc_net: version of .NET framework installed._\n\nThe data transfer is encrypted with RC4 using a hardcoded key which for this sample is\n```\n63a6a2eea47f74b9d25d50879214997a . It is interesting to note that the author encrypted most of the\n\n```\nstrings, except the RC4 encryption key, C&Cs and DNS servers which are in plain-text.\n\nThe C&C answers with a JSON string, like the following one:\n\n[code lang=c]\n{\nresult_code: [\n{\n\"result_code\": \"200\",\n}\n]\n}\n\n[/code]\n\nIf the server returns a valid response, the malware sleeps for 95 seconds before requesting a new command\nto execute. This is done by sending the data:\n\n[code lang=text]\naction=command&bot_id=D63BAFF79F3A3504C70DC3298EE74C68\n\n[/code]\n\nAn example of a response is the following one:\n\n[code lang=c]\n{\n\"result_code\": [\n{\n\"result_code\": \"200\"\n}\n],\n\"commands\": [\n{\n\"command_id\": \"1485\",\n\"command_action\": \"GetSteallerPasswords\",\n\"command_data\": \"\",\n\"command_arg\": \"\"\n},\n{\n\n\n-----\n\ncommand_id : 1486,\n\"command_action\": \"StartSchedulerModule\",\n\"command_data\": \"\",\n\"command_arg\": \"\"\n}\n]\n}\n\n[/code]\n\nIn the example above the C&C asks for the execution of two commands. The `command_action value is the`\nexact name of the method that must be invoked. The malware will resolve the method dynamically in\naccordance to this value. In order to avoid hardcoded strings, the author implemented an easy way to\nupgrade the malware: if the method name sent by the C&C is not present in the malware during execution,\nthe method/call is simply ignored.\nFor one particular method invocation the malware uses a type named SukaBlyat, which is an offensive term\nused as Russian slang.\n\nThe two received commands are used in order to ask the C&C server for additional modules. The data\ntransfered requesting the module is:\n\n[code lang=text]\naction=module&bot_id=D63BAFF79F3A3504C70DC3298EE74C68&module_action=SchedulerModule\n\n[/code]\n\nSubsequently, the module is downloaded and executed, while sending the following command:\n\n[code lang=text]\naction=result&command_id=1485&command_result=6E756C6C\n\n[/code]\n\nThe commands currently supported are:\n\n[code lang=text]\nDownload\nDownloadAndExecute\nExecute\nGetInstalledSoft\nGetKeylogs\nGetOutlook\nGetProcessesList\nGetScreenShot\nGetSteallerCookies\nGetSteallerPasswords\nStartAndroidModule\nStartBTC\nStartComplexModule\nStartKeylogger\nStartNewComplexModule\nStartSchedulerModule\nStopProcess\n\n[/code]\n\n\n-----\n\n## Modules\n\nThe modules available for this recent version of the bot are:\n\n_BrowserModule (assembly name stMod.exe): used to dump passwords or cookies from a variety of_\nbrowsers as well as from FileZilla FTP client. It accepts an argument to specify which is the data to be\ndumped: `-passes for the password or` `-cookies for the cookies. The program returns a string with`\nall the stolen information. It seems to be based on the QuasarRAT project;\n_BTCModule (assembly name LESHI.exe): accepts an argument and a cryptocurrency address. The_\nsupported address types are: `-btc,` `-ether,` `-ltc,` `-monero and` `-ripple . Once such an`\naddress is configured, the program proceeds to monitor the clipboard every 3 seconds and verifies if\nthe copied text is a valid address and of which type. If the check is successful the malware replaces the\ntext with one of the configured wallet addresses;\n\n_ComplexModule (assembly name Client.exe): an old version of the open source rat QuasarRAT. In_\nparticular the xclient string (which is part of this module namespace) was present in a fork from 2016\n(see `https://github.com/GeekGalaxy/QuasarRAT ). Also within the decompiled source code we`\nretrieved the type name QuasarClient;\n\n_KeyLoggerModule (assembly name KeyLoggerModule.exe): uses the SetWindowsHookEx API in order_\nto set a global hook and intercept keystrokes. The intercepted keys are saved in a file named\n```\n   Logger.log ;\n\n```\n_NewComplexModule (assembly name RemoteClient.exe): implements a remote desktop like program._\nIt allows streaming the desktop user, interacting with it and starting the browser. The code does not\nseem to be anything publicly available;\n\n_OutlookModule (assembly name OutlookPasswordRecovery.dll): dumps the Outlook passwords and_\nreturns a string with the information retrieved.\n\n_SchedulerModule (assembly name Scheduler.exe): used to ensure persistence. It just creates a_\nscheduled task to run the bot each 60 seconds.\n\n## Distribution\n\nTypically, there are two ways of spreading such a strain of malware: infecting new unwitting victims and\nleveraging existing compromised systems. Fox-IT observes the PsiXBot actors are able to do both –\ndelivering their malware via malspam campaigns or exploit kits (such as the Spelevo Exploit Kit) as well as\nusing services offered on underground markets to load malware on (pre-infected) devices such as\nSmokeLoader.\n\n### SmokeLoader\n\nThe SmokeLoader bot from which we received the task to distribute the PsiXBot malware was configured\nwith the below metadata:\n\n[code lang=text]\n\nserver_rc4_key_recv e097b3a6\n\nserver_rc4_key 40e5223b\n\nbot_version 2018\n\nseller new1\n\n\n-----\n\nc&c [http://5gssghhs2w.org/2/](http://5gssghhs2w.org/2/)\nc&c [http://dvhwzq.ru/2/](http://dvhwzq.ru/2/)\nc&c [http://hdxaet.ru/2/](http://hdxaet.ru/2/)\nc&c [http://hghwwgh6.info/2/](http://hghwwgh6.info/2/)\nc&c [http://jdcbhs.ru/2/](http://jdcbhs.ru/2/)\nc&c [http://kdcbst.ru/2/](http://kdcbst.ru/2/)\nc&c [http://kkted54d.ru/2/](http://kkted54d.ru/2/)\nc&c [http://si3213gher.com/2/](http://si3213gher.com/2/)\nc&c [http://vshmesz.com/2/](http://vshmesz.com/2/)\nc&c [http://vygxxhh.bit/2/](http://vygxxhh.bit/2/)\n\n[/code]\n\nThe distribution URL sent by SmokeLoader‘s task is:\n\n```\nhxxp://favoritfile.in/7-8.exe\n\n```\n\nFrom the referenced distribution URL we managed to download the sample with SHA256:\n_9b8c0c82fe79ae15e0f723d6aa267d38d359a7260613a091a2d70d770488e919_\n\nThe C&Cs of this sample are:\n\n[code lang=text]\nmyauto.bit\nsokoban.bit\n\n[/code]\n\n### Spelevo Exploit Kit\n\nWith regards to the Spelevo Exploit Kit, the sample distributed is identified by SHA256:\n_ca30c42334fcc693320772b4ce1df26fe5f1d0110bc454ec6388d79dffea4ae8_\n\nThe C&C servers of this sample are:\n\n[code lang=text]\n\nlearncpp.bit\n\nmygranny.bit\n\npppoe.bit\n\nsix6.bit\n\nweather0.bit\n\n[/code]\n\nAnother distribution vector observed is spam mailings. One of the spam campaigns we managed to identify\nis Italian themed, with the following metadata:\n\n[code lang=text]\n\nReceiver from pecfe04.sogei.it (pecfe04.sogei.it [26.2.42.237]) by PECP-BE02 (lmtpd) with LMTP id\n28663.002; Tue, 8 Jan 2019 16:22:51 +0100 (CET)\n\nReceiver from PECP-FE04 ([127.0.0.1]) by pecfe04.sogei.it (Dovecot) with LMTP id\n474fM6e/NFysCAAAxEz/xA ; Tue, 08 Jan 2019 16:22:51 +0100\n\nReceiver from mx.pec.sogei.it (localhost [127.0.0.1]) by smtps.pec.sogei.it (Postfix) with ESMTP id\n43YwxQ6pm5zgYCT for <protocollo@pec.agenziariscossione.gov.it>; Tue, 8 Jan 2019 16:22:50 +0100\n(CET)\n\n\n-----\n\nReceiver from smtps.pec.aruba.it (smtpecgo01.pec.aruba.it [80.88.94.21]) by mx.pec.sogei.it (Postfix) with\nESMTPS for <protocollo@pec.agenziariscossione.gov.it>; Tue, 8 Jan 2019 16:22:50 +0100 (CET)\nReceiver from avvocatismcv.com (ipvspec1.pec.ad.aruba.it [62.149.152.1]) by smtps.pec.aruba.it (Postfix)\nwith ESMTPSA id 43YwxQ2V8Sz2L7hcc; Tue, 8 Jan 2019 16:22:50 +0100 (CET)\nReply-To luigi.ferrandino@avvocatismcv.com\nReturn-Path luigi.ferrandino@avvocatismcv.com\nAttachments [\"daticert.xml\", \"Nuovi_contratti_2019__145038.zip\", \"smime.p7s\"]\nNumber_of_attachments 3\nDate 2019-01-08 15:22:50 (UTC)\nTo [\"luigi.ferrandino@avvocatismcv.com\"]\nFrom \"Per conto di: luigi.ferrandino@avvocatismcv.com\" <posta-certificata@pec.aruba.it>\nSubject POSTA CERTIFICATA: Re: Notificazione ai sensi della legge n. 53 del 1994\n\n[/code]\n\nThe zip contained a JavaScript (SHA256:\n_e4006cde4a96048ff25727459abfae0ffd37985d04581793be784d7cf50e32d7) which, once executed, tried to_\nfetch the next stage from the following URL:\n\n```\nhxxp://img.martatovaglieri.it/index?83836\n\n```\n\nThe binary downloaded from this URL can be identified with SHA256:\n_db1f57ffd6c58e1d40823e2c8834e45a67271557ceaa1b3bcccf4feab83243a1._\n\nThe C&C of this sample is:\n\n[code lang=text]\nanyname.bit\n\n[/code]\n\n## Panel\n\nThe screenshot below shows PsiXBot’s login panel:\n\n\n-----\n\nThe following noteworthy code is inside the HTML:\n\n```\n<!-- saved from url=(0043)hxxps://kyrkymalol.000webhostapp.com/admin/ -->\n\n```\n\n## IOCs\n\nThe most relevant malware hashes can be found below:\n\n[code lang=text]\n\nPsiXBot first version: d2ee07bf04947cac64cc372123174900725525c20211e221110b9f91b7806332\n\nPsiXBot updated version: ce0e46fa1c5b463ed4a070a05594a79203ed2dd5df96cece9f875e2957fda4fa\n\nPsiXBot latest version: ca30c42334fcc693320772b4ce1df26fe5f1d0110bc454ec6388d79dffea4ae8\n\nBrowserModule: 6a9841b7e19024c4909d0a0356a2eeff6389dcc1e2ac863e7421cca88b94e7e0\n\nSchedulerModule: 6e123ce5c7c48132f057428c202638eb9d0e4daa690523619316a9f72b69d17f\n\nBTCModule: 3846fcfdc6414685efd217a88613ed3383a61f8313a0aa7ecdcde8ed99c8ebac\n\nKeyLoggerModule: 7bac9b3b5598059db770cdeee74f0b1cf3078c2cb54cc2fcd18ae811d42a5d63\n\nComplexModule: 0f931fec3fd436d974d767f84f66b44f6f2fc168d9e6d77b2aa2e9d3bf4cd604\n\nNewComplexModule: a5edab1596346358c8899b9f81ec49b0560da929327e0ef08ab51dcb277c9b70\n\nOutlookModule: b01fbb8cfeb16c4232fddea6dea53212a57e73ef32ee20056cd69d29570bf55c\n\n[/code]\n\n[The full set of indicators of compromise can be found on our GitHub page.](https://github.com/fox-it/psixbot)\n\nMore information on the threat actors behind PsiXBot is available for InTELL customers on Fox-IT’s\ncybercrime portal.\n\n[Stefano Antenucci &](https://twitter.com/Antelox) [Antonio Parata (Fox-IT InTELL)](https://twitter.com/s4tan)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-27 - PsiXBot- The Evolution Of A Modular .NET Bot.pdf"
    ],
    "report_names": [
        "2019-03-27 - PsiXBot- The Evolution Of A Modular .NET Bot.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536047,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653678557,
    "ts_modification_date": 1653678557,
    "files": {
        "pdf": "https://archive.orkl.eu/c2ead87ba48644f8d75f7d532be7fcbfda6786e1.pdf",
        "text": "https://archive.orkl.eu/c2ead87ba48644f8d75f7d532be7fcbfda6786e1.txt",
        "img": "https://archive.orkl.eu/c2ead87ba48644f8d75f7d532be7fcbfda6786e1.jpg"
    }
}