{
    "id": "55880ab8-60e2-4470-9e00-395735a69244",
    "created_at": "2023-05-06T02:09:22.60885Z",
    "updated_at": "2025-03-27T02:15:27.717387Z",
    "deleted_at": null,
    "sha1_hash": "970adc670444ed46f210358f796a0d294df042a8",
    "title": "2023-03-23 - Emerging Threats- AgentTesla – A Review and Detection Strategies",
    "authors": "",
    "file_creation_date": "2023-05-05T01:53:24Z",
    "file_modification_date": "2023-05-05T01:53:24Z",
    "file_size": 578584,
    "plain_text": "# Emerging Threats: AgentTesla – A Review and Detection Strategies\n\n**[logpoint.com/en/blog/agentteslas-capabilities-review-detection-strategies/](https://www.logpoint.com/en/blog/agentteslas-capabilities-review-detection-strategies/)**\n\nAnish Bogati March 23, 2023\n\n[AgentTesla [S0331] a.k.a Negasteal is a .NET-based Remote Administrator Tool (RAT) first](https://attack.mitre.org/software/S0331/)\n[detected in 2014. It is advertised as a Remote Administrator Tool since then. AgentTesla](https://web.archive.org/web/20141229031637/http://agenttesla.com/)\nallows adversaries to remotely control the systems of victims and manipulate them\naccordingly, so it is utilized by numerous threat actors such as [SILVERTERRIER,](https://www.paloaltonetworks.com/apps/pan/public/downloadResource?pagePath=/content/pan/en_US/resources/whitepapers/unit42-silverterrier-rise-of-nigerian-business-email-compromise) [SWEED,](https://malpedia.caad.fkie.fraunhofer.de/actor/sweed)\n[Aggah, etc.](https://yoroi.company/research/serverless-infostealer-delivered-in-est-european-countries/)\n\nInitially, it only had remote administrator capabilities but after various iterations and\nupgrades, recent variations are capable of spying on victim systems, capturing sensitive data\nsuch as credentials, and users’ actions by recording screen and keylogging, stealing\ncredentials from browsers and mail clients, and exfiltrate those collected data using various\ntechniques. The interesting part is, it has the capability to extract data from a large number of\nbrowsers and mail clients and utilizes various protocols to exfiltrate those data. The malware\n[utilizes various obfuscation techniques such as software packing [T1027.002], and encoded](https://attack.mitre.org/techniques/T1027/002/)\n[payloads [T1027] to evade defense.](https://attack.mitre.org/techniques/T1027/)\n\nAnish Bogati\nGlobal Services and Security Research\n\n\n-----\n\n[Download report](https://www.logpoint.com/wp-content/uploads/2023/03/et-agenttesla.pdf)\n[It has been spreading rapidly in the wild with CISA listing it in the Top Malware Strains list for](https://www.cisa.gov/uscert/ncas/alerts/aa22-216a)\n[the year 2021 and it still is in the top 10 list on MalwareBazaar as of March 2023.](https://bazaar.abuse.ch/statistics/)\n\nSource - [MalwareBazaar](https://bazaar.abuse.ch/statistics/)\n\n\n-----\n\nThe operators of AgentTesla are providing Malware-as-a-Service with various pricing options\nfor different versions of the malware. During the year 2017, the malware’s website was\navailable on the public internet (now on the dark web), and advertising about the RAT\ncapabilities with various price ranges and features.\n\n[AgentTesla Marketing Site, 2017 Source - WebArchieve](http://web.archive.org/web/20170911120838/https://www.agenttesla.com/buy)\n\nThe price shown above has likely been changed. It is provided for reference purposes purely\nto show that AgentTesla provides multiple buying options and operates a business-like\nmodel. AgentTesla has been used in numerous campaigns by multiple threat actors as it is\navailable to be bought at various price ranges with various capabilities and support from the\noperators. In 2022, [CERT-UA discovered AgentTesla being deployed in their state](https://cert.gov.ua/article/861292)\n[organization systems through phishing attachments [T1566.001]. Besides Ukraine, the](https://attack.mitre.org/techniques/T1566/001/)\nAgentTesla malware was also seen being deployed in a data theft campaign by threat actors\ntracked as [Aggah against East European countries.](https://yoroi.company/research/serverless-infostealer-delivered-in-est-european-countries/)\n\n## Infection Chain\n\nIt all starts with phishing attachments, whereby victims are lured to execute malicious\nattachments. It can range from LNK files to Office documents with malicious macros or\n[payload to exploit vulnerabilities such as CVE-2017-0199 (Remote code execution](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-0199)\n[vulnerability in Microsoft Office Application and WordPad) and CVE-2017-11882 (Remote](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-11882)\ncode execution vulnerability in Microsoft office).\n\nOnce the initial payload is executed, it tries to connect to the malware distribution site and\ndownload other stages of payload, and finally downloads AgentTesla into the system. The\ninitial payload can also directly download the malware without dropping other payloads. After\n\n\n-----\n\n[AgentTesla is in the system, various actions are performed such as persistence,](https://attack.mitre.org/tactics/TA0003/) [credential](https://attack.mitre.org/tactics/TA0006)\n[harvesting, and exfiltration.](https://attack.mitre.org/tactics/TA0010)\n\n[For persistence techniques the malware schedules tasks [T1053] or places itself in startup](https://attack.mitre.org/techniques/T1053/)\n[folders or under registry Run keys [T1547.001]. In the case of data collection, what we have](https://attack.mitre.org/techniques/T1547/001/)\nobserved is that it has a predefined list of browsers, mail, and VPN client. Based on\nwhichever mentioned services and application is present in the system, it tries to retrieve\ndata from them. For exfiltration, we found various samples of AgentTesla utilizing various\nprotocols and applications such as SMTP, FTP, Telegram, and Discord.\n\nWe go into full detail on how the malware is being distributed, and the infection chain and\nprovide an analysis of its capabilities in the attached report. We uncover some of the TTPs\nfrom the analysis of malware and case studies. After understanding its capabilities we have\nprovided detection rules to detect the malware at various stages through its known behavior\nwhich is available to download as part of Logpoint’s latest release, as well as through\nLogpoint’s download center (https://servicedesk.logpoint.com/hc/enus/articles/115003928409).\n\nLogpoint Emerging Threats Protection Service provides the service subscribers with\ncustomized investigation and response playbooks, tailored to your environment. Contact the\n[global services team here.](https://www.logpoint.com/en/contact/)\n\n[The report contains the analysis, detection, and mitigation using Logpoint SIEM+SOAR can](https://www.logpoint.com/en/product/comprehensive-threat-detection-and-response-with-converged-siem/)\nbe downloaded from the link.\n\n[Download report](https://www.logpoint.com/wp-content/uploads/2023/03/et-agenttesla.pdf)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-23 - Emerging Threats- AgentTesla – A Review and Detection Strategies.pdf"
    ],
    "report_names": [
        "2023-03-23 - Emerging Threats- AgentTesla – A Review and Detection Strategies.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa57c036-b3e5-4bc4-83b8-cac8498b6c24",
            "created_at": "2023-01-06T13:46:38.589041Z",
            "updated_at": "2025-03-27T02:00:02.867594Z",
            "deleted_at": null,
            "main_name": "SilverTerrier",
            "aliases": [],
            "source_name": "MISPGALAXY:SilverTerrier",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "fe3d8dee-3bee-42e6-8f16-b6628b6189ae",
            "created_at": "2023-01-06T13:46:39.039285Z",
            "updated_at": "2025-03-27T02:00:02.98336Z",
            "deleted_at": null,
            "main_name": "SWEED",
            "aliases": [],
            "source_name": "MISPGALAXY:SWEED",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "28851008-77b4-47eb-abcd-1bb5b3f19fc2",
            "created_at": "2023-06-20T02:02:10.254614Z",
            "updated_at": "2025-03-27T02:00:03.130853Z",
            "deleted_at": null,
            "main_name": "Hagga",
            "aliases": [
                "TH-157",
                "Aggah"
            ],
            "source_name": "MISPGALAXY:Hagga",
            "tools": [
                "Agent Tesla"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f2c53785-fb8b-460d-ba73-7fbfba36f0f5",
            "created_at": "2022-10-25T16:07:24.247949Z",
            "updated_at": "2025-03-27T02:02:10.150345Z",
            "deleted_at": null,
            "main_name": "Sweed",
            "aliases": [],
            "source_name": "ETDA:Sweed",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "ForeIT",
                "Formbook",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Negasteal",
                "Origin Logger",
                "RDP",
                "Remote Desktop Protocol",
                "ZPAQ",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b0d34dd6-ee90-483b-bb6c-441332274160",
            "created_at": "2022-10-25T16:07:23.296754Z",
            "updated_at": "2025-03-27T02:02:09.724313Z",
            "deleted_at": null,
            "main_name": "Aggah",
            "aliases": [
                "Operation Red Deer",
                "Operation Roma225"
            ],
            "source_name": "ETDA:Aggah",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Aggah",
                "Atros2.CKPN",
                "Bladabindi",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "Origin Logger",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "Warzone",
                "Warzone RAT",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ecff5c60-4f8b-4d7c-9784-f279eb056518",
            "created_at": "2022-10-25T15:50:23.49538Z",
            "updated_at": "2025-03-27T02:00:55.485485Z",
            "deleted_at": null,
            "main_name": "SilverTerrier",
            "aliases": [
                "SilverTerrier"
            ],
            "source_name": "MITRE:SilverTerrier",
            "tools": [
                "NanoCore",
                "Agent Tesla",
                "NETWIRE",
                "DarkComet",
                "Lokibot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1683338962,
    "ts_updated_at": 1743041727,
    "ts_creation_date": 1683251604,
    "ts_modification_date": 1683251604,
    "files": {
        "pdf": "https://archive.orkl.eu/970adc670444ed46f210358f796a0d294df042a8.pdf",
        "text": "https://archive.orkl.eu/970adc670444ed46f210358f796a0d294df042a8.txt",
        "img": "https://archive.orkl.eu/970adc670444ed46f210358f796a0d294df042a8.jpg"
    }
}