{
    "id": "1ed118b9-09a1-4636-ae0f-8f1f5145e735",
    "created_at": "2023-01-12T15:00:14.95047Z",
    "updated_at": "2025-03-27T02:13:46.792062Z",
    "deleted_at": null,
    "sha1_hash": "2820c3da48ce124320fb16c5abe7bbb5817cddd2",
    "title": "2021-04-29 - New Shameless Commodity Cryptocurrency Stealer (WeSteal) and Commodity RAT (WeControl)",
    "authors": "",
    "file_creation_date": "2022-05-28T00:36:24Z",
    "file_modification_date": "2022-05-28T00:36:24Z",
    "file_size": 2883450,
    "plain_text": "# New Shameless Commodity Cryptocurrency Stealer (WeSteal) and Commodity RAT (WeControl)\n\n**unit42.paloaltonetworks.com/westeal/**\n\nRobert Falcone, Simon Conant April 29, 2021\n\nBy [Robert Falcone and](https://unit42.paloaltonetworks.com/author/robertfalcone/) [Simon Conant](https://unit42.paloaltonetworks.com/author/simon-conant/)\n\nApril 29, 2021 at 12:01 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Cryptocurrency,](https://unit42.paloaltonetworks.com/tag/cryptocurrency/) [Cybercrime,](https://unit42.paloaltonetworks.com/tag/cybercrime/) [EMEA,](https://unit42.paloaltonetworks.com/tag/emea/) [RAT,](https://unit42.paloaltonetworks.com/tag/rat/) [Remote Access Trojan,](https://unit42.paloaltonetworks.com/tag/remote-access-trojan/) [WeControl,](https://unit42.paloaltonetworks.com/tag/wecontrol/) [WeSteal](https://unit42.paloaltonetworks.com/tag/westeal/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/westeal/)\n\n## Executive Summary\n\nIt seems that for every commodity malware [takedown and](https://www.europol.europa.eu/newsroom/news/international-crackdown-rat-spyware-which-takes-total-control-of-victims%E2%80%99-pcs) [prosecution, another replaces it to take a turn empowering](https://www.afp.gov.au/news-media/media-releases/rat-trap-international-cybercrime-investigation-shuts-down-insidious)\n[cybercriminals. Often, commodity malware authors will disingenuously attempt to profess a guise of legitimacy for their](https://unit42.paloaltonetworks.com/unit42-rat-trapped-luminositylink-falls-foul-vermin-eradication-efforts/)\n[malware – a strategy that often doesn’t stand up in court.](https://www.justice.gov/usao-edky/pr/stanford-man-sentenced-30-months-computer-intrusion-crimes)\n\nThe author of WeSteal, a new commodity cryptocurrency stealer, makes no attempt to disguise the intent for his malware.\nThe seller promises “the leading way to make money in 2021” (Figure 1).\n\n\n-----\n\nFigure 1. WeSteal advertisement.\nIn this blog, we analyze WeSteal, detail the obfuscation and techniques it uses for persistence and operation, and\nexamine the customers of this malware. We take a look at the actor WeSupply, with an operation and website by the same\nname, and at the Italian malware coder ComplexCodes, a co-conspirator and actual author of this malware.\n\nImmediately before the publication of this report, we discovered that the actors had both added some new features to\nWeSteal, and had also complemented it with a new commodity remote access tool (RAT) called “WeControl”. We\ndocument these new revelations at the end of our report.\n\n[Palo Alto Networks customers are protected from WeSteal and WeControl with Cortex XDR, the](https://www.paloaltonetworks.com/cortex/cortex-xdr) [Next-Generation Firewall](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\nwith [WildFire and](https://www.paloaltonetworks.com/products/secure-the-network/wildfire) [Threat Prevention security subscriptions, and AutoFocus.](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\n\n## Origin of WeSteal\n\nActor “ComplexCodes” started advertising WeSteal on underground forums in mid-February 2021. However,\nComplexCodes had been selling a “WeSupply Crypto Stealer” since May 2020. A comparison of samples of the earlier\nWeSupply Crypto Stealer with WeSteal suggests that WeSteal is likely simply an evolution of the same project.\n\nThis Italian malware coder previously authored a “Zodiac Crypto Stealer” and “Spartan Crypter” for obfuscating malware\nto avoid antivirus detection.\n\nThe actor’s forum signature indicates an affiliation with a site that sells accounts for services such as Netflix and Disney+\n(Figure 2).\n\n\n-----\n\nFigure 2. Underground site that sells accounts.\nThe intent is once again on display with ComplexCode’s Discord-based commodity distributed denial-of-service (DDoS)\noffering, “Site Killah” (Figure 3).\n\n\n-----\n\nFigure 3. DDoS service advertisement.\n\n## Intent of WeSteal\n\nWhen pursuing cases against malware authors, prosecutors typically need to demonstrate the author’s intent for the\nmalware. Many authors will hide behind meaningless Terms of Service statements that end users must not use the\nmalware for illegitimate purposes. They will often describe potential “legitimate” uses for their malware – only to further\ndescribe anti-malware evasion properties, silent installation and operation or features such as cryptocurrency mining,\npassword theft or disabling webcam lights.\n\nThere is no such pretense by ComplexCodes with WeSteal. There is the name of the malware itself. Then there is the\nwebsite, “WeSupply,” owned by a co-conspirator, proudly stating “WeSupply – You profit” (Figure 4).\n\nFigure 4.\n\nWeSupply advertisement.\nAs well as calling the malware WeSteal and advertising the “Crypto Stealer” feature, WeSupply’s posts on forums also\ndescribe support for zero-day exploits and “Antivirus Bypassing” (Figure 5).\n\n\n-----\n\nFigure 5. WeSteal features.\nThis is demonstrated with a screenshot claiming no antivirus detection for a sample (Figure 6). WeSteal includes a “Victim\ntracker panel” that tracks “Infections” – leaving no doubt about the context.\n\n\n-----\n\nFigure 6. WeSteal antivirus scanning\n\nresults.\nOf course, ComplexCodes profits from the sale of WeSteal by charging €20 for a month, €50 for three months and €125\nfor one year (Figure 7).\n\n\n-----\n\nFigure 7. WeSteal advertisement on Sellix, an ecommerce store.\nThere isn’t any possible angle from which to claim legitimacy for a piece of software designed to steal cryptocurrency\ntransactions.\n\n## Capabilities of WeSteal\n\nIn order to “steal” cryptocurrency from a victim, WeSteal uses regular expressions to look for strings matching the patterns\nof Bitcoin and Ethereum wallet identifiers being copied to the clipboard. When it matches these, it replaces the copied\nwallet ID in the clipboard with one supplied by the malware. The victim then pastes the substituted wallet ID for a\ntransaction, and the funds are sent instead to the substitute wallet.\n\n**RAT?**\n\nWeSteal is advertised as featuring a “RAT Panel.” Not a single RAT feature is advertised nor observed in our analysis. It\nseems that ComplexCodes is rather ambitiously describing their simple hosted command-and-control (C2) service,\nelsewhere described as a “victim tracker,” as a “RAT Panel.”\n\n**C2 as a Service**\n\n[As we have observed in some other commodity malware, rather than leaving customers to run their own C2, WeSteal](https://unit42.paloaltonetworks.com/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/)\noperates with a hosted C2 as a service (C2aaS).\n\nWeSteal is configured to use the following URLs for its C2 communications. We have observed two different C2 domains,\none of which is also the sales site for the malware.\n\nhxxps://wesupply[.]to/t_api.php\n\nhxxps://wesupply[.]io/t_api.php\n\n**S** **ki** **f “S** **i** **”**\n\n\n-----\n\nThe WeSupply crew seems very invested in the “success” of their customers. In one forum sales thread, a would-be but\napparently inexperienced potential criminal asks:\n\n“how do you use the tool and how does it target someone?”\n\nTo which the helpful malware peddlers respond:\n\n“Open a ticket, will help you with all your questions.”\n\n**Obfuscation**\n\nWeSteal is distributed as a Python-based Trojan in a script named \"westeal.py\". ComplexCodes converted it into an\nexecutable form using PyInstaller. The Trojan was specifically written for Python 3.9, as the PyInstaller package included\n[python39.dll as the Python interpreter. The developer also used the open source PyArmor source code obfuscator, which](https://github.com/dashingsoft/pyarmor)\nencrypts the contents of the Python script and decrypts the contents before sending to the Python interpreter for\nexecution, as seen here:\n\nfrom pytransform import pyarmor_runtime\n\npyarmor_runtime()\n\n_pyarmor(name, __file_, b'PYARMOR\\x00\\x00\\x03\\t\\x00a\\r\\r\\n\\x06[snip]\n\nPyArmor relies on the \"_pytransform.dll\" library to decrypt the contents of the Python script and sends them to the\n\"python39.dll\" interpreter. The WeSteal samples we analyzed were obfuscated using PyArmor's \"obf_mode\" setting\nconfigured to 2. This \"obf_mode\" setting includes the WeSteal Python bytecode as ciphertext that PyArmor decrypts using\nAES GCM at runtime.\n\n**An Interesting Persistence Technique**\n\nThe “add_startup” function establishes persistent access to the system, by which WeSteal copies itself to the following\nlocation:\n\nC:\\Users\\<username>\\AppData\\Local.exe\n\nWeSteal then creates the following batch script in the startup folder that will run each time the user logs in:\n\nc:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\appdata.bat\n\nThe batch script contains the following command:\n\nstart %localappdata%\n\nThe command above uses a novel technique to obfuscate the batch file starting the WeSteal executable. The start\ncommand attempts to run the environment variable %localappdata%, which on a default Windows system is a path to the\nfolder C:\\Users\\<username>\\AppData\\Local. However, in this context, the Local in that environment variable is interpreted\nas a file rather than a subfolder. The start command will run the WeSteal executable Local.exe (the start command does\nnot require the .exe file extension) in the path C:\\Users\\<username>\\AppData\\.\n\n**The “heist” (or “cuckoo’s egg”?)**\n\nThe get_clipboard and copy_to_clip functions carry out WeSteal’s cryptojacking functionality. These functions check for\nBitcoin (BTC) and Etherium (ETH) wallets copied to the clipboard and replace them with an actor's wallet, hoping that the\nuser will then paste the actor’s wallet instead of the intended one, redirecting a cryptocurrency transaction in the actor’s\nfavor. The actor is counting on the victim not noticing the substitution until it is too late and the irrevocable cryptocurrency\ntransaction has been completed.\n\nWeSteal uses regular expressions to identify wallets copied by the user to the clipboard. The regular expressions\nspecifically describing the formats of Bitcoin and Ethereum wallets are seen in the constants identified in the decrypted\nWeSteal sample (Figure 8).\n\n\n-----\n\nFigure 8. Constants from a decoded WeSteal sample.\n\n## WeSteal’s Customers, Wallets and Their “Hauls”\n\nAlso encoded in the samples were the hardcoded customer “handle,” and their BTC and ETH wallets. From this, we have\nsome idea of the current customer base and possibly an idea of their success.\n\nWe collated a small list of customers. In general, the wallets identified had only a small number of transactions since\nWeSteal was released, and those were of low value. However, at least one wallet (actor “pepsi”) received approximately\n$800 in a single Ethereum transaction. It is, of course, possible that any of these transactions may be unrelated to the\nmalware.\n\nHandle Etherium Wallet Bitcoin Wallet\n\nHeroin 0xb5F7Bf1B46854f3EDA1201294941Edb13f9661EA 1AB3XSnioEFKKZcDadmSDX8YRcQzgRnG3c\n\npepsi 0x5f9C7078dFF737BbF872b438151Cd38ECfe0ebee 1NbyaaQTGPAhj8CuqRSRrXbWCCtyhdyv7T\n\n\n-----\n\ntouourien 0x419f92Af57Eeb3f50fbE10298cC4a684aB452011 bc1qg0gr8286k6kemtd3cwch6guzfp6yn9n3smlqt8\n\nAdribusted 0x49c8d0359cAf80FfebD8424128A951264f4f6506 bc1q8pufxrmm8k5n9v4w2auvlaedx9lm23c7sg6mye\n\nKing 0x1FdD9e44048F88B04C6DBba897E05ecCA55A61f9 1KVsfk5jT5fUGbUxomxAsKYxVvSZC9joXs\n\nbelzedar 0xc7D4E35C3ea831c3Bbf53550621315C79423E95F bc1q30el678lr9dwcydtm8gjztf389zrj6gfs6ezj5\n\nxjoking 0xa4FC40168EF940eD013E1dB6986C5746AAC3b2c3 1APLhq2yC421C3G6X5uhLhTmtZMjSUZ38G\n\nShakho 0x356d6162ADa9db9bd31b95Eec92Cd3B1D3273623 1CUYk9xCDU9WfTbLZj561M32Q55EZtcyEo\n\nWeZesk 0x269eCD3E97A37C27347E4E87D6f3f1B59A0BE2AB 1BcD15EEpeA1Mfz49oAMfdikeXjhCfiUU6\n\nX0NR8 0x86C19f41004d451dc6dcb4f0AC086EDdA1383b70 bc1qkmg9c0p52xgzqjqswdz6k9gxddwvchr8rt3pm8\n\nwizzz 0xAaD7685A29bE275E9404Ba88260E19dB52644DE3 bc1qx7ha77kanm3nn8fe2ap4ts2uyxjxgmc35llud7\n\nPepe 0xB97749901245b417060bbdFf3D7d1eC90b584a7c 17SjdBcboW2EPFMyoPwzp64eyjMwTLoBSG\n\nThe actor WeSupply is unsurprisingly observed using their own tool (using a second forum handle, “Shakho”). Also\nunsurprising is that many of these handles are also noted in the same forums where WeSteal is promoted.\n\n## Recent Observed Updates, Including WeControl RAT\n\nImmediately before the publication of this report, we noticed some new samples that bore a striking similarity to WeSteal\n(also Pyarmor-obfuscated compiled Python), but were also different from other WeSteal samples.\n\nThis caused us to refresh our research of forums and the actors’ website. We note them advertising improvements to\nWeSteal, as well as selling a new piece of malware called “WeControl” RAT.\n\n**WeSteal Improvements**\n\nWhen we first analyzed WeSteal, we wondered why the actors included only the ability to monitor for and steal just two\ncryptocurrencies, Bitcoin and Ethereum. Although those are the most popular cryptocurrencies, it would surely be simple\nenough to code for the wallet patterns of other cryptocurrencies as well.\n\n\n-----\n\nFigure 9. Updated WeSteal marketing.\nUnsurprisingly, we now note that the authors have added three cryptocurrencies to the list of those that can be stolen:\n\nBitcoin: BTC\nEthereum: ETH\nLitecoin: LTC\nBitcoin Cash: BCH\nMonero: XMR\n\n**WeControl RAT**\n\nUnfortunately, the timing of the discovery of a new commodity RAT at the actors’ site precluded us including a full analysis\nin this report.\n\n\n-----\n\nFigure 10. WeControl advertised at the actors’ website\nWeControl is marketed as a “rat/botnet hybrid.” The description seems to indicate that the actors have incorporated the\nC2-as-a-service model of WeSteal into this RAT as well. This is not “the first” web-based C2aaS as they claim –\n[WebMonitor RAT has been offering C2aaS for over two years.](https://unit42.paloaltonetworks.com/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/)\n\nUsing a familiar technique from WeSteal, WeControl is again compiled Python obfuscated with PyArmor.\n\nWe first observed a sample of WeControl mid-April 2021. At the time of publication, we have collected just seven samples\nof WeControl. The hashes for these can be found at the end of this report.\n\n## Conclusion\n\nWeSteal is a shameless piece of commodity malware with a single, illicit function. Its simplicity is matched by a likely\nsimple effectiveness in the theft of cryptocurrency. The low-sophistication actors who purchase and deploy this malware\nare thieves, no less so than street pickpockets. Their crimes are as real as their victims.\n\nThe fast and simple monetization chain and anonymity of cryptocurrency theft, together with the low cost and simplicity of\noperation will undoubtedly make this type of crimeware attractive and popular to less skilled thieves\n\n\n-----\n\nWeControl is similarly both designed and marketed as a tool for illicit activity, lacking in propriety no less than the earlier\nWeSteal.\n\nThe ease of detection and blocking of the C2 as a service works against the Italian malware author ComplexCodes. It’s\nsurprising that customers trust their “victims” to the potential control of the malware author, who no doubt could in turn\nusurp them, stealing the victim “bots” or replacing customers’ wallets with one of ComplexCodes’ own at any time. It’s also\nsurprising that the malware author would risk criminal prosecution for what must surely be a small amount of profit, given\nthe apparently small customer base.\n\nOrganizations with effective spam filtering, proper system administration and up-to-date Windows hosts have a much\nlower risk of infection.\n\nPalo Alto Networks customers are further protected from WeSteal and WeControl with Cortex XDR or the Next-Generation\nFirewall with WildFire and Threat Prevention security subscriptions. AutoFocus users can track WeSteal and WeControl\nactivity using the [WeSteal and](https://autofocus.paloaltonetworks.com/#/tag/Unit42.WeSteal) [WeControl tags.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.WeControl)\n\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our\nfellow Cyber Threat Alliance members. CTA members use this intelligence to deploy protections to their customers rapidly\nand to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit\n[https://www.cyberthreatalliance.org/.](https://www.cyberthreatalliance.org/)\n\n**Indicators of Compromise**\n\nWeSteal Samples\n\nA SHA256 hash list of the 157 identified WeSteal samples, as of the time of publishing this report, is available at our\n[GitHub repository.](https://github.com/pan-unit42/iocs/blob/master/WeSteal%20Hashes.txt)\n\nWeControl Samples\n\n59ffba39fc87eacd7c19498b5bb495d9c86c8bec40f3282e996aa80d77c45fa7\n\ned6875d60a67149c6cee4798a305810c6bcaa9b0b9349ec397ed331d96707e37\n\n2bdc916680402a973afca8407d83c299092515cf5cc78ad0a92a8ce2d72b6f7c\n\n8d37eef0308d5bd03d6c93ab247ca82d2157053822428ad1c787771de8e4332f\ne2b11c10832991577184abd4f57af7383f30142a52fc8e2b41145f416860acf1\n\n0920763b06f0a90f57910aaeff361d978bf37b025cbb9bc206d290eeb81e6217\n\neac7d579002f5e7f2cbff86b8e233c433f14ae25faf112eabaa1e2dd4f2a9a3d\n\nC2 / sales domains\n\nwesupply[.]to\n\nwesupply[.]io\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-29 - New Shameless Commodity Cryptocurrency Stealer (WeSteal) and Commodity RAT (WeControl).pdf"
    ],
    "report_names": [
        "2021-04-29 - New Shameless Commodity Cryptocurrency Stealer (WeSteal) and Commodity RAT (WeControl).pdf"
    ],
    "threat_actors": [
        {
            "id": "31da1b1f-743b-40ef-bd17-1e07c5500392",
            "created_at": "2024-06-19T02:00:04.382822Z",
            "updated_at": "2025-03-27T02:00:03.385309Z",
            "deleted_at": null,
            "main_name": "UAC-0020",
            "aliases": [
                "Vermin",
                "SickSync"
            ],
            "source_name": "MISPGALAXY:UAC-0020",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535614,
    "ts_updated_at": 1743041626,
    "ts_creation_date": 1653698184,
    "ts_modification_date": 1653698184,
    "files": {
        "pdf": "https://archive.orkl.eu/2820c3da48ce124320fb16c5abe7bbb5817cddd2.pdf",
        "text": "https://archive.orkl.eu/2820c3da48ce124320fb16c5abe7bbb5817cddd2.txt",
        "img": "https://archive.orkl.eu/2820c3da48ce124320fb16c5abe7bbb5817cddd2.jpg"
    }
}