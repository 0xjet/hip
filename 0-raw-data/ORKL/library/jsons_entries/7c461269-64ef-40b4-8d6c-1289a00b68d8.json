{
    "id": "7c461269-64ef-40b4-8d6c-1289a00b68d8",
    "created_at": "2023-01-12T15:10:57.368895Z",
    "updated_at": "2025-03-27T02:06:06.123491Z",
    "deleted_at": null,
    "sha1_hash": "f140983892ec39b7419b605cf520f67eb3871eee",
    "title": "2021-10-27 - [RE025] TrickBot ... many tricks",
    "authors": "",
    "file_creation_date": "2022-05-28T15:23:47Z",
    "file_modification_date": "2022-05-28T15:23:47Z",
    "file_size": 5007313,
    "plain_text": "# [RE025] TrickBot ... many tricks\n\n**blog.vincss.net/2021/10/re025-trickbot-many-tricks.html**\n\n**1. Introduction**\n\nFirst discovered in 2016, until now TrickBot (aka TrickLoader or Trickster) has become one of the most popular and dangerous malware in\ntoday's threat landscape. The gangs behind TrickBot are constantly evolving to add new features and tricks. Trickbot is multi-modular malware,\nwith a main payload will be responsible for loading other plugins capable of performing specific tasks such as steal credentials and sensitive\ninformation, provide remote access, spread it over the local network, and download other malwares.\n\n[Trickbot roots are being traced to elite Russian-speaking cybercriminals. According to these reports (1,](https://therecord.media/us-arrests-latvian-woman-who-worked-on-trickbot-malware-source-code/) [2), up to now, at least two people](https://therecord.media/trickbot-gang-member-arrested-after-getting-stuck-in-south-korea-due-to-covid-19-pandemic/)\nbelieved to be members of this group have been arrested. Even so, other gang members are currently continuing to operate as normal.\n\nThrough continuous cyber security monitoring and system protection for customer recently, VinCSS has successfully detected and prevented a\nphishing attack campaign to distribute malware to customer that was protected by us. After the deep dive analysis and dissection of the\nmalware techniques, we can confirm that this is a sample of the Trickbot malware family.\n\nIn this article, we decided to provide a detail analysis of how Trickbot infects after launching by a malicious Word document, the techniques the\n[malware uses to make it difficult to analyze. Unlike Emotet or](https://blog.vincss.net/2021/01/re019-from-a-to-x-analyzing-some-real-cases-which-used-recent-Emotet-samples.html) [Qakbot, Trickbot hides C2 addresses by using fake C2 addresses mixed together](https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html)\nwith real C2 addresses in the configuration, we will cover how to extract the final C2 list at the end of this article. In addition, we present the\n[method to recover the APIs as well as decode the strings of Trickbot based on IDA AppCall feature to make the analysis process easier.](https://hex-rays.com/blog/introducing-the-appcall-feature-in-ida-pro-5-6/)\n\n**2. Analyze malicious document**\n\nThe attacker somehow infected the partner's mail server system, thereby taking control of the email account on the server, inserting email with\nattachment containing malware into the email exchange flow between the two parties. The content of this email is as follows:\n\n[After extracting the request.zip with the password provided in the email, I obtained require 010.04.2021.doc:](https://www.virustotal.com/gui/file/365c4a15a704d7a6244a34ef94bc2aa845ae8435ab4ff4bdac7da55e76f75cf6)\n\nCheck the require 010.04.2021.doc file and found that this file contains VBA code:\n\n\n-----\n\nI focus to the red highlight code in the above image. Extract the relevant data area and do the corresponding replacement, obtain the html\ncontent containing JavaScript as the figure below:\n\nThe JavaScript code in the figure will do the decoding of the base64 blob assigned to the rockCleanJump and rapHopWindows variables. With\nthe first base64 blob, it will download the payload to the victim's computer and save it as easyMicrosoftHop.jpg:\n\n\n-----\n\nt t e seco d base6 b ob, t use egs **3** to e ecute t e do oaded pay oad\n\nWith the above information, I can conclude that easyMicrosoftHop.jpg is a Dll file.\n\n**3. Analyze easyMicrosoftHop.jpg payload (RCSeparator.dll – 48cba467be618d42896f89d79d211121)**\n\nThis file is not available on VT, however if search by imphash: f34a0f23e05f2c2a829565c932b87430 will get the same payloads. These\npayloads have been uploaded to VT recently:\n\nExamining this payload, this is a Dll with the original name is RCSeparator.dll, and it has one exported function is DllRegisterServer.\n\nThe file's metadata info is as follows:\n\nThe sample is not packed, but through a quick check the sections information, it can be seen that its code has been obfuscated, and the .rsrc\nsection is likely to contain an encrypted payload.\n\n\n-----\n\ny e g esou ces t s sa p e, ou d a esou ce a ed, s e 0 38333 bytes, co ta g a do bytes guess t at t use\nthis resource to decode a new payload.\n\nAnalysis code of the payload at the DllRegisterServer function shows that it does the following:\n\nFind the base address of kernel32.dll, ntdll.dll:\n\nGet the addresses of APIs for later use in kernel32.dll, ntdll.dll based on pre-computed hashes.\n\nUse the resolved APIs to access and get the entire content of the resource that was mentioned above:\n\n\n-----\n\necode to s e code a d e ecute t s s e code by us g QueueUse **[C a d](https://www.ired.team/offensive-security/code-injection-process-injection/shellcode-execution-in-a-local-process-with-queueuserapc-and-nttestalert)** **t est** **e t u ct o s**\n\nDump shellcode for further analysis. Parse this shellcode and found that it has 3 embedded Dlls as following:\n\n**4. Analyze shellcode**\n\nThe code of the above shellcode will call the f_dll_loader function to load the first Dll into memory with the following parameter:\n\nAt the function f_dll_loader, the shellcode finds the addresses of Windows API functions on runtime according to the pre-computed hashes:\n\nThe entire f_dll_loader function will perform the task of a loader, after mapping the Dll into memory will find the Dll's DllEntryPoint address\nand call this address to execute the code of first Dll:\n\nHere, I dumped the first Dll to disk for further analysis.\n\n**5. Analyze the first Dll (b67694dddf98298b539bddc8cabc255d)**\n\nThis file is not available on VT, however if search by imphash: 1f6199c52a5d3ffac2a25f6b3601dd22 thì will get the same payloads:\n\nAccording to the information that Import Directory provides, it can be guessed that this Dll will also do the job of a loader:\n\n\n-----\n\nThe code at DllEntryPoint will call the function responsible for loading and executing the second Dll:\n\nThe entire f_dll_loader function has the same code as the shellcode analyzed above, after mapping the entire second Dll into memory, it will\nretrieve the Dll's DllEntryPoint address and call this address to execute the next stage:\n\nI dumped the second Dll to disk for easier analysis.\n\n**6. Analyze the second Dll (34d6a6bffa656c6b0c7b588e111dbed1)**\n\n[This Dll has already been uploaded to VirusTotal. Imports of the second Dll are the same as the first one:](https://www.virustotal.com/gui/file/6515084c99478975c73987727e813ea6e8fa8046f425c8e88b54f6eeeea225d8)\n\nThe code at the DllEntryPoint function of this Dll performs the following task:\n\nMapping the third Dll into memory.\n\n\n-----\n\nFind the DllRegisterServer function and call to this function:\n\nI again dumped the third Dll to disk for further analysis.\n\n**7. Analyze the third Dll (templ.dll - 3409f865936a247957955ad2df45a2cd)**\n\nExamining the above dumped Dll, its original name is templ.dll, and it has one exported function is DllRegisterServer.\n\nThis dll is also not available on VT, but searching by imphash: b79a86dfbbbe6d8e177dfb7ae70d4922 will returns some similar files.\n\nThe file is not packed, its code is obfuscated or will decode the new payload:\n\nThe code at the DllRegisterServer function of this Dll performs the following tasks:\n\nAllocate a memory area to store the decrypted payload.\nPerform the decryption routine to decrypt new payload into the allocated memory area. This payload is a shellcode.\nCall to shellcode to execute the final stage.\n\n\n-----\n\nThe decryption function uses a loop to xor the data as follows:\n\nTo be quick, I use x64dbg for debugging. Shellcode after decoding will be as follows:\n\n**8. Analyze the final shellcode**\n\nObserve this shellcode and I see that it stores strings near the end of the file. In my personal experience these are likely base64 strings and\nkeys for decoding\n\nPerform decoding, I got the following strings:\n\n\n-----\n\nBased on the above decoding information, I guess that this shellcode will continue to inject the payload into the wermgr.exe process. To verify,\nI debug this shellcode right after the templ.dll does the decoding and calls to the shellcode. Set breakpoint at CreateProcessInternalW\nfunction and execute:\n\nSo, as you can see in the above figure, the shellcode injects the payload into the wermgr.exe (64-bit) process. Under the cover of the\n**wermgr.exe system process, the malicious code will now make connections to many C2 addresses as the following picture below:**\n\n\n-----\n\n**9** **u** **p** **c bot co e pay oad 3** **b t a d e t act C** **co** **gu at o**\n\n**9.1. Dump payload 32-bit**\n\nAccording to the above shellcode analysis results, it can be seen that the final payload has been injected into the wermgr.exe (64-bit)\nprocess, so this payload is also 64-bit. However, templ.dll is a 32-bit Dll, so to make it easier to gain an understand of the payload's code as\nwell as extract the C2 configuration, we will dump the core 32-bit payload of malware. I debug shellcode when it is called by templ.dll, set\nbreakpoints at VirtualAlloc, GetNativeSystemInfo functions. Execute shellcode, break at GetNativeSystemInfo function:\n\nFollow in Dump the address will receive information about SystemInfo, execute the function and return to malware code. Modify the return\nresult of wProcessorArchitecture:\n\nContinuing to execute and follow the address allocated by the VirtualAlloc function, shellcode will unpack the main payload into the allocated\nmemory, but the \"MZ\" signature has been wiped.\n\nDump payload to disk and fix MZ signature. I have the [core binary (32-bit) of Trickbot:](https://www.virustotal.com/gui/file/2aadcd168cc1e1cc465b57548f32f26f3d45fefe61e072563915ddf826a5b32d/details)\n\n\n-----\n\nay oad as o o at o about po ts, so t et e e t e add esses o s du g u t e\n\n**9.2. Analyze Trickbot core payload and extract C2s configuration**\n\n**9.2.1. Dynamic APIs resolve**\n\n[Similar to the Emotet,](https://blog.vincss.net/2021/01/re019-from-a-to-x-analyzing-some-real-cases-which-used-recent-Emotet-samples.html) [Qakbot, ... Trickbot payload also finds the address of the API function(s) through searching the pre-computed hash](https://blog.vincss.net/2021/03/re021-qakbot-dangerous-malware-has-been-around-for-more-than-a-decade.html)\nbased on the API function name. Information about the Dlls as well as the pre-computed hashes is stored in the global variable with the\nfollowing structure:\n\nThese fields have the following meanings:\n\n**dll_str_idx: is used to decode the name of the Dll that Trickbot will use. And then, get the base address of this Dll.**\n**nHashValue: number of hash is pre-computed, corresponding to the number of API functions to find.**\n**pre-computed hash: are the pre-computed hash values of the API function.**\n**nOrdinalVal: number of ordinal values, corresponding to functions that will be retrieved the address based on the calculated ordinal's**\ninformation.\n**Orinal_value: values are used to calculate the actual ordinal value of the API function that need to retrieve address.**\n\nBased on these fields, Trickbot will retrieving the addresses of the APIs as following:\n\nThe pseudocode of the function that calculates the hash based on the name of the API function:\n\n\n-----\n\nased o t e abo e pseudocode, ca e te t e as ca cu at o code yt o as o o s\n\nAll real addresses of APIs after being obtained will be stored at the address 0x00420000 as shown in the picture. Therefore, in order to get all\n[the information about the APIs that Trickbot will use, I apply the method described in this article. The result after restore the API(s) functions as](https://hooked-on-mnemonics.blogspot.com/2012/09/importing-ollydbg-addresses-into-ida.html?)\nthe figure below:\n\n**9.2.2. Decrypt strings**\n\nAll the main strings that used by payload are encrypted and stored at the .data section as following:\n\nThe decode function receives the input parameter as the index value of the string, then decodes the string using the base64 algorithm with the\ncustom character set:\n\n[To be able to decode these strings and add related annotations in IDA, I use IDA's Appcall feature and refer to the code](https://hex-rays.com/blog/introducing-the-appcall-feature-in-ida-pro-5-6/) [here. The entire](https://github.com/coldshell/IDA-appcall)\npython code is as follows:\n\n\n-----\n\nThe results before and after the script execution will make the analysis easier:\n\nIn addition, for easy tracking and comparison, we can also write a standalone decryption script to get the entire list of strings. Please see the\n**Appendix 1 – Complete list of decrypted strings below.**\n\n**9.3. Decrypt the configuration and extract the C2s list**\n\n**9.3.1. Decrypt the configuration**\n\nTrickbot stores encrypted configuration information in the .text section, when executed it will get information about the size of the data and\nallocate memory accordingly. After that will perform data decryption by using a xor loop.\n\n\n-----\n\nThe data obtained after the above step will be decrypted again by using AES algorithm (MODE_CBC) to get the C2s list. Before decryption,\nTrickbot will generate the AES key and IV:\n\nThe calculated aes_key and aes_iv values will then be used for data decryption as followings:\n\n[Based on the pseudocodes above, combined with the hashherezade code reference here, I can rewrite the python code that decrypts the C2](https://twitter.com/hasherezade)\nconfiguration that Trickbot uses in this sample:\n\n\n-----\n\n**9.3.2. Extract C2s list**\n\nWith the above decrypted configuration, we get the C2s list as shown above. However, in this list:\n\nIP addresses in the <srv> </srv> tag are real C2 addresses.\nIP addresses in the <srva> </srva> tag will be later transformed by Trickbot.\n\nTrickbot use the following code to convert the addresses in the <srva> </srva> tag to real C2 addresses.\n\nThe above pseudocode is converted to python code as below:\n\n\n-----\n\nHere is the C2 list after the transformation:\n\nPlease see Appendix 2 – C2s list below for the complete list.\n\n**10. References**\n\n**11. Appendix 1 – Complete list of decrypted strings**\n\nAll decrypted strings\n\nindex : 0 --> Decoded string : b'checkip.amazonaws.com'\n\nindex : 1 --> Decoded string : b'ipecho.net'\n\nindex : 2 --> Decoded string : b'ipinfo.io'\n\nindex : 3 --> Decoded string : b'api.ipify.org'\n\nindex : 4 --> Decoded string : b'icanhazip.com'\n\nindex : 5 --> Decoded string : b'myexternalip.com'\n\nindex : 6 --> Decoded string : b'wtfismyip.com'\n\nindex : 7 --> Decoded string : b'ip.anysrc.net'\n\nindex : 8 --> Decoded string : b'api.ipify.org'\n\nindex : 9 --> Decoded string : b'api.ip.sb'\n\nindex : 10 --> Decoded string : b'ident.me'\n\nindex : 11 --> Decoded string : b'www.myexternalip.com'\n\nindex : 12 --> Decoded string : b'/plain'\n\nindex : 13 --> Decoded string : b'/ip'\n\nindex : 14 --> Decoded string : b'/raw'\n\nindex : 15 --> Decoded string : b'/text'\n\n\n-----\n\ng\n\nindex : 17 --> Decoded string : b'zen.spamhaus.org'\n\nindex : 18 --> Decoded string : b'cbl.abuseat.org'\n\nindex : 19 --> Decoded string : b'b.barracudacentral.org'\n\nindex : 20 --> Decoded string : b'dnsbl-1.uceprotect.net'\n\nindex : 21 --> Decoded string : b'spam.dnsbl.sorbs.net'\n\nindex : 22 --> Decoded string : b'bdns.at'\n\nindex : 23 --> Decoded string : b'bdns.by'\n\nindex : 24 --> Decoded string : b'bdns.co'\n\nindex : 25 --> Decoded string : b'bdns.im'\n\nindex : 26 --> Decoded string : b'bdns.link'\n\nindex : 27 --> Decoded string : b'bdns.nu'\n\nindex : 28 --> Decoded string : b'bdns.pro'\n\nindex : 29 --> Decoded string : b'b-dns.se'\n\nindex : 30 --> Decoded string : b'ruv_'\n\nindex : 31 --> Decoded string : b'<UserId>'\n\nindex : 32 --> Decoded string : b'rundll32.exe '\n\nindex : 33 --> Decoded string : b'control'\n\nindex : 34 --> Decoded string : b' %u %u %u %u'\n\nindex : 35 --> Decoded string : b'</BootTrigger>\\n'\n\nindex : 36 --> Decoded string : b'path'\n\nindex : 37 --> Decoded string : b'Toolwiz Cleaner'\n\nindex : 38 --> Decoded string : b'GET'\n\nindex : 39 --> Decoded string : b'WTSGetActiveConsoleSessionId'\n\nindex : 40 --> Decoded string : b'Param 0'\n\nindex : 41 --> Decoded string : b'Create ZP failed'\n\nindex : 42 --> Decoded string : b'%s/%s/64/%s/%s/%s/'\n\nindex : 43 --> Decoded string : b'Decode param64 error'\n\nindex : 44 --> Decoded string : b'client is not behind NAT'\n\nindex : 45 --> Decoded string : b'Windows Server 2003'\n\nindex : 46 --> Decoded string : b'start'\n\nindex : 47 --> Decoded string : b'SYSTEM'\n\nindex : 48 --> Decoded string : b'kernel32.dll'\n\nindex : 49 --> Decoded string : b'SeDebugPrivilege'\n\nindex : 50 --> Decoded string : b'.txt'\n\nindex : 51 --> Decoded string : b'Load to M failed'\n\nindex : 52 --> Decoded string : b'winsta0\\\\default'\n\nindex : 53 --> Decoded string : b'eventfail'\n\nindex : 54 --> Decoded string : b'Windows 10 Server'\n\nindex : 55 --> Decoded string : b'data'\n\nindex : 56 --> Decoded string : b' working'\n\nindex : 57 - Decoded string : b'%u%u%u '\n\n\n-----\n\ng g gg\n\nindex : 59 --> Decoded string : b'shlwapi'\n\nindex : 60 --> Decoded string : b'cn\\\\'\n\nindex : 61 --> Decoded string : b'------Boundary%08X'\n\nindex : 62 --> Decoded string : b'curl/7.78.0'\n\nindex : 63 --> Decoded string : b'GetProcAddress'\n\nindex : 64 --> Decoded string : b'</Command>\\n<Arguments>'\n\nindex : 65 --> Decoded string : b'\\\\svchost.exe'\n\nindex : 66 --> Decoded string : b'--%s--\\r\\n\\r\\n'\n\nindex : 67 --> Decoded string : b'SignatureLength'\n\nindex : 68 --> Decoded string : b'tmp'\n\nindex : 69 --> Decoded string : b'in'\n\nindex : 70 --> Decoded string : b'SeTcbPrivilege'\n\nindex : 71 --> Decoded string : b'52'\n\nindex : 72 --> Decoded string : b'\\\\*'\n\nindex : 73 --> Decoded string : b'0.0.0.0'\n\nindex : 74 --> Decoded string : b'</Exec>\\n</Actions>\\n</Task>\\n'\n\nindex : 75 --> Decoded string : b'ModuleQuery'\n\nindex : 76 --> Decoded string : b'No params'\n\nindex : 77 --> Decoded string : b'DNSBL'\n\nindex : 78 --> Decoded string : b'%02X'\n\nindex : 79 --> Decoded string : b'VERS'\n\nindex : 80 --> Decoded string : b'cmd.exe'\n\nindex : 81 --> Decoded string : b'/%s/%s/0/%s/%s/%s/%s/%s/'\n\nindex : 82 --> Decoded string : b'noname'\n\nindex : 83 --> Decoded string : b'Control failed'\n\nindex : 84 --> Decoded string : b'LoadLibraryW'\n\nindex : 85 --> Decoded string : b'InitializeCriticalSection'\n\nindex : 86 --> Decoded string : b'Create xml2 failed'\n\nindex : 87 --> Decoded string : b'</Triggers>\\n<Principals>\\n<Principal id=\"Author\">\\n'\n\nindex : 88 --> Decoded string : b'not listed'\n\nindex : 89 --> Decoded string : b'Create xml failed'\n\nindex : 90 --> Decoded string : b'Windows Server 2012'\n\nindex : 91 --> Decoded string : b'CloseHandle'\n\nindex : 92 --> Decoded string : b'pIT connect failed, 0x%x'\n\nindex : 93 --> Decoded string : b'Windows Server 2008'\n\nindex : 94 --> Decoded string : b'WantRelease'\n\nindex : 95 --> Decoded string : b'i:'\n\nindex : 96 --> Decoded string : b'</Command>'\n\nindex : 97 --> Decoded string : b'client is behind NAT'\n\nindex : 98 --> Decoded string : b'Register u failed, 0x%x'\n\nindex : 99 - Decoded string : b'/%s/%s/25/%s/'\n\n\n-----\n\ng\n\nindex : 101 --> Decoded string : b'1108'\n\nindex : 102 --> Decoded string : b'ExitProcess'\n\nindex : 103 --> Decoded string : b'POST'\n\nindex : 104 --> Decoded string : b'\\\\cmd.exe'\n\nindex : 105 --> Decoded string : b'PROMPT'\n\nindex : 106 --> Decoded string : b'x64'\n\nindex : 107 --> Decoded string : b'Windows 2000'\n\nindex : 108 --> Decoded string : b'user'\n\nindex : 109 --> Decoded string : b'Unable to load module from server'\n\nindex : 110 --> Decoded string : b'/%s/%s/10/%s/%s/%u/'\n\nindex : 111 --> Decoded string : b'Process has been finished\\n'\n\nindex : 112 --> Decoded string : b'--%s\\r\\nContent-Disposition: form-data; name=\"%S\"\\r\\n\\r\\n'\n\nindex : 113 --> Decoded string : b'Process was unloaded'\n\nindex : 114 --> Decoded string : b'testscript'\n\nindex : 115 --> Decoded string : b'CI failed, 0x%x'\n\nindex : 116 --> Decoded string : b'%08lX%04lX%u'\n\nindex : 117 --> Decoded string : b'Invalid params count'\n\nindex : 118 --> Decoded string : b'WTSQueryUserToken'\n\nindex : 119 --> Decoded string : b'S-1-5-18'\n\nindex : 120 --> Decoded string : b'\\\\Toolwiz-Cleaner'\n\nindex : 121 --> Decoded string : b'dsize:%u'\n\nindex : 122 --> Decoded string : b'GetParentInfo error'\n\nindex : 123 --> Decoded string : b'reload%d'\n\nindex : 124 --> Decoded string : b'/%s/%s/5/%s/'\n\nindex : 125 --> Decoded string : b' '\n\nindex : 126 --> Decoded string : b'D:(A;;GA;;;WD)(A;;GA;;;BA)(A;;GA;;;SY)(A;;GA;;;RC)'\n\nindex : 127 --> Decoded string : b'explorer.exe'\n\nindex : 128 --> Decoded string : b'Unknown'\n\nindex : 129 --> Decoded string : b'x86'\n\nindex : 130 --> Decoded string : b'Content-Type: multipart/form-data; boundary=%s\\r\\nContent-Length: %d\\r\\n\\r\\n'\n\nindex : 131 --> Decoded string : b'pIT GetFolder failed, 0x%x'\n\nindex : 132 --> Decoded string : b'%s %s'\n\nindex : 133 --> Decoded string : b'Windows 7'\n\nindex : 134 --> Decoded string : b'en-EN\\\\'\n\nindex : 135 --> Decoded string : b't:'\n\nindex : 136 --> Decoded string : b'Execute from user'\n\nindex : 137 --> Decoded string :\nb'</Principal>\\n</Principals>\\n<Settings>\\n<MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\\n<DisallowStartIfOnBatteries>false</D\nContext=\"Author\">\\n<Exec>\\n\\t<Command>'\n\nindex : 138 --> Decoded string : b'Windows Server 2008 R2'\n\nindex : 139 --> Decoded string : b'Windows Vista'\n\ni d 140 D d d t i b'R D f il d'\n\n\n-----\n\ng\n\nindex : 142 --> Decoded string : b'/%s/%s/1/%s/'\n\nindex : 143 --> Decoded string : b'SINJ'\n\nindex : 144 --> Decoded string : b'Module already unloaded'\n\nindex : 145 --> Decoded string : b'%016llX%016llX'\n\nindex : 146 --> Decoded string : b'</Arguments>\\n'\n\nindex : 147 --> Decoded string : b'Load to P failed'\n\nindex : 148 --> Decoded string : b'Module is not valid'\n\nindex : 149 --> Decoded string : b'<LogonTrigger>\\n<Enabled>true</Enabled>\\n'\n\nindex : 150 --> Decoded string : b'<moduleconfig>*</moduleconfig>'\n\nindex : 151 --> Decoded string : b'freebuffer'\n\nindex : 152 --> Decoded string : b'failed'\n\nindex : 153 --> Decoded string : b'listed'\n\nindex : 154 --> Decoded string : b'Windows Server 2012 R2'\n\nindex : 155 --> Decoded string : b'50'\n\nindex : 156 --> Decoded string : b'LeaveCriticalSection'\n\nindex : 157 --> Decoded string : b'info'\n\nindex : 158 --> Decoded string : b'ver.txt'\n\nindex : 159 --> Decoded string : b' /C cscript '\n\nindex : 160 --> Decoded string : b'ECCPUBLICBLOB'\n\nindex : 161 --> Decoded string : b'delete'\n\nindex : 162 --> Decoded string : b'm:'\n\nindex : 163 --> Decoded string : b'First'\n\nindex : 164 --> Decoded string : b'/C powershell -executionpolicy bypass -File '\n\nindex : 165 --> Decoded string : b'Global\\\\'\n\nindex : 166 --> Decoded string : b'kps'\n\nindex : 167 --> Decoded string : b'%s/%s/63/%s/%s/%s/%s/'\n\nindex : 168 --> Decoded string : b'%s%s'\n\nindex : 169 --> Decoded string : b'.reloc'\n\nindex : 170 --> Decoded string : b'rundll32'\n\nindex : 171 --> Decoded string : b'<?xml version=\"1.0\" encoding=\"UTF-16\"?>\\n<Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/window\n\nindex : 172 --> Decoded string : b'<LogonType>InteractiveToken</LogonType>\\n<RunLevel>LeastPrivilege</RunLevel>'\n\nindex : 173 --> Decoded string : b'SignalObjectAndWait'\n\nindex : 174 --> Decoded string : b'%s.%s.%s.%s'\n\nindex : 175 --> Decoded string : b'Windows 8'\n\nindex : 176 --> Decoded string : b'exc'\n\nindex : 177 --> Decoded string : b'Launch USER failed'\n\nindex : 178 --> Decoded string : b'regsvr32'\n\nindex : 179 --> Decoded string : b'settings.ini'\n\nindex : 180 --> Decoded string : b'/%s/%s/23/%u/'\n\nindex : 181 --> Decoded string : b'ECDSA_P384'\n\nindex : 182 - Decoded string : b'%u %u %u %u'\n\n\n-----\n\ng\n\nindex : 184 --> Decoded string : b'%s sTart'\n\nindex : 185 --> Decoded string : b'%s %s SP%u'\n\nindex : 186 --> Decoded string : b'.tmp'\n\nindex : 187 --> Decoded string : b'</UserId>'\n\nindex : 188 --> Decoded string : b'%s.%s'\n\nindex : 189 --> Decoded string : b'/'\n\nindex : 190 --> Decoded string : b'Register s failed, 0x%x'\n\nindex : 191 --> Decoded string : b'mutant'\n\nindex : 192 --> Decoded string : b'e:'\n\nindex : 193 --> Decoded string : b'release'\n\nindex : 194 --> Decoded string : b'wtsapi32'\n\nindex : 195 --> Decoded string : b'Windows XP'\n\nindex : 196 --> Decoded string : b'<BootTrigger>\\n<Enabled>true</Enabled>\\n'\n\nindex : 197 --> Decoded string : b'E: 0x%x A: 0x%p'\n\nindex : 198 --> Decoded string : b'Find P failed'\n\nindex : 199 --> Decoded string : b'Module has already been loaded'\n\nindex : 200 --> Decoded string : b'Windows 8.1'\n\nindex : 201 --> Decoded string : b'EnterCriticalSection'\n\nindex : 202 --> Decoded string : b'Windows 10'\n\nindex : 203 --> Decoded string : b'Execute from system'\n\nindex : 204 --> Decoded string : b'<RunLevel>HighestAvailable</RunLevel>\\n<GroupId>NT AUTHORITY\\\\SYSTEM</GroupId>\\n<LogonType>Int\n\nindex : 205 --> Decoded string : b'NAT status'\n\nindex : 206 --> Decoded string : b'Start failed'\n\nindex : 207 --> Decoded string : b'WTSEnumerateSessionsA'\n\nindex : 208 --> Decoded string : b'ps1'\n\nindex : 209 --> Decoded string : b'WaitForSingleObject'\n\nindex : 210 --> Decoded string : b'UrlEscapeW'\n\nindex : 211 --> Decoded string : b'pIT NULL'\n\nindex : 212 --> Decoded string : b'WTSFreeMemory'\n\nindex : 213 --> Decoded string : b'USER32.dll'\n\nindex : 214 --> Decoded string : b'WS2_32.dll'\n\nindex : 215 --> Decoded string : b'IPHLPAPI.DLL'\n\nindex : 216 --> Decoded string : b'WINHTTP.dll'\n\nindex : 217 --> Decoded string : b'bcrypt.dll'\n\nindex : 218 --> Decoded string : b'CRYPT32.dll'\n\nindex : 219 --> Decoded string : b'OLEAUT32.dll'\n\nindex : 220 --> Decoded string : b'SHELL32.dll'\n\nindex : 221 --> Decoded string : b'USERENV.dll'\n\nindex : 222 --> Decoded string : b'SHLWAPI.dll'\n\nindex : 223 --> Decoded string : b'ole32.dll'\n\nindex : 224 - Decoded string : b'ADVAPI32 dll'\n\n\n-----\n\ng\n\nindex : 226 --> Decoded string : b'ncrypt.dll'\n\n**12. Appendix 2 – C2s list**\n\nTrickbot C2 List\n\n36.91.117.231:443\n\n36.89.228.201:443\n\n103.75.32.173:443\n\n45.115.172.105:443\n\n36.95.23.89:443\n\n103.123.86.104:443\n\n202.65.119.162:443\n\n202.9.121.143:443\n\n139.255.65.170:443\n\n110.172.137.20:443\n\n103.146.232.154:443\n\n36.91.88.164:443\n\n103.47.170.131:443\n\n122.117.90.133:443\n\n103.9.188.78:443\n\n210.2.149.202:443\n\n118.91.190.42:443\n\n117.222.61.115:443\n\n117.222.57.92:443\n\n136.228.128.21:443\n\n103.47.170.130:443\n\n36.91.186.235:443\n\n103.194.88.4:443\n\n116.206.153.212:443\n\n58.97.72.83:443\n\n139.255.6.2:443\n\n_[Click here for Vietnamese version.](https://blog.vincss.net/2021/10/re025-trickbot-many-tricks_27.html)_\n\n**Tran Trung Kien (aka m4n0w4r)**\n\n**Malware Analysis Expert**\n\n**R&D Center - VinCSS (a member of Vingroup)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-27 - [RE025] TrickBot ... many tricks.pdf"
    ],
    "report_names": [
        "2021-10-27 - [RE025] TrickBot ... many tricks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536257,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653751427,
    "ts_modification_date": 1653751427,
    "files": {
        "pdf": "https://archive.orkl.eu/f140983892ec39b7419b605cf520f67eb3871eee.pdf",
        "text": "https://archive.orkl.eu/f140983892ec39b7419b605cf520f67eb3871eee.txt",
        "img": "https://archive.orkl.eu/f140983892ec39b7419b605cf520f67eb3871eee.jpg"
    }
}