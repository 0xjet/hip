{
    "id": "120bb1e1-6d8d-4bca-9bba-409928ea8a1f",
    "created_at": "2022-10-25T16:48:23.174454Z",
    "updated_at": "2025-03-27T02:16:41.155771Z",
    "deleted_at": null,
    "sha1_hash": "1ed4d23f831d5a39400067baba7180048ed14bcc",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-07-25T01:35:33Z",
    "file_modification_date": "2019-07-25T01:35:33Z",
    "file_size": 473324,
    "plain_text": "# Chinese APT “Operation LagTime IT” Targets Government Information Technology Agencies in Eastern Asia\n\n**proofpoint.com/us/threat-insight/post/chinese-apt-operation-lagtime-it-targets-government-information-**\n\n\ntechnology\n\n**Overview**\n\n\nJuly 23, 2019\n\n\nProofpoint researchers have identified a targeted APT campaign that utilized malicious\nRTF documents to deliver custom malware to unsuspecting victims. We dubbed this\ncampaign “Operation LagTime IT” based on entities that were targeted and the\ndistinctive domains registered to C&C IP infrastructure.\n\nBeginning in early 2019, these threat actors targeted a number of government agencies\nin East Asia overseeing government information technology, domestic affairs, foreign\naffairs, economic development, and political processes. We determined that the infection\nvector observed in this campaign was spear phishing, with emails originating from both\nfree email accounts and compromised user accounts. Attackers relied on Microsoft\nEquation Editor exploit [CVE-2018-0798 to deliver a custom malware that Proofpoint](https://nvd.nist.gov/vuln/detail/CVE-2018-0798)\nresearchers have dubbed Cotx RAT.\n\nAdditionally, this APT group utilizes Poison Ivy payloads that share overlapping\ncommand and control (C&C) infrastructure with the newly identified Cotx campaigns.\nBased on infrastructure overlaps, post-exploitation techniques, and historic TTPs utilized\nin this operation, Proofpoint analysts attribute this activity to the Chinese APT group\ntracked internally as TA428. Researchers believe that this activity has an operational and\ntactical resemblance to the Maudi Surveillance Operation which was previously reported\nin 2013 [1].\n\n**Delivery**\n\n\n-----\n\nProofpoint researchers initially identified email campaigns with malicious RTF document\nattachments targeting East Asian government agencies in March 2019. These\ncampaigns originated from adversary-operated free email sender accounts at\nyahoo[.]co[.].jp and yahoo[.]com. Sender addresses often imitated common names\nfound in the languages of targeted entities. Spear phishing emails included malicious\n.doc attachments that were actually RTF files saved with .doc file extensions.\n\nThe lures used in the subjects, attachment names, and attachment content in several\ncases utilized information technology themes specific to Asia such as governmental or\npublic training documents relating to IT. On one specific occasion an email utilized the\nsubject “ITU Asia-Pacific Online CoE Training Course on ‘Conformity & Interoperability in\n5G’ for the Asia-Pacific Region, 15-26 April 2019” and the attachment name\n“190315_annex 1 online_course_agenda_coei_c&i.doc”. The conference referenced in\nthe lure was an actual event likely selected due to its relevance to potential victims. This\nis significant as countries in the APAC region continue to adopt Chinese 5G technology\nin government as well as heavy equipment industries.\n\n_Figure 1: Example lure used by TA428 referencing an APAC IT conference_\n\nWe identified several government agencies targeted as part of Operation LagTime IT.\nThese agencies are responsible for overseeing IT, scientific research, domestic affairs,\nforeign affairs, political processes, and financial development.\n\n**Exploitation**\n\nAs we previously noted, the malicious RTF attachments exploited vulnerabilities in the\nMicrosoft Equation Editor, specifically CVE-2018-0798, before downloading subsequent\npayloads. The exploit uses an encoded RTF object to drop a PE file to the Windows\ntemporary directory. The dropped PE file has the distinctive file name “8.t”. When\n\n\n-----\n\nexecuted, writes a Word Add-In file with the .wll extension to the Windows Startup\ndirectory, which runs the next time Word is opened. It should be noted that this dropper\nmethodology is not unique to TA428, and has been identified by security researchers in\ncampaigns related to at least four additional Chinese APT groups. RTF files leveraging\nthis technique have historically contained the string\n\"objw871\\\\objh811\\\\objscalex8\\\\objscaley8\" which has been noted by researchers at\nAnomali [2] and FireEye. Researchers have also recently observed this RTF weaponizer\ntool in commodity campaigns delivering Async RAT.\n\nAfter it is executed, the .wll file renames itself as RasTls.dll. Simultaneously, it decrypts a\nlegitimate Symantec PE binary commonly named IntelGraphicsController.exe or\nAcroRd32.exe. This legitimate Symantec binary is used to side-load RasTls.dll using\nDLL search-order hijacking leading to the execution of Cotx RAT malware. Once\nexecuted the RasTls.dll file next resolves the addresses of the DLL libraries it is\nprogrammed to access and ensures that it is only running in one of five predetermined\nprocesses. These processes are winword.exe, excel.exe, powerpnt.exe, eqnedt32.exe,\nand acrord32.exe. The first four of these processes are associated with Microsoft Word,\nExcel, and PowerPoint exploits, as well as the Equation Editor exploit used by the initial\nmalicious RTF in this campaign. The last process is utilized as part of the loading\nprocess for Cotx RAT and involves the legitimate Symantec binary noted above. The\ninclusion of the processes excel.exe and powerpnt.exe suggests that this stage one\nmalware may be capable of utilizing .xls and .ppsx files as droppers. Researchers at\nSectorB06 [4] have noted this stage-one payload and indicated that throughout the\nabove process it is running a “CheckRemoteDebuggerPresent” function to prevent\nanalysis and debugging by researchers.\n\n**Malware: Cotx RAT**\n\nThe RasTls.dll contains the Cotx RAT code. The malware is written in C++ using objectoriented programming. We named it by borrowing the name of the location of its stored\nconfiguration. The encrypted configuration is stored in the side-loaded DLL file RasTls.dll\nin a PE section named “.cotx”. The current encrypted configuration is also stored in the\nregistry key “HKEY_LOCAL_MACHINE\\SOFTWARE\\Intel\\Java\\user”.\n\nThe configuration data is AES-192-encrypted using CBC mode and base64-encoded.\nWe determined that the encryption key was\n\"98151137ab12780969b2c3612072018709a83a3352466a8b\" (hex-encoded) and the\ninitialization vector “IV” was “2042123224315117031b1a0a3ccda53f” (hex-encoded). In\nplaintext the configuration appears as follows:\n\n*\\x00\\x00\\x00217.69.8.255|||1.187.1.187|mark3|P@SSaw1||\\x00\\x00\n\nThe first four bytes contain the size of the configuration (42-bytes). The\nconfiguration is pipe delimited and contains:\n\n1. C&C host 1\n2. C&C host 2\n3. C&C host 3\n4. Definition of two C&C ports\n\n1. An example string looks like an IP address: \"1.187.1.187\"\n\n\n-----\n\n2. The string is split on .\n3. Port 1 is defined by (piece0 << 8) + piece1 = (1 << 8) + 187 = 443\n4. Port 2 is defined by (piece2 << 8) + piece3 = (1 << 8) + 187 = 443\n5. Alternatively, if the string is not an IP address, but looks like a host, it will\n\nresolve the host into an IP address and calculate the ports using the\nresolved address\n5. \"mark\" field - sent in the C&C beacon\n6. \"passwd\" field - sent in the C&C beacon\n7. Proxy IP and port\n\n1. Discovered by searching the IPv4 TCP connection table for established\n\nconnections with remote ports using common proxy ports (3128, 8080, 808,\n1080)\n2. Or via WINHTTP_OPTION_PROXY\n\nFor persistence, Cotx stores files in a directory “Intel\\Intel(R) Processor Graphics”. The\nlocation of this folder varies among samples with both the %AppData% and\n%PROGRAMFILES% directories being observed.\n\nThe command and control structure of Cotx RAT is proxy aware. It utilizes wolfSSL for\nTLS encrypted communication. The initial beacon contains “|”-delimited system\ninformation. The data included in the beacon is Zlib compressed and encrypted with\nAES-192 in CBC mode utilizing the same keys as the configuration. The following values\nare included:\n\n\"id\" value from \"software\\\\intel\\\\java\" subkey\nComputer name\n\"mark\" field from configuration\nUsername\nWindows version\nArchitecture\nPossible malware version. \"0.9.7\" is hardcoded in the analyzed sample\nLocal IP addresses\nFirst adapter's MAC address\nConnection type (https or _proxy)\n\"password\" field from configuration\n\nCommands from the C&C are received from the malware beacon. This data is AESencrypted. We observed the following commands:\n\n0 - Keep alive, sets a \"poll again\" flag and sends an empty response to C&C\n1 - Sets \"id\" value in \"software\\\\intel\\\\java\" subkey, sends an empty response to\nC&C\n2 - Get directory info or drive info\n5 - Open command shell\n6 - Open command shell as logged in user\n7 - Send command to command shell\n8 - Copy file\n9 - Delete file\n10 - Read file\n\n\n-----\n\n11 - Check for filename. If doesn t exist, check for filename with .ut extension. If it\nexists, send file size back to C&C\n12 - Write file\n13 - Screenshot\n14 - Process listing\n15 - Kill process\n16 - Send current configuration to C&C\n17 - Update config in registry and \".cotx\" PE section\n18 - Set sleep time\n19 - Close C&C comms\n20 - Uninstall and remove self\n21 - Get list of installed software\n22 - Kill command shell\n23 - Exit malware\n24 - Send a \"Ctrl-C\" to the command shell and exit\n25 - Execute an executable\n\n**Malware: Poison Ivy**\n\nTA428 threat actors also delivered Poison Ivy malware payloads. In a limited number of\ncases, we observed attachments utilizing the 8.t dropper methodology described above.\nHowever, the majority of Poison Ivy payloads were dropped as PE files named OSE.exe\nwhen the RTF attachment was executed and an Equation Editor vulnerability was\nsuccessfully exploited. The Poison Ivy samples all communicated with the IP\n95.179.131[.]29. We identified earlier variants of Poison Ivy malware that utilized the\nabove IP via open source research, which used the file names bubbles.exe and sfx.exe.\nExamination of the Poison Ivy malware configurations indicated that all samples shared\nthe password “3&U<9f*lZ>!MIQ” while campaign and group IDs, as well as mutexes\nvaried across campaigns.\n\nWe identified significant operational overlap between Cotx RAT campaigns and Poison\nIvy campaigns. Specifically, on several occasions users that were unsuccessfully\ntargeted with Cotx RAT malware were later targeted with messages distributing Poison\nIvy. Users were also targeted by Poison Ivy malware on successive occasions indicating\nthe adversary’s persistent nature in attempting to compromise targets via spear phishing.\nIn one example, a targeted user received an unsuccessful phishing email attempting to\ndeliver Cotx RAT followed by a Poison Ivy phishing email seven days later. In addition to\na shared targeting list, analysts observed adversary reuse of free email sender accounts\nto deliver both Cotx RAT and Poison Ivy malware to different users. It appears the\nadversary sender accounts utilized delivery TTPs and payloads interchangeably from\nMarch through April 2019. This vacillation of tactics further enforces Proofpoint’s\nclassification of these campaigns under a single operation.\n\n**C&C Infrastructure**\n\nAn examination of the separate C&C infrastructure utilized by Cotx RAT and Poison Ivy\npayloads revealed further overlaps between these campaigns. A review of passive DNS\ninformation indicated that the C&C IPs hosted subdomains that share the root domain\nvzglagtime[.]net. We found that the Poison Ivy C&C IP hosted the domains\n\n\n-----\n\nf1news[.]vzglagtime[.]net and news[.]vzglagtime[.]net. The Cotx RAT C&C IP hosted the\nhostname mtanews.vzglagtime[.]net. The latter of these domains was previously\nreported by security researchers to have been a C&C address observed in a malware\nimplant targeting the East Asian Telecommunications and Transportation sectors in\nJanuary 2019. The presence of related domain registrations on disparate malware IP\ninfrastructure also contributed to analysts’ decision to classify these campaigns\ncollectively under Operation LagTime IT.\n\n**Poison Ivy** **Cotx RAT**\n\n**C&C IP** 95.179.131[.]29 217.69.8[.]255\n\n**Domains Hosted** f1news.vzglagtime[.]net mtanews.vzglagtime[.]net\n\n**by IP** news.vzglagtime[.]net\n\n**Conclusion**\n\nProofpoint analysts assess that Operation LagTime IT is likely a continuation of targeted\nactivity by APT actors aligned with Chinese state interests. This operation, centered\naround East Asian governmental agencies, may represent efforts to satisfy espionage\nand intelligence requirements relative to China’s regional neighbors. While not\nrevolutionary in its approach or malware design, TA428 actors demonstrated significant\npersistence in compromising victims and utilized custom malware. The defined scope of\ntargeting in this operation including government information technology agencies\ndemonstrates a focus on high-value targets. While ultimately the motivation for this APT\ncampaign remains opaque, what is certain is that TA428 persists in targeting users\nresponsible for the orchestration of governmental systems in East Asia.\n\n**References**\n\n[1]\nhttps://paper.seebug.org/papers/APT/APT_CyberCriminal_Campagin/2012/NormanShar\nk-MaudiOperation.pdf\n\n[2] https://www.anomali.com/blog/analyzing-digital-quartermasters-in-asia-do-chineseand-indian-apts-have-a-shared-supply-chain\n\n[3] [https://speakerdeck.com/ashley920/into-the-fog-the-return-of-icefog-apt](https://speakerdeck.com/ashley920/into-the-fog-the-return-of-icefog-apt)\n\n[4] https://threatrecon.nshc.net/2019/04/30/sectorb06-using-mongolian-language-in-luredocument/\n\n**Indicators of Compromise (IOCs)**\n\n|Col1|Poison Ivy|Cotx RAT|\n|---|---|---|\n|C&C IP|95.179.131[.]29|217.69.8[.]255|\n|Domains Hosted by IP|f1news.vzglagtime[.]net news.vzglagtime[.]net|mtanews.vzglagtime[.]net|\n\n|IOC|IOC Type|De‐ scrip‐ tion|\n|---|---|---|\n\n\n-----\n\n304115cef6cc7b81f4409178cd0bcea2b22fd68ca18dfd5432c623cbbb507154 SHA256 Cotx\nRAT\n\n|d0ccb9a277b986f7127199f122023c79a7e0253378a4a78806fbf55a87633532|SHA256|Cotx RAT|\n|---|---|---|\n|81898df69e28a084ea37b77b568ccde34afdf96122ab784f8a361f055281ed0f|SHA256|Cotx RAT|\n|93ac0ff3f01f8b8dfad069944d917e4b0798d42bc9ff97028e5a4ea8bda54dbc|SHA256|Cotx RAT|\n|3dbff4e82dd8ddf71f9228f68df702b8f4add47237f2aee76bd5537489ed2fa9|SHA256|Cotx RAT|\n|cbf607725d128d93fed3b58cde78e1feb7db028a1ed1aa5c924e44faa1015913|SHA256|Poi‐ son Ivy|\n|9a477b455a20a26875e5ff804151f9f6524131c32edf04366cfbaf9d41c83f2a|SHA256|Poi‐ son Ivy|\n|eb0191d1b8e311d2716795e9fa7c0300c5199ebf3d8debff77993f23397d2fb5|SHA256|Poi‐ son Ivy|\n|1bc93ef96134be9a5a7b5f5b747be796a9ff95bdc835d72541673565d1c165b8|SHA256|Poi‐ son Ivy|\n|4c22eb33aa1d10511eaf8d13098e2687e44eae‐ bc5af8112473e28acedac34bea|SHA256|Poi‐ son Ivy|\n|93f56ec68e072ccba8102c71d005604763d064021795c7c8bb1cade05ddb6ff6|SHA256|Poi‐ son Ivy|\n|e9fa0a6223b0e4e60654dc629cd46174b064d5a0968732e6f05bc212a2cdf3f4|SHA256|Poi‐ son Ivy|\n|b7cfea87d7de935e1f20e3c09ba4bd1154580682e75330876f21f241b33946f2|SHA256|8.t Drop‐ per|\n\n\n-----\n\nae3e335cc39c07b‐\nda70e26e89003e0d1b8eea2deda2b62a006517c959fc0a27a\n\n1d492e549d2cbd296bc8e1368c8625df0c82c467c1b4ad‐\ndea7191e4a80bf074e\n\nb541e0e29c34800a067b060d9ee18d8d35c75f056f4246b1ce9561a5441d5a0f\n\n95.179.131[.]29\n\n217.69.8[.]255\n\nf1news.vzglagtime[.]net\n\nnews.vzglagtime[.]net\n\nmtanews.vzglagtime[.]net\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n\nSHA256 8.t\nDrop‐\nper\n\n|1d492e549d2cbd296bc8e1368c8625df0c82c467c1b4ad‐ dea7191e4a80bf074e|SHA256|8.t Drop‐ per|\n|---|---|---|\n|b541e0e29c34800a067b060d9ee18d8d35c75f056f4246b1ce9561a5441d5a0f|SHA256|8.t Drop‐ per|\n|95.179.131[.]29|C2 IP|Poi‐ son Ivy C2|\n|217.69.8[.]255|C2 IP|Cotx RAT C2|\n|f1news.vzglagtime[.]net|Domain|Do‐ main Relat‐ ed by IP|\n|news.vzglagtime[.]net|Domain|Do‐ main Relat‐ ed by IP|\n|mtanews.vzglagtime[.]net|Domain|Do‐ main Relat‐ ed by IP|\n\n\n2836210     ETPRO TROJAN SSL/TLS Certificate Observed (SectorB06 Dropper)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.07.24.Operation_LagTime_IT/Chinese_APT_Operation_LagTime_IT.pdf"
    ],
    "report_names": [
        "Chinese_APT_Operation_LagTime_IT"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5d9dfc61-6138-497a-b9da-33885539f19c",
            "created_at": "2022-10-25T16:07:23.720008Z",
            "updated_at": "2025-03-27T02:02:09.944484Z",
            "deleted_at": null,
            "main_name": "Icefog",
            "aliases": [
                "ATK 23",
                "Dagger Panda",
                "Icefog",
                "Red Wendigo"
            ],
            "source_name": "ETDA:Icefog",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Dagger Three",
                "Fucobha",
                "Icefog",
                "Javafog",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "6fbff48b-7a3e-4e54-ac22-b10f11e32337",
            "created_at": "2022-10-25T16:07:23.318008Z",
            "updated_at": "2025-03-27T02:02:09.734465Z",
            "deleted_at": null,
            "main_name": "APT 4",
            "aliases": [
                "APT 4",
                "Bronze Edison",
                "Maverick Panda",
                "Salmon Typhoo",
                "Sodium",
                "Sykipot",
                "TG-0623",
                "Wisp Team"
            ],
            "source_name": "ETDA:APT 4",
            "tools": [
                "Getkys",
                "Sykipot",
                "Wkysol",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041801,
    "ts_creation_date": 1564018533,
    "ts_modification_date": 1564018533,
    "files": {
        "pdf": "https://archive.orkl.eu/1ed4d23f831d5a39400067baba7180048ed14bcc.pdf",
        "text": "https://archive.orkl.eu/1ed4d23f831d5a39400067baba7180048ed14bcc.txt",
        "img": "https://archive.orkl.eu/1ed4d23f831d5a39400067baba7180048ed14bcc.jpg"
    }
}