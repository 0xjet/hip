{
    "id": "2225aca7-4836-4be2-9e7f-5092fb738482",
    "created_at": "2022-11-23T12:04:34.605851Z",
    "updated_at": "2025-03-27T02:09:07.998479Z",
    "deleted_at": null,
    "sha1_hash": "bbc332b9bd9393cf71ce59c8140199c00eb628ab",
    "title": "PowerPoint Presentation",
    "authors": "",
    "file_creation_date": "2014-11-28T16:13:18Z",
    "file_modification_date": "2014-11-28T16:13:18Z",
    "file_size": 2415984,
    "plain_text": "# Chinese Chicken: Multiplatform DDoS botnets\n\n#### Peter Kálnai @pkalnai\n Jaromír Hořejší @JaromirHorejsi\n\n##### Dec 3[nd] – Dec 5[th] 2014 Nancy, France\n\n\n-----\n\n### Outline\n\n##### • Timeline (+References)\n\n • Binaries, common characteristics\n\n • Advertisements\n\n • Infection vector\n\n • Flooding tools/Trojans:\n\n • Elknot & Bill Gates\n\n • Mr. Black\n\n • IptabLes/IptabLex\n\n • XOR.DDoS\n\n • gh0st RAT\n\n • Statistics and victim preference\n\n\n-----\n\n### Timeline (+ References)\n\n##### • (Edwards, Nazario (ArborNetworks): “A Survey of Contemporary Chinese DDoS\n\n Malware”, VB2011, Barcelona)\n\n • First builder of Linux flooding bot received at our backend in November 2013 \n\n • Secure Honey honeypot: “Trojan Horse Uploaded”, November 2013\n\n • MalwareMustDie! : “Let's be more serious about (mitigating) DNS Amp ELF hack\n\n attack”, December 2013 (Linux:Elknot)\n\n • Sempersecurus: “Another look at a cross-platform DDoS botnet”, Dec 2014\n\n • ValdikSS – “Исследуем Linux Botnet «BillGates»”, February 2014\n\n • Associating Elknot name with previous research, March 2014\n\n\n-----\n\n### Timeline (+ References)\n\n##### • Kaspersky: “Versatile DDoS Trojan for Linux”, July 2014 \n\n • Kaspersky: “elasticsearch Abuse on Amazon Cloud and More for DDoS and\n\n Profit”, July 2014 (Infection chain)\n\n • Prolexic (Akamai): “IptabLes/IptabLex DDoS Bots”, September 2014\n\n • MMD!: “Tango down report of OP China ELF DDoS'er”, September 2014\n\n • MMD!: “MMD-0026-2014 - Router Malware Warning | Reversing an ARM arch\n\n ELF AES.DDoS”, September 2014 (UPX-packed ELF:MrBlack)\n\n • Prolexic (Akamai): “Spike DDoS Toolkit”, October 2014 (ELF:MrBlack)\n\n • ESET: “G20 2014 Summit Lure used to target Tibetan activists”, November\n\n 2014 (Windows gh0st RAT)\n\n • MMD!: “China ELF botnet malware infection & distribution scheme\n\n l h d” N b 2014\n\n\n-----\n\n### Infection chain\n\n##### • Attackers \n\n • build ELF malware using a\n\n customized builder\n\n • start HTTP File Server (HFS) to\n\n host the previously built\n\n malicious binaries\n\n • run port scanners on IP ranges\n\n • Some of the distributed Windows\n\n binaries infected by file infectors\n\n (Parite, Sality, Virut)\n\n\n-----\n\n### Infection chain\n\n##### • If a port of interest is opened: \n\n • script exploiting vulnerabilities\n\n • Elasticsearch RCE: CVE-2014-3120 \n\n • Shellshock\n\n • Apache Struts & Apache Tomcat\n\n • MS08-067 – Vulnerability in Server Service\n\n • Targets windows machines\n\n • Privilege escalation: CVE-2009-2692, CVE-2010-3081, CVE-2013-2094\n\n • SSH brute force attack\n\n • Lists of user names and passwords\n\n • Runs from windows machine, targets Linux servers\n\n\n-----\n\n### Infection chain\n\n##### • Usage of several hacking tools\n\n • Port scanners\n\n • ScanPort\n\n • WinEggDrop\n\n\n-----\n\n### Infection chain\n\n\n-----\n\n### Infection chain\n\n##### • Lists of target IP ranges\n\n • Password lists\n\n • All tools and lists acquired from the HFS file listings on a compromised\n\n machine\n\n\n-----\n\n### Infection chain\n\n##### • Result of a port scan (wineggdrop) as found in an archive on a compromised \n\n machine\n\n • About 2M IPs scanned and 14K hosts with open port 22 found\n\n\n-----\n\n### Binaries, common characteristics\n\n##### • Trojanized flooding tools\n\n • Significant portion of code seems to be shared among all the variants\n\n • Chinese locale\n\n • Some variants written in C++ (objects; classes)\n\n • Debug info often not stripped \n\n • Variety of supported flooding methods\n\n • UDP, TCP/SYN, ICMP, DNS, DNS amplification\n\n • Various communication protocols\n\n • Kill competing resource consuming processes\n\n\n-----\n\n### Binaries, obfuscation techniques\n\n##### • Binaries in plain form or packed with (modified) UPX\n\n • UPX header modifications to avoid unpacking by the original UPX tool\n\n • UPX magic modifications\n\n • UPX magic should be found three times in ELF UPX binary\n\n • All three magic values are the same, but different from “UPX!”\n\n • All three magic values are different\n\n • Checksums do not match \n\n • (ELF:MrBlack; DDoS64; 18442c18d407ba32fdfa2bbf0c86565f)\n\n • Header checksum (custom, 1 byte)\n\n • compressed data (Adler, 4 bytes)\n\n • uncompressed data (Adler, 4 bytes)\n\n\n-----\n\n### Binaries, obfuscation techniques\n\n##### • Architecture mismatch\n\n • (ELF:IptabLesx; .SSHH2; 6feb4677db052e9c7e19de52e3503db7)\n\n • File with a 32-bit UPX header attempts to call 64-bit unpacking method\n\n • Causes reading from wrong offsets\n\n • Expected data size modification\n\n • Pack Header contains incorrect field “uncompressed size”\n\n • Original UPX tool exits with an error\n\n • cannot unpack such modified binaries (very sensitive to PackHeader data)\n\n • Dynamic behavior not altered\n\n\n-----\n\n### Binaries, obfuscation techniques\n\n##### • UPX Header Checksum (0xDD  0x39)\n\n • Decompressing method change: \n\n • UPX_F_LINUX_ELF64_AMD (0x16)\n\n •  UPX_F_BSD_ELF_i386 (0x19) \n\n • Unpacked file size \n\n • 0xB869F  0x8760B \n\n • Header Offset\n\n • 0xBC  0x80\n\n • Compressed data checksum\n\n • 0xBA260B3A  0xF65887DC\n\n\n-----\n\n### Advertisements\n\n##### • Advertised on Chinese forums\n\n\n-----\n\n### Advertisements\n\n##### • Advertised on Chinese forums (translation)\n\n\n-----\n\n### Tools – Elknot\n\n##### • Characteristics:\n\n • Presence of fake.cfg (xmit.ini) as a configuration file\n\n • Available for Linux x86/x64, Windows x86/x64 and FreeBSD\n\n • Command grammar supports 4 tasks:\n\n • StartTask  (0x01)\n\n • StopTask  (0x02)\n\n • WriteFake  (0x03)\n\n • SendStatus  (0x04)\n\n\n-----\n\n### Tools – Elknot’s Text -Box Builders\n\n##### • Lightweight bot builders producing just one version of malware (e.g.\n\n downloaded from www.wowoinn.com)\n\n • The output is a plain Windows, resp. an ELF executable packed with UPX\n\n MD5: 124273f1ec89ff6f53a9ff9cca55c493\n\n MD5: f9294d0820de96c6b139cfcea6dec22d\n\n\n-----\n\n### Tools – Elknot’s Chicken Builder\n\n##### • Large binary with embedded stubs\n\n • Setting up the C&C panel details:\n\n • The IP address of panel\n\n • Port number\n\n • Restriction of MAC address \n\n • Setting up the bot details:\n\n • the IP address of C&C\n\n • Port number\n\n • Platform of an executable\n\n • Potential to produce enormous\n\n number of unique samples with MD5: 71f0e327807cf570f1987a6ea9d45f96\n\n\n-----\n\n### Tools – Elknot for Linux\n\n##### • System performance statistics\n\n • CPU statistics\n\n • /proc/cpuinfo\n\n • /proc/stat\n\n • Network statistics\n\n • /proc/net\n\n\n-----\n\n### Tools – Elknot for Windows\n\n##### • C&C address and port are hardcoded in binary and encrypted by a simple\n\n algorithm\n\n###### 2 - 9 1 / 0 : 0 / 1 1 2 / 8 6 2\n\n -1 +1 -1 +1 -1 +1 -1 +1 -1 +1 -1 -1 +1 -1 +1 -1\n\n == == == == == == == == == == == == == == == ==\n\n 1 . 8 2 . 1 9 1 . 2 0 1 0 7 7 1\n\n|2|-|9|1|/|0|:|0|/|1|1|Col12|2|/|8|6|2|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|-1|+1|-1|+1|-1|+1|-1|+1|-1|+1|-1||-1|+1|-1|+1|-1|\n|==|==|==|==|==|==|==|==|==|==|==||==|==|==|==|==|\n\n\n-----\n\n### Tools – Elknot for Windows\n\n##### • System performance statistics (uses Performance Monitor)\n\n • CPU frequency\n\n\n-----\n\n### Tools – Elknot for Windows\n\n##### • Debug info contains the string “Chicken”:\n\n • Installs into %PROGRAMFILES%/DbProtectSupport/svchost.exe\n\n • Persistence via creating a new item in Run registry key\n\n • Dropper (2fd539598af48b8ea96ba39c957ee73f)  32/64-bit version of payload\n\n • 32-bit version installs only one file – payload named svchost.exe\n\n • 64-bit version installs additional signed components, which are part of\n\n WinPcap\n\n • Npf.sys = NetGroup Packet Filter driver, allows packet capture, packet\n\n injection, network monitoring\n\n • Packet.dll = communication with npf.sys\n\n f Wi d S 2008 R2 (64 bi l )\n\n\n-----\n\n### Tools – Elknot’s C&C Panels\n\n##### • Supported attack methods (SYN, UDP flood, etc.)\n • List of connected bots with system info\n • Targeted IP address with a port\n • Number of threads, attack time etc.\n • Additional dialogs with more options\n\n\n-----\n\n### Tools – Elknot’s C&C Panels\n\n##### • Generated C&C panel from the Chicken builder\n\n\n-----\n\n### Tools – Bill Gates for Linux\n\n##### • named after two files created in /tmp directory; contain PID of itself\n\n • /tmp/bill.lock – created by payload\n\n • /tmp/gates.lock – created by dropper\n\n • Supported flooding methods (controlled from C&C):\n\n • CAttackIcmp\n\n • CAttackSyn\n\n • CAttackUdp\n\n • CAttackAmp (DNS amplification)\n\n • CAttackCC\n\n • CAttackDns\n\n • CAttackTns\n\n C&C d i il h Elk\n\n\n-----\n\n### Tools – Bill Gates for Linux\n\n##### • Characteristics:\n\n • Persistence\n\n • /etc/init.d/DbSecuritySpt\n\n • crontab: \n```\n# Edit this file to introduce tasks to be run by cron.\n# Edit this file to introduce tasks to be run by cron.\n*/98 * * * * nohup /etc/kysapd > /dev/null 2>&1&\n*/97 * * * * nohup /etc/skysapd > /dev/null 2>&1&\n*/96 * * * * nohup /etc/xfsdx > /dev/null 2>&1&\n*/95 * * * * nohup /etc/ksapd > /dev/null 2>&1&\n\n```\n\n-----\n\n### Tools – Bill Gates for Linux\n\n##### • Script performing regular actions via cron:\n\n • Killing competing processes (Elknot’s node24; .IptabLes)\n\n • Updating its executables (> 1hour)\n\n\n-----\n\n### Tools – Bill Gates for Linux\n\n##### • Configuration data are encrypted with RSA-1024\n\n • On the stack: prime P, prime Q, modulus N & decrypted string\n\n • P ^ Q % N = configuration string\n\n\n-----\n\n### Tools – Bill Gates for Linux\n\n##### • Decrypted payload: 116.10.189.246:35000:1:1:h:579368:579884:580400\n\n • g_strConnTgts = 116.10.189.246  … IP address\n\n • g_iGatsPort  = 35000  … port\n\n • g_iGatsIsFx  = 1\n\n • g_iIsService  = 1 … persistence\n\n • g_strBillTail  = h … payload fname suffix\n\n • g_strCryptStart = 579368 = 0x8d728  … config\n\n • g_strDStart  = 579884 = 0x8D92C  … exponent\n\n • g_strNStart  = 580400 = 0x8DB30 … modulus\n\n\n-----\n\n### Tools – Bill Gates for Windows\n\n##### • Persistence: registry key in Run\n • Debug string similar to Win32:Elknot:\n\n • Dropper (3621a7c9b9b350326dcf4baa880e5771)  32/64-bit version of payload &\n\n service VS process; Usage of agony rootkit (source published, 2006); \n\n • 2 payloads named svch0st.exe and DbSecuritySpt.exe in\n\n %PROGRAMFILES%/DbSecuritySpt;\n\n • SafeEngine protection libraries (SeSDKDummy.dll, SeSDKDummy64.dll)\n\n • 64-bit version (Windows Server 2008):\n\n • Npf.sys = NetGroup Packet Filter driver, allows packet capture, packet injection,\n\n network monitoring\n\n\n-----\n\n### Tools – Mr. Black\n\n##### • Large family containing also a malware group called AES.DDoS\n\n • Contains various character strings: VERSONEX, VERS0NEX, Mr.Black, Hacker,\n\n DealWithDDoS, “Int Server...”\n\n • List of attack supporting procedures \n\n • DNS_Flood, SYN_Flood, UDP_Flood, UDPS_Flood, TCP_Flood, CC_Flood,\n\n CC2_Flood, CC3_Flood, etc…\n\n • Available for architectures: \n\n • EM_386, EM_x86_64, EM_MIPS, EM_ARM, PE x86\n\n • 1be4fa407f83c927cfd49ba03af816e2, 861f4c1e8fe1e5c059d558ea1e465d86,\n\n 008ecf29e0c95f05be2a83a635d7ac31, fdcefb4b0541453a6d78c42094d71ba7\n • Devices may include: desktops, servers, routers, Internet of Things devices\n\n\n-----\n\n### Tools – IptabLes/IptabLex\n\n##### • Accompanied with a process killing the competing processes\n\n • Competition over computer resources\n\n • List of all the processes to kill is downloaded and named fuckopen.txt or kill.txt\n\n\n-----\n\n### Tools – IptabLes/IptabLex\n\n##### • MD5: c17cb63de68a37de222b5315bc0ea47e (EM_386),\n\n e79c37e207f8695b61291b2e85636aef (EM_x86_64) (ELF:Iptablesx)\n\n • Persistence: \n\n • Installs itself into /boot/IptabLex, resp. /boot/IptabLes\n\n • symbolic links in /etc directory\n\n • List of attack supporting procedures \n\n • SynFloodThread\n\n • DnsFloodThread\n\n • Command grammar supports: add task, delete task, set source IP, self-update \n\n • Additional Windows 32-bit variants (iptables.exe, getsetup.exe)\n\n • 455068e0444107ee5fb993f34a184e03\n\n\n-----\n\n### Tools – XOR.DDoS\n\n##### • MD5: fd3f2c810f4391be2e6b82429c53c318 (ELF:Xorddos)\n\n • More advanced Trojan for EM_386 & EM_x86_64 installed in /boot/<random> and\n\n autostarted via a script in /etc/init.d\n\n • Flooding features: build_dns, build_syn\n\n • Named after encryption method used with xorkeys = “BB2FA36AAA9541F0”\n • Strings: “/var/run/sftp.pid”, “/lib/udev/udev”, “/lib/udev/”, “/boot/”, “/var/run/”, “http://info.3000uc.com/config.rar”, “/var/run/sftp.pid”\n\n • Contains embedded rootkit (LKM) running as rs_dev\n\n • Rootkit features: hide_file, hide_proc, hide_tcp4_ports, hide_tcp6_ports,\n\n hide_udp4_ports, hide_udp6_ports; firewall_acceptip, firewall_dropip\n\n • Trojan (userspace) requests rootkit features (the kernel) via ioctl with the code\n\n 0x9748712\n\n\n-----\n\n### Tools – gh0st RAT C&C panel & Bot Builder\n\n##### • Strings “Chicken”, “Hacker”; Windows only; source shared; huge number of samples\n\n\n-----\n\n### Statistics\n\n##### • Number of victims is lower than in case\n\n of other Windows threats\n\n • HTTP servers running on compromised\n\n machines show thousands of\n\n downloads, but considering self\n updates the number could be lower\n\n • Download count of ”Bill Gates”\n\n installer is highlighted\n\n\n-----\n\n### Statistics\n\n##### • Downloads from HFS server on a different machine, showing tens of\n\n thousands downloads\n\n\n-----\n\n### Statistics – Preferences of File Names\n\n\n-----\n\n### Victim preferences\n\n##### • Attacked small or medium sized local businesses\n\n • profitability depends of ability to stay online\n\n • Victims:\n\n • Online gaming site/casinos\n\n • E-commerce shops\n\n • Forums\n\n • Potential methods of monetization:\n\n • DDoS as a service\n\n • paying ransom for stopping the DDoS attack\n\n • Effect of DDoS directly observed: \n\n • sites unreachable during the process of receiving attack commands\n\n • reachability recovered after the process stopped\n\n\n-----\n\n### Victim preferences\n\n##### • Online gaming\n\n\n-----\n\n### Victim preferences\n\n##### • Online casinos\n\n\n-----\n\n### Victim preferences\n\n##### • E-shops\n\n\n-----\n\n### Victim preferences\n\n##### • Forums\n\n\n-----\n\n### Conclusion\n\n##### • Chinese flooding tools continue in tradition of DDoS attacks \n\n • Lots of variants with similar flooding methods under multiple platforms\n\n • The complexity of Linux Trojans has increased\n\n • Attacks significantly more frequent in the past year\n\n • Tool development supported by code sharing through Chinese forums for\n\n developers\n\n • Targeting online services for which online availability is crucial\n\n • (intentional) AV evasion technique with (customized) UPX packer\n\n • Right time to include a static unpacker for ELF UPX into AV engines?\n\n\n-----\n\n### Acknowledgement\n\n##### • We thank to:\n\n • Lin Song (University of Iowa)\n\n • @benkow_\n\n\n-----\n\n## Thank you\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://www.botconf.eu/wp-content/uploads/2014/12/2014-2.10-Chinese-Chicken-Multiplatform-DDoS-Botnets.pdf"
    ],
    "report_names": [
        "2014-2.10-Chinese-Chicken-Multiplatform-DDoS-Botnets.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1669205074,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1417191198,
    "ts_modification_date": 1417191198,
    "files": {
        "pdf": "https://archive.orkl.eu/bbc332b9bd9393cf71ce59c8140199c00eb628ab.pdf",
        "text": "https://archive.orkl.eu/bbc332b9bd9393cf71ce59c8140199c00eb628ab.txt",
        "img": "https://archive.orkl.eu/bbc332b9bd9393cf71ce59c8140199c00eb628ab.jpg"
    }
}