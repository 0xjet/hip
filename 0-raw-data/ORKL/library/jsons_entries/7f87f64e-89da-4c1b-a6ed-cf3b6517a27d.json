{
    "id": "7f87f64e-89da-4c1b-a6ed-cf3b6517a27d",
    "created_at": "2022-10-25T16:48:19.352943Z",
    "updated_at": "2025-03-27T02:16:25.570439Z",
    "deleted_at": null,
    "sha1_hash": "0e5301e830d7b19600b2d110115d7c0f0ab86b02",
    "title": "Sidewinder Targeted Attack Against Android In The Golden Age Of Ad Libraries",
    "authors": "FireEye",
    "file_creation_date": "2014-08-08T07:21:15Z",
    "file_modification_date": "2014-08-08T07:22:05Z",
    "file_size": 3689700,
    "plain_text": "## SIDEWINDER TARGETED ATTACK AGAINST ANDROID IN THE GOLDEN AGE OF AD LIBRARIES\n\n# SECURITY\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\n## CONTENTS\n\n###### Introduction................................................................................................................................................................................................................................................................................................................................................3\n\n Sidewinder Targeted Attack Overview.............................................................................................................................................................................................................................3\n\n Warhead: Attacking Vulnerabilities of Android........................................................................................................................................................................................5\n\n Piercing The Armor.................................................................................................................................................................................................................................................................................................5\n\n Detonation without Android Context....................................................................................................................................................................................................................7\n\n Detonation with Android Context...................................................................................................................................................................................................................................8\n\n Targeting Victims Based on Ad Traffic............................................................................................................................................................................................................................11\n\n Communication Channels Prone to Hijack..........................................................................................................................................................................................11\n\n Information Leakage from Ad Libraries.......................................................................................................................................................................................................11\n\n Large-scale Monitoring and Precise Hijacking...........................................................................................................................................................................12\n\n Targetable and Exploitable Google Play Apps .........................................................................................................................................................................................13\n\n Conclusion................................................................................................................................................................................................................................................................................................................................................. 20\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\n###### Introduction\nBy 2014, the number of Android users has\ngrown to 1.1 billion and the number of Android\ndevices has reached 1.9 billion[1]. At the same\ntime, enterprises are also embracing Androidbased Bring Your Own Device (BYOD) solutions.\nFor example, in Intel’s BYOD program, there are\nmore than 20,000 Android devices across over\n800 combinations of Android versions and\nhardware configurations[2].\n\nAlthough little malware has been found in Google\nPlay, both Android apps and the Android system\nitself contain vulnerabilities. Aggressive ad\nlibraries also leak the user’s private information.\nBy leveraging all these vulnerabilities, an attacker\ncan conduct more targeted attacks, which we call\n“Sidewinder Targeted Attacks.” In this paper we\nexplain the security risks from such attacks, in\nwhich an attacker can intercept and use private\ninformation uploaded from ad libraries to\nprecisely locate targeted areas such as a CEO’s\noffice or specific conference rooms. When the\ntarget is identified, a “Sidewinder Targeted Attack”\nexploits popular vulnerabilities in ad libraries, such\nas Javascript-binding-over-HTTP or dynamicloading-over-HTTP, etc.\n\nIt is a well-known challenge for an attacker to call\nAndroid services from injected native code that\ndoesn’t have Android application context. Here,\nwe explain how attackers can invoke Android\nservices for tasks including taking photos, calling\nphone numbers, sending SMS, reading from/\nwriting to the clipboard, etc. Furthermore, the\nattackers can exploit several Android\nvulnerabilities to get valuable private information\nor to launch more advanced attacks.\n\n\nFinally, we show that this threat is not only real\nbut also prevalent due to the popularity of\nAndroid ad libraries. We hope this paper\nkickstarts the conversation on how to better\nprotect the security and privacy in third-party\nlibraries and how to further harden the Android\nsecurity framework in the future.\n\n###### Sidewinder Targeted Attack Overview\nTo understand the security risks brought by a\nSidewinder Targeted Attack, we first explain one\npossible attack mechanism (illustrated in Figure 1)\nthat is similar to that of Sidewinder missiles. The\nattacker can hijack the network where the\ntargeted victim resides. Like an infrared homing\nsystem, the attacker then seeks “emission” from ad\nlibraries running on the target device to track and\nlock on it. Once the target is locked on, the\nattacker can launch advanced persistent attacks.\nTo minimize detection chances, the attacker can\nchoose to take action on important targets only,\nignoring all other devices. In later sections, we\ndiscuss attacking (“warhead”) and targeting\n(“homing”) components in detail and show how a\ncombination of these components can launch\npowerful and precise attacks on target devices.\n\nTable 1 proposes different attacks that an\nattacker can launch remotely on target devices\nthrough vulnerable ad libraries. Figure 2 shows a\nproof-of-concept attack control interface. This\nattack targets one of the ad libraries described in\nthis paper. The security risks become obvious by\nlooking at what the attacker can do with this\ncontrol interface. The left panel enables the\nattacker to command the victim's device,\n\n\n1 Ranjit Atwal, Lillian Tay, Roberta Cozza, Tuong Huy Nguyen, Tracy Tsai, Annette Zimmermann, and CK Lu. Forecast: Pcs, ultramobiles and mobile phones,\nworldwide, 2010-2017, 4q13 update. Gartner, 2013.\n2 Rob Evered, Steve Watson, Paul Dockter, and Derek Harkin. Android devices in a byod environment. Intel White Paper, 2013.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\nincluding uploading local files, taking pictures,\nrecording audio/video, manipulating the\nclipboard, sending SMS, dialing numbers,\nimplanting bootkit, or installing the attacker’s\napps uploaded to Google Play, etc. The right\npanel lists all information stolen from the\nvictim’s device. In this screenshot, the victim’s\n\n\ninstalled app list, clipboard, a photo taken from\nthe back camera, an audio clip, and a video clip\nhave been uploaded, with the GPS location\nintercepted from the ad library. The panel also\npins down the GPS location of the victim’s\ndevice onto a Google Map widget.\n\n\nDevice B\n\n\n**Table 1: Outline**\nof the Sidewinder\nTargeted\nAttack through\nVulnerable Ad\nLibraries\n\n|Col1|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|API Level||≤ API 16||> API 16|\n|Attack Vector||JBOH and DLOH||JS Sidedoor|\n|Attacks||(w/ Android Context ) Clipboard manipulation Launcher settings modification Proxy modification Taking pictures Audio & video recording Stealthy app installation|(w/o Android Context ) Local files uploading Root exploit & Code injection Implanting bootkit Sending SMS Making phone calls|Abusing privileged interfaces|\n\n\n**API Level**\n\nAttack Vector\n\nAttacks\n\n\nDevice A\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\nBased on this precise position information, it is easy to identify individuals or groups of “VIP” targets by\nwhich offices they are in.\n\n\n**Figure 2: The**\ncontrol panel of\nthe attacker, and\nthe files uploaded\nfrom the victim\n\n\n###### Warhead: Attacking Vulnerabilities  of Android \n\n**Piercing The Armor**\nIn this section, we explain in more detail the risks\nof remote attacks on the Android devices.\n\n**Attacking JavaScript Binding over**\n**HTTP (JBOH)**\nAndroid uses the JavaScript binding method\n`addJavascriptInterface` to enable JavaScript\ncode running inside a WebView to access the\napp’s Java methods (also known as the Javascript\nbridge). However, it is widely known that this\nfeature, if not used carefully, presents a potential\nsecurity risk when running on Android API 16\n\n\n(Android 4.1) or below. As noted by Google: “Use\nof this method in a WebView containing\nuntrusted content could allow an attacker to\nmanipulate the host application in unintended\nways, executing Java code with the permissions\nof the host application.”[3]\n\nIn particular, if an app running on Android API 16\nor below uses the JavaScript binding method\n```\naddJavascriptInterface and loads the content\n\n```\nin the WebView over HTTP, an attacker over the\nnetwork could hijack the HTTP traffic (e.g.,\nthrough WiFi or DNS hijacking) to inject\nmalicious content into the WebView and to\ncontrol the host application. Listing 1 is a sample\nJavascript snippet to execute shell command.\n\n\n3 http://developer.android.com/reference/android/webkit/WebView.html# addJavascriptInterface(java.lang.Object,%20java.lang.String).\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\n**Figure 3: Target**\nSDK statistics of\npopular Google\nPlay apps 31.08% API <=16\n\n###### API >=16\n\n##### 68.92%\n\n(a) Statistics by app number\n\n**Listing 1: Sample**\nJavascript snippet `jsObj.getClass().forName(”java.lang.Runtime”)`\nto execute shell `.getMethod(”getRuntime”,null).invoke(null,null).exec(cmd)`\ncommand\n\nWe call this the JavaScript-Binding-Over-HTTP\n(JBOH) vulnerability[4]. This applies to insecure\nHTTPS channels as well. If an app containing such\nvulnerability has sensitive Android permissions\nsuch as access to the camera, a remote attacker\ncould exploit it to perform sensitive tasks such as\ntaking photos or recording video, over the\nInternet, without consent. Based on the official\ndata in June 2014[5], ~60% of Android devices are\nstill running API≤16.\n\nNote that API>16 platforms are not necessarily\nsecure. If the app is targeting at a lower API\nlevel, Android will still run it with the lower API\nlevel for compatibility reasons. Figure 3 shows\nthe targeted API of popular Google Play apps,\neach of which has over 50,000 downloads. We\ncan see that a large portion of apps are\ntargeting at API≤16.\n\n\n**Attacking Annotated JavaScript**\n**Binding Interfaces**\nStarting with Android 4.2 (API>16), Google\nintroduced the @JavascriptInterface\nanno- tation[6] to explicitly designate and restrict\nwhich public Java methods in the app were\naccessible from JavaScript running inside\na WebView. However, if an ad library uses the\n```\n@JavascriptInterface annotation to expose\n\n```\nsecurity-sensitive interfaces, and uses HTTP to\nload content in the WebView, it is vulnerable to\nattacks where an attacker over the network\ncould inject malicious content into the WebView\nto misuse the interfaces exposed through the JS\nbinding annotation. We call these exposed JS\nbinding annotation interfaces “JS Sidedoors.”\n\nFor example, we found a list of sensitive\nJavascript interfaces that are publicly ex- posed\nfrom certain versions of a real-world ad library:\n\n\n4 http://www.fireeye.com/blog/technical/2014/01/js-binding-over-http- vulnerability-and-javascript-sidedoor.html.\n5 https://developer.android.com/about/dashboards/index.html.\n6 http://developer.android.com/reference/android/webkit/ JavascriptInterface.html.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n```\n            createCalendarEvent, makeCall,\n            postToSocial, sendMail, sendSMS,\n            takeCameraPicture, getGalleryImage,\n            registerMicListener, etc[4]. Given that this ad\n\n```\nlibrary loads ads using HTTP, if the host app has\nthe corresponding permissions (e.g., CALL\nPHONE), attackers over the network can abuse\nthese interfaces to do malicious things (e.g.,\nutilizing the makeCall interface to dial phone\nnumbers without the user’s consent).\n\n**Security Issues with DEX Loading over**\n**HTTP (DLOH)**\nSimilar to JBOH, DEX loading over HTTP or\ninsecure HTTPS (DLOH) is another serious issue\nraised by ad libraries. If the attackers can hijack\nthe communication channels and inject malicious\nDEX files, they can then control the behaviors of\nthe victim apps.\n\n**Detonation without Android Context**\nAfter getting local access, the attacker can upload\nprivate and sensitive files from the victim’s device,\nor modify files that the host app can write to (e.g.,\nthe directory of the host app and SD Card with\nFAT file system).\n\nTo launch more sophisticated attacks like sending\nSMS or taking pictures, the attackers may use\nJava reflection to call other APIs from the\nJavascript bridge. It appears this method makes\nsending SMS easy. However, some other\noperations require Android context[ 7] or\nregistering Java callbacks. Android context\nprovides an interface to the global information\nabout an app’s environment. Many Android\n\n**Listing 2: Sending**\nSMS without user\nconsent\n\n7 http://developer.android.com/reference/android/content/Context.html.\n8 http://shuaji.360.cn/root/.\n9 http://towelroot.com/.\n10 http://linux.die.net/man/2/ptrace.\n\n\nfunctionalities, especially remote call invocations,\nare encapsulated in the context. We discuss\nattacks requiring context in a later section. In this\nsection, we explain attacks that don’t need\nAndroid context, and discuss their security risks.\n\n**Root Exploits and Code Injection**\nOne direct threat posed by JBOH is to use the\nJBOH shell (Listing 1) to download exe- cutables\nand use them to root the device. Commercial\none-touch root apps claim they can root more\nthan 1,000 brands (>20,000 models)[ 8].\n```\ntowelroot[9], which exploits a bug found\n\n```\nrecently in Linux kernel, claims that it can root\nmost new devices released before June 2014.\nThus, as long as attackers can get the JBOH shell,\nthey have the tools to obtain root on most\nAndroid phone models.\n\nEven if the attackers can’t obtain root, they can\nattempt ptrace [10] to control the host app.\nAlthough only processes with root privilege can\nptrace others, child processes are able to\nptrace their parents. Because the shell\nlaunched from the Javascript bridge is a child\nprocess of the host app, it can ptrace the host\napp’s process. Note that only apps with\n```\nandroid:debuggable set as “true” in the manifest\n\n```\ncan be ptraced, which limits its adoption.\n\n**Sending SMS and Dialing Numbers without**\n**User Consent**\nSending SMS does not require context or user\ninteraction. A simple call does the job, as\nshown in Listing 2\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\nTo make calls from the Javascript bridge\nwithout user consent, we can invoke the\ntelephony service to dial numbers directly via\nbinder, as shown in Listing 3, where phone is\nthe remote Android telephony service and the\nnumber 2 represents the second remote call.\n```\n            s16 is the type marker represents “16 bit\n\n```\nstring,” and packageName is the host app’s\npackage name, where we can obtain from the\ninformation posted from the ad libraries. The\nsequence number of the remote calls can be\nfound in the corresponding Android Interface\n\nDefinition Language (AIDL) files[11]. Many other\nAndroid services can be invoked in the same\nway, including sending SMS\n\n**Detonation with Android Context**\nAs mentioned, it is more convenient to\ndirectly obtain the Android context via the\n\n**Listing 3: Dial**\nnumbers without `Runtime.getRuntime()`\nuser consent `.exec(”service call phone 2 s 16 ”+ packageName +” s16” + phoneNumber);`\n\n**Listing 4: Sample**\ncode to obtain // We omit all try−catch statements and other unimportant code in this paper\ncontext\n```\n              public ContextgetContext(){\n                 finalClass<?>activityThreadClass=Class\n                   .forName(”android.app ActivityThread”);\n                 finalMethodmethod=activityThreadClass\n                   .getMethod(”currentApplication”);\n                 return(Application)method.invoke(null,(Object[])null);\n              }\n\n```\n11 http://developer.android.com/guide/components/aidl.html.\n12 http://developer.android.com/reference/dalvik/system/DexClassLoader. html.\n\n\nJavascript bridge. Code in Listing 4, for\nexample, is an easy way to get context from\nanywhere of the application.\n\nOperations like taking pictures and recording\nvideos need to register Java callbacks. The\nattackers either need to boot a Java VM from\nthe Javascript bridge, or to inject code into\nthe host app’s Java VM.\n\nFortunately, Android Runtime offers another\nway to load Java Native Interface (JNI) code\ninto the host app using Runtime.load(). As\nshown in Listing 5, an attacker can load\nexecutables compiled from JNI code. Once\nloaded, the code can obtain context as described\nin Listing 4, or call DexClassLoaderload[12] to\ninject new classes from the attackers’ DEX\nfiles to register callbacks to take pictures/\nrecord videos.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\nThere are other ways to obtain Android context,\nlike reflecting to the private static context\nvariable of WebView[13]. However, without Java\nVM instances, it’s difficult to take pictures and\nrecord videos. After our submission to Black Hat\nin April 2014, we noticed that MWR was also\nconcurrently and independently working on this\nissue. They published a similar mechanism in\nJune 2014[14].\n\n**Clipboard Monitoring nd Tampering**\nWith the Android context, an attacker can\nmonitor or tamper with the clipboard. Android\nusers may perform copy-paste on important text\ncontent. For example, there are many popular\npassword-management apps in Google Play,\nenabling the users to click-and-copy passwords\n\n**Listing 5: Sample**\nJavascript snippet `jsObj.getClass().forName(”java.lang.Runtime”)`\nto load JNI binary `.getMethod (”getRuntime”,null).invoke(null,null).load(binaryPath );`\ninto the host app’s\nJava VM\n\n**Listing 6: API**\ncalls to peek into/ `ClipboardManager.getText()`\ntamper with the `ClipboardManager.hasPrimaryClip()`\n```\n              ClipboardManager.setText()\n```\nclipboard\n```\n              Clipboard Manager.setPrimaryClip()\n              ClipboardManager.hasText()\n              ClipboardManager.addPrimaryClipChangedListener()\n              ClipboardManager.getPrimaryClip()\n\n```\nand paste them into login forms. Malicious\napps can steal the passwords if they can read\nthe contents on clipboard. Android has no\npermissions restricting apps from accessing\nthe global clipboard. Any UID has the capability\nto manipulate clipboard via the API calls in Listing 6:\n\n\nUsing these APIs, the attackers can monitor\nchanges to a clipboard and transfer the\nclipboard contents to some remote server.\nThey can also alter the clipboard content to\nachieve phishing goals. For example, the user\nmay copy a link to visit and the background\nmalicious service can change that link to a\nphishing site. We have notified Google about\nthis issue.\n\n**Launcher Settings Modification**\nAndroid Open Source Project (AOSP) classifies\nAndroid permissions into several protec- tion\nlevels: “normal,””dangerous,” “system,”\n“signature” and “development”[15,16,17]. Dangerous\npermissions“may be displayed to the user and\nrequire confirmation before pro- ceeding, or\n\nsome other approach may be taken to avoid\nthe user automatically allowing the use of such\nfacilities.”In contrast, normal permissions are\nautomatically granted at installation, “without\nasking for the user’s explicit approval (though\nthe user always has the option to review these\n\n\n13 http://www.weibo.com/p/1001603724694418249344?utm_source=weibolife.\n14 https://labs.mwrinfosecurity.com/blog/2014/06/12/putting-javascript- bridges-into-android-context.\n15 http://developer.android.com/guide/topics/manifest/permission-element.html.\n16 https://android.googlesource.com/platform/frameworks/base/+/master/ core/res/AndroidManifest.xml.\n17 https://android.googlesource.com/platform/packages/apps/Launcher2/+/ master/AndroidManifest.xml.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\npermissions before installing)”[15]. If an app requests\nboth dangerous permissions and normal\npermissions, Android only displays the dangerous\nper- missions by default. If an app requests only\nnormal permissions, Android doesn’t display any\npermission to the user.\n\nWe have found that certain “normal” permissions\nhave dangerous security impacts[18]. For example,\nthe attackers can manipulate Android home\nscreen icons using two normal permissions:\nlauncher READ SETTINGS and WRITE\nSETTINGS permissions. These two permissions\nenable an app to query, insert, delete, or modify\nall launcher configuration settings, including icon\ninsertion or modification.\n\nAs a proof-of-concept attack scenario, a malicious\napp with these two permissions can query/insert/\nalter the system icon settings and modify\nlegitimate icons of some security- sensitive apps,\nsuch as banking apps, to a phishing website.\n\nAfter our notification, Google has patched this\nvulnerability in Android 4.4.3 and has released the\npatch to its OEM partners. However, according to\nGoogle[5], by 7 July 2014, 17.9% Android devices\nare using Android 4.4. Given that Android 4.4.2\nand below has this vulnerability, over 82.1%\nAndroid devices are vulnerable.\n\n**Proxy Modification**\nWith the CHANGE WIFI STATE permission,\nAndroid processes can change the proxy\nsettings of WIFI networks (not solely the currently\nconnected one). To do this, the attacker can use\nthe remote calls exposed by WifiManager to\nobtain the WifiConfiguration objects, then\ncreate new proxySettings to replace to a\n\n\ncorresponding field. Note that the\n```\nproxySettings field is a private Java field not\n\n```\nintended to be accessed by other processes.\nUnfortunately, the flexible and powerful Java\nreflection mechanism (especially the forName(),\n```\ngetField(), setAccessible() calls) exposes\n\n```\nsuch components to the attackers for arbitrary\nread or write operations.\n\n**Taking Pictures and Recording Audio/Video**\n**without User Interaction**\nAndroid audio recording via the MediaRecorder\nAPIs does not need user interaction or\nconsent, which makes it easy to record sound\nin the background.\n\nOn the contrary, taking pictures and recording\nvideos are more challenging. First, this requires\nregistering Java callbacks. Second, Android warns\nthat “Preview must be started before you can take\na picture”[19]. It seems that taking pictures and\nrecording videos without user notification is\nimpossible. However, security largely depends on\nthe correct implementation and enforcing a\nflawless implementation is difficult. On some of\nthe popular phones (models anonymized for\nsecurity consideration), startPreview() is\nrequired to take pictures/record videos;\nHowever, it’s highly possible that on these\ndevices takePicture() fails to check whether a\nview has been presented to the user.\nFortunately, we have never witnessed a case\nwhere the MediaRecorder can shoot videos\nwithout calling setPreviewDisplay. But we\nwere able to create and register a dummy\n```\nSurfaceView to the WindowManager, which made \n\n```\ntaking photos and videos possible even on\ndevices that properly checked for an\nexisting preview.\n\n\n18 http://www.fireeye.com/blog/technical/2014/04/occupy_your_icons_ silently_on_android.html.\n19 http://developer.android.com/reference/android/hardware/Camera.html.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\n**Stealthy App Installation by Abusing**\n**Credentials**\nWith both the GET ACCOUNTS and the USE\nCREDENTIALS permissions, Android pro- cesses\ncan get secret tokens of services (e.g., Google\nservices) from the AccountManager and use them\nto authenticate to these services[20]. We verified\nthat Android apps with these two permissions can\nauthenticate themselves with the user’s Google\naccount, allowing access to Google Play and the\nability send app installation requests. Through the\nJavascript bridge, attackers can install apps of\nchoice (e.g., an attacker’s phishing app) to any\ndevices registered in user’s account in the\nbackground without user consent.  Combined\nwith the launcher modification attack introduced\nearlier, the attackers can redirect other app icons\n(e.g., bank or email app icons) to the phishing app\nand steal the user’s login credentials.\n\n###### Targeting Victims Based on Ad Traffic\nIn this section, we explain the risks of victims’\ndevices being tracked and targeted through\nad traffic.\n\n**Communication Channels Prone to Hijack**\nIt is well known that communication via HTTP is\nprone to hijacking and data tamper- ing. Though\nad libraries may not have the incentive to abuse\nusers’ private and sensitive data, this is not the\n\n\ncase with the attackers eavesdropping or hijacking\nthe HTTP traffic. Switching to HTTPS may not\nsolve this issue since the HTTPS security relies on\na flawless implementation, which is difficult. For\nexample, there are cases where the developer\nfailed (intentionally or unintentionally) to check\nthe server’s certificate[21]. We found that some of\nthe most popular ad libraries (see Table 3) have\nthis issue. We successfully launched Man-in-theMiddle (MITM) attacks and intercepted the data\nuploaded to the remote server. Note that even if\nthe ad libraries have a correct and rigorous\nimplementation, the SSL library itself may contain\nserious vulnerabilities that can be exploited by\nMITM attacks[22,23].\n\n**Information Leakage from Ad Libraries**\nAlmost every ad library uploads local information\nfrom Android devices. Based on our observations,\nthey do so mostly for purposes such as checking\nfor platform compatibility and user interest\ntargeting. The information most frequently\nuploaded includes IMEI, Android version,\nmanufacturer, Android ID, device specification,\ncarrier information, host app information,\ninstalled app list, etc. Table 3 lists the info\nuploaded from the top five popular ad libraries.\n\nListing 7 is a captured packet posted to the\nremote ad server by one of the ad libraries. It is\n\n\n20 http://seclists.org/bugtraq/2014/Mar/52.\n21 Sascha Fahl, Marian Harbach, Thomas Muders, Lars Baumga¨rtner, Bernd Freisleben, and Matthew Smith. Why eve and mallory love android: An analysis\nof android ssl (in) security. In Proceedings of the 2012 ACM conference on Computer and communications security, pages 50–61. ACM, 2012.\n22 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224.\n23 http://www.fireeye.com/blog/technical/2014/04/if-an-android-has-a- heart-does-it-bleed.html.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\ncaptured from a popular Google Play app. From\nthis packet we can tell the device’s screen density\n(d-device-screen-density), screen size (d-devicescreen-size), host app’s pack- age name (u-appBId),\nhost app’s name (u-appDNM)1, host app’s version\n(u-appVer), user agent (h-user-agent), localization\n(d-localization), mobile network type (d-netType),\nscreen orientation (d-orientation), and GPS\nlocation (u-latlong-accu). The most important\ninfor- mation is the GPS location, where the\nvictim’s latitude, longitude and the location\nprecision are shown. It is reasonable for an ad to\nobtain this information to improve the ad-serving\nexperience. However, with this information, an\nattacker can precisely locate the victim and\nacquire the device’s specifications.\n\n**Large-scale Monitoring and Precise Hijacking**\nTo locate victims effectively, an attacker needs to\nmonitor large-scale network traffic containing\nsuch private information. Unfortunately, several\nwell-known attacks can be used to achieve\nlarge-scale monitoring, including DNS hijacking,\nBGP hijacking, and ARP hijacking in IDC.\n\nIn this context, DNS hijacking is done to subvert\nthe resolution of Domain Name System (DNS)\nqueries through modifying the behavior of DNS\nservers so that they serve fake DNS information.\n\n\nDNS hijacking is legally and maliciously used in\nmany situations including traffic management,\nphishing and censorship. Attackers successfully\ncompromised many DNS servers, including the\nones from Google and Godaddy[24]. By DNS\nhijacking, attackers can effectively access all the\ntraffic to ad servers.\n\nBGP hijacking takes over groups of IP addresses,\ncorrupting Internet routing tables by breaking\nBGP sessions or injecting fake BGP information.\nThis enables attackers to monitor all traffic to\nspecific IPs. Historically, there were many BGP\nhijacking attacks that affected YouTube, DNS root\nservers, Yahoo, and many other important\nInternet services[25].\n\nARP hijacking (or spoofing) in IDC[26] is done to\nhijack the traffic to the ad server in the IDC where\nthe ad server locates through fake ARP packets.\nAttackers may rent servers close to the target\nservers, and use fake ARP packets to direct all the\ntraffic to go through the hijacking servers first for\nmonitoring and hijacking..ARP hijacking is a\nwell-known approach used in network attacks.\n\nUsing the large-scale traffic intercepted from the\nabove methods, attackers can iden- tify potential\nvictims based on information leakage such as GPS\n\n\n24 https://isc.sans.edu/diary/Domaincontrol+(GoDaddy)+Nameservers+DNS+ Poisoning+/5146.\n25 http://www.networkworld.com/article/2272520/lan-wan/six-worst-internet- routing-attacks.html.\n26 http://en.wikipedia.org/wiki/ARP\\_spoofing.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\nlocation described in Sec- tion 4.2. After that,\nthey can inject exploits only into the targeted\ntraffic to launch further attacks. Attackers keep a\nlow profile by allowing all other irrelevant\nnetwork traffic to pass without being modified.\n\n###### Targetable and Exploitable Google Play Apps\nWe used the FireEye Mobile Threat Prevention\n(MTP) engine to analyze all of the ~73,000\npopular apps from Google Play with more than\n50,000 downloads, and identified 93 ad libraries.\nThe detailed ad library inclusion statistics are\nshown in Figure 4. Seventy-one% of the apps\ncontain at least one ad library, 35% have at least\ntwo ad libraries, and 22.25% include at least\nthree ad libraries. The largest ad inclusion\nnumber is 35. Since Google is cautious about the\nsecurity of the products it directly controls, we\nexclude Google Ad from the following discussion.\nFor security considerations, in this paper we\nanonymize the names of the other 92 ad libraries,\n\n\nusing Ad1, Ad2, ..., Ad92 to refer to them, where\nthe subscripts represent the rankings of how\nmany apps include the ad libraries. The top five\npopular ad libraries’ inclusion and download\nstatistics are listed in Table 2.\n\nWe analyzed the 92 ad libraries found in the\npopular Google Play apps, and summa- rized the\ncommunication channel vulnerabilities in Table\n3. Combined with the uploaded information\ncolumn we can learn about the data the\nattackers can obtain.\n\nFifty-seven of the 92 ad libraries in the popular\nGoogle Play apps have the JBOH issue.\nSpecifically, four of the top five ad libraries are\nsubject to this problem (shown in Table 2). Seven\nof the 92 ad libraries are prone to DLOH attacks.\nParticularly, some versions of Ad5 in Table 3 have\nthis problem. The affected Google Play apps\nnumber and the accumulated download counts\nare listed in Table 4.\n\n\n**Table 2: The**\ninclusion statistics\nof the top five\nAndroid ad\nlibraries excluding\nGoogle Ad. Their\nJBOH statistics\nare also listed\n(discussed in\nthe earlier JBOH\nsection.).\n\n|Ad Library|Number of Apps|JBOH Apps|Total Downloads|JBOH Downloads|\n|---|---|---|---|---|\n|Ad 1|9,702|2,802|8,781M|2,348M|\n|Ad 2|8,856|4,204|7,865M|4,754M|\n|Ad 3|8,818|2,117|8,499M|1,611M|\n|Ad 4|5,519|1,112|4,687M|617M|\n|Ad 5|5,170|0|4,519M|0|\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\n\n**Table 3: The**\nuploaded data,\ncommunication\nchannel\nvulnerabilities, and\nJBOH/DLOH details\nof the top five ad\nlibraries.\n\n|Ad Library|Uploaded Info|Protocol|SSL Vuln|JBOH|DLOH|\n|---|---|---|---|---|---|\n|Ad 1|IMEI/device id, device model, An- droid version, location|HTTP/ HTTPS||||\n|Ad 2|device specification, Android version, host app info, location|HTTP||||\n|Ad 3|IMEI/device id, device model, An- droid version, device manufacturer, carrier info, location, ip|HTTP||||\n|Ad 4|IMEI/device id, device model, device specification, Android version|HTTP||||\n|Ad 5|IMEI/device id, device model, device specification, Android version, coun- try, launguage|HTTPS||||\n\n\n**Table 4: Assessment statistics**\nof Google Play apps (downloads\n≥50,000) that are vulnerable to the\nSidewinder Targeted Attack. Type I\napps are those subject to JBOH or\nDLOH attacks; Type II apps are those\nnot only JBOH/DLOH exploitable but\nalso have the LOCATION leakage\n(thus vulnerable to the Sidewinder\nTargeted Attack). Note that an app\nis counted in the total statistics if\nit is subject to any of the attacks,\nincluding uploading files and root\nexploits.\n\n|Subject to attack type|Type I #|Type I Downloads|Type II #|Type II Downloads|\n|---|---|---|---|---|\n|Code injection via ptrace|2,055|444M|272|67M|\n|Send SMS|349|340M|229|254M|\n|Make phone calls|572|399M|426|324M|\n|Launcher modification|111|95M|81|37M|\n|Proxy modification|644|792M|419|378M|\n|Record audio|1,097|1,408M|654|621M|\n|Take pictures/record videos|1,141|1,380M|622|665M|\n|Install apps stealthily|351|552M|197|332M|\n|Total(incl. root exploits)|16,579|11,706M|4,201|3,207M|\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\n###### Conclusion\nIn the current golden age of Android ad\nlibraries, Sidewinder Targeted Attacks can\ntarget victims using info leakage and other\nvulnerabilities of ad libraries to get valuable,\nsensitive information. Millions of users are still\nunder the threat of Sidewinder Targeted\nAttacks. First we need to improve the security\nand privacy protection of ad libraries. For\nexample, we encourage ad libraries’ publishers\nto use HTTPS with proper SSL certificate\n\n### Sidewinder Targeted Attacks can target victims using info leakage and other vulnerabilities of ad libraries to get valuable, sensitive information. Millions of users are still under the threat of Sidewinder Targeted Attacks.\n\nvalidation, and to properly encrypt network\ntraffic. They also need to be cautious about\nwhich privileged interfaces are exposed to the\nad providers, in case of malicious ads or\nattackers hijacking the communication channels.\n\nMeanwhile, Google itself needs to further\nharden the security framework. This may prove\ndifficult because:\n\n\n1. Android is a complex system. Any subcomponent’s vulnerability may impact the\nsecurity of the whole system.\nFragmentation makes the situation even\nmore challenging.\n\n2. The trade-off between usability,\nperformance and security always matters,\nand market demand frequently dictates\nthat security comes last. Many Android\ndevelopers do not even understand how\nto program securely (as shown in the\nJBOH issue).\n\n3. Many security patches are not back-ported\nto old versions of Android (like the launcher\nsettings problem described earlier), even\nthough older versions are widely used.\n\n4. There is always information asymmetry in\nthe development chain. For example, it\nusually takes several months for vendors to\napply security patches after Google\nreleases them.\n\nAlbeit challenging, we hope that this work\ncan kickstart a conversation, both on\nimproved security and privacy protection in\nthird-party libraries and on a hardened\nAndroid security framework.\n\n\n-----\n\n**FireEye: Sidewinder Targeted Attack against Android**\n\n###### About FireEye, Inc.\nFireEye has invented a purpose-built, virtual\nmachine-based security platform that provides\nreal-time threat protection to enterprises and\ngovernments worldwide against the next\ngeneration of cyber attacks. These highly\nsophisticated cyber attacks easily circumvent\ntraditional signature-based defenses, such as\nnext-generation firewalls, IPS, anti-virus, and\ngateways. The FireEye Threat Prevention Platform\n\n\nprovides real-time, dynamic threat protection\nwithout the use of signatures to protect an\norganization across the primary threat vectors and\nacross the different stages of an attack life cycle.\nThe core of the FireEye platform is a virtual\nexecution engine, complemented by dynamic threat\nintelligence, to identify and block cyber attacks in\nreal time. FireEye has over 1,900 customers across\nmore than 60 countries, including over 130 of the\nFortune 500.\n\n\nFireEye, Inc. | 1440 McCarthy Blvd. Milpitas, CA 95035 | 408.321.6300 | 877.FIREEYE (347.3393) | info@fireeye.com | www.fireeye.com\n\n© 2014 FireEye, Inc. All rights reserved. FireEye is a registered trademark of FireEye,\nI All th b d d t i b t d k i\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/qwg36lcvf9iaz3alks4w24btqcxmzlkq",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.08.04.Sidewinder_GoldenAge/fireeye-sidewinder-targeted-attack.pdf"
    ],
    "report_names": [
        "fireeye-sidewinder-targeted-attack"
    ],
    "threat_actors": [
        {
            "id": "6b9fc913-06c6-4432-8c58-86a3ac614564",
            "created_at": "2022-10-25T16:07:24.185236Z",
            "updated_at": "2025-03-27T02:02:10.135195Z",
            "deleted_at": null,
            "main_name": "SideWinder",
            "aliases": [
                "APT-C-17",
                "APT-Q-39",
                "BabyElephant",
                "GroupA21",
                "HN2",
                "Hardcore Nationalist",
                "Rattlesnake",
                "Razor Tiger",
                "SideWinder",
                "T-APT-04"
            ],
            "source_name": "ETDA:SideWinder",
            "tools": [
                "BroStealer",
                "Capriccio RAT",
                "callCam"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "173f1641-36e3-4bce-9834-c5372468b4f7",
            "created_at": "2022-10-25T15:50:23.349637Z",
            "updated_at": "2025-03-27T02:00:55.450857Z",
            "deleted_at": null,
            "main_name": "Sidewinder",
            "aliases": [
                "Sidewinder",
                "T-APT-04"
            ],
            "source_name": "MITRE:Sidewinder",
            "tools": [
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d0c0a5ea-3066-42a5-846c-b13527f64a3e",
            "created_at": "2023-01-06T13:46:39.080551Z",
            "updated_at": "2025-03-27T02:00:02.992026Z",
            "deleted_at": null,
            "main_name": "RAZOR TIGER",
            "aliases": [
                "SideWinder",
                "APT-C-17",
                "T-APT-04"
            ],
            "source_name": "MISPGALAXY:RAZOR TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1407482475,
    "ts_modification_date": 1407482525,
    "files": {
        "pdf": "https://archive.orkl.eu/0e5301e830d7b19600b2d110115d7c0f0ab86b02.pdf",
        "text": "https://archive.orkl.eu/0e5301e830d7b19600b2d110115d7c0f0ab86b02.txt",
        "img": "https://archive.orkl.eu/0e5301e830d7b19600b2d110115d7c0f0ab86b02.jpg"
    }
}