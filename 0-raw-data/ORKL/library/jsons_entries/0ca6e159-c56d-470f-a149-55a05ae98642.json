{
    "id": "0ca6e159-c56d-470f-a149-55a05ae98642",
    "created_at": "2023-01-12T14:59:15.752169Z",
    "updated_at": "2025-03-27T02:09:30.075493Z",
    "deleted_at": null,
    "sha1_hash": "3c529f94d69818cff31895fcd04f667383910b0b",
    "title": "2022-07-20 - Luna and Black Basta — new ransomware for Windows, Linux and ESXi",
    "authors": "",
    "file_creation_date": "2022-08-18T03:28:00Z",
    "file_modification_date": "2022-08-18T03:28:00Z",
    "file_size": 1538078,
    "plain_text": "# Luna and Black Basta — new ransomware for Windows, Linux and ESXi\n\n**securelist.com/luna-black-basta-ransomware/106950**\n\nAuthors\n\n[Marc Rivero](https://securelist.com/author/marcrivero/)\n\n[Jornt van der Wiel](https://securelist.com/author/jorntvanderwiel/)\n\n[Dmitry Galov](https://securelist.com/author/dmitrygalov/)\n\nSergey Lozhkin\n\n## Introduction\n\nIn our crimeware reporting service, we analyze the latest crime-related trends we come\nacross. If we look back at what we covered last month, we will see that ransomware\n(surprise, surprise!) definitely stands out. In this blog post, we provide several excerpts from\nlast month’s reports on new ransomware strains.\n\n## Luna: brand-new ransomware written in Rust\n\n\n-----\n\nLast month, our Darknet Threat Intelligence active monitoring system notified us of a new\nadvertisement on a darknet ransomware forum.\n\nAs one can see from the advertisement, the malware is written in Rust and runs on\nWindows, Linux and ESXi systems. Armed with this knowledge, we went hunting for\nsamples, finding a few via the Kaspersky Security Network (KSN).\n\n**_Command line options available in Luna_**\n\nJudging by the command line options available, Luna is fairly simple. The encryption scheme\nit uses, however, is not so typical, as it involves x25519 and AES, a combination not often\nencountered in ransomware schemes.\n\nBoth the Linux and ESXi samples are compiled using the same source code with some\nminor changes from the Windows version. For example, if the Linux samples are executed\nwithout command line arguments, they will not run. Instead, they will display available\narguments that can be used. The rest of the code has no significant changes from the\nWindows version.\n\nThe advertisement states that Luna only works with Russian-speaking affiliates. Also, the\nransom note hardcoded inside the binary contains spelling mistakes. For example, it says “a\nlittle team” instead of “a small team”. Because of this, we assume with medium confidence\nthat the actors behind Luna are speakers of Russian. Since Luna is a freshly discovered\ngroup, there is still little data on its victimology, but we at Kaspersky are following Luna’s\nactivity.\n\nLuna confirms the trend for cross-platform ransomware: current ransomware gangs rely\n[heavily on languages like Golang and Rust. A notable example includes BlackCat and Hive.](https://securelist.com/a-bad-luck-blackcat/106254/)\nThe languages being platform agnostic, the ransomware written in these can be easily\nported from one platform to others, and thus, attacks can target different operating systems\nat once. In addition to that, cross-platform languages help to evade static analysis.\n\n## Black Basta\n\nBlack Basta is a relatively new ransomware variant written in C++ which first came to light in\nFebruary 2022. The malware, the infrastructure and the campaign were still in development\nmode at the time. For example, the victim blog was not online yet, but the Black Basta\nwebsite was already available to victims.\n\n\n-----\n\nBlack Basta supports the command line argument -forcepath that is used to encrypt only\nfiles in a specified directory. Otherwise, the entire system, with the exception of certain\ncritical directories, is encrypted.\n\nTwo months after the first encounter, in April, the ransomware had grown more mature. New\nfunctionality included starting up the system in safe mode before encryption and mimicking\nWindows Services for persistence reasons.\n\nThe safe-mode reboot functionality is not something we come across every day, even though\nit has its advantages. For example, some endpoint solutions do not run in safe mode,\nmeaning the ransomware will not be detected and files in the system can be “easily”\nencrypted. In order to start in safe mode, the ransomware executes the following commands:\n\nC:\\Windows\\SysNative\\bcdedit /set safeboot networkChanges\nC:\\Windows\\System32\\bcdedit /set safeboot networkChanges\n\nEarlier versions of Black Basta contained a different rescue note from the one currently used,\nwhich showed similarities to the ransom note used by Conti. This is not as odd as it may\nseem, because Black Basta was still in development mode at the time.\n\n**_Rescue notes comparison_**\n\nTo ascertain that there was indeed no code overlap between Conti and the earlier versions of\nBlack Basta, we fed a few samples to the Kaspersky Threat Attribution Engine (KTAE).\nIndeed, as shown below, only the strings overlap. There is thus no overlap in code per se.\n\n\n-----\n\n**_Overlap with Conti ransomware_**\n\n## Black Basta for Linux\n\nIn another report we wrote last month, we discussed the Black Basta version for Linux. It was\nspecifically designed to target ESXi systems, but it could be used for general encryption of\nLinux systems as well, although that would be a bit cumbersome.\n\nJust like the version for Windows, the Linux version supports only one command line\nargument: “-forcepath”. When it is used, only the specified directory is encrypted. If no\narguments are given, the “/vmfs/volumes” folder is encrypted.\n\nThe encryption scheme for this version uses ChaCha20 and multithreading to speed up the\nencryption process with the help of different processors in the system. Given that ESXi\nenvironments typically use multiple CPUs to execute a VM farm, the malware’s design,\nincluding the chosen encryption algorithm, allows the operator to have the environment\nencrypted as soon as possible. Prior to encrypting a file, Black Basta uses the chmod\ncommand to get access to it in the same context as the user level.\n\n## Black Basta targets\n\nAnalysis of the victims posted by the Black Basta group revealed that to date, the group has\nmanaged to attack more than forty different victims within a very short time it had available.\nThe victim blog showed that various business sectors were affected including manufacturing,\n\n\n-----\n\nelectronics, contractors, etc. Based on our telemetry, we could see other hits across Europe,\nAsia and the United States.\n\n## Conclusion\n\nRansomware remains a big problem for today’s society. As soon as some families come off\nthe stage, others take their place. For this reason, it is important to stay on top of all\ndevelopments in the ransomware ecosystem, so one can take appropriate measures to\nprotect the infrastructure.\n\n[A trend, which we also discussed in our previous blog post, is that ESXi systems are](https://securelist.com/new-ransomware-trends-in-2022/106457/)\nincreasingly targeted. The aim is to cause as much damage as possible. Luna and Black\nBasta are no exceptions. We expect that new variants will support encryption of VMs by\ndefault as well.\n\nFor questions or more information about our crimeware reporting service, please contact\n[crimewareintel@kaspersky.com.](mailto:crimewareintel@kaspersky.com)\n\n[Cross-platform malware](https://securelist.com/tag/cross-platform-malware/)\n[Cybercrime](https://securelist.com/tag/cybercrime/)\n[Data Encryption](https://securelist.com/tag/data-encryption/)\n[ESXi](https://securelist.com/tag/esxi/)\n[Linux](https://securelist.com/tag/linux/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Microsoft Windows](https://securelist.com/tag/microsoft-windows/)\n[Non-Windows Malware](https://securelist.com/tag/non-windows-malware/)\n\n\n-----\n\n[Ransomware](https://securelist.com/tag/ransomware/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\n[Marc Rivero](https://securelist.com/author/marcrivero/)\n\n[Jornt van der Wiel](https://securelist.com/author/jorntvanderwiel/)\n\n[Dmitry Galov](https://securelist.com/author/dmitrygalov/)\n\nSergey Lozhkin\n\nLuna and Black Basta — new ransomware for Windows, Linux and ESXi\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-20 - Luna and Black Basta — new ransomware for Windows, Linux and ESXi.pdf"
    ],
    "report_names": [
        "2022-07-20 - Luna and Black Basta — new ransomware for Windows, Linux and ESXi.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "faa4a29b-254a-45bd-b412-9a1cbddbd5e3",
            "created_at": "2022-10-25T16:07:23.80111Z",
            "updated_at": "2025-03-27T02:02:09.985067Z",
            "deleted_at": null,
            "main_name": "LookBack",
            "aliases": [
                "FlowingFrog",
                "LookBack",
                "LookingFrog",
                "TA410",
                "Witchetty"
            ],
            "source_name": "ETDA:LookBack",
            "tools": [
                "FlowCloud",
                "GUP Proxy Tool",
                "SodomMain",
                "SodomMain RAT",
                "SodomNormal"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535555,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1660793280,
    "ts_modification_date": 1660793280,
    "files": {
        "pdf": "https://archive.orkl.eu/3c529f94d69818cff31895fcd04f667383910b0b.pdf",
        "text": "https://archive.orkl.eu/3c529f94d69818cff31895fcd04f667383910b0b.txt",
        "img": "https://archive.orkl.eu/3c529f94d69818cff31895fcd04f667383910b0b.jpg"
    }
}