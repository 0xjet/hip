{
    "id": "5923b5c7-b99e-4a98-af63-0371349fe490",
    "created_at": "2023-01-12T15:03:52.568738Z",
    "updated_at": "2025-03-27T02:16:37.055583Z",
    "deleted_at": null,
    "sha1_hash": "dd6d6a3ae850e8648eeb5add2679ec501ec96651",
    "title": "2018-02-01 - JenX – Los Calvos de San Calvicie",
    "authors": "",
    "file_creation_date": "2022-05-28T01:26:54Z",
    "file_modification_date": "2022-05-28T01:26:54Z",
    "file_size": 1051152,
    "plain_text": "# JenX – Los Calvos de San Calvicie\n\n**[blog.radware.com/security/2018/02/jenx-los-calvos-de-san-calvicie/](https://blog.radware.com/security/2018/02/jenx-los-calvos-de-san-calvicie/)**\n\n[Security](https://blog.radware.com/security/)\n[Attack Types & Vectors](https://blog.radware.com/security/attack-types-and-vectors/)\n\nBy\n\n[Pascal Geenens](https://blog.radware.com/author/pascalg/)\n\nFebruary 1, 2018\n[0](https://blog.radware.com/security/2018/02/jenx-los-calvos-de-san-calvicie/#respond)\n11968\n\n\nFebruary 1, 2018\n\n\n-----\n\nSource: sancalvicie.com\nA new botnet recently started recruiting IoT devices. The botnet uses hosted servers to find\nand infect new victims leveraging one of two known vulnerabilities that have become popular\nin IoT botnets recently:\n\n[CVE-2014-8361 “Realtek SDK Miniigd UPnP SOAP Command Execution” vulnerability](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8361)\n[and related exploit.](https://www.exploit-db.com/exploits/37169/)\n[CVE-2017–17215 “Huawei Router HG532 – Arbitrary Command Execution”](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17215)\n[vulnerability and related exploit.](https://www.exploit-db.com/exploits/43414/)\n\n[Both exploit vectors are known from the Satori botnet and based on code that was part of a](https://www.trendmicro.com/vinfo/au/security/news/internet-of-things/source-code-of-iot-botnet-satori-publicly-released-on-pastebin)\n[recent public Pastebin post by the “Janit0r,” author of “BrickerBot.”](https://blog.radware.com/security/2017/04/brickerbot-dark-knight-iot/)\n\n[The malware also uses similar techniques as seen in the recently discovered PureMasuta,](https://blog.newskysecurity.com/masuta-satori-creators-second-botnet-weaponizes-a-new-router-exploit-2ddc51cc52a7)\nwhich had its source code published in an invite-only dark forum as of late.\n\n\n-----\n\nOur investigation led us to a C2 server hosted under the domain sancalvicie.com of which\nthe [site provides](http://sancalvicie.com/) [GTA San Andreas Multi-Player mod servers with DDoS Services on the](https://www.rockstargames.com/games/info/sanandreas)\nside. Below is a screenshot of the services with the details:\n\nHosting and DDoS-as-Service offerings at SanCalvicie.com\nThe SAMP option provides a multi-player gaming service for GTA San Andreas and explicitly\nmentions the protection against Source Engine Query and other DDoS floods.\n\nThe Corriente Divina (“divine stream”) option is described as “God’s wrath will be employed\nagainst the IP that you provide us.” It provides a DDoS service with a guaranteed bandwidth\nof 90-100Gbps and attack vectors including Valve Source Engine Query and 32bytes floods,\nTS3 scripts and a “Down OVH” option which most probably refers to attacks targeting the\n[hosting service of OVH, a cloud hosting provider that also was a victim of the original Mirai](https://www.ovh.com/)\nattacks back in September 2016. OVH is well known for hosting multi-player gaming servers\nsuch as Minecraft, which was the target of the Mirai attacks at the time.\n\nImagine my surprise when I was redacting my initial report for the blog and I visited the site\nagain and found the DDoS attack service description to have changed – they’ve upgraded\ntheir service!\n\n\n-----\n\nHosting and DDoS-as-Service offerings at SanCalvicie.com – couple of hours later, the same\nday\nNote the new mention of “Bots” and the increased guaranteed DDoS volume of 290300Gbps. They must be confident of their new botnet they started to deploy just two days\nago…\n\n**_[[You might also like: 10 Cyber Security Questions with Radware’s Pascal Geenens]](https://blog.radware.com/security/2017/02/10-cyber-security-questions/)_**\n\n## Exploits\n\nOn Jan 30th our IoT honeypots registered multiple exploit attempts from distinct servers, all\nlocated in different hosting centers in Europe.\n\n[The exploits based on CVE-2014-8361 try to perform an RCE through three individual SOAP](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8361)\nposts to port 52869 using the URL /picsdesc.xml\n\n\n-----\n\nThe [CVE-2017–17215 based exploits use a POST to /ctrlt/DeviceUpgrade_1 on port 37215](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17215)\nand a slightly different command sequence to download and execute the malware, first\nattempting to kill any competing bots that might be resident on the device:\n\n\n-----\n\nThe malware binary is called jennifer and was in all occurrences downloaded from the same\nserver 5.39.22.8 which is hosted at a different provider compared to the provider of the\nexploit servers.\n\nThe download server hosts samples for MIPS, ARM and x86, all very recently uploaded:\n\nIOCs for the samples at time of analysis:\n\nUntypical for IoT botnets we have witnessed in the past year, this botnet uses servers to\n[perform the scanning and the exploits. Nearly all botnets, including Mirai,](https://blog.radware.com/security/2016/11/insight-into-mirais-source-code/) [Hajime, Persirai,](https://blog.radware.com/security/2017/04/hajime-futureproof-botnet/)\n[Reaper, Satori and Masuta perform distributed scanning and exploiting. That is, each victim](https://blog.radware.com/security/2017/10/iot_reaper-botnet/)\nthat is infected with the malware will perform its own search for new victims. This distributed\nscanning provides for an exponential growth of the botnet, but comes at the price of flexibility\nand sophistication of the malware itself.\n\nWithout scanning and exploit payloads, the bot code itself becomes unsophisticated and\nlighter on the delivery. At the same time, centralizing the scan and exploit functionality\nprovides the maintainers with more flexibility to add and improve the functionality as they go.\nThe scan and exploit functionality can also be coded in higher level languages such as\nPython or Go and leverage the much richer ecosystem of modules and libraries without fear\nof impacting the size of the bot. They don’t even have to limit themselves to scripting or\nprogramming and can leverage whatever tools are available to create an integrated and\nautomated scan and exploit system.\n\nWhen providing scanning and exploit capabilities in the bot itself, it must (or should) be\nimplemented in C or another compiled language and should not expect any of the\ndependencies to be present on the multitude of devices and platforms For every statically\n\n\n-----\n\nlinked library that increases the richness of the core language, the size of the bot and also its\nfingerprint increases. By identifying the libraries linked with a malware, it is easier on the\nsecurity researchers to reverse and interpret exploits or techniques used by the malware.\n\nLess nodes scanning and exploiting also means the botnet is less noisy overall and less\nprobable that it will get detected by honeypots. Moreover, they stay under the radar of the\n[autonomous PDoS botnet known as BrickerBot. At the same time, it makes it more difficult](https://www.youtube.com/watch?v=zgAtIG9WqsM)\nfor researchers to estimate the size of the botnet without having access to the command and\ncontrol servers. Finally, the impact on the resources, including the bandwidth of the network\nconnection of the victims will be minimal until the bot is actually instructed to perform an\nattack.\n\nThe drawback of the central approach is a less than linear growth with the number of\ndeployed servers. Much slower compared to the exponential growth rate of and less\naggressive than distributed scanning botnets.\n\nOur much denser global Deception Network confirms the global reach of each of the\nscanning and exploit servers. When filtering on the IP addresses of the exploit servers we\ndiscovered SYN scans directed at the port corresponding to the specific exploit the server\nwas equipped with. This confirms the mass scan and surgical approach to exploit in order to\nnot create too much noise and stay undetected.\n\nGlobal Deception Network stats for one of the Realtek exploit servers\n\n## Malware\n\n\n-----\n\nUpon execution, the Jennifer binary forks three processes and writes the below message to\nthe terminal before exiting.\n\nThe three forked processes have their names obfuscated in the process table much like\nMirai does. The malware is also protected with anti-debugging detection to prevent running it\nwith tracing or in a debugger. All processes are listening to a port bound to localhost while\none for the processes opens a TCP socket to the command and control server located at\n80.82.70.202 on port 127. The TCP session is kept alive for the duration of the process’\nexistence.\n\nStrings in the binary have been obfuscated:\n\n\n-----\n\nThe message “gosh that chinese family at the other table sure ate a lot” which is printed to\nthe terminal is a nice gift from the author(s). The string is 58 characters long and provides a\ngood starting point for finding the obfuscation algorithm and key without having to go through\na more painful and lengthy reversing. In the C pseudo code reversed from the binary it is\neasy to locate a candidate string with the exact same number of characters:\n\nSome very basic cryptanalysis with Python soon revealed the obfuscation algorithm to be a\nsimple XOR with a fixed key 0x45:\n\n\n-----\n\nApplying the XOR with 0x45 on the obfuscated strings reveals their plain text version:\n\n\n-----\n\nThere is still the question on how to get the string that contains the hostname of the C2\nserver behind IP 80.82.70.202 which we witnessed earlier. The reverse domain is of no use\nfor making sensible guesses to attribute the botnet:\n\nThe string containing the hostname can be found in the reversed pseudo code below:\n\nPassing the string through the XOR with 0x45 does not produce the expected results. Some\nbrute forcing helped us find the key 0x22 – this same XOR obfuscation with the exact same\n[key was used to obfuscate usernames and passwords in PureMasuta – coincidence](https://blog.newskysecurity.com/masuta-satori-creators-second-botnet-weaponizes-a-new-router-exploit-2ddc51cc52a7)\nconsidering that PureMasuta’s code was shared on an invite-only hacker forum?\n\nUltimately, we found by XORing with 0x22 the hostname of the C2 server to be\n‘skids.sancalvicie.com’.\n\n\n-----\n\nVerifying the hostname:\n\nThis domain is registered by an organization going by the name of ‘Calvos S.L.’\n\n**_[You might also like: Everything You Need to Know About Brickerbot, Hajime, and IoT_**\n**_Botnets]_**\n\n## C2 Protocol\n\nUpon execution, the malware phones home to its hardcoded C2 server located by the\nhostname ‘skids.sancalvicie.com’ using a TCP session on port 127. The malware sends an\ninitial byte sequence “0x00 0x00 0x00 0x01 0x07” followed by the string that was passed as\na first argument to the command line to execute it. In the case of the Realtek exploit, this\nargument is ‘realtek’. After this initial sequence, the bot and the C2 server are passing back\nand forth packets with a payload of two null-bytes to keep the session alive.\n\n\n-----\n\nTCP\n\nsession between bot and C2 server – bot in red\nThe C2 server also seems to provide a command line interface, listening on the same port\n127. When the initial byte after session establishment is not 0x00, the server responds with a\nprompt for login:\n\n## Attribution\n\nThe reversed code has indicators of a Valve Source Engine Query attack payload, the same\n[attack vector what was included in the original Mirai code, which had its source published](https://github.com/jgamblin/Mirai-Source-Code)\nback in October 2016.\n\nInvestigating deeper into the domain ‘sancalvicie.com’ the answer to the potential Source\nEngine Query attack payload was pretty soon revealed as the website provides GTA San\nAndreas multiplayer servers and explicitly mentions its “Anti Query Flood” protection. As a\nside service, the site also provides DDoS services including the Valve Source Engine Query\nflood attack.\n\nThis brings us to believe that the botnet is being built by the San Calvicie hacker group and\nwill be served up through their Clearnet website. The San Calvicie hacker group has been\n[the talk of some threads in gamer forums in relation to DDoS attacks here and](https://gt-mp.net/forum/thread/3429-am-i-being-ddos-d/) [here.](https://forum.gtanet.work/index.php?threads/why-gta-network-accept-this.4092/)\n\n## Should you be concerned?\n\n\n-----\n\nUnless you frequently play GTA San Andreas, you will probably not be directly impacted. The\nbotnet is supposed to serve a specific purpose and be used to disrupt services from\ncompeting GTA SA multiplayer servers. I do not believe that this will be the botnet that will\ntake down the internet! But it does contain some interesting new evolutions and it adds to a\nlist of IoT botnets that is growing longer and faster every month! That said, there is nothing\nthat stops one from using the cheap $20 per target service to perform 290Gbps attacks on\nbusiness targets and even government related targets. I cannot believe the San Calvicie\ngroup would oppose to it.\n\n## Can we take JenX down?\n\nAs of this morning, we received positive replies on some of the abuse notifications that we\nfiled yesterday. Two European providers took down the exploit servers hosted in their\ndatacenters. I can confirm there are still active servers and the command and control server\nis still alive as I write this. Basically, the botnet is still operational and we only impacted its\ngrowth rate.\n\nAt the same time, by our actions, we sent the hackers the message that they should get\nbetter if they want to hide from us! We will not tolerate anyone starting to build their own\nweapons of massive destruction and be successful without investing skills and money. By\ntrying to enforce a higher threshold, I believe we can demotivate mister everybody to get into\nthe business of IoT botnets, and that is, agreed, a rather small, but a victory none the same.\n\nJenX, in particular, can be easily concealed and hardened against takedowns. As they opted\nfor a central scan and exploit paradigm, the hackers can easily move their exploit operations\nto bulletproof hosting providers who provide anonymous VPS and dedicated servers from\noffshore zones. These providers do not care about abuse. Some are even providing hosting\nservices from the Darknet. If the exploit servers would be move to the Darknet, it would make\nit much more difficult to track down the servers’ location and take them down. I witnessed at\nleast one IoT botnet using such techniques in the past year and it was BrickerBot.\n\n### Read “2017-2018 Global Application & Network Security Report” to learn more.\n\n[Download Now](https://www.radware.com/social/ert-report-2017/?utm_source=RadwareBlog&utm_campaign=FixedCTA&utm_term=7802)\n\n\n-----\n\n### LEAVE A REPLY\n\nPlease enter your comment!\n\nPlease enter your name here\n\nYou have entered an incorrect email address!\n\nPlease enter your email address here\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-02-01 - JenX – Los Calvos de San Calvicie.pdf"
    ],
    "report_names": [
        "2018-02-01 - JenX – Los Calvos de San Calvicie.pdf"
    ],
    "threat_actors": [
        {
            "id": "b960c826-adff-49e8-97aa-017ceab56776",
            "created_at": "2023-01-06T13:46:39.036244Z",
            "updated_at": "2025-03-27T02:00:02.982733Z",
            "deleted_at": null,
            "main_name": "ViceLeaker",
            "aliases": [],
            "source_name": "MISPGALAXY:ViceLeaker",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535832,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653701214,
    "ts_modification_date": 1653701214,
    "files": {
        "pdf": "https://archive.orkl.eu/dd6d6a3ae850e8648eeb5add2679ec501ec96651.pdf",
        "text": "https://archive.orkl.eu/dd6d6a3ae850e8648eeb5add2679ec501ec96651.txt",
        "img": "https://archive.orkl.eu/dd6d6a3ae850e8648eeb5add2679ec501ec96651.jpg"
    }
}