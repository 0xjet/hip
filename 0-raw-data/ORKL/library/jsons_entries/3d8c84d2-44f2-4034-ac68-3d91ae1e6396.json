{
    "id": "3d8c84d2-44f2-4034-ac68-3d91ae1e6396",
    "created_at": "2023-01-12T14:59:48.598949Z",
    "updated_at": "2025-03-27T02:13:34.355829Z",
    "deleted_at": null,
    "sha1_hash": "029064a314319a3a104e641bca4ecbda38699536",
    "title": "2021-11-08 - In-Depth Analysis of Ransom Note Files",
    "authors": "",
    "file_creation_date": "2021-11-08T20:39:36Z",
    "file_modification_date": "2021-11-08T13:44:42Z",
    "file_size": 524400,
    "plain_text": "# computers\n\n_Article_\n## In-Depth Analysis of Ransom Note Files\n\n**Yassine Lemmou** **[1,]*[,†]** **and Jean-Louis Lanet** **[2,†]** **and El Mamoun Souidi** **[1,†]**\n\n1 Faculty of Sciences, Mohammed V University in Rabat, LabMIASI, BP 1014 RP, Rabat 10000, Morocco;\nemsouidi@gmail.com\n2 INRIA, LHS-PEC, 35042 Rennes, France; jean.louis.lanet@free.fr\n***** Correspondence: yassine.lemmou@gmail.com\n† These authors contributed equally to this work.\n\n**Abstract: During recent years, many papers have been published on ransomware, but to the best**\nof our knowledge, no previous academic studies have been conducted on ransom note files. In\nthis paper, we present the results of a depth study on filenames and the content of ransom files.\nWe propose a prototype to identify the ransom files. Then we explore how the filenames and the\ncontent of these files can minimize the risk of ransomware encryption of some specified ransomware\nor increase the effectiveness of some ransomware detection tools. To achieve these objectives, two\napproaches are discussed in this paper. The first uses Latent Semantic Analysis (LSA) to check\nsimilarities between the contents of files. The second uses some Machine Learning models to classify\nthe filenames into two classes—ransom filenames and benign filenames.\n\n**Keywords: ransomware; ransom note file; detection; identification; Latent Semantic Analysis;**\nMachine Learning\n\n\n**Citation: Lemmou, Y.; Lanet, J.-L.;**\n\nSouidi, E.M. In-Depth Analysis of\n\nRansom Note Files. Computers 2021,\n\n_[10, 145. https://doi.org/10.3390/](https://doi.org/10.3390/computers10110145)_\n\n[computers10110145](https://doi.org/10.3390/computers10110145)\n\nAcademic Editor: Paolo Bellavista\n\nReceived: 22 September 2021\n\nAccepted: 29 October 2021\n\nPublished: 8 November 2021\n\n**Publisher’s Note: MDPI stays neutral**\n\nwith regard to jurisdictional claims in\n\npublished maps and institutional affil\niations.\n\n**Copyright: © 2021 by the authors.**\n\nLicensee MDPI, Basel, Switzerland.\n\nThis article is an open access article\n\ndistributed under the terms and\n\nconditions of the Creative Commons\n\n[Attribution (CC BY) license (https://](https://creativecommons.org/licenses/by/4.0/)\n\n[creativecommons.org/licenses/by/](https://creativecommons.org/licenses/by/4.0/)\n\n4.0/).\n\n\n**1. Introduction**\n\nRansomware has spread rapidly over the last five years causing significant damage,\nespecially in Windows environments. This category of malware covers two classes—Locker\nransomware and Crypto ransomware. The first denies or blocks access to files. The second\nencrypts important data on a target machine, including files and backups. Generally, in\nboth classes, a ransom to pay is demanded. This paper examines only the second class\nbecause it is more spread than the first class and the ransom files are more related to\nCrypto-ransomware than to Locker-ransomware.\nRansom note files are created by ransomware, then added in several directories\non the target machine to notify the victims that their files are encrypted. They provide\npayment information, show how to send payment, the amount requested, and what are the\nconsequences if if you do not pay. These files are the single links between the ransomware\ndevelopers and their victims. The behavior of adding the same ransom files in directories is\nrepeated recursively in each target directory. Only a few papers like [1–3] have mentioned\nthe use of the ransom files to detect or identify ransomware. For example, Endgame\nteam [1] developed a classifier based on the Naïve Bayes model to classify the ransom\nfiles. The whitepaper of MWR labs [2] presented some behaviors to detect ransomware.\nAmong the proposed behaviors in this whitepaper is the use of a bag of most used terms\nin the ransom files. While this idea of monitoring the added ransom files can be effective,\nit can take time if it is based only on reading the whole content of any created file on the\nmachine, searching for ransom content, then deciding if this file is truly a ransom file or\nnot. Therefore, we found that monitoring the filenames of the created files, searching for\nransom filenames, then checking the content of any file named like a ransom filename\ncan help to spot ransomware or minimize its damage. Indeed, as shown in the following\nsections, the used terms in the filenames or the content of the ransom files are limited to a\nfew terms.\n\n\n-----\n\n_Computers 2021, 10, 145_ 2 of 25\n\nThe likelihood of spotting a benign file named like the filename of a ransom file is\nsmall in a computer. Furthermore, the false positive files described in Section 4.2 (the\n```\n             readme or help files) are not created recursively in each directory compared to the ransom\n\n```\nfiles which in several cases are recursively duplicated. Finally, any solution to detect\nransomware must contain several indicators based on different ransomware behaviors. In\nother words, this proposition cannot detect all ransomware and cannot be used alone in a\nransomware detector. Indeed, many ransomware families do not add the ransom files in\nevery target directory, some families encode the content of their ransom files and others\nadd only one ransom file at the end of their infection (e.g., Spora ransomware [4]). For\nthese reasons, we suggest that using the ransom files must be monitored with a corpus of\nransomware behaviors. In summary, this paper presents the following contributions:\n\n           - We make the first and probably unique available collection of ransom files. This\ncollection contains more than 170 ransom files of 62 different ransomware families.\n[This collection is shared in GitHub (https://github.com/lemmou/RansomNoteFiles,](https://github.com/lemmou/RansomNoteFiles)\naccessed on 15 September 2021) for evaluation and study by the research community.\nIt can also be used in the area of criminology and profiling ransomware developers.\nThese ransom files were collected manually from different sources:\n\n**–** [From Malware Traffic Analysis Project (https://www.malware-traffic-analysis.](https://www.malware-traffic-analysis.net/)\n[net/, accessed on 15 September 2021);](https://www.malware-traffic-analysis.net/)\n**–** [From Hybrid-Analysis, looking for the ransom note filenames (https://hybrid-](https://hybrid-analysis.com/)\n[analysis.com/, accessed on 15 September 2021);](https://hybrid-analysis.com/)\n**–** By running some ransomware samples in our virtual machines;\n**–** [From The Week in Ransomware of BleepingComputer (https://www.bleeping](https://www.bleepingcomputer.com/)\n[computer.com/, accessed on 15 September 2021);](https://www.bleepingcomputer.com/)\n**–** [From the Pastebins of the owner of ID-Ransomware project (https://pastebin.](https://pastebin.com/u/Demonslay335)\n[com/u/Demonslay335, accessed on 15 September 2021).](https://pastebin.com/u/Demonslay335)\n\n           - We present a depth analysis of the ransom files including some statistics based on\ntheir filenames and contents;\n\n           - We propose a prototype to identify the ransomware family associated with a given\nransom file;\n\n           - We apply an approach to classify the ransom files and benign files and another\napproach to check their similarities using some models of Machine Learning and\nLatent Semantic Analysis (LSA);\n\n           - The results of the previous items allow us to propose a new approach to detecting\nransomware using the filenames and the content of the ransom files. This approach\ncan be used with other behaviors to make a ransomware detector or added to the\ncurrently available solutions of ransomware detection, identification or prevention.\nMoreover, several ransomware families can be detected or identified using only this\napproach before their damage. In particular, the ones that add their ransom files\nbefore encryption;\n\n           - We compare the effectiveness of our approach on some ransomware detection tools at\nthe end of this paper.\n\nTable A1 in Appendix A (All theses families are crypto ransomware despite the Locker\ntag in the names of some ransomware) shows the used ransom files in this paper. This\npaper is structured as follows: ransom files description and related works are presented\nin Section 2. Section 3 describes how the ransom files can be identified and the proposed\nprototype to identify these files. The results of our study on the filenames of the ransom\nfiles are outlined in Section 4. The same study of Section 4 is applied to the content of the\nransom files in Section 5. Finally, the conclusion is drawn in Section 6.\n\n**2. Ransom Note Files and Related Works**\n\nThe ransom files are a unique way for the victims to take the first steps to restore their\nencrypted files. The ransom notes provide information to the victims such as the payment\n\n\n-----\n\n_Computers 2021, 10, 145_ 3 of 25\n\ninformation, fee, deadline, free files decryption, and various instructions to pay the ransom,\nthen recover the encrypted files. The collected dataset of the ransom files includes the\nransom notes of different known families like Locky, Cerber, and TeslaCrypt. Table A1 in\nthe Appendix A shows the collected ransom files. The graph in Figure 1 shows the number\nof families for each extension of the ransom files. The most used extension is txt followed\nby htm and html (htm(l)). More than 30 families use txt or htm(l) files as a ransom note.\nOther ransomware like Blind, Mr.Dec and NemucodAES ransomware use hta files. Matrix\nransomware family is the single family in our collection that uses rtf files. Generally, few\nransomwares, such as Qinynore and Cypher, choose rtf files for their ransom files.\n\n**Figure 1. Number of Ransomware Families for Each Extension.**\n\nRansomware families change the extensions and filenames of their ransom files between the versions. Other families add their names, the extension of encrypted files or\nthe victim identity (ID) to the filenames. In another way, some ransomware families like\n```\n             Dharma, Jaff or HC7 keep the same filename and extension of their ransom files in all their\n\n```\nversions. Generally, the extensions of the ransom notes are limited to few extensions. Moreover, despite the changes in the filenames between the versions of the same ransomware,\nwe prove in Section 4.1 that the used terms in the filenames are also limited to few terms.\n```\n               WannaCry is a well-known ransomware that spread in May 2017 by exploiting a vul\n```\nnerability in the SMB protocol. It infected more than 200,000 machines in the world [5].\nThis Crypto worm copies the content of the file r.wnry into a file named @Please_Read_\n```\n             Me@.txt before encrypting the files. Lemmou et al. [6] found that three files (txt, html\n\n```\nand url) with the same filename !_HOW_TO_RESTORE_[extension] were replicated by\n```\n             PrincessLocker ransomware in target directories before encryption. Moreover, by ex\n```\nploring some recent ransomware, we found that many ransomware families like JSWORM,\n```\n             ChaCha, StopDjvu, LockerGoga and GlobImposter add their ransom files before encryp\n```\ntion. Some versions of TeslaCrypt, CryptoLocker, and Cerber add their ransom files in\neach target directory after encrypting only the content of this directory. The filenames of all\nthese ransom notes can be easily identified. For example, JSWORM-DECRYPT.hta of JSWORM\nransomware, README_LOCKED.txt of LockerGoga or DECRYPT-FILES.html of ChaCha ransomware. For these reasons, using the ransom files to detect the ransomware can:\n\n           - Minimize the ransomware damage to few encrypted files if the ransomware encrypts\nthe files of a target directory then puts the ransom files in this directory;\n\n           - Detect the ransomware without encrypting any file if the ransomware creates its\nransom files before encryption.\n\nOver recent years, the frequency of ransomware activities and the number of new\nransomware families have grown since 2015. Simultaneously, many ransomware analysis,\n\n\n-----\n\n_Computers 2021, 10, 145_ 4 of 25\n\ndetection, and prevention approaches have been published to detect ransomware. The\nfirst ransomware analysis was published by Gazet in 2010 [7]. He presented a comparative\nanalysis of four ransomware families. More similar analyses have been published during\nthe last four years. For example, the works of D. Caivano et al. [8] on the common\nransomware characteristics of 76 samples and the works of Lemmou et al. [9] that extracted\nthe ransomware behaviors of more than 20 ransomware families. In addition, in their paper\nthey discussed some behaviors that were automatically searched by analyzing more than\n200 different ransomware collected during 2019.\nOn ransomware detection, different approaches have been proposed. For example,\nmonitoring abnormal file system activities to detect ransomware was proposed by Kharraz et al. [10] in 2015. Their work was the first attempt to detect the ransomware and their\nanalysis of several ransomware families allowed them one year later to propose a monitoring tool called UNVEIL which detects Crypto-ransomware. ShieldFS [11] is a ransomware\ndetection tool based on the difference between file system I/O requests of ransomware\nand benign software. DaD [12] is a tool to detect ransomware based on monitoring file\nsystem activities of all userland threads. CryptoDrop [3] another ransomware detection\ntool, which alerts the user during suspicious activities using a set of ransomware behaviors.\nUntil now, UNVEIL and ShieldFS were not released for download, but CryptoDrop and DaD\nwere available for download until 2019.\nOther approaches have been proposed to detect ransomware such as using decoy\nfiles or monitoring the API crypto. The first approach is based on monitoring some files\nnamed decoys in some directories. Any write access to these files alerts the monitoring\ntool. This approach was described by Jeonghwan et al. [13] and it has been used by\nseveral detection tools like Antiransom V3, Padvish and Cybereason RansomFree. Lemmou et al. [9] discussed how ensuring maximum efficiency of using decoy files to detect\nransomware. Generally, using decoy files to detect ransomware is an interesting idea, but it\nmust be used with other monitored ransomware behaviors. On monitoring the API Crypto,\nPalisse et al. [14] introduced two countermeasures to decrypt files based on the interception\nof the API Crypto calls and weak ransomware operations. In the same way, Eugene et al.\nproposed PayBreak [15] a tool that hooks the encryption functions of standard libraries\nand securely stores encryption keys in a key vault for a future decryption of the encrypted\nfiles by ransomware.\nTraditional ransomware detection techniques are included in the current malware\ndetection and are primarily based on signatures that malware developers can easily evade.\nMachine Learning models have good capabilities to detect ransomware. Bello et al. [16]\npresented a comprehensive survey on the detection of ransomware attacks using Machine\nLearning algorithms. Their study analyzed literature from different perspectives focusing\non Machine Learning algorithms to detect ransomware. An example to detect ransomware\nusing Machine Learning was proposed by Poudyal et al. [17]. They designed a ransomware\ndetection prototype named AIRaD for AI-based Ransomware Detection. Their tool is\nbased on a deep inspection approach for multi-level profiling of crypto ransomware,\nwhich captures the distinct features at Dynamic Link Library, function calls, and assembly\nlevels. PEDA [18] is a pre-encryption detection algorithm for detecting crypto-ransomware\nproposed by Kok et al. PEDA uses two levels of detection. The first is a signature based\ndetection to detect known ransomware. The second is a Machine learning model based\non the API calls to detect known and unknown ransomware. DNAact-Ran [19] is another\nransomware detection solution using Machine Learning. DNAact-Ran uses Digital DNA\nsequencing design constraints and k-mer frequency vector. This solution was evaluated\non 582 ransomware and 942 benign applications and it showed its effectiveness to detect\nransomware compared with other methods. Ketzaki et al. [20] proposed a detection\nprocedure based on neural network methodologies to detect ransomware. The used\nfeatures by the neural network model are extracted from monitoring in real-time the CPU,\nthe memory, the disk space, the rate of reads and writes, the number of changed, created\nand deleted files.\n\n\n-----\n\n_Computers 2021, 10, 145_ 5 of 25\n\nThe current paper offers a complementary to these works. For example, Scaif et al. [3]\nuse three primary and two secondary indicators to detect the ransomware in their tool\n```\n             CryptoDrop. Monitoring the ransom files can be added as a secondary indicator among the\n\n```\nother indicators to reach the threshold score of detection in CryptoDrop. Some ransomware\nadd their ransom files during exploring directories before encryption. However, our idea\nto detect the ransomware using the ransom files can also be combined with monitoring the\nper-thread file system traversal suggested in [21]. Within Machine Learning, the ransom\nfiles can be used as a monitored feature in [20] like rate of reads/writes and the number of\nchanged, created and deleted files. Related to monitoring the API Crypto or decoy files, a\ncreated ransom file by a specified process can confirm that this process is a ransomware if\nalso uses the API Crypto. The same is true if this process accesses to a decoy file.\n\n**3. Identification of Ransom Note Files**\n\nIn this section, we present the extracted markers that can be used to identify the\nransom files and associate them with their related ransomware.\n\n_3.1. Addresses_\n\nRansomware developers share their addresses (URL, Bitcoin, Email or others) to\nreceive the ransom. The most used addresses are the URL and the email addresses. In\nour collection of ransom files, we identified four categories of addresses: Email addresses,\nBitmessage addresses, Web payment addresses and Bitcoin addresses.\n\n3.1.1. Email Addresses\n\nSeveral ransomware families notify their victims to use the cited email addresses in\nthe ransom files to receive more instructions about the decryption of the files. Generally,\nthe ransomware developers do not use a single address for all their ransomware versions.\nThe email address can be used to identify the current or the previous versions of the\nransomware family and cannot generally identify or predict the next versions of the same\nfamily. The collected dataset of ransom files, contains 43 ransomware families that used\nthe email addresses. Table 1 shows the used addresses by some families. Dharma family\nused 14 email addresses for 10 versions and these email addresses were the single way to\ncommunicate with the developers of Dharma.\n\n**Table 1. Email Addresses used by some Ransomware Families.**\n\n**Family** **Version** **Email Address**\n```\n                                       argusdecrypt@cock.li\n\n```\n**Argus**                ```\n                                      argusdecrypt@mailfence.com\n\n```\nAleta `chines34@protonmail.ch`\n**BTCWare** Gryphon `oceannew_vb@protonmail.com`\nPayday `checkzip@india.com`\n\n\n**Dharma**\n\n\nabido `abibo@protonmail.com`\narrow `jamie_white25@aol.com, dot_faldo@aol.com`\nBip `emailpeekabooo@qq.com, peekabooo@qq.com`\nbkp `bkp@cock.li`\nbrrr `paydecryption@qq.com`\ncmb `paymentbtc@firemail.cc`\nmanpecman `manpecamet1974@aol.com, raxisubsro1977@aol.com`\nmonro `icrypt@cock.li`\nskynet `skynet45@cock.li, skynet45@tutanota.com`\nstopencrypt `stopencrypt@qq.com`\n\n\nSome ransomware, such as Triplem and Argus ransomware, added their names to\nthe email addresses, which can allow us to associate the ransom file with its ransomware.\n\n\n-----\n\n_Computers 2021, 10, 145_ 6 of 25\n\nTherefore, any ransom file identifier must search the ransomware names in the email\naddress to identify the ransom note file.\n\n3.1.2. Bitcoin Addresses\n\nThe second method to identify the ransom files is using Bitcoin addresses. Cryp```\n             toLocker was the first ransomware that asked for payment using Bitcoin (Emerging Technol\n```\n[ogy: True scale of Bitcoin ransomware extortion revealed, https://www.technologyreview.](https://www.technologyreview.com/s/610803/true-scale-of-bitcoin-ransomware-extortion-revealed/)\n[com/s/610803/true-scale-of-bitcoin-ransomware-extortion-revealed/, accessed on 15](https://www.technologyreview.com/s/610803/true-scale-of-bitcoin-ransomware-extortion-revealed/)\nSeptember 2021). Before CryptoLocker, the earlier ransomware used other payment\nmethods like pre-paid money vouchers, premium SMS, GoldMoney or buying from a site.\nThe ransomware developers add their Bitcoin addresses in the ransom files to receive\nthe Bitcoin payments from the victims. This address is a base58 encoded identifier of 26 to\n35 alphanumeric characters starting with 1 or 3 [22]. Our dataset contains ransomware that\nuses the Bitcoin addresses to receive the payment. For example, BadBlock, TripleM used\ntwo different Bitcoin addresses in two versions and Cerber the same Bitcoin address five\nversions. Generally, the Bitcoin address is used in many versions of the same ransomware.\nTable 2 shows the Bitcoin addresses of some ransomware families.\n\n**Table 2. Bitcoin Addresses of some Ransomware Families.**\n\n**Family** **Bitmessage Address**\n\n**BadBlock** `19zvmsm7qsqgfxcckxbjstdvdbt99zuwbp`\n**Comonransomware** `35m1zjhtati4iduufzena75ibyjoq9ibgf`\n**Cryptolocker** `1LfX1pFa2uSH6HDfH47zRDZgre4Ms7uZTk`\n**Diamond** `1L6PpSehR8V7YsZTc3L3F5RwbWoNma1nno`\n\n3.1.3. Bitmessage Address\n\nAnother method used by ransomware developers to communicate with their victims is\n```\n             Bitmessage (Bitmessage:A PeertoPeer Message Authentication and Delivery System, https:\n\n```\n[//bitmessage.org/bitmessage.pdf, accessed on 15 September 2021). It is a peer-to-peer](https://bitmessage.org/bitmessage.pdf)\nand decentralized communication protocol used by users to communicate anonymously\nwith other users. This method is used only by few ransomware. This address of 32 to\n34 characters is a Base58 encoded public key hash that starts with the term BM-. Scarab\nransomware family is one of the seven families in our dataset that used this method to\ncommunicate with the victims. It used the same address in the version seen in November\n2017 and the version seen in October 2018. Table 3 shows three families of the seven\nfamilies that used the Bitmessage addresses in their ransom files.\n\n**Table 3. Bitmessage Addresses Used by Three Ransomware Families.**\n\n**Family** **Version** **Bitmessage Address**\n\n**Amnesia**                - `BM-NBdUQmYVn43e3nK4amuoeaSm4ZStr8oZ`\n**CryptoBit**                  - `BM-NAxZ29ouecw2Y7ibaXKus1vxDRDfheW6`\n**Crypton**                 - `BM-2cwzhonfbjq3x8puliwsykhc6dedq54zq1`\n\n3.1.4. Web Payment Address\n\nOther ransomware creates an onion web page to give the victims more instructions\nto recover the encrypted files. The onion address is mentioned in the ransom file with\nother instructions about how to access the onion page. Using the most used terms in the\nweb payment addresses like onion, torstorm, tor2web, onion2web, top and others,\nwe extracted at least one onion address correctly from all the 28 ransomware families that\nadded an onion address in their ransom files. Each extracted address identified correctly\nthe ransomware family associated with the ransom file. Generally, the ransomware does\nnot keep the same onion address during all their versions. Therefore, the extracted onion\nURLs can be used only to identify the ransom files that are currently or were previously\n\n\n-----\n\n_Computers 2021, 10, 145_ 7 of 25\n\nsaved by the ransom note identifier. However, in some cases, they can be used to identify\nthe ransom files of the next versions. Table 4 shows some ransomware families that used\nthe same onion address in several versions.\nRansomware Tracker is an online service that tracks the IP addresses, domain names,\nand URLs including C&C servers, botnet and payment sites that are linked to a specified ransomware. We used the Python API of Ransomware Tracker available in GitHub (PaulWeb[Sec: Python API for Ransomware Tracker. https://github.com/PaulSec/ransomware-](https://github.com/PaulSec/ransomware-tracker)\n[tracker, accessed on 15 September 2021) to track the extracted URLs from the collected](https://github.com/PaulSec/ransomware-tracker)\nransom files. We were able to track only the used URLs in the ransom files of two versions\nof Locky ransomware (Odin and Zepto). The ransom note identifier can use this service\nto identify the extracted and unidentified URLs from the ransom files, then track these\naddresses to associate them with a specified ransomware.\n\n**Table 4. Onion Addresses of some Ransomware Families.**\n\n**Family** **Versions** **Onion address**\n\n2017-01-05, 2017-01-26 `p27dokhpz2n7nvgr.onion`\n**Cerber**\n2017-03-15, 2017-05-12\n\n**CryptoWall** 2016-01-17, 2016-02-05 `3wzn5p2yiumh7akj.onion`\n\nv1 and v2 `gdcbghvjyqy7jclk.onion.top`\n**GandCrab**\nv5.0.1, v5.0.2, v5.0.3, v5.0.4 `gandcrabmfe6mnef.onion`\n\n_3.2. Keyword_\n\nSome ransomware families add their names and some specified keywords like the\nextension of the encrypted files in the content of their ransom files. Any ransom note file\nidentifier must search for ransomware names and other specified keywords in the content\nof these files. The names of the ransomware can be obfuscated in the content of the ransom\nfiles. For example, some versions of Cerber seen in May 2017 used the word Cer&#98;er\ninstead of Cerber in their hta ransom files. The same ransomware used the term crbr in\nthe hta and the txt ransom files of its version seen in August 2017. In another way, some\nransomware like CryptoShield ransomware add the name of other ransomware in the\ncontent. For these reasons:\n\n           - The identifier must be aware of the encoded ransomware names. We suggest storing\nthe previously encoded names by the ransomware in the ransom note identifier\ndatabase;\n\n           - Take the most cited ransomware names in the ransom file or the first cited name in the\ncase of equality between many cited ransomware names in the content;\n\n           - The identifier can search for the used extensions of the encrypted files in the content. Indeed, some ransomware adds these extensions to the content of their ransom\nfiles. For example, Blind ransomware added the extension NAPOLEON and BTCWare\nransomware added the extension Gryphon.\n\nUsing the previous items, we tried to identify some ransom files using only the cited\nransomware names in the content. We were able to identify correctly 29 families from\n31 families that added their names in their ransom files with two false predictions:\n\n           - The version of TeslaCrypt that was seen in July 2015. Our script identified this version\nas a ransom file of CryptoWall ransomware. The reason for this false prediction is\nthat the ransom file of this version is an exact copy of the ransom file of CryptoWall\n```\n               3.0 ransomware;\n\n```\n           - An unknown version of CrypMic. Our script identified this version as a ransom file of\n```\n               Alpha ransomware. This is due to the injected terms alpha in the content.\n\n```\nID-Ransomware does not identify the ransom file of TeslaCrypt. It also cannot\nidentify the ransom file of CrypMic correctly. Moreover, ID-Ransomware fails to identify\ncorrectly the ransom files of 29 families that add the name of the ransomware in the content.\n\n\n-----\n\n_Computers 2021, 10, 145_ 8 of 25\n\nFor these reasons, we suggest that the ID-Ransomware service adapts its process to identify\nthe ransom files by searching for the ransomware names in the content to improve its\nefficiency in identifying the ransom files.\n\n_3.3. Names and Content of the Ransom Note Files_\n\nSeveral ransomwares name their ransom files with some specified names or a specified\ncombination of terms that make the identification of the ransom files possible using the\nfilenames. For example, Argus, Chip and GandCrab ransomware added their names in the\nfilenames of their ransom files. The ransom note identifier can search for the names of the\nknown ransomware in the filenames of a given ransom file to identify it. The filenames of\nthe ransom files of some ransomware contain the added extension to the encrypted files. For\nexample, the hta ransom file of the payday version of BTCWare ransomware is Payday.hta\nand the htm ransom file of the asasin version of Locky ransomware is asasin.htm. For this\nreason, we suggest that the ransom note identifier searches for some used extensions by\nthe ransomware in the filenames. As described in Section 4.2, the filenames of the ransom\nfiles cannot classify the ransomware effectively into families because multiple ransomware\nfamilies change the filenames of their ransom notes in each version. Despite this weakness,\nwe think that the ransom note identifier can check the similarity of a given ransom note\nfilename and the other ransom filenames in its database as a secondary indicator to identify\nthe ransom files.\nMoreover, another method to identify the ransom files is using their content. Indeed,\nmany ransomwares keep all or the same parts of the content of their ransom files for several\nversions.\n\n_3.4. Ransom Note Files Identifier_\n\n[To the best of our knowledge, ID-Ransomware (https://id-ransomware.malware](https://id-ransomware.malwarehunterteam.com/)\n[hunterteam.com/, accessed on 15 September 2021) is the unique service for the victims and](https://id-ransomware.malwarehunterteam.com/)\nresearchers to identify the ransom files. It is a free service to identify which ransomware\nencrypted a submitted file to the service or the ransomware associated with a given\nransom file. The service is able to identify many known ransomware families like Cerber,\n```\n             TeslaCrypt and the recent families like StopDjvu or REvil. ID-Ransomware identifies the\n\n```\nransomware families using extensions, patterns, filenames, email, Bitcoin addresses and\nothers.\nThe contributions of this paper include some suggestions to make a ransomware\nidentifier or to improve the effectiveness of ID-Ransomware. In some cases, this service fails\nto identify the associated ransomware with a given ransom file. Until now, ID-Ransomware\ndoes not use the content of the ransom file to identify the ransom files. The responsible of\nthis service mentioned in a private conversation with us that using the content to identify\nthe ransom files is a future work for the owners of this service. Thus, we suggest using\nLatent Semantic Analysis (LSA) as a solution to check similarities between the content\nof the ransom files and the mentioned markers above to increase the effectiveness of this\nservice.\nWe developed some Python scripts to evaluate our ideas to identify the ransom files\nin our dataset of 71 ransomware families. We get the following results:\n\n           - Using only the email addresses: 65 ransom files were correctly identified. ID-Ransomware\nfailed to identify seven ransom files;\n\n           - Using only the Bitmessage addresses: eight ransom files were correctly identified. IDRansomware identified correctly only five ransom files and the others were identified\nusing the email addresses embedded in the content;\n\n           - Using only the URL addresses: 102 ransom files were correctly identified. IDRansomware failed to identify 18 ransom files and 33 ransom files were identified\nusing other markers like the Bitcoin addresses and some custom rules;\n\n\n-----\n\n_Computers 2021, 10, 145_ 9 of 25\n\n           - Using only the Bitcoin addresses: 25 ransom files were correctly identified. IDRansomware identified 14 ransom files, it failed to identify three ransom files and\neight ransom files were identified using other markers;\n\n           - Using only the ransomware tracker: two ransom files of one family were identified.\nID-Ransomware was able to identify more ransom files using the ransomware tracker.\nWe think that our script to identify the ransom files using the ransomware tracker\nmust be improved to identify the ransom files;\n\n           - Using only LSA on the content of the ransom files (with 0.99995 as a threshold of\nsimilarity between the ransom files), only 13 ransom files (7% of 182 ransom files)\nwere not correctly identified. Table 5 shows these false positives. LSA matched the\nransom files of different versions of the same ransomware family. For example, the\n```\n               txt ransom file of the version seen during May 2016 of Cerber has high similarity\n\n```\nwith the ransom file of the version seen during August 2016. The hta ransom file of\nthe abido version of Dharma has high similarity with all the hta ransom files of the\nother versions. Moreover, we tested LSA on the content of the ransom files of some\nnew versions have been seen during 2021 of Dharma and GlobImposter. We found\nhigh similarity between the content of these ransom files and the content of their old\nransom files.\n\n**Table 5. False Positives Labels Using LSA on the Content.**\n\n**Family** **Version** **Ransom Note** **Result by LSA (Label)**\n\nTeslaCrypt (2 false\n**Cryptowall** 3.0 `HELP_DECRYPT.txt`\nransom notes)\n\nTeslaCrypt & Alpha\n**CryptoLocker**                - `HELP_RESTORE_FILES.txt`\nCrypt\n\nCryptoLocker &\n**Alpha Crypt** 2015-04-30 `HELP_TO_SAVE_FILES.txt`\nTeslaCrypt\n\nAlpha Crypt &\n2015-04-03 `HELP_RESTORE_FILES.txt`\nCryptoLocker\n**TeslaCrypt**\n2015-10-23 `howto_recover_file_[].txt` CryptoWall\nV2.1 `HOWTO_RESTORE_FILES.txt` CryptoWall\n\n**CryptoMix** 2016-11-28                - Cryptfile2\n\n**Cryptfile2**                   -                   - CryptoMix\n\nCryptxxx (2 false\n**CrypMIC**              - `README.txt`\nransom notes)\n\n**Rapid**                 - `_READ_ME_FOR_DECRYPT.txt` StorageCrypt\n\n`de_crypt_readme.html` CrypMic\n**Cryptxxx** 2016-05-05\n`de_crypt_readme.txt` CrypMic\n\n**StorageCrypt**                 -                 - Rapid\n\n**13 ransom notes files** **18 FP labels**\n\nID-Ransomware searches for many markers to identify the ransom files without\nsearching for correlations between the used phrases in the content or analyzing the content\nentirely. We tested the 182 ransom files in ID-Ransomware. It failed to identify or correctly\nidentify 24 ransom files. The combination of our scripts (without checking the filenames of\nthe ransom files) was able to identify 181 ransom files, including the unidentified ransom\nfiles by ID-Ransomware. Only one ransom file could not be identified using our scripts.\nIt is the txt ransom file of Kee ransomware. This ransom file does not have high LSA\nsimilarity on the content (similarity ≥ 0.99995) with the other ransom files. Related to these\nresults, we suggest that the ransom files identifier must combine and check all the discussed\nmarkers in this section to identify the ransom files, including the content and filenames of\nthe ransom files. Indeed, the Kee ransomware can be identified by checking the filename\n\n\n-----\n\n_Computers 2021, 10, 145_ 10 of 25\n\nof its ransom file (Hello There! `Fellow @kee use!.txt) that contains its name. For`\nthese reasons, we propose that ID-Ransomware or any new ransom note identifier service\nanalyses also the filenames and the content of the ransom files using for example LSA and\nfollowing this scenario:\n\n1. The ransom note file identifier starts searching, then checking the Bitcoin addresses in\nthe content to associate them with the ransomware that used these addresses using\nthe saved Bitcoin addresses in its database or using any external service. We choose\nthat the ransom note identifier starts searching for Bitcoin addresses in the content\nbecause several ransomware families are known by their Bitcoin addresses and they\nkeep them in several versions;\n2. The identifier checks the Bitmessage addresses if it is not able to associate the Bitcoin\naddress with any known ransomware or the ransom file does not contain Bitcoin\naddresses. Generally, the ransomware keeps the Bitmessage addresses for a long\nperiod of time like the Bitcoin addresses despite that only few ransomware use them;\n3. The identifier searches for any email address in the content. Moreover, the ransomware\nidentifier can search for any known ransomware name in the extracted email addresses\nto identify the ransom file;\n4. In the fourth step, the identifier searches for the URL addresses in the content. If it fails\nto identify the ransom note from the extracted URLs, it submits them to a ransomware\ntracker service;\n5. If the identifier fails to identify the ransom file using the previous items, it can search\nfor the known ransomware names or any known keyword (extensions, patterns, . . .)\nin the content. It can use the filename of the ransom file as a secondary indicator to\nprove its choice between many suggestions;\n6. If the identifier fails to identify the ransom file, it uses LSA (or other methods) on the\ncontent to search any high similarity with the content of any known ransom file.\n\nAs we have shown in this section, the ransom note files can be associated with\ntheir ransomware using the shared addresses by the ransomware developers to their\nvictims. The Bitcoin/Bitmessage/Email/URL addresses, the ransomware tracker service,\nthe filenames and contents must be combined correctly to make an efficient ransom file\nidentifier. Generally, the identifier can add other methods, patterns or custom rules to\nincrease its effectiveness.\n\n**4. Filenames of the Ransom Files**\n\nThe filenames of the ransom files of many ransomwares are in uppercase, including\nsome symbols like #, !, @ or =. Some ransomware like Cryptowall, CryptXXX include the\nvictim ID. Others add to the filenames the used extension for the encrypted files. During\nour research, we found that Scarab ransomware has the long ransom note filename: IF\n```\n             YOU WANT TO GET ALL YOUR FILES BACK, PLEASE READ THIS.\n\n```\n_4.1. Ransom Names Pre-analysis_\n\nThe focus of this part is to create some statistics on the used terms in the filenames\nbefore the semantic analysis in the following parts of this section. The filenames of the\nransom notes in our dataset were tokenized to involve the unit of a filename to analyze.\nEach unit of the filename (named word or term) was standardized, cleaned, removed stop\nwords from the units, then stemmed or lemmatized. These steps are often used in text\npreparing and pre-processing that precede text analysis of a documents corpus:\n\n1. Tokenization: extension, ransomware name, victim ID, unknown or random characters\nused in the filenames were changed to [ext], [ransomwarename], [id], [unknown] or\n```\n               [random]. Some filenames such as _R_E_A_D___T_H_I_S__[random] of Cerber were\n\n```\nchanged to _READ___THIS__[random]. After these modifications, we used each word\nin the filename as a unit in our analysis;\n2. Standardization and Cleaning: the words were converted to lowercase. We do not\nwant Read me, READ ME, and READ Me to be considered as separate terms. The non\n\n-----\n\n_Computers 2021, 10, 145_ 11 of 25\n\nalphanumeric characters were stripped, concatenated terms in the filenames were\nsplit (readme to read me). Some filenames were corrected, for example Thi$ to This\nor bl0cked to blocked;\n3. Stop word removal: this step is used to drop frequently used words that did not add\nvalue to our test. Firstly, we used a predefined stop words list from the Python library\n```\n               Nltk, but it removed some interesting words like the interrogative pronouns. For\n\n```\nthis reason, we made a list containing the words to avoid: to, me, your, this, if,\n```\n               you, all, my, it, for and with;\n\n```\n4. Stemming or lemmatization: this step tries to transform the evaluated words to their\nroot form [23]. Table 6 displays an example of stemming using PorterStemmer and\nlemmatization using WordNetLemmatizer. We applied PorterStemmer, WordNetLe```\n               mmatizer, LancasterStemmer and SnowballStemmer from Nltk on the words. The\n\n```\nlatter gave us the desired results.\n\n**Table 6. Example Using PorterStemmer and WordNetLemmatizer.**\n\n**Before** **After**\n\n**Stemming** `restoring files` `restor file`\n**Lemmatization** `restoring files` `restoring file`\n\nFigure 2 presents the most used terms in the filenames of the ransom notes. The\nword file is the most used word, followed by the word decrypt. In some filenames, the\nransomware developers ask a theoretical question which consists in asking a question\nthat does not wait for an answer from the victims like how return/restore/back... `my`\n```\n             files. The answer is known by the developers and mentioned in the content of the\n\n```\nransom files. Almost 20 samples of 13 families used this question in the filenames. Around\n45 ransomwares mentioned the extension of the encrypted files or the ID victim in the\nfilenames. Generally, the number of ransomware that adds the extension to the filenames\nis greater than the number of ransomware that adds the ID victim. Other ransomware\ninclude the term please in the filenames. Including this term in the filenames is only a\nsocial norm from the ransomware developers to establish a relationship with the victim\nto pay the ransom. In summary, the used words in the filenames of the ransom notes are\nlimited to only a few words. These words are not often used by the users in the filenames\nof their files. For these reasons, we think that the ransom files can be detected during\ntheir creations using their filenames. The following part presents some tests to prove the\ndiscrimination between the filenames of the ransom files and benign files.\n\n**Figure 2. Term Frequency of the Most Used Terms in the Filenames.**\n\n\n-----\n\n_Computers 2021, 10, 145_ 12 of 25\n\n_4.2. Unsupervised and Classification Analysis on the Ransom Filenames_\n\nUnsupervised analysis, such as Latent Semantic Analysis LSA, is different from the\nclassification analysis. The latter is a type of supervised learning model used to automatically classify data (sentences, malware, documents, reviews...) and build predictive models\nwhen the true classification of data is known. In contrast, no prior knowledge on the real\ncategories is used in the unsupervised analysis methods. In this section, we recall the\nLatent Semantic Analysis (LSA) from [24]. Using the text pre-analysis in the previous part,\nwe built a filename-term matrix based on the filenames of the ransom notes the rows of\nwhich correspond to the filenames and columns correspond to the extracted terms from\nthe filenames. To evaluate the importance of each extracted term in the filename individually and in the corpus of filenames, Tf-Idf (Term Frequenc-Inverse document Frequency)\nweighting that assembles local and global weighting was used to the Filename-Term Matrix\n(NTM). It is often used in LSA and text analytics.\nThe weighted matrix was decomposed into three matrices using Singular Value Decomposition (SVD). Indeed, LSA performs an analysis of co-occurrence across the corpus\nof filenames using SVD to reduce the dimensionality of the Filename-Term matrix to a\ndimension k. This dimension is lower than the minimal number between the number of\nrows and columns of our NTM. This reduction has the effect of preserving the strongest\nsemantic information in the filenames and it throws away the noise. After this step, LSA\nidentifies the related terms and puts them under one topic (among the k topics) without\nany prior knowledge on their real classifications. An interesting example that supposes\nthe case of each word means only one concept, and each concept is described by one word.\nIn this case, there is a simple mapping from words to concepts. In reality, however, this\nmapping is impossible because each language has different words that mean the same\nthing, named synonyms. Therefore, LSA tries to identify similar and related terms and\nputs them under one topic. We present the result of applying LSA in three parts:\n\n1. On a corpus of filenames of the ransom files;\n2. On a corpus of filenames of the ransom files and user files;\n3. On a corpus of filenames of files collected from an infected machine by ransomware.\n\n4.2.1. LSA on a Corpus of Filenames of the Ransom Files\n\nThe filename preparation and pre-analysis applied in this part have some differences\nto the pre-analysis of Section 4.1. We changed the random characters, the ID or the\nBitcoin addresses in the filenames to []. Therefore, the filenames that contain only these\nmarkers were removed from the list (empty filenames). After some LSA tests, we removed\nfrom the filenames the added extensions of the encrypted files. We did not know if\ngiven ransomware keeps the same extension in all its infections, generated for each target\nmachine or it is a random extension. To obtain only alphanumeric filenames, we substituted\na space for any special character. We replaced the uppercase letters with their lowercase\nform. Then the obtained results were filtered to avoid the digit filenames and any term\nin the filenames with one character. To split the terms, we used probabilistic splitter\n[words (Wordninja: https://github.com/keredson/wordninja, accessed on 15 September](https://github.com/keredson/wordninja)\n[2021). We also tested another splitter (A compound word splitter for Python: https:](https://github.com/TimKam/compound-word-splitter)\n[//github.com/TimKam/compound-word-splitter, accessed on 15 September 2021) named](https://github.com/TimKam/compound-word-splitter)\nCompound Word Splitter. In our case, we found that the first splitter split the terms more\ncorrectly than the second splitter did. We did not use the stop words removal because these\nwords are mostly used in the filenames. Finally, the obtained terms were stemmed using\n```\n             Snowball stemmer.\n\n```\nThe results of LSA are related to the number k of dimensions (also named singular\nvalues or latent factors). Choosing few singular values can lose valuable information. On\nthe contrary, choosing many latent factors may not be meaningful. Among the proposed\nsolutions to find the number of latent factors, we used the percentage of variance explained\nby retaining k factors [23]. Then we visualized the results to determine how many latent\nfactors to keep in our LSA by looking for an elbow in the plot. The results appear in\n\n\n-----\n\n_Computers 2021, 10, 145_ 13 of 25\n\nFigure 3. We found that the value k = 16 is an optimal dimension. The LSA similarities\nbetween the filenames shows that we cannot find large similarities, neither between all the\nfilenames of the collected ransom files, nor between the filenames of the ransom files used\nby the same family in all its versions. Indeed, the filenames of the ransom files of some\nfamilies have high similarities with the ransom filenames of other families.\n\n**Figure 3. Variance Explained by Number of Singular Vectors.**\n\nTable 7 shows an example. The ransom filename HELP_DECRYPT of CryptoWall 3.0\ndoes not have high similarities with the ransom filenames of the other versions of this\nransomware. On the other hand, this filename has high similarities with the ransom\nfilenames of other ransomware families like Cerber, Sad and Mr.Dec. Therefore, the\nidentification or the classification of the ransom files using only their filenames can give\nwrong results. Related to Section 3.4, ID-Ransomware or any ransom notes identifier must\nbe aware about these wrong identifications using only the filenames of the ransom files.\nThe top ten terms of the 16 topics (k = 16) are mentioned in Table A2 in Appendix A.\nWe found that several terms like decrypt, help and readm are into more than one topic.\nViewing several terms in more than one topic means that they are related between them in\nseveral filenames. In other words, this result can allow us to classify the filenames into two\ngroups: ransom filenames and benign filenames.\n\n**Table 7. Similar Filenames to HELP_DECRYPT of CryptoWall 3.0.**\n\n**Ransom Note** **Sim.** **Ransom Note** **Sim.**\n\nHELP_YOUR_FILES _HELP_HELP_HELP_[random]_\n0.500 0.770\n(Cryptowall 2016-01-17) (Cerber 2017-01-26)\n\nDECRYPT_INSTRUCTION _HELPME_DECRYPT_\n0.350 0.750\n(Cryptowall 2.0) (Sad)\n\nINSTRUCTIONS_[ID] Decoding help\n0.005 0.740\n(Cryptowall 2016-02-05) (Mr.Dec)\n\n4.2.2. LSA Applied on Files of an Uninfected Machine\n\nWe took 3000 filenames of several files from an uninfected machine running Windows\n7. We added to this list the filenames of the ransom notes of our dataset. A pre-analysis\nprocess like the previous subsection was applied to all these filenames. Then we applied\nLSA using a splitter and without splitter on this corpus of filenames to extract any similarity\nbetween the benign filenames and ransom filenames. The percentage of variance explained\nby retaining k factors in both cases did not display a clear elbow to find an optimal k.\nFor these reasons, we calculated the similarities between the words defined as ransom\n\n\n-----\n\n_Computers 2021, 10, 145_ 14 of 25\n\nfilenames and the words defined as benign filenames. Then we took for different singular\nvalues the number of queries that corresponded to some cases of similarities. Table 8 shows\nthe results of our tests. For example, the gray cell means that for k = 1100 without splitter,\nwe have 209 queries that have similarities between 0.5 and 0.8. For our test, we consider\nonly the similarities s > 0.8:\n\n           - In the case with splitter, the number of queries tends to be 62 queries that have\nsimilarities > 0.8 approximately from k = 943;\n\n           - Without splitter, the number of queries tends to be 60 queries that have similarities\n\n_> 0.8 approximately from k = 1509._\n\n**Table 8. Number of Queries with Similarity < 0.5, and ≥** 0.5.\n\n**Number of Queries**\n\n**_s ≤_** **0.5** **0.5 < s ≤** **0.8** **0.8 < s ≤** **0.9** **0.9 < s < 1** **_s = 1_**\n\nS 240245 (96.92%) 311 (0.129%) 1 (0.0004%) 1 (0.0004%) 60 (0.025%)\n_k = 1000_\nNS 247556 (99.87%) 214 (0.089%) 11 (0.004%) 19 (0.007%) 60 (0.025%)\n\nS 240245 (96.92%) 311 (0.129%) 1 (0.0004%) 2 (0.0008%) 59 (0.024%)\n_k = 1100_\nNS 247561 (99.88%) 209 (0.086%) 11 (0.004%) 23 (0.009%) 56 (0.023%)\n\n_k = 1400_ NS 247590 (99.89%) 208 (0.086%) 1 (0.0004%) 5 (0.002%) 56 (0.023%)\n\n_k = 1700_ NS 247634 (99.90%) 166 (0.069%) 0 (0.0%) 46 (0.019%) 14 (0.005%)\n\ns = similarity, NS = without splitter, S = with splitter.\n\nEven though there were no ransom files within the benign files and the number of\nqueries was a minimum for k maximal, some benign filenames were similar to ransom\nfilenames (false positives). In this case, the ransom note detector can use other ransom file\ncharacteristics like the content to avoid these false positives. Table 9 shows for a similarity\n\n_> 0.8 the ransom note filenames and their similar benign filenames for k = 943 with splitter_\nand k = 1509 without splitter. The number of queries that have similarities > 0.8 in the\ncase without the splitter is less (60 queries) than the case with the splitter (62 queries). In\nother words, the case with splitter can add other false positives. For example, the word\n```\n             asasin is divided into the words as as in, then it is similar to the benign file named\n             “ASF.pm” (“asf” is divided into as f). In summary, despite the machine not being infected\n\n```\nby ransomware, we found some false positives for LSA. Compared to the number of benign\nfilenames (3000 filenames), we had only 20 filenames in the case with the splitter and\n18 filenames without the splitter, which makes our idea promising to be used with other\nmonitored behaviors to detect the ransomware like checking the content of these files. The\nnext subsection presents the same test, but on an infected machine by a ransomware.\n\n4.2.3. LSA Applied on Files of an Infected Machine\n\nWe infected the same machine by zoro ransomware which adds in each target directory three txt ransom files: !-GET_MY_FILES-!-.txt, #RECOVERY-PC#.txt and @_RESTORE```\n             FILES_@.txt. Our dataset does not contain the second and the third ransom files. We tried\n\n```\nto find the ransom files of Zoro using LSA.\n\n           - All ransom files !-GET_MY_FILES-!.txt and @_RESTORE-FILES_@.txt were detected.\nHowever, the txt files of #RECOVERY-PC#.txt were not detected because their filenames contain the word PC, which did not exist in any ransom filename of our dataset\nand the chosen threshold of similarity (>0.8) was not sufficient to detect this filename\nwithout false positives. Generally, we can detect this ransom file by adjusting the used\nstemmer to include recovery and recover in the some word recov. Therefore, the\nstemming method on the filenames has some effects on the results: using one word,\nwe can detect other related words.\n\n\n-----\n\n_Computers 2021, 10, 145_ 15 of 25\n\n**Table 9. Ransom Filenames and their Similar Filenames.**\n\n**With Splitter (k = 943)** **Without Splitter (k = 1509)**\n\n**Ransom Note** **Nbr of Queries** **Similar Files** **Ransom Note** **Nbr of Queries** **Similar Files**\n\n`“ReadMe”` 14 for `ExifTool\\README` `“ReadMe”` 14 for same files\n`“_[]_README_”` each `Recent\\readme.lnk` `\"_[]_READ` each like with\n`“README”` ransom `hexrays\\readme.txt` `ME_\"` ransom splitter\n`“@README”` name `IDAscope\\README.md` `“README”` name\n```\n                    ExeinfoPE\\readme.txt “@README”\n                     plugsdk\\readme.txt\n                      PeiD\\readme.txt\n                    WebAdmin\\Readme.html\n                      Doc\\ReadMe.txt\n                     PESpin\\ReadMe.txt\n                      odbg\\readme.txt\n                       upx\\README\n                      upx\\README.1ST\n                     reghost\\readme.txt\n\n```\n\nsame files like with\nsplitter case but\nwithout\n```\n idahelp.chm\n\n```\n```\n“_HELP_HELP_\n\n```\n5\n```\n HELP_[]_”\n\n```\n```\n Mnt\\Help.lnk\nepydoc\\help.html\nIDA\\idahelp.chm\n odbg\\help.pdf\n odbg2\\help.pdf\n\n```\n```\n“_HELP _HELP_\n\n```\n4\n```\n HELP_[]_”\n\n```\n\n`“asasin”` 1 `ExifTool\\ASF.pm`\n\nTable 10 shows the false positive filenames in both states: infected machine state and\nuninfected state (FP means that the file was detected as a false positive ransom file. TN means\nthat the file is a true negative file). Comparing the two states, the last 11 files that were\ndetected in the uninfected state as false positives are detected in the infected state as true\nnegatives. The reason for these changes is related to the added extension to the encrypted\nfiles. Indeed, Zoro ransomware adds the extension aurora. A file named book.txt will\nbe book.txt.aurora. This behavior of adding new extensions to the encrypted files is\nhelpful for any ransom filename detector supposes that the filename is all the words in\nthe filename until the last dot. Indeed, the detector will remove the extension (last word\nafter the last dot), then takes the rest as a filename. For example, the filename of a file\nnot encrypted by ransomware like test.sys is test and the filename of an encrypted\nfile like book.txt.aurora is book.txt. In our test, this effect reduced the number of false\npositives seen in the previous part like the readme or help files of some tools. A ransom\nfilename searched by the detector, such as readme.html, is readme which had a different\nLSA similarity to the filename of an encrypted file readme.txt.aurora. The last was\nevaluated by (LSA) as a readme.txt. The false positive filenames in the infected case are\nless than the uninfected case which means that our approach to use the ransom filenames\nto detect the ransomware is correct.\n\n\n-----\n\n_Computers 2021, 10, 145_ 16 of 25\n\n**Table 10. FP and TN files in the Infected/Uninfected State with Splitter.**\n\n**File Name** **Uninfected State** **Infected State**\n\n`..\\Maintenance\\Help.lnk` FP FP\n`..\\epydoc\\help.html` FP FP\n`..\\ExifTool\\README` FP FP\n`..\\Recent\\readme.lnk` FP FP\n`..\\IDAscope\\README.md` FP FP\n`..\\WebAdmin\\Readme.html` FP FP\n`..\\upx\\README` FP FP\n`..\\upx\\README.1ST` FP FP\n`..\\Recover My Files.lnk` TN FP\n`..\\Recover My Files v5.lnk` TN FP\n`..\\ExifTool\\ASF.pm` FP FP\n`..\\hexrays_sdk\\readme.txt` FP TN\n`..\\ExeinfoPe\\readme.txt` FP TN\n`..\\pluginsdk\\readme.txt` FP TN\n`..\\PeiD\\readme.txt` FP TN\n`..\\Documentation\\ReadMe.txt` FP TN\n`..\\PESpin\\ReadMe.txt` FP TN\n`..\\odbg\\readme.txt` FP TN\n`..\\regshot\\readme.txt` FP TN\n`..\\IDA\\idahelp.chm` FP TN\n`..\\odbg\\help.pdf` FP TN\n`..\\odbg2\\help.pdf` FP TN\n\n4.2.4. Machines Learning on Ransom Names\n\nIn this section, we describe how we used Machine Learning models to classify filenames as ransom filenames or benign filenames. The same pre-analysis presented above\nwas used. The evaluated filenames were separated into two groups based on the chosen\nsplit rule: training set and testing set. A popular split [23] is to put 70% of the filenames\nin the training set and the rest in the testing set. The distribution of the filenames in\nour dataset was imbalanced, more benign filenames than ransom filenames. To solve\nthis problem, we used Synthetic Minority Over-sampling Technique (SMOTE) [25] and\nNeighborhood Cleaning Rule (NCR) [26]. The first generated minor examples to be added\nto the original set. The second performs under-sampling based on the condensed nearest\nneighbor (k = 1 default case) method. The chosen learning models in this test were: Logistic Regression, Decision Tree, K-Nearest Neighbor, Naive Bayes, Random Forests and\nSupport Vector Machine. The classification method was applied to the Tf-Idf weighted\nNTM (Filenames-Term Matrix) of the training set. Once the classifier was created, it was\napplied to the Tf-Idf weighted NTM of the testing set.\nAmong several ways to evaluate which model to choose, we have the accuracy of the\nmodels. Table 11 presents the overall accuracy in descending order (with F-measure) in the\ncase without a splitter. We conclude that the Random Forests model is an optimal choice to\ndetect the ransom filenames in our dataset due to its best accuracy value. Random forests\n(RF) are a part of the tree based model family. These models try to build a combination of\ntree predictors with different initial variables. Precision, recall and F-measure are described\nin Table 12 in the case without splitter. The overall accuracy of this model is 98.32%, and the\noverall F-measure is 0.920. The model misclassifies 13 filenames: nine ransom filenames are\nclassified as benign filenames and four benign filenames are classified ransom filenames.\nIn summary, the detection of the ransom files using LSA or Machine Learning models\non the filenames is possible. However, it must be combined with other indicators to detect\nthe ransomware. ID-Ransomware service uses the saved filenames in its database without\nany check of similarity of the filenames to identify the associated ransomware to a given\nransom file. However, checking the similarity of the ransom filenames can be used (with\nother patterns in the ransom files) to identify the ransomware associated to a given ransom\nfile.\n\n\n-----\n\n_Computers 2021, 10, 145_ 17 of 25\n\n**Table 11. Overall Accuracy in Descending Order.**\n\n**Order** **Model** **Overall F-Measure** **Overall Accuracy**\n\n1 Random Forests 0.920 98.32%\n\nSupport Vector\n2 0.895 97.81%\nMachine\n\n3 Decision Tree 0.900 97.81%\n4 Naive Bayes 0.900 97.68%\n5 Logistic Regression 0.890 97.55%\n6 k-Nearest Neighbor 0.425 52.89%\n\n**Table 12. RF Contingency Matrix and Goodness of F-Measure (without splitter).**\n\n**Actual**\n\n**(47 Ransom Filenames + 730 File Filenames)**\n\n**Ransom Filename** **Benign Filename**\n\n**Ransom Name** 38 4\n**Predicted**\n**Benign Name** 9 726\n\n**Precision** **Recall** **F-measure**\n\n**Ransom Filename** 0.90 0.80 0.85\n**Benign Filename** 0.98 0.99 0.99\n\n**5. LSA on the Content of Ransom Files**\n\nRansomware developers use the ransom files to contact their victims and notify them\nthat their files have been encrypted. In some cases, the ransomware developers try to be\ncreative in the content and the receipt addressed to their victims. The ransom files have\na fixed objective which is to draw the attention of the victim in order to pay the ransom.\nSome ransomware families distinguish themselves from other families by adding some\nfeatures in their ransom files. For example, Spora ransomware conducts its victims to a\npayment portal. This portal offers many services to the victims like deadline extensions and\nfree decryption for some files. The most interesting feature is the real-time chat window\nwhere victims can contact the Spora developers. It was a unique feature compared to other\nransomware seen in 2017. Another example is White Rose ransomware that was spread at\nthe end of March 2018. The ransom note of this ransomware tells a strange story about its\ndeveloper. He offers to share a white roses with the victims which results in encrypting the\nfiles. Despite the fact that there are several ransomware families in the world, the main\naim of the ransom files of all ransomware has a fixed objective to inform the victim that\nhis files are encrypted and the single way to restore the files is the payment of the ransom.\nThis section is a continuation of the previous section that suggests the use of LSA on the\nfilenames of the ransom files to identify the ransom files and detect the ransomware.\n\n_5.1. The Content to Identify the Ransom File_\n\nThe exploration and application of the previous pre-analysis done above was applied,\nwith some differences, in the stop word removal step. Contrary to the pre-analysis of the\nfilenames where we used a created stop word list, we used the predefined stop words\ndictionary from the Python module Nltk. Table 13 presents the top ten of the used terms in\nthe content of the ransom files.\nThe most used term is file and this term is the most used in the filenames. This\nterm is followed by tor, browser, encrypt, then decrypt. These terms summarize the\ncontent of most ransom files: files are encrypted to decrypt them and use the address in the Tor\n_browser then follow the instructions._\n\n\n-----\n\n_Computers 2021, 10, 145_ 18 of 25\n\n**Table 13. Top 10 of the Used Terms in the Content of the Ransom Files.**\n\n**Term** **Count** **Term** **Cont**\n\n1 file 1417 6 instruct 409\n2 tor 951 7 key 371\n3 browser 910 8 instal 359\n4 decrypt 617 9 address 353\n5 encrypt 419 10 internet 346\n\nAs in Section 4.2.1, we used the percentage of variance explained by retaining k factors.\nThen we visualized the results to determine how many latent factors to keep in our LSA by\nlooking for an elbow in the plot. The results appear in Figure 4. We found that 3 and 6 are two\noptimal values for k. Figure 5 shows a part of the document–document (ransom file–ransom\nfile) similarities in the six-dimensional LSA space. An example of pairs of documents with\nhighest similarity value is the pair of the ransom file [HOW_TO_DECRYPT_FILES].html of\n```\n             Locker ransomware and the two ransom files ReadMe.txt/.html of Sigma ransomware.\n\n```\nOther examples are framed in the same figure. Many ransom files of the same family\n(multiple versions) have high similarity between them. The results seem reasonable\nbecause the little reformulations/modifications in the content of these files have no effect\non the results of LSA.\n\n**Figure 4. Variance Explained by the Number of Singular Vectors (k).**\n\nSection 3.4 describes the proposed process to identify the ransom files and to associate\nthem with their ransomware by checking the similarity of the content in the last step of\nthe process. The reason that checking the similarities of the content in the last step is due\nto few false positives ransom files. Indeed, we calculated for different thresholds s ≥ 0.9\nand for k ∈{3, 6} the number of similar ransom files for each ransom file in the corpus.\nTable 14 shows the number of false positives (FP) and true positives (TP) for some chosen\nthresholds of similarities (s).\n\n**Figure 5. Part of the Doc–Doc Similarities in the Six-dimensional LSA Space.**\n\nThe optimal values of s and k can be found approximately from a threshold s ≥ 0.999\nfor k = 3 and from s ≥ 0.99 for k = 6. Indeed, approximately from these thresholds, the\nnumber of false positive is less than the number of true positive. The two cases tend to the\n\n\n-----\n\n_Computers 2021, 10, 145_ 19 of 25\n\nsame number of false positives and true positives. We can say that the case k = 6 converges\nmore quickly to eight false positives than case k = 3.\n\n**Table 14. Number of FP and TP Labels for k = 3 and k = 6.**\n\n**_k = 3_** **_k = 6_**\n**Threshold**\n\n**FP** **TP** **FP** **TP**\n\n0.9 ≤ _s_ 6926 1180 2586 954\n0.99 ≤ _s_ 1512 826 390 742\n0.999 ≤ _s_ 332 582 86 486\n0.999995 ≤ _s_ 14 376 8 372\n0.999999 ≤ _s_ 8 372 8 372\n0.9999999 ≤ _s_ 8 372 8 372\n\nTable 15 shows the eight false positives. For example, the ransom file HELP_RESTORE_\n```\n             FILES.txt of CryptoLocker is labeled as a ransom file of TeslaCrypt or Alpha ransomware.\n\n```\nFor this reason, we choose that checking the content of the ransom files is the last used step\nby the ransom note identifier to identify the ransom files. On the other hand, it can be used\nto choose between multiple ransomware suggested by the ransomware identifier.\n\n**Table 15. The Eight False Positive Labels.**\n\n**Ransom Note File** **False Positive Ransomware Label**\n\n`HELP_RESTORE_FILES.txt of CryptoLocker` TeslaCrypt & Alpha Crypt\n```\n                 HELP_TO_SAVE_FILES.txt of the version\n\n```\nTeslaCrypt & CryptoLocker\nseen on 2015-04-30 of Alpha Crypt\n```\n                 HELP_RESTORE_FILES.txt of the version\n\n```\nCryptoLocker & Alpha Crypt\nseen on 2015-04-03 of TeslaCrypt\n\n`_READ_ME_FOR_DECRYPT.txt of Rapid` StorageCrypt\n\n`_READ_ME_FOR_DECRYPT of StorageCrypt` Rapid\n\n_5.2. The Content to Detect the Ransomware_\n\nOur proposition to increase the effectiveness of the ransomware detection tools can\nbe based on the following scenario. The reader can use more convincing and elaborate\ndescription of its detection/prevention scenario than our proposed scenario:\nLet us suggest a ransomware detector that detects the ransomware using its malicious\nbehaviors. For each behavior, a value v is added to a malice score m of a given monitored\nprocess. This detector concludes that the monitored process is a ransomware if m reaches a\nthreshold t:\n\n1. By checking the filenames of the created txt, htm(l), hta and rtf files by LSA,\nthe detector focuses only on the filenames of these files than focusing on the whole\ncontent of all the created files;\n2. The detector applies LSA again on the content of any created file marked by the first\nitem as a ransom filename;\n3. If the content is marked as a ransom note content, the owner process that created this\nfile is suspicious and it is probably ransomware. In this case, v is added to the malice\nscore of this process. For this behavior, we suggest that the added value v is high such\nthat m reaches the threshold t.\n\nAs described in Table 14, the similarity between the ransom files of different families\nis high despite a threshold s ≥ 0.9. For this reason, we have calculated using LSA the\nsimilarities between the ransom files and benign files. The benign files were collected from\ndifferent machines searching for any txt or pdf file named readme or containing the term\n```\n             help in the filename. We added to these files several files from different corpora like [26]\n\n```\n\n-----\n\n_Computers 2021, 10, 145_ 20 of 25\n\nor [27] to construct a corpus of 200 randomly benign files. Using the same pre-analysis of\nSection 4.2.1, we found three optimal values for k, which are 6, 10 and 11. Table 16 shows\nthe number of similar ransom files to benign files for each k.\n\n**Table 16. Number of Similar Ransom Files to Benign Files for some Thresholds.**\n\n**Dimensions**\n**Threshold of Similarity**\n\n**6** **10** **11**\n\n_s ≥_ 0.90 234 3 1\n_s ≥_ 0.91 199 1 1\n_s ≥_ 0.92 160 1 1\n_s ≥_ 0.94 94 1 1\n_s ≥_ 0.95 46 0 0\n_s ≥_ 0.97 6 0 0\n_s ≥_ 0.99 0 0 0\n\nAs shown in Table 16, we can differentiate between the benign files and ransom files.\nIndeed, the number of similar ransom files to benign files is null for k = 6 from a threshold\n_s ≥_ 0.99 and k ∈{10, 11} from s ≥ 0.95. Effectively, the content of the ransom files cannot\nevade from their objective and their context. To prove our idea, we collected three spread\nransomware during 2020 and 2021. Then we tried to check their similarities with the benign\nfiles and ransom files of the same dataset. The collected ransomware were:\n\n           - `CryptoMix that adds a ransom note file named _HELP_INSTRUCTION.txt at the begin-`\nning of infection (before encryption) in the root directory;\n\n           - `French101 adds the ransom file HOW TO RECOVER ENCRYPTED FILES.txt in any target`\ndirectory containing target files before encrypting its content;\n\n           - `StopDjvu ransomware adds _readme.txt in the Desktop of the current user before`\nencrypting its content.\n\nThe three ransomwares add their ransom files before encryption. We compared the\nsimilarities of the ransom files of these ransomware with our dataset of benign files and\nransom files. Table 17 shows for k = 10 and s ≥ 0.95 the files that are similar to these\nransom files. These ransom files of these ransomwares are similar only to the other ransom\nfiles. No similarities to benign files were seen.\nWe explored other ransomware seen in 2020 and 2021 that add their ransom files before encryption like ChaCha, JSWorm, GlobImposter, StopDjvu and Buran ransomware.\nTheir ransom files have high LSA similarity (≥0.90) with the other ransom files like the\nransom files of Dharma, and Querty. Their LSA similarity with the benign files is low.\nMoreover, we tried to detect these ransomware using some ransomware detection tools like\n```\n             AntiRansomV3 (Security Projects: AntiRansom,http://www.security-projects.com/?Anti_\n\n```\n[Ransom, accessed on 15 September 2021), CryptoDrop [3], DaD [12], Acronis Ransomware](http://www.security-projects.com/?Anti_Ransom)\n```\n             protection (Acronis Ransomware Protection, https://www.acronis.com/fr-fr/personal/\n\n```\n[free-data-protection/, accessed on 15 September 2021), Kaspersky Anti-Ransomware](https://www.acronis.com/fr-fr/personal/free-data-protection/)\n[(Kaspersky Anti-Ransomware Tool, https://www.kaspersky.fr/anti-ransomware-tool, ac-](https://www.kaspersky.fr/anti-ransomware-tool)\ncessed on 15 September 2021) (without updates) and CyberReason RansomFree (Cyberea[son: Cybereason RansomFree, (https://www.cybereason.com/solutions/ransomware-](https://www.cybereason.com/solutions/ransomware-protection)\n[protection, accessed on 15 September 2021). Most of these tools detected these ransomware](https://www.cybereason.com/solutions/ransomware-protection)\nafter encrypting some files in the target directories and after they created the ransom files.\nOnly the updated version of Kaspersky Anti-Ransomware detected these ransomware.\nThis tool uses the signature scans with a behavioral analysis to detect the ransomware.\n\n\n-----\n\n_Computers 2021, 10, 145_ 21 of 25\n\n**Table 17. Similar Files for k = 10 and s ≥** 0.95.\n\n**Ransom Note Name** **Sim.** **Similar Files**\n```\n                _HELP_INSTRUCTION.txt helloreadmenow23.txt\n\n```\n0.9858\n(CryptoMix) of CryptoBit ransomware\n```\n                                         READ THIS IF YOU WANT TO GET\n\n```\n0.9817 `ALL YOUR FILES BACK.txt of Omerta`\nransomware\n```\n                                        How to decrypt files.txt of Vendetta\n\n```\n0.9872\nransomware\n\n0.9869 all info.hta files of Dharma ransomware\n```\n                                          !! RETURN FILES !!.txt and\n\n```\n0.9902\n```\n                                        Payday.hta of BTCWare ransomware\n                  HOW TO RECOVER\n                                          !#_READ_ME_#!.hta BTCWare\n\n```\n`ENCRYPTED FILES.txt` 0.9884\nransomware\n(French101)\n```\n                                        HOW TO RECOVER ENCRYPTED FILES.txt\n\n```\n0.9974\nof Scarab ransomware (2018-10-12)\n```\n                                        IF YOU WANT TO GET ALL YOUR FILES\n\n```\n0.9930 BACK, PLEASE READ THIS.txt\nof scarab ransomware (2017-11-23)\n```\n                                        DECRYPTING.txt of Comonransomware\n\n```\n0.9923\nransomware\n```\n                                         README_DECRYPT.html of striked\n\n```\n0.9829\nransomware\n0.9592 `RECOVER.txt of hc7 ransomware`\n```\n                                          ransom_pay.html (unknown\n\n```\n0.9755\nransomware)\n```\n                                          how_to_back_files.html of\n\n```\n`_readme.txt (StopDjvu)` 0.9813\nGlobImposter\n```\n                                         How to restore your files.hta\n\n```\n0.9768\nof GlobImposter ransomware\n\n0.9503 `[unknown].txt of Amnesia`\n\n0.9706 `DECRYPT.[].txt of rapid`\n\n0.9734 `README_BACK_FILES.htm of Eq`\n\nIn this section, the LSA tests on the content of the ransom files is detailed. Applying\nthis method must be preceded by a pre-analysis on the content to filter it and keep only\nthe significant terms. The results of applying LSA on the content are promising. Indeed,\nthe identification of the ransom files using LSA as the last method to identify the ransom\nfiles can give more interesting results using a large database of ransom files. On another\nhand, the high similarities between the ransom files differentiate them from the benign\nfiles, which make their detection possible. Generally, a ransom note remains a file that\nnotifies the victim to pay a ransom and the same content is repeated in most ransom files.\n\n**6. Conclusions**\n\nThrough LSA and the extracted markers from the ransom files, we present our approaches to identify the ransom files and associate them with their ransomware. The\nresults are promising and can be very promising by assembling all markers by checking\nthe similarities of the filenames and the content of the ransom files in a real ransom note\nidentifier with a large database of ransom files. On the other hand, we found that the used\nterms in the filenames of the ransom files are limited to a few terms, which make their\n\n\n-----\n\n_Computers 2021, 10, 145_ 22 of 25\n\ndetection possible compared to the filenames of benign files on a target machine. However,\nusing LSA or Machine Learning models such as Random Forest to differentiate between\nthe filenames of benign files and ransom files shows interesting and encouraging results.\nOur idea to detect ransomware is based on using the ransom files. Indeed, we propose\nthe use of LSA for the content of any file labeled as a ransom file by checking its filename.\nMost ransom files keep the same context in their ransom files to notify the users and pay\nthe ransom. For this reason, the LSA similarity between the content of the ransom files and\nthe content of benign files is not high. The continuation of this paper and future works\nshould focus on:\n\n           - Assembling all the markers cited in the third section to make a complete and automatic\nransomware identifier;\n\n           - Proving our approach to detect ransomware using the ransom files with other ransomware suspicious behaviors in a real ransomware detection tool like CryptoDrop,\n```\n               ShieldFS, DaD and other tools. We have started the first tests on DaD by checking the\n\n```\nfilenames of the ransom files. Firstly, we tested this detection tool on 60 arbitrary\nsamples of several ransomware families, including some known families like Dharma,\n```\n               Spora, StopDjvu, GandGrab and GlobImposter. Dad detected all the 60 ransomware\n\n```\nexcept five ransomware. One of these ransomware adds the ransom file before encryption. Three ransomware add the ransom file after encrypting the content of one target\ndirectory. The last ransomware is a multi-threading ransomware that adds the ransom\nfile after encrypting at least one file. By adding our approach to DaD, we were able to\ndetect all these ransomwares with few encrypted files. The result of using DaD and\nchecking the ransom files to detect ransomware will be published in our future work;\n\n           - Using LSA on other features such as dumps memory of the running process on\na target machine. Indeed, until the date of writing this paper, most ransomwares\nuse the ransom files to notify the victims. However, with our detection technique\nusing LSA on the filenames, the content of the ransom files is useful for fighting\nfuture ransomware. This detection technique can show some limits to detecting\nmore ingenious future ransomware such as the ones that use encoded content for\ntheir ransom files or new communication channels through URL links. As proven in\nthis paper, LSA has shown its effectiveness to differentiate between benign files and\nransom files. For these reasons, we suppose that LSA can differentiate between the\ndump memory of a ransomware process and other benign processes.\n\n**Author Contributions: Formal analysis, Y.L. and J.-L.L.; Methodology, Y.L., J.-L.L. and E.M.S.; Project**\nadministration, E.M.S.; Resources, Y.L.; Software, J.-L.L.; Supervision, J.-L.L. and E.M.S.; Validation,\nJ.-L.L. and E.M.S.; Writing—original draft, Y.L.; Writing—review & editing, Y.L. and E.M.S. All\nauthors have read and agreed to the published version of the manuscript.\n\n**Funding: This research received no external funding.**\n\n**Institutional Review Board Statement: Not applicable.**\n\n**Informed Consent Statement: Not applicable.**\n\n**Acknowledgments: The authors would like to express their acknowledgment and deep gratitude to**\nboth reviewers for their insightful comments, constructive remarks, and efforts towards improving\ntheir manuscript.\n\n**Conflicts of Interest: The authors declare no conflict of interest.**\n\n**Appendix A**\n\nTable A1 shows the used ransom files in this paper organized by ransomware families\nand extensions. The most used extension of the ransom files is txt followed by htm(l).\nMore than 30 families use the txt or htm(l) files as ransom note. Other ransomware like\n```\n             Blind, Mr.Dec and NemucodAES ransomware use hta files. Matrix ransomware family is\n\n```\nthe unique family in our collection that uses rtf files.\n\n\n-----\n\n_Computers 2021, 10, 145_ 23 of 25\n\n**Table A1. Used Ransom Files.**\n\n**Extensions**\n**Families** **Number of Ransom Files**\n\n**TXT** **HTM (L)** **HTA** **RTF**\n\n`Alpha` 1 1                  -                  -                  `Alpha Crypt` 2 2                 -                 -                 `Argus` 1                  - 1                  -                  `BadBlock` 1                  - 1                  -                  `Blind` 1                  -                  - 1 1\n`BTCWare` 4 2                  - 2                  `Cerber` 17 6 3 8                  `Chip` 1 1                   -                   -                   `Comonransomware` 1 1                -                -                `CrypMIC` 2 1 1                  -                  `Crypt0l0cker` 1                 - 1                 -                 `Cryptfile2` 1 1                 -                 -                 `CryptoBit` 1 1                 -                 -                 `Cryptolocker` 1 1                 -                 -                 `CryptoMix` 2 2                 -                 -                 `Crypton` 1                  - 1                  -                  `CryptoShield` 6 3 3                 -                 `CryptoWall` 7 4 3                 -                 `Cryptxxx` 13 6 7                  -                  `Dharma` 16 6                  - 10                  `Diamond` 1                  - 1                  -                  `Dr.Fucker` 1                 - 1                 -                 `Eq` 1                   - 1                   -                   `Everbe` 1                  - 1                  -                  `Evil locker` 1 1                 -                 -                 `GandCrab` 7 6 1                  -                  `Gibon` 1 1                  -                  -                  `GlobeImposter` 4                - 3 1                `HC7` 2 2                   -                   -                   `Hermes` 1                  - 1                  -                  `HydraCrypt` 1 1                 -                 -                 `JAFF` 4 2 2                   -                   `Keyholder` 1                 - 1                 -                 `LockeR` 1                  - 1                  -                  `Locky` 8 1 7                  -                  `Matrix` 4                  -                  - 2 1\n`MMM` 2                   - 2                   -                   `Mole` 1 1                   -                   -                   `Mr.Dec` 1                  -                  - 1                  `NemucodAES` 1                 -                 - 1                 `Omerta` 1 1                  -                  -                  `PrincessLocker` 4 2 2                -                `Qwerty` 1 1                  -                  -                  `Rapid` 1 1                  -                  -                  `RaRansomware` 1                 - 1                 -                 `Sad` 3 1 1 1                   `Sage` 2                   - 1 1                   `Satana` 1 1                  -                  -                  `Saturn` 1 1                  -                  -                  `Scarab` 2 2                  -                  -                  `Sigma` 2 1 1                  -                  `Sigrun` 1                  - 1                  -                  `Spora` 2                  - 2                  -                  `Striked` 1                  - 1                  -                  `TeslaCrypt` 18 11 7                 -                 \n\n-----\n\n_Computers 2021, 10, 145_ 24 of 25\n\n**Table A1. Cont.**\n\n**Extensions**\n**Families** **Number of Ransom Files**\n\n**TXT** **HTM (L)** **HTA** **RTF**\n\n`UIWIX` 1 1                  -                  -                  `Unknown` 5 4 1                  -                  `Velso` 1 1                  -                  -                  `Vendetta` 1 1                  -                  -                  `WhiteRose` 1 1                 -                 -                 `X3m` 1                   - 1                   -                   `Zoro` 1 1                   -                   -                   **Total** 176 84 62 28 2\n\nThe top ten terms of the sixteen topics (k = 16) are mentioned in Table A2. We found\nthat several terms like decrypt, help and readm into more than one topic.\n\n**Table A2. Top Ten Terms in the 16 Dimensions.**\n\n**Dim.** **Terms**\n\n0 _decrypt, file, how, restor, to, help, my, readm, your, encrypt_\n1 _decrypt, help, my, readm, me, inform, argus, de, crypt, sos_\n2 _readm, save, to, your, crypt, de, back, cke, bl, 23_\n3 _info, as, in, get, this, do, text, repair, use, payday_\n4 _recoveri, how, decrypt, to, my, ra, ware, ransom, do, text_\n5 _recoveri, instruct, help, recov, your, readm, me, save, decod, sos,_\n6 _recov, how, instruct, decrypt, to, encrypt, my, for, it, read,_\n7 _encrypt, file, read, my, this, your, get, me, recoveri, thi,_\n8 _restor, instruct, my, file, readm, recoveri, encrypt, decrypt, run, sig,_\n9 _read, me, this, instruct, restor, thi, how, now, if, you,_\n10 _instruct, encrypt, to, how, my, save, back, get, file, this,_\n11 _encrypt, me, how, decrypt, help, restor, readm, read, now, inform,_\n12 _my, me, help, how, readm, encrypt, get, decod, now, sos,_\n13 _me, save, to, your, restor, encrypt, now, repair, use, my,_\n14 _your, back, how, me, get, about, if, you, all, want,_\n15 _back, get, repair, use, to, if, you, want, all, this_\n\n\n**References**\n\n1. Mager, M. Stop and Step Away from the Data: Rapid Anomaly Detection via Ransom Note File Classification. Endgame.\n[2018. Available online: https://www.elastic.co/fr/blog/stop-and-step-away-data-rapid-anomaly-detection-ransom-note-file-](https://www.elastic.co/fr/blog/stop-and-step-away-data-rapid-anomaly-detection-ransom-note-file-classification)\n[classification (accessed on 15 September 2021).](https://www.elastic.co/fr/blog/stop-and-step-away-data-rapid-anomaly-detection-ransom-note-file-classification)\n2. Nieuwenhuizen, D. A Behavioural-Based Approach to Ransomware Detection. MWR Labs Whitepaper. 2017. Available\n[online: https://labs.f-secure.com/assets/resourceFiles/mwri-behavioural-ransomware-detection-2017-04-5.pdf (accessed on 15](https://labs.f-secure.com/assets/resourceFiles/mwri-behavioural-ransomware-detection-2017-04-5.pdf)\nSeptember 2021).\n3. Scaife, N.; Carter, H.; Traynor, P.; Butler, K.R.B. CryptoLock (and Drop It): Stopping Ransomware Attacks on User Data. In\nProceedings of the 36th IEEE International Conference on Distributed Computing Systems, ICDCS 2016, Nara, Japan, 27–30 June\n2016; pp. 303–312.\n4. Lemmou, Y.; Souidi, E. An Overview on Spora Ransomware. In Security in Computing and Communications; Springer: Singapore,\n[2017; pp. 259–275. [CrossRef]](http://doi.org/10.1007/978-981-10-6898-0_22)\n5. [Perekalin, A. WannaCry: Are You Safe? Kaspersky. 2017. Available online: https://www.kaspersky.com/blog/wannacry-](https://www.kaspersky.com/blog/wannacry-ransomware/16518/)\n[ransomware/16518/ (accessed on 15 September 2021).](https://www.kaspersky.com/blog/wannacry-ransomware/16518/)\n6. Lemmou, Y.; Souidi, E.M. PrincessLocker analysis. In Proceedings of the 2017 International Conference on Cyber Security And\nProtection of Digital Services (Cyber Security), London, UK, 19–20 June 2017; pp. 1–10.\n7. [Gazet, A. Comparative analysis of various ransomware virii. J. Comput. Virol. 2010, 6, 77–90. [CrossRef]](http://dx.doi.org/10.1007/s11416-008-0092-2)\n8. Caivano, D.; Canfora, G.; Cocomazzi, A.; Pirozzi, A.; Visaggio, C.A. Ransomware at X-rays. In Proceedings of the 2017 IEEE\nInternational Conference on Internet of Things (iThings) and IEEE Green Computing and Communications (GreenCom) and IEEE\nCyber, Physical and Social Computing (CPSCom) and IEEE Smart Data (SmartData), Exeter, UK, 21–23 June 2017; pp. 348–353.\n\n\n-----\n\n_Computers 2021, 10, 145_ 25 of 25\n\n9. Lemmou, Y.; Lanet, J.L.; Souidi, E.M. A behavioural in-depth analysis of ransomware infection. IET Inf. Secur. 2021, 15, 38–58.\n\n[[CrossRef]](http://dx.doi.org/10.1049/ise2.12004)\n10. Kharraz, A.; Robertson, W.K.; Balzarotti, D.; Bilge, L.; Kirda, E. Cutting the Gordian Knot: A Look Under the Hood of Ransomware\nAttacks. In Proceedings of the Detection of Intrusions and Malware, and Vulnerability Assessment—12th International Conference,\nDIMVA 2015, Milan, Italy, 9–10 July 2015; pp. 3–24.\n11. Continella, A.; Guagnelli, A.; Zingaro, G.; Pasquale, G.D.; Barenghi, A.; Zanero, S.; Maggi, F. ShieldFS: A self-healing, ransomwareaware filesystem. In Proceedings of the 32nd Annual Conference on Computer Security Applications, ACSAC 2016, Los Angeles,\nCA, USA, 5–9 December 2016; pp. 336–347.\n12. Palisse, A.; Durand, A.; Le Bouder, H.; Le Guernic, C.; Lanet, J.L. Data Aware Defense (DaD): Towards a Generic and Practical\nRansomware Countermeasure. In Proceedings of the NordSec2017: 22nd Nordic Conference on Secure IT Systems, LNCS, Tartu,\n[Estonia, 8–10 November 2017; Volume 10674, pp. 192–208. [CrossRef]](http://dx.doi.org/10.1007/978-3-319-70290-2_12)\n13. Lee, J.; Lee, J.; Hong, J. How to Make Efficient Decoy Files for Ransomware Detection? In Proceedings of the International\nConference on Research in Adaptive and Convergent Systems, RACS’17, Krakow, Poland, 20–23 September 2017; pp. 208–212.\n\n[[CrossRef]](http://dx.doi.org/10.1145/3129676.3129713)\n14. Palisse, A.; Bouder, H.L.; Lanet, J.; Guernic, C.L.; Legay, A. Ransomware and the Legacy Crypto API. In Proceedings of the\nRisks and Security of Internet and Systems—11th International Conference, CRiSIS 2016, Roscoff, France, 5–7 September 2016;\npp. 11–28.\n15. Kolodenker, E.; Koch, W.; Stringhini, G.; Egele, M. PayBreak: Defense Against Cryptographic Ransomware. In Proceedings of the\n2017 ACM on Asia Conference on Computer and Communications Security, AsiaCCS 2017, Abu Dhabi, United Arab Emirates,\n2–6 April 2017; pp. 599–611.\n16. Bello, I.; Chiroma, H.; Ali, U.; Jauro, F.; Khan, A.; Okesola, J.; Abdulhamid, S. Detecting ransomware attacks using intelligent\nalgorithms: Recent development and next direction from deep learning and big data perspectives. J. Ambient. Intell. Humaniz.\n_[Comput. 2021, 12, 8699–8717. [CrossRef]](http://dx.doi.org/10.1007/s12652-020-02630-7)_\n17. Poudyal, S.; Dasgupta, D. Analysis of Crypto-Ransomware Using ML-Based Multi-Level Profiling. IEEE Access 2021, 9, 122532–\n[122547. [CrossRef]](http://dx.doi.org/10.1109/ACCESS.2021.3109260)\n18. Kok, S.; Azween, A.; Jhanjhi, N. Evaluation metric for crypto-ransomware detection using machine learning. J. Inf. Secur. Appl.\n**[2020, 55, 102646. [CrossRef]](http://dx.doi.org/10.1016/j.jisa.2020.102646)**\n19. Khan, F.; Ncube, C.; Ramasamy, L.K.; Kadry, S.; Nam, Y. A Digital DNA Sequencing Engine for Ransomware Detection Using\n[Machine Learning. IEEE Access 2020, 8, 119710–119719. [CrossRef]](http://dx.doi.org/10.1109/ACCESS.2020.3003785)\n20. Ketzaki, E.; Toupas, P.; Giannoutakis, K.M.; Drosou, A.; Tzovaras, D. A Behaviour based Ransomware Detection using Neural\nNetwork Models. In Proceedings of the 2020 10th International Conference on Advanced Computer Information Technologies\n[(ACIT), Deggendorf, Germany, 16–18 September 2020; pp. 747–750. [CrossRef]](http://dx.doi.org/10.1109/ACIT49673.2020.9208974)\n21. Moussaileb, R.; Bouget, B.; Palisse, A.; Le Bouder, H.; Cuppens, N.; Lanet, J.L. Ransomware’s Early Mitigation Mechanisms.\nIn Proceedings of the 13th International Conference on Availability, Reliability and Security, ARES, Hamburg, Germany, 27–\n[30 August 2018. [CrossRef]](http://dx.doi.org/10.1145/3230833.3234691)\n22. Jawaheri, H.A.; Sabah, M.A.; Boshmaf, Y.; Erbad, A. Deanonymizing Tor hidden service users through Bitcoin transactions\n[analysis. Comput. Secur. 2020, 89, 101684. [CrossRef]](http://dx.doi.org/10.1016/j.cose.2019.101684)\n23. Anandarajan, M.; Hill, C.; Nolan, T. Practical Text Analytics: Maximizing the Value of Text Data, 1st ed.; Springer: Berlin/Heidelberg,\nGermany, 2018.\n24. Cosma, G.; Joy, M. An Approach to Source-Code Plagiarism Detection and Investigation Using Latent Semantic Analysis. IEEE\n_[Trans. Comput. 2012, 61, 379–394. [CrossRef]](http://dx.doi.org/10.1109/TC.2011.223)_\n25. Chawla, N.; Bowyer, K.; Hall, L.; Kegelmeyer, W. SMOTE: Synthetic Minority Over-sampling Technique. J. Artif. Intell. Res. 2002,\n_[16, 321–357. [CrossRef]](http://dx.doi.org/10.1613/jair.953)_\n26. [Open American National Corpus: MASC. Available online: http://www.anc.org/data/masc/downloads/data-download/](http://www.anc.org/data/masc/downloads/data-download/)\n(accessed on 15 September 2021).\n27. Schler, J.; Koppel, M.; Argamon, S.E.; Pennebaker, J.W. Effects of Age and Gender on Blogging. In AAAI Spring Symposium:\n_Computational Approaches to Analyzing Weblogs; American Association for Artificial Intelligence: Menlo Park, CA, USA, 2006._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-08 - In-Depth Analysis of Ransom Note Files.pdf"
    ],
    "report_names": [
        "2021-11-08 - In-Depth Analysis of Ransom Note Files.pdf"
    ],
    "threat_actors": [
        {
            "id": "e7d03ac8-7d6f-4ea0-83a9-10dff2ea1486",
            "created_at": "2022-10-25T16:07:24.158325Z",
            "updated_at": "2025-03-27T02:02:10.127249Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [
                "UAC-0026"
            ],
            "source_name": "ETDA:Scarab",
            "tools": [
                "Scieron"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3a0cfbbc-2acf-4cc8-afe1-1859679c522c",
            "created_at": "2022-10-25T16:07:24.373716Z",
            "updated_at": "2025-03-27T02:02:10.198532Z",
            "deleted_at": null,
            "main_name": "Vendetta",
            "aliases": [
                "TA2719"
            ],
            "source_name": "ETDA:Vendetta",
            "tools": [
                "AsyncRAT",
                "Atros2.CKPN",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "ReZer0",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "RoboSki",
                "Socmer",
                "Zurten"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9099912b-a00a-4afb-8294-c6d35af421a1",
            "created_at": "2023-01-06T13:46:39.338108Z",
            "updated_at": "2025-03-27T02:00:03.054726Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [],
            "source_name": "MISPGALAXY:Scarab",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535588,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1636403976,
    "ts_modification_date": 1636379082,
    "files": {
        "pdf": "https://archive.orkl.eu/029064a314319a3a104e641bca4ecbda38699536.pdf",
        "text": "https://archive.orkl.eu/029064a314319a3a104e641bca4ecbda38699536.txt",
        "img": "https://archive.orkl.eu/029064a314319a3a104e641bca4ecbda38699536.jpg"
    }
}