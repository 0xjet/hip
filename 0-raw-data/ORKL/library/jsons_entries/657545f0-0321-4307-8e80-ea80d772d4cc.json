{
    "id": "657545f0-0321-4307-8e80-ea80d772d4cc",
    "created_at": "2023-01-12T14:58:55.2627Z",
    "updated_at": "2025-03-27T02:15:46.079758Z",
    "deleted_at": null,
    "sha1_hash": "84676de3dede8df5094f54ce7ee3e093d516bdfb",
    "title": "2019-07-19 - An Analysis of L0rdix RAT, Panel and Builder",
    "authors": "",
    "file_creation_date": "2022-05-28T02:43:44Z",
    "file_modification_date": "2022-05-28T02:43:44Z",
    "file_size": 2520019,
    "plain_text": "# Recent Posts\n\n**bromium.com/an-analysis-of-l0rdix-rat-panel-and-builder/**\n\n[HP Threat Research Blog • An Analysis of L0rdix RAT, Panel and Builder](https://www.bromium.com/blog/)\n\n## An Analysis of L0rdix RAT, Panel and Builder\n\n\nJuly 19, 2019\n\n\nL0rdix is a multipurpose remote access tool (RAT) that was first discovered being sold on\nunderground criminal forums in November 2018. Shortly after its discovery, Ben Hunter of\n[enSilo analysed the RAT’s functionality. Although L0rdix’s author set the price of the RAT at](https://blog.ensilo.com/l0rdix-attack-tool)\n\n\n-----\n\n4000 RUB (64 USD), for many cyber criminals even this was too high a price. In June 2019,\na cracked version of the RAT’s builder and admin panel began circulating through\nunderground forums. I was especially curious in the admin panel to see if an analysis of it\nwould lead to a better understanding of L0rdix and potentially improve its detection in the\nwild.\n\nFigure 1 – Advert for a cracked copy of the L0rdix RAT panel and builder on an underground\nforum in June 2019.\n\n**L0rdix’s Admin Panel**\n\nThe admin panel consists of three components: a HTTP web server for the operator to\nadminister their bots, a pre-made MySQL database for storing data from infected systems,\nand PHP scripts to send bot commands, process data received from bots and interface with\nthe database.\n\nBy default, the URI of the L0rdix panel login page is webserver.tld/admin_login. Unlike many\nother RATs, L0rdix’s login page is simple and does not advertise its namesake.\n\n\n-----\n\nFigure 2 – Login page of L0rdix’s panel.\n\nFigure 3 – The main dashboard of the L0rdix panel.\n\nBy querying the panel’s MySQL database it was possible to understand the types of data\nL0rdix steals from its victims, its default configuration settings, and make an assessment\nabout the sophistication of the malware. In the case of L0rdix, its database contains seven\ntables shown in figure 4, indicating that this RAT is not particularly complex.\n\n\n-----\n\nFigure 4 – Tables in the MySQL database for the L0rdix panel.\n\nThe “victims” table contains basic hardware and configuration information about infected\nsystems, their location calculated using a geoIP database bundled with the panel, and the\nhash rate of the cryptominer (the open source Monero miner, [XMRig) that L0rdix can](https://github.com/xmrig/xmrig)\ncommand bots to download once persistent. Many of the fields relate to cryptomining, for\ninstance one field is designated for the model of GPU used by the infected host, highlighting\nhow important (and lucrative) L0rdix’s author considers cryptojacking as a monetisation\nactivity. We’ve [written about cryptojacking before on this blog. In our assessment, it’s likely](https://www.bromium.com/cryptojacking-coin-miner-attack-uses-nsa-developed-equation-group-tools-to-move-laterally/)\nthat the rebound in the value of cryptocurrencies in the first half of 2019 is one of the drivers\nfor the increase in cryptominer campaigns.\n\n**Default Panel Credentials**\n\nThe “config” table contains the default login credentials to access the panel:\n\nUsername: “root”\nPassword: “toor”\n\nIt’s possible that L0rdix’s author is familiar with the Kali Linux distribution, given that they\nshare the same default credentials.\n\nFigure 5 – The default configuration of L0rdix RAT.\n\nOut of the box, L0rdix operators are able to send eight commands to bots, although custom\ncommands can be defined and added. These include:\n\nDownload and execute\n\n\n-----\n\nUpdate\nOpen page (visible)\nOpen page (invisible)\nCmd\nKill process\nUpload file\nHTTP Flood\n\n**L0rdix’s Command and Control (C2) Encryption and Decryption**\n\n[L0rdix’s C2 traffic is encrypted using AES symmetric-key encryption using a 256-bit key in](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)\nCipher Block Chaining (CBC) mode. When a sample is generated using L0rdix’s builder the\noperator is able to decide the key to encrypt the C2 traffic. A SHA-256 hash is calculated\nfrom the operator’s key. The first 32 characters (i.e. 256 bits) of the hashed operator key is\nused as the AES key in the encryption function. The panel’s encryption function is\n[implemented using the openssl_encrypt PHP function. The function requires a 16-byte](https://www.php.net/manual/en/function.openssl-encrypt.php)\ninitialisation vector (IV), but L0rdix’s author decided to use 16 null bytes. The copy of the\npanel analysed contained a possible default operator key 3sc3RLrpd17. The ciphertext is\nthen Base64 encoded, with any plus (+) characters replaced with tildes (~) using PHP’s\n[str_replace function. L0rdix’s decryption function is simply the reverse of the encryption](https://www.php.net/manual/en/function.str-replace.php)\n[function, using str_replace, base64_decode and](https://www.php.net/manual/en/function.base64-decode.php) [openssl_decrypt.](https://www.php.net/manual/en/function.openssl-decrypt.php)\n\nBased on the implementation of the encryption and decryption functions it appears that each\nL0rdix panel operator must use the same key for every bot they control. From a detection\nstandpoint, this is useful because L0rdix samples can be tied to specific actors based on\ncommon keys. Additionally, since the same key must be used for each panel, this means that\nit is possible to decrypt captured C2 traffic from any bots controlled by a panel where the key\nis known, for example where the key is extracted from a sample.\n\nFigure 6 – L0rdix’s server-side decryption function.\n\n\n-----\n\nFigure 7 – L0rdix’s server-side encryption function.\n\n**L0rdix’s Builder**\n\nThe L0rdix builder is simple with only a few configurable options, including specifying the\nremote IP address or domain where the panel is hosted, generating a mutex to prevent the\nRAT from repeatedly re-infecting systems, and options to enable certain capabilities in the\nmalware.\n\nFigure 8 – L0rdix RAT builder.\n\nL0rdix implements anti-analysis measures, such as enumerating running processes and\nstopping the RAT from exposing its functionality if common analysis tools are detected. The\n[RAT also checks if it is running in a virtual machine or Sandboxie, a sandbox product.](https://www.sandboxie.com/)\n\n\n-----\n\nFigure 9 – L0rdix checks its runtime environment for common analysis tools.\n\nThe L0rdix bot tries to make its C2 communications blend in with legitimate traffic by using\nthe User-Agent string for Firefox 53 on Windows 10, which is hardcoded in the RAT:\n\nMozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101 Firefox/53.0\n\nIt also uses the WMI namespace, [root\\SecurityCenter2, to identify which antivirus is installed](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf)\non the system, which is subsequently sent to the admin panel.\n\nFigure 10 – L0rdix uses WMI to identify antivirus software installed on the infected system.\n\n**Conclusion**\n\nBased on this leak, L0rdix RAT has not evolved much since it first entered the scene in\nNovember 2018. Despite being advertised as a general purpose RAT, much of its\nfunctionality is geared towards cryptojacking. It is possible that this is a response by L0rdix’s\nauthor to meet the rising demand for cryptomining botnets.\n\n**YARA Signature**\n\nAs part of this research a YARA rule was written to detect L0rdix binaries, which we are\nsharing with the community.\n\n\n-----\n\n```\nrule win_l0rdix {\n     meta:\n          author = \"Alex Holland (Bromium Labs)\"\n          date = \"2019-07-19\"\n          sample_1 =\n\"18C6AAF76985404A276466D73A89AC5B1652F8E9659473F5D6D656CA2705B0D3\"\n          sample_2 =\n\"C2A4D706D713937F47951D4E6E975754C137159DC2C30715D03331FC515AE4E8\"\n     strings:\n          $ua = \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101\nFirefox/53.0\" wide // Firefox 53 on Windows 10\n          $sig = \"L0rdix\" wide ascii\n          $sched_task = \"ApplicationUpdateCallback\" wide\n          $exe = \"syscall.exe\" wide\n          $cnc_url_1 = \"connect.php?\" wide\n          $cnc_url_2 = \"show.php\" wide \n          $browser_1 = \"\\\\Kometa\\\\User Data\\\\Default\\\\Cookies\" wide \n          $browser_2 = \"\\\\Orbitum\\\\User Data\\\\Default\\\\Cookies\" wide\n          $browser_3 = \"\\\\Amigo\\\\User\\\\User Data\\\\Default\\\\Cookies\" wide\n          $coin_regex_1 = \"[13][a-km-zA-HJ-NP-Z1-9]{25,34}\" wide // Bitcoin\n          $coin_regex_2 = \"0x[a-fA-F0-9]{40}\" wide // Ethereum\n          $coin_regex_3 = \"L[a-zA-Z0-9]{26,33}\" wide // Litecoin\n     condition:\n          uint16(0) == 0x5A4D and (any of ($ua,$sig,$sched_task,$exe)) and (any\nof ($cnc_url_*)) and (any of ($browser_*)) and (any of ($coin_regex_*))\n}\n\n```\nTags\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-19 - An Analysis of L0rdix RAT, Panel and Builder.pdf"
    ],
    "report_names": [
        "2019-07-19 - An Analysis of L0rdix RAT, Panel and Builder.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535535,
    "ts_updated_at": 1743041746,
    "ts_creation_date": 1653705824,
    "ts_modification_date": 1653705824,
    "files": {
        "pdf": "https://archive.orkl.eu/84676de3dede8df5094f54ce7ee3e093d516bdfb.pdf",
        "text": "https://archive.orkl.eu/84676de3dede8df5094f54ce7ee3e093d516bdfb.txt",
        "img": "https://archive.orkl.eu/84676de3dede8df5094f54ce7ee3e093d516bdfb.jpg"
    }
}