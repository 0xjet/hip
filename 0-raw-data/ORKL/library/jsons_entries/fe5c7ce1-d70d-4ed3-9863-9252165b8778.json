{
    "id": "fe5c7ce1-d70d-4ed3-9863-9252165b8778",
    "created_at": "2023-01-12T15:07:05.698545Z",
    "updated_at": "2025-03-27T02:05:37.107544Z",
    "deleted_at": null,
    "sha1_hash": "a4f36b06079d954b2b8b9c243460a1bdbd79ed2c",
    "title": "2022-02-25 - Technical Analysis of PartyTicket Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-29T10:49:38Z",
    "file_modification_date": "2022-05-29T10:49:38Z",
    "file_size": 749534,
    "plain_text": "# Technical Analysis of PartyTicket Ransomware\n\n**zscaler.com/blogs/security-research/technical-analysis-partyticket-ransomware**\n\n[Protect your organization from cyberattacks associated with the Russia-Ukraine conflict >](https://www.zscaler.com/russia-ukraine-cyber-resources)\n\nOpen Open Open\n\n## Key Points\n\nPartyTicket is an unsophisticated and poorly designed ransomware family that is likely intended to be a diversion from the Hermetic\nwiper attack\nThe ransomware generates a single AES key that is used to encrypt targeted files in GCM mode\nFiles can be decrypted without having access to the RSA private key because the AES key is generated using a random function that is\ndeterministic\n\n## Technical Analysis\n\n[On 23rd Feb 2022, a new sophisticated malware family known as Hermetic Wiper was discovered that targeted organizations in the Ukraine](https://www.zscaler.com/blogs/security-research/hermetic-wiper-resurgence-targeted-attacks-ukraine)\nwith an objective of destroying data and causing business disruption. Hermetic Wiper appears to have been used in conjunction with another\n[malware family that disguises itself as ransomware. This secondary malware known as PartyTicket has the SHA256](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia)\n4dc13bb83a16d4ff9865a51b3e4d24112327c526c1392e14d56f20d6f4eaf382 and was written using the Go programming language. The first\nPartyTicket sample that was submitted to a public malware repository on 2022-02-23 22:29:59 UTC.\n\nPartyTicket is quite distinct from typical ransomware families in that the design and implementation looks rushed and unsophisticated. For\nexample, PartyTicket does not terminate processes such as databases and other business applications prior to encryption. Therefore, the\nnumber of potential files that can be encrypted is limited since many applications may have open file handles. In addition, the malware\ngenerates a 32 character alphanumeric key using the Go programming language’s random function, which is deterministic. Therefore, the\nAES encryption key can be recovered and used to decrypt files. PartyTicket also stands out with numerous references that mock U.S.\nPresident Joe Biden as shown in Figure 1.\n\nFigure 1. PartyTicket code references mocking U.S. President Joe Biden\n\n\n-----\n\ne a a e ta es a s g e co a d e a gu e t, c s t e e a e to e c ypt t e a a e s au c ed t out a y a gu e ts, t\nbuilds a list of files to encrypt. For every file in this list, the malware creates a new copy of itself using a name generated by calling the UUID\n[Go library function, which is based on the current timestamp and system’s MAC address.](https://pkg.go.dev/github.com/satori/go.uuid#NewV1)\n\nThe new PartyTicket copy is then executed passing a filename to encrypt. This design choice is very odd because it slows the system down\nsignificantly, because a new process is created to encrypt every file. In addition, the numerous copies of the malware that are created fill up\ndisk space, since the malware binary is larger than 3MB. Figure 2 shows an example of the numerous PartyTicket executables that were\ncreated during file encryption.\n\nFigure 2. Copies of PartyTicket executables during file encryption\n\nPartyTicket enumerates all files that have the extensions shown in Table 1.\n\n.docx .doc .dot .odt\n\n.pdf .xls .xlsx .rtf\n\n.ppt .pptx .one .xps\n\n.pub .vsd .txt .jpg\n\n.jpeg .bmp .ico .png\n\n.gif .sql .xml .pgsql\n\n.zip .rar .exe .msi\n\n.vdi .ova .avi .dip\n\n.epub .iso .sfx inc\n\n.contact .url .mp3 .wmv\n\n\n-----\n\n.wma .wtv .cab .acl\n\n.cfg .chm .crt .css\n\n.dat .dll .html .htm\n\nTable 1. Extensions targeted by PartyTicket\n\nFiles that are located in the Windows and Program Files folders are skipped. Before file encryption, the targeted file is renamed with the\n[extension .[[email protected]].encryptedJB as shown in Figure 3.](https://www.zscaler.com/cdn-cgi/l/email-protection#61170e150453515355070e130b032111130e150e0f0c00080d4f020e0c)\n\nFigure 3. Example file extension encrypted by PartyTicket\n\nThe malware embeds a hardcoded 2,048-bit RSA key that is Base64 encoded. The modulus and exponent after the string has been Base64\ndecoded is the following:\n\n{\"N\":2571775053856444587588377045031501015770059708750733490740350044391307370272093993182460827098002020656601753875\n\nPartyTicket uses this RSA public key to encrypt the AES key that is used for file encryption. Files are encrypted with AES in GCM mode using\n[a 32-byte alphanumeric string that is created using the Go function math.rand.Int(), which is deterministic and therefore not cryptographically](https://pkg.go.dev/math/rand#Intn)\nsecure. The encrypted file format consists of the first 12 bytes used as the AES-GCM nonce, followed by the AES encrypted data, a 16byte AES-GCM authentication tag, the RSA encrypted AES key, and finally appended with the string marker\n_ZVL2KH87ORH3OB1J1PO2SBHWJSNFSB4A._\n\nAfter each file is encrypted, the corresponding temporary copy of the ransomware is then deleted.\n\nThe ransom note is written to the user’s desktop using the filename read_me.html. An example ransom note, when rendered in a web\nbrowser, is shown in Figure 4.\n\n\n-----\n\nFigure 4. Example PartyTicket ransom note\n\nThe special ID value is generated by calling the Go UUID function and does not serve any purpose.\n\n## Zscaler coverage\n\nWe have ensured coverage for the payloads seen in these attacks via advanced threat signatures as well as our advanced cloud sandbox.\n\n## Advanced Threat Protection\n\nWin32.Trojan.HermeticWiper\n\n## Advanced Cloud Sandbox\n\nWin32.Trojan.HermeticWiper\n\nFigure 5 below shows the sandbox detection report for PartyTicket.\n\n\n-----\n\nFigure 5. Zscaler Cloud Sandbox Report - PartyTicket\n\n## Stay up to date with the latest digital transformation tips and news.\n\n[By submitting the form, you are agreeing to our privacy policy.](https://www.zscaler.com/privacy-compliance/privacy-policy)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-25 - Technical Analysis of PartyTicket Ransomware.pdf"
    ],
    "report_names": [
        "2022-02-25 - Technical Analysis of PartyTicket Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536025,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653821378,
    "ts_modification_date": 1653821378,
    "files": {
        "pdf": "https://archive.orkl.eu/a4f36b06079d954b2b8b9c243460a1bdbd79ed2c.pdf",
        "text": "https://archive.orkl.eu/a4f36b06079d954b2b8b9c243460a1bdbd79ed2c.txt",
        "img": "https://archive.orkl.eu/a4f36b06079d954b2b8b9c243460a1bdbd79ed2c.jpg"
    }
}