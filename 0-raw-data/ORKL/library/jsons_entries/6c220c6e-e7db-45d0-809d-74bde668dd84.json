{
    "id": "6c220c6e-e7db-45d0-809d-74bde668dd84",
    "created_at": "2022-10-25T16:48:23.45728Z",
    "updated_at": "2025-03-27T02:09:24.556881Z",
    "deleted_at": null,
    "sha1_hash": "eb667800eb7db66cf54f35d6a7378f9ee52ad6d3",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-03-22T14:04:58Z",
    "file_modification_date": "2018-03-22T14:04:58Z",
    "file_size": 622605,
    "plain_text": "# Tracking Ransomware End-to-end\n\n## Danny Yuxing Huang[1], Maxwell Matthaios Aliapoulios[2], Vector Guo Li[3]\n Luca Invernizzi[4], Kylie McRoberts[4], Elie Bursztein[4], Jonathan Levin[5]\n Kirill Levchenko[3], Alex C. Snoeren[3], Damon McCoy[2]\n\n1 Princeton University 2 New York University 3 University of California, San Diego 4 Google Inc 5 Chainalysis\n\n\n**_Abstract—Ransomware is a type of malware that encrypts the_**\n**files of infected hosts and demands payment, often in a crypto-**\n**currency such as Bitcoin. In this paper, we create a measurement**\n**framework that we use to perform a large-scale, two-year,**\n**end-to-end measurement of ransomware payments, victims, and**\n**operators. By combining an array of data sources, including**\n**ransomware binaries, seed ransom payments, victim telemetry**\n**from infections, and a large database of Bitcoin addresses**\n**annotated with their owners, we sketch the outlines of this**\n**burgeoning ecosystem and associated third-party infrastructure.**\n**In particular, we trace the financial transactions, from the**\n**moment victims acquire bitcoins, to when ransomware operators**\n**cash them out. We find that many ransomware operators cashed**\n**out using BTC-e, a now-defunct Bitcoin exchange. In total we**\n**are able to track over $16 million in likely ransom payments**\n**made by 19,750 potential victims during a two-year period. While**\n**our study focuses on ransomware, our methods are potentially**\n**applicable to other cybercriminal operations that have similarly**\n**adopted Bitcoin as their payment channel.**\n\nI. INTRODUCTION\n\n_Ransomware is a type of malware that encrypts a victim’s_\ndocuments and media, and then urges payment for their\ndecryption. In its beginnings, ransoms were demanded via\na collection of online cash-equivalent payment instruments,\nsuch as MoneyPak, Paysafecard, or UKash [1]. From the\nransomware operators’ perspective, these instruments have\nundesirable properties: their limited geographic availability\nshrinks the paying-victim pool, and they are run by companies\nsubject to the local law, which might compel them into\nreversing transactions or tracking the ransom recipients.\nTo overcome these drawbacks, the operators of many major\nransomware families have adopted Bitcoin. This cryptocurrency poses challenges to law enforcement, as it is decentralized, largely unregulated, and all parties in a transaction\nare hidden behind pseudo-anonymous identities. Moreover,\nall transactions are irreversible, and it is widely available for\nvictims to purchase. Due to these properties, Bitcoin has also\ngained adoption as a payment method for other illicit activities,\nsuch as drug markets [2], online sex ads [3], and DDoS-forhire services [4].\nHowever, Bitcoin has a property that is undesirable to cybercriminals: all transactions are public by design. This enables\nresearchers, through transaction clustering and tracing [5],\n\n[6], [7], to glean at the financial inner workings of entire\ncybercriminal operations. Before Bitcoin, these insights had\nto be only partial and infrequent, as they hinged on sporadic\ndata leaks [8], [9], [10].\n\n\nIn this paper, we perform a large-scale, two-year measurement study of ransomware payments, victims, and operators.\nWhile prior studies have estimated the revenue for a single\nransomware operation [6] or reverse engineered the technical\ninner works of particular ransomware binaries [11], [12], our\nstudy is the first to perform an end-to-end analysis of a large\nportion of the ransomware ecosystem, including its revenue,\naffiliate schemes, and infrastructure.\nTo do so, we combine multiple data sources, including\nlabeled ransomware binaries, victims’ ransom payments, victim telemetry (collected through an IP sinkhole we deploy),\nand a large database of Bitcoin addresses annotated with\ntheir owners (provided by Chainalysis[1]). This wealth of data\nallows us to follow the money trail from the moment a victim\nacquires bitcoins, to when the ransomware operators cash them\nout. In total, we establish a lower-bound estimate on ransom\npayments’ volume of $16 million USD, made by 19,750\npotential victims over two years.\nThe bitcoin-trail allows us to determine the likely geographic locations of paying victims, which we corroborated\nwith the collected telemetry of a large ransomware campaign.\nWe find that South Koreans likely paid over $2.5 million USD\nin ransoms to the Cerber ransomware family, which is 34%\nof the total Cerber’s revenue we tracked. Our measurements\nindicate that South Koreans were also likely disproportionately\nimpacted by other ransomware campaigns. This calls for further studies on why this region is disproportionately impacted,\nand what can be done to better protect it.\nWe also find that ransomware operators strongly preferred to\ncash out their bitcoins at BTC-e, a Russian Bitcoin exchange\nthat converted bitcoins to fiat currencies. This exchange has\nnow been seized.\nFinally, we describe some unique ethical issues that we\nfaced during our study and limit possible interventions against\nransomware campaigns. For example, any disruption of the\npayment infrastructure can result in both the victim’s inability\nto access their data and an increased financial burden, as\nransom amounts increase with time in many families.\nIn summary, our main contributions are as follows. (1)\nWe develop a set of methodologies that enable an end-toend analysis of the ransomware ecosystem. (2) We conduct a\ntwo-year measurement study of the ecosystem, conservatively\n\n1Chainalysis is a proprietary online tool that facilitates the tracking of\nBitcoin transactions by annotating Bitcoin addresses with potential owners.\n[See https://www.chainalysis.com/.](https://www.chainalysis.com/)\n\n\n-----\n\nestimating that ransomware operators have collected over $16\nmillion USD in ransoms from 19,750 potential victims. We\nalso identify that BTC-e, a Russian-operated Bitcoin exchange\n(now seized by US law enforcement) appeared to be a key\ncash out point for ransomware operators. (3) We discuss\npossible intervention points, open challenges in ransomware\nmeasurement, and unique ethical issues specific to ransomware\nresearch.\n\nII. BACKGROUND\n\nIn this section, we describe the timeline of the archetypal\nransomware infection, from malware delivery to ransom cash\nout.\n\n**Delivery:** Ransomware is distributed through a variety of\nvectors, much like generic malware. For instance, Cerber\nand Locky were also spread via malicious email attachments [13], [14], while Karma partly relied on pay-per-install\nnetworks [15]. More recent families, such as WannaCry and\nNotPetya, exploited known vulnerabilities in network services\nto propagate within a LAN [16].\n\n**Execution:** Once a ransomware binary executes on a host,\nit silently encrypts a set of files files deemed valuable to the\nuser, such as documents and images. When the encryption\ncompletes, the ransomware displays a ransom note on the\nhost’s screen, informing the user that those files are held for\nransom, payable in bitcoins.\n\n**Payment:** A ransom note usually includes a guide on how\nto purchase bitcoins from exchanges, online services that\nfacilitate the conversion between Bitcoin and fiat currencies.\nExchanges come in different flavors: they can operate globally\n(e.g., Paxful), or regionally (e.g., Coinbase, which only caters\nto a US clientele). Most exchanges are centralized, except from\na handful that facilitate direct transactions between buyers and\nsellers (e.g., LocalBitcoin).\nFurthermore, ransom notes include either ransom addresses,\nBitcoin wallets victims are expected to pay into, or a link to\na payment website which displays this address. Many ransomware families (e.g., Locky and Cerber) generate a unique\nransom address for each victim to automate the identification\nof paying victims, whereas others reuse addresses for multiple\nvictims (e.g., WannaCry and CryptoDefense). When addresses\nare reused, ransomware operators cannot discriminate paying\nvictims, so they either require the victim to send them the\npayment transaction hash (a verification mechanism susceptible to abuse, as all transactions are public), or they simply do\nnot decrypt the victim’s files (e.g., WannaCry [17]). Ransom\namounts are typically fixed, denominated in US dollars (e.g,\n$1,000 for some Cerber strains [11]) or Bitcoins (e.g., 0.5\nBTC for some Locky strains [18]). A notable exception is\nSpora [19], where the estimated value of each victim’s files is\nfactored into the ransom.\n\n**Decryption:** Once the payment has been confirmed, ransomware either automatically decrypts the files held for ran\n\nsom, or it instructs the victim to download and execute a\ndecryption binary.\n\n**Liquidation: To cash out their proceeds, ransomware opera-**\ntors often deposit their bitcoins into a wallet controlled by an\nexchange to trade them for fiat currencies. As law enforcement\nagencies might compel exchanges into disclosing the identity\nof their clients, some operators first deposit their bitcoins into\n_mixers, services that obfuscate bitcoin trails by intermixing_\nbitcoin flows from multiple sources.\n\nIII. DISCOVERING RANSOM DEPOSIT ADDRESSES\n\nThe Bitcoin blockchain is a public sequence of timestamped transactions that involve wallet addresses, which are\nbasically pseudo-anonymous identities. To discern transactions\nattributable to ransom campaigns, we design a methodology\nto trace known-victim payments (this section), cluster them\nwith previously-unknown victims (Sections IV-A, and IV-B),\nestimate potentially missing payments (Section IV-E), filter\ntransactions to discard the ones that are likely not attributable\nto ransom payments (Section IV-F). We show results of these\nmethods in Section V, where we estimate the revenue of\ndifferent ransomware families and characterize their financial\nactivities.\nOur payment tracking pipeline begins with methods to\ndiscover seed addresses — ransom addresses associated with\na small number of known ransomware victims. Two sources\nprovide us with a list of seed ransom addresses: real victims\nwho reported ransomware infection [7], [6]; and our method\nof generating synthetic victims, where we extract ransom\naddresses by executing the ransomware binaries in a controlled\nenvironment — effectively becoming the infection “victims”\nourselves.\n\n_A. Real Victims_\n\nTo find real victims, we automatically scrape reports of\nransomware infection in public forums, such as Bleeping Computer. These reports typically contain screenshots or excerpts\nof ransom notes, from which we extract the seed ransom\naddresses via text or image analysis. In addition, we obtain\na list of seed ransom addresses from proprietary sources such\nas ID Ransomware, which maintains a record of ransomware\nvictims and the associated ransom addresses [20].\n\n_B. Synthetic Victims_\n\nHowever, infection reports from real, paying victims are\nhard to come by. For example, we were initially unable to find\nany real victim infection reports which contained the ransom\naddresses for several families, such as Cerber and Locky.[2]\n\nTo extend our coverage, we complement real victims with\nsynthetic victims.\nUsing a technique that we will discuss in Section IV-E, we\nfirst obtain the binaries of Cerber and Locky from VirusTo\n2We selected Cerber and Locky based on media reports indicating that they\nwere actively infecting large numbers of victims [13], [14].\n\n\n-----\n\ntal.[3] We execute a subset of the ransomware binaries from\neach family on four independent platforms: VmRay [21],\na hypervisor-based commercial sandbox; a VMware-based\ncommercial sandbox; Cuckoo, an open-source sandbox that\nruns on VirtualBox virtual machines (VMs); and Windows XP\non a bare-metal machine. We opt for these diverse platforms\nto mitigate potential anti-VM and anti-sandbox techniques in\nsome variants of Cerber and Locky.\nWe execute each malware sample for up to twenty minutes,\nand then we collect the memory dump (in the case of VM executions), created files, and screenshots, from which to extract\nBitcoin wallet addresses. We do not have any false positives,\nsince Bitcoin wallet addresses have 32 bits of error-checking\ncode. We also extract the visible text from screenshots through\na commercial OCR provider [22], and process the output\nthrough the same extraction pipeline in order to obtain the\nransom addresses.\n\n_C. Summary of Results_\n\nUsing the method in Section III-A, we have collected\n25 seed ransom addresses from actual victims across 8\nransomware families: CoinVault, CryptXXX, CryptoDefense,\nCryptoLocker, CryptoWall, Dharma, Spora, and WannaCry.\nIn addition, we apply the method in Section III-B and\nobtain 32 seed ransom addresses (8 of which from baremetal infections) for synthetic Cerber infections, and 28 seed\nransom addresses (3 of which from bare-metal infections) for\nsynthetic Locky infections. As we will discuss in Section IV-B,\nanyone of Cerber’s addresses was sufficient to discover the\nadditional addresses that Cerber uses; likewise, anyone of\nLocky’s addresses was sufficient.\n\nIV. DISCOVERING ADDITIONAL RANSOM ADDRESSES\n\nThe seed ransom addresses obtained in Section III are\nassociated with a small number of known victims, both real\nand synthetic. For families such as WannaCry, existing reports\nsuggest that victims from multiple infections are shown the\nsame ransom addresses [17]. Thus, the seed addresses themselves are sufficient for us to identify both known and potential\nvictims,[4] and we can proceed with estimating the ransomware\nrevenue.\nIn contrast, families such as Locky, Cerber, and Spora generate unique ransom addresses for every infection, a fact that is\ncorroborated by prior research [19], vetted proprietary sources,\nand by our binary executions (Section III-B). On their own,\nthese seed ransom addresses do not reveal any information\nabout other potential victims. Any bitcoins received by each\nseed ransom address is likely associated with only a single\nvictim that was provided with that seed ransom address.\n\n3We also obtained binaries of the Sage ransomware, but as we will\ndiscussion in Section IV-B, micropayments to Sage’s ransom addresses did not\nresult in subsequent bitcoin transfers, so we excluded Sage from our analysis.\n4We refer to any victims whom we do not know a priori as potential or\n_likely victims (as opposed to real or known victims that we know from ground_\ntruth). Absent ground truth, we are uncertain that they are actual victims of\nransomware infections.\n\n\nSuch unique ransom addresses motivate the need to expand\nour analysis beyond the seed addresses and identify additional\naddresses that are likely to be associated with ransomware\nactivities. In this section, we describe a new method that is\nbased on clustering and micropayments to discover additional\nransom addresses.\n\n_A. Clustering by Co-spending_\n\nEven though we have a relatively small number of seed\nransom addresses, we can infer payment activities of other\npotential victims by discovering wallet addresses that co-spent\nwith the seed addresses. Two wallet addresses are known to be\nco-spent if they are used as the input to the same transaction.\nIn non-CoinJoin transactions [23], we assume that an entity\nthat creates a transaction has access to the private keys of\nall the input wallet addresses in the transaction [24], and\nthat the entity is in control of all the input addresses. We\ncall this assumption the co-spending heuristic, which we use\nto recursively look for addresses that co-spent with the seed\nransom addresses, and also addresses that co-spent with the\nseed ransom addresses’ co-spending addresses [7], [6], [5].\nIn this way, we construct a cluster of wallet addresses.\nEvery address in the cluster, which we shall refer to as\n_cluster address, is presumably under the control of the same_\nransomware family. These cluster addresses include the seed\nransom addresses; ransom addresses to which likely victims\nmade ransom payments (which we cannot validate as coming\nfrom actual victims absent ground-truth); and wallet addresses\nthat a ransomware family uses for internal book-keeping (e.g.,\naggregating ransom payments). For a given family, if we have\nmultiple seed ransom addresses, it is possible that each of them\nmay be in a disjoint cluster (likely because no two addresses\nfrom different clusters were ever co-spent). Since we know\nthat the seed ransom addresses all belong to the same family,\nwe manually merge the disjoint clusters into a single cluster,\nwhich we subsequently refer to as the ransomware’s cluster.\nWe stress that the clustering technique does not apply\nto CoinJoin transactions [23], which violate the co-spending\nheuristic. The sender of a CoinJoin transaction does not have\naccess to the private keys of the input wallet addresses. Effectively, two addresses that are co-spent in the same CoinJoin\ntransaction cannot be clustered together. To detect CoinJoin\ntransactions in our clustering, we apply a set of heuristics [25]\nusing BlockSci [26]. We find no CoinJoin transactions in our\nclusters, although there is still a possibility that the heuristics\nmight have failed to detect some CoinJoin transactions. We\nwill mitigate this problem in Section IV-F by proposing and\nevaluating filtering techniques.\n\n_B. Augmenting Clustering with Micropayments_\n\nThe construction of clusters uses the co-spending heuristic,\nwhich requires that bitcoins are spent from the seed addresses.\nHowever, for synthetic victims whose ransom addresses are\nunique to individual victims (e.g., Cerber and Locky), the\naddresses are not associated with any Bitcoin payments. As\nsuch, there is no co-spending.\n\n\n-----\n\nFig. 1: A schematic illustration for transactions involving the\nLocky and Cerber clusters.\n\nIn order to observe co-spending, we develop a novel method\n— making 0.001 bitcoins worth of micropayments to the ransom addresses of synthetic victims and observe the subsequent\nflow of the bitcoins. We make micropayments only to seed\naddresses of Locky and Cerber, because at the time we started\nthe analysis, we were unaware of any real victims of either\nransomware families.\n\n**Locky:** We generated 28 synthetic victims. We made a\nmicropayment to each of the 28 seed ransom addresses.[5]\n\nWhat appears to be the ransomware operator later co-spent\nthe ransom addresses with other wallet addresses, presumably\nin an attempt to aggregate ransom payments. All these 28\nransom addresses lead to the construction of a single Locky\ncluster with 7,093 addresses. In fact, if we had only made\none of the 28 micropayments, we would have discovered the\nsame cluster. In addition to the synthetic victims, we also\ndiscover a ransom address that belongs to a real Locky victim\nwho paid 0.5 bitcoins of ransom, according to data we obtain\nfrom proprietary sources. This ransom address belongs to the\nsame Locky cluster above, which validates our micropayment\napproach. We show an illustration of Locky’s transaction graph\nin Figure 1(i), where we discover Addresses 3 and 4 in\nLocky’s cluster by making micropayments to Addresses 1 and\n2.\n\n**Cerber: We generated 32 synthetic victims. Again, we made**\na micropayment to each of the 32 ransom addresses. In each\ncase, after the ransom address received our micropayment,\nwhat appears to be the ransomware operator moved our micropayment from the ransom address into a unique aggregation\naddress. The ransom address was subsequently not used in\nany transactions. Also, it is never co-spent with any other\nwallet addresses. The aggregation address is used in exactly\ntwo transactions: (i) first receiving the micropayment from the\nransom address, and (ii) sending the micropayment somewhere\nelse by co-spending with other addresses, presumably to\naggregate the ransom payments collected. We cluster the aggregation address to form Cerber’s cluster. Similar to Locky’s\n\n5The timings of our micropayments, both for Locky and Cerber, do not\nfollow any fixed schedule.\n\n\nTABLE I: Ransomware clusters.\n\n_Family_ _Cluster ID_ _Tmin_ _Tmax_ _Naddr_ _Nseed_\n\nCerber 1 2016-02-25 2017-08-31 8,526 32S\nCoinVault 1 2012-11-03 2017-07-10 1,404 1R\nCryptXXX 1 2016-05-11 2016-10-06 1,742 4R\nCryptoDefense 1 2014-03-18 2014-08-15 1 1R[∗]\n2 2014-02-28 2014-08-15 1 1R[∗]\nCryptoLocker 1 2013-09-07 2017-07-10 968 1R\n2 2016-03-07 2016-10-06 3,489 1R\nCryptoWall 1 2015-11-24 2016-03-08 216 1R\n2 2014-05-06 2014-09-13 10 2R\n3 2015-01-14 2015-04-30 101 1R\n4 2015-11-03 2015-12-04 42 1R\n5 2014-04-29 2014-10-09 7 1R\n6 2014-05-25 2014-08-05 1 1R\nDharma 1 2016-05-13 2017-06-29 274 1R\n2 2017-01-23 2017-02-20 4 1R\nLocky 1 2016-01-14 2017-06-02 7,093 1R 28S\nSpora 1 2017-01-05 2017-08-26 2,126 1R\n2 2017-01-18 2017-03-01 24 1R\nWannaCry 1 2017-05-12 2017-07-24 1 1R[∗]\n2 2017-03-31 2017-07-03 3 2R[∗]\n3 2017-05-12 2017-06-20 1 1R[∗]\n4 2017-05-12 2017-08-09 1 1R[∗]\n\ncase, if we had only made any one of the 32 micropayments to\nCerber, we would also have arrived at the same Cerber cluster.\nAs the ransom address and the corresponding aggregation\naddress are never co-spent for each of the 32 micropayments,\nwe cannot use the co-spending heuristic to cluster both types\naddresses. However, for each of our synthetic victims, the\nransom address and the aggregation address were used exclusively to receive and send ransom payments. It is reasonable\nto assume that the ransomware operator is in control of both\naddresses. As such, we decide to expand the original cluster to\nalso include the ransom addresses. We show an illustration of\nCerber’s transaction graph in Figure 1(ii), where aggregation\nAddresses 8 and 9 are clustered with Addresses 10 and 11\n(i.e., original cluster). Since Addresses 5 and 6 appear to be\nexclusively used as an intermediary to receive and send ransom\npayments to the aggregation addresses, they are potentially\nunder Cerber’s control. As a result, we expand the cluster to\ninclude both addresses. In the rest of the paper, we always use\nCerber’s expanded cluster for analysis.\n\n_C. Clusters Identified_\n\nUsing the seed ransom addresses that we obtained earlier,\nwe construct clusters of wallet addresses for the 8 families\nin Section III-A and the 2 families in Section III-B. We\npresent the result in Table I, where each row corresponds\nto a single cluster that we construct from one or multiple\nseed ransom addresses. We show the first date a cluster first\nreceived bitcoins as Tmin and the last date as Tmax, according\nto our observation on August 31, 2017. The number of seed\nransom addresses is shown in the Nseed column; “R” denotes\naddresses from real victims, and “S” denotes synthetic victims.\nFor example, Cluster 1 of Locky is constructed from one\nransom address from a real victim and 28 ransom addresses\nfrom synthetic victims. By contrast, the two seed ransom\naddresses from CryptoLocker victims each belong to Clusters\n\n\n-----\n\nTABLE II: Ransomware binaries in VirusTotal.\n\n_Family_ _Seed_ _Expansion_ _Total_\n\nCerber 77,131 119,508 196,639\nCryptoLocker 46,645 4,581 51,226\nCryptoDefense 6,682 17,247 23,929\nWannaCry 9,230 0 9,230\nLocky 6,115 9 6,124\nCryptowall 51 4,344 4,395\nCryptXXX 802 81 883\nSpora 1,154 587 1,741\nCoinVault 22 0 22\nDharma 5 0 5\n\nTotal 147,837 146,357 294,194\n\n1 and 2 respectively. We manually merge both clusters and\nconstruct a single CryptoLocker cluster for later analysis.\nThe size of each cluster, in terms of the number of constituent addresses is shown in the Naddr column. For some\nfamilies, such as Locky and Cerber (where we know each\nvictim is assigned a unique ransom address), a small number of\nseed ransom addresses leads to the construction of clusters of\nthousands of addresses. For other families, each seed ransom\naddress belongs to a cluster of size one. Examples include\nWannaCry and CryptoDefense, in which the same ransom\naddresses are known to be reused across victims and never cospent with any other addresses. These reused ransom addresses\nare annotated with asterisks (*) in the table. As expected,\nfamilies that generate individual addresses for each victim,\nsuch as Locky and Cerber, result in a larger number of\nadditional addresses being discovered by our clustering than\nfamilies that reused ransom addresses.\n\n_D. Limitations of Micropayments and Co-spending Heuristics_\n\nNot all micropayments resulted in subsequent bitcoin movements. For the Sage ransomware (which is not included in\nthis study), we discovered two ransom addresses that real\nvictims reported, but to which they did not make ransom\npayments. Similar to the case with synthetic victim, unpaid\nransom addresses, even from real victims, cannot help us\nfind the ransomware’s cluster, because they have not been\nco-spent yet. To this end, we made micropayments to both\nof the Sage ransom addresses. However, the bitcoins have\nsince remained in the addresses without being transferred to\nother wallet addresses. As a result, we are unable to find\nSage’s cluster. In general, ransomware operators may ignore\nmicropayments, especially when the payment amount is below\nsome minimum threshold. In addition, micropayments may\neven cause suspicion to the operators, although in our case\nCerber and Locky continued to process our micropayments (as\nwell as potential victim payments) throughout our analysis.\nFurthermore, regardless of whether real victims made payments or we made micropayments, our clustering technique\nonly discovers addresses that co-spent with the seed ransom\naddresses. It is possible that a ransomware operator may decide\nto switch to a completely different wallet cluster after our\nknown victims, whether real or synthetic, have paid. Our\ntechnique will thus miss the new cluster. Additionally, it is\nalso possible that a ransomware family may operate in the\n\n\naffiliate model [11], where each affiliate may choose to receive\nransom payments in its own cluster that is disjoint from other\naffiliates’ clusters. If the known payments are made to only a\nsubset of the affiliates, our technique will again miss clusters\nof the other affiliates.\n\n_E. Coverage of Clusters_\n\nIt is possible that we may not have discovered all clusters\nof addresses used by a particular ransomware family. For\ninstance, a ransomware operator may have switched to a\ndifferent cluster of wallet addresses, or there exists multiple\noperators for the same family, yet each operator uses a disjoint\ncluster of addresses. To determine if we have potentially\nmissed clusters, we corroborate the timing of payment events\non the blockchain against the timing of two external indicators\nof ransomware activity: relative number of searches according\nto Google Trends [27], and discovery of new binaries on\nVirusTotal [28]. Our assumption is that if, during some period,\nwe discover new binaries for a ransomware family and/or\nobserve relevant Google searches while we do not observing\nany incoming bitcoins into the ransomware’s cluster, then we\nmay have missed payment clusters. To this end, we measure\nthe timing of the following three events:\n\n**Bitcoin inflow:** We compute the total bitcoin amount in\n_inflows to a ransomware cluster per day. An inflow to a_\nransomware cluster is a transaction that sends bitcoins from\naddresses outside the cluster to addresses inside the cluster.\nAn inflow can come from multiple sources: e.g., real victims\nand synthetic victims (both from us and potentially from\nother researchers); or affiliates that pay for ransomware-asa-service [11]. Presumably, the presence of any inflows to the\ncluster implies that the ransomware is actively in operation.\n\n**Google searches: Google Trends can produce an estimate for**\nthe relative number of searches per week for any user-specified\nsearch terms. For each ransomware family, we construct a\nsearch query by concatenating the name of the family along\nwith the term “ransomware” and extract the relative number of\nsearches from Google Trends. We assume that if a ransomware\nfamily is actively causing harm during some period, there\nwould be some number of related searches — for instance,\nwhen victims look for help online.\n\n**Number of binaries on VirusTotal: The discovery of new**\nbinaries for a given ransomware family suggests a likely active\nransomware operation, as new versions of the binary may be\nreleased, or the binary may undergo repacking. However, it\nis difficult to obtain binaries for a given ransomware family\nusing VirusTotal. Even though VirusTotal provides a tag for\neach family, some of the tags are generic (e.g., W32/Ransom)\nand have little indication if a binary is related to a particular\nransomware family.\nTo this end, we label a large dataset of ransomware binaries\nwith its family (e.g., Cerber), its variant (e.g., Cerber’s v2),\nand the date of its first upload to VirusTotal. We can use\nthe dataset as a proxy to establish the timeline in which\neach ransomware family is active, thereby corroborating with\n\n\n-----\n\nCerber\n\nCoinVault\n\nCryptXXX\n\nCryptoDefense\n\nCryptoLocker\n\nCryptoWall\n\nDharma\n\nLocky\n\nSpora\n\nWannaCry\n\n|Col1|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n|Relative number of Google searches|||\n|Binaries seen on VirusTotal Payment from real/synthetic victim|||\n|$0 - $10|||\n|$10 - $100 $100 - $1,000|||\n|$1,000 - $10,000 $10,000 or above|||\n||||\n\n\n2013-01 2013-07 2014-01 2014-07 2015-01 2015-07 2016-01 2016-07 2017-01 2017-07\n\n\nFig. 2: A comparison of bitcoin inflows, binary discovery on VirusTotal, and Google searches for each ransomware family.\n\n\nthe timing of the ransom payments. (This labelled dataset\nalso allows us to download and execute binaries of specific\nransomware families, as we did in Section III.)\n\nTo build our dataset, we first sieve through all malware\nsamples collected by VirusTotal [28] with 38 high-confidence\nYARA rules, which are Perl-based regular expressions often\nused to identify malware samples belonging to a specific\nfamily of malware. These rules have been crafted both by\nus and third-party researchers [29]. We call this our seed\ndataset: a high-confidence low-recall collection of binaries\nbelonging to ransomware families. Using these YARA rules\nwe identified 147,837 unique ransomware samples for ten\nransomware families as shown in Table II.\n\nTo improve our recall and capture additional ransomware\nvariants, we also collect a low-confidence dataset of malware\nthat has been tagged by anti-virus engines as ransomware,\neither by generic tags (e.g., W32/Ransom), or family-specific\ntags. We then use the VxClass [30] to compute code-structure\nsimilarity scores based on BinDiff [31] across the binaries\nof the seed and low-confidence datasets. Finally, we leverage\nthese similarity scores to cluster binaries into families. Specifically, we represent the binaries from both datasets as nodes in\na graph, where two nodes are connected through an edge if the\nbinary similarity of the two is high (over a manually-selected\nsimilarity of 0.9). We then identify the connected components\nin the graph, and we discard all clusters that do not contain\nseed binaries. After this expansion, the dataset was expanded\nto over 294k binaries, as shown in Table II. The expansion\nstep was most effective for ransomware families with multiple\nvariants, such as Cerber [32].\n\nWe validate the cluster purity by manually looking at execution screenshots (see Section III), checking that all screenshots\nbelong to the same family. We also note that no generated\ncluster includes seeds from more than one ransomware family.\n\nBy using this labelled dataset, we count the number of new\nransomware binaries as discovered on VirusTotal every day,\nbased on both the seed and the expanded set of binaries.\n\n**Result of comparison:** Using the three events above, we\npresent this comparison in Figure 2, where the x-axis shows\nthe period of our study from November 3, 2012 to August\n\n\n31, 2017.[6] For each ransomware family on the y-axis, we\nshow three types of events. On the gray horizontal line that\ncorresponds to a ransomware family, we denote the daily\nbitcoin inflow with colored bands. As the color temperature\nincreases from “cold” to “warm,” the daily bitcoin values of\ninflows also increase. We have converted the bitcoin amounts\ninto US Dollars based on the USD-Bitcoin exchange rate\non the day the ransomware cluster received the bitcoins.\nOverlaid on top of the colored bands are X’s that denote the\ntime when a seed ransom address received payments from\nreal or synthetic victims. Some of the X’s may appear to\noverlap, as the payments may have occurred within a short\nperiod of time. As the clusters are constructed based on seed\nransom addresses, by definition, the X’s must appear within the\ncolored bands. While the colored bands show inflows, the blue\ncircles immediately above the bands indicate the discovery of\nnew binaries on a given day for a ransomware family. The\nsize of each circle denotes the relative number of binaries\nwithin the family. Finally, above the blue circles are the green\ncircle, the sizes of which denote the relative number of Google\nsearches.\nThis comparison offers a qualitative sanity check for both\nour binary classification and address clustering. To facilitate a\nquantitative comparison, we measure the overlap among three\ntypes of events: a ransomware cluster receiving bitcoins (B),\nVirusTotal detecting new binaries (V), and the ransomware\nfamily appearing in Google Trends (G). Two events overlap\nif both events occur in some 7-day period. We compute the\nconditional probability for these three types of events. Given\na ransomware family, for instance, Pr[V ∥B] is the probability\nof VirusTotal detecting at least a new binary (possibly due\nto polymorphism) in a random week, given that the cluster\nreceived some bitcoins during the same week. We show these\nconditional probabilities in Table III. Cerber, in particular,\nhas the highest probability of overlap among all three events,\nwhereas CryptoWall has one of the lowest.\nA low Pr[V ∥B] value, as is the case for CoinVault, CryptoWall, and Dharma, suggests that we are likely missing\n\n6We do not apply Filter 1 (Section IV-F) to bitcoin inflows in the figure. If a\ngiven period has new binaries and/or Google searches but no bitcoin payments,\nit is difficult to visually distinguish whether we are missing payment clusters,\nor Filter 1 has removed the Bitcoin transactions.\n\n\n-----\n\nTABLE III: Conditional probabilities of a ransomware cluster\nreceiving bitcoins (B), VirusTotal detecting new binaries (V),\nand the ransomware family appearing in Google Trends (G)\nin any 7-day periods. All units are in percentages.\n\n_Family_ Pr[V ∥B] Pr[G∥B] Pr[B∥V ] Pr[B∥G]\n\nCerber 77.2 100.0 95.3 89.8\nCoinVault 4.8 20.0 88.9 60.0\nCryptXXX 56.5 91.3 81.3 44.7\nCryptoDefense 87.5 87.5 4.8 4.8\nCryptoLocker 63.0 100.0 19.0 25.5\nCryptoWall 0.0 95.1 0.0 34.5\nDharma 1.8 51.8 100.0 67.4\nLocky 94.3 98.1 50.5 57.8\nSpora 76.7 100.0 95.8 71.4\nWannaCry 75.0 68.8 92.3 42.3\n\nbinaries. This result is consistent with our binary classification\nresults in Table II where we only discovered 22 CoinVault\nand 5 Dharma binaries (likely due to the lack of YARA\nrules). However, the correlation between Google Trends and\npayments (Pr[G∥B]) is higher for all these families. A low\nPr[B∥V ] or Pr[B∥G] implies that we might be missing clusters; we expect that for a ransomware family, if we discover\nnew binaries and/or observe relevant Google searches, the\nransomware is likely to be receiving ransom payments from\nvictims. It is likely that we are missing most ransom payment\nclusters for CryptoDefense, CryptoLocker, and CryptoWall.\nWe also appear to be missing some payment clusters for most\nof the other families. This is likely caused by our limited\nnumber of seed addresses and the amount of co-spending each\noperator performs. However, it would be difficult to validate\nwhether we are actually missing binaries or payment clusters\nabsent ground-truth.\n\n_F. Filtering Transactions_\n\nAs we alluded to in Section IV-A, an inflow of bitcoins to\na ransomware cluster does not necessarily mean a real victim\nransom payment. It could be, for instance, another researcher\npaying a synthetic victim or a completely non-ransomwarerelated CoinJoin transaction which our CoinJoin heuristics\nhave failed to detect. Our goal is to examine inflows that come\nfrom potentially real victims and estimate the revenue that a\nransomware family generates from ransom payments. To this\nend, we develop a number of inflow filters, which remove\ntransactions from the inflows that are potentially unrelated to\nvictims making ransom payments.\n\n**Filter 1: First, we create Filter 1, which identifies inflows that**\nare consistent with known ransom payment patterns. There\nare two types of known patterns: (i) historically what ransom\namounts are paid by real victims [7], [6]; and (ii) our novel\nmethod of identifying properties of the Bitcoin transaction\ngraph for such historical payments.\nAs an example for Pattern (i), we observe, from screenshots online and executing the ransomware itself, that Locky\ndemanded each victim pay a total ransom of 0.5n bitcoins (for\nsome integer n) [18], and that CryptXXX charged a ransom\nof 1.2 bitcoins, 2.4 bitcoin, $500, or $1,000 per victim [33].\n\n\nTABLE IV: An analysis of bitcoin inflows under different\nfilters. V1 offers a way to estimate the total revenue from\nransom payments for a given family.\n\n_Family_ _V0 (k$)_ _V1 (k$)_ _VV10_ _[(%)]_ _V2 (k$)_ _VV20_ _[(%)]_ _VV30_ _[(%)]_\n\nCerber 7,702 7,678 99.7 3,990 51.8 51.7\nCoinVault 198 20 10.3 18 9.3 1.3\nCryptXXX 1,871 1,841 98.4 858 45.9 45.5\nCryptoDefense 70 69 99.8 28 41.3 41.3\nCryptoLocker 2,048 667 32.6 691 33.8 11.1\nCryptoWall 1,214 244 20.2 529 43.6 9.2\nDharma 1,266 231 18.3 631 49.9 8.1\nLocky 7,825 6,632 84.8 3,032 38.7 33.2\nSpora 827 3 0.5 131 15.9 0.1\nWannaCry 100 100 99.4 36 36.5 36.3\n\nUsing this pattern, if, for an inflow to a ransomware cluster,\nthe total amount of bitcoins or US Dollars sent is consistent\nwith the known ransom amounts above, we assume that the\ninflow is likely to be a ransom payment. The output address in\nthe inflow is likely to be a ransom address; we call the output\naddress a likely ransom address. As an illustration, if Address\n3 in Figure 1(i) receives some increments of 0.5 bitcoins, then\nit is a likely ransom address for Potential Victim 1.\nHowever, certain ransomware families do not have fixed\nransom amounts, so we look for Pattern (ii). This pattern\ndescribes properties in the Bitcoin transaction graph that we\nobserve in real/synthetic victim payments. For instance, any\npayments received by seed ransom addresses are potentially\nvictim payments, especially for ransomware families where a\nsingle ransom address is used for multiple victims; inflows to\nseed ransom addresses therefore satisfy Filter 1. On the other\nhand, some families generate unique ransom addresses for\neach victim. For these families, we analyze how bitcoins move\nafter known victims have paid. Using Cerber as an example,\nwe observe that, after a synthetic victim transfers bitcoins\ninto his ransom address, all the bitcoins are emptied into a\nunique aggregation address, which subsequently transfers all\nthe bitcoins by co-spending with other wallet addresses.\nWe use Figure 1(ii) to illustrate how we use Pattern (ii) to\nidentify a potential Cerber ransom address. Suppose Address\n10, an address in Cerber’s cluster, is used in two transactions:\nonce receiving all bitcoins from some Address 7 (not in\nCerber’s cluster yet), before subsequently sending the bitcoins\naway by co-spending with other addresses. Suppose, further,\nthat Address 7 is never co-spent, and that it sends all the\nreceived bitcoins into Address 10. Both of these observations\nare consistent with how bitcoins flow for all our synthetic\nvictim payments. As such, we say that Address 10 is a likely\naggregation address, and Address 7 is a likely ransom address\nto which some Potential Victim 2 made a ransom payment.\nWe include Address 7 in the expanded cluster of Cerber. In\ngeneral, our method of filtering by Pattern (ii) is not restricted\nto Cerber and can be applied to other ransomware families that\nhave special properties in their Bitcoin transaction graphs.\nWe show the results of filtering in Table IV. For each\nfamily’s cluster, we first apply Filter 0 as a baseline, which\ndoes not filter any inflows. Bitcoin amounts sent by any\nFilter 0 inflows are denoted as V0, converted into US Dollars.\n\n\n-----\n\n2,000,000\n\n1,750,000\n\n1,500,000\n\n1,250,000\n\n1,000,000\n\n750,000\n\n500,000\n\n250,000\n\n\nCryptXXX\n\nCerber\n\n\nWannaCry\n\n\nLocky\n\nCryptoDefense\n\n\n0\n\n\n0% 10% 20% 30% 40% 50% 60%\nPercent of V1 for a given family\n\nFig. 4: Exchanges that contributed to V1.\n\n|Family Cerber CryptXXX CryptoDefense Locky WannaCry|Col2|Col3|Col4|\n|---|---|---|---|\n|||||\n\n|Col1|BTC-e.com Coinbase.com Misc|\n|---|---|\n||BTC-e.com C.oinbase.com Misc Bithumb.com K.orbit.co.kr Unknown Coin.mx L.ocalBitcoins.com|\n|||\n\n\nMonth\n\n\nFig. 3: Monthly V1 values for each ransomware family.\n\nWe then apply Filter 1, and the resultant amounts of bitcoin\ninflows are shown in the V1 column. Since we are summing\nup inflow amounts that conform to known payment patterns,\n_V1 offers an estimate on each ransomware’s revenue from_\nransom payments. We stress that V1 is an underestimate; per\nour discussion in Section IV-E, an unknown number of wallet\naddresses are likely to be missing from our clusters.\nTo show how much of the original inflows satisfies Filter\n1, we calculate the ratio, _[V]V0[1]_ [. A larger ratio suggests a higher]\n\ncoverage and that we can account for a higher portion of values\nin the inflows as potential ransom revenue; for instance, 99.7%\nof Cerber’s inflow values potentially consist of victim payments. In contrast, this ratio is low for certain families, likely\nbecause we are unable to identify all known payment amounts\nor Bitcoin graph properties. Spora victims, for example, can\nchoose to pay for one or multiple ransom “packages”. The\nransom amounts are not fixed for each victim. As expected,\n_V1 for Spora only includes payments by the real victims we_\nfound in public sources, rather than by potential victims that\nwe do not know about.\n\n**Filter 2: Another signal for an inflow to be a likely ransom**\npayment is that the inflow sends bitcoins from an exchange’s\ncluster to a ransomware cluster. As described in Section II,\na ransom note typically suggests that the victim purchases\nbitcoins from exchanges, presumably because a random victim\nis unlikely to already possess bitcoins himself. Thus, we\nassume that a victim is likely to first acquire bitcoins from an\nexchange, before sending the bitcoins to his ransom address.\nTo this end, we develop Filter 2, which includes an inflow\ntransaction only if it sends bitcoins from a wallet address(es)\nfrom a known exchange’s cluster. We check if a wallet\naddress belongs to an exchange, and what exchange, using\nChainalysis’ API.\nChainalysis is a proprietary online service that links clusters of wallet addresses to the likely real-world identities. It\nregularly transacts with known Bitcoin-related services, such\nas exchanges, to discover and cluster wallet addresses used\nby these services [5], while excluding CoinJoin transactions\nusing a proprietary heuristics-based algorithm.\nWe show the result as V2 in the table. The ratio of _VV20_\nsuggests how much of a ransomware family’s inflows is sent\nfrom exchange clusters. For 6 of the 10 families, this ratio is\nlower than _VV10_ [; for the remaining 4 families,] _VV20_ _[>]_ _VV01_ [, but]\n\n\n_V2_\n_V0_ _[<][ 50%][. The relatively low][ V][2][ values are likely because]_\nChainalysis does not have perfect coverage and is unable to\nidentify many of the exchange clusters.\nTo show the overlap between Filters 1 and 2, we apply\nboth filters to the inflows and compute V3. However, the recall\nof V3 is likely too low to meaningfully estimate ransomware\nrevenue.\nFor the rest of the paper, we apply only Filter 1 due to the\nlikelihood that Filter 2 has poor recall because of incomplete\ncoverage of exchange addresses by Chainalysis. Moreover, the\npaper will only consider Cerber, CryptXXX, CryptoDefense,\nLocky, and WannaCry, as we can account for most of their\ninflows as potential ransom payment, i.e. _VV01_ _[>][ 50%][. We]_\nleave as future work creating additional tracing and filtering\nalgorithms that can improve our accounting for the other\nransomware families.\n\nV. PAYMENT ANALYSIS\n\n\nBased on the methods we created in the prior sections,\nwe are able to estimate each ransomware family’s revenue\nin Section V-A and characterize potential victim payments in\nSections V-B through V-D. Finally, we measure the potential\ncash-out behaviors in Section V-E.\n\n_A. Estimating Revenue_\n\n\nThe V1 column in Table IV shows the total revenue potentially generated from ransom payments. To visualize the likely\nrevenue over time, we plot a stacked bar graph, Figure 3. In\ntotal, we are able to trace $16,322,006 US Dollars in 19,750\nlikely victim ransom payments for 5 ransomware families over\n22 months. This is probably a conservative estimate of total\nvictim ransom payments due to our incomplete coverage.\n\n_B. Payment Mechanisms_\n\n\nSome of the victims likely purchased bitcoins from exchanges before paying the ransom. We would like to determine\nwhat these exchanges are and how much of the ransom came\nfrom each exchange. For every inflow that satisfies Filter 1,\nwe identify the input wallet addresses and construct a cluster\nusing the co-spending heuristic; we call this cluster the source\n_cluster. We use Chainalysis’ API to determine the likely real-_\nworld identity of the source cluster; it could be an exchange,\na non-exchange, or “Unknown,” in which case Chainalysis\nhas no information regarding the cluster’s identity. For each\nransomware family, we identify the top three exchanges that\nsent the highest amount of inflows in US Dollars. Across\n\n\n-----\n\n|Cerber Locky|Col2|Col3|\n|---|---|---|\n||Cerber Locky||\n\n\nFig. 5: Inflows to Cerber and Locky that satisfy Filter 1.\n\nthe five ransomware families we study, the top exchanges\ninclude BTC-e, Bithumb, Coin.mx, Coinbase, Korbit, and\nLocalBitcoins. We label all other exchanges or real-world\nentities as “Misc”. Figure 4 presents the breakdown of V1\nvalues by exchanges, relative to the total V1 of each family.\nWe truncate the x-axis at 60% to highlight the distribution of\nknown exchanges.\nOf the top exchanges, both Bithumb and Korbit require\nusers to purchase bitcoins in Korean Won. Also, both require\nusers to have Korean phone numbers upon account creation.\nThese requirements present hurdles to non-Korean users attempting to use these exchanges. Both of these exchanges account for $2,619,709, or 34.1% of Cerber’s ransom payments,\nlikely paid for by victims in South Korea. The remaining four\nexchanges, in contrast, do not have such geographic restriction;\ninternational users can deposit money to these four exchanges\nand purchase bitcoins.\n\n_C. Payment Dynamics_\n\nOnce a victim acquires bitcoins, she typically sends the\nbitcoins to a ransom address. For ransomware families that\ngenerate a unique ransom address per victim, such as Cerber and Locky, we can use the likely ransom addresses to\ncharacterize the individual behaviors of potential victims. In\nparticular, we can estimate the number of paying victims by\ncounting the number of likely ransom addresses, as shown\nin the bottom chart of Figure 5. The Locky cluster sees\nthe highest number of likely ransom addresses on March 18,\n2016, when 198 victims are likely to have paid a ransom.\nIn the top chart, we plot the median inflow amount per\nlikely ransom address. Of particular note, Locky received a\nmedian inflow amount of $4,137 on June 18, 2016 across two\nlikely ransom addresses: one received 4 bitcoins ($3,008) in\na single transaction, and the other received 7 bitcoins also in\na single transaction ($5,265). Unfortunately, we do not have\nan explanation for these larger payments, but they make up a\ntiny fraction of the payments.\nIn addition to using the median, we present the distribution\nof inflow amounts per likely ransom address in Figure 6,\n\n\nFig. 6: Distribution of likely ransom payments.\n\ndenominated in either US Dollars (left) or Bitcoin (right). In\nparticular, 50% of all Cerber’s ransom payments comes from\nlikely ransom addresses that receive at least $838 worth of\nbitcoins. By contrast, 50% of all Locky’s ransom payments\nare from likely ransom addresses that receive at least $1,715\nworth of bitcoins. Overall, both charts suggest that a potential\nLocky victim probably pays a higher ransom than a potential\nCerber victim. Note that the distribution of Locky’s bitcoin\ninflow amounts is step-like, as Locky’s ransom amounts are\nknown to be increments of 0.5 bitcoins.\n\n_D. Payment Timing_\n\nFor each likely ransom address, the inflow’s timestamp may\nreveal when victims likely paid. Most of the likely ransom\naddresses are each associated with only one inflow, which\nsuggests that a potential victim paid the ransom in a single\ntransaction. In fact, 95.4% of Cerber’s ransom payments and\n98.3% of Locky’s ransom payments were paid for in this way.\nWe extract the timestamp from every single inflow transaction.\nThe remaining likely ransom addresses are each associated\nwith two or more inflows, likely because a victim did not fully\npay the ransom as he had not accounted for the transaction\nfees; in this case, we extract the timestamp from the earliest\ninflow per likely ransom address.\nThese timestamps show when victims potentially paid the\nransom, in terms of days of the week and hours of the day.\nWe show the distribution in Figure 7. For instance, 22.2% of\nLocky’s ransome payments comes from inflows on Thursdays.\nAlso, 9.0% of Cerber’s ransom payments are made around\n08:00 hours UTC. Of particular note is that a single peak hour\ncontributed most to Cerber’s ransom payments, while there\nare two such peak hours for Locky. One possible explanation\nis that Cerber’s paying victims were more concentrated in\na certain geographic region (hence the same timezone) than\nLocky’s paying victims, although we cannot validate this\nabsent ground-truth. Furthermore, the least amounts of inflows\nfor both Cerber and Locky are observed around 23:00 hours\nUTC. It is likely that most of the paying victims were located\nin Asia based on the diurnal pattern [34].\n\n_E. Characterizing potential Cash Out_\n\nIn addition to inflows, we examine the outflows from\nransomware clusters. An outflow is a transaction that transfers\nbitcoins from a wallet address of a ransomware cluster to\nan address of a non-ransomware cluster. Using Figure 1 as\nan illustration, Address 4 sends an outflow transaction to an\nexchange wallet address, while Address 11 sends an outflow to\n\n\n-----\n\nFig. 7: Distribution of inflow amounts over a week (left) and\nover a day (right) of ransom payments.\n\nan unknown cluster. We observe an outflow when, for instance,\na ransomware operator moves bitcoins from her own cluster\nto a Bitcoin exchange, presumably to convert her bitcoins\nto fiat currency (i.e., US Dollars). Also, an outflow occurs\nwhen an operator moves bitcoins into a mixer (recall from\nSection II). After mixing, the operator will presumably transfer\nher bitcoins from the mixer to an exchange for conversion\nto fiat currency, although we are unable to track bitcoins\nthat have entered a mixer’s cluster. In general, whether the\noperator sends the bitcoins from the ransomware’s cluster to\nan exchange, a mixer, or some unknown clusters, we cannot\nguarantee if and when the operator cashes out. Nonetheless,\noutflows mark the beginning of a process that could potentially\nlead to exchange for fiat currency.\nTo study outflows, we first compare the timings of outflows\nagainst inflows. This comparison allows us to estimate the\nduration in which ransomware operators are holding bitcoins\nbefore potentially cashing out. To this end, we trace how\nbitcoins flow from likely ransom addresses (i.e. inflows that\nsatisfy Filter 1) to outflow transactions. The bitcoins could\nflow directly from a likely ransom address to an outflow\ntransaction. Alternatively, bitcoins may go through intermediate transactions, flowing from one wallet address of the\nransomware’s cluster to another wallet address of the same\ncluster, before the bitcoins reach an outflow transaction. In\neither case, we extract the timestamp when the likely ransom\naddress first receives bitcoins, and also the earliest timestamp\namong the outflows (as the bitcoins may be split into multiple\noutflows). In the median case, the bitcoins remained in WannaCry’s cluster for 79.8 days, while for Cerber and Locky, the\nmedian holding durations for Cerber and Locky are 5.3 and\n1.6 days respectively.\nAnother insight we can gain from outflows is how ransomware operators potentially cash out the ransom bitcoins.\nFor each outflow transaction of a given ransomware family,\nwe look at the output wallet address(es), which, by definition,\nshould be in non-ransomware clusters. Using Chainalysis’\nAPI, we obtain the real-world identities of these clusters, such\nas exchanges, mixers, or “Unknown.” For each ransomware\nfamily, we identify top three real-world entities that receive\nthe most US Dollars from the ransomware’s cluster. Across the\nfive ransomware families, the top entities overlap and include\nBTC-e, CoinOne, and LocalBitcoins (all exchanges), along\nwith BitMixer and Bitcoin Fog (both mixers). We show their\ndistribution in Figure 8. Real-world entities that are not a part\n\n\nWannaCry\n\nLocky\n\nCryptoDefense\n\nCryptXXX\n\nCerber\n\n0% 10% 20% 30% 40% 50% 60%\nPercent of bitcoin outflow for a given family\n\n|Col1|BTC-e.com CoinOne.co.kr Misc|\n|---|---|\n||BTC-e.com C.oinOne.co.kr Misc BitMixer.io L.ocalBitcoins.com Unknown Bitcoin Fog .|\n|||\n\n\nFig. 8: Real-world entities that received bitcoins from ransomware’s outflows.\n\nof the top ones are labelled as “Misc.”\nCompared with Figure 4, Figure 8 shows a different set\nof known exchanges. In particular, BTC-e (whose operator was arrestes and which is now defunct) is the biggest\nknown exchange responsible for the outflows of Locky and\nCryptoDefense; $3,223,015 of Locky’s outflows entered BTCe’s cluster. If law enforcement agencies were able to obtain\nBTC-e’s internal transaction records (which presumably map\nBitcoin wallet addresses to banking information), they could\npotentially trace 41.0% of Locky’s outflow values to real-world\nentities. A further difference is the use of Bitcoin mixers,\nwhich we did not detect in source clusters for the inflows.\nFor example, $541,670 (6.8% of Cerber’s total outflows) was\nsent from Cerber’s cluster to BitMixer.\n\nVI. IMPACT ON INFECTED VICTIMS\n\nIn the previous two sections, we use the blockchain to\ncharacterize the behaviors of victims who likely paid the ransom. However, it is difficult to infer the behaviors of victims\nwho did not pay, as the blockchain only records activities\nof payments. We propose and implement a sinkholing-based\nmethod to intercept the communication between an infected\nmachine and the ransomware’s command-and-control (C2)\nserver. Using Cerber as a case study, this section discusses how\nwe use our method to gather statistics on victims infected with\nCerber, along with the insights we draw from this data. We\nchoose to focus on one ransomware family, Cerber, because of\nthe manual effort required to reverse engineer how the malware\ncommunicates with the ransomware operators.\nWe start by reverse engineering Cerber’s telemetry protocol.\nUsing this knowledge, we then intercept Cerber victims’\ntelemetry traffic, along with what this traffic reveals about\nthe impact on victims — for instance, how many victims are\ninfected and how long it takes for the encryption process to\ncomplete.\n\n_A. Reverse Engineering Network Traffic_\n\nWe start our reverse engineering process by executing two\nbinaries which our algorithm classified as Cerber on a bare\nmetal machine with Windows XP installed. We choose not\nto use a VM to reduce the likelihood that the ransomware\nsamples might behave differently from those in the wild. The\nhost is not connected to the Internet. We capture all packets\nthat the machine sends out with TCPDump. Inside the host’s\n\n\n-----\n\nfile system, we place documents that Cerber is known to\nencrypt [11]. We also instrument the file system to log when\nfiles are changed, so that we can track Cerber’s process of\nencryption.\nIn each of the three executions of the same binary, it\nconsistently broadcasts a UDP packets to four different /24\nsubnets at port 6892. For each of the subnets, the binary sends\nthree types of packets. Before the binary encrypts any files, it\nsends out the first type of UDP packets, which we shall call\nPackets A. Each of these packets include a five-byte identifier\nin the payload, which is referred to as the Partner ID by an\nanalysis report [11]. This ID is the constant when re-executing\nthe same binary, but it changes with a different binary. Within\nfive seconds of broadcasting Packets A to four subnets, the\nbinary starts encrypting our files, followed by the broadcast\nof the second type of packets, which we call Packets B. The\npayload of these packets includes the Partner ID and a 12-byte\nidentifier that changes across execution of the same binary,\nwhich the report refers to as the Machine ID [11]. Within five\nseconds of the termination of encryption, the binary broadcasts\nthe third type of packets, which we call Packets C, whose\npayload includes the Machine ID. Afterwards, the ransom note\nis displayed, from which we extract the ransom wallet address.\nFinally, we re-image the host’s hard disk to prepare for the next\nexecution.\n\n_B. Analyzing Cerber’s Packets in the Wild_\n\nBroadcasting telemetry packets across different subnets effectively hides the IP address(es) of Cerber’s infrastructure,\nbut it has also created an opportunity for us to observe these\npackets. By buying an IP address within the subnets, we can\ncapture the telemetry packets and analyze the behaviors of\nCerber binaries in the wild.\nFirst, we need to determine what IP address to purchase.\nIn the last two weeks of January 2017, we executed 1,256\nbinaries that we classify as Cerber in sandboxes. These binaries contacted 158 /24 subnets in total. We compute the\nnumber of packets that each subnet was sent. The top two\nsubnets, based in Norway and Greece, were sent 111,361 and\n110,595 packets respectively. Neither responded to our request\nto purchase an IP address. The third subnet was sent 46,336\npackets. It belongs to a Russian hosting provider, from which\nwe purchased a server at an IP address in the subnet and ran\nTCPDump on the server between February 2 and 20, 2017.\n\n**Overall distribution of infection:** In total, we received\n88,240 UDP packets across 1,512 IP addresses. Of these\npackets, 92.0% are Packets A, 4.7% are Packets B, and 3.2%\nare Packets C. The relative under-representation of Packets B\nand C could be due to the loss of UDP packets, as the prior\nbroadcast of Packets A could have filled up the queues along\nthe route, or it could be due to the duplication of Packets\nA. Even though the Cerber binary in our own environment\nsent out the same number of Packets A, B, and C, the exact\nbehavior of the ransomware in the wild could be different —\npossibly due to a different version.\n\n\nFig. 9: Number of infected IP addresses across countries and\nISP types.\n\nThe 1,512 IP addresses offer a lower-bound on the number\nof infected hosts. There are two reasons why this number\nis a lower-bound. First, the packets we captured came from\nCerber binaries that sent telemetry data to our choice of the\nsubnet. We cannot guarantee that all binaries in the wild would\nbroadcast to the subnet. Thus, an unknown number of infected\nhosts are likely to be missing from our data. Second, multiple\ninfected hosts could be behind a NAT or may be assigned\nthe same IP address at different times.[7] As such, we could be\nunderestimating the scale of infection.\nWe show the geographic distribution of infected IP addresses, along with the type of ISP for each IP address, in\n**Figure 9. We determine the country and ISP type of each IP**\naddress using Maxmind [35]. As shown in the chart, South\nKorea has the most number of infected IP addresses that sent\nus the telemetry packets; 22.6% of all infected IP addresses are\nfrom the country. IP addresses from residential ISPs contribute\nto 74.5% of the infected IP addresses. ISPs that are labelled\nas “hosting,” which are hosting service providers, account for\n8.5% of the IP addresses.\n\n**Distribution of infected hosts:** To distinguish between\ndifferent infected hosts with the same IP addresses, we use\nthe Machine IDs extracted from Packets B and C. Only 583\nIP addresses (38.6%) reported Machine IDs.[8] Among these IP\naddresses, 412 of them (70.7%) were associated with exactly\none Machine ID, and 132 of them (22.6%) are each associated\nwith 2 to 10 Machine IDs. For the 412 IP addresses, residential\nIP addresses account for 80.3% while hosting services account\nfor 9.0%. For the 132 IP addresses, 59.1% are residential and\n23.5% are hosting services. At the tail end, one IP address\nreported 1,162 different Machine IDs. This IP address belongs\nto a major hosting service in the US (labelled as “hosting”\nin Figure 9). On average, we received Packet B from this\nhosting IP address with a new Machine ID every 22.6 minutes.\nWe are not sure if telemetry packets from this IP address are\nfrom real victims or synthetic ones. In general, we do not\nremove IP addresses from our analysis even if they appear\nto be coming from synthetic victims. Absent ground truth,\nwe cannot distinguish IP addresses from sandboxes or from,\nfor instance, a commercial VPN provider that uses hosting\n\n7It is unlikely that the same host is infected multiple times; we tried\nexecuting the same Cerber binary the second time in our VM (Section VI-A),\nbut the repeated execution did not result in more telemetry packets.\n8There are 25 Machine IDs, such that each of them was reported from two\nIP addresses. Together, there are 18 such IP addresses. We suspect the infected\nhosts were either mobile clients, or they experienced DHCP reassignment.\n\n\n-----\n\n(a)\n\n\n(b)\n\n\nFig. 10: (a) A histogram that shows that number of infected\nIP addresses per Cerber partners. (b) The time from observing\nPacket A at a given IP address to observing Packet C at the\nsame IP address.\n\nservices and whose subscribers happen to be widely infected\nwith Cerber. This uncertainty highlights some of the challenges\nof distinguishing real infections from sandbox traffic.\n\n**Distribution of partners:** Based on our own execution of\nCerber’s two binaries in Section VI-A, it appears that the\nPartner ID might be persistent across binaries. As Cerber is\nknown to operate in the affiliate model [11], it is likely that\na partner is an affiliate that distributes a particular binary in\nexchange of a percentage of ransom revenue; the Partner ID\nthus offers a possible insight on the number of infected IP\naddresses for each affiliate.\nWe extract the Partner ID from Packets A or B for each\ninfected IP address and present the number of unique IP\naddresses for each partner in Figure 10a. In particular, Partner\n0 infected 253 distinct IP addresses while Partner 1 infected\n162. We observe a total of 118 partners, but Partners 0 through\n7 account for 51.5% of all infected IP addresses. Each of these\n8 partners are associated with between 13 and 33 infected\ncountries across the world. Identifying major affiliates could\nbe useful for prioritizing which affiliates to investigate and\ntarget for technical and law enforcement based interventions.\n\n**Duration of encryption:** Recall, from Section VI-A, that\nthe Cerber binary sends Packets A before encrypting user\nfiles, and when the encryption is complete, the binary sends\nPackets C. The duration between Packets A and C allows us to\nmeasure how long it takes for encryption of files to complete;\nthe shorter the duration, the smaller the window is between\ninfection and when the malware needs to be detected before\nall files are encrypted.\nIn order to compute this duration, we first identify IP\naddresses that are associated with exactly one Machine ID.\nIf an IP address is associated with multiple Machine IDs,\nthen there could be multiple Packets A and multiple Packets\nC; it would be difficult to determine which Packets A-C\npair belongs in the same infection. Using IP addresses each\nwith a single Machine ID reduces this error, although what\nappears to be a pair of Packets A and C could come from\ndifferent infections due to packet losses. Absent ground-truth,\nwe assume that Packets A and C, in this case, likely mark the\n\n\nbeginning and end of encryption for a single infection.\nIn total, 412 IP addresses are associated with a single\nMachine ID, but we have received both Packets A and C from\nonly 182 of the IP addresses. For these 182 IP addresses, we\nplot the distribution of the encryption duration in Figure 10b.\nThe median duration is 7.8 minutes. In other words, if a\nvictim finds that one of his file is encrypted, she has less\nthan 7.8 minutes to back up other documents before they are\nall encrypted. Alternatively, if the victim uses software that\nautomatically detects ransomware encryption — for instance,\nusing techniques proposed by Kharaz et al [36] — then the\ndetection algorithm has less than 7.8 minutes to react.\n\nVII. DISCUSSION\n\nIt is widely known that ransomware causes harm to many\npeople either through monetary losses or destruction of files.\nThis threat is challenging to measure, but an improved understanding of the ransomware ecosystem is a key first step\nto identifying new and potentially more effective intervention\nstrategies. Based on our measurements, we propose a multipronged strategy to improve our ability to measure and reduce\nthe harm caused by ransomware. In this section, we outline\nour ideas and discuss looming hurdles, including ethical issues\nthat are unique to ransomware. A full investigation of our\nsuggestions will require significant future work.\n\n**Estimating conversion:** One open question that remains\nunanswered in this paper is conversion. Given an infection,\nwhat is the probability that a victim might pay the ransom? The\ntelemetry data that we collected in Section VI could have been\nused to estimate the conversion rate of Cerber, but it involves\nethical problems that caused us to decide against performing\nthis analysis.\nSpecifically, Cerber’s telemetry gives us indirect access\nto individual victims’ payment record (or the lack thereof).\nAfter the ransomware finishes the encryption, the ransom note\nautomatically appears on the victim’s desktop and asks the\nvictim to visit a set of ransom payment websites. The URLs\nare in the form of http://id1.hostname/id2, where id1\nis the hidden service ID shared across multiple infections (as\nvictims can make payments via Tor at http://id1/id2 as\nwell), and id2 concatenates the Partner ID and Machine ID,\nalong with an MD5-based checksum (which we discovered in\nour own reverse engineering of the binary). To pay, the victim\nvisits one of the URLs and sees a webpage customized for the\nvictim. The webpage contains id2, a Bitcoin ransom address\nunique to the victim, and the ransom amount. A five day\ncountdown is started when a victim visits the page for the first\ntime; afterwards, the ransom doubles (based on our experience\nwith synthetic victims). Our telemetry data’s Packets B contain\nboth the Partner IDs and Machine IDs, enabling us to compute\n_id2 and, in theorey, visit the victim’s payment URL to check_\nif and when the victim paid.\nHowever, we did not conduct this analysis, since visiting the\nURL might cause harm to victims. If we visit the URL before\nthe victim visits, the countdown would start immediately,\n\n\n-----\n\nwhich might cause the victim to have to pay double the ransom\namount. One strategy is to wait for several months after our\ndata collection in February 2017 before we visit the victims’\nURLs. Regardless of how long we wait, we cannot guarantee\nthat all victims would have either visited the payment URLs or\ndecided to re-install their systems during this period. As such,\nthe risks of the analysis outweigh the benefit of estimating the\nconversion rate.\n\n**Coverage limitations: Our measurement techniques provided**\nimproved coverage over prior techniques, but it is still not\ncomplete. One of the main limitations is that our transaction\nfiltering methods were not effective for some ransomware\nfamilies, such as those that had a dynamic pricing structure or\nfor which we did not know the ransom amount (e.g., Spora).\nAnother limitation was that, for ransomware campaigns where\nwe did not have a binary or that were no longer operating, we\ncould not generate synthetic victims and make micropayments.\nWe plan on exploring improved filtering techniques to cover\nmore families. We are also exploring OCR and NLP methods\nfor finding more reported payments from victims to improve\ncoverage of ransomware measurement.\nWe will also continue to investigate methods of tracing\nadditional cash-outs that traverse mixers or use other methods\nof obfuscating flows of bitcoins. This is key to increasing the\nrisk of liquidating ransomware profits.\n\n**Intervention:** Our measurement study indentified potential\nintervention beyond improved ransomware detection and backing up of files, such as increasing the difficulty and risk when\nransomware operators cash out their bitcoins. Our methods\nof tracing ransomware payment assist in this objective; indeed BTC-e’s operator was arrested and the exchange was\nclosed [37].\nAnother potential intervention point is to disrupt a victim’s\nability to pay the ransom. During our analysis of Cerber, we\nfound that the hostname part of Cerber’s payment URL is\ngenerated using a domain-generation algorithm (DGA). Based\non our analysis, the hostname is the prefix of the most recent\nwallet address that receives and sends bitcoins from and to\n_w, another wallet address likely controlled by Cerber. This_\nDGA creates an opportunity for us to disrupt the payment\ninfrastructure. We could prevent victims from being able to\npay the ransom by using our own wallet addresses to send\nbitcoins to w, which would have created new hostnames\nto divert victim visits from Cerber’s payment infrastructure.\nHowever, we chose not to conduct this intervention, since it\nwould have also prevented victims from recovering their files.\nThis introduces a unique ethical issue. We must consider\nthe impact on victims before taking down ransomware infrastructure. Whereas disrupting conventional malware reduces\nthe damage on victims, the effect could be the opposite for\nransomware. Any attempts to prevent ransom payment could\nbe risky. Herein lies a common ransomware dilemma: If every\nvictim did not pay or was prevented from paying, the scale\nof the problem would likely decrease; however, this would\nmean that some individuals would incur additional harm by\n\n\nnot being able to recover their files.\n\nVIII. RELATED WORK\n\nThe initial Bitcoin tracing method that links together flows\nwith multiple input transactions was proposed in prior studies [38], [39], [5] and in the original paper proposing Bitcoin [24]. However, this method is now prone to incorrectly\nlinking flows that use anonymization techniques, such as\nCoinJoin [23], [40] and CoinSwap [41]. Moser and Bohme\n\n[42] developed methods of detecting likely anonymized transactions. We use Chainalysis’s platform, which uses all these\nmethods and additional proprietary techniques to detect and\nremove anonymized transactions, to trace flows of bitcoins.\nBitIodine is a Bitcoin forensic analysis tool which used\nreported victim ransom payments to perform a payment analysis for a single ransomware family, CryptoLocker [7]. A\nfollowup study by Liao Et. Al. [6] performed an expanded\nanalysis of CryptoLocker by discovering additional reported\nvictim ransom payments and further analyzing whether an\ninflow is a likely victim payment (similar to our Filter 1).\nFinally, researchers from FireEye performed an analysis of\nthe actual conversion rate of infections to paying victims for\nTeslaCrypt [43]. The data source for the FireEye study was\nnot explicitly mentioned, but was likely the backend database\nfor TeslaCrypt that was either leaked or seized.\nIntervention strategies include technical solutions, such as\ndetecting changes on the file system as a result of ransomware\ninfection [36] and analyzing network traffic [44]; or economic\nsolutions, such as disrupting the payment processors [45].\nWe use BinDiff [31] to identify similar malware binaries.\nOther related methods include SigMal [46].\n\nIX. CONCLUSION\n\nOur study of the ransomware ecosystem illustrates that the\nphenomenon of cybercriminals increasingly using Bitcoin for\npayments produces an opportunity to gain key insights into the\nfinancial inner workings of these operations. We have created\na set of measurement methodologies and used them to conduct\na detailed two year end-to-end examination of the ransomware\necosystem. Our methods allowed us to track ransom payments\nfrom the acquisition of bitcoins by victims, to the cash-out\nof bitcoins by the ransomware operators. We were able to\nconservatively estimate that the overall ecosystem revenue\nfor the past two years was over 16 million USD extorted\nfrom on the order of 20,000 victims. Our ensuing analysis of\nransomware operators’ cash-out strategies indicated that BTCe was a key piece of support infrastructure that was used to\nexchange millions of USD worth of ill-gotten bitcoins into fiat\ncurrency. Our study also illuminates many open technical and\nethical issues to measuring and intervening on the ransomware\necosystem.\n\nACKNOWLEDGMENTS\nThis work was funded in part by the National Science Foundation through\nCNS-1619620, CNS-1717062, and CNS-1629973, and by gifts from Comcast\nand Google. We thank Melissa McCoy, Kurt Thomas, and Geoffrey M.\nVoelker for their feedback, and Cindy Moore and Brian Kantor for their\ntechnical assistance.\n\n\n-----\n\nREFERENCES\n\n[1] Wismer, David. Hand-To-Hand Combat With The Insidious “FBI\nMoneyPak Ransomware Virus”. Forbes,\n_[https://www.forbes.com/sites/davidwismer/2013/02/06/hand-to-hand-](https://www.forbes.com/sites/davidwismer/2013/02/06/hand-to-hand-combat-with-the-insidious-fbi-moneypak-ransomware-virus/#56afdeb1504a)_\n_[combat-with-the-insidious-fbi-moneypak-ransomware-](https://www.forbes.com/sites/davidwismer/2013/02/06/hand-to-hand-combat-with-the-insidious-fbi-moneypak-ransomware-virus/#56afdeb1504a)_\n_[virus/#56afdeb1504a, 2013.](https://www.forbes.com/sites/davidwismer/2013/02/06/hand-to-hand-combat-with-the-insidious-fbi-moneypak-ransomware-virus/#56afdeb1504a)_\n\n[2] Nicolas Christin. Traveling the Silk Road: A Measurement Analysis of\na Large Anonymous Online Marketplace. CoRR, abs/1207.7139, 2012.\n\n[3] Rebecca S Portnoff, Danny Yuxing Huang, Periwinkle Doerfler, Sadia\nAfroz, and Damon McCoy. Backpage and bitcoin: Uncovering human\ntraffickers. In Proceedings of the 23rd ACM SIGKDD International\n_Conference on Knowledge Discovery and Data Mining, pages_\n1595–1604. ACM, 2017.\n\n[4] Ryan Brunt, Prakhar Pandey, and Damon McCoy. Booted: An\nAnalysis of a Payment Intervention on a DDoS-for-Hire Service. In\n_Workshop on the Economics of Information Security, 2017._\n\n[5] Sarah Meiklejohn, Marjori Pomarole, Grant Jordan, Kirill Levchenko,\nDamon McCoy, Geoff Voelker, and Stefan Savage. A Fistful of\nBitcoins: Characterizing Payments Among Men with No Names. In\n_Proceedings of the ACM Internet Measurement Conference, 2013._\n\n[6] K. Liao, Z. Zhao, A. Doup´e, and G. J. Ahn. Behind closed doors:\nmeasurement and analysis of CryptoLocker ransoms in Bitcoin. In\n_2016 APWG Symposium on Electronic Crime Research (eCrime),_\npages 1–13, June 2016.\n\n[7] Michele Spagnuolo, Federico Maggi, and Stefano Zanero. BitIodine:\nExtracting Intelligence from the Bitcoin Network. In Financial\n_Cryptography and Data Security: 18th International Conference, FC,_\npages 457–468, 2014.\n\n[8] Damon McCoy, Andreas Pitsillidis, Grant Jordan, Nicholas Weaver,\nChristian Kreibich, Brian Krebs, Geoffrey M Voelker, Stefan Savage,\nand Kirill Levchenko. Pharmaleaks: Understanding the business of\nonline pharmaceutical affiliate programs. In Proceedings of the 21st\n_USENIX conference on Security symposium, pages 1–1. USENIX_\nAssociation, 2012.\n\n[9] Shuang Hao, Kevin Borgolte, Nick Nikiforakis, Gianluca Stringhini,\nManuel Egele, Michael Eubanks, Brian Krebs, and Giovanni Vigna.\nDrops for stuff: An analysis of reshipping mule scams. In Proceedings\n_of the 22nd ACM SIGSAC Conference on Computer and_\n_Communications Security, pages 1081–1092. ACM, 2015._\n\n[10] Brett Stone-Gross, Ryan Abman, Richard A Kemmerer, Christopher\nKruegel, Douglas G Steigerwald, and Giovanni Vigna. The\nunderground economy of fake antivirus software. In Economics of\n_information security and privacy III, pages 55–78. Springer, 2013._\n\n[11] CerberRing: An In-Depth Expose on Cerber Ransomware-as-a-Service.\n_Check Point Blogs,_\n_[https://blog.checkpoint.com/2016/08/16/cerberring/](https://blog.checkpoint.com/2016/08/16/cerberring/)_, 2016.\n\n[[12] Ransomware in Action. https://www.tmsi.hu/antidotum-](https://www.tmsi.hu/antidotum-prezentaciok/antidotum-2017-r1/Ransomware_presentation_DP.pdf)\n_[prezentaciok/antidotum-2017-r1/Ransomware presentation DP.pdf](https://www.tmsi.hu/antidotum-prezentaciok/antidotum-2017-r1/Ransomware_presentation_DP.pdf)_,\n2017.\n\n[13] Danny Palmer. Now Cerber ransomware wants to steal your Bitcoin\n[wallets and passwords too. http://www.zdnet.com/article/now-cerber-](http://www.zdnet.com/article/now-cerber-ransomware-wants-to-steal-your-bitcoin-wallets-and-passwords-too/)\n_[ransomware-wants-to-steal-your-bitcoin-wallets-and-passwords-too/](http://www.zdnet.com/article/now-cerber-ransomware-wants-to-steal-your-bitcoin-wallets-and-passwords-too/)_ .\n\n[14] John Kevin Adriano. Fake invoice email with HTML attachment\nspreads Locky ransomware.\n_[https://www.trendmicro.com/vinfo/us/threat-encyclopedia/spam/3621/](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/spam/3621/fake-invoice-email-with-html-attachment-spreads-locky-ransomware)_\n_[fake-invoice-email-with-html-attachment-spreads-locky-ransomware.](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/spam/3621/fake-invoice-email-with-html-attachment-spreads-locky-ransomware)_\n\n[15] Lawrence Abrams. Researcher finds the Karma Ransomware being\ndistributed via Pay-per-Install Network.\n_[https://www.bleepingcomputer.com/news/security/researcher-finds-the-](https://www.bleepingcomputer.com/news/security/researcher-finds-the-karma-ransomware-being-distributed-via-pay-per-install-network/)_\n_[karma-ransomware-being-distributed-via-pay-per-install-network/](https://www.bleepingcomputer.com/news/security/researcher-finds-the-karma-ransomware-being-distributed-via-pay-per-install-network/)_,\n2016.\n\n[16] Lily Hay Newman. Petya Ransomware Hackers Didn’t Make\nWannaCry’s Mistakes.\n_[https://www.wired.com/story/petya-ransomware-wannacry-mistakes/](https://www.wired.com/story/petya-ransomware-wannacry-mistakes/)_ .\n\n[17] Kan, Michael. Paying the WannaCry ransom will probably get you\nnothing. Here’s why.\n_[https://www.pcworld.com/article/3196880/security/paying-the-](https://www.pcworld.com/article/3196880/security/paying-the-wannacry-ransom-will-probably-get-you-nothing-heres-why.html)_\n_[wannacry-ransom-will-probably-get-you-nothing-heres-why.html.](https://www.pcworld.com/article/3196880/security/paying-the-wannacry-ransom-will-probably-get-you-nothing-heres-why.html)_\n\n[18] Ducklin, Paul. “Locky” ransomware what you need to know.\n_[https://nakedsecurity.sophos.com/2016/02/17/locky-ransomware-what-](https://nakedsecurity.sophos.com/2016/02/17/locky-ransomware-what-you-need-to-know/)_\n_[you-need-to-know/](https://nakedsecurity.sophos.com/2016/02/17/locky-ransomware-what-you-need-to-know/)_ .\n\n[19] Malwarebytes Labs. Explained: Spora ransomware. https:\n_[//blog.malwarebytes.com/threat-analysis/2017/03/spora-ransomware/](https://blog.malwarebytes.com/threat-analysis/2017/03/spora-ransomware/)_ .\n\n\n\n[[20] ID Ransomware. https://id-ransomware.malwarehunterteam.com/](https://id-ransomware.malwarehunterteam.com/) .\n\n[[21] VmRay. http://vmray.com.](http://vmray.com)\n\n[[22] Cloud Vision API. https://cloud.google.com/vision/](https://cloud.google.com/vision/) .\n\n[23] Tim Ruffing, Pedro Moreno-Sanchez, and Aniket Kate. Coinshuffle:\nPractical decentralized coin mixing for bitcoin. In 19th European\n_Symposium on Research in Computer Security - Volume 8713,_\nESORICS 2014, pages 345–364, New York, NY, USA, 2014.\nSpringer-Verlag New York, Inc.\n\n[24] Satoshi Nakamoto. Bitcoin: A peer-to-peer electronic cash system.\n_Consulted, 1(2012):28, 2008._\n\n[25] S. Goldfeder, H. Kalodner, D. Reisman, and A. Narayanan. When the\ncookie meets the blockchain: Privacy risks of web payments via\ncryptocurrencies. ArXiv e-prints, August 2017.\n\n[26] H. Kalodner, S. Goldfeder, A. Chator, M. M¨oser, and A. Narayanan.\nBlockSci: Design and applications of a blockchain analysis platform.\n_ArXiv e-prints, September 2017._\n\n[[27] Google Trends. https://trends.google.com/trends/](https://trends.google.com/trends/) .\n\n[[28] VirusTotal. http://virustotal.com.](http://virustotal.com)\n\n[[29] Yara rule dataset. https://github.com/Yara-Rules/rules.](https://github.com/Yara-Rules/rules)\n\n[[30] VXClass. https://www.zynamics.com/vxclass.html.](https://www.zynamics.com/vxclass.html)\n\n[31] BinDiff manual.\n_[https://www.zynamics.com/bindiff/manual/#chapUnderstanding.](https://www.zynamics.com/bindiff/manual/#chapUnderstanding)_\n\n[32] Cerber version 6 shows how far the ransomware has come.\n_[http://blog.trendmicro.com/trendlabs-security-intelligence/cerber-](http://blog.trendmicro.com/trendlabs-security-intelligence/cerber-ransomware-evolution/)_\n_[ransomware-evolution/](http://blog.trendmicro.com/trendlabs-security-intelligence/cerber-ransomware-evolution/)_ .\n\n[33] Tomas Meskauskas. CryptXXX Ransomware.\n_[https://www.pcrisk.com/removal-guides/9963-cryptxxx-ransomware.](https://www.pcrisk.com/removal-guides/9963-cryptxxx-ransomware)_\n\n[34] David Dagon, Cliff Changchun Zou, and Wenke Lee. Modeling Botnet\nPropagation Using Time Zones. In Proceedings of the 13th Annual\n_Symposium on Network and Distributed System Security, 2006._\n\n[35] MaxMind. GeoIP2 Precision Insights Service.\n_[https://www.maxmind.com/en/geoip2-precision-insights.](https://www.maxmind.com/en/geoip2-precision-insights)_\n\n[36] Amin Kharaz, Sajjad Arshad, Collin Mulliner, William Robertson, and\nEngin Kirda. UNVEIL: A large-scale, automated approach to detecting\nransomware. In 25th USENIX Security Symposium (USENIX Security\n_16), pages 757–772, Austin, TX, 2016. USENIX Association._\n\n[37] Russian National And Bitcoin Exchange Charged In 21-Count\nIndictment For Operating Alleged International Money Laundering\nScheme And Allegedly Laundering Funds From Hack Of Mt. Gox.\n_[https://www.justice.gov/usao-ndca/pr/russian-national-and-bitcoin-](https://www.justice.gov/usao-ndca/pr/russian-national-and-bitcoin-exchange-charged-21-count-indictment-operating-alleged)_\n_[exchange-charged-21-count-indictment-operating-alleged, 2017.](https://www.justice.gov/usao-ndca/pr/russian-national-and-bitcoin-exchange-charged-21-count-indictment-operating-alleged)_\n\n[38] Elli Androulaki, Ghassan O. Karame, Marc Roeschlin, Tobias Scherer,\nand Srdjan Capkun. Evaluating User Privacy in Bitcoin, pages 34–51.\nSpringer Berlin Heidelberg, 2013.\n\n[39] Dorit Ron and Adi Shamir. Quantitative Analysis of the Full Bitcoin\nTransaction Graph. In Proceedings of Financial Cryptography 2013,\n2013.\n\n[40] Gregory Maxwell. CoinJoin: Bitcoin Privacy for the Real World.\n_[https://bitcointalk.org/index.php?topic=279249.0, 2013.](https://bitcointalk.org/index.php?topic=279249.0)_\n\n[41] Gregory Maxwell. CoinSwap: Transaction graph disjoint trustless\n[trading. https://bitcointalk.org/index.php?topic=321228.0, 2013.](https://bitcointalk.org/index.php?topic=321228.0)\n\n[42] M. M¨oser and R. B¨ohme. Anonymous Alone? Measuring Bitcoin’s\nSecond-Generation Anonymization Techniques. In 2017 IEEE\n_European Symposium on Security and Privacy Workshops (EuroS PW),_\npages 32–41, April 2017.\n\n[43] Nart Villeneuve. TeslaCrypt: Following the Money Trail and Learning\nthe Human Costs of Ransomware.\n_[https://www.fireeye.com/blog/threat-](https://www.fireeye.com/blog/threat-research/2015/05/teslacrypt_followin.html)_\n_[research/2015/05/teslacrypt followin.html, 2015.](https://www.fireeye.com/blog/threat-research/2015/05/teslacrypt_followin.html)_\n\n[44] K. Cabaj and W. Mazurczyk. Using Software-Defined Networking for\nRansomware Mitigation: The Case of CryptoWall. IEEE Network,\n30(6):14–20, November 2016.\n\n[45] Kirill Levchenko, Andreas Pitsillidis, Neha Chachra, Brandon Enright,\nM´ark F´elegyh´azi, Chris Grier, Tristan Halvorson, Chris Kanich,\nChristian Kreibich, He Liu, et al. Click trajectories: End-to-end\nanalysis of the spam value chain. In Security and Privacy (SP), 2011\n_IEEE Symposium on, pages 431–446. IEEE, 2011._\n\n[46] Dhilung Kirat, Lakshmanan Nataraj, Giovanni Vigna, and B. S.\nManjunath. Sigmal: A static signal processing based malware triage.\nIn Proceedings of the 29th Annual Computer Security Applications\n_Conference, ACSAC ’13, pages 89–98, New York, NY, USA, 2013._\nACM.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://storage.googleapis.com/pub-tools-public-publication-data/pdf/ce44cbda9fdc061050c1d2a5dec0270874a9dc85.pdf"
    ],
    "report_names": [
        "ce44cbda9fdc061050c1d2a5dec0270874a9dc85.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "20c759c2-cd02-45bb-85c6-41bde9e6a7cf",
            "created_at": "2024-01-18T02:02:34.189827Z",
            "updated_at": "2025-03-27T02:02:09.937024Z",
            "deleted_at": null,
            "main_name": "HomeLand Justice",
            "aliases": [
                "Karma",
                "Storm-842",
                "Void Manticore"
            ],
            "source_name": "ETDA:HomeLand Justice",
            "tools": [
                "BABYWIPER",
                "BiBi Wiper",
                "BiBi-Linux Wiper",
                "BiBi-Windows Wiper",
                "Cl Wiper",
                "LowEraser",
                "No-Justice Wiper",
                "Plink",
                "PuTTY Link",
                "RevSocks",
                "W2K Res Kit"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041364,
    "ts_creation_date": 1521727498,
    "ts_modification_date": 1521727498,
    "files": {
        "pdf": "https://archive.orkl.eu/eb667800eb7db66cf54f35d6a7378f9ee52ad6d3.pdf",
        "text": "https://archive.orkl.eu/eb667800eb7db66cf54f35d6a7378f9ee52ad6d3.txt",
        "img": "https://archive.orkl.eu/eb667800eb7db66cf54f35d6a7378f9ee52ad6d3.jpg"
    }
}