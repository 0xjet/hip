{
    "id": "9256cbb0-1b2a-4da5-be0c-b12802c9e1ae",
    "created_at": "2023-01-12T15:08:52.052202Z",
    "updated_at": "2025-03-27T02:05:34.478811Z",
    "deleted_at": null,
    "sha1_hash": "a548e2c24d8c0073e2c779012bda529d277e84a8",
    "title": "2021-11-05 - Spike in DanaBot Malware Activity",
    "authors": "",
    "file_creation_date": "2022-05-28T19:11:47Z",
    "file_modification_date": "2022-05-28T19:11:47Z",
    "file_size": 602771,
    "plain_text": "# Spike in DanaBot Malware Activity\n\n**[zscaler.com/blogs/security-research/spike-danabot-malware-activity](https://www.zscaler.com/blogs/security-research/spike-danabot-malware-activity)**\n\n**Key Points**\n\nTwo large software supply chain attacks distributed the DanaBot malware.\nDanaBot is a malware-as-a-service platform discovered in 2018 that focuses on\ncredential theft and banking fraud.\nDanaBot’s popularity has waned in recent years, but these campaigns may signal a\nreturn of the malware and its affiliates to the threat landscape.\n\n**Introduction**\n\nThe [DanaBot malware had a spike in new activity recently, including being distributed via](https://malpedia.caad.fkie.fraunhofer.de/details/win.danabot)\ntwo large software supply chain attacks and being used in a Distributed Denial of Service\n(DDoS) attack on a Russian language electronics forum.\n\n[DanaBot, first discovered by Proofpoint in May 2018, is a malware-as-a-service platform](https://www.proofpoint.com/us/threat-insight/post/danabot-new-banking-trojan-surfaces-down-under-0)\nwhere threat actors, known as “affiliates” and identified by “affiliate IDs”, purchase access to\nthe platform from another threat actor who develops the malware and command and control\n(C2) panel, sets up and maintains the shared C2 infrastructure, and provides sales and\ncustomer support. Affiliates then distribute and use the malware as they see fit--mostly to\nsteal credentials and commit banking fraud.\n\nWhile it was a prominent banking malware for a number of years and despite a new major\n[update being spotted at the end of 2020 (as documented by Proofpoint,](https://www.proofpoint.com/us/blog/threat-insight/new-year-new-version-danabot) [ESET, and](https://twitter.com/ESETresearch/status/1420734522581295106)\n[LEXFO), DanaBot has been relatively quiet in the recent threat landscape.](https://blog.lexfo.fr/danabot-malware.html)\n\n**Large Software Supply Chain Attack (October 22, 2021)**\n\n\n-----\n\n[As reported by the Cybersecurity and Infrastructure Security Agency (CISA),](https://us-cert.cisa.gov/ncas/current-activity/2021/10/22/malware-discovered-popular-npm-package-ua-parser-js) [GitHub,](https://github.com/advisories/GHSA-pjwm-rvh2-c87w) the\ndeveloper, and others the NPM JavaScript package for “UAParser.js” was compromised on\nFriday, October 22, 2021 and used to distribute a cryptocurrency miner and DanaBot.\n[UAParser.js is a “JavaScript library to detect Browser, Engine, OS, CPU, and Device](https://www.npmjs.com/package/ua-parser-js)\ntype/model from User-Agent data with relatively small footprint.” Based on its NPM stats, it\nhas 7 million weekly downloads.\n\nThe DanaBot malware was downloaded from:\n\n_hxxps://citationsherbe\\.at/sdd.dll_\n\nThe packed/crypted loader component has a SHA-256 hash of:\n\n_[2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd](https://www.virustotal.com/gui/file/2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd)_\n\nThe loader downloads a main component which has a SHA-256 of:\n\n_[77ff83cc49d6c1b71c474a17eeaefad0f0a71df0a938190bf9a9a7e22531c292](https://www.virustotal.com/gui/file/77ff83cc49d6c1b71c474a17eeaefad0f0a71df0a938190bf9a9a7e22531c292?nocache=1)_\n\nThe main component was configured with the following configuration:\n\n_Figure 1: DanaBot malware configuration used in supply chain attack_\n\nThe malware was also configured with a backup TOR C2:\n\n\n-----\n\n_bjij7tqwaipwbeig5ubq4xjb6fy7s3lknhkjojo4vdngmqm6namdczad\\.onion_\n\nAs highlighted in Figure 1 above, the affiliate ID for this sample was 40. Based on Zscaler\nThreatLabz tracking, this is a new affiliate to the DanaBot ecosystem. At the time of the\nincident, the affiliate had only configured the malware’s credential stealing component to be\nactive--the person-in-the-browser and webinject bank fraud component was not activated.\n\nWhile the post-infection intentions of the threat actor aren’t known, given the focus on\ncredentials, the size of the attack, and the crimeware landscape being dominated by initial\naccess brokers selling access to ransomware affiliates, this outcome can’t be ruled out.\n\n**Second Large Software Supply Chain Attack (November 4, 2021)**\n\n[As reported by Twitter,](https://twitter.com/nonattributable/status/1456255408201338881) [GitHub, and](https://github.com/advisories/GHSA-73qr-pfmq-6rp8) [others, another NPM package was compromised and](https://github.com/veged/coa/issues/99)\n[used to distribute DanaBot. The package is called “COA” and it “is a parser for command](https://www.npmjs.com/package/coa)\nline options that aim to get maximum profit from formalization your program API”. Based on\nNPM stats, it had almost 9 million weekly downloads. The attack took place on Thursday,\nNovember 4, 2021 and it was by the same DanaBot affiliate ID 40 threat actor as in the\nOctober 22, 2021 attack on “UAParser.js”.\n\nThe DanaBot loader component used in this campaign was distributed from:\n\n_hxxps://pastorcryptograph\\.at/3/sdd.dll_\n\nIt has a SHA-256 hash of:\n\n_[26451f7f6fe297adf6738295b1dcc70f7678434ef21d8b6aad5ec00beb8a72cf](https://www.virustotal.com/gui/file/26451f7f6fe297adf6738295b1dcc70f7678434ef21d8b6aad5ec00beb8a72cf/details)_\n\nand was used to download a DanaBot main component with the SHA-256 hash of:\n\n_[e7c9951f26973c3915ffadced059e629390c2bb55b247e2a1a95effbd7d29204](https://www.virustotal.com/gui/file/e7c9951f26973c3915ffadced059e629390c2bb55b247e2a1a95effbd7d29204/details)_\n\nSimilar to the first incident, the threat actor had only configured the malware’s credential\nstealing component to be active.\n\n**DDoS Attack on Russian Language Electronics Forum**\n\nDanaBot affiliate ID 4 was also active last week. While this affiliate isn’t new, there hasn’t\nbeen a change to their component configurations for some time. On Wednesday October\n20, 2021, the affiliate configured its DanaBot victims to download and execute a new\nexecutable with a SHA-256 hash of:\n\n_[8b64b8bfd9e36cc40c273deccd4301a6c2ab44df03b976530c1bc517d7220bce](https://www.virustotal.com/gui/file/8b64b8bfd9e36cc40c273deccd4301a6c2ab44df03b976530c1bc517d7220bce/detection)_\n\nThe downloaded executable is written in the Delphi programming language and its only\nfunctionality is to implement a bare-bones HTTP-based DDoS attack on a hardcoded IP\naddress and host The template used to generate the HTTP requests is shown in Figure 2:\n\n\n-----\n\n_Figure 2: HTTP request template used in DDoS attack_\n\nAs highlighted in the “Host” header in Figure 2 above, the attack targets a Russian\nlanguage forum focused on the discussion of electronics. The “User-Agent” header,\nhardcoded target, and simple functionality seems to imply that the payload was designed to\nsettle a personal grudge instead of indicating a larger change in the threat actor’s tactics,\ntechniques, and procedures (TTPs).\n\n**Conclusion**\n\nWhile the popularity and activity of DanaBot has declined in recent years, the UAParser.js\nand COA software supply chain attacks shows that the malware is still an active threat. It is\ncurrently unclear whether these attacks were a one-off opportunity for a threat actor or\nwhether this and other activity signals the return of DanaBot and its affiliates.\n\n**Cloud Sandbox Detection**\n\n**MITRE ATT&CK TTP Mapping**\n\n**Tactic** **Technique**\n\n\n-----\n\nT1586 Compromise Accounts\n\nT1195 Supply Chain Compromise\n\nT1204 User Execution\n\nT1555 Credentials from Password Stores\n\nT1003 OS Credential Dumping\n\nT1539 Steal Web Session Cookie\n\nT1115 Clipboard Data\n\nT1573 Encrypted Channel\n\nT1008 Fallback Channels\n\nT1041 Exfiltration Over C2 Channel\n\n**Indicators of Compromise**\n\n**IOC** **Notes**\n\nhxxps://citationsherbe\\.at/sdd.dll October\n22, 2021\naffiliate ID\n40\ndistribution\nURL\n\n2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd October\n22, 2021\naffiliate ID\n40 loader\ncomponent\n\n\n-----\n\n77ff83cc49d6c1b71c474a17eeaefad0f0a71df0a938190bf9a9a7e22531c292 October\n22, 2021\naffiliate ID\n40 main\ncomponent\n\n185.158.250.216:443 October\n22, 2021\naffiliate ID\n40\nconfigured\nC2\n\n194.76.225.46:443 October\n22, 2021\naffiliate ID\n40\nconfigured\nC2\n\n45.11.180.153:443 October\n22, 2021\naffiliate ID\n40\nconfigured\nC2\n\n194.76.225.61:443 October\n22, 2021\naffiliate ID\n40\nconfigured\nC2\n\nbjij7tqwaipwbeig5ubq4xjb6fy7s3lknhkjojo4vdngmqm6namdczad\\.onion October\n22, 2021\naffiliate ID\n40\nconfigured\nbackup C2\n\n\n-----\n\nhxxps://pastorcryptograph\\.at/3/sdd.dll November\n4, 2021\naffiliate ID\n40\ndistribution\nURL\n\n26451f7f6fe297adf6738295b1dcc70f7678434ef21d8b6aad5ec00beb8a72cf November\n4, 2021\naffiliate ID\n40 loader\ncomponent\n\ne7c9951f26973c3915ffadced059e629390c2bb55b247e2a1a95effbd7d29204 November\n4, 2021\naffiliate ID\n40 main\ncomponent\n\n185.117.90.36:443 November\n4, 2021\naffiliate ID\n40\nconfigured\nC2\n\n193.42.36.59:443 November\n4, 2021\naffiliate ID\n40\nconfigured\nC2\n\n193.56.146.53:443 November\n4, 2021\naffiliate ID\n40\nconfigured\nC2\n\n\n-----\n\n185.106.123.228:443 November\n4, 2021\naffiliate ID\n40\nconfigured\nC2\n\nf4d12a885f3f53e63ac1a34cc563db0efb6d2d1d570317f7c63f0e6b5bf260b2 Recent\nAffiliate ID\n4 loader\ncomponent\n\nad0ccba36cef1de383182f866478abcd8b91f8e060d03e170987431974dc861e Recent\nAffiliate ID\n4 main\ncomponent\n\n192.119.110.73:443 Affiliate ID\n4\nconfigured\nC2\n\n192.236.147.159:443 Affiliate ID\n4\nconfigured\nC2\n\n192.210.222.88:443 Affiliate ID\n4\nconfigured\nC2\n\ngcwr4vcf72vpcrgevcziwb7axooa3n47l57dsiwxvzvcdlt7exsvk5yd.onion Affiliate ID\n4\nconfigured\nbackup C2\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-05 - Spike in DanaBot Malware Activity.pdf"
    ],
    "report_names": [
        "2021-11-05 - Spike in DanaBot Malware Activity.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536132,
    "ts_updated_at": 1743041134,
    "ts_creation_date": 1653765107,
    "ts_modification_date": 1653765107,
    "files": {
        "pdf": "https://archive.orkl.eu/a548e2c24d8c0073e2c779012bda529d277e84a8.pdf",
        "text": "https://archive.orkl.eu/a548e2c24d8c0073e2c779012bda529d277e84a8.txt",
        "img": "https://archive.orkl.eu/a548e2c24d8c0073e2c779012bda529d277e84a8.jpg"
    }
}