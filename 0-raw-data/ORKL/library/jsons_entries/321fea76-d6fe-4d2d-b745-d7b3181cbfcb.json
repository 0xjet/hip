{
    "id": "321fea76-d6fe-4d2d-b745-d7b3181cbfcb",
    "created_at": "2023-01-12T15:06:00.296535Z",
    "updated_at": "2025-03-27T02:09:30.14536Z",
    "deleted_at": null,
    "sha1_hash": "1cb89562cba2bb78554db0b878cb15719d89442a",
    "title": "2010-05-03 - A Brief Look at Zeus-Zbot 2.0",
    "authors": "",
    "file_creation_date": "2022-05-28T19:23:41Z",
    "file_modification_date": "2022-05-28T19:23:41Z",
    "file_size": 95012,
    "plain_text": "# Endpoint Protection\n\n**symantec.com/connect/blogs/brief-look-zeuszbot-20**\n\nZeus/Zbot is one of the most widely known Internet threats today. It’s been around since\n2007 and has evolved over time, and is still in a constant state of being developed into a\nstronger, more prolific Trojan.\n\nA few weeks ago we came across a variant of Zbot representing the fact that it has\nundergone code refactoring and some functional changes in the Trojan's infection technique\nand behavior. The variant is now known as version 2.0 (named after the Trojan builder kit\nversion).\n\nIn overview, for the common PC user, new changes mean that:\n\nYour PC could have multiple infections of Zbot, thereby sending your personal\ninformation to multiple Zbot controllers.\nZbot is aiming for information from different browsers, including Firefox.\nZbot is expanding its ability to run in newer operating systems such as Windows 7.\nZbot is in constant development, so it might be around for few more years to come.\nRemoving Zbot manually isn't going to be straightforward. The same applies for other\n[threats that claim to have a 'Kill Zeus' module.](https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=69591f0a-c8d6-4c76-83bf-7a137a89082d&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\n\nLet’s briefly look at some of the changes in 2.0. For the uninitiated, please read our\n[previously published paper on Zeus entitled “Zeus: King of the Bots.”](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/zeus_king_of_bots.pdf)\n\n**On your “command,” Master**\n\nThe built-in commands supported by the Trojan have changed; below is the\ncomparison table:\n\n\n**Version 2.0 command** **Functionality**\n\n\n**Version 1.x**\n**command**\n\n\n**user_flashplayer_get**\n\n**user_ftpclients_get**\n\n\n**Gets the Flash player data from a user’s**\n**system** **--**\n\n**Steals passwords from FlashFXP,**\n**total_commander, ws_ftp, fileZilla, FAR2,**\n**winscp, ftp_commander, coreFTP, and**\n**smartftp** **Resetgrab**\n\n\n-----\n\n**user_homepage_set**\n\n\n**Set the browser’s home page to desired**\n**URL** **Sethomepage**\n\n\n**user_url_unblock** **Restore access to an attacker-desired URL** **Unblock_url**\n\n**user_url_block** **Disable access to an attacker-desired URL** **Block_url**\n\n**user_certs_remove** **Removes certificate** **--**\n\n**user_certs_get** **Steal digital certificates** **Getcerts**\n\n**user_cookies_remove** **Delete browser cookies** **Delmff (partly)**\n\n\n**user_cookies_get** **Upload cookies**\n\n**user_execute** **Download and execute a file**\n\n\n**Getmff**\n**(partly)**\n\n**Consolidation**\n**of 'Rexec',**\n**'Lexec' &**\n**'Lexeci'**\n\n\n**user_logoff** **Log off user** **--**\n\n**bot_bc_remove** **Removes a back door connection** **Bc_del**\n\n\n**bot_bc_add**\n\n**bot_update**\n\n\n**Initiate back door by back-connecting to a**\n**server and allow arbitrary command**\n**execution via the command shell** **Bc_add**\n\n\n**Download and update bot config (sets in**\n**registry as well), download and execute**\n**new bot installer**\n\n\n**Consolidation**\n**of 'Upcfg' &**\n**'Rename_bot'**\n\n\n**bot_uninstall** **Remove bot altogether** **--**\n\n**os_reboot** **Reboot the computers** **Reboot**\n\n**os_shutdown** **Shut down the computer** **Shutdown**\n\n\n**user_destroy**\n\n**fs_search_remove**\n\n**fs_search_add**\n\n**fs_path_get**\n\n\n**(not implemented) possibly to delete all**\n**user files** **Kos**\n\n**(not implemented) possibly to remove file**\n**mask for local search** **Delsf**\n\n**(not implemented) possibly to add a file**\n**mask for a local search** **Addsf**\n\n**(not implemented) possibly to upload a file**\n**or folder** **Getfile**\n\n\n-----\n\n**bot_httpinject_disable**\n\n**bot_httpinject_enable**\n\n\n**(not implemented) possibly to disable http**\n**inject** **Block_fake**\n\n**(not implemented) possibly to enable http**\n**inject** **Unlock_url**\n\n\n_Built-in commands in 2.0 compared to 1.x_\n\nSome of the commands in 2.0 aren’t implemented yet, which only leads us to one\nconclusion: it is under continuous development.\n\n**Sneak in**\n\nWhen executed, initial thread injection into other processes is as follows:\n\nThe processes “explorer.exe”, “taskeng.exe”, and “taskhost.exe” are injected with the\nbelow four threads:\n\n1. A thread to open a back door channel.\n\n2. A thread to download threat-related data.\n\n3. A thread to inject into other running processes.\n\n4. A thread to perform bot instructions from config stored in the registry.\n\nA single thread is injected into the processes “rdpclip.exe”, “ctfmon.exe”, and\n“wscntfy.exe” (the single thread’s job is to inject into every other process).\n\n**The “Hijack”**\n\nThe APIs shown in the table below are hijacked from the injected process memory. We\ncan see that version 2.0 is now able to hook NSPR APIs (used by Mozilla Firefox) to\nread and write to data that it receives and sends:\n\n**Zbot 1.x hooked APIs**\n\n**Zbot 2.0 hooked APIs**\n\n\n-----\n\nWININET.DLL\n\nHttpSendRequestW\nHttpSendRequestA\nHttpSendRequestExW\nHttpSendRequestExA\nInternetReadFile\nInternetReadFileExA\nInternetQueryDataAvailable\nInternetCloseHandle\nHttpQueryInfoA\n\nWS2_32.DLL\n\nclosesocket\nsend\nWSASend\n\nUSER32.DLL\n\nTranslateMessage\nGetClipboardData\n\nNSPR4.DLL\n\nPR_OpenTCPSocket\nPR_Close\nPR_Read\nPR_Write\n\nCRYPT32.DLL\n\nPFXImportCertStore\n\nNTDLL.DLL\n\nLdrLoadDll\nNtCreateThread\n\nKERNEL32.DLL\n\nGetFileAttributesEx\n\n\n-----\n\nWININET.DLL\n\nHttpSendRequestW\nHttpSendRequestA\nHttpSendRequestExW\nHttpSendRequestExA\nInternetReadFile\nInternetReadFileExW\nInternetReadFileExA\nInternetQueryDataAvailable\nInternetCloseHandle\n\nWS2_32.DLL and WSOCK32.DLL\n\nsend\nsendto\nclosesocket\nWSASend\nWSASendTo\n\nUSER32.DLL\n\nGetMessageW\nGetMessageA\nPeekMessageW\nPeekMessageA\nGetClipboardData\n\nHere is an image showing hooked APIs in process memory:\n\n**“Drop” zone**\n\nZbot version 2.0 drops another smaller .exe of equivalent functionality but packed by a\ndifferent executable packer into %User Profile%\\Application Data\\[randomfolder]\\\n\n[random name].exe (where [random name], [random folder] is generated based on\nMersenne's pseudo-random number generator).\n\nFor comparison’s sake, version 1.x copied itself to a fixed path with a constant filename\nunder “%System%” and added some random content in its appended data every time,\nmaking its file hash different.\n\n**Revival**\n\n\n-----\n\nVersion 2.0 adds the following registry key:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"\n{[VOL_GUID]}\" = \"%User Profile%\\Application Data\\[random folder]\\[random\nname].exe\"\n\n(Where [VOL_GUID] is the volume GUID of WINDOWS mount point. And [random name],\n\n[random folder] is generated based on Mersenne's Pseudo random number generator.)\n\nThis is compared to version 1.x, which added\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon\\\"Userinit\" = \"%System%\\userinit.exe, %System%\\\n<threatfilename>.exe\"\n\n**“Exclusive” rights**\n\nMutex and PIPE names used for the exclusion and inter-thread communications in 2.0\nnow use GUID (instead of fixed Mutex names, as in 1.x). This enables multiple\ninstances of Zbot, created by different bot builders, to run alongside one another\nsimultaneously.\n\n**“Phish” me not**\n\nDisables Internet Explorer’s phishing filter by setting the following keys:\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\PhishingFilter\\\"Enabled\"\n= dword:0\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\InternetExplorer\\PhishingFilter\\\"EnabledV8\" =\ndword:0\n\n**“Passwords” are (not) safe**\n\nVersion 2.0 steals passwords from the following FTP clients, which is similar to what\nwas seen in version 1.x:\n\n“FlashFXP”, “total_commander”, ”ws_ftp”, “fileZilla”, “FAR2”, “winscp”, “ftp_commander”,\n“coreFTP” & “smartftp”.\n\n**“Log” my move**\n\nIt can also take screen shots and log keystrokes (by hooking API 'TranslateMessage')\n\n\n-----\n\n**All your “data” belongs to me**\n\nIt adds the following extra headers to the http communication through hijacked API’s\n'HttpSendRequestW', 'HttpSendRequestA', 'HttpSendRequestExW', and\n'HttpSendRequestExA'.\n\n\"Accept-Encoding: identity\\r\\n\"\n\"TE:\\r\\n\"\n\"If-Modified-Since:\\r\\n\"\n\nAll of the network data that is sent out through the APIs 'send' and 'WSASend' is\nuploaded to a pre-configured anonymous FTP site.\n\n**Keys are no longer “private”**\n\nAttempts to steal private keys from certificates by hooking API 'PFXImportCertStore',\nsimilar to version 1.x.\n\n**“Change” is inevitable**\n\nBy hooking the ‘PR_Read’ and ‘PR_Write’ APIs of NSPR4.dll, it is able to modify and\nread data sent by Mozilla Firefox, whereas versions 1.x could not. This means it has\nthe ability to inject code forms and code into banking websites browsed through by\nMozilla Firefox.\n\n**For the sake of “argument”**\n\nSomewhat unusually, Zbot 2.0 also accepts command line arguments. It accepts \"-f\"\nand “-n” as parameters. “-f” is used to alter registry use and “-n” is to prevent dropper\nthreats from being self-deleted. This was probably used during the testing phase of\nZbot and accidentally included in this release.\n\n**A little per-“spec”-tive**\n\nThe Zeus config file has undergone changes too. Additional layers of encryption were\nadded to deter security analysts—below are a few screen shots of a decoded config\nfile:\n\nThe screenshot above shows some search strings that are used by Zeus to collect user\ninformation from various popular sites.\n\n\n-----\n\nThe above screenshot of a config file shows Zeus s malicious JavaScript code that will be\ninjected into the web browser in order to steal some private questions and answers that the\nuser has provided to a banking website.\n\nThe above screenshot shows script code that tricks users into giving away their bank PIN\nnumbers. Such code injection into a Web browser can trick an everyday user into believing\nthat their bank is legitimately requesting the information.\n\nSymantec’s protection summary on Trojan.Zbot can be found at\n[http://www.symantec.com/security_response/writeup.jsp?docid=2010-011016-3514-99. We](http://www.symantec.com/security_response/writeup.jsp?docid=2010-011016-3514-99)\nat Symantec continuously monitor and track such Trojans and update generic detection\nsignatures as soon as new variants are released. Please, as always, keep your antivirus and\nIDS/IPS products up to date to ensure the best possible protection against threats.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2010/2010-05-03 - A Brief Look at Zeus-Zbot 2.0.pdf"
    ],
    "report_names": [
        "2010-05-03 - A Brief Look at Zeus-Zbot 2.0.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "64ca1755-3883-4173-8e0a-6e5cf92faafd",
            "created_at": "2022-10-25T15:50:23.636456Z",
            "updated_at": "2025-03-27T02:00:55.51077Z",
            "deleted_at": null,
            "main_name": "Deep Panda",
            "aliases": [
                "Deep Panda",
                "Shell Crew",
                "KungFu Kittens",
                "PinkPanther",
                "Black Vine"
            ],
            "source_name": "MITRE:Deep Panda",
            "tools": [
                "Mivast",
                "StreamEx",
                "Sakula",
                "Tasklist",
                "Derusbi"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535960,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653765821,
    "ts_modification_date": 1653765821,
    "files": {
        "pdf": "https://archive.orkl.eu/1cb89562cba2bb78554db0b878cb15719d89442a.pdf",
        "text": "https://archive.orkl.eu/1cb89562cba2bb78554db0b878cb15719d89442a.txt",
        "img": "https://archive.orkl.eu/1cb89562cba2bb78554db0b878cb15719d89442a.jpg"
    }
}