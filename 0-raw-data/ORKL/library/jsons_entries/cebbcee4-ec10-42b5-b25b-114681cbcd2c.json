{
    "id": "cebbcee4-ec10-42b5-b25b-114681cbcd2c",
    "created_at": "2023-01-12T15:10:35.636022Z",
    "updated_at": "2025-03-27T02:05:28.232831Z",
    "deleted_at": null,
    "sha1_hash": "a286341e0c5d2af2336cbbf69266332ef3a3f34d",
    "title": "2020-07-02 - GoldenSpy Chapter 3- New and Improved Uninstaller",
    "authors": "",
    "file_creation_date": "2022-05-28T02:49:53Z",
    "file_modification_date": "2022-05-28T02:49:53Z",
    "file_size": 118644,
    "plain_text": "# GoldenSpy Chapter 3: New and Improved Uninstaller\n\n**[trustwave.com/en-us/resources/blogs/spiderlabs-blog/goldenspy-chapter-3-new-and-improved-uninstaller/](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/goldenspy-chapter-3-new-and-improved-uninstaller/)**\n\n## Background:\n\nOn June 25, Trustwaveth [SpiderLabs published our research on a backdoor, dubbed](https://www.trustwave.com/en-us/company/about-us/spiderlabs/)\n[GoldenSpy, that was hidden in required Chinese tax software. See the details here.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/the-golden-tax-department-and-the-emergence-of-goldenspy-malware/)\nOn June 30, we published an analysis of a new binary that the tax software isth\ndeployed and executed to delete and remove all traces that GoldenSpy existed. We\n[also provided a YARA rule to proactively identify the uninstaller. See the details here.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/goldenspy-chapter-two-the-uninstaller/)\nThis blog shows our analysis of a new binary, now being distributed by Intelligent Tax\nsoftware, that is identical in operations to the original GoldenSpy Uninstallers, but\nspecifically designed to evade detection by the YARA rule provided in our blog.\n\n\nThere is a constant battle between cyber adversaries and the security community,\nhappening every minute of every day. Offensive operations and defensive countermeasures\nare constantly being launched back and forth, often to the massive detriment to the victim of\na successful attack. But defenders are constantly monitoring for new offensive techniques\nand countering with innovative defensive measures to detect, disrupt, and deter the cyberattacks. I have tremendous respect for both sides of this battle as each new strike shows\ncreativity, innovation, and intelligence. However, rarely in my career have I ever witnessed\nsuch a clear demonstration of the back and forth than the GoldenSpy campaign that\nSpiderLabs has been reporting on.\n\n\n-----\n\nTo be fair, SpiderLabs does not know if this backdoor would have been used for malicious\npurposes or if the uninstall operation is anything more than an attempted clean-up by the\ncompany. The secretive nature of the clean-up and the remaining risk of the tax software\nbeing able to arbitrarily execute any code it likes is undeniable, but we are not claiming\nconfirmed malicious intent. Just stating the facts.\n\nThe back and forth went like this: they planted a secret backdoor in the tax software, we\nidentified it and published our research. They then secretly deployed a new binary to\nremove any trace that the backdoor ever existed, we reported on that as well and provided\na method to detect it. Within hours, they responded with a new version that evades our\ndetection method. Now, we report the new binary and provide an updated detection\nmethod. It's a real soap opera.\n\nThis is a true example of the cat and mouse game between cyber adversaries and the\nsecurity community, the Intelligent Tax software now deploys and executes a third version of\nthe GoldenSpy uninstaller. Based on our analysis, the new version conducts identical\noperations to delete all traces of GoldenSpy, but this one is specifically designed to evade\nthe YARA rule we provided in our GoldenSpy Chapter 2 The Uninstaller blog. Our rule was\nbased on identifying specific encoded and plain-text variables existing in both versions of\nthe GoldenSpy, this new version alters its use of base64 encoding so that it will not be\ndetected by our original YARA rule. This is the only difference in the new version.\n\nThe new executable was compiled on 1 July 2020 at 15:52:46 GMT. It is called AWX.exe,\nas was the original. We are providing the new YARA rule below, which will identify all\nvariants of the GoldenSpy uninstaller. (At least all that we know of now, who knows what\ntomorrow will bring…) We appreciate the patronage of our blog by the GoldenSpy\ndevelopers. Please stay tuned for future posts.\n\n## Binary Details:\n\nFile Name  : AWX.EXE\n\nSHA256 :\n10E8C9ADE8687CFB2BADB23C90E8F025C2B2E35D0934D287E19C2B14746395C2\n\nMD5  : 573ADB1569A08472094F0CFBB6264360\n\nCRC32 : 739DA9B2\n\nFormat   : Portable executable for 80386 (PE)\n\nTimestamp  : 5EFCB14E (Wed Jul 01 15:52:46 2020)\n\nPDB File Name : D:\\日常工作\\客户端软件\\VCProject\\dgs\\Release\\AWX.pdb\n\nOS type : MS Windows\n\n\n-----\n\nApplication type: Executable 32bit\n\n## GoldenSpy Uninstaller YARA rule – Version 2\n\nrule Goldenspy_Uninstaller_v2\n\n{\nmeta:\n\nauthor = \"SpiderLabs\"\n\nmalware_family = \"GoldenSpy\"\n\nfiletype = \"exe_dll\"\n\nversion = \"3.0\"\n\nstrings:\n$str1 = \"taskkill /IM svm.exe /IM svmm.exe /F\" ascii\n\n$str2 = \"\\\\svm.exe -stopProtect\" ascii\n\n$str3 = \"\\\\svmm.exe -u\" ascii\n\n$str4 = \"\\\\VCProject\\\\dgs\\\\Release\\\\\" ascii\n\n$str5 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\svm\" ascii\n\n$str6 = \"\\\\svmm.exe -stopProtect\" ascii\n\n$str7 = \"\\\\svm.exe -u\" ascii\n\n$str8 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\App Paths\\\\svm.exe\" ascii\n\n$str9 = \"dGFza2tpbGwgL0lNIHN2bS5leGUgL0lNIHN2bW0uZXhlIC9GIA\" ascii\n\n$str10 = \"c3ZtLmV4ZSAtc3RvcFByb3RlY3Q\" ascii\n\n$str11 = \"XHN2bW0uZXhlIC11\" ascii\n\n$str12 =\n\"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWx\nascii\n\n$str13 =\n\"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQXBwIFBhdGhz\nascii\n\n$str14 = \"XHN2bS5leGUgLXU\" ascii\n\n$str15 = \"c3ZtbS5leGUgLXN0b3BQcm90ZWN0\" ascii\n\ncondition:\n\n(uint16(0) == 0x5A4D) and 4 of ($str*)\n\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-02 - GoldenSpy Chapter 3- New and Improved Uninstaller.pdf"
    ],
    "report_names": [
        "2020-07-02 - GoldenSpy Chapter 3- New and Improved Uninstaller.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536235,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653706193,
    "ts_modification_date": 1653706193,
    "files": {
        "pdf": "https://archive.orkl.eu/a286341e0c5d2af2336cbbf69266332ef3a3f34d.pdf",
        "text": "https://archive.orkl.eu/a286341e0c5d2af2336cbbf69266332ef3a3f34d.txt",
        "img": "https://archive.orkl.eu/a286341e0c5d2af2336cbbf69266332ef3a3f34d.jpg"
    }
}