{
    "id": "ab3967aa-287e-4f9d-9ee7-5eeef14df85d",
    "created_at": "2023-01-12T15:02:06.891433Z",
    "updated_at": "2025-03-27T02:16:41.181528Z",
    "deleted_at": null,
    "sha1_hash": "fab30a166daf361db5cd85c13de1824d872b391a",
    "title": "2021-02-08 - Recommendations Following the Oldsmar Water Treatment Facility Cyber Attack",
    "authors": "",
    "file_creation_date": "2022-05-28T19:24:31Z",
    "file_modification_date": "2022-05-28T19:24:31Z",
    "file_size": 17459198,
    "plain_text": "# Recommendations Following the Oldsmar Water Treatment Facility Cyber Attack\n\n**[dragos.com/blog/industry-news/recommendations-following-the-oldsmar-water-treatment-facility-cyber-attack/](https://www.dragos.com/blog/industry-news/recommendations-following-the-oldsmar-water-treatment-facility-cyber-attack/)**\n\nFebruary 9, 2021\n\nBlog Post\n\n\n-----\n\n-----\n\nBy Gus Serino, Ben Miller\n\n02.08.21\n\n\n-----\n\n[Today a press conference was held by the City of Oldsmar where they disclosed ‘the](https://www.youtube.com/watch?v=MkXDSOgLQ6M&ab_channel=PinellasSheriff)\nunlawful intrusion of the City of Oldsmar’s water treatment system.’ The City of\nOldsmar should be commended on their transparent briefing and level of detail. The case\nis evolving and details are ongoing but this blog is intended to share what’s known currently\nwith some defensive recommendations.\n\n## Details of What Happened\n\nIt has been publicly acknowledged that an operator machine had a remote access software\npackage– TeamViewer- installed and accessible to the Internet. This led to manipulation\nof control set points for the dosing rate of Sodium Hydroxide (NaOH) into the water. NaOH\nis a chemical often used in drinking water treatment used to adjust pH\nand alkalinity. Although an important component of the drinking water treatment process,\nNaOH can be a hazardous chemical to water consumers if concentrations exist in excess of\nsafe operating parameters.\n\nTypically, water systems are engineered with many safeguards to keep parameters within\nacceptable limits not the least of which is trained and licensed drinking water treatment\noperators. In this incident, the adversary raised the NaOH dose setpoint from its normal\nsetting of 100 parts-per-million (ppm) to 11,100ppm, thereby temporarily increasing the\namount of chemical being added to the water. It was reported that the water treatment\noperator on duty observed the mouse moving on the operating screen, making\nchanges, and then exiting the system. It was also reported that the operator identified the\nincident and restored the normal operating parameters fast enough so that pH monitoring\nalarms did not detect a level beyond acceptable parameters.\n\nHad the operator not observed the attacker actively manipulating the screen, it\nis possible that several other mechanisms in the water treatment plant control and\nmonitoring system would have alerted plant staff to the condition. However, it is also entirely\npossible that this action could have resulted in people getting sick or potentially even\ndeath. The control systems in modern water treatment\nplants use process instrumentation that continuously monitor water quality\nparameters (e.g. pH) to carefully control the addition of chemicals and provide real-time\nalerts when those parameters go outside acceptable limits; these critical parameters\nare typically monitored at multiple points throughout the treatment process and in the\ntransmission and distribution systems.\n\nHowever, even these safeguards are not adversary proof. As with all critical industrial\nprocesses, Dragos recommends that organizations proactively monitor for several key\nevents within their control systems including changes to setpoints of critical process\nparameters, changes to control logic, and disabling capabilities for remote edits to process\n\n\n-----\n\ncontrol logic by default. Additionally, organizations should consider utilizing distinct safety\nsystems, isolated from the control network, to prevent incidents that could result in harm\nto personnel or the populations dependent on their service.\n\n## What is TeamViewer?\n\nTeamViewer is a legitimate software package that is directly installed on a Windows host\nthat allows for easy connectivity from anywhere. Its ease of use has allowed it to\nincreasingly be used in industrial environments and, while legitimate software, may be\nunauthorized or rogue software.\n\nRemote access to industrial facilities can be architected safely. But the best architecture can\nalso be circumvented with unapproved software such as TeamViewer. This is where\nvisibility into what software, vulnerabilities, and behaviors are necessary in your industrial\nenvironments.\n\n[If you don’t have OT visibility software (such as the Dragos Platform) you can manually](https://www.dragos.com/platform/)\nassess if TeamViewer is in your environment.\n\nTeamViewer, by default, uses both TCP/5938 and UDP/5938 ports to establish connections\nwith TeamViewer. If those are blocked by a firewall or other perimeter system TeamViewer\nfalls back to TCP/443 and then TCP/80 (commonly used for HTTPS and HTTP\ntraffic). These connections are managed by TeamViewer’s cloud environment and will\nresolve hosts going to *.teamviewer.com (The Dragos team looks for the specific hosts\nmasterN.teamviewer.com, pingN.teamviewer.com, or server.teamviewer.com where N is\na one- or double-digit number such as master9.teamviewer.com or\nrouter15.teamviewer.com).\n\n## Recommendations\n\nManually identify software installed on hosts, particularly those critical to the industrial\nenvironment such as operator workstations- such as TeamViewer or VNC. Accessing\nthis on a host-by-host basis may not be practical but it is comprehensive.\n\n\n-----\n\nBeyond host data, there are a variety of network traffic sources to help identify\nTeamViewer. Most environments are not configured where centralized logging is\noccurring and can be a manual process. We recommend:\n\nUse DNS logging to identify outbound DNS resolution to *.teamviewer.com\nEncrypted communications to teamviewer.com will have a X509 certificate for\n*.teamviewer.com\nUse perimeter logging or other network logging to identify external\ncommunications via TCP/5938 and UDP/5938.\nTalk to the operations staff or IT staff at the site to determine if other remote\nsoftware tools such as virtual private networks are used. If so, perform searches\nfor those tools and where possible utilize multi-factor authentication on remote\nconnections.\nFrom a prevention perspective, blocking these communications, and all egress\ncommunications that are not explicitly approved, will prevent remote access solutions\nlike TeamViewer. However, ensure that you talk with plant personnel before doing this\nand after blocking any connections be available to reverse the changes if something\nwas necessary that they did not know about.\n\n## Architecting Secure Remote Access for OT/ICS\n\nIn March of 2020, in recognition of the early days of the global pandemic, we released a\n[blog focusing on secure remote access titled A Matter of Trust: Remote Access for ICS. All](https://www.dragos.com/blog/industry-news/a-matter-of-trust-remote-access-for-ics/)\nof the recommendations in that post still apply today and are relevant:\n\nEngineering and OT teams should evaluate what systems can leverage remote\naccess.\nRemote access requirements should be determined, including what IP addresses,\nwhat communication types, and what processes can be monitored. All others should\nbe disabled by default. Remote access including process control should be limited as\nmuch as possible.\nUser-initiated access should require multi-factor authentication from the Internet to a\nDMZ with a dedicated jump host for ICS-specific communications. This system should\nleverage its own identity and access management system.\nFrom the DMZ, after authentication, user-initiated remote access should follow a\ntrusted path to the industrial control system—where the user will authenticate again,\nthis time using the local identity and access management solution for the industrial\ncontrol system.\nAll remote access communications should be logged and monitored. Various detection\ntechniques could be implemented on remote access systems, like looking for brute\nforce attempts or specific exploits for known vulnerabilities—but only if logging and\nmonitoring is used.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-08 - Recommendations Following the Oldsmar Water Treatment Facility Cyber Attack.pdf"
    ],
    "report_names": [
        "2021-02-08 - Recommendations Following the Oldsmar Water Treatment Facility Cyber Attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4ac28d1-66eb-4f2d-9f9b-a72394349fd0",
            "created_at": "2023-01-06T13:46:38.667954Z",
            "updated_at": "2025-03-27T02:00:02.887442Z",
            "deleted_at": null,
            "main_name": "APT4",
            "aliases": [
                "PLA Navy",
                "MAVERICK PANDA",
                "BRONZE EDISON",
                "SODIUM",
                "Salmon Typhoon"
            ],
            "source_name": "MISPGALAXY:APT4",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6fbff48b-7a3e-4e54-ac22-b10f11e32337",
            "created_at": "2022-10-25T16:07:23.318008Z",
            "updated_at": "2025-03-27T02:02:09.734465Z",
            "deleted_at": null,
            "main_name": "APT 4",
            "aliases": [
                "APT 4",
                "Bronze Edison",
                "Maverick Panda",
                "Salmon Typhoo",
                "Sodium",
                "Sykipot",
                "TG-0623",
                "Wisp Team"
            ],
            "source_name": "ETDA:APT 4",
            "tools": [
                "Getkys",
                "Sykipot",
                "Wkysol",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535726,
    "ts_updated_at": 1743041801,
    "ts_creation_date": 1653765871,
    "ts_modification_date": 1653765871,
    "files": {
        "pdf": "https://archive.orkl.eu/fab30a166daf361db5cd85c13de1824d872b391a.pdf",
        "text": "https://archive.orkl.eu/fab30a166daf361db5cd85c13de1824d872b391a.txt",
        "img": "https://archive.orkl.eu/fab30a166daf361db5cd85c13de1824d872b391a.jpg"
    }
}