{
    "id": "e45ff82b-dd71-462f-b947-2172041f7ea1",
    "created_at": "2022-10-25T16:48:13.648797Z",
    "updated_at": "2025-03-27T02:16:16.989752Z",
    "deleted_at": null,
    "sha1_hash": "f6800cab68f7c1b95614a48cacd45ec079c32bd9",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-09-15T07:20:23Z",
    "file_modification_date": "2021-09-15T07:20:23Z",
    "file_size": 3994640,
    "plain_text": "# Operation ‘Harvest’: A Deep Dive into a Long-term Campaign\n\n**[mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign](https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/)**\n\nSeptember 15, 2021\n\n[By Christiaan Beek on Sep 14, 2021](https://www.mcafee.com/blogs/author/christiaan-beek/)\n_[A special thanks to our Professional Services’ IR team, ShadowServer, for historical](https://www.shadowserver.org/)_\n_[context on C2 domains, and Thomas Roccia/Leandro Velasco for malware analysis](https://www.mcafee.com/blogs/author/thomas-roccia/)_\n_support._\n\n## Executive Summary\n\nFollowing a recent Incident Response, McAfee Enterprise‘s Advanced Threat Research\n(ATR) team worked with its Professional Services IR team to support a case that initially\nstarted as a malware incident but ultimately turned out to be a long-term cyber-attack.\n\nFrom a cyber-intelligence perspective, one of the biggest challenges is having information\non the tools, techniques, and procedures (TTPs) an adversary is using and then keeping\nthem up to date. Within ATR we typically monitor many adversaries for years and collect\nand store data, ranging from indicators of compromise (IOCs) to the TTPs.\n\nIn this report, ATR provides a deep insight into this long-term campaign where we will\nmap out our findings against the Enterprise MITRE ATT&CK model. There will be parts\nthat are censored since we respect the confidentiality of the victim. We will also zoom in\nand look at how the translation to the MITRE Techniques, historical context, and\nevidence artifacts like PlugX and Winnti malware led to a link with another campaign,\nwhich we highly trust to be executed by the same adversary.\n\nIOCs that could be shared are at the end of this document.\n\n\n-----\n\nMcAfee customers are protected from the malware/tools described in this blog. MVISION\nInsights customers will have the full details, IOCs and TTPs shared via their dashboard.\nMVISION Endpoint, EDR and UCE platforms provide signature and behavior-based\nprevention and detection capability for many of the techniques used in this attack. A\nmore detailed blog with specific recommendations on using the McAfee portfolio and\n[integrated partner solutions to defend against this attack can be found here.](https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/mcafee-defenders-blog-operation-harvest/)\n\n## Technical Analysis\n\n### Initial Infection Vectors [TA0001]\n\nForensic investigations identified that the actor established initial access by\n[compromising the victim’s web server [T1190]. On the webserver, software was installed](https://attack.mitre.org/techniques/T1190/)\n[to maintain the presence and storage of tools [T1105] that would be used to gather](https://attack.mitre.org/techniques/T1105/)\n[information about the victim’s network [T1083] and lateral movement/execution of files](https://attack.mitre.org/techniques/T1083/)\n\n[[T1570] [T1569.002]. Examples of the tools discovered are PSexec, Procdump, and](https://attack.mitre.org/techniques/T1570/)\nMimikatz.\n\n### Privilege Escalation and Persistence [TA0004, TA0003]\n\nThe adversary has been observed using multiple privilege escalation and persistence\ntechniques during the period of investigation and presence in the network. We will\nhighlight a few in each category.\n\nBesides the use of Mimikatz to dump credentials, the adversaries used two tools for\n[privilege escalations [T1068]. One of the tools was “RottenPotato”. This is an open-source](https://attack.mitre.org/techniques/T1068/)\ntool that is used to get a handle to a privileged token, for example, “NT\nAUTHORITY\\SYSTEM”, to be able to execute tasks with System rights.\n\nExample of RottenPotato on elevating these rights:\n\n\n-----\n\nFigure 1 RottenPotato\n\nThe second tool discovered, “BadPotato”, is another open-source tool that can be used to\nelevate user rights towards System rights.\n\nFigure 2 BadPotato\n\n\n-----\n\nThe BadPotato code can be found on GitHub where it is offered as a Visual Studio project.\nWe inspected the adversary’s compiled version using DotPeek and hunted for artifacts in\nthe code. Inspecting the File (COFF) header, we observed the file’s compilation\ntimestamp:\n\n_TimeDateStamp: 05/12/2020 08:23:47 – Date and time the image was created_\n\n### PlugX\n\nAnother major and characteristic privilege escalation technique the adversary used in this\nlong-term campaign was the malware PlugX as a backdoor. PlugX makes use of the\n[technique “DLL Sideloading” [T1574.002]. PlugX was observed as usual where a single](https://attack.mitre.org/techniques/T1574/)\n(RAR) executable contained the three parts:\n\nValid executable.\nAssociated DLL with the hook towards the payload.\nPayload file with the config to communicate with Command & Control Server (C2).\n\nThe adversary used either the standalone version or distributed three files on different\nassets in the network to gain remote control of those assets. The samples discovered and\nanalyzed were communicating towards two domains. Both domains were registered\nduring the time of the campaign.\n\nOne of the PlugX samples consisted of the following three parts:\n\nFilename Hashes\n\nHPCustPartic.exe SHA256:\n8857232077b4b0f0e4a2c3bb5717fd65079209784f41694f8e1b469e34754cf6\n\nHPCustPartUI.dll SHA256:\n0ee5b19ea38bb52d8ba4c7f05fa1ddf95a4f9c2c93b05aa887c5854653248560\n\nHPCustPartic.bin SHA256:\n008f7b98c2453507c45dacd4a7a7c1b372b5fafc9945db214c622c8d21d29775\n\nThe .exe file is a valid and signed executable and, in this case, an executable from HP (HP\nCustomer participation). We also observed other valid executables being used, ranging\nfrom AV vendors to video software. When the executable is run, the DLL next to it is\nloaded. The DLL is valid but contains a small hook towards the payload which, in our\ncase, is the .bin file. The DLL loads the PlugX config and injects it into a process.\n\nWe executed the samples in a test setup and dumped the memory of the machine to\nconduct memory analysis with volatility. After the basic forensically sound steps, we ran\nthe malfind plugin to detect possible injected code in a process. From the redacted output\nof the plugin, we observed the following values for the process with possible injected\ncode:\n\n\n-----\n\n_Process: svchost.exe Pid: 860 Address: 0xb50000_\n\n_Process: explorer.exe Pid: 2752 Address: 0x56a000_\n\n_Process: svchost.exe Pid: 1176 Address: 0x80000_\n\n_Process: svchost.exe Pid: 1176 Address: 0x190000_\n\n_Process: rundll32.exe Pid: 3784 Address: 0xd0000_\n\n_Process: rundll32.exe Pid: 3784 Address: 0x220000_\n\nOne observation is the mention of the SVCHOST process with a ProcessID value of 1176\nthat is mentioned twice but with different addresses. This is similar to the\nRUNDLL32.exe that is mentioned twice with PID 3785 and different addresses. One way\nto identify what malware may have been used is to dump these processes with the\nrelevant PID using the procdump module, upload them to an online analysis service and\nwait for the results. Since this is a very sensitive case, we took a different approach. Using\nthe best of both worlds (volatility and Yara) we used a ruleset that consists of malware\npatterns observed in memory over time. Running this ruleset over the data in the memory\ndump revealed the following (redacted for the sake of readability) output:\n\nFigure 3 Output Yarascan memory dump\n\nThe output of the Yara rule scan (and there was way more output) confirmed the presence\nof PlugX module code in PID 1176 of the SVCHOST service. Also, the rule was triggered\non PID 3784, which belonged to RUNDLL32.exe.\n\nInvestigating the dumps after dynamic analysis, we observed two domain names used for\nC2 traffic:\n\nbrushupdata.com\nbrushupdata.com\n\n\n-----\n\nIn particular, we saw the following hardcoded value that might be another payload being\ndownloaded:\n\n_sery.brushupdata.com/CE1BC21B4340FEC2B8663B69_\n\n[The PlugX families we observed used DNS [T1071.001] [T1071.004] as the transport](https://attack.mitre.org/techniques/T1071/001/)\nchannel for C2 traffic, in particular TXT queries. Investigating the traffic from our\nsamples, we observed the check-in-signature (“20 2A 2F 2A 0D”) that is typical for PlugX\nnetwork traffic:\n\n_00000000:      47 45 54 20 2F 42 34 42 42 44 43 43 30 32 39 45_\n\n_00000010:      31 31 39 37 31 39 46 30 36 35 36 32 32 20 48 54_\n\n_00000020:      54 50 2F 31 2E 31 0D 0A 41 63 63 65 70 74 3A 20_\n\n_00000030:      2A 2F 2A 0D_ _0A 43 6F 6F 6B 69 65 3A 20 44 36 43_\n\n_00000040:      57 50 2B 56 5A 47 6D 59 6B 6D 64 6D 64 64 58 55_\n\n_00000050:      71 58 4D 31 71 31 6A 41 3D 0D 0A 55 73 65 72 2D_\n\nDuring our analysis of the different PlugX samples discovered, the domain names as\nmentioned above stayed the same, though the payload values were different. For\nexample:\n\nhxxp://sery.brushupdata.com/B4BBDCC029E119719F065622\nhxxp://sery.brushupdata.com/07FDB1B97D22EE6AF2482B1B\nhxxp://sery.brushupdata.com/273CDC0B9C6218BC1187556D\n\nOther PlugX samples we observed injected themselves into Windows Media Player and\nstarted a connection with the following two domains:\n\nasmlbigip.com\nasmlbigip.com\n\n### Hello Winnti\n\n[Another mechanism observed was to start a program as a service [T1543.003] on the](https://attack.mitre.org/techniques/T1543/)\nOperating System with the acquired System rights by using the *Potato tools. The file the\nadversary was using seemed to be a backdoor that was using the DLL file format\n(2458562ca2f6fabddae8385cb817c172).\n\nThe DLL is used to create a malicious service and its name is “service.dll”. The name of\nthe created service, “SysmainUpdate”, is usurping the name of the legitimate service\n“SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch\nservice. The dll is run using the command “rundll32.exe SuperFrtch.dll, #1”. The export\nfunction has the name  “WwanSvcMain”.\n\n\n-----\n\nThe model uses the persistence technique utilizing svchost.exe with service.dll to install a\nrogue service. It appears that the dll employs several mechanisms to fingerprint the\ntargeted system and avoid analysis in the sandbox, making analysis more difficult. The\nDLL embeds several obfuscated strings decoded when running. Once the fingerprinting\nhas been done, the malware will install the malicious service using the API\nRegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA. A description\n[of the technique can be found here.](https://www.ired.team/offensive-security/persistence/persisting-in-%20%20svchost.exe-with-a-service-dll-servicemain)\n\nThe malware also decrypts and injects the payload in memory. The following screenshot\nshows the routine decryption.\n\nFigure 4 Decryption routine\n\nWhen we analyzed this unique routine, we discovered similarities and the mention of it in\n[a publication that can be read here. The malware described in the article is attributed to](https://www.trendmicro.com/en_us/research/17/c/winnti-abuses-%20%20github.html)\nthe Winnti malware family. The operating method and the code used in the DLL\ndescribed in the article are very similar to our analysis and observations.\n\nThe process dump also revealed further indicators. Firstly, it revealed artifacts related to\nthe DLL analyzed, “C:\\ProgramData\\Microsoft\\Windows\\SuperfRtch\\SuperfRtch.dat”.\nWe believe that this dat file might be the loaded payload.\n\nSecondly, while investigating the process dump, we observed activities from the backdoor\nthat are part of the data exfiltration attempts which we will describe in more detail in this\nanalysis report.\n\nA redacted snippet of the code would look like this:\n\n\n-----\n\n_Creating archive ***.rar_\n\n_Adding  [data from location]_\n\n_0%_\n\n_OK_\n\nAnother indicator of discovering Winnti malware was the following execution path we\ndiscovered in the command line dump of the memory:\n\n_cmd /c klcsngtgui.exe 1560413F7E <abbreviation-victim>.dat_\n\nWhat we observed here was the use of a valid executable, the AES 256 decryption key of\nthe payload (.dat file). In this case, the payload file was named using an abbreviation of\nthe victim company’s name. Unfortunately, the adversary had removed the payload file\nfrom the system. File carving did not work since the disk/unallocated space was\noverwritten. However, reconstructing traces from memory revealed that we were dealing\nwith the Winnti 4.0 malware. The malware was injected into a SVCHOST process where a\ndriver location pointed to the config file. We observed in the process dump the exfiltration\nof data on the system, such as OS, Processor (architecture), Domain, Username, etc.\n\nAnother clue that helped us was the use of DNS tunneling by Winnti which we discovered\ntraces of in memory. The hardcoded 208.67.222.222 resolves to a legitimate OpenDNS\nDNS server. The IP is pushed into the list generated by the malware at runtime. At the\nstart of the malware, it populates the list with the system’s DNS, and the OpenDNS server\nis only used as a backup to ensure that the C2 domain is resolved.\n\nAnother indicator in the process dump was the setup of the C2 connection including the\nUser-Agent that has been observed being used by Winnti 4.0 malware:\n\n_Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)_\n_Chrome/57.0.2987.133 Safari/537.36_\n\n### Other Persistence Activities\n\n[WMI activity [T1546.003] was also observed to execute commands on the systems.](https://attack.mitre.org/techniques/T1546/)\n\n[From a persistence point of view, scheduled tasks [T1053.005] and the use of valid](https://attack.mitre.org/techniques/T1053/)\n[accounts [T1078] acquired through the use of Mimikatz, or creating LSASS dumps, were](https://attack.mitre.org/techniques/T1078/)\nobserved being employed during the length of the campaign.\n\n## Lateral Movement\n\nFrom a lateral movement perspective, the adversary used the obtained credentials to hop\nfrom asset to asset. In one particular case, we observed a familiar filename: “PsExec.exe”.\nThis SysInternals tool is often observed being used in lateral movement by adversaries,\nhowever, it can also be used by the sysadmins of the network. In our case, the PsExec\n\n\n-----\n\nexecutable had a file size of 9.6 MB where the original PsExec (depending on 32- or 64-bit\nversion) had a maximum file size of 1.3 MB. An initial static inspection of the file resulted\nin a blob of code that was present in the executable which had a very high entropy score\n(7.99). When running the file from the command line, the following output was observed:\n\nFigure 5 PsExec output\n\nThe error notification and the ‘Impacket’ keyword tipped us off and, after digging around,\nwe found more. The fake PsExec is an open-source Python script that is a PsExec\nalternative with shell/backdoor capability. It uses a script from this location:\nhxxps://github.com/SecureAuthCorp/impacket/blob/master/examples/psexec.pyi. The\nfile is large since it incorporates a low-level protocol interaction from Impacket. The\nPython library combined with the script code is compiled with py2exe. The file was\ncompiled during the time of the latest attack activities and signed with an expired\ncertificate.\n\n## Data Exfiltration\n\nFrom what we observed, the adversary had a long-term intention to stay present in the\nvictim’s network. With high confidence, we believe that the adversary was interested in\nstealing proprietary intelligence that could be used for military or intellectual\nproperty/manufacturing purposes.\n\nThe adversary used several techniques to exfiltrate the data. In some cases, batch (.bat)\nscripts were created to gather information from certain network shares/folders and use\n[the ‘rar’ tool to compress them to a certain size [T1020] [T1030]. Example of content in a](https://attack.mitre.org/techniques/T1020/)\nbatch script:\n\n_C:\\Windows\\web\\rar.exe a -[redacted] -r -v50000 [Target-directory]_\n\nOn other occasions, manual variants of the above command were discovered after using\nthe custom backdoor as described earlier.\n\nWhen the data was gathered on a local system using the backdoor, the files were\n[exfiltrated over the backdoor and the rar files were deleted [T1070.004]. Where external](https://attack.mitre.org/techniques/T1070/)\nfacing assets were used, like a web server, the data was stored in a location in the Internet\nInformation Services (IIS) web server and exfiltrated over HTTP using GET requests\n[towards the exact file paths [T1041] [T1567] [T1071].](https://attack.mitre.org/techniques/T1041/)\n\nAn example of the [redacted] web traffic in the IIS logfiles:\n\n\n-----\n\n**Date /Time** **Request** **TCP Src port** **Source IP** **User-Agent**\n\nRedacted GET /****/[redacted].rar 80 180.50.*.* MINIXL\n\nredacted GET /****/[redacted].rar 80 209.58.*.* MINIXL\n\nThe source IP addresses discovered belonged to two different ISP/VPN providers based in\nHong-Kong.\n\nThe User-Agent value is an interesting one, “MINIXL”. When we researched that value,\nwe discovered a blog from Dell SecureWorks from 2015 that mentions the same UserAgent, but also a lot of the artifacts mentioned from the blog overlapped with the\n[observations and TTPs of Operation Harvest [link].](https://www.secureworks.com/research/threat-group-3390-targets-organizations-for-cyberespionage)\n\nWhat we could retrieve from open-source databases is that the use of this particular UserAgent is very limited and seems to originate from the APAC region.\n\n## Who did it?\n\nThat seems to be the one-million-dollar question to be asked. Within McAfee, attribution\nis not our main focus, protecting our customers is our priority. What we do care about is\nthat if we learn about these techniques during an investigation, can we map them out and\nsupport our IR team on the ground, or a customer’s IR team, with the knowledge that can\nhelp determine which phase of the attack the evidence is pointing to and based on\nhistorical data and intelligence, assist in blocking the next phase and discover more\nevidence?\n\nWe started by mapping out all MITRE ATT&CK Enterprise techniques and subtechniques, added the tools used, and did a comparison against historical technique data\nfrom the industry. We ended up with four groups that shared techniques and subtechniques. The Winnti group was added by us since we discovered the unique encryption\nfunction in the custom backdoor and indicators of the use of the Winnti malware.\n\n\n-----\n\nFigure 6 ATT&CK technique comparison\n\nThe diagram reflecting our outcome insinuated that APT27 and APT41 are the most likely\ncandidates that overlap with the (sub-)techniques we observed.\n\nSince all these groups are in a certain time zone, we extracted all timestamps from the\nforensic investigation with regards to:\n\nRegistration of domain\nCompile timestamps of malware (considering deception)\nTimestamps of command-line activity\nTimestamps of data exfiltration\nTimestamps of malware interaction such as creation, deletion, etc.\n\nWhen we converted all these timestamps from UTC to the aforementioned groups’ time\nzones, we ended up with the below scheme on activity:\n\nFigure 7 Adversary’s time of operation\n\nIn this campaign, we observed how the adversary mostly seems to work from Monday to\nThursday and typically during office hours, albeit with the occasional exception.\n\n\n-----\n\nCorrelating ATT&CK (sub-)techniques, timestamps, and tools like PlugX and Mimikatz\nare not the only evidence indicators that can help to identify a possible adversary.\nCommand-line syntax, specific code similarity, actor capability over time versus other\ngroups, and unique identifiers are at the top of the ‘pyramid of pain’ in threat intelligence.\nThe bottom part of the pyramid is about hashes, URLs, and domains, areas that are very\nvolatile and easy to change by an adversary.\n\nFigure 8 Pyramid of Pain\n\nBeyond investigating those artifacts, we also took possible geopolitical interests and\npotential deception into consideration when building our hypothesis. When we mapped\nout all of these, we believed that one of the two previously mentioned groups were\nresponsible for the campaign we investigated.\n\nOur focus was not about attribution though, but more around where the flow of the attack\nis, matches against previous attack flows from groups, and what techniques/tools they are\nusing to block next steps, or where to locate them. The more details we can gather at the\ntop of ‘the pyramid of pain’, the better we can determine the likely adversary and its\nTTP’s.\n\n## That’s all Folks!\n\nWell, not really. While correlating the observed (sub-)techniques, the malware families\nand code, we discovered another targeted attack against a similar target in the same\nnation with the major motivation of gathering intelligence. In the following diagram we\nconducted a high-level comparison of the tools being used by the adversary:\n\n\n-----\n\nFigure 9 Tools comparison\n\nAlthough some of the tools are unique to each campaign, if taken into consideration over\ntime with when they were used, it makes sense. It demonstrates the development of the\nactor and use of newer tools to conduct lateral movement and to obtain the required level\nof user rights on systems.\n\nOverall, we observed the same modus operandi. Once an initial foothold was established,\nthe adversary would deploy PlugX initially to create a few backdoors in the victim’s\nnetwork in case they were discovered early on. After that, using Mimikatz and dumping\nlsass, they were looking to get valid accounts. Once valid accounts were acquired, several\ntools including some of their own tools were used to gain information about the victim’s\nnetwork. From there, several shares/servers were accessed, and information gathered.\nThat information was exfiltrated as rar files and placed on an internet-facing server to\nhide in the ‘normal’ traffic. We represent that in the following graphic:\n\nFigure 10 Attack flow\n\nIn the 2019/2020 case we also observed the use of a malware sample that we would\nclassify as part of the Winnti malware family. We discovered a couple of files that were\nexecuted by the following command:\n\n\n-----\n\n_Start Ins64.exe E370AA8DA0 Jumper64.dat_\n\nThe Winnti loader ‘Ins64.exe’ uses the value ‘E370AA8DA0’ to decrypt the payload from\nthe .dat file using the AES-256-CTR decryption algorithm and starts to execute.\n\nAfter executing this command and analyzing the memory, we observed a process injection\nin one of the svchost processes whereby one particular file was loaded from the following\npath:\n\n_C:\\programdata\\microsoft\\windows\\caches\\ieupdate.dll_\n\nFigure 11 Memory capture\n\nThe malware started to open up both UDP and TCP ports to connect with a C2 server.\n\nUDP Port 20502\n\nTCP Port 20501\n\nFigure 12 Network connections to C2\n\nCapturing the traffic from the malware we observed the following as an example:\n\nFigure 13 Winnti HTTP traffic to C2\n\n\n-----\n\nThe packet data was customized and sent through a POST request with several headers\ntowards the C2. In the above screenshot the numbers after “POST /” were randomly\ngenerated.\n\nThe User-Agent is a good network indicator to identify the Winnti malware since it is\nused in multiple variants:\n\n_Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)_\n_Chrome/50.0.2661.94 Safari/537.36_\n\nIndeed, the same User Agent value was discovered in the Winnti sample in Operation\nHarvest and seems to be typical for this malware family.\n\nThe cookie value consists of four Dword hex values that contain information about the\ncustomized packet size using a XOR value.\n\n[We learned more about the packet structure of Winnti from this link.](https://github.com/TKCERT/winnti-detector)\n\nApplying what we learned about the handshake, we observed the following in our traffic\nsample:\n\nDword value 0 = 52 54 00 36\n\nDword value 1 = 3e ff 06 b2\n\nDword value 2 = 99 6d 78 fe\n\nDword value 3 = 08 00 45 00\n\nDword value 4 = 00 34 00 47\n\n**Initial handshake order:**\n\nBased on our cross-correlation with samples and other OSINT resources, we believe with\na high confidence that this was a Winnti 4.0 sample that connects with a confirmed\nWinnti C2 server.\n\nThe identified C2 server was 185.161.211.97 TCP/80.\n\n\n-----\n\n### Timeline of Events\n\nWhen analyzing the timestamps from this investigation, like we did for operation\nHarvest, we came to the below overview:\n\nFigure 14 Beijing working hours case 2019/2020\n\nAgain, we observed that the adversary was operating Monday to Friday during office\nhours in the Beijing time-zone.\n\n## Conclusion\n\nOperation Harvest has been a long-term operation whereby an adversary maintained\naccess for multiple years to exfiltrate data. The exfiltrated data would have either been\npart of an intellectual property theft for economic purposes and/or would have provided\ninsights that would be beneficial in case of military interventions. The adversaries made\nuse of techniques very often observed in this kind of attack but also used distinctive new\nbackdoors or variants of existing malware families. Combining all forensic artifacts and\ncross-correlation with historical and geopolitical data, we have high confidence that this\noperation was executed by an experienced APT actor.\n\nAfter mapping out all data, TTP’s etc., we discovered a very strong overlap with a\ncampaign observed in 2019/2020. A lot of the (in-depth) technical indicators and\ntechniques match. Also putting it into perspective, and over time, it demonstrates the\nadversary is adapting skills and evolving the tools and techniques being used.\n\nOn a separate note, we observed the use of the Winnti malware. We deliberately mention\nthe term ‘malware’ instead of group. The Winnti malware is known to be used by several\nactors. Within every nation-state cyber-offensive activity, there will be a department/unit\nresponsible for the creation of the tools/malware, etc. We strongly believe that is exactly\nwhat we observe here as well. PlugX, Winnti and some other custom tools all point to a\ngroup that had access to the same tools. Whether we put name ‘X’ or ‘Y’ on the adversary,\nwe strongly believe that we are dealing with a Chinese actor whose long-term objectives\nare persistence in their victims’ networks and the acquisition of the intelligence needed to\nmake political/strategic or manufacturing decisions.\n\n### MITRE ATT&CK Techniques\n\n\n**Technique**\n**ID**\n\n\n**Technique Title** **Context Campaign**\n\n\nT1190 Exploit Publicfacing application\n\nT1105 Ingress Tool\ntransfer\n\n\nAdversary exploited a web-facing server with\napplication\n\nTools were transferred to a compromised web-facing\nserver\n\n\n-----\n\nT1083 File & Directory\nDiscovery\n\nT1570 Lateral Tool\nTransfer\n\nT1569.002 System Services:\nService Execution\n\nT1068 The exploitation of\nPrivilege\nEscalation\n\nT1574.002 Hijack Execution\nFlow: DLL SideLoading\n\nT1543.003 Create or Modify\nSystem\nProcess: Windows\nService\n\nT1546.003 Event-Triggered\nExecution: WMI\nEvent\nSubscription\n\n\nAdversary browsed several locations to search for\nthe data they were after.\n\nAdversary transferred tools/backdoors to maintain\npersistence\n\nAdversary installed custom backdoor as a service\n\nAdversary used Rotten/Bad Potato to elevate user\nrights by abusing API calls in the Operating System.\n\nAdversary used PlugX malware that is famous for\nDLL-Side-Loading using a valid executable, a DLL\nwith the hook towards a payload file.\n\nAdversary launched backdoor and some tools as a\nWindows Service including adding of registry keys\n\nWMI was used for running commands on remote\nsystems\n\n\nT1053.005 Scheduled task Adversary ran scheduled tasks for persistence of\ncertain malware samples\n\nT1078 Valid accounts Using Mimikatz and dumping of lsass, the adversary\ngained credentials in the network\n\n\nT1020 Automated\nexfiltration\n\nT1030 Data transfer size\nlimits\n\nT1070.004 Indicator removal\non host\n\nT1041 Exfiltration over\nC2 channel\n\nT1567 Exfiltration over\nWeb Service\n\nT1071.004 Application layer\nprotocol: DNS\n\n\nThe PlugX malware exfiltrated data towards a C2\nand received commands to gather more information\nabout the victim’s compromised host.\n\nAdversary limited the size of rar files for exfiltration\n\nWhere in the beginning of the campaign the\nadversary was sloppy, during the last months of\nactivity they became more careful and started to\nremove evidence\n\nAdversary used several C2 domains to interact with\ncompromised hosts.\n\nGathered information was stored as ‘rar’ files on the\ninternet-facing server, whereafter they were\ndownloaded by a specific ip range.\n\nUsing DNS tunneling for the C2 traffic of the PlugX\nmalware\n\n\n-----\n\n## Indicators of Compromise (IOCs)\n\nNote: the indicators shared are to be used in a historical and timeline-based context,\nranging from 2016 to March 2021.\n\n## Operation Harvest:\n\n**PlugX C2:**\n\nsery(.)brushupdata(.)com\n\nDnssery(.)brushupdata(.)com\n\nCenter(.)asmlbigip(.)com\n\n**Tools:**\n\nMimikatz\n\nPsExec\n\nRottenPotato\n\nBadPotato\n\n## Operation 2019/2020\n\n**PlugX malware:**\n\nf50de0fae860a5fd780d953a8af07450661458646293bfd0fed81a1ff9eb4498\n\n26e448fe1105b5dadae9b7607e3cca366c6ba8eccf5b6efe67b87c312651db01\n\ne9033a5db456af922a82e1d44afc3e8e4a5732efde3e9461c1d8f7629aa55caf\n\n3124fcb79da0bdf9d0d1995e37b06f7929d83c1c4b60e38c104743be71170efe\n\n**Winnti:**\n\n800238bc27ca94279c7562f1f70241ef3a37937c15d051894472e97852ebe9f4\n\nc3c8f6befa32edd09de3018a7be7f0b7144702cb7c626f9d8d8d9a77e201d104\n\ndf951bf75770b0f597f0296a644d96fbe9a3a8c556f4d2a2479a7bad39e7ad5f\n\nWinnti C2: 185.161.211.97\n\n**Tools:**\n\n\n-----\n\nPSW64\n6e983477f72c8575f8f3ff5731b74e20877b3971fa2d47683aff11cfd71b48c6\n\nNTDSDumpEx\n6db8336794a351888636cb26ebefb52aeaa4b7f90dbb3e6440c2a28e4f13ef96\n\nNBTSCAN\nc9d5dc956841e000bfd8762e2f0b48b66c79b79500e894b4efa7fb9ba17e4e9e\n\nNetSess\nddeeedc8ab9ab3b90c2e36340d4674fda3b458c0afd7514735b2857f26b14c6d\n\nSmbexec\ne781ce2d795c5dd6b0a5b849a414f5bd05bb99785f2ebf36edb70399205817ee\n\nWmiexec\n14f0c4ce32821a7d25ea5e016ea26067d6615e3336c3baa854ea37a290a462a8\n\nMimikatz\n\nRAR command-line\n\nTCPdump\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.09.14.Operation_Harvest/Operation%20%E2%80%98Harvest%E2%80%99_%20A%20Deep%20Dive%20into%20a%20Long-term%20Campaign%20_%20McAfee%20Blogs.pdf"
    ],
    "report_names": [
        "Operation ‘Harvest’_ A Deep Dive into a Long-term Campaign _ McAfee Blogs"
    ],
    "threat_actors": [
        {
            "id": "46b409af-b2ea-43b8-9223-e01d982e00ce",
            "created_at": "2022-10-25T16:07:23.966265Z",
            "updated_at": "2025-03-27T02:02:10.052693Z",
            "deleted_at": null,
            "main_name": "Operation Harvest",
            "aliases": [],
            "source_name": "ETDA:Operation Harvest",
            "tools": [
                "Agent.dhwf",
                "BadPotato",
                "BleDoor",
                "Destroy RAT",
                "DestroyRAT",
                "Impacket",
                "Kaba",
                "Korplug",
                "Mimikatz",
                "NBTscan",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "RottenPotato",
                "SMBExec",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "WinRAR",
                "Winnti",
                "Xamtrav",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1631690423,
    "ts_modification_date": 1631690423,
    "files": {
        "pdf": "https://archive.orkl.eu/f6800cab68f7c1b95614a48cacd45ec079c32bd9.pdf",
        "text": "https://archive.orkl.eu/f6800cab68f7c1b95614a48cacd45ec079c32bd9.txt",
        "img": "https://archive.orkl.eu/f6800cab68f7c1b95614a48cacd45ec079c32bd9.jpg"
    }
}