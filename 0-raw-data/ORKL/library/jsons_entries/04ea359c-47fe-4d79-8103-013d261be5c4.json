{
    "id": "04ea359c-47fe-4d79-8103-013d261be5c4",
    "created_at": "2023-01-12T15:05:31.557581Z",
    "updated_at": "2025-03-27T02:05:22.080031Z",
    "deleted_at": null,
    "sha1_hash": "51f6e84791b1aff74a4c336aec71305addf41da6",
    "title": "2018-01-17 - Art of Steal- Satori Variant is Robbing ETH BitCoin by Replacing Wallet Address",
    "authors": "",
    "file_creation_date": "2022-05-28T18:27:52Z",
    "file_modification_date": "2022-05-28T18:27:52Z",
    "file_size": 398228,
    "plain_text": "# Art of Steal: Satori Variant is Robbing ETH BitCoin by Replacing Wallet Address\n\n**[blog.netlab.360.com/art-of-steal-satori-variant-is-robbing-eth-bitcoin-by-replacing-wallet-address-en/](http://blog.netlab.360.com/art-of-steal-satori-variant-is-robbing-eth-bitcoin-by-replacing-wallet-address-en/)**\n\nRootKiter January 17, 2018\n\n17 January 2018 / [Botnet](http://blog.netlab.360.com/tag/botnet/)\nThe security community was moving very fast to take actions and sinkhole the Satori botnet\n[C2 after our December 5 blog. The spread of this new botnet has been temporarily halted,](http://blog.netlab.360.com/warning-satori-a-new-mirai-variant-is-spreading-in-worm-style-on-port-37215-and-52869-en/)\nbut the threat still remains.\n\nStarting from 2018-01-08 10:42:06 GMT+8, we noticed that one Satori’s successor variant\n(we name it Satori.Coin.Robber) started to reestablish the entire botnet on ports 37215 and\n52869.\n\nWhat really stands out is something we had never seen before, this new variant actually\nhacks into various mining hosts on the internet (mostly windows devices) via their\nmanagement port 3333 that runs Claymore Miner software, and replaces the wallet address\non the hosts with its own wallet address.\n\nFrom the most recently [pay record till 2018-01-16 17:00 GMT+8, we can see:](http://dwarfpool.com/eth/address?wallet=B15A5332eB7cD2DD7a4Ec7f96749E769A371572d&allpayouts=1)\n\nSatori.Coin.Robber is actively mining, with lastest update 5 minutes ago.\nSatori.Coin.Robber owns an average calculation power of 1606 MH/s for the last 2\ndays; the account has accumulated 0.1733 ETH coins over the past 24 hours\nSatori.Coin.Robber has already got the first ETH coin paid at 14:00 on January 11,\n2017, with another 0.76 coin in the balance\n\nAlso worth mentioning is that the author of Satori.Coin.Robber claims his current code is not\nmalicious and leaves an email address(see the section below for more details):\n```\nSatori dev here, dont be alarmed about this bot it does not currently have any\nmalicious packeting purposes move along. I can be contacted at curtain@riseup.net\n\n```\n**A Series of Security Issues on Claymore Miner Remote Management**\n\nClaymore Miner is a popular coin-mining software used by quite a lot of mining devices these\ndays.\n\n[According to its document, the Claymore Miner Windows version provides a remote](https://github.com/nanopool/Claymore-Dual-Miner)\nmonitoring and/or management interface on port 3333 (the EthMan.exe file in the “remote\nmanagement” directory). And by default earlier versions allow not only remote reading for\nmining status, but also operations like restart, upload files and some other control operations.\n\n\n-----\n\nApparently, the above feature is a security issue. As a fix, after version 8.1, the Claymore\nMiner will not use port 3333 but -3333 (a negative one) as the startup parameter by default,\nwhich means read-only monitoring actions are supported, but other controlling actions are all\ndenied.\n\n[But this is not the end. In November 2017, CVE-2017-16929 went public, which allows](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16929)\nremote read and/or write to arbitrary files for Claymore Miner. The corresponding exploit\ncode has also been disclosed.\n\nThe scanning payload (the exploit code) we are going to discuss here is different from all\nabove though. It works primarily on the Claymore Mining equipment that allows management\nactions on 3333 ports with no password authentication enabled (which is the default config).\nIn order to prevent potential abuse, we will not discuss too much details in this article.\n\n**Satori.Coin.Robber Variant is Exploiting above Issue to Robber ETH Coins**\n\nFrom 2018-01-08 to 2018-01-12, have captured the following malware samples:\n```\n737af63598ea5f13e74fd2769e0e0405 http://77.73.67.156/mips.satori\n141c574ca7dba34513785652077ab4e5 http://77.73.67.156/mips.satori\n4e1ea23bfe4198dad0f544693e599f03 http://77.73.67.156/mips.satori\n126f9da9582a431745fa222c0ce65e8c http://77.73.67.156/mips.satori\n74d78e8d671f6edb60fe61d5bd6b7529 http://77.73.67.156/mips.satori\n59a53a199febe331a7ca78ece6d8f3a4 http://77.73.67.156/b\n\n```\nThese samples are subsequent variants of Satori, which scan not only the previous 37215\nand 52869 ports, but also the 3333 ports. The payload on on three ports are:\n\n**Port 37215: Known, exploiting vulnerabilities CVE-2017-17215, Huawei recently**\n[released the relevant statement](http://www.huawei.com/en/psirt/security-notices/huawei-sn-20171130-01-hg532-en)\n**Port 52869: Known, exploiting vulnerabilities CVE-2014-8361, related to some Realtek**\nSDK, the [exploit code PoC is published since 2016](https://www.exploit-db.com/exploits/37169/)\n**Port 3333: Newly emerged, exploiting ETH mining remote management interface**\nmentioned above.\n\nThe scanning payload on port 3333 is shown in the above image. Satori.Coin.Robber issues\nthree packets respectively:\n\n\n-----\n\n**Package 1: miner_getstat1, get mining state**\n**Package 2: miner_file, update reboot.bat file, replace the mine pool and wallet**\naddress;\n**Package 3: miner_reboot, reboot the host with new wallet**\n\nDuring this process, the mining pool and the wallet will be replaced:\n\nNew pool: eth-us2.dwarfpool.com:8008\nNew wallet: 0xB15A5332eB7cD2DD7a4Ec7f96749E769A371572d\n\n**Similarities and Differences between Satori.Coin.Robber and the Original Satori**\n\nComparison between Satori.Coin.Robber and Satori:\n\n737af63598ea5f13e74fd2769e0e0405 Satori.Coin.Robber\n5915e165b2fdf1e4666a567b8a2d358b satori.x86_64, the original Satori in October\n2017 with VT report [here](https://www.virustotal.com/zh-cn/en-US/file/2a41a98e3889c9a1054ecf652e7b036b51d452a89c74d030663c6e7c6efe5550/analysis/)\n\n**Similarities:**\n\n**Code: Both use UXP packing, with the same magic number 0x4A444E53. The**\nunpacked code share similar code structures\n**Configurations: The configurations are both encrypted. The encryption algorithm and**\na large number of configuration strings are the same. For example, /bin/busybox\nSATORI, bigbotPein, 81c4603681c46036, j57*&jE, etc.\n**Scanning payload: Both scan ports 37215 and 52869 and share the same payload**\n\n**Differences:**\n\n**Scanning payload: Satori.Coin.Robber added a new payload against Claymore Miner**\non port 3333\n**Scanning process: Satori.Coin.Robber adopts an asynchronous network connection**\n(NIO) method to initiate a connection, which improves scan efficiency\n**C2 Protocol: Satori.Coin.Robber enables a new set of C2 communication protocols**\nthat communicate with 54.171.131.39 using the DNS protocol. We will go through the\ndetails later.\n\nBelow are some detailed screenshots:\n\n\n-----\n\nBoth samples share the same UPX packing magic numbers:\n\nSatori.Coin.Robber uses asynchronous network connection for scanning:\n\n**Satori.Coin.Robber's New C2 Communications Protocol**\n\nC2 of Satori.Coin.Robber:\n\nA hard coded IP address 54.171.131.39, located in Dublin, Ireland.\n\n\n-----\n\nThe communication protocol is based on DNS protocol, which can be tested by query\n[like \"dig@54.171.131.39 $DNS-QNAME any+short\", and different $DNS-QNAME](http://10.10.0.46/mailto:%22dig@54.171.131.39)\ncorresponds to different function.\n\nAll C2 protocol lists as follows, note the fourth one is not written anywhere in the\nSatori.Coin.Robber code, we just tied and found it has dns response:\n\nThe first two responses are the same mining pool and wallet addresses used by the bot after\ntampering with other Claymore Miner mining equipment. However, at this stage, it seems\nthat these server returned values is yet to be used.\n\n**Infection Trend**\n\nWe evaluate Satori.Coin.Robber's infection scale and trend by comparing the scanning\n[volumes on three ports: 37215,](http://scan.netlab.360.com/#/dashboard?tsbeg=1513526400000&tsend=1516118400000&dstport=37215&toplistname=srcas&topn=10) [52869 and](http://scan.netlab.360.com/#/dashboard?tsbeg=1513526400000&tsend=1516118400000&dstport=52869&toplistname=srcas&topn=10) [3333.](http://scan.netlab.360.com/#/dashboard?tsbeg=1513526400000&tsend=1516118400000&dstport=3333&toplistname=srcas&topn=10)\n\n\n-----\n\nThe three figures above show that the scanning volumes of these three ports all increase\nsharply during this period, which is consistent with the behavior of Satori.Coin.Robber\nsamples.\n\nall emerged around 2018-01-08\nscanning spikes were all around 2018-01-08 to 2018-01-09\nthe volumes of scanning decrease in recent few days\nAS4766 Korea Telecom contributes most of the scanning source\ntotally about 4.9K uniq scanning source IPs\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-01-17 - Art of Steal- Satori Variant is Robbing ETH BitCoin by Replacing Wallet Address.pdf"
    ],
    "report_names": [
        "2018-01-17 - Art of Steal- Satori Variant is Robbing ETH BitCoin by Replacing Wallet Address.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535931,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653762472,
    "ts_modification_date": 1653762472,
    "files": {
        "pdf": "https://archive.orkl.eu/51f6e84791b1aff74a4c336aec71305addf41da6.pdf",
        "text": "https://archive.orkl.eu/51f6e84791b1aff74a4c336aec71305addf41da6.txt",
        "img": "https://archive.orkl.eu/51f6e84791b1aff74a4c336aec71305addf41da6.jpg"
    }
}