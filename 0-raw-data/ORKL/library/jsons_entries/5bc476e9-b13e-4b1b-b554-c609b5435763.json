{
    "id": "5bc476e9-b13e-4b1b-b554-c609b5435763",
    "created_at": "2024-07-25T02:06:17.561618Z",
    "updated_at": "2025-03-27T02:05:45.020133Z",
    "deleted_at": null,
    "sha1_hash": "266f535f3bb67e562db99f331e48202f8357c774",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-01-29T14:03:42Z",
    "file_modification_date": "2024-01-29T14:03:42Z",
    "file_size": 4983298,
    "plain_text": "-----\n\n-----\n\n### •\n\n •\n\n •\n\n •\n\n\n-----\n\n-----\n\n##### •\n\n •\n\n •\n\n\n###### 火車 (Kasha)\n\n https://en.wikipedia.org/wiki/Kasha_(folklore) #/media/File:SekienKasha.jpg\n\n\n-----\n\n###### •\n\n •\n\n\n###### espionage + espionage\n cybercrime\n\n\n###### 2019~\n\n\n###### 2020~2021\n\n\n-----\n\n-----\n\n###### •\n\n •\n\n\n###### Observed in previous Campaign\n\n Observed in new Campaign\n\n\n###### v0.2.7 v0.3.1 v0.3.2\n\n\n###### v0.4.7 v0.4.8\n\n\n###### v0.5.9\n\n\n###### 9\n\n\n###### 12 4 5 6 8 12 1 4 11 12 3 4 5 6 9 2020 2021 2022 2023\n\n\n###### 3\n\n\n###### v0.6.9 v0.7.1\n\n 4 5\n\n\n###### 10\n\n\n###### v0.5.8\n\n\n###### v0.3.4 v0.3.5 v0.3.6\n\n\n###### v0.4.1\n\n\n###### v0.6.5\n v0.6.2\n\n\n###### v0.6.9\n\n\n###### v0.7.3\n\n\n###### v0.3.6\n\n\n-----\n\n###### •\n\n •\n\n\n\n###### •\n\n • •\n\n •\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n###### https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_202_niwa-yanagishita_en.pdf\n\n\n-----\n\n|Col1|Col2|Col3|Col4|\n|---|---|---|---|\n|||||\n|||||\n|||||\n||||• • •|\n||• • •|• • •|• • •|\n\n\n\n###### •\n •\n •\n •\n •\n •\n •\n\n\n\n###### • •\n •\n •\n\n\n-----\n\n-----\n\n#### •\n\n •\n\n •\n\n\n##### −\n\n\n-----\n\n#### •\n\n\n\n###### •\n •\n\n •\n\n\n\n###### •\n •\n\n\n\n###### •\n •\n\n •\n\n\n-----\n\n#### •\n\n\n-----\n\n##### •\n\n •\n\n •\n\n\n###### LODEINFOLDR Type 2 loading process\n\n DLL Side-Loading\n\n SfsDllSample.exe SfsDll32.dll\n\n\n###### LODEINFOLDR Type 1 loading process\n\n DLL Side-Loading\n\n Elze.exe frau.dll\n\n\n###### payload\n Run in- Elze.exe_ Run in-\n LODEINFO LODEINFO\n\n\n-----\n\n```\n             add\n0x28200\n           0x2C438\n\n```\n```\n0x4238\n\n```\n```\n         Legitimate signature\n          RC4 key (0x40)\n         Encrypted payload\n\n```\n\n-----\n\n##### •\n\n\n-----\n\n#### •\n\n\n\n###### •\n •\n •\n •\n •\n\n\n\n###### •\n •\n •\n •\n •\n\n\n\n###### •\n •\n •\n •\n •\n\n\n\n###### •\n •\n •\n •\n •\n\n\n\n###### • • • •\n • • • •\n •\n\n\n-----\n\n###### 2[nd] stage LODEINFO’s backdoor\n command process routine\n\n\n-----\n\n##### •\n\n •\n\n\n###### NOOPLDR\n\n\n###### NOOPLDR\n\n\n###### NOOPDOOR\n\n\n-----\n\n###### MSBuild task containing obfuscated C# to load NOOPDOOR\n\n\n-----\n\n#### •\n\n •\n\n\n###### Control Flow obfuscation\n and junk codes\n\n\n##### −\n\n −\n\n −\n\n −\n\n\n-----\n\n###### •\n\n •\n\n •\n\n\n###### −\n\n −\n\n\n\n###### •\n\n •\n\n •\n\n •\n\n •\n\n •\n\n •\n\n\n###### NOOPDOOR is basically active backdoor\n but also supports passive backdoor\n\n C2 server\n\n TCP/443\n\n TCP/47000\n\n Client Server thread thread\n\n NOOPDOOR\n\n\n\n###### •\n\n\n-----\n\n###### •\n\n|action|example|\n|---|---|\n||2023/12/01 00:00:00 -> 0x365692200 -> 0x65692200|\n||0x65692200 -> 0x650a3600|\n||hxxp://$j[TEST].srmbr[.]com:443/#180|\n||217826c36e994d097eadcf856fdcadb21372e5a0845e496dbb6015e1a8d42867|\n||dd5b50e5e0405a221fc3c45f8d40ae37733f190b62e2b64e5de10cd190224453d90eaf…|\n||3VtQ5eBAWiIfw8RfjUCuN3M/GQti4rZOXeEM0ZAiRFPZDq8hG4tUb0ce7kFR4zdmLx+xTZe2 Z0P…|\n||3VtQ5eBAWiIfw8Rfj -> VtQeBAWiIfwRfj -> vtqebawiifwrfj|\n||vtqebawiifwrfj -> vtqebawifwrfj|\n||hxxp://vtqebawifwrfj[.]srmbr[.]com:443/|\n\n\n###### hxxp://vtqebawifwrfj[.]srmbr[.]com:443/\n\n\n-----\n\n#### •\n\n •\n\n •\n\n|Col1|NOOPDOOR|ANEL|\n|---|---|---|\n|timeline|2021~|2017~2019|\n|arch|64bit|32bit|\n|form|shellcode|shellcode (Loader) -> DLL|\n|protocol|TCP|HTTP|\n\n\n##### protocol TCP HTTP\n\n\n-----\n\n###### NOOPDOOR ANEL Loader\n\n\n-----\n\n#### •\n\n\n###### ANEL Loader NOOPDOOR\n\n\n-----\n\n###### hosted encrypted LODEINFO components in 2023/04/25\n\n 45.76.197[.]236\n\n resolve resolve\n\n```\nplouwvqlxy.myftp.org\n\n```\n```\nkcimqstvpvsvjzr.hopto.org\n\n```\n\n###### connect connect at 2023/05/23\n\n\n###### NOOPDOOR\n\n\n###### LODEINFO\n\n\n-----\n\n-----\n\n#### •\n\n###### ✓ ✓ ✓\n\n\n###### ✓ ✓\n\n ✓ ✓\n\n\n###### ✓ ✓\n\n ✓\n\n\n-----\n\n#### •\n\n\n###### ✓ ✓\n\n ✓ ✓\n\n\n-----\n\n##### •\n\n\n#### Assumption\n\n##### 1. Malware such as LODEINFO and NOOPDOOR might possibly be shared with other groups? 2. There might possibly be a team focusing on initial compromise (like access broker)?\n\n\n##### 2. There might possibly be a team focusing on initial compromise (like access broker)?\n\n\n-----\n\n#### •\n\n\n##### −\n\n −\n\n\n\n###### •\n\n •\n\n\n-----\n\n###### •\n\n •\n\n •\n\n\n###### −\n\n −\n\n −\n\n\n-----\n\n## Thank you\n\n\n-----\n\n# Appendix\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n##### We will release a blog with Yara rule soon\n\n```\nrule Trojan_LODEINFOLDR_generic\n{\n  meta:\n   Author = \"Trend Micro\"\n   Created_Time = \"2024-01-26\"\n  strings:\n    $chunk_1 = {\n       8A 02\n       34 ??\n       88 01\n       8A 42 01\n       34 ??\n       88 41 01\n       8A 42 02\n       34 ??\n       88 41 02\n       8A 42 03\n       34 ??\n       88 41 03\n       8A 42 04\n       34 ??\n       88 41 04\n       8A 42 05\n       34 ??\n       88 41 05\n       8A 42 06\n       34 ??\n       88 41 06\n       8A 42 07\n       34 ??\n       88 41 07\n       8B C1\n       C6 41 08 00\n   }\n  condition:\n    uint16(0) == 0x5A4D and\n    all of them\n\n```\n```\nrule Trojan_NOOPLDR_xml\n{\n  meta:\n   Author = \"Trend Micro\"\n   Created_Time = \"2024-01-26\"\n  strings:\n    $s1 = \"<Code Type=\\\"Class\\\" Language=\\\"cs\\\"><![CDATA[using \"\n    $s2 = \"Software\\\\\\\\Microsoft\\\\\\\\SQMClient\"\n    $s3 = \".GetValue(\\\"MachineId\\\").ToString()\"\n    $s4 = \"SHA384.Create();\"\n    $s5 = \"new byte[32];Array.Copy(\"\n    $s6 = \"new byte[16];Array.Copy(\"\n  condition:\n    all of them\n}\n\n```\n```\nrule Trojan_NOOPLDR_dll\n{\n  meta:\n   Author = \"Trend Micro\"\n   Created_Time = \"2024-01-26\"\n  strings:\n    $chunk_1 = {\n       48 8D 05 ?? ?? ?? ??\n       48 8D 0D ?? ?? ?? ??\n       0F B6 0C 0E\n       32 0C 06\n       0F B6 D1\n       48 8D 8D ?? ?? ?? ??\n       E8 ?? ?? ?? ??\n   }\n    $chunk_2 = {\n       3D ?? ?? ?? ??\n       7E ??\n       3D ?? ?? ?? ??\n       7F ??\n       3D ?? ?? ?? ??\n       0F 84 ?? ?? ?? ??\n       3D ?? ?? ?? ??\n       75 ??\n       B8 ?? ?? ?? ??\n       EB ??\n   }\n  condition:\n    uint16(0) == 0x5A4D and\n    all of them\n}\n\n```\n```\n             }\n             condition:\n               uint16(0) == 0x5A4D and\n               all of them\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://jsac.jpcert.or.jp/archive/2024/pdf/JSAC2024_2_7_hara_shoji_higashi_vickie-su_nick-dai_en.pdf"
    ],
    "report_names": [
        "JSAC2024_2_7_hara_shoji_higashi_vickie-su_nick-dai_en.pdf"
    ],
    "threat_actors": [
        {
            "id": "e47e5bc6-9823-48b4-b4c8-44d213853a3d",
            "created_at": "2023-11-17T02:00:07.588367Z",
            "updated_at": "2025-03-27T02:00:03.228262Z",
            "deleted_at": null,
            "main_name": "MirrorFace",
            "aliases": [
                "Earth Kasha"
            ],
            "source_name": "MISPGALAXY:MirrorFace",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "af2a195b-fed2-4e2c-9443-13e9b08a02ae",
            "created_at": "2022-12-27T17:02:23.458269Z",
            "updated_at": "2025-03-27T02:02:10.056073Z",
            "deleted_at": null,
            "main_name": "Operation LiberalFace",
            "aliases": [
                "MirrorFace",
                "Operation LiberalFace"
            ],
            "source_name": "ETDA:Operation LiberalFace",
            "tools": [
                "LODEINFO",
                "MirrorStealer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1721873177,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1706537022,
    "ts_modification_date": 1706537022,
    "files": {
        "pdf": "https://archive.orkl.eu/266f535f3bb67e562db99f331e48202f8357c774.pdf",
        "text": "https://archive.orkl.eu/266f535f3bb67e562db99f331e48202f8357c774.txt",
        "img": "https://archive.orkl.eu/266f535f3bb67e562db99f331e48202f8357c774.jpg"
    }
}