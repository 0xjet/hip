{
    "id": "ca7ff3c9-fb15-4fc4-88e1-678ceb5ab55d",
    "created_at": "2023-01-12T15:04:20.447619Z",
    "updated_at": "2025-03-27T02:09:30.312554Z",
    "deleted_at": null,
    "sha1_hash": "91a07ee9fd90c6a1a0331de8bef5bcdc2953f91c",
    "title": "2020-12-22 - Azure AD workbook to help you assess Solorigate risk",
    "authors": "",
    "file_creation_date": "2022-05-29T01:25:59Z",
    "file_modification_date": "2022-05-29T01:25:59Z",
    "file_size": 543085,
    "plain_text": "# Azure AD workbook to help you assess Solorigate risk\n\n**techcommunity.microsoft.com/t5/azure-active-directory-identity/azure-ad-workbook-to-help-you-assess-solorigate-**\nrisk/ba-p/2010718\n\nDecember 22, 2020\n\nDec 22 2020 01:42 PM\n\n[In the interest of helping customers concerned about the Solorigate attacks we are](https://aka.ms/solorigate)\npublishing a new workbook in the Azure AD admin portal to assist investigations into the\n[Identity Indicators of Compromise related to the attacks. The information in this workbook is](https://aka.ms/solorigateidentityiocs)\navailable in Azure AD audit and sign in logs, but the workbook helps you collect and visualize\nthe information in one view.\n\nThe workbook is split into 4 sections, each aimed at providing information associated with\nthe attack patterns we have identified:\n\n1. Modified application and service principal credentials/authentication methods\n\n\n-----\n\n2. Modified federation settings\n3. New permissions granted to service principals\n4. Directory role and group membership updates for service principals\n\nFirst, we’ll detail how to access the workbook and then walk through each of these in turn.\n\n[Check out this cool video to see it in action!](https://techcommunity.microsoft.com/gxcuf89792/attachments/gxcuf89792/Identity/3045/1/SensitiveOperationsReport.mp4)\n\n## Accessing the workbook\n\nIf you organization is new to Azure Monitor workbooks, you’ll need to integrate your Azure\nAD sign-in and audit logs with Azure Monitor before accessing the workbook. This allows you\nto store, and query, and visualize your logs using workbooks for up to 2 years. Only sign-in\nand audit events created after Azure Monitor integration will be stored, so the workbook will\nnot contain insights prior to that date. Learn more about the prerequisites to Azure Monitor\nworkbooks for Azure Active Directory. If you have previously integrated your Azure AD signin and audit logs with Azure Monitor, you can use the workbook to assess past information.\n\nTo access the workbook:\n\n1. Sign into the [Azure portal](http://www.portal.azure.com/)\n2. Navigate to Azure Active Directory > Monitoring > Workbooks\n\nIn the Troubleshoot section, open the Sensitive Operations Report\n\n\n-----\n\n## Modified application and service principal credentials/authentication methods\n\nOne of the most common ways for attackers to gain persistence in the environment is by\nadding new credentials to existing applications and service principals. This allows the\nattacker to authenticate as the target application or service principal, granting them access to\nall resources to which it has permissions.\n\nThis section includes the following data to help you detect such actions:\n\nAll new credentials added to apps and service principals, including the credential type\nTop actors and the amount of credentials modifications they performed\nA timeline for all credential changes\n\nYou can use the filters present in this section to further investigate any of the suspicious\nactors or service principals that were modified.\n\n\n-----\n\nFor more information: [Apps & service principals in Azure AD - Microsoft identity platform](https://docs.microsoft.com/en-us/azure/active-directory/develop/app-objects-and-service-principals)\n\n## Modified federation settings\n\nAnother common approach to gaining a long-term foothold in the environment is modifying\nthe tenant’s federated domain trusts and effectively adding an additional, attacker controlled,\nSAML IDP as a trusted authentication source.\n\nThis section includes the following data:\n\nChanges performed to existing domain federation trusts\nAddition of new domains and trusts\n\nAny actions which modify or add domain federation trusts are rare and should be treated as\nhigh fidelity to be investigated as soon as possible.\n\nFor more information: [What is federation with Azure AD?](https://docs.microsoft.com/en-us/azure/active-directory/hybrid/whatis-fed)\n\n## New permissions granted to service principals\n\nIn cases where the attacker cannot find a service principal or an application with a high\nprivilege set of permissions through which to gain access, they will often attempt to add the\npermissions to another service principal or app.\n\nThis section includes a breakdown of the AppOnly permissions grants to existing service\nprincipals. Admins should investigate any instances of excessive high permissions being\ngranted, including, but not limited to, Exchange Online, Microsoft Graph and Azure AD\nGraph\n\n\n-----\n\nFor more information: [Microsoft identity platform scopes, permissions, and consent](https://docs.microsoft.com/azure/active-directory/develop/v2-permissions-and-consent)\n\n## Directory role and group membership updates for service principals\n\nFollowing the logic of the attacker adding new permissions to existing service principals and\napplications, another approach is adding them to existing directory roles or groups.\n\nThis section includes an overview of all changes made to service principal memberships and\nshould be reviewed for any additions to high privilege roles and groups.\n\n## Conclusion\n\nThis workbook includes an overview of some of the common attack patterns in AAD, not only\nin [Solorigate, and should be used as an investigation aid in conjunction with the steps](https://aka.ms/solorigate)\ndescribed in the articles linked at the beginning to ensure your environment is safe and\nprotect is from malicious actors.\n\n[For additional hunting with Azure Sentinel see http://aka.ms/sentinelsolorigatehunt.](http://aka.ms/sentinelsolorigatehunt)\n\nThe Solarwinds attack is an ongoing investigation, and our teams continue to act as first\nresponders to these attacks. As new information becomes available, we will make updates\n[through our Microsoft Security Response Center (MSRC) blog at https://aka.ms/solorigate.](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcomm.microsoft.com%2FPoliteMail245%2Fdefault.aspx%3Fpage%3DmOgDA41300uL7Q32_8nsGA%26ref_id%3DKI8WohcEM0KIdOtHZj3pQw&data=04%7C01%7Cadhall%40microsoft.com%7Ca48f35f285d94ccd698f08d8a3956502%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C637439209352849256%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=Xebz37S3gWRu3E8WvV1FRMz6vDhcBRDY0uQCZi9ogEc%3D&reserved=0)\n\n\n-----\n\nPlease reach out to me on twitter at [@Alex_t_weinert if you have questions or suggestions](https://techcommunity.microsoft.com/t5/user/viewprofilepage/user-id/15847)\nfor improvement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-22 - Azure AD workbook to help you assess Solorigate risk.pdf"
    ],
    "report_names": [
        "2020-12-22 - Azure AD workbook to help you assess Solorigate risk.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535860,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653787559,
    "ts_modification_date": 1653787559,
    "files": {
        "pdf": "https://archive.orkl.eu/91a07ee9fd90c6a1a0331de8bef5bcdc2953f91c.pdf",
        "text": "https://archive.orkl.eu/91a07ee9fd90c6a1a0331de8bef5bcdc2953f91c.txt",
        "img": "https://archive.orkl.eu/91a07ee9fd90c6a1a0331de8bef5bcdc2953f91c.jpg"
    }
}