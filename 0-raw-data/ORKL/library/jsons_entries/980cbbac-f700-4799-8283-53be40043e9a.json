{
    "id": "980cbbac-f700-4799-8283-53be40043e9a",
    "created_at": "2023-01-12T15:02:48.729806Z",
    "updated_at": "2025-03-27T02:05:54.700588Z",
    "deleted_at": null,
    "sha1_hash": "56428afe31e45d283fb3c0b52fb6b757b20c4bde",
    "title": "2018-03-12 - Python decryptor for newer AdWind config file",
    "authors": "",
    "file_creation_date": "2022-05-28T00:47:45Z",
    "file_modification_date": "2022-05-28T00:47:45Z",
    "file_size": 76048,
    "plain_text": "# herrcore/AdWindDecryptor.py\n\n**gist.github.com/herrcore/8336975475e88f9bc539d94000412885**\n\n## Instantly share code, notes, and snippets.\n\n[Python decryptor for newer AdWind config file - replicated from this Java version https://github.com/mhelwig/adwind-decryptor](https://github.com/mhelwig/adwind-decryptor)\n\n#!/usr/local/bin/env python\n\n########################################################################################################\n\n##\n\n## Decrypts the AdWind configiration files!\n\n## ** May also work for other files **\n\n##\n\n##\n\n## All credit to Michael Helwig for the original Java implementation:\n\n## https://github.com/mhelwig/adwind-decryptor\n\n##\n\n## See his blog here:\n\n## https://www.codemetrix.net/decrypting-adwind-jrat-jbifrost-trojan/\n\n##\n\n##\n\n## Author: @herrcore\n\n##\n\n########################################################################################################\n\n\n-----\n\n# pip install javaobj-py3 not javaobj\n\ntry:\n\nimport javaobj\n\nexcept:\n\nprint \"You need to install javaobj-py3... try pip install javaobj-py3\"\n\nfrom Crypto.Cipher import AES\n\nfrom Crypto.PublicKey import RSA\n\nimport argparse\n\nimport sys\n\ndef __read_file(file_path):\n\nwith open(file_path, \"rb\") as fp:\n\ndata = fp.read()\n\nif not data:\n\nprint \"Error: file %s could not be read\" % file_path\n\nsys.exit(-1)\n\nreturn data\n\ndef main():\n\nparser = argparse.ArgumentParser(description=\"Decrypt AdWind configuration files.\")\n\nrequiredNamed = parser.add_argument_group('required named arguments')\n\nrequiredNamed.add_argument('--rsa_file', dest=\"rsa_file\", default=None, help=\"Specify path to the serialized RSA KeyRep file\",\nrequired=True)\n\nrequiredNamed.add_argument('--aes_file', dest=\"aes_file\", default=None, help=\"Specify path to the AES file (RSA encrypted)\",\nrequired=True)\n\nrequiredNamed.add_argument('--config_file', dest=\"config_file\", default=None, help=\"Specify path to the encrypted config file\",\nrequired=True)\n\nargs = parser.parse_args()\n\nrsa_data = __read_file(args.rsa_file)\n\naes_data = __read_file(args.aes_file)\n\nconfig_data = __read_file(args.config_file)\n\n# deserialize the KeyRep RSA file\n\npobj = javaobj.loads(rsa_data)\n\n# extract RSA DES key from deserilized class\n\nrsa_priv_bytes = ''.join([chr(y&0xff) for y in pobj.encoded._data])\n\nrsa_priv_crypt = RSA.importKey(rsa_priv_bytes)\n\naes_key_data = rsa_priv_crypt.decrypt(aes_data)\n\n## Split on '\\x00' and remove the first bit as it's padding\n\n\n-----\n\n## If this fails we could fall back to hard coded: aes_key = aes_key_data[:-16]\n\naes_key = aes_key_data.split('\\x00')[-1]\n\n# default java aes is ECB with null iv\n\niv = b'\\x00'*16\n\naes_crypt= AES.new(aes_key, AES.MODE_ECB, iv)\n\nptxt_config = aes_crypt.decrypt(config_data)\n\nprint ptxt_config\n\nif __name__ == '__main__':\n\nmain()\n\n[Sign up for free to join this conversation on GitHub. Already have an account? Sign in to comment](https://gist.github.com/join?source=comment-gist)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-12 - Python decryptor for newer AdWind config file.pdf"
    ],
    "report_names": [
        "2018-03-12 - Python decryptor for newer AdWind config file.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535768,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653698865,
    "ts_modification_date": 1653698865,
    "files": {
        "pdf": "https://archive.orkl.eu/56428afe31e45d283fb3c0b52fb6b757b20c4bde.pdf",
        "text": "https://archive.orkl.eu/56428afe31e45d283fb3c0b52fb6b757b20c4bde.txt",
        "img": "https://archive.orkl.eu/56428afe31e45d283fb3c0b52fb6b757b20c4bde.jpg"
    }
}