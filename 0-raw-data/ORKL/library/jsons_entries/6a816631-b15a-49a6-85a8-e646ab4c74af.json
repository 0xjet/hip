{
    "id": "6a816631-b15a-49a6-85a8-e646ab4c74af",
    "created_at": "2023-01-12T15:01:26.150194Z",
    "updated_at": "2025-03-27T02:09:30.33701Z",
    "deleted_at": null,
    "sha1_hash": "dbe1d8237d847f233a3ce348fae5e640b2bf6dc3",
    "title": "2022-03-28 - Emotet is Back",
    "authors": "",
    "file_creation_date": "2022-05-28T00:28:15Z",
    "file_modification_date": "2022-05-28T00:28:15Z",
    "file_size": 1442377,
    "plain_text": "# Emotet is Back\n\n**blogs.cisco.com/security/emotet-is-back**\n\nMaria Jose Erquiaga March 28, 2022\n\n_The text below is a joint work of Maria Jose Erquiaga, Onur Erdogan and Adela Jezkova_\n_from Cisco Cognitive team_\n\nEmotet (also known as Geodo and Heodo) is a banking trojan, but it is also a modular\nmalware that can be used to download other malware as Trickbot and IcedID [8, 9, 13].\nEmotet was observed for the first time in 2014 [9]. In January 2021, in a combined effort by\nInterpol and Eurojust, Emotet was taken down [12]. However, Emotet rose again in\nNovember 2021, and it has shown more activity since 2022) [6, 7].\n\nEven though Emotet was born as a banking trojan, it evolved in time and became highly\nmodular threat. This evolution granted adversaries a tool for different purposes. Emotet can\nbe used as an initial payload and remain inactive for extended periods of time until the\nadversaries decide to leverage it [10]. This feature of Emotet gives the adversaries the\nflexibility to carry out a multi-stage infection process. This means that Emotet can act as\nbanking trojan, but also has been observed to drop additional malware in the infected\nsystems [1]. Emotet has the capability to gathering information of the infected systems and\nthe adversaries can evaluate the value of the asset [14, 15] Some analysis shows that\nEmotet can drop CobaltStrike, which then drops ransomware [11]. For example, one of the\nransomware dropped by Emotet is Ryuk [9].\n\n\n-----\n\nIn the past few months, Emotet malware has been observed in the wild, and its detection\ngrowth considerably [1]. Even though this Emotet re-appearance happened at (almost) the\nsame time as Log4J vulnerability was discovered, there is not enough evidence that these\ntwo things are related. However, CobaltStrike, which is known to be related to Emotet, was\nusing Log4J vulnerability [4].\n\nThe reappearance of Emotet motivated our deeper research and effort to update the\ndetection ability for Global Threat Alerts customers. As a result of it, the customers of Cisco\nSecure Network Analytics and Secure Endpoint using GTA get better coverage of the threat\nnow.\n\nWe summarize in this blog Emotet threat, it’s lifecycle and typical detectable patterns. In the\nsecond part of the blog we show how to use GTA to detect the Emotet.\n\n## Summary of Emotet characteristics\n\nModular banking trojan\nDownloader/Dropper\nPolymorphic – can evade signature-based detection\nVirtual machine aware\n\n## Emotet behavior\n\nThe attack flow is detailed in Figure 1. According to the analysis presented by Brad Duncan\n\n[2], the attack vector seems to be phishing, via an email with an attached file (1). The file\ncontained in the phishing email, is an Office document (2). When the victims open the office\ndocument files and enable macros (3) the Emotet DLL is downloaded in the victim’s device\n(4). After downloaded, this DLL file is executed (5) and it generates the connection with\nEmotet Command and control (6) [5, 7].\n\n\n-----\n\nFigure 1. Emotet attack flow\n\n## Attached files and PowerShell execution\n\nOnce the victim opens and executes the infected files and enables the macros (mainly with\ndocx or xml extensions), a command is executed to obtain and execute a HTML application.\nThe pattern of the URL observed for this step is the following:\n\nhxxp://{IP address}/[yy]/[y].{html|png}\n\nWhere “yy” are usually two alphabetical characters.\n\nFor example, one of the of the URLs founded in the wild:\n\nhxxp://91.240.118[.]172/hh/hello.png\n\nThen, it downloads PowerShell payload then it leads to downloading Emotet binary, which is\na dll file from any of the given URLs contained in the URL described above. The format, in\nthis case can vary, some of the URL’s patterns look like this:\n\nhttp://ttisecurity[.]com/cgi/7RFeiqkgymCs/\n\nWhere the regex is:\n\n.*/(gci/){0,1}[a-z0-9\\_]{3,20}$\n\nAnother pattern related to Emotet was\n\n.*/(wp-admin/){0,1}[a-z0-9\\_]{3,20}$\n\n\n-----\n\nDuring the download of the Emotet payload, user agent pattern was, Mozilla/5.0 (Windows\nNT; Windows NT %; en-US) WindowsPowerShell/5.1.%\n\n**DLL execution and Emotet C2**\n\nOnce the DLL files is in the infected system, it downloads a PE file and then establishes a\ncommunication with its Command and Control, using HTTP or HTTPS protocols, on ports 80,\n8080 and 443 [2]. Even though some researchers claim there is no relationship between\nLog4J vulnerability and Emotet, there are some common behaviours, as the use of the same\nIPs for C2. For example, those IP addresses are both related to Emotet and Log4j:\n\n250.21[.]2 and 116.124.128[.]206 founded in [4]\n94.252[.]3\n31.163[.]17\n178.186[.]134\n79.205[.]117\n\n## Detecting Emotet with Global Threat Alerts\n\nGTA (Global Threat Alerts) detects Emotet as a High-risk threat. The threat description\nincludes the MITRE software code and the techniques used by Emotet.\n\nFigure 2. Detail of Emotet description in GTA\nThe threat detail (see Figure 3) contains also extra information regarding the files that could\nhave been modified, deleted, or created by a particular threat. This information is enriched\nwith the analysis of Emotet samples in Cisco Threat Grid [16]. The patterns of the files that\ncould have been modified by Emotet, the probability of the malware behaviour, and the\nseverity level for each one of the events are provided. This extra information helps network\nadministrators and security teams to mitigate the threat not only in the network, but also in\nthe devices.\n\n\n-----\n\nFigure 3. Information regarding the behaviour of Emotet in endpoints, based on samples\nfrom Emotet. Includes probability of the event occurrence and severity level.\nFigures 4, 5, and 6, show different asset details from Emotet Alerts. It is possible to observe\nthere the traffic from the infected device to malicious IPs, hosts, and domains that are known\nto be related to Emotet. In the first case, the asset established communication with the\nhostnames 201.213.32[.]59, 45.55.82[.]2 and 89.32.150[.]160 (Figure 4). In the second\nexample, the asset communicated with the hostnames robertmchilespe[.]com and\nvbaint[.]com (Figure 5). In the third example, the detection found communication to the\ndomain 104.131.148[.]38 (Figure 6).\n\nFigure 4. Communication from the asset to hostnames 201.213.32[.]59, 45.55.82[.]2 and\n89.32.150[.]160 related to Emotet\n\nFigure 5. Communication from the asset to hostnames robertmchilespe[.]com and\nvbaint[.]com, related to Emotet\n\n\n-----\n\nFigure 6. Communication from the asset to the domain 104.131.148[.]38, related to Emotet\n[To verify if Emotet was detected in your environment, click Emotet Threat detail.](https://cta.eu.amp.cisco.com/ui/threats/9ee16ebf-0ff2-47e4-bfb9-896bc258e3e6)\n\n## Emotet mitigation\n\nTo prevent Emotet, we suggest the following measures:\n\nBlock emails with any attachment files that are suspicious\nScan suspicious files before opening them\nIsolate the infected devices from the rest of the network to avoid spreading\nRestrict the use of PowerShell and remote tools if possible\nReset all the user’s passwords in the infected devices\nConsider use 2FA (such as Cisco DUO)\n\n## Conclusions\n\nWe conducted research to find not only new IOCs (IPs, domains and samples) but also URL\npatters related to this new Emotet wave to keep our customers up to date on the latest\nthreats evolutions. The processed IOCs are also seeds to machine learning GTA algorithms\nwhich help to further enrich the detections. GTA users of Secure Endpoint and Secure\nNetwork Analytics can detect Emotet in their systems, execute mitigation actions and stay\nsafe from the evolution of this threat.\n\nReferences\n\n[1. Back from the dead: Emotet re-emerges, begins rebuilding to wrap up 2021. Talos](https://blog.talosintelligence.com/2021/11/emotet-back-from-the-dead.html)\n\nreport, November 2021.\n[2. Emotet Return. Published: 2021-11-16. Brad Duncan](https://isc.sans.edu/diary/28044)\n[3. How to Respond to Apache Log4j using Cisco Secure Analytics. Robert Harris](https://blogs.cisco.com/security/how-to-respond-to-apache-log4j-using-cisco-secure-analytics)\n[4. Emotet epoch 5 IOCs list, Brad Duncan. 2022](https://github.com/pan-unit42/tweets/blob/master/2022-02-10-IOCs-for-Emotet-epoch5-infection-with-Cobalt-Strike.txt)\n[5. New Emotet Infection Method. By Saqib Khanzada, Tyler Halfpop, Micah Yates and](https://unit42.paloaltonetworks.com/new-emotet-infection-method/)\n\nBrad Duncan. February 15, 2022\n[6. Cybersecurity Threat Spotlight: Emotet, RedLine Stealer, and Magnat Backdoor. By](https://umbrella.cisco.com/blog/cybersecurity-threat-spotlight-emotet-redline-stealer-magnat-backdoor)\n\nArtsiom Holub. February 3, 2022\n7. Emotet description. Malpedia. Fraunhofer Institut. Germany\n8. Emotet description, Wikipedia\n[9. Back from vacation: Analyzing Emotet’s activity in 2020. November 2020. Cisco Talos.](https://blog.talosintelligence.com/2020/11/emotet-2020.html)\n\nhttps://blog.talosintelligence.com/2020/11/emotet[2020.htmlhttps://blog.talosintelligence.com/2020/11/emotet-](https://blog.talosintelligence.com/2020/11/emotet-2020.html)\n2020.htmlhttps://blog.talosintelligence.com/2020/11/emotet-2020.html\n\n\n-----\n\n[10. Detecting Emotet Malware with Cognitive Intelligence](https://cisco.bravais.com/s/l3YBqz9pWmlGiocTIC0G)\n\n[11. Corporate Loader “Emotet”: History of “X” Project Return for Ransomware. By Yelisey](https://www.advintel.io/post/corporate-loader-emotet-history-of-x-project-return-for-ransomware)\n\n_Boguslavskiy & Vitali Kremez. December 2021_\n12. World’s most dangerous malware EMOTET disrupted through global action. January\n\n2021. Europol\n[13. Emotet Software description. MITRE](https://attack.mitre.org/software/S0367/)\n[14. The Commoditization of Multistage Malware Attacks. Chris Gerritz. DarkReading, July](https://www.darkreading.com/vulnerabilities-threats/the-commoditization-of-multistage-malware-attacks)\n\n2019.\n[15. Emotet growing slowly but steadily since November resurgence. Bill Toulas. Bleeping](https://www.bleepingcomputer.com/news/security/emotet-growing-slowly-but-steadily-since-november-resurgence/)\n\ncomputer. March 2022\n[16. Cisco Secure Malware Analytics (Threat Grid)](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\n\n_We’d love to hear what you think. Ask a Question, Comment Below, and Stay Connected_\n_with Cisco Secure on social!_\n\n**Cisco Secure Social Channels**\n\nShare:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-28 - Emotet is Back.pdf"
    ],
    "report_names": [
        "2022-03-28 - Emotet is Back.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535686,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653697695,
    "ts_modification_date": 1653697695,
    "files": {
        "pdf": "https://archive.orkl.eu/dbe1d8237d847f233a3ce348fae5e640b2bf6dc3.pdf",
        "text": "https://archive.orkl.eu/dbe1d8237d847f233a3ce348fae5e640b2bf6dc3.txt",
        "img": "https://archive.orkl.eu/dbe1d8237d847f233a3ce348fae5e640b2bf6dc3.jpg"
    }
}