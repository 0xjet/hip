{
    "id": "9a6fb0f2-ee54-4a15-9f2a-e5b490ee6351",
    "created_at": "2023-01-12T15:00:44.542977Z",
    "updated_at": "2025-03-27T02:13:50.357717Z",
    "deleted_at": null,
    "sha1_hash": "2eacebf5ffce2963dab455d3806ebaf0c6427d87",
    "title": "2020-05-18 - Eleethub- A Cryptocurrency Mining Botnet with Rootkit for Self-Hiding",
    "authors": "",
    "file_creation_date": "2022-05-27T23:14:11Z",
    "file_modification_date": "2022-05-27T23:14:11Z",
    "file_size": 1332097,
    "plain_text": "# Eleethub: A Cryptocurrency Mining Botnet with Rootkit for Self-Hiding\n\n**unit42.paloaltonetworks.com/los-zetas-from-eleethub-botnet/**\n\nAsher Davila, Yang Ji May 18, 2020\n\nBy [Asher Davila and](https://unit42.paloaltonetworks.com/author/asher-davila/) [Yang Ji](https://unit42.paloaltonetworks.com/author/yang-ji/)\n\nMay 18, 2020 at 9:10 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [botnet,](https://unit42.paloaltonetworks.com/tag/botnet/) [Coinminers,](https://unit42.paloaltonetworks.com/tag/coinminers/) [Cryptominers,](https://unit42.paloaltonetworks.com/tag/cryptominers/) [IoT,](https://unit42.paloaltonetworks.com/tag/iot/) [IRC,](https://unit42.paloaltonetworks.com/tag/irc/) [Perl shellbot](https://unit42.paloaltonetworks.com/tag/perl-shellbot/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/los-zetas-from-eleethub-botnet/)\n\n## Executive Summary\n\n[Unit 42 researchers uncovered a new botnet campaign using Perl Shellbot, intended to mine Bitcoin, while avoiding detection using a specially](https://blog.trendmicro.com/trendlabs-security-intelligence/perl-based-shellbot-looks-to-target-organizations-via-cc/)\ncrafted rootkit.\n\nThe bot is propagated by sending a malicious shell script to a compromised device that then downloads other scripts. After the victim device\nexecutes the downloaded scripts, it starts waiting for commands from its Command and Control (C2) server. While the Perl programming\nlanguage is popular in malware for its wide compatibility, this botnet can potentially affect not only Unix-based systems but also Windows 10\nsystems that use a Linux subsystem.\n\nThis new campaign uses a shared library called libprocesshider.so to hide the mining processes on the infected device and a specially crafted\nrootkit to avoid detection. The malicious actors use the name “Los Zetas”, which is an allusion to a Mexican criminal organization regarded as\none of the most dangerous drug cartels in the country. Despite that, it is unlikely that the attackers are actually part of this criminal\norganization. Additionally, this botnet has links to UnderNet, one of the largest IRC (Internet Relay Chat) networks where different topics are\ndiscussed including malware and cybercrime.\n\nMoreover, the botnet was still under development when it was uncovered. As a result, it doesn’t have many recruiters. However, it was\nimportant to stop it before the attackers compromised more devices. We observed that the botnet performs Bitcoin mining on its victim devices\non a growing scale using known mining tools such as xmrig and emech. These tools have been seen in recent coin mining campaigns, such as\n[VictoryGate and](https://www.zdnet.com/article/eset-takes-down-victorygate-cryptomining-botnet/) [Monero mining over $6000 for profit. We estimate the Eleethub botnet can also grow to make thousands of dollars if it](https://www.welivesecurity.com/2020/04/23/eset-discovery-monero-mining-botnet-disrupted/)\nexpands in a period of one to two years.\n\n## Shell Script Dropper\n\nA compromised device will download a malicious shell script containing commands to download pieces of the botnet and create directories to\ncopy the downloaded files into. Next, the device executes the downloaded files (procps.h, ps, setup, m) to start communicating with an IRC\nserver. Additionally, it downloads and implements a library called libprocesshider.so (Figure 1), which will be explained later.\n\n\n-----\n\nFigure 1. Downloaded files\n\n**Hiding Processes with a Rootkit**\n\n[This botnet takes the concealment of mining tasks to the next level. First, it reuses the well known open-source process-hiding library](https://github.com/gianlucaborello/libprocesshider)\nlibprocesshider to hide the mining process with LD_PRELOAD (Figure 2). This technique has been used in several past coin mining\ncampaigns, such as that perpetrated by the Rocke group Unit 42 found in 2019.\n\nFigure 2. x.sh\n\nIn addition, the attackers use a specially crafted rootkit to hide the mining operation from detection in the ps (process status) command.\nSpecifically, the malware replaces the original ps tool with a crafted one. The crafted tool calls the real ps (Figure 3) but filters off the mining\nprocesses xmrig and emech and sensitive keywords in the ps results such as proc, netstats, and tops (Figure 4). These keywords are usually\nassumed to be indicators of existing coin miners. By removing these keywords, the mining exploit hides itself from antivirus monitoring and\n[avoids being killed by other competing coin miners (Outlaw, for example), which usually scan the running processes to discover if any other](https://blog.trendmicro.com/trendlabs-security-intelligence/outlaw-updates-kit-to-kill-older-miner-versions-targets-more-systems/)\nminers are present.\n\n\n-----\n\nFigure 3. Installing rootkit\n\nFigure 4. Process hiding\n\n**Connecting to the Botnet**\n\nOnce the infected device has downloaded all the files in the rootkit (Figure 5) and has started running the malicious scripts, it will connect to an\nIRC server by sending an assigned nickname that starts with dark followed by a random integer number between 0 and 8999 (Figure 6).\n\n\n-----\n\n(zombie)\nThe initial PING is followed by the word LAG + the current epoch time (Figure 8).\n\n\nFigure 5. Installation of the rootkit\n\nFigure 6. Assigning a nickname to the compromised device\n\nFigure 7. Sending the first PING to the IRC server\n\n\nAdditionally, it contains scripts to communicate with the UnderNet IRC server as well (Figure 8).\n\nFigure 8. Sending a PING command to the IRC\n\nUndernet server\nBecause the botnet was not yet ready by the time we discovered it, we were unable to receive any commands from the IRC server. However,\nwe were able to connect manually to the IRC server and explore the channels available. We discovered that, fortunately, the Miners channel\nhad just a few recruiters or zombies (Figures 10 and 11).\n\n\n-----\n\nFigure 9. Channels found manually Figure 10. Zombies in\n\nthe botnet\nLater, the compromised device could start receiving commands to send attacks such as UDP floods, TCP floods, port scans, and HTTP\nattacks (Figure 7).\n\nFigure 11. Available attacks\n\nFigure 11. Available attacks\n\n**Los Zetas from Eleethub**\n\nThe domain associated with the C2 server is eleethub[.]com. We visited the website and found a message announcing that something was\ncoming, which probably was the botnet they were preparing (Figure 12).\n\n\n-----\n\nserver prints a banner (MOTD) with the name of that domain (Figure 13).\n\n\nFigure 12. Visiting eleethub[.]comIn addition, the IRC\n\nFigure 13. Message Of The Day - Eleet Hub\n\n\nThe phrase “Los Zetas” is mentioned multiple times in the malicious scripts that compose the botnet. The most notable ones are in the main\nrootkit directory, in the setup file (Figure 14), and in the information from the botnet operators undead[@]los[.]zetas[.]mx (Figure 15). “Los\nZetas” is a reference to a Mexican criminal organization, regarded as one of the most dangerous drug cartels in the country. However, it is\nunlikely that the attackers are actually part of this criminal organization.\n\nFigure 14. Reference to “Los Zetas” in setup file Figure\n\n15. User related to los[.]zetas[.]mx\n\n## Conclusion\n\nThe new Perl shell-based botnet uses libraries such as libprocesshider.so to hide mining activities. In addition, the attackers use a specially\ncrafted rootkit to hide the mining operation from discovery.\n\nThe Perl programming language is popular in malware for its wide compatibility across many Unix-based systems, such as Linux servers, PCs,\nand even IoT devices. Perl is a scripting language and does not need to be compiled for every different CPU architecture or firmware version.\nAnother advantage of using Perl scripts is the wide range of libraries that can easily be implemented. This type of botnet takes advantage of\nthe computing power of compromised devices to do various tasks such as coin mining and launching DDoS attacks.\n\nPalo Alto Networks customers are protected from the Perl shell botnet by the following platforms:\n\n1. Threat Prevention Signatures: 85843 that identifies IRC C2 communication.\n2. PAN-DB and DNS Security block the attackers’ C2 server URL and domain.\n3. WildFire identifies and blocks Perl shell botnets.\n4. Palo Alto Networks IoT Security detects attacks such as IRC botnets targeting IoT devices\n\n**Indicators of Compromise**\n\n**Samples**\n\n7ed8fc4ad8014da327278b6afc26a2b4d4c8326a681be2d2b33fb2386eade3c6\n\n\n-----\n\ndbe 55cc0e6 e690 9a ed dbc ebd0 c3 c dcc 56 89a acd5 6e 8 e8e 6\n\nd9001aa2d7456db3e77b676f5d265b4300aaef2d34c47399975a4f1a8f0412e4\n\n14c351d76c4e1866bca30d65e0538d94df19b0b3927437bda653b7a73bd36358\n\n6d1fe6ab3cd04ca5d1ab790339ee2b6577553bc042af3b7587ece0c195267c9b\n\n**C2 servers**\n\neleethub[.]com\n\nirc.eleethub[.]com\n\nghost.eleethub[.]com\n\n62.210.119[.]142\n\n82.76.255[.]62\n\n**Public keys found in the server**\n\n\n1\n2\n3\n4\n5\n6\n\n1\n2\n3\n4\n5\n6\n7\n\n\nssh-rsa\nAAAAB3NzaC1yc2EAAAABJQAAAQEAiF+LxAh219ufrvy9Pe1ujDZrIfLBtNlRVojyol/e/G\nPUNn+S/k78WaEgqsAXSdpLagCly2FxxZ6JWQx4f4js7DngLm3HWAyX3orlmMljmj60OmMDXPeWDfm3EMul/aVMUUfzXdriAWmHCIKdFrnal/\nfRm4coFgGaIi938ehd1IMdNdeEgyFfRZoEkd7PNVGtTLNtIcwkMF4XHZuS4WQvC95M5yga\nrrqB5PNTOS2oTOU36m3rXWFOhQ7N/NX4W+uLMExOWecHr4XIV3qzkeSu5wBoD0Vqi3wUvm\n9a+lJFFqnQ8w0ZX4J1mQ==\n\nssh-rsa\nAAAAB3NzaC1yc2EAAAABJQAAAQEAiF+LxAh219ufrvy9Pe1ujDZrIfLBtNlRVojyol/e/G\nPUNn+S/k78WaEgqsAXSdpLagCly2FxxZ6JWQx4f4js7DngLm3HWAyX3orlmMljmj60OmMD\nXPeWDfm3EMul/aVMUUfzXdriAWmHCIKdFrnal/MZhzgQ1evEPLFraKcvqkQrrcQTmsyKdE\nfRm4coFgGaIi938ehd1IMdNdeEgyFfRZoEkd7PNVGtTLNtIcwkMF4XHZuS4WQvC95M5yga\nrrqB5PNTOS2oTOU36m3rXWFOhQ7N/NX4W+uLMExOWecHr4XIV3qzkeSu5wBoD0Vqi3wUvm\n9a+lJFFqnQ8w0ZX4J1mQ==\n\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-18 - Eleethub- A Cryptocurrency Mining Botnet with Rootkit for Self-Hiding.pdf"
    ],
    "report_names": [
        "2020-05-18 - Eleethub- A Cryptocurrency Mining Botnet with Rootkit for Self-Hiding.pdf"
    ],
    "threat_actors": [
        {
            "id": "7c053836-8f50-4d40-bc5c-7088967e1b57",
            "created_at": "2022-10-25T16:07:24.549525Z",
            "updated_at": "2025-03-27T02:02:10.278474Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra",
                "Iron Group",
                "Rocke"
            ],
            "source_name": "ETDA:Rocke",
            "tools": [
                "Godlua",
                "Kerberods",
                "LSD",
                "Pro-Ocean",
                "Xbash"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "905eabd9-2b7f-483d-86bd-0c72f96b4162",
            "created_at": "2023-01-06T13:46:39.02749Z",
            "updated_at": "2025-03-27T02:00:02.980813Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra"
            ],
            "source_name": "MISPGALAXY:Rocke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0b02af5f-2027-42b7-a6f2-51e2fd49ba7f",
            "created_at": "2022-10-25T15:50:23.360509Z",
            "updated_at": "2025-03-27T02:00:55.45329Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Rocke"
            ],
            "source_name": "MITRE:Rocke",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535644,
    "ts_updated_at": 1743041630,
    "ts_creation_date": 1653693251,
    "ts_modification_date": 1653693251,
    "files": {
        "pdf": "https://archive.orkl.eu/2eacebf5ffce2963dab455d3806ebaf0c6427d87.pdf",
        "text": "https://archive.orkl.eu/2eacebf5ffce2963dab455d3806ebaf0c6427d87.txt",
        "img": "https://archive.orkl.eu/2eacebf5ffce2963dab455d3806ebaf0c6427d87.jpg"
    }
}