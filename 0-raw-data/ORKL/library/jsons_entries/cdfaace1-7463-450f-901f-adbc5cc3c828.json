{
    "id": "cdfaace1-7463-450f-901f-adbc5cc3c828",
    "created_at": "2023-01-12T15:02:58.331894Z",
    "updated_at": "2025-03-27T02:15:26.195531Z",
    "deleted_at": null,
    "sha1_hash": "241c0f18d108f3744381d3154761f4ef00a5e368",
    "title": "2022-04-20 - Microsoft Exchange servers hacked to deploy Hive ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:47:14Z",
    "file_modification_date": "2022-05-28T23:47:14Z",
    "file_size": 893467,
    "plain_text": "# Microsoft Exchange servers hacked to deploy Hive ransomware\n\n**[bleepingcomputer.com/news/security/microsoft-exchange-servers-hacked-to-deploy-hive-ransomware/](https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-hacked-to-deploy-hive-ransomware/)**\n\nBill Toulas\n\nBy\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nApril 20, 2022\n05:03 PM\n0\n\n\n-----\n\nA Hive ransomware affiliate has been targeting Microsoft Exchange servers vulnerable to\nProxyShell security issues to deploy various backdoors, including Cobalt Strike beacon.\n\nFrom there, the threat actors perform network reconnaissance, steal admin account\ncredentials, exfiltrate valuable data, ultimately deploying the file-encrypting payload.\n\n[The details come from security and analytics company Varonis, who was called in to](https://www.varonis.com/blog/hive-ransomware-analysis)\ninvestigate a ransomware attack on one of its customers.\n\n## A widely abused initial access\n\n[ProxyShell is a set of three vulnerabilities in the Microsoft Exchange Server that allow](https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-servers-are-getting-hacked-via-proxyshell-exploits/)\nremote code execution without authentication on vulnerable deployments. The flaws have\n[been used by multiple threat actors, including ransomware like Conti,](https://www.bleepingcomputer.com/news/security/conti-ransomware-now-hacking-exchange-servers-w) [BlackByte,](https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-hacked-to-deploy-blackbyte-ransomware/) [Babuk,](https://www.bleepingcomputer.com/news/security/microsoft-exchange-proxyshell-exploits-used-to-deploy-babuk-ransomware/)\n[Cuba, and](https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-hacked-to-deploy-cuba-ransomware/) [LockFile, after exploits became available.](https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-being-hacked-by-new-lockfile-ransomware/)\n\nThe flaws are tracked as CVE-2021-34473, CVE-2021-34523, and CVE-2021-31207, and\ntheir severity rating ranges from 7.2 (high) to 9.8 (critical).\n\nThe security vulnerabilities are considered fully patched as of May 2021, but extensive\ntechnical details about them were only made available in August 2021, and soon after that,\n[malicious exploitation started [1,](https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-servers-are-getting-hacked-via-proxyshell-exploits/) [2].](https://www.bleepingcomputer.com/news/security/cisa-warns-admins-to-urgently-patch-exchange-proxyshell-bugs/)\n\nThe fact that Hive's affiliate was successful in exploiting ProxyShell in a recent attack shows\nthat there is still room for targeting vulnerable servers.\n\n\n-----\n\n## From access to encryption\n\nFollowing the exploitation of ProxyShell, the hackers planted four web shells in an\naccessible Exchange directory, and executed PowerShell code with high privileges to\ndownload Cobalt Strike stagers.\n\n[The web shells used in this particular attack were sourced from a public Git repository and](https://github.com/ThePacketBender/webshells)\nwere merely renamed to evade detection during potential manual inspections.\n\n**Randomly-named web shells** _(Varonis)_\nFrom there, the intruders used Mimikatz, a credentials stealer, to snatch the password of a\ndomain admin account and perform lateral movement, accessing more assets in the\nnetwork.\n\n**Launching a new command prompt on the affected system** _(Varonis)_\nNext, the threat actors performed extensive file search operations to locate the most\nvaluable data to pressure the victim into paying a larger ransom.\n\nVaronis analysts have seen remnants of dropped network scanners, IP address lists, device\nand directory enumerations, RDPs to backup servers, scans for SQL databases, and more.\n\nOne notable case of network scanning software abuse was \"SoftPerfect\", a lightweight tool\nthat the threat actor used for enumerating live hosts by pinging them and saving the results\non a text file.\n\nFinally, and after all files had been exfiltrated, a ransomware payload named \"Windows.exe\"\nwas dropped and executed on multiple devices.\n\n\n-----\n\nBefore encrypting the organization s files, the Golang payload deleted shadow copies,\ndisabled Windows Defender, cleared Windows event logs, killed file-binding processes, and\nstopped the Security Accounts Manager to incapacitate alerts.\n\n**Commands executed by the final payload** _(Varonis)_\n\n## Hive evolution\n\nHive has gone a long way since it was first observed in the wild back in June 2021, having a\n[successful start that prompted the FBI to release a dedicated report on its tactics and](https://www.bleepingcomputer.com/news/security/fbi-shares-technical-details-for-hive-ransomware/)\nindicators of compromise.\n\n[In October 2021, the Hive gang added Linux and FreeBSD variants, and in December it](https://www.bleepingcomputer.com/news/security/hive-ransomware-now-encrypts-linux-and-freebsd-systems/)\n[became one of the most active ransomware operations in attack frequency.](https://www.bleepingcomputer.com/news/security/hive-ransomware-enters-big-league-with-hundreds-breached-in-four-months/)\n\nLast month, researchers at Sentinel Labs reported on a new payload-hiding obfuscation\nmethod employed by Hive, which indicates active development.\n\n### Related Articles:\n\n[Clop ransomware gang is back, hits 21 victims in a single month](https://www.bleepingcomputer.com/news/security/clop-ransomware-gang-is-back-hits-21-victims-in-a-single-month/)\n\n[BlackCat/ALPHV ransomware asks $5 million to unlock Austrian state](https://www.bleepingcomputer.com/news/security/blackcat-alphv-ransomware-asks-5-million-to-unlock-austrian-state/)\n\n[Windows 11 KB5014019 breaks Trend Micro ransomware protection](https://www.bleepingcomputer.com/news/security/windows-11-kb5014019-breaks-trend-micro-ransomware-protection/)\n\n[Industrial Spy data extortion market gets into the ransomware game](https://www.bleepingcomputer.com/news/security/industrial-spy-data-extortion-market-gets-into-the-ransomware-game/)\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n\n-----\n\n[Hive Ransomware](https://www.bleepingcomputer.com/tag/hive-ransomware/)\n[ProxyShell](https://www.bleepingcomputer.com/tag/proxyshell/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nBill Toulas is a technology writer and infosec news reporter with over a decade of\nexperience working on various online publications. An open source advocate and Linux\nenthusiast, is currently finding pleasure in following hacks, malware campaigns, and data\nbreach incidents, as well as by exploring the intricate ways through which tech is swiftly\ntransforming our lives.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/fbi-warns-of-ransomware-attacks-targeting-us-agriculture-sector/)\n[Next Article](https://www.bleepingcomputer.com/news/security/revils-tor-sites-come-alive-to-redirect-to-new-ransomware-operation/)\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-20 - Microsoft Exchange servers hacked to deploy Hive ransomware.pdf"
    ],
    "report_names": [
        "2022-04-20 - Microsoft Exchange servers hacked to deploy Hive ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "f7aa6029-2b01-4eee-8fe6-287330e087c9",
            "created_at": "2022-10-25T16:07:23.536763Z",
            "updated_at": "2025-03-27T02:02:09.85219Z",
            "deleted_at": null,
            "main_name": "Deceptikons",
            "aliases": [
                "DeathStalker",
                "Deceptikons"
            ],
            "source_name": "ETDA:Deceptikons",
            "tools": [
                "EVILNUM",
                "Evilnum",
                "Janicab",
                "PowerPepper",
                "Powersing",
                "VileRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4e453d66-9ecd-47d9-b63a-32fa5450f071",
            "created_at": "2024-06-19T02:03:08.077075Z",
            "updated_at": "2025-03-27T02:05:17.381141Z",
            "deleted_at": null,
            "main_name": "GOLD LOTUS",
            "aliases": [
                "Hecamede ",
                "BlackByte"
            ],
            "source_name": "Secureworks:GOLD LOTUS",
            "tools": [
                " Cobalt Strike",
                " ExByte",
                " MEGA",
                " RDP",
                " SoftPerfect Network Scanner",
                "BlackByte"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535778,
    "ts_updated_at": 1743041726,
    "ts_creation_date": 1653781634,
    "ts_modification_date": 1653781634,
    "files": {
        "pdf": "https://archive.orkl.eu/241c0f18d108f3744381d3154761f4ef00a5e368.pdf",
        "text": "https://archive.orkl.eu/241c0f18d108f3744381d3154761f4ef00a5e368.txt",
        "img": "https://archive.orkl.eu/241c0f18d108f3744381d3154761f4ef00a5e368.jpg"
    }
}