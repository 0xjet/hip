{
    "id": "9ed69ba3-e3cf-426a-842c-0ec88629e5e5",
    "created_at": "2023-01-12T15:04:04.682371Z",
    "updated_at": "2025-03-27T02:05:47.04306Z",
    "deleted_at": null,
    "sha1_hash": "fd85c7f6af43ece3de69e3b35e120b334e951141",
    "title": "2022-03-04 - New Wiper Malware Used Against Ukranian Organizations",
    "authors": "",
    "file_creation_date": "2022-05-28T00:24:42Z",
    "file_modification_date": "2022-05-28T00:24:42Z",
    "file_size": 1523532,
    "plain_text": "# New Wiper Malware Used Against Ukranian Organizations\n\n**[securityintelligence.com/posts/new-wiper-malware-used-against-ukranian-organizations/](https://securityintelligence.com/posts/new-wiper-malware-used-against-ukranian-organizations/)**\n\n[Malware March 4, 2022](https://securityintelligence.com/category/x-force/malware-threat/)\nBy [John Dwyer co-authored by Kevin Henson 3 min read](https://securityintelligence.com/author/john-dwyer/)\n\n\n-----\n\n**March 7, 2022 Update**\nA correction has been applied to this blog, further analysis of the wiper malware revealed\nthat the wiper leverages an implementation of the Mersenne Twister pseudorandom number\ngenerator (PRNG) and not ISAAC PRNG as originally reported. This blog has been updated\nto changing references from ISAAC PRNG to Mersenne Twister PRNG.\n\nOn February 24, 2022, [ESET reported another destructive wiper detected at a Ukrainian](https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/)\ngovernment organization dubbed as IsaacWiper. This is the [third sample of malware IBM](https://securityintelligence.com/posts/new-destructive-malware-cyber-attacks-ukraine/)\nSecurity X-Force has analyzed which has been reportedly targeting systems belonging to\nUkrainian organizations. IBM Security X-Force obtained a sample of the IsaacWiper\nmalware and has provided the following technical analysis, indicators of compromise and\ndetections.\n\n## IsaacWiper Analysis\n\nIsaacWiper is a destructive C++ malware that has been reported as being used in targeted\ncampaigns against Ukraine organizations. The original filename of the analyzed sample is\n“Cleaner.dll” and contains a compile date of February 25, 2022, 15:48:07 UTC.\n\nUpon execution, the function Start() is executed which begins by creating a log file within\n%ProgramData%. Following the creation of the log file, the wiper enumerates all physical\ndrives on the target system by calling DeviceIoControl() with the control code\nIOCTL_STORAGE_GET_DEVICE_ NUMBER. IsaacWiper checks the resulting physical\ndrive list for devices with type 7 (FILE_DEVICE_DISK) to identify disk volumes and physical\ndrives. With a list of disk objects, IsaacWiper leverages\nIOCTL_DISK_GET_DRIVE_GEOMETRY_EX and GetDiskFreeSpaceExW() to obtain the\nsize and available free space of each disk.\n\nLogfile %ProgramData%\\log.txt generated by the IsaacWiper sample analyzed by IBM\nSecurity X-Force:\n```\ngetting drives...\nphysical drives:\n-- system physical drive 0: PhysicalDrive0\nlogical drives:\n-- system logical drive: C:\n-- logical drive: D:\nstart erasing system physical drive...\nsystem physical drive -- FAILED\nstart erasing system logical drive C:\n\n```\nTo begin the wiping activity, IsaacWiper leverages CreateFileW() and DeviceIoControl() with\ncontrol code FSCTL_LOCK_VOLUME to lock the drive. With the drive locked, the wiper\nfunction first targets the PhysicalDrive by generating data created with a Mersenne Twister\n\n\n-----\n\npseudorandom number generator (PRNG) and overwriting the first 0x100000 bytes of the\nphysical drive with the PRNG data.\n\nAfter overwriting the PhysicalDrive, the malware starts overwriting drives and files. If the\nwiper can’t open a file, the file is renamed to a temporary file containing “Tmf” and a random\nfour-character string (example:Tmf3360.tmp) and overwritten with Mersenne Twister PRNG\ndata.\n\nIf a volume can’t be accessed, the wiper creates a hidden temporary directory and writes a\nfile to it at the root of the volume (ex: %SystemDrive%\\Tmd1234.tmp\\Tmf5432.tmp). The\ntemporary file Tmf5432.tmp is then filled with random data until the volume is out of space.\n\nMersenne Twister pseudorandom number generator (PRNG) data generation in the\nIsaacWiper sample analyzed by IBM Security X-Force.\n\n## Detection\n\nIBM Security X-Force has developed the following Yara signature to help identify instances\nof the IsaacWiper malware:\n```\nimport \"pe\"\nrule XFTI_IsaacWiper : IsaacWiper\n{\nmeta:\n\n```\n\n-----\n\n```\nauthor = IBM X-Force Threat Intelligence Malware Team\ndescription = \"Detects the IsaacWiper destructive malware based the debug\nmessages and imports.\"\nthreat_type = \"Malware\"\nrule_category = \"Malware Family\"\nusage = \"Hunting and Identification\"\nhash = \"13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033\"\nyara_version = \"4.0.2\"\ndate_created = \"3 Mar 22\"\ndate_updated = \"\"\nreference = \"\"\nstrings:\n$log_s6 = \"getting drives\" ascii wide nocase\n$log_s7 = \"start erasing physical drives\" ascii wide nocase\n$log_s8 = \"start erasing logical drive\" ascii wide nocase\n$log_s9 = \"start erasing system physical drive\" ascii wide nocase\n$log_s10 = \"system physical drive\" ascii wide nocase\n$log_s11 = \"start erasing system logical drive\" ascii wide nocase\ncondition:\n3 of ($log*) and (pe.dll_name == \"Cleaner.dll\" or\n(pe.imports(\"kernel32.dll\", \"GetTickCount\") and\npe.imports(\"kernel32.dll\", \"DeviceIoControl\")))\n}\n\n## Indicators of Compromise\n\n### File System:\n\n```\n```\nTmf<4 char>.tmp\n\n```\n\n%ProgramData%\\log.txt\n\n### Notable Strings:\n```\nPhysicalDrive\n\\\\.\\\n*.*\nC:\\ProgramData\\log.txt\ngetting drives...\nphysical drives:\n-- system physical drive\n-- physical drive\nlogical drives:\n-- system logical drive:\n\n```\n\n-----\n\n```\n-- logical drive:\nstart erasing physical drives...\n-- FAILED\nphysical drive\n-- start erasing logical drive\nstart erasing system physical drive...\nsystem physical drive -- FAILED\nstart erasing system logical drive\nCleaner.dll\n[email protected]\n\n## Recommendations\n\n```\nAt this time, X-Force recommends organizations consider implementing the indicators listed\nin this report into their security operations. Additionally, global businesses should seek to\nestablish sound insight into their respective networks, supply chains, third parties and\npartnerships that are based in, or serve in, region institutions. It is also advised that\norganizations open lines of communication between relevant information sharing entities to\nensure the receipt and exchange of actionable indicators.\n\nIf you have questions and want a deeper discussion about the malware and prevention\n[techniques, you can schedule a briefing here. Get the latest updates as more information](https://www.ibm.com/security/services/offensive-security-services?schedulerform)\n[develops on the IBM Security X-Force Exchange and the IBM PSIRT blog.](https://www.ibm.com/blogs/psirt/)\n\nIf you are experiencing cybersecurity issues or an incident, contact X-Force to help: US\nhotline 1-888-241-9812 | Global hotline (+001) 312-212-8034.\n\n[More cybersecurity threat resources are available here.](https://www.ibm.com/security/resources/crisis-management)\n\n[John Dwyer](https://securityintelligence.com/author/john-dwyer/)\nGlobal Threat Assessment Lead at IBM X-Force Incident Response\n\nJohn (@TactiKoolSec on Twitter) is the Global Threat Assessment Lead for the IBM X-Force\nIncident Response team where he focuses on modeling adversary operat...\n\n\n-----\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-04 - New Wiper Malware Used Against Ukranian Organizations.pdf"
    ],
    "report_names": [
        "2022-03-04 - New Wiper Malware Used Against Ukranian Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535844,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653697482,
    "ts_modification_date": 1653697482,
    "files": {
        "pdf": "https://archive.orkl.eu/fd85c7f6af43ece3de69e3b35e120b334e951141.pdf",
        "text": "https://archive.orkl.eu/fd85c7f6af43ece3de69e3b35e120b334e951141.txt",
        "img": "https://archive.orkl.eu/fd85c7f6af43ece3de69e3b35e120b334e951141.jpg"
    }
}