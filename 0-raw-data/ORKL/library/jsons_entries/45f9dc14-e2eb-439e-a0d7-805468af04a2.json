{
    "id": "45f9dc14-e2eb-439e-a0d7-805468af04a2",
    "created_at": "2022-10-25T16:48:20.064833Z",
    "updated_at": "2025-03-27T02:13:46.589367Z",
    "deleted_at": null,
    "sha1_hash": "b95f46cb8ba0cd021950a6afcd2599ce9ba370cd",
    "title": "Downeks and Quasar RAT Used in Recent Targeted Attacks Against Governments - Palo Alto Networks Blog",
    "authors": "",
    "file_creation_date": "2017-02-06T14:49:32Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 907325,
    "plain_text": "## MENU\n\n\n**[Blog Home > Unit 42 > Downeks and Quasar RAT Used in Recent Targeted Attacks Against](http://researchcenter.paloaltonetworks.com/)**\n**Governments**\n\n# Downeks and Quasar RAT Used in Recent Targeted Attacks Against Governments\n\n**[By Mashav Sapir, Tomer Bar, Netanel Rimer, Taras Malivanchuk, Yaron Samuel and Simon](http://researchcenter.paloaltonetworks.com/author/mashav-sapir/)**\n**Conant**\n**January 30, 2017 at 4:00 PM**\n**[Category: Unit 42](http://researchcenter.paloaltonetworks.com/unit42/)** **[Tags: Downeks, Government, Quasar RAT, threat research](http://researchcenter.paloaltonetworks.com/tag/downeks/)**\n\n**5,643** **(11)**\n\n**[Palo Alto Networks Traps Advanced Endpoint Protection recently prevented recent attacks](https://www.paloaltonetworks.com/products/secure-the-endpoint/traps)**\n**[that we believe are part of a campaign linked to DustySky. DustySky is a campaign which](https://securelist.com/blog/research/72283/gaza-cybergang-wheres-your-ir-team/)**\n**[others have attributed to the Gaza Cybergang group, a group that targets government](http://www.clearskysec.com/wp-content/uploads/2016/01/Operation DustySky_TLP_WHITE.pdf)**\n**interests in the region.**\n\n**This report shares our researchers’ analysis of the attack and Remote Access Tool (RAT). We**\n**also discovered during our research that the RAT Server used by this attacker is itself**\n**vulnerable to remote attack, a double-edged sword for these attackers.**\n\n## Attack\n\n**The initial infection vector in this attack is not clear, but it results in installing the “Downeks”**\n**downloader, which in turn infects the victim computer with the “Quasar” RAT.**\n\n**Downeks uses third party websites to determine the external IP of the victim machine,**\n**possibly to determine victim location with GeoIP. It also drops decoy documents in an**\n**attempt to camouflage the attack.�**\n\n**Quasar is a .NET Framework-based open-source RAT. The attackers invested significant�**\n**effort in attempting to hide the tool by changing the source code of the RAT and the RAT�**\n**server, and by using an obfuscator and packer.**\n\n## Detection\n\n**Unit 42 researchers observed the Quasar RAT being prevented from executing on a Traps-**\n**protected client in September 2016. We observed these Quasar samples:**\n\n\n-----\n\n**Note: connects to hnoor.newphoneapp[.]com**\n\n**File Name: HD_Audio.exe**\n**SHA256: 0c4aa50c95c990d5c5c55345626155b87625986881a2c066ce032af6871c426a**\n**Note: connects to manual.newphoneapp[.]com**\n\n**File Name: HD_Audio.exe**\n**SHA256: 86bd78b4c8c94c046d927fb29ae0b944bf2a8513a378b51b3977b77e59a52806**\n**Note: crashes upon execution**\n\n**File Name: sim.exe**\n**SHA256: 723108103ccb4c166ad9cdff350de6a898489f1dac7eeab23c52cd48b9256a42�**\n**Note: connects to hnoor.newphoneapp[.]com**\n\n**Further research found other Quasar examples, an attack earlier in the month 2016 on the**\n**same target:**\n\n**SHA256: 1ac624aaf6bbc2e3b966182888411f92797bd30b6fcce9f8a97648e64f13506f**\n\n**We found the same Quasar code in an additional attack on the same day, but upon a different�**\n**target. A second Quasar sample was also observed attacking this new victim:**\n\n**SHA256: 99a7cb43fb2898810956b6137d803c8f97651e23f9f13e91887f188749bd5e8f**\n\n**We do not have detailed visibility into the specific host attacked, and have not been able to�**\n**reproduce the second stage of the attack in our lab. However, based upon the timeframe of**\n**subsequent telemetry we observe, we understand the attack chain as follows:**\n\n**1. The initial dropper (which varies across attacks) is delivered to the victim via email or**\n\n**web:**\n\n**File Name: Joint Ministerial Council between the GCC and the EU Council.exe”**\n**SHA256: 0d235478ae9cc87b7b907181ccd151b618d74955716ba2dbc40a74dc1cdfc4aa**\n\n**2. The initial dropper, upon execution, extracts an embedded Downeks instance:**\n\n**File Name: ati.exe**\n**SHA256: f19bc664558177b7269f52edcec74ecdb38ed2ab9e706b68d9cbb3a53c243dec**\n\n**3. Downeks makes a POST request to dw.downloadtesting[.]com, resulting in the**\n\n**installation of the Quasar RAT on the victim machine.**\n**4. Additional Downeks downloaders connecting to the previously-observed server**\n\n**dw.downloadtesting[.]com were also found in this attack:**\n\n**SHA256: 15abd32342e87455b73f1e2ecf9ab10331600eb4eae54e1dfc25ba2f9d8c2e8a**\n\n**SHA256: 9a8d73cb7069832b9523c55224ae4153ea529ecc50392fef59da5b5d1db1c740**\n\n**Further research identified dozens of Dowenks and Quasar samples related to these�**\n**attackers. All included decoy documents written in Arabic (all related to Middle Eastern**\n**politics) or Hebrew. Most of them use the same mutex structure, share the same fake icon**\n**and unique metadata details, file writes, registry operations, and fake common program�**\n**metadata, as seen in DustySky samples.**\n\n\n-----\n\n**independent of each other. However, we did find a single shared IP address demonstrably�**\n**connecting the Downeks downloader and Quasar C2 infrastructure s. The below chart (Figure**\n**1) shows Quasar infrastructure (top), Downeks (bottom), and the shared IP link.**\n\n**_Figure 1- Quasar and Downeks_**\n\n**Charting the samples and infrastructure clearly shows the separate Downeks campaigns, and**\n**infrastructure links (Figure 2):**\n\n**_Figure 2- Infrastructure Patterns and Connections_**\n\n**In Figure 2, top-right (green) has the Quasar infrastructure (Figure 3), with a link to the**\n**Downeks infrastructure. Left (yellow) is DustySky infrastructure (Figure 4) and the links to this**\n**Downeks campaign. As well as similarities in the code, decoys and targets, we also identified�**\n**C2 infrastructure links between DustySky and this campaign. The remainder is sub-**\n**campaigns of Downeks samples, their infrastructure, their links – and a favored ISP (center)**\n**(Figure 5).**\n\n\n-----\n\n**The timing of the attacks is commensurate with the Middle-Eastern working week (Figure 6):**\n\n**_Figure 6- Attacks by day-of-the-week_**\n\n**The sample build days-of-the-week follow an almost identical pattern (Figure 7):**\n\n\n-----\n\n**_Figure 7- Builds by day-of-the-week_**\n\n**We saw five samples built on the same date in December 2015, and six on the same date in�**\n**January, further solidifying the link between each sample.**\n\n## Quasar\n\n**We analyzed a Quasar sample we found that was communicating with an active C2 server at**\n**the time of analysis:**\n\n**SHA256: 4393ff391396cdfd229517dd98aa7faecad04da479fe8ca322f035ceee363273�**\n\n**Quasar is a publicly-available commodity RAT, an evolution of his earlier xRAT, by German**\n**developer “MaxXor”. This sample is a modified version of Quasar, most likely forked from�**\n**[open source version 1.2.0.0 on GitHub. The client was likely built using the Quasar server](https://github.com/quasar/QuasarRAT/tree/v1.2.0.0)**\n**client builder. We observed the following customizations:**\n\n**C2 server:**\n\n**app.progsupdate[.]com, which resolved to 185.141.25[.]68), over port 4664.**\n\n**Quasar mutex name:**\n\n**VMFvdCsC7RFqerZinfV0sxJFo**\n\n**Keylogger log location:**\n\n**Users\\hJTQwqwwSCkZU\\AppData\\Roaming\\GoogleDesktop\\<date>**\n\n**The malware uses fake version information to appear as a Microsoft update program, as well**\n**as Google Desktop once unpacked.**\n\n\n-----\n\n## Packer\n\n**This sample is packed by “Netz”, a simple .NET Framework packer which stores the original**\n**executable compressed (zlib) as a resource. At runtime, the packer decompresses the**\n**resource and uses Reflection to load the assembly, find its Entry point, and Invoke it.�**\n**Extracting the payload is straight forward – we simply dump the resource and decompress it.**\n**After decompilation, the packer looks like this:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n\n\n**public** **static** **int** **Main(string[]** **args)** **{**\n**try** **{**\n**NetzStarter.InitXR();**\n**AppDomain.CurrentDomain.AssemblyResolve += new** **ResolveEventHandler(NetzStarter.NetzResolve**\n**return** **NetzStarter.StartApp(args);**\n\n\n**Find the resource and call InvokeApp:**\n\n\n**1**\n**2**\n**3**\n**4**\n\n\n**public** **static** **int** **StartApp(string[]** **args)** **{**\n**byte[]** **resource = NetzStarter.GetResource(\"A6C24BF5-3690-4982-887E-**\n**11E1B159B249\");**\n**return** **NetzStarter.InvokeApp(NetzStarter.GetAssembly(resource),** **args);**\n\n\n**Get the assembly object by decompressing the resource and loading it with Reflec�on:�**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n\n\n**private** **static** **Assembly GetAssembly(byte[]** **data)** **{**\n**MemoryStream memoryStream = (MemoryStream)** **null;**\n**memoryStream = NetzStarter.UnZip(data);**\n**memoryStream.Seek(0L,** **SeekOrigin.Begin);**\n**return** **Assembly.Load(memoryStream.ToArray());**\n**}**\n\n\n**And finally, find the entry point and invoke it:�**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n\n\n**private** **static** **int** **InvokeApp(Assembly assembly,** **string[]** **args)** **{**\n**MethodInfo entryPoint = assembly.EntryPoint;**\n**ParameterInfo[]** **parameters1 = entryPoint.GetParameters();**\n**object[]** **parameters2 = (object[])** **null;**\n**if** **(parameters1 != null && parameters1.Length > 0)**\n**parameters2 = new object[1]{ (object) args };**\n\n\n-----\n\n**SHA256: c931de65d9655a772d23e4227a627a1140d8d3c4912ca71c324421b13efa1a02**\n\n**This layer uses obfuscation in an attempt to avoid detection/analysis.**\n\n## Obfuscation\n\n**We discovered that the sample was obfuscated using .NET reactor. It is possible to decompile**\n**the deobfuscated sample and retrieve most of the original source code but not enough to**\n**compile it easily.**\n\n**After deobfuscation we extracted:**\n\n**SHA256: d773b12894d4a0ffb0df328e7e1aa4a7112455e88945a10471650e503eecdb3d�**\n\n\n-----\n\n## Quasar Code\n\n**A�er decompiling the sample, we were able to document the modifica�ons from the open-source Quasar.�**\n\n### Settings\n\n**The configura�on of Quasar is stored in the Se�ngs object, which is encrypted with a password which is itself�**\n**stored unencrypted.**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n**21**\n\n\n**public** **static** **class** **Settings** **{**\n**public** **static** **string** **VERSION;**\n**public** **static** **string** **HOSTS;**\n**public** **static** **int** **RECONNECTDELAY;**\n**public** **static** **string** **PASSWORD;** **// password for encryption of communication**\n**public** **static** **Environment.SpecialFolder SPECIALFOLDER;**\n**public** **static** **string** **DIR;**\n**public** **static** **string** **SUBFOLDER;**\n**public** **static** **string** **INSTALLNAME;**\n**public** **static** **bool** **INSTALL;**\n**public** **static** **bool** **STARTUP;**\n**public** **static** **string** **MUTEX;**\n**public** **static** **string** **STARTUPKEY;**\n**public** **static** **bool** **HIDEFILE;**\n**public** **static** **bool** **ENABLELOGGER;**\n**public** **static** **string** **ENCRYPTIONKEY;** **// Encryption password of the settings**\n**public** **static** **string** **TAG;**\n**public** **static** **string** **LOGDIRECTORYNAME;**\n**public** **static** **bool** **HIDELOGDIRECTORY;**\n**public** **static** **bool** **ISCHECKIP;**\n**public** **static** **int** **INSTARTUPFOLDER;**\n\n\n**Modifications:�**\n\n**The ISCHECKIP and INSTARTUPFOLDER are not found in open source Quasar**\n**samples.**\n\n### Cryptography\n\n\n-----\n\n**key is the SHA256 hash of the hard-coded password. The password of the sample we**\n**analyzed is:**\n\n**“6y7u^Y&U6y7u^Y&U6y7u^Y&U”**\n\n**Although at first glance this appears somewhat complex, it is in fact a rather simple, repeated�**\n**keyboard sequence. We observe similar keyboard patterns in other samples: “567%^&”,**\n**“zxc!@#ASD”.**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n**21**\n\n\n**public** **static** **void** **SetDefaultKey(string** **key)** **{**\n**byte[]** **bytes = Encoding.UTF8.GetBytes(key);**\n**AES._defaultKey = SHA256.Create().ComputeHash(bytes);**\n\n**private** **static** **void** **EncDec(Stream src,** **Stream ds,** **bool** **encDec,** **byte[]** **key)** **{**\n**RijndaelManaged rijndaelManaged = new** **RijndaelManaged();**\n**rijndaelManaged.Key = key;**\n**rijndaelManaged.Mode = CipherMode.ECB;**\n**rijndaelManaged.Padding = PaddingMode.PKCS7;**\n**rijndaelManaged.BlockSize = AES.BlockSize *** **8;**\n**if** **(encDec)** **{**\n**ICryptoTransform encryptor = rijndaelManaged.CreateEncryptor();**\n**CryptoStream cryptoStream = new** **CryptoStream(ds,** **encryptor,** **CryptoStreamMode.Write);**\n**long** **position = src.Position;**\n**AES.CopyTo(src,** **(Stream)** **cryptoStream,** **8192);**\n**cryptoStream.FlushFinalBlock();**\n**}** **else** **{**\n**ICryptoTransform decryptor = rijndaelManaged.CreateDecryptor();**\n**AES.CopyTo(new** **CryptoStream(src,** **decryptor,** **CryptoStreamMode.Read),** **ds,** **8192);**\n**}**\n**}**\n\n\n**Modifications:�**\n\n**Uses SHA256 instead of MD5 to create the key.**\n**Uses RijndaelManaged instead of AES for encryption. (with ECB mode, which is**\n**considered weak).**\n\n### Serialization\n\n**Quasar contains the NetSerializer library that handles serializa�on of high level IPacket objects that the client�**\n**and server use to communicate. The serializa�on assigns unique IDs for serializable objects types. The open�**\n**source and several other samples we found give a dynamically-assigned 1 byte ID at compile �me. The�**\n**sample we analyzed changed that behavior and hard-coded DWORD for each object type. This is a be�er�**\n**implementa�on, as it allows servers and clients from different versions to communicate with each�**\n**other to some extent.**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n\n\n**private** **static** **void** **initTypeMap()** **{**\n**Exts.dict_0.Add(typeof** **(object), -737641570);**\n**Exts.dict_0.Add(typeof** **(GetPasswordsResponse), -692037318);**\n**Exts.dict_0.Add(typeof** **(List<string>),** **1046249082);**\n**Exts.dict_0.Add(typeof** **(int), -118636331);**\n**Exts.dict_0.Add(typeof** **(string[]), -2103720204);**\n**Exts.dict_0.Add(typeof** **(string),** **1236129805);**\n\n\n### Version\n\n**The sample we analyzed is most likely forked from open source quasar 1.2.0.0. We find�**\n**multiple file/object names hinting at the version, but must compelling:�**\n\n\n-----\n\n**Quasar version 1.3.0.0 changed the encryption key generation, and stopped saving the**\n**password in the sample. There are more indications as well, such as names of objects,**\n**files etc.�**\n\n**Other samples we analyzed had different combinations of modification to cryptography and�**\n**serialization.**\n\n## The C2 server\n\n**Our decompilation of the serialization library was not complete enough to allow simple**\n**recompilation. Instead, we downloaded and compiled the 1.2.0.0 server of the open-source**\n**Quasar RAT, having determined that this seemed likely the most similar version. The out-of-**\n**the-box server could not communicate with the client sample owing to the previously**\n**documented modifications that we had observed. We incorporated those changes into our�**\n**build, discovering that this worked for most sample versions with almost no further**\n**modification.�**\n\n**Both the client and the server use the same code to serialize and encrypt the**\n**communications. Instead of compiling a different server for each client, our server uses the�**\n**code from within the client to communicate with it. Using Reflection, the server can load the�**\n**assembly of the client to find the relevant functions and passwords.�**\n\n### Load the client assembly:\n\n\n**1**\n**2**\n**3**\n\n\n**private** **static** **System.Reflection.Assembly assembly =**\n**System.Reflection.Assembly.LoadFile(@\"C:\\Users\\user1\\Desktop\\Quasar\\ServerVersionLo**\n**adClient\\resource.bin.open.exe\");**\n\n\n### Encryption:\n\n**Rather straight forward, as the server version uses the same API as the sample client.**\n\n### Get the AES class:\n\n\n**1** **private** **static** **Type tAES = assembly.GetType(\"_.Cr.Crp.AES\");**\n\n\n### Getting the setDefKey, encrypt and decrypt methods:\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n\n\n**private** **static** **System.Reflection.MethodInfo[]** **mi = tAES.GetMethods();**\n**private** **static** **System.Reflection.MethodInfo setDefKey = mi[1];** **// this one is used**\n**to** **set the current encryption key** **(IE sha256 of the password stored in** **Settings)**\n**//tAES.GetMethod(\"Encrypt\"); doesn’t work, because its ambiguous as it is overridden, so I**\n**private** **static** **System.Reflection.MethodInfo encMIBuf = mi[4];**\n**private** **static** **System.Reflection.MethodInfo decMIBuf = mi[6];**\n\n\n### Replace the server functions:\n\n\n**1** **public** **static** **void** **SetDefaultKey(string** **key)**\n\n\n**with**\n\n\n**1** **public** **static** **void** **setDefKey.Invoke(null,** **new** **object[]** **{** **key** **});**\n\n\n**1** **public** **static** **byte[]** **Encrypt(byte[]** **input)**\n\n\n**with**\n\n\n-----\n\n**});**\n\n\n**1** **public** **static** **byte[]** **Decrypt(byte[]** **input)**\n\n\n**with**\n\n\n**1** **public** **static** **byte[]** **data = (byte[])decMIBuf.Invoke(null,** **new** **object[]** **{** **input** **});**\n\n\n## Serialization:\n\n**This was more complex. Both the client and server uses the same API, but the client serializer**\n**cannot serialize server objects, because they are not the same as their “mirrored” objects**\n**inside the client. In some cases these objects are completely different, for example the server�**\n**commands to get the file system.�**\n\n**Our solution is to:**\n\n**1. Translate on the fly the objects the server send to mirrored matching client objects (will�**\n\n**not work if client doesn’t have this object, or renamed it).**\n**2. Copy the content from the server object into the new client object (will not work if client**\n\n**implementation is different).�**\n**3. Serialize the client object (which will be later encrypted and sent).**\n**4. Deserialize the decrypted response into another client response object.**\n**5. Translate the client response object into the server version of the client response object.**\n**6. Copy the contents from the client response object into the translated server object.**\n**7. Return the translated object.**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n**21**\n**22**\n**23**\n**24**\n**25**\n**26**\n**27**\n**28**\n**29**\n**30**\n**31**\n\n\n**public** **static** **void** **SerializeWrapper(Stream stream,** **object** **data)**\n**{**\n**System.Reflection.Assembly assembly = System.Reflection.Assembly.LoadFile(@\"C:\\Users\\user**\n**oadClient\\resource.bin.open.exe\");**\n**Type serializerType = assembly.GetType(\"_.Cr.NetSerializer.Serializer\");**\n**System.Reflection.PropertyInfo serInstanceProp = serializerType.GetProperty(\"Instace\");**\n**object** **serInstance = serInstanceProp.GetGetMethod().Invoke(null,** **new** **object[]** **{** **});**\n**System.Reflection.MethodInfo serializeMet = serializerType.GetMethod(\"Serialize\");**\n**Type typeOfData = data.GetType();** **string** **typeOfDataFullName = typeOfData.FullName;**\n**string** **typeOfDataFullNameNew = typeOfDataFullName.Replace(\"xServer.Core\",** **\"_.Cr\");**\n**Type packType = assembly.GetType(typeOfDataFullNameNew);**\n**object** **pacTypeInstance = packType.GetConstructor(new** **Type[]** **{** **}).Invoke(new** **object[]** **{** **})**\n**// now try to copy data into the instance**\n**foreach** **(FieldInfo fieldOfClient in** **packType.GetFields())**\n**{**\n**string** **fieldName = fieldOfClient.Name;**\n**FieldInfo fieldOfServer = typeOfData.GetField(fieldName);**\n**PropertyInfo PropOfServer = typeOfData.GetProperty(fieldName);**\n**object** **serverValue = null;**\n**if** **(fieldOfServer != null)** **{**\n**serverValue = fieldOfServer.GetValue(data);**\n**}** **else** **if** **(PropOfServer != null)** **{**\n**serverValue = PropOfServer.GetValue(data,null);**\n**}** **fieldOfClient.SetValue(pacTypeInstance,** **serverValue);**\n**}**\n**foreach** **(PropertyInfo fieldOfClient in** **packType.GetProperties())**\n**{**\n**string** **fieldName = fieldOfClient.Name;**\n**FieldInfo fieldOfServer = typeOfData.GetField(fieldName);**\n**PropertyInfo PropOfServer = typeOfData.GetProperty(fieldName);**\n\n**object serverValue = null;**\n\n\n-----\n\n**35**\n**36**\n**37**\n**38**\n**39**\n**40**\n**41**\n**42**\n**43**\n**44**\n**45**\n**46**\n**47**\n**48**\n**49**\n**50**\n**51**\n**52**\n**53**\n**54**\n**55**\n**56**\n**57**\n**58**\n**59**\n**60**\n**61**\n**62**\n**63**\n**64**\n**65**\n**66**\n**67**\n**68**\n**69**\n**70**\n**71**\n**72**\n**73**\n**74**\n**75**\n\n\n**}**\n**else** **if** **(fieldOfServer != null)** **{**\n**serverValue = fieldOfServer.GetValue(data);**\n**}**\n**fieldOfClient.SetValue(pacTypeInstance,** **serverValue,null);**\n**}**\n**serializeMet.Invoke(serInstance,** **new** **object[]** **{** **stream,** **pacTypeInstance** **});**\n**}**\n\n**public** **static** **object** **DeserializeWrapper(Stream stream)** **{**\n**System.Reflection.Assembly assembly = System.Reflection.Assembly.LoadFile(@\"C:\\Users\\use**\n**oadClient\\resource.bin.open.exe\");**\n**Type serializerType = assembly.GetType(\"_.Cr.NetSerializer.Serializer\");**\n**System.Reflection.PropertyInfo serInstanceProp = serializerType.GetProperty(\"Instace\");**\n**object** **serInstance = serInstanceProp.GetGetMethod().Invoke(null,** **new** **object[]** **{** **});**\n**System.Reflection.MethodInfo DeserializeMet = serializerType.GetMethod(\"Deserialize\");**\n**object** **ob = DeserializeMet.Invoke(serInstance,** **new** **object[]** **{** **stream** **});**\n**Type typeOfPacket = ob.GetType();** **string** **typeOfPacketFullName = typeOfPacket.FullName;**\n**string** **typeOfPacketFullNameNew = typeOfPacketFullName.Replace(\"_.Cr\",** **\"xServer.Core\");**\n**System.Reflection.Assembly currentAssembly = Assembly.GetExecutingAssembly();**\n**Type packTypeServ = currentAssembly.GetType(typeOfPacketFullNameNew);**\n**object** **pacTypeInstance = packTypeServ.GetConstructor(new** **Type[]** **{** **}).Invoke(new** **object[]**\n\n**// now try to copy data into the instance**\n**foreach** **(FieldInfo fi in** **typeOfPacket.GetFields())** **{**\n**string** **fieldName = fi.Name;**\n**FieldInfo fiServ = packTypeServ.GetField(fieldName);**\n**if** **(fiServ != null)** **{**\n**object** **clientSentValue = fi.GetValue(ob);**\n**fiServ.SetValue(pacTypeInstance,** **clientSentValue);**\n**}**\n**}**\n**foreach** **(PropertyInfo fi in** **typeOfPacket.GetProperties())** **{**\n**string** **fieldName = fi.Name;**\n**PropertyInfo fiServ = packTypeServ.GetProperty(fieldName);**\n**if** **(fiServ != null)** **{**\n**object** **clientSentValue = fi.GetValue(ob,null);**\n**fiServ.SetValue(pacTypeInstance,** **clientSentValue,null);**\n**}**\n**}**\n**return** **pacTypeInstance;**\n**}**\n\n\n## Communication\n\n**Our sample communicates with app.progsupdate[.]com, which resolved to 185.141.25[.]68, over TCP port**\n**4664.**\n\n## Architecture\n\n**This is the communication architecture between quasar client and server (Figure 8):**\n\n\n-----\n\n**_Figure 8- Communication Architecture_**\n\n**1. The server sends a command. for example, “Get System Information”.**\n**2. The command is translated to an IPacket of type GetSystemInfo.**\n**3. The packet is serialized into a stream of bytes.**\n**4. The stream of bytes is encrypted (in some versions there is also optional compression**\n\n**step).**\n**5. The stream of bytes is sent over TCP to the client.**\n**6. The client receives and decrypts the packet.**\n**7. The client deserializes the packet into IPacket GetSystemInfo.**\n**8. The relevant handler of the client is called, collects the system information and sends it**\n\n**back inside IPacket of GetSystemInfoResponse.**\n\n**Each of these layers seems to be different to some extent in the various samples we found.�**\n**The IPacket, Serialization and Encryption framework code is shared between the client and**\n**the server, therefore we can use it with Reflection. However the Server handlers and�**\n**command function are not, so we cannot create a completely perfect simulation.**\n\n## Initial handshake\n\n**After the TCP handshake completes, the server starts another handshake with the client by**\n**sending packets in the following order (Figure 9):**\n\n\n-----\n\n**_Figure 9- Initial Handshake_**\n\n**The client returns data to the server about the victim computer, which is displayed in the**\n**server GUI (Figure 10):**\n\n**_Figure 10- Quasar RAT Server GUI_**\n\n**The server and client then enter into a keep-alive mode, where the attacker can send**\n**commands to the client and receive further responses.**\n\n## RAT commands\n\n**The attacker can issue commands (not all commands appear in different samples) through the�**\n**Quasar server GUI for each client:**\n\n**Get system information**\n**Get file system�**\n**Upload / download / execute files�**\n**Startup manager**\n**Open task manager**\n**Kill / start processes**\n**Edit registry**\n\n\n-----\n\n**Shutdown / restart the computer**\n**Open remote desktop connection**\n**Observe the desktop and actions of active user**\n**Issue remote mouse clicks and keyboard strokes**\n**Password stealing**\n**Retrieve Keylogger logs**\n**Visit website**\n**Display a message box**\n\n**Our server build was able to successfully execute most of the commands.**\n\n**The file system commands underling handlers and IPacket were modified to support more�**\n**features, so these commands don’t work out of the box and required manual implementation**\n**from us.**\n\n## A Double-Edged Sword…\n\n**With further analysis of the Quasar RAT C2 Server, we uncovered vulnerabilities in the server**\n**code, which would allow remote code execution. This might allow a second attacker to install**\n**code of their choice – for example, their own Quasar RAT – on the original attacker’s server.**\n**We refer to this (somewhat ironic) technique as a “Double Edged Sword Attack”. We did not**\n**apply this to any live C2 servers – we only tested this with our own servers in our lab.**\n\n**In the lab, we changed our Quasar RAT source code to use the known encryption key, and to**\n**send fake victim IP address, City, Country code, Flag, and Username. The Quasar server**\n**does not verify the RAT data, and displays this data in the RAT Server GUI when the RAT is**\n**executed and connects to the server. We found this could be used to supply compelling**\n**“victim data” to convince the attacker to connect to this “victim” via the GUI.**\n\n**Quasar server includes a File Manager window, allowing the attacker to select victim files, and�**\n**trigger file operations – for example, uploading a file from victim machine to server. Uploaded�**\n**files are written to the server sub directory “clients\\user_name@machine_name_ipaddress”.�**\n\n**Quasar server does not verify that the size, filename, extension, or header of the uploaded file�**\n**is the same as requested. Therefore, if we convince the attacker to request the file�**\n**“secret_info.doc (20KB)”, we can instead return to the server any file of our choice, of any size�**\n**or type.**\n\n**When the Quasar server retrieves the name of the uploaded file from the victim, it does not�**\n**verify that it is a valid file path. Therefore sending the file path “..\\..\\ secret_info.doc ” will�**\n**result in writing our file instead to the same directory as the Quasar server code.�**\n\n**Quasar server does not even verify that a file was requested from the victim. Immediately�**\n**when the File Manager window is opened by the attacker, the Quasar server sends two**\n**commands to the RAT: GetDrives and listDirectory (to populate the list of the victim’s files in�**\n**the RAT Server GUI). We can respond to those commands by instead sending two files of our�**\n**choice to the Quasar server. Again, we control the content of the file, the size and the path�**\n**and filename.�**\n\n\n-----\n\n**technique to replace server DLLs.**\n\n**When the attacker restarts the Quasar application, our uploaded “dnsapi.dll” will instead be**\n**loaded. Through this vector, we could drop our own Quasar client on the attacker’s server**\n**and execute it. Our Quasar RAT will connect to our own (secured, of course) Quasar server,**\n**allowing us to control that attacker’s server with his own RAT. We can also replace**\n**“shfolder.dll” (and add a DLL export proxy to avoid a crash), which is loaded whenever the**\n**attacker clicks the builder tab – allowing us to infect the server while it runs, without the need**\n**to wait for application restart.**\n\n## Downeks\n\n**Although Downeks has been publicly examined to some extent, our analysis found several**\n**features not previously described.**\n\n**Earlier Downeks samples were all written in native code. However, among our Downeks**\n**samples, we found new versions apparently written in .NET. We observe many behavioral**\n**similarities and unique strings across both the native-Downeks versions, and the new .NET**\n**Downeks versions. Almost all of the strings and behaviors we describe in this analysis of a**\n**.NET version are also present in the native version.**\n\n**We observed these samples deployed only against Hebrew-speaking targets.**\n\n### Downeks.NET – “SharpDownloader”\n\n**Downeks .NET internal name is “SharpDownloader”, “Sharp” may be a reference to the**\n**language it was written in – C#.**\n\n**As seen in previous Downeks versions, it uses masquerades with icons, filenames and�**\n**metadata imitating popular legitimate applications such as VMware workstation (Figure 1) and**\n**CCleaner, or common file formats such as DOC and PDF.�**\n\n\n-----\n\n**_Figure 11 – Application metadata masquerading as VMWare Workstation_**\n\n**All 3 samples were compiled with the same timestamp. Downeks.NET is obfuscated using**\n**[“Yano” and can be easily de-obfuscated using the de4dot utility.](https://github.com/0xd4d/de4dot)**\n\n**SHA256: 4dcf5bd2c7a5822831d9f22f46bd2369c4c9df17cc99eb29975b5e8ae7e88606**\n**SHA256: 905f6a62749ca6f0fd33345d6a8b1831d87e9fd1f81a59cd3add82643b367693**\n**SHA256: c885f09b10feb88d7d176fe1a01ed8b480deb42324d2bb825e96fe1408e2a35f**\n\n## Communication\n\n**Downeks is a backdoor with only very basic capabilities. It communicates with the C2 server**\n**using HTTP POST requests.**\n\n**It runs in an infinite loop, in each iteration it requests a command from the C2, and then it�**\n**sleeps for a time period it receives in the C2 response (defaulting to 1 second if no sleep-time**\n**sent).**\n\n**The data that is sent in the POST is serialized with json, which is then is encrypted, and finally�**\n**encoded in base64. The json format is typically {“mth”:”some_method”,**\n**“data”:”some_encrypted_data”}. The C2 server responds using the same format and**\n**serialization/encryption/encoding.**\n\n## Download and Execute\n\n**As described in earlier analyses, Downeks’ main purpose is as a downloader. Unfortunately,**\n**we were unable to get any C2 servers to issue download commands to any samples that we**\n**tested in our lab.**\n\n\n-----\n\n**that already exist on the victim machine. After successful execution, Downeks returns the**\n**results to the C2 server.**\n\n**Downeks also has a self-update capability, if instructed by the C2.**\n\n## Screen Capture\n\n**Downeks can be instructed with the “img” command to capture the victim screen and**\n**transmit it back to the C2. The parameters “wth” and “qlt” specify “width” and “quality”.**\n\n## Appdata\n\n**Downeks .NET creates a file in the “Appdata” directory, based on certain properties of the�**\n**machine. During our analysis, Downeks created a file in “Appdata\\Roaming” containing only�**\n**“SD{new line} 0” (“SD” possibly for “SharpDownloader”).**\n\n**Althought this file itself is not particularly interesting, the older (native) Downeks versions also�**\n**creates a file in Appdata\\Roaming, with identical data.�**\n\n**The filenames across the two variants bear striking similarities. The .NET variant creates�**\n**“1FABFBFF0000065132F71D94”, while the native version creates “000206511FABFBFF”. We**\n**observed the string “1FABFBFF0000065132F71D94” in memory during debugging of the**\n**native variant (Figure 12). This is a pseudo-unique ID for each machine, based on install date**\n**taken from the registry, volume serial number, OS version and service pack, Processor**\n**architecture, and computer name.**\n\n**_Figure 12 – Machine ID in memory_**\n\n## Installed Antivirus check\n\n**Downeks enumerates any antivirus products installed on the victim machine and transmits**\n**the list to the C2. It constructs this list using the WMI query:**\n\n**“SELECT displayName FROM AntivirusProduct”**\n\n## Persistence\n\n**Downeks achieves host persistence through either the registry “run” key or with a shortcut in**\n**the start-up folder.**\n\n## External IP\n\n**In another similarity between both variants, Dowenks assesses the victim’s external IP using**\n**an HTTP request to http://www.myexternalip.com/raw.**\n\n## Oth d\n\n\n-----\n\n**Check if the computer name and user name, or external IP address, is in a provided list**\n**and if so, display a message box with a message as defined by the C2.�**\n**Kill any running process and attempt to delete the associated executable.**\n**“Setup” command – sends various info about the machine with each iteration of the C2**\n**communications loop.**\n\n## Encryption keys\n\n**Downeks has static encryption keys hardcoded in the code. These keys are initialized in the**\n**“Defaults” class constructor, suggesting that the author of this malware has great affection for�**\n**stackoverflow:�**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n\n\n**static** **Defaults()**\n**{**\n**ResEncKey = Strings.Get(0x1524);** **// resolves to “$t2ck0v3rFl0w”**\n**RarPass = Strings.Get(0x1539);** **// resolves to “123456”**\n**ServerTransKey = Strings.Get(0x1542);** **// resolves to “P@$sw0rD$nd”**\n**DataEncKey = Strings.Get(0x1553);** **// resolves to “$t@k0v2rF10w”**\n**ConnRequestKey = Strings.Get(0x1564);** **// resolves to “1q@W3e$RQ!w2E#r4”**\n**}**\n\n\n## Typos\n\n**We observed some typos in the code, such as “responce” ( “response”) and “GroubID”**\n**(“GroupID”) in this version.**\n\n## Coverage & IoCs\n\n**Palo Alto Networks customers are protected from Downeks and Quasar used in this attack:**\n\n**WildFire properly classifies these Downeks and Quasar samples as malicious.�**\n**Traps detects and blocks malicious behavior exhibited by new, unknown Quasar**\n**samples.**\n**C2 servers associated with this activity are blocked through Threat Prevention DNS**\n**signatures.**\n**[AutoFocus customers can monitor this activity using the Downeks and QuasarRAT tags.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Downeks)**\n\n**A list of Indicators of Compromise can be found in Appendix C – IoCs.**\n\n## Appendix A – IoCs\n\n### C2 Domains\n\n**downloadtesting.com**\n**gameoolines.com**\n**onlinesoft.space**\n**newphoneapp.com**\n**gamestoplay.bid**\n**smartsftp.pw**\n**galaxysupdates.com**\n\n**l**\n\n\n-----\n\n**progsupdate.com**\n**topgamse.com**\n**bandtester.com**\n**speedbind.com**\n**ukgames.tech**\n**wallanews.publicvm.com**\n**wallanews.sytes.net**\n**noredirecto.redirectme.net**\n**dynamicipaddress.linkpc.net**\n**downloadlog.linkpc.net**\n**havan.qhigh.com**\n**kolabdown.sytes.net**\n**rotter2.publicvm.com**\n**ftpserverit.otzo.com**\n**webfile.myq-see.com�**\n**downloadmyhost.zapto.org**\n**help2014.linkpc.net**\n**safara.sytes.net**\n**exportball.servegame.org**\n**viewnet.better-than.tv**\n**down.downloadoneyoutube.co.vu**\n**netstreamag.publicvm.com**\n**hostgatero.ddns.net**\n**subsidiaryohio.linkpc.net**\n**helpyoume.linkpc.net**\n\n## Quasar & Downeks SHA256s\n\n**3053e1e8df7e525ef98a77190cefce258aea365e2998425ecc8e139230680156**\n**f19bc664558177b7269f52edcec74ecdb38ed2ab9e706b68d9cbb3a53c243dec**\n**0d235478ae9cc87b7b907181ccd151b618d74955716ba2dbc40a74dc1cdfc4aa**\n**96c1346351a53c865afef5e087a8cbcf8e28d652fbc083a93399a8b94328d456**\n**15abd32342e87455b73f1e2ecf9ab10331600eb4eae54e1dfc25ba2f9d8c2e8a**\n**b66e5af52fd4d802f64788692b3eafe6b5ff61cea09c06a237a96b6cdb90b41a�**\n**55a7ca1e5ed2d74c7eb6ab6a985c1d369157a91275f575967aefb7ddb3388e0c**\n**9a8d73cb7069832b9523c55224ae4153ea529ecc50392fef59da5b5d1db1c740**\n**39bdeaded0f919caa6697ae1ae4953de1c7afa79905939dbbd8c647a84f6cd07**\n**0e41c3611da6e3a2b0dd0d43b9ce0b3f3405472efa5760767719cc82692afb7b**\n**bc7c3f687d0589a4db53475bc65056a628b52aa27f84c1d76b9fe686d495df27**\n**0d1aa670df8ae1379d6997c9dc8b40c893ee395c3d45b84c2ad1732e86973143**\n**8ac7138215b2500d0737b483b9194419c0e0248014147e84f43b1e2b409184cf**\n**8ca99455d244fab2701beb5127f94745154e03ac1231a58f8bd2cd01732a341b**\n**a149340f920888256902e28e4c5d8587fed3037682e875ed1fdf6a3213c50e92**\n**78aaed20914d3895708985aee089a464b31e11eb3b3e90b530dcebbe10e915ec**\n**704b19e0460a0fa7d952ba6feb5eadb9054895d1d753df72faf6f470446a0519**\n\n\n-----\n\n**d3c710eaaf849598fa486823da42bdce03ea3c9421c3936e3330e98b34e4ef47**\n**e6e9f7b0449976537d9276192e5767c9909cd34df028a8bf1cac3dbe490f0e73**\n**75336b05443b94474434982fc53778d5e6e9e7fabaddae596af42a15fceb04e9**\n**4dcf5bd2c7a5822831d9f22f46bd2369c4c9df17cc99eb29975b5e8ae7e88606**\n**b8a3096a396c28462c0d168d97e28573e0e6d272bbc1dd2432e7effe098bd979�**\n**905f6a62749ca6f0fd33345d6a8b1831d87e9fd1f81a59cd3add82643b367693**\n**c885f09b10feb88d7d176fe1a01ed8b480deb42324d2bb825e96fe1408e2a35f**\n**0c4aa50c95c990d5c5c55345626155b87625986881a2c066ce032af6871c426a**\n**1ac624aaf6bbc2e3b966182888411f92797bd30b6fcce9f8a97648e64f13506f**\n**1acffe68fcdc301b8ab7640eda75ff82788b2f93d869e421e28bacbba93b76d1�**\n**723108103ccb4c166ad9cdff350de6a898489f1dac7eeab23c52cd48b9256a42�**\n**99a7cb43fb2898810956b6137d803c8f97651e23f9f13e91887f188749bd5e8f**\n**86bd78b4c8c94c046d927fb29ae0b944bf2a8513a378b51b3977b77e59a52806**\n**3243292E46A198BD83E0DCE58258312852C99217187E6D5399066189FEB2677B**\n**9b8d8780454708b950459d43161097ac72f62ff349bc8f379b5b2216bc9ae935�**\n**3619b12b11cda6e87644d3316355d99ee5fa5407aa8a8f107aa1058e33b19bf6**\n**0f8378603e269db16eb7eaca933b587c7de3e914c1d9afaaae688c410befb895**\n**d3066fa4a7a1ef38c753796479768b765c6903ef50c35352e29e79dcd49e4348**\n**39b991838653739eef482af6336fcf03922d7e9d88d17946b688a513dd2bfc34**\n**4393ff391396cdfd229517dd98aa7faecad04da479fe8ca322f035ceee363273�**\n**759ae70b035c3bbb6699520db3a55f3947e6ba1b5ce639ec036e3096ee10b26d**\n**17942d9d76dafb64aa0d3ab53c9ee56e5d8bd4477440f06780b70dd4c02af8b8**\n**fea74bf9eed7363f97a09756b4652409cfcd7bbe023383805aec5da7de6310bd**\n**f5413c785770400215c3191ea887517b4380ec81be4e5bdc5aea12bf82f9105d**\n**8cdbea2aea51f73c68adc517eed533802e1f3b2a9ec0b0560b6bb8fc03ac3e4f**\n**dbdc72a7cfbf03599b95d8f1c47e157da34ea5d2f951cf5f49715e8caab58cd4**\n**65986f6f919e9152176a10ae3964fac130ae6195e189453d17306a225022774d**\n**91a4e395d57a52a85a2bda653a0ed796865e8af01c1345dff63469759448daf0�**\n**53e82d01dd2502416ad49329e1224a7c4519182186e60f690ecd0cf266f5af5e**\n**575708d3eb23f8111b7174408f05caf6574c5d6782c750562bfb9abe48cb219e**\n**fefa0781e88fa215419b2a1294c8b952b192f8360aeab2f97bbd9cea15fc7338**\n**ea16f0d55918752ad432d0da03a7e39ab9a8442b74ae0bbe724900605a9ba71f**\n**6f6414c8f8a800c769da1f6994cad25757a2928375803a498171db3395183b98**\n**dbeb3c262cc6eefea93846f817e8333ee541ec23d19ffef56a94585e519e6ff1�**\n**2ddce8b010f011a04cf24dc8e5932ae13b463dd6a3cb9bf02ae835b04a70d042**\n**182c82100069834ad4a8dadee6874cfb612f0b9babc7cd3ee5d69f16440ad6d7**\n**f772463bafef5f45f675658eee43b6f56911a4f449afb0cc68ac068002a2f875**\n**b30e3dc47848666e71c1f13050a6502b2c2a7a542ee867d152ffb2dd186d7114�**\n**e5e4895d2195e14a3a105f3ed73fd49493e9dbdd7dfc6f6616023473fa8f86c6**\n**f4eda40b3f1c77f8f9e02674d93214dd31c13080b034e37b26cc66d744500b1e**\n**95d9a2b664e3e5c1206d94241ded115643aa0452dd3fe3338363ff826260f40c�**\n**575b84c2d3bceebfabb2deb289a230f52aca2c504aa854251c1e9057f3f0cf5a**\n**21f09c93325c03940c24d8bd6f33a1a4876bfd5feb8c8bac05b0a359255c0b42**\n**695821451be582d85cd8e42ce4446f131bd474e6c715bdf13fe8bac6de34b2e3**\n\n\n-----\n\n**b6adae77a975058720e525a7f6d2451a01fedd3c6cab1515570d8490a8eb4f67**\n**d735c19fc9223e1bc4e625c1f47801d758426fbae89e5086bc56a8d6b1df2011**\n**a66a27d801891e39d3819355366399fabbf2f05327ddb7c7b5d304fabeac7118**\n**cdf4ec8beb3f15d04b54165b53475aa03949a67f9cb1847a749b2fb44a3fe0a4**\n**0045c28ed2a9d98efb798ec59f34b6a3058838f933af7c0dae6482a0e86e37bf**\n**8814fec28ccac77456be73305b32ad5a266a4929203b2acf431759c90fe579bd**\n**f1b682808f1819f0e3d030fce1fd6b1ca95ad052b069e028cd9ed4afd81cd4d6**\n**f361974e6fd6a6d7cfbfafb28159c4f8e514fe6f399788be4daa2449767d5904**\n**11b1088ad962984f6df89ccc6bbc98bf220af952dec0b4622f8453a0a164cb65**\n**Aacf24e288388431b30f8da765b4696975adc9cc0303d285abb05077eda21da2**\n**02bd710d3055076f86116d28427322c9cb623291c6c5a66c1932181fc6558586**\n**5e7d68c53212f6d467533f105d4a067682e28da47304a53c17b056d2b4404f0a**\n**3ff059a53e38f9fcd24e8d6bf008b4e14733db317857764cfcef736119ff26c9�**\n**dcc04adf96045e7227a0e1f1d092919276b21035bcb3c5ed462650ef8d2e7aa3**\n**20e3d4c9223955495d00e72e2fedfe825e9fcda57696a255215895cfba490876**\n**6050d4c1efcf8242382293842313f3a93309f1e449197d98c60cec29090c6bff�**\n**1d533ddaefc7859a3f6c6751114e895b7aa5935eb0ed68b01ec61aa8560ae3d9**\n**488ba22d6cb8c9b0310c58fa4c4739692cdf45676c3164b357314322542f9dff�**\n**7eeeae1f2fc62653593c7ce254e9cf855905035c2e8f8c0588887cb8e99dd770**\n**d2d08bb2707b635617e5bab0fcd033b6f68a753dd2b3897adca1c627758e686b**\n**d30dbf17078a11c32dd23acea42335860e739c9f18bf0ed611132eef4d5cfcb6**\n**7c578dcdcefe78fb1dd51ac611f6450d9eb5be6c5f1e3363f460321a46be4a39**\n**a40627acae6917787e92f9efa85739136c1670dcc5fe66695e105ddd72d7b80a**\n**5668470c92408f4b9f3a659005c2acca9da8df750cc491bffc88ef640474fa4a�**\n**d735c19fc9223e1bc4e625c1f47801d758426fbae89e5086bc56a8d6b1df2011**\n**25e6bf67410dffb95c527c19dcff5223dbc3bf4c987650e45fbea1267072e8ff�**\n**f53fd5389b09c6ad289736720e72392dd5f30a1f7822dbc8c7c2e2b655b4dad9**\n**2c2ae3f482d9db2541de0d855b5b12cd18028a94887f0c28acf1e2d6a4f3d4ac**\n**a35e2b21f7f770debcffc79eb4834ec8881465df06cee41af705b6ea5d899978�**\n**a7aeeead233fcdfe1c7475db982497a82d8ae745ec1c58bd87215e8869c3f9e4**\n**f0e3562d0438695c7f3af0c280968cfc7134b484010d9ba2aceab944b441b127**\n**f5413c785770400215c3191ea887517b4380ec81be4e5bdc5aea12bf82f9105d**\n**29049e2c7671a7c4fc953cb76e539150cc7c80e1b83c19d0894dfa446ce5276e**\n**2eb7aa306551d693691d14558c5dc4f6d80ef8f69cf466149fbba23953c08f7f**\n**dbdc72a7cfbf03599b95d8f1c47e157da34ea5d2f951cf5f49715e8caab58cd4**\n**de3e25a69ba43b9f236e544ece7f2da82a4fafb4489ad2e263754d9b9d88bc5c**\n**bc846caa05939b085837057bc4b9303357602ece83dc1380191bddd1402d4a2b**\n**44b99603dde822b6b86577e64622e9a2f5b76b6d8bd23a3fe1b4d91b73d0230a**\n**bb24105295588d14c4509ec7374fbe6f7a4821cf4e9d9282754dd666ad7a7ea1**\n\n### Got something to say?\n\n\n-----\n\n**Leave a comment...**\n\n\n**Notify me of followup comments via e-**\n**mail**\n\n\n**Name (required)**\n\n\n**Email (required)**\n\n\n**Website**\n\n\n**SUBMIT**\n\n\n**SUBSCRIBE TO NEWSLETTERS**\n\n**Email**\n\n**COMPANY**\n\n**[Company](https://www.paloaltonetworks.com/company)**\n\n**[Careers](https://www.paloaltonetworks.com/company/careers)**\n\n**[Sitemap](https://www.paloaltonetworks.com/sitemap)**\n\n**[Report a Vulnerability](https://www.paloaltonetworks.com/security-disclosure)**\n\n**LEGAL NOTICES**\n\n**[Privacy Policy](https://www.paloaltonetworks.com/legal-notices/privacy)**\n\n**[Terms of Use](https://www.paloaltonetworks.com/legal-notices/terms-of-use)**\n\n**ACCOUNT**\n\n\n**Email**\n\n\n-----\n\n**© 2016 Palo Alto Networks, Inc. All rights reserved.**\n\n\n**[TAKE A TEST DRIVE](http://connect.paloaltonetworks.com/virtual-utd)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.01.30.downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments.pdf"
    ],
    "report_names": [
        "unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments"
    ],
    "threat_actors": [
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041626,
    "ts_creation_date": 1486392572,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/b95f46cb8ba0cd021950a6afcd2599ce9ba370cd.pdf",
        "text": "https://archive.orkl.eu/b95f46cb8ba0cd021950a6afcd2599ce9ba370cd.txt",
        "img": "https://archive.orkl.eu/b95f46cb8ba0cd021950a6afcd2599ce9ba370cd.jpg"
    }
}