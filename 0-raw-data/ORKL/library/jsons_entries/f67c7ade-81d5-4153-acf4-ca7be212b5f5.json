{
    "id": "f67c7ade-81d5-4153-acf4-ca7be212b5f5",
    "created_at": "2023-01-12T15:05:35.855514Z",
    "updated_at": "2025-03-27T02:05:41.629916Z",
    "deleted_at": null,
    "sha1_hash": "8eba97ee10a8ea42d3fdca26e07777869478cfbc",
    "title": "2021-01-22 - SolarWinds- How Sunburst Sends Data Back to the Attackers",
    "authors": "",
    "file_creation_date": "2022-05-28T23:07:56Z",
    "file_modification_date": "2022-05-28T23:07:56Z",
    "file_size": 540763,
    "plain_text": "# SolarWinds: How Sunburst Sends Data Back to the Attackers\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-sunburst-sending-data](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-sunburst-sending-data)**\n\nThreat Hunter TeamSymantec\n\n## In the fourth of a series of follow-up analysis on the SolarWinds attacks, we detail how data is sent to the attackers.\n\nIn our [previous blog we described how the attackers controlled the Sunburst malware, and](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-sunburst-command-control)\ndetailed a variety of commands that will result in data being sent to the threat actors. The\nnext technique to discuss is how Sunburst sends this data to the attackers.\n\nIf data is being sent to the attacker as a result of a command, instead of performing a\nHTTP(S) GET request, something we described in our last blog, Sunburst initiates a\nHTTP(S) POST request.\n\nSunburst uses randomly generated URL paths for HTTP(S) POST requests that are different\nfrom HTTP(S) GET requests.\n\n\n-----\n\nIf the data to send is greater than 10,000 bytes, the URL path will be as follows:\n\n/pki/crl/{0}{1}-{2}.crl\n\nelement 0 is a number between 100 and 10,000\nelement 1 is optionally one of the following:\n\n-root\n-cert\n-universal_ca\n-ca\n-primary_ca\n-timestamp\n-global\n-secureca\nelement 2 is the last error code\n\nA Content-Type header is set to application/octet-stream and the POST data follows. The\nPOST data consists of the data to send UTF8 encoded, concatenated with the last error\ncode, concatenated with the userid, and subsequently compressed. Every byte of the\ncompressed blob is then summed and the lowest byte of the sum value is used as a key. The\ncompressed blob is XOR’d by the key byte and the key byte is prepended to the encrypted\ndata.\n\nFigure 1. Structure of Sunburst POST data\nIf the data to send is less than, or equal to, 10,000 bytes, the URL path will take one of two\nforms as follows:\n\n\n-----\n\n/fonts/woff/{0}-{1}-{2}-webfont{3}.woff2\n\nelement 0 is a random number between 100 and 10,000\nelement 1 is \"opensans\" or “noto”\nelement 2 is one of the following:\n\nbold\nbolditalic\nextrabold\nextrabolditalic\nitalic\nlight\nlightitalic\nregular\nsemibold\nsemibolditalic\nelement 3 is the last error code\nor /fonts/woff/{0}-{1}-{2}{3}.woff2\n\nelement 0 is a random number between 100 and 10,000\nelement 1 is one of the following:\n\nfreefont\nSourceCodePro\nSourceSerifPro\nSourceHanSans\nSourceHanSerif\nelement 2 is one of the following:\n\nBold\nBoldItalic\nExtraBold\nExtraBoldItalic\nItalic\nLight\nLightItalic\nRegular\nSemiBold\nSemiBoldItalic\nelement 3 is the last error code\n\nFurther, instead of sending the encrypted data directly, as when the data is greater than\n10,000 bytes, the data is steganographically sent in a faux JSON blob.\n\nThe JSON blob contains the following fields:\n\nuserId - contains the userid obfuscated into a GUID\nsessionId - a randomly generated GUID per HTTP session\n\n\n-----\n\nTimestamp - milliseconds since 1970/1/1 minus five minutes plus a random value\nbetween 0-512 with the second bit normally set to 1\nIndex - an incrementing value\nEventType - set to Orion\nEventName - set to EventManager\nDurationMs - the same random value between 0-512 used in the Timestamp\nSucceeded - set to true\nMessage - a chunk of Base64 encoded data\n\nThe encrypted data to send is broken into multiple variable sized chunks. The size of each\nchunk is randomly determined, but generally will go from smaller to larger. If the randomly\nchosen size is 0, a random chunk between 16 and 28 bytes is generated instead and the\nTimestamp value is AND’d with the value 18446744073709551613, which more importantly\nsets the second bit to 0. Each chunk is then encoded and added to the JSON blob and sent\nas the HTTP(S) POST data with a Content-Type header set to application/json.\n\nFigure 2. A contrived example of a JSON file that would be sent by Sunburst\nOn receipt, the attacker will need to decode and concatenate all the Message chunks,\nskipping junk chunks where the Timestamp second bit is not set.\n\n\n-----\n\nThis blog is the final installment of our analysis series concerning the command and control\n(C&C) process used by the actors behind the SolarWinds attacks. Previous entries have\n[covered how the attackers used Sunburst to disable security software and avoid detection,](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-attacks-stealthy-attackers-attempted-evade-detection)\nthe malware's use of a [rare domain generation algorithm (DGA) to generate domain names](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-unique-dga)\nto contact for C&C purposes, and Sunburst's control flow and use of IP address values as\ncommands. This final blog, detailing how the malware sends data back to the attackers,\nrounds out a comprehensive overview of Sunburst’s C&C processes.\n\n## Protection/Mitigation\n\nTools associated with these attacks will be detected and blocked on machines running\nSymantec Endpoint products.\n\n**File-based protection:**\n\nBackdoor.Raindrop\nBackdoor.Teardrop\nBackdoor.Sunburst\nBackdoor.Sunburst!gen1\nBackdoor.SuperNova\n\n**Network-based protection:**\n\nSystem Infected: Sunburst Malware Activity\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-22 - SolarWinds- How Sunburst Sends Data Back to the Attackers.pdf"
    ],
    "report_names": [
        "2021-01-22 - SolarWinds- How Sunburst Sends Data Back to the Attackers.pdf"
    ],
    "threat_actors": [
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535935,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1653779276,
    "ts_modification_date": 1653779276,
    "files": {
        "pdf": "https://archive.orkl.eu/8eba97ee10a8ea42d3fdca26e07777869478cfbc.pdf",
        "text": "https://archive.orkl.eu/8eba97ee10a8ea42d3fdca26e07777869478cfbc.txt",
        "img": "https://archive.orkl.eu/8eba97ee10a8ea42d3fdca26e07777869478cfbc.jpg"
    }
}