{
    "id": "29b9f45c-72f0-4368-82a6-45a090a342c6",
    "created_at": "2022-10-25T16:48:23.059179Z",
    "updated_at": "2025-03-27T02:14:02.810998Z",
    "deleted_at": null,
    "sha1_hash": "7ddab1f54ef0ba0a48efdb7ca39ddcc82f0a84d6",
    "title": "Supply Chain Analysis: From Quartermaster To Sunshopfireeye",
    "authors": "FireEye",
    "file_creation_date": "2014-08-29T22:49:26Z",
    "file_modification_date": "2014-08-29T22:49:36Z",
    "file_size": 1145723,
    "plain_text": "## SUPPLY CHAIN ANALYSIS:\n\n### From Quartermaster to SunshopFireEye\n\n# SECURITY\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n## CONTENTS\n\n##### Executive Summary................................................................................................................................................................................................................................................................................................................3\n\n Introduction................................................................................................................................................................................................................................................................................................................................................5\n\n Overview.............................................................................................................................................................................................................................................................................................................................................................6\n\n Cluster Analysis Techniques............................................................................................................................................................................................................................................................................9\n\n Clusters.............................................................................................................................................................................................................................................................................................................................................................. 13\n\n Shared Builders............................................................................................................................................................................................................................................................................................................................ 24\n\n Conclusion................................................................................................................................................................................................................................................................................................................................................. 29\n\n Appendix........................................................................................................................................................................................................................................................................................................................................................ 30\n\n About FireEye................................................................................................................................................................................................................................................................................................................................... 39\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n#### Executive Summary\nMany seemingly unrelated cyber attacks may, in\nfact, be part of a broader offensive fueled by a\nshared development and logistics\ninfrastructure—a finding that suggests some\ntargets are facing a more organized menace than\nthey realize.\n\nThis report examines 11 advanced persistent\nthreat (APT) campaigns targeting a wide swath\nof industries. Though they appeared unrelated at\nfirst, further investigation uncovered several key\nlinks between them: the same malware tools, the\nsame elements of code, binaries with the same\ntimestamps, and signed binaries with the same\ndigital certificates.\n\nTaken together, these commonalities point to\ncentralized APT planning and development. How\nprevalent this model has become is unclear. But\nadopting it makes financial sense for attackers,\nso the findings may imply a bigger trend.\n\nThis report focuses on two key findings:\n\n               - Shared development and logistics\n\n               - A shared malware-builder tool\n\n**Shared development and logistics**\nExamining the 11 APT campaigns revealed a\nshared development and logistics operation used\nto support several APT actors in distinct but\noverlapping campaigns. This development and\nlogistics operation is best described as a “digital\nquartermaster.” Its mission: supply and maintain\n\n1 Ned Moran. “Ready for Summer: The Sunshop Campaign.” May 2013.\n2 Ibid. “The Sunshop Campaign Continues.” August 2013.\n\n\nmalware tools and weapons to support cyber\nespionage. This digital quartermaster also might\nbe a cyber arms dealer of sorts, a common\nsupplier of tools used to conduct attacks and\nestablish footholds in targeted systems.\n\n**Shared builder tool**\nSFireEye researchers located a builder tool likely\nused in some of the 11 APT campaigns. The tools\nappear to be written in Chinese, and the testing\ninfrastructure appears to all be configured with\nthe native Chinese language character set, and\nthe dialogues and menu options in the builder\ntool are in Chinese.\n\n**The Sunshop connection**\nIn May 2013, FireEye first reported on the\n“Sunshop” campaign, which compromised several\nstrategic websites and redirected visitors to a site\nserving multiple exploits.[1] In August 2013,\nFireEye reported that the campaign was\ncontinuing[2] and, later that month, discovered\nadditional related attacks.\n\nExamining the underlying infrastructure of these\nattacks revealed that the campaign utilized\nresources shared across other APT campaigns\nnot initially tied to Sunshop.\n\nThe other campaigns included multiyear\nonslaughts targeting companies across 15\nindustries. Given the wide range of targets\nobserved, the campaigns’ specific objectives\n(beyond the obvious intellectual property theft)\nare unclear.\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**2%** **2%1%1%**\n**2%**\n\n**4%** **19%** **High-tech**\n\n**4%**\n\n**5%**\n\n**6%**\n\n**17%**\n\n**7%**\n\n**9%**\n\n**11%**\n**10%**\n\n**Figure 1.**\n\nThis report outlines the following:\n\n               - The quantity and categories of malicious\nbinaries related to the originally identified\nSunshop attacks and 10 other campaigns\nsubsequently linked to Sunshop\n\n               - The underlying infrastructure, including\ncomponents of code used across these\ncampaigns\n\n               - Clusters of APT activity previously believed\nto be unrelated\n\n               - A malware builder that likely supported one\nof these APT activity clusters\n\n\n**Targeted industries**\nThe 11 interconnected campaigns targeted these\nindustries:\n\n- Aerospace/Defense/Airlines\n\n- Applied research and development\n\n- Chemicals/Manufacturing/Mining\n\n- Higher education\n\n- Entertainment/Media/Hospitality\n\n- Energy/Utilities/Petroleum refining\n\n- Financial services\n\n- Federal government\n\n- State and local government\n\n- Healthcare/Pharmaceuticals\n\n- High-tech\n\n- Insurance\n\n- Legal services\n\n- Services/Consulting/VAR\n\n- Telecommunications\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nFireEye detected activity from the campaigns\nbetween July 2011 and September 2013, but\nthey were likely active before then. Though the\ncampaigns utilized varying techniques, tactics,\nand procedures (TTPs), they all leveraged a\ncommon development infrastructure. They\nshared (in various combinations) the following:\n\n               - Portable executable resources\n\n               - Digital certificates\n\n               - API import tables\n\n               - Compile times\n\n               - Command-and-control (CnC) infrastructure\n\nBased on the evidence, this report outlines the\nfollowing possible conclusions:\n\n**•** **[High Confidence] A “Sunshop Digital**\n**Quartermaster” (SDQ) exists and supports**\nseparate APT campaigns. FireEye believes\nthat the most likely explanation for these\nlinks is a shared development and logistics\noperation that supports several APT\ncampaigns as part of formal offensive\napparatus.\n\n**•** **[Low Confidence] SDQ and APT campaigns**\n**are a single actor. Another conceivable**\npossibility is tha the 11 clusters of activity,\npreviously believed to be independent\ncampaigns run by different actors, are in fact\none cluster of activity run by one wellresourced actor. However, we believe this\nscenario is less likely because each cluster of\nactivity utilized malware samples with\ndifferent artifacts such as passwords,\ncampaign identifiers, and mutexes. These\nartifacts were generally consistent within\neach cluster of activity but differed across\nclusters.\n\n3 Ned Moran. “Ready for Summer: The Sunshop Campaign.” May 2013.\n4 Ibid. “The Sunshop Campaign Continues.” August 2013.\n\n\n\n**•** **[Medium Confidence] SDQ does not exist,**\n**and APT actors informally share among**\n**each other. Alternatively, different actors**\nmay be responsible for the documented 11\nclusters of activity. Instead of relying on a\ncentralized development and logistics\noperation, they share TTPs through formal or\ninformal channels.\n\n#### Introduction\nTOn May 20, 2013 FireEye first reported on the\nSunshop campaign.[3 ]The actor responsible for this\ncampaign compromised a number of strategic\nwebsites, redirecting visitors to a site serving\nmultiple exploits. Almost three months later,\nFireEye reported that the campaign was\ncontinuing.[4] We discovered additional related\nattacks about a week after that. During the\nintervening time, we examined the underlying\ninfrastructure supporting these attacks and found\nthat the Sunshop campaign utilized resources\nshared across a number of other APT campaigns\nnot initially tied to Sunshop.\n\nWhat we initially believed to be 11 different APT\ncampaigns used the same malware tools, the same\nelements of code, binaries with the same\ntimestamps, and signed binaries with the same\ndigital certificates. Through this discovery, we\nbelieve that we have identified a shared\ndevelopment and logistics operation used to\nsupport a number of different APT actors engaged\nin distinctive but overlapping campaigns. This\ndevelopment and logistics operation is best\ndescribed as a digital quartermaster whose mission\nis to supply and maintain malware tools and\nweapons used in support of cyber espionage\noperations. This digital quartermaster is a possible\ncyber arms dealer, supplying the operators\nresponsible for conducting attacks and establishing\nfootholds within targeted organizations. As such,\nwe refer to this entity as the Sunshop Digital\nQuartermaster (SDQ).\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nTo support this conclusion, we first present an\noverview of our research, including the total\nnumber and type of malicious binaries we found to\nbe related to Sunshop and the 10 other linked\ncampaigns. We then describe the underlying\ninfrastructure, including the components of code\nused across these campaigns. We further describe\nthe different clusters of APT activity that we\npreviously believed to be unrelated. Finally, we\ndescribe one of the malware builders we believe\nwas used to support one of these clusters of APT\nactivity.\n\n#### Overview\nWe collected 110 unique binaries, which were\ndetected as Trojan.APT.9002, Trojan.APT.PoisonIvy,\nTrojan.APT.Gh0st, Trojan.APT.Kaba, and Trojan.\nAPT.Briba. Sixty-five of these binaries were\npackaged with two unique manifest resources, and\n47 were signed with six different digital certificates.\nThe binaries connected to 54 unique fully qualified\ndomains.\n\n**Detection** **Number of Samples**\n\n**Trojan.APT.9002** **70**\n\n**Trojan.APT.PoisonIvy** **26**\n\n**Trojan.APT.Gh0st** **12**\n\n**Trojan.APT.Kaba** **1**\n\n**Trojan.APT.Briba** **1**\n\n**Table 1: APT malware samples linked to the SDQ**\n\n\nWe identified these samples by searching binaries\npackaged with the two unique portable executable\n(PE) resources that we had previously identified.\nWe believe that these PE resources are unique to\nSunshop and the 10 other linked campaigns.\n\nWe also searched for samples signed with the six\ndifferent digital certificates that were used to sign\nbinaries connected to these campaigns. These\ncertificates were not unique to these campaigns\nand have been used to sign unrelated malware.\nTherefore, we cross-checked samples signed with\nany of these certificates to ensure that they were, in\nfact, related to the 10 campaigns we identified as\nlinked to Sunshop.\n\nAs we identified related campaigns that leveraged\nthe unique PE resources or digital certificates, we\nthen pivoted off the CnC infrastructure to identify\nadditional samples. We cross-checked samples\nidentified through this process to ensure that they\ndid indeed share the code elements that we\npreviously identified as unique to Sunshop and its\nassociated campaigns.\n\nWe searched our internal repositories, including\nthe FireEye high performance cluster and other\nwellknown external repositories. We primarily\nrelied on running active searches with YARA\nsignatures designed to identify samples, with either\nthe PE resources or digital certificates. We also\ncompared the import tables used in each sample to\nestablish additional links between the 10 different\ncampaigns linked to Sunshop.\n\nAll of this research led us to the above-mentioned\n110 binaries. Figure 2 plots the samples in a\nMaltego chart.\n\n|Detection|Number of Samples|\n|---|---|\n|Trojan.APT.9002|70|\n|Trojan.APT.PoisonIvy|26|\n|Trojan.APT.Gh0st|12|\n|Trojan.APT.Kaba|1|\n|Trojan.APT.Briba|1|\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nFigure 2 shows only domains, IP addresses, and\nMD5 malware/dropper hashes collected during our\nresearch. These limited data points display 11\ndifferent and seemingly independent clusters of\nactivity.\n\nWe continued our analysis by adding the following\nadditional data points to our graph.\n\n               - Two portable executable (PE) resources used\nby 64 samples in our collection\n\n\n**Figure 2. Eleven seemingly**\ndifferent APT campaigns\n\n\n\n- Six different digital certificates used by 47\nsamples in our collections\n\n- Hashes of the different import tables used by\nthe binaries in our graph\n\nThese additional data points linked the 11 different\nclusters of activity and revealed what we believe to\nbe a shared development logistics infrastructure.\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nFigure 3 illustrates the overlaps and connections\nthat exist between what initially appeared to be\n11 independent campaigns. This chart shows how\nthe additional data points of the shared PE\n\n\n**Figure 3. Eleven APT campaigns**\nlinked to the SDQ\n\nresources, commonly used digital certificates, and\nidentical import tables can link these different\ncampaigns together.\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n#### Cluster Analysis Techniques\nOur research analyzed the following to identify\nand tie all 11 campaigns to the SDQ:\n\n               - PE resources\n\n               - Import tables\n\n               - Authenticode/Digital certificates\n\n               - Compile times\n\n**PE resource**\nWe found that 64 of the 110 samples analyzed\nduring this analysis were packaged with two\nalmost identical portable executable resources. In\nboth cases, the resources appeared to be\nmanifests generated by the Nullsoft scriptable\n\n\ninstallation system (NSIS). Nullsoft is a scriptdriven tool that simplifies the installation routines\nof executable files onto the Microsoft Windows\noperating system.\n\n**Sunshop manifest**\nWe identify the first of these manifest resources\nas the “Sunshop manifest.” It has these properties:\n```\nMD5   \nf9e2887828846b3d383bdf9d0fded5e3\nSHA256   \n82a98c88d3dd57a6ebc0fe7167a868\n75ed52ebddc6374ad640407 efec01b1393\n\n```\nThe full text of the PE resource manifest is shown\nin Figure 4.\n\n```\n<?xml version=”1.0” encoding=”UTF-8” standalone=”yes”?>\n<assembly xmlns=”urn:schemas-microsoft-com:asm.v1” manifestVersion=”1.0”>\n<assemblyIdentity version=”1.0.0.0” processorArchitecture=”X86”\nname=”Nullsoft.NSIS.exehead” type=”win32”/>\n<description>Nullsoft Install System v2.34</description>\n   <dependency><dependentAssembly>\n     <assemblyIdentity type=”win32” name=”Microsoft.Windows.Common- \n     Controls” version=”6.0.0.0” processorArchitecture=”X86” publicKey\n     Token=”6595b64144ccf1df” language=”*” />\n   </dependentAssembly>\n</dependency>\n<trustInfo xmlns=”urn:schemas-microsoft-com:asm.v3”>\n<security>\n   <requestedPrivileges>\n   <requestedExecutionLevel level=”asInvoker” uiAccess=”false”/>\n   </requestedPrivileges>\n</security>\n</trustInfo>\n</assembly>\n\n```\n**Figure 4. Sunshop PE resource manifest**\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nWe found 44 unique binaries packaged with the\nabove Sunshop manifest. These samples were\ndetected as Trojan.APT.9002, Trojan.APT.Gh0st,\nand Trojan.APT.PoisonIvy. We observed these 44\nsamples used in eight of the 11 different\ncampaigns discussed below.\n\n**DTL manifest**\nWe identify the second manifest resource as the\n“DTL manifest.” This resource has these properties:\n\n```\nMD5   \n010e5a583d74850cdc0655f22c7a9003\nSHA256   \n46b966331d883d642293f4b1faa55f4c8c3 \n0b4238df8f121278a3752609a2cef\n\n```\nThe full text of the PE resource manifest is as\nfollows:\n\n```\n<?xml version=”1.0” encoding=”UTF-8” standalone=”yes”?>\n<assembly xmlns=”urn:schemas-microsoft-com:asm.v1” manifestVersion=”1.0”>\n<assemblyIdentity version=”1.0.0.0” processorArchitecture=”X86”\nname=”Nullsoft.NSIS.exehead” type=”win32”/>\n<description>Nullsoft Install System v2.34</description>\n  <dependency><dependentAssembly>\n    <assemblyIdentity type=”win32” name=”Microsoft.Windows.Common    Controls” version=”6.0.0.0” processorArchitecture=”X86” publicKey\n    Token=”6595b64144ccf1df” language=”*” />\n  </dependentAssembly>\n</dependency>\n<trustInfo xmlns=”urn:schemas-microsoft-com:asm.v3”>\n  <security>\n    <requestedPrivileges>\n    <requestedExecutionLevel level=”asInvoker” uiAccess=”false”/>\n    </requestedPrivileges>\n  </security>\n</trustInfo>\n</assembly>\n\n```\n\n**Figure 5. DTL PE resource manifest**\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nWe found 20 samples using the DTL manifest.\nThese binaries were detected as Trojan.APT.9002.\nWe observed these 20 samples used in five of the\n11 different campaigns discussed below.\n\nThe only difference between these manifest\nresources is the indentation of the <security>\nelements. Lines 10 through 13 in Figure 6 detail\nthis difference.\n\nThis slight difference results in a different hash for\nthe resource. The similarity between these two\nmanifests would likely go unnoticed by automated\nanalysis. Also, the XML is improperly formatted,\nhinting that it was formatted manually. As an\nexperiment, we used NSIS v2.34 to create our\n\n\nown simple installer and found that the XML in the\nmanifest had no new-line or tab characters.\n\n**Import tables**\nWe utilized a simple technique to identify\nsimilarities in import tables between the 110\ndifferent samples we analyzed during our analysis.\nWe aggregated the import calls found in each\nsample and used this as a unique fingerprint. We\nthen used these fingerprints to cluster similar\nsamples together.\n\nThe Python code in Figure 6 relies on the module\npefile and can be used to dump all the import calls\nused in a specific binary. The output can then be\neasily hashed.\n\n```\npe = pefile.PE(file)\n  for entry in pe.DIRECTORY_ENTRY_IMPORT:\n   for imp in entry.imports:\n     if imp.name != None:\n      print entry.dll, imp.name, hex(imp.address)\n     else:\n      print entry.dll, hex(imp.address)\n\n```\n**Figure 7. Python code to dump all import**\ncalls used in a specific binary\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nWe found 33 unique import tables used for the\n110 different samples we collected during our\nresearch. The most common import table seen\nhad a MD5 hash of\n```\n            3a7faeac22e6ab5c3c28a2b617901b51\n\n```\nand appeared in 38 different binaries. This\nparticular import table appeared in both Trojan.\nAPT.9002 and Trojan. APT.PoisonIvy binaries. It\nwas used in eight of the 11 different clusters of\nactivity we studied during this analysis. In addition\nto the identical import tables, these samples have\nthe same code base, differing in the unpacking\nroutine for the actual payload, indicating that they\nare general-purpose launchers.\n\nUpon execution, the malware samples with the\nimport table hash of\n```\n            3a7faeac22e6ab5c3c28a2b617901b51\n\n```\ncalled back to these domains and IP addresses:\n```\n            • ieee.boeing-job[.]com\n            • lol.dns-lookup[.]us\n            • twn.ftpmicrosoft[.]com\n            • 127.0.0.1\n            • piping.no-ip[.]org\n            • wv.downmicrisoft[.]com\n            • mx.downmicrisoft[.]com\n            • update1.mysq1[.]net\n            • ru.pad62[.]com\n            • phpweb.zapto[.]org\n            • asp.homesvr.linkpc[.]net\n            • dns.homesvr[.]tk\n            • ssl.homesvr[.]tk\n\n```\n\nThe second most common import table had a\nMD5 hash of\nf6d9eda2b4ab23b1f2be49e1a4f9a1f7 and\nappeared in 12 different samples. These 12\nsamples were all detected as Trojan.APT.PoisonIvy\nand appeared in only one of the 10 campaigns\ndiscussed below. Upon execution, all of the\nmalware samples with this import table hash\nbeaconed to these domains:\n```\n• luckmegame.servegame[.]com\n• luckmevnc.myvnc[.]com\n\n```\nThe third most common import table had a MD5\nhash of\n```\n71213bd677edc82c6ef30cb505c13dec\n\n```\nand appeared in nine different samples. These\nsamples were all detected as Trojan.APT.9002 and\nappeared in three of the 10 campaigns we\nanalyzed. Upon execution, these samples called\nback to these domains:\n```\n• engage.intelfox[.]com\n• ru.pad62[.]com\n• tank.hja63[.]com\n• dtl.eatuo[.]com\n• dtl6.mooo[.]com\n• dtl.dnsd[.]me\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**Authenticode/digital certificates analysis**\nDigital certificates are used to validate the\nauthenticity of code. Attackers often use stolen or\nspoofed digital certificates to sign their malicious\ncode and improve the likelihood that their code\nwill execute successfully on its target.\n\nDuring our research, we found six digital\ncertificates used to sign 44 different malware\nsamples. These certificates are currently revoked\nor expired and were signed by Microsoft,\n```\n            Sinacom, Facesun.cn, Mgame Corp,\n            Guangzhou YuanLuo Technology Co.,\n            Ltd., and Wuhan Tian Chen Information\n            Technology Co., Ltd. The full details of\n\n```\nthese certificates are available in Appendix A.\nAccording to Kaspersky, the Mgame Corp. and\n```\n            Guangzhou YuanLuo Technology Co.,\n            Ltd. certificates were stolen.[5 ]Whether the\n\n```\nremaining certificates were also stolen—or were\never valid—is unclear.\n\nThe certificates from Mgame Corp and Wuhan\n```\n            Tian Chen Information Technology\n            Co.,Ltd. were used most frequently. We\n\n```\nfound 24 samples signed with the certificate from\n```\n            Mgame Corp. These samples were all detected\n\n```\nas Trojan.APT.9002 and appeared in four of the 10\ncampaigns we studied during this research.\n\nWe found 15 samples signed with the certificate\nfrom Wuhan Tian Chen Information\n```\n            Technology Co., Ltd. These samples were\n\n```\nall detected as Trojan.APT.PoisonIvy and appeared\nin one of the 10 campaigns discussed below.\n\n**Compile times**\nAlthough the compilation time of binaries can be\neasily forged, analyzing them is still useful. The\ntimestamp may not reveal when a binary was\nactually compiled, but it can be used to cluster\nsamples by identical compile times.\n\n\nThe most common compile time was December\n19, 2012 at 20:25. We found 28 binaries compiled\nat this time. All of these binaries were detected as\nTrojan.APT.9002 and utilized the Sunshop PE\nresource. We observed samples with this\ntimestamp in six of the 11 clusters of APT activity\nwe studied during this research.\n\nThe next most common compile time was July 21,\n2012 at 14:50. We identified five samples\ncompiled at this time. All of these samples were\ndetected as Trojan.APT.9002 and utilized the DTL\nPE resource. These samples appeared in two of\nthe 11 campaigns.\n\nThe use of this same compile times across a\nnumber of different campaigns is another\nindication that a common development and\nlogistics infrastructure supported these disparate\noperations.\n\n#### Clusters\nThe shared characteristics were used across\nmalware tools used in at least 11 different clusters\nof APT activity. These clusters were originally\nbelieved to be separate and distinct campaigns\nand were grouped together based on shared CnC\ninfrastructure using passive DNS data or\nregistration information.\n\n**Cluster 1: Sunshop**\nThe Sunshop campaign appears to primarily\nleverage strategic Web compromise as a vector of\nattack. We have detailed the specifics of the\nSunshop campaign on the FireEye blog.[6] We found\n15 different samples linked to the Sunshop\ncampaign. These samples were detected as Trojan.\nAPT.Gh0st, Trojan. APT.PoisonIvy, Trojan.APT.\nBriba, and Trojan.APT.9002. All of the Sunshop\nsamples that we identified had compile times\nbetween January 1, 2013 and August 24, 2013.\nTwelve of the 15 utilized the Sunshop PE\n\n\n5 Securelist. “Winnti FAQ. More than just a game.” April 2013.\n6 See http://www.fireeye.com/blog/technical/cyber-exploits/2013/05/ready-for-summer-the-sunshop-campaign.html and\nhttp://www.fireeye.com/blog/technical/cyber-exploits/2013/08/the-sunshop-campaign-continues.html.\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nresource, and none was signed with any of the six\nidentified digital certificates.\n\nWhen executed, the Sunshop samples beaconed\nto these CnC servers:\n```\n            • appupdate.myvnc[.]com\n            • asp.homesvr.linkpc[.]net\n            • dns.homesvr[.]tk\n            • 9ijhh45.zapto[.]org\n            • newtibet[.]tk\n            • ssl.homesvr[.]tk\n            • nameserver1.zapto[.]org\n            • phpweb.zapto[.]org\n\n```\n```\n• homeweb.sytes[.]net\n• intelupdate.hopto[.]org\n• ajaxcode.zapto[.]org\n• updateinfor.hopto[.]org\n• mynews.sytes[.]net\n• The campaign targeted these\n  industries:\n• State and local government\n• Telecommunications\n• Legal services\n\n```\nTable 2 outlines Sunshop-related malware and\ncompile times.\n\n**Malware Family**\n\nTrojan.APT.Gh0st\n\nTrojan.APT.PoisonIvy\n\nTrojan.APT.PoisonIvy\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.Briba\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\n**Table 2: Sunshop-related**\nmalware compile times\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|218548a9fa75febadc2562b45207efc6|1/20/13 03:25|Trojan.APT.Gh0st|\n|2b6605b89ead179710565d1c2b614665|3/12/13 21:04|Trojan.APT.PoisonIvy|\n|0fafed2724cb3e8a7b967c808a9fd61c|3/12/13 21:09|Trojan.APT.PoisonIvy|\n|5fa521e8de8cbed7c176c632ae44b3d7|4/3/13 19:13|Trojan.APT.9002|\n|d99ed31af1e0ad6fb5bf0f116063e91f|4/27/13 15:56|Trojan.APT.9002|\n|b0ef2ab86f160aa416184c09df8388fe|4/27/13 15:56|Trojan.APT.9002|\n|6bc1d036c6dda828b1987342d06646b2|4/27/13 15:56|Trojan.APT.9002|\n|42bd5e7e8f74c15873ff0f4a9ce974cd|4/27/13 15:56|Trojan.APT.9002|\n|d9eafd20eba6afedd542f2bf5b328016|4/27/13 15:56|Trojan.APT.9002|\n|6fe0f6e68cd9cc6ed7e100e7b3626665|4/27/13 09:21|Trojan.APT.Briba|\n|53c5570178403b6fbb423961c3831eb2|6/25/13 01:19|Trojan.APT.9002|\n|f4ba5fd0a4f32f92aef6d5c4d971bf14|6/25/13 01:19|Trojan.APT.9002|\n|33299011f0d2b92d951471bbc3ea52b6|8/24/13 18:22|Trojan.APT.9002|\n|74fca616de1048c23fed5f92c4face95|8/24/13 18:22|Trojan.APT.9002|\n|234aae60b386bd684569408c3262de03|8/24/13 18:22|Trojan.APT.9002|\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**Cluster 2: DTL**\nThe DTL campaign appears to depend primarily on\nspear-phishing email as an initial infection vector.\nWe found seven different samples linked to the\nDTL campaign. All of these samples were detected\nas Trojan.APT.9002. These samples were\ncompiled between September 19, 2012 and July\n30, 2013. All of these samples were packaged\nwith the DTL PE resource, and one of the samples\nwas signed with the digital certificate from\nMgame Corp.\n\nWhen executed, the DTL samples called back to\nthese CnC servers:\n```\n            • dtl.eatuo[.]com\n            • dtl.dnsd[.]me\n            • dtl6.mooo[.]com\n            • img.advertisingsee[.]com\n\n```\n\nThe campaign targeted these industries:\n\n- Federal government\n\n- State and local government\n\n- Services/Consulting/VAR\n\n- Financial services\n\n- Telecommunications\n\n- Aerospace/Defense/Airlines\n\n- Energy/Utilities/Petroleum refining\n\n- Healthcare/Pharmaceuticals\n\n- Entertainment/Media/Hospitality\n\n- Insurance\n\n- Chemicals/Manufacturing/Mining\n\n- High-tech\n\n- Higher education\n\n**Malware Family**\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\n**Table 3: DTL-related**\nmalware compile times\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|6b4aa596e5a4208371942cdb0e04dfd9|9/19/12 18:07|Trojan.APT.9002|\n|6cbd49bed74f7bec642a4c518a99d8c5|10/10/12 15:01|Trojan.APT.9002|\n|9f5e9e6b0c87cad988f4a486e20bbc99|3/15/13 01:55|Trojan.APT.9002|\n|ea01e2544341da802b93fa62e6d804ed|3/15/13 01:55|Trojan.APT.9002|\n|0b0b1f2f8f9308472c43cc41838c519f|3/15/13 01:55|Trojan.APT.9002|\n|0e31a10218fea5b17037fde8474c809b|7/30/13 01:46|Trojan.APT.9002|\n|a0439dcad9a30e12a5d7cb4e38d0369c|7/30/13 01:46|Trojan.APT.9002|\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**Cluster 3: Ru.pad62**\nThe Ru.pad62 campaign appears to utilize both\nspear-phishing email and strategic Web\ncompromise as initial infection vectors. We found\n26 different samples linked to the Ru.pad62\ncampaign. These samples were detected as Trojan.\nAPT.9002, Trojan.APT.Gh0st, Trojan.APT.Kaba,\nand Trojan.APT.PoisonIvy. The 26 linked samples\nhad compile timestamps between September 19,\n2011 and December 19, 2012. Ten of the samples\nfrom the Ru.pad62 campaign were packaged with\nthe DTL resource, and six of the samples were\npackaged with the Sunshop resource. Only four\nsamples linked to the Ru.pad62 campaign were\nsigned with digital certificates—two with the\n```\n            Mgame Corp. certificate and two with a\n\n```\ncertificate from Microsoft.\n\n\nWhen executed, the Ru.pad62 samples we found\ncalled back to these CnC servers:\n```\n• ru.pad62[.]com\n• tank.hja63[.]com\n• 173.234.184[.]45\n• fly.pad62[.]com\n• tho.pad62[.]com\n• tho.hja63[.]com\n\n```\nThe campaign targeted these industries:\n\n- Higher education\n\n- Entertainment/Media/Hospitality\n\n- High-tech\n\n**Malware Family**\n\nTrojan.APT.Gh0st\n\nTrojan.APT.Gh0st\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.Gh0st\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.Kaba\n\nTrojan.APT.Kaba\n\nTrojan.APT.Gh0st\n\nTrojan.APT.PoisonIvy\n\nTrojan.APT.PoisonIvy\n\ntable continued on page 17\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|ea6de0e20fa5ee7c1f2cd5676c0ab7e2|9/19/11 23:11|Trojan.APT.Gh0st|\n|ec79969351717f5197dd4b2b164d4317|9/19/11 23:11|Trojan.APT.Gh0st|\n|e6b3febc971c711de74caea0887cf586|4/9/12 10:29|Trojan.APT.9002|\n|bd16d4ca446f46349edbd53e06f0d01a|7/8/12 14:55|Trojan.APT.9002|\n|625daa7c44d1d1035d455f003b6b6b5b|7/7/12 10:14|Trojan.APT.Gh0st|\n|036863c78cc09f511fcbc29eb5bc6760|7/8/12 14:55|Trojan.APT.9002|\n|a89a13462e1de9241569b24b101efe4d|7/8/12 14:55|Trojan.APT.9002|\n|ef29ec86455c1abb55cf612f7a191b03|7/8/12 14:55|Trojan.APT.9002|\n|1bd468332c0dfc8ba2a3a5f286f20b7a|7/21/12 14:50|Trojan.APT.9002|\n|859301c5874ca3739e8ac81ddfc676e6|7/21/12 14:50|Trojan.APT.9002|\n|58e81154a87cc93d546c4c45de9b1ec3|7/21/12 14:50|Trojan.APT.9002|\n|6ef66c2336b2b5aaa697c2d0ab2b66e2|7/21/12 14:50|Trojan.APT.9002|\n|d2c53f8ef8f8c04237e6c2b5e4820457|8/19/12 08:23|Trojan.APT.Kaba|\n|50d0e9d32f8c2b3e32d073ed4a08091e|8/19/12 08:23|Trojan.APT.Kaba|\n|841f00641de924117e2cbe6b4620015b|9/24/12 04:10|Trojan.APT.Gh0st|\n|fce13d50bcbeae38e44b08be21f907da|9/27/12 00:13|Trojan.APT.PoisonIvy|\n|8831d9d04aa7fdcfa1b5bdb83f71316a|9/27/12 00:13|Trojan.APT.PoisonIvy|\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\ntable continued on page 16\n\n**MD5 Hash**\n```\n                bde732368bc01b988a6f352898259a30\n                8f5c46630af8cef723995d69fe03c73f\n                13c4083bdb893c8a0bd2930fa55962ca\n                0bb911278eb426be95e79b7f9c5dea92\n                bd2f28f776ae306eda90229b0fa13b6b\n                13c4083bdb893c8a0bd2930fa55962ca\n                f5ffbd8d17ab21095c56e00831c79cbc\n                a7481bd182886c7aae99abfd6f25d005\n                aa31a6a94d4ad7bf494b2532f2f7cb63\n                4eff545f1e04946e0b088ed15873b02d\n\n```\n**Cluster 4: Downmicrisoft**\nThe Downmicrisoft campaign appears to utilize\nstrategic Web compromise as an initial infection\nvector. We found five different samples linked to\nthe Downmicrisoft campaign. These samples were\ndetected as Trojan.APT.9002 and Trojan.APT.\nGh0st. The five samples had compile timestamps\nbetween December 19, 2012 and April 4, 2013.\nThe earliest compile time for samples from the\nDownmicrisoft campaign (December 19, 2012)\nwas the same day as the latest compile time for\nsamples from the Ru.Pad62 campaign. Three of\nthe samples linked to the Downmicrisoft campaign\nwere packaged with the Sunshop PE resource, and\nall but one sample was signed with the Mgame\nCorp. digital certificate.\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|bde732368bc01b988a6f352898259a30|12/19/12 20:25|Trojan.APT.9002|\n|8f5c46630af8cef723995d69fe03c73f|12/19/12 20:25|Trojan.APT.9002|\n|13c4083bdb893c8a0bd2930fa55962ca|12/19/12 20:25|Trojan.APT.9002|\n|0bb911278eb426be95e79b7f9c5dea92|10/10/12 15:01|Trojan.APT.9002|\n|bd2f28f776ae306eda90229b0fa13b6b|12/19/12 20:25|Trojan.APT.9002|\n|13c4083bdb893c8a0bd2930fa55962ca|12/19/12 20:25|Trojan.APT.9002|\n|f5ffbd8d17ab21095c56e00831c79cbc|12/19/12 20:25|Trojan.APT.9002|\n|a7481bd182886c7aae99abfd6f25d005|12/19/12 20:25|Trojan.APT.9002|\n|aa31a6a94d4ad7bf494b2532f2f7cb63|10/10/12 15:01|Trojan.APT.9002|\n|4eff545f1e04946e0b088ed15873b02d|10/10/12 15:01|Trojan.APT.9002|\n\n\n**Table 4: Ru.pad62-related**\nmalware and compile times\n\nWhen executed, the Downmicrisoft samples\ncalled back to these CnC servers:\n```\n• wv.downmicrisoft[.]com\n• mx.downmicrisoft[.]com\n• up.downmicrisoft[.]com\n• tebit-newtwn.ftpmicrosoft[.]com\n• twn.ftpmicrosoft[.]com\n\n```\nThe campaign targeted these industries:\n\n- Entertainment/Media/Hospitality\n\n- High-tech\n\nThe same media organization targeted in the\nDownmicrisoft campaign was also targeted in the\nRu.Pad62 campaign.\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**MD5 Hash**\n```\n                c8589ec3171656514ebd4df4cb79ec89\n                82fc8465c01c416c6dcaeaf16822d5a3\n                71e761d1683e76d5741cdf2d05aecdf8\n                372d218077715661aea2ada27b16e500\n                c27730971c04cdf049b44912a50b4804\n\n```\nAlso, the Trojan.APT.Gh0st sample linked to the\nDownmicrisoft campaign,\n```\n            c27730971c04cdf049b44912a50b4804, did\n\n```\nnot use the default “Gh0st” string. Instead, this\nsample used the string “HTTPS”. Gh0st variants\nwith this same string were described by RSA in a\n2012 paper.[7]\n\n**Cluster 5: Boeing-Job**\nThe Boeing-Job campaign appears to utilize\nstrategic Web compromises as an initial infection\nvector. We previously discussed the Boeing-Job\ncampaign’s use of the “Lady Boyle” Flash exploit on\nthe FireEye blog.[8] We identified 19 different\nsamples linked to the Boeing-Job campaign. These\nsamples were all detected as Trojan.APT.9002 and\nhad compile timestamps between July 21, 2012\nand April 3, 2013. Seven of the samples from the\nBoeing-Job campaign were packaged with both\nthe Sunshop PE resource, and all but two were\nsigned with the Mgame Corp. digital certificate.\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|c8589ec3171656514ebd4df4cb79ec89|12/19/12 20:25|Trojan.APT.9002|\n|82fc8465c01c416c6dcaeaf16822d5a3|12/19/12 20:25|Trojan.APT.9002|\n|71e761d1683e76d5741cdf2d05aecdf8|12/19/12 20:25|Trojan.APT.9002|\n|372d218077715661aea2ada27b16e500|12/19/12 20:25|Trojan.APT.9002|\n|c27730971c04cdf049b44912a50b4804|4/4/13 09:50|Trojan.APT.Gh0st|\n\n\n**Table 5: Downmicrisoft-related**\nmalware and compile times\n\nWhen executed, the Boeing-Job samples called\nback to these CnC servers:\n```\n• www.boeing-job[.]com\n• engage.intelfox[.]com\n• ieee.boeing-job[.]com\n• lol.dns-lookup[.]us\n• 127.0.0.1\n\n```\nThe campaign targeted these industries:\n\n- Financial services\n\n- Energy/Utilities/Petroleum refining\n\n- Telecommunications\n\n\n7 RSA. “The Voho Campaign: an In Depth Analysis.” September 2012.\n8 Thoufique Haq and J. Gomez. “LadyBoyle Comes to Town with a New Exploit.” February 2013.\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**MD5 Hash**\n```\n                a24992c89c4a8dd83b5e910131054c60\n                a7c79c7e13a6f3e5bfe4852efd937096\n                2a7e98b3079af88e296ed934966486b7\n                d399e5b8d0d6a01e14e713488d1ee6d9\n                fb53093f42b7517822f15cfd20cc24fe\n                94b564a3881bf4c3fcd1cc1c5f44e72f\n                7826651ee38c7e8d46131806b0bca1c6\n                f1ba92689036ab3c3aec7e0d49a647f1\n                47eec3b99a8dfa5381f24d6518bb7eda\n                fce973f7983b06b85aba0cab17732178\n                744a6a6c6b0f7b7355b7c1d5f1efd46e\n                bd4dc30072f76f20b52e0c564473bc92\n                97cd618e80cdc79353290cffb17274b8\n                432dce23d00694b103dd838144253d1b\n                a022f14ba32aeff2fe416a11384ed0ef\n                b4da1c3400b48803b41823feaf6085e8\n                b8ef95a8b32d31f29db5ca6b530815b9\n                432dce23d00694b103dd838144253d1b\n                ebd2bc0beecb9d3f80bbfaf7e046b31f\n\n```\n**Cluster 6: Google-blogspot**\nThe Google-blogspot campaign appears to utilize\nstrategic Web compromise as an initial infection\nvector. We identified seven different samples\nlinked to the Google-blogspot campaign. These\nsamples were all detected as Trojan.APT.Gh0st or\nTrojan.APT.PoisonIvy. The Google-blogspot\nsamples had compile timestamps between\nSeptember 16, 2008 and June 27, 2012. Four of\nthe samples from the Google-blogspot campaign\nwere packaged with the Sunshop PE resource, and\none sample was signed with a digital certificate\nfrom Facesun.cn.\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|a24992c89c4a8dd83b5e910131054c60|7/21/12 14:50|Trojan.APT.9002|\n|a7c79c7e13a6f3e5bfe4852efd937096|12/19/12 20:25|Trojan.APT.9002|\n|2a7e98b3079af88e296ed934966486b7|12/19/12 20:25|Trojan.APT.9002|\n|d399e5b8d0d6a01e14e713488d1ee6d9|12/19/12 20:25|Trojan.APT.9002|\n|fb53093f42b7517822f15cfd20cc24fe|12/19/12 20:25|Trojan.APT.9002|\n|94b564a3881bf4c3fcd1cc1c5f44e72f|12/19/12 20:25|Trojan.APT.9002|\n|7826651ee38c7e8d46131806b0bca1c6|12/19/12 20:25|Trojan.APT.9002|\n|f1ba92689036ab3c3aec7e0d49a647f1|12/19/12 20:25|Trojan.APT.9002|\n|47eec3b99a8dfa5381f24d6518bb7eda|12/19/12 20:25|Trojan.APT.9002|\n|fce973f7983b06b85aba0cab17732178|12/19/12 20:25|Trojan.APT.9002|\n|744a6a6c6b0f7b7355b7c1d5f1efd46e|12/19/12 20:25|Trojan.APT.9002|\n|bd4dc30072f76f20b52e0c564473bc92|12/19/12 20:25|Trojan.APT.9002|\n|97cd618e80cdc79353290cffb17274b8|12/19/12 20:25|Trojan.APT.9002|\n|432dce23d00694b103dd838144253d1b|12/19/12 20:25|Trojan.APT.9002|\n|a022f14ba32aeff2fe416a11384ed0ef|1/22/13 23:38|Trojan.APT.9002|\n|b4da1c3400b48803b41823feaf6085e8|2/4/13 16:15|Trojan.APT.9002|\n|b8ef95a8b32d31f29db5ca6b530815b9|2/4/13 16:15|Trojan.APT.9002|\n|432dce23d00694b103dd838144253d1b|2/4/13 16:15|Trojan.APT.9002|\n|ebd2bc0beecb9d3f80bbfaf7e046b31f|2/4/13 16:15|Trojan.APT.9002|\n\n\n**Table 6: Boeing-Job-related**\nmalware and compile times\n\nWhen executed, the Google-blogspot samples\ncalled back to these CnC servers:\n```\n• soft.google-blogspot[.]com\n• www.google-blogspot[.]com\n• blog.googleblog.iego[.]net\n\n```\nThe campaign targeted this industry:\n\n- Healthcare/Pharmaceuticals\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**MD5 Hash**\n```\n                2eee37b222ba9e8f373e49d31af62a69\n                e21c3c26c801573b789b39a0ff3c549b\n                ab468267b60a087ea8ad2a35a00e4f08\n                9ffe2463e87a424b8cd7c8d1c77dc2bb\n                1a24e834b4c7dd16f988ab590d03194d\n                959a6f30de52b481c31e4482fea4333c\n                bb610bc9fbff3dd473b10a07ae963499\n\n```\n**Cluster 7: Luckme**\nThe Luckme campaign appears to utilize strategic\nWeb compromise as an initial infection vector. We\nidentified 18 different samples linked to the\nLuckme campaign. These samples were all\ndetected as Trojan. APT.PoisonIvy and had\ncompile timestamps between April 3, 2011 and\nApril 3, 2013. Four of the samples from the\nLuckme campaign were packaged with the\nSunshop PE resource. Fifteen of the Luckme\nsamples were signed with the digital certificate\nfrom Wuhan Tian Chen Information\n```\n            Technology Co., Ltd.\n\n```\nWhen executed, Luckme samples called back to\nthese CnC servers:\n```\n            • luckmegame.servegame[.]com\n            • luckmevnc.myvnc[.]com\n            • huangma.dyndns[.]org\n\n```\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|2eee37b222ba9e8f373e49d31af62a69|9/16/08 10:17|Trojan.APT.Gh0st|\n|e21c3c26c801573b789b39a0ff3c549b|12/20/11 00:32|Trojan.APT.Gh0st|\n|ab468267b60a087ea8ad2a35a00e4f08|6/27/12 15:51|Trojan.APT.Gh0st|\n|9ffe2463e87a424b8cd7c8d1c77dc2bb|6/27/12 15:51|Trojan.APT.Gh0st|\n|1a24e834b4c7dd16f988ab590d03194d|6/27/12 15:51|Trojan.APT.Gh0st|\n|959a6f30de52b481c31e4482fea4333c|6/27/12 15:51|Trojan.APT.Gh0st|\n|bb610bc9fbff3dd473b10a07ae963499|2/22/13 09:11|Trojan.APT.PoisonIvy|\n\n\n**Table 7: Google-blogspot related**\nmalware and compile times\n```\n• zhouweb.dyndns[.]info\n• frontpage.dyndns[.]org\n• frontpage.dhis[.]org\n• blankorder.zapto[.]org\n• blankorder.dyndns-mail[.]com\n• registrat.dyndns[.]org\n• registrat.zapto[.]org\n\n```\nThe campaign targeted these industries:\n\n- High-tech\n\n- Aerospace/Defense/Airlines\n\n- Federal government\n\n- Services/Consulting/VAR\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**MD5 Hash**\n```\n                01a3edddd7c130048b24822277c507f0\n                b885c7d2616ca27cb408efcd8328dd36\n                7d41640e7dbf7b4a3c6dc147b994b01b\n                9f729cb50867edcb71116df67a32ff24\n                184a9d13616702154fb10ff9c5d67041\n                89c54a39b64361df19ce5a2de14c47c6\n                2b1675ac31a158e2518b3fbe77e935f1\n                bf75391e4aa5e812d138c53e24e17d9e\n                96ad6bd5416571118a9e9b8d1cb9b8ee\n                f7ea36b555afe376427f6c32ade78595\n                20728edd9a17e0a85719553115b25ec2\n                21c9da542789db45db0c0e5389a49c46\n                3caf55608384a6dfd98fb9c076863b7b\n                2b825e46ae60a9d15b5a731e57410425\n                011bc59a3dd478475bcd033cf09fa93a\n                ca22207c5441a100437b75d7ce0d3fe2\n                b08f2ae0542f60f463fcd160ec1e9355\n                09d4c2f1f24fbdcb1c286b2f4c5589d2\n\n```\n**Cluster 8: Piping**\nThe Piping campaign appears to utilize strategic\nWeb compromise as an initial infection vector. We\nidentified four different samples linked to the\nPiping campaign. These samples were detected as\nTrojan.APT.PoisonIvy and Trojan.APT.9002. The\nPiping linked samples had compile timestamps\nbetween December 19, 2012 and January 2,\n2013. All of the samples from this campaign were\npackaged with the Sunshop PE resource, and none\nwas signed with a digital certificate.\n\nWhen executed, the Piping samples called back to\nthese CnC servers:\n```\n            • koko4w.no-ip[.]org\n\n```\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|01a3edddd7c130048b24822277c507f0|4/3/11 01:29|Trojan.APT.PoisonIvy|\n|b885c7d2616ca27cb408efcd8328dd36|4/20/11 02:53|Trojan.APT.PoisonIvy|\n|7d41640e7dbf7b4a3c6dc147b994b01b|7/2/11 08:54|Trojan.APT.PoisonIvy|\n|9f729cb50867edcb71116df67a32ff24|6/9/12 03:10|Trojan.APT.PoisonIvy|\n|184a9d13616702154fb10ff9c5d67041|6/9/12 03:10|Trojan.APT.PoisonIvy|\n|89c54a39b64361df19ce5a2de14c47c6|9/18/12 16:22|Trojan.APT.PoisonIvy|\n|2b1675ac31a158e2518b3fbe77e935f1|10/19/12 14:39|Trojan.APT.PoisonIvy|\n|bf75391e4aa5e812d138c53e24e17d9e|10/19/12 14:39|Trojan.APT.PoisonIvy|\n|96ad6bd5416571118a9e9b8d1cb9b8ee|10/19/12 14:39|Trojan.APT.PoisonIvy|\n|f7ea36b555afe376427f6c32ade78595|10/19/12 16:59|Trojan.APT.PoisonIvy|\n|20728edd9a17e0a85719553115b25ec2|10/19/12 16:59|Trojan.APT.PoisonIvy|\n|21c9da542789db45db0c0e5389a49c46|10/19/12 16:59|Trojan.APT.PoisonIvy|\n|3caf55608384a6dfd98fb9c076863b7b|10/19/12 16:59|Trojan.APT.PoisonIvy|\n|2b825e46ae60a9d15b5a731e57410425|10/19/12 17:45|Trojan.APT.PoisonIvy|\n|011bc59a3dd478475bcd033cf09fa93a|10/19/12 17:45|Trojan.APT.PoisonIvy|\n|ca22207c5441a100437b75d7ce0d3fe2|3/5/13 02:19|Trojan.APT.PoisonIvy|\n|b08f2ae0542f60f463fcd160ec1e9355|4/3/13 23:00|Trojan.APT.PoisonIvy|\n|09d4c2f1f24fbdcb1c286b2f4c5589d2|4/3/13 23:00|Trojan.APT.PoisonIvy|\n\n\n**Table 8: Luckme-related**\nmalware and compile times\n```\n• okok4o.zapto[.]org\n• blabla4m.no-ip[.]org\n• piping.no-ip[.]org\n\n```\nThe campaign targeted these industries:\n\n- Chemicals/Manufacturing/Mining\n\n- Financial services\n\n- Energy/Utilities/Petroleum refining\n\n- Healthcare/Pharmaceuticals\n\n- High-tech\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**MD5 Hash**\n```\n                ef4070380ed10008111102f575139b3d\n                76e7f9bd532e4204b749cb739d6ada1b\n                afc4d73bde2a536d7a9b7596288ce180\n                25f38271e2a3d55a83917f1b9825fde9\n\n```\n**Cluster 9: Update1**\nThe Update1 campaign appears to utilize strategic\nWeb compromise as an initial infection vector. We\nidentified five different samples linked to the\nUpdate1 campaign. All of these samples were\ndetected as Trojan.APT.9002 and had compile\ntimestamps between July 30, 2012 and\nDecember 19, 2012. One of the Update1 samples\nwas packaged with the Sunshop PE resource and\none was packaged with the DTL PE resource.\nNone of the samples was signed with a digital\ncertificate.\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|ef4070380ed10008111102f575139b3d|12/19/12 20:25|Trojan.APT.9002|\n|76e7f9bd532e4204b749cb739d6ada1b|1/2/13 16:23|Trojan.APT.PoisonIvy|\n|afc4d73bde2a536d7a9b7596288ce180|1/2/13 16:26|Trojan.APT.PoisonIvy|\n|25f38271e2a3d55a83917f1b9825fde9|1/2/13 16:27|Trojan.APT.PoisonIvy|\n\n\n**Table 9: Piping-related**\nmalware and compile times\n\nWhen executed, the Update1 samples called back\nto these CnC servers:\n```\n• update1.mysq1[.]net\n• update.mysq1[.]net\n• pack.fartit[.]com\n• updatedns.itemdb[.]com\n\n```\nThe campaign targeted these industries:\n\n- High-tech\n\n- Entertainment/Media/Hospitality\n\n- Applied research and development\n\n- Services/Consulting/VAR\n\n**Malware Family**\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\nTrojan.APT.9002\n\n**Table 10: Update1-related**\nmalware and compile times\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|9322365a4b89556b033b0ab90e43a68a|7/30/12 05:37|Trojan.APT.9002|\n|b0b8db07a5126e6a8e15299efe74d068|8/23/12 20:49|Trojan.APT.9002|\n|bdc562e2752fa7da15772906358bb082|8/24/12 14:36|Trojan.APT.9002|\n|0f8c4da83642efa4a70d9c8e52b67ba5|8/24/12 14:36|Trojan.APT.9002|\n|4cd171813a2d9d2152f7a7428d5348eb|12/19/12 20:25|Trojan.APT.9002|\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**MD5 Hash**\n```\n                bfaf33f80815471646dc007f7ac18f7b\n\n```\n**Cluster 10: Packets**\nThe Packets campaign appears to utilize spearphishing email as an initial infection vector. We\nidentified one Trojan.APT.9002 sample linked to\nthe Packets campaign. This sample had a compile\ntime of December 19, 2012 and was packaged\nwith the Sunshop PE resource. The sample was\nnot signed with a digital certificate. It called back\nto this CnC server:\n```\n            • mlog.ddns[.]us\n\n```\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|bfaf33f80815471646dc007f7ac18f7b|12/19/12 20:25|Trojan.APT.9002|\n\n\n**Table 11: Packets-related**\nmalware and compile times\n\n**Cluster 11: Allshell**\nThe Allshell campaign appears to utilize spearphishing email as a vector to attack its targets. We\nidentified one Trojan.APT.9002 sample linked to\nthe Allshell campaign. This sample had a compile\ntime of October 16, 2012 and was packaged with\nthe DTL PE resource. The sample was not signed\nwith a digital certificate. It called back to this CnC\nserver:\n```\n• stmp.allshell[.]net\n\n```\nThe campaign targeted these industries:\n\n- High-tech\n\n- Aerospace/Defense/Airlines\n\n**Malware Family**\n\nTrojan.APT.9002\n\n**Table 12: Allshell-related**\nmalware and compile times\n\n|MD5 Hash|Compile Time|Malware Family|\n|---|---|---|\n|0c6b69976fa75b477fcece125b4b0e96|10/16/12 19:45|Trojan.APT.9002|\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n#### Shared Builders\nThese observed shared characteristics across\nthese malware samples are likely the result of a\nset of common “builders” developed by a shared\ndevelopment and logistics infrastructure.\n\nBuilders are tools used by malicious actors to\nquickly and easily create different variants of the\nsame malware. In a typical scenario, a skilled\ndeveloper creates a builder and shares it with an\noperator more skilled in intrusion operations than\nin code development. This separation of tasks is\nmore efficient and supports a faster tempo of\noffensive operations. A typical builder provides a\ngraphical user interface that enables a threat\nactor to configure elements such as the location of\nthe CnC server.\n\n\n**Table 12: Allshell-related**\nmalware and compile times\n\nTo recap, these shared characteristics, as\ndiscussed in previous sections, include the\nfollowing:\n\n- The Sunshop and DTL PE resources\n\n- Common import tables\n\n- Six different digital certificates\n\n- Common compile times\n\n- Common malware families\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n**Figure 9: Typical Builder life cycle**\n\nWe identified a builder tool used to create Trojan.APT.9002 binaries, which we are dubbing “9002\nBuilder.” This builder generates Trojan.APT.9002 binaries with the DTL resource.\n\n**Figure 10: Builder used to generate**\nTrojan.APT.9002 malware\n\n\n**Figure 9: Typical Builder life cycle**\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nAs shown in Figure 10, the dialogue and menu\noptions in this GUI are in Chinese. The builder\nenables threat actors to configure the following:\n\n               - Both a primary and a secondary CnC server.\n\n               - A specific ID. The default ID produced by this\nbuilder is “1.”\n\n               - An “Internet health check” domain. The\ndefault health check domain configured in\nthis builder was “update.microsoft.com”. An\nInternet health check domain is typically used\nby malware to determine whether a target’s\nendpoint is connected to the Internet before\nacting.\n\n\n\n- Proxy settings, including address/port, type,\nproxy authentication details, auto-detect\nproxy, and force-proxy only.\n\nAlso, the text in the title bar of this builder is\n“[User_Server_Builder] update 2012-7-21”.\nAlthough the servers produced by this builder\nhave a compile time of 10/23/12 8:30 UTC, we\nbelieve the date in the title bar of the builder is\nsignificant; we identified five different binaries\nwith a compile time of 7/21/12.\n\nAll five utilized the same DTL resource found in\n9002 Builder.\n\n|MD5 Hash|Compile Time|CnC Server|PE Resource|\n|---|---|---|---|\n|a24992c89c4a8dd83b5e910131054c60|7/21/12 14:50|engage.intelfox[.]com|DTL|\n|1bd468332c0dfc8ba2a3a5f286f20b7a|7/21/12 14:50|ru.pad62[.]com|DTL|\n|859301c5874ca3739e8ac81ddfc676e6|7/21/12 14:50|ru.pad62[.]com|DTL|\n|58e81154a87cc93d546c4c45de9b1ec3|7/21/12 14:50|ru.pad62[.]com|DTL|\n|6ef66c2336b2b5aaa697c2d0ab2b66e2|7/21/12 14:50|tank.hja63[.]com|DTL|\n\n\n**Table 13: Malware samples created by a builder using**\nthe same DTL resource found in 9002 Builder\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nThe 9002 Builder appears to be a modified variant\nof the builder used to create the samples listed in\nTable 12. The compile time of the builder is\n10/23/2012 11:18 UTC, a little less than 3 hours\nafter the compile time of the server that is\nproduced by it. We believe it is a common practice\nfor the developer to compile a new server, update\nthe builder code accordingly, then compile the\nnew builder. The older date in the title bar may\njust be an oversight as i t would have to be\nmanually updated by the developer.\n\n\nThe builder contains a copy of the server\nexecutable in its PE resource section, under BIN.\nThe server executable is responsible for installing\nthe 9002 payload malware, and has its\nconfiguration block stored in its .data section,\nwith some default settings including the CnC\npointing to 192.168.8.105. The configuration\nblock uses simple, single-byte XOR encryption.\nThe key varies from version to version; in some\ncases, it skips null bytes. During the installation\nroutine, the configuration block is written to the\nregistry value sysinfo under the registry key\n```\nHKCU\\Software\\Classes.\n\n```\n**Figure 11: T9002 Builder configuration block**\nbefore (left) and after (right) XOR decryption\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\nWhen the threat actor builds a malware\nexecutable, the builder writes the server\nexecutable to disk and overwrites the\nconfiguration block with the newly configured\noptions. The location of the configuration block\nwithin the .data section is hard-coded, meaning\nthat the builder must be modified each time the\nserver code is updated and the location of the\nconfiguration block changes. We noticed that the\nconfiguration block is indeed stored at a different\noffset in the samples compiled on 7/21/12 as\ncompared to the sample created by the builder\nwe have with the compile date of 10/23/12. This\nfurther supports our belief in the practice of the\ndeveloper compiling the server and then shortly\nafter compiling the builder. He would need time\nto locate the new offset of the configuration\nblock in the newly compiled server executable\n\n\nand then change the hard-coded value in the\nbuilder code.\n\nAttackers using 9002 Builder seem to have\ngradually adopted another launcher that stores\nthe configuration block as a resource instead of\nstoring it in its .data section. Based on the\ncompile-time analysis outlined in the “Compile\nTimes” section of this report, the shift began in\nlate October of 2012 (with a few exceptions). This\nshift makes sense for the builder’s developer(s);\nthey no longer needed to update the builder for\nevery code change in the launcher or 9002\npayload malware. This launcher, mentioned earlier\nin this paper as having the import table hash\n```\n3a7faeac22e6ab5c3c28a2b617901b51,\n\n```\nsupports different payloads, such as Poison Ivy\nand 9002.\n\n**Figure 12: 9002 Builder code, with hard-coded**\noffset to the server’s configuration block\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n#### Conclusion\nBased on the evidence provided, we draw the\nfollowing possible conclusions:\n\n**[High Confidence] SDQ exists and supports**\n**separate APT campaigns. We believe the most**\nlikely explanation for these documented\ncorrelations is that a shared ‘development and\nlogistics’ operation (SDQ) supports a number of\ndifferent APT campaigns, as part of formal\noffensive apparatus.\n\n**[Low Confidence] SDQ and APT campaigns are**\n**a single actor. That said, it is conceivable that the**\n11 clusters of activity, previously believed to be\nindependent campaigns run by different actors,\nare in fact one cluster of activity run by one\nwell-resourced actor. However, we believe this\nscenario is less likely because each cluster of\nactivity utilized malware samples with different\nartifacts such as passwords, campaign identifiers,\nand mutexes. These artifacts were generally\nconsistent within each cluster of activity but\ndiffered across clusters.\n\n\n\n**[Medium Confidence] SDQ does not exist, and**\n**APT actors informally share among each other.**\nAlternatively, different actors might be\nresponsible for the documented 11 clusters of\nactivity and instead of relying on a centralized\ndevelopment and logistics operation, these\nactors share TTPs through formal or informal\nchannels.\n\nIn each of these scenarios, a shared development\nand logistics infrastructure or some notion of a\ndigital quartermaster clearly underpins all of the\nactivity presented in this report. Whether this\nquartermaster involves informal connections\nbetween developers or a structured bureaucratic\norganization serving a central offensive\napparatus is unclear. Regardless of the scenario,\nthe overall finding of a shared development and\nlogistics infrastructure suggests targeted\norganizations are facing a more organized\nmenace than they realize.\n\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n#### Appendix A: Authenticode/Digital Certificates\n```\n     Certificate:\n      Data:\n        Version: 3 (0x2)\n        Serial Number:\n          4e:eb:08:05:55:f1:ab:f7:09:bb:a9:ca:e3:2f:13:cd\n        Signature Algorithm: sha1WithRSAEncryption\n        Issuer: C=ZA, O=Thawte Consulting (Pty) Ltd., CN=Thawte Code Signing CA\n        Validity\n          Not Before: Jun 19 00:00:00 2009 GMT\n          Not After : Jun 19 23:59:59 2011 GMT\n        Subject: C=KR, ST=Seoul, L=Geumcheon-gu, O=MGAME Corp., OU=Web Dev Team,\n     CN=MGAME Corp.\n        Subject Public Key Info:\n          Public Key Algorithm: rsaEncryption\n          RSA Public Key: (1024 bit)\n            Modulus (1024 bit):\n             00:c5:6a:00:76:7b:80:ce:08:78:aa:75:47:46:2a:\n             1b:42:e4:b8:bc:a3:10:1a:6d:29:31:fd:dd:21:1e:\n             27:9a:3a:39:c8:66:0d:7d:bd:da:74:cc:09:b7:51:\n             60:36:80:2e:da:f4:bd:b7:9c:8b:a2:f5:35:aa:d2:\n             4f:a5:0a:a4:77:5e:3b:fd:45:86:96:f0:00:d3:3b:\n             97:87:49:99:1e:8f:f3:0d:d9:cc:55:86:12:c0:5f:\n             9e:ed:d2:6e:34:12:f1:69:33:ff:09:ef:49:fc:95:\n             d8:19:01:d9:bc:99:27:92:0b:b5:98:91:a1:2f:24:\n             e1:dc:17:ae:2b:e1:85:c6:19\n            Exponent: 65537 (0x10001)\n        X509v3 extensions:\n          X509v3 Basic Constraints: critical\n            CA:FALSE\n          X509v3 CRL Distribution Points:\n            URI:http://crl.thawte.com/ThawteCodeSigningCA.crl\n          X509v3 Extended Key Usage:\n            Code Signing, Microsoft Commercial Code Signing\n          2.5.29.4:\n            0.0.0..\n     +.....7.......\n          Authority Information Access:\n            OCSP - URI:http://ocsp.thawte.com\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n         Netscape Cert Type:\n           Object Signing\n     Signature Algorithm: sha1WithRSAEncryption\n       8c:ea:48:e7:9f:4e:d9:49:9c:54:b2:56:02:0a:ce:d5:3a:5b:\n       b7:2b:a6:8b:c2:13:08:6d:13:8f:17:af:d8:96:5c:13:f5:80:\n       5a:ec:bd:e7:be:76:85:84:76:82:6a:23:af:47:1b:0c:c4:fe:\n       a3:cc:59:21:fd:c6:97:32:8b:6c:f3:34:ed:b3:b1:2a:4a:b3:\n       22:60:83:06:3b:36:c9:6c:c0:78:08:5c:de:1c:3d:09:49:73:\n       a7:35:22:27:d6:19:ee:41:f6:10:fc:64:78:dc:dc:b2:79:82:\n       2a:61:2f:3e:cb:d7:7f:cf:fe:0f:4e:ab:47:d6:94:5b:84:40:\n       f7:20\n    Certificate:\n     Data:\n       Version: 3 (0x2)\n       Serial Number:\n        da:61:49:95:64:a7:f1:8e:be:8b:03:b7:12:c2:9e:09\n       Signature Algorithm: sha1WithRSAEncryption\n       Issuer: C=US, O=WoSign, Inc., CN=WoSign Code Signing Authority\n       Validity\n        Not Before: Aug 13 00:00:00 2010 GMT\n        Not After : Aug 13 23:59:59 2011 GMT\n    Subject: C=CN, ST=\\xE6\\xB9\\x96\\xE5\\x8C\\x97\\xE7\\x9C\\x81, L=\\xE6\\xAD\\xA6\\xE6\\\n    xB1\\x89\\xE5\\xB8\\x82, O=\\xE6\\xAD\\xA6\\xE6\\xB1\\x89\\xE5\\xA4\\xA9\\xE5\\xAE\\xB8\\xE4\\xBF\\xA1\\\n    xE6\\x81\\xAF\\xE6\\x8A\\x80\\xE6\\x9C\\xAF\\xE6\\x9C\\x89\\xE9\\x99\\x90\\xE5\\x85\\xAC\\xE5\\x8F\\xB8,\n    OU=WoSign Class 3 Code Signing, CN=\\xE6\\xAD\\xA6\\xE6\\xB1\\x89\\xE5\\xA4\\xA9\\xE5\\xAE\\xB8\\\n    xE4\\xBF\\xA1\\xE6\\x81\\xAF\\xE6\\x8A\\x80\\xE6\\x9C\\xAF\\xE6\\x9C\\x89\\xE9\\x99\\x90\\xE5\\x85\\xAC\\\n    xE5\\x8F\\xB8\n       Subject Public Key Info:\n        Public Key Algorithm: rsaEncryption\n        RSA Public Key: (2048 bit)\n           Modulus (2048 bit):\n             00:ad:12:17:ee:5a:5a:a7:9f:ee:60:08:58:30:8d:\n             5d:2d:90:c6:ed:fd:20:53:7b:fe:23:44:77:4b:a9:\n             25:ca:b0:5d:d6:c8:3a:e5:1f:a5:bb:7e:f4:65:75:\n             c7:2c:34:4e:4f:ea:a0:43:1f:10:ee:97:e8:7c:0e:\n             83:f6:09:ab:90:d0:5e:0b:36:2e:eb:7a:39:2c:fa:\n             7f:1a:b8:9d:5d:2e:3b:24:71:4a:3b:0a:a9:46:e1:\n             8e:28:a6:85:9c:da:52:f1:b0:6e:57:6f:24:81:bf:\n             cf:36:1b:5a:95:d7:35:cb:c9:61:56:ac:3c:e4:cd:\n             73:66:a2:42:2a:32:ea:52:cc:c7:ab:9b:63:4e:a2:\n             77:d7:aa:6b:7f:14:25:15:e6:b6:f0:54:68:41:d2:\n             54:74:41:0b:6e:b8:fa:ac:22:26:94:2a:b7:2e:ce:\n             18:5e:9b:1d:0a:d1:bd:f1:b8:5a:39:b4:3e:21:1b:\n             eb:ce:9b:3d:34:0f:19:fd:b3:b8:2e:13:53:80:2d:\n             29:af:14:bf:33:62:d8:68:b4:3f:02:98:26:bb:d5:\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n           b7:69:cf:9c:f5:8a:bc:45:fd:7f:51:fa:5f:b9:33:\n           fe:62:2c:cc:fc:43:34:7e:e8:9a:c0:2c:17:8c:25:\n           c8:48:45:08:9f:4f:04:ce:54:c6:51:cc:3e:54:a0:\n           6a:cd\n         Exponent: 65537 (0x10001)\n     X509v3 extensions:\n      X509v3 Authority Key Identifier:\n         keyid:A4:13:6A:3F:10:0B:D7:21:87:D4:8B:05:CA:BC:B1:02:CD:54:E2:8A\n      X509v3 Subject Key Identifier:\n         CB:DD:A1:49:1B:B3:17:85:BB:B1:A0:2D:33:18:82:39:9A:7B:CA:6F\n      X509v3 Key Usage: critical\n         Digital Signature\n      X509v3 Basic Constraints: critical\n         CA:FALSE\n      X509v3 Extended Key Usage:\n         Code Signing, Microsoft Commercial Code Signing\n      X509v3 Certificate Policies:\n         Policy: 1.3.6.1.4.1.6449.1.2.2.22\n          CPS: http://www.wosign.com/cps/\n      X509v3 CRL Distribution Points:\n         URI:http://crl.wosign.com/WoSignCodeSigning.crl\n      Authority Information Access:\n         CA Issuers - URI:http://crt.wosign.com/WoSignCodeSigning.crt\n   Signature Algorithm: sha1WithRSAEncryption\n     8d:89:24:cc:ea:3f:23:af:01:46:59:24:43:22:67:b3:27:74:\n     84:fc:ae:ea:03:bc:09:b5:f0:88:8a:13:01:d3:4f:d7:a9:01:\n     c3:4c:5e:46:02:b5:46:e3:25:02:fc:f9:e3:f6:41:79:fa:18:\n     c5:0f:96:06:78:db:ed:51:35:55:4b:d2:b3:07:11:13:f2:a9:\n     75:99:5e:ac:67:6a:3c:9f:a6:73:8a:4b:f4:ac:8c:a2:6b:e4:\n     d6:a2:00:46:a5:73:11:d7:ca:e5:99:cd:68:b0:e3:ff:76:36:\n     f4:62:a5:71:73:0c:cc:a5:79:e4:54:a2:7b:25:de:72:6b:0d:\n     67:ba:43:ec:98:26:da:bc:6a:bd:7e:29:c9:d2:75:b7:ac:6d:\n     c9:d1:3b:e0:ef:9d:e9:1e:4a:17:fd:bd:81:6e:96:1e:13:f9:\n     7a:bf:66:ae:6b:7d:55:be:ce:71:0c:b7:e8:fd:da:72:58:fb:\n     0c:8b:d0:ec:6e:35:f3:be:02:cb:c1:40:8b:94:1d:24:32:8a:\n     d7:84:fd:94:66:a2:65:7c:ca:f9:c1:27:b7:53:42:14:47:1a:\n     97:91:6f:87:e5:a5:02:63:69:79:9b:e2:a6:1c:67:eb:f4:ac:\n     42:91:47:79:51:fe:20:df:4a:49:b4:b2:a1:78:1f:22:60:0d:\n     0f:ca:b4:6e\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n    Certificate:\n      Data:\n        Version: 3 (0x2)\n        Serial Number:\n            37:3e:80:24:1c:d2:98:b0:4e:85:24:62:41:42:13:fc\n        Signature Algorithm: md5WithRSAEncryption\n        Issuer: CN=Root Agency\n        Validity\n            Not Before: Feb 21 06:00:46 2013 GMT\n            Not After : Dec 31 23:59:59 2039 GMT\n        Subject: O=T\\x09ye[\\x89l\\xF0/emailAddress=John-hotmail-com, CN=Facesun.cn\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n            RSA Public Key: (1024 bit)\n              Modulus (1024 bit):\n                00:c4:dc:fb:70:09:61:88:95:a5:1a:dd:c9:5c:dd:\n                c5:5b:3c:42:1a:f4:34:38:fc:ae:25:45:d6:ce:c3:\n                a1:bd:60:e6:2d:34:1d:be:b3:12:66:ac:51:76:ce:\n                3f:fc:04:18:21:65:ef:f4:6f:8d:ea:a2:2e:bb:d4:\n                9e:05:ba:48:02:e7:05:2e:46:d2:26:db:ca:68:c8:\n                ec:be:cf:0a:6f:21:e0:bf:dd:bf:c9:a3:cc:4c:1d:\n                5a:47:a9:e9:8f:36:43:ab:b6:95:40:04:5f:9f:5c:\n                12:f2:18:88:b5:ae:1c:52:2b:3f:2c:0b:fd:29:d2:\n                c6:de:1b:e3:89:8c:b1:2d:29\n              Exponent: 65537 (0x10001)\n            X509v3 extensions:\n             2.5.29.1:\n              0>.....-...O..a!..dc..0.1.0...U....Root Agency...7l...d......\\5.\n        Signature Algorithm: md5WithRSAEncryption\n            34:1b:5f:c7:3c:a1:69:f3:3b:f3:9f:8d:09:1b:10:6a:8f:02:\n            00:28:7d:45:33:a0:2e:1b:70:d4:a4:5a:a3:85:a7:c6:35:4c:\n            31:6e:10:4b:91:48:4a:3d:1a:2c:cc:86:c4:e0:bd:2a:44:d7:\n            94:9b:9e:e6:71:1e:b8:58:32:15\n    Certificate:\n      Data:\n        Version: 3 (0x2)\n        Serial Number:\n            97e:45:f7:bc:62:39:59:91:4f:5b:84:fa:b0:97:ba:b8\n        Signature Algorithm: sha1WithRSAEncryption\n        Issuer: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=Terms of use\n   at https://www.verisign.com/rpa (c)04, CN=VeriSign Class 3 Code Signing 2004 CA\n        Validity\n            Not Before: Apr 16 00:00:00 2009 GMT\n            Not After : Apr 18 23:59:59 2012 GMT\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n       Subject: C=CN, ST=Beijing, L=Beijing, O=SINA.COM TECHNOLOGY (CHINA) CO. LTD,\n  OU=Digital ID Class 3 - Microsoft Software Validation v2, CN=SINA.COM TECHNOLOGY\n  (CHINA) CO. LTD\n       Subject Public Key Info:\n         Public Key Algorithm: rsaEncryption\n         RSA Public Key: (1024 bit)\n           Modulus (1024 bit):\n             00:ca:3f:cd:e7:f4:9d:19:fe:83:92:15:2c:06:8e:\n             4c:ff:7a:8d:17:0c:94:e8:3c:25:c1:c2:ed:d5:22:\n             87:b7:3c:81:c5:96:f1:94:cd:ef:19:c8:ce:13:85:\n             27:c4:75:af:f1:54:71:d5:2d:4b:7b:de:3c:ac:10:\n             e0:68:16:d5:7c:55:3f:02:ff:84:5e:31:c9:47:69:\n             3e:d9:e1:dc:50:b2:ef:04:8d:da:02:25:cb:57:96:\n             6b:e9:fe:b3:d8:db:0f:6c:c7:e8:80:db:92:ac:5b:\n             6f:76:99:dd:13:70:92:d8:93:f2:53:16:5b:00:b1:\n             a7:99:d2:3c:38:4f:4e:d9:43\n           Exponent: 65537 (0x10001)\n         X509v3 extensions:\n          X509v3 Basic Constraints:\n           CA:FALSE\n          X509v3 Key Usage: critical\n           Digital Signature\n          X509v3 CRL Distribution Points:\n           URI:http://CSC3-2004-crl.verisign.com/CSC3-2004.crl\n          X509v3 Certificate Policies:\n           Policy: 2.16.840.1.113733.1.7.23.3\n            CPS: https://www.verisign.com/rpa\n          X509v3 Extended Key Usage:\n           Code Signing\n          Authority Information Access:\n           OCSP - URI:http://ocsp.verisign.com\n           CA Issuers - URI:http://CSC3-2004-aia.verisign.com/CSC3-2004-aia.cer\n          X509v3 Authority Key Identifier:\n           keyid:08:F5:51:E8:FB:FE:3D:3D:64:36:7C:68:CF:5B:78:A8:DF:B9:C5:37\n          Netscape Cert Type:\n           Object Signing\n          1.3.6.1.4.1.311.2.1.27:\n           0.......\n   Signature Algorithm: sha1WithRSAEncryption\n     bc:99:88:52:b3:26:a3:af:b4:09:83:4e:c2:4b:91:86:6c:e4:\n     50:9a:eb:27:cb:6a:e9:77:4f:b8:c3:42:0b:1d:1a:3b:21:ed:\n     09:32:67:62:1a:89:86:01:55:0b:44:01:75:d9:17:59:98:0c:\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n        5a:2d:09:33:f5:cd:e7:ba:f4:a3:04:0a:05:40:38:6a:7f:c5:\n        bb:82:aa:0b:ae:3a:b0:78:27:6b:3a:f7:d9:ba:c7:1a:13:e3:\n        1d:ee:c9:b8:c7:54:c5:46:e4:8a:97:c6:07:11:45:0a:57:85:\n        7c:ab:35:7b:5d:45:0b:3f:84:c6:32:43:7a:06:aa:48:52:d0:\n        16:23:74:d0:e1:6d:2c:42:d1:bb:cf:f5:70:ca:27:8e:69:35:\n        cc:72:b1:2d:dd:b1:9a:d1:f7:65:37:45:2e:36:c9:fd:9c:67:\n        87:b6:50:f8:e9:3f:86:a0:c6:3e:3f:66:6e:0e:de:fb:dc:67:\n        d6:29:f0:25:5b:2d:53:92:cf:07:70:50:38:3c:04:34:57:19:\n        59:23:09:eb:44:fe:5b:40:a3:ae:ed:5f:1a:84:80:00:ab:b8:\n        2a:1f:da:ef:02:46:23:b4:1e:d1:6a:90:86:9c:12:af:13:b1:\n        59:63:b9:47:09:d8:ad:8a:c8:66:38:3c:44:a0:37:b4:27:9c:\n        f5:ed:61:62\n     Certificate:\n       Data:\n        Version: 3 (0x2)\n        Serial Number:\n           61:46:9e:cb:00:04:00:00:00:65\n        Signature Algorithm: sha1WithRSAEncryption\n        Issuer: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation,\n     OU=Copyright (c) 2000 Microsoft Corp., CN=Microsoft Code Signing PCA\n        Validity\n           Not Before: Apr 4 19:43:46 2006 GMT\n           Not After : Oct 4 19:53:46 2007 GMT\n        Subject: C=US, ST=Washington, L=Redmond, O=Microsoft Corporation,\n     CN=Microsoft Corporation\n        Subject Public Key Info:\n           Public Key Algorithm: rsaEncryption\n           RSA Public Key: (2048 bit)\n             Modulus (2048 bit):\n               00:cd:81:96:38:ae:5c:a2:f2:c1:df:de:d0:ab:95:\n               8d:d6:3c:9d:1f:8b:c3:5d:86:2e:5d:f0:b1:72:f5:\n               ab:ac:88:6a:b5:da:b1:22:7b:0b:c8:c8:a5:4b:91:\n               5e:22:13:e9:f9:f5:23:9d:b5:f4:6e:76:ae:ef:ee:\n               81:61:79:a1:62:f4:6e:88:95:d0:6e:dd:c7:9f:d2:\n               a4:51:11:76:61:ba:70:8a:65:a1:96:16:89:a7:5d:\n               81:d0:44:66:e5:db:56:9e:40:ca:fc:dc:76:24:2e:\n               44:30:00:e5:d6:7d:7b:95:11:d5:58:1d:a3:e8:4f:\n               0b:c9:88:dc:a2:d6:53:99:6c:ca:63:ca:99:6a:9a:\n               92:5e:4c:4d:11:e8:2f:d3:5b:5b:5e:5f:52:a3:73:\n               2d:a5:bb:84:45:0d:8c:19:15:76:cb:08:da:9a:a6:\n               70:15:e8:4d:ec:69:fd:5d:b2:6b:8f:ed:29:51:37:\n               38:8b:c6:46:49:15:94:50:98:b0:f4:68:a4:d7:de:\n               09:71:67:74:9e:77:8c:1d:85:6b:97:ea:e7:5f:45:\n               cc:e0:e6:71:0d:d1:63:00:93:7b:31:98:8e:0b:b4:\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n             13:bd:b3:d0:ee:f1:df:21:ee:a9:60:61:ee:37:43:\n             3d:c3\n           Exponent: 65537 (0x10001)\n       X509v3 extensions:\n         X509v3 Key Usage: critical\n           Digital Signature, Non Repudiation\n         X509v3 Subject Key Identifier:\n           EE:D9:6B:A9:75:53:CD:4F:EE:1B:4E:19:06:1E:A3:9C:AB:CF:94:FD\n         X509v3 Extended Key Usage:\n           Code Signing\n         X509v3 Authority Key Identifier:\n           keyid:25:F8:2B:4B:5D:C8:72:54:AD:E5:F6:A0:2A:17:16:FB:C1:F9:53:81\n           DirName:/OU=Copyright (c) 1997 Microsoft Corp./OU=Microsoft\n   Corporation/CN=Microsoft Root Authority\n           serial:6A:0B:99:4F:C0:00:1D:AB:11:DA:C4:02:A1:66:27:BA\n         X509v3 CRL Distribution Points:\n           URI:http://crl.microsoft.com/pki/crl/products/CodeSignPCA2.crl\n         Authority Information Access:\n           CA Issuers - URI:http://www.microsoft.com/pki/certs/CodeSignPCA2.crt\n    Signature Algorithm: sha1WithRSAEncryption\n      38:d9:ef:95:38:9b:5c:98:14:5d:54:6e:69:df:02:c8:e7:b3:\n      fb:d3:c2:4d:ad:2f:ab:7f:54:0d:da:32:b6:f8:6a:e6:0d:fb:\n      21:1a:77:3e:a5:68:7a:b4:95:7e:8a:5c:f2:43:c4:83:9b:65:\n      7d:88:50:51:7c:82:14:f5:83:73:d7:a2:be:5c:ca:02:70:ce:\n      26:6c:17:bc:52:14:a5:89:c0:b7:e4:a1:cc:a1:75:9d:91:71:\n      3d:1b:c0:56:00:56:b5:f8:84:26:da:5e:33:fb:d6:25:7a:5e:\n      9a:da:a6:fb:f4:f2:41:1a:ac:55:46:ad:48:dc:91:38:13:58:\n      09:49:f1:f3:31:87:1f:bc:04:8e:5b:12:65:03:e9:0b:51:d0:\n      a1:0c:8a:99:bd:d9:c1:a8:d0:08:15:25:21:b5:b6:57:89:1c:\n      d1:5b:86:35:a5:ca:fd:aa:87:ec:a9:37:3f:b7:43:6b:e3:20:\n      f1:45:bc:7e:ae:e9:f1:55:b2:a1:48:bc:65:be:53:34:d9:c9:\n      e8:06:63:04:06:78:6e:50:ff:48:bb:9b:ea:43:5a:87:db:ad:\n      0a:80:f5:59:c5:2c:e4:e5:7f:5b:4a:e5:32:79:ee:22:85:92:\n      0c:2d:b3:50:5b:c6:c2:40:58:58:ab:d2:cd:e3:2f:c1:cd:ec:\n      6d:9f:37:79\n   Certificate:\n    Data:\n      Version: 3 (0x2)\n      Serial Number:\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n       0b:72:79:06:8b:eb:15:ff:e8:06:0d:2c:56:15:3c:35\n     Signature Algorithm: sha1WithRSAEncryption\n     Issuer: C=US, O=VeriSign, Inc., OU=VeriSign Trust Network, OU=Terms of use\n  at https://www.verisign.com/rpa (c)10, CN=VeriSign Class 3 Code Signing 2010 CA\n     Validity\n       Not Before: Jun 12 00:00:00 2012 GMT\n       Not After : Jun 12 23:59:59 2013 GMT\n     Subject: C=CN, ST=Guangdong, L=Guangzhou, O=Guangzhou YuanLuo Technology\n  Co.,Ltd, OU=Digital ID Class 3 - Microsoft Software Validation v2, CN=Guangzhou\n  YuanLuo Technology Co.,Ltd\n     Subject Public Key Info:\n       Public Key Algorithm: rsaEncryption\n       RSA Public Key: (2048 bit)\n         Modulus (2048 bit):\n           00:c6:ed:0a:22:9b:e6:e7:33:b4:2c:de:15:8a:cf:\n           c7:ef:c0:c5:c5:af:6a:82:97:e7:28:32:38:54:95:\n           2c:4c:55:35:53:8f:74:6e:45:73:6e:0f:38:45:eb:\n           1b:2c:dd:21:46:24:34:47:83:9d:34:3d:47:01:4c:\n           ca:95:52:a3:8c:28:e7:78:1b:7b:1c:76:b2:6c:30:\n           8d:f6:37:b3:63:0b:4d:1e:8a:91:bb:76:d7:30:0d:\n           e6:5e:85:92:9f:d3:f8:46:2d:33:fb:e2:1d:65:59:\n           57:73:73:e2:15:d7:fb:0b:a8:ad:b6:3e:31:ae:df:\n           af:5a:18:55:e6:bd:3c:1c:f4:21:4f:4b:74:26:7c:\n           57:83:37:99:c7:f9:c5:5f:85:1d:fa:14:24:b1:a3:\n           62:f8:fa:a0:27:b5:b9:1b:4e:05:31:dd:a6:28:10:\n           5f:39:72:97:ea:f6:db:eb:b7:9c:37:a6:64:3f:88:\n           9e:9f:13:64:02:d4:77:e1:76:3a:58:3d:71:ca:ae:\n           22:7b:b4:63:0d:0a:30:d3:cc:7e:c0:13:66:08:c5:\n           c0:cf:5c:b6:44:07:f0:43:34:3e:39:67:1f:11:7c:\n           2b:a5:15:87:ce:92:fa:06:f7:5b:87:da:e9:e8:11:\n           1d:54:7a:e4:22:84:1c:1b:9f:cf:c7:a3:f2:0d:62:\n           2a:cb\n         Exponent: 65537 (0x10001)\n     X509v3 extensions:\n       X509v3 Basic Constraints:\n         CA:FALSE\n     X509v3 Key Usage: critical\n         Digital Signature\n     X509v3 CRL Distribution Points:\n         URI:http://csc3-2010-crl.verisign.com/CSC3-2010.crl\n     X509v3 Certificate Policies:\n         Policy: 2.16.840.1.113733.1.7.23.3\n          CPS: https://www.verisign.com/rpa\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n```\n      X509v3 Extended Key Usage:\n        Code Signing\n      Authority Information Access:\n        OCSP - URI:http://ocsp.verisign.com\n        CA Issuers - URI:http://csc3-2010-aia.verisign.com/CSC3-2010.cer\n      X509v3 Authority Key Identifier:\n        keyid:CF:99:A9:EA:7B:26:F4:4B:C9:8E:8F:D7:F0:05:26:EF:E3:D2:A7:9D\n      Netscape Cert Type:\n        Object Signing\n      1.3.6.1.4.1.311.2.1.27:\n        0.......\n   Signature Algorithm: sha1WithRSAEncryption\n     8f:d5:34:38:5d:9f:0b:70:5f:d8:46:aa:32:05:6d:10:7b:b2:\n     37:de:76:2d:de:f7:46:d6:ab:17:32:95:91:1b:9f:c0:b3:c9:\n     93:6f:d5:4d:82:d3:cd:d7:f7:db:64:72:17:9b:f6:08:1b:3e:\n     d9:ca:de:49:75:86:44:2d:b2:e6:1f:26:77:28:3b:60:e7:8b:\n     93:fc:ea:6a:bc:d1:62:8d:5d:cb:f4:fe:ed:2c:6b:55:10:2d:\n     8a:36:cd:cd:0d:56:27:c5:5e:c0:47:f5:d1:1b:7a:a3:23:f9:\n     a6:bf:b5:34:74:fa:ad:f4:80:86:b7:46:f8:b8:48:74:0d:5e:\n     68:3c:99:31:e6:13:b8:bb:13:cb:5b:69:17:68:60:9b:38:66:\n     6a:25:9b:df:a9:6e:62:5b:29:15:91:b1:e8:af:74:59:11:25:\n     38:ab:5c:b6:2a:33:16:ba:3c:42:76:2c:2b:91:9a:4b:e1:20:\n     82:4e:b9:91:3f:d5:2c:3b:4e:57:e8:42:a4:37:8c:f6:a3:e2:\n     7d:6b:b1:27:e2:cf:b5:9b:55:d1:7a:05:50:9b:2e:00:b1:4e:\n     03:78:dd:52:f9:7d:e3:bc:27:83:63:15:ba:7a:6d:40:b6:40:\n     42:bd:5a:82:63:30:c8:83:41:95:e0:52:a8:83:51:67:28:c4:\n     14:2a:d5:db\n\n```\n\n-----\n\n**Supply Chain Analysis: From Quartermaster to Sunshop**\n\n#### About FireEye\nFireEye has invented a purpose-built, virtual\nmachine-based security platform that provides\nreal-time threat protection to enterprises and\ngovernments worldwide against the next\ngeneration of cyber attacks. These highly\nsophisticated cyber attacks easily circumvent\ntraditional signature-based defenses, such as\nnext-generation firewalls, IPS, anti-virus, and\ngateways. The FireEye Threat Prevention\nPlatform provides real-time, dynamic threat\n\n\nprotection without the use of signatures to\nprotect an organization across the primary threat\nvectors, including mobile, Web, email, and files and\nacross the different stages of an attack life cycle.\nThe core of the FireEye platform is a virtual\nexecution engine, complemented by dynamic\nthreat intelligence, to identify and block cyber\nattacks in real time. FireEye has over 1,100\ncustomers across more than 40 countries,\nincluding over 100 of the Fortune 500.\n\n\nFireEye, Inc. | 1440 McCarthy Blvd. Milpitas, CA 95035 | 408.321.6300 | 877.FIREEYE (347.3393) | info@fireeye.com | www.fireeye.com\n\n© 2014 FireEye, Inc. All rights reserved. FireEye is a registered trademark of FireEye,\nI All th b d d t i b t d k i\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/cpnh3qzju92xffn9qtlw45vceuleqh6d",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.01.02.SUPPLY_CHAIN_ANALYSIS/fireeye-malware-supply-chain.pdf"
    ],
    "report_names": [
        "fireeye-malware-supply-chain"
    ],
    "threat_actors": [
        {
            "id": "c2bf7f73-16b8-472f-8bc0-1427f4d86b8a",
            "created_at": "2022-10-25T16:07:23.210218Z",
            "updated_at": "2025-03-27T02:02:09.688431Z",
            "deleted_at": null,
            "main_name": "Dizzy Panda",
            "aliases": [
                "LadyBoyle"
            ],
            "source_name": "ETDA:Dizzy Panda",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b9ca5e9a-530a-4b0f-b2ca-ada722a63c44",
            "created_at": "2023-01-06T13:46:38.262372Z",
            "updated_at": "2025-03-27T02:00:02.786854Z",
            "deleted_at": null,
            "main_name": "DIZZY PANDA",
            "aliases": [
                "LadyBoyle"
            ],
            "source_name": "MISPGALAXY:DIZZY PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1409352566,
    "ts_modification_date": 1409352576,
    "files": {
        "pdf": "https://archive.orkl.eu/7ddab1f54ef0ba0a48efdb7ca39ddcc82f0a84d6.pdf",
        "text": "https://archive.orkl.eu/7ddab1f54ef0ba0a48efdb7ca39ddcc82f0a84d6.txt",
        "img": "https://archive.orkl.eu/7ddab1f54ef0ba0a48efdb7ca39ddcc82f0a84d6.jpg"
    }
}