{
    "id": "5f81f5a5-0214-4aef-aabc-6e7dabe224bc",
    "created_at": "2023-01-12T15:10:51.237129Z",
    "updated_at": "2025-03-27T02:09:30.0503Z",
    "deleted_at": null,
    "sha1_hash": "b28e00ff74f21724ae13a46e474e0beea5b9ffa7",
    "title": "2018-01-15 - GlobeImposter ransomware- A holiday gift from the Necurs botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T19:17:28Z",
    "file_modification_date": "2022-05-28T19:17:28Z",
    "file_size": 2450005,
    "plain_text": "# GlobeImposter ransomware: A holiday gift from the Necurs botnet\n\n**[acronis.com/en-us/blog/posts/globeimposter-ransomware-holiday-gift-necurs-botnet](https://www.acronis.com/en-us/blog/posts/globeimposter-ransomware-holiday-gift-necurs-botnet)**\n\nGlobeImposter ransomware\n\n\n-----\n\nOn December 26, 2017, the Necurs botnet delivered a late Christmas gift – the new version\n[of GlobeImposter ransomware [source]. Attached to spam messages as zip archives, the zip](http://www.malware-traffic-analysis.net/2017/12/26/index.html)\n[archive contains a JavaScript that downloads and installs ransomware on a victim’s](https://www.acronis.com/en-us/ransomware-protection/)\ncomputer.\n\n## Static Analysis\n\nThe ransomware loader is supplied with the following icon:\n\nGlobeImposter Ransomware Icon\n\nThe compilation timestamp tells the sample comes from 2016.\n\nHowever, it was first seen in-the-wild on December 4, 2017 according to Virustotal (MD5:\n[2ca016fa98dd5227625befe9edfaba98).](https://www.virustotal.com/#/file/3a9d5976fbf41daf80f0eb9e6b7aadcece52a82fe9609984ef7f8ea166048547/details)\n\n\n-----\n\n## Installation\n\nTo start itself after reboot:\n\n[HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce]\n\n\"BrowserUpdateCheck\" = \"C:\\Users\\<USER>\\AppData\\Roaming\\\n<RANSOMWARE_NAME>.exe\"\n\nThen the GlobeImposter creates the file\n‘AE09C984DF6E74640B3271EADB5DD7C65FDE806235B2CDA478E0EFA9129C09E7’ in\n%All Users%, where the name of the file is the 256-bit RC4 key used to decrypt the\nGlobeImposter’s config:\n\n\n-----\n\n## Decryption of the payload\n\nThe GlobeImposter reads its encrypted image and decrypts itself by 32768(8000h)-byte\nblocks to the nsr3.tmp file in the %Temp% folder.\n\nIt extracts the System.dll (MD5: 3f176d1ee13b0d7d6bd92e1c7a0b9bae) that is a part of\n.NET framework to ‘%Temp%\\nsp4.tmp\\’ folder.\n\n\n-----\n\nAlso, the GlobeImposter drops the file LGU which is 67653 bytes in size (MD5:\neba731947245c854d71341a41de88260) with encrypted data to the Temp folder.\n\n## Config decryption\n\nThe GlobeImposter contains the string used to calculate the SHA256 hash, which is the key\nto extract the config data.\n\nCONFIG_KEY = SHA256\n(“B231B717113902E9F788C7BD0C7ABABAF9B173A7F6B432076B82CBCB7C8149F3C\nF2F55A8CBDD772BFB4E0A319AE1ED45EB4AA6C4C6BAC6E11014BDD47D3BDDA0DC\n19B7F217C8A1B33BCAE7681020436907BEC78F0E47AD285D72B8E5466C83114CC\n40D44A081A604F05E2D147DFC3AEDD9A7B69D493176EFD7D8B0D264D1A2BFB14F\nECC1378A8D90547A2F6CA070E90F95FCAA54FA26FA5D63DC84C6C3780D4BB41BE\n4B608343D72DDE52DE40A2A06D56482454F9DF058E65C3F02CBE1B77289F39EC5\nBDBC58653A35476A205CD7C75A40D34ECFA56DA0A6433E141F0D9AC60DFBAA21E\n8AEB5658168253A315F298EDBC7850D3D79BB1E15FEF367F5BD27BF8D” )\n\n=\n\n\n-----\n\n_AE09C984DF6E74640B3271EADB5DD7C65FDE806235B2CDA478E0EFA9129C09E7_\n\nThe GlobeImposter’s payload decrypts its config, represented by the following C pseudo\ncode:\n\nTo decrypt the config data, GlobeImposter uses RC4 cipher with 256-bit key.\n\n\n-----\n\nOnce decrypted, the extracted config looks as follows:\n\nThe config contains:\n\nThe folder exclusions list\n\n\n-----\n\n_Windows, Microsoft, Microsoft Help, Windows App Certification Kit, Windows Defender,_\n_ESET, COMODO, Windows NT, Windows Kits, Windows Mail, Windows Media Player,_\n_Windows Multimedia Platform, Windows Phone Kits, Windows Phone Silverlight Kits,_\n_Windows Photo Viewer, Windows Portable Devices, Windows Sidebar, WindowsPowerShell,_\n_Temp, NVIDIA Corporation, Microsoft.NET, Internet Explorer, McAfee, Avira, spytech_\n_software, sysconfig, Avast, Dr.Web, Symantec, Symantec_Client_Security, system volume_\n_information, AVG, Microsoft Shared, Common Files, Outlook Express, Movie Maker,_\n_Chrome, Mozilla Firefox, Opera, YandexBrowser, ntldr, Wsus, ProgramData._\n\nThe file extensions exclusion list\n\n.$er,.4db,.4dd,.4d,.4mp,.abs,.abx,.accdb,.accdc\n\nThe string to be added as an extension to encrypted files. The string already contains a\ndot which means the encrypted file will look like: ‘picture.png..doc’.\n\n_.doc_\n\nThe file name with the ransom note\n\nRead___ME.html\n\nAnother 512 bytes of data of unknown purpose mostly filled with zeros\n\nThe last decrypted block is a ransom note:\n\n\n-----\n\nThe list of the processes to be terminated is stored outside of the encrypted config, in the\npayload body.\n\n## Key file\n\nThe ransomware loads the hard-coded 256-bit key (HCK265) from itself, which is used to\ngenerate AES key and IV for files encryption:\n\n_67 E6 09 6A 85 AE 67 BB 72 F3 6E 3C 3A F5 4F A5_\n\n_7F 52 0E 51 8C 68 05 9B AB D9 83 1F 19 CD E0 5B_\n\n\n-----\n\nThe key file with the session keys is created in %All users%. The name of the file is the\nconfig decryption key.\n\nThe key file contains auxiliary data that can be used to decrypt the user’s files. The values\nare encrypted using AES-256-CBC six times with different IVs.\n\n\n-----\n\n## File encryption\n\nThe GlobeImposter ransomware encrypts local, removable, and network drives in parallel by\nrunning multiple threads. Once the key file is created in %All Users%, it starts a new thread\nfor every available drive type to encrypt files on.\n\n\n-----\n\nBefore encryption, it checks:\n\nif the last five letters of the current file’s name to ‘..doc’\nif the file name is equal to ‘Read___ME.html’\nif the file name is equal to the key file name\n‘AE09C984DF6E74640B3271EADB5DD7C65FDE806235B2CDA478E0EFA9129C09E7’\nif the file name is equal to the ransomware file name\n\nTo encrypt the user’s files, the ransomware uses an AES-256-CBC algorithm with no\npadding.\n\n\n-----\n\nTo encrypt a file, the GlobeImposter ransomware calculates IV (16 bytes) and AES key (32\nbytes) based on the hardcoded 32-byte key (HCK256) mentioned above.\n\nCalculating AES 16-byte IV to encrypt a file:\n\n\n-----\n\nAES IV for file encryption is the first 16 bytes of the hash calculated using a modified SHA256 algorithm from the HCK256.\n\nThe last byte of IV is substituted with the four least significant bits of the size of the file to be\nencrypted:\n\nIV[15] = File size & 8000000Fh4\n\nThe AES 32-byte key is generated based on hashing HCK256 with two different SHA256-like\nfunctions run in the loop 8192 times:\n\n\n-----\n\nThe cryptolocker reads a block of data from an original file and rewrites its content with the\nblock of encrypted data in the same file. The block size is 8192 bytes if a file is bigger than\nthat.\n\nThe added encryption footer contains:\n\n32 bytes - the encrypted AES-256 key\n16 bytes - IV\n768 bytes - the encrypted auxiliary data from the key file that can be used to decrypt a\nfile\n\n\n-----\n\nTo release the user’s files locked by running processes, the cryptolocker terminates the\nfollowing processes with the help of the ‘taskkill’ command:\n\noutlook\nssms\npostgre\n1c\nSQL\nexcel\nword\n\n## Removing backups\n\nThe GlobeImposter creates and executes the batch file shown below to:\n\nremove shadow copies of the files\n\n\n-----\n\ndisable remote desktop capability\nclean the Windows events log\n\n_@echo off_\n\n_vssadmin.exe Delete Shadows /All /Quiet_\n\n_reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /va_\n_/f_\n\n_reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers\" /f_\n\n_reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers\"_\n\n_cd %userprofile%\\documents\\_\n\n_attrib Default.rdp -s -h_\n\n_del Default.rdp_\n\n_for /F \"tokens=*\" %1 in ('wevtutil.exe el') DO wevtutil.exe cl \"%1\"_\n\n## Ransom note\n\nThe GlobeImposter creates the ransom note file ‘Read___ME.html’.\n\n\n-----\n\n## Communication with C&C\n\nIPs:\n\n137.254.120.31\n74.220.219.67 (active)\n\n\n-----\n\n## Decryption service\n\nhttp://n224ezvhg4sgyamb.onion/sup.php\n\n\n-----\n\nhttp://n224ezvhg4sgyamb.onion/open.php\n\n\n-----\n\nThe available version of the GlobeImposter decryptor by Emsisoft cannot decrypt files\nencrypted by this version of the GlobeImposter ransomware\n\n[[https://www.nomoreransom.org/en/decryption-tools.html].](https://www.nomoreransom.org/en/decryption-tools.html)\n\n## Alarming trend and Acronis protection\n\nWith this sample, once again we see that new ransomware actively deletes backup files in\nWindows. In addition, there is no working decryptor, which means if your files are encrypted\nand no proper backup was made the data is most likely lost Again the good news is that\n\n\n-----\n\n[Acronis Active Protection successfully blocks the GlobeImposter ransomware, recovering](http://www.acronis.com/en-us/active-protection/)\nfiles in a matter of seconds.\n\nSo when choosing your backup software, be sure to pick wisely if you want to keep your data\nsafe.\n\n\n-----\n\n-----\n\nIf you re looking for a backup solution that come with the industry s only built-in active\n[protection against ransomware, consider Acronis True Image and](http://www.acronis.com/en-us/personal/computer-backup/) [Acronis Cyber Backup.](http://www.acronis.com/en-us/business/backup/)\nBoth include technology that will detect the threat, block the attack, and restore the affected\ndata.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-01-15 - GlobeImposter ransomware- A holiday gift from the Necurs botnet.pdf"
    ],
    "report_names": [
        "2018-01-15 - GlobeImposter ransomware- A holiday gift from the Necurs botnet.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536251,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653765448,
    "ts_modification_date": 1653765448,
    "files": {
        "pdf": "https://archive.orkl.eu/b28e00ff74f21724ae13a46e474e0beea5b9ffa7.pdf",
        "text": "https://archive.orkl.eu/b28e00ff74f21724ae13a46e474e0beea5b9ffa7.txt",
        "img": "https://archive.orkl.eu/b28e00ff74f21724ae13a46e474e0beea5b9ffa7.jpg"
    }
}