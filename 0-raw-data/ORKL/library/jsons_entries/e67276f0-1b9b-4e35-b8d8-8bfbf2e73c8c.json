{
    "id": "e67276f0-1b9b-4e35-b8d8-8bfbf2e73c8c",
    "created_at": "2023-01-12T14:59:17.43635Z",
    "updated_at": "2025-03-27T02:16:26.355956Z",
    "deleted_at": null,
    "sha1_hash": "74fd6c79c3d93482d5df2e0a6bd86ce6d10a232c",
    "title": "2018-08-29 - The Urpage Connection to Bahamut, Confucius and Patchwork",
    "authors": "",
    "file_creation_date": "2022-05-28T15:21:47Z",
    "file_modification_date": "2022-05-28T15:21:47Z",
    "file_size": 333790,
    "plain_text": "# Bahamut, Confucius and Patchwork Connected to Urpage\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/the-urpage-connection-to-bahamut-confucius-and-patchwork/](https://blog.trendmicro.com/trendlabs-security-intelligence/the-urpage-connection-to-bahamut-confucius-and-patchwork/)**\n\nAugust 29, 2018\n\nAPT & Targeted Attacks\n\nWe dig deeper into the possible connection between cyberattacks by focusing on the\nsimilarities an unnamed threat actor shares with Confucius, Patchwork, and Bahamut. For\nthe sake of this report, we will call this unnamed threat actor “Urpage.”\n\nBy: Daniel Lunghi, Ecular Xu August 29, 2018 Read time: ( words)\n\nIn the process of monitoring changes in the threat landscape, we get a clearer insight into\nthe way threat actors work behind the schemes. In this case we dig deeper into the possible\nconnection between cyberattacks by focusing on the similarities an unnamed threat actor\nshares with [Confucius,](https://blog.trendmicro.com/trendlabs-security-intelligence/deciphering-confucius-cyberespionage-operations/) [Patchwork, and another threat actor called Bahamut. For the sake of](https://blog.trendmicro.com/trendlabs-security-intelligence/untangling-the-patchwork-cyberespionage-group/)\nthis report, we will call this unnamed threat actor “Urpage.”\n\nWhat sets Urpage attacks apart is its targeting of InPage, a word processor for Urdu and\nArabic languages. However, its Delphi backdoor component, which it has in common with\nConfucius and Patchwork, and its apparent use of Bahamut-like malware, is what makes it\n[more intriguing as it connects Urpage to these other known threats. In our previous entry, we](https://blog.trendmicro.com/trendlabs-security-intelligence/confucius-update-new-tools-and-techniques-further-connections-with-patchwork/)\nalready covered the Delphi component in the context of the Confucius and Patchwork\n\n\n-----\n\nconnection. We mentioned Urpage as a third unnamed threat actor connected to the two.\nThis time, we look into Urpage to gain a deeper insight into the way several threat actors'\nactions intersect.\n\n**The Bahamut Link**\n\nFake websites\n\nThe link between Bahamut and Urpage can be best discussed by way of the multiple\nmalicious Android samples that matched Bahamut's code and had C&C belonging to the\nUrpage infrastructure. Some of these C&C websites also act as phishing sites that lure users\ninto downloading these very applications. The threat actor sets up these fake websites\ndescribing the application and linking to the Google Play Store to download it, like in the case\nof the malicious website, pikrpro[.]eu, seen below\n\nAnother sample website involved the use of a closely copied version of an existing website,\nwith slight changes in the logo and options above the page. The download links were also\nreplaced to download the malicious Android application instead.\n\n_Figure 1. Original (top) and modified (bottom) website_\n\nUpon writing this entry, we’ve coordinated with Google to ensure that the malicious\napplications these C&C sites advertise are no longer available for download on the Google\nPlay Store. It is important to note however, that not all C&C websites for Urpage advertise\nmalicious applications. Some simply contain a random template with empty categories, likely\nas a ploy to hide its malicious activities.\n\nAndroid targeting\n\nAs with Bahamut applications, once downloaded and executed, it showed multiple malicious\nfeatures that deal with stealing information. Some of these features are listed below.\n\nRetrieves basic information like network information and MAC address from an infected\nphone\nSMS stealing\nContacts stealing\nAudio recording\nGPS location retrieval\nSteals files with the specific extensions, although not all samples target these\nextensions.\n\nFile type File extensions\n\n\n-----\n\nDocument files .txt, .csv, .doc, .docx, .xls, .xlsx, .pdf\n\nWhatsApp databases .db.crypt5 to .db.crypt12\n\nGeolocation related files .kml, .kmz, .gmx, .aqm\n\nAudio files .mp3, .opus\n\nVideos .mp4, .amr, .wmv, .3gp,\n\nPictures .jpeg, .jpg\n\nOf note is one specific application that had a different purpose from the others. This\napplication has the same encryption routine as other Urpage applications. Instead of stealing\ndocuments or images, it works on top of a modified version of the legitimate Threema, an\nend-to-end encrypted messaging application, to steal screenshots of messages.\n\nThis application has the same icon and label as the legitimate Threema. Once launched, it\ndrops a modified APK version of Threema and prompts the user to install the application.\nThe malicious application then hides its icon on the device but still runs in the background,\nwhile the modified Threema works like normal. Unknown to the user, the code in the modified\nThreema allows it to take screenshots of itself every 10 seconds. These images are stored in\nthe location/sdcard/Android/data/ch.threema.app/DataData directory, while the “dropper” or\nthe malicious application working in the background uploads the images to the C&C for the\nthreat actor to access.\n\n_Figure 2. Comparison of legitimate Threema code (left) to the modified version (right) with_\n_the inserted code_\n\nOther activities\n\nAside from acting as a C&C and distributing Bahamut-like malware, some of these websites\nalso serve as the host for other malicious documents. These other activities further establish\nthe link of Urpage — and consequently Bahamut — to other threat actors.\n\nTake, for example, the previously mentioned pikrpro[.]eu. This C&C website also acts as host\nnot only for the malicious Android application but also for two other malicious documents\nlisted here.\n\nA malicious RTF file that exploits the CVE-2017-8750 and drops a malicious VB\nbackdoor with C&C appswonder[.]info\nA malicious InPage file that exploits CVE-2017-12824 and drops two files, one nonmalicious, and one malicious VB backdoor with C&C referfile[.]com\n\n\n-----\n\nTalos recently reported both C&C domain names with one type of campaign that targets iOS\nand involves MDM, and another type using VB and Delphi backdoors. This leads us back to\nthe Confucius and Patchwork link.\n\n**The Confucius Link**\n\n[In our previous entry, we already discussed how Confucius used the same Delphi file stealer](https://blog.trendmicro.com/en_us/research/18/e/confucius-update-new-tools-and-techniques-further-connections-with-patchwork.html)\nas Urpage. Digging into Urpage, we found another link—two malicious RTF files that exploit\ndifferent vulnerabilities but download a similar script (detected as TROJ_POWLOAD.GAA)\ncontaining two base64-encoded URLs. One of the URLs is for the decoy document, while the\nother one is for the payload.\n\nOne of the RTF files was found in a server related to Confucius\n(f1a54dca2fdfe59ec3f537148460364fb5d046c9b4e7db5fc819a9732ae0e063, detected as\nTROJ_CVE201711882.AG), while the other one\n(434d34c0502910c562f5c6840694737a2c82a8c44004fa58c7c457b08aac17bd,detected as\nMal_CVE20170199-2) downloaded a VB Backdoor that pings back to twitck[.]com, a domain\nname belonging to Urpage.\n\n**The Patchwork Link**\n\nPatchwork also uses the Delphi file stealer as a similarity with Urpage, which suggests the\nthree groups are somehow related. But this link is further fortified by the Android applications\nwe found whose code is like that of Bahamut, with the C&C matching the usual name\nregistration pattern of Patchwork’s group, as well as an infrastructure close to an old\nPatchwork domain. Of note was how the C&C was not encrypted in the application code,\ndespite the fact that it contained the same encryption routines as other samples. Patchwork\nhas also recently employed Android malware in its attacks, with its use of a customized\nversion of AndroRAT.\n\n**Summary**\n\nThe many similarities and connections show that threat actors do not work in isolation, and\nthat attacks do not necessarily appear from out of nowhere. This may even suggest that a\n[single development team may be behind this attack — maybe a single paid group that has](https://ctt.ac/jQv59)\nsold its tools and services to other groups with different goals and targets.We’ve summarized\nall the mentioned findings in the table below.\n\n**Urpage** **Bahamut** **Confucius** **Patchwork**\n\n\n\"BioData\" Delphi backdoor and file\nstealer\n\n\nX X X\n\n\nVB backdoor X\n\n\n-----\n\nAndroid \"Bahamut-like\" malware X X X\n\nCustom Android malware X\n\nAndroRAT Android malware X\n\nInPage malicious documents X X\n\nsimply obfuscated HTA downloaders X X\n\nIOS malware X\n\nConfucius malware X\n\nremote-access-c3 backdoor X\n\nSneepy/Byebye shell malware X\n\nPython cloud filestealers X\n\nAllaKore RAT X\n\nBadnews malware X\n\nQuasarRAT X\n\nNDiskMonitor malware X\n\n**Targets**\n\nWe did not find Urpage victims in our telemetry, likely because of the targeted nature of these\nattacks. However, the domains used by Urpage provided hints about its target.\n\nFor one, there is the domain pikrpro[.]eu and its subdomains—the\nislamicfinderfeedback[.]pikrpro[.]eu and the memrifilesforinfo[.]pikpro[.]eu. The two pose as\nlegitimate groups and websites that provide services to Islam followers and users from the\nMiddle East.\n\nAdditionally, many of the files related to the Urpage domains are auto-extractable files that\ndrop Delphi or VB backdoor and open a decoy document. The decoy documents tell more\nabout Urpage's possible targets, as it contains text from articles about the region of Kashmir.\nThe header for a sample document can be seen below.\n\nThe documents can also be image files with the same theme, as can be seen here.\n\n\n-----\n\nMultiple Android applications further drive this notion, as they provide services based on the\ninterests of users in that region. They have a malicious application that provides services for\nreligion, as well as popular sports in the region.\n\n_Figure 3. Malicious application for observing Ramadan_\n\n_Figure 4. Malicious application for cricket news_\n\n**Solutions and Mitigation**\n\nTaking note of these similarities and connections can help organizations and users in their\ncontinued defense against Urpage, Bahamut, Confucius, and Patchwork. The connection of\nUrpage to the other three threat actors demonstrate that cyberattacks don’t exist in silos and\nthat it hints at a circulation of knowledge and technologies that help in the continuing\nevolution of different malicious campaigns. Given this knowledge, organizations must be\nmore vigilant in monitoring threats, as changes in one may mean that changes in others\ncould follow.\n\nOrganizations can develop defenses against the social engineering component these four\nthreat actors have in common. Users should be able to identify the indicators of a social\nengineering campaign. Paying close attention to the domain name of a website before\nperforming any further action can also help mitigate threats, including threats like Urpage\nthat have targeted victims.\n\nAs an additional defense against the growing use of malicious mobile applications,\nenterprises and end users can benefit from multilayered mobile security solutions such\nas [Trend Micro™ Mobile Security for Android™ which is also available on Google](https://blog.trendmicro.com/en_us/forHome/products/mobile-security.html)\nPlay. Trend Micro’s [Mobile App Reputation Service (MARS) covers Android and iOS threats](https://mars.trendmicro.com/)\nusing leading sandbox and machine learning technologies. It can protect users against\nmalware, zero-day and known exploits, privacy leaks, and application vulnerability.\n\n[For organizations, Trend Micro™ Mobile Security for Enterprise provides device, compliance](https://blog.trendmicro.com/en_us/forHome/products/mobile-security.html)\nand application management, data protection, and configuration provisioning. It also protects\ndevices from attacks that leverage vulnerabilities, preventing unauthorized access to apps,\nas well as detecting and blocking malware and fraudulent websites.\n\nThe [Trend Micro™ Deep Discovery™ threat protection platform enables organizations to](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/understanding-targeted-attacks-what-is-a-targeted-attack)\ndetect, analyze, and respond to modern threats such as sophisticated malware, targeted\nattacks, and APTs.\n\n\n-----\n\n[Trend Micro™ Smart Protection for Endpoints with Maximum XGen™ security infuses high-](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\n[fidelity machine learning into a blend of threat protection techniques to eliminate security](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/machine-learning)\ngaps across user activity and any endpoint, offering the broadest possible protection against\nadvanced attacks.\n\nThis [appendix contains the latest Indicators of Compromise (IOCs) related to the different](https://documents.trendmicro.com/assets/Appendix-TheUrpageConnectiontoBahamutConfuciusandPatchwork.pdf)\ngroups.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-29 - The Urpage Connection to Bahamut, Confucius and Patchwork.pdf"
    ],
    "report_names": [
        "2018-08-29 - The Urpage Connection to Bahamut, Confucius and Patchwork.pdf"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "37714790-40c0-4b6b-8e49-1c8f45a0463f",
            "created_at": "2022-10-25T16:07:24.37091Z",
            "updated_at": "2025-03-27T02:02:10.196909Z",
            "deleted_at": null,
            "main_name": "Urpage",
            "aliases": [],
            "source_name": "ETDA:Urpage",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8fddd571-37dc-4bb2-84b4-e41ac6fd11f5",
            "created_at": "2024-02-08T02:00:04.32487Z",
            "updated_at": "2025-03-27T02:00:03.329395Z",
            "deleted_at": null,
            "main_name": "Urpage",
            "aliases": [],
            "source_name": "MISPGALAXY:Urpage",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535557,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653751307,
    "ts_modification_date": 1653751307,
    "files": {
        "pdf": "https://archive.orkl.eu/74fd6c79c3d93482d5df2e0a6bd86ce6d10a232c.pdf",
        "text": "https://archive.orkl.eu/74fd6c79c3d93482d5df2e0a6bd86ce6d10a232c.txt",
        "img": "https://archive.orkl.eu/74fd6c79c3d93482d5df2e0a6bd86ce6d10a232c.jpg"
    }
}