{
    "id": "964ff040-c019-4e5a-9323-f415c000dad4",
    "created_at": "2022-10-25T16:48:20.823826Z",
    "updated_at": "2025-03-27T02:16:09.436742Z",
    "deleted_at": null,
    "sha1_hash": "c92752ce6b098bf1ddb085dd539ac67d58b3ec27",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-04-19T12:03:12Z",
    "file_modification_date": "2022-04-19T12:03:12Z",
    "file_size": 523780,
    "plain_text": "# SparrowDoor\n\n### Malware Analysis Report\n\n**Version 1.0**\n\n\n**28 February 2022**\n© Crown Copyright 2022\n\n\n-----\n\n## SparrowDoor\n\n##### A new variant of SparrowDoor with additional functionality\n\n Executive summary\n\n  - The SparrowDoor loader performs reflective loading of a portable executable (PE) payload\nwith no headers.\n\n  - SparrowDoor implements multiple defence evasion techniques including inline hooks and AV\ndetection.\n\n  - SparrowDoor communicates with the command and control (C2) server over HTTPS.\n\n  - SparrowDoor supports various tasking commands, including reading/writing files and opening\na reverse shell.\n\n##### Introduction\n\nThis report covers technical analysis of a new variant of the SparrowDoor malware reported by ESET\nin September 2021[1]. The variant was found on a UK network in 2021 and contains additional\nfunctionality.\n\nSparrowDoor is a persistent loader and backdoor which employs XOR encoding for the C2 channel\nunderneath HTTPS. The new variant’s additional functionality includes clipboard logging, AV\ndetection, inline hooking of Windows API functions and token impersonation.\n\nThe malware files were recovered from the C:\\ProgramData\\Microsoft\\DRM\\ directory on the\nvictim host.\n\n1 https://www.welivesecurity.com/2021/09/23/famoussparrow-suspicious-hotel-guest/\n\n\n-----\n\n##### Malware details\n\n###### Metadata\n\n**Filename** `libcurl.dll`\n**Description** `SparrowDoor 32-bit loader`\n**Size** `57344 bytes`\n**MD5** `46077a32e433a56eb8ba64dcbf86bc60`\n**SHA-1** `989b3798841d06e286eb083132242749c80fdd4d`\n**SHA-256** `f19bb3b49d548bce4d35e9cf83fba112ef8e087a422b86d1376a395466fdff2d`\n**Compile Time** `2021/12/06 06:27:42 UTC`\n\n**Filename** `libhost.dll`\n**Description** `Obfuscated 32-bit SparrowDoor backdoor and shellcode`\n**Size** `67857 bytes`\n**MD5** `8ad3f513f48f711d573d33b7419e3ed5`\n**SHA-1** `c1890a6447c991880467b86a013dbeaa66cc615f`\n**SHA-256** `e0b107be8034976f6e91cfcc2bbc792b49ea61a071166968fec775af28b1f19c`\n\n###### MITRE ATT&CK[® ]\n\nThis report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible\nknowledge base of adversary tactics and techniques based on real-world observations.\n\n|Metadata|Col2|\n|---|---|\n|Filename|libcurl.dll|\n|Description|SparrowDoor 32-bit loader|\n|Size|57344 bytes|\n|MD5|46077a32e433a56eb8ba64dcbf86bc60|\n|SHA-1|989b3798841d06e286eb083132242749c80fdd4d|\n|SHA-256|f19bb3b49d548bce4d35e9cf83fba112ef8e087a422b86d1376a395466fdff2d|\n|Compile Time|2021/12/06 06:27:42 UTC|\n\n|Filename|libhost.dll|\n|---|---|\n|Description|Obfuscated 32-bit SparrowDoor backdoor and shellcode|\n|Size|67857 bytes|\n|MD5|8ad3f513f48f711d573d33b7419e3ed5|\n|SHA-1|c1890a6447c991880467b86a013dbeaa66cc615f|\n|SHA-256|e0b107be8034976f6e91cfcc2bbc792b49ea61a071166968fec775af28b1f19c|\n\n|Tactic|ID|Technique|Procedure|\n|---|---|---|---|\n|Persistence|T1543.003|Create or Modify System Process: Windows Service|SparrowDoor achieves persistence by installing SearchIndexer.exe as a Windows service, using parameters defined in the malware configuration.|\n||T1547.001|Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder|If SparrowDoor fails to persist as a Windows Service, it installs SearchIndexer.exe in the CurrentVersion\\Run key.|\n|Defence Evasion|T1134.001|Access Token Manipulation: Token Impersonation/Theft|SparrowDoor impersonates the user account token associated with the explorer.exe process.|\n||T1140|Deobfuscate/Decode Files or Information|The SparrowDoor malware file libhost.dll is obfuscated with a 4- byte XOR key and the configuration is obfuscated with an 8-byte XOR key.|\n||T1574.002|Hijack Execution Flow: DLL Side- Loading|The SparrowDoor malware gains execution when the malware file libcurl.dll is side-loaded by SearchIndexer.exe.|\n||T1055.012|Process Injection: Portable Executable Injection|SparrowDoor injects itself into a spawned and suspended instance of svchost.exe during initialisation.|\n\n\n-----\n\n|Tactic|ID|Technique|Procedure|\n|---|---|---|---|\n||T1070.004|Indicator Removal on Host: File Deletion|SparrowDoor can be tasked to remove arbitrary files from the host. It can also be tasked to delete files specific to the malware execution i.e. a clean-up routine.|\n||T1620|Reflective Code Loading|SparrowDoor is loaded by a reflective loader found in libhost.dll.|\n||T1036.005|Masquerading: Match Legitimate Name or Location|A legitimate and signed Notepad++ updater has been renamed SearchIndexer.exe, which is the name of a legitimate Windows binary. This file is used to load SparrowDoor. The malware also uses the name libcurl.dll for its loader, libcurl is a legitimate project.|\n||T1218|Signed Binary Proxy Execution|SparrowDoor is side-loaded into, and hijacks execution of, a signed Notepad++ updater.|\n|Discovery|T1518.001|Software Discovery: Security Software Discovery|SparrowDoor checks the running processes against a list of hardcoded AV names.|\n|Command and Control|T1071.001|Application Layer Protocol: Web Protocols|SparrowDoor uses HTTPS as a Command and control (C2) channel and is proxy aware.|\n||T1573.001|Encrypted Channel: Symmetric Cryptography|SparrowDoor uses static XOR keys to encode data when it is being sent or received over the C2 channel.|\n|Collection|T1115|Clipboard Data|SparrowDoor can be tasked to launch clipboard logging functionality.|\n|Exfiltration|T1041|Exfiltration Over C2 Channel|SparrowDoor can be tasked to exfiltrate files from disk.|\n\n\n-----\n\n##### Functionality\n\n###### Overview\n\nSparrowDoor is a persistent 32-bit loader and backdoor targeting the Windows operating system. The\nbackdoor can be tasked with various commands, such as opening a reverse shell connection with the\nconfigured C2 server or exfiltrating data. There are numerous design features included in the malware\nto evade detection and frustrate analysis.\n\nA legitimate and signed Notepad++ updater has been renamed SearchIndexer.exe by the\nmalware, which is the name of a legitimate Windows file. The Notepad++ updater loads the libcurl\nlibrary, SparrowDoor takes advantage of this, as the malicious loader is given the same name as the\nlegitimate libcurl library and is side-loaded into the renamed Notepad++ updater process\n```\nSearchIndexer.exe. Metadata for SearchIndexer.exe can be found in the ‘Appendix\n\n```\n(SearchIndexer.exe Metadata)’ section.\n\nSparrowDoor creates a mutex, Global\\gup0 to ensure only one instance is running on a victim host\nat any given time.\n\nThe SparrowDoor backdoor registers the paths to three components of the malware as environment\nvariables 111 (SearchIndexer.exe), 222 (libcurl.dll) and 333 (libhost.dll). These\nvariables are used to retrieve the paths to the files as part of the clean-up routine, discussed in the\n‘Functionality (Tasking)‘ section.\n\n###### Loading process\n\nThe following steps and Figure 1 outline the full loading process:\n\n1. The loader, libcurl.dll, is side-loaded by SearchIndexer.exe.\n2. The WinMain function inside SearchIndexer.exe is patched with a long jump to a function\n\nin the loader.\n3. When the patched WinMain executes it jumps into the loader (libcurl.dll).\n4. The loader deobfuscates and executes the backdoor contained within libhost.dll using\n\nthe first 4 bytes of the file as the XOR key, which in this case is 0xB20D0000. This technique\nalso makes it appear as though the loading of the backdoor has stemmed from code within\n```\n    SearchIndexer.exe and not libcurl.dll.\n\n```\n_Figure 1: SparrowDoor loading process_\n\n\n-----\n\nThe relative virtual address (RVA) of SearchIndexer.exe’s WinMain is hardcoded into the\nSparrowDoor loader, meaning the malware is unlikely to execute if it is not loaded by the included\n```\nSearchIndexer.exe as the loader will patch the long jump into an unknown piece of memory. \n\n```\nThe SparrowDoor loader, libcurl.dll will not patch a long jump into the parent executable if it has\nbeen loaded by rundll32.exe. The check for rundll32.exe is likely due to malware functionality\ndiscussed in the ‘Functionality (Tasking)’ section but could also serve the purpose of ensuring it does\nnot carry out any patching of memory if executed in a sandbox by rundll32.exe.\n\nThe deobfuscated libhost.dll is not a PE file, despite the .dll extension. It is a custom file format\nconsisting of:\n\n  - Loader configuration required for reflectively loading the backdoor, such as the entry point,\nsize of sections and virtual address (VA) of the import table.\n\n  - Shellcode of length 0x2C1, which reflectively loads the payload.\n\n  - The raw sections (in order) of the SparrowDoor backdoor.\n\n_Figure 2: libhost.dll structure_\n\nFigure 3 is the first 80 bytes of the loader configuration, with the XOR obfuscation removed. A\nbreakdown of the structure for the loader configuration can be found in Figure 4.\n```\n        00 00 00 00 D4 E2 00 00 EE 5A 00 00 00 40 01 00\n        00 00 40 00 C1 02 00 00 05 00 00 00 00 20 01 00\n        00 10 00 00 00 C0 00 00 00 F0 00 00 00 10 01 00\n        00 20 01 00 00 00 00 00 00 AA 00 00 00 30 00 00\n        00 14 00 00 00 02 00 00 00 16 00 00 00 00 00 00\n\n```\n_Figure 3: Loader configuration, after XOR decoding_\n\n\n-----\n\n```\n // Interpreted struct for loader configuration\n struct LoaderConfiguration {\n   DWORD XOR; // XOR key\n   DWORD va_import; // Virtual address of import table\n   DWORD va_ep; // Virtual address of entry point\n   DWORD image_size;\n   DWORD image_base;\n   DWORD shellcode_length;\n   DWORD sections; // Number of sections\n   DWORD rva_reloc; // RVA of .reloc section\n   DWORD va_text; // Virtual Address of .text section\n   DWORD va_rdata; // Virtual Address of .rdata section\n   DWORD va_data; // Virtual Address of .data section\n   DWORD va_rsrc; // Virtual Address of .rsrc section\n   DWORD va_reloc; // Virtual Address of .reloc section\n   DWORD NULL;\n   DWORD size_text; // Size of .text section\n   DWORD size_rdata; // Size of .rdata section\n   DWORD size_data; // Size of .data section\n   DWORD size_rsrc; // Size of .rsrc section\n   DWORD size_reloc; // Size of .reloc section\n   DWORD NULL;\n }\n\n```\n_Figure 4: Breakdown of loader configuration_\n\nTo analyse the backdoor properly the headers must be rebuilt, it cannot be unmapped or dumped to a\nfile from memory. This is a significant anti-analysis feature.\n\nOnce the backdoor is loaded into SearchIndexer.exe, it checks whether it is running as\n```\nsvchost.exe, if it is not then it spawns a suspended instance of svchost.exe and injects into that\n\n```\nto continue its functionality, after exiting the SearchIndexer.exe process. This results in the\nbackdoor running in an orphaned svchost.exe process created by an abnormal parent\n(SearchIndexer.exe) with no command line arguments.\n\n###### Persistence\n\nSparrowDoor contains two possible options for maintaining persistence. It will first attempt to install\n```\nSearchIndexer.exe as a Windows Service. Service metadata such as the service name, display\n\n```\nname and description are contained in the malware configuration discussed in the ‘Functionality\n(Configuration)’ section, the extracted service details are shown in Table 1. If creating a service fails,\nthen it adds SearchIndexer.exe to the\n```\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run registry key.\n\n```\n**Field** **Value**\n\nService Name SearchIndexer\n\nDisplay Name Windows Searcher\n\nDescription Provides content indexing, property caching and search results for files, e-mail and other\ncontents.\n\nBinary SearchIndexer.exe\n\n_Table 1: Service details_\n\n|Field|Value|\n|---|---|\n|Service Name|SearchIndexer|\n|Display Name|Windows Searcher|\n|Description|Provides content indexing, property caching and search results for files, e-mail and other contents.|\n|Binary|SearchIndexer.exe|\n\n\n-----\n\nOne difference between this sample and the previous variant is this one manually adds the service\nparameter keys to the service area of the registry using registry API calls, the previous variant uses\nthe service API calls to register the service for persistence.\n\n###### Defence evasion \n\n Anti-Virus (AV) detection routine\nThis variant of SparrowDoor implements an Anti-Virus (AV) detection routine which checks running\nprocesses against a list of known AV process names as shown in Table 2. The malware’s\nconfiguration defines whether to enforce the results of the AV check or not, if it is enforced and there\nis a match then the malware won’t execute the read or write file tasking commands discussed in the\n‘Functionality (Tasking)’ section. In this sample the ‘enforce AV check’ is not enforced.\n\nSparrowDoor continues to run and execute most of its functionality even if it is configured to enforce\nthe AV check. No warning is sent to the C2 server that there has been a detection.\n\n###### Process Name Associated AV Company\n\n`ZhuDongFangYu.exe` 360.cn\n\n`avp.exe` Kaspersky\n\n`egui.exe` ESET\n\n`ccSetMgr.exe` Symantec\n\n`ccSvcHst.exe` Symantec\n\n`ccapp.exe` Symantec\n\n`TMBMSRV.exe` Trend Micro\n\n`cpf.exe` Comodo Firewall Pro\n\n`Mcshield.exe` McAfee\n_Table 2: AV process names searched for by SparrowDoor_\n\n###### Privilege downgrade\nBefore making network connections, SparrowDoor impersonates the user account token associated\nwith the explorer.exe process. This is believed to be a method of privilege downgrade to ensure it\nis not drawing undue attention to itself carrying out network communication under a high privilege\naccount, for example SYSTEM.\n\n|Process Name|Associated AV Company|\n|---|---|\n|ZhuDongFangYu.exe|360.cn|\n|avp.exe|Kaspersky|\n|egui.exe|ESET|\n|ccSetMgr.exe|Symantec|\n|ccSvcHst.exe|Symantec|\n|ccapp.exe|Symantec|\n|TMBMSRV.exe|Trend Micro|\n|cpf.exe|Comodo Firewall Pro|\n|Mcshield.exe|McAfee|\n\n\n-----\n\n###### Configuration\n\nThe configuration for SparrowDoor is in the .data section of the backdoor and is structurally the\nsame as the configuration for the previous variant with the addition of an ‘enforce AV check’ setting\nand C2 port, which had previously been hardcoded. The configuration is obfuscated with the same\nXOR key as the previous variant, ^&32yUgf.\n\n**Field** **Value**\n\nDomain cdn181.awsdns-531[.]com\n\nUser user\n\nPass pass\n\nProxy IP 127.1.1.1\n\nProxy Port 8080\n\nC2 Port 443\n\nService Name SearchIndexer\n\nDisplay Name Windows Searcher\n\nDescription Provides content indexing, property caching and search results for files, e-mail and other\ncontents.\n\nEnforce AV 0\nCheck\n\n_Table 3: Malware Configuration_\n\n###### API hooking\n\nSparrowDoor hooks several Windows API functions, achieved by:\n\n  - Dynamically resolving the function.\n\n  - Modifying the memory protection of the first 5 bytes of the function, so the malware can patch\nthem.\n\n  - Saving the first 5 bytes of the function, to be run when execution is returned to the legitimate\nAPI.\n\n  - Patching the first 5 bytes of the function with a long jump to a portion of memory containing\nmalicious code.\n\n  - Reimplementing the original memory protections after the patching has occurred.\n\nThe installed hooks provide user impersonation and control over socket options as described below.\n\n###### User impersonation\nThe AcquireCredentialsHandleA (sspicli.dll) function is hooked to impersonate the loggedon user, using the token associated with the explorer.exe process, before returning execution to\nthe API code. This function is used to acquire credentials from a process to build a token which is\npresented to a remote peer via a protocol such as Kerberos or NTLM. This is therefore believed to be\nan attempt to ensure that if the SparrowDoor process does communicate with a remote peer, it\ndoesn’t use a highly privileged account.\n\nThe process of taking the token from the explorer.exe process and using it to impersonate the\ncurrent logged-on user is observed elsewhere in the malware; it is carried out prior to any C2\nconnection being made and before it modifies some WinINet options as discussed in the\n‘Communications (Command and control)’ section.\n\n|Field|Value|\n|---|---|\n|Domain|cdn181.awsdns-531[.]com|\n|User|user|\n|Pass|pass|\n|Proxy IP|127.1.1.1|\n|Proxy Port|8080|\n|C2 Port|443|\n|Service Name|SearchIndexer|\n|Display Name|Windows Searcher|\n|Description|Provides content indexing, property caching and search results for files, e-mail and other contents.|\n|Enforce AV Check|0|\n\n\n-----\n\n###### Controlling socket options\nThe shutdown (ws2_32.dll) function is used to disable sending and receiving data from a socket\nand is used to begin a graceful shutdown of the TCP connection. This function is patched to bypass\nany execution of the legitimate code and return 0 (success).\n\nThe closesocket (ws2_32.dll) function is hooked to modify the linger socket option before the\nlegitimate function is called. The hook sets the l_onoff parameter to 0 before handing execution\nback to closesocket.\n\n**_Note: l_onoff is the value set if the setsockopt function is called with the optname parameter set to_**\n\n_SO_DONTLINGER and the optval parameter is zero[2]._\n\n_If the l_onoff value is 0, then the socket will attempt to close gracefully[3]._\n\nThe hooking of these socket APIs ensures that all network connections from the malware process are\nclosed gracefully, and no queued data is sent or received once a call to closesocket is made. The\nimpact of patching shutdown is the socket will be released immediately after use and not wait in the\n```\nTIME_WAIT state, as would be default. Malware sockets are therefore only present on the system for\n\n```\nthe minimum possible time. The malware does not directly import the hooked socket APIs for use, but\nrather uses the WinINet API. Hooking these functions provides control over socket options while\nusing WinINet.\n\n**_Note: WinINet APIs do not allow user control over socket options._**\n\n2 https://docs.microsoft.com/en-us/windows/win32/api/winsock/ns-winsock-linger\n\n3 https://docs.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-closesocket\n\n\n-----\n\n###### Tasking\n\nTable 4 below highlights SparrowDoor’s supported tasking functionality. Tasking is received in\nresponse to a beacon and is described in the ‘Communications (Tasking communications)’ section.\n\nThe command IDs 0x15665665 and 0x15655674 will not be executed if AV processes are detected\nas running, as described in the ‘Functionality (Defence Evasion)’ section.\n\n**Command ID** **Description**\n\n`0x15685647` Retrieve information on drives or directories. If the data portion of the command is a ‘$’\nthen return a list of attached drives and their type. If the data is a ‘$’ followed by a\ndirectory, then return a list of the files in the directory along with some file metadata, more\ndetail can be found in ‘Communications (Exfiltration)’.\n\n`0x156A5629` Delete a file, specified by the C2 server.\n\n`0x15695638` Rename a file, with the old and new names specified by the C2 server. The malware\nexpects a 1-byte source filename length, followed by the source filename, followed by a 1byte destination filename length, followed by the destination filename.\n\n`0x156B561A` Create a directory, specified by the C2 server.\n\n`0x15665665` Read the contents of a file, specified by the C2 server. This command is carried out in a\nnew thread.\n\n`0x15655674` Write data to a file, specified by the C2 server. Data written to the file is additionally\ndecoded with the XOR key K&c38^5. This command is carried out in a new thread.\n\n`0x15645683` Log clipboard data to a file, libcurl.dll.log, every second. If the command data is\n‘start clipshot’, spawn a rundll32.exe process with the token of explorer.exe\nto call an export in libcurl.dll which logs clipboard data to a file on disk. If the\ncommand data is ‘stop clipshot’ then terminate the rundll32.exe child process.\n\nSame command code as above. Create/control a reverse shell connection with the C2\nserver. If the command data is ‘exit’ then the reverse shell connection is closed. If the\ncommand data does not match one of the above phrases, it is assumed to be input for the\nreverse shell.\n\n`0x15635692` Victim clean-up. Delete persistence mechanisms, terminate any spawned processes, and\ndelete the files SearchIndexer.exe, libcurl.dll and libhost.dll whose paths\nare retrieved via the previously set environment variables.\n\n_Table 4: Task codes and descriptions_\n\n|Command ID|Description|\n|---|---|\n|0x15685647|Retrieve information on drives or directories. If the data portion of the command is a ‘$’ then return a list of attached drives and their type. If the data is a ‘$’ followed by a directory, then return a list of the files in the directory along with some file metadata, more detail can be found in ‘Communications (Exfiltration)’.|\n|0x156A5629|Delete a file, specified by the C2 server.|\n|0x15695638|Rename a file, with the old and new names specified by the C2 server. The malware expects a 1-byte source filename length, followed by the source filename, followed by a 1- byte destination filename length, followed by the destination filename.|\n|0x156B561A|Create a directory, specified by the C2 server.|\n|0x15665665|Read the contents of a file, specified by the C2 server. This command is carried out in a new thread.|\n|0x15655674|Write data to a file, specified by the C2 server. Data written to the file is additionally decoded with the XOR key K&c38^5. This command is carried out in a new thread.|\n|0x15645683|Log clipboard data to a file, libcurl.dll.log, every second. If the command data is ‘start clipshot’, spawn a rundll32.exe process with the token of explorer.exe to call an export in libcurl.dll which logs clipboard data to a file on disk. If the command data is ‘stop clipshot’ then terminate the rundll32.exe child process.|\n||Same command code as above. Create/control a reverse shell connection with the C2 server. If the command data is ‘exit’ then the reverse shell connection is closed. If the command data does not match one of the above phrases, it is assumed to be input for the reverse shell.|\n|0x15635692|Victim clean-up. Delete persistence mechanisms, terminate any spawned processes, and delete the files SearchIndexer.exe, libcurl.dll and libhost.dll whose paths are retrieved via the previously set environment variables.|\n\n\n-----\n\n##### Communications\n\n###### Command and control\n\nHTTPS is used for the C2 channel, with the port being specified in the malware’s configuration. In this\nsample it is 443. A manual DNS request is initiated once the configuration has been parsed and the\nreturned IP address is used in the HTTP Host header, instead of the configured C2 domain.\n\nSparrowDoor enters a beacon and tasking loop generating a variable sleep time between beacons\nranging from 3-8 minutes, meaning beacons will not have a set periodicity. The malware keeps track\nof timings during execution to ensure that the C2 domain is resolved every hour and that if it has not\nreceived tasking in the last five hours it generates a shorter sleep of between 1.5 and 4 seconds\nbetween beacons.\n\nPrior to sending a beacon or exfiltrating data, SparrowDoor impersonates a logged-on user using the\ntoken associated with the explorer.exe process.\n\nSparrowDoor can send its requests via a proxy, however it defaults to a direct connection. If the direct\nconnection fails, then it can retrieve configured proxy settings from the registry or use the proxy\nsettings supplied in the malware configuration.\n\n###### Beacon structure\n\nThe first 4 bytes of the beacon are a hardcoded beacon command ID. Figure 5 shows an example of\na beacon with the TLS session decrypted.\n```\n POST / HTTP/1.1\n User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0)\n Accept-Language: en-US\n Accept: */*\n Host: <resolved C2 IP>\n Content-Length: 55\n Connection: Keep-Alive\n Cache-Control: no-cache\n <beacon data>\n\n```\n_Figure 5: Beacon POST headers_\n\nThe User-Agent, Accept-Language and Accept headers are hardcoded, the rest of the fields are not.\n\n<beacon data> is a beacon obfuscated with XOR key hH7@83#mi containing basic survey\ninformation, as follows:\n```\n a1 56 62 15 2f 00 00 00 ee 02 00 00 0a 00 00 00 00 00 00 00 c0 a8 00 0a\n 09 32 32 36 30 34 33 30 35 33 04 75 73 65 72 0f 44 45 53 4b 54 4f 50 2d\n 31 32 33 34 35 36 37\n  Command ID Data length Windows Local IP Victim ID,\n                   version data username,\n                                     computer name\n\n```\n_Figure 6: Hex-encoded POST data, after decoding with the XOR key hH7@83#mi._\n\nThe ASCII representation of the victim ID, username, and computer name, as shown in Figure 6\nabove and separated by a length field is:\n\n  - `226033053`\n\n  - `user`\n\n  - `DESKTOP-1234567`\n\n|a1 56 62 15 2f 00 00 00 ee 02 00 00 0a 00 00 00 00 00 00 00 c0 a8 00 0a 09 32 32 36 30 34 33 30 35 33 04 75 73 65 72 0f 44 45 53 4b 54 4f 50 2d 31 32 33 34 35 36 37|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|Command ID|Data length|Windows version data|Local IP|Victim ID, username, computer name|\n\n\n-----\n\nThe malware generates a victim ID by calculating a simple hash based on the concatenated ASCII\nstrings of the username and computer name. The victim ID starts as 0, the concatenated string is then\niterated with each character value being added to the victim ID, multiplying it by 0x1003F then\nmoving onto the next character. The victim ID, username and computer name are included in the\nbeacon data, separated by a length byte.\n\n###### Tasking communications\n\nTo task the SparrowDoor malware, the C2 server responds to the beacon with structured tasking in\nthe HTTP response body. A tasking response contains a command ID, data length and associated\nencoded data for the command, the data is obfuscated with the XOR key h*^4hFa.\n```\n 47 56 68 15 00 00 00 0b 4c 76 1d 0e 34 13 12 0d 58 2d 68\n     Command ID  Command data length  XOR encoded command data\n     (4-byte) (4-byte) (variable length)\n\n```\n_Figure 7: Example task_\n\nWhen de-obfuscated the ASCII representation of the command data shown in Figure 7 is:\n```\n    $\\C:\\Users\\\n\n```\nThis command will therefore retrieve information about the C:\\Users\\ directory. The full list of\ncommand IDs and their functionality are listed in the ‘Functionality (Tasking)’ section.\n\n|47 56 68 15 00 00 00 0b 4c 76 1d 0e 34 13 12 0d 58 2d 68|Col2|Col3|\n|---|---|---|\n|Command ID (4-byte)|Command data length (4-byte)|XOR encoded command data (variable length)|\n\n\n-----\n\n###### Exfiltration\n\nNot all command codes result in exfiltration of data and no success or failure code is sent to the\nserver for these tasks. Any exfiltrated data is sent via a POST request which is structured similarly to\nthe tasking and beacon structure, as shown in Table 8.\n```\n POST / HTTP/1.1\n User-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 5.0)\n Accept-Language: en-US\n Accept: */*\n Host: <resolved C2 IP>\n Content-Length: 124\n Connection: Keep-Alive\n Cache-Control: no-cache\n <exfil data>\n\n```\n_Figure 8: Exfiltration POST headers_\n\n<exfil data> is obfuscated with the same XOR key as the beacon, as described in ‘Communications\n(Beacon Structure)’, and follows the format below:\n```\n 47 56 68 15 74 00 00 00 09 32 32 36 30 34 33 30 35 33 72 48 37 40 7b 09\n 7f 38 1a 0d 3a 44 1c 4d 40 46 1f 35 2c 2d 44 2b 4c 5c 53 31 3d 0d 3b 43\n 40 38 33 23 6b 69 68 48 17 40 38 33 03 6d 69 68 4e 37 40 38 d5 24 6c 69\n 6e 48 38 40 2f 33 39 6d 58 46 3c 4f 34 38 33 23 6d 69 6e 48 37 40 18 33\n 23 6d 49 68 48 37 46 38 33 23 8b 6e 69 48 31 40 37 33 34 6d 4b 68 7a 19\n 34 40 47 23\n   Command ID  Data length Victim ID length Command specific\n              (including (byte), Victim exfil data\n              Victim ID) ID\n\n```\n_Figure 9: Example Data Exfiltration_\n\nFigure 9 is an example of the malware’s response to being issued command ID 0x15685647,\nrequesting the contents of a directory.\n\nThe interpreted structures for decoded exfil data for that command are shown in Figure 10 below. A\nsingle directoryData struct is followed by a fileData struct for each file in the requested\ndirectory.\n```\n struct directoryData {\n   DWORD directoryLength;\n   char[] targetDirectoryName; // The directory path that was targeted\n }\n struct fileData {\n   DWORD NULL;\n   DWORD FileSizeLow;\n   DWORD fileAttributes;\n   DWORD hardcoded; //0x20\n   DWORD filenameLength;\n   WORD SystemTime.Year; // SystemTime for LastWriteTime of file\n   WORD SystemTime.Month;\n   WORD SystemTime.Day;\n   WORD SystemTime.Hour;\n   WORD SystemTime.Minute;\n   WORD SYstemTime.Second;\n   char[] filename;\n }\n\n```\n_Figure 10: Command ID 0x15685647 interpreted structures_\n\n|47 56 68 15 74 00 00 00 09 32 32 36 30 34 33 30 35 33 72 48 37 40 7b 09 7f 38 1a 0d 3a 44 1c 4d 40 46 1f 35 2c 2d 44 2b 4c 5c 53 31 3d 0d 3b 43 40 38 33 23 6b 69 68 48 17 40 38 33 03 6d 69 68 4e 37 40 38 d5 24 6c 69 6e 48 38 40 2f 33 39 6d 58 46 3c 4f 34 38 33 23 6d 69 6e 48 37 40 18 33 23 6d 49 68 48 37 46 38 33 23 8b 6e 69 48 31 40 37 33 34 6d 4b 68 7a 19 34 40 47 23|Col2|Col3|Col4|\n|---|---|---|---|\n|Command ID|Data length (including Victim ID)|Victim ID length (byte), Victim ID|Command specific exfil data|\n\n\n-----\n\n##### Conclusion\n\nThis variant of SparrowDoor’s structure, flow and functionality are very similar to the variant previously\nreported by ESET, but with the addition of functionality such as ‘clipshot’ (the clipboard logging\nfeature), an AV detection routine, token impersonation and hooking capabilities. This variant of\nSparrowDoor is of medium sophistication, despite employing some low sophistication techniques\nsuch as XOR-obfuscation of data.\n\nIt cannot be confirmed exactly why the malware is conducting API hooking and token impersonation,\nbut it appears as though the actor is making conscious operational security decisions. The user\naccount token associated with the explorer.exe process on a well configured system should have\nlow privileges; impersonating the user would therefore mean it was not making network connections\nor accessing resources as a highly privileged user such as the SYSTEM account which may draw\nattention to the malware. The user account token for the explorer.exe process will also be the\nmost common among user-initiated processes as processes inherit the token from their parent, this\nmay also allow it to blend in with activity on the system.\n\nThe choice of AV process names to check for is concise and omits many other common AV agents.\nThe list doesn’t appear to cover targeting of a particular region. SparrowDoor continues to run and\nexecute most of its functionality even if it does detect one of the process names, and no warning is\nsent to the C2 server that there has been a detection.\n\n\n-----\n\n##### Detection \n\n###### Indicators of compromise\n\n|Type|Description|Values|\n|---|---|---|\n|Domain|C2 domain.|cdn181.awsdns-531[.]com|\n|File name|Log file containing clipboard data, stored in the same directory as libcurl.dll.|libcurl.dll.log|\n|Mutex|Mutex created by SparrowDoor.|Global\\gup0|\n|Registry key name|Primary persistence mechanism.|HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentContr olSet\\services\\SearchIndexer|\n|Registry key value|Backup persistence mechanism.|HKEY_CURRENT_USER\\Software\\Microsoft\\Win dows\\CurrentVersion\\Run\\SearchIndexer|\n|Environment variable|Stores the path to SearchIndexer.exe.|111|\n|Environment variable|Stores the path to libcurl.dll.|222|\n|Environment variable|Stores the path to libhost.dll.|333|\n\n\n-----\n\n###### Rules and signatures\n\n|Description|SparrowDoor spawns an instance of svchost.exe, which would be abnormal.|\n|---|---|\n|Precision|No observed false positives.|\n|Rule type|SIGMA|\n|title: SparrowDoor abnormal svchost.exe parent description: SparrowDoor spawns an instance of svchost.exe, which would be abnormal. status: stable date: 2022/02/28 author: NCSC version: 1.0 purpose: malware tlp: white logsource: category: process_creation product: windows detection: selection1: ParentImage|endswith: '\\SearchIndexer.exe' selection2: Image|endswith: '\\svchost.exe' condition: selection1 and selection2 level: medium||\n\n\n-----\n\n|Description|SparrowDoor's loader has an export which is called by the backdoor to log clipboard data.|\n|---|---|\n|Precision|No observed false positives.|\n|Rule type|SIGMA|\n|title: SparrowDoor Clipshot description: SparrowDoor's loader has an export which is called by the backdoor to log clipboard data. status: stable date: 2022/02/28 author: NCSC version: 1.0 purpose: malware tlp: white logsource: category: process_creation product: windows detection: selection1: ParentImage|endswith: '\\svchost.exe' selection2: Image|endswith: '\\rundll32.exe' selection3: CommandLine|contains: 'curl_easy_init' condition: selection1 and selection2 and selection3 level: medium||\n\n\n-----\n\n|Description|Identifies code segments in SparrowDoor responsible for patching APIs. No MZ/PE match as the backdoor has no header. Targeting in memory.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal.|\n|Rule type|YARA|\n|rule SparrowDoor_apipatch { meta: author = \"NCSC\" description = \"Identifies code segments in SparrowDoor responsible for patching APIs. No MZ/PE match as the backdoor has no header. Targeting in memory.\" date = \"2022-02-28\" hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\" strings: $save = {8B 06 89 07 8A 4E 04} // save off first 5 bytes of function $vp_1 = {89 10 8A 4E 04 8B D6 2B D0 88 48 04 83 EA 05 C6 40 05 E9 89 50 06} // calculate long jump $vp_2 = {50 8B D6 6A 40 2B D7 88 4F 04 83 EA 05 6A 05 C6 47 05 E9 89 57 06 56} // calculate long jump 2 $vp_3 = {51 52 2B DE 6A 05 83 EB 05 56 C6 06 E9 89 5E 01} // restore memory protections $va = {6A 40 68 00 10 00 00 68 00 10 00 00 6A 00} // virtually alloc set size, allocation and protection $s_patch = {50 68 7F FF FF FF 68 FF FF 00 00 56} // socket patch SO_DONTLINGER condition: 3 of them }||\n\n\n-----\n\n|Description|The SparrowDoor loader contains a feature it calls clipshot, which logs clipboard data to a file.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal.|\n|Rule type|YARA|\n|import \"pe\" rule SparrowDoor_clipshot { meta: author = \"NCSC\" description = \"The SparrowDoor loader contains a feature it calls clipshot, which logs clipboard data to a file.\" date = \"2022-02-28\" hash1 = \"989b3798841d06e286eb083132242749c80fdd4d\" strings: $exsting_cmp = {8B 1E 3B 19 75 ?? 83 E8 04 83 C1 04 83 C6 04 83 F8 04} // comparison routine for previous clipboard data $time_format_string = \"%d/%d/%d %d:%d\" ascii $cre_fil_args = {6A 00 68 80 00 00 00 6A 04 6A 00 6A 02 68 00 00 00 40 52} condition: (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and all of them and (pe.imports(\"User32.dll\",\"OpenClipboard\") and pe.imports(\"User32.dll\",\"GetClipboardData\") and pe.imports(\"Kernel32.dll\",\"GetLocalTime\") and pe.imports(\"Kernel32.dll\",\"GlobalSize\")) }||\n\n|Description|Targets the XOR encoded SparrowDoor loader config and shellcode using the known position of the XOR key.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal.|\n|Rule type|YARA|\n|rule SparrowDoor_config { meta: author = \"NCSC\" description = \"Targets the XOR encoded loader config and shellcode in the file libhost.dll using the known position of the XOR key.\" date = \"2022-02-28\" hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\" condition: (uint16(0) != 0x5A4D) and (uint16(0) != 0x8b55) and (uint32(0) ^ uint32(0x4c) == 0x00) and (uint32(0) ^ uint32(0x34) == 0x00) and (uint16(0) ^ uint16(0x50) == 0x8b55) }||\n\n\n-----\n\n|Description|Targets code features of the SparrowDoor loader. This rule detects the previous variant and this one.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal.|\n|Rule type|YARA|\n|rule SparrowDoor_loader { meta: author = \"NCSC\" description = \"Targets code features of the SparrowDoor loader. This rule detects the previous variant and this new variant.\" date = \"2022-02-28\" hash1 = \"989b3798841d06e286eb083132242749c80fdd4d\" strings: $xor_algo = {8B D0 83 E2 03 8A 54 14 10 30 14 30 40 3B C1} $rva = {8D B0 [4] 8D 44 24 ?? 50 6A 40 6A 05 56} // load RVA of process exe $lj = {2B CE 83 E9 05 8D [3] 52 C6 06 E9 89 4E 01 8B [3] 50 6A 05 56} // calculate long jump condition: (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and all of them }||\n\n|Description|Targets code features of the reflective loader for SparrowDoor. Targeting in memory.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal.|\n|Rule type|YARA|\n|rule SparrowDoor_shellcode { meta: author = \"NCSC\" description = \"Targets code features of the reflective loader for SparrowDoor. Targeting in memory.\" date = \"2022-02-28\" hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\" strings: $peb = {8B 48 08 89 4D FC 8B 51 3C 8B 54 0A 78 8B 74 0A 20 03 D1 03 F1 B3 64} $getp_match = {8B 06 03 C1 80 38 47 75 34 80 78 01 65 75 2E 80 78 02 74 75 28 80 78 03 50 75 22 80 78 04 72 75 1C 80 78 06 63 75 16 80 78 05 6F 75 10 80 78 07 41 75 0A} $k_check = {8B 48 20 8A 09 80 F9 6B 74 05 80 F9 4B 75 05} $resolve_load_lib = {C7 45 C4 4C 6F 61 64 C7 45 C8 4C 69 62 72 C7 45 CC 61 72 79 41 C7 45 D0 00 00 00 00 FF 75 FC FF 55 E4} condition: 3 of them }||\n\n\n-----\n\n|Description|SparrowDoor implements a Sleep routine with value seeded on GetTickCount. This signature detects the previous and this variant of SparrowDoor. No MZ/PE match as the backdoor has no header.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal.|\n|Rule type|YARA|\n|rule SparrowDoor_sleep_routine { meta: author = \"NCSC\" description = \"SparrowDoor implements a Sleep routine with value seeded on GetTickCount. This signature detects the previous and this variant of SparrowDoor. No MZ/PE match as the backdoor has no header.\" date = \"2022-02-28\" hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\" strings: $sleep = {FF D7 33 D2 B9 [4] F7 F1 81 C2 [4] 8B C2 C1 E0 04 2B C2 03 C0 03 C0 03 C0 50} condition: all of them }||\n\n|Description|Highlights XOR routines in SparrowDoor. No MZ/PE match as the backdoor has no header. Targeting in memory.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal.|\n|Rule type|YARA|\n|rule SparrowDoor_xor { meta: author = \"NCSC\" description = \"Highlights XOR routines in SparrowDoor. No MZ/PE match as the backdoor has no header. Targeting in memory.\" date = \"2022-02-28\" hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\" strings: $xor_routine_outbound = {B8 39 8E E3 38 F7 E1 D1 EA 8D 14 D2 8B C1 2B C2 8A [4] 00 30 14 39 41 3B CE} $xor_routine_inbound = {B8 25 49 92 24 F7 E1 8B C1 2B C2 D1 E8 03 C2 C1 E8 02 8D 14 C5 [4] 2B D0 8B C1 2B C2} $xor_routine_config = {8B D9 83 E3 07 0F [6] 30 18 8D 1C 07 83 E3 07 0F [6] 30 58 01 8D 1C 28 83 E3 07 0F [6] 30 58 02 8D 1C 02 83 E3 07 0F [6] 30 58 03 8B DE 83 E3 07 0F [6] 30 58 04 83 C6 05 83 C1 05} condition: 2 of them }||\n\n\n-----\n\n|Description|Strings that appear in SparrowDoor’s backdoor. Targeting in memory.|\n|---|---|\n|Precision|No observed false positives in testing or retrohunts in VirusTotal. Decreasing the number of matches below 10 did lead to false positives.|\n|Rule type|YARA|\n|rule SparrowDoor_strings { meta: author = \"NCSC\" description = \"Strings that appear in SparrowDoor’s backdoor. Targeting in memory.\" date = \"2022-02-28\" hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\" strings: $reg = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" ascii $http_headers = {55 73 65 72 2D 41 67 65 6E 74 3A 20 4D 6F 7A 69 6C 6C 61 2F 34 2E 30 20 28 63 6F 6D 70 61 74 69 62 6C 65 3B 20 4D 53 49 45 20 35 2E 30 3B 20 57 69 6E 64 6F 77 73 20 4E 54 20 35 2E 30 29 0D 0A 41 63 63 65 70 74 2D 4C 61 6E 67 75 61 67 65 3A 20 65 6E 2D 55 53 0D 0A 41 63 63 65 70 74 3A 20 2A 2F 2A 0D 0A} $http_proxy = \"HTTPS=HTTPS://%s:%d\" ascii $debug = \"SeDebugPrivilege\" ascii $av1 = \"avp.exe\" ascii // Kaspersky $av2 = \"ZhuDongFangYu.exe\" ascii // Qihoo360 $av3 = \"egui.exe\" ascii // ESET $av4 = \"TMBMSRV.exe\" ascii // Trend Micro $av5 = \"ccSetMgr.exe\" ascii // Norton $clipshot = \"clipshot\" ascii $ComSpec = \"ComSpec\" ascii $export = \"curl_easy_init\" ascii condition: 10 of them }||\n\n\n-----\n\n##### Appendix\n\n###### SearchIndexer.exe Metadata\n\n**Filename** `SearchIndexer.exe`\n**Description** `Original name GUP.exe, a signed Generic Updater for Notepad++`\n**Size** `580240 bytes`\n**MD5** `5f983177f3f9ce6cb72088f3da96435d`\n**SHA-1** `1bb8f3f8c67199c36b26115442930d0108dc8e6a`\n**SHA-256** `9863ac60b92fad160ce88353760c7c4f21f8e9c3190b18b374bdbca3a7d1a3fb`\n**Compile Time** `2018/12/22 13:15:56 UTC`\n\n|Filename|SearchIndexer.exe|\n|---|---|\n|Description|Original name GUP.exe, a signed Generic Updater for Notepad++|\n|Size|580240 bytes|\n|MD5|5f983177f3f9ce6cb72088f3da96435d|\n|SHA-1|1bb8f3f8c67199c36b26115442930d0108dc8e6a|\n|SHA-256|9863ac60b92fad160ce88353760c7c4f21f8e9c3190b18b374bdbca3a7d1a3fb|\n|Compile Time|2018/12/22 13:15:56 UTC|\n\n\n-----\n\n#### Disclaimer\n\n\nThis report draws on information derived from NCSC and industry sources. Any NCSC findings\nand recommendations made have not been provided with the intention of avoiding all risks and\nfollowing the recommendations will not remove all such risk. Ownership of information risks\nremains with the relevant system owner at all times.\n\nThis information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt\nunder other UK information legislation.\n\n[Refer any FOIA queries to ncscinfoleg@ncsc.gov.uk.](mailto:ncscinfoleg@ncsc.gov.uk)\n\nAll material is UK Crown Copyright ©\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
    ],
    "report_names": [
        "NCSC-MAR-SparrowDoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "f67fb5b3-b0d4-484c-943e-ebf12251eff6",
            "created_at": "2022-10-25T16:07:23.605611Z",
            "updated_at": "2025-03-27T02:02:09.884272Z",
            "deleted_at": null,
            "main_name": "FamousSparrow",
            "aliases": [
                "Earth Estries"
            ],
            "source_name": "ETDA:FamousSparrow",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0eca237-f191-448f-87d1-5d6b3651cbff",
            "created_at": "2024-02-06T02:00:04.140087Z",
            "updated_at": "2025-03-27T02:00:03.323578Z",
            "deleted_at": null,
            "main_name": "GhostEmperor",
            "aliases": [
                "FamousSparrow",
                "UNC2286",
                "Salt Typhoon",
                "RedMike"
            ],
            "source_name": "MISPGALAXY:GhostEmperor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d390d62a-6e11-46e5-a16f-a88898a8e6ff",
            "created_at": "2024-12-28T02:01:54.899899Z",
            "updated_at": "2025-03-27T02:02:10.122415Z",
            "deleted_at": null,
            "main_name": "Salt Typhoon",
            "aliases": [
                "Earth Estries",
                "FamousSparrow",
                "GhostEmperor",
                "RedMike",
                "Salt Typhoon",
                "UNC2286"
            ],
            "source_name": "ETDA:Salt Typhoon",
            "tools": [
                "Agentemis",
                "Backdr-NQ",
                "Cobalt Strike",
                "CobaltStrike",
                "Crowdoor",
                "Cryptmerlin",
                "Deed RAT",
                "Demodex",
                "FamousSparrow",
                "FuxosDoor",
                "GHOSTSPIDER",
                "HemiGate",
                "MASOL RAT",
                "Mimikatz",
                "NBTscan",
                "NinjaCopy",
                "ProcDump",
                "PsExec",
                "PsList",
                "SnappyBee",
                "SparrowDoor",
                "TrillClient",
                "WinRAR",
                "Zingdoor",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041769,
    "ts_creation_date": 1650369792,
    "ts_modification_date": 1650369792,
    "files": {
        "pdf": "https://archive.orkl.eu/c92752ce6b098bf1ddb085dd539ac67d58b3ec27.pdf",
        "text": "https://archive.orkl.eu/c92752ce6b098bf1ddb085dd539ac67d58b3ec27.txt",
        "img": "https://archive.orkl.eu/c92752ce6b098bf1ddb085dd539ac67d58b3ec27.jpg"
    }
}