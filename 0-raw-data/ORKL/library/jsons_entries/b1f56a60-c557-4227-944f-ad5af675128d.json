{
    "id": "b1f56a60-c557-4227-944f-ad5af675128d",
    "created_at": "2023-01-12T15:01:57.401147Z",
    "updated_at": "2025-03-27T02:05:49.900122Z",
    "deleted_at": null,
    "sha1_hash": "a1db67887e575ced3fb1a8b954af597fa7190909",
    "title": "2020-04-13 - Threat Spotlight- Gootkit Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T02:30:08Z",
    "file_modification_date": "2022-05-28T02:30:08Z",
    "file_size": 509164,
    "plain_text": "# Threat Spotlight: Gootkit Banking Trojan\n\n**[blogs.blackberry.com/en/2020/04/threat-spotlight-gootkit-banking-trojan](https://blogs.blackberry.com/en/2020/04/threat-spotlight-gootkit-banking-trojan)**\n\nMasaki Kasuya, Tatsuya Hasegawa\n\n[RESEARCH & INTELLIGENCE / 04.13.20 /](https://blogs.blackberry.com/en/category/research-and-intelligence) [Tatsuya Hasegawa,](https://blogs.blackberry.com/en/author/tatsuya-hasegawa) [Masaki Kasuya](https://blogs.blackberry.com/en/author/masaki-kasuya)\n\nGootkit is a sophisticated banking Trojan which can perform various malicious activities such as:\nweb injection, taking screenshots, video recording, email parsing, and so on. Gootkit emerged\nduring the summer of 2014 but is still active, making it a viable threat to financial institutions to\nthis day.\n\n[BlackBerry most recently observed a Gootkit campaign via AZORult infostealer malware in](https://threatvector.cylance.com/en_us/home/threat-spotlight-analyzing-azorult-infostealer-malware.html)\nFebruary, March, and April of 2019. Our monitoring revealed the threat actor changed Gootkit\nhosting domain names constantly and created Gootkit variants almost daily. Its core module\ncontains several JavaScript files and the node.js runtime environment, so as a result, its file size\ntends to be large. In fact, our analyzed sample was over 6 MB.\n\nThis technical blog covers information on the Gootkit/AZOrult campaign and presents the results\nof our latest analysis. While we found a few dozen Gootkit samples, we focused on the latest\nsamples (a3c243afceb1fb38f25ae81816891d7d7c11ae76e80a43f31d2ceb9833f2f3df). This\nvariant aimed to steal login accounts from users of five French banks.\n\n## Technical Analysis\n\n### Gootkit via AZORult\n\n[In a previous blog on AZORult, BlackBerry examined the protocol used by the malware to](https://threatvector.cylance.com/en_us/home/threat-spotlight-analyzing-azorult-infostealer-malware.html)\ncommunicate with command-and-control (C2) servers. We implemented a custom scanner to\nmonitor the C2 servers and download and parse configuration settings. The scanner caught some\nGootkit campaigns via AZORult occurring on the dates below:\n\n\n-----\n\n1. Feb. 9 2019 - Feb. 11 2019,\n2. Feb. 15 2019 - Mar 7 2019.\n3. Mar. 12 2019 - Mar 13 2019.\n4. Mar. 31 2019 - Apr. 1 2019.\n\nThe threat actor generated Gootkit variants almost every day and used a variety of malware\nhosting domain names. For more detail of the campaign information, see Table 1 and Table 2:\n\n**SHA256 (Gootkit)** **Gootkit Delivery URL** **Date**\n\n\n879b1f79cbd105ff52ac9a0b01cee4be\nf921df59e72fb7f5e41db48430ca9a85\n\n1d62fec40f14dd0458556f0211529df88\nd19fe0249d195d6153388610c5525df\n\nb9440e407b971def1d8a3d19c2da0e81\n145aad4b29e51602fc11f566e9854537\n\nd01defb4fe8db26ea0151afa1c4e817db\n1aba1c8464127110f7ef860164ed79a\n\n6b19c0ec581ca24ef2a35d37af523ab2a\nf19740585ad653d98593a057268e01c\n\n2a1dd210ed71e33e58aadd9157eebb35\nad38eb70cb182d244a8f9879f195b930\n\n1b052c6d721f4dc36b3e58192ac6c664\nd43aec8f15fcd2a8f91616f705192ebb\n\n6a9b222b7be97ed608bcbef6dc05cff9f\nb16ae9a31a08e719857cad6146dc8d7\n\n\nhxxp://hairpd[.]com/stat/sputik[.]exe Feb\n9\n2019\n\nhxxp://camdunki[.]com/gx/Aleto[.]exe Feb\n11\n2019\n\nhxxp://camdunki[.]com/gx/wipip[.]exe Feb\n15\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/tlss[.]exe Feb\n16\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/tlss[.]exe Feb\n17\n2019\n                                  Feb\n18\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/tlss[.]exe Feb\n18\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/tlss[.]exe Feb\n19\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/tlss[.]exe Feb\n20\n2019\n\n\n-----\n\ne67ec7af646f6b9bdfe59e3549f84bd30\n71c72386de57e9a9a5fe58982dbdd49\n\n5eb54a536d9b560b79c7113efa5eebcb\ne21e9aede3f751d14a98b38c829a53b5\n\n6c2d6abc2e130092f414d4f64adeb22d\nac56e8f802d4250c84db62a563bf99ec\n\n9f6881386d0ff9a0cd2bc49da21b999d1\n3e4ebdc858bdad755ee26898c567a3d\n\nab54b89a75ee9d858b734e927ff16aef3\nd5c8137552c9973864d7eed8aa5e472\n\n3974b0985d524dd38a9d040c9eaf880c\n421411210e0bdd577ac2306f6471a413\n\n81a2c4c708c13338ed7aac439aa876c5\ne1d2116afb23e7cf8a345a05ebd55eed\n\nfb05723ac5960a5776d7432429998d4a\n48a3f7e74761046352c16712208bd983\n\n983b39b339bc62a09c20ea2f1b1360e1\n7bf9431587e2a257ec4f3a62b4489ff4\n\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/tlss[.]exe Feb\n21\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/zip[.]exe Feb\n22\n2019\nAM\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/zip[.]exe Feb\n22\n2019\nPM\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/zip[.]exe Feb\n23\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/zip[.]exe Feb\n23\n2019\n-Feb\n24\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/remove[.]exe Feb\n24\n2019\n                                  Feb\n25\n2019\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/Atrip[.]exe Feb\n26\n2019\n\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/\nDlKitlMNdktild[.]exe\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/\naHdBhBjUhBHm[.]exe\n\n\nFeb\n28\n2019\nAM\n\nFeb\n28\n2019\nPM\n\n\n-----\n\n212aeaf6cec0884743c2c3079dab17eb\n581dc28329be3e023f62c751cd01169f\n\nfcbe6c55b2b092b1d97aa2d8a9ac6f356\n5b10c47ae7d59b08552d0e2ee11d102\n\n729502b7b074e55f1e7d364ae3917043\n76480a28081ca0d7eba4495fca3b1367\n\ne70a9cfd7c9f1a23d00cdc5eba866ea6\nc80a4a555498f8d0feba58a765b9aa39\n\nd5ba0f1c01cf12f57cca93996d2f87191\nc9420afbbd116d3757060d780338d29\n\n5766bffa91f87cd08582fac05209c5d8d\n9356ad88e15499038dc624c0ccbc468\n\nc1ae38afb6c82b9107868d66318095f1\nc00f1e92dddc0ee953c23a8de4ace353\n\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/Astart[.]exe Mar\n1\n2019\nAM\n\nhxxp://chermin[.]tweakdsl[.]nl/loges/Astart[.]exe Mar\n1\n2019\nPM\n\nhxxp://kbhookah[.]com/loggers/repost[.]exe Mar\n2\n2019\n                                  Mar\n4\n2019\n\nhxxp://kbhookah[.]com/loggers/repost[.]exe Mar\n5\n2019\n\n\nhxxp://new[.]eltrans53[.]ru/uploads/utf8[.]exe Mar\n12\n2019\n                                  Mar\n13\n2019\n\n\nhxxp://startintern[.]terweij[.]nl/wpadmin/repox[.]exe\n\nhxxp://startintern[.]terweij[.]nl/wpadmin/repox[.]exe\n\n\nMar\n6\n2019\n\nMar\n7\n2019\n\n\n_Table 1: Gootkit campaign from ssl[.]admin[.]itybuy[.]it (an AZORult C2 server)_\n\n**SHA256 (Gootkit)** **Gootkit Delivery URL** **Date**\n\n\n-----\n\na3c243afceb1fb38f25ae81816891d7d\n7c11ae76e80a43f31d2ceb9833f2f3df\n\n\nhxxp://ccleanerhome[.]com/fonts/igfpers[.]exe Mar 31\n2019 Apr 1\n2019\n\n\n_Table 2: Gootkit campaign from triangularty[.]com (an AZORult C2 server)_\n\n## Loader and Core DLL Module\n\nGootkit has two modules: the loader and the core DLL module, as shown in Figure 1 below. The\nloader is used for evasion, persistence, and downloading the core DLL module. Once the loader\ndownloads the core DLL module, Gootkit can perform malicious actions such as:\n\nWeb injection\nKey logging\nLaunching VNC server\nRecording video\n\n_Figure 1: Two modules of Gootkit: Loader and Core DLL Module_\n\n## Evasion\n\nGootkit uses many evasion techniques, including anti-VM (virtual machine), anti-debug, and antisandbox. It performs the following evasive activities:\n\n1.  Check loaded DLL files related to Sandbox technology and debugging by detecting the\nfollowing strings:\na.  dbghelp.dll (Windows standard debugger’s module)\nb.  sbiedll.dll (software Sandboxie’s module)\n\n\n-----\n\n2.  Check usernames by detecting the following strings:\na.  CurrentUser\nb.  Sandbox\n\n3.  Check computer names by detecting the following strings.\na.  SANDBOX\nb.  7SILVIA\n\n4.  Check registry keys related to the Hardware BIOS information by detecting the strings shown\nin Table 3:\n\n**Registry Key** **Registry Entry** **Data**\n\nHKLM\\HARDWARE\\DESCRIPTION\\System SystemBiosVersion AMI\nBOCHS\nQEMU\nSMCI\nINTEL –\n6040000\nFTNT-1\nVBOX\nSONI\n\nHKLM\\HARDWARE\\DESCRIPTION\\System VideoBiosVersion VirtualBox\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion SystemBiosVersion 55274-640267306423950\n(this value is\nassociated\nwith\nJoeSandbox )\n76487-644317703723510\n( this value is\nassociated\nwith\nCWSandbox )\n76487-337842995522614\n( this value is\nassociated\nwith Anubis )\n\n_Table 3: Registry check for evasion_\n\nHardware SystemBiosVersion checking code is shown in Figure 2:\n\n\n-----\n\n_Figure 2: Hardware SystemBiosVersion check for evasion_\n\nIn addition, the evasive techniques are anti-forensic. Meaningful strings shown in Table 3 are\nstored in temporary heap memory. At the end of this evasion function, the allocated heap memory\nis released by using RtlFreeHeap and HeapFree (see Figure 3). The purpose of the evasion is to\nmake memory forensics more difficult to perform:\n\n_Figure 3: Erasing meaningful strings with RtlFreeHeap and HeapFree API_\n\n## Persistence\n\nGootkit uses Pending GPO (see Figure 4) to relaunch the malware after reboot. First, it drops an\n.inf file under the same directory as the Trojan file. The base filename of the INF file is the same\nas the malware file. For example, if the filename of Gootkit is “igfpers.exe”, the .inf file name is\n“igfpers.inf”:\n\n_Figure 4: An .inf file created by Gootkit_\n\n\n-----\n\nGootkit then creates three registry values: Count, Path1, and Section1 under\n“HKCU\\Software\\Microsott\\IEAK\\GroupPolicy\\PendingGPOs” as shown in Figure 5. “Path1”\ncontains the full path of the .inf file and “Section1” refers to a section name (“DefaultInstall”)\nwritten in the .inf file:\n\nFigure 5: Registry values for its persistence\n\n## Core DLL Module Installation\n\nGootkit loader launches itself using the “--vwxyz” options. It then downloads an encoded DLL\nmodule from the C2 server and injects it into a Gootkit process. The C2 server will not send the\nDLL module without the appropriate “UserAgent”. Once it receives a valid response from the C2\nserver, Gootkit splits the encoded DLL module into chunks. Each chunk size is 512,000 bytes (at\nmost) and is saved under “HKCU\\Software\\AppData\\Low\\finget_{index number}” (See Figure 6).\nAfter reboot, Gootkit loads the data from registry keys and concatenates all chunks into an\nencoded DLL. This results in the core DLL module becoming fileless:\n\n_Figure 6: Registry values for its persistence_\n\nThe DLL module is decrypted and decompressed by “RTLDecompressBuffer”. Gootkit then\nallocates a new memory section to the current process and copies it into the allocated memory.\n\nThe DLL module contains JavaScript files for performing malicious activity. During our\ninvestigation, we found over a hundred embedded JS files. Most of them are innocent (Node.js\nlibrary). However, some JavaScript files are intended for malicious purposes such as\n\n\n-----\n\nmalware.js, spyware.js, zeusmask.js, and so on. Malicious JavaScript codes are responsible\nfor backdoor functions which allow Gootkit to:\n\nUpdate the DLL\nLaunch VNC server\nCapture keystrokes\nInject malicious scripts for stealing online banking credentials\nRecord video\nSteal email\nPerform other malicious actions\n\nIn addition, a JavaScript file is designed to detect VM environments (Figure 7):\n\n_Figure 7: VM check_\n\n## Banking Trojan\n\nThe DLL module receives web injection code from its C2 server and tries to steal login accounts\nfrom victims who used five French banks. Figure 9 shows a code snippet of web injection script.\nThe threat monitors the victim’s web browser and steals credentials when the French banks are\naccessed. The link at the bottom of Figure 8 stored a French-bank-specific script:\n\n\n-----\n\n_Figure 8: A web injection script against a French bank_\n\nA JavaScript code targeting one French bank was also able to steal PIN numbers.\n\nCautious users might choose to use a software keyboard to input sensitive information on online\nbanking websites. However, Gootkit displays a fake software keyboard designed to steal user\ninput (and the victim’s PIN number).\n\n## Conclusion\n\nThis blog covered a Gootkit campaign that spread using AZORult infostealer. During this\ncampaign, attackers constantly changed the hash values of Gootkit and the hosting URLs. Based\nupon our monitoring, the campaign was active between February and April 2019. The sample we\nanalyzed was aimed at stealing banking information from users of five French banks. Gootkit is\nstill being actively used against victims in EU regions.\n\n[If you are using BlackBerry’s endpoint protection solution CylancePROTECT®, you are](https://www.cylance.com/en-us/platform/products/cylance-protect.html)\nproactively protected from Gootkit. Blackberry uses artificial intelligence-based agents trained for\nthreat detection on millions of both safe and unsafe files. Our automated security agents block\nGootkit based on countless file attributes and malicious behaviors instead of relying on a specific\nfile signature. CylancePROTECT, which offers a [predictive advantage over zero-day threats, is](https://threatvector.cylance.com/en_us/home/cylance-vs-future-threats-the-predictive-advantage.html)\ntrained on and effective against both new and legacy cyberattacks.\n\n[For more information visit https://www.cylance.com and](https://www.cylance.com/) [https://www.blackberry.com/us/en.](https://www.blackberry.com/us/en)\n\n## Appendix\n\n### Indicators of Compromise (IOCs)\n\n\n-----\n\n**Hashes**\no  Gootkit loader:\n\na3c243afceb1fb38f25ae81816891d7d7c11ae76e80a43f31d2ceb9833f2f3df\nc1ae38afb6c82b9107868d66318095f1c00f1e92dddc0ee953c23a8de4ace353\n5766bffa91f87cd08582fac05209c5d8d9356ad88e15499038dc624c0ccbc468\nd5ba0f1c01cf12f57cca93996d2f87191c9420afbbd116d3757060d780338d29\ne70a9cfd7c9f1a23d00cdc5eba866ea6c80a4a555498f8d0feba58a765b9aa39\n729502b7b074e55f1e7d364ae391704376480a28081ca0d7eba4495fca3b1367\nfcbe6c55b2b092b1d97aa2d8a9ac6f3565b10c47ae7d59b08552d0e2ee11d102\n212aeaf6cec0884743c2c3079dab17eb581dc28329be3e023f62c751cd01169f\n983b39b339bc62a09c20ea2f1b1360e17bf9431587e2a257ec4f3a62b4489ff4\nfb05723ac5960a5776d7432429998d4a48a3f7e74761046352c16712208bd983\n81a2c4c708c13338ed7aac439aa876c5e1d2116afb23e7cf8a345a05ebd55eed\n3974b0985d524dd38a9d040c9eaf880c421411210e0bdd577ac2306f6471a413\nab54b89a75ee9d858b734e927ff16aef3d5c8137552c9973864d7eed8aa5e472\n9f6881386d0ff9a0cd2bc49da21b999d13e4ebdc858bdad755ee26898c567a3d\n6c2d6abc2e130092f414d4f64adeb22dac56e8f802d4250c84db62a563bf99ec\n5eb54a536d9b560b79c7113efa5eebcbe21e9aede3f751d14a98b38c829a53b5\ne67ec7af646f6b9bdfe59e3549f84bd3071c72386de57e9a9a5fe58982dbdd49\n6a9b222b7be97ed608bcbef6dc05cff9fb16ae9a31a08e719857cad6146dc8d7\n1b052c6d721f4dc36b3e58192ac6c664d43aec8f15fcd2a8f91616f705192ebb\n2a1dd210ed71e33e58aadd9157eebb35ad38eb70cb182d244a8f9879f195b930\n6b19c0ec581ca24ef2a35d37af523ab2af19740585ad653d98593a057268e01c\nd01defb4fe8db26ea0151afa1c4e817db1aba1c8464127110f7ef860164ed79a\nb9440e407b971def1d8a3d19c2da0e81145aad4b29e51602fc11f566e9854537\n1d62fec40f14dd0458556f0211529df88d19fe0249d195d6153388610c5525df\n879b1f79cbd105ff52ac9a0b01cee4bef921df59e72fb7f5e41db48430ca9a85\n\n**Domain names**\no  Gootkit’s C2 server:\n\nsillikogermin[.]com\nfeferturietan[.]com\nmanjuorlidnqo[.]com\nchechelderpos[.]com\nkalamindridro[.]com\navant-garde[.]host\nkinzhal[.]online\nservicemanager[.]icu\npartnerservice[.]xyz\nLocation of web injection script\nmabanquesecure[.]com\n\n\n-----\n\n**URLs**\no  Location of Gootkit DLL\n\nsillikogermin[.]com/rbody32\n\n**C2s/IPs**\no  Gootkit delivery URL\n\nhxxp://ccleanerhome[.]com/fonts/igfpers[.]exe\nhxxp://new[.]eltrans53[.]ru/uploads/utf8[.]exe\nhxxp://startintern[.]terweij[.]nl/wp-admin/repox[.]exe\nhxxp://kbhookah[.]com/loggers/repost[.]exe\nhxxp://chermin[.]tweakdsl[.]nl/loges/Astart[.]exe\nhxxp://chermin[.]tweakdsl[.]nl/loges/aHdBhBjUhBHm[.]exe\nhxxp://chermin[.]tweakdsl[.]nl/loges/DlKitlMNdktild[.]exe\nhxxp://chermin[.]tweakdsl[.]nl/loges/Atrip[.]exe\nhxxp://chermin[.]tweakdsl[.]nl/loges/remove[.]exe\nhxxp://chermin[.]tweakdsl[.]nl/loges/zip[.]exe\nhxxp://chermin[.]tweakdsl[.]nl/loges/tlss[.]exe\nhxxp://camdunki[.]com/gx/wipip[.]exe\nhxxp://camdunki[.]com/gx/Aleto[.]exe\nhxxp://hairpd[.]com/stat/sputik[.]exe\n\n**Persistence**\no  .INI file\n   -  e.g., C:\\Users\\USERNAME\\Desktop\\igfpers.inf\no  Registry Key\n   -  HKCU\\Software\\Microsott\\IEAK\\GroupPolicy\\PendingGPOs\no  Registry Value / Data\n    -  Path1 / Path to Gootkit loader\n_▪  Section1 / DefaultInstall (It points to a section in .inf file)_\n\n**Interesting Strings**\no  --vwxyz (An option for new process creation to download Gootkit DLL from its C2\nserver)\n\n## About Masaki Kasuya\n\nSenior Threat Researcher at BlackBerry Cylance Japan\n\n\n-----\n\n[Masaki Kasaki started his professional career as Security Engineer at a large e-commerce](https://www.linkedin.com/in/masaki-kasuya-ph-d-016084a6/)\ncompany and earned practical experience in malware analysis, penetration testing, incident\nresponse, and corporate IT security. His Ph.D. dissertation sought how to stimulate stealthy\nmalware’s behavior. While he was Ph.D. student, he received student paper award and student\npresentation award. He holds SANS GREM, GCFA, GCIH, GCIA and GMOB.\n\n## About Tatsuya Hasegawa\n\nSenior Threat Researcher at BlackBerry Cylance\n\n[Tatsuya Hasegawa is a Senior Threat Researcher in APAC at BlackBerry, and is responsible for](https://www.linkedin.com/in/tatsuya-hasegawa-aa3279142/)\nmalware analysis and sandbox technology. He has practical experience in the both managed\nsecurity service provider as a security analyst and CSIRT as an incident handler. His certifications\ninclude: GREM, GCIH, GCFA, GXPN, GPEN and CISSP.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-13 - Threat Spotlight- Gootkit Banking Trojan.pdf"
    ],
    "report_names": [
        "2020-04-13 - Threat Spotlight- Gootkit Banking Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535717,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653705008,
    "ts_modification_date": 1653705008,
    "files": {
        "pdf": "https://archive.orkl.eu/a1db67887e575ced3fb1a8b954af597fa7190909.pdf",
        "text": "https://archive.orkl.eu/a1db67887e575ced3fb1a8b954af597fa7190909.txt",
        "img": "https://archive.orkl.eu/a1db67887e575ced3fb1a8b954af597fa7190909.jpg"
    }
}