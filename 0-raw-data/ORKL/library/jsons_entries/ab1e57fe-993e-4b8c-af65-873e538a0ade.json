{
    "id": "ab1e57fe-993e-4b8c-af65-873e538a0ade",
    "created_at": "2023-01-12T15:05:23.751729Z",
    "updated_at": "2025-03-27T02:17:01.03519Z",
    "deleted_at": null,
    "sha1_hash": "c14db9bf31dfd1bafba245842b2117c52989a36c",
    "title": "2020-09-08 - Exposed Docker Server Abused to Drop Cryptominer, DDoS Bot",
    "authors": "",
    "file_creation_date": "2022-05-28T03:08:30Z",
    "file_modification_date": "2022-05-28T03:08:30Z",
    "file_size": 1264591,
    "plain_text": "# Exposed Docker Server Abused to Drop Cryptominer, DDoS Bot\n\n**[trendmicro.com/en_us/research/20/i/exposed-docker-server-abused-to-drop-cryptominer-ddos-bot-.html](https://www.trendmicro.com/en_us/research/20/i/exposed-docker-server-abused-to-drop-cryptominer-ddos-bot-.html)**\n\nCloud\n\n\nSeptember 8, 2020\n\n\nMalicious actors continue to target environments running Docker containers. We recently encountered an attack that drops\nboth a malicious cryptocurrency miner and a DDoS bot on a Docker container built using Alpine Linux as its base image.\n\nBy: Augusto Remillano II September 08, 2020 Read time: ( words)\n\n[Malicious actors continue to target environments running Docker containers. We recently encountered an attack that drops](https://www.trendmicro.com/vinfo/tmr/?/ph/security/definition/container)\n[both a malicious cryptocurrency miner and a distributed denial-of-service (DDoS) bot on a Docker container built using Alpine](https://www.trendmicro.com/vinfo/tmr/?/ph/security/definition/distributed-denial-of-service-ddos)\nLinux as its base image. A similar attack was also reported by Trend Micro in May; in that previous attack, threat actors\n[created a malicious Alpine Linux container to also host a malicious cryptocurrency miner and a DDoS bot.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/coinminer-ddos-bot-attack-docker-daemon-ports)\n\nInfection chain analysis\n\nIn this recent attack, the infection starts with threat actors connecting to an exposed Docker server and then creating and\nrunning a Docker container. On the Docker container, the command shown in Figure 1 is executed.\n\nFigure 1. A code snippet of the\n\ncommand that is executed on the Docker container\n[The XMI download file (detected by Trend Micro as Trojan.Linux.MALXMR.USNELH820) is a Bash script, shown in Figure 2,](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.Linux.MALXMR.USNELH820)\nthat moves laterally to other hosts in the same container network using information from /.ssh/known_hosts.\n\nFigure 2. A code snippet of the Bash script used in\n\nthe attack\nThe commands shown in Figure 3 download and execute the XMI Bash script and a Python script named “d.py”\n[(Trojan.Python.MALXMR.D).](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.Python.MALXMR.D)\n\nFigure 3. A code snippet of the\ncommands sent to targets\nThe XMI shell script extensively uses Base64 encoding to avoid detection. Decoding the encoded string shown in Figure 3\nyields the command shown in Figure 4, which downloads and executes d.py.\n\n\n-----\n\nFigure 4. A code snippet of the decoded command that\ndownloads and executes the component named “d.py”\nIt is also worth noting that the shell script contains commented-out code, shown in Figure 5, that seems to be used for\npropagating the malware via SSH brute-forcing. It is likely that the actors behind this attack used to target or are also targeting\nSSH servers.\n\nFigure 5. A code snippet of the commented-out\n\ncode found in the XMI Bash script\nThe attack uses multiple techniques to establish persistence. Aside from setting up cron jobs, as shown in Figure 6, it also\ncreates its own service for automatic payload execution.\n\nFigure 6. A code snippet of the attack setting\n\nup persistence using cron jobs\nThe portion that creates the service is also Base64-encoded. Its decoded form, shown in Figure 7, is placed in the the\n_/etc/init.d directory._\n\nFigure 7. A code snippet of the\n\ndecoded form of the script, which is placed in the /etc/init.d directory\nWe detect the cryptocurrency-mining payload, whose download script is shown in Figure 8, as\n[Coinminer.Linux.MALXMR.UWELD. Interestingly, the cryptocurrency wallet used by the threat actors is the same one used in](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Coinminer.Linux.MALXMR.UWELD)\n[campaigns that exploited vulnerabilities such as CVE-2019-3396, a Confluence vulnerability, and](https://www.trendmicro.com/en_us/research/19/e/cve-2019-3396-redux-confluence-vulnerability-exploited-to-deliver-cryptocurrency-miner-with-rootkit.html) [CVE-2017-5638, an Apache](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/vulnerabilities-and-exploits/critical-remote-code-execution-vulnerability-cve-2018-11776-found-in-apache-struts)\n[Struts vulnerability. According to a report by Tencent Security, the 8220 mining group, a criminal gang based in China, is](https://s.tencent.com/research/report/600.html)\nbehind the campaign that exploited CVE-2017-5638.\n\nFigure 8. A code snippet of the cryptocurrency-mining payload download\n\nTo check whether the payload has been successfully dropped, the malware uses md5sum, a program that calculates and\n[verifies 128-bit MD5 hashes. This verification method is similar to the one used by the Kinsing malware, which was used by](https://www.trendmicro.com/en_us/research/20/d/exposed-redis-instances-abused-for-remote-code-execution-cryptocurrency-mining.html)\nthe [H2Miner cryptocurrency-mining botnet that targeted cloud servers in China.](https://www.lacework.com/h2miner-botnet/)\n\n[In addition, the attack drops another payload in the form of a DDoS bot (Backdoor.Linux.KAITEN.AMV), as shown in Figure 9.](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.KAITEN.AMV)\n\n\n-----\n\nFigure 9. A code snippet of the dropper script that downloads\n\nand executes a DDoS bot\nThis DDoS bot, some of whose backdoor commands are shown in Figure 10, is based on IRC (Internet Relay Chat) and\n[appears to be a variant of Kaiten (aka Tsunami). Its command-and-control (C&C) servers are c4k[.]xpl[.]pwndns[.]pw,](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/internet-of-things/caught-in-the-crossfire-defending-devices-from-battling-botnets)\n104[.]244[.]75[.]25, and 107[.]189[.]11[.]170.\n\nFigure 10. A code snippet of strings found in the DDoS bot showing some of its\n\nbackdoor commands\nAs previously mentioned, the attack also drops d.py, the Python script that we detect as Trojan.Python.MALXMR.D. We found\nthat it performs the same routine as Trojan.Linux.MALXMR.USNELH820, that is, it establishes persistence and drops\ncryptocurrency miner and DDoS bot payloads. A code snippet of d.py is shown in Figure 11.\n\nFigure 11. A code snippet of the d.py Python\n\nscript\nThe infection chain of the attack is illustrated in Figure 12.\n\n\n-----\n\nFigure 12. A diagram of the infection chain of the attack\nSecurity recommendations\n\nAs Docker containers become increasingly targeted by malicious actors, development teams should adopt a risk-based\nsecurity approach to reduce containers’ exposure to threats. They can start by not leaving their Docker daemon ports\nexposed online. They should also use only official Docker images to ward off threats such as the ones discussed in this post.\nThe following best practices could further mitigate risks to their containers:\n\nDeploy an application firewall to help secure containers and catch threats before they can enter the environment.\n\nMinimize the use of third-party software and use verifiable software to ensure malware is not introduced to the container\nenvironment.\nImplement the principle of least privilege. Container images should be signed and authenticated. Network connections\n[and access to critical components (such as the daemon service that helps run containers) should be restricted.](https://success.docker.com/article/how-do-i-enable-the-remote-api-for-dockerd)\n[Employ automated runtime and image scanning to gain further visibility into a container’s processes. Application control](https://www.trendmicro.com/en_us/business/capabilities/application-control-capability.html)\n[and integrity monitoring help catch anomalous modifications on servers, files, and system areas.](https://www.trendmicro.com/en_us/business/capabilities/integrity-monitoring.html)\n\nEnterprises can also rely on the following cloud security solutions to protect their Docker containers:\n\n[Trend Micro Hybrid Cloud Security: Provides automated security and protects physical, virtual, and cloud workloads](https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html)\n[Trend Micro Cloud One™ – Container Security: Performs automated container image and registry scanning](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-container-image-security.html)\n[Trend Micro Deep Security™ Software and](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html) [Trend Micro Deep Security Smart Check – Container Image Scanning: Scan](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/smart-check-image-scanning.html)\ncontainer images to detect malware and vulnerabilities earlier in the development life cycle\n\n_With additional analysis from Arianne Grace Dela Cruz._\n\nIndicators of compromise (IOCs)\n\n\n-----\n\n**File**\n**name**\n\n\n**SHA-256** **Detection name**\n\n\nd.py 29316f604f3c0994e8733ea43da8e0e81a559160f5c502fecbb15a71491faf64 [Trojan.Python.MALXMR.D](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.Python.MALXMR.D)\n\ni686 35e45d556443c8bf4498d8968ab2a79e751fc2d359bf9f6b4dfd86d417f17cfb [Coinminer.Linux.MALXMR.UWELD](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Coinminer.Linux.MALXMR.UWELD)\n\nx32b 9b8280f5ce25f1db676db6e79c60c07e61996b2b68efa6d53e017f34cbf9a872 [Backdoor.Linux.KAITEN.AMV](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.KAITEN.AMV)\n\nx64b 855557e415b485cedb9dc2c6f96d524143108aff2f84497528a8fcddf2dc86a2 [Backdoor.Linux.KAITEN.AMV](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.KAITEN.AMV)\n\nx86_64 fdc7920b09290b8dedc84c82883b7a1105c2fbad75e42aea4dc165de8e1796e3 [Coinminer.Linux.MALXMR.UWELD](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Coinminer.Linux.MALXMR.UWELD)\n\nxmi 51654c52e574fd4ebda83c107bedeb0965d34581d4fc095bbb063ecefef08221 [Trojan.Linux.MALXMR.USNELH820](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.Linux.MALXMR.USNELH820)\n\n**URL**\n\n205[.]185[.]113[.]151\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-08 - Exposed Docker Server Abused to Drop Cryptominer, DDoS Bot.pdf"
    ],
    "report_names": [
        "2020-09-08 - Exposed Docker Server Abused to Drop Cryptominer, DDoS Bot.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0b8ea9bb-b729-438a-ae1f-4240db936fd7",
            "created_at": "2023-06-23T02:04:34.839947Z",
            "updated_at": "2025-03-27T02:02:10.230259Z",
            "deleted_at": null,
            "main_name": "8220 Gang",
            "aliases": [
                "8220 Mining Group",
                "Returned Libra",
                "Water Sigbin"
            ],
            "source_name": "ETDA:8220 Gang",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7618565f-b8b8-4e33-b25e-3e89fdc444dd",
            "created_at": "2023-01-06T13:46:39.434955Z",
            "updated_at": "2025-03-27T02:00:03.090357Z",
            "deleted_at": null,
            "main_name": "Returned Libra",
            "aliases": [
                "8220 Mining Group"
            ],
            "source_name": "MISPGALAXY:Returned Libra",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535923,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1653707310,
    "ts_modification_date": 1653707310,
    "files": {
        "pdf": "https://archive.orkl.eu/c14db9bf31dfd1bafba245842b2117c52989a36c.pdf",
        "text": "https://archive.orkl.eu/c14db9bf31dfd1bafba245842b2117c52989a36c.txt",
        "img": "https://archive.orkl.eu/c14db9bf31dfd1bafba245842b2117c52989a36c.jpg"
    }
}