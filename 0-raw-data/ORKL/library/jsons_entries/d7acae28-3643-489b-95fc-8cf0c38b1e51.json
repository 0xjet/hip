{
    "id": "d7acae28-3643-489b-95fc-8cf0c38b1e51",
    "created_at": "2023-01-12T15:06:45.233442Z",
    "updated_at": "2025-03-27T02:08:36.160132Z",
    "deleted_at": null,
    "sha1_hash": "c5ff474b626e3977f195c37715c5660ebf40e843",
    "title": "2020-03-31 - Holy water- ongoing targeted water-holing attack in Asia",
    "authors": "",
    "file_creation_date": "2022-05-28T04:50:03Z",
    "file_modification_date": "2022-05-28T04:50:03Z",
    "file_size": 1175270,
    "plain_text": "# Holy water: ongoing targeted water-holing attack in Asia\n\n**[securelist.com/holy-water-ongoing-targeted-water-holing-attack-in-asia/96311/](https://securelist.com/holy-water-ongoing-targeted-water-holing-attack-in-asia/96311/)**\n\nAuthors\n\n[Ivan Kwiatkowski](https://securelist.com/author/ivankwiatkowski/)\n\nFélix Aime\n\n[Pierre Delcher](https://securelist.com/author/pierredelcher/)\n\nOn December 4, 2019, we discovered watering hole websites that were compromised to\nselectively trigger a drive-by download attack with fake Adobe Flash update warnings. This\ncampaign has been active since at least May 2019, and targets an Asian religious and ethnic\ngroup.\n\nThe threat actor’s unsophisticated but creative toolset has been evolving a lot since the\ninception date, may still be in development, and leverages Sojson obfuscation, NSIS\ninstaller, Python, open-source code, GitHub distribution, Go language, as well as Google\nDrive-based C2 channels.\n\nThe threat actor’s operational target is not clear because, unfortunately, we haven’t been\nable to observe many live operations, and we couldn’t identify any overlap with known\nintrusion sets.\n\n\n-----\n\n## Thou shalt update plugins: attack synopsis\n\nThe watering holes have been set-up on websites that belong to personalities, public bodies,\ncharities and organizations of the targeted group. At the time of writing, some of these\nwebsites (all hosted on the same server) are still compromised, and continue to direct\nselected visitors to malicious payloads:\n\nDomain Description\n\n*****corps.org Voluntary service program\n\n*****ct.org Religious personality’s charity\n\n*****policy.net Policy institute\n\n*****che.com Religious personality\n\n*****parliament.org Public body\n\n*****ialwork.org Charity\n\n*****nature.net Environmental conservation network\n\n*****airtrade.com Fair trade organization\n\nUpon visiting one of the watering hole websites, a previously compromised but legitimately\nembedded resource will load a malicious JavaScript. It’s hosted by one of the water-holed\nwebsites, and gathers information on the visitor. An external server (see Fig. 1) then\nascertains whether the visitor is a target.\n\n_Fig. 1. Target validation service request._\n\nIf the visitor is validated as a target, the first JavaScript stage will load a second one, which\nin turn will trigger the drive-by download attack, showing a fake update pop-up (see Fig. 2).\n\n\n-----\n\n_Fig. 2. Warning generated by the second payload._\n\nThe visitor is then expected to fall into the update trap, and download a malicious installer\npackage that will set up a backdoor.\n\n## For nothing is hidden that will not come to light: technical analysis\n\n### 1st JavaScript stage\n\nThe first JavaScript stage is named (script|jquery)-css.js, and is obfuscated with the Chineselanguage web service Sojson, version 4 (see Fig. 3).\n\n_Fig. 3. Sojson v4 JavaScript obfuscated one-liner._\n\nThe payload leverages the RTCPeerConnection API and ipify service to fingerprint visitors.\nThe gathered data is sent to loginwebmailnic.dynssl[.]com through HTTP GET requests, in\norder to validate the visitor as a target:\n```\nhttps://loginwebmailnic.dynssl[.]com/all/content.php?\njsoncallback=&lanip=&wanip=&urlpath=&_=\n\n```\n\n-----\n\nThe JSON-formatted response, whose only key is result, can either be t or f (true or\nfalse). If the value is “f”, then nothing happens, while “t” will trigger the second JavaScript\nstage (see Fig. 4).\n\n_Fig. 4. First stage deobfuscated validation logic._\n\nIn a previous version of this first JavaScript script, an additional JavaScript payload was\nunconditionally loaded during the first stage, and proceeded with another branch of visitor\nvalidation and the second stage.\n\nThis other branch loaded scripts from root20system20macosxdriver.serveusers[.]com, and\nleveraged https://loginwebmailnic.dynssl[.]com/part/mac/contentmc.php URL to validate\ntargets. The host and validation page names suggest this other branch may have been\nspecifically targeting MacOS users, but we were unable to confirm this hypothesis.\n\n### 2nd JavaScript stage\n\nThe second JavaScript stage is named (script|jquery)-file.js, and is obfuscated with Sojson\nversion 5 (see Fig. 5).\n\n_Fig. 5. Nerve-breaking one-line obfuscation._\n\nThe payload leverages jquery.fileDownload to show a modal pop-up to the target. It offers\nvisitors an update to Flash Player. No technical vulnerabilities are exploited: the threat actor\nrelies on the target’s willingness to keep their system up to date. The deobfuscated\nJavaScript payload (see Fig. 6) reveals that the malicious update is hosted on GitHub.\n\n\n-----\n\n_Fig. 6. Malicious update source in second JavaScript payload._\n\n## GitHub FlashUpdate repository\n\nThe pop-up links to a PE executable hosted on github[.]com/AdobeFlash32/FlashUpdate.\nGitHub disabled this repository on February 14 after we reported it to them. However, the\nrepository has been online for more than nine months, and thanks to GitHub’s commit history\n(see Fig. 7), we gained a unique insight into the attacker’s activity and tools.\n\n_Fig. 7. GitHub’s AdobeFlash32 commit history._\n\nFour executables were hosted in AdobeFlash32/FlashUpdate on the last day it was still\navailable:\n\nAn installer package, embedding a decoy legitimate Flash update and a stager.\nGodlike12, a Go backdoor that implements a Google Drive based C2 channel.\n\n\n-----\n\n[Two versions of the open-source Stitch Python backdoor that the threat actor modified](https://github.com/nathanlopez/Stitch)\nto add functionalities (persistence, auto-update, decoy download and execution).\n\nDigging into the repository for older commits, we also discovered a previous fake update\ntoolset: a C installer bundling the legitimate Flash installer and a vanilla Stitch backdoor, as\nwell as a C++ infostealer that collects information about host computers (OS version, IP\naddress, hostname) and sends them over HTTP/S.\n\n## Malicious update toolset\n\n### Installer package\n\n**MD5** 9A819F2CE060058745FF5374221ADA7C\n\n\n**Compilation**\n**date**\n\n\n2017-Jul-24 06:35:22\n\n\n**File type** PE32 executable (GUI) Intel 80386, for MS Windows, Nullsoft Installer\nself-extracting archive\n\n**File size** 4420 KB\n\n**File names** flashplayer32ppi_xa_install.exe\n\n[This malicious update package is a NSIS installer version 3 that will drop and execute two](https://nsis.sourceforge.io/Main_Page)\nother binaries:\n\nFlashUpdate.exe, D59B35489CB88619415D175953CA5400, a legitimate Windows\nFlash Player installer from January 15 that is used as a decoy to trick the user into\nbelieving they actually set up a Flash update. As modern Adobe Flash installers ‘phone\nhome’ to check for their own validity, this one will fail nowadays with a message stating\nthat the installer is outdated or renamed, and will direct the user to the Adobe website.\nIntelsyc.exe, the malicious payload (described below).\n\nThe installer is detected by Kaspersky endpoint protection heuristics as\nHEUR:Trojan.Win32.Tasker.gen.\n\n### Intelsyc Go stager\n\n**MD5** 6DC5F8282DF76F4045F75FEA3277DF41\n\n\n**Compilation**\n**date**\n\n\n1970-Jan-01 00:00:00\n\n\n-----\n\n**File type** PE32 executable (GUI) Intel 80386 (stripped to external PDB), for MS\nWindows\n\n**File size** 5976 KB\n\n**File names** flashplayer32ppi_xa_install.exe\n\n**C2 server** adobeflash31_install.ddns[.]info\n\n**User Agent** Go-http-client/1.1\n\nThe Go programmed Intelsyc implant is aimed at staging itself, downloading the Godlike12\nbackdoor (described below), and setting up persistence.\n\nIt will first retrieve /flash/sys.txt with HTTP GET on adobeflash31_install.ddns[.]info. The file\ncontents may be used as a killswitch to stop any further deployment. If the content is “1”\nthough, the implant will:\n\ncopy itself to C:/ProgramData/Intel/Intelsyc.exe;\n[establish persistence through schtasks [T1053] with a logon task named Intelsyc, run](https://attack.mitre.org/techniques/T1053/)\nas system, and pointing to a previously created self copy;\ndownload Godlike12 from github[.]com/AdobeFlash32/FlashUpdate, as\nC:\\ProgramData\\Adobe\\flashdriver.exe;\n[establish Godlike12 persistence through a registry run key [T1060] named flashdriver](https://attack.mitre.org/techniques/T1060/)\nin HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run, and pointing to a\npreviously downloaded backdoor.\n\nThe stager is detected by Kaspersky endpoint protection heuristics as\n[UDS:DangerousObject.Multi.Generic, and may be misidentified as the GoRansom Go](https://github.com/32Bites/FunMal/tree/master/GoRansom)\nransomware proof of concept by other endpoint protection products.\n\nSource files paths in the code suggest this backdoor may have been developed on a\nWindows system.\n\n### Godlike12 Go backdoor\n\n**MD5** BEC4482890A89F0184B463C727709D53\n\n\n**Compilation**\n**date**\n\n\n1970-Jan-01 00:00:00\n\n\n**File type** PE32 executable (GUI) Intel 80386 (stripped to external PDB), for MS\nWindows\n\n**File size** 4436 KB\n\n\n-----\n\n**File names** flashdriver.exe\n\n**C2 server** Google Drive\n\nThis implant is written in Go language, and its C2 channel relies on file exchanges with a\nGoogle Drive space, through Google Drive’s HTTPS API v3. The implant probably leverages\nthe gdrive [Go source from GitHub, as it shares several identical code source paths with it.](https://github.com/gdrive-org/gdrive)\n\nGodlike12 is the name the threat actor gave to the Google Drive space connections from this\nimplant. Source file paths in the code suggest this backdoor may have been developed on a\nGNU/Linux system. The not-so-common (less than 100 results in a popular search engine)\n/root/gowork GOPATH that some of this backdoor’s modules have been compiled from\nseems popular in Chinese-speaking communities, and may originate from a Chinese[authored tutorial on Go language.](https://github.com/NanXiao/golang-101-hacks/blob/master/posts/create-go-workspace.md)\n\nGodlike12 first proceeds with host fingerprinting upon startup (hostname, IP address, MAC\naddress, Windows version, current time). The result is encrypted, base64-encoded, stored in\na text file at %TEMP%/[ID]-lk.txt, and uploaded to the remote Google Drive. The implant then\nregularly checks for a remote [ID]-cs.txt, that contains encrypted commands to execute, and\nstores encrypted command results in %TEMP%/[ID]-rf.txt to later upload them to the same\nGoogle Drive space. ID is the MD5 hash of the base64-encoded MAC address of the first\nconnected network adapter, while TripleDES in ECB mode is used as an encryption\nalgorithm. It is worth mentioning that once again, the encryption function seems to have been\n[inspired from existing open-source code, which mainly appears popular in Chinese-language](https://github.com/sugeladi/goWeb/blob/master/myGo/des3/des3.go)\nforums.\n\nGodlike12 does not implement a persistence mechanism, as it is provided by the previous\ninstaller package. It is detected by Kaspersky endpoint protection heuristics as\nHEUR:Trojan.Win32.Generic.\n\nWith this implant being a month old at the time of writing (while being in use since at least\nOctober 2019), and other malicious update implants having been used before, it is possible\nthat Godlike12-based operations were still a work in progress when we investigated them.\n\n### Modified Stitch Python backdoor\n\n**MD5** EC993FF561CBC175953502452BFA554A\n\n**Compilation date** 2008-Nov-10 09:40:35\n\n**File type** PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n**File size** 7259 KB\n\n\n-----\n\n**File names** flashplayer32_xa_pp_install.exe\n\nflashplayer32pp_xa_install.exe\n\n**C2 server** system0_update04driver_roots.dynamic-dns[.]net:443\n\nThis implant is a modified version of the open-source Python backdoor called Stitch, packed\n[as a standalone PE executable with Py2exe.](https://pypi.org/project/py2exe/)\n\nThreat actors wrapped Stitch with custom Python code to perform additional operations:\n\nIt downloads a legitimate Adobe Flash installation program from the C2 server at\nstartup;\nIt auto-updates the backdoor from ubntrooters.serveuser[.]com at startup;\n[It ensures persistence through schtasks [T1053] with a logon task named](https://attack.mitre.org/techniques/T1053/)\nAdobeUpdater pointing to C:\\ProgramData\\package\\AdobeService.exe.\n\nUnder the hood, Stitch is a remote shell program that provides classic backdoor\nfunctionalities by establishing a direct socket connection, to exchange AES-encrypted data\nwith the remote server.\n\n## Conclusion\n\nWith almost 10 compromised websites and dozens of implanted hosts (that we know of), the\nattackers have set up a sizable yet very targeted water-holing attack. The toolset that’s being\nused seems low-budget and not fully developed, but has been modified several times in a\nfew months to leverage interesting features like Google Drive C2, and would be\ncharacteristic of a small, agile team.\n\nWe were unable to observe any live operations, but some tracks indicate that the Godlike12\nbackdoor is not widespread, and is probably used to conduct reconnaissance and dataexfiltration operations.\n\nWe were unable to correlate these attacks to any known APT groups.\n\nFor more details and the latest information on this threat actor, please contact\nintelreports@kaspersky.com\n\n## Appendix – IOCs\n\n### Infrastructure\n\nDomain IP address Description\n\n\n-----\n\nroot20system20macosxdriver.serveusers[.]com 45.32.154[.]111 Watering hole\ntargets validator\nserver\n\nloginwebmailnic.dynssl[.]com 207.148.117[.]159 Watering hole\ntargets validator\nserver\n\nubntrooters.serveuser[.]com 45.76.43[.]153 Stitch auto-update\nserver\n\n\nsystem0_update04driver_roots.dynamicdns[.]net\n\n\n95.179.171[.]173 Stitch C2\n\n\nsys_andriod20_designer.dynamic-dns[.]net 45.63.114[.]152 Stitch C2\n\nadobeflash31_install.ddns[.]info 95.179.171[.]173 Installer package C2\n\nairjaldinet[.]ml 108.61.178[.]125 Older C++ validator\nC2\n\n### URLs\n\nhttps://loginwebmailnic.dynssl[.]com/part/mac/contentmc.php\n\nhttps://loginwebmailnic.dynssl[.]com/all/content.php\n\nhttps://loginwebmailnic.dynssl[.]com/lh/content.php\n\nhttps://root20system20macosxdriver.serveusers[.]com/yW6jOyQM16rj.html\n\nhttps://root20system20macosxdriver.serveusers[.]com/itV6E1uKYiOo.html\n\nhttp://ubntrooters.serveuser[.]com/wuservice.exe\n\nhttp://ubntrooters.serveuser[.]com/upgrade.exe\n\nhttp://ubntrooters.serveuser[.]com/flashplayer_update.exe\n\nhttp://adobeflash31_install.ddns[.]info/flash/sys.txt\n\nhttps://github[.]com/AdobeFlash32/FlashUpdate/\n\nhttps://airjaldinet[.]ml/\n\n### Hashes (MD5)\n\n0C6025A2C68E1C702A3022F1A6AE9169\n\n1076A0EE924F198A7BD58A2DE1F060A0\n\n10B4D3A667E06DC4B06AA542173D052C\n\n11294E27491B496E36CA7DB9F363ADCD\n\n11A16E109DBAF2FD080D8490328DE5A1\n\n2E1862BC23085402EE11C88E540533C0\n\n3989AC9EFB6A725918BD1810765D30B3\n\n481DD1A37C86FDA68BCED0ECB2F47597\n\n5287045D15FF60618F426AFC03BBB331\n\n\n-----\n\n53CB974CAF909EEDCD86D2F80E75AD0A\n5F19BB1688CA836B9207248F9096B9D2\n6DF39D2CE9FCA27B78CC5CA0BED89703\n7EB0C103AE21189AD9AD4A9804293B22\n8623FA35226AC92CF6F02447AC80AFB0\n9E69DDE252038B4A38EF0BFF6CE7FCD7\nAD7A4333BC364DF3D4FA00B13CBBBEB4\nB02ABA86409BE2AB263B1A476C1A1417\nB21AF331B1752A70360B5D8DC9013F3F\nB21BD93F15916A9A4AC76350D8FDBE10\nBE3E563E95DEDCA0CEC9792194FFF2AC\nDE2D8AF2EFED0C145690B2F13CD063B3\nEC993FF561CBC175953502452BFA554A\nED081A869D30BB90B76552C83BD784C8\nBEC4482890A89F0184B463C727709D53\n9A819F2CE060058745FF5374221ADA7C\n6DC5F8282DF76F4045F75FEA3277DF41\n\n[Adobe Flash](https://securelist.com/tag/adobe-flash/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Drive-by attack](https://securelist.com/tag/drive-by-attack/)\n[JavaScript](https://securelist.com/tag/javascript/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Watering hole attacks](https://securelist.com/tag/watering-hole-attacks/)\n[Website Hacks](https://securelist.com/tag/website-hacks/)\n\nAuthors\n\n[Ivan Kwiatkowski](https://securelist.com/author/ivankwiatkowski/)\n\nFélix Aime\n\n[Pierre Delcher](https://securelist.com/author/pierredelcher/)\n\nHoly water: ongoing targeted water-holing attack in Asia\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-31 - Holy water- ongoing targeted water-holing attack in Asia.pdf"
    ],
    "report_names": [
        "2020-03-31 - Holy water- ongoing targeted water-holing attack in Asia.pdf"
    ],
    "threat_actors": [
        {
            "id": "d96046d6-5a50-4bd3-b3c4-764c78c59db1",
            "created_at": "2022-10-25T16:07:23.230935Z",
            "updated_at": "2025-03-27T02:02:09.698123Z",
            "deleted_at": null,
            "main_name": "HolyWater",
            "aliases": [],
            "source_name": "ETDA:HolyWater",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536005,
    "ts_updated_at": 1743041316,
    "ts_creation_date": 1653713403,
    "ts_modification_date": 1653713403,
    "files": {
        "pdf": "https://archive.orkl.eu/c5ff474b626e3977f195c37715c5660ebf40e843.pdf",
        "text": "https://archive.orkl.eu/c5ff474b626e3977f195c37715c5660ebf40e843.txt",
        "img": "https://archive.orkl.eu/c5ff474b626e3977f195c37715c5660ebf40e843.jpg"
    }
}