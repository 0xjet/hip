{
    "id": "2fdda97d-db23-4c66-a34b-b0647f287a55",
    "created_at": "2023-01-12T15:06:49.160355Z",
    "updated_at": "2025-03-27T02:16:50.920828Z",
    "deleted_at": null,
    "sha1_hash": "325237af74ab96ac14a4c7abc37d9458991737ba",
    "title": "2019-07-18 - Okrum- Ke3chang group targets diplomatic missions",
    "authors": "",
    "file_creation_date": "2022-05-28T02:46:06Z",
    "file_modification_date": "2022-05-28T02:46:06Z",
    "file_size": 1001596,
    "plain_text": "# Okrum: Ke3chang group targets diplomatic missions\n\n**[welivesecurity.com/2019/07/18/okrum-ke3chang-targets-diplomatic-missions/](https://www.welivesecurity.com/2019/07/18/okrum-ke3chang-targets-diplomatic-missions/)**\n\nJuly 18, 2019\n\nTracking the malicious activities of the elusive Ke3chang APT group, ESET researchers\nhave discovered new versions of malware families linked to the group, and a previously\nunreported backdoor\n\n[Zuzana Hromcová](https://www.welivesecurity.com/author/zhromcova/)\n18 Jul 2019 - 11:30AM\n\nTracking the malicious activities of the elusive Ke3chang APT group, ESET researchers\nhave discovered new versions of malware families linked to the group, and a previously\nunreported backdoor\n\n\n-----\n\nIn this blogpost, we will sum up the findings published in full in our white paper Okrum and\nKetrican: An overview of recent Ke3chang group activity”.\n\nThe Ke3chang group, also known as APT15, is a threat group believed to be operating out\nof China. Its activities were traced back to 2010 in FireEye’s 2013 report on operation\nKe3chang – a cyberespionage campaign directed at diplomatic organizations in Europe.\n\nWe have been tracking the malicious activities related to this threat actor and discovered\na previously undocumented malware family with strong links to the Ke3chang group – a\nbackdoor we named Okrum. According to ESET telemetry, Okrum was first detected in\nDecember 2016, and targeted diplomatic missions in Slovakia, Belgium, Chile, Guatemala\nand Brazil throughout 2017.\n\nFurthermore, from 2015 to 2019, we detected new versions of known malware families\nattributed to the Ke3chang group – BS2005 backdoors from operation Ke3chang and the\n[RoyalDNS malware, reported by NCC Group in 2018.](https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/)\n\n_Note: New versions of operation Ke3chang malware from 2015-2019 are detected by ESET_\n_systems as Win32/Ketrican and collectively referred to as Ketrican backdoors/samples,_\n_marked with the relevant year, across our white paper and this blogpost._\n\n[Okrum and Ketrican: An overview of recent Ke3chang group activity](https://www.welivesecurity.com/wp-content/uploads/2019/07/ESET_Okrum_and_Ketrican.pdf)\n\n[Download Research Paper](https://www.welivesecurity.com/wp-content/uploads/2019/07/ESET_Okrum_and_Ketrican.pdf)\n\n## Investigation timeline\n\n### 2015: Ketrican\n\nIn 2015, we identified new suspicious activities in European countries. The group behind\nthe attacks seemed to have a particular interest in Slovakia, where a big portion of the\ndiscovered malware samples was detected; Croatia, the Czech Republic and other\ncountries were also affected.\n\nOur technical analysis of the malware used in these attacks showed close ties to BS2005\nbackdoors from [operation Ke3chang, and to a related TidePool malware family discovered](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-operation-ke3chang.pdf)\nby Palo Alto Networks in 2016 that targeted Indian embassies across the globe.\n\n### 2016-2017: Okrum\n\n\n-----\n\nThe story continued in late 2016, when we discovered a new, previously unknown backdoor\nthat we named Okrum. The malicious actors behind the Okrum malware were focused on\nthe same targets in Slovakia that were previously targeted by Ketrican 2015 backdoors.\n\n### 2017: Ketrican and RoyalDNS\n\nWe started connecting the dots when we discovered that the Okrum backdoor was used to\ndrop a Ketrican backdoor, freshly compiled in 2017.\n\nIn 2017, the same entities that were affected by the Okrum malware (and by the 2015\nKetrican backdoors) again became targets of the malicious actors. This time, the attackers\nused new versions of the RoyalDNS malware and a Ketrican 2017 backdoor.\n\n### 2018: Ketrican\n\nIn 2018, we discovered a new version of the Ketrican backdoor that featured some code\nimprovements.\n\n### 2019: Ketrican\n\nThe group continues to be active in 2019 – in March 2019, we detected a new Ketrican\nsample that has evolved from the 2018 Ketrican backdoor. It attacked the same targets as\nthe backdoor from 2018.\n\nThis timeline of events shows that the attackers were focused on the same type of targets\nbut were using different malicious toolsets to compromise them. In the process, they\nexposed Okrum, a formerly unknown project. Figure 1 shows ESET detections related to\nour investigation in the context of previously documented Ke3chang activity.\n\n\n-----\n\n_Figure 1. Timeline of previously documented Ke3chang group activity and ESET detections related_\n\n_to our investigation_\n\n## Links to Ke3chang group\n\nOur research has shown that the Ketrican, Okrum, and RoyalDNS backdoors detected by\nESET after 2015 are linked to previously documented Ke3chang group activity, and to each\nother, in a number of ways. These are the most important connections:\n\nKetrican backdoors from 2015, 2017, 2018 and 2019 have all evolved from malware\nused in Operation Ke3chang\nThe RoyalDNS backdoor detected by ESET in 2017 is similar to the RoyalDNS\nbackdoor used in previously reported attacks\nOkrum is linked to Ketrican backdoors in that it was used to drop a Ketrican backdoor\ncompiled in 2017\nOkrum, Ketrican and RoyalDNS target the same type of organizations; some of the\nentities affected by Okrum were also targeted with one or more of Ketrican/RoyalDNS\nbackdoors\nOkrum has a similar modus operandi as previously documented Ke3chang malware –\nit is equipped with a basic set of backdoor commands and relies on manually typing\nshell commands and executing external tools for most of its malicious activity\n\n## Okrum\n\n Distribution and targets\n\nAccording to our telemetry, Okrum was used to target diplomatic missions in Slovakia,\nBelgium, Chile, Guatemala, and Brazil, with the attackers showing a particular interest in\nSlovakia.\n\nThe operators of the malware tried to hide malicious traffic with its C&C server within\nregular network traffic by registering seemingly legitimate domain names. For example, the\nsamples used against Slovak targets communicated with a domain name mimicking a\nSlovak map portal (support.slovakmaps[.]com). A similar masquerade was used in a\nsample detected in a Spanish speaking country in South America – the operators used a\ndomain name that translates as “missions support” in Spanish\n(misiones.soportesisco[.]com).\n\nHow the Okrum malware was distributed to the targeted machines is a question that\nremains to be answered.\n\n## Technical details\n\n\n-----\n\nThe Okrum backdoor is a dynamic-link library that is installed and loaded by two earlierstage components. During our investigation, the implementation of these two components\nwas being changed frequently. Every few months, the authors actively changed\nimplementation of the Okrum loader and installer components to avoid detection. By the\ntime of publication, ESET systems have detected seven different versions of the loader\ncomponent and two versions of the installer, although the functionality remained the same.\n\nThe payload of Okrum is hidden in a PNG file. When the file is viewed in an image viewer, a\nfamiliar image is displayed, as seen in Figure 2, but the Okrum loaders are able to locate an\nextra encrypted file that the user cannot see. This steganography technique is an attempt\nby the malicious actors to stay unnoticed and evade detection.\n\n_Figure 2. An innocuous-looking PNG image with an encrypted malicious DLL embedded inside_\n\nAs for functionality, Okrum is only equipped with basic backdoor commands, such as\ndownloading and uploading files, executing files and shell commands. Most of the malicious\nactivity has to be performed by typing shell commands manually, or by executing other tools\nand software. This is a common practice of the Ke3chang group, which had also been\n[pointed out previously in the Intezer and](https://www.intezer.com/miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones/) [NCC Group reports monitoring Ke3chang group](https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/)\nactivity.\n\nIndeed, we have detected various external tools being abused by Okrum, such as a\nkeylogger, tools for dumping passwords, or enumerating network sessions. The Ketrican\nbackdoors we detected from 2015 to 2019 used similar utilities. We can only guess why the\nKe3chang actor uses this technique – maybe the combination of a simple backdoor and\nexternal tools fully accommodates their needs, while being easier to develop; but it may\nalso be an attempt to evade behavioral detection.\n\nThe detection evasion techniques we observed in the Okrum malware include embedding\nthe malicious payload within a legitimate PNG image, employing several anti-emulation and\nanti-sandbox tricks, as well as making frequent changes in implementation.\n\n## Conclusion\n\n\n-----\n\nOur analysis of the links between previously documented Ke3chang malware and the newly\ndiscovered Okrum backdoor lets us claim with high confidence that Okrum is operated by\nthe Ke3chang group. Having documented Ke3chang group activity from 2015 to 2019, we\nconclude that the group continues to be active and works on improving its code over time.\n\nESET detection names and other Indicators of Compromise for these campaigns can be\nfound in the full white paper: “Okrum and Ketrican: An overview of recent Ke3chang group\nactivity”.\n\n## MITRE ATT&CK techniques\n\n**Tactic** **ID** **Name** **Description**\n\n\nExecution [T1059](https://attack.mitre.org/techniques/T1059/) Command-Line\nInterface\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting The backdoor uses\nbatch scripts to\nupdate itself to a\nnewer version.\n\n[T1035](https://attack.mitre.org/techniques/T1035/) Service Execution The Stage 1 loader\ncreates a new\nservice named\nNtmsSvc to execute\nthe payload.\n\n\nOkrum’s backdoor uses\ncmd.exe to execute\narbitrary commands.\n\n\nPersistence [T1050](https://attack.mitre.org/techniques/T1050/) New Service To establish persistence,\nOkrum installs itself as a\nnew service named\nNtmSsvc.\n\n\n[T1060](https://attack.mitre.org/techniques/T1060/) Registry Run Keys /\nStartup Folder\n\n\nOkrum establishes\npersistence by\ncreating a .lnk\nshortcut to itself in\nthe Startup folder.\n\n\n[T1053](https://attack.mitre.org/techniques/T1053/) Scheduled Task The installer\ncomponent tries to\nachieve persistence\nby creating a\nscheduled task.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1023](https://attack.mitre.org/techniques/T1023/) Shortcut Modification Okrum establishes\npersistence by\ncreating a .lnk\nshortcut to itself in\nthe Startup folder.\n\n\nPrivilege\nEscalation\n\nDefense\nEvasion\n\n\n[T1134](https://attack.mitre.org/techniques/T1134/) Access Token\nManipulation\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode\nFiles or Information\n\n\nOkrum can impersonate a\nlogged on user's security\ncontext using a call to the\nImpersonateLoggedOnUser\nAPI.\n\nThe Stage 1 loader\ndecrypts the backdoor\ncode, embedded within the\nloader or within a legitimate\nPNG file. A custom XOR\ncipher or RC4 is used for\ndecryption.\n\n\n[T1107](https://attack.mitre.org/techniques/T1107/) File Deletion Okrum’s backdoor\ndeletes files after\nthey have been\nsuccessfully\nuploaded to C&C\nservers.\n\n\n[T1158](https://attack.mitre.org/techniques/T1158/) Hidden Files and\nDirectories\n\n[T1066](https://attack.mitre.org/techniques/T1066/) Indicator Removal\nfrom Tools\n\n\nBefore exfiltration,\nOkrum’s backdoor\nuses hidden files to\nstore logs and\noutputs from\nbackdoor\ncommands.\n\nOkrum underwent\nregular technical\nimprovements to\nevade antivirus\ndetection.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Masquerading Okrum establishes\npersistence by\nadding a new\nservice NtmsSvc\nwith the display\nname Removable\nStorage in an\nattempt to\nmasquerade as a\nlegitimate\nRemovable Storage\nManager.\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or\nInformation\n\n[T1497](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox\nEvasion\n\n\nOkrum's payload is\nencrypted and\nembedded within the\nStage 1 loader, or\nwithin a legitimate\nPNG file.\n\nThe Stage 1 loader\nperforms several\nchecks on the\nvictim's machine to\navoid being\nemulated or\nexecuted in a\nsandbox.\n\n\nCredential\nAccess\n\n\n[T1003](https://attack.mitre.org/techniques/T1003/) Credential Dumping Okrum was seen using\n[MimikatzLite and modified](https://github.com/infosecsmith/MimikatzLite/)\n[Quarks PwDump to](https://blog.quarkslab.com/quarks-pwdump.html)\nperform credential\ndumping.\n\n\nDiscovery [T1083](https://attack.mitre.org/techniques/T1083/) File and Directory\nDiscovery\n\n\nOkrum was seen using\n[DriveLetterView to](https://www.nirsoft.net/utils/drive_letter_view.html)\nenumerate drive\ninformation.\n\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information\nDiscovery\n\n\nOkrum collects\ncomputer name,\nlocale information,\nand information\nabout the OS and\narchitecture.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1016](https://attack.mitre.org/techniques/T1016/) System Network\nConfiguration\nDiscovery\n\n[T1049](https://attack.mitre.org/techniques/T1049/) System Network\nConnections\nDiscovery\n\n[T1033](https://attack.mitre.org/techniques/T1033/) System Owner/User\nDiscovery\n\n[T1124](https://attack.mitre.org/techniques/T1124/) System Time\nDiscovery\n\n\nOkrum collects\nnetwork information,\nincluding host IP\naddress, DNS and\nproxy information.\n\nOkrum used\n[NetSess to discover](http://www.joeware.net/freetools/tools/netsess/)\nNetBIOS sessions.\n\nOkrum collects the\nvictim user name.\n\nOkrum can obtain\nthe date and time of\nthe compromised\nsystem.\n\n\nCollection [T1056](https://attack.mitre.org/techniques/T1056/) Input Capture Okrum was seen using a\nkeylogger tool to capture\nkeystrokes.\n\nExfiltration [T1002](https://attack.mitre.org/techniques/T1002/) Data Compressed Okrum was seen using a\nRAR archiver tool to\ncompress data.\n\n[T1022](https://attack.mitre.org/techniques/T1022/) Data Encrypted Okrum uses AES\nencryption and\nbase64 encoding of\nfiles before\nexfiltration.\n\n\n[T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over\nCommand and\nControl Channel\n\n\nData exfiltration is\ndone using the\nalready opened\nchannel with the\nC&C server.\n\n\nCommand\nAnd\nControl\n\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly Used\nPort\n\n\nOkrum uses port 80 for\nC&C.\n\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Connection Proxy Okrum identifies a\nproxy server if it\nexists and uses it to\nmake HTTP\nrequests.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1132](https://attack.mitre.org/techniques/T1132/) Data Encoding The communication\nwith the C&C server\nis base64 encoded.\n\n[T1001](https://attack.mitre.org/techniques/T1001/) Data Obfuscation The communication\nwith the C&C server\nis hidden in the\nCookie and SetCookie headers of\nHTTP requests.\n\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Standard Application\nLayer Protocol\n\n[T1032](https://attack.mitre.org/techniques/T1032/) Standard\nCryptographic\nProtocol\n\n18 Jul 2019 - 11:30AM\n\n\nOkrum uses HTTP\nfor communication\nwith its C&C.\n\nOkrum uses AES to\nencrypt network\ntraffic. The key can\nbe hardcoded or\nnegotiated with the\nC&C server in the\nregistration phase.\n\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-18 - Okrum- Ke3chang group targets diplomatic missions.pdf"
    ],
    "report_names": [
        "2019-07-18 - Okrum- Ke3chang group targets diplomatic missions.pdf"
    ],
    "threat_actors": [
        {
            "id": "0a03e7f0-2f75-4153-9c4f-c46d12d3962e",
            "created_at": "2022-10-25T15:50:23.453824Z",
            "updated_at": "2025-03-27T02:00:55.473216Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "Ke3chang",
                "APT15",
                "Vixen Panda",
                "GREF",
                "Playful Dragon",
                "RoyalAPT",
                "Nylon Typhoon"
            ],
            "source_name": "MITRE:Ke3chang",
            "tools": [
                "Okrum",
                "Systeminfo",
                "netstat",
                "spwebmember",
                "Mimikatz",
                "Tasklist",
                "MirageFox",
                "Neoichor",
                "ipconfig"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d5531e2-0ad1-4237-beed-af009035576f",
            "created_at": "2024-05-01T02:03:07.977868Z",
            "updated_at": "2025-03-27T02:05:17.283109Z",
            "deleted_at": null,
            "main_name": "BRONZE PALACE",
            "aliases": [
                "BRONZE DAVENPORT ",
                "BRONZE IDLEWOOD ",
                "CTG-9246 ",
                "Ke3chang ",
                "Playful Dragon",
                "Vixen Panda ",
                "APT15 "
            ],
            "source_name": "Secureworks:BRONZE PALACE",
            "tools": [
                " BS2005",
                " Enfal",
                " Mirage",
                " RoyalCLI",
                " RoyalDNS",
                "BMW"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "17b1b76b-16da-4c4f-8b32-f6fede3eda8c",
            "created_at": "2022-10-25T16:07:23.750796Z",
            "updated_at": "2025-03-27T02:02:09.961401Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "APT 15",
                "BackdoorDiplomacy",
                "Bronze Davenport",
                "Bronze Idlewood",
                "Bronze Palace",
                "CTG-9246",
                "GREF",
                "Ke3chang",
                "Metushy",
                "Nylon Typhoon",
                "Operation Ke3chang",
                "Operation MirageFox",
                "Playful Dragon",
                "Playful Taurus",
                "Red Vulture",
                "Royal APT",
                "Social Network Team",
                "Vixen Panda"
            ],
            "source_name": "ETDA:Ke3chang",
            "tools": [
                "Agentemis",
                "Anserin",
                "BS2005",
                "BleDoor",
                "CarbonSteal",
                "Cobalt Strike",
                "CobaltStrike",
                "DarthPusher",
                "DoubleAgent",
                "EternalBlue",
                "GoldenEagle",
                "Graphican",
                "HenBox",
                "HighNoon",
                "IRAFAU",
                "Ketrican",
                "Ketrum",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MS Exchange Tool",
                "Mebroot",
                "Mimikatz",
                "MirageFox",
                "NBTscan",
                "Okrum",
                "PluginPhantom",
                "PortQry",
                "ProcDump",
                "PsList",
                "Quarian",
                "RbDoor",
                "RibDoor",
                "Royal DNS",
                "RoyalCli",
                "RoyalDNS",
                "SAMRID",
                "SMBTouch",
                "SilkBean",
                "Sinowal",
                "SpyWaller",
                "Theola",
                "TidePool",
                "Torpig",
                "Turian",
                "Winnti",
                "XSLCmd",
                "cobeacon",
                "nbtscan",
                "netcat",
                "spwebmember"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536009,
    "ts_updated_at": 1743041810,
    "ts_creation_date": 1653705966,
    "ts_modification_date": 1653705966,
    "files": {
        "pdf": "https://archive.orkl.eu/325237af74ab96ac14a4c7abc37d9458991737ba.pdf",
        "text": "https://archive.orkl.eu/325237af74ab96ac14a4c7abc37d9458991737ba.txt",
        "img": "https://archive.orkl.eu/325237af74ab96ac14a4c7abc37d9458991737ba.jpg"
    }
}