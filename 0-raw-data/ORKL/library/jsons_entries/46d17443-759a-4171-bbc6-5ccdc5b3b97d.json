{
    "id": "46d17443-759a-4171-bbc6-5ccdc5b3b97d",
    "created_at": "2023-01-12T15:04:24.396066Z",
    "updated_at": "2025-03-27T02:09:17.886047Z",
    "deleted_at": null,
    "sha1_hash": "e304d997c852c77decc91c1c919c6bfa31569838",
    "title": "2020-12-14 - Threat Advisory- SolarWinds supply chain attack",
    "authors": "",
    "file_creation_date": "2022-05-27T21:32:05Z",
    "file_modification_date": "2022-05-27T21:32:05Z",
    "file_size": 380887,
    "plain_text": "# Threat Advisory: SolarWinds supply chain attack\n\n**[blog.talosintelligence.com/2020/12/solarwinds-supplychain-coverage.html](https://blog.talosintelligence.com/2020/12/solarwinds-supplychain-coverage.html#more)**\n\n_Update 12/21: IOC section updated to include new information and associated stage._\n\n_Update 12/18: We have been able to verify the name server for the DGA domain was_\nupdated as far back as late February. Compromised binaries appear to have been available\non the SolarWinds website until very recently. The blog below has been amended with this\ninformaiton. The IOC list has been modified.\n\n\n-----\n\n_Update 12/17: Additional IOCs added related to teardrop secondary payload._\n\n_Update 12/16: Based on the announcement from FireEye, Microsoft, and GoDaddy_\navsvmcloud[.]com has been unblocked as it is now functioning as a kill switch in an effort to\nhelp limit adversaries access. Please note that this does not imply that this is a complete\nprotection from these attacks. Additional remediation steps will should and must be taken.\n[Additional details here.](https://krebsonsecurity.com/2020/12/malicious-domain-in-solarwinds-hack-turned-into-killswitch/)\n\n_Update 12/14: We note there is a discrepancy in guidance coming from DHS and_\nSolarWinds. The SolarWinds advisory suggests users upgrade to the latest version, Orion\nPlatform version 2020.2.1 HF 1, while DHS guidance says 2020.2.1 HF1 is affected.\nHowever, we note that SolarWinds announced they will be releasing another hot-fix,\n2020.2.1 HF 2, on December 15, which “replaces the compromised component and provides\nseveral additional security enhancements.” Talos urges customers to follow DHS guidance at\nthis time and install 2020.2.1 HF 2 as soon as it becomes available.\n\n[Cisco Talos is monitoring yesterday's announcements by FireEye and Microsoft that a likely](https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/)\nstate-sponsored actor compromised potentially thousands of high-value government and\n[private organizations around the world via the SolarWinds Orion product. FireEye reported](https://www.solarwinds.com/securityadvisory)\non Dec. 8 that it had been compromised in a sophisticated attack in which state-sponsored\nactors stole sensitive red team tools. Upon investigating the breach further, FireEye and\nMicrosoft discovered that the adversary gained access to victims' networks via trojanized\nupdates to SolarWinds' Orion software.\n\n## Threat activity details\n\nIn another sophisticated supply-chain attack, adversaries compromised updates to the\nSolarWinds Orion IT monitoring and management software, specifically a component called\n\"SolarWinds.Orion.Core.BusinessLayer.dll\" in versions 2019.4 HF 5 through 2020.2.1. The\ndigitally signed updates were posted on the SolarWinds website until recently. This backdoor\nis being tracked by FireEye as SUNBURST, and it can communicate to third-party servers\nusing HTTP. The backdoor is loaded by the actual SolarWinds executable before the\nlegitimate code, as not to alert the victim that anything is amiss.\n\nAfter a period of dormancy, which can last up to two weeks, the backdoor can execute\ncommands to transfer and execute files, profile the system, reboot the machine and disable\n[system services. Note that a number of SUNBURST samples have been observed along](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\nwith varying payloads, including a memory-only dropper dubbed \"Teardrop,\" which was then\n[used to deploy Cobalt Strike beacons.](https://talosintelligence.com/resources/145)\n\n\n-----\n\nThe adversaries leverage administrative privileges obtained during the on-premise\ncompromise to access the victim's global administrator account and/or trusted SAML token[signing certificate. The adversary can forge SAML tokens that impersonate any of the](https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/)\norganization's existing users and accounts, including highly privileged accounts, allowing\nthem to bypass multi-factor authentication for services such as Office365 suite. Security\nresearchers have observed that the targeted users are often key IT and security personnel.\nBecause the SAML tokens are signed with their own trusted certificate, they can be used to\nlog in to any on-premise resource or cloud environment, regardless of vendor.\n\n[The adversary also uses sophisticated techniques for communications. The backdoor](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\nidentifies its command and control (C2) server using a domain-generated algorithm (DGA) to\nconstruct and resolve a subdomain of avsvmcloud[.]com, which it can use to deliver secondstage payloads and access or exfiltrate data. Network traffic originating from the malware\nappears as legitimate Orion protocol traffic and the adversaries store information in legitimate\nplugin configuration files, all causing it to look like normal SolarWind network traffic. The\nactor sets the hostnames on their C2 infrastructure to match legitimate hostnames found\nwithin the victim's environment. The adversary mainly relied on IP addresses originating from\nthe same country as the victim — all of which are designed to evade detection.\n\nInitial findings suggest that the campaign began in late February 2020 and lasted several\n[months. SolarWinds and CISA issued security advisories warning of active exploitation of the](https://us-cert.cisa.gov/ncas/current-activity/2020/12/13/active-exploitation-solarwinds-software)\n[SolarWinds Orion Platform software released between March and June, and Microsoft has](https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/)\nbeen tracking the SUNBURST backdoor since March.\n\n## Impact\n\n[SolarWinds confirmed that less than 18,000 of its 300,000 customers have downloaded the](https://www.solarwinds.com/company/customers)\ncompromised update. Still, the effects of this campaign are potentially staggering, with the\ncompany's products being used by several high-value entities. Victims reportedly include\ngovernment agencies and consulting, technology, telecom, and oil and gas companies in\nNorth America, Europe, Asia and the Middle East, according to FireEye. Several reports also\n[indicate that the U.S. Treasury and Commerce departments were also targeted in what is](https://www.reuters.com/article/uk-usa-cyber-treasury-exclusive/suspected-russian-hackers-spied-on-u-s-treasury-emails-sources-idUKKBN28N0PI)\nlikely related to the same activity.\n\n## Response\n\n[SolarWinds issued a security advisory recommending users upgrade to the latest version,](https://www.solarwinds.com/securityadvisory)\nOrion Platform version 2020.2.1 HF 1, as soon as possible. In response to this activity, on\n[Dec 13 2020 the U S Department of Homeland Security (DHS) and CISA issued an](https://cyber.dhs.gov/ed/21-01/)\n\n\n-----\n\n[emergency alert calling on all U.S. federal civilian agencies to review their networks for](https://www.cisa.gov/news/2020/12/13/cisa-issues-emergency-directive-mitigate-compromise-solarwinds-orion-network)\nindicators of compromise (IOCs) and advising them to disconnect SolarWinds Orion products\nimmediately. Microsoft has named this attack \"Solorigate\" in Windows Defender and, along\n[with other industry partners, has published guidance and timelines for this activity. CISA and](https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/)\nDHS [provided required actions and mitigations in their advisories:](https://cyber.dhs.gov/ed/21-01/)\n\nReimage system memory and/or host operating systems hosting all instances of\nSolarWinds Orion versions 2019.4 through 2020.2.1 HF1, and analyze for new user or\nservice accounts.\nDisconnect or power down SolarWinds Orion products, versions 2019.4 through\n2020.2.1 HF1, from their network.\nIdentify the existence of \"SolarWinds.Orion.Core.BusinessLayer.dll\" and\n\"C:\\WINDOWS\\SysWOW64\\netsetupsvc.dll\".\nBlock all traffic to and from hosts where any version of SolarWinds Orion software has\nbeen installed.\nIdentify and remove threat-actor controlled accounts and persistence mechanisms.\nReset all credentials used by SolarWinds software and implement a rotation policy for\nthese accounts. Require long and complex passwords.\nSee [Microsoft's guidance and documentation on kerberoasting.](https://techcommunity.microsoft.com/t5/microsoft-security-and/detecting-ldap-based-kerberoasting-with-azure-atp/ba-p/462448)\n\nWe urge all organizations that use the SolarWinds Orion IT monitoring and management\nsoftware to carefully follow the guidance from DHS and CISA. We also note that Cobalt\nStrike was observed being leveraged in these attacks. Cisco Talos released a research\npaper detailing the large amount of coverage for the Cobalt Strike framework. Our preexisting coverage is still applicable and can reliably detect FireEye red team beacons and\nother activity.\n\n## Incident Response\n\n[Cisco Talos Incident Response (CTIR) is currently supporting retainer customers in regard to](https://talosintelligence.com/IR)\nthe SolarWinds Orion Sunburst backdoor. CTIR recommends organizations update incident\nresponse plans, playbooks, or a tabletop exercise (TTX) to test the organization's ability to\nrespond to a supply-chain attack. Finally, once mitigation efforts have been successfully put\nin place, CTIR recommends a targeted threat hunt leveraging indicators and adversary\nTTPs.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\nSnort:\n\nSIDs 56660-56668\n\nAMP:\n\nTrojan.Sunburst.[A-Z]\nTrojan.Teardrop.[A-Z]\n\nClamAV:\n\nWin.Countermeasure.Sunburst-9816012-0\nWin.Countermeasure.Sunburst-9809153-0\nWin.Countermeasure.Sunburst-9816013-0\nWin.Countermeasure.Sunburst-9809152-0\nWin.Dropper.Teardrop-9808996-3\nPUA.Tool.Countermeasure.DropperRaw64TEARDROP-9808998-0\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware detailed in this post. Below is a screenshot showing how AMP can protect\ncustomers from this threat. Try AMP for free [here.](https://cisco.com/go/tryamp)\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS),](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html) [Cisco ISR, and](https://www.cisco.com/c/en/us/products/routers/branch-routers/index.html) [Meraki MX can detect malicious](https://meraki.cisco.com/products/appliances)\nactivity associated with this threat.\n[Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\n\n-----\n\n[Secure Cloud Analytics uses a variety of analytical processes to identify anomalous and](https://www.cisco.com/c/en/us/products/security/stealthwatch-cloud/index.html)\nmalicious behavior occurring on the network. This particular threat can have some heuristic\nindicators to identify potential SolarWinds Orion servers, including SNMP traffic, scanning\nactivity, and anomalous DNS traffic.\n\n“New SNMP sweep” alert will have fired if a server has been attempting to reach a\nlarge number of hosts using SNMP. Start a search in Monitor-> Alerts using the name\nof alert, and search over the last month (including closed alerts).\n“IP scanner” observation triggers when a device is seen on the network scanning a\nlarge number of entities. It can be included in “New SNMP sweep” as evidence, among\nother alerts (like “Outbound SMB spike”or “NetBios connection spike”). Look for this\ntype of observation in your network.\n“Domain Generation Algorithm Successful Lookup” is an alert that will trigger when a\ndevice succeeds in resolving an algorithmically generated domain (e.g., rgkte-hdvj.cc)\nto an IP address. This alert uses the Domain Generation Algorithm Success\nobservation and may indicate a malware infection or botnet activity.\n\nOnce you have identified the mentioned alert or observation, you can investigate all the\nservers related to them, as they are potentially SolarWinds Orion servers.\n\nThese types of detections and others can be applied to a variety of different threats through\nSecure Cloud Analytics to identify behavior not directly associated with existing IOCs or\nTTPs, like: C&C connections, lateral movement and data exfiltration.\n\n[Secure Workload can be used to identify compromised or affected assets and can be](https://www.cisco.com/c/en/us/products/security/tetration/index.html)\nleveraged to apply primary mitigations as recommended by CISA including restricting\nnetwork traffic to least privilege.\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Firepower Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\nFor Cisco customers that are concerned about potential impacts to Cisco products, please\n[see the PSIRT advisory available here.](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-solarwinds-supply-chain-attack)\n\n## Indicators of compromise (IOCs)\n\nDomains:\n\navsvmcloud[.]com (SUNBURST) - Killswitch domain/currently unblocked\n\n\n-----\n\nzupertech[.]com (SUNBURST)\npanhardware[.]com (SUNBURST)\ndatabasegalore[.]com (SUNBURST)\nincomeupdate[.]com (SUNBURST)\nhighdatabase[.]com (SUNBURST)\nwebsitetheme[.]com (SUNBURST)\nfreescanonline[.]com (SUNBURST)\nvirtualdataserver[.]com (SUNBURST)\ndeftsecurity[.]com (SUNBURST)\nthedoccloud[.]com (SUNBURST)\ndigitalcollege[.]org (SUNBURST)\nglobalnetworkissues[.]com (SUNBURST)\nseobundlekit[.]com (SUNBURST)\nvirtualwebdata[.]com (SUNBURST)\nkubecloud[.]com (BEACON)\nlcomputers[.]com (BEACON)\nsolartrackingsystem[.]net (BEACON)\nwebcodez[.]com (BEACON)\nervsystem[.]com (TEARDROP)\ninfinitysoftwares[.]com (TEARDROP)\n\nIP Addresses:\n13.59.205[.]66 (SUNBURST)\n54.193.127[.]66 (SUNBURST)\n3.87.182[.]149 (BEACON)\n3.16.81[.]254 (SUNBURST)\n54.215.192[.]52 (SUNBURST)\n18.253.52[.]187 (SUNBURST)\n34.203.203[.]23 (SUNBURST)\n54.215.192[.]52 (SUNBURST)\n18.220.219[.]143 (SUNBURST)\n139.99.115[.]204 (SUNBURST)\n13.57.184[.]217 (SUNBURST)\n34.219.234[.]134 (BEACON)\n5.252.177[.]25 (SUNBURST)\n5.252.177[.]21 (SUNBURST)\n204.188.205[.]176 (SUNBURST)\n51.89.125[.]18 (SUNBURST)\n162.223.31[.]184 (BEACON)\n173.237.190[.]2 (BEACON)\n45.141.152[.]18 (BEACON)\n\n\n-----\n\nHashes (SHA256):\n\n019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134 (SUNBURST)\n32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\n(SUNBURST)\nac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c\n(SUNBURST)\nc09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77 (SUNBURST)\nc15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71\n(SUPERNOVA)\nce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6 (SUNBURST)\nd0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600 (SUNBURST)\ndab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b (SUNBURST)\n1817a5bf9c01035bcf8a975c9f1d94b0ce7f6a200339485d8f93859f8f6d730c (TEARDROP)\nb820e8a2057112d0ed73bd7995201dbed79a79e13c79d4bdad81a22f12387e07\n(TEARDROP)\n0f5d7e6dfdd62c83eb096ba193b5ae394001bac036745495674156ead6557589\n(SUNBURST)\ndb9e63337dacf0c0f1baa06145fd5f1007002c63124f99180f520ac11d551420 (SUNBURST)\n118189f90da3788362fe85eafa555298423e21ec37f147f3bf88c61d4cd46c51 (TEARDROP)\neb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed (SUNBURST)\nabe22cf0d78836c3ea072daeaf4c5eeaf9c29b6feb597741651979fc8fbd2417 (SUNBURST)\n20e35055113dac104d2bb02d4e7e33413fae0e5a426e0eea0dfd2c1dce692fd9 (SUNBURST)\n2ade1ac8911ad6a23498230a5e119516db47f6e76687f804e2512cc9bcfda2b0 (SUNBURST)\n6e4050c6a2d2e5e49606d96dd2922da480f2e0c70082cc7e54449a7dc0d20f8d\n(TEARDROP)\n\nThe follow hashes reference files that contain incomplete portions of modified code - not\nenough to permit remote code execution. As a result we are not convicting the files as\nremoving them may create additional issues by breaking existing SolarWinds installations.\n\na25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc\nd3c6785e18fba3749fb785bc313cf8346182f532c59172b69adfb31b96a5d0af\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-14 - Threat Advisory- SolarWinds supply chain attack.pdf"
    ],
    "report_names": [
        "2020-12-14 - Threat Advisory- SolarWinds supply chain attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535864,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653687125,
    "ts_modification_date": 1653687125,
    "files": {
        "pdf": "https://archive.orkl.eu/e304d997c852c77decc91c1c919c6bfa31569838.pdf",
        "text": "https://archive.orkl.eu/e304d997c852c77decc91c1c919c6bfa31569838.txt",
        "img": "https://archive.orkl.eu/e304d997c852c77decc91c1c919c6bfa31569838.jpg"
    }
}