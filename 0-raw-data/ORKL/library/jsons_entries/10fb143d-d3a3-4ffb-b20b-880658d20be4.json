{
    "id": "10fb143d-d3a3-4ffb-b20b-880658d20be4",
    "created_at": "2023-01-12T15:07:51.418395Z",
    "updated_at": "2025-03-27T02:05:18.514138Z",
    "deleted_at": null,
    "sha1_hash": "220e32c22eba35ff39280b6acf6b1bc830f65996",
    "title": "2018-02-07 - Compromised Servers & Fraud Accounts- Recent Hancitor Attacks",
    "authors": "",
    "file_creation_date": "2022-05-28T17:56:48Z",
    "file_modification_date": "2022-05-28T17:56:48Z",
    "file_size": 1189410,
    "plain_text": "# Compromised Servers & Fraud Accounts: Recent Hancitor Attacks\n\n**[researchcenter.paloaltonetworks.com/2018/02/unit42-compromised-servers-fraud-accounts-recent-hancitor-attacks/](https://researchcenter.paloaltonetworks.com/2018/02/unit42-compromised-servers-fraud-accounts-recent-hancitor-attacks/)**\n\nVicky Ray, Brad Duncan February 7, 2018\n\nBy [Vicky Ray and](https://unit42.paloaltonetworks.com/author/vicky-khan/) [Brad Duncan](https://unit42.paloaltonetworks.com/author/bduncan/)\n\nFebruary 7, 2018 at 5:00 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [Chanitor,](https://unit42.paloaltonetworks.com/tag/chanitor/) [DELoader,](https://unit42.paloaltonetworks.com/tag/deloader/) [hancitor,](https://unit42.paloaltonetworks.com/tag/hancitor/) [Malspam,](https://unit42.paloaltonetworks.com/tag/malspam/) [Pony,](https://unit42.paloaltonetworks.com/tag/pony/) [Torda,](https://unit42.paloaltonetworks.com/tag/torda/) [Vawtrak](https://unit42.paloaltonetworks.com/tag/vawtrak/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-compromised-servers-fraud-accounts-recent-hancitor-attacks/)\n\n[Unit 42 has been tracking malicious spam (malspam) pushing Hancitor malware during the](https://www.fireeye.com/blog/threat-research/2016/09/hancitor_aka_chanit.html)\npast 2 years. Hancitor, also known as Chanitor or Tordal, is a macro-based malware spread\nthrough Microsoft Office documents distributed in malspam campaigns. Hancitor is designed\nto infect a victim's Microsoft Windows computer with additional malware, and the end result\nis most often a banking Trojan. But the impact of Hancitor malspam is fairly limited. On a\ndefault-configured Windows 10 host, the malware is easily detected by Microsoft's built-in\nWindows Defender anti-virus tool. Furthermore, many spam filters catch these emails before\nthey get to their intended recipients.\n\nWho is Hancitor effective against? An ideal target victim be someone running an outdated\nversion of Windows like Windows 7 with anti-virus disabled. Such victims would also click\nthrough any warnings they encounter. Apparently, this target demographic is substantial\nenough that criminals behind Hancitor malspam continue to push their emails on a frequent\n\n\n-----\n\nbasis.\nWhile researchers have published many technical reports on Hancitor campaigns, their\nprimary focus has been on the malware and its capabilities. But how does this type of attack\nwith a limited base of victims remain profitable? Little has been published about how this\ncampaign uses fraud accounts and the compromised infrastructure of legitimate businesses.\nUnderstanding the playbook used by these criminals is essential to understand why they\ncontinue to operate.\nWe continue to see several hundred examples of Hancitor malspam every month sent to a\nwide variety of recipients. The image below shows data extracted from our Autofocus threat\nintelligence platform. It provides high-level visibility on how frequently we've seen Hancitor\nmalspam so far in 2017.\n\n_Figure 1: Timeline of Hancitor campaign activity since January 2017._\n\nAccording to our Autofocus data, we can infer criminals behind this campaign follow a 5-day\nwork week from Monday through Friday. Spikes in the email activity often occur in the middle\nof the week. This reflects a general pattern of productivity seen with most people who follow\nthe same type of schedule.\n\nCampaign History\n\nIn previous years, Hancitor malware was delivered as email attachments in malspam\ncampaigns. Microsoft Word documents from this malspam downloaded other malware like\n[Pony,](https://blog.malwarebytes.com/threat-analysis/2015/11/no-money-but-pony-from-a-mail-to-a-trojan-horse/) [Vawtrak, and](https://www.proofpoint.com/us/threat-insight/post/In-The-Shadows) [DELoader as depicted in Figure 2.](https://blog.fortinet.com/2016/06/21/the-curious-case-of-an-unknown-trojan-targeting-german-speaking-users)\n\n\n-----\n\n_Figure 2: Hancitor downloaded as email attachments to targeted victims._\n\nHancitor Campaign Updates its Playbook\n\nIn the past, criminals have successfully infected victims using email attachments, but email\nfiltering has improved in recent years. Most current enterprise-level security solutions now\ninclude a sharp focus on email attachments and can easily detect malicious documents and\nultimately impact the success rate of the attackers' campaigns.\n\nTo further evade detection, since the end of 2016, actors behind Hancitor have added\nanother step in the infection process. Instead of email attachments, a link in the email points\nto distribution servers hosting these Hancitor-base documents. Figure 3 outlines current\ncampaign methods used to deliver Hancitor. This campaign continues to use distribution\nservers, indicating this technique has proven successful.\n\n\n-----\n\n_Figure 3: Current depiction of Hancitor delivery using distribution servers._\n\nAs shown in Figure 3, malicious Hancitor documents are hosted on compromised\nwebservers located at multiple regions globally, or they are hosted on fraud-based accounts\nat various hosting providers. After they establish distribution servers for a particular malspam\nrun, the threat actors use botnet hosts to push malspam with a link to the Hancitor Word\ndocument. This malspam uses several different templates to impersonate legitimate\nbusinesses. These emails are often disguised as invoices, eFax messages, and UPS or\nFedex delivery notifications, to name a few examples. If a victim clicks the embedded link, a\nHancitor document is sent to the victim's computer. Figure 4 shows an example of the\nmalspam with an embedded URL to download Hancitor in February 2017. This particular\nsample was a faked Amazon shipping notification. Obviously, this did not originate from\nAmazon: the attackers are using Amazon shipping as the plausible decoy.\n\n\n-----\n\n_Figure 4: Hancitor malspam example from February 2017._\n\nTraditionally, the link from these emails include the victim's email address as part of the URL,\nsometimes obfusctated using base64 or other encoding. This is likely an attempt by the\nHancitor actors to track the victims who would have successfully downloaded the malicious\nHancitor sample. Two examples seen earlier this year are:\n\nhxxp://[distribution server domain name]/api/getn.php?id=[base64-encoded string\n_representing recipient's email address]_\nhxxp://[distribution server domain name]/f.php?sik=[recipient's email address in plain\ntext]\n\nWhile investigating the distribution server domains, we found an open directory hosting two\ntext files: visitor.txt and block.txt (Figure 6.) The visitor.txt file appears to track all\ndownloads of Hancitor Word documents hosted on that server. The block.txt file appears to\ntrack IP addresses that should be blocked. Many IP addresses in the block.txt file resolved\nto Amazon AWS servers. We suspect this list maybe used to block analysis on automated\nsystems run by security vendors and researchers, by not serving content to IP addresses\nknown to be analyzing malware.\n\n\n-----\n\n_Figure 5: Text files on a distribution server hosting Hancitor documents._\n\nSince early October 2017, these distribution servers have usually been servers set up\nthrough fraudulent accounts at hosting providers. In September through November 2017,\nlinks from Hancitor malspam occasionally resolved to these domain names without any\nadditional text in the URL. Figure 6 shows one example.\n\n\n-----\n\n_Figure 6: Hancitor malspam example from October 2017._\n\nIn recent weeks, links from this malspam have been using a custom encoding to disguise the\nrecipient's email address in the URL.\n\nDistribution Server Characteristics\n\nGiven how actors behind Hancitor malspam leverage compromised servers, we investigated\nthe numbers and regions where these servers were compromised. The below heat map\nprovides a high-level overview of the affected countries. The distribution servers seen\nthroughout the year are located globally. While United States accounts for a large number of\ndistribution servers, majority of the servers in the United States are from fraudulent accounts\nwhich are hosted at hosting providers. By contrast, the majority of the distribution servers in\nthe rest of the countries are from compromised servers belonging to legitimate businesses.\n\nAccording to data from January to September 2017, the majority of compromised domains\nused for Hancitor-based infections are located in the Asian region. Most compromised\nservers belong to local businesses in each country. While no specific region appears more\nvulnerable than others, the domains we've seen so far in 2017 imply that organizations in\n\n\n-----\n\nAsia, especially small and medium sized businesses may be running vulnerable services\nlikely to be exploited by the Hancitor campaign to host associated malware.\n\n_Figure 7: Hancitor distribution servers globally thus far in 2017_\n\nCountry Number of Distribution servers\n\nUnited States 197\n\nJapan 23\n\nVietnam 13\n\nSingapore 12\n\nRussia 7\n\nBrazil 6\n\nMalaysia 6\n\nHong Kong 5\n\nSouth Africa 4\n\nThailand 4\n\nIndia 2\n\nIreland 2\n\nKazakhstan 2\n\n\n-----\n\nTaiwan 2\n\nTurkey 2\n\nUkraine 2\n\nArgentina 1\n\nCanada 1\n\nGermany 1\n\nIsrael 1\n\nItaly 1\n\nNetherlands 1\n\nRepublic of Korea 1\n\nRepublic of Lithuania 1\n\nUnited Kingdom 1\n\n_Table 1 – Number of Distribution Servers by Country_\n\nAs of December 2017, Hancitor Word documents have most commonly been distributed\nthrough fraudulent accounts at hosting providers. However, during post-infection activity,\nHancitor downloads additional malware from additional distribution servers. These postinfection distribution servers are also legitimate websites that have been compromised by\nthis campaign, and this characteristic of Hancitor-based infection traffic has been consistent\nsince we started tracking Hancitor.\n\nCommon Services from Compromised Servers\n\nApart from web servers and other related services, almost all compromised domains were\nrunning PureFTPd or ProFTPd services. This suggests criminals behind Hancitor malspam\nmay have been targeting servers running vulnerable versions of FTP applications. However,\nwithout any further data, we cannot make any conclusive statements.\n\nRecent Developments\n\nThe Hancitor campaign is still evolving. Unit 42 researcher Brad Duncan recently discussed\na wave of [Hancitor malspam on October 16th 2017, where Word documents from the](https://isc.sans.edu/forums/diary/Hancitor+malspam+uses+DDE+attack/22936/)\n[distribution servers used the DDE attack method. In this case, Hancitor was completely](https://www.bleepingcomputer.com/news/security/microsoft-office-attack-runs-malware-without-needing-macros/)\nseparated from the Word document and downloaded as a separate malware binary. This\n\n\n-----\n\nadded another distribution server in the infection chain of events.The DDE attack method\nspread to other actors for mass-distribution of malware through email. However, by\nNovember 2017, Hancitor resumed using macros in Word documents.\n\nConclusion\nA key factor to this campaign's longevity the abuse of hosting providers, a situation we have\npreviously reported. Another key factor is the availability of vulnerable servers world-wide\nthat criminals can compromise to host their malware. These are primary components in the\nHancitor malspam playbook. As discussed in this blog post, we've seen an evolution in their\nplaybook as criminals behind this campaign have fine-tuned their malware distribution\ntechniques.Despite a somewhat limited target base of victims who disregard best security\npractices an run older versions of Microsoft Windows, the Hancitor campaign has remained\nactive so far in 2017 with no extended absences. This indicates the campaign's current\nplaybook remains cost-effective.We continue to keep a close track of this activity for further\ndevelopments. Palo Alto Networks customers are protected from this threat through our nextgeneration security platform.\n\nCurrent samples of Hancitor are marked as Malicious by WildFire and Traps\n[AutoFocus users can identify samples of this malware using the Hancitor](https://autofocus.paloaltonetworks.com/)\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-02-07 - Compromised Servers & Fraud Accounts- Recent Hancitor Attacks.pdf"
    ],
    "report_names": [
        "2018-02-07 - Compromised Servers & Fraud Accounts- Recent Hancitor Attacks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536071,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653760608,
    "ts_modification_date": 1653760608,
    "files": {
        "pdf": "https://archive.orkl.eu/220e32c22eba35ff39280b6acf6b1bc830f65996.pdf",
        "text": "https://archive.orkl.eu/220e32c22eba35ff39280b6acf6b1bc830f65996.txt",
        "img": "https://archive.orkl.eu/220e32c22eba35ff39280b6acf6b1bc830f65996.jpg"
    }
}