{
    "id": "46e80aba-66c3-4dfb-bdc6-b39e0c419dd9",
    "created_at": "2023-01-12T14:59:27.042577Z",
    "updated_at": "2025-03-27T02:05:17.904059Z",
    "deleted_at": null,
    "sha1_hash": "ce7c3e90e7ad8be1a800db9eba463ed2db93c814",
    "title": "2020-08-13 - XCSSET Mac Malware- Infects Xcode Projects, Performs UXSS Attack on Safari, Other Browsers, Leverages Zero-day Exploits",
    "authors": "",
    "file_creation_date": "2022-05-28T22:06:12Z",
    "file_modification_date": "2022-05-28T22:06:12Z",
    "file_size": 114387,
    "plain_text": "# XCSSET Mac Malware: Infects Xcode Projects, Uses 0Days\n\n**blog.trendmicro.com/trendlabs-security-intelligence/xcsset-mac-malware-infects-xcode-projects-performs-uxss-attack-on-safari-other-browsers-leverages-zero-**\nday-exploits/\n\nAugust 13, 2020\n\nExploits & Vulnerabilities\n\nFurther investigation led us to a developer’s Xcode project that contained XCSSET source malware, which leads to a rabbit\nhole of malicious payloads. Most notable in our investigation is the discovery of two zero-day exploits.\n\nBy: Mac Threat Response, Mobile Research Team August 13, 2020 Read time: ( words)\n\nWe have discovered an unusual infection related to Xcode developer projects. Upon further investigation, we discovered\nthat a developer’s Xcode project at large contained the source malware, which leads to a rabbit hole of malicious payloads.\nMost notable in our investigation is the discovery of two zero-day exploits: one is used to steal cookies via a flaw in the\n[behavior of Data Vaults, another is used to abuse the development version of Safari.](https://support.apple.com/en-ph/guide/security/sece3bee0835/web)\n\nThis scenario is quite unusual; in this case, malicious code is injected into local Xcode projects so that when the project is\nbuilt, the malicious code is run. This poses a risk for Xcode developers in particular. The threat escalates since we have\nidentified affected developers who shared their projects on GitHub, leading to a supply-chain-like attack for users who rely\non these repositories as dependencies in their own projects. We have also identified this threat in sources such as\nVirusTotal, which indicates this threat is at large.\n\n[This blog will summarize the findings of this threat, while its accompanying technical brief contains the full details of this](https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf)\nattack. We detected the entry threat as TrojanSpy.MacOS.XCSSET.A and its command and control (C&C) related files as\nBackdoor.MacOS.XCSSET.A.\n\nThis threat primarily spreads via Xcode projects and maliciously modified applications created from the malware. It is not yet\nclear how the threat initially enters these systems. Presumably, these systems would be primarily used by developers.\nThese Xcode projects have been modified such that upon building, these projects would run a malicious code. This\neventually leads to the main XCSSET malware being dropped and run on the affected system. Infected users are also\nvulnerable to having their credentials, accounts, and other vital data stolen.\n\nOnce present on an affected system, XCSSET is capable of the following behavior:\n\nUsing exploits, it abuses the existing the Safari and other installed browsers to steal user data. In particular, it\nUses a vulnerability to read and dump Safari cookies\nUses the Safari development version to inject JavaScript backdoors onto websites via a Universal Cross-site Scripting\n(UXSS) attack\n\n\n-----\n\nIt steals information from the user s Evernote, Notes, Skype, Telegram, QQ,and WeChat apps\nIt takes screenshots of the user’s current screen\nIt uploads files from the affected machines to the attacker’s specified server\nIt encrypts files and shows a ransom note, if commanded by the server\n\nThe UXSS attack is theoretically capable of modifying almost every part of the user’s browser experience as arbitrary\nJavaScript-injected code. These modifications include:\n\nModifying displayed websites\nModifying /replacing Bitcoin/cryptocurrency addresses\nStealing amoCRM, Apple ID, Google, Paypal, SIPMarket, and Yandex credentials\nStealing credit card information from the Apple Store\nBlocking the user from changing passwords but also stealing newly modified passwords\nCapturing screenshots of certain accessed sites\n\nThe method of distribution used can only be described as clever. Affected developers will unwittingly distribute the malicious\ntrojan to their users in the form of the compromised Xcode projects, and methods to verify the distributed file (such as\nchecking hashes) would not help as the developers would be unaware that they are distributing malicious files.\n\n[Further details of this attack may be found in its related technical brief.](https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf)\n\n**Trend Micro Solutions**\n\nTo protect systems from this type of threat, users should only download apps from official and legitimate marketplaces.\n[Users can also consider multilayered security solutions such as Trend Micro Antivirus for Mac, which provides](https://blog.trendmicro.com/en_us/forHome/products/antivirus-for-mac.html)\ncomprehensive security and multidevice protection against cyberthreats.\n\nEnterprises can take advantage of Trend Micro’s [Smart Protection Suites with XGen™ security, which infuses high-](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\n[fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across any user activity or](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/machine-learning)\nendpoint.\n\nIndicators of Compromise\n\nSHA256 Filename Detection\n\n6fa938770e83ef2e177e8adf4a2ea3d2d5b26107c30f9d85c3d1a557db2aed41 main.scpt TrojanSpy.MacOS.XCSSET.A\n\n7e5343362fceeae3f44c7ca640571a1b148364c4ba296ab6f8d264fc2c62cb61 main.scpt TrojanSpy.MacOS.XCSSET.A\n\n857dc86528d0ec8f5938680e6f89d846541a41d62f71d003b74b0c55d645cda7 main.scpt TrojanSpy.MacOS.XCSSET.A\n\n6614978ab256f922d7b6dbd7cc15c6136819f4bcfb5a0fead480561f0df54ca6 xcassets TrojanSpy.MacOS.XCSSET.A\n\nac3467a04eeb552d92651af1187bdc795100ea77a7a1ac755b4681c654b54692 xcassets TrojanSpy.MacOS.XCSSET.A\n\nd11a549e6bc913c78673f4e142e577f372311404766be8a3153792de9f00f6c1 xcassets TrojanSpy.MacOS.XCSSET.A\n\n532837d19b6446a64cb8b199c9406fd46aa94c3fe41111a373426b9ce59f56f9 speedd Backdoor.MacOS.XCSSET.A\n\n4f78afd616bfefaa780771e69a71915e67ee6dbcdc1bc98587e219e120f3ea0d firefoxd Backdoor.MacOS.XCSSET.A\n\n819ba3c3ef77d00eae1afa8d2db055813190c3d133de2c2c837699a0988d6493 operad Backdoor.MacOS.XCSSET.A\n\n73f203b5e37cf34e51f7bf457b0db8e4d2524f81e41102da7a26f5590ab32cd9 yandexd Backdoor.MacOS.XCSSET.A\n\nccc2e6de03c0f3315b9e8e05967fcc791d063a392277f063980d3a1b39db2079 edged Backdoor.MacOS.XCSSET.A\n\n6622887a849b503b120cfef8cd76cd2631a5d0978116444a9cb92b1493e42c29 braved Backdoor.MacOS.XCSSET.A\n\n32fa0cdb46f204fc370c86c3e93fa01e5f5cb5a460407333c24dc79953206443 agentd Backdoor.MacOS.XCSSET.A\n\n924a89866ea55ee932dabb304f851187d97806ab60865a04ccd91a0d1b992246 agentd-kill Backdoor.MacOS.XCSSET.A\n\naf3a2c0d14cc51cc8615da4d99f33110f95b7091111d20bdba40c91ef759b4d7 agentd-log Backdoor.MacOS.XCSSET.A\n\n\n-----\n\n534f453238cfc4bb13fda70ed2cda701f3fb52b5d81de9d8d00da74bc97ec7f6 dskwalp Trojan.MacOS.XCSSET.A\n\n172eb05a2f72cb89e38be3ac91fd13929ee536073d1fe576bc8b8d8d6ec6c262 chkdsk Trojan.MacOS.XCSSET.A\n\na238ed8a801e48300169afae7d27b5e49a946661ed91fab4f792e99243fbc28d Pods_shad Trojan.MacOS.XCSSET.A\n\n**IP/Domain** **Web Reputation Category**\n\nhxxps://adobestats.com/ C&C Server\n\nhxxps://flixprice.com/ C&C Server\n\n46.101.126.33 C&C Server\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-13 - XCSSET Mac Malware- Infects Xcode Projects, Performs UXSS Attack on Safari, Other Browsers, Leverages Zero-day Exploits.pdf"
    ],
    "report_names": [
        "2020-08-13 - XCSSET Mac Malware- Infects Xcode Projects, Performs UXSS Attack on Safari, Other Browsers, Leverages Zero-day Exploits.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535567,
    "ts_updated_at": 1743041117,
    "ts_creation_date": 1653775572,
    "ts_modification_date": 1653775572,
    "files": {
        "pdf": "https://archive.orkl.eu/ce7c3e90e7ad8be1a800db9eba463ed2db93c814.pdf",
        "text": "https://archive.orkl.eu/ce7c3e90e7ad8be1a800db9eba463ed2db93c814.txt",
        "img": "https://archive.orkl.eu/ce7c3e90e7ad8be1a800db9eba463ed2db93c814.jpg"
    }
}