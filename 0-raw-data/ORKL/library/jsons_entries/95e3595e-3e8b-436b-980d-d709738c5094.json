{
    "id": "95e3595e-3e8b-436b-980d-d709738c5094",
    "created_at": "2023-01-12T14:59:51.343237Z",
    "updated_at": "2025-03-27T02:16:59.124654Z",
    "deleted_at": null,
    "sha1_hash": "23ec4d139100d0993d629ab223414f4dbee6ace6",
    "title": "2021-06-14 - Malware hosting domain Cyberium fanning out Mirai variants",
    "authors": "",
    "file_creation_date": "2022-05-28T15:42:56Z",
    "file_modification_date": "2022-05-28T15:42:56Z",
    "file_size": 436253,
    "plain_text": "# Malware hosting domain Cyberium fanning out Mirai variants\n\n**[cybersecurity.att.com/blogs/labs-research/malware-hosting-domain-cyberium-fanning-out-mirai-variants](https://cybersecurity.att.com/blogs/labs-research/malware-hosting-domain-cyberium-fanning-out-mirai-variants)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nJune 14, 2021 | [Fernando Martinez](https://cybersecurity.att.com/blogs/author/fmartinez)\n\n## Executive summary\n\nAT&T Alien Labs has observed the Mirai variant botnet, known as Moobot, scanning for\nknown but uncommon vulnerabilities in Tenda routers, resulting in a considerable peak in our\ninternal telemetry. The research associated with this peak resulted in the discovery of a\nmalware hosting domain, providing several different Mirai variants, like Moobot and Satori.\n\n**Key points:**\n\nAT&T Alien Labs identified a short but intense peak in scanning for Tenda routers,\nwhich had been uncommon in previous months.\nThe Cyberium malware hosting domain has been serving Mirai variants for several\nknown, but different botnets over the past year.\nOur research team has gathered intelligence from previous campaigns launched by\nthis same attacker; though they made changes in their infrastructure and payloads,\nthey have mostly recycled their tactics and techniques.\n\n\n-----\n\n### Analysis\n\nDuring the end of March, AT&T Alien Labs observed a spike in exploitation attempts for\nTenda Remote Code Execution (RCE) vulnerability CVE-2020-10987. This spike was\nobserved throughout a significant number of clients, in the space of a few hours. This\nvulnerability is not commonly used by web scanners and was barely detected by our\nhoneypots during the last six months, except for a minor peak in November.\n\nThis exploit can be identified by the URL that is requested, which includes ‘setUsbUnload’\nwith the payload assigned to the vulnerable parameter ‘deviceName’. This payload contains\nthe logic to change the execution path to a temporary location, wget a file from a malware\nhosting page, provide execution permissions, and execute it.\n\nFigure 1. BinaryEdge Sensor detecting the vulnerability scan.\n\nFollowing this thread, a single actor was identified to be behind these scans in late March —\nat the time, the actor appeared to have no previous activity. The scan for Tenda vulnerable\nrouters only lasted one day, but the scanning activity continued for several weeks, including\nthe below vulnerabilities:\n\nPort 80 and 8080: Axis SSI RCE.\nPort 34567: DVR scanner attempting default credentials for Sofia main video\napplication.\nPort 37215: Huawei Home routers RCE Vulnerability (CVE-2017-17215).\nPort 52869: Realtek SDK Miniigd UPnP SOAP Command Execution (CVE-2014-8361).\n\nSome of these exploit attempts were captured by honeypots. All of them appeared to be\npulling their next iteration of the malware from the same malware hosting page:\ndns.cyberium[.]cc.\n\nWhen this domain was investigated, several campaigns were identified, going back at least\none year to May 2020. Most of the attacks lasted for approximately a week while they hosted\nseveral Mirai variants, after which they left the subdomain unresolvable. However, this\nseems to be the behavior of the threat actor in between operations. The actors appear to\ncome back to the same domain with a new subdomain for each new campaign. Activity in\n\n\n-----\n\nbetween campaigns goes quiet to increase the trust of the original domain. Keeping a longrunning existing domain while issuing brand new one domain helps to divert attention to the\nnew domain and thus distract from the original.\n\nFigure 2. RiskIQ heatmap of cyberium[.]cc.\n\nThe full list of subdomains/campaigns identified from this domain is:\n\nSnoopy.cyberium[.]cc: Around May 2020\nU.cyberium[.]cc: Around May 2020\nGcc.cyberium[.]cc: Around June 2020\nPark.cyberium[.]cc: Around July 2020\nHoon.cyberium[.]cc: Around July 2020\nHh.cyberium[.]cc: Around September 2020\nWo.cyberium[.]cc: Around October 2020\nY.cyberium[.]cc: Around October 2020\nW.cyberium[.]cc: Around November 2020\nNs.cyberium[.]cc: Around November 2020\nTmp.cyberium[.]cc: Around December 2020\nFtp.cyberium[.]cc: Around March 2021\nDns.cyberium[.]cc: Around April 2021\nDdns.cyberium[.]cc: Around April 2021\n\nWe were able to identify other infrastructure that we assess with high confidence is controlled\nby the same actor and has been used as Moobot command and control in the past.\n\nPark.allcheesedout[.]cc: around September 2020\nRatatouille.allcheesedout[.]cc: around September 2020\nWatchdog.allcheesedout[.]cc: around September 2020\nBot.bigbots[.]cc: around February 2021\nCnc.bigbots[.]cc: around February 2021\nCnc1.bigbots[.]cc: around February 2021\nCnc.fewbots[.]cc: created and up since February 2021\nBot.fewbots[.]cc: created and up since February 2021\nCnc.hardbotz[.]cc: created and up since March 2021\nProjectaliennet[.]cc: created and up since March 2021\nLife.zerobytes[.]cc: created on May 2021\n\nAll of the domains use the same:\n\n\n-----\n\nRegistrar: Namecheap.\nTop level domain: CC.\nAll of them served Mirai variants.\n\nThe first request to these malware hosting pages was for a bash script, which aimed to\ndownload later stages of the malware. As seen in the screenshot below, the script attempts\nto download a list of filenames (associated with different CPU architectures), executes each\none of them, achieves persistence through a crontab that redownloads the bash script itself,\nand finally deletes itself.\n\nFigure 3. Tenda downloader script.\n\n[This script is very similar to downloaders previously seen for Mirai variants. The minor](https://isc.sans.edu/forums/diary/When+Cameras+and+Routers+attack+Phones+Spike+in+CVE20148361+Exploits+Against+Port+52869/23942/)\nmodifications appear to be on the downloading server, persistence methods (if any) and the\nfilename, usually named after the vulnerable device vendor.\n\nDuring the time this domain was available and delivering malware, at least three different\nvariants of Mirai were identified: Moobot, Satori/Fbot, and other samples unassociated with\nthese botnets. One of the peculiarities of this domain was how it juggled between Mirai\nvariants, even under the same filenames. The same URL could be hosting Satori one day\nand Moobot the week after.\n\n### Moobot\n\n[In October 2020, Lacework reported on a new Mirai variant called Moobot. This variant](https://www.lacework.com/blog/moobots-cloud-migration/)\nmainly chased exposed and vulnerable Dockers APIs to include them into their DDoS botnet.\nOne of the main distinctions of this variant has been a hardcoded string\n“w5q6he3dbrsgmclkiu4to18npavj702f”, compared to the Mirai source code which used the\n\n\n-----\n\nstring abcdefghijklmnopqrstuvw012345678 as a seed to generate an alphanumeric string.\nThis random string is used several times throughout the code, one of them to generate the\nprocess name to be used during execution.\n\nMany samples available at Cyberium contained the above-mentioned string and this domain\nwas already being used to distribute this botnet when Lacework first reported on it. However,\nthe number of samples Alien Labs has seen with that string has greatly increased in the last\nmonths, scattering from the original Moobot sample. This could potentially mean that last\nyear's Moobots samples were used to create new branches of Mirai variants.\n\nUnlike some other Mirai variants, the samples obtained from Moobot were encrypted,\nattempting to evade string-based detection, static analysis of the exploits used, or after\ncompromised activities. However, it did maintain other previously seen characteristics, like a\n[hardcoded list of IP addresses to avoid, such as: private ranges, the department of Defense,](https://www.imperva.com/blog/malware-analysis-mirai-ddos-botnet/)\nIANA IPs, GE, HP and others.\n\nFigure 4. Moobot’s IP scan restrictions.\n\nThe malware writers appear to be very aware of who they’re potential victims are. For this\nreason, the malware will try to hide its process name by changing it using prctl. The covert\nprocess name is “/var/Sofia”, which is the name of a video application on the targeted\ndevices.\n\n\n-----\n\nFigure 5. Moobot process hideout.\n\nRight after hiding the process, this sample will print to screen the string\n“9xsspnvgc8aj5pi7m28p” which has been associated with different Mirai variants over time\n[(Fbot and](https://blog.malwaremustdie.org/2020/02/mmd-0065-2021-linuxmirai-fbot-re.html) [Gafgyt). However, it appears this is a passed down characteristic through variant](https://s.tencent.com/research/report/1101.html)\nversions, like previously seen with “w5q6he3dbrsgmclkiu4to18npavj702f”, but this time there\naren’t any shared IOCs with previous attackers.\n\nAfter successful infection, the payload attempts to query the hardcoded C2 on port 12028 to\nget a list of C2. At the time of study, the Cyberium domain was down, and these\ncommunications couldn’t be analyzed.\n\n### Satori/Fbot\n\nEarly in March 2021, the same links previously mentioned for Moobot, for example\ndns.cyberium[.]cc/arm, were actually providing samples for Satori. The Satori botnet, also\nknown as Fbot, is yet another Mirai variant based botnet. Unexpectedly, these samples were\nmingled with other UNIX botnets in the same malware hosting server.\n\nThe similarities between Moobot and Satori samples are vast, since they both are coming\nfrom the same Mirai source code. These similarities include:\n\nDownloading method\nVulnerability scannings and targets in IoT devices\nThe String 9xsspnvgc8aj5pi7m28p printed after execution\nProcess name to hide behind (/var/Sofia) (despite having seen other Satori samples\nhiding behind /bin/busybox)\n\nThe most noteworthy differences observed were:\n\n\n-----\n\nThe string w5q6he3dbrsgmclkiu4to18npavj702f wasn t present in the Satori samples\nThe C2 domain for Satori where it notifies successful infection is bin.rippr[.]cc, which\nhas been previously associated with other Satori campaigns\nIn the first observed samples, the code wasn’t encrypted and many more strings could\nbe read without any additional operations — unlike Moobot samples that were encoded\nto reduce the number of strings in plain text\n\n### Other samples\n\nAdditional samples were identified under the same domain, which on a first investigation\nappeared to be a mix between the already mentioned Moobot and Satori samples with a\nrandom combination of their characteristics. Most of them looked like Moobot samples\nwithout the encoding or Satori without the hardcoded domain.\n\nHowever, the samples are not associated with the current domain under study, probably\nbecause it is being left fallow. After pivoting on the scanning IP, delivering the downloaders\nscripts, it is currently providing the same script with an updated temporary domain, which is\ncurrently delivering additional Satori/Fbot samples packed with UPX.\n\n## Recommended Actions\n\n1. Keep all IoT devices updated, and specifically focus on addressing the mentioned\n\ndevices or CVEs.\n2. Monitor network traffic for known incoming exploits.\n3. Monitor egress and ingress network traffic to the Cyberium or ripper domain.\n4. Regularly perform process auditing and accounting looking for known malicious\n\nprocesses names that a botnet could be hiding under.\n\n## Conclusion\n\nAlien Labs has identified the Cyberium malware hosting domain to be providing many\ndifferent Mirai variants, like Moobot or Satori, during the last year. Actors have been jumping\nbetween subdomains to recycle their infrastructure as most as possible. At the time of\npublishing this blog (May 2021) some of the Cyberium subdomains were up, but they were\nnot hosting any malware samples. They could be potentially awaiting new requests for C2\nlists.\n\nSeveral questions remain unanswered. Why would the attackers deliver different Mirai\nvariants with different C2s on the same campaign? And, are they trying to avoid anti-virus\ndetection through diversification of variants? Or, are they trying to improve the botnet\nresiliency by diversifying C2.\n\n## Detection Methods\n\n\n-----\n\nThe following associated detection methods are in use by Alien Labs. They can be used by\nreaders to tune or deploy detections in their own environments or for aiding additional\nresearch.\n\nSURICATA IDS SIGNATURES\n\nalert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"AV EXPLOIT Tenda Router\nRCE (CVE-2020-10987)\"; flow:to_server,established; content:\"GET\"; http_method;\ncontent:\"/setUsbUnload/\"; http_uri; content:\"deviceName=\"; http_uri; pcre:\"/^[^&]*\n(\\x3B|%3B)/UR\"; reference:cve,2020-10987; reference:url,blog.netlab.360.com/ttint-an-iotrat-uses-two-0-days-to-spread/; classtype:attempted-admin; sid:4002263; rev:1;)\n\nalert tcp $EXTERNAL_NET any -> $HOME_NET 34567 (msg:\"AV TROJAN Moobot\nBotnet DVRIP Scan Inbound\"; flow:established; content:\"{ |22|EncryptType|22| :\";\noffset:20; depth:17; content:\"DVRIP-Web\"; distance:0; content:\"UserName|22| :\n|22|admin|22| }|0A|\"; distance:0; isdataat:!1,relative; threshold: type both, track by_src,\nseconds 300, count 3; reference:url,blog.netlab.360.com/the-botnet-cluster-on-185-24425-0-24-en/; classtype:trojan-activity; sid:4001530; rev:1;)\n\nalert tcp $EXTERNAL_NET any -> $HOME_NET 34567 (msg:\"AV EXPLOIT Moobot\nBotnet exploiting InstallDesc DVRIP vulnerability (CVE-2017-16725)\";\nflow:established,to_server; content:\"PK\"; depth:24; content:\"IntallDesc\"; distance:0;\nwithin:40; fast_pattern; threshold: type both, track by_src, seconds 300, count 1;\nreference:cve,2017-16725; reference:url,blog.netlab.360.com/the-botnet-cluster-on-185244-25-0-24-en/; classtype:trojan-activity; sid:4001531; rev:1;)\n\nalert tcp $HOME_NET any -> $EXTERNAL_NET 34567 (msg:\"AV TROJAN Moobot\nBotnet Scanning DVRIP from infected system Outbound\"; flow:established,to_server;\ncontent:\"{ |22|EncryptType|22| :\"; offset:20; depth:17; content:\"DVRIP-Web\"; distance:0;\ncontent:\"UserName|22| : |22|admin|22| }|0A|\"; distance:0; isdataat:!1,relative; threshold:\ntype both, track by_src, seconds 300, count 3; reference:url,blog.netlab.360.com/thebotnet-cluster-on-185-244-25-0-24-en/; classtype:trojan-activity; sid:4001529; rev:1;)\n\nalert http $EXTERNAL_NET any -> $HOME_NET 37215 (msg:\"AV EXPLOIT Huawei\nHG532 RCE Vulnerability (CVE-2017-17215)\"; flow:established,to_server;\ncontent:\"POST\"; http_method; urilen:22; content:\"/ctrlt/DeviceUpgrade_1\"; nocase;\nhttp_uri; content:\"upgrade\"; http_client_body; nocase; content:\"NewStatusURL\";\nhttp_client_body; distance:0; content:\"NewDownloadURL\"; http_client_body; distance:0;\nreference:cve,2017-17215; reference:url,research.checkpoint.com/good-zero-day-skiddie/;\nclasstype:attempted-admin; sid:4000758; rev:1;)\n\nET EXPLOIT Realtek SDK Miniigd UPnP SOAP Command Execution CVE-2014-8361 Outbound\n\n\n-----\n\nalert http $EXTERNAL_NET any -> $HOME_NET any (msg:\"AV EXPLOIT Axis SSI RCE\";\nflow:to_server,established; content:\"/incl/image_test.shtml?\"; http_uri; content:\"camnbr=\";\nhttp_uri; distance:0; reference:url,exploit-db.com/exploits/43984; classtype:attemptedadmin; sid:4002573; rev:1;)\n\n## Associated Indicators (IOCs)\n\nThe following technical indicators are associated with the reported intelligence. A list of\n[indicators is also available in the OTX Pulse. Please note, the pulse may include other](https://otx.alienvault.com/pulse/60ab982cf14079800d877cb7)\nactivities related but out of the scope of the report.\n\nTYPE INDICATOR DESCRIPTION\n\nDOMAIN cyberium[.]cc Malicious domain\n\nMD5 fbdc24f589e99088cec5fc77257c81f3 Moobot sample\n\nMD5 78ecbd418cac0a1af9feb860fceae2f9 Satori sample\n\nMD5 14c629f43d3e05615ea1b25d3e4aa1fa Unassigned variant sample\n\nMD5 555821a5f67d064362e8ce9a48b95d56 Fbot sample UPX packed\n\n## Mapped to MITRE ATT&CK\n\n[The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques:](https://attack.mitre.org/)\n\nTA0043: Reconnaissance\n\nT1595: Active Scanning\nTA0001: Initial Access\n\nT1190: Exploit Public-Facing Application\nTA0002: Execution\n\nT1059: Command and Scripting Interpreter\nT1053: Scheduled Task/Job\nTA0003: Persistence\n\nT1547: Boot or Logon Autostart Execution\nTA0005: Defense Evasion\n\nT1027: Obfuscated Files or Information\nT1070: Indicator Removal on Host\n\n\n-----\n\nTA0006: Credential Access:\n\nT1552: Unsecured Credentials\n\n### Share this with others\n\nTags: [alien labs,](https://cybersecurity.att.com/blogs/tag/alien+labs) [otx pulse,](https://cybersecurity.att.com/blogs/tag/otx+pulse) [attacks,](https://cybersecurity.att.com/blogs/tag/attacks) [labs,](https://cybersecurity.att.com/blogs/tag/labs) [exploits,](https://cybersecurity.att.com/blogs/tag/exploits) [mirai](https://cybersecurity.att.com/blogs/tag/mirai)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-14 - Malware hosting domain Cyberium fanning out Mirai variants.pdf"
    ],
    "report_names": [
        "2021-06-14 - Malware hosting domain Cyberium fanning out Mirai variants.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535591,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653752576,
    "ts_modification_date": 1653752576,
    "files": {
        "pdf": "https://archive.orkl.eu/23ec4d139100d0993d629ab223414f4dbee6ace6.pdf",
        "text": "https://archive.orkl.eu/23ec4d139100d0993d629ab223414f4dbee6ace6.txt",
        "img": "https://archive.orkl.eu/23ec4d139100d0993d629ab223414f4dbee6ace6.jpg"
    }
}