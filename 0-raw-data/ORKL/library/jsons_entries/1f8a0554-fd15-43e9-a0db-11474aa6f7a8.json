{
    "id": "1f8a0554-fd15-43e9-a0db-11474aa6f7a8",
    "created_at": "2023-01-12T15:06:13.521647Z",
    "updated_at": "2025-03-27T02:17:02.245788Z",
    "deleted_at": null,
    "sha1_hash": "87317a1212d484e5a8922b52835ff0ed509a0bd9",
    "title": "2020-06-11 - マルウエアLODEINFOの進化 (Evolution of Malware LODEINFO)",
    "authors": "",
    "file_creation_date": "2022-05-28T03:56:09Z",
    "file_modification_date": "2022-05-28T03:56:09Z",
    "file_size": 1195215,
    "plain_text": "# マルウエアLODEINFOの進化 - JPCERT/CC Eyes | JPCERT コーディネーションセンター公式ブログ\n\n**blogs.jpcert.or.jp/ja/2020/06/LODEINFO-2.html**\n\n喜野 [孝太(Kota Kino)](https://blogs.jpcert.or.jp/ja/kino/)\n\n2020/06/11\n\n## マルウエアLODEINFOの進化\n\n[LODEINFO](https://blogs.jpcert.or.jp/ja/tags/lodeinfo/)\n\n[メール](http://10.10.0.46/mailto:?subject=%E3%83%9E%E3%83%AB%E3%82%A6%E3%82%A8%E3%82%A2LODEINFO%E3%81%AE%E9%80%B2%E5%8C%96&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2020%2F06%2FLODEINFO-2.html)\n\n[以前のブログで、日本国内の組織を狙ったマルウエアLODEINFOについて紹介しました。](https://blogs.jpcert.or.jp/ja/2020/02/LODEINFO.html)\nJPCERT/CCでは、現在もこのマルウエアを使用した攻撃が活発に行われていることを確認\nしており、新型コロナウイルスに関連したファイル名などを使って、感染を広げようとする\n動きが見られます。また、LODEINFOは頻繁にアップデートが行われており、複数の機能が\n追加・変更されていることを確認しています。\n\n今回は、LODEINFOの一連の攻撃の中で見られた傾向と、アップデート内容について紹介し\nます。\n\n### LODEINFOを配信する手口\n\n確認されている全ての攻撃の起点は、添付ファイル付きの標的型攻撃メールです。添付ファ\nイルにはWord文書、またはExcel文書が使用されており、添付ファイルを開いてマクロを有\n効化することで、内包していたLODEINFOがホスト上に作成、実行されます。 標的型攻撃\nメールに使用されているメールと添付ファイルの内容は、以下のようなものを確認していま\nす。\n\n新型コロナウイルスを題材にしたもの\n日露や日韓の外交を題材にしたもの\n企業への履歴書や申し込みを装ったもの\n\n攻撃対象の業種としては、メディア系、公共系を確認しています。また、標的型攻撃メール\nの送信には、フリーのメールアドレス（Gmail等）を使用している傾向が見られます。\n\n### LODEINFOのバージョン\n\n\n-----\n\n以前のブログで紹介したLODEINFOのバージョンは、v0.1.2でしたが、本ブログ執筆時点で\n確認している最新バージョンは、v0.3.6となっています。また、JPCERT/CCでは以下のバ\nージョンのLODEINFOが存在することを確認しています。\n\n図\n\n1：バージョンの推移\nなお、各バージョンで追加された主な機能としては、以下のようなものを確認しています。\n\nバージョン 機能追加\n\nv0.2.7 データ送受信フォーマットの一部変更\n\n既存コマンドの拡張（ver）\n\nMutexの作成\n\nv0.3.2 新規コマンドの追加（print）\n\n永続化処理の追加\n\nv0.3.5 新規コマンドの追加（rm、ransom、keylog）\n\n### 新規コマンドの追加\n\n現時点での最新バージョン（v0.3.6）では、前回のv0.1.2の検体から以下のコマンドが追加\nされています。\n\nprint\nrm\nransom\nkeylog\n\n\n-----\n\nprintコマンドは感染ホストのスクリーンキャプチャを取得し、rmコマンドは指定されたファ\nイルの削除を行います。 例えばrmコマンドを実行した場合、ファイル削除後、以下のよう\nな実行結果がC&Cサーバ宛てに送信されます。\n```\n1590318292|932|080027D50FB0|DESKTOP-J783225C:\\Users\\Public\\Pictures\\Sample\nPictures\\Chrysanthemum.jpg: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\Desert.jpg: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\desktop.ini: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\Hydrangeas.jpg: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\Jellyfish.jpg: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\Koala.jpg: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\Lighthouse.jpg: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\Penguins.jpg: OK.\nC:\\Users\\Public\\Pictures\\Sample Pictures\\Tulips.jpg: OK.\n\n```\nransom、keylogコマンドについては、現時点で確認しているバージョンでは未実装となっ\nており、コマンドを実行しても以下のような結果だけがC&Cサーバ宛てに送信されます。\n```\n1590318292|932|080027D50FB0|DESKTOP-J783225Not available\n\n```\nただし、コマンド名から推測すると、将来的にファイルの暗号化やキーログ機能が搭載され\nる可能性があるかもしれません。\n\n\n-----\n\n図 2：コマンドの一覧\n\n\n図\n\n3：ransom、keylogコマンド処理部\n\n### データ送受信フォーマットの一部変更\n\nLODEINFOは、AESとBASE64を組み合わせてデータの暗号化を行っていますが、データを\nBASE64デコードした後のオフセット0x45の位置には、AESで暗号化されたデータのサイズ\nが記載されています。\n\n\n-----\n\n図\n\n4：変更前のデータフォーマット\n前回のv0.1.2の検体では、該当部分にデータサイズがそのまま記載されていましたが、\nv0.2.7以降の検体からは、オフセット0x49の位置に新しく1byteのXORキーが記載されるよ\nうになり、オフセット0x45のデータサイズにはXORキーでエンコードされた値が記載され\nるようになっています。\n\n図\n\n5：変更後のデータフォーマット 図 6：XORの\n\n処理部\n上記の変更によって、以前に紹介したHTTP POSTリクエストのデータを復号するコードが\n正常に動作しなくなっているため、以下に対応したコードの一部を記載します。\n\n\n-----\n\n```\nfrom Crypto.Cipher import AES\nfrom base64 import urlsafe_b64decode\nfrom binascii import a2b_hex\ndef decypt_lodeinfo_data(enc_data: str, key: bytes, iv: bytes) -> bytes:\n  header_b64 = enc_data[:0x1C]\n  header = urlsafe_b64decode(header_b64.replace(\".\", \"=\"))\n  ## decode with base64\n  postdata_size = int.from_bytes(header[0x10:0x14], byteorder=\"little\")\n  postdata_b64 = enc_data[0x1C:0x1C+postdata_size]\n  postdata = urlsafe_b64decode(postdata_b64.replace(\".\", \"=\"))\n  ## decrypt with AES\n  cipher = AES.new(key, AES.MODE_CBC, iv)\n  xor_key = postdata[0x34]\n  decrypt_size = int.from_bytes([b ^ xor_key for b in\npostdata[0x30:0x34]],byteorder=\"little\")\n  dec_data = cipher.decrypt(postdata[0x35:0x35+decrypt_size])\n  ## remove junk bytes\n  junk_size = dec_data[-1]\n  dec_data = dec_data[:decrypt_size-junk_size]\n  return dec_data\nencrypted_data = \"njgGCEgbkXQIgexSrDm3O7QAAADuSiTM6xoP8ResYAybhHoRx9WUlw_ealn9gIEjvsZzqQXG8vn3QYoIfmNmO4viy0rFkZGRkaN6IX4HXacdyoRLWkIYxVPI9Ciu8sDP1PK0x6gDH556OYX8GMdejk40daIbiwY3ERd0qL8jRawpwBHht7Sps_hwoZfeksly5sw2Y9RqtUQ..\"\nKEY = a2b_hex(\"7306ED96A7D75BAB94C4F15AAF0A9E61690F0E300FEA9135764C206580DF2970\")\nIV = a2b_hex(\"D5C5376805264812B3ED88BE4A614A1A\")\ndecrypted_data = decypt_lodeinfo_data(encrypted_data, KEY,IV)\nprint(\"Decrypted Data: \", bytes.hex(decrypted_data))\n\n### LODEINFOの起動方法の変化\n\n```\n以前のLODEINFOでは、Word文書のマクロを有効化した際に、LODEINFOのDLLファイル\nをホスト上に作成し、rundll32.exe を使って実行していました。しかし、v0.3.2以降から\nは、DLLファイルと一緒に正規のWindows実行ファイルを作成し、DLLサイドローディング\nを使ってLODEINFOを実行するように手法が変わっています。\n\n\n-----\n\n図\n\n7：起動方法の変化（左: rundll32.exeによる実行、右: DLLサイドローディングによる実行）\n\n### LODEINFOの通信特徴\n\nLODEINFOはUser-Agentが検体内部でハードコードされており、v0.2.7までは以下が使用さ\nれています。\n```\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/77.0.3865.90 Safari/537.36\n\n```\nまた、v0.3.2以降では以下が使用されています。\n```\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/70.0.3538.102 Safari/537.36 Edge/18.18363\n\n```\nC&Cサーバのインフラには、様々な国のISPが利用されています。\n\n\n-----\n\n図 8：C&Cサーバのインフラ分布\n\n### おわりに\n\nマルウエアLODEINFOの開発は頻繁に行われており、同様に攻撃も継続して確認されていま\nす。 今後もこのマルウエアを使用した攻撃が続く可能性がありますので、引き続き注意が\n必要です。\n\nなお、今回解説した検体のハッシュ値をAppendix A、新たに確認した通信先をAppendix B\nに記載しています。 Appendix Bの通信先に対して通信が発生していないかをご確認くださ\nい。\n\nインシデントレスポンスグループ 喜野 孝太、佐條 研\n\n**Appendix A 検体のハッシュ値**\n\n65433fd59c87acb8d55ea4f90a47e07fea86222795d015fe03fba18717700849\n（v0.3.6）\n8c062fef5a04f34f4553b5db57cd1a56df8a667260d6ff741f67583aed0d4701 （v0.3.5）\n1cc809788663e6491fce42c758ca3e52e35177b83c6f3d1b3ab0d319a350d77d\n（v0.3.2）\n\n**Appendix B 通信先**\n\n103.27.184.27\n103.140.187.183\n103.204.172.210\n133.130.121.44\n167.179.101.46\n\n\n-----\n\n167.179.112.74\n172.105.232.89\n194.68.27.49\nwww.amebaoor.net\n\n[メール](http://10.10.0.46/mailto:?subject=%E3%83%9E%E3%83%AB%E3%82%A6%E3%82%A8%E3%82%A2LODEINFO%E3%81%AE%E9%80%B2%E5%8C%96&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2020%2F06%2FLODEINFO-2.html)\n\nこの記事の筆者\n\n喜野 [孝太(Kota Kino)](https://blogs.jpcert.or.jp/ja/kino/)\n\n2019年8月より現職。主に、マルウェア分析・フォレンジック調査に従事。\n\nこのページは役に立ちましたか？\n\n0人が「このページが役に立った」と言っています。\n\nその他、ご意見・ご感想などございましたら、ご記入ください。\n\nこちらはご意見・ご感想用のフォームです。各社製品については、各社へお問い合わせくだ\nさい。\n\njavascriptを有効にすると、ご回答いただけます。 ありがとうございました。\n\n## 関連記事\n\nHUI Loaderの分析\n\nAnti-UPX Unpackingテクニック\n\n\n-----\n\nモバイル端末を狙うマルウェアへの対応FAQ\n\n攻撃グループLuoYuが使用するマルウェアWinDealer\n\n攻撃グループBlackTechが使用するマルウェアGh0stTimes\n\n≪ [前へ](https://blogs.jpcert.or.jp/ja/2020/05/security_conference.html)\n[トップに戻る](https://blogs.jpcert.or.jp/ja/)\n[次へ](https://blogs.jpcert.or.jp/ja/2020/06/how_to_convert_vol-plugin.html) ≫\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-11 - マルウエアLODEINFOの進化 (Evolution of Malware LODEINFO).pdf"
    ],
    "report_names": [
        "2020-06-11 - マルウエアLODEINFOの進化 (Evolution of Malware LODEINFO).pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535973,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1653710169,
    "ts_modification_date": 1653710169,
    "files": {
        "pdf": "https://archive.orkl.eu/87317a1212d484e5a8922b52835ff0ed509a0bd9.pdf",
        "text": "https://archive.orkl.eu/87317a1212d484e5a8922b52835ff0ed509a0bd9.txt",
        "img": "https://archive.orkl.eu/87317a1212d484e5a8922b52835ff0ed509a0bd9.jpg"
    }
}