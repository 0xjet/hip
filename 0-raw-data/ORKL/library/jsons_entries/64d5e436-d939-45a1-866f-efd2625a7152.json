{
    "id": "64d5e436-d939-45a1-866f-efd2625a7152",
    "created_at": "2023-03-03T02:05:21.862718Z",
    "updated_at": "2025-03-27T02:10:10.665844Z",
    "deleted_at": null,
    "sha1_hash": "d44b382f19b9770cb4374f9f1419070f5553a1d7",
    "title": "2023-02-08 - SteelClover Attacks Distributing Malware Via Google Ads Increased",
    "authors": "",
    "file_creation_date": "2023-03-01T09:14:58Z",
    "file_modification_date": "2023-03-01T09:14:58Z",
    "file_size": 1687864,
    "plain_text": "# SteelCloverによるGoogle広告経由でマルウェアを配布す る攻撃の活発化について\n\n**[insight-jp.nttsecurity.com/post/102i7af/steelclovergoogle](https://insight-jp.nttsecurity.com/post/102i7af/steelclovergoogle)**\n\nRintaro Koike\n\n本日の記事は、SOC アナリスト 小池 倫太郎の記事です。\n\n--\n\n-----\n\n2023年1月初めから複数の日本企業において、Google広告経由でマルウェアをダウンロード\nするインシデントが急増しています。IcedIDやAurora Stealerを配布するものなど、観測さ\nれている攻撃キャンペーンは数多く存在しますが、特に私たちがSteelCloverと呼んでいる攻\n撃グループによるものが多くなっています。\n\n本稿では、直近で観測されたGoogle広告経由でのマルウェア配布事例の中から、\nSteelCloverによる攻撃の最新動向を共有します。\n\n## SteelClover\n\nSteelCloverは少なくとも2019年から活動している攻撃グループで、金銭を目的に攻撃を行\nっています。Malsmoke[1][2][3][4]と呼ばれる攻撃キャンペーンを実行している攻撃グループ\nであり、Batloader[5]と呼ばれるマルウェアを使用しており、DEV-0569[6]やWater\nMinyades[7]と重複があります。SteelCloverによる攻撃は情報窃取の他に、最終的にランサ\nムウェア実行に至るという情報もあります。\n\n私たちはSteelCloverによる攻撃を5つのキャンペーンに分類しており、2023年2月上旬時点\nではBatAppキャンペーンとFakeGPGキャンペーンが観測されています。これまでも日本国\n内で数回スパイクが確認されていましたが、2023年1月上旬から再び活発化しています。\n\nSteelCloverは現在までに様々な変化が観測されており、攻撃手法も日々アップデートされて\nいます。以下にSOCで把握しているSteelCloverのイベントを示します。\n\n\n-----\n\n## 最新の攻撃フロー\n\nSteelCloverは日々アップデートを続けており、攻撃フローも変化していますが、以下では\n2023年2月上旬に観測されたFakeGPGキャンペーンによる攻撃をもとにしています。\n\n\n-----\n\nユーザがGoogle検索から何らかのキーワードを検索した際、検索結果ページの最上位に\nGoogle広告が表示されることがあります。現在急増している攻撃（SteelCloverに限らず）\nでは、著名なソフトウェアの名前を検索した際に表示されるGoogle広告を攻撃起点として\nいます。\n\n下記画像のように、SteelCloverの悪性ファイル配布サイトへリダイレクトする悪性広告は正\n規サイトよりも上位に表示されており、ユーザが誤ってアクセスしてしまう恐れがありま\nす。このとき表示される悪性広告は改ざんされたWebサイトであると考えられます。\n\n悪性ファイル配布サイトは正規サイトをコピーして作成されており、見た目は正規サイトと\nほとんど変わりません。ダウンロードボタンをクリックすることで悪性ファイルがダウンロ\nードされます。\n\n\n-----\n\n悪性ファイルはMSIファイルであり、MSIファイルを実行することでPowerShellコードが実\n行されます。その結果、UrsnifとRedline Stealerがダウンロード・実行され、情報窃取が行\nわれます。\n\n## 悪性ファイル配布サイト\n\n悪性ファイルを配布するサイトは著名なソフトウェアのWebサイトを模して作成されていま\nす。SOCではこれまでに50種類以上SteelCloverによる悪性ファイル配布サイト（FakeGPG\nキャンペーンに限らず、別キャンペーンも含む）を確認しています。\n\n以前はAnyDeskやTeamViewerのようなリモートデスクトップツールや、SlackやMicrosoft\nTeamsのようなコミュニケーションツール、Adobe AcrobatやMozilla Thunderbirdのような\n業務上使用するようなソフトウェアのWebサイトが模倣されてきました。しかし、最近では\n幅広く著名なソフトウェアを模倣する傾向にあり、それらを予め想定することは難しくなっ\nてきています。\n\n\n-----\n\n## MSIファイル\n\nMSIファイルはメモリが4100MB以上ないと実行できないように制限が掛けられています。\nこれは解析・サンドボックス環境での動作を避けるためであると考えられます。\n\n\n-----\n\nMSIファイルは実行されると、Custom Action機能を用いてPowerShellコードを実行しま\nす。\n\nPowerShellコードは更に別のPowerShellコードをWebサイト上からダウンロード・実行しま\nす。\n\n\n-----\n\n## PowerShellコード\n\nMSIファイルによってダウンロード・実行されたPowerShellコードは、まず AddMpPreference コマンドを用いていくつかの拡張子やディレクトリ、プロセスをMicrosoft\nDefenderの除外設定に追加します。\n\n次に wget コマンドを用いてGPGファイルをダウンロードします。これは後述するGpg4Win\nを用いて復号され、最終的にUrsnifとRedline Stealerとなります。\n\nその後、正規のインストーラファイルをダウンロードし、実行します。ユーザから見ると、\n確かに正規のインストーラが実行されているため、悪性ファイルを開いてしまったことを自\n覚しにくくなっています。\n\nまた、先にダウンロードしたGPGファイルを復号するために、Gpg4Winがインストールさ\nれ、ファイルを復号します。\n\nこのときダウンロードされるGpg4Winは長期に渡って同一の非常に古いバージョンであり、\nかつHTTPでダウンロードするため、検知することは容易です。\n\n最後に、予めダウンロードしたNSudoを用いて、復号したUrsnifとRedline Stealerを実行し\nます。\n\n\n-----\n\n## 実行されるマルウェア\n\nPowerShellコードによって実行されるマルウェアのうち、rundll32.exeを用いて実行される\nZeip.dll はUrsnifです。Ursnifは元々バンキングトロジャンであり金融関連の情報窃取を目的\nとしてきましたが、現在SteelCloverが使用しているUrsnifはVNCのモジュールを使用してお\nり、端末へのアクセスを得るために使用されていると考えられます。\n\nPowerShellコードによって実行されるマルウェアのうち、Zeip.exe は .NET製のダウンロー\nダであり、実行されるとRedline Stealerをダウンロード・実行します。Redline Stealerは端\n末内に保存された機密情報を窃取します。\n\n## SteelCloverの背後\n\nSteelCloverはExploit Kitやマルウェアなどを独自で開発しているわけではなく、販売されて\nいるものを使用していますが、攻撃者はミスが多く、随所に攻撃者の特徴が反映されていま\nす。\n\n例えば、表面的なものであれば、Gpg4Winによってマルウェアを復号する際に使用されるパ\nスワードや、Redline StealerをダウンロードするZeip.exeで使用されている関数名などはロ\nシアを想起させます。これらは攻撃者が意図して自らそうしているわけですが、はじめから\nそうであったわけではなく、数カ月ほど前からその傾向が顕著となっています。\n\nまた、SteelCloverが管理する攻撃者インフラ（悪性ファイル配布サーバやマルウェア配布サ\nーバ）上で使われている言語や、攻撃者のミスで漏洩した様々な情報にもロシア由来のもの\nが多数含まれていました。これらのことから、SteelCloverはロシア語話者が関与している攻\n撃グループであると考えられます。\n\n## おわりに\n\nSteelCloverは数年前から活動している攻撃グループであり、現在ではGoogle広告経由で悪\n性ファイルを配布し、UrsnifやRedline Stealerに感染させています。日々積極的にアップデ\nートを続けており、度々日本でも観測されているため、今後も注意が必要です。\n\n## IoC\n\n\n-----\n\n47[.]251.52.170\n37[.]220.83.95\n5[.]178.2.159\n81[.]177.136.237\n81[.]177.6.46\n62[.]204.41.176\n\n## 参考文献\n\n[1] Malwarebytes, \"Malvertising campaigns come back in full swing\",\nhttps://www.malwarebytes.com/blog/news/2020/09/malvertising-campaigns-come-back-infull-swing\n\n[2] Malwarebytes, \"Malsmoke operators abandon exploit kits in favor of social engineering\nscheme\", https://www.malwarebytes.com/blog/news/2020/11/malsmoke-operators-abandonexploit-kits-in-favor-of-social-engineering-scheme\n\n[3] NTTセキュリティ・ジャパン, \"Crazy Journey: Evolution of Smoky Camouflage\",\n[https://jsac.jpcert.or.jp/archive/2022/pdf/JSAC2022_6_sawabe-tanabe_jp.pdf](https://jsac.jpcert.or.jp/archive/2022/pdf/JSAC2022_6_sawabe-tanabe_jp.pdf)\n\n[4] Check Point, \"Can You Trust a File’s Digital Signature? New Zloader Campaign exploits\nMicrosoft’s Signature Verification putting users at risk\",\nhttps://research.checkpoint.com/2022/can-you-trust-a-files-digital-signature-new-zloadercampaign-exploits-microsofts-signature-verification-putting-users-at-risk/\n\n[5] Mandiant, \"Zoom For You — SEO Poisoning to Distribute BATLOADER and Atera Agent\",\n[https://www.mandiant.com/resources/blog/seo-poisoning-batloader-atera](https://www.mandiant.com/resources/blog/seo-poisoning-batloader-atera)\n\n[6] Microsoft, \"DEV-0569 finds new ways to deliver Royal ransomware, various payloads\",\nhttps://www.microsoft.com/en-us/security/blog/2022/11/17/dev-0569-finds-new-ways-todeliver-royal-ransomware-various-payloads/\n\n[7] TrendMicro, \"Batloader Malware Abuses Legitimate Tools, Uses Obfuscated JavaScript\nFiles in Q4 2022 Attacks\", https://www.trendmicro.com/en_us/research/23/a/batloadermalware-abuses-legitimate-tools-uses-obfuscated-javasc.html\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-08 - SteelClover Attacks Distributing Malware Via Google Ads Increased.pdf"
    ],
    "report_names": [
        "2023-02-08 - SteelClover Attacks Distributing Malware Via Google Ads Increased.pdf"
    ],
    "threat_actors": [
        {
            "id": "cf4d333d-ef79-40aa-b233-886e6de875a3",
            "created_at": "2023-12-08T02:00:05.754609Z",
            "updated_at": "2025-03-27T02:00:03.266797Z",
            "deleted_at": null,
            "main_name": "DEV-0569",
            "aliases": [
                "Storm-0569"
            ],
            "source_name": "MISPGALAXY:DEV-0569",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1677809121,
    "ts_updated_at": 1743041410,
    "ts_creation_date": 1677662098,
    "ts_modification_date": 1677662098,
    "files": {
        "pdf": "https://archive.orkl.eu/d44b382f19b9770cb4374f9f1419070f5553a1d7.pdf",
        "text": "https://archive.orkl.eu/d44b382f19b9770cb4374f9f1419070f5553a1d7.txt",
        "img": "https://archive.orkl.eu/d44b382f19b9770cb4374f9f1419070f5553a1d7.jpg"
    }
}