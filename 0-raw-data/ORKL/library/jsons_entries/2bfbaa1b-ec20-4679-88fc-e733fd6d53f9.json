{
    "id": "2bfbaa1b-ec20-4679-88fc-e733fd6d53f9",
    "created_at": "2022-10-25T16:48:16.669662Z",
    "updated_at": "2025-03-27T02:16:49.025931Z",
    "deleted_at": null,
    "sha1_hash": "114583db8690cd01c60d5758dbe2e2dc1e96fb25",
    "title": "Operation Snowman: Deputydog Actor Compromises Us Veterans Of Foreign Wars Website",
    "authors": "FireEye",
    "file_creation_date": "2014-08-20T18:28:35Z",
    "file_modification_date": "2014-08-20T18:28:35Z",
    "file_size": 133462,
    "plain_text": "# Foreign Wars Website\n\nOn February 11, FireEye identified a zero-day exploit (CVE-2014-0322) being served up from the U.S.\n\nVeterans of Foreign Wars’ website (vfw[.]org). We believe the attack is a strategic Web compromise\n\ntargeting American military personnel amid a paralyzing snowstorm at the U.S. Capitol in the days leading\n\nup to the Presidents Day holiday weekend. Based on infrastructure overlaps and tradecraft similarities, we\n\nbelieve the actors behind this campaign are associated with two previously identified campaigns\n\n[(Operation DeputyDog and Operation Ephemeral Hydra).](http://www.fireeye.com/blog/technical/cyber-exploits/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html)\n\nThis blog post examines the vulnerability and associated attacks, which we have dubbed “Operation\n\nSnowMan.”\n\n## Exploit/Delivery analysis\n\nAfter compromising the VFW website, the attackers added an iframe into the beginning of the website’s\n\nHTML code that loads the attacker’s page in the background. The attacker’s HTML/JavaScript page runs a\n\nFlash object, which orchestrates the remainder of the exploit. The exploit includes calling back to the IE 10\n\nvulnerability trigger, which is embedded in the JavaScript. Specifically, visitors to the VFW website were\n\nsilently redirected through an iframe to the exploit at www.[REDACTED].com/Data/img/img.html.\n\n## Mitigation\n\nThe exploit targets IE 10 with Adobe Flash. It aborts exploitation if the user is browsing with a different\n\nversion of IE or has installed Microsoft’s Experience Mitigation Toolkit (EMET). So installing EMET or\n\nupdating to IE 11 prevents this exploit from functioning.\n\n## Vulnerability analysis\n\nThe vulnerability is a previously unknown use-after-free bug in Microsoft Internet Explorer 10. The\n\nvulnerability allows the attacker to modify one byte of memory at an arbitrary address. The attacker uses\n\nthe vulnerability to do the following:\n\nGain access to memory from Flash ActionScript, bypassing address space layout randomization\n\n(ASLR)\n\nPivot to a return-oriented programing (ROP) exploit technique to bypass data execution prevention\n\n(DEP)\n\n\n-----\n\nThe attacker uses the Microsoft.XMLDOM ActiveX control to load a one-line XML string containing a file\n\npath to the EMET DLL. Then the exploit code parses the error resulting from the XML load order to\n\ndetermine whether the load failed because the EMET DLL is not present. The exploit proceeds only if this\n\ncheck determines that the EMET DLL is not present.\n\n## ASLR bypass\n\nBecause the vulnerability allows attackers to modify memory to an arbitrary address, the attacker can use\n\nit to bypass ASLR. For example, the attacker corrupts a Flash Vector object and then accesses the\n\ncorrupted object from within Flash to access memory. We have discussed this technique and other ASLR\n\n[bypass approaches in our blog. One minor difference between the previous approaches and this attack is](http://www.fireeye.com/blog/technical/cyber-exploits/2013/10/aslr-bypass-apocalypse-in-lately-zero-day-exploits.html)\n\nthe heap spray address, which was changed to 0x1a1b2000 in this exploit.\n\n## Code execution\n\nOnce the attacker’s code has full memory access through the corrupted Flash Vector object, the code\n\nsearches through loaded libraries gadgets by machine code. The attacker then overwrites the vftable\n\npointer of a flash.Media.Sound() object in memory to point to the pivot and begin ROP. After successful\n\nexploitation, the code repairs the corrupted Flash Vector and flash.Media.Sound to continue execution.\n\n## Shellcode analysis\n\nSubsequently, the malicious Flash code downloads a file containing the dropped malware payload. The\n\nbeginning of the file is a JPG image; the end of the file (offset 36321) is the payload, encoded with an XOR\n\nkey of 0×95. The attacker appends the payload to the shellcode before pivoting to code control. Then,\n\nwhen the shellcode is executed, the malware creates files “sqlrenew.txt” and “stream.exe”. The tail of the\n\nimage file is decoded, and written to these files. “sqlrenew.txt” is then executed with the LoadLibraryA\n\nWindows API call.\n\n## ZxShell payload analysis\n\nAs documented above, this exploit dropped an XOR (0×95) payload that executed a ZxShell backdoor\n\n(MD5: 8455bbb9a210ce603a1b646b0d951bce). The compile date of the payload was 2014-02-11, and the\n\nlast modified date of the exploit code was also 2014-02-11. This suggests that this instantiation of the\n\nexploit was very recent and was deployed for this specific strategic Web compromise of the Veterans of\n\nForeign Wars website. A possible objective in the SnowMan attack is targeting military service members to\n\nsteal military intelligence. In addition to retirees, active military personnel use the VFW website. It is\n\nprobably no coincidence that Monday, Feb. 17, is a U.S. holiday, and much of the U.S. Capitol shut down\n\n\n-----\n\nThe ZxShell backdoor is a widely used and publicly available tool used by multiple threat actors linked to\n\ncyber espionage operations. This particular variant called back to a command and control server located at\n\nnewss[.]effers[.]com. This domain currently resolves to 118.99.60.142. The domain info[.]flnet[.]org also\n\nresolved to this IP address on 2014-02-12.\n\n## Infrastructure analysis\n\nThe info[.]flnet[.]org domain overlaps with icybin[.]flnet[.]org and book[.]flnet[.]org via the previous\n\nresolutions to the following IP addresses:\n\n58.64.200.178\n\n58.64.200.179\n\n103.20.192.4\n\nFirst Seen Last Seen CnC Domain IP\n2013-08-31 2013-08-31 icybin.flnet[.]org 58.64.200.178\n2013-05-02 2013-08-02 info.flnet[.]org 58.64.200.178\n2013-08-02 2013-08-02 book.flnet[.]org 58.64.200.178\n2013-08-10 2013-08-10 info.flnet[.]org 58.64.200.179\n2013-07-15 2013-07-15 icybin.flnet[.]org 58.64.200.179\n2014-01-02 2014-01-02 book.flnet[.]org 103.20.192.4\n2013-12-03 2014-01-02 info.flnet[.]org 103.20.192.4\n\nWe previously observed Gh0stRat samples with the custom packet flag “HTTPS” calling back to\n\n[book[.]flnet[.]org and icybin[.]flnet[.]org. The threat actor responsible for Operation DeputyDog also](http://www.fireeye.com/blog/technical/cyber-exploits/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html)\n\n[used the “HTTPS” version of the Gh0st. We also observed another “HTTPS” Gh0st variant connecting to](http://www.emc.com/collateral/hardware/solution-overview/h11146-the-voho-campaign-so.pdf)\n\na related command and control server at me[.]scieron[.]com.\n\nMD5 Hash CnC Domain\n758886e58f9ea2ff22b57cbbb015166e book.flnet[.]org\n0294f9280491f85d898ebe471f0fb58e icybin.flnet[.]org\n9d20566a327076b7152bbf9ed20292c4 me.scieron[.]com\n\nThe me[.]scieron[.]com domain previously resolved to 58.64.199.22. The book[.]flnet[.]org domain also\n\nresolved to another IP in the same subnet 58.64.199.0/24. Specifically, book[.]flnet[.]org previously\n\nresolved to 58.64.199.27.\n\nOthers domain seen resolving to this same /24 subnet were dll[.]freshdns[.]org, ali[.]blankchair[.]com,\n\nand cht[.]blankchair[.]com. The domain dll[.]freshdns[.]org resolved to 58.64.199.25. Both\n\nali[.]blankchair[.]com and cht[.]blankchair[.]com resolved to 58.64.199.22.\n\nFirst Seen Last Seen CnC Domain IP\n\n|First Seen|Last Seen|CnC Domain|IP|\n|---|---|---|---|\n|2013-08-31|2013-08-31|icybin.flnet[.]org|58.64.200.178|\n|2013-05-02|2013-08-02|info.flnet[.]org|58.64.200.178|\n|2013-08-02|2013-08-02|book.flnet[.]org|58.64.200.178|\n|2013-08-10|2013-08-10|info.flnet[.]org|58.64.200.179|\n|2013-07-15|2013-07-15|icybin.flnet[.]org|58.64.200.179|\n|2014-01-02|2014-01-02|book.flnet[.]org|103.20.192.4|\n|2013-12-03|2014-01-02|info.flnet[.]org|103.20.192.4|\n\n|MD5 Hash|CnC Domain|\n|---|---|\n|758886e58f9ea2ff22b57cbbb015166e|book.flnet[.]org|\n|0294f9280491f85d898ebe471f0fb58e|icybin.flnet[.]org|\n|9d20566a327076b7152bbf9ed20292c4|me.scieron[.]com|\n\n\n-----\n\n|2012-11-12 2012-04-09 2012-04-09|2012-11-28 2012-10-24 2012-09-18|me.scieron[.]com cht.blankchair[.]com ali.blankchair[.]com|58.64.199.22 58.64.199.22 58.64.199.22|\n|---|---|---|---|\n|2012-11-08|2012-11-25|dll.freshdns[.]org|58.64.199.25|\n|2012-11-23|2012-11-27|rt.blankchair[.]com|58.64.199.25|\n|2012-05-29|2012-6-28|book.flnet[.]org|58.64.199.27|\n\n\nA number of other related domains resolve to these IPs and other IPs also in this /24 subnet. For the\n\npurposes of this blog, we’ve chosen to focus on those domains and IP that relate to the previously\n\ndiscussed DeputyDog and Ephemeral Hydra campaigns.\n\nYou may recall that dll[.]freshdns[.]org, ali[.]blankchair[.]com and cht[.]blankchair[.]com were all linked\n\n[to both Operation DeputyDog and Operation Ephemeral Hydra. Figure 1 illustrates the](http://www.fireeye.com/blog/technical/cyber-exploits/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html)\n\ninfrastructure overlaps and connections we observed between the strategic Web compromise campaign\n\nleveraging the VFW’s website, the DeputyDog, and the Ephemeral Hydra operations.\n\n**Figure 1: Ties between Operation SnowMan, DeputyDog, and Ephemeral Hydra**\n\n## Links to DeputyDog and Ephemeral Hydra\n\nOther tradecraft similarities between the actor(s) responsible for this campaign and the actor(s)\n\nresponsible for the DeputyDog/Ephemeral Hydra campaigns include:\n\nThe use of zero-day exploits to deliver a remote access Trojan (RAT)\n\nThe use of strategic web compromise as a vector to distribute remote access Trojans\n\nThe use of a simple single-byte XOR encoded (0×95) payload obfuscated with a .jpg extension\n\nThe use of Gh0stRat with the “HTTPS” packet flag\n\nThe use of related command-and-control (CnC) infrastructure during the similar time frames\n\nWe observed many similarities from the exploitation side as well. At a high level, this attack and the CVE\n**2013-3163 attack both leveraged a Flash file that orchestrated the exploit, and would call back into IE**\n\nJavaScript to trigger an IE flaw The code within the Flash files from each attack are extremely similar\n\n\n-----\n\nsome identical functions with common typos, and even share the same name.\n\n## Conclusion\n\nThese actors have previously targeted a number of different industries, including:\n\nU.S. government entities\n\nJapanese firms\n\nDefense industrial base (DIB) companies\n\nLaw firms\n\nInformation technology (IT) companies\n\nMining companies\n\nNon-governmental organizations (NGOs)\n\nThe proven ability to successfully deploy a number of different private and public RATs using zero-day\n\nexploits against high-profile targets likely indicates that this actor(s) will continue to operate in the mid to\n\nlong-term.\n\n[This entry was posted in Advanced Malware, Exploits, Targeted Attack, Threat Research, Vulnerabilities](http://www.fireeye.com/blog/category/technical/malware-research)\n\n[and tagged 0day, zero-day by Darien Kindlund, Dan Caselden, Xiaobo Chen, Ned Moran and Mike Scott.](http://www.fireeye.com/blog/tag/0day)\n\n[Bookmark the permalink.](http://www.fireeye.com/blog/technical/cyber-exploits/2014/02/operation-snowman-deputydog-actor-compromises-us-veterans-of-foreign-wars-website.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/6uv4v8hpnfpka971qk0gd3j4mnm5x7mt",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.02.13_Operation_SnowMan/Operation_SnowMan.pdf"
    ],
    "report_names": [
        "Operation_SnowMan"
    ],
    "threat_actors": [
        {
            "id": "2150d1ac-edf0-46d4-a78a-a8899e45b2b5",
            "created_at": "2022-10-25T15:50:23.269339Z",
            "updated_at": "2025-03-27T02:00:55.416524Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "APT17",
                "Deputy Dog"
            ],
            "source_name": "MITRE:APT17",
            "tools": [
                "BLACKCOFFEE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1edcac0b-efd9-47b1-9aca-33827d5bd085",
            "created_at": "2024-05-01T02:03:07.964773Z",
            "updated_at": "2025-03-27T02:05:17.273595Z",
            "deleted_at": null,
            "main_name": "BRONZE KEYSTONE",
            "aliases": [
                "Aurora Panda ",
                "DeputyDog ",
                "Group 72 ",
                "Hidden Lynx ",
                "Shell Crew",
                "TG-8153 ",
                "Tailgater Team",
                "APT17 "
            ],
            "source_name": "Secureworks:BRONZE KEYSTONE",
            "tools": [
                " BlackCoffee",
                " DeputyDog",
                " Derusbi",
                " Gh0stHTTPSDropper",
                " HiKit",
                " InternalCMD",
                " PlugX",
                " PoisonIvy",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "86fd71d3-06dc-4b73-b038-cedea7b83bac",
            "created_at": "2022-10-25T16:07:23.330793Z",
            "updated_at": "2025-03-27T02:02:09.740703Z",
            "deleted_at": null,
            "main_name": "APT 17",
            "aliases": [
                "APT 17",
                "ATK 2",
                "Beijing Group",
                "Bronze Keystone",
                "Deputy Dog",
                "Elderwood",
                "Elderwood Gang",
                "Operation Aurora",
                "Operation DeputyDog",
                "Operation Ephemeral Hydra",
                "Operation RAT Cook",
                "SIG22",
                "Sneaky Panda",
                "TEMP.Avengers",
                "TG-8153",
                "Tailgater Team"
            ],
            "source_name": "ETDA:APT 17",
            "tools": [
                "9002 RAT",
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "Briba",
                "Chymine",
                "Comfoo",
                "Comfoo RAT",
                "Darkmoon",
                "DeputyDog",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Jumpall",
                "Kaba",
                "Korplug",
                "Linfo",
                "MCRAT.A",
                "McRAT",
                "MdmBot",
                "Mdmbot.E",
                "Moudour",
                "Mydoor",
                "Naid",
                "Nerex",
                "PCRat",
                "PNGRAT",
                "Pasam",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Naid",
                "Vasport",
                "Wiarp",
                "Xamtrav",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041809,
    "ts_creation_date": 1408559315,
    "ts_modification_date": 1408559315,
    "files": {
        "pdf": "https://archive.orkl.eu/114583db8690cd01c60d5758dbe2e2dc1e96fb25.pdf",
        "text": "https://archive.orkl.eu/114583db8690cd01c60d5758dbe2e2dc1e96fb25.txt",
        "img": "https://archive.orkl.eu/114583db8690cd01c60d5758dbe2e2dc1e96fb25.jpg"
    }
}