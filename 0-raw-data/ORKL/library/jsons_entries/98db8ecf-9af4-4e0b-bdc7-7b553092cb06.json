{
    "id": "98db8ecf-9af4-4e0b-bdc7-7b553092cb06",
    "created_at": "2023-01-12T15:09:05.05067Z",
    "updated_at": "2025-03-27T02:08:41.417467Z",
    "deleted_at": null,
    "sha1_hash": "c184d4b792017626267b8e3919de612c99224653",
    "title": "2014-01-21 - Digitally signed data-stealing malware targets Mac users in “undelivered courier item” attack",
    "authors": "",
    "file_creation_date": "2022-05-27T23:27:37Z",
    "file_modification_date": "2022-05-27T23:27:37Z",
    "file_size": 1073494,
    "plain_text": "# Digitally signed data-stealing malware targets Mac users in “undelivered courier item” attack\n\n**[nakedsecurity.sophos.com/2014/01/21/data-stealing-malware-targets-mac-users-in-undelivered-courier-item-attack/](https://nakedsecurity.sophos.com/2014/01/21/data-stealing-malware-targets-mac-users-in-undelivered-courier-item-attack/)**\n\nBy Paul Ducklin 21 Jan 2014\n\nOur colleagues at SophosLabs pointed us at a interesting item of malware the other day,\nnamely a data-stealing Trojan aimed at Mac users.\n\nIn fact, it was somewhat more than that: it was one of those “undelivered courier item” emails\nlinking to a dodgy web server that guessed whether you were running Windows or OS X, and\ntargeted you accordingly.\n\nYou’re probably familiar with “undelivered item” scams.\n\nThe idea is surprisingly simple: you receive an email that claims to be a courier company that\nis having trouble delivering your article.\n\nIn the email is a link to, or an attachment containing, what purports to be a tracking note for\nthe item.\n\nYou are invited to review the relevant document and respond so that delivery can be\ncompleted.\n\n\n-----\n\n[We ve seen a wide variety of courier brands borrowed for this purpose, including DHL, the](http://nakedsecurity.sophos.com/2011/08/18/trojans-spammed-out-in-malicious-wave-of-fake-dhl-emails/)\nUK’s [Royal Mail and even, in one bewildering case,](http://nakedsecurity.sophos.com/2011/10/18/that-package-at-the-royal-mail-office-its-malware/) [a made-up courier company called](http://nakedsecurity.sophos.com/2012/11/15/tns24-courier-company/)\nTNS24, with its very own website, featuring its very own amusingly ill-Photoshopped planes,\nships and automobiles.\n\nBut a competently-executed courier scam can be fairly convincing, especially if the criminals\nbehind it know enough about you to create what becomes a targeted attack.\n\nEven a modest amount of detail (if that is not an oxymoron) can do the trick.\n\nFor example, the crooks will sound a lot more believable if they know your address and\nphone number; are aware of what you do in your job; and have a general idea about some of\nthe projects you are working on right now.\n\nOf course, if you open the attachment or click on the link in one of these scams, you are\nimmediately put into harm’s way: the attachment might try to trigger an exploit in your\nunpatched copy of Word, for instance, or the link might attack an unpatched Java plugin in\nyour browser.\n\nHere’s what the emails looked like in this attack, with some details changed or redacted for\nsafety:\n\n\n-----\n\n```\n  We wish to inform you that we have a pending parcel for the past\n  10 days bearing your name Mr. Jonathan Sidebottom,with parcel\n  number (MV-45-QA566). The parcel was sent for delivery on the\n  below mentioned address but nobody was there to receive it. Your\n  parcel content has a set of engineering documents, which was\n  discovered during our security checks of parcels brought into\n  our head office. So, we are sending you a scanned copy of that\n  parcel. Give your positive response, if it belongs to you.\n\n```\nIf you are a native speaker of English, you will notice that the wording of the email is clumsy\nand unidiomatic, and if you were to receive a message like this you might well be suspicious\non those grounds alone.\n\nBut if Mr Sidebottom really is in the engineering business, and regularly deals with inbound\ndocuments from courier companies around the world, an email of this sort could easily pass\nmuster.\n\nThe link, of course, doesn’t really lead to fedex.com.ch, but instead takes you to a\ndomain name that is controlled by the attackers.\n\nIf you are on a mobile device, the server delivers an error message.\n\nIf you are using a desktop browser that isn’t Safari, you receive a ZIP file containing a\nWindows program detected by Sophos Anti-Virus as Mal/VBCheMan-C, a vague relative of\nthe Zbot or Zeus malware.\n\nBut if you are using Safari, you receive Mac malware, delivered as an Application bundle\npackaged inside a ZIP file.\n\nBy default, on OS X 10.9.1 (the latest update to Mavericks, Apple’s most recent operating\nsystem version), Safari directly downloads the file, showing you an empty Safari window with\nthe icon of the downloaded file in the Dock at the bottom of the screen:\n\n\n-----\n\nClicking on the download button shows you what looks like a PDF file:\n\nThere is no PDF file, as a visit to the Terminal windows quickly reveals.\n\nSafari has automatically unzipped the download, producing an Application bundle (actually\njust a subdirectory tree with a special structure) that has deliberately been given a PDF icon:\n\n\n-----\n\nAs you can imagine, the temptation is to click on what looks like a PDF file to see what it\ncontains.\n\nOS X does try to advise you that you aren’t opening a document, although you can argue\nthat the warning would be more compelling if it explicitly said that you were about to “run a\nsoftware program”, rather than merely to “open” the file:\n\nNote that you don’t get a warning about the App being from an “unknown developer”\n[because it is digitally signed, something that happens surprisingly often with modern](http://nakedsecurity.sophos.com/2013/02/27/targeted-attack-nvidia-digital-signature/)\nmalware.\n\n→ The quantity of digitally-signed malware in circulation prompted Microsoft, which sees a\nlot more malware than Apple, to publish a recent blog post with the uncompromising title “Be\na real security pro – Keep your private keys private.” In that article, Microsoft documents a\nmalware family it calls “Winwebsec” of which it has more than 15,000 digitally-signed\nsamples, signed with 12 different stolen keys.\n\nIf you do click the [Open] button, nothing seems to happen: you end up back at the\ndesktop with your email software open and an empty Safari window in front of it.\n\nBut a trip back to the Terminal shows that what looked like a PDF file is now running in the\nbackground as a process named foung:\n\n\n-----\n\nAs it happens, foung, like its counterpart delivered to Windows computers, is a bot, short\nfor “robot malware”, detected by Sophos Anti-Virus as OSX/LaoShu-A.\n\nLaoShu-A as good as hands control of your Mac over to the attackers, but its primary\nfunctions appear to be more closely associated with data stealing than with co-opting you\ninto a traditional money-making botnet.\n\n(You will often hear the term RAT, or Remote Access Trojan, rather than the more common\nterm bot, used to describe this sort of malware.)\n\nIn other words, the attackers seem more concerned with digging around on your computer\nfor what they can steal than with abusing your computer and your internet connection to aid\nand abet other cybercriminal activities.\n\nAmongst other things, LaoShu-A contains code to:\n\nSearch for files with extensions such as DOC, DOCX, XLS, XLSX, PPT and PPTX.\nZIP those files.\nUpload (exfiltrate) them to a server operated by the attackers.\n\nHowever, this RAT also knows how to:\n\nDownload new files.\nRun arbitrary shell commands.\n\nFor example, during our tests, LaoShu-A downloaded a second application that took a\nscreenshot with OS X’s built-in screencapture command, and tried to exfiltrate the\nimage it had just grabbed.\n\n\n-----\n\nBut the behaviour of that second application can be varied by the attackers at any time,\nwhich is why, in our recent podcast, _[Understanding botnets, SophosLabs expert James](http://nakedsecurity.sophos.com/2014/01/09/sophos-techknow-understanding-botnets-podcast/)_\nWyke warned as follows:\n```\n  Without analysing the full network capture of the entire\n  interchange between a bot and the person controlling it, you\n  can't say for sure exactly what that bot might have done... [it]\n  might go and download some completely different piece of malware\n  which carries out a completely different set of functionality.\n\n```\nJames went on to recommend:\n```\n  Be more suspicious of things you get in e-mail. E-mail is still\n  one of the most common ways people get infected, and it is\n  predominantly through social engineering attacks... So when you\n  receive an e-mail from someone you've never heard of before, or\n  you've never communicated with before, and there's some\n  interesting attachment to the e-mail or [a link to click],\n  ...don't do that! That's one of the that most common ways people\n  get infected.\n\n```\n[(Audio player not working? Listen on Soundcloud.)](https://soundcloud.com/sophossecurity/sophos-techknow-understanding-botnets)\n\nLet’s hope this malware reminds OS X users of a few simple truths that some Mac fans still\nseem willing to ignore:\n\nMac malware is unusual, but not impossible.\nData thieves are interested in what Mac users have on their computers.\nMalware writers can often get their hands on digital certificates to give software to give\nit a veneer of respectability and to bypass operating system warnings.\nMac malware doesn’t have to ask for a password before running.\nMac malware can run directly from a download without an installation step.\nBots and RATs are particularly pernicious because they can update and adapt their\nbehaviour after you are infected.\n\nAs always, prevention is better than cure.\n\nAnd that “undelivered courier item” almost certainly doesn’t exist.\n\n**Free: Sophos Anti-Virus for Mac Home Edition**\n\n[Sophos for Mac stops threats for Windows and Mac alike, protecting you and those you](http://www.sophos.com/en-us/products/free-tools/sophos-antivirus-for-mac-home-edition.aspx)\nshare files with.\n\n\n-----\n\nChoose from blocking viruses in real time (on-access protection), scanning at scheduled\ntimes, or running a check whenever you want.\n\nFree download, no registration required, no expiry date.\n\n_Image of_ _[forklift courtesy of](http://www.shutterstock.com/pic.mhtml?id=2153445)_ _[Shutterstock.](http://www.shutterstock.com/)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-01-21 - Digitally signed data-stealing malware targets Mac users in “undelivered courier item” attack.pdf"
    ],
    "report_names": [
        "2014-01-21 - Digitally signed data-stealing malware targets Mac users in “undelivered courier item” attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536145,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653694057,
    "ts_modification_date": 1653694057,
    "files": {
        "pdf": "https://archive.orkl.eu/c184d4b792017626267b8e3919de612c99224653.pdf",
        "text": "https://archive.orkl.eu/c184d4b792017626267b8e3919de612c99224653.txt",
        "img": "https://archive.orkl.eu/c184d4b792017626267b8e3919de612c99224653.jpg"
    }
}