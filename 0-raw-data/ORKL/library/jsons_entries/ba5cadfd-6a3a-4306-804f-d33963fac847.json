{
    "id": "ba5cadfd-6a3a-4306-804f-d33963fac847",
    "created_at": "2023-01-12T15:06:05.530516Z",
    "updated_at": "2025-03-27T02:08:41.067701Z",
    "deleted_at": null,
    "sha1_hash": "2d54cb97fc9eae9320eb6b599f5a1c3331da90a4",
    "title": "2021-08-31 - Attracting flies with Honey(gain)- Adversarial abuse of proxyware",
    "authors": "",
    "file_creation_date": "2022-05-27T21:58:38Z",
    "file_modification_date": "2022-05-27T21:58:38Z",
    "file_size": 4718138,
    "plain_text": "# Attracting flies with Honey(gain): Adversarial abuse of proxyware\n\n**[blog.talosintelligence.com/2021/08/proxyware-abuse.html](https://blog.talosintelligence.com/2021/08/proxyware-abuse.html)**\n\n_By_ _[Edmund Brumaghin and](https://twitter.com/b4n1shed)_ _[Vitor Ventura.](https://twitter.com/_vventura)_\n\nWith internet-sharing applications, or \"proxyware,\" users download software that allows\nthem to share a percentage of their bandwidth with other internet users for a fee, with\nthe companies that created this software acting as a go-between.\n\n\n-----\n\nAs proxyware has grown in popularity, attackers have taken notice and are now\nattempting to exploit this interest to monetize their malware campaigns.\nMalware is currently leveraging these platforms to monetize the internet bandwidth of\nvictims, similar to how malicious cryptocurrency mining attempts to monetize the CPU\ncycles of infected systems.\nIn many cases, these applications are featured in multi-stage, multi-payload malware\nattacks that provide adversaries with multiple monetization methods.\nTrojanized installers are some of the most common threats taking advantage of public\ninterest in proxyware to infect victims.\nThese applications pose significant privacy and operational risks to organizations as\nthey may allow nefarious or abusive network traffic to appear as if it originates from\ntheir corporate networks resulting in reputational damages that may also lead to\nservice disruption.\n\n## What's new?\n\nAdversaries are finding new ways to monetize their attacks by abusing internet-sharing, or\n\"proxyware\" platforms like Honeygain, Nanowire, and others. This poses new challenges to\norganizations, especially to those whose internet access is rated as residential. But any\norganization could be at risk, as there are platforms that also allow data center-based\ninternet sharing.\n\n## How did it work?\n\nMalicious actors are taking multiple avenues to monetize these new platforms in their favor.\nThe most obvious one is the silent installation of the platform client to \"sell\" the victim's\nbandwidth without their knowledge. In some cases, the adversaries patch the client to stop\nany alerts that would warn the victim. As these platforms became more popular, the\nadversaries started to leverage trojanized installers, which install the legitimate platform\nclient as well as digital currency miners and information stealers. Given the nature of\nproxyware services, the users expect that their performance will suffer, making it a perfect\ndisguise for coin miners.\n\nCisco Talos also identified a malware family that will deploy a complete set of monetization\nmethods — it drops a patched version of the Honeygain client, an XMRig miner and an\ninformation stealer. On top of that, it seems to be evolving to also deploy a Nanowire client,\nanother one of these proxyware applications.\n\n## So what?\n\n\n-----\n\nOrganizations should be aware of these applications, how they work, and how they are being\ntaken advantage of, as they may pose a significant risk to corporate environments. Users'\nbandwidth can be sold to platform customers to access the internet, while the actions\nperformed by them over this access are logged to the organization's IP address. This is a\nrecent trend, but the potential to grow is enormous. We are already seeing serious abuse by\nthreat actors that stand to make a significant amount of money off these attacks. These\nnetworks may also allow threat actors to obfuscate the source of their attacks, making them\nappear as if they are originating from legitimate corporate networks. Security analysts could\nstruggle to analyze and/or respond to these attacks and render conventional network\ndefenses that rely on reputation or IP-based blocklists ineffective. Some users or\norganizations could even eventually become wrapped up in part of a law enforcement\ninvestigation if their infrastructure is used for illicit or illegal purposes.\n\n## Introduction to proxyware\n\nProxyware platforms enable users to sell the use of their unused internet bandwidth, typically\nby running a client application. The client application is responsible for joining their system to\na network that is operated by the platform provider. The provider then sells access to this\nnetwork and routes customer traffic through the network, allowing their customers to access\nthe internet using the bandwidth and internet connections provided by nodes on the network.\nIn many cases, this type of service is advertised as a way for marketing organizations to\naccess resources from residential networks in a variety of geographic regions to test\npotential campaigns and circumvent network restrictions. For the home users, this is\nadvertised as a means to circumvent geolocation checks on streaming or gaming platforms\nwhile generating some income for the user offering up their bandwidth. Many of these\nplatforms have emerged in recent years, including Honeygain, IPRoyal Pawns, Nanowire,\nPeer2Profit and PacketStream, though there are likely several more.\n\n### What could possibly go wrong?\n\nIn many cases, the users of these platforms are either not aware of the operational or privacy\nimplications of running these clients on their systems/networks, or they simply view the\nearnings potential as outweighing the perceived costs associated with granting the use of\ntheir resources to random entities. In either case, the use of these platforms introduces risks\nthat may not be immediately apparent to many people.\n\nMost obviously, there are privacy implications for entities who purchase and use the\nnetworks provided by these platforms. In the case of the Honeygain platform, because of the\nway the communications are processed to facilitate the retrieval and delivery of content, it\n\n\n-----\n\nmay be possible to monitor the DNS activity of other platform users. Unencrypted content\nthat is retrieved (like HTTP) could be intercepted and manipulated in transit by Honeygain\nnodes under adversarial control, creating a range of plausible attack scenarios.\n\nSince these platforms allow external entities to make direct use of users' network\nconnections, this results in network traffic that appears to originate from these users'\nnetworks. The use of this communications pathway for illegal or illicit purposes could create\nlegal liability for unsuspecting platform users. In some cases, we observed users reporting\nthat their home networks were experiencing service degradation due to being blocked from\naccessing various internet resources after installing these client applications.\n\nPost on Honeygain subreddit.\n\nWhile it is unclear if this was the direct result of nefarious traffic traversing the connectivity\npathway provided by these platforms, it is reasonable to assume that there are\ncircumstances where abusive traffic generated by these clients could lead to this scenario. It\nwas not uncommon to see these reports when researching the user communities associated\nwith these platforms.\n\nWe also observed several instances of Honeygain users claiming to maximize their profits by\ninstalling the software on relatives and/or acquaintances' computers, thus transferring these\nsame risks to those individuals.\n\nPost on Honeygain subreddit.\n\nIn situations where malware is used to covertly install these applications on victim systems\nas part of an attacker's monetization strategy, this could also lead to direct financial losses in\n\n\n-----\n\ncases where the victim is on a limited data plan and is forced to pay overages or other fees\nto cover the excess bandwidth used by the proxyware application.\n\nSome users are also reportedly installing these clients on computers at their workplaces.\nNow that many organizations are using a hybrid work model, these applications may\nintroduce many of the same risks to organizational environments if these applications are\ninstalled on employees' devices.\n\nPost on Honeygain subreddit.\n\nIn some instances, this is actively encouraged by the platform providers themselves. Below\nis a screenshot from the FAQs for one proxyware platform provider.\n\nPeer2Profit FAQs.\n\nEndpoints in corporate environments running these applications could create a situation\nwhere abusive traffic appears to originate from the corporate network and may result in\nadverse reputational effects, leading to operational issues such as corporate networks\nending up on reputation-based blocklists. Likewise, these applications effectively establish a\ntunneled communications pathway between an external entity and an endpoint on an internal\nnetwork segment that may circumvent conventional perimeter-based inspection and threat\n\n\n-----\n\ndetection capabilities. Abuse of the client application itself could also lead to the successful\ncompromise of systems located inside corporate networks.\n\nAdversaries may also take advantage of this network model by conducting their attacks\nusing the network created by proxyware platforms. This could result in their attacks\nappearing as if they were originating from various residential networks around the world, and\nmay make analyzing and responding to attacks more difficult. The same mechanisms\ncurrently used to monitor and track Tor exit nodes, \"anonymous\" proxies, and other common\ntraffic obfuscation techniques do not currently exist for tracking nodes within these proxyware\nnetworks.\n\n### How widespread is proxyware?\n\nThis business model has become increasingly attractive to users, as it provides a way for\nthem to generate passive income with their unused network bandwidth. The subscriber\ngrowth of the Honeygain subreddit provides a good visual representation of this trend.\n\n[One proxyware platform, Peer2Profit, claims to have enrolled roughly 55,000 users on the](https://peer2profit.com/)\nplatform.\n\n\n-----\n\nHoneygain, one of the most popular proxyware platforms, recently released the details of a\n2021 User Experience and Awareness Survey. In their report, they claim to have received\napproximately 250,000 survey responses from Honeygain users, which it reports is 16 times\nmore than those it received in 2020.\n\nInvestigating DNS activity associated with the API used by the Honeygain client, we\nidentified a large number of queries being performed. This is another indicator that clearly\ndemonstrates the popularity of this platform across the internet.\n\n\n-----\n\nThe majority of the systems observed resolving the domain associated with the Honeygain\nAPI were located in Brazil, however, activity was observed across many other countries, as\nwell.\n\nUsers aren't the only ones who have taken notice of these relatively new platforms. Threat\nactors have also set their sights on finding ways to leverage these same platforms to\nmonetize their malware attacks.\n\n\n-----\n\nAs most of these platforms function differently, we will focus the majority of the analysis in\n[this blog on one of the most popular ones, Honeygain. While this post focuses on threats](https://www.honeygain.com/)\ntargeting the Windows platform, Honeygain also offers an Android client, which behaves\nsimilarly to the Windows client. At the time of writing, we did not identify any cases where the\nAndroid client was being used nefariously or otherwise abusing users' devices.\n\n## Malware campaigns\n\nDuring our analysis of malicious activity associated with proxyware applications, we identified\nseveral methods adversaries are using to increase the effectiveness of their malware\ncampaigns. Throughout the course of this research, we identified a variety of different\nmalware families being distributed under the guise of legitimate installers for applications like\nHoneygain. These trojanized installers enable adversaries to distribute threats like RATs,\ninformation stealers, and other malware to victims who believe they are installing legitimate\napplications.\n\nIn other cases, threat actors are distributing the proxyware applications to monetize victims'\nnetwork bandwidth for the purposes of generating revenue. We also observed malware that\nattempted to leverage victims' CPU resources for mining cryptocurrency, while at the same\ntime also monetizing their network bandwidth using proxyware applications. The following\nsections provide analysis of a few of the most interesting campaigns we've discovered.\n\n## Trojanized Installers\n\nOne of the most common techniques we observed was the use of legitimate installers as\ndecoy programs included alongside other malicious components. In these attacks, threat\nactors are distributing malicious executables that pose as installers for legitimate proxyware\napplications like Honeygain. When executed, they will typically install the legitimate\napplication, while also silently installing malware.\n\nIn one example, an attacker was distributing cryptocurrency mining malware under the guise\nof a Honeygain installer. The initial malware dropper was an installer bundle that was created\nusing Smart Install Maker. The bundle contained a legitimate, signed Honeygain installation\npackage along with the malware. The malware featured a multi-stage infection process and\nrelied on the use of multiple distinct components, as shown below.\n\n\n-----\n\n### Initial installation\n\nWhen executed, the installer bundle extracts various components into the %TEMP%\ndirectory on the system, then executes the legitimate Honeygain installer, which is what is\ndisplayed to the victim. At the same time, the installer also silently creates and executes\nvarious components required for the malware's operation.\n\nThe main Honeygain program directory used during the installation process is located at:\n```\nC:\\Program Files (x86)\\HG\\Honey gain\\\n\n```\nThe malware stores two malicious files — setup_x86.exe and url.vbs — in this same\ndirectory.\n\nThe malware also creates a working directory at\n_C:\\ProgramData\\Microsoft\\Windows\\intelx86_driver and writes the main cryptocurrency_\nmining dropper (iv.exe) into this directory. This payload is then executed by the installer to\nrun the payload and start the mining process.\n\n\n-----\n\nThe VBScript file (url.vbs) is also executed by the initial installer process and is used to\nlaunch a web browser on the infected system and redirect the victim to a landing page\nassociated with a Honeygain referral code, presumably tied to the malware author's account.\nThe VBScript associated with this operation is below:\n\nWhen this is executed, the victim is taken to the landing page associated with the Honeygain\nreferral code. This provides another mechanism that an attacker can use to monetize\ninfections by allowing them to generate revenue for each victim who uses the landing page\nto sign up for a Honeygain account.\n\nThe initial installer then executes setup_x86.exe, which is used to achieve persistence and\n_iv.exe — the cryptocurrency mining component — before terminating execution._\n\n### Additional installation & persistence\n\nAdditional setup and installation tasks are performed by setup_x86.exe. It first invokes the\n\n\n-----\n\nWindows Service Configuration Tool (sc.exe) to stop and delete a Windows service called\n\"Wwanip\" using the following command-line syntax:\n```\n\"C:\\Windows\\System32\\sc.exe\" stop Wwanip\n\"C:\\Windows\\System32\\sc.exe\" delete Wwanip\n\n```\nIt then creates a directory structure under \"C:\\Users\\SYSTEM\" and stores the following\ncomponents:\n```\nC:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\sysdll.exe\nC:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\vxml.xml\nC:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\ixml.xml\nC:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\sc.md\n\n```\nThen, it creates an executable at the following location:\n```\nC:\\ProgramData\\Microsoft\\Windows\\intelx86_driver/service.exe\n\n```\nNext, the malware uses two Scheduled Tasks and a Windows Service to achieve persistence\non the victim machine.\n\nThe first scheduled task is created using an XML configuration via the following syntax:\n```\n\"C:\\Windows\\System32\\schtasks.exe\" /create /xml\n\"C:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\vxml.xml\" /tn\n\"Desktop Windows Manager Adapter For Microsoft Windows\" /ru \"system\"\n\n```\nThe XML configuration instructs the scheduled task to execute\n_C:\\ProgramData\\Microsoft\\Windows\\intelx86_driver\\intel_vga.exe at system startup, allowing_\npersistence across system reboots.\n\nA second scheduled task is then created, which uses another XML configuration via the\nfollowing syntax:\n```\n\"C:\\Windows\\System32\\schtasks.exe\" /create /xml\n\"C:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\ixml.xml\" /tn\n\"Virtual Disk Manager Adapter For Microsoft Windows\" /ru \"system\"\n\n```\nThe XML configuration file associated with this scheduled task defines a series of time-based\ntriggers that are used to execute\n_C:\\ProgramData\\Microsoft\\Windows\\intelx86_driver\\service.exe on the following schedule:_\n\nFinally, a new Windows service is created and configured to start automatically at system\nboot. The service is then immediately started. This new service is created using the following\n\n\n-----\n\ncommand:\n```\n\"C:\\Windows\\System32\\sc.exe\" create Wwanip binPath=\n\"C:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\sysdll.exe\"\nstart= auto\n\n```\nThe service.exe mentioned previously is effectively a copy of setup_x86.exe. It drops the\nsame files and creates the same scheduled tasks. The main difference is that service.exe is\npacked with a non-standard version of Smart Install Maker.\n\nThe setup_x86.exe process also creates an uninstall executable and its INI file at the\nfilesystem path \"C:\\Program Files (x86)\\Microsoft Corporation\\Microsoft Visual C++ 2013\n_Redistributable (x86) - 19.1.30\" just as a legitimate installer package would._\n\n### Update mechanism\n\nAs previously described, during the malware installation process, persistence is achieved for\n_C:\\Users\\SYSTEM\\AppData\\Roaming\\Intel\\Graphics_driver\\Graphics_driver\\sysdll.exe via_\nthe creation of a Windows service called \"Wwanip.\"\n\nThis service invokes a .NET executable that is responsible for retrieving updates from the\ncommand and control (C2) and using the contents returned from the server to overwrite\npreviously saved malware components. This mechanism is likely used to ensure that the\nmalware is periodically updated with the latest version available. The executable contains\ntwo primary functions — OnStart() and OnTimer() — that facilitate this process.\n\nAs seen above, the OnStart() function is responsible for retrieving additional data from the\nC2 and copying the returned data to\n\n\n-----\n\n_C:\\ProgramData\\Microsoft\\Windows\\intelx86_driver\\intel_vga.exe, likely as a way to ensure_\nthat the most recent version of the malware continues to run on previously infected systems.\n\nThe OnTimer() function operates similarly, however it is also responsible for ensuring that the\nservices.exe file is also present on the system in the case that it is removed or otherwise\nunavailable.\n\nBelow is a screenshot showing an example of the HTTP request made by the sysdll.exe\nprocess for the purpose of requesting the latest version of the malware.\n\nAt the time of analysis, the C2 was no longer active. However, historical data shows that the\nC2 was previously responding with binary contents to client requests for this URL. The binary\ndelivered in these cases matches the cryptocurrency mining component initially dropped\nonto the system (iv.exe) and operates as described in the following section.\n\n### Cryptocurrency miner payload\n\nThe main cryptocurrency mining payload (iv.exe) is created and executed during the initial\ninstallation process described earlier. Another copy (intel_vga.exe) is also periodically\nretrieved from C2 as described in the previous section enabling it to persist across reboots\nvia a Scheduled Task.\n\nIt is a .NET executable that includes two encrypted resources.\n\nDuring execution, these resources are retrieved and decrypted using a function called\nAES_Decryptor().\n\n\n-----\n\nOne of the resources is responsible for injecting the final cryptocurrency mining payload\n(XMRig) into a remote process, in this case associated with svchost.exe.\n\nIn this example, XMRig is executed using the following parameters:\n```\nC:\\Windows\\System32\\svchost.exe -B --donate-level=1 -a null -o heartsbeat[.]gq:3333 u user -p coucou -o gulf[.]moneroocean[.]stream:10004 -u\n45dLToERxNfcTR3AH2tJmr3xP3wuDyeap9UTaH5EtMHyB9zEeUN9XMo6PMdHFGjNkKgPKiAGZeQjtbVWLML3J6\n -p Homerig --opencl -t 2 --cpu-max-threads-hint=60\n\n```\nInvestigating the mining pool being used, it does not appear that this campaign has been\nvery successful thus far, as only about 2.19 XMR have been paid out at the time of this\nwriting.\n\nAs proxyware applications become more popular, we will likely see many more examples of\nmalware leveraging legitimate installers as part of their malware to convince victims to infect\ntheir systems.\n\n## Honeygain botnets?\n\nIn addition to malware that leverages proxyware applications as decoys during the infection\nprocess, we identified malware that attempts to install Honeygain and register the newly\n\n\n-----\n\ninstalled client with the attacker s Honeygain account, allowing them to monetize bandwidth\n[on infected systems. While Honeygain limits the number of devices operating under a single](https://honeygain.zendesk.com/hc/en-us/articles/360011188779-What-is-the-maximum-number-of-devices-allowed-by-Honeygain-)\naccount, there is nothing to stop an attacker from registering multiple Honeygain accounts to\nscale their operation based on the number of infected systems under their control.\n\nIn one example, we identified an attacker attempting to do just that. In this case, the initial\nmalicious executable contained three resources that were Base64 encoded. An example of\none of these resources is shown below.\n\nThese three resources correspond to the following components used by the malware.\n\nThe main program executable associated with the application 7-Zip.\nA DLL used by the 7-Zip application.\nA ZIP archive containing a copy of the Honeygain program directory from a previously\ninstalled system.\n\nWhen the initial binary is executed, it is responsible for extracting these resources and\ncreating a working directory called \"Winint\" within %APPDATA% on the system. The 7-Zip\napplication and DLL are then stored inside of this directory. The ZIP archive is extracted\nusing the following syntax:\n```\n%APPDATA%\\Winint\\Winint\\7z.exe e %APPDATA%\\Winint\\Winint\\winint.zip -o\n%APPDATA%\\Winint\\Winint -y\n\n```\nAn executable stored in this directory (winint32.exe) is then executed, which launches the\nHoneygain application. This binary appears to be a modified copy of the legitimate .NET\nexecutable associated with Honeygain v.0.6.4.0. Some of the design elements have been\nremoved to prevent the main application from being displayed to victims.\n\nThe main() function of the application has been modified to allow persistence to be achieved\non infected systems to ensure that the Honeygain application is executed at system boot as\nwell as every minute if it is terminated for any reason. A comparison view of the normal\nmain() function and the one included in the malicious executable can be seen below.\n\n\n-----\n\nThe executable also includes hardcoded credentials that are used to authenticate to the\nHoneygain API when the application is run, allowing the victim's system to be associated\nwith an existing Honeygain account. The following screenshot shows this modification to the\nHoneygain application.\n\n\n-----\n\nThis activity can also be observed by intercepting and inspecting the API communications\nfrom an infected system. In this case, it appears that the Honeygain account has already\nexceeded the total number of clients allowed to be registered.\n\nThis demonstrates another way that attackers have identified to monetize the resources of\nsystems that they can infect. Unlike cryptocurrency mining malware, which attempts to\nmonetize the CPU resources of infected systems, this type of malware attempts to monetize\nthe internet connection of the system. This could prove particularly damaging to victims who\nmay have limited monthly bandwidth subscriptions and potentially cause them to incur direct\n\n\n-----\n\nmonetary losses due to additional usage charges that may result from Honeygain running at\nall times on their system.\n\n## Multi-payload monetization\n\nTalos researchers also identified examples of malware campaigns attempting to\nsimultaneously use multiple methods for monetizing successful infections. In one case, we\nidentified a multi-stage malware campaign that was being used to deliver an information\nstealer, cryptocurrency mining malware, as well as proxyware software to generate revenue\nusing the resources of infected systems.\n\nThis is a textbook example of the varied approaches available to adversaries. Attackers are\nno longer content with simply deploying cryptocurrency mining to make money — they are\nnow also stealing sensitive data and monetizing network bandwidth, all at the same time.\n\nBelow is a high-level diagram depicting the overall execution flow of the malware in this\ncase.\n\nThe following sections describe the functionality associated with each component in the\ninfection process.\n\n\n-----\n\n### Stage 1: Initial loader\n\nThe initial malware loader, written in C++, is a standard unpacked binary that appears to be\nundergoing active development. This downloader is responsible for initiating all of the\nsubsequent stages of this infection chain.\n\nIt begins by attempting to create the mutex \"LIJKMERGL32D23890NUFEWOIHJ,\" exiting if it\nfails. Afterward, it creates a directory called \"Shared Resources\" located within\n%APPDATA%\\Roaming. Then, it copies itself into this newly created directory with the\nfilename \"Numerical Resources Monitor.exe.\" The malware creates a Windows Registry run\nentry called \"Shared Resources Monitor\" that points to the new binary location. This entry is\ncreated under \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.\"\n\nThis downloader, like most of the other components used by the malware, also sends HTTP\nrequests to the attacker via the IPLogger URL shortener to log the current status of the\ninfection process. It will report that it is running, the version of the dropper and the processor\ncharacteristics.\n\nBefore downloading the payload, it checks if their processes are already running, reporting it\nback to the C2. The loader then attempts to download the second stage binaries, which in\nreality, are downloaders for the final malware payloads. The first one is responsible for\ndeploying an XMRig cryptocurrency miner, which is stored in the\n\"%APPDATA%\\Roaming\\Monitoring Statistics\\\" directory with the filename\nMobileStatsMonitor.exe. Afterward, it downloads an additional loader to deploy proxyware\napplications that will attempt to monetize the victim's bandwidth. Finally, it attempts to\ndownload and execute a homemade password stealer. Each of these components are\ndescribed in detail in the following sections.\n\n### Stage 2A: XMRig cryptocurrency miner dropper\n\nThis executable performs two tasks. First, it downloads the XMRig payload from Dropbox\nand launches it with the necessary configuration to mine the Monero cryptocurrency.\n\nThere is no persistence mechanism established for the XMRig downloader or for the mining\nexecutable. Its configuration is hardcoded into the stage 2 downloader executable. The\nparameters used to execute XMRig are shown below:\n\n\n-----\n\nThe initial downloader acts as a persistence mechanism for subsequent stages and functions\nas an update mechanism for the miner. Each time the system reboots, the initial loader will\nretrieve the latest available payloads and execute them each time.\n\nThis loader also downloads and attempts to execute an information stealer. However, due to\na programming error in the downloader, the execution fails.\n\nBoth executables are Base64 encoded and then obfuscated with a char-by-char XOR\noperation that uses the key \"3.\" This obfuscation method derives the key from a sequence of\nlogical and bit shifting operations.\n\n### Stage 2B: Information stealer\n\nThe information stealer is essentially a dropper for two well-known password recovery\nutilities: ChromePass and WebBrowserPassView, both available from NirSoft. These utilities\nare commonly used to retrieve sensitive information from applications so that it can be\ntransmitted and further monetized by the attacker.\n\n\n-----\n\nThe tools are obfuscated in the same manner as described in the previous section. The\noutput is exfiltrated to an attacker-controlled server different from the C2. Once the upload is\nperformed, both results and the utilities are removed from the system.\n\nThis component, like others mentioned in this analysis, appears to be in early stages of\ndevelopment. There is code present in this executable to also extract Chrome and Firefox\nprofile information, but that code is never executed.\n\n### Stage 2C: Honeygain & Nanowire loader\n\nHoneygain is not the only platform capable of being abused. We observed a Stage 2\nmalware payload being delivered that contained the functionality to retrieve and execute\nHoneygain or Nanowire (or both) on infected systems. While it currently appears to be under\nactive development, it further demonstrates how attackers weaponize these proxyware\nplatforms.\n\nIn this particular case, the Stage 2 payload functions as a loader and is capable of retrieving\nseveral additional components which were being hosted on Dropbox.\n\nThese components included:\n\nA ZIP archive containing the Honeygain program directory.\nA Nanowire application executable.\nA Nanowire configuration file.\nA Honeygain configuration file.\n\nThe malware attempts to retrieve a ZIP archive hosted on Dropbox that contains a copy of\nthe Honeygain program directory that is normally created during the installation of the\nHoneygain application. In this case, it appears to have been taken from a system on which\nthe attacker previously installed Honeygain.\n\nA function called \"GetExeLocalAppDataUserConfigPath()\" also checks for a specific\nHoneygain configuration file and, if needed, attempts to replace it with one retrieved from\nDropbox.\n\n\n-----\n\nThe Honeygain configuration file in this case contains the API key needed for the malware to\nauthenticate to the Honeygain platform and register the infected system under the attacker's\naccount, allowing them to generate revenue.\n\nPrior to launching the Honeygain client application, the malware also attempts to disable\nprogram notifications by modifying the Windows Registry and restarting the \"Windows Push\nNotifications User Service (WpnUserService)\" using a function called DisableNotifs().\n\nWhen the Honeygain client is finally started, the API key is sent to the Honeygain platform to\nallow the client to authenticate. An example of one of the Honeygain client API requests\ncontaining the token is below.\n\n\n-----\n\nThe malware also contains the functionality required to download and execute Nanowire on\nthe infected system. An example of the DLNanowire() function, which could be used to\nretrieve the Nanowire executable and associated configuration file, can be seen below.\n\nThe parameters in the function above are responsible for silently launching the Nanowire\nclient in \"sell\" mode which allows the infected system's internet connection to be used by\nother members of the Nanowire network in order to generate revenue for the attacker. The\nconfiguration files that are retrieved are used to ensure that infected systems are associated\nwith the attacker's account across the platforms so that revenue can be obtained. Below is\nan example of a portion of the Nanowire configuration file hosted at the Dropbox URL\ncontained in the malware in this case.\n\n\n-----\n\nThe configuration also limits the amount of bandwidth that is made available to the Nanowire\nnetwork, in this case 20mbps. A comparable configuration file is also retrievable for use with\nthe Honeygain application.\n\nA function called Startup() is responsible for achieving persistence on infected systems\nthrough the use of a Windows Registry run entry within HKCU.\n\nThe executable also features a SendToPanel() function that is responsible for sending\ninformation to a remote server using the specified User-Agent. The URL points to the\nIPLogger URL-shortening service.\n\n\n-----\n\nAt the time of writing, this shortened URL was resolved to hXXps[:]//www[.]test[.]com which\nmay indicate that this functionality is still currently under development and not in use at this\ntime, but may be used by the attacker in the future. An example of one of these POST\nrequests is shown below.\n\nIn the sample we analyzed, the DLNanowire() function was not directly called. However, its\npresence and the payload being actively hosted at the specified Dropbox URL indicates that\nthis functionality is fully working and available for use by the adversary.\n\n### Command & control (C2)\n\nThis malware uses the IPLogger URL-shortening service to facilitate C2 communications\nbetween the infected system and the attacker-controlled infrastructure. Throughout each\nstage of the infection process, the malware transmits status updates by embedding the\ninformation into the User-Agent header of HTTP requests that are made. These requests are\nsent to specific IPLogger URLs that are typically configured to forward the requests to the\nactual infrastructure being monitored by the threat actor. This occurs at strategic points at\neach stage of the infection process to provide ongoing updates on the progress of the overall\ninfection process and notify the threat actor if issues are encountered. The following image\nshows an example of the status update that is sent when the XMRig miner is successfully\nexecuted.\n\n\n-----\n\nSimilar messages can be observed for many of the components executed throughout the\ninfection. When errors are encountered, they are also transmitted to the attacker using the\nsame mechanism. Below is an example request related to the failed deployment of the\nHoneygain client.\n\nThe information stealer described in the information stealer section is responsible for\nexfiltrating sensitive information from infected systems. The collected data is transmitted to\nan attacker-controlled server via an HTTP POST request as defined in the Upload() function\npresent in the stealer.\n\nThe aforementioned examples demonstrate the varied approaches currently being used by\nadversaries attempting to identify new ways to more effectively infect victims and attempt to\nmonetize their malware distribution operations. As these platforms continue to gain in\npopularity, we will likely continue to see examples of this sort of abuse on a larger scale.\n\n## Is proxyware software malicious?\n\nThe use of proxyware has become increasingly widespread over the past couple of years.\nThese platforms may introduce significant risk to most corporate environments. In cases\nwhere proxyware has been installed on corporate assets, the security team should be\nalerted. Organizations may want to conduct response activities to determine if its presence is\ndue to successful malware infection or a policy violation if it was installed by an employee. In\neither case proxyware software should be considered a potentially unwanted application\n\n\n-----\n\n(PUA) or potentially unwanted program (PUP) and treated in a similar manner to\ncryptocurrency mining software that may be discovered in the environment.\n\n## Conclusion\n\nThese relatively new platforms were built with a legitimate purpose, but attackers quickly\nfound ways to abuse them. It's not the first time we have documented abuses of legitimate\nplatforms — a good example is the research we posted about the abuse of the Discord and\nSlack content delivery networks. We believe attackers are highly likely to abuse these\nproxyware platforms, as they can be used to disguise an attacker's origin more efficiently\nthan Tor, since the exit nodes cannot be cataloged. For organizations, these platforms pose\ntwo essential problems: The abuse of their resources, eventually being blocklisted due to\nactivities they don't even control and it increases organizations' attack surface, potentially\ncreating an initial attack vector directly on the endpoint.\n\nThese platforms also pose new challenges for researchers, since there is no way to identify\na connection through these kinds of networks — the origin IP becomes even less meaningful\nin an investigation. Due to the various risks associated with these platforms, it is\nrecommended that organizations consider prohibiting the use of these applications on\ncorporate assets. In most cases, endpoints should not be communicating with the networks\nassociated with these platforms, and organizations should consider deploying\ncomprehensive logging and alerting mechanisms to ensure that they can effectively detect\nand respond when systems within the environment begin communicating with them as this\ncould be an indicator that the system has been compromised.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Cisco Secure Endpoint is ideally suited to prevent the execution of the malware detailed in](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[this post. New users can try Cisco Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\ndetects malware used in these attacks.\n\n[Cisco Secure Firewall and](https://www.cisco.com/c/en/us/products/security/firewalls/index.html) [Meraki MX can detect malicious activity associated with this](https://meraki.cisco.com/products/appliances)\nthreat.\n\n[Cisco Secure Malware Analytics helps identify malicious binaries and build protection into all](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nCisco Security products.\n\n[Cisco Umbrella, our secure internet gateway (SIG), blocks users from connecting to](https://umbrella.cisco.com/)\nmalicious domains, IPs, and URLs, whether users are on or off the corporate network.\n\nAdditional protections with context to your specific environment and threat data are available\nfrom the [Cisco Secure Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.The following SIDs have been released](https://www.snort.org/products)\nto detect this threat: 45549, 46237 and 58030 - 58033.\n\n### Orbital Queries\n\n\n-----\n\n[Cisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries to](https://orbital.amp.cisco.com/help/)\n[see if their endpoints are infected with this specific threat. For specific OSqueries, click here.](https://github.com/Cisco-Talos/osquery_queries/blob/master/packs/win_malware.conf)\nThe following OSqueries have been added for this threat.\n\nmalware_honeygain_trojanized_installer\nmalware_honeygain_loader\nmalware_honeygain_bot\n\n## Indicators of Compromise (IOCs)\n\nThe following indicators of compromise have been observed as being associated with these\nmalware campaigns.\n\n### Mutex\n\nLIJKMERGL32D23890NUFEWOIHJ\n\n### Hashes\n\nThe following file hashes (SHA256) have been observed as being associated with these\nmalware campaigns.\n\n086dd09e67cbf05bf8c1b2561cf691239b815405ed67a6aa72b50f893f1122e9\n1421a79bdfd81204a790fd251c2e8fe89e1a1dee8a8474f1f31b931bce5f31c5\n\n17792e110e2fc30559c33016f08c8ed8923c409c0950a98bbcde48be349f97cf\n\n21ffcc6fd78d7d2a349556c96eca0671184ba67fc5f3f743185936750eb2bf76\n\n2601dceab5674a229c06773e90b7c290fe660be2ac42a006eb3ba1161817eb35\n\n2644f696d1b204838cbadaf46a3c804e76a769b22c72ea7aa03a51e8c1e68b3d\n\n29f528be9fed9d4b8dff6717fdbc4cd76af5220ce0a8bbbdf9d4a9eda924b9bd\n2b418045a2d3b7f3fdcbbbdb163778eb71b759972ba36a3800bf0c8b168ef161\n\n34e7feb3916d569544b635d022d828142814f387805fd051627aa548986e9c64\n\n3f85c476599f081fc17e141c69b53b1abf5069b0fbc1b62133daaaae486fd587\n\n496b0fdd817adac8f8f7e988b081798be5ed7dc1b5b17ce7a129e3913975ced0\n\n4b50a883cb3a3b561002de895db665735be17f342d4a484c9a994df9e360f94c\n\n53a48d3314d4c4660931653821496415ba9687e4f14b458d9cf61cc96632c131\n\n57e2032cd6fdf226511ebb0c4151de2d91ff5282c238145b7313eceb8d703ac9\n\n5a099571b1ff22edbe4621c60def5d597a644771a02f5c179c73596d33efb8ff\n\n5a4ef62cfed9147274068d125218c3f7683e1537bdf10baecca9897ef98ba144\n\n60520f3c00ca73f1c3afaba97533307cf0bde1a582cc035230b91d414ccd3974\n\n61b277234f107b478bcf0becbdff3025b0d9ffe6d5e2db499b82ad82de621a8a\n\n\n-----\n\n6ec1886769320d0f6edff7c0061819ab48104c6f55b211c015b2699521326522\n70fc89f354e9a319448b72b3560e8a728c3c02e75bda6a2970dc21eaf2156ad7\n738c6951897a6a08ff68738bbaca40b820c421a2bf6b6736fe47f67422431651\n74d72a2426e053de09386653c04fa246a3054dae2b6af440c510bf5d4b1a553d\n7b28c0e9baba5dc01b98be47c3d3b3913c7184b106b788a519e6528599747aec\n802c83d71793036f195a4455e9f76f2b1ee0c7e4b95d48b0c4d45698fab37122\n809ff25715e5bd18d3fa878e5c05d810c998649c6602cf46f1adcd28419b4be7\n833ee2b2d2ebe3698a1ba8333b0fbbaf0f00a6628917f1419e606a317627984b\n8d4adeedcc2ada8079c8b8833477ecc906444d433796f19d2d166cfbfa247351\n8eb315d34ae0e568d657f52bbfb672cbb45380326964aa71313f6876c8e100ab\na368cc0ee42d4e6a740c529beb38283012d69f573b65490ac04d8ea57a9d5def\na6aa7fe2ac233bf2c8f3f1342fd57d43739d6839bb25e244e41305e68cdfaf20\nb5defe839274e913c3024ffe3e12272a6f398b49c17e74608a772606acf19970\nb88c0edb75026bbe541ee9a7ec1070334c62b2e5e0f6d5944d5beb83eacb72d0\nbe2111b1f2546368e8867927f3ec7607287c43742c2b704c1db6f040c2bdd28c\nc01d55c9ce208eb645465a85dcd4f5d4444ef4661012c0e2714eb172bd373eeb\ncc918cafea413e2814d0414b8582c0f4e12e9f72c963317f641c431d4d188616\ncda362e1e7fb85e31a36c20b181e5f9b1aaa3479fbd2ca84c9bf06b9bb688b7d\nd6209431e0da47fc8ad6d6e0625f5ed19c8647a5818f94b149a1d531bed32013\ne98ec3f798200525276713e881fab6758c056ea2988806e4fa479e7fa29061f9\nf858b1f43b3076cb3c8843852c531b64317ec72d06b41e49557c3e8b7360f214\nfe6592ee011877d9a851e84b95908c3dd887214bcc668147805613f2573ce5af\n\n### Domains\n\nThe following domains have been observed as being associated with these malware\ncampaigns.\n\nariesbee[.]com\n\nbootesbee[.]com\n\naurigabee[.]xyz\n\nanalytics[.]honeygain[.]com\n\napi[.]honeygain[.]com\n\ndownload[.]honeygain[.]com\n\nwww[.]xsvpn[.]cf\n\nterminist-journal[.]000webhostapp[.]com\n\nr[.]honeygain[.]money\n\n### URLs\n\nThe following URLs have been observed as being associated with these malware\ncampaigns\n\n\n-----\n\nhxxps://www[.]dropbox[.]com/s/vhpmmwns1k9wh33/Honeygain.zip?dl=1\nhxxps://www[.]dropbox[.]com/s/rfbrftww47y0edv/nanowire.exe?dl=1\nhxxps://www[.]dropbox[.]com/s/7hy2ausr3rouflp/nanowire.toml?dl=1\nhxxps://www[.]dropbox[.]com/s/gq3tt6iawri6m3w/user.config?dl=1\nhxxps://www[.]dropbox[.]com/s/puz02l0l7a4wjmt/beehive.txt?dl=1\nhxxps://www[.]dropbox[.]com/s/gp7s712krr67kcx/MinerDownloader-1-23-21.txt?dl=1\nhxxps://docs[.]google[.]com/uc?id=0BxsMXGfPIZfSVzUyaHFYVkQxeFk&export=download\nhxxps://www[.]dropbox[.]com/s/zhp1b06imehwylq/Synaptics.rar?dl=1\nhxxps://www[.]dropbox[.]com/s/ve1i21h0ubslnkr/xmrig2.txt?dl=1\nhxxps://www[.]dropbox[.]com/s/h5lge8h8rhw93rh/Stealer%201-23-21.txt?dl=1\nhxxps://www[.]dropbox[.]com/s/8jyj3a5vw1bwot9/ChromePass.txt?dl=1\nhxxps://www[.]dropbox[.]com/s/v8x3jnnx15hjz04/WebBrowserPassView.txt?dl=1\nhxxps://r[.]honeygain[.]money/SAMIBDC7\nhxxps://iplogger[.]org/2jbNj6\nhxxps://iplogger[.]org/2azxA5\nhxxp://www[.]xsvpn[.]cf/ssr-download/readme.md\n\nStealer Exfiltration URL:\n\nhxxps://terminist-journal[.]000webhostapp[.]com/donkeydick.php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-31 - Attracting flies with Honey(gain)- Adversarial abuse of proxyware.pdf"
    ],
    "report_names": [
        "2021-08-31 - Attracting flies with Honey(gain)- Adversarial abuse of proxyware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535965,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653688718,
    "ts_modification_date": 1653688718,
    "files": {
        "pdf": "https://archive.orkl.eu/2d54cb97fc9eae9320eb6b599f5a1c3331da90a4.pdf",
        "text": "https://archive.orkl.eu/2d54cb97fc9eae9320eb6b599f5a1c3331da90a4.txt",
        "img": "https://archive.orkl.eu/2d54cb97fc9eae9320eb6b599f5a1c3331da90a4.jpg"
    }
}