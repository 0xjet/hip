{
    "id": "66a0e8db-f1db-4d3d-b595-58ee3ad0081c",
    "created_at": "2023-02-07T02:08:06.359574Z",
    "updated_at": "2025-03-27T02:08:51.398228Z",
    "deleted_at": null,
    "sha1_hash": "2784c448932c4e3be4d67c3e33d8d14f6330c7ad",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-11-01T10:56:09Z",
    "file_modification_date": "2022-11-01T10:56:12Z",
    "file_size": 3925782,
    "plain_text": "**WHITEPAPER**\n## Ratting Out\n\n# Arechclient2\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n### Executive Summary\n\nBlackpoint Cyber recently uncovered an ISO file containing a malicious Windows executable being\ndownloaded to a customer endpoint that wasn’t detected by antivirus (AV). The malicious Windows\nexecutable, named Setup.exe, was executed and observed using various defense evasion techniques\nincluding injection, obfuscation, and uncommon automation tools to eventually drop a remote access tool\n(RAT) named Arechclient2.\n```\nArechclient2 is a .NET RAT reported to have numerous capabilities including multiple stealth functions.\n\n```\nBlackpoint observed the acquired malicious executable profiling victim systems, stealing information\nsuch as browser and crypto-wallet data, and launching a hidden secondary desktop to control browser\nsessions, which aligns closely with reports from others such as the Center for Internet Security (CIS).\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n### Analysis\n\n##### Initial Access\n\nThe initial pre-text given to the victim is unknown at this time, however, the victim was manipulated into downloading\n```\nSetup.iso. When double-clicked, the ISO can be mounted like a CD and oftentimes the contents are automatically\n\n```\nexecuted. Within the ISO was an executable named Setup.exe with a size over 300 megabytes (see Figure 1).\n\n_Figure 1: Contents of Mounted ISO File_\n\nExamining the Resources section of the executable with the tool Die shows keywords commonly used in\nWindows installer files (see Figure 2).\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n##### Execution \n\nExecuting Setup.exe will trigger the extraction of three files and execute multiple child processes as seen in the\n**Procmon process tree below (see Figure 3).**\n\n_Figure 3: Procmon Process Tree View_\n\nA new folder named IXP000.TMP is created in the victim’s AppData\\Local\\Temp directory and three files\nare extracted into it:\n\n - `Funding.mpeg`\n\n - `Mali.mpeg`\n\n - `Dns.mpeg`\n\nThese files are in the Resources section labeled “CABINET” (see Figure 4).\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\nFigure 5 was taken using ProcDOT and visualizes the process flow of Setup.exe extracting the three files.\n\n_Figure 5: ProcDOT Output of Extracted Files_\n\nThe first process executed by Setup.exe is robocopy.exe with an argument of 8927387376487263745672\n```\n673846276374982938486273568279384982384972834. If CreateProcessA Windows API fails to execute\nrobocopy, the Setup.exe process will clean up all files that were extracted and exit.\n\n```\nBelow is a snippet of the decompiled subroutine responsible for creating the process (see Figure 6).\n\n_Figure 6: Function Responsible for Starting Robocopy_\n\nThe robocopy command will fail every time without a valid source and destination argument. It’s important to note\nthat malware authors aren’t always perfect with their intentions and make mistakes.\n\nThe next command is: cmd /c cmd < Dns.mpeg\n```\nDns.mpeg is a heavily obfuscated batch script. Below is a snippet from the script to show the author’s intent to bypass\n\n```\nany AV signature analysis (see Figure 7).\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n_Figure 7: Obfuscated Dns.mpeg Batch Script_\n\nWhen decoded, the commands seen in the script align (see Figure 8) with the child processes that were seen in\nthe process tree in Figure 3.\n\n_Figure 8: Decoded Dns.mpeg Batch Script_\n\n##### Obfuscation\n\nThe script searches for AvastUI.exe and AVGUI.exe running on the system. These are processes found in the Avast\nantivirus line of products. If not found, it sets Hole.exe.pif to the name AutoIT3.exe, writes MZ to the beginning of\n```\nHole.exe.pif and then writes the contents of Funding.mpeg into Hole.exe.pif. Finally, Mali.mpeg is renamed\n\n```\nto v.a3x and the command “Hole.exe.pif v” is executed, followed by a ping command. AutoIT3.exe is a tool used\nfor automation that has its own scripting language. The scripts have an extension of .au3 or.a3x and can be compiled for\nquicker processing. Funding.mpeg is the AutoIT3.exe executable and Mali.mpeg is the script argument.\n\nThe .au3 or d.au3 script is heavily obfuscated and contains dead code to make reverse engineering more difficult.\n\nThroughout the script there are over 3,000 references to a defined function named Xspci() (see Figure 9). The function\ntakes a string as the first argument and a number as the second argument and is responsible for decoding strings.\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n_Figure 9: Example Function Call to Xspci_\n\nStrings were extracted from the script by appending the following two lines to the end of the function (see Figure 10).\n\n\n# Obtain a handle to the output file for writing.\n```\n$handle = FileOpen(“C:\\Users\\User\\AppData\\Local\\Temp\\siFtwoLbXE\\out.text”, 1)\n\n```\n# Write “<encoded string> = <decoded string>” on a new line\n```\nFileWriteLine($handle, $DhzkAIs & “ = “ & $bIitoyr)\n\n```\n\n_Figure 10: Dumping Decoded Strings to a File_\n\nThe lines added to the end of the function will open a file on the local testing machine, in this case, “out.txt,” and write\nboth the encoded and decoded strings to the file. This helps speed up analysis of the script file and filter out the noise.\nFigure 11 below is an example of the resulting file.\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n##### Injection\n\nThe .au3 script is responsible for three things:\n\n1. Establishing persistence using a URL file in the victim’s startup folder.\n\n2. Copying ntdll.dll from the C:\\Windows\\SysWOW64 folder to avoid AV hooks when using exported APIs.\n\n3. Injecting the embedded payload into jsc.exe.\n\nThe major function that accomplishes the above is KXsObHGILZNaOurxqSUainCYU()which takes three arguments\n(see Figure 12):\n\n1. A pointer to the binary to be injected.\n\n2. A string argument (was empty during testing).\n\n3. Another string argument with the path to the binary that would be executed and injected into.\n\n_Figure 12: Major Injection Function_\n\nThe script first establishes persistence by adding a URL file to the victim’s startup folder that will execute a\nVBS script on every login.\n\n\ncmd /c echo “[InternetShortcut]” > “%APPDATA%\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\sgYzDqWyiP.url” &\n\necho ‘URL=”%APPDATA%\\Local\\Temp\\siFtwoLbXE\\pyIJlxBJlwEWd.vbs”’ >>\n“%APPDATA%\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\sgYzDqWyiP.url”\n\n\nContents of sgYzDqWyiP.url\n\n```\n[InternetShortcut]\n\n```\nURL=”C:\\Users\\<username>\\AppData\\Local\\Temp\\siFtwoLbXE\\pyIJlxBJlwEWd.vbs”\n\n\nContents of pyIJlxBJlwEWd.vbs\n\n```\np = GetObject(“winmgmts:\\\\.\\root\\cimv2:Win32_Process”).Create(“C:\\\\\n\n```\nUsers\\\\<username>\\\\AppData\\\\Local\\\\Temp\\\\siFtwoLbXE\\\\sgYzDqWyiP.exe.com d”,\n\n“C:\\\\Users\\\\<username>\\\\AppData\\\\Local\\\\Temp\\\\siFtwoLbXE”, null, null)\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\nThe VBS script is the same as the previous command: Hole.exe.pif v\n\n - `SgYzDqWyiP.exe.com is AutoIT3.exe`\n\n - `d is the .au3 script`\n\nThe script copies ntdll.dll to the current working folder and names it fyoNUfeL.dll. In Figure 13,\nthe encoded strings have been replaced with the decoded versions for clarity.\n\n_Figure 13: FileCopy ntdll.dll to fyoNUfeL.dll_\n\nUsing the AutoIT script function DllCall(), it resolves specific exported functions from fyoNUfel.dll (ntdll.dll).\n\nThe functions listed below were discovered in the decoded strings output file and are responsible for injecting and\nexecuting the final payload:\n\n - NtReadVirtualMemory\n\n - `NtWriteVirtualMemory`\n\n - `NtProtectVirtualMemory`\n\n - `NtSetContextThread`\n\nThe script executes the program jsc.exe, which is a .NET tool used to compile JScript files into executables or DLLs.\nThe executable is considered a “lolbin” (Living-off-the-land binary) but in this case it takes no arguments and is simply\nused as a target for injection.\n\nOnce the program is running, another .NET executable named Test.exe is injected into jsc.exe as a loaded\nmodule. However, the name of Test.exe is changed to jsc.exe. Figure 14 shows a screenshot of loaded modules\nin jsc.exe. There should only be one loaded jsc.exe, which is the image itself, however, there are two.\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\nDumping the jsc.exe process and examining it in WinDbg shows the original file name in Figure 15.\n\n_Figure 15: jsc.exe Dump_\n\n##### Decompilation\n\nSince Test.exe is a C# binary, it can be loaded into a tool like DnSpy for static and dynamic code analysis (see Figure 16).\nThe class names have been minimized to single and double characters to create an additional layer of confusion for reverse\nengineers. The actual name of the executable is 2qbarx12tqm.exe version 1.0.0.0.\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n##### Command and Control\n\nWhen the RAT is executed, it reaches out to https[:]//pastebin.com/raw/nJqnWX3u to retrieve C2 information\n(see Figure 17). The requested file, nJqnXW3u, contains the IP address 34.141.198.105 as a string. It also reaches\nout to http[:]//eth0.me to get its public IP address.\n\nTo receive commands, it connects to its C2 server on port 15647. The server responds with information to set the\nencryption status from “On” to “Off” in JSON format.\n\n_Figure 17: C2 Comms with Encryption_\n\nIf the communications are intercepted and the encryption status is set to “Off,” all further communications will be\nin plain text (see Figure 18).\n\n\n-----\n\n_Figure 18: C2 Traffic Without Encryption_\n\nComparing this traffic to known C2 traffic patterns shows an alignment with Arechclient2 traffic:\n[https://github.com/silence-is-best/c2db.](https://github.com/silence-is-best/c2db)\n\nWhile the C2 channel is still live at the time of this writing, there was no active follow-up on commands\nobserved on the testing machine once the RAT established a connection.\n\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n-----\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n### Conclusion\n\nAdversaries are becoming more advanced in their methods of bypassing AV by using publicly available tools such as\nAutoIT3 and native operating system tools. Therefore, it’s become increasingly important in today’s threat landscape to\nhave the capability to detect advanced tradecraft. Arechlient2 is not a new threat. However, it is not commonly viewed\nas a choice for remote access tools and in this case, was the result of a drive-by download. While malware like this is\nnot used as a targeted means of attack, it does not reduce the risk that malicious binaries like this pose.\n\n###### File Indicators of Compromise\n\n**SHA256** 4A81FED5DB0727E54B39402A9954804E8AE39F26FCE13ACE9300141ABEEE4E8A\n\n**Name** `jsc.exe/Test.exe`\n\n**File Type** Executable\n\n**Size** 639 KB\n\n**SHA256** 71B57570867E7ABD79A9011B19B2EFCA2B069E8AAFBB1BEF601CD65E3D7DFC79\n\n**Name** `Dns.mpeg`\n\n**File Type** Batch Script\n\n**Size** 11 KB\n\n**SHA256** 3E26723394ADE92F8163B5643960189CB07358B0F96529A477D37176D68AA0A0\n\n**Name** `Hole.exe.pif`\n\n**File Type** Executable\n\n**Size** 925 KB\n\n**SHA256** FFE6FEB6677FB58013BBB5D42EACAACFBB939F803D649268F7427EA6E5262356\n\n**Name** `fyoNUfeL.dll`\n\n**File Type** DLL\n\n**Size** 2 MB\n\n|SHA256|4A81FED5DB0727E54B39402A9954804E8AE39F26FCE13ACE9300141ABEEE4E8A|\n|---|---|\n|Name|jsc.exe/Test.exe|\n|File Type|Executable|\n|Size|639 KB|\n\n|SHA256|71B57570867E7ABD79A9011B19B2EFCA2B069E8AAFBB1BEF601CD65E3D7DFC79|\n|---|---|\n|Name|Dns.mpeg|\n|File Type|Batch Script|\n|Size|11 KB|\n\n|SHA256|3E26723394ADE92F8163B5643960189CB07358B0F96529A477D37176D68AA0A0|\n|---|---|\n|Name|Hole.exe.pif|\n|File Type|Executable|\n|Size|925 KB|\n\n|SHA256|FFE6FEB6677FB58013BBB5D42EACAACFBB939F803D649268F7427EA6E5262356|\n|---|---|\n|Name|fyoNUfeL.dll|\n|File Type|DLL|\n\n\n-----\n\n|SHA256|3E26723394ADE92F8163B5643960189CB07358B0F96529A477D37176D68AA0A0|\n|---|---|\n|Name|Funding.mpeg|\n|File Type|Raw Data|\n|Size|925 KB|\n\n|SHA256|DB4E1935D1D1DFAE7F87147D0FB90405326380E09A30E869BFCFE0CD64B92B1E|\n|---|---|\n|Name|Mali.mpeg or v or d|\n|File Type|AutoIT Script|\n|Size|2 MB|\n\n|SHA256|3E26723394ADE92F8163B5643960189CB07358B0F96529A477D37176D68AA0A0|\n|---|---|\n|Name|sgYzDqWyiP.exe.com|\n|File Type|Executable|\n|Size|925 KB|\n\n\n[Learn more at blackpointcyber.com](http://www.blackpointcyber.com)\n\n\n###### Network IOCs\n\n|Network IOCs|Col2|Col3|Col4|\n|---|---|---|---|\n|URL/IP ADDRESS|PORT|DESCRIPTION|DATE LAST ACCESSED|\n|34.141.198.105|15647|C2|09/27/2022|\n|https[:]//pastebin.com/raw/nJqnXW3u|443|Retrieve C2 IP|09/27/2022|\n|http[:]//eth0.me|80|Retrieve public IP|09/27/2022|\n\n\n-----\n\n#### Why Blackpoint Cyber?\n\n###### Founded in 2014 by former National Security Agency (NSA) cyber operations experts, the Blackpoint team continues to bring nation-state-grade technology and tactics to our partners around the world. By fusing real security with real response, our elite SOC team is empowered by the proprietary technology we built from the ground up.\n\n Together, we detect breaches faster than any other solution on the market. With insight into network visualization, tradecraft detection, endpoint security, suspicious events, and remote privileged activity, Blackpoint detects lateral movement in its earliest stages and stops the spread. \n\n By the time you hear from us, the threat has been triaged and removed, often before the malicious actor even saw us coming. Lastly, we optimize our architecture and data to its fullest extent, ensuring robust services and valuable intel for our partners. That way, all facets of security—response, logging, cloud protection, and cyber insurance— can work in tandem to support an integrated cyber strategy. Sleep easy knowing we detect and detain threats on your behalf around the clock.\n\n##### Our mission? To provide unified, 24/7 detection and response services to organizations of all sizes around the world.\n\n**[SIGN UP FOR A DEMO TODAY!](https://blackpointcyber.com/lp/book-demo/?utm_campaign=discovery_of_arechclient2_whitepaper&utm_source=cta_button)**\n\n**CONTACT US**\n\n[info@blackpointcyber.com](mailtO:info@blackpointcyber.com)\n\n[blackpointcyber.com](https://blackpointcyber.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://cdn-production.blackpointcyber.com/wp-content/uploads/2022/11/01161208/Blackpoint-Cyber-Ratting-out-Arechclient2-Whitepaper.pdf"
    ],
    "report_names": [
        "Blackpoint-Cyber-Ratting-out-Arechclient2-Whitepaper.pdf"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1675735686,
    "ts_updated_at": 1743041331,
    "ts_creation_date": 1667300169,
    "ts_modification_date": 1667300172,
    "files": {
        "pdf": "https://archive.orkl.eu/2784c448932c4e3be4d67c3e33d8d14f6330c7ad.pdf",
        "text": "https://archive.orkl.eu/2784c448932c4e3be4d67c3e33d8d14f6330c7ad.txt",
        "img": "https://archive.orkl.eu/2784c448932c4e3be4d67c3e33d8d14f6330c7ad.jpg"
    }
}