{
    "id": "6670f780-ee4b-48ae-8077-def7c8aed400",
    "created_at": "2023-01-12T15:10:46.225231Z",
    "updated_at": "2025-03-27T02:17:14.37211Z",
    "deleted_at": null,
    "sha1_hash": "2e5e0a0b08fbd7f9f364940284735c029e23bcdc",
    "title": "2021-05-13 - Threat Thursday- SombRAT — Always Leave Yourself a Backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T23:11:49Z",
    "file_modification_date": "2022-05-28T23:11:49Z",
    "file_size": 2116387,
    "plain_text": "# Threat Thursday: SombRAT — Always Leave Yourself a Backdoor\n\n**[blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor](https://blogs.blackberry.com/en/2021/05/threat-thursday-sombrat-always-leave-yourself-a-backdoor)**\n\nThe BlackBerry Research & Intelligence Team\n\n### Introduction\n\nThe [BlackBerry Threat Research and Intelligence Team have been actively monitoring and tracking the threat group dubbed CostaRicto,](https://blogs.blackberry.com/en/author/the-blackberry-research-and-intelligence-team)\nauthors of the SombRAT backdoor, since Autumn 2019. We first detected the rumblings of new activity during late December 2020 and into\nearly January 2021 with the emergence of new SombRAT backdoors in the public domain.\n\n[The latest campaigns employing SombRAT, recently unveiled by FireEye to be a series of financially motivated ransomware attacks, sees the](https://malpedia.caad.fkie.fraunhofer.de/details/win.sombrat)\nbackdoor receive several code updates and undergo a good deal of obfuscation aimed at frustrating researchers. In addition, their bespoke\nvirtual machine (VM) based loader, CostaBricks, is conspicuously missing, while a vast range of post-exploitation PowerShell scripts were\nalso uncovered. These scripts were used to perform reconnaissance, privilege escalation, password brute-forcing and Kerberos password\nhash scraping using a technique called AS-REP roasting.\n\n### Key Findings\n\nThe attacks occurred over Christmas 2020 and continued into spring 2021, with command-and-control (C2) domains registered and\nmalware compiled and packaged during November 2020.\n\nThe attackers again deployed CobaltStrike beacon, one of which was configured using indicators from a known APT10 campaign. This\nfalse flag was likely aimed at confusing analysts and researchers into performing a false attribution. This could waste researcher’s time\nwith tuning security solutions and threat hunting. CostaRicto was also seen using an APT28 false flag in a previous campaign.\nThe bespoke SombRAT backdoors contain several updates, many of which remove features that made analysis and classification easy.\n[Unfortunately, some of the updates appear to be a result of our last paper, for example:](https://blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced)\n\nCompilation timestamps have been overwritten with zeros\nProgram database (PDB) paths are not included\nThe internal versioning system has changed\nRun-time-type-information (RTTI) has been removed from the binaries to prevent easy C++ class analysis\nThe code is now statically linked with a TLS library called mbedtls, which is employed to avoid using Windows® cryptographic\nAPIs for RSA key handling (and evade EDR software)\nModifications to C2 commands\nA new ASCII art message, containing the message \"Nadie es perfecto excepto yo\" (No one is perfect except me).\nDuring the reconnaissance phase of one campaign, attackers performed Kerberos password hash scraping using a technique called\nAS-REP roasting. They then exfiltrated the hashes via an online file sharing service.\n\n### Delivery\n\n\n-----\n\nInitial access to one of the recent victim’s networks occurred during December 2020 via a remote desktop solution accessed using stolen\ncredentials. The credentials were likely obtained via the dark web approximately a month earlier. The threat actor swiftly deployed a\nCobaltStrike beacon shellcode stager (containing an APT10 false flag) and performed domain password brute-forcing and port scanning.\nThey then ran several well-known penetration testing tools on the server, checking for vulnerabilities, performing domain reconnaissance, and\nobtaining Kerberos password hashes using AS-REP roasting. The hashes were exfiltrated from the victim’s environment via the anonymous\nfile sharing platform anonfiles. This gave the attackers a chance to crack the hashes using tools such as HashCat. Finally, the threat actors\ndeployed SombRAT (their bespoke backdoor used for persistence) to a primary domain controller and deployed further CobaltStrike beacon\nshellcode stagers.\n\nThe threat actors later returned using a privileged service account to deploy further remote access mechanisms within the environment.\nThese included TeamViewer, AnyDesk, and a new SombRAT backdoor with an updated C2 domain.\n\nUltimately, the threat actor’s campaign was rather noisy and triggered multiple alerts. The victim responded quickly by shutting down further\nactivity and performing remedial action, effectively thwarting the remainder of the attack.\n\n_Figure 1: High-level attack timeline._\n\n### Tooling\n\n**CobaltStrike**\n\n\n-----\n\nCoba tSt e s a pe e a t eat, o te obse ed du g t e ea y ate a o e e t p ase o ost ca pa g s Costa cto appea s to be\nusing several CobaltStrike beacon stager shellcodes, the first of which appears to be a trial version, as it still contains the EICAR antivirus test\nfile in the configuration:\n\n_Figure 2: CobaltStrike stager with EICAR code._\n\n[The other beacon stager deployed by CostaRicto is perhaps more interesting. The bulk of its configuration is based on the chches_APT10](https://github.com/xx0hcd/Malleable-C2-Profiles/blob/master/APT/chches_APT10.profile)\n[malleable C2 profile, which provides the same configuration as a previously-known APT10 beacon, providing a false flag in terms of](https://unit42.paloaltonetworks.com/unit42-menupass-returns-new-malware-new-attacks-japanese-academics-organizations/)\nattribution:\n\n_Figure 3: CobaltStrike stager with APT10 URI and headers, but CostaRicto IP._\n\nFor both shellcodes the attackers have wrapped the payloads in a simple PowerShell loader that is subsequently obfuscated.\n\n### Third Party Tools\n\nThe threat actors were observed using a variety of third-party utilities, including reconnaissance tools, credential dumpers, and remote\ndesktop software:\n\n[WinPwn – a comprehensive PowerShell reconnaissance script that can be used to:](https://github.com/S3cur3Th1sSh1t/WinPwn)\n\nObtain password hashes and browser credentials\nPerform enumeration of the network\nScan for vulnerabilities and perform exploitation\nSeveral additional third-party scripts are downloaded by WinPwn during execution, including Invoke-Rubeus, SharpHound3,\nDomainPasswordSpray, and zerologon, which were all utilised in this attack.\n[Rubeus – a C# toolset used for performing various Kerberos password attacks. In this incident, Rubeus was used to perform AS-REP](https://github.com/GhostPack/Rubeus)\nroasting, an attack that can reveal the credentials of accounts that have Kerberos pre-authentication disabled.\n[SharpHound3 – a C# toolset primarily used to perform reconnaissance of Active Directory.](https://github.com/BloodHoundAD/SharpHound3)\n[DomainPasswordSpray – a PowerShell script used to perform a password spray attack against domain users.](https://github.com/dafthack/DomainPasswordSpray)\nZerologon is the name given to the cryptographic vulnerability in Netlogon that can be exploited to perform an authentication bypass.\nThe [Zerologon implementation contained in WinPwn is written in PowerShell. It is apparently ported from the C# implementation](https://github.com/nccgroup/nccfsas/tree/main/Tools/SharpZeroLogon)\ndeveloped by the NCC Group's Full Spectrum Attack Simulation team.\n\n\n-----\n\no e a t0 a o e S e sc pt t at te ates e e t ogg g p ocesses to t a t o e s c a a ys s\n[SoftPerfect – a commercial comprehensive network scanning tool.](https://www.softperfect.com/)\n[PsExec – a notorious command line utility.](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec)\n[TeamViewer – a legitimate remote control and remote access software, which is free of charge for non-commercial use.](https://www.teamviewer.com/en/)\n[AnyDesk – a legitimate remote desktop application.](https://anydesk.com/en)\n\n### SombRAT\n\nAn updated version of CostaRicto's bespoke backdoor, known as SombRAT, is used as a foothold in the early stages of the attack. The main\npurpose of this backdoor is data exfiltration and deployment of additional modules. Both 32-bit and 64-bit versions share the same C2 domain\nand were possibly compiled from the same code base.\n\n**Deployment**\n\nThe backdoor is delivered as a RAR self-extracting archive called first32.exe or first64.exe, depending on the target architecture. The archive\ncontains an encrypted PowerSploit injector (c.base64), encrypted backdoor binary (b.base64), and an XOR key used for decryption\n(a.base64). The internal timestamps in the RAR archive also help to give an idea of when the malware was initially packaged for deployment:\n\n_Figure 4: Content of the SXF archive._\n\nIn order to decrypt and execute the injector, the attackers drop and run a series of obfuscated batch and PowerShell scripts. The injector is\nvery similar to the one used in previous campaigns and will load the decrypted backdoor directly into memory:\n\n_Figure 5: Obfuscated 1st stage script (BAT)._\n\nFigure 6: Obfuscated 2nd stage script (PS1).\n\n\n-----\n\n_Figure 7: SombRAT deployment process._\n\n### What’s New?\n\n**_Bye Bye, CostaBricks_**\n\nAll SombRAT samples observed, regardless of architecture, were deployed using a PowerSploit-based injector. This is a clear divergence\nfrom previous campaigns in which the x86 backdoors were protected by a bespoke virtual machine-based loader dubbed CostaBricks. We\n[dissected CostaBricks in our previous report. While it's a neat little piece of code, it has probably proven less stealthy, and therefore less](https://blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced)\neffective, than the simpler PowerSploit solution.\n\nThe disadvantage of CostaBricks is that a VM-based mechanism can trigger alerts from antivirus (AV) solutions. This kind of behaviour is\nsuspicious and often related to malware. Moreover, its distinct code makes it easy to configure hunting rules. Since the backdoor is stored\ninside the loader binary, having the loader means being able to obtain the decrypted backdoor. The PowerSploit approach, which segregates\nthe components, poses less risk of the backdoor being leaked to platforms such as VirusTotal and dissected by researchers.\n\n**_Covering Tracks_**\n\nThe attackers clearly like to keep an eye on research publications about their campaigns - and they learn their lessons. The new SombRAT\nversions that appeared after our first CostaRicto report contain numerous changes aimed at making analysis and attribution more difficult:\n\nThe compilation timestamp field in the PE headers of all new SombRAT binaries has been nulled out.\nDebugging information (including PDB paths) has been stripped from the binaries.\nRun-time-type-information (RTTI) has been removed. The RTTI present in previous samples contained original class names. This\ngreatly assisted our researchers in mapping the numerous C++ classes that SombRAT code is based on.\nThe versioning system has changed from sequential numbers to MD5-like hashes. Combined with the lack of PE timestamps, it\nbecomes more difficult to map chronology of the backdoor versions:\n\n\n-----\n\n_Figure 8: Version number comparison: old versioning system (above) and new versioning system (below)._\n\nAll cryptographic functions are now performed by the statically linked mbedtls library. This makes the task of analysis slightly more\ntedious and serves to thwart EDR software that relies upon hooking the Windows cryptographic APIs. The embedded RSA key for C2\ncommunications is stored in PEM format (as opposed to Windows BLOB in previous samples), and additionally obfuscated with a single\nbyte XOR:\n\n_Figure 9: Decryption of RSA key (redacted for clarity)._\n\nSensitive strings remain obfuscated with a 1-byte XOR. In addition to the variable XOR key stored at the beginning of the string, there is\nanother hardcoded one-byte key. This key is the same for all strings and shared across all the samples from this campaign.\nTwo new routines were added upon the malware execution. If the backdoor detects it is being invoked via cmd.exe, it will immediately\nterminate. It will also overwrite the command line entry in its Process Environment Block (PEB) with the file name of the parent process\nin order to conceal the original command line it was executed with.\n\n**_The Skull of Sombra_**\n\nBased on PDB paths found in some older samples, we established that the backdoor has been dubbed “Sombra” by its creators. We\nassumed that the name refers to a female hacker character from the Overwatch game by Blizzard Entertainment. It turns out that our\nassumption was correct. Although the PDBs are no longer present in the newest samples, the malware authors decided to add a carefully\ncrafted footprint to their backdoor – one that confirms beyond any doubt the provenance of the name they gave to the project.\n\n\n-----\n\nte e ecut g t e a c ous out e a a se ce d spatc e, a d g t be o e e t g, t e a a e p t a o g base6 e coded st g to\nthe standard output. The encoded data contains an ASCII art representation of a skull. The skull is identical to the one that was part of a\n[puzzle published by Blizzard before the release of the Sombra character. To solve the original puzzle, gamers had to use a slightly different](https://wiki.gamedetectives.net/index.php?title=Sombra_ARG)\nskull, posted by the developers on the Blizzard forum. Will the attackers use this opportunity to send us a hidden message, too? We will\ncertainly keep an eye on it.\n\nThe threat actor also added a plain-text message as a personal touch to the copy-pasted ASCII art: a sentence that reads \"Nadie es\n**_perfecto excepto yo.\" (Spanish for \"No one is perfect except me\"). This sentence doesn’t seem to be related to the Overwatch game, apart_**\nfrom using the same language as the Sombra puzzles:\n\n_Figure 10: Code printing base64-encoded ASCII art to standard output._\n\n_Figure 11: Decoded ASCII art._\n\n**_Backdoor Commands_**\n\n[The set of backdoor commands remains more or less the same as described in our previous report. A few commands have been removed](https://blogs.blackberry.com/en/2020/11/the-costaricto-campaign-cyber-espionage-outsourced)\nand some functionality improvements/code tweaks were made to the existing commands. Below is the list of more significant changes, sorted\nby internal modules to which the commands belong.\n\n**Core**\n\nThe Core module is responsible for commands related to initiating C2 communication, loading additional modules, retrieving system\ninformation and bot maintenance. These commands include:\n\n\n-----\n\n_Figure 12: List of Core module commands (changes from previous versions highlighted)._\n\nThe commands updatemyself and restart were removed from this version of SombRAT.\n\nThe malware authors added a possibility of loading two external plugins from storage: injector and keylog. The names of these plugins are\nhardcoded in the binary.\n\nThe uninstall command, previously unimplemented, will now close and delete the storage file, and remove all installation files, overwriting\nthem with random bytes before deletion.\n\nIn the getinfo command, the bot versioning system changed from sequential to MD5-like; there are also slight changes to the system\ninformation sent to the C2:\n\n_Figure 13: System information sent to the C2._\n\n**Storage**\n\nThe Storage module provides functionality for dropping additional files to the victim’s machine, as well as uploading content from the victim to\nthe C2 server. A single storage file implementing a custom encrypted filesystem is used for keeping all additional data, either downloaded\nfrom the C2 or cached for upload:\n\n\n-----\n\n_Figure 14: List of Storage module commands._\n\nThe new version of SombRAT sees two commands removed: await&create, await&putcontent.\n\nThe enum command now also returns the storage statistics that are read from the storage file header (statstotal, statsused, statsfree,\n**statsondisk, statssessions).**\n\nThe default filename for the storage file and the corresponding mutex name are now generated by encrypting a hardcoded string Initiating\n**The Hack with AES-128-CBC (using the hardcoded key: Xn2r5u8x/A?D(G+K), and converting the encrypted data into a hex string:**\n\n_Figure 15: Storage file name generation._\n\nUpon initialization of the storage module, an empty 2MB storage file is created. Initially, it contains mostly zeroes except for the file table and\nthe first 12 bytes of the storage header:\n\n_Figure 16: Default empty storage file._\n\nThe values used to initialize storage files are hardcoded in the backdoor binary and include:\n\nTwo flags of unclear purpose (0x01 and 0x02)\nOffset to the file table (0x1000)\nThe initial size of the storage file in DWORDs (0x800000)\n\nWhile any potential storage content that follows the file table is supposed to be encrypted, the table itself remains unencrypted and is\ninitialized with 0xFF bytes. A file table entry is expected to start with a value of 0xFFFFFFFE (for empty files) or 0xFFFFFFFD (for non-empty\nfiles) and is followed by the file metadata. The metadata includes information such as:\n\nFile size\nLength of the encrypted file ID (up to 1024 bytes)\nFile ID encrypted with AES-256-CBC\nOffset to the file content in the storage data\n\nThe AES encryption key is hardcoded in the binary and is used for both file ID and data: p3s6v9y$B&E)H@MbQeThWmZq4t7w!z%C.\n\nSo far, we’ve only encountered “empty” storage files on the filesystems where SombRAT had been active.\n\n### Network\n\n\n-----\n\ne set o co a ds se ced by t e et o odu e s e ated to a ag g t e C co u cat o p otoco\n\n_Figure 17: List of Network module commands._\n\nThere are no major functionality changes in the network-related commands; however, the internal structures to the network protocol were\nsomewhat altered.\n\nAs in the previous versions, the backdoor communicates with the C2 through a DNS tunnel by default. The communication protocol can be\nswitched to a TCP-based one on request. All sensitive data that is sent or received is Zlib-compressed and encrypted with AES-256 using a\nrandomly generated key. An embedded RSA-2048 public key is then used to secure the AES key exchange.\n\nThe DGA algorithm used for initiating communication is the same as previously used. Now, instead of using an “images” prefix, the backdoor\nsimply prepends the letter “b” to the generated subdomain name. This subdomain is then used in a DnsQuery call in order to retrieve the\nassociated IP address. This C2 IP will be later used to authenticate messages and derive the XOR key for additional message obfuscation.\n\nThe C2 communication is initialized with a simple 'PING' message sent from the victim as a DNS_TYPE_A request. The message header\ncontains randomly generated byte, followed by bytes 4 and 3 of the previously obtained C2 IP address. The sequence byte is set to 1. The\nmessage body (string 'PING') and following 2-bytes of the checksum, is XORed with a key derived from the first 2 bytes of the C2 IP address.\nThe whole message, including the header, is then additionally XORed with its first byte (omitting the bytes that are equal to that byte):\n\n_Figure 18: Basic C2 message format in DNS tunneling (DNS_TYPE_A request)._\n\nFinally, the obfuscated data is converted to a hex string, prepended to the C2 domain, and transmitted via a DNS query:\n\n_Figure 19: Example of an initial DNS ‘PING’ message._\n\n\n-----\n\ne attac e s S se e s ou d espo d t a add ess e e t e st bytes a e equa to t e c ec su o t e equest s subdo a\nThis will establish a backdoor session.\n\nOnce a connection is successfully established the backdoor sends a DNS_TYPE_TXT request, which is a request for commands.\n\n_Figure 20: Basic C2 message format in DNS tunneling (DNS_TYPE_TXT request)._\n\nThere are 3 types of DNS_TYPE_TXT responses that can be issued by the C2:\n\nStarting with 0x40 byte ('@') - no commands at the moment, keep connection alive.\nStarting with 0x23 byte ('#') - end session.\nResponse containing a command, which starts with the XOR byte, followed by a 2-byte checksum of corresponding request, the\nmessage body, and a 2-byte checksum of the response.\n\nThe initial command from the C2 is expected to contain “PING” as a message. The backdoor will respond by sending out system information\nand an embedded RSA public key.\n\n**Taskman**\n\nTaskman commands are used for manipulating processes:\n\n_Figure 21: List of Taskman module commands._\n\nInformation sent to the C2 in response to each of these commands now contains two additional fields:\n\n**iswow, which specifies if the process is 32- or 64-bit**\n**threadscount, which specifies the number of threads associated with the process.**\n\n**Debug**\n\nCurrently this module contains only one command, debuglog, which is used to enable/disable logging. There were no changes in its\nfunctionality since the previous SombRAT version.\n\n**Config**\n\nThis module was used to handle commands related to the config file. The config class and functionality has since been removed, together\nwith all corresponding backdoor commands.\n\n### Network Infrastructure\n\n**feticost[dot]com**\n\nThe feticost domain was registered a month prior to the attack and used exclusively for C2 communications with the SombRAT backdoor:\n\n_Figure 22 Heatmap of feticost IP resolutions_\n\n\n-----\n\ne do a as eg ste ed a ja a, a p acy a a e do a eg st at o se ce, ope at g o Sa t tts a d e s t s u by ete\nSunde, co-founder of The Pirate Bay:\n\n_Figure 23: Domain registrant details (redacted for privacy)._\n\nSeveral open ports were exposed on this server:\n\nOpenSSH used for remote management\nDNS used to provide SombRAT domain generation and DNS tunneling capabilities\nports 80, 8000, and 443 also used for SombRAT C2.\n\nSombRAT will generate many subdomains as part of its domain generation algorithm (DGA) during C2 initialisation, yet very few were found\nto be active for feticost. However, the primary DGA subdomain, b71260938323880754443f274390[dot]feticost[dot]com, remains active with\nits C2 IP addresses changing fairly frequently.\n\n**celomito[dot]com**\n\nThe celomito domain was also registered via Njalla, but only a few days prior to use:\n\n_Figure 24: Heatmap of celomito IP resolutions._\n\nThis domain was again used for SombRAT C2 communications, with several subdomains being actively employed as part of the DGA:\n\nb27543ffd5a3949c5d483e2b4705.celomito.com\n5dc5a95caaaad5ce6ef4.celomito.com\nbd1540dda.celomito.com\n\n**64.227.24.12 & 157.230.184.142**\n\nThese hosts were deployed by the threat actors to host CobaltStrike Team Server. We first observed these hosts being operationalised on\n2020-12-01, as part of our in-house CS beacon tracking services.\n\n### Conclusions\n\nCostaricto’s activity, ranging from espionage to ransomware, may be representative of an evolving threat actor broadening their services. Yet\nmaking definitive claims about this group is challenging, even with the evidence presented here. For example, is this most recent campaign\nthe work of hackers-for-hire, or simply the result of a backdoor for sale? The tactics, techniques, and procedures (TTPs) used in recent\nSombRAT attacks differ from previous ones. This might mean a new threat actor has simply acquired the backdoor.\n\n\n-----\n\ne aga, t e o g a t eat acto s ay be us g So b e ays, adjust g t e tact cs to bette t t e e e o e t s\nexplanation may be more likely. If SombRAT were widely available for purchase or trade it would probably appear more often in the public\ndomain. Either way, SombRAT is being actively maintained, receiving code improvements, better obfuscation, and new feature updates. One\nparticularly concerning development is SombRAT’s ability to exfiltrate data prior to deploying ransomware.\n\nWhile precise attribution is difficult, our research indicates the latest SombRAT attacks were likely operated from the Latin American region.\n\n### BlackBerry Assistance\n\n_If you're battling an attack like this or a similar threat, help is at hand, regardless of your existing BlackBerry relationship._\n\n_[The BlackBerry Incident Response Team is made up of world-class consultants dedicated to handling response and containment services for](https://www.blackberry.com/us/en/services/incident-response)_\n_a wide range of incidents, including ransomware and Advanced Persistent Threat (APT) cases._\n\n_We have a global consulting team standing by to assist you by providing around-the-clock support, where required, as well as local_\n_assistance. Please contact us here:_\n\n[https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment.](https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containment)\n\n### Appendix\n\n Indicators of Compromise (IoCs)\n\n**Indicator** **Type** **Description**\n\nd81c13b094c59196ac45c5f0ec95446dea219fa2f2a1c35a25f883d2a18ab19d SHA256 SombRAT x86\n\n99baffcd7a6b939b72c99af7c1e88523a50053ab966a079d9bf268aff884426e SHA256 SombRAT x64\n\n61e286c62e556ac79b01c17357176e58efb67d86c5d17407e128094c3151f7f9 SHA256 SombRAT x64\n\nda97c5162cb3929f873936a4fb6311e0ce373f0fce3b94470da26906529317b2 SHA256 first32.exe - RAR SFX Dropper for a/b/c.base64\n\n01a214f011e6b92eb9844e19a49835c11a7e56116d8b21b2ee370589f6f08b82 SHA256 first64.exe - RAR SFX Dropper for a/b/c.base64\nand WwanSvc.bat\n\n84e5191cff128754215a712d8be2621bf99170d4225a60b8f4e0a9f866f9338e SHA256 Install.bat - Installation, service creation and\nclean-up\n\n72e8a12fdd375984e20935c13fd2160ee4c532122ba75eaa07d6ab95d8a79cb6 SHA256 base64.exe\n\nba0e52cc29751b983bdd34d5e59e9b6a7af8d6ddde3b5d545eb95bc3c47a4b27 SHA256 WwanSvc.bat\n\n\n-exec( ){1,}bypass( ){1,}-file( ){1,}C\\:\\\\windows\\\\tasks\\\\(.){1,}.ps1 Commandline\n\ncmd\\.exe\\|echo\\|\\>\\|\\\\\\\\\\.\\\\pipe\\\\ Commandline\n\nWwanService Service\nname\n\n\nPowerShell used to launch script from\nC:\\Windows\\Tasks folder\n\nEcho stdout from cmd.exe to a named pipe\n\nInstallation scheduled task name\n\n\nautorun.ps1.txt Filename Decode and execute ntuser.c\n\nC:\\programdata\\Microsoft\\WwanSvc.bat Filename Installation scheduled task batch script\n\nfirst32.exe Filename RAR SFX dropper for SombRAT\n\n\n-----\n\nfirst64.exe Filename RAR SFX dropper for SombRAT\n\n(a.base64|ntuser.a|WwanSvc.a) Filename XOR key used to decode the PS loader script\nand payload\n\n(b.base64|ntuser.b|WwanSvc.b) Filename XOR encoded payload\n\n(c.base64|ntuser.c|WwanSvc.c) Filename XOR encoded PS reflective PE loader script\n\nmy(15|16|420).ps1 Filename PowerShell loader for CobaltStrike beacon\nshellcode\n\nC:\\Windows\\Temp\\9ACF219F1F0DEE49 Filename SombRAT structured storage file\n\nfeticost[.]com Domain SombRAT C2\n\ncelomito[.]com Domain SombRAT C2\n\nbd1540dda.celomito[.]com Domain SombRAT C2 (DGA) C2 beacon\n\n5dc5a95caaaad5ce6ef4.celomito[.]com Domain SombRAT C2 (DGA) C2 beacon\n\nb27543ffd5a3949c5d483e2b4705.celomito[.]com Domain SombRAT C2 (DGA) C2 beacon\n\n^b[a-zA-Z0-9]{3,64}\\.(celomito|feticost)\\[.]com Domain SombRAT C2 DGA/DNS tunneling\n\n51.89.50.152 IP feticost[.]com\n\n57.219.0.1 IP celomito[.]com\n\n19.134.94.227 IP feticost[.]com (DGA) C2 beacon\n\n88.105.224.32 IP feticost[.]com (DGA) C2 beacon\n\n180.222.29.199 IP feticost[.]com (DGA) C2 beacon\n\n119.39.152.157 IP feticost[.]com (DGA) C2 beacon\n\n109.124.209.212 IP feticost[.]com (DGA) C2 beacon\n\n119.170.44.215 IP feticost[.]com (DGA) C2 beacon\n\n226.31.10.29 IP feticost[.]com (DGA) C2 beacon\n\n156.77.252.190 IP feticost[.]com (DGA) C2 beacon\n\n135.78.65.199 IP feticost[.]com (DGA) C2 beacon\n\n30.24.7.206 IP feticost[.]com (DGA) C2 beacon\n\n229.222.231.39 IP feticost[.]com (DGA) C2 beacon\n\n22.58.50.80 IP feticost[.]com (DGA) C2 beacon\n\n\n-----\n\n218.10.128.138 IP feticost[.]com (DGA) C2 beacon\n\n245.179.63.52 IP feticost[.]com (DGA) C2 beacon\n\n98.160.54.99 IP feticost[.]com (DGA) C2 beacon\n\n200.72.40.81 IP feticost[.]com (DGA) C2 beacon\n\n229.228.106.12 IP feticost[.]com (DGA) C2 beacon\n\n71.61.21.41 IP b27543ffd5a3949c5d483e2b4705.celomito[.]com\n\n79.93.190.81 IP b27543ffd5a3949c5d483e2b4705.celomito[.]com\n\n64.227.24.12 IP CobaltStrike beacon\n\n157.230.184.142 IP CobaltStrike beacon\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing intelligence analysis for the benefit of\ndefenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-13 - Threat Thursday- SombRAT — Always Leave Yourself a Backdoor.pdf"
    ],
    "report_names": [
        "2021-05-13 - Threat Thursday- SombRAT — Always Leave Yourself a Backdoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "c72c09b8-81ba-4e6e-9094-cd84ee4bda79",
            "created_at": "2022-10-25T15:50:23.667393Z",
            "updated_at": "2025-03-27T02:00:55.517974Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [
                "CostaRicto"
            ],
            "source_name": "MITRE:CostaRicto",
            "tools": [
                "PowerSploit",
                "SombRAT",
                "PsExec",
                "PS1",
                "CostaBricks"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b77f9b40-dca7-449d-819e-115cd2295b41",
            "created_at": "2022-10-25T16:07:23.502671Z",
            "updated_at": "2025-03-27T02:02:09.834738Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [],
            "source_name": "ETDA:CostaRicto",
            "tools": [
                "CostaBricks",
                "PowerSploit",
                "PsExec",
                "SombRAT",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "115cf618-02a8-42b8-8d25-305292eafedb",
            "created_at": "2023-11-21T02:00:07.396534Z",
            "updated_at": "2025-03-27T02:00:03.251048Z",
            "deleted_at": null,
            "main_name": "CostaRicto",
            "aliases": [],
            "source_name": "MISPGALAXY:CostaRicto",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536246,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1653779509,
    "ts_modification_date": 1653779509,
    "files": {
        "pdf": "https://archive.orkl.eu/2e5e0a0b08fbd7f9f364940284735c029e23bcdc.pdf",
        "text": "https://archive.orkl.eu/2e5e0a0b08fbd7f9f364940284735c029e23bcdc.txt",
        "img": "https://archive.orkl.eu/2e5e0a0b08fbd7f9f364940284735c029e23bcdc.jpg"
    }
}