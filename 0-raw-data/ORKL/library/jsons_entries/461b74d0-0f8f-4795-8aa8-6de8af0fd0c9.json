{
    "id": "461b74d0-0f8f-4795-8aa8-6de8af0fd0c9",
    "created_at": "2023-01-12T15:02:07.559636Z",
    "updated_at": "2025-03-27T02:16:26.004193Z",
    "deleted_at": null,
    "sha1_hash": "808ccced3d5f01c2744c12d709ad5597a53f547c",
    "title": "2020-07-06 - Pig in a poke- smartphone adware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:55:32Z",
    "file_modification_date": "2022-05-28T01:55:32Z",
    "file_size": 1100375,
    "plain_text": "# Pig in a poke: smartphone adware\n\n**securelist.com/pig-in-a-poke-smartphone-adware/97607/**\n\nAuthors\n\nIgor Golovin\n\nAnton Kivva\n\nOur support team continues to receive more and more requests from users complaining\nabout intrusive ads on their smartphones from unknown sources. In some cases, the solution\n[is quite](https://securelist.com/in-app-advertising-in-android/97065/) [simple. In others, the task is far harder: the](https://securelist.com/dropper-in-google-play/92496/) [adware plants itself in the system](https://encyclopedia.kaspersky.com/glossary/adware/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\npartition, and trying to get rid of it can lead to device failure. In addition, ads can be\nembedded in undeletable system apps and libraries at the code level. According to our data,\n14.8% of all users attacked by malware or adware in the past year suffered an infection of\nthe system partition.\n\nWhy is that? We observe two main strategies for introducing undeletable adware onto a\ndevice:\n\n\n-----\n\n[The malware gains root access on the device and installs adware in the system](https://securelist.com/unkillable-xhelper-and-a-trojan-matryoshka/96487/)\npartition.\nThe code for displaying ads (or its loader) gets into the firmware of the device even\nbefore it ends up in the hands of the consumer.\n\nThe Android security model assumes that an antivirus is a normal app, and according to this\nconcept, it physically can not do anything with adware or malware in system directories. This\nmakes adware a problem. The cybercriminals behind it stop at nothing that will earn them\nmoney from advertising (or rather, the forced installation of apps). As a result, malware can\n[end up on the user’s device, such as CookieStealer.](https://securelist.com/cookiethief/96332/)\n\nAs a rule, 1–5% of the total number of users of our security solutions encounter this adware\n(depending on the particular device brand). In the main, these are owners of smartphones\nand tablets of certain brands in the lower price segment. However, for some popular vendors\noffering low-cost devices, this figure can reach up to 27%.\n\n**_Users who encountered malware or adware in the system partition as a percentage of_**\n**_the total number of Kaspersky users in the country, May 2019 — May 2020_**\n\n## Who’s there?\n\n\n-----\n\nAmong the most common types of malware installed in the system partition of smartphones\nare the [Lezok and](https://android-developers.googleblog.com/2017/03/detecting-and-eliminating-chamois-fraud.html) [Triada Trojans. The latter is notable for its ad code embedded not just](https://news.drweb.com/show/?lng=en&i=11749)\nanywhere, but directly in libandroid_runtime — a key library used by almost all apps on the\ndevice. Although these threats were identified several years ago, users continue to run into\nthem.\n\nBut Lezok and Triada are just the tip of the cyber iceberg. Below, we examine what else\nusers face today and which system apps were found to contain “additional” code.\n\n### Trojan-Dropper.AndroidOS.Agent.pe\n\nThis obfuscated Trojan usually hides in the app that handles the graphical interface of the\nsystem, or in the Settings utility, without which the smartphone cannot function properly. The\nmalware delivers its payload, which in turn can download and run arbitrary files on the\ndevice.\n\n**_Trojan-Dropper.AndroidOS.Agent.pe payload functions_**\n\nIt’s interesting to note that sometimes there is no payload, and the Trojan is unable to\nperform its task.\n\n### Trojan.AndroidOS.Sivu.c\n\nThe Sivu Trojan is a dropper masquerading as an HTMLViewer app. The malware consists of\ntwo modules and can use root permissions on the device. The first module displays ads on\ntop of other windows, and in notifications.\n\n\n-----\n\n**_The Trojan checks if it can show ads on top of an on-screen app_**\n\nThe second module is a backdoor allowing remote control of the smartphone. Its capabilities\ninclude installing, uninstalling, and running apps, which can be used to covertly install both\nlegitimate and malicious apps, depending on the intruder’s goals.\n\n**_Downloading, installing, and running apps_**\n\n### AdWare.AndroidOS.Plague.f\n\n\n-----\n\nThis adware app pretends to be a system service, calling itself Android Services\n(com.android.syscore). It can download and install apps behind the user’s back, as well as\ndisplay ads in notifications.\n\n**_Secretly installing apps after the screen turns off_**\n\nWhat’s more, Plague.f can display ads in SYSTEM_ALERT_WINDOW — a pop-up window\nthat sits on top of all apps.\n\n### Trojan.AndroidOS.Agent.pac\n\nAgent.pac can imitate the CIT TEST app, which checks the correct operation of device\ncomponents. At C&C’s command, it can run apps, open URLs, download and run arbitrary\nDEX files, install/uninstall apps, show notifications, and start services.\n\n\n-----\n\n**_Running a downloaded DEX file_**\n\n### Trojan-Dropper.AndroidOS.Penguin.e\n\nThis Trojan dropper hides in an app called STS, which has no functions other than displaying\nads. The downloaded code is obfuscated. It can deploy the ToastWindow function, which in\nthis context is analogous to SYSTEM_ALERT_WINDOW — a window that sits on top of all\napps.\n\nIt can also download and run code.\n\n\n-----\n\n**_ToastWindow and launching third-party code_**\n\n### Trojan-Downloader.AndroidOS.Necro.d\n\nUnlike the previous Trojans, Necro.d is a native library located in the system directory. Its\nlaunch mechanism is built into another system library, libandroid_servers.so, which handles\nthe operation of Android services.\n\n**_Launching the Trojan_**\n\nAt the command of C&C, Necro.d can download, install, uninstall, and run apps. In addition,\nthe developers decided to leave themselves a backdoor for executing arbitrary shell\ncommands.\n\n**_Executing received commands_**\n\n\n-----\n\nOn top of that, Necro.d can download Kingroot superuser rights utility — seemingly so that\nthe OS security system does not interfere with delivering “very important” content for the\nuser.\n\n**_Downloading Kingroot_**\n\n### Trojan-Downloader.AndroidOS.Facmod.a\n\nWe came across the malware Facmod.a in apps required for the smartphone to operate\nnormally: Settings, Factory Mode, SystemUI. Our eye was caught by devices with not one,\nbut two malicious modules embedded in SystemUI.\n\n**_Decrypting the C&C address_**\n\nThe first module (com.android.systemui.assis) receives an address from the server\nufz.doesxyz[.]com for downloading and running arbitrary code under the name\nDynamicPack:\n\n\n-----\n\n**_Downloading and running third-party code_**\n\nThe second (com.cash) loads the payload from the encrypted file in the app’s resources.\nThe payload solves the usual tasks (for this type of threat) of installing and running apps:\n\n\n-----\n\n**_Stealthy installation of apps_**\n\nIn addition, Facmod.a has functions for periodically starting the browser and opening a page\nin it with advertising.\n\n### Trojan-Dropper.AndroidOS.Guerrilla.i\n\nThe Guerrilla.i Trojan is found in the Launcher system app, responsible for the functioning of\nthe smartphone “desktop.” The Trojan is tasked with periodically displaying ads and opening\nadvertising pages in the browser. Guerrilla.i receives the configuration file by calling\nhtapi.getapiv8[.]com/api.php?rq=plug. This file can also contain an address for downloading\nan additional module extending the functionality.\n\n**_Trojan-Dropper.AndroidOS.Guerrilla.i periodically displaying ads_**\n\n### Trojan-Dropper.AndroidOS.Virtualinst.c\n\nThis dropper can take cover in the Theme app (com.nbc.willcloud.themestore). Its features\nare not original: downloading, installing, and running apps without the user’s knowledge.\n\n\n-----\n\n**_Trojan-Dropper.AndroidOS.Virtualinst.c installing apps_**\n\n### AdWare.AndroidOS.Secretad.c\n\nAnother piece of adware that we discovered was built into the wallpaper catalog app. The\npayload of Secretad.c is contained in the file kgallery.c1ass. It gets unpacked and launched,\nfor example, when the device is unlocked on or apps are installed:\n\n**_Unpacking the payload_**\n\nSecretad.c can display ads in full screen mode, open pages in the browser, or launch the\nadvertised app itself. Like many other adware programs, Secretad.c can install apps without\nthe user knowing about it.\n\n\n-----\n\n**_Secretly installing apps_**\n\nThe app also has one more ad module:\n\nIts payload is encrypted in the file assets/1498203975110.dat. Among other things, it can\ncause the advertised app’s page on Google Play to unexpectedly open, installed apps to\nstart, or the browser to open.\n\n## Adware from the manufacturer\n\nSome smartphones contain adware modules pre-installed by the manufacturers themselves.\nA few vendors openly admit to embedding adware under the hood of their smartphones;\n[some allow it to be disabled, while others do not, describing it as part of their business model](https://c.realme.com/in/post-details/1211549405472096256)\nto reduce the cost of the device for the end user.\n\nThe user generally has no choice between buying the device at the full price, or a little\ncheaper with lifetime advertising. What’s more, we did not find any electronics store offering\na clear warning to users that they would be forced to watch ads. In other words, buyers might\nnot suspect that they are spending their cash on a pocket-sized billboard.\n\n### Meizu\n\n\n-----\n\nMeizu devices make no secret that they display ads in apps. The advertising is fairly\nunobtrusive, and you can even turn it off in the settings. However, in the preinstalled\nAppStore app (c4296581148a1a1a008f233d75f71821), we uncovered hidden adware able to\nload under the radar and display itself in invisible windows (such method is usually used to\nboost the number of showings), which eats up data and battery power:\n\n**_Loading ads on the quiet_**\n\nBut that’s not all. The app can download and execute third-party JavaScript code:\n\n\n-----\n\n**_Downloading and executing JS code_**\n\nFurthermore, the pre-installed AppStore app can mute the sound, access text messages,\nand cut and paste their contents into loaded pages.\n\n\n-----\n\n**_Reading text messages and using their contents in a web page_**\n\nThis approach is often used in outright malicious apps which, unbeknown to the user, sign up\nto paid subscriptions. One can only trust in the decency of the adware controllers, and hope\nthat third parties do not gain access to it.\n\nBut AppStore is not the only suspicious app on Meizu devices. In Meizu Music\n(com.meizu.media.music 19e481d60c139af3d9881927a213ed88), we found an encrypted\nexecutable file used to download and execute a certain Ginkgo SDK:\n\n\n-----\n\n**_Downloading Ginkgo SDK_**\n\nWhat this SDK does can only be guessed at: not all Meizu devices download it, and we were\nunable to get hold of the latest version. However, the versions of Ginkgo SDK that we\nobtained from other sources display ads and install apps without the user’s knowledge.\n\nThe com.vlife.mxlock.wallpaper app (04fe069d7d638d55c796d7ec7ed794a6) also contains\nan encrypted executable file, and basically offers standard functions for gray-market adware\nmodules, including the ability to install apps on the sly.\n\n**_Secretly installing apps_**\n\nWe contacted Meizu to report our findings, but did not receive a response.\n\n### Fotabinder\n\n\n-----\n\nIn addition to dubious files in devices from particular vendors, we found a problem affecting a\nhuge number of smartphones. The memory of many devices contains the file /bin/fotabinder\n[(3fdd84b7136d5871afd170ab6dfde6ca), which can download files to user devices and](https://opentip.kaspersky.com/3fdd84b7136d5871afd170ab6dfde6ca/)\nexecute code on them received from one of the following remote servers: adsunflower[.]com,\nadfuture[.]cn, or mayitek[.]com.\n\nThis file is most likely part of the update or testing system, but the encrypted C&C addresses\nand functions providing remote access to the device raise a red flag.\n\n## What does it all mean?\n\nThe examples in our investigation show that the focus of some mobile device suppliers is on\nmaximizing profits through all kinds of advertising tools, even if those tools cause\ninconvenience to the device owners. If advertising networks are ready to pay for views,\nclicks, and installations regardless of their source, it makes sense to embed ad modules into\ndevices to increase the profit from each device sold.\n\n\n-----\n\nUnfortunately, if a user purchases a device with such pre-installed advertising, it is often\nimpossible to remove it without risking damage to the system.\n\nIn this case, all hopes rest on enthusiasts who are busy creating alternative firmware for\ndevices. But it’s important to understand that reflashing can void the warranty and even\ndamage the device.\n\nAs for ad modules have not yet done anything malicious, the user can only hope that the\ndevelopers do not tack on ads from a malicious partner network without even realizing it\nthemselves.\n\n## IoC\n\n### MD5\n\n[42c97a5da141b9cfd7696583875bcef5](https://opentip.kaspersky.com/42c97a5da141b9cfd7696583875bcef5/)\n\n[0065d7177dfd65cebb1e2e788dce0082](https://opentip.kaspersky.com/0065d7177dfd65cebb1e2e788dce0082/)\n\n[fc0824678f582b0bdf65856e90cf0a01](https://opentip.kaspersky.com/fc0824678f582b0bdf65856e90cf0a01/)\n\n[520b50eee2f9dc522a87398f3bd5be94](https://opentip.kaspersky.com/520b50eee2f9dc522a87398f3bd5be94/)\n\n[cf808957da17f6a0b5d266b0e301bf63](https://opentip.kaspersky.com/cf808957da17f6a0b5d266b0e301bf63/)\n\n[04705df0913ccc0a12abddbcb757bac4](https://opentip.kaspersky.com/04705df0913ccc0a12abddbcb757bac4/)\n\n[5d05e62fb18c6e1128522fe3371d2c91](https://opentip.kaspersky.com/5d05e62fb18c6e1128522fe3371d2c91/)\n\n[5a2e5a1f768e4f33bd007f9acd2a9d0d](https://opentip.kaspersky.com/5a2e5a1f768e4f33bd007f9acd2a9d0d/)\n\n[6c0d83e9e0eeed44ab1a1e5affb68b85](https://opentip.kaspersky.com/6c0d83e9e0eeed44ab1a1e5affb68b85/)\n\n[28119119d19fc3d986df63517dee465e](https://opentip.kaspersky.com/28119119d19fc3d986df63517dee465e/)\n\n[c81d66f5206193ce76b7f4f0b813f705](https://opentip.kaspersky.com/c81d66f5206193ce76b7f4f0b813f705/)\n\n[00c62413845fba1d9ddfd0e8d99f167b](https://opentip.kaspersky.com/00c62413845fba1d9ddfd0e8d99f167b/)\n\n[d7b13e3f54ff5b8ff3e2c78e67e665eb](https://opentip.kaspersky.com/d7b13e3f54ff5b8ff3e2c78e67e665eb/)\n\n[04fe069d7d638d55c796d7ec7ed794a6](https://opentip.kaspersky.com/04fe069d7d638d55c796d7ec7ed794a6/)\n\n### C&C\n\n[www.ywupscsff[.]com/fud.do](https://opentip.kaspersky.com/www.ywupscsff.com%2Ffud.do/)\n\n[www.mzeibiyr[.]com/7ve5.do](https://opentip.kaspersky.com/www.mzeibiyr.com%2F7ve5.do/)\n\n[i151125.infourl[.]net:9080](https://opentip.kaspersky.com/i151125.infourl.net%3A9080/)\n\n[www.jueoxdr[.]com/ea.do](https://opentip.kaspersky.com/www.jueoxdr.com%2Fea.do/)\n\n[ufz.doesxyz[.]com](https://opentip.kaspersky.com/ufz.doesxyz.com/)\n\n[htapi.getapiv8[.]com/api.php?rq=plug](https://opentip.kaspersky.com/htapi.getapiv8.com%2Fapi.php%3Frq%3Dplug/)\n\n[stable.icecyber[.]org](https://opentip.kaspersky.com/stable.icecyber.org/)\n\n[404mobi[.]com](https://opentip.kaspersky.com/404mobi.com/)\n\n[51ginkgo[.]com](https://opentip.kaspersky.com/51ginkgo.com/)\n\n[lbjg7[.]com](https://opentip.kaspersky.com/lbjg7.com/)\n\n\n-----\n\n[bigdata800[.]com](https://opentip.kaspersky.com/bigdata800.com/)\n[apd1.warnlog[.]com](https://opentip.kaspersky.com/apd1.warnlog.com/)\n[apd1.thunup[.]com.](https://opentip.kaspersky.com/apd1.thunup.com/)\n\n[advertising networks](https://securelist.com/tag/advertising-networks/)\n[Adware](https://securelist.com/tag/adware/)\n[Mobile Malware](https://securelist.com/tag/mobile-malware/)\n[Mobile security](https://securelist.com/tag/mobile-security/)\n[Trojan](https://securelist.com/tag/trojan/)\n\nAuthors\n\nIgor Golovin\n\nAnton Kivva\n\nPig in a poke: smartphone adware\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-06 - Pig in a poke- smartphone adware.pdf"
    ],
    "report_names": [
        "2020-07-06 - Pig in a poke- smartphone adware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535727,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653702932,
    "ts_modification_date": 1653702932,
    "files": {
        "pdf": "https://archive.orkl.eu/808ccced3d5f01c2744c12d709ad5597a53f547c.pdf",
        "text": "https://archive.orkl.eu/808ccced3d5f01c2744c12d709ad5597a53f547c.txt",
        "img": "https://archive.orkl.eu/808ccced3d5f01c2744c12d709ad5597a53f547c.jpg"
    }
}