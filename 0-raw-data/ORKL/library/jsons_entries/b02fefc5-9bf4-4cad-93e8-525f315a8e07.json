{
    "id": "b02fefc5-9bf4-4cad-93e8-525f315a8e07",
    "created_at": "2023-01-12T15:07:53.046106Z",
    "updated_at": "2025-03-27T02:13:57.194643Z",
    "deleted_at": null,
    "sha1_hash": "de0d09629024d95f0f4d124660c961fd1740cfa6",
    "title": "2020-06-18 - Digging up InvisiMole’s hidden arsenal",
    "authors": "",
    "file_creation_date": "2022-09-01T10:17:46Z",
    "file_modification_date": "2022-09-01T10:17:46Z",
    "file_size": 536909,
    "plain_text": "# Digging up InvisiMole’s hidden arsenal\n\n**[welivesecurity.com/2020/06/18/digging-up-invisimole-hidden-arsenal](https://www.welivesecurity.com/2020/06/18/digging-up-invisimole-hidden-arsenal)**\n\nJune 18, 2020\n\nESET researchers reveal the modus operandi of the elusive InvisiMole group, including newly discovered\nties with the Gamaredon group\n\n[In our tracking of the InvisiMole group, which we discovered, named, and first reported on in 2018, we](https://www.welivesecurity.com/2018/06/07/invisimole-equipped-spyware-undercover/)\nhave found a new campaign targeting high-profile organizations in Eastern Europe. Investigating the\nattacks, in close cooperation with the affected organizations, we uncovered its updated toolset and\npreviously unknown details about InvisiMole’s tactics, techniques and procedures (TTPs).\n\nIn this blogpost, we summarize the findings published in full in our white paper, InvisiMole: The hidden\n_part of the story._\n\n[InvisiMole: The hidden part of the story](https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_InvisiMole.pdf)\n\n[Download Research Paper](https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_InvisiMole.pdf)\n\n\n-----\n\nThe InvisiMole group is a threat actor operating at least since 2013. We previously documented its two\nbackdoors, RC2CL and RC2FM, notable for their extensive spying capabilities, but we didn’t know how\nthese backdoors were delivered, spread or installed on the system.\n\nIn this recent campaign, the InvisiMole group has resurfaced with an updated toolset, targeting a small\nnumber of high-profile organizations in the military sector and diplomatic missions, both in Eastern\nEurope. According to our telemetry, the attack attempts were ongoing from late 2019 to the time of writing\nthis report.\n\nThanks to investigating the attacks in cooperation with the affected organizations, we were able to\nexpose the inner workings of the updated InvisiMole toolset.\n\nWe discovered InvisiMole’s arsenal is only unleashed after another threat group, Gamaredon, has\nalready infiltrated the network of interest, and possibly gained administrative privileges. This allows the\nInvisiMole group to devise creative ways to operate under the radar.\n\nFor example, the attackers use long execution chains, crafted by combining malicious shellcode with\nlegitimate tools and vulnerable executables. They use DNS tunneling for stealthier C&C communications,\nand place execution guardrails on the malicious components to hide the malware from security\nresearchers.\n\n## Delivery mechanism\n\nDuring our investigation, we discovered that InvisiMole is delivered to the compromised systems by a\n.NET downloader detected by ESET products as MSIL/Pterodo, the work of the Gamaredon group.\nGamaredon is a threat actor, operating at least since 2013, characterized by rapid development and\n[making little effort to stay under the radar. We recently documented the newest Gamaredon components,](https://www.welivesecurity.com/2020/06/11/gamaredon-group-grows-its-game/)\ndistributed through spearphishing emails and used to move laterally as far as possible within the target’s\nnetwork, while fingerprinting the machines.\n\nOur research now shows Gamaredon is used to pave the way for a far stealthier payload – according to\nour telemetry, a small number of Gamaredon’s targets are “upgraded” to the advanced InvisiMole\nmalware, likely those deemed particularly significant by the attackers.\n\n\n-----\n\n_Figure 1. Gamaredon’s .NET downloader can “upgrade” the victim’s machine to InvisiMole’s TCP downloader_\n\nAs we detail in the white paper, despite the evidence of collaboration, we consider Gamaredon and\nInvisiMole to be two distinct groups with different TTPs, rather than a single threat actor.\n\n## Spreading and updating mechanisms\n\nWe document three ways that InvisiMole spreads within compromised networks:\n\nUsing the [BlueKeep vulnerability in the RDP protocol (CVE-2019-0708)](https://attack.mitre.org/techniques/T1497/)\nUsing the [EternalBlue vulnerability in the SMB protocol (CVE-2017-0144)](https://attack.mitre.org/techniques/T1123/)\nUsing trojanized documents and software installers, crafted using benign files stolen from the\ncompromised organization\n\nTo craft the trojanized files, InvisiMole first steals documents or software installers from the compromised\norganization, and then creates an SFX archive that bundles the file with the InvisiMole installer. The\noriginal file is then replaced with the weaponized version, while its name, icon and metadata are\npreserved. The attackers rely on the users to share and execute these files.\n\nThis lateral movement technique is especially powerful if the trojanized file happens to be a software\ninstaller placed on a central server – a common way to deploy software in larger organizations. That way,\nInvisiMole is organically distributed to many computers that use this server.\n\n\n-----\n\nRegardless of the spreading method, the first InvisiMole component deployed on the newly-compromised\nmachines is always InvisiMole’s TCP downloader – a simple addition to the toolset that downloads the\nnext stage of the infiltration.\n\nThe second addition to the updated InvisiMole toolset, the DNS downloader, has the same functionality\nbut is designed for long-term, covert access to the machine. It uses a stealthier method of C&C\ncommunication, using a technique called DNS tunneling (see Figure 2).\n\n_Figure 2. DNS tunneling_\n\nWith DNS tunneling, the compromised client does not directly contact the C&C server; it only\ncommunicates with the benign DNS server(s) the victim machine would normally communicate with,\nwhere it sends requests to resolve a domain to its IP address. The DNS server then contacts the name\nserver responsible for the domain in the request, which is an attacker-controlled name server, and relays\nits response back to the client.\n\nThe actual C&C communication is embedded in the DNS requests and replies, unbeknownst to the\nbenign DNS server that operates as an intermediary in the communication.\n\n## Execution chains\n\n\n-----\n\nThe most notable feature of the newest InvisiMole toolset is its long execution chains, used to deploy the\nfinal payloads – the updated RC2CM and RC2CL backdoors, and the new TCP and DNS downloaders.\n\nWe reconstructed four execution chains, used by the attackers in various situations – based on the OS\nversion of the victim’s computer, and on whether they were able to gain administrative privileges on the\nsystem:\n\nThe Control Panel misuse chain uses a rare technique known from Vault 7 leaks, used to achieve\ncovert execution in the context of the Control Panel.\nThe SMInit exploit chain exploits a vulnerability in the legitimate Total Video Player software. It is\nused in cases where the attackers haven’t managed to obtain administrative privileges on the\nsystem.\nThe Speedfan exploit chain exploits a local privilege escalation vulnerability in the speedfan.sys\ndriver to inject its code to a trusted process from kernel mode.\nThe Wdigest exploit chain is InvisiMole’s flagship chain, the most elaborate, used on the newest\nversions of Windows, where the attackers have administrative privileges. It exploits a vulnerability in\nthe Windows wdigest.dll library and then uses an improved ListPlanting technique to inject its code\ninto a trusted process.\n\nThe vulnerable executables used in these chains are all introduced to the system by InvisiMole – the\nvariation of this technique with a vulnerable driver has been previously referred to as Bring Your Own\n_Vulnerable Driver by fellow researchers. For the other cases, we have named the technique Bring Your_\n_Own Vulnerable Software._\n\nWe document these tactics in detail in the Execution chains section of our white paper.\n\n\n-----\n\n_Figure 3. InvisiMole’s execution chains; padlocks indicate use of per-machine encryption_\n\nNote the heavy use of legitimate tools and per-victim encryption, shown in the overview of these four\nchains in Figure 3. It is the tactic of InvisiMole’s operators to exclusively install legitimate tools, and\nreserve the malicious payloads for later stages.\n\nTo place execution guardrails and encrypt the payloads individually per-victim, InvisiMole uses a\nWindows feature called Data Protection API (DPAPI), specifically:\n\nthe CryptProtectData API for data encryption\nthe CryptUnprotectData API for data decryption\n\nThis symmetric encryption scheme uses a key derived from the user’s logon secrets, so the decryption\nmust be performed on the same computer where the data were encrypted.\n\nFigure 4 shows a fragment of a typical InvisiMol loader that uses CryptUnprotectData for decryption and\nthen checks whether the decrypted blob starts with a characteristic InvisiMole four-byte magic value:\n\n64 DA 11 CE for 64-bit payloads\n86 DA 11 CE for 32-bit payloads\n\n\n-----\n\n_Figure 4. Fragment of a characteristic InvisiMole loader_\n\nThe DPAPI feature, intended for local storage of credentials such as Wi-Fi passwords or login passwords\nin web browsers, is abused by InvisiMole to protect its payload from security researchers. Even if they\nfind InvisiMole’s components in telemetry or on malware sharing platforms, they can’t decrypt them\noutside the victim’s computer.\n\nHowever, thanks to direct cooperation with the affected organizations, we were able to recover the\npayloads and reconstruct four of InvisiMole’s execution chains, which are described in detail in the white\npaper.\n\n## Conclusion\n\nWhen we first reported about InvisiMole in 2018, we highlighted its covert workings and complex range of\ncapabilities. However, a large part of the picture was missing.\n\nAfter discovering new activity in late 2019, we gained the opportunity to take a proper look under the\nhood of InvisiMole’s operations and piece together the hidden parts of the story. Analyzing the group’s\nupdated toolset, we observed continuous development and substantial improvements, with special focus\non staying under the radar.\n\nOur investigation also revealed a previously unknown cooperation between InvisiMole and the\nGamaredon group, with Gamaredon’s malware used to infiltrate the target network and deliver the\nsophisticated InvisiMole malware to targets of special interest.\n\n\n-----\n\nHaving provided a detailed report on InvisiMole s TTPs, we will continue to track the group s malicious\nactivities.\n\nESET detection names and other Indicators of Compromise for these campaigns can be found in the full\nwhite paper, [InvisiMole: The hidden part of the story.](https://www.welivesecurity.com/wp-content/uploads/2020/06/ESET_InvisiMole.pdf)\n\n_[Acknowledgements to fellow ESET malware researchers Matthieu Faou, Ladislav Janko and Michal](https://www.welivesecurity.com/author/mfaou/)_\n_Poslušný for their work on this investigation._\n\n## MITRE ATT&CK techniques\n\n_Note: For better readability, we have separated the RC2FM and RC2CL backdoors into their respective_\n_ATT&CK mapping tables, because of their rich capabilities. The first mapping pertains to InvisiMole’s_\n_supporting components used for delivery, lateral movement, execution chains, and for downloading_\n_additional payloads._\n\n### InvisiMole\n\n**Tactic** **ID** **Name** **Description**\n\nExecution [T1196](https://attack.mitre.org/techniques/T1196/) Control Panel Items InvisiMole’s loader is masked as\na CPL file, misusing control\npanel items for execution.\n\n\n[T1106](https://attack.mitre.org/techniques/T1106/) Execution\nthrough API\n\n[T1129](https://attack.mitre.org/techniques/T1129/) Execution\nthrough\nModule Load\n\n[T1203](https://attack.mitre.org/techniques/T1203/) Exploitation\nfor Client\nExecution\n\n\nInvisiMole has used ShellExecuteW\nand CreateProcessW APIs to execute\nfiles.\n\nInvisiMole implements a custom loader\nfor its components (InvisiMole blobs).\n\nInvisiMole has delivered vulnerable\nTotal Video Player software and\nwdigest.dll library and exploited their\nstack overflow and input validation\nvulnerabilities, respectively, to gain\ncovert code execution.\n\n\n[T1085](https://attack.mitre.org/techniques/T1085/) Rundll32 InvisiMole has used rundll32.exe as\npart of its execution chain.\n\n\n[T1053](https://attack.mitre.org/techniques/T1053/) Scheduled\nTask\n\n\nInvisiMole has used Windows task\nscheduler as part of its execution\nchains.\n\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting InvisiMole has used a JavaScript file\nnamed Control.js as part of its\nexecution chain.\n\n\n[T1035](https://attack.mitre.org/techniques/T1035/) Service\nExecution\n\n\nInvisiMole has registered a Windows\nservice as one of the ways to execute\nits malicious payload.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1204](https://attack.mitre.org/techniques/T1204/) User\nExecution\n\n\nInvisiMole has been delivered as\ntrojanized versions of software and\ndocuments, using deceiving names and\nicons and relying on user execution.\n\n\nPersistence [T1050](https://attack.mitre.org/techniques/T1050/) New Service InvisiMole has registered a\nWindows service named\nclr_optimization_v2.0.51527_X86\nto achieve persistence.\n\n\n[T1060](https://attack.mitre.org/techniques/T1060/) Registry Run\nKeys / Startup\nFolder\n\n[T1053](https://attack.mitre.org/techniques/T1053/) Scheduled\nTask\n\n[T1023](https://attack.mitre.org/techniques/T1023/) Shortcut\nModification\n\n\nInvisiMole has placed a LNK file in\nStartup Folder to achieve persistence.\n\nInvisiMole has scheduled tasks under\nnames MSST and\n\\Microsoft\\Windows\\Autochk\\Scheduled\nto achieve persistence.\n\nInvisiMole has placed a LNK file in\nStartup Folder to achieve persistence.\n\n\nPrivilege\nEscalation\n\n\n[T1088](https://attack.mitre.org/techniques/T1088/) Bypass User Account Control InvisiMole can bypass UAC to\nobtain elevated privileges.\n\n\n[T1068](https://attack.mitre.org/techniques/T1068/) Exploitation\nfor Privilege\nEscalation\n\n\nInvisiMole has exploited CVE-20075633 vulnerability in speedfan.sys\ndriver to obtain kernel mode privileges.\n\n\nDefense\nEvasion\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode Files or\nInformation\n\n\nInvisiMole decrypts strings using\nvariations of XOR cipher.\nInvisiMole decrypts its\ncomponents using the\nCryptUnprotectData API and\ntwo-key triple DES.\n\n\n[T1480](https://attack.mitre.org/techniques/T1480/) Execution\nGuardrails\n\n[T1143](https://attack.mitre.org/techniques/T1143/) Hidden\nWindow\n\n[T1066](https://attack.mitre.org/techniques/T1066/) Indicator\nRemoval from\nTools\n\n[T1202](https://attack.mitre.org/techniques/T1202/) Indirect\nCommand\nExecution\n\n\nInvisiMole has used Data Protection\nAPI to encrypt its components on the\nvictim’s computer, to evade detection\nand make sure the payload can only be\ndecrypted (and then loaded) on one\nspecific compromised computer.\n\nInvisiMole has executed legitimate tools\nin hidden windows and used them to\nexecute malicious InvisiMole\ncomponents.\n\nInvisiMole has undergone technical\nimprovements in attempt to evade\ndetection.\n\n[InvisiMole has used winapiexec tool for](https://attack.mitre.org/techniques/T1140/)\nindirect execution of Windows API\nfunctions.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated\nFiles or\nInformation\n\n[T1055](https://attack.mitre.org/techniques/T1055/) Process\nInjection\n\n[T1108](https://attack.mitre.org/techniques/T1108/) Redundant\nAccess\n\n\nInvisiMole has obfuscated strings and\ncode to make analysis more difficult,\nand encrypted its components to thwart\ndetection.\n\nInvisiMole has injected its code into\ntrusted processes using an improved\nListPlanting technique and via APC\nqueue.\n\nInvisiMole has deployed multiple\nbackdoors on a single compromised\ncomputer.\n\n\n[T1085](https://attack.mitre.org/techniques/T1085/) Rundll32 InvisiMole has used rundll32.exe as\npart of its execution chain.\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting InvisiMole’s loader uses a JavaScript\nscript as a part of setting up\npersistence.\n\n\n[T1063](https://attack.mitre.org/techniques/T1063/) Security\nSoftware\nDiscovery\n\n\nInvisiMole’s DNS plugin avoids\nconnecting to the C&C server if\nselected network sniffers are detected\nrunning.\n\n\n[T1099](https://attack.mitre.org/techniques/T1099/) Timestomp InvisiMole has modified timestamps of\nfiles that it creates or modifies.\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Masquerading InvisiMole has attempted to disguise its\ndroppers as legitimate software or\ndocuments, and to conceal itself by\nregistering under a seemingly\nlegitimate service name.\n\nDiscovery [T1046](https://attack.mitre.org/techniques/T1046/) Network Service Scanning InvisiMole has performed\nnetwork scanning within the\ncompromised network using its\nPortscan and BlueKeep\ncomponents, in order to search\nfor open ports and for hosts\nvulnerable to the BlueKeep\nvulnerability.\n\n\n[T1518](https://attack.mitre.org/techniques/T1518/) Software\nDiscovery\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System\nInformation\nDiscovery\n\n[T1124](https://attack.mitre.org/techniques/T1124/) System Time\nDiscovery\n\n\nInvisiMole’s DNS downloader attempts\nto detect selected network sniffer tools,\nand pauses its network traffic if any are\ndetected running.\n\nInvisiMole’s DNS downloader collects\ncomputer name and system volume\nserial number.\n\nInvisiMole can collect the timestamp\nfrom the victim’s machine.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nLateral\nMovement\n\n\n[T1210](https://attack.mitre.org/techniques/T1210/) Exploitation of Remote Services InvisiMole has exploited\nEternalBlue and BlueKeep\nvulnerabilities for lateral\nmovement.\n\n\n[T1080](https://attack.mitre.org/techniques/T1080/) Taint Shared\nContent\n\n\nInvisiMole has replaced legitimate\nsoftware or documents in the\ncompromised network with their\ntrojanized versions, in an attempt to\npropagate itself within the network.\n\n\nCommand\nand Control\n\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly Used Port InvisiMole’s downloader uses\nport 443 for C&C communication.\nInvisiMole’s DNS plugin uses\nport 53 for C&C communication.\n\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Connection\nProxy\n\n[T1024](https://attack.mitre.org/techniques/T1024/) Custom\nCryptographic\nProtocol\n\n[T1132](https://attack.mitre.org/techniques/T1132/) Data\nEncoding\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback\nChannels\n\n[T1105](https://attack.mitre.org/techniques/T1105/) Remote File\nCopy\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Standard\nApplication\nLayer\nProtocol\n\n[T1095](https://attack.mitre.org/techniques/T1095/) Standard\nNonApplication\nLayer\nProtocol\n\n[T1065](https://attack.mitre.org/techniques/T1065/) Uncommonly\nUsed Port\n\n### RC2CL backdoor\n\n\nInvisiMole’s TCP downloader is able to\nutilize user-configured proxy servers for\nC&C communication.\n\nInvisiMole’s TCP and DNS\ndownloaders use a custom\ncryptographic protocol for encrypting\nnetwork communication.\n\nInvisiMole’s DNS downloader uses a\nvariation of base32 encoding to encode\ndata into the subdomain in its requests.\n\nInvisiMole’s TCP and DNS\ndownloaders are configured with\nseveral C&C servers.\n\nInvisiMole’s TCP and DNS\ndownloaders can download additional\nfiles to be executed on the\ncompromised system.\n\nInvisiMole’s DNS downloader uses\nDNS protocol for C&C communication.\n\nInvisiMole’s TCP downloader uses TCP\nprotocol for C&C communication.\n\nInvisiMole’s TCP downloader uses port\n1922 for C&C communication.\n\n\n**Tactic** **ID** **Name** **Description**\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\nExecution [T1059](https://attack.mitre.org/techniques/T1059/) Command-Line Interface RC2CL backdoor can create\na remote shell to execute\ncommands.\n\n\n[T1106](https://attack.mitre.org/techniques/T1106/) Execution through\nAPI\n\n\nRC2CL backdoor uses\nCreateProcess and\nCreateProcessAsUser APIs to\nexecute files.\n\n\nPrivilege\nEscalation\n\n\n[T1134](https://attack.mitre.org/techniques/T1134/) Access Token Manipulation RC2CL backdoor can use\nCreateProcessAsUser API\nto start a new process under\nthe context of another user\nor process.\n\n\n[T1088](https://attack.mitre.org/techniques/T1088/) Bypass User Account\nControl\n\n\nRC2CL backdoor can disable and\nbypass UAC to obtain elevated\nprivileges.\n\n\nDefense\nEvasion\n\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Connection Proxy RC2CL backdoor can be\nconfigured as a proxy\nrelaying communication\nbetween other compromised\ncomputers and C&C server.\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode\nFiles or Information\n\n[T1089](https://attack.mitre.org/techniques/T1089/) Disabling Security\nTools\n\n\nRC2CL backdoor decrypts strings\nusing variations of XOR cipher.\n\nRC2CL backdoor is able to\ndisable Windows firewall.\n\n\n[T1107](https://attack.mitre.org/techniques/T1107/) File Deletion RC2CL backdoor can delete\ndropped artifacts, and various files\non-demand following a delete\ncommand.\n\nRC2CL backdoor can safely\ndelete files to thwart forensic\nanalysis.\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Modify Registry RC2CL backdoor hides its\nconfiguration within registry keys.\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or\nInformation\n\n\nRC2CL backdoor\nobfuscates/encrypts strings and\ncode to make analysis more\ndifficult.\n\n\n[T1099](https://attack.mitre.org/techniques/T1099/) Timestomp RC2CL backdoor modifies\ntimestamps of files that it\ncreates/modifies.\n\n\n[T1497](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox\nEvasion\n\n\nRC2CL backdoor is able to detect\nvirtualized environments.\n\n\nDiscovery [T1087](https://attack.mitre.org/techniques/T1087/) Account Discovery RC2CL backdoor can list\naccount information and\nsession information.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1010](https://attack.mitre.org/techniques/T1010/) Application Window\nDiscovery\n\n[T1083](https://attack.mitre.org/techniques/T1083/) File and Directory\nDiscovery\n\n[T1046](https://attack.mitre.org/techniques/T1046/) Network Service\nScanning\n\n\nRC2CL backdoor can list\ninformation about active windows.\n\nRC2CL backdoor can list files, and\nspecifically recently opened files,\nand list information about\nmapped/unmapped drives.\n\nRC2CL backdoor is able to scan\nthe compromised network for\nhosts vulnerable to EternalBlue\nvulnerability.\n\n\n[T1057](https://attack.mitre.org/techniques/T1057/) Process Discovery RC2CL backdoor can list running\nprocesses.\n\n[T1012](https://attack.mitre.org/techniques/T1012/) Query Registry RC2CL backdoor can query\nregistry to obtain information\nabout installed software,\napplications accessed by users,\napplications executed on user\nlogin/system start, recently\nopened files,\n\n\n[T1063](https://attack.mitre.org/techniques/T1063/) Security Software\nDiscovery\n\n\nRC2CL backdoor modifies its\nbehavior if Bitdefender firewall is\nenabled, or if selected AV\nprocesses are detected running.\n\n\n[T1518](https://attack.mitre.org/techniques/T1518/) Software Discovery RC2CL backdoor can list installed\nsoftware, recently accessed\nsoftware by users, software\nexecuted on each user login\nand/or each system start.\n\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information\nDiscovery\n\n[T1016](https://attack.mitre.org/techniques/T1016/) System Network\nConfiguration\nDiscovery\n\n[T1007](https://attack.mitre.org/techniques/T1007/) System Service\nDiscovery\n\n\nRC2CL backdoor can list\ninformation about loaded drivers,\ncomputer name, OS version,\nmemory status, local time, system\nand process DEP policy.\n\nRC2CL backdoor can list IP table;\nconfigured proxy information;\ninformation about enabled\nwireless networks for geolocation\nof the victims.\n\nRC2CL backdoor can list system\nservice information.\n\n\nCollection [T1123](https://attack.mitre.org/techniques/T1123/) Audio Capture RC2CL backdoor can\nrecord the sounds from\nmicrophones on a computer.\nRC2FM misuses a\nlegitimate lame.dll for MP3\nencoding of the recordings.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1005](https://attack.mitre.org/techniques/T1005/) Data from Local\nSystem\n\n\nRC2CL backdoor can collect data\nfrom the system, and can monitor\nchanges in specified directories.\n\n\n[T1074](https://attack.mitre.org/techniques/T1074/) Data Staged RC2CL backdoor can store\ncollected data in a central location\nfor a later exfiltration.\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture RC2CL backdoor can capture\nscreenshots of the victim’s screen.\nRC2CL backdoor can also capture\nscreenshots of separate windows.\n\n[T1125](https://attack.mitre.org/techniques/T1125/) Video Capture RC2CL backdoor can access\nvictim’s webcam and capture\nphotos/record videos.\n\n\nCommand\nand\nControl\n\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback Channels RC2CL backdoor is\nconfigured with several C&C\nservers. Via a backdoor\ncommand, it is possible to\nextend the list and change\nwhich C&C server is used.\n\n\n[T1105](https://attack.mitre.org/techniques/T1105/) Remote File Copy InvisiMole can download\nadditional files to be executed on\nthe compromised system.\n\n\n[T1065](https://attack.mitre.org/techniques/T1065/) Uncommonly Used\nPort\n\n\nRC2CL backdoor uses port 1922\nfor C&C communication.\n\n\nExfiltration [T1002](https://attack.mitre.org/techniques/T1002/) Data Compressed RC2CL backdoor can create\nzlib and SFX archives. It\nmisuses a copy of the\nlegitimate WinRAR tool for\ncompression and\ndecompression.\n\n[T1022](https://attack.mitre.org/techniques/T1022/) Data Encrypted RC2CL backdoor uses variations\nof XOR cipher to encrypt data.\n\n\n[T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over\nCommand and\nControl Channel\n\n### RC2FM backdoor\n\n\nRC2CL backdoor exfiltrates\ncollected information over its C&C\nchannel.\n\n\n**Tactic** **ID** **Name** **Description**\n\nExecution [T1059](https://attack.mitre.org/techniques/T1059/) Command-Line Interface RC2FM backdoor can create\na remote shell to execute\ncommands.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1106](https://attack.mitre.org/techniques/T1106/) Execution through\nAPI\n\n\nRC2FM backdoor supports a\ncommand that uses\nShellExecute and\nCreateProcess APIs to execute\nfiles.\n\n\nPrivilege\nEscalation\n\nDefense\nEvasion\n\n\n[T1088](https://attack.mitre.org/techniques/T1088/) Bypass User Account Control RC2FM backdoor can bypass\nUAC to obtain elevated\nprivileges.\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode Files or\nInformation\n\n\nRC2FM backdoor decrypts\nstrings using variations of\nXOR cipher.\n\n\n[T1107](https://attack.mitre.org/techniques/T1107/) File Deletion RC2FM backdoor can delete\ndropped artifacts, and various\nfiles on-demand following a\ndelete command.\n\n[T1143](https://attack.mitre.org/techniques/T1143/) Hidden Window RC2FM backdoor uses\nCREATE_NO_WINDOW\ncreation flag to execute malware\nin a hidden window.\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Modify Registry RC2FM backdoor hides its\nconfiguration within registry\nkeys.\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or\nInformation\n\n\nRC2FM backdoor\nobfuscates/encrypts strings and\ncode to make analysis more\ndifficult.\n\n\n[T1055](https://attack.mitre.org/techniques/T1055) Process Injection RC2FM backdoor can inject\nitself into ctfmon.exe, dwm.exe\n, sihost.exe and taskhost.exe\nprocesses.\n\n[T1085](https://attack.mitre.org/techniques/T1085/) Rundll32 RC2FM backdoor uses\nrundll32.exe to load a stub DLL\ninto which it then injects itself.\n\n[T1099](https://attack.mitre.org/techniques/T1099/) Timestamp RC2FM backdoor modifies\ntimestamps of files that it\ncreates/modifies.\n\n\n[T1497](https://attack.mitre.org/techniques/T1497/) Virtualization/Sandbox\nEvasion\n\n\nRC2FM backdoor is able to\ndetect virtualized environments.\n\n\nDiscovery [T1083](https://attack.mitre.org/techniques/T1083/) File and Directory Discovery RC2FM backdoor collects\ninformation about mapped\ndrives. It can list files in a\nspecific folder.\n\n[T1057](https://attack.mitre.org/techniques/T1057/) Process Discovery RC2FM backdoor can list\nrunning processes.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information\nDiscovery\n\n[T1016](https://attack.mitre.org/techniques/T1016/) System Network\nConfiguration\nDiscovery\n\n\nRC2FM backdoor collects\ncomputer name and system\nvolume serial number.\n\nRC2FM backdoor lists\ninformation about configured\nproxy servers.\n\n\nCollection [T1123](https://attack.mitre.org/techniques/T1123/) Audio Capture RC2FM backdoor can record\nthe sounds from microphones\non a computer. It misuses a\nlegitimate lame.dll for MP3\nencoding of the recordings.\n\n\n[T1025](https://attack.mitre.org/techniques/T1025/) Data from Removable\nMedia\n\n\nRC2FM backdoor can collect\njpeg files from connected MTP\ndevices.\n\n\n[T1056](https://attack.mitre.org/techniques/T1056/) Input Capture RC2FM backdoor can collect\nkeystrokes.\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture RC2FM backdoor can capture\nscreenshots of the victim’s\nscreen.\n\n\nCommand\nand\nControl\n\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly Used Port RC2FM backdoor uses port\n80 for C&C communication.\n\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Connection Proxy RC2FM backdoor can use\nproxies configured on the local\nsystem, for various installed and\nportable browsers, if direct\nconnection to the C&C server\nfails.\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback Channels RC2FM backdoor is configured\nwith several C&C servers. It is\npossible to update the C&C\nserver by a backdoor command.\n\n[T1105](https://attack.mitre.org/techniques/T1105/) Remote File Copy InvisiMole can download\nadditional files to be executed\non the compromised system.\n\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Standard Application\nLayer Protocol\n\n\nRC2FM backdoor uses HTTP\nfor C&C communication.\n\n\nExfiltration [T1022](https://attack.mitre.org/techniques/T1022/) Data Encrypted RC2FM backdoor uses\nvariations of XOR cipher to\nencrypt data.\n\n\n[T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration Over\nCommand and\nControl Channel\n\n18 Jun 2020 - 11:30AM\n\n\nRC2FM backdoor exfiltrates\ncollected information over its\nC&C channel.\n\n\n-----\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-18 - Digging up InvisiMole’s hidden arsenal.pdf"
    ],
    "report_names": [
        "2020-06-18 - Digging up InvisiMole’s hidden arsenal.pdf"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "11f52079-26d3-4e06-8665-6a0b3efdc41c",
            "created_at": "2022-10-25T16:07:23.736987Z",
            "updated_at": "2025-03-27T02:02:09.954078Z",
            "deleted_at": null,
            "main_name": "InvisiMole",
            "aliases": [
                "UAC-0035"
            ],
            "source_name": "ETDA:InvisiMole",
            "tools": [
                "InvisiMole"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d5156b55-5d7d-4fb2-836f-861d2e868147",
            "created_at": "2023-01-06T13:46:38.557326Z",
            "updated_at": "2025-03-27T02:00:02.861124Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Aqua Blizzard",
                "Actinium",
                "DEV-0157",
                "Blue Otso",
                "G0047",
                "PRIMITIVE BEAR",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder",
                "ACTINIUM",
                "BlueAlpha",
                "IRON TILDEN"
            ],
            "source_name": "MISPGALAXY:Gamaredon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12b5d602-4017-4a6f-a2a3-387a6e07a27b",
            "created_at": "2023-01-06T13:46:39.095233Z",
            "updated_at": "2025-03-27T02:00:02.995336Z",
            "deleted_at": null,
            "main_name": "InvisiMole",
            "aliases": [],
            "source_name": "MISPGALAXY:InvisiMole",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536073,
    "ts_updated_at": 1743041637,
    "ts_creation_date": 1662027466,
    "ts_modification_date": 1662027466,
    "files": {
        "pdf": "https://archive.orkl.eu/de0d09629024d95f0f4d124660c961fd1740cfa6.pdf",
        "text": "https://archive.orkl.eu/de0d09629024d95f0f4d124660c961fd1740cfa6.txt",
        "img": "https://archive.orkl.eu/de0d09629024d95f0f4d124660c961fd1740cfa6.jpg"
    }
}