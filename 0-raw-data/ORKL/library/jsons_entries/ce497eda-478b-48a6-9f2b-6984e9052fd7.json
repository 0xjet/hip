{
    "id": "ce497eda-478b-48a6-9f2b-6984e9052fd7",
    "created_at": "2023-01-12T15:03:50.915001Z",
    "updated_at": "2025-03-27T02:09:59.185656Z",
    "deleted_at": null,
    "sha1_hash": "7085135749db73450fd271183058cc6293023014",
    "title": "2021-08-04 - Detecting Cobalt Strike- Cybercrime Attacks (GOLD LAGOON)",
    "authors": "",
    "file_creation_date": "2022-05-28T18:17:04Z",
    "file_modification_date": "2022-05-28T18:17:04Z",
    "file_size": 156564,
    "plain_text": "# Detecting Cobalt Strike: Cybercrime Attacks\n\n**[secureworks.com/blog/detecting-cobalt-strike-cybercrime-attacks](https://www.secureworks.com/blog/detecting-cobalt-strike-cybercrime-attacks)**\n\nCounter Threat Unit Research Team\n\n_Countermeasures that detect malicious Cobalt Strike activity enabled a compromised_\n_organization to mitigate a GOLD LAGOON intrusion before the threat actors deployed_\n_ransomware. Wednesday, August 4, 2021 By: Counter Threat Unit Research Team_\nMany cybercriminals that operate malware use the ubiquitous Cobalt Strike tool to drop\nmultiple payloads after profiling a compromised network. Cobalt Strike is a commercially\navailable and popular command and control (C2) framework used by the security community\n\n\n-----\n\nas well as a wide range of threat actors. The robust use of Cobalt Strike lets threat actors\nperform intrusions with precision.\n\nSecureworks® Counter Threat Unit™ (CTU) researchers conducted a focused investigation\ninto malicious use of Cobalt Strike to gain insights about when and how the tool has been\nused. This knowledge can help to secure organizations that may be targeted by threat actors\nwith diverse motives.\n\nUnderstanding a threat actor's end goal is important. For example, the financially motivated\n[GOLD LAGOON threat group leverages the Qakbot botnet to deploy Cobalt Strike. CTU™](https://www.secureworks.com/research/threat-profiles/gold-lagoon)\nresearchers frequently observe GOLD LAGOON deploying Cobalt Strike to Qakbot-infected\nhosts that are identified as members of an Active Directory domain. The threat actors then\nuse Cobalt Strike to move laterally throughout the network, establish persistence, and\nultimately facilitate damaging post-intrusion ransomware attacks. GOLD LAGOON provides\naccess to other threat groups that deploy various ransomware families in compromised\nenvironments.\n\nThe value of early detection is highlighted by two similar incidents. In the first incident,\n[Secureworks incident responders helped the victim recover from a REvil ransomware attack.](https://www.secureworks.com/research/revil-sodinokibi-ransomware)\nThe organization did not have an endpoint detection and response (EDR) solution that\nidentified the preceding Qakbot and Cobalt Strike activity, which enabled the threat actors to\n[achieve their objectives. In the second incident, Secureworks Taegis™ XDR](https://www.secureworks.com/products/taegis/xdr)\ncountermeasures detected and alerted on the malicious Qakbot and Cobalt Strike activity in\nthe environment, enabling network defenders to respond quickly to contain and mitigate the\nintrusion before ransomware was deployed.\n\nIn this second incident, a user opened an Excel 4.0 macro worksheet attached to a phishing\nemail. The attachment downloaded and installed Qakbot. Qakbot profiled the infected host,\nsent the profiled data to its C2 servers, and then downloaded and executed Cobalt Strike\nBeacon. The threat actor used Cobalt Strike Beacon's remote code execution capability to\nexecute the ping utility. Ping identified additional accessible servers within the network. The\nthreat actor deployed Cobalt Strike Beacon on those targets and then executed arbitrary\ncommands on those systems via the Rundll32 execution utility. One of these commands\nattempted to discover domain administrator accounts.\n\nThis process of deploying Cobalt Strike Beacon to additional servers from a compromised\nhost lets network defenders detect the service established on the remote host, the admin\nshare launching content, and the resulting command execution:\n\nBy default, Cobalt Strike always leverages the Rundll32 utility for command execution.\nCobalt Strike always launches Rundll32 as a service via the 'ADMIN$' share on the\nremote host.\nThe binary that Cobalt Strike uses to launch Rundll32 via the 'ADMIN$' share always\nhas a filename that is exactly seven alphanumeric characters.\n\n\n-----\n\nThe threat actor also installed Cobalt Strike PowerShell stagers on servers accessed when\nmoving laterally through the compromised network. These stagers allowed the Cobalt Strike\nBeacon payload to execute in memory. Cobalt Strike PowerShell stager's default execution\npattern is always configured to launch as a service and is invoked from the command line\nwith the parameters \"/b /c start /b /min powershell -nop -w hidden\". The stager executes and\ndecodes a byte sequence in memory to launch Cobalt Strike via a reflected loaded library.\n\n[Table 1 maps the observed GOLD LAGOON techniques to the MITRE ATT&CK® framework.](https://attack.mitre.org/)\n\n**Observed activity** **MITRE ATT&CK mapping**\n\nPhishing campaigns [Phishing: Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001/)\n\nRemote code execution [Command and Scripting Interpreter: Windows Command Shell](https://attack.mitre.org/techniques/T1059/003/)\n[Signed Binary Proxy Execution: Rundll32](https://attack.mitre.org/techniques/T1218/011)\n[Command and Scripting Interpreter: PowerShell](https://attack.mitre.org/techniques/T1059/001)\n\nNetwork reconnaissance [Remote System Discovery](https://attack.mitre.org/techniques/T1018)\n[Account Discovery: Domain Account](https://attack.mitre.org/techniques/T1087/002)\n\nLateral movement [Remote Services: SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002)\n\nDefense evasion [Process Injection: Proc Memory](https://attack.mitre.org/techniques/T1055/009)\n[Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140)\n\nEstablishing persistence [Create or Modify System Process: Windows Service](https://attack.mitre.org/techniques/T1543/003)\n\n_Table 1. MITRE ATT&CK techniques used by GOLD LAGOON._\n\nThe availability of unauthorized Cobalt Strike versions on the dark web means that threat\nactors can abuse it. Network defenders must attempt to answer the \"friend or foe\" question\nwhen they detect Cobalt Strike in their environment, as the tool can be used for both\nlegitimate and malicious purposes. Taegis XDR, which is continually updated with\nintelligence gained through CTU research, helps organizations differentiate noise, legitimate\n[use, and actionable alerts. Preview Taegis XDR to explore more coverage for MITRE](https://www.secureworks.com/resources/tl-mitre-adversary-software-coverage-tool)\nATT&CK techniques.\n\nOther posts in this series:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-04 - Detecting Cobalt Strike- Cybercrime Attacks (GOLD LAGOON).pdf"
    ],
    "report_names": [
        "2021-08-04 - Detecting Cobalt Strike- Cybercrime Attacks (GOLD LAGOON).pdf"
    ],
    "threat_actors": [
        {
            "id": "aa5b200f-a6c6-4d17-bc65-911d9a7bf4ef",
            "created_at": "2022-10-25T16:07:23.866039Z",
            "updated_at": "2025-03-27T02:02:10.002227Z",
            "deleted_at": null,
            "main_name": "Mallard Spider",
            "aliases": [
                "Gold Lagoon"
            ],
            "source_name": "ETDA:Mallard Spider",
            "tools": [
                "Egregor",
                "Mimikatz",
                "Oakboat",
                "PinkSlip",
                "Pinkslipbot",
                "ProLock",
                "PwndLocker",
                "QakBot",
                "Qbot",
                "QuackBot",
                "QuakBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "698f4ba6-a3da-4b06-98b2-863b12a15e83",
            "created_at": "2022-10-25T16:47:55.778377Z",
            "updated_at": "2025-03-27T02:05:17.380296Z",
            "deleted_at": null,
            "main_name": "GOLD LAGOON",
            "aliases": [
                ""
            ],
            "source_name": "Secureworks:GOLD LAGOON",
            "tools": [
                "QakBot"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d5cb8d20-b5b9-4ec6-9660-3dded9bd3c89",
            "created_at": "2023-01-06T13:46:39.204681Z",
            "updated_at": "2025-03-27T02:00:03.020862Z",
            "deleted_at": null,
            "main_name": "MALLARD SPIDER",
            "aliases": [
                "GOLD LAGOON"
            ],
            "source_name": "MISPGALAXY:MALLARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535830,
    "ts_updated_at": 1743041399,
    "ts_creation_date": 1653761824,
    "ts_modification_date": 1653761824,
    "files": {
        "pdf": "https://archive.orkl.eu/7085135749db73450fd271183058cc6293023014.pdf",
        "text": "https://archive.orkl.eu/7085135749db73450fd271183058cc6293023014.txt",
        "img": "https://archive.orkl.eu/7085135749db73450fd271183058cc6293023014.jpg"
    }
}