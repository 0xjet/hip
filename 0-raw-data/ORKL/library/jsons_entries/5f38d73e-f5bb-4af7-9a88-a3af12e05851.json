{
    "id": "5f38d73e-f5bb-4af7-9a88-a3af12e05851",
    "created_at": "2023-01-12T15:06:23.848667Z",
    "updated_at": "2025-03-27T02:16:53.031177Z",
    "deleted_at": null,
    "sha1_hash": "44226736146d7bfb779106c8e0ea96836ac0ad55",
    "title": "2020-05-31 - WastedLoader or DridexLoader-",
    "authors": "",
    "file_creation_date": "2022-05-28T17:57:59Z",
    "file_modification_date": "2022-05-28T17:57:59Z",
    "file_size": 73465,
    "plain_text": "# WastedLoader or DridexLoader?\n\n**[medium.com/walmartglobaltech/wastedloader-or-dridexloader-4f47c9b3ae77](https://medium.com/walmartglobaltech/wastedloader-or-dridexloader-4f47c9b3ae77)**\n\nJason Reaves May 31, 2021\n\nJas\non\n\n\n[Jason Reaves](https://medium.com/@jason.reaves?source=post_page-----4f47c9b3ae77--------------------------------)\n\nMay 31, 2021\n\n\n3 min read\n\nBy: Jason Reaves and Joshua Platt\n\n\n-----\n\nA man with dark hair and glasses working on a laptop in his home office.\n\n\nRecent BitDefender wrote up a very detailed report on a loader that shares similarities with\nWastedLocker being delivered via RIG exploit kit[1]. At the time I was researching Dridex\nchains and since WastedLocker has code similarities with Dridex[2] and being leveraged by\nEvilCorp[2,3,4,5,6] I took a quick look at the hashes from the report.\n\nOf the hashes from the report only 1 seems publicly available,\n6ee2138d5467da398e02afe2baea9fbe. In the BitDefender report they reference an overlap\nwith WastedLocker in what they label as ‘layer1’, this is actually the crypter layer meaning if the\ncrypter is private to one group then the overlap will show up in known malware associated with\nthis group.\n\n\n-----\n\nCrypter Registry Check\nAfter unpacking the malware we are left with a sample that lines with the BitDefender report but\nsome of the characteristics also line up with other the other malware families associated with\nthis group such as the love of hiding RC4 encrypted strings using a 40 byte key that is reversed\nwhich is also used by Dridex and DoppelPaymer.\n\n\n-----\n\nCopy key and reverse it\n\nRC4\nAfter beginning to decode some of the strings I started to notice that itlooks more and more like\na Dridex Loader. Small snippet of decoded strings below:\n```\nStarting\npath:ShellFolderv0vajEOvEWKQf2dajlupVdyIEZlAQX1T7H994Q;HJPM4qNHuqGU3XeDOkMccS1IZyjev70FCe\n xmlns=\"\" version=\"1.3\"><RegistrationInfo></RegistrationInfo><Triggers><LogonTrigger>\n<Enabled>true</Enabled><UserId>ROOT\\CIMV2SELECT * FROM Win32_Fan*.dll*.exeProgram\nManagerProgmanAdvApi32~PsApi~shlwapi~shell32~WinInet/run /tn \"%ws\"\"%ws\" /grant:r\n\"%ws\":F\\NTUSER.DATwinsxsx86_*amd64_**.exe\\Sessions\\%d\\BaseNamedObjects\\SOFTWARE/TrendMicr\n\n```\n\n-----\n\nSo I decided to check if the CAPE sandbox yara rule perhaps matches this unpacked sample\nas a Dridex Loader[7], I used the rule from the CAPE decoder and it hit on the unpacked\nsample. Along with the decoder being about to decode out the Dridex Loader config I believe it\nis safe to say this is the Dridex Loader, leaving one to guess whether the other two samples are\nalso Dridex Loaders or not?\n```\n{'C2': ['51.68.224.245:4646', '188.165.17.91:8443', '173.255.246.77:691'], 'RC4_Key':\n'v0vajEOvEWKQf2dajlupVdyIEZlAQX1T7H994Q', 'BOTNET': '10111'}\n\n## References\n\n```\n1:https://www.bitdefender.com/files/News/CaseStudies/study/397/Bitdefender-PR-WhitepaperRIG-creat5362-en-EN.pdf\n\n2:https://blog.fox-it.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-theevil-corp-group/\n\n[3:https://www.wired.com/story/alleged-russian-hacker-evil-corp-indicted/](https://www.wired.com/story/alleged-russian-hacker-evil-corp-indicted/)\n\n[4:https://home.treasury.gov/news/press-releases/sm845](https://home.treasury.gov/news/press-releases/sm845)\n\n5:https://www.bellingcat.com/news/uk-and-europe/2020/02/17/v-like-vympel-fsbs-secretivedepartment-v-behind-assassination-of-zelimkhan-khangoshvili/\n\n6:https://www.rferl.org/a/in-lavish-wedding-photos-clues-to-an-alleged-russian-cyberthief-fsbfamily-ties/30320440.html\n\n7:https://github.com/kevoreilly/CAPEv2/blob/1e66d2460276b28b45bea8123cc74daa83295f68/\nmodules/processing/parsers/mwcp/DridexLoader.py\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-31 - WastedLoader or DridexLoader-.pdf"
    ],
    "report_names": [
        "2020-05-31 - WastedLoader or DridexLoader-.pdf"
    ],
    "threat_actors": [
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b296f34c-c424-41da-98bf-90312a5df8ef",
            "created_at": "2024-06-19T02:03:08.027585Z",
            "updated_at": "2025-03-27T02:05:17.350153Z",
            "deleted_at": null,
            "main_name": "GOLD DRAKE",
            "aliases": [
                "Indrik Spider ",
                "Evil Corp"
            ],
            "source_name": "Secureworks:GOLD DRAKE",
            "tools": [
                " Cobalt Strike",
                " Covenant",
                " Donut",
                " Dridex",
                " Hades",
                " Koadic",
                " LockBit",
                " Macaw Locker",
                " Mimikatz",
                " Payload.Bin",
                " Phoenix CryptoLocker",
                " PowerSploit",
                " Powershell Empire",
                " SocGholish",
                " WastedLocker",
                "BitPaymer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535983,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1653760679,
    "ts_modification_date": 1653760679,
    "files": {
        "pdf": "https://archive.orkl.eu/44226736146d7bfb779106c8e0ea96836ac0ad55.pdf",
        "text": "https://archive.orkl.eu/44226736146d7bfb779106c8e0ea96836ac0ad55.txt",
        "img": "https://archive.orkl.eu/44226736146d7bfb779106c8e0ea96836ac0ad55.jpg"
    }
}