{
    "id": "89b4d7c0-9461-44b1-8c73-b1296c8f0ef3",
    "created_at": "2023-01-12T15:04:29.42487Z",
    "updated_at": "2025-03-27T02:16:26.034367Z",
    "deleted_at": null,
    "sha1_hash": "8a15ceecb07811a2304c77e09aa26e58e83396b8",
    "title": "2022-03-03 - SharkBot- a “new” generation Android banking Trojan being distributed on Google Play Store",
    "authors": "",
    "file_creation_date": "2022-05-28T23:22:44Z",
    "file_modification_date": "2022-05-28T23:22:44Z",
    "file_size": 1695976,
    "plain_text": "# SharkBot: a “new” generation Android banking Trojan being distributed on Google Play Store\n\n**research.nccgroup.com/2022/03/03/sharkbot-a-new-generation-android-banking-trojan-being-distributed-on-google-**\nplay-store/\n\nMarch 3, 2022\n\n\n-----\n\nAuthors:\n\nAlberto Segura, Malware analyst\nRolf Govers, Malware analyst & Forensic IT Expert\n\nNCC Group, as well as many other researchers noticed a rise in Android malware last year,\nespecially Android banking malware. Within the Threat Intelligence team of NCC Group\nwe’re looking closely to several of these malware families to provide valuable information to\nour customers about these threats. Next to the more popular Android banking malware NCC\nGroup’s Threat Intelligence team also watches new trends and new families that arise and\ncould be potential threats to our customers.\n\nOne of these ‘newer’ families is an Android banking malware called SharkBot. During our\nresearch we noticed that this malware was distributed via the official Google play store. After\ndiscovery we immediately notified Google and decided to share our knowledge via this blog\npost.\n\n\n-----\n\nNCC Group s Threat Intelligence team continues analysis of SharkBot and uncovering new\nfindings. Shortly after we published this blogpost, we found several more SharkBot droppers\nin the Google Play Store. All appear to behave identically; in fact, the code seems to be a\nliteral a ‘copy-paste’ in all of them. Also the same corresponding C2 server is used in all the\nother droppers. After discovery we immediately reported this to Google. See the IoCs section\nbelow for the Google Play Store URLs of the newly discovered SharkBot dropper apps.\n\n## Summary\n\n[SharkBot is an Android banking malware found at the end of October 2021 by the Cleafy](https://www.cleafy.com/cleafy-labs/sharkbot-a-new-generation-of-android-trojan-is-targeting-banks-in-europe)\nThreat Intelligence Team. At the moment of writing the SharkBot malware doesn’t seem to\nhave any relations with other Android banking malware like Flubot, Cerberus/Alien,\nAnatsa/Teabot, Oscorp, etc.\n\nThe Cleafy blogpost stated that the main goal of SharkBot is to initiate money transfers (from\ncompromised devices) via Automatic Transfer Systems (ATS). As far as we observed, this\ntechnique is an advanced attack technique which isn’t used regularly within Android\nmalware. It enables adversaries to auto-fill fields in legitimate mobile banking apps and\ninitate money transfers, where other Android banking malware, like Anatsa/Teabot or\nOscorp, require a live operator to insert and authorize money transfers. This technique also\nallows adversaries to scale up their operations with minimum effort.\n\nThe ATS features allow the malware to receive a list of events to be simulated, and them will\nbe simulated in order to do the money transfers. Since this features can be used to simulate\ntouches/clicks and button presses, it can be used to not only automatically transfer money\nbut also install other malicious applications or components. This is the case of the SharkBot\nversion that we found in the Google Play Store, which seems to be a reduced version of\nSharkBot with the minimum required features, such as ATS, to install a full version of the\nmalware some time after the initial install.\n\nBecause of the fact of being distributed via the Google Play Store as a fake Antivirus, we\nfound that they have to include the usage of infected devices in order to spread the malicious\napp. SharkBot achieves this by abusing the ‘Direct Reply‘ Android feature. This feature is\nused to automatically send reply notification with a message to download the fake Antivirus\napp. This spread strategy abusing the Direct Reply feature has been seen recently in\nanother banking malware called Flubot, [discovered by ThreatFabric.](https://twitter.com/ThreatFabric/status/1486374206644367373)\n\nWhat is interesting and different from the other families is that SharkBot likely uses ATS to\nalso bypass multi-factor authentication mechanisms, including behavioral detection like biometrics, while at the same time it also includes more classic features to steal user’s\ncredentials.\n\n### Money and Credential Stealing features\n\n\n-----\n\nSharkBot implements the four main strategies to steal banking credentials in Android:\n\n_Injections (overlay attack): SharkBot can steal credentials by showing a WebView with_\na fake log in website (phishing) as soon as it detects the official banking app has been\nopened.\n_Keylogging: Sharkbot can steal credentials by logging accessibility events (related to_\ntext fields changes and buttons clicked) and sending these logs to the command and\ncontrol server (C2).\n_SMS intercept: Sharkbot has the ability to intercept/hide SMS messages._\n_Remote control/ATS: Sharkbot has the ability to obtain full remote control of an Android_\ndevice (via Accessibility Services).\n\nFor most of these features, SharkBot needs the victim to enable the Accessibility\n**Permissions & Services. These permissions allows Android banking malware to intercept**\nall the accessibility events produced by the interaction of the user with the User Interface,\nincluding button presses, touches, TextField changes (useful for the keylogging features),\netc. The intercepted accessibility events also allow to detect the foreground application, so\nbanking malware also use these permissions to detect when a targeted app is open, in order\nto show the web injections to steal user’s credentials.\n\n### Delivery\n\nSharkbot is distributed via the Google Play Store, but also using something relatively new in\nthe Android malware: ‘Direct reply‘ feature for notifications. With this feature, the C2 can\nprovide as message to the malware which will be used to automatically reply the incoming\nnotifications received in the infected device. This has been recently introduced by Flubot to\ndistribute the malware using the infected devices, but it seems SharkBot threat actors have\nalso included this feature in recent versions.\n\nIn the following image we can see the code of SharkBot used to intercept new notifications\nand automatically reply them with the received message from the C2.\n\n\n-----\n\nIn the following picture we can see the autoReply command received by our infected test\ndevice, which contains a shortten Bit.ly link which redirects to the Google Play Store sample.\n\nWe detected the SharkBot reduced version published in the Google Play on 28th February,\nbut the last update was on 10th February, so the app has been published for some time now.\nThis reduced version uses a very similar protocol to communicate with the C2 (RC4 to\nencrypt the payload and Public RSA key used to encrypt the RC4 key, so the C2 server can\ndecrypt the request and encrypt the response using the same key). This SharkBot version,\nwhich we can call SharkBotDropper is mainly used to download a fully featured SharkBot\nfrom the C2 server, which will be installed by using the Automatic Transfer System (ATS)\n(simulating click and touches with the Accessibility permissions).\n\nThis malicious dropper is published in the Google Play Store as a fake Antivirus, which really\nhas two main goals (and commands to receive from C2):\n\n**Spread the malware using ‘Auto reply’ feature: It can receive an ‘autoReply’**\ncommand with the message that should be used to automatically reply any notification\nreceived in the infected device. During our research, it has been spreading the same\nGoogle Play dropper via a shorten Bit.ly URL.\n\n**Dropper+ATS: The ATS features are used to install the downloaded SharkBot sample**\nobtained from the C2. In the following image we can see the decrypted response\nreceived from the C2, in which the dropper receives the command ‘b‘ to download the\nfull SharkBot sample from the provided URL and the ATS events to simulate in order to\nget the malware installed.\n\n\n-----\n\nWith this command, the app installed from the Google Play Store is able to install and enable\nAccessibility Permissions for the fully featured SharkBot sample it downloaded. It will be\nused to finally perform the ATS fraud to steal money and credentials from the victims.\n\nThe fake Antivirus app, the SharkBotDropper, published in the Google Play Store has more\nthan 1,000 downloads, and some fake comments like ‘It works good’, but also other\ncomments from victims that realized that this app does some weird things.\n\n\n-----\n\n## Technical analysis\n\n### Protocol & C2\n\nThe protocol used to communicate with the C2 servers is an HTTP based protocol. The\nHTTP requests are made in plain, since it doesn’t use HTTPs. Even so, the actual payload\nwith the information sent and received is encrypted using RC4. The RC4 key used to encrypt\nthe information is randomly generated for each request, and encrypted using the RSA Public\n\n\n-----\n\nKey hardcoded in each sample. That way, the C2 can decrypt the encrypted key (rkey field\nin the HTTP POST request) and finally decrypt the sent payload (rdata field in the HTTP\nPOST request).\n\nIf we take a look at the decrypted payload, we can see how SharkBot is simply using JSON\nto send different information about the infected device and receive the commands to be\nexecuted from the C2. In the following image we can see the decrypted RC4 payload which\nhas been sent from an infected device.\n\nTwo important fields sent in the requests are:\n\n**ownerID**\n**botnetID**\n\nThose parameters are hardcoded and have the same value in the analyzed samples. We\nthink those values can be used in the future to identify different buyers of this malware, which\nbased on our investigation is not being sold in underground forums yet.\n\n### Domain Generation Algorithm\n\nSharkBot includes one or two domains/URLs which should be registered and working, but in\ncase the hardcoded C2 servers were taken down, it also includes a Domain Generation\nAlgorithm (DGA) to be able to communicate with a new C2 server in the future\n\n\n-----\n\nThe DGA uses the current date and a specific suffix string\n(‘pojBI9LHGFdfgegjjsJ99hvVGHVOjhksdf’) to finally encode that in base64 and get the first\n19 characters. Then, it append different TLDs to generate the final candidate domain.\n\nThe date elements used are:\n\n**Week of the year (v1.get(3) in the code)**\n**Year (v1.get(1) in the code)**\n\nIt uses the ‘+’ operator, but since the week of the year and the year are Integers, they are\nadded instead of appended, so for example: for the second week of 2022, the generated\nstring to be base64 encoded is: 2 + 2022 + “pojBI9LHGFdfgegjjsJ99hvVGHVOjhksdf” = 2024\n+ “pojBI9LHGFdfgegjjsJ99hvVGHVOjhksdf” =\n“2024pojBI9LHGFdfgegjjsJ99hvVGHVOjhksdf”.\n\nIn previous versions of SharkBot (from November-December of 2021), it only used the\ncurrent week of the year to generate the domain. Including the year to the generation\nalgorithm seems to be an update for a better support of the new year 2022.\n\n### Commands\n\nSharkBot can receive different commands from the C2 server in order to execute different\nactions in the infected device such as sending text messages, download files, show\ninjections, etc. The list of commands it can receive and execute is as follows:\n\n**smsSend: used to send a text message to the specified phone number by the TAs**\n**updateLib: used to request the malware downloads a new JAR file from the specified**\nURL, which should contain an updated version of the malware\n**updateSQL: used to send the SQL query to be executed in the SQLite database which**\nSharkbot uses to save the configuration of the malware (injections, etc.)\n**stopAll: used to reset/stop the ATS feature, stopping the in progress automation.**\n**updateConfig: used to send an updated config to the malware.**\n**uninstallApp: used to uninstall the specified app from the infected device**\n**changeSmsAdmin: used to change the SMS manager app**\n\n\n-----\n\n**getDoze: used to check if the permissions to ignore battery optimization are enabled,**\nand show the Android settings to disable them if they aren’t\n**sendInject: used to show an overlay to steal user’s credentials**\n**getNotify: used to show the Notification Listener settings if they are not enabled for the**\nmalware. With this permissions enabled, Sharkbot will be able to intercept notifications\nand send them to the C2\n**APP_STOP_VIEW: used to close the specified app, so every time the user tries to**\nopen that app, the Accessibility Service with close it\n**downloadFile: used to download one file from the specified URL**\n**updateTimeKnock: used to update the last request timestamp for the bot**\n**localATS: used to enable ATS attacks. It includes a JSON array with the different**\nevents/actions it should simulate to perform ATS (button clicks, etc.)\n\n### Automatic Transfer System\n\nOne of the distinctive parts of SharkBot is that it uses a technique known as Automatic\nTransfer System (ATS). ATS is a relatively new technique used by banking malware for\nAndroid.\n\n\n-----\n\nTo summarize ATS can be compared with webinject, only serving a different purpose. Rather\nthen gathering credentials for use/scale it uses the credentials for automatically initiating wire\ntransfers on the endpoint itself (so without needing to log in and bypassing 2FA or other antifraud measures). However, it is very individually tailored and request quite some\nmaintenance for each bank, amount, money mules etc. This is probably one of the reasons\nATS isn’t that popular amongst (Android) banking malware.\n\n**How does it work?**\n\nOnce a target logs into their banking app the malware would receive an array of events\n(clicks/touches, button presses, gestures, etc.) to be simulated in an specific order. Those\nevents are used to simulate the interaction of the victim with the banking app to make money\ntransfers, as if the user were doing the money transfer by himself.\n\nThis way, the money transfer is made from the device of the victim by simulating different\nevents, which make much more difficult to detect the fraud by fraud detection systems.\n\n### IoCs\n\nSample Hashes:\n\na56dacc093823dc1d266d68ddfba04b2265e613dcc4b69f350873b485b9e1f1c (Google\nPlay SharkBotDropper)\n9701bef2231ecd20d52f8fd2defa4374bffc35a721e4be4519bda8f5f353e27a (Dropped\nSharkBot v1.64.1)\n20e8688726e843e9119b33be88ef642cb646f1163dce4109b8b8a2c792b5f9fc (Google\nplay SharkBot dropper)\n187b9f5de09d82d2afbad9e139600617685095c26c4304aaf67a440338e0a9b6 (Google\nplay SharkBot dropper)\ne5b96e80935ca83bbe895f6239eabca1337dc575a066bb6ae2b56faacd29dd (Google\nplay SharkBot dropper)\n\nSharkBotDropper C2:\n\nhxxp://statscodicefiscale[.]xyz/stats/\n\n‘Auto/Direct Reply’ URL used to distribute the malware:\n\nhxxps://bit[.]ly/34ArUxI\n\nGoogle Play Store URL:\n\nC2 servers/Domains for SharkBot:\n\nn3bvakjjouxir0zkzmd[.]xyz (185.219.221.99)\nmjayoxbvakjjouxir0z[.]xyz (185.219.221.99)\n\n\n-----\n\nRSA Public Key used to encrypt RC4 key in SharkBot:\n```\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2R7nRj0JMouviqMisFYt0F2QnScoofoR7svCcjrQcT\n\n```\nRSA Public Key used to encrypt RC4 Key in the Google Play SharkBotDropper:\n```\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu9qo1QgM8FH7oAkCLkNO5XfQBUdl+pI4u2tvyFiZZ6\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-03 - SharkBot- a “new” generation Android banking Trojan being distributed on Google Play Store.pdf"
    ],
    "report_names": [
        "2022-03-03 - SharkBot- a “new” generation Android banking Trojan being distributed on Google Play Store.pdf"
    ],
    "threat_actors": [
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535869,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653780164,
    "ts_modification_date": 1653780164,
    "files": {
        "pdf": "https://archive.orkl.eu/8a15ceecb07811a2304c77e09aa26e58e83396b8.pdf",
        "text": "https://archive.orkl.eu/8a15ceecb07811a2304c77e09aa26e58e83396b8.txt",
        "img": "https://archive.orkl.eu/8a15ceecb07811a2304c77e09aa26e58e83396b8.jpg"
    }
}