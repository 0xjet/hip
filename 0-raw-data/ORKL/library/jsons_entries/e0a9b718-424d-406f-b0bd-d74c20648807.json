{
    "id": "e0a9b718-424d-406f-b0bd-d74c20648807",
    "created_at": "2022-10-25T16:48:18.943645Z",
    "updated_at": "2025-03-27T02:14:43.61822Z",
    "deleted_at": null,
    "sha1_hash": "ecc2daeb3c747d13f4f94c6058df8564a1474ca3",
    "title": "CeidPageLock: A Chinese RootKit - Check Point Research",
    "authors": "",
    "file_creation_date": "2018-08-31T22:26:16Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1660917,
    "plain_text": "Search IPS Protections, Malware Families, Applications and more...\n\n\n-----\n\nResearch by: Israel Gubi\n\nOver the last few weeks, we have been observing a rootkit named CEIDPageLock being\n\ndistributed by the RIG Exploit kit.\n\n\n# CeidPageLock: A Chinese RootKit\n\n\n-----\n\nturn their home page into a site pretending to be 2345.com a Chinese web directory.\n\nWhile already quite sophisticated for a browser hijacker, the new version of the rootkit\n\nobserved in the wild contains a few notable improvements that make it even more effective.\n\nChiefly among them is a new functionality that monitors user browsing and dynamically\n\nreplaces the content of several popular Chinese websites with the fake home page,\n\nwhenever the user tries to visit them.\n\nBrowser hijacking employed by malware like CEIDPageLock, can be profitable due to\n\nrevenue earned via redirecting victims to search engines that share ad revenue with the\n\nreferrers. Additionally, CEIDPageLock operators uses the various hijacking tricks in order\n\nto gather browsing data on its victims – monitoring the sites users visit and how long they\n\nspend on those web pages. They then either use the information themselves to target their\n\nad campaigns or sell it to other companies that use the data to focus their marketing\n\ncontent.\n\nBased on Check Point’s global sensors, CEIDPageLock targets Chinese victims in particular\n\nwhile there are a negligible number of infections outside of china.\n\nCountry No. of Hits\n\nChina 11,000\n\nUS 40\n\nTaiwan 18\n\nHong Kong 10\n\nUnited Kingdom 5\n\nDenmark 5\n\nJapan 2\n\nFigure 1: Number of infections by country\n\n\n-----\n\nsave it in \\\\Windows\\\\Temp directory with the name houzi.sys (older version of the\n\ndriver was named “CEID.sys” – which is the reason for the malware’s name).\n\nThe dropped driver has a certificate signed by\n\n[+] 浙江恒歌网络科技有限公司\n\n[+] Thawte Code Signing CA – G2\n\n[+] thawte\n\nalthough, this certificate has actually been revoked by the issuer.\n\nAfter registering and starting the driver, the dropper sends the mac address and user-id of\n\nthe poisoned computer to the domain www[.]tj999[.]top with the following header:\n\n“GET /tongji.php?userid=%s&mac=%s HTTP/1.1”\n\nThe Driver\n\nThe driver is a 32-bit kernel-mode driver that is launched among the standard system\n\ndrivers during startup. The driver is fairly stealthy, employing tricks to evade and hide from\n\nendpoint security products. Its main functionality is connecting with one of 2 C&C hard\ncoded domains in order to download the desired homepage configuration to tamper the\n\nbrowser with. The home page is downloaded encrypted from the C&C server while using\n\nthe following headers:\n\n\n-----\n\nThe decrypted homepage is taken from the site 588[.]gychina[.]org and the URL of the\n\nhijacked homepage is 111[.]l2345[.]cn. It pretends to be 2345.com but down the surface\n\ngathers stats on the victim and makes profit from every search query the user makes in that\n\npage.\n\nFigure 3: The hijacked homepage view.\n\n\n-----\n\nFigure 4: The hijacked homepage source page.\n\nA further deep technical analysis for the older version can be found in 360 Security’s\n\npublication. Below we will highlight some of the interesting additions and differences\n\nbetween the older and newer versions.\n\nDifferences between versions\n\n- In contrast to the first version, the newer version of the rootkit is packed with VMProtect,\n\nwhich makes analysis and unpacking difficult, especially for kernel mode drivers.\n\n\n-----\n\nFigure 5: Example of VMProtect obfuscation for every API call.\n\nA major addition in the new version is a “redirection” method that sends victims to the fake\n\nhomepage whenever they are attempting to visit several popular Chinese websites. When\n\nthe rootkit starts it opens “\\\\Driver\\\\AFD” and hooks its AfdFastIoDeviceControl method.\n\nUsing this method, the rootkit checks every outgoing HTTP message for one of the following\n\nstrings:\n\nFigure 6: Searched strings in the url for redirection to hijacked homepage.\n\nIn case one of these strings is found in the HTTP packet, the rootkit adds the process to a\n\n“redirected processes” list. Then, the rootkit checks in every received message whether the\n\nprocess who called the recv method belongs to that list, and if so, it modifies the response\n\ncontent to the contents of the 111[.]l2345[.]cn page. This method is sneakier than performing\n\nan actual HTTP redirection, since the URL displayed in the browser is not altered.\n\n\n-----\n\nFigure 7: Sohu.com “redirection” hijacked page.\n\nFigure 8: Sohu.com “redirection” changed source page.\n\nAs written in 360 safe security analysis on the older version, CEIDPageLock blocks\n\nbrowsers from accessing number of anti-virus’ files. In the new version, CEIDPageLock has\nadded more anti-virus files to that method:\n\nFigure\n\n\n-----\n\nDifference in “access disabled files” method between new (right image) and old (left image)\nversions\n\n\n-----\n\nFigure 10: Safemon registry key creating method.\n\nConclusion\n\nAt first glance, writing a rootkit that functions as a browser hijacker and employing\nsophisticated protections such as VMProtect, might seem like overkill. However, it seems\n\nthat this simple malicious technique can be very profitable and thus the attackers believe\nthat it is worthwhile to invest in building a stealthy and persistent tool for it.\n\nAlso, while CEIDPageLock might seem merely bothersome and hardly dangerous, the\n\nability to execute code on an infected device while operating from the kernel, coupled with\nth i t f th l k it t ti ll f t b kd\n\n\n-----\n\nwww[.]tj999[.]top\n42.51.223.86\n\n118.193.211.11\n\nMD5:\n\nC7A5241567B504F2DF18D085A4DDE559 – packed dropper\nF7CAF6B189466895D0508EEB8FC25948 – houzi.sys\n\n1A179E3A93BF3B59738CBE7BB25F72AB – unpacked dropper\n\n\nRELATED ARTICLES\n\n\nRansom Warrior\nDecryption Tool\n\n\n-----\n\nEternalBlue –\nEverything There Is To\nKnow\n\nInteractive Mapping of\nAPT-C-23\n\nLabeless Part 3: How\nto Dump and AutoResolve WinAPI Calls\nin LockPos Point-ofSale Malware\n\n\nSale Malware\n\n\n-----\n\nLabeless Part 1: An\nIntroduction\n\n\nIPS ADVISORIES\n\n[Suspicious Scriptlet Downloader](http://www.checkpoint.com/defense/advisories/public/2018/cpai-2018-0858.html)\n\nApache ActiveMQ QueueFilter Cross-Site\nScripting (CVE-2018-8006)\n\nApache Struts Remote Code Execution (CVE\n2018-11776)\n\nWordPress Ninja Forms Plugin Remote Code\n\nExecution\n\nMicrosoft Windows VBScript Engine Remote\nCode Execution (CVE-2018-8373)\n\n\n-----\n\nPUBLICATIONS\n\n[GLOBAL CYBER ATTACK REPORTS](https://research.checkpoint.com/category/threat-intelligence-reports/)\n\n[RESEARCH PUBLICATIONS](https://research.checkpoint.com/category/threat-research/)\n\n[INCIDENT RESPONSE](https://research.checkpoint.com/category/incident-response/)\n\n[IPS ADVISORIES](https://www.checkpoint.com/advisories/)\n\n[CHECK POINT BLOG](http://blog.checkpoint.com/)\n\n[DEMOS](https://research.checkpoint.com/category/demos/)\n\nABOUT US\n\nCONTACT US\n\nSUBSCRIBE\n\n© 1994-2018 Check Point Software Technologies LTD. All rights reserved.\n\n[Propery of CheckPoint.com | Privacy Policy](https://www.checkpoint.com/)\n\n\nTOOLS\n\n[SANDBLAST FILE ANALYSIS](https://threatemulation.checkpoint.com/)\n\n[URL CATEGORIZATION](https://www.checkpoint.com/urlcat/)\n\n[INSTANT SECURITY ASSESSMENT](http://www.cpcheckme.com/checkme/)\n\n[LIVE THREAT MAP](https://threatmap.checkpoint.com/ThreatPortal/livemap.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.08.28.CeidPageLock/ceidpagelock-a-chinese-rootkit.pdf"
    ],
    "report_names": [
        "ceidpagelock-a-chinese-rootkit"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b1979c55-037a-415f-b0a3-cab7933f5cd4",
            "created_at": "2024-04-24T02:00:49.561432Z",
            "updated_at": "2025-03-27T02:00:55.493381Z",
            "deleted_at": null,
            "main_name": "APT-C-23",
            "aliases": [
                "APT-C-23",
                "Arid Viper",
                "Desert Falcon",
                "TAG-63",
                "Grey Karkadann",
                "Big Bang APT",
                "Two-tailed Scorpion"
            ],
            "source_name": "MITRE:APT-C-23",
            "tools": [
                "Micropsia"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "77c08a4a-b3f9-43ee-9d84-04ba572b7564",
            "created_at": "2024-05-01T02:03:07.927023Z",
            "updated_at": "2025-03-27T02:05:17.248836Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SHADYSIDE",
            "aliases": [
                "Arid Viper ",
                "Desert Falcon ",
                "APT-C-23 "
            ],
            "source_name": "Secureworks:ALUMINUM SHADYSIDE",
            "tools": [
                " SpyC23",
                "Micropsia"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041683,
    "ts_creation_date": 1535754376,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/ecc2daeb3c747d13f4f94c6058df8564a1474ca3.pdf",
        "text": "https://archive.orkl.eu/ecc2daeb3c747d13f4f94c6058df8564a1474ca3.txt",
        "img": "https://archive.orkl.eu/ecc2daeb3c747d13f4f94c6058df8564a1474ca3.jpg"
    }
}