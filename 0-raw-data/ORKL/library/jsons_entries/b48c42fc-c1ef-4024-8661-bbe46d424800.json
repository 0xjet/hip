{
    "id": "b48c42fc-c1ef-4024-8661-bbe46d424800",
    "created_at": "2023-01-12T15:05:11.565519Z",
    "updated_at": "2025-03-27T02:05:50.289711Z",
    "deleted_at": null,
    "sha1_hash": "4ec95e963f879aa263d86e824ea513db663e33eb",
    "title": "2020-03-01 - BackDoor.Spyder.1",
    "authors": "",
    "file_creation_date": "2022-05-27T23:27:05Z",
    "file_modification_date": "2022-05-27T23:27:05Z",
    "file_size": 986795,
    "plain_text": "# BackDoor.Spyder.1\n\n**vms.drweb.com/virus/**\n\n**Packer: absent**\n\n**Compilation date: 01.12.2016 05:57:59**\n\n**SHA1 hash:**\n\n4c871eae022c8088f6e8d46e17002cd0c0006650\n\n## Description\n\nA backdoor written in C++ and designed to run on 64-bit Microsoft Windows operating\nsystems. It is used for targeted attacks on information systems, collecting information about\nan infected device, loading functional malicious modules, coordinating their work, and\nproviding communication with the C&C server. In the infected system, it exists as a DLL file\nand is loaded by the system service using the DLL Hijacking method. After injection, it\nfunctions in the computer's RAM.\n\n## Operating routine\n\nThe backdoor is a malicious DLL file. The function names in its export table duplicate the\nexported functions of the apphelp.dll system library.\n\n\n-----\n\nOn the infected computer, the backdoor file was located in C:\\Windows\\System32\\oci.dll\ncatalog. The file’s original name from the export table is dll. It was loaded by the MSDTC\nsystem service using the DLL Hijacking method (Microsoft Distributed Transaction\nCoordinator Service).\n\nFrom a functional point of view, the sample is a loader for the main payload, which is stored\nin the .data section as a DLL, with some elements of the DOS and PE headers equal to zero.\n\n\n-----\n\n## The loader operation\n\nLoading is performed in a function designated as malmain_3 and called from the DLL entry\npoint via two transitional functions.\n\nFirst, the header signatures are checked. If they are not standard, the\nERROR_BAD_EXE_FORMAT error value is set; however, this action does not affect the\nloader operation in any way.\n\nThe memory for the image is then allocated according to the\nIMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage value, and the loader_struc\nauxiliary structure is formed.\n\n\n-----\n\n```\nstruct loader_struc\n{\n IMAGE_NT_HEADERS64 *pPE_header;\n LPVOID ImageBase;\n HMODULE *p_imported_modules\n QWORD number_of_imported_modules\n HMODULE (__stdcall *pLoadLibrary)(LPCSTR lpLibFileName);\n FARPROC (__stdcall *pGetProcAddress)(HMODULE hModule, LPCSTR lpProcName);\n BOOL (__stdcall *pFreeLibrary)(HMODULE hLibModule);\n QWORD unk;\n};\n\n```\nThis is followed by the standard process of loading the PE module into memory and calling\nthe loaded module's entry point (DllMain) with the DLL_PROCESS_ATTACH argument, and\nafter exiting it, calling it again with DLL_PROCESS_DETACH.\n\n## The main module operation\n\nIn the main module, the values of all signatures required for the correct file loading are equal\nto zero.\n\nIMAGE_DOS_HEADER.e_magic\nIMAGE_NT_HEADERS64.Signature\nIMAGE_NT_HEADERS64.FileHeader.Magic\n\nIn addition, TimeDateStamp and section names also have a null value. The remaining values\nare correct, thus after manually editing the necessary signatures, the file can be downloaded\nfor analysis as a proper PE module.\n\nThe analysis of the main module is complicated, since atypical methods of calling functions\n[are periodically used. The UT hash library is used for storing and processing structures. It](https://github.com/troydhanson/uthash)\nallows one to convert standard C structures to hash tables by adding a single member of the\nut_hash_handle type. All library functions, such as adding elements, search, delete, etc., are\nimplemented as macros, which leads them to be forcibly inlined by the compiler in the code\nof the main (calling) function.\n\nThe [mbedtls library is used to interact with the C&C server.](https://github.com/ARMmbed/mbedtls)\n\n## DllMain function\n\nAt the beginning of execution, the Global\\\\BFE_Notify_Event_{65a097fe-6102-446a-9f9c55dfc3f45853}, event, execution mode (from the configuration), and the command line are\nchecked, then the operating threads are started.\n\n\n-----\n\nThe module has an embedded configuration with the following structure:\n\n\n-----\n\n```\nstruct cfg_c2_block\n{\n  int type;\n  char field_4[20];\n  char addr[256];\n}\nstruct cfg_proxy_data\n{\n  DWORD dw;\n  char str[256];\n  char proxy_server[256];\n  char username[64];\n  char password[32];\n  char unk[128];\n};\nstruct builtin_config\n{\n  int exec_mode;\n  char url_C2_req[100];\n  char hash_id[20];\n  char string[64];\n  char field_BC;\n  cfg_c2_block srv_1;\n  cfg_c2_block srv_2;\n  cfg_c2_block srv_3;\n  cfg_c2_block srv_4;\n  cfg_proxy_data proxy_1;\n  cfg_proxy_data proxy_1;\n  cfg_proxy_data proxy_1;\n  cfg_proxy_data proxy_1;\n  int CA_cert_len;\n  char CA_cert[cert_len];\n};\n\n```\nThe hash field contains a value that can be an identifier. This value is used when\ncommunicating with the C&C server and can be represented as a\nb2e4936936c910319fb3d210bfa55b18765db9cc string, which is the same length as the\nSHA1 hashes.\n\nThe string field contains a single character string: 1.\n\nCA_cert is a certificate of the certificate authority in the DER format. It is used to establish a\nconnection to the C&C server over the TLS 1.2 protocol.\n\n\n-----\n\nCertificate information can be found in the notes to this description.\n\nThe DllMain function enables for the creation of multiple operating threads depending on a\nnumber of conditions.\n\nMain thread — thread_1_main\nNew server request thread — thread_2_get_new_C2_start_communication\nEncrypted module execution thread — thread_4_execute_encrypted_module\n\nFor execution, the value of the builtin_config.exec_mode parameter must be non-zero.\n\nif the builtin_config.exec_mode value is 1 or 2, and the process command line contains\nthe -k netsvcs substring, the main thread and the thread for getting the new C&C\nserver address are started;\nIf builtin_config.exec_mode is equal to 2, a thread that decrypts and runs the module\nstored in the system is started;\nIf the value is 3, the main thread and the thread for getting the new C&C server\naddress are started.\n\nIn the examined sample, the value of the exec_mode parameter is 3.\n\n## The main thread\n\nFirst, the backdoor checks the OS version then prepares a structure for initializing functions\nand a structure for storing a certain configuration fields. The procedure looks artificially\ncomplicated.\n\n\n-----\n\n3 pointers to functions are inserted to the funcs_struc structure of the funcs_1 type that will\nbe called in turn inside the init_global_funcs_and_allocated_cfg function.\n\nIn the set_global_funcs_by_callbacks function, each initializer function is called in turn.\n\nThe general order of structure forming is as follows:\n\n1. Two structures are passed to each function: the first contains pointers to some\n\nfunctions; the second is empty.\n2. Each function transfers function pointers from one structure to another.\n3. After calling the initializer function, the function pointers are moved from the local\n\nstructure to the global array of structures at a certain index.\n\nAs a result, after all the unusual transformations, a certain number of global structures that\nare combined into a single array remain.\n\n\n-----\n\nUltimately, the function call can be represented as follows.\n\nThe use of complex transformations like copying local structures with functions and\ntransferring them to global structures is probably intended to complicate the analysis of a\nmalicious sample.\n\nThe backdoor then uses the UT hash library to generate a hash table of service structures\nresponsible for storing the network connection context, connection parameters, etc.\n\nBelow is the fragment of the hash table generation code.\n\nIt is worth noting that the hash table contains a signature value that allows one to determine\nthe library used: g_p_struc_10->hh.tbl->signature = 0xA0111FE1;.\n\nThe backdoor in question is characterized by the distribution of relevant fields and data\nacross several structures created specifically for this purpose. This feature makes it difficult\nto create meaningful names for structures during analysis.\n\nAfter the preparatory steps, the backdoor proceeds to initialize the connection to the C&C\nserver\n\n\n-----\n\n## Initializing the connection to the C&C server\n\nIt is noteworthy that the program code associated with the network connection contains its\nown error codes, in addition to the codes from the mbedtls library.\n\nA list of error codes found in the sample.\n```\nenum ERROR_CODES\n{\n  ERROR_CODE_1392 = 0x1392,\n  ERROR_BAD_ARGS = 0x5208,\n  ERROR_CODE_520B = 0x520B,\n  ERROR_CODE_520D = 0x520D,\n  ERROR_CODE_59D8 = 0x59D8,\n  ERROR_CODE_59DB = 0x59DB,\n  ERROR_CODE_59DC = 0x59DC,\n  ERROR_INVALID_ARGUMENT = 0x59DE,\n  ERROR_CODE_59DF = 0x59DF,\n  ERROR_CODE_61A8 = 0x61A8,\n  ERROR_BAD_ALLOCATION = 0x61A9,\n  ERROR_BAD_PACKET_SIGNATURE = 0x61AA,\n  ERROR_CODE_61AB = 0x61AB,\n  ERROR_CODE_61AC = 0x61AC,\n  ERROR_CODE_61AD = 0x61AD,\n  ERROR_CODE_61AF = 0x61AF,\n  ERROR_CODE_61B0 = 0x61B0,\n  ERROR_CODE_61B1 = 0x61B1,\n  ERROR_BUFFER_NOT_EMPTY = 0x61B2,\n  ERROR_CODE_6590 = 0x6590,\n  ERROR_CODE_6592 = 0x6592,\n  ERROR_BAD_ALLOC = 0x6593,\n};\n\n```\nAfter a series of preparatory actions, the backdoor resolves the address of the C&C server\nstored in the configuration and retrieves the port. Addresses in the configuration are stored\nas strings: koran.junlper[.]com:80 and koran.junlper[.]com:443. Next, the program creates a\nTCP socket for the connection. After that, it creates a context for the secure connection and\nperforms a TLS handshake.\n\n\n-----\n\nAfter establishing secure connection, the backdoor expects a packet with a command from\nthe C&C server. The program works with two packet formats:\n\nThe packet received after processing the TLS protocol is a \"transport\" packet.\nThe packet received after processing the transport packet is a \"data\" packet. It contains\nthe command ID and additional data.\n\nThe transport packet header is represented by the following structure.\n```\nstruct transport_packet_header\n{\n DWORD signature;\n WORD compressed_len;\n WORD uncompressed_len;\n};\n\n```\nThe data is placed after the header and packed by the LZ4 algorithm. The backdoor checks\nthe value of the signature field. It must be equal to 0x573F0A68.\n\nAfter unpacking, the resulting data packet has a header in the following format.\n\n\n-----\n\n```\nstruct data_packet_header\n{\n WORD tag;\n WORD id;\n WORD unk_0;\n BYTE update_data;\n BYTE id_part;\n DWORD unk_1;\n DWORD unk_2;\n DWORD len;\n};\n\n```\nThe tag and id fields together define the backdoor action, which means they denote the\ncommand ID.\n\nThese header structures are used in both directions of interaction.\n\nThe order of processing server commands:\n\nClient verification\nSending the information about the infected system\nProcessing commands by IDs\n\nThere is a variable that stores the state of the dialog in the structure responsible for\ncommunicating with the C&C server. Therefore, before directly executing commands,\nperforming the first two steps is required, which can be considered as a second handshake.\n\n## A verification step\n\nTo perform the verification step, the values of the tag and id fields in the primary packet\nreceived from the C&C server must be equal to 1.\n\nThe verification process is as follows:\n\n1. The backdoor forms a buffer from an 8-byte array that follows the packet header and\n\nthe hash_id field taken from the configuration. The result can be represented as the\nstructure:\n```\n   struct buff\n   {\n     BYTE packet_data[8];\n     BYTE hash_id[20];\n   }\n\n```\n2. The SHA1 hash of the data in the resulting buffer is calculated. The result is placed in\n\nthe packet (after the header) and sent to the server.\n\n## Sending system information\n\n\n-----\n\nThe next packet received from the C&C server must have the tag value equal to 5 and id\nvalue equal to 3. The system data is formed as a sysinfo_packet_data structure.\n```\nstruct session_info\n{\n DWORD id;\n DWORD State;\n DWORD ClientBuildNumber;\n BYTE user_name[64];\n BYTE client_IPv4[20];\n BYTE WinStationName[32];\n BYTE domain_name[64];\n};\nstruct sysinfo_block_2\n{\n WORD field_0;\n WORD field_2;\n WORD field_4;\n WORD system_def_lang_id;\n WORD user_def_lang_id;\n DWORD timezone_bias;\n DWORD process_SessionID;\n BYTE user_name[128];\n BYTE domain_name[128];\n DWORD number_of_sessions;\n session_info sessions[number_of_sessions];\n};\nstruct sysinfo_block_1\n{\n DWORD unk_0; //0\n DWORD bot_id_created;\n DWORD dw_const_0; //0x101\n DWORD os_version;\n WORD dw_const_2; //0x200\n BYTE cpu_arch;\n BYTE field_13;\n DWORD main_interface_IP;\n BYTE MAC_address[20];\n BYTE bot_id[48];\n WCHAR computer_name[128];\n BYTE cfg_string[64];\n WORD w_const; //2\n WORD sessions_size;\n};\nstruct sysinfo_packet_data\n{\n DWORD id;\n sysinfo_block_1 block_1;\n sysinfo_block_2 block_2;\n};\n\n```\n\n-----\n\nThe sysinfo_packet_data.id field contains a 0x19C0001 constant.\n\nThesysinfo_packet_data.block_1.bot_id value is extracted from the registry. The backdoor\nlocates it in the instance parameter of the SOFTWARE\\Clients\\Mail\\Hotmail\\backup key,\nwhich, in turn, depending on the privileges, can be located in the HKLM or HKCU sections.\n\nIf the value is missing, a random GUID is generated using UuidCreate, then formatted as a\nXXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXX string and saved. If the ID already existed,\nthe sysinfo_packet_data.block_1.bot_id_created parameter is assigned the 1 value. If the ID\nwas created, the parameter is assigned the 2 value.\n\nThe sysinfo_packet_data.block_1.cpu_arch parameter value:\n\n1 — x86\n2 — x64\n\nThe process of determining the MAC address and IP address values by the backdoor is\nnoteworthy. First, the program searches for the network interface through which the largest\nnumber of packets passed, then gets its MAC address and searches for the IP address of\nthis interface.\n\n\n-----\n\nThe OS version is encoded with a value from 1 to 13 (0 if an error occurs, starting with 5.0\nand then ascending the version.\n\nThe sysinfo_packet_data.block_1.cfg_string field contains the string value from the backdoor\nconfiguration, which is equal to the character 1.\n\n## Processing commands\n\nAfter the verification step and sending the system information, BackDoor.Spyder.1 begins\nprocessing the main commands. Unlike most backdoors, whose commands are quite\nspecific (pick up a file, create a process, etc.), in this instance, they are more of a service\nnature and represent instructions for storing and structuring the received data. In fact, all\nthese service commands are aimed at loading new modules in PE format, storing them, and\ncalling certain exported functions. It is worth noting that the modules and their information\nare stored in memory in the form of hash tables using UT-hash.\n\n**tag** **id** **Description**\n\n6 1 Send the number of\nreceived modules to the\nserver.\n\n2 Save the parameters of the received module in memory.\n\n3 Save the body of the module in the memory.\n\n4 Load a previously saved module. The search is performed\nin the hash table by the ID obtained from the packet with\nthe command. The module is loaded into memory, its\nentry point is called, then the addresses of the 4 exported\nfunctions are obtained, which are stored in the structure\nfor further call. Call the exported function No.1.\n\n5 Call the exported function No.4 of one of the loaded\nmodules, then unload it.\n\n6 Send in response a packet consisting only of the\ndata_packet_header header, in which the unk_2 field is\n0xFFFFFFFF.\n\n\n-----\n\n7 Call the exported function No.2 of one of the loaded\nmodules.\n\n8 Call the exported function No.3 of one of the loaded\nmodules.\n\n5 2 Send information about\nthe current connection\nparameters to the\nserver.\n\n4 - Presumably, the\nexported function No.1\ncan return a table of\npointers to functions,\nand the program calls\none of these functions\nat this command.\n\nAfter processing each packet received from the server, the backdoor checks the difference\nbetween the two values of the GetTickCount result. If the value exceeds the specified\nreference value, it sends the 0x573F0A68 signature value to the server without any\nadditional data and transformations.\n\n## New server request thread\n\n**BackDoor.Spyder.1 can request the address of the new C&C server if the url_C2_req URL**\nis provided in the configuration. To request this URL, the program can use both the system\nproxy and the HTTP proxy provided in the configuration. The request is made using the\n\n\n-----\n\nInternetOpenUrlA WinHTTP API.\n\nThe response must be a Base64-encoded string between two markers: DZKS and DZJS. It\nshould be noted that a similar algorithm and markers were used in the PlugX family\n[(BackDoor.PlugX.28 and](https://vms.drweb.com/search/?q=BackDoor.PlugX.28&lng=en) **[BackDoor.PlugX.38).](https://vms.drweb.com/search/?q=BackDoor.PlugX.38&lng=en)**\n\nThe decoded string is decompressed using the RtlDecompressBuffer function, resulting in\nthe address of the new C&C server and the port to connect to.\n\n## Encrypted module execution thread\n\nIf the exec_mode configuration parameter is set to 2 and the command line contains -k\nnetsvcs, the backdoor creates a separate thread to execute the module stored in the file.\n\nTo do this, the backdoor searches for the C:\\Windows\\System32\\1.update file at first. If such\na file exists, the program reads it and decrypts it.\n\n\n-----\n\nThis file contains the path to an encrypted file containing a DLL module that the backdoor\nreads, decrypts, and loads.\n\n## Features of the x86 version\n\nThe version of the backdoor designed to run on 32-bit Microsoft Windows operating systems\nis detected by Dr.Web as a BackDoor.Spyder.3\n(83e47dbe20882513dfd1453c4fcfd99d3bcecc3d). The main difference of this modification is\nthe presence of debug messages.\n\nMessages are recorded on the log file located in the %WINDIR%\\temp\\deskcpl.ttf directory.\nDepending on the initialization parameters, they can be output using OutputDebufStringA or\nencrypted using a simple XOR operation with byte 0x62.\n\n\n-----\n\nMessages related to communication with the C&C server and command processing are\noutput using the OutputDebugStringA function. It is noteworthy that for such messages, the\n\n[Spyder] prefix is used.\n\n## Notes\n\nBelow is the information about the CA_cert certificate for establishing a connection with the\nC&C server:\n\n\n-----\n\n```\nSHA1 Fingerprint BF:46:40:E4:AF:56:DB:E0:D0:86:6E:16:B0:3F:C7:23:77:26:14:31\nCertificate:\n  Data:\n    Version: 3 (0x2)\n    Serial Number: 1 (0x1)\n  Signature Algorithm: sha256WithRSAEncryption\n    Issuer: CN = SecureTrust CA, O = SecureTrust Corporation, C = US\n    Validity\n      Not Before: Jan 1 00:00:00 2011 GMT\n      Not After : Dec 31 23:59:59 2025 GMT\n    Subject: CN = SecureTrust CA, O = SecureTrust Corporation, C = US\n    Subject Public Key Info:\n      Public Key Algorithm: rsaEncryption\n        Public-Key: (4096 bit)\n        Modulus:\n          00:bd:c3:26:8b:e1:37:7f:f0:fa:0a:0d:83:a7:dd:\n          22:31:14:83:08:d7:74:3b:31:08:84:ef:25:cf:2d:\n          44:fc:2d:54:77:0b:17:e2:70:4d:be:2f:c1:fc:ed:\n          d9:6b:9e:db:60:28:27:c4:1e:6d:15:3d:dd:b9:43:\n          64:37:58:b4:bd:48:85:fa:d1:d6:f7:5a:33:eb:ec:\n          b7:86:62:92:1f:89:d7:a4:bd:d3:1f:f3:18:9d:a4:\n          15:27:16:7b:26:9f:5c:53:87:bd:40:22:d2:5e:cd:\n          ab:d5:6f:1d:ac:c3:0d:f1:d9:d5:f5:6a:d3:16:76:\n          58:df:f7:0b:20:0d:ed:7b:97:ae:66:0a:e6:cc:9f:\n          73:50:fb:ce:16:a6:dc:45:d0:2f:70:3e:c8:c8:59:\n          4d:c4:62:ec:b0:e9:01:9c:57:92:e4:78:83:4f:a6:\n          ab:1b:94:45:ff:15:ed:dc:59:95:f3:71:22:9c:06:\n          38:bb:e6:0f:b3:ec:af:5b:bd:1a:2f:b1:7f:ce:c8:\n          4d:32:9f:8f:44:9b:ae:fc:e5:72:24:b4:3a:3b:f3:\n          d0:79:30:79:a2:0e:bd:55:e9:cd:c0:4d:7e:07:fc:\n          37:b5:7f:69:be:d6:e3:37:ce:9e:ff:d2:05:e4:3c:\n          59:7e:f0:d4:ab:01:e4:7b:07:f6:a4:f0:e3:c3:7e:\n          58:07:2d:e8:96:9c:ac:8b:e6:dc:49:6a:51:9a:b3:\n          b0:62:cf:3c:b4:4a:f9:89:ae:2c:73:17:01:43:63:\n          ec:e8:2b:7b:1c:3c:81:41:fa:db:93:45:3a:21:1f:\n          2a:3a:8f:30:d4:52:59:91:03:03:11:b8:18:ca:39:\n          4c:9a:e2:57:33:e6:bc:c5:4a:8e:76:79:50:fd:bd:\n          32:78:9c:79:58:4f:b9:d3:bb:05:eb:39:43:db:3e:\n          b5:2d:51:18:ed:ee:9d:31:3a:2e:6b:37:37:34:28:\n          4a:89:cb:65:b4:7d:bf:be:a1:67:cb:5c:71:9c:be:\n          c3:3b:f7:a7:df:37:4d:0f:c7:57:f5:5b:d2:db:54:\n          2c:91:5b:3b:7f:ec:1f:45:e4:7b:a5:0d:a1:c2:1f:\n          64:af:51:cd:32:3a:83:25:9c:90:ac:77:66:4d:12:\n          23:f5:5b:3c:90:b5:41:1b:54:55:a4:24:66:e6:e9:\n          65:46:95:ff:ef:67:f5:a6:80:f6:d5:e6:3f:2f:c2:\n          7b:25:d8:b3:b4:4d:f4:b8:7c:38:cc:de:3e:4f:43:\n          9a:ca:be:c1:66:95:2d:2c:16:a9:56:9b:68:5d:8c:\n          78:90:84:d4:86:51:10:f1:9b:14:23:43:bb:91:1e:\n          02:01:ee:11:63:c4:f2:81:7f:83:68:5e:86:bd:8a:\n          88:7c:2d\n        Exponent: 65537 (0x10001)\n    X509v3 extensions:\n      X509v3 Basic Constraints:\n        CA:TRUE, pathlen:0\n      X509v3 Subject Key Identifier:\n\n```\n\n-----\n\n```\n        E0:63:19:89:FA:AD:19:5D:E3:B3:A5:E2:85:D2:2F:87:B1:55:76:1B\n      X509v3 Authority Key Identifier:\n        keyid:E0:63:19:89:FA:AD:19:5D:E3:B3:A5:E2:85:D2:2F:87:B1:55:76:1B\n      X509v3 Key Usage: critical\n        Digital Signature, Key Agreement, Certificate Sign, CRL Sign\n      Netscape Cert Type:\n        SSL Client, SSL Server, Object Signing, SSL CA, Object Signing CA\n  Signature Algorithm: sha256WithRSAEncryption\n     08:33:53:e4:be:95:0a:1b:d7:6e:44:6b:2d:42:2a:45:7f:8b:\n     89:fd:fb:d0:cf:5f:8f:83:77:5d:3b:2c:11:46:9f:44:3b:69:\n     f2:e2:e7:fe:4e:c9:43:5c:89:5f:e2:e2:5a:5e:4c:4d:39:ed:\n     ce:2d:63:d4:a1:93:ff:ff:3f:b0:77:86:e8:f1:5e:a3:4d:d3:\n     ba:eb:41:0f:85:0c:04:fb:6c:42:19:bc:2b:d1:db:c6:51:e3:\n     97:cd:5b:e5:d5:b4:1f:43:e7:7c:eb:86:08:16:86:0b:46:23:\n     9d:f4:e9:18:b6:ce:e5:f4:96:7b:ee:5f:f5:8d:ff:dd:65:29:\n     b9:12:94:f7:da:d3:c0:64:53:e6:2b:36:ec:6f:d3:26:3c:c2:\n     ab:ba:10:cd:d8:39:43:8b:21:fe:68:ab:48:25:34:07:a6:cc:\n     cc:b5:70:60:c4:ae:91:73:19:ff:9d:ff:82:ca:4a:9c:8e:70:\n     94:96:5f:7c:b3:e8:f7:e4:3e:cc:af:41:7e:24:47:fe:ad:d5:\n     a7:80:32:80:9c:7f:0c:00:3b:92:4c:ec:8e:ef:93:fb:8a:1f:\n     ff:be:f0:ab:33:c7:4b:2b:5d:fc:31:e6:bf:f4:1d:c0:e3:d0:\n     c5:94:a9:21:b1:8c:26:4b:c2:82:51:cf:1b:63:09:b1:ec:45:\n     31:49:ba:51:42:22:7a:41:90:2f:28:0e:40:76:91:3c:33:34:\n     84:66:b9:7e:0e:68:5a:37:38:01:b1:92:64:a5:a8:9c:34:84:\n     6a:c6:01:d0:30:f8:d5:52:0f:6e:3e:40:06:a2:b8:4c:b1:69:\n     4d:16:8f:d0:c4:72:b6:0e:09:57:6c:5e:cd:bc:ab:e3:ce:80:\n     ae:a7:6c:3d:3c:01:a5:a3:4f:4d:e0:52:36:12:cc:7a:e2:5e:\n     f3:d7:22:a7:6c:7c:60:d4:fd:f4:37:94:70:dd:4c:9b:00:cd:\n     7d:9d:42:f7:e7:b2:25:f6:63:06:1e:4d:dc:4b:ef:5c:45:5d:\n     a7:b9:b7:33:21:4e:91:40:ba:ca:ec:70:d0:a5:f7:0c:0a:ea:\n     97:11:fa:47:8b:dd:24:b0:c2:98:ff:94:4f:f6:c8:0f:e9:a5:\n     2d:bf:b6:7c:f4:45:f3:cb:5a:fd:a0:38:ce:ca:60:24:34:74:\n     77:ea:91:bc:dc:68:90:53:5f:0a:f4:40:13:69:68:2e:31:f9:\n     df:7d:07:05:53:42:8a:8b:e0:49:75:ee:04:94:9e:87:1a:25:\n     9e:82:16:87:a2:69:dd:eb:44:21:4c:98:1d:72:8b:46:74:5c:\n     33:24:5c:c2:ab:7b:1f:c4:d4:d5:9a:40:77:15:73:d3:53:62:\n     60:da:5d:7c:2a:9e:12:25\n-----BEGIN CERTIFICATE----MIIFgTCCA2mgAwIBAgIBATANBgkqhkiG9w0BAQsFADBIMRcwFQYDVQQDEw5TZWN1\ncmVUcnVzdCBDQTEgMB4GA1UEChMXU2VjdXJlVHJ1c3QgQ29ycG9yYXRpb24xCzAJ\nBgNVBAYTAlVTMB4XDTExMDEwMTAwMDAwMFoXDTI1MTIzMTIzNTk1OVowSDEXMBUG\nA1UEAxMOU2VjdXJlVHJ1c3QgQ0ExIDAeBgNVBAoTF1NlY3VyZVRydXN0IENvcnBv\ncmF0aW9uMQswCQYDVQQGEwJVUzCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoC\nggIBAL3DJovhN3/w+goNg6fdIjEUgwjXdDsxCITvJc8tRPwtVHcLF+JwTb4vwfzt\n2Wue22AoJ8QebRU93blDZDdYtL1IhfrR1vdaM+vst4Zikh+J16S90x/zGJ2kFScW\neyafXFOHvUAi0l7Nq9VvHazDDfHZ1fVq0xZ2WN/3CyAN7XuXrmYK5syfc1D7zham\n3EXQL3A+yMhZTcRi7LDpAZxXkuR4g0+mqxuURf8V7dxZlfNxIpwGOLvmD7Psr1u9\nGi+xf87ITTKfj0SbrvzlciS0Ojvz0HkweaIOvVXpzcBNfgf8N7V/ab7W4zfOnv/S\nBeQ8WX7w1KsB5HsH9qTw48N+WAct6JacrIvm3ElqUZqzsGLPPLRK+YmuLHMXAUNj\n7Ogrexw8gUH625NFOiEfKjqPMNRSWZEDAxG4GMo5TJriVzPmvMVKjnZ5UP29Mnic\neVhPudO7Bes5Q9s+tS1RGO3unTE6Lms3NzQoSonLZbR9v76hZ8tccZy+wzv3p983\nTQ/HV/Vb0ttULJFbO3/sH0Xke6UNocIfZK9RzTI6gyWckKx3Zk0SI/VbPJC1QRtU\nVaQkZubpZUaV/+9n9aaA9tXmPy/CeyXYs7RN9Lh8OMzePk9Dmsq+wWaVLSwWqVab\naF2MeJCE1IZREPGbFCNDu5EeAgHuEWPE8oF/g2hehr2KiHwtAgMBAAGjdjB0MA8G\nA1UdEwQIMAYBAf8CAQAwHQYDVR0OBBYEFOBjGYn6rRld47Ol4oXSL4exVXYbMB8G\n\n```\n\n-----\n\n```\nA1UdIwQYMBaAFOBjGYn6rRld47Ol4oXSL4exVXYbMA4GA1UdDwEB/wQEAwIBjjAR\nBglghkgBhvhCAQEEBAMCANUwDQYJKoZIhvcNAQELBQADggIBAAgzU+S+lQob125E\nay1CKkV/i4n9+9DPX4+Dd107LBFGn0Q7afLi5/5OyUNciV/i4lpeTE057c4tY9Sh\nk///P7B3hujxXqNN07rrQQ+FDAT7bEIZvCvR28ZR45fNW+XVtB9D53zrhggWhgtG\nI5306Ri2zuX0lnvuX/WN/91lKbkSlPfa08BkU+YrNuxv0yY8wqu6EM3YOUOLIf5o\nq0glNAemzMy1cGDErpFzGf+d/4LKSpyOcJSWX3yz6PfkPsyvQX4kR/6t1aeAMoCc\nfwwAO5JM7I7vk/uKH/++8Kszx0srXfwx5r/0HcDj0MWUqSGxjCZLwoJRzxtjCbHs\nRTFJulFCInpBkC8oDkB2kTwzNIRmuX4OaFo3OAGxkmSlqJw0hGrGAdAw+NVSD24+\nQAaiuEyxaU0Wj9DEcrYOCVdsXs28q+POgK6nbD08AaWjT03gUjYSzHriXvPXIqds\nfGDU/fQ3lHDdTJsAzX2dQvfnsiX2YwYeTdxL71xFXae5tzMhTpFAusrscNCl9wwK\n6pcR+keL3SSwwpj/lE/2yA/ppS2/tnz0RfPLWv2gOM7KYCQ0dHfqkbzcaJBTXwr0\nQBNpaC4x+d99BwVTQoqL4El17gSUnocaJZ6CFoeiad3rRCFMmB1yi0Z0XDMkXMKr\nex/E1NWaQHcVc9NTYmDaXXwqnhIl\n-----END CERTIFICATE----\n```\nList of 32-bit modification debug messages:\n\n\n-----\n\n```\n[work]cmdline:%s\n[work]dwDataLen=%d buf_temp=%d\n[work]%s no exist\n[work]get work err5\n[aut]begin tid=%d.\n[update_thread]begin tid=%d.\n[update_thread]work=%s\n[update_thread]get_work ret=%d\n[update_thread]wait for work thread exit...\n[update_thread]work thread exit ok\n[update_thread]load work failed\n[pt]proxy_thread begin tid=%d.\n[]dwMajorVersion=%d dwMinorVersion=%d\n[]rtlVer.dwMinorVersion=%d\n[work]DllMain\n[work] DLL\n[work] VBR/SRV\n[wk]RtlGetCurrentUserToken ok\n[wk]ImpersonateLoggedOnUser ok\n[wk]OpenURL %s Ret=%d\n[wk]Err1\n[wk]Err4\n[wk]GetConfigStrFromURL err\n[wk]DecodeStrBuffer err\n[wk]DecodeLen err\n[wk]RevertToSelf\n[]IsProxyEnable Ret=%d\n[aut]GetConfigStrFromURL PROXY_NO Ret=%d\n[aut]GetConfigStrFromURL PROXY_USER Ret=%d\n[aut]JmpAddClientConfig %s with address: %s.\n[aut]GetRandom=%d\n[aut]szWebURL Not Set\n[aut]address_update_thread Exit.\n[update_thread]get_work_path ret=%d\n[pt]Using IE proxy setting.\n[pt]IE proxy NOT setup.\n[pt]SmpGetRegProxy Counts=%d\n[pt]IE proxy type = %u NOT support, address: %s.\n[pt]IE proxy type = %u, address: %s found.\n[pt]Add proxy config %s, address=%s.\n[work_thread]begin tid=%d\n[wt]JmpAddClientConfig %s with address: %s.\n[wt]JmpAddProxyConfig %s.\n[wt]Proxy:%s\n[wt]start Jumper error = %u.\n[wt]Jumper start success!\n[wt]JmpShutdown\n[wt]JmpShutdown=%d\n[wt]JmpTeardown=%d\n[wt]tid=%d Exit\n[Spyder] client module init error = %d.\n[Spyder] register mod %d error = %u.\n[spyder] alloc mem for ca cert failed.\n[spyder] server address already exists in conf list.\n[Spyder] alloc client error = %d.\n\n```\n\n-----\n\n```\n[Spyder] ALLOC client uid %u.\n[Spyder] set ca for client id=%u error=%d\n[Spyder] proxy setting exists, srv=%s\n[spyder] use proxy [%s] to connect [%s] res = %u.\n[Spyder] direct connect to %s error = %u.\n[Spyder] connect to %s result = %u, protcol=%u.\n[jmp] big packet: recv new big pkt while previous one not handled, old=%u, new=%u.\n[jmp] packet size exceed limit = %#X, id=%u.\n[jmp] failed to realloc packet buffer, error = %u, pkt id=%u.\n[jmp] big packet recv completed, id=%u, size=%u, ext id=%u.\n[Spyder] PAUSE ext = %u Before.\n[Spyder] PAUSE ext = %u After.\n[Spyder] UNINIT ext = %u Before.\n[Spyder] UNINIT ext = %u After.\nduplicate session id for ext type id = %u.\n[Spyder] can't find recv item for type id = %u.\n[Spyder] ext type id = %u recved = %u, new recv = %u, but total size = %u\n[Spyder] ext type id = %u recv completed, total size = %u.\n[Spyder] find ext with same type id = %u while updating, free old ext.\n[Spyder] alloc mem for completed ext error = %u.\n[Spyder] ext recv %s, free tem buffer, type id = %u.\n[Spyder] ext type = %u already loaded, unlaod now for updating.\n[Spyder] failed to unload ext from memory.\n[Spyder] load ext id = %u into memory error.\n[Spyder] MOD LOAD AT %p, size=%u.\n[Spyder] alloc mem for loaded item failed, unload ext type id = %u.\n[Spyder] inint module type = %u begin.\n[Spyder] inint module type = %u end.\n[Spyder] alloc mem for mod_pfn error = %u.\n[Spyder] unlaod ext id = %u error.\n[Spyder] unload_and_free_all_exts.\n[Spyder] UNLOAD ext = %u BEFORE.\n[Spyder] UNLOAD ext = %u AFTER.\n[Spyder] FREE ext = %u AFTER.\n[Spyder] free ext cache = %u .\n[Spyder] free ext mem = %u .\n[Spyder] link setup Result=%d, local = %#X:%u, remote = %#X:%u, uid=%u.\n[Spyder] connected callback at %02u:%02u:%02u, id = %u.\n[Spyder] Link disconnected at %02u:%02u:%02u, id = %u.\n[Spyder] recv data size = %u invalid, from uid=%u.\n[Spyder] receive challenge = %I64X.\n[Spyder] failed to get host info.\n[Spyder] send host info error = %u.\n[jmp] LOGIN SUCCESS, link id = %u.\n[jmp] internal data process error.\n[jmp] unknown state = %u.\n[jmp] core process data error, close link = %u.\n[Spyder] ext summary size error = %u.\n[Spyder] ext recv prepare failed.\n[Spyder] EXTENSION recv BEGIN, type = %u.\n[Spyder] dll payload recv error.\n[Spyder] ext active begin.\n[Spyder] ext active result = %s.\n[Spyder] ext free cmd not handled.\n[Spyder] unhandled ext sub cmd = %u.\n\n```\n\n-----\n\n```\n[Spyder] call ext failed %d, sub %u.\n[spyder] unhandled subcmd=%u in tunnel cmd.\n[Spyder] unhandled main cmd = %u, sub cmd = %u.\n[Spyder] Can't get link id for ext data delevery.\n[Spyder] SEND_DATA via link id=%u error = %d.\n[Spyder] client link disconnect id = %u.\n[Spyder] client send data error = %#X, id = %u.\n[Spyder] enum session error = %u.\n[Spyder] get Host info error.\n[Spyder] save sn value error = %u.\n[Spyder] gszUniqueSN=%s\n[Spyder] create guid error = %d.\n[jmp] Get adapter info error = %u.\n[jmp] adapters info buf size=%u, count=%u.\n Alloc buf for adapter info error = %u.\nget adapter info with buf error = %u.\n[jmp] IP=%s not match preset mac address, desc=%s.\n[jmp] master adapter FOUND! IP = [%s], desc=%s.\n[jmp] master adapter has more than one ip: %s.\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-01 - BackDoor.Spyder.1.pdf"
    ],
    "report_names": [
        "2020-03-01 - BackDoor.Spyder.1.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535911,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1653694025,
    "ts_modification_date": 1653694025,
    "files": {
        "pdf": "https://archive.orkl.eu/4ec95e963f879aa263d86e824ea513db663e33eb.pdf",
        "text": "https://archive.orkl.eu/4ec95e963f879aa263d86e824ea513db663e33eb.txt",
        "img": "https://archive.orkl.eu/4ec95e963f879aa263d86e824ea513db663e33eb.jpg"
    }
}