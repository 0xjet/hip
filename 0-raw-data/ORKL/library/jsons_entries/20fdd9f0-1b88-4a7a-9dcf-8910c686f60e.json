{
    "id": "20fdd9f0-1b88-4a7a-9dcf-8910c686f60e",
    "created_at": "2023-01-12T15:05:06.864121Z",
    "updated_at": "2025-03-27T02:16:20.99056Z",
    "deleted_at": null,
    "sha1_hash": "084c8fa5d0f9bd5190ad39e4c8b5f6595137f4f7",
    "title": "2020-09-02 - KryptoCibule- The multitasking multicurrency cryptostealer",
    "authors": "",
    "file_creation_date": "2022-05-28T00:37:07Z",
    "file_modification_date": "2022-05-28T00:37:07Z",
    "file_size": 375660,
    "plain_text": "# KryptoCibule: The multitasking multicurrency cryptostealer\n\n**[welivesecurity.com/2020/09/02/kryptocibule-multitasking-multicurrency-cryptostealer/](https://www.welivesecurity.com/2020/09/02/kryptocibule-multitasking-multicurrency-cryptostealer/)**\n\nSeptember 2, 2020\n\nESET researchers analyze a previously undocumented trojan that is spread via malicious torrents and uses\nmultiple tricks to squeeze cryptocoins from its victims while staying under the radar\n\nESET researchers analyze a previously undocumented trojan that is spread via malicious torrents and uses\nmultiple tricks to squeeze cryptocoins from its victims while staying under the radar\n\nESET researchers have uncovered a hitherto undocumented malware family that we named KryptoCibule. This\nmalware is a triple threat in regard to cryptocurrencies. It uses the victim’s resources to mine coins, tries to hijack\ntransactions by replacing wallet addresses in the clipboard, and exfiltrates cryptocurrency-related files, all while\ndeploying multiple techniques to avoid detection. KryptoCibule makes extensive use of the Tor network and the\nBitTorrent protocol in its communication infrastructure.\n\nThe malware, written in C#, also employs some legitimate software. Some, such as Tor and the Transmission\ntorrent client, are bundled with the installer; others are downloaded at runtime, including Apache httpd and the Buru\nSFTP server. An overview of the various components and their interactions is shown in Figure 1.\n\n\n-----\n\n_Figure 1. KryptoCibule components and tools_\n\nWhen the malware is first executed, the host is assigned a unique identifier with the format {adjective}-{noun} where\n{adjective} and {noun} are random words taken from two hardcoded lists which provide over 10 million unique\ncombinations. This identifier is then used to identify the host in communications with the C&C servers.\n\nOn top of the crypto-related components, KryptoCibule also has RAT functionality. Among the commands it\nsupports are EXEC, which allows execution of arbitrary commands and SHELL, which downloads a PowerShell\n[script from the C&C. This script then loads a backdoor generated with the post-exploitation tool Pupy.](https://github.com/n1nj4sec/pupy)\n\nThe name KryptoCibule derives from the Czech and Slovak words for “crypto” and “onion”.\n\n## Timeline\n\nWe have uncovered multiple versions of this malware, enabling us to trace its evolution all the way back to\nDecember 2018. Figure 2 shows the changes made over time to KryptoCibule.\n\n\n-----\n\n_Figure 2. Timeline of updates and functionality changes_\n\n## Targets\n\nAccording to ESET telemetry (shown in Figure 3), the malware seems to target mostly users in Czechia (the Czech\nRepublic) and Slovakia. This reflects the user base of the site on which the infected torrents are found.\n\n\n-----\n\n_Figure 3. In our telemetry data, over 85% of detections were located in Czechia and Slovakia_\n\nAlmost all the malicious torrents were available on uloz.to; a popular (At the time of this writing, this website and its\nlocalized variant (ulozto.cz and ulozto.sk respectively) are both in the Alexa top 50 most visited sites in Czechia and\nin the top 75 most visited sites for Slovakia) file sharing site in Czechia and Slovakia (see Figure 4). We’ll explain\nhow these torrents are used to spread KryptoCibule in the next section.\n\n\n-----\n\n_Figure 4. One of the malicious torrents on uloz.to_\n\nAs detailed in the Anti-detection and anti-analysis techniques section below, KryptoCibule specifically checks for\nESET, Avast, and AVG endpoint security products; ESET is headquartered in Slovakia, while the other two are\nowned by Avast, which is headquartered in Czechia.\n\n## Torrents\n\nKryptoCibule makes use of the BitTorrent protocol to spread to new victims and to download additional tools and\nupdates.\n\n### Initial Compromise\n\nKryptoCibule is spread through malicious torrents for ZIP files whose contents masquerade as installers for cracked\nor pirated software and games. Although other files may be included, as seen in Figure 5, there are five that are\ncommon to all KryptoCibule installer archives. packed.001 is the malware, while packed.002 is the installer for the\nexpected software. Both are XOR-encrypted with keys contained in Setup.exe.\n\nWhen Setup.exe is executed, it decodes both the malware and the expected installer files. It then launches the\nmalware – in the background – and the expected installer – front and center – giving the victim no indication that\nanything is amiss.\n\n\n-----\n\n_Figure 5. Content of the Dead.Cells.Incl.All.DLC archive with only the minimum common set of KryptoCibule installer files_\n\n_shown_\n\n### Additional software and updates\n\nThe BitTorrent protocol is also used to download updates to the malware, and additional software.\n\nKryptoCibule installs the transmission-daemon torrent client and manages it by issuing commands via its RPC\ninterface on port 9091 with transmission-remote. The RPC interface uses the hardcoded credentials\nsuperman:krypton.\n\nTo install further software for the malware’s use, such as the SFTP server, the Launcher component makes an\nHTTP GET request to %C&C%/softwareinfo?title=<software name> and receives a JSON response containing a\nmagnet URI (Magnet links are a type of URI that identify files by using a cryptographic hash of their contents rather\nthan their location. These links may also include metadata about the file. They are commonly used in the BitTorrent\nprotocol to identify files to be shared. See https://www.bittorrent.com/blog/2016/01/27/reshaping-the-internet-whatsa-magnet-link/) for the torrent to download and other information indicating how to install and execute the program.\nFigure 6 shows an example of such a response.\n\n1 {\"Magnet\": \"magnet:?xt=urn[:]btih:67yd647nivxhumoedvwnwnzve55b3bxj&dn=free-BuruServer-x64v1.7.3.zip\", \"Version\": 1,\"ExecutableRelativePath\": \"\", \"ExecutableFileName\": \"buru.exe\",\"ExecutableArgs\":\n\"run\", \"InstallFile\": \"\", \"HasCustomConfig\": true}\n\n_Figure 6. Sample response for a GET /softwareinfo?title=ssh_server request_\n\nThe mechanism for getting updates is similar. The malware first gets global settings via HTTP from\n%C&C%/settingsv5. Among other things, this response contains a magnet URI for the latest version of the\nmalware. It then makes a GET request to %C&C%/version to get the most recent version number. If the local\nversion is lower than that version, the torrent is downloaded and installed.\n\nTorrents are added to Transmission using the following command:\n\ntransmission-remote localhost -n superman:krypton -a “<magnet URI>”\n\nA hardcoded list of 50 trackers (In the BitTorrent protocol, a tracker is a server that helps clients find and coordinate\nwith peers to transfer files. See https://en.wikipedia.org/wiki/BitTorrent_tracker ) is used to get peers for all torrents.\n\n### Seeding malicious torrents\n\nVictims are also used to seed (In the BitTorrent protocol, a seed is a peer that has a complete torrent and that lets\nothers download that torrent’s files from it. See https://help.bittorrent.com/support/solutions/articles/29000023347what-is-seeding- ) both the torrents used by the malware and the malicious torrents that help spread it. Infected\nhosts get a list of magnet URIs from %C&C%/magnets, download them all and keep seeding them. This ensures\nthat these files are widely available for others to download, which helps speed up the downloads and provides\nredundancy.\n\n## Anti-detection and anti-analysis techniques\n\n\n-----\n\nThis malware leverages a variety of techniques to avoid detection, along with some basic anti analysis protections.\n\nIt starts with the initial access vector. The executable contained inside the ZIP archive is a rather benign installer\nprogram that masquerades as the legitimate InstallShield program. This file is scrambled with the open source\nprogram [Obfuscar. This same tool is used on all of the malware’s custom executables. The malicious code itself is](https://github.com/obfuscar/obfuscar)\nlocated inside an XOR-encrypted file, the key being a GUID hardcoded in Setup.exe.\n\nThe malware is then installed to the hardcoded path %ProgramFiles(x86)%\\Adobe\\Acrobat Reader\nDC\\Reader\\update and uses legitimate Adobe Acrobat Reader executable names for the bundled Tor executable\nand its own. Some of the files contained in the install folder can be seen in Figure 7.\n\n_Figure 7. Some of the files in the install folder. Armsvc.exe is the malware and ADelRCP.exe is the Tor executable. Both_\n\n_filenames are actually used by Adobe Reader._\n\nTo achieve persistence, KryptoCibule creates a scheduled task to be run every five minutes with the following\ncommand. Once again, it uses an Adobe Reader-related name.\n\nschtasks.exe /CREATE /SC MINUTE /MO 5 /TN “Adobe Update Task” /TR\n\\””%ProgramFiles(x86)%\\Adobe\\Acrobat Reader DC\\Reader\\Update\\armsvc.exe\\”” [/RL HIGHEST] /F [/RU\nSYSTEM]\n\nBefore first executing its payload and on every iteration of the main loop, the malware performs a check for running\nanalysis software using the following list. If any process with a matching name is found, it stops all running\ncomponents and exits.\n\ncain\nfilemon\nnetmon\nnetstat\nnmwifi\nperfmon\nprocesshacker\nprocexp\nprocexp64\nprocmon\nregmon\ntasklist\ntaskmgr\ntcpvcon\ntcpview\nwireshark\n\n### Antivirus evasion\n\nBefore initializing the cryptominer components, the malware performs a case-insensitive check of the\nrootSecurityCenter2\\AntiVirusProduct WMI object for the strings avast, avg and eset, as seen in the decompiled\ncode in Figure 8. Should any of these strings be detected If any of them were detected, the cryptominer\n\n\n-----\n\ncomponents will not be installed.\n\n_Figure 8. Cleaned up decompiled code of the function used to check for specific security products_\n\nWhenever the malware installs itself, an update or a new component, the install path used is excluded from\nWindows Defender automatic scanning by issuing the following command:\n\npowershell -c “Add-MpPreference -ExclusionPath ‘<install path>'”\n\nIt also creates firewall rules using innocuous-looking names to explicitly allow inbound and outbound traffic from its\ncomponents. A rule to block outbound traffic from the ESET Kernel Service (ekrn.exe) is also created by the\nfunction shown in Figure 9.\n\n_Figure 9. Function that blocks outbound traffic from ekrn.exe in the Windows Firewall_\n\n### Tor network usage\n\n\n-----\n\nKryptoCibule brings along the tor.exe command line tool, masquerading as ADelRCP.exe, and a configuration file\n(seen in Figure 10) as libstringutils.dll.\n\n_Figure 10. The Tor configuration file used by the latest version of the malware_\n\nThis sets up a SOCKS proxy on port 9050 that is used by the malware to relay all communications with the C&C\nservers through the Tor network. This has the dual benefit of encrypting the communications and making it virtually\nimpossible to trace the actual server or servers behind these URIs.\n\nThe second part of the configuration file sets up onion services (In Tor, onion services are a way of making a\nservice running on a certain port only reachable via the Tor network.) on the victimized host. These are accessible\nby the operators over the Tor network. When first starting up these services, Tor automatically generates a .onion\nURI for the host. This unique hostname is then sent to %C&C%/transferhost/<unique name>. We will discuss how\nthese onion services are used in the upcoming sections.\n\n**Port Number** **Service**\n\n9091 Transmission Daemon RPC interface\n\n9999 Apache httpd server\n\n9187 Buru SFTP server\n\n9188 Buru Web Admin\n\n12461 MiniWeb HTTP server\n\nThe onion URIs for two C&C servers are contained in the malware. One of these provides a REST API that the\nmalware uses for most communications, while the other is used to download files. Additional URIs can be obtained\none at a time with a request to %C&C%/server. Some older versions of the malware use these to download\nupdates via port 12461. We believe that these URIs point to other infected hosts. The versions of the malware that\nuse them have code to place their downloaded updates into a directory served by the MiniWeb HTTP server on that\nsame port.\n\nWe were able to identify one IP address for the file server C&C in our telemetry data.\n\n## Acquiring cryptocurrency\n\nKryptoCibule has three components that leverage infected hosts in order to obtain cryptocurrencies.\n\n### Cryptomining\n\nThe latest versions of KryptoCibule use XMRig, an open source program that mines Monero using the CPU, and\nkawpowminer, another open source program that mines Ethereum using the GPU. The second one is only used if a\ndedicated GPU is found on the host. Both of these programs are set up to connect to an operator-controlled mining\n\n\n-----\n\nserver over the Tor proxy.\n\nOn every iteration of the main loop, the malware checks the battery level and the time since the last user input. It\nthen starts or stops the miner processes based on this information. If the host has received no user input in the last\n3 minutes and has at least 30% battery, both the GPU and CPU miners are run without limits. Otherwise, the GPU\nminer is suspended, and the CPU miner is limited to one thread. If the battery level is under 10%, both miners are\nstopped. This is done to reduce the likelihood of being noticed by the victim.\n\n### Clipboard hijacking\n\nThe second component masquerades as SystemArchitectureTranslation.exe. It uses the\n[AddClipboardFormatListener function to monitor changes to the clipboard and to apply the replacement rules](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-addclipboardformatlistener)\nobtained from %C&C%/regexes to its content. The code for this listener is shown in Figure 11. The value 0x31D\ncorresponds to the WM_CLIPBOARDUPDATE constant.\n\nThese rules, in the form <regular_expresssion>!<wallet>, match the format of cryptocurrency wallet addresses and\nreplace them with addresses of wallets controlled by the malware operator. This is an attempt to redirect\n[transactions made by the victim to the operator’s wallets. This component uses a FileSystemWatcher to reload](https://docs.microsoft.com/en-us/dotnet/api/system.io.filesystemwatcher)\nreplacement rules whenever the settings.cfg file is changed.\n\n_Figure 11. Decompiled code for the listener function used by the clipboard hook_\n\n\n-----\n\nAt the time of this writing, the wallets used by the clipboard hijacking component had received a little over US$1800\nin Bitcoin and Ethereum. One such wallet is shown in Figure 12. By correlating wallets used as sources in the same\ntransactions as known ones, we were able to uncover at least four additional Bitcoin wallets that likely belong to\nKryptoCibule’s operators.\n\n_Figure 12. A Bitcoin wallet used by the clipboard-hijacking component_\n\n### File exfiltration\n\nThe third component walks through the filesystem of each available drive and looks for filenames that contain\ncertain terms. A list of such terms we obtained during our investigation is shown in Figure 13.\n\n1 [\"wallet.dat\", \"utc--2014\", \"utc--2015\", \"utc--2016\", \"utc--2017\", \"utc--2018\", \"utc--2019\", \"utc--2020\",\n\".address.txt\", \"electrum\", \"bitcoin\", \"litecoin\", \"ethereum\", \"cardano\", \"zcash\", \"monero\", \"cripto\", \"krypto\",\n\"binance\", \"tradeogre\", \"coinbase\", \"tether\", \"daedalus\", \"stellar\", \"tezos\", \"chainlink\", \"blockchain\", \"verge\",\n\"bittrex\", \"ontology\", \"vechain\", \"doge\", \"qtum\", \"augur\", \"omisego\", \"digibyte\", \"seele\", \"enjin\", \"steem\",\n\"bytecoin\", \"zilliqa\", \"zcoin\", \"miner\", \"xmrig\", \"xmr-stak\",\"electroneum\", \"heslo\", \"waves\", \"banka\", \"crypto\",\n\"hesla\", \"seed\", \"metamask\", \"antminer\", \"trezor\", \"ledger\", \"private\", \"trx\", \"exodus\", \"password\", \"jaxx\",\n\"guarda\", \"atomic.exe\", \"copay.exe\", \"Green Address Wallet.exe\", \"msigna.exe\", \"ArmoryQT.exe\", \".ssh\",\n\".aws\", \"Desktop\"]\n\n_Figure 13. A list of words to search for, taken from the GET %C&C%/settingsv5 response_\n\n\n-----\n\nMost terms refer to cryptocurrencies, wallets or miners, but a few more generic ones like crypto (in several\nlanguages), seed and password are present also. The list contains similar terms in Czech and Slovak such as\nheslo, hesla and banka (these are the words for “password”, “passwords” and “bank”, respectively). A few terms\nalso correspond to paths or files that could provide other interesting data (Desktop, private) including private keys\n(.ssh, .aws). It gathers the full path of each of the matching files and sends the list to %C&C%/found/<unique\nname>.\n\nWe believe that this works in tandem with the SFTP server running as an onion service on port 9187. This server\ncreates mappings for every available drive and makes them available using credentials hardcoded in the malware.\nThe gathered paths can thus be used for file exfiltration by having an attacker-controlled machine request them\nfrom the infected host over SFTP.\n\nKryptoCibule also installs a legitimate Apache httpd server that is configured to act as a forward proxy without any\nrestrictions and that is reachable as an onion service on port 9999.\n\n## Conclusion\n\nThe KryptoCibule malware has been in the wild since late 2018 and is still active, but it doesn’t seem to have\nattracted much attention until now. Its use of legitimate open-source tools along with the wide range of antidetection methods deployed are likely responsible for this. The relatively low number of victims (in the hundreds)\nand their being mostly confined to two countries may also contribute to this. New capabilities have regularly been\nadded to KryptoCibule over its lifetime and it continues to be under active development.\n\nPresumably the malware operators were able to earn more money by stealing wallets and mining cryptocurrencies\nthan what we found in the wallets used by the clipboard hijacking component. The revenue generated by that\ncomponent alone does not seem enough to justify the development effort observed.\n\n## Indicators of Compromise (IoCs)\n\n[The comprehensive list of Indicators of Compromise (IoCs) and samples can be found in our GitHub repository.](https://github.com/eset/malware-ioc/tree/master/kryptocibule/)\n\n### Samples\n\n\n**SHA-1** **Filename**\n\n\n**ESET detection**\n**name**\n\n\n3BCEF852639F85803974943FC34EFF2D6D7D916D armsvc.exe MSIL/KryptoCibule.A\n\n352743EBE6A0638CC0614216AD000B6A43C4D46E SystemArchitectureTranslation.exe MSIL/KryptoCibule.A\n\n70480D5F4CB10DE42DD2C863DDF57102BE6FA9E0 Updater.exe MSIL/KryptoCibule.A\n\n2E568CDF9B28824FBA1D7C16D8D0BE1D73A3FEBA Setup.exe MSIL/KryptoCibule.A\n\n## Network\n\nrlwryismmgjijryr55u5rqlbqghqvrwxe5qgxupuviyysxkky5wah6yd.onion\n\n4dtu3lxrpx6nn7snjovoc3ldiy4x67k7qsrgzftvkrttoqbwnsuirhqd.onion\n\nv6lajszeqfkt3h2nptorindpf3mow5p3thrx2vuqbqzbv3tjrcqmgdqd.onion\n\n## Scheduled Tasks\n\n**Name** **Executable Path**\n\nGoogleUpdateTask %LocalAppData%\\Microsoft\\Architecture\\SystemArchitectureTranslation.exe\n\n\n-----\n\n**Name** **Executable Path**\n\nAdobe Update Task %ProgramFiles(X86)%\\Adobe\\Acrobat Reader DC\\Reader\\Update\\armsvc.exe\n\n## MITRE ATT&CK techniques\n\n_[This table was built using version 7 of the ATT&CK framework.](https://attack.mitre.org/versions/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1189](https://attack.mitre.org/versions/v7/techniques/T1189/) Drive-by Compromise KryptoCibule is spread through torrent and\nfile-sharing websites.\n\n\nExecution [T1059.001](https://attack.mitre.org/versions/v7/techniques/T1059/001/) Command and Scripting\nInterpreter: PowerShell\n\n\n[T1059.003](https://attack.mitre.org/versions/v7/techniques/T1059/003/) Command and\nScripting Interpreter:\nWindows Command\nShell\n\n\nCommands received from\nthe KryptoCibule C&C are\nexecuted with cmd.exe.\n\n\n[T1106](https://attack.mitre.org/versions/v7/techniques/T1106/) Native API KryptoCibule uses the\nSystem.Diagnostics.Process\nC# class to run processes.\n\n\nKryptoCibule directly executes PowerShell\ncommands.\n\nSome commands received from the C&C\nuse PowerShell.\n\nKryptoCibule attains persistence by\ncreating a scheduled task to run the main\nexecutable every five minutes.\n\nKryptoCibule executables are obfuscated\nwith Obfuscar.\n\n\n[T1204.002](https://attack.mitre.org/versions/v7/techniques/T1204/002/) User Execution:\nMalicious File\n\n\nKryptoCibule requires\nvictims to run an installer\nfrom a downloaded torrent.\n\n\nPersistence [T1053.005](https://attack.mitre.org/versions/v7/techniques/T1053/005/) Scheduled Task/Job:\nScheduled Task\n\n\nDefense\nEvasion\n\n\n[T1027](https://attack.mitre.org/versions/v7/techniques/T1027/) Obfuscated Files or\nInformation\n\n\n[T1036](https://attack.mitre.org/versions/v7/techniques/T1036/) Masquerading KryptoCibule components\nuse misleading names and\na configuration file\nmasquerades as a DLL.\n\n\n[T1036.004](https://attack.mitre.org/versions/v7/techniques/T1036/004/) Masquerading:\nMasquerade Task or\nService\n\n[T1036.005](https://attack.mitre.org/versions/v7/techniques/T1036/005/) Masquerading: Match\nLegitimate Name or\nLocation\n\n[T1140](https://attack.mitre.org/versions/v7/techniques/T1140/) Deobfuscate/Decode\nFiles or Information\n\n\nKryptoCibule tasks are\nnamed after legitimate and\nbenign looking software.\n\nKryptoCibule uses paths\nand filenames that match\nthose of Adobe Reader for\nmalware and Tor client.\n\nBuruServer uses paths and\nfilenames for OpenSSH.\n\nTransmission is installed to\nJava runtime directories.\n\nThe files that come with the\nKryptoCibule installer are\nXOR-encrypted.\n\nPowerShell commands from\nthe KryptoCibule C&C are\nbase64-encoded.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1497](https://attack.mitre.org/versions/v7/techniques/T1497/) Virtualization/Sandbox\nEvasion\n\n[T1497.002](https://attack.mitre.org/versions/v7/techniques/T1497/002/) Virtualization/Sandbox\nEvasion: User Activity\nBased Checks\n\n[T1562.001](https://attack.mitre.org/versions/v7/techniques/T1562/001/) Impair Defenses:\nDisable or Modify\nTools\n\n[T1562.004](https://attack.mitre.org/versions/v7/techniques/T1562/004/) Impair Defenses:\nDisable or Modify\nSystem Firewall\n\n[T1564.003](https://attack.mitre.org/versions/v7/techniques/T1564/003/) Hide Artifacts: Hidden\nWindow\n\n\nThe KryptoCibule payload is\nnot executed if an analysis\ntool is detected.\n\nKryptoCibule uses the time\nsince last input to set limits\non cryptominer CPU usage.\n\nKryptoCibule uses AddMpPreference ExclusionPath to exclude\nmalware and installed tools\nfrom Windows Defender\nscanning.\n\nKryptoCibule uses\nadvfirewall firewall add rule\nto allow its tools and block\nthe ESET Kernel Service.\n\nKryptoCibule hides process\nwindows using the\nwindowstyle hidden option.\n\n\nDiscovery [T1057](https://attack.mitre.org/versions/v7/techniques/T1057/) Process Discovery KryptoCibule uses\nSystem.Diagnostics.Process.GetProcesses\nto get a list of running processes.\n\n\n[T1082](https://attack.mitre.org/versions/v7/techniques/T1082/) System Information\nDiscovery\n\n[T1083](https://attack.mitre.org/versions/v7/techniques/T1083/) File and Directory\nDiscovery\n\n[T1518.001](https://attack.mitre.org/versions/v7/techniques/T1518/001/) Software Discovery:\nSecurity Software\nDiscovery\n\n\nKryptoCibule obtains\ninformation about host’s\ntimezone, locale, power\nstatus, OS and hardware.\n\nKryptoCibule has a\ncomponent that looks for\nfiles on the local file system.\n\nKryptoCibule looks for\nantivirus software in the\nroot\\\\SecurityCenter2 →\nAntivirusProduct\nManagementObject.\n\nThe cryptominer component\nis not installed if it detects\nan installed antivirus\nproduct.\n\n\nCollection [T1005](https://attack.mitre.org/versions/v7/techniques/T1005/) Data from Local System KryptoCibule learches all attached drives\nfor a list of filenames .\n\n[T1119](https://attack.mitre.org/versions/v7/techniques/T1119/) Automated Collection KryptoCibule\nprogrammatically collect\npaths for files to be\nexfiltrated.\n\n\nCommand\nand Control\n\n\n[T1071.001](https://attack.mitre.org/versions/v7/techniques/T1071/001/) Application Layer Protocol:\nWeb Protocols\n\n\nKryptoCibule uses HTTP for C&C\ncommunication.\n\n\n[T1071.002](https://attack.mitre.org/versions/v7/techniques/T1071/002/) File Transfer\nProtocols\n\n\nKryptoCibule downloads\nupdates and additional tools\nvia BitTorrent.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1090.003](https://attack.mitre.org/versions/v7/techniques/T1090/003/) Proxy: Multi-hop\nProxy\n\n\nKryptoCibule bundles Tor\nand uses it as a SOCKS\nproxy to communicate with\nits C&C.\n\n\n[T1105](https://attack.mitre.org/versions/v7/techniques/T1105/) Ingress Tool Transfer KryptoCibule downloads\nadditional tools using\nBitTorrent.\n\n[T1568](https://attack.mitre.org/versions/v7/techniques/T1568/) Dynamic Resolution KryptoCibule gets additional\nonion URIs over HTTP.\n\n[T1571](https://attack.mitre.org/versions/v7/techniques/T1571/) Non-Standard Port KryptoCibule uses port 9187\nfor SFTP server, and 9999\nand 12461 for HTTP\nservers.\n\nExfiltration [T1020](https://attack.mitre.org/versions/v7/techniques/T1020/) Automated Exfiltration Logs, file locations and system info are\nautomatically collected and sent to the\nKryptoCibule C&C.\n\n\n[T1041](https://attack.mitre.org/versions/v7/techniques/T1041/) Exfiltration Over C2\nChannel\n\n[T1048](https://attack.mitre.org/versions/v7/techniques/T1048/) Exfiltration Over\nAlternative Protocol\n\n\nLogs, file locations and\nsystem info are sent via the\nKryptoCibule HTTP C&C\nchannel.\n\nKryptoCibule exfiltrates files\nover SFTP.\n\n\nImpact [T1496](https://attack.mitre.org/versions/v7/techniques/T1496/) Resource Hijacking KryptoCibule uses XMRig and\nKawpowminer to mine cryptocurrency on\nvictim systems.\n\n[T1565](https://attack.mitre.org/versions/v7/techniques/T1565/) Data Manipulation KryptoCibule replaces\ncryptocurrency wallet\naddresses in the clipboard\nin an attempt to hijack\ntransfers.\n\n2 Sep 2020 - 11:30AM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-02 - KryptoCibule- The multitasking multicurrency cryptostealer.pdf"
    ],
    "report_names": [
        "2020-09-02 - KryptoCibule- The multitasking multicurrency cryptostealer.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535906,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653698227,
    "ts_modification_date": 1653698227,
    "files": {
        "pdf": "https://archive.orkl.eu/084c8fa5d0f9bd5190ad39e4c8b5f6595137f4f7.pdf",
        "text": "https://archive.orkl.eu/084c8fa5d0f9bd5190ad39e4c8b5f6595137f4f7.txt",
        "img": "https://archive.orkl.eu/084c8fa5d0f9bd5190ad39e4c8b5f6595137f4f7.jpg"
    }
}