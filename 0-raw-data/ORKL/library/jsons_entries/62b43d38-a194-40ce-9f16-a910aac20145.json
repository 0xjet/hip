{
    "id": "62b43d38-a194-40ce-9f16-a910aac20145",
    "created_at": "2023-01-12T15:00:11.862455Z",
    "updated_at": "2025-03-27T02:16:25.732559Z",
    "deleted_at": null,
    "sha1_hash": "679c600c029574e435b3af9a290d9a011c7a83ec",
    "title": "2020-11-16 - Malsmoke operators abandon exploit kits in favor of social engineering scheme",
    "authors": "",
    "file_creation_date": "2022-05-28T22:08:12Z",
    "file_modification_date": "2022-05-28T22:08:12Z",
    "file_size": 1327827,
    "plain_text": "# Malsmoke operators abandon exploit kits in favor of social engineering scheme\n\n**blog.malwarebytes.com/threat-analysis/2020/11/malsmoke-operators-abandon-exploit-kits-in-favor-of-social-**\nengineering-scheme/\n\nThreat Intelligence Team November 16, 2020\n\nExploit kits continue to be used as a malware delivery platform. In 2020, we’ve observed a\n[number of different malvertising campaigns leading to RIG,](https://twitter.com/MBThreatIntel/status/1289275954896936960?s=20) [Fallout,](https://twitter.com/MBThreatIntel/status/1245791188281462784?s=20) [Spelevo and](https://twitter.com/MBThreatIntel/status/1308487877584539648?s=20) [Purple Fox,](https://twitter.com/MBThreatIntel/status/1306674575233540096?s=20)\namong others.\n\nAnd, in September, we put out a [blog post detailing a surge in malvertising via adult](https://blog.malwarebytes.com/social-engineering/2020/09/malvertising-campaigns-come-back-in-full-swing/)\nwebsites. One of those campaigns we dubbed ‘malsmoke’ had been active since the\nbeginning of the year. What made it stand out was the fact it was going after top adult portals\nand had been continuing unabated for months.\n\nStarting mid-October, the threat actors behind malsmoke appear to have phased out the\nexploit kit delivery chains in favor of a social engineering scheme instead. The new\ncampaign is tricking visitors to adult websites with a fake Java update.\n\nThis change is significant because it drastically increases the target audience, no longer\nlimiting it to Internet Explorer users running outdated software.\n\n## Top malvertiser for months\n\nThe malsmoke campaign derives its name from the most frequent payload it dropped via the\n[Fallout exploit kit, namely Smoke Loader.](https://blog.malwarebytes.com/threat-analysis/2016/08/smoke-loader-downloader-with-a-smokescreen-still-alive/)\n\n\n-----\n\nWhile we see a number of malvertising chains, the majority of them come from low quality\ntraffic and shady ad networks. Malsmoke goes for high traffic adult portals, hoping to yield\nthe maximum number of infections. For example, malsmoke has been present on\nxhamster[.]com, a site with [974 million monthly visits, on and off for months.](https://www.similarweb.com/website/xhamster.com/)\n\n[#Malsmoke malvertising campaign continues on xhamster and other top sites.](https://twitter.com/hashtag/Malsmoke?src=hash&ref_src=twsrc%5Etfw)\n\nAlso, [#FalloutEK seems to have added a new anti-vm check that returns a 404 on the](https://twitter.com/hashtag/FalloutEK?src=hash&ref_src=twsrc%5Etfw)\npayload session. If your sandbox looks good, that last session should return a 200 and\ncontain the binary. [pic.twitter.com/qPaF6z9PKt](https://t.co/qPaF6z9PKt)\n\n— MB Threat Intel (@MBThreatIntel) [September 21, 2020](https://twitter.com/MBThreatIntel/status/1308167098070310912?ref_src=twsrc%5Etfw)\n\nFigure 1: Tweet about continued malvertising attacks on popular adult site\nDespite this successful run, malsmoke fell off our radar and we recorded its last activity on\nOctober 18. A couple of days prior (October 16), our telemetry registered a new malvertising\ncampaign that uses a decoy page filled with adult images purporting to be movies.\n\n**Adult site: bravoporn[.]com/v/pop.php**\n**Ad network: tsyndicate[.]com**\n**BeMob Ad: d8z1u.bemobtrcks[.]com/**\n**Decoy adult site: pornguru[.]online/B87F22462FDB2928564CED**\n\nA couple of weeks later, this campaign added a new domain as part of its redirect chain, but\nwe can see that they are related (including the. same identifier marker in the URL)\n\n**Adult site: xhamster[.]com**\n**Ad network: tsyndicate[.]com**\n**Redirect: landingmonster[.]online**\n**Decoy adult site: pornislife[.]online/B87F22462FDB2928564CED**\n\nThat portal is used as a lure to get people to play adult videos that do not actually exist.\nInstead, users will be asked to download a fake Java update that is malicious.\n\n\n-----\n\nFigure 2: Decoy adult\n\ntemplate luring users with fake videos\nA closer look at the template used and network indicators revealed that this latest\nmalvertising campaign actually belongs to the same malsmoke threat actors that had\npreviously used exploit kits.\n\n\n-----\n\nFigure 3: Comparing template and traffic sequences between exploit kit and soc. engineering\nWe notice the same adult movie page template, with one minor fix (the typo in the page title\nwhich could have been due to the Russian keyboard layout).\n\nAdditionally, the latest domain name pornislife[.]online was registered with the same email\naddress mikami9722@hxqmail[.]com tied to a number of other web properties previously\n[related to malsmoke gates.](https://twitter.com/MBThreatIntel/status/1245791188281462784?s=20)\n\n\n-----\n\nFigure\n\n4: Same registrant email address used by malsmoke actors\nThe malsmoke operators ran successful exploit kit campaigns for several months but in\nOctober decided to switch them over to a new social engineering scheme. However, the\nmalvertising chains remained similar as they kept abusing high traffic adult portals and the\nTraffic Stars ad network.\n\n## New social engineering trick\n\nThe new scheme works across all browsers, including the one with the largest market share,\nGoogle Chrome. Here’s how it works: when clicking to play an adult video clip, a new\nbrowser window pops up with what looks a grainy video (black bars are ours):\n\n\n-----\n\nFigure 5: Adult video clip used as lure\nThe movies plays for a few seconds with audible sound in the background until an overlay\nmessage is displayed telling users that the “Java Plug-in 8.0 was not found”.\n\nThe movie file is a 28 second MPEG-4 clip that has been rendered with a pixelated view on\npurpose. It is meant to let users believe they need to download a missing piece of software\neven though this will not help in any way at all.\n\n\n-----\n\nFigure 6: Video clip was customized by the threat actor\nThe threat actors could have designed this fake plugin update in any shape or form. The\nchoice of Java is a bit odd, though, considering it is not typically associated with video\nstreaming. However, those who click and download the so-called update may not be aware\nof that, and that’s really all that matters.\n\n\n-----\n\nFigure 7: Fake Java update dialog\n[This fake dialog is reminiscent of the missing ‘HoeflerText font’ campaign used in the EITest](https://www.proofpoint.com/us/threat-insight/post/EITest-Nabbing-Chrome-Users-Chrome-Font-Social-Engineering-Scheme)\ntraffic redirection schemes. EITest was also known for using exploit kits to distribute malware\nand at some point switched to a similar social engineering trick to target more users,\nespecially those running the Chrome browser.\n\n## Payload analysis\n\nThe threat actors essentially developed their own utility to download a remote payload that\nhad the advantage of not being easily detected. If you recall, malsmoke previously relied on\nSmoke Loader to distribute its payloads, whereas now it has its very own loader, thanks a\n\n\n-----\n\nnew evasive MSI installer.\n\nFigure 8: Payload installation flow, leading to ZLoader\nThe fake Java update (JavaPlug-in.msi) is a digitally signed Microsoft installer that contains a\nnumber of libraries and executables, most of which are legitimate.\n\n\n-----\n\nFigure 9:\n\nContents of MSI installer\nOn installation, lic_service.exe loads HelperDll.dll which is the most important module\nresponsible for deploying the final payload.\n\n\n-----\n\nFigure 10: Code invoking HelperRun DLL\nHelperDll.dll uses the curl library that is present in the MSI archive to download an encrypted\npayload from moviehunters[.]site.\n\n\n-----\n\nFigure 11: Request to backend server for actual payload\nThis is the ZLoader malware, which is then written to disk and ran as:\n```\n%AppData%\\Roaming\\microsoft_shared.tmp\n\n```\nZLoader injects itself into a new msiexec.exe process to contact its command and control\nserver using a Domain Generation Algorith (DGA). Once it identifies a domain that responds,\nit starts downloading different modules and optionally an update to ZLoader itself.\n\n\n-----\n\nFigure 12:\n\nPost infection traffic, showing ZLoader gate\nOn the left of Figure 12, we can see the traffic generated by ZLoader implants injected into\nmsiexec.exe. On the right, we can see those implants dumped from the same process. You\ncan find more information on ZLoader and its implants in our paper The “Silent Night”\nZloader/Zbot.\n\n## Evolving web threats\n\nMalsmoke was one of the most noticeable distributors of malvertising and exploit kits striking\non high profile websites.\n\nWhile we thought the threat actor had gone silent, they simply changed tactics in order to\nfurther grow their operations. Instead of targeting a small fraction of visitors to adult sites that\nwere still running Internet Explorer, they’ve now extended their reach to all browsers.\n\nIn the absence of high value software vulnerabilities and exploits, social engineering is an\nexcellent option as it is cost effective and reliable. As far as web threats go, such schemes\nare here to stay for the foreseeable future.\n\n[Malwarebytes Browser Guard already protected users from this malvertising campaign.](https://www.malwarebytes.com/browserguard/)\nAdditionally, we detect the MSI installer and ZLoader payloads via our Malwarebytes for\nWindows.\n\n\n-----\n\nFigure 13: Malwarebytes Browser Guard blocking redirector\n\n## Indicators of Compromise\n\nRedirector:\n```\nlandingmonster[.]online\n\n```\nDecoy adult portal:\n```\npornislife[.]online\n\n```\nMSI installer:\n```\n87bfbbc345b4f3a59cf90f46b47fc063adcd415614afe4af7afc950a0dfcacc2\n\n```\nFirst C2:\n```\nmoviehunters[.]site\n\n```\nZLoader:\n\n\n-----\n\n```\n4a30275f14f80c6e11d5a253d7d004eda98651010e0aa47f744cf4105d1676ab\n\n```\nZLoader C2s:\n```\niqowijsdakm[.]ru\nwiewjdmkfjn[.]ru\ndksaoidiakjd[.]su\niweuiqjdakjd[.]su\nyuidskadjna[.]su\nolksmadnbdj[.]su\nodsakmdfnbs[.]com\nodsakjmdnhsaj[.]com\nodjdnhsaj[.]com\nodoishsaj[.]com\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-16 - Malsmoke operators abandon exploit kits in favor of social engineering scheme.pdf"
    ],
    "report_names": [
        "2020-11-16 - Malsmoke operators abandon exploit kits in favor of social engineering scheme.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535611,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653775692,
    "ts_modification_date": 1653775692,
    "files": {
        "pdf": "https://archive.orkl.eu/679c600c029574e435b3af9a290d9a011c7a83ec.pdf",
        "text": "https://archive.orkl.eu/679c600c029574e435b3af9a290d9a011c7a83ec.txt",
        "img": "https://archive.orkl.eu/679c600c029574e435b3af9a290d9a011c7a83ec.jpg"
    }
}