{
    "id": "a21b37f8-bcfc-489c-8cf0-23fea4bc88d7",
    "created_at": "2023-01-12T15:00:41.609712Z",
    "updated_at": "2025-03-27T02:16:37.114605Z",
    "deleted_at": null,
    "sha1_hash": "0d9547c41630bf06b0f86c988b8bb5bf7f3afb54",
    "title": "2018-05-31 - NavRAT Uses US-North Korea Summit As Decoy For Attacks In South Korea",
    "authors": "",
    "file_creation_date": "2022-05-28T15:55:33Z",
    "file_modification_date": "2022-05-28T15:55:33Z",
    "file_size": 560295,
    "plain_text": "# NavRAT Uses US-North Korea Summit As Decoy For Attacks In South Korea\n\n**blog.talosintelligence.com/2018/05/navrat.html**\n\n[This blog post is authored by Warren Mercer and](https://twitter.com/securitybeard) [Paul Rascagneres with contributions from](https://twitter.com/r00tbsd)\nJungsoo An.\n\n## Executive Summary\n\nTalos has discovered a new malicious Hangul Word Processor (HWP) document targeting\nKorean users. If a malicious document is opened, a remote access trojan that we're calling\n\"NavRAT\" is downloaded, which can perform various actions on the victim machine,\nincluding command execution, and has keylogging capabilities.\n\nThe decoy document is named \"미북 정상회담 전망 및 대비.hwp\" (Prospects for US-North\nKorea Summit.hwp). The HWP file format is mainly used in South Korea. An Encapsulated\nPostScript (EPS) object is embedded within the document in order to execute malicious\nshellcode on the victim systems. The purpose is to download and execute an additional\npayload hosted on a compromised website: NavRAT.\n\nThis is a classic RAT that can download, upload, execute commands on the victim host and,\nfinally, perform keylogging. However, the command and control (C2) infrastructure is very\nspecific. It uses the legitimate Naver email platform in order to communicate with the\n\n\n-----\n\nattackers via email. The uploaded file(s) are sent by email, and the downloaded files are\nretrieved from an email attachment. We have already observed malware using free email\nplatforms for abuse, but this is the first time we have identified a malware that uses Naver —\nwhich is known for its popularity in South Korea.\n\nOne of the most interesting questions we still have is regarding attribution — and who is\n[behind this malware. Previously, we published several articles concerning Group123 (here,](https://blog.talosintelligence.com/2018/01/korea-in-crosshairs.html)\n[here,](https://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html) [here,](https://blog.talosintelligence.com/2017/04/introducing-rokrat.html) [here and](https://blog.talosintelligence.com/2017/02/korean-maldoc.html) [here). We currently assess with medium confidence that this campaign](https://blog.talosintelligence.com/2018/02/group-123-goes-wild.html)\nand NavRAT are linked to Group123.\n\n## Malicious Document\n\n### Decoy Document\n\nThe attack starts with a spear-phishing email containing the HWP document named \"미북 정\n상회담 전망 및 대비.hwp\" (Prospects for US-North Korea Summit .hwp). This references a\n[legitimate event that could potentially take place on June 12. Here is a screenshot of the](https://www.cnbc.com/2018/05/31/us-north-korea-meetings-in-new-york-aimed-at-salvaging-summit.html&sa=D&ust=1527796940964000)\ndocument:\n\n\n-----\n\nThis document explains concerns prior to the summit between the U.S. and North Korea,\nwhich is expected to focus on the topic of denuclearization. The summit is the latest in a line\nof signs of diplomatic outreach from North Korea, following the Panmunjom Declaration for\nPeace, Prosperity and Unification of the Korean Peninsula between South Korea and North\nKorea on April 27, 2018.\n\nThis document contains the aforementioned EPS object. This object is used to execute\nmalicious shellcode on the system. This is a seemingly common vector for attackers when\nusing HWP documents, which we have previously encountered and described.\n\n### Malicious Code\n\nAs we already mentioned in our previous articles concerning malicious documents, EPS is\neffective from an attacker's point of view. It is a powerful, stack-based scripting language,\nand in malicious use cases, can be abused to obtain additional payloads. Here is the content\nof the file:\n```\n/shellcode <90909090909090909090E800<...redacted…>4D2D6DC95CBD5DC1811111111111111>\ndef\n<7B0D0A2756...redacted…>312067657420636C6F736566696C650D0A717569740D0A7D>\ntoken pop exch pop\nExec\n\n```\nThe executed shellcode will first perform a decoding routine designed to download an\nadditional payload from the internet. In our case, the file URI was:\n```\nhxxp://artndesign2[.]cafe24[.]com:80/skin_board/s_build_cafeblog/exp_include/img.png\n\n```\nThis website is a legitimate Korean website. We assume that this website was compromised\nin order to deliver the final payload on the targeted systems. This is a method we have\npreviously observed with attacks focusing on the Korean peninsula.\n\nThe image is downloaded directly, and the shellcode is loaded and executed in memory. This\nis an example of fileless execution by only running malicious processes within the memory of\nthe victim host. The purpose is to drop and execute a decoded executable using the\nfollowing path:\n```\n%APPDATA%\\Local\\Temp\\~emp.exe\n\n```\nOnce executed, NavRAT will immediately leverage cmd.exe to perform a systeminfo and a\ntasklist check on the system it is running on while writing the output to a TMP file, once again\nattempting to hide within an AhnLab folder. Interestingly, the attacker has used the >>\nmethod to append to the file so there can be multiple outputs written to their single TMP file:\n```\n\"C:\\Windows\\system32\\cmd.exe\" /C systeminfo >> \"C:\\Ahnlab\\$$$A24F.TMP\"\n\n```\n\n-----\n\n```\n\"C:\\WINDOWS\\system32\\cmd.exe\" /C tasklist /v >> \"C:\\Ahnlab\\$$$A24F.TMP\"\n\n## NavRAT\n\n### Capabilities\n\n```\nNavRAT is a remote access trojan (RAT) designed to upload, download and execute files.\nThe analysed sample contains many verbose logs. The malware's author logs every action\nto a file (encoded). It's not often we are able to use the attacker's own logging capability to\nfacilitate analysis, which can make our research easier.\n\nThis screenshot shows the logs messages during the process injection with the API usage.\n\nNavRAT starts by copying itself (~emp.exe) to the\n%ProgramData%\\Ahnlab\\GoogleUpdate.exe path. It uses the path of a well-known security\n[company located in South Korea named AhnLab. NavRAT then creates a registry key in](https://www.ahnlab.com/&sa=D&ust=1527796940968000)\norder to execute this file copy at the next reboot of the system, an initial method of\npersistence. The log files mentioned previously are stored in the same directory as NavRAT\non the victim machine, again making it easy for us to find and analyse the additional log files.\n\nNavRAT has support for process injection. By using this method, it will copy itself into a\nrunning Internet Explorer process in order to avoid detection by running as an independent\nprocess. The malware is able to register the keystrokes on the targeted user's system:\n\n\n-----\n\nThe most interesting part of this RAT is the C2 server architecture. The malware uses the\nNaver email platform in order to communicate with the operators.\n\n### Command & Control\n\nThe malware communicates with the Naver email platform in order to communicate with the\noperator. The credentials are hardcoded in the sample:\n\n\n-----\n\nHowever, during our investigation, NavRAT was unable to communicate with the email\naddress:\n```\n[05/30/2018, 17:39:45] NaverUpload Start!!\n[05/30/2018, 17:39:46] NaverUpload :PreUploading success\n[05/30/2018, 17:39:46]  uploading step-1 : HttpSendRequest failed. Err[12150]\n[05/30/2018, 17:39:46] ////////////// Response Headers getting failure //////////\n[05/30/2018, 17:39:46] NaverUpload :Uploading failed. Try[0]\n[05/30/2018, 17:39:47]  uploading step-1 : HttpSendRequest failed. Err[12150]\n[05/30/2018, 17:39:47] ////////////// Response Headers getting failure //////////\n[05/30/2018, 17:39:47] NaverUpload :Uploading failed. Try[1]\n[05/30/2018, 17:39:48]  uploading step-1 : HttpSendRequest failed. Err[12150]\n[05/30/2018, 17:39:48] ////////////// Response Headers getting failure //////////\n[05/30/2018, 17:39:48] NaverUpload :Uploading failed. Try[2]\n[05/30/2018, 17:39:49]  uploading step-1 : HttpSendRequest failed. Err[12150]\n[05/30/2018, 17:39:49] ////////////// Response Headers getting failure //////////\n[05/30/2018, 17:39:49] NaverUpload :Uploading failed. Try[3]\n[05/30/2018, 17:39:51]  uploading step-1 : HttpSendRequest failed. Err[12150]\n[05/30/2018, 17:39:51] ////////////// Response Headers getting failure //////////\n[05/30/2018, 17:39:51] NaverUpload :Uploading failed. Try[4]\n[05/30/2018, 17:39:52] UploadProc : UploadFile Err\n[05/30/2018, 17:39:52] PreCommProc : UploadProc failed\n\n```\nThe broken communication was due to protection implemented by Naver. The malware was\npresumably executed from too many different countries, and the account is currently locked:\n\n\n-----\n\n-----\n\nThe password must be reset by providing information on the account, or with a mobile phone\nof the owner (the phone number is located in the UK). In its current status, NavRAT cannot\nwork correctly. We assume that the owner of the malware didn't know that Naver\nimplemented this protection.\n\nNavRAT is able to download and execute files located in the attachment of a received email.\nIt is able to remove emails, and finally, it is able to send an email via the Naver account. In\nour sample, the data is attempted to be sent to: chioekang59@daum[.]net.\n\n\n-----\n\n### Archeology\n\nDuring our investigation, we tried to find additional samples of NavRAT. We only identified\none old sample compiled in May 2016. As in our case, this old sample used a fake AhnLab\ndirectory to store logs files (C:\\AhnLab\\). In this version, the compilation path was not\nremoved:\n```\nN:\\CodeProject\\VC_Code Project\\Attack_Spy\\mailacounts.com\\src_total_20160430 v10.0(DIV)\\bin\\PrecomExe(Win32).pdb\n\n```\nWe can conclude that NavRAT has probably existed since 2016 — which we believe to be\nversion 10 at the time. The attacker(s) appear to have remained under the radar for several\nyears. We assume this malware has been sparingly used and only for very specific targets.\n\n## Group123 Links?\n\n\n-----\n\nAs we explore the Korean malware landscape, we always have burning questions relating to\nany possible links with Group123. We identified some relevant points which we believe with\nmedium confidence suggests the involvement of Group123 based on previous TTPs used by\nthis group.\n\nThe modus operandi is identical to previous Group123 campaigns — a HWP document with\nembedded EPS object containing malicious shellcode. The shellcode of the embedded\nobject is designed to download an image, which is, in fact, a new shellcode used to decode\nan embedded executable. We saw this exact same methodology used by Group123 during\n[previous attacks. One such example is ROKRAT, another remote access trojan we](https://blog.talosintelligence.com/2017/04/introducing-rokrat.html&sa=D&ust=1527796940972000)\ndiscovered in April 2017 that targeted the Korean peninsula.\n\nThe shellcode used in the EPS object is not exactly the same, but it contains a lot of\nsimilarities right down to the number of instructions used, the amount of NOP (No\nOperations) and almost identical command layout. (On the left is NavRAT, and on the right is\nthe shellcode of ROKRAT):\n\nWe performed the same analysis for the shellcode located in the downloaded image file and\nthe shellcode is not exactly the same, but the design is very similar.\n\nAdditionally, we can add the victimology and usage of a public cloud platform as C2 server.\nThe attacker simply moved from Yandex, Pcloud, Mediafire, Twitter, and now they are using\nNaver. This platform is mainly used locally in South Korea. A connection to this platform\ncannot be identified as a malicious activity. The malicious traffic will be hidden in the global\nflow.\n\n\n-----\n\nDue to all these elements, we asses with medium confidence that NavRAT and this\ncampaign can be linked to Group123. The malware developer is probably a different person\nwithin Group123's working team, but the infection framework and the operating mode are the\nsame. When Talos published on Olympic Destroyer we were able to see a lot of false flags\nused. When we look at NavRAT we do not see this intentional and less vague level of\nIOC/False Flag scenarios in an attempt to infer attribution to another entity. NavRAT lacks\nthese non-obvious false flags and thus we do not believe this to be related to non Group123\nactors.\n\n## Conclusion\n\nSouth Korea is still, and always will remain, an attractive target for advanced actors. The\nregion has geopolitical interests that arise from the segregations that exist between the\nsecretive North Korea and the more open South Korea. In this campaign, the attackers used\na classical HWP document in order to download and execute a previously unknown\nmalware: NavRAT. The author used real events in order to forge the decoy document. It\nchose the U.S. - North Korea Summit to entice the targets to open it.\n\nThe approach is close to the techniques used by Group123 attacks we have observed and\nwritten about over the past 18 months or so: the shellcode contains similarities, the final\npayload is malicious shellcode located in an image hosted on a compromised website, and\nthe author uses an open platform as the C2 server. In this case, NavRAT used an email\nprovider: Naver, while ROKRAT previously used cloud providers. And finally, the victimology\nand the targeted region are the same. All these elements are not strict proof of a link\nbetween NavRAT and ROKRAT. However, we asses with medium confidence that NavRAT is\nlinked to Group123.\n\nUsing well-known local cloud/email providers is smart from an attacker's point of view. It's\nreally hard to identify the malicious traffic in the middle of the legitimate traffic. In this case,\nthe email provider locked the account due to attempts from too many different countries to\naccess the email inbox. We identified the sample on several public sandbox systems, and\nwe assume the multiple connection attempts were performed by these sandboxes.\n\n## Coverage\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection&sa=D&ust=1527796940975000)\nmalware used by these threat actors.\n\n[CWS or WSA web scanning prevents access to malicious websites and detects malware](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html&sa=D&ust=1527796940975000)\nused in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html&sa=D&ust=1527796940976000)\n\n[Network Security appliances such asNGFW,NGIPS, andMeraki MX can detect malicious](https://www.cisco.com/c/en/us/products/security/firewalls/index.html&sa=D&ust=1527796940976000)\nactivity associated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html&sa=D&ust=1527796940977000)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/&sa=D&ust=1527796940977000)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen-source Snort subscriber rule set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products&sa=D&ust=1527796940977000)\n\n## IOCs\n\nMalicious HWP: e5f191531bc1c674ea74f8885449f4d934d5f1aa7fd3aaa283fe70f9402b9574\n\nNavRAT: 4f06eaed3dd67ce31e7c8258741cf727964bd271c3590ded828ad7ba8d04ee57\n\nOnline Payload:\nhxxp://artndesign2[.]cafe24[.]com:80/skin_board/s_build_cafeblog/exp_include/img.png\n\n2016 NavRAT sample:\n\n\n-----\n\ne0257d187be69b9bee0a731437bf050d56d213b50a6fd29dd6664e7969f286ef\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-31 - NavRAT Uses US-North Korea Summit As Decoy For Attacks In South Korea.pdf"
    ],
    "report_names": [
        "2018-05-31 - NavRAT Uses US-North Korea Summit As Decoy For Attacks In South Korea.pdf"
    ],
    "threat_actors": [
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535641,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653753333,
    "ts_modification_date": 1653753333,
    "files": {
        "pdf": "https://archive.orkl.eu/0d9547c41630bf06b0f86c988b8bb5bf7f3afb54.pdf",
        "text": "https://archive.orkl.eu/0d9547c41630bf06b0f86c988b8bb5bf7f3afb54.txt",
        "img": "https://archive.orkl.eu/0d9547c41630bf06b0f86c988b8bb5bf7f3afb54.jpg"
    }
}