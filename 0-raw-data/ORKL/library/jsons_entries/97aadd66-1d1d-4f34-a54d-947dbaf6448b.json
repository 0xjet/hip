{
    "id": "97aadd66-1d1d-4f34-a54d-947dbaf6448b",
    "created_at": "2023-01-12T15:00:34.153383Z",
    "updated_at": "2025-03-27T02:10:03.20569Z",
    "deleted_at": null,
    "sha1_hash": "02135570d7f89d643669fff05051fc9d8b6bb7f6",
    "title": "2018-03-23 - The AVCrypt Ransomware Tries To Uninstall Your AV Software",
    "authors": "",
    "file_creation_date": "2022-05-26T01:22:02Z",
    "file_modification_date": "2022-05-26T01:22:02Z",
    "file_size": 667688,
    "plain_text": "# The AVCrypt Ransomware Tries To Uninstall Your AV Software\n\n**[bleepingcomputer.com/news/security/the-avcrypt-ransomware-tries-to-uninstall-your-av-software](https://www.bleepingcomputer.com/news/security/the-avcrypt-ransomware-tries-to-uninstall-your-av-software/)**\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nMarch 23, 2018\n03:51 PM\n4\n\nA new ransomware named AVCrypt has been discovered that tries to uninstall existing\nsecurity software before it encrypts a computer. Furthermore, as it removes numerous\nservices, including Windows Update, and provides no contact information, this\nransomware may be a wiper.\n\n[After analysis by MalwareHunterTeam, who discovered the ransomware, myself, and](https://twitter.com/malwrhunterteam/status/976925447043846145)\n[Michael Gillespie, it was decided to name this ransomware AVCrypt as the sample file names](https://twitter.com/demonslay335)\nare av2018.exe. The developer, though, may be naming it LOL based on some of the debug\nmessages found in the ransomware samples.\n\n**Debug Messages**\n\nRegardless of what it is called, this infection attempts to uninstall software in a way that we\nhave not seen before. These features are outlined in the sections below.\n\n### AVCrypt tries to uninstall your security software\n\nAs already stated, when AVCrypt runs it will attempt to remove installed security software\nfrom the victim's computer. It does this in two ways; by specifically targeting Windows\nDefender and Malwarebytes and by querying for installed AV software and then attempting\nto remove them.\n\n\n-----\n\nFirst AVCrypt will delete Windows services required for the proper operation of\nMalwarebytes and Windows Defender. It does this using a command like the following\nformat:\n```\ncmd.exe /C sc config \"MBAMService\" start= disabled & sc stop \"MBAMService\" & sc\ndelete \"MBAMService\";\n\n```\nIt then queries to see what AV software is registered with Windows Security Center and\nattempts to delete it via WMIC.\n```\ncmd.exe /C wmic product where ( Vendor like \"%Emsisoft%\" ) call uninstall\n/nointeractive & shutdown /a & shutdown /a & shutdown /a;\n\n```\nThe above command, though, was not able to uninstall Emsisoft in this manner. It is\nunknown if it would work with other AV software.\n\n### Wiper or In-dev Ransomware?\n\nAt this point, it is not clear whether AVCrypt is an in development ransomware or a wiper as\nthere are characteristics that can lead to either categorization.\n\nOn the wiper side, this ransomware attempts to delete a variety of Windows services when\nstarted. These services are:\n```\nMBAMService\nMBAMSwissArmy \nMBAMChameleon \nMBAMWebProtection\nMBAMFarflt\nESProtectionDriver\nMBAMProtection\nSchedule\nWPDBusEnum\nTermService\nSDRSVC\nRasMan\nPcaSvc\nMsMpSvc\nSharedAccess\nwscsvc\nsrservice\nVSS\nswprv\nWerSvc\nMpsSvc\nWinDefend\nwuauserv\n\n```\nWhile Windows will continue to function after these services are deleted, there will likely be\nissues in the proper operation of Windows.\n\n\n-----\n\nFurthermore, the ransom notes created by the ransomware do not provide any contact\ninformation. They just simply state \"lol n\".\n\nAt the same time, this infection does upload the encryption key to a remote TOR site and the\ncontents of the note could simply be a placeholder. Furthermore, when executing the\nransomware it displays a alert before it starts and there are numerous debug messages, so it\ncould very well be just an in development ransomware.\n\nMicrosoft has told BleepingComputer that they have only detected two samples of this\nransomware, with of them possibly being my computer, so they feel that this infection is\ncurrently in development. Microsoft is currently detecting it as Ransom:Win32/Pactelung.A.\n\n### Already in the wild or just a coincidence?\n\nWhile I am leaning towards this being an in development ransomware, a security\nresearcher posted on Twitter that computers at a Japanese university were recently infected\nby a ransomware that also uninstalled antivirus software.\n\n『本学工学部情報工学科のパソコン（1台）及びファイルサーバーがランサムウェアに\n感染しデータが暗号化される被害が確認されました。』\n\n本学情報工学科管理のパソコンのコンピューターウイルス感染について（中部大学）\n[https://t.co/PCbybyTlEh](https://t.co/PCbybyTlEh) [pic.twitter.com/ykw0DnT8uW](https://t.co/ykw0DnT8uW)\n\n— Autumn Good (@autumn_good_35) [March 8, 2018](https://twitter.com/autumn_good_35/status/971643053977956352?ref_src=twsrc%5Etfw)\n\nBleepingComputer has reached out to the email address listed in the email, but has not heard\nback at the time of publication.\n\n### AVCrypt Encryption Process\n\n\n-----\n\nWhen AVCrypt is executed it will sit idle for a brief period, extract an embedded TOR client,\nand connect to the bxp44w3qwwrmuupc.onion command & control server where it will\ntransmit the encryption key, timezone, and Windows version of the victim. There appears to\nbe an error in this transmission, as it appends other content from memory as part of the key.\n\nIt will then attempt to remove various security programs as described in the previous\nsections. It will then scan for files to encrypt, and when it encrypts a file, will rename it to the\n+[original_name]. For example, a file called test.jpg would be encrypted and then renamed\nto +test.jpg.\n\n**Encrypted Files**\n\nIn each folder that a file is encrypted, it will also create a ransom note\nnamed +HOW_TO_UNLOCK.txt. This ransom note does not contain any contact\ninformation or instructions as shown below.\n\n\n-----\n\n**AVCrypt Ransom Note**\n\nWhile running it will also add and delete a variety of registry values in order to reduce the\nsecurity of the computer.\n\nThe added registry values include:\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Associations\\LowRiskFileTypes\n.cmd;.exe;.bat;\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows %AppData%\\\n[username].exe\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAHealth 1\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\\Windows\nC:\\Users\\User\\AppData\\Roaming\\User.exe\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableSmartScreen 0\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard\\RequirePlatformSecurityFeatures\n0\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard\\LsaCfgFlags 0\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard\\HVCIMATRequired 0\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard\\HypervisorEnforcedCodeIntegrity\n0\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard\\EnableVirtualizationBasedSecurity\n     0\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware 1\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time\nProtection\\DisableRealtimeMonitoring 1\n\n```\nSome of the changed values include:\n\n\n-----\n\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden 0  (old\nvalue=\"1\")\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowInfoTip \"0\"\n(old value=\"1\")\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowSuperHidden\n\"0\" (old value=\"1\")\nHKLM\\SOFTWARE\\Microsoft\\Security Center\\cval \"0\" (old value=\"1\")\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA \"0\"\n(old value=\"1\")\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableVirtualization\n\"0\" (old value=\"1\")\n\n```\nWhen done, it will execute a batch file named +.bat that performs a cleanup of any dropped\nfiles, clears event logs, terminates the ransomware process, and removes the autorun entry.\n\n**Contents of Batch File**\n\nAs you can see, this ransomware is quite destructive to an infected computer, yet at the same\ntime does appear to upload the encryption key to a remote server. Therefore, it is not known\nwhether this is a true ransomware or a wiper disguised as one.\n\n### Related Articles:\n\n[Beware: Onyx ransomware destroys files instead of encrypting them](https://www.bleepingcomputer.com/news/security/beware-onyx-ransomware-destroys-files-instead-of-encrypting-them/)\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n\n-----\n\n[SpiceJet airline passengers stranded after ransomware attack](https://www.bleepingcomputer.com/news/security/spicejet-airline-passengers-stranded-after-ransomware-attack/)\n\n[US Senate: Govt’s ransomware fight hindered by limited reporting](https://www.bleepingcomputer.com/news/security/us-senate-govt-s-ransomware-fight-hindered-by-limited-reporting/)\n\n[New RansomHouse group sets up extortion market, adds first victims](https://www.bleepingcomputer.com/news/security/new-ransomhouse-group-sets-up-extortion-market-adds-first-victims/)\n\n## IOCs\n\n### Hashes:\n```\na64dd2f21a42713131f555bea9d0a76918342d696ef6731608a9dbc57b79b32f\n58c7c883785ad27434ca8c9fc20b02885c9c24e884d7f6f1c0cc2908a3e111f2\n\n Network Connections:\nbxp44w3qwwrmuupc.onion\n\n Associated Files:\n+HOW_TO_UNLOCK.txt\n%AppData%\\[username].exe\n%Temp%\\libeay32.dll\n%Temp%\\libevent-2-0-5.dll\n%Temp%\\libevent_core-2-0-5.dll\n%Temp%\\libevent_extra-2-0-5.dll\n%Temp%\\libgcc_s_sjlj-1.dll\n%Temp%\\libgmp-10.dll\n%Temp%\\libssp-0.dll\n%Temp%\\ssleay32.dll\n%Temp%\\t.bmp\n%Temp%\\t.zip\n%Temp%\\tor.exe\n%Temp%\\zlib1.dll\n\n Ransom Note Text:\nlol n\n\n```\nAD\n\n[AVCrypt](https://www.bleepingcomputer.com/tag/avcrypt/)\n[LOL](https://www.bleepingcomputer.com/tag/lol/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[Wiper](https://www.bleepingcomputer.com/tag/wiper/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\n\n\n-----\n\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/firefox-to-get-an-ad-filtering-system/)\n[Next Article](https://www.bleepingcomputer.com/news/security/rapid-20-ransomware-released-will-not-encrypt-data-on-pcs-with-russian-locale/)\n\n### Comments\n\n[theshiv - 4 years ago](https://www.bleepingcomputer.com/forums/u/1051543/theshiv/)\n\nTo be fair, if you're using an AV that can be removed with those commands, you should\nprobably switch anyways.\n\n[hitler67 - 4 years ago](https://www.bleepingcomputer.com/forums/u/1089730/hitler67/)\n\nHail hell. HOW OUR SAMPLE GOT LEAKED IN FIRST PLACE ?HOW? WE HAD IT\nFOR PRESENTATION LIKE DEFCON ARENA. IT WONT BE USED FOR ILLEGAL\nPURPOSES.BUT POSTING DETAILED ANALYSIS COULD BE USED TO REPLICATE\nBY BAD ACTORS OUT IN WILD.\n\nANSWER\n\nHOW IN FIRST PLACE BINARY GOT LEAKED WHEN WE NEVER SENT TO\nANYONE EXCEPT OLD PROGRAMMING GUYS ON FORUM THAT ARE VERY\nTRUSTED IN FIRST PLACE?\n\nHOW YOU STOLE SAMPLE ? ISNT IT OFFENSIVE ? HOW ?\n\n\n-----\n\n[GT500 - 4 years ago](https://www.bleepingcomputer.com/forums/u/377072/gt500/)\n\nThe same way pretty much all in-dev/unreleased ransomware gets discovered.\n\nIf you really are a researcher/analyst, then you should already know what I'm talking\nabout. If not, then you may want to hold off on your DefCon presentation. ;)\n\n[JakeFrom98 - 4 years ago](https://www.bleepingcomputer.com/forums/u/1090256/jakefrom98/)\n\nI gotta say I'm very impressed with your article it really goes in depth with this\nRansomware I'm a Network Security student and I love reading about this stuff.\n\n[Post a Comment Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-23 - The AVCrypt Ransomware Tries To Uninstall Your AV Software.pdf"
    ],
    "report_names": [
        "2018-03-23 - The AVCrypt Ransomware Tries To Uninstall Your AV Software.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "921cea27-4410-42e4-8c11-7d40ba313225",
            "created_at": "2023-01-06T13:46:39.375789Z",
            "updated_at": "2025-03-27T02:00:03.067286Z",
            "deleted_at": null,
            "main_name": "RansomHouse",
            "aliases": [],
            "source_name": "MISPGALAXY:RansomHouse",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535634,
    "ts_updated_at": 1743041403,
    "ts_creation_date": 1653528122,
    "ts_modification_date": 1653528122,
    "files": {
        "pdf": "https://archive.orkl.eu/02135570d7f89d643669fff05051fc9d8b6bb7f6.pdf",
        "text": "https://archive.orkl.eu/02135570d7f89d643669fff05051fc9d8b6bb7f6.txt",
        "img": "https://archive.orkl.eu/02135570d7f89d643669fff05051fc9d8b6bb7f6.jpg"
    }
}