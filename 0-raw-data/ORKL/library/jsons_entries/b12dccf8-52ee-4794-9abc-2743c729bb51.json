{
    "id": "b12dccf8-52ee-4794-9abc-2743c729bb51",
    "created_at": "2022-10-25T16:48:20.553008Z",
    "updated_at": "2025-03-27T02:09:43.021766Z",
    "deleted_at": null,
    "sha1_hash": "5556914b528d995e2a4474c768c4d0012c947587",
    "title": "Revoke Obfuscation Report",
    "authors": "",
    "file_creation_date": "2017-07-27T11:43:09Z",
    "file_modification_date": "2017-07-27T11:43:12Z",
    "file_size": 3295426,
    "plain_text": "# Revoke-­‐Obfuscation: PowerShell  Obfuscation Detection Using Science \n\nDaniel \r Bohannon \r @danielhbohannon \r | \r Lee \r Holmes \r @Lee_Holmes\n\n_Revoke-­‐Obfuscation \r is \r the \r result \r of \r industry \r research \r collaboration \r between \r Daniel \r Bohannon \r -­‐ \r Senior_\n_[Applied \r Security \r Researcher \r at \r Mandiant/FireEye, \r and \r Lee \r Holmes \r – \r Lead \r Security \r Architect \r of \r Azure](https://www.fireeye.com/)_\n_[Management \r at \r Microsoft.](https://azure.microsoft.com/)_\n\n## Background \n\nBy \r far \r the \r most \r prevalent \r delivery \r and \r execution \r vehicle \r for \r malware \r in \r the \r industry \r today \r is \r basic\nmalicious \r executables \r and \r malicious \r documents. \r While \r not \r represented \r accurately \r by \r its \r popularity \r in\nthe \r news, \r a \r small \r portion \r of \r the \r current \r malware \r ecosystem \r leverages \r PowerShell \r as \r part \r of \r its \r attack\nchain. \r Of \r malware \r that \r uses \r PowerShell, \r the \r most \r prevalent \r use \r is \r the \r garden-­‐variety \r stager: \r an\nexecutable \r or \r document \r macro \r that \r launches \r PowerShell \r to \r download \r another \r executable \r and \r run \r it.\n\nDespite \r its \r relative \r statistical \r rarity, \r development \r of \r malicious \r and \r offense-­‐focused \r PowerShell\ntechniques \r has \r been \r a \r rich \r field \r of \r innovation. \r Commercial \r products \r have \r started \r to \r react \r to \r these\ntechniques \r in \r several \r ways. \r Because \r they \r are \r often \r delivered \r as \r script \r files, \r Antivirus \r vendors \r have \r long\nhad \r the \r ability \r to \r write \r signatures \r that \r block \r malicious \r PowerShell \r scripts. \r With \r the \r release \r of \r Windows\n10, \r some \r vendors \r have \r additionally \r begun \r to \r implement \r support \r for \r Windows’ [Antimalware Scan](https://blogs.technet.microsoft.com/mmpc/2015/06/09/windows-10-to-offer-application-developers-new-malware-defenses/)\n[Interface. \r This \r interface \r gives \r Antivirus \r vendors \r the \r ability \r to \r implement \r deep \r content \r scanning,](https://blogs.technet.microsoft.com/mmpc/2015/06/09/windows-10-to-offer-application-developers-new-malware-defenses/)\nproviding \r visibility \r as \r each \r stage \r of \r malware \r fetches \r and \r dynamically \r executes \r new \r instructions \r from \r a\nremote \r network \r location.\n\nIn \r addition \r to \r antivirus \r signatures, \r many \r SIEM \r vendors \r have \r started \r to \r implement \r alerting \r based \r on\ncommand-­‐line \r parameters \r that \r are \r frequently \r used \r in \r malicious \r contexts. \r Palo \r Alto \r provides \r an\n[excellent \r survey \r of \r commonly-­‐used \r malicious \r PowerShell \r command-­‐line \r arguments \r in \r their \r post, \r Pulling](https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/)\n[Back the Curtains on EncodedCommand PowerShell Attacks.](https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/)\n\nAs \r with \r any \r ecosystem, \r parts \r of \r the \r malicious \r and \r offense-­‐focused \r community \r have \r started \r to \r adapt\ntheir \r tooling \r to \r avoid \r signature-­‐based \r detections. \r Part \r of \r this \r response \r has \r come \r through \r an \r increased\nuse \r of \r content \r obfuscation \r – \r a \r technique \r long \r employed \r at \r both \r the \r binary \r and \r content \r level \r by\ntraditional \r malware \r authors.\n\n### In the Wild: FIN8 \nOne \r example \r of \r threat \r actors \r using \r obfuscation \r techniques \r in \r the \r wild \r is \r FIN8, \r a \r financially-­‐motivated\ntargeted \r attacker. \r They \r use \r a \r handful \r of \r techniques \r to \r avoid \r traditional \r static \r detection.\n\n\n-----\n\n[Mandiant \r provides \r an \r excellent \r overview \r of \r FIN8’s \r use \r of \r obfuscation \r in \r their \r post, \r Obfuscation in the](https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html)\n[Wild: Targeted Attackers Lead the Way in Evasion Techniques.](https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html)\n\n### Before You Begin \nDetecting \r obfuscated \r PowerShell \r requires \r that \r you \r have \r set \r up \r your \r environment \r to \r collect \r and \r process\nPowerShell \r logs. \r The \r three \r primary \r steps \r you \r should \r take \r are:\n\n1) **[Process \r Auditing \r and \r Command \r Line \r Logging. \r Event ID 4688](https://technet.microsoft.com/en-us/library/dn535776.aspx)** on \r Windows \r gives \r you \r access \r to\n\nthe \r command-­‐line \r arguments \r used \r when \r processes \r are \r launched, \r such \r as \r the \r –\nEncodedCommand \r argument \r to \r PowerShell.exe. \r The \r OS \r capabilities \r required \r to \r support \r this\n[feature \r were \r added \r to \r Windows \r 8.1 \r and \r Windows \r 2012r2, \r but \r can \r also \r be \r added \r by \r installing](https://support.microsoft.com/en-us/help/3004375/microsoft-security-advisory-update-to-improve-windows-command-line-aud)\n[KB3004375. \r Another \r useful \r source \r of \r this \r data \r is](https://support.microsoft.com/en-us/help/3004375/microsoft-security-advisory-update-to-improve-windows-command-line-aud) [Sysmon.](https://technet.microsoft.com/en-us/sysinternals/sysmon)\n2) **PowerShell \r Module, \r Script \r Block, \r and \r Transcription \r Logging. \r You \r can \r configure \r PowerShell \r to**\n\nlog \r all \r commands \r that \r it \r invokes, \r as \r well \r all \r script \r blocks \r that \r it \r invokes. \r As \r with \r the \r content\nstream \r exposed \r to \r the \r Antimalware \r Scan \r Interface, \r this \r logging \r also \r includes \r code \r generated \r or\ntransformed \r at \r runtime. \r You \r can \r learn \r more \r about \r PowerShell’s \r logging \r capabilities \r from \r the\n[PowerShell \r Blog, \r PowerShell � the Blue Team.](https://blogs.msdn.microsoft.com/powershell/2015/06/09/powershell-the-blue-team/)\n3) **Centralized \r Event \r Log \r Collection \r / \r Forwarding. \r There \r are \r many \r techniques \r to \r collect \r and**\n\nforward \r event \r logs \r across \r an \r organization. \r An \r excellent \r introduction, \r using \r Windows \r Event\nForwarding, \r can \r be \r found \r at: \r Monitoring what matters -­‐ [Windows Event Forwarding for](https://blogs.technet.microsoft.com/jepayne/2015/11/23/monitoring-what-matters-windows-event-forwarding-for-everyone-even-if-you-already-have-a-siem/)\n[everyone (even if you already \r have a SIEM).](https://blogs.technet.microsoft.com/jepayne/2015/11/23/monitoring-what-matters-windows-event-forwarding-for-everyone-even-if-you-already-have-a-siem/)\n\nMost \r detection \r that \r attempts \r to \r uncover \r malicious \r use \r of \r PowerShell \r does \r so \r today \r by \r taking \r these \r two\nmajor \r event \r sources \r and \r applying \r static \r signatures \r to \r them. \r This \r is \r usually \r simple \r string \r matches \r and\nregular \r expressions.\n\n## Invoke-­‐Obfuscation: A Treatise on the Folly of Static Signatures \n\nThe \r most \r common \r focus \r for \r the \r detection \r of \r malicious \r PowerShell \r is \r the \r initial \r download \r cradle. \r One\nexample \r of \r this \r could \r be \r script \r in \r a \r malicious \r Office \r document \r that \r runs \r PowerShell \r to \r download \r and\nlaunch \r additional \r malware \r components.\n\n\n-----\n\nMany \r have \r written \r regular \r expressions \r to \r try \r to \r detect \r these, \r but \r there \r are \r challenges \r with \r this\napproach.\n\n### Launch Techniques \nSome \r organizations \r and \r SIEM \r vendors \r rely \r entirely \r on \r command-­‐line \r logging \r (4688) \r event \r rather \r than\nPowerShell \r script \r block \r logs \r (4104) \r to \r detect \r malicious \r PowerShell. \r If \r the \r process \r name \r is \r “PowerShell”\nand \r the \r command-­‐line \r arguments \r match \r some \r specific \r patterns, \r they \r flag \r that \r input \r as \r malicious.\n\nThere \r are \r two \r main \r ways \r that \r attackers \r can \r avoid \r this \r form \r of \r 4688-­‐based \r command \r line \r logging:\nobscuring \r the \r name \r of \r the \r PowerShell \r executable, \r and \r breaking \r the \r link \r between \r PowerShell \r and \r the\ncode \r it \r invoked \r as \r viewed \r from \r the \r command \r line \r logs.\n\nTo \r obscure \r the \r name \r of \r the \r PowerShell \r executable, \r some \r attackers \r will \r create \r (or \r include) \r a \r copy \r of\nPowerShell.exe, \r but \r rename \r it \r to \r something \r less \r suspicious \r – \r such \r as \r Firefox.exe, \r or \r Chrome.exe. \r The\n4688 \r command \r line \r logs, \r then, \r would \r show \r something \r similar \r to:\n\nAfter \r obscuring \r the \r name \r of \r the \r launching \r executable, \r the \r second \r primary \r mechanism \r to \r break \r 4688-­‐\nbased \r logging \r is \r to \r unlink \r the \r command-­‐line \r arguments \r from \r the \r code \r they \r deliver. \r An \r example \r of \r this\ncomes \r from \r PowerShell’s \r (like \r most \r management \r / \r automation \r programs) \r ability \r to \r consume \r commands\nfrom \r the \r Standard \r Input \r stream.\n\nTwo \r examples \r of \r this \r are:\n\n\n-----\n\nWhen \r viewed \r in \r the \r event \r log, \r the \r arguments \r to \r PowerShell.exe \r are \r no \r longer \r directly \r visible:\n\nFor \r some \r of \r these \r launch \r techniques, \r reviewing \r the \r command \r line \r arguments \r of \r the \r parent \r process \r can\nbe \r fruitful:\n\nHowever, \r when \r this \r technique \r is \r chained \r several \r times, \r you \r must \r correlate \r several \r layers \r of \r process\ncommand \r lines \r to \r understand \r the \r code \r that \r was \r invoked.\n\nAnother \r technique, \r employed \r by \r the \r Kovter \r family \r of \r malware \r and \r others, \r is \r to \r store \r the \r malicious\nPowerShell \r commands \r in \r an \r environment \r variable \r and \r have \r PowerShell \r execute \r the \r content \r of \r that\n[variable. \r Malwarebytes \r Labs \r gives \r an \r example \r of \r this \r approach \r in \r their \r post, \r Untangling Kovter.](https://blog.malwarebytes.com/threat-analysis/2016/07/untangling-kovter/)\n\nThe \r content \r of \r the \r variable \r is \r a \r base64 \r encoded \r PowerShell \r script:\n\n\n-----\n\nIn \r addition \r to \r storing \r content \r in \r environment \r variables, \r it \r is \r also \r possible \r to \r deliver \r content \r so \r that\nreassembling \r the \r command \r lines \r from \r the \r chain \r of \r parent \r processes \r offers \r little \r to \r no \r insight. \r For\nexample, \r one \r process \r could \r write \r a \r file \r while \r a \r second \r process \r – \r launched \r as \r a \r sibling \r process \r – \r reads\nfrom \r it.\n\nWhile \r these \r launch \r techniques \r do \r not \r evade \r PowerShell \r script \r block \r logging, \r they \r are \r challenging\nbehaviours \r to \r detect \r through \r command-­‐line \r logging \r alone.\n\n### Obfuscating the Cradle \nIn \r addition \r to \r evasions \r of \r process \r command \r line \r logging, \r obfuscation \r of \r the \r PowerShell \r script \r text \r itself\ncan \r prove \r very \r effective \r against \r static \r signature-­‐based \r detections. \r This \r is \r a \r common \r battle \r ground\nbetween \r malware \r authors \r and \r antivirus \r vendors \r for \r all \r scripting \r languages, \r and \r this \r battle \r continues\nwhen \r applied \r to \r PowerShell \r scripts.\n\nFor \r the \r purposes \r of \r discussion, \r we \r will \r focus \r on \r an \r example \r download \r cradle \r as \r well \r as \r the \r static\nsignatures \r that \r might \r be \r used \r to \r detect \r it.\n\nAn \r initial \r detection \r approach \r might \r attempt \r to \r match \r all \r of \r the \r following \r terms:\n\n-­‐ `Invoke-Expression`\n-­‐ `New-Object`\n-­‐ `System.Net.WebClient`\n-­‐ `DownloadString(‘http`\n\nMost \r of \r the \r obfuscation \r techniques \r that \r follow \r are \r automatically \r countered \r by \r PowerShell’s \r script \r block\nand \r module \r logging, \r as \r well \r as \r the \r Antimalware \r Scan \r Interface. \r However, \r they \r are \r very \r effective \r when\napplied \r to \r content \r in \r transit \r – \r such \r as \r intercepted \r network \r requests, \r or \r files \r on \r disk.\n\n-­‐ The \r URL \r is \r just \r a \r string, \r so \r can \r be \r concatenated \r and \r written \r in \r other \r ways \r such \r as \r “h” +\n```\n   “ttp”. \r Additional \r string \r obfuscation \r techniques \r are \r covered \r below. \r \n\n```\n-­‐ `System \r is \r optional \r in \r PowerShell \r type \r names, \r so \r System.Net.WebClient \r can \r be \r written \r as`\n```\n   Net.WebClient\n\n```\n-­‐ PowerShell \r can \r use \r either \r single \r or \r double \r quotes \r in \r strings. \r Whitespace \r can \r be \r added \r almost\nanywhere, \r so \r DownloadString(‘ \r could \r just \r as \r easily \r be \r written \r as \r DownloadString( “\n\n\n-----\n\n-­‐ The \r WebClient \r class \r offers \r many \r methods \r to \r download \r content \r in \r addition \r to \r DownloadString,\nsuch \r as \r DownloadFile, \r DownloadData, \r and \r OpenReadAsync\n-­‐ Method \r names \r such \r as \r DownloadString \r can \r be \r included \r in \r quotes \r and \r have \r escape \r characters\nincluded \r to \r create \r a \r syntax \r like\n```\n   System.Net.WebClient).”`D`o`wn`l`oa`d`Str`in`g”. \r Because \r it \r can \r be \r treated \r \n\n```\nas \r a \r string, \r string-­‐based \r obfuscation \r techniques \r such \r as \r concatenation \r and \r reordering \r can \r also\nbe \r used \r on \r the \r method \r name.\n-­‐ Similar \r to \r method \r names, \r the \r Net.WebClient \r argument \r to \r New-­‐Object \r can \r be \r obfuscated\nwith \r escape \r characters, \r string-­‐based \r obfuscation \r techniques, \r and \r concatenation \r across \r multiple\nvariables. \r That \r can \r produce \r a \r result \r like: \r $var1=\"`N`et.\";\n```\n   $var2=\"`W`eb`C`l`ient\"; (New-Object $var1$var2)\n\n```\n-­‐ PowerShell \r command \r names \r often \r have \r aliases. \r For \r example, \r Invoke-­‐Expression \r can \r also \r be\nreferred \r to \r as \r iex.\n-­‐ Even \r when \r commands \r do \r not \r have \r aliases, \r the \r Get-Command \r command \r lets \r a \r script \r author\nquery \r the \r PowerShell \r command \r list \r and \r invoke \r the \r result. \r This \r query \r can \r include \r wildcards, \r so\ninvoking \r New-­‐Object \r can \r look \r like \r this: \r & (Get-Command *w-O*). \r The \r invocation \r (&)\noperator \r in \r this \r example \r has \r an \r alternative, \r which \r is \r the \r dot \r (.) \r operator. \r The \r Get-­‐Command\ncmdlet \r has \r an \r alias \r and \r can \r be \r dynamically \r invoked \r similarly, \r so \r is \r not \r safe \r to \r key \r on.\n-­‐ In \r addition \r to \r Get-­‐Command \r as \r a \r mechanism \r to \r query \r command \r names, \r PowerShell \r offers\nseveral \r API-­‐style \r methods \r to \r query \r command \r names \r – \r such \r as\n```\n   $executionContext.InvokeCommand.GetCommand(). \r \n\n```\n-­‐ The \r invocation \r (& \r and \r .) \r operators \r support \r string \r arguments. \r These \r can \r be \r easily \r obscured\nusing \r obfuscation \r techniques \r such \r as \r string \r concatenation \r and \r string \r reordering.\n-­‐ Detection \r of \r Invoke-­‐Expression \r suffers \r from \r the \r same \r challenges \r of \r command \r obfuscation \r that\nNew-­‐Object \r and \r Get-­‐Command \r suffer \r from. \r It \r is \r also \r popular \r in \r non-­‐malicious \r contexts, \r making\nfalse \r positives \r based \r on \r this \r indicator \r a \r significant \r challenge.\n-­‐ Invoke-­‐Expression \r is \r not \r the \r only \r cmdlet \r or \r technique \r that \r can \r be \r used \r to \r invoke \r dynamically-­‐\ngenerated \r code. \r Other \r alternatives \r are \r Invoke-Command, \r Script \r Block \r invocation \r (such \r as \r  \r &\n```\n   [Scriptblock]::Create(\"Write-Host Script Block Conversion\") \r ), \r and \r \n\n```\ndynamic \r script \r invocation \r APIs \r such \r as\n```\n   $ExecutionContext.InvokeCommand.InvokeScript(\"Write-Host\n   EXPRESSION\"). \r \n\n#### String Obfuscation \n```\nAnything \r that \r allows \r a \r string \r as \r an \r argument \r can \r be \r obfuscated \r using \r string \r obfuscation \r techniques.\n\n-­‐ String \r concatenation \r is \r a \r common \r way \r to \r break \r up \r identifiable \r strings. \r If \r a \r signature \r is \r written\nfor \r the \r term, \r “http”, \r it \r can \r also \r be \r written \r as \r “h” + “ttp”. \r The \r most \r common \r form \r of\nconcatenation \r is \r the \r ‘+’ \r operator, \r but \r PowerShell’s \r –join \r operator \r can \r also \r be \r used. \r In\naddition \r to \r PowerShell \r techniques, \r the \r String.Join() \r and \r String.Concat() \r methods\nfrom \r .NET \r can \r accomplish \r the \r same \r goals.\n-­‐ PowerShell’s \r –f \r string \r formatting \r operator, \r based \r on \r the \r C# \r String.Format \r method, \r can\ncreate \r strings \r at \r runtime. \r The \r format \r operator \r uses \r format \r tokens \r like \r {0} \r and \r {1} \r to \r identify\nthe \r order \r of \r replacement \r strings, \r so \r obfuscating \r the \r invocation \r of \r New-­‐Object \r might \r look \r like\n\n\n-----\n\nthis \r with \r format \r operator \r obfuscation \r applied: \r & (\"{1}{0}{2}\" -f 'w```\n   Ob','Ne','ject'). \r \n\n```\n-­‐ Strings \r can \r be \r reversed \r through \r several \r mechanisms, \r such \r as \r PowerShell’s \r array \r slicing \r operator\n(-join \"detacsufbO\"[9..0]), \r  \r Array.Reverse \r ($a = [char[]]\"detacsufbO\";\n```\n   [Array]::Reverse($a); -join $a), \r reverse \r regular \r expression \r matching \r (-join\n   [RegEx]::Matches(\"detacsufbO\",'.','RightToLeft')), \r and \r others. \r \n\n```\n-­‐ Strings \r can \r be \r split \r by \r an \r arbitrary \r delimiter, \r and \r then \r rejoined: \r -join\n```\n   (\"Obf~~usc~~ated\" -split \"~~\")\n\n```\n-­‐ Through \r the \r –replace \r operator \r or \r the \r String.Replace() \r method, \r strings \r can \r be\nreplaced \r either \r to \r remove \r delimiters, \r or \r change \r the \r meaning \r of \r a \r string:\n```\n   \"System.SafeClass\" -replace \"Safe\",\"Unsafe\"\n\n```\nWhile \r this \r depth \r of \r obfuscation \r may \r seem \r unlikely \r in \r reality, \r several \r automated \r toolkits \r exist \r today \r that\n[can \r apply \r these \r techniques \r automatically. \r Two \r examples \r of \r this \r are \r ISE Steroids \r and \r Invoke-­‐Obfuscation.](http://www.powertheshell.com/isesteroids/)\nEach \r will \r take \r any \r PowerShell \r content \r and \r return \r an \r obfuscated \r version \r of \r that \r content. \r For \r example,\nthe \r automated \r obfuscation \r of \r the \r example \r download \r cradle \r above \r can \r generate \r the \r following \r result,\namong \r many \r possible \r options:\n\nThe \r output \r of \r both \r toolkits \r have \r been \r observed \r in \r obfuscated \r malware \r in \r the \r wild.\n\n#### Changing the Cradle \nUp \r to \r this \r point, \r we’ve \r discussed \r the \r many \r ways \r to \r obfuscate \r a \r simple, \r static, \r well-­‐known \r download\ncradle. \r As \r touched \r on \r in \r the \r discussion \r of \r detecting \r the \r DownloadString() \r method, \r there \r are \r an\nenormous \r number \r of \r alternate \r ways \r to \r accomplish \r the \r goal \r of \r downloading \r and \r executing \r code.\n\n[A \r sister \r project \r to \r Invoke-­‐Obfuscation, \r Invoke-­‐CradleCrafter \r automates \r the \r generation \r of \r obscure \r or](https://github.com/danielbohannon/Invoke-CradleCrafter)\nesoteric \r download \r cradles. \r Here \r is \r one \r example:\n\n\n-----\n\nAs \r mentioned \r earlier, \r PowerShell \r module \r and \r script \r block \r logging \r unravels \r most \r of \r these \r obfuscation\ntechniques. \r Here’s \r an \r example \r of \r obfuscation \r that \r goes \r through \r three \r stages \r of \r de-­‐obfuscation \r while\nrunning:\n\nHowever, \r the \r range \r of \r obfuscation \r opportunities \r available \r to \r attackers \r paints \r a \r very \r bleak \r picture \r when\nit \r comes \r to \r detecting \r malicious \r PowerShell.\n\n## Detecting Obfuscated PowerShell \nWhile \r the \r situation \r may \r appear \r dire \r when \r it \r comes \r to \r detecting \r malicious \r PowerShell \r due \r to \r the \r vast\nrange \r of \r obfuscation \r opportunities, \r in \r fact \r the \r opposite \r is \r true. \r This \r very \r mix \r of \r obfuscation-­‐fueled\nobscurity \r is \r an \r incredibly \r strong \r signal \r that \r we \r can \r use \r to \r convert \r this \r cloak \r of \r invisibility \r into \r a \r blazing\nbeacon \r of \r detection.\n\nThe \r crucial \r insight \r is \r that \r obfuscated \r code \r looks \r nothing \r like \r regular \r code. \r Nobody \r looking \r at \r code \r like\nthis \r would \r consider \r it \r normal:\n\n\n-----\n\nSo \r rather \r than \r (or \r in \r addition \r to) \r detecting \r known \r signatures, \r we \r must \r enrich \r our \r detection \r capabilities\nby \r post-­‐processing \r Script \r Block \r and \r command-­‐line \r logs \r to \r look \r for \r signs \r of \r obfuscation. \r If \r we \r find\nobfuscated \r PowerShell, \r then \r we \r can \r kick \r off \r a \r secondary \r investigation \r to \r determine \r its \r purpose \r and\nintent.\n\n### Character Frequency Analysis \nOne \r of \r the \r first \r pieces \r of \r insight \r we \r can \r take \r action \r on \r is \r based \r on \r character \r frequency. \r For \r example,\nthe \r canonical \r obfuscation \r built \r into \r the \r Metasploit \r Framework \r uses \r random \r characters \r for \r all \r variable\nand \r function \r names.\n\nIf \r we \r analyze \r the \r entropy \r and \r letter \r frequency \r distribution \r of \r the \r variable \r names \r as \r done \r in \r the \r blog\npost, [Detecting Obfuscated PowerShell, \r we \r can \r see \r that \r we \r can \r get \r some \r pretty \r strong \r signals \r from \r this](https://www.leeholmes.com/blog/2015/11/13/detecting-obfuscated-powershell/)\napproach.\n\n\n-----\n\nThe \r MSF-­‐based \r stager \r had \r the \r most \r randomness \r in \r its \r variable \r names, \r and \r only \r 24% \r of \r the \r script \r came\nfrom \r the \r top \r four \r letters. \r For \r the \r “normal” \r scripts \r in \r that \r small-­‐scale \r experiment, \r the \r top \r four \r letters\naccounted \r for \r 35% \r or \r more \r of \r the \r script.\n\n#### Cosine Similarity \nWe \r can \r take \r this \r character \r frequency \r approach \r even \r further. \r This \r approach \r is \r explained \r in \r the \r blog \r post,\n[More Detecting Obfuscated PowerShell. \r Rather \r than \r analyze \r the \r frequency \r of \r the \r top \r four \r letters, \r we](http://www.leeholmes.com/blog/2016/10/22/more-detecting-obfuscated-powershell/)\ncan \r analyze \r the \r frequency \r of \r each \r letter \r in \r a \r script. \r For \r example, \r here \r is \r an \r example \r of \r the \r average\ncharacter \r frequency \r as \r computed \r from \r all \r of \r PoshCode.org, \r a \r popular \r script \r sharing \r platform:\n\n\n-----\n\nWhen \r we \r compare \r that \r to \r the \r character \r frequency \r of \r some \r obfuscated \r samples, \r there \r is \r clearly \r a\nsignificant \r difference:\n\nOne \r approach \r used \r frequently \r in \r the \r information \r retrieval \r community \r to \r rank \r and \r compare \r lists \r of\nnumbers \r is \r called \r Cosine \r or \r Vector \r similarity. \r Rather \r than \r lists \r of \r character \r frequencies, \r the \r information\nretrieval \r community \r instead \r often \r creates \r lists \r – \r called \r Feature \r Vectors \r – \r based \r on \r other \r items \r of\ninterest. \r For \r example, \r the \r number \r of \r occurrences \r of \r certain \r words, \r paragraph \r lengths, \r number \r of\ninternal \r links, \r number \r of \r external \r links \r and \r more.\n\nCosine \r similarity \r builds \r on \r the \r same \r math \r that \r we \r use \r to \r measure \r the \r angle \r between \r two \r lines \r in\n[geometry. \r As \r described \r on \r Wikipedia’s \r Cosine Similarity \r article:](https://en.wikipedia.org/wiki/Cosine_similarity)\n\n\n-----\n\nThe \r information \r retrieval \r community \r extends \r this \r concept \r past \r two \r or \r three \r numbers \r (representing \r the\ntwo \r or \r three \r coordinate \r representation \r of \r a \r typical \r line) \r to \r hundreds \r or \r even \r thousands \r of \r elements.\nWe \r can \r apply \r exactly \r this \r technique \r on \r a \r feature \r vector \r represented \r by \r character \r frequencies.\n\nWhen \r we \r mix \r in \r two \r of \r our \r obfuscation \r samples \r with \r a \r random \r selection \r of \r 20 \r other \r scripts \r from\nPoshCode, \r the \r lack \r of \r similarity \r with \r the \r average \r character \r distribution \r really \r becomes \r obvious.\n\nWhen \r we \r graph \r the \r similarity \r all \r of \r the \r scripts \r in \r PoshCode \r against \r its \r average \r character \r frequency, \r we\ncan \r see \r a \r clear \r clustering \r that \r we \r should \r be \r able \r to \r use \r to \r trigger \r further \r investigation.\n\n\n-----\n\nIn \r ad-­‐hoc \r experimentation, \r a \r similarity \r score \r lower \r than \r 0.8 \r can \r provide \r a \r good \r starting \r score \r for \r further\ninvestigation. \r However, \r this \r sample \r size \r was \r limited \r – \r and \r a \r rigorous \r evaluation \r of \r this \r approach \r was\nnot \r possible \r without \r further \r data.\n\n### Building the PowerShell Corpus \nTwo \r major \r areas \r of \r weakness \r with \r the \r initial \r Cosine \r Similarity \r investigation \r were:\n\n1) **Lack \r of \r variety. \r Scripts \r shared \r in \r PoshCode \r have \r some \r degree \r of \r variety, \r but \r don’t \r represent \r the**\n\nfull \r breadth \r of \r author \r experiences \r and \r scenarios \r in \r the \r PowerShell \r ecosystem. \r PoshCode\nactively \r encourages \r copying, \r modifying, \r and \r re-­‐sharing \r existing \r scripts, \r so \r there \r were \r many\nexamples \r that \r were \r redundant \r with \r respect \r to \r other \r scripts.\n2) **Lack \r of \r labeled \r data. \r Without \r an \r exhaustive \r labeling \r of \r which \r scripts \r were \r in \r fact \r obfuscated \r vs.**\n\nwhich \r were \r not, \r the \r accuracy \r of \r Cosine \r Similarity \r cannot \r be \r measured. \r Despite \r having \r a\nreasonable \r number \r of \r false \r positives \r when \r all \r of \r the \r items \r below \r a \r similarity \r value \r of \r 0.8 \r were\nreviewed, \r it \r was \r not \r possible \r to \r measure \r how \r many \r obfuscated \r scripts \r were \r missed \r by \r having \r a\nsimilarity \r score \r greater \r than \r 0.8.\n\nTo \r build \r a \r much \r more \r robust \r and \r representative \r PowerShell \r Corpus, \r we \r downloaded \r approximately\n408,000 \r PowerShell \r scripts \r and \r modules:\n\n-­‐ All \r GitHub \r projects \r detected \r as \r having \r the \r ‘PowerShell’ \r language \r (383.7k \r files)\n-­‐ All \r PowerShell \r Gallery \r modules \r (17.5k \r files)\n-­‐ All \r PoshCode \r scripts \r (3.4k \r files)\n-­‐ A \r large \r selection \r of \r GitHub \r gists \r detected \r as \r having \r the \r ‘PowerShell’ \r language \r (1.7k \r files)\n-­‐ All \r Technet \r scripts \r (1.5k \r files)\n\nTo \r create \r a \r set \r of \r labeled \r data, \r we:\n\n-­‐ Manually \r reviewed \r approximately \r 7,000 \r scripts \r from \r this \r corpus\n-­‐ Incorporated \r 383 \r submissions \r from \r the [Underhanded PowerShell Contest](https://blogs.msdn.microsoft.com/powershell/2016/03/07/announcing-the-underhanded-powershell-contest/)\n\n\n-----\n\n-­‐ Generated \r 3,200 \r scripts \r by \r having \r Invoke-­‐Obfuscation \r apply \r random \r amounts \r of \r obfuscation \r to\nscripts \r from \r the \r existing \r corpus.\n-­‐ Generated \r 788 \r scripts \r by \r having \r ISE \r Steroids’ \r obfuscation \r tool \r apply \r random \r amounts \r of\nobfuscation \r to \r scripts \r from \r the \r existing \r corpus.\n-­‐ Generated \r 200 \r scripts \r by \r having \r Invoke-­‐CradleCrafter \r apply \r random \r amounts \r of \r obfuscation \r to\nscripts \r from \r the \r existing \r corpus.\n\nThis \r manual \r and \r automatic \r labeling \r provided \r a \r training \r set \r of \r 5674 \r “known \r clean” \r files, \r as \r well \r as \r 5590\n“known \r obfuscated” \r files. \r With \r this \r labeled \r data, \r we \r were \r then \r able \r to \r evaluate \r the \r empirical \r ability \r of\nthe \r Cosine \r Similarity \r approach. \r Wikipedia’s [Precision and Recall \r article \r is \r a \r great \r starting \r point \r for](https://en.wikipedia.org/wiki/Precision_and_recall)\nfurther \r discussion \r of \r these \r measurements.\n\nCosine \r Similarity \r produced \r great \r precision \r (89% \r of \r the \r items \r it \r considered \r obfuscated \r were \r in \r fact\nobfuscated), \r but \r suffered \r from \r poor \r recall \r (at \r scale, \r it \r only \r detected \r 37% \r of \r what \r was \r obfuscated). \r The\nF1 \r score, \r which \r incorporates \r both \r of \r these \r metrics, \r demonstrates \r the \r relatively \r poor \r overall\nperformance.\n\nIn \r addition \r to \r the \r issue \r with \r false \r negatives, \r a \r significant \r vulnerability \r in \r the \r Cosine \r Similarity \r approach\nis \r its \r susceptibility \r to \r character \r frequency \r tampering. \r No \r matter \r the \r inherent \r character \r frequency \r of \r an\nobfuscated \r PowerShell \r script, \r it \r would \r be \r trivial \r to \r pad \r that \r script \r with \r comments, \r strings, \r or \r variable\nnames \r that \r restored \r the \r character \r frequency \r of \r the \r script \r back \r to \r the \r industry \r average.\n\n### Leveraging the PowerShell Tokenizer and AST \nUsing \r character \r frequency \r as \r a \r feature \r vector \r on \r PowerShell \r scripts \r is \r a \r good \r start. \r However, \r the\nPowerShell \r engine \r includes \r two \r extremely \r powerful \r features \r to \r give \r tool \r authors \r deeper \r insight \r into \r the\nstructure \r of \r PowerShell \r scripts: \r the \r PowerShell \r Tokenizer, \r and \r the \r PowerShell \r Abstract \r Syntax \r Tree\n(AST). \r These \r features \r are \r commonly \r used \r to \r enable \r syntax \r highlighting \r support \r for \r PowerShell \r editors\n(such \r as \r the \r PowerShell \r ISE \r and \r Visual \r Studio \r Code), \r as \r well \r as \r advanced \r code \r analysis \r features \r such \r as\nthe \r detection \r of \r unused \r variables.\n\n\n-----\n\n[The \r System.Management.Automation.Language.Parser](https://technet.microsoft.com/en-us/library/hh443847(v=vs.85).aspx) class \r provides \r access \r to \r both \r the \r tokenization \r of\na \r PowerShell \r script \r and \r the \r tree-­‐like \r representation \r of \r the \r script.\n\nTokenization \r provides \r access \r to \r PowerShell’s \r initial \r basic \r extraction \r of \r comments, \r variable \r names,\ncommand \r names, \r operators, \r and \r more:\n\nPowerShell’s \r parser \r additionally \r creates \r a \r tree-­‐like \r representation \r of \r the \r script, \r called \r the \r Abstract\nSyntax \r Tree. \r This \r representation \r provides \r access \r to \r rich \r structural \r data \r about \r the \r script, \r such \r as \r the\nnesting \r of \r commands \r within \r script \r blocks, \r variables \r used \r in \r parameter \r arguments, \r and \r more:\n\n\n-----\n\n### Logistic Regression with Gradient Descent \nWith \r this \r advanced \r access \r to \r the \r structure \r of \r any \r given \r PowerShell \r script, \r we \r can \r begin \r to \r extract\nfeatures \r much \r more \r descriptive \r of \r a \r script’s \r composition \r than \r its \r character \r frequency \r alone. \r As \r part \r of\nthis \r investigation, \r we \r wrote \r feature \r extractors \r to \r calculate \r and \r summarize \r 4098 \r unique \r script\ncharacteristics, \r including:\n\n   - Distribution \r of \r AST \r types\n   - Distribution \r of \r language \r operators\n\n        - Assignment, \r binary, \r invocation, \r …\n   - Array \r size \r ranges\n   - Statistics \r within \r each \r AST \r type\n\n        - Character \r frequency, \r entropy, \r length \r (max, \r min, \r median, \r mean, \r mode, \r range),\nwhitespace \r density, \r character \r casing, \r …\n   - Statistics \r of \r command \r names, \r .NET \r methods, \r variables…\n\nRather \r than \r apply \r Cosine \r Similarity \r to \r this \r feature \r vector, \r we \r instead \r took \r a \r classification \r approach. \r This\nclassification \r approach \r directly \r identifies \r the \r likelihood \r that \r a \r script \r is \r obfuscated, \r rather \r than \r use\nanother \r metric \r (like \r similarity \r being \r greater \r than \r a \r certain \r number) \r to \r determine \r that \r fact.\n\nA \r common \r approach \r to \r classification \r of \r feature \r vectors \r is \r to \r apply \r a \r linear \r regression. \r Most \r statistical\nand \r mathematical \r packages \r offer \r built-­‐in \r functionality \r to \r create \r a \r linear \r regression. \r Excel \r is \r one \r popular\nchoice. \r A \r linear \r regression \r is \r based \r on \r the \r simple \r concept \r that \r you \r take \r each \r feature, \r multiply \r it \r by \r a\nweight, \r and \r then \r add \r all \r of \r those \r results \r together. \r If \r the \r result \r is \r over \r a \r certain \r amount, \r then \r the \r sample\nis \r considered \r part \r of \r the \r target \r classification \r (i.e.: \r “obfuscated”), \r while \r otherwise \r it \r is \r not.\n\nIn \r pseudo-­‐code, \r this \r looks \r similar \r to:\n\nMore \r important \r features \r will \r end \r up \r having \r higher \r weights \r than \r less \r important \r features. \r To \r keep \r the\nresult \r within \r a \r reasonable \r range \r of \r values \r and \r also \r to \r enable \r some \r slightly \r non-­‐linear \r distributions, \r it \r is\ncommon \r to \r apply \r the \r Logit \r function \r to \r this \r calculation. \r Together, \r this \r forms \r the \r basis \r of \r a \r Logistic\nRegression.\n\nThe \r final \r step \r in \r creating \r the \r PowerShell \r Obfuscation \r classifier \r is \r to \r decide \r on \r the \r appropriate \r weighting\nfor \r each \r of \r the \r 4098 \r unique \r script \r features.\n\nOne \r approach \r is \r to \r do \r it \r manually, \r but \r that’s \r error-­‐prone \r and \r time \r consuming. \r Another \r approach \r is \r to\nemploy \r a \r Gradient \r Descent \r algorithm, \r which \r is \r the \r approach \r we \r took.\n\n\n-----\n\nThe \r fundamental \r concept \r behind \r the \r Gradient \r Descent \r algorithm \r is \r similar \r to \r the \r back-­‐propagation\napproach \r used \r in \r neural \r networks. \r For \r any \r given \r script \r that \r you \r have \r labeled \r data \r for, \r you \r can \r calculate\nthe \r error \r between \r the \r actual \r result \r and \r the \r expected \r result. \r Based \r on \r this \r error, \r you \r can \r adjust \r all \r of \r the\nindividual \r feature \r weights \r based \r on \r how \r much \r they \r contributed \r to \r the \r error. \r If \r the \r weight \r for \r a \r specific\nfeature \r was \r large, \r it \r played \r a \r large \r role \r in \r the \r calculation \r of \r the \r actual \r result. \r Therefore, \r the \r weight \r will\nbe \r adjusted \r downward \r more \r aggressively \r than \r feature \r weights \r that \r played \r a \r relatively \r more \r minor \r role.\n\nWhen \r you \r apply \r this \r error \r correction \r approach \r over \r many \r thousands \r of \r iterations \r over \r the \r labeled\ntraining \r data \r set, \r the \r Gradient \r Descent \r algorithm \r will \r generate \r a \r set \r of \r weights \r for \r the \r feature \r vector\nthat \r minimizes \r error \r as \r much \r as \r possible.\n\nWhen \r doing \r this \r training, \r it \r is \r critical \r to \r separate \r the \r set \r of \r data \r used \r for \r training \r from \r the \r set \r of \r data\nused \r to \r calculate \r the \r actual \r results. \r Without \r this \r partitioning, \r a \r given \r weight \r vector \r can \r become \r over-­‐\ntrained \r to \r the \r point \r that \r it \r is \r extremely \r accurate \r on \r the \r training \r data, \r but \r loses \r a \r great \r deal \r of \r fidelity \r on\nunseen \r data. \r We \r followed \r common \r best \r practice \r and \r used \r a \r randomized \r 80% \r of \r the \r data \r for \r training,\nand \r 20% \r of \r the \r data \r for \r validation.\n\n## Results \n\nBy \r leveraging \r the \r incredible \r structure \r exposed \r through \r PowerShell’s \r parser \r APIs \r and \r AST, \r the\nPowerShell \r Obfuscation \r classifier \r proved \r extremely \r robust \r against \r in-­‐the-­‐wild \r obfuscated \r PowerShell.\nWe \r categorized \r in-­‐the-­‐wild \r obfuscated \r PowerShell \r as \r scripts \r output \r from \r Invoke-­‐Obfuscation, \r Invoke-­‐\nCradleCrafter, \r ISE \r Steroids, \r and \r the \r Underhanded \r PowerShell \r contest:\n\nThis \r classifier \r has \r an \r Accuracy \r and \r F1 \r score \r of \r 96% \r and \r 95%, \r respectively. \r It \r is \r 10 \r times \r better \r at \r finding\nobfuscated \r content \r (illustrated \r by \r the \r decrease \r in \r False \r Negatives) \r than \r character \r frequency \r analysis\nalone, \r and \r has \r half \r of \r the \r false \r positives.\n\n\n-----\n\n### Deep Content Scanning \nWhen \r performing \r an \r incident \r response, \r it \r is \r sometimes \r helpful \r to \r cast \r a \r wider \r net: \r to \r investigate \r more\ndeeply \r than \r you \r would \r have \r otherwise \r because \r the \r likelihood \r for \r malicious \r content \r is \r high. \r For\nexample, \r this \r script \r isn’t \r malicious \r or \r obfuscated, \r but \r clearly \r relies \r on \r uncommon \r scripting \r techniques:\n\nIn \r the \r heat \r of \r an \r incident \r response, \r you’d \r probably \r rather \r double-­‐check \r scripts \r like \r that, \r so \r we \r labeled\nall \r scripts \r that \r contained \r unusual \r or \r content \r like \r this \r as \r part \r of \r our \r labeling \r effort. \r We \r included \r scripts\nwith \r regions \r of \r complicated \r regular \r expressions, \r odd \r concentrations \r of \r script \r blocks, \r operators, \r and\nmore. \r Given \r the \r variety \r of \r scripts \r in \r deep \r content \r scanning, \r the \r classifier \r still \r performs \r admirably \r at \r this\nmuch \r more \r complicated \r task:\n\nIt \r returns \r nearly \r 90% \r of \r the \r scripts \r that \r somebody \r might \r consider \r “unusual”, \r with \r a \r still \r very \r reasonable\n5% \r false \r positive \r rate. \r This \r returned \r set \r of \r results \r includes \r 97% \r of \r “in \r the \r wild” \r obfuscated \r PowerShell.\n\n\n-----\n\n### Other Algorithms \nThe \r linear \r regression \r and \r gradient \r descent \r algorithm \r was \r written \r in \r C#, \r heavily \r leveraging \r the \r prior\n[work \r done \r by \r Dr. \r James \r McCaffrey \r in \r his \r MSDN \r column, \r Test Run – Gradient Descent Training Using C#.](https://msdn.microsoft.com/en-us/magazine/dn913188.aspx)\nHowever, \r Azure \r Machine \r learning \r makes \r it \r incredibly \r easy \r to \r compare \r this \r algorithm \r to \r several \r others,\nincluding \r Perceptron, \r Boosted \r Decision \r Tree, \r and \r Support \r Vector \r Machine \r techniques.\n\nFor \r both \r the \r “In \r the \r Wild” \r and \r “Deep” \r data \r sets, \r this \r implementation \r gets \r nearly \r identical \r results \r to \r the\nAzure \r Machine \r Learning \r implementation \r of \r Logistic \r Regression. \r Boosted \r Decision \r Trees \r produce \r similar\nresults, \r while \r the \r Perceptron \r and \r Support \r Vector \r Machine \r approaches \r performed \r much \r more \r poorly \r on\nthis \r data \r set.\n\n## Revoke-­‐Obfuscation \n[A \r production-­‐ready \r implementation \r of \r this \r classifier \r is \r now \r available \r in \r the \r GitHub \r project, \r Revoke-](https://github.com/danielbohannon/Revoke-Obfuscation)\n[Obfuscation.](https://github.com/danielbohannon/Revoke-Obfuscation)\n\n\n-----\n\nRevoke-­‐Obfuscation \r has \r been \r used \r in \r numerous \r Mandiant \r investigations. \r It \r supports \r analysis \r against\nfiles, \r PowerShell \r event \r logs, \r URLs, \r and \r even \r raw \r content \r streams. \r It \r also \r supports \r rich \r whitelisting\nbehaviour \r to \r reduce \r the \r false \r positive \r rate \r on \r known \r scripts.\n\n## Authors \n\n### Daniel Bohannon \nDaniel \r Bohannon \r (@DanielHBohannon) \r is \r a \r Senior \r Applied \r Security \r Researcher \r at \r Mandiant. \r He \r is \r the\nauthor \r of \r Invoke-­‐Obfuscation \r and \r Invoke-­‐CradleCrafter. \r He \r specializes \r in \r Obfuscation, \r evasion, \r and\ndetection \r techniques.\n\n### Lee Holmes \nLee \r Holmes \r (@Lee_Holmes) \r is \r the \r lead \r security \r architect \r of \r Azure \r Management \r at \r Microsoft. \r He \r is \r the\nauthor \r of \r the \r Windows \r PowerShell \r Cookbook, \r and \r an \r original \r member \r of \r the \r PowerShell \r development\nteam.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf"
    ],
    "report_names": [
        "revoke-obfuscation-report.pdf"
    ],
    "threat_actors": [
        {
            "id": "72d09c17-e33e-4c2f-95db-f204848cc797",
            "created_at": "2022-10-25T15:50:23.832551Z",
            "updated_at": "2025-03-27T02:00:55.554841Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "FIN8",
                "Syssphinx"
            ],
            "source_name": "MITRE:FIN8",
            "tools": [
                "BADHATCH",
                "PUNCHBUGGY",
                "Ragnar Locker",
                "PUNCHTRACK",
                "dsquery",
                "Nltest",
                "Sardonic",
                "PsExec",
                "Impacket"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fc80a724-e567-457c-82bb-70147435e129",
            "created_at": "2022-10-25T16:07:23.624289Z",
            "updated_at": "2025-03-27T02:02:09.892602Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "ATK 113",
                "Syssphinx"
            ],
            "source_name": "ETDA:FIN8",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BadHatch",
                "BlackCat",
                "Noberus",
                "PSVC",
                "PUNCHTRACK",
                "PoSlurp",
                "Powersniff",
                "PunchBuggy",
                "Ragnar Locker",
                "RagnarLocker",
                "Sardonic",
                "ShellTea"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5bdde906-0416-42ee-9100-5ebd95dda77a",
            "created_at": "2023-01-06T13:46:38.601977Z",
            "updated_at": "2025-03-27T02:00:02.870694Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "ATK113",
                "G0061"
            ],
            "source_name": "MISPGALAXY:FIN8",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041383,
    "ts_creation_date": 1501155789,
    "ts_modification_date": 1501155792,
    "files": {
        "pdf": "https://archive.orkl.eu/5556914b528d995e2a4474c768c4d0012c947587.pdf",
        "text": "https://archive.orkl.eu/5556914b528d995e2a4474c768c4d0012c947587.txt",
        "img": "https://archive.orkl.eu/5556914b528d995e2a4474c768c4d0012c947587.jpg"
    }
}