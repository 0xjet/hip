{
    "id": "0ef55afc-b932-433e-aca8-c5022665ea9b",
    "created_at": "2023-01-12T15:04:30.276503Z",
    "updated_at": "2025-03-27T02:17:00.697549Z",
    "deleted_at": null,
    "sha1_hash": "9a3e322f5ddf79cf67aad366b343021af20b268c",
    "title": "2021-12-30 - Lights Out in Isfahan",
    "authors": "",
    "file_creation_date": "2022-05-28T19:41:24Z",
    "file_modification_date": "2022-05-28T19:41:24Z",
    "file_size": 101490,
    "plain_text": "# Lights Out in Isfahan\n\n**pylos.co/2021/12/30/lights-out-in-isfahan/**\n\nJoe 12/30/2021\n\n[Iranian security company Amnpardaz Soft published an intriguing report on 28 December](https://www.amnpardaz.com/en/)\n[2021 concerning a firmware-level rootkit in HP Integrated Lights Out (iLO) products. While](https://www.hpe.com/us/en/servers/integrated-lights-out-ilo.html)\nfrustratingly containing no Indicators of Compromise (IOCs) – not so much for defensive\npurposes, but for validating research and independently analyzing artifacts – the report does\noffer sufficient technical detail to indicate something was discovered, and that it appears\ndesigned to repeatedly wipe infected systems for a disruptive effect.\n\nThe report is interesting for several reasons:\n\n1. The targeted HP iLO technology – while previously rumored to have issues and\n\n[potential related operations – has no prior confirmed, publicly known capability](https://www.bleepingcomputer.com/news/security/ransomware-hits-hpe-ilo-remote-management-interfaces/)\ntargeting its use for destructive operations.\n2. The capability deployed is designed for a seemingly contradictory combination of\n\nstealth, persistence, and potentially destructive purposes.\n3. The identifying company, Amnpardaz, is an Iranian entity that appears to only provide\n\nsoftware security products to the Iranian market.\n4. Details in the report itself emphasize Iran-specific use of the malware in question, at\n\nleast in terms of identified targets.\n\nBefore proceeding further with the iLO malware, a bit of perspective is helpful. For nearly two\ndecades now, Iran has been the subject of a persistent, occasionally spectacular cyber\n[sabotage campaign. Starting at minimum with the Olympic Games program, of which](http://cejsh.icm.edu.pl/cejsh/element/bwmeta1.element.doi-10_35467_sdq_121974)\n[Stuxnet formed a notable part, and proceeding through multiple](https://www.amazon.com/Countdown-Zero-Day-Stuxnet-Digital/dp/0770436196) [disruptive](https://research.checkpoint.com/2021/indra-hackers-behind-recent-attacks-on-iran/) [operations of](https://www.npr.org/2021/10/27/1049566231/irans-president-says-cyberattack-was-meant-to-create-disorder-at-gas-pumps)\nvarying degrees of sophistication more recently, Iran is no stranger to malicious cyber\noperations.\n\nMost items over the past three years have been rather overt and relatively simplistic in\nnature – disruptive events readily identified even if not immediately attributed to the\nresponsible parties. Given past events such as Olympic Games, we can assume that other\nprojects are likely going on at higher levels of sophistication and care. This assumption is\nsupported by more complex, hybrid operations, especially targeting Iran’s nuclear program,\n\n\n-----\n\n[involving physical destruction and](https://www.bbc.com/news/world-middle-east-56734657) [extrajudicial killing. With continued tensions over Iran s](https://www.nytimes.com/2021/09/18/world/middleeast/iran-nuclear-fakhrizadeh-assassination-israel.html)\nnuclear program as well as other concerns, we should reasonably suppose that interested\nparties would engage in more clandestine or quiet disruptive campaigns (like Stuxnet itself)\nin addition to spectacular acts of physical destruction.\n\nThat background in mind, that a Tehran-based security company identified a rootkit\nfacilitating system wiping with victimology focusing on Iran becomes quite interesting. The\nnature of the technology – remote server management software – means its installation\nfootprint will almost certainly extend to a variety of sensitive or high-value systems, from data\ncenter management to critical infrastructure applications. While available information cannot\ndetermine precisely what iLO instances were targeted, the possibilities for high-impact\nscenarios are quite strong.\n\nAs an aside, you may wonder why an HP server management product would even be an\nitem of interest in Iran, given various sanctions limiting the export of entire categories of\ntechnology to the Islamic Republic. However, [multiple](https://www.reuters.com/article/us-huawei-iran-sanctions-exclusive/exclusive-newly-obtained-documents-show-huawei-role-in-shipping-prohibited-u-s-gear-to-iran-idUSKBN20P1VA) [investigations show various entities](https://www.nytimes.com/2008/12/29/business/worldbusiness/29iht-hp.4.18984271.html)\nengaged in sanctions evasion with respect to HP products specifically for delivery to Iran\nover the past 20 years. While iLO and related HP servers are not explicitly mentioned in the\nlinked investigations, we can reasonably assume that some HP technology made it to Iran,\nand that these product categories were likely represented in such shipments.\n\nMoving back to the malware, the report from Amnpardaz notes the peculiar functionality of\nthe rootkit in question. While installing to a location both difficult to diagnose and difficult to\neradicate (following some modification to firmware verification steps), the malware appears\ndesigned for a specific, singular purpose: to wipe the disks of the infected system. But in\ndoing so, this wipe takes place multiple times using both a wiping timer, and a countdown\ntimer for the number of wipes to perform.\n\n[This repeat functionality is incredibly interesting, as typical wiper malware – from Shamoon](https://www.cfr.org/cyber-operations/compromise-saudi-aramco-and-rasgas)\nto [NotPetya – is a “one time only” affair for the impacted system: the malware executes,](https://securelist.com/expetrpetyanotpetya-is-a-wiper-not-ransomware/78902/)\nwipes the host it is located on, and the affair is over. However, given that the iLO rootkit is\ninstalled on management application for systems (running separate from the system itself),\nan interesting capability emerges where a persistent infection can be maintained on a device\nthrough the iLO instance to allow for multiple wipes of the same systems on which the\nmalicious firmware is installed. Such capability is not merely disruptive, but incredibly\nfrustrating if not caught as it leads to “ghost in the machine” like worries where operators and\nIT personnel are unable to determine precisely how or why given systems wipe themselves\non a semi-regular basis.\n\nThe above is superficially reminiscent of the initial stages of the Stuxnet event. In this case,\nearlier variants of Stuxnet were designed not to completely destroy the centrifuge hall in\nNatanz, but rather to [induce a loss of system integrity creating pseudo-random failures in the](https://www.dragos.com/wp-content/uploads/Past-and-Future-of-Integrity-Based-ICS-Attacks.pdf)\nunderlying physical system. The goal in this case wasn’t to simply destroy the entire\nenrichment facility, but rather to induce doubt and uncertainty as to the very reliability of the\n\n\n-----\n\ndomestically-produced enrichment technology. Put in simple terms, Stuxnet was a mindfuck\nfor the engineers and operators at Natanz, to call into question the technical efficacy of the\nentire Iranian nuclear program rather than just destroy some (but not all) centrifuges.\n\nThe iLO malware echoes this in its subtle, relatively stealthy persistence in an administrative\ntool in order to disrupt controlled servers. The attacker in question could engage in a\npersistent campaign of regular system wipes without a risk of likely detection given the\ndescribed nature of the malicious firmware. Such a situation goes beyond just “we have\nmalware” to a far more insidious circumstance of “do we even understand what is going on\nwith our machines.” This again approaches “ghost in the machine” territory where the very\nintegrity and capability of underlying systems cannot be confirmed or verified, inducing\nuncertainty and disruption into the entire operation.\n\nIn unpacking the iLO malicious firmware in such a fashion, it may thus appear quite obvious\nwho is responsible. Given past analysis of capabilities such as Stuxnet and the overall\nOlympic Games program, the United States and Israel rapidly come to the forefront as\nparties with both the technical ability to execute such a campaign as well as the motivation to\ndo so. However, I would strongly caution anyone from making such a quick (and arguably\nlazy) assumption. While the iLO capability is certainly novel, targeting this application is not\ncompletely new (as noted previously) and represents a more common attack development\nproblem than the intricate cyberphysical relationships observed in Stuxnet’s execution.\nFurthermore, the proliferation of cyber capabilities and offensive tool development mean that\nany number of state-sponsored entities or even commercial firms may have the know-how\nand resources to develop a tool such as that observed in this campaign. We ultimately\ncannot, based on limited available evidence, make any real assessment of “who is\nresponsible” at this time. The US or Israel may represent logical choices, but I would strongly\ncaution curious parties to not write off spunky intelligence organizations with demonstrated\n[sophistication in cyber operations (AIVD and](https://english.aivd.nl/) [DGSE come to mind) or entities such as](https://www.defense.gouv.fr/english/dgse)\nvarious Gulf monarchies simply procuring these types of capabilities for their use in\n[retaliation for Iranian](https://www.darkreading.com/advanced-threats/dustman-attack-underscores-iran-s-cyber-capabilities) [disruptive events in these areas.](https://www.ibm.com/downloads/cas/OAJ4VZNJ)\n\nIn addition to the above caution on attribution of this event, we should also exercise some\ncaution with respect to the very existence of the incident itself. The reporting party,\nAmnpardaz, is hardly a known quantity in research circles. There is also some potential\nmotivation by Iranian authorities to cast potential disruptive events as part of an external plot,\nboth to placate internal audiences as well as to influence external parties. The lack of\nspecific examples in the Amnpardaz report would appear to support this. However, it is worth\nnoting that the published information is sufficient to develop fairly robust detection signatures\nthat can identify potential samples of the iLO tool. At this time, at least one item has been\nidentified matching the Amnpardaz report, so their analysis cannot be completely discounted.\nBut the technical match does not automatically prove the targeting and potential intention\n\n\n-----\n\nitems that would make this capability uniquely focused on Iranian interests. Thus we should\nproceed with some degree of caution, even if available details indicate interesting\npossibilities may exist.\n\nOverall, the iLO implant identified represents an interesting, if not necessarily completely\nunique, capability designed to perform disruptive activity in a very strange and uncommon\nfashion. While evidence to completely confirm (or deny) hypotheses around this event\nremains frustratingly lacking, the source and nature of disclosure strongly hint at additional\nmotivations behind revealing this operation. With luck, the community will be able to gather\nmore information (and ideally samples) related to this activity allowing for firmer disposition.\nUntil that time though, security analysts and other interested parties will remain in a state of\nuncertainty – but also one of anticipation.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-30 - Lights Out in Isfahan.pdf"
    ],
    "report_names": [
        "2021-12-30 - Lights Out in Isfahan.pdf"
    ],
    "threat_actors": [
        {
            "id": "8309f9cf-9abb-4ce3-aa1e-cda7d7f5c1b3",
            "created_at": "2022-10-25T16:07:23.729215Z",
            "updated_at": "2025-03-27T02:02:09.949223Z",
            "deleted_at": null,
            "main_name": "Indra",
            "aliases": [],
            "source_name": "ETDA:Indra",
            "tools": [
                "Stardust"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "219ddb41-2ea8-4121-8b63-8c762f7e15df",
            "created_at": "2023-01-06T13:46:39.384442Z",
            "updated_at": "2025-03-27T02:00:03.07071Z",
            "deleted_at": null,
            "main_name": "Predatory Sparrow",
            "aliases": [
                "Indra",
                "Gonjeshke Darande"
            ],
            "source_name": "MISPGALAXY:Predatory Sparrow",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535870,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1653766884,
    "ts_modification_date": 1653766884,
    "files": {
        "pdf": "https://archive.orkl.eu/9a3e322f5ddf79cf67aad366b343021af20b268c.pdf",
        "text": "https://archive.orkl.eu/9a3e322f5ddf79cf67aad366b343021af20b268c.txt",
        "img": "https://archive.orkl.eu/9a3e322f5ddf79cf67aad366b343021af20b268c.jpg"
    }
}