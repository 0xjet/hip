{
    "id": "82d3d5b8-e227-4782-a4e2-3849ca57337d",
    "created_at": "2023-01-12T15:05:23.636959Z",
    "updated_at": "2025-03-27T02:05:36.648684Z",
    "deleted_at": null,
    "sha1_hash": "ce73d208f19b7641ec975702e1298cc680ede229",
    "title": "2022-01-21 - Disruptive Attacks in Ukraine Likely Linked to Escalating Tensions",
    "authors": "",
    "file_creation_date": "2022-05-28T18:17:15Z",
    "file_modification_date": "2022-05-28T18:17:15Z",
    "file_size": 888435,
    "plain_text": "# Disruptive Attacks in Ukraine Likely Linked to Escalating Tensions\n\n**[secureworks.com/blog/disruptive-attacks-in-ukraine-likely-linked-to-escalating-tensions](https://www.secureworks.com/blog/disruptive-attacks-in-ukraine-likely-linked-to-escalating-tensions)**\n\nCounter Threat Unit Research Team\n\n_Geopolitical tensions likely inspired a combination of website defacements, WhisperGate wiper malware attacks, and_\n_DDoS attacks targeting organizations in Ukraine. Friday, January 21, 2022 By: Counter Threat Unit Research Team_\nSecureworks® Counter Threat Unit™ (CTU) researchers are investigating reports of destructive malware attacks in\n[Ukraine. On January 15, 2022, Microsoft reported a campaign that began on January 13 and leverages the](https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/)\n[WhisperGate malware. The timing coincides with defacement of Ukrainian government websites in which the content](https://edition.cnn.com/2022/01/14/europe/ukraine-cyber-attack-government-intl/index.html)\nwas replaced with a claim that Ukrainians' data had been breached (see Figure 1). Distributed denial of service (DDoS)\n[attacks against some sites were also reported.](https://twitter.com/dsszzi/status/1483062529874145281)\n\n\n-----\n\n_Figure 1. Defacement text on Ukrainian government websites. English translation: Ukrainian! All your personal data_\n_has been uploaded to the public network. All data on the computer is being destroyed, it is impossible to recover it. All_\n_information about you has become public, be afraid and expect the worst. This is for your past, present and future. For_\n_Volyn, for the OUN UPA, for Galicia, for Polissya and for historical lands. (Source: Secureworks)_\n\n## Defacement activity\n\nWhen the defacements were initially reported on January 14, it was unclear what data the threat actors meant. It may\nhave referred to data destroyed by the WhisperGate destructive malware attacks, which had not been made public. As\nof this publication, no data leaks have been linked to these attacks. The threat actors could have been bluffing, or they\ncould intend to leak the data in the future. In the defacement campaign, the threat actors made a crude attempt to\nsuggest a Polish origin by referencing past conflicts between Poland and Ukraine and by injecting GPS coordinates\ninto the EXIF data of the image (see Figure 2).\n\n\n-----\n\n_Figure 2. GPS coordinates extracted from defacement image. (Source: Secureworks)_\n\nThe image is not a photo and therefore would not typically contain GPS data. The coordinates map to a car park near\nWarsaw. The threat actors may have intended to point investigators to the adjacent General Staff of the Polish Army\nbuilding (see Figure 3).\n\n_Figure 3. GPS coordinates map to a car park (red pin) near a Polish Army building. (Source: Google maps)_\n\n[The Security Services of Ukraine (SSU) reported that over 70 government websites were attacked and that](https://www.zdnet.com/article/ukraine-says-70-state-websites-were-defaced-10-were-subjected-to-unauthorized-interference/)\nunauthorized access occurred on 10 of them. These numbers will likely change as investigations continue. The initial\naccess vector for the defaced websites has not been confirmed, although several options are being investigated. The\nSSU indicated that a supply chain attack was used to obtain access to some of the websites, citing the compromise of\na company that had administrative rights to the impacted websites. The company was not named, but as of this\npublication the website for Ukrainian digital technologies company Kitsoft redirects to a Facebook page that states its\n[infrastructure was involved in the attacks. Other suggested attack vectors include exploitation of October CMS and](https://twitter.com/dsszzi/status/1483062218501640198)\nLog4j vulnerabilities.\n\n[State Service of Special Communications and Information Protection of Ukraine reported that a subset of the](https://twitter.com/dsszzi/status/1483540052160524289)\norganizations impacted by the defacement activity were also victims of the WhisperGate malware attacks. Details of\nthe WhisperGate initial access vector and deployment mechanism are unclear as of this publication, although Microsoft\nstated that the threat actors used [Impacket tools to execute the malware. WhisperGate is not a worm payload like the](https://github.com/SecureAuthCorp/impacket)\n2017 [NotPetya ransomware, so the malware must be deployed and deliberately executed on every targeted host.](https://www.secureworks.com/blog/notpetya-campaign-what-we-know-about-the-latest-global-ransomware-attack)\n\n## WhisperGate technical details\n\nWhisperGate has two major components: a master boot record (MBR) wiper and a file wiper. The attackers appear to\nrefer to these files as stage 1 (the MBR wiper) and stage 2 (the file wiper). However, these labels do not necessarily\nreflect the order they were executed, as the stages do not depend on each other.\n\n[The MBR wiper is written in the C programming language and compiled with the MinGW compiler. CTU™ analysis](https://en.wikipedia.org/wiki/MinGW)\nindicates that parts of the MBR wiper code are common to other MBR wiper examples found on the VirusTotal analysis\nservice. These commonalities suggest that the WhisperGate MBR wiper developers borrowed code from publicly or\nprivately shared source code repositories.\n\n\n-----\n\nWhen executed, the MBR wiper overwrites the MBR with a small segment of code. The next time the computer is\nrebooted, the new MBR code displays a ransom message (see Figure 4) and attempts to overwrite the disk in the\nbackground using the BIOS Extended Write Sectors [interrupt call. Testing on Windows 10 revealed the malware](https://en.wikipedia.org/wiki/BIOS_interrupt_call)\noperates as designed. However, the malware caused a Windows 11 system to crash, likely due to the GUID Partition\nTable (GPT) scheme replacing the older MBR partition scheme in Windows 11.\n\n_Figure 4. Ransom message presented by WhisperGate MBR wiper. (Source: Secureworks)_\n\nDespite the use of a ransom note, there is no prospect of data recovery. This malware is a destructive wiper, not\nransomware.\n\nThe file wiper involves a loader (Tbopbh.exe) and a packed payload (Tbopbh.jpg) that the loader downloads and\nexecutes. The loader is written in .NET. When executed, it uses a PowerShell command to sleep for 20 seconds, likely\nas an antivirus or sandbox evasion tactic. It then downloads the packed payload from a Discord channel (see Figure 5).\n\n_Figure 5. Discord channel hosting WhisperGate payload. (Source: Secureworks)_\n\nAlthough the payload's filename suggests that it is a JPG image file, it is a DLL file. The file byte order is reversed,\nlikely to evade detection by host-based controls. The loader restores the byte order and then performs multiple rounds\nof extraction and decoding of nested resources to get to the final malicious code. Figure 6 shows the processes\ncreated during unpacking. The final malicious files are dropped into C:\\Users\\<username>\\AppData\\Local\\Temp\\. The\nloader attempts to disable Microsoft Defender Antivirus.\n\n_Figure 6. Process tree showing execution of the WhisperGate file wiper. (Source: Secureworks)_\n\nThe loader drops Nmddfrqqrbyjeygggda.vbs, which contains a one-line script to exclude the C:\\ drive from locations\nmonitored by Microsoft Defender Antivirus (see Figure 7). The loader drops the AdvancedRun.exe NirSoft tool to stop\nthe antivirus service and recursively remove its starting directory.\n\n_Figure 7. Contents of Nmddfrqqrbyjeygggda.vbs. (Source: Secureworks)_\n\nInstallUtil.exe is copied from C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\ and written to C:\\Users\\\n_<username>\\AppData\\Local\\Temp\\. This file is used to create the host process where the final wiper payload is_\n[injected, using a technique known as process hollowing. The code also included a function that runs a command](https://attack.mitre.org/techniques/T1055/012/)\n(cmd.exe /min /C ping 111.111.111.111 -n 5 -w 10 > Nul & Del /f /q \"%s\") that uses ping to inject a brief time delay\nbefore deleting a file. However, CTU researchers did not observe this command being run the sandbox execution of\nthe malware.\n\n\n-----\n\nLike the MBR wiper, the file wiper code is written in C and compiled using MinGW. The file wiper targets a hard coded\nlist of file extensions (see Figure 8). It destroys data in identified files by writing 0xCC to the first 0x100000 bytes, which\ntranslates to approximately 1MB of data. The list includes file types that are not typically targeted by ransomware, such\nas the .602 extension used by a Czech word processor. The [WCry (also known as WannaCry) ransomware targeted](https://www.secureworks.com/research/wcry-ransomware-analysis)\nthis extension, but there is no known connection between the two malware families.\n\n_Figure 8. Extensions targeted by the WhisperGate file wiper. (Source: Secureworks)_\n\nFigure 9 shows an example of the autoexec.bat file being overwritten.\n\n_Figure 9. Overwrite of autoexec.bat. (Source: Secureworks)_\n\nBased on analysis of additional samples that appeared to use the same loading and packing mechanism but were\nunrelated to WhisperGate, it is likely that the WhisperGate developers used PureCrypter or a similar crimeware crypter\nto generate the .NET code in both the loader (Tbopbh.exe) and the initial payload (Tbopbh.jpg) of the file wiper.\nDetection rules based on these components will likely match other crimeware components unrelated to WhisperGate.\n[A YouTube video posted by user Pure Coder demonstrates PureCrypter features such as the Advanced Runtime](https://www.youtube.com/watch?v=twhJXM9SoEo)\n(AdvancedRun.exe), Windows Defender Exclusion, and Disable functionality. The tool allows the operator to select the\nprocess where the payload is injected. Options include InstallUtil, as used by WhisperGate (see Figure 10).\n\n\n-----\n\n_Figure 10. PureCrypter panel. (Source: Secureworks)_\n\n## Attribution\n\nAs of this publication, there is insufficient evidence to determine attribution for the Ukrainian defacement, DDoS, and\nwiper attacks. However, it is highly likely that they are linked to the current geopolitical tensions centered on the border\nbetween Ukraine and Russia. If tensions are not deescalated, additional cyberattacks are likely. These attacks do not\nhave the sophistication or destructive power of previous attacks on Ukraine, such as NotPetya. The threat actors\nattempted to misdirect attribution using inauthentic metadata and used publicly available crimeware services and code\nto minimize the amount of custom code involved in the attack.\n\n## Recommendations\n\nOrganizations with operations in Ukraine should be extra vigilant and review business continuity and resilience plans.\nOrganizations should maintain current backups of business-critical systems and data, exercise restoration processes\nbefore they are needed, and ensure that backups cannot be impacted by ransomware-style or wiper malware attacks.\nOrganizations should also prepare for continuity of operations in the case of power disruptions or loss of other\nbusiness-critical services.\n\nIt is unlikely that organizations outside of Ukraine or unrelated to the political situation will be directly targeted.\nHowever, organizations should consider their exposure to collateral damage from attacks launched in Ukraine that\ncould spread to global operations. Impacted organizations could include business partners and service providers in\nUkraine that have logical access to customer networks. Applying robust network segmentation between higher risk and\nlower risk areas can mitigate risk. Additionally, all organizations should maintain basic security practices such as\npatching internet-facing systems against known vulnerabilities, implementing and maintaining antivirus solutions, and\nmonitoring endpoint detection and response solutions.\n\n[For more information about WhisperGate versus NotPetya, read the accompanying blog post.](https://www.secureworks.com/blog/whispergate-not-notpetya)\n\n## Threat indicators\n\n\n-----\n\nTo mitigate exposure to this malware, CTU researchers recommend that organizations use available controls to review\nand restrict access using the indicators listed in Table 1.\n\n**Indicator** **Type** **Context**\n\n\na196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92 SHA256\nhash\n\n189166d382c73c242ba45889d57980548d4ba37e SHA1\nhash\n\n5d5c99a08a7d927346ca2dafa7973fc1 MD5\nhash\n\ndcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78 SHA256\nhash\n\n16525cb2fd86dce842107eb1ba6174b23f188537 SHA1\nhash\n\n14c8482f302b5e81e3fa1b18a509289d MD5\nhash\n\n923eb77b3c9e11d6c56052318c119c1a22d11ab71675e6b95d05eeb73d1accd6 SHA256\nhash\n\nb2d863fc444b99c479859ad7f012b840f896172e SHA1\nhash\n\nb3370eb3c5ef6c536195b3bea0120929 MD5\nhash\n\n9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d SHA256\nhash\n\n82d29b52e35e7938e7ee610c04ea9daaf5e08e90 SHA1\nhash\n\ne61518ae9454a563b8f842286bbdb87b MD5\nhash\n\n\nWhisperGate MBR wiper\n\nWhisperGate MBR wiper\n\nWhisperGate MBR wiper\n\nWhisperGate file wiper\nloader (Tbopbh.exe)\n\nWhisperGate file wiper\nloader (Tbopbh.exe)\n\nWhisperGate file wiper\nloader (Tbopbh.exe)\n\nWhisperGate file wiper\npacked payload\n(Tbopbh.jpg)\n\nWhisperGate file wiper\npacked payload\n(Tbopbh.jpg)\n\nWhisperGate file wiper\npacked payload\n(Tbopbh.jpg)\n\nWhisperGate file wiper\npacked DLL\n(Frkmlkdkdubkznbkmcf.dll)\n\nWhisperGate file wiper\npacked DLL\n(Frkmlkdkdubkznbkmcf.dll)\n\nWhisperGate file wiper\npacked DLL\n(Frkmlkdkdubkznbkmcf.dll)\n\n\nNmddfrqqrbyjeygggda.vbs Filename WhisperGate malware\nscript\n\nTbopbh.exe Filename WhisperGate file wiper\nloader\n\nTbopbh.jpg Filename WhisperGate file wiper\npacked payload\n\nFrkmlkdkdubkznbkmcf.dll Filename WhisperGate file wiper\npacked DLL\n\n_Table 1. Indicators for this threat._\n\n[If you need urgent assistance with an incident, contact the Secureworks Incident Response team. For other questions](https://www.secureworks.com/contact/emergency-response)\n[on how we can help, use our general contact form.](https://www.secureworks.com/contact/talk-with-an-expert)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-21 - Disruptive Attacks in Ukraine Likely Linked to Escalating Tensions.pdf"
    ],
    "report_names": [
        "2022-01-21 - Disruptive Attacks in Ukraine Likely Linked to Escalating Tensions.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535923,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653761835,
    "ts_modification_date": 1653761835,
    "files": {
        "pdf": "https://archive.orkl.eu/ce73d208f19b7641ec975702e1298cc680ede229.pdf",
        "text": "https://archive.orkl.eu/ce73d208f19b7641ec975702e1298cc680ede229.txt",
        "img": "https://archive.orkl.eu/ce73d208f19b7641ec975702e1298cc680ede229.jpg"
    }
}