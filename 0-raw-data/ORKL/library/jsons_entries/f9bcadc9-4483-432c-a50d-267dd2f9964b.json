{
    "id": "f9bcadc9-4483-432c-a50d-267dd2f9964b",
    "created_at": "2023-03-03T02:05:46.395227Z",
    "updated_at": "2025-03-27T02:05:21.301247Z",
    "deleted_at": null,
    "sha1_hash": "ccc0c4169fc81e4ba2a8c167c6ee3fe4756dc83c",
    "title": "2022-11-30 - Malware with Sandbox Evasion Techniques Observed Stealing Browser Cached Credentials",
    "authors": "",
    "file_creation_date": "2023-03-01T09:12:00Z",
    "file_modification_date": "2023-03-01T09:12:00Z",
    "file_size": 1651159,
    "plain_text": "# Malware with Sandbox Evasion Techniques Observed Stealing Browser Cached Credentials\n\n**cyberflorida.org/2022/11/arechclient2/**\n\nSarina Gandy November 30, 2022\n\n**I. Targeted Entities**\n\nOpportunistic organizations\n\n**II. Introduction**\n\n\n-----\n\nArechclient2 is a .NET remote access trojan (RAT) that has numerous capabilities. The RAT\ncan profile victim systems, steal information like browser and crypto-wallet data, and launch\na hidden secondary desktop to control browser sessions.\n\n**III. Cyber Florida SOC Observations**\n\n**_Update 12/8/2022:_**\n\nCyber Florida identified additional content in analysis that was not previously reported. This\ninformation pertains to network connections. Within utilizing the InstallUtil.exe binary to\nexecute code, the InstallUtil.exe process was observed reaching out to a pastebin[.]com\npage. This page contained the CnC IP address. Additionally, the victim IP address (observed\nin the UIP parameter) appears to be ascertained from the InstallUtil.exe process from\nhxxp://eth0[.]me (which appears to be a site that identifies the visiting host’s IP address).\n\n**_Original Post:_**\n\nCyber Florida has observed network payload data obfuscated via Base64 encoding and sent\nto what appears to be a command control server. The command and control server appears\nto be utilizing Google cloud services (googleusercontent.com). Within the Base64 data,\nexfiltrated usernames and passwords were observed. Based on observations, the exfiltrated\ndata appears to be from cached browser credentials (Google Chrome profiles, Firefox\nprofiles, Microsoft Edge profiles, etc.) In reviewing logs and network traffic there were\nparameters of interest within the data payload that would aid in identifying this activity. The\nfollowing payload parameters were observed the network traffic: ConnectionType, Client,\n_SessionID, BotName, Computer, BuildID, BotOS, URLData, UIP._\n\nBased on observing network traffic for the command control communication, there may be\nsimilarities associated to the Redline Stealer malware. See CERT Italy article. https://certagid.gov.it/news/scoperto-il-malware-redline-stealer-veicolato-come-lastpass/\n\nScreenshot samples of log and network traffic have been provided in the appendix of this\nreport.\n\nSome of the interesting evasion tactics Cyber Florida observed were the utilization of “sleep”\nfunctions and the usage of .NET Framework’s InstallUtil.exe binary to communicate with the\ncommand and control server. The “sleep” functionality appeared to delay the usage of\nInstallUtil.exe. In testing, the Installutil.exe appeared to run in perpetuity regularly\ncommunicating with the command and control server. In reviewing a few of the automated\nsandboxes, the Installutil.exe activity was not identified. This may be due to the “sleep”\nactivity being utilized.\n\nAnother evasion tactic appears to be attempting to modify Windows Defender settings via\nthe second observed PowerShell instance. The cmdlet Set-MpPreference with the options –\nExclusionPath ‘C:’ was employed. This command appears to create a malware scan\nexclusion, which would prevent Windows Defender from scanning the entire C: volume.\n\n\n-----\n\nThe following links provide examples and context of InstallUtil.exe malware usage and\nabuse.\n\n[https://gbhackers.com/hiding-malware-legitimate-tool/ (not directly related to observed](https://gbhackers.com/hiding-malware-legitimate-tool/)\nactivity)\n\n[https://www.ired.team/offensive-security/code-execution/t1118-installutil (not directly related](https://www.ired.team/offensive-security/code-execution/t1118-installutil)\nto observed activity)\n\n[https://attack.mitre.org/techniques/T1218/004/](https://attack.mitre.org/techniques/T1218/004/)\n\nDuring initial malicious binary execution, a persistence mechanism was observed via the\ncommon HKCUSoftwareMicrosoftWindowsCurrentVersionRun location.\n\n**IV. Additional Background Information**\n\nBlackpoint Cyber discovered an ISO file that contained a malicious Windows executable that\nwas downloaded to a victim’s computer and was not detected by an antivirus program. A\nmalicious executable, named Setup.exe, was observed using various defense evasion\ntechniques including obfuscation, injection, and uncommon automation tools. These tools\nwere used to drop a RAT named Arechclient2 (Blackpoint Cyber). The size of Setup.exe is\nover 300 megabytes (Blackpoint Cyber).\n\nThe initial attack vector that was used to send Setup.exe to the victim is unknown. This is the\nexecution step. When Setup.iso is double-clicked, the ISO file can be mounted like a CD\nand, oftentimes, the contents of the file are automatically executed (Blackpoint Cyber).\nRunning Setup.exe will start the extraction of three files and execute multiple child processes\n(Blackpoint Cyber). A new folder, IXP000.TMP, is made in the victim’s AppDataLocalTemp\ndirectory and three files are created into the newly created directory: Funding.mpeg,\n_Mali.mpeg, and Dns.mpeg (Blackpoint Cyber)._\n\nThe Dns.mpeg script is heavily obfuscated. The script searches for AvastUI.exe and\n_AVGUI.exe running on the victim’s computer. The two executables are found in the Avast_\nantivirus product line (Blackpoint Cyber). If those two executables are not found, Dns.mpeg\nsets Hole.exe.pif to the name AutoIT3.exe. In the script .au3 (or d.au3) there are over 3,000\nreferences to a function named Xspci(). This function takes a string as its first argument and\na number as its second argument. The function is responsible for decoding strings\n(Blackpoint Cyber).\n\nThe .au3 script accomplishes three things through injection: 1. establishing persistence using\na URL file in the victim’s startup folder. 2. copying the ntdll.dll file from the\n_C:WindowsSysWOW64 folder to avoid antivirus hooks. 3. injecting the embedded payload_\ninto jsc.exe (Blackpoint Cyber). The function that is responsible for the above tasks is\n_KXsObHGILZNaOurxqSUainCYU() which takes a pointer to the binary to be injected, a string_\n\n\n-----\n\nargument, and a string argument with the path to the binary that would be executed and\ninjected into as arguments (Blackpoint Cyber). The script establishes persistence by adding\na URL file to the victim’s startup folder that will execute a Microsoft Visual Basic Script (VBS)\non every login (Blackpoint Cyber).\n\nArechclient2 has a decompilation phase. Test.exe, a C# binary, can be loaded into tools that\nstatically and dynamically analyze code. One such tool is DnSpy (Blackpoint Cyber). The\nclass names in Test.exe were minimized to single and double characters to add an additional\nlayer of confusion for reverse engineers (Blackpoint Cyber). The actual name of Test.exe is\n_2qbarx12tqm.exe (Blackpoint Cyber). Arechclient2 also contains a command and control_\n(C2) phase. When Arechclient2 is executed, it connects to\n_https[:]//pastebin.com/raw/nJqnWX3u to collect C2 information (Blackpoint Cyber). The_\nrequested file, nJqnWX3u, contains the IP address 34[.]141[.]198[.]105 as a string. It also\nconnects to http[:]//eth0.me to get its public IP address (Blackpoint Cyber). Arechclient2\nconnects to its C2 server on port 15647 to receive commands. The server responds with\ninformation to control the encryption status (“On” or “Off”) in JSON format (Blackpoint Cyber).\nIf the communications are intercepted and the encryption is set to “Off,” further\ncommunications will be in plaintext (Blackpoint Cyber).\n\n**V. MITRE ATT&CK**\n\n**T1059.001 – Command and Scripting Interpreter: PowerShell**\n\nAdversaries may abuse PowerShell commands and scripts for execution. PowerShell\nis a powerful interactive command-line interface and scripting environment included in\nthe Windows operating system. Adversaries can use PowerShell to perform a number\nof actions, including discovery of information and execution of code.\n**T1555.003 – Credentials From Web Browsers**\n\nAdversaries may acquire credentials from web browsers by reading files specific to the\ntarget browser. Web browsers commonly save credentials such as website usernames\nand passwords so that they do not need to be entered manually in the future. Web\nbrowsers typically store the credentials in an encrypted format within a credential store;\nhowever, methods exist to extract plaintext credentials from web browsers.\n**T1547.001 – Registry Run Keys / Startup Folder**\n\nAdversaries may achieve persistence by adding a program to a startup folder or\nreferencing it with a Registry run key. Adding an entry to the “run keys” in the Registry\nor startup folder will cause the program referenced to be executed when a user logs in.\nThese programs will be executed under the context of the user and will have the\naccount’s associated permissions level.\n**T1562.001 – Impair Defenses: Disable or Modify Tools**\n\nAdversaries may modify and/or disable security tools to avoid possible detection of\ntheir malware, tools, and activities. Adversaries may also tamper with artifacts\ndeployed and utilized by security tools. Security tools may make dynamic changes to\nsystem components in order to maintain visibility into specific events.\n\n\n-----\n\n**T1218.004 – System Binary Proxy Execution: InstallUtil**\nAdversaries may use InstallUtil to proxy execution of code through a trusted Windows\nutility. InstallUtil is a command-line utility that allows for installation and uninstallation of\nresources by executing specific installer components specified in .NET binaries. The\nInstallUtil binary may also be digitally signed by Microsoft and located in the .NET\ndirectories on a Windows system: C:WindowsMicrosoft.NETFramework vInstallUtil.exe\nand C:WindowsMicrosoft.NETFramework64 vInstallUtil.exe.\n**T1095 –Non-Application Layer Protocol**\n\nAdversaries may use a non-application layer protocol for communication between host\nand C2 server or among infected hosts within a network. The list of possible protocols\nis extensive.\n**T1132.001 –Standard Encoding**\n\nAdversaries may encode data with a standard data encoding system to make the\ncontent of command and control traffic more difficult to detect. Command and control\n(C2) information can be encoded using a standard data encoding system that adheres\nto existing protocol specifications. Common data encoding schemes include ASCII,\nUnicode, hexadecimal, Base64, and MIME.\n\n**VI. Recommendations**\n\n**Phishing awareness training**\n\nUsers should be informed and educated about new kinds of phishing scams currently\nbeing used and ones that have been used in the past. Awareness training should\ninstruct users to avoid suspicious emails, links, websites, attachments, etc. Users\nshould also be educated about new types of attacks and schemes to mitigate risk.\n**Recommended link:** [https://www.us-cert.gov/ncas/tips/ST04-014](https://www.us-cert.gov/ncas/tips/ST04-014)\n**Set antivirus programs to conduct regular scans**\n\nEnsure that antivirus and antimalware programs are scanning assets using up-to-date\nsignatures\n**Malware monitoring**\n\nContinuously monitor current and new types of malware. Stay up to date on intel and\nadvancements to prevent, defend, and mitigate these types of threats.\n**Strong cyber hygiene**\n\nEnforce a strong password policy across all networks and subsystems. Remind users\nto be wary of any messages asking for immediate attention, links, downloads, etc. All\nsources should be verified. Recommended link: https://uscert.cisa.gov/ncas/alerts/aa21-131a\n**Turn on endpoint protection**\n\nEnable endpoint detection and response (EDR) to stop unknown malware in the\nproduct you’re using.\n\n\n-----\n\n**Network Monitoring**\nReview network logs, payload, etc. for related IP address and associated network\nparameters.\n\n**VII. Indicators of Compromise (IOCs)**\n\n**VIII. Additional OSINT Information**\n\nEmbedded Binary\n\nhttps://www.virustotal.com/gui/file/9b2799e3fea7c214253ebba7a7cbb2b30ffe77dca6e9\n2d8d7d25b539c4e9bd7c/details\n\nMain Binary\nhttps://www.virustotal.com/gui/file/b3eba1fcd0633a5ba27ba2715ad1e38943c2bf5e6e4\n182298a3bf39492f8eca4/details\n\n\n-----\n\n[https://www.joesandbox.com/analysis/724055/0/htmL](https://www.joesandbox.com/analysis/724055/0/html)\nhttps://cert-agid.gov.it/news/scoperto-il-malware-redline-stealer-veicolato-comelastpass/\n\n**IX. Appendix**\n\nThis screenshot shows the payload sent to a victim, as seen by Cyber Florida. A portion of\nthe Base64 and UIP fields have been redacted.\n\nThe following screenshot is similar from the log above but was acquired via network packet\ncapture.\n\n**X. References**\n\nBlackpoint Cyber. “Ratting out arechclient2 – Blackpoint Whitepaper.” Blackpoint Cyber.\nAccessed November 15, 2022. https://blackpointcyber.com/lp/ratting-out-arechclient2/?\nutm_campaign=ratting_out_arechclient2_whitepaper&utm_source=resource_library.\n\nThreat Advisory created by The Cyber Florida Security Operations Center. Contributing\n_Security Analysts: Dorian Pope, Sreten Dedic, EJ Bulut, Uday Bilakhiya._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-30 - Malware with Sandbox Evasion Techniques Observed Stealing Browser Cached Credentials.pdf"
    ],
    "report_names": [
        "2022-11-30 - Malware with Sandbox Evasion Techniques Observed Stealing Browser Cached Credentials.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1677809146,
    "ts_updated_at": 1743041121,
    "ts_creation_date": 1677661920,
    "ts_modification_date": 1677661920,
    "files": {
        "pdf": "https://archive.orkl.eu/ccc0c4169fc81e4ba2a8c167c6ee3fe4756dc83c.pdf",
        "text": "https://archive.orkl.eu/ccc0c4169fc81e4ba2a8c167c6ee3fe4756dc83c.txt",
        "img": "https://archive.orkl.eu/ccc0c4169fc81e4ba2a8c167c6ee3fe4756dc83c.jpg"
    }
}