{
    "id": "0735fde1-67a3-4cc0-814a-ca9e7abb2265",
    "created_at": "2022-10-25T16:48:20.178233Z",
    "updated_at": "2025-03-27T02:17:05.614606Z",
    "deleted_at": null,
    "sha1_hash": "18e19f0aa8caf36fbb424ab650f87bb192d3434a",
    "title": "Operation Potao Express: Analysis Of A Cyber-Espionage Toolkit",
    "authors": "ESET",
    "file_creation_date": "2015-07-30T08:50:38Z",
    "file_modification_date": "2015-07-30T08:50:43Z",
    "file_size": 6548294,
    "plain_text": "# OPERATION POTAO EXPRESS\n\n## Analysis of  a cyber-espionage toolkit\n\n###### Robert Lipovsky, Anton Cherepanov\n\n\n-----\n\n#### EXECUTIVE SUMMARY\n\nThe Operation Potao Express whitepaper presents ESET’s latest findings based on research into the\nWin32/Potao malware family. Even though the malware was detected long ago by ESET and a few\nother anti-virus companies, it hasn’t received any public attention since 2011, when the first known\nsamples were detected.\n\nLike BlackEnergy (a.k.a. Sandworm, Quedagh), Potao is an example of targeted espionage (APT)\nmalware detected mostly in Ukraine and a number of other CIS countries, including Russia, Georgia\nand Belarus.\n\nAmong the victims that we were able to identify, the most notable high-value targets include\nUkrainian government and military entities and one of the major Ukrainian news agencies. The\nmalware was also used to spy on members of MMM, a financial pyramid scheme popular in Russia\nand Ukraine.\n\nOne of the most interesting discoveries during our Potao investigation and research was the\nconnection to a Russian version of the now discontinued popular open-source encryption software,\nTrueCrypt. The website truecryptrussia.ru has been serving a Russian language localized version of the\nTrueCrypt application that also contains a backdoor, in some specific cases. The trojanized version\nof the application is only served to selected victims which is another indicator of targeting by the\nmalware operators and also one the reasons why the backdoor has gone unnoticed for such a long\ntime. In addition to serving trojanized TrueCrypt, the domain also acted as a C&C server for the\nbackdoor. The connection to Potao lies in the fact that Win32/Potao has been downloaded in a few\ncases by Win32/FakeTC (ESET detection name of the trojanized encryption software).\n\nThis paper also gives additional technical details on the Win32/Potao malware family and its\nspreading mechanisms, and describes the most noteworthy attack campaigns.\n\n\n-----\n\n#### INTRODUCTION\n\nThis report gives details on a large number of attacks[1] that have been going on for the past 5 years.\nThe (seemingly) unrelated campaigns were all conducted using the Win32/Potao malware family.\nSimilarly to BlackEnergy, the malware family used by the so-called Sandworm group, the Potao\nmalware is a universal modular cyber-espionage toolkit. The attacks where it was employed were\nof the targeted (APT) type but there were also several cases where we detected the trojan in massspreading campaigns.\n\nThe countries most targeted by Potao, a malware family most probably of Russian origin, are Ukraine,\nRussia and Georgia, with some notable high-value targets.\n\nOur paper presents a timeline of the various campaigns, focusing on the spreading vectors and\nthen provides a technical analysis of the Win32/Potao trojan. We also analyze Win32/FakeTC –\na trojanized version of the popular open-source encryption software, TrueCrypt. The listed Indicators\nof Compromise include sample hashes, domain names, and C&C IP addresses.\n\n1) The title of this whitepaper, Operation Potao Express, is derived from the Win32/Potao malware family – the common denominator in all of the\ndescribed cyberattacks and from websites used in the postal-service campaigns.\n\n\n-----\n\n#### CONTENTS\n\nExecutive Summary . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . 1\n\nIntroduction .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 2\n\nList of figures . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . . 4\n\nAttack timeline .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 5\n\nCampaigns in 2011 . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . 6\n\nThe MMM campaigns . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . 7\n\nA wedding invitation in Georgia . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . 9\n\nShift of focus to Ukraine .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 9\n\nPostal-service campaigns . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 10\n\nAttacks against Ukrainian government and military .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  13\n\nTrueCrypt Russia . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . 14\n\nGeorgian campaign . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . 15\n\nWin32/Potao – Technical Analysis . .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 15\n\nInfection vectors & persistence . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . 16\n\nWin32/Potao – Architecture . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . 17\n\nPlugins overview . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . 18\n\nC&C communication protocol . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 19\n\nSpreading via USB . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . . 22\n\nWin32/Potao anti-reverse engineering techniques .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  23\n\nWin32/FakeTC – Fake TrueCrypt Analysis .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 24\n\nConclusion .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 26\n\nAppendix A – Comparison with BlackEnergy\n(the trojan used by the Sandworm / Quedagh group) . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . 27\n\nAppendix B – Details of Win32/Potao samples & Campaigns . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . 28\n\nAppendix C – Indicators of Compromise (IOC) . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . 30\n\nSHA1 hashes: . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . . . . 30\n\nDomain names: .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  32\n\nIP addresses of C&C servers: . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . 32\n\n\n-----\n\n#### LIST OF FIGURES\n\nFigure 1 – Detection statistics for Win32/Potao according to ESET LiveGrid . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . 5\n\nFigure 2 – Timeline of selected Potao campaigns . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 6\n\nFigure 3 – Example decoy document from the first Potao campaigns . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . 6\n\nFigure 4 – Armenian Ministry of Labor and Social Affairs document used as decoy in 2011 campaign . .  . .  . . . . 7\n\nFigure 5 – Decoy document from 1st MMM-related campaign . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . 7\n\nFigure 6 – Decoy document from another MMM-related campaign .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 8\n\nFigure 7 – Warning announcement on Sergei Mavrodi’s blog . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . 8\n\nFigure 8 – Win32/Potao hosted on Dropbox . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . 9\n\nFigure 9 – Georgian decoy wedding invitation .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 9\n\nFigure 10 – Debug versions of Win32/Potao . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 10\n\nFigure 11 – Legitimate Pony Express website . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 10\n\nFigure 12 – Fraudulent MNTExpress website . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 10\n\nFigure 13 – Spear-phishing SMS .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 11\n\nFigure 14 – SMS recipient seeking information on discussion forum . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . 11\n\nFigure 15 – Legitimate website of Singapore Post’s Speedpost service .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  12\n\nFigure 16 – Fraudulent WorldAirPost.com website . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . 12\n\nFigure 17 – Pop-up message “explaining” why no Excel document was opened . .  . .  . .  . .  . .  . .  . . . . . . . . 13\n\nFigure 18 – Potao droppers with MS Word icons and file names to attract the recipients‘ interest . .  . .  . .  . . . 13\n\nFigure 19 – One of the corrupted-looking decoy documents from March 5, 2015 . .  . .  . .  . .  . .  . .  . . . . . . . 13\n\nFigure 20 – Website of TrueCrypt Russia . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 14\n\nFigure 21 – Georgian decoy document .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  15\n\nFigure 22 – PDB paths containing “Potao”, “sapotao” and “node69” . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . 16\n\nFigure 23 – Patch of export function name before dropping the main DLL . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . 17\n\nFigure 24 – Win32/Potao architecture .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 17\n\nFigure 25 – GrandTorg certificate details . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . 18\n\nFigure 26 – Potao key exchange and C&C communication scheme . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . 20\n\nFigure 27 – Initial POST request sent to C&C .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  21\n\nFigure 28 – C&C server response with base64-encoded RSA-2048-signed generated RSA-2048 public key . .  . 21\n\nFigure 29 – Trick for spreading via USB removable media . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . 23\n\nFigure 30 – Loading WinAPI functions through hashes .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  23\n\nFigure 31 – String decryption algorithm . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . .  . . . . . . . . . . . . . . . . 24\n\nFigure 32 – Win32/FakeTC detections by country since June 2015, according to ESET LiveGrid . .  . .  . .  . . . . . 24\n\nFigure 33 – Trojanized Russian TrueCrypt .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  25\n\n\n-----\n\n#### ATTACK TIMELINE\n\nThe Potao malware family is not new: it was first seen used in attacks in 2011. One of the reasons\nwhy no comprehensive research on this family has been published until today might be the fact that\nbetween 2011 and 2013 the number of detections was relatively low. A significant rise in malware\nprevalence was observed by ESET LiveGrid® in 2014 and 2015 (Figure 1).\n\n400\n\n350\n\n300\n\n250\n\n200\n\n150\n\nRussia\n\n100\n\nUkraine\n\n50 Georgia\n\nBelarus\n\n0\n\n2012 2013 2014 2015\n\n_Figure 1 – Detection statistics for Win32/Potao according to ESET LiveGrid_\n\nWe omitted detection statistics for 2011 from the chart above because at that time the malware\nappeared to spread as regular crimeware, i.e. it was spreading in many different countries and\nthese waves were most probably unrelated to the targeted and semi-targeted attacks seen in the\nsubsequent years. Debugging versions detected in 2013 are also excluded from the chart.\n\nMany of the Potao campaigns in the past bear the characteristics of a targeted attack (APT). Yet,\ninterestingly, the same malware family was also used in mass infections detected on a large number\nof seemingly unrelated hosts. While this hybrid approach to malware dissemination might seem\nstrange, it has been observed before. The BlackEnergy trojan, for example, was used in targeted\nattacks against certain high-profile targets but its spreading went beyond just the few targeted\norganizations[2]. Similarly, the ‘outbreak’ of Stuxnet was the reason why the notorious malware\nwas discovered, although in that case, by mistake. From our analysis of Potao campaigns over the\npast five years, it seems that the mass-spread infections were used to test and debug the trojan in\npreparation for upcoming targeted attacks. Similar debug runs of new versions of targeted malware\nby massively infecting a wide range of ‘test victims’ is an interesting but not uncommon technique\nused by professional APT groups.\n\nThe main reason for the increase in Potao detections in 2014 and 2015 were infections through USB\ndrives.\n\n2) Either as collateral damage, or for unknown reasons.\n\n\n-----\n\n1st Potao appearance Georgian campaign Georgian campaign\n\nMAY 2011 OCT 2013 JUL 2015\n\nFake TrueCrypt\n\n1st appearance Grandtorg certificate\n\nAPR 2012 granted and subsequently revoked\n\nAUG 2014\n\nUSB Spreading\n\n1st appearance\n\nOCT 2013\n\nhigh prevalence\n\nSEP 2014 \n2011 2012 2013 2014 2015 2016\n\nWordAirpost.net\n\nJUN 2015\n\nMMM\nCampaigns\n\nMNTExpress WordAirpost.com\n\nAPR - JUN 2012 MAR 2014 MAR 2015\n\nPostal Service Campaigns\n\nArmenian\nCampaign\n\nAUG 2011 debug versions Attacks against\n\nSEP 2013 government and military\n\nMAR 2015\n\nShift to focus to Ukraine\n\n|Col1|1st Potao appearance MAY 2011 Fake TrueCrypt 1st appearance APR 2012|Georgian campaign OCT 2013 Grandtorg certificate granted and subsequently r AUG 2014 USB Spreading 1st appearance OCT 2013 high prevalence SEP 2014 -|Georgian ca JUL 2015 evoked|\n|---|---|---|---|\n\n|MMM Campaigns MNTExpress APR - JUN 2012 MAR 2014 Postal Service Camp Armenian Campaign AUG 2011 debug versions SEP 2013|WordAirpost.net JUN 2015 WordAirpost.com MAR 2015 aigns Attacks against government and militar MAR 2015|\n|---|---|\n\n\n_Figure 2 – Timeline of selected Potao campaigns_\n\nThe timeline in Figure 2 lists a selection of Potao attack campaigns and other important events,\naccording to dates when they were first detected by ESET, or by the compilation timestamps in\nthe binaries. A more comprehensive listing of representative campaigns, with their compilation\ntimestamps, unique campaign IDs[3] and malware version numbers can be found in Appendix B.\n\nLet’s take a closer look at some of the more significant campaigns.\n\n##### Campaigns in 2011\n\nThe first Potao campaign that we examined took place in August 2011. It was a mass-spreading\ncampaign[4]. The binaries used in this campaign contained an encrypted string: GlobalPotao, hence the\nname of the malware family.\n\nThe infection technique used by the first campaign, and also by campaigns in the following years, was\ntrivial, yet effective. The Potao trojan-droppers arrived (commonly via phishing emails) at victims’\nsystems in the form of executables with the icon of a Microsoft Word document, to trick the users\ninto opening them and thereby running the malware. No software exploits were needed. Apart from\nthe malicious payload, the droppers usually also contained a decoy document that was displayed to\nthe victim.[5]\n\n_Figure 3 – Example decoy document from the first Potao campaigns_\n\n3) The Campaign IDs are unique text strings used to identify individual infections or infection attempts by the Potao malware operators. The\ncombinations of letters and numbers used can sometimes reveal information about the campaign and targets. For example, a campaign with\nthe Campaign ID perm was detected in the Russian province of Perm, campaigns labeled mmmL and NMMM were most likely related to tracking\nmembers of the MMM Ponzi scheme, and so on.\n4) The outbreak of early Win32/Potao versions is mentioned in this Cisco alert\n5) This technique is a common one, also used by other malware groups and to spread other malware families, for example Korplug (PlugX).\n\n\n-----\n\nPotao droppers in another campaign detected in 2011 were using a decoy document in the Armenian\nlanguage. Interestingly, the decoy was a legitimate document that belonged to the Armenian\nMinistry of Labor and Social Affairs.\n\n_Figure 4 – Armenian Ministry of Labor and Social Affairs document used as decoy in 2011 campaign_\n\n##### The MMM campaigns\n\nMMM is one of the world’s largest Ponzi schemes of all time. We won’t go into details about the\nRussian financial pyramid and its author, as these can easily be found online.\n\nBinaries in the first detected MMM-related Potao campaign had a compilation timestamp April 27,\n2012 and a campaign ID 00km. The social-engineered decoy document pretends to be from someone\nwanting to join the pyramid scheme:\n\n_Figure 5 – Decoy document from 1st MMM-related campaign_\n\n\n-----\n\nA loose translation of the Russian text:\n\n_… I do business in the construction industry._\n\n_I’d like to invest about 500k rubles. I want to invest with a highest yield. I hope you will help me._\n\nAnother campaign detected not long after the first one used decoy documents with random Cyrillic\ncharacters. As we discovered later, the use of documents that appear corrupted, because of the\ngarbage text used, seems to be a kind of trademark for this group.\n\n_Figure 6 – Decoy document from another MMM-related campaign_\n\nThe file name in the example above was Отчет о выплате Ковалевой Александре.exe (Payment\nreport for Kovaleva Alexandra) and this time, the campaign ID actually confirms the connection to\nthe Ponzi scheme: mmmL.\n\nOn June 19, 2012, Sergei Mavrodi, the inventor of MMM, stated in a blog post that someone trying to\nimpersonate him was sending out spear phishing emails to members of MMM that contained a link\nto malware hosted on Dropbox.\n\n_Figure 7 – Warning announcement on Sergei Mavrodi’s blog_\n\n\n-----\n\n_Figure 8 – Win32/Potao hosted on Dropbox_\n\nThe filenames used were Анкета и правила or anketa_i_pravidla (Questionnaire and rules),\ncompilation timestamp June 13, 2012 and campaign ID NMMM.\n\nThe specific targeting of these campaigns suggests that the operators of the Potao malware toolkit\nwere trying to track or spy on members and/or organizers of the financial pyramid scheme.\n\n##### A wedding invitation in Georgia\n\nIn 2013 the Potao malware was also detected in Georgia. The file, compiled on October 15, 2013, was\nnamed Wedding_invitation.exe and showed the victim a decoy wedding invitation. It is interesting to\nnote that both the file name and the wedding invitation were in English.\n\n_Figure 9 – Georgian decoy wedding invitation_\n\n##### Shift of focus to Ukraine\n\nBefore we observed a rise in Win32/Potao detections in Ukraine in 2014, ESET detected several\ndebug versions of the malware in autumn 2013. We can assume that this was in preparation for the\nUkrainian targeted attacks.\n\n\n-----\n\n_Figure 10 – Debug versions of Win32/Potao[6]_\n\nOne of the campaign IDs in these debug waves was krim (Russian for Crimea).\n\n###### Postal-service campaigns\n\nIn March 2014, the gang behind Potao started using a new infection vector. They created a malicious\nlanding webpage called MNTExpress. The website was apparently inspired by the site of the\nlegitimate Russian postal service Pony Express.\n\n_Figure 11 – Legitimate Pony Express website_\n\n_Figure 12 – Fraudulent MNTExpress website_\n\n6) The text strings shown in the screenshot are not present in regular release versions of the trojan.\n\n\n-----\n\nPosing as a parcel tracking receipt or an invoice is a very common technique for spreading malware.\nInstructions to download the malicious bait are usually sent in waves of phishing emails. The Potao\ngang, however, used a different approach.\n\nThe targets of their interest were sent an SMS message that contained a link to the fraudulent\nlanding webpage, along with a specific tracking code and the recipient’s name. This approach\nindicates very specific targeting of the attacks, since:\n\n - The attackers had prior knowledge of the victims’ full names and their cellphone numbers.\n\n - The delivered binaries were tailored to the victim. In order to download a sample of Win32/Potao,\nit was necessary to enter a specific tracking code into the web form.\n\n_Figure 13 – Spear-phishing SMS_\n\nFigure 14 shows a recipient inquiring about the SMS on a Vkontakte discussion forum:\n\n_Figure 14 – SMS recipient seeking information on discussion forum_\n\n\n-----\n\nThe same infection scenario was used approximately one year later, in March 2015. This time,\nthe attackers registered the domain WorldAirPost.com and the website design was stolen from\nSingapore Post. Curiously, the attackers changed the Singapore Post logo to “Italy Post”:\n\n_Figure 15 – Legitimate website of Singapore Post’s Speedpost service_\n\n_Figure 16 – Fraudulent WorldAirPost.com website_\n\nAt the time of writing the attackers are still active, having registered WorldAirPost.net in June 2015.\nIt is also interesting to note that while the MNTExpress websites contained both Russian and English\nlanguage mutations, WorldAirPost was only in English.\n\n\n-----\n\nInterestingly, the Potao droppers served in these campaigns were not disguised as Word documents\nbut Excel spreadsheets. Also, instead of popping up a decoy document, a fake “excuse” dialog box is\nshown (Figure 17):\n\n_Figure 17 – Pop-up message “explaining” why no Excel document was opened_\n\n###### Attacks against Ukrainian government and military\n\nSince March 2015, ESET has detected Potao binaries at several high-value Ukrainian targets that\ninclude government and military entities and one of the major Ukrainian news agencies. The infection\nvector used in these attack waves was again an executable with a MS Word document icon and this\ntime cleverly chosen filenames to increase the likelihood that the recipient would open the bait:\n\n“Table of prisoners of Ukrainian armed forces on 05.03.2015”\n\n“Exempted military persons between 06.09.2014 and 05.03.2015”\n\n“Exempted from captivity for Chief of the General Staff on 05.03.2015”\n\n“List of captured during the ATO on 05.03.2015”\n\n_Figure 18 – Potao droppers with MS Word icons and file names to attract the recipients‘ interest[7]_\n\nThe topics in the file names correspond to the fact that government and military officials were\ntargeted. The decoy documents displayed once again appeared corrupted.\n\n_Figure 19 – One of the corrupted-looking decoy documents from March 5, 2015_\n\n7) The acronym ‘ATO’ refers to ‘Anti Terrorist Operation’ in Eastern Ukraine. The same theme was used to spread the BlackEnergy trojan.\n\n\n-----\n\n##### TrueCrypt Russia\n\nDuring our monitoring of the Potao botnet, we discovered infections that originated from a rather\nsuspiciously-named trojan dropper and an even more suspicious website.\n\nWe found out that instances of Win32/Potao were being launched by a dropper named\n**TrueCrypt.‌exe. That wouldn’t be too surprising, since malware operators often use file names**\nthat resemble legitimate applications, but in this case the dropper was a binary of the actual, now\ndiscontinued, TrueCrypt encryption software. Investigating further, we discovered that not only was\nthe Potao malware installed by a trojanized version of TrueCrypt but it had also been downloaded\nfrom the website truecryptrussia.ru, which offers downloads of the abovementioned TrueCrypt\nbinaries. Finally, we discovered that the domain in question was also used as a malware C&C server,\nand thus truecryptrussia.ru being a fraudulent website operated by the attackers seems to be the\nlikelier explanation than merely being a legitimate website compromised by them.\n\nTo sum it up, the website and software of “TrueCrypt Russia” was found guilty of:\n\n1. \u0007Hosting trojanized (backdoored) versions of the TrueCrypt encryption software.\n(See the Win32/FakeTC section for a technical analysis of the backdoor.)\n2. Hosting the Win32/Potao malware.\n3. Acting as a C&C server for abovementioned trojanized TrueCrypt.\n\nNote, however, that not every download of the TrueCrypt software from the Russian website is\nmalicious or contains a backdoor. The malicious versions of the software are served only to selected\nvisitors, based on unknown specific criteria. This lends additional evidence to the view that the\noperation is run by a professional gang that selectively targets their espionage victims.\n\n_Figure 20 – Website of TrueCrypt Russia_\n\nAccording to ESET’s LiveGrid® telemetry, the Russian TrueCrypt website has been serving malware\nsince at least June 2012. The served binaries‘ timestamps date the earliest trojans to April 2012.\n\n\n-----\n\n##### Georgian campaign\n\nAs confirmation that the malware writers are still very active even at the time of this writing, ESET\ndetected a new Potao sample compiled on July 20, 2015. The file was targeted (and detected) against\na victim in Georgia. Unlike the previous campaigns, the displayed decoy was not a Word document\nbut a PDF file.\n\n_Figure 21 – Georgian decoy document_\n\n#### WIN32/POTAO – TECHNICAL ANALYSIS\n\nIn this section we’ll describe the technical aspects of the Win32/Potao trojan, from the malware\narchitecture, C&C communication, analysis of plugins, and description of infection vectors, including\nUSB spreading functionality, to the anti-reverse engineering techniques used.\n\nFrom a functional, high-level perspective, the malware family shares many common characteristics\nwith the BlackEnergy trojan. A feature comparison with BlackEnergy can be found in Appendix A\nand Indicators of Compromise (IoC) are listed in Appendix C. The following paragraphs present an\noverview of Win32/Potao functionality, focusing on its unique features.\n\nBefore we move on to the actual analysis of the malware, let’s look at where the family got its name.\nThe malware binaries from the first detected campaign contained an encrypted string GlobalPotao.\nIn other samples of the same family that ESET detected throughout the years, the malware has also\ngone by the names Sapotao and node69 as seen in its own DLL filenames names and PDB paths left\ninside the binaries:\n\n\n-----\n\n_Figure 22 – PDB paths containing “Potao”, “sapotao” and “node69”_\n\nThe Potao family is a typical cyberespionage trojan, and as such it implements all the necessary\nfunctionality to exfiltrate sensitive information from the infected user’s system and send it to the\nattackers’ remote server.\n\n##### Infection vectors & persistence\n\nSimilarly to most other trojan families, Win32/Potao arrives at the victim’s computer system\nin the form of a trojan dropper that acts as an “installer” for the malware. We have observed\nseveral infection vectors used to distribute the trojan, as described in the Attack timeline section.\nTo summarize:\n\n - Executables masquerading as Word, Excel, and PDF documents. These were propagated through\n\nfake postal service websites and SMS links, and possibly also through phishing emails\n\n - Worm-like USB spreading functionality\n\n - Fake TrueCrypt software – see Win32/FakeTC for the technical analysis\n\nThe dropper itself is usually in two stages. The first stage, for example, in the form of an executable\nwith an icon of a MS Word document, merely drops the second stage dropper into the %temp%\ndirectory, executes it, and at the same time drops the embedded decoy document into the current\nworking directory and opens it.\n\nThe second stage dropper unpacks the main DLL from within itself using RtlDecompressBuffer.\nThe DLL is dropped to the following path, loaded and injected into explorer.exe:\n\n**%APPDATA%\\Microsoft\\%LUID%.dll[8]**\n\nBefore the DLL is dropped to the drive, however, a simple trick is applied. The Potao dropper patches\nthe name of the Enter export function in the DLL file’s export address table to the LUID value. Figure\n23 shows the patching function and an example where Enter was renamed to _85fc. As a result, every\ndropped instance of the DLL will have a unique binary hash.\n\n8) %LUID% signifies the LUID structure, which is used as a unique identifier for the infected bot\n\n\n-----\n\n_Figure 23 – Patch of export function name before dropping the main DLL_\n\nThe trojan uses standard methods for loading its DLL – via rundll32.exe – and for maintaining\npersistence, by setting the Run registry entry:\n\n**[HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run] %LUID%**\n\n##### Win32/Potao – Architecture\n\nThe Potao trojan features a modular architecture and its functionality can be expanded with\nadditional downloadable plugins.\n\n###### plugin chrome.exe\n iexplore.exe C&C Skype.exe\n explorer.exe Opera.exe\n plugin\n firefox.exe uTorrent.exe safari.exe plugin\n\n\n###### \\\\.\\pipe\\\\%name%\n\n\n_Figure 24 – Win32/Potao architecture_\n\n\n-----\n\nWhen the malware is installed, its main DLL will be injected into the explorer.exe process. After\nhaving passed a mutex check, this instance will try to inject itself into the address space of several\nrunning legitimate and Internet-facing processes (browsers, Skype and uTorrent). With this setup,\nthe instance injected within explorer.exe is responsible for loading and communicating with the\nPotao plugins, while the instances within the Internet-facing processes takes care of communication\nwith the C&C server. The two instances communicate via a named pipe.\n\n##### Plugins overview\n\nThe Potao main DLL only takes care of its core functionality; the actual spying functions are\nimplemented in the form of downloadable modules. The plugins are downloaded each time\nthe malware starts, since they aren’t stored on the hard drive.\n\nWin32/Potao supports two types of plugins. The first type is Full Plugin[9] and its export function is\ncalled Plug. The second is Light Plugin with an export function Scan. The difference between the two\ntypes is how they execute and return desired information. Full plugins run continuously until the\ninfected system is restarted, while Light plugins terminate immediately after returning a buffer with\nthe information they harvested off the victim’s machine.\n\nIt is worth mentioning that some of the plugins we observed during our monitoring of the Potao\nbotnet were signed with a certificate issued to “Grandtorg”:\n\n_Figure 25 – GrandTorg certificate details_\n\nThe name “Grand Torg” sounds like “Great Market” in Russian, a rather common term; we\nweren’t able to identify an institution with that name. The certificate Serial Number is:\n**0453B96EB039AFD6C9988C8CB698E7C9 and its effective Revocation Time: Aug 19 00:00:00**\n**2014 GMT**\n\nSince the Revocation Time is the same as the Valid from time, all signatures made with this certificate\nhave been rendered invalid after the revocation request was issued. This strongly suggests that\nthe certificate has only been used for nefarious purposes, as opposed to having been stolen from a\nlegitimate company.\n\nTable 1 contains a list of Potao plugins that we have encountered[10].\n\n9) “Full Plugin” and “Light Plugin” are terms used by the actual malware authors in debug builds of the trojan.\n10) It is quite possible that we have not seen all existing plugins, so the list may be incomplete.\n\n\n-----\n\nFilename Type Description\n\nGetAllSystemInfo.dll Light Collects various kinds of system information, including: system\nidentifying information, proxy and language settings, lists of\nprocesses, installed software, recently opened files, and so on.\n\nGetAllSystemInfo.dll Light This plugin contains different functionality from the other plugin\nwith the same file name. It collects browsing history from Google\nChrome, Mozilla Firefox and Opera.\n\nFilePathStealer.dll Full Enumerates all drives and creates a list of potentially interesting\nfiles: images and documents. The plugin searches for files with\nthe following extensions: JPG, BMP, TIFF, PDF, DOC, DOCX, XLS,\nXLSX, ODT, ODS.\n\ntask-diskscanner.dll Full Like the FilePathStealer.dll plugin, this one also enumerates\npotentially interesting files. It looks for document extensions and\ncommon history, settings and cookie files belonging to Internet\nbrowsers. After the search, the found files are sent to the C&C.\n\nKeyLog2Runner.dll Full Logs key strokes & clipboard data from most common Internet\nbrowsers and Skype.\n\nPasswordStealer.dll Light Decrypts and steals passwords and settings from different\nbrowsers and email clients.\n\nScreen.dll Light Captures screenshots.\n\nPoker2.dll Light Disables spreading through USB drives, deletes specific Registry\nkeys, and kills processes belonging to the malware.\n\nloader-updater.dll Light Updates the trojan.\n\n_Table 1 – Win32/Potao plugins_\n\n##### C&C communication protocol\n\nThe Win32/Potao samples that we’ve analyzed contained several different C&C IP addresses\nencrypted in their bodies. For example one sample had the following hard-coded list of IPs, after\ndecryption:\n\n**87.106.44.200:8080**\n**62.76.42.14:443**\n**62.76.42.14:8080**\n**94.242.199.78:443**\n**178.239.60.96:8080**\n**84.234.71.215:8080**\n**67.103.159.141:8080**\n**62.76.184.245:80**\n**62.76.184.245:443**\n**62.76.184.245:8080**\n\nThe malware randomly picks one of these IP addresses and makes an attempt to establish a\nconnection. As can be seen from the ports in the list above, the HTTP or HTTPs protocols can be used\nfor communication with the remote server.\n\nThe communication uses strong cryptography in two stages. The first stage is the key exchange and\nthe second stage is the actual exchange of data. This simple yet secure communication scheme is\nexplained in Figure 26.\n\n\n-----\n\n_Figure 26 – Potao key exchange and C&C communication scheme_\n\n\n-----\n\nWhen the malware first contacts the C&C server (1) it sends a POST-request as shown in the example\nin Figure 27. The data sent is encapsulated using the XML-RPC protocol. Interestingly, the used\n_methodName value 10a7d030-1a61-11e3-beea-001c42e2a08b is always present in Potao traffic that_\nwe’ve analyzed.\n\n_Figure 27 – Initial POST request sent to C&C_\n\nAfter receiving the request the C&C server generates an RSA-2048 public key (2) and signs this\ngenerated key with another, static RSA-2048 private key (3).\n\nFigure 28 shows an example server response (4):\n\n_Figure 28 – C&C server response with base64-encoded RSA-2048-signed generated RSA-2048 public key_\n\nWhen the malware receives this new RSA-2048 key it performs a signature verification using a\ncorresponding static public key, which is embedded in the binary (5). If the signature is correct then\nthe newly-received generated public key (6) will be used to encrypt the next step in communication.\n\n\n-----\n\nThe embedded static RSA-2048 public key:\n\n**-----BEGIN PUBLIC KEY-----**\n**MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApiLYPP8Z2BPuAqq4IzJ9**\n**TdSwDFl7IcuHidKRrxyEl8YtbD0rqmPhBL1R50gl5/rUYuT87rhWhvBGUTXxRv4u**\n**Ga7YIs9r0ymdQtmjAXDvbY01U51mK+Hm7894diVBhQ46sznudrJSz82VJXzbZ9NN**\n**fBUFiDQFj5DijnZJfeR/Jb/DD9oRT+UJNeV1KIQeLZDUFHkC+Vp837roAprSyJpR**\n**005EtiBgSQ7KO9GSKqxqzE5htdMX74n4kwmw/vRGi/c66a7/XlvCW1l0SWxowXO0**\n**xqje04bbjzF9CINcvDBuVxlFznCOw5+1MUlO38lHJEpTrrQKSeMBSqMPunVF25At**\n**KQIDAQAB**\n**-----END PUBLIC KEY-----**\n\nIn the second stage the malware generates a symmetric AES-256 key (7). This AES session key is\nencrypted with the newly received RSA-2048 public key (8) and sent to the C&C server (9).\n\nThe actual data exchange (13) after the key exchange is then encrypted using symmetric\ncryptography, which is faster, with the AES-256 key (12).\n\nLeaving aside the trojan’s implementation of cryptography the actual communication protocol is\nvery simple. The malware sends an encrypted request to the server, as illustrated by the following\n(decrypted) example:\n\n**id=4699807581825067201mapt&code=0&sdata=ver:5.1.2600 lv:2.8.0002 comp:COMPUTER**\n**adm:1 x:0 p:firefox.exe&md5=&dlen=0**\n\nThis request contains a computer ID, campaign ID, OS version, version of malware, computer name,\ncurrent privileges, OS architecture (64 or 32bits) and also the name of the current process.\n\nThe server responds with the following data:\n\n**code=%CMD%&data=%PAYLOAD_BASE64_ENCODED%&dlen=%PAYLOAD_LENGTH%&md5=%MD5%**\n\nThe code value represents the type of command that the bot is instructed to execute. The possible\ncommands are listed in Table 2:\n\nCommand Description\n\n2 Drop executable to %TEMP% and execute via CreateProcess function\n\n3 Execute plugin module\n\n4 Drop executable to %TEMP% and execute via ShellExecuteEx function\n\n0 or 8 or any other Dummy command\n\n_Table 2 – Win32/Potao C&C commands_\n\n##### Spreading via USB\n\nIn several spreading campaigns, the Potao gang has used an additional vector to disseminate the\nmalware: through USB drives.\n\nWhile so-called Autorun-worms[11] used to be quite common, Win32/Potao took a different approach\nto USB infections. Instead of dropping an autorun.inf file to the root folder of removable drives, the\nUSB spreading component of Potao uses a different, simple yet effective trick to store its executable\non the USB media. The code responsible for USB infections will copy the Win32/Potao dropper into\nthe root directory of all removable media drives. The filename is selected to match the disk label and\nthe icon for removable media devices is used. At the same time, all other files and folders that were\nalready present on the drive have their attributes set to Hidden and System.\n\n11) Worms that misused the Windows AutoPlay functionality through autorun.inf files\n\n\n-----\n\n_Figure 29 – Trick for spreading via USB removable media_\n\nIn effect, with the default Windows settings of hiding file extensions, the user will only see a disk\ndrive icon with the same label as the actual USB drive in Windows Explorer. This social engineering\ntrick has fooled a number of victims into “willingly” running the malware.\n\n##### Win32/Potao anti-reverse engineering techniques\n\nThe Potao trojan implements several tricks to make the analysis of the malware harder for reverseengineers. One of them is using hashes of WinAPI functions instead of their names:\n\n_Figure 30 – Loading WinAPI functions through hashes_\n\nThis trick is commonly used among various malware families in different implementations; the Potao\nmalware uses the MurmurHash2 algorithm for computing the hashes of the API function names.\n\nAnother trick implemented in the malware is encryption of strings. The decompiled decryption\nalgorithm is shown in Figure 31.\n\n\n-----\n\n_Figure 31 – String decryption algorithm_\n\nThe strings are encrypted using an XOR operation with 4-byte length key. This key may be different\nin different samples.\n\n#### WIN32/FAKETC – FAKE TRUECRYPT ANALYSIS\n\nThe malware described in this section is a different family altogether from Win32/Potao. In this\nsection we describe how the trojanized version of the open-source TrueCrypt software is used to\nexfiltrate files from the espionage victims’ encrypted drives. The relation to Potao is explained in an\nearlier section of the whitepaper.\n\n_Figure 32 – Win32/FakeTC detections by country since June 2015, according to ESET LiveGrid_\n\n\n-----\n\nFigure 33 shows the interface of the trojanized Russian TrueCrypt application.\n\n_Figure 33 – Trojanized Russian TrueCrypt_\n\nThe malicious program code within the otherwise functional TrueCrypt software runs in its own\nthread. This thread, created at the end of the Mount function, enumerates files on the mounted\nencrypted drive, and if certain conditions are met, it connects to the C&C server, ready to execute\ncommands from the attackers.\n\nThe backdoor functionality is only contained within the application’s GUI modules; the digitally signed\nTrueCrypt drivers remained intact.\n\nThe conditions that must be satisfied before the bot contacts the C&C server for commands are:\n\n - The number of files on the encrypted drive has to be greater than 10\n\n - The encrypted drive must have been mounted at least 4 times\n\nThe available commands are listed in Table 3:\n\nCommand Description\n\nidle Sleep for 1 second\n\nwho Collect Windows version, Computer name, Username\n\nlist Enumerate files on all disks (skipping C:\\Windows and *.exe, *.dll)\n\nlistContainer Enumerate files on mounted container\n\nrep Steal password for encrypted container\n\nfile Steal file\n\nfilem Steal file by mask\n\nre Download and execute file\n\nrd Download and execute DLL file (plugin) without storing on disk\n\n_Table 3 – Win32/FakeTC C&C commands_\n\n\n-----\n\nAs can be seen from the available commands, the Win32/FakeTC malware is a fully featured\nespionage trojan with the ability to extend its capabilities with downloadable plugins. Also, the\nimplemented stealth techniques – serving the trojanized version only to selected targets, and only\nactivating the malicious functionality for active, long-term TrueCrypt users – are probably the\nreasons why the malware has been undetected for so long.\n\n#### CONCLUSION\n\nIn the previous pages we have presented our findings based on ESET detection telemetry and our\nanalysis of Win32/Potao and Win32/FakeTC samples. Potao is another example of targeted espionage\nmalware, a so-called APT, to use the popular buzzword, although technically the malware is not\nparticularly advanced or sophisticated.\n\nOn the contrary, the Potao gang has demonstrated that long-running, effective cyber-espionage can\nbe carried out through carefully devised tricks and social-engineering, without the need for exploits.\nExamples of notable Potao dissemination techniques, some of which were previously unseen, or at\nleast relatively uncommon, include the use of highly-targeted spear-phishing SMS messages to drive\npotential victims to malware download sites and USB worm functionality that tricked the user into\n‘willingly’ executing the trojan.\n\nBut perhaps the most intriguing discovery was the connection to the trojanized Russian version of\npopular TrueCrypt encryption software and the truecryptrussia.ru website that both served TrueCrypt\nwith an added backdoor to selected targets, and also acted as a malware C&C server.\n\nAll of the findings presented in this paper indicate very “APT-like” behavior and specific targeting of\nvictims by the Potao operators. The open question remains: who might be interested in spying on\nboth Ukrainian government and military entities, a news agency, members of a Ponzi scheme popular\nin Russia and Ukraine, and other victims – known and unidentified?\n\nSince we don’t like to speculate without hard evidence, we’ll leave the question of attribution for an\nopen discussion. Nevertheless, the facts are that several high-value Ukrainian targets were targeted\nby the malware, along with a significant number of victims in other CIS countries, including Russia.\n\n\n-----\n\n#### APPENDIX A – COMPARISON WITH BLACKENERGY (THE TROJAN USED BY THE SANDWORM / QUEDAGH GROUP)\n\nPotao BlackEnergy\n\n1[st] appearance 2011 2007\n\nESET detection Win32/Potao Win32/Rootkit.BlackEnergy\nname\n\nAliases Sapotao, node69 Sandworm, Quedagh\n\nTargeting Targeted, mass-spreading debug Targeted, but also detected on\nversions computers of a large number of\nvictims\n\nMost targeted Ukraine, Russia, Georgia Ukraine, Poland\ncountries\n\n\nNotable targets Ukrainian government & military\ninstitutions, news agency, members\nof MMM pyramid scheme, and others\n\nDistribution Spear-phishing, SMS, postal websites,\nvectors executables masquerading as Word\nor Excel docs, USB worm, trojanized\nTrueCrypt\n\n\nUkrainian government & military\ninstitutions, companies and\nindividuals in Ukraine and Poland\n\nSpear-phishing, documents with\nexploits (RTF CVE-2014-1761, PPTS\nCVE-2014-4114, …), executables\nmasquerading as Word or Excel docs,\nparasitic virus, network spreading,\ninfected Juniper installers, Java,\nTeamViewer, …\n\n\nArchitecture Modular with downloadable plugins Modular with downloadable plugins\n\n\nDiscovered plugins File stealer, system information\ncollector, password stealer, screen\ngrabber, key logger, malware updater,\nUSB worm component\n\n\nFile stealer, system information\ncollector, password stealer, screen\ngrabber, key logger, malware\nupdater, network discovery & remote\nexecution, parasitic infector, system\ndestroyer, remote login, and so on.\n\n\nUse of exploits no Yes, including 0-days (CVE-2014-4114)\n\nRootkit, driver no Yes, in early versions. Not in\ncomponent BlackEnergy Lite (v3) variant.\n\n\nWindows MUI abuse, bypassing\nUAC through shims (MACT), config\nas X.509 certificate, remote access\nwhen TeamViewer installed, use of\nPowerPoint 0-day exploit (CVE2014-4114) for spreading, trojandownloaders for SCADA ICS systems\n\n\nNotable\ntechniques and\nfeatures\n\nC&C\ncommunication\nencryption\n\n\nTrojanized TrueCrypt, USB spreading\nmechanism, DLL export function\nname patch\n\n\nAES and RSA-2048 Modified RC4\n\n\n_Table 4 – Similarities and differences between Win32/Potao and Win32/Rootkit.BlackEnergy_\n\n\n-----\n\n#### APPENDIX B – DETAILS OF WIN32/POTAO SAMPLES & CAMPAIGNS\n\nMain DLL PE timestamp Main DLL Version Campaign ID\n\nApr 27 09:13:23 2012 0 00km\n\nMay 12 14:01:30 2012 2 mmmL\n\nJun 13 09:11:58 2012 2 NMMM\n\nOct 22 13:35:02 2012 2.3 GEUN\n\nNov 13 14:54:20 2012 2.4 _NAK\n\nDec 05 10:37:14 2012 2.4 ANOS\n\nApr 28 11:10:29 2013 2.6 2804\n\nMay 30 10:42:17 2013 2.6 _nal\n\nJun 26 16:53:02 2013 2.6 _b01\n\nJul 02 12:28:08 2013 2.6 sb01\n\nAug 27 14:26:59 2013 2.6 perm\n\nOct 15 09:31:32 2013 2.6 o003\n\nOct 16 09:55:46 2013 2.6 sb02\n\nOct 18 16:10:47 2013 2.6 psih\n\nNov 19 11:14:04 2013 2.6 ber1\n\nNov 19 11:31:59 2013 2.6 us11\n\nFeb 19 09:30:06 2014 2.7 t001\n\nApr 08 12:40:43 2014 2.6 ap01\n\nAug 21 10:54:56 2014 2.7 rk02\n\nAug 21 14:58:34 2014 2.7 rk02\n\nSep 02 12:39:46 2014 2.7 mt01\n\nSep 02 14:22:20 2014 2.7 mtu2\n\nOct 10 12:38:22 2014 2.7 mt01\n\nOct 15 15:16:44 2014 2.7 tk02\n\nOct 15 15:22:49 2014 2.7 comm\n\nOct 15 15:26:19 2014 2.7 rk02\n\nOct 15 15:51:31 2014 2.7 mtu2\n\nOct 31 14:58:01 2014 2.7 mt01\n\nNov 07 14:10:38 2014 2.7 rk03\n\nNov 10 13:00:43 2014 2.7 mtu3\n\nNov 11 13:46:58 2014 2.7 udif\n\nNov 13 11:14:22 2014 2.7 vou0\n\nNov 19 11:16:33 2014 2.7 rk03\n\nNov 20 12:29:01 2014 2.7 udif\n\nNov 20 12:32:06 2014 2.7 mtu3\n\nNov 21 13:09:55 2014 2.7 rk03\n\nDec 06 09:31:38 2014 2.8.0001 mt10\n\nDec 08 13:51:03 2014 2.8.0001 rk0S\n\nDec 15 12:05:05 2014 2.8.0001 rk0S\n\nDec 17 10:02:00 2014 2.8.0001 mtuS\n\nDec 18 09:58:06 2014 2.8.0001 udi2\n\nDec 18 12:53:18 2014 2.8.0001 rko3\n\n\n-----\n\nMain DLL PE timestamp Main DLL Version Campaign ID\n\nJan 20 15:23:34 2015 2.8.0001 vouF\n\nJan 20 15:27:46 2015 2.8.0001 dpcF\n\nJan 23 10:39:28 2015 2.8.0001 dpcu\n\nFeb 17 13:07:24 2015 2.8.0002 dpcF\n\nFeb 17 13:30:10 2015 2.8.0002 rk0F\n\nMar 03 16:26:36 2015 2.8.0002 ufbi\n\nMar 06 13:33:07 2015 2.8.0002 ufbi\n\nMar 13 12:42:14 2015 2.8.0002 dpcF\n\nApr 16 13:18:08 2015 2.8.0002 mapt\n\nApr 23 15:43:31 2015 2.8.0002 mapt\n\nApr 28 08:27:04 2015 2.8.0002 mapt\n\nMay 20 09:27:20 2015 2.8.0002 mapF\n\nMay 20 10:21:14 2015 2.8.0002 tk03\n\nJun 18 10:55:49 2015 2.8.0002 mapt\n\nJul 16 18:26:08 2015 2.8.0002 mapt\n\nJul 20 09:16:21 2015 2.8.0002 bhaz\n\n_Table 5 – Win32/Potao sample details_\n\n\n-----\n\n#### APPENDIX C – INDICATORS OF COMPROMISE (IOC)\n\nUsers of ESET security software are fully protected from the Potao malware described in this\npaper. Additionally, ESET will provide further information regarding this threat to any individuals or\norganizations that may be infected – either currently or in the past.\n\nContact email: threatintel@eset.com\n\nFor convenience, we also uploaded the Potao IOCs to github: https://github.com/eset/malware-ioc/\ntree/master/potao\n\n##### SHA1 hashes:\n\n###### Early Potao versions:\n\n**8839D3E213717B88A06FFC48827929891A10059E**\n\n**5C52996D9F68BA6FD0DA4982F238EC1D279A7F9D**\n\n**CE7F96B400ED51F7FAB465DEA26147984F2627BD**\n\n**D88C7C1E465BEA7BF7377C08FBA3AAF77CBF485F**\n\n**81EFB422ED2631C739CC690D0A9A5EAA07897531**\n\n**18DDCD41DCCFBBD904347EA75BC9413FF6DC8786**\n\n**E400E1DD983FD94E29345AABC77FADEB3F43C219**\n\n**EB86615F539E35A8D3E4838949382D09743502BF**\n\n**52E59CD4C864FBFC9902A144ED5E68C9DED45DEB**\n\n**642BE4B2A87B47E77814744D154094392E413AB1**\n\n###### Debug versions:\n\n**BA35EDC3143AD021BB2490A3EB7B50C06F2EA40B**\n\n**9D584DE2CCE6B654E62573938C2C824D7CC7D0EB**\n\n**73A4A6864EF68C810C7C699ED51B759CF1C4ADFB**\n\n**1B3437C06CF917920688B25DA0345749AA1A4A46**\n\n###### Droppers with decoy documents:\n\n**FBB399568E0A3B2E461A4EB3268ABDF07F3D5764**\n\n**4D5E0808A03A75BFE8202E3A6D2920EDDBFC7774**\n\n**BCC5A0CE0BCDFEA2FD1D64B5529EAC7309488273**\n\n**F8BCDAD02DA2E0223F45F15DA4FBAB053E73CF6E**\n\n**2CDD6AABB71FDB244BAA313EBBA13F06BCAD2612**\n\n**9BE3800B49E84E0C014852977557F21BCDE2A775**\n\n**4AC999A1C54AE6F54803023DC0FCF126CB77C854**\n\n**59C07E5D69181E6C3AFA7593E26D33383722D6C5**\n\n**E15834263F2A6CCAE07D106A71B99FE80A5F744B**\n\n**A62E69EF1E4F4D48E2920572B9176AEDB0EEB1C6**\n\n**900AD432B4CB2F2790FFEB0590B0A8348D9E60EB**\n\n**856802E0BD4A774CFFFE5134D249508D89DCDA58**\n\n**A655020D606CA180E056A5B2C2F72F94E985E9DB**\n\n**04DE076ACF5394375B8886868448F63F7E1B4DB9**\n\n\n-----\n\n###### Droppers from postal websites:\n\n**94BBF39FFF09B3A62A583C7D45A00B2492102DD7**\n\n**F347DA9AAD52B717641AD3DD96925AB634CEB572**\n\n**A4D685FCA8AFE9885DB75282516006F5BC56C098**\n\n**CC9BDBE37CBAF0CC634076950FD32D9A377DE650**\n\n**B0413EA5C5951C57EA7201DB8BB1D8C5EF42AA1E**\n\n**0AE4E6E6FA1B1F8161A74525D4CB5A1808ABFAF4**\n\n**EC0563CDE3FFAFF424B97D7EB692847132344127**\n\n**639560488A75A9E3D35E4C0D9C4934295072DD89**\n\n###### USB-spreaders:\n\n**850C9F3B14F895AAA97A85AE147F07C9770FB4C7**\n\n**BB0500A24853E404AD6CA708813F926B90B38468**\n\n**71A5DA3CCB4347FE785C6BFFF7B741AF80B76091**\n\n**7664C490160858EC8CFC8203F88D354AEA1CFE43**\n\n**92A459E759320447E1FA7B0E48328AB2C20B2C64**\n\n**BB7A089BAE3A4AF44FB9B053BB703239E03C036E**\n\n**DB966220463DB87C2C51C19303B3A20F4577D632**\n\n**37A3E77BFA6CA1AFBD0AF7661655815FB1D3DA83**\n\n**181E9BCA23484156CAE005F421629DA56B5CC6B5**\n\n**A96B3D31888D267D7488417AFE68671EB4F568BD**\n\n**224A07F002E8DFB3F2B615B3FA71166CF1A61B6D**\n\n**5D4724FBA02965916A15A50A6937CDB6AB609FDD**\n\n**8BE74605D90ED762310241828340900D4B502358**\n\n**5BE1AC1515DA2397A7C52A8B1DF384DD938FA714**\n\n**56F6AC6197CE9CC774F72DF948B414EED576B6C3**\n\n**F6F290A95D68373DA813782EF4723E39524D048B**\n\n**48904399F7726B9ADF7F28C07B0599717F741B8B**\n\n**791ECF11C04470E9EA881549AEBD1DDED3E4A5CA**\n\n**E2B2B2C8FB1996F3A4A4E3CEE09028437A5284AE**\n\n**5B30ECFD47988A77556FE6C0C0B950510052C91E**\n\n**4EE82934F24E348696F1C813C24797618286A70C**\n\n**B80A90B39FBA705F86676C5CC3E0DECA225D57FF**\n\n**971A69547C5BC9B711A3BB6F6F2C5E3A46BF7B29**\n\n**C1D8BE765ADCF76E5CCB2CF094191C0FEC4BF085**\n\n**2531F40A1D9E50793D04D245FD6185AAEBCC54F4**\n\n\n-----\n\n###### Other droppers:\n\n**D8837002A04F4C93CC3B857F6A42CED6C9F3B882**\n\n**BA5AD566A28D7712E0A64899D4675C06139F3FF0**\n\n**FF6F6DCBEDC24D22541013D2273C63B5F0F19FE9**\n\n**76DA7B4ABC9B711AB1EF87B97C61DD895E508232**\n\n**855CA024AFBA0DC09D336A0896318D5CC47F03A6**\n\n**12240271E928979AB2347C29B5599D6AC7CD6B8E**\n\n**A9CB079EF49CEE35BF68AC80534CBFB5FA443780**\n\n**1B278A1A5E109F32B526660087AEA99FB8D89403**\n\n**4332A5AD314616D9319C248D41C7D1A709124DB2**\n\n**5BEA9423DB6D0500920578C12CB127CBAFDD125E**\n\n###### Plugins:\n\n**2341139A0BC4BB80F5EFCE63A97AA9B5E818E79D**\n\n**8BD2C45DE1BA7A7FD27E43ABD35AE30E0D5E03BC**\n\n**54FEDCDB0D0F47453DD65373378D037844E813D0**\n\n**CC3ECFB822D09CBB37916D7087EB032C1EE81AEE**\n\n**F1C9BC7B1D3FD3D9D96ECDE3A46DFC3C33BBCD2B**\n\n**9654B6EA49B7FEC4F92683863D10C045764CCA86**\n\n**526C3263F63F9470D08C6BA23E68F030E76CAAF3**\n\n**E6D2EF05CEDCD4ABF1D8E3BCAF48B768EAC598D7**\n\n**CEBAB498E6FB1A324C84BA267A7BF5D9DF1CF264**\n\n**324B65C4291696D5C6C29B299C2849261F816A08**\n\n**C96C29252E24B3EEC5A21C29F7D9D30198F89232**\n\n**CDDDE7D44EFE12B7252EA300362CF5898BDC5013**\n\n**84A70CDC24B68207F015D6308FE5AD13DDABB771**\n\n###### Fake TrueCrypt setup:\n\n**82F48D7787BDE5B7DEC046CBEF99963EEEB821A7**\n\n**9666AF44FAFC37E074B79455D347C2801218D9EA**\n\n**C02878A69EFDE20F049BC380DAE10133C32E9CC9**\n\n**7FBABEA446206991945FB4586AEE93B61AF1B341**\n\n###### Fake TrueCrypt extracted exe:\n\n**DCBD43CFE2F490A569E1C3DD6BCA6546074FD2A1**\n\n**422B350371B3666A0BD0D56AEAAD5DEC6BD7C0D0**\n\n**88D703ADDB26ACB7FBE35EC04D7B1AA6DE982241**\n\n**86E3276B03F9B92B47D441BCFBB913C6C4263BFE**\n\n\n-----\n\n##### Domain names:\n\n**truecryptrussia.ru**\n\n**mntexpress.com**\n\n**worldairpost.com**\n\n**worldairpost.net**\n\n**camprainbowgold.ru**\n\n**poolwaterslide2011.ru**\n\n##### IP addresses of C&C servers:\n\n**78.47.218.234**\n\n**95.86.129.92**\n\n**115.68.23.192**\n\n**67.18.208.92**\n\n**37.139.47.162**\n\n**212.227.137.245**\n\n**62.76.189.181**\n\n**87.106.44.200**\n\n**62.76.42.14**\n\n**94.242.199.78**\n\n**178.239.60.96**\n\n**84.234.71.215**\n\n**67.103.159.141**\n\n**62.76.184.245**\n\n**83.169.20.47**\n\n**148.251.33.219**\n\n**98.129.238.97**\n\n**195.210.28.105**\n\n**198.136.24.155**\n\n\n**46.165.228.130**\n\n**192.154.97.239**\n\n**5.44.99.46**\n\n**188.240.46.1**\n\n**81.196.48.188**\n\n**74.54.206.162**\n\n**69.64.72.206**\n\n**74.208.68.243**\n\n**46.163.73.99**\n\n**193.34.144.63**\n\n**103.3.77.219**\n\n**119.59.105.221**\n\n**188.40.71.188**\n\n**188.40.71.137**\n\n**108.179.245.41**\n\n**64.40.101.43**\n\n**190.228.169.253**\n\n**194.15.126.123**\n\n**188.127.249.19**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/hji6y2fi3nwqbd8mtx6kiy6yckizwq2w",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.07.30.Operation-Potao-Express/Operation-Potao-Express_final_v2.pdf",
        "https://www.welivesecurity.com/wp-content/uploads/2015/07/Operation-Potao-Express_final_v2.pdf",
        "http://www.welivesecurity.com/wp-content/uploads/2015/07/Operation-Potao-Express_final_v2.pdf"
    ],
    "report_names": [
        "Operation-Potao-Express_final_v2",
        "Operation-Potao-Express_final_v2.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4a892faf-3d4d-4615-b7b6-cdbc2ce42d8d",
            "created_at": "2022-10-25T16:07:23.99045Z",
            "updated_at": "2025-03-27T02:02:10.06504Z",
            "deleted_at": null,
            "main_name": "Operation Potao Express",
            "aliases": [],
            "source_name": "ETDA:Operation Potao Express",
            "tools": [
                "FakeTC",
                "Patao"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1438246238,
    "ts_modification_date": 1438246243,
    "files": {
        "pdf": "https://archive.orkl.eu/18e19f0aa8caf36fbb424ab650f87bb192d3434a.pdf",
        "text": "https://archive.orkl.eu/18e19f0aa8caf36fbb424ab650f87bb192d3434a.txt",
        "img": "https://archive.orkl.eu/18e19f0aa8caf36fbb424ab650f87bb192d3434a.jpg"
    }
}