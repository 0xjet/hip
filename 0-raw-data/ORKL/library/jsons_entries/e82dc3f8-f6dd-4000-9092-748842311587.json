{
    "id": "e82dc3f8-f6dd-4000-9092-748842311587",
    "created_at": "2023-01-12T15:04:08.276162Z",
    "updated_at": "2025-03-27T02:12:51.729321Z",
    "deleted_at": null,
    "sha1_hash": "5703e3e582a6c725cfa73d31419407bf0d16da3e",
    "title": "2022-03-08 - GhostWriter - UNC1151 adopts MicroBackdoor Variants in Cyber Operations against Ukraine",
    "authors": "",
    "file_creation_date": "2022-05-27T22:52:53Z",
    "file_modification_date": "2022-05-27T22:52:53Z",
    "file_size": 1390789,
    "plain_text": "# GHOSTWRITER / UNC1151 ADOPTS MICROBACKDOOR VARIANTS IN CYBER OPERATIONS AGAINST UKRAINE\n\n**[cluster25.io/2022/03/08/ghostwriter-unc1151-adopts-microbackdoor-variants-in-cyber-operations-against-targets-in-ukraine/](https://cluster25.io/2022/03/08/ghostwriter-unc1151-adopts-microbackdoor-variants-in-cyber-operations-against-targets-in-ukraine/)**\n\nMarch 8, 2022\n\nFor a few months Cluster25 collected and analyzed several malicious activities which then were\ninternally linked with the threat actor known as UNC1151 (aka GhostWriter), an adversary believed to\nbe linked to the Belarusian government. In July 2020 Mandiant Threat Intelligence released a\n\n\n-----\n\npublic report about an ongoing influence campaign named **GhostWriter . The campaign was**\naddressed to audiences in Lithuania, Latvia and Poland making use of critical messages against the\n**NATO’s presence in Eastern Europe.**\n\nIn addition to this type of operations, UNC1151 seems to be further active also in the compromise of\nobjectives of strategic importance. On March 4, 2022, Cluster25 collected a malicious document\ndesigned to spread malware for espionage purposes against targets located in Ukraine that displays\nthe logos of the Ukrainian President’s office and secret services with content relating to advice on\ndealing with the bombing.\n\n## INSIGHTS\n\nThe document is a Microsoft Compressed HTML Help (CHM) file named dovidka.chm. After\nextracting the file, it shows the following structure:\n\n\n-----\n\n**dividka.chm contains a file named file.htm that in its turn contains obfuscated vbscript (VBS) code**\nas reported following:\n\nThe script checks for the presence of the file\n\n**C:\\Users\\Public\\Favorites\\desktop.ini**\n\nthen it writes a second VBS script under the path\n\n**C:\\Users\\Public\\ignit.vbs**\n\nAfter that, it runs the latter script, deletes it and finally runs the command\n\n\n-----\n\n**wscript.exe //B //E:vbs C:UsersPublicFavoritesdesktop.ini**\n\nThe script ignit.vbs decodes and writes the following files:\n\n**C:\\Users\\Public\\Libraries\\core.dll**\n**C:\\Users\\Public\\Favorites\\desktop.ini**\n**C:\\ProgramData\\Microsoft\\Windows Start Menu\\Programs\\Startup\\Windows Prefetch.lnk**\n\nThe desktop.ini file runs the following command, which executes the file core.dll with the Microsoft\n**Assembly Registration Tool (Regasm.exe):**\n\n**C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U**\n**“C:Users\\Public\\Libraries\\core.dll”**\n\nMICROLOADER\n\nThe file core.dll is a DLL file in .NET code compiled on Monday January 31 2022st at 15:00:46 UTC.\nCode obfuscation and anti-tampering techniques have been used to hinder the analysis. The kind of\nanti-tampering techniques used shows similarities with the use of the open-source code-protector tool\nfor .NET named ConfuserEx. This is because several methods appear as empty and decompilation\nexceptions are present when the file is open in tools such as dnSpy, as reported in the image below:\n\nWe thought to make the code a little more readable by setting a breakpoint after the anti-tamper\nmethod (first method in the constructor) and by replacing the method with NOPs to finally save and\nreopen the module in dnSpy. This is necessary since the method is responsible for changing the RVA\nvalues of the methods. After this is executed, the values are correct, so it is possible to dump the new\nversion of the DLL, but it is also necessary to avoid the anti-tamper method to be called in the next\nexecution, otherwise it would change the values again.\n\n\n-----\n\nThis code is basically a payload aimed at unpacking and executing a payload\n\nMICROBACKDOOR\n\nThe piece of code in the new thread it’s basically meant to perform a connection to the domain\n**xbeta[.]online attested on IP address 185.175.158[.]27.**\n\n\n-----\n\nIf the connection is successful it receives and decrypts commands and performs the appropriate\nactions. The identified commands that can be executed are\n\n**id**\n**info**\n**ping**\n**exit**\n**upd**\n**uninst**\n**exec**\n**shell**\n**flist**\n**fget**\n**fput**\n**screenshot**\n\nThe implant is able to perform any classic operation in support of activities aimed at espionage, such\nas collecting data relating to the machine in which it is operating, downloading and transferring files,\nexecuting arbitrary commands, capturing screenshots etc. etc.\n\n## CONCLUSIONS\n\nThe relations between Russia and Belarus date back in 1991 with the signing of the Belovezh\n**Accords on the ending of the USSR and the establishment of the Commonwealth of Independent**\n**States (CIS). In the actual conflict going on in Ukraine more than once Minsk showed its support to**\nMoscow even if publicly Lukashenko said that he’ll avoid the participation of Belarusian soldiers. In\n\n\n-----\n\ncase of an escalation it s likely that Belarus will assist Russia militarily. On the basis of the above,\nhowever, it seems that the Belarusian government is already openly participating in offensive\noperations in the cyber domain by protecting Russian interest.\n\n## INDICATORS OF COMPROMISE\n\n**CATEGORY** **TYPE** **VALUE**\n\nPAYLOAD MD5 2556a9e1d5e9874171f51620e5c5e09a\n\nPAYLOAD SHA1 affc2b19d9fb8080a7211c3ed0718f2c3d3887df\n\nPAYLOAD SHA256 7f0511b09b1ab3a64c8827dd8af017acbf7d2688db31a5d98fea8a5029a89d56\n\nPAYLOAD MD5 d2a795af12e937eb8a89d470a96f15a5\n\nPAYLOAD SHA1 491214cc496f4a358856801d0381eb4926c07c59\n\nPAYLOAD SHA256 e97f1d6ec1aa3f7c7973d57074d1d623833f0e9b1c1e53f81af92c057a1fdd72\n\nPAYLOAD MD5 e2e6bb2fa799b8a9ace6125f80cc06d2\n\nPAYLOAD SHA1 5f7b3f789916b8ddcf8042f83817719bae133474\n\nPAYLOAD SHA256 559d8e8f2c60478d1c057b46ec6be912fae7df38e89553804cc566cac46e8e91\n\nNETWORK C2 xbeta[.]online\n\nNETWORK C2 185.175.158[.]27\n\n**ATT&CK MATRIX**\n\n**TACTIC** **TECHNIQUE** **DESCRIPTION**\n\nInitial Access T1566.001 Spearphishing Attachment\n\nExecution T1059 Command and Scripting Interpreter\n\nDefense Evasion T1036 Masquerading\n\nDefense Evasion T1140 Deobfuscate/Decode Files or Information\n\nDefense Evasion T1027 Obfuscated Files or Information\n\nDiscovery T1082 System Information Discovery\n\n**DETECTION**\n\n\n-----\n\nrule GhostWriter_MicroLoader_72632_00001 {\n\nmeta:\n\nauthor = “Cluster25”\n\nhash1 = “e97f1d6ec1aa3f7c7973d57074d1d623833f0e9b1c1e53f81af92c057a1fdd72”\n\ntlp = “white”\n\nstrings:\n\n$ = “ajf09aj2.dll” fullword wide\n\n$ = “regsvcser” fullword ascii\n\n$ = “X l.dlT” fullword ascii\n\n$ = “rtGso9w|4” fullword ascii\n\n$ = “ajlj}m${<” fullword ascii\n\ncondition: (uint16(0) == 0x5a4d and all of them)\n\n}\n\nrule GhostWriter_MicroBackdoor_72632_00001 {\nmeta:\n\nauthor = “Cluster25”\n\nhash1 = “559d8e8f2c60478d1c057b46ec6be912fae7df38e89553804cc566cac46e8e91”\n\ntlp = “white”\n\nstrings:\n\n$ = “cmd.exe /C \\”%s%s\\”” fullword wide\n\n$ = “client.dll” fullword ascii\n\n$ = “ERROR: Unknown command” fullword ascii\n\n$ = ” *** ERROR: Timeout occured” fullword ascii\n\n$ = “%s\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings” fullword ascii\n\n$ = “MIIDazCCAlOgAwIBAgIUWOftflCclQXpmWMnL1ewj2F5Y1AwDQYJKoZIhvcNAQEL” fullword\nascii\n\ncondition: (uint16(0) == 0x5a4d and all of them)\n\n}\n\nWritten by: [Cluster25](https://cluster25.io/author/cluster25/)\n\nTagged as: [APT,](https://cluster25.io/tag/apt/) [Ukraine,](https://cluster25.io/tag/ukraine/) [UNC1151,](https://cluster25.io/tag/unc1151/) [GhostWriter,](https://cluster25.io/tag/ghostwriter/) [MicroBackdoor,](https://cluster25.io/tag/microbackdoor/) [Russia.](https://cluster25.io/tag/russia/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-08 - GhostWriter - UNC1151 adopts MicroBackdoor Variants in Cyber Operations against Ukraine.pdf"
    ],
    "report_names": [
        "2022-03-08 - GhostWriter - UNC1151 adopts MicroBackdoor Variants in Cyber Operations against Ukraine.pdf"
    ],
    "threat_actors": [
        {
            "id": "8a33d3ac-14ba-441c-92c1-39975e9e1a73",
            "created_at": "2023-01-06T13:46:39.195689Z",
            "updated_at": "2025-03-27T02:00:03.01861Z",
            "deleted_at": null,
            "main_name": "Ghostwriter",
            "aliases": [
                "PUSHCHA",
                "Storm-0257",
                "DEV-0257",
                "UAC-0057",
                "UNC1151",
                "TA445"
            ],
            "source_name": "MISPGALAXY:Ghostwriter",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "119c8bea-816e-4799-942b-ff375026671e",
            "created_at": "2022-10-25T16:07:23.957309Z",
            "updated_at": "2025-03-27T02:02:10.048343Z",
            "deleted_at": null,
            "main_name": "Operation Ghostwriter",
            "aliases": [
                "DEV-0257",
                "Operation Asylum Ambuscade",
                "PUSHCHA",
                "Storm-0257",
                "TA445",
                "UAC-0051",
                "UAC-0057",
                "UNC1151"
            ],
            "source_name": "ETDA:Operation Ghostwriter",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "HALFSHELL",
                "Impacket",
                "RADIOSTAR",
                "VIDEOKILLER",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f53f4b13-b055-426f-876a-18cf9a0f4fa0",
            "created_at": "2024-05-01T02:03:08.129377Z",
            "updated_at": "2025-03-27T02:05:17.412789Z",
            "deleted_at": null,
            "main_name": "MOONSCAPE",
            "aliases": [
                "UAC-0051 ",
                "UNC1151 ",
                "TA445 "
            ],
            "source_name": "Secureworks:MOONSCAPE",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535848,
    "ts_updated_at": 1743041571,
    "ts_creation_date": 1653691973,
    "ts_modification_date": 1653691973,
    "files": {
        "pdf": "https://archive.orkl.eu/5703e3e582a6c725cfa73d31419407bf0d16da3e.pdf",
        "text": "https://archive.orkl.eu/5703e3e582a6c725cfa73d31419407bf0d16da3e.txt",
        "img": "https://archive.orkl.eu/5703e3e582a6c725cfa73d31419407bf0d16da3e.jpg"
    }
}