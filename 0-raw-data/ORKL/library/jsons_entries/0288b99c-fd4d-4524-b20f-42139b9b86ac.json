{
    "id": "0288b99c-fd4d-4524-b20f-42139b9b86ac",
    "created_at": "2023-01-12T15:08:02.365021Z",
    "updated_at": "2025-03-27T02:05:52.449188Z",
    "deleted_at": null,
    "sha1_hash": "2d546ace2b5b7fea8690ba28c24636e9d5699477",
    "title": "2021-03-03 - 'Mild' update on Microsoft Exchange 0day security vulnerability being used to attack organizations in Vietnam",
    "authors": "",
    "file_creation_date": "2022-09-12T12:03:40Z",
    "file_modification_date": "2022-09-12T12:03:40Z",
    "file_size": 670966,
    "plain_text": "# Cập nhật 'nhẹ' về lỗ hổng bảo mật 0day Microsoft Exchange đang được sử dụng để tấn công các tổ chức tại Việt Nam\n\n**gteltsc.vn/blog/cap-nhat-nhe-ve-lo-hong-bao-mat-0day-microsoft-exchange-dang-duoc-su-dung-de-tan-cong-cac-to-**\nchuc-tai-viet-nam-9685.html\n\nMarch 3, 2021\n\n**Vừa qua, Volexity và Microsoft có công bố các bài phân tích về các chiến dịch tấn**\n**công sử dụng các lỗ hổng 0-day nhắm đến các phiên bản Exchange Server on-prem.**\n**Theo như báo cáo của MS, các cuộc tấn công liên quan đến Microsoft Exchange sử**\n**dụng 0-day bao gồm CVE-2021-26855, CVE-2021-26857, CVE-2021-26858 và CVE**\n**-2021-27065. Ảnh hưởng tới các phiên bản MS Exchange Server 2013,2016 và 2019.**\n**Thông qua các hành vi, cách thức, các command ghi nhận trên hệ thống SIEM, chúng**\n**tôi đã thực hiện forensic ngay trước khi lỗ hổng được công bố.**\n\n[Các tổ chức, đơn vị có thể tham khảo bài viết phân tích của Volexity[1]. Trong bài viết này,](https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/)\nGTSC sẽ đưa thêm một số dấu hiệu để xác định tấn công để tự kiểm tra trong hệ thống Mail\nExchange của tổ chức\n\n**Dấu hiệu phát hiện**\n\n\n-----\n\n_IIS log:_\n\nKiểm tra các truy cập tới đường dẫn /ecp/<single char>.js. trả về mã response code là 200 .\nChúng tôi phát hiện được 3 file có dạng x.js, y.js, z.js thông qua log. User-Agent là\nExchangeServicesClient/0.0.0.0 và Python-requests/2.22.0\n\n**Exchange ECP log**\n\nLỗ hổng RCE liên quan tới set-OabVirtualDirectory ExchangePowershell cmdlet. Kiểm tra\ntrong các HttpProxy log nằm trong Exchange ECP log (thư mục chứa log của\nExchange: c:\\Program Files\\Microsoft\\Exchange Server\\{Version}\\Logging\\ ) với đoạn log ghi\nnhận truy cập url: /ecp/DDI/DDIService.svc/SetObject với tham số schema là\n_OABVirtualDirectory và ResetOABVirtualDirectory, có thể thêm UserAgent là python-_\n_requests._\n\n**Webshell/Malware Path:**\n\nChúng tôi phát hiện các webshell nằm tại các đường dẫn sau\n\n_\\inetpub\\wwwroot\\aspnet_client\\system_web\\_\n\n_\\inetpub\\wwwroot\\aspnet_client\\_\n\nNgoài ra, cần thực hiện kiểm tra webshell trong đường dẫn Exchange như:\n\n_%ProgramFiles%\\Microsoft\\Exchange Server\\_\n_<version>\\ClientAccess %ProgramFiles%\\Microsoft\\Exchange Server\\<version>\\FrontEnd_\n\nChú ý kiếm tra các webshell dưới dạng dll trong các thư mục bin, ví dụ như:\n\n\n-----\n\n_\\Program Files\\Microsoft\\Exchange Server\\<Version>\\ClientAccess\\owa\\bin_ hoặc \\Program\n_Files\\Microsoft\\Exchange Server\\<Version>\\FrontEnd\\HttpProxy\\owa\\bin …_\n\n_Các DLL độc hại nằm tại các đường dẫn:_\n\n_C:\\\\Windows\\Microsoft.Net\\FrameWork\\sbs_clrhost.dll_\n\n_C:\\Program Files\\Common Files\\microsoft shared\\WMI\\iiswmi.dll_\n\n_C:\\Program Files\\Common Files\\System\\websvc.dll_\n\n_C:\\\\Windows\\Microsoft.Net\\FrameWork64\\\\v4.030319\\Util.config_\n\n_C:\\\\Windows\\Microsoft.Net\\FrameWork64\\version.dll_\n\n_Tên các webshell:_\n\n_Aspnet_client.aspx_\n\n_Errorv.aspx_\n\n_Access.aspx_\n\n**Hashes**\n\n_Webshell hashes_\n\n_286F877DAD9E7CECC69A0FA30DE582DE910A1E6E_\n_C3FA8F4B7A2D84E1A54A2DC973985C76652BBCF2_\n\n_DLL hashes_\n\n_3ED18FBE06D6EF2C8332DB70A3221A00F7251D55_\n\n_C8675C1578D3FDD22CBB0F64340258BCFDD5743F_\n_3399681CFD6F7F2A270D9A543021ED9B93E85675_\n\n_1EE063A2B7B29334E7388B621AE8B37DD2488210_\n\n**Network**\n\nGhi nhận các IP sau có liên quan trong đó IP 167.99.168.251 cũng đã được nhắc đến trong\nbài viết của Volexity:\n\n_167.99.168.251_\n\n_185.220.101.204_\n\n_162.247.72.199_\n\n_194.156.98.191_\n\n\n-----\n\n_202.182.100.134_\n\n_109.70.100.55_\n\n_185.220.101.18_\n\n_193.36.119.144_\n\nSau khi khai thác các lỗ hổng thành công, attacker triển khai webshell trên máy chủ bị\ncompromised. Một ví dụ về các webshell mà chúng tôi thu thập được:\n\nThực hiện write file:\n\nThực hiện biên dịch và thực thi class, method được yêu cầu:\n\nSau khi có được webshell, chúng tôi phát hiện thêm các DLL sau được drop xuống.\niisvmi.dll(x64) DLL này sẽ được chạy dưới dạng một service tên là ExchangeSvc. Nhiệm vụ\ncủa DLL này drop ra một dll khác có tên websvc.dll. Dll websvc.dll nhận tham số là chuỗi\nbase64, với chuỗi base64 là tham số truyền vào từ iisvmi.dll được lưu trữ trên registry.\nwebsvc.dll sẽ thực hiện việc decrypt chuỗi base64, xor với 63, decompress gzip để được\nmột DLL mới.DLL này sẽ load trực tiếp trên memory. Phân tích chi tiết các mẫu mã độc,\nchúng tôi xin phép update vào bài viết khác.\n\n_Thông tin các bản vá xem tại https://msrc-blog.microsoft.com/2021/03/02/multiple-security-_\n_updates-released-for-exchange-server/_\n\n_FROM #độixửlísựcốsấpmặt with LOVE_\n\n\n-----\n\n[1] https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero_day-vulnerabilities/_\n\n## Liên hệ\n\nName\n\nEmail\n\nPhone\n\nMessage\n\nGửi\n\n\n-----",
    "language": "VI",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-03 - 'Mild' update on Microsoft Exchange 0day security vulnerability being used to attack organizations in Vietnam.pdf"
    ],
    "report_names": [
        "2021-03-03 - 'Mild' update on Microsoft Exchange 0day security vulnerability being used to attack organizations in Vietnam.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536082,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1662984220,
    "ts_modification_date": 1662984220,
    "files": {
        "pdf": "https://archive.orkl.eu/2d546ace2b5b7fea8690ba28c24636e9d5699477.pdf",
        "text": "https://archive.orkl.eu/2d546ace2b5b7fea8690ba28c24636e9d5699477.txt",
        "img": "https://archive.orkl.eu/2d546ace2b5b7fea8690ba28c24636e9d5699477.jpg"
    }
}