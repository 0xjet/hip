{
    "id": "50e9a13e-7653-42af-ac36-9c5ec2011f2e",
    "created_at": "2023-01-12T14:59:37.052165Z",
    "updated_at": "2025-03-27T02:16:59.126202Z",
    "deleted_at": null,
    "sha1_hash": "8b49a35b41355c942cc2ee6b8ce842d885430c53",
    "title": "2021-03-09 - MineBridge Is on the Rise, With a Sophisticated Delivery Mechanism",
    "authors": "",
    "file_creation_date": "2022-05-28T02:08:19Z",
    "file_modification_date": "2022-05-28T02:08:19Z",
    "file_size": 1286875,
    "plain_text": "# MineBridge RAT Is on the Rise, With a Sophisticated Delivery Mechanism\n\n**[blog.morphisec.com/minebridge-on-the-rise-sophisticated-delivery-mechanism](https://blog.morphisec.com/minebridge-on-the-rise-sophisticated-delivery-mechanism)**\n\nPosted by [Alon Groisman on March 9, 2021](https://blog.morphisec.com/author/alon-groisman)\nFind me on:\n[LinkedIn](https://www.linkedin.com/in/alon-groisman-84a78727/)\n\n[Tweet](https://twitter.com/share)\n\n\n-----\n\nThe MineBridge RAT was first identified in January 2020 by security researchers at FireEye,\nwho observed the backdoor attacking financial institutions in the United States with some\ntargets located in South Korea as well. MineBridge was initially classified as a C++ backdoor\nthat was delivered via phishing campaigns.\n\nThe updated RAT began using a macro embedded in Word document in late February.\nAccording to attribution models from several other cybersecurity firms, it appears to be the\nwork of TA505, who have also used a Get2 loader and Clop/Cryptomix.\n\nThis blog post will cover a new delivery chain for the MineBridge RAT, including technical\ndetails and binary indicators.\n\n### Technical Introduction:\n\nMorphisec Labs recently identified an updated delivery chain for the latest MineBridge RAT\ndelivery.\n\nThough we haven’t currently established the entry point of how the first scheduled task was\ncreated, we assume that as before it follows the impersonation of Google-related application\nupdates. Both scheduled tasks within the attack chain have Google in their names and\npreviously-known delivery methods of MineBridge also involved Google updates.\n\n### c\n\n\n-----\n\nMineBridge Attack Flow\n\n\nBelow are short descriptions of the attack stages:\n\nThe total execution length of the attack was about two hours from the first task\nexecuted until the final stage of connection to the C2\nAt first, a scheduled task executed a very short encoded PowerShell that executes a\nremote PowerShell obfuscated command. The URL is hidden behind a cutt.ly URL\nshortener service.\nThe remote obfuscated PowerShell command downloads a NetSupport client from a\nfreshly registered Bitbucket storage through the same cutt.ly service.\nAfter downloading all the required legitimate NetSupport executables, the same\nobfuscated remote PowerShell continues to download a custom client configuration file\nthat points to an intermediate C2. This configuration is downloaded from a different\ndomain also masked by cutt.ly.\n\n\n-----\n\nNext, the NetSupport executes and immediately connects to the intermediate C2.\nFollowing the connection, a PowerShell command is executed and persisted into a new\nscheduled task.\nThe new PowerShell encoded command again executes a remote obfuscated\nPowershell like a previous stage.\nThe remote obfuscated PowerShell downloads an old TeamViewer from a different\nBitbucket repository that was also just created for this attack. Like the previous stage,\nthe repository stores legitimate artifacts of the TeamViewer while the malicious “msi.dll”\nis downloaded from a different malicious domain. If the msi.dll is removed by AV, it will\nbe re-downloaded when the next task executes.\nMsi.dll sideloading is not a new technique, it has been long used by MineBridge RAT\nand some others to execute malicious code within the context of TeamViewer. This\ntime the DLL mimics a Themida packer though the encryption is done by VMprotect.\n\n### First PowerShell\n\n\n-----\n\nFirst PowerShell\n\n\nThe first stage of PowerShell execution uses a standard Invoke-WebRequest to download\nthe next stage PowerShell from a cutt.ly URL Link shortener service\n(hxxps://simplename[.]website/upd/?t=psns). Using a URL shortener as well as using public\ncontent sharing services has become very popular among the different actors as it's almost\nimpossible to block based on reputation.\n\n“Google Photo Sync” is the registered scheduled task that is responsible for the execution of\nthis encoded PowerShell command;\n\n\n-----\n\nencoded PowerShell command\n\n\n### Second PowerShell\n\nThe PowerShell in the next stage is slightly obfuscated. The obfuscation is done by\nseparating string characters and assigning them to long random parameter names, later\nconcatenating them at runtime. The long variable parameter names confuse some of the\nstring similarities in AI algorithms that search for suspicious obfuscated strings. Many actors\nalso apply this technique to evade detection by AI algorithms.\n\n\n-----\n\nSecond PowerShell\n\n\nThe following script appears when we decode the PowerShell content.\n\n\n-----\n\ndecode the PowerShell content\n\n\nAll cutt.ly links lead to a freshly created public Bitbucket project that contains all files\nnecessary to run NetSupport clients. The only file missing is the Client32.ini configuration file\nthat is downloaded from a different domain simpledomen[.]club/support.php (request header\nis validated by the attacker). As soon as all the artifacts are downloaded, a NetSupport\nbackdoor is added to the autoruns for persistence.\n\n\n-----\n\ndownloads repository\n\n\nThe repository has no Commits, Branches, Comments, or any discussion aside from the\nNetSupport files. The only Commit is for the README.md file that contains a generic\nBitbucket content possibly to make it look like a new legitimate project.\n\n\n-----\n\ncommit for the readme file\n\n\n**Client32.ini file:**\n\nBefore running the NetSupport client, the PowerShell script tests if the file Client32.ini exists.\nIf so, the configuration file is removed and downloaded again. This way the attack chain will\nnot be interrupted by the intermediate NetSupport C2 change or a remediation attempt by\nthe local AV.\n\nClient32.ini contains NetSupport settings. The actor sets NetSupport to be hidden while\ndisabling all app notifications and any pop-ups. At the moment we wrote this post, the\nNetSupport backdoor was configured to communicate with update-system[.]cn:443 as the\nmain gateway and updatesystem[.]website:443 as the secondary gateway.\n\n\n-----\n\nmain gateway and updatesystem\n\n\n### Third PowerShell:\n\nAs soon as the NetSupport client succeeds in connecting to the intermediate C2, it executes\na PowerShell command that is similar in format to the first PowerShell command with a slight\nmodification of the cutt.ly link. The cutt.ly link then expands to the same URL with a slight\nchange in the parameter name to hxxps://simplename[.]website/upd/?t=pstv. Note that the\n**last 2 letters represent the backdoor name acronyms (ns for NetSupport, tv for**\n**TeamViewer).**\n\n\n-----\n\nThird PowerShell\n\n\nNetSupport also adds a persistent scheduled task for the next stage.\n\nThe “Google Disk Sync” scheduled task is the encoded representation of the above\ncommand:\n\n\n-----\n\nencoded Google Disk Sync\n\n\n### Fourth PowerShell:\n\nAs in the previous stages, the remote obfuscated command is responsible for the download\nof a new backdoor component: an old TeamViewer that is vulnerable to a side-loading (DLL\nhijack) vulnerability. As before, all the artifacts needed for the execution of TeamViewer are\ndownloaded from a newly created Bitbucket repository (different from the first one) while the\nmalicious msi.dll component (the sideloaded DLL) is downloaded from the same “client32”\ndomain simpledomen[.]club/watchdog.php. The attacker chooses to rename the TeamViewer\napplication name to QTConnect.exe.\n\n\n-----\n\nminebridge trojan\n\n\n-----\n\nclient32 domain\n\n\nWhile most DLL hijacks are usually executed after the application is loaded, in the case of\nTeamViewer the msi.dll is directly in the import table of the executable. Therefore it will\nexecute before the application officially starts its execution; this is a very lucrative target for\nattackers to avoid runtime monitoring. This is also why some vendors decided to flag the\nvulnerable TeamViewer even though it is signed by a legitimate certificate.\n\n### MineBridge rat\n\nIn the scope of this blog, we will only touch upon some of the basic characteristics of the\ndelivered RAT. MineBridge Remote-Access Trojan actors frequently change their packing\ntechniques to hide their final payload. In this latest campaign, we identified the impersonation\nof a Themida packer while masking VMprotect.\n\n\n-----\n\nMineBridge Remote-Access Trojan\n\n\n**String Encryption**\n\nAfter unpacking has completed, we quickly identified the main string decryptors (Unicode\nand Ascii). We [uploaded a basic script that should decrypt most of the strings.](https://gist.githubusercontent.com/smgorelik/a588001da48f1da080b4e4e8959bbc6f/raw/4aae615d4be6d5160cbc7030d20d801237d33b37/MineBridgeStringDecryptor.py)\n\n\n-----\n\nmain string decryptor\n\n\nOur first analysis showed a nonsignificant change in commands, no change in mutex and\npersistence, different C2 domains, and a slight modification in the communication pattern.\n\n**Commands**\n\nrunexe_command\nrunexe_URL\nrundll_command\nrundll_URL\nupdate_command\nupdate_URL\nrestart_command4\nterminate_command\nkill_command\n\n\n-----\n\nShutdown_command\nReboot_command\n\nAn example for one of the commands:\n\n\nMinebridge command\n\n\n**Communication**\n\n\n-----\n\nMinebridge communication\n\n\nMinebridge\n\n\n-----\n\n**Persistence**\n\nAs before the persistence is automated through IshellLink functionality, adding “Windows\nDefender.lnk” to the startup folder.\n\n\nWindows Defender.lnk\n\n\n## Conclusion\n\nThe delivery of MineBridge has evolved since it was first identified in January. This new\nvariant can evade detection solutions through obfuscation and other means, thus allowing it\nto continue its attack in infected systems. Morphisec customers are secured against\n\n\n-----\n\nMineBridge s evasion tactics through the power of our prevention-first, zero-trust runtime\nendpoint and server protection technologies powered by moving target defense.\n\nIOCs:\n\n\nNetSupport\nclient and\ndownloaders\n\nNetSupport\nclient\n\nTeamViewer\n/ MineBridge\ndownloaders\n\nMineBridge\nC2\n\n\nsimplename[.]website/upd/?t=psns\n\nsimpledomen[.]club/support.php\n\nbitbucket[.]org/Net-Support/pub/downloads/\n\nupdate-system[.]cn:443\n\nupdatesystem[.]website:443\n\nsimplename[.]website/upd/?t=pstv\n\nsimpledomen[.]club/watchdog.php\n\nbitbucket[.]org/TVSoft/public/downloads/\n\nninjakick[.]club\n\npolarrsearch[.]xyz\n\nrogaikopyta[.]xyz\n\nutkailipa[.]xyz\n\n5tvstar[.]cn\n\nsweepchance[.]xyz\n\nsweepchance[.]club\n\ngoldendragon888[.]cn\n\nsub-url: tf346765jh67/indexes_data.php\n\n\nmsi.dll 7c6b9051654cbbcd02985c16fcb95ce1a78c58ba54bdc0605f0c4ee669c67ff9\n\nMutex DynGateInstanceMutex\n\n\nScheduled\ntasks\n\n\n“Google Photo Sync”\n\n“Google Disk Sync”\n\n\n-----\n\nOlder domains billionaireshore[.]top\n\nvikingsofnorth[.]top\n\nrealityarchitector[.]top\n\ngentlebouncer[.]top\n\nbrainassault[.]top\n\ngreatersky[.]top\n\nunicornhub[.]top\n\ncorporatelover[.]top\n\nbloggersglobbers[.]top\n\nbillionairesho[.]top\n\nsub-url: munhgy8fw6egydubh/9gh3yrubhdkgfby43.php\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-09 - MineBridge Is on the Rise, With a Sophisticated Delivery Mechanism.pdf"
    ],
    "report_names": [
        "2021-03-09 - MineBridge Is on the Rise, With a Sophisticated Delivery Mechanism.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535577,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653703699,
    "ts_modification_date": 1653703699,
    "files": {
        "pdf": "https://archive.orkl.eu/8b49a35b41355c942cc2ee6b8ce842d885430c53.pdf",
        "text": "https://archive.orkl.eu/8b49a35b41355c942cc2ee6b8ce842d885430c53.txt",
        "img": "https://archive.orkl.eu/8b49a35b41355c942cc2ee6b8ce842d885430c53.jpg"
    }
}