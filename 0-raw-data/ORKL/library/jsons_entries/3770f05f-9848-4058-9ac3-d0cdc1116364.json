{
    "id": "3770f05f-9848-4058-9ac3-d0cdc1116364",
    "created_at": "2023-01-12T15:10:46.503149Z",
    "updated_at": "2025-03-27T02:09:29.562077Z",
    "deleted_at": null,
    "sha1_hash": "c907d4412f832223d132210cea921e49db5f7950",
    "title": "2013-10-14 - PE_MOFKSYS.A",
    "authors": "",
    "file_creation_date": "2022-05-28T19:36:38Z",
    "file_modification_date": "2022-05-28T19:36:38Z",
    "file_size": 99503,
    "plain_text": "# PE_MOFKSYS.A\n\n**[trendmicro.com/vinfo/us/threat-encyclopedia/malware/PE_MOFKSYS.A/](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/PE_MOFKSYS.A/)**\n\nModified by: Sabrina Lei Sioting\n\n##  OVERVIEW\n\nInfection Channel: Downloaded from the Internet, Dropped by other malware, Infects files\n\nThis file infector arrives on a system as a file dropped by other malware or as a file\ndownloaded unknowingly by users when visiting malicious sites.\n\nIt uses Windows Task Scheduler to create a scheduled task that executes the dropped copy.\n\nIt modifies registry entries to disable various system services. This action prevents most of\nthe system functions to be used.\n\nIt prepends its codes to target files.\n\nIt executes commands from a remote malicious user, effectively compromising the affected\nsystem.\n\nIt steals certain information from the system and/or the user.\n\n##  TECHNICAL DETAILS\n\n**Arrival Details**\n\nThis file infector arrives on a system as a file dropped by other malware or as a file\ndownloaded unknowingly by users when visiting malicious sites.\n\n**Installation**\n\nThis file infector drops the following non-malicious files:\n\n%System%\\cmsys.cmn\n%User Profile%\\Application Data\\icsys.icn\n\n(Note: %System% is the Windows system folder, which is usually C:\\Windows\\System32..\n_%User Profile% is the current user's profile folder, which is usually C:\\Documents and_\nSettings\\{user name} on Windows 2000, XP, and Server 2003, or C:\\Users\\{user name} on\nWindows Vista and 7.)\n\n\n-----\n\nIt uses Windows Task Scheduler to create a scheduled task that executes the dropped copy.\n\n**Autostart Technique**\n\nThis file infector adds the following registry entries to enable its automatic execution at every\nsystem startup:\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows\\CurrentVersion\\RunOnce\nSvchost = \"%Windows%\\svchost.exe RO\"\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nActive Setup\\Installed Components\\{Random CLSID}\nStubPath = \"%Application Data%\\mrsys.exe MR\"\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows\\CurrentVersion\\RunOnce\nExplorer = \"%System%\\explorer.exe RO\"\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows\\CurrentVersion\\Run\nExplorer = \"%System%\\explorer.exe RU\"\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows\\CurrentVersion\\Run\nSvchost = \"%Windows%\\svchost.exe RU\"\n\nIt modifies the following registry entries to ensure it automatic execution at every system\nstartup:\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nWindows NT\\CurrentVersion\\Winlogon\nShell = \"%Windows%\\explorer.exe, %System%\\explorer.exe\"\n\n(Note: The default value data of the said registry entry is Explorer.exe.)\n\nThe scheduled task executes the malware at the following period:\n\nEveryday at malware's first execution time\n\n**Other System Modifications**\n\nThis file infector adds the following registry entries as part of its installation routine:\n\nHKEY_CURRENT_USER\\Software\\VB and VBA Program Settings\\\nExplorer\\Process\nLO = \"1\"\n\n\n-----\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\Schedule\nAtTaskMaxHours = \"48\"\n\nIt adds the following registry keys as part of its installation routine:\n\nHKEY_CURRENT_USER\\Software\\VB and VBA Program Settings\n\nHKEY_CURRENT_USER\\Software\\VB and VBA Program Settings\\\nExplorer\n\nHKEY_CURRENT_USER\\Software\\VB and VBA Program Settings\\\nExplorer\\Process\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nActive Setup\\Installed Components\\{Random CLSID}\n\nIt modifies registry entries to disable the following system services:\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\SharedAccess\nStart = \"4\"\n\n(Note: The default value data of the said registry entry is 2.)\n\nIt modifies the following registry entries to hide files with Hidden attributes:\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\\nWindows\\CurrentVersion\\Explorer\\\nAdvanced\nShowSuperHidden = \"0\"\n\n(Note: The default value data of the said registry entry is 1.)\n\n**File Infection**\n\nThis file infector infects the following file types:\n\n.EXE\n\nIt prepends its codes to target files.\n\nThis is the Trend Micro detection for files infected by:\n\nPE_MOFKSYS.A-O\n\n**Backdoor Routine**\n\n\n-----\n\nThis file infector executes the following commands from a remote malicious user:\n\nUpdate itself\nDownload other files\nCapture screen\nLog Keystrokes\nMonitor mouse clicks\nMonitor window titles\n\nIt connects to the following URL(s) to send and receive commands from a remote malicious\nuser:\n\n{BLOCKED}.t35.com\n{BLOCKED}.atspace.com\n{BLOCKED}.zxq.net\n\n**Dropping Routine**\n\nThis file infector drops the following files:\n\n%Application Data%\\mrsys.exe - detected as PE_MOFKSYS.A-O\n%Windows%\\spoolsv.exe - detected as PE_MOFKSYS.A-O\n%Windows%\\svchost.exe - detected as PE_MOFKSYS.A-O\n%System%\\explorer.exe - detected as PE_MOFKSYS.A-O\n%User Profile%\\Application Data\\icsys.icn.exe - detected as PE_MOFKSYS.A-O\n%System Root%\\Documents and Settings\\All Users\\Application Data\\stsys.exe detected as PE_MOFKSYS.A-O\n\n(Note: %Application Data% is the current user's Application Data folder, which is usually\nC:\\Documents and Settings\\{user name}\\Application Data on Windows 2000, XP, and Server\n2003, or C:\\Users\\{user name}\\AppData\\Roaming on Windows Vista and 7.. %Windows% is\nthe Windows folder, which is usually C:\\Windows.. %System% is the Windows system folder,\nwhich is usually C:\\Windows\\System32.. %User Profile% is the current user's profile folder,\nwhich is usually C:\\Documents and Settings\\{user name} on Windows 2000, XP, and Server\n2003, or C:\\Users\\{user name} on Windows Vista and 7.. %System Root% is the root folder,\nwhich is usually C:\\. It is also where the operating system is located.)\n\n**Information Theft**\n\nThis file infector steals the following information:\n\nEmail configurations\n\n   - User name\n\n   - Password\n\n   - Authenticate status\n\n\n-----\n\n   - Use of SSL\n\n   - SMTP server\n\n   - SMTP port\n\n   - recipients\nInstant messenger credentials\nWebsites visited\nClipboard contents\n\n**Drop Points**\n\nThis file infector uses its own SMTP engine to send the stolen data using the following\ndomain server:\n\n{BLOCKED}1@gmail.com\n{BLOCKED}1@gmail.com\n{BLOCKED}2@gmail.com\n{BLOCKED}2@gmail.com\n{BLOCKED}6@gmail.com\n\n**NOTES:**\n\nIt infects all .EXE files inside the folders that was accessed by the user in all physical and\nremovable drives.\n\nIt also shares the following folder in the network:\n\n%System Root%\\Documents and Settings\\All User\\Application Data\n\n##  SOLUTION\n\n**Step 1**\n\nBefore doing any scans, Windows XP, Windows Vista, and Windows 7 users must disable\n_System Restore to allow full scanning of their computers._\n\n**Step 2**\n\nRemove the malware/grayware file that dropped/downloaded PE_MOFKSYS.A\n\nPE_MOFKSYS.A-O\n\n**Step 3**\n\nIdentify and delete files detected as PE_MOFKSYS.A using the Recovery Console\n\n[ Learn More ]\n\n\n-----\n\n**Step 4**\n\nDelete this registry key\n\n[ Learn More ]\n\n**Important: Editing the Windows Registry incorrectly can lead to irreversible system**\nmalfunction. Please do this step only if you know how or you can ask assistance from your\nsystem administrator. Else, check this [Microsoft article first before modifying your computer's](http://support.microsoft.com/kb/256986/EN-US/)\nregistry. Before you could do this, you must restart in Safe Mode. For instructions on how to\ndo this, you may refer to [this page If the preceding step requires you to restart in safe mode,](https://www.trendmicro.com/vinfo/us/security/definition/safe-mode)\nyou may proceed to edit the system registry.\n\nIn HKEY_CURRENT_USER\\Software\n\n**VB and VBA Program Settings**\n\n**Step 5**\n\nDelete the random registry key/s that this malware created\n\n[ Learn More ]\n\n**Important: Editing the Windows Registry incorrectly can lead to irreversible system**\nmalfunction. Please do this only if you know how to or you can seek your system\nadministratorâ€™s help. You may also check out this Microsoft article first before modifying your\ncomputer's registry.\n\n**Step 6**\n\nDelete this registry value\n\n[ Learn More ]\n\n**Important: Editing the Windows Registry incorrectly can lead to irreversible system**\nmalfunction. Please do this step only if you know how or you can ask assistance from your\nsystem administrator. Else, check this [Microsoft article first before modifying your computer's](http://support.microsoft.com/kb/256986/EN-US/)\nregistry.\n\nIn\n_HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce_\n\n**Explorer = \"%System%\\explorer.exe RO\"**\nIn\n_HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce_\n\n**Svchost = \"%Windows%\\svchost.exe RO\"**\nIn HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n**Explorer = \"%System%\\explorer.exe RU\"**\n\n\n-----\n\nIn HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n**Svchost = \"%Windows%\\svchost.exe RU\"**\nIn HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Schedule\n\n**AtTaskMaxHours = \"48\"**\n\n**Step 7**\n\nRestore this modified registry value\n\n[ Learn More ]\n\n**Important: Editing the Windows Registry incorrectly can lead to irreversible system**\nmalfunction. Please do this step only if you know how or you can ask assistance from your\nsystem administrator. Else, check this [Microsoft article first before modifying your computer's](http://support.microsoft.com/kb/256986/EN-US/)\nregistry.\n\nIn HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\n_NT\\CurrentVersion\\Winlogon_\n\nFrom: Shell = \"%Windows%\\explorer.exe, %System%\\explorer.exe\"\nTo: Shell = Explorer.exe\nIn HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\n\nFrom: Start = \"4\"\nTo: Start = 2\nIn\n_HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced_\n\nFrom: ShowSuperHidden = \"0\"\nTo: ShowSuperHidden = 1\n\n**Step 8**\n\nScan your computer with your Trend Micro product to clean files detected as\nPE_MOFKSYS.A. If the detected files have already been cleaned, deleted, or quarantined by\nyour Trend Micro product, no further step is required. You may opt to simply delete the\n[quarantined files. Please check this Knowledge Base page for more information.](https://esupport.trendmicro.com/en-us/home/index.aspx)\n\n[Did this description help? Tell us how we did.](http://www.zoomerang.com/Survey/WEB22CWQU9N2PR)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2013/2013-10-14 - PE_MOFKSYS.A.pdf"
    ],
    "report_names": [
        "2013-10-14 - PE_MOFKSYS.A.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536246,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653766598,
    "ts_modification_date": 1653766598,
    "files": {
        "pdf": "https://archive.orkl.eu/c907d4412f832223d132210cea921e49db5f7950.pdf",
        "text": "https://archive.orkl.eu/c907d4412f832223d132210cea921e49db5f7950.txt",
        "img": "https://archive.orkl.eu/c907d4412f832223d132210cea921e49db5f7950.jpg"
    }
}