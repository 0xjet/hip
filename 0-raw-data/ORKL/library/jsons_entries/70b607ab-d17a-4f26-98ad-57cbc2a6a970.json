{
    "id": "70b607ab-d17a-4f26-98ad-57cbc2a6a970",
    "created_at": "2023-01-12T15:07:31.636281Z",
    "updated_at": "2025-03-27T02:09:30.931189Z",
    "deleted_at": null,
    "sha1_hash": "fc09c97722173fcf0a45553676ecca2cb3a738d2",
    "title": "2016-01-21 - NetTraveler Spear-Phishing Email Targets Diplomat of Uzbekistan",
    "authors": "",
    "file_creation_date": "2022-05-28T17:56:20Z",
    "file_modification_date": "2022-05-28T17:56:20Z",
    "file_size": 1788330,
    "plain_text": "# NetTraveler Spear-Phishing Email Targets Diplomat of Uzbekistan\n\n**[unit42.paloaltonetworks.com/nettraveler-spear-phishing-email-targets-diplomat-of-uzbekistan/](https://unit42.paloaltonetworks.com/nettraveler-spear-phishing-email-targets-diplomat-of-uzbekistan/)**\n\nVicky Ray, Robert Falcone January 21, 2016\n\nBy [Vicky Ray and](https://unit42.paloaltonetworks.com/author/vicky-khan/) [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nJanuary 21, 2016 at 8:45 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [NetTraveler,](https://unit42.paloaltonetworks.com/tag/nettraveler/) [spearphishing,](https://unit42.paloaltonetworks.com/tag/spearphishing/) [Trojan,](https://unit42.paloaltonetworks.com/tag/trojan/) [Ufa,](https://unit42.paloaltonetworks.com/tag/ufa/) [Ufe,](https://unit42.paloaltonetworks.com/tag/ufe/) [Uzbekistan,](https://unit42.paloaltonetworks.com/tag/uzbekistan/) [WildFire](https://unit42.paloaltonetworks.com/tag/wildfire/)\n\nUnit 42 recently identified a targeted attack against an individual working for the Foreign Ministry of Uzbekistan in China. A spear-phishing\nemail was sent to a diplomat of the Embassy of Uzbekistan who is likely based in Beijing, China. In this report, we’ll review how the actors\nattempted to exploit CVE-2012-0158 to install the NetTraveler Trojan.\n\nOn December 12, 2015, a spear-phishing email was sent to a diplomat of the Embassy of Uzbekistan. The body and subject of the email\nsuggests that the email was spoofed to look like it was sent by the Russian Foreign Ministry and the attachment may contain an official annual\n[report on CHS (Council of Heads of Member States), who form the SCO (Shanghai Cooperation Organization).](https://en.wikipedia.org/wiki/Shanghai_Cooperation_Organisation)\n\n_Filename: “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” (translated to: “2015.12.11_sroki CHS in 2015 Ufe.doc.doc”)_\n\n_Body: “С уважением, ДАТС МИД России” (translated to: “Yours faithfully, ACSD Russian Foreign Ministry”)_\n\n[It is interesting to note the reference of Ufa in the file name, as the city of Ufa in Russia hosted the SCO BRICS Summit on July 9 and 10,](http://ufa2015.com/)\n2015. SCO and BRICS (Brazil, Russia, India, China and South Africa) are intergovernmental international organizations focused on issues of\nregional security and economic cooperation.\n\n_Figure 1 Leaders of member nations at the 2015 Summit in Ufa_\n\n## TARGETING AND MALWARE ANALYSIS\n\nOur analysis shows that actors attempted to exploit CVE-2012-0158 to install NetTraveler Trojan.\n\n\n-----\n\n_gu e_ _a co ta_ _g t e_ _a c ous attac_ _e t_\n\nThe malicious attachment “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” is a malicious document created by the MNKit toolkit and exploits\nCVE-2012-0158.\n\n[Upon successful exploitation, the attachment will install the trojan known as NetTraveler using a DLL side-loading attack technique. The](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-dll-sideloading.pdf)\n[NetTraveler trojan has been known to be used in targeted cyber espionage attacks for more than a decade by nation state threat actors and](http://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/kaspersky-the-net-traveler-part1-final.pdf)\ncontinues to be used to target its victims and exfiltrate data.\n\nThe DLL side-loading attack technique has been gaining adoption within the cyber espionage realm by threat actors to bypass traditional\n[security systems. Unit 42 also published a blog last year discussing an unrelated attack where the DLL side-loading technique was used.](https://blog.paloaltonetworks.com/2015/05/plugx-uses-legitimate-samsung-application-for-dll-side-loading/)\n\nFigure 3 illustrates the exploitation and the infection flow of the malware.\n\n_Figure 3 Overview of the infection flow_\n\nThe document “2015.12.11_сроки СГГ 2015 в Уфе.doc.doc” exploits CVE-2012-0158 to drop a decoy file “~$.doc” and the actual payload\n“DW20.exe”. The decoy is a blank document with the meta data stripped.\n\nThe payload (DW20.exe) is a self-extracting (SFX) RAR archive that contains the following files:\n\n_RasTls.exe_\n_rastls.dll_\n_Sycmentec.config_\n\n\n-----\n\n_Figure 4 The payload(DW20.exe) is a SFX RAR archive_\n\nThe SFX RAR uses the following configuration to launch the embedded executable, which is a legitimate application created by Symantec that\nwill side load the rastls.dll DLL:\n\n_Setup=RasTls.exe_\n_TempMode_\n_Silent=1_\n_Overwrite=1_\n\nThe figure below shows that the config file, ‘Sycmentec.config’ is encrypted.\n\nThe ‘Sycmentec.config’ file can be decrypted using a single byte XOR algorithm using ‘0x77’ as a key.\n\n_Figure 5 Encrypted ‘Sycmentec.config’file_\n\nThe ‘rastls.dll’ DLL will load and decrypt this file. The decrypted data starts with shellcode that is responsible for loading an embedded DLL and\nexecuting it.\n\nFigure 6 shows the decrypted ‘Sycmentec.config’file containing an embedded DLL.\n\n\n-----\n\n_Figure 6 Decrypted ‘Sycmentec.config’ file contains an embedded DLL_\n\nThe embedded DLL is the functional payload, which is a variant of the NetTraveler Trojan that has the following attributes:\n\n**Size** 52736 bytes\n\n**Type** PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n**Architecture** 32 Bits binary\n\n**MD5** 3e3df4fe831d87d7f52f14933e464fc3\n\n**SHA1** cce65a0b67674a313091a947506ceb91d30605ad\n\n**SHA256** 3b4e4d7a0b1185a45968d90ffe6346f4621116d14dbf88b5138040acc022c757\n\n**ssdeep** 1536:jxKW1S8mWKFU7U9lYjhjXwVqTvS/G405:wCBmUw9lAhLWqW/G40\n\n**imphash** 85ce31f87f06b02fec915d33d82958e8\n\n**Date** 0x564B2B07 [Tue Nov 17 13:26:31 2015 UTC]\n\n**CRC:(Claimed)** 0x0, (Actual): 0x19be0 [SUSPICIOUS]\n\n**Packers** Armadillo v1.xx - v2.xx\n\n**Entry Point** 0x1000970b .text 1/5\n\n_Table 1 Attributes of the embedded DLL (NetTraveler)_\n\nThe first execution of this NetTraveler Trojan starts off with an installation process. Like previous versions, this NetTraveler sample writes its\nconfiguration to a file, in this case the configuration is written to a file named \"config.dat\".\n\n_Figure 7 NetTraveler writes the configuration to ‘config.dat’ file_\n\nDuring execution, NetTraveler creates a mutex of ‘YOYWOW!657’, as shown in Figure 8 below to avoid running multiple instances of its code.\n\n\n-----\n\n_Figure 8 Mutex created for this NetTraveler payload_\n\nThe code then enumerates the 'netsvcs' services, which are services that run within the process space of svchost.exe, specifically ignoring\nservices named ‘6to4’ and ‘Ias’ as these services have been used by other malware families.\n\nWhen it finds another netsvcs service with a name not matching these two names, it will delete the file associated with the service and copy\nthe ‘rastls.dll’ file to that folder using ‘<service name>ve.dll’ as the filename as shown in Figure 9 below.\n\n_Figure 9 Code enumerating ‘netsvcs’ services_\n\n\n-----\n\n_Figure 10 Renamed ‘rastls.dll’ DLL_\n\nThe malware will then change the binary path of the service to point to this new filename and copies the \"Sycmentec.config\" file to the same\nfolder and the ‘config.dat’ file to the following location:\n\n_c:\\windows\\system\\CERTAPL.DLL_\n\nThe NetTraveler payload relies on the ‘rastls.dll’ file to obtain its C2 server. At first glance, the NetTraveler payload appears as if it will use the\nfollowing URL for its C2 server:\n\n_http://192.168.3[.]201/downloader2013/asp/downloader.asp_\n\nHowever, the NetTraveler payload reads the last ‘0xb0’ bytes from the rastls.dll file and uses it to create the \"config.dat\" file that is later saved\nto \"CERTAPL.DLL\". This technique hides the true C2 server from researchers that do not have access to both the rastls.dll and\nSycmentec.config files.\n\n_Figure 11 Code snippet showing NetTraveler obtaining its configuration from rastls.dll._\n\n\n-----\n\ne co gu at o e s st uctu ed as a e as t e oja uses Get ate o eSt g to pa se t e co te ts e co gu at o e as\nthe following contents:\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\n[OOOOOO]\nU00P=r^?<80>}H>?<88><89><8A>B<8B><85>|<86><87><89><91><8B><90><92><88>N<84><91><90>S<94><96><9B><8C><8E><9E>Z\nK00P=XLMNOPQRSTUVWXYZ[\\]^_`abcdefghiv\nP00D=5\nF00G=True\nMM1=0\nMM6=1\n\n\nUnit 42 analyzed the sample and found the following configuration fields that could appear in the CERTAPL.DLL configuration file and a brief\ndescription of each field:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nU00P = C2 URL\nK00P = Key for DES\nP00D = Sleep interval in minutes\nF00G = Boolean to determine if sample should use proxy to communicate with C2 server\nMM1 = 0 or 1 if proxy is configured or not.\nMM3 = Port for configured proxy\nMM4 = Username for configured proxy\nMM5 = Password for configured proxy\nMM6 = 1 if Trojan is installed correctly\n\n\nThe \"U00P\" and \"K00P\" values are decrypted using a simple algorithm that subtracts the index and then subtracts ten from each character,\nwhich is depicted in the following:\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\ndef subtraction_algo(ct):\nout = \"\"\ni = 0\nfor e in ct:\nout += chr(ord(e)-i-10)\ni += 1\nreturn out\n\n\nThese two fields decrypt to the following, the U00P value being the C2 URL and the K00P value being the basis for an encryption key for the\nDES algorithm:\n\n_U00P: http://www.voennovosti.com/optdet/index.asp (decrypted)_\n\n_K00P: NAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM (decrypted)_\n\nThe C2 server will respond to requests issued by the Trojan with commands to carry out activities on the compromised system. We analyzed\nthe code within NetTraveler that handles commands issued by the C2 server and found four available commands that are listed in Table 2.\n\n**Command** **Description**\n\n\n<Unique System\nID>:UNINSTALL\n\n<Unique System\nID>:RUN_REBOOT\n\n<Unique System\nID>:RUN_STARTUP\n\n<Unique System\nID>:RUN_DIRECT\n\n\nDeletes %APPDATA%\\cert2013.dat and %STARTUP%\\consent.lnk and exits the process. This attempts to uninstall\nthe Trojan, but will not work as the filenames are not used by this version of NetTraveler\n\nReboots the system\n\nDownloads a file to %TEMP%\\Temp.bmp and copies it to the startup folder\n\nDownload a file to %TEMP%\\tmp.bmp and execute it\n\n\n_Table 2 Commands available within NetTraveler and a description of their functionality_\n\n## INFRASTRUCTURE\n\n[At the time of analysis, the domain voennovosti[.]com was resolving to IP ‘98.126.38[.]107’, which is hosted by Krypt Technologies. A report](http://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/kaspersky-the-net-traveler-part1-final.pdf)\npublished by Kaspersky Labs in 2011 on NetTraveler also mentions the C2 servers were being hosted by Krypt Technolgies. This web hosting\nservice provider continues to be the hosting provider of choice for the threat actors behind NetTraveler.\n\n\n-----\n\n_Figure 12 DNS query for voennovosti[.]com resolves to ‘98.126.38.107’_\n\n_Figure 13 Encoded network communications_\n\n## CONCLUSION\n\nNetTraveler has been used to target diplomats, embassies and government institutions for over a decade, and remains the tool of choice by\nthe adversaries behind these cyber espionage campaigns. The use of NetTraveler for such a long period of time shows its effectiveness and\nsuccess by the adversaries in targeting their victims with impunity.\n\nAs seen in this case, the threat actors continue to evolve and employ new techniques within their modus operandi, like ‘DLL side-loading’ to\ninstall malware. It is likely that the use of ‘DLL side loading’ attack technique will increase due to it’s effectiveness to bypass traditional security\nsystems.\n\nIt is essential to raise awareness on such attacks to better protect organizations from adversaries who maybe backed by nation states.\n\n[WildFire correctly classifies NetTraveler as malicious. AutoFocus tags are created to identify NetTraveler samples and respective IOCs are](https://www.paloaltonetworks.com/products/technologies/wildfire.html)\n[added to Palo Alto Networks Threat Prevention.](https://paloaltonetworks.com/solutions/initiative/threat-prevention.html)\n\n## INDICATORS\n\n**SHA256 Hash** **File Name**\n\n3f4fcde99775b83bc88d30ca99f5c70c1dd8b96d970dbfd5a846b46c6ea3e534 2015.12.11_сроки СГГ 2015 в Уфе.doc.doc\n\n001fff6c09497f56532e83e998aaa80690a668883b6655129d408dd098bd1b4b DW20.exe\n\n74db11900499aa74be9e62d51889e7611eb8161cd141b9379e05eeca9d7175c9 rastls.dll\n\n8f6af103bf7e3201045ce6c2af41f7a17ef671f33f297d36d2aab8640d00b0f0 Sycmentec.config\n\n495bb9c680f114b255f92448e784563e4fd34ad19cf616cc537bec6245931b7e config.dat\n\n41650cb6b4ae9f06c92628208d024845026c19af1ab3916c99c80c6457bd4fa9 CERTAPL.DLL\n\n3b4e4d7a0b1185a45968d90ffe6346f4621116d14dbf88b5138040acc022c757 (NetTraveler DLL payload)\n\n**Command and Control**\n\n\n-----\n\noe o ost [ ]co\n98.126.38[.]107\n\n## REFERENCES\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-21 - NetTraveler Spear-Phishing Email Targets Diplomat of Uzbekistan.pdf"
    ],
    "report_names": [
        "2016-01-21 - NetTraveler Spear-Phishing Email Targets Diplomat of Uzbekistan.pdf"
    ],
    "threat_actors": [
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "254f2fab-5834-4d90-9205-d80e63d6d867",
            "created_at": "2023-01-06T13:46:38.31544Z",
            "updated_at": "2025-03-27T02:00:02.802896Z",
            "deleted_at": null,
            "main_name": "APT21",
            "aliases": [
                "HAMMER PANDA",
                "TEMP.Zhenbao",
                "NetTraveler"
            ],
            "source_name": "MISPGALAXY:APT21",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536051,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653760580,
    "ts_modification_date": 1653760580,
    "files": {
        "pdf": "https://archive.orkl.eu/fc09c97722173fcf0a45553676ecca2cb3a738d2.pdf",
        "text": "https://archive.orkl.eu/fc09c97722173fcf0a45553676ecca2cb3a738d2.txt",
        "img": "https://archive.orkl.eu/fc09c97722173fcf0a45553676ecca2cb3a738d2.jpg"
    }
}