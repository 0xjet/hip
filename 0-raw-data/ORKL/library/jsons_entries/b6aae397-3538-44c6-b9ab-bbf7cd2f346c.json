{
    "id": "b6aae397-3538-44c6-b9ab-bbf7cd2f346c",
    "created_at": "2023-01-12T15:02:36.209647Z",
    "updated_at": "2025-03-27T02:05:34.110182Z",
    "deleted_at": null,
    "sha1_hash": "612b25e1e3cdeb989cc73b7c220447bd03f38782",
    "title": "2020-09-25 - Magento Credit Card Stealing Malware- gstaticapi",
    "authors": "",
    "file_creation_date": "2022-05-28T04:03:13Z",
    "file_modification_date": "2022-05-28T04:03:13Z",
    "file_size": 246791,
    "plain_text": "# Sucuri Blog\n\n**[blog.sucuri.net/2020/09/magento-credit-card-stealing-malware-gstaticapi.html](https://blog.sucuri.net/2020/09/magento-credit-card-stealing-malware-gstaticapi.html)**\n\nKrasimir Konov September 25, 2020\n\nOur team recently came across a malicious script used on a Magento website titled\n**gstaticapi, which targeted checkout processes to capture and exfiltrate stolen information.**\n\nTo obtain sensitive details, the malware loads external javascript whenever the URL contains\n“checkout” — this location typically belongs to the step in Magento’s checkout process where\nusers enter their sensitive credit card information and shipping details.\n\nAs seen above, the first if statement looks for the checkout string in the URL using\n**window.location.href.indexOf.**\n\nWhen decoded, the base64 string “Y2hlY2tvdXQ=” equates to “checkout”:\n\n\n-----\n\nThe code creates a script element, where script.src= has been set to another base64 string\nequal to gstaticapi[.]com/gs.js.\n\nThe JavaScript is added to the header of the web page’s document where the external code\ncan be loaded, handling all the heavy lifting to steal and exfiltrate the credit card information\nand billing details.\n\nWhile the script consists of only five lines, it can be combined into a single line to make it\nmore difficult to detect. And unless you know exactly which strings to look for, a search for\nany associated domains will be difficult since they are all encoded.\n\n[To detect these types of injections, your best bet is to leverage a website monitoring service](https://sucuri.net/malware-detection-scanning/)\nthat can detect changes on both externally and at the server level.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-25 - Magento Credit Card Stealing Malware- gstaticapi.pdf"
    ],
    "report_names": [
        "2020-09-25 - Magento Credit Card Stealing Malware- gstaticapi.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535756,
    "ts_updated_at": 1743041134,
    "ts_creation_date": 1653710593,
    "ts_modification_date": 1653710593,
    "files": {
        "pdf": "https://archive.orkl.eu/612b25e1e3cdeb989cc73b7c220447bd03f38782.pdf",
        "text": "https://archive.orkl.eu/612b25e1e3cdeb989cc73b7c220447bd03f38782.txt",
        "img": "https://archive.orkl.eu/612b25e1e3cdeb989cc73b7c220447bd03f38782.jpg"
    }
}