{
    "id": "8bbd7adf-23f6-444f-9945-5a1d4485aeee",
    "created_at": "2023-01-12T15:00:11.730088Z",
    "updated_at": "2025-03-27T02:05:37.395125Z",
    "deleted_at": null,
    "sha1_hash": "fb99a79ea494bce008edee09229a720766a39bcd",
    "title": "2022-06-15 - New IceXLoader 3.0 – Developers Warm Up to Nim",
    "authors": "",
    "file_creation_date": "2022-07-18T18:23:54Z",
    "file_modification_date": "2022-07-18T18:23:54Z",
    "file_size": 686559,
    "plain_text": "# New IceXLoader 3.0 – Developers Warm Up to Nim\n\n**[fortinet.com/blog/threat-research/new-icexloader-3-0-developers-warm-up-to-nim](https://www.fortinet.com/blog/threat-research/new-icexloader-3-0-developers-warm-up-to-nim)**\n\nJune 15, 2022\n\nFortiGuard Labs has encountered version 3.0 of what is now dubbed IceXLoader, a new\nmalware loader being advertised in malware hacking forums.\n\nIceXLoader is a commercial malware used to download and deploy additional malware on\n[infected machines. The latest version is written in Nim, a relatively new language utilized by](https://nim-lang.org/)\nthreat actors the past two years, most notably by the NimzaLoader variant of BazarLoader\nused by the TrickBot group.\n\nThis article discusses the technical details of how IceXLoader behaves and the potential\nmalware that it can deliver in an infected system.\n\n**Affected Platforms: Windows**\n\n**Impacted Parties: Windows users**\n**Impact: Potential to deploy additional malware for malicious purposes**\n\n\n-----\n\n**Severity Level: Medium**\n\n## The ICE X Project\n\nWhile hunting for new malware families written in the Nim programming language,\n[FortiGuard Labs discovered a loader malware with the strings “ICE_X” and “v3.0”.](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguardlabs)\n\nA loader is a type of malware that is intended for downloading and executing additional\npayloads provided by a threat actor to further their malicious objectives.\n\nCollected samples had some incomplete features, for example the code for using a mutex for\nrunning only a single instance of the malware is only comprised of dummy code. When\ncoupled with the “v3.0” string (implying the presence of earlier versions of a similar malware),\nwe suspected that this was a work-in-progress port of an existing malware to Nim.\n\nTo validate our hypothesis, we dug deeper and found links to underground forums where the\ndevelopers sell the loader as ICE X at $118 for a lifetime license (Figure 1).\n\nFigure 1: ICE X advertisement in a forum website\n\nThe malware developers’ website (Figure 2), sells several commodity malware and provides\nrelated services including hacking, crypting, and malware development. The team of four\nclaims 14 years of experience in the business with more than 200 clients.\n\nFigure 2. IceXLoader malware developer website\n\nFortiGuard Labs researchers chose to name this malware family IceXLoader based on the\n“ICE_X” strings found in both version 1 and version 3 samples. As there are similarly-named\n[Ice IX / IceX variants of the Zeus banking trojan, we appended Loader to the name to avoid](https://malpedia.caad.fkie.fraunhofer.de/details/win.ice_ix)\nconfusion with these older banking trojans.\n\n## New Version, New Language\n\nThe developers provided a video to demonstrate configuring the IceXLoader builder with a\nServer URL containing the familiar Command & Control (C2) URL pattern “icex/Script.php”\nseen in our samples (Figure 3).\n\nFigure 3. IceXLoader builder configuration\n\nIn the same video, the developers showed an IceXLoader version 1 client connected to the\nC2 server panel (Figure 4), which was likely the production version at that time.\n\nFigure 4. C2 server panel showing the IceXLoader version 1 client\n\n\n-----\n\nPivoting around the known C2 URLs for IceXLoader allowed us to collect version 1 samples\nwritten in the AutoIt scripting language.\n\nThe almost identical implementation of the functions from the two versions confirmed our\nsuspicions that the Nim-based loader is a newer version of the more feature-complete\nIceXLoader version 1 (Figure 5).\n\nFigure 5. getinfo() function comparison between IceXLoader version 1 and 3\n\nThe developers market their loader as FUD (Fully UnDetected), a common term used within\nmalware hacking forums to denote malware that can bypass antivirus products. They also\nclaim that they will continuously update it as security products eventually detect such\nmalware.\n\nThis need to evade security products could be a reason the developers chose to transition\nfrom AutoIt to Nim for IceXLoader version 3. Since Nim is a relatively uncommon language\nfor applications to be written in, threat actors take advantage of the lack of focus on this area\nin terms of analysis and detection.\n\nThe following technical analysis will focus primarily on IceXLoader version 3. However,\ncomparisons to old versions are mentioned where necessary.\n\n## Technical Details\n\nThe IceXLoader builder generates a standalone executable EXE file with the chosen\nconfiguration values hardcoded into each file that a threat actor can distribute to potential\nvictims.\n\nOnce this file is executed on a victim machine, it initializes itself based on the configured\nsettings.\n\n**Persistence**\n\nIf configured, IceXLoader utilizes Windows startup features commonly abused by malware to\nsurvive system reboots. It copies itself to %AppData%\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\ with a configurable filename.\n\nAt the same time, it adds a registry entry in Software\\Microsoft\\Windows\\CurrentVersion\\Run\nwith the value set to a second copy previously dropped in %AppData%.\n\nAs the mutex implementation is incomplete in the version 3 samples, multiple instances of\nIceXLoader will run when Windows restarts.\n\n**Evasion**\n\n\n-----\n\nIceXLoader performs a known method of in-memory patching of AmsiScanBuffer in\nAMSI.DLL. It does this to bypass the Microsoft Windows Antimalware Scan Interface used by\nsecurity products to scan and detect malicious content. This reduces the chance of\nIceXLoader and its subsequent malware payloads being detected.\n\nIt then writes some PowerShell commands to %TEMP%\\file.bat (Figure 6) and executes\nthem to disable Windows Defender’s real-time scan. Moreover, it adds exclusions to\nWindows Defender to prevent it from scanning the directory where IceXLoader is located.\n\nFigure 6. PowerShell commands used to evade detection\n\nOnce the malware has completed initialization, it proceeds to communicate with the C2 to\ncarry out further actions in the victim system.\n\n**Client-Server Communication Protocol**\n\nIceXLoader communicates with a hardcoded list of C2 servers via HTTP/HTTPS POST\nrequests. The User-Agent HTTP header is set to the Windows machine GUID, which\nuniquely identifies each infected machine. This could be referred to as a victim ID.\nCommunication between the loader and C2 is in plaintext and is not encoded or encrypted.\n\nFigure 7 demonstrates the communication flow between IceXLoader and its C2 server. The\n“info” command is used as an example below, but other commands use a similar flow:\n\nFigure 7. IceXLoader client-server communication\n\nAn initial beaconing POST request with “SetOn=On” is sent by IceXLoader to notify the C2\nthat it is ready to receive commands.\n\nThe C2 server usually responds with an “info” command to register the loader as a valid\nclient in the server panel. The client acknowledges the command by responding with “Done=\n_<command><|>” i.e., “Done=info<|>”. After that, the client executes the command._\n\nFor the “info” command, IceXLoader collects the following information and sends it to the C2\nserver\n\nNickname (set by malware operator and hardcoded in binary sample, “ICE X” by\ndefault)\nVictim ID\nUsername and machine name and whether user has administrative privileges\nWindows OS version\nInstalled antivirus products\nPresence of .NET Framework v2.0 and/or v4.0\nLoader version (hardcoded in binary sample)\nTotal amount of installed memory\n\n\n-----\n\nProcessor name\nGraphics card name\n\nFigure 8 shows an HTTP POST request with all the information gathered from the victim\nsystem.\n\nFigure 8. POST request with the gathered information\n\n## Commands\n\nOnce the system info is sent to the C2 server, IceXLoader regularly repeats the beaconing\nrequest to poll for additional commands.\n\nThe list of all the commands supported by IceXLoader can be found below. The pipe “|”\ncharacter is used to separate options for the commands. Words in italics refer to values\nsupplied by the threat actor.\n\n**close: Stop execution**\n**info: Collect system info and send it to C2**\n**msg|MESSAGE: Display a dialog box with specified message**\n**restart: Restart the loader**\n**runFile|URL|TEMP_FILE_NAME: Send a GET request to download a file from URL to**\n%TEMP% as TEMP_FILE_NAME and then open it with “cmd /c”. The advantage of\nusing “cmd /c” is the ability to open any file type registered on the system, e.g., .txt files\nor Office documents. It is not limited to just executable files\n**runFile|URL|mem|True: Send a GET request to download an executable file from**\nURL and run it from memory\n**runFile|URL|mem|False: Not fully implemented in version 3. This command loads and**\nexecutes a .NET assembly in version 1\n**Sleep|INTERVAL: Change the C2 server beaconing interval to the new value specified**\nby INTERVAL (in milliseconds)\n**Update: Current implementation in version 3 is identical to the “runFile” command, but**\noriginal implementation in version 1 was designed for updating IceXLoader itself\n**uninstall: Remove all copies of itself from disk and stop running**\n\nAs the main function of IceXLoader, the malware operator can interactively send “runFile”\ncommands to the loader to download and execute additional malware on disk or filelessly in\nmemory.\n\n## Infection Chains\n\nPrevious campaigns spotted in the wild distributed DcRat via IceXLoader version 1 and an\nunknown malware with an associated Monero (XMR) miner via IceXLoader version 3.\n\n\n-----\n\nThe infection chains observed during earlier campaigns are illustrated below.\n\n**Malspam-delivered IceXLoader leads to DcRat (May 2022)**\n\nIceXLoader version 1 has been observed to be delivered through ZIP email attachments.\nThe infection chain illustrated in Figure 9 is based on a submission by Andre Girondo at\n[MalwareBazaar.](https://bazaar.abuse.ch/sample/fecfca77593850e4f6deb8090fc35b14366ab27ef0ada833f940b2d4cb381509/)\n\nFigure 9. Malspam infection chain\n\nAn email with a ZIP file attachment masquerading as an invoice is sent to unsuspecting\nvictims. If a user unzips and executes the invoice.exe, this .NET executable drops and\nexecutes IceXLoader version 1. The attacker issues the runFile command to download and\nexecute DcRat, a publicly available .NET-based Remote Access Tool (RAT).\n\n## Multi-stage .NET loader drops IceXLoader to mine Monero (June 2022)\n\nFigure 10. Multi-stage .NET loader infection chain\n\nA simple .NET downloader malware downloads and executes a .NET dropper, which then\nextracts and runs an IceXLoader version 3 embedded in itself. IceXLoader then receives the\ncommand to download an unknown malware. While FortiGuard Labs researchers were\nunable to obtain a sample of this malware, the accompanying configuration file suggested\nthat this malware was likely a RAT or infostealer that will additionally deploy a Monero (XMR)\ncryptocurrency miner.\n\nFortiGuard Labs is unable to confirm how the initial .NET downloader was delivered to\nvictims. Based on the filenames of similar samples, they may have masqueraded as fake or\ncracked game-related installers.\n\n## Conclusion\n\nIn this article, we highlighted how threat actors continually evolve to evade and deter\ndetection of their malware to the extent of porting existing code to a different and uncommon\nlanguage. While simple and limited in functionality, loaders like IceXLoader pose a threat to\nusers due to the possibility of threat actors deploying more full-featured malware upon\ninfection.\n\nFortiGuard Labs will continue to monitor IceXLoader and emerging trends in the loader threat\nlandscape.\n\n## Protections\n\n\n-----\n\nThe FortiGuard Antivirus service detects and blocks this threat as W32/IceXLoader.FGLT!tr.\n\nFortinet customers are protected from this malware through FortiGuard’s [Web Filtering,](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/web-filtering.html?utm_source=blog&utm_campaign=web-filtering)\n[Antivirus, and](https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/antivirus) [CDR (content disarm and reconstruction) services and FortiMail,](https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/content-disarm-reconstruction) [FortiClient,](https://www.fortinet.com/products/endpoint-security/forticlient.html?utm_source=blog&utm_campaign=endpoint-web-page)\n[and FortiEDR solutions.](https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=fortiedr)\n\nLoaders like IceXLoader are commonly delivered via phishing. Organizations should\nconsider leveraging Fortinet solutions designed to train users to understand and detect\nphishing threats:\n\nThe [FortiPhish Phishing Simulation Service uses real-world simulations to help](https://www.fortinet.com/products/phishing-simulation)\norganizations test user awareness and vigilance to phishing threats and to train and\nreinforce proper practices when users encounter targeted phishing attacks.\n\nWe also suggest that organizations have their end users go through our free NSE\ntraining: [NSE 1 – Information Security Awareness. It includes a module on Internet](https://training.fortinet.com/local/staticpage/view.php?page=nse_1&utm_source=blog&utm_campaign=nse-1)\nthreats that is designed to help end users learn how to identify and protect themselves\nfrom various types of phishing attacks.\n\n## IOCs\n\n**Files (SHA256)**\n\n6d98c8bdb20a85ef44677f3e7eed32c9fee0c18354e3365c28e11cb6130a8794\n\n4eaed1357af8b4f757c16d90afb339161ac73fa4b8d867a416664b89a1d0a809\n\n3a838c22312f4279f400b7eee63918d9232907a1aa483c824cb8a815150f06e8\n\n4c26dbee513067e6d327e4b336b29992fd5270a0a8ecd1e9571378a3fb0bdc60\n\n4fe56d88c1170a3d0e025b9d8f7939139a7618b3868eb993037c6e3b52d9d501\n\nfecfca77593850e4f6deb8090fc35b14366ab27ef0ada833f940b2d4cb381509\n\n619356420efd4dc53704fb5eb5c93f1f5d4a0123ed1fdd5ce276a832381de51d\n\n915f0d1e9bd1b681d9935af168cb9f1823c738b869fb2c3646f81098a0fe5d95\n\n**C2 URLs**\n\nhxxp[:]//kulcha[.]didns[.]ru:8080/Script.php\n\nhxxp[:]//golden-cheats[.]com/icex/Script.php\n\nhxxps[:]//r4yza92[.]com/Script.php\n\n\n-----\n\nhxxp[:]//62[.]197[.]136[.]240/script.php\n\nhxxp[:]//funmustsolutions[.]site/wp-includes/icex/Script.php\n\nhxxps[:]//north[.]ac/pxnel.php\n\nhxxp[:]//hhj[.]jbk0871[.]fun/study/Script.php\n\n**Download URLs**\n\nhxxp[:]//funmustsolutions[.]site/wp-includes/icex/Files/Client.exe\n\nhxxp[:]//funmustsolutions[.]site/wp-includes/icex/Files/Loader.exe\n\nhxxp[:]//golden-cheats[.]com/icex/Files/BadforICE.exeBadforICE.exe\n\nhxxp[:]//golden-cheats[.]com/remote-config.json\n\nhxxp[:]//golden-cheats[.]com/loader/uploads/InstallerLoader_Wjyhorou.bmp\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[and the FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-15 - New IceXLoader 3.0 – Developers Warm Up to Nim.pdf"
    ],
    "report_names": [
        "2022-06-15 - New IceXLoader 3.0 – Developers Warm Up to Nim.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535611,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1658168634,
    "ts_modification_date": 1658168634,
    "files": {
        "pdf": "https://archive.orkl.eu/fb99a79ea494bce008edee09229a720766a39bcd.pdf",
        "text": "https://archive.orkl.eu/fb99a79ea494bce008edee09229a720766a39bcd.txt",
        "img": "https://archive.orkl.eu/fb99a79ea494bce008edee09229a720766a39bcd.jpg"
    }
}