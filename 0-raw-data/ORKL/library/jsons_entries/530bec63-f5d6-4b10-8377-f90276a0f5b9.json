{
    "id": "530bec63-f5d6-4b10-8377-f90276a0f5b9",
    "created_at": "2023-01-12T15:04:24.710942Z",
    "updated_at": "2025-03-27T02:06:06.645342Z",
    "deleted_at": null,
    "sha1_hash": "d76003b61a0b4e7a01838378862bedc0b11b7272",
    "title": "2020-02-06 - 40,000 CryptBot Downloads per Day- Bitbucket Abused as Malware Slinger",
    "authors": "",
    "file_creation_date": "2022-05-28T02:21:30Z",
    "file_modification_date": "2022-05-28T02:21:30Z",
    "file_size": 419850,
    "plain_text": "# 40,000 CryptBot Downloads per Day: Bitbucket Abused as Malware Slinger\n\n**[gdatasoftware.com/blog/2020/02/35802-bitbucket-abused-as-malware-slinger](https://www.gdatasoftware.com/blog/2020/02/35802-bitbucket-abused-as-malware-slinger)**\n\n02/06/2020\n\nG DATA Blog\nPublic source code repository at Bitbucket.org was as abused to host CryptBot, Buer loader with NuclearBot and\nCryptominer.\n\n## AutoHotkey Downloader\n\nWe found the Bitbucket repository via a malicious AutoHotkey downloader[1]. The AutoHotkey script is located in the\nPE resources with the RCDATA resource type. We used Resource Hacker to access the script (see image below).\n\n[The downloader checks IP and location information of the infected system via http://ip-api.com/line/ and puts the](http://ip-api.com/line/)\n[result into %TEMP%/ip_.txt. Then it calls two shortened URLs at https://iplogger.org. This URL shortener service](https://iplogger.org/)\nprovides statistics and location tracking for the shortened links. The site's content is downloaded to\n%TEMP%/loger.txt and %TEMP%/loger2.txt.\n\n\nIt proceeds to check the country code in ip_.txt and will download PCBoosterSetup.exe[8] for the following country\ncodes: TR, FR, US, DE, GB, HR, HU, RO, PL, IT, PT, ES, CA, DK, AT, NL, AU, AR, NP, SE, BE, NZ, SK, SO, GR,\nBG\n\n\n-----\n\nAutoHotkey script in PE resources\nPCBoosterSetup.exe is an installer for PC Booster by Energizer Softech. This software is not malicious, but\n[potentially unwanted. The AutohotKey downloader was submitted by the name setupres.exe to VirusTotal, so it is](https://www.virustotal.com/gui/file/7d1c47f69805ec4009c0620dadbddeff7a1eaa98eb5a296fbc6ba4cd479c706b/detection)\nprobably advertised and distributed as PC Booster installer making this a classic trojan horse.\n\nThe trojan downloads and executes three files from a public Bitbucket.org repository to %APPDATA%: 1.exe, 3.exe,\nand 4.exe. Only two of those files were present on Friday evening, 31. January 2020, when we first analysed the\ntrojan.\n\n## Lewis Shields' Bitbucket Repository\n\nThe Bitbucket repository \"new\" by the user Lewis Shields contains no source code but three binary files in the\ndownloads section. Two of which are downloaded by the AutohotKey sample[1].\n\nThe repository exists since 16. January 2020. The files are renewed every few hours, the intervals are different for\neach file. We observed renewal of 1.exe and 4.exe approximately every 5 hours, and renewal of 9.exe approximately\nonce a day.\n\n\n**Filename**\n\n\n**Approximate download rate (observed from 31.Jan.2020 to**\n**3.Feb.2020)** **Malware family**\n\n\n1.exe 800 downloads per hour Buer loader and\nNuclearBot\n\n4.exe 2,700 downloads per hour Coinminer loader\n\n9.exe 1,800 downloads per hour CryptBot\n\nThat means there are more downloaders that access this repository. We downloaded two sets of samples and\nidentified the malware families.\n\nWe contacted technical support of Atlassian on Friday afternoon and notified them about the malware hosting\nrepository. Reporting took a bit of effort because it required registration and the forms weren't suited for security\nissues. On Monday morning an employee at Atlassian contacted me via Twitter because they had seen our tweet. It\nwas due to said employee that the repository was taken down on Monday, 3. February 2020, 67 hours after our\nreport. Given the approximate download rates, more than 355,100 downloads were done during that time frame.\n\n\n-----\n\nThe download section of LewisShields Bitbucket repository providing malware\n\n## Buer Shipping NuclearBot\n\nAll Lewis Shields' samples are packed with Themida. We identified the samples[2][3] named \"1.exe\" as Buer loader\nwith NuclearBot aka TinyNuke. It creates a file in C:\\ProgramData\\UBlockPlugin\\plugin.exe and executes it. The\nprocess tree of VMRay shows process injection via CreateRemoteThread from plugin.exe into secinit.exe.\n\n\n[NuclearBot is classified as banking trojan. According to Malpedia criminals put up the malware for sale for 25000](https://malpedia.caad.fkie.fraunhofer.de/details/win.tinynuke)\n[USD in 2016. Its source code was published on Github in the meantime and the author of NuclearBot has been](https://github.com/m0n0ph1/malware-1/tree/master/TinyNuke)\n[arrested in 2019.](https://krebsonsecurity.com/2019/12/nuclear-bot-author-arrested-in-sextortion-case/)\n\n## CryptBot Infostealer Infects Thousands\n\n[The samples named \"9.exe\"[6][7] are infostealer which were identified as CryptBot by @benkow_@StopMalvertisin](https://twitter.com/benkow_)\n[and @James_inthe_box in this](https://twitter.com/James_inthe_box) [Twitter thread. CryptBot made](https://twitter.com/struppigel/status/1224694000071979008) [news on Bleepingcomputer in December 2019 for](https://www.bleepingcomputer.com/news/security/fake-vpn-site-pushes-cryptbot-and-vidar-info-stealing-trojans/)\nbeing installed via a fake VPN site. Among others it steals credentials for browsers, crypto currency wallets, browser\n[cookies, and creates screenshots of the infected system. @benkow_ also told us that CryptBot provides access to a](https://twitter.com/benkow_/status/1224709813986320387)\nstatistics panel for guests to check infected systems worldwide (see image below).\n\nUsing that panel we can check stats for certain countries during the time frame the repository was still up. Below is\nthe top 15.\n\n**Nr** **Country** **Number of infected systems**\n\n1 IN 5112\n\n2 ID 2747\n\n3 BR 2216\n\n4 PK 1837\n\n\n-----\n\n**Nr** **Country** **Number of infected systems**\n\n5 US 1325\n\n6 PH 1325\n\n7 TR 1277\n\n8 EG 1239\n\n9 VN 938\n\n10 IT 888\n\n11 TH 873\n\n12 DE 846\n\n13 FR 834\n\n14 MX 822\n\n15 KR 759\n\nThe sum of entries in that time frime amounts to 41,620, which is 627 entries per hour. The download rate of\nCryptBot samples in LewisShields' repository on the other hand was about 1,800 per hour. So we know that at least\ntwo thirds of those downloads do not lead to an infection. It is very likely that other CryptBot hosts are used, which\nmakes the rate of downloads not leading to infection higher than that. Those non-infective downloads may stem from\nautomated analysis systems or they are due to Antivirus products which didn't stop the downloader but the CryptoBot\nsample from executing.\n\n\n-----\n\nCryptBot statistics panel for guests\n\n## Reaction Times are Crucial\n\nGiven the number of ca 355,100 malware downloads for the time frame from reporting to take down of the repository,\nwe can see that early reaction times are crucial. This includes easy access with tailored forms to contact support for\nsecurity related issues. It also includes having security savvy employees to recognize the importance of the issue\nand respond to the situation in time. In this case it was due to Twitter and an observant employee that the malware\nhosting repo was taken down 67 hours after report.\n\n## Sample Hashes\n\n**Sample** **Filename** **SHA256**\n\n\n\n[1]\nAutohotkey\nDownloader\n\n[2] Buer,\nNuclearBot\n\n\nsetupres.exe 7d1c47f69805ec4009c0620dadbddeff7a1eaa98eb5a296fbc6ba4cd479c706b\n\n1.exe 6e713cf82173de60a69dc7ed84d3b006aeb35e8058553155eee674452e1e2017\n\n\n-----\n\n**Sample** **Filename** **SHA256**\n\n\n\n[3] Buer,\nNuclearBot\n\n[4]\nCoinminer\nloader\n\n[5]\nCoinminer\nloader\n\n\n1.exe b68ee1ba36aa100a393710bc06142a742d7e59d62b8204ec4991625467c189b2\n\n4.exe c215fdd20f2cda8177c79e7b4b5f0d97ed5dd858e3376f5746dfc99c475329b1\n\n4.exe fd60c32090c2171e6fa227e2bc29f72a1c28555f62ea2f01a334fa72af87ab00\n\n\n\n[6] CryptBot 9.exe 3c3bd6438dbaa3fd9727f0bf699c5e61f02de1e8896d7e87a5d6436b2d844d81\n\n[7] CryptBot 9.exe 2f2db989204f89ae8d8512ff0168857a7c613c4a26d0817ffd93a552f1ce96bc\n\n\n\n[8] PC\nBooster\nInstaller by\nEnergizer\nSoftech\n\n**Karsten Hahn**\n\n\nPCBoosterSetup.exe 636a31559c9a532a8ada119380129f9362f6c68b3456228766b3672ae3d676d8\n\n\nMalware Analyst\n\n**Related articles:**\n\nHTML Smuggling and GitHub Hosted Malware\n\nSometimes we see odd stuff, like malware that employs a technique called \"HTML Smuggling\". Also, malware on\nGitHub seems to be a thing these days.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-06 - 40,000 CryptBot Downloads per Day- Bitbucket Abused as Malware Slinger.pdf"
    ],
    "report_names": [
        "2020-02-06 - 40,000 CryptBot Downloads per Day- Bitbucket Abused as Malware Slinger.pdf"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "edc11896-f4f1-4132-9c38-d073ccdcf5b6",
            "created_at": "2022-10-25T16:07:23.576476Z",
            "updated_at": "2025-03-27T02:02:09.873658Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "ATK 97",
                "Operation HpReact",
                "TAG-NS1",
                "TEMP.Andromeda"
            ],
            "source_name": "ETDA:El Machete",
            "tools": [
                "El Machete",
                "ForeIT",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Pyark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba4f277c-c3da-45e6-a2fb-4ed556dbae64",
            "created_at": "2023-01-06T13:46:38.605117Z",
            "updated_at": "2025-03-27T02:00:02.871423Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "G0095",
                "machete-apt"
            ],
            "source_name": "MISPGALAXY:El Machete",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535864,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653704490,
    "ts_modification_date": 1653704490,
    "files": {
        "pdf": "https://archive.orkl.eu/d76003b61a0b4e7a01838378862bedc0b11b7272.pdf",
        "text": "https://archive.orkl.eu/d76003b61a0b4e7a01838378862bedc0b11b7272.txt",
        "img": "https://archive.orkl.eu/d76003b61a0b4e7a01838378862bedc0b11b7272.jpg"
    }
}