{
    "id": "8003e14d-c734-4978-8542-a1f974e26c4b",
    "created_at": "2023-01-12T15:09:27.650127Z",
    "updated_at": "2025-03-27T02:09:18.647464Z",
    "deleted_at": null,
    "sha1_hash": "8b38cd05f7276c61f6eedd8385863221e705b049",
    "title": "2017-11-16 - CACTUSTORCH- Payload Generation for Adversary Simulations",
    "authors": "",
    "file_creation_date": "2022-05-29T01:38:54Z",
    "file_modification_date": "2022-05-29T01:38:54Z",
    "file_size": 111549,
    "plain_text": "# mdsecactivebreach/CACTUSTORCH: CACTUSTORCH: Payload Generation for Adversary Simulations\n\n**github.com/mdsecactivebreach/CACTUSTORCH**\n\nmdsecactivebreach\n```\n                (       ) (      ) \n  (  (    (  *  )   )\\ ) *  ) ( /( )\\ ) (  ( /( \n  )\\  )\\   )\\ ` ) /(  ( (()/(` ) /( )\\())(()/( )\\ )\\()) \n (((_|(((_)( (((_) ( )(_)) )\\ /(_))( )(_)|(_)\\ /(_)|((_)((_)\\ \n )\\___)\\ _ )\\ )\\___(_(_())_ ((_|_)) (_(_()) ((_)(_)) )\\___ _((_) \n((/ __(_)_\\(_|(/ __|_  _| | | / __||_  _| / _ \\| _ ((/ __| || | \n | (__ / _ \\ | (__ | | | |_| \\__ \\ | | | (_) |  /| (__| __ | \n \\___/_/ \\_\\ \\___| |_| \\___/|___/ |_|  \\___/|_|_\\ \\___|_||_| \n\n## Author and Credits\n\n```\nAuthor: Vincent Yiu (@vysecurity)\n\nCredits:\n\n@cn33liz: Inspiration with StarFighters\n@tiraniddo: James Forshaw for DotNet2JScript\n@armitagehacker: Raphael Mudge for idea of selecting 32 bit version on 64 bit\narchitecture machines for injection into\n@_RastaMouse: Testing and giving recommendations around README\n@bspence7337: Testing\n\n\n-----\n\n## Description\n\nA JavaScript and VBScript shellcode launcher. This will spawn a 32 bit version of the binary\nspecified and inject shellcode into it.\n\n[DotNetToJScript can be found here: https://github.com/tyranid/DotNetToJScript](https://github.com/tyranid/DotNetToJScript)\n\n## Usage:\n\nChoose a binary you want to inject into, default \"rundll32.exe\", you can use\nnotepad.exe, calc.exe for example...\n\nGenerate a 32 bit raw shellcode in whatever framework you want. Tested: Cobalt\nStrike, Metasploit Framework\n\nRun: cat payload.bin | base64 -w 0\n\nFor JavaScript: Copy the base64 encoded payload into the code variable below\n\n```\nvar code = \"<base64 encoded 32 bit raw shellcode>\";\n\n```\n\nFor VBScript: Copy the base64 encoded payload into the code variable below\n\n```\nDim code: code = \"<base64 encoded 32 bit raw shellcode>\"\n\n```\n\nThen run:\n```\nwscript.exe CACTUSTORCH.js or wscript.exe CACTUSTORCH.vbs via command line on\n\n```\nthe target, or double click on the files within Explorer.\n\nFor VBA: Copy the base64 encoded payload into a file such as code.txt\n\nRun python splitvba.py code.txt output.txt\n\nCopy output.txt under the following bit so it looks like:\n```\n   code = \"\"\n   code = code & \"<base64 code in 100 byte chunk\"\n   code = code & \"<base64 code in 100 byte chunk\"\n\n```\nCopy and paste the whole payload into Word Macro\n\nSave Word Doc and send off or run it.\n\n## CobaltStrike\n\nLoad CACTUSTORCH.cna\nGo to Attack -> Host CACTUSTORCH Payload\n\n\n-----\n\nFill in fields\nFile hosted and ready to go!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-11-16 - CACTUSTORCH- Payload Generation for Adversary Simulations.pdf"
    ],
    "report_names": [
        "2017-11-16 - CACTUSTORCH- Payload Generation for Adversary Simulations.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536167,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653788334,
    "ts_modification_date": 1653788334,
    "files": {
        "pdf": "https://archive.orkl.eu/8b38cd05f7276c61f6eedd8385863221e705b049.pdf",
        "text": "https://archive.orkl.eu/8b38cd05f7276c61f6eedd8385863221e705b049.txt",
        "img": "https://archive.orkl.eu/8b38cd05f7276c61f6eedd8385863221e705b049.jpg"
    }
}