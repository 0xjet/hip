{
    "id": "35b3a579-ed2d-44f7-b1b7-31c4ea1bf3f6",
    "created_at": "2023-01-12T15:05:19.759865Z",
    "updated_at": "2025-03-27T02:05:48.555957Z",
    "deleted_at": null,
    "sha1_hash": "709acfafbd225260ee4ba8d771baa6f6aff761e4",
    "title": "2022-05-16 - Custom PowerShell RAT targets Germans seeking information about the Ukraine crisis",
    "authors": "",
    "file_creation_date": "2022-05-28T23:25:54Z",
    "file_modification_date": "2022-05-28T23:25:54Z",
    "file_size": 1229108,
    "plain_text": "# Custom PowerShell RAT targets Germans seeking information about the Ukraine crisis\n\n**blog.malwarebytes.com/threat-intelligence/2022/05/custom-powershell-rat-targets-germans-seeking-information-**\nabout-the-ukraine-crisis/\n\nThreat Intelligence Team May 16, 2022\n\n_This blog post was authored by Hossein Jazi and Jérôme Segura_\n\nPopulations around the world—and in Europe in particular—are following the crisis in\nUkraine very closely, and with events unfolding on a daily basis, people are hungry for\ninformation.\n\nAlthough all countries have reasons to be concerned, the situation is Germany is more\ncomplicated than most. It is one of the few European countries to have received criticism for\nits attitude to the Ukraine-Russia conflict, as it struggles to end its reliance on Russian\nenergy, and Moscow recently imposed sanctions on Gazprom Germania, further increasing\neconomic tensions.\n\nThis week our analysts discovered a new campaign that plays on these concerns by trying to\nlure Germans with a promise of updates on the current threat situation in Ukraine. The\ndownloaded document is in fact decoy for a Remote Access Trojan (RAT) capable of stealing\ndata and executing other malicious commands on a victim’s computer.\n\n## Decoy site lures victims with Ukraine situation\n\n\n-----\n\nThreat actors registered an expired German domain name at collaboration-bw[.]de that was\nformally used as a collaboration platform to develop new ideas for the Baden-Württemberg\nstate.\n\nThreat actors registered an expired domain associated with Baden-Württemberg\nThe threat actors used the domain to host a website that looked like the official BadenWürttemberg website, baden-wuerttemberg.de.\n\nA comparison of the real baden-wuerttemberg.de (top) and the malicious fake (bottom)\nWith this copycat, the attackers created the perfect placeholder for the lure they wanted their\nvictims to download: A file tantalising called `2022-Q2-Bedrohungslage-Ukraine (threat`\nsituation in Ukraine for Q2), offered via a prominent blue download button.\n\n\n-----\n\nThe website promises important information and tips about the Ukraine crisis\nAn English translation of the page reads:\n```\nImportant, current threat situation regarding the Ukraine crisis\nOn this website you will always find the most important information and tips for\ndealing with the current threat posed by the Ukraine crisis. Please download the\ndocument now and read through the current information. The document is constantly\nupdated and is up to date. Our suggested tips can be practically implemented in\neveryday work and you should already implement them today. Thanks for your support.\n\n## File analysis\n\n```\n\n-----\n\nThe archive file called `2022-Q2-Bedrohungslage-Ukraine contains a file named` `2022-`\n```\nQ2-Bedrohungslage-Ukraine.chm . The CHM format is Microsoft’s HTML help file format,\n\n```\nwhich consists of a number of compiled HTML files.\n\nThe\n\nCHM file displays a fake error message\nVictims will get a fake error message when they open up that file, while PowerShell quietly\nruns a Base64 command.\n\nPowerShell executes a Base64-encoded command\nAfter de-obfuscating the command we can see it is designed to execute a script downloaded\nfrom the fake Baden-Württemberg website, using Invoke-Expression (IEX).\n\nThe\n\nPowerShell code fetches and executes a malicious script\n\n\n-----\n\nThe malicious script downloaded from the fake Baden-Württemberg website\nThe downloaded script creates a folder called `SecuriyHealthService in the current user`\ndirectory and drops two files into it: `MonitorHealth.cmd and a script called` `Status.txt .`\nThe `.cmd file is very simple and just executes` `Status.txt through PowerShell.`\n\nFinally, the downloaded script makes `MonitorHealth.cmd persistent by creating a`\nscheduled task that will execute it each day at a specific time.\n\n## PowerShell RAT (Status.txt)\n```\nStatus.txt is a RAT written in PowerShell (This Rat is a modified version of an HTTP\n\n```\n[Reverse Shell that is available on Github). It starts its activities by collecting some](https://github.com/3v4Si0N/HTTP-revshell)\ninformation about the victim’s computer, such as the current username and working directory,\nand the computer’s hostname. It also builds a unique id for the victim, the `clientid .`\n\nThis data is exfiltrated as a JSON data structure sent to the server via a POST request:\n```\n$json = '{\n \"type\": \"newclient\",\n \"result\": \"\",\n \"pwd\": \"' + $pwd_b64 + '\",\n \"cuser\": \"' + $cuser + '\",\n \"hostname\": \"' + $hname + '\",\n \"clientid\": \"' + $clientid + '\"\n}';\n$headers = @{'X-Request-ID' = $strhash;}\n\n```\n\n-----\n\nHowever, before executing this requests the script will first bypass the Windows Antimalware\n[Scan Interface (AMSI) using an AES-encrypted function called](https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal) `bypass . It is decrypted`\nusing a generated key and IV before execution.\n\nThe bypass function that contains the encrypted script to bypass AMSI.\n\n\n-----\n\nThe content of the AMSI bypass script after decryption\nThis RAT has the following capabilities:\n\n**Download (type: D0WNl04D): Download files from server**\n**Upload (type: UPL04D): Upload file to the server**\n**LoadPS1 (type: L04DPS1): Load and execute a PowerShell script**\n**Command (type: C0MM4ND): Execute a specific command**\n\n## German command and control server\n\nThe attack was thoughtfully carried out—even ensuring that the stolen data was sent to a\nGerman domain name, kleinm[.]de, to avoid suspicion.\n\n\n-----\n\nIt is not easy to attribute this activity to a specific actor, and there are no solid indicators to\nsupport attribution. Based on motivation alone, we hypothesise that a Russian threat actor\ncould be targeting German users, but without clear connections in infrastructure or\nsimilarities to known TTPs, such attribution is weak.\n\nThe Malwarebytes Threat Intelligence team continues to monitor attacks taking advantage of\nthe war in Ukraine while ensuring our customers are protected.\n\n\n-----\n\n## Indicators of Compromise (IOCs)\n\n**Phishing site**\n\ncollaboration-bw[.]de/bedrohung-ukr.html\n\n**Lure**\n\n2022-Q2-Bedrohungslage-Ukraine.zip\n2430f68285120686233569e51e2147914dc87f82c7dbdf07fe0c34dbb1aca77c\n2022-Q2-Bedrohungslage-Ukraine.chm\n80bad7e0d5a5d2782674bb8334dcca03534aa831c37aebb5962da1cd1bec4130\n\n**Status.txt**\na5d8beaa832832576ca97809be4eee9441eb6907752a7e1f9a390b29bbb9fe1f\n\n**MonitorHealth.cmd**\nfc71522a4125ca4bdc5e5deca4a6498e7f2da4408614c2e1284c3ae8c083a5fd\n\n**C2**\n\nkleinm[.]de\n\n## MITRE ATT&CK\n\n**Tactic** **ID** **Name** **Description**\n\n\nExecution [T1059](https://attack.mitre.org/techniques/T1059) Command and Scripting\nInterpreter\n\n\nStarts cmd.exe to run hh.exe\n\nExecutes PowerShell script to\ndownload and execute a script\n\n\nPersistence [T1053](https://attack.mitre.org/techniques/T1053) Scheduled Task/Job Executes task scheduler to add\nMonitorHealth.cmd as a daily task\n\n\nDefense\nevasion\n\n\n[T1222](https://attack.mitre.org/techniques/T1222) File and Directory\nPermissions Modification\n\n\nUses attrib.exe to hide\nSecuriyHealthService folder\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-16 - Custom PowerShell RAT targets Germans seeking information about the Ukraine crisis.pdf"
    ],
    "report_names": [
        "2022-05-16 - Custom PowerShell RAT targets Germans seeking information about the Ukraine crisis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535919,
    "ts_updated_at": 1743041148,
    "ts_creation_date": 1653780354,
    "ts_modification_date": 1653780354,
    "files": {
        "pdf": "https://archive.orkl.eu/709acfafbd225260ee4ba8d771baa6f6aff761e4.pdf",
        "text": "https://archive.orkl.eu/709acfafbd225260ee4ba8d771baa6f6aff761e4.txt",
        "img": "https://archive.orkl.eu/709acfafbd225260ee4ba8d771baa6f6aff761e4.jpg"
    }
}