{
    "id": "53d719d5-59a8-4c4a-a112-710c4136dd11",
    "created_at": "2023-01-12T15:09:50.21318Z",
    "updated_at": "2025-03-27T02:06:06.11876Z",
    "deleted_at": null,
    "sha1_hash": "bd9eea0780adb707717554f9fcd864ecf7055c2e",
    "title": "2021-05-06 - MTR in Real Time- Pirates pave way for Ryuk ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:50:29Z",
    "file_modification_date": "2022-05-28T23:50:29Z",
    "file_size": 449948,
    "plain_text": "# MTR in Real Time: Pirates pave way for Ryuk ransomware\n\n**[news.sophos.com/en-us/2021/05/06/mtr-in-real-time-pirates-pave-way-for-ryuk-ransomware/](https://news.sophos.com/en-us/2021/05/06/mtr-in-real-time-pirates-pave-way-for-ryuk-ransomware/)**\n\nTilly Travers May 6, 2021\n\n[Sophos’ Rapid Response team was recently brought in to contain and neutralize an attack](https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx)\ninvolving Ryuk ransomware. The target was a life sciences research institute that has close\npartnerships with local universities and works with students on various programs.\n\nThe Ryuk attack cost the institute a week’s worth of vital research data, because although it\nhad backups, they were not fully up to date. There was further operational impact when all\ncomputer and server files needed to be rebuilt from the ground up before the data could be\nrestored. Perhaps the hardest lesson of all, however, was discovering that the attack and its\nimpact could have been avoided with a less trusting and more robust approach to network\naccess.\n\nAfter a cyber-incident has been contained, the Rapid Response team uses the logs and\nhistorical data available to retrace the steps taken by the attackers and the tools and\ntechniques used at every stage. In this instance, the responders found that the adversaries\nhad gained domain access and used that to deploy the Ryuk ransomware through a series of\nscheduled tasks. It was only when they went all the way back to the point of initial access\nthat they realized it led them out of the corporate network to a single human mistake and\nsecurity misjudgement.\n\n\n-----\n\nHuman error can happen in any organization; the reason the mistake was able to progress to\na fully-fledged attack was because the institute didn’t have the protection in place to contain\nthe error. At the heart of this was its approach to letting people outside the organization\naccess the network. Students working with the institute use their personal computers to\naccess the institute’s network. They can connect into the network via remote Citrix sessions\nwithout the need for two factor-authentication.\n\nThe institute was exposed the moment one of these external university students apparently\ndecided they wanted a personal copy of a data visualization software tool they were already\nusing for work. A single user license was likely to cost them hundreds of dollars a year, so\nthey posted a question on an online research forum asking if anyone knew of a free\nalternative (the Rapid Response team know this because the student handed over their\nlaptop for analysis once the full extent of the incident became clear).\n\nWhen the student couldn’t find a suitable free version, they searched for a “Crack” version\ninstead. They found what appeared to be one and tried to install it. However, the file was in\nfact pure malware and the installation attempt immediately triggered a security alert from\nWindows Defender. The user disabled Windows Defender – and at the same time appears\nhave also disabled their firewall – and tried again. This time it worked.\n\nHowever, instead of a cracked copy of the visualization tool they were after, the student got a\nmalicious info-stealer that, once installed, began logging keystrokes, stealing browser,\ncookies and clipboard data and more. Somewhere along the way it apparently also found the\nstudent’s access credentials for the institute’s network.\n\nThirteen days later a remote desktop protocol (RDP) connection was registered on the\ninstitute’s network using the student’s credentials. It came from a computer named “Totoro,”\npossibly after the anime character.\n\nA feature of RDP is that a connection also triggers the automatic installation of a printer\ndriver, enabling users to print documents remotely. This allowed the Rapid Response\ninvestigation team to see that the registered RDP connection involved a Russian language\nprinter driver and was likely to be a rogue connection. Ten days after this connection was\nmade the Ryuk ransomware was launched.\n\n“It is unlikely that the operators behind the ‘pirated software’ malware are the same as the\nones who launched the Ryuk attack,” said Peter Mackenzie, manager of Rapid Response at\nSophos. “The underground market for previously compromised networks offering attackers\neasy initial access is thriving, so we believe that the malware operators sold their access on\nto another attacker. The RDP connection could have been the access brokers testing their\naccess.\n\n\n-----\n\nIncident investigations are crucial because they allow us to see how an attack unfolded and\nhelp targets to understand and address security gaps for the future. In this case, the\nimplementation of robust network authentication and access controls, combined with end\nuser education might have prevented this attack from happening. It serves as a powerful\nreminder of how important it is to get the security basics right.”\n\n## Recommendations\n\nSophos recommends taking the following actions to help defend against network access\nabuse:\n\n1. Enable multi-factor authentication (MFA), where possible, for anyone required to\n\naccess internal networks, including external collaborators and partners\n2. Have a strong, password policy in place for everyone required to access internal\n\nnetworks\n3. Decommission and/or upgrade any unsupported operating systems and applications\n4. Review and install security software on all computers\n5. Regularly review and install the latest software patches on all computers – and check\n\nthey’ve been installed correctly\n6. Review the use of proxy servers and regularly check security policies to prevent access\n\nto malicious websites and/or the downloading of malicious files by anyone on the\nnetwork\n7. Lock down remote desktop RDP access with static Local Area Network (LAN) rules, via\n\na group policy or using access control lists\n8. Implement segregation for any network access, including for LANs (or consider using\n\nvirtual LANs) and where necessary use hardware/software/access control lists\n9. Continuously review domain accounts and computers, removing any that are unused or\n\nnot needed\n10. Review firewall configurations and only whitelist traffic intended for known destinations\n\n11. Limit the use of admin accounts by different users as this encourages credential\n\nsharing that can introduce many other security vulnerabilities\n\nIf you are facing an active threat and need immediate assistance, please contact Sophos\nRapid Response for support.\n\n_Special thanks to Bill Kearney, Kyle Link, Peter Mackenzie, and Matthew Sharf, for_\n_responding to and investigating to this incident._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-06 - MTR in Real Time- Pirates pave way for Ryuk ransomware.pdf"
    ],
    "report_names": [
        "2021-05-06 - MTR in Real Time- Pirates pave way for Ryuk ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536190,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653781829,
    "ts_modification_date": 1653781829,
    "files": {
        "pdf": "https://archive.orkl.eu/bd9eea0780adb707717554f9fcd864ecf7055c2e.pdf",
        "text": "https://archive.orkl.eu/bd9eea0780adb707717554f9fcd864ecf7055c2e.txt",
        "img": "https://archive.orkl.eu/bd9eea0780adb707717554f9fcd864ecf7055c2e.jpg"
    }
}