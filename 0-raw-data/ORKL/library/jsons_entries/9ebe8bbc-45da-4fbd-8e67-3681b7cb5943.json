{
    "id": "9ebe8bbc-45da-4fbd-8e67-3681b7cb5943",
    "created_at": "2022-10-25T16:48:20.630581Z",
    "updated_at": "2025-03-27T02:06:09.044676Z",
    "deleted_at": null,
    "sha1_hash": "9de5b1f2a84704eda69d8c5e1ce5ca7ebb554f32",
    "title": "Good practice guide on firewall deployment for SCADA and process control networks",
    "authors": "",
    "file_creation_date": "2005-02-23T08:16:23Z",
    "file_modification_date": "2011-01-28T18:28:09Z",
    "file_size": 352926,
    "plain_text": "# FIREWALL DEPLOYMENT FOR SCADA AND PROCESS CONTROL NETWORKS GOOD PRACTICE GUIDE\n\n**15 FEBRUARY 2005**\n\nThis paper was previously published by the National Infrastructure Security Co-ordination\nCentre (NISCC) – a predecessor organisation to the Centre for the Protection of National\nInfrastructure (CPNI).\n\nHyperlinks in this document may refer to resources that no longer exist. Please see CPNI’s\nwebsite (www.cpni.gov.uk) for up-to-date information.\n\n**Disclaimer**\n\nReference to any specific commercial product, process or service by trade name, trademark,\nmanufacturer, or otherwise, does not constitute or imply its endorsement, recommendation, or\nfavouring by CPNI. The views and opinions of authors expressed within this document shall\nnot be used for advertising or product endorsement purposes.\n\nTo the fullest extent permitted by law, CPNI accepts no liability for any loss or damage\n(whether direct, indirect or consequential and including, but not limited to, loss of profits or\nanticipated profits, loss of data, business or goodwill) incurred by any person and howsoever\ncaused arising from or connected with any error or omission in this document or from any\nperson acting, omitting to act or refraining from acting upon, or otherwise using, the\ninformation contained in this document or its references. You should make your own\njudgement as regards use of this document and seek independent professional advice on your\nparticular circumstances.\n\n\n-----\n\n## Revision History\n\n**Revision** **Date** **Author(s)** **Description**\n\n0.1 May 9 2004 Eric Byres, BCIT Internet Engineering Lab Draft\nKen Savage, BCIT Internet Engineering Lab\n\n1.0 May 22, 2004 Eric Byres, BCIT Internet Engineering Lab Preliminary Release\nJohn Karsch, BCIT Internet Engineering Lab\nJoel Carter, BCIT Internet Engineering Lab\n\n1.1 July 8, 2004 Eric Byres, BCIT Internet Engineering Lab Grammatical Changes\nJohn Karsch, BCIT Internet Engineering Lab\nJoel Carter, BCIT Internet Engineering Lab\n\n1.2 September 27, Eric Byres, BCIT Internet Engineering Lab Grammatical Changes\n2004 John Karsch, BCIT Internet Engineering Lab\nJoel Carter, BCIT Internet Engineering Lab\n\n1.3 January 15, 2005 Eric Byres, BCIT Internet Engineering Lab Added Scoring System and\nJohn Karsch, BCIT Internet Engineering Lab 4.2 Architecture\n\n1.4 February 15, 2005 Eric Byres, BCIT Internet Engineering Lab Public Release\nJohn Karsch, BCIT Internet Engineering Lab\nJoel Carter, BCIT Internet Engineering Lab\n\n\n-----\n\n## Acknowledgements\n\nThe Group for Advanced Information Technology (GAIT) at the British Columbia Institute of\nTechnology (BCIT) would like to thank all the vendors and end users that generously supported\nour efforts through numerous interviews and by providing us with documents that could only be\ndescribed as extremely sensitive. Unfortunately we can not name you for obvious security\nreasons, but we appreciate your time, trust and encouragement.\n\nFour people stood out in their contributions and advice for this document that we can\nacknowledge. These people are Darrin Miller of Cisco System’s Critical Infrastructure\nAssurance Group (CIAG), Andy Cobbett and Ian Henderson of BP International and Justin Lowe\nof PA Consulting. Thank you for all your help.\n\nFinally we would like to thank Karl Williams of the National Infrastructure Security\nCoordination Centre (NISCC) for his vision and support. Without him, this project never would\nhave been possible.\n\n\n### NISCC\nNational Infrastructure\nSecurity Coordination\nCentre\n\nPO Box 832\nLondon SW1P 1BG\n\nTel:0870 487 0748\n\n\n-----\n\nThis page is deliberately left blank.\n\n\n-----\n\n## Table of Contents\n\n**EXECUTIVE SUMMARY .........................................................................................................................................1**\n\n**1** **INTRODUCTION.........................................................................................................................................3**\n\n**2** **WHAT IS A FIREWALL?...........................................................................................................................5**\n\n2.1 TYPES OF FIREWALLS.......................................................................................................................................5\n2.2 CLASSES OF FIREWALLS...................................................................................................................................6\n_2.2.1_ _Packet Filter Firewalls...............................................................................................................................6_\n_2.2.2_ _Stateful Firewalls........................................................................................................................................7_\n_2.2.3_ _Application Proxy Firewalls.......................................................................................................................7_\n_2.2.4_ _Deep Packet Inspection Firewalls..............................................................................................................8_\n2.3 OTHER FIREWALL SERVICES ............................................................................................................................8\n\n**3** **OVERALL SECURITY GOALS OF PCN/SCADA FIREWALLS .........................................................9**\n\n**4** **COMMON SCADA/PCN SEGREGATION ARCHITECTURES .........................................................11**\n\n4.1 DUAL-HOMED COMPUTERS ...........................................................................................................................11\n4.2 DUAL-HOMED SERVER WITH PERSONAL FIREWALL SOFTWARE ....................................................................12\n4.3 PACKET FILTERING ROUTER/LAYER-3 SWITCH BETWEEN PCN AND EN .......................................................13\n4.4 TWO-PORT FIREWALL BETWEEN PCN AND EN..............................................................................................13\n4.5 ROUTER/FIREWALL COMBINATION BETWEEN PCN AND EN..........................................................................15\n4.6 FIREWALL WITH DEMILITARIZED ZONES BETWEEN PCN AND EN .................................................................15\n4.7 PAIRED FIREWALLS BETWEEN PCN AND EN .................................................................................................16\n4.8 FIREWALL AND VLAN-BASED PROCESS NETWORK COMBINATIONS .............................................................17\n4.9 SUMMARY OF FIREWALL ARCHITECTURES ....................................................................................................18\n\n**5** **FIREWALL IMPLEMENTATION AND CONFIGURATION.............................................................21**\n\n5.1 GENERAL FIREWALL POLICIES.......................................................................................................................21\n5.2 RULES FOR SPECIFIC SERVICES ......................................................................................................................23\n_5.2.1_ _Domain Name Service (DNS)...................................................................................................................24_\n_5.2.2_ _Hyper Text Transfer Protocol (HTTP) .....................................................................................................24_\n_5.2.3_ _File Transfer Protocol (FTP) and Trivial File Transfer Protocol (TFTP)...............................................24_\n_5.2.4_ _Telnet........................................................................................................................................................24_\n_5.2.5_ _Simple Mail Transfer Protocol (SMTP)....................................................................................................25_\n_5.2.6_ _Simple Network Management Protocol (SNMP)......................................................................................25_\n_5.2.7_ _Distributed Component Object Model (DCOM).......................................................................................25_\n_5.2.8_ _SCADA and Industrial Protocols..............................................................................................................25_\n5.3 NETWORK ADDRESS TRANSLATION (NAT) ...................................................................................................25\n5.4 SPECIFIC PCN FIREWALLS ISSUES .................................................................................................................27\n_5.4.1_ _Data Historians ........................................................................................................................................27_\n_5.4.2_ _Remote Support Access.............................................................................................................................27_\n_5.4.3_ _Multicast Traffic.......................................................................................................................................28_\n\n**6** **MANAGEMENT OF PCN/SCADA FIREWALLS .................................................................................29**\n\n**7** **SPECIAL OR FUTURE TECHNOLOGIES............................................................................................31**\n\n7.1 SCADA PROTOCOL AWARE FIREWALLS .......................................................................................................31\n7.2 DISTRIBUTED MICRO-FIREWALLS..................................................................................................................31\n7.3 QUALITY OF SERVICE (QOS)..........................................................................................................................31\n7.4 ONE WAY COMMUNICATION PATHS ..............................................................................................................32\n\n**ACRONYMS..............................................................................................................................................................33**\n\n**REFERENCES ..........................................................................................................................................................35**\n\n\n-----\n\n## Figures\n\nFIGURE 1: A SIMPLIFIED EXAMPLE OF AN INTERNET-FACING FIREWALL PROTECTING DEVICES ON A NETWORK .........5\nFIGURE 2: NETWORK SEPARATION USING DUAL-HOMED COMPUTERS........................................................................11\nFIGURE 3: NETWORK SEPARATION USING DUAL-HOMED SERVER WITH PERSONAL FIREWALL INSTALLED ................12\nFIGURE 4: NETWORK SEPARATION ROUTERS OR LAYER-3 SWITCHES WITH ACL FILTERS ..........................................13\nFIGURE 5: NETWORK SEPARATION WITH SINGLE FIREWALL ........................................................................................14\nFIGURE 6: NETWORK SEPARATION WITH FIREWALL/ROUTER COMBINATION (INTERNET EXAMPLE)...........................15\nFIGURE 7: FIREWALL WITH DEMILITARIZED ZONE FOR SHARED ENTERPRISE/PCN DEVICES ......................................16\nFIGURE 8: PAIRED FIREWALLS WITH DEMILITARIZED ZONE FOR SHARED ENTERPRISE/PCN ASSETS..........................17\nFIGURE 9: FIREWALL WITH DEMILITARIZED ZONE AND SCADA/PCN VLANS...........................................................18\nFIGURE 10: COMPARISON CHART FOR PCN/SCADA SEGREGATION ARCHITECTURES ................................................19\n\n\n-----\n\n## Executive Summary\n\nIn recent years, Supervisory Controls and Data Acquisition (SCADA), process control and\nindustrial manufacturing systems have increasingly relied on commercial information\ntechnologies such as Ethernet[®], TCP/IP and Windows[®] for both critical and non-critical\ncommunications. While beneficial in other areas, use of these common protocols and operating\nsystems has resulted in significantly less isolation from the outside world for vital SCADA and\nProcess Control Networks (PCNs). These systems are now under risk of attack from a variety of\nthreats, ranging from teenage script-kiddies to skilled and determined cyber-criminals.\n\nUnfortunately, there are few proven methods available to the asset owner or engineer to protect\nthese vital systems. One commonly suggested security solution is to isolate the SCADA and\nPCN systems from the Internet and corporate enterprise network (EN) through the use of\nfirewalls, but there is little information available on exactly how these firewalls should be\ndeployed in terms of architectures, configuration and management. Firewalls can be complex\ndevices to design and deploy correctly, so guidance on how best to deploy them in the industrial\nsetting would be very useful.\n\nTo address this need, the UK’s National Infrastructure Security Coordination Centre (NISCC)\ncommissioned the Group for Advanced Information Technology (GAIT) at the British Columbia\nInstitute of Technology (BCIT) to investigate and compile the current practices in SCADA/PCN\nfirewall deployment. The intent was to examine the “state of the art” in firewall architectures,\ndeployment and management used to protect industrial control environments.\n\nIn March 2004, the research team sent out requests for information regarding the use of firewalls\nin industrial settings to approximately 60 organizations and industry news lists. A total of 10\nvendors, including firewall manufacturers, IT security firms and control systems manufacturers,\nresponded in some form. Approximately 15 industrial users from the petroleum, chemical, food,\nand electrical sectors also responded. The vendor and end-user organizations were a mix of\nNorth American and European-based firms. This information provided was in the form of\npersonal interviews, white papers, policy manuals, network audit reports and security product\nliterature. In addition, draft documents from standards organizations involved in industrial\ncontrol security were obtained. These included documents from the American Petroleum\nInstitute (API), the Industrial Automation Open Networking Association (IAONA), the\nInternational Electrotechnical Commission (IEC), the Institute of Electrical and Electronics\nEngineers (IEEE) and the Instrumentation, Systems and Automation Society (ISA).\n\nAll collected information was summarized by the research team in terms of firewall architecture,\ndesign, deployment and management to determine current security practises. These practices\nwere then analysed and scored for their likely effectiveness in the industrial control environment.\nThe results of this analysis indicate that there are a significant number of different solutions used\nby the industry and the security effectiveness of these can vary widely. The commonly dualhomed workstations, bridges and routers are unlikely to provide suitable isolation, while two\nzone architectures are marginally secure, but should be only be deployed with extreme care. In\ngeneral, architectures that allow the establishment of a Demilitarised Zones (DMZ) between the\nenterprise network and SCADA/PCN network will provide the most effective security solution.\n\n\n-----\n\nThis page is deliberately left blank.\n\n\n-----\n\n## 1 Introduction\n\nIn recent years, Supervisory Controls and Data Acquisition (SCADA), process control and\nindustrial manufacturing systems have increasingly relied on commercial information\ntechnologies such as Ethernet, TCP/IP and Windows for both critical and non-critical\ncommunications. The use of these common protocols and operating systems has made the\ninterfacing of industrial control equipment much easier, but there is now significantly less\nisolation from the outside world. Network security problems from the enterprise network (EN)\nand the world at large can be passed onto the SCADA and process control network (PCN),\nputting industrial production and human safety at risk.\n\nAt the same time, the core of our information infrastructure – the Internet – has come under\nincreasing attack from a wide variety of sources, ranging from teenagers on a cyber joyride to\nprofessional hackers. People in almost every country on the globe can access a network that, in\nturn, is ultimately connected to networks that run critical functions throughout the world. Cyber\nattacks on information networks occur regularly and can have serious consequences if they\nimpact connected PCN or SCADA systems. For example, in 2000 a hacker attacked a sewage\nplant in Queensland, Australia, causing millions of litres of sewage to pollute a river and park in\nthat region[1]. Three years later, the Slammer Worm caused documented impacts on at least two\npower generation/distribution systems[2], a safety monitoring system in a nuclear reactor[3] and\nemergency services phone system. Future attacks could have serious consequences such as\nextended disruption of critical services and even loss of life.\n\nWhile the importance of protecting these critical systems is widely acknowledged, there are few\nproven protection methods available to the asset owner or engineer. Certainly there are general\ninformation security practices and standards that can offer significant guidance towards securing\nthe PCN, but there are also important differences that need to be considered. For example, the\ngoals of information technology (IT) departments can be fundamentally different from those of a\nprocess control department. The IT world typically sees performance and data integrity as\nparamount, while the industrial world sees human and plant safety as its primary responsibility.\nOther documented distinctions include differences in reliability requirements, event impacts,\nperformance expectations, operating systems, communications protocols and system\narchitectures[4] [5]. This can mean significant differences in acceptable security practice.\n\nOne commonly suggested security solution is to isolate the SCADA and PCN system from the\ncorporate and Internet systems through the use of firewalls. Unfortunately, while firewalls are\nwidely used in the traditional IT sector, their effectiveness in SCADA/PCN environments is still\nin question. IT firewalls are generally unaware of SCADA/PCN protocols, may introduce\nunacceptable latency into time-critical systems and face operational constraints not typical in the\nIT world. To make matters worst, there is little information available on exactly how these\nfirewalls should be deployed in terms of architectures, configuration and management. Typical\nguidance for the PCN or SCADA engineer rarely extends beyond:\n\n_“Never mix your office LAN with your industrial-control LAN. They should be separated_\n_by a firewall, or at minimum, a bridge or router.”[6]_\n\n\n-----\n\nThis type of advice misses the fact that firewalls can be complex devices that need careful\ndesign, configuration and management if they are to be effective. For example, how should\nfirewall rule sets be defined between the PCN and the corporate network? Should they be strictly\nbased on address filtering or should protocol filtering be used as well? And if protocol filtering is\nused, which protocols should be blocked and which should be allowed? Certainly each SCADA\nor PCN system has unique characteristics that rule out a single definitive answer to these\nquestions, but some guidance on how best to deploy firewalls in the industrial setting would be\nvery useful.\n\nTo address this need, the UK’s National Infrastructure Security Co-ordination Centre (NISCC)\ncommissioned the Group for Advanced Information Technology (GAIT) at BCIT to investigate\nand compile the current practices in SCADA/PCN firewall deployment. The intent was to\nexamine the “state of the art” in firewall architectures, deployment and management used to\nprotect industrial control environments. The goals of the project were to:\n\n1. Collect available SCADA/PCN firewall deployment recommendations from equipment\nvendors, users and industry standards bodies.\n\n2. Summarise the collected firewall deployment recommendations and best practices.\n\n3. Analyse and rate the compiled recommendations and best practices in terms of security\neffectiveness and possible weaknesses.\n\nIn March 2004, the research team sent out requests for information regarding the use of firewalls\nin industrial settings to approximately 60 organizations and industry news lists. A total of 10\nvendors, including firewall manufacturers, IT security firms and control systems manufacturers,\nresponded in some form. Approximately 15 industrial users from the petroleum, chemical, food,\nand electrical sectors also responded. The vendor and end-user organizations were a mix of\nNorth American and European-based firms. The information supplied was in the form of\npersonal interviews, white papers, policy manuals, network audit reports and security product\nliterature. In addition, documents from five standards organizations involved in industrial control\nsecurity (API, IAONA, IEC, IEEE and ISA) were obtained.\n\nThis information was first summarized by the research team in terms of firewall architecture,\ndeployment and management to determine current security practises. These practices were then\nanalysed for their likely effectiveness in the industrial control environment. The results of this\nsummary and analysis are contained in this report.\n\nA follow-on project will test a number of the best practices discussed in this report in a lab\nsetting. This will include creating a reference firewall architecture and rule set for SCADA/PCN\nsecurity and then testing it, along with a number of commercial firewalls, in terms of security\ncorrectness and performance. Combined, these two studies hope to provide clear guidance to the\nSCADA/PCN engineer and asset owner on the design and implementation of firewalls in critical\nindustrial environments.\n\n\n-----\n\n## 2 What is a Firewall?\n\nA firewall is a mechanism used to control and monitor traffic to and from a network for the\npurpose of protecting devices on the network. It compares the traffic passing through it to a\npredefined security criteria or policy, discarding messages that do not meet the policy’s\nrequirements. In effect, it is a filter blocking unwanted network traffic and placing limitations on\nthe amount and type of communication that occurs between a protected network and other\nnetworks (such as the Internet, or another portion of a site's network). Figure 1 shows a simple\nfirewall protecting a personal computer (PC) and programmable logic controller (PLC) from\nunwanted traffic from the Internet, while allowing requests coming into the corporate web\nserver.\n\n**Incoming HTTP**\n\n**Firewall** **Request to Web**\n**with Filters** **Server (Permit)**\n\n**Internet**\n\n### �\n\n**Web Server**\n\n**PLC** **Incoming**\n\n**telnet Msg to**\n**PLC (Deny)**\n**Incoming Ping**\n**to PC (Deny)**\n\n**Figure 1: A Simplified Example of an Internet-Facing Firewall Protecting Devices on a Network**\n\n**_2.1_** **_Types of Firewalls_**\n\nA firewall can come in many different designs and configurations. It can be a separate hardware\ndevice physically connected to a network (such as the Cisco PIX[®] or the Symantec Security\nGateway[®] firewalls), a hardware/software unit with OS-based firewall capabilities (such as\n'iptables' running on a Linux[®] server), or even a completely host-based software solution\ninstalled directly on the workstation to be protected (such as Norton Personal Firewall[®] or Sygate\nPersonal Firewall[®]).\n\nSeparate hardware or hardware/software units are often referred to as network firewalls and\ntypically provide the most secure solution for the separation of the PCN from corporate network.\nThey are dedicated-function units that can be hardened to resist all but the most ingenious\nassaults. In addition, network firewalls generally offer the best management options since they\nare typically designed to allow remote management.\n\nHost-based firewalls must generally accept compromises since the primary function of the host\ndevice is not security, but workstation or server tasks such as database access or web services. As\nwell, host-based firewall solutions are currently only available for Windows or Unix-based\nplatforms and can do little to regulate traffic destined for embedded control devices, such as\n\n\n-----\n\nPLCs, on the network. Host-based firewalls may have a place on the PCN/SCADA network,\nsuch as in the architecture described in section 4.2, but generally they are beyond the scope of\nthis study. Thus with a few exceptions, this paper assumes that the PCN/SCADA firewall will be\na dedicated hardware or hardware/software solution that, through a series of rules, allows or\ndenies network traffic to pass on to the control network.\n\n**_2.2_** **_Classes of Firewalls_**\n\nNetwork traffic is sent in discrete groups of bits, called a packet. Each packet typically contains a\nnumber of separate pieces of information, including (but not limited to) items such as the:\n\n    - Sender's identity (Source Address);\n\n    - Recipient's identity (Destination Address);\n\n    - Service to which the packet pertains (Port Number);\n\n    - Network operation and status flags;\n\n    - Actual payload of data to be delivered to the service.\n\nA firewall, upon receiving a packet, analyses these characteristics, and determines what action to\ntake with the packet. It may choose to drop the packet, allow it through immediately, buffer it\nmomentarily to bandwidth limit a class of service or forward it to a different recipient than was\ninitially intended - whatever the network security policy deems is an appropriate action to take.\nThese decisions are based on a series of rules commonly referred to as Access Control Lists\n(ACLs). Different classes of firewalls exist, each with increasingly sophisticated analysis and\naction capabilities.\n\n2.2.1 Packet Filter Firewalls\n\nThe simplest class of firewall is known as a packet filter firewall. It has a series of static rules\nand uses them to take action upon received packets on an individual basis. The following sample\nrules can easily be handled by a packet filter firewall:\n\n    - Accept Domain Name Service (DNS) response packets on User Datagram Protocol\n(UDP) port 53;\n\n    - Block any traffic to or from Internet Protocol (IP) address 24.116.25.21;\n\n    - Prevent web surfing by blocking outgoing packets from accessing Transmission\nControl Protocol (TCP) ports 80, 443, 3128, 8000 and 8080, unless they are directed\nto the corporate intranet web server's IP address;\n\n    - Drop source routed packets;\n\n    - Accept TCP port 23 (telnet) traffic to a specific Distributed Control System’s (DCS)\nIP address, from a specified range of IP addresses for engineering consoles.\n\nUnfortunately, a packet filter firewall lacks the ability to understand the relationships between a\nseries of packets. For example, the broad rule \"Accept DNS response packets on UDP port 53\"\ncontains a serious flaw. What if no DNS query was ever issued, but a spoofed DNS \"response\"\npacket came in instead? This simplistic firewall would accept the packet and deliver it to the\n\n\n-----\n\n\"requesting\" host, possibly causing it to become confused. A moderately intelligent hacker could\nuse these firewall weaknesses to compromise internal systems.\n\nThe advantages of packet filtering firewalls include low cost and low impact on network\nperformance, often because only the IP addresses and port numbers in the packet are examined.\nThis method is also sometimes called Static Filtering[7]. It is often directly deployed in layer-3\nswitches or routers, rather than dedicated “firewalls”.\n\n2.2.2 Stateful Firewalls\n\nA more sophisticated firewall, known as a stateful firewall, intelligently tracks the\ninterrelationships between packets allowed to flow through it. By keeping a history of accepted\npackets and the state of current connections, it can accept only “anticipated” traffic. Stateful\nfirewall rule sets can be made conditional due to the firewall's intelligence. For example:\n\n    - Accept DNS response packets on UDP port 53 only if they match an outgoing DNS\nquery with the same DNS request identification.\n\n    - Allow File Transfer Protocol (FTP) data channel traffic through only after successful\ncontrol channel negotiation.\n\n    - Block all incoming web traffic originating from TCP port 80 unless it is specifically\nin response to a previous outgoing Hyper-Text Transfer Protocol (HTTP) request.\n\nThese types of firewalls offer a high level of security, good performance, and transparency to\nend users, but are more expensive. Due to their complex nature, they can be less secure than\nsimpler types of firewalls if not administered by competent personnel. This method is also\nsometimes called Dynamic Packet Filtering[8].\n\n2.2.3 Application Proxy Firewalls\n\nApplication Proxy firewalls open packets at the application layer, process them based on specific\napplication rules, then reassemble them and forward them to the desired target device. Typically\nthey are designed to concentrate on a variety of application protocols (such as Telnet, FTP,\nHTTP, etc.) through a single machine, but then forward the traffic to individual host computers\nfor each service. Instead of connecting directly to an external server, the client connects to the\nproxy firewall which in turn initiates a connection to the requested external server. Depending on\nthe type of proxy firewall used, it is possible to configure internal clients to perform this\nredirection automatically, without the user’s knowledge. Others might require that the user\nconnect directly to the proxy server and then initiate the connection through a specified format.[9]\n\nProxy firewalls offer some significant security features for controlling protocols that the firewall\ncan recognize. For example, it is possible to apply access control lists against the application\nprotocols, requiring users or systems to provide additional levels of authentication before access\nis granted. In addition, rules sets can be created which understand specific protocols and can be\nconfigured to block only subsections of the protocol. For example, a firewall rule for HTTP\ncould be created to block all inbound HTTP traffic containing scripts. By contrast, a filtering\nrouter could either block all HTTP traffic or none, but not a subset.\n\n\n-----\n\nThese types of firewalls can offer a high level of security, but can also have a significant impact\non network performance. In addition, most application proxy firewalls products only support\ncommon Internet protocols such as HTTP, FTP or SMTP (Simple Mail Transfer Protocol). As a\nresult, messages containing industrial application layer protocols such as Common Industrial\nProtocol[®] (CIP) or MODBUS/TCP[®] will require the firewall to process the traffic in stateful or\npacket-filter mode.[10]\n\nIn the past few years, most of firewalls on the market have utilized a combination of Stateful and\nApplication-Proxy techniques and are often referred to as hybrid firewalls.\n\n2.2.4 Deep Packet Inspection Firewalls\n\nThe firewall market is currently moving to a fourth technique that is referred to as \"deep packet\ninspection\" (DPI) or \"application firewalling\". This typically offers filtering deeper into the\napplication layer than the traditional application proxy and yet does not perform a full proxy on\nthe TCP connection. For example, DPI firewalls will be able to inspect Simple Object Access\nProtocol (SOAP) objects in Extended Markup Language (XML) on web connections and enforce\npolicy on what objects are allowed/disallowed into the network. This market is still in\ndevelopment.\n\n**_2.3_** **_Other Firewall Services_**\n\nIn addition to the core service of traffic filtering, most modern firewalls offer other networkbased security services. These may include:\n\n1. Acting as an intrusion detection system (IDS) by either logging packets that are denied\naccess, recognizing network packets specifically designed to cause problems, or reporting\nunusual traffic patterns.\n\n2. Deploying “frontline” anti-virus software on a firewall. If the characteristics of infected\ntraffic can be formulated, such traffic can be blocked before entering the network.\n\n3. Authentication services requiring users wishing to connect to devices on the other side of\nthe firewall to authenticate to the firewall using either passwords or strong two-factor\nauthentication methods such as public key encryption.\n\n4. Virtual Private Network (VPN) gateway services where an encrypted tunnel is set up\nbetween firewall and remote host device.\n\n5. Network Address Translation (NAT) where a set of IP addresses used on one side of the\nfirewall are mapped to a different set on the other side.\n\nAdditional services offered will depend on the particular make and model of the firewall\npurchased. Obviously these additional functions can mean additional costs, increased complexity\nand reduced performance. However by utilizing them, one can often significantly improve the\noverall security of the PCN/SCADA network. An analysis of these types of additional security\nservices is beyond the scope of this document, but the reader is advised to consider them when\nmaking any design or purchasing decisions.\n\n\n-----\n\n## 3 Overall Security Goals of PCN/SCADA Firewalls\n\nIdeally, a process control or SCADA network would be a closed system, accessible only by\ntrusted internal components such as the Human Machine Interface (HMI) stations and data\nhistorians. Realistically, the need for external access from both corporate users and selected 3[rd]\nparties exists. For example, production and maintenance management information needs to be\nrelayed to computers and users outside of the plant floor for management purposes, while\nvendors may need to access controllers for support purposes. Implicitly this means that some\nnetwork paths exist from the outside, untrusted world to internal control components.\n\nThe goal of the firewall, simply stated, is to minimize the risk of unauthorized access (or network\ntraffic) to internal components on the PCN or SCADA systems. Such a risk minimization\nstrategy will typically include the following general objectives:\n\n1. **No direct connections from the Internet to the PCN/SCADA network and vice-**\n**versa. The reasons for this are fairly obvious and include:**\n\n(a) Unsolicited inbound traffic could congest or corrupt the control network, preventing\ncritical messages from reaching the control devices.\n\n(b) Invalid control messages or denial of service (DoS) attacks could be directed to\ncontrol devices causing production upsets.\n\n(c) Outbound Internet traffic (FTP, HTTP, SMTP, etc.), even if driven from the PCN,\ncould congest critical control traffic. Furthermore, embedded objects (attachments,\nJava[®] applets, ActiveX[®] components) received from the Internet could compromise\ncontrol workstations, allowing the control network to fall victim to remote attacks.\n\n(d) Proprietary corporate production data could be intercepted.\n\n2. **Restricted access from the enterprise network to the control network. The enterprise**\nnetwork should not be able to directly query or control a PLC or other control device at\nthe plant floor/SCADA level. Both physically and logically, the enterprise and process\ncontrol networks should be isolated.\n\n3. **Unrestricted (but only authorized) access from the enterprise network to shared**\n**PCN/enterprise servers. Typically shared servers like a data historian or maintenance**\ndatabase has query access to the control network and remits relevant information back to\nthe querying business services.\n\n4. **Secure methods for authorized remote support of control systems. Many companies**\nneed to allow third party access to PLC/DCS/SCADA devices by the system vendors for\nsupport purposes. Others allow for control network access to appropriate plant staff from\na remote location for emergency maintenance. Both need to be explicitly addressed in the\nfirewall design.\n\n\n-----\n\n5. **Secure connectivity for wireless devices (if used). Without the proper security in place,**\na wireless device on a plant floor is equivalent to an open connection with the outside\nworld. As with an open Internet connection, any invalid or disruptive communication\nmessages could cause serious operational failures.\n\n6. **Well-defined rules outlining the type of traffic permitted on a network. These are**\nenforced via mechanisms such as access control lists (ACLs) and virtual local area\nnetworks (VLANs). If the traffic is not expected or wanted on the PCN, it should not be\nallowed to pass.\n\n7. **Monitoring of traffic attempting to enter and on the PCN. It is important to be aware**\nof the nature and patterns of the communications traffic attempting to enter, or on, the\nPCN or SCADA network as this will often be the only indication of either an attack on\nthe network or a failure in the firewall strategy. Typically this is achieved through an\nIntrusion Detection System (IDS) and can be either embedded in the firewall or running\non an external device[i].\n\n8. **Secure connectivity for management of the firewall. Traffic for the monitoring and**\nmanagement of the firewall should be over a secure communication system and from a\nhighly restricted set of management devices.\n\ni It is important to note that there are other monitoring solutions that can be used to baseline PCN traffic in addition\nto, or instead of, the firewall. For example, netflow functions in routers and switches can collect traffic statistics and\ncan be integrated into independent anomaly detection IDS systems.\n\n\n-----\n\n## 4 Common SCADA/PCN Segregation Architectures\n\nA survey of documentation from security/firewall/control system vendors, standards bodies and\nend-users resulted in eight overall architectures used to separate the PCN/SCADA network from\nthe enterprise network. These range from hosts with dual network interface cards to multi-tiered\ncombinations using firewalls, switches and routers. Each is described below, analysed in terms of\nadvantages and disadvantages and then rated on a scale from one (poorest) to five (best) for the\nfollowing criteria:\n\n    - **Security – the likely effectiveness of the architecture to prevent possible attacks;**\n\n    - **Manageability –ability of the architecture to be easily and effectively managed (both**\nlocally or remotely);\n\n    - **Scalability – ability of the architecture to be effectively deployed in both large and**\nsmall systems or in large numbers.\n\n**_4.1_** **_Dual-Homed Computers_**\n\nOne commonly proposed security solution is the installation of dual network interface cards\n(NICs) in workstation or control devices requiring information access to both the enterprise and\nprocess control networks. This technique is often referred to as dual-homing and a typical\nschematic of this design is shown in Figure 2 below.\n\n**Enterprise**\n**Network**\n**Dual Homed**\n**Computers**\n\n**Process Control Process Control**\n**NetworkNetwork**\n\n**PLC** **PLC** **Historian**\n\n**Figure 2: Network Separation Using Dual-Homed Computers**\n\nAs noted in the appendix B of API Standard 1164:\n\n_“Dual homing a computer is certainly a convenient way of allowing the computer to_\n_connect to two different networks. However, in situations where dual homing is used to_\n_communicate between two networks that are being segregated for security reasons it_\n_makes the computer a significant security risk.”[11]_\n\nIn an ideally configured system, this method allows for some minimal network separation.\nHowever, in most devices it is trivial to adjust network configuration parameters so that the\n\n\n-----\n\ndevice automatically forwards packets arriving on one network over to the other network,\nthereby circumventing any premise of network isolation. The fact is that dual-homed servers are\nwidely seen as easy targets by the hacking community. For example, the following discussion\ncan be found on the web by searching for the phrase “Dual-Homed Computers”:\n\n_How to get around the firewall? The juiciest targets are dual-homed machines -- that is,_\n_boxes with two NICs connected both to the DMZ and the internal net. In theory there_\n_should be none; in practice, users (well, power users and developers) frequently do this_\n_so they can get their work done more quickly.[12]_\n\nIn addition, this architecture can potentially violate the security objective of “No Direct Internet\nConnections from the Process Control Network” since the dual-NIC device is a part of the PCN,\nmay be attached to a network with Internet access and can run typically insecure software such\nas web browsers. Furthermore, if the dual-homed computer is compromised it will likely\ncompromise both networks. A number of process control incidents involving the Slammer worm\nin January of 2003 were a result of this type of architecture. Finally, while remote management\nsoftware does exist for personal computers, the effort involved in securely and effectively\nmanaging more than a small number of dual-homed machines can be significant.\n\nIn summary, while dual-homed computers are useful for redundancy on the same network or on\ntwo networks within the same PCN system, their use as an enterprise/PCN segregation measure\nis less than ideal. [Security = 1 Manageability = 2 Scalability = 1]\n\n**_4.2_** **_Dual-Homed Server with Personal Firewall Software_**\n\nOne variation on the previous architecture is the installation of host-based personal firewall\nsoftware on a single dual-homed machine (typically a data historian server), as shown in Figure 3\nbelow. The idea is the only traffic between the PCN and enterprise network is the shared history\ndata and this terminates on the server anyway. Thus if you use the personal firewall to allow only\ndata requests from the server to the business users and then protect the server with the\ninexpensive personal firewall, you will have a very inexpensive security mechanism.\n\n**Enterprise**\n**Network**\n\n**Process Control**\n**Network** **Dual Homed**\n\n**Server with**\n**Personal Firewall**\n\n**HMI** **PLC** **Historian** **Software**\n\n**Figure 3: Network Separation Using Dual-Homed Server with Personal Firewall Installed**\n\n\n-----\n\nThe first issue with this solution is that it will only provide a mechanism to allow the sharing of\nserver data. If there is any other traffic that needs to traverse the PCN to EN boundary (such as\nremote maintenance access to a controller) then this architecture will either completely block that\ntraffic or leave the PCN poorly secured. There is little opportunity for granularity in this design.\n\nThe second problem comes about if there is more than one server involved. Remote management\nof most personal firewall packages is fairly limited and as a result, maintaining consistent rule\nsets and management services across multiple servers becomes very time consuming. Finally,\npersonal firewalls can not compete with proper network firewalls in terms of system hardening,\nstateful inspection, throughput or additional features like IDS. Thus, the result of this architecture\nis a very inexpensive, but very limited segregation solution.\n\n**[Security = 2 Manageability = 1 Scalability = 1]**\n\n**_4.3_** **_Packet Filtering Router/Layer-3 Switch between PCN and EN_**\n\nA number of vendor design documents and early industry papers[13] recommended the use of a\nbridge, router or layer-3 switch with basic filters in place to control traffic. A typical schematic\nof this design is shown in Figure 4 below. Many of these devices are effectively acting as packetfilter firewalls and, as discussed earlier, offer limited protection against any sophisticated assault.\nThey are effective in enforcing basic device to device rule sets, but because they lack stateful\ninspection, will not prevent attacks that take advantage of techniques such as packet\nfragmentation to obscure the packet contents.\n\n**Layer-3 Switch/Router**\n\n**Enterprise**\n\n**(with filters to allow only** **Network**\n**Historian to talk to PLCs)**\n\n**Historian**\n\n**Process Control**\n**Network**\n\n**HMI** **PLC** **PLC**\n\n**Figure 4: Network Separation Routers or Layer-3 Switches with ACL Filters**\n\nThis type of packet filter design is only secure if the enterprise network is known to be highly\nsecure in its own right and is not generally subject to attacks. On the other hand, a number of\nhigher end routers on the market today can be upgraded to a stateful firewall relatively\ninexpensively. If this is done, then the architecture could be considered equivalent to those\ndiscussed in Sections 4.4 or 4.6. [Security = 2 Manageability = 2 Scalability = 4].\n\n**_4.4_** **_Two-Port Firewall between PCN and EN_**\n\nBy introducing a simple two-port firewall between the enterprise and process control networks, a\nsignificant security improvement can be achieved. Most firewalls on the market today offer\n\n\n-----\n\nstateful inspection for all TCP packets and application proxy services for common Internet\napplication layer protocols such as FTP, HTTP and SMTP. Aggressively configured, the chance\nof a successful external attack on the PCN is significantly reduced. Many of the companies\ninterviewed for this study used this as their standard design for PCN/SCADA security.\n\nUnfortunately two issues still remain with this design. First, on which network are the servers\nshared enterprise/PCN (such as the data historian) located? If the data historian resides on the\nenterprise network, a rule must exist within the firewall allowing the data historian to\ncommunicate with the control devices on the PCN. A packet originating from a malicious or\nincorrectly configured host on the enterprise network (appearing to be the data historian) would\nbe forwarded to individual PLCs.\n\n**Enterprise**\n**Network**\n\n**Firewall**\n\n**Historian**\n\n**Process Control**\n**Network**\n\n**HMI** **PLC** **PLC**\n\n**Figure 5: Network Separation with Single Firewall**\n\nIf the data historian resides on the process control network, a firewall rule must exist allowing\nfor all hosts from the enterprise to communicate with the historian. Typically, this\ncommunication occurs as Structured Query Language (SQL) or HTTP requests and flaws in the\nhistorian's application layer code could result in a compromised historian. Once the historian is\ncompromised, the remaining nodes on the process control network are vulnerable to a\nworm/virus propagating or an interactive attack.\n\nSecondly, spoofed packets can be constructed that can affect the PCN and covert data may be\nable to be tunnelled in allowed protocols. For example, if HTTP packets are allowed through the\nfirewall then Trojan software accidentally introduced on a HMI or PCN laptop could be both\ncontrolled by a remote entity and send data (such as captured passwords) to that entity, disguised\nas legitimate traffic.\n\nIn summary, while this architecture is a significant improvement over the previous two, it\nrequires the opening of rule sets that allow direct communications between enterprise and\nPCN/SCADA devices. This can result in possible security breaches if not very carefully designed\nand monitored. [Security = 3 Manageability = 5 Scalability = 4]\n\n\n-----\n\n**_4.5_** **_Router/Firewall Combination between PCN and EN_**\n\nA slightly more sophisticated design is the use of a router/firewall combination, where the router\nsits in front of the firewall and offers basic packet filtering services, while the firewall handles\nthe more complex issues using either stateful inspection or proxy techniques. This type of design\nis very popular in Internet-facing firewalls because it allows the faster router to handle the bulk\nof the incoming packets, especially in the case of DoS attacks, and reduces the load on the\nfirewall. It also offers improved defence in depth since there are two very different devices an\nattacker must bypass. Finally, simple rules in the router can prevent packets from circumventing\nthe firewall in complex architectures.\n\n**Firewall**\n\n**External** **Internal**\n**Router** **Switch**\n\n**Internet**\n\n### � �\n\n**Figure 6: Network Separation with Firewall/Router Combination (Internet Example)**\n\nWhile mentioned in the occasional industrial document (and very popular in the corporate IT\nworld), this design appears to be rarely used in the PCN/SCADA environment. In the few\nexamples the study team did uncover, the routers placed in front of PCN/SCADA firewalls did\nnot appear to be used for security functions. [Security = 3.5 Manageability = 3 Scalability = 4]\n\n**_4.6_** **_Firewall with Demilitarized Zones between PCN and EN_**\n\nA significant improvement is the use of firewalls with the ability to establish a number of\nDemilitarised Zones (DMZ) between the enterprise and process control networks. Each DMZ\nholds a separate \"critical\" component, such as the data historian, the wireless access point or\nremote and third party access systems. In effect, the use of a DMZ-capable firewall allows the\ncreation of an intermediate network often referred to as a Process Information Network (PIN).\n\nTo create a DMZ requires that the firewall offer three or more interfaces, rather than the typical\npublic and private interfaces. One of the interfaces is connected to the enterprise; the second is\nconnected to the PCN/SCADA network and the remaining interfaces to the shared or insecure\ndevices such as the data historian server or wireless access points. Figure 7 illustrates a typical\nDMZ firewall design in a PCN/SCADA setting.\n\n\n-----\n\n**Figure 7: Firewall with Demilitarized Zone for Shared Enterprise/PCN Devices**\n\nBy placing enterprise-accessible items in the DMZ, no direct communication paths are required\nfrom the enterprise network to the plant floor and each network effectively ends in the DMZ.\nMost sophisticated firewalls can allow for multiple DMZs, and specify what type of traffic is\nforwardable between zones. As above, the firewall blocks arbitrary packets from the enterprise\nnetwork from entering the PCN, but also regulates traffic from the other network zones. By\njudicious use of access control lists a clear separation can be maintained between the PCN and\nother networks, with very little to no traffic directly between enterprise and PCN/SCADA\nnetworks.\n\nThe primary security risk in this type of architecture is that if a computer in the DMZ is\ncompromised, then it can be used to launch an attack against the PCN via application traffic\npermitted from the DMZ to the PCN. This risk can be greatly reduced if a concerted effort is\nmade to harden and actively patch the servers in the DMZ and if the firewall rules set permit\nonly connections between the PCN and DMZ are initiated by PCN devices.\n\nThe concerns expressed by interviewed end users with this design were the added complexity\n(one company pointed out that the multiple interfaces can increase ACL rule complexity and\nincrease the likelihood for errors) and the increased cost of firewalls with three or more ports.\nHowever, the study team believes that the improved security more than offsets these\ndisadvantages. Several standards such as API-1164 and a number of the more sophisticated\nvendor[14] [15] and end user documents propose this type of design.\n\n**[Security = 4 Manageability = 4.5 Scalability = 4]**\n\n**_4.7_** **_Paired Firewalls between PCN and EN_**\n\nA variation on the firewall with DMZ solution is to use a pair of firewalls positioned between the\nenterprise and process control networks. Common servers (such as the data historian) are situated\nbetween the firewalls in a DMZ-like network zone called either a PIN or Manufacturing\nExecution System (MES) layer[16]. As in the architectures above, the first firewall blocks arbitrary\npackets from proceeding to the process control network or the shared historians. The second\nfirewall can prevent unwanted traffic from a compromised server from entering the PCN or PCN\ntraffic from impacting the shared servers.\n\n\n-----\n\n**Figure 8: Paired Firewalls with Demilitarized Zone for Shared Enterprise/PCN Assets**\n\nIf firewalls from two different manufacturers are used, then this solution may offer a “defence in\ndepth” advantage[ii]. It also allows process control groups and the IT groups to have clearly\nseparated device responsibility since each can manage a firewall on its own. In fact it is the study\nteam’s understanding that this design is recommended in the Federal Energy Regulatory\nCommission (FERC) Proposal for Security Standards for this reason.\n\nA variation on this architecture is the basis for the IEC/SC 65C/WG 13 draft for “Enterprise\n_Network – Control Network Interconnection Profile (ECI)[17]”. It, however, proposed a router for_\nthe EN to DMZ firewall, possibly weakening the overall security. The packet filtering services\noffered by the router could leave the servers inside the DMZ exposed to more sophisticated\nattacks from the EN and they, if compromised, could be used as a staging point for attacks into\nthe PCN.\n\nThe primary disadvantage with all two firewall architectures is the increased cost and\nmanagement complexity. For environments with severe security requirements or the need for\nclear management separation, this architecture has some strong advantages.\n\n**[Security = 5 Manageability = 3 Scalability = 3.5]**\n\n**_4.8_** **_Firewall and VLAN-based Process Network Combinations_**\n\nThus far, the designs have treated the PCN/SCADA network as a single entity. However in many\ncases there are functional areas or cells in the PCN or SCADA system where inter-area\ncommunication is not necessary (or perhaps not wanted). Extending the above architectures by\nfurther dividing the SCADA or PCN into a number of VLANs allows for inter-VLAN\ncommunication that can be controlled with simple packet filters in Layer-3 switches. Below the\nLayer-3 switch is a number of VLAN-capable Layer-2 switches that allow direct communication\nbetween devices on the same VLAN, but force all inter-VLAN traffic back to the Layer-3 switch\nfor filtering.\n\nii There is considerable debate regarding whether there is a significant advantage in using two different firewalls,\nsince rarely is the firewall itself compromised. Most currently observed infiltrations of PCNs are the result of either\nviruses/worms through allowed services or mis-configuration of the firewall, independent of vendor.\n\n\n-----\n\nVLANs prevent the propagation of unwanted traffic across the entire PCN from either accidental\naccess by PCN staff or from introduced viruses. This design also helps mitigate the \"virus\nintroduced by a laptop on a PCN\" issue. Assuming that the PCN/SCADA environment is highly\nsecure as a result of the other firewall(s) between it and the enterprise networks, then more\nsophisticated firewalls are not required at this level.\n\n**DMZ/PIN**\n\n**Enterprise**\n**Network**\n**Historian**\n\n**802.11 WLAN**\n\n**L3-Switch**\n**L2-Switch** **L2-Switch**\n\n**PLC VLAN** **DCS VLAN**\n\n**Server**\n\n**PLC** **PLC**\n\n**DCS**\n\n**Figure 9: Firewall with Demilitarized Zone and SCADA/PCN VLANs**\n\nSeveral major auto manufacturers utilize variations on this design. Provided that DMZs are also\nused, then this architecture is very secure. Its primary disadvantages are added management\ncomplexity and cost. [Security = 4.5 Manageability = 3 Scalability = 5]\n\n**_4.9_** **_Summary of Firewall Architectures_**\n\nThe eight PCN/SCADA to EN segregation architectures recorded during this survey can be\nbroken down into three general classifications:\n\n1. Separation using non-firewall devices such as dual-homed workstations, bridges and\nrouters (Architectures 1,2 and 3)\n\n2. Two zone firewall-based designs without a DMZ (Architectures 4 and 5)\n\n3. Three zone firewall-based designs with a DMZ (Architectures 6, 7 and 8)\n\nIn Table 1 we have summarized our ratings of security, manageability and scalability for each of\nthe eight segregation architectures, while Figure 10 shows the same information in a graphical\nformat. It is important to note that these ratings are approximate only and are based on the\nassumptions that only technologies that are widely available at the time of the report are used and\nthat they are deployed in typical configurations. Unusual environments, technologies or\ndeployments will require the reader to adjust these ratings accordingly.\n\n\n-----\n\n**Architecture** **Security** **Manageability** **Scalability**\n\n1 Dual Homed Computers 1 2 1\n\n2 Dual Homed Server with Personal Firewall 2 1 1\n\n3 Packet Filtering Router/Layer-3 Switch 2 2 4\n\n4 Two-Port Firewall 3 5 4\n\n5 Router/Firewall Combination 3.5 3 4\n\n6 Firewall with Demilitarized Zones 4 4.5 4\n\n7 Paired Firewalls 5 3 3.5\n\n8 Firewall/VLAN-based Combination 4.5 3 5\n\n**Table 1: Approximate Security, Manageability and Scalability Ratings for PCN/SCADA**\n**Segregation Architectures**\n\n**Firewall/VLAN-based Combination 8**\n\n**Paired Firewalls 7**\n\n**Firewall with Demilitarized Zones 6**\n\n**Router/Firewall Combination 5**\n\n**Two-Port Firewall 4**\n\n**Router/Layer-3 Switch 3** **Scalability**\n\n**Managability**\n\n**Dual Homed Servers with Personal Firewall 2** **Security**\n\n**Dual Homed Computers 1**\n\n**0** **1** **2** **3** **4** **5**\n\n**Rating (1=Worst 5=Best)**\n\n**Figure 10: Comparison Chart for PCN/SCADA Segregation Architectures**\n\nIn summary, it is the study team’s opinion that the non-firewall based solutions will generally not\nprovide suitable isolation between PCN/SCADA networks and enterprise networks. The two\nzone solutions are marginally acceptable but should be only be deployed with extreme care. The\nmost secure, manageable and scalable PCN/EN segregation architectures should be based on a\nthree zone system such as those described in Sections 4.6, 4.7 and 4.8.\n\n|Architecture|Security|Manageability|Scalability|\n|---|---|---|---|\n|1 Dual Homed Computers|1|2|1|\n|2 Dual Homed Server with Personal Firewall|2|1|1|\n|3 Packet Filtering Router/Layer-3 Switch|2|2|4|\n|4 Two-Port Firewall|3|5|4|\n|5 Router/Firewall Combination|3.5|3|4|\n|6 Firewall with Demilitarized Zones|4|4.5|4|\n|7 Paired Firewalls|5|3|3.5|\n|8 Firewall/VLAN-based Combination|4.5|3|5|\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|\n|---|---|---|---|---|---|---|\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n|||||||calability anagability ecurity|\n||||||||\n|||||||calability anagability ecurity|\n||||S M S||S M S||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n||||||||\n\n\n-----\n\nThis page is deliberately left blank.\n\n\n-----\n\n## 5 Firewall Implementation and Configuration\n\n**_5.1_** **_General Firewall Policies_**\n\nOnce the firewall architecture is in place, the work of determining exactly what traffic you want\nto allow through the firewall begins. As Request for Comment (RFC) 2196 - Site Security\nHandbook puts it:\n\n_The difficult part is establishing the criteria by which the packets are allowed or denied_\n_access through the doors.[18]_\n\nConfiguring the firewall to “Deny All” except for pin-holes absolutely required for business\nneeds is every company’s basic premise, but the reality is much more difficult. Exactly what\ndoes “absolutely required for business” mean and what are the security impacts of allowing those\n“pin-holes” through? For example, many companies considered allowing SQL traffic through the\nfirewall as required for business for many data historian servers. Unfortunately SQL was also the\nvector for the Slammer worm. The fact is, many important protocols used in the industrial world,\nsuch as HTTP, FTP, OPC[®]/DCOM[®], EtherNet/IP™ and MODBUS/TCP, are significant security\nrisks.\n\nIf one is installing a single two-port firewall without a DMZ for shared servers (i.e. the\narchitecture described in Section 4.4) then particular care needs to be taken with the rule design.\nAt a minimum, all rules should be stateful rules that are both IP address and port (application)\nspecific. The address portion of the rules should restrict incoming traffic to a very small set of\nshared devices (e.g. the data historian) on the PCN from a controlled set of address on the\nenterprise network. Allowing any IP addresses on the enterprise network to access the server\ninside the PCN is not recommended. In addition, the allowed ports should be carefully restricted\nto relatively secure protocols such as HTTPS. Allowing HTTP, FTP or any unencrypted SCADA\nprotocol to cross the firewall is a security risk due to the potential for traffic sniffing and\nmodification.\n\nOn the other hand, if the DMZ architecture is being used, then it is possible to configure the\nsystem so that no traffic will go directly between enterprise and PCN/SCADA networks. With a\nfew special exceptions (noted below) all traffic from either side can terminate at the servers in\nthe DMZ. This allows more flexibility in the protocols allowed through the firewall. For\nexample, MODBUS/TCP might be used to communicate from the PLCs to the Data Historian,\nwhile HTTP might be used for communication between the historian and enterprise clients. Both\nprotocols are inherently insecure, yet in this case they can be used safely as neither actually\ncrosses between enterprise and PCN.\n\nAn extension to this concept is the idea of using “disjoint” protocols in all PCN-enterprise\ncommunications. That is, if a protocol is allowed between the PCN and DMZ then it is explicitly\nNOT allowed between DMZ and enterprise networks. This design greatly reduces the chance of\na worm such as Slammer actually making its way into the PCN/SCADA network since the worm\nwould have to deploy two different exploits over two different protocols.\n\n\n-----\n\nOne area of considerable variation in practice is the control of outbound traffic from the PCN.\nWhile some organizations seem to have a very open attitude towards this type of traffic, the\nstudy team believes this traffic to represent a significant risk if unmanaged. One example, noted\nearlier in Section 4.3, is trojan software that uses HTTP tunnelling to exploit poorly defined outbound rules. Thus it is important that outbound rules be as stringent as inbound rules. AppendixA of ISA’s SP-99 Technical Report #2 contains some example guidelines that help clarify this. A\nsummary of these follows:[19]\n\n1. Outbound traffic through the PCN firewall should be limited to essential communications\nonly;\n\n2. All outbound traffic from the PCN to the enterprise network will be source and\ndestination restricted by service and port using static firewall rules;\n\n3. Mapped drives across the PCN firewall should be avoided.\n\nIn addition to these rules, the firewall should be configured with outbound filtering to stop forged\nIP packets from leaving the PCN/SCADA network or the DMZ. In practice this is achieved by\nchecking the source IP addresses of outgoing packets against the firewall’s respective network\ninterface address. The intent is to prevent the PCN network from being the source of spoofed\n(i.e. forged) communications which are often used in DoS Attacks. Thus the firewalls should be\nconfigured to forward IP packets only if those packets have a correct source IP address for the\nPCN/SCADA or DMZ networks[20].\n\nFinally, the question of PCN/SCADA connection and communication with the Internet elicits a\nwide variety of practices. For example, API -1164 states:\n\n_“Internet connections should not terminate directly into the SCADA network. A firewall_\n_should be used to isolate the SCADA network from the Internet.”[21]_\n\nIn contrast, one of the end-user documents states:\n\n_“PCNs shall not be directly connected to the Internet, even if protected via a firewall”._\n\nWhile there will be special situations (such as access for remote support) that might support the\nfirst rule, we believe that the second is far more secure and should be the goal. Either way,\nInternet access by devices on the PCN should be strongly discouraged.\n\nIn summary, the study team believes that the following should be considered as recommended\npractice for general firewall rule sets:\n\n1. The base rule set should be DENY ALL, PERMIT NONE.\n\n2. Ports and services between the PCN environment and an external network should be\nenabled and permissions granted on a specific case by case basis. There should be a\ndocumented business justification with risk analysis and a responsible person for each\npermitted incoming or outgoing data flow[22].\n\n\n-----\n\n3. All “permit” rules should be both IP address and TCP/UDP port specific, and stateful if\nappropriate;\n\n4. All rules shall restrict traffic to specific IP address or range of addresses;\n\n5. All traffic on the PCN/PIN is typically based only on routable IP protocols, either TCP/IP\nor UDP/IP. Thus any non-IP protocol should be dropped;\n\n6. Prevent traffic from transiting directly from the PCN/SCADA network to the enterprise\nnetwork. All traffic should terminate in the DMZ;\n\n7. Any protocol allowed between the PCN and DMZ is explicitly NOT allowed between\nDMZ and enterprise networks (and vice-versa);\n\n8. All outbound traffic from the PCN to the enterprise network should be source and\ndestination restricted by service and port using static firewall rules;\n\n9. Allow outbound packets from the PCN or DMZ only if those packets have a correct\nsource IP address assigned to the PCN or DMZ devices;\n\n10. PCN devices should not be allowed to access the Internet.\n\n11. PCNs shall not be directly connected to the Internet, even if protected via a firewall.\n\n12. All firewall management traffic be either via a separate, secured management network\n(e.g. out of band) or over an encrypted network with two-factor authentication. Traffic\nshould also be restricted by IP address to specific management stations.\n\nThe reader is cautioned that these should only be considered as guidelines. A careful assessment\nof each control environment is required before implementing any firewall rule sets. Furthermore,\nthere will always be exceptions to these rules. For example, certain direct database to database\nconnections may be needed to synchronize a data historian on the PCN with a corporate-wide\ndatabase, violating suggestion #4. Similarly, time service communication to a corporate time\nserver may have to traverse the PCN firewall to synchronize device times on PCN. These\nexceptions and how they might be addressed will be discussed in more detail in later sections of\nthe report.\n\n**_5.2_** **_Rules for Specific Services_**\n\nBeside the general rules described above, it is difficult to outline all purpose rules for specific\nprotocols. The needs and best practices vary significantly between industries for any given\nprotocol and should be analysed on a company by company basis. The Industrial Automation\nOpen Networking Association (IAONA) offers a template for conducting such an analysis[23],\nassessing each of the protocols commonly found in industrial environments in terms of function,\nsecurity risk, worst case impact and suggested measures. Below we will summarize some of the\nkey points from the IAONA document, suggested practices from the ISA TR2 Appendix A and\nseveral user policy documents. The reader is advised to consult these documents directly when\ndeveloping rule sets.\n\n\n-----\n\n5.2.1 Domain Name Service (DNS)\n\nDomain Name Service (DNS) is primarily used to translate between domain names (such as\ncontrol.com) and IP addresses (such as 192.168.1.1). Most Internet services rely heavily on\nDNS, but its use on the plant floor is relatively rare at this time. In most cases there is little\nreason to allow DNS requests out of the PCN to the enterprise network and no reason to allow\nDNS requests into the PCN. DNS requests from the PCN to DMZ should be addressed on a case\nby case basis. Local DNS or the use of host files is recommended.\n\n5.2.2 Hyper Text Transfer Protocol (HTTP)\n\nHyper Text Transfer Protocol (HTTP) is the protocol underlying web browsing services on the\nInternet. Like DNS, it is critical to most Internet services. It is seeing increasing use on the plant\nfloor as an all purpose query tool. Unfortunately it has little inherent security and has the ability\nto be a transport mechanism for a very large number of manual attacks and worms. In addition\nHTTP applications are renowned for having vulnerabilities that can be exploited.\n\nIn general, HTTP should not be allowed to cross from the enterprise to the PCN. If it is, then\nHTTP proxies should be configured on the firewall to block all inbound scripts and Java\napplications. Incoming HTTP connections should not be allowed into the PCN as they pose\nsignificant security risks. If HTTP services into the PCN are absolutely required, it is\nrecommended that HTTPS be used instead and only to very specific devices.\n\n5.2.3 File Transfer Protocol (FTP) and Trivial File Transfer Protocol (TFTP)\n\nThe File Transfer Protocol (FTP) and Trivial File Transfer Protocol (TFTP) are used for\ntransferring files between devices. They are implemented on almost every platform including\nmany DCS, PLCs and Remote Terminal Units (RTUs), since they are extremely well known and\nuse minimum processing power. Unfortunately neither protocol was created with security in\nmind; in the case of FTP the login password is not encrypted and, in the case of TFTP, no login\nis required at all. Furthermore, some FTP implementations have a history of buffer overflow\nvulnerabilities. As a result all TFTP should be blocked while FTP should be allowed on\noutbound sessions only or if secured with additional token-based two-factor authentication and\nan encrypted tunnel.\n\n5.2.4 Telnet\n\nThe Telnet protocol defines an interactive, text based communications session between a client\nand a host. It is mainly used for remote login and simple control services to systems with limited\nresources or to systems with limited needs for security. It is a severe security risk because all\ntelnet traffic, including passwords, is unencrypted and it can allow a remote individual\nconsiderable control over a device. Thus inbound Telnet session commands from the enterprise\nto the PCN should be prohibited unless secured with token-based two-factor authentication and\nan encrypted tunnel. Outbound telnet sessions should be allowed only over encrypted tunnels to\nspecific devices.\n\n\n-----\n\n5.2.5 Simple Mail Transfer Protocol (SMTP)\n\nThe Simple Mail Transfer Protocol (SMTP) is the primary email transfer protocol on the\nInternet. Email messages are notorious for containing viruses so inbound e-mail should not be\nallowed to any PCN device. Outbound SMTP mail messages from the PCN to the enterprise are\nacceptable.\n\n5.2.6 Simple Network Management Protocol (SNMP)\n\nThe Simple Network Management Protocol is used to provide network management services\nbetween a central management console and network devices such as routers, printers and PLCs.\nWhile SNMP is an extremely useful service for maintaining a network, its security weaknesses\nare infamous. Version 1 and 2 of SNMP uses unencrypted passwords to both read and configure\ndevices (including devices such as PLCs) and in many cases the passwords are well known and\ncannot be changed. Version 3 is considerably more secure but is still limited in use. In addition,\nSNMP implementations in embedded devices have been shown to be seriously flawed in many\ninstances. Thus SNMP commands both to and from the PCN should prohibited unless it is over a\nseparate, secured management network.\n\n5.2.7 Distributed Component Object Model (DCOM)\n\nThe Distributed Component Object Model (DCOM) is the underlying protocol for both the\npopular OLE for Process Control (OPC) and ProfiNet[®]. It utilizes Microsoft’s Remote Procedure\nCall (RPC) service which has known vulnerabilities that were the basis for the Blaster Worm\nexploits. In addition, OPC (DCOM) dynamically opens a wide range of ephemeral ports (#1024\n– #65535) that can be extremely difficult to filter at the firewall. This protocol should only be\nallowed between PCN and DMZ networks and explicitly blocked between the DMZ and\nenterprise network. Also, users are advised to restrict the port ranges used by making registry\nmodifications on devices using DCOM.\n\n5.2.8 SCADA and Industrial Protocols\n\nSCADA and industrial protocols, such as MODBUS/TCP, EtherNet/IP and DNP3, are critical\nfor communications to most control devices. Unfortunately, these protocols were designed\nwithout security in mind and do not typically require any authentication to remotely execute\ncommands on a control device. Thus these protocols should only be allowed between the PCN\nand PIN and not allowed to cross into the enterprise network.\n\n**_5.3_** **_Network Address Translation (NAT)_**\n\nOne of the more contentious “best practices” is whether or not to use Network Address\nTranslation (NAT) on the firewall. For example, from ISA SP-99 Technical Report #2:\n\n_\"NAT will not be used on the PCN\"[24]_\n\nWhile in an end-user firewall practices the guideline reads:\n\n_\"NAT is used on the interface connecting to the (Enterprise Network)\"_\n\n\n-----\n\nAs noted in section 2.3, NAT is a service where IP addresses used on one side of the firewall can\nbe mapped to a different set on the other side on an as-needed basis. It was originally designed\nfor IP address reduction purposes so that a company with a large number of devices that\noccasionally needed Internet access could get by with a smaller set of assigned Internet\naddresses.\n\nTo do this, NAT relies on the premise that not every internal device is actively communicating\nwith external hosts at a given moment. The firewall is configured to have a limited number of\noutwardly visible IP addresses. When an internal host seeks to communicate to an external host,\nthe firewall remaps the internal IP address and port to one of the currently unused, more limited,\npublic IP addresses -- effectively concentrating outgoing traffic into fewer IP addresses. The\nfirewall must track the state of each connection, and how each private internal IP address and\nsource port was remapped onto an outwardly visible IP address/port pair. When returning traffic\nreaches the firewall, the mapping is reversed and the packets forwarded to the proper internal\nhost.\n\nFor example, a PCN-based device may need to establish a connection with an external, non-PCN\nhost (for instance, to send a critical alert email). NAT allows the internal IP address of the\ninitiating PCN host to be replaced by the firewall; subsequent return traffic packets are remapped\nback to the internal IP address and sent to the appropriate PCN device. More specifically, if the\nPCN is assigned the private subnet 192.168.1.xxx and the Internet network expects the device to\nuse the corporate assigned addresses in the range 142.232.yyy.zzz, then a NAT firewall will\nsubstitute (and track) a 142.232.yyy.zzz source address into every outbound IP packet generated\nby a PCN device.\n\nToday NAT is often promoted as a security feature since NAT’ed traffic ends up appearing\n(from an IP address perspective) as though the firewall is the initiator of the connection. NAT\nhas effectively camouflaged the internal host's identity by acting as an intermediary between the\ninternal and external hosts. If a device is not actively communicating to an external network then\nno NAT mapping for that device will exist in the firewall and thus no externally routable address\nis visible to the outside world. If internal devices are addressed with private addresses (as per\nRFC 1918), no router should allow direct traffic to reach them from the Internet; the only way to\ncommunicate with the internal devices is in fact through the NAT'ed connection. Of course any\ndevice with an active connection through the firewall will be visible to the outside world.\n\nWhether NAT is really a true security technique or just “security through obscurity\" is an open\ndebate in the networking community. However, there is little doubt that using NAT can have\nnegative consequences in some certain situations. First of all, debugging a firewall or validating\na firewall's rule set as secure can be made more difficult using NAT, due to the dynamic nature\nof the currently open connections and the IP address/port combinations that must be allowed to\npass back in.\n\nFurthermore, certain protocols are specifically broken by NAT because of the lack of direct\naddressing. For example, OPC requires special 3rd party tunnel software to work with NAT.\nProducer-consumer protocols, such as EtherNet/IP and Foundation Fieldbus HSE[®], are\nparticularly troublesome as NAT does not support the multicast-based traffic that these protocols\nneed to offer their full services.\n\n\n-----\n\nIn summary, while NAT offers some distinct advantages, its impact on the actual industrial\nprotocols and configuration should be assessed carefully before it is deployed.\n\n**_5.4_** **_Specific PCN Firewalls Issues_**\n\n5.4.1 Data Historians\n\nAs noted earlier in this report, the existence of shared PCN/enterprise servers such as data\nhistorians and asset management servers can have a significant impact on firewall design and\nconfiguration. In three-zone systems the placement of these servers in a DMZ is relatively\nstraightforward, but in two-zone designs the issues become complex. Placing the historian on the\nenterprise side of the firewall means that a number of insecure protocols, such as MODBUS/TCP\nor DCOM, must be allowed through the firewall and that every control device reporting to the\nhistorian is exposed to the enterprise side of the network. On the other hand, putting the historian\non the PCN side means other equally questionable protocols, such as HTTP or SQL, must be\nallowed through the firewall and there is now a server accessible to nearly everyone in the\ncorporation sitting on the PCN.\n\nIn general, the best solution is to avoid two-zone systems and use a three-zone design, placing\nthe data collector in the PCN and the historian component in the DMZ or PIN. Even this can\nprove problematic in some situations. Heavy access from the large numbers of users on the\nenterprise network to a historian in the DMZ may tax the firewall’s throughput capabilities. One\nsuggested solution is to install two servers; one on the PCN to collect data from the control\ndevices and a second on the enterprise network mirroring the first server and supporting client\nqueries. Of course this requires a special hole to be put through the firewall to allow direct server\nto server communications, but if done correctly, this poses only minor risk.\n\n5.4.2 Remote Support Access\n\nAnother issue for PCN/SCADA firewall design is the use of 3[rd] party or remote access into the\nPCN. Obviously any users accessing the PCN from remote networks should be required to\nauthenticate using an appropriately strong mechanism such as token-based authentication. While\nit is possible for the controls group to set up their own remote access system with two-factor\nauthentication on the DMZ, in most companies it is typically more efficient to use existing\nsystems set up by the IT department. In this case a connection through the firewall from the IT\nremote access server is needed.\n\nSeveral documents suggest that remote support personnel connecting over the Internet or via\ndialup modems should run the corporate VPN connection client and authenticate using the token\nbased two-factor authentication scheme in order to connect to the general corporate network.\nOnce connected there they should be required to authenticate a second time at the PCN firewall\n(using two factor authentication) to gain access to the PCN network. For companies that don't\nallow any control traffic traversing the enterprise network in the clear, this will require a\ncascading or secondary tunnelling solution to gain access to the PCN, such as Secure Sockets\nLayer (SSL) VPNs inside an Internet Protocol Security (IPsec) VPN.\n\n\n-----\n\n5.4.3 Multicast Traffic\n\nMulticasting is a communication method in which a source device can send a single data\nmessage simultaneously to a group of destination devices. As opposed to sequentially sending\nthe same message to each destination, the message can be sent once over a network and any host\n\"tuned in\" to the transmission will receive it.\n\nMost industrial producer-consumer (or publisher-subscriber) protocols operating over Ethernet,\nsuch as EtherNet/IP and Foundation Fieldbus HSE, are IP multicast-based. The first advantage of\nIP multicasting is network efficiency; by not repeating the data transmission to the multiple\ndestinations, a significant reduction in network load can occur. The second advantage is that the\nsending host need not be concerned with knowing every IP address of every destination host\nlistening for the broadcast information. The third, and perhaps most important for industrial\ncontrol purposes, is a single multicast message offers far better capabilities for time\nsynchronization between multiple control devices than multiple unicast messages.\n\nMulticasting in IP environments typically occurs through the use of multicast group ID's which\nare mapped directly onto the class D IP address range (from 224.0.0.0 to 239.255.255.255).\nEach address is considered a separate “transmission frequency”; a host listening to multicast\npackets must \"tune in\" to the group ID (IP address) of the transmission it wishes to receive.\n\nIf the source and destinations of a multicast packet are connected with no intervening routers or\nfirewalls between them, the multicast transmission is relatively seamless[iii]. However, if the\nsource and destinations are not on the same LAN, forwarding the multicast messages to a\ndestination becomes more complicated. To solve the problem of multicast message routing, hosts\nneed to join (or leave) a group by informing the multicast router on their network of the relevant\ngroup ID through the use of the Internet Group Management Protocol (IGMP). Multicast routers\nsubsequently know of the members of multicast groups on their network and can decide whether\nor not to forward a received multicast message onto their network. A multicast routing protocol\nis also required. From a firewall administration perspective, monitoring and filtering IGMP\ntraffic becomes another series of rule sets to manage, adding to the complexity of the firewall.\n\nAnother firewall issue related to multicasting is the use of NAT. A NAT'ing firewall receiving a\nmulticast packet from an external host has no reverse mapping for which internal group ID to\nsend the data to. It could, if IGMP-aware, broadcast it to every group ID it knows about (one of\nthem will be correct!), but this could cause serious issues if an unintended control packet was\nbroadcast to a critical node. The safest action for the firewall to take is to drop the packet. Thus\nmulticasting is generally considered NAT-unfriendly.\n\niii Since it's easy to set up and requires little administration, multicasting is gaining in popularity among the control\nsystem suppliers. However, it can be extremely disruptive in some situations. At least one large end-user reported\nsignificant problems with legitimate multicast traffic on PCNs with large VLANs and many PLCs.\n\n\n-----\n\n## 6 Management of PCN/SCADA Firewalls\n\nThe firewall is a focal point for PCN/SCADA security and requires considerable resources, not\nonly for initial design and commissioning, but also for on-going monitoring, incident\nmanagement, upgrading and technical support. The complexity of this task should not be\nunderestimated, but unfortunately it often is. For example, a recent paper on firewall\nconfiguration errors by Avishai Wool showed that even core firewalls in major corporations can\nbe enforcing poorly written rule sets and vulnerable to attack[25]. In the study the author defined\n12 serious firewall configuration errors (each very general in nature) and then inspected the\nfirewall configurations of 27 major corporations. He found an average 7 serious errors per\nfirewall, with some having as many as 12 errors. The results clearly indicate the complex nature\nof firewall management.\n\nThe following are some of the management tasks that should be considered when setting up a\nfirewall:\n\n1. **Change Management and Documentation: The configuration and rule sets in the**\nSCADA/PCN can have a significant impact on production and safety in most facilities.\nThus all firewall policies must be carefully documented and subject to the same change\nmanagement requirements any PLC or DCS would be subjected to.\n\nIt is recommended that all access control lists be documented and that this documentation\nincludes the purpose of each rule, interdependencies, and security considerations\naddressed. The rules on these devices need to be reviewed regularly to ensure that the\nbusiness case for the connection is still valid and the security controls in place.\n\n2. **Monitoring of Firewall Logs and IDS: The team responsible for the firewall must**\nperform monitoring and associated alerting of both logs and IDS events.\n\n3. **Define an Incident Response Plan: An incident response plan defines the emergency**\nresponse process to a suspected or actual incident and defines the steps the management\nteam uses to address the incident. This will include possible disconnection of the PCN\nfrom the enterprise network and the later re-engagement process. Where a full\ndisconnect is not practical it should define the maximum possible restrictions that can be\nenabled when required.\n\nThe re-engagement process can include details of so-called ‘pinhole’ configurations\nwhich allow temporary access to an extremely small set of trusted resources from which\ninformation and, for instance, anti-virus measures can be picked up so that the process\ncontrol environment defences can be brought up to date prior to restoring full\nconnectivity.\n\n4. **Support, patches and updates: The management team should monitor the appropriate**\nvulnerability lists, vendor update lists and Computer Emergency Response Team (CERT)\nsecurity alerts. Suitably qualified and authorised personnel should perform updates,\nupgrades, anti-virus upgrades, user/account management and capacity monitoring on a\nregular basis.\n\n\n-----\n\nThe above management services can either be provided by local staff such as the process control\nor IT departments or it can be provided from a central resource, either corporate or a 3rd party.\nOf the 15 companies interviewed, most of the large corporations managed their PCN firewalls\ncentrally, while the smaller firms managed it locally with internal resources. A suggested rule of\nthumb was that central management is preferred for groups with more than 10 PCN/SCADA\nfirewalls.\n\nRegardless of whether central or local management is selected, nearly all end users pointed out\nthe need to include control engineers as part of the team designing, implementing and\nmaintaining the firewall systems. In general, the people who understand and set-up firewalls well\ndo not know process control specifics. For example, most security experts are Internet focused\nand do not know that most control systems do not use DNS in the PCN. As a result they might\nassume that a DNS request is legitimate when in many cases it is an attempt to breach the\nfirewall or an indication of improper activity on the PCN. Creating cross-functional controls/IT\nsecurity teams is highly recommended for PCN/SCADA firewall management.\n\n\n-----\n\n## 7 Special or Future Technologies\n\n**_7.1_** **_SCADA Protocol Aware Firewalls_**\n\nAt the present time, commercially-available firewalls are focused on traditional Internet and\ncorporate application layer protocols and are unaware of the existence of industrial protocols\nsuch as MODBUS/TCP or EtherNet/IP. As a result, they can not examine or filter SCADA\npackets at the application layer or offer proxy services for these protocols. What would be ideal\nis a firewall that would understand the protocols well enough to allow rules that would block\ncertain SCADA functions. For example, a rule might allow only MODBUS read commands to\ncross the firewall and drop all packets with invalid or unauthorized function codes.\n\nWhile no commercial products are offered at the present time, open source MODBUS-aware\nfirewall extensions to the Linux kernel have been developed by Matthew Franz and Venkat\nPothamsetty of the Cisco Systems Critical Infrastructure Assurance Group (CIAG). These are\navailable at no charge from http://modbusfw.sourceforge.net/\n\n**_7.2_** **_Distributed Micro-Firewalls_**\n\nSeveral researchers have proposed the idea of a distributed micro-firewall appliance that could\nbe installed in front of each PLC or RTU that is in need of critical protection. Each unit would be\nconfigured with security applications specific to its purpose, while tied back to a centralized\nmanagement system. These firewall appliances would communicate over a secure channel,\nfurther protecting both the appliance and the PLC behind it from malicious attacks. The benefit\nof this approach is that it would offer a significant second layer of defence inside the PCN\nfirewall and would protect critical devices from internal attack.\n\nNo products of this type are currently available for the SCADA market, but a research project to\ndevelop a prototype is currently underway at the British Columbia Institute of Technology. In\naddition, Siemens has announced plans to release in late 2004 a VPN gateway that can also act as\na distributed micro-firewall.\n\n**_7.3_** **_Quality of Service (QoS)_**\n\nOne suggestion uncovered during this study was the use of Quality of Service (QoS) features in\nnetwork equipment as a way to ensure that DoS attacks are of limited effectiveness in PCNs.\nQoS is a concept where packets are tagged with a special priority field that indicates how they\nshould be handled by each router or switch they encounter. The IEEE 802.1q variation of QoS is\ngetting some attention in the industrial setting for this reason, but is not yet widely deployed.\nHowever, should QoS gain wide usage in the industrial world then this could be a useful tool in\nthe security arsenal.\n\nIt should be noted that QoS mitigation techniques need a detection mechanism (such as IDS/AV)\nto be effective. The mitigation effectiveness is also increased significantly if the QoS\nmechanism implemented on the device using Network-Based Application Recognition (NBAR).\nIf the device can not inspect the traffic, then QoS is effective only if you can trust the markings\n\n\n-----\n\nof the packets coming into the networking device. Unfortunately, a couple of recent of worms\nactually make the QoS tags high to get better propagation characteristics.\n\n**_7.4_** **_One Way Communication Paths_**\n\nThe concept of one-way communication paths that allow traffic out of the PCN only is discussed\nin Annex G of IEEE Std 7-4.3.2[26], \"IEEE Standard for Digital Computers in Safety Systems of\nNuclear Power Generating Stations\". While this discussion appears to be designed with serial\nlinks in mind, it is possible to create these one-way paths over IP connections using a UDP,\ninstead of the more well known TCP. At the present time we are unaware of any companies\ndeploying this technique in the field, but it shows promise for sites requiring more stringent\nsecurity than ACLs can provide.\n\n\n-----\n\n## Acronyms\n\nACL – Access Control List\nAIChE – American Institute of Chemical Engineers\nAPI – American Petroleum Institute\nBCIT – British Columbia Institute of Technology\nCERT – Computer Emergency Response Team\nCIAG – Critical Infrastructure Assurance Group (Cisco Systems Inc.)\nCIP – Common Industrial Protocol\nDCOM – Distributed Component Object Model\nDCS – Distributed Control System\nAV – Anti-Virus\nDH –Data Historian\nDMZ – DeMilitarised Zone\nDNS – Domain Name Service\nDoS – Denial of Service\nDPI – Deep Packet Inspection\nEN – Enterprise Network\nESD – Emergency Shutdown System\nFERC – Federal Energy Regulatory Commission\nFTP – File Transfer Protocol\nGAIT – Group for Advanced Information Technology\nHMI – Human Machine Interface\nHTTP – Hyper-Text Transfer Protocol\nIAONA – Industrial Automation Open Networking Association\nIDS – Intrusion Detection Systems\nIEC – International Electrotechnical Commission\nIEEE – Institute of Electrical and Electronics Engineers\nIGMP – Internet Group Management Protocol\nIP – Internet Protocol\nIPsec – Internet Protocol Security\nISA – Instrumentation, Systems and Automation Society\nISO – International Organization for Standardization\nIT – Information Technology\nLAN – Local Area Network\nMES – Manufacturing Execution System\nNAT – Network Address Translation\nNBAR – Network-Based Application Recognition\nNIC – Network Interface Card\nNISCC – National Infrastructure Security Coordination Centre\nOPC – OLE for Process Control\nOS – Operating System\nPC – Personal Computer\nPCN – Process Control Network\nPIN – Process Information Network\nPLC – Programmable Logic Controllers\n\n\n-----\n\nQoS – Quality of Service\nRFC – Request For Comment\nRPC – Remote Procedure Call\nRTU – Remote Terminal Unit\nSCADA – Supervisory Control and Data Acquisition\nSOAP – Simple Object Access Protocol\nSQL – Structured Query Language\nSMTP – Simple Mail Transfer Protocol\nSNMP – Simple Network Management Protocol\nSSL – Secure Sockets Layer\nTCP – Transmission Control Protocol\nTFTP – Trivial File Transfer Protocol\nUDP – User Datagram Protocol\nVLAN – Virtual Local Area Network\nVPN - Virtual Private Network\nWLAN – Wireless Local Area Network\nXML – Extended Markup Language\n\n\n-----\n\n## References\n\n1 Smith, T.; “Hacker jailed for revenge sewage attacks,” The Register, October 31, 2001,\nhttp://www.theregister.co.uk/content/4/22579.html\n\n2 \"SQL Slammer Worm Lessons Learned For Consideration By The Electricity Sector\", North\n_American Electric Reliability Council, Princeton NJ, June 20, 2003_\n\n3 \"NRC Information Notice 2003-14: Potential Vulnerability of Plant Computer Network to\nWorm Infection\", United States Nuclear Regulatory Commission, Washington, DC, August 29,\n2003\n\n4 E. Byres, J. Carter, A. Elramly and D. Hoffman; “Worlds in Collision: Ethernet on the Plant\nFloor”, ISA Emerging Technologies Conference, Instrumentation Systems and Automation\n_Society, Chicago, October 2002_\n\n5 E.J. Byres and D. Hoffman; “IT Security and the Plant Floor”, InTech Magazine,\n_Instrumentation Systems and Automation Society, Research Triangle Park, NC, p. 76, December_\n2002\n\n6 The Ten Commandments of Industrial Ethernet, B&B Electronics Manufacturing Company,\nMarch 30, 2004\n\n7 Technical Report ISA-TR99.00.01-2004: Security Technologies for Manufacturing and Control\nSystems, Instrumentation, Systems and Automation Society (ISA), March 2004\n\n8 ibid - Technical Report ISA-TR99.00.01-2004\n\n9 B. Fraser, “RCF 2196 - Site Security Handbook”, Internet Engineering Task Force, September\n1997, Pg. 22\n\n10 ibid - Technical Report ISA-TR99.00.01-2004\n\n11 “API Standard 1164 – SCADA Security (Draft) – Appendix B”, American Petroleum Institute,\nMarch 2004\n\n12 http://udell.roninhouse.com/bytecols/1999-10-13.html\n\n13 E.J. Byres; “Designing Secure Networks for Process Control”, IEEE Industry Applications\nMagazine, Institute of Electrical and Electronics Engineers, New York, Vol. 6, No. 5 p. 33 -39,\nSeptember/October 2000\n\n14 “Process Control Network Reference Architecture v 1.0”, Invensys Inc., January 2004, pg. 2, 5\n\n15 “Experion PKS Network and Security Planning Guide EP-DSX173, Release 210”, Honeywell\nLimited Australia, October 2004\n\n16 “Presentation: Securing SIMATIC PCS7 and SIMATIC IT in Networks”, Siemens, 2003\n\n17 IEC/SC 65C/WG 13 Draft v1.04 “Enterprise Network – Control Network Interconnection\nProfile (ECI)”, International Electrotechnical Commission, December 2004\n\n18 B. Fraser, “RCF 2196 - Site Security Handbook”, Internet Engineering Task Force, September\n1997, Pg. 21\n\n\n-----\n\n19 “Technical Report ISA-TR99.00.02-2004: Integrating Electronic Security into the\nManufacturing and Control Systems Environment”, Instrumentation, Systems and Automation\n_Society (ISA), April 2004, Page 79_\n\n20 Process Control Digital Security Practice: Firewall Practice Release 1.0, (Name withheld on\nrequest), 2003.\n\n21 “API Standard 1164 – SCADA Security (Draft)”, American Petroleum Institute, March 2004,\nPage 20\n\n22 ibid - IEC/SC 65C/WG 13 Draft v1.04, Page 11\n\n23“The IAONA Handbook for Network Security - Draft/RFC v0.4”, Industrial Automation Open\n_Networking Association (IAONA), Magdeburg, Germany, 2003_\n\n24 ibid, “Technical Report ISA-TR99.00.02-2004” Page 77\n\n25 Avishai Wool, \"A quantitative study of firewall configuration errors\" IEEE Computer\nMagazine, IEEE Computer Society, June 2004, Pages 62-67\n\n26 IEEE Standard 7-4.3.2, \"IEEE Standard for Digital Computers in Safety Systems of Nuclear\nPower Generating Stations.\", Institute of Electrical and Electronic Engineers\n\n22 John C. Netzel, Network Security Across Wide Area Networks & the Internet, IndComm 2003,\nMelbourne Australia, May 2003.\n\n23 Technical Architecture Whitepaper Network Zone Model v1.2E, The Dow Chemical\nCompany, 2004.\n\n24 Process Network Security: Firewall Configuration and Policies, Invensys Inc., 2004.\n\n25 Montgomery Watson Harza, “Security for SCADA IP Networks”, 2003.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.energy.gov/sites/prod/files/Good%20Practices%20Guide%20for%20Firewall%20Deployment.pdf"
    ],
    "report_names": [
        "Good%20Practices%20Guide%20for%20Firewall%20Deployment.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1109146583,
    "ts_modification_date": 1296239289,
    "files": {
        "pdf": "https://archive.orkl.eu/9de5b1f2a84704eda69d8c5e1ce5ca7ebb554f32.pdf",
        "text": "https://archive.orkl.eu/9de5b1f2a84704eda69d8c5e1ce5ca7ebb554f32.txt",
        "img": "https://archive.orkl.eu/9de5b1f2a84704eda69d8c5e1ce5ca7ebb554f32.jpg"
    }
}