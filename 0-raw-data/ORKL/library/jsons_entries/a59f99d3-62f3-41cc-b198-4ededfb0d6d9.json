{
    "id": "a59f99d3-62f3-41cc-b198-4ededfb0d6d9",
    "created_at": "2023-01-12T15:03:36.201073Z",
    "updated_at": "2025-03-27T02:05:18.423454Z",
    "deleted_at": null,
    "sha1_hash": "61534d079802a54e9e2d6f2a8830523825403b99",
    "title": "2022-03-01 - Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware",
    "authors": "",
    "file_creation_date": "2022-05-27T23:12:05Z",
    "file_modification_date": "2022-05-27T23:12:05Z",
    "file_size": 770774,
    "plain_text": "# Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware\n\n**blog.qualys.com/vulnerabilities-threat-research/2022/03/01/ukrainian-targets-hit-by-hermeticwiper-new-datawiper-**\nmalware\n\nMayuresh Dani March 1, 2022\n\n_The Ukrainian Government has been targeted by HermeticWiper, a new ransomware-like_\n_data wiper. Its aim is not simply to encrypt the victim’s data, but rather to render a system_\n_essentially unusable. In this blog, our Research Team details our analysis of how this_\n_aggressive new malware works._\n\nThe origin of HermeticWiper seems to be closely connected to the start of the\nRussia/Ukraine conflict. HermeticWiper is a new ransomware-like data wiper that was\ndeployed beginning February 23, 2022. Based on multiple intelligence reports, the wiper\n\n-----\n\nware is preceded by exploits that aid in malware deployment or multiple distributed denial-ofservice attacks to shut down protective services. Attacks have been observed against\nhundreds of Ukrainian websites related to the local government. Discovered mere hours\nbefore Russian troops rolled into Ukraine, the cyberattack is widely seen as the opening\nsalvo of Moscow’s invasion. As of this writing, HermeticWiper activity has since been found\nin Latvia and Lithuania.\n\nThe primary objective of the HermeticWiper is to destroy the master boot record (MBR) of a\nsystem, shredding data and rendering the system unusable.\n\n## Portable Executable Details of HermeticWiper\n\nThe file that we analyzed has a timestamp of “2021-12-28”. This wiper-ware got its name\nbecause the attackers used a code-signing certificate issued to “Hermetica Digital Ltd.” This\ntraces back to a small videogame design business based in Cyprus with no links to Russia\nthat claims it never applied for a digital certificate, pointing to possible identity theft.\nOperating systems use code-signing as an initial check on software, so it may have been\ndesigned to help the rogue program dodge anti-virus protections.\n\nThe sample we analyzed presented the following details:\n\n\n-----\n\nAnother quirk that we noticed from most of the HermeticWiper samples was the use of the\n“gift” icon.\n\nWhether this was a sick joke on the part of the attackers, or merely use of a commonly\nobserved Visual Studio icon – we will never know.\n\n## Technical Details of HermeticWiper\n\nHermeticWiper itself is just 115kbs and comes packed with drivers, which are extracted\n[depending on the operating system. These drivers are compressed in “SZDD” format as can](https://www.cabextract.org.uk/libmspack/doc/szdd_kwaj_format.html)\nbe seen here:\n\n\n-----\n\nAs the names suggest, drivers are dropped after meeting the operating system criteria:\n\n1. DRV_X64: Windows 7+ 64-bits\n2. DRV_X86: Windows 7+ 32-bits\n3. DRV_XP_X64: Windows XP 64-bits\n4. DRV_XP_X32: Windows XP 32-bits\n\nInterestingly, the sample that we analyzed made use of an expired certificate from the\n“CHENGDU YIWO Tech Development Co. Ltd.” A basic Google search reveals that this is a\nprofessional data recovery and data security company based in Sichuan, China. This\ncertificate appears to be legitimate.\n\n\n-----\n\nOther researchers have found similar drivers from EaseUS Partition Manager. A search for\nthat company name comes up with more details on the Chengdu YIWO Tech and EaseUS\nrelationship:\n\n\n-----\n\nThis driver does the heavy lifting of causing harm to your system. This is a known technique\nand has been used a couple of times by well-known Advanced Persistent Threat groups.\n\n## DETECTION TIP #1\n\nWatch out for processes executing drivers or dynamic link libraries with expired certificates.\n\nPost execution, HermeticWiper gains the following privileges:\n\n1. SeBackupPrivilege\n2. SeDebugPrivilege\n3. SeLoadDriverPrivilege\n\nLater in the execution chain, the SeLoadDriverPrivilege is used to load the extracted driver.\nThen one of the four drivers is dropped, after which the Volume Shadow Copy (VSS) service\n– which allows backups to be performed – is stopped.\n\n## DETECTION TIP #2\n\n1. Watch out for processes gaining unnecessary and sensitive privileges like the ones\n\nmentioned above.\n2. Watch out for important Windows service stoppages.\n\nHermeticWiper then changes the CrashDumpEnabled registry key value to 0, under the\nSystem\\CurrentControlSet\\Control\\CrashControl registry setting, so that memory dumps are\ndisabled.\n\n\n-----\n\n## DETECTION TIP #3\n\nWatch out for unauthorized processes making registry changes.\n\n[After this registry change, ShowCompColor and](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/3c837e92-016e-4148-86e5-b4f0381a757f) [ShowInfoTip keys are also modified to](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/3c837e92-016e-4148-86e5-b4f0381a757f)\ndisable the display of compressed and encrypted NTFS files in color. This setting allows you\nto see compressed files in a blue color. For example:\n\n[Qualys Multi-Vector EDR customers are presented with the following details capturing the](https://www.qualys.com/apps/endpoint-detection-response/)\nbehavior.\n\nThen, hard drives on a system are enumerated and for each drive, the \\\\.\\EPMNTDRV\\\ndevice is called. Then the driver that was extracted is loaded by creating a new service using\nthe CreateServiceW which rewrites the first 512 bytes of the Master Boot Record (MBR).\n\nThe code further suggests that HermeticWiper enumerates the following files and folders…\n\nAppData\n\n\n-----\n\nDesktop\nProgramFiles\nProgramFiles(x86)\nPerflogs\nC:\\Documents and Settings\nC:\\Windows\\System32\\winevt\\logs\nSystem Volume Information\n\n…the following Master File Table metafiles…\n\n$LogFile: Journal to record metadata transactions.\n$Bitmap: Records allocation status of each cluster in the file system.\n$Attribute_List:\n\n…and the following NTFS streams:\n\n$DATA – Contains file data.\n$I30 – NTFS index attribute\n$INDEX_ALLOCATION: Stream type of a directory.\n\n## DETECTION TIP #4\n\nWatch out for processes enumerating multiple locations and data streams.\n\nPost successful execution, HermeticWiper makes use of the InitiateSystemShutdownEx API\nto shut down the system. Once rebooted, since the MBR has been rewritten, we see a blank\nscreen with the words “Missing operating system.”\n\n## HermeticWiper Detection with Qualys Multi-Vector EDR\n\nOut of the box, Qualys Multi-Vector EDR provides detection and prevention capabilities that\ncan help enterprise security teams to find Indicators of Compromise.\n\n\n-----\n\n**HermeticWiper MITRE ATT&CK TID Map**\n\n**Tactic** **TID** **Technique** **Procedure**\n\n\nPrivilege\nEscalation\n\n\nT1134 Access Token\nManipulation\n\n\nHermeticWiper modifies its security token\nto grants itself debugging privileges by\nadding SeDebugPrivilege, creating\nbackups by adding SeBackupPrivilege and\nload drivers by adding\nSeLoadDriverPrivilege.\n\nHermeticWiper enumerates the operating\nsystem and its bit-size according to which\nembedded drivers are dropped\n\n\nDiscovery T1082 System\nInformation\nDiscovery\n\n\nDefense\nEvasion\n\n\nT1112 Modify Registry HermeticWiper modifies multiple keys\n\n\nExecution T1106 Native API HermeticWiper uses the\nAdjustTokenPrivileges to give itself the\nfollowing privileges: SeShutdownPrivilege,\nSeBackupPrivilege and\nSeLoadDriverPrivilege.\n\n\nPersistence T1543.003 Create or Modify\nSystem Process:\nWindows Service\n\nImpact T1561.002 Disk Wipe: Disk\nStructure Wipe\n\nImpact T1490 Inhibit System\nRecovery\n\n\nHermeticWiper loads the extracted driver,\nby creating a new service using the\nCreateServiceW API.\n\nHermeticWiper damages the Master Boot\nRecord (MBR) of the infected computer.\n\nHermeticWiper stops the Volume Shadow\nCopy service.\n\n\n-----\n\n**Tactic** **TID** **Technique** **Procedure**\n\nImpact T1489 Service Stop HermeticWiper stops the Volume Shadow\nCopy service.\n\n\nDiscovery T1083 File and Directory\nDiscovery\n\nImpact T1529 System\nShutdown/Reboot\n\n**HermeticWiper IOCs**\n\n**SHA256**\n\n\nHermeticWiper enumerates multiple files\nand folders such as AppData, Desktop,\netc.\n\nHermeticWiper initiates a system\nshutdown via the\nInitiateSystemShutdownEx API.\n\n\n0385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21da\n\n06086c1da4590dcc7f1e10a6be3431e1166286a9e7761f2de9de79d7fda9c397\n\n095c7fa99dbc1ed7a3422a52cc61044ae4a25f7f5e998cc53de623f49da5da43\n\n0db5e5b68dc4b8089197de9c1e345056f45c006b7b487f7d8d57b49ae385bad0\n\n1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591\n\n2c10b2ec0b995b88c27d141d6f7b14d6b8177c52818687e4ff8e6ecf53adf5bf\n\n34ca75a8c190f20b8a7596afeb255f2228cb2467bd210b2637965b61ac7ea907\n\n3c557727953a8f6b4788984464fb77741b821991acbf5e746aebdd02615b1767\n\n4dc13bb83a16d4ff9865a51b3e4d24112327c526c1392e14d56f20d6f4eaf382\n\n7e154d5be14560b8b2c16969effdb8417559758711b05615513d1c84e56be076\n\n923eb77b3c9e11d6c56052318c119c1a22d11ab71675e6b95d05eeb73d1accd6\n\n9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d\n\na196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92\n\nb01e0c6ac0b8bcde145ab7b68cf246deea9402fa7ea3aede7105f7051fe240c1\n\nb60c0c04badc8c5defab653c581d57505b3455817b57ee70af74311fa0b65e22\n\nb6f2e008967c5527337448d768f2332d14b92de22a1279fd4d91000bb3d4a0fd\n\nc2d06ad0211c24f36978fe34d25b0018ffc0f22b0c74fd1f915c608bf2cfad15\n\n\n-----\n\n**SHA256**\n\nd4e97a18be820a1a3af639c9bca21c5f85a3f49a37275b37fd012faeffcb7c4a\n\ndcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78\n\ne5f3ef69a534260e899a36cec459440dc572388defd8f1d98760d31c700f42d5\n\nf50ee030224bf617ba71d88422c25d7e489571bc1aba9e65dc122a45122c9321\n\nfd7eacc2f87aceac865b0aa97a50503d44b799f27737e009f91f3c281233c17d\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-01 - Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware.pdf"
    ],
    "report_names": [
        "2022-03-01 - Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535816,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653693125,
    "ts_modification_date": 1653693125,
    "files": {
        "pdf": "https://archive.orkl.eu/61534d079802a54e9e2d6f2a8830523825403b99.pdf",
        "text": "https://archive.orkl.eu/61534d079802a54e9e2d6f2a8830523825403b99.txt",
        "img": "https://archive.orkl.eu/61534d079802a54e9e2d6f2a8830523825403b99.jpg"
    }
}