{
    "id": "258d832e-c5c7-44e0-89bf-aa06786811cd",
    "created_at": "2023-01-12T15:10:21.540261Z",
    "updated_at": "2025-03-27T02:09:18.739683Z",
    "deleted_at": null,
    "sha1_hash": "ad2948ba89f2ce92b6d59b7f02c282e9e86df16c",
    "title": "2022-07-24 - QBot phishing uses Windows Calculator sideloading to infect devices",
    "authors": "",
    "file_creation_date": "2022-08-18T03:44:34Z",
    "file_modification_date": "2022-08-18T03:44:34Z",
    "file_size": 1091389,
    "plain_text": "# QBot phishing uses Windows Calculator DLL hijacking to infect devices\n\n**[bleepingcomputer.com/news/security/qbot-phishing-uses-windows-calculator-sideloading-to-infect-devices/](https://www.bleepingcomputer.com/news/security/qbot-phishing-uses-windows-calculator-sideloading-to-infect-devices/)**\n\nBill Toulas\n\nBy\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nJuly 24, 2022\n11:18 AM\n0\n\nThe operators of the QBot malware have been using a DLL hijacking flaw in Windows\nCalculator to infect computers, which also helps evade detection by security software.\n\nDLL hijacking is a common attack method that takes advantage of how Dynamic Link\nLibraries (DLLs) are handled in Windows. It consists of creating a malicious version of a\nlegitimate DLL required by the program, and placing it early in the search order used to find a\nrequired DLL. This folder is commonly the same folder as the executable.\n\nWhen the executable is launched, it will find the malicious version with the same name in the\nsame folder, loading that instead and infecting the computer.\n\n\n-----\n\nQBot, also known as Qakbot is a Windows malware strain that started as a banking trojan\nbut evolved into a malware dropper, and is used by [ransomware gangs in the early stages of](https://www.bleepingcomputer.com/news/security/qbot-now-pushes-black-basta-ransomware-in-bot-powered-attacks/)\nthe attack to drop Cobalt Strike beacons.\n\n[Security researcher ProxyLife recently discovered that Qakbot, has been abusing the the](http://twitter.com/pr0xylife)\nWindows 7 Calculator app for DLL hijacking attacks since at least July 11. The method\ncontinues to be used in malspam campaigns.\n\n[#Qakbot - obama200 - html > .zip > .iso > .lnk > calc.exe > .dll > .dll](https://twitter.com/hashtag/Qakbot?src=hash&ref_src=twsrc%5Etfw)\n\nT1574 - DLL Search Order Hijacking\n\ncmd.exe /q /c calc.exe\n\nregsvr32 /s C:\\Users\\User\\AppData\\Local\\Temp\\WindowsCodecs.dll\n\n[regsvr32.exe 102755.dllhttps://t.co/2Vgg6cuRFh](https://t.co/2Vgg6cuRFh)\n\n[IOC'shttps://t.co/e7hkNW8eQu](https://t.co/e7hkNW8eQu) [pic.twitter.com/sCH1xagkyR](https://t.co/sCH1xagkyR)\n\n[â€” proxylife (@pr0xylife) July 11, 2022](https://twitter.com/pr0xylife/status/1546607135089430532?ref_src=twsrc%5Etfw)\n\n## New QBot infection chain\n\nTo help defenders protect against this threat, ProxyLife and researchers at\n[Cyble documented the latest QBot infection chain.](https://blog.cyble.com/2022/07/21/qakbot-resurfaces-with-new-playbook/)\n\nThe emails used in the latest campaign carry an HTML file attachment that downloads a\npassword-protected ZIP archive with an ISO file inside.\n\nThe password for opening the ZIP file is shown in the HTML file, and the reason for locking\nthe archive is to evade antivirus detection.\n\n\n-----\n\n**HTML attachment on QBot spam emails**\nThe ISO contains a .LNK file, a copy of 'calc.exe' (Windows Calculator), and two DLL files,\nnamely WindowsCodecs.dll and a payload named 7533.dll.\n\n**ZIP archive contents**\nWhen the user mounts the ISO file, it only displays the .LNK file, which is masqueraded to\nlook like a PDF holding important information or a file that opens with Microsoft Edge\nbrowser.\n\nHowever, the shortcut points to the Calculator app in Windows, as seen in the properties\ndialog for the files.\n\n\n-----\n\n**Properties of the PDF file that triggers the infection**\nClicking the shortcut triggers the infection by executing the Calc.exe through the Command\nPrompt.\n\nWhen loaded, the Windows 7 Calculator automatically searches for and attempts to load the\nlegitimate WindowsCodecs DLL file. However, it does not check for the DLL in certain hard\ncoded paths, and will load any DLL with the same name if placed in the same folder as the\nCalc.exe executable.\n\nThe threat actors take advantage of this flaw by creating their own malicious\nWindowsCodecs.dll file that launches the other [numbered].dll file, which is the QBot\nmalware.\n\nBy installing QBot through a trusted program like the Windows Calculator, some security\nsoftware may not detect the malware when it is loaded, allowing the threat actors to evade\ndetection.\n\nIt should be noted, that this DLL hijacking flaw no longer works in Windows 10 Calc.exe and\nlater, which is why the threat actors bundle the Windows 7 version.\n\nQBot has been around for more than a decade, with origins going as far back as 2009\n\n[[1,](https://www.symantec.com/security-center/writeup/2009-050707-0639-99?tabid=3) [2,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32%2FQakbot) [3,](http://contagiodump.blogspot.com/2010/11/template.html) [4]. While campaigns delivering it are not frequent, it was observed being distributed](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/80/qakbot-a-prevalent-infostealing-malware)\nby Emotet botnet in the past to drop ransomware payloads.\n\n\n-----\n\n[Among the ransomware families that QBot delivered are RansomExx, Maze, ProLock,](https://www.bleepingcomputer.com/news/security/prolock-ransomware-teams-up-with-qakbot-trojan-for-network-access/)\n[and Egregor. More recently, the malware dropped Black Basta ransomware.](https://www.bleepingcomputer.com/news/security/qbot-partners-with-egregor-ransomware-in-bot-fueled-attacks/)\n\n### Related Articles:\n\n[Microsoft finds Raspberry Robin worm in hundreds of Windows networks](https://www.bleepingcomputer.com/news/security/microsoft-finds-raspberry-robin-worm-in-hundreds-of-windows-networks/)\n\n[Malicious Windows 'LNK' attacks made easy with new Quantum builder](https://www.bleepingcomputer.com/news/security/malicious-windows-lnk-attacks-made-easy-with-new-quantum-builder/)\n\n[Malicious PyPi packages turn Discord into password-stealing malware](https://www.bleepingcomputer.com/news/security/malicious-pypi-packages-turn-discord-into-password-stealing-malware/)\n\n[New Windows PowerToys OCR tool will let you copy text from images](https://www.bleepingcomputer.com/news/microsoft/new-windows-powertoys-ocr-tool-will-let-you-copy-text-from-images/)\n\n[Malware devs already bypassed Android 13's new security feature](https://www.bleepingcomputer.com/news/security/malware-devs-already-bypassed-android-13s-new-security-feature/)\n\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nBill Toulas is a technology writer and infosec news reporter with over a decade of experience\nworking on various online publications. An open source advocate and Linux enthusiast, is\ncurrently finding pleasure in following hacks, malware campaigns, and data breach incidents,\nas well as by exploring the intricate ways through which tech is swiftly transforming our lives.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-24 - QBot phishing uses Windows Calculator sideloading to infect devices.pdf"
    ],
    "report_names": [
        "2022-07-24 - QBot phishing uses Windows Calculator sideloading to infect devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536221,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1660794274,
    "ts_modification_date": 1660794274,
    "files": {
        "pdf": "https://archive.orkl.eu/ad2948ba89f2ce92b6d59b7f02c282e9e86df16c.pdf",
        "text": "https://archive.orkl.eu/ad2948ba89f2ce92b6d59b7f02c282e9e86df16c.txt",
        "img": "https://archive.orkl.eu/ad2948ba89f2ce92b6d59b7f02c282e9e86df16c.jpg"
    }
}