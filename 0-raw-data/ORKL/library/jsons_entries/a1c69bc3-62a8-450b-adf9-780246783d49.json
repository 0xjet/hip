{
    "id": "a1c69bc3-62a8-450b-adf9-780246783d49",
    "created_at": "2022-10-25T16:48:15.588015Z",
    "updated_at": "2025-03-27T02:16:58.035119Z",
    "deleted_at": null,
    "sha1_hash": "c1b7c2bec86e8edf8bba650c6fa506319198e3c3",
    "title": "Anunak: Apt Against Financial Institutions",
    "authors": "Group-IB, FOX-IT",
    "file_creation_date": "2014-12-19T17:39:52Z",
    "file_modification_date": "2014-12-19T17:39:54Z",
    "file_size": 841144,
    "plain_text": "## G r o u p - I B a n d F o x - I T\n\n# Anunak:\n\n APT against financial\n\n institutions\n\n\n-----\n\n### Disclaimer\n\nHereby Group-IB and Fox-IT inform that:\n\n1. This report was prepared to provide information obtained as a result of Group-IB and\nFox-IT research.\n\n2. Description of threat technical details in this\nReport is given only to bring the appropriate\ninformation to the attention of information security specialists. It helps to prevent information security incidents and to minimize risks\nby creating awareness on the trend described\nin this report. The threat technical details\npublished in this report in any case are not for\nthe promotion of fraud and/or other illegal\nactivities in the financial industry, high tech\nindustry and/or other areas.\n\n3. The information published in this report may\nbe used by interested parties at their discretion\nprovided they make reference to Group-IB and\nFox-IT.\n\n### Executive summary\n\nThis report describes the details and type of operations carried out by an organized criminal group\nthat focuses on financial industry, such as banks and\npayment providers, retail industry and news, media\nand PR companies. The group has its origin in more\ncommon financial fraud including theft from consumer and corporate bank accounts in Europe and\nRussia, using standard banking malware, mainly\nCarberp.\n\nAfter the arrests of Carberp group members in\nRussia, some of the members were out of work,\nhowever, their experience gained from many years\nof crime has allowed them to enter a new niche. One\nof the members quickly realized that they can steal\n$2000 a thousand times, and earn $2 million, but\nalso they can steal it in one time and immediately\nget it with much less effort. The anti-fraud measures\nemployed by banks has pushed the criminals to\nsearch for new ways to make money with less barriers, compromising and modifying or taking data\nfrom banks, payment providers, retail and media/\nPR companies are some of these methods.\n\nFrom 2013 an organized criminal group intensified its activity focused on banks and electronic payment systems in Russia and in the post-Soviet space.\n\n\nThe key is that fraud occurs within the corporate\nnetwork using internal payment gateways and internal banking systems. Thus money is stolen from\nthe banks and payment systems, and not from their\ncustomers. While this is their main and most lucrative activity, the gang has also ventured into other\nareas including the compromise of media groups\nand other organizations for industrial espionage and\nlikely a trading advantage on the stock market. In\ncases where the group got access to the government\nagency networks their aim was espionage related.\n\nThe organized criminal group backbone are\ncitizens of both Russian and Ukrainian origin, but\nthe group also sources a number of mainstream and\nspecialized services from individuals and groups\noriginating from Russia, Ukraine and Belarus.\n\nThe average sum of theft in the Russian territory and in the post-Soviet space is $2 million per\nincident. Since 2013 they have successfully gained\naccess to networks of more than 50 Russian banks\nand 5 payment systems, and 2 of these institutions\nwere deprived of their banking license. To date the\ntotal amount of theft is over 1 billion rubles (about\n25 million dollars), most of it has been stolen in the\nsecond half of 2014.\n\nThe average time from the moment of penetration\ninto the financial institutions internal network till\nsuccessful theft is 42 days.\n\nAs a result of access to internal bank networks\nthe attackers also managed to gain access to ATM\nmanagement infrastructure and infect those systems with their own malicious software that further\nallows theft from the banks ATM systems on the\nattackers command.\n\nSince 2014 the organized criminal group members began actively taking an interest in US and European based retail organizations. While they were\nalready familiar with POS malware and compromising POS terminals, the widespread media attention\naround the Target breach and other related breaches\nwere the reason for this move. While the scale of\nbreaches in this industry is still relatively low, with\nat least 3 successful card breaches and over a dozen\nretailers compromised this activity is quickly becoming a lucrative endeavor for this group.\n\nTo penetrate into the internal networks this\norganized criminal group employs targeted emailing\n(spear phishing) and infections sources from other\nbotnets. This is the main reason why the group is\n\n\n-----\n\nkeeping in touch with owners of large botnets. Since\nAugust 2014 the group began to create their own\nlarge botnet using a mass emailing, but not using\ntypical exploit driveby infections. This last move is\nlikely to reduce the need for external contacts.\n\n### Attacks in Russia\n\nThe first successful bank robbery was committed\nby this group in January 2013. In all first cases the\nattackers used the program RDPdoor for remote\naccess to the bank network and the program “MBR\nEraser” to remove traces and to crack Windows\ncomputers and servers. Both programs were used by\nthe members of the Carberp criminal group under\nthe guidance of a person named Germes. To reduce\nthe risk of losing access to the internal bank network\nthe attackers, in addition to malicious programs,\nwere also used for remote access legitimate programs such as Ammy Admin and Team Viewer. Later the attackers completely abandoned from usage\nof RDPdoor and Team Viewer.\n\nIn addition to banking and payment systems,\nhackers got access to e-mail servers to control all\ninternal communications. This approach allowed\nthem to find out that the anomalous activity in the\nbank network was identified, what technique was\nused to identify this activity and what measures the\nbank employees took to solve the problem. Email\ncontrol was successfully installed regardless of used\nemail system, MS Exchange or Lotus. This approach\nallowed them to take countermeasures that created\nfor bank and payment system employees the feeling\nthat the problem had been solved.\nThe main steps of the attack progression are the\nfollowing ones:\n\n1. Primary infection of an ordinary employee\ncomputer.\n\n2. Getting a password of a user with administrative rights on some computers. For example, a\npassword of a technical support engineer.\n\n3. Gaining legitimate access to one server.\n\n4. Compromising the domain administrator\npassword from the server.\n\n5. Gaining access to the domain controller and\ncompromising of all active domain accounts.\n\n\n6. Gaining access to e-mail and workflow servers.\n\n7. Gaining access to server and banking system\nadministrator workstations.\n\n8. Installing the software to monitor activity of\ninteresting system operators. Usually photo\nand video recording was used.\n\n9. Configuring remote access to servers of interest including firewall configuration changes.\n\n### Tools for attack\n\nTo carry out target attacks in 2014 the hackers\nhave finalized development of their core malware\nAnunak that is used along with the following tools:\n\nProgram Purpose of use\n\nto get passwords from local and\nMimikatz\ndomain accounts\n\nMBR Eraser to crack operating systems\n\nSoftPerfect\nto scan LAN\nNetwork Scanner\n\nCain & Abel to get passwords\n\nto get passwords\nSSHD backdoor\nand remote access\n\nAmmy Admin for remote control\n\nTeam Viewer for remote control\n\nAccording to our laboratory classification the\nmain malware is “Anunak”. This trojan is used for\ntarget attacks only, mainly on banks and payment\nsystems. Target usage of this program allows it to\nremain poorly explored, providing it a good survivability inside corporate networks. The source code of\nthe bank trojan program Carberp was used in some\nplaces of this malware. “Anunak” has the following\nfeature set:\n\n- The software called “Mimikatz” is built in this\nprogram. This is an open source software that allows to obtain passwords of user accounts logged\nin the Windows system. However, this software\nwas considerably changed: while maintaining the\ncapability to get account passwords the functions\nof user interaction and of information output for\nerrors and program execution were eliminated.\nThus, when the malicious program is executed\non the server, it will secretly compromise all the\n\n|Program|Purpose of use|\n|---|---|\n|Mimikatz|to get passwords from local and domain accounts|\n|MBR Eraser|to crack operating systems|\n|SoftPerfect Network Scanner|to scan LAN|\n|Cain & Abel|to get passwords|\n|SSHD backdoor|to get passwords and remote access|\n|Ammy Admin|for remote control|\n|Team Viewer|for remote control|\n\n\n-----\n\ndomain and local accounts, including administrator accounts. To get account passwords it is\nsufficient to enter two commands in succession:\n“privilege::debug” and “sekurlsa::logonpasswords”. When this program is executed on a\ndomain controller or an e-mail server it compromises virtually all the domain accounts, including administrators.\n\n- There is also the possibility to add a file into the\nfirewall exclusion list by creating the corresponding rule with the utility “Netsh”.\n\n- The functions of keypress grabber as well as the\nfunction of screenshot creation are implemented\nin the program.\n\n- There are also the functions to interact with the\nbank system iFOBS.\n\n- The malware sends key information, screenshots\nand CAB-archives to its management server.\n\n- The program is able to secretly make changes to\na number of system files, presumably to remove\nthe limitations of Microsoft Windows desktop\noperating systems on the number of users that\nmay simultaneously connect to the corresponding PC using RDP to administer it remotely.\n\nThere is the ability to download arbitrary executable files from the management server and run\nthem. One of these files is the program “AmmyAdmin” that may be run with the arguments “-service”\nand “-nogui” that force it to start as a service without\nuser interface. “AmmyAdmin” allows to connect\nwith another computer that has the same software\nthrough the server “rl.ammyy.com” using the IP\naddress and the unique identifier. As a result, the\n\n\nattacker gets remote access to the user computer\nwith the running program “AmmyAdmin” bypassing\nfirewalls. The window screenshot is shown in the\nfigure below:\n\nWhen the attackers gain access to servers running\noperating systems of the Linux family they use SSH\nbackdoor that transmits to the malicious server the\nlogin/password data used to access the servers and\nprovides attackers remote access to the servers.\nTo provide access to the server of interest the attackers may appropriately modify rules for firewalls\nMicrosoft TMG, CISCO, etc.\nWhen the attackers yet had no major malware\nthat would secretly install the program “AmmyAdmin” and report to the attackers a remote access\npassword, they used a malicious program known\nas “Barus”. This malware is used rarely and the last\ntime we met it in 2013. This malicious program is\ndeveloped by Russian-speaking authors. In the\ncontrol panel you can notice a field “Ammy ID”, its\nusage allowed the attackers to connect remotely.\n\n\n-----\n\n### Methods of malware distribution\n\nAt the very beginning of their activity in 2013 due\nto lack of the target Trojan the attackers began to\ndistribute Andromeda and Pony. They distributed\nthese malware using Driveby through a bunch of\nNeutrino Exploit Kit exploits as shown in the figure\nbelow. It is interesting that in the autumn 2013 they\nused the site http://php.net/ as traffic source to\nMagnitude EK. They redirected the traffic from this\nresource since July 2013, but this fact was discovered much later. The name of one of the streams to\ndistribute the malware is “LOL BANK FUCKIUNG”\nthat corresponded to the attacker activities.\n\nParallel to this technique they also use another\ninfection method, which was one of the principal\nmethods. The main method of distribution is sending emails with malicious attachments on behalf of\nthe Central Bank of the Russian Federation, a potential client or an real counterparty (at first the attackers had cracked this counterparty account, then they\nused emailing with the cracked contact list).\n\nAnother used method is to install a special\nmalware to carry out targeted attacks via another\nmalware that might appear in the local network\nby accident. To find such malicious programs the\ncriminal group keeps in touch with several owners of\nlarge botnets that massively distributes their mal\n\nware. The attackers buy from these botnet owners\nthe information about IP-addresses of computers\nwhere the botnet owners have installed malware and\nthen check whether the IP-address belongs to the\nfinancial and government institutions. If the malware is in the subnet of interest, the attackers pay\nthe large botnet owner for installation of their target\nmalware. Such partner relations were established\nwith owners of botnets Zeus, Shiz Ranbyus. All of\nthese trojans are bank Trojans, their usage is explained by the previously established relationships.\nIn late 2013 the hacker under the alias Dinhold began to build his own botnet using modified Carberp,\nhaving uploaded its source code for public access.\nThe attackers were trying to create similar relations\nwith this hacker, but in 2014 he was arrested, having\nnot developed his botnet up to the required level.\n\nTo check whether the IP-address belongs to the\ndesired network the following script is used:\n\n#!/usr/bin/python\n# -*- coding: utf-8 -*import os\nfrom bulkwhois.shadowserver import BulkWhoisShadowserver\niplist_file = ‘ip.txt’\npath = os.path.dirname(os.path.abspath(__file__))\nbulk_whois = BulkWhoisShadowserver()\niplist = []\nwith open(os.path.join(path, iplist_file)) as f:\nfor line in f:\n\n\n-----\n\niplist.append(line.strip())\nresult = bulk_whois.lookup_ips(iplist)\nwith open(os.path.join(path, ‘data.\ntxt’), ‘a’) as f:\nfor record in result:\nf.write(‘IP: %s\\\nCC: %s\\\nOrg. Name: %s\\\nRegister: %s\\\nAS Name: %s\\\nBGP Prefix: %s\\\n----------------------------------------\\\n‘ % (result[record][‘ip’], result[record][‘cc’], result[record][‘org_\nname’], result[record][‘register’],\nresult[record][‘as_name’], result[record][‘bgp_prefix’]))\n\nThe most dangerous emailings\nare those that are sent on behalf\nof partners with whom financial\nand government institutions\ncommunicates permanently\nby email. An example of such\nemailing occurred on September 25, 2014, at 14:11, from the\ne-mail address “Elina Shchekina\n<e.shekina@rbkmoney.com>”\nwith the subject “Updated agreement version”. The attachment\n“agreement.doc” exploits the vulnerability CVE-2012-2539 and\nCVE-2012-0158. The emailing\n\n\n-----\n\nwas conducted for more than\n70 addresses of various companies (where multiple recipient\naddresses may be within one\ncompany).\n\nThe letter with malicious\nattachment (md5: AA36BA9F4DE5892F1DD427B7B2100B06)\nin the archive with a password\nfrom a potential client was sent\nto a bank manager after a preliminary telephone conversation\nwith him. The call origin is Saint\nPetersburg.\n\nContents of a text file named\n“реквизиты.doc” (partner detais.doc)\n\n“Company Our Century”, Ltd.\n109387, Russia, Moscow,\nAnosov str., 24, office 409\nTel. (495) 124-99-77 Fax:\n(495)124-99-77\nMobile (962) 7135296\nE-mail: x60x@nxt. ru\nINN 7329001307 KPP 732901001\nAccount 40702810613310001709\nBranch of VTB 24 (JSC), Moscow\nCorrespondent account\n30101810700000000955\nBIC 043602955\n\nA letter on behalf of the\nCentral Bank of Russia with\na malicious attachment\n(md5: 8FA296EFAF87FF4D9179283D42372C52) exploited\nthe vulnerability CVE-20122539 in order to execute arbitrary code.\n\nThere were also other examples of emails with malicious\nattachments, such as emailing\nwith the file “001. photo.exe”.\n\nA more detailed list of such\nattachments you can see in the\nTable “Email attachments”.\n\n\n-----\n\n### ATM attacks\n\nAvailability of access to bank internal networks\nopens great opportunities for the hackers. One of\nthese opportunities is access to ATMs from special network segments that had to be isolated. It is\nconfirmed that this criminal group gained access to\n52 ATMs. The amount of damage exceeds 50 million\nrubles. As a result of access to ATMs, depending on\nthe ATM model, hackers used different patterns.\n\nсhange\ndenomination of\nwithdrawal\n\nbanknotes\n\nHaving access, the attackers downloaded malicious scripts and changed denominations of issued\nbanknotes in the ATM operating system registry. As\na result, for query to get 10 notes with denomination\nof 100 roubles the attackers received 10 banknotes\nwith denomination of 5,000 roubles. The used\nmalicious script and program were developed for the\nplatform Wincor.\n\n**The malicious script contains the following**\n**commands:**\n\n\nContents of the file “1.bat”\n\n\nREG ADD “HKEY_LOCAL_MACHINE\\SOFTWARE\\\nWincor Nixdorf\\ProTopas\\CurrentVersion\\LYNXPAR\\CASH_DISPENSER” /v VALUE_1 /t REG_SZ\n/d “5000” /f\nREG ADD “HKEY_LOCAL_MACHINE\\SOFTWARE\\\nWincor Nixdorf\\ProTopas\\CurrentVersion\\LYNXPAR\\CASH_DISPENSER” /v VALUE_2 /t REG_SZ\n/d “1000” /f\nREG ADD “HKEY_LOCAL_MACHINE\\SOFTWARE\\\nWincor Nixdorf\\ProTopas\\CurrentVersion\\LYNXPAR\\CASH_DISPENSER” /v VALUE_3 /t REG_SZ\n/d “500” /f\nREG ADD “HKEY_LOCAL_MACHINE\\SOFTWARE\\\nWincor Nixdorf\\ProTopas\\CurrentVersion\\LYNXPAR\\CASH_DISPENSER” /v VALUE_4 /t REG_SZ\n/d “100” /f\n\nREG ADD “HKEY_LOCAL_MACHINE\\SOFTWARE\\\nWincor Nixdorf\\ProTopas\\CurrentVersion\\LYNXPAR\\CASH_DISPENSER” /v VALUE_1 /t REG_SZ\n/d “100” /f\nREG ADD “HKEY_LOCAL_MACHINE\\SOFTWARE\\\nWincor Nixdorf\\ProTopas\\CurrentVersion\\LYNXPAR\\CASH_DISPENSER” /v VALUE_4 /t REG_SZ\n/d “5000” /f\n\nshutdown -r -t 0 –f\n\n\nFigure. Service program KDIAG32 for Wincor ATMs\n\n\n-----\n\nFigure. Hidden window in the original program KDIAG32\n\n\nExecution of this file changed registry keys in\nthe registry branch ““HKEY_LOCAL_MACHINE\\\nSOFTWARE\\Wincor Nixdorf\\ProTopas\\CurrentVersion\\LYNXPAR\\CASH_DISPENSER”” that are\nresponsible for cassette denominations in an ATM.\nAs a result of this file execution the registry key that\nis in charge of the cassette number 1 (VALUE_1) is\ntakes the value “100”, and the registry key responsible for the cassette number 4 (VALUE_4) is set to\n“5000”. Then the command to restart the computer\nis issued. The registry key reference values:\n\nRegistry key name Value\n\nVALUE_1 5000\n\nVALUE_2 1000\n\nVALUE_3 500\n\nVALUE_4 100\n\nIf the ATM actual load corresponds to the reference one and registry keys have been changed, then\nthe banknotes from the cassette No.1 will be issued\nwith denomination “5000” instead of “100”.\n\nwithdrawal of all cash\nfrom dispenser\n\nIn addition, the attackers used a modified debug\n\n\nprogram that allows by the command to issue money from the dispenser. The original debug program\nissues money through the dispenser only when the\nopen ATM housing and the vault door are fixed.\n\nIn order to ensure money issuance from the\nclosed ATM the attackers had to modify the\noriginal program “KDIAG32” (the original file:\nsize of 1,128,960 MD5 4CC1A6E049942EBDA395244C74179EFF).\n\nFile Name Size, bytes MD5 hash\n\nA0064575. 49C708AAD19596CC\n1 128 960\nexe A380FD02AB036EB2\n\nA comparison of the original version of the program with the modified version showed that the only\ndifference is in ignoring error ““Door not opened or\nmissing!””. The figure below shows an error message\nthat will be never displayed to the user in the file\nunder investigation.\n\n### Andromeda usage\n\nAll traces found during investigation of one incident\nshowed that the same criminal group had worked.\nAmmy Admin was used for remote access, the same\n\n|File Name|Size, bytes|MD5 hash|\n|---|---|---|\n|A0064575. exe|1 128 960|49C708AAD19596CC A380FD02AB036EB2|\n\n|Registry key name|Value|\n|---|---|\n|VALUE_1|5000|\n|VALUE_2|1000|\n|VALUE_3|500|\n|VALUE_4|100|\n\n\n-----\n\nSSHD backdoor was installed\non Unix servers and, In addition, it was loaded from the\nsame hacked server as in other\ncases of trojan Anunak usage.\nHowever, in this case Andromeda is used as the main trojan\ninstead of Anunak. The management servers were located\nin Kazakhstan, Germany and\nUkraine. Check of the management servers showed that it was\nthe hosting Bulletproof that, in\naddition to servers, provides\na service of traffic proxying\nthrough its infrastructure as\nwell as TOR and VPN usage,\nso this pattern is significantly\ndiffers from the Anunak hosting patern. Check of money cashout showed\nthat the same cashout criminal group had worked\nas for Anunak and this fact again confirmed their\ncooperation.\n\nObtained Andromeda trojan copies were being\ndistributed from August 2014 by e-mail. The value\n754037e7be8f61cbb1b85ab46c7da77d, which is the\nMD5 hash of the string “go fuck yourself”, was used\nas the RC4 encryption key. As a result of this distribution from August to late October the Andromeda\nbotnet rose up to 260,000 bots. Successful infection\nin one subnet resulted in sending such letters to\nother bank employees. Example of forwarding from\nan infected bank network to employees of another\nbank is shown below.\n\nAs a result of this radial mailing many oil and gas\ncompanies, banks and government agencies were infected. In Russia at least 15 banks and two payment\nsystems were infected this way.\n\nLetters with similar attachments were being distributed with the following subjects:\n\n“My new photo”\n\n“Alert Transactions Report by users from 201409-28 to 2014-09-28”\n\n### Cashout schemas\n\nPreviously, it should be noted the fact that the\nprocess of stolen money withdrawal (cashout) was\ndiffered, firstly by the theft method, secondly by the\n\n\nvictim type (a bank or a payment system), thirdly by\nthe total stolen sum.\n\nThe victims by their type were divided rather by\ncounterparty types and by limitations imposed by\noperation with the counterparties. For example, all\npayments were required to go through a certain pool\nof mediators. In addition, the “improper” pool of\ncounterparties could cause suspicion and unnecessary testing (manual processing of payment orders).\n\nBank (amounts up to 100 million roubles):\n\n- When the attackers had obtained control of a\nbank operator workstation (attacker purpose),\nthey in general used a classic tree scheme when\nfunds from the bank account were sent to several\nlegal entities, then from each legal entity to\nsmaller legal entities (may be several such iterations) and then to private person credit cards\n(from 600 to 7000 transactions).\n\n- When the attackers had obtained control of ATM\nmanagement service (attacker purpose), money\nwere withdrawn directly from the ATM by the attacker command. In this case the whole cashout\nprocess consisted in that a drop person had to be\nnear the ATM at the specified time with a bag to\nempty the dispenser.\n\nBank (amounts from 100 million roubles):\n\n- Money was sent to accounts of other banks, and\ncracked banks were often used where accounts\nand credit cards had been prepared in advance.\n\nPayment system:\n\n- In addition to all the above methods, cash\nsending channels were also employed through\nthe settlements systems, electronic wallets and\npayment systems, such as web money, Yandex\n\n\n-----\n\nMoney, QIWI (1500-2000 transactions). Revenues of large amounts (up to 50 million roubles)\nwere recorded to particular cards of private persons who then used these cards to buy expensive\nsmall-sized goods such as jewelry, watches, and\nother attributes. A huge part of the money was\nsent through mobile operators (1500-2000 SIM\ncards prepared in advance).\n\n- In spring 2014 (high time of this fraud type) 2\ncashout person groups were known who supported target attacks, by autumn 2014 their number\n\n### Malware samples\n\n\nincreased to 5. In general, this increase was due\nto number of thefts too (number of victims +\naverage stolen sum per 1 victim). The groups\nare working in different cities to ensure better\ncashout distribution. Also these groups include\nimmigrants from former Soviet republics who if\nnecessary arrive in the required city. Each group\nwas monitored by a separate person. Each group\nconsists of about 15-20 people.\n\n- Part of the money was transferred to Ukraine and\nBelarus.\n\n|anunak|Col2|Col3|Col4|\n|---|---|---|---|\n|MD5|File name|C&C domain|C&C IP|\n|D1DE522652E129C37759158C14D48795|ntxobj.exe|blizko.net|31.131.17.125|\n|C687867E2C92448992C0FD00A2468752|ntxobj.exe|blizko.org|31.131.17.125|\n|A1979AA159E0C54212122FD8ACB24383|spoolsv.exe|update-java.net|146.185.220.200|\n|0AD4892EAD67E65EC3DD4C978FCE7D92|ZwGuKEMphiZgNT.com|great-codes.com|188.138.16.214|\n|||mind-finder.com|188.138.16.214|\n|CC294F8727ADDC5D363BB23E10BE4AF2|svchost.exe|adguard.name|5.199.169.188|\n|CC294F8727ADDC5D363BB23E10BE4AF2|d.exe|adguard.name|146.185.220.97|\n|CC294F8727ADDC5D363BB23E10BE4AF2|A0050236.exe|adguard.name|5.199.169.188|\n|AC5D3FC9DA12255759A4A7E4EB3D63E7|svchost.exe|adguard.name|5.199.169.188|\n|||comixed.org|91.194.254.90|\n|||traider-pro.com|91.194.254.94|\n||||5.1.83.133|\n||||216.170.117.88|\n||||10.74.5.100|\n|FC6D9F538CDAE19C8C3C662E890AF979|Dc1.exe|public-dns.us|37.235.54.48|\n|FC6D9F538CDAE19C8C3C662E890AF979|Dc1.exe|public-dns.us|146.185.220.200|\n|FC6D9F538CDAE19C8C3C662E890AF979|Dc1.exe|freemsk-dns.com|146.185.220.200|\n|3dc8c4af51c8c367fbe7c7feef4f6744|||185.10.56.59|\n|3e90bf845922cf1bf5305e6fdcc14e46||worldnewsonline.pw|5.101.146.184|\n|1f80a57a3b99eeb8016339991a27593f|CONTRACT.doc|financialnewsonline.pw|185.10.58.175|\n|b63af72039e4fb2acd0440b03268b404|QWcQAwoI.exe|great-codes.com|188.138.16.214|\n|||mind-finder.com|188.138.16.214|\n|||veslike.com|65.19.141.199|\n|||publics-dns.com|91.194.254.94|\n|09c8631c2ba74a92defb31040fe2c45a|QWcQAwoI.exe|coral-trevel.com|87.98.153.34|\n|9d718e86cacffa39edafbf9c1ebc9754|Oplata.scr|paradise-plaza.com|91.194.254.93|\n\n\n-----\n\nmimikatz\n\nMD5\n\n5D1AE2391DFB02E573331B3946F0C314\n\n8DD78371B2D178FB8C8A9B1012D7E985\n\n8646E3D8FFFFE854D5F9145C0AB413F6\n\nE464D4804D36FDDF0287877D66D5037A\n\nDE9F4CBB90C994522553AB40AC2D5409\n\nE9FC0F53C7C0223DE20F1776C53D3673\n\nA4B053D9EC7D5EDB207C208BFBE396EC\n\n86BD7F72A495A22B22070C068B591DF8\n\n2B817BD8195DC7F56500F38A0C740CEF\n\nandromeda\n\nMD5\n\n4CF26F8E2F6864C4A8AAA7F92E54E801\n\nmbr_ eraser\n\nMD5\n\n934E1055B171DF0D3E28BE9831EB7770\n\nemail at tachments\n\n|MD5|File name|\n|---|---|\n|5D1AE2391DFB02E573331B3946F0C314|mimi.exe|\n|8DD78371B2D178FB8C8A9B1012D7E985|m86.exe|\n|8646E3D8FFFFE854D5F9145C0AB413F6|00019114|\n|E464D4804D36FDDF0287877D66D5037A|00030724|\n|DE9F4CBB90C994522553AB40AC2D5409|00032800|\n|E9FC0F53C7C0223DE20F1776C53D3673|A0049585.exe|\n|A4B053D9EC7D5EDB207C208BFBE396EC|A0050233.dll|\n|86BD7F72A495A22B22070C068B591DF8|A0050235.sys|\n|2B817BD8195DC7F56500F38A0C740CEF|m.exe|\n\n|MD5|File name|C&C domain|C&C IP|\n|---|---|---|---|\n|4CF26F8E2F6864C4A8AAA7F92E54E801|001. photo.exe|ddnservice10.ru/and/jopagate.php ddnservice11.ru/and/jopagate.php|144.76.215.219|\n\n|MD5|File name|\n|---|---|\n|934E1055B171DF0D3E28BE9831EB7770|MBR_Eraser.exe|\n\n|MD5|File name|C&C domain|\n|---|---|---|\n|8FA296EFAF87FF4D9179283D42372C52|Соответствие ФЗ-115 от 24.06.2014г.doc_|CVE-2012-2539|\n|AA36BA9F4DE5892F1DD427B7B2100B06|реквизиты.doc.cpl (“partner details.doc.cpl”)|CVE-2012-0158, CVE-2012-2539|\n|4CF26F8E2F6864C4A8AAA7F92E54E801|001. photo.exe||\n|17984EB3926BF99F0CCB367F4FBA12E3|О изменении правил электронного взаимодействия.doc (“About changes of electronic interaction rules.doc”)|CVE-2012-0158|\n|94666BCA3FE81831A23F60C407840408|Об особенностях организации и проведения проверок кре- дитных организаций.doc (“About peculiarities of organizing and conducting inspections of credit institutions.doc”)|CVE-2012-0158|\n\n\n-----\n\n### Attacks in Europe and USA\n\nWhile the attacks in Russia against banks and\npayment systems have occurred over the past two\nyears, the attacks against the retail industry is only\nsomething which started in the second quarter of\n2014. With at least three confirmed breaches where\ncard track data was obtainedand a total of at least 16\nbreaches at retail organizations, it is also becoming a\nserious threat.\n\nApart from retail organizations it is also known\nthat a number of media and PR companies have\nbeen breached in 2014. While it is not entirely certain, the type of breaches suggest that the attackers\nare looking for inside information, a type of industrial espionage, allowing them to gain an advantage\non the stock market. As there is nothing specifically\nmissing and the resulting fraud is hard to match\nwith anything, these incidents typically are never\nlinked.\n\nMedia/PR/\nRetail\nMarketing\n\nUSA 12 3\n\nAustralia 2 0\n\nSpain 1 0\n\nItaly 1 0\n\nTable: Overview of compromises per region and\nsector.\n\ninfection methods\n\nFrom the retail perspective, the first infections in\n2014 were sourced from a botnet which employs a\nwidely deployed crypto-currency mining malware\nbased on the Gozi/ISFB (banking) malware family.\nBased on our insights we believe during the first\nhalf of 2014 over half a million systems had been\ncompromised by this malware from over the whole\nworld, however Russia and a number of post-Soviet\nstates were clean of infections. To find interesting\ninfections within this large set of compromised\nsystems, the malware extracts relevant information\nfrom the systems including Microsoft Windows\norganization registration information and network/\nWindows domain information.\n\nThe Gozi/ISFB based malware was used to drop\nadditional components on interesting systems,\nwhich included Metasploit/Meterpreter payloads\n\n\nand Anunak variants. This was one of the main\nmethods for the group using Anunak to obtain interesting infections in the middle of 2014, sourcing\ninfections from other botnet operators.More recently other infection methods, including spear phishing\nusing English language and possibly also usage of\nthe teams own Andromeda, but also SQL injection\nto breach an organization directly from the outside,\nhas been employed by this team.\n\npos compromises\n\nThe first known attacks with Anunak targeted\na specific brand of POS systems which revolved\naround the Epicor/NSB brand. To do this Anunak\nhas specific code to target POS devices equipped\nwith this software, which in contrary to the more\ncommon memory scanning track data scrapers, logs\na wealth of information from the payments done by\nthe cards. The first case this was seen active was in\nJuly 2014, but it might have been earlier as well.\n\nMore recent breaches have used a new custom\ndeveloped POS malware, which is a more simple\nbut reliable track data memory scraper. The initial\nversion from the early fall of 2014 used a simple\nblacklist, scraped every process and dumped track\ndata in plain text. More recent versions scanned\nonly configuration specified processes and used RC4\nto encrypt the extracted track data records on disk.\n\nadditional targets\n\nWhile the retail industry is one of its main targets\ndue to its payment processing capabilities, other\ncompromises might occur indirectly, for example to\nobtain databases with information or other information that is of value to the organized criminal group.\nOne of the possibilities is obtaining lists of corporate\nemail addresses to have a higher chance of interesting infections.\n\nAt this moment we have no evidence of successful\ncompromise or theft of banks and payment systems\noutside of Russia, but several infections in the east\nof Europe (specifically Ukraine and Latvia) were\nactive in 2014. These specific infections were related\nto infrastructure of organizations based in Russia or\nwith significant interests in Russia, thus more likely\nrelated to the breaches at the same organization in\nRussia.\n\nThe majority of infections from Europe were from\ndedicated servers used as exit node for VPN services,\n\n|linked.|Col2|Col3|\n|---|---|---|\n||Retail|Media/PR/ Marketing|\n|USA|12|3|\n|Australia|2|0|\n|Spain|1|0|\n|Italy|1|0|\n\n\n-----\n\nthe systems infected were likely from Eastern European or Russian origin, and possibly test infections\nfrom the attackers. We have no evidence of compromises against banks in Western Europe or United\nStates, but it should be noted that the attackers\nmethods could be utilized against banks outside of\nRussia as well.\n\nmethods of l ateral movement\nand persistence\n\nThe group uses Metasploit as one of their main\nhacking tools, either stand alone or as part of a\nframework. The activity includes port scanning and\nsystem reconnaissance, escalating privileges on\nsystems by using for example the recent CVE-20144113 vulnerability, gathering credentials and hopping on to other systems and networks. Metasploit\nis being used to its full potential with scanning,\nexploiting, privilege escalation and post exploitation\npersistence being achieved with its standard toolset.\n\nOn interesting and critical systems typical hacking tools might be found to establish tunnels out\nof the network, either tools that are part of the\nMetasploit framework such as Meterpreter, but also\nother tools to achieve persistence on those systems.\nThe connect back methods seen are typically SSL\nover port 443, but also DNS based methods were\nobserved. The attackers use BITS to download files,\nbut also make use of Windows built-in PowerShell to\ndownload tools and execute commands. Finally on\nthe critical systems freshly crypted and non-detected\nversions of Anunak are deployed, typically these are\nused in very limited deployments thus their spread\nis limited and detection by Anti-Virus is very rare.\n\nVarious stealth methods including the aforementioned backconnect SSL and DNS tunneling for\ncompromise persistence and data exfiltration are\nused. The Anunak malware has multiple ways of\nconnecting to backends, which includes a PHP based\nbackend reachable over HTTP and HTTPS, and a\nWindows server based component using a proprietary protocol.\n\nThe use of VNC scanning and password brute\nforcing, the adding of additional administrator\naccounts, use of RDP Wrapper to allow concurrent\nRDP sessions are all methods to gain access and\nachieve persistent access to compromised systems\nemployed by this group. Additionally various ways\nof creating incidental and regular screen captures\nof the desktop of persons of interest within com\n\npromised organizations were methods employed by\nthese attackers. This also includes video captures\nmade by the Anunak malware, allowing attackers to\nobserve the behavior of users of certain applications.\n\n### About us\n\ngroup- ib\n\nGroup-IB is one of the leading international\ncompanies specializing in preventing and investigating high-tech cyber crimes and fraud. The company\noffers a range of services on preventing financial\nand reputational damages, consulting and auditing\nof information security systems, and on computer\nforensics. The company also develops a number of\ninnovative software products used to monitor, detect\nand prevent emerging cyber threats.\n\nThe Group-IB team is made up of experts with\nunique skills and solid practical experience. They\nare internationally certified by CISSP, CISA, CISM,\nCEH, CWSP, GCFA and also have information\nsecurity state certificates. In 2013, computer security incident response team CERT-GIB operated by\nGroup-IB became a member of FIRST — Forum of\nIncident Response and Security Teams.\n\nIn 2013, the company became a member of the\ninternational cyber security alliance IMPACT (International Multilateral Partnership Against Cyber\nThreats).\n\nwww.group-ib.com\n\nfox- it\n\nFox-IT creates innovative cyber security solutions\nfor a more secure society. We are dedicated to our\nclients, our values, and our integrity. Fox-IT delivers\nsolutions before, during and after attacks. InTELL\nis the real-time cyber intelligence product from\nFox-IT. It provides a layered intelligence approach:\nactionable data feeds into operational risk decision\nsystems. Real time threat information allows for\ntactical decisions and mitigation. InTELL provides a\nfull real-time insight in the global threat landscape.\nWe base our intelligence around actor attribution. This angle drives a unique visibility on online\nthreats — InTELL sees threats before they enter the\nbotnet. Information is delivered through our collaboration portal, alerting, and through automated\nfeeds powered by industry standard transports.\n\nwww.fox-it.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "http://www.group-ib.com/files/Anunak_APT_against_financial_institutions.pdf",
        "https://app.box.com/s/exmsfcvad1sjqtmvtzbiil9k52js62ir",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.12.22.Anunak_APT/Anunak_APT_against_financial_institutions.pdf",
        "https://www.group-ib.com/resources/threat-research/Anunak_APT_against_financial_institutions.pdf"
    ],
    "report_names": [
        "Anunak_APT_against_financial_institutions.pdf",
        "Anunak_APT_against_financial_institutions"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1419010792,
    "ts_modification_date": 1419010794,
    "files": {
        "pdf": "https://archive.orkl.eu/c1b7c2bec86e8edf8bba650c6fa506319198e3c3.pdf",
        "text": "https://archive.orkl.eu/c1b7c2bec86e8edf8bba650c6fa506319198e3c3.txt",
        "img": "https://archive.orkl.eu/c1b7c2bec86e8edf8bba650c6fa506319198e3c3.jpg"
    }
}