{
    "id": "9700d2b4-7a3d-4e3e-9b22-8cf40fbf545e",
    "created_at": "2022-10-25T16:48:22.114055Z",
    "updated_at": "2025-03-27T02:17:22.967621Z",
    "deleted_at": null,
    "sha1_hash": "91ae6d339296f9d85396d9aa2c1f279f2b05eb6b",
    "title": "2016-09-16 - Tofsee – modular spambot",
    "authors": "",
    "file_creation_date": "2021-11-30T14:11:19Z",
    "file_modification_date": "2021-11-30T14:11:21Z",
    "file_size": 1493073,
    "plain_text": "# JUMPING THE AIR GAP:\n## 15 years of nation-state effort\n\n##### Authors: Alexis Dorais-Joncas Facundo Munõz\n\n December 2021\n\n\n-----\n\n### TABLE OF CONTENTS\n\n1. Executive summary .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 4\n\n2. Introduction  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 5\n\n3. Victimology, attacker profiles, timeline  .  .  .  .  .  .  .  .  .  .  .  .  .  . 6\n\n4. Anatomy of air-gapped systems—a malware perspective .   .   .   .   .   .   .   . 8\n\n4.1 Connected side execution vector  .  .  .  .  .  .  .  .  .  .  .  .  .  .  11\n\n4.2 Air-gapped side initial execution vector .  .  .  .  .  .  .  .  .  .  .  .  12\n\n4.3 Air-gapped side functionalities .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  17\n\n4.4 Communication and exfiltration channel  .   .   .   .   .   .   .   .   .   .   .   21\n\n5. Defending air-gapped networks  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   25\n\n5.1 Protection opportunity #1: prevent email access on connected hosts .  . 25\n\n5.2 Protection opportunity #2: disable USB ports on air-gapped systems  .   . 25\n\n5.3 Protection opportunity #3: sanitize USB drives before insertion\n\nin air-gapped systems .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 25\n\n5.4 Protection opportunity #4: restrict file execution on removable drives .   27\n\n5.5 Protection opportunity #5: maintain air-gapped systems updated  .   .   . 27\n\n5.6 Detection opportunity #1: air-gapped side host reconnaissance activity . 29\n\n5.7 Detection opportunity #2: air-gapped side network-based\n\nreconnaissance activity .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   29\n\n6. Conclusion  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 30\n\n7. References  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 31\n\n8. Appendix 1: Connected frameworks overview .  .  .  .  .  .  .  .  .  .  .  . 32\n\n8.1 IdentityKit #1: USBStealer .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 32\n\n8.2 IdentityKit #2: Agent.BTZ  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 33\n\n8.3 IdentityKit #3: Stuxnet  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 34\n\n8.4 IdentityKit #4: Fanny .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  36\n\n8.5 IdentityKit #5: miniFlame  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 37\n\n8.6 IdentityKit #6: Flame .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  38\n\n8.7 IdentityKit #7: Gauss  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  39\n\n8.8 IdentityKit #8: USBFerry .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  41\n\n8.9 IdentityKit #9: USBCulprit  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   42\n\n8.10 IdentityKit #10: Retro .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 43\n\n8.11 IdentityKit #11: PlugX .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  44\n\n9. Appendix 2: Offline/human asset frameworks overview .   .   .   .   .   .   .   . 45\n\n9.1 IdentityKit #12: ProjectSauron  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 45\n\n9.2 IdentityKit #13: EZCheese  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 46\n\n9.3 IdentityKit #14: Emotional Simian .  .  .  .  .  .  .  .  .  .  .  .  .  .  47\n\n9.4 IdentityKit #15: USBThief .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  47\n\n9.5 IdentityKit #16: Brutal Kangaroo  .   .   .   .   .   .   .   .   .   .   .   .   .   .  49\n\n9.6 IdentityKit #17: Ramsay .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 51\n\n\n-----\n\n### LIST OF TABLES\n\nTable 1 _Techniques used to compromise the connected-side system .   .   .   .   .   .   11_\n\nTable 2 _History of RCE vulnerabilities related to LNK files  .   .   .   .   .   .   .   .   .   13_\n\nTable 3 _Techniques used to compromise the first air-gapped system .   .   .   .   .   .  16_\n\nTable 4 _Techniques used to spread within the air-gapped networks  .   .   .   .   .   .  20_\n\nTable 5 _Types of offline communication protocols .   .   .   .   .   .   .   .   .   .   .   .  24_\n\nTable 6 _Frameworks using malicious LNK and autorun.inf files .   .   .   .   .   .   .   .  26_\n\nTable 7 _Use of exploits inside the air-gapped sides_\n_(usage on the connected side excluded) .   .   .   .   .   .   .   .   .   .   .   .  28_\n\nTable 8 _Commands and parameters issued to perform reconnaissance_\n_on air-gapped systems  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  29_\n\nTable 9 _Active network reconnaissance activity via Windows commands .   .   .   .   . 29_\n\n### LIST OF FIGURES\n\nFigure 1 _Frameworks attributed with high confidence to known threat actors .   .   .   6_\n\nFigure 2 _Frameworks where attribution could not be determined_\n_or only in a speculative way .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 6_\n\nFigure 3 _Frameworks documented in the Vault7 leak .   .   .   .   .   .   .   .   .   .   .   . 6_\n\nFigure 4 _Period of activity of all known frameworks and date of the first_\n_public report .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 7_\n\nFigure 5 _Overview of the components and actions of a connected framework_\n_designed to attack air-gapped networks .   .   .   .   .   .   .   .   .   .   .   .   . 9_\n\nFigure 6 _Overview of the components and actions of an offline framework_\n_designed to attack air-gapped networks .   .   .   .   .   .   .   .   .   .   .   .   10_\n\nFigure 7 _Connected side system compromise .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   11_\n\nFigure 8 _Air-gapped side initial system compromise .   .   .   .   .   .   .   .   .   .   .   . 12_\n\nFigure 9 _Stuxnet’s malicious LNK file specifies a file with a .tmp extension_\n_as its icon source .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  14_\n\nFigure 10 _Part of Stuxnet’s autorun.inf file  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  15_\n\nFigure 11 _USBStealer autorun.inf file contents  .   .   .   .   .   .   .   .   .   .   .   .   .   . 15_\n\nFigure 12 _Example content of a USB drive prior to PlugX’s weaponization .   .   .   .   .  16_\n\nFigure 13 _Contents of the USB drive after PlugX’s weaponization .   .   .   .   .   .   .   . 16_\n\nFigure 14 _Online and offline communication channels in connected frameworks .   .   .  21_\n\nFigure 15 _Offline communication channel in offline frameworks .   .   .   .   .   .   .   .  22_\n\nFigure 16 _Window policies to control Removable Storage Access .   .   .   .   .   .   .   .  27_\n\nFigure 17 _Illustration of USBThief’s multistaged loading process  .   .   .   .   .   .   .   . 49_\n\n\n-----\n\n### 1. EXECUTIVE SUMMARY\n\n_[Warning: This report contains references to material from the Vault7 leak, which may contain ]_\n_classified information._\n\nAir-gapping is used to protect the most sensitive of networks. In the first half of 2020 alone, four previously\nunknown malicious frameworks designed to breach air-gapped networks were publicly documented. ESET\nResearch decided to revisit each framework known to date and to put them in perspective, side by side.\n\nHere are the key findings stemming from this exhaustive study:\n\n- All the frameworks are designed to perform some form of espionage.\n\n- All the frameworks used USB drives as the physical transmission medium to transfer data in and out\nof the targeted air-gapped networks.\n\n- We have not found any case of actual or suspected use of covert physical transmission mediums,\nsuch as acoustic or electromagnetic signals.\n\n- Over 75% of all the frameworks used malicious LNK or autorun files on USB drives to either perform\nthe initial air-gapped system compromise or to move laterally within the air-gapped network.\n\n- More than 10—critical severity—LNK-related remote code execution vulnerabilities in Windows have\nbeen discovered, then patched by Microsoft, in the last 10 years.\n\n- All the frameworks were built to attack Windows systems. We have not found any evidence of actual\nor suspected malware components built to target other operating systems.\n\nIn this white paper, we will describe how malware frameworks targeting air-gapped networks operate,\nand provide a side-by-side comparison of their most important TTPs. We also propose a series of detection\nand mitigation techniques to protect air-gapped networks from the main techniques used by all the malicious frameworks publicly known to date.\n\n\n-----\n\n### 2. INTRODUCTION\n\nAir-gapping is used to protect the most sensitive of networks: voting systems, industrial control\nsystems (ICSes) running power grids, and SCADA systems operating nuclear centrifuges, just to name a few.\nIn the first half of 2020 alone, four malicious frameworks designed to breach air-gapped networks emerged,\nbringing the total, by our count, to 17. This prompted us to step back and revisit each of those frameworks\nfrom the vantage point of having discovered and analyzed firsthand three of these in the past six years.\nUsing the knowledge made public by more than 10 different organizations over the years, and some ad hoc\nanalysis to clarify or confirm some technical details, we put the frameworks in perspective to see what\nhistory could teach us in order to improve air-gapped network security and our abilities to detect and\nmitigate future attacks.\n\nThis exhaustive study allowed us to isolate several major similarities in all of them, even those produced\n15 years apart. Specifically, we focused our attention on the malware execution mechanisms used on both\nthe connected and the air-gapped side of targeted networks and the malware functionalities within the\nair-gapped network (persistence, reconnaissance, propagation, espionage, and—at least in one case—\nsabotage activities), with a focus on the communication and exfiltration channels used to cross the air gap\nbarrier and control the components running on the isolated networks. This also resulted in a systematic\nanalysis structure that may be reused to document air-gapped malware that is discovered in the future.\n\nDespite some differences and nuances found across all frameworks studied, our analysis shows how\nmost differ on many of those aspects only from an implementation perspective, mostly due to the severe\nconstraints imposed by air-gapped environments. Armed with this information, we will highlight some\ndetection opportunities specific to the actual techniques observed in the wild.\n\nOur aim is to convince the reader of the importance of having all the proper defense mechanisms\nto mitigate the techniques used by virtually all of these frameworks that have been observed in the wild,\nbefore starting to look into the many theoretical air gap bypass techniques that have received a lot\nof attention in recent years despite none of them ever being used in a real, publicly disclosed attack.\n\n\n-----\n\n### 3. VICTIMOLOGY, ATTACKER PROFILES, TIMELINE\n\nAn air-gapped network is one that is physically isolated from any other networks in order to increase\nits security. Air-gapping is a technique used to protect networks interconnecting the most sensitive and\nhigh-value systems within an organization, systems that are naturally of high interest to numerous\nattackers, including any and all APT groups.\n\nWe can state without fear of contradiction that threat actors behind the known malware frameworks\ndesigned to attack air-gapped networks all belong to the advanced persistent threat (APT) category.\nSome frameworks have been attributed to well-defined, well-known threat actors:\n\n##### DarkHotel Sednit Tropic Trooper\n\nRetro USBStealer USBFerry\n2017-2019 2005-2015 2014-2020\n\nRamsay\n2019-2020\n\n##### Goblin Panda Mustang Panda\n\n Equation Group USBCulprit PlugX\n\n2014-2019 2018-2020\n\nFanny\n2008-2012\n\nFigure 1 // Frameworks attributed with high confidence to known threat actors\n\nFor others, the attribution has been less clear-cut, speculative or controversial. Agent.BTZ, for example,\nhas been attributed to Turla [1], but other experts are not so convinced [2].\n\n\n##### Stuxnet\n2007-2012\n\n\n##### Flame\n2010-2012, 2014-2016\n\n\n##### miniFlame\n2009-2012\n\n\n##### Gauss\n2011-2012\n\n\n##### ProjectSauron\n2011-2016\n\n\n##### Agent.BTZ\n2007-201x\n\n\n##### USBThief\n2015\n\n\nFigure 2 // Frameworks where attribution could not be determined or only in a speculative way\n\nFinally, we have a trilogy of frameworks that constitute our special cases: these frameworks have been\nfound in documentation from the Vault7 leaks and are described to have been in operation in a time range\nfrom 2013 to 2016; however, we haven’t found samples in the wild to analyze first hand.\n\n##### 2013-2016\n\nEZCheese Emotional Simian Brutal Kangaroo\n\nFigure 3 // Frameworks documented in the Vault7 leak\n\n\n-----\n\nDespite the variety of threat actors behind these frameworks, all of them shared a common purpose:\nespionage. Even Stuxnet, best known for its sabotage capabilities, collected information about Siemens\nSimatic Step 7 engineering software projects found in compromised machines.\n\nDue to the nature of its target and its capabilities to operate and propagate, Stuxnet has often been referred\nto as the first malware designed to attack systems in air-gapped networks. However, research published\nyears after the Stuxnet discovery determined with reasonable confidence that a sample of Sednit’s USBStealer dates from 2005 [3]. Figure 4 shows a historical view of the period of activity of each framework,\nalong with the time of the first public report. This is also an indication of how difficult it is to detect this\ntype of framework.\n\nNote that the periods of activity are based on what has been reported publicly; in some cases, the researchers\nwere not able to determine a precise period of activity based on observable facts but are rather approximated\nor inferred by using some reasonable hypotheses.\n\nFirst public report\n\nUSBStealer\n\nAgent.BTZ\n\nStuxnet Stuxnet 0.5 Stuxnet 1.0\n\nFanny\n\nminiFlame\n\nFlame Flame 1.0 Flame 2.0\n\nGauss\n\nProjectSauron\n\nEZCheese\n\nEmotional Simian\n\nUSB Thief\n\nUSBFerry\n\nUSBCulprit\n\nBrutal Kangaroo\n\nRetro\n\nPlugX\n\nRamsay\n\n**2005** **2006** **2007** **2008** **2009** **2010** **2011** **2012** **2013** **2014** **2015** **2016** **2017** **2018** **2019** **2020** **2021**\n\nFigure 4 // Period of activity of all known frameworks and date of the first public report\n\nThis timeline highlights an important point:\n\n- The majority of the frameworks were active for many years before being noticed, analyzed\nand reported publicly.\n\nContrary to the many malware families that play cat-and-mouse with security researchers by evolving even\nafter they are exposed, most air-gapped frameworks haven’t remained active long after the first analysis\nwas published. This can be explained either by the fact that the analysis caused the attackers to consider\ntheir tool burned and to stop using it, or that the discovery and analysis happened after the framework\nstopped being used for unrelated reasons. There is also the unsettling possibility that antimalware solutions\nin those networks did not get updated and hadn’t been able to detect these threats.\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Fir|st publi|c report|Col14|Col15|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|Age S|nt.BTZ tuxnet||||||||||||||\n|||Stuxn Fanny mini|et 0.5||Stuxn|et 1.0|||||||||\n||||Flame||||||||||||\n|||||Flame ProjectS|||||||||||\n||||||Flam Gauss auron Em|e 1.0|||Flam|e 2.0|||||\n||||||||||||||||\n|||||||EZC otional|heese Simian US US USB||||||||\n|||||||||B Thief BFerry Culprit Br|||||||\n||||||||||||||||\n||||||||||||||||\n||||||||||utal Kan|garoo|||||\n||||||||||||Retro||||\n|||||||||||||PlugX R|||\n||||||||||||||amsay||\n||||||||||||||||\n\n\n-----\n\n### 4. ANATOMY OF AIR-GAPPED SYSTEMS—A MALWARE PERSPECTIVE\n\nAttack and compromise of systems in air-gapped networks require the attackers to develop capabilities\nthat enable their tools to communicate via channels that are not commonly required in normal operations.\nIt’s obvious: they have to contend with the fact that these networks are isolated from the internet. In this\nsection we discuss those specific areas where air-gapped malware tends to operate.\n\nBefore we begin, it is important to note that attacks against air-gapped networks are not all done in the\nsame way and, in fact, there is no precise definition of what “air-gapped malware” actually is from the purely\ntechnical perspective. This sparked some lively discussions internally, until we finally agreed upon—for the\npurpose of this paper—the following definition for air-gapped network malware:\n\n_Malware, or a set of malware components acting together (a framework), that implements an offline, covert_\n_communication mechanism between an air-gapped system and the attacker that can be either bi-directional_\n_(command and response) or unidirectional (data exfiltration only)._\n\nSome frameworks have been left out intentionally from this study because we could not reliably determine\nthat they fit in our definition. For example, it has been reported that DarkHotel has used Asruex since 2015\nto attack isolated networks [4]; however, publicly available reports do not provide enough technical evidence\ndemonstrating the presence of the minimal requirements needed to satisfy our working definition.\n\n\n_Interestingly, all the known frameworks were designed to attack Windows systems only._\n\n\n-----\n\nLet’s “zoom out” and have a look at the big picture. We decided to separate the frameworks into two broad\ncategories: connected and offline. Most frameworks are built to provide fully remote end-to-end connectivity\nbetween the attacker and the compromised systems on the air-gapped side. We call these “connected\nframeworks”. The general operating schema looks like this:\n\nConnected side\n\n**7**\n\nExfiltrate\n\n**1** **8**\n\nInitial compromise Send further\n(spearphishing, commands\nwatering hole attack) Connected system C&C Server\n\n**13**\n\nExfiltrate\n\nWeaponize Extract Store commands Extract results\n\n**2** **6** **9** **12**\n\nUSB drives exfiltrated data to USB from USB\n\nAir Gap\n\nUSB Drive\n\nCompromise Copy stolen Read commands Copy command\n\n**3** **5** **10** **11**\n\nair-gapped system information to USB and execute results to USB\n\n**4**\n\nPerform reconnaissance\nand information stealing Air-gapped _Connected bidirectional_\n\nsystem _communication channel_\n\nAir-gapped side\n\nFigure 5 // Overview of the components and actions of a connected framework designed to attack air-gapped networks\n\nIn this scenario, the attack first targets an internet-connected system that is used alongside an air-gapped\nnetwork . Once compromised, that system is used to weaponize USB drives with a malicious payload and\nsome mechanism to compromise the next target: the air-gapped system . This is usually made possible\nbecause the USB drive is used to transfer information between both sides, in most cases by an unsuspecting\nvictim.\n\nThe payload running on the air-gapped system usually comes with reconnaissance and information\nstealing capabilities, whose output is stored back onto a USB drive . When the USB drive reaches\nthe compromised connected system, its contents are extracted and the data is exfiltrated\nto the attacker via the Internet .\n\nSome frameworks go one step further and support a two-way communication protocol:\nthrough a compromised system in the connected side, the attacker sends commands to the malware\nplaced on the air-gapped network; this is done via a covert communication channel often placed\non a USB drive ( / / / / / ). These are the most powerful frameworks, granting the attackers\nthe ability to run arbitrary code inside air-gapped networks.\n\n\n-----\n\nIn the other, rarer cases such as Ramsay and USBThief, the attack scenario does not involve any\ninternet-connected systems at all. We call these “offline frameworks”. In these cases, everything indicates\nthe presence of an operator or collaborator on the ground to perform the actions usually done by\nthe connected part of connected frameworks, such as preparing the initial malicious USB drive responsible\nfor the execution on the air-gapped side, executing the malware on the air-gapped system, extracting\nthe exfiltrated data from the drive and sending additional commands to the air-gapped side . Figure 6\nshow how much the operating schema becomes simplified, from the malware perspective at least:\n\nAttacker\n\nWeaponize Extract Store commands Extract results\n\n**1** **5** **6** **9**\n\nUSB drives exfiltrated data to USB from USB\n\nAir Gap\n\nUSB Drive\n\nCompromise Copy stolen Read command Copy command\n\n**2** **4** **7** **8**\n\nair-gapped system information to USB and execute results to USB\n\n**3**\n\nPerform reconnaissance\nand information stealing Air-gapped _Connected bidirectional_\n\nsystem _communication channel_\n\nAir-gapped side\n\nFigure 6 // Overview of the components and actions of an offline framework designed to attack air-gapped networks\n\n\n-----\n\n#### 4.1 Connected side execution vector\n\nFor connected frameworks, the first step to successfully compromise the air-gapped network is to get\na foothold on a system that has internet connectivity, as Figure 7 shows. Unfortunately, when it comes\nto APTs, it’s not always possible to know exactly how this happened but for the cases that we do know,\nthe methods observed do not differ much from what we see in general malware: emails with malicious\nattachments, links, or USB worms. Table 1 summarizes the various methods.\n\nConnected side\n\n**7**\n\nExfiltrate\n\n**1** **8**\n\nInitial compromise Send further\n(spearphishing, commands\nwatering hole attack) Connected system C&C Server\n\n**13**\n\nExfiltrate\n\nWeaponize Extract Store commands Extract results\n\n**2** **6** **9** **12**\n\nUSB drives exfiltrated data to USB from USB\n\nFigure 7 // Connected side system compromise. Part of Figure 5.\n\nCompromise method Details\n\n|USBStealer|Email (suspected)|Suspected spearphishing with malicious attachments.|\n|---|---|---|\n|Agent.BTZ|USB worm|Spreads by copying itself to USB drives with an autorun. inf file as execution vector.|\n|Stuxnet|Unknown|It is not clear whether the compromission started via a connected system or was performed by a human asset with physical access to the air-gapped network.|\n|Fanny|Unknown|Possibly downloaded and installed by another component at the request of the attackers.|\n|miniFlame|Unknown|Possibly downloaded and installed by Gauss or Flame|\n|Flame|Unknown|It is suspected that an exploit is used for the initial compromise of a potential victim.|\n|Gauss|Unknown|Gauss does not propagates itself, it is unknown how victims get compromised by it.|\n|USBFerry|Email|Malicious software installer in attachment.|\n|USBCulprit|Email|Spearphishing with malicious RoyalRoad document exploiting one days (CVE-2012-0158, CVE-2017-11882, CVE-2018-0802), then USBCulprit is dropped selectively by the attacker.|\n|Retro|Email|Spearphishing with documents that exploit CVE-2017-11882.|\n|PlugX|Email|Spearphishing with ZIP archive containing a malicious LNK file.|\n\n\n-----\n\nProjectSauron\n\nEZCheese\n\nEmotional\nSimian\n\nUSBCulprit\n\nUSBThief\n\nBrutal Kangaroo\n\nRamsay\n\n\nCompromise method Details\n\nOffline frameworks\n\nNot applicable (offline frameworks)\n\nTable 1 // Techniques used to compromise the connected-side system\n\n\n#### 4.2 Air-gapped side initial execution vector\n\nAll frameworks have devised their own ways to reach the target air-gapped network and execute malware\non a first system. They all have one thing in common, though: they all used weaponized USB drives.\n\nThe main difference between connected and offline frameworks is how the drive is weaponized in the first\nplace. Connected frameworks usually deploy a component on the connected system that will monitor the\ninsertion of new USB drives and automatically place the malicious component needed to compromise\nthe air-gapped system.\n\nOffline frameworks, on the other hand, rely on the attacker intentionally weaponizing their own USB drive.\n\nWhat is interesting here is the variety of techniques used over time by these frameworks to get their payload\nexecuted on the target system. We can place these into three large categories.\n\nCompromise Copy stolen Read commands Copy command\n\n**3** **5** **10** **11**\n\nair-gapped system information to USB and execute results to USB\n\n**4**\n\nPerform reconnaissance\nand information stealing Air-gapped _Connected bidirectional_\n\nsystem _communication channel_\n\nAir-gapped side\n\nFigure 8 // Air-gapped side initial system compromise. Part of Figure 5.\n\n##### Automated execution\n\nGetting malicious code executed just by connecting a malicious USB drive into a computer is the most\neffective technique to compromise an air-gapped system.\n\nExploitation of LNK-related vulnerabilities\n\nMalicious LNK files are usually used as the exploit to trigger a vulnerability in old components of Windows,\nsuch as the Windows Shell, that allow the malware to get remote code execution with no user action\nrequired other than viewing the LNK file in Windows Explorer.\n\n\n-----\n\nThe most famous vulnerability is without a doubt CVE-2010-2568, aka the “Stuxnet LNK exploit”. But Stuxnet\nis far from the only framework to have used that vulnerability to gain initial access to air-gapped networks.\nIn fact, it was later discovered that Fanny had used that exploit even before Stuxnet [5]. And even after\nMicrosoft released a patch in 2010 for CVE-2010-2568, Flame, Gauss and miniFlame continued to use\nit afterwards.\n\nThe Vault7 leaks also revealed that the Brutal Kangaroo tool suite used two LNK-related exploits:\nCVE-2015-0096 and a second unidentified one.\n\nLNK-related vulnerabilities are an extremely powerful way to spread malware because they have the\npotential to allow code to execute without user interaction upon USB drive insertion in vulnerable systems.\nTable 2 shows that while only two such vulnerabilities have been confirmed as exploited in the wild,\nthey are not so uncommon: almost a dozen have been discovered and patched by Microsoft in the last\n10 years, 4 just in 2020.\n\nAdvisory date CVE Vulnerability name Exploited in the wild\n\nShortcut Icon Loading\n\nFanny, Stuxnet, Flame,\n\n2010-08-02 _[CVE-2010-2568](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-046)_ Vulnerability\n\nGauss, miniFlame\n\n(remote code execution)\n\nDLL Planting Remote Code\n2015-03-10 _[CVE-2015-0096](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2015/ms15-020)_ Brutal Kangaroo (suspected)\nExecution Vulnerability\n\nLNK Remote Code Execution\n2017-06-13 _[CVE-2017-8464](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-8464)_ `Blacksquid, Lucifer, etc.`\nVulnerability\n\nLNK Remote Code Execution\n2018-08-14 _[CVE-2018-8345](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2018-8345)_\nVulnerability\n\nLNK Remote Code Execution\n2018-08-14 _[CVE-2018-8346](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2018-8346)_\nVulnerability\n\nLNK Remote Code Execution\n2019-08-13 _[CVE-2019-1188](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2019-1188)_\nVulnerability\n\nLNK Remote Code Execution\n2019-09-10 _[CVE-2019-1280](https://msrc.microsoft.com/update-guide/en-us/vulnerability/CVE-2019-1280)_\nVulnerability\n\nLNK Remote Code Execution\n2020-03-10 _[CVE-2020-0684](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-0684)_\nVulnerability\n\nLNK Remote Code Execution\n2020-02-11 _[CVE-2020-0729](https://msrc.microsoft.com/update-guide/en-us/vulnerability/CVE-2020-0729)_\nVulnerability\n\nLNK Remote Code Execution\n2020-06-09 _[CVE-2020-1299](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-1299)_\nVulnerability\n\nLNK Remote Code Execution\n2020-07-14 _[CVE-2020-1421](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-1421)_\nVulnerability\n\nTable 2 // History of RCE vulnerabilities related to LNK files\n\nOverview of the “Stuxnet LNK exploit”\n\nThere is a common misconception that the vulnerability is in the LNK (Windows Shell Link aka “LNK”)\nfile format itself but it’s really not the case. Stuxnet’s LNK files are not malformed or crafted in a way that\nmake the Windows Shell parse the structure incorrectly and as a result execute shellcode (as is common\nwith other vulnerabilities, for example, the more recent case of CVE-2020-0684). Rather, it took advantage\nof an old feature of the Control Panel and a couple of design flaws that allowed it to load a DLL into\nthe Windows Explorer process.\n\nWhen Windows Explorer browses a folder containing LNK files, it opens them to read the metadata\nthat specifies where it should get the icon to display for the linked file. In the case of Stuxnet, it specifies\nthat the location of the target is the Control Panel and the icon should be loaded from a CPL file. Windows\nCPL files are DLL files with a different file extension and are expected to have an export called CPlApplet,\nwhich is the entry point for the Control Panel Applet.\n\n|Advisory date|CVE|Vulnerability name|Exploited in the wild|\n|---|---|---|---|\n|2010-08-02|CVE-2010-2568|Shortcut Icon Loading Vulnerability (remote code execution)|Fanny, Stuxnet, Flame, Gauss, miniFlame|\n|2015-03-10|CVE-2015-0096|DLL Planting Remote Code Execution Vulnerability|Brutal Kangaroo (suspected)|\n|2017-06-13|CVE-2017-8464|LNK Remote Code Execution Vulnerability|Blacksquid, Lucifer, etc.|\n|2018-08-14|CVE-2018-8345|LNK Remote Code Execution Vulnerability||\n|2018-08-14|CVE-2018-8346|LNK Remote Code Execution Vulnerability||\n|2019-08-13|CVE-2019-1188|LNK Remote Code Execution Vulnerability||\n|2019-09-10|CVE-2019-1280|LNK Remote Code Execution Vulnerability||\n|2020-03-10|CVE-2020-0684|LNK Remote Code Execution Vulnerability||\n|2020-02-11|CVE-2020-0729|LNK Remote Code Execution Vulnerability||\n|2020-06-09|CVE-2020-1299|LNK Remote Code Execution Vulnerability||\n|2020-07-14|CVE-2020-1421|LNK Remote Code Execution Vulnerability||\n\n\n-----\n\nFigure 9 shows the contents of Stuxnet’s LNK file, with highlighted metadata that specifies the location\nof the CPL file from which Explorer should obtain the icon to display.\n\nFigure 9 // Stuxnet’s malicious LNK file specifies a file with a .tmp extension as its icon source.\n\nThe code in the Windows shell that handled CPL files was flawed in the way that it dynamically loaded\nthe file using LoadLibraryW—which causes the execution of code—and then calls the CPlApplet export\nto initialize and request the needed item, and yet another problem is that the location of the CPL file was\nnot verified via the Windows registry at Software\\Microsoft\\Windows\\CurrentVersion\\Control\n```\nPanel\\Cpls nor were the entries in the MMCPL section of the Control.ini file for registered CPLs. \n\n```\nThis is how Stuxnet’s hidden DLL, ~WTR4141.TMP in the root of the USB drive, was executed automatically\nwhen the potential victim browsed the drive.\n\n##### Non-automated execution (unknowingly triggered)\n\nIn these scenarios, the execution of the malicious code depends on tricking an unsuspecting legitimate\nuser into executing the malicious code.\n\nUse of the AutoRun/AutoPlay Windows feature\n\nThis is an old (and very successful) execution vector that allowed several malware families to spread via\nUSB and network drives. While AutoRun has existed since Windows 95, the terms AutoRun and AutoPlay\nhad been used interchangeably until Windows XP when the two were differentiated:\n\n1. AutoRun was introduced in Windows 95 with the purpose of making it easier to trigger the automatic\n\nexecution of installers on CDs by following the instructions in a file named autorun.inf. This\n\nmechanism was also used when the user double-clicked on the drive’s shortcut in My Computer.\n\nIt was later enabled and extended in Windows XP to support other types of removable media such\n\nas USB drives and network drives by checking enabled types in the Windows registry.\n\n2. Although a primitive form of AutoPlay existed back in Windows 95 and 98, it was revamped in a new\n\nway to present the user with a pop-up window with a menu of options for easy access and automatic\n\nlaunching of files when a device was inserted.\n\n\n-----\n\nThese are the features abused by frameworks such as USBStealer and Agent.BTZ, as well as an earlier\nStuxnet version that implemented a Flame component that weaponized USB drives with a malicious\n```\nautorun.inf file (as seen in Figure 10) that contained both the Stuxnet executable and the AutoRun\n\n```\ninstructions. It disabled AutoPlay to force the user to go to My Computer or use the entry in the navigation\ntree of Windows Explorer; with shell32.dll it adds an additional command “Open” to the context menu\nthat will execute Stuxnet if the potential victim clicks on it or double-clicks on the drive shortcut.\n\nFigure 10 // Part of Stuxnet’s autorun.inf file,\n_[https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en](https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en)_\n\nFigure 11 shows how USBStealer uses more traditional instructions to achieve a similar effect but without\ndisabling AutoPlay:\n\nFigure 11 // USBStealer autorun.inf file contents.\n\nIn 2009 Microsoft released an update to disable the AutoRun functionality for media other than CDs and\nDVDs. Windows 7/8/8.1/10 AutoRun does not support the majority of instructions that allowed malicious\ncode to be executed through autorun.inf files, leading also to no more custom options in the AutoPlay\nwindow. Given these restrictions, some frameworks such as Stuxnet, Flame (and Gauss and miniFlame)\nswitched to the use of exploits.\n\nPlanting of malicious files\n\nAside from AutoRun/Autoplay, an attacker can plant a malicious executable or LNK file on the USB drive\nin a way to lure the user to execute them. Ramsay, for example, used a trojanized installer for 7zip, while\nUSBThief used DLL hijacking against the legitimate portable applications Firefox, Notepad++ and TrueCrypt.\nIt is worth mentioning that none of these frameworks have functionality or specific techniques to trojanize\nor hijack specific applications (as in the case of USBThief for example); in these particular cases all samples\nwere found with the technique already applied.\n\nUSBThief’s technique may also hide the malicious activity from security monitoring tools since the parent\nprocess executing the malicious DLL will be coming from a known executable.\n\nMustang Panda’s PlugX operates a bit differently, but require action to be taken by the user. The malware\nwould store a copy of itself on USB drives under the RECYCLE.BIN folder, hide all existing folders\nin the drive’s root and then create one LNK file for each hidden folder. Each LNK file would of course point\nto the malicious executable. This tactic would preserve the appearance of the clean drive and the malicious\ncode would be executed as soon as an unsuspecting user would try to enter one of the directories.\n\n\n-----\n\nFigure 12 // Example content of a USB drive prior to PlugX’s weaponization\n\nFigure 13 // Contents of the USB drive after PlugX’s weaponization\n\nLastly, attackers can also put malicious Office documents on USB drives. Ramsay for example used\ncustom-created malicious RTF documents exploiting two known vulnerabilities to install itself.\n\nRetro used a slightly different approach, scanning USB drives looking for existing Word documents\nand then converting them to RTF format with an exploit that triggers a script to copy the reconnaissance\ncomponent to the local drive and execute it. This technique is less likely to raise suspicion since the presence\nof documents on the USB drive would be expected.\n\n##### Non-automated execution (deliberately performed)\n\nThis case is similar to the previous technique; however, analysis indicates that the attackers did not intend\nfor an unsuspecting user of an air-gapped system to trigger the execution of the malware. Instead, they\nrelied on a human actor to deliberately launch the malware on the target systems.\n\nThe case of USBCulprit is a prime example of that, the malware is not directly accessible or visible to the\npotential victim, and there is no trigger mechanism, preventing accidental execution: from a compromised\nmachine, USBCulprit copies itself to a USB drive when a particular hidden file is found in a directory called\n```\n$Recyc1e.Bin created as a staging area for exfiltration of data.\n\n```\nIn other cases such as USBThief, the malware is deployed in a manner that support covert execution by a\nhuman actor: the attackers place in USB drives, portable versions of well-known software and use\ntechniques such as DLL hijacking or DLL side-loading to indirectly execute the malware in the target system.\n\nNon-automated execution\nAutomated execution\n(unknowingly triggered by the target)\nNon\nMalicious\n\nautomated\n\n`autorun.` Malicious\n\nexecution\n\n`inf` Malicious `autorun.`\n\nMalicious Trojanized/ Malicious (deliberately\n\ntriggering Office `inf`\n\nLNK automatic hijacked PE documents LNK manipulating performed)\n\n|Malicious LNK|Malicious autorun. inf triggering automatic execution (AutoRun)|Malicious Malicious autorun. Trojanized/ Malicious Office inf hijacked PE LNK documents manipulating AutoPlay|\n|---|---|---|\n\n|USBStealer|Col2|Col3|Col4|Col5|Col6|X|Col8|\n|---|---|---|---|---|---|---|---|\n|Agent.BTZ||||||X||\n|Stuxnet|X|||||X||\n|Fanny|X|||||||\n|miniFlame|X|||||||\n|Flame|X|||||X||\n\n\n-----\n\nNon-automated execution\nAutomated execution\n(unknowingly triggered by the target)\nNon\nMalicious\n\nautomated\n\n`autorun.` Malicious\n\nexecution\n\n`inf` Malicious `autorun.`\n\nMalicious Trojanized/ Malicious (deliberately\n\ntriggering Office `inf`\n\nLNK automatic hijacked PE documents LNK manipulating performed)\n\nexecution AutoPlay\n(AutoRun)\n\nX\n\nUSBFerry X\n\nUSBCulprit X\n\nX\n\nX\n\nOffline frameworks\n\nX\nProjectSauron\n_Hypothesis_\n\nEZCheese X X\n\nEmotional\nX\n\nUSBThief X X\n\nX X X\nKangaroo\n\nX X X\n\nTable 3 // Techniques used to compromise the first air-gapped system\n\n#### 4.3 Air-gapped side functionalities\n\n##### Persistence\n\nWhen it comes to persistence, these frameworks can be divided in two groups:\n\n1. Persistent: It’s designed to install and persist in new systems and continue collecting data for later\n\nexfiltration. Some of these frameworks present the capabilities to receive commands via covert\n\ncommunication channels and install or execute new components in the compromised system beyond\n\nexisting execution vectors in already compromised USB drives.\n\n2. Non-persistent: Designed for in-memory reconnaissance; collects information that is staged on the\n\nUSB drive for exfiltration.\n\nThere are no known special techniques designed for persistence in air-gapped machines. Once the malware\nis launched through its execution vector, it only depends on the capabilities of the malware that enable\nit to access powerful persistence methods. But from our research we can see that most of the frameworks\njust employ persistence based in the Windows registry to get executed at system startup or loaded when\na process is created via hijacking.\n\nNotable exceptions are Stuxnet and Fanny, that used zero-day exploits to elevate their privileges and persist\nby installing drivers; so too is the case of Flame, which registers itself as a Security Support Provider (SSP)\nauthentication package and gets loaded into critical system processes the next time the system boots.\n\n##### Reconnaissance and espionage activities\n\nOnce an attacker gains access to a new air-gapped system, reconnaissance and espionage activities\ncan be started\n\n|Col1|Automated|d execution|(unknowingly triggered by the target) Non-|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|Gauss|Malicious LNK X|Malicious autorun. inf triggering automatic execution (AutoRun)|Non- automated Malicious execution Malicious autorun. Trojanized/ Malicious (deliberately Office inf hijacked PE documents LNK manipulating performed) AutoPlay|||||\n|USBFerry||||||X||\n|USBCulprit|||||||X|\n|Retro||||X||||\n|PlugX X Offline frameworks X ProjectSauron Hypothesis||||||||\n|EZCheese|X||||||X|\n|Emotional Simian|X|||||||\n|USBThief|||X||||X|\n|Brutal Kangaroo|X|X|||||X|\n|Ramsay|||X|X|||X|\n\n\n-----\n\nAs we discussed earlier, attackers usually do not have direct control over which specific air-gapped system\nwill become compromised, as this largely depends on which system an unsuspecting user will connect\nthe malicious USB drive to. To address this and discover on what kind of system they are running, most\nframeworks perform some type of reconnaissance activities.\n\nHost-specific information gathering related to the system itself.\n\nFrameworks gather information such as computer name, username, domain name, list of running processes,\nlisting of files in directories, drives and network shares, as well as network configuration information that\ncan help the attacker plan for lateral movement. Some frameworks, for example USBFerry, USBCulprit,\nRetro and PlugX, simply pipe the output of built-in Windows commands (for instance, ipconfig or netstat)\nto a file that is exfiltrated to the attacker (see Detection opportunity #1: air-gapped side host reconnaissance\nactivity); other frameworks such as Flame, Stuxnet, and Gauss, perform their reconnaissance directly using\nthe Windows API, which could be considered stealthier than the former’s approach. In this sense, Gauss\nwent even one step further with its strategy:\n\n- Initially, the Gauss reconnaissance component, which is only deployed from USB drives, collected system\ninformation that, once exfiltrated to the attackers, could be used to prepare a special payload encrypted\nwith a key derived from a mix of system information that would be hard to match with any other system\nin the world. Think of it as a key derived from a fingerprint.\n\n- Once they have it prepared, they added it to the reconnaissance module and commanded Gauss\non the connected side to download it in the connected side machine. And the propagation process would\nstart again until it reached the system where it could be decrypted.\n\nThis strategy allowed the attackers to be extremely selective of which system in an air-gapped network\nthey would actually compromise and to have a payload that could only be decrypted by the unique targeted\nsystem. Researchers have tried millions of combinations to try to decrypt the payload and even have\nreleased to the public all the technical details needed to attempt breaking the encryption. So far, all attempts\nhave failed [6].\n\nActive network reconnaissance/probing\n\nWhile less common, some frameworks also have the capability to explore the network they are inside\nof with active measures—ones that generate network traffic. For example, USBFerry and USBCulprit used\nbuilt-in Windows commands such as tracert and ping to determine whether the system they are running\non has internet connectivity or not.\n\nRamsay used a much more aggressive approach by automatically scanning all IP addresses in the local\n[subnet and testing the discovered hosts to determine whether they are vulnerable to CVE-2017-0144,](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2017-0144)\nalso known as EternalBlue. Note that we have not seen any Ramsay component capable of exploiting\nthe vulnerability.\n\nMore details about these reconnaissance activities and how to detect them are described in the Defending\n_air-gapped networks section._\n\nEspionage activity\n\nIn several cases, the specific details of the framework’s espionage capabilities were fairly simple\nand straightforward for researchers to determine. USBStealer, USBCulprit, Retro, USBThief, PlugX\nand Ramsay, for example, were clearly built to steal specific files. The flexibility of this mechanism varied\nfrom one framework to another; some had a static list of file extensions hardcoded in the malware binary,\nwhile others had these dynamically provided via configuration files or other method.\n\nOnly Retro has the ability to take screenshots at regular intervals.\n\n\n-----\n\nFlame arguably had the most extensive information-stealing capabilities, being able to steal whole\ndocuments or metadata, images and GPS coordinates, technical CAD drawings and more. Symantec\nhas the best description for Flame’s data collection capabilities: “Even describing it as an industrial vacuum\ncleaner does not do it justice.” [7]\n\nIn other cases such as Gauss, details about espionage capabilities on the air-gapped side are uncertain\nor just simply unknown.\n\n##### Propagation to other hosts on the air-gapped side\n\nWe previously covered the various mechanisms used by the attackers to compromise an initial air-gapped\nsystem. Some frameworks also include spreading capabilities built right into the malware that’s running on\nthe air-gapped side to perform lateral movement and thus gain deeper access into the air-gapped network.\n\nThis aspect also varies widely from one framework to another. While older frameworks had ways\nto spread automatically using USB or network-based exploits, most recent ones rely on a human action\nto compromise additional systems.\n\nSurprisingly, a significant proportion of the frameworks have no spreading mechanism at all.\nThose that do use propagation techniques either based on USB drives or network connectivity inside\nthe air-gapped network are sometimes, but not always, the same techniques as those used to perform\nthe initial air-gapped system compromise.\n\nUSB drive-based propagation\n\nAs far as using USB drives to spread, the frameworks employed one of the five broad sub-techniques,\nwhere the malicious code would be copied to the drive along with some way for it to be launched.\n\nStuxnet, Fanny and Retro used exactly their respective techniques to spread inside\nthe air-gapped network as the one they used to penetrate the network in the first place.\n\nRamsay used something relatively similar to Retro, but instead of weaponizing existing Word documents,\nRamsay’s spreader component would trojanize all executable files found on all newly inserted USB drives,\nwaiting for a user to launch one of them.\n\nAgent.BTZ and USBStealer both used a trick more often used for the initial air-gapped system compromise,\nwhich is to place the malware on the USB drive alongside an autorun.inf.\n\nAs for USBCulprit, it is one very strange case. USBCulprit has the same code running on both the connected\nside and the air-gapped side, and so has the same ability to weaponize USB drives on both sides. As discussed previously, that mechanism consists of copying itself into a hidden folder on newly inserted USB\ndrives, without adding any mechanism to launch itself. We would thus assume that an insider would have\nto execute the file on purpose on other systems in order to spread the malware further, making\nit a partially automated propagation mechanism.\n\nNetwork-based propagation\n\nVery few frameworks have network-based propagation on the air-gapped side. Stuxnet was well known\nfor its use of CVE-2010-2729, the Windows Print Spooler RCE exploit. Flame used it as well and a unique\nmethod, never used by any other known malware, which was to perform a man-in-the-middle to intercept\nWindows Update traffic coming from air-gapped systems to spread malicious update components signed\nwith a forged but valid code-signing certificate.\n\nRamsay’s approach is far more primitive, as it trojanizes PE files on USB drives and network drives.\nWe could still imagine this technique being extremely effective when air-gapped systems have a mapped\ndrive pointing to a central file server containing the installation files for all the software allowed\nto be deployed within the air-gapped environment.\n\n\n-----\n\nUSB drive-based propagation\n\n\nNo built-in\npropagation\nmechanism\n\n\nPayload only Trojanized\n\nPayload + Payload + _(no execution_ Word Trojanized Network-based\nLNK exploit autorun.inf _mechanism)_ documents PE files propagation\n\n\nConnected frameworks\n\nX\n\nX\n\nX\n\nOffline frameworks\n\n|USBStealer|Col2|Col3|Col4|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|Agent.BTZ|||X|||||\n|Stuxnet||X|X||||X CVE-2010-2729 (Print Spooler RCE)|\n|Fanny||X||||||\n|Flame|||||||X Windows Update hijacking technique CVE-2010-2729 (Print Spooler RCE)|\n|miniFlame||X||||||\n|Gauss|X|||||||\n|USBFerry|X|||||||\n|USBCulprit||||X||||\n|Retro spreader plugin|||||X|||\n|Mustang Panda’s custom PlugX|X|||||||\n\n|ProjectSauron|X|Col3|Col4|Col5|Col6|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|EZCheeze|X|||||||\n|Emotional Simian|X|||||||\n|USBThief|X|||||||\n|Brutal Kangaroo|X|||||||\n|Ramsay||||||X|X (infection of PE files found on network shares)|\n\n\nTable 4 // Techniques used to spread within the air-gapped networks\n\n\n-----\n\n#### 4.4 Communication and exfiltration channel\n\nAt the beginning of this white paper, we clarified our definition of “air-gapped malware” and split\nair-gapped frameworks in two categories: connected and offline. The difference from the communication\nand exfiltration point of view is significant: online frameworks require an online, traditional C&C communication channel connecting the attacker to the connected-side compromised host, and an offline one\nconnecting the connected-side compromised host and the air-gapped systems, as shown in Figure 14.\nOn the other hand, Figure 15 shows how offline frameworks only require the latter.\n\nConnected side\n\n**7**\n\nOnline communication\n\nExfiltrate\n\nchannel\n\n**1** **8**\n\nInitial compromise Send further\n(spearphishing, commands\nwatering hole attack) Connected system C&C Server\n\n**13**\n\nExfiltrate\n\nWeaponize Extract Store commands Extract results\n**2** **6** **9** **12**\nUSB drives exfiltrated data to USB from USB\n\nOffline communication\n\nAir Gap channel\n\nUSB Drive\n\nCompromise Copy stolen Read commands Copy command\n\n**3** **5** **10** **11**\n\nair-gapped system information to USB and execute results to USB\n\n**4**\n\nPerform reconnaissance\nand information stealing Air-gapped _Connected bidirectional_\n\nsystem _communication channel_\n\nAir-gapped side\n\nFigure 14 // Online and offline communication channels in connected frameworks\n\n\n-----\n\nIn this section, we explore how both online and offline communication channels are implemented\nin known frameworks.\n\nAttacker\n\nOffline communication\nchannel\n\nWeaponize Extract Store commands Extract results\n\n**1** **5** **6** **9**\n\nUSB drives exfiltrated data to USB from USB\n\nAir Gap\n\nUSB Drive\n\nCompromise Copy stolen Read command Copy command\n\n**2** **4** **7** **8**\n\nair-gapped system information to USB and execute results to USB\n\n**3**\n\nPerform reconnaissance\nand information stealing Air-gapped _Connected bidirectional_\n\nsystem _communication channel_\n\nAir-gapped side\n\nFigure 15 // Offline communication channel in offline frameworks\n\n##### Online channels\n\nAkin to the techniques described in the Connected side section, the traditional online communication\nchannels in the connected frameworks we studied have no characteristics specific to attacking air-gapped\nnetworks. Techniques vary from one framework to another, just like when studying regular malware;\nthus we won’t focus too much on that part.\n\nIn general, we found that the level of sophistication and complexity of the online communication channel\nwere relatively on par with the overall sophistication level of the other parts of the frameworks themselves.\n\n##### Offline channels\n\nThe presence of an offline communication channel is the core part of our definition of what air-gapped\nmalware is. This is how the malware bypasses the air gap defense layer to transfer information in and out,\nor sometimes just out, of the target network.\n\nAn offline channel can be seen as a specific communication protocol running over a certain physical\ntransmission medium across the air gap.\n\n\n-----\n\nOne of the first things that comes to mind when talking about attacks against air-gapped networks\nis how the air gap can be bypassed. In fact, new research on covert physical transmission mediums is\npublished on a regular basis. One of the most prolific researchers in that domain is certainly Mordechai Guri,\nlead cybersecurity researcher at Ben-Gurion University of the Negev. He and his team have demonstrated\nthe feasibility of numerous techniques [8] [9] that allow information transfer across airgaps with various\nlevels of attack deployment complexity and available bandwidth.\n\nWhile there have been alleged sightings of in-the-wild attacks using such techniques[1], no peer-reviewed\ncase has been publicly analyzed and disclosed. Practically all the malicious frameworks targeting air-gapped\nnetworks publicly known to date used USB drives as the physical transmission medium to transfer information\nacross air gaps.\n\nLooking at the communication protocols developed by the various attackers, we can see a much broader\ndiversity of techniques.\n\nTable 5 illustrates how about half of the frameworks only implement unidirectional protocols. In these attack\nscenarios, the information can only flow from the compromised air-gapped system to the attacker, and not\nthe other way around. This means the malware component running on the air-gapped side does not have\nany update mechanism or backdoor capabilities: the attacker simply has no way at all to send updates\nor commands to control the compromised system.\n\nInstead, the malware components running on the air-gapped side are designed to perform specific, hardcoded\ntasks, usually reconnaissance and information stealing, and then exfiltrate the information back\nto the attacker via the USB drive.\n\nFrameworks implementing bidirectional protocols are more flexible, as they allow much better control\nover the compromised air-gapped hosts. Interestingly, not all frameworks make full use of this capability.\nIn fact, most implement only a small, not very flexible set of commands, such as steal files matching specific\npatterns or run a specific executable file present on the USB drive.\n\nProbably the most noteworthy exception is Ramsay, which has one of the most rich and flexible offline\ncommunication protocol. For one thing, commands can be issued to air-gapped compromised systems\nby planting a specially crafted control file either on a USB drive or on a network share that’s accessible\nto the target system. These files also contain a GUID, which allows the attacker to either restrict the\ncommands to a single, specific target, or to be “target agnostic” and recognizable by any system\ncompromised by Ramsay. This feature makes the most sense when the command file is distributed via a\nnetwork share. The protocol consists of only three commands, which is enough to be able to run anything\non the host: execute a file, load a dll, and run a batch file.\n\n1 _[https://en.wikipedia.org/wiki/BadBIOS](https://en.wikipedia.org/wiki/BadBIOS)_\n\n\n-----\n\nExfiltration only Command and response\n(unidirectional) (bidirectional)\n\n\nConnected framework\n\n|USBStealer|Col2|X|\n|---|---|---|\n|Agent.BTZ|X||\n|Stuxnet||X|\n|Fanny||X|\n|miniFlame|X||\n|Flame||X|\n|Gauss|X||\n|USBFerry|X||\n|USBCulprit||X|\n|Retro|X||\n|PlugX|X||\n\n|Col1|Offline framework|Col3|\n|---|---|---|\n|ProjectSauron|X||\n|EZCheese|X||\n|Emotional Simian||X|\n|USB Thief|X||\n|Brutal Kangaroo||X|\n|Ramsay||X|\n\n\nTable 5 // Types of offline communication protocols\n\nAnother thing to look at when studying offline channels is the way the information is encoded\non the USB drives. Once again, we see a wide variety of techniques, such as:\n\n- Files marked with hidden or system attribute\n\n- Information placed in hidden storage space, such as hidden virtual filesystems or at specific raw offsets\n\n- Information compressed in password-protected RAR archives\n\n- Information encrypted and appended to existing Word documents\n\n- Files stored in NTFS Alternate Data Stream (ADS)\n\nIn all cases, the idea is the same: prevent data leak detection and access to stolen information\nby a fourth party.\n\n\n-----\n\n### 5. DEFENDING AIR-GAPPED NETWORKS\n\nIt goes without saying that defending air-gapped networks against cyberattacks is a very complex topic\nthat involves several disciplines. It is far from our intention to claim that we have a magical solution to this\nproblem. That being said, there is value in understanding how known frameworks operate in air-gapped\nenvironments and deriving ways to detect and block common malicious activities.\n\nThis section presents ideas to detect and block malicious activities that are common to a significant portion\nof the studied frameworks. None of them are revolutionary, but we hope that our data-driven approach will\nhelp defenders prioritize their defense mechanisms. In other words, that defenders first implement defense\nmechanisms against what known malware has been doing so far, before trying to block techniques that\nhave not yet been used yet.\n\nFor example, defenders could decide to first properly defend against malicious LNK/autorun files—which\n70% of the frameworks have used either to compromise patient zero or to spread further within the airgapped network—before implementing TEMPEST[2] countermeasures to shield their network against computer emanations such as electromagnetic, sound or mechanical vibrations that, while absolutely possible,\nhave not been seen used in any framework so far.\n\n#### 5.1 Protection opportunity #1: prevent email access on connected hosts\n\nIn the connected side system compromise section, we have seen how several frameworks used connected\nside systems that are used in conjunction with air-gapped networks as the initial point of entry into targeted\nair-gapped networks. Naturally, those systems should be treated as such and hardened with strict\nsecurity measures.\n\nNot surprisingly, email is the most frequent technique used by attackers. Preventing direct access to emails\non connected systems would mitigate this execution vector. This could be implemented with browser/email\nisolation architecture, where all email activity is performed in a separate, isolated virtual environment.\n\n#### 5.2 Protection opportunity #2: disable USB ports on air-gapped systems\n\nPhysically removing or disabling USB ports on all the systems running in an air-gapped network is the\nultimate protection that would have prevented all the 17 frameworks to succeed. However, doing so comes\nwith an important usability drawback.\n\nWhile removing USB ports from all systems may not be acceptable for all organizations, it might still be\npossible to limit functional USB ports only to the systems that absolutely require it.\n\n#### 5.3 Protection opportunity #3: sanitize USB drives before insertion  in air-gapped systems\n\nWe’ve seen to what extent frameworks abuse USB drives to execute malicious code on air-gapped systems.\nA USB drive sanitization process performed before any USB drive gets inserted into air-gapped system could\ndisrupt many of the techniques implemented by the studied frameworks.\n\nImagine a quarantine system into which users of the air-gapped network would connect any USB drive\nbefore insertion into the air-gapped system and that would automatically sanitize the drive. This would not\nprevent deliberate human action, but would still cover a significant portion of the attack scenarios.\n\n##### Remove all LNK and autorun.inf files from USB drives\n\nTable 6 shows which frameworks use USB drives loaded with either a malicious LNK or autorun file to compromise isolated systems or to propagate further. In total, 13 out of 17 frameworks could have been thwarted by\nthe simple removal of those two file types from USB drives before they got inserted in any air-gapped system.\n\n2 Telecommunications Electronics Materials Protected from Emanating Spurious Transmissions (TEMPEST)\n\n_[https://en.wikipedia.org/wiki/Tempest_(codename)](https://en.wikipedia.org/wiki/Tempest_(codename))_\n\n\n-----\n\nMalicious\nFramework Malicious LNK\n```\n                     autorun.inf\n\n```\n\nConnected framework\n\n|USBStealer|Col2|X|\n|---|---|---|\n|Agent.BTZ||X|\n|Stuxnet|X|X|\n|Fanny|X||\n|miniFlame|X||\n|Flame|X|X|\n|Gauss|X||\n|USBFerry||X|\n|USBCulprit|||\n|Retro|||\n|PlugX X Offline framework ProjectSauron|||\n|EZCheese|X||\n|Emotional Simian|X||\n|USBThief|||\n|Brutal Kangaroo|X|X|\n|Ramsay|||\n\n\nTable 6 // Frameworks using malicious LNK and autorun.inf files\n\nIn fact, the history of critical RCE vulnerabilities related to LNK files that have been patched by Microsoft\nin the last 10 years, as shown in table 2, speaks for itself: if LNK files on USB drives are not absolutely needed\nin an air-gapped network, they should be removed before they reach sensitive systems.\n\n##### Perform a malware scan\n\nEven with LNK and autorun.inf files gone, some frameworks would still pose a threat in a different\nway. Retro, for example, weaponized USB drives with malicious Office documents containing n-day exploits,\nRamsay relies on trojanized executable files. Systematically scanning, on the connected side, all USB drives\nwith an up-to-date antimalware product would provide a baseline layer of protection before the files get\nto the air-gapped side.\n\n\n-----\n\n#### 5.4 Protection opportunity #4: restrict file execution on removable drives\n\nSeveral techniques used to compromise air-gapped systems end up with the straight execution\nof an executable file stored somewhere on the disk, which could be prevented by configuring the relevant\nRemovable Storage Access policies as shown on Figure 16 on all air-gapped systems.\n\nFigure 16 // Window policies to control Removable Storage Access\n\nImplementing application whitelisting would also prevent Ramsay’s propagation mechanism that infected\nexecutable files found on network drives.\n\n#### 5.5 Protection opportunity #5: maintain air-gapped systems updated\n\nSeveral frameworks have used exploits against Windows or Microsoft Office either to perform the initial\ncompromise of an air-gapped system or to spread further in the isolated network. Table 7 shows a summary\nof all the exploits seen used on the air-gapped side. It also shows how often n-day exploits were used.\n\nHad the target systems been fully patched, the attacker’s task to succeed with their attacks would have\nbeen more difficult, forcing them either to develop or acquire suitable zero-day exploits or to use alternate,\nless efficient techniques.\n\nIt is also worth noting that endpoint security products are generally able to detect and block several exploit\nclasses (network- and file-based, for example), so having such technology not only deployed but also kept\nup to date could have had a positive impact.\n\nIt is frequently reported that air-gapped systems are outdated because, by definition, they are air-gapped\nand thus can’t reach update servers. If that really is the case, could it be possible that maintaining a full air\ngap causes more security issues and actually could be harmful? We do not have an answer to that complex\ntopic, but seeing how many n-day exploits are used against air-gapped networks, it is a possibility\nthat should be considered by air-gapped network administrators.\n\nFor example, an air gap could be partially broken to allow dual-homed update servers such\nas Windows Server Update Services (WSUS) or an endpoint security update mirror server, to maintain\nall other air-gapped systems fully updated.\n\n\n-----\n\nAlternatively, it is possible to deploy air-gapped update servers, although manual operations are required\nto regularly import the update data into the air-gapped side. For example, Microsoft supports a dual WSUS\nsetup to service a disconnected network[3], in which the administrators are required to manually transfer\nthe new updates from the connected WSUS instance to the air-gapped one via a removable drive.\n\nThat being said, we have to keep in mind that Flame actually managed to spread via Windows Update [10].\nHowever, no other similar cases have been reported so far.\n\nZero day One day\n\n|Col1|Connected framework|Col3|\n|---|---|---|\n|USBStealer|||\n|Agent.BTZ|||\n|Stuxnet|CVE-2010-2568 (LNK RCE) CVE-2010-2729 (Print Spooler RCE) CVE-2010-2743 (Keyboard layout EoP) CVE-2010-3338 (Task Scheduler EoP) CVE-2010-2772 (hardcoded password in Siemens Simatic WinCC)|CVE-2006-3439 (RPC RCE) CVE-2008-4250 (RPC RCE)|\n|Fanny|CVE-2010-2568 (LNK RCE) MS09-025 (EoP)||\n|miniFlame||CVE-2010-2568 (LNK RCE)|\n|Flame||CVE-2010-2568 (LNK RCE) CVE-2010-2729 (Print Spooler RCE)|\n|Gauss||CVE-2010-2568 (LNK RCE)|\n|USBFerry|||\n|USBCulprit|||\n|Retro||CVE-2017-8570 (Microsoft Office RCE)|\n|PlugX|||\n\n\nOffline framework\n\n|ProjectSauron|Col2|Col3|\n|---|---|---|\n\n\nUse of an unspecified LNK exploit. It is not known whether the vulnerability was exploited\nEZCheese\nbefore or after a patch was released.\n\nEmotional Simian\n\nUSBThief\n\n_[CVE-2015-0096 (LNK RCE)](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2015/ms15-020)_\n\nBrutal Kangaroo\n\n+ a second unidentified exploit\n\n_[CVE-2017-0199 (Microsoft Office/](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2017-0199)_\n\nRamsay WordPad RCE)\n\n_[CVE-2017-11882 (Microsoft Office RCE)](https://msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)_\n\nTable 7 // Use of exploits inside the air-gapped sides (usage on the connected side excluded)\n\n3 _[https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd939873(v=ws.10)](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd939873(v=ws.10))_\n\n|EZCheese|Use of an unspecified LNK exploit. It is not know before or after a patch was released.|wn whether the vulnerability was exploited|\n|---|---|---|\n|Emotional Simian|||\n|USBThief|||\n|Brutal Kangaroo|CVE-2015-0096 (LNK RCE) + a second unidentified exploit||\n|Ramsay||CVE-2017-0199 (Microsoft Office/ WordPad RCE) CVE-2017-11882 (Microsoft Office RCE)|\n\n\n-----\n\n#### 5.6 Detection opportunity #1: air-gapped side host reconnaissance activity\n\nSome frameworks use Windows commands to perform their reconnaissance activities. This activity can\nbe caught easily by various methods. For example, systems can be configured to generate audit events\nwhen processes are created[4] and their logs monitored[5] to detect the execution of specific processes.\n\nFor example, Table 8 could be used as a base to build a reconnaissance-specific Sigma rule[6]. The detection\nof such activity inside an air-gapped network would be highly suspicious.\n\nReconnaissance activity performed by Flame, Stuxnet or Gauss, however, could not be detected this way.\n\nCommand USBFerry USBCulprit Retro plug-in PlugX\n\n`tasklist` (no arg) `/v` `/v`\n`systeminfo` (no arg) (no arg)\n`hostname` (no arg)\nipconfig `/all` `/all` `/all` `/all`\n```\n arp -a -a -a -a\n netstat -ano -aon -ano -ano\n nbtstat -n\n route Print print\n sc query wlansvc\n\n```\nqll, profiles,\n```\n netsh wlan show interface, net                                   works mode=Bssid\n\n```\nTable 8 // Commands and parameters issued to perform reconnaissance on air-gapped systems\n\n#### 5.7 Detection opportunity #2: air-gapped side network-based  reconnaissance activity\n\nOnly a minority of frameworks have active network reconnaissance activity that would generate actual\nnetwork traffic.\n\nSuch activity generated by USBFerry and USBCulprit could be detected on the compromised host directly\nusing the same technique described in the previous section.\n\nCommand USBFerry USBCulprit\n\nping `-n 1 <various hosts>` [google.com](http://google.com)\n```\n tracert -h 8 <some local addresses>\n            view, view /domain, use, user, user\n\n```\n`net` administrator, share, localgroup `view`\n```\n            administrators\n\n```\nTable 9 // Active network reconnaissance activity via Windows commands\n\nDetecting the presence of Ramsay mass scanning of the entire local subnet for hosts vulnerable to EternalBlue could be done in several ways. For example, a properly updated host-based IDS on all hosts would raise\nthe relevant alerts and point directly to the host running Ramsay.\n\n4 _[https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-process-creation](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-process-creation)_\n\n5 _[https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4688#security-monitoring-recommendations)_\n_[event-4688#security-monitoring-recommendations](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4688#security-monitoring-recommendations)_\n\n6 _[https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/)_\n_win_susp_commands_recon_activity.yml_\n\n|Command|USBFerry|USBCulprit|Retro plug-in|PlugX|\n|---|---|---|---|---|\n|tasklist|(no arg)|/v|/v||\n|systeminfo|||(no arg)|(no arg)|\n|hostname|(no arg)||||\n|ipconfig|/all|/all|/all|/all|\n|arp|-a|-a|-a|-a|\n|netstat|-ano|-aon|-ano|-ano|\n|nbtstat|-n||||\n|route|Print||print||\n|sc|||query wlansvc||\n|netsh wlan show|||qll, profiles, interface, net- works mode=Bssid||\n\n|Command|USBFerry|USBCulprit|\n|---|---|---|\n|ping|-n 1 <various hosts>|google.com|\n|tracert|-h 8 <some local addresses>||\n|net|view, view /domain, use, user, user administrator, share, localgroup administrators|view|\n\n\n-----\n\n### 6. CONCLUSION\n\nWe have seen how the frameworks can be split into two categories: connected frameworks, which\nare operated fully remotely, and offline frameworks, which rely on a human asset on the ground. Despite\nthe use of various techniques to breach the initial air-gapped system, to propagate inside the network\nor to exfiltrate stolen information, all the frameworks share one common goal: spy on their target.\n\nDiscovering and analyzing this type of framework poses unique challenges. They sometimes are composed\nof multiple components that all have to be analyzed together in order to have the complete picture of how\nthe attacks are really being carried out.\n\nAlso, security vendors such as ESET rely on telemetry to discover new threats on systems where their\nproducts are running. By definition, systems running within air-gapped networks do not send such\ntelemetry, which creates a significant blind spot that contributes to increasing the time to discovery\nand detection of new malware targeting air-gapped networks.\n\nUnderstanding how malware attacks air-gapped networks can help identify and prioritize detection\nand protection mechanisms. For example, we saw how all frameworks relied on USB drives one way\nor the other to spy on air-gapped systems, and none of them used any other type of covert communication\nchannels against which TEMPEST restrictions would need to be implemented[7].\n\nWe also saw how the various offline frameworks work and how they all rely one way or another on human\nassets on the ground to operate, which can impact an organization’s threat model.\n\nWe will continue to monitor further developments in this very niche malware category to help defenders\nprotect their networks.\n\n_For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset com._\n\n7 _[https://www.sans.org/reading-room/whitepapers/privacy/introduction-tempest-981](https://www.sans.org/reading-room/whitepapers/privacy/introduction-tempest-981)_\n\n\n-----\n\n### 7. REFERENCES\n\n1. [Unknown, “Intellipedia—Air Gapped Network Threats,” 24 01 2019. [Online]. Available: https://theintercept.](https://theintercept.com/document/2019/01/24/intellipedia-air-gapped-network-threats/)\n\n_[com/document/2019/01/24/intellipedia-air-gapped-network-threats/. [Accessed 02 05 2021].](https://theintercept.com/document/2019/01/24/intellipedia-air-gapped-network-threats/)_\n\n2. A. Gostev, “Agent.btz: a Source of Inspiration?,” 12 03 2014. [Online].\n\n[Available: https://securelist.com/agent-btz-a-source-of-inspiration/58551/. [Accessed 02 05 2021].](https://securelist.com/agent-btz-a-source-of-inspiration/58551/)\n\n3. J. Calvet, “Sednit Espionage Group Attacking Air Gapped Networks,” [Online].\n\n[Available: https://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/.](https://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/)\n\n[Accessed 26 04 2021].\n\n4. Tencent, “Advanced threats: Ramsay malware’s attack technology analysis against isolated networks,”\n\n[28 05 2020. [Online]. Available: https://s.tencent.com/research/report/1000.html. [Accessed 02 05 2021].](https://s.tencent.com/research/report/1000.html)\n\n5. Global Research and Analysis Team, “A Fanny Equation: “I am your father, Stuxnet”,” Kaspersky,\n\n[17 02 2015. [Online]. Available: https://securelist.com/a-fanny-equation-i-am-your-father-stuxnet/68787/.](https://securelist.com/a-fanny-equation-i-am-your-father-stuxnet/68787/)\n\n[Accessed 01 05 2021].\n\n6. Global Research and Analysis Team, “The Mystery of the Encrypted Gauss Payload,” Kaspersky,\n\n[14 08 2012. [Online]. Available: https://securelist.com/the-mystery-of-the-encrypted-gauss-payload-5/33561/.](https://securelist.com/the-mystery-of-the-encrypted-gauss-payload-5/33561/)\n\n[Accessed 02 05 2021].\n\n7. A. L. Johnson, “W32.Flamer: Enormous Data Collection,” Symantec, 06 04 2012. [Online]. Available:\n\n_[https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=c354d3e9-5e2d-4a08-91e9-fd85e193ef62&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)_\n\n_[viewdocument?DocumentKey=c354d3e9-5e2d-4a08-91e9-fd85e193ef62&CommunityKey=1ecf5f55-9545-44d6-](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=c354d3e9-5e2d-4a08-91e9-fd85e193ef62&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)_\n\n_[b0f4-4e4a7f5f5e68&tab=librarydocuments. [Accessed 26 04 2021].](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=c354d3e9-5e2d-4a08-91e9-fd85e193ef62&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)_\n\n8. M. Guri, “The Air-Gap Jumpers,” Ben-Gurion University of the Negev, 08 08 2018. [Online].\n\n[Available: https://i.blackhat.com/us-18/Wed-August-8/us-18-Guri-AirGap.pdf. [Accessed 03 05 2021].](https://i.blackhat.com/us-18/Wed-August-8/us-18-Guri-AirGap.pdf)\n\n9. M. Guri, “Exfiltrating data from air-gapped computers via ViBrAtIoNs,” Future Generation Computer Systems,\n\nvol. 122, no. September 2021, pp. 69-81, 2021.\n\n10. A. Gostev, “‘Gadget’ in the middle: Flame malware spreading vector identified,” Kaspersky, 04 06\n\n[2012. [Online]. Available: https://securelist.com/gadget-in-the-middle-flame-malware-spreading-vector-](https://securelist.com/gadget-in-the-middle-flame-malware-spreading-vector-identified/33081/)\n\n_[identified/33081/. [Accessed 26 04 2021].](https://securelist.com/gadget-in-the-middle-flame-malware-spreading-vector-identified/33081/)_\n\n11. Global Research and Analysis Team, “THE PROJECTSAURON APT,” Kaspersky, 09 08 2016. [Online].\n\n[Available: https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07190154/](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07190154/The-ProjectSauron-APT_research_KL.pdf)\n\n_[The-ProjectSauron-APT_research_KL.pdf. [Accessed 26 04 2021].](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07190154/The-ProjectSauron-APT_research_KL.pdf)_\n\n\n-----\n\n### 8. APPENDIX 1: CONNECTED FRAMEWORKS OVERVIEW\n\nThose are the frameworks that have been found in the wild, that match our definition of “air-gapped\nmalware” and whose analysis has been made public. We included these IdentityKits as direct references\nto provide a per-framework overview of their functionalities. Consult their respective references for all\nthe technical details.\n\nIt is important to note that except for the frameworks originally discovered and documented by ESET,\nthe vast majority of the information found in this paper originated from third parties, who deserve\nall the credit for their research.\n\n#### 8.1 IdentityKit #1: USBStealer\n\n##### Threat actor Sednit\n\n Period of operation\n2005–2015 (discovery: 2014-11-11)\n\n##### Purpose and targets\nPerform espionage against governmental institutions in Eastern Europe.\n\n##### References\n2014-11-1, Sednit Espionage Group Attacking Air‑Gapped Networks,\n[ESET (https://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/)](https://www.welivesecurity.com/2014/11/11/sednit-espionage-group-attacking-air-gapped-networks/)\n\n##### Characteristics\n\n Connected side execution vector\n\n- Suspected classic spearphishing.\n\n##### Air-gapped side execution vector\n\n- From connected side, USBStealer persisted as a service named “USB Disk Security” or via Run key.\n\n- Monitored for the arrival of new USB drives, and weaponized them by copying USBStealer and an\n```\n autorun.inf file.\n\n```\n- Created desktop.in file—to signal that the machine had internet access—in the System Volume\n\nInformation directory of the USB drive.\n\n##### Communication channel\n\n- Connected side: Unknown.\n\n- Air-gapped side:\n\n  - USBStealer created a file named after the computer name and .in as file extension; the file was\n\nused to receive commands from the connected side compromised machines. Additionally, if the file\n```\n  desktop.in was found in System Volume Information directory, it recorded the Hardware ID of\n\n```\nthe USB drive and track of it.\n\n  - Commands included: copy file to drive, copy files matching pattern, execute program, exfiltrate\n\ndata from all drives, search for files and save results to USB drive, and more.\n\n##### Air-gapped side basic functionalities\n\n- Persistence: Attempted to register itself as a service named “USBGuard”, but if when it failed then\n\nWindows Registry run key was used instead.\n\n\n-----\n\n- Reconnaissance and Espionage:\n\n  - The second time an interesting USB drive visited the compromised host, USBStealer would copy all\n\nthe files from its local storage to the drive, with a particular interest in files with extensions .skr\n\nand .pkr from PGP Desktop cryptography software, and .key—possibly from another related type\n\nof software. USBStealer also had a list of files to search, they were different in some samples but\n\ninclude unknown files such as: Win32Negah.dll, Ssders.dat, Settings.dat, audit.dat, key.\n```\n  in, key.out, z_box.exe and others.\n\n```\n  - When the file with the commands was found, it executed them sequentially. If one of them failed,\n\nthe files were copied into a local storage and attempted to copy them to the next drive that was\n\ninserted.\n\n##### Propagation\n\n- No propagation on the air-gapped side. USB drives were only weaponized on the connected side.\n\n#### 8.2 IdentityKit #2: Agent.BTZ\n\n##### Threat actor Unclassified\n\n Period of operation\nBegan in 2007, but it spread out of control for several years.\n\n##### Purpose and targets\nUS Military, with a long list of collateral victims because of its uncontrolled worm capabilities. Russia was the\ntop affected country for several years.\n\n##### References\n\n- 2008-11-28, Pentagon computer networks attacked, LA Times\n\n[(https://www.latimes.com/archives/la-xpm-2008-nov-28-na-cyberattack28-story.html)](https://www.latimes.com/archives/la-xpm-2008-nov-28-na-cyberattack28-story.html)\n\n- 2008-11-30, Agent.btz—A Threat That Hit Pentagon, ThreatExpert\n\n[(http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html)](http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html)\n\n##### Characteristics\n\n Connected and air-gapped side execution vector\n\n- Used an autorun.inf file with a command to execute rundll32.exe to load a malicious DLL from\n\nthe USB drive.\n\n##### Communication channel\n\n- Connected side: Connected via HTTP to two C&C servers from where it downloaded a .jpg file that\n\ncontained malicious code that was injected into Internet Explorer.\n\n- Air-gapped side\n\n - When a new USB drive was inserted, it attempted to copy the file %windir%\\Sys```\n  tem32\\1055cf76.tmp to the drive as thumb.db. It is believed that the file was downloaded or\n\n```\ncreated by another component downloaded from the C&C servers. When the USB drive had a file\n\nnamed thumb.db, Agent.BTZ copied it to the %windir%\\System32 directory, executed it and then\n\ndeleted the original from the drive.\n\n - When the USB drive had a file named thumb.db, it was copied to the %windir%\\System32 direc\ntory with the name mysysmgr.ocx.\n\n  - Then Agent.BTZ appended the existing thumb.db file with a package of CAB files that contained\n\nthe logs and information collected from the system. If the file did not exist, it was created.\n\n\n-----\n\n##### Air-gapped side basic functionalities\n\n- Persistence: Copied itself as a DLL file to %windir%\\System32 with a name generated from local files\n\nand registered it as an In-Process Server that would get it loaded into explorer.exe.\n\n- Reconnaissance: Collected system and network information in XML format in an encrypted file.\n\nInformation included: paths to special system directories, user and computer name, directory listings,\n\nand network information such as IP, gateway, WINS, DHCP and DNS servers.\n\n- Propagation: Monitored for the insertion of USB drives and when they were not already affected, it\n\ncreated an autorun.inf file and copied itself as a DLL along with the files described in the air-gapped\n\nside communication channel.\n\n##### Discussion\n\nAgent.BTZ, along with USBStealer and Fanny, is a textbook case of a framework designed for air-gapped\nnetwork reconnaissance: it was capable of persisting, collecting information and logging its activities, as\nwell as exfiltrating all this data and extracting new code to execute in compromised machines.\n\nThe difference is that Agent.BTZ had been made with an unlimited worming capability that allowed it to\nspread far and wide, indiscriminately. In one infamous incident it managed to access air-gapped side networks at the Department of Defense of the United States, classifying it as a significant threat to classified\nnetworks, according to leaked documents.\n\n#### 8.3 IdentityKit #3: Stuxnet\n\n##### Threat actor Unclassified\n\n Period of operation\nStuxnet 0.5: 2007-2009\nStuxnet 1.0: 2009-2012\n\n##### Purpose and targets\nTelemetry indicates that Stuxnet patient zero was located in Iran, where most of the compromised systems\nwhere registered. It is widely believed that Stuxnet was made for a sabotage operation of Iran’s nuclear\nprogram. However, Stuxnet at some point started spreading outside of its intended region, reaching several\ncountries in other continents.\n\n##### References\n\n- Stuxnet 1.0:\n\n - 2010-09-30, W32.Stuxnet Dossier, Symantec\n\n[(https://docs broadcom com/doc/security-response-w32-stuxnet-dossier-11-en)](https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en)\n\n - 2011-01-04 Stuxnet under the microscope, ESET\n\n[(https://www welivesecurity com/wp-content/uploads/2012/11/Stuxnet_Under_the_Microscope pdf)](https://www.welivesecurity.com/wp-content/uploads/2012/11/Stuxnet_Under_the_Microscope.pdf)\n\n- Stuxnet 0.5:\n\n  - 2013-02-26, Stuxnet 0.5: The Missing Link, Symantec\n\n[(https://docs broadcom com/doc/stuxnet-missing-link-13-en)](https://docs.broadcom.com/doc/stuxnet-missing-link-13-en)\n\n##### Characteristics\n\n Connected side execution vector\n\n- Unknown although presumably:\n\n  - Human asset with physical access to the air-gapped network (AGN) would plug a USB drive\n\ncontaining Stuxnet.\n\n\n-----\n\n - Starting from connected side compromised machines by an unknown malware framework or\n\nexploit. There is evidence of this given the compilation times of some of the samples, which include\n\nreconnaissance data saved by Stuxnet itself in its own file: this data indicates a short period of time\n\nfrom compilation to initial compromise, too short to be prepared and handed to a human asset;\n\ntherefore it’s believed it was compiled and transferred via internet to compromised machines.\n\n- Malicious LNK files exploiting vulnerability CVE-2010-2568.\n\n- Malicious autorun.inf file that contains Stuxnet and shell32.dll command trick.\n\n- Windows Print Spooler Service vulnerability MS10-061.\n\n- Windows Server Service vulnerability MS08-067.\n\n- Infected Siemens Simatic Step7 project files using exploit for vulnerability CVE-2012-3015. Stuxnet also\n\nhad the capability to update older versions of itself in infected project files.\n\n- Vulnerable WinCC machines with database software that contained a hardcoded password made it\n\npossible to inject Stuxnet in the database and execute it.\n\n- Propagation to network shares using scheduled jobs and Windows Management Instrumentation.\n\n##### Air-gapped side execution vector\n\n- Same as for the connected side.\n\n##### Communication channel\n\n- Connected side: Connected via HTTP to two C&C servers where it would get a new configuration to\n\nupdate in its main DLL, and a new binary to load in its own process or a remote process. The same\n\nchannel was used by Stuxnet to exfiltrate collected information.\n\n- Air-gapped side: Stuxnet had no covert communication channel based on USB drive; however, infor\nmation collected from the system was appended to the configuration block of its main DLL, and when\n\nit reached a machine on the connected side it would upload it to its C&C servers.\n\n- Stuxnet was able to communicate with other instances running on the same network\n\nin one of two ways:\n\n  - Windows Mailslots (in version 0.5).\n\n  - Windows Remote Procedure Call (in version 1.0).\n\n- Via these two mechanisms, Stuxnet was able to update itself, or older versions running on other\n\nmachines, as well as send modules for execution.\n\n##### Air-gapped side functionalities\n\n- Persistence: Exploited two EOP vulnerabilities: MS10-073 and Task Scheduler vulnerability. Then\n\ninstalled two drivers:\n\n  - Rootkit: Installed as a service, would hide Stuxnet files in USB drives.\n\n  - Load point: Installed as a service and loaded by Windows’ boot process, it injected Stuxnet into a\n\nlist of processes. Interestingly, one entry in the list was a file (module) to be loaded into explorer.\n```\n  exe, but the file was not created by Stuxnet.\n\n```\n- Reconnaissance: Collected system information (such as computer name, OS version, domain name,\n\ntime, IP address) and information about Simatic Step 7 software and project paths; the information\n\nwas appended to its configuration block forming a log of systems that Stuxnet had compromised. The\n\ninformation was sent via HTTP to its C&C servers in connected side machines.\n\n- Propagation in air-gapped network: As previously listed in execution vectors.\n\n\n-----\n\n##### Discussion\nStuxnet’s ultimate purpose was not exclusively espionage, as in all the frameworks here described, it was\ndesigned to reach computers using WinCC and Step 7 software to attack PLC devices. Stuxnet did this by\nreplacing one of the original Step 7 DLLs that communicated with the PLC; the fake DLL intercepts send/\nreceive requests and it is able to inject code and hide its presence, like a rootkit. The code injected into the\nPLC was designed for sabotage.\n\n#### 8.4 IdentityKit #4: Fanny\n\n##### Threat actor Equation Group\n\n Period of operation\n2008–2012\n\n##### Purpose\nPerforms reconnaissance and espionage against unknown entities in Pakistan, Indonesia, Vietnam,\nand China.\n\n##### References\n\n- 2015-02-16, Equation: The Death Star of Malware Galaxy, Kaspersky\n\n[(https://securelist.com/equation-the-death-star-of-malware-galaxy/68750)](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750)\n\n- 2015-02-17, A Fanny Equation: “I am your father, Stuxnet”, Kaspersky\n\n[(https://securelist.com/a-fanny-equation-i-am-your-father-stuxnet/68787/)](https://securelist.com/a-fanny-equation-i-am-your-father-stuxnet/68787/)\n\n##### Characteristics\n\n Connected side execution vector\n\n- Unknown. Possibly deployed by another backdoor.\n\n##### Air-gapped side execution vector\n\n- Malicious LNK files exploited CVE-2010-2568 in USB drives.\n\n##### Communication channel\n\n- Connected side: In compromised systems with Internet access: contacted two C&C servers via HTTP\n\nand would receive commands to relay, exfiltrate collected data, or download a fully-featured trojan—\n\nusually DoubleFantasy.\n\n- Air-gapped side: Covert communication channel via hidden storage space on USB drives allowed\n\nFanny to receive commands.\n\n##### Air-gapped side functionalities\n\n- Persistence: Exploited MS09-025 to elevate its privileges to install a driver for persistence.\n\n- Reconnaissance: Collected system information (OS information, list of processes, user and computer\n\nname, etc.).\n\n- Propagation in air-gapped network:\n\n  - Monitored registry changes to detect the insertion of new devices that matched USB drives and\n\nscanned their filesystems when they were FAT16 and FAT32 to find hidden storage space. When\n\nfound, it would check for new commands that included updating its configuration and copy local files\n\nto the drive for exfiltration, copy a DLL to %TEMP% folder and load it, or load a DLL from the USB drive.\n\n\n-----\n\n  - When the USB drive was not affected, it created a hidden storage space and planted the LNK files\n\nthat exploited CVE-2010-2568 to execute a malicious DLL to install Fanny on the system. The\n\nhidden storage space was created by changing the hint value that indicates where to look for\n\navailable sectors, and created an invalid entry in the FAT directory: a combination of attributes\n\nunrecognized by Windows made it ignore it. The descriptor of the invalid entry contains a magic\n\nvalue as directory name, random data and the offset to the hidden storage space; looking for the\n\nmagic value is how Fanny finds its storage space.\n\n##### Espionage\n\n- Would copy specific files and stage them together with information of systems for later exfiltration\n\nwhen a USB drive was connected.\n\n##### Discussion\nFanny was one of oldest frameworks to compromise air-gapped networks, however: sporting two powerful\nzero day exploits at the time, driver, rootkit to hide its files, and a hidden storage space altering the filesystem of the drive for a covert communication channel and exfiltration point, made it one of the most sophisticated frameworks on this whitepaper. Indeed, some APTs seem to have learned from Fanny’s design.\n\n#### 8.5 IdentityKit #5: miniFlame\n\n##### Threat actor Unclassified\nDeveloped by the same factory as Flame and Gauss\n\n##### Period of operation\n2009–2012\n\n##### Purpose\nPerform reconnaissance and espionage against unknown entities in Iran, Sudan, Palestine, Saudi Arabia,\nQatar, Lebanon, France, and the United States.\n\n##### References\n\n- 2012-10-15, miniFlame aka SPE: “Elvis and his friends”, Kaspersky\n\n[(https://securelist.com/miniflame-aka-spe-elvis-and-his-friends/68560)](https://securelist.com/miniflame-aka-spe-elvis-and-his-friends/68560)\n\n##### Characteristics\n\n Connected side execution vector\n\n- Both components were downloaded by miniFlame when a requested was issued\n\nby command of the attackers. There components were:\n\n  - `icsvntu32.ocx: performed the weaponization of USB drives. On the connected side, it was`\n\ninstalled in %windir%\\System32 and persisted using a COM hijack via the Windows registry.\n\n  - `petsec.sys: was launched from USB drives and performed reconnaissance.`\n\n##### Air-gapped side execution vector\n\n- In connected side, icsvntu32.ocx collected information about USB drives and logged it. When a\n\nnew USB drive was inserted and was not affected, it created the file .thumbs.db that included a TTL\n\ncounter that limits the times the reconnaissance component would be launched: when the limit was\n\nreached, the drive is cleaned from all malicious content. petsec.sys was decrypted and written to\n\nthe root of the drive as CatRoot.tmp or System32.dat, then it created all the necessary files and\n\ndirectories for the malicious LNK files that exploited CVE-2010-2568 and the junction point directories,\n\nthat would launch the reconnaissance component.\n\n\n-----\n\n##### Communication channel\n\n- Connected side: miniFlame contacted its C&C servers via HTTP; the number of servers varied in each\n\nsample. Some of the servers were shared with Flame and its C&C framework was able to handle the\n\ncommunication protocols for Flame and Gauss as well. The collected information during reconnais\nsance were uploaded to the servers.\n\n- Air-gapped side: No communication channel. Only exfiltration of collected information\n\nduring reconnaissance.\n\n##### Air-gapped side functionalities\n\n- Persistence: petsec.sys did not persist on the system.\n\n- Propagation: Had no propagation on the air-gapped side. USB drives are only weaponized on the\n\nconnected side.\n\n- Reconnaissance:\n\n  - Collected information (such as computer name, OS version, platform type, network adapters, ARP\n\ntable, processes and its modules, listing of files in root directories and network drives (with a max\n\nlimit of files set at 200), network shares) and appended it to the .thumbs.db file on the USB drive.\n\n - Marked system as compromised by leaving a value in the Windows registry.\n\n - The component also checked the TTL value in .thumbs.db and when it reached zero, the drive was\n\ncleaned from all malicious content but the .thumbs.db file was left in it.\n\n#### 8.6 IdentityKit #6: Flame\n\n##### Threat actor Unclassified\nDeveloped by the same factory as miniFlame and Gauss\n\n##### Period of operation\n\n- Flame 1.0: 2010–2012\n\n- Flame 2.0: 2014–2016\n\n##### Purpose\nPerform extensive espionage operations against unknown entities in Iran, Palestine, Sudan and Syria, among\nother countries.\n\n##### References\n\n- Flame 1.0: 2012-28-04, The Flame: Questions and Answers, Kaspersky\n\n[(https://securelist.com/the-flame-questions-and-answers/34344/)](https://securelist.com/the-flame-questions-and-answers/34344/)\n\n- Flame 2.0 2019-14-04, Who is GOSSIPGIRL?, Chronicle Security\n\n[(https://medium.com/chronicle-blog/who-is-gossipgirl-3b4170f846c0)](https://medium.com/chronicle-blog/who-is-gossipgirl-3b4170f846c0)\n\n- 2012-06-04, ‘Gadget’ in the middle: Flame malware spreading vector identified, Kaspersky\n\n[(https://securelist.com/gadget-in-the-middle-flame-malware-spreading-vector-identified/33081/)](https://securelist.com/gadget-in-the-middle-flame-malware-spreading-vector-identified/33081/)\n\n##### Characteristics\n\n Connected side execution vector\n\n- Unknown. It is suspected that attackers used an exploit for MS10-033 vulnerability, but\n\nremains unconfirmed.\n\n##### Air-gapped side execution vector\n\n- USB thumb drives:\n\n - File autorun.inf that contained the malware and shell32.dll trick to maximized the chances\n\nof execution by a potential victim. Same as Stuxnet.\n\n\n-----\n\n  - Malicious LNK files exploited CVE-2010-2568 with junction point directories, same as Stuxnet but\n\nimproved exploit.\n\n- Flame’s local network spreading capabilities might have enabled it to spread on AGN via:\n\n  - Fake updates signed with forged but valid certificates and delivered via Windows\n\nUpdate interception.\n\n - MS10-061 Windows Print Spooler exploit.\n\n - Remote Scheduled Tasks.\n\n  - If Flame had administrative rights on the domain controller, it created backdoor user accounts that\n\nwould be used to copy itself to remote machines.\n\n##### Communication channel\n\n- Connected side: Contacted C&C web servers via HTTP with SSL. Flame had a large list of domains,\n\nwith one sample using up to 11 domains to contact its C&C servers.\n\n- Air-gapped side: Covert communication channel used an encrypted database in a hidden file in the\n\nUSB drive.\n\n##### Air-gapped side functionalities\n\n- Persistence: Flame installed itself in the Windows registry as an authentication package; in the next\n\nsystem boot it was automatically loaded by lsass.exe.\n\n- Reconnaissance: Flame collected a wide range of system and network information as well as whole\n\ndocuments or metadata, images and GPS coordinates, technical CAD drawings and more.\n\n- Propagation: In systems with no connectivity Flame monitored for the arrival of USB drives; if the\n\ndevice had not been weaponized, it created the file HUB001.dat, which contained a database with all\n\nthe collected information, and created all the necessary files and directories to exploit CVE-2010-2568,\n\nor, in older versions, created an autorun.inf file. Flame implemented a special trick to use HUB001.dat\n\nas a covert communication channel: in USB drives with FAT filesystem, it renamed HUB001.dat to “.”, an\n\ninvalid name that is ignored by Windows when parsing the contents of the filesystem, thus\n\nmaking it “invisible”.\n\n- If the drive was weaponized, Flame forwarded its collected information to the existing database and\n\nlooked for components whose version was higher to update itself. The database also contained a TTL\n\nvalue, when it reached the limit, the contents of the database were stored on the local system and the\n\ndrive was cleaned.\n\n#### 8.7 IdentityKit #7: Gauss\n\n##### Threat actor Unclassified\nDeveloped by the same factory as Flame and miniFlame\n\n##### Period of operation\n2011-2012\n\n##### Purpose\nPerform reconnaissance and espionage against unknown entities in Lebanon, Israel, Palestine, the United\nStates, and other countries.\n\n##### References\n\n- 2012-09-08, Gauss: Abnormal Distribution, Kaspersky\n\n[(https://securelist.com/gauss-abnormal-distribution/36620)](https://securelist.com/gauss-abnormal-distribution/36620)\n\n\n-----\n\n##### Characteristics\nGauss was very similar to miniFlame in its strategy to perform reconnaissance of air-gapped networks.\nThere were two components: one to weaponize USB drives (called Kurt or Godel) and a special payload that\nperformed collection of information when a new host was reached. In the IdentityKit for miniFlame we\ndescribed those modules rather than miniFlame as a whole because they were downloaded and\nthe component in charge of weaponizing USB drives persisted in the system and worked independently of\nminiFlame; however, in Gauss the respective component did not persist and was loaded by the orchestrator.\nThis is an important distinction between the implementation of Gauss and miniFlame.\n\n##### Connected side execution vector\n\n- Unknown.\n\n##### Air-gapped side execution vector\n\n- On the connected side, the Kurt/Goldel component monitored for the arrival of new USB drives by\n\nquerying the Windows registry. When a new drive was inserted, it created the malicious LNK files that\n\nexploited CVE-2010-2568, and a file named .thumbs.db. The payloads System32.dat (for 32-bit\n\nsystem) and System32.bin (for 64-bit system) were extracted from dskapi.ocx resources 100 and\n\n101 and written to the USB drive.\n\n- To check whether the USB drive was already affected it looked for the .thumbs.db file, and if it\n\nmatched the expected format, it was copied to local storage and later exfiltrated to its C&C servers,\n\nthe USB drive was cleaned from all malicious content and weaponized again.\n\n##### Communication channel\n\n- Connected side: Gauss contacted its C&C servers via HTTPS, and collected reconnaissance results were\n\nuploaded.\n\n- Air-gapped side: No communication channel. Only exfiltration of collected information\n\nduring reconnaissance.\n\n##### Air-gapped side functionalities\n\n- Persistence: Although the payload was copied to the local %TEMP% directory and reloaded from there,\n\nit did not persist on the host.\n\n- Reconnaissance:\n\n  - It collected system and network information (OS version, workstation information, network\n\nadapters, routing table, process list, environment variables and disk information, network shares,\n\nnetwork proxy, MS SQL servers, URL cache.\n\n  - Collected information was encrypted and appended to the .thumbs.db file. It also checked the TTL\n\nvalue contained there and when it reached the limit, the USB drive was cleaned from all malicious\n\ncontent, leaving only the .thumbs.db file.\n\n  - Gauss payloads contained special sections that were decrypted using a key generated by a complex\n\nalgorithm that used data collected from a previous reconnaissance pass. When the system was\n\nreached again and the conditions matched to generate the key, the contents of the sections were\n\ndecrypted with RC4 algorithm and executed.\n\n- Propagation: No propagation in air-gapped side. USB drives were only weaponized in connected side.\n\n##### Discussion\nGauss payloads are an interesting case because now we have an example of one of the purposes behind the\napproach of slowly mapping and surveying the systems in the air-gapped network: with the information\ncollected, the attackers are able to encrypt a payload that only can be decrypted on specific computers.\nGiven the complexity of generating such a password, it hasn’t been possible to decrypt the contents of the\n[sections in the payloads. Read more about it here: The Mystery of the Encrypted Gauss Payload.](https://securelist.com/the-mystery-of-the-encrypted-gauss-payload-5/33561/)\n\n\n-----\n\n#### 8.8 IdentityKit #8: USBFerry\n\n##### Threat actor Tropic Trooper\n\n Period of operation\nDecember 2014–May 2020 (at least)\n\n##### Purpose\nSteal defense—and maritime—related documents from government, military and navy institutions and\nnational banks in Taiwan and the Philippines.\n\n##### References\n\n- 2020-05-12, Tropic Trooper’s Back: USBferry Attack Targets Air-gapped Environments, Trend Micro\n\n[(https://documents.trendmicro.com/assets/Tech-Brief-Tropic-Trooper-s-Back-USBferry-Attack-Targets-Air-](https://documents.trendmicro.com/assets/Tech-Brief-Tropic-Trooper-s-Back-USBferry-Attack-Targets-Air-gapped-Environments.pdf)\n\n_[gapped-Environments.pdf)](https://documents.trendmicro.com/assets/Tech-Brief-Tropic-Trooper-s-Back-USBferry-Attack-Targets-Air-gapped-Environments.pdf)_\n\n##### Characteristics\n\n Connected side execution vector\n\n- Malicious software installer sent via email.\n\n##### Air-gapped side execution vector\n\n- The malware component that was running on a connected system would place USBferry and an\n```\n autorun.inf file on newly inserted USB drives. This execution vector would not work on recent\n\n```\nWindows systems with AutoRun/AutoPlay disabled.\n\n##### Communication channel\n\n- Connected side: Contacted C&C servers via HTTP.\n\n- Air-gapped side: No commands, just automatic exfiltration of documents straight to USB drives.\n\n##### Air-gapped side functionalities\n\n- Persistence: Registered itself as a Winlogon helper DLL in Windows registry in Shell subkey[8].\n\n- Reconnaissance and espionage:\n\n - Automated host reconnaissance based mostly on built-in Windows commands (ipconfig, net view,\n\narp, netstat, net share, tracert). Obtained host network configuration and connectivity capability,\n\nlimited attempt to get network topology (using ping and tracert) and volume information.\n\n  - Copied files to USB drives and monitored when the files were last written to, so as to update them\n\nto their latest versions.\n\n- Propagation: The same as described in air-gapped side execution vector.\n\n8 _[https://attack.mitre.org/techniques/T1547/004/](https://attack.mitre.org/techniques/T1547/004/)_\n\n\n-----\n\n#### 8.9 IdentityKit #9: USBCulprit\n\n##### Threat actor Cycldek/Goblin Panda/Conimes\n\n Period of operation\n2014-2019\n\n##### Purpose\nSteal documents and network information of compromised computers from government organizations\nacross several Southeast Asian countries, mostly Vietnam, Thailand and Laos.\n\n##### References\n\n- 2020-06-03, Cycldek: Bridging the (air) gap, Kaspersky\n\n[(https://securelist.com/cycldek-bridging-the-air-gap/97157/)](https://securelist.com/cycldek-bridging-the-air-gap/97157/)\n\n##### Characteristics\n\n Connected side execution vector\n\n- Seen downloaded by RedCore malware.\n\n##### Air-gapped execution vector\n\n- USBStealer copied itself to a USB drive when a file named 2.txt was found on the drive from the\n\nconnected side or air-gapped side, but no execution vector was created or copied. Suspected human\n\nfactor required to execute the malware on the air-gapped side.\n\n##### Communication channel\n\n- Connected side: Unknown. Possibly performed via RedCore.\n\n- Air-gapped side: Primitive mechanism: the presence of a particular file (for example, 1.txt) on the\n\nUSB drive indicated whether USBCulprit should do something.\n\n##### Air-gapped side basic functionalities\n\n- Persistence: Registered itself in Windows registry Run key.\n\n- Reconnaissance and espionage:\n\n - Some variants had host network reconnaissance functionality using built-in Windows commands\n\n(ipconfig, ping, arp, net view, nbtstat, tasklist).\n\n - Searches for files with extension *.pdf;*.doc;*.wps;*docx;*ppt;*.xls;*.xlsx;*.pptx;\n```\n  *.rtf from hardcoded list of directories. The files were grouped and archived in a password-pro\n```\ntected RAR file and copied to the USB drive only if no 1.txt ws found in the drive, when it’s found,\n\nUSBCulprit expected to find an archive of exfiltrated documents in $Recyc1e.Bin folder and made\n\na local copy.\n\n  - Ability to execute arbitrary files on newly inserted USB drive (update the malware, add\n\nfunctionalities).\n\n- Propagation: Selective partial propagation: USBCulprit only weaponized a USB drive when file 2.txt\n\nwas found on it.\n\n\n-----\n\n#### 8.10 IdentityKit #10: Retro\n\n##### Threat actor DarkHotel\n\n Period of operation\n2017\n\n##### Purpose\nPerform espionage and mapping of air-gapped networks of unknown entities.\n\n##### References\n\n- 2018-04-23, The latest APT organization “parasitic beast” activity disclosure, Tencent\n\n[(https://s.tencent.com/research/report/465.html)](https://s.tencent.com/research/report/465.html)\n\n- 2020-05-28, Advanced threats: Ramsay malware’s attack technology analysis against isolated\n\n[networks, Tencent (https://s.tencent.com/research/report/1000.html)](https://s.tencent.com/research/report/1000.html)\n\n##### Characteristics\n\n Connected side execution vector\n\n- Spearphishing with decoy document that exploited CVE-2017-11882.\n\n##### Air-gapped side execution vector\n\n- In connected side: plug-in infsvc.exe monitored for the arrival of USB drives to find and convert\n\nsuitable Word documents into RTF format and added an RCE exploit for CVE-2017-8570 to execute a\n\nreconnaissance component that was copied to the %TEMP% folder in the local machine.\n\n##### Communication channel\n\n- Connected side: Unknown.\n\n- Air-gapped side: No communication with the attackers. Only exfiltration of files.\n\n##### Air-gapped side basic functionalities\n\n- Persistence: Unknown.\n\n- Reconnaissance and espionage:\n\n - When executed in USB drives, the reconnaissance component was copied to the local %TEMP% as\n```\n  taskhost.exe. It collected system and network configuration information using Windows built-in\n\n```\ncommands with the output redirected to a .rtt file on the local machine; commands included\n\nsysteminfo, tasklist, netstat, ipconfig, netsh, and more.\n\n  - Created a listing of all directories and files in the system and saved it to its respective .rtt file.\n\n  - Took a screenshot every five minutes and saved them as .jpg files, then encrypted it and stored in\n\nthe another local storage folder.\n\n  - When all the information was collected, it abused WinRAR to create a compressed archive of\n\neverything in its local storage folders.\n\n  - Monitored for the arrival of USB drives and copied the archive to the drive’s offset 1000000000\n\nwith a magic value. It would later be extracted back in the computer that was running Retro with\n\nits infsvc.exe plug-in.\n\n- Propagation: None.\n\n\n-----\n\n#### 8.11 IdentityKit #11: PlugX\n\n##### Threat actor Mustang Panda\n\n Period of operation\n2018-2020\n\n##### Purpose\nPerform espionage against unknown entities in Hong Kong, Vietnam, Australia and China (according to\nAvira), with more specific targets identified by Anomali based on the decoy documents.\n\n##### References\n\n- 2019-10-07, China-Based APT Mustang Panda Targets Minority Groups, Pub\n[lic and Private Sector Organizations, Anomali (https://www.anomali.com/blog/](https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations)\n\n_[china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations)](https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations)_\n\n- 2020-01-31, New wave of PlugX targets Hong Kong, Avira\n\n[(https://www.avira.com/en/blog/new-wave-of-plugx-targets-hong-kong).](https://www.avira.com/en/blog/new-wave-of-plugx-targets-hong-kong)\n\n\n_NOTE: Both reports analyzed the same operation, but Avira is the first to have analyzed the component_\n_built to target air-gapped networks. Hence, we consider the Avira report as the date of discovery._\n\n\n##### Characteristics\n\n Connected side execution vector\n\n- Spearphishing emails with ZIP files that contained a multistage loading mechanism that ultimately\n\ninstalled the malware and a decoy document.\n\n##### Air-gapped side execution vector\n\n- PlugX monitored for the arrival of USB drives and weaponized them by creating a hidden folder called\n```\n RECYCLE.BIN where it copied its files. In the root of the drive it created LNK files with interesting\n\n```\nnames to entice the user into launching them.\n\n##### Communication channel\n\n- Connected side: Contacted its C&C servers via HTTP.\n\n- Air-gapped side: No communication with the attackers. Only for exfiltration of collected information.\n\n##### Air-gapped side basic functionalities\n\n- Persistence: Registers itself in Windows registry Run key.\n\n- Reconnaissance and Espionage:\n\n  - When PlugX detected that it is on a system with no internet connectivity, it activated its air\ngapped mode. Tried to find the USB drive from where it was executed and dropped a BAT file that\n\ncontained commands to log information about the system and network (some commands include\n\nipconfig, netstat, arp, tasklist, systeminfo); output was directed to files on the USB drive.\n\n - It searched the entire system for documents (.doc, .docx, .ppt, .pptx, .xls, .xlsx,\n```\n  .pdf) and copied them to the USB drive and encrypted them with RC4. In some versions it could\n\n```\nalso do this by abusing WinRAR software to have the program create an archive and instruct it to\n\nsearch and compress all of the files in a given directory.\n\n- Propagation: Same as air-gapped side execution vector.\n\n##### Discussion\nPlugX is a malware that is used independently by different groups. Only Mustang Panda has customized it\nwith capabilities to attack air-gapped networks.\n\n\n-----\n\n### 9. APPENDIX 2: OFFLINE/HUMAN ASSET  FRAMEWORKS OVERVIEW\n\nWith the development of new technologies, our visibility into nation-state efforts grew as their operations\nexpanded and grew exponentially, allowing the research community to discover and document some of the\nmost sophisticated frameworks to date where air-gapped malware is only one component of a large toolkit\ndesigned for seemingly boundless collection of intelligence.\n\nThe Vault7 document leaks opened a window into the development branches that create these\ntypes of capabilities; from these documents we learned about their so-called “implants”. Some have\nbeen found and documented publicly but in many cases we couldn’t match them to any malware samples\nin our collections.\n\nWe decided to include in this paper IdentityKits of a particular set of documented tools from the Vault7\nleaks, to refresh our knowledge and to describe the potential threat these tools could pose to air-gapped\nnetworks, if ever put in the hands of capable attackers. One exception among these special cases\nis ProjectSauron: a sophisticated toolkit employed by an unknown threat actor, reported\nand documented by Kaspersky, that includes exfiltration capabilities inside AGNs.\n\n#### 9.1 IdentityKit #12: ProjectSauron\n\n##### Threat actor Unclassified\n\n Period of operation\n2011–2016\n\n##### Purpose and targets\n\n Perform espionage against\n\n- Kaspersky Telemetry: Government, scientific research centers, military, telecommunication providers, and\n\nfinance in Russia, Iran, Rwanda and possibly in Italian-speaking countries as well.\n\n- Symantec Telemetry: Individuals located in Russia, an airline in China, an organization in Sweden, and\n\nan embassy in Belgium.\n\n##### References\n\n- 2016-08-08, ProjectSauron: top level cyber-espionage platform covertly extracts encrypted\n\n[government comms, Kaspersky (https://securelist.com/faq-the-projectsauron-apt/75533/)](https://securelist.com/faq-the-projectsauron-apt/75533/)\n\n- 2016-08-08, Strider: Cyberespionage group turns eye of Sauron on targets, Symantec\n\n[(https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=ce2df4da-afe9-4a24-b28c-0fb3ba671d95&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\n\n_[viewdocument?DocumentKey=ce2df4da-afe9-4a24-b28c-0fb3ba671d95&CommunityKey=1ecf5f55-9545-44d6-b](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=ce2df4da-afe9-4a24-b28c-0fb3ba671d95&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)_\n\n_[0f4-4e4a7f5f5e68&tab=librarydocuments)](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=ce2df4da-afe9-4a24-b28c-0fb3ba671d95&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)_\n\n##### Characteristics\n\n ProjectSauron is a special case, as we only know of one component for the air-gapped side\n\n- MyTrampoline: A plug-in that, when loaded, waited for the arrival of USB thumb drives to search after\n\nthe its first partition for a shadow filesystem where MyTrampoline stages the files that were prepared\n\nfor exfiltration in a local storage folder; files were also extracted from the shadow filesystem and\n\ncopied to the local storage. MyTrampoline had no capabilities to weaponize USB drives.\n\n- The shadow filesystem was placed after the first partition with folders for “in” and “out” where files\n\nwere staged for exfiltration and extraction by MyTrampoline. As far as we know, there were no special\n\nfiles containing commands or new blobs to be executed.\n\n\n-----\n\n##### We only know one component that we suspect would be used on the connected side\n\n- Online Pusher v2: collected the files in the local storage that were extracted by MyTrampoline and\n\nexfiltrated them to a server that worked as a “vault”, or repository for stolen information.\n\nHowever, we are missing the component that would weaponize USB thumb drives, meaning that we don’t\nknow what was the execution vector that enabled ProjectSauron to go from the connected to the air-gapped\nside and persist a special configuration that collected files and launched MyTrampoline. Unlike the case of\nFlame or Gauss, no component has been found that checked when a certain limit was reached to clean USB\ndrives, as to not continue compromising more machines and risk an escape à la Stuxnet.\n\n#### 9.2 IdentityKit #13: EZCheese\n\n##### Source Vault7 Leaks—Wikileaks in 2017\n\n Period\n(Estimated) 2013–2016\n\n##### Purpose\nPerform espionage against unknown entities.\n\n##### References\n\n- _[https://wikileaks.org/vault7/document/EzCheese-v6_3-User_Guide_Rev__2014-01-07/EzCheese-v6_3-Us-](https://wikileaks.org/vault7/document/EzCheese-v6_3-User_Guide_Rev__2014-01-07/EzCheese-v6_3-User_Guide_Rev__2014-01-07.pdf)_\n\n_[er_Guide_Rev__2014-01-07.pdf](https://wikileaks.org/vault7/document/EzCheese-v6_3-User_Guide_Rev__2014-01-07/EzCheese-v6_3-User_Guide_Rev__2014-01-07.pdf)_\n\n##### Characteristics\nEZCheese was a tool to perform espionage by preparing a USB drive with LNK files that contained an exploit\nas execution vector and a reconnaissance DLL component. It was intended for operations with an asset on\nthe ground to manually plug in the USB drive and navigate to the folder where the LNK files were located\nwith execution happening automatically.\n\n##### Connected side execution vector\n\n- Unknown.\n\n##### Air-gapped side execution vector: Giraffe exploit\n\n- Windows XP SP3, Windows Vista, Windows 7 and Windows 8 LNK exploit. At the time when the\n\ndocument was written, the vulnerability had been patched.\n\n##### Communication channel\n\n- Air-gapped side: No commands, just automatic exfiltration of documents straight to USB drives.\n\n##### Air-gapped side basic functionality\n\n- Persistence: No persistence mechanism.\n\n- Reconnaissance and espionage:\n\n  - EZCheese reconnaissance component had the ability to collect information about the operating\n\nsystem, BIOS, user accounts, installed applications, computer information, services and processes,\n\ndirectory listings, perform WMI queries, query Windows registry, and collect files in the system or\n\nspecific folders.\n\n- Propagation: No propagation mechanism.\n\n\n-----\n\n#### 9.3 IdentityKit #14: Emotional Simian\n\n##### Source Vault7 Leaks—Wikileaks in 2017\n\n Period of operation\nStarting in 2013\n\n##### Purpose\nEspionage.\n\n##### References\n\n- _[https://wikileaks.org/vault7/document/Emotional_Simian-v2_3-User_Guide/Emotional_Simian-v2_3-Us-](https://wikileaks.org/vault7/document/Emotional_Simian-v2_3-User_Guide/Emotional_Simian-v2_3-User_Guide.pdf)_\n\n_[er_Guide.pdf](https://wikileaks.org/vault7/document/Emotional_Simian-v2_3-User_Guide/Emotional_Simian-v2_3-User_Guide.pdf)_\n\n##### Characteristics\n\n Connected side execution vector\n\n- Deployable by means of another implant installed on the system.\n\n##### Air-gapped side execution vector\n\n- On the connected side an implant “server” is installed (with an unknown persistence mechanism) that\n\nmonitors for the arrival of whitelisted USB drives to weaponize them with LNK files used to load the\n\npayload DLL. It’s unknown if those LNK files exploit any vulnerability as in the case of EZCheese.\n\n- Whitelisted drives are a set of USB drives known to the operator. It’s likely that there\n\nis a component on the connected side, on a machine previously compromised by another implant, that\n\ncollects information about USB drives and their drive serial number, the information is then used to\n\nconFigure commands for the “server” component in the compromised machine.\n\n##### Communication channel\n\n- Air-gapped side: Covert communication channel hidden in USB thumb drives, described as a “covert\n\npartition” but no further information about it.\n\n##### Air-gapped side basic functionalities\n\n- Persistence: Unknown mechanism.\n\n- Reconnaissance: Payload collects BIOS and computer information, installed applications, OS informa\ntion, processes, services, user accounts, devices, directory listings, and various types of files.\n\n- Propagation: None.\n\n#### 9.4 IdentityKit #15: USBThief\n\n##### Threat actor Unclassified\n\n Period of operation (estimation)\n2014-2015\n\n##### Purpose\nCollect a wide range of system and network information and steal documents from unknown entities in\nCôte d’Ivoire.\n\n##### References\n\n- 2016-23-03, New self‑protecting USB trojan able to avoid detection, ESET\n\n[(https://www.welivesecurity.com/2016/03/23/new-self-protecting-usb-trojan-able-to-avoid-detection)](https://www.welivesecurity.com/2016/03/23/new-self-protecting-usb-trojan-able-to-avoid-detection)\n\n\n-----\n\n##### Characteristics\n\n Connected side execution vector\n\n- Unknown.\n\n##### Air-gapped side execution vector\n\n- Hijacked portable applications (Firefox, Notepad++ and TrueCrypt) placed on USB drives.\n\n##### Communication channel\n\n- Connected side: Unknown.\n\n- Air-gapped side: No communication channel with the attackers. Only exfiltration of collected\n\ninformation.\n\n##### Air-gapped side basic functionalities\n\n- Persistence: None.\n\n- Reconnaissance:\n\n  - When the first loader of USBThief was executed through a hijacked application, a multistage load\ning began until the final payload was loaded and injected into the process svchost.exe. USBThief’s\n\nloading mechanism had been designed to make it difficult to recover and decrypt its next stages;\n\none interesting technique that it used was encrypting one of the stages with an AES key derived\n\nfrom the USB drive Volume Serial Number.\n\n  - The payload collected extensive system information including the entire Windows registry tree\n\nfrom HKCU root key, a listing of all files in all directories, several types of documents and images.\n\nMany more capabilities were enabled through an open source library called WinAudit.\n\n  - All the collected information was stored encrypted on the USB drive.\n\n- Propagation: None.\n\n##### Discussion\nUSBThief is one of the most interesting cases among all the frameworks described here. Following the Vault7\n[leaks, many people (including at ESET) have been theorizing that USBThief, first known approximately a year](https://twitter.com/cherepanov74/status/839801380491702272)\nbefore the leak, could be the program called Rainmaker that is described in the Vault7 documents. However, we now think that USBThief shares more similarities with another program called Margarita.\n\nFrom the documentation of Rainmaker, we know it was designed to hijack the popular media player\nsoftware VLC by placing a manifest file with a Side-by-Side assembly to force Windows to load psapi.dll\nfrom the current directory where VLC is running (on the USB drive). The Rainmaker Stub DLL will be loaded\ninstead and it will redirect the API used by VLC to the real psapi.dll and decrypt the information stealer\nDLL component and load it into memory with its own custom loader.\n\nThe documentation states that it’s decrypted with AES algorithm and a key generated from the USB drive’s\nassigned Volume Serial Number. This description matches how USBThief’s 2[nd] stage loads the DLL of its 3[rd]\nstage which in turns loads the payload (as seen in Figure 17). But this is also where the strong similarities end:\nRainmaker is designed to collect documents from certain paths and store then in an Alternate Data Stream\nfolder.\n\n\n-----\n\nFigure 17 // Illustration of USBThief’s multistaged loading process\n_[Source: https://www.welivesecurity.com/2016/03/23/new-self-protecting-](https://www.welivesecurity.com/2016/03/23/new-self-protecting-)_\n_usb-trojan-able-to-avoid-detection/_\n\nMargarita, on the other hand, supports at least three selectable execution vectors, one of which is called\nOpenBar, described as a collection of techniques to trojanize portable applications. Margarita’s information\nstealer component contains an extensive list of capabilities that match that of USBThief. Collected data is\nstaged in .dat files and the folder’s naming format displayed in screenshots of Margarita’s configuration\nsoftware also matches what was seen in USBThief’s configuration files.\n\nRainmaker and Margarita describe a malicious program and concept of operation in which a human asset is\nin charge of the covert execution of malicious code with espionage capabilities. With USBThief we can\nconclude that these capabilities have been deployed in the real world by a nation-state actor and with a\nmeasure of success given Margarita was developed at least in 2011 and newer tools for new missions were\ndeveloped at least until 2016.\n\n#### 9.5 IdentityKit #16: Brutal Kangaroo\n\n##### Source Vault7 Leaks—Wikileaks in 2017\n\n Period of operation\nStarting in 2016.\n\n##### Purpose\nEspionage\n\n##### References\n\n- _https://wikileaks.org/vault7/#Brutal%20Kangaroo_\n\n- _https://wikileaks.org/vault7/document/#brutalkangaroo_\n\n- _[https://wikileaks.org/vault7/document/Shadow-v1_0-User_Guide_2012-08-31/](https://wikileaks.org/vault7/document/Shadow-v1_0-User_Guide_2012-08-31/Shadow-v1_0-User_Guide_2012-08-31.pdf)_\n\n\n-----\n\n##### Characteristics\nBrutal Kangaroo is a tool that enables collection of intelligence in a target system or network. Its operator\ncan weaponize the drive and conFigure its execution vectors as well as the payloads to perform a survey of\nthe system or execute implant payloads such as Shadow: a persistent implant to be installed to covertly\ncollect information for an extended period of time and exfiltrate it through prepared USB drives that have a\nhidden storage space. Shadow is also capable of receiving commands to exfiltrate certain specific files or\ncollect files by matching patterns.\n\nBrutal Kangaroo was a newer development that deprecated other similar tools and implants such as\nEZCheese and Emotional Simian.\n\n##### Connected side execution vector\n\n- Unknown\n\n##### Air-gapped side execution vector\n\n- EZCheese (Giraffe Links): Windows XP SP3, Windows Vista, Windows 7 and Windows 8 LNK exploit. At\n\nthe time when the document was written, the vulnerability had been patched.\n\n- Okabi Links: Windows 7 autorun.inf with LNK files exploit (CVE-2015-0096).\n\n- RiverJack Links: Windows 7, Windows 8 and Windows 8.1 exploit using junctions, library-ms\n\nand LNK files.\n\n- Direct execution.\n\n##### Communication channel\n\n- Air-gapped side:\n\n - Shadow: Covert communication channel hidden in USB thumb drives. The operator can create a\n\nnew set of commands and payloads for a specific Shadow implant in the AGN network, or for all\n\nimplants. It’s received from connected side and handled by the Shadow components that relays the\n\ncommands via USB drive channel.\n\n##### Air-gapped side basic functionalities\n\n- Persistence:\n\n  - Brutal Kangaroo payloads don’t persist in the compromised system.\n\n  - Shadow implant persists in the system as a service.\n\n##### Reconnaissance\n\n- Brutal Kangaroo: The suite includes a set of payloads designed for collection of information, with the\n\nfollowing capabilities:\n\n - System survey.\n\n  - Directory listing of removable drives, fixed drives, remote drives, CD drives.\n\n  - Collect files by pattern with rules on exclusion of folder, maximum or minimum size, or by creation/\n\naccess/modification time.\n\n  - Survey of USB drives in the system.\n\n- Payload stage collects information via one of three selectable methods:\n\n - NTFS Alternate Data Stream.\n\n  - Writes data to a (new) file in the drive.\n\n  - Appends the data to an existing image file, a magic value is used to locate the start of the data.\n\n- Shadow: The implant has the capability to collect files by extension or specific files. Shadow exfiltrates\n\nthe files by creating a hidden storage space after the first partition on the USB drive.\n\n##### Propagation\n\n- Unknown.\n\n\n-----\n\n#### 9.6 IdentityKit #17: Ramsay\n\n##### Threat actor DarkHotel\n\n Period of operation\nUnknown\nAssessment is that the framework was under development at time of analysis (2019-2020)\n\n##### Purpose\nPerform espionage against unknown targets.\n\n##### References\n\n- 2020-05-13, Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks, ESET\n\n[(https://www.welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/)](https://www.welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/)\n\n##### Connected side execution vector\n\n- Unknown\n\n##### Air-gapped side execution vector\n\n- Malicious RTF documents exploiting CVE-2017-0199 (Office/WordPad RCE),\n\nCVE-2017-11882 (Office RCE).\n\n- Trojanized 7zip installer.\n\n- Trojanized PE files.\n\n##### Communication channel\n\n- Connected side: Ramsay does not have network capabilities to contact remote C&C servers.\n\n- Air-gapped side: Searches network shares and USB drives to find potential files that might contain\n\ncommands, these files are Microsoft Word documents, PDF and ZIP files.\n\n##### Air-gapped side basic functionalities\n\n- Persistence: Multiple mechanisms:\n\n  - Load via AppInit_DLLs registry key.\n\n - Scheduled Task via COM API.\n\n - Phantom DLL Hijacking of Windows services: Windows Search hijacking msfte.dll, Microsoft\n\nDistributed Transaction Coordinator hijacking an Oracle dependency oci.dll.\n\n- Reconnaissance and Espionage:\n\n  - Ramsay’s primary collection target is Microsoft Word documents that it searches for on the system,\n\nremovable media and network drives. Located documents are staged in a preliminary collection\n\ndirectory on the local system drive where they are compressed with a dropped instance of WinRAR\n\nand encrypted with RC4 algorithm. All the files are added to a special container blob that includes\n\na magic value and the Hardware Profile GUID of the compromised system to identify from which\n\nsystem they were collected. Ramsay scans again to find Word documents to append them to the\n\ncontainer. The extraction of these containers and exfiltration to servers is done by a component\n\nthat has yet to be discovered.\n\n - In addition to collection of documents, some components have implemented\n\na network scanner to find hosts susceptible to the EternalBlue SMBv1 vulnerability (CVE-2017-0144)\n\n- Propagation: Scans system drive and network shares to trojanize PE files.\n\n\n-----\n\n### ABOUT ESET\n\nFor more than 30 years, ESET® has been developing industry-leading IT security software and\n\nservices to protect businesses, critical infrastructure and consumers worldwide from increasingly\n\nsophisticated digital threats. From endpoint and mobile security to endpoint detection and response,\n\nas well as encryption and multifactor authentication, ESET’s high-performing, easy-to-use solutions\n\nunobtrusively protect and monitor 24/7, updating defenses in real time to keep users safe and\n\nbusinesses running without interruption. Evolving threats require an evolving IT security company\n\nthat enables the safe use of technology. This is backed by ESET’s R&D centers worldwide, working\n\n[in support of our shared future. For more information, visit www.eset.com or follow us on LinkedIn,](http://www.eset.com)\n\n_[Facebook and Twitter.](https://www.facebook.com/eset?ref=br_tf)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.12.11.Jumping_the_air_gap/eset_jumping_the_air_gap_wp.pdf",
        "https://www.welivesecurity.com/wp-content/uploads/2021/12/eset_jumping_the_air_gap_wp.pdf",
        "https://papers.vx-underground.org/papers/ICS SCADA/Stuxnet/Jumping the Air Gap.pdf"
    ],
    "report_names": [
        "eset_jumping_the_air_gap_wp",
        "eset_jumping_the_air_gap_wp.pdf",
        "Jumping the Air Gap.pdf"
    ],
    "threat_actors": [
        {
            "id": "a0d369c1-f0b7-4c70-a3a5-77aabbd17979",
            "created_at": "2022-10-25T15:50:23.311311Z",
            "updated_at": "2025-03-27T02:00:55.438117Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "MITRE:Strider",
            "tools": [
                "Remsec"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d7c5a1bf-85c9-4d2f-bdbd-1455f5f2ae65",
            "created_at": "2022-10-25T16:07:23.978074Z",
            "updated_at": "2025-03-27T02:02:10.059972Z",
            "deleted_at": null,
            "main_name": "Operation Olympic Games",
            "aliases": [
                "GOSSIPGIRL"
            ],
            "source_name": "ETDA:Operation Olympic Games",
            "tools": [
                "Stuxnet",
                "W32.Stuxnet"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "99845f58-2c39-46f7-8369-bb621ebb7002",
            "created_at": "2022-10-25T16:07:24.238844Z",
            "updated_at": "2025-03-27T02:02:10.14785Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "ETDA:Strider",
            "tools": [
                "Backdoor.Remsec",
                "ProjectSauron",
                "Remsec"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c1ac2a5e-0225-47a4-8ac5-5fa898c96bde",
            "created_at": "2023-01-06T13:46:38.472883Z",
            "updated_at": "2025-03-27T02:00:02.84253Z",
            "deleted_at": null,
            "main_name": "ProjectSauron",
            "aliases": [
                "Sauron",
                "Project Sauron",
                "G0041"
            ],
            "source_name": "MISPGALAXY:ProjectSauron",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "23dfc9f5-1862-4510-a6ae-53d8e51f17b1",
            "created_at": "2024-05-01T02:03:08.146025Z",
            "updated_at": "2025-03-27T02:05:17.420497Z",
            "deleted_at": null,
            "main_name": "PLATINUM TERMINAL",
            "aliases": [
                "Longhorn ",
                "The Lamberts ",
                "Vault7 ",
                "APT-C-39 "
            ],
            "source_name": "Secureworks:PLATINUM TERMINAL",
            "tools": [
                " Assassin",
                " Marble Framework",
                "AfterMidnight"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c7ecb0e-337c-478f-95d4-7dbe9ba44c39",
            "created_at": "2022-10-25T16:07:23.690871Z",
            "updated_at": "2025-03-27T02:02:09.921431Z",
            "deleted_at": null,
            "main_name": "Goblin Panda",
            "aliases": [
                "1937CN",
                "Conimes",
                "Cycldek",
                "Goblin Panda"
            ],
            "source_name": "ETDA:Goblin Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "BackDoor-FBZT!52D84425CDF2",
                "BlueCore",
                "BrowsingHistoryView",
                "ChromePass",
                "CoreLoader",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "DropPhone",
                "FoundCore",
                "HDoor",
                "HTTPTunnel",
                "JsonCookies",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NBTscan",
                "NewCore RAT",
                "PlugX",
                "ProcDump",
                "PsExec",
                "QCRat",
                "RainyDay",
                "RedCore",
                "RedDelta",
                "RoyalRoad",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Win32.Staser.ytq",
                "USBCulprit",
                "Win32/Zegost.BW",
                "Xamtrav",
                "ZeGhost",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7d553b83-a7b2-431f-9bc9-08da59f3c4ea",
            "created_at": "2023-01-06T13:46:39.444946Z",
            "updated_at": "2025-03-27T02:00:03.093712Z",
            "deleted_at": null,
            "main_name": "GOBLIN PANDA",
            "aliases": [
                "Conimes",
                "Cycldek"
            ],
            "source_name": "MISPGALAXY:GOBLIN PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1638281479,
    "ts_modification_date": 1638281481,
    "files": {
        "pdf": "https://archive.orkl.eu/91ae6d339296f9d85396d9aa2c1f279f2b05eb6b.pdf",
        "text": "https://archive.orkl.eu/91ae6d339296f9d85396d9aa2c1f279f2b05eb6b.txt",
        "img": "https://archive.orkl.eu/91ae6d339296f9d85396d9aa2c1f279f2b05eb6b.jpg"
    }
}