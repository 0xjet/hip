{
    "id": "7f8b54fb-2742-4ed0-8056-3f1144f367f5",
    "created_at": "2022-10-25T16:48:15.956896Z",
    "updated_at": "2025-03-27T02:05:20.515985Z",
    "deleted_at": null,
    "sha1_hash": "454d3b80aedd50a29e5d7bc84a10f445789c762e",
    "title": "Macintosh HD:Users:Shared:dd:4work:Bitdefender-PR-Whitepaper-BADHATCH-creat5237-en_EN:Bitdefender-PR-Whitepaper-BADHATCH-creat5237-en_EN.indd",
    "authors": "",
    "file_creation_date": "2022-10-05T12:06:12Z",
    "file_modification_date": "2022-10-05T12:06:18Z",
    "file_size": 8565445,
    "plain_text": "#### Security\n# Side-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nwww.bitdefender.com\n\n\n-----\n\nBalint SZABO - Security Researcher (Attack Research) @ Bitdefender\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n### Technical analysis\n\nIn this chapter we describe the way in which secur32.dll arrives on the system and what actions it performs once it is\nloaded in a OneDrive process. We noticed four similar hashes of secur32.dll, but all of them perform the same actions.\nMultiple versions of secur32.dll hints at the fact that this malware campaign is ongoing and actively tested (the\nauthors are making small changes to the code and recompiling it, but leave the functionality untouched).\n\nIn normal circumstances, OneDrive.exe and OneDriveStandaloneUpdater.exe load secur32.dll from C:\\Windows\\System32\n\nIn this case, secur32.dll is loaded from the OneDrive folder which allows non-elevated users to write files to\n\nStack trace in the moment when secur32.dll creates the malicious thread\n\n##### Initial access\nAs initial access is concerned, the malicious secur32.dll seems to arrive at its desired location by commodity\nmalware disguised as legitimate software (dropper process names include adobe photoshop setup.exe, Free_\n**Macro_V1.3.exe). From the moment the malicious secur32.dll is dropped, it is up to the legitimate OneDrive.exe or**\n**OneDriveStandaloneUpdater.exe to load and execute it.**\n\n##### API resolution\nBefore digging further into the attack, we would like to present the API resolution scheme, which is used both by the\n**dropper and the malicious secur32.dll.**\n\nWhen secur32.dll calls Windows API, the functions are not directly called, to evade malware detection based on\nimports. Instead, the malicious secur32.dll uses an API resolution scheme that employs FNV-1a hashing [4][ .]\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe call of CreateProcessA, for example, looks like this:\n\nExample of indirect API call\n\nAn indirection is used for each function call that will resolve the API and then call the function:\n\nBefore being called, each API needs to be resolved\n\nThe API resolution performs the following steps:\n\nThe Process Environment Block is obtained using NtCurrentPeb()\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe pointer to PEB_LDR_DATA is obtained from the PEB\n\nGets the InLoadOrderModuleList, that is actually the first entry of type LDR_DATA_TABLE_ENTRY\n\nIterates the list of modules loaded by the host process. For each module, it iterates the list of exported functions. The searched function is\nidentified by calculating the FNV-1a hash of its name and comparing the result with a hardcoded value\n\nAn interesting property of the FNV-1a hash is that it needs a value to initialize the hash. In the above example, the hash\nis initialized to 0xBCCAC3D70CB02197, but this can be any non-zero value. This initialization allows the malware to\nidentify the target API name through more (Hash, ApiCheckSum) pairs, and the malware actually does this. Each API\ncall has its own API resolution function with a different hardcoded initial hash and checksum.\n\n##### Execution flow\n\n**General infection flow**\n\nWe noticed two main patterns used when dropping secur32.dll. One of them involves using a small dropper malware\nprocess which writes to disk the malicious secur32.dll and additional files. In the second case, the dropper malware\ninjects malicious code into AppLaunch.exe to perform the drop.\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe following diagram offers a high-level overview of the malware operation flow:\n\nThe main attack flow\n\n**Dropper flow**\n\nThe dropper malware attempts to limit noise by checking first if the infected computer can support crypto-currency\nmining. For that, it performs a basic check of the available hardware. First, it checks that the number of CPU cores is\ngreater than 2.\n\nThe dropper checks the number of CPU cores\n\nNext, it enumerates the display adapters to check that the system is equipped with, as a minimum, an Intel, Nvidia\nor AMD graphics card that runs correctly. After querying the display adapters, it checks whether they are equal with\n“Microsoft Basic Display Adapter” or “Standard VGA Graphics Adapter.” These two display adapters are used when the\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe dropper checks the existence of a graphics card\n\nThe dropper resolves the LoadLibraryA function and loads shell32.dll, advapi32.dll and wininet32.dll. The names of\nthe DLLs are present in the dropper memory as XOR-encrypted strings.\n\nString in memory before decryption\n\nThe same memory area after decryption with XOR\n\nIn case OneDrive.exe is running, the malware stops it, using the command line: _taskkill /IM OneDrive.exe /F._\n\nThe configuration of the crypto miner software is stored in the memory of the dropper, as a JSON array in a XOR\nencrypted form. When decrypted, we notice that it contains the parameters required by the cryptomining software:\n\nThe configuration for the crypto mining software\n\nThe malware encrypts the JSON array by performing XOR operation with the GUID obtained by a call to\nGetCurrentHwProfileA and writes it to disk in the folder %LocalAppData%\\Microsoft\\ using a randomly generated file\nname that ends with _s (e.g.: 0dsaowQ2ACuzIJ_s).\n\nThe dropper then decrypts the malicious secur32.dll hardcoded in its own memory and writes it to %LocalAppData%\\\n_Microsoft\\OneDrive\\Secur32.dll._\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nEncrypted secur32.dll in the data section of the dropper\n\nDecrypted secur32.dll in the memory of the dropper and the dropped secur32.dll file\n\nInterestingly, the dropper will also decrypt a hardcoded OneDrive.exe and replace the already existing one inside\n%LocalAppData%\\Microsoft\\OneDrive\\. The replacement OneDrive has malicious signatures on VirusTotal and it is\nnot digitally signed, but the attack works with the original, clean OneDrive.exe. The replacement OneDrive.exe only\ncontains a LoadLibraryA(“secur32.dll”) call.\n\nTo ensure that OneDrive executes at the next reboot, the dropper adds to registry values two reg.exe command lines:\n\n- _REG ADD HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v OneDrive /t REG_SZ /f /d %LocalAppData%\\_\n_Microsoft\\OneDrive\\OneDrive.exe_\n\n- _REG ADD HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run /v OneDrive /t REG__\n_BINARY /f /d 020000000000000000000000_\n\nAt this point, the job of the dropper process is done. Now the malicious secur32.dll will be loaded by either OneDrive.\n**exe or OneDriveStandaloneUpdater.exe into memory.**\n\nSome of the dropper processes that we detected communicate with a C2 server on Telegram and report the hardware\nspecs and geolocation of the infected machine.\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n**secur32.dll flow**\n\nThe malicious secur32.dll exports only one function, GetUserNameExW:\n\nThe export directory of the malicious secur32.dll\n\nThe reason for this is that OneDrive.exe imports only GetUserNameExW from the malicious secur32.dll:\n\nThe import directory of OneDrive.exe\n\nWe can assume that OneDrive.exe calls GetUserNameExW. The malicious secur32.dll however returns the value 1\nfrom the exported API:\n\nFake stub for GetUserNameExW\n\nBy using the fake GetUserNameExW stub, the malware avoids the disruption in the normal functioning of OneDrive.\n**exe. The real malicious actions are executed from a different thread that is created by the secur32.dll from**\nDllMain. The thread resolves LoadLibraryA and loads advapi32.dll, shell32.dll and wininet.dll. The thread also calls\nGetCurrentHwProfileA, which returns the same GUID as it returned for the dropper. In the rest of the paper we will refer\nto this GUID as the GUID password. The thread enumerates the files in %LocalAppData%\\Microsoft\\ and it looks for\nthree special files:\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n**File path pattern** **File contents**\n\nthe config file XOR encrypted by the dropper with the\n%appdata%\\Local\\Microsoft\\<random_characters>_s\nGUID password\n\nXMRig[ 5 ](open-source crypto miner) binary that was\n%appdata%\\Local\\Microsoft\\<random_characters>_c downloaded in a previous run of the malicious secur32.\ndll and archived with the GUID password\n\nlolMiner[ 6 ](open-source crypto miner) binary that was\n%appdata%\\Local\\Microsoft\\<random_characters>_g downloaded in a previous run of the malicious secur32.\ndll and archived with the GUID password\n\nThe dropper decrypts the config file using the GUID password and loaded into memory as a JSON array.\n\nIf the dropper cannot find either XMRig or lolMiner on the disk, it means that secur32.dll did not yet run and they must\nbe downloaded from their GitHub repositories. When downloading the crypto miners, the URLs used for download are\nXOR decrypted from memory. The User-Agent in the requests is “soft”.\n\nThe URLs for lolMiner is decrypted by applying 80 bytes long XOR with hardcoded key\n\nThe dropper will make a request to github.com with the User-Agent set to “soft”\n\nThe crypto-miners are downloaded in memory as zip archives and then inflated while still being kept in memory. These\ncrypto miners need some command line parameters to run. The dropper extracts the parameters from the config file\nending in _s. Moreover, the config file specifies which crypto miner should be used. In case the mining algorithm is\nEthash, Etchash or TON, the chosen crypto-miner is lolMiner. In case of Monero, the obvious choice is XMRig.\n\nIf lolMiner is used, the hollowed process is svchost.exe. In case XMRig is used, the chosen victim is conhost.exe. After\n**OneDrive.exe hollows the victim process, a new thread is started inside OneDrive.exe, which runs an infinite loop. This**\nthread checks if Taskmgr.exe, procexp.exe or procexp64.exe is running and kills the hollowed process in case those\ntools are active. Otherwise, the victim process is hollowed again.\n\nThe main flow of the malicious thread is summarized by the following flowchart:\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe main execution flow in the malicious secur32.dll (part 1)\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n\nThe main execution flow in the malicious secur32.dll (part 2)\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n_Flow of obtaining the image of the crypto miner in memory_\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe process hollowing technique is classic, but we will present it for recap purposes. First of all, a victim process is\ncreated with the CREATE_SUSPENDED flag:\n\nProcess hollowing victim is created suspended\n\nThe context of the main thread of the victim process is needed in the hollowing process. A CONTEXT structure is\nallocated using VirtualAlloc and the context is acquired using GetThreadContext.\n\nThe ContextFlags field is set to CONTEXT_FULL = CONTEXT_CONTROL | CONTEXT_INTEGER | CONTEXT_FLOATING_\nPOINT.\n\nThe context of the victim process is acquired\n\nExecutable memory is allocated in the address space of the victim process and the headers of the crypto miner MZPE\nare written in the allocated memory area:\n\nVirtualAllocEx called on the victim process\n\nThe headers of the crypto miner are written in the victim process\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe sections of the crypto miner are written one by one in the memory address of the victim process and the\nImageBase of the victim process is modified to the ImageBase of the crypto miner:\n\nThe sections of the crypto miner are written in the victim process\n\nAt the end of the loop, the RCX register in the victim process context is changed to contain the virtual\nAddressOfEntryPoint of the injected crypto miner. This register originally contained the virtual AddressOfEntryPoint of\nthe victim executable:\n\nThe AddressOfEntryPoint of the victim process is patched\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe flow of the process hollowing operation is summarized in the following flowchart:\n\nThe flow of process hollowing\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nThe flow of the post-hollowing operations is summarized in the following flowchart:\n\nThe flow of the operations performed after process hollowing\n\n##### Defense evasion techniques\nThis malware employs two big defense evasion techniques: DLL Side-Loading and Process Hollowing. First of all,\nthe malicious secur32.dll gets loaded in OneDrive executables via a DLL Side-Loading vulnerability. Secondly, the\ncrypto miner runs inside either a svchost.exe or a conhost.exe process as a result of Process Hollowing. Both these\ntechniques help the malware blend in with the processes that normally run on a system, such that the presence of a\ncrypto miner should not be obvious when somebody checks the running processes.\n\nWhen it comes to smaller evasion techniques, the malware makes some effort to hide its strings, making it harder to\nadd static detection rules. To make the job of static detection engines harder, the malware hides its imports by using\nan API resolution scheme and resolving an API only before using it.\n\n**Strings encoding**\n\nFor example, the string Lolliedieb/lolMiner-releases/releases/download/1.48/lolMiner_v1.48_Win64.zip is first loaded\ninto an array as a ciphertext:\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nExample of ciphertext to be decrypted\n\nThen, the bytes of the key are also loaded into an array:\n\nExample of encryption (and decryption) key\n\nFinally, the XOR operation is performed by the vpxor instruction from the MMX instruction set.\n\n##### Command and Control\nThere is no actual C2 server involved in the operation of this malware. The only communication with the group behind\nthe attack is done by the dropper that reports back to the malware developers via a Telegram channel.\n\nA request is made that contains the hardware parameters of the new “worker” alongside it’s localization data:\n\n##### Telegram channel message example\n\n|❗ New worker connected! ❗️ Info: — GPU: Intel(R) HxD Graphics 630 — CPU: Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz — RAM: 16247 MB ❕ Other info: — Username: <edited out> — IP: <edited out> — Country: RO — Build tag: EasyMiner|❗ New worker connected! ❗️ Info: — GPU: Intel(R) UHD Graphics 630 — CPU: Intel(R) Core(TM) i5-8300H CPU @ 2.30GHz — RAM: 8066 MB ❕ Other info: — Username: <edited out> — IP: <edited out> — Country: PT — Build tag: xDD|\n|---|---|\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n##### Impact\nAs crypto-currency mining is resource-intensive, victims can immediately notice degraded CPU and GPU performance,\noverheating and increased energy consumption. All these side effects can wear hardware out.\n\nAs mentioned, the cryptojacking campaign uses four cryptocurrency mining algorithms: ethash, etchash, ton and xmr\nwith a predilection towards etchash. With this information, as well as the public wallets in the configuration files, our\ninvestigation revealed that attackers make an average of $13 worth of crypto-currency per infected computer.\n\n### Campaign distribution/ Campaign evolution\n\nIn terms of campaign evolution, we noticed that the malicious secur32.dll is recompiled about every 3 weeks:\n\nThe number of detection plotted against the date, comparing the evolution of the four malicious secur32.dll versions\n\nWe noticed that changes between the versions don’t affect the functionality as much, but rather affect encoded strings.\n\nFor instance, the first version we noticed (fed6517a5f84eecc29edee5586d7feeb) contained the\nstring Lolliedieb/lolMiner-releases/releases/download/1.48/lolMiner_v1.48_Win64.zip, while the second version,\n9b1c1fd2556275a985bb4ce4aba99975 contained the string Lolliedieb/lolMiner-releases/releases/download/1.51a/\n_lolMiner_v1.51a_Win64.zip. This implies the authors are updating the download location of the open-source_\ncryptomining software when a new version comes along.\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\nA breakdown of the top 10 countries in terms of number of infected users is as follows:\n\nCampaign distribution\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n### How does Bitdefender defend against the campaign?\n\n##### Protection\nBitdefender Endpoint Security Tools (BEST) On-Access scanning detects and stops the dropper process with a\nsignature of type AI:Coinminer:\n\nStatic detection of the dropper process as seen on in the Bitdefender Endpoint Security on the victim machine\n\n##### Detection\nTo test the detection and visibility of our product, we adjusted the BEST settings to not block malicious processes.\n\nDetection & visibility for dropper.exe from the GravityZone web interface\n\nThe Advanced Threat Control[7] technology reveals the following actions taken by the dropper:\n\n- running taskkill.exe to stop OneDrive.exe\n\n- dropping the malicious secur32 dll\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n- running OneDrive.exe, which, after loading the malicious secur32.dll, makes a request to github.com, to download\nthe open-source crypto miner\n\n- running reg.exe which adds OneDrive to startup via Windows Registry\n\n- connecting to the Telegram API\n\n- dropping the config file of the crypto miner (the file ending in _s)\n\nUpon reboot, we also notice that OneDrive.exe is automatically started by explorer.exe, executes svchost.exe and\nhollows it, which means that it replaces the image of svchost.exe in memory with the image of the crypto miner:\n\nDetection & visibility for the side-loaded onedrive.exe from the GravityZone web interface\n\nThe command line of the hollowed svchost.exe will be C:\\Windows\\system32\\svchost.exe --algo ETCHASH --pool\n_etc.2miners.com:1010 --user 0x5aC1BA3f615fEAa6F638436D1C25CB2847C84e34.EasyMiner_\n\n\n-----\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n### Conclusion\n\nIn this article we presented a DLL Side-Loading attack happening within the ubiquitous OneDrive application.\n\nOneDrive can be side-loaded with several other DLLs. In this case, secur32.dll was chosen, possibly because OneDrive\nuses only one of its exports. During our vulnerability disclosure process, we learnt that OneDrive can be installed “per\nuser” or “per machine”. In the default “per user” installation, the folder where OneDrive is located is writeable by nonelevated users, meaning that a malicious dll could be dropped there, or executable files can be modified or completely\noverwritten (OneDrive.exe, OneDriveStandaloneUpdater.exe).\n\nOneDrive was specifically chosen in this attack because it permits the actor to achieve easy persistence. Adding\nOneDrive to startup is an action done by the dropper malware, but even if it did not do so, OneDriveStandaloneUpdater.\n**exe is by default scheduled to execute each day. Of the detections we received, 95.5% came from**\n**OneDriveStandaloneUpdater.exe loading the malicious secur32.dll. However, Microsoft recommends that customers**\n[choose the “per machine” install under the Program Files folder as per the instructions available here.](https://docs.microsoft.com/en-us/onedrive/per-machine-installation)\n\nGiven that the “per machine” installation method may not be suitable for all environments and privilege levels, user\ncaution should be one of the strongest lines of defense against commodity malware. Bitdefender recommends that\nusers ensure their AVs and operating systems are up to date, to avoid cracked software and game cheats and to\ndownload software from trusted locations only.\n\n### Bibliography\n\n1. [https://besteffortteam.it/onedrive-and-teams-dll-hijacking/](https://besteffortteam.it/onedrive-and-teams-dll-hijacking/)\n\n2. [https://www.syxsense.com/onedrive-vulnerability/](https://www.syxsense.com/onedrive-vulnerability/)\n\n3. [https://labs.redyops.com/index.php/2020/04/27/onedrive-privilege-of-escalation/](https://labs.redyops.com/index.php/2020/04/27/onedrive-privilege-of-escalation/)\n\n4. [https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function](https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function)\n\n5. [https://github.com/xmrig/xmrig](https://github.com/xmrig/xmrig)\n\n6. [https://github.com/Lolliedieb/lolMiner-releases](https://github.com/Lolliedieb/lolMiner-releases)\n\n7. [https://businessresources.bitdefender.com/hubfs/Bitdefender-Business-2015-SolutionPaper-ATC-93030-](https://businessresources.bitdefender.com/hubfs/Bitdefender-Business-2015-SolutionPaper-ATC-93030-en_EN-web.pdf)\n[en_EN-web.pdf](https://businessresources.bitdefender.com/hubfs/Bitdefender-Business-2015-SolutionPaper-ATC-93030-en_EN-web.pdf)\n\n8. [https://docs.microsoft.com/en-us/onedrive/per-machine-installation](https://docs.microsoft.com/en-us/onedrive/per-machine-installation)\n\n\n-----\n\n### MITRE techniques breakdown\n\n**Execution** **Persistence** **Defense Evasion**\n\n[Boot or Logon](https://attack.mitre.org/techniques/T1547/001/)\n\n[User](https://attack.mitre.org/techniques/T1204/002/)\n\n[Autostart](https://attack.mitre.org/techniques/T1547/001/) [Hijack Execution](https://attack.mitre.org/techniques/T1574/002/)\n\n[Execution:](https://attack.mitre.org/techniques/T1204/002/)\n\n[Execution: Registry](https://attack.mitre.org/techniques/T1547/001/) [Flow: DLL Side-](https://attack.mitre.org/techniques/T1574/002/)\n\n[Malicious](https://attack.mitre.org/techniques/T1204/002/)\n\n[Run Keys / Startup](https://attack.mitre.org/techniques/T1547/001/) [Loading](https://attack.mitre.org/techniques/T1574/002/)\n\n[File](https://attack.mitre.org/techniques/T1204/002/)\n\n[Folder](https://attack.mitre.org/techniques/T1547/001/)\n\n[Process](https://attack.mitre.org/techniques/T1055/012/)\n\n[Native API](https://attack.mitre.org/techniques/T1106/) [Injection: Process](https://attack.mitre.org/techniques/T1055/012/)\n\n[Hollowing](https://attack.mitre.org/techniques/T1055/012/)\n\n### Indicators of compromise\n\n##### Hashes\n\n- malicious secur32.dll\n\n`o` fed6517a5f84eecc29edee5586d7feeb\n\n`o` 9b0d09fd16c24a1691fa7e316351399d\n\n`o` 9b1c1fd2556275a985bb4ce4aba99975\n\n`o` ec36e1abbf75584a9d0bb4a15f8f2c33\n\n- modified OneDrive.exe\n\n`o` f3af73070387fb75b19286826cc3126c\n\n- droppers\n\n`o` 7de8b8015540bf923385c36f60b9d5ae\n\n`o` 656a4c1fcc572e855ac2e512c04ae206\n\n`o` 7bbeb20cfcabcfa69d668c24a235082e\n\n`o` 7c64bb78b589054079a1048f9fc79708\n\n`o` 73cef9a93e9572c148a5785434708c41\n\n`o` 7c64bb78b589054079a1048f9fc79708\n\n##### URLs\n\n- github.com/Lolliedieb/lolMiner-releases/releases/\ndownload/1.48/lolMiner_v1.48_Win64.zip\n\n- github.com/Lolliedieb/lolMiner-releases/releases/\ndownload/1.51a/lolMiner_v1.51a_Win64.zip\n\n- github.com/xmrig/xmrig/releases/download/v6.17.0/\nxmrig-6.17.0-msvc-win64.zip\n\n\nSide-Loading OneDrive for profit – Cryptojacking campaign detected in the wild\n\n**Discovery** **Command and Control** **Impact**\n\n[Application Layer](https://attack.mitre.org/techniques/T1071/001/)\n\n[Process](https://attack.mitre.org/techniques/T1057/) [Resource](https://attack.mitre.org/techniques/T1496/)\n\n[Protocol: Web](https://attack.mitre.org/techniques/T1071/001/)\n\n[Discovery](https://attack.mitre.org/techniques/T1057/) [Hijacking](https://attack.mitre.org/techniques/T1496/)\n\n[Protocols](https://attack.mitre.org/techniques/T1071/001/)\n\n[System](https://attack.mitre.org/techniques/T1082/)\n[Information](https://attack.mitre.org/techniques/T1082/)\n[Discovery](https://attack.mitre.org/techniques/T1082/)\n\n[System](https://attack.mitre.org/techniques/T1614/)\n[Location](https://attack.mitre.org/techniques/T1614/)\n[Discovery](https://attack.mitre.org/techniques/T1614/)\n\n##### • Files dropped/ modified/ deleted\n\n  - %appdata%\\Local\\Microsoft\\OneDrive\\Secur32.dll\n\n  - %appdata%\\Local\\Microsoft\\<random_characters>_s\n\n  - %appdata%\\Local\\Microsoft\\<random_characters>_g\n\n  - %appdata%\\Local\\Microsoft\\<random_characters>_c\n\n##### Registry\nPlaces OneDrive to be launched at startup by adding:\n\n  - Key: HKCU\\Software\\Microsoft\\Windows\\\nCurrentVersion\\Run\n\n  - Value: OneDrive\n\n  - Type: REG_SZ\n\n  - Data: %LocalAppData%\\Microsoft\\OneDrive\\OneDrive.\nexe\n\nEnables startup action for OneDrive by setting:\n\n  - Key: HKCU\\Software\\Microsoft\\Windows\\\nCurrentVersion\\Explorer\\StartupApproved\\Run\n\n  - Value: OneDrive\n\n  - Type: REG_BINARY\n\n  - Data: 020000000000000000000000\n\n|Execution|Persistence|Defense Evasion|Discovery|Command and Control|Impact|\n|---|---|---|---|---|---|\n|User Execution: Malicious File|Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder|Hijack Execution Flow: DLL Side- Loading|Process Discovery|Application Layer Protocol: Web Protocols|Resource Hijacking|\n|Native API||Process Injection: Process Hollowing|System Information Discovery|||\n||||System Location Discovery|||\n\n\n-----\n\nBitdefender is a cybersecurity leader delivering best-in-class threat\n\nprevention, detection, and response solutions worldwide. Guardian\n\nover millions of consumer, business, and government environments,\n\nBitdefender is one of the industry’s most trusted experts for\n\neliminating threats, protecting privacy and data, and enabling cyber\n\nresilience. With deep investments in research and development,\n\nBitdefender Labs discovers over 400 new threats each minute and\n\nvalidates around 40 billion daily threat queries. The company has\n\npioneered breakthrough innovations in antimalware, IoT security,\n\nbehavioral analytics, and artificial intelligence, and its technology is\n\nlicensed by more than 150 of the world’s most recognized technology\n\nbrands. Launched in 2001, Bitdefender has customers in 170+\n\ncountries with offices around the world.\n\nFor more information, visit https://www.bitdefender.com.\n\nAll Rights Reserved. © 2022 Bitdefender.\n\nAll trademarks, trade names, and products referenced herein are the property of their respective owners.\n\n##### UNDER THE SIGN OF THE WOLF\n\n**Founded 2001, Romania** A trade of brilliance, data security is an industry where only the clearest view, sharpest mind and deepest insight can\n**Number of employees 1800+** win — a game with zero margin of error. Our job is to win every single time, one thousand times out of one thousand,\n\nand one million times out of one million.\n\n**Headquarters**\nEnterprise HQ – Santa Clara, CA, United States And we do. We outsmart the industry not only by having the clearest view, the sharpest mind and the deepest insight,\nTechnology HQ – Bucharest, Romania but by staying one step ahead of everybody else, be they black hats or fellow security experts. The brilliance of our\n\ncollective mind is like a luminous Dragon-Wolf on your side, powered by engineered intuition, created to guard against\n\n**WORLDWIDE OFFICES** all dangers hidden in the arcane intricacies of the digital realm.\n**USA & Canada: Ft. Lauderdale, FL | Santa Clara, CA | San Antonio, TX |**\nToronto, CA This brilliance is our superpower and we put it at the core of all our game-changing products and solutions.\n**Europe: Copenhagen, DENMARK | Paris, FRANCE | München, GERMANY |**\nMilan, ITALY | Bucharest, Iasi, Cluj, Timisoara, ROMANIA | Barcelona, SPAIN\n| Dubai, UAE | London, UK | Hague, NETHERLANDS\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://www.bitdefender.com/files/News/CaseStudies/study/424/Bitdefender-PR-Whitepaper-SLOneDriveCyberJack-creat6318-en-EN.pdf"
    ],
    "report_names": [
        "Bitdefender-PR-Whitepaper-SLOneDriveCyberJack-creat6318-en-EN.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1664971572,
    "ts_modification_date": 1664971578,
    "files": {
        "pdf": "https://archive.orkl.eu/454d3b80aedd50a29e5d7bc84a10f445789c762e.pdf",
        "text": "https://archive.orkl.eu/454d3b80aedd50a29e5d7bc84a10f445789c762e.txt",
        "img": "https://archive.orkl.eu/454d3b80aedd50a29e5d7bc84a10f445789c762e.jpg"
    }
}