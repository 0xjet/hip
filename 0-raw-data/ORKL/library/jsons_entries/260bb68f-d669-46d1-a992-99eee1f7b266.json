{
    "id": "260bb68f-d669-46d1-a992-99eee1f7b266",
    "created_at": "2022-10-25T16:48:16.57756Z",
    "updated_at": "2025-03-27T02:17:14.577653Z",
    "deleted_at": null,
    "sha1_hash": "1dfd4cd9d9a5cd3d9749a98852ba36d6eb0b865d",
    "title": "A41APT case  ~Analysis of the Stealth APT Campaign Threatening Japan",
    "authors": "",
    "file_creation_date": "2021-01-15T15:41:34Z",
    "file_modification_date": "2021-01-15T15:41:34Z",
    "file_size": 3235667,
    "plain_text": "## A41APT case\n###### ~ Analysis of the Stealth APT Campaign Threatening Japan\n\n Yusuke Niwa / Hajime Yanagishita / Charles Li / Suguru Ishimaru / Motohiko Sato\n\n 2020/01/28\n\n\n-----\n\n#### Presenter / Coauthor\n\n###### Yusuke Niwa Hajime Yanagishita ITOCHU Corporation. Macnica Networks ITCCERT Cyber Security Researcher Security Researcher\n\n Charles Li Suguru Ishimaru Team T5 Kaspersky Chief Analyst of TeamT5 GReAT Malware Researcher\n\n Motohiko Sato ITOCHU Corporation. ITCCERT Sr. Cyber Security Researcher\n\n\n-----\n\n#### Agenda\n\n##### 1. Campaign Overview\n\n 2. Malware Analysis\n\n 3. Characteristics of Intrusion\n\n 4. Threat Actor’s Infrastructure\n\n 5. Consideration of Threat Actor’s Attribution\n\n 6. Summary\n\n\n-----\n\n### １．A41APT Campaign Overview\n\n\n-----\n\n#### A41APT Campaign Overview\n\n######  Period of Activity: March 2019 to January 2021 Present\n\n  Target: Japan (Japanese companies including overseas branches)\n\n  Initial Vector: Not Spear phishing But SSL-VPN abuse\n\n  Malwares: New type of malwares using dll-sideloading\n\n （SodaMaster/P8RAT/DESLoader/FYAntiLoader etc.）\n\n  Public Info: Very few [1][2][3][4]\n\n  Characteristics: Very tough to detect attacker’s intrusion\n\n We call this threat actor A41APT from the hostname feature 「DESKTOP-A41UVJV」that is continuously used\n\n\n-----\n\n### ２．Malware Analysis\n\n\n-----\n\n#### ２．Malware Analysis\n\n###### 1. DESLoader\n\n 2. DESLoader Payloads\n\n • SodaMaster\n • P8RAT Update\n • Stager Shellcode\n • FYAntiLoader\n\n 3. FYAntiLoader NEW\n\n 4. xRAT NEW\n\n\n-----\n\n#### 2-1．DESLoader\n\n###### Aka. SigLoader\n\n ▪ Loader file for DLL Side-Loading\n and files contain encrypted shellcode and payload.\n\n ▪ Decrypt multiple PEs and\n shellcodes sequentially in multiple stages.\n\n ▪ Multiple algorithms are used for\n decryption.\n\n ▪ Finally, the payload is executed in\n memory.\n\n\n-----\n\n#### Example of DESLoader's payload decoding flow\n\n###### reflective\n side-loading load decode dll injection\n\n policytool.exe jli.dll vac.dll stage_1.shellcode stage_1.dll\n load\n\n Junk code\n reflective\n decode dll injection\n\n stage_2.shellcode P8RAT pcasvc.dll (payload)\n\n Anti-analysis junk codes are found using OutputDebugStringA(),\n\n\n-----\n\n#### jli.dll/stage_1.dll\n\n###### Multiple algorithms (XOR, DES, AES and RSA) are defined and the order of using them is configured. Read encrypted data in specified DLL from the end of data till configured size and decrypt.\n\n skipped\n jli.dll XOR key = 0x9F\n\n Decryption Algorithm\n\n skipped\n AES key = 83H4uREKfFClDH8ziYTH8xsBYa32p3wl\n MZ (CBC mode) IV = 83H4uREKfFClDH8z\n PE Section table +\n Section 1 … N\n vac.dll skipped\n Embedded data\n\n\n-----\n\n#### starge_1.shellcode\n\n###### ▪ In addition to known \"ecipekac\" magic_bytes, some samples use {BFAFBFAF} or {9F8F7F6F} as magic_bytes.\n\n ▪ Prepare DLL from separately embedded data in shellcode\n\n stage1_1. shellcode stage_1.dll\n\n 0x00000\n 0x00000 MZ\n shellcode\n 0x000E0 PE\n 0x00bf5 ecipekac 0x00bfd Size of buf 0x001E8 Section table 0x00c01 Size of code 0x00c05 0x01000\n Section 1\n Section table Section1 … N\n 0x39a1d PE\n 0x39b25\n MZ 0xXXXXX\n Section N\n\n\n-----\n\n#### Variant of stage_2.shellcode\n\n###### • In addition to stage_2.shellcode that has almost same feature as\n stage_1.shellcode, we found 2 types of stagae_2.shellcodes.\n\n  ​Stager Shellcode\n\n RC4\n  Shellcode dedicated for SodaMaster\n\n stage_2.shellcode SodaMaster\n (payload)\n\n**offset** **data** **description**\n\n0x000 90 90 90 90 90 90 90 90 magic bytes for Identification, this is\nused for comparision before data\nprocessing\n\n###### Embedded structure of 0x008 0x11600 Size of encrypted data, only this value\n\n(size) is observed\n\n###### shellcode for SodaMaster\n\n0x00C A9 5B 7B 84 9C CB CF E8 16 bytes RC4 key (each sample has\nB6 79 F1 9F 05 B6 2B FE different key)\n\n0x01C C7 36 7E 93 D3 07 1E 86 Encrypted SodaMaster payload with RC4\n\n\n-----\n\n#### DESLoader TimeLine\n\n**Compile Date**\n\n**File name** **Algorithm** **Payload**\n\n###### ▪ AES and DES algorithms 2019-10-18(JST) CCFIPC64.DLL AES xRAT\n\n2019-10-24 SBIEDLL.DLL DES Stager_Shellcode\n\n###### are implemented using proprietary coding 2019-12-262019-12-28 DBUS-1-3.DLLGLIB-2.0.DLL DESDES Stager_ShellcodeStager_Shellcode\n\n2020-05-04 jli.dll DES SodaMaster\n\n###### ▪ In many cases, not all 2020-05-04 jli.dll DES SodaMaster\n\n2020-05-09 DBUS-1-3.DLL DES SodaMaster\n\n###### ciphers are used 2020-05-30 dbus-1-3.dll DES Stager_Shellcode\n\n2020-06-02 uxtheme.dll DES P8RAT\n\n###### ▪ The order in which 2020-06-042020-06-30 UXTHEME.DLLVMTOOLS.DLL XOR->AES->DES (RSA Not Used)AES->DES (RSA XOR Not Used) SodaMasterP8RAT\n ciphers are used is 2020-06-30 SECUR32.dll AES->DES (RSA XOR Not Used) SodaMaster changed 2020-07-01 jli.dll DES P8RAT\n\n2020-09-28 jli.dll DES->AES (RSA XOR Not Used) SodaMaster\n2020-09-29 jli.dll DES->AES (RSA XOR Not Used) SodaMaster\n2020-10-02 vmtools.dll DES->AES (RSA XOR Not Used) SodaMaster\n\n###### ▪ DESLoader which\n implements only one 2020-12-212020-12-26 JLI.dlljli.dll DES->AES (RSA XOR Not Used)DES Stager_ShellcodeSodaMaster\n\n2020-12-26 sbiedll.dll RSA(AES DES XOR Not Used) Stager_Shellcode\n\n###### cipher contains a lot of OutputDebugStringA() 2020-12-27 JLI.DLL DES->AES (RSA XOR Not Used) Stager_Shellcode\n\n2020-12-27 JLI.DLL DES->AES (RSA XOR Not Used) Stager_Shellcode\n2020-12-27 JLI.DLL DES->AES (RSA XOR Not Used) Stager_Shellcode\n\n###### code\n\n2020-12-31 vmtools dll XOR->AES (RSA DES Not Used) P8RAT\n\n\n-----\n\n#### 2-2．DESLoader’s Payload\n\n###### 1. SodaMaster 2. P8RAT 3. FYAntiLoader ( ⇒.NET Loader(ConfuserEx v1.0.0) ⇒xRAT ) 4. Stager Shellcode\n\n\n-----\n\n#### SodaMaster\n\n###### Aka. DelfsCake, dfls, HEAVYPOT\n\n ▪ One of DESLoader's payloads\n\n ▪ Fileless RAT\n\n ▪ Command identifiers are d, f, l and s\n\n ▪ Same Compilation Time\n  5CFE0D92 (Mon Jun 10 07:58:10 2019)\n\n ▪ Check VM environment from the following\n registry value  HKCR¥Applications¥VMwareHostOpen.exe\n\n\n-----\n\n#### SodaMaster\n\n###### base64(RSA key) + 12bytes data\n\n ▪ Mutex value is hex value\n CRC32\n calculated from hardcoded 0x8d01ca9f base64 string with CRC32 and\n Mutex = 9FCA018D\n reverse the order\n\n ▪ Initial C2 communication data\n Encrypted using RSA key\n is encrypted with RSA. RSA key\n User\n is hardcoded base64 key_blob\n host\n and data contains randomly\n PID\n generated RC4 key\n Exec Date\n\n ▪ Further communication data is RC4key encrypted with RC4\n\n RC4 encryption\n\n\n-----\n\n#### P8RAT\n\n###### Aka. GreetCake\n\n ▪ One of DESLoader's payloads\n\n ▪ Fileless RAT\n\n ▪ Latest command identifiers are 300~309\n\n ▪ Command 309 was implemented NEW after December 2020.\n\n ▪ Timer related strings at command 306 - 308 are not exposed at latest version.\n\n ▪ Main feature looks Command 301, Execution of secondary PE based payload downloaded into memory\n\n\n-----\n\n#### P8RAT Update\n\n###### ▪ Checks if processes\n characteristic of the guest OS of Virtual Machine is running or not\n\n ▪ Collects OS version,\n hostname and username\n\n ▪ Looks to checks if it is a\n sandbox or analyst environment\n\n\n-----\n\n#### Stager Shellcode\n\n###### ▪ One of DESLoader's\n Payloads\n\n ▪ CobaltStrike Stager\n Shellcode beacon\n\n ▪ In Later version in 2020,\n beacon contains HTTP Header mimicking jQuery Request\n\n\n-----\n\n#### 2-3. FYAntiLoader\n\n###### ▪ One of DESLoader's payloads\n\n ▪ Fileless type loader module\n\n ▪ .NET Loader having Provocative Export\n function name\n\n ▪ Contains .NET Loader packed\n with ConfuserEx v1.0.0\n\n ▪ Looking for specific directory and search file\n with condition, then read file and decrypt payload\n\n ▪ Finally, Payload is xRAT\n\n\n-----\n\n#### xRAT decoding flow with FYAntiLoader\n\n###### reflective\n side-loading load decode dll injection\n\n usoclient.exe CCFIPC64.dll msftedit.prf.coo starge_1.shellcode starge_1.dll\n\n load\n FYAntiLoader\n\n reflective\n decode dll injection CppHostCLR load\n\n msdtcuiu.adi.wdb starge_2.shellcode blob starge_3.dll web_lowtrust.config.uninstall xRAT\n\n\n-----\n\n#### 2-4．xRAT\n\n###### VERSION 2.0.0.0 HOSTS 45.138.157.83:443; RECONNECTDELAY 1846872 KEY [redacted] AUTHKEY [redacted] DIRECTORY Environment.SpecialFolder.ApplicationData SUBDIRECTORY Subdir INSTALLNAME Client.exe INSTALL false STARTUP false MUTEX 3n5HUTePmoGqIF8CZanamdGw STARTUPKEY Quasar Client Startup HIDEFILE false ENABLELOGGER false ENCRYPTIONKEY KCYcz6PCYZ2VSiFyu2GU TAG [redacted] LOGDIRECTORYNAME Logs HIDEDIRECTORY false HIDEINSTALLSUBDIRECTOR false download_url none\n\n\n-----\n\n### ３．Characteristics of Intrusion\n\n\n-----\n\n#### A41APT’s intrusion method\n\n###### Internal Recon. Persistence of C2 Initial Intrusion Trace Removal Lateral Movement malware Communication\n\nPenetration via SSL-VPN Perform a port scan to Persistence by scheduled Communicate with C2 server Delete the event log after\nusing vulnerabilities or search for open RDP or task registration to execute via DESLoader’s payload or communication with C2 is\nstolen credentials SMB port. Then, connect to the legitimate PE PowerShell remoting finished.\n\nRDP with an administrator\naccount.\n\nScheduled task registration Event log deletion\n\nA41APT\n\nServer* C2 Server\n\n**In Memory**\n\nServer\n\nDESLoader\n\nPayload\n\n###### OR\n\nPowerShell\n\nAD Server Laptop Legitimate PE\n\n\n-----\n\n#### Characteristics of Compromise\n\n###### 1. Initial intrusion using SSL-VPN products\n\n 2. Network scanning and credential theft\n\n 3. PowerShell remoting to remove event logs\n\n 4. Persistence of malware by scheduled task\n\n\n-----\n\n###### ３-１．Initial intrusion via SSL-VPN (Exp. session hijacking)\n\n • In October 2019, an attacker used the hostname DESKTOP-A41UVJV to hijack sessions to enter the internal network via SSL-VPN product, Pulse Secure.\n\n • JPCERT also reported a similar attack targeting SSL-VPN [4].\n\n • In some cases, attackers used credentials that they had stolen in the past intrusion.\n\n\n-----\n\n###### ３-2． Network scanning and credential theft\n\n Network scanning and RDP Credential theft\n\n ▪ Run csvde.exe, a CSV export command\n\n ▪ After the intrusion by SSL-VPN, perform\n line tool provided by Microsoft.\n internal network scanning to find open port RDP (3389/TCP) and SMB (445/TCP).\n\n ▪ Execute AdFind provided by joeware.\n\n ▪ Use an administrator account to deploy\n\n ▪ Dump of SYSTEM/SECURITY/SAM hive,\n RDP to servers with free RDP.\n etc.\n Exp. server types that are frequently\n compromised by RDP\n AD server File server Anti Virus management server\n Backup server\n\n\n-----\n\n###### ３-3． PowerShell remoting to delete event logs\n\n • Event log: the end of a PowerShell remoting session\n\n • Windows PowerShell.evtx EID: 403\n\n • The \"C2 address\" and the \"*.nls file name\" are changed, but the rest is the same ⇒ probably common tools execution\n\n\n-----\n\n###### ３-４．Persistence of malware by scheduled task\n\n ▪ Registered a task scheduler that executes a legitimate executable file that loads\n DESLoader every 15 minutes.\n\n ▪ It is unlikely that the same scheduled task name is created on the compromised hosts.\n\n\n-----\n\n|Scheduled Tasks|PE name|\n|---|---|\n|¥Microsoft¥Windows¥Sysmain¥HybridDriveCachePrepopulate|HybridDrive.exe|\n|¥Microsoft¥Windows¥Shell¥FamilySafetyMonitor|wpcmon.exe|\n|¥Microsoft¥Windows¥NetworkAccessProtection¥NAPStatus UI|NAPStatus.exe|\n|¥Microsoft¥Windows¥SideShow¥AutoWake|AutoWake.exe|\n|¥Microsoft¥Windows¥SystemRestore¥SR|srtasks.exe|\n|¥Microsoft¥Windows¥Shell¥FamilySafetyUpload|FamilySafety.exe|\n|¥Microsoft¥Windows¥File Classification Infrastructure¥Property Definition Sync|DefinitionSync.exe|\n|¥Microsoft¥Windows¥UpdateOrchestrator¥Refresh Settings|usoclient.exe|\n|¥Microsoft¥Windows¥WindowsUpdate¥AUSessionConnect|AUSession.exe|\n|¥Windows¥System32¥Tasks¥Microsoft¥Windows¥Shell¥WindowsParentalControls|ParentalControls.exe|\n|¥Microsoft¥Windows¥UpdateOrchestrator¥Schedule Retry Scan|usoclient.exe|\n|¥Microsoft¥Windows¥LanguageComponentsInstaller¥ReconcileLanguageResources|DiagPackage.exe|\n|¥Microsoft¥Windows¥Setup¥EOSNotify|EOSNotify.exe|\n\n\n###### Exp. Improperly registered scheduled tasks observed in the past\n\n Scheduled Tasks PE name\n\n ¥Microsoft¥Windows¥Sysmain¥HybridDriveCachePrepopulate HybridDrive.exe\n\n ¥Microsoft¥Windows¥Shell¥FamilySafetyMonitor wpcmon.exe\n\n ¥Microsoft¥Windows¥NetworkAccessProtection¥NAPStatus UI NAPStatus.exe\n\n ¥Microsoft¥Windows¥SideShow¥AutoWake AutoWake.exe\n\n ¥Microsoft¥Windows¥SystemRestore¥SR srtasks.exe\n\n ¥Microsoft¥Windows¥Shell¥FamilySafetyUpload FamilySafety.exe\n\n ¥Microsoft¥Windows¥File Classification Infrastructure¥Property Definition Sync DefinitionSync.exe\n\n ¥Microsoft¥Windows¥UpdateOrchestrator¥Refresh Settings usoclient.exe\n\n ¥Microsoft¥Windows¥WindowsUpdate¥AUSessionConnect AUSession.exe\n\n ¥Windows¥System32¥Tasks¥Microsoft¥Windows¥Shell¥WindowsParentalControls ParentalControls.exe\n\n ¥Microsoft¥Windows¥UpdateOrchestrator¥Schedule Retry Scan usoclient.exe\n\n ¥Microsoft¥Windows¥LanguageComponentsInstaller¥ReconcileLanguageResources DiagPackage.exe\n\n ¥Microsoft¥Windows¥Setup¥EOSNotify EOSNotify.exe\n\n\n-----\n\n### ４．Threat Actor’s Infrastructure\n\n\n-----\n\n#### Threat Actor’s Infrastructure\n\n###### 1. The hostname used for the intrusion via SSL-VPN\n\n 2. Characteristics of the C2 infrastructure\n\n\n-----\n\n###### Hostname used for the initial intrusion via SSL-VPN\n\n ▪ Tendency to use distinctive hostnames and attempt intrusions\n while changing IP addresses\n\n  Host names used in breaches observed in the past\n\n DESKTOP-A41UVJV\n\n dellemc_N1548P\n\n ▪ Tendency to use an IP for intrusion that is different from the C2 server’s IP\n\n\n-----\n\n###### Characteristics of the C2 infrastructure\n\n ▪ For C2, there is a tendency to use IP addresses and not to use domains.\n\n ▪ From the observed C2 IP addresses, there is little bias toward country and AS, and\n we observed that there is a tendency not to reuse IP addresses repeatedly.\n\n\n-----\n\n#### ５．Consideration of Threat Actor’s Attribution\n\n\n-----\n\n#### Considerations for attribution of A41APT\n\n###### 1. Relevance to APT10\n\n 2. Relevance to BlackTech\n\n\n-----\n\n#### １．Relevance to APT10\n\n###### Common TTPs\n\n ▪ APT10 involvement in targeted attack campaign\n against Turkey mentioned [5]. - Multilayers loading\n\n - CPPHostDLR loader\n - F**jYouAnti export\n\n ▪ Confirmed the existence of an early version of ShellCode - Look for payloads under\n SodaMaster (x86) in March 2019. “C:¥Windows¥Microsoft.Net”\n\nload\n\n###### ▪ xRAT observed in A41APT campaign has\n common TTPs with BlackBerry Cylance reports Common TTPs in 2019 was confirmed [6].\n\n SodaMaster xRAT/QuasarRAT\n\nconnect\n\nMenuPass/QuasarRAT\n\nBackdoor Report\n\n###### Run dll payload\n\nAttribute\n\n###### Run Shellcode payload rare-coins[.]com\n\nAPT10\n\n\n-----\n\n#### ２．Relevance to BlackTech\n\n###### SodaMaster TSCookie\n\n ▪ Identified common features\n between SodaMaster and TSCookie [7].\n\n ▪ The same information is collected\n from the compromised host in the initial stage Username\n```\n   – Computer name\n   – Current process ID\n   –\n\n ▪ Observed existence of two\n malware, SodaMaster and TSCookie, on multiple compromised hosts\n\n```\n\n-----\n\n### ６．Summary\n\n\n-----\n\n#### Wrap up：A41APT Campaign\n\n###### ▪ Intrusion via SSL-VPN ADVERSARY（A41APT）\n\n ▪ Heavy usage of RDP for lateral movement (mainly servers) ▪ Strong association with APT10\n\n ▪ Abusing DLL-Sideloading ▪ Relevance to BlackTech\n\n ▪ Remove traces\n\n CAPABILITIES INFRASTRUCTURE\n\n ▪ Targeting Japanese companies ▪ Heavy usage of IP addresses for C2 including overseas branches (no domain usage)\n\n ▪ Wide range of industries such as ▪ Less reuse of IP addresses for C2 manufacturing\n\n\n-----\n\n#### Wrap up：TTPs ~MITRE ATT&CK Mapping~\n\n###### Tactics Techniques\n\n Initial Access External Remote Services (T1133) : Intrusion via SSL-VPN using vulnerabilities or stolen credentials\n\n Execution Command and Scripting Interpreter: PowerShell (T1059.001) Base64 obfuscated PowerShell commands (delete event log) Windows Management Instrumentation (T1047) : WMIC collects services for security products\n\n Persistence Scheduled Task/Job: Scheduled Task (T1053.005) :\n\n Privilege Escalation Hijack Execution Flow: DLL Search Order Hijacking (T1574.001)\n\n Defense Evasion Deobfuscate/Decode Files or information (T1140) Indicator Removal on Host: Clear Windows Event Logs (T1070.001) Hijack Execution Flow: DLL Search Order Hijacking (T1574.001)\n\n Credential Access OS Credential Dumping: Security Account Manager (T1003.002) OS Credential Dumping: NTDS (T1003.003)\n\n Discovery Account Discovery: Domain Account (T1087.002) Domain Trust Discovery (T1482) Software Discovery: Security Software Discovery (T1518.001)\n\n Lateral Movement Remote Services: Remote Desktop Protocol (T1021.001)\n\n Collection Archive Collected Data: Archive via Utility (T1560.001) : Compression by WinRAR\n\n\n-----\n\n#### Wrap up：Features of this campaign\n\n######  Targeting the kryptonite of EDR/FSA detection\n\n • Malware is written on the disk by the attacker's manual operation via SSL-VPN instead of\n\n malware-originated intrusion from Spear phishing email (legitimate file, loader, encrypted file)\n\n • Intrusion from group affiliates, including overseas companies\n\n • Malware is mostly placed on servers, and the number of compromised servers are very small.\n\n • Most of the malware detected in the same period have different C2 addresses, so there is little\n\n tendency to use the same samples.\n\n  After the intrusion, some rough operations were seen.\n\n • Heavy usage of network discovery using RDP\n\n • Common traces deletion method of event logs\n\n • Recorded attacker's hostname in event log\n\n\n-----\n\n#### Examples of countermeasures against this campaign\n\n###### SSL-VPN Governance（Overseas/affilates）\n\n • Implementation of MFA • Framework for sharing information (Incident, Threat\n\nIntel and security situation )\n\n###### • Patch adaptation operation\n\n                                                                - Apply same security level\n\n###### • Monitoring\n\n                                                                - Apply same level of detection in each intrusion method\n\n###### End User\n Additional threat visibility Additional Monitoring\n\n                   - Network Monitor by NTA                   - Audit authentication attemp of administrator account\n\n(success/failure)\n\n                   - Strengthen security measures for servers\n\n                                                                         - Monitor deletion of Windows event log\n\n                   - Hunting stealthy attack by using EDR/FSA\n\n                                                                         - Monitor login from host that is not in list of organization asset\n\n                   - Leverage Yara rule to detect loader or payload on\n\n                                                                         - Monitor SSL-VPN log for suspicious login from unknown host\n\nmemory ( e.g. hostname is not in organization asset )\n\n###### Strengthen Monitoring for Authentication\n\n Vendor\n (SOC) • Talk with end user to know white-list ( username, hostname, IP address and date/time ) of\n authentication and give proactive alert to end user\n\n\n-----\n\n#### (Based on intrusion method)\n\n###### Internal Recon. Persistence of C2 Initial Intrusion Trace Removal Lateral Movement malware Communication\n\n  - Implementation of MFA   - NW monitoring by NTA   - Monitor the creation of   - Payload detection by Yara   - Monitor for traces of\n\n  - Patch adaptation operation   - Strengthen security measures suspicious scheduled task   - C2 identification and blocking suspicious event log\n\n  - Monitor suspicious logins for servers (EDR/FSA etc.) events. by malware analysis deletions.\nfrom overseas   - Monitoring of administrator\n\nauthentication attempt                   - Identify and block C2 by\n(success/failure) traces of suspicious PowerShell\n\n                   - Suspicious login monitoring remoting in event logs\nfrom hosts outside of asset\nmanagement\n\nScheduled task registration Event log deletion\n\nA41APT\n\nEvent log\n\nPatch application Server C2\n\n**In Memory** monitoring\n\noperation Server\n\nMonitoring\nMonitoring\n\nDESLoader\n\nNTA **OR**\nNTA\n\npayloads\n\n###### MFA\n\nPowerShell\n\n\n-----\n\n#### At the end...\n\n######  A41APT campaign is very stealthy and difficult to detect, but it is not undetectable.\n\n  The compromised target has shifted from endpoint to server, and the intrusion\n\n route has also shifted from spear phishing to abusing SSL-VPN. Security measures\n\n need to be reviewed in your organization to respond to change in attack method.\n\n  By refining daily security operations and thoroughly reviewing the security holes in\n\n each organization's environment, it may be possible to detect and protect attacks\n\n from even small anomalies.\n\n\n-----\n\n#### Reference\n\n###### 1. 【緊急レポート】Microsoft社のデジタル署名ファイルを悪用する「SigLoader」による標的型攻撃を確認 https://www.lac.co.jp/lacwatch/report/20201201_002363.html\n\n 2. Japan-Linked Organizations Targeted in Long-Running and Sophisticated Attack Campaign https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan- espionage\n\n 3. https://twitter.com/Int2e_/status/1333501729359466502?s=20\n\n 4. Pulse Connect Secure の脆弱性を狙った攻撃事案 https://blogs.jpcert.or.jp/ja/2020/03/pulse-connect-secure.html\n\n 5. APT10 THREAT ANALYSIS REPORT (ADEO IT Consulting Services) https://adeo.com.tr/wp-content/uploads/2020/02/APT10_Report.pdf\n\n 6. Threat Spotlight: MenuPass/QuasarRAT Backdoor https://blogs.blackberry.com/en/2019/06/threat-spotlight-menupass-quasarrat-backdoor\n\n 7. https://blogs.jpcert.or.jp/ja/2018/03/tscookie.html\n\n\n-----\n\n#### IoCs\n\n**MD5** **File name** **Payloads** **Comment** **Path of Encrypted xRAT**\n\nf6ed714d29839574da3e368e4437eb99 usoclient.exe xRAT Legitimate EXE Microsoft.NET¥test¥Framework¥v4.0.30319¥\ndd672da5d367fd291d936c8cc03b6467 CCFIPC64.DLL xRAT DESLoader Config¥web_lowtrust.config.uninstall\n\nEncrypted stage_\n335ce825da93ed3fdd4470634845dfea msftedit.prf.cco xRAT\n\n1.shellcode **Hostname of Intruded via SSL-VPN**\n\nEncrypted DESKTOP-A41UVJV\nf4c4644e6d248399a12e2c75cf9e4bdf msdtcuiu.adi.wdb xRAT\nstage_2.shellcode\n\ndellemc_N1548P\n\nweb_lowtrust.confi\n019619318e1e3a77f3071fb297b85cf3 xRAT\n\nEncrypted xRAT\ng.uninstall\n\n**C2** **Payloads**\n\n7e2b9e1f651fa5454d45b974d00512fb policytool.exe P8RAT Legitimate EXE\n\nbe53764063bb1d054d78f2bf08fb90f3 jli.dll P8RAT DESLoader\n\n45.138.157[.]83 xRAT\n\nEncrypted\nf60f7a1736840a6149d478b23611d561 vac.dll P8RAT\nstage_1.shellcode\n\n151.236.30[.]223 P8RAT\n\nEncrypted\n59747955a8874ff74ce415e56d8beb9c pcasvc.dll P8RAT\nstage_2.shellcode\n\n193.235.207[.]59 Stager Shellcode\n\nc5994f9fe4f58c38a8d2af3021028310 80f55.rec.dll SodaMaster(x86)\n\n037261d5571813b9640921afac8aafbe 10000000.dll SodaMaster(x86)\n\nwww.rare-coisns[.]com SodaMaster(x86)\n\nbca0a5ddacc95f94cab57713c96eacbf ResolutionSet.exe SodaMaster Legitimate EXE\n\ncca46fc64425364774e5d5db782ddf54 vmtools.dll SodaMaster DESLoader 88.198.101[.]58 SodaMaster\n\nwiaky002_CNC175 Encrypted stage_\n4638220ec2c6bc1406b5725c2d35edc3 SodaMaster\n\n5D.dll 1.shellcode\n\n\n-----\n\n# Any Questions?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.01.31.A41APT/JSAC2021_202_niwa-yanagishita_en.pdf",
        "https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_202_niwa-yanagishita_en.pdf",
        "http://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_202_niwa-yanagishita_en.pdf"
    ],
    "report_names": [
        "JSAC2021_202_niwa-yanagishita_en",
        "JSAC2021_202_niwa-yanagishita_en.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1610725294,
    "ts_modification_date": 1610725294,
    "files": {
        "pdf": "https://archive.orkl.eu/1dfd4cd9d9a5cd3d9749a98852ba36d6eb0b865d.pdf",
        "text": "https://archive.orkl.eu/1dfd4cd9d9a5cd3d9749a98852ba36d6eb0b865d.txt",
        "img": "https://archive.orkl.eu/1dfd4cd9d9a5cd3d9749a98852ba36d6eb0b865d.jpg"
    }
}