{
    "id": "bd96fa3a-1b6c-4dde-99ee-c325360b1afd",
    "created_at": "2023-01-12T15:10:00.905514Z",
    "updated_at": "2025-03-27T02:16:34.770351Z",
    "deleted_at": null,
    "sha1_hash": "0e3735fa4c4446b40628950cc2e2e5718bb48349",
    "title": "2021-11-15 - Evasive maneuvers- HTML smuggling explained",
    "authors": "",
    "file_creation_date": "2022-05-29T00:59:00Z",
    "file_modification_date": "2022-05-29T00:59:00Z",
    "file_size": 230197,
    "plain_text": "# Evasive maneuvers: HTML smuggling explained\n\n**[blog.malwarebytes.com/explained/2021/11/evasive-maneuvers-html-smuggling-explained/](https://blog.malwarebytes.com/explained/2021/11/evasive-maneuvers-html-smuggling-explained/)**\n\nJovi Umawing November 15, 2021\n\n[Microsoft Threat Intelligence Center (MSTIC) last week disclosed “a highly evasive malware](https://www.microsoft.com/security/blog/2021/11/11/html-smuggling-surges-highly-evasive-loader-technique-increasingly-used-in-banking-malware-targeted-attacks/)\ndelivery technique that leverages legitimate HTML5 and JavaScript features” that it calls\nHTML smuggling.\n\nHTML smuggling has been used in targeted, spear-phishing email campaigns that deliver\nbanking Trojans (such as Mekotio), remote access Trojans (RATs) like AsyncRAT/NJRAT,\nand Trickbot. These are malware that aid threat actors in gaining control of affected devices\nand delivering ransomware or other payloads.\n\n[MSTIC said the technique was used in a spear-phishing attack by the notorious NOBELIUM,](https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/)\nthe threat actor behind the noteworthy, [nation-state cyberattack on SolarWinds.](https://blog.malwarebytes.com/threat-analysis/2020/12/advanced-cyber-attack-hits-private-and-public-sector-via-supply-chain-software-update/)\n\n### How HTML smuggling works\n\n\n-----\n\nAn\n\noverview of HTML smuggling (Source: Microsoft)\n\n## What is HTML smuggling?\n\nHTML smuggling got its name from the way attackers smuggle in or hide an encoded\nmalicious JavaScript blob within an HTML email attachment. Once a user receives the email\nand opens this attachment, their browser decodes the malformed script, which then\nassembles the malware payload onto the affected computer or host device.\n\nUsually, malware payloads go through the network when someone opens a malicious\nattachment or clicks a malicious link. In this case, the malware payload is created within the\nhost. This means that it bypasses email filters, which usually look for malicious attachments.\n\nHTML smuggling is a particular threat to an organization’s network because it bypasses\ncustomary security mitigation settings aimed at filtering content. Even if, for example, an\norganization has disabled the automatic execution of JavaScript within its environment—this\ncould stop the JavaScript blob from running—it can still be affected by HTML smuggling as\nthere are multiple ways to implement it. According to MSTIC, obfuscation and the many ways\nJavaScript can be coded could evade conventional JavaScript filters.\n\nHTML smuggling isn’t new, but MSTIC notes that many cybercriminals are embracing its use\nin their own attack campaigns. “Such adoption shows how tactics, techniques, and\nprocedures (TTPs) trickle down from cybercrime gangs to malicious threat actors and vice\n\n\n-----\n\nversa … It also reinforces the current state of the underground economy, where such TTPs\nget commoditized when deemed effective.”\n\nSome ransomware gangs have already started using this new delivery mechanism, and this\ncould be early signs of a fledgling trend. Even organizations confident with their perimeter\nsecurity are called to double back and take mitigation steps to detect and block phishing\nattempts that could involve HTML smuggling. As we can see, disabling JavaScript is no\nlonger enough.\n\nA\n\nsample of an email that uses HTML smuggling. This is part of a Trickbot spear-phishing\ncampaign. (Source: Microsoft)\n\n## Staying secure against HTML smuggling attacks\n\nA layered approach to security is needed to successfully defend against HTML smuggling.\nMicrosoft suggests killing the attack chain before it even begins. Start off by checking for\ncommon characteristics of HTML smuggling campaigns by applying behavior rules that look\nfor:\n\nan HTML file containing suspicious script\nan HTML file that obfuscates a JS\nan HTML file that decodes a Base64 JS script\na ZIP file email attachment containing JS\na password-protected attachment\n\nOrganizations should also configure their endpoint security products to block:\n\n\n-----\n\nJavaScript or VBScript from automatically running a downloaded executable file\nRunning potentially obfuscated scripts\nExecutable files from running “unless they meet a prevalence, age, or trusted list\ncriterion”\n\n[BleepingComputer recommends other mitigating steps, such as associating JavaScript files](https://www.bleepingcomputer.com/news/security/microsoft-warns-of-surge-in-html-smuggling-phishing-attacks/)\nwith a text editor like Notepad. This prevents the script from actually running but would let the\nuser view its code safely instead.\n\nFinally, organizations must educate their employees about HTML smuggling and train them\non how to respond to it properly when encountered. Instruct them to never run a file that\nends in either .js or .jse as these are JavaScript files. They should be deleted immediately.\n\nStay safe!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-15 - Evasive maneuvers- HTML smuggling explained.pdf"
    ],
    "report_names": [
        "2021-11-15 - Evasive maneuvers- HTML smuggling explained.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536200,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653785940,
    "ts_modification_date": 1653785940,
    "files": {
        "pdf": "https://archive.orkl.eu/0e3735fa4c4446b40628950cc2e2e5718bb48349.pdf",
        "text": "https://archive.orkl.eu/0e3735fa4c4446b40628950cc2e2e5718bb48349.txt",
        "img": "https://archive.orkl.eu/0e3735fa4c4446b40628950cc2e2e5718bb48349.jpg"
    }
}