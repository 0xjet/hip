{
    "id": "cddbb722-a2f0-47b5-8a49-584f73d19136",
    "created_at": "2023-01-12T15:06:26.636158Z",
    "updated_at": "2025-03-27T02:17:14.487793Z",
    "deleted_at": null,
    "sha1_hash": "20a23e39d384b561e0a0509ff53075ebdbfcf9e9",
    "title": "2018-08-03 - Volatility Plugin for Detecting Cobalt Strike Beacon",
    "authors": "",
    "file_creation_date": "2022-05-28T00:27:16Z",
    "file_modification_date": "2022-05-28T00:27:16Z",
    "file_size": 430705,
    "plain_text": "# Volatility Plugin for Detecting Cobalt Strike Beacon\n\n**[blogs.jpcert.or.jp/en/2018/08/volatility-plugin-for-detecting-cobalt-strike-beacon.html](https://blogs.jpcert.or.jp/en/2018/08/volatility-plugin-for-detecting-cobalt-strike-beacon.html)**\n\n[JPCERT/CC](https://blogs.jpcert.or.jp/en/retiree_blog/)\n\nAugust 3, 2018\n\n[Python](https://blogs.jpcert.or.jp/en/tags/python/)\n\n[Email](http://10.10.0.46/mailto:?subject=Volatility%20Plugin%20for%20Detecting%20Cobalt%20Strike%20Beacon&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2018%2F08%2Fvolatility-plugin-for-detecting-cobalt-strike-beacon.html)\n\nJPCERT/CC has observed some Japanese organisations being affected by cyber attacks\nleveraging “Cobalt Strike” since around July 2017. It is a commercial product that simulates\ntargeted attacks [1], often used for incident handling exercises, and likewise it is an easy-touse tool for attackers. Reports from LAC [2] and FireEye [3] describe details on Cobalt Strike\nand actors who conduct attacks using this tool.\n\nCobalt Strike is delivered via a decoy MS Word document embedding a downloader. This will\ndownload a payload (Cobalt Strike Beacon), which will be executed within the memory. Since\nCobalt Strike Beacon is not saved on the filesystem, whether a device is infected cannot be\nconfirmed just by looking for the file itself. There is a need to look into memory dump or\nnetwork device logs.\n\nThis article is to introduce a tool that we developed to detect Cobalt Strike Beacon from the\nmemory. It is available on GitHub - Feel free to try from the following webpage:\n\nJPCERTCC/aa-tools · GitHub\n\n[https://github.com/JPCERTCC/aa-tools/blob/master/cobaltstrikescan.py](https://github.com/JPCERTCC/aa-tools/blob/master/cobaltstrikescan.py)\n\n**Tool details**\n\nThis tool works as a plugin for The Volatility Framework (hereafter “Volatility”), a memory\nforensic tool. Here are the functions of cobaltstrikescan.py:\n\ncobaltstrikescan: Detect Cobalt Strike Beacon from memory image\ncobaltstrikeconfig: Detect Cobalt Strike Beacon from memory image and extract\nconfiguration\n\nTo run the tool, save cobaltstrikescan.py in ”contrib/plugins/malware” folder in Volatility, and\nexecute the following command:\n\n\n-----\n\n```\n$python vol.py [cobaltstrikescan|cobaltstrikeconfig] f <memory.image> profile\n<profile>\n\n```\nFigure 1 shows an example output of cobaltstrikescan. You can see the detected process\nname (Name) and process ID (PID) indicating where the malware is injected to.\n\nFigure 1: Execution results of cobaltstrikescan\n\nFigure 2 shows an example output of cobalrstrikeconfig. Please refer to Appendix A for\nconfiguration details for Cobalt Strike Beacon.\n\nFigure 2: Execution results of cobaltstrikeconfig\n\n\n-----\n\n**In closing**\n\nActors using Cobalt Strike continue attacks against Japanese organisations. We hope this\ntool helps detecting the attack in an early stage.\n\n- Takuya Endo\n\n_(Translated by Yukako Uchida)_\n\n**Reference**\n\n[1] Strategic Cyber LLC:COBALT STRIKE ADVANCED THREAT TACTICS FOR\nPANETRATION TESTERS\n\n\n-----\n\n[https://www.cobaltstrike.com/](https://www.cobaltstrike.com/)\n\n[2] LAC: New attacks by APT actors menuPass (APT10) observed (Japanese)\n\n[https://www.lac.co.jp/lacwatch/people/20180521_001638.html](https://www.lac.co.jp/lacwatch/people/20180521_001638.html)\n\n[3] FireEye: Privileges and Credentials: Phished at the Request of Counsel\n\n[https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html](https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html)\n\n[4] Cybereason: Operation Cobalt Kitty: A large-scale APT in Asia carried out by the\nOceanLotus Group\n\n[https://www.cybereason.com/blog/operation-cobalt-kitty-apt](https://www.cybereason.com/blog/operation-cobalt-kitty-apt)\n\n**Appendix A**\n\nTable A: Configuration format\n\n**Offset** **Length** **Description**\n\n0x00 2 index (Refer to Table B)\n\n0x02 2 Data length\n\n1 = 2 byte, 2 = 4 byte, 3 = as specified in 0x04\n\n0x04 2 Data length\n\n0x06 As specified in 0x04 Data\n\nTable B: Configuration\n\n**Offset** **Description** **Remarks**\n\n0x01 BeaconType 0=HTTP, 1=Hybrid HTTP and DNS, 8=HTTPS\n\n0x02 Port number\n\n0x03 Polling time\n\n0x04 Unknown\n\n0x05 Jitter Ratio of jitter in polling time (0-99%)\n\n0x06 Maxdns Maximum length of host name when using\nDNS (0-255)\n\n0x07 Unknown\n\n\n-----\n\n**Offset** **Description** **Remarks**\n\n0x08 Destination host\n\n0x09 User agent\n\n0x0a Path when communicating\nHTTP_Header2\n\n0x0b Unknown\n\n0x0c HTTP_Header1\n\n0x0d HTTP_Header2\n\n0x0e Injection process\n\n0x0f Pipe name\n\n0x10 Year Stops operating after the specified date by\nYear, Month, Day\n\n0x11 Month\n\n0x12 Day\n\n0x13 DNS_idle\n\n0x14 DNS_Sleep\n\n0x1a HTTP_Method1\n\n0x1b HTTP_Method2\n\n0x1c Unknown\n\n0x1d Process to inject arbitrary\nshellcode (32bit)\n\n0x1e Process to inject arbitrary\nshellcode (64bit)\n\n0x1f Unknown\n\n0x20 Proxy server name\n\n0x21 Proxy user name\n\n0x22 Proxy password\n\n\n-----\n\n**Offset** **Description** **Remarks**\n\n0x23 AccessType 1 = Do not use proxy server\n\n2 = Use IE configuration in the registry\n\n4 = Connect via proxy server\n\n0x24 create_remote_thread Flag whether to allow creating threads in other\nprocesses\n\n0x25 Not in use\n\n[Email](http://10.10.0.46/mailto:?subject=Volatility%20Plugin%20for%20Detecting%20Cobalt%20Strike%20Beacon&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2018%2F08%2Fvolatility-plugin-for-detecting-cobalt-strike-beacon.html)\n\nAuthor\n\n[JPCERT/CC](https://blogs.jpcert.or.jp/en/retiree_blog/)\n\nPlease use the below contact form for any inquiries about the article.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid. Thank you!\n\n## Related articles\n\nAnalysis of HUI Loader\n\n\n-----\n\nAnti-UPX Unpacking Technique\n\nFAQ: Malware that Targets Mobile Devices and How to Protect Them\n\nMalware WinDealer used by LuoYu Attack Group\n\nMalware Gh0stTimes Used by BlackTech\n\n\n[Back](https://blogs.jpcert.or.jp/en/2018/07/malware-wellmes-9b78.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2018/09/visualise-sysmon-logs-and-detect-suspicious-device-behaviour--sysmonsearch.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-03 - Volatility Plugin for Detecting Cobalt Strike Beacon.pdf"
    ],
    "report_names": [
        "2018-08-03 - Volatility Plugin for Detecting Cobalt Strike Beacon.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535986,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1653697636,
    "ts_modification_date": 1653697636,
    "files": {
        "pdf": "https://archive.orkl.eu/20a23e39d384b561e0a0509ff53075ebdbfcf9e9.pdf",
        "text": "https://archive.orkl.eu/20a23e39d384b561e0a0509ff53075ebdbfcf9e9.txt",
        "img": "https://archive.orkl.eu/20a23e39d384b561e0a0509ff53075ebdbfcf9e9.jpg"
    }
}