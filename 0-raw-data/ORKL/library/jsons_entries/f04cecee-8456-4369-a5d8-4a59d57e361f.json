{
    "id": "f04cecee-8456-4369-a5d8-4a59d57e361f",
    "created_at": "2023-01-12T15:09:56.396798Z",
    "updated_at": "2025-03-27T02:14:39.052235Z",
    "deleted_at": null,
    "sha1_hash": "71f72a5f0337514514d6779c801cb89a1fdef9b3",
    "title": "2017-03-17 - Grabbot is Back to Nab Your Data",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:29Z",
    "file_modification_date": "2022-05-29T01:20:29Z",
    "file_size": 504749,
    "plain_text": "# Grabbot is Back to Nab Your Data\n\n**[blog.fortinet.com/2017/03/17/grabbot-is-back-to-nab-your-data](http://blog.fortinet.com/2017/03/17/grabbot-is-back-to-nab-your-data)**\n\n## Introduction\n\n\nMarch 17, 2017\n\n\n[Fortinet has discovered a new botnet capable of stealing large amounts of user information,](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html)\nas well as remotely manipulating compromised machines. The malware appears to be based\non an older botnet known as Grabbot, which was first discovered back in November of 2014.\nThis new variant improves on that existing functionality while adding several dangerous new\nfeatures. This blog aims to offer a quick insight into how Grabbot functions.\n\n## Replication\n\nThe bot can be found hosted on a number of compromised websites with a random filename.\nWe currently suspect that Grabbot may arrive on these hosts through Exploit Kits or other\nmalicious campaigns.\n\nThe bot may drop several files in the following paths:\n\n- %AppData%\\{GUID}\\{generated filename}.exe\"\n\n- %AppData%\\{GUID}\\{generated filename}.bat\"\n\n- %AppData%\\{GUID}\\{generated filename}\"\n\nNote that each generated filename is different, with the host machine’s System Volume\nInformation. Several mutexes are created in the same way. Each drop file also has its file\ntime information set to be the same as “cmd.exe” in Windows.\n\n\n-----\n\nThe malware creates the following registry entry to survive system reboots:\n\n- KEY_CURRENT_USER\\Software\\Microsoft\\ Windows\\CurrentVersion\\Run\n\n- GUID} = \"%AppData%\\{GUID}\\{generated filename}.exe\"\n\nDuring execution, the bot may inject the main payload into explorer.exe and delete the\noriginal file.\n\n## Browser Targeting\n\nThe bot enters a sleep loop and will not perform the rest of its functionality unless one of the\nfollowing internet browsers is found in the active process list:\n\n- nternet Explorer (iexplore.exe)\n\n- irefox (firefox.exe)\n\n- oogle Chrome (chrome.exe)\n\n- pera (opera.exe)\n\nAnti-analysis measures\n\nThe bot also scans active processes for the presence of certain system analysis tools, such\nas Wireshark or Process Explorer. If any is found, the bot may branch into a fake set of\nbehaviours instead of the actual payload.\n\nFig.1: Searching for hashes of specific process names\n\n\n-----\n\nFig. 2: Part of the fake behaviour - Random domain name generation and contact\n\n## C&C Connection\n\nBefore the bot attempts to contact the command and control (C&C) server, it first makes a\nconnection to www.microsoft.com to verify internet connectivity. If a connection can be\nestablished, the bot will iterate through a list of possible C&C servers and contact each until\na response is received. The list of C&Cs observed in this sample are:\n\n- ttp://de{REMOVED}is.site\n\n- ttp://ge{REMOVED}et.site\n\n- ttp://bi{REMOVED}ys.info\n\n- ttp://on{REMOVED}nc.site\n\n- ttp://de{REMOVED}is.info\n\n- ttp://ss{REMOVED}rs.info\n\nWhen a connection is established, the bot may attempt to download the following data files:\n\n- wordpress/ajax/d.dat\n\n- wordpress/ajax/e.dat\n\n- wordpress/ajax/f.dat\n\n- wordpress/ajax/out.dat\n\n- wordpress/ajax/g.dat\n\n\n-----\n\n- wordpress/ajax/h.dat\n\nThe files are saved on the disk with a generated filename. Notably, the file “out.dat” is\nrenamed to the executable file in the autorun registry. All communication between the bot\nand the C&C are encrypted and done through HTTP. In any contact with a C&C, the bot will\ntry twice to establish connection before trying a different C&C.\n\nFig.3: C&C communication\n\n## C&C Commands\n\nThe botnet is capable of responding to the following commands:\n\n**Command** **Function**\n\nuser_execute Executes a file on the host machine\n\nbot_update Updates the bot itself\n\nconf_update Updates the bot configuration\n\nbot_uninstall Removes the bot from the host machine\n\n\n-----\n\nconf_update2 Updates the bot configuration\n\nsend_debug Send system information and log data to C2\n\nsocks_bc Establish SOCKS proxy\n\nrun_vnc Creates VNC connection\n\ninstall_bd1 Install Teamviewer backdoor\n\nurl_block_add Blocks specific URLs from being accessed\n\nurl_block_rem Removes URL blocking\n\ngrab_ftp Retrieves FTP information from host\n\ngrab_cookies Retrieves browser cookies from host\n\ngrab_sol Retrieves local shared objects/flash cookies\n\ngrab_certs Retrieves client certificates\n\ngrab_all Retrieves data from all grab functions\n\ndel_cookies Deletes browser cookies\n\ngrab_pop Retrieves Outlook POP accounts\n\nrun_plugin_exe Downloads and injects an executable into svchost.exe and runs it\n\nrun_plugin_dll Downloads and injects a library into svchost.exe and runs it\n\nCompared to the previous known version of Grabbot, there are several new commands\nlabeled “conf_update2”, “install_bd1”, “grab_pop”, “run_plugin_exe” and “run_plugin_dll”.\n\n## Sending Back Debug Information\n\n\n-----\n\nThe bot is able to extract current system information, including a list of active processes,\ndetected AV products, and a list of installed applications. The bot may send this information\nto the C&C on command.\n\nFig.4: System debug information\n\n## Banking Backdoor\n\nThe bot is also capable of tracking if specific sites, namely financial institutions and services,\nare accessed, and may launch a proxy or remote access backdoor to steal information.\nSome targeted sites from the list are as follows (in the format of *[URL]*;[backdoor cmd]\n\n[arguments]):\n\n- paypal.com*;socks_bc 5.{REMOVED}.250:7777\n\n- hxxps://www1.royalbank.com/cgi-bin/rbaccess/*;run_vnc\n\n- hxxps://easyweb.td.com/*;run_vnc\n\n- hxxps://www1.bmo.com/onlinebanking/cgi-bin/netbnx/NBmain?product=5*;run_vnc\n\n## Crypto-Currency Wallet Stealing\n\nThe bot recursively scans the %AppData% directory looking for files with the name\n“wallet.dat”, “electrum.dat” or “wallet”. If any match is found, the contents of the file are read\nand encrypted, then stored into a temporary file for retrieval.\n\n\n-----\n\nFig.5: Wallet data to be retrieved\n\n## Conclusion\n\nGrabbot was a relatively unknown bot in the past, but from our brief analysis of this new\nvariant it is apparent that Grabbot now has the potential to be very dangerous. Although we\nare still investigating its current distribution method, Fortinet is able to detect this new variant\nand we will keep you updated on any further changes.\n\nSample MD5: d439c468d59f117c584bda463b03aea9\n\nSample SHA256: 6d8ce2d1b33ff42ba04ded09fe79cff158e6dfffa82f6ceada12f4fda6d0c221\n\nFortinet Detection Name: W32/Kryptik.VVV!tr\n\n_[Sign up for weekly Fortinet FortiGuard Labs Threat Intelligence Briefs and stay on top of the](http://ftnt.net/2iT7Mcp%C2%A0)_\n_newest emerging threats._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-03-17 - Grabbot is Back to Nab Your Data.pdf"
    ],
    "report_names": [
        "2017-03-17 - Grabbot is Back to Nab Your Data.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536196,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653787229,
    "ts_modification_date": 1653787229,
    "files": {
        "pdf": "https://archive.orkl.eu/71f72a5f0337514514d6779c801cb89a1fdef9b3.pdf",
        "text": "https://archive.orkl.eu/71f72a5f0337514514d6779c801cb89a1fdef9b3.txt",
        "img": "https://archive.orkl.eu/71f72a5f0337514514d6779c801cb89a1fdef9b3.jpg"
    }
}