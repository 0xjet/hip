{
    "id": "1aa6c583-8b85-4fdc-93d2-ce9e93155ecc",
    "created_at": "2023-01-12T15:07:40.149283Z",
    "updated_at": "2025-03-27T02:05:36.978027Z",
    "deleted_at": null,
    "sha1_hash": "41184661e0984aa6b9737bba61e3fed91cbb3437",
    "title": "2020-07-30 - Obscured by Clouds- Insights into Office 365 Attacks and How Mandiant Managed Defense Investigates",
    "authors": "",
    "file_creation_date": "2022-05-28T02:40:07Z",
    "file_modification_date": "2022-05-28T02:40:07Z",
    "file_size": 148107,
    "plain_text": "# Obscured by Clouds: Insights into Office 365 Attacks and How Mandiant Managed Defense Investigates\n\n**[fireeye.com/blog/threat-research/2020/07/insights-into-office-365-attacks-and-how-managed-defense-investigates.html](https://www.fireeye.com/blog/threat-research/2020/07/insights-into-office-365-attacks-and-how-managed-defense-investigates.html)**\n\n## Breadcrumb\n\nThreat Research\n\nJoseph Hladik, Josh Fleischer\n\nJul 30, 2020\n\n16 mins read\n\nThreat Research\n\n\n-----\n\n[With Business Email Compromises (BECs) showing no signs of slowing down, it is becoming](https://pdf.ic3.gov/2019_IC3Report.pdf)\nincreasingly important for security analysts to understand Office 365 (O365) breaches and\nhow to properly investigate them. This blog post is for those who have yet to dip their toes\ninto the waters of an O365 BEC, providing a crash course on Microsoft’s cloud productivity\nsuite and its assortment of logs and data sources useful to investigators. We’ll also go over\ncommon attacker tactics we’ve observed while responding to BECs and provide insight into\nhow Mandiant Managed Defense analysts approach these investigations at our customers\nusing PowerShell and the FireEye Helix platform.\n\n**Office 365**\n\nOffice 365 is Microsoft’s cloud-based subscription service for the Microsoft Office suite. It is\nbuilt from dozens of applications tightly embedded into the lives of today’s workforce,\nincluding:\n\nExchange Online, for emails\nSharePoint, for intranet portals and document sharing\nTeams and Skype for Business, for instant messaging\nOneDrive, for file sharing\nMicrosoft Stream, for recorded meetings and presentations\n\nAs more and more organizations decide to adopt Microsoft’s cloud-based offering to meet\ntheir needs, unauthorized access to these O365 environments, or tenants in Microsoft’s\nparlance, has become increasingly lucrative to motivated attackers. The current high\nadoption rate of O365 means that attackers are getting plenty of hands on experience with\nusing and abusing the platform. While many tactics have remained largely unchanged in the\nyears since we’ve first observed them, we’ve also witnessed the evolution of techniques that\nare effective against even security-conscious users.\n\nIn general, the O365 compromises we’ve responded to have fallen into two categories:\n\nBusiness Email Compromises (BECs)\nAPT or state-sponsored intrusions\n\nBased on our experience, BECs are a common threat to any organization's O365 tenant.\nThe term “BEC” typically refers to a type of fraud committed by financially motivated\nattackers. BEC actors heavily rely on social engineering to carry out their schemes,\nultimately defrauding organizations and even personnel.\n\nOne common BEC scheme involves compromising a C-suite executive’s account via\nphishing. Once the victim unwittingly enters their credentials into a web form masquerading\nas the legitimate Office 365 login portal, attackers log in and instruct others in the\norganization to conduct a wire transfer, perhaps under the guise of an upcoming acquisition\nthat has yet to be publicly announced. However, we’ve also observed more effective\nschemes where attackers compromise those in financial positions and patiently wait until an\n\n\n-----\n\nemail correspondence has begun about a due payment. Attackers seize this opportunity by\nsending a doctored invoice (sometimes based on a legitimate invoice that had been stolen\nearlier) on behalf of the compromised user to another victim responsible for making\npayments. These emails are typically hidden from the compromised user due to attackercreated Outlook mailbox rules. Often times, by the time the scheme is inevitably discovered\nand understood days or weeks later, the money is unrecoverable—highlighting the\nimportance of contacting law enforcement immediately if you’ve fallen victim to a fraud.\n\nThe personal finances of staff aren’t off limits to attackers either. We’ve observed several\ncases of W-2 scams, in which attackers send a request to HR for W-2 information from the\nvictim’s account. Once obtained, this personally identifiable information is later used to\nconduct tax fraud.\n\nConversely, APT intrusions are typically more sophisticated and are conducted by statesponsored threat actors. Rather than for financial gain, APT actors are usually tasked to\ncompromise O365 tenants for purposes of espionage, data theft, or destruction. Given the\nwealth of sensitive information housed in any given organization’s O365 tenant, APT actors\nmay not even need to touch a single endpoint to complete their mission, sidestepping the\nmany security controls organizations have implemented and invested in.\n\n**O365 Logs and Data Sources**\n\nIn this section, we’ll touch on the multitude of logs and portals containing forensic data\nrelevant to an O365 investigation.\n\nBefore we can begin investigating an O365 case, we’ll work with our clients to get an\n“Investigator” account provisioned with the roles required to obtain the forensic data we\nneed. For the purposes of this blog post, we’ll quickly list the roles needed for an Investigator\naccount, but during an active Managed Defense investigation, a designated Managed\nDefense consultant will provide further guidance on account provisioning.\n\nAt a minimum, the Investigator account should have the following roles:\n\n_Exchange Admin Roles_\n\nView-only audit logs\nView-only configuration\nView-only recipients\nMailbox Search\nMessage Tracking\n\n_eDiscovery Rights_\n\neDiscovery Manager role\n\n_Azure Active Directory Roles_\n\n\n-----\n\nGlobal Reader\n\n**Unified Audit Log (UAL)**\n\nThe Unified Audit Log records activity from various applications within the Office 365 suite,\nand can be considered O365’s main log source. Entries in the UAL are stored in JSON\nformat. We recommend using the PowerShell cmdlet Search-UnifiedAuditLog to query the\nUAL as it allows for greater flexibility, though it can also be acquired from the Office 365\n[Security & Compliance Center located at protection.office.com. In order to leverage this log](https://protection.office.com/)\nsource (and the Admin Audit Log), ensure that the Audit Log Search feature is enabled.\n\nThe UAL has a few nuances that are important to consider. While it provides a good highlevel summary of activity across various O365 applications, it won’t log comprehensive\nmailbox activity (for that, acquire the Mailbox Audit Log). Furthermore, the UAL has a few\nlimitations, namely:\n\nResults to a single query are limited to 5000 results\nOnly 90 days of activity are retained\nEvents may take up to 24 hours before they are searchable\n\n**Mailbox Audit Log (MAL)**\n\nThe Mailbox Audit Log, part of Exchange Online, will capture additional actions performed\nagainst objects within a mailbox. As such, it’s a good idea acquire and analyze the MAL for\neach affected user account with the PowerShell cmdlet Search-MailboxAuditLog. Note that\nentries in the MAL will be retained for 90 days (by default) and timestamps will be based on\nthe user’s local time zone. The MAL’s retention time can always be increased with the\nPowerShell cmdlet Set-Mailbox along with the AuditLogAgeLimit parameter.\n\n[At the time of writing this post, Microsoft has recently released information about enhanced](https://docs.microsoft.com/en-us/microsoft-365/compliance/advanced-audit?view=o365-worldwide)\nauditing functionality that gives investigators insight into which emails were accessed by\nattackers. This level of logging for regular user accounts is only available for organizations\nwith an Office 365 E5 subscription. Once Advanced Auditing is enabled, mail access activity\nwill be logged under the MailItemsAccessed operation in both the UAL and MAL.\n\n**Administrator Audit Log**\n\nIf the Audit Log Search feature is enabled, this supplemental data source logs all PowerShell\nadministrative cmdlets (including command-line arguments) executed by administrators. If\nyou suspect that an administrator account was compromised, don’t overlook this log! The\nPowerShell cmdlet Search-AdminAuditLog is used to query these logs, but note that the\n_Audit Log Search feature must be enabled and the same 90 day retention limit will be in_\nplace.\n\n**Azure AD Logs**\n\n\n-----\n\n[Azure AD logs can be accessed from the Azure portal (portal.azure.com) under the Azure](https://portal.azure.com/)\nActive Directory service. Azure AD Sign-in logs contain detailed information about how\nauthentications occur and O365 application usage. Azure AD audit logs are also a valuable\nsource of information, containing records of password resets, account creations, role\nmodifications, OAuth grants, and more that could be indicative of suspicious activity. Note\nthat Azure AD logs are only available for 30 days.\n\n**Cloud App Security Portal**\n\nFor cases where OAuth abuse has been observed, information about cloud applications can\n[be found in Microsoft’s Cloud App Security portal (portal.cloudappsecurity.com). Access to](https://portal.cloudappsecurity.com/)\nthis portal requires an E5 license or a standalone Cloud App license. For more background\non OAuth abuse, be sure to check out our blog post: Shining a Light on OAuth Abuse with\n_PwnAuth._\n\n**Message Traces**\n\nMessage traces record the emails sent and received by a user. During an investigation, run\nreports on any email addresses of interest. The message trace report will contain detailed\nmail flow information as well as subject lines, original client IP addresses, and message\nsizes. Message traces are useful for identifying emails sent by attackers from compromised\naccounts, and can also aid in identifying initial phishing emails if phishing was used for initial\naccess. To obtain the actual emails, use the Content Search tool.\n\nOnly the past 10 days of activity is available with the Get-MessageTrace PowerShell cmdlet.\nHistorical searches for older messages can be run with the Get-HistoricalSearch cmdlet (up\nto 90 days by default), but historical searches typically take hours for the report to be\navailable. Historical reports can also be generated within the Security and Compliance\nCenter.\n\n**eDiscovery Content Searches**\n\nThe Content Search tool allows investigators to query for emails, documents, and instant\nmessage conversations stored in an Office 365 tenant. We frequently run Content Search\nqueries to find and acquire copies of emails sent by attackers. Content searches are limited\nto what has been indexed by Microsoft, so recent activity may not immediately appear.\nAdditionally, only the most recent 1000 items will be shown in the preview pane.\n\n**Anatomy of an O365 BEC**\n\nAs mentioned earlier, BECs are one of the more prevalent threats to O365 tenants seen by\nManaged Defense today. Sometimes, Mandiant analysts respond to several BEC cases at\nour customers within the same week. With this frontline experience, we’ve compiled a list of\ncommonly observed tactics and techniques to advise our readers about the types of activities\n\n\n-----\n\none should anticipate. Please note that this is by no means a comprehensive list of O365\nattacks, rather a focus on the usual routes we’ve seen BEC actors take to accomplish their\nobjective.\n\n**Phase 1: Initial Compromise**\n\nPhishing: Emails with links to credential harvesting forms sent to victims, sometimes\nfrom the account of a compromised business partner.\nBrute force: A large dictionary of passwords attempted against an account of interest.\nPassword spray: A dictionary of commonly used passwords attempted against a list of\nknown user accounts.\nAccess to credential dump: Valid credentials used from a previous compromise of the\nuser.\nMFA bypasses: Use of mail clients leveraging legacy authentication protocols (e.g.\nIMAP/POP), which bypass MFA policies. Attackers may also spam push notifications to\nthe victim by repeatedly attempting to log in, eventually leading to the victim mistakenly\naccepting the prompt.\n\n**Phase 2: Establish Foothold**\n\nMore phishing: Additional phishing lures sent to internal/external contacts from\nOutlook’s global address list.\nMore credible lures: New phishing lures uploaded to the compromised user's OneDrive\nor SharePoint account and shared with the victim’s coworkers.\nSMTP forwarding: SMTP forwarding enabled in the victim’s mailbox to forward all email\nto an external address.\nForwarding mailbox rules: Mailbox rules created to forward all or certain mail to an\nexternal address.\nMail client usage: Outlook or third-party mail clients used by attackers. Mail will\ncontinue to sync for a short while after a password reset occurs.\n\n**Phase 3: Evasion**\n\nEvasive mailbox rules: Mailbox rules created to delete mail or move some or all\nincoming mail to uncommonly used folders in Outlook, such as “RSS Subscriptions”.\nManual evasion: Manual deletion of incoming and sent mail. Attackers may forego\nmailbox rules entirely.\nMail forwarding: Attackers accessing emails without logging in if a mechanism to\nforward mail to an external address was set up earlier.\nMail client usage: Outlook or third-party mail clients used by attackers. Mail can be\nsynced locally to the attacker’s machine and accessed later.\nVPN usage: VPN servers, sometimes with similar geolocations to their victims, used in\nan attempt to avoid detection and evade conditional access policies.\n\n\n-----\n\n**Phase 4: Internal Reconnaissance**\n\nOutlook searching: The victim’s mailbox queried by attackers for emails of interest.\n[While not recorded in audit logs, it may be available to export if it was not deleted by](https://support.office.com/en-us/article/delete-search-history-or-export-search-history-in-outlook-on-the-web-582647f4-fae8-46ed-9f78-49b919ddfc69)\nattackers.\nO365 searching: Searches conducted within SharePoint and other O365 applications\nfor content of interest. While not recorded in audit logs, SharePoint and OneDrive file\ninteractions are recorded in the UAL.\nMail client usage: Outlook or third-party mail clients used by attackers. Mail can be\nsynced locally to the attacker’s machine and accessed later.\n\n**Phase 5: Complete Mission**\n\nDirect deposit update: A request sent to the HR department to update the victim’s direct\ndeposit information, redirecting payment to the BEC actor.\nW-2 scam: A request sent to the HR department for W-2 forms, used to harvest PII for\ntax fraud.\nWire transfer: A wire transfer requested for an unpaid invoice, upcoming M&A,\ncharities, etc.\nThird-party account abuse: Abuse of the compromised user’s privileged access to thirdparty accounts and services, such as access to a corporate rewards site.\n\n**How Managed Defense Responds to O365 BECs**\n\nIn this section, we’re going to walk through how Managed Defense investigates a typical\nO365 BEC case.\n\nMany of the steps in our investigation rely on querying for logs with PowerShell. To do this,\nfirst establish a remote PowerShell session to Exchange Online. The following Microsoft\ndocumentation provides guidance on two methods to do this:\n\n[Connect to Exchange Online PowerShell with Basic authentication](https://docs.microsoft.com/en-us/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell)\n[Use the Exchange Online PowerShell with modern authentication using V2 module](https://docs.microsoft.com/en-us/powershell/exchange/exchange-online-powershell-v2)\n\n\n-----\n\nobscured365\n\n\n**Broad Scoping**\n\nWe start our investigations off by running broad queries against the Unified Audit Log (UAL)\nfor suspicious activity. We’ll review OAuth activity too, which is especially important if\nsomething more nefarious than a financially motivated BEC is suspected. Any FireEye gear\navailable to us—such as FireEye Helix and Email Security—will be leveraged to augment the\ndata available to us from Office 365.\n\nThe following are a few initial scoping queries we’d typically run at the beginning of a\nManaged Defense engagement.\n\n_Scoping Recent Mailbox Rule Activity_\n\n\n-----\n\nEven in large tenants, pulling back all recent mailbox rule activity doesn t typically produce\nan unmanageable number of results, and attacker-created rules tend to stand out from the\nrest of the noise.\n\nQuerying UAL for all mailbox rule activity in Helix:\n\nclass=ms_office365 action:[New-InboxRule, Set-InboxRule, Enable-InboxRule] | table\n\n[createdtime, action, username, srcipv4, srcregion, parameters, rawmsg]\n\nQuery UAL for new mail rule activity in PowerShell:\n\nSearch-UnifiedAuditLog -StartDate (Get-Date).AddDays(-90) -EndDate (Get-Date) ResultSize 5000 -Operations \"New-InboxRule\",\"Set-InboxRule\",\"Enable-InboxRule\" |\nExport-CSV \\path\\to\\file.csv –NoTypeInformation -Encoding utf8\n\n_Scoping SMTP Forwarding Activity_\n\nSMTP forwarding is sometimes overlooked because it appears under a UAL operation\nseparate from mailbox rules. This query looks for the Set-Mailbox operation containing a\n[parameter to forward mail over SMTP, indicative of automatic forwarding being enabled from](https://support.office.com/en-us/article/turn-on-automatic-forwarding-in-outlook-on-the-web-7f2670a1-7fff-4475-8a3c-5822d63b0c8e)\nOWA.\n\nQuerying UAL for SMTP forwarding in Helix:\n\nclass=ms_office365 action=Set-Mailbox rawmsg:ForwardingSmtpAddress | table\n\n[createdtime, action, username, srcipv4, srcregion, parameters, rawmsg]\n\nQuerying UAL for SMTP forwarding in PowerShell:\n\nSearch-UnifiedAuditLog -StartDate (Get-Date).AddDays(-90) -EndDate (Get-Date) ResultSize 5000 -FreeText \"ForwardingSmtpAddress\" | Export-CSV \\path\\to\\file.csv –\nNoTypeInformation -Encoding utf8\n\n**Analyze Compromised Users Logs**\n\nAfter we’ve finished scoping the tenant, we’ll turn our attention to the individual users\nbelieved to be involved in the compromise. We’ll acquire all relevant O365 logs for the\nidentified compromised user(s) - this includes the user's UAL, Mailbox Audit Log (MAL), and\nAdmin audit log (if the user is an administrator). We’ll review these logs for anomalous\naccount activity and assemble a list of attacker IP addresses and User-Agents strings. We’ll\nuse this list to further scope the tenant.\n\nO365 investigations rely heavily on anomaly detection. Many times, the BEC actor may even\nbe active at the same time as the user. In order to accurately differentiate between legitimate\nuser activity and attacker activity within a compromised account, it's recommended to pull\n\n\n-----\n\nback as much data as possible to use as a reference for legitimate activity. Using the Helix\nquery transforms groupby < [srccountry,srcregion], **_groupby < useragentandgroupby <_**\n**_srcipv4,which highlight the least common geolocations, User Agent strings, and IP_**\naddresses, can also assist in identifying anomalies in results.\n\nQuerying UAL for a user in Helix:\n\nclass=ms_office365 username=user@client.com | table [createdtime, action, username,\nsrcipv4, srccountry, srcregion, useragent, rawmsg] | groupby < [srccountry,srcregion]\n\nQuerying UAL for a user in PowerShell:\n\nSearch-UnifiedAuditLog -StartDate mm/dd/yyyy -EndDate (Get-Date) -ResultSize 5000 UserIds user@client.com | Export-CSV \\path\\to\\file.csv –NoTypeInformation -Encoding\nutf8\n\nQuerying MAL for a user in PowerShell:\n\nSearch-MailboxAuditLog -Identity user@client.com -LogonTypes Owner,Delegate,Admin ShowDetails -StartDate (Get-Date).AddDays(-90) -EndDate (Get-Date) | Export-CSV\n\\path\\to\\file.csv –NoTypeInformation -Encoding utf8\n\nQuerying Admin Audit Log for all events within a certain date in PowerShell:\n\nSearch-AdminAuditLog -StartDate mm/dd/yyyy -EndDate mm/dd/yyyy | Export-CSV\n\\path\\to\\file.csv –NoTypeInformation -Encoding utf8\n\n**Query UAL with New Leads**\n\nNow that we’ve built a list of suspicious IP addresses (or even entire CIDR ranges) and\nUser-Agent strings, we’ll run new queries against the entire UAL to try to identify other\ncompromised user accounts. We’ll repeat this step and the previous step for each newly\n_identified user account._\n\nOne advantage to using FireEye Helix platform over PowerShell is that we can query entire\nCIDR ranges. This is helpful when we observe attackers coming from a VPN or ISP that\ndynamically assigns IP addresses within the same address block.\n\nQueries for attacker User-Agent strings usually generate more noise to sift through than IP\naddress searches. In practice, User-Agent queries are only beneficial if the attackers are\nusing an uncommon browser or version of a browser. Due to limitations of the Search**UnifiedAuditLog cmdlet, we’ve had the most success using the FreeText parameter and**\nsearching for simple strings.\n\nIn Helix:\n\n\n-----\n\nclass=ms_office365 (srcipv4:[1.2.3.4, 2.3.4.0/24] OR useragent:Opera) | table\n\n[createdtime, action, username, srcipv4, srccountry, srcregion, useragent, rawmsg] |\ngroupby username\n\nQuerying the UAL for IPs and user agents in PowerShell:\n\nSearch-UnifiedAuditLog -StartDate mm/dd/yyyy -EndDate (Get-Date) -ResultSize 5000 IPAddresses 1.2.3.4, 2.3.4.5 | Export-CSV \\path\\to\\file.csv –NoTypeInformation -Encoding\nutf8\n\nSearch-UnifiedAuditLog -StartDate mm/dd/yyyy -EndDate (Get-Date) -ResultSize 5000 FreeText \"Opera\" | Export-CSV \\path\\to\\file.csv –NoTypeInformation -Encoding utf8\n\n**Analyze Message Traces**\n\nWe’ll use PowerShell to query message traces for the compromised users we’ve identified. If\nthe email was sent within the past 10 days, use the Get-MessageTrace cmdlet, which\nimmediately returns results and allows teams to query IP addresses. For older emails, use\nthe Start-HistoricalSearch cmdlet and download the report later from the Mail Flow section\nof the Security & Compliance center.\n\nQuerying for the last 10 days of mail sent by the victim in PowerShell:\n\nGet-MessageTrace -StartDate (Get-Date).AddDays(-10) -EndDate (Get-Date) SenderAddress victim@client.com | Select-Object Received, SenderAddress,\nRecipientAddress, Subject, Status, FromIP, Size, MessageID | Export-CSV \\path\\to\\file.csv\n–NoTypeInformation -Encoding utf8\n\nQuerying for older emails (up to 90 days) in PowerShell:\n\nStart-HistoricalSearch -ReportTitle \"Mandiant O365 investigation\" -StartDate mm/dd/yyyy EndDate mm/dd/yyyy -ReportType MessageTraceDetail -SenderAddress\nvictim@client.com\n\nAs Message Trace results are reviewed, attention should be given to IP addresses to\ndetermine which emails were sent by attackers. If phishing was the suspected initial\ncompromise vector, it’s a good idea to also query for incoming mail received within a few\ndays prior to the first compromise date and look for suspicious sender addresses and/or\nsubject lines.\n\n**Acquire Emails of Interest**\n\nWith our list of suspicious emails identified from message traces, we’ll use the Content\nSearch tool available in the Office 365 Security and Compliance Center acquire the email\nbody and learn what domains were used in phishing lures (if phishing was present). Content\n\n\n-----\n\nSearches are performed by using a straightforward GUI, and the results can either be\npreviewed in the browser, downloaded individually as EML files, or downloaded in bulk as\nPST files.\n\n**Final Scoping**\n\nAt this point of our investigation, the BEC should be sufficiently scoped within the tenant. To\nensure any follow-on activity hasn’t occurred, we’ll take all of the attack indicators and\nperform our final queries across the UAL.\n\nWith that said, there are still edge cases in which attacker activity wouldn’t appear in O365\nlogs. For example, perhaps an additional user has submitted their credentials to a phishing\npage, but the attackers haven’t used them to log in yet. To ensure we don’t miss this activity,\nwe’ll perform additional scoping across available network logs, specifically for IP addresses\nand domains related to the attacker’s phishing infrastructure. We’ll also leverage other\nFireEye products, such as the Endpoint Security platform, to search for phishing domains\npresent on a host’s web browser history.\n\n**Conclusion**\n\nUnauthorized access to O365 tenant doesn’t just pose a threat to an organization, but also to\nits staff and business partners. Organizations without enhanced security controls in O365 are\nat the greatest risk of experiencing a BEC. However, as multi factor-authentication becomes\nmore and more commonplace, we’ve witnessed an increase of MFA bypass attempts\nperformed by increasingly proficient attackers.\n\nIt’s important to remember that social engineering plays a primary role throughout a BEC.\nEnsure that users are trained on how to identify credential harvesting forms, a common\ncompromise vector. When in the midst of a BEC compromise, teams may want to promptly\nalert personnel in HR and finance-related roles to exercise extra caution when processing\nrequests related to banking or wire transfers while the investigation is in progress.\n\nThe examples covered in this blog post are just a sample of what Managed Defense\nperforms while investigating an Office 365 compromise. To take a proactive approach at\npreventing BECs, make sure the following best practices are implemented in a O365 tenant.\nAdditionally, FireEye Email Security offers protections against phishing and the Helix\nplatform’s O365 ruleset can alert on anomalous activity as soon as it happens.\n\n**Recommended Best Practices**\n\nEnsure mailbox audit logging is enabled on all accounts\nDisable Legacy Authentication protocols\nEnable multi-factor authentication (MFA)\nEnforce strong passwords and a password expiration policy\nForward O365 audit logs to a centralized logging platform for extended retention\n\n\n-----\n\nEnforce an account lockout policy in Azure/on-premise Active Directory\nRestrict mail forwarding to external domains\n\n**Acknowledgements**\n\nSpecial thanks to Doug Bienstock, Glenn Edwards, Josh Madeley, and Tim Martin for their\nresearch and assistance on the topic.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-30 - Obscured by Clouds- Insights into Office 365 Attacks and How Mandiant Managed Defense Investigates.pdf"
    ],
    "report_names": [
        "2020-07-30 - Obscured by Clouds- Insights into Office 365 Attacks and How Mandiant Managed Defense Investigates.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536060,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653705607,
    "ts_modification_date": 1653705607,
    "files": {
        "pdf": "https://archive.orkl.eu/41184661e0984aa6b9737bba61e3fed91cbb3437.pdf",
        "text": "https://archive.orkl.eu/41184661e0984aa6b9737bba61e3fed91cbb3437.txt",
        "img": "https://archive.orkl.eu/41184661e0984aa6b9737bba61e3fed91cbb3437.jpg"
    }
}