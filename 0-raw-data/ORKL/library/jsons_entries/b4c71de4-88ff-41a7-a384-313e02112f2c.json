{
    "id": "b4c71de4-88ff-41a7-a384-313e02112f2c",
    "created_at": "2023-01-12T14:59:07.437225Z",
    "updated_at": "2025-03-27T02:16:26.215767Z",
    "deleted_at": null,
    "sha1_hash": "12d090cf852cc07ea8ab679ab562979f87642f73",
    "title": "2021-05-14 - How Flubot targets Android phone users and their money",
    "authors": "",
    "file_creation_date": "2022-05-27T22:00:40Z",
    "file_modification_date": "2022-05-27T22:00:40Z",
    "file_size": 2207416,
    "plain_text": "# How Flubot targets Android phone users and their money\n\n**[nortonlifelock.com/blogs/research-group/flubot-targets-android-phone-users](https://www.nortonlifelock.com/blogs/research-group/flubot-targets-android-phone-users)**\n\n## Malware steals login credentials for banking and cryptocurrency apps — and it could spread around the world\n\nFlubot, also called Cabassous, is an Android banking malware (also a banking\ntrojan) that is pushed by cybercriminals in large-scale campaigns, targeting consumers\nacross Europe this spring.\n\nAccess to the botnet is being sold in underground forums by the operators to criminal\ngroups as a so-called malware-as-a-service (MAAS). The actors behind\nthe Flubot botnet sending Smishing (SMS phishing) messages with fake notices of\nupcoming package deliveries and urge the victim to follow a link to track the shipment.\n\nThe landing page then presents a download button supposedly required to track the\npackage. After a victim falls for this social engineering trick, Flubot is downloaded to the\nmobile device and requests various permissions, including access to the contact list, sending\nSMS messages, and overlaying other applications.\n\nThe contact list is subsequently sent to a command-and-control (C&C or C2) server and\nused to seed new waves of smishing messages that are sent through infected\nphones (devices).\n\n\n-----\n\nThe Flubot malware does not exploit any vulnerabilities in the Android OS or\ntargeted devices but prompts the user to manually grant two powerful system\npermissions. These permissions allow the attackers to\nsteal credentials from banking and cryptocurrency apps on infected devices, using overlays\nand then exfiltrate one-time-password (OTP) and two-factor authentication (2FA) codes.\n\n## Campaigns and versions\n\nFrom late 2020 and into early 2021, an initial Flubot campaign hit Spain\n[and reportedly infected more than 60,000 Android devices. Spanish police](https://twitter.com/LukasStefanko/status/1367829807740944389)\n[investigated and eventually arrested four men suspected of being involved in the campaign.](https://twitter.com/mossos/status/1367797770522943489)\n\nAs mentioned earlier, the Flubot operators had been renting out the botnet, so the suspects\narrested in Spain are likely just “customers” of the actual Flubot operators, trying to\nmonetize access to victims’ mobile phones. This is further evidenced by the fact that new\ncampaigns against additional countries started to emerge soon after.\n\nThe Flubot developers have been busy adding support for new target countries to the\nmalware as shown for version 3.6 to 4.1 in the visualization below.\n\n\n-----\n\nThe screenshot below shows an example of a SMS message targeting German users to lure\nthem into following a link to track a fictitious package shipment:\n\n\n-----\n\nIn some cases, the messages include the name of the recipient-— likely crafted using stolen\ncontact-list data from previous victims.\n\nThe respective links lead to country-specific landing pages, as can be seen in\nthe comparison of DHL-themed download sites below:\n\nSlide 1 of 5\n\n\n-----\n\nSlide 2 of 5\n\nSlide 3 of 5\n\n\n-----\n\nSlide 4 of 5\n\nSlide 5 of 5\n\n\n-----\n\nThere are different variants of the Flubot app that disguise themselves by using the brand\nnames of package delivery services like DHL, FedEx, UPS, or the Spanish postal service\nCorreos.\n\n\n-----\n\n## Statistics\n\n\n-----\n\nNorton Labs researchers analyzed the telemetry of our mobile protection technologies to\nmeasure the prevalence of Flubot affecting our customers. The chart below shows the total\nnumber of attempted installations of Flubot in blue. The orange line represents Flubot lure\nSMS messages as a percentage of total blocked SMS messages from unknown senders for\nthe respective day.\n\nThe second wave of attempted Flubot installations in our statistics from around April 4 to\nApril 11 coincides with the campaign in Germany. The third wave of attempted installations at\nthe end of April corresponds with the start of the Flubot campaign targeting mobile phone\nnumbers in the UK. The related smishing attacks (orange line) peaking a few days earlier.\n\n[Shown below are metrics from sinkholing efforts (as provided by Shadowserver on May](https://www.shadowserver.org/)\n11 (and previously on April 27) for seeds 1136, 1642, 1813, 1905, 1949, and 2931. These\nefforts show a decline in infections (Refer to the table of countries and seed values below).\nAs with many sophisticated malware families, it’s reasonable to expect an ebb and flow in\nthe infection (and detection) rates as sinkholing and mitigation efforts are leapfrogged by the\noperator’s improvements.\n\n\n-----\n\n## Analysis\n\nThe Flubot malware continues to evolve through active development since\nits introduction to the cybercrime underground. Especially since March of 2021, several\nversions were released ranging from 3.5 to 4.1. Even for samples\nwith the same version number, our analyses revealed differences and the addition of new\nfeatures. The research described in this section is the result of analyzing variants\nof Flubot version 4.0 that only differed in the list of targeted countries but not in functionality.\n\n## Permissions\n\nFlubot requests an extensive list of Android permissions through the system dialog upon\ninstallation:\n\nOnce the app is executed, it prompts the user to grant two additional permissions by\nfollowing instructions to manually allow “Accessibility Service” and “Notification Access”\nthrough the phone’s system settings.\n\n\n-----\n\nBelow screenshots show the app prompting the user to enable the Accessibility\nService” and its respective setting screen. The Android “Accessibility Service” is supposed to\nallow apps to assist users with disabilities. This app setting grants powerful\npermissions to control what is shown on the phone display and to intercept user\ninput. Several Android malware families have integrated prompts to socially engineer the\nuser into willfully enabling the accessibility setting to then use it for keylogging of credentials\nand overlay app screens (see below).\n\nSlide 1 of 2\n\n\n-----\n\nSlide 2 of 2\n\n\n-----\n\n-----\n\nIn the next step, the user is prompted to also enable Notification Access for the app in the\ncorresponding system dialog.\n\nSlide 1 of 2\n\nSlide 2 of 2\n\n\n-----\n\nFlubot will use the “Accessibility Service” permission to register as the default\nmessaging app on the phone. This allows the malware to quietly send and intercept SMS\nmessages and thus capture OTPs used in online banking.\n\n\n-----\n\n## Overlays\n\nThe main functionality of the Flubot mobile banking trojan is to steal login credentials for\nbanking and cryptocurrency apps running on the phone. The malware achieves this using\nthe previously mentioned permissions and abusing existing Android APIs.\n\nAfter installation, it will send a list of installed applications that the C2 server matches to a list\nof package names targeted by the cybercriminals. Flubot will then download specifically\ncrafted HTML pages that will be displayed as an “overlay” when the respective app is\n\n\n-----\n\nstarted. When the user then enters their credentials, they interact with Flubot instead of the\nbanking app and their credentials are harvested.\n\nThe following screenshot shows an overlay captured on an infected analysis device that\nintercepts the login for Spanish Liberbank:\n\n\n-----\n\n## Domain generation algorithm\n\nInstead of using a static list of C2 servers, the developers added a domain generation\nalgorithm (DGA) to Flubot. Early versions Flubot generated a list of 2,000 domains each\nmonth, while the most recent version 4.0 can generate up to 5,000 domains. When\ngenerating the domains, the algorithm alternates between appending the top-level\ndomains .ru (Russia), .su (Senegal), and .cn (China). This is notable, because it is more\ndifficult for network operators to sinkhole domains in these top-level domains.\n\nThe algorithm calculates the initialization value for the random number generator in the\nfunction above using two parameters: the year/month and a static seed value.\n\n\n-----\n\nUntil Flubot version 3.7 the seed value remained static, while later versions include different\nseed values depending on the country code of the infected Android phone as shown in the\nscreenshot below:\n\nThe current list of countries and seed values for Flubot in the analyzed variants are as\nfollows:\n\n\n-----\n\n**Prefix** **Country** **Seed Value**\n\n+34 Spain 1136\n\n+48 Poland 2931\n\n+49 Germany 1945\n\n+39 Italy 1813\n\n+44 United Kingdom 1642\n\n+81 Japan 1905\n\n+31 Netherlands 2931\n\n+45 Denmark 2931\n\n+358 Finland 2931\n\n+46 Sweden 2931\n\n+47 Norway 2931\n\n+32 Belgium 2931\n\nAfter generating the DGA domains, the malware will iterate through the list and try to\nresolve each entry to an IP. While early versions of Flubot used the DNS service configured\nin the phone, recent versions have switched to utilize encrypted DNS-over-HTTPS services\nfrom Cloudflare and Google.\n\nThe communication from the C2 to the Flubot malware is encrypted using an XOR operation\nwith a static key. Communication in the opposite direction, from the malware to the\nC2, uses RSA Public Key Infrastructure (PKI) to encrypt the data. This also doubles as\na protection mechanism to prevent researchers or competitors from taking\nover the botnet via C2. While the C2 is protected through this PKI\nscheme, sinkholing predicted DGA domains is still possible.\n\n\n-----\n\nThe malware also generates a random “Bot ID” and retrieves device information such as\nDevice ID and manufacturer details which is then submitted to the botnet during\ncommunication with the C2 server. The “Bot ID” and the first working DGA domain will then\nbe stored in an XML configuration file:\n\n## Botnet commands\n\nWhen communicating with the C2 server, the botnet can respond with the following list of\ncommands:\n\nBesides the overlays targeting specific applications, the malware also has a\ngeneric mechanism to steal credit card information through social engineering. This is\ntriggered by a “CARD_BLOCK” command from the C2 server and displays a “Google Play\nVerification Window” as shown below:\n\n\n-----\n\n## Evasion\n\nThe Flubot developers are using a custom packer and evasion mechanisms to complicate\ndetection and analysis of the malware. The main application is packed and stored under the\nfilename “assets/classes-v1.bin.” Once the app is executed, it unpacks the malware\ninto “app_apkprotector_dex/classes-v1.dex” of the application’s data directory. In addition,\ntext strings in the unpacked file are obfuscated likely using the opensource string obfuscator\nframework Paranoid1.\n\nThe screenshots below show a list of strings in Flubot before and after manual deobfuscation:\n\nSlide 1 of 2\n\n\n-----\n\nSlide 2 of 2\n\n## Version 4.1\n\nShortly before the publication of this report, a version 4.1 of Flubot was discovered. However,\nthe analysis described above still apply to the new version as well.\n\n## Summary & Outlook\n\nMobile banking trojans like Flubot are becoming more popular among cybercriminals as\nmore consumers than ever before rely on mobile devices for internet banking, access to\nfinancial services, and e-commerce. The Flubot malware is in active development and is\nlikely to continue to spread throughout the world as support for new regions and functionality\nis implemented in future versions.\n\nFlutbot can circumvent security controls by tricking the end-user into giving powerful\nsystem permissions. Better user awareness training is key to combatting this type of attack:\n\n\n-----\n\nOnly install applications from trusted sources like the Google Play store.\n\nOnly grant permissions to trusted applications and understand what capabilities that\npermission is granting before accepting them.\n\n## Indicators\n\nExample hashes of analyzed Flubot variants:\n\n74183f6454d2aaa44fcb363eb71beb33f04845c7fe4b402d06a87bab7b99e235\n\n5c3384bfeb479db3f1ed98578c80d1e3859640ea7cbfe62fbaa9634118cf4636\n\n5c9057d6d19f82fbba255d58e9b0da7102fed08ee25e548e08f0a5b22efc42a2\n\n## Active C2 domains:\n\niixoqoiphdhkdbq[.]ru\n\npvvbjvedsmjphil[.]ru\n\ntlfboldhmeehvwl[.]ru\n\nPackage names used in early Flubot versions:\n\ncom.iqiyi.i18n\n\ncom.eg.android.AlipayGphone\n\ncom.tencent.mm\n\ncom.tencent.mobileqq\n\ncom.taobao.taobao\n\nInnovations from Norton Labs are for research, evaluation, and consumer feedback purposes. NortonLifeLock does\nnot give any warranties as to the suitability or usability of these prototypes and recommends safeguarding data and\nreviewing all [terms and conditions before use.](https://www.nortonlifelock.com/content/dam/nortonlifelock/pdfs/eulas/licensing-agreement/xposure-test-agreement-v2-en.pdf)\n\nCopyright © 2021 NortonLifeLock Inc. All rights reserved. NortonLifeLock, the NortonLifeLock Logo, the Checkmark\nLogo, Norton, LifeLock, and the LockMan Logo are trademarks or registered trademarks of NortonLifeLock Inc. or its\naffiliates in the United States and other countries.\n\n\n-----\n\n## About the Author\n\n### Armin Buescher\n\n**Sr. Principal Security Researcher, Norton Protection Labs**\n\nArmin Buescher is a security researcher and software engineer for Norton Protection Labs\nand is focused on the analysis of attack trends and development of novel detection\ntechnologies. He has more than 10 years of experience working in the security industry.\n\n[linkedin](https://www.linkedin.com/in/arminbuescher/)\n\n## About the Author\n\n### Gokulakrishnan S\n\n**Sr. Threat Analysis Engineer**\n\nGokulakrishnan is Sr. Threat Analysis Engineer at Nortonlifelock with 11 years of experience\nin Malware Analysis, Incident Response & Digital Forensics. He is an expert in monitoring\nand researching emerging threats.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-14 - How Flubot targets Android phone users and their money.pdf"
    ],
    "report_names": [
        "2021-05-14 - How Flubot targets Android phone users and their money.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535547,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653688840,
    "ts_modification_date": 1653688840,
    "files": {
        "pdf": "https://archive.orkl.eu/12d090cf852cc07ea8ab679ab562979f87642f73.pdf",
        "text": "https://archive.orkl.eu/12d090cf852cc07ea8ab679ab562979f87642f73.txt",
        "img": "https://archive.orkl.eu/12d090cf852cc07ea8ab679ab562979f87642f73.jpg"
    }
}