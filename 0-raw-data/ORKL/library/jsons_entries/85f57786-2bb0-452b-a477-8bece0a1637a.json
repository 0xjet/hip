{
    "id": "85f57786-2bb0-452b-a477-8bece0a1637a",
    "created_at": "2023-01-12T15:05:08.043884Z",
    "updated_at": "2025-03-27T02:16:08.501174Z",
    "deleted_at": null,
    "sha1_hash": "289e568442271d4f15762ae04463872ce7e2dd15",
    "title": "2020-06-16 - Cobalt- tactics and tools update",
    "authors": "",
    "file_creation_date": "2022-05-28T03:15:49Z",
    "file_modification_date": "2022-05-28T03:15:49Z",
    "file_size": 2094377,
    "plain_text": "# Cobalt: tactics and tools update\n\n**ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/cobalt_upd_ttps/**\n\nPositive Technologies\n\nPublished on 16 June 2020\n\n[The PT Expert Security Center (PT ESC) has been monitoring the Cobalt group since 2016. Currently the group targets financial organizations](https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-Snatch-eng.pdf)\n[around the world. Two years ago, for example, their attacks caused over $14 million in damage. Over the last four years, we have released](https://www.ptsecurity.com/ww-en/analytics/cobalt-strikes-back-an-evolving-multinational-threat-to-finance/)\nseveral [reports on attacks linked to the group.](https://www.ptsecurity.com/ww-en/analytics/new-bank-attacks/)\n\nOver the last year, the group has not only modified its flagship tools CobInt and COM-DLL-Dropper in conjunction with the more_eggs\nJavaScript backdoor, but also started using new methods to deliver malware and bypass security in the initial stages of the kill chain. As a\ngroup whose activities have long been of interest to security researchers all over the world, the attackers are highly motivated to stay one step\nahead.\n\nFigure 1. Number of Cobalt attacks\n\ndetected by PT ESC\n\n\n-----\n\n0 9, t e g oup co ducted a a e age o t ee attac s pe o t t oug e do ot o et e t e attac s e e success u, suc\nfrequency may indicate that the criminals possess substantial financial resources allowing them to maintain their infrastructure, update\nmalware, and adopt new techniques.\n\nThe following histogram shows that in late 2019 the group started favoring CobInt over COM-DLL-Dropper.\n\nFigure 2. Number of attacks using COM\nDLL-Dropper and CobInt in 2019\nThe more_eggs JavaScript backdoor is detected by the ETPro ruleset, including in public sandboxes, whereas CobInt traffic does not trigger\nsecurity mechanisms. In addition, CobInt downloads the main library from the command and control (C2) server directly to memory, while\nCOM-DLL-Dropper saves to disk the obfuscated more_eggs, which is then executed in memory. Therefore, COM-DLL-Dropper leaves more\nartifacts on the infected machine.\n\n## 1. European Central Bank phishing website\n\nIn late August 2019, we detected a CobInt attack that presumably targeted European financial institutions. We do not know whether the attack\nwas successful. CobInt was dropped by a custom NSIS installer. We detected three versions of the dropper: for Chrome, Firefox, and Opera.\nEach dropper contained the same CobInt version and a browser-specific installer. Once launched, the dropper saved CobInt to the %TEMP%\nfolder and then ran CobInt and the installer. Malware analysis proved that the droppers were distributed from the phishing website ecbeuropean[.]eu.\n\n\n-----\n\nFigure 3. Phishing website main page\nThe site was a copy of the European Central Bank website, except for a pop-up window that asked visitors to update the browser.\n\nFigure 4. Pop-up window on the fake ECB website\nVisitors who fell for the ruse downloaded the dropper to their computer. The page source code contained a link to the script that displayed the\npop-up window.\n\nFigure 5. Link to malicious script\n\n\n-----\n\ne co gu at o st gs t e sc pt co ta s o ou d oppe s ( e cou d ot obta t e st o e) a d a o c eat g s o Sa a, dge,\nand Internet Explorer. The strings also show the window start time after loading the page, how many times the window will be shown to a user,\ntype of device on which the window will be displayed, and which banner will be shown to the user. In addition, the script detects bots, crawlers,\nand spiders.\n\nFigure 6. Malicious script parameters\n\nHere are alternative windows contained in the script:\n\nFigure 7. Alternative window specified in the script parameters\n\nFigure 8. Alternative window specified in the script\n\nparameters\nWe do not know how the user landed on this website. Most likely, the user would be a victim of a phishing attack like many of those performed\nby Cobalt.\n\n[The framework in question is not unique. We believe that Cobalt purchased it on a darkweb forum. In an article from November 2019, Zscaler](https://www.zscaler.com/blogs/research/netsupport-rat-installed-fake-update-notices)\ndescribed a similar scenario for spreading NetSupport RAT. The framework was placed on compromised sites, which showed visitors a\ncorresponding pop-up window.\n\n\n-----\n\nyet a ot e case, t e a c ous e og _ eta s g as a so d st buted o t e s te ecb eu opea [ ]eu Ou co eagues o G oup\n[have provided a detailed analysis of the malware.](https://www.group-ib.com/blog/cobaltphishing)\n\n## 2. Malicious VHD\n\nIn late December 2019, we detected another CobInt loader used by Cobalt. The loader container was unusual. It was a virtual hard disk (VHD),\npresumably distributed by email.\n\nThe VHD format was originally developed by Connectix for their Virtual PC product. Microsoft acquired the product in 2003 and renamed it\nMicrosoft Virtual PC. In 2005, the format became available to the public. Microsoft started using the VHD format in Hyper-V, the hypervisorbased virtualization technology. A VHD file may contain anything found on a physical hard drive, such as disk partitions and a file system with\nfolders and files.\n\nWindows 7 and newer systems include the ability to manually mount VHD files, such as via the MMC console. Starting with Windows 8, a user\ncan mount a VHD by simply double-clicking the file. A mounted VHD disk image appears to Windows just like a normal hard disk.\n\n[In September 2019, the CERT/CC Blog published an article about the danger of VHD files and their possible use as an attack vector. The](https://insights.sei.cmu.edu/cert/2019/09/the-dangers-of-vhd-and-vhdx-files.html)\nresearcher Will Dorman showed that neither antivirus software nor the Mark of the Web alerts users about the potential harm of the contents of\na VHD file downloaded from the Internet. Dorman created a malicious VHD container with EICAR inside and uploaded the result to VirusTotal.\nThe malware was not detected by any antivirus engines. A VHD file is critical for operation of Hyper-V virtual machines. If this file is damaged\nor blocked, the virtual machine will not run. This may explain the rarity, or even absence, of antivirus detection. In documentation, Microsoft\n[recommends excluding VHD files from antivirus scanning (as automatically is the case in Windows Defender). Otherwise, Hyper-V is](https://support.microsoft.com/en-gb/help/3105657/recommended-antivirus-exclusions-for-hyper-v-hosts)\nsusceptible to issues.\n\nIt is possible that Cobalt used the findings of this research for their own purposes. Their VHD file was also not detected by any antivirus\nsoftware when it first appeared on VirusTotal. Half a year later, the file was detected by just one antivirus engine, which is still very low.\n\nFigure 9. Cobalt VHD detection level at the moment of attack\nThe VHD contains two CobInt files. One file has two invalid Google certificates appended to it in order to reduce the odds of detection.\n\nFigure 10. Certificates appended to a CobInt file\n\nSince VHD is in essence a container with a file system, one can search for artifacts inside VHD files. For example, we found an image with text\nof a fake HSBC antifraud message in the unallocated space of a VHD file.\n\n\n-----\n\nFigure 11. Image in unallocated space of a VHD file\n\nThe attackers may have inadvertently left the artifact when reallocating space in the container: the same image was used as the CobInt icon\nand stored in the group's resources.\n\n### 2.1. CobInt analysis\n\nOnce the VHD is mounted, a user must manually run one of the files. The two files are identical in terms of functions. When run, either of the\nCobInt files downloads the main library from the C2 server as an HTML file.\n\n[There are a few changes in comparison to the algorithm described by ProofPoint in 2018:](https://www.proofpoint.com/us/threat-insight/post/new-modular-downloaders-fingerprint-systems-part-3-cobint)\n\nFigure 12. Example of obfuscation of the main library\n\nFirst, all tags are removed and their contents are ignored.\n\n\n-----\n\nFigure 13. Tag removal\n\nNext, periods, commas, and spaces are processed. All characters after these symbols are uppercased (the value 0x20 is subtracted).\n\nFigure 14. Removing unnecessary characters and switching letters to\n\nuppercase\nNext, data is decoded from Base64 and decrypted by XOR with a 4-byte key that is initialized with the preceding value of the decrypted data at\neach iteration. At each iteration, the current round's 4 bytes are subtracted from those of the previous round, after which the key is the 4-byte\nvalue of the input buffer of the previous round.\n\n\n-----\n\nFigure 15. First XOR level\n\nOnce decryption finishes, the second-stage decryptor takes over. In essence, it consists of an XOR decryption cycle using a 4-byte key that is\nthe same for the entire stage. The output of this stage will be a .dll library, which is the payload.\n\nData decoded from Base64 is shown in Figure 16. A 4-byte preset for the first decryptor is highlighted in red and will remain the same during\nthe second stage. The rest of the data is highlighted in yellow.\n\nFigure 16. Data decoded from Base64\n\nThe picture changes after decryption (Figure 17). The encryption key is clearly visible due to a long series of zeros in the executable file that,\nafter encryption, contain the keystream in pure form.\n\n\n-----\n\nFigure 17. Data after removal of the first XOR level\n\nThe second decryption gives us a valid PE file (Figure 18). We could not figure out the purpose of the first eight bytes: they are not used\nanywhere in the loader.\n\nFigure 18. Deobfuscated library\n\n### 2.2. Main library analysis\n\nOnce an event is created and the necessary parameters are initialized, the domain is decrypted. Then the function for generating the\nremaining part of the address is called.\n\n\n-----\n\nFigure 19.\n\nAlgorithm for generating remaining part of the address\nAfter the full C2 server address is generated, the library decrypts the necessary parameters to create HTTP fields, adds them to a request, and\nsends the request to the server. The server response contains plugins that the library loads into its address space using ReflectiveLoader.\n\n### 2.3. Decryption of plugins\n\nLike the main library, the plugins are sent by the server as HTML pages. The first stage of input transformation is similar to what happens\nduring the library download. The difference is that all periods, commas, and spaces are ignored, and all characters are lowercased.\n\nAfter the initial transformation, the obtained data is decoded from a–z to 0x00—0xff. For this, a previously unseen decoding procedure is used.\nIt is based on transforming input values depending on the current value, previous value (in some cases), and values of the global counter.\n\n\n-----\n\nalgorithm\nThe decoding is followed by two decryption cycles.\n\ndecryption cycle\nThe first decryption key is in the application code, hard-coded at an offset that takes only two values.\n\n\nFigure 20. Plugin decoding\n\nFigure 21. First\n\n\nTo carry out the second decryption cycle, the last byte of data is read. This byte is the length of the encryption key for the second cycle. The\nfile is read at this number of bytes (plus one) from the end. After the key is read, the data is decrypted, except for the key itself. In Figure 22,\nthe key length is highlighted in red and the key itself is highlighted in yellow.\n\n\n-----\n\nFigure 22. XOR key example\n\nThe last stage is decryption with a 4-byte key, which is also easily obtained by analyzing the series of zeros in the PE header.\n\nFigure 23. XOR key in encrypted data\n\nOur analysis detected two types of downloaded plugins: one that steals the names of running processes plus a screen capture module. Both\nplugins use standard WinAPIs to obtain data, as well as the same function as the main library in the export for reflective process loading.\n\n### 2.4. Traffic decryption\n\nThe library sends the data collected by the plugins to the server.\n\nHere is an example of traffic:\n\nFigure 24. Encoded data collected by plugin\n\nFirst, the traffic is encrypted by a randomly generated key of arbitrary length. The key is inserted into the packet with indication of its length.\n\nNext, the data is encrypted with a hard-coded 64-byte key, the same one that was used to decrypt the library. After that, the same encoding\nalgorithm is applied. An equals sign (=) and the generated sequence of 8 to 16 a–z characters are added to the beginning.\n\nExample of decoded and decrypted traffic from the previous packet:\n\nFigure 25. Decoded data\n\nPacket creation and transformation function:\n\n\n-----\n\nFigure 26. Algorithm for\n\ncreating packet with data\n\n## 3. BIFF macro\n\nIn March 2020, we detected an XLS document from Cobalt that downloaded and ran the COM-DLL-Dropper. The document contained the\nrather old Excel 4.0 macro format and was almost invisible to antivirus software (1 positive verdict out of 60 on VirusTotal).\n\nFigure 27. Number of antivirus verdicts on\n\nVirusTotal during first upload of the file with Excel 4.0 macro\nThis macro standard is 20 years old. The standard is peculiar in that the macro is stored in worksheet cells (not stored in a VBA project), and\nthe worksheet itself can be hidden in Excel. The macro therefore will not be in a VBA stream, but in a BIFF (Binary Interchange File Format)\nrecord.\n\nIf we open the document in Excel, we see one worksheet and no VBA project macros. However, Excel all the same detects the macro and\nblocks it from running.\n\nThe olevba3.py utility from oletools can be used to detect this macro.\n\nFigure 28. Result of olevba3.py execution By\n\nrunning the utility, we see that one of the document worksheets has the status \"very hidden\" and is of the Excel 4.0 macro type. Because of\n\n\n-----\n\nt s status, t e o s eet be s b e t e ce te ace a d, at s o e, t ca ot be ade s b e o t e te ace e t e t ca o y\nbe made visible by Visual Basic or by manually modifying the document's bytes.\n[The BiffView utility provides a more workable view of the BIFF structure. After parsing the initial document, we see that a page named](https://www.aldeid.com/wiki/BiffView)\nsygfdfdfdesie has the attribute \"very hidden.\" We change this parameter to 1 or 0 in a hex editor.\n\nFigure 29. Structure of malicious document worksheets\n\nWhen the initial document is opened in the Name Manager, one of the formulas runs automatically:\n\nFigure 30. Macro formula that runs when the document is\n\nopened\nThe initial formula launches a long chain of commands, such as CONCATENATE, RUN, CHAR, and CALL, which will lead to the loading and\nlaunch of COM-DLL-Dropper. The commands are scattered across the Excel cells, complicating analysis.\n\nFigure 31. Macro formulas\n\nleading to loading and launch of COM-DLL-Dropper\n\n## 4. COM-DLL-Dropper analysis\n\nIn early April 2020, we detected a new version of COM-DLL-Dropper. Its functions are different from everything we had seen before. However,\nthe more eggs JavaScript backdoor payload remained the same.\n\n\n-----\n\nCoba t st sta ted us g CO oppe t e su e o 0 a d s st us g t to de e o e_eggs, c s co ta ed t e d oppe\nin encrypted and archived form.\n\nA few facts about the dropper:\n\nIt is written completely in PureBasic.\nIt uses numerous anti-analysis techniques.\nIt contains an encrypted and archived JavaScript loader, JavaScript backdoor, and a legitimate utility for modifying the command line to\nlaunch more_eggs.\nIt has a built-in obfuscator for the hard-coded JavaScript backdoor and JavaScript loader\n\n### 4.1. PE file external structure\n\nAll the studied items are PE-DLL files to be registered by regsvr32. In addition to exports called by regsvr32, each sample has different sets of\nexports typical of legitimate DLL files. Cobalt attempted to mask COM-DLL-Dropper by using third-party exports. Figure 32 shows the most\npopular exports used in the malware files (total of 249 unique exports).\n\nFigure 32. Most popular COM\nDLL dropper exports\nThese exports contain stubs that generally do not actually do anything. Judging by the names of the exports, the droppers were masked to\nresemble media application libraries. In 2019, the malware was updated with the DllInstall export, which is also called by regsvr32, and the\nmain dropper code was moved to the export.\n\nBefore describing the malware code, we should touch on the PureBasic code. The information we provide here is the result of analyzing\nmalware samples. We did not study the compiler itself and therefore are forced to make certain assumptions. However, the described entities\nhelped us in our analysis, which is why we are sharing them here. All the names in screenshots were made up for the purposes of interpreting\nthe malware code.\n\nOur analysis requires two entities: strings and object arrays. PureBasic strings are stored in a special buffer. They are allocated and released\nwithout using a system API. Figure 33 shows the process of string allocation. During program initialization, a separate heap is created for\nstrings by calling HeapCreate().\n\n\n-----\n\nFigure 33. String workings\nA common pattern for working with this entity is as follows:\n\n1. Allocate a string to storage from a constant.\n2. Operate on the string.\n3. Update the global string which is usually allocated on the heap. After the update is completed, move back the node index. This operation\n\nis somewhat similar to pop().\n\nThe string storage structures do not allow storing the size of the added string. Instead, before starting any operation with the string, the\nprogram saves the previous index of the node and then passes it to the update operation. The difference between the indices is the string size.\n\nWe will not describe object arrays here in detail; suffice it to say that a special header before each array stores information about the size, type,\nand number of elements. The header occupies 18h bytes. Therefore, the space allocated for the array of objects can be calculated as size of\n_element × number of elements + 18h._\n\nTo get a clearer picture, refer to this description of functions that are presented in the screenshots a bit later.\n\n**Table 1 Function Description**\n\n**Function** **Description**\n\nObjectManager::AllocateObjectArray Object array is allocated\n\n\nObjectArray::ReleaseObjectArray\n\nObjectManager::FreeObject\n\nObjectManager::GetStringObject\n\nObjectManager::ConcatenationWithStringObject\n\n\nObject array is released\n\nCreate a string in storage\n\n\nObjectManager::PopStringObject Update global string\n\n### 4.2. Anti-analysis\n\nTo find the needed API functions, non-standard hash sums obtained from the functions' names are used. Each hash sum is obtained by taking\nthe CRC32 value and then performing XOR with a constant. The samples have different constants. This is why Table 3 also includes CRC32\nvalues without the constant-value XOR.\n\nThe new version of COM-DLL-Dropper has strings encrypted with the RC4 algorithm, whereas the older version used XOR.\n\n**Table 2. Techniques used by the malware to complicate analysis**\n\n\n-----\n\n**Technique** **Description**\n\nKey bruteforce to decrypt strings Starting in April 2020, RC4 has been used instead of XOR. This technique uses a non-standard\nimplementation of the Sleep function, which may postpone launch of the main malware functions in a\nsandbox.\n\n\nChecking for the /s /i string\nprocess in CommandLine\n\nVerifying the process name and\nthe .ocx extension\n\nVerifying the list of modules\nloaded into the process\n\nLoading of additional NTDLL\nimage into the process\n\nChecking the values of registers\nDr0–Dr3\n\n\nThe check verifies that the process was launched via regsvr32.\n\nThe extension and the process name are also checked with a non-standard hash function.\n\nThe check is performed using a custom hash function.\n\nThis likely creates a trusted NTDLL image without NT API interception.\n\nNon-zero values in these registers indicate hardware breakpoints, and therefore the debugger. The\nregister values are accessed via NtGetContext().\n\n\nProcessDebugPort check NtQueryInformationProcess with relevant value is called.\n\n\nProcessDebugObjectHandle\ncheck\n\n\nNtQueryInformationProcess with relevant value is called.\n\n\nProcessDebugFlags check NtQueryInformationProcess with relevant value is called.\n\n\nChecking the parent process\nname\n\nChecking the year set on the\nsystem\n\nChecking the value of the\nenvironment variable\nCOMPUTERNAME\n\n\nThe check is performed using a non-standard hash function.\n\nThe current date is obtained by calling NtQuerySystemTime and RtlTimeToTimeFields.\n\n[The computer name is checked for the hard-coded string \"FLAREVM\".](https://www.fireeye.com/blog/threat-research/2017/07/flare-vm-the-windows-malware.html)\n\n\n**Table 3. Strings and corresponding hash sums used in techniques**\n\n**Hash sum** **CRC32** **String**\n\n0x322CD34E 0x322C4A66 .ocx\n\n0xF43AEA50 0xF43A7378 regsvr32.exe\n\n0x6FECDEE9 0x6FEC47C1 sbiedll.dll\n\n0x16430EDF 0x164397F7 cmdvrt64.dll\n\n0x2B256AC8 0x2B25F3E0 cmd.exe\n\n0xA82757CC 0xA827CEE4 cmstp.exe\n\n0xB3C6B186 0xB3C628AE msxsl.exe\n\nKey bruteforcing for string decryption is not \"complete.\" In fact, most of the key consists of a hard-coded prefix found in the code. The end of\nthe key is a decimal number. Therefore, key = prefix + number.\n\n\n-----\n\nFigure 34. RC4 key bruteforce\n\n### 4.3. JavaScript generators\n\nThe dropper creates two files. The first is a JavaScript loader, and the second is a scriptlet containing the encrypted more_eggs backdoor.\nBoth scripts are generated.\n\nThe generation template is saved among malware samples. The inserted data varies. The template contains tokens and JavaScript parts that\nare concatenated in series. Figure 35 shows part of generation of the JavaScript loader and examples of the used JavaScript parts.\n\nFigure 35. Generation of a part of the loader\n\nSeveral obfuscation templates are built into the generator:\n\nCompensatory disguising of constants\nGeneration of random variable names\nInsertion of encrypted strings\n\nEach generator contains a pool of names that are generated prior to starting creation of the script. These names are then used in JavaScript.\nFigure 35 shows a local variable named lpbobj_arraywcs__JSObjectPool. Figure 36 shows the pool initialization cycle.\n\n\n-----\n\nFigure 36. Example of filling the\n\npool of names used in the script>\nEach name available to be used in the script contains two parts: a random prefix (which is created once for the entire script) and a random\ndecimal number (limited to a set number of characters). Figure 37 shows the name generation scheme and the result obtained in the script.\n\nFigure 37.\n\nGeneration of names available to be used in the script\nNumeric constants are obfuscated with a function that applies a random arithmetic operation from a set hard-coded in the program and then\ninserts the opposite operation in the script. Thus, the inserted expression balances out the obfuscated constant. The second arithmetic\noperation argument is also generated randomly from a hard-coded range of values.\n\nFigure 38. Generation of obfuscated constants\nThe payload is encoded using RC4 and Base91 and inserted in the script. The implementations of RC4 and the Base91 decoder are also\ninserted in the scripts\n\n\n-----\n\n### e s ste ce\n\nDepending on its rights in the system, the dropper entrenches itself on the infected machine using the following methods:\n\nBy using Task Scheduler\nBy using the registry key Environment\\UserInitMprLogonScript\nBy using the registry key Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nFor all three methods, the value written by the dropper is the same, containing the command for launching the JavaScript loader.\n\nFigure 39. Example\n\nof persistence via UserInitMprLogonScript\nTo configure a task created by the dropper, a special XML file is generated. Part of it is stored in the dropper in encrypted form, and another\npart is generated while running.\n\nFigure 40. Decrypted part of XML\n\nFigure 41. Creating end for the\n\nXML file\nThe resulting XML file is saved with a random name consisting of hexadecimal characters. Subsequently, this XML file is passed to\nschtasks.exe as the /XML parameter value.\n\n### 4.5. Running the payload\n\nCOM-DLL-Dropper saves three files to disk:\n\nObfuscated JavaScript loader\nObfuscated JavaScript backdoor\nLegitimate utility for modifying the command line in order to launch the more_eggs JavaScript backdoor\n\n[The main backdoor is launched with the help of a known AppLocker bypass technique using the msxsl utility. The commands look as follows:](https://pentestlab.blog/2017/07/06/applocker-bypass-msxsl/)\n\n“C:\\Users\\\\AppData\\Roaming\\Microsoft\\msxsl.exe”\n“C \\U \\\\A D t \\R i \\Mi ft\\[j i t d l d ] t t”\n\n\n-----\n\nC \\Use s\\\\ pp ata\\ oa g\\ c oso t\\[ja asc pt_bac doo _ a e] t t\n\n### 4.6. JavaScript backdoor functionality\n\nThe JavaScript backdoor saved to disk by the new COM-DLL-Dropper has version 6.6.\n\nFigure 42. Backdoor header\n\nThis backdoor has been used by Cobalt since 2017. It is executed in memory and always has a low number of antivirus verdicts.\n\nThe main capabilities of the backdoor are as follows:\n\n1. Traffic encryption with RC4 and Base91\n2. Execution of operator commands (in this version, the more_eggs command that gave the backdoor its name was absent):\n\nexec: download and run file (.exe or .dll)\ngtfo: uninstall\nmore_onion: run script\nvia_c: execute command using \"cmd.exe /C\"\nmore_time: execute command using \"cmd.exe /C\", with the result being saved to a temporary file. After that, the file is read and deleted,\nand its contents are encoded with Base64 and sent to the server.\n\nCheck of the process list for antivirus protection and researcher software by comparing CRC32 values (derived from the name of each\nprocess, without extension and in lower case) against hard-coded values.\n\nReconnaissance:\n\nDate of system installation\nInfected machine's IP address\nSystem type (server or desktop)\nWindows version (from XP to 10)\n\n## Conclusion\n\nCobalt keeps attacking financial organizations around the world, refining its TTPs, and inventing ever-more sophisticated ways to bypass\ndefenses. Due to quarantine-related measures, many employees of financial companies are now working remotely, outside the protection\n[offered by corporate security solutions. Moreover, many threat actors are using COVID-19 as a lure in their attacks, as the Higaisa group has](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/covid-19-and-new-year-greetings-the-higaisa-group/)\ndone. It is possible that Cobalt, too, will try to weaponize such concern.\n\n**Authors: Denis Kuvshinov, Sergey Tarasov, Daniil Koloskov, PT ESC**\n\n## Indicators of compromise\n\n### ECB phishing\n\n**Type** **MD5** **SHA1** **SHA256**\n\n\nBrowser\ndroppers\n\n\n152cd7014811ae8980981a825e5843b0 90f7d0b0f90aeadaeff1adf45db5dcc598dec8c4 2d02bbae38f4dba5485fbc2e386408989\n\nf2712de0c8575ff32828c83cfbf75d4b e80ef396462fe651c3cdeb91651ac27799d2dab5 33ba8cd251512f90b7249930aee22d3f4\n\na3391d1d3482553545d7c0111984abb6 1a371353c6a46ddea19d520d8ce3b5599a8ee9f1 9e8a99ad401ef5d2bb3aea3a463d8522\n\n\n-----\n\n**Type** **MD5** **SHA1** **SHA256**\n\nCobInt f924c690f7bbaf60d56a446b7a66a43b 8ada87f00ed3afdd4dbdb07879ba6ebe4a2a9ffa b83d2c4f5c2bb562981a104d4e49cf252\n\n_C&C_\n\necb-european[.]eu\n\ntimeswindows[.]com\n\n### VHD\n\n**Type** **MD5** **SHA1** **SHA256**\n\n\nVHDfile\n\n\nfce9fcd5fa337d020bd6758008221b81 e288b0410fb95060ce8c5527673978cb2ceffe05 3382a75bd959d2194c4b1a8885df93e8770f4\n\n\nCobInt 600154fcb03e775f007ef7b1547b169c 384a13abe42d249e354cd415c4bcbf01086deafb 0c85c1045899291cba47c7171599446642b8\n\n6ec0edd1889897ff9b4673600f40f92f 4d50f1cae2acc8c92ff1f678fc1fdfdd1e770f24 64d16900fce924da101744edce28b9ee6481\n\n_C&C_\n\ntelekom-support[.]info\n\n45.80.69[.]34\n\n### BIFF\n\n**Type** **MD5** **SHA1** **SHA256**\n\n\nXLSFile\n\nCOMDLL\n\n_C&C_\n\n\n36399ebf94f66529dc72d8b2844f43dd b912f222e79feadbcefe2d6ead5fab74b15b1f40 0aee265a022ee84e9c8b653e960559c9761a7\n\n862c19b2b4b6a7c97fb8627303b8f5d7 d3fc5f848d630ca2dc8e99b0d4dfe704b8ec1832 7122cf59f8a59f9a44f20fd4c83451c5c4313e0\n\n\ndownload.sabaloo[.]com\n\norigin.cdn77[.]kz\n\n### New COM-DLL dropper\n\n**Type** **MD5** **SHA1** **SHA256**\n\n\nCOMDLL\n\n_С&C_\n\n\n47e7212b097b5cffa60903055e3c4d5a dfcd5692729e859f074b95720505f711ba7d14ac c1a633a940fc4c595ebbe36823fee1b02bfd75\n\n\nmaps.doaglas[.]com\n\n## MITRE TTPs\n\n**Tactic** **ID** **Name**\n\nInitial Access T1193 Spearphishing Attachment\n\nT1192 Spearphishing Link\n\n\n-----\n\n**Tactic** **ID** **Name**\n\nExecution T1059 Command-Line Interface\n\nT1117 Regsvr32\n\nT1204 User Execution\n\nT1064 Scripting\n\nPersistence T1037 Logon Scripts\n\nT1050 New Service\n\nT1053 Scheduled Task\n\nT1060 Registry Run Keys / Startup Folder\n\nDefense Evasion T1027 Obfuscated Files or Information\n\nT1220 XSL Script Processing\n\nDiscovery T1063 Security Software Discovery\n\nCommand And Control T1105 Remote File Copy\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-16 - Cobalt- tactics and tools update.pdf"
    ],
    "report_names": [
        "2020-06-16 - Cobalt- tactics and tools update.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "873919c0-bc6a-4c19-b18d-c107e4aa3d20",
            "created_at": "2023-01-06T13:46:39.138138Z",
            "updated_at": "2025-03-27T02:00:03.005534Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [],
            "source_name": "MISPGALAXY:Higaisa",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "30c9c492-afc6-4aa1-8fe6-cecffed946e0",
            "created_at": "2022-10-25T15:50:23.400822Z",
            "updated_at": "2025-03-27T02:00:55.461334Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [
                "Higaisa"
            ],
            "source_name": "MITRE:Higaisa",
            "tools": [
                "PlugX",
                "certutil",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535908,
    "ts_updated_at": 1743041768,
    "ts_creation_date": 1653707749,
    "ts_modification_date": 1653707749,
    "files": {
        "pdf": "https://archive.orkl.eu/289e568442271d4f15762ae04463872ce7e2dd15.pdf",
        "text": "https://archive.orkl.eu/289e568442271d4f15762ae04463872ce7e2dd15.txt",
        "img": "https://archive.orkl.eu/289e568442271d4f15762ae04463872ce7e2dd15.jpg"
    }
}