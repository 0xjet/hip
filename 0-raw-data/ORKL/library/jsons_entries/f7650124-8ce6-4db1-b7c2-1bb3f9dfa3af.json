{
    "id": "f7650124-8ce6-4db1-b7c2-1bb3f9dfa3af",
    "created_at": "2023-01-12T15:02:01.197405Z",
    "updated_at": "2025-03-27T02:14:11.942046Z",
    "deleted_at": null,
    "sha1_hash": "4da3b2a0e0c2f46c5c233b22058a517d860cf179",
    "title": "2022-03-22 - DEV-0537 (UNC3661) criminal actor targeting organizations for data exfiltration and destruction",
    "authors": "",
    "file_creation_date": "2022-08-18T03:53:05Z",
    "file_modification_date": "2022-08-18T03:53:05Z",
    "file_size": 744187,
    "plain_text": "# DEV-0537 criminal actor targeting organizations for data exfiltration and destruction\n\n**microsoft.com/security/blog/2022/03/22/dev-0537-criminal-actor-targeting-organizations-for-data-exfiltration-and-**\ndestruction/\n\nMarch 22, 2022\n\n**_March 24, 2022 update – As Microsoft continues to track DEV-0537’s activities, tactics, and_**\n_tools, we’re sharing new detection, hunting, and mitigation information to give you additional_\n_insights on remaining vigilant against these attacks._\n\nIn recent weeks, Microsoft Security teams have been actively tracking a large-scale social\nengineering and extortion campaign against multiple organizations with some seeing\nevidence of destructive elements. As this campaign has accelerated, our teams have been\nfocused on detection, customer notifications, threat intelligence briefings, and sharing with\nour industry collaboration partners to understand the actor’s tactics and targets. Over time,\nwe have improved our ability to track this actor and helped customers minimize the impact of\nactive intrusions and in some cases worked with impacted organizations to stop attacks prior\nto data theft or destructive actions. Microsoft is committed to providing visibility into the\nmalicious activity we’ve observed and sharing insights and knowledge of actor tactics that\n\n\n-----\n\nmight be useful for other organizations to protect themselves. While our investigation into the\nmost recent attacks is still in progress, we will continue to update this blog when we have\nmore to share.\n\nThe activity we have observed has been attributed to a threat group that Microsoft tracks as\nDEV-0537, also known as LAPSUS$. DEV-0537 is known for using a pure extortion and\ndestruction model without deploying ransomware payloads. DEV-0537 started targeting\norganizations in the United Kingdom and South America but expanded to global targets,\nincluding organizations in government, technology, telecom, media, retail, and healthcare\nsectors. DEV-0537 is also known to take over individual user accounts at cryptocurrency\nexchanges to drain cryptocurrency holdings.\n\nUnlike most activity groups that stay under the radar, DEV-0537 doesn’t seem to cover its\ntracks. They go as far as announcing their attacks on social media or advertising their intent\nto buy credentials from employees of target organizations. DEV-0537 also uses several\ntactics that are less frequently used by other threat actors tracked by Microsoft. Their tactics\ninclude phone-based social engineering; SIM-swapping to facilitate account takeover;\naccessing personal email accounts of employees at target organizations; paying employees,\nsuppliers, or business partners of target organizations for access to credentials and\nmultifactor authentication (MFA) approval; and intruding in the ongoing crisis-communication\ncalls of their targets.\n\nThe social engineering and identity-centric tactics leveraged by DEV-0537 require detection\nand response processes that are similar to insider risk programs–but also involve short\nresponse timeframes needed to deal with malicious external threats. In this blog, we compile\nthe tactics, techniques, and procedures (TTPs) we’ve observed across multiple attacks and\ncompromises. We also provide baseline risk mitigation strategies and recommendations to\nhelp organizations harden their organization’s security against this unique blend of tradecraft.\n\n## Analysis\n\nThe actors behind DEV-0537 focused their social engineering efforts to gather knowledge\nabout their target’s business operations. Such information includes intimate knowledge about\nemployees, team structures, help desks, crisis response workflows, and supply chain\nrelationships. Examples of these social engineering tactics include spamming a target user\nwith multifactor authentication (MFA) prompts and calling the organization’s help desk to\nreset a target’s credentials.\n\nMicrosoft Threat Intelligence Center (MSTIC) assesses that the objective of DEV-0537 is to\ngain elevated access through stolen credentials that enable data theft and destructive\nattacks against a targeted organization, often resulting in extortion. Tactics and objectives\nindicate this is a cybercriminal actor motivated by theft and destruction.\n\n\n-----\n\nWhile this actor s TTPs and infrastructure are constantly changing and evolving, the following\nsections provide additional details on the very diverse set of TTPs we have observed that\nDEV-0537 is using.\n\n### Initial access\n\nDEV-0537 uses a variety of methods that are typically focused on compromising user\nidentities to gain initial access to an organization including:\n\nDeploying the malicious Redline password stealer to obtain passwords and session\ntokens\nPurchasing credentials and session tokens from criminal underground forums\nPaying employees at targeted organizations (or suppliers/business partners) for access\nto credentials and MFA approval\nSearching public code repositories for exposed credentials\n\nUsing the compromised credentials and/or session tokens, DEV-0537 accesses internetfacing systems and applications. These systems most commonly include virtual private\nnetwork (VPN), remote desktop protocol (RDP), virtual desktop infrastructure (VDI) including\nCitrix, or identity providers (including Azure Active Directory, Okta). For organizations using\nMFA security, DEV-0537 used two main techniques to satisfy MFA requirements–session\ntoken replay and using stolen passwords to trigger simple-approval MFA prompts hoping that\nthe legitimate user of the compromised account eventually consents to the prompts and\ngrants the necessary approval.\n\nIn some cases, DEV-0537 first targeted and compromised an individual’s personal or private\n(non-work-related) accounts giving them access to then look for additional credentials that\ncould be used to gain access to corporate systems. Given that employees typically use these\npersonal accounts or mobile phone numbers as their second-factor authentication or\npassword recovery, the group would often use this access to reset passwords and complete\naccount recovery actions.\n\nMicrosoft also found instances where the group successfully gained access to target\norganizations through recruited employees (or employees of their suppliers or business\npartners). DEV-0537 advertised that they wanted to buy credentials for their targets to entice\nemployees or contractors to take part in its operation. For a fee, the willing accomplice must\nprovide their credentials and approve the MFA prompt or have the user install AnyDesk or\nother remote management software on a corporate workstation allowing the actor to take\ncontrol of an authenticated system. Such a tactic was just one of the ways DEV-0537 took\nadvantage of the security access and business relationships their target organizations have\nwith their service providers and supply chains.\n\n\n-----\n\nFigure 1. Screenshot of an ad recruiting employees to give out access to their employer’s\nnetwork\n[In other observed activity, DEV-0537 actors performed a SIM-swapping attack to access a](https://www.ic3.gov/Media/Y2022/PSA220208)\nuser’s phone number before signing into the corporate network. This method allows the\nactors to handle phone-based authentication prompts they need to gain access to a target.\n\nOnce standard user credentials or access was obtained, DEV-0537 typically connected a\nsystem to an organization’s VPN. In some cases, to meet conditional access requirements,\nDEV-0537 registered or joined the system to the organization’s Azure Active Directory (Azure\nAD).\n\n### Reconnaissance and privilege escalation\n\nOnce DEV-0537 obtained access to the target network using the compromised account, they\nused multiple tactics to discover additional credentials or intrusion points to extend their\naccess including:\n\n\n-----\n\nExploiting unpatched vulnerabilities on internally accessible servers including JIRA,\nGitlab, and Confluence\nSearching code repositories and collaboration platforms for exposed credentials and\nsecrets\n\nThey have been consistently observed to use AD Explorer, a publicly available tool, to\nenumerate all users and groups in the said network. This allows them to understand which\naccounts might have higher privileges. They then proceeded to search collaboration\nplatforms like SharePoint or Confluence, issue-tracking solutions like JIRA, code repositories\nlike GitLab and GitHub, and organization collaboration channels like Teams or Slack to\ndiscover further high-privilege account credentials to access other sensitive information.\n\nDEV-0537 is also known to exploit vulnerabilities in Confluence, JIRA, and GitLab for\nprivilege escalation. The group compromised the servers running these applications to get\nthe credentials of a privileged account or run in the context of the said account and dump\ncredentials from there. The group used DCSync attacks and Mimikatz to perform privilege\nescalation routines. Once domain administrator access or its equivalent has been obtained,\nthe group used the built-in ntdsutil utility to extract the AD database.\n\nIn some cases, DEV-0537 even called the organization’s help desk and attempted to\nconvince the support personnel to reset a privileged account’s credentials. The group used\nthe previously gathered information (for example, profile pictures) and had a native-Englishsounding caller speak with the help desk personnel to enhance their social engineering lure.\nObserved actions have included DEV-0537 answering common recovery prompts such as\n“first street you lived on” or “mother’s maiden name” to convince help desk personnel of\nauthenticity. Since many organizations outsource their help desk support, this tactic attempts\nto exploit those supply chain relationships, especially where organizations give their help\ndesk personnel the ability to elevate privileges.\n\n### Exfiltration, destruction, and extortion\n\nBased on our observation, DEV-0537 has dedicated infrastructure they operate in known\nvirtual private server (VPS) providers and leverage NordVPN for its egress points. DEV-0537\nis aware of detections such as impossible travel and thus picked VPN egress points that\nwere geographically like their targets. DEV-0537 then downloaded sensitive data from the\ntargeted organization for future extortion or public release to the system joined to the\norganization’s VPN and/or Azure AD-joined system.\n\nDEV-0537 has been observed leveraging access to cloud assets to create new virtual\nmachines within the target’s cloud environment, which they use as actor-controlled\ninfrastructure to perform further attacks across the target organization.\n\n\n-----\n\nIf they successfully gain privileged access to an organization s cloud tenant (either AWS or\nAzure), DEV-0537 creates global admin accounts in the organization’s cloud instances, sets\nan Office 365 tenant level mail transport rule to send all mail in and out of the organization to\nthe newly created account, and then removes all other global admin accounts, so only the\nactor has sole control of the cloud resources, effectively locking the organization out of all\naccess. After exfiltration, DEV-0537 often deletes the target’s systems and resources. We’ve\nobserved deletion of resources both on-premises (for example, VMware vSphere/ESXi) and\nin the cloud to trigger the organization’s incident and crisis response process.\n\nThe actor has been observed then joining the organization’s crisis communication calls and\ninternal discussion boards (Slack, Teams, conference calls, and others) to understand the\nincident response workflow and their corresponding response. It is assessed this provides\nDEV-0537 insight into the victim’s state of mind, their knowledge of the intrusion, and a\nvenue to initiate extortion demands. Notably, DEV-0537 has been observed joining incident\nresponse bridges within targeted organizations responding to destructive actions. In some\ncases, DEV-0537 has extorted victims to prevent the release of stolen data, and in others, no\nextortion attempt was made and DEV-0537 publicly leaked the data they stole.\n\n### Impact\n\nEarly observed attacks by DEV-0537 targeted cryptocurrency accounts resulting in\ncompromise and theft of wallets and funds. As they expanded their attacks, the actors began\ntargeting telecommunication, higher education, and government organizations in South\nAmerica. More recent campaigns have expanded to include organizations globally spanning\na variety of sectors. Based on observed activity, this group understands the interconnected\nnature of identities and trust relationships in modern technology ecosystems and targets\ntelecommunications, technology, IT services and support companies–to leverage their\naccess from one organization to access the partner or supplier organizations. They have\nalso been observed targeting government entities, manufacturing, higher education, energy,\nretailers, and healthcare.\n\nMicrosoft will continue to monitor DEV-0537 activity and implement protections for our\ncustomers. The current detections and advanced detections in place across our security\nproducts are detailed in the following sections.\n\n### Actor actions targeting Microsoft\n\nThis week, the actor made public claims that they had gained access to Microsoft and\nexfiltrated portions of source code. No customer code or data was involved in the observed\nactivities. Our investigation has found a single account had been compromised, granting\nlimited access. Our cybersecurity response teams quickly engaged to remediate the\ncompromised account and prevent further activity. Microsoft does not rely on the secrecy of\ncode as a security measure and viewing source code does not lead to elevation of risk. The\n\n\n-----\n\ntactics DEV-0537 used in this intrusion reflect the tactics and techniques discussed in this\nblog. Our team was already investigating the compromised account based on threat\nintelligence when the actor publicly disclosed their intrusion. This public disclosure escalated\nour action allowing our team to intervene and interrupt the actor mid-operation, limiting\nbroader impact.\n\n## Recommendations\n\n### Strengthen MFA implementation\n\nMultifactor authentication (MFA) is one of the primary lines of defense against DEV-0537.\nWhile this group attempts to identify gaps in MFA, it remains a critical pillar in identity security\nfor employees, vendors, and other personnel alike. See the following recommendations to\nimplement MFA more securely:\n\n**Do:**\n\nRequire MFA for all users coming from all locations including perceived trusted\nenvironments, and all internet-facing infrastructure–even those coming from onpremises systems.\nLeverage more secure implementations such as FIDO Tokens, or Microsoft\n[Authenticator with number matching.](https://docs.microsoft.com/azure/active-directory/authentication/how-to-mfa-number-match) [Avoid telephony-based MFA methods to avoid](https://techcommunity.microsoft.com/t5/azure-active-directory-identity/it-s-time-to-hang-up-on-phone-transports-for-authentication/ba-p/1751752)\nrisks associated with SIM-jacking.\nUse [Azure AD Password Protection to ensure that users aren’t using easily guessed](https://docs.microsoft.com/azure/active-directory/authentication/concept-password-ban-bad-combined-policy)\n[passwords. Our blog about password spray attacks outlines additional](https://www.microsoft.com/security/blog/2021/10/26/protect-your-business-from-password-sprays-with-microsoft-dart-recommendations/)\nrecommendations.\n[Leverage passwordless authentication methods such as Windows Hello for Business,](https://docs.microsoft.com/azure/active-directory/authentication/concept-authentication-passwordless)\nMicrosoft Authenticator, or FIDO tokens to reduce risks and user experience issues\nassociated with passwords.\nImplement user and sign-in risk-based policies that block high impact user actions like\ndevice enrollment and MFA registration.\nBreak glass accounts should be stored offline and not be present in any sort of online\npassword vaulting solution.\n[Use automated reports and workbooks such as Azure Monitor workbooks for reports](https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/howto-use-azure-monitor-workbooks#identity-protection-risk-analysis)\nfor detailed analysis on risk distribution, risk detection trends, and opportunities for risk\nremediation.\nRemind employees that enterprise or workplace credentials should not be stored in\nbrowsers or password vaults secured with personal credentials\n\n**Do NOT:**\n\n\n-----\n\nUse weak MFA factors such as text messages (susceptible to SIM swapping), simple\n[voice approvals, simple push (instead, use number matching), or secondary email](https://docs.microsoft.com/azure/active-directory/authentication/how-to-mfa-number-match)\naddresses.\nInclude location-based exclusions. MFA exclusions allow an actor with only one factor\nfor a set of identities to bypass the MFA requirements if they can fully compromise a\nsingle identity.\nAllow credential or MFA factor sharing between users.\n\n### Require healthy and trusted endpoints\n\n[Require trusted, compliant, and healthy devices for access to resources to prevent data](https://docs.microsoft.com/mem/intune/protect/create-conditional-access-intune)\ntheft.\nTurn on [cloud-delivered protection in Microsoft Defender Antivirus to cover rapidly](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/configure-block-at-first-sight-microsoft-defender-antivirus?view=o365-worldwide)\nevolving attacker tools and techniques, block new and unknown malware variants, and\nenhance attack surface reduction rules and tamper protection.\n\n### Leverage modern authentication options for VPNs\n\nVPN authentication should leverage modern authentication options such as OAuth or SAML\nconnected to Azure AD to enable risk-based sign-in detection. Modern authentication\nenables blocking authentication attempts based on sign-in risk, requiring compliant devices\nfor sign in, and tighter integration with your authentication stack to provide more accurate risk\ndetections. Implementation of modern authentication and tight conditional access policies on\nVPN has been shown to be effective against DEV-0537’s access tactics.\n\n### Strengthen and monitor your cloud security posture\n\nDEV-0537 leverages legitimate credentials to perform malicious actions against customers.\nSince these credentials are legitimate, some activity performed might seem consistent with\nstandard user behavior. Use the following recommendations to improve your cloud security\nposture:\n\n[Review your Conditional Access user and session risk configurations:](https://docs.microsoft.com/azure/active-directory/authentication/tutorial-risk-based-sspr-mfa)\n\nBlock or [force password reset for high/medium user risk for all users](https://docs.microsoft.com/azure/active-directory/conditional-access/howto-conditional-access-policy-risk-user)\nBlock high sign-in risk logins for all users\nBlock medium sign-in risk logins for privileged users\nRequire MFA for medium sign-in risk logins for all other users\n[Alerts should be configured to prompt a review on high-risk modification of tenant](https://docs.microsoft.com/azure/active-directory/reports-monitoring/concept-audit-logs)\nconfiguration, including but not limited to:\n\nModification of Azure AD roles and privileged users associated with those roles\nCreation or modification of Exchange Online transport rules\nModification of tenant-wide security configurations\n\n\n-----\n\n[Review risk detections in Azure AD Identity Protection](https://docs.microsoft.com/azure/active-directory/identity-protection/concept-identity-protection-risks)\n\nRisk detections highlight risky users and risky sign-ins\nAdministrators can review and confirm individual sign-ins listed here as\ncompromised or safe\n[Read this article on how to investigate risk using Azure AD Identity Protection](https://docs.microsoft.com/azure/active-directory/identity-protection/howto-identity-protection-investigate-risk)\n\nFigure 2. Using Azure AD Identity Protection to review risk detections\n\n### Improve awareness of social engineering attacks\n\nMicrosoft recommends raising and improving awareness of social engineering tactics to\nprotect your organization. Educate members of your technical team to watch out for and\nreport any unusual contacts with colleagues. IT help desks should be hypervigilant about\nsuspicious users and ensure that they are tracked and reported immediately. We recommend\nreviewing help desk policies for password resets for highly privileged users and executives to\ntake social engineering into consideration.\n\nEmbed a culture of security awareness in your organization by educating employees about\nhelp desk verification practices. Encourage them to report suspicious or unusual contacts\nfrom the help desk. Education is the number one defense against social engineering attacks\nsuch as this one and it is important to make sure that all employees are aware of the risks\nand known tactics.\n\n### Establish operational security processes in response to DEV-0537 intrusions\n\nDEV-0537 is known to monitor and intrude in incident response communications. As such,\nthese communication channels should be closely monitored for unauthorized attendees and\nverification of attendees should be performed visually or audibly.\n\nWe advise organizations to follow very tight operational security practices when responding\nto an intrusion believed to be DEV-0537. Organizations should develop an out-of-band\ncommunication plan for incident responders that is usable for multiple days while an\ninvestigation occurs. Documentation of this response plan should be closely held and not\neasily accessible.\n\nMicrosoft continues to track DEV-0537’s activities, tactics, malware, and tools. We will\ncommunicate any additional insights and recommendations as we investigate their actions\nagainst our customers.\n\n\n-----\n\n## Detecting, hunting, and responding to DEV-0537 activities\n\nMicrosoft security products provide several detections that can help identify activities\nresembling DEV-0537 tactics. We’re also sharing several Microsoft 365 Defender, Microsoft\nDefender for Cloud Apps, and Microsoft Sentinel hunting and detection queries that are\nlinked in the following sections. We suggest reviewing the following detections and using the\nhighlighted queries to enhance the investigation of potential activity in your environment.\n\n### Initial access\n\n**Microsoft Sentinel hunting queries**\n\n[Sign-in from VPS providers – This query looks for successful sign-ins from known VPS](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/SigninLogs/Signins-From-VPS-Providers.yaml)\nprovider network ranges with suspicious token-based sign-in patterns. This is not an\nexhaustive list of VPS provider ranges but covers some of the most prevalent providers\nobserved.\n\nInvestigate unknown sign-in attempts from uncommon or unusual VPS providers.\n\n[Sign-in activity from NordVPN providers – This query looks for sign-in activity from NordVPN](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/SigninLogs/Signins-from-NordVPN-Providers.yaml)\nproviders using the feed leveraging NordVPN API and is updated daily.\n\nInvestigate unknown sign-in attempts from VPN providers such as NordVPN unless it is\ncommonly seen in your organization.\n\n[User sign-in IP address teleportation – This query looks at sign-in logs to identify user](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/SigninLogs/UserLoginIPAddressTeleportation.yaml)\naccounts that have signed in from two different countries or regions within a specified time\nwindow. By default, this is a 10-minute window either side of the previous sign-in.\n\nInvestigate the users signing in from multiple locations within a short span of time. It might\ndetect users roaming onto VPNs. You can also exclude known VPN IP address ranges in the\nquery.\n\n### Reconnaissance\n\n**Microsoft 365 Defender built-in detection: Multiple searches for sensitive data in**\nSharePoint sites\n\nThis detection looks for instances where a user searched for sensitive data on SharePoint\nsites that an attacker can use as internal information to leverage in later attacks if the user’s\naccount is compromised.\n\nInvestigate the user account performing the queries to determine if it was compromised.\nDetermine what, if any, sensitive information was accessed to assess the impact.\n\n\n-----\n\n**Note: Data used in this detection requires advanced audit to be enabled in Microsoft**\nDefender 365 that includes the SearchQueryInitiatedSharePoint event type.\n\n### Privilege escalation\n\n**Microsoft 365 Defender built-in detection: Risky user created global admin**\n\nThis detection will alert users based on the risk score proved by Azure AD Identity Protection\nwhen a new global admin was created by a user that had a risky sign-in. An attacker might\nhave compromised the user account to perform lateral movement.\n\nInvestigate the new global admin account to determine if it was created legitimately and if the\nuser account that performed the action was compromised.\n\n**Microsoft 365 Defender hunting queries**\n\n[Multiple admin role removal operations done by a single user – This query looks for multiple](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Persistence/multipleAADAdminsRemovals.yaml)\nusers that had their administrator role removed by a single user within a certain period.\n\nInvestigate if the user account that removed the admin roles was compromised or if the\nactions were legitimate. If determined to be compromised, disable the account and reset the\npassword. Restore access to affected accounts as needed.\n\n[‘ElevateAccess’ operation followed risky sign-in – This query looks for users who had a risky](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Privilege%20escalation/riskySignInToElevateAccess.yaml)\nsign-in (based on Azure AD Identity Protection risk score) and then performed an\n[‘ElevateAccess’ action. ‘ElevateAccess’ operations can be used by global admins to obtain](https://docs.microsoft.com/azure/role-based-access-control/elevate-access-global-admin)\npermissions over Azure resources.\n\nInvestigate the risky sign-ins and the following ‘ElevateAccess’ operation and disable the\naccount if it was determined to be compromised.\n\n**Microsoft Sentinel hunting queries**\n\n[User-assigned privileged role – This query identifies when a new privileged role is assigned](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/AuditLogs/UserAssignedPrivilegedRole.yaml)\nto a user or when any account eligible for a role is given privileged access.\n\nInvestigate if the assignment of privileged access is unexpected or does not align to the role\nof the account holder. See Things to monitor in your security operations for privileged\naccounts for details.\n\n[User added to Azure AD privileged groups (near real-time (NRT) rule) – This query looks for](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/AuditLogs/NRT_UseraddedtoPrivilgedGroups.yaml)\ninstances when a user is added to any privileged groups.\n\nInvestigate any unusual additions to privileged groups, particularly administrator roles. For\ndetails, see [Azure AD audit activity reference and](https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-audit-activities) administrator role permissions in Azure\nAD\n\n\n-----\n\n[Multiple admin membership removals from newly created admin – This query detects when](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/AuditLogs/MultipleAdmin_membership_removals_from_NewAdmin.yaml)\nnewly created global admin removes multiple existing global admins which can be an\nattempt by adversaries to lock down the organization and retain sole access.\n\nInvestigate reasoning and intention of multiple membership removal by new global admins\nand take necessary actions accordingly.\n\nFor Microsoft Sentinel customers who have onboarded Okta logs, the following queries can\nassist in investigating DEV-0537 activity across those logs:\n\n**Microsoft Sentinel + Okta logs hunting queries**\n\n[Admin privilege granted (Okta) – This query searches for successful grant of administrator](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Okta%20Single%20Sign-On/Hunting%20Queries/AdminPrivilegeGrant.yaml)\npermissions to user/groups. Adversaries often attempt to assign administrator permission to\nusers/group to maintain access as well as to elevate privileges.\n\nVerify the behavior is known and filter out any expected activity and triage unknown. See\n[Okta API event types for details.](https://developer.okta.com/docs/reference/api/event-types/)\n\n[Create API token (Okta) – This query searches for attempts to create new API token. Okta](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Okta%20Single%20Sign-On/Hunting%20Queries/CreateAPIToken.yaml)\nAPI tokens are used to authenticate requests to Okta APIs.\n\nInvestigate attempts to create new API token creation or authentication attempts. See Okta\nAPI event types for details.\n\n[Initiate impersonation session (Okta) – This query searches for impersonation events used in](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Okta%20Single%20Sign-On/Hunting%20Queries/ImpersonationSession.yaml)\nLAPSUS$ activity. User.session.impersonation are rare events, normally triggered when an\nOkta Support person requests admin access for troubleshooting.\n\nReview user.session.impersonation events and correlate that with legitimate opened Okta\n[support tickets to determine if these are anomalous. See Okta API event types and](https://developer.okta.com/docs/reference/api/event-types/)\n[Cloudflare’s investigation of the January 2022 Okta compromise for details.](https://blog.cloudflare.com/cloudflare-investigation-of-the-january-2022-okta-compromise/)\n\n[Rare MFA operations (Okta) – MFA helps prevent credential compromise. This query](https://github.com/Azure/Azure-Sentinel/blob/master/Solutions/Okta%20Single%20Sign-On/Hunting%20Queries/RareMFAOperation.yaml)\nsearches for rare MFA operations like deactivating, updating, resetting, and attempts to\nbypass MFA.\n\nAdversaries often attempt these operations to compromise networks and high-value\naccounts.\n\nVerify that the behavior is known and filter out anything that is expected. See Okta API event\ntypes for details.\n\n### Persistence\n\n**Microsoft 365 Defender hunting queries**\n\n\n-----\n\n[Device registration after risky sign-in – This query looks for a new device registration in](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Persistence/riskySignInToDeviceRegistration.yaml)\nAzure AD preceded by a medium or high-risk sign-in session for the same user within a\nmaximum of six hours.\n\nInvestigate the user account to determine if it is compromised. Disable user account, reset\nuser password, and remove devices registered in Azure AD if compromised.\n\n[MFA method added after risky sign-in – This query looks for a new MFA method added to an](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Persistence/riskySignInToNewMFAMethod.yaml)\naccount that was preceded by a medium or high-risk sign-in session for the same user within\na maximum of six hours.\n\nInvestigate the user account to determine if it is compromised. If compromised, disable the\nuser account, reset user password, and remove the MFA method added by threat actor.\n\n### Exfiltration, destruction, and extortion\n\n**Microsoft Defender for Cloud Apps built-in detection: Delete multiple VMs in a single**\nsession\n\nThis detection profiles your environment and triggers alerts when users delete multiple VMs\nin a single session, relative to the baseline in your organization. This might indicate an\nattempted breach.\n\nInvestigate the user account performing the deletion operations to determine if it was\ncompromised or if the activities were performed legitimately and not part of a destructive\nattack.\n\n**Microsoft 365 Defender query**\n\n[Upload multiple code repositories to external cloud domains – This query looks for accounts](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Microsoft%20365%20Defender/Exfiltration/codeRepoExfil.yaml)\nthat uploaded multiple code repositories to external web domain.\n\nInvestigate if the accounts are compromised. If compromised, disable the accounts and reset\nthe passwords. Assess the impact of what information was obtained, looking for any\npasswords, secrets, certificates, and others that the attacker might be able to leverage.\n\n**Note: This query uses ‘FileUploadedToCloud’ event which is only available for customers**\nthat enabled Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud\nApps. See [Integrate Microsoft Defender for Endpoint with Defender for Cloud Apps for](https://docs.microsoft.com/en-us/defender-cloud-apps/mde-integration)\ndetails)\n\n**Microsoft Sentinel hunting queries**\n\n\n-----\n\n[Mass cloud resource deletions time series anomalies – This query generates baseline](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/AzureActivity/TimeSeriesAnomaly_Mass_Cloud_Resource_Deletions.yaml)\npattern of cloud resource deletions by a user and alert on an anomaly when any unusual\nspike is detected.\n\nInvestigate the anomalies from unusual or privileged users, they could be indication of a\ncloud infrastructure takedown by an adversary.\n\n[Mail redirect via ExO transport rule – This query identifies when Exchange Online transport](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/OfficeActivity/Mail_redirect_via_ExO_transport_rule.yaml)\nrule configured to forward emails.\n\nInvestigate detections to determine if a malicious actor has configured a new mailbox to\ncollect mail from multiple user accounts.\n\n[Time series anomaly for data size transferred to public internet – This query identifies](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/TimeSeriesAnomaly-MultiVendor_DataExfiltration.yaml)\nanomalous or unusual data transfers to public networks. This detection identifies large\ndeviations from a baseline pattern based on detection algorithms from the Sentinelintegrated Kusto Query Language (KQL) anomaly detection. The higher the score, the\nfurther it is from the baseline value. The output is aggregated to provide a summary view of\nunique source IP to destination IP address and port bytes sent traffic observed in the flagged\nanomaly hour. The source IP addresses which were sending less than\n_bytessentperhourthreshold have been excluded, the value of which can be adjusted as_\nneeded. You might have to run queries for individual source IP addresses from SourceIPlist\nto determine if anything looks suspicious. Investigate any sudden increase in data\ntransferred to unknown public networks as an indication of data exfiltration attempts.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-22 - DEV-0537 (UNC3661) criminal actor targeting organizations for data exfiltration and destruction.pdf"
    ],
    "report_names": [
        "2022-03-22 - DEV-0537 (UNC3661) criminal actor targeting organizations for data exfiltration and destruction.pdf"
    ],
    "threat_actors": [
        {
            "id": "52d5d8b3-ab13-4fc4-8d5f-068f788e4f2b",
            "created_at": "2022-10-25T16:07:24.503878Z",
            "updated_at": "2025-03-27T02:02:10.261742Z",
            "deleted_at": null,
            "main_name": "Lapsus$",
            "aliases": [
                "DEV-0537",
                "Strawberry Tempest"
            ],
            "source_name": "ETDA:Lapsus$",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "be5097b2-a70f-490f-8c06-250773692fae",
            "created_at": "2022-10-27T08:27:13.22631Z",
            "updated_at": "2025-03-27T02:00:55.534879Z",
            "deleted_at": null,
            "main_name": "LAPSUS$",
            "aliases": [
                "LAPSUS$",
                "DEV-0537",
                "Strawberry Tempest"
            ],
            "source_name": "MITRE:LAPSUS$",
            "tools": [
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4b9608d-af69-43bc-a08a-38167ac6306a",
            "created_at": "2023-01-06T13:46:39.335061Z",
            "updated_at": "2025-03-27T02:00:03.053961Z",
            "deleted_at": null,
            "main_name": "LAPSUS",
            "aliases": [
                "LAPSUS$",
                "DEV-0537",
                "SLIPPY SPIDER",
                "Strawberry Tempest"
            ],
            "source_name": "MISPGALAXY:LAPSUS",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2347282d-6b88-4fbe-b816-16b156c285ac",
            "created_at": "2024-06-19T02:03:08.099397Z",
            "updated_at": "2025-03-27T02:05:17.390442Z",
            "deleted_at": null,
            "main_name": "GOLD RAINFOREST",
            "aliases": [
                "Strawberry Tempest ",
                "Lapsus$"
            ],
            "source_name": "Secureworks:GOLD RAINFOREST",
            "tools": [
                "Mimikatz"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535721,
    "ts_updated_at": 1743041651,
    "ts_creation_date": 1660794785,
    "ts_modification_date": 1660794785,
    "files": {
        "pdf": "https://archive.orkl.eu/4da3b2a0e0c2f46c5c233b22058a517d860cf179.pdf",
        "text": "https://archive.orkl.eu/4da3b2a0e0c2f46c5c233b22058a517d860cf179.txt",
        "img": "https://archive.orkl.eu/4da3b2a0e0c2f46c5c233b22058a517d860cf179.jpg"
    }
}