{
    "id": "f853e8ca-5060-462c-832d-a18528e6dc4c",
    "created_at": "2022-10-25T16:48:16.057755Z",
    "updated_at": "2025-03-27T02:10:54.354636Z",
    "deleted_at": null,
    "sha1_hash": "e7c914466713e7e74fcc1338398a1340464e63bc",
    "title": "The Four Element Sword Engagement",
    "authors": "Arbor",
    "file_creation_date": "2016-04-13T19:41:46Z",
    "file_modification_date": "2016-04-13T19:41:46Z",
    "file_size": 11473274,
    "plain_text": "ASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n# ASERT \r Threat \r Intelligence \r Report \r 2016-­‐03 \r \n The \r Four-­‐Element \r Sword \r Engagement \r \n\n**Ongoing APT Targeting of Tibetan, Hong Kong, and Taiwanese Interests**\n\n## Executive \r Summary \r \n\nIn \r this \r paper, \r we \r reveal \r recent \r ongoing \r APT \r activity \r likely \r associated \r with \r long-­‐running \r threat \r campaigns \r and\nthe \r presumed \r existence \r of \r associated \r malcode, \r dubbed \r the \r Four \r Element \r Sword \r Builder, \r used \r to \r weaponize\nRTF \r documents \r for \r use \r in \r these \r campaigns. \r A \r sample \r of \r twelve \r different \r targeted \r exploitation \r incidents \r (taken\nfrom \r a \r larger \r set \r of \r activity) \r are \r described \r along \r any \r discovered \r connections \r to \r previously \r documented \r threat\ncampaigns.\n\nFour \r vulnerabilities \r -­‐ \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856, \r CVE-­‐2015-­‐1641, \r and \r CVE-­‐2015-­‐1770 \r – \r related \r to \r the\nparsing \r of \r Microsoft \r Rich \r Text \r File \r (RTF) \r documents \r are \r being \r leveraged \r by \r advanced \r threat \r actors \r to \r launch\nexploitation \r campaigns \r against \r members \r of \r the \r Tibetan \r community, \r along \r with \r journalists \r and \r human \r rights\nworkers \r in \r Hong \r Kong \r and \r Taiwan. \r One \r of \r these \r vulnerabilities \r – \r CVE-­‐2015-­‐1641 \r -­‐ \r has \r been \r typically \r used \r in\ncybercrime \r operations \r starting \r in \r 2015 \r and \r has \r not \r been \r widely \r observed \r in \r use \r by \r Advanced \r Persistent\nThreat \r (APT) \r actors \r until \r now. \r The \r vulnerabilities \r are \r being \r used \r to \r deliver \r Chinese-­‐oriented \r malware \r payloads\nsuch \r as \r Grabber, \r T9000, \r Kivars, \r PlugX, \r Gh0StRAT \r and \r Agent.XST.\n\nAnalysis \r of \r malware \r payloads, \r malware \r metadata \r and \r actor \r group \r Tactics, \r Techniques \r and \r Procedures \r (TTP’s)\nprovides \r useful \r insight \r into \r the \r malware, \r targeting, \r and \r links \r to \r past \r threat \r actor \r infrastructure. \r Indicator\noverlap \r reveals \r a \r connection \r to \r prior \r exploitation \r campaigns \r against \r the \r World \r Uyghur \r Congress \r (WUC) \r from\n2009-­‐2014 \r as \r presented \r in \r 2014 \r at \r the \r Usenix \r security \r conference \r [1]. \r Additional \r indicators \r suggest \r an \r overlap\nwith \r the \r actors \r behind \r “Operation \r Shrouded \r Crossbow”.\n\nThis \r recent \r activity \r matches \r pre-­‐existing \r targeting \r patterns \r towards \r the \r “Five \r Poisons” \r [2] \r -­‐ \r organizations \r and\nindividuals \r associated \r with \r perceived \r threats \r to \r Chinese \r government \r rule: \r Uyghurs, \r Tibetans, \r Falun \r Gong,\nmembers \r of \r the \r democracy \r movement \r and \r advocates \r for \r an \r independent \r Taiwan. \r This \r targeting \r scheme,\nalong \r with \r various \r malware \r artifacts \r and \r associated \r metadata, \r suggest \r that \r the \r threat \r actors \r herein \r have \r a\nChinese \r nexus.\n\nAdditional \r malware \r following \r the \r same \r type \r of \r patterns \r described \r has \r been \r discovered \r since \r this \r report \r was\nwritten, \r and \r suggests \r that \r these \r generalized \r threat \r campaigns \r using \r weaponized \r RTF \r documents \r are \r ongoing.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n2 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n### Vulnerabilities: \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856, \r CVE-­‐2015-­‐1641, \r CVE-­‐2015-­‐1770 \r \n\nThe \r Four \r Element \r Sword \r builder \r has \r been \r observed \r to \r utilize \r exploit \r code \r against \r four \r distinct \r vulnerabilities.\nEach \r malicious \r document \r created \r by \r the \r builder \r appears \r to \r leverage \r three \r or \r four \r of \r these \r vulnerabilities \r in\nthe \r same \r RTF \r document, \r given \r a \r .DOC \r extension. \r Some \r targets \r may \r warrant \r the \r use \r of \r newer \r exploit \r code,\nwhile \r others \r running \r on \r dated \r equipment \r and \r operating \r systems \r may \r still \r fall \r victim \r to \r the \r older \r exploits.\nActors \r will \r typically \r only \r use \r the \r amount \r of \r force \r necessary \r to \r accomplish \r their \r actions \r on \r objectives \r and \r will\nnot \r typically \r burn \r 0day \r exploit \r code \r or \r the \r most \r advanced \r techniques \r against \r targets \r that \r do \r not \r require\nthem.\n\n1. **CVE-­‐2012-­‐0158: \r This \r is \r a \r vulnerability \r affecting \r the \r ListView, \r ListView2, \r TreeView, \r and \r TreeView2**\n\nActiveX \r controls \r in \r MSCOMCTL.OCX \r in \r the \r Common \r Controls \r of \r various \r versions \r of \r Office \r and \r other\nsoftware. \r CVE-­‐2012-­‐0158 \r continues \r to \r be \r an \r extremely \r popular \r vulnerability, \r used \r by \r various \r threat\nactors \r for \r years. \r A \r review \r of \r Virus \r Total \r reveals \r activity \r as \r early \r as \r November \r of \r 2010, \r with \r over \r 1000\ndistinct \r file \r submissions. \r The \r fact \r that \r this \r exploit \r continues \r to \r be \r bundled \r into \r contemporary\ncampaigns \r is \r a \r testament \r to \r its \r longevity, \r although \r actors \r have \r incorporated \r more \r recent \r CVEs \r into\ntheir \r toolkits \r since \r targets \r are \r likely \r patching \r older \r vulnerabilities \r either \r by \r system \r replacement \r or\nthrough \r ongoing \r maintenance. \r The \r first \r public \r mention \r of \r this \r CVE \r being \r used \r in \r targeted \r exploitation\ncampaigns \r was \r on \r April \r 16, \r 2012 \r [3] \r with \r additional \r research \r published \r on \r April \r 19, \r 2012 \r [4]. \r Both \r of\nthose \r campaigns \r demonstrate \r targeting \r of \r the \r Tibetan \r community \r and \r also \r reveal \r an \r interest \r in \r the\nSouth \r China \r Sea. \r While \r early \r actors \r apparently \r developed \r their \r own \r exploit \r code, \r publicly \r available\nexploit \r code \r for \r this \r has \r been \r present \r in \r the \r Metasploit \r Framework \r since \r April \r 23, \r 2012, \r allowing \r any\nactor \r since \r then \r easy \r access \r to \r leverage \r this \r vulnerability \r for \r their \r own \r purposes.\n\n2. **CVE-­‐2012-­‐1856: \r This \r is \r vulnerability \r in \r the \r TabStrip \r ActiveX \r control \r in \r the \r Common \r Controls \r of**\n\nMSCOMCTL.OCX \r and \r affects \r various \r versions \r of \r Office \r and \r other \r software. \r This \r vulnerability \r has \r also\nbeen \r used \r in \r various \r targeted \r threat \r campaigns, \r although \r it \r is \r detected \r less \r often \r than \r CVE-­‐2012-­‐0158.\nVirus \r Total \r reveals \r 85 \r instances \r of \r this \r exploit \r code \r in \r February \r of \r 2016, \r with \r the \r first \r submission \r in\nSeptember \r of \r 2013, \r one \r submission \r a \r year \r later \r in \r September \r 2014, \r and \r then \r a \r substantial \r increase \r in\nactivity \r starting \r in \r April \r of \r 2015. \r  \r As \r of \r March \r 30, \r 2016, \r Virus \r Total \r reveals \r 353 \r instances \r of \r exploit\ncode \r for \r CVE-­‐2012-­‐1856, \r indicating \r a \r substantial \r increase \r in \r activity \r and/or \r detection. \r Malicious\ndocuments \r containing \r a \r combination \r of \r exploit \r code \r for \r CVE-­‐2012-­‐0158 \r and \r CVE-­‐2012-­‐1856 \r were\nobserved \r as \r early \r as \r October \r of \r 2012, \r however \r customers \r of \r VUPEN, \r an \r offensive \r security \r company,\nwere \r aware \r of \r this \r vulnerability \r since \r September \r of \r 2010 \r [5], \r although \r public \r disclosure \r was \r not \r made\nuntil \r August \r of \r 2012 \r – \r nearly \r two \r years \r later \r when \r Microsoft \r patched \r the \r bug \r with \r MS12-­‐060.\n\n3. **CVE-­‐2015-­‐1641: \r The \r vulnerability \r involves \r the \r parsing \r of \r crafted \r RTF \r documents \r affecting \r a \r variety \r of**\n\nversions \r of \r Office. \r  \r Virus \r Total \r contains \r 130 \r instances \r of \r exploit \r code \r for \r this \r vulnerability, \r with \r the \r first\nsubmission \r from \r August \r of \r 2015. \r Seven \r instances \r of \r this \r vulnerability \r appear \r in \r specific \r e-­‐mail \r files\nbeginning \r in \r at \r least \r November \r of \r 2015. \r Several \r of \r these \r e-­‐mail \r messages \r appear \r to \r be \r generated \r by\nactors \r interested \r in \r commercial \r and \r financial \r system \r compromise. An \r exploit \r for \r this \r vulnerability \r was\nbeing \r sold \r in \r the \r wild \r for \r $2000 \r in \r Mid-­‐July \r of \r 2015 \r [6] \r and \r was \r posted \r to \r YouTube \r on \r July \r 22, \r 2015 \r [7].\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 3\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r individuals \r selling \r the \r exploit \r code \r at \r the \r time \r appear \r to \r be \r associated \r with \r cybercrime \r operations\nrather \r than \r APT \r nation-­‐state \r targeted \r threats. \r Shortly \r thereafter, \r Sophos \r wrote \r about \r malicious\ndocuments \r appearing \r in \r the \r wild \r [8] \r and \r most \r of \r the \r examples \r they \r discuss \r appear \r to \r be \r related \r to\nfinancial \r threat \r campaigns, \r such \r as \r a \r possible \r exploitation \r campaign \r dealing \r with \r Point \r of \r Sale \r systems.\nLater, \r in \r December \r of \r 2015, \r the \r Microsoft \r Word \r Intruder \r (MWI) \r crimeware \r kit \r incorporated \r CVE-­‐2015-­‐\n1641 \r into \r its \r arsenal \r of \r exploit \r code \r [9]. \r In \r any \r event, \r easy \r access \r to \r exploit \r code \r in \r the \r underground\nallows \r targeted \r threat \r actors \r the \r means \r to \r easily \r and \r inexpensively \r obtain \r the \r code \r for \r their \r own \r use.\nIn \r some \r cases \r in \r the \r past, \r dynamics \r of \r the \r exploit \r food \r chain \r has \r meant \r that \r exploits \r have \r migrated\nfrom \r advanced \r threat \r actors \r to \r cybercriminals, \r however \r they \r can \r also \r migrate \r the \r other \r direction\ndepending \r upon \r the \r situation \r at \r hand. \r This \r exploit \r has \r gotten \r more \r popular \r and/or \r detected \r more\nfrequently \r since \r this \r research \r was \r initiated \r started. \r As \r of \r March \r 30, \r 2016, \r 453 \r instances \r of \r the \r exploit\ncode \r were \r detected \r by \r Virus \r Total.\n\n4. **CVE-­‐2015-­‐1770: \r “Microsoft \r Office \r 2013 \r SP1 \r and \r 2013 \r RT \r SP1 \r allows \r remote \r attackers \r to \r execute**\n\narbitrary \r code \r via \r a \r crafted \r Office \r document, \r aka \r \"Microsoft \r Office \r Uninitialized \r Memory \r Use\nVulnerability\" \r [10]. \r The \r vulnerability \r appears \r to \r be \r in \r an \r ActiveX \r control, \r according \r to \r Microsoft’s\nMS15-­‐059 \r bulletin \r [11]. \r Some \r likely \r Italian-­‐based \r exploitation \r activity \r involving \r the \r uWarrior \r Remote\nAccess \r Trojan \r was \r observed \r in \r August \r of \r 2015 \r [12] \r using \r CVE-­‐2015-­‐1770 \r and \r other \r older \r exploit \r code.\nOther \r instances \r of \r exploit \r code \r have \r been \r observed, \r and \r the \r volume \r is \r increasing. \r On \r Feb \r 2, \r 2016\nthere \r were \r only \r 42 \r recognized \r samples \r of \r this \r exploit \r code \r found \r in \r Virus \r Total. \r As \r of \r March \r 30, \r the\nnumber \r has \r tripled \r to \r 128. \r Of \r the \r observed \r samples, \r the \r first \r submission \r was \r from \r August \r 4, \r 2015 \r and\nthe \r most \r recent \r is \r from \r March \r 22, \r 2016. \r An \r exploit \r apparently \r for \r CVE-­‐2015-­‐1770 \r (plus \r CVE-­‐2015-­‐\n1650) \r was \r being \r sold \r starting \r in \r Mid \r September \r 2015 \r by \r a \r group \r calling \r themselves \r “DaVinci \r Coders”\nthat \r allows \r the \r threat \r actor \r to \r embed \r a \r binary \r of \r their \r choice \r inside \r the \r Office \r document \r that \r will \r then\nbe \r executed \r when \r the \r Office \r document \r is \r opened \r on \r an \r unpatched \r system. \r Numerous \r crafted \r RTF\ndocuments \r containing \r author \r metadata \r “Confidential \r Surfer” \r were \r discovered \r in \r September \r of \r 2015,\nand \r may \r be \r connected \r to \r this \r release. \r  \r While \r many \r instances \r of \r exploit \r code \r hitting \r CVE-­‐2015-­‐1170\nwere \r discovered, \r underground \r forum \r chatter \r suggests \r that \r exploit \r quality \r may \r not \r always \r be \r top-­‐\nnotch. \r The \r quality \r or \r efficacy \r of \r these \r particular \r cybercrime-­‐oriented \r exploits \r appears \r to \r vary, \r based\non \r the \r number \r of \r times \r exploitation \r appeared \r to \r fail \r during \r analysis.\n\n4 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n### Targeted Exploitation #1: Human Rights Lawyers & Tibetan Activist, Grabber Malware\n\nOn \r December \r 31, \r 2015, \r a \r malicious \r RTF \r file \r (with \r a \r .DOC \r extension) \r using \r filename \r “US \r Congress \r sanctions \r $6\nmillion \r fund \r for \r Tibetans \r in \r Nepal \r and \r India.doc” \r was \r mailed \r to \r two \r targets \r via \r spear-­‐phishing \r tactics. \r The \r RTF\nfile \r hashes \r are \r included \r in \r the \r IOC \r section.\n\nExploit \r code \r targeting \r four \r distinct \r CVE’s \r was \r detected \r in \r this \r and \r other \r attachments \r to \r spearphish \r messages\nand \r includes \r all \r four \r vulnerable \r elements: \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856, \r CVE-­‐2015-­‐1641, \r and \r CVE-­‐2015-­‐\n1770.\n\n**Targeting for sample #1: Hong-Kong Based Legal aid Group and Tibetan Activist**\n\nThe \r email \r was \r sent \r to \r a \r human \r rights \r associated \r group \r in \r Hong \r Kong \r and \r a \r BCC \r sent \r to \r an \r exiled \r Tibetan\nactivist.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 5\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r body \r of \r the \r document \r is \r about \r aid \r for \r the \r Tibetan \r community. \r A \r portion \r is \r reproduced \r here:\n\nDocument \r metadata \r indicates \r that \r someone \r using \r the \r name \r “bull”\nwas \r the \r last \r person \r to \r modify \r and \r save \r the \r document. \r The \r last\nmodification \r date \r was \r December \r 31, \r 2015 \r – \r the \r same \r day \r the \r mail\nwas \r sent \r to \r targets.\n\nRendering \r the \r Tibetan \r themed \r RTF \r document \r with \r a \r vulnerable\ninstance \r of \r Office \r results \r in \r the \r injection \r of \r the \r Grabber \r (aka\nEvilGrab) \r malware \r into \r the \r ctfmon.exe \r process. \r Grabber \r provides \r all\nof \r the \r usual \r Remote \r Access \r Trojan \r (RAT) \r capabilities \r that \r any \r actor\nwould \r want, \r such \r as \r the \r capability \r to \r remotely \r control \r the \r target\nsystem, \r list \r files, \r download \r and \r execute, \r spy \r on \r the \r user, \r download \r other \r code \r and \r execute \r commands \r to\nperform \r lateral \r movement, \r exfiltrate \r data, \r etc. \r For \r those \r seeking \r more \r background, \r a \r helpful \r document \r to\nunderstand \r the \r full \r capabilities \r of \r Grabber \r was \r written \r by \r Unit \r 42 \r in \r 2015 \r [13].\n\nInside \r the \r compromised \r machine, \r the \r Process \r Hacker \r tool \r allows \r us \r to \r easily \r observe \r the \r injected \r process\nctfmon.exe \r initiating \r an \r outbound \r connection \r to \r the \r C2 \r 180.169.28[.]58 \r on \r TCP/8080.\n\nWe \r can \r observe \r the \r User-­‐Agent \r value \r hardcoded \r inside \r the \r Grabber \r binary \r (as \r discussed \r in \r the \r “Uncovering\nthe \r Seven \r Pointed \r Dagger” \r document \r from \r Arbor \r ASERT \r (http://www.arbornetworks.com/blog/asert/wp\n6 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\ncontent/uploads/2016/01/ASERT-­‐Threat-­‐Intelligence-­‐Brief-­‐2015-­‐08-­‐Uncovering-­‐the-­‐Seven-­‐Point-­‐Dagger.pdf).\nThe \r following \r segment \r of \r memory \r reveals \r User-­‐Agent \r activity \r in \r the \r screenshot \r below.\n\nPast \r analysis \r suggests \r that \r Grabber \r exfiltrates \r data \r from \r the \r client \r in \r an \r encrypted \r fashion. \r This \r may \r not\nalways \r be \r the \r case \r however, \r as \r tests \r revealed \r an \r interesting \r occurence \r when \r the \r system \r was \r exploited \r a\nsecond \r time. \r System \r activity \r that \r occurred \r during \r the \r initial \r compromise \r was \r subsequently \r exfiltrated \r to \r the\nC2 \r in \r plaintext \r after \r the \r second \r comprise. \r This \r plaintext \r may \r allow \r additional, \r unexpected \r visibility \r for\nnetwork \r security \r apparatus \r in \r the \r right \r circumstances. \r  \r Below \r we \r see \r the \r tell-­‐tale \r User-­‐Agent \r value \r including\nthe \r unusual \r series \r of \r bytes \r prior \r to \r the \r GET \r request \r followed \r by \r exfiltration \r of \r system-­‐identifying \r information.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 7\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n**Using Memory Forensics to Obtain a Higher Fidelity Malware Sample**\n\nThe \r original \r sample \r is \r obfuscated \r in \r such \r a \r manner \r that \r it \r is \r less \r useful \r for \r generating \r analytical \r insight,\nespecially \r insight \r generated \r from \r static \r analysis. \r In \r order \r to \r obtain \r a \r cleaner \r sample \r we \r will \r need \r to \r extract \r it\nfrom \r the \r process \r that \r it \r was \r injected \r into. \r The \r Volatility \r memory \r forensics \r platform \r can \r help \r with \r this.\n\nFirst, \r the \r DumpIt \r tool \r provided \r in \r the \r Moonsols \r software \r package \r was \r used \r to \r generate \r a \r memory \r dump \r of\nthe \r compromised \r system. \r The \r memory \r dump \r was \r taken \r just \r after \r successful \r exploitation, \r as \r indicated \r by \r the\nobservation \r of \r traffic \r to \r the \r C2. \r We \r then \r determine \r the \r PID \r of \r the \r compromised \r process \r (ctfmon.exe) \r by \r using\nthe \r Volatility \r plugin \r ‘pslist’. \r In \r this \r example, \r our \r memory \r dump \r is \r contained \r in \r the \r file \r EvilGrab2.raw:\n\npython \r vol.py \r -­‐f \r c:\\stuff\\EvilGrab2.raw \r pslist \r -­‐-­‐profile=Win7SP1x86 \r > \r pslist_take2.txt\n\nThe \r malfind \r plugin \r can \r help \r us \r discover \r memory \r regions \r where \r code \r injection \r has \r occurred. \r Running \r malfind\nwith \r ‘python \r vol.py \r -­‐f \r c:\\stuff\\EvilGrab2.raw \r malfind \r -­‐-­‐profile=Win7SP1x86 \r > \r malfind_run2.txt’ \r provides \r us \r a\nshort \r list \r of \r memory \r regions \r worthy \r of \r further \r analysis. \r In \r particular, \r malfind \r provides \r us \r with \r indicators \r of\ncode \r injection \r at \r memory \r address \r 0x150000 \r inside \r ctfmon.exe, \r where \r we \r observe \r the \r presence \r of \r an \r MZ\nheader.\n\nOther \r MZ \r headers \r can \r be \r found \r in \r the \r memory \r space \r of \r ctfmon.exe \r at \r addresses \r 0x100000, \r 0x7ff80000 \r and\n0x7ffa0000. \r We \r can \r extract \r the \r injected \r code \r with \r the \r dlldump \r plugin \r and \r save \r those \r files \r for \r easier \r analysis.\nIn \r this \r case, \r the \r memory \r address \r 0x150000 \r was \r the \r most \r useful \r location \r for \r extraction. \r We \r extract \r the\ninjected \r DLL \r from \r the \r base \r address \r 0x150000 \r and \r save \r it \r to \r disk \r with \r the \r following \r command:\n\npython \r vol.py \r -­‐f \r c:\\stuff\\EvilGrab2.raw \r dlldump \r -­‐-­‐pid \r 3596 \r -­‐-­‐memory \r -­‐-­‐base=0x150000 \r -­‐-­‐profile=Win7SP1x86 \r -­‐-­‐\ndump-­‐dir=ctfmon_dlldump_directory\n\n8 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nAnalysis \r of \r the \r extracted \r file \r results \r in \r a \r much \r cleaner \r (but \r not \r perfect) \r instance \r of \r Grabber \r that \r allows \r the\nanalyst \r or \r incident \r responder \r to \r gain \r greater \r insight \r into \r specific \r threat \r activity. \r For \r example, \r by \r using \r IDA \r Pro\nfor \r static \r analysis \r on \r the \r freshly \r extracted \r file, \r we \r observe \r the \r naming \r scheme \r inside \r the \r code \r where \r threat\nactors \r have \r named \r the \r malware \r “Grabber”. \r Additionally, \r we \r can \r also \r observe \r the \r C2 \r (180.169.28[.]58) \r and \r a\nmutex \r string \r (v2014-­‐v05) \r inside \r the \r .data \r section \r of \r the \r binary.\n\nAn \r additional \r method \r to \r obtain \r deeper \r insight \r is \r to \r use \r Process \r Hacker \r 2, \r find \r the \r RWX \r memory \r sections\nwithin \r the \r ctfmon.exe \r process \r and \r visually \r analyze \r for \r malware \r artifacts \r (as \r seen \r below). \r An \r analyst \r could \r also\nsave \r the \r memory \r to \r a \r binary \r file \r to \r be \r opened \r and \r analyzed \r in \r IDA. \r By \r default \r the \r import \r table \r will \r not \r exist\nbut \r some \r insight \r can \r be \r obtained.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 9\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nAn \r example \r of \r the \r insight \r obtained \r via \r examining \r strings \r in \r the \r .data \r section \r with \r IDA \r Pro \r reveals \r some \r of \r the\ntext \r strings \r used \r to \r represent \r the \r use \r of \r keys \r that \r do \r not \r correspond \r to \r a \r simple \r letter \r or \r number \r (such \r as\n<SHIFT \r UP>) \r that \r may \r be \r used \r when \r keylogging \r functionality \r is \r activated.\n\n**IOC’s**\n\nC2: \r 180.169.28.58:8080\nMD5 \r (spearphish): \r 7d4f8341b58602a17184bc5c07311e8b\nMD5 \r (RTF): \r c674ae90f686d831cffc223a55782a93\nMD5 \r (IEChecker.exe): \r 46c7d064a34c4e02bb2df56e0f8470c0\nSHA-­‐256: \r (Spearphish): \r bacc4edb5e775d2c957022ad8360946c19f9f75ef2709c1db2d6708d53ec2cd1\nSHA-­‐256 \r (RTF): \r af2cc5bb8d97bf019280c80e2891103a8a1d5e5f8c6305b6f6c4dd83ec245a7d\nSHA-­‐256 \r (IEChecker.exe): \r 7a200c4df99887991c638fe625d07a4a3fc2bdc887112437752b3df5c8da79b6\n\n**Connections to Historical and Ongoing Threat Campaign Activity: Uyghur NGO, Tibetans**\n\nThe \r C2 \r is \r 180.169.28[.]58 \r TCP/8080 \r and \r is \r located \r in \r Shanghai, \r China. \r This \r IP \r address \r has \r been \r associated \r with\na \r dynamic \r DNS \r provider, \r and \r has \r resolved \r as \r goodnewspaper.f3322[.]org \r and \r xinxin20080628.3322[.]org \r in\nthe \r past.\n\n10 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nGoodnewspaper[.]f3322.org \r as \r well \r as \r potentially \r related \r domains \r goodnewspaper.3322[.]org \r and\ngoodnewspaper.gicp[.]net \r were \r listed \r as \r C2 \r for \r threat \r activity \r in \r a \r paper \r presented \r at \r the \r Usenix \r conference\nin \r 2014 \r entitled \r “A \r Look \r at \r Targeted \r Attacks \r Through \r the \r Lense \r of \r an \r NGO” \r [14] \r that \r analyzes \r targeted\nexploitation \r campaigns \r from \r 2009 \r and \r 2013 \r directed \r particularly \r at \r the \r World \r Uyghur \r Congress \r (WUC) \r NGO.\nAs \r a \r result \r of \r this \r infrastructure \r overlap, \r we \r see \r a \r connection \r to \r prior \r activity \r and \r a \r larger \r historical \r sense \r of\ntargeting \r against \r Uyghur \r interests. \r In \r addition \r to \r the \r goodnewspaper \r sites, \r we \r also \r see \r numerous \r other\nUyghur \r themed \r sites \r associated \r to \r the \r IP \r address:\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 11\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r xinxin20080628 \r hostname \r portion \r of \r one \r of \r the \r domain \r names \r is \r also \r interesting, \r as \r it \r was \r mentioned \r in\na \r 2009 \r report \r by \r F-­‐secure \r [15] \r as \r associated \r with \r a \r different \r dynamic \r DNS \r provider, \r gicp.net. \r The \r domain \r in\nthat \r case \r was \r xinxin20080628.gicp[.]net \r instead \r of \r xinxin20080628.3322[.]org \r as \r observed \r here. \r  \r The\nxinxin20080628.3322[.]org \r domain \r only \r resolved \r for \r a \r very \r short \r period \r of \r approximately \r four \r hours \r on \r April\n23, \r 2014.\n\nWhile \r it \r is \r of \r course \r possible \r that \r the \r use \r of \r this \r domain \r is \r a \r misdirection \r designed \r to \r point \r analysts \r in \r the\nwrong \r direction, \r it \r is \r also \r possible \r that \r the \r actor \r using \r the \r dynamic \r DNS \r client/script \r made \r a \r mistake \r and\ntemporarly \r resolved \r the \r domain, \r or \r had \r need \r to \r do \r so \r on \r a \r short-­‐term \r basis \r (to \r test \r C2 \r perhaps). \r As \r this \r is \r an\nolder \r artifact, \r there \r could \r be \r other \r explanations \r however \r it \r is \r a \r clue \r worth \r noting \r that \r may \r tie \r modern \r activity\nto \r previously \r documented \r campaigns \r and \r their \r TTPs \r and \r threat \r actors.\n\nA \r master \r list \r of \r IOC’s \r provided \r by \r Citizen \r Lab \r  \r (released \r in \r conjunction \r with \r their \r reporting \r on \r various\nadvanced \r threat \r activity) \r lists \r the \r domain \r xinxin20080628[.]gicp.net \r in \r November \r 2010 \r [16] \r and \r the \r IP \r address\nbeing \r used \r at \r that \r time:\n\n2010-­‐11-­‐19 xinxin20080628.gicp[.]net 114.60.106[.]156\n\nThis \r domain \r is \r also \r included \r in \r the \r aforementioned \r USENIX \r paper. \r  \r Other \r campaign \r activities \r involving \r the\nxinxin20080628.gicp[.]net \r domain \r were \r profiled \r by \r Communities \r @ \r Risk \r [17] \r and \r reveals \r activity \r in \r 2010\ninvolving \r two \r executables \r delivered \r to \r a \r target. \r The \r payload \r in \r that \r case \r was \r the \r IEXPL0RE \r RAT, \r also \r known \r as\nC0d0s0. \r The \r IEXPL0RE \r campain \r discussed \r therein \r involved \r targeting \r of \r Tibetan \r and \r Chinese \r communities. \r The\n\n12 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nconnection \r to \r prior \r threat \r campaigns \r suggests \r that \r campaign \r activity \r continues \r and \r continues \r to \r evolve \r as\nnew \r exploit \r code \r becomes \r available.\n\nA \r substantial \r amount \r of \r activity \r surrounds \r the \r domain \r xinxin20080628.gicp[.]net \r that \r may \r be \r of \r interest \r in\nexpanding \r potentially \r related \r context. \r  \r Those \r interested \r in \r further \r explorations \r of \r threat \r indicators \r from \r past\nactivity \r may \r benefit \r from \r examining \r malware \r such \r as \r the \r malicious \r RTF \r targeting \r CVE-­‐2010-­‐3333 \r (SHA-­‐256:\n14fcfccb0ae8988f95924256a38477fcc5c2c213d8a55e5a83c8c1bb67a4b6d4). \r This \r malicious \r RTF \r generates\nnetwork \r traffic \r to \r xinxin20080628.gicp[.]net \r and \r humanbeing2009.gicp[.]net. \r Targeting \r of \r Tibetan \r groups \r with\nmalicious \r RTF \r files \r and \r exploitation \r of \r CVE-­‐2010-­‐3333 \r is \r also \r mentioned \r in \r the \r aforementioned \r Communities\n@ \r Risk \r document.\n\nAnother \r interesting \r domain \r overlap \r concerns \r malware \r observed \r in \r 2013 \r dubbed \r BLame, \r also \r known \r as \r Mgbot\nor \r Mgmbot \r and \r discussed \r on \r page \r 18 \r of \r the \r presentation \r given \r at \r Virus \r Bulletin \r 2013 \r [18]. \r These \r slides\ndescribe \r the \r use \r of \r the \r goodnewspaper.gicp[.]net \r and \r goodnewspaper.3322[.]org \r domains \r in \r version \r 2.3 \r of\nthe \r malware \r payload, \r first \r observed \r in \r July \r of \r 2012. \r This \r incident \r is \r interesting \r because \r the \r malcode \r is \r hidden\nin \r such \r a \r manner \r as \r to \r appear \r to \r be \r an \r MP3 \r encoding \r library \r [19].\n\n### Targeted Exploitation #2: Attempted Human Rights Target, Grabber Malware\n\nWhile \r there \r are \r other \r instances \r of \r exploitation \r taking \r place \r via \r crafted \r documents \r using \r the \r same \r four \r CVE’s,\nonly \r one \r has \r a \r matching \r SSDEEP \r hash\n(6144:NwOD0nTHfnxBl7p01yDn8FJD1O6JN0MrvVburdr3QM5o1Zx0a4VgLjv9uM+yb3Hx:ZbqQM5oBfv9uMt5y\nGg \r BT5yL) \r as \r the \r prior \r sample \r discussed \r in \r Targeted \r Exploitation \r #1. \r The \r spear \r phishing \r e-­‐mail \r in \r this \r second\ncase \r appears \r to \r have \r been \r sent \r to \r the \r wrong \r target, \r as \r an \r apparent \r error \r in \r the \r targets \r email \r address \r is\nobserved \r – \r the \r e-­‐mail \r address \r was \r entered \r using \r the \r number \r 1 \r instead \r of \r an \r l \r character. \r The \r message \r follows:\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 13\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r e-­‐mail \r was \r sent \r on \r Thursday \r Dec \r 31, \r 2015 \r at \r 19:08:25 \r +0800 \r (HKT) \r and \r was \r submitted \r to \r Virus \r Total \r from\nTaiwan. \r The \r Chinese \r language \r text \r in \r the \r mail \r message, \r when \r translated \r to \r English, \r mentions \r a \r meteor\nshower \r and \r the \r Hong \r Kong \r Space \r Museum. \r This \r is \r a \r different \r approach \r than \r threat \r actors \r providing \r the \r usual\ngeopolitical \r content, \r but \r perhaps \r the \r intent \r was \r to \r provide \r some \r item \r that \r may \r be \r considered \r personally\ninteresting \r to \r the \r target.\n\nThe \r attachment \r filename \r “與天空有約!12 個 2016 年不可錯過的天文\n現象 \r mm.doc” \r roughly \r translates \r from \r Chinese \r as \r “About \r the \r sky \r ! \r 12\n2016 \r astronomical \r phenomenon \r not \r to \r be \r missed”.\n\nThe \r Word \r document \r metadata, \r to \r the \r left, \r shows \r our \r now-­‐familiar\ntimeframe \r of \r December \r 31, \r 2015 \r and \r a \r name \r of \r “webAdmin” \r as \r the\ndocument \r author \r and \r modifier. \r Depending \r upon \r the \r generation\nscenario \r at \r play, \r such \r document \r metadata \r may \r or \r may \r not \r be \r useful,\nbut \r is \r being \r included \r inside \r this \r report \r to \r provide \r potential \r indicators\nthat \r may \r help \r track \r down \r other \r APT \r activity.\n\n14 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r original \r text \r of \r the \r document \r and \r a \r rough \r English \r translation \r is \r as \r follows:\n\nThe \r final \r payload \r in \r this \r document \r exploit \r is \r also \r Grabber \r – \r the \r same \r sample \r used \r in \r Targeted \r Exploitation \r #1.\nTherefore, \r this \r sample \r uses \r the \r same \r C2 \r as \r Targeted \r Exploitation \r #1 \r and \r other \r samples \r profiled \r in \r this \r set.\n\n**IOC’s**\n\nC2: \r 180.169.28.58:8080\nFilename: \r 與天空有約!12 個 2016 年不可錯過的天文現象 \r mm.doc\nMD5 \r (spearphish): \r b6e22968461bfb2934c556fc44d0baf0\nMD5 \r (RTF): \r 74a4fe17dc7101dbb2bb8f0c41069057\nMD5 \r (~tmp.doc): \r fcfe3867e4fa17d52c51235cf68a86c2\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 15\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nMD5 \r (IEChecker.exe): \r 46c7d064a34c4e02bb2df56e0f8470c0\nSHA-­‐256 \r (spearphish): \r 4f52292a2136eb7f9538230ae54a323c518fa44cf6de5d10ca7a04ecb6a77872\nSHA-­‐256 \r (RTF): \r 0683fac0b564fe5d2096e207b374a238a811e67b87856fc19bdf8eb3d6f76b49\nSHA-­‐256 \r (~tmp.doc): \r 60ef10cce9974cdc8a453d8fdd8ddf0cad49c6f07d2c4d095ff483998685b421\nSHA-­‐256 \r (IEChecker.exe): \r 7a200c4df99887991c638fe625d07a4a3fc2bdc887112437752b3df5c8da79b6\n\n**Connections to Historical and Ongoing Threat Campaign Activity**\n\nThe \r analysis \r service \r cryptam.com \r contains \r this \r particular \r malware \r sample \r [20] \r and \r is \r using \r YARA \r to \r classify\nthe \r sample \r using \r a \r tag \r of \r “apt_north_beaver_wmonder_vidgrab”. \r The \r name \r “north \r beaver” \r doesn’t \r appear \r to\nbe \r related \r to \r a \r publicly \r known \r APT \r campaign. \r Vidgrab \r is \r however \r another \r name \r for \r the \r Grabber/Evilgrab\nmalware. \r The \r presence \r of \r “wmonder” \r in \r the \r YARA \r rule \r is \r most \r likely \r due \r to \r the \r use \r of \r the \r older \r Grabber \r C2\ndomain \r webmonder.gicp[.]net, \r mentioned \r by \r Trend \r Micro \r in \r their \r 2013 \r 2Q \r Report \r on \r Targeted \r Attack\nCampaigns \r [21]. \r Documents \r associated \r with \r the \r classifier \r “apt_north_beaver_wmonder_vidgrab” \r have \r been\npresent \r since \r at \r least \r 2013. \r  \r It \r is \r possible \r that \r there \r is \r a \r relationship \r between \r these \r earlier \r malicious\ndocuments \r and \r recently \r observed \r activity, \r or \r that \r the \r recent \r documents \r are \r simply \r a \r reflection \r of \r the\ncontinuation \r of \r prior \r campaign \r activity.\n\n### Targeted Exploitation #3: Asian Press, Kivars Keylogger Payload\n\nOn \r Jan \r 2, \r 2016 \r a \r spearphish \r mail \r was \r sent \r to \r the \r target.\n\nThe \r subject \r for \r this \r message \r is\n“[BULK] \r TIBET, \r OUR \r BELOVED \r NATION\nAND \r WILL \r NEVER \r FORGET \r IT.” \r In \r this\ncase, \r the \r actors \r have \r embedded \r the\nmalware \r inside \r a \r RAR \r file \r and \r have\npositioned \r the \r RAR \r file \r as \r needing\ntranslation. \r It \r is \r not \r known \r how\ncommon \r it \r may \r be \r for \r authors \r to \r use\nthe \r RAR \r format \r in \r such \r a \r case,\nhowever \r it \r does \r appear \r to \r be\nsuspicious.\n\n16 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r specific \r target \r in \r this \r case \r appears \r to \r be \r an \r individual \r working \r with \r a \r media \r and \r publications \r press \r in\nHong \r Kong. \r The \r company \r associated \r with \r this \r individual \r has \r been \r reported \r to \r be \r heavily \r influenced \r by \r the\nChinese \r Government.\n\nThe \r RAR \r archive \r contains \r a \r file \r named \r “brochure. \r doc”\n(note \r the \r space) \r which \r is \r actually \r an \r RTF. \r Opening\nbrochure \r .doc \r in \r a \r vulnerable \r environment \r (Windows\n7, \r Office \r 2013, \r unpatched) \r results \r in \r the \r display \r of \r a \r file\nthat \r appears \r to \r be \r corrupted \r and/or \r composed \r of\ngarbage \r characters, \r as \r observed \r on \r the \r left.\n\nTriggering \r of \r the \r final \r payload \r results \r in \r a \r TCP \r connection \r to \r 103.240.203[.]232:8080. \r This \r IP \r address \r is \r located\nin \r Hong \r Kong \r (in-­‐country \r to \r the \r target). \r  \r When \r the \r malware \r initiates \r an \r outbound \r connection \r to \r the \r server,\nthe \r server \r responds \r with \r the \r following \r data:\n\nThis \r information \r may \r be \r useful \r for \r network-­‐based \r detection.\n\nDuring \r analysis, \r several \r files \r were \r created \r during \r the \r exploitation, \r including \r tnyjs.dll, \r uhfx.dat, \r uhfx.dll, \r and\nyxsrhsxhxdbldkc.dat. \r These \r were \r created \r in \r the \r Windows/System32 \r folder.\n\nAttempting \r to \r open \r one \r of \r the \r DLL’s \r in \r IDA \r Pro \r resulted \r in \r a \r helpful \r pop-­‐up \r message \r that \r reveals \r a \r PDB \r string\nthat \r correlates \r this \r sample \r with \r instances \r of \r the \r Kivars \r keylogger \r [22]. \r The \r PDB \r string \r is\nQ:\\Projects\\Br2012\\Release\\svc.pdb. \r Analysis \r of \r this \r DLL \r sample \r reveals \r that \r it \r is \r designed \r to \r run \r as \r a \r service,\nwhich \r matches \r the \r design \r of \r Kivars.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 17\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n**Connections to Historical and Ongoing Threat Campaign Activity: Shrouded Crossbow**\n\nSeveral \r additional \r samples \r of \r the \r Kivars \r malware \r were \r discovered \r that \r might \r have \r an \r overlap \r with \r this\nparticular \r campaign. \r The \r overlap \r is \r circumstantial, \r since \r the \r only \r common \r elements \r we \r have \r are \r the \r use \r of\nKivars \r itself, \r and \r C2 \r infrastructure \r also \r being \r geolocated \r in \r Hong \r Kong. \r Kivars \r appears \r to \r be \r somewhat \r rare,\nwith \r only \r a \r limited \r amount \r of \r samples \r appearing \r in \r the \r ASERT \r malware \r analysis \r repository. \r It \r is \r currently\nunknown \r if \r the \r malware \r family \r is \r closely \r held, \r or \r shared \r among \r numerous \r actor \r groups.\n\nPivoting \r on \r the \r import \r hash \r value \r of \r the \r malware \r payload \r reveals \r a \r potentially \r related \r sample, \r an \r unnamed\nkeylogger \r malware \r analyzed \r by \r ASERT \r on \r 1-­‐20-­‐2016 \r with \r an \r MD5 \r of \r a0dc5723d3e20e93b48a960b31c984c0\nand \r a \r SHA-­‐256 \r hash \r of \r 185fc01ec8adbaa94da741c4c1cf1b83185ae63899f14ce9949553c5dac3ecf6. \r This\nsample \r connected \r to \r the \r same \r C2 \r -­‐ \r akm.epac[.]to \r on \r TCP/8088, \r resolving \r at \r analysis \r time \r as\n103.240.203[.]232, \r an \r IP \r address \r in \r Hong \r Kong. \r  \r The \r domain \r akm.epac[.]to \r began \r resolving \r to \r this \r IP \r address\non \r January \r 2, \r 2016 \r and \r the \r domain \r gugehotel[.]cn \r began \r resolving \r to \r this \r IP \r address \r on \r February \r 23, \r 2016 \r and\ncontinues \r to \r resolve \r as \r of \r this \r writing \r on \r March \r 16, \r 2016.\n\nThe \r gugehotel \r domain \r also \r shows \r resolution \r activity \r between \r 11-­‐7-­‐2014 \r and \r 6-­‐9-­‐2015 \r to \r the \r IP \r address\n107.183.86[.] \r that \r reveal \r a \r large \r number \r of \r passive \r DNS \r resolutions \r (570), \r which \r likely \r disqualifies \r the \r IP\naddress \r for \r follow-­‐up \r research. \r It \r is \r potentially \r interesting \r to \r note \r however \r that \r many \r of \r the \r passive \r DNS\nresolutions \r for \r this \r domain \r have \r the \r suffix \r domain \r cos-­‐china.com. \r This \r may \r be \r related \r to \r the \r China \r Operating\nSystem \r (COS) \r which \r is \r a \r Chinese-­‐based \r operating \r system \r designed \r to \r compete \r with \r iOS \r and \r Android \r [23].\n\nPivoting \r on \r aspects \r of \r this \r sample \r returns \r other \r potentially \r interesting \r samples:\n\n  - MD5 \r 937c13f5915a103aec8d28bdec7cc769 \r uses \r a \r C2 \r of \r 203.160.247[.]21:443\n\n`o` ASN \r 10126 \r  \r  \r | \r 203.160.247.21 \r  \r  \r | \r TW \r | \r CHTI-­‐IP-­‐AP \r Taiwan \r Internet \r Gateway,TW\n`o` This \r C2 \r IP \r address \r is \r also \r found \r in \r a \r Kivars \r service \r binary \r (MD5:\n\n19b2ed8ab09a43151c9951ff0432a861, \r SHA-­‐256:\n9d69221584a5c6f8147479282eae3017c2884ae5138d3b910c36a2a38039c776)\n\n  - MD5: \r b2ae8c02163dcee142afe71188914321 \r – \r uses \r wins.microsoftmse[.]com \r for \r C2.\n\n`o` This \r sample \r was \r submitted \r to \r Virus \r Total \r in \r October \r of \r 2014 \r from \r Taiwan.\n\nSamples \r discovered \r so \r far \r are \r triggering \r an \r AV \r detection \r of \r Kivars, \r which \r has \r been \r written \r about \r by \r Trend \r in\n2014 \r [24].\n\nOne \r particular \r sample \r first \r submitted \r to \r Virus \r Total \r in \r 2013 \r and \r discovered \r via \r a \r Yara \r retrohunt, \r has \r the\nfollowing \r properties:\n\n18 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nMD5: \r 0566703ccda6c60816ef1d8d917aa7b0\nSHA-­‐256: \r 766e0c75bb13986f6a18f9f6af422dbda8c6717becc9b02cc4046943a960d21f\n\nThis \r sample \r once \r connected \r to \r adc.microsoftmse[.]com \r (122.10.9[.]121), \r resolving \r to \r an \r IP \r address \r in \r Hong\nKong. \r This \r resolution \r only \r appears \r to \r have \r taken \r place \r on \r 7-­‐6-­‐2013 \r and \r was \r associated \r with \r the \r bifrose \r Trojan\nand \r also \r correlates \r with \r Shrouded \r Crossbow \r activity. \r Numerous \r other \r domains \r resolving \r to \r this \r IP \r were \r also\nobserved \r to \r be \r part \r of \r Shrouded \r Crossbow \r infrastructure. \r The \r domain \r microsoftmse[.]com \r currently \r points \r to\nMicrosoft \r address \r space, \r but \r was \r used \r by \r threat \r actors \r in \r the \r past.\n\nFurther \r details \r on \r Operation \r Shrouded \r Crossbow \r were \r published \r by \r Trend \r Micro \r in \r December \r of \r 2015 \r [22]\nand \r reveals \r the \r use \r of \r the \r Bifrose \r and \r Kivars \r Trojans \r and \r the \r relationship \r between \r the \r two \r – \r Kivars \r appears \r to\nhave \r re-­‐used \r at \r least \r some \r parts \r of \r the \r Bifrose \r code. \r [25]\n\nSubmitting \r one \r of \r the \r DLL’s \r to \r Virus \r Total \r results \r in \r predictable \r scan \r results, \r and \r pivoting \r on \r the \r import \r hash\nresults \r in \r the \r discovery \r of \r several \r more \r samples \r of \r the \r Kivars \r service. \r Scanning \r Virus \r Total \r indicates \r numerous\nrecent \r detections \r of \r Kivars. \r Many \r of \r the \r discovered \r Kivars \r service \r files \r have \r been \r submitted \r in \r January \r and\nFebruary \r of \r 2016, \r indicating \r a \r new \r wave \r of \r activity \r and/or \r detection.\n\nA \r YARA \r rule \r to \r detect \r instances \r of \r Kivars \r running \r as \r a \r service \r is \r included \r herein. \r Service \r files \r are \r distinct \r and\ncan \r be \r analyzed \r directly, \r but \r scanning \r of \r memory \r could \r also \r be \r useful \r in \r the \r event \r that \r Kivars \r becomes \r more\nhighly \r obfuscated.\n\nrule \r kivars_service \r {\n\nmeta:\n\ndescription \r = \r \"Detects \r instances \r of \r Kivars \r malware \r when \r installed \r as \r a \r service\"\nauthor \r = \r \"cwilson@arbor.net\"\nSHA-­‐256 \r = \r \"443d24d719dec79a2e1be682943795b617064d86f2ebaec7975978f0b1f6950d\"\nSHA-­‐256 \r = \r \"44439e2ae675c548ad193aa67baa8e6abff5cc60c8a4c843a5c9f0c13ffec2d8\"\nSHA-­‐256 \r = \r \"74ed059519573a393aa7562e2a2afaf046cf872ea51f708a22b58b85c98718a8\"\nSHA-­‐256 \r = \r \"80748362762996d4b23f8d4e55d2ef8ca2689b84cc0b5984f420afbb73acad1f\"\nSHA-­‐256 \r = \r \"9ba14273bfdd4a4b192c625d900b29e1fc3c8673154d3b4c4c3202109e918c8d\"\nSHA-­‐256 \r = \r \"fba3cd920165b47cb39f3c970b8157b4e776cc062c74579a252d8dd2874b2e6b\"\n\nstrings:\n\n$s1 \r  \r = \r \"\\\\Projects\\\\Br2012\\\\Release\\\\svc.pdb\"\n$s2 \r  \r = \r \"This \r is \r a \r flag\"\n$s3 \r  \r = \r \"svc.dll\"\n$s4 \r  \r = \r \"ServiceMain\"\n$s5 \r  \r = \r \"winsta0\"\n\ncondition:\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 19\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nuint16(0) \r == \r 0x5A4D \r and \r filesize \r < \r 1000000 \r and \r (all \r of \r ($s*))\n\n}\n\nInterestingly, \r all \r of \r these \r Kivars \r service \r files \r listed \r in \r the \r YARA \r rule \r have \r the \r same \r compilation \r date \r of \r 2013-­‐\n11-­‐20@00:26:30. \r Some \r AV \r detection \r that \r appears \r to \r be \r reasonably \r accurate \r includes \r BKDR_KIVARS.SMV0\n(Trend) \r and \r Win32/Agent.XUI \r Trojan \r (ESET).\n\n**IOC’s**\n\nC2: \r akm.epac[.]to\nC2: \r 103.240.203.232:8080\nMD5 \r (brochure \r .rar): \r c8c6365bf21d947e8e986d4766a9fc16\nMD5 \r (brochure \r .doc): \r 835fee42132feebe9b3231297e5e71a8\nMD5 \r (binary): \r 905d1cd328c8cfc378fb00bfa38f0427\nImphash \r (binary): \r fea5902afa6e504a798c73a09b83df5e\nMD5 \r (tnyjs.dll): \r 5bc954d76342d2860192398f186f3310\nMD5 \r (uhfx.dll): \r 6db7ad23186f445c410f59a41e7f8ac5\nSHA-­‐256 \r hash \r (brochure \r .rar): \r e8af4f3504b0e1cf165dfd1070342b831fd7b5b45da94c6f2a25c28dd6eb3c4a\nSHA-­‐256 \r hash \r (brochure \r .doc): \r 0ed325b841a2beb446c5e9a6825deaa021651c8b627aa7147d89edde05af6598\nSHA-­‐256 \r (binary): \r 18219708781208889af05842ea6d563e56910424ec97ef8f695c0c7a82610a23\nSHA-­‐256 \r (tnyjs.dll): \r 5676c0b2d3c139dbef5bafa0184576bd1a4ccbd3f7d40b4a6a099a1e61bc2a39\nSHA-­‐256 \r (uhfx.dll): \r a46905252567ed2fe17a407d8ae14036fde180f0a42756304109f34d1e8ad872\n\n### Targeted Exploitation #4: 64 Bit Kivars Keylogger\n\nTargeting \r is \r not \r available \r for \r this \r sample, \r however \r it \r was \r first \r uploaded \r to \r VT \r from \r Korea \r and \r first \r observed \r by\nASERT \r on \r January \r 2, \r 2016. \r A \r 64-­‐bit \r instance \r of \r the \r Kivars \r malware \r is \r dropped \r from \r this \r exploitation \r into \r the\nAppData/Local/Temp \r directory \r with \r a \r .tmp \r file \r extension. \r The \r bait/distraction \r document \r displayed \r is \r very\nsimilar \r to \r the \r document \r observed \r in \r the \r previously \r discussed \r Kivars \r sample:\n\n20 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r RTF \r file \r contains \r the \r following \r metadata:\n\nThe \r date \r of \r 12/30/2015 \r is \r fairly \r close \r to \r the \r timeframe \r observed \r within\nother \r malware \r sample \r and \r spearphish \r metadata. \r The \r author \r and \r last\nmodified \r value \r is \r “xxx” \r which \r was \r not \r observed \r again \r while \r analyzing\nmalware \r samples \r for \r this \r report.\n\nTrend \r Micro \r profiled \r the \r 64-­‐bit \r version \r of \r Kivars \r in \r 2014 \r [25]. \r This \r version\nwill \r not \r execute \r in \r a \r 32-­‐bit \r environment, \r therefore \r it \r is \r possible \r that\nadditional \r targeting \r occurred \r in \r order \r to \r scope \r the \r victim \r machine.\n\nIf \r compilation \r dates \r were \r not \r faked, \r this \r sample \r was \r compiled \r back \r in \r November \r of \r 2013.\n\n**IOCs**\n\nC2: \r akm.epac[.]to\nC2: \r 103.240.203[.]232\nMD5 \r (RTF): \r ba77d50870756d247a580b8a3a56722c\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 21\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nMD5 \r (dropper): \r 1c4e3c4df094c32faf0c30f6a613c63e\nMD5 \r (payload): \r 89e4cff1496aafa0776619729a75d4ab\nMD5 \r (payload): \r f25634becd08d5298db1f3014e477e00\nSHA-­‐256 \r (RTF): \r ad251fd7427c0334f34aabe100a216b4af48b1ab4a01705f44b3421edd0be6ae\nSHA-­‐256 \r (dropper): \r f6bc895b36446d172c4a99be2587376b48fa3b1b0f6150eb8ab83f649f7b8bc6\nSHA256 \r (payload): \r 8dfcae0eb358f48fc30163e58c75823117f6fd501a48f3dfeb19a06d1c21aa51\nSHA256 \r (payload): \r f8a18e8b8e6606617e3a63ee5a3050a1b30361703c9a7d9e2d5cc94090c9907b\n\n### Targeted Exploitation #5: “Sixteen Drops of Kadam Empowerment” T9000 Keylogger \n\nThis \r document \r was \r submitted \r on \r 2015-­‐12-­‐31 \r 09:27:24 \r as \r “Sixteen \r Drops \r of \r Kadam \r Empowement.doc” \r (note\nthe \r misspelling) \r from \r India. \r This \r instance \r of \r threat \r activity \r borrows \r the \r theme \r and \r content \r from \r a \r page \r posted\nby \r the \r Central \r Tibetan \r Administration \r that \r talks \r about \r a \r spiritual \r ceremony \r undertaken \r by \r the \r Dalai \r Lama \r [26].\nIt \r is \r interesting \r to \r note \r that \r the \r threat \r actors \r wasted \r no \r time \r on \r this \r particular \r exploitation \r attempt, \r since \r the\npost \r was \r made \r on \r December \r 31 \r and \r the \r spearphish \r mail \r was \r sent \r on \r the \r same \r day.\n\n22 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nWhen \r this \r sample \r is \r opened \r and \r exploitation \r commences \r (leveraging \r CVE-­‐\n2012-­‐0158 \r and \r CVE-­‐2015-­‐1641), \r two \r files \r are \r dropped \r into \r the\nAppData/Local/Temp \r directory \r -­‐ \r ~tmp \r (decoy \r document) \r and \r E1BC.tmp\n(T9000 \r keylogger \r executable).\n\nThe \r decoy \r document \r metadata \r indicates \r that \r it \r was \r  \r created \r by \r “Windows\nUser” \r and \r last \r modified \r by \r “comma”.\n\nThe \r decoy \r document \r is \r several \r pages \r long \r but \r starts \r off \r as \r such:\n\nOpening \r the \r sample \r in \r IDA \r Pro \r helpfully \r presents \r us \r with \r a \r dialog \r box \r based \r on \r PDB \r information \r left \r inside \r the\nbinary \r that \r suggests \r the \r sample \r is \r the \r T9000 \r keylogger:\n\nThe \r PDB \r naming \r scheme \r is \r potentially \r interesting. \r Not \r only \r does \r it \r identify \r the \r software \r project \r T9000, \r but\nalso \r unique \r strings \r related \r to \r N_Inst_User_M1 \r and \r N_Inst_User32 \r and \r the \r potential \r presence \r of \r a \r directory\nfor \r release \r code. \r These \r strings \r may \r be \r helpful \r to \r discover \r other \r malware \r written \r in \r the \r same \r development\nenvironment.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 23\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nPalo \r Alto \r Unit \r 42 \r published \r an \r excellent \r document \r analyzing \r the \r T9000 \r malware \r [27] \r  \r that \r discusses \r various\nPDB \r paths, \r command \r structure, \r the \r modular \r nature \r of \r the \r malware, \r and \r more. \r  \r The \r C2 \r observed \r being \r used\nby \r this \r sample \r is \r the \r same \r C2 \r discussed \r in \r their \r article, \r however \r the \r malware \r they \r profiled \r uses \r TCP/8080,\nand \r the \r observed \r activity \r herein \r uses \r TCP/7386 \r (based \r on \r static \r analysis).\n\nWithin \r the \r analysis \r environment, \r the \r first \r stage \r T9000 \r file \r is \r dropped \r in \r AppData/Local/Temp \r using \r an\napparently \r randomized \r name, \r AFBA.tmp.\n\nThis \r particular \r compromise \r creates \r all \r of \r the \r expected \r files \r in \r the \r /Intel \r directory \r as \r profiled \r by \r Unit \r 42:\n\nAvinfo ResN32.dll\nhccutils.dll tyeu.dat\nhccutils.inf vnkd.dat\nhjwe.dat ResN32.dat\nqhnj.dat igfxtray.exe\nQQMgr.dll Data/dtl.dat\nQQMgr.inf Data/glp.uin\n\nAnother \r file \r not \r mentioned \r in \r the \r Palo \r Alto \r report, \r named \r Elevate.dll, \r was \r dropped \r in \r the \r Intel \r directory \r and\nappears \r to \r be \r involved \r in \r using \r sysprep.exe \r to \r execute \r a \r custom \r DLL \r to \r elevate \r privileges \r to \r Administrator.\nThis \r is \r part \r of \r a \r known \r style \r of \r privilege \r escalation \r that \r has \r been \r used \r by \r PlugX \r [28] \r in \r the \r past. \r General\ninformation \r about \r the \r technique, \r which \r has \r been \r known \r by \r pentesters \r for \r years, \r can \r be \r found \r at \r [29]. \r The\nhash \r for \r Elevate.DLL \r was \r first \r observed \r by \r Virus \r Total \r on \r November \r 25, \r 2015. \r Please \r note \r that \r the \r file\nigfxtray.exe \r (SHA-­‐256 \r hash \r 21a5818822a0b2d52a068d1e3339ed4c767f4d83b081bf17b837e9b6e112ee61) \r is \r a\nlegitimate \r file \r and \r simply \r used \r for \r sideloading \r of \r the \r malicious \r content.\n\n**IOC’s**\n\nC2 \r IP: \r 198.55.120[.]143:7386\nURL: \r http://198.55.120[.]143:7386/B/ResN32.dll\nMD5 \r (RTF): \r fdb6543bfb77aa6ddff0f4dfe07e442f\nMD5 \r (T9000 \r main \r binary): \r d8d70851641efbdfce8d561e6b1a2f29\nMD5 \r (Elevate.dll): \r 1d335f6a58cb9fab503a9b9cb371f57b\nMD5 \r (QQMgr.dll): \r b9c584c7c34d14599de8cd3b72f2074b\nMD5 \r (QQMgr.inf): \r 8ac933be588f49560179c26ddbc6a753\nMD5 \r (ResN32.dat): \r 50753c28878ce10a748fbd7b831ecbe1\nMD5 \r (ResN32.dll): \r a45e5c32fc2bc7be9d6e4bba8b2807bf\nMD5 \r (hccutils.dll): \r 2299fb8268f47294eb2b18282540a955\nMD5 \r (hccutils.inf): \r 2f31ef1a8fca047ed0d623010d569857\nMD5 \r (hjwe.dat): \r d3601a5160b8d122261989d147221eb7\nMD5 \r (qhnj.dat): \r a9de62186cb8d0e23b0dc75e1ae373ac\n\n24 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n|Avinfo hccutils.dll hccutils.inf hjwe.dat qhnj.dat QQMgr.dll QQMgr.inf|ResN32.dll tyeu.dat vnkd.dat ResN32.dat igfxtray.exe Data/dtl.dat Data/glp.uin|\n|---|---|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nMD5 \r (tyeu.dat): \r 29ec20f5fa1817dc9250c434e61420ea\nMD5 \r (vnkd.dat): \r 35f4ce864c3a3dc016fea3459d6402a9\nSHA-­‐256 \r (RTF): \r 8e4de6fb35ce4cd47e06b48fb86b7da3eba02031cfd8ae714e25f8f7903f0141\nSHA-­‐256 \r (T9000 \r main \r binary): \r 7c04286734718300e2c0691be9b6622f2d2525ca07ab27102a424af6f8cc3aec\nSHA-­‐256 \r (Elevate.dll): \r 9c23febc49c7b17387767844356d38d5578727ee1150956164883cf555fe7f95\nSHA-­‐256 \r (QQMgr.dll): \r bf1b00b7430899d33795ef3405142e880ef8dcbda8aab0b19d80875a14ed852f\nSHA-­‐256 \r (QQMgr.inf): \r ace7e3535f2f1fe32e693920a9f411eea21682c87a8e6661d3b67330cd221a2a\nSHA-­‐256 \r (ResN32.dat): \r 5b90fa081e3ac29a7339995f9b087dab9981409ff62e3215eb558908c6b96b14\nSHA-­‐256 \r (ResN32.dll): \r 1cea4e49bd785378d8beb863bb8eb662042dffd18c85b8c14c74a0367071d9a7\nSHA-­‐256 \r (hccutils.dll): \r 3dfc94605daf51ebd7bbccbb3a9049999f8d555db0999a6a7e6265a7e458cab9\nSHA-­‐256 \r (hccutils.inf): \r f05cd0353817bf6c2cab396181464c31c352d6dea07e2d688def261dd6542b27\nSHA-­‐256 \r (hjwe.dat): \r bb73261072d2ef220b8f87c6bb7488ad2da736790898d61f33a5fb7747abf48b\nSHA-­‐256 \r (qhnj.dat): \r c61dbc7b51caab1d0353cbba9a8f51f65ef167459277c1c16f15eb6c7025cfe3\nSHA-­‐256 \r (tyeu.dat): \r e52b5ed63719a2798314a9c49c42c0ed4eb22a1ac4a2ad30e8bfc899edcea926\nSHA-­‐256 \r (vnkd.dat): \r c22b40db7f9f8ebdbde4e5fc3a44e15449f75c40830c88932f9abd541cc78465\n\n**Connections to Historical and Ongoing Threat Campaign Activity**\n\nThe \r sample \r contains \r the \r following \r string: \r http://198.55.120[.]143:7386/B/ResN32.dll, \r which \r can \r be \r used \r to\npivot \r and \r find \r other \r samples. \r In \r this \r case, \r we \r find \r another \r document \r entitled \r “One \r Tibetan \r Protester \r is \r Freed,\nTwo \r Others \r Are \r Jailed.doc” \r using \r the \r same \r HTTP \r site \r information. \r That \r particular \r sample \r is \r also \r profiled \r in \r this\nreport.\n\n### Targeted Exploitation #6: T9000 Keylogger\n\nThis \r document \r exploits \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856 \r and \r CVE-­‐2015-­‐1641 \r and \r drops \r an \r instance \r of \r the\nT9000 \r keylogger \r malware. \r The \r spearphish \r message \r is \r not \r available \r in \r this \r case, \r however \r the \r instance \r of \r the\nT9000 \r malware \r itself \r is \r the \r same \r as \r profiled \r in \r Targeted \r Exploitation \r #5. \r The \r only \r document \r that \r is \r distinct\nbetween \r incident \r #5 \r and \r incident \r #6 \r is \r the \r original \r RTF \r file. \r For \r all \r other \r artifacts, \r please \r refer \r to \r the \r IOC \r table\nin \r Targeted \r Exploitation \r #5.\n\n**IOCs**\n\nMD5 \r (RTF): \r fb1e8c42d11e3a2de97814e451ee3375\nSHA-­‐256 \r (RTF): \r d5fa43be20aa94baf1737289c5034e2235f1393890fb6f4e8d4104565be52d8c\n\n### Targeted Exploitation #7: T9000, Chinese Exchange Program Bait File\n\nThis \r document \r exploits \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856 \r and \r CVE-­‐2015-­‐1641 \r and \r drops \r an \r instance \r of \r the\nT9000 \r keylogger \r malware. \r  \r The \r bait \r file \r for \r this \r instance \r of \r T9000 \r involves \r an \r exchange \r program. \r The \r Chinese\ndocument \r and \r a \r rough \r English \r translation \r are \r as \r follows:\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 25\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r bait \r file \r shows \r the \r author \r of \r “HBWBEI” \r and \r last \r modified \r by \r “jack”. \r Office \r metadata \r suggests \r that \r the \r file\nwas \r created \r on \r March \r 30 \r of \r 2011, \r and \r last \r printed \r on \r April \r 3, \r 2008. \r We \r are \r not \r sure \r how \r a \r document \r could \r be\nprinted \r before \r it \r is \r created. \r Perhaps \r the \r threat \r actors \r have \r learned \r to \r time \r travel, \r or \r these \r values \r are \r crafted.\nIn \r any \r event, \r the \r last \r modified \r date \r has \r a \r correspondence \r with \r threat \r activity \r in \r this \r case.\n\nThe \r T9000 \r behavior \r in \r this \r sample \r was \r different \r from \r other \r samples\nin \r that \r the \r Intel \r folder \r only \r contained \r a \r small \r amount \r of \r files, \r for\nunknown \r reasons. \r In \r this \r case, \r the \r Intel \r folder \r only \r contains \r hjwe.dat\n(the \r “encrypted \r core \r of \r the \r malware \r family”, \r as \r discovered \r by \r Palo\nAlto \r Networks), \r ~1 \r (“debug \r information \r about \r files \r used \r by\nmalware”) \r and \r a \r “Data” \r folder \r containing \r dtl.dat \r (encrypted \r config)\nand \r glp.uin \r (plugin \r configuration) \r files. \r  \r File \r hash \r values \r for \r these \r files\nmatch \r what \r was \r previously \r documented \r in \r targeted \r exploitation\nincident \r #5.\n\n26 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n|Col1|Col2|\n|---|---|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n**IOC’s**\n\nC2: \r 198.55.120[.]143 \r TCP/7386 \r and/or \r TCP/8080\nMD5 \r (RTF): \r da97c88858214242374f27d32e27d957\nMD5 \r (E804.tmp): \r e4e8493898d94f737ff4dc8fab743a4a\nMD5 \r (bait \r file): \r 9ae498307da6c2e677a97a458bff1aea\nSHA-­‐256 \r (RTF): \r 647b443ecaa38d2834e5681f20540fa84a5cf2b7e1bee6a2524ce59783cb8d1b\nSHA-­‐256 \r (E804.tmp: \r 5f3d0a319ecc875cc64a40a34d2283cb329abcf79ad02f487fbfd6bef153943c\nSHA-­‐256 \r (bait \r file): \r 4f1784a4e4181b4c80f8d77675a267cbdd0e35ea1756c9fdb82294251bef1d28\n\n**Connections to Historical and Ongoing Threat Campaign Activity**\n\nObservation \r of \r the \r sample \r suggests \r that \r the \r C2 \r is \r 198.55.120[.]143 \r on \r TCP/7386. \r This \r IP \r and \r port \r was\nobserved \r in \r two \r other \r samples \r in \r this \r campaign/engagement. \r Automated \r analysis \r of \r the \r configuration \r itself\nsuggests \r that \r the \r C2 \r port \r is \r TCP/8080 \r however. \r Further \r investigation \r is \r required \r to \r determine \r the \r reason \r for\nthe \r discrepancy. \r Connecting \r to \r TCP/8080 \r of \r this \r C2 \r with \r a \r browser \r results \r in \r the \r download \r of \r a \r file \r called\n“download” \r with \r an \r MD5 \r hash \r of \r e1269c22ad1e057b9c91523498b4b04d \r and \r a \r SHA-­‐256 \r hash \r of\nb9914fb8c645e0c41d497db303c1ffa594da709686252fccb8d28dffac86275b. \r This \r file \r is \r delivered \r to \r the \r user\nafter \r the \r user \r presents \r an \r HTTP \r GET. \r Connecting \r to \r this \r port \r with \r telnet \r and \r manually \r issuing \r a \r GET \r results \r in\nthe \r delivery \r of \r nine \r bytes \r from \r the \r server. \r The \r server \r then \r appears \r to \r wait \r for \r a \r response. \r These \r nine \r bytes\ncontain \r the \r ASCII \r text \r “eueuX_”. \r There \r are \r unprintable \r characters \r present \r however, \r including \r 0x05, \r 0x1b, \r and\n0x12 \r as \r seen \r in \r this \r hexdump:\n\n65 \r 75 \r 65 \r 75 \r 05 \r 1b \r 12 \r 58 \r  \r 5f \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r  \r |eueu...X_|\n\nThe \r same \r GET \r connection \r used \r on \r TCP/8080 \r can \r also \r be \r used \r on \r 8088/tcp \r and \r 8089/tcp \r on \r this \r particular \r C2\nto \r obtain \r the \r same \r response \r consisting \r of \r the \r exact \r same \r sequence \r of \r bytes. \r It \r is \r possible \r that \r this \r server \r is\nconfigured \r to \r support \r multiple \r campaigns, \r multiple \r actor \r groups, \r or \r there \r may \r be \r some \r other \r explanation.\n\nAwareness \r of \r this \r responsive \r pattern \r could \r provide \r for \r a \r potentially \r useful \r method \r to \r fingerprint \r a \r T9000 \r C2.\nThis \r communication \r pattern \r has \r been \r observed \r in \r the \r wild \r at \r least \r as \r far \r back \r as \r 2014-­‐03-­‐25 \r 21:06:19 \r UTC,\nwhen \r someone \r submitted \r a \r sample \r of \r this \r byte \r sequence \r  \r to \r Virus \r Total \r (MD5:\ne1269c22ad1e057b9c91523498b4b04d).\n\nThis \r C2 \r IP \r address \r is \r clearly \r of \r interest \r since \r it \r has \r been \r used \r by \r several \r samples \r uncovered \r in \r this\nengagement. \r Some \r basic \r analysis \r of \r the \r C2 \r reveals \r the \r following \r open \r ports \r (filtered \r ports \r have \r been \r removed\nfrom \r this \r list). \r The \r ports \r in \r bold \r appear \r to \r be \r associated \r the \r server-­‐side \r component \r of \r T9000 \r in \r this \r instance:\n\n**PORT** **STATE** **SERVICE**\n80/tcp open http\n554/tcp open rtsp\n1028/tcp open unknown\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 27\n\n|PORT|STATE|SERVICE|\n|---|---|---|\n|80/tcp|open|http|\n|554/tcp|open|rtsp|\n|1028/tcp|open|unknown|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n1433/tcp open ms-­‐sql-­‐s\n3389/tcp open ms-­‐wbt-­‐server\n7070/tcp open realserver\n**8080/tcp** **open** **http-­‐proxy**\n**8088/tcp** **open** **radan-­‐http**\n**8089/tcp** **open** **unknown**\n9000/tcp open cslistener\n22779/tcp open unknown\n22790/tcp open unknown\n47001/tcp open unknown\n\nConnecting \r to \r the \r Remote \r Desktop \r port \r on \r the \r server \r gives \r us \r a \r sense \r of \r the \r language \r in \r use \r on \r the \r server.\n\n### Targeted Exploitation #8: T9000 – Tibetan Protester Theme\n\nThe \r malicious \r RTF \r file, \r using \r the \r name \r “One \r Tibetan \r Protester \r is \r Freed, \r Two \r Others \r Are \r Jailed.doc” \r was \r first\nobserved \r in \r the \r wild \r on \r 2015-­‐12-­‐31 \r 05:34:17 \r and \r submitted \r for \r analysis \r to \r Virus \r Total \r from \r India. \r The \r RTF\ndocument \r exploits \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856 \r and \r CVE-­‐2015-­‐1641. \r This \r document \r has \r been \r determined\nto \r drop \r the \r T9000 \r backdoor \r malware \r based \r on \r the \r presence \r of \r a \r URL \r pointing \r to \r the \r previously \r discovered\nT9000 \r C2 \r string \r (http://198.55.120[.]143:7386/B/ResN32.dll). \r The \r insightful \r T9000 \r report \r from \r Palo \r Alto\nNetworks \r describes \r this \r ResN32.dll \r file \r as \r a \r “Malicious \r DLL. \r Decrypts, \r decompresses, \r and \r loads \r core \r malware”.\nOther \r obvious \r strings \r are \r present \r such \r as \r the \r PDB \r string\n\"D:\\WORK\\T9000\\N_Inst_User_M1\\Release\\N_Inst_User32.pdb\" \r and \r many \r other \r clear \r T9000 \r artifacts.\n\nWith \r regards \r to \r the \r bait \r file \r “One \r Tibetan \r Protester \r is \r Freed, \r Two \r Others \r Are \r Jailed.doc”, \r we \r can \r see \r that \r it\nwas \r copied \r from \r a \r website. \r A \r news \r item \r from \r December \r 4, \r 2015 \r was \r posted \r on \r Radio \r Free \r Asia \r [30] \r using \r this\nexact \r Tibetan \r Protester \r document \r title. \r The \r webpage \r from \r Radio \r Free \r Asia \r is \r seen \r on \r the \r left \r below \r and \r the\nbait \r file \r that \r appears \r to \r have \r been \r built \r from \r the \r website \r is \r on \r the \r right.\n\n28 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n|1433/tcp|open|ms-­‐sql-­‐s|\n|---|---|---|\n|3389/tcp|open|ms-­‐wbt-­‐server|\n|7070/tcp|open|realserver|\n|8080/tcp|open|http-­‐proxy|\n|8088/tcp|open|radan-­‐http|\n|8089/tcp|open|unknown|\n|9000/tcp|open|cslistener|\n|22779/tcp|open|unknown|\n|22790/tcp|open|unknown|\n|47001/tcp|open|unknown|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r bait \r file \r document \r metadata \r indicates \r that \r it \r was \r created \r and \r modified \r by\n“HighSea” \r on \r 12/31/2015, \r the \r same \r day \r that \r the \r file \r was \r uploaded \r to \r Virus\nTotal \r and \r the \r same \r day \r other \r threat \r activity \r was \r observed \r against \r the \r Tibetan\ncommunity. \r The \r name \r “HighSea” \r appears \r in \r other \r malicious \r document\nmetadata \r profiled \r within \r this \r report.\n\n**IOC’s**\n\nC2: \r 198.55.120[.]143 \r tcp/7386\nMD5 \r (malicious \r RTF): \r facd2fbf26e974bdeae3e4db19753f03\nMD5 \r (T9000, \r BC29.tmp): \r e4e8493898d94f737ff4dc8fab743a4a\nBait \r filename \r (~tmp.doc): \r One \r Tibetan \r Protester \r is \r Freed, \r Two \r Others \r Are \r Jailed.doc\nMD5 \r (~tmp.doc): \r 751196ce79dacd906eec9b5a1c92890b\nSHA-­‐256: \r (malicious \r RTF): \r 1140e06fa8580cf869744b01cc037c2d2d2b5af7f26f5b3448d9a536674d681c\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 29\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nSHA-­‐256 \r (T9000, \r BC29.tmp): \r  \r 5f3d0a319ecc875cc64a40a34d2283cb329abcf79ad02f487fbfd6bef153943c\nSHA-­‐256 \r (~tmp.doc): \r 76d54a0c8ed8d9a0b02f52d2400c8e74a9473e9bc92aeb558b2f4c894da1b88f\n\n**Connections to Historical and Ongoing Threat Campaign Activity**\n\nThis \r sample \r uses \r the \r same \r C2 \r that \r has \r been \r observed \r in \r the \r other \r T9000 \r samples \r analyzed \r herein. \r Targeted\nExploitation \r #7 \r incident \r in \r this \r report \r features \r some \r assessment \r of \r the \r C2 \r itself \r to \r determine \r additional\ninformation \r about \r the \r actors \r and \r to \r generate \r other \r IOCs.\n\n### Targeted Exploitation #9: Agent.XST and other malware\n\nThis \r RTF \r document, \r exploiting \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856 \r and \r CVE-­‐2015-­‐1641, \r was \r observed \r using \r the\nname \r 2016 總統選舉民情中心預測值.doc, \r which \r roughly \r translates \r in \r English \r to \r “Prediction \r of \r the \r 2016\npresidential \r election \r people \r center \r value.Doc”. \r  \r First \r submitted \r from \r the \r USA \r on \r 1/7/2016 \r to \r Virus \r Total.\n\nThe \r bait \r file \r in \r use \r contains \r the \r following \r text:\n\nA \r rough \r translation \r to \r English \r reveals \r election \r related \r content:\n\nOffice \r file \r metadata \r indicates \r when \r the \r document \r was \r created \r (1/6/2016\n5:41 \r PM) \r and \r a \r less \r than \r helpful \r value \r of \r “User” \r for \r the \r author.\n\n30 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nA \r batch \r file \r dropped \r by \r the \r malware, \r named \r wget.bat, \r contains \r the \r following \r PowerShell \r code:\n\nThe \r Powershell \r code \r runs \r a \r minimized \r instance \r of \r wget.exe \r (also \r dropped \r by \r the \r malware) \r and \r attempts \r to\nobtain \r a \r file \r named \r wthk.txt \r from \r a \r server \r in \r Taiwan, \r which \r is \r then \r stored \r as \r whtk.exe \r locally.\n\nIn \r this \r case, \r the \r wthk.txt \r file \r was \r no \r longer \r available \r on \r the \r download \r site\n(www.kcico.com[.]tw/data/openwebmail/doc/wthk.txt) \r but \r was \r obtained \r through \r other \r means. \r The \r file\nwthk.txt \r is \r the \r same \r malware \r family \r (Sample \r #3) \r discussed \r in \r the \r “Uncovering \r the \r Seven \r Pointed \r Dagger”\npaper \r (referred \r to \r as \r “7PD”). \r In \r the \r case \r of \r 7PD, \r this \r malware \r (appears \r to \r be \r a \r keylogger) \r was \r originally \r stored\ninside \r a \r file \r named \r Security-­‐Patch-­‐Update333.rar. \r Readers \r are \r encouraged \r to \r refer \r to \r the \r 7PD \r paper \r at\nhttp://www.arbornetworks.com/blog/asert/wp-­‐content/uploads/2016/01/ASERT-­‐Threat-­‐Intelligence-­‐Brief2015-­‐08-­‐Uncovering-­‐the-­‐Seven-­‐Point-­‐Dagger.pdf for \r full \r details.\n\nExecution \r of \r the \r malware \r results \r in \r the \r creation \r of \r suspicious \r network \r traffic. \r The \r initial \r connection \r to \r the \r C2\ntriggers \r an \r Emerging \r Threats \r signature \r “ET \r TROJAN \r Win32/Agent.XST \r Checkin”:\n```\nalert http $HOME_NET any -> $EXTERNAL_NET any (msg:\"ET TROJAN Win32/Agent.XST Checkin\";\nflow:established,to_server; content:\"POST\"; http_method; content:!\"Referer|3a|\";\nhttp_header; content:!\"Accept|3a|\"; http_header; content:\"Content-Type|3a 20|text/html|0d\n0a|\"; http_header; content:\"this is UP\"; depth:10; http_client_body; fast_pattern;\ncontent:\"|00 00 00 00|\"; http_client_body;\nreference:md5,d579d7a42ff140952da57264614c37bc; reference:url,asert.arbornetworks.com/wpcontent/uploads/2016/01/ASERT-Threat-Intelligence-Brief-Uncovering-the-Seven-PointedDagger.pdf; classtype:trojan-activity; sid:2022362; rev:2;)\n\n```\nThe \r keep-­‐alive \r packet \r generated \r from \r the \r compromised \r host \r to \r the \r C2 \r triggers \r the \r Emerging \r Threats\nsignature \r “ET \r TROJAN \r Win32/Agent.XST \r Keepalive”:\n```\nalert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"ET TROJAN Win32/Agent.XST Keepalive\";\nflow:established,to_server; content:\"POST|20|\"; depth:5; content:\".asp|20|HTTP/1.\";\ndistance:0; content:!\"Referer|3a|\"; distance:0; content:!\"Accept|3a|\"; distance:0;\ncontent:\"Content-Length|3a 20|2|0d 0a|\"; distance:0; fast_pattern; content:\"ContentType|3a 20|text/html|0d 0a|\"; content:\"|0d 0a 0d 0a|ok\"; distance:0; threshold: type\nlimit, count 1, seconds 60, track by_src; reference:md5,d579d7a42ff140952da57264614c37bc;\nreference:url,asert.arbornetworks.com/wp-content/uploads/2016/01/ASERT-ThreatIntelligence-Brief-Uncovering-the-Seven-Pointed-Dagger.pdf; classtype:trojan-activity;\nsid:2022363; rev:2;)\n\n```\nThe \r malware \r activity \r from \r this \r sample \r is \r very \r similar \r to \r the \r sample \r discussed \r in \r 7PD. \r Since \r new \r findings \r are\navailable \r and \r this \r family \r has \r not \r been \r profiled \r with \r much \r depth, \r the \r details \r are \r as \r follows:\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 31\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n- MD5 \r (wthk.txt) \r = \r d579d7a42ff140952da57264614c37bc \r (First \r seen \r on \r Virus \r Total \r 2016-­‐01-­‐08)\n\n     - Wthk.txt \r is \r a \r binary \r signed \r by \r Binzhoushi \r Yongyu \r Feed \r Co.,LTd\n\n          - The \r certificate \r was \r valid \r from \r 1/17/2014 \r – \r 1/18/2016. \r These \r valid \r dates \r are \r exactly \r one \r day\nafter \r the \r valid \r dates \r for \r the \r certificate \r used \r in \r aforementioned \r sample \r #3, \r which \r was \r valid\nfrom \r 1/16/2014 \r – \r 1/17/2016.\n\n     - Execution \r of \r this \r malware \r creates \r an \r “Internet \r Explorer” \r folder \r that \r contains \r the \r following \r files:\n\n          - MD5 \r (conhost.exe) \r = \r f70b295c6a5121b918682310ce0c2165 \r (same \r binary \r as \r 7PD \r sample)\n\n               - Appears \r to \r be \r a \r legit \r SandboxIE \r file, \r originally \r named \r SandboxieBITS.exe \r that \r is\nsigned \r by \r SANDBOXIE \r L.T.D. \r  \r ASERT \r has \r five \r instances \r of \r this \r file \r being \r used \r in\nmalware \r operations. \r Additionally, \r analysis \r of \r the \r files \r PEHash\n(ffb7a38174aab4744cc4a509e34800aee9be8e57) \r reveals \r 15 \r instances \r of \r the \r same\nor \r slightly \r modified \r file \r being \r used \r in \r various \r PlugX \r operations \r since \r at \r least \r 2013.\nThis \r file \r imports \r functions \r from \r SBIeDll.dll.\n\n          - MD5 \r (SBieDll.dll) \r = \r f80edbb0fcfe7cec17592f61a06e4df2\n\n               - This \r DLL \r exports \r SbieApi_Log, \r SbieDLL_Hook(x,x,x) \r and \r DllEntryPoint.\n\n               - This \r DLL \r file \r is \r sideloaded \r by \r conhost.exe, \r which \r imports \r SbieApi_Log.\n\n               - The \r file \r maindll.dll \r is \r loaded \r via \r LoadLibaryW.\n\n               - The \r sample \r checks \r for \r the \r presence \r of \r a \r mutex \r \"EDD4DB6D-­‐E8E0-­‐42ae-­‐A47B-­‐\n021DC227E2FA\" \r with \r OpenMutexW \r and \r does \r not \r load \r maindll.dll \r if \r the \r mutex \r is\nalready \r set.\n\n               - If \r maindll.dll \r is \r loaded \r successfully, \r then \r a \r string \r “load \r maindll \r ok” \r is \r pushed \r to \r the\nstack, \r followed \r by \r a \r call \r to \r GetProcAddress \r for \r the \r process \r name \r sbie_info. \r If \r this \r is\nsuccessful, \r then \r another \r string \r “get \r work \r fun \r ok” \r is \r pushed \r to \r the \r stack. \r If \r this \r is \r not\nsuccessful \r then \r the \r string \r “get \r work \r fun \r error” \r is \r instead \r pushed \r to \r the \r stack.\n\n               - This \r file \r contains \r the \r PDB \r string \r “Y:/UDPSbieDLL/Release/SBieDLL.pdb”.\n\n               - Unlike \r the \r previously \r observed \r version \r of \r this \r file \r mentioned \r in \r 7PD, \r this \r particular\nsample \r does \r not \r appear \r to \r be \r packed \r or \r otherwise \r obfuscated.\n\n          - MD5 \r (dll2.xor): \r ce8ec932be16b69ffa06626b3b423395\n\n               - Based \r upon \r the \r filename, \r this \r may \r be \r an \r XOR-­‐ed \r DLL \r file. \r Additional \r analysis \r is\nongoing.\n\n          - MD5 \r (maindll.dll): \r d8ede9e6c3a1a30398b0b98130ee3b38\n\n               - This \r binary \r is \r obfuscated, \r likely \r with \r ASPack \r v2.12, \r and \r requires \r further \r analysis.\n\n               - The \r compilation \r date \r on \r this \r binary \r is \r 0x54A93AD9 \r (Sun \r Jan \r 04 \r 07:06:33 \r 2015)\n\n          - MD5 \r (nvsvc.exe) \r = \r e0eb981ad6be0bd16246d5d442028687\n\n               - This \r file \r uses \r Microsoft \r Foundation \r Classes \r (MFC) \r and \r is \r signed \r by \r Square \r Network\nTech \r Co.,LTD \r from \r the \r city \r of \r Zhongshan, \r Guangdong \r province, \r China \r on \r November\n12, \r 2014 \r at \r 9:01:58 \r PM \r (CN \r = \r Square \r Network \r Tech \r Co.,LTD \r (O \r = \r Square \r Network\nTech \r Co.,LTD. \r L \r = \r Zhongshan, \r S \r = \r Guangdong, \r C \r = \r CN). \r The \r digital \r signature \r contains\nan \r attribute \r field \r 1.3.6.1.4.1.311.2.1.12 \r that \r lists \r the \r string \r “Microsoft \r Windows\nShell \r explorer \r https:www.trustasia.com” \r and \r was \r valid \r from \r Feb \r 21, \r 2014 \r – \r Feb \r 22,\n2015. \r Trustasia.com \r is \r a \r digital \r certificate \r provider \r in \r Shanghai, \r China.\n\n               - File \r references \r conhost.exe, \r dll2.xor, \r maindll.dll, \r SbieDll.dll, \r HOOK.DLL, \r and \r itself.\n\n32 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n          - MD5 \r (runas.exe) \r = \r 6a541de84074a2c4ff99eb43252d9030\n\n               - This \r file \r contains \r a \r jump \r table \r with \r 7 \r cases, \r each \r leading \r to \r one \r of \r the \r five \r files\ndropped \r by \r the \r malware, \r with \r two \r additional \r files \r referenced \r that \r are \r not \r present:\nHOOK.DLL \r and \r mon.\n\nWhile \r a \r full \r analysis \r is \r still \r in \r process, \r some \r interesting \r elements \r from \r the \r aforementioned \r files \r include \r the\npresence \r of \r several \r resources \r inside \r the \r nvsvc.exe \r file. \r Resource \r 100 \r appears \r on \r the \r left, \r and \r resource \r 102 \r on\nthe \r right. \r These \r may \r be \r default \r resources \r for \r some \r application, \r however \r their \r presence \r may \r be \r an \r indicator.\n\nThe \r SbIEDll.dll \r file \r uses \r a \r tactic \r similar \r to \r what \r was \r used \r in \r an \r older \r instance \r of \r PlugX \r whereby \r a \r fake \r exported\nfunction \r is \r used \r [31]. \r While \r both \r a \r legitimate \r instance \r of \r SbieDll.DLL \r and \r this \r malicious \r version \r have \r an \r export\naddress \r table \r entry \r for \r SbieApi_Log, \r the \r malicious \r version \r implements \r a \r function \r that \r basically \r does \r nothing\nother \r than \r setting \r the \r EAX \r register \r to \r 1. \r A \r legitimate \r instance \r of \r the \r function \r is \r displayed \r on \r the \r left, \r while \r the\nmalicious \r DLL’s \r instance \r of \r the \r function \r is \r displayed \r on \r the \r right.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 33\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nOnce \r the \r wthk.txt \r file \r is \r downloaded \r by \r PowerShell, \r the \r dropped \r file \r fuso.exe \r is \r executed.\n\nThe \r binary \r named \r fuso.exe \r is \r a \r very \r simple \r binary \r that \r appears \r to \r execute \r another \r application \r named\nKeyainst.exe:\n\nUnfortunately, \r Keyainst.exe \r was \r not \r available \r during \r this \r analysis.\n\n**Connections to Historical and Ongoing Threat Campaign Activity**\n\nA \r recently \r published \r (March \r 17, \r 2016) \r blog \r by \r Michael \r Yip \r of \r PWC \r “Taiwan \r Presidential \r Election: \r A \r Case \r Study\non \r Thematic \r Targeting” \r [32] \r also \r discusses \r aspects \r of \r this \r sample \r and \r reveals \r that \r it \r was \r used \r in \r targeted\n\n34 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nexploitation \r attempts \r upon \r a \r Hong \r Kong \r activist \r and \r a \r politician. \r In \r this \r case, \r malware \r being \r called\n“SunOrcal”and \r Surtr \r were \r involving \r in \r using \r the \r same \r URL \r path \r for \r the \r malware \r download \r observed \r here\n(www.kcico.com[.]tw/data/openwebmail/doc/wthk.txt) \r and \r pivots \r from \r these \r samples \r revealed \r connections\nto \r activity \r as \r early \r as \r 2010 \r associated \r with \r the \r targeting \r of \r Tibet \r and \r Hong \r Kong.\n\nPivoting \r on \r the \r mutex \r checked \r by \r the \r SbIEDll.dll \r binary \r results \r in \r the \r discovery \r of \r malware \r analyzed \r in \r 2013\n(MD5: \r 983333e2c878a62d95747c36748198f0) \r using \r the \r filename \r “中国国家安全委员会机构设置和人员名\n单提前曝光.docx” \r which \r roughly \r translates \r to \r “List \r of \r Chinese \r National \r Security \r Council \r staff \r early \r exposure\nsettings \r and \r .docx” \r that \r is \r using \r exploit \r code \r for \r CVE-­‐2013-­‐3906. \r Additional \r pivots \r can \r provide \r other \r insight.\n\nThe \r C2 \r is \r 59.188.12[.]123 \r TCP/8008, \r located \r in \r Hong \r Kong. \r Passive \r DNS \r reveals \r that \r this \r IP \r address \r has \r been\nused \r by \r the \r dynamic \r DNS \r domain \r yeaton.xicp[.]net \r from \r 2016-­‐01-­‐08 \r 23:50:44 \r until \r at \r least \r 2016-­‐03-­‐30\n(resolution \r appears \r to \r be \r ongoing). \r In \r 2012 \r forum \r posts, \r the \r domain \r yeaton.xicp[.]net \r was \r used \r in \r advertising\nfor \r a \r VPN \r service \r in \r China \r that \r claims \r to \r be \r able \r to \r bypass \r the \r great \r firewall. \r While \r 2012 \r is \r a \r long \r time \r ago, \r it \r is\npossible \r that \r the \r threat \r actor \r is \r using \r a \r VPN \r service.\n\n**IOC’s**\n\nC2: \r 59.188.12[.]123 \r TCP/8008\nMD5 \r (RTF): \r 09ddd70517cb48a46d9f93644b29c72f\nMD5 \r (~tmp.doc): \r e6ad959a18725954a56a7954d3f47671\nMD5 \r (RAR): \r d8becbd6f188e3fb2c4d23a2d36d137b\nMD5 \r (iuso.exe): \r 07eb4867e436bbef759a9877402af994\nMD5 \r (wget.bat): \r 47e60e347b5791d5f17939f9c97fee01\nMD5 \r (wget.exe): \r f9f8d1c53d312f17c6f830e7b4e6651d\nMD5 \r (wthk.txt): \r d579d7a42ff140952da57264614c37bc\nMD5 \r (conhost.exe): \r f70b295c6a5121b918682310ce0c2165\nMD5 \r (SBieDll.dll): \r f80edbb0fcfe7cec17592f61a06e4df2\nMD5 \r (dll2.xor): \r ce8ec932be16b69ffa06626b3b423395\nMD5 \r (maindll.dll): \r d8ede9e6c3a1a30398b0b98130ee3b38\nMD5 \r (nvsvc.exe): \r e0eb981ad6be0bd16246d5d442028687\nMD5 \r (runas.exe): \r 6a541de84074a2c4ff99eb43252d9030\nSHA-­‐256 \r (RTF): \r 41d05788d844b59f8eb79aeb2060dd5b7bdcad01e8d720f4b8b80d552e41cfe2\nSHA-­‐256: \r (~tmp.doc): \r f0b5336b6f890e2029ac242ad2b613cad535828f7b7004a2284683f3195b7616\nSHA-­‐256 \r (RAR): \r ddc05b9f39f579f64742980980ca9820b83a243889bbc5baa37f5c2c1c4beb30 \r  \r 8EC7.tmp\nSHA-­‐256 \r (iuso.exe) \r cf717a646a015ee72f965488f8df2dd3c36c4714ccc755c295645fe8d150d082\nSHA-­‐256 \r (wget.bat): \r 9b6053e784c5762fdb9931f9064ba6e52c26c2d4b09efd6ff13ca87bbb33c692\nSHA-­‐256 \r (wget.exe): \r bedfbfe249b4a2be35bbfb1cf166d2119e132ee7c608909d34238e9eba6c9749\nSHA-­‐256 \r (wthk.txt): \r 5b875ecf0b7f67a4429aeaa841eddf8e6b58771e16dbdb43ad6918aa7a5b582d\nSHA-­‐256 \r (conhost.exe): \r 4849af113960f473749acf71d11d56854589cf21d623e66c7408bebd5ad0608f\nSHA-­‐256 \r (SbieDll.dll): \r 2ac69633da711f244377483d99fac53089ec6614a61d8a1492a0e7228cbb8ffd\nSHA-­‐256 \r (dll2.xor): \r  \r c3fee1c7d402f144023dade4e63dc65db42fc4d6430f9885ece6aa7fa77cade0\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 35\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nSHA-­‐256 \r (maindll.dll): \r 5838582ea26312cc60b43da555189b439d3688597a705e3a52dc4d935517f69d\nSHA-­‐256 \r (nvsvc.exe): \r ec05e37230e6534fa148b8e022f797ad0afe80f699fbd222a46672118663cf00\nSHA-­‐256 \r (runas.exe): 5b34b3365eb6a6c700b391172849a2668d66a167669018ae3b9555bc2d1e54ab\nFile \r creation: \r conhost.log\nFile \r creation: \r keylog\nFile \r creation: \r srvlic.dll\nFile \r creation: \r up.dat\nFile \r creation: \r xx1.tmp\nFile \r creation: \r xx2.tmp\nFile \r creation: \r xx3.tmp\nFile \r creation: \r xx4.tmp\nFile \r creation: \r xx5.tmp\nFile \r creation: \r xx6.tmp\n\n### Targeted Exploitation #10: PlugX, Tibetan theme\n\nThe \r original \r filename \r is \r HUMAN \r RIGHTS \r SITUATION \r IN \r TIBET.doc.\n\nThe \r bait \r file \r is \r originally \r horizontal, \r but \r has \r been \r rotated \r for \r the \r sake \r of \r readability, \r and \r consists \r of \r the \r first\ntwo \r pages \r apparently \r from \r a \r document \r published \r by \r the \r Tibetan \r Center \r for \r Human \r Rights \r and \r Democracy\ncalled \r “HUMAN \r RIGHTS \r SITUATION \r IN \r TIBET”:\n\nThe \r metadata \r for \r the \r Word \r bait \r file \r shows \r a \r February \r 2016 \r timeframe \r and \r the \r user \r “member0975”.\n\n36 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n|Col1|Col2|\n|---|---|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r PlugX \r malware \r configuration \r is \r as \r follows:\n\nAfter \r exploitation, \r a \r DNS \r query \r for \r www.whitewall[.]top; \r resolves \r to \r 118.193.240[.]195. \r Next, \r the\ncompromised \r host \r initiates \r traffic \r to \r the \r IP \r on \r UDP/8080 \r followed \r by \r traffic \r to \r UDP/995. \r  \r Extracting \r the \r URL\nfrom \r memory \r reveals \r http://www.whitewall.top[:]8080/850D3011FA326CBB6F57A965 \r and\nhttp://www.whitewall[.]top:995/5724DD3DCC4A19E8416E5691.\n\nA \r small \r (2KB) \r file \r named \r ‘skljxpikxzp’ \r (likely \r a \r random \r name) \r appeared \r on \r the \r compromised \r system \r after\nabout \r an \r hour. \r This \r file \r was \r not \r examined \r in \r depth \r and \r appears \r encoded. \r An \r instance \r of \r msiexec.exe \r appears\nto \r have \r been \r spawned \r from \r svchost.exe \r that \r is \r related \r to \r this \r file.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 37\n\n|Col1|Col2|\n|---|---|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n**IOC’s**\n\nC2: \r www.whitewall[.]top \r UDP/8080\nC2: \r www.whitewall[.]top \r UDP/995\nMD5 \r (RTF): \r ee49bd5f35cc3012b5b606aca9b0f561\nMD5 \r (fsguidll.exe): \r 2d7a648ebe64e536944c011c8dcbb375\nMD5 \r (fslapi.dll): \r 13d3d0699562a57cf575dd7f969b3141\nMD5 \r (fslapi.dll.gui): \r 894c251a3aad150f80a8af2539baf9d1\nMD5 \r (ufbidruosivibuted): \r caefdd6ca90ff791cdeff9313136972e\nMD5 \r (PlugX): \r 103873e3fa8dfc2360bb5c22761da04a\nSHA256 \r (RTF): \r 58f8a906b49711d2a6aaed0b59e1c1b7fcf5757666e0567fe50e996bfe0a4589\nSHA-­‐256 \r (fsguidll.exe): \r 5c5e3201d6343e0536b86cb4ab0831c482a304c62cd09c01ac8bdeee5755f635\nSHA-­‐256 \r (fslapi.dll): \r 2a6ef9dde178c4afe32fe676ff864162f104d85fac2439986de32366625dc083\nSHA-­‐256 \r (fslapi.dll.gui): \r dc4dac22d58ed7c0cadb13a621f42cb9a01851385ca0dc5b94a73c91677a0739\nSHA-­‐256 \r (ufbidruosivibuted): \r a78ea84acf57e0c54d5b1e5e3bd5eec31cc5935f16d9575e049e161420736e32\nSHA256 \r (PlugX): \r 40099e0f13ba47bd4ea4f3f49228ac8cffdf07700c4ef8089e3b5d8013e914a3\n\n**Connections to Historical and Ongoing Threat Campaign Activity**\n\nwww.whitewall[.]top \r resolves \r to \r 118.193.240[.]195 \r  \r at \r the \r time \r of \r this \r writing \r and \r appears \r to \r be \r hosted\nwithin \r a \r /24 \r netblock \r (ASN \r 58879) \r belonging \r to \r the \r ANCHNET \r Shanghai \r Anchang \r Network \r Security \r Technology\nCo. \r Ltd \r in \r China. \r Passive \r DNS \r reveals \r several \r recent \r resolutions \r (that \r continue \r as \r of \r this \r writing):\n\nDomain First Seen Last Seen\nwww.turkistanuyghur.top 2016-­‐03-­‐01 18:31:40 2016-­‐03-­‐18 12:30:17\nwww.yawropauyghur.top 2016-­‐03-­‐01 18:31:56 2016-­‐03-­‐18 01:30:12\nwww.whitewall.top 2016-­‐03-­‐01 18:31:49 2016-­‐03-­‐18 01:30:07\nwww.japanuyghur.top 2016-­‐03-­‐01 18:30:49 2016-­‐03-­‐18 01:29:06\nwww.hotansft.top 2016-­‐03-­‐17 01:28:56 2016-­‐03-­‐18 01:29:03\nwww.amerikauyghur.top 2016-­‐03-­‐01 01:28:05 2016-­‐03-­‐18 01:28:22\nwww.yawropauyghur.top 2016-­‐02-­‐26 18:32:50 2016-­‐03-­‐17 05:13:12\nwww.turkistanuyghur.top 2016-­‐01-­‐21 21:26:13 2016-­‐03-­‐17 05:13:11\nwww.whitewall.top 2016-­‐02-­‐18 22:00:00 2016-­‐03-­‐17 05:13:11\nwww.hotansft.top 2016-­‐02-­‐29 20:46:10 2016-­‐03-­‐17 05:13:06\nwww.japanuyghur.top 2016-­‐01-­‐19 05:37:55 2016-­‐03-­‐17 05:13:06\nwww.amerikauyghur.top 2016-­‐02-­‐17 14:49:44 2016-­‐03-­‐17 05:13:00\nwww.yawropauyghur.top 2016-­‐02-­‐27 01:29:14 2016-­‐02-­‐29 12:30:37\nwww.whitewall.top 2016-­‐02-­‐19 01:29:39 2016-­‐02-­‐29 12:30:36\nwww.turkistanuyghur.top 2016-­‐02-­‐01 01:26:48 2016-­‐02-­‐29 12:30:24\nwww.japanuyghur.top 2016-­‐02-­‐01 01:26:00 2016-­‐02-­‐29 12:29:30\nwww.amerikauyghur.top 2016-­‐02-­‐18 01:26:33 2016-­‐02-­‐29 01:27:14\nwww.yawropauyghur.top 2016-­‐02-­‐29 00:00:00 2016-­‐02-­‐29 00:00:00\nwww.whitewall.top 2016-­‐02-­‐24 00:00:00 2016-­‐02-­‐24 00:00:00\nwww.amerikauyghur.top 2016-­‐02-­‐17 00:00:00 2016-­‐02-­‐17 12:55:26\nturkiyeuyghur.com 2015-­‐12-­‐09 06:33:09 2016-­‐02-­‐16 22:49:35\n\n38 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n|Domain|First Seen|Last Seen|\n|---|---|---|\n|www.turkistanuyghur.top|2016-­‐03-­‐01 18:31:40|2016-­‐03-­‐18 12:30:17|\n|www.yawropauyghur.top|2016-­‐03-­‐01 18:31:56|2016-­‐03-­‐18 01:30:12|\n|www.whitewall.top|2016-­‐03-­‐01 18:31:49|2016-­‐03-­‐18 01:30:07|\n|www.japanuyghur.top|2016-­‐03-­‐01 18:30:49|2016-­‐03-­‐18 01:29:06|\n|www.hotansft.top|2016-­‐03-­‐17 01:28:56|2016-­‐03-­‐18 01:29:03|\n|www.amerikauyghur.top|2016-­‐03-­‐01 01:28:05|2016-­‐03-­‐18 01:28:22|\n|www.yawropauyghur.top|2016-­‐02-­‐26 18:32:50|2016-­‐03-­‐17 05:13:12|\n|www.turkistanuyghur.top|2016-­‐01-­‐21 21:26:13|2016-­‐03-­‐17 05:13:11|\n|www.whitewall.top|2016-­‐02-­‐18 22:00:00|2016-­‐03-­‐17 05:13:11|\n|www.hotansft.top|2016-­‐02-­‐29 20:46:10|2016-­‐03-­‐17 05:13:06|\n|www.japanuyghur.top|2016-­‐01-­‐19 05:37:55|2016-­‐03-­‐17 05:13:06|\n|www.amerikauyghur.top|2016-­‐02-­‐17 14:49:44|2016-­‐03-­‐17 05:13:00|\n|www.yawropauyghur.top|2016-­‐02-­‐27 01:29:14|2016-­‐02-­‐29 12:30:37|\n|www.whitewall.top|2016-­‐02-­‐19 01:29:39|2016-­‐02-­‐29 12:30:36|\n|www.turkistanuyghur.top|2016-­‐02-­‐01 01:26:48|2016-­‐02-­‐29 12:30:24|\n|www.japanuyghur.top|2016-­‐02-­‐01 01:26:00|2016-­‐02-­‐29 12:29:30|\n|www.amerikauyghur.top|2016-­‐02-­‐18 01:26:33|2016-­‐02-­‐29 01:27:14|\n|www.yawropauyghur.top|2016-­‐02-­‐29 00:00:00|2016-­‐02-­‐29 00:00:00|\n|www.whitewall.top|2016-­‐02-­‐24 00:00:00|2016-­‐02-­‐24 00:00:00|\n|www.amerikauyghur.top|2016-­‐02-­‐17 00:00:00|2016-­‐02-­‐17 12:55:26|\n|turkiyeuyghur.com|2015-­‐12-­‐09 06:33:09|2016-­‐02-­‐16 22:49:35|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nwww.turkistanuyghur.top 2016-­‐01-­‐22 01:26:09 2016-­‐01-­‐31 01:26:41\nwww.japanuyghur.top 2016-­‐01-­‐19 00:00:00 2016-­‐01-­‐31 01:25:57\nturkiyeuyghur.com 2015-­‐12-­‐08 09:59:30 2015-­‐12-­‐31 22:19:55\n\nThe \r interest \r in \r Uyghurs \r is \r noted, \r with \r Uyghur \r themed \r domains \r being \r created \r from \r December \r 8, \r 2015. \r An\ninterest \r in \r Uyghurs \r is \r potentially \r consistent \r with \r past \r threat \r activity \r in \r terms \r of \r targeting, \r although \r further\ninvestigation \r was \r not \r performed. \r The \r presence \r of \r a \r PlugX \r C2 \r among \r other \r Uyghur \r themed \r domains \r suggests\nthere \r may \r be \r additional \r threat \r activity \r to \r be \r discovered.\n\nMoving \r away \r from \r domain \r pivots \r into \r binary \r naming \r schemes, \r this \r particular \r instance \r of \r PlugX \r uses \r a \r binary\nthat \r contains \r a \r service \r description \r of \r “F-­‐Secure \r GUI \r componet \r service”. \r At \r least \r three \r other \r PlugX \r samples \r use\nthe \r same \r service \r description. \r These \r three \r samples \r have \r the \r following \r properties:\n\nSample \r 1:\nMD5: \r 533cd66cf420e8919329ee850077319c\nSHA256: \r 0ba814941a0adb344cbf2a90552a66b52faa99a24d3107735da1db5a0e1f8360\n\nSample \r 2:\nMD5: \r e327abcfd09be4e8f64ef35026309747\nSHA256: \r 8b6ef2f4e2af608c755b3114e98ab78ac89e089db5b0bece7f2dc68bd1026a78\n\nSample \r 3:\nMD5: \r 103873e3fa8dfc2360bb5c22761da04a\nSHA256: \r 40099e0f13ba47bd4ea4f3f49228ac8cffdf07700c4ef8089e3b5d8013e914a3\n\nOf \r these, \r sample \r #3 \r also \r contains \r the \r exact \r same \r C2 \r auth \r string \r of \r “33333”. \r Assuming \r at \r least \r some \r of \r these\nvalues \r are \r manually \r input \r into \r the \r malware \r builder \r application, \r we \r may \r consider \r the \r possibility \r of \r a\nrelationship \r between \r these \r samples \r that \r could \r warrant \r further \r investigation.\n\n### Targeted Exploitation #11: Gh0stRAT (LURK0), PlugX, Other Malware\n\nThis \r is \r an \r instance \r of \r Gh0stRAT \r modified \r to \r use \r the \r string \r “LURK0” \r instead \r of \r “Gh0st” \r when \r traffic \r is \r initiated\nto \r the \r C2. \r This \r malicious \r RTF \r only \r appears \r to \r exploit \r CVE-­‐2015-­‐1641, \r despite \r the \r document \r matching \r on \r the\nFour \r Element \r Builder \r kit. \r When \r the \r malware \r executes, \r it \r launches \r a \r hidden \r Internet \r Explorer \r instance \r and\ninjects \r into \r the \r instance \r with \r WriteMemory \r and \r CreateRemoteThread \r process \r injections:\n\nWRITE_MEMORY \r @ \r 0x00140000 \r [0x0000005c \r bytes] \r [PID: \r 1076] \r [C:\\Program \r Files\\Internet \r Explorer\\iexplore.exe]\nCREATE_REMOTE_THREAD \r @ \r 0x7c80aedb \r [PID: \r 1076] \r [C:\\Program \r Files\\Internet \r Explorer\\iexplore.exe]\n\nThe \r injected \r instance \r of \r Internet \r Explorer \r starts \r with \r a \r current \r directory \r of \r AppData\\Roaming\\Micbt. \r  \r This\nfolder \r was \r created \r by \r the \r malware. \r  \r The \r malware \r then \r initiates \r a \r DNS \r query \r for \r manhaton.123nat[.]com,\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 39\n\n|www.turkistanuyghur.top|2016-­‐01-­‐22 01:26:09|2016-­‐01-­‐31 01:26:41|\n|---|---|---|\n|www.japanuyghur.top|2016-­‐01-­‐19 00:00:00|2016-­‐01-­‐31 01:25:57|\n|turkiyeuyghur.com|2015-­‐12-­‐08 09:59:30|2015-­‐12-­‐31 22:19:55|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nwhich \r at \r analysis \r time \r resolved \r to \r 122.10.112[.]126. \r The \r C2 \r port \r appears \r to \r be \r TCP/8030, \r but \r was \r not\nresponding \r during \r analysis. \r An \r ASN \r lookup \r reveals \r that \r the \r C2 \r is \r in \r China \r or \r Hong \r Kong:\n\n133731 \r  \r | \r 122.10.112.126 \r  \r  \r | \r CN \r | \r TOINTER-­‐AS-­‐AP \r Royal \r Network \r Technology \r Co., \r Ltd. \r in \r Guangzhou,CN\n134121 \r  \r | \r 122.10.112.126 \r  \r  \r | \r CN \r | \r RAINBOW-­‐HK \r Rainbow \r network \r limited,HK\n\nThe \r LURK0 \r variant \r of \r Gh0stRAT \r is \r well \r documented \r and \r has \r been \r used \r against \r the \r Tibetan \r community \r and\nothers \r for \r years \r [33] \r [34] \r [35]. \r Network \r activity \r appears \r as \r such, \r with \r the \r telltale \r “LURK0” \r string \r appearing \r at\nthe \r start \r of \r the \r packet.\n\nThe \r following \r network-­‐based \r alerts \r can \r notify \r organizations \r of \r Gh0stRAT \r LURK0 \r variant \r traffic:\n\n[2016922] \r ET \r TROJAN \r Backdoor \r family \r PCRat/Gh0st \r CnC \r traffic\n\n[2021716] \r ET \r TROJAN \r Backdoor \r family \r PCRat/Gh0st \r CnC \r traffic \r (OUTBOUND) \r 101\n\n[2808814] \r ETPRO \r TROJAN \r Backdoor \r family \r PCRat/Gh0st \r CnC \r Response\n\n**IOCs**\n\nC2: \r manhaton.123nat[.]com\nC2: \r 122.10.112[.]126 \r TCP/8030\nMD5 \r (90t69cf82.dll): \r 86ebcbb3bdd8af257b52daa869ddd6c1\nMD5 \r (RTF): \r b51dd4d5731b71c1a191294466cc8288\nMD5 \r (B412.tmp): \r 111273c8cba88636a036e250c2626b12\nMD5 \r (~tmp.doc): \r e538ad13417b773714b75b5d602e4c6e \r  \r -­‐ \r recognized \r as \r Gh0stRAT\nMD5 \r (Micbt/BTFly.dump): \r f7c04e8b188fa38d0f62f620e3bf01dc\nMD5 \r (Micbt/CltID.ini): \r 54afa267dd5acef3858dd6dbea609cd9\nMD5 \r (Micbt/IconConfigBt.DAT): \r 516774cb0d5d56b300c402f63fe47523\nMD5 \r (Micbt/MemoryLoad.dump): \r db0f8ba69aa71e9404b52d951458b97c\nMD5 \r (Micbt/RasTls.dll): \r 1e9e9ce1445a13c1ff4bf82f4a38de0d\nMD5 \r (Micbt/RasTls.exe): \r 62944e26b36b1dcace429ae26ba66164\n\n40 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nSHA-­‐256 \r (90t69cf82.dll): \r afd0eae5065a689f8fc48c0cfc5b87f4caecc2fb6b1cef4c5e977fc2cc98509d\nSHA-­‐256 \r (RTF): \r a0da9887b4c5af009a41b783db7ffedf949013abc70777c0ec539299628a51eb\nSHA-­‐256 \r (B512.tmp): \r cdb1d2f843ce797084cfc90107a2582e4861f4051aab0f6ac374468f491232a5\nSHA-­‐256 \r (~tmp.doc): \r aecd3e146632e9dfa0a92f486855144df0f87181feb67ac414a618fd52960c8c\nSHA-­‐256 \r (Micbt/BTFly.dump): \r 3b828a81ff5b0766c99284524b18fcd10d553191741bc1ed89904cdaa79baae1\nSHA-­‐256 \r (Micbt/CltID.ini): \r 1590a42e67fe02892dfeb6f29e0e6ae91c503d4ea91b550557c513e92f5ac7eb\nSHA-­‐256 \r (Micbt/IconConfigBt.DAT):\n0a47bd32b83f09be1ea5a29dce6b7d307de7b3cdd69f836e0c810fd578f85c7c\nSHA-­‐256 \r (Micbt/MemoryLoad.dump):\naace766acea06845c29b306a9e080edcb3407635398007f3b9b5e053198b54f4\nSHA-­‐256 \r (Micbt/RasTls.dll): \r bc2f7ebcad10aa48a69680f14fc57434436b821d5e7f2666a0f6d8795b0d37d1\nSHA-­‐256 \r (Micbt/RasTls.exe): \r f9ebf6aeb3f0fb0c29bd8f3d652476cd1fe8bd9a0c11cb15c43de33bbce0bf68\n\nSome \r potentially \r useful \r Unicode \r strings \r are \r present \r inside \r the \r RasTls \r files:\n\nUnicode \r Strings:\n=====================\nProgramFiles\nkernel32.dll\nSeDebugPrivilege\nInstall\nSOFTWARE\\Microsoft\\Windows\\DbxUpdateBT\nSOFTWARE\\Microsoft\\Windows\\\n\\%dt%dcf%d.dll\n\\MemoryLoad.dump\n\\IconConfigBt.DAT\ncase \r 0\ncase \r 1\nGet \r into \r InjectProMain\n%ProgramFiles%\\Internet \r Explorer\\iexplore.exe\n\nThe \r iexplore.exe \r process \r (that \r was \r the \r target \r of \r process \r injection) \r loads \r the \r 90t69cf82.dll \r binary \r that \r the\nmalware \r also \r dropped.\n\n**Connections to Historical and Ongoing Threat Campaign Activity**\n\nASERT \r has \r ten \r other \r instances \r of \r Gh0stRAT, \r LURK0 \r version \r in \r our \r malware \r repository. \r Passive \r DNS \r pivots \r on\nthe \r IP \r address \r associated \r with \r manhaton.123nat[.]com \r (122.10.112[.]126) \r reveals \r several \r other \r potentially\ninteresting \r domains \r that \r have \r used \r this \r IP \r including: \r softinc[.]pw \r and \r www.tibetimes[.]com. \r It \r is \r interesting \r to\nnote \r that \r this \r tibetimes.com \r domain \r may \r have \r been \r an \r attempt \r to \r spoof \r the \r domain \r www.tibettimes.net.\nPassive \r DNS \r shows \r a \r lot \r of \r activity, \r including \r relationships \r to \r Uyghur \r based \r domains.\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 41\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nDomain name First seen Last seen\nwww.tibetimes.com 2015-­‐12-­‐01 02:04:24 2015-­‐12-­‐04 01:25:34\nsoftinc.pw 2015-­‐11-­‐01 06:43:26 2015-­‐11-­‐30 18:57:21\n\nAn \r email \r address \r associated \r with \r these \r domains \r is \r lobsang[@]gmx.com \r and \r another \r is\n2732115454[@]qq.com. \r The \r IP \r and \r these \r mail \r addresses \r associate \r with \r Uyghur \r and \r Tibetan \r themed \r domains\nas \r shown \r here:\n\nThe \r following \r diagram \r zooms \r in \r on \r the \r Uyghur-­‐based \r domain \r names \r highlighting \r the \r connection \r between \r this\nGh0stRAT \r sample \r domain \r metadata \r and \r other \r activity \r observed, \r such \r as \r the \r domain \r whitewall[.]top \r used \r in\nthe \r PlugX \r configuration \r previously \r mentioned.\n\n42 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n|Domain name|First seen|Last seen|\n|---|---|---|\n|www.tibetimes.com|2015-­‐12-­‐01 0 2:04:24|2015-­‐12-­‐04 0 1:25:34|\n|softinc.pw|2015-­‐11-­‐01 0 6:43:26|2015-­‐11-­‐30 1 8:57:21|\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nAdditional \r investigations \r are \r underway \r to \r determine \r the \r scope \r of \r the \r particular \r threat \r herein.\n\n### Targeted Exploitation #12: T9000 Malware; Tibet House Lure\n\nThis \r malware \r originates \r on \r December \r 31, \r 2015 \r and \r used \r the \r original \r filename \r “[tibethouse] \r Upcoming\nProgram \r Announcement \r Last \r Week \r of \r December.doc”. \r This \r timing \r and \r naming \r scheme \r is \r consistent \r with \r the\nTibetan-­‐themed \r engagement \r seen \r in \r late \r December \r of \r 2015. \r The \r malware \r was \r first \r submitted \r to \r Virus \r Total\nfrom \r India, \r and \r exploits \r CVE-­‐2012-­‐0158, \r CVE-­‐2012-­‐1856, \r and \r CVE-­‐2016-­‐1641.\n\nThe \r bait \r file \r is \r a \r seven \r page \r “Upcoming \r Programme \r Announcement” \r apparently \r written \r by \r the \r Tibet \r House.\nDocument \r metadata \r shows \r the \r user \r name \r “HighSea” \r (previously \r observed \r in \r Targeted \r Exploitation \r #8 \r herein):\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 43\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nThe \r “Related \r People” \r values \r inside \r these \r documents \r may \r be \r related \r to \r threat \r actors, \r or \r threat \r actor\ninfrastructure. \r There \r is \r not \r enough \r information \r to \r determine \r if \r these \r names \r are \r simply \r generated\nprogrammatically \r or \r if \r they \r actually \r represent \r real \r people. \r In \r any \r event, \r the \r names \r have \r been \r re-­‐used \r in \r some\ncases \r and \r may \r be \r a \r useful \r indicator \r of \r a \r maliciously \r crafted \r document.\n\nThe \r malware \r at \r play \r here \r is \r T9000, \r displaying \r all \r of \r the \r usual \r expected \r T9000 \r files \r including \r the \r Elevate.DLL\nfile \r discussed \r earlier \r in \r this \r report. \r  \r The \r malware \r binary \r itself \r is \r identical \r to \r an \r aforementioned \r T9000 \r sample\n(Sixteen \r Drops \r of \r Kadam \r Empowerment: \r T9000 \r Keylogger) \r and \r therefore \r the \r C2 \r is \r also \r identical \r to \r what \r was\nreported \r earlier.\n\n**IOC’s**\n\nC2: \r 198.55.120[.]143:7386\nC2: \r URL: \r http://198.55.120[.]143:7386/B/ResN32.dll\nMD5 \r (RTF): \r 98bcd226890c5c2694ef9a34a23c9fbf\nMD5 \r (Elevate.dll): \r 1d335f6a58cb9fab503a9b9cb371f57b\nMD5 \r (QQMgr.dll): \r b9c584c7c34d14599de8cd3b72f2074b\nMD5 \r (QQMgr.inf): \r 8ac933be588f49560179c26ddbc6a753\nMD5 \r (ResN32.dat): \r 50753c28878ce10a748fbd7b831ecbe1\nMD5 \r (ResN32.dll): \r a45e5c32fc2bc7be9d6e4bba8b2807bf\nMD5 \r (hccutils.dll): \r 2299fb8268f47294eb2b18282540a955\nMD5 \r (hccutils.inf): \r 2f31ef1a8fca047ed0d623010d569857\nMD5 \r (hjwe.dat): \r d3601a5160b8d122261989d147221eb7\nMD5 \r (qhnj.dat): \r a9de62186cb8d0e23b0dc75e1ae373ac\nMD5 \r (tyeu.dat): \r 29ec20f5fa1817dc9250c434e61420ea\nMD5 \r (vnkd.dat): \r 35f4ce864c3a3dc016fea3459d6402a9\n\n44 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\nMD5 \r (~1): \r b901f0b4aa6a3a6875235f96fce15839\nSHA-­‐256 \r (RTF): \r e13a0357cd51795100dbce25fe846783fbb7fd22c5efe438d9059edc10492f49\nSHA-­‐256 \r (Elevate.dll): \r 9c23febc49c7b17387767844356d38d5578727ee1150956164883cf555fe7f95\nSHA-­‐256 \r (QQMgr.dll): \r bf1b00b7430899d33795ef3405142e880ef8dcbda8aab0b19d80875a14ed852f\nSHA-­‐256 \r (QQMgr.inf): \r ace7e3535f2f1fe32e693920a9f411eea21682c87a8e6661d3b67330cd221a2a\nSHA-­‐256 \r (ResN32.dat): \r 5b90fa081e3ac29a7339995f9b087dab9981409ff62e3215eb558908c6b96b14\nSHA-­‐256 \r (ResN32.dll): \r 1cea4e49bd785378d8beb863bb8eb662042dffd18c85b8c14c74a0367071d9a7\nSHA-­‐256 \r (hccutils.dll): \r 3dfc94605daf51ebd7bbccbb3a9049999f8d555db0999a6a7e6265a7e458cab9\nSHA-­‐256 \r (hccutils.inf): \r f05cd0353817bf6c2cab396181464c31c352d6dea07e2d688def261dd6542b27\nSHA-­‐256 \r (hjwe.dat): \r bb73261072d2ef220b8f87c6bb7488ad2da736790898d61f33a5fb7747abf48b\nSHA-­‐256 \r (qhnj.dat): \r c61dbc7b51caab1d0353cbba9a8f51f65ef167459277c1c16f15eb6c7025cfe3\nSHA-­‐256 \r (tyeu.dat): \r e52b5ed63719a2798314a9c49c42c0ed4eb22a1ac4a2ad30e8bfc899edcea926\nSHA-­‐256 \r (vnkd.dat): \r c22b40db7f9f8ebdbde4e5fc3a44e15449f75c40830c88932f9abd541cc78465\nSHA-­‐256 \r (~1): \r df50ea33616c916720c81d65563175d998a2c606360eeb3c8b727a482de3a4fc\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 45\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n### Conclusion \r \n\nThreat \r actors \r using \r similar \r exploit \r code \r are \r launching \r or \r continuing \r a \r variety \r of \r campaigns \r (termed \r as \r an\n“engagement” \r herein, \r where \r an \r engagement \r is \r an \r offensive \r action \r within \r a \r larger \r campaign \r context) \r aimed \r at\ntargets \r such \r as \r the \r Tibetan \r community, \r Hong \r Kong \r and \r Taiwanese \r media, \r and \r Asian \r human \r rights \r workers.\nDue \r to \r the \r easy \r delivery \r of \r RTF \r files \r as \r attachments \r and \r the \r observation \r of \r numerous \r spear \r phish \r samples\nwhich \r reveal \r precise \r targeting \r and \r timelines, \r it \r is \r likely \r that \r spearphish \r was \r the \r primary \r vector \r of \r choice \r for\nmost \r or \r all \r of \r the \r targeted \r exploitation \r scenarios \r profiled \r herein. \r The \r RTF \r files \r observed \r herein \r contained \r up\nto \r four \r unique \r exploits \r for \r various \r versions \r of \r Office. \r It \r is \r hypothesized \r that \r a \r similar \r builder \r kit \r – \r which \r we’ve\nnamed \r the \r Four \r Element \r Sword \r Builder \r -­‐ \r is \r involved \r in \r the \r creation \r of \r these \r malicious \r documents, \r however\nfuture \r work \r is \r required \r to \r precisely \r classify \r the \r Four \r Element \r Sword \r builder \r with \r respect \r to \r crimeware \r and\nAPT \r activity. \r In \r the \r case \r of \r the \r APT \r oriented \r threat \r scenarios \r profiled \r herein, \r anywhere \r from \r 2-­‐4 \r of \r the\nexploits \r were \r typically \r observed. \r In \r the \r case \r of \r the \r cybercrime \r activities \r that \r will \r be \r profiled \r in \r a \r separate\nforthcoming \r document, \r 2-­‐3 \r of \r these \r exploits \r were \r typically \r observed.\n\nAll \r of \r the \r exploit \r code \r observed \r deals \r with \r older \r vulnerabilities \r that \r have \r been \r patched. \r However, \r considering\nthe \r target \r populations \r at \r hand, \r it \r is \r possible \r that \r older \r systems \r may \r still \r be \r in \r use. \r Once \r APT \r actors \r gain \r a\ntoehold \r inside \r an \r organization, \r past \r history \r shows \r that \r it’s \r just \r a \r matter \r of \r time \r before \r lateral \r movement \r and\nfurther \r exploitation \r scenarios \r will \r unfold \r to \r implement \r the \r actors \r actions \r on \r objectives. \r In \r the \r case \r of \r the\nTibetan \r community, \r which \r has \r been \r under \r attack \r for \r years, \r there \r have \r been \r awareness \r campaigns \r designed\nto \r reduce \r risk \r by \r implementing \r special \r controls \r and \r procedures \r around \r dealing \r with \r attachments. \r Recently\npublished \r documents \r by \r other \r security \r research \r organizations \r have \r revealed \r that \r actors \r have \r evolved \r to\nnewer \r methods \r in \r their \r ongoing \r efforts \r to \r stay \r beneath \r the \r radar.\n\nRegardless \r of \r the \r delivery \r method, \r the \r malware \r profiled \r herein \r are \r active \r threats \r likely \r deployed \r in \r numerous\nother \r scenarios \r by \r this, \r or \r by \r other \r groups \r of \r actors. \r While \r older \r exploit \r code \r may \r be \r a \r threat \r to \r some\npopulations \r and \r not \r to \r others, \r the \r weaponization \r of \r other \r vulnerabilities \r is \r likely \r taking \r place \r and \r such\nmalware \r can \r easily \r become \r a \r payload \r in \r such \r a \r case, \r making \r all \r analytic \r and \r detective \r insight \r of \r the \r malicious\ncode \r of \r relevance \r for \r defenders \r in \r the \r global \r defensive \r sphere.\n\n46 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n### References\n\n1. https://www.usenix.org/system/files/conference/usenixsecurity14/sec14-paper-blond.pdf\n2. https://chinaview.wordpress.com/category/technology/internet/wikipedia/\n3. http://blog.trendmicro.com/trendlabs-security-intelligence/cve-2012-0158-now-being-used-in-more-tibetan\nthemed-targeted-attack-campaigns/\n4. http://contagiodump.blogspot.com.es/2012/04/cve2012-0158-south-china-sea-insider.html\n5. http://blog.ropchain.com/2015/07/27/analyzing-vupens-cve-2012-1856/\n6. https://gist.github.com/anonymous/4ac64f2a747db1bf5c89/revisions\n7. https://www.youtube.com/channel/UCjgTCn331Pk4XTI68LwhkdQ/feed\n8. https://nakedsecurity.sophos.com/2015/09/08/anatomy-of-a-malicious-email-recent-word-hole/\n9. https://nakedsecurity.sophos.com/2015/12/14/exploit-upgrade-for-microsoft-word-intruder-crimeware-kit/\n10. http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1770\n11. https://technet.microsoft.com/library/security/ms15-059\n12. http://researchcenter.paloaltonetworks.com/2015/08/rtf-exploit-installs-italian-rat-uwarrior/\n13. http://researchcenter.paloaltonetworks.com/2015/06/evilgrab-delivered-by-watering-hole-attack-on-president-of\nmyanmars-website/\n14. https://www.usenix.org/system/files/conference/usenixsecurity14/sec14-paper-blond.pdf\n15. https://www.f-secure.com/weblog/archives00001736.html\n16. https://github.com/citizenlab/malware-indicators/blob/master/network-indicators.csv\n17. http://www.europarl.europa.eu/meetdocs/2014_2019/documents/droi/dv/420_speechmckune_/420_speechmckun\n\ne_en.pdf\n18. https://www.virusbulletin.com/uploads/pdf/conference_slides/2013/Szappanos-VB2013.pdf\n19. https://www.virusbulletin.com/virusbulletin/2014/02/needle-haystack/\n20. https://cryptam.com/docsearch.php?hash=0683fac0b564fe5d2096e207b374a238a811e67b87856fc19bdf8eb3d6f\n\n76b49&submit=Search\n21. http://about-threats.trendmicro.com/cloud-content/us/ent-primers/pdf/2q-report-on-targeted-attack-campaigns.pdf\n22. http://blog.trendmicro.com/trendlabs-security-intelligence/new-targeted-attack-group-buys-bifrose-code-works-in\nteams/\n23. http://www.engadget.com/2014/01/16/cos-china-operating-system/\n24. http://blog.trendmicro.com/trendlabs-security-intelligence/plead-targeted-attacks-against-taiwanese-government\nagencies-2/\n25. http://blog.trendmicro.com/trendlabs-security-intelligence/kivars-with-venom-targeted-attacks-upgrade-with-64-bit\nsupport\n26. http://tibet.net/2016/01/sixteen-drops-of-kadam-empowerment-day-two/\n27. http://researchcenter.paloaltonetworks.com/2016/02/t9000-advanced-modular-backdoor-uses-complex-anti\nanalysis-techniques/\n28. http://blog.jpcert.or.jp/2015/02/a-new-uac-bypass-method-that-dridex-uses.html\n29. https://www.greyhathacker.net/?tag=elevate\n30. http://www.rfa.org/english/news/tibet/freed-12042015165254.html\n31. http://www.rsaconference.com/writable/presentations/file_upload/hta-w04a-dll-side-loading-a-thorn-in-the-side-of\nthe-anti-virus-_av_-industry.pdf\n32. http://pwc.blogs.com/cyber_security_updates/2016/03/taiwant-election-targetting.html\n33. http://www.welivesecurity.com/2014/11/14/targeted-attacks-tibetan-advocates-using-g20-2014-summit-lure/\n34. https://citizenlab.org/2013/08/surtr-malware-family-targeting-the-tibetan-community/\n35. http://download01.norman.no/documents/ThemanyfacesofGh0stRat.pdf\n\n© Copyright 2016 Arbor Networks, Inc. All rights reserved. 47\n\n\n-----\n\nASERT Threat Intelligence Report 2016-03: The Four-Element Sword Engagement\n\n### About \r ASERT \r \n\nThe \r Arbor \r Security \r Engineering \r & \r Response \r Team \r (ASERT) \r at \r Arbor \r Networks \r delivers \r world-­‐class \r network\nsecurity \r research \r and \r analysis \r for \r the \r benefit \r of \r today's \r enterprise \r and \r network \r operators. \r ASERT \r engineers\nand \r researchers \r are \r part \r of \r an \r elite \r group \r of \r institutions \r that \r are \r referred \r to \r as \r “super \r remediators,” \r and\nrepresent \r the \r best \r in \r information \r security. \r This \r is \r a \r reflection \r of \r having \r both \r visibility \r and \r remediation\ncapabilities \r at \r a \r majority \r of \r service \r provider \r networks \r globally.\n\nASERT \r shares \r operationally \r viable \r intelligence \r with \r hundreds \r of \r international \r Computer \r Emergency \r Response\nTeams \r (CERTs) \r and \r with \r thousands \r of \r network \r operators \r via \r intelligence \r briefs \r and \r security \r content \r feeds.\nASERT \r also \r operates \r the \r world1s \r largest \r distributed \r honeynet, \r actively \r monitoring \r Internet \r threats \r around \r the\nclock \r and \r around \r the \r globe \r via \r ATLAS®, \r Arbor's \r global \r network \r of \r sensors: \r http://atlas.arbor.net. \r This \r mission\nand \r the \r associated \r resources \r that \r Arbor \r Networks \r brings \r to \r bear \r to \r the \r problem \r of \r global \r Internet \r security \r is\nan \r impetus \r for \r innovation \r and \r research.\n\nTo \r view \r the \r latest \r research, \r news, \r and \r trends \r from \r Arbor, \r ASERT \r and \r the \r information \r security \r community \r at\nlarge, \r visit \r our \r Threat \r Portal \r at \r http://www.arbornetworks.com/threats/.\n\n48 Proprietary and Confidential Information of Arbor Networks, Inc.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/19ghms2qz9raaquoxu2bh3paoqyx545r"
    ],
    "report_names": [
        "Arbor_The-Four-Element-Sword-Engagement(4-13-16)"
    ],
    "threat_actors": [
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "7a9a7873-8e41-40ae-9d06-b27c92bb54e4",
            "created_at": "2022-10-25T16:47:55.568362Z",
            "updated_at": "2025-03-27T02:05:17.264615Z",
            "deleted_at": null,
            "main_name": "BRONZE FIRESTONE",
            "aliases": [
                "C0d0s0",
                "Deep Panda ",
                "Pupa ",
                "TG-3551 ",
                "APT19 "
            ],
            "source_name": "Secureworks:BRONZE FIRESTONE",
            "tools": [
                " Alice's Rabbit Hole",
                " Briba",
                " Cobalt Strike",
                " Derusbi",
                " PlugX",
                " PoisonIvy",
                " Powershell Empire",
                " Zuguo",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c93a7f58-3f75-487c-9bd6-e705b73fc07f",
            "created_at": "2023-01-06T13:46:38.330916Z",
            "updated_at": "2025-03-27T02:00:02.806744Z",
            "deleted_at": null,
            "main_name": "RADIO PANDA",
            "aliases": [
                "Shrouded Crossbow"
            ],
            "source_name": "MISPGALAXY:RADIO PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041454,
    "ts_creation_date": 1460576506,
    "ts_modification_date": 1460576506,
    "files": {
        "pdf": "https://archive.orkl.eu/e7c914466713e7e74fcc1338398a1340464e63bc.pdf",
        "text": "https://archive.orkl.eu/e7c914466713e7e74fcc1338398a1340464e63bc.txt",
        "img": "https://archive.orkl.eu/e7c914466713e7e74fcc1338398a1340464e63bc.jpg"
    }
}