{
    "id": "93222566-66eb-4269-8586-c7b88cb20ae7",
    "created_at": "2023-01-12T15:08:53.669265Z",
    "updated_at": "2025-03-27T02:16:26.546217Z",
    "deleted_at": null,
    "sha1_hash": "2cc9e69bc0ba0ed3ab6d85def4d5a64c8e691057",
    "title": "2018-03-02 - Analysing Remcos RAT’s executable",
    "authors": "",
    "file_creation_date": "2022-05-28T04:06:08Z",
    "file_modification_date": "2022-05-28T04:06:08Z",
    "file_size": 495052,
    "plain_text": "# Analysing Remcos RAT’s executable\n\n**[krabsonsecurity.com/2018/03/02/analysing-remcos-rats-executable/](https://krabsonsecurity.com/2018/03/02/analysing-remcos-rats-executable/)**\n\n[Posted on March 2, 2018](https://krabsonsecurity.com/2018/03/02/)\nRemcos is a native RAT sold on the forums HackForums.net. It is an interesting piece of\nRAT (and the only one that is developed in a native language other than Netwire) and is\nheavily used by malware actors. Coded by the author, Viotto, it is self proclaimed to be a\nlegal administration tool. Whether that is true or not is to be understood by people who have\nseen Remcos malware campaigns and the fact that the author also sells a crypter.\n\nFirst thing we notice when looking at Remcos RAT is that it uses C++ and the CRT quite\nheavily. This leads to the output file being rather large (though still small by some\nstandards) at 120kb.\n\nAnother interesting thing is that Remcos allows you to extract the license (which is most\nlikely based on the HWID) of the individual who created the stub easily by executing the file\nwith the -l switch. If the sample is packed by a crypter that does not pass the command line\nparameter, you’ll have to unpack it first.\n\n\n-----\n\nStatic Mutex (compared across multiple bins), runtime detection and hooking as well as\nmemory signature anyone?\n\nSimple resource loading using kernel32 APIs\n\nFragments from usage of the public password recovery tools developed by NirSoft (/stext is\n[a command line switch used to dump passwords to a text file, reference):](https://www.nirsoft.net/utils/web_browser_password.html)\n\n\n-----\n\n[Public pasted runpe (almost identical to this, the only difference is that the Unicode API is](https://github.com/jozemberi/PE-Crypter/blob/master/runPE.h)\nused and the input buffer is not freed at the end).\n\nDisabling MSC via registry (I would be surprised if no AVs detect this as suspicious\nbehaviour)\n\n\n-----\n\nRepeatedly loading the same string over and over again using the .c_str() function\n(because one cannot store the same static string in a global/local variable and use it for\nthese calls rather than obtaining it again and again every time)\n\nFile installation implementation:\n\n\n-----\n\nStarting the debug console\n\nVery simple (and runtime detected) keylogger using SetWindowsHookExA (13 is the\nconstant for WH_KEYBOARD_LL)\n\n\n-----\n\nDownloading file using URLDownloadToFileW and then dropping VBS file to replace old\nexecutable with new executable for updating:\n\n\n-----\n\nResolving some APIs (I am rather curious as to why these specific APIs are resolved\ndynamically when other suspicious APIs such as WriteProcessMemory and\nSetThreadContext are imported directly from the IAT0.\n\n\n-----\n\nDownloading DLL to buffer, map a new memory page and then loading the DLL:\n\n\n-----\n\nIt also seem that the RAT is somewhat modular, DLLs are sent from the controller (or\nloaded from resource/.data) and functions from it are called.\n\nThe functions listed here are only found as strings in remcos samples, which confirms that\nthe module is custom.\n\nOverall, Remcos is not advanced nor extraordinary and a killer for it can be easily be\ndeveloped when needed. Despite being rather unsophiscated, it is still heavily used by\ncybercriminals to control infected devices and siphone money from those who are infected.\n\n\n-----\n\nSample hash: 46E4CFF5DD847E0A9AB26F2F92E89AE9E1BB14ED (file is available via\nVirusBay)\nIDA Database File: [Uploaded to GitHub](https://github.com/zunzutech/public-idb)\n\n## Comments ( 10 )\n\n\n-----\n\n[1. ViottoPosted on 4:10 pm March 4, 2018](https://breaking-security.net/)\n\nNice review Mr. Krabs, but being the author of this software, I want to correct some\nmistakes you made during your analysis. 1) Regarding the legality question: I don't\nknow where you live, but here in Europe what I am developing and selling is perfectly\nlegal. We don't allow malicious usage, and this is why, as yourself stated, the\ncustomer licence is stored in the Remcos agent, and can be easily retrieved using the\n-l command. Anytime we get a report of someone abusing our software and not using\nit for legal means, we can promptly check and make his copy unusable anytime. We\nhave a dedicated email just for abuse reports: abuse@breakingsecurity.net 2) You\nsaid: \"size is quite large\". 120 kb is large for a program which allows total control of\nany part of the Windows OS? It is a tiny size expecially for today standards, where\nmost of the software is bloated. I don't think you'll find other remote control software\nwith a better size/number of functions ratio. Check TeamViewer, for example, which\nhas just a fraction of Remcos functions. 3) In the last part you stated: \"Remcos is not\nadvanced and a killer can be easily developed when needed\". Then still you forget\nthat our focus is on legal administration and surveillance, we don't aid cybercriminals\nas you state. Actually, what you did is a criminal offence by european laws, which is\ncalled defamation towards a company. If you need any other clarification, we are\nalways available. :) Best regards, Viotto BreakingSecurity.net administrator and\ndeveloper\n\n\n-----\n\n_Mr. KrabsPosted on 4:24 pm March 4, 2018_\n1) I said \"Whether that is true or not is to be understood by people who have\nseen Remcos malware campaigns and the fact that the author also sells a\ncrypter.\" for a reason. Quite a lot of malware campaigns that used Remcos so\nfar (statistics easily obtainable from honeypots and malware databases),\nwouldn't you agree? 2) Well maybe you shouldn't claim that it is 90kb or 100kb\non your sites then because I saw that thus me making the comment 3) Maybe\nyou should work better on preventing abuse then because malware campaigns\nwhich relies on Remcos is not uncommon at all, further more you are selling a\ncrypter yourself so please don't try to look innocent. :) 4) Well excuse me, I don't\nknow on what other forums do you advertise your product but HF is definitely\none of them\n\n\n-----\n\n_[ViottoPosted on 6:00 pm March 4, 2018](https://breaking-security.net/)_\n1) Yes, it happened that Remcos has been used in malware campaigns,\nand anytime we got a report, we banned licence and immediately stopped\nthe whole campaign. Also guns get used for a lot of bad things, but if a\nmanufacturer produces a gun which works well, it is not his fault if it is\nused in a robbery, isn't it? :) As gun manufacturers do, we do also print a\nserial code on each one of the licenced software. We have got the majority\nof customers who use our software respecting our contract and terms, is it\nso strange? The majority of these attacks have been done using the\ncracked version of our tool, so we have been a victim of it as well in those\ncases. 2) The normal Remcos stub (if disabling compression), in v2.0.2 is\n108kb. You analysed the relocation stub which is 120kb more. In the Free\nversion, size is even smaller, around 70 kb. So, in the site I wrote: around\n100 kb, because it depends on settings such as stub type and\ncompression. In no case goes bigger then 120kb, which as you know is a\ntiny size even for floppy disks standards. 3) Yes, and as Remcos, Octopus\nProtector can be used for many different purposes. Same terms of\nservices applies to that. I think we did all possible measures to prevent\nabuse, but if you have got some extra idea, I will hear ;) 4) We don't sell on\nHackForums, that is just one of the places where we do advertise this\nproduct. We do sell just on our own site. Then mostly we do cooperate with\ncompanies which don't use forums. Best regards, Viotto\nBreakingSecurity.net administrator and developer\n\n\n-----\n\n_Avira Pueple WormetherthPosted on 9:44 am March 6, 2018_\n1: Why would a valid license be used in correlation with a distribution\ncampaign? Judging from your need of an invite code, you would be\nexpected to personally filter out any suspicious customers (assuming\nthe invite request is for customer validation). 2(referring to your point\n3): Sales of such tools (Octopus Protector) wouldn't be so\naggravating if the toys associated with the tool wasn't so blatantly\nforged. Crypters always have, and always will be used for illicit\npurposes only; a legitimate network owner would never require such\na tool to bypass any third party protection under his/her own\ncommand. If you wish to defend this claim with something along the\nlines of \"this tool is not for protection of malware, rather protection of\nlegitimate executables,\" then why has your official channel uploaded\na blatant AV bypass video?(https://www.youtube.com/watch?\nv=BVxQxSfNJXQ) Something a legitimate developer would never\nneed. Also referring to a line in your description: \"An executable file\ngets totally encrypted and protected from human and antivirus\nanalysis.\" preventing a human from tampering I would understand,\nbut why would a legitimate executable require protection from any\nform of AV analysis procedures? Overall your attempt to claim your\nmalware legal, was extremely cringe. Anyone who sells a R.A.T\nalongside a crypter, is clearly in it for blackhat money.\n\n\n-----\n\n[2. ViottoPosted on 8:43 pm April 10, 2018](https://breaking-security.net/)\n\nHello mr Avira, late reply from me here but I just noticed your comment. Regarding\nyour points: 1: Yes, our customers can purchase just if registered (and registration\nrequires an invite code), so we do filter out suspicious customers, or ban them if we\nnotice malicious activity after they purchased. Many attacks have been carried out\nusing an old, cracked Remcos version, the cracker removed abuse protection so\nunfortunately this wasn't under our control. We have been damaged by this as well,\nsince malicious users abused our software. 2: Crypters have many uses, such as\nprotecting files from analysis and cracking. Since I own a cybersecurity company\nwhich involves hacking as well (in an ethical way), my Octopus Protector can be used\nagainst many kinds of analysis, including AV analysis. This is however not illegal,\nunless you are using it against unaware users. The video is a demonstration that even\nstronger AV protections can be bypassed. If your point was true, then even Metasploit\nwould be illegal, but it isn't. Best regards, Viotto\n\n_AnalPosted on 11:19 am April 14, 2018_\nViotto, 1. You clearly say that \"Also guns get used for a lot of bad things, but if a\nmanufacturer produces a gun which works well, it is not his fault if it is used in a\nrobbery, isn’t it?\" In software, you have a lot more control over your customers,\nguns are a physical piece of metal, which makes your argument invalid. In\nsoftware, you can place for example, an alert to the person launching the file on\nanother computer that they are executing a file that can take control of your\ncomputer? Also you state \"Yes, it happened that Remcos has been used in\nmalware campaigns, and anytime we got a report, we banned licence and\nimmediately stopped the whole campaign.\" Instead of only getting reports from a\nthird party, why aren't you taking any action yourself cracking on the\nsuspicious/malicious users? I clearly gave you an idea how to crack down on\nANY malicious campaign, but obviously you are not going to invent this,\nbecause all your customers are using the product in a malicious manner, thus\nyou don't want to take any action against it other than the bad reports. 2. You\nstate \"my Octopus Protector can be used against many kinds of analysis,\nincluding AV analysis\" Why does your product need to make the files \"crypted\"\nin the crypter, undetected from anti-viruses? Only thing they do is analyze the\nfile, see if it can be used maliciously, if yes, they detect the file. Every update of\nyour product makes the stub undetected, which isn't required in order to control\nanother persons computer, since the anti-viruses can be disabled manually on\nthe \"targets\" PC. You made a video of an anti-viruses scanning your file after\nyou put it thru your \"crypter\". Why is this relevant? Why aren't any other native\npackers making their programs undetected from anti-viruses if they are not used\nin a malicious manner?\n\n\n-----\n\n_Avira Pueple WormetherthPosted on 12:55 am April 18, 2018_\nWhy would any security product need to be bypassed in a controlled\nenvirontment? Your \"my Octopus Protector can be used against many kinds of\nanalysis, including AV analysis\" could be argued against with something such\nas: Why would you need to protect your customer's file from a legitimate\nresearcher? No one employed by a security company would wish to distribute\nyour file; they are checking whether it is a potential threat to their customer\nbase. If you really wished to portay a legitimate image, you could follow in the\nfootsteps of LuminosityLink by forcing a pre-installation watermark. Functions\nsuch as: RunPE & \"ReplacePE\" play a major role in most modern malware\ncampaigns. How would these methods aid in preventing analysis of a\nlegimitmate file? Forgive the 8 day delay, and don't see this reply as a form of\nattack. I am merely trying to get your side of things\n\n\n-----\n\n3. MaxPosted on 10:11 pm October 13, 2018\n\n\"Only thing they do is analyze the file, see if it can be used maliciously, if yes, they\ndetect the file.\" Really? Are we all to believe that? Unfortunately I disagree, because\nthe AV industry has for a very very long time not done its homework regarding false\npositives. Some of the assumptions made in AV heuristics are equally cringeworthy as\nthe apologetic tone of Viotto above. Nice wording, by the way. Something \"can be\nused maliciously\" and AV vendors \"detect the file\". Sounds easy. But there isn't even\nan industry-wide standard on what that first term means, let alone a standard on how\nthings get detected. Serious AV testing is just in its infancy, despite AV testers having\nbeen around for quite some time. Oh, and a lot of things “can be used maliciously”,\nbut kitchen knives are still sold, despite having been used in murders (the same thing\ngoes for a lot of blunt tools from any workshop). Of course that’s the very reason you\ndecided to use \"can be used malicously\" as opposed to \"is malicious\". Because the\nworld is not black and white and you know it. But when it comes to false positives no\none cares and the world is black and white after all. Sure, detecting a RAT, even as\nPUA, is perfectly (!) fine. But AV vendors' analysis capacities have long been been\noverwhelmed. Which leads to copying of detections [1] within the industry, which is not\nonly evidenced by that infamous Kaspersky experiment a few years ago. But once\npropagated throughout the industry, these detections rarely get corrected even if they\nturn out to be false positives. Detections propagate, their removal in case of false\npositives does not. That's a real problem. Both for small independent software\ncreators and their customers. Even though the original AV vendor, detecting an item\nfirst, may correct the mistake, it takes considerable effort to remove such a detection\nfrom all those dozens different AV products. And - as I pointed out - detections (all\ntypes!) in the AV industry propagate. Now, while sample sharing is a good thing,\ncopying detections is not. There is a disparity between how easy it is for an AV to\ndetect a given executable file as malicious (and no, most users won't even bother\nreading the fineprint, so: detected by AV == malicious) and for that detection to spread\nthroughout the industry and how effing hard it is to ever get a wrongful detection\n(which often borders on the commercial equivalent of character assassination, given\nthat smaller companies are already disadvantaged as it is) out again. While in order to\nend up in detection of just about every AV product out there all you need to do is that\nyou use some allegedly \"shady APIs\" or end up with some bored AV analyst looking at\nyour file and making the wrong decision within the short allotted time (assuming it's\nnot some inherently stupid sandbox with some heuristics created by equally bored\nanalysts mounted on top: AI ... automated imbecility), in order to get out again you'd\nhave to contact every single effing AV vendor individually and then it typically takes a\nlong time to receive a response, if any. Let alone the time it takes to get the detection\nremoved - if one manages it at all - or to \"argue\" one's case. This is an uphill battle for\nany legitimate software vendor having his product(s) end up in detection. And no AV\nvendor or the industry overall sees that as a problem. Because they act like a sheriff in\nthe wild west, embodying the law (or so they think) and therefore what they do must\n\n\n-----\n\nbe The Right Thing™. Even if it effectively amounts to slander and the commercial\nequivalent of character assassination. Seriously, if AV vendors are the good guys,\nthen why the heck can't they even play by commonly accepted rules or by time-proven\nparadigms such as \"in dubio pro reo\"? Now what the makers of Remcos RAT do is\nshady. No doubt about it. And selling the crypter alongside the RAT doesn't make it\nlook any better. But PLEASE take off your rose-colored glasses, AV people! Small\nindependent software vendors have no legal department. Heck, open source\ndevelopers don't even have a sales or marketing department. Being detected by an\nAV is the death knell to many small software creators and is very demotivating indeed\nfor open source developers. Don't take adding something INTO detection so lightly,\nwould ya? And get your act together to provide one single contact to report false\npositives instead of having small ISVs running the gauntlet with understaffed \"support\ndepartments\" trying to shield actual analysts from seeing false positive reports. [1]\nAnd by copying I am not implying that this is done verbatim or so. Alone the difference\nin how the various engines work would make that hard. However, the fact that files are\nshared between AV vendors and that VirusTotal also shares files with the vendors\nleads to the observation that one of the heuristics of whether a file ought to end up in\ndetection is apparently a.) the trust vendor A places in vendor X detecting that file\nalready and/or b.) a threshold value of how many AV vendors already have said file in\ndetection, leading to a vendor also detecting it. Now you should be able to see the\nvicious circle this creates, not to mention the issue that the turnaround for detections\nbeing copied is relatively fast, whereas alone the attempt by a smaller independent\nsoftware developer to have a detection of his/her software removed takes AGES in\ncomparison. Not to mention that you need to contact each and every AV vendor\nindividually. Great stuff!\n\n4. KrabMaster2Posted on 7:59 pm April 26, 2019\n\nNice website. I especially like your Revcode posts.\n\n5. hwac121Posted on 8:01 pm June 10, 2019\n\nWho the hell wants to purchase a software that has a backdoor built-in purposely by\nthe developer so they can deactivate your software whenever they like? As for the\nauthor of this article...ALL hacking tools are used by both white hat and black hat...the\nonly way to be a good white hat hacker and security professional is to understand and\nbe able to use the exact same tools the criminals do.\n\nView Comments (10) ...\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-02 - Analysing Remcos RAT’s executable.pdf"
    ],
    "report_names": [
        "2018-03-02 - Analysing Remcos RAT’s executable.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536133,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653710768,
    "ts_modification_date": 1653710768,
    "files": {
        "pdf": "https://archive.orkl.eu/2cc9e69bc0ba0ed3ab6d85def4d5a64c8e691057.pdf",
        "text": "https://archive.orkl.eu/2cc9e69bc0ba0ed3ab6d85def4d5a64c8e691057.txt",
        "img": "https://archive.orkl.eu/2cc9e69bc0ba0ed3ab6d85def4d5a64c8e691057.jpg"
    }
}