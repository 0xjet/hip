{
    "id": "02a0e28b-5706-47d6-9913-2f58e0d7b295",
    "created_at": "2022-10-25T16:48:15.059928Z",
    "updated_at": "2025-03-27T02:16:14.186915Z",
    "deleted_at": null,
    "sha1_hash": "a2c44d6f87fc6ec9067b543489eda3e5212a92f6",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-07-02T15:58:49Z",
    "file_modification_date": "2019-07-02T15:58:49Z",
    "file_size": 987829,
    "plain_text": "# 奇安信威胁情报中⼼\n\n**[ti.qianxin.com/blog/articles/analysis-of-muddyc3-a-new-weapon-used-by-muddywater](https://ti.qianxin.com/blog/articles/analysis-of-muddyc3-a-new-weapon-used-by-muddywater/)**\n\n## Background\n\nIn early May of this year, hackers claimed in the Telegram channel (Channel:\nGreenLeakers) that they possess attack evidence and information regarding the\nMuddyWater APT group for sale.\n\nMuddyWater is widely regarded as a long-lived APT group in the Middle East. From\nFebruary to April 2019, it launched a series of spear-phishing attacks against\ngovernments, educational institutions, financial, telecommunications and defense\ncompanies in Turkey, Iran, Afghanistan, Iraq, Tajikistan and Azerbaijan.\n\nImage of the web control server:\n\nAs well as its own infiltration tool, which is named as muddyc3 from the banner with\nversion number 1.0.0.\n\n\n-----\n\nYesterday (June 24) another telegram channel leaked the source code of muddyc3 and\nconducted related auctions.\n\nLater on, security researchers also posted related malicious samples and decompiled\nsource code with the same version on Github https://github.com/0xffff0800/muddyc3.\n\n## Analysis\n\nAfter acquiring related information, we found two samples named as muddyc3.exe.\n\n## Decompile\n\nWe found that one of the samples, with version v1.0.1, is generated by PyInstaller in x64\nenvironment.\n\nWe extracted the pyc and fixed the magic information in the header to perform\ndecompilation by Easy Python Decompiler and uncompyle6. Related build environment\nis Python 2.7 and we get the following decompiled files after removing related libraries:\n\n\n-----\n\n## Code Analysis\n\nVersions 1.0.1 and 1.0.0 are only slightly different on the code level. The following\npicture shows the screenshot of the portal interface:\n\n\n-----\n\nFirst need to specify C&C server IP and port, and related proxy IP when needed.\n\nIt supports four commands: list, show, use and payload. However, the show command\ndoes not have related processing logic in the code.\n\nIt also lists some examples of the initial attack payload implementations. The initial script\npayload code can be embedded in a document as macro. When the target triggers the\nexecution, it will access the C2 with the specified path.\n\nThe main body of the tool is a server based script web.py, which is used to process\nrequest from client and provide response. URL paths for v1.0.0 and v1.0.1 are\nsomewhat different.\n\n\n-----\n\nV1.0.0\n\nV1.0.1\nIt supports delivering the next stage payload such as sct, hta, and powershell, uploading,\ndownloading, information collection, as well as supported modules.\n\nSince the packaged program does not contain the default Powershell payload code, we\ndo not know what will be delivered in the next.\n\nHere we try to access the root path:\n\nAs well as the /hta path:\n\n\n-----\n\nIt performs simple character substitution and base64 encoding:\n\n## Conclusion\n\nConsidering the completeness of the decompiled control program, it should be an earlier\nversion used by MuddyWater which could serve as a prototype for a post-infiltration\nframework.\n\nThe RedDrip team of the QiAnXin Threat Intelligence Center will continue paying\nattention to the progress of relevant events.\n\n## IOC\n\ndaa7d4c40ffaa6cf4e4708747d3a9b37\n\n146cc97df36cb4cea39074652d069519\n\n## Reference\n\nhttps://github.com/kennethreitz-archive/pyinstaller/blob/master/ArchiveViewer.py\n\nhttps://github.com/countercept/python-exe-unpacker\n\nhttps://blog.trendmicro.com/trendlabs-security-intelligence/muddywater-resurfaces-usesmulti-stage-backdoor-powerstats-v3-and-new-post-exploitation-tools/\n\nMUDDYWATER MUDDYC3\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.06.25.MuddyC3/MuddyC3.pdf"
    ],
    "report_names": [
        "MuddyC3"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1562083129,
    "ts_modification_date": 1562083129,
    "files": {
        "pdf": "https://archive.orkl.eu/a2c44d6f87fc6ec9067b543489eda3e5212a92f6.pdf",
        "text": "https://archive.orkl.eu/a2c44d6f87fc6ec9067b543489eda3e5212a92f6.txt",
        "img": "https://archive.orkl.eu/a2c44d6f87fc6ec9067b543489eda3e5212a92f6.jpg"
    }
}