{
    "id": "7f5a70a3-6c3a-4f49-a012-2cf9d16079ab",
    "created_at": "2023-01-12T15:06:28.048047Z",
    "updated_at": "2025-03-27T02:15:26.209868Z",
    "deleted_at": null,
    "sha1_hash": "a23ad151f2932915298a5b14067613b8552d14d1",
    "title": "2022-06-13 - The many lives of BlackCat ransomware",
    "authors": "",
    "file_creation_date": "2022-06-18T23:18:08Z",
    "file_modification_date": "2022-06-18T23:18:08Z",
    "file_size": 792182,
    "plain_text": "# The many lives of BlackCat ransomware\n\n**[microsoft.com/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/](https://www.microsoft.com/security/blog/2022/06/13/the-many-lives-of-blackcat-ransomware/)**\n\nJune 13, 2022\n\n[The BlackCat ransomware, also known as ALPHV, is a prevalent threat and a prime](https://www.varonis.com/blog/alphv-blackcat-ransomware)\n[example of the growing ransomware-as-a-service (RaaS) gig economy. It’s noteworthy due](https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/)\nto its unconventional programming language (Rust), multiple target devices and possible\nentry points, and affiliation with prolific threat activity groups. While BlackCat’s arrival and\nexecution vary based on the actors deploying it, the outcome is the same—target data is\nencrypted, exfiltrated, and used for “double extortion,” where attackers threaten to release\nthe stolen data to the public if the ransom isn’t paid.\n\nFirst observed in November 2021, BlackCat initially made headlines because it was one of\nthe first ransomware families written in the Rust programming language. By using a modern\nlanguage for its payload, this ransomware attempts to evade detection, especially by\nconventional security solutions that might still be catching up in their ability to analyze and\nparse binaries written in such language. BlackCat can also target multiple devices and\noperating systems. Microsoft has observed successful attacks against Windows and Linux\ndevices and VMWare instances.\n\n\n-----\n\n[As we previously explained, the RaaS affiliate model consists of multiple players: access](https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/#ransomware-as-a-sevice-incidents)\nbrokers, who compromise networks and maintain persistence; RaaS operators, who develop\ntools; and RaaS affiliates, who perform other activities like moving laterally across the\nnetwork and exfiltrating data before ultimately launching the ransomware payload. Thus, as a\nRaaS payload, how BlackCat enters a target organization’s network varies, depending on the\nRaaS affiliate that deploys it. For example, while the common entry vectors for these threat\nactors include remote desktop applications and compromised credentials, we also saw a\n[threat actor leverage Exchange server vulnerabilities to gain target network access. In](https://msrc-blog.microsoft.com/2021/03/16/guidance-for-responders-investigating-and-remediating-on-premises-exchange-server-vulnerabilities/)\n[addition, at least two known affiliates are now adopting BlackCat: DEV-0237 (known for](https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/#DEV-0237)\n[previously deploying Ryuk, Conti, and Hive) and DEV-0504 (previously deployed Ryuk,](https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/#DEV-0504)\nREvil, BlackMatter, and Conti).\n\nSuch variations and adoptions markedly increase an organization’s risk of encountering\nBlackCat and pose challenges in detecting and defending against it because these actors\nand groups have different tactics, techniques, and procedures (TTPs). Thus, no two\nBlackCat “lives” or deployments might look the same. Indeed, based on Microsoft threat\ndata, the impact of this ransomware has been noted in various countries and regions in\nAfrica, the Americas, Asia, and Europe.\n\n[Human-operated ransomware attacks like those that deploy BlackCat continue to evolve and](https://www.microsoft.com/security/blog/2020/03/05/human-operated-ransomware-attacks-a-preventable-disaster/)\nremain one of the attackers’ preferred methods to monetize their attacks. Organizations\nshould consider complementing their security best practices and policies with a\n[comprehensive solution like Microsoft 365 Defender, which offers protection capabilities that](https://www.microsoft.com/security/business/threat-protection/microsoft-365-defender)\ncorrelate various threat signals to detect and block such attacks and their follow-on activities.\n\nIn this blog, we provide details about the ransomware’s techniques and capabilities. We also\ntake a deep dive into two incidents we’ve observed where BlackCat was deployed, as well as\nadditional information about the threat activity groups that now deliver it. Finally, we offer best\npractices and recommendations to help defenders protect their organizations against this\nthreat, including hunting queries and product-specific mitigations.\n\n## BlackCat’s anatomy: Payload capabilities\n\nAs mentioned earlier, BlackCat is one of the first ransomware written in the Rust\nprogramming language. Its use of a modern language exemplifies a recent trend where\nthreat actors switch to languages like Rust or Go for their payloads in their attempt to not\nonly avoid detection by conventional security solutions but also to challenge defenders who\nmay be trying to reverse engineer the said payloads or compare them to similar threats.\n\nBlackCat can target and encrypt Windows and Linux devices and VMWare instances. It has\nextensive capabilities, including self-propagation configurable by an affiliate for their usage\nand to environment encountered.\n\n\n-----\n\nIn the instances we ve observed where the BlackCat payload did not have administrator\nprivileges, the payload was launched via dllhost.exe, which then launched the following\ncommands below (Table 1) via cmd.exe. These commands could vary, as the BlackCat\npayload allows affiliates to customize execution to the environment.\n\nThe flags used by the attackers and the options available were the following: -s -d -f -c; –\n_access-token; –propagated; -no-prop-servers_\n\nFigure 1. BlackCat payload deployment options\n\n**Command** **Description**\n\n[service name] /stop Stops running services\nto allow encryption of\ndata\n\nvssadmin.exe Delete Shadows /all /quiet Deletes backups to\nprevent recovery\n\nwmic.exe Shadowcopy Delete Deletes shadow copies\n\n\n-----\n\nwmic csproduct get UUID Gets the Universally\nUnique Identifier\n(UUID) of the target\ndevice\n\n\nreg add\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\n\\LanmanServer\\Parameters /v MaxMpxCt /d 65535 /t\nREG_DWORD /f\n\nfor /F \\”tokens=*\\” %1 in (‘wevtutil.exe el’) DO wevtutil.exe cl\n\\”%1\\”\n\n\nModifies the registry to\nchange MaxMpxCt\nsettings; BlackCat does\nthis to increase the\nnumber of outstanding\nrequests allowed (for\nexample, SMB\nrequests when\ndistributing\nransomware via its\nPsExec methodology)\n\nClears event logs\n\n\n[fsutil behavior set SymlinkEvaluation R2L:1](https://docs.microsoft.com/windows-server/administration/windows-commands/fsutil-behavior) Allows remote-to-local\nsymbolic links; a\n[symbolic link is a file-](https://docs.microsoft.com/windows/win32/fileio/symbolic-links)\nsystem object (for\nexample, a file or\nfolder) that points to\nanother file system\nobject, like a shortcut in\nmany ways but more\npowerful\n\nfsutil behavior set SymlinkEvaluation R2R:1 Allows remote-toremote symbolic links\n\n\nnet use \\\\[computer name] /user:[domain]\\[user] [password]\n/persistent:no\n\nTable 1. List of commands the BlackCat payload can run\n\n### User account control (UAC) bypass\n\n\nMounts network share\n\n\nBlackCat can bypass UAC, which means the payload will successfully run even if it runs from\na non-administrator context. If the ransomware isn’t run with administrative privileges, it runs\na secondary process under dllhost.exe with sufficient permissions needed to encrypt the\nmaximum number of files on the system.\n\n### Domain and device enumeration\n\n\n-----\n\nThe ransomware can determine the computer name of the given system, local drives on a\ndevice, and the AD domain name and username on a device. The malware can also identify\nwhether a user has domain admin privileges, thus increasing its capability of ransoming\nmore devices.\n\n### Self-propagation\n\nBlackCat discovers all servers that are connected to a network. The process first broadcasts\nNetBIOS Name Service (NBNC) messages to check for these additional devices. The\nransomware then attempts to replicate itself on the answering servers using the credentials\nspecified within the config via PsExec.\n\n### Hampering recovery efforts\n\nBlackCat has numerous methods to make recovery efforts more difficult. The following are\ncommands that might be launched by the payload, as well as their purposes:\n\nModify boot loader\n\n“C:\\Windows\\system32\\cmd.exe” /c “bcdedit /set {default}”\n“C:\\Windows\\system32\\cmd.exe” /c “bcdedit /set {default} recoveryenabled No”\nDelete volume shadow copies\n\n“C:\\Windows\\system32\\cmd.exe” /c “vssadmin.exe Delete Shadows /all /quiet”\n“C:\\Windows\\system32\\cmd.exe” /c “wmic.exe Shadowcopy Delete”\nClear Windows event logs\n\n“C:\\Windows\\system32\\cmd.exe” /c “cmd.exe /c for /F \\”tokens=*\\” Incorrect\nfunction. in (‘ wevtutil.exe el ‘) DO wevtutil.exe cl \\”Incorrect function. \\””\n\n## Slinking its way in: Identifying attacks that can lead to BlackCat ransomware\n\nConsistent with the RaaS model, threat actors utilize BlackCat as an additional payload to\ntheir ongoing campaigns. While their TTPs remain largely the same (for example, using tools\nlike Mimikatz and PsExec to deploy the ransomware payload), BlackCat-related\ncompromises have varying entry vectors, depending on the ransomware affiliate conducting\nthe attack. Therefore, the pre-ransom steps of these attacks can also be markedly different.\n\nFor example, our research noted that one affiliate that deployed BlackCat leveraged\nunpatched Exchange servers or used stolen credentials to access target networks. The\nfollowing sections detail the end-to-end attack chains of these two incidents we’ve observed.\n\n### Case study 1: Entry via unpatched Exchange\n\nIn one incident we’ve observed, attackers took advantage of an unpatched Exchange server\nto enter the target organization.\n\n\n-----\n\nFigure 2. Observed BlackCat ransomware attack chain via Exchange vulnerability\nexploitation\n\n**Discovery**\n\nUpon exploiting the Exchange vulnerability, the attackers launched the following discovery\ncommands to gather information about the device they had compromised:\n\n_[cmd.exe and the commands ver and](https://ss64.com/nt/ver.html)_ _[systeminfo – to collect operating system](https://docs.microsoft.com/windows-server/administration/windows-commands/systeminfo)_\ninformation\n_[net.exe – to determine domain computers, domain controllers, and domain admins in](https://ss64.com/nt/net.html)_\nthe environment\n\nAfter executing these commands, the attackers navigated through directories and discovered\na passwords folder that granted them access to account credentials they could use in the\nsubsequent stages of the attack. They also used the del command to delete files related to\ntheir initial compromise activity.\n\nThe attackers then mounted a network share using net use and the stolen credentials and\nbegan looking for potential lateral movement targets using a combination of methods. First,\n[they used WMIC.exe using the previously gathered device name as the node, launched the](https://ss64.com/nt/wmic.html)\ncommand _[whoami /all, and pinged google.com to check network connectivity. The output of](https://docs.microsoft.com/windows-server/administration/windows-commands/whoami)_\nthe results were then written to a .log file on the mounted share. Second, the attackers used\n_PowerShell.exe with the cmdlet_ _[Get-ADComputer and a filter to gather the last sign-in event.](https://docs.microsoft.com/powershell/module/activedirectory/get-adcomputer?view=windowsserver2022-ps)_\n\n**Lateral movement**\n\n\n-----\n\nTwo and a half days later, the attackers signed into one of the target devices they found\nduring their initial discovery efforts using compromised credentials via interactive sign-in.\nThey opted for a credential theft technique that didn’t require dropping a file like Mimikatz\nthat antivirus products might detect. Instead, they opened Taskmgr.exe, created a dump file\nof the _[LSASS.exe process, and saved the file to a ZIP archive.](https://adsecurity.org/?p=462)_\n\nThe attackers continued their previous discovery efforts using a PowerShell script version of\nADRecon (ADRecon.ps1), which is a tool designed to gather extensive information about an\nActive Directory (AD) environment. The attacker followed up this action with a net scanning\ntool that opened connections to devices in the organization on server message block (SMB)\nand remote desktop protocol (RDP). For discovered devices, the attackers attempted to\n[navigate to various network shares and used the Remote Desktop client (mstsc.exe) to sign](https://docs.microsoft.com/windows-server/administration/windows-commands/mstsc)\ninto these devices, once again using the compromised account credentials.\n\nThese behaviors continued for days, with the attackers signing into numerous devices\nthroughout the organization, dumping credentials, and determining what devices they could\naccess.\n\n**Collection and exfiltration**\n\nOn many of the devices the attackers signed into, efforts were made to collect and exfiltrate\nextensive amounts of data from the organization, including domain settings and information\nand intellectual property. To do this, the attackers used both MEGAsync and Rclone, which\nwere renamed as legitimate Windows process names (for example, winlogon.exe,\n_mstsc.exe)._\n\n**Exfiltration of domain information to identify targets for lateral movement**\n\nCollecting domain information allowed the attackers to progress further in their attack\nbecause the said information could identify potential targets for lateral movement or those\nthat would help the attackers distribute their ransomware payload. To do this, the attackers\nonce again used ADRecon.ps1with numerous PowerShell cmdlets such as the following:\n\n_Get-ADRGPO – gets group policy objects (GPO) in a domain_\n_Get-ADRDNSZone – gets all DNS zones and records in a domain_\n_Get-ADRGPLink – gets all group policy links applied to a scope of management in a_\ndomain\n\nAdditionally, the attackers dropped and used ADFind.exe commands to gather information\non persons, computers, organizational units, and trust information, as well as pinged dozens\nof devices to check connectivity.\n\n**Exfiltration for double extortion**\n\n\n-----\n\nIntellectual property theft likely allowed the attackers to threaten the release of information if\nthe subsequent ransom wasn’t paid—a practice known as “double extortion.” To steal\nintellectual property, the attackers targeted and collected data from SQL databases. They\nalso navigated through directories and project folders, among others, of each device they\ncould access, then exfiltrated the data they found in those.\n\nThe exfiltration occurred for multiple days on multiple devices, which allowed the attackers to\ngather large volumes of information that they could then use for double extortion.\n\n**Encryption and ransom**\n\nIt was a full two weeks from the initial compromise before the attackers progressed to\nransomware deployment, thus highlighting the need for triaging and scoping out alert activity\nto understand accounts and the scope of access an attacker gained from their activity.\n[Distribution of the ransomware payload using PsExec.exe proved to be the most common](https://docs.microsoft.com/sysinternals/downloads/psexec)\nattack method.\n\nFigure 3. Ransom note displayed by BlackCat upon successful infection\n\n### Case study 2: Entry via compromised credentials\n\n\n-----\n\nIn another incident we observed, we found that a ransomware affiliate gained initial access to\nthe environment via an internet-facing Remote Desktop server using compromised\ncredentials to sign in.\n\nFigure 4. Observed BlackCat ransomware attack chain via stolen credentials\n\n**Lateral movement**\n\nOnce the attackers gained access to the target environment, they then used SMB to copy\nover and launch the Total Deployment Software administrative tool, allowing remote\nautomated software deployment. Once this tool was installed, the attackers used it to install\nScreenConnect (now known as ConnectWise), a remote desktop software application.\n\n**Credential theft**\n\nScreenConnect was used to establish a remote session on the device, allowing attackers\ninteractive control. With the device in their control, the attackers used cmd.exe to update the\nRegistry to allow cleartext authentication via WDigest, and thus saved the attackers time by\nnot having to crack password hashes. Shortly later, they used the Task Manager to dump the\n_LSASS.exe process to steal the password, now in cleartext._\n\nEight hours later, the attackers reconnected to the device and stole credentials again. This\ntime, however, they dropped and launched Mimikatz for the credential theft routine, likely\nbecause it can grab credentials beyond those stored in LSASS.exe. The attackers then\nsigned out.\n\n**Persistence and encryption**\n\nA day later, the attackers returned to the environment using ScreenConnect. They used\nPowerShell to launch a command prompt process and then added a user account to the\ndevice using net.exe. The new user was then added to the local administrator group via\n_net.exe._\n\n\n-----\n\nAfterward, the attackers signed in using their newly created user account and began\ndropping and launching the ransomware payload. This account would also serve as a means\nof additional persistence beyond ScreenConnect and their other footholds in the environment\nto allow them to re-establish their presence, if needed. Ransomware adversaries are not\nabove ransoming the same organization twice if access is not fully remediated.\n\n_Chrome.exe was used to navigate to a domain hosting the BlackCat payload. Notably, the_\nfolder structure included the organization name, indicating that this was a pre-staged payload\nspecifically for the organization. Finally, the attackers launched the BlackCat payload on the\ndevice to encrypt its data.\n\n## Ransomware affiliates deploying BlackCat\n\nApart from the incidents discussed earlier, we’ve also observed two of the most prolific\naffiliate groups associated with ransomware deployments have switched to deploying\nBlackCat. Payload switching is typical for some RaaS affiliates to ensure business continuity\nor if there’s a possibility of better profit. Unfortunately for organizations, such adoption further\nadds to the challenge of detecting related threats.\n\n[Microsoft tracks one of these affiliate groups as DEV-0237. Also known as FIN12, DEV-0237](https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/#DEV-0237)\nis notable for its distribution of Hive, Conti, and Ryuk ransomware. We’ve observed that this\ngroup added BlackCat to their list of distributed payloads beginning March 2022. Their switch\nto BlackCat from their last used payload (Hive) is suspected to be due to the public discourse\naround the latter’s decryption methodologies.\n\n[DEV-0504 is another active affiliate group that we’ve seen switching to BlackCat for their](https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/#DEV-0504)\nransomware attacks. Like many RaaS affiliate groups, the following TTPs might be observed\nin a DEV-0504 attack:\n\nEntry vector that can involve the affiliate remotely signing into devices with\ncompromised credentials, such as into devices running software solutions that allow for\nremote work\nThe attackers’ use of their access to conduct discovery on the domain\nLateral movement that potentially uses the initial compromised account\nCredential theft with tools like Mimikatz and Rubeus\n\nDEV-0504 typically exfiltrates data on devices they compromise from the organization using\n[a malicious tool such as StealBit—often named “send.exe” or “sender.exe”. PsExec is then](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/Stealbit.STA!sms&ThreatID=2147797825)\nused to distribute the ransomware payload. The group has been observed delivering the\nfollowing ransom families before their adoption of BlackCat beginning December 2021:\n\nBlackMatter\nConti\nLockBit 2.0\n\n\n-----\n\nRevil\nRyuk\n\n## Defending against BlackCat ransomware\n\nToday’s ransomware attacks have become more impactful because of their growing\nindustrialization through the RaaS affiliate model and the increasing trend of double\nextortion. The incidents we’ve observed related to the BlackCat ransomware leverage these\ntwo factors, making this threat durable against conventional security and defense\napproaches that only focus on detecting the ransomware payloads. Detecting threats like\nBlackCat, while good, is no longer enough as human-operated ransomware continues to\ngrow, evolve, and adapt to the networks they’re deployed or the attackers they work for.\n\nInstead, organizations must shift their defensive strategies to prevent the end-to-end attack\nchain. As noted above, while attackers’ entry points may vary, their TTPs remain largely the\nsame. In addition, these types of attacks continue to take advantage of an organization’s\npoor credential hygiene and legacy configurations or misconfigurations to succeed.\nTherefore, defenders should address these common paths and weaknesses by hardening\ntheir networks through various best practices such as access monitoring and proper patch\nmanagement. We provide detailed steps on building these defensive strategies against\n[ransomware in this blog.](https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/#defending-against-ransomware)\n\nIn the BlackCat-related incidents we’ve observed, the common entry points for ransomware\naffiliates were via compromised credentials to access internet-facing remote access software\nand unpatched Exchange servers. Therefore, defenders should review their organization’s\nidentity posture, carefully monitor external access, and locate vulnerable Exchange servers\nin their environment to update as soon as possible. The financial impact, reputation damage,\nand other repercussions that stem from attacks involving ransomware like BlackCat are not\nworth forgoing downtime, service interruption, and other pain points related to applying\nsecurity updates and implementing best practices.\n\n### Leveraging Microsoft 365 Defender’s comprehensive threat defense capabilities\n\n[Microsoft 365 Defender helps protect organizations from attacks that deliver the BlackCat](https://www.microsoft.com/security/business/threat-protection/microsoft-365-defender)\nransomware and other similar threats by providing cross-domain visibility and coordinated\nthreat defense. It uses multiple layers of dynamic protection technologies and correlates\n[threat data from email, endpoints, identities, and cloud apps. Microsoft Defender for Endpoint](https://www.microsoft.com/security/business/threat-protection/endpoint-defender)\ndetects tools like Mimikatz, the actual BlackCat payload, and subsequent attacker behavior.\n[Threat and vulnerability management capabilities also help discover vulnerable or](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/next-gen-threat-and-vuln-mgt?view=o365-worldwide)\nmisconfigured devices across different platforms; such capabilities could help detect and\nblock possible exploitation attempts on vulnerable devices, such as those running Exchange.\nFinally, [advanced hunting lets defenders create custom detections to proactively surface this](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/advanced-hunting-overview?view=o365-worldwide)\nransomware and other related threats.\n\n\n-----\n\n### Additional mitigations and recommendations\n\nDefenders can also follow the following steps to reduce the impact of this ransomware:\n\nTurn on [Microsoft Defender Antivirus. Turn on](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-antivirus-windows) [cloud-delivered protection in Microsoft](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/configure-block-at-first-sight-microsoft-defender-antivirus?view=o365-worldwide)\nDefender Antivirus or the equivalent for your antivirus product to cover rapidly evolving\nattacker tools and techniques. Cloud-based machine learning protections block a large\namount of new and unknown variants.\nEnforce strong, randomized local administrator passwords. Use tools like Local\nAdministrator Password Solution (LAPS).\n[Require multifactor authentication (MFA) for local device access, RDP access, and](https://www.microsoft.com/security/business/identity/mfa)\nremote connections through virtual private networks (VPNs) and Outlook Web Access.\n[Solutions like Windows Hello or](https://docs.microsoft.com/windows/security/identity-protection/hello-for-business/hello-how-it-works?ocid=cx-ti-1p) [Fast ID Online (FIDO) v2.0 security keys let users sign](https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-authentication-passwordless)\nin using biometrics and/or a physical key or device.\nTurn on [Microsoft Defender Firewall.](https://support.microsoft.com/windows/turn-microsoft-defender-firewall-on-or-off-ec0844f7-aebd-0583-67fe-601ecf5d774f)\n[Implement controlled folder access to help prevent files from being altered or encrypted](https://support.microsoft.com/topic/ransomware-protection-in-windows-security-445039d6-537a-488a-ad53-48906f346363)\n[by ransomware. Set controlled folder access to Enabled or Audit mode.](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/enable-controlled-folders?view=o365-worldwide)\n[Investigate and remediate vulnerabilities in Exchange servers. Also, determine if](https://msrc-blog.microsoft.com/2021/03/16/guidance-for-responders-investigating-and-remediating-on-premises-exchange-server-vulnerabilities/)\n[implementing the Exchange Emergency Mitigation service is feasible for your](https://docs.microsoft.com/exchange/exchange-emergency-mitigation-service?view=exchserver-2019)\nenvironment. This service helps keep your Exchange servers secure by applying\nmitigations to address potential threats against your servers.\n\nMicrosoft 365 Defender customers can also apply the additional mitigations below:\n\nUse [advanced protection against ransomware.](https://docs.microsoft.com/Microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?view=o365-worldwide#use-advanced-protection-against-ransomware)\nTurn on [tamper protection in Microsoft Defender for Endpoint to prevent malicious](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/prevent-changes-to-security-settings-with-tamper-protection?view=o365-worldwide)\n[changes to security settings. Enable network protection in Microsoft Defender for](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/network-protection?view=o365-worldwide)\nEndpoint and Microsoft 365 Defender to prevent applications or users from accessing\nmalicious domains and other malicious content on the internet.\nEnsure Exchange servers have applied the mitigations referenced in the related Threat\nAnalytics report.\n[Turn on the following attack surface reduction rules to block or audit activity associated](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction)\nwith this threat:\n\nBlock credential stealing from the Windows local security authority subsystem\n(lsass.exe)\nBlock process creations originating from PSExec and WMI commands\nBlock executable files from running unless they meet a prevalence, age, or\ntrusted list criterion\n\nFor a full list of ransomware mitigations regardless of threat, refer to this article: Rapidly\nprotect against ransomware and extortion.\n\nLearn how you can stop attacks through automated, cross-domain security and built-in AI\nwith Microsoft Defender 365.\n\n\n-----\n\n**_Microsoft 365 Defender Threat Intelligence Team_**\n\n## Appendix\n\n### Microsoft 365 Defender detections\n\n**Microsoft Defender Antivirus**\n\n**Microsoft Defender for Endpoint EDR**\n\nAlerts with the following titles in the security center can indicate threat activity on your\nnetwork:\n\nAn active ‘BlackCat’ ransomware was detected\n‘BlackCat’ ransomware was detected\nBlackCat ransomware\n\n### Hunting queries\n\n**Microsoft 365 Defender**\n\nTo locate possible ransomware activity, run the following queries.\n\n**Suspicious process execution in PerfLogs path**\n\nUse this query to look for processes executing in PerfLogs—a common path used to place\nthe ransomware payloads.\n```\nDeviceProcessEvents\n| where InitiatingProcessFolderPath has \"PerfLogs\"\n| where InitiatingProcessFileName matches regex \"[a-z]{3}.exe\"\n| extend Length = strlen(InitiatingProcessFileName)\n| where Length == 7\n\n```\n**Suspicious registry modification of MaxMpxCt parameters**\n\nUse this query to look for suspicious running processes that modify registry settings to\nincrease the number of outstanding requests allowed (for example, SMB requests when\ndistributing ransomware via its PsExec methodology).\n```\nDeviceProcessEvents\n| where ProcessCommandLine has_all(\"LanmanServer\", \"parameters\", \"MaxMpxCt\", \"65535\")\n\n```\n**Suspicious command line indicative of BlackCat ransom payload execution**\n\nUse these queries to look for instances of the BlackCat payload executing based on a\nrequired command argument for it to successfully encrypt ‘–access-token’.\n\n\n-----\n\n```\nDeviceProcessEvents\n| where ProcessCommandLine has_all(\"--access-token\", \"-v\") \n| extend CommandArguments = split(ProcessCommandLine, \" \")\n| mv-expand CommandArguments\n| where CommandArguments matches regex \"^[A-Fa-f0-9]{64}$\"\nDeviceProcessEvents\n| where InitiatingProcessCommandLine has \"--access-token\"\n| where ProcessCommandLine has \"get uuid\"\n\n```\n**Suspected data exfiltration**\n\nUse this query to look for command lines that indicate data exfiltration and the indication that\nan attacker may attempt double extortion.\n```\nDeviceNetworkEvents\n| where InitiatingProcessCommandLine has_all(\"copy\", \"--max-age\", \"--ignoreexisting\", \"--multi-thread-streams\", \"--transfers\") and InitiatingProcessCommandLine\nhas_any(\"ftp\", \"ssh\", \"-q\")\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-13 - The many lives of BlackCat ransomware.pdf"
    ],
    "report_names": [
        "2022-06-13 - The many lives of BlackCat ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "a2d3f35f-3b29-4509-bff5-af2638140d39",
            "created_at": "2022-10-25T16:07:23.633982Z",
            "updated_at": "2025-03-27T02:02:09.898653Z",
            "deleted_at": null,
            "main_name": "FIN12",
            "aliases": [],
            "source_name": "ETDA:FIN12",
            "tools": [
                "Agentemis",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "KEGTAP",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "76e1fb02-1ceb-4fe5-8a68-456f0d4c62a4",
            "created_at": "2024-02-02T02:00:04.037062Z",
            "updated_at": "2025-03-27T02:00:03.295909Z",
            "deleted_at": null,
            "main_name": "Velvet Tempest",
            "aliases": [
                "DEV-0504"
            ],
            "source_name": "MISPGALAXY:Velvet Tempest",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535988,
    "ts_updated_at": 1743041726,
    "ts_creation_date": 1655594288,
    "ts_modification_date": 1655594288,
    "files": {
        "pdf": "https://archive.orkl.eu/a23ad151f2932915298a5b14067613b8552d14d1.pdf",
        "text": "https://archive.orkl.eu/a23ad151f2932915298a5b14067613b8552d14d1.txt",
        "img": "https://archive.orkl.eu/a23ad151f2932915298a5b14067613b8552d14d1.jpg"
    }
}