{
    "id": "ea914755-fb84-466c-bd6e-61ec879d444e",
    "created_at": "2023-01-12T14:59:23.04294Z",
    "updated_at": "2025-03-27T02:05:50.095895Z",
    "deleted_at": null,
    "sha1_hash": "957b03e24c45ae1c290c9c460e236c2f5ef3d3a9",
    "title": "2014-10-06 - Data Theft in Aisle 9- A FireEye Look at Threats to Retailers",
    "authors": "",
    "file_creation_date": "2022-05-29T01:12:54Z",
    "file_modification_date": "2022-05-29T01:12:54Z",
    "file_size": 80540,
    "plain_text": "# Data Theft in Aisle 9: A FireEye Look at Threats to Retailers\n\n**[fireeye.com/blog/threat-research/2014/10/data-theft-in-aisle-9-a-fireeye-look-at-threats-to-retailers.html](https://www.fireeye.com/blog/threat-research/2014/10/data-theft-in-aisle-9-a-fireeye-look-at-threats-to-retailers.html)**\n\nWhile cybercriminals continue to target the payment card and banking information of\nindividual users, they seem increasingly aware that compromising retailers is more lucrative.\n[Targeting retailers is not new; Albert Gonzales infamously targeted retailers nearly a decade](http://www.nytimes.com/2010/11/14/magazine/14Hacker-t.html?_r=0)\nago. What has changed, however, is the wide availability of tools and know-how that make it\npossible for even relatively unskilled cybercriminals to commit large-scale attacks. The\nresults speak for themselves – significant breaches at retailers have increased over the last\n[few years, and the trend continues. In fact, the Verizon Data Breach Investigations Report](http://www.verizonenterprise.com/DBIR/2014/)\ncalled 2014 the “year of the retailer breach” due to the number of large-scale attacks.\n\nNot only are breaches at retailers occurring more regularly, FireEye researchers have\nnoticed another startling new trend: while much of this activity is not initially targeted in\n[nature, it can easily transition to a targeted attack when the attackers realize the value of the](https://dl.mandiant.com/EE/library/WP_M-Trends2014_140409.pdf)\nnetwork they have compromised. The convergence of the wide availability of malware tools\nspecifically built for point-of-sale (POS) systems and indiscriminate botnets, combined with\ntargeted attack activity, suggest that network defenders struggle to determine the levels of\nthreat severity and adversary sophistication. Simply put: What may initially seem like a\n“simple” crimeware infection may actually be a vector through which targeted actors can\npurchase or rent access to their victims\n\n\n-----\n\n## POS Malware: A History Lesson\n\nSince 2013 we have seen a dramatic increase in the number of malware threats specifically\nfocused on POS systems. This uptick is like any other market dynamic — there’s a lot of data\nresiding in retailers’ networks, and threat actors are adapting and evolving to take advantage\nof what’s at stake. Robust underground markets and an enterprise-like cyber criminal\necosystem enable threat actors to develop and trade their wares. What follows is a summary\nof some of the most major POS malware families and their similarities:\n\nBackoff POS – The Backoff attacks were publicly disclosed in July 2014 but the\ncampaign itself was active in October 2013. The attackers reportedly brute forced\nremote desktop servers and installed the Backoff malware. Backoff is capable of\nextracting payment card data by scraping memory, and exfiltrating data over HTTP.\nBackoff’s Command-and-Control (C2) servers are connected to servers used to host\n[Zeus, SpyEye and Citadel, suggesting Backoff may be connected to a broader series](https://www.us-cert.gov/ncas/alerts/TA14-212A)\nof attacks.\n\nBrutPOS – The BrutPOS malware was documented in July 2014. This botnet scans\nspecified ranges of IP addresses for remote desktop servers and if a POS system is\nfound, the attackers may deploy another variant that scans the memory of running\n[processes to extract payment card information. BrutPOS exfiltrates data over FTP.](https://www.fireeye.com/blog/threat-research/2014/07/brutpos-rdp-bruteforcing-botnet-targeting-pos-systems.html)\n\nSoraya – The Soraya POS malware was disclosed in June 2014. It iterates through\nrunning processes and accesses memory to extract payment card data. Soraya also\nhas form-grabbing capabilities and exfiltrates data over HTTP.\n\nNemanja – The details of the Nemanja were disclosed in May 2014 and the botnet is\nbelieved to have been active throughout 2013. The attackers compromised an array of\nPOS machines worldwide running a variety of POS software. The attackers were\nreportedly directly engaged in the production of fake payment cards and money\nlaundering using mobile POS solutions.\n\nJackPOS – The JackPOS malware was reported in February 2014 and was reportedly\noriginally spread using “drive-by” download attacks. The malware, which appears to be\nsomewhat related to the Alina malware, is capable of scraping memory to acquire\npayment card data and exfiltrate it over HTTP. JackPOS is now widely available on\nunderground forums and is used by a variety of actors.\n\n[Decebal – The Decebal POS malware was first reported in January 2014. The malware](http://about-threats.trendmicro.com/us/malware/TSPY_DECBAL.A)\nenumerates running processes and extracts payment card information, which is then\nexfiltrated over HTTP.\n\n\n-----\n\nChewBacca – The ChewBacca malware was first disclosed in December 2013. This\nmalware enumerates running processes and accesses memory to extract information\nusing two regular expressions that match payment card data formats. This malware\nuses the [Tor anonymity network for data exfiltration.](http://securelist.com/blog/incidents/58192/chewbacca-a-new-episode-of-tor-based-malware/)\n\nBlackPOS – The [BlackPOS malware, sold on underground forums by an individual](http://www.pcworld.idg.com.au/article/457588/researchers_find_new_point-of-sale_malware_called_blackpos/)\nbelieved to be \"ree4,\" was first reported March 2013 and is now widely available. This\nmalware, which has a variant also known as KAPTOXA, scrapes memory to obtain\npayment card data. This data is typically transferred to a local staging point and then\nexfiltrated using FTP. The malware is best known for its reported role in several highly\npublicized breaches.\n\nAlina – The [Alina POS malware, first disclosed in February 2013, is believed to have](http://www.kernelmode.info/forum/viewtopic.php?f=16&t=1756&start=40#p18006)\nbeen [developed by the same actor, known as \"dice,\" who developed the Dexter POS](http://www.xylibox.com/2013/06/whos-behind-alina.html)\n[malware. This malware has been reportedly distributed via Citadel botnets. The Alina](http://www.xylibox.com/2013/10/inside-malware-campaign-alina-dexter.html)\nPOS malware iterates through running processes (except those on a blacklist) and\n[dumps the memory, looking for payment card data before exfiltrating it over HTTP.](http://blog.spiderlabs.com/2013/05/alina-shedding-some-light-on-this-malware-family.html)\nWhile this malware initially was used by a select few, it was subsequently sold on\nunderground forums.\n\nvSkimmer – The vSkimmer malware was first disclosed in January 2013. It is available\non a variety of [underground forums and is used by multiple threat actors. The malware](http://www.xylibox.com/2013/01/vskimmer.html)\niterates through running processes and accesses memory to extract payment card\ninformation. The data is exfiltrated over HTTP.\n\nDexter – The Dexter POS malware was first disclosed in December 2012 and is\nbelieved to have been developed by an actor known as \"dice,\" (who may also have\nbeen involved with the development of the Alina POS malware); the actual use of the\n[tool has been connected to an individual known as \"Rome0\". The malware iterates](http://www.arbornetworks.com/asert/wp-content/uploads/2013/12/Dexter-and-Project-Hook-Break-the-Bank.pdf)\nthrough running processes, accesses memory looking for payment card data, and\nexfiltrates it over HTTP.\n\nMost of these malware families use a similar approach of enumerating running processes\nand using pattern matching to extract payment card information from running processes.\nHowever, in at least one case, a BlackPOS variant was configured to only access a specific\nprocess. This not only makes it less noisy, but indicates that the attackers knew what\nprocess to target on the compromised system. This development, along with some\nhardcoded network paths and usernames, may indicate specific targeting by the attackers.\n\n## Indiscriminate vs. Targeted Attacks\n\nWhile some malware appears to have been used exclusively by particular threat actors,\nsome variants are now widely available. In many cases, it appears that the POS-specific\nmalware was used as a “second stage” attack, while the initial vector remains unclear. In the\n\n\n-----\n\ncase of Alina and BackOff, for example, the POS malware was connected to Citadel, Zeus\nand SpyEye botnets. While the details remain unclear, the attackers may be selling or trading\naccess to particular targets.\n\nIn other cases, the attackers appear to be much more specific with their targeting. One\nparticular threat group will engage in periods of reconnaissance for months before engaging\nwith the target. We also observed this group using SQL injection as an attack vector,\ndeploying POS-specific malware after moving laterally through the compromised network.\n\n## Conclusion\n\nThese developments challenge the traditional conceptions of risk when it comes to network\ndefense. While targeted attacks (including those associated with APT activity) can be tracked\nand clustered over time (by understanding the tools, techniques and procedures used by the\nthreat actors, as well as their timing, scope and targeting preferences), it is difficult to\nprioritize incidents that began indiscriminately and transitioned into targeted attack activity. Is\na simple, indiscriminate Zeus infection a noteworthy incident? Or will it pass largely\nunnoticed … only to transform into a significant breach?\n\n**Acknowledgements**\n\nWe would like to thank Kyle Wilhoit, Jen Weedon and Chris Nutt.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-10-06 - Data Theft in Aisle 9- A FireEye Look at Threats to Retailers.pdf"
    ],
    "report_names": [
        "2014-10-06 - Data Theft in Aisle 9- A FireEye Look at Threats to Retailers.pdf"
    ],
    "threat_actors": [
        {
            "id": "59c9f31b-e032-44b9-bf3b-4f2cb3d17e39",
            "created_at": "2022-10-25T16:07:23.734244Z",
            "updated_at": "2025-03-27T02:02:09.952685Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "APT-C-07",
                "Infy",
                "Operation Mermaid",
                "Prince of Persia"
            ],
            "source_name": "ETDA:Infy",
            "tools": [
                "Foudre",
                "Infy",
                "Tonnerre"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f763fd1f-f697-40eb-a082-df6fd3d13cb1",
            "created_at": "2023-01-06T13:46:38.561288Z",
            "updated_at": "2025-03-27T02:00:02.861874Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "Operation Mermaid",
                "Prince of Persia",
                "Foudre"
            ],
            "source_name": "MISPGALAXY:Infy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535563,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1653786774,
    "ts_modification_date": 1653786774,
    "files": {
        "pdf": "https://archive.orkl.eu/957b03e24c45ae1c290c9c460e236c2f5ef3d3a9.pdf",
        "text": "https://archive.orkl.eu/957b03e24c45ae1c290c9c460e236c2f5ef3d3a9.txt",
        "img": "https://archive.orkl.eu/957b03e24c45ae1c290c9c460e236c2f5ef3d3a9.jpg"
    }
}