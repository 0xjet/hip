{
    "id": "a638a233-019d-4056-b0e1-ad2f0e2f3dc6",
    "created_at": "2023-05-06T02:08:26.157969Z",
    "updated_at": "2025-03-27T02:13:57.309227Z",
    "deleted_at": null,
    "sha1_hash": "0a2f0e136a8a15c4d8b78d47c51e039939493b9d",
    "title": "2023-01-19 - Following the LNK metadata trail",
    "authors": "",
    "file_creation_date": "2023-05-05T01:48:08Z",
    "file_modification_date": "2023-05-05T01:48:08Z",
    "file_size": 2347744,
    "plain_text": "# Following the LNK metadata trail\n\n**[blog.talosintelligence.com/following-the-lnk-metadata-trail](https://blog.talosintelligence.com/following-the-lnk-metadata-trail)**\n\nGuilherme Venere January 19, 2023\n\nBy [Guilherme Venere](https://blog.talosintelligence.com/author/guilherme-venere/)\n\nThursday, January 19, 2023 08:01\n\nAdversaries’ shift toward Shell Link (LNK) files, likely sparked by Microsoft’s decision\nto block macros, provides the opportunity to capitalize on information that can be\nprovided by LNK metadata.\nCisco Talos analyzed metadata in LNK files and correlated it with threat actors tactics\ntechniques and procedures, to identify and track threat actor activity. This report\noutlines our research on Qakbot and Gamaredon as examples.\nTalos also used LNK file metadata to identify relationships among different threat\nactors. In this report we demonstrate this by using metadata to connect Bumblebee\nwith IcedID and Qakbot respectively.\n\n## Executive Summary\n\n[Microsoft announced at the beginning of 2022 that they would soon start to disable macros](https://docs.microsoft.com/en-gb/DeployOffice/security/internet-macros-blocked)\nby default in Office documents downloaded from the Internet. They implemented the\n[changes around June, only to remove the feature later that month. The feature was finally](https://techcrunch.com/2022/07/11/microsoft-office-macros-block/)\nre-enabled by the end of July. Cisco Talos observed threat actors reacting to these changes\nby moving away from malicious macros as an initial access method in favor of other types\nof executable attachments.\n\nWhile tracking some prevalent commodity malware threat actors, Talos observed the\npopularization of malicious LNK files as their initial access method to download and execute\npayloads. A closer look at the LNK files illustrates how their metadata could be used to\nidentify and track new campaigns.\n\n## An overview of LNK file format\n\nMicrosoft [describes the Shell Link binary file format - the format used by Windows files with](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943)\nthe extension \"LNK\" - as a file which contains information that can be used by the Operating\nSystem or an application to access another data object on the system. Although the format\nitself has applications supporting Object Linking and Embedding (OLE) object access, it is\nmore commonly used as “shortcuts” to applications and file locations on the file system.\n\n\n-----\n\nThe LNK structure stores information about the target object as well as other related\ninformation about the application behavior and metadata from the machine where the LNK\nfile was created. These metadata sections can contain optional data about various\nattributes of the target file. Among these attributes, a few provide valuable information to\nidentify the exact system where the file was created. Other researchers have published\n[some good information on the basic features present in LNK files so we won’t delve too](https://www.intezer.com/blog/malware-analysis/how-threat-actors-abuse-lnk-files/)\ndeep in the details, but the most important fields for our research are the following:\n\n**Modification/Access/Creation (MAC) timestamps: A FILETIME structure that**\nspecifies the MAC time of the LNK target in UTC.\n**VolumeID: An optional VolumeID structure that specifies information about the volume**\nwhere the link target was on when the link was created. Of special interest to analysts\nis the field DriveSerialNumber which is unique and can be associated with a specific\n**Disk Device.**\n**MachineID (16 bytes): A NULL–terminated character string, as defined by the system**\ndefault code page, which specifies the NetBIOS name of the machine where the link\ntarget was last known to reside.\n**DROID (CDomainRelativeObjId) GUID: Two values in GUID packet representation**\nwhich are used to indicate the location of the link target. There are different values for\nthe Volume identifier as well as the File identifier. The last section of the File identifier\nis generated based on the MAC Address of the machine where the file resides, which\nis another important correlation data.\n**DROID Birth GUID: The same as the field above, but stores the location where the**\nLNK file originally pointed to. Together with DROID GUID these two fields could\nindicate if a LNK file was moved to a different system after creation.\n**Metadata Store structure: Extra structures of attributes used to describe additional**\ndetails about the link target. Sometimes, when the target information is not present on\nthe LNK file, we might need to look at the Metadata Store structure for additional data.\nThe fields “ItemFolderPathDisplayNarrow”, “ParsingPath” and security identifier\n(“SID”) in this structure might provide valuable data to identify the LNK target as well\nas embedded payloads.\n\nIn order to extract these attributes, several tools are available in the public domain to parse\nand analyze the LNK structure. Google provides a free command line tool called “LNK\nParser”, which we are going to use in this blog to demonstrate the examples, but there are\n[other options like LeCMD or the Python library “LnkParse3”. Some of these tools are able to](https://github.com/EricZimmerman/LECmd)\nparse even malformed LNK files, which is a characteristic of some files created by threat\nactors.\n\n## LNK Builder Tools\n\n\n-----\n\nWith the increasing usage of LNK files in attack chains, it s logical that threat actors have\nstarted developing and using tools to create such files. Several tools have been\ndocumented before and many are available publicly or through a paid subscription:\n\n[MLNK Builder](https://research.checkpoint.com/2020/breaking-through-windows-defenses-analysing-mlnk-builder/)\nQuantum Builder\nMacropack\nLNKUp\nLnk2pwn\nSharPersist\nRustLnkBuilder\n\nThese different tools may sometimes leave traces in the LNK metadata, which can be\nuseful for detecting or tracking malicious actors. By examining the output payload of some\nof these builders, we can see that most of them wipe out most metadata from the file. This\ncould be used as a good indicator of suspicious behavior, as these fields normally are\npresent by default when the shortcut is properly created.\n\n## SharPersist Payload\n\n_Figure 1: SharPersist payload_\n\n\n-----\n\nIn Figure 1 we can see the MAC timestamps are empty, but the LNK file still contains\ninformation about the relative path where the file was created, as well as the SID of the user\nwho created the file.\n\n## Quantum Builder Payload\n\n\n-----\n\n_Figure 2: Quantum builder payload_\nIn Figure 2, we can see the Quantum Builder does not attempt to wipe out any metadata\nand the generated LNK file contains a trove of metadata about the system where it was\ncreated. In this example, we also see the Disk Serial Number, user SID and DROID\ninformation including the MAC address of the machine used to create the file. A quick\nsearch for that MAC address indicates it is from a VMWare virtual network card.\n\n\n-----\n\n## Meterpreter Payload\n\n_Figure 3: Meterpreter payload generated for MS15-020 (CVE-2015-0096)_\nIn the LNK files created by Meterpreter, as well as other exploit frameworks like Cobalt\nStrike, the metadata are completely wiped, with the malicious code present in fields not\nnormally parsed by LnkParser. In Figure 3, the LNK target is pointing to a DLL file on a\nremote share but since this is a malformed file created to exploit a bug, the parsing tools\ncannot see the payload.\n\n\n-----\n\n_Figure 4: Meterpreter payload viewed in an Hex editor showing the payload_\nComparing the data present in these examples we can start to see patterns that may be\nuseful to detect these malicious files. Most of the tools tend to have wiped out data simply\nbecause the APIs used to create such files don’t require all fields to be present, so they\nimplement the bare minimum to have the malicious code running. A simple YARA rule could\nbe used to detect such samples:\n\n\n-----\n\n```\nrule lnk_wiped {\n\n  meta:\n\n   author=\"gvenere\"\n\n   description=\"LNK with wiped metadata\"\n\n  strings:\n\n    $lnk_magic = { 4c 00 00 00 }\n\n    $ext1 = \".js\" // additional strings to search\n\n    $ext2 = \".bat\" // in the LNK target area\n\n    $ext3 = \".cmd\" // These are for Qakbot\n\n  condition:\n\n    $lnk_magic at 0x0 and\n\n    uint16(0x1c) == 0x0 and // CreationTime == 0x0\n\n    uint16(0x24) == 0x0 and // AccessTime == 0x0\n\n    uint16(0x2c) == 0x0 and // WriteTime == 0x0\n\n    // To target specific families we can add additional checks here\n\n    ( any of ($ext*) in (0xa0..0x100) )\n\n}\n\n```\nOther tools use the proper methods to create these files, but that opens an opportunity to\nidentify information specific to the machine where the sample was created. Looking at the\nQuantum Builder example in Figure 2, it’s possible to see attributes which identify the Disk\nand Machine where the LNK was created.\n\nThe information present in the LNK files can prove extremely valuable when it comes to\ntracking specific threat actors in the wild.\n\n## LNK files as Initial Access Tool\n\nWhen Microsoft announced the changes to macro behavior in Office at the end of 2021,\nvery few of the most prevalent malware families used LNK files as part of their initial\n[infection chain. In general, LNK files are used by worm type malware like Raspberry Robin](https://blogs.cisco.com/security/raspberry-robin-highly-evasive-worm-spreads-over-external-disks)\nin order to spread to removable disks or network shares.\n\nHowever, Talos observed a steady increase in LNK file usage by main malware families\nstarting at the beginning of the year, with a big spike by the time Microsoft implemented the\nchanges in Office 365. Looking for VirusTotal (VT) data for the past year, and searching\nexclusively for files related to prevalent malware families, we can see the following trend\n(Figure 5):\n\n\n-----\n\n_Figure 5: LNK files used as initial access mechanism for prevalent malware families._\n_Source: VirusTotal_\nWhen we look at specific families using these files, we can observe Qakbot as the main\nsource of files in their last two campaigns, one starting in May and ending in July, and the\nother starting around the beginning of August and ending in November.\n\n_Figure 6: LNK file telemetry mapped to malware families. Source: VirusTotal_\n\n\n-----\n\nInterestingly, many malicious LNK files submitted to VT during this period had all the\nmetadata removed from the file. Looking at Qakbot data, we see the group started to use\nLNK files with wiped metadata during the August campaign. Wiped metadata could also be\nexplained by the increasing usage of toolkits to generate such files, as explained before.\n\nThe data in Figure 6 also depicts a decrease in activity around July and August, followed by\nanother spike around October and November. This could be explained by the\n[announcement of](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41091) [vulnerabilities which allowed malware to bypass the Mark-of-the-Web flag](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-41049)\nused by Microsoft Defender and other Antivirus products to decide whether to scan or not a\nfile. As [reported by other](https://www.securityweek.com/microsoft-patches-motw-zero-day-exploited-malware-delivery) [sources, this bug was exploited by many malware families and](https://www.bleepingcomputer.com/news/microsoft/microsoft-fixes-windows-zero-day-bug-exploited-to-push-malware/)\ncould explain the second spike in LNK files usage as delivery mechanism.\n\n## Threat Actor Tracking\n\n Qakbot\n\n[Qakbot (also known as Qbot or Pinkslipbot) is one of the oldest malware operations still in](https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot)\nactivity. First observed in the wild around 2007, it is still one of the most active malware\n[families today, as we recently reported in Talos’s Q2 Quarterly Report.](https://blog.talosintelligence.com/2022/07/quarterly-report-incident-response.html)\n\nQakbot is known to evolve and adapt their operation according to the current popular\ndelivery methods and defense techniques. As recently as May 2022, their preferred method\n[of distribution was to hijack email threads gathered from compromised machines, and insert](https://blog.talosintelligence.com/2022/07/what-talos-incident-response-learned.html)\nattachments containing Office XLSB documents embedded with malicious macros.\n\nHowever, after Microsoft announced changes to how macros were executed by default on\ninternet downloaded content, Talos found Qakbot increasingly moving away from the XLSB\nfiles in favor of ISO files containing a LNK file, which would download and execute the\npayload.\n\nWhile examining the content of these LNK files used in the last 6 months of campaigns, we\nobserved some interesting characteristics. Looking at the information present in the\nmetadata about where these samples are created, we see that there is no overlapping\nmetadata between the different campaigns. Additionally, looking at the Top 200 samples in\nVT known to be part of a Qakbot campaign, we see what machines were the most active in\ngenerating these LNK files (Figure 7):\n\n\n-----\n\n_Figure 7: Distribution of LNK files related to main Qakbot campaigns_\nMetadata information can also help detect correlations between these actors and other\nmalware. For example, we analyzed the samples below, which are all part of the “AA”\nQakbot campaign from June and July 2022:\n\n8fda14f91e27afec5c1b1f71d708775c9b6e2af31e8331bbf26751bc0583dc7e\n2f9da7145056a4217552a5a536ceb8365e853fbd04d28ae2d494afb20e9c021f\n52458b4aaddbcb04048be963ea7d669c2ff7a69642d027f88812a5c6c1ade955\n6a980d7659efb8bfb997dec3259d6eb090d4e6a4609e4c0666e04ad612151d71\n67bbffb2ff5f724a201445f26018cb09fbf0588689f98f90fd82082aae7c6eec\nda2a0d9a6b5dd2123c4c2cbd55d81fd22ab72bf7ceb1489a5a770e10bcf67137\n54681cbb4c61dd4fe03341cfd8d2b796366a0372b53dd3e1d52c9e6ff98692d1\na7f31c98147d98ac08f4b8afe7faa2f2b4aab821655717f4bde519fcd87300ac\nc5c0daaa26815bb6528332dd4f56f7eb72db4456d5a84b8bc69239c45079a1c4\nefdb91497fe213e8f696065c2fe81f64cbaa219da16e2b3f8e1e146d098652b5\nc9dfafd3536977289b4bfda1369fbd113a778cf06ac0c01cdc8e00e1c300e774\ne818b0115a9a877a9517c99b16e5a2df9cf7c5eb1fb249d9153b68e8fa94e60b\n7ba3eaee591cc73ab85aeb09d8c02b1e569b9dcaffcbc7c4473f504f939697d2\n\nThe metadata in these samples indicate they were created on a machine with Drive Serial #\n“0x2848e8a8”. Looking at VT for this serial we found samples that were both related to the\nAA campaign, and linked to other malware.\n\n\n-----\n\nFor example the sample\nbeacb63904c2624ae02601f283671b3ef61650109aea3259b63a0aeefe4133fa, which was\nsubmitted on August 15th, 2022, contains Powershell code to download and execute a\nbinary from hxxp://88.198.148[.]231/u.exe.\n\nAccording to VT information, this sample with hash\n6161c01fd590c98c6dee4e510ba9be4f574c9cc5c89283dbff6bb79cd9383d70 is detected as\na Redline variant (Figure 8):\n\n_Figure 8: VirusTotal details for_\n\n_Redline sample_\nStarting in August 2022, Qakbot resumed activity, including their two main campaigns,\n“Obama” and “AA”. Interestingly, at this point the “Obama” Qakbot campaign began wiping\nout the metadata on their LNK files, but the Target field always pointed to the JS, BAT or\nCMD file used to start the malicious DLL part of the initial infection chain (Figure 9):\n\n\n-----\n\n_Figure 9: Metadata for LNK files part of “Obama” campaign_\nThe same behavior started to happen on “BB” campaign’s LNK files starting on September\n[13th. We can see in Figure 10 that samples mapped to the “BB” campaign in September](https://bazaar.abuse.ch/browse.php?search=sha256%3A77fe3b85503872e252ee98f49c1491d7dfc7cb3579ff3771bd7ad59f68c0dc60)\nstill had Drive Serial Number information:\n\n\n-----\n\n_Figure 10: Metadata for LNK files part of “BB” campaign_\nWe also observe that the Drive Serial Number matches the one used by the “AA” campaign\nfrom the May/July timeframe, which could indicate “AA” and “BB” are probably managed by\nthe same group. More recently, [samples from “BB” started to have their metadata wiped](https://bazaar.abuse.ch/sample/3c1d714d910f4d14eaf4698b7cec9a15a7ed92c657fb9945125bbdf3f8c767d5)\ntoo.\n\n## Gamaredon\n\n\n-----\n\n[In June 2022, Inquest published a report about a new threat actor called Glowsand that was](https://inquest.net/blog/2022/06/27/glowsand)\ntargeting Ukranian entities using phishing emails with malicious documents and LNK files to\ndownload and execute second stage payloads.\n\n[By analyzing the metadata content of the LNK file in the report, Talos associated the](https://www.virustotal.com/gui/file/d965892ede4f74fa62248b381160ed6f0cd9158bf4788de40b57815f9108bc15)\n[machine IDs where the files were generated, to files associated with the Gamaredon APT.](https://www.virustotal.com/gui/search/metadata%253A3C76-6C45/files)\nFurthermore, based on this metadata, Talos identified a new campaign targeting Ukrainian\norganizations that started around August 8th, 2022, which we wrote about in a separate\n[blog post. In fact, Gamaredon files reported as far back as Feb 2017 contained the same](https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/)\nLNK metadata as the files found in our research.\n\nOn September 6th a new set of samples was identified during our hunts, which we also\nconnected to previous Gamaredon campaigns via metadata. But the samples this time had\nan interesting feature: an embedded digital signature (digisig) pertaining to a Microsoft\ndevelopment unit in Puerto Rico.\n\n7f66f4411983001d29236c5d3fb4ff26f01b5742badca1db8d49264c01ba506c\n1b2ed05f488f8439688a02cc6ef84f939d16169117b489219b688a3ea482e5ed\n6ce64dedbe81c36aef38fd2d567f6ab9737df708591dc2f0cafa56db26a1d043\n1e0b92485e09ac970ae38214fb5c7407f73027ada47ea697017e49cacb576908\n\nThe samples had very few or no detections at all in VT, even though some of them are\nrelated to a Gamaredon campaign from 2016/2017, which may indicate the embedded\ndigisig might have been added in an attempt to bypass AV detections.\n\n[Following the lead on the digisig name “Microsoft Operations Puerto Rico1” we can find a](https://www.virustotal.com/gui/search/content%253A%257B4d6963726f736f6674204f7065726174696f6e732050756572746f205269636f31%257D)\nmultitude of LNK files using the same technique. The interesting point here is that there is\nno provision in the LNK file format for a digisig, which means the digisig is probably present\nonly as garbage data to confuse AV scanners and is a common technique used by many\nmalware families.\n\n## Bumblebee relationship with IcedID and Qakbot\n\nIn addition to tracking malware groups’ activity over time, LNK file metadata can help\n[identify relationships among different threat actors. Researchers have identified](https://blog.bushidotoken.net/2022/11/the-continuity-of-conti.html)\nrelationships between Bumblebee and other malware families before, which we\nindependently confirmed by looking at the LNK metadata.\n\n[In August 2022, a user submitted a test link file to VT, with a file path containing the](https://www.virustotal.com/gui/file/f10f7b6b90f1fabd7d55822fa50d11cda7e8651df246daa8f1cf2360cebca61e)\nindividual’s username: “Lamar”. This LNK file was created on the same machine\nresponsible for the LNK files used in a previous IcedID campaign. A few hours later the\nsame user submitted another file with hash\n\n\n-----\n\ne89cd1999517b47805106111e14de4a03669cac30adb3b3304655febce25955f, this time\nwith user information sanitized, and packaged in a Zip file containing a BAT and DLL file.\n[The DLL file was an IcedID bot.](https://www.virustotal.com/gui/file/74ec1aefc915a939cda2b028d778566e341c2ef81186a5861b677e3bc6707623)\n\nWe also found a correlation between LNK files leading to IcedID infection, with LNK files\nused in a Bumblebee campaign, which both use the same Drive Serial Number:\n\n_Figure 11: Bumblebee and IcedID samples sharing the same metadata_\nBy examining the relationships between these hashes in VT, we can see that the LNK file\n9c7e01c2c39dadc020a0cf8dc74b62e6453b56413f09705b4ad4d391981f5a3f seen in\nFigure 11 leads to a [Bumblebee DLL while other hashes like](https://www.virustotal.com/gui/file/2e349b3224cc0d958e6945623098c2d28cc8977e0d45480c0188febbf7b8aa78)\n3cca8d1b4cfe0ebcf105621700454d0285ef1b44dfed3e3abf70060bb62aa5b4 lead to an\n[IcedID DLL. In both cases the same username is present in the ParsingPath field.](https://www.virustotal.com/gui/file/2630bdfe1b7ee3c9a6e46fd004c238b2d4b22de0696ea502074d7e33900b6c8f)\n\nA similar approach was used to find a relationship between Bumblebee and Qakbot. During\nour research on Qakbot we found samples associated with the “Obama” campaign which\nstill had the LNK information and used the Drive Serial Number “300D-05E9”. This same\nserial number was found later in LNK samples leading to Bumblebee infections:\n\n_Figure 12: Bumblebee and Qakbot samples sharing the same metadata_\nJust as an example, the sample\n2738ee3f181994cca5d9ea19359b8142981583d17563934ab3212eefe13af3ff in Figure 12\n[leads to a Bumblebee DLL.](https://www.virustotal.com/gui/file/b29b0f2a27ccbb9f12363a3dde1f2d2373fdc782232f4804f0abffbb8daf9d25)\n\n## Conclusion\n\nIn the cyber threat landscape, any new information on the adversary could be critical toward\nimproving defenses. In this blog Talos demonstrated metadata’s value using LNK files, but\nthe same concept is applicable to other file formats that include metadata or attack tools\n\n\n-----\n\nthat leave signature traces about their use in their payloads.\n\nBy analyzing and tracking information leaked through metadata, and correlating this\ninformation with other actor’s tactics, techniques and procedures, defenders can develop\nbetter detections and even predict future behavior, to prepare for an attack.\n\n## Coverage\n\n[Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[execution of the malware detailed in this post. Try Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium=web-referral?utm_source=cisco&utm_campaign=amp-free-trial&utm_term=pgm-talos-trial&utm_content=amp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\ndetects malware used in these attacks.\n\n[Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by](https://www.cisco.com/c/en/us/products/security/email-security/index.html)\nthreat actors as part of their campaign. You can try Secure Email for free [here.](https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium=web-referral&utm_source=cisco&utm_campaign=cmd-free-trial-request&utm_term=pgm-talos-trial)\n\n[Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\nsuch as [Threat Defense Virtual,](https://www.cisco.com/c/en/us/products/collateral/security/firepower-ngfw-virtual/datasheet-c78-742858.html) [Adaptive Security Appliance and](https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html) [Meraki MX can detect](https://meraki.cisco.com/products/appliances)\nmalicious activity associated with this threat.\n\n[Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\nprotection into all Cisco Secure products.\n\n[Umbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs and URLs, whether users are on or off the corporate network. Sign up for a\n[free trial of Umbrella here.](https://signup.umbrella.com/?utm_medium=web-referral?utm_source=cisco&utm_campaign=umbrella-free-trial&utm_term=pgm-talos-trial&utm_content=automated-free-trial)\n\n[Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\npotentially dangerous sites and tests suspicious sites before users access them.\n\nAdditional protections with context to your specific environment and threat data are\n[available from the Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\n[Cisco Duo provides multi-factor authentication for users to ensure only those authorized are](https://signup.duo.com/?utm_source=talos&utm_medium=referral&utm_campaign=duo-free-trial)\naccessing your network.\n\n\n-----\n\nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org. Snort SIDs for this threat are: 61099-](https://www.snort.org/products)\n61102, 300367-300368\n\nThe following ClamAV detections are also available for this threat:\n\nLnk.Dropper.Agent\nLnk.Trojan.Qakbot\nLnk.Trojan.BazarLoader\nLnk.Downloader.Agent\nWin.Dropper.Agent\n\n## Indicators of Compromise\n\n[Indicators of Compromise associated with this threat can be found here.](https://github.com/Cisco-Talos/IOCs/blob/main/2023/01/following-the-lnk-metadata-trail.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-19 - Following the LNK metadata trail.pdf"
    ],
    "report_names": [
        "2023-01-19 - Following the LNK metadata trail.pdf"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d5156b55-5d7d-4fb2-836f-861d2e868147",
            "created_at": "2023-01-06T13:46:38.557326Z",
            "updated_at": "2025-03-27T02:00:02.861124Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Aqua Blizzard",
                "Actinium",
                "DEV-0157",
                "Blue Otso",
                "G0047",
                "PRIMITIVE BEAR",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder",
                "ACTINIUM",
                "BlueAlpha",
                "IRON TILDEN"
            ],
            "source_name": "MISPGALAXY:Gamaredon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1683338906,
    "ts_updated_at": 1743041637,
    "ts_creation_date": 1683251288,
    "ts_modification_date": 1683251288,
    "files": {
        "pdf": "https://archive.orkl.eu/0a2f0e136a8a15c4d8b78d47c51e039939493b9d.pdf",
        "text": "https://archive.orkl.eu/0a2f0e136a8a15c4d8b78d47c51e039939493b9d.txt",
        "img": "https://archive.orkl.eu/0a2f0e136a8a15c4d8b78d47c51e039939493b9d.jpg"
    }
}