{
    "id": "1c4b26cb-ebd6-4c62-a141-2862b4831b72",
    "created_at": "2023-01-12T15:06:48.439773Z",
    "updated_at": "2025-03-27T02:09:51.251981Z",
    "deleted_at": null,
    "sha1_hash": "0ce0ed44e608f9a95ee7a65749024ed764b15f91",
    "title": "2021-04-07 - Yanbian Gang Malware Continues with Wide-Scale Distribution and C2",
    "authors": "",
    "file_creation_date": "2022-05-28T18:23:18Z",
    "file_modification_date": "2022-05-28T18:23:18Z",
    "file_size": 1052463,
    "plain_text": "# Yanbian Gang Malware Continues with Wide-Scale Distribution and C2\n\n**[riskiq.com/blog/external-threat-management/yanbian-gang-malware-distribution/](https://www.riskiq.com/blog/external-threat-management/yanbian-gang-malware-distribution/)**\n\nApril 7, 2021\n\nFake banking apps laced with malware continue to be an effective tool for threat actors. For\n[the Yanbian Gang, a criminal group centered in Yanbian, China, that targets organizations](https://www.scmagazine.com/home/security-news/trend-micro-researchers-believe-they-have-spotted-a-connection-between-the-xloader-and-fakespy-malware-families-along-with-possible-ties-to-the-yanbian-gang/)\nacross Asia, it's a craft they've been improving on for over a decade.\n\nThe Yanbian Gang has targeted South Korean Android mobile banking customers since\n2013 with malicious Android apps purporting to be from major banks, namely Shinhan\nSavings Bank, Saemaul Geumgo, Shinhan Finance, KB Kookmin Bank, and NH Savings\nBank. RiskIQ's threat research team examined some of the threat group's more recent\nactivity in this vector to analyze their malware of choice and the large-scale hosting\ninfrastructure they use to distribute and control it.\n\nDuring their analysis of Yanbian Android apps, our researchers discovered hundreds of\nKorean language-specific apps across an extensive list of IP addresses. These apps were\npurpose-built to steal information from infected victims, including loan application details,\ncontacts, SMS messages, phone call details, call logs, and applications currently installed on\nthe device.\n\nFrom a list of C2 servers used by the group gathered by OSINT and our own analysis, we\nidentified pivot points and connections to more C2 servers used by other samples of\nmalicious Android applications distributed by the Yanbian Gang. With RiskIQ data, we could\ncatalog pages distributing the Yanbian Gang applications and paint a clear picture of the\ngroup's recent activity, infrastructure, and hosting services.\n\n## Yanbian Apps Reach Deep into Victim Pockets\n\n\n-----\n\nOverall, RiskIQ s analysis identified 377 individual samples of malicious Android apps\ndeveloped and distributed by the Yanbian Gang since December 2020. Many of these apps\nhave multiple variants and set up services to run in the background of victim phonesâ€”both\n[of which fit the known modus operandi of the Yanbian Gang.](https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-the-south-korean-fake-banking-app-scam.pdf)\n\nWhile simple in nature, these apps perform several malicious activities unbeknownst to the\nvictim. Yanbian Gang actors get details of the victim themself, but also their contacts,\ninstalled applications, and even messages sent from the infected device. These apps also\nhave dozens of permissions they can potentially abuse for malicious purposes.\n\n\n-----\n\nExample of Yanbian Gang app analyzed by riskIQ\n\nA sample analyzed by RiskIQ was bundled with several packages, including for the\napplication itself, its services, and how stolen data is encrypted and forwarded to the\neventual C2 server. However, the reuse of an AES key and initialization vector (IV) we found\nin the apps' decompiled code helped us decrypt messages revealing interesting mechanisms\nthat make the apps work.\n\nOne of these revelations was references to different URL paths that reached out to a direct\nIP address over HTTP. These paths, referred to by the Yanbian Gang as \"methods,\" act as\nCommand and Control (C2), allowing the app to initiate device registration, assess device\ncapabilities, steal information, and receive instructions from specified C2 servers.\n\n## The 'Methods' to Yanbian Gang's Madness\n\nRiskIQ researchers observed one of the samples communicating via only some of these\n\"methods,\" likely because of the limited amount of data stored in our testing device and its\nlack of features. The app sent these communications via encrypted HTTP POST and GET\nrequests to the C2 server. We used the Yanbian AES key and IV mentioned above to decrypt\nthese messages and better understand the malware and the \"method\" URLs.\n\n\n-----\n\nIn-app view of customer data fields sent out to Yanbian C2s\n\nWe found that, for example, 'method 4' actively sends SMS messages to the C2 server that\nincludes the recipient's contact name and number. Afterward, a POST request sends a list of\nall installed applications on the victim's phone to 'method 7.\" Then, after more interaction by\n\n\n-----\n\nthe victim in the faux Kookmin Bank App, another POST request sends name, contact, date\nof birth, address, name of work, annual salary, and other loan application details.\n\n## Yanbian Infrastructure Knows Its Role\n\nThe Yanbian gang uses large sets of servers for distribution and C2. However, our analysis\nshows operators keep distribution wholly separate from C2 activity with designated servers\nfilling three sole functions:\n\nHosting call-to-action pages and delivering malicious apps. Distribution occurs via\nYanbian Gang-controlled hosts, not through app stores\nC2\nRunning the Real-Time Messaging Protocol, which receives call information.\n\nWe have so far identified 377 individual samples of malicious Android apps, each containing\nstrings pointing to C2 servers. During our breakdown of a malware sample, we identified one\nsuch C2 server at an [IP address. A RiskIQ crawl showed that this and other Yanbian C2](https://community.riskiq.com/search/103.145.190.43/trackers)\n[servers were all loading fake banking pages from the same host.](https://community.riskiq.com/search/trackers/test.160.jingan8.cn)\n\n[We can pivot on one of these fake banking pages by its Mark of the Web source via our](https://www.riskiq.com/blog/labs/markoftheweb/)\n[Trackers dataset in PassiveTotal. We found five hosts and 745 IP addresses all connected to](https://www.riskiq.com/blog/labs/tracking-trackers/)\nthe same page:\n\nYanbian Gang fake banking login page\n\n\n-----\n\nRiskIQ has directly observed 86 of these IP addresses in the code of malicious Yanbian\nGang Android applications ingested into our mobile app index. Further analysis of fake login\npages allowed us to identify a total of 177 IP addresses used by the Yanbian Gang for C2.\n\nThe Yanbian Gang uses many servers for both distribution and C2, though we observed far\nmore distributing the malware than acting as C2. The distribution pages from which these\napps were downloaded were hosted on 266 IP addresses. Not surprisingly, the distribution\npages all mimic the websites of banking institutions.\n\nAll told, with RiskIQ's unique data sets, we could identify 177 IP addresses acting as C2\nservers and 266 IP addresses acting as distribution servers.\n\n## Yanbian Hosting: Divide and Conquer\n\nThe Yanbian Gang uses different hosting providers for their C2 servers versus their\ndistribution servers, which appears to be a new group evolution. The Gang operates a huge\nnumber of servers for both distribution and C2. However, we have observed many more\nservers distributing the malware than acting as C2.\n\nThe group's 177 C2 servers are primarily hosted in Hong Kong by SunnyVision Limited,\nForewin Telecom Group Limited, and Sun Network (Hong Kong) Limited. A few servers are\nalso hosted in Singapore by BGPNET Global.\n\nYanbian's 266 distribution servers, in contrast, are located in China and Taiwan. The largest\nshare of the servers are hosted by Taiwanese company HINET, with a few more hosted in\nTaiwan by Asia Pacific On-line Service Inc. Fifty of the distribution servers are hosted by\nCHINANET-BACKBONE.\n\nThe set of hosting providers used for C2 is more diverse than distribution, centered mainly\non HINET infrastructure. The group appears to reuse C2 infrastructure, with multiple\nmalicious apps communicating with the same servers, thus leading to fewer servers needed\nfor that purpose.\n\n## Conclusion\n\nThe Yanbian Gang continues to target South Korean users with malware, tactics, and\ntargeting similar to that previously reported in 2015. However, the group has evolved to\nseparate infrastructure based on its function and change hosting providers. RiskIQ observed\nthat Yanbian Gang actively leverages web servers hosting their call-to-action and malicious\napplication delivery, C2 servers, and servers running the Real-Time Messaging Protocol that\nreceive call information.\n\n\n-----\n\nExtending security and IT protection outside the firewall requires mapping these billions of\nrelationships between the internet components belonging to every organization, business,\n_and threat actor on Earth. RiskIQ's_ [Internet Intelligence Graph enables us to take a broader](https://www.riskiq.com/blog/external-threat-management/internet-intelligence-graph/)\nview of campaigns, such as those by the Yanbian Gang targeting South Korean mobile\nbanking customers. By graphing the deep relationships between infrastructure in the global\nattack surface, we can discover significant trends and fingerprint different sets of indicators to\nidentify large-scale malicious infrastructure efficiently.\n\n[Visit our Threat Intelligence Portal for the complete technical analysis of the Yanbian Gang,](https://community.riskiq.com/article/f88ed16f)\nincluding a full list of IOCs surfaced in our investigation.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-07 - Yanbian Gang Malware Continues with Wide-Scale Distribution and C2.pdf"
    ],
    "report_names": [
        "2021-04-07 - Yanbian Gang Malware Continues with Wide-Scale Distribution and C2.pdf"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8f350ed9-134e-4160-b63d-701f562ba64a",
            "created_at": "2022-10-25T16:07:24.589322Z",
            "updated_at": "2025-03-27T02:02:10.292236Z",
            "deleted_at": null,
            "main_name": "Yanbian Gang",
            "aliases": [],
            "source_name": "ETDA:Yanbian Gang",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c5a35bf-f483-463e-aea0-89a795698cff",
            "created_at": "2023-01-06T13:46:39.198624Z",
            "updated_at": "2025-03-27T02:00:03.019375Z",
            "deleted_at": null,
            "main_name": "Yanbian Gang",
            "aliases": [],
            "source_name": "MISPGALAXY:Yanbian Gang",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536008,
    "ts_updated_at": 1743041391,
    "ts_creation_date": 1653762198,
    "ts_modification_date": 1653762198,
    "files": {
        "pdf": "https://archive.orkl.eu/0ce0ed44e608f9a95ee7a65749024ed764b15f91.pdf",
        "text": "https://archive.orkl.eu/0ce0ed44e608f9a95ee7a65749024ed764b15f91.txt",
        "img": "https://archive.orkl.eu/0ce0ed44e608f9a95ee7a65749024ed764b15f91.jpg"
    }
}