{
    "id": "b5105c00-c15b-48e8-8fe0-c255867d203a",
    "created_at": "2023-01-12T15:01:47.561849Z",
    "updated_at": "2025-03-27T02:05:44.157745Z",
    "deleted_at": null,
    "sha1_hash": "549922aa1023ac307ff551059be6acfd8b0106d3",
    "title": "2022-02-08 - Remcos Analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T16:04:35Z",
    "file_modification_date": "2022-05-28T16:04:35Z",
    "file_size": 2464678,
    "plain_text": "# Remcos\n\n**[github.com/itaymigdal/malware-analysis-writeups/blob/main/Remcos/Remcos.md](https://github.com/itaymigdal/malware-analysis-writeups/blob/main/Remcos/Remcos.md)**\n\nitaymigdal\n\n\n**Malware**\n**Name**\n\n\n**File**\n**Type** **SHA256**\n\n\nRemcos x32\nexe\n(.NET)\n\n\n5eb996275b36c1e8c1d3daa71e6469507a29401c77f2b1fd91e4d354ccde9860\n\n\n## Analysis process\n\nThis writeup starts with a suspicious executable that was sent via mail.\n\nWe can see that most part of the PE is packed (entropy ~ 8 -> High entropy indicates on\nencrypted / compressed data):\n\n\n-----\n\nThe PE is .NET so we'll check it out in Dnspy:\n\nAs usual, we'll watch it under Procmon. this is the interesting process tree:\n\nWe can see that:\n\n\n-----\n\nThe file creates scheduled task for persistence\nThe file writes a vbs script to `\\AppData\\Local\\Temp\\ and runs it`\nThe vbs script copies the malware to `\\AppData\\Roaming\\remcos\\ (Nice spoiler,`\nthank you malware author üòò), and executes it from there.\n\nThe Script content:\n\nAs we can see, after the copy & execute, the vbs script deletes itself (and is written back\nnext execution).\n\nIn this analysis i took the \"quick and dirty\" approach, so i in order to unpack the file, i let it\nrun for about a minute or two, and then dumped it using Pe-Sieve (i added the /data\nargument, because this is .NET executable):\n\nAnd Vwalla:\n\nWe've got our unpacked version with nice icon:\n\nAnd it isn't packed:\n\n\n-----\n\nThe file is a native PE file (i.e. written in C\\C++, unlike the loader which was written in\n.NET), and it's importing a lot of interesting libraries:\n\nObserving the strings we find very interesting finds:\n\nIndeed the malware is Remcos PRO 2.7.2:\n\n\n-----\n\nKeylogger capabilities:\n\nBrowser stealing capabilities:\n\nExfilitration and Infilitration capabilities:\n\nThe malware contains a setting resource which looks encrypted:\n\nSo we will try to watch it decrypted in memory. here we can see the file loads it:\n\n\n-----\n\nAnd after some math we see the settings in clear text:\n\nc2 Server: 185.244.26.209\n\nWe can see some more juicy stuff, like Mutex string, execution path, logs path and\nencryption keys.\n\nAfter some Googling about Remcos, seems like it is total legal software which has a very\n[detailed site. This is how the panel from the attacker side looks like:](https://breakingsecurity.net/remcos/)\n\n\n-----\n\nA lot of nice and evil capabilities üòè.\n\n## Bonus\n\n[After watching this, i learned how Remcos encrypts his config, so i wrote a little script that](https://www.youtube.com/watch?v=CYnzzJ8f3Ts&t=573s)\nretrieves a Remcos encrypted SETTINGS file, and decrypts is:\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-08 - Remcos Analysis.pdf"
    ],
    "report_names": [
        "2022-02-08 - Remcos Analysis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535707,
    "ts_updated_at": 1743041144,
    "ts_creation_date": 1653753875,
    "ts_modification_date": 1653753875,
    "files": {
        "pdf": "https://archive.orkl.eu/549922aa1023ac307ff551059be6acfd8b0106d3.pdf",
        "text": "https://archive.orkl.eu/549922aa1023ac307ff551059be6acfd8b0106d3.txt",
        "img": "https://archive.orkl.eu/549922aa1023ac307ff551059be6acfd8b0106d3.jpg"
    }
}