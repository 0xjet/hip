{
    "id": "e9cf917d-91b5-44d1-a795-29c977753c1f",
    "created_at": "2023-01-12T15:01:24.059006Z",
    "updated_at": "2025-03-27T02:11:34.435228Z",
    "deleted_at": null,
    "sha1_hash": "3d7a340c8d9426b4d179de0569cb0437b70c7cc1",
    "title": "2022-05-04 - A new secret stash for “fileless” malware",
    "authors": "",
    "file_creation_date": "2022-05-28T15:09:33Z",
    "file_modification_date": "2022-05-28T15:09:33Z",
    "file_size": 551420,
    "plain_text": "# A new secret stash for “fileless” malware\n\n**[securelist.com/a-new-secret-stash-for-fileless-malware/106393/](https://securelist.com/a-new-secret-stash-for-fileless-malware/106393/)**\n\nAuthors\n\n[Denis Legezo](https://securelist.com/author/denislegezo/)\n\nIn February 2022 we observed the technique of putting the shellcode into Windows event\nlogs for the first time “in the wild” during the malicious campaign. It allows the “fileless” last\nstage Trojan to be hidden from plain sight in the file system. Such attention to the event logs\nin the campaign isn’t limited to storing shellcodes. Dropper modules also patch Windows\nnative API functions, related to event tracing (ETW) and anti-malware scan interface (AMSI),\nto make the infection process stealthier.\n\nBesides event logs there are numerous other techniques in the actor’s toolset. Among them\nlet us distinguish how the actor takes initial recon into consideration while developing the\nnext malicious stages: the C2 web domain name mimicking the legitimate one and the name\nin use belonging to the existing and software used by the victim. For hosting the attacker\nuses virtual private servers on Linode, Namecheap, DreamVPS.\n\nOne more visible common approach is the use of a lot of anti-detection decryptors. Actor\nuses different compilers, from Microsoft’s cl.exe or GCC under MinGW to a recent version of\nGo. Also, to avoid detection, some modules are signed with a digital certificate. We believe it\nis issued by the actor, because our telemetry doesn’t show any legitimate software signed\nwith it, only malicious code used in this campaign.\n\n\n-----\n\nRegarding last stage Trojans: the actor decided not to stick to just one – there are HTTP and\nnamed pipe based ones. Obviously besides the event logs the actor is obsessed with\nmemory injection – lots of RAT commands are related to it and are used heavily. Along with\nthe aforementioned custom modules and techniques, several commercial pentesting tools\nlike Cobalt Strike and SilentBreak’s toolset are used.\n\nActually, as we don’t have commercial versions of the latter it’s hard to say which\nenumerated techniques came from the product and which are home-brewed. For sure, thirdparty code from GitHub is also in use: we registered at least BlackBone for legitimate\nprocesses in memory patching.\n\n## The infection chain\n\nWe started the research from the in-memory last stager and then, using our telemetry, were\nable to reconstruct several infection chains. What piqued our attention was the very targeted\nnature of the campaign and the vast set of tools in use, including commercial ones.\n\nThe variety of the campaign’s techniques and modules looks impressive. Let us divide it into\nclasses to technically describe this campaign. Actually, we need to cover the following sets of\nmodules: commercial pentesting suites, custom anti-detection wrappers around them and\nlast stage Trojans.\n\n**Commercial tool sets** SilentBreaks’s toolset\n\nCobalt Strike\n\n**Anti-detection wrappers** Go decryptor with heavy usage of the\nsyscall library. Keeps Cobalt Strike module\nencoded several times, and AES256 CBC\nencrypted blob. We haven’t previously\nobserved Go usage with Cobalt Strike\n\nA library launcher, compiled with GCC under\nMinGW environment. The only possible\nreason for this stage is anti-detection\n\nAES decryptor, compiled with Visual Studio\ncompiler\n\n**Last stage RAT** HTTP-based Trojan. Possible original\nnames are ThrowbackDLL.dll and\ndrxDLL.dll, but code is more complex than\nold publicly available version of\nSilentBreak’s Throwback\n\n\n-----\n\nNamed pipes-based Trojan. Possible\noriginal names are monolithDLL.dll and\nSlingshotDLL.dll. Based on file names there\nis a possibility that last stage modules are\nparts of a commercial Slingshot version\n\nOnce again, some modules which we consider custom, such as wrappers and last stagers,\ncould possibly be parts of commercial products. So now after some classification we are\nready to analyze modules one by one.\n\n## Initial infection\n\nThe earliest phase of attack we observed took place in September 2021. The spreading of\nthe Cobalt Strike module was achieved by persuading the target to download the link to the\n.rar on the legitimate site file.io, and run it themselves. The digital certificate for the Cobalt\nStrike module inside is below (during the campaign with the same one, 15 different stagers\nfrom wrappers to last stagers were signed):\n\n\n1\n\n2\n\n3\n\n4\n\n\nOrganization: Fast Invest ApS\n\nE-mail: sencan.a@yahoo.com\n\nThumbprint 99 77 16 6f 0a 94 b6 55 ef df 21 05 2c 2b 27 9a 0b 33 52 c4\n\nSerial 34 d8 cd 9d 55 9e 81 b5 f3 8d 21 d6 58 c4 7d 72\n\n\nDue to the different infection scenarios for all the targeted hosts we will describe just one of\nthe observed ones. Having an ability to inject code into any process using Trojans, the\nattackers are free to use this feature widely to inject the next modules into Windows system\nprocesses or trusted applications such as DLP.\n\nKeeping in mind truncated process injections, and even mimicking web domain registration,\nwe could describe the attack process as quite iterative: initial recon with some modules and\nthen preparation of additional attacks.\n\n## Commercial tool sets\n\nRegarding the commercial tools, traces of SilentBreak and Cobalt Strike toolset usage in this\ncampaign are quite visible. Trojans named ThrowbackDLL.dll and SlingshotDLL.dll remind us\nof Throwback and Slingshot, which are both tools in SilentBreak’s framework, while the “sb”\nassociated with the dropper (sb.dll) could be an abbreviation of the vendor’s name.\n\n\n-----\n\nHere we want to mention that several .pdb paths inside binaries contain the project s\ndirectory C:\\Users\\admin\\source\\repos\\drx\\ and other modules not named after Throwback\nor Slingshot, such as drxDLL.dll. However, encryption functions are the same as in the\npublicly available Throwback code.\n\n## Anti-detection wrappers\n\nFor the anti-detection wrappers, different compilers are in use. Besides MSVC, Go compiler\n1.17.2 and GCC under MinGW have been used. Decryptors differ a lot; the features they\ncontain are listed in the table below:\n\n\n**Anti-**\n**detection**\n**technique**\n\nSeveral\ncompilers\n\nWhitelisted\nlaunchers\n\nDigital\ncertificate\n\nPatch\nlogging\nexports of\nntdll.dll\n\nKeep\nshellcode in\nevent logs\n\nC2 web\ndomain\nmimicking\n\n\n**Usage**\n\nThe same AES256 CBC decryption could be done with Go and C++\nmodules\n\nAutorunned copy of WerFault.exe maps the launcher into process address\nspace\n\n15 files are signed with “Fast Invest” certificate. We didn’t observe any\nlegitimate files signed with it\n\nTo be more stealthy, Go droppers patch logging-related API functions like\nEtwEventWriteFull in self-address space with empty functionality\n\nThis is the main innovation we observed in this campaign. Encrypted\nshellcode with the next stager is divided into 8 KB blocks and saved in the\nbinary part of event logs\n\nActor registered a web domain name with ERP in use title\n\n\nThis layer of infection chain decrypts, maps into memory and launches the code. Not all of\nthem are worth describing in detail, but we will cover the Go decryptor launcher for Cobalt\nStrike. All corresponding hashes are listed in the appendix.\n\nFunction names in the main package are obfuscated. Main.init decodes Windows API\nfunction names from kernel32.dll and ntdll.dll libraries (WriteProcessMemory and other\nfunctions) related to event log creation. Each of these names in the binary are base64encoded four times in a row. Using WriteProcessMemory, the dropper patches with “xor rax,\nrax; ret” code the following functions in memory: EtwNotificationRegister, EtwEventRegister,\nEtwEventWriteFull, EtwEventWriteFull, EtwEventWrite.\n\n\n-----\n\nIn Main.start the malware checks if the host is in the domain and only works if it s true. Then\nit dynamically resolves the addresses of the aforementioned functions. The next stager is\nencrypted with AES256 (CBC mode), the key and IV are encoded with base64.\n\nWith such an approach, it requires the researcher to code some script to gather the\nencrypted parts of the next module. After decryption, to get the final portable executable,\ndata has to be converted further.\n\n## Last stager types\n\nLast stagers have two communication mechanisms – over HTTP with RC4 encryption and\nunencrypted with named pipes. The latter way is technically able to communicate with any\nnetwork visible external host, but under Windows named pipes are built upon the SMB\nprotocol, which would barely open for external networks. So these modules most probably\nserve for lateral movement.\n\n**Feature** **HTTP-based trojan** **Named pipes-**\n**based trojan**\n\n\nC2 communication Active connection to a randomly chosen\nC2 from a hardcoded list\n\n\nPassive mode\n\n\nEncryption XOR-based, RC4 Plaintext\n\nSelf version in beacon 1.1 No\n\n\nNatural language\nartifacts\n\n\nUnused argument “dave” No\n\n\nCommand set Quite basic, 7 of them More profound, 20\nof them\n\nInjection functionality Yes and much in use Yes and much in\nuse\n\n\nQuite unusual among\nthe commands\n\n\nSleep time randomization: (random\nbetween 0,9 – 1,1) * sleep time\n\n\nGet minutes since\nlast user input\n\n\nAfter this introduction into the set of malware, we will now describe the infection chain:\ndropper injection with Cobalt Strike pentesting suite.\n\n## Dropper in DLL, search order hijacking\n\nWe start custom module analysis from the wrapper-dropper dynamic library. This code is\ninjected into Windows processes such as explorer.exe. At its single entry point after being\nloaded into the virtual address space of the launcher process, the dropper removes files\ncreated by previous stages or executions.\n\n\n-----\n\nFirstly, the module copies the original legitimate OS error handler WerFault.exe to\nC:\\Windows\\Tasks. Then it drops one of the encrypted binary resources to the wer.dll file in\nthe same directory for typical DLL search order hijacking. For the sake of persistence, the\nmodule sets the newly created WerFault.exe to autorun, creating a Windows Problem\nReporting value in the Software\\Microsoft\\Windows\\CurrentVersion\\Run Windows system\nregistry branch.\n\n**_The dropper not only puts the launcher on disk for side-loading, but also writes_**\n**_information messages with shellcode into existing Windows KMS event log_**\n\nThe dropped wer.dll is a loader and wouldn’t do any harm without the shellcode hidden in\nWindows event logs. The dropper searches the event logs for records with category 0x4142\n(“AB” in ASCII) and having the Key Management Service as a source. If none is found, the\n8KB chunks of shellcode are written into the information logging messages via the\nReportEvent() Windows API function (lpRawData parameter). Created event IDs are\nautomatically incremented, starting from 1423.\n\n## Launcher in wer.dll\n\nThis launcher, dropped into the Tasks directory by the first stager, proxies all calls to wer.dll\nand its exports to the original legitimate library. At the entry point, a separate thread\ncombines all the aforementioned 8KB pieces into a complete shellcode and runs it. The\nsame virtual address space, created by a copy of the legitimate WerFault.exe, is used for all\nthis code.\n\n**_To prevent WerFault continuing its error handling process, the DLL patches the_**\n**_launcher’s entry point with typical Blackbone trampolines_**\n\n\n-----\n\nThe way to stop the legitimate launcher s execution isn t traditional. In the main thread,\nwer.dll finds its entry point and patches it with a simple function. WaitAndExit() on the\nscreenshot above would just call WaitForSingleObject() with the log gathering thread id and\nthen exit, meaning no real WerFault.exe error handling code could ever be executed: the\nspoofed DLL mapped into its address space would block it.\n\n## Shellcode into Windows event logs\n\nThe launcher transmits control to the very first byte of the gathered shellcode. Here, three\narguments for the next function are prepared:\n\nAddress of next stage Trojan. It is also contained within the data extracted from the\nevent logs\nThe standard ROR13 hash of exported function name Load inside this Trojan\n(0xE124D840)\nAddresses of the string “dave” and constant “4”, which become the arguments of the\nexported function, found by hash\n\nThe parsing of the next Windows portable executable to locate its entry point is quite typical.\nTo make the next stage Trojan less visible, the actor wiped the “MZ” magic in its header.\nAfter calling the code at the Trojan’s entry point, the shellcode also searches for the\nrequested export and invokes it.\n\n\n-----\n\n**_Besides searching for the entry point and calling it, the shellcode also searches for a_**\n**_Trojan export by hardcoded hash and runs the found function with arguments “dave”_**\n**_and “4”_**\n\n## HTTP Trojan\n\nFor last stagers we will be a bit more detailed than for auxiliary modules before. The C++\nmodule obviously used the code from SilentBreak’s (now NetSPI’s) Throwback public\nrepository: XOR-based encryption function, original file name for some samples, e.g.,\nThrowbackDLL.dll, etc. Let us start here with the aforementioned Load() exported function.\nIt’s just like the patching of WerFault above (the function waits on the main Trojan thread) but\nit ignores any parameters, so “dave” and “4” are unused. It is possible this launcher supports\nmore modules than just this one, which would require parameters.\n\n### Target fingerprinting\n\nThe module decrypts C2 domains with a one- byte XOR key. In the case of this sample there\nis only one domain, eleed[.]online. The Trojan is able to handle many of them, separated by\nthe “|” character and encrypted. For further communications over plain HTTP, the Trojan\nchooses a random C2 from this set with user agent “Mozilla 5.0”.\n\nThe malware generates a fingerprinting string by gathering the following information, also\nseparated by “|’:\n\nValues of MachineGUID from the SOFTWARE\\Microsoft\\Cryptography\nComputer name\nLocal IP addresses obtained with GetAdaptersInfo\nArchitecture (x86 or x64)\nOS version\nWhether the current process has SeDebugPrivilege\n\nThe fingerprinter also appends “1.1” to the string (which could be the malware version) and\nthe sleep time from the current config.\n\n### Encrypted HTTP communication with C2\n\nBefore HTTP communications, the module sends empty (but still encrypted) data in an ICMP\npacket to check connection, using a hardcoded 32-byte long RC4 key. Like any other strings,\nthis key is encrypted with the Throwback XOR-based algorithm.\n\nIf the ping of a control server with port 80 available is successful, the aforementioned\nfingerprint data is sent to it. In reply, the C2 shares the encrypted command for the Trojan’s\nmain loop.\n\n### Trojan commands\n\n\n-----\n\n**Code** **Command features**\n\n0 Fingerprint the target again.\n\n1 Execute command. The Trojan executes the received command in the new\nprocess and sends the result back to the C2.\n\n2 Download from a URL and save to the given path.\n\n3 Set a new sleep time. This time in minutes is used as a timeout if the C2 hasn’t\nreplied with a command to execute yet. Formula for randomization is (random\nnumber between 0,9 – 1,1) * sleep time.\n\n4 Sleep the given number of minutes without changing the configuration.\n\n5 List processes with PID, path, owner, name and parent data.\n\n6 Inject and run shellcode into the target process’ address space. To inject into the\nsame process, the command argument should be “local”. Like the shellcode in the\nevent logs, this one would run the provided PE’s entry point and as well as a\nspecific export found by hash.\n\n99 Terminates the session between trojan and C2.\n\nAnother Trojan in use during this campaign is named pipe-based and has a more profound\ncommand system, including privilege escalation, screenshotting, inactivity time\nmeasurement, etc. Here, we come to the infection chain end. We continue with another last\nstage Trojan type, which we observed injected into processes like edge.exe.\n\n## Named pipes-based Trojan\n\nThe Trojan location is C:\\Windows\\apds.dll. The original legitimate Microsoft Help Data\nServices Module library with the same name is in C:\\Windows\\System32. The main Trojan\nworking cycle is in a separate thread. The malware also exports a Load() function, whose\nonly purpose is to wait for a working thread, which is typical for this campaign’s modules.\n\nFirst, the main trojan thread gets the original apds.dll and exports and saves it into an\nallocated new heap buffer right after the Trojan’s image in memory. Then the Trojan edits the\nself-exported functions data in a way that allows it to call the original apds.dll exports through\nthe crafted stubs like the following, where the address is the one parsed from the real\napds.dll:\n\n\n1\n\n2\n\n\n48B8<addr> MOV RAX,<addr>\n\nFFE0 JMP RAX\n\n\n-----\n\nThis trampoline code is taken from the Blackbone Windows memory hacking library\n(RemoteMemory::BuildTrampoline function). DLL hijacking isn’t something new, we have\nseen such a technique used to proxy legitimate functions many times, but recreating selfexports with just short stubs to call the original legitimate functions is unusual. The module\nthen creates a duplex-named pipe, “MonolithPipe”, and enters its main loop.\n\n### Work cycle\n\nAfter the aforementioned manipulations with exported functions, the module lightly\nfingerprints the host with architecture and Windows version information. The Trojan also\ninitializes a random 11-byte ASCII string using the rare constant mentioned, e.g., here in the\ninit_keys function. The result serves as a unique session id.\n\nThe malware connects to the hardcoded domain on port 443 (in this case\nhttps://opswat[.]info:443) and sends POST requests to submit.php on the C2 side. HTTPS\nconnection options are set to accept self-signed certificates on the server side. The C2\ncommunication in this case is encrypted with an RC4 algorithm with the Dhga(81K1!392-!\n(43<KakjaiPA8$#ja key. In the case of the named pipes- based Trojan, the common\ncommands are:\n\n**Code** **Command features**\n\n0 Set the “continue” flag to False and stop working.\n\n1 N/A, reserved so far.\n\n2 Get time since the last user input in minutes.\n\n3 Get current process information: PID, architecture, user, path, etc.\n\n4 Get host domain and user account.\n\n5 Impersonate user with credentials provided.\n\n6 Get current process’s available privileges.\n\n7 Execute command with the cmd.exe interpreter.\n\n8 Test connection with a given host (address and port) using a raw TCP socket.\n\n9 Get running processes information: path, owner, name, parent, PID, etc.\n\n10 Impersonate user with the token of the process with a provided ID.\n\n11 List files in directory.\n\n12 Take a screenshot.\n\n13 Drop content to file.\n\n\n-----\n\n14 Read content from file\n\n15 Delete file.\n\n16 Inject provided code into process with the given name.\n\n17 Run shellcode from the C2.\n\n18 N/A, reserved so far.\n\n19 Run PowerShell script. During this campaign we observed InvokeReflectivePEInjection to reflectively load Mimikatz in memory and harvest\ncredentials.\n\nWe have now covered the three layers of the campaign. Interestingly, we observed a Trojan\nwith a complete command set as in the table above, but still using RC4-encrypted HTTP\ncommunications with the C2 instead of named pipes. The last stage samples look like a\nmodular platform, whose capabilities the actor is able to combine according to their current\nneeds.\n\n## Infrastructure\n\n**Domain** **IP** **First seen** **ASN**\n\neleed[.]online 178.79.176[.]136 Jan 15, 2022 63949 – Linode\n\neleed[.]cloud 178.79.176[.]136 – 63949 – Linode\n\ntimestechnologies[.]org 93.95.228[.]97 Jan 17, 2022 44925 – The 1984\n\navstats[.]net 93.95.228[.]97 Jan 17, 2022 44925 – The 1984\n\nmannlib[.]com 162.0.224[.]144 Aug 20, 2021 22612 – Namecheap\n\nnagios.dreamvps[.]com 185.145.253[.]62 Jan 17, 2022 213038 – DreamVPS\n\nopswat[.]info 194.195.241[.]46 Jan 11, 2022 63949 – Linode\n\n– 178.79.176[.]1 – 63949 – Linode\n\n## Attribution\n\nThe code, which we consider custom (Trojans, wrappers), has no similarities with previously\nknown campaigns or previously registered SilentBreak toolset modules. Right now we prefer\nnot to name the activity and instead stick to just “SilentBreak” given it is the most used\namong the tools here. If new modules appear and allow us to connect the activity to some\nactor we will update the name accordingly.\n\n\n-----\n\n## Conclusions\n\nWe consider the event logs technique, which we haven’t seen before, the most innovative\npart of this campaign. With at least two commercial products in use, plus several types of\nlast-stage RAT and anti-detection wrappers, the actor behind this campaign is quite capable.\nThere is the possibility that some of the modules we described here as custom ones are part\nof a commercial toolset as well. The code is quite unique, with no similarities to known\nmalware. We will continue to monitor similar activity.\n\nIn the Targeted Malware Reverse Engineering training course, Kaspersky experts share its\nbest and most valuable practices to build a safer world. Learn more about targeted malware\nwith Denis Legezo and other GReAT experts at: [https://kas.pr/bgy7](https://kas.pr/bgy7)\n\n## Indicators of Compromise\n\n### File Hashes (malicious documents, trojans, emails, decoys)\n\n**Dropper**\n\n[822680649CDEABC781903870B34FB7A7](https://opentip.kaspersky.com/822680649CDEABC781903870B34FB7A7/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[345A8745E1E3AE576FBCC69D3C8A310B](https://opentip.kaspersky.com/345A8745E1E3AE576FBCC69D3C8A310B/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[EF825FECD4E67D5EC5B9666A21FBBA2A](https://opentip.kaspersky.com/EF825FECD4E67D5EC5B9666A21FBBA2A/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[FA5943C673398D834FB328CE9B62AAAD](https://opentip.kaspersky.com/FA5943C673398D834FB328CE9B62AAAD/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**Logs code launcher**\n\n[2080A099BDC7AA86DB55BADFFBC71566](https://opentip.kaspersky.com/2080A099BDC7AA86DB55BADFFBC71566/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[0D415973F958AC30CB25BD845319D960](https://opentip.kaspersky.com/0D415973F958AC30CB25BD845319D960/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[209A4D190DC1F6EC0968578905920641](https://opentip.kaspersky.com/209A4D190DC1F6EC0968578905920641/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[E81187E1F2E6A2D4D3AD291120A42CE7](https://opentip.kaspersky.com/E81187E1F2E6A2D4D3AD291120A42CE7/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**HTTP Trojan**\n\n[ACE22457C868DF82028DB95E5A3B7984](https://opentip.kaspersky.com/ACE22457C868DF82028DB95E5A3B7984/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[1CEDF339A13B1F7987D485CD80D141B6](https://opentip.kaspersky.com/1CEDF339A13B1F7987D485CD80D141B6/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[24866291D5DEEE783624AB51516A078F](https://opentip.kaspersky.com/24866291D5DEEE783624AB51516A078F/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[13B5E1654869985F2207D846E4C0DBFD](https://opentip.kaspersky.com/13B5E1654869985F2207D846E4C0DBFD/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**Named pipes trojan and similar**\n\n[59A46DB173EA074EC345D4D8734CB89A](https://opentip.kaspersky.com/59A46DB173EA074EC345D4D8734CB89A/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[0B40033FB7C799536C921B1A1A02129F](https://opentip.kaspersky.com/0B40033FB7C799536C921B1A1A02129F/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[603413FC026E4713E7D3EEDAB0DF5D8D](https://opentip.kaspersky.com/603413FC026E4713E7D3EEDAB0DF5D8D/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**Anti-detection wrappers/decryptors/launchers, not malicious by themselves**\n\n[42A4913773BBDA4BC9D01D48B4A7642F](https://opentip.kaspersky.com/42A4913773BBDA4BC9D01D48B4A7642F/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[9619E13B034F64835F0476D68220A86B](https://opentip.kaspersky.com/9619E13B034F64835F0476D68220A86B/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[0C0ACC057644B21F6E76DD676D4F2389](https://opentip.kaspersky.com/0C0ACC057644B21F6E76DD676D4F2389/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n\n-----\n\n[16EB7B5060E543237ECA689BDC772148](https://opentip.kaspersky.com/16EB7B5060E543237ECA689BDC772148/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[54271C17684CA60C6CE37EE47B5493FB](https://opentip.kaspersky.com/54271C17684CA60C6CE37EE47B5493FB/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[77E06B01787B24343F62CF5D5A8F9995](https://opentip.kaspersky.com/77E06B01787B24343F62CF5D5A8F9995/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[86737F0AE8CF01B395997CD5512B8FC8](https://opentip.kaspersky.com/86737F0AE8CF01B395997CD5512B8FC8/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[964CB389EBF39F240E8C474E200CAAC3](https://opentip.kaspersky.com/964CB389EBF39F240E8C474E200CAAC3/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[59A46DB173EA074EC345D4D8734CB89A](https://opentip.kaspersky.com/59A46DB173EA074EC345D4D8734CB89A/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[A5C236982B0F1D26FB741DF9E9925018](https://opentip.kaspersky.com/A5C236982B0F1D26FB741DF9E9925018/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[D408FF4FDE7870E30804A1D1147EFE7C](https://opentip.kaspersky.com/D408FF4FDE7870E30804A1D1147EFE7C/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[DFF3C0D4F6E2C26936B9BD82DB5A1735](https://opentip.kaspersky.com/DFF3C0D4F6E2C26936B9BD82DB5A1735/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[E13D963784C544B94D3DB5616E50B8AE](https://opentip.kaspersky.com/E13D963784C544B94D3DB5616E50B8AE/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[E9766C71159FC2051BBFC48A4639243F](https://opentip.kaspersky.com/E9766C71159FC2051BBFC48A4639243F/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[F3DA1E157E3E344788886B3CA29E02BD](https://opentip.kaspersky.com/F3DA1E157E3E344788886B3CA29E02BD/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n### Host-based IoCs\n\nC:\\Windows\\Tasks\\wer.dll\n\nC:\\Windows\\Tasks\\WerFault.exe copy of the legit one to sideload the malicious .dll\n\nNamed pipe MonolithPipe\n\nEvent logs with category 0x4142 in Key Management Service source. Events ID auto\nincrements starting from 1423.\n\n### PDB paths\n\nC:\\Users\\admin\\source\\repos\\drx\\x64\\Release\\sb.pdb\n\nC:\\Users\\admin\\source\\repos\\drx\\x64\\Release\\zOS.pdb\n\nC:\\Users\\admin\\source\\repos\\drx\\x64\\Release\\ThrowbackDLL.pdb\n\nC:\\Users\\admin\\source\\repos\\drx\\x64\\Release\\drxDLL.pdb\n\nC:\\Users\\admin\\source\\repos\\drx\\x64\\Release\\monolithDLL.pdb\n\n[Digital Certificates](https://securelist.com/tag/digital-certificates/)\n[Fileless malware](https://securelist.com/tag/fileless-malware/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[RAT Trojan](https://securelist.com/tag/rat-trojan/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\n[Denis Legezo](https://securelist.com/author/denislegezo/)\n\nA new secret stash for “fileless” malware\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-04 - A new secret stash for “fileless” malware.pdf"
    ],
    "report_names": [
        "2022-05-04 - A new secret stash for “fileless” malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "72aaa00d-4dcb-4f50-934c-326c84ca46e3",
            "created_at": "2023-01-06T13:46:38.995743Z",
            "updated_at": "2025-03-27T02:00:02.972623Z",
            "deleted_at": null,
            "main_name": "Slingshot",
            "aliases": [],
            "source_name": "MISPGALAXY:Slingshot",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f55c7778-a41c-4fc6-a2e7-fa970c5295f2",
            "created_at": "2022-10-25T16:07:24.198891Z",
            "updated_at": "2025-03-27T02:02:10.138587Z",
            "deleted_at": null,
            "main_name": "Slingshot",
            "aliases": [],
            "source_name": "ETDA:Slingshot",
            "tools": [
                "Cahnadr",
                "GollumApp",
                "NDriver"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535684,
    "ts_updated_at": 1743041494,
    "ts_creation_date": 1653750573,
    "ts_modification_date": 1653750573,
    "files": {
        "pdf": "https://archive.orkl.eu/3d7a340c8d9426b4d179de0569cb0437b70c7cc1.pdf",
        "text": "https://archive.orkl.eu/3d7a340c8d9426b4d179de0569cb0437b70c7cc1.txt",
        "img": "https://archive.orkl.eu/3d7a340c8d9426b4d179de0569cb0437b70c7cc1.jpg"
    }
}