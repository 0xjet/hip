{
    "id": "497b1245-094e-4dff-9bee-2135344eea9d",
    "created_at": "2023-01-12T15:10:22.925434Z",
    "updated_at": "2025-03-27T02:05:48.515639Z",
    "deleted_at": null,
    "sha1_hash": "5d2e9b71c85467002dced1aa7169be874e354bcd",
    "title": "2022-08-29 - Office Files, RTF files, Shellcode and more shenanigans",
    "authors": "",
    "file_creation_date": "2022-09-01T10:30:50Z",
    "file_modification_date": "2022-09-01T10:30:50Z",
    "file_size": 1705934,
    "plain_text": "# Office Files, RTF files, Shellcode and more shenanigans\n\n**[inquest.net/blog/2022/08/29/office-files-rtf-files-shellcode-and-more-shenanigans](https://inquest.net/blog/2022/08/29/office-files-rtf-files-shellcode-and-more-shenanigans)**\n\nIn a previous [post, we discussed the “@” symbol used to separate an apparent legitimate](https://inquest.net/blog/2022/07/05/automated-twitter-post-decoded-shellcode)\nURL from the real target. In this case, there has been a small flood using the URL of\n“http://jmcglone.com@” with many different URLs or IP addresses after the “@” symbol. If we\nlook at the VirusTotal information for this page, we see the online scan says it is clean and\nthat it has also been around for ten years.\n\nThis web page is never actually called it is the URL after the “@” symbol that is called!\n\n\n-----\n\nRunning a search in InQuest Labs for that domain name we find there are currently 116 hits\nfor It.\n\nWe usually find that these documents have little or no content in them and have an external\n[relationship or external link. File found here.](https://labs.inquest.net/dfi/sha256/6e66b6175b31b547ad24375b7c5961e51aa1b37cdb3cd39d7ec5b2108fbacb40)\n\n\n-----\n\nHere we see how they are sent, and only the data after the “@” is actually called. Again\nthese will download an RTF document and using CVE-2017-1182 it will decode the\nembedded shellcode and then call out to download the final malware.\n\nWe find that this site has an open directory. Pretty much every one checked had an open\ndirectory.\n\n\n-----\n\nAs you can see, the file extension says “doc,\" but it is in fact an obfuscated RTF. The\nobfuscation is to split up the hex string of the shellcode using various spaces, tabs, newlines,\nand vertical tabs. For some reason, Office will ignore those characters and run the shellcode.\n\nUsing a highly experimental tool I wrote to extract the decoded shellcode we can see that\nthis will call out to.\n\nhxxp://103.207.38[.]192/outlook/scrss.exe\n\n\n-----\n\nWe can see that this file is in an open directory too.\n\nSHA256:\n275DB34B1B3D894ED18FBA50F477CA897BB3656682C7D0EF2941BD7C696E9F80\n\n[Running this sample thru a sandbox ID’s it as GuLoader. You can find the sample Here on](https://bazaar.abuse.ch/sample/275db34b1b3d894ed18fba50f477ca897bb3656682c7d0ef2941bd7c696e9f80/)\nMalwareBazaar.\n\nUsing the Indicator lookup on the IP for the downloaded file we can see there were several\nhits for it and the IP is detected as malicious.\n\n\n-----\n\nPivoting on the first link from the Lookup window to UrlHaus we can see that the same IP is\nused for more than one path. We can also see that it will contain many different malware\n[families with the same File name. Looking at a second file, we can see that the URL in front](https://labs.inquest.net/dfi/sha256/fa490c0e29b4cf444bee6b6d4b79e87942231c7b703f54e8db4f0e7212cebcbc)\nof the “@” symbol is different.\n\n“hxxp://www.mygreatlearning[.]com@192.3.108[.]11/vnc/https_n/www.doc”\n\n\n-----\n\nUsing the Indicator Lookup we find that we have 28 files currently with that URL.\n\n\n-----\n\nGoing back and looking at the IP with the indicator lookup we see we still only have 28 files\nof various sizes.\n\nHere we can see that there are multiple directory’s using that IP address.\n\n\n-----\n\nClicking the First link we can go to URLhaus, and we can see an indicator that they are\nalready offline and it is an open Directory. I captured this sample before this screenshot\nabove so what does this open directory look like.\n\n\n-----\n\nHere we see it has multiple sub-directories.\n\n\n-----\n\nOpening the first one we see that in this case there is only one file per subdirectory. They all\nhad the same filename name as well.\n\nGoing thru each subfolder and decoding the shellcode gives us this list of links to the final\nmalware files. At the time of writing this not all links were still active so the final malware was\nnot Downloaded.\n\n44ff72cde2a2ea2d0b4d24a29eb5211b9bfab4320cd1cd1e0d3388196bd6b811\n\n5a45a186f3a839d3e0e5665a4586bcb274548ebc8f3e9c0a8f380a61c287588d\n\n6c4452cba037fd16c4645244b02f98154b28f03b4936531e04aac27e74993b60\n\n\n-----\n\n736330aaa3a4683d3cc866153510763351a60062a236d22b12f4fe0f10853582\n892dbbf96b0dfceaed934bc1c9217ff5efb260f954c251c4555f4c122be6994f\n\nb12ae2a6e36a78e3fe5ace248cf1c26beaaa3800f185928aaa8c4bddd98913c5\n\nc22327d04baefd48d8c2d90173c47211bdac29b4654fab872e2eee22738ee044\n\nf541ca7eef56b206c61004b37a65c0b05f753573c0cc9b6dbbcda44d7a3b4a66\n\nHere is a unique list of hashes for those files that could be downloaded. The detected\nfamilies varied and it even contained a putty.exe. The next thing we find is a series of Link\nshorteners used.\n\nIf we look at this one posted on Twitter by InQuest [here .](https://twitter.com/InQuest/status/1562469237595115520)\n\n\n-----\n\n-----\n\nHere we can see it expands to the original style of link we first seen.\n\nThis one uses two different link shortners.\n\n\n-----\n\n[I found this one here on Twitter by m4n0w4r @kienbigmummy and on InQuest Labs here .](https://twitter.com/kienbigmummy/status/1563459518633111553)\nWe find another link shortner.\n\n\n-----\n\nAs you can see from the screenshot above it follows the same pattern. This screenshot was\njust taken so the file may be down now noting the 404. As we have seen here they are\nreusing the IPs and URLs leaving an open directory. They just keep adding and removing\nsub-directories for the same IPs.\n\nThey are also experimenting with various Link shortening services to hide further the URLs\nthey are calling out to. Lastly, we also see multiple malware families being dropped as the\nfinal malware.\n\n\n-----\n\nSo you never know what you are going to end up with these.\n\n## Links\n\nPrevious Post Link:\n\n[https://inquest.net/blog/2022/07/05/automated-twitter-post-decoded-shellcode](https://inquest.net/blog/2022/07/05/automated-twitter-post-decoded-shellcode)\n\nLink to the first sample on InQuest Labs:\n\nhttps://labs.inquest.net/dfi/sha256/6e66b6175b31b547ad24375b7c5961e51aa1b37cdb3cd39\nd7ec5b2108fbacb40\n\nLink to sample on MalwareBazaar:\n\nhttps://bazaar.abuse.ch/sample/275db34b1b3d894ed18fba50f477ca897bb3656682c7d0ef29\n41bd7c696e9f80/\n\nLink to the Second file on InQuest Labs:\n\nhttps://labs.inquest.net/dfi/sha256/fa490c0e29b4cf444bee6b6d4b79e87942231c7b703f54e8\ndb4f0e7212cebcbc\n\nLink to Twitter post for first shortened Link:\n\n[https://twitter.com/InQuest/status/1562469237595115520](https://twitter.com/InQuest/status/1562469237595115520)\n\nLink to m4n0w4r Twitter post:\n\n[https://twitter.com/kienbigmummy/status/1563459518633111553](https://twitter.com/kienbigmummy/status/1563459518633111553)\n\nLink to InQuest labs for sample:\n\nhttps://labs.inquest.net/dfi/sha256/797ad98c5e34adaf78da488638b1bfe724d2750844e2d67\n725b0e84a2aa14c06\n\nTags\n\n[in-the-wild\nlabs\nwalkthrough](https://inquest.net/taxonomy/term/8)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-29 - Office Files, RTF files, Shellcode and more shenanigans.pdf"
    ],
    "report_names": [
        "2022-08-29 - Office Files, RTF files, Shellcode and more shenanigans.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536222,
    "ts_updated_at": 1743041148,
    "ts_creation_date": 1662028250,
    "ts_modification_date": 1662028250,
    "files": {
        "pdf": "https://archive.orkl.eu/5d2e9b71c85467002dced1aa7169be874e354bcd.pdf",
        "text": "https://archive.orkl.eu/5d2e9b71c85467002dced1aa7169be874e354bcd.txt",
        "img": "https://archive.orkl.eu/5d2e9b71c85467002dced1aa7169be874e354bcd.jpg"
    }
}