{
    "id": "91afe1a1-9000-4cce-b43e-a065a5377ced",
    "created_at": "2022-10-25T16:48:23.678176Z",
    "updated_at": "2025-03-27T02:15:06.298072Z",
    "deleted_at": null,
    "sha1_hash": "acc670862c4fc12a28385b0c4438d1e32fd917ed",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-11-29T09:37:56Z",
    "file_modification_date": "2018-11-29T09:37:56Z",
    "file_size": 3092931,
    "plain_text": "# RESEARCH\n\n## 数 据 驱 动 安 全\n\n\n## Analysis Of Targeted Attack Against Pakistan By Exploiting InPage Vulnerability And Related APT Groups\n\n### By 360威胁情报中心 | 事件追踪\n\n Overview\n\nRecently, 360 Threat Intelligence Center found a series of targeted attacks against Pakistan targets.\n\nAttacker exploited one vulnerability (CVE-2017-12824) of InPage to craft bait documents (.inp). InPage is a\n\nword processing software designed specifically for Urdu speakers (official language in Pakistan). In\n\naddition, Office documents with CVE-2017-11882 vulnerability were also used in the attack. Kaspersky\n\ndisclosed one target attack in which InPage vulnerability was exploited in November 2016[6] . However, first\n\nattack by using such software vulnerability can be traced back to June 2016[14].\n\nThrough the analysis of this group of documents with InPage vulnerabilities and related attack activities,\n\nwe can conclude that the attacker is BITTER APT organization disclosed by us in 2016 [5] . After further\n\nanalysis, some samples in the attack have strong connections with some APT groups, specifically\n\nPatchwork, Bahamut, and Confucius. That shows more connections among those 4 APT groups from South\n\nAsian.\n\n### Timeline\n\n360 Threat Intelligence Center sorts out the timeline of targeted attacks in which InPage vulnerability\n\nwas exploited in the past two years as following:\n\n\n-----\n\n### InPage Vulnerability Analysis (CVE-2017-12824)\n\nThe scan result of documents with InPage vulnerability on VirusTotal:\n\nInPage is a word processing software specially designed for Urdu speakers, and the vulnerability\n\nnumber involved in the wild attack sample is CVE-2017-12824.\n\nAfter the analysis of the vulnerability by 360 Threat Intelligence Center, it was found that the\n\nvulnerability was caused by the fact that InPage word processing software did not check the data type\n\n(Type) to be processed when it is processing document flow, which led to the out-of-bounds reading.\n\nThrough carefully constructed InPage document, arbitrary code could be triggered to execute.\n\n\n-----\n\nfollows.\n\nInPage 2015\n\n### Cause of Vulnerability: Out-of-bound Read\n\nThe essence of the CVE-2017-12824 vulnerability is out-of-bound Read. The InPage word processor\n\ndoes not check the data type to be processed while processing the InPage100 stream in the document, and\n\nthe data type to be processed is specified by a field in the InPage document. This allows an attacker to\n\ncause an InPage program to make an out-of-bounds read error by setting a value outside the Type range.\n\nThe key data structures that trigger the vulnerability in document (.inp) are as follows. 0x7E and 0x72\n\nrepresent a class of type in the document stream to be processed. We mark 0x7E as Type1 and 0x72 as\n\nType2:\n\nInPage processes a.inp file as follows:\n\nInPage first calls Ole!The StgCreateDocfile function parses the entire.inp file and then calls Ole!\n\nCOleStreamFile: : OpenStream open InPage InPage100 data flow in the document:\n\n\n-----\n\nfunction, and the data in the stream will be read with the callback function InPage100Read_440ED0:\n\nThe trigger vulnerability Type data, 0x7E and 0x72 mentioned earlier, is eventually processed by the\n\nfunction sub_453590.The buf in the figure below reads the data containing Type by calling\n\nInPage100Read_440ED0:\n\nThe vulnerability function sub_453590 will select the corresponding processing process according to\n\nType1 and Type2 (0x7E and 0x72 bytes). First, it reads the function pointer array according to Type1, then\n\nreads the function from the function pointer array according to Type2, and finally calls the function to\n\nprocess data:\n\nLet's look at the assignment and range of dword_656A28 in the figure above:\n\nType1 = ECX(0x1F8)>>2 = 0x7E(126), Type2 = EDI(0x72) :\n\n\n-----\n\nYou can see that the actual size of the dword_656E60 array is 30 (0x1E) :\n\nSince the size of Type2 in the vulnerability document is set to 0x72, EDI=0x72, but the InPage does not\n\njudge the size of Type2 passed in, this will result in access to dword_656E60[0x72], and because\n\n0x72>30(0x1E), an out-of-bounds read error occurs.\n\n### The Exploitation\n\nSince the attacker sets Type2 in the document to 0x72, after addressing calculation, the code at the\n\nfunction address 0x00455AFA will be accessed across the line:\n\nYou can see that dword_656E60[0x72] (0x455AFA) is just a pop retn instruction:\n\nThe pop retn instruction sequence plays a role as \"jump\" address, when performing Type related\n\nprocessing function, due to the incoming parameters (pointer: 0 x031e383f) pointing to a data InPage\n\ndocument flow, an attacker can fill the controllable data flow with ShellCode, so after the pop retn\n\ninstructions will be returned directly to the attacker set ShellCode executed:\n\n\n-----\n\nHowever, the InPage program does not turn on DEP and ASLR protection, which results in ShellCode\n\nbeing directly executed:\n\n### Analysis of Four Types of Attack Framework Using InPage Vulnerability\n\n360 Threat Intelligence Center conducted analysis on the samples with InPage vulnerabilities in\n\nPakistan, found that a number of samples generated time, size, initial ShellCode InPage100 document flow\n\nand related flow label all consistent. We can confirm that those samples come from same source.\n\nThrough the analysis of this batch of InPage vulnerability utilization documents and relevant malicious\n\ncode, we found that the malicious code carried by the vulnerability documents used four different types of\n\nattack frameworks: four types of completely different backdoor programs. The analysis is as follows.\n\n### WSCSPL:Full - featured Backdoor\n\n\n-----\n\nData Records. Inp\" (SOP for Mobile Data Records Retrieval). Cve-2017-12824 vulnerability utilization\n\ndocument will eventually download and execute a full-featured back door program named WSCSPL.\n\nRelevant vulnerability utilization document information is as follows:\n\nMD5 863f2bfed6e8e1b8b4516e328c8ba41b\n\nThe file name For Retrieval of Mobile Data Records, SOP for Retrieval of Mobile Data Records. Inp\n\nShellCode\n\nAfter the bug is successfully triggered, ShellCode will locate the main function ShellCode by searching\n\nthe special logo \"27862786\". Then it will download Payload from khurram.com.pk/js/drv and save it to\n\nc:\\conf\\ smss.exe for execution:\n\nDownloader\n\nMD5 c3f5add704f2c540f3dd345f853e2d84\n\nCompile time 2018.9.24\n\nC: \\ Users \\ Asterix \\ Documents \\ 28 novdwn VisualStudio2008 \\ Projects \\ \\ Release \\ 2\nPDB path\n8 novdwn PDB\n\nThe downloaded EXE file is mainly used to communicate with C2 and obtain the executables of other\n\nmodules. After execution, the registry key value (key: HKCU\\Environment, key value: AppId, data: c:\\ Intel\n\n\\drvhost. EXE) will be set first.\n\nPersistence is achieved by adding itself to the registry bootstrap:\n\nAnd determine whether the current process path is c:\\ Intel \\drvhost. Exe, if not, copy itself to the path\n\nand execute:\n\n\n-----\n\nWhen the process path meets the conditions, the machine GUID, computer user name and other\n\ninformation obtained from the registry are encrypted and concatenated into a string:\n\nThen send the constructed string to communicate with C2:nethosttalk.com and get the command to\n\nexecute again:\n\nIn this case, the C2 server returns an AXE:# instruction. The native program determines whether the\n\ninstruction is an AXE:# or an AXE.\n\n\n-----\n\nIn the process of debugging and analysis by 360 Threat Intelligence Center analysts, we successfully\n\nobtained an executable plug-in named \"WSCSPL\" :\n\nBackdoor - WSCSPL\n\nMD5 1c2a3aa370660b3ac2bf0f41c342373b\n\nCompile time 2018.9.13\n\nOriginal file name Exe winsvc.\n\nThis Trojan has same functionality as the Trojan used by Patchwork APT group disclosed by us in\n\n2016[5]. The Trojan supports 17 commands, including uploading a list of hard disk, finding, reading,\n\ncreating a specified file, enumerating a list of processes, and ending a specified process. Trojan function\n\nanalysis is as follows:\n\nSet two 10-second interval timers after the Trojan program runs:\n\nTimer 1: request the IP of C&C:wcnchost.ddns.net. If the request is successful, save the IP to the\nglobal variable and set the id variable to 1.\n\n\n-----\n\nTimer 2: check the value of the identifying variable, if 1, try to connect C&C:\n\nThen create two threads:\n\nThread 1: detects the connection status with C&C and receives the C&C command executable if the\nconnection is successful\n\n\n-----\n\nThread 2: checks whether the global variable dword_C9618 has data, and if so, sends the data to\nC&C\n\nThe command execution code snippet is as follows:\n\n\n-----\n\n3000 Get RAT status information\n\n3001 Get computer hard disk information\n\n3002 Gets the list of files in the specified directory\n\n3004 Get RAT log 1\n\n3005 Create the specified file\n\n3006 Writes data to the create file\n\n3007 Open the specified file\n\n3009 Reads the contents of the specified file\n\n3012 Create remote console\n\n3013 Execute remote commands\n\n3015 Get RAT log 2\n\n3016 End remote console\n\n3017 Closes the specified handle\n\n3019 Gets a process that has an UPD active link\n\n3021 Get RAT log 3\n\n3032 End the specified process\n\n3023 Gets process information in the system\n\n3025 Get RAT log 4\n\n### Visual Basic Backdoor\n\nAnother captured vulnerability exploit document, CVE-2017-12824 named ‘AAT national assembly\n\nfinal.inp’, drop the backdoor written by Visual Basic.\n\nRelevant vulnerability document information is as follows:\n\nMD5 ce2a6437a308dfe777dec42eec39d9ea\n\nThe file name The AAT national assembly final. Inp\n\nShellCode\n\nFirst, ShellCode triggered by the vulnerability locates the main ShellCode through the memory global\n\nsearch string \"LuNdLuNd\" :\n\n\n-----\n\nLocate the main ShellCode and get the API functions you want to use, and ensure that only one\n\ninstance runs by creating the mutex \"QPONMLKJIH\" :\n\nThen extract a DLL module contained in the document and execute it by memory loading:\n\nDropper\n\nMD5 43920ec371fae4726d570fdef1009163\n\nC: \\ users \\ mz \\ documents \\ visualstudio2013 \\ Projects \\ Shellcode \\ Release \\ Shellcod\nThe PDP path\ne PDB\n\nThe DLL file loaded in memory is a Dropper, which contains two resource files, \"Bin\" and \"Bin2\" :\n\n\n-----\n\nBin file is the back door program written by Visual Basic, while Bin2 is the normal inp decoy file\n\nreleased and opened after the vulnerability is triggered. The contents of relevant decoy documents are as\n\nfollows:\n\nBackdoor - SMTPLDR. Exe\n\nMD5 694040b229562b8dca9534c5301f8d73\n\nCompile time 2018.7.4\n\nOriginal file name Exe SMTPLDR.\n\n\n-----\n\nexecution. After the Trojan horse runs, it first gets the installed application name of the current system\n\nfrom \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\" :\n\nThen determine whether the installed application includes kaspersky, NORTON, trend technology and\n\nother related software killing applications:\n\nThen WMI executes the select * from win32_computersystem command to get the application\n\ninformation and detect the virtual machine environment by determining whether the word \"virtual\" is\n\nincluded in the name:\n\n\n-----\n\nIf the detection is in the virtual machine environment, the popover displays not a valid file and exits:\n\nIf the detection passes, \"SMTP Loader. LNK\" will be created in the directory of %Start% to achieve\n\nself-startup:\n\n\n-----\n\nFinally, it communicates with C&C: referfile.com to obtain subsequent instruction execution:\n\n### Delphi Backdoor Program\n\n360 Threat Intelligence Center found a batch of backdoor written by Delphi through big data\n\ncorrelation, which are also documents with InPage vulnerability. Relevant sample information is as follows:\n\nMD5 fec0ca2056d679a63ca18cb132223332\n\nOriginal file name Exe adobsuit.\n\nThe captured Delphi backdoor is the same as the backdoor written by Visual Basic, which is also\n\nreleased from the resource file by similar Dropper and created by creating Adobe creative suit. LNK file in\n\nthe directory of %Start% and pointing to the implementation of persistence:\n\nThe backdoor will Ducument in % % folder to create the users. The TXT file, and random write 30\n\nbytes of the string:\n\n\n-----\n\nTrojan program will access to a computer user name and the computer user name after encrypting the\n\nDucument to % % / SyLog. The log file:\n\nAfter that, I communicated with C2:errorfeedback.com and sent the contents of sylog.log file as POST:\n\nWhen C2 returned to Success, and C2 communication in the form of HTTP GET request again, if return\n\na string, continued to from \"errorfeedback.com/ MarkQuality455\n\nTTGKWoFdyQHEwpyYKmfVGtzQLfeqpJ/string\" perform download the following content:\n\n\n-----\n\n### A Backdoor Using Cobalt Strike\n\nAnother captured InPage vulnerability exploit document ends up executing a backdoor generated by\n\nCobalt Strike, with the following documentation information:\n\nMD5 74aeaeaca968ff69139b2e2c84dc6fa6\n\nThe file type InPage vulnerability exploit documentation\n\nFind the time 2018.11.02\n\nShellCode\n\nAfter the vulnerability is successfully triggered, ShellCode first locates the main ShellCode with the\n\nspecial identifier \"LuNdLuNd\", and then loads the attached DLL in memory and executes.\n\nDropper\n\nMD5 ec834fa821b2ddbe8b564b3870f13b1b\n\nC: \\ users \\ mz \\ documents \\ visualstudio2013 \\ Projects \\ Shellcode \\ Release \\ Shellcod\nPDB path\ne PDB\n\nMemory loaded DLL file and the above Visual Basic/Delphi back door, is also from the resources to\n\nrelease Trojan files and execute:\n\n\n-----\n\nDownloader - winopen. Exe\n\nMD5 09d600e1cc9c6da648d9a367927e6bff\n\nCompile time 2018.10.12\n\nRelease the Downloader executive called winopen. Exe, it will get a normal JPEG file header from\n\njospubs.com/foth1018/simple.jpg encrypted files, if successful, is from the JPEG file 49th bytes begin with\n\n0 x86 or decryption:\n\nThe decrypted file is a DLL file, which is then loaded and executed.DLL program will first determine the\n\nrunning environment and check whether the DLL loading process is rundll32.exe:\n\n\n-----\n\nIf the loading process is not rundll32.dll, release the backdoor program named aflup64.dll under C:\n\nProgramData\\Adobe64:\n\nExe \"C:\\ ProgramData\\ Adobe64\\ aflup64.dll\", exe \"C:\\ ProgramData\\ Adobe64\\ aflup64.dll\"\n\n\n-----\n\nBackdoor - aflup64. DLL\n\nMD5 91e3aa8fa918caa9a8e70466a9515666\n\nCompile time 2018.10.12\n\nExportation IntRun will do the same thing again, get the JPEG file, xor decrypt it, and then\n\nexecute.Because it is through rundll32 starts, so will go to another branch, first create the mutex \"9\n\na5f4cc4b39b13a6aecfe4c37179ea63\" :\n\nThen, create \"nnp74DE. TMP\" file in the directory of %TEMP%. Then, execute the command tasklist,\n\nipconfig./all, dir to get system process information, network information, file list and so on.\n\nThen get the machine ID, system version, current system time, connect all the acquired information\n\nbeginning with \"tag FluffyBunny\", base64-encoded connect C&C and upload:\n\n\n-----\n\nAfter the information transmission is successful, Base64 encoding of the string \"OK\" will be returned:\n\nIf the request line is not successful, the request line is looped.After the successful launch, it will enter\n\nthe second stage to send base64-encoded data of calculation name-user name to\n\njospubs/foth1018/go.php and obtain the command execution:\n\n\n-----\n\nsupports 5 commands in total. The list of relevant commands is as follows:\n\nThe command ID function\n\n103 Download the Plugin and drop it into the %TEMP% directory\n\n105 Gets the file memory load\n\n115 Gets the contents of the parameter file\n\n117 Delete the start. LNK file\n\n120 Download the file to the %temp% directory and delete start.lnk\n\nThe Plugins - jv77CF. TMP\n\nMD5 c9c1ec9ae1f142a8751ef470afa20f15\n\nCompile time 2018.4.3\n\nIn the debugging process of 360 Threat Intelligence Center analysts, we successfully acquired a Trojan\n\nhorse plug-in which was executed on the ground.The Trojan plugin continues to get the encrypted file from\n\npp5.zapto.org:\n\n\n-----\n\nUpon successful retrieval, hetero or decryption is performed, and the decrypted file is a remote back\n\ndoor generated by Cobalt Strike:\n\n\n-----\n\n### Analysis of CVE-2017-11882 Samples\n\nBy expanding the big data platform of 360 Threat Intelligence Center, we found a vulnerability\n\nutilization document of Office cve-2017-11882 belonging to the same series of attack activities.The\n\ndocument is called \"SOP for Retrieval of Mobile Data Records. Doc\", which is the same name as the\n\n\n-----\n\nimpersonal Records). However, the vulnerability document is targeted at Microsoft Office.\n\nMD5 61a107fee55e13e67a1f6cbc9183d0a4\n\nThe file name For SOP for Retrieval of Mobile Data Records. Doc\n\nThe Objdata object information containing the vulnerability is as follows:\n\nAfter the vulnerability successfully triggers the execution, subsequent Payload executables will be\n\nobtained by means of the same download address as the SOP for Retrieval of Mobile Data Records. Inp\n\n(InPage) vulnerability makes use of the file for the Retrieval of Mobile Data Records:\n\n### Attribution and Correlation\n\n360 Threat Intelligence Center through the analysis of this batch of InPage vulnerability utilization\n\ndocuments and related attack activities it is the \"BITTER\" APT organization disclosed by 360 company in\n\n\n-----\n\nanalysis, many samples in the series of attacks are also strongly related to APT organizations such as\n\nmahagrass, Bahamut and Confucius.\n\n### BITTER APT Group\n\nAfter in-depth analysis of several InPage vulnerability documents with a relatively short attack time by\n\n360 Threat Intelligence Center, it was found that the Trojan program released by the vulnerability document\n\nwas the backdoor program used by APT organization \"manlinghua\" exposed by 360 company in 2016[5], is\n\nthe analysis of the WSCSPL full - featured backdoor program.\n\nCommand ID Function\n\n2000 Retrieve RAT status information\n\n2001 Retrieve hard disk list\n\n2002 Retrieve file list in given directory\n\n2004 Retrieve RAT log 1\n\n2005 Create file by given filename\n\n2006 Write bytes into created file (2005)\n\n2007 Open file\n\n2009 Read file content (2007)\n\n2012 Create remote console\n\n2013 Execute remote command\n\n2015 Retrieve RAT log 2\n\n2016 Terminate remote console\n\n2017 Close handle\n\n2019 Retrieve a list of processes with UPD activity link\n\n2021 Retrieve RAT log 3\n\n2022 Terminate process by process ID\n\n2023 Retrieve a list of active processes\n\n2025 Retrieve RAT log 4\n\nIn addition, many of these C&C addresses are also strongly related to APT organization \"manlinghua\" in\n\nthe internal analysis platform of 360 Threat Intelligence Center. These C&C addresses have been\n\nrepeatedly used in attacks against China.Therefore, the relevant attack activities can be identified as \"vine\n\nspirit flower\".\n\n### Relation to Confucius\n\n\n-----\n\nexploring Confucius and mahagrass similarity[10]Appears that the domain name has been disclosed as a\n\ntrend of Confucius use.\n\n### Relation to Patchwork\n\nThrough the in-depth analysis and correlation of Delphi backdoor attack framework mentioned above,\n\nwe also found that the attack framework and sample also appeared in the InPage attack sample analyzed\n\nby Palo Alto in 2017[13]Palo Alto thought the attack framework and backdoor might have something to do\n\nwith mahagrass.\n\n### Relation to \"Bahamut\"\n\nA vulnerability document \"AAT national assembly final.inp\" analyzed by 360 Threat Intelligence Center\n\ninto the attack activity was finally executed by the Trojan horse (Visual Basic backdoor program) using the\n\ndomain name referfile.com as C2, which was published by Cisco Talos security research team in July 2018\n\nas \"a case of targeted attack against Indian iOS users\".[9]It was revealed that Talos security research team\n\nassociated with this domain name was also used by a Visual Basic backdoor program, and the related\n\nnetwork assets were suspected to be owned by APT organization \"Bahamut\".\n\n### Summary and Conjecture\n\n360 Threat Intelligence Center analyzed a group of document samples with same attribution\n\n(timestamp, ShellCode, InPage100 flow size, flow characteristics), and found that those samples use at\n\nleast 4 different malicious code framework, and have connections with \"PatchWork\", \"BITTER”,\n\n\"Confucius\", \"Bahamut\" APT organization has produced more or less.Maybe these APT groups are actually\n\none group? Or their digital weapons are provided by one vendor(Their supporter give them same\n\n\n-----\n\nBITTER PatchWork Confucius Bahamut\n\nSouth Asia (mainly Pakis\nTarget China, Pakistan China, Pakistan South Asia\ntan), Middle East\n\nAttack platform PC/Android PC/Android PC/Android PC/Android/iOS\n\nProgramming la\nC Delphi/c # Delphi Delphi/VB\nnguage\n\n\nSpear-phishing\nAttack vector\nattack\n\n### IOC\n\n\nSocial networks, spear-phi Social networks, spearSocial network\nshing attack phishing attack\n\n\nDocuments with InPage vulnerability\n\n\n863f2bfed6e8e1b8b4516e328c8ba41b\n\n\nce2a6437a308dfe777dec42eec39d9ea\n\n\n74aeaeaca968ff69139b2e2c84dc6fa6\n\n\nOffice vulnerability exploit documents\n\n\n61a107fee55e13e67a1f6cbc9183d0a4\n\n\nTrojans\n\n\nc3f5add704f2c540f3dd345f853e2d84\n\n\nf9aeac76f92f8b2ddc253b3f53248c1d\n\n\n8dda6f85f06b5952beaabbfea9e28cdd\n\n\n25689fc7581840e851c3140aa8c3ac8b\n\n\n1c2a3aa370660b3ac2bf0f41c342373b\n\n\n43920ec371fae4726d570fdef1009163\n\n\n694040b229562b8dca9534c5301f8d73\n\n\nfec0ca2056d679a63ca18cb132223332\n\n\nec834fa821b2ddbe8b564b3870f13b1b\n\n\n09d600e1cc9c6da648d9a367927e6bff\n\n\n91e3aa8fa918caa9a8e70466a9515666\n\n\n4f9ef6f18e4c641621f4581a5989284c\n\n\nafed882f6af66810d7637ebcd8287ddc\n\n\nC&C\n\n\n-----\n\nnethosttalk.com\n\n\nxiovo416.net\n\n\nnethosttalk.com\n\n\nnewmysticvision.com\n\n\nwcnchost.ddns.net\n\n\nreferfile.com\n\n\nerrorfeedback.com\n\n\nJospubs.com\n\n\ntraxbin.com\n\n\nreferfile.com\n\n\n### Reference\n\n[1]. https://ti.360.net/\n\n[2]. http://www.inpage.com/\n\n[3]. https://en.wikipedia.org/wiki/InPage\n\n[4]. https://ti.360.net/blog/articles/analysis-of-apt-campaign-bitter/\n\n[5]. https://www.anquanke.com/post/id/84910\n\n[6]. https://www.kaspersky.com/blog/inpage-exploit/6292/\n\n[7]. https://cloudblogs.microsoft.com/microsoftsecure/2018/11/08/attack-uses-malicious-inpage\ndocument-and-outdated-vlc-media-player-to-give-attackers-backdoor-access-to-targets/\n\n[8]. https://blog.talosintelligence.com/2018/07/Mobile-Malware-Campaign-uses-Malicious-MDM.html\n\n[9]. https://blog.talosintelligence.com/2018/07/Mobile-Malware-Campaign-uses-Malicious-MDM\nPart2.html\n\n[10]. https://blog.trendmicro.com/trendlabs-security-intelligence/confucius-update-new-tools-and\ntechniques-further-connections-with-patchwork/\n\n[11]. https://documents.trendmicro.com/assets/appendix-confucius-update-new-tools-techniques\nconnections-patchwork-updated.pdf\n\n[12]. https://researchcenter.paloaltonetworks.com/2016/09/unit42-confucius-says-malware-families\nget-further-by-abusing-legitimate-websites/\n\n[13]. https://researchcenter.paloaltonetworks.com/2017/11/unit42-recent-inpage-exploits-lead-multiple\nmalware-families/\n\n\n-----\n\nhttps://www.virustotal.com/gui/file/9bf55fcf0a25a2f7f6d03e7ba6123d5a31c3e6c1196efae453a74d6fff9d43b\n\nb/submissions\n\n蔓灵花 BITTER APT INPAGE 摩诃草 CONFUCIUS BAHAMUT\n\n分享到：\n\n首页\n\nAnalysis Of Targeted Attack Against Pakistan By Exploiting InPage Vulnerability And Related APT Groups\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.11.29.Attack_Pakistan_By_Exploiting_InPage/EN_version.pdf"
    ],
    "report_names": [
        "EN_version"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1543484276,
    "ts_modification_date": 1543484276,
    "files": {
        "pdf": "https://archive.orkl.eu/acc670862c4fc12a28385b0c4438d1e32fd917ed.pdf",
        "text": "https://archive.orkl.eu/acc670862c4fc12a28385b0c4438d1e32fd917ed.txt",
        "img": "https://archive.orkl.eu/acc670862c4fc12a28385b0c4438d1e32fd917ed.jpg"
    }
}