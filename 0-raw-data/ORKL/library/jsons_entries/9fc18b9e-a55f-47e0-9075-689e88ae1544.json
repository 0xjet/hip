{
    "id": "9fc18b9e-a55f-47e0-9075-689e88ae1544",
    "created_at": "2023-01-12T15:08:46.861835Z",
    "updated_at": "2025-03-27T02:17:11.828606Z",
    "deleted_at": null,
    "sha1_hash": "70ba70e94979ec5c6c7bbfcc1df416f5fc0cf763",
    "title": "2017-10-19 - APT28 racing to exploit CVE-2017-11292 Flash vulnerability before patches are deployed",
    "authors": "",
    "file_creation_date": "2022-05-28T03:40:35Z",
    "file_modification_date": "2022-05-28T03:40:35Z",
    "file_size": 2202009,
    "plain_text": "# APT28 racing to exploit CVE-2017-11292 Flash vulnerability before patches are deployed\n\n**[proofpoint.com/us/threat-insight/post/apt28-racing-exploit-cve-2017-11292-flash-vulnerability-patches-are-deployed](https://www.proofpoint.com/us/threat-insight/post/apt28-racing-exploit-cve-2017-11292-flash-vulnerability-patches-are-deployed)**\n\nOctober 19, 2017\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nAPT28 racing to exploit CVE-2017-11292 Flash vulnerability before patches are deployed\n\n\n-----\n\nOctober 19, 2017 Kafeine, Pierre T\n\n**Editor’s Note**\n\n_This post will be updated as the threat is mitigated with additional C&C takedowns; for now we are only_\n_sharing basic information related to this campaign to avoid enabling actions by other threat actors. We_\n_have already included new IOCs following initial takedown operations and will continue to monitor and_\n_engage in mitigation efforts._\n\n**Overview**\n\nOn Tuesday, October 18, Proofpoint researchers detected a malicious Microsoft Word attachment\nexploiting a recently patched Adobe Flash vulnerability, CVE-2017-11292. We attributed this attack to\nAPT28 (also known as Sofacy), a Russian state-sponsored group. Targeting data for this campaign is\nlimited but some emails were sent to foreign government entities equivalent to the State Department and\nprivate-sector businesses in the aerospace industry. The known geographical targeting appears broad,\nincluding Europe and the United States. The emails were sent from free email services.\n\nAs we examined the document exploitation chain, we found that DealersChoice.B [2], the attack\nframework that the document uses, is now also exploiting CVE-2017-11292, a Flash vulnerability that can\nlead to arbitrary code execution across Windows, Mac OS, Linux, and Chrome OS systems. The\nvulnerability was announced and patched on Monday, October 16 [1]. At that time Kaspersky attributed\nthe exploit use to the BlackOasis APT group, which is distinct from APT28. We suspect that APT28, who\nalso possess this exploit (whether purchased, discovered on their own, or reverse engineered from the\nBlackOasis attack), may now seek to benefit from it as quickly as possible before the patch is widely\ndeployed.\n\nThus, while this exploit is no longer a zero-day, this is only the second known campaign utilizing it\nreported in public. APT28 burned their CVE-2017-0262 EPS 0-day in a similar fashion in April after\nMicrosoft pushed an EPS exploit mitigation, which significantly reduced the impact of this exploit. [3]\n\n**Analysis**\n\nThe document “World War 3.docx” contacts DealersChoice.B, APT28’s attack framework that allows\nloading exploit code on-demand from a command and control (C&C) server. DealersChoice has\npreviously been used to exploit a variety of Flash vulnerabilities, including CVE-2015-7645, CVE-2016\n\n-----\n\n1019, CVE-2016-4117, and CVE-2016-7855 via embedded objects in crafted Microsoft Word documents.\n\n_Figure 1: Decoy document used_\n\nThis malicious document embeds the same Flash object twice in an ActiveX control for an unknown\nreason, although this is likely an operational mistake. The Flash files work in the same manner as the last\nknown attack using this tool: the embedded Flash decompresses a second Flash object that handles the\ncommunication with the exploit delivery server. The only difference is that this second Flash object is no\nlonger stored encrypted. There are other signs that this campaign was devised hastily: for example, the\nactors did not change the decryption algorithm constants as they have in the past. These particular\nconstants were already used in a late December 2016 campaign. Each document uses a different domain\nfor victim exploitation, while the communication protocol with the server stayed the same as well.\n\n\n-----\n\n_Figure 2: Comparison of the decryption functions (lightly edited for readability) showing that the decryption_\n_algorithm constants were not changed_\n\nWe performed testing and found exploitation to be successful on:\n\nWindows 7 with Flash 27.0.0.159 and Microsoft Office 2013\nWindows 10 build 1607 with Flash 27.0.0.130 and Microsoft Office 2013\n\nAt this point, despite the potential impact across operating systems of this particular Flash vulnerability,\nMac OS does not appear to be targeted by this campaign. Users running 64-bit versions of Microsoft\nOffice 2016 and Windows 10 RS3 should be protected against this exploit as well.\n\n\n-----\n\n_Figure 3: Flash 27.0.0.159 exploited by DealersChoice‘s CVE-2017-11292 on Windows 7 via Microsoft_\n_Office 2013_\n\n_Figure 4: DealersChoice Flash checkin under Windows 10 build 1607, Microsoft Word 2013, and Flash_\n_27.0.0.130_\n\nThe CVE-2017-11292 exploit (Figure 5) delivered by the server is then decrypted and executed by the\nFlash object handling the communications. Upon successful execution, the payload is requested,\ndecrypted, and executed on the target system.\n\n\n-----\n\n_Figure 5: Use of the vulnerable mediacore.BufferControlParameters class_\n\nAfter exploitation, DealersChoice typically delivers a stage 1 implant named Uploader [4]. In this case, it\ndelivered only the Uploader payload component (build 0x2125181f) without the intermediate dropper. This\nmalware has basic capabilities used for reconnaissance on the target systems. Uploader is also used to\ndeploy further tools and implants on the system. It is worth noting that the timestamp (Wed Oct 18\n01:54:28 2017 GMT) present in in the payload indicates a very short delay between the setup of this\nattack and its launch.\n\n**Conclusion**\n\nAPT28 appears to be moving rapidly to exploit this newly documented vulnerability before the available\npatch is widely deployed. Because Flash is still present on a high percentage of systems and this\nvulnerability affects all major operating systems, it is critical that organizations and end users apply the\nAdobe patch immediately. APT28 is a sophisticated state-sponsored group that is using the vulnerability to\nattack potentially high-value targets but it is likely that other threat actors will follow suit and attempt to\nexploit this vulnerability more widely, whether in exploit kits or via other attack vectors.\n\n**References**\n\n[1] [https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/](https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/)\n\n[2] https://researchcenter.paloaltonetworks.com/2016/12/unit42-let-ride-sofacy-groups-dealerschoiceattacks-continue/\n\n[3] [https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html](https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html)\n\n[4] [https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part1.pdf](https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part1.pdf)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description**\n\n\n-----\n\n25f983961eef6751e53a72c96d35448f8b413edf727501d0990f763b8c5e900b sha256 Decoy/Exploit\nDocument\n\n416467f8975036bb06c2b5fca4daeb900ff5f25833d3cdb46958f0f0f26bec82 sha256 APT28\nUploader\nVariant\n\nblackpartshare[.com|185.86.150.244 Domain|IP DealersChoice\nC&C (now\ntaken down)\n\nmountainsgide[.com|185.86.150.244 Domain|IP DealersChoice\nC&C (now\ntaken down)\n\ncontentdeliverysrv[.net|142.91.104.106 Domain|IP DealersChoice\nC&C (now\ntaken down)\n\nspace-delivery[.com|86.106.131.141 Domain|IP APT28\nuploader C&C\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n2014726 || ET POLICY Outdated Flash Version M1\n\n2823078 || ETPRO TROJAN APT28 DealersChoice CnC Beacon M1\n\n2823642 || ETPRO TROJAN APT28 DealersChoice CnC Beacon Response\n\n2023916 || ET TROJAN APT28 Uploader Variant CnC Beacon\n\n2828341 || ETPRO TROJAN APT28 DealersChoice DNS Lookup\n\n2828342 || ETPRO TROJAN APT28 Uploader DNS Lookup\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-19 - APT28 racing to exploit CVE-2017-11292 Flash vulnerability before patches are deployed.pdf"
    ],
    "report_names": [
        "2017-10-19 - APT28 racing to exploit CVE-2017-11292 Flash vulnerability before patches are deployed.pdf"
    ],
    "threat_actors": [
        {
            "id": "10ad5c1d-5030-4300-be4e-6d24b40a6330",
            "created_at": "2022-10-25T16:07:23.400966Z",
            "updated_at": "2025-03-27T02:02:09.780076Z",
            "deleted_at": null,
            "main_name": "BlackOasis",
            "aliases": [],
            "source_name": "ETDA:BlackOasis",
            "tools": [
                "FinFisher",
                "FinFisher RAT",
                "FinSpy",
                "Wingbird"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5200f27d-0d0a-49e9-a9de-9612971126c2",
            "created_at": "2023-01-06T13:46:38.959648Z",
            "updated_at": "2025-03-27T02:00:02.96312Z",
            "deleted_at": null,
            "main_name": "BlackOasis",
            "aliases": [
                "G0063"
            ],
            "source_name": "MISPGALAXY:BlackOasis",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1ba9c064-34d2-48b5-a08c-04d241b00ebe",
            "created_at": "2022-10-25T15:50:23.734241Z",
            "updated_at": "2025-03-27T02:00:55.535726Z",
            "deleted_at": null,
            "main_name": "BlackOasis",
            "aliases": [
                "BlackOasis"
            ],
            "source_name": "MITRE:BlackOasis",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536126,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653709235,
    "ts_modification_date": 1653709235,
    "files": {
        "pdf": "https://archive.orkl.eu/70ba70e94979ec5c6c7bbfcc1df416f5fc0cf763.pdf",
        "text": "https://archive.orkl.eu/70ba70e94979ec5c6c7bbfcc1df416f5fc0cf763.txt",
        "img": "https://archive.orkl.eu/70ba70e94979ec5c6c7bbfcc1df416f5fc0cf763.jpg"
    }
}