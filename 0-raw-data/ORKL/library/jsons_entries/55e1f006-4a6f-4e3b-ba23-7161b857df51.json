{
    "id": "55e1f006-4a6f-4e3b-ba23-7161b857df51",
    "created_at": "2023-01-12T14:59:56.069143Z",
    "updated_at": "2025-03-27T02:05:37.620166Z",
    "deleted_at": null,
    "sha1_hash": "7f74fd0341c34e2432f9205ae6686ed46a8a14b0",
    "title": "2021-09-10 - The new maxtrilha trojan is being disseminated and targeting several banks",
    "authors": "",
    "file_creation_date": "2022-05-28T21:48:35Z",
    "file_modification_date": "2022-05-28T21:48:35Z",
    "file_size": 3328460,
    "plain_text": "# The new maxtrilha trojan is being disseminated and targeting several banks\n\n**[seguranca-informatica.pt/the-new-maxtrilha-trojan-is-being-disseminated-and-targeting-several-banks/](https://seguranca-informatica.pt/the-new-maxtrilha-trojan-is-being-disseminated-and-targeting-several-banks/#.YT3_VfwzaKN)**\n\nSeptember 10, 2021\n\n**The new maxtrilha trojan is being disseminated and targeting several banks around**\n**the world.**\nA new banking trojan dubbed maxtrilha (due to its encryption key) has been discovered in\nthe last few days and targeting customers of European and South American banks.\nCriminals are constantly creating variants of popular banking trojans, keeping in mind the\nsame modus operandi but changing the malware internals and its capabilities making it a\nfully undetectable (FUD) weapon.\n\n## Overview\n\nThe recent campaign have been disseminated in Latin America but also extended to Europe\nand Portugal. The campaign has been leveraged by Brazilian criminals’ gangue, who use\ncustomized phishing templates to spread the trojan maxtrilha according to the target country.\n\nThe malware samples disseminated in Portugal open a legitimate webpage from Autoridade\nTributária e Aduaneira – Finanças to lure the victims during the execution of the 1st stage.\n[After that, the malware creates persistence, disables Internet Explorer security settings](https://docs.microsoft.com/en-us/windows/client-management/mdm/policy-csp-internetexplorer#internetexplorer-disablesecuritysettingscheck)\nto facilitate the download of the 2nd stage from the Internet. In short, the 2nd stage –\nmaxtrilha trojan – checks or creates persistence when executed on the target machine, uses\na mechanism of capturing details from opened foreground windows matching its name with\nspecific hardcoded strings related to banking companies, launches banking windows overlay,\ncan deploy new payloads and communicates with the C2 server in real-time.\n\nThe maxtrilha trojan was developed in Delphi language, it’s an x64 binary, and it can bypass\nAV and EDRs systems – at least until the moment of its analysis.\n\n\n-----\n\n**_Figure 1: High-level diagram of maxtrilha banking trojan._**\n\n## Key findings\n\nMaxtrilha has been disseminated via crafted phishing templates by country.\nThe maxtrilha 1st stage – the loader – opens a legitimate service previously\npresented on the phishing template to lure victims during its execution.\nThe 1st stage creates persistence on the infected machine, disables Internet\nExplorer security settings and accepted extensions to facilitate the download of\nthe 2nd stage.\nMaxtrilha trojan – 2nd stage – checks or creates persistence on the machine,\ninstalls or modifies Windows trusted certificates, checks by opening windows to\nperform banking windows overlay to steal credentials and can deploy additional\npayloads executed via DLL injection technique.\nThe victims’ data is encrypted and sent to the C2 server geolocated in Russia.\n\n## Maxtrilha trojan analysis in-depth\n\nIn this section, we are going through the details of maxtrilha malware, analyzing step-by-step\nthis banking trojan, how it operates, and what kind of data is exfiltrated. Figure 2 shows the\nphishing template disseminated in Portugal that impersonates the Autoridade Tributária e\nAduaneira – Finanças to lure victims to download the maxtrilha 1st stage (the loader).\n\n\n-----\n\n**_Figure 2: Maxtrilha phishing template disseminated in Portugal and impersonating the_**\n_[Autoridade Tributária e Aduaneira – Finanças | h/t @MiguelSantareno](https://twitter.com/MiguelSantareno)_\n\nAs observed below, the “cld.]pt” domain have been used to host several malicious\ncampaigns during 2021, including the maxtrilha malware wave. The full list can be found at\nthe end of the analysis.\n\n\n-----\n\n**_Figure 3: Malicious .PT domain used to distribute campaigns in the wild during 2021,_**\n_including the maxtrilha malware wave._\n\n## Maxtrilha loader– the 1st stage\n\n**Filename: PdF.exe / MSITrueColor.exe**\n\n**MD5:a6f3e35760bc2848cd258b786c1fd247**\n\n**Creation date: 2021-09-06 09:20:49**\n\n[The first alert on this banking trojan was triggered on the 0xSI_f33d.The maxtrilha loader is](https://feed.seguranca-informatica.pt/)\ncustomized by criminals according to the target country, and it performs some tasks in\nadvance, namely:\n\n\n-----\n\nOpens a target legitimate page during its execution via a hardcoded short URL\nCreates persistence on the target machine\nDisables IE security settings; and\nDownloads the maxtrilha 2nd stage.\n\nAs presented in Figure 4, several samples have been distributed in the wild last few days,\nimpersonating different organizations in different countries.\n\n**_Figure 4: Maxtrilha samples disseminated in August and September 2021._**\n\nAs mentioned, a specific short URL is hardcoded inside each loader, depending on the target\ncountry. In the case of the maxtrilha loader disseminated in Portugal, it uses the TinyURL\nonline service, which is opened during the malware execution by the default web browser\ninstalled and available on the victim machine. The short URL points to a specific page\nrelated to the phishing template (see Figure 2) to lure victims.\n\n\n-----\n\n**_Figure 5: A short URL is opened via a default web browser which redirects the victim to a_**\n_legitimate service._\n\nIn another sample also disseminated in Portugal, we found a different hardcoded string\ninstead of the short URL. This specific domain is cached on Google and redirects the victim\nto the authentication page. With this trick in place, criminals can bypass some security\nagents.\n\n**_Figure 6: Specific hardcoded URL found inside the maxtrilha samples disseminated in_**\n_Portugal._\n\nIn detail, we found some samples distributing the threat in Portugal, Spain, and Mexico as\nobserved below.\n\n\n-----\n\n**_Figure 7: Legitimate portals used to lure the victims during the maxtrilha execution in_**\n_Portugal, Spain, and Mexico._\n\nAfter running the executable, it opens the target page to lure victims while it creates\npersistence, disables IE security settings, and downloads the 2nd stage into the %Public%\nfolder.\n\nAs mentioned, the bait page is opened based on the TinyURL short URLs hardcoded inside\neach binary.\n\n\n-----\n\n**_Figure 8: Legitimate page opened during the malware execution (Portuguese sample)._**\n\nAfter showing the authentication page, the trojan performs specific tasks in the background.\nThe first step is to modify software policy settings, namely the Windows trusted certificates to\nacts later as a proxy agent. Both the binaries, 1st stage, and 2nd stage perform this\noperation at runtime:\n\n\n-----\n\n```\n PdF.exe (Access type: CREATE ; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\CA\")\n\"PdF.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\DISALLOWED\")\n\"PdF.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\TRUST\")\n\"PdF.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\TRUSTEDPEOPLE\")\n\"PdF.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\ROOT\")\n\"MSITrueColor.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\CA\")\n\"MSITrueColor.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\DISALLOWED\")\n\"MSITrueColor.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\ROOT\")\n\"MSITrueColor.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\TRUSTEDPEOPLE\")\n\"MSITrueColor.exe\" (Access type: \"CREATE\"; Path:\n\"SOFTWARE\\POLICIES\\MICROSOFT\\SYSTEMCERTIFICATES\\TRUST\")\n\n```\nNext, also the **[Internet Explorer security settings are changed to facilitate the download of](https://docs.microsoft.com/en-us/windows/client-management/mdm/policy-csp-internetexplorer#internetexplorer-disablesecuritysettingscheck)**\nthe 2nd stage without any restriction:\n```\nQueries sensitive IE security settings:\n\"iexplore.exe\" (Path: \"HKCU\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\SECURITY\"; Key:\n\"DISABLESECURITYSETTINGSCHECK\")\n\"IEXPLORE.EXE\" (Path: \"HKCU\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\SECURITY\"; Key:\n\"DISABLESECURITYSETTINGSCHECK\")\nQueries the display settings of system associated file extensions:\n\"iexplore.exe\" (Access type: \"QUERYVAL\"; Path:\n\"HKLM\\SOFTWARE\\CLASSES\\SYSTEMFILEASSOCIATIONS\\.EXE\"; Key: \"NEVERSHOWEXT\")\n\"iexplore.exe\" (Access type: \"QUERYVAL\"; Path:\n\"HKLM\\SOFTWARE\\CLASSES\\SYSTEMFILEASSOCIATIONS\\.EXE\"; Key: \"ALWAYSSHOWEXT\")\n\n```\nThe loader has the capacity of selecting the name of the target file to download; these\nnames are hardcoded in a list with well-known music songs as observed in Figure 9 below.\nFinally, the 2nd stage is download from the “sageprototypego.]pt/sept/cult.mp4” domain\npath into the %Public% folder and the binary path added to the Windows registry.\n\n\n-----\n\n**_Figure 9: Maxtrilha 2nd stage downloaded from the Internet based on target hardcoded_**\n_strings._\n\n**_Figure 10: Maxtrilha 2nd stage is launched every time from the Windows %Public% folder._**\n\n## Maxtrilha campaign – A possible kill switch\n\n\n-----\n\nAs a way of preventing further infections through this campaign, the domain from which the\n2nd stage is downloaded has been decommissioned, and when the loader tries to unload the\nbinary, it will go into an error loop because it cannot find and inject the new binary into\nmemory (sageprototypego.]pt).\n\n**_Figure 11: Possible kill switch of maxtrilha trojan (1st stage – loader)._**\n\n## Maxtrilha trojan banker – the final stage\n\n**Filename: Telegram.exe / MSITrueColor.exe /cult.mp4 / roddy_ricch.mp3**\n\n**MD5: ea30c0dc58f71a1720990021fda92d1e**\n\n**Creation date: 2021-09-06 09:06:20**\n\nCriminals are constantly creating new ways to make their malicious arsenal FUD. In this\ncase, the maxtrilha trojan, an x64 Delphi binary is not detected as malicious on VirusTotal,\nallowing to infect a large volume of machines around the world during this campaign.\n\n\n-----\n\n**_Figure 12: Maxtrilha trojan 100% FUD, bypassing, thus part of the AVs and EDR systems._**\n\nWhen the binary is executed, it performs some tasks, including:\n\n\n-----\n\nUses the invertexto.]com online service to check the Internet connection and to\nget the victims’ IP address and their geolocation. Then, it creates the PHP files\ndynamically on the C2 served based on the victims’ IP addresses.\nChecks or creates persistence on the Windows registry.\nPerforms monitoring on the user navigation finding by targeting banking portals\nhardcoded inside the binary.\nRetrieve commands from the C2 server and sent the gathered data.\nIt can also deploy additional payloads executed via the DLL injection technique.\n\n**_Figure 13: Maxtrilha checks by Internet connection and adds the binary path to the Windows_**\n_registry (persistence technique)._\n\nInterestingly, the invertexto.]com service is being used by the maxtrilha trojan creators to\nobtain victims’ IP addresses and at the same time to check by Internet connection. On a\n**VirusTotal screen, we can see maxtrilha samples communicating with this address in the**\nlast few days.\n\n\n-----\n\n**_Figure 14: Maxtrilha samples communicating with the legitimate service to validate Internet_**\n_connection and get the victims’ IP addresses._\n\nDuring the malware activity, the binary is in a thread loop monitoring Internet browser\nwindows, and matching the opened pages with hardcoded strings, namely substrings related\nto banks in Latin America and Europe, including Portugal.\n\n\n-----\n\n**_Figure 15: Target banks impacted by maxtrilha trojan._**\n\nWhen the string matches, then the malware communicates with the C2 server geolocated in\nRussia to perform the following operations:\n\nIt sends initial data related to the machine (hostname) and IP address.\nC2 server receives this information from the index.php page, and creates some\nPHP pages that will allow communication (each victim have specific pages based\non their IP address)\n\nWith this trick in place, criminals can maintain the thread more invisible as each victim has its\nspecific pages hosted on the same IP addresses.\n\nIn detail, some configurations are also obtained from a “webcindario.]com” subdomain, not\navailable at the moment of analyzis.\n\n**_Figure 16: Additional configuration retrieved from the webcindario.com sub domain._**\n\nThe next image shows the moment the trojan gets the windows name via\n“GetWindowsTextW()” call, and the beginning of the C2 communication with the strings fully\nencrypted.\n\n\n-----\n\n**_Figure 17: Maxtrilha C2 communication._**\n\nIn detail, the “maxtrilha123” key is used to encrypt the clear-text strings in a binary operation\neach time the trojan sends information to the C2 server.\n\n\n-----\n\n**_Figure 18: Pseudo-code of the encryption algorithm used by maxtrilha._**\n\nIn another attempt to run the binary, we can see that a similar string is sent; different due to\nthe timestamp the request was sent. This first server request then creates PHP pages on the\nserver-side based on the victim’s IP address.\n\n\n-----\n\nAdditional data is sent to the C2 server related to the page the victim is browsing.\n\n**_Figure 19: Maxtrilha trojan creating the victim’s PHP pages on the C2 server to perform_**\n_further communication._\n\nMaxtrilha uses API hashing and introduces well-known calls to perform DLL injection. This\ntechnique is then used to deploy additional payloads during the malware execution.\n\nI\n\n\n-----\n\n**_Figure 20: API hashing calls and DLL injection technique found on the binary to probably_**\n_execute additional payloads at runtime based on specific operations listed below._\n```\n- opcao = 1 - opcao = 2 - opcao = 3 - opcao = 4 - opcao = 5 \n```\nThe malware will also send the name of the foreground windows the user is opened to the\nC2 server. In this case, if for example some of those windows are on a blacklist (x64db, IDA,\netc), the trojan may terminate its execution.\n\nAs observed below, the two C2 servers hardcoded inside the maxtrilha binary are geolocated\nin Russia.\n\n\n-----\n\n**_Figure 21: Maxtrilha C2 servers geolocated in Russia._**\n\n## Final Thoughts\n\nNowadays, we are facing a growing of Brazilian trojans at a very high speed. Each one of\nthem with its peculiarities, TTPs, etc. With this in mind, criminals achieve a FUD condition\nthat allows them to avoid detection and impact a large number of users around the world.\n\nIn this sense, monitoring these types of IoCs is a crucial point now, as it is expected that in\nthe coming weeks or months new infections or waves can appear.\n\n### Thank you to all who have contributed:\n\n**[@JAMESWT_MHT](https://twitter.com/JAMESWT_MHT)**\n\n**[@MiguelSantareno](https://twitter.com/MiguelSantareno)**\n\n## Mitre Att&ck Matrix\n\n Indicators of Compromise (IOCs)\n\n\n-----\n\n```\n  .PT domain / phishing\najuda.cld].pt \ncustomdomains.cld].pt \nf9z6ja.s.cld].pt\nl10j61.s.cld].pt\njxbkwo.s.cld].pt\njdyejh.s.cld].pt\ns8dcd2.s.cld].pt\n6qwttx.s.cld].pt\nn4bi9h.s.cld].pt\noofrae.s.cld].pt\n9kvxv4.s.cld].pt\nwuivjh.s.cld].pt\nfe67gp.s.cld].pt\n9iu549.s.cld].pt\nn9i202.s.cld].pt\nbt81tf.s.cld].pt\nxrrj0n.s.cld].pt\nuvt3z5.s.cld].pt\ns5ex1t.s.cld].pt\nxmr83x.s.cld].pt\nkq4di7.s.cld].pt\n1zpajx.s.cld].pt\nz6vfcl.s.cld].pt\n9owib7.s.cld].pt\nfml494.s.cld].pt\ndzitjy.s.cld].pt\nre4fof.s.cld].pt\n4inxd5.s.cld].pt\nu42sld.s.cld].pt\nd2t6ms.s.cld].pt\nsq26oz.s.cld].pt\njx7w68.s.cld].pt\ncx0px4.s.cld].pt\n85928p.s.cld].pt\ngdrwxi.s.cld].pt\n4fblxh.s.cld].pt\nsj788n.s.cld].pt\nvzqr6b.s.cld].pt\nh61mhu.s.cld].pt\n9jhvyu.s.cld].pt\nqeko0l.s.cld].pt\n9puund.s.cld].pt\n5yxgae.s.cld].pt\na4g9no.s.cld].pt\ny64ryi.s.cld].pt\nvh69rv.s.cld].pt\nct156d.s.cld].pt\n08c5gz.s.cld].pt\nruc8oq.s.cld].pt\njx976j.s.cld].pt\nxya9om.s.cld].pt\n636jm3.s.cld].pt\n83hiwm.s.cld].pt\n6yd25k.s.cld].pt\n\n```\n\n-----\n\n```\nt47mir.s.cld].pt\nvla9xi.s.cld].pt\n7l6ceh.s.cld].pt\n3y1oe3.s.cld].pt\nn7d6of.s.cld].pt\nas4435.s.cld].pt\na5cyc9.s.cld].pt\nbg7zew.s.cld].pt\nahgkmu.s.cld].pt\nq82hrg.s.cld].pt\nhgpa0p.s.cld].pt\n15yqcr.s.cld].pt\nlc465n.s.cld].pt\ncp0adm.s.cld].pt\naxbkpv.s.cld].pt\ngajior.s.cld].pt\npaw2d2.s.cld].pt\n1uu2ol.s.cld].pt\nh3tqgn.s.cld].pt\niwtosz.s.cld].pt\nsuymo6.s.cld].pt\nujglwa.s.cld].pt\ntewkko.s.cld].pt\n0xhmwn.s.cld].pt\n5yn5zo.s.cld].pt\n7bx0xw.s.cld].pt\n3b8iph.s.cld].pt\ng47px2.s.cld].pt\nblg4jc.s.cld].pt\n7tf950.s.cld].pt\nviz4lu.s.cld].pt\n7bbzfr.s.cld].pt\n3o47pq.s.cld].pt\nfffzbw.s.cld].pt\nmmxls9.s.cld].pt\n355ij9.s.cld].pt\n1dsuij.s.cld].pt\nturjqi.s.cld].pt\n2st9tz.s.cld].pt\nnpnn8d.s.cld].pt\nnch1tb.s.cld].pt\nqouimg.s.cld].pt\nqx45dz.s.cld].pt\n58kzfe.s.cld].pt\nu9lrss.s.cld].pt\nzt61iz.s.cld].pt\n-- domain used to get config --https://abrilprorock2018.]webcindario.]com/br/\nhttps://abrilprorock2018.]webcindario.]com/nt/\nhttps://abrilprorock2018.]webcindario.]com/baby/\nhttps://abrilprorock2018.]webcindario.]com/hs/\nhttps://abrilprorock2018.]webcindario.]com/jf/ \nhttps://abrilprorock2018.]webcindario.]com/hass/ \n\n```\n\n-----\n\n```\n  C2 server\n94.228.123.]161\n94.228.126.]231\nsageprototypego.]pt/sept/cult.mp4\" /]\n-- samples-1st stage: 043f535f68678652c50ff49cf03ee4b63fdbd03b76c732adfe83074335fbbb3b\n2nd stage: a6512b5271bc6e383ec6e3141ebb91b92a8a76a5f1d532ee6e185a253dc20830\n--short URLs-https://tinyurl.]com/flexibiliza\nhttps://tinyurl.]com/tributodashboard\nhttp://tinyurl.]com/yjsfpjau\nhttps://tinyurl.]com/ye65hycr\nhttps://tinyurl.]com/tabloide01\nhttp://tinyurl.]com/yh3mhn8o\nhttps://tinyurl.]com/y6hkrtv6\n\n## Online Sandbox URLs\n\n```\n[–https://app.any.run/tasks/b734235a-b6e1-4dbe-8d13-2709b9e282a0/](https://app.any.run/tasks/b734235a-b6e1-4dbe-8d13-2709b9e282a0/)\n\n[–https://www.joesandbox.com/analysis/847611](https://www.joesandbox.com/analysis/847611)\n\n[-https://capesandbox.com/analysis/186437/#](https://capesandbox.com/analysis/186437/#)\n\n**Samples**\n\n[https://bazaar.abuse.ch/browse/tag/abrilprorock2018.webcindario.com/](https://bazaar.abuse.ch/browse/tag/abrilprorock2018.webcindario.com/)\n\n[https://bazaar.abuse.ch/browse/tag/54.207.65.61/](https://bazaar.abuse.ch/browse/tag/54.207.65.61/)\n\n[https://bazaar.abuse.ch/browse/tag/sageprototypego.pt/](https://bazaar.abuse.ch/browse/tag/sageprototypego.pt/)\n\nhttps://bazaar.abuse.ch/sample/a6512b5271bc6e383ec6e3141ebb91b92a8a76a5f1d532ee6\ne185a253dc20830/\n\n## Yara Rule\n\n\n-----\n\n```\nimport pe \nrule maxtrilha_banking_trojan_loader_2021 {\nmeta:\n  description = \"Yara rule for maxtrilha trojan banker (loader) - September 2021\nversion\"\n  author = \"SI-LAB - https://seguranca-informatica.pt\"\n  last_updated = \"2021-09-10\"\n  tlp = \"white\"\n  category = \"informational\"\n  strings:\n  $s_a = {68 00 74 00 74 00 70 00 73 00 3A 00 2F 00 2F 00 77 00 77 00 77 00 2E 00\n69 00 6E 00 76 00 65 00 72 00 74 00 65 00 78 00 74 00 6F 00 2E 00 63 00 6F 00 6D 00\n2F 00 6C 00 6F 00 63 00 61 00 6C 00}\n  $s_b = {73 00 61 00 67 00 65 00 70 00 72 00 6F 00 74 00 6F 00 74 00 79 00 70 00\n65 00 67 00 6F 00 2E 00 70 00 74 00 2F 00 73 00 65 00 70 00 74 00 2F 00 63 00 75 00\n6C 00 74 00 2E 00 6D 00 70 00 33 00}\n  condition:\n    filesize < 20000KB\n    and all of ($s_*)\n}\nrule maxtrilha_banking_trojan_2nd_stage_2021 {\nmeta:\n  description = \"Yara rule for maxtrilha trojan banker (2nd stage) - September 2021\nversion\"\n  author = \"SI-LAB - https://seguranca-informatica.pt\"\n  last_updated = \"2021-09-10\"\n  tlp = \"white\"\n  category = \"informational\"\n  strings:\n  $s_a = {62 00 72 00 69 00 6C 00 70 00 72 00 6F 00 72 00 6F 00 63 00 6B 00 32 00\n30 00 31 00 38 00 2E 00 77 00 65 00 62 00 63 00 69 00 6E 00 64 00 61 00 72 00 69 00\n6F 00 2E 00 63 00 6F 00 6D 00 2F 00}\n  $s_b = {68 00 74 00 74 00 70 00 73 00 3A 00 2F 00 2F 00 77 00 77 00 77 00 2E 00\n69 00 6E 00 76 00 65 00 72 00 74 00 65 00 78 00 74 00 6F 00 2E 00 63 00 6F 00 6D 00\n2F 00 6C 00 6F 00 63 00 61 00 6C 00}\n  $s_c = {00 34 00 2E 00 32 00 32 00 38 00 2E 00 31 00 32 00 33 00 2E 00 31 00 36\n00 31 00 2F 00 64 00 61 00}\n  condition:\n    filesize < 20000KB\n    and all of ($s_*)\n}\n\n```\n[The Yara rules are also available on GitHub.](https://raw.githubusercontent.com/sirpedrotavares/SI-LAB-Yara_rules/master/maxtrilha_trojan_banker)\n\n[Pedro Tavares](https://seguranca-informatica.pt/author/pipocaz/)\n\n\n-----\n\n**[Pedro Tavares is a professional in the field of information security working as an Ethical](https://www.linkedin.com/in/sirpedrotavares/)**\nHacker/Pentester, Malware Researcher and also a Security Evangelist. He is also a founding\nmember at CSIRT.UBI and Editor-in-Chief of the security computer blog segurancainformatica.pt.\n\nIn recent years he has invested in the field of information security, exploring and analyzing a\nwide range of topics, such as pentesting (Kali Linux), malware, exploitation, hacking, IoT and\nsecurity in Active Directory networks. He is also Freelance Writer (Infosec. Resources\n[Institute and Cyber Defense Magazine) and developer of the 0xSI_f33d – a feed that](https://feed.seguranca-informatica.pt/)\ncompiles phishing and malware campaigns targeting Portuguese citizens.\n\n[Read more here.](https://seguranca-informatica.pt/contacto/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-10 - The new maxtrilha trojan is being disseminated and targeting several banks.pdf"
    ],
    "report_names": [
        "2021-09-10 - The new maxtrilha trojan is being disseminated and targeting several banks.pdf"
    ],
    "threat_actors": [
        {
            "id": "97dc332f-2241-4755-ae33-54e5eff3990a",
            "created_at": "2023-01-06T13:46:39.307201Z",
            "updated_at": "2025-03-27T02:00:03.046734Z",
            "deleted_at": null,
            "main_name": "TA2541",
            "aliases": [],
            "source_name": "MISPGALAXY:TA2541",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "878ce40c-9fbc-4cff-a5c4-771086979fa7",
            "created_at": "2022-10-25T16:07:24.264056Z",
            "updated_at": "2025-03-27T02:02:10.154595Z",
            "deleted_at": null,
            "main_name": "TA2541",
            "aliases": [],
            "source_name": "ETDA:TA2541",
            "tools": [
                "AVE_MARIA",
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "AsyncRAT",
                "Ave Maria",
                "AveMariaRAT",
                "DarkRAT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Imminent Monitor",
                "Imminent Monitor RAT",
                "Iniduoh",
                "Jenxcus",
                "Kognito",
                "Luminosity RAT",
                "LuminosityLink",
                "Negasteal",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Njw0rm",
                "Origin Logger",
                "Parallax",
                "Parallax RAT",
                "ParallaxRAT",
                "Recam",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "WSHRAT",
                "ZPAQ",
                "avemaria",
                "dinihou",
                "dunihi"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535596,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653774515,
    "ts_modification_date": 1653774515,
    "files": {
        "pdf": "https://archive.orkl.eu/7f74fd0341c34e2432f9205ae6686ed46a8a14b0.pdf",
        "text": "https://archive.orkl.eu/7f74fd0341c34e2432f9205ae6686ed46a8a14b0.txt",
        "img": "https://archive.orkl.eu/7f74fd0341c34e2432f9205ae6686ed46a8a14b0.jpg"
    }
}