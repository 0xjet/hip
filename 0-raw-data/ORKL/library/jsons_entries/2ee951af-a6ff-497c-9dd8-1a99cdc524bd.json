{
    "id": "2ee951af-a6ff-497c-9dd8-1a99cdc524bd",
    "created_at": "2023-01-12T15:09:30.56029Z",
    "updated_at": "2025-03-27T02:11:34.713543Z",
    "deleted_at": null,
    "sha1_hash": "7bcff2748ce073d5e4fac424536ba8103f288789",
    "title": "2017-04-27 - APT Targets Financial Analysts with CVE-2017-0199",
    "authors": "",
    "file_creation_date": "2022-05-28T00:31:13Z",
    "file_modification_date": "2022-05-28T00:31:13Z",
    "file_size": 3932650,
    "plain_text": "# APT Targets Financial Analysts with CVE-2017-0199\n\n**[proofpoint.com/us/threat-insight/post/apt-targets-financial-analysts](https://www.proofpoint.com/us/threat-insight/post/apt-targets-financial-analysts)**\n\n\nApril 27, 2017\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nAPT Targets Financial Analysts with CVE-2017-0199\n\n\n-----\n\nApril 27, 2017 Axel F\n\nOn April 20, Proofpoint observed a targeted campaign focused on financial analysts working at top global\nfinancial firms operating in Russia and neighboring countries. These analysts were linked by their\ncoverage of the telecommunications industry, making this targeting very similar to, and likely a\n[continuation of, activity described in our “In Pursuit of Optical Fibers and Troop Intel” blog. This time,](https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia)\n[however, attackers opportunistically used spear-phishing emails with a Microsoft Word attachment](https://www.proofpoint.com/us/threat-reference/spear-phishing)\n[exploiting the recently patched CVE-2017-0199 to deploy the ZeroT Trojan, which in turn downloaded the](https://www.proofpoint.com/us/threat-insight/post/dridex-campaigns-millions-recipients-unpatched-microsoft-zero-day)\nPlugX Remote Access Trojan (RAT).\n\nProofpoint is tracking this attacker, believed to operate out of China, as TA459. The actor typically targets\n[Central Asian countries, Russia, Belarus, Mongolia, and others. TA549 possesses a diverse malware](https://www.proofpoint.com/us/threat-reference/malware)\narsenal including PlugX, NetTraveler, and ZeroT. [1][2][3]\n\nIn this blog, we also document other 2017 activity so far by this attack group, including their distribution of\nZeroT malware and secondary payloads PCrat/Gh0st.\n\n**Analysis**\n\nIn this campaign, attackers used a Microsoft Word document called 0721.doc, which exploits CVE-20170199. This vulnerability was disclosed and patched days prior to this attack.\n\n\n-----\n\n_Figure 1: Microsoft Word document 0721.doc_\n\nThe document uses the logic flaw to first download the file power.rtf from\nhxxp://122.9.52[.]215/news/power.rtf. The payload is actually an HTML Application (HTA) file, not an RTF\ndocument.\n\n_Figure 2: The first script downloaded by the exploit document is an HTA file_\n\nAs shown in the figure above, the HTA’s VBScript changes the window size and location and then uses\nPowerShell to download yet another script: power.ps1. This is a PowerShell script that downloads and\nruns the ZeroT payload cgi.exe.\n\n\n-----\n\n_Figure 3: The second script downloaded by the exploit document is a PowerShell script_\n\n_Figure 4: Combined network traffic showing the document downloading its payloads_\n\n**ZeroT and other payloads**\n\nThe attack group has made incremental changes to ZeroT since our last analysis. While they still use\nRAR SFX format for the initial payloads, ZeroT now uses a the legitimate McAfee utility (SHA256\n3124fcb79da0bdf9d0d1995e37b06f7929d83c1c4b60e38c104743be71170efe) named mcut.exe instead\nof the Norman Safeground AS for sideloading as they have in the past. The encrypted ZeroT payload,\nnamed Mctl.mui, is decoded in memory revealing a similarly tampered PE header and only slightly\nmodified code when compared to ZeroT payloads we analyzed previously.\n\nOnce ZeroT is running, we observed that the fake User-Agent used in the requests changed from\n“Mozilla/6.0 (compatible; MSIE 10.0; Windows NT 6.2; Tzcdrnt/6.0)” to “Mozilla/6.0 (compatible; MSIE\n11.0; Windows NT 6.2)”, thus removing the “Tzcdrnt” typo observed in previous versions. The initial\nbeacon to index.php changed to index.txt but ZeroT still expects an RC4-encrypted response using a\nstatic key: “(*^GF(9042&*”.\n\n_Figure 5: ZeroT initial beacon over HTTP requesting URL configuration_\n\n\n-----\n\nNext, ZeroT uses HTTP beacons to transmit information about the infected system to the command and\ncontrol (C&C). All posts are encrypted, unlike the last time we analyzed a sample from this actor, when\nthe first POST was accidentally not encrypted. After that, stage 2 payloads are still retrieved as Bitmap\n[(BMP) images that use Least Significant Bit (LSB) Steganography to hide the real payloads. These](https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx)\nimages appear normal in image viewers.\n\n_Figure 6: Collage of example BMP images containing stage 2 payloads hidden using LSB steganography_\n\nThe stage 2 payload was PlugX that beaconed to C&C servers www[.]icefirebest[.]com and\nwww[.]icekkk[.]net.\n\n_Figure 7: ZeroT and PlugX HTTP network activity_\n\n**Additional 2017 activity by TA459**\n\n\n-----\n\nThroughout 2017 we observed this threat actor actively attempting to compromise victims with various\nmalware payloads. ZeroT remained the primary stage 1 payload, but the stage 2 payloads varied. One\nsuch interesting example was “ПЛАН РЕАЛИЗАЦИИ ПРОЕКТА.rar” (SHA256\nb5c208e4fb8ba255883f771d384ca85566c7be8adcf5c87114a62efb53b73fda). Translated from Russian,\nthis file is named “PROJECT REALIZATION PLAN” and contains a compressed .scr executable. This\nZeroT executable communicated with the C&C domain www[.]kz-info[.]net and downloaded PlugX as\nwell as an additional PCRat/Gh0st Trojan which communicated with the www[.]ruvim[.]net C&C server.\nPCRat/Gh0st is a payload that we do not see this group using frequently.\n\nAnother interesting ZeroT sample (SHA256\nbc2246813d7267608e1a80a04dac32da9115a15b1550b0c4842b9d6e2e7de374) contained the\nexecutable 0228.exe and a decoy document 0228.doc in the RAR SFX archive. Bundling decoy\ndocuments is a common tactic by this group. RAR SFX directives are used to display the decoy while the\nmalicious payload is executed. We suspect that this specific lure was copied from the news article\nhxxp://www.cis.minsk[.]by/news.php?id=7557. This article was about “73-го заседания Экономического\nсовета СНГ”, translated from Russian as “73rd meeting of the CIS Economic Council”, which describes a\nmeeting held in Moscow by the Commonwealth of Independent States (CIS) countries, an organization\nthat includes nine out of the fifteen former Soviet Republics.\n\n_Figure 8: Decoy document_\n\n\n-----\n\n_Figure 9: The believed source of the text in decoy document_\n\n**Conclusion**\n\nTA459 is well-known for targeting organizations in Russia and neighboring countries. However, their\nstrategy, tactics, techniques, and procedures in this particular attack emphasize the importance of\nrigorous patching regimens for all organizations. Even as software vulnerabilities often take a back seat\nto human exploits and social engineering, robust defenses must include protection at the email gateway,\nproactive patch management, and thoughtful end user education. Paying attention to the details of past\nattacks is also an important means of preparing for future attacks. Noting who is targeted, with what\nmalware, and with what types of lures provide clues with which organizations can improve their security\nposture.\n\nAt the same time, multinational organizations like the financial services firms targeted here must be\nacutely aware of the threats from state-sponsored actors working with sophisticated malware to\ncompromise users and networks. Ongoing activity from attack groups like TA459 who consistently target\nindividuals specializing in particular areas of research and expertise further complicate an already difficult\n[security situation for organizations dealing with more traditional malware threats, phishing campaigns,](https://www.proofpoint.com/us/threat-reference/phishing)\nand socially engineered threats every day.\n\n**References**\n\n[[1]https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia](https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia)\n\n[[3]https://www.proofpoint.com/us/threat-insight/post/nettraveler-apt-targets-russian-european-interests](https://www.proofpoint.com/us/threat-insight/post/nettraveler-apt-targets-russian-european-interests)\n\n\n-----\n\n[[3]https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx](https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description**\n\na64ea888d412fd406392985358a489955b0f7b27da70ff604e827df86d2ca2aa SHA256 0721.doc\nCVE-20170199\n\nhxxp://122.9.52[.]215/news/power.rtf URL 0721.doc\npayload\n\nhxxp://122.9.52[.]215/news/power.ps1 URL 0721.doc\npayload\n\nhxxp://www.firesyst[.]net/info/net/sports/drag/cgi.exe URL 0721.doc\npayload\n\nbf4b88e42a406aa83def0942207c8358efb880b18928e41d60a2dc59a59973ba SHA256 ZeroT\n(cgi.exe)\n\nwww.firesyst[.]net Hostname ZeroT C&C\n\nwww.icekkk[.]net Hostname PlugX C&C\n\n**Indicators of Compromise (IOCs) - Related**\n\n**IOC** **IOC Type** **Description**\n\nwww.kz-info[.]net Hostname ZeroT C&C\n\nwww.firesyst[.]net Hostname ZeroT C&C\n\nwww.buleray[.]net Hostname ZeroT C&C\n\nwww.intersu[.]net Hostname ZeroT C&C\n\n868ee879ca843349bfa3d200f858654656ec3c8128113813cd7e481a37dcc61a SHA256 ZeroT\n\n4601133e94c4bc74916a9d96a5bc27cc3125cdc0be7225b2c7d4047f8506b3aa SHA256 ZeroT\n\n5fd61793d498a395861fa263e4438183a3c4e6f1e4f098ac6e97c9d0911327bf SHA256 ZeroT\n\n\n-----\n\nb5c208e4fb8ba255883f771d384ca85566c7be8adcf5c87114a62efb53b73fda SHA256 ZeroT\n\nab4cbfb1468dd6b0f09f6e74ac7f0d31a001d396d8d03f01bceb2e7c917cf565 SHA256 ZeroT\n\n79bd109dc7c35f45b781978436a6c2b98a5df659d09dee658c2daa4f1984a04e SHA256 ZeroT\n\nwww.icekkk[.]net Hostname PlugX C&C\n\nwww.icefirebest[.]com Hostname PlugX C&C\n\nwww.ruvim[.]net Hostname PlugX C&C\n\n**ET and ETPRO Suricata/Snort Coverage**\n\n2821028 | ETPRO TROJAN APT.ZeroT CnC Beacon HTTP POST\n\n2825365 | ETPRO TROJAN APT.ZeroT CnC Beacon Fake User-Agent\n\n2824641 | ETPRO TROJAN APT.ZeroT Receiving Config\n\n2810326 | ETPRO TROJAN PlugX Related Checkin\n\n2024196 | ET WEB_CLIENT HTA File containing Wscript.Shell Call - Potential Office Exploit Attempt\n\n2024197 | ET CURRENT_EVENTS SUSPICIOUS MSXMLHTTP DL of HTA (Observed in RTF 0-day )\n\n2016922 | ET TROJAN Backdoor family PCRat/Gh0st CnC traffic\n\n2021716 | ET TROJAN Backdoor family PCRat/Gh0st CnC traffic (OUTBOUND) 102\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-27 - APT Targets Financial Analysts with CVE-2017-0199.pdf"
    ],
    "report_names": [
        "2017-04-27 - APT Targets Financial Analysts with CVE-2017-0199.pdf"
    ],
    "threat_actors": [
        {
            "id": "0bf35542-9ebc-44a9-b319-b6df0bee4bac",
            "created_at": "2022-10-25T15:50:23.437853Z",
            "updated_at": "2025-03-27T02:00:55.468981Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [
                "TA459"
            ],
            "source_name": "MITRE:TA459",
            "tools": [
                "gh0st RAT",
                "NetTraveler",
                "PlugX",
                "ZeroT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7041fcf5-b34d-47c3-be4c-3c40f243af89",
            "created_at": "2023-01-06T13:46:38.611261Z",
            "updated_at": "2025-03-27T02:00:02.872972Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [
                "G0062"
            ],
            "source_name": "MISPGALAXY:TA459",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "254f2fab-5834-4d90-9205-d80e63d6d867",
            "created_at": "2023-01-06T13:46:38.31544Z",
            "updated_at": "2025-03-27T02:00:02.802896Z",
            "deleted_at": null,
            "main_name": "APT21",
            "aliases": [
                "HAMMER PANDA",
                "TEMP.Zhenbao",
                "NetTraveler"
            ],
            "source_name": "MISPGALAXY:APT21",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "802552ac-1f16-4b85-8d78-76d683684124",
            "created_at": "2022-10-25T16:07:24.28032Z",
            "updated_at": "2025-03-27T02:02:10.158732Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [],
            "source_name": "ETDA:TA459",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "NetTraveler",
                "Netfile",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav",
                "ZeroT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536170,
    "ts_updated_at": 1743041494,
    "ts_creation_date": 1653697873,
    "ts_modification_date": 1653697873,
    "files": {
        "pdf": "https://archive.orkl.eu/7bcff2748ce073d5e4fac424536ba8103f288789.pdf",
        "text": "https://archive.orkl.eu/7bcff2748ce073d5e4fac424536ba8103f288789.txt",
        "img": "https://archive.orkl.eu/7bcff2748ce073d5e4fac424536ba8103f288789.jpg"
    }
}