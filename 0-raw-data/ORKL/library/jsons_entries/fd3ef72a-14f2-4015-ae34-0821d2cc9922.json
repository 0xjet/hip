{
    "id": "fd3ef72a-14f2-4015-ae34-0821d2cc9922",
    "created_at": "2023-01-12T15:02:30.424373Z",
    "updated_at": "2025-03-27T02:17:05.646874Z",
    "deleted_at": null,
    "sha1_hash": "ae80513c7a47fba8709f26a41b6be6e62366bbb7",
    "title": "2022-03-30 - Analysis of BlackGuard - a new info stealer malware being sold in a Russian hacking forum",
    "authors": "",
    "file_creation_date": "2022-05-29T01:21:49Z",
    "file_modification_date": "2022-05-29T01:21:49Z",
    "file_size": 2309424,
    "plain_text": "# Analysis of BlackGuard - A New Info Stealer Malware Being Sold In A Russian Hacking Forum\n\n**[zscaler.com/blogs/security-research/analysis-blackguard-new-info-stealer-malware-being-sold-russian-hacking](https://www.zscaler.com/blogs/security-research/analysis-blackguard-new-info-stealer-malware-being-sold-russian-hacking)**\n\n## Introduction:\n\nHacking forums often double up as underground marketplaces where cybercriminals buy,\nrent, and sell all kinds of malicious illegal products, including software, trojans, stealers,\nexploits, and leaked credentials. Malware-as-a-service has contributed substantially to the\ngrowth of ransomware and phishing attacks (among other attack types) in the past year, as\nthey lower the technical barrier to entry for criminals to carry out attacks.\n\nWhile recently perusing one of these hacking forums during regular research activities, the\nZscaler ThreatLabz team came across BlackGuard, a sophisticated stealer, advertised for\nsale. Blackguard is currently being sold as malware-as-a-service with a lifetime price of\n$700 and a monthly price of $200.\n\nBlackGuard has the capability to steal all types of information related to Crypto wallets,\nVPN, Messengers, FTP credentials, saved browser credentials, and email clients.\n\nIn this blog, we share analysis and screenshots of the techniques this stealer uses to steal\ninformation and evade detection using obfuscation, as well as techniques used for antidebugging.\n\n\n-----\n\n_Fig 1. Forum thread promoting the BlackGuard stealer_\n\n## Technical Analysis:\n\nBlackGuard is a .NET stealer packed with a crypto packer. Currently, it is in active\ndevelopment and has the following capabilities:\n\n### Anti-Detection:\n\nOnce executed, it checks and kills the processes related to antivirus and sandbox as shown\nin the figure below.\n\n_Fig 2. BlackGuard detects antivirus processes_\n\n### String Obfuscation:\n\n\n-----\n\nThe stealer contains a hardcoded array of bytes which is decoded in runtime to ASCII\nstrings followed by base64 decoding. This allows it to bypass antivirus and string-based\ndetection.\n\n_Fig 3. String decryption technique_\n\n### Anti-CIS:\n\nBlackGuard checks for the infected device country by sending a request to\n“http://ipwhois.app/xml/” and exits itself if the device is located in the Commonwealth of\nIndependent States (CIS).\n\n_Fig 4. Whitelist CIS_\n\n### Anti-Debug:\n\nBlackGuard uses user32!BlockInput() which can block all mouse and keyboard events in\norder to disrupt attempts at debugging.\n\n\n-----\n\n_Fig 5. Anti-debugging technique_\n\n### Stealing Function:\n\nAfter all the checks are completed, the stealer function gets called which collects\ninformation from various browsers, software, and hardcoded directories, as shown in the\nscreenshot below.\n\n\n-----\n\n_Fig 6. Stealer code_\n\n\n-----\n\n-----\n\nFig 7. Features Posted on forum\n\n**Browsers:**\n\nBlackGuard steals credentials from Chrome- and Gecko-based browsers using the static\npath. It has the capability to steal history, passwords, autofill information, and downloads.\n\n_Fig 8. Browser stealing function_\n\n**Cryptocurrency Wallets:**\n\nBlackGuard also supports the stealing of wallets and other sensitive files related to crypto\nwallet applications. It targets sensitive data in files such as wallet.dat that contain the\naddress, the private key to access this address, and other data. The stealer checks for the\ndefault wallet file location in AppData and copies it to the working folder.\n\n\n-----\n\n_Fig 9. Crypto wallet stealing function_\n\n**Crypto Extensions:**\n\nThis stealer also targets crypto wallet extensions installed in Chrome and Edge with\nhardcoded extension IDs as shown in the figure below.\n\n_Fig 10. Crypto extensions stealing function_\n\n### C2 Exfiltration:\n\nAfter collecting the information, BlackGuard creates a .zip of all the files and sends it to the\nC2 server through a POST request along with the system information like Hardware ID and\ncountry as shown in the figure below.\n\n\n-----\n\n_Fig 11. C2 Exfiltration code snippet_\n\n_Fig 12. Traffic capture of exfiltration_\n\n\n-----\n\n_Fig 13. Panel screenshot_\n\n### Targeted Applications:\n\n**Browsers:**\n\nChrome, Opera, Firefox, MapleStudio, Iridium, 7Star, CentBrowser, Chedot, Vivaldi,\nKometa, Elements Browser, Epic Privacy Browser, uCozMedia, Coowon, liebao, QIP Surf,\nOrbitum, Comodo, Amigo, Torch, Comodo, 360Browser, Maxthon3, K-Melon, Sputnik,\nNichrome, CocCoc, Uran, Chromodo, Edge, BraveSoftware.\n\n**Crypto Wallets:**\n\nAtomicWallet, BitcoinCore, DashCore, Electrum, Ethereum, Exodus, LitecoinCore, Monero,\nJaxx, Zcash, Solar, Zap, AtomicDEX, Binance, Frame, TokenPocket, Wassabi.\n\n**Crypto Wallet Extensions:**\n\nBinance, coin98, Phantom, Mobox, XinPay, Math10, Metamask, BitApp, Guildwallet, iconx,\nSollet, Slope Wallet, Starcoin, Swash, Finnie, KEPLR, Crocobit, OXYGEN, Nifty, Liquality,\nAuvitas wallet, Math wallet, MTV wallet, Rabet wallet, Ronin wallet, Yoroi wallet, ZilPay\nwallet, Exodus, Terra Station, Jaxx.\n\n\n-----\n\n**Email Clients:**\n\nOutlook\n\n**Other Applications:**\n\nNordVPN, OpenVPN, ProtonVpn, Totalcomander, Filezilla, WinSCP, Steam\n\n**Messengers:**\n\nTelegram, Signal, Tox, Element, Pidgin, Discord\n\n## Conclusion:\n\nWhile applications of BlackGuard are not as broad as other stealers, BlackGuard is a\ngrowing threat as it continues to be improved and is developing a strong reputation in the\nunderground community.\n\nTo combat against BlackGuard and similar credential theft malware, we recommend that\nsecurity teams inspect all traffic and use malware prevention tools that include both\nantivirus (for known threats) and sandboxing capabilities (for unknown threats). We also\nrecommend training end users on the following:\n\n1. Don’t use the same passwords for all the services and replace them on a regular\n\ncadence.\n2. Use multi-factor authentication where applicable.\n3. Avoid visiting unknown sites.\n4. Avoid opening suspicious unknown files.\n\n## IOCs:\n\n**Hashes:**\n\n4d66b5a09f4e500e7df0794552829c925a5728ad0acd9e68ec020e138abe80ac\n\nc98e24c174130bba4836e08d24170866aa7128d62d3e2b25f3bc8562fdc74a66\n\n7f2542ed2768a8bd5f6054eaf3c5f75cb4f77c0c8e887e58b613cb43d9dd9c13\n\nf2d25cb96d3411e4696f8f5401cb8f1af0d83bf3c6b69f511f1a694b1a86b74d\n\nbbc8ac47d3051fbab328d4a8a4c1c8819707ac045ab6ac94b1997dac59be2ece\n\nf47db48129530cf19f3c42f0c9f38ce1915f403469483661999dc2b19e12650b\n\nead17dee70549740a4e649a647516c140d303f507e0c42ac4b6856e6a4ff9e14\n\n\n-----\n\n1ee88a8f680ffd175943e465bf85e003e1ae7d90a0b677b785c7be8ded481392\n\n71edf6e4460d3eaf5f385610004cfd68d1a08b753d3991c6a64ca61beb4c673a\n\ne08d69b8256bcea27032d1faf574f47d5412b6da6565dbe52c968ccecea1cd5d\n\n**Domains:**\n\nwin.mirtonewbacker.com\n\numpulumpu.ru\n\ngreenblguard.shop\n\nonetwostep.at\n\n## Zscaler coverage:\n\nWe have ensured coverage for the payloads seen in these attacks via advanced threat\nsignatures as well as our advanced cloud sandbox.\n\n### Advanced Threat Protection:\n\nWin32.PWS.Blackguard\n\n### Advanced Cloud Sandbox:\n\n_Fig 14. Zscaler sandbox detection_\n\n\n-----\n\n**About ThreatLabz**\nThreatLabz is the security research arm of Zscaler. This world-class team is responsible for\nhunting new threats and ensuring that the thousands of organizations using the global\nZscaler platform are always protected. In addition to malware research and behavioral\nanalysis, team members are involved in the research and development of new prototype\nmodules for advanced threat protection on the Zscaler platform, and regularly conduct\ninternal security audits to ensure that Zscaler products and infrastructure meet security\ncompliance standards. ThreatLabz regularly publishes in-depth analyses of new and\n[emerging threats on its portal, research.zscaler.com.](https://research.zscaler.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-30 - Analysis of BlackGuard - a new info stealer malware being sold in a Russian hacking forum.pdf"
    ],
    "report_names": [
        "2022-03-30 - Analysis of BlackGuard - a new info stealer malware being sold in a Russian hacking forum.pdf"
    ],
    "threat_actors": [
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535750,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653787309,
    "ts_modification_date": 1653787309,
    "files": {
        "pdf": "https://archive.orkl.eu/ae80513c7a47fba8709f26a41b6be6e62366bbb7.pdf",
        "text": "https://archive.orkl.eu/ae80513c7a47fba8709f26a41b6be6e62366bbb7.txt",
        "img": "https://archive.orkl.eu/ae80513c7a47fba8709f26a41b6be6e62366bbb7.jpg"
    }
}