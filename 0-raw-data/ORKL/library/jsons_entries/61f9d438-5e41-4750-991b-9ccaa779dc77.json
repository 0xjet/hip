{
    "id": "61f9d438-5e41-4750-991b-9ccaa779dc77",
    "created_at": "2023-01-12T15:03:12.922513Z",
    "updated_at": "2025-03-27T02:16:41.158398Z",
    "deleted_at": null,
    "sha1_hash": "56069b044427daa292af1974765d2a7e0d1a8012",
    "title": "2020-06-22 - Inside a TrickBot Cobalt Strike Attack Server",
    "authors": "",
    "file_creation_date": "2022-05-28T17:39:46Z",
    "file_modification_date": "2022-05-28T17:39:46Z",
    "file_size": 1514375,
    "plain_text": "# Inside a TrickBot Cobalt Strike Attack Server\n\n**[labs.sentinelone.com/inside-a-trickbot-cobaltstrike-attack-server/](https://labs.sentinelone.com/inside-a-trickbot-cobaltstrike-attack-server/)**\n\nJoshua Platt\n\nResearch by Joshua Platt and Jason Reaves\n\n## Executive Summary\n\nTrickbot operators utilized PowerTrick and Cobalt Strike to deploy their Anchor\nbackdoor and RYUK ransomware\nWe review the Cobalt Strike portion of the server and how the actors were leveraging it\nagainst multiple targets.\n\n## Background\n\n[TrickBot is the successor of Dyre which at first was primarily focused on banking fraud, even](https://blog.malwarebytes.com/threat-analysis/2016/10/trick-bot-dyrezas-successor/)\n[reusing the same web-injection systems utilized by Dyre. TrickBot has since shifted focus to](https://www.fidelissecurity.com/threatgeek/archive/trickbot-we-missed-you-dyre/)\nenterprise environments over the years. Incorporating everything from network profiling,\nmass data collection and lateral traversal exploits. This focus shift is prevalent in their tertiary\ndeliveries that target enterprise environments. Much like a company whose target will shift\ndepending on what generates the best revenue.\n\nThis report aims to expand upon SentinelLabs earlier reports involving TrickBot:\n\n\n-----\n\nPreviously, in our [PowerTrick reporting, we mentioned an IOC wizardmagik[.]best](https://www.sentinelone.com/wp-content/uploads/top-tier-russian-organized-cybercrime-group-unveils-fileless-stealthy-powertrick-backdoor-for-high-value-targets/)\n(95.179.214[.]127). Typically, the domains are monitored for some time via VirusTotal in an\neffort to further any understanding of the IOC in question. The effort paid off as surprisingly\nsome old attack data from the server containing roughly three sessions (10/7/201910/9/2019) appeared recently. While the log data is only for 3 sessions, data such as this can\nprove to be invaluable for defenders through showcasing actions on objectives and attack\nTTPs from real life scenarios.\n\n## Attack Server\n\nThe server is clearly utilized for further profiling the networks and systems. The actor\nleverages a myriad of open source scripts and tools to gather information and pivot to other\nsystems from existing TrickBot infections.\n\nThis specific server comes into play in the post-Initial Access phase, which is handled by\nTrickBot. TrickBot modules collect large amounts of data on the infected systems and\nattempt to pivot to the domain controller. At this point, actors will jump in and begin the\nprocess of mapping out the network and determining what the next course of action will be.\nOr in other words, they initiate the valuation phase.\n\n## Anatomy of an Attack\n\nIn the later part of 2019, TrickBot conducted campaigns using the CloudApp folder. We can\ncorrelate timestamps from the Cobalt Strike logs to campaign data when TrickBot utilized the\nfolder name[5].\n\nImage1: LS command issued to beacon\nThe actor initially makes a note of this infection:\n\nImage2: Operator\n\nadds note\n\n\n-----\n\nOnce the actors decide to take a look at the infection using Cobalt Strike, they issue a task to\nrun the Cobalt Strike-ToolKits DACheck script, impersonate SYSTEM and run Mimikatz.\n\nImage3: Initial tasks executed after check in\nNext, they begin looking for live hosts and port scanning for particular open ports.\n\nImage4: Port Scan task initiated\nThey also check the members of the Domain Admin group:\n\nImage5: Domain admin checked\nAnd dump the hashes:\n\nImage6: hashdump issued\n\n\n-----\n\nThe actors load in PowerView.ps1 PowerShell script from PowerSploit and begin leveraging\nthe PowerShell script to find where else they can pivot to.\n\nImage7: PowerShell leveraged for enumeration\nDuring this time, other machines in the same domain are pivoted to.\n\nImage8: Interactive Logon\n\nEach machine gets profiled out.\n\nImage9: Machine directory listing\nEventually leading to Ryuk ransomware:\n\n\n-----\n\nImage10: Ryuk upload and detonate\n\nImage11: Ryuk detonated via PsExec\nGoing by the timestamps, we can guess the time period of 2 weeks for dwell time from\nTrickBot -> Pivot and Profile -> Ryuk.\n\n## Tools Leveraged\n\n\n-----\n\nLaZagne\nBloodHound\nAdFind\nPowerSploit\nSMBAutoBrute\nSessionGopher\n\n## IOCs\n\nwizardmagik[.]best\n\nCobalt Strike directory zip:\n\n0cdfe2572b826dd5f7d22e109009465759fea0d4606c70d273981a73bb4e68ac\n\n## References\n\n1: [https://blog.malwarebytes.com/threat-analysis/2016/10/trick-bot-dyrezas-successor/](https://blog.malwarebytes.com/threat-analysis/2016/10/trick-bot-dyrezas-successor/)\n\n2: [https://www.fidelissecurity.com/threatgeek/archive/trickbot-we-missed-you-dyre/](https://www.fidelissecurity.com/threatgeek/archive/trickbot-we-missed-you-dyre/)\n\n3: https://www.sentinelone.com/wp-content/uploads/the-deadly-planeswalker-how-thetrickbot-group-united-high-tech-crimeware-apt/\n\n4: https://www.sentinelone.com/wp-content/uploads/top-tier-russian-organized-cybercrimegroup-unveils-fileless-stealthy-powertrick-backdoor-for-high-value-targets/\n\n5: [https://app.any.run/tasks/8cba0d2f-683a-4402-a42d-25d469e45fc1/](https://app.any.run/tasks/8cba0d2f-683a-4402-a42d-25d469e45fc1/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-22 - Inside a TrickBot Cobalt Strike Attack Server.pdf"
    ],
    "report_names": [
        "2020-06-22 - Inside a TrickBot Cobalt Strike Attack Server.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6fbff48b-7a3e-4e54-ac22-b10f11e32337",
            "created_at": "2022-10-25T16:07:23.318008Z",
            "updated_at": "2025-03-27T02:02:09.734465Z",
            "deleted_at": null,
            "main_name": "APT 4",
            "aliases": [
                "APT 4",
                "Bronze Edison",
                "Maverick Panda",
                "Salmon Typhoo",
                "Sodium",
                "Sykipot",
                "TG-0623",
                "Wisp Team"
            ],
            "source_name": "ETDA:APT 4",
            "tools": [
                "Getkys",
                "Sykipot",
                "Wkysol",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535792,
    "ts_updated_at": 1743041801,
    "ts_creation_date": 1653759586,
    "ts_modification_date": 1653759586,
    "files": {
        "pdf": "https://archive.orkl.eu/56069b044427daa292af1974765d2a7e0d1a8012.pdf",
        "text": "https://archive.orkl.eu/56069b044427daa292af1974765d2a7e0d1a8012.txt",
        "img": "https://archive.orkl.eu/56069b044427daa292af1974765d2a7e0d1a8012.jpg"
    }
}