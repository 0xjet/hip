{
    "id": "fa7bf936-ebeb-4675-9d3b-fbab64e0b8c5",
    "created_at": "2023-01-12T15:09:46.710711Z",
    "updated_at": "2025-03-27T02:11:39.888622Z",
    "deleted_at": null,
    "sha1_hash": "3f687d00b73b9d99f7cf383faaf1cc458a6762b9",
    "title": "2014-10-27 - Full Disclosure of Havex Trojans",
    "authors": "",
    "file_creation_date": "2022-05-28T02:39:00Z",
    "file_modification_date": "2022-05-28T02:39:00Z",
    "file_size": 344113,
    "plain_text": "# Full Disclosure of Havex Trojans\n\n**netresec.com/**\n\nErik Hjelmvik\n\n,\n\nMonday, 27 October 2014 11:11:00 (UTC/GMT)\n\n\nOctober 27, 2014\n\n\n[I did a talk on \"SCADA Network Forensics\" at the](http://www.netresec.com/files/4SICS_SCADA_Network_Forensics_NETRESEC.pdf) [4SICS conference last week, where I](http://4sics.se/)\ndisclosed the results from my analysis of the Havex RAT/backdoor.\n\nThe Havex backdoor is developed and used by a hacker group called Dragonfly, who are\nalso known as \"Energetic Bear\" and \"Crouching Yeti\". Dragonfly is an APT hacker group,\nwho have been reported to specifically target organizations in the energy sector as well as\ncompanies in other ICS sectors such as industrial/machinery, manufacturing and\npharmaceutical.\n\nIn my 4SICS talk I disclosed a previously unpublished comprehensive view of ICS software\nthat has been trojanized with the Havex backdoor, complete with screenshots, version\nnumbers and checksums.\n\n[Dale Petersen, founder of Digital Bond, expressed the following request regarding the lack of](http://www.digitalbond.com/blog/2014/07/02/havex-hype-unhelpful-mystery/)\npublic information about the software trojanized with Havex:\n\nIf the names of the vendors that unwittingly spread Havex were made public, the wide\ncoverage would likely reach most of the affected asset owners.\n\nFollowing Dale's request we decided to publish the information presented at 4SICS also in\nthis blog post, in order to reach as many affected asset owners as possible. The information\npublished here is based on our own sandbox executions of Havex malware samples, which\n[we have obtained via CodeAndSec and](https://twitter.com/CodeAndSec) [malwr.com. In addition to what I presented at 4SICS,](https://malwr.com/)\n[this blog post also includes new findings published by Joel \"scadahacker\" Langill in version](http://twitter.com/scadahacker)\n2.0 of his [Dragonfly white paper, which was released just a couple of hours after my talk.](http://info.belden.com/ab-cyber-security-dragonfly-bc-lp)\n\nIn Symantec's [blog post about Havex they write:](http://www.symantec.com/connect/blogs/dragonfly-western-energy-companies-under-sabotage-threat)\n\nThree different ICS equipment providers were targeted and malware was inserted into\nthe software bundles\n\n**Trojanized MESA Imaging driver**\n\n\n-----\n\nThe first vendor known to have their software trojanized by the Dragonfly group was the\nSwiss company MESA Imaging, who manufacture industrial grade cameras for range\nmeasurements.\n\n_Image: Screenshot of trojanized MESA Imaging driver installer from our sandbox execution_\n\n**Company:** MESA Imaging\n\n**Product:** Swiss Ranger version 1.0.14.706 (libMesaSR)\n\n**Filename:** SwissrangerSetup1.0.14.706.exe\n\n**Exposure:** Six weeks in June and July 2013 (source: Symantec)\n\n**Backdoor:** Sysmain RAT\n\n**MD5:** e027d4395d9ac9cc980d6a91122d2d83\n\n**SHA256:** 398a69b8be2ea2b4a6ed23a55459e0469f657e6c7703871f63da63fb04cefe90\n\n**eWON / Talk2M**\n\n[The second vendor to have their software trojanized was the Belgian company eWON, who](http://www.ewon.biz/)\nprovide a remote maintenance service for industrial control systems called “Talk2M”.\n\n\n-----\n\n[eWon published an incident report in January 2014 and then a follow-up report in July 2014](http://www.ewon.biz/en/talk2m-incident-report.html?cmp_id=7&news_id=4860)\nsaying:\n\nBack in January 2014, the eWON commercial web site www.ewon.biz had been\ncompromised. A corrupted eCatcherSetup.exe file had been uploaded into the CMS\n(Content Management System) of www.ewon.biz web site. eCatcher download\nhyperlinks were rerouted to this corrupted file. The corrupted eCatcherSetup.exe\ncontained a malware which could, under restricted conditions, compromise the Talk2M\nlogin of the infected user.\n\n_Image: Screenshot of trojanized Talk2M eCatcher installer from our sandbox execution_\n\n**Company:** eWON\n\n**Product:** Talk2M eCatcher version 4.0.0.13073\n\n**Filename:** eCatcherSetup.exe\n\n**Exposure:** Ten days in January 2014, 250 copies downloaded (source: Symantec)\n\n**Backdoor:** Havex 038\n\n**MD5:** eb0dacdc8b346f44c8c370408bad4306\n\n**SHA256:** 70103c1078d6eb28b665a89ad0b3d11c1cbca61a05a18f87f6a16c79b501dfa9\n\n\n-----\n\nPrior to version 2.0 of Joel s Dragonfly report, eCatcher was the only product from eWON\nknown to be infected with the Havex backdoor. However, Joel's report also listed a product\n[called “eGrabit”, which we managed to obtain a malware sample for via malwr.com.](https://malwr.com/analysis/ZTlhZmM5YjY5NTk2NDA1Nzg3ZDBkOTIyMzk1ZWNhZmU/)\n\n_Image: Screenshot of trojanized eGrabIt installer from our sandbox execution_\n\n**Company:** eWON\n\n**Product:** eGrabIt 3.0.0.82 (version 3.0 Build 82)\n\n**Filename:** egrabitsetup.exe\n\n**Exposure:** unknown\n\n**Backdoor:** Havex RAT 038\n\n**MD5:** 1080e27b83c37dfeaa0daaa619bdf478\n\n**SHA256:** 0007ccdddb12491e14c64317f314c15e0628c666b619b10aed199eefcfe09705\n\n**MB Connect Line**\n\nThe most recent company known to have their software infected with the Havex backdoor\n[was the German company MB Connect Line GmbH, who are known for their industrial router](http://www.mbconnectline.com/index.php/en/)\nmbNET and VPN service mbCONNECT24.\n\n\n-----\n\n[MB Connect Line published a report about the Dragonfly intrusion in September 2014, where](http://mbconnectline.com/index.php/en/news2/item/abschlussbericht-zum-hacker-angriff-im-april-2014)\nthey write:\n\nOn 16th of April 2014 our website www.mbconnectline.com has been attacked by\nhackers. The files mbCHECK (Europe), VCOM_LAN2 and mbCONFTOOL have been\nreplaced with infected files. These files were available from 16th of April 2014 to 23th\nof April 2014 for download from our website. All of these files were infected with the\nknown Trojan Virus Havex Rat.\n\n_Image: Screenshot of trojanized mbCONFTOOL installer from our sandbox execution_\n\n**Company:** MB Connect Line GmbH\n\n**Product:** mbCONFTOOL V 1.0.1\n\n**Filename:** setup_1.0.1.exe\n\n**Exposure:** April 16 to April 23, 2014 (source: MB Connect Line)\n\n**Backdoor:** Havex RAT 043\n\n**MD5:** 0a9ae7fdcd9a9fe0d8c5c106e8940701\n\n**SHA256:** c32277fba70c82b237a86e9b542eb11b2b49e4995817b7c2da3ef67f6a971d4a\n\n\n-----\n\n_Image: Screenshot of trojanized mbCHECK application from our sandbox execution_\n\n**Company:** MB Connect Line GmbH\n\n**Product:** mbCHECK (EUROPE) V 1.1.1\n\n**Filename:** mbCHECK.exe\n\n**Exposure:** April 16 to April 23, 2014 (source: MB Connect Line)\n\n**Backdoor:** Havex RAT 043\n\n**MD5:** 1d6b11f85debdda27e873662e721289e\n\n**SHA256:** 0b74282d9c03affb25bbecf28d5155c582e246f0ce21be27b75504f1779707f5\n\nNotice how only mbCHECK for users in Europe was trojanized, there has been no report of\nthe USA/CAN version of mbCHECK being infected with Havex.\n\nWe have not been able to get hold of a malware sample for the trojanized version of\nVCOM_LAN2. The screenshot below is therefore from a clean version of this software.\n\n\n-----\n\n_Image: Screenshot VCOM_LAN2 installer_\n\n**Company:** MB Connect Line GmbH\n\n**Product:** VCOM_LAN2\n\n**Filename:** setupvcom_lan2.exe\n\n**Exposure:** April 16 to April 23, 2014 (source: MB Connect Line)\n\n**Backdoor:** unknown\n\n**MD5:** unknown\n\n**SHA256:** unknown\n\n**Conclusions on Havex Trojans**\n\nThe vendors who have gotten their software trojanized by Dragonfly are all European ICS\ncompanies (Switzerland, Belgium and Germany). Additionally, only the mbCHECK version\nfor users in Europe was infected with Havex, but not the one for US / Canada. These facts\nindicate that the Dragonfly / Energetic Bear threat actor seems to primarily target ICS\ncompanies in Europe.\n\n\n-----\n\n**Next: Detecting Havex with NSM**\n\n[Read our follow-up blog post Observing the Havex RAT, which shows how to detect and](http://netresec.com/?b=14BE342)\nanalyze network traffic from ICS networks infected with Havex.\n\nPosted by Erik Hjelmvik on Monday, 27 October 2014 11:11:00 (UTC/GMT)\n\n[Tags: #Havex #ICS #SCADA #Trojan #4SICS](http://www.netresec.com/?page=Blog&tag=Havex)\n\n## Recent Posts\n\n» [Real-time PCAP-over-IP in Wireshark](http://www.netresec.com/?page=Blog&month=2022-05&post=Real-time-PCAP-over-IP-in-Wireshark)\n\n» [Emotet C2 and Spam Traffic Video](http://www.netresec.com/?page=Blog&month=2022-05&post=Emotet-C2-and-Spam-Traffic-Video)\n\n» [Industroyer2 IEC-104 Analysis](http://www.netresec.com/?page=Blog&month=2022-04&post=Industroyer2-IEC-104-Analysis)\n\n» [NetworkMiner 2.7.3 Released](http://www.netresec.com/?page=Blog&month=2022-04&post=NetworkMiner-2-7-3-Released)\n\n» [PolarProxy in Windows Sandbox](http://www.netresec.com/?page=Blog&month=2022-01&post=PolarProxy-in-Windows-Sandbox)\n\n» [PolarProxy 0.9 Released](http://www.netresec.com/?page=Blog&month=2022-01&post=PolarProxy-0-9-Released)\n\n## Blog Archive\n\n» [2022 Blog Posts](http://www.netresec.com/?page=Blog&year=2022)\n\n» [2021 Blog Posts](http://www.netresec.com/?page=Blog&year=2021)\n\n» [2020 Blog Posts](http://www.netresec.com/?page=Blog&year=2020)\n\n» [2019 Blog Posts](http://www.netresec.com/?page=Blog&year=2019)\n\n» [2018 Blog Posts](http://www.netresec.com/?page=Blog&year=2018)\n\n» [2017 Blog Posts](http://www.netresec.com/?page=Blog&year=2017)\n\n» [2016 Blog Posts](http://www.netresec.com/?page=Blog&year=2016)\n\n» [2015 Blog Posts](http://www.netresec.com/?page=Blog&year=2015)\n\n» [2014 Blog Posts](http://www.netresec.com/?page=Blog&year=2014)\n\n» [2013 Blog Posts](http://www.netresec.com/?page=Blog&year=2013)\n\n» [2012 Blog Posts](http://www.netresec.com/?page=Blog&year=2012)\n\n» [2011 Blog Posts](http://www.netresec.com/?page=Blog&year=2011)\n\n\n-----\n\n[List all blog posts](http://www.netresec.com/?page=Blog&blogPostList=true)\n\n## NETRESEC on Twitter\n\nFollow [@netresec on twitter:](http://twitter.com/netresec)\n\n» [twitter.com/netresec](http://twitter.com/netresec)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-10-27 - Full Disclosure of Havex Trojans.pdf"
    ],
    "report_names": [
        "2014-10-27 - Full Disclosure of Havex Trojans.pdf"
    ],
    "threat_actors": [
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536186,
    "ts_updated_at": 1743041499,
    "ts_creation_date": 1653705540,
    "ts_modification_date": 1653705540,
    "files": {
        "pdf": "https://archive.orkl.eu/3f687d00b73b9d99f7cf383faaf1cc458a6762b9.pdf",
        "text": "https://archive.orkl.eu/3f687d00b73b9d99f7cf383faaf1cc458a6762b9.txt",
        "img": "https://archive.orkl.eu/3f687d00b73b9d99f7cf383faaf1cc458a6762b9.jpg"
    }
}