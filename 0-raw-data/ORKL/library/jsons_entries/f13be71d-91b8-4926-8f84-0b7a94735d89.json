{
    "id": "f13be71d-91b8-4926-8f84-0b7a94735d89",
    "created_at": "2023-01-12T15:05:24.928857Z",
    "updated_at": "2025-03-27T02:09:29.848518Z",
    "deleted_at": null,
    "sha1_hash": "85368388814ef9dfaa0feb47e9825d038ead3afd",
    "title": "2020-07-27 - Ensiko- A Webshell With Ransomware Capabilities",
    "authors": "",
    "file_creation_date": "2022-05-29T10:36:50Z",
    "file_modification_date": "2022-05-29T10:36:50Z",
    "file_size": 105186,
    "plain_text": "# Ensiko: A Webshell With Ransomware Capabilities\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/ensiko-a-webshell-with-ransomware-capabilities/](https://blog.trendmicro.com/trendlabs-security-intelligence/ensiko-a-webshell-with-ransomware-capabilities/)**\n\nJuly 27, 2020\n\nEnsiko is a PHP web shell with ransomware capabilities that targets various platforms such as Linux, Windows,\nmacOS, or any other platform that has PHP installed. The malware has the capability to remotely control the\nsystem and accept commands to perform malicious activities on the infected machine.\n\nIt can also execute shell commands on an infected system and send the results back to the attacker via a PHP\nreverse shell. It is capable of scanning servers for the presence of other webshells, defacing websites, sending\nmass emails, downloading remote files, disclosing information about the affected server, brute-force attacks\nagainst file transfer protocol (FTP), cPanel, and Telnet, overwriting files with specified extensions, and more.\n\n## Technical Details\n\n**Webshell Authentication**\n\nThe malware has the ability to be password-protected. For authentication, the malware displays a Not Found\npage with a hidden login form as seen in the next two figures:\n\nNot Found page and hidden login form Figure 1. Not Found page and hidden login form\nPHP code for password authentication Figure 2. PHP code for password authentication\nThe password for this sample is “RaBiitch”, while the following figure shows captured network traffic for an\nauthentication request to the web shell panel:\n\nCaptured network traffic Figure 3. Captured network traffic\nAppearance of Ensiko webshell Figure 4. Appearance of Ensiko webshell\n**Webshell features**\n\nThe following is a list of Ensiko’s capabilities:\n\n**Features** **Description**\n\nPriv Index Download ensikology.php from pastebin\n\n\n-----\n\nRansomware Encrypt files using RIJNDAEL 128 with CBC mode\n\nCGI Telnet Download CGI-telnet version 1.3 from pastebin;\n\nCGI-Telnet is a CGI script that allows you to execute commands on your\nweb server.\n\nReverse Shell PHP Reverse shell\n\nMini Shell 2 Drop Mini Shell 2 webshell payload in ./tools_ensikology\n\nIndoXploit Drop IndoXploit webshell payload in ./tools_ensikology/\n\nSound Cloud Display sound cloud\n\nRealtime DDOS Map Fortinet DDoS map\n\nEncode/Decode Encode/decode string buffer\n\nSafe Mode Fucker Disable PHP Safe Mode\n\nDir Listing Forbidden Turn off directory indexes\n\nMass Mailer Mail Bombing\n\ncPanel Crack Brute-force cPanel, ftp, and telnet\n\nBackdoor Scan Check remote server for existing web shell\n\nExploit Details Display system information and versioning\n\nRemote Server Scan Check remote server for existing web shell\n\nRemote File Downloader Download file from remote server via CURL or wget\n\nHex Encode/Decode Hex Encode/Decode\n\n\nFTP Anonymous Access\nScanner\n\n\nSearch for Anonymous FTP\n\n\nMass Deface Defacement\n\nConfig Grabber Grab system configuration such as “/etc/passwd”\n\nSymLink link\n\nCookie Hijack Session hijacking\n\nSecure Shell SSH Shell\n\nMass Overwrite Rewrite or append data to the specified file type.\n\nFTP Manager FTP Manager\n\nCheck Steganologer Detects images with EXIF header\n\nAdminer Download Adminer PHP database management into the ./tools_ensikology/\n\nPHP Info Information about PHP’s configuration\n\nByksw Translate Character replacement\n\n\n-----\n\nSuicide Self-delete\n\nCode listing Ensiko features Figure 5. Code listing Ensiko features\n**Ransomware Analysis**\n\nThe malware uses PHP RIJNDAEL_128 with CBC mode to encrypt files in a web shell directory and\nsubdirectories and appends filenames with the “.bak” extension. The following code snippet demonstrates this\nbehavior of the malware:\n\nCode showing encryption behavio Figure 6. Code showing encryption behavio\nEncryption and decryption code Figure 7. Encryption and decryption code\nWebshell portion with ransomware key Figure 8. Webshell portion with ransomware key\nLog of files being encrypted Figure 9. Log of files being encrypted\nEncrypted files in directory Figure 10. Encrypted files in directory\nPOST request to affected server Figure 11. POST request to affected server\nThe malware also drops an index.php file and sets it as the default page using a .htaccess file; the attacker is\nalso notified of this action via email. The following code snippet shows this behavior:\n\nCode snippet for dropped .htaccess page Figure 12. Code snippet for dropped .htaccess page\nThe notification that appears when index.php is accessed Figure 13. The notification that appears when\nindex.php is accessed\n\nAppearance of index.php page Figure 14. Appearance of index.php page\nEncoded form of index.php Figure 15. Encoded form of index.php\nDecoded appearance of index.php Figure 16. Decoded appearance of index.php\n**Tool Set**\n\nTo carry out more tasks on an infected system, the malware can load various additional tools onto an infected\nsystem. Most of these tools are loaded from Pastebin. The malware creates a directory called tools_ensikology\nto store these tools.\n\nTools loaded from Pastebin Figure 17. Tools loaded from Pastebin\n**Steganologer**\n\nThere is a technique in which a malicious actor hides code within the exchangeable image file format (EXIF)\nheaders of an image file and uses a PHP function called exif_read_data to extract and run this code on an\naffected server. The steganologer function identifies images with EXIF headers and labels them as a logger. In\nthe following screenshot, test1.jpg and test2.jpg both have EXIF headers with hidden code and are identified s.\n\nFiles with hidden code Figure 18. Files with hidden code\nCode for identifying files with hidden executable code Figure 19. Code for identifying files with hidden\nexecutable code\n**Backdoor Scan**\n\nA backdoor scan checks a given remote host for the existence of a webshell from a hardcoded list.\n\nfirst screenshot of code for finding other webshells on affected server\nSecond screenshot of code for finding other webshells on affected server Figures 20 and 21. Code for finding\nother webshells on affected server\n**Remote server scan**\n\nLike a backdoor scan, the remote server scan function-checks the remote server for the presence of other web\nshells. However, instead of using a hardcoded list, it accepts manual input for files to be searched for:\n\n\n-----\n\nInterface for checking for other webshells\nCode for checking for other webshells Figures 22 and 23. Interface and code for checking for other webshells\n**Mass Overwrite**\n\nThe Mass Overwrite function can rewrite/append the content of all files with specified extensions and\ndirectories, including all subdirectories of a web shell.\n\nUser interface for overwriting files\nCode for overwriting files Figures 24 and 25. User interface and code for overwriting files\n\n## Conclusion\n\nEnsiko is a web shell used by an attacker that enables remote administration, file encryption, and many more\nfeatures on a compromised web server. A common method to deploy web shell is exploiting web application\nvulnerabilities or *gaining access to an already compromised server. Additionally, Ensiko has ransomware\ncapability to encrypt files on an infected web server using the RIJNDAEL encryption algorithm. It is also\ncapable of scanning servers for the presence of other web shells, defacing websites, sending mass emails,\ndownloading remote files, disclosing information about the affected server, gaining access to databases,\nrunning brute-force attacks against file transfer protocol (FTP), cPanel, and Telnet, overwriting files with\nspecified extensions, and more.\n\n**Indicators of Compromise**\n\n**SHA-256 Hash** **Trend Micro Detection Name**\n\n5fdbf87b7f74327e9132b5edb5c217bdcf49fe275945d502ad675c1dd46e3db5 Trojan.PHP.WEBSHELL.SBJKSJ\n\nRansomware\n\nThis article discusses Ensiko, a PHP web shell with ransomware capabilities that targets various platforms such\nas Linux, Windows, or macOS that has PHP installed. It can remotely control a system and accept commands\nto run on the infected machine.\n\nBy: Aliakbar Zahravi July 27, 2020 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-27 - Ensiko- A Webshell With Ransomware Capabilities.pdf"
    ],
    "report_names": [
        "2020-07-27 - Ensiko- A Webshell With Ransomware Capabilities.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535924,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653820610,
    "ts_modification_date": 1653820610,
    "files": {
        "pdf": "https://archive.orkl.eu/85368388814ef9dfaa0feb47e9825d038ead3afd.pdf",
        "text": "https://archive.orkl.eu/85368388814ef9dfaa0feb47e9825d038ead3afd.txt",
        "img": "https://archive.orkl.eu/85368388814ef9dfaa0feb47e9825d038ead3afd.jpg"
    }
}