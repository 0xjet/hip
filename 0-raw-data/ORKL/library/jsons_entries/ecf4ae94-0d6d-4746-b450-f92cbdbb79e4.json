{
    "id": "ecf4ae94-0d6d-4746-b450-f92cbdbb79e4",
    "created_at": "2023-01-12T15:03:05.866325Z",
    "updated_at": "2025-03-27T02:12:44.237552Z",
    "deleted_at": null,
    "sha1_hash": "c4f1d0fa98822cbae79b7815de944179c628ad48",
    "title": "2022-01-23 - Analysis of a DLL Downloader",
    "authors": "",
    "file_creation_date": "2022-07-02T23:16:56Z",
    "file_modification_date": "2022-07-02T23:16:56Z",
    "file_size": 120754,
    "plain_text": "# Analysis of a DLL Downloader\n\n**cyberandramen.net/2022/01/23/analysis-of-a-dll-downloader/**\n\n## Summary\n\nSHA256: dedb8516befa4a5088000b8c7f699dae7f33761403dd355a14684ac89ff56a9a\n\nFilename: Unknown\nFiletype: DLL\nFile size: 39KB\n\nFrom here on, the above DLL will be referred to as “downloader.dll”. The file is capable of:\n\nDownloading files\nInteracting with a C2 server\n\n## Malware Overview\n\nThis is an older file that was first identified around October 2021.\n\n\nJanuary 23, 2022\n\n\nDownloader.dll is a downloader capable of downloading a file from a hardcoded command and control (C2) server. A follow-on stage was not\nidentified.\n\nThe file disguises itself as an extension for Foxit Reader software. Foxit is a software that develops document formatting tools and is based in\nthe U.S. and China.\n\n\n-----\n\nFigure 1\n\nUpon running the DLL, a request is made to online-manual.c1[.]biz, and a file is downloaded to %TEMP%. Looking at the strings output of the\nfile, there is a large base64 encoded string that when decoded, appears to be a batch file as seen below.\n```\n@echo off\n\ncd /d %TEMP%\n\n:WAITING\n\ntimeout /t 1\n\nif not exist \"a.log\" (goto WAITING)\n\ndel /f /q \"a.log\"\n\ninstall.bat\n\ndel /f /q \"%~dpnx0\"\n\n```\nAgain analyzing just the strings, we see a call to run the batch file via the following command:\n```\ncmd /c cd /d \"%TEMP%\" && temp.bat\n\n```\nOne can only assume that the downloaded file is run with another command run via the DLL file:\n```\ncmd /c expand \"%s\" -F:* \"%s\" && del /f /q \"%s\" && echo OK > a.log\n\n```\nThe encoded strings represented by “%s” are likely the downloaded file. We can see from the above output that the file is deleted upon the\nabove command completing.\n\n\n-----\n\n## Network Indicators\n\nonline-manual.c1[.]biz\nhttp://online-manual.c1%5B.%5Dbiz/index.php?user_id=765&type=\n\nThe above infrastructure was tied to a possible Konni campaign by Black Lotus Labs in late November 2021.\n\nLooks similar to this prior campaign from about a month ago\n\nSHA1: 9e6ac79b8eaaa01e7aefe7c896de0944e298549d\n\nSHA1: 9654e17a2b9fe027b5de3c184fac85248887a9ba\n\nSHA1: 518a35bf8c16d5c5c45053c4bdb548529d4b4d74\n\nC2:hxxp://online-manual[.]c1[.]biz\n\n[— Black Lotus Labs (@BlackLotusLabs) November 19, 2021](https://twitter.com/BlackLotusLabs/status/1461708697865015305?ref_src=twsrc%5Etfw)\n\n## Strings\n\nonline-manual.c1.biz\ncmd /c expand “%s” -F:* “%s” && del /f /q “%s” && echo OK > a.log\n/index.php?user_id=765&type=%d\n\\temp.bat\ncmd / c cd /d “%TEMP%” && temp.bat\nQGVjaG8gb2ZmDQoNCmNkIC9kICVURU1QJQ0KOldBSVRJTkcNCnRpbWVvdXQgL3QgMQ0KaWYgbm90IGV4aXN0ICJhLmxvZyIgKGdvd\n\n## Basic Snort/Suricata Rule\n\nalert tcp $HOME_NET any -> any any (msg: “Probaly shouldnt run in production. Possible Konni DLL download URL,”; content:\n“index.php/user_id=”; content:”&type=”; threshold:type limit, track by_src, count 1, seconds m; sid:999999\n\nUnfortunately, the C2 is likely no longer active, and this sample crashes when run in a sandbox. Still, this is an interesting sample that is likely\ntied to Konni, and learning occurred, so that is always a win!\n\nThank you for reading.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-23 - Analysis of a DLL Downloader.pdf"
    ],
    "report_names": [
        "2022-01-23 - Analysis of a DLL Downloader.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b43c8747-c898-448a-88a9-76bff88e91b5",
            "created_at": "2024-02-02T02:00:04.058535Z",
            "updated_at": "2025-03-27T02:00:03.302832Z",
            "deleted_at": null,
            "main_name": "Opal Sleet",
            "aliases": [
                "OSMIUM",
                "Konni",
                "Vedalia"
            ],
            "source_name": "MISPGALAXY:Opal Sleet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b9458777-d970-4e89-b2d2-e532140a390f",
            "created_at": "2024-05-01T02:03:08.140328Z",
            "updated_at": "2025-03-27T02:05:17.41728Z",
            "deleted_at": null,
            "main_name": "NICKEL JUNIPER",
            "aliases": [
                "OSMIUM ",
                "Opal Sleet ",
                "Konni"
            ],
            "source_name": "Secureworks:NICKEL JUNIPER",
            "tools": [
                "KONNI"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535785,
    "ts_updated_at": 1743041564,
    "ts_creation_date": 1656803816,
    "ts_modification_date": 1656803816,
    "files": {
        "pdf": "https://archive.orkl.eu/c4f1d0fa98822cbae79b7815de944179c628ad48.pdf",
        "text": "https://archive.orkl.eu/c4f1d0fa98822cbae79b7815de944179c628ad48.txt",
        "img": "https://archive.orkl.eu/c4f1d0fa98822cbae79b7815de944179c628ad48.jpg"
    }
}