{
    "id": "c4da7c11-a6b1-4ee1-b316-50eeb6436d20",
    "created_at": "2023-06-05T02:06:08.939847Z",
    "updated_at": "2025-03-27T02:15:35.715036Z",
    "deleted_at": null,
    "sha1_hash": "44b62a35140639306c8e664667d0a9327c12ffe1",
    "title": "2022-07-03 - XFiles Stealer Campaign Abusing Follina",
    "authors": "",
    "file_creation_date": "2023-06-04T12:26:10Z",
    "file_modification_date": "2023-06-04T12:26:10Z",
    "file_size": 1515962,
    "plain_text": "# XFiles Stealer Campaign Abusing Follina\n\n**[cyberint.com/blog/research/xfiles-stealer-campaign-abusing-follina/](https://cyberint.com/blog/research/xfiles-stealer-campaign-abusing-follina/)**\n\n## Executive Summary\n\n\nJuly 3, 2022\n\n\nAs many threat actors and groups seek to utilize recently discovered vulnerabilities, the\nCyberint Research Team found several XFiles stealer campaigns, in which Follina\nvulnerability was exploited as part of the delivery phase.\n\nFollina is one of the most widespread vulnerabilities discovered throughout 2022. The\nvulnerability allows a threat actor to perform a remote code execution (RCE) through\nmalicious Word documents.\n\nXFiles stealer is a vastly used info stealer that took off during the end of 2021. The group\nthat sells the stealer is Russia-region based and is currently looking to expand.\n\nRecent evidence suggests that worldwide threat actors’ campaigns abuse the Follina\nvulnerability in order to deliver the XFiles info stealer, which has become popular even\namong veterans.\n\nFigure 1: XFiles Reborn stealer ad on an underground forum\n\n## Purchasing\n\n\n-----\n\nThis campaign consists of two major components. The delivery module includes the Follina\nexploits and the XFiles info stealer sample.\n\n## Follina Exploits\n\nAs expected, once the Follina vulnerability was published, its use became widespread, due\nto its simple exploitation and massive effect when successful. Many exploit developers and\nunderground vulnerability researchers offered exploits abusing Follina, for sale or even for\nfree (Figure 2, 3).\n\nFigure 2: Threat actor publishing fully undetected exploit builder for 3.5K USD.\n\nFigure 3: Exploit being advertised in a\n\nTelegram channel for free\nMost sellers offer malicious documents exploiting this vulnerability to fulfill the buyer’s end\ngoal. The prices vary, depending on the developer’s reputation and level of detection.\n\n## XFiles Reborn Information Stealer\n\nXFiles developers currently operate several Telegram channels and bots to fully support their\ncustomers. They have a news channel, updates channel, and shopping bot along with a\ndirect chat with the seller and overall chat for customers.\n\nThe subscription plans they currently offer are 5, 10, or 20 USD per week, month, or six\nmonths, respectively.\n\n## XFiles Reborn Panel\n\nAlthough the XFiles Reborn group recommends using Telegram as a panel for the\ninformation gathering from the stealers, they also provide the ability to create a “classic”\npanel on a given C2 by the seller (Figure 4, 5).\n\n\n-----\n\nFigure 4: XFiles Reborn\n\nstealer’s panel login page\n\n## XFiles Reborn Group\n\nThe XFiles Reborn group started its operations in March 2021.\n\nThe group reminds us of another fairly new, yet ambitious group, Jester [1], as they put many\nefforts into publicity. Additionally, they do the “extra mile” to make themselves unique\ncompared to other info stealer operators. Simplicity and efficiency is the name of the game.\n\nBefore they had a respectable amount of subscribers to their Telegram channels, the XFiles\nReborn group used to advertise themselves on the notorious underground forum, “Lolz.Guru”\n(Figure 6).\n\n\n-----\n\nFigure 6: XFiles Reborn group’s first post on lolz.guru\n\n### Threat Actors Recruitment\n\nAs for expanding their operation, it seems that they are constantly looking to recruit new\nmembers, mostly ones that already have experience with info stealers.\n\nDuring the past year, a threat actor created a new info stealer named Whisper Project. The\ncampaign went on for a couple of months and started to get subscribers.\n\nWhisper Project was short-lived but looked very professional and seemed to have the\npotential to become quite popular. As XFiles Reborn was looking to expand, they made\nsome efforts to recruit the individual responsible for Whisper Project. Once they were\nsuccessful, the Whisper Project died with an announcement by the creator that he had joined\nthe XFiles Reborn team (Figure 7).\n\nFigure 7: Whisper Project\n\ncreator announces shutting down the operation and joining XFiles Reborn\n\n### Punisher Miner\n\nThis ambitious group is not only expanding its personnel but also adding new products to\ntheir shelves. Earlier this year, they introduced the Punisher Miner (Figure 8).\n\n\n-----\n\nFigure 8: Punisher Miner’s advertisement on an underground forum\nThis miner seems to be fairly sophisticated, as it supports mining Monero, Toncoin and\nRavecoin. The miner is also packed with evasion techniques, such as hiding itself from the\nTask Manager, delaying execution on startup, and more. The purchasing and building\nprocess is all done via a dedicated Telegram bot that provides a built executable once the\npayment is done. The price of the Punisher Miner is 500 rubles, which is around 10 USD.\n\n\n-----\n\n### XFiles Info Stealer\n\nAlthough they added the miner recently, the group’s flagship is still the info stealer. The\nstealer targets all Chromium-based browsers, Opera, and Firefox browsers, including history,\ncookies, passwords and credit card information.\n\nAlso, the stealer seeks to obtain FTP, Telegram and Discord credentials. In addition, it targets\npredefined file types that are located on the victim’s Desktop along with a screenshot. Other\nclients, such as Steam and crypto-wallets, are also targeted in the process.\n\n## Technical Analysis\n\n### Initial Infection\n\nRecent campaigns suggest that the infection process consists of malicious .docx files\ncontaining an OLE object pointing to the C2 server’s LoadingUpdate.html file (Figure 9).\n\nFigure 10: JavaScript code that exploits Follina\n\n### First Stage\n\nThe HTML file contains a JavaScript code (Figure 10) that will exploit the Follina vulnerability\nin order to download the second infection stage from the C2, ChimLacUpdate.exe.\n\nFigure 10: JavaScript code that exploits Follina\nThe JavaScript code includes an encoded base64 string that, once decoded, reveals a\nPowerShell command that will create persistence within the startup directory for the newlydownloaded file (Figure 11) and execute it.\n\nFigure 11: PowerShell command decoded\n\n### Second Stage\n\nThe second stage is a crucial part of the infection process. The ChimLacUpdate.exe file\nincludes a shellcode runner module. This module contains hardcoded encrypted shell code\nand an AES decryption key.\n\n\n-----\n\nOnce the shellcode is decrypted, it is executed within the same process via the\n```\nVirtualProtect API call (Figure 12) and loaded into an unprotected section within the\n\n```\nrunning process.\n\nFigure 12: Shellcode extraction and execution decompiled function\nAs mentioned, this method is not new and is considered one of the simpler techniques to\nidentify although it is enough for this particular stage.\n\nThe shellcode itself is another downloader from the same C2 that will load and execute the\nXFiles Reborn stealer sample.\n\n## Post Infection\n\nThis part is pretty similar in most info stealers and XFiles is no different. It pursues Discord\nand Telegram credentials, browsing information, such as cookies, passwords and history,\nFTP clients credentials and, of course, crypto wallets.\n\nIn addition, the XFiles stealer looks for something less common: credit card information\nstored in browsing applications.\n\nFinally, in some cases, the stealer looks for particular files such as .txt and .pdf and\ngathers screenshots of the victim’s machine.\n\n## Working Directory\n\nXFiles Reborn creates its working directory in the same path in which it is running, which in\nour case is the %APPDATA% directory. The working directory consists of two directories:\n\n**Grabber – Contains all files stolen and crypto-wallets.**\n**Browsers – Contains all browsing information divided into browser directories.**\n\nThe PCInfo.txt file, which contains the system information of the victim’s machine (Figure\n14), is also created within the working directory along with the captured screenshot.\n\n\n-----\n\nFigure 14: XFiles Reborn working directory\n\n## Data Exfiltration\n\nThe Data exfiltration stage is done via Telegram.\n\nTelegram has become very popular among the new info stealers introduced this year. XFiles\nReborn abuses the simplicity and efficiency of Telegram to get a free, highly anonymous C2\ninfrastructure.\n\nAt this stage, once the stealer has gathered all the necessary information, it dynamically\ncreates a zip file (does not save it locally) as a stream and sends it to the threat actor’s\npreconfigured Telegram bot (Figure 15).\n\n\n-----\n\nFigure 15: C2 Telegram bot presenting new logs notification\n\n## Conclusions\n\nThe discovery of the Follina vulnerability provided threat actors with a new tool to weaponize\ntheir delivery process. It is inevitable and obvious that these techniques will be seen in\nongoing campaigns, especially when we observe the info stealers industry.\n\nOver the past six months, the Cyberint Research Team has witnessed massive numbers of\nnew info stealers introduced to the market.\n\nThe trend of deploying C2 infrastructure using Telegram, which requires minimal effort on the\npart of the operators and developers, is taking over and lowering the level of skill that used to\nbe required by threat actors in order to establish their own info stealer brand.\n\nCyberint Research Team is convinced that this trend will lead to many more threat actors and\ninfo stealers brands in the marketplaces, as other types of malware, such as RATs or even\nransomware, follow the trend.\n\n## References\n\n[1] [https://cyberint.com/blog/research/jester-stealer/](https://cyberint.com/blog/research/jester-stealer/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-03 - XFiles Stealer Campaign Abusing Follina.pdf"
    ],
    "report_names": [
        "2022-07-03 - XFiles Stealer Campaign Abusing Follina.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1685930768,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1685881570,
    "ts_modification_date": 1685881570,
    "files": {
        "pdf": "https://archive.orkl.eu/44b62a35140639306c8e664667d0a9327c12ffe1.pdf",
        "text": "https://archive.orkl.eu/44b62a35140639306c8e664667d0a9327c12ffe1.txt",
        "img": "https://archive.orkl.eu/44b62a35140639306c8e664667d0a9327c12ffe1.jpg"
    }
}