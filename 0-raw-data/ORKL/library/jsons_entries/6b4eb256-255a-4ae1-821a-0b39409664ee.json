{
    "id": "6b4eb256-255a-4ae1-821a-0b39409664ee",
    "created_at": "2023-01-12T15:05:47.443753Z",
    "updated_at": "2025-03-27T02:16:14.033031Z",
    "deleted_at": null,
    "sha1_hash": "5be3843cf77559436c2d39837750fa0af0934ef3",
    "title": "2021-05-01 - Muddywater- Binder Project",
    "authors": "",
    "file_creation_date": "2022-05-28T17:54:58Z",
    "file_modification_date": "2022-05-28T17:54:58Z",
    "file_size": 1054190,
    "plain_text": "# MuddyWater: Binder Project (Part 1)\n\n**marcoramilli.com/2021/05/01/muddywater-binder-project-part-1/**\n\nView all posts by marcoramilli May 1, 2021\n\n[According to Lab Dookhtegan, which you migth remeber him/their from HERE,](https://marcoramilli.com/2019/06/27/similarities-and-differences-between-muddywater-and-apt34/) [HERE and](https://marcoramilli.com/2019/06/06/apt34-jason-project/) [HERE,](https://marcoramilli.com/2019/04/23/apt34-webmask-project/) `Binder is a project`\nrelated to IRGC cyber espionage group build for trojenize google apps (APK). The application “trojenization” is a wellknown process which takes as input a good APK and a code to inject (a RAT, for example). The system is able to\nunbuild the original APK and to inject the RAT into the “good application”. The result is a Trojan which could compromize\nan unaware target. Indeed unaware users by opening up the trojenized APK will run the desired application as wel as\nthe RAT in a background process by starting up the infection chain. MuddyWater is notoriusly alledged linked to IRGC\n[(HERE) as main contractors so what this blog post. According with ClearSky (Report HERE) Iranian cyber espionage](https://www.clearskysec.com/operation-quicksand/)\nforces are increasing their mobile abilities by meaning they are investing in Mobile (RAT andTrojan) development on\neither iOS and Android operative systems. All these information are rolling on the same direction and they are building\nup a concrete base to start to analyze what Lab Dookhtegan released over the past weeks.\n\n\n-----\n\nMessage from Lab Dookhtegan on March 15th 2021\nIndeed Lab Dookhtegan leaked some source code allegedly belonging to `Binder project on his/their Telegram`\nchannel. Let’s check some interesting points that we might deduce from that code without performing a complete source\ncode analysis.\n\n**Source Code Highlights**\n\nThe first file that I’d like to point out is named: `action.aspx.cs . First of all we can deduce that` `Binder is a web`\napplication. We have no idea at this stage if there is a GUI involved or simple API calls, but let’s analyze the source that\nwe’ve got from telegram.\n\nA first observation comes form authenication methods. As you might see from the following snip, before getting inside\nthe main loop – which loops for `tasks to be executed – the user need to be authenticated. The authentication, comes`\nfrom the `Authorization HTTP Headers. After that, we see exactly what we were actually thinking about trojenize`\napplications. In other words taking `apk_path and` `rat_path and building a resulting` `apk to be inoculated to victims.`\n\n\n-----\n\n```\n[ ]\nif (st.get_apiToken(\"user\", \"pass\").Equals(Request.Headers.Get(\"Authorization\")))\n      {\n        LB_Log.Items.Add(\"connected ... \");\n        string res = ch.getTask();\n        if (!res.Equals(\"non\"))\n        {\n          var tasks = JArray.Parse(res);\n          for (int i = 0; i < tasks.Count; i++)\n          {\n            JObject jObject = JObject.Parse(tasks[i].ToString());\n            JObject aJson = jObject.GetValue(\"apk_path\").ToObject<JObject>();\n            JObject rJson = jObject.GetValue(\"rat_path\").ToObject<JObject>();\n            string id = jObject.GetValue(\"id\").ToObject<string>();\n            string apkDotApk = aJson.GetValue(\"path\").ToObject<string>();\n            string apkName = apkDotApk.Remove(apkDotApk.LastIndexOf(\".\"), 4);\n            string apkId = aJson.GetValue(\"id\").ToObject<string>();\n            string ratDotApk = rJson.GetValue(\"path\").ToObject<string>();\n            string ratName = ratDotApk.Remove(ratDotApk.LastIndexOf(\".\"), 4);\n            string ratId = rJson.GetValue(\"id\").ToObject<string>();\n            int bMethod = jObject.GetValue(\"bmethod\").ToObject<int>();\n            int status = jObject.GetValue(\"status\").ToObject<int>();\n            int getPerm = jObject.GetValue(\"get_perm\").ToObject<int>();\n            string projectPath = AppDomain.CurrentDomain.BaseDirectory + \"binder\\\\\";\n            string ratPath = projectPath + \"apks\\\\\" + id + \"\\\\\" + ratName;\n            string apkPath = projectPath + \"apks\\\\\" + id + \"\\\\\" + apkName;\n[...]\n\n```\nSnippet from action.aspx.cs\n\nFrom the 61th line of code we might understand why `binder is the project name:` `string projectPath =`\n```\nAppDomain.CurrentDomain.BaseDirectory + \"binder\\\"; Finally from line 232 we experience a writing mistake, it\n\n```\nis hard to call this mistake a typo, since letter `i and letter` `e aren’t close in english keyboard layouts, so probably we`\nare reading a non english speaker developer.\n```\n[...]     \n { \n   Log.Items.Add(\"Your authentication is depricated ... \");\n }\n   flag = true;\n[...]\n\n```\nSnippet from action.aspx.cs. Not English speaker.\n\nA second interested leaked file is `RedLogClass.cs . First of all we might appreciate the` `namespace which is`\nconfirming the project name `Binder (following snip for details), but even more interesting we might find how the`\nattacker authenticate the client before processing requests.\n\n\n-----\n\n```\n[ ]\n private bool enableSending = true;\n    private string url = \"http://192.168.20.106/api/add_logs\";\n    private string token =\n\"LEcTqrnm6ySmU4NdccUapeJRt9a6GYmrtSKilRNtCQnaWz4IfzxHFmbR7YDdMmtZCZyh55vwdbRWDe1TIFEdqkuNQdfhr7TpzBRA\";\n    public bool sendLog(string project_name, string category_name, string content, [CallerLineNumber] int\nlineNumber = 0, [CallerMemberName] string caller = null)\n    {\n      if (enableSending)\n      {\n        string response = string.Empty;\n        try\n        {\n          var client = new RestClient(url);\n          client.Timeout = -1;\n          var Request = new RestRequest(Method.POST);\n          Request.AddHeader(\"Accept\", \"application/json\");\n          Request.AddHeader(\"Authorization\", \"Bearer \" + token);\n          //Request.AddHeader(\"Content-Type\", \"application/json; CHARSET=UTF-8\");\n          //Request.AddJsonBody();\n[...]\n\n```\nSnippet from ReadLogClass.cs\n\nIndeed the attacker uses Authorization HTTP Header in the following format in order to authenticate the HTTP request.\nThe authentication is performed by concatenating the word `Bearer with the` `token (line 38). In this specific case we`\nalso have the value of such a token:\n```\nLEcTqrnm6ySmU4NdccUapeJRt9a6GYmrtSKilRNtCQnaWz4IfzxHFmbR7YDdMmtZCZyh55vwdbRWDe1TIFEdqkuNQdfhr7TpzBRA\n\n```\nwhich represents a valid authenticator token. Another intresting observation comes from the `url variable. It contains`\nthe path `/api/add_logs . It might be used as network signature to detect such an malicious implant. As a bonus track`\nwe know the attacker deployed such a tool into a private LAN: `http://192.168.20.106 . This would be interesting`\nlater on, let’s keep it in mind.\n\nLet’s move to another file the `BinderClass.sln which highlights the used VisualStudio version` `14.0.23107.0 and`\nthe minimal visual studio version compatible with: `10.0.40219.1 .`\n```\nMicrosoft Visual Studio Solution File, Format Version 12.00\n# Visual Studio 14\nVisualStudioVersion = 14.0.23107.0\nMinimumVisualStudioVersion = 10.0.40219.1\nProject(\"{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}\") = \"BinderClass\", \"BinderClass.csproj\", \"{648562EB-D95C-4C9EA7D5-7EDAE84E27AC}\"\nEndProject\nGlobal\n     GlobalSection(SolutionConfigurationPlatforms) = preSolution\n          Debug|Any CPU = Debug|Any CPU\n          Release|Any CPU = Release|Any CPU\n     EndGlobalSection\n     GlobalSection(ProjectConfigurationPlatforms) = postSolution\n          {648562EB-D95C-4C9E-A7D5-7EDAE84E27AC}.Debug|Any CPU.ActiveCfg = Debug|Any CPU\n          {648562EB-D95C-4C9E-A7D5-7EDAE84E27AC}.Debug|Any CPU.Build.0 = Debug|Any CPU\n          {648562EB-D95C-4C9E-A7D5-7EDAE84E27AC}.Release|Any CPU.ActiveCfg = Release|Any CPU\n          {648562EB-D95C-4C9E-A7D5-7EDAE84E27AC}.Release|Any CPU.Build.0 = Release|Any CPU\n     EndGlobalSection\n     GlobalSection(SolutionProperties) = preSolution\n          HideSolutionNode = FALSE\n     EndGlobalSection\n     GlobalSection(ExtensibilityGlobals) = postSolution\n          SolutionGuid = {2B405E88-E8FA-4807-A5CF-F8CD4AAB89D6}\n     EndGlobalSection\nEndGlobal\n\n```\nSnipped from BinderClass.sln\n\n\n-----\n\nWe are now reading a quite old version of Microsoft VisualStudio previous to 2017, which according to Microsoft Visual\n[Studio release note it has been released before 2017 (HERE). Now, or we are reading a quite old source code (by](https://docs.microsoft.com/en-us/visualstudio/install/visual-studio-build-numbers-and-release-dates?view=vs-2017&preserve-view=true)\nmenaing this project is up and running from years) or we are reading source code from developer/s who are developing\nsince years without updating their princiapl development tool. While it could be quite unusual keeping an old Visual\nStudio version, Microsoft introduced many “cloud based” features into their recent Visual Studio platform, including the\nability to recognize patterns and malicious code which might be not interesting if you are developing Malware. So, I am\nnot saying this is what happened but I know developers that uses old Visual Studio versions for developing simple PoC\nand RedTeam scripts, so I believe both iphothesis would be concrete.\n\n**Conclusions**\n\nSource code analysis is insanely helpful to map how attackers are evolving. In this quick post I began reading the Binder\nsource code allegedly attributed to MuddyWater in order to better understand capabilities, modus operandi and\nstructures. A second part will get into additional project source code helping communities to better map and classify\nMuddyWater APT.\n\n[Follows the reading on Part2 (HERE)](https://marcoramilli.com/2021/05/07/muddywater-binder-project-part-2/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-01 - Muddywater- Binder Project.pdf"
    ],
    "report_names": [
        "2021-05-01 - Muddywater- Binder Project.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535947,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1653760498,
    "ts_modification_date": 1653760498,
    "files": {
        "pdf": "https://archive.orkl.eu/5be3843cf77559436c2d39837750fa0af0934ef3.pdf",
        "text": "https://archive.orkl.eu/5be3843cf77559436c2d39837750fa0af0934ef3.txt",
        "img": "https://archive.orkl.eu/5be3843cf77559436c2d39837750fa0af0934ef3.jpg"
    }
}