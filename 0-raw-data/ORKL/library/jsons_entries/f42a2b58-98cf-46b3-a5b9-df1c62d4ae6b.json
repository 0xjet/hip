{
    "id": "f42a2b58-98cf-46b3-a5b9-df1c62d4ae6b",
    "created_at": "2022-10-25T16:48:19.44487Z",
    "updated_at": "2025-03-27T02:14:38.698443Z",
    "deleted_at": null,
    "sha1_hash": "e3f17c26a1e9baf918a27b23ed3e6b7e972f0fb1",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-10-27T02:32:43Z",
    "file_modification_date": "2017-10-27T02:32:43Z",
    "file_size": 840674,
    "plain_text": "details about cookies and how to manage them, see our **[Cookie Policy](https://www.welivesecurity.com/privacy/#cookies)** **×**\n\n**News, views, and insight from the ESET security community**\n\n\n# TeleBots are back: Supply-chain attacks against Ukraine\n\n**BY** **[ANTON CHEREPANOV POSTED 30 JUN 2017 - 03:30PM](https://www.welivesecurity.com/author/acherepanov/)**\n\n\nThe latest **[Petya-like outbreak has gathered a lot of attention from the media. However, it](https://www.welivesecurity.com/2017/06/27/new-ransomware-attack-hits-ukraine/)**\nshould be noted that this was not an isolated incident: this is the latest in a series of similar\nattacks in Ukraine. This blogpost reveals many details about the Diskcoder.C (aka ExPetr,\nPetrWrap, Petya, or NotPetya) outbreak and related information about previously unpublished\nattacks.\n\n\n-----\n\nFigure 1 – The timeline of supply-chain attacks in Ukraine.\n\n\n## TeleBots\n\nIn December 2016 we published two detailed blogposts about disruptive attacks conducted by\nthe group ESET researchers call TeleBots, specifically about attacks against **financial**\n**institutions and a** **[Linux version of the KillDisk malware used by this group. The group mounted](https://www.welivesecurity.com/2017/01/05/killdisk-now-targeting-linux-demands-250k-ransom-cant-decrypt/)**\ncyberattacks against various computer systems in Ukraine; systems that can be defined as\n**[critical infrastructure. Moreover, this group has connections with the infamous BlackEnergy](https://en.wikipedia.org/wiki/Critical_infrastructure)**\ngroup that was responsible for the **[December 2015 power outages in Ukraine.](https://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/)**\n\nIn the final stage of its attacks, the TeleBots group always used the KillDisk malware to overwrite\nfiles with specific file extensions on the victims’ disks. Putting the cart before the horse:\ncollecting ransom money was never the top priority for the TeleBots group. The KillDisk malware\nused in the first wave of December 2016 attacks, instead of encrypting, simply overwrites\ntargeted files. Further, it did not provide contact information for communicating with the attacker;\nit just displayed an image from the Mr. Robot TV show.\n\n\n-----\n\nFigure 2 – The picture displayed by KillDisk malware in the first wave of December 2016 attacks.\n\n\nIn the second wave of attacks, the cybersaboteurs behind the KillDisk malware added contact\ninformation to the malware, so it would look like a typical ransomware attack. However, the\nattackers asked for an extraordinary number of bitcoins: 222 BTC (about $250,000 at that time).\nThis might indicate that they were not interested in bitcoins, but their actual aim was to cause\ndamage to attacked companies.\n\n\nFigure 3 – The ransom demand displayed by KillDisk in the second wave of December 2016 attacks.\n\n\nIn 2017, the TeleBots group didn’t stop their cyberattacks; in fact, they became more\nsophisticated. In the period between January and March 2017 the TeleBots attackers\ncompromised a software company in Ukraine (not related to M.E. Doc), and, using VPN tunnels\nfrom there, gained access to the internal networks of several financial institutions.\n\nDuring that attack, those behind TeleBots enhanced their arsenal with two pieces of ransomware\nand updated versions of tools mentioned in the previously-linked blogposts.\n\n\n-----\n\nrewritten from Python in the Rust programming language. The functionality remains the same: it\nis a standard backdoor that uses the Telegram Bot API in order to receive commands from, and\nsend responses to, the malware operator.\n\n\nFigure 4 – Disassembled code of the Win32/TeleBot.AB trojan.\n\n\nThe second backdoor, which was written in VBS and packaged using the script2exe program,\nwas heavily obfuscated but the functionality remained the same as in previous attacks.\n\n\nFigure 5 – The obfuscated version of the VBS backdoor.\n\n\nThis time the VBS backdoor used the C&C server at 130.185.250[.]171. To make connections\nless suspicious for those who check firewall logs, the attackers registered the domain\n**transfinance.com[.]ua and hosted it on that IP address. As is evident from Figure 6 this server**\nwas also running the Tor relay named severalwdadwajunior.\n\n\n-----\n\nFigure 6 – Information about Tor relay run by the TeleBots group.\n\n\nIn addition, the attacker used the following tools:\n\nCredRaptor (password stealer)\n\nPlainpwd (modified Mimikatz used for recovering Windows credentials from memory)\n\nSysInternals’ PsExec (used for lateral movement)\n\nAs mentioned above, in the final stage of their attacks, the TeleBots attackers pushed\nransomware using stolen Windows credentials and SysInternals’ PsExec. This new ransomware\nwas detected by ESET products as Win32/Filecoder.NKH. Once executed, this ransomware\nencrypts all files (except files located in the C:⧵Windows directory) using AES-128 and RSA-1024\nalgorithms. The malware adds the .xcrypted file extension to already-encrypted files.\n\nWhen encryption is done, this filecoder malware creates a text file !readme.txt with the following\ncontent:\n\n_Please contact us: openy0urm1nd@protonmail.ch_\n\nIn addition to Windows malware, the TeleBots group used Linux ransomware on non-Windows\nservers. This ransomware is detected by ESET products as Python/Filecoder.R and, predictably,\nit is written in the Python programming language. This time attackers execute third-party utilities\nsuch as openssl in order to encrypt files. The encryption is done using the RSA-2048 and AES256 algorithms.\n\n\n-----\n\nFigure 7 – Python code of Linux ransomware Python/Filecoder.R used by the TeleBots group.\n\n\nIn the code of Python script, attackers left their comment which had following text:\n\n_feedback: openy0urm1nd[@]protonmail.ch_\n\n## Win32/Filecoder.AESNI.C\n\nOn 18 May 2017, we noticed **[new activity on the part of another ransomware family](https://www.welivesecurity.com/2017/05/23/xdata-ransomware-making-rounds-amid-global-wannacryptor-scare/)**\nWin32/Filecoder.AESNI.C (also referred to as XData).\n\nThis ransomware was spread mostly in Ukraine, because of an interesting initial vector.\nAccording to our LiveGrid® telemetry, the malware was created right after execution of the\nM.E.Doc software that is widely used by accounting personnel in Ukraine.\n\nThe Win32/Filecoder.AESNI.C ransomware had a spreading mechanism that allowed it to\nperform lateral movement automatically, inside a compromised company LAN. Specifically, the\nmalware had an embedded Mimikatz DLL that it used to extract Windows account credentials\nfrom the memory of a compromised PC. With these credentials, the malware started to spread\ninside its host network using SysInternals’ PsExec utility.\n\nIt seems that the attackers either did not reach their goal on that occasion, or it was the test\nbefore a more effective strike. The attackers posted master decryption keys on the\n**[BleepingComputer forum, along with the assertion that this was done because the original](https://www.bleepingcomputer.com/news/security/aes-ni-ransomware-dev-releases-decryption-keys-amid-fears-of-being-framed-for-xdata-outbreak/)**\nauthor claimed that the source was stolen and used in the Ukraine incident.\n\nESET **[published a decryption tool for Win32/Filecoder.AESNI ransomware, and this event didn’t](https://www.welivesecurity.com/2017/05/31/eset-releases-new-decryption-tool-aes-ni-ransomware/)**\ngain much media attention.\n\n## Diskcoder.C (aka Petya-like) outbreak\n\nWhat did gain a lot of media attention, however, was the **[Petya-like outbreak of 27 June, 2017,](https://www.welivesecurity.com/2017/06/27/new-ransomware-attack-hits-ukraine/)**\nbecause it successfully compromised a lot of systems in critical infrastructure and other\n\n\n-----\n\nThe malware in this attack has the ability to replace the Master Boot Record (MBR) with its own\nmalicious code. This code was borrowed from **[Win32/Diskcoder.Petya ransomware. That’s](http://virusradar.com/en/Win32_Diskcoder.Petya.B/description)**\nwhy some other malware researchers have named this threat as ExPetr, PetrWrap, Petya, or\nNotPetya. However, unlike the original Petya ransomware, Diskcoder.C’s authors modified the\nMBR code in such a way that recovery won’t be possible. Specifically, the attacker cannot\nprovide a decryption key and the decryption key cannot be typed in the ransom screen, because\nthe generated key contains non-acceptable characters.\n\nVisually this MBR part of Diskcoder.C looks like a slightly modified version of Petya: at first it\ndisplays a message that impersonates CHKDSK, Microsoft’s disk checking utility. During the\nfaux CHKDISK scan Diskcoder.C actually encrypts the data.\n\n\nFigure 8 – Fake CHKDSK message displayed by Diskcoder.C.\n\n\nWhen encryption is complete, the MBR code displays the next message with payment\ninstructions, but as noted before this information is useless.\n\n\nFigure 9 – Diskcoder.C message with payment instructions.\n\n\n-----\n\nthemselves. This includes file encryption that can be used as a complement to the diskencrypting MBR. For file encryption, the malware uses the AES-128 and RSA-2048 algorithms. It\nshould be noted that the authors made mistakes that make decryption of files less possible.\nSpecifically, the malware encrypts only the first 1MB of data and it does not write any header or\nfooter, only raw encrypted data and does not rename encrypted files, so it’s hard to say which\nfiles are encrypted and which are not. In addition to that, files that are larger than 1MB after\nencryption do not contain padding, so there is no way to verify the key.\n\nInterestingly, the list of target file extensions is not identical but is very similar to the file\nextensions list from the KillDisk malware used in the **[December 2016 attacks.](https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/)**\n\n\nFigure 10 – List of target file extensions from Diskcoder.C.\n\n\nOnce the malware is executed it attempts to spread using the infamous EternalBlue exploit,\nleveraging the DoublePulsar kernel-mode backdoor. Exactly the same method was used in the\nWannaCryptor.D ransomware. Diskcoder.C also adopted the method from the\nWin32/Filecoder.AESNI.C (aka XData) ransomware: it uses a lightweight version of Mimikatz to\nobtain credentials and then executes the malware using SysInternals’ PsExec on other machines\non the LAN. In addition to that, the attackers implemented a third method of spreading using a\nWMI mechanism.\n\nAll three of these methods have been used to spread malware inside LANs. Unlike the infamous\n**[WannaCryptor malware, the EternalBlue exploit is used by Diskcoder.C only against computers](https://www.welivesecurity.com/2017/05/15/wannacryptor-key-questions-answered/)**\nwithin the local network address space.\n\nWhy are there infections in other countries than Ukraine? Our investigation revealed that affected\ncompanies in other countries had VPN connections to their branches, or to business partners, in\nUkraine.\n\n## Initial infection vector\n\nBoth Diskcoder.C and Win32/Filecoder.AESNI.C used a supply-chain attack as the initial\ninfection vector. These malware families were spread using Ukrainian accounting software called\nM.E.Doc.\n\nThere are several options for how this attack can be implemented. The M.E.Doc has an internal\nmessaging and document exchange system so attackers could send spearphishing messages to\nvictims. User interaction is required in order to execute something malicious in this way. Thus,\nsocial engineering techniques would be involved. Since Win32/Filecoder.AESNI.C didn’t spread\nso widely, we mistakenly assumed that these techniques were used in this case.\n\n\n-----\n\nupdate server of the legitimate software. Using access to this server, attackers pushed a\nmalicious update that was applied automatically without user interaction. That’s why so many\nsystems in Ukraine were affected by this attack. However, it seems like the malware authors\nunderestimated the spreading capabilities of Diskcoder.C.\n\nESET researchers found evidence that supports this theory. Specifically, we identified a\nmalicious PHP backdoor that was deployed under medoc_online.php in one of the FTP\ndirectories on M.E.Doc’s server. This backdoor was accessible from HTTP; however, it was\nencrypted, so the attacker would have to have the password in order to use it.\n\n\nFigure 11 – Listing of FTP directory containing the PHP backdoor.\n\n\nWe should say that there are signs that suggest that Diskcoder.C and Win32/Filecoder.AESNI.C\nwere not the only malware families that were deployed using that infection vector. We can\nspeculate that these malicious updates were deployed in a stealthy way to computer networks\nthat belong to high-value targets.\n\nOne such malware that was deployed via this possible compromised M.E.Doc update server\nmechanism was the VBS backdoor used by the TeleBots group. This time the attacker again\nused a financially-themed domain name: bankstat.kiev[.]ua.\n\nOn the day of the Diskcoder.C outbreak, the A-record of this domain was changed to 10.0.0.1\n\n## Conclusions\n\nThe TeleBots group continues to evolve in order to conduct disruptive attacks against Ukraine.\nInstead of spearphishing emails with documents containing malicious macros, they used a more\nsophisticated scheme known as a supply-chain attack. Prior to the outbreak, the Telebots group\ntargeted mainly the financial sector. The latest outbreak was directed against businesses in\nUkraine, but they apparently underestimated the malware’ spreading capabilities. That’s why the\nmalware went out of control.\n\n## Indicators of Compromise (IoC)\n\nESET detection names:\n\n\n-----\n\nVBS/Agent.BB trojan\n\nVBS/Agent.BD trojan\nVBS/Agent.BE trojan\nWin32/PSW.Agent.ODE trojan\nWin64/PSW.Agent.K trojan\nPython/Filecoder.R trojan\nWin32/Filecoder.AESNI.C trojan\nWin32/Filecoder.NKH trojan\nWin32/Diskcoder.C trojan\nWin64/Riskware.Mimikatz application\nWin32/RiskWare.Mimikatz application\n\nC&C servers:\n\ntransfinance.com[.]ua (IP: 130.185.250.171)\nbankstat.kiev[.]ua (IP: 82.221.128.27)\nwww.capital­investing.com[.]ua (IP: 82.221.131.52)\n\nLegitimate servers abused by malware authors:\n\napi.telegram.org (IP: 149.154.167.200, 149.154.167.197, 149.154.167.198,\n149.154.167.199)\n\nVBS backdoor:\n\n1557E59985FAAB8EE3630641378D232541A8F6F9\n31098779CE95235FED873FF32BB547FFF02AC2F5\nCF7B558726527551CDD94D71F7F21E2757ECD109\n\nMimikatz:\n\n91D955D6AC6264FBD4324DB2202F68D097DEB241\nDCF47141069AECF6291746D4CDF10A6482F2EE2B\n4CEA7E552C82FA986A8D99F9DF0EA04802C5AB5D\n4134AE8F447659B465B294C131842009173A786B\n698474A332580464D04162E6A75B89DE030AA768\n00141A5F0B269CE182B7C4AC06C10DEA93C91664\n271023936A084F52FEC50130755A41CD17D6B3B1\n\n\n-----\n\n38E2855E11E353CEDF9A8A4F2F2747F1C5C07FCF\n\n4EAAC7CFBAADE00BB526E6B52C43A45AA13FD82B\nF4068E3528D7232CCC016975C89937B3C54AD0D1\n\nWin32/TeleBot:\n\nA4F2FF043693828A46321CCB11C5513F73444E34\n5251EDD77D46511100FEF7EBAE10F633C1C5FC53\n8D379585E0A9DB4C65450622CED26C108DC694AB\n\nWin32/PSW.Agent.ODE (CredRaptor):\n\n759DCDDDA26CF2CC61628611CF14CFABE4C27423\n77C1C31AD4B9EBF5DB77CC8B9FE9782350294D70\nEAEDC201D83328AF6A77AF3B1E7C4CAC65C05A88\nEE275908790F63AFCD58E6963DC255A54FD7512A\nEE9DC32621F52EDC857394E4F509C7D2559DA26B\nFC68089D1A7DFB2EB4644576810068F7F451D5AA\n\nWin32/Filecoder.NKH:\n\n1C69F2F7DEE471B1369BF2036B94FDC8E4EDA03E\n\nPython/Filecoder.R:\n\nAF07AB5950D35424B1ECCC3DD0EEBC05AE7DDB5E\n\nWin32/Filecoder.AESNI.C:\n\nBDD2ECF290406B8A09EB01016C7658A283C407C3\n9C694094BCBEB6E87CD8DD03B80B48AC1041ADC9\nD2C8D76B1B97AE4CB57D0D8BE739586F82043DBD\n\n\n-----\n\n34F917AABA5684FBE56D3C57D48EF2A1AA7CF06D\n\nPHP shell:\n\nD297281C2BF03CE2DE2359F0CE68F16317BF0A86\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.06.30.telebots-back-supply-chain/TeleBots%20are%20back_%20supply-chain%20attacks%20against%20Ukraine.pdf"
    ],
    "report_names": [
        "TeleBots are back_ supply-chain attacks against Ukraine"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39842197-944a-49fd-9bec-eafa1807e0ea",
            "created_at": "2022-10-25T16:07:24.310589Z",
            "updated_at": "2025-03-27T02:02:10.167471Z",
            "deleted_at": null,
            "main_name": "TeleBots",
            "aliases": [],
            "source_name": "ETDA:TeleBots",
            "tools": [
                "BadRabbit",
                "Black Energy",
                "BlackEnergy",
                "CredRaptor",
                "Diskcoder.C",
                "EternalPetya",
                "ExPetr",
                "Exaramel",
                "FakeTC",
                "Felixroot",
                "GreyEnergy",
                "GreyEnergy mini",
                "KillDisk",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NonPetya",
                "NotPetya",
                "Nyetya",
                "Petna",
                "Petrwrap",
                "Pnyetya",
                "TeleBot",
                "TeleDoor",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "nPetya"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041678,
    "ts_creation_date": 1509071563,
    "ts_modification_date": 1509071563,
    "files": {
        "pdf": "https://archive.orkl.eu/e3f17c26a1e9baf918a27b23ed3e6b7e972f0fb1.pdf",
        "text": "https://archive.orkl.eu/e3f17c26a1e9baf918a27b23ed3e6b7e972f0fb1.txt",
        "img": "https://archive.orkl.eu/e3f17c26a1e9baf918a27b23ed3e6b7e972f0fb1.jpg"
    }
}