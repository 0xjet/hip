{
    "id": "505fb145-96e2-4aa8-bf22-d6466c36763f",
    "created_at": "2023-05-06T02:08:02.820032Z",
    "updated_at": "2025-03-27T02:05:56.581104Z",
    "deleted_at": null,
    "sha1_hash": "def94803ae18c9c282b734d93822b9b5b0daf526",
    "title": "2023-03-30 - Backdoored 3CXDesktopApp Installer Used in Active Threat Campaign",
    "authors": "",
    "file_creation_date": "2023-05-05T01:44:35Z",
    "file_modification_date": "2023-05-05T01:44:35Z",
    "file_size": 272992,
    "plain_text": "# Backdoored 3CXDesktopApp Installer Used in Active Threat Campaign\n\n**[rapid7.com/blog/post/2023/03/30/backdoored-3cxdesktopapp-installer-used-in-active-threat-campaign/](https://www.rapid7.com/blog/post/2023/03/30/backdoored-3cxdesktopapp-installer-used-in-active-threat-campaign/)**\n\nRapid7 March 30, 2023\n\n_Last updated at Mon, 03 Apr 2023 21:12:33 GMT_\n\n_Emergent threats evolve quickly. We will update this blog with new information as it comes to_\n_light and we are able to verify it. Erick Galinkin, Ted Samuels, Zach Dayton, Eoin Miller,_\n_Caitlin Condon, Stephen Fewer, Spencer McIntyre, and Christiaan Beek all contributed to_\n_this blog._\n\n[On Wednesday, March 29, 2023, multiple security firms issued](https://www.crowdstrike.com/blog/crowdstrike-detects-and-prevents-active-intrusion-campaign-targeting-3cxdesktopapp-customers/) [warnings about malicious](https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/)\nactivity coming from a legitimate, signed binary from communications technology company\n3CX. The binary, 3CXDesktopApp, is popular video-conferencing software available for\ndownload on all major platforms. Several analyses have attributed the threat campaign to\n[state-sponsored threat actors, and security firms have observed malicious activity in both](https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/)\nWindows and Mac environments.\n\nRapid7’s threat research teams analyzed the 3CXDesktopApp Windows binary and\nconfirmed that the 3CX MSI installer drops the following files: 3CXDesktopApp.exe, a benign\nfile that loads the backdoored ffmpeg.dll, which reads an RC4-encrypted blob after the\nhexadecimal demarcation of fe ed fa ce in d3dcompiler.dll. The RC4-encrypted blob in\n```\nd3dcompiler.dll is executable code that is reflectively loaded and retrieves .ico files with\n\n```\nappended Base64-encoded strings from GitHub. The encoded strings appear to be\ncommand-and-control (C2) communications. There is a non-exhaustive list of indicators of\ncompromise (IOCs) at the end of this blog.\n\nRapid7 reached out to GitHub’s security team the evening of March 29 about the GitHub\nrepository being used as adversary infrastructure in this campaign. As of 9:40 PM ET, the\nmalicious user has been suspended and the repository is no longer available.\n\nRapid7 Managed Detection and Response (MDR) has observed the backdoored 3CX\ninstaller and components in several customer environments as of March 29, 2023. Rapid7\nMDR is in contact with customers that we believe may be impacted.\n\n## Mitigation Guidance\n\nOfficial [guidance from 3CX confirms that the following clients and versions are affected:](https://www.3cx.com/blog/news/desktopapp-security-alert/)\n\nElectron Windows App (shipped in Update 7) versions 18.12.407 and 18.12.416\nElectron Mac App versions 18 11 1213 18 12 402 18 12 407 and 18 12 416\n\n\n-----\n\nAs of March 30 at 11 AM ET, 3CX has not confirmed which versions of the 3CXDesktopApp\nare definitively unaffected.\n\n**Update March 31: 3CX has** [released new versions of their Windows and Mac Electron app](https://www.3cx.com/blog/news/desktopapp-security-alert-updates/)\nas of March 31. Their [update included the following statement:](https://www.3cx.com/blog/news/desktopapp-security-alert-updates/)\n\n\"The Electron App update that we are releasing today is considered to be secure but there is\nno guarantee given that we only had 24 hours to make the necessary adjustments.\"\n\nRapid7 is continuing to advise customers to pursue a conservative mitigation strategy of\n**uninstalling 3CXDesktopApp on all platforms and removing any artifacts left behind.**\nUsers should retroactively hunt for indicators of compromise and block known-bad domains.\nThere is a non-exhaustive list of known-bad domains and malicious file hashes at the end of\nthis blog.\n\n3CX has a browser-based Progressive Web App (PWA) that does not require the user to\ndownload an executable file. Users should leverage this PWA for the time being instead of\n[downloadable clients. 3CX is intermittently issuing updated guidance here.](https://www.3cx.com/blog/news/desktopapp-security-alert-updates/)\n\n## Rapid7 customers\n\nThe following new rules have been added for Rapid7 InsightIDR and Managed Detection &\nResponse (MDR) customers and will alert on known-bad hashes and file versions of the\nbackdoored executable, as well as known-bad domains in WEB_PROXY and DNS logs:\n\nSuspicious Web Request - 3CX Desktop Supply Chain Compromise\nSuspicious DNS Request - 3CX Desktop Supply Chain Compromise\nSuspicious Process - 3CX Desktop Supply Chain Compromise\n\n[InsightVM and Nexpose customers can use Query Builder (asset.software.product](https://docs.rapid7.com/insightvm/query-builder/)\n\n`CONTAINS` `'3CX Desktop App') or a` [Filtered Asset Search (Software Name](https://docs.rapid7.com/insightvm/performing-filtered-asset-searches/) `contains` `3CX`\n```\nDesktop App) to find assets in their environment with 3CX installed. The March 30 content\n\n```\nrelease also contains a check that will report any installed version of 3CX Desktop App as\nvulnerable. This check may be refined as new information regarding vulnerable versions\ncomes to light.\n\n[A Velociraptor artifact is available here.](https://docs.velociraptor.app/exchange/artifacts/pages/smoothoperator/)\n\n## Indicators of compromise\n\nA non-exhaustive list of known-bad domains is below. We advise blocking these\nimmediately:\n\n\n-----\n\n```\nakamaicontainer[.]com\n\nakamaitechcloudservices[.]com\n\nazuredeploystore[.]com\n\nazureonlinecloud[.]com\n\nazureonlinestorage[.]com\n\nconvieneonline[.]com\n\ndunamistrd[.]com\n\nglcloudservice[.]com\n\njournalide[.]org\n\nmsedgepackageinfo[.]com\n\nmsstorageazure[.]com\n\nmsstorageboxes[.]com\n\nofficeaddons[.]com\n\nofficestoragebox[.]com\n\npbxcloudeservices[.]com\n\npbxphonenetwork[.]com\n\npbxsources[.]com\n\nqwepoi123098[.]com\n\nsbmsa[.]wiki\n\nsourceslabs[.]com\n\nSoyoungjun[.]com\n\nvisualstudiofactory[.]com\n\nzacharryblogs[.]com\n\n```\nMore granular URLs our team has decrypted from C2 communications include:\n```\nhxxps[://]akamaitechcloudservices[.]com/v2/storage\n\nhxxps[://]azuredeploystore[.]com/cloud/services\n\nhxxps[://]azureonlinestorage[.]com/azure/storage\n\nhxxps[://]glcloudservice[.]com/v1/console\n\nhxxps[://]msedgepackageinfo[.]com/microsoft-edge\n\nhxxps[://]msedgeupdate[.]net/Windows\n\nhxxps[://]msstorageazure[.]com/window\n\nhxxps[://]msstorageboxes[.]com/office\n\nhxxps[://]officeaddons[.]com/technologies\n\nhxxps[://]officestoragebox[.]com/api/session\n\nhxxps[://]pbxcloudeservices[.]com/phonesystem\n\nhxxps[://]pbxphonenetwork[.]com/voip\n\nhxxps[://]pbxsources[.]com/exchange\n\nhxxps[://]sourceslabs[.]com/downloads\n\nhxxps[://]visualstudiofactory[.]com/workload\n\nhxxps[://]www[.]3cx[.]com/blog/event-trainings/\n\nhxxps[://]zacharryblogs[.]com/feed\n\n\n```\n**File hashes:**\n```\nCompromised MSI: aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868\n\n3CXDesktopApp.exe: fad482ded2e25ce9e1dd3d3ecc3227af714bdfbbde04347dbc1b21d6a3670405\n\nffmpeg.dll: 7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896\n\nd3dcompiler_47.dll: 11be1803e2e307b647a8a7e02d128335c448ff741bf06bf52b332e0bbf423b03\n\n```\n\n-----\n\nThe following file hashes have been reported as related and malicious by the community but\nnot independently verified by Rapid7 analysts:\n```\ndde03348075512796241389dfea5560c20a3d2a2eac95c894e7bbed5e85a0acc\n\n92005051ae314d61074ed94a52e76b1c3e21e7f0e8c1d1fdd497a006ce45fa61\n\nb86c695822013483fa4e2dfdf712c5ee777d7b99cbad8c2fa2274b133481eadb\n\n\n## Updates\n\n```\n**April 3, 2023:** [CVE-2023-29059 has been assigned to this issue.](https://nvd.nist.gov/vuln/detail/CVE-2023-29059)\n\n## Never miss a blog\n\nGet the latest stories, expertise, and news about security today.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-30 - Backdoored 3CXDesktopApp Installer Used in Active Threat Campaign.pdf"
    ],
    "report_names": [
        "2023-03-30 - Backdoored 3CXDesktopApp Installer Used in Active Threat Campaign.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1683338882,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1683251075,
    "ts_modification_date": 1683251075,
    "files": {
        "pdf": "https://archive.orkl.eu/def94803ae18c9c282b734d93822b9b5b0daf526.pdf",
        "text": "https://archive.orkl.eu/def94803ae18c9c282b734d93822b9b5b0daf526.txt",
        "img": "https://archive.orkl.eu/def94803ae18c9c282b734d93822b9b5b0daf526.jpg"
    }
}