{
    "id": "683ea5cc-bf39-455c-b757-471830809520",
    "created_at": "2023-01-12T14:59:34.893606Z",
    "updated_at": "2025-03-27T02:05:24.825823Z",
    "deleted_at": null,
    "sha1_hash": "1a5362caa7aaedba9661fa7bdcbcdcafd3c11624",
    "title": "2020-01-06 - Pyrogenic Infostealer static analysis ‚Äì Part 0x1",
    "authors": "",
    "file_creation_date": "2022-05-28T19:20:24Z",
    "file_modification_date": "2022-05-28T19:20:24Z",
    "file_size": 551008,
    "plain_text": "# Qealler Infostealer static analysis ‚Äì Part 0x1\n\n**[securityinbits.com/malware-analysis/pyrogenic-infostealer-static-analysis-part-0x1/](https://www.securityinbits.com/malware-analysis/pyrogenic-infostealer-static-analysis-part-0x1/)**\n\nJanuary 6, 2020\n\nQealler is heavily obfuscated Java based Infostealer which is quite active based on\nANY.RUN submission. This will be a three part blog series, this post will focus on\n[Qealler/Pyrogenic static analysis, next part 0x2 we learn unpacking using Java agent and in](https://www.securityinbits.com/malware-analysis/unpacking/unpacking-pyrogenic-qealler-using-java-agent-part-0x2/)\nthe last [part 0x3 we find similarity between Qealler/Pyrogenic variants based on static code](https://www.securityinbits.com/malware-analysis/similarity-between-qealler-pyrogenic-variants-part-0x3/)\n[analysis . You may download the BankPaymAdviceVend_LLCRep.jar from ANY.RUN (MD5:](https://app.any.run/tasks/b59d58a1-4512-48a4-949e-6c80af823a5d)\nF0E21C7789CD57EEBF8ECDB9FADAB26B) and follow along or download the latest\nQealler sample from ANY.RUN submission.\n\nCONTENTS\n\n**Overview**\n\nIt‚Äôs currently targeting different regions e.g. Australian companies[1], Africa and the Middle\nEast[2] [based on the references. I will be using Bytecode Viewer to decompile Jar using](https://bytecodeviewer.com/)\nFernFlower Java Decompiler. Let‚Äôs start with quick dynamic analysis. Our main goal for the\nblog series is to unpack this jar so we can analyse the capability and compare it with Qealler.\n\n\n**Quick Dynamic Analysis**\n\nConnect to CC 157.245.160[.]150 at port 80 and create the below process.\n```\n   cmd.exe /c chcp 1252 > NUL & powershell.exe -ExecutionPolicy Bypass    NoExit -NoProfile -Command \n```\nDrop these two clean files sqlitejdbc.dll (MD5: a4e510d903f05892d77741c5f4d95b5d)\nand jnidispatch.dll (MD5: d2f0da769204b8c45c207d8f3d8fc37e) but it deletes these\ntwo file before exiting.\nConnect to bot.whatismyipaddress.com to get the public IP of the infected system.\nSteal credential from different applications\n\n**Packed Pyrogenic static analysis**\n\n\n-----\n\n1. Open the jar file in BCV (Bytecode Viewer), you will see multiple class files in different\n\npackages. Below pic shows the main entry point of the jar file.\n\nPacked Pyrogenic BCV\n\n\n-----\n\n2. For this sample, I found out that FernFlower decompiled the source code correctly.\n\nSelect View -> Pane 1 -> FernFlower -> Java in BCV as shown below.\n\nBytecode Viewer FernFlower selection\n\n3. If you browse the different class files in BCV, you will find many encrypted class files\n\nwhich don‚Äôt translate to Java src code. e.g. one of them is shown below\n\nPyrogenic encrypted class\n\n\n-----\n\n4. Based on the above encrypted class file, you can guess that there should be some\n\ndecryption algorithm used to decrypt those files.\n5. Decryption algorithms can be custom or well known e.g. AES. Study this example java\n\ncode [3] which encrypt/decrypt using AES.\n\nAES Java Encrypt Decrypt Example\n\nSome of the keyword mentioned in the above java code e.g. getInstance can help us\nto find the encryption algorithm and doFinal can point to final decryption result.\n\n\n-----\n\n6. Let s search for AES references after importing the decompiled src code to Eclipse\n\nIDE.\n\nPyrogenic AES references\n\n\n-----\n\nPyrogenic doFinal reference\n\nPyrogenic PBKDF2WithHmacSHA1 reference\n\n\n-----\n\n7. Based on the above images which shows multiple references, we can confirm that this\n\nsample uses the algo ‚ÄúAES/ECB/PKCS5Padding‚Äù and key may be generated using\n**‚ÄúPBKDF2WithHmacSHA1‚Äù . So it confirmed that it doesn‚Äôt use any custom decryption**\nalgorithm.\n8. We can add our code to write the data to file after doFinal call and execute the sample\n\nin IDE to get the dumped class file Then we can decompile the class file using BCV\nand continue analysis. But it can be multiple layer obfuscation which can make our\nanalysis harder and slower.\n\n**Conclusion**\n\nThis above static analysis method to find the encryption routine and interesting breakpoint\n(doFinal) while debugging is very useful in Java Malware analysis. Using this approach you\nwill not miss any code path but this requires more time and effort. So in the upcoming part\n0x2, we will unpack this malware using Java agent which will speed up our analysis.\n\n[Hope you enjoyed this post, please Follow @Securityinbits me on Twitter to get the latest](https://twitter.com/Securityinbits?ref_src=twsrc%5Etfw)\nupdate about my malware analysis & DFIR journey. Happy Reversing üòä\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-06 - Pyrogenic Infostealer static analysis ‚Äì Part 0x1.pdf"
    ],
    "report_names": [
        "2020-01-06 - Pyrogenic Infostealer static analysis ‚Äì Part 0x1.pdf"
    ],
    "threat_actors": [
        {
            "id": "3a0cfbbc-2acf-4cc8-afe1-1859679c522c",
            "created_at": "2022-10-25T16:07:24.373716Z",
            "updated_at": "2025-03-27T02:02:10.198532Z",
            "deleted_at": null,
            "main_name": "Vendetta",
            "aliases": [
                "TA2719"
            ],
            "source_name": "ETDA:Vendetta",
            "tools": [
                "AsyncRAT",
                "Atros2.CKPN",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "ReZer0",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "RoboSki",
                "Socmer",
                "Zurten"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535574,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1653765624,
    "ts_modification_date": 1653765624,
    "files": {
        "pdf": "https://archive.orkl.eu/1a5362caa7aaedba9661fa7bdcbcdcafd3c11624.pdf",
        "text": "https://archive.orkl.eu/1a5362caa7aaedba9661fa7bdcbcdcafd3c11624.txt",
        "img": "https://archive.orkl.eu/1a5362caa7aaedba9661fa7bdcbcdcafd3c11624.jpg"
    }
}