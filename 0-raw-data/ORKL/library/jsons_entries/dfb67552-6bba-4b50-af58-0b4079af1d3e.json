{
    "id": "dfb67552-6bba-4b50-af58-0b4079af1d3e",
    "created_at": "2023-01-12T15:04:12.808151Z",
    "updated_at": "2025-03-27T02:16:59.334052Z",
    "deleted_at": null,
    "sha1_hash": "7d79ee8934dcfea5aed0da43906e9cd1a2d8a9d7",
    "title": "2017-02-16 - Breaking The Weakest Link Of The Strongest Chain",
    "authors": "",
    "file_creation_date": "2022-05-27T22:07:51Z",
    "file_modification_date": "2022-05-27T22:07:51Z",
    "file_size": 850273,
    "plain_text": "# Breaking The Weakest Link Of The Strongest Chain\n\n**[securelist.com/blog/incidents/77562/breaking-the-weakest-link-of-the-strongest-chain/](https://securelist.com/blog/incidents/77562/breaking-the-weakest-link-of-the-strongest-chain/)**\n\nAuthors\n\nIDF C4I\n\nIdo Naor\n\nAround July last year, more than a 100 Israeli servicemen were hit by a cunning threat actor. The attack compromised\ntheir devices and exfiltrated data to the attackers’ command and control server. In addition, the compromised devices\nwere pushed Trojan updates, which allowed the attackers to extend their capabilities. The operation remains active at the\ntime of writing this post, with attacks reported as recently as February 2017.\n\nThe campaign, which experts believe is still in its early stages, targets Android OS devices. Once the device is\ncompromised, a process of sophisticated intelligence gathering starts, exploiting the ability to access the phone’s video\nand audio capabilities, SMS functions and location.\n\nThe campaign relies heavily on social engineering techniques, leveraging social networks to lure targeted soldiers into\nboth sharing confidential information and downloading the malicious applications.\n\nCharacterized by relatively unsophisticated technical merit, and extensive use of social engineering, the threat actor\ntargets only IDF soldiers.\n\nIDF C4I & the IDF Information Security Department unit, with Kaspersky Lab researchers, have obtained a list of the\nvictims; among them IDF servicemen of different ranks, most of them serving around the Gaza strip.\n\n## Attack Flow\n\n\n-----\n\nThe operation follows the same infection flow across the different victims:\n\n_Figure 1: Campaign’s attack flow_\n\n## Social Engineering\n\nThe threat actor uses social engineering to lure targets into installing a malicious application, while continuously\nattempting to acquire confidential information using social networks. We’ve seen a lot of the group’s activity on Facebook\nMessenger. Most of the avatars (virtual participants in the social engineering stage) lure the victims using sexual\ninnuendo, e.g. asking the victim to send explicit photos, and in return sending fake photos of teenage girls. The avatars\npretend to be from different countries such as Canada, Germany, Switzerland and more.\n\n## Dropper\n\nAfter the victim downloads the APK file from the malicious URL, the attacker expects the victim to install the package\nmanually. The dropper requires common user permissions as shown in the following screenshot.\n\n_Figure 2: Dropper permissions once installed on a victim mobile device_\n\n### Key features\n\nThe dropper relies on the configuration server which uses queries in order to download the best fitting payload for the\nspecified device.\n\nDownloader & Watchdog of the main payload\nPayload update mechanism\nCustomized payload – the dropper sends a list of installed apps, and receives a payload package based on it\nObfuscation – The dropper package is obfuscated using ProGuard, which is an open source code obfuscator and\nJava optimizer, observed in the LoveSongs dropper.\n\n\n-----\n\n### Network Protocols\n\nThe network protocol between the dropper and the configuration server is based on HTTP POST requests. The following\nservers implement a RESTful API:\n\nLoveSongs – http://endpointup[.]com/update/upfolder/updatefun.php\n\nYeeCall, WowoMessanger – http://droidback[.]com/pockemon/squirtle/functions.php\n\n_Figure 3: Communication with C&C server over HTTP_\n\nMost of the communication with the server is in clear-text, except for specific commands which are encrypted using an\nAES-128 hard coded-key.\n\n_Figure 4: WowoMessanger REST-API POST packet capture_\n\n_Figure 5: Fake WowoMessanger app – logic flow_\n\n\n-----\n\nAlong with an ID existence check, the dropper sends a list of the device s installed apps if it hasn t done so already.\n\nThe flow between different variants of the dropper is similar, with minor changes. One variant pretends to be a YouTube\nplayer, while others are chat apps:\n\nLoveSongs has YouTube player functionality, whereas WowoMessanger does not have any legitimate functionality\nwhatsoever; it erases its icon after the first run.\n\n## Payload\n\nThe payload is installed after one of the droppers mentioned above has been downloaded and executed on the victim\ndevice. The only payload we have seen so far is “WhatsApp_Update”.\n\nThe payload is capable of two collection mechanisms:\n\nExecute “On demand” commands – manual commands that are triggered by the operator\nScheduled process – scheduled tasks that collect information periodically from various sources.\n\nMost of the collected data will be sent only when a WI-FI network is available.\n\n## C&C Commands\n\nThe payload uses the WebSocket protocol, which gives the attacker a real-time interface to send commands to the\npayload in a way that resembles ‘reverse shell’. Some of the commands are not yet implemented (as shown in the table\nbelow). The commands gives the operator basic yet dangerous RAT capabilities:\n\nCollect general information about the device e.g. Network operator, GPS location, IMEI etc.\nOpen a browser and browse to a chosen URL\nRead & send SMS messages, and access contacts\nEavesdrop at a specific time and period\nTake pictures (using the camera) or screenshots\nRecord video and audio.\n\n**COLL_AUDIO_RECORDS** **COLL_CALL_RECORDS** **GET_LOCATION** **CHECK_AVAILABILITY**\n\n**OPEN_WEBPAGE** **GET_IMAGE** **GET_DEVICE_INFO** **COLL_CAPTURED_PHOTOS**\n\n**GET_TELEPHONY_INFO** **GET_CELLS_INFO** **TAKE_SCREENSHOT** **CALL_PHONE**\n\n**GET_SEC_GALL_CACHE** **GET_SMS** **SEND_SMS** **GET_CONTACTS**\n\nGET_BOOKMARKS TAKE_BACK_PIC **CHANGE_AUDIO_SOURCE** **RECORD_AUDIO**\n\nGET_SEARCHES CLOSE_APP GET_HISTORY OPEN_APP\n\nGET_CALENDER_EVENTS RESTART GET_USER_DICTIONARY SHUTDOWN\n\nUNINSTALL_APP GET_ACCOUNTS INSTALL_APK GET_INSTALLED_APPS\n\nGET_WHATSAPP_KEY RECORD_FRONT_VIDEO GET_WHATSAPP_BACKUP GET_FILE\n\nGET_CALLS GET_ROOT_STATUS TAKE_FRONT_PIC RECORD_BACK_VIDEO\n\nINVALID_COMMAND REMOVE_FILE\n\n*Commands which were implemented are in bold.\n\n## Scheduled Process\n\nBesides the C&C commands, the payload periodically collects data using various Android APIs. The default time interval\nis 30 seconds. The process collects the following data:\n\n\n-----\n\nGeneral data about the device (as mentioned in the C&C command)\nSMS messages, WhatsApp database along with the encryption key (requires root permissions which is not yet fully\nimplemented)\nBrowsing & search history along with bookmarks\nDocuments and archives ( < 2MB ) found in storage (doc, docx, ppt, rar, etc)\nPictures taken, auto captures while on an active call\nList of contacts and call logs\nRecords calls and eavesdrops\nUpdates itself\n\nThe attackers implemented all of the malicious logic without any native or third-party sources. The logic behind the\nautomatic call-recording feature is implemented entirely using Android’s API.\n\n_Figure 6: Call-Recording implementation in WhatsApp_update_\n\n## Conclusions\n\nThe IDF, which led the research along with Kaspersky Lab researchers, has concluded that this is only the opening shot\nof this operation. Further, that it is by definition a targeted attack against the Israeli Defense Force, aiming to exfiltrate\ndata on how ground forces are spread, which tactics and equipment the IDF is using and real-time intelligence gathering.\n\nKaspersky Lab GReAT researchers will disclose more behind-the-scenes details of the operation at the upcoming\n[Security Analyst Summit.](https://sas.kaspersky.com/)\n\n## IOCs\n\n### Domain names & APK hashes\n\nandroidbak[.]com\n\ndroidback[.]com\n\nendpointup[.]com\n\nsiteanalysto[.]com\n\ngoodydaddy[.]com\n\n10f27d243adb082ce0f842c7a4a3784b01f7248e\n\nb8237782486a26d5397b75eeea7354a777bff63a\n\n09c3af7b0a6957d5c7c80f67ab3b9cd8bef88813\n\n9b923303f580c999f0fdc25cad600dd3550fe4e0\n\n0b58c883efe44ff010f1703db00c9ff4645b59df\n\n0a5dc47b06de545d8236d70efee801ca573115e7\n\n782a0e5208c3d9e8942b928857a24183655e7470\n\n5f71a8a50964dae688404ce8b3fbd83d6e36e5cd\n\n03b404c8f4ead4aa3970b26eeeb268c594b1bb47\n\n\n-----\n\n### Certificates SHA1 fingerprints\n\n10:EB:7D:03:2A:B9:15:32:8F:BF:68:37:C6:07:45:FB:DF:F1:87:A6\n\n9E:52:71:F3:D2:1D:C3:22:28:CB:50:C7:33:05:E3:DE:01:EB:CB:03\n\n44:52:E6:4C:97:4B:6D:6A:7C:40:AD:1E:E0:17:08:33:87:AA:09:09\n\n67:43:9B:EE:39:81:F3:5E:10:33:C9:7A:D9:4F:3A:73:3B:B0:CF:0A\n\n89:C8:E2:E3:4A:23:3C:A0:54:A0:4A:53:D6:56:C8:2D:4A:8D:80:56\n\nB4:D5:0C:8B:73:CB:A9:06:8A:B3:F2:49:35:F8:58:FE:A2:3E:2E:3A\n\n[Mobile security](https://securelist.com/tag/mobile-security/)\n[Obfuscation](https://securelist.com/tag/obfuscation/)\n[Social engineering](https://securelist.com/tag/social-engineering/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Trojan](https://securelist.com/tag/trojan/)\n\nAuthors\n\nIDF C4I\n\nIdo Naor\n\nBreaking The Weakest Link Of The Strongest Chain\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-16 - Breaking The Weakest Link Of The Strongest Chain.pdf"
    ],
    "report_names": [
        "2017-02-16 - Breaking The Weakest Link Of The Strongest Chain.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535852,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653689271,
    "ts_modification_date": 1653689271,
    "files": {
        "pdf": "https://archive.orkl.eu/7d79ee8934dcfea5aed0da43906e9cd1a2d8a9d7.pdf",
        "text": "https://archive.orkl.eu/7d79ee8934dcfea5aed0da43906e9cd1a2d8a9d7.txt",
        "img": "https://archive.orkl.eu/7d79ee8934dcfea5aed0da43906e9cd1a2d8a9d7.jpg"
    }
}