{
    "id": "040f8c4a-a9c6-41ed-aa93-fd5646e615c7",
    "created_at": "2023-04-05T02:09:54.179935Z",
    "updated_at": "2025-03-27T02:05:25.643464Z",
    "deleted_at": null,
    "sha1_hash": "dad1825f030846e4c22389881f896b701b780df8",
    "title": "2023-02-28 - Cryptocurrency Entities at Risk- Threat Actor Uses Parallax RAT for Infiltration",
    "authors": "",
    "file_creation_date": "2023-04-03T08:22:01Z",
    "file_modification_date": "2023-04-03T08:22:01Z",
    "file_size": 2267945,
    "plain_text": "# Cryptocurrency Entities at Risk: Threat Actor Uses Parallax RAT for Infiltration\n\n**[uptycs.com/blog/cryptocurrency-entities-at-risk-threat-actor-uses-parallax-rat-for-infiltration](https://www.uptycs.com/blog/cryptocurrency-entities-at-risk-threat-actor-uses-parallax-rat-for-infiltration)**\n\nUptycs Threat Research\n\nParallax RAT (aka, ParallaxRAT) has been distributed through spam campaigns or phishing\nemails (with attachments) since December 2019. The malware performs malicious activities\nsuch as reading login credentials, accessing files, keylogging, remote desktop control, and\nremote control of compromised machines.\n\nThe Uptycs Threat Research team has recently detected active samples of the Parallax\nremote access Trojan (RAT) targeting cryptocurrency organizations. It uses injection\ntechniques to hide within legitimate processes, making it difficult to detect. Once it has been\nsuccessfully injected, attackers can interact with their victim via Windows Notepad that likely\nserves as a communication channel.\n\n## Malware operation\n\nFigure 1shows the ParallaxRAT workflow.\n\n_Figure 1: ParallaxRAT workflow_\n\n\n-----\n\n### Payload1\n\nCompiled using Visual C++, payload1 is a binary file in the form of a 32-bit executable. It\nseems to have been intentionally obfuscated by threat actors (TA) wanting to hide\nsomething. Its fifth section (figure 2, highlighted) seems to have been altered and is\nunusually large compared to the remainder.\n\nMoreover, this section has been marked with the \"Code and Executable\" flag, indicating it\ncontains executable code. The TA was able to decrypt its content and use it to create a new\nbinary, which we refer to as payload2 (i.e., Parallax RAT). Payload1 uses a technique known\nas [process-hollowing to inject payload2 into a legitimate Microsoft pipanel.exe process that](https://attack.mitre.org/techniques/T1055/012/)\nthen gets launched by an attacker.\n\n[To maintain persistence, payload1 creates a copy of itself in the Windows Startup folder.](https://attack.mitre.org/techniques/T1547/001/)\n\n_Figure 2: Payload1 binary_\n\n### Payload2\n\nParallaxRAT is a 32-bit binary executable that gathers sensitive information from victimized\nmachines, e.g., system information, keylogging, and remote control functionality.\n\nIt has null import directories and encrypted data is stored in the .data section. The attacker\nuses the RC4 algorithm to decrypt this data, revealing the DLLs required for further action.\n\n\n-----\n\n_Figure 3: RC4 decryption algorithm_\n\n## System information\n\nAn attacker can extract sensitive information from a victim's machine, including computer\nname and operating system (OS) version. And the attacker is able to read data stored in the\nclipboard.\n\n\n-----\n\n_Figure 4: Read victim machine_\n\nUptycs has detected and recorded the same event.\n\n_Figure 5: Uptycs event detection_\n\n## Keystrokes\n\n\n-----\n\nThe attacker has the ability to read and record their victim s keystrokes, which are then\nencrypted and stored in the %appdata%\\Roaming\\Data\\Keylog_<Data> directory.\n\n_Figure 6: Keylogger data_\n\n## Command and control\n\nAfter successfully infecting a victim's machine, the malware sends a notification to the\nattacker. They then [interact with the victim by posing questions via Notepad and instructing](https://attack.mitre.org/tactics/TA0011/)\nthem to connect to a Telegram channel.\n\n_Figure 7: Attacker shared Telegram ID via Notepad_\n\n\n-----\n\n## Shutdown\n\nThe attacker is able to remotely shut down or restart the victim's machine. Here, they\nremotely restarted our test machine (figure 8).\n\n_Figure 8: Attacker restarted victim machine_\n\n## Script file\n\nThe ParallaxRAT binary was extracted from memory and independently executed, wherein it\ndrops a UN.vbs file and runs that using the wscript.exe tool. The script deletes the payload\nand erases any traces of its existence.\n\n_Figure 9: Visual Basic script_\n\n## Threat actor objective\n\nThe threat actor uses a commercially available remote access Trojan (RAT) tool. It grabs\nprivate email addresses of cryptocurrency companies from the website, dnsdumpster.com.\nParallaxRAT subsequently disseminated malicious files via phishing emails and obtained\nsensitive data.\n\n\n-----\n\nThe Uptycs Threat Intel research team conducted a thorough analysis to gain a better\nunderstanding of the operations and goals of the actor modules, we have engaged with the\nthreat actor. The following picture illustrates how the actor is utilizing Parallax RAT in his\ncampaign targeting crypto companies.\n\n_Figure 10: Telegram chat and attacker’s mindmap_\n\n_Figure 11: ParallaxRAT grabs target company info from public source_\n\n\n-----\n\n## Conclusion – Uptycs EDR detects and blocks ParallaxRAT attacks\n\nIt’s important for organizations to be aware of this malware’s existence and take necessary\nprecautions to protect systems and data. With YARA built-in and armed with other advanced\ndetection capabilities, Uptycs EDR customers can easily scan for ParallaxRAT. EDR\ncontextual detection provides important details about identified malware. Users can navigate\nto the toolkit data section in a detection alert, then click the name of a detected item to reveal\nits profile (figure 12).\n\n_Figure 12: Uptycs EDR detection showing ParallaxRAT—YARA rule match_\n\n## IOCs\n\n**File name** **Md5 hash**\n\nPayload1 40256ea622aa1d0678f5bde48b9aa0fb\n\nPayload2 698463fffdf10c619ce6aebcb790e46a\n\npipanel.exe(Legitimate) 3c98cee428375b531a5c98f101b1e063\n\nmilk.exe 40256ea622aa1d0678f5bde48b9aa0fb\n\n\n-----\n\n### Persistence\n\nC:\\users\\<username>\\appdata\\roaming\\microsoft\\windows\\start\nmenu\\programs\\startup\\milk.exe\n\n### Domain/URL\n\nBy analyzing the VirusTotal graph, we were able to identify a higher number of Parallax RAT\nsamples spreading in recent days. All the files are communicating with the USA regions\n(144.202.9.245:80) as per vt report.\n\n\n-----\n\n_Figure 13: VirusTotal graph for ParallaxRAT_\n\nTag(s): [Threat Hunting,](https://www.uptycs.com/blog/tag/threat-hunting) [Threat Management,](https://www.uptycs.com/blog/tag/threat-management) [EDR,](https://www.uptycs.com/blog/tag/edr) [Threat Research,](https://www.uptycs.com/blog/tag/threat-research) [XDR](https://www.uptycs.com/blog/tag/xdr)\n\n## Uptycs Threat Research\n\nResearch and updates from the Uptycs Threat Research team.\n\nConnect with the author\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-28 - Cryptocurrency Entities at Risk- Threat Actor Uses Parallax RAT for Infiltration.pdf"
    ],
    "report_names": [
        "2023-02-28 - Cryptocurrency Entities at Risk- Threat Actor Uses Parallax RAT for Infiltration.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660594,
    "ts_updated_at": 1743041125,
    "ts_creation_date": 1680510121,
    "ts_modification_date": 1680510121,
    "files": {
        "pdf": "https://archive.orkl.eu/dad1825f030846e4c22389881f896b701b780df8.pdf",
        "text": "https://archive.orkl.eu/dad1825f030846e4c22389881f896b701b780df8.txt",
        "img": "https://archive.orkl.eu/dad1825f030846e4c22389881f896b701b780df8.jpg"
    }
}