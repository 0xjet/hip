{
    "id": "86297efa-05da-475c-b582-2cb8bef39d78",
    "created_at": "2023-01-12T15:10:42.346643Z",
    "updated_at": "2025-03-27T02:05:25.232925Z",
    "deleted_at": null,
    "sha1_hash": "3d24b691e8781dbe5cea5639e35d2253e7249c1f",
    "title": "2019-04-25 - Emotet Adds New Evasion Technique",
    "authors": "",
    "file_creation_date": "2022-05-28T23:51:44Z",
    "file_modification_date": "2022-05-28T23:51:44Z",
    "file_size": 269796,
    "plain_text": "# Emotet Adds New Evasion Technique\n\n**blog.trendmicro.com/trendlabs-security-intelligence/emotet-adds-new-evasion-technique-and-uses-connected-**\ndevices-as-proxy-cc-servers/\n\nApril 25, 2019\n\n**UPDATE as of May 2, 2019 5AM PDT: A previous version of this blog post speculated**\n**that connected devices were used as part of Emotet’s command-and-control**\n**networks. This was based on speculation derived from Shodan results; that particular**\n**section has been removed from the post. We apologize for any confusion our earlier**\n**speculation may have caused.**\n\n[Over the years, Emotet, the banking malware discovered by Trend Micro in 2014, has](https://blog.trendmicro.com/trendlabs-security-intelligence/new-banking-malware-uses-network-sniffing-for-data-theft/)\ncontinued to be a prevalent and costly threat. The United States government estimates that\n[an Emotet incident takes an organization US $1 million to remediate. Unfortunately, it is a](https://www.us-cert.gov/ncas/alerts/TA18-201A)\nwidespread and particularly resilient malware. Its authors have continuously updated it with\n[new capabilities, new distribution techniques, and more.](https://blog.trendmicro.com/trendlabs-security-intelligence/new-emotet-hijacks-windows-api-evades-sandbox-analysis/)\n\nRecently, an analysis of Emotet traffic has revealed that new samples use a different POSTinfection traffic than previous versions. It seems Emotet actors are looking for new ways to\nevade detection.\n\n## Arrival via spam\n\n\n-----\n\nEmotet typically arrives on a victim s system via [spam mail. In the beginning of April,](https://blog.trendmicro.com/trendlabs-security-intelligence/emotet-returns-starts-spreading-via-spam-botnet/)\nsamples of Emotet show that the malware still spreads via spam, but with the help of the\ntrojan downloader Powload. The spam messages trick users into downloading malicious files\nby claiming that an invoice is attached in the email. The attachment is a ZIP file that can be\nopened with the 4-digit password included in the body of the email. A look into the ZIP file\nshows that it contains variants of Powload (detected as Trojan.W97M.POWLOAD). If the\nuser enters the password, the file uses Powershell to download an executable file, which is\nEmotet's payload.\n\n[Figure. 1](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/04/Emotet-1.jpg)\n\nFigure 1. Example of an Emotet spam mail; samples show mail written in many different\nlanguages\n\n## Changes in POST-infection traffic\n\nThe wave of Emotet samples using new POST-infection traffic has been monitored since\n[March 15, 2019. Researchers from Malware-Traffic-Analysis.net and](https://malware-traffic-analysis.net/2019/03/15/index.html) [Cofense also noted](https://cofense.com/flash-bulletin-emotet-epoch-1-changes-c2-communication/)\nchanges in Emotet’s network traffic around this time. As mentioned previously, Emotet has\nundergone many changes since it was first discovered; but this is the first time we have seen\nthis particular POST-infection traffic technique.\n\n[Figure. 2](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/04/Emotet-2.png)\n\nFigure 2. New Emotet post-infection HTTP Post request traffic\n\nPrevious connections from Emotet did not use a URI path, but the newer samples show\nrandomized words used as a URI directory path (see Figure 2) and a random number of\ndirectory paths. These random words in the URI path help the malware evade networkbased detection. An empty URI path is a red flag, so this technique helps the traffic appear\nmore legitimate to security solutions.\n\nBelow is a list of random words used in the URI path, found in the new sample. We can also\nsee these same words in the Emotet executable file.\n\n[Figure. 3](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/04/Emotet-3.jpg)\n\nFigure 3. Decrypted dump with list of words to be used in the URI\n\nApart from the URI path, the data in the HTTP POST message body has also changed.\nPrevious Emotet samples typically used an HTTP GET request to send victim information to\nthe C&C server, and the data is stored in the Cookie header. The data was encrypted using\nan RSA key, AES, and then encoded in Base64 before being added to the Cookie value (see\nFigure 4 HTTP request traffic with Cookie header).\n\n\n-----\n\nNewer traffic shows something different. Actors stayed away from using the Cookie header\nand changed the HTTP request method to POST. The data is still encrypted with an RSA key\nand AES, and encoded in Base 64. However, instead of being stored in the Cookie value, it\nwas put in the body of the HTTP POST message. This change adds another layer of\ncomplexity to help the malware evade detection or delay further investigation if it is detected.\n\n[Figure. 4](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/04/Emotet-4.png)\n\nFigure 4. Comparison between the new Emotet C&C traffic and the previous Emotet C&C\ntraffic\n\n## How can organizations defend themselves?\n\nThe change in POST-infection traffic shows that Emotet is still a constantly evolving and\nresilient threat. The malware authors are fine-tuning evasion techniques and trying to adapt\nto security solutions. If left unchecked and undetected, this threat may lead to a substantial\nloss of money and data for businesses.\n\nCombating threats like Emotet calls for a multilayered and proactive approach to security,\nprotecting all fronts — [endpoints,](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) [networks, and](https://blog.trendmicro.com/en_us/business/products/network.html) [servers. Trend Micro endpoint solutions](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/security-data-center-virtualization.html)\nsuch as [Trend Micro™ Smart Protection Suites and](https://blog.trendmicro.com/en_us/business/products/user-protection.html) [Worry-Free™ Business Security can](https://blog.trendmicro.com/en_us/small-business.html)\nprotect users and businesses from these threats by detecting malicious files and spammed\nmessages, as well as blocking all related malicious URLs. Enterprises can also monitor all\nports and network protocols for advanced threats and be protected from targeted attacks\nwith the [Trend Micro™ Deep Discovery™ Inspector network appliance.](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/inspector.html)\n\nDeep Discovery Inspector protects customers from these threats via this DDI Rule:\n\nDDI Rule 2897: EMOTET - HTTP (Request) - Variant 4\n\nTrend Micro XGen™ security provides a cross-generational blend of threat defense\n[techniques against a full range of threats for data centers, cloud environments, networks,](https://www.trendmicro.com/en_us/business/products/network.html)\n[and endpoints. Smart, optimized, and connected, XGen™ powers Trend Micro’s suite of](https://www.trendmicro.com/en_us/business/products/user-protection.html)\n[security solutions: Hybrid Cloud Security,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html) [User Protection, and](https://blog.trendmicro.com/en_us/business/products/user-protection.html) [Network Defense.](https://blog.trendmicro.com/en_us/business/products/network.html)\n\nMalware\n\nOver the years, Emotet, the banking malware discovered by Trend Micro in 2014, has\ncontinued to be a prevalent and costly threat. Recently, an analysis of Emotet traffic has\nrevealed that new samples use a different POST-infection traffic.\n\nBy: Marco Dela Vega, Jeanne Jocson, Mark Manahan April 25, 2019 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-25 - Emotet Adds New Evasion Technique.pdf"
    ],
    "report_names": [
        "2019-04-25 - Emotet Adds New Evasion Technique.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536242,
    "ts_updated_at": 1743041125,
    "ts_creation_date": 1653781904,
    "ts_modification_date": 1653781904,
    "files": {
        "pdf": "https://archive.orkl.eu/3d24b691e8781dbe5cea5639e35d2253e7249c1f.pdf",
        "text": "https://archive.orkl.eu/3d24b691e8781dbe5cea5639e35d2253e7249c1f.txt",
        "img": "https://archive.orkl.eu/3d24b691e8781dbe5cea5639e35d2253e7249c1f.jpg"
    }
}