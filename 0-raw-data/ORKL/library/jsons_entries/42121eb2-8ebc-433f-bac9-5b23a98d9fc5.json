{
    "id": "42121eb2-8ebc-433f-bac9-5b23a98d9fc5",
    "created_at": "2023-01-12T15:06:04.413102Z",
    "updated_at": "2025-03-27T02:15:26.222712Z",
    "deleted_at": null,
    "sha1_hash": "c559e8d23a4ebecb9f3376d6ff3eebe04cb2d3de",
    "title": "2022-03-23 - Falcon OverWatch Threat Hunting Contributes to Seamless Protection Against Novel BlackCat Attack",
    "authors": "",
    "file_creation_date": "2022-05-28T23:23:49Z",
    "file_modification_date": "2022-05-28T23:23:49Z",
    "file_size": 1094537,
    "plain_text": "# Falcon OverWatch Contributes to BlackCat Protection\n\n**[crowdstrike.com/blog/falcon-overwatch-contributes-to-blackcat-protection/](https://www.crowdstrike.com/blog/falcon-overwatch-contributes-to-blackcat-protection/)**\n\nFalcon OverWatch Team March 23, 2022\n\nIn an effort to stay ahead of improvements in automated detections and preventions,\nadversary groups continually look to new tactics, techniques and procedures (TTPs), and\nnew tooling to progress their mission objectives. One group — known as BlackCat/ALPHV —\nhas taken the sophisticated approach of developing their tooling from the ground up, using\nnewer, more secure languages like Rust and highly customized configuration options per\nvictim.\n\nWhile these techniques and tools may be sophisticated, the CrowdStrike Falcon platform in®\ncombination with Falcon OverWatch™ proactive human-driven hunting proved effective in\nblocking and unraveling this novel threat. OverWatch gave the victim organization contextrich notifications about the emerging threat to their environment, providing essential\ninformation for this organization to secure themselves against a novel eCrime threat.\n[OverWatch is continually hunting to unearth evolving TTPs used by big game hunting (BGH)](https://www.crowdstrike.com/cybersecurity-101/cyber-big-game-hunting/)\nransomware adversaries and other highly impactful intrusions as highlighted in this recent\nunsuccessful ransomware attack.\n\n\n-----\n\nIn late 2021, CrowdStrike Intelligence first became aware of BlackCat/ALPHV advertising to\naffiliates on underground forums. The group advertised a newly developed Rust-based\n[ransomware-as-a-service (RaaS) offering, along with an enticing affiliate program that allows](https://www.crowdstrike.com/cybersecurity-101/ransomware/ransomware-as-a-service-raas/)\naffiliates to retain a relatively generous 80% to 90% compared to the more typical 30% to\n60%, depending on the RaaS and how successful it is.\n\nBy the end of January 2022, within weeks of launching, BlackCat/ALPHV had already gained\nnotoriety for its expertise and aggressive approach to extorting victims. Extortion techniques\nused by BlackCat/ALPHV and affiliates include naming victims on a dedicated leak site\n[(DLS), threatening to leak data on the DLS, encrypting data through ransomware, and finally](https://www.crowdstrike.com/cybersecurity-101/ransomware/)\n[implementing distributed denial of service (DDoS) attacks.](https://www.crowdstrike.com/cybersecurity-101/distributed-denial-of-service-ddos-attacks/)\n\n## Good for Victim When BlackCat Crosses OverWatch’s Path\n\nThis blog details an unsuccessful BlackCat ransomware attack on an organization in the\ntechnology sector. OverWatch worked as a seamless extension of the Falcon platform to\ntrace and track the adversary’s movements, providing critical context to the victim\norganization to facilitate comprehensive remediation.\n\nDespite the adversary’s use of the novel BlackCat tooling, the Falcon sensor effectively\nblocked the attack, both preventing the deletion of volume shadow copies and the execution\nof the ransomware tool itself. Just as adversaries continuously evolve their approaches, the\nCrowdStrike Falcon platform is continuously honed to detect and prevent emerging®\nmalicious activity. The Falcon platform takes a layered approach to detecting and preventing\nransomware by using behavior-based indicators of attack (IOAs) and advanced machine\nlearning (ML). Its detection capabilities are also informed by OverWatch’s front-line insights\ninto novel threats.\n\n\n-----\n\nFigure 1. Falcon sensor detects and blocks critical severity attempt to delete volume shadow copies (Click\n\nto enlarge)\n\nThe Falcon platform’s detection and automated prevention of malicious activity sparked a\nrapid retrospective hunt to understand the threat to the victim’s environment, which revealed\nthat the intrusion had stemmed from an unmanaged host. OverWatch is adept at finding\nadversary discovery activity or attempts to establish a persistent foothold in a victim’s\nenvironment. However, in this particular intrusion, the adversary gained initial access on a\nhost that did not have the Falcon sensor installed, meaning that there was no visibility of this\npre-ransomware activity for OverWatch. Despite this, OverWatch was still able to effectively\ntrack the adversary and provide the victim organization with a rapid context-rich notification\nabout the activity underway in its environment before serious damage was done.\n\nUpon investigation, OverWatch quickly uncovered the adversary’s use of “sender2” —\nidentified as a file exfiltration tool (also known as Exmatter) — that was executed remotely\nwith PsExec from an unmanaged host.\n\nThe sample sender2 executable crawls the computer for files with a list of file extensions and\nis configured to send them to a remote server via the SFTP or WebDAV protocols. In the\nactivity observed by OverWatch, the tool was set to evade detection in the following ways:\n\n\n-----\n\nIt executes using the parameter `-nownd, causing the tool s window to be hidden`\nduring execution.\nAt the completion of its execution, it launches a PowerShell command to forcibly stop\nthe sender2 process and delete the executable.\n\n**Self-deletion powershell.exe command:**\n```\npowershell.exe -WindowStyle Hidden -C $path = '\\\\[REDACTED]\\123\\sender.exe';GetProcess | Where-Object {$_.Path -like $path} | Stop-Process -Force;[byte[]]$arr =\nnew-object byte[] 830483531;Set-Content -Path $path -Value $arr;Remove-Item -Path\n$path;\n\n```\nFurther analysis of the tool also revealed that the sample had a build time of approximately\none hour before it was deployed, indicating that the adversary likely compiled the executable\nspecifically for this intrusion.\n\nFigure 2. OverWatch detects malicious file exfiltration tool “sender2,” executed under PsExecSvc.exe\n\n(Click to enlarge)\n\nAfter the attempted [data exfiltration, the adversary moved to deploy the BlackCat](https://www.crowdstrike.com/cybersecurity-101/data-exfiltration/)\nransomware. The ransomware executable file was masquerading under the name of a\nlegitimate third-party managed service security provider (MSSP). The ransomware was\nexecuted remotely under PsExec, from a network shared folder named `123 and was`\nlaunched as a child process of Microsoft’s File Explorer tool in another attempt to evade\ndetection.\n\nThe ransomware executable included a required command line argument `--access-`\n```\ntoken=[access_token] . This unique token is used to create the access key that is written\n\n```\ninto and appended to the `.onion link of the ransomware` `readme file. This provides a`\nunique link per victim to their negotiating Tor payment site.\n\n\n-----\n\nAnother distinctive characteristic of the BlackCat ransomware is its worming functionality with\nits ability to self-propagate within infected networks, observed in the following ways.\n\nThe ransomware:\n\nAcquires the system Address Resolution Protocol (ARP) table.\nScans the network over NetBIOS TCP port 137. This service provides a legacy name\nservice for name registration and resolution.\nSets the maximum number of suggested network connections for client requests that\ncan be maintained for each client of the server in the Windows registry.\nModifies symbolic link evaluation of the host with Fsutil to support the encryption of\nsymbolically linked files that redirect to a different file or directory, including connected\nnetwork shares.\n\nOverWatch also identified that the adversary had used the customer’s Microsoft Group Policy\nObject (GPO) settings to author scheduled tasks on Microsoft Windows domain joined hosts.\nThe scheduled tasks were registered for sender2 and the ransomware. However, the files\nwere not successfully executed using this method.\n\n**Scheduled Task for “sender2”:**\n```\nTaskAuthor: [REDACTED] \nTaskExecArguments: -nownd\nTaskExecCommand: \"cmd\" /c \\\\[REDACTED]\\\\123\\sender.exe\nTaskName: test2\n\n```\n**Scheduled Task for the Ransomware:**\n```\nTaskAuthor: [REDACTED] \nTaskExecArguments: --access-token \nTaskExecCommand: \"cmd\" /c \\\\[REDACTED]\\\\123\\[REDACTED].exe --access-token [REDACTED]\nTaskName: test123\n\n```\nWhile the attack stemmed from a host that did not have the Falcon sensor installed,\n[OverWatch was able to use the cloud telemetry emitted from endpoints that did have Falcon](https://www.crowdstrike.com/cybersecurity-101/endpoint-security/what-is-an-endpoint/)\nsensor coverage to uncover the scope of this intrusion. OverWatch used the available\ntelemetry to identify the source of the machine spreading the infection and was also able to\nidentify and quickly notify the victim about the attack, which included:\n\nWhen the activity began\nThe compromised user account used to conduct the malicious activity\nThe unmanaged host used in the attack vectors, including relevant network indicators\nThe ransomware strain and the configured file rename extension\nFiles, hashes and indicators on impacted hosts\nGuidance to prevent further activity and assist with the initial response\n\n\n-----\n\n## Human-Driven Threat Hunting Seamlessly Augments Automated Detection and Prevention\n\nThis intrusion is a clear illustration of how OverWatch’s human threat hunting augments\nautomated security controls to pinpoint and rapidly communicate malicious activities at the\nearliest possible stage.\n\nThe Falcon sensor played a crucial role in containing this attack. The Falcon sensor\nsuccessfully detected and blocked attempts to delete volume shadow copies and deploy\nransomware. These preventions gave the victim organization time to take the correct action\nstemming from OverWatch’s findings and evict the adversary from their network.\n\nOverWatch’s immediate investigation uncovered crucial details about the scope of the\nadversary’s activity, even when dealing with unmanaged endpoints. This information was\ncrucial to the victim organization, enabling their response efforts to eradicate the adversary\nfrom their environment.\n\nIt is essential for defenders to recognize that, although OverWatch was ultimately able to\ntrack this intrusion as it traversed the victim’s network, full visibility would have enabled much\nquicker identification of this activity and potentially could have prevented the adversary from\ngaining initial access. OverWatch strongly recommends that full endpoint protection —\nincluding next-generation antivirus (NGAV) and endpoint detection and response (EDR) — is\ndeployed across all endpoints to ensure complete visibility. While it is impossible to anticipate\nwhere an adversary will gain access, it is likely that they will look for blind spots in order to\noperate undetected within your environment.\n\n## TABLE 1. Ransomware Execution\n\n```\n\"cmd\" /c \\\\[REDACTED]\\\\123\\[REDACTED].exe --access-token <redacted>\n\n```\n\nNOTE: Ransomware binary execution under PSEXECSVC.exe\n```\n\"C:\\Windows\\system32\\cmd.exe\" /c \"wmic csproduct get UUID\"\n\n```\nNOTE: Acquire the System Management BIOS UUID, likely to gather information.\n```\n\"C:\\Windows\\system32\\cmd.exe\" /c \"fsutil behavior set SymlinkEvaluation\nR2L:1\"\n\n```\nNOTE: Enable remote-to-local symlink evaluation\n```\n\"C:\\Windows\\system32\\cmd.exe\" /c \"fsutil behavior set SymlinkEvaluation\nR2R:1\"\n\n```\nNOTE: Enable remote-to-remote symlink evaluation\n```\n\"C:\\Windows\\system32\\cmd.exe\" /c \"iisreset.exe /stop\"\n\n```\nNOTE: Stop all IIS-related processes\n\n\n-----\n\n```\n \"C:\\Windows\\system32\\cmd.exe\" /c \"reg add\n HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\n /v MaxMpxCt /d 65535 /t REG_DWORD /f\"\n\n```\nNOTE: Set the maximum suggested outstanding network connections\n```\n \"C:\\Windows\\explorer.exe\" --child --access-token [REDACTED]\n\n```\nNOTE: Run the ransomware executable as a child process\n```\n \"C:\\Windows\\system32\\cmd.exe\" /c \"arp -a\"\n\n```\nNOTE: Acquire system ARP table\n```\n \"C:\\Windows\\system32\\cmd.exe\" /c \"vssadmin.exe Delete Shadows /all /quiet\"\n\n```\nNOTE: Delete file shadow copies\n\n## TABLE 2. sender2 File Exfiltrator Execution\n\nThe file exfiltrator tool, sender2, will crawl the computer for files with the following\nextensions:\n```\n .doc, .docx, .xls, .xlsx, .xlsm, .pdf, .msg, .ppt, .pptx, .sda, .sdm,\n .sdw, .csv, .zip, .json, .config, .ts, .cs, .sqlite, .aspx, .pst, .rdp,\n .accdb, .catpart, .catproduct, .catdrawing, .3ds, .dwt, .dxf\n\n```\nIt also has a few exceptions configured; it will not crawl any of the following directories:\n```\n C:\\Documents and Settings\n C:\\PerfLogs\n C:\\Program Files\\Windows Defender Advanced Threat Protection\n C:\\Program Files\\WindowsApps\n C:\\ProgramData\\Application Data\n C:\\ProgramData\\Desktop\n C:\\ProgramData\\Documents\n C:\\ProgramData\\Microsoft\n C:\\ProgramData\\Packages\n C:\\ProgramData\\Start Menu\n C:\\ProgramData\\Templates\n C:\\ProgramData\\WindowsHolographicDevices\n C:\\Recovery\n C:\\System Volume Information\n C:\\Users\\All Users\n C:\\Users\\Default\n C:\\Users\\Public\\Documents\n C:\\Windows\n\n```\nSystem Volume Information\n\nAnd it will also skip every path that contains one of the following strings:\n\n\n-----\n\n```\n OneDriveMedTile\n locale SmallLogo\n VisualElements\n adobe_sign\n Adobe Sign\n core_icons\n\n```\n**Additional Resources**\n\n_Read the_ _[2021 Threat Hunting Report blog or download the report now.](https://www.crowdstrike.com/blog/2021-threat-hunting-report-preview/)_\n_[Learn more about Falcon OverWatch’s proactive managed threat hunting.](https://www.crowdstrike.com/endpoint-security-products/falcon-overwatch-threat-hunting/)_\n_Discover the power of tailored threat hunting OverWatch Elite provides customers in_\n_this blog post._\n_[Watch how Falcon OverWatch proactively hunts for threats in your environment.](https://www.crowdstrike.com/resources/videos/falcon-overwatch-proactively-hunts-threats-environment/)_\n_[Read more about how part-time threat hunting is simply not enough in this blog post.](https://www.crowdstrike.com/blog/the-myth-of-part-time-threat-hunting-part-1/)_\n_[Learn more about the CrowdStrike Falcon®](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)_ _platform._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-23 - Falcon OverWatch Threat Hunting Contributes to Seamless Protection Against Novel BlackCat Attack.pdf"
    ],
    "report_names": [
        "2022-03-23 - Falcon OverWatch Threat Hunting Contributes to Seamless Protection Against Novel BlackCat Attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535964,
    "ts_updated_at": 1743041726,
    "ts_creation_date": 1653780229,
    "ts_modification_date": 1653780229,
    "files": {
        "pdf": "https://archive.orkl.eu/c559e8d23a4ebecb9f3376d6ff3eebe04cb2d3de.pdf",
        "text": "https://archive.orkl.eu/c559e8d23a4ebecb9f3376d6ff3eebe04cb2d3de.txt",
        "img": "https://archive.orkl.eu/c559e8d23a4ebecb9f3376d6ff3eebe04cb2d3de.jpg"
    }
}