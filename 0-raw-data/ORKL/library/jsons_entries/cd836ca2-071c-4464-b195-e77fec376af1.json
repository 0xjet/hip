{
    "id": "cd836ca2-071c-4464-b195-e77fec376af1",
    "created_at": "2023-01-12T15:08:57.036813Z",
    "updated_at": "2025-03-27T02:12:11.109736Z",
    "deleted_at": null,
    "sha1_hash": "41ac97aeb54a64aecac10419e81a9f41c6bc9da5",
    "title": "2021-02-17 - Threat Alert- TeamTNT Pwn Campaign Against Docker and K8s Environments",
    "authors": "",
    "file_creation_date": "2022-05-28T16:12:46Z",
    "file_modification_date": "2022-05-28T16:12:46Z",
    "file_size": 1826479,
    "plain_text": "# Threat Alert: TeamTNT Pwn Campaign Against Docker and K8s Environments\n\n**[blog.aquasec.com/teamtnt-campaign-against-docker-kubernetes-environment](https://blog.aquasec.com/teamtnt-campaign-against-docker-kubernetes-environment)**\n\nAssaf Morag\n\nAssaf Morag\n\nFebruary 17, 2021\n\n\n-----\n\nLast week, TeamTNT launched a new campaign against Docker and Kubernetes\nenvironments. Using a collection of container images that are hosted in Docker Hub, the\nattackers are targeting misconfigured docker daemons, Kubeflow dashboards, and Weave\nScope, exploiting these environments in order to steal cloud credentials, open backdoors,\nmine cryptocurrency, and launch a worm that is looking for the next victim. In this blog, I will\nexplore these container images and what they were designed to do.\n\nThe Docker Hub account ‘heavy0x0james’ was created on June 3rd, 2019. In February\n2021, the adversaries uploaded six malicious container images that have been observed to\nperform attacks in the wild. All six container images initially run a shell file named init.sh, but\nin each image it does something different. Then the attackers leverage a binary named zgrab\n(MD5= 7691c55732fded10fca0d6ccc64e41dc) in order to scan the internet for more victims.\n\nBelow is the list of these malicious container images and their capabilities:\n\n**Container images** **Capabilities**\n\n**Wescopwn** Run a cryptominer\nExecute a worm\nScan ports 80, 443, 8080, 8888\nLook for vulnerable weave scope applications\nExecute Tsunami malware\n\n**Tornadopwn** Execute a worm\nScan AWS IP ranges\nScan ports 80, 443, 8080, 8888\nLook for vulnerable Kubeflow and Jupyter notebooks\n\n**Jaganod** Execute a trojan (/usr/local/lib/dockerd.so)\nExecute a worm\nScan ports 80, 2375, 2376, 4243, 4040, 8888\nLook for vulnerable Docker daemons, vulnerable weave scope\napplications and vulnerable Kubeflow and Jupyter notebooks\n\n**Awspwner** Execute a worm\nScan AWS IP ranges\nScan ports 2375, 2376, 2377, 4244, 4243\nExecute AWS keys grabber\n\n**Tornadorangepwn** Execute a worm\nScan ports 80, 443, 8080, 8888\nExecute AWS keys grabber\n\n\n-----\n\n## Conclusion\n\nOver the last few years, we at [Team Nautilus have detected many kinds of attacks against](https://www.aquasec.com/research/)\nDocker and Kubernetes environments, but this is the first time that we see a campaign\ndesigned to massively and systematically scan the internet, search for specific\nmisconfigurations or outdated software, and attack the potential victims. Some of these\nimages deploy a cryptominer, some open backdoors, and others are looking to steal AWS\nkeys. These findings should alert security practitioners that even the smallest\nmisconfiguration even for a fraction of time matters as it can result in a cyberattack.\n\nWhen working with Docker and\n\n1. Regularly update your cloud software, specifically Docker and Kubernetes\n\n**projects. Previous versions typically have more known vulnerabilities.**\n2. If possible, avoid exposing unnecessary APIs to the internet. Additionally, try\n\nlimiting APIs inbound and outbound traffic to your organization’s network range.\n3. Review authorization and authentication policies, basic security policies, and\n\nadjust them according to the principle of least privilege.\n4. Regularly monitor the runtime environment. This includes monitoring the running\n\ncontainers, their images, and the processes that they run. Investigate logs, mostly\naround user actions, look for actions you can’t account for regular anomalies or\noutliers.\n[5. Implement a security strategy where you can easily enforce runtime policies, as well as](https://blog.aquasec.com/cloud-native-security-drift-prevention)\n\n[consider using cloud security tools that will widen your scope and reach within your](https://www.aquasec.com/products/aqua-cloud-native-security-platform/)\ncloud resources.\n\n\n-----\n\n**_Indication of Compromise (IOCs)_**\n\n**heavy0x0james/dockgeddon:latest**\n\nroot/dockerd (MD5= 091efbe14d22ecb8a39dd1da593f03f4)\nroot/TNTfeatB0RG (MD5= 624e902dd14a9064d6126378f1e8fc73)\nC2= 45[.]9[.]148[.]85\n\n**heavy0x0james/wescopwn:latest**\n\nroot/dockerd (MD5= 091efbe14d22ecb8a39dd1da593f03f4)\nroot/TNTfeatB0RG (MD5= 624e902dd14a9064d6126378f1e8fc73)\nC2= 45[.]9[.]148[.]85, borg[.]wtf\n\n**heavy0x0james/tornadopwn:latest**\n\nC2= 45[.]9[.]148[.]85\n\n**heavy0x0james/jaganod:latest**\n\nusr/local/lib/dockerd.so (MD5= e8b1dc73a3299325f5c9a8aed41ba352)\nroot/dockerd (MD5= 091efbe14d22ecb8a39dd1da593f03f4)\nC2= 45[.]9[.]148[.]85\n\n**heavy0x0james/awspwner:latest**\n\naws.sh\nC2= borg[.]wtf\n\n**heavy0x0james/tornadorangepwn:latest**\n\naws.sh\nC2= borg[.]wtf\n\n\n-----\n\n**Assaf Morag**\n\nAssaf is a Lead Data Analyst at Aqua. As part of Team Nautilus, Aqua's research team, he\nfocuses on supporting the data needs of the team, obtaining threat intelligence and helping\nAqua and the industry stay on the forefront of new threats and methodologies for protection.\nHis work has been published in leading info security publications and journals across the\nglobe, and most recently he contributed to the new MITRE ATT&CK Container Framework.\n\n[Security Threats,](https://blog.aquasec.com/topic/security-threats) [Dynamic Container Analysis](https://blog.aquasec.com/topic/dynamic-container-analysis)\n\n[Tweet](https://twitter.com/share)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-17 - Threat Alert- TeamTNT Pwn Campaign Against Docker and K8s Environments.pdf"
    ],
    "report_names": [
        "2021-02-17 - Threat Alert- TeamTNT Pwn Campaign Against Docker and K8s Environments.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536137,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1653754366,
    "ts_modification_date": 1653754366,
    "files": {
        "pdf": "https://archive.orkl.eu/41ac97aeb54a64aecac10419e81a9f41c6bc9da5.pdf",
        "text": "https://archive.orkl.eu/41ac97aeb54a64aecac10419e81a9f41c6bc9da5.txt",
        "img": "https://archive.orkl.eu/41ac97aeb54a64aecac10419e81a9f41c6bc9da5.jpg"
    }
}