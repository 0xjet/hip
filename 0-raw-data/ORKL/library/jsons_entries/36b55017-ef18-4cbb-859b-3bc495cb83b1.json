{
    "id": "36b55017-ef18-4cbb-859b-3bc495cb83b1",
    "created_at": "2023-01-12T15:02:19.304392Z",
    "updated_at": "2025-03-27T02:05:24.434951Z",
    "deleted_at": null,
    "sha1_hash": "0ea395d6a988972350ae8a516a819e04457c8cd1",
    "title": "2022-07-28 - IPFS- The New Hotbed of Phishing",
    "authors": "",
    "file_creation_date": "2022-09-01T10:07:06Z",
    "file_modification_date": "2022-09-01T10:07:06Z",
    "file_size": 2682476,
    "plain_text": "# IPFS: The New Hotbed of Phishing\n\n**[trustwave.com/en-us/resources/blogs/spiderlabs-blog/ipfs-the-new-hotbed-of-phishing](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/ipfs-the-new-hotbed-of-phishing)**\n\n[A few months ago, we reported on an interesting site called the Chameleon Phishing Page.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/the-attack-of-the-chameleon-phishing-page/)\nThese websites have the capability to change their background and logo depending on the\nuser’s domain. The phishing site is stored in IPFS (InterPlanetary File System) and after\nreviewing the URLs used by the attacker, we noticed an increasing number of phishing emails\ncontaining IPFS URLs as their payload.\n\nWe have observed more than 3,000 emails containing phishing URLs that have utilized IPFS for\nthe past 90 days and it is evident that IPFS is increasingly becoming a popular platform for\nphishing websites.\n\n## What’s with IPFS and why do attackers use it?\n\nIPFS was created in 2015 and is a distributed, peer-to-peer file-sharing system for storing and\naccessing files, websites, applications, and data. Contents are available through peers located\nworldwide, who might be transferring information, storing it, or doing both. IPFS can locate a file\nusing its content address rather than its location. To be able to access a piece of content, users\nneed a gateway hostname and the content identifier (CID) of the file.\n\n**https://<Gateway>/ipfs/<CID Hash>**\n\nCurrently, most data is transferred across the internet using Hypertext Transfer Protocol (HTTP)\nwhich employs a centralized client-server approach. IPFS, on the other hand, is a project that\naims to create a completely decentralized web that works through a P2P network.\n\n\n-----\n\nWith the IPFS configuration, shared files are distributed to other machines acting as nodes\nthroughout the networked file system; hence it can be accessed whenever needed. The file is\nretrieved from any participating node on the network that has the requested content.\n\nIn a centralized network, data is not accessible if the server is down or if a link gets broken.\nWhereas with IPFS, data is persistent. Naturally, this extends to the malicious content stored in\nthe network. Taking down phishing content stored on IPFS can be difficult because even if it is\nremoved in one node, it may still be available on other nodes.\n\nAnother thing to consider is the difficulty of discovering malicious traffic in a legitimate P2P\nnetwork. With data persistence, robust network, and little regulation, IPFS is perhaps an ideal\nplatform for attackers to host and share malicious content.\n\n## How do we identify IPFS URLs?\n\nAs mentioned earlier, a CID is a label that is used to point to content in an IPFS network. Instead\nof location-based addressing, data is requested using the hash of that content. IPFS uses sha256 hashing algorithm by default.\n\nThe CID version 0 of IPFS was first designed to use base 58-encoded multihashes as the\ncontent identifiers. Version 0 starts with “Qm” and has a length of 46 characters.\n\nHowever, in the latest CID v1 it contains some leading identifiers that clarify exactly which\nrepresentation is used, along with the content-hash itself. It includes a decoding algorithm links to\nexisting software implementations for decoding CIDs.\n\nThe subdomain gateways convert paths with custom bases like base16 to base32 or base36, in\nan effort to fit a CID in a DNS label:\n\nSample URL:\n\ndweb[.]link/ipfs/f01701220c3c4733ec8affd06cf9e9ff50ffc6bcd2ec85a6170004bb709669c31de9\n4391a\n\nreturns a HTTP 301 redirect:\n\nbafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi[.]ipfs[.]dweb[.]link\n\nIPFS links usually have a common format of:\n\nhttps://ipfs[.]io/ipfs/{46 random character string}?(filename|key)={random character string}\n\n\n-----\n\nhttps://ipfs[.]io/ipfs/{46 random character string}?filename={file name}\\.html &emailtoken=\n_{email address}_\nhttps://ipfs[.]io/ipfs/{46 random character string}#{user email address}\n\n**Different Avenues of IPFS Phishing**\n\nMultiple services are available for storing files in an IPFS network. Cyber attackers have taken\nadvantage of these services and they are now being used in phishing campaigns. Here are some\nof the IPFS phishing websites that we have observed and their URL behavior.\n\n## Blockchain Services - infura[.]io\n\nCommon URL format:\n\nhxxp://{59 character string}.ipfs.infura-ipfs.io/?filename={file name}.html/\n\n_Figure 2. Infura IPFS service that was used in phishing activity_\n\n## Common phishing behavior:\n\n1. Upon clicking the continue button on the phishing URL, it will try to access the ‘favicon.png’\n\nfile that contains an IPFS directory.\n\n\n-----\n\n_Figure 2.1 Screenshot of png file that contain IPFS path_\n\n1. The phishing page source-code contains the details that will be stolen to the victim.\n\n_Figure 2.2 Infura IPFS phishing URL’s source-code_\n\n## Google Services - googleweblight[.]com\n\nCommon URL format:\n\nhttp://googleweblight[.]com/i?u={IPFS URL redirection}\n\nCommon phishing behavior:\n\n1. Upon accessing the Googleweblight with IPFS URL, there will be an automatic multiple\n\nURL redirection.\n\n_Sample phishing redirection chain:_\n\n\n-----\n\nb.The initial URL’s source-code usually contains some obfuscated code\n\n_Figure 3. The source-code of GoogleWeblight URL with IPFS path_\n\n## Abused Cloud Storage Services\n\n1. Filebase[.]io\n\nCommon URL format:\n\nhxxps://ipfs[.]filebase.io/ipfs/{59 random character string}\n\n\n-----\n\n_Figure 4. Sample screenshot of DHL phishing URL that uses Filebase-IPFS service_\n\nCommon phishing behavior:\n\n1. Upon accessing the URL, the phishing activity happens on the same page and no URL\n\nredirection\n2. The source-code of the phishing URL contains a form tag that uses another phishing URL\n\nto store the stolen credentials\n\n_Figure 4.1 Sample screenshot of the source-code containing another phishing URL_\n\n1. Nftstorage[.]link\n\nCommon URL formats:\n\nhxxps://nftstorage[.]link/ipfs/{59 random character string}/#{target email address}\n\nhxxps://{59 random character string}.ipfs.nftstorage[.]link/#{target email address}\n\n\n-----\n\n_Figure 5. Sample screenshot of phishing URL using Nftstorage-IPFS_\n\nCommon phishing behavior:\n\n1. The source-code of the phishing URL often uses ‘Unescape’ encoding in source-code\n2. Then, the decoded source-code contains common phishing code injection template\n\n_Figure 5.1 Sample screenshot of the source-code with encoded unescape format_\n\n## Phishing emails using abused web hosting site\n\nOur last example below shows a fake notification containing a billing receipt.\n\n\n-----\n\n_Figure 6. Phishing email_\n\nThe message states that a payment for an Azure subscription is already processed and a billing\nreceipt is attached for reference. The sender claims to be the “Mail Administrator “and the\ndomain is not owned by Microsoft. Other noticeable details are the missing domain in its\nMessage-ID and the unusual sentence formatting in the subject line.\n\n_Figure 6.1 Spoofed Email Header_\n\nThe malicious HTML attachment contains a JavaScript code which launches the phishing page.\nThe setTimeout() function was used to open the phishing URL with 0 delay in a new browser tab.\nInside this function is a location.href property which sets the URL of the current page.\n\n_Figure 7. Code snippet from HTML Attachment_\n\n\n-----\n\nThe attachment leads to a fake Microsoft website which states that the user needs to pay their\nAzure statement.\n\n_Figure 8. Phishing site abusing Fleek-IPFS service_\n\nPressing the “Contact your billing administrators” button will lead to the final website payload\nwherein users are required to log in with their Microsoft credentials to continue.\n\n\n-----\n\n_Figure 8.1 Fake Microsoft log-in page_\n\nThis website’s source code is in percent encoding.\n\n_Figure 8.2 Obfuscated source code_\n\nUsing the unescape function reveals the decoded format of the website.\n\n_Figure 8.3 Snippet of decoded source-code with signature of the spammer_\n\n\n-----\n\nWe can also see from the decoded script that the spammers are abusing the domain surge[.]sh\nfor their phishing image resource. Surge is a static website host which users can interact with\nfrom their command line.\n\n_Figure 8.4 Image Source for the Phishing Site_\n\nUpon further analysis, we also found the main phishing template used by the spammer hosted in\nthe URL ‘o365spammerstestlink[.]surge[.]sh’:\n\n_Figure 8.5 Template used by the spammers for phishing_\n\nFinally, the stolen credentials are posted once the submit button event is triggered.\n\n\n-----\n\n_Figure 8.6 Code snippet for POST method_\n\nAt the beginning of the decoded script, we can see a signature “code by t[.]me/o635spams”. This\nlink leads to a Telegram group called O365 Spam Tools. Telegram is an encrypted online\nmessaging app that works across multiple devices. The spammers’ group has 236 members at\nthe time of writing, and they claim to spam Office 365.\n\n_Figure 9. Telegram group for spammers_\n\n## IOCs\n\nhxxps://ipfs[.]fleek[.]co/ipfs/bafybeiddmwwk3rvvu5zlweszoyvo54v3corf2eu4fmhxwprhxitj2jdrmi\n\nhxxps://ipfs[.]fleek[.]co/ipfs/bafybeic63bwxphx3sasgvpb2fvy766aiymvy2pzoz3htx7zomysw67jucu\n\nhxxps://jobswiper[.]net/web_data_donot_delete/store/w3lllink[.]php\n\nhxxps://jobswiper[.]net/web_data_donot_delete/\n\n\n-----\n\nhxxps://o365spammerstestlink[.]surge[.]sh/\n\n## Conclusion\n\nPhishing techniques have taken a leap by utilizing the concept of decentralized cloud services\nusing IPFS.\n\nOne of the main reasons why IPFS has become a new playground for phishing is that many web\nhosting, file storage or cloud services are now offering IPFS services. This means that there’s\nmore flexibility for the phishers in creating new types of phishing URLs. In addition, the\nspammers can easily camouflage their activities by hosting their content in a legitimate web\nhosting services or use multiple URL redirection techniques to help thwart scanners using URL\nreputation or automated URL analysis.\n\nKeeping up to date with the latest technology and cyber threats is beneficial in preventing users\nfrom being victimized by web threats such as phishing. As always, we remind everyone to stay\nvigilant in this ever-changing digital landscape.\n\n## Reference:\n\nhttps://docs.ipfs.io/concepts/content-addressing/\n\nhttps://developers.cloudflare.com/web3/ipfs-gateway/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-28 - IPFS- The New Hotbed of Phishing.pdf"
    ],
    "report_names": [
        "2022-07-28 - IPFS- The New Hotbed of Phishing.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535739,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1662026826,
    "ts_modification_date": 1662026826,
    "files": {
        "pdf": "https://archive.orkl.eu/0ea395d6a988972350ae8a516a819e04457c8cd1.pdf",
        "text": "https://archive.orkl.eu/0ea395d6a988972350ae8a516a819e04457c8cd1.txt",
        "img": "https://archive.orkl.eu/0ea395d6a988972350ae8a516a819e04457c8cd1.jpg"
    }
}