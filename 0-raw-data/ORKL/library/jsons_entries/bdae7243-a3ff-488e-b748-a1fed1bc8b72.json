{
    "id": "bdae7243-a3ff-488e-b748-a1fed1bc8b72",
    "created_at": "2022-10-25T16:48:24.75044Z",
    "updated_at": "2025-03-27T02:15:18.8348Z",
    "deleted_at": null,
    "sha1_hash": "4bae883feddc4e8b1c2593c848b7f434b125b6e4",
    "title": "Intro",
    "authors": "",
    "file_creation_date": "2017-08-17T12:10:41Z",
    "file_modification_date": "2017-08-17T12:10:41Z",
    "file_size": 3138196,
    "plain_text": "```\n    APT3 Uncovered:\nThe code evolution of Pirpi\nYour functions are showing (and leaving a trail)\n        Micah Yates - @m1k4chu\n         Palo Alto Networks\n\n```\n\n-----\n\n```\n Your functions are showing\n\n###### •\n Persistent Code Reuse\n\n •\n Finding The Trail\n\n •\n Pirpi.201x vs Operation Clandestine\n DoubleTap\n\n •\n Just give me all the Pirpi you have\n\n •\n EXEProxy\n\n```\n\n-----\n\n```\nPersistent Code Reuse:\nfunction_1\n\n```\n\n-----\n\n```\nPersistent Code Reuse\n\n###### • What is Pirpi?\n\n • Targeted malware delivered via 0-days\n\n • (CVE-2010-3962)\n • (CVE-2014-1776)\n • (CVE-2014-4113)\n • (CVE-2014-6332)\n • (CVE-2015-3113)\n • (CVE-2015-5119)\n\n • Appended to a valid gif\n • Obfuscated Command and Control\n • Compromised infrastructure\n\n```\n\n-----\n\n```\nFinding a Trail\n\n###### •\n  Why are you doing this?\n\n •\n   It’s fun\n\n •\n   You don’t know what you don’t know\n\n •\n  Pick 2 binaries by:\n\n •\n   Family\n\n •\n   Compile Times\n\n •\n   File Size\n\n •\n   % similarity (ssdeep)\n\n```\n\n-----\n\n```\nIt started out with a diff, how\ndid it end up like this?\n\n###### •\n  Inspect Binaries w/ IDA Tools\n\n •\n   Bindiff – Hex Rays\n\n •\n   IDAScope – Plohmann/Hanel\n\n •\n  Bindiff two known Pirpi samples\n\n •\n   fb838cda6118a003b97ff3eb2edb7309\n\n •\n   e33804e3e15920021c5174982dd69890\n\n```\n\n-----\n\n```\nIt was only a diff\n\n```\n\n-----\n\n```\nIt was only a diff\n\n```\n\n-----\n\n```\nAside:\nPutting the FUN in Function\n\n```\n\n-----\n\n```\nPirpi.201x vs Operation\nClandestine DoubleTap\n\n```\n\n-----\n\n```\nPirpi.201x vs Operation\nClandestine DoubleTap\n\n```\n\n-----\n\n```\nJust give me all the Pirpi you have:\nfunction_1\n                   Compile MD5 Beacon\n                   2007 01 3f5d79b262472a12e3666118a7cdc2ca www.msnmessengerupdate.com/index31382/f2ae95b93i97.bmp\n                   2008 01 6bdee405ed857320aa8c822ee5e559f2 www.msnmessengerupdate.com/image19582/7e7e7eb7fi7f.gif\n                   2009 03 e22d02796cfb908aaf48e2e058a0890a www.office2008updates.com/dream/dream.php?\n                   2009 10 1fa0813be4b9f23613204c94e74efc9d ini.msnmessengerupdate.net/smart/smartmain.php?\n                   2010 01 914e9c4c54fa210ad6d7ed4f47ec285f ini.office2005updates.net/smart/smartmain.php?\n                   2013 01 44bd652a09a991100d246d8280cac3ac 218.42.147.106/bussinesses/caetrwet/\n                   2014 04 b48e578f030a7b5bb93a3e9d6d1e2a83 product.sorgerealty.com\n                   2016 04 f683cf9c2a2fdc27abff4897746342c4 ste.mullanclan.com\n\n```\n|Compile|MD5|Beacon|\n|---|---|---|\n|2007 01|3f5d79b262472a12e3666118a7cdc2ca|www.msnmessengerupdate.com/index31382/f2ae95b93i97.bmp|\n|2008 01|6bdee405ed857320aa8c822ee5e559f2|www.msnmessengerupdate.com/image19582/7e7e7eb7fi7f.gif|\n|2009 03|e22d02796cfb908aaf48e2e058a0890a|www.office2008updates.com/dream/dream.php?|\n|2009 10|1fa0813be4b9f23613204c94e74efc9d|ini.msnmessengerupdate.net/smart/smartmain.php?|\n|2010 01|914e9c4c54fa210ad6d7ed4f47ec285f|ini.office2005updates.net/smart/smartmain.php?|\n|2013 01|44bd652a09a991100d246d8280cac3ac|218.42.147.106/bussinesses/caetrwet/|\n|2014 04|b48e578f030a7b5bb93a3e9d6d1e2a83|product.sorgerealty.com|\n|2016 04|f683cf9c2a2fdc27abff4897746342c4|ste.mullanclan.com|\n\n```\n                         Compile MD5\n                         2007 01\n                         2008 01\n                         2009 03\n                         2009 10\n                         2013 01\n                         2014 04\n                         2016 04\n\n```\n\n-----\n\n```\nJust give me all the Pirpi you have:\nfunction_1\n\n```\n\n100\n\n90\n\n80\n\n70\n\n60\n\n50\n\n40\n\n30\n\n20\n\n10\n\n0\n\n**COMPILE YEAR AND MONTH**\n\n\n-----\n\n-----\n\n```\nfunction_1 - minor versions\n\n```\n\n100\n\n90\n\n80\n\n70\n\n60\n\nv6\n\n50 v5\n\nv4\n\n40 v3\n\nv2\n\n30 v1\n\n20\n\n10\n\n0\n\n**COMPILE YEAR AND MONTH**\n\n\n-----\n\n```\nfunction_1 - minor versionsfunction_1 - minor versions\n\n```\n\n###### V1 - 2007\n\n MD5:\n\n 98011f5b7b957a142f14cbda57a5ea82\n\n\n###### V2 - 2008\n\n MD5:\n\n 272cb6c16e083ca143d40c63005753a2\n\n\n###### V3 – 2006\n\n MD5:\n\n acd8d34d8360129df1c8d03f253ba747\n\n\n-----\n\n```\nfunction_1 - minor versions\n\n```\n\n###### V5 - 2016\n\n MD5:\n\n\n###### V6 - 2017\n\n\n###### c006faaf9ad26a0bd3bbd597947da3e1\n\n\n###### V4 - 2014\n\n MD5:\n\n\n###### f683cf9c2a2fdc27abff4897746342c4\n\n\n###### 07b4d539a6333d7896493bafd2738321\n\n\n-----\n\n```\nfunction_2\n\n```\n\n-----\n\n```\nfunction_2\n\n```\n\n###### pirpi_version_check\n\n100\n\n90\n\n80\n\n70\n\n60\n\n50\n\n40\n\n30\n\n20\n\n10\n\n0\n\n**COMPILE YEAR AND MONTH**\n\n\n-----\n\n```\nfunction_3\n\n```\n\n-----\n\n```\nfunction_3\n\n```\n\n###### pirpi_cmdline_createproc\n\n45\n\n40\n\n35\n\n30\n\n25\n\n20\n\n15\n\n10\n\n5\n\n0\n\n**COMPILE YEAR AND MONTH**\n\n\n-----\n\n```\nEXEProxy\n\n###### • b94bcffcacc65d05e5f508c5bd9c\n 950c\n\n • Contains function_1\n • Contains Anti-Disasm\n • OpenSSL included\n • Requires cmd line params to\n run\n\n```\n\n-----\n\n```\nEXEProxy:\npirpi_EXEPROXY\n\n```\n\n###### pirpi_EXEPROXY\n\n9\n\n8\n\n7\n\n6\n\n5\n\n4\n\n3\n\n2\n\n1\n\n0\n\n**COMPILE YEAR AND MONTH**\n\n\n-----\n\n```\nEXEProxy 2: Electric Boogaloo\n\n###### • 4d3874480110ba537b383\n\n```\n```\n 9cb8b416b50\n\n###### • Contains function_1\n • Server tool\n • Requires Cmd Line\n Params\n\n • No other notable\n anchor functions\n\n```\n```\n\">Ltime %2d:%2d:%2d Disconnect >“\n\"%2d:%2d:%2d >Cback:“\n\">LTime: %2d:%2d:%2d“\n\">Cback: %s:%d\"\n\"H:%s \"\n\"Ok. \"\n\"K:%d\"\n\n```\n\n-----\n\n```\nEXEProxy 2: Electric Boogaloo\n\n###### • a85f9b4c33061ee724e59291242b9e86\n • OpenSSL Server\n • Contains Public/Private Keys\n\n```\n\n-----\n\n```\nIn Summary:\n\n###### • Some families never change\n • Anchor Functions are Fun!\n • Use public info\n • Pirpi malware active since at least 2006\n • Unintended findings\n\n```\n\n-----\n\n###### • Thanks:\n\n • Richard Wartell – Palo Alto Networks\n • Mike Scott – Palo Alto Networks\n\n • Biblio:\n\n • MITRE:\n\n • https://attack.mitre.org/wiki/Software/S0063\n • FireEye:\n\n • https://www.fireeye.com/blog/threat-research/2010/11/ie-0-day-hupigon-joins-the-party.html\n • https://www.fireeye.com/blog/threat-research/2014/06/clandestine-fox-part-deux.html\n • https://www.fireeye.com/blog/threat-research/2014/11/operation_doubletap.html\n • https://www.fireeye.com/blog/threat-research/2015/06/operation-clandestine-wolf-adobe-flash-zero-day.html\n • Symantec:\n\n • https://www.symantec.com/connect/blogs/new-ie-zero-day-used-targeted-attacks\n • https://www.symantec.com/connect/blogs/buckeye-cyberespionage-group-shifts-gaze-us-hong-kong\n • http://www.symantec.com/content/en/us/enterprise/media/security_response/docs/Symantec-Buckeye-IOCs.txt\n • EmergingThreats:\n\n • https://rules.emergingthreats.net/changelogs/suricata-1.3.etpro.2015-09-10T21:29:38.txt\n • (cached by other sites, search for hash 4d3874480110ba537b3839cb8b416b50 and EXEProxy)\n • Palo Alto Networks:\n\n • https://researchcenter.paloaltonetworks.com/2015/07/apt-group-ups-targets-us-government-with-hacking-team```\n        flash-exploit/\n • https://researchcenter.paloaltonetworks.com/2015/07/ups-observations-on-cve-2015-3113-prior-zero-days-and        the-pirpi-payload/\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://recon.cx/2017/montreal/resources/slides/RECON-MTL-2017-evolution_of_pirpi.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.06.18.APT3_Uncovered_The_code_evolution_of_Pirpi/RECON-MTL-2017-evolution_of_pirpi.pdf"
    ],
    "report_names": [
        "RECON-MTL-2017-evolution_of_pirpi.pdf",
        "RECON-MTL-2017-evolution_of_pirpi"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "61c4ddc4-156b-4828-8570-0979da81f3d0",
            "created_at": "2022-10-25T16:47:55.593828Z",
            "updated_at": "2025-03-27T02:05:17.275161Z",
            "deleted_at": null,
            "main_name": "BRONZE MAYFAIR",
            "aliases": [
                "Gothic Panda ",
                "TG-0110 ",
                "APT3 "
            ],
            "source_name": "Secureworks:BRONZE MAYFAIR",
            "tools": [
                " HUC Proxy Malware (Htran)",
                " Pirpi",
                " SplitVPN",
                " ctt",
                " ctx",
                "Cookiecutter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1502971841,
    "ts_modification_date": 1502971841,
    "files": {
        "pdf": "https://archive.orkl.eu/4bae883feddc4e8b1c2593c848b7f434b125b6e4.pdf",
        "text": "https://archive.orkl.eu/4bae883feddc4e8b1c2593c848b7f434b125b6e4.txt",
        "img": "https://archive.orkl.eu/4bae883feddc4e8b1c2593c848b7f434b125b6e4.jpg"
    }
}