{
    "id": "a0bd7588-1ecf-4851-8e4f-d7afd721a59b",
    "created_at": "2023-01-12T15:00:00.694604Z",
    "updated_at": "2025-03-27T02:16:59.291535Z",
    "deleted_at": null,
    "sha1_hash": "16af81db93aaafc29869a6f36c09dd49270a3ba2",
    "title": "2018-12-20 - With Mirai Comes Miori- IoT Botnet Delivered via ThinkPHP Remote Code Execution Exploit",
    "authors": "",
    "file_creation_date": "2022-05-28T02:51:27Z",
    "file_modification_date": "2022-05-28T02:51:27Z",
    "file_size": 182482,
    "plain_text": "# Miori IoT Botnet Delivered via ThinkPH Exploit\n\n**blog.trendmicro.com/trendlabs-security-intelligence/with-mirai-comes-miori-iot-botnet-delivered-via-thinkphp-remote-code-execution-**\nexploit/\n\nDecember 20, 2018\n\nMalware\n\nWe analyzed another Mirai variant called “Miori,” which is being spread through a Remote Code Execution\n(RCE) vulnerability in the PHP framework, ThinkPHP.\n\nBy: Augusto Remillano II, Mark Vicente December 20, 2018 Read time: ( words)\n\nContent added to Folio\n\n**SHA-256**\n\nee9c7a5b9f7059bdd0649eaaa0adb762683c79fbda91746048332813b44fa1e2 Backdoor.Linux.MIRAI.AR\n\n0d3a8933735a8d19c234db8a5ba1a0c2de390ae59b7298494a4e3bf139851d5f Backdoor.Linux.MIRAI.AR\n\na6956f98deec26bdaed948cd36ef6bfe954dbba227fd66ad3babd3a7fa4b4d96 Backdoor.Linux.MIRAI.AR\n\n239c9aeec6e17a2739c12b7a4821b99be53375b085210a14d2f4f3e362dd3b7c Backdoor.Linux.MIRAI.AR\n\nadb8271ed2342f50fd602353251574504672992db45fdde7e1e9a223cbd9a10a Backdoor.Linux.MIRAI.AR\n\n868a582cd87418faac09859527b1b9405b287799429c424552551a5a3ddfe1b3 Backdoor.Linux.MIRAI.AR\n\n25a5415a04ff746d0cfa4f5e82b00d7aaac60e92424dd94bb8cf9626e6b724ef Backdoor.Linux.MIRAI.AR\n\nf271d7a3290581f552376cf00006b961fcf54b0d9aa1365c4550113a1132f32d Backdoor.Linux.MIRAI.AR\n\nbd188c69264362b8a09d14af6196b83a6c3da5d6d3b6dc95b97fe87108500c91 Backdoor.Linux.MIRAI.AR\n\nc5e79ceb1878ad4aebf3e8a33a66aeed535aecc1e5ebca0dd0122a6ecfbfe207 Backdoor.Linux.MIRAI.AS\n\ne51c2675430ebb1e49b4187508eae926fdfc52560074a23f937fe50c72c3d56d Backdoor.Linux.MIRAI.AS\n\n\n-----\n\n76049e93887525e097c9fd06bdc31dad6a118082f5b2fc581020ae11ad80be95 Backdoor.Linux.MIRAI.AS\n\n119c33956bb26fdb697b2e042cde106c98cb1562fdbd5bb2acb2d8e7e603a303 Backdoor.Linux.MIRAI.AS\n\n4825e628d3d6442870821823c14bac5bcab93658e3dbf426b8e6c479320077a9 Backdoor.Linux.MIRAI.AS\n\n4dfab085dcc8d1a4ea6be2f6ca08970d238ffcd4b9ee0728d1f38070750e5f7b Backdoor.Linux.MIRAI.AS\n\n937df675fba3e58e41514ec1881bd9298043533ca9e113b91240d916761fa704 Backdoor.Linux.MIRAI.AS\n\nd6cf67dea7f89d87636f80eba76d4bfcdd6a5fc6540967c446c33522e95f156e Backdoor.Linux.MIRAI.AS\n\n1b20bedd8a69695ba30a4284c19fe84e5926ed8de4f9074b4137ee07e6674d77 Backdoor.Linux.MIRAI.AS\n\n37b6a3b2ca8681abfcaa79868963046aeaab8a46e123d5311d432bd9d11fcc80 Backdoor.Linux.MIRAI.AS\n\n19eb54eea5dfd71d5753ed94e1845fa81b88545f47c14a2c90960da8e06e6c1b Backdoor.Linux.MIRAI.AS\n\nec77dcab385c31bbbf228df92dcaecc947279c3143afc478807184395b06a6e6 Backdoor.Linux.MIRAI.AS\n\n83619527ba2e4c20d1eb5206f058ca55358b4b3ac032ee8d22616a020c8853d0 Backdoor.Linux.MIRAI.AS\n\n27f6c7ce88d874a270d197bb91d419783bf5e08e16fa43ced57607748f2fc5b2 Backdoor.Linux.MIRAI.AS\n\n404ea2a77693b0ab4c76da65aae7451d83d621a75b8eb8d2736998bf1c23ecf3 Backdoor.Linux.MIRAI.AS\n\n64e1f581d42f2c9e0c1f13b4f814d4a4b0cad2e3ac1c8a754f6a912ab07b4bc1 Backdoor.Linux.MIRAI.AS\n\n231d0913bba4b8c02f93fca2a917762eb94013d31f0ac4c9703b498b6ab9a87f Backdoor.Linux.MIRAI.AS\n\nbf3190c7746775a7756d76d0c4bbeedeb1b4bc2a14fb3465da0bd49dfae14503 Backdoor.Linux.MIRAI.AS\n\neba3e81fcedaaa9661c5faa41b98c1d7906fdad7f960530f936ac2ad0b921ac3 Backdoor.Linux.MIRAI.AS\n\nad463ae6c08a085a1c45fc8da32c736bb1ced083d0cc0619a7d0a919c43a3717 Backdoor.Linux.MIRAI.AS\n\neefa90ebde0d5d16c71315f292f86a72735e62af686a7872d1d153694582404d Backdoor.Linux.MIRAI.AS\n\n7408a894f4c278155b5ab28ebd48269075ee73ad24dc877cecd7b41a97b6d975 Backdoor.Linux.MIRAI.AS\n\n282836e3d6649d9f97cdbf6b373329386a4fd290b87599f84f1d84ecfe5586eb Backdoor.Linux.MIRAI.AS\n\n73036a31742e52cca9cfb02883cef62efb7f9129c14e2e2fd3064d2b4b8ec6e0 Backdoor.Linux.MIRAI.AS\n\nThe exploitation of vulnerabilities in smart devices has been a persistent problem for many internet of\n[things (IoT) users. Perhaps the most infamous IoT threat is the constantly evolving Mirai malware, which](https://blog.trendmicro.com/trendlabs-security-intelligence/internet-things-ecosystem-broken-fix/)\nhas been used in many past campaigns that compromised devices with default or weak credentials.\n[Different Mirai variants and derivatives have cropped up since its source code was leaked in 2016.](https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/source-code-of-iot-botnet-satori-publicly-released-on-pastebin)\n\nWe analyzed another Mirai variant called “Miori,” which is being spread through a Remote Code Execution\n(RCE) vulnerability in the PHP framework, ThinkPHP. The exploit related to the vulnerability is relatively\n[new — details about it have only surfaced on December 11. For its arrival method, the IoT botnet uses the](https://www.exploit-db.com/exploits/45978)\nsaid exploit that affects ThinkPHP versions prior to 5.0.23 and 5.1.31. Interestingly, our Smart Protection\nNetwork also showed a recent increase on events related to the ThinkPHP RCE. We expect malicious\nactors to abuse the ThinkPHP exploit for their respective gains.\n\n\n-----\n\nAside from Miori, several known Mirai variants like IZ1H9 and APEP were also spotted using the same\nRCE exploit for their arrival method. The aforementioned variants all use factory default credentials via\nTelnet to log in and spread to other devices. Once any of these Mirai variants infects a Linux machine, it\nwill become part of a botnet that facilitates distributed denial-of-service (DDoS) attacks.\n\n**Looking into the Mirai Variant, Miori**\n\n[Miori is just one of the many Mirai offshoots. Fortinet once described its striking resemblance to another](https://www.fortinet.com/blog/threat-research/shinoa--owari--mirai--what-s-with-all-the-anime-references-.html)\nvariant called Shinoa. Our own analysis revealed that the cybercriminals behind Miori used the ThinkPHP\nRCE to make vulnerable machines download and execute their malware from\n_hxxp://144[.]202[.]49[.]126/php:_\n\n[Figure 1. RCE downloads and executes Miori malware](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/12/miori-rce-fig-1.jpg)\n\n_Figure 1. RCE downloads and executes Miori malware_\n\nUpon execution, Miori malware will generate this in the console:\n\n[Figure 2. Miori infects device](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/12/miori-malware-console-fig-2.png)\n\n_Figure 2. Miori infects device_\n\nIt will start Telnet to contactother IP addresses. It also listens on port 42352 (TCP/UDP) for commands\nfrom its C&C server. It then sends the command “/bin/busybox MIORI” to verify infection of targeted\nsystem.\n\n[Figure 3. Miori sends command](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/12/miori-command-fig-3.png)\n\n_Figure 3. Miori sends command_\n\nWe were able to decrypt Miori malware’s configuration table embedded in its binary and found the\nfollowing notable strings. We also listed the usernames and passwords used by the malware, some of\nwhich are default and easy-to-guess.\n\nMirai variant: Miori\n\nXOR key: 0x62\n\n**Username/Password** **Notable strings**\n\n\n-----\n\n1001chin\n\nadm\n\nadmin123\n\nadmintelecom\n\naquario\n\ndefault\n\ne8ehome\n\ne8telnet\n\nGM8182\n\ngpon\n\noh\n\nroot\n\nsupport\n\ntaZz@23495859\n\ntelecomadmin\n\ntelnetadmin\n\ntsgoingon\n\nttnet\n\nvizxv\n\nzte\n\n\n/bin/busybox kill -9\n\n/bin/busybox MIORI (infection verification)\n\n/bin/busybox ps (kills parameters)\n\n/dev/FTWDT101\\ watchdog\n\n/dev/FTWDT101_watchdog\n\n/dev/misc/watchdog\n\n/dev/watchdog\n\n/dev/watchdog0\n\n/etc/default/watchdog\n\n/exe\n\n/maps\n\n/proc/\n\n/proc/net/route\n\n/proc/net/tcp\n\n/sbin/watchdog\n\n/status\n\naccount\n\nenable\n\nenter\n\nincorrect\n\nlogin\n\nlolistresser[.]com (C&C server)\n\nMIORI: applet not found (infection verification)\n\npassword\n\nshell\n\nsystem\n\nTSource Engine Query\n\nusername\n\nyour device just got infected to a bootnoot\n\n\n_Table 1. Related Miori credentials and strings_\n\n\n-----\n\nA closer look also uncovered two URLs used by two other variants of Mirai: IZ1H9 and APEP. We then\nlooked into the binaries (x86 versions) located in the two URLs. Both variants use the same string\ndeobfuscation technique as Mirai and Miori, and we were likewise able to decrypt their configuration table.\n\n_hxxp://94[.]177[.]226[.]227/bins/_\n\nMirai variant: IZ1H9\n\nXOR key: 0xE0\n\n**Username/Password** **Notable strings**\n\n\n00000000\n\n12345\n\n54321\n\n123456\n\n1111111\n\n20080826\n\n20150602\n\n88888888\n\n1234567890\n\n/ADMIN/\n\nadmin1\n\nadmin123\n\nadmin1234\n\nantslq\n\nchangeme\n\nD13hh[\n\ndefault\n\nezdvr\n\nGM8182\n\nguest\n\nhi3518\n\nipc71a\n\nIPCam@sw\n\nipcam_rt5350\n\njuantech\n\n\n/bin/busybox IZ1H9 (infection verification)\n\n/bin/watchdog /dev/FTWDT101\\ watchdog (watchdog disabling)\n\n/dev/FTWDT101_watchdog\n\n/dev/misc/watchdog\n\n/dev/watchdog\n\n/dev/watchdog0\n\n/dev/watchdog1\n\n/etc/default/watchdog\n\n/etc/resolv.conf\n\n/proc/\n\n/proc/net/tcp\n\n/sbin/watchdog\n\nassword\n\nenable\n\nenter\n\nIZ1H9: applet not found\n\nj.#0388 (printed out in console after execution)\n\nlinuxsh\n\nlinuxshell\n\nnameserver\n\nncorrect\n\nsystem\n\nTSource Engine Query\n\n\n-----\n\njvbzd\n\nklv123\n\nklv1234\n\nnimda\n\npassword\n\nqwerty\n\nQwestM0dem\n\nroot123\n\nservice\n\nsmcadmin\n\nsupport\n\nsvgodie\n\nsystem\n\ntelnet\n\ntl789\n\nvizxv\n\nvstarcam2015\n\nxc3511\n\nxmhdpic\n\nzlxx.\n\nzsun1188\n\nZte521\n\n_Table 2. Related IZ1H9 credentials and strings_\n\n_hxxp://cnc[.]arm7plz[.]xyz/bins/_\n\nMirai variant: APEP\n\nXOR key: 0x04\n\n**Username/Password** **C&C server** **Notable strings**\n\n\n-----\n\n123456\n\n888888\n\n20150602\n\n1q2w3e4r5\n\n2011vsta\n\n3ep5w2u\n\nadmintelecom\n\nbcpb+serial#\n\ndefault\n\ne8ehome\n\ne8telnet\n\nfliruser\n\nguest\n\nhuigu309\n\njuniper123\n\nklv1234\n\nlinux\n\nmaintainer\n\nMaxitaxi01\n\nsuper\n\nsupport\n\ntaZz@01\n\ntaZz@23495859\n\ntelecomadmin\n\ntelnetadmin\n\ntsgoingon\n\nvstarcam2015\n\nZte521\n\nZXDSL\n\n\n_cnc[.]arm7plz[.]xyz_\n\n_scan[.]arm7plz[.]xyz_\n\n\n%4'%-\\F\n\n/bin/busybox APEP (infection verification)\n\n/bin/watchdog (watchdog disabling)\n\n/dev/FTWDT101/watchdog\n\n/dev/FTWDT101_watchdog\n\n/dev/misc/watchdog\n\n/dev/watchdog\n\n/dev/watchdog0\n\n/etc/default/watchdog\n\n/etc/watchdog /maps/\n\n/proc/\n\n/proc/net/tcp\n\n/sbin/watchdog /status\n\nCIA NIGGER\n\nenable\n\nenter\n\nincorrect\n\nlinuxshell\n\npassword\n\nshell\n\nstart\n\nsystem\n\nterryadavis\n\n\n_Table 3. Related APEP credentials, C&C servers, and strings_\n\n\n-----\n\nIt should be noted that aside from dictionary attacks via Telnet, APEP also spreads by taking advantage of\n[CVE-2017-17215, which involves another RCE vulnerability and affects Huawei HG532 router devices, for](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17215)\n[its attacks. The vulnerability was also reported to be involved in Satori and Brickerbot variants. Huawei has](https://securityaffairs.co/wordpress/67227/malware/cve-2017-17215-exploit-code.html)\n[since released a security notice and outlined measures to circumvent possible exploitation.](https://www.huawei.com/en/psirt/security-notices/huawei-sn-20171130-01-hg532-en)\n\n[Figure 4. Exploit related to CVE-2017-17215](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/12/cve-2017-17215-exploit-fig-4.png)\n\n_Figure 4. Exploit related to CVE-2017-17215_\n\n**Conclusion and Recommendations**\n\nTelnet default password login attempts to connected devices aren’t new. Factory default passwords, which\nmany users may ignore or forget to change, are commonly used to access vulnerable devices. Mirai has\nsince spawned other botnets that use default credentials and vulnerabilities in their attacks. Users are\nadvised to change the default settings and credentials of their devices to deter hackers from hijacking\nthem. As a general rule, smart device users should regularly update their devices to the latest versions.\nThis will address vulnerabilities that serve as potential entry points for threats and will also improve the\nfunctionality of the devices. Finally, enable the auto-update feature if the device allows it.\n\nUsers can also adopt IoT security solutions that are designed to combat these kinds of threats. Trend\nMicro Smart Home Network™ protects users from this threat via this intrusion prevention rule:\n\n1135215 WEB ThinkPHP Remote Code Execution\n\n**Indicators of Compromise (IoCs)**\n\n**Related malicious URLs:**\n\n_hxxp://144[.]202[.]49[.]126/miori[.]mips_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]mpsl_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]arm_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]arm5_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]arm6_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]arm7_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]sh4_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]ppc_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]x86_\n\n_hxxp://144[.]202[.]49[.]126/miori[.]arc_\n\n_hxxp://144[.]202[.]49[.]126/php_\n\n_hxxp://94[.]177[.]226[.]227/bins/_\n\n_hxxp://cnc[.]arm7plz[.]xyz/bins/_\n\n\n-----\n\n_hxxp://scan[.]arm7plz[.]xyz_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-12-20 - With Mirai Comes Miori- IoT Botnet Delivered via ThinkPHP Remote Code Execution Exploit.pdf"
    ],
    "report_names": [
        "2018-12-20 - With Mirai Comes Miori- IoT Botnet Delivered via ThinkPHP Remote Code Execution Exploit.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535600,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653706287,
    "ts_modification_date": 1653706287,
    "files": {
        "pdf": "https://archive.orkl.eu/16af81db93aaafc29869a6f36c09dd49270a3ba2.pdf",
        "text": "https://archive.orkl.eu/16af81db93aaafc29869a6f36c09dd49270a3ba2.txt",
        "img": "https://archive.orkl.eu/16af81db93aaafc29869a6f36c09dd49270a3ba2.jpg"
    }
}