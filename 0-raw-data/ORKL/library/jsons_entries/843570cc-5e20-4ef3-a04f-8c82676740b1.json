{
    "id": "843570cc-5e20-4ef3-a04f-8c82676740b1",
    "created_at": "2023-01-12T15:06:43.992696Z",
    "updated_at": "2025-03-27T02:09:29.203511Z",
    "deleted_at": null,
    "sha1_hash": "c86120b31d026b58c8783c1b0c869e14862e0b61",
    "title": "2022-11-10 - Penetration and Distribution Method of Gwisin Attacker",
    "authors": "",
    "file_creation_date": "2022-11-28T19:02:40Z",
    "file_modification_date": "2022-11-28T19:02:40Z",
    "file_size": 2039833,
    "plain_text": "# Penetration and Distribution Method of Gwisin Attacker\n\n**asec.ahnlab.com/en/41565/**\n\nNovember 10, 2022\n\nThe attacker of Gwisin ransomware targets and penetrates the publicly available servers of companies. They then\nuse the server as their foothold for distributing the ransomware into the internal infrastructure. It is known that the\nattacker uses various means such as SFTP, WMI, integrated management solution, and IIS web service to distribute\nthe ransomware into the internal infrastructure. In this confirmed case, they used the IIS web service to distribute\nGwisin ransomware.\n\n**How Gwisin Attacker Penetrates a Server**\n\nUnlike other attackers who use spear phishing, watering hole, and other known methods to dominate a PC and obtain\nadministrator privilege to propagate the virus into a target company’s internal network systems, the Gwisin threat\nactor directly performs the web hacking attack to penetrate into the web servers. As such, companies must check for\nweb vulnerabilities and fortify the security of connected DBs to defend against web hacking attacks.\n\nIt appears that the attacker attempts to steal system account info prior to distributing the ransomware. They scan and\nperform SQL injection attack on publicly-exposed web servers.\n\nAmong the traces of the attack, an attack code of SQL Injection, written for use against an MS SQL server, was found\nin a Linux server. This hints that the attacker is indiscriminately attacking the servers using automated offense tools.\n\nFigure. SQL injection attack\n\ncode of the Gwisin attacker found in Linux server\nIt has been confirmed that the attacker uses WebShell following after a successful attack on a web server. Some\ncases involve WebShell inserted into a PHP file. In other cases, independent WebShell files were created. However,\nthe techniques of inserting WebShell code into the existing file or uploading the file have not yet been identified.\n\n\n-----\n\nAdditionally, the attacker uses a Reverse Shell code written with Python to establish a reverse connection. It was\ndiscovered that the attacker adds service_issue() function performing the roll of Reverse Shell to the init type of Linux\nshell script existing inside the system. The attacker creates a TCP socket through the function, connects to the\nattacker server (158.247.221.23:80), and runs sh to provide the attacker with Linux shell.\n\nFigure. Reverse Shell code inserted\n\nby the attacker\n**What the Attacker Does After Penetrating into Server**\n\nAfter dominating a Linux system, the attacker uses RPM to install NMAP. They then perform multiple port scans on\nthe internal systems to identify additional attack targets.\n\nFigure. Confirmed installed NMAP\n\nFigure. History of NMAP execution\n\n**How the Attacker Moves Inside the Internal Server**\n\nThe attacker, after dominating the Windows system of the internal network, registers a service that perform Full\nMemory Dumping on the memory of the Isass.exe process to obtain additional credentials. They then secure the\nmemory dump of the lsass.exe process.\n\nFigure. Event log for registering lsass.exe dumping service\nThe attacker then uses the obtained credentials to send reverse connection command to other systems. Among the\ntarget systems that received the command, the systems connected to the Internet are connected to the C2 server. As\na result, the attacker gains direct control over the internal system from the outside.\n\nFigure. Trace of reverse connection attempted using attacker IP\nThe attacker then downloads the Gwisin MSI file from the C2 server.\n\n\n-----\n\nFigure. Event log of the system downloading\n\nransomware MSI file\n**How the Attacker Distributes the Ransomware**\n\nThe attacker installs the IIS web service into the first dominated system and uses it to spread the ransomware to\ninternal systems of the target company. After installing the IIS web service, the attacker creates the ransomware files\nin the web root path (C:\\inetpub\\wwwroot) and distributes the ransomware.\n\nRansomware for Windows: x64_install.msi\nRansomware for Linux: x64_nix, x86_nix\n\nFigure. Part of event log for installing of IIS service\n\nThe attacker can use the IIS web service in the internal system to easily distribute the ransomware to multiples\nsystems connected to the domain via AD policy and WMI command. Furthermore, the attacker does not have to\ndirectly access the server that distributes the malware on the Internet. As such, they can successfully distribute the\nransomware into the internal systems without Internet access.\n\nThe attacker uses the following command to download and run the ransomware.\n\nFigure. Command for downloading and running ransomware\nWhen the above command is executed, “x64_install.msi,” the ransomware file in the IIS web route directory, is\ndownloaded and executed.\n\n**Characteristics of Gwisin**\n\nTo run Gwisin, one must enter the exact arguments.\n\nFigure. Command for running ransomware\nThe description of each argument is as follows:\n\nLICENSE: A key that decrypts the encoded ransomware (creates decryption key by combining with SERIAL)\nSERIAL: A key that decrypts the encoded ransomware (creates decryption key by combining with LICENSE)\n\n\n-----\n\nSMM (see Malicious File Analysis Results for details)\n\n0: File Encryption Mode\n1: Safe Mode Boot Mode\n\nWhen the file is encrypted via the ransomware, an extension similar to the name of the target company is added to\nthe encrypted file. Additionally, a file with ‘0’ at the end of the extension is also created in the same directory. It\ncontains information required to restore the original file.\n\nUpon the file encryption, a ransom note is created. The ransom note’s filename and body text contain strings that can\nidentify the target company. It contains the URL that connects to the attacker’s website, and account and password\nthat can be used to log in to the website.\n\nFigure. Ransom note confirmed from the ransomware-infected system (!!!_HOW_TO_UNLOCK_FILES_!!!.TXT)\nGwisin deletes event logs and ransomware files of the system after the file encryption.\n\nFor more information on Gwisin’s process flow and characteristics, see ASEC blog’s Gwisin Ransomware Targeting\n_[Korean Companies (https://asec.ahnlab.com/en/37483/).](https://asec.ahnlab.com/en/37483/)_\n\n**Malware Used by the Attacker**\n\n\n-----\n\n**MD5** **Filename** **Analysis Results**\n\n\n13eef02d5e5f5543\ne83ad8c8a8c8ff9a\n\n95237d0c6e6b1822\ncecca34994c0d273\n\n**[File Detection]**\n\n\nMSI****.tmp\n\nGwisin file for Windows which is the DLL file of install_x64.msi\n\n**[Ransomware Behavior Details]**\nIf executed with SMM=1\n\n**1. Self-Replication**\nㆍCopies itself into the following filepath\nㆍC:\\ProgramData\\a35f23725b5feab2.msi\n**2. Ransomware Service Creation**\nㆍService Name: ****************(16-digit HEX)\nㆍImage Path: msiexec /qn /i C:\\ProgramData\\****************.msi\nSERIAL=**************** LICENSE=**************** SMM=0 ORG=***\n**3. Copying of bcdedit.exe and Changing Boot Option**\nㆍCopies bcdedit.exe to ProgramData folder with a different name (dxdiag.exe)\nㆍChanges default boot mode to safe mode\n**4. Registering Service to Enable Operation in Safe Mode**\nㆍ\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\nㆍ\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\n**5. Reboot**\nㆍReboots as safe mode after 5 seconds\n**6. Ransomware Operation**\n\nx86_nix x86 version file of Gwisin\n\n\nRansomware/Win.Gwisin (2022.07.27.03)\nTrojan/Linux.Agent (2022.08.05)\n\n**[File MD5]**\n\n13EEF02D5E5F5543E83AD8C8A8C8FF9A\n95237D0C6E6B1822CECCA34994C0D273\n\n**[IP/URL]**\n\n158.247.221[.]23\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to check related IOC and**\n**detailed analysis informaion.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information-en/)\n\n[Tagged as:GWISIN Ransomware,](https://asec.ahnlab.com/tag/gwisin-ransomware/) [Ransomware](https://asec.ahnlab.com/en/tag/ransomware-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-10 - Penetration and Distribution Method of Gwisin Attacker.pdf"
    ],
    "report_names": [
        "2022-11-10 - Penetration and Distribution Method of Gwisin Attacker.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536003,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1669662160,
    "ts_modification_date": 1669662160,
    "files": {
        "pdf": "https://archive.orkl.eu/c86120b31d026b58c8783c1b0c869e14862e0b61.pdf",
        "text": "https://archive.orkl.eu/c86120b31d026b58c8783c1b0c869e14862e0b61.txt",
        "img": "https://archive.orkl.eu/c86120b31d026b58c8783c1b0c869e14862e0b61.jpg"
    }
}