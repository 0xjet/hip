{
    "id": "ad343b3c-c427-4882-bb85-c62b5dc36193",
    "created_at": "2023-01-12T15:09:53.945668Z",
    "updated_at": "2025-03-27T02:16:37.168739Z",
    "deleted_at": null,
    "sha1_hash": "822673d05477662687fb7aa857981fbe092aea44",
    "title": "2018-05-17 - A Wicked Family of Bots",
    "authors": "",
    "file_creation_date": "2022-05-28T03:37:53Z",
    "file_modification_date": "2022-05-28T03:37:53Z",
    "file_size": 351729,
    "plain_text": "# A Wicked Family of Bots\n\n**[fortinet.com/blog/threat-research/a-wicked-family-of-bots.html](https://www.fortinet.com/blog/threat-research/a-wicked-family-of-bots.html)**\n\nMay 17, 2018\n\nAs we continue to keep track of the latest IoT botnets, the FortiGuard Labs team has seen\nan increasing number of Mirai variants, thanks to the source code being made public two\nyears ago. Since then, threat actors have been adding their own flavours to the original\nrecipe.\n\nSome made significant modifications, such as adding the capability to turn infected devices\ninto swarms of [malware proxies and](https://www.fortinet.com/blog/threat-research/omg--mirai-based-bot-turns-iot-devices-into-proxy-servers.html) [cryptominers. Others integrated Mirai code with multiple](https://www.fortinet.com/blog/threat-research/satori-adds-known-exploit-chain-to-slave-wireless-ip-cameras.html)\n[exploits targeting both known and unknown vulnerabilities, similar to a new variant recently](https://www.fortinet.com/blog/threat-research/rise-of-one-more-mirai-worm-variant.html)\ndiscovered by FortiGuard Labs, which we now call WICKED.\n\nThis new variant has added at least three exploits to its arsenal to target unpatched IoT\ndevices. In this article, we will take a look at how it works, the primary purpose of this bot,\nand how it relates to other known botnets.\n\n## Inside the Bot\n\n\n-----\n\nTo provide an immediate overview on the differences between Mirai and this new variant, we\nneed to take a look at its configuration table, which can be decrypted by XOR with the key\n0x37.\n\nSome of the more interesting strings we noticed include /bin/busybox WICKED and\n_WICKED: applet not found, where we got the name for this variant. Moreover, the string_\n_SoraLOADER might be taken as a clue that this bot functions as a downloader and spreader_\nfor the Sora botnet, a Mirai variant. However, as we went through our analysis, this was later\ncontradicted, which then led us to a more interesting hypothesis.\n\nFig 1. Decrypted configuration table\n\nBotnets based on Mirai usually contain three main modules: Attack, Killer, and Scanner. In\nthis analysis, we will just focus on the Scanner module that includes the spreading\nmechanism of the botnet. The original Mirai used traditional brute force attempts to gain\naccess to IOT devices. The WICKED bot, on the other hand, uses known and available\nexploits, with many of them already being quite old.\n\nWicked bot scans port 8080, 8443, 80, and 81 by initiating a raw socket SYN connection.\n\nFig 2. Socket file descriptor\n\nIf a connection is established, it will attempt to exploit the device and download its payload. It\ndoes this by writing the exploit strings to the socket using the write() syscall. Write() syscall is\nthe same as calling send() syscall with the flags argument set to zero (which means no extra\nbehaviors.)\n\nFig 3. Sending a request by writing to a socket\n\n## Devices Targeted by Wicked\n\nThe exploit to be used depends on the specific port the bot was able to connect to. Exploits\nand the corresponding target ports are listed below.\n\n_Port 8080:_ _[Netgear DGN1000 and DGN2200 v1 routers (also used by Reaper botnet)](https://www.exploit-db.com/exploits/43055/)_\n\nFig 4. Netgear exploit\n\n_Port 81: CCTV-DVR_ _[Remote Code Execution](http://www.kerneronsec.com/2016/02/remote-code-execution-in-cctv-dvrs-of.html)_\n\nFig 5. CCTV-DVR RCE exploit\n\n_[Port 8443: Netgear R7000 and R6400 Command Injection (CVE-2016-6277)](https://www.exploit-db.com/exploits/41598/)_\n\nFig 6. CVE-2016-6277 exploit\n\n\n-----\n\n_Port 80: Invoker shell in compromised web servers_\n\nThe next item on the list does not directly exploit the device, but instead takes advantage of\ncompromised web servers with malicious web shells already installed.\n\nFig 7. Invoke shell\n\nAfter a successful exploit, this bot then downloads its payload from a malicious web site, in\nthis case, hxxp://185.246.152.173/exploit/owari.{extension}. This makes it obvious that it\naims to download the Owari bot, another Mirai variant, instead of the previously hinted at\nSora bot. However, at the time of analysis, the Owari bot samples could no longer be found\nin the website directory. In another turn of events, it turns out that they have been replaced\nby the samples shown below, which were later found to be the Omni bot.\n\nFig 8. Exploit repository of Omni botnet\n\nWe double checked the history of the malicious website and confirmed that it had previously\ndelivered the Owari botnet.\n\nFuzzing the website’s /bins directory, we found other Omni samples in the directory, which\n[were reported to be delivered using the GPON vulnerability (CVE-2018-10561). Payloads](https://blog.newskysecurity.com/cve-2018-10561-dasan-gpon-exploit-weaponized-in-omni-and-muhstik-botnets-ad7b1f89cff3)\nare regularly updated, as shown by its timestamp.\n\nFig 9. Bins repository of Omni botnet\n\n## Connecting the Dots\n\nFinding the connection between the Wicked, Sora, Owari,and Omni botnets led us to an\n[interview last April with a security researcher who we believe to be the author of these botnet](https://blog.newskysecurity.com/understanding-the-iot-hacker-a-conversation-with-owari-sora-iot-botnet-author-117feff56863)\nvariants. Basically, the author using pseudo name “Wicked” confirmed he is the author of\nboth Sora and Owari. When asked about the future of Sora and Owari, Wicked’s response\nwas “SORA is an abandoned project for now and I will continue to work on OWARI. You will\n_not see a third project from me anytime soon as I continue to expand my current ones.”_\n\n_Apparently, as seen in the /bins repository, Sora and Owari botnet samples have now both_\n_been abandoned and replaced with Omni._\n\n## Conclusion\n\n_Based on the author’s statements in the above-mentioned interview as to the different_\n_botnets being hosted in the same host, we can essentially confirm that the author of the_\n_botnets Wicked, Sora, Owari, and Omni are one and the same. This also leads us to the_\n_conclusion that while the WICKED bot was originally meant to deliver the Sora botnet, it was_\n_later repurposed to serve the author’s succeeding projects._\n\n\n-----\n\nFortiGuard Labs will continue to monitor the latest developments in the IoT threat landscape,\nspecifically following botnets as they add new exploits to their arsenal in order to infect IoT\ndevices.\n\n_Many thanks to our colleagues David Maciejak, Joie Salvio, Jasper Manuel and Tony Loi for_\n_the additional analyses/insights_\n\n-= FortiGuard Lion Team =\nAttacks mentioned are covered by the following IPS signatures:\n\nNETGEAR.DGN1000.CGI.Unauthenticated.Remote.Code.Execution\nNETGEAR.DGN1000B.Setup.CGI.Remote.Command.Execution\nNETGEAR.WebServer.Module.Command.Injection\nMultiple.CCTV.DVR.Vendors.Remote.Code.Execution\n\n## IOC\n\n**Sha256:**\n\nELF/Mirai.AT!tr\n57477e24a7e30d2863aca017afde50a2e2421ebb794dfe5335d93cfe2b5f7252 (Wicked)\n\n**Download Sites:**\n\nhxxp://185.246.152.173/bins/\nhxxp://185.246.152.173/exploit/\n\n_Check out our latest_ _[Quarterly Threat Landscape Report for more details about recent](http://go.fortinet.com/LP=4658?utm_source=social&utm_medium=blog&utm_campaign=GEN-WP-Q1-2018-Threat-Landscape-Report&elq_src=Social&elq_cid=70134000001StUhAAK&elq_staid=10&elq_eid=10258&elq_sid=11288)_\n_threats._\n\n_[Sign up for our weekly FortiGuard intel briefs or for our FortiGuard Threat Intelligence](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html?utm_source=nreleaseblog&utm_campaign=2018-q2-fortiguardlabs-cta)_\n_Service._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-17 - A Wicked Family of Bots.pdf"
    ],
    "report_names": [
        "2018-05-17 - A Wicked Family of Bots.pdf"
    ],
    "threat_actors": [
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536193,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653709073,
    "ts_modification_date": 1653709073,
    "files": {
        "pdf": "https://archive.orkl.eu/822673d05477662687fb7aa857981fbe092aea44.pdf",
        "text": "https://archive.orkl.eu/822673d05477662687fb7aa857981fbe092aea44.txt",
        "img": "https://archive.orkl.eu/822673d05477662687fb7aa857981fbe092aea44.jpg"
    }
}