{
    "id": "ad9ca2c2-8535-4d2d-a007-21076fd72121",
    "created_at": "2022-10-25T16:48:19.300042Z",
    "updated_at": "2025-03-27T02:16:25.530286Z",
    "deleted_at": null,
    "sha1_hash": "bcc2ff0e9e6bfbc5b2d54610dede3be8a49f1331",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-02-10T20:35:16Z",
    "file_modification_date": "2021-02-10T20:35:16Z",
    "file_size": 1672507,
    "plain_text": "# Domestic Kitten – An Inside Look at the Iranian Surveillance Operations\n\n**[research.checkpoint.com/2021/domestic-kitten-an-inside-look-at-the-iranian-surveillance-operations](https://research.checkpoint.com/2021/domestic-kitten-an-inside-look-at-the-iranian-surveillance-operations/)**\n\nFebruary 8, 2021\n\nFebruary 8, 2021\n\n## Overview\n\n[Despite the reveal of “Domestic Kitten” by Check Point in 2018, APT-C-50 has not](https://research.checkpoint.com/2018/domestic-kitten-an-iranian-surveillance-operation/)\nstopped conducting extensive surveillance operations against Iranian citizens that could\npose a threat to the stability of the Iranian regime, including internal dissidents,\nopposition forces, ISIS advocates, the Kurdish minority in Iran, and more.\n\nIn this paper, Check Point Research reveals the extent of the operations, the multiple\ncampaigns executed by APT-C-50, their delivery methods, and an analysis of the targeted\nindividuals. In addition, we provide a technical analysis of the FurBall malware used since\nthe beginning of the operation, its origin, and observed covers used to conceal the\nmalware’s true nature.\n\n## General\n\nCheck Point researchers recently uncovered the full extent of Domestic Kitten’s extensive\nsurveillance operation against Iranian citizens that could pose a threat to the stability of\nthe Iranian regime. The operation itself is linked to the Iranian government, and executed\nby APT-C-50.\n\nStarting in 2017, this operation, consisting of 10 unique campaigns, targeted over 1,200\nindividuals with more than 600 successful infections. It includes 4 currently active\n\n\n-----\n\ncampaigns, the most recent of which began in November 2020.\nIn these campaigns, victims are lured to install a malicious application by multiple\nvectors, including an Iranian blog site, Telegram channels, and even by SMS with a link to\nthe malicious application.\nThe capabilities of the Domestic Kitten malware (which we are calling FurBall), include:\ncollecting device identifiers, grabbing SMS messages and call logs, surround recording\nwith the device microphone, call recording, stealing media files (such as videos and\nphotos), obtaining a list of installed applications, tracking the device location, stealing\nfiles from the external storage, and more. For a full list of commands, see the Technical\nAnalysis section.\n\n## Campaigns & Victims\n\nAlmost all of the campaigns we observed use the same infrastructure that Domestic Kitten\nused back in 2018, the C&C hXXp://www[.]firmwaresystemupdate[.]com. We\ndifferentiate between campaigns by the URI segment of the C&C server. For example, in\nthe most recent campaign the full C&C address is\nhXXp://www[.]firmwaresystemupdate[.]com/hass (which we call the ‘hass’ campaign\nfor obvious reasons).\n\n**Campaign** **Start** **End**\n\n**hass** November 2020 **Currently active**\n\n**or** May 2020 June 2020\n\n**mat** December 2019 July 2020\n\n**hj** May 2019 April 2020\n\n**oth** June 2018 **Currently active**\n\n**hr** October 2017 November 2017\n\n**maj** October 2017 June 2019\n\n**mmh** July 2017 **Currently active**\n\n**msd** June 2017 **Currently active**\n\n**grt** June 2017 September 2019\n\n_Figure 1 – Domestic Kitten Campaign list_\n\nFurBall uses a large variety of covers to mask its malicious intentions. A few prominent\ncovers include:\n\nVIPRE Mobile Security – A fake mobile security application.\n\n\n-----\n\nISIS Amaq – A news outlet for the Amaq news agency.\nExotic Flowers – A repackaged version of a game from Google Play.\nMyKet – An Android application store.\nIranian Woman Ninja – A wallpaper application.\n\nIn the newest ‘hass’ campaign, APT-C-50 mimics an application for the restaurant\n“Mohsen Restaurant” which is located in Tehran. Covers of the ‘mmh’ campaign include\nan ISIS supporter application and a repackaged version of ‘Exotic Flowers’ from Google\nPlay.\n\n_Figure 2 – FurBall Mohsen ;hass’_\n\n\n-----\n\n-----\n\n_Figure 3 – FurBall Repacked ‘Exotic Flowers’ cover, and an ISIS supported cover_\n\nA full list of the covers is provided in Appendix 1 – FurBall Covers.\n\nThe methods used to deliver FurBall applications to victims also varies from one\ncampaign to another. In some campaigns, we observed SMS messages with a link to\ndownload the malware, while in others an Iranian blog site hosted the payload. In\nanother campaign, we assume that the application was shared in a Telegram channel.\n\n\n-----\n\n_Figure 4 – The Iranian blog hosting FurBall_\n\nWe were able to identify victims of the Domestic Kitten operation from various places\naround the globe, including Iran, the United States, Great Britain, Pakistan, Afghanistan,\nTurkey, and more.\n\n_Figure 5 – Victims distribution by Country_\n\n\n-----\n\n_Figure 6 – Successful attacks by date and campaign_\n\nWe traced 2 unique IPs that connected to the malware’s C&C server. We assume that\nthose IPs are used to send instructions to the server: 94.182.215.98 and 188.158.60.100.\nAccording to ip2location.com, both IPs reside in Iran, the first in Tehran, and the second\nin Karaj.\n\n_Figure 7 – IP2Location’s output_\n\n## FurBall – Technical Analysis\n\n\n-----\n\nUpon execution, the first thing Furball does is to allow execution of the application on the\ndevice startup. To achieve this, FurBall starts its code on a receiver that listens for the\nBOOT_COMPLETED event, which in turn calls to the ‘startService’ method to initiate\neverything that is needed for the malware’s functionality.\n\n_Figure 8 – BOOT_COMPLETED receiver_\n\n_Figure 9 – The startService method_\n\nIn addition, this piece of code also initializes a ‘settings’ object, which contains the\nconfiguration for FurBall: which C&C to connect to, another back-up C&C address, flags\nto allow functionality, frequency for C&C pulling commands, and more.\n\n_Figure 10 – FurBall configuration_\n\n\n-----\n\nAfter initialization, FurBall creates 3 threads.\n\nThe first periodically sends media files such as videos, photos, and call records to the\nserver, with a default frequency of every 20 seconds. The remaining 2 threads are keepalive threads that communicate with <C&C Address>/<campaign>/answer.php.\nWe assume this allows the threat actors to see which devices are currently active.\n\nThe next step for FurBall is to initialize the Command Manager. This component pulls\ncommands from the C&C by requesting the <C&C>/<campaign>/get-function.php\nand awaits commands. Each command is delimited by the “===”string, and the\narguments are delimited by the “~~~” string.\n\n**Command** **Action**\n\n**NoCommand** No command.\n\n**Time** Gets device local time.\n\n**Set** Sets a configuration parameter given as the first argument,\nto a specific value given as the second argument.\n\n**Get** Gets data given as an argument from the infected device.\nThe list below includes all possible Get arguments.\n\n**Get~~~AllLog** Gets log files\n\n**Get~~~AllNotif** Gets all notifications\n\n**Get~~~AllContact** Gets all contacts.\n\n**Get~~~AllFile** Gets the names of all files on the device from the SD card\nroot.\n\n**Get~~~AllSms** Gets all SMS.\n\n**Get~~~AllCall** Gets call logs.\n\n**Get~~~AllApp** Gets a list of all installed applications on the device.\n\n**Get~~~AllBrowser** Gest all browsing history.\n\n**Get~~~AllAccount** Gest a list of all user accounts stored on the device.\n\n**Get~~~AllSettings** Gets the settings for FurBall.\n\n**Get~~~Location** Gets the current location of the device.\n\n**Get~~~HardwareInfo** Gets hardware information on the device.\n\n**Get~~~File** Gets a specific file and upload it to\n**<C&C>/<campaign>/upload-file.php**\n\n\n-----\n\n**Take** Allows the actor to perform actions on the device itself. The\nlist below shows all possible arguments for the Take\ncommand.\n\n**Take~~~Audio** Starts audio recording with the microphone for a given\namount of time.\n\n**Take~~~Video** Starts a video recording using camera ID specified as a\nparameter for a given amount of time.\n\n**Take~~RecordCall** Starts recording calls from this point on.\n\n**Delete~~~SMS** Deletes all SMS from the “HiddenNumber” parameter in the\nconfiguration.\n\n**Delete~~~Call** Deletes all calls from the “HiddenNumber” parameter in the\nconfiguration.\n\n**Delete~~~File** Deletes files from provided paths.\n\n**Reset~~~AllCommand** Deletes all logs and media files, resets to a “default”\nconfiguration.\n\n_Figure 11 – FurBall possible commands_\n\n_Figure 12 – the Command Manager listening for commands_\n\n\n-----\n\n_Figure 13 – Command Manager parsing commands_\n\nAfter all initializations, it’s time to start collecting the initial data on the device. FurBall\ncollects the following data on startup:\n\nHardware Information\nContacts\nCall logs\nAccounts\nBrowser history\nFile list on the SD card\n\n\n-----\n\n_Figure 14 – the sendStartup method_\n\nAfter collecting initial data on the device, FurBall initialize two other components. The\nfirst one is a clipboard monitor which monitors the clipboard content (where data is\nstored when it’s “copied”), and the other collects info about the top-most application’s\nactivity.\n\n_Figure 15 – Clipboard monitor_\n\n\n-----\n\n_Figure 16 – Top-most application monitor_\n\nThe last significant component that is used by FurBall is the Notification Observer\nService, a service that is based on the NotificationListenerService and allows FurBall to\naccess all notifications received by the device.\n\n_Figure 17 – NotificationObserverService_\n\nWhile investigating the new version of Domestic Kitten’s FurBall, we noticed that FurBall\nis actually based on a commercially available parental control software called KidLogger .\nAs FurBall shares a lot of infrastructure code with KidLogger, it seems that the developers\nused the KidLogger source-code available on github.\n\n\n-----\n\nA few noticeable differences between KidLogger and FurBall:\n\nFurBall has a configuration update mechanism that is not present in KidLogger.\nFurBall is based on plain threads, while KidLogger is based on services.\n\n\n-----\n\n_Figure 18 – Code similarity between FurBall and KidLogger_\n\n\n-----\n\n## Demo\n\nWe were able to mimic the command and control server’s behavior and provide a\npotential use-case against a fictional target.\n\n[https://www.youtube.com/watch?v=lpsS3g0xZIU&feature=youtu.be](https://www.youtube.com/watch?v=lpsS3g0xZIU&feature=youtu.be)\n\n## How to protect yourself\n\n[Check Point SandBlast Mobile is the market-leading Mobile Threat Defense (MTD)](https://pages.checkpoint.com/2019-miercom-mobile-threat-defense-report.html)\nsolution, providing the widest range of capabilities to help you secure your mobile\nworkforce.\n\nSandBlast Mobile provides protection for all mobile vectors of attack, including the\ndownload of malicious applications and applications with malware embedded in them.\n\n[Learn more.](https://www.checkpoint.com/products/mobile-security)\n\n### Appendix 1 – FurBall Covers:\n\n**Package name** **Cover**\n\ncom.intense.pub1.sbgs Islamic Caliphate\n\ncom.clem.isisnews ISIS News Watch\n\ncom.majorityapps.exoticflowers Repacked “Exotic Flowers” from Google\nPlay.\n\ncom.ssd.vipre Fake security product\n\ncom.apps.amaq Amaq News Agency Application\n\nair.com.arsnetworks.poems.moshiri Persian poems\n\nair.com.arsnetworks.poems.sohrab Persian poems\n\ncom.nidayehaq Religious application\n\ncom.ramadan.kareem.app Ramadan Pictures\n\nir.hukmi.moanzalalloh “Judgment by what Alla has revealed”\n\norg.microemu.android.ir.mjface.toolkit.Midlet “Omar Farouq”\n\ncom.hamgaam.shahnamef “The Book of Kings”\n\nir.korosh.kabir “Cyrus the Great”\n\nir.hawijapp.myhafez Persian poems\n\ncom.kabood.koroshkabir “Cyrus the Great”\n\ncom.andriod.browser Fake “mobile secured browser”\n\n\n-----\n\nir.mservices.market Application market for Android\n\ncom.mohsen Mohsen restaurant mimic\n\n### Appendix 2 – IOCs:\n\nb1df569ad4686e16ec0c661733d56778f59cdb78207a3c2ad66df9b9828c84ab\n\n68a1452172636b081873b9f7c1ae3794035c4ff50d5538b656caf07016b74d07\n\n02d6ca25b2057f181af96d2837486b26231eaa496defdf39785b5222014ef209\n\n290d70472f4b00a1cf01f5c1311aacffaa39057bb1c826c99419999ccef7ae53\n\n039fc34ace1012eff687f864369540b9085b167f0d66023f3b94f280a7fdf8b7\n\n7f603216a0a7bae2c8cec65a800608ac22cfff8cd98c699677e44d36267a9798\n\n54479fbb2f3c8c16714e526925537e738b1b586310c8d15ce10f33327392e879\n\nd90168d1f3568b5909d2e14288300ede298f6c663b51e883e7eb5d8d70277423\n\nccef7ca705b899fe337eda462d38216c414c0cfe41052dec102c8f6d8876ad8a\n\n8324266e25d6a8dbc6e561e035b9e713c3bd339ba9bb5e5b9d4f0821a0262510\n\n3d41830f943c31f69eb6ed7804cc18b289ba2172d258bd118a8503d120318d63\n\n53e00f1e8d2d6aa2d8a0eda2bf2d924fbc6f67db12ac3238d7c4b4520de7fadc\n\nca730b8b355e44919629a958d940e77eb1b4cd0c1bbe2ab94a963222f2723f57\n\nf1728125f37ca8738b19b418a3fe896e9bdcde5aed6559db3eea55f4e17602c4\n\n5787723b2221464337e6bbe4200aab912f1f711447224e4e6c4c96c451ff41bf\n\ne069bcd473c83b937db46243dd53e8856b5be6d0ade880c0ec61107054a7e32e\n\n48d642c2c77eeabff36249c59ce397a9ee5f3d825d735f839c5c05939499406e\n\n1dc12c6a44852023f1687f9f31a9e58dc7ce96d492a58a3e87dec5aa8f45ba92\n\n4580980a6fb65ea1501464d36306c24d341189e84500562c5a3ac844f9a79525\n\na5b5f6027b463d82fded3c38153086d5accc466df33123070ea541e62124b943\n\na3797856766fef6651f8c679febd12378fc3196c5cc74923d90377045107700d\n\n9156f5bd322306c9038a3bc830e53e7b13c272e121fb70b3b8d7d9968fb97e4f\n\n88d03e683c01d9979c752844579bd367892edbbdc876b03df8e1d09412f761c5\n\nbd7779e6100e07b3eae67bfcdc53f1f08468651240229e284cca60e2b953496b\n\n62a48bcb2d2f22017ce67b853654903464c19892a07a3c0ca020048cb049f0cd\n\ne7a6925f0fe03108b965a3cf9f2fe1204add376ecde68bafd872e9d828d762e9\n\n53ed971b48ae0b2ff6bcdd7bf4e8970d6eac3e7cdcd3ae6fa05860b9e5ac58ee\n\nfirmwaresystemupdate[.]com\n\nappsoftupdate[.]com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.02.08.Domestic_Kitten/research.checkpoint.com-Domestic%20Kitten%20%20An%20Inside%20Look%20at%20the%20Iranian%20Surveillance%20Operations.pdf"
    ],
    "report_names": [
        "research.checkpoint.com-Domestic Kitten  An Inside Look at the Iranian Surveillance Operations"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "30f6ddb3-f5aa-4b78-a1a5-e37c42b2c560",
            "created_at": "2022-10-25T16:07:23.544297Z",
            "updated_at": "2025-03-27T02:02:09.855532Z",
            "deleted_at": null,
            "main_name": "Domestic Kitten",
            "aliases": [
                "APT-C-50",
                "Bouncing Golf"
            ],
            "source_name": "ETDA:Domestic Kitten",
            "tools": [
                "FurBall",
                "GolfSpy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "44d5df14-6a25-41d6-a54c-7c7ebac358cf",
            "created_at": "2023-01-06T13:46:38.817312Z",
            "updated_at": "2025-03-27T02:00:02.926727Z",
            "deleted_at": null,
            "main_name": "Domestic Kitten",
            "aliases": [
                "Bouncing Golf",
                "APT-C-50"
            ],
            "source_name": "MISPGALAXY:Domestic Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1612989316,
    "ts_modification_date": 1612989316,
    "files": {
        "pdf": "https://archive.orkl.eu/bcc2ff0e9e6bfbc5b2d54610dede3be8a49f1331.pdf",
        "text": "https://archive.orkl.eu/bcc2ff0e9e6bfbc5b2d54610dede3be8a49f1331.txt",
        "img": "https://archive.orkl.eu/bcc2ff0e9e6bfbc5b2d54610dede3be8a49f1331.jpg"
    }
}