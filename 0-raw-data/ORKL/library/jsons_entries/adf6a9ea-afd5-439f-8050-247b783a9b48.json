{
    "id": "adf6a9ea-afd5-439f-8050-247b783a9b48",
    "created_at": "2023-01-12T15:07:35.304974Z",
    "updated_at": "2025-03-27T02:06:11.407369Z",
    "deleted_at": null,
    "sha1_hash": "95d7278aa77d34652722d4d3869a93c0a1e5ca4b",
    "title": "2020-12-13 - Defender Control",
    "authors": "",
    "file_creation_date": "2022-05-28T18:02:47Z",
    "file_modification_date": "2022-05-28T18:02:47Z",
    "file_size": 329214,
    "plain_text": "# Defender Control\n\n**thedfirreport.com/2020/12/13/defender-control/**\n\nDecember 13, 2020\n\n### Defender Control is a free software utility we’ve come across in various intrusions. The creators describe it by saying the following:\n\n What is certain however is that it [Windows Defender] will annoy users who want to disable it permanently on the computer they are working on. Defender Control is a small Portable freeware which will allow you to disable Windows Defender in Windows 10 completely.\n\n While we have not seen this in many of our recent intrusions with big game ransomware, it is common among the smaller players. Those like Dharma, Phobos, and Crysis. In our experience, these groups’ main point of entry tends to be exposed RDP. After gaining access, these threat actors often do not take the time or effort to fully scope, or compromise a domain before ransoming, usually a single system. We’ve seen these threat actors get blocked by Defender and then minutes later Defender Control gets copied over and run.\n\n Defender Control is two files, which are a portable executable and a configuration file.\n\n Defender Control can be run via GUI or command line\n\n\n-----\n\n### This is an up to date Windows 10 system, with all Windows Defender controls active.\n\n Let’s click Disable Windows Defender.\n\n\n-----\n\n### We can now see that the entire menu has vanished, and Windows tells you that the Organization is managing Defender.\n\n## MITRE ATT&CK\n\n### Defense Evasion – T1562.001\n\n Defender Control sets a couple registry values to disable Defender including this one:\n```\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware DWORD\n(0x00000001)\n\n```\n\n-----\n\n### Defender Control also sets this value to disable the startup of the Defender service:\n```\nHKLM\\System\\CurrentControlSet\\Services\\WinDefend\\Start DWORD (0x00000003)\n\n Which creates:\n\n Defender Control also unloads the Defender driver:\n\n```\n\n-----\n\n### Here, we can see Defender Control turning off Defender via Local Group Policy Editor:\n\n Group\n\n Policy Management Editor> Administrative templates > Windows components > Microsoft Defender Antivirus > Turn off Microsoft Defender Antivirus Which creates:\n\n\n-----\n\n### Version 1.6 Date: 12.10.2020\n\n Enjoy our report? Please consider donating $1 or more to the project using Patreon. Thank you for your support!\n\n## IOCs\n\n### File Hashes\n\n\n-----\n\n```\nDefenderControl.exe\nMD5 3a24a7b7c1ba74a5afa50f88ba81d550\nSHA-1 5da4de1dbba55774891497297396fd2e5c306cf5\nSHA-256 a201f7f81277e28c0bdd680427b979aee70e42e8a98c67f11e7c83d02f8fe7ae\nVhash 085046655d157220b02002300a66z1410043ze2za0030e039z\nAuthentihash 93c6e1f59f79d000ebad4873c57e716394e359526e241445e0c75d4494b03be2\nImphash aaaa8913c89c8aa4a5d93f06853894da\nRich PE header hash 09983e500a3e996337593d644224f769\nSSDEEP\n12288:baWzgMg7v3qnCi3ErQohh0F4JCJ8lnydQ79QudhzYOejoiQv2ju8S0c/J:uaHMv6CDrjRnydQu+ejMZ1\nTLSH T14005C012B3D680B6D99378B5297BE32BEB3575194327C4C7A7E02F729F111409B3A3A1\nDefenderControl.ini\nMD5 4416f7bea63b8af85f5590a3bdf6261b\nSHA-1 549b43af5454b32848f500dcbea39acc49be0498\nSHA-256 84caed9ee666f5004481e2b6e3233f37adf8106f6d821085caa4dcbd1221b876\nSSDEEP\n384:J9VBz+Kj3ehWYn/qmt4yJbo3nBaY+BvroUVB5j1vIdo7apRVWpIpClFG:J5BOhJ/nRCaYczoUM6apHd\nTLSH T15233001A46EA621AF2F35B10E6F01F734B36BD95687C904C0ED55E8C18E0E609562FFB\n\n### YARA\n\n```\n\n-----\n\n```\n/\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2020-12-05\nIdentifier: DefenderControl\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule DefenderControl_Executable {\nmeta:\ndescription = \"DefenderControl - file DefenderControl.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-12-05\"\nhash1 = \"a201f7f81277e28c0bdd680427b979aee70e42e8a98c67f11e7c83d02f8fe7ae\"\nstrings:\n$s1 = \"/AutoIt3ExecuteScript\" fullword wide\n$s2 = \"/AutoIt3ExecuteLine\" fullword wide\n$s3 = \"SCRIPTNAME\" fullword wide /* base64 encoded string '[email protected]' */\n$s4 = \"PROCESSGETSTATS\" fullword wide\n$s5 = \"WINGETPROCESS\" fullword wide\n$s6 = \"SHELLEXECUTE\" fullword wide\n$s7 = \"SHELLEXECUTEWAIT\" fullword wide\n$s8 = \"#NoAutoIt3Execute\" fullword wide\n$s9 = \"PROCESSWAIT\" fullword wide\n$s10 = \"PROCESSEXISTS\" fullword wide\n$s11 = \"HTTPSETUSERAGENT\" fullword wide\n$s12 = \"PROCESSSETPRIORITY\" fullword wide\n$s13 = \"PROCESSORARCH\" fullword wide\n$s14 = \"PROCESSCLOSE\" fullword wide\n$s15 = \"PROCESSWAITCLOSE\" fullword wide\n$s16 = \"PROCESSLIST\" fullword wide\n$s17 = \"SENDCOMMANDID\" fullword wide\n$s18 = \"FILEGETVERSION\" fullword wide\n$s19 = \"LOGONDOMAIN\" fullword wide\n$s20 = \"INETGETBYTESREAD\" fullword wide\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"aaaa8913c89c8aa4a5d93f06853894da\" or all of them )\n}\nrule DefenderControl_Config_File {\nmeta:\ndescription = \"DefenderControl - file DefenderControl.ini\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-12-05\"\nhash1 = \"84caed9ee666f5004481e2b6e3233f37adf8106f6d821085caa4dcbd1221b876\"\nstrings:\n$s1 = \"15=\\\"&Commando Lijn Info\\\"\" fullword wide\n$s2 = \"15=\\\"&Command Line Info\\\"\" fullword wide\n\n```\n\n-----\n\n```\n$s3 15 \\ &Info de ligne de commande\\ fullword wide\n$s4 = \"06=\\\"La protezione in tempo reale \" fullword wide\n$s5 = \"pt logu start\" fullword wide\n$s6 = \"o em Tempo Real est\" fullword wide\n$s7 = \"06=\\\"La protection en temps r\" fullword wide\n$s8 = \"15=\\\"&Info Linea di Comando\\\"\" fullword wide\n$s9 = \"15=\\\"&Informatii Comenzi de Linie\\\"\" fullword wide\n$s10 = \"11=\\\"&Defender postavke\\\"\" fullword wide\n$s11 = \"15=\\\"&Eingabeaufforderungsinformation\\\"\" fullword wide\n$s12 = \"01=\\\"miestas.org\\\"\" fullword wide\n$s13 = \"02=\\\"Windows Defender is running\\\"\" fullword wide\n$s14 = \"05=\\\"Windows Defender Service nicht gefunden\\\"\" fullword wide\n$s15 = \"05=\\\"Windows Defender service niet gevonden\\\"\" fullword wide\n$s16 = \"05=\\\"Service Windows Defender introuvable\\\"\" fullword wide\n$s17 = \"nea de comandos\\\"\" fullword wide\n$s18 = \"15=\\\"&Inf. da linha de comando\\\"\" fullword wide\n$s19 = \"; www.sordum.org\" fullword wide\n$s20 = \"11=\\\"&Configura\" fullword wide\ncondition:\nuint16(0) == 0xfeff and filesize < 100KB and\n8 of them\n}\n\n### Internal case 1011\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-13 - Defender Control.pdf"
    ],
    "report_names": [
        "2020-12-13 - Defender Control.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536055,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1653760967,
    "ts_modification_date": 1653760967,
    "files": {
        "pdf": "https://archive.orkl.eu/95d7278aa77d34652722d4d3869a93c0a1e5ca4b.pdf",
        "text": "https://archive.orkl.eu/95d7278aa77d34652722d4d3869a93c0a1e5ca4b.txt",
        "img": "https://archive.orkl.eu/95d7278aa77d34652722d4d3869a93c0a1e5ca4b.jpg"
    }
}