{
    "id": "75b152e1-708f-4649-a461-03c9f1dc3ff0",
    "created_at": "2023-01-12T15:10:50.389611Z",
    "updated_at": "2025-03-27T02:06:05.223161Z",
    "deleted_at": null,
    "sha1_hash": "75ea2c6603e2ff4c29d00452f98b30309204c616",
    "title": "2022-08-24 - Demystifying Qbot Malware",
    "authors": "",
    "file_creation_date": "2022-09-01T10:21:42Z",
    "file_modification_date": "2022-09-01T10:21:42Z",
    "file_size": 2283349,
    "plain_text": "# Demystifying Qbot Malware\n\n**[trellix.com/en-us/about/newsroom/stories/threat-labs/demystifying-qbot-malware.html](https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/demystifying-qbot-malware.html)**\n\n### ARIA Resort & Casino | Las Vegas\n September 27-29, 2022\n\n[Register Now](https://trellix.g2planet.com/xpand_live_2022/register) [Learn More](https://www.trellix.com/en-us/about/events/2022/trellix-xpand-live-2022.html)\n\n## Stories\n\nThe latest cybersecurity trends, best practices,\n\nsecurity vulnerabilities, and more\n\n\n-----\n\nBy [Adithya Chandra and](https://www.trellix.com/en-us/about/newsroom/stories/contributors/adithya-chandra.html) [Sushant Kumar Arya · August 24, 2022](https://www.trellix.com/en-us/about/newsroom/stories/contributors/sushant-kumar-arya.html)\n\n## Executive summary\n\nThe Trellix SecOps Team has observed an uptick in the Qbot malware infections in recent\nmonths. Qbot has been an\nactive threat for over 14 years and continues to evolve, adopting\nnew infection vectors to evade detection mechanisms.\n\nAt Trellix, we are committed to protecting our customers from upcoming and emerging threats\non the their network,\ninclusive of those that are found being exploited in the wild. Trellix\nSecOps strives to build advanced detection\nfeatures, improving product’s overall Threat\nDetection capabilities. Over the next few sections of this blog, we will\nhighlight TTPs of Qbot\nmalware, detection capabilities in Trellix products. and some detection strategies which help\nprotect customers against this and future attacks of similar nature.\n\n## Introduction\n\nQbot, also known as QakBot, QuackBot and Pinkslipbot, is a common trojan malware designed\nto steal passwords. Over\ntime this malware has evolved from simple infostealer malware to an\ninfostealer with a backdoor functionality. The\nmalware has been active since 2008 and is\nprimarily used by financially motivated actors. Qbot actors have also served\nas ‘Initial Access\nBrokers’ to many ransomware partners including REvil/Sodinokibi. In the latest versions of\nQbot\nPayload, we have observed significant changes in its TTPs, including new delivery\nvectors to evade detection\nmechanisms.\n\nIn 2022-Q1&Q2, Trellix has detected ~500K Qbot URLs in FAUDE (FireEye Advanced URL\nDetection Engine) with a peak of\n189,313 URLs in Apr-2022.\n\nFigure 1: Qbot infection trend over Q1-Q2\n\n\n-----\n\nTrellix has been studying this malware and discovered a significant uptick in the spread of Qbot\nmalware over the\nfirst half of 2022 using several new techniques. We put together a\ncomprehensive analysis detailing its TTPs, IOCs,\nDetection & Hunting Schemas and defence\nmechanisms from Trellix products.\n\n## Qbot threat landscape\n\nThe Qbot threat landscape with reference to the geopolitical regions and industry verticals has\nchanged from time to\ntime and we have compiled regions and verticals targeted as shown in\nbelow section:\n\nFigure 2: QbBot threat landscape summary\n\n## Infection vector: email\n\nInitially Qbot was distributed by Emotet malware, but currently the major infection vector is\nmalspam email campaigns\nwith multiple variants. Over the next section, we discuss the\nprevalent variants across customers.\n\nFigure 3: Qbot Email (Variant: Schemeless URLs)\n\n\n-----\n\nFigure 4: Qbot Email (Variant: Malicious URLs)\n\nFigure 5: Qbot Email (Variant: Encrypted Malicious Attachment, Thread Hijack)\n\nFigure 6: Qbot Email (Variant: Malicious HTML Attachment)\n\n## MITRE mappings\n\n\n-----\n\n**Attack Behaviour** **Example** **MITRE ATT&CK**\n\n\nMalicious email\nwith an .html\nattachment.\n\nThe .html file opens\nin a browser and\nuses HTML\n_Smuggling to drop_\nan embedded .ZIP\nfile to\nthe hard\ndrive.\n\nPasswordprotected zipped\n_file which contains_\n_an .ISO image._\n\nUser executed\nmalicious Windows\nShortcut, which\nexecutes calc.exe\nfrom mounted ISO\nimage.\n\n_calc.exe loads_\nadversary crafted\nWindowsCodecs\nDLL.\n\n_Calc.exe spawns_\nMicrosoft signed\nbinary\n(RegSvr32.exe) to\nexecutes Qbot dll\n_(loader)_\n\n_RegSvr32.exe(Qbot_\n_loader dll) spawns_\nand injects\n_Explorer. (Recent_\n_versions has seen_\n_injecting to_\n_explorer.exe,_\n_wermgr.exe,_\n_msra.exe etc)_\n\n_Explorer creates_\n_scheduled task_\n\n\nThreat actor lured user to open malicious email\nwith malicious .html attachment.\n\nUser manually click the HTML file from\ndownloads directory.\nProcess: Chrome.exe\nCommandline: --single-argument *.html\nPath:*\\\\User\\\\Downloads\\\\*\n\nUser unzips the password protected zip file\nwhich contain an ISO file.\n\nUser clicks the malicious LNK file from the ISO\n_file._\nAs rest of the items will be hidden, only lnk file\nwill be visible to the user.\n\n_Process: Calc.exe_\n_Sysmon event id: 7_\n_ImageLoaded:_\n_C:\\Users\\User\\Downloads\\..\\WindowsCodecs.dll_\n\n_ParentProcess: Calc.exe_\n_Process: Regsvr32.exe_\n\n_ParentProcess: Regsvr32.exe\nProcess:_\n_Explorer.exe/ wermgr.exe_\n\n_ParentProcess: Explorer.exe_\n_Process:schtasks.exe_\n\n\nInitial Access /\nPhishing (T1566)\n\nDefense Evasion /\nObfuscated Files or\n[Information: HTML](https://attack.mitre.org/techniques/T1027/006/)\nSmuggling\n(T1027.006)\n\nDefense Evasion /\nSubvert Trust Controls:\nMark-of-the-Web\nBypass (T1553.005)\n\nExecution / User\nExecution (T1204.002)\n\nDefense Evasion /\nHijack Execution\nFlow:\nDLL Side-Loading\n(T1574.002)\n\nDefense Evasion /\n[System Binary Proxy](https://attack.mitre.org/techniques/T1218)\nExecution (T1218)\n\nDefense Evasion /\n[Process Injection](https://attack.mitre.org/techniques/T1055)\n(T1055)\n\nPersistence/Scheduled\nTask/Job: [Scheduled](https://attack.mitre.org/techniques/T1053/005/)\nTask\n\n\n-----\n\n_Explorer creates_\n_new registry entries_\n\n_Explorer connects_\n_with C2_\n\n_Explorer executes a_\n_well-known_\n_sequence of Qbot_\n_discovery_\n_commands._\n\n\n_Symon event id: 13_\n_Event Action: Registry Value Set_\n\n_Sysmon event id: 3_\n_Process: Explorer.exe_\n\n_Explorer.exe spawns whoami, arp, ipconfig, net_\n_view, cmd, nslookup, nltest, net share, route,_\n_netstat,\nnet localgroup, qwinsta and other_\n_discovery activities via WMI queries._\n\n\nDefense\n[Evasion/Modify](https://attack.mitre.org/techniques/T1112/)\nRegsitry\n\nSystem Binary Proxy\nExecution/ Command\n& Control\n\nDiscovery / System\n[Information Discovery](https://attack.mitre.org/techniques/T1082)\n(T1082)\n\n\nTable 1: MITRE mappings\n\n## Breaking down the Qbot malware\n\nThe most prevalent way Qbot infects its victims is via email. The emails used in the latest\ncampaign carry an HTML\nfile (TXRTN_2636021.html). The user downloads the HTML\nattachment and opens it in their browser which downloads a\npassword-protected ZIP archive\n(TXRTN_2636021.zip) with an ISO file inside.\n\nFigure 7: The html file renders in the user browser showing the password to open the dropped\nzip file\n\n## HTML smuggling: highly evasive malware delivery technique\n\n(MITRE: [Defense Evasion/Obfuscated Files\nor Information: HTML Smuggling (T1027.006))](https://attack.mitre.org/techniques/T1027/006/)\n\nHTML smuggling is an evasive payload delivery method that helps an attacker smuggle a\npayload past content filters\nand firewalls by hiding malicious payloads inside of seemingly\nbenign HTML files On opening the html file in vscode/ notepad ++ we can easily see how this\n\n\n-----\n\nis being done. There is a very long base64encoded variable that is present in\nthe javascript\nsection of this HTML file. The javascript assembles the zip package and drops it to the device.\n\nFigure 8: HTML content showing the smuggled zip payload\n\nOn Unzipping the ZIP file with the password shown the in html document, user gets the ISO\nfile.\n\nFigure 9: 7zip snip showing the zip file and iso\n\nOn mounting the ISO, user sees only the ‘LNK’(Shortcut) file; the rest of which are hidden.\n\n(MITRE: Defense Evasion/Subvert Trust [Controls: Mark-of-the-Web Bypass (T1553.005))](https://attack.mitre.org/techniques/T1553/005/)\n\n\n-----\n\nFigure 10: Lnk File shown to User\n\nOn unpacking this ISO, there are 4 files inside of it as shown below. The ISO contains a .LNK\nfile(shortcut),\ncalc.exe (Windows Calculator), and two DLL files, namely WindowsCodecs.dll\nand Qbot payload named\n102755.dll\n\nFigure 11: ISO contents showing dll’s, lnk file and calc.exe\nThe user clicking the shortcut file triggers the Qbot malware infection by executing the\n‘calc.exe’ through the\nCommand Prompt.\n\n\n-----\n\n-----\n\nFigure 12: The lnk file properties shows the target with which it is associated\n\n## Why a Windows 7 calculator?\n\nDLL Sideloading:\n\n(MITRE: [Defense Evasion/Hijack\nExecution Flow: DLL Side-Loading (T1574.002))](https://attack.mitre.org/techniques/T1574/002/)\n\nWindows allows applications to load DLLs at runtime. Applications can specify the location of\nDLLs to load by\nspecifying a full path, using DLL redirection, or by using an application\nmanifest. If none of these methods are used,\nit attempts to locate the DLL by searching a\npredefined set of directories in a set order.\n\nWhen the shortcut loads, the Windows 7 Calculator, it automatically searches for and attempts\nto load the legitimate\nWindowsCodecs DLL file. However, it does not check for the DLL in\ncertain hard coded paths and will load any DLL file\nwith the same name if placed in the same\nfolder as the Calc.exe executable.\n\nIn the below snip, you can see that Calc.exe was placed in the desktop path and executed.\nOnce it starts execution,\nit searches and loads WindowsCodecs DLL. However, the DLL was\nnot present in the desktop path, hence it shows in\n‘Result’ tab as “NAME NOT FOUND”.\n\nFigure 13: Calc.exe sideloading windowscodecs.dll\nThis doesn’t work anymore with the Windows 10 version of the calculator application. Hence\nthe threat actors behind\nQbot, bundled Windows 7 calc.exe along with this.\n\nNow What?\n\nThe attacker takes advantage of this flaw by creating their own malicious WindowsCodecs.dll\nfile that launches the\nother dll file, which is nothing but the QuakBot malware(loader module).\nThus, by launching Qbot through a trusted\nprogram like the Windows Calculator, attackers can\neasily fool security analysts and some security software.\n\n\n-----\n\nHow is it so stealthy?\n\nThe bundled calculator app is a legit benign Windows 7 calculator. But with the aforementioned\nflaw, the calculator\nloads the ‘windowscodecs.dll’ from the same directory, which is specifically\ncrafted by the adversary. On executing\nthe calculator, it loads windowscodecs.dll which in turn\nloads the Qbot loader payload via regsvr32.\n\nFigure 14: Windows codecs leveraging regsvr32 via CreateProcessW to load the Qbot loader\nDLL\n\nThis Qbot loader DLL is a x32 bit Delphi compiled binary, with no export functions.\n\nFigure 15: Qbot loader DLL (Delphi compiled 32bit binary)\nBut as it is executed and gets unpacked, the core Qbot payload is a VC (C/C++) compiled\nbinary (DLL) with export\nfunctions.\n\n\n-----\n\nFigure 16: Qbot core module (C/C++ compiled 32bit binary)\n\nOn analyzing this core module further, it does the same checks as seen in previous versions of\nQbot payloads.\n\nBelow shows the malware payload checking for Windows Defender Emulation using WinAPI\nGetFileAttributes\n“C:\\INTERNAL\\__empty”.\n\nFigure 17: Qbot checking GetFileAttributesW\n\nThe payload also uses flag SELF_TEST_1 which appears to be for self-debugging purposes to\ncheck if the machine is\ninfected or not.\n\nFigure 18: Qbot self-check using SELF_TEST_1 flag\n\nAfter the self-check debugging test, the malware creates a new thread and starts its execution.\n\n\n-----\n\nFigure 19: Qbot creating remote thread\n\nLater, this payload module loads/imports DLLs, enumerating the system process along with\nanti-debug checks and\nleading the payload to inject to explorer.exe/wermgr.exe via process\nhollowing.\n\n## How does it gain persistence?\n\nAs Qbot has evolved, it continues to rely on the use of scheduled tasks and registry\nkeys/runkeys for its persistence\nwith variations on its implementation.\n\nAs the core payload gets executed, the Qbot gains its persistence via 3 steps:\n\n1. Copying itself to below mentioned folder:\n\n%AppData%\\Roaming\\Microsoft\\{RandomStrings}\n2. Creating a registry value pointing to the above payload\n3. Scheduled task to launch the loader 102755.dll\n\nFolder Creations:\n\nFigure 20: Folder created in AppData Roaming, dropping DLL’s\n\nDropped DLLs are loaded via regsvr32.exe as shown in below:\n\n\n-----\n\nFigure 21: Executing Dropped DLLs via RegSvr32\n\n## Registry entries:\n\n(MITRE: [Persistence/Defense Evasion/Modify\nRegsitry)](https://attack.mitre.org/techniques/T1112/)\n\nIn the latest payload versions, Qbot has moved from creating its config file in “.dat” format.\nNow, it writes its\ncloned dDLL entry in the victim host along with its botnet/campaign ID as\nencrypted registry keys to the\n‘HKCU\\Software\\Microsoft\\’ Hive.\n\nFigure 22: Registry keys created in HKCU Hive\n\nRegistry entries are encrypted using system dependant password hash, config IDs, etc., which\nupon decrypting reveals\nthe BotID/Campaign ID, time of the infection, DLL loader path, etc.\n\n\n-----\n\nFigure 23: Decrypted registry keys\n\n## Scheduled task persistence:\n\n(MITRE: [Persistence/Scheduled Task/Job:](https://attack.mitre.org/techniques/T1053/005/) Scheduled Task)\n\nOne of the most significant ways payload versions of Qbot differ are their creation of\nScheduled Tasks for\npersistence. Recent Qbot payloads have been seen using random\ngenerated task names during its creations.\n\nThe injected Explorer.exe creates scheduled task leveraging schtasks.exe\n\nFigure 24: Scheduled tasks creation\n\nAbove command is base64decoded and can be decoded which results in below figure:\n\n\n-----\n\nFigure 25: Decoded scheduled task command pointing to loader DLL\n\n## Calling home: C2 communications\n\n(MITRE: [System Binary Proxy Execution/Command & Control)](https://attack.mitre.org/techniques/T1218/)\n\nOnce it executes and successfully infects the victim, it calls home. It pings each of the IPs from\nits hardcoded C2\nlist. As the IP responds, it sends the POST request with the victim\nfingerprinting data.\n\nThe injected process (explorer.exe/ wermgr.exe), pings every one of its IP in the C2 lists\nleveraging wininet,\ndnsapi and sleep function. Sleep function is set so the requests to IPs\naren’t creating bottlenecks in\ncommunication.\n\nFigure 26: wermgr process initiated a C2 connection\n\n\n-----\n\nFigure 27: C2 communications\n\nTo those C2s which responds back to ping requests, the Qbot sends POST requests which\nconsists of victim\nfingerprinting details as seen below:\n\nFigure 28: POST requests to its C2 IP\n\n## Attack flow\n\n\n-----\n\nFigure 29: Infection flow overview\n\n## Appendix\n\nDetection opportunities\n\nThe following sections provide the specific Trellix Products detections, along with custom\nsigma rules and IOCs to\nhelp surface Qbot and related threats.\n\n**Trellix Products** **Detection Signatures**\n\n\n-----\n\n**Trellix Network Security**\n\n**Trellix VX**\n\n**Trellix Cloud MVX**\n\n**Trellix File Protect**\n\n**Trellix Malware Analysis**\n\n**Trellix SmartVision**\n\n**Trellix Email Security**\n\n**Trellix Detection as**\n**Service**\n\n\n**Static:**\n\nFE_Trojan_HTM_Phish_209\n\nFE_Trojan_HTML_Phish_347\n\nFEC_Dropper_HTML_Generic_11\n\nFEC_Dropper_HTML_Generic_13\n\nFE_Loader_Win32_Generic_340\n\nFE_Loader_Win32_Generic_499\n\n**Dynamic:**\n\nSuspicious Codeinjection on System Processes\n\nSuspicious Process Schtask Activity\n\nSuspicious Dllloaded Regsvr on Dropped Dll\n\nSuspicious Codeinjection on Known Benign File Location\n\nSuspicious Codeinjection Activity\n\nSuspicious File Dropped Dll Executed\n\nMalicious Trojan Indicator\n\nMalicious Dropper Indicator\n\n\n**Trellix Endpoint Security**\n**(HX)**\nTrojan.GenericKD.49349603\n\nTrojan.GenericKD.50615557\n\nTrojan.GenericKD.50616470\n\nGeneric.mg.491e9489c9e11f8b\n\nPOSSIBLE INJECTED EXPLORER (METHODOLOGY)\n\nQAKBOT G (FAMILY)\n\n\n-----\n\n**Trellix Helix**\n\n## Helix hunting queries\n\n\nWINDOWS METHODOLOGY [Suspicious ISO mounts]\n\nWINDOWS METHODOLOGY [Suspicious Scheduled tasks]\n\nWINDOWS METHODOLOGY [Regsvr32 -Suspicious child\nprocess]\n\nMALWARE METHODOLOGY [QBot CALC Behaviour]\n\n\nmetaclass:windows ((class=ms_defender category:`advancedhunting-devicefileevents`\n\naction:`filecreated`) OR\n(source:`microsoft-windows-sysmon` eventid=11))\n\nfilename:[`*.html`,`*.zip`,`*.iso`,`*.lnk`]\nfilename:/TXRTN_[0-9]{7}/ ?\n\nOR\n\nmetaclass:windows ((class=ms_defender category:`advancedhunting-devicefileevents`) OR\n(source:`microsoft-windows-sysmon` eventid=[11,23,26]) OR (source:`microsoft-windowssecurity\nauditing`\neventid=4663 category:`file system`) filename:[`*.html`,`*.zip`,`*.iso`,`*.lnk`]\n\nfilename:/TXRTN_[0-9]{7}/ ?\n\n## Custom Sigma rules:\n\ntitle: suspicious DLL SideLoading by calc\n\nstatus: Experimental\n\ndescription: Detects the DLL-Sideloading of windowscodecs.dll by calc.exe.\n\ndate: 04/08/2022\n\nlogsource:\n\nproduct: windows\n\ncategory: image_load\n\ndetection:\n\nselection:\n\n - ImageLoaded|endswith:\n\n - '\\WindowsCodecs.dll'\n\n - Image|endswith:\n\n  - 'calc.exe'\n\nfilter:\n\n - Imageloaded|startswith:\n\n - 'C:\\Windows\\System32\\'\n\n - 'C:\\Windows\\Syswow64\\'\n\n\n-----\n\ncondition: selection and not filter\nfalsepositives:\n\n - Unknown\n\nlevel: high\n\ntags:\n\n - DLL Side-Loading\n\n - T1574.002\n\n=======\n\ntitle: Suspicious calc child process\n\nstatus: Experimental\n\ndescription: Detects the suspicious child process of calc\n\ndate: 04/08/2022\n\nlogsource:\n\ncategory: process_creation\n\nproduct: windows\n\ndetection:\n\nselection:\n\nParentImage|endswith:\n\n  - '\\\\calc.exe'\n\nImage|endswith:\n\n  - '\\\\regsvr32.exe'\n\ncondition: all of them\n\nfalsepositives:\n\n - Unknown\n\nlevel: high\n\ntags:\n\n - SystemBinary Proxy Execution\n\n - T1218.010\n\n=======\n\ntitle: Suspicious process injection to explorer\n\nstatus: Experimental\n\ndescription: Detects the suspicious regsvr32 child process\n\ndate: 04/08/2022\n\nlogsource:\n\ncategory: process_creation\n\nproduct: windows\n\ndetection:\n\n\n-----\n\nselection:\nParentImage|endswith:\n\n  - '\\\\regsvr32.exe'\n\nImage|endswith:\n\n  - '\\\\Explorer.exe'\n\ncondition: all of them\n\nfalsepositives:\n\n - Uknown\n\nlevel: high\n\ntags:\n\n - SystemBinary Proxy Execution\n\n - T1218.010\n\n=======\n\ntitle: Suspicious commands arguments from Explorer\n\nstatus: Experimental\n\ndescription: Detects the suspicious commandlines from explorer\n\ndate: 04/08/2022\n\nlogsource:\n\ncategory: process_creation\n\nproduct: windows\n\ndetection:\n\nselection:\n\nParentImage|endswith:\n\n  - '\\\\Explorer.exe'\n\ncommandLine|contains:\n\n  - 'whoami /all'\n\n  - 'arp -a'\n\n  - 'ipconfig /all'\n\n  - 'net view /all'\n\n  - 'cmd /c set'\n\n - 'nslookup -querytype=ALL -timeout=10 _ldap._tcp.dc._msdcs'\n\n  - 'nltest /domain_trusts /all_trusts'\n\n  - 'net share'\n\n  - 'netstat -nao'\n\n  - 'net localgroup'\n\n  - 'qwinsta'\n\ncondition: all of them\n\nfalsepositives:\n\n - Uknown\n\nlevel: high\n\n\n-----\n\ntags:\n - System Information Discovery\n\n - T1082\n\n=======\n\ntitle: Suspicious commands arguments from Wermgr.exe\n\nstatus: Experimental\n\ndescription: Detects the suspicious commandlines from wermgr.exe\n\ndate: 04/08/2022\n\nlogsource:\n\ncategory: process_creation\n\nproduct: windows\n\ndetection:\n\nselection:\n\nParentImage|endswith:\n\n  - '\\\\Wermgr.exe'\n\ncommandLine|contains:\n\n  - 'whoami /all'\n\n  - 'arp -a'\n\n  - 'ipconfig /all'\n\n  - 'net view /all'\n\n  - 'cmd /c set'\n\n - 'nslookup -querytype=ALL -timeout=10 _ldap._tcp.dc._msdcs'\n\n  - 'nltest /domain_trusts /all_trusts'\n\n  - 'net share'\n\n  - 'netstat -nao'\n\n  - 'net localgroup'\n\n  - 'qwinsta'\n\ncondition: all of them\n\nfalsepositives:\n\n - Uknown\n\nlevel: high\n\ntags:\n\n - System Information Discovery\n\n - T1082\n\n=====\n\n\n-----\n\ntitle: Explorer Initiated a network Connection\nstatus: experimental\n\ndescription: |\n\nAdversaries may abuse explorer.exe to proxy execution of malicious payloads and\nconnect with C2.\n\nreferences:\n\ndate: 04/08/2022\n\nlogsource:\n\ncategory: network_connection\n\nproduct: windows\n\ndetection:\n\nselection:\n\nInitiated: 'true'\n\nImage|endswith: '\\explorer.exe'\n\ncondition: selection\n\nfalsepositives:\n\n - Legitimate explorer.exe connections over networks\n\nlevel: medium\n\ntags:\n\n - Defense Evasion\n\n - T1218.007\n\n=====\n\ntitle: WerMgr Initiated a Network Connection\n\nstatus: experimental\n\ndescription: |\n\nAdversaries may abuse wermgr.exe to proxy execution of malicious payloads and\nconnect with C2.\n\nreferences:\n\ndate: 04/08/2022\n\nlogsource:\n\ncategory: network_connection\n\nproduct: windows\n\ndetection:\n\nselection:\n\nInitiated: 'true'\n\nImage|endswith: '\\wermgr.exe'\n\ncondition: selection\n\nfalsepositives:\n\n - Legitimate wermgr.exe connections over networks\n\n\n-----\n\nlevel: medium\ntags:\n\n - Defense Evasion\n\n - T1218.007\n\n## IOCs:\n\nFiles\n\n**FileName: TXRTN_2636021.html**\n\n**Hash:5cb20a0bfc5e3e2ae8398b1840adf7ae**\n\n— —\n\n**FileName:TXRTN_2636021.iso**\n\n**Hash:17be394b5cd6d74c3709e39f02cd1aa3**\n\n— —\n\n**FileName: WindowsCodecs.dll**\n\n**Hash:491e9489c9e11f8b9d3d77239559a194**\n\n— —\n\n**FileName: 102755.dll**\n\n**Hash:217f7ddedf40dbe456ce13bf01bd74fc**\n\n— —\n\n**FileName: zhujpga.dll/ mfvffncbov.dll (cloned dll’s)**\n\n**Hash:217f7ddedf40dbe456ce13bf01bd74fc**\n\n## Network communications\n\nhttp://94.59.15.56:2222\n\nhttp://94.59.15.204:2222\n\nhttp://94.59.15.166:2222\n\nhttp://94.36.193.62:2222\nhttp://94.36.193.38:2222\n\nhttp://94.36.193.154:2222\n\nhttp://93.48.80.99:995\n\nhttp://93.48.80.92:995\n\nhttp://93.48.80.238:995\n\nhttp://92.132.132.196:2222\n\nhttp://92.132.132.160:2222\n\nhttp://92.132.132.112:2222\n\n\n-----\n\nhttp://89.211.209.7:2222\nhttp://89.211.209.252:2222\n\nhttp://89.211.209.156:2222\n\nhttp://86.97.246.37:1194\n\nhttp://86.97.246.230:1194\n\nhttp://86.97.246.217:2222\n\nhttp://86.97.246.171:1194\n\nhttp://86.97.246.157:1194\n\nhttp://86.97.246.143:2222\n\nhttp://86.97.246.133:2222\n\nhttp://86.213.75.210:2078\n\nhttp://86.213.75.17:2078\n\nhttp://86.213.75.13:2078\n\nhttp://84.241.8.223:32103\n\nhttp://84.241.8.203:32103\n\nhttp://84.241.8.149:32103\n\nhttp://84.241.8.131:32103\n\nhttp://81.158.239.89:2078\n\nhttp://81.158.239.219:2078\n\nhttp://81.158.239.163:2078\n\nhttp://81.158.239.10:2078\n\nhttp://80.11.74.71:2222\n\nhttp://80.11.74.238:2222\n\nhttp://80.11.74.179:2222\n\nhttp://80.11.74.146:2222\n\nhttp://74.14.5.212:2222\n\nhttp://74.14.5.178:2222\n\nhttp://72.252.157.62:995\n\nhttp://72.252.157.250:990\n\nhttp://72.252.157.245:990\n\nhttp://72.252.157.233:995\n\nhttp://72.252.157.212:990\n\nhttp://72.252.157.106:995\n\nhttp://70.51.137.22:2222\n\nhttp://70.51.137.209:2222\n\nhttp://70.51.137.204:2222\n\nhttp://70.51.137.15:2222\n\nhttp://67.69.166.80:2222\n\nhttp://67.69.166.36:2222\n\nhttp://67.69.166.245:2222\n\nhttp://63.143.92.90:995\n\nhttp://63.143.92.26:995\n\nhttp://63.143.92.221:995\n\n\n-----\n\nhttp://63.143.92.15:995\nhttp://46.100.25.55:61202\n\nhttp://46.100.25.153:61202\n\nhttp://46.100.25.145:61202\n\nhttp://45.46.53.7:2222\n\nhttp://45.46.53.77:2222\n\nhttp://45.46.53.221:2222\n\nhttp://40.134.246.56:995\n\nhttp://40.134.246.216:995\n\nhttp://40.134.246.149:995\n\nhttp://39.57.56.30:995\n\nhttp://39.57.56.206:995\n\nhttp://39.57.56.201:995\n\nhttp://39.53.124.45:995\n\nhttp://39.53.124.148:995\n\nhttp://39.53.124.135:995\n\nhttp://39.52.59.37:995\n\nhttp://39.52.59.234:995\n\nhttp://39.52.59.184:995\n\nhttp://39.52.221.84:995\n\nhttp://39.52.221.39:995\n\nhttp://39.52.221.205:995\n\nhttp://39.49.41.55:995\n\nhttp://39.49.41.28:995\n\nhttp://39.49.41.181:995\n\nhttp://39.44.60.65:995\n\nhttp://39.44.60.51:995\n\nhttp://39.44.60.187:995\n\nhttp://39.41.16.33:995\n\nhttp://39.41.16.31:995\n\nhttp://39.41.16.109:995\n\nhttp://38.70.253.70:2222\n\nhttp://38.70.253.56:2222\n\nhttp://38.70.253.213:2222\n\nhttp://38.70.253.154:2222\n\nhttp://37.208.131.96:50010\n\nhttp://37.208.131.249:50010\n\nhttp://37.208.131.230:50010\n\nhttp://37.208.131.224:50010\n\nhttp://37.186.58.41:995\n\nhttp://37.186.58.18:995\n\nhttp://37.186.58.153:995\n\nhttp://32.221.224.83:995\n\n\n-----\n\nhttp://32.221.224.7:995\nhttp://32.221.224.201:995\n\nhttp://32.221.224.102:995\n\nhttp://24.178.196.74:2222\n\nhttp://24.178.196.228:2222\n\nhttp://24.178.196.227:2222\n\nhttp://24.178.196.177:2222\n\nhttp://24.158.23.45:995\n\nhttp://24.158.23.219:995\n\nhttp://24.158.23.204:995\n\nhttp://24.158.23.104:995\n\nhttp://217.165.157.245:995\n\nhttp://217.165.157.243:995\n\nhttp://217.165.157.121:995\n\nhttp://217.128.122.182:2222\n\nhttp://217.128.122.112:2222\n\nhttp://217.128.122.108:2222\n\nhttp://201.172.23.70:2222\n\nhttp://201.172.23.6:2222\n\nhttp://201.172.23.174:2222\n\nhttp://201.172.23.102:2222\n\nhttp://196.203.37.228:80\n\nhttp://196.203.37.212:80\n\nhttp://196.203.37.190:80\n\nhttp://196.203.37.106:80\n\nhttp://186.90.153.39:2222\n\nhttp://186.90.153.237:2222\n\nhttp://186.90.153.182:2222\n\nhttp://186.90.153.116:2222\n\nhttp://182.191.92.39:995\n\nhttp://182.191.92.238:995\n\nhttp://182.191.92.221:995\n\nhttp://177.94.65.55:32101\n\nhttp://177.94.65.158:32101\n\nhttp://177.94.65.146:32101\n\nhttp://177.189.180.240:32101\n\nhttp://177.189.180.207:32101\n\nhttp://177.189.180.135:32101\n\nhttp://176.45.218.186:995\n\nhttp://176.45.218.13:995\n\nhttp://176.45.218.125:995\n\nhttp://174.80.15.53:2083\n\nhttp://174.80.15.34:2083\n\n\n-----\n\nhttp://174.80.15.165:2083\nhttp://173.21.10.75:2222\n\nhttp://173.21.10.31:2222\n\nhttp://173.21.10.116:2222\n\nhttp://172.115.177.254:2222\n\nhttps://190.252.242.69:443\n\nhttp://172.115.177.201:2222\n\nhttp://172.115.177.127:2222\n\nhttp://172.115.177.112:2222\n\nhttp://121.7.223.219:2222\n\nhttp://121.7.223.20:2222\n\nhttp://121.7.223.143:2222\n\nhttp://120.150.218.51:995\n\nhttp://120.150.218.202:995\n\nhttp://120.150.218.139:995\n\nhttp://120.150.218.119:995\n\nhttp://111.125.245.20:995\n\nhttp://111.125.245.205:995\n\nhttp://111.125.245.203:995\n\nhttp://108.56.213.36:995\n\nhttp://108.56.213.172:995\n\nhttp://108.56.213.142:995\n\nhttp://106.51.48.3:50001\n\nhttp://106.51.48.248:50001\n\nhttp://106.51.48.139:50001\n\nhttp://104.34.212.96:32103\n\nhttp://104.34.212.33:32103\n\nhttp://104.34.212.152:32103\n\nhttp://103.133.11.48:995\n\nhttp://103.133.11.241:995\n\nhttp://103.133.11.181:995\n\nhttp://103.116.178.228:995\n\nhttp://103.116.178.196:995\n\nhttp://103.116.178.195:995\n\nhttp://101.50.67.85:995\n\nhttp://101.50.67.74:995\n\nhttp://101.50.67.72:995\n\nhttp://100.38.242.94:995\n\nhttp://100.38.242.193:995\n\nhttp://100.38.242.149:995\n\nhttp://100.38.242.134:995\n\nhttp://1.161.79.219:995\n\nhttp://1.161.79.166:995\n\n\n-----\n\nhttp://1.161.79.139:995\nhttps://182.52.159.207\n\nhttps://89.101.97.204\nhttps://86.97.10.196\n\nhttps://108.56.213.172:995\n\nhttps://103.133.11.241:995\n\nhttps://86.97.246.133:2222\n\nhttps://39.41.16.109:995\n\nThe information presented here describes computer security research for educational purposes\nonly and the\nconvenience of Trellix customers. Trellix conducts research in accordance with its\n[Vulnerability Reasonable Disclosure Policy |\nTrellix. Any attempt to recreate part or all of the](https://www.trellix.com/en-us/threat-center/advanced-threat-research/disclosure.html)\nactivities described is solely at the user’s risk, and\nneither Trellix nor its affiliates will bear any\nresponsibility or liability.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-24 - Demystifying Qbot Malware.pdf"
    ],
    "report_names": [
        "2022-08-24 - Demystifying Qbot Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536250,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1662027702,
    "ts_modification_date": 1662027702,
    "files": {
        "pdf": "https://archive.orkl.eu/75ea2c6603e2ff4c29d00452f98b30309204c616.pdf",
        "text": "https://archive.orkl.eu/75ea2c6603e2ff4c29d00452f98b30309204c616.txt",
        "img": "https://archive.orkl.eu/75ea2c6603e2ff4c29d00452f98b30309204c616.jpg"
    }
}