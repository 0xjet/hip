{
    "id": "f7589b91-cbd1-4163-8ee5-ebcf92e0b0d9",
    "created_at": "2024-04-17T02:04:29.111102Z",
    "updated_at": "2025-03-27T02:09:17.795258Z",
    "deleted_at": null,
    "sha1_hash": "a4eba6798499353eeb1112077408b484728aa4c4",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-02-09T15:48:24Z",
    "file_modification_date": "2023-02-09T15:48:24Z",
    "file_size": 589796,
    "plain_text": "# Jolly Jellyfish\n\n### Malware Analysis Report\n\n**Version 2.0**\n\n\n**15[th] December 2022**\n© Crown Copyright 2022\n\n\n-----\n\n## Jolly Jellyfish\n\n##### Non-persistent downloader for shellcode embedded in image files\n\n Executive summary\n\n  - Jolly Jellyfish downloads and executes shellcode, which is hidden in legitimate bitmap image\n(BMP) files.\n\n  - HTTP is used to download image files.\n\n  - Debug information left in the samples suggest the author refers to this malware as\n```\n    fishmaster.\n\n##### Introduction\n\n```\nJolly Jellyfish is a Windows executable which downloads and executes shellcode from a hard-coded\nremote server, using HTTP. Steganography is used to hide the shellcode inside BMP files. Once\nextracted and, where necessary, decoded, the shellcode is a Cobalt Strike stager. This report covers\nthe analysis of multiple related samples, some of which include additional capabilities. No persistence\nis implemented by this malware.\n\n\n-----\n\n##### Malware Details\n\n###### Metadata\n\n**Filename** `abcd461bdb6a6537b7a36848a87b5ea6.virus`\n```\n         Jolly Jellyfish shellcode downloader which also downloads and executes a\n\n```\n**Description**\n```\n         legitimate file\n\n```\n**Size** `393216 bytes`\n**MD5** `abcd461bdb6a6537b7a36848a87b5ea6`\n**SHA-1** `e99d5a620a488133f4da24e1f8d2d5e68542b6f3`\n**SHA-256** `f21a9c69bfca6f0633ba1e669e5cf86bd8fc55b2529cd9b064ff9e2e129525e8`\n**Compile time** `2021-02-26 07:16:23`\n\n**Filename** `Browser_plugin (8).exe`\n```\n         Jolly Jellyfish shellcode downloader, of XOR-obfuscated shellcode,\n\n```\n**Description**\n```\n         additionally displays a message box on execution\n\n```\n**Size** `109568 bytes`\n**MD5** `a241ff3d86925a4a12916b401536b019`\n**SHA-1** `d28eacb1b4d2e9ef54f7dff09ca03a6866fc9184`\n**SHA-256** `a7e9e2bec3ad283a9a0b130034e822c8b6dfd26dda855f883a3a4ff785514f97`\n**Compile time** `2021-03-12 06:25:25`\n\n**Filename** `Browser_Plugin.exe`\n```\n         Jolly Jellyfish shellcode downloader of XOR-obfuscated shellcode,\n\n```\n**Description** `additionally downloads a legitimate file and displays a message box on`\n```\n         execution\n\n```\n**Size** `178688 bytes`\n**MD5** `738f46546f6d4a79e2d917b26bf8a93a`\n**SHA-1** `834e80f6fa9935fd3184c25e4e37b0a068a773ee`\n**SHA-256** `4a43fa8a3305c2a17f6a383fb68f02515f589ba112c6e95f570ce421cc690910`\n**Compile time** `2021-04-06 03:11:40`\n\n**Filename** `bk.exe`\n**Description** `Jolly Jellyfish shellcode downloader`\n**Size** `177152 bytes`\n**MD5** `014dac67e8c32a25ccb024d1d1017b58`\n**SHA-1** `ba5558d79dadc12bbbe07e3444441d51d5e5931e`\n**SHA-256** `0df3b6e2535f8bb564183ab4e5e47d9b30ffc0204cc5bda1bae8984cdc418410`\n**Compile time** `2021-07-02 02:21:50`\n\n|Metadata|Col2|\n|---|---|\n|Filename|abcd461bdb6a6537b7a36848a87b5ea6.virus|\n|Description|Jolly Jellyfish shellcode downloader which also downloads and executes a legitimate file|\n|Size|393216 bytes|\n|MD5|abcd461bdb6a6537b7a36848a87b5ea6|\n|SHA-1|e99d5a620a488133f4da24e1f8d2d5e68542b6f3|\n|SHA-256|f21a9c69bfca6f0633ba1e669e5cf86bd8fc55b2529cd9b064ff9e2e129525e8|\n|Compile time|2021-02-26 07:16:23|\n\n|Filename|Browser_plugin (8).exe|\n|---|---|\n|Description|Jolly Jellyfish shellcode downloader, of XOR-obfuscated shellcode, additionally displays a message box on execution|\n|Size|109568 bytes|\n|MD5|a241ff3d86925a4a12916b401536b019|\n|SHA-1|d28eacb1b4d2e9ef54f7dff09ca03a6866fc9184|\n|SHA-256|a7e9e2bec3ad283a9a0b130034e822c8b6dfd26dda855f883a3a4ff785514f97|\n|Compile time|2021-03-12 06:25:25|\n\n|Filename|Browser_Plugin.exe|\n|---|---|\n|Description|Jolly Jellyfish shellcode downloader of XOR-obfuscated shellcode, additionally downloads a legitimate file and displays a message box on execution|\n|Size|178688 bytes|\n|MD5|738f46546f6d4a79e2d917b26bf8a93a|\n|SHA-1|834e80f6fa9935fd3184c25e4e37b0a068a773ee|\n|SHA-256|4a43fa8a3305c2a17f6a383fb68f02515f589ba112c6e95f570ce421cc690910|\n|Compile time|2021-04-06 03:11:40|\n\n|Filename|bk.exe|\n|---|---|\n|Description|Jolly Jellyfish shellcode downloader|\n|Size|177152 bytes|\n|MD5|014dac67e8c32a25ccb024d1d1017b58|\n|SHA-1|ba5558d79dadc12bbbe07e3444441d51d5e5931e|\n|SHA-256|0df3b6e2535f8bb564183ab4e5e47d9b30ffc0204cc5bda1bae8984cdc418410|\n|Compile time|2021-07-02 02:21:50|\n\n|Filename|x37.bmp|\n|---|---|\n|Description|Jolly Jellyfish payload|\n|Size|800682 bytes|\n|MD5|a8c4ac44a5aa9d22319fe4b20cc5e790|\n|SHA-1|7c348809e99c0be3ba5c122009a2cd15ad50b7bf|\n|SHA-256|f0449c41bc3eebb8ea025fafc5b0cd1fcbe9a2d80c447ecc00cf3cab43e1c311|\n\n\n-----\n\n###### MITRE ATT&CK[®]\n\nThis report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible\nknowledge base of adversary tactics and techniques based on real-world observations.\n\n###### Tactic ID Technique Procedure\n\nDefense [T1497.001](https://attack.mitre.org/techniques/T1497/001) Virtualization/Sandbox Jolly Jellyfish checks the available\nEvasion Evasion: System memory is greater than 1GB, the size of\n\nChecks the disk is greater than 1GB, and the\n\nnumber of logical processors is greater\nthan 0. These checks are designed to\navoid running on a machine with low\nresources, as virtual machines and\nsandboxes are more likely to have low\nresources. If these checks fail the\nprocess will exit before any malicious\nbehaviour occurs, avoiding detection.\n\n[T1497.003](https://attack.mitre.org/techniques/T1497/003/) Virtualization/Sandbox Jolly Jellyfish adds short sleep\nEvasion: Time Based commands throughout execution, which\nEvasion could be an attempt to slow down\n\nexecution enough to evade detection by\nautomated analysis platforms.\n\nCommand and [T1071.001](https://attack.mitre.org/techniques/T1071/001/) Application Layer Jolly Jellyfish downloads shellcode over\nControl Protocol: Web HTTP.\n\nProtocols\n\n[T1001](https://attack.mitre.org/techniques/T1001/) Data obfuscation Some variants of Jolly Jellyfish\ndownload XOR-encoded shellcode.\n\n[T1001.002](https://attack.mitre.org/techniques/T1001/002/) Data obfuscation: Jolly Jellyfish downloads shellcode\nSteganography contained within bitmap image (BMP)\n\nfiles.\n\n|Tactic|ID|Technique|Procedure|\n|---|---|---|---|\n|Defense Evasion|T1497.001|Virtualization/Sandbox Evasion: System Checks|Jolly Jellyfish checks the available memory is greater than 1GB, the size of the disk is greater than 1GB, and the number of logical processors is greater than 0. These checks are designed to avoid running on a machine with low resources, as virtual machines and sandboxes are more likely to have low resources. If these checks fail the process will exit before any malicious behaviour occurs, avoiding detection.|\n||T1497.003|Virtualization/Sandbox Evasion: Time Based Evasion|Jolly Jellyfish adds short sleep commands throughout execution, which could be an attempt to slow down execution enough to evade detection by automated analysis platforms.|\n|Command and Control|T1071.001|Application Layer Protocol: Web Protocols|Jolly Jellyfish downloads shellcode over HTTP.|\n||T1001|Data obfuscation|Some variants of Jolly Jellyfish download XOR-encoded shellcode.|\n||T1001.002|Data obfuscation: Steganography|Jolly Jellyfish downloads shellcode contained within bitmap image (BMP) files.|\n\n\n-----\n\n##### Functionality\n\n###### Overview\n\nJolly Jellyfish downloads a bitmap image file containing embedded shellcode over HTTP and extracts,\ndecodes and executes it. The format is described in the ‘Functionality (Steganography)’ section\nbelow. The malware also employs several techniques to evade detection, which vary across different\nsamples and are described in the ‘Functionality (Defence evasion)’ section of this report.\n\n###### Persistence\n\nThis malware does not implement any persistence mechanisms.\n\n###### Steganography\n\nJolly Jellyfish downloads a file with a ‘.bmp’ file extension, which contains embedded shellcode. The\ndownloaded image is shown below in Figure 3.\n\nFigure 1 shows a legitimate BMP image, which begins with 0x0A bytes of data (corresponding to the\nBMP header), followed by a 4-byte little-endian offset value. In the BMP format specification, this\nvalue is the offset to the start of the pixel array for the image.\n```\nBitmap file format\n00000: 42 4D 46 E2 07 00 00 00 00 00 36 00 00 00 28 00 \n00010: 00 00 F0 02 00 00 E5 00 00 00 01 00 18 00 00 00 \n00020: 00 00 10 E2 07 00 00 00 00 00 00 00 00 00 00 00 \n00030: 00 00 00 00 00 00 FF FF FF FF FF FF FF FF FF FF \n00040: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF \n00050: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF \n00060: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF \n00070: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF \n00080: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF \n00090: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF \n000A0: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF \n000B0: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF\n    Header Offset to pixel array Rest of header Pixels\n\n```\n_Figure 1: BMP file format_\n\n|Bitmap file format|Col2|Col3|Col4|\n|---|---|---|---|\n|00000: 42 4D 46 E2 07 00 00 00 00 00 36 00 00 00 28 00 00010: 00 00 F0 02 00 00 E5 00 00 00 01 00 18 00 00 00 00020: 00 00 10 E2 07 00 00 00 00 00 00 00 00 00 00 00 00030: 00 00 00 00 00 00 FF FF FF FF FF FF FF FF FF FF 00040: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 00050: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 00060: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 00070: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 00080: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 00090: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 000A0: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 000B0: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF||||\n|Header|Offset to pixel array|Rest of header|Pixels|\n\n\n-----\n\nIn the downloaded BMP image, shellcode is embedded in, and extracted from, this pixel array by\nreading every fourth byte, as shown in Figure 2. The shellcode is always null-terminated and has a\nmaximum size of 1900 bytes.\n```\nBitmap file with embedded data\n00000: 42 4D 46 E2 07 00 00 00 00 00 36 00 00 00 28 00 \n00010: 00 00 F0 02 00 00 E5 00 00 00 01 00 18 00 00 00 \n00020: 00 00 10 E2 07 00 00 00 00 00 00 00 00 00 00 00 \n00030: 00 00 00 00 00 00 FF FF FF C0 FF FF FF DE FF FF\n00040: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF\n00050: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF\n00060: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF\n00070: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF\n00080: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF\n00090: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF \n000A0: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF \n000B0: FF C0 FF FF FF DE FF FF FF C0 FF FF FF 00 FF FF\n   Header Offset to pixel Rest of header Pixels Embedded data\n            array\n\n```\n_Figure 2: BMP file format with embedded data_\n\nDue to the comparatively small number of pixels affected by this encoding method, any difference\nfrom a legitimate image is likely to be hard to notice unless looked for. Figure 3 shows the modified\nimage, and Figure 4 shows a closeup of a section containing embedded data.\n\n|Bitmap file with embedded data|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|00000: 42 4D 46 E2 07 00 00 00 00 00 36 00 00 00 28 00 00010: 00 00 F0 02 00 00 E5 00 00 00 01 00 18 00 00 00 00020: 00 00 10 E2 07 00 00 00 00 00 00 00 00 00 00 00 00030: 00 00 00 00 00 00 FF FF FF C0 FF FF FF DE FF FF 00040: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF 00050: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF 00060: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF 00070: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF 00080: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF 00090: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF 000A0: FF C0 FF FF FF DE FF FF FF C0 FF FF FF DE FF FF 000B0: FF C0 FF FF FF DE FF FF FF C0 FF FF FF 00 FF FF|||||\n|Header|Offset to pixel array|Rest of header|Pixels|Embedded data|\n\n\n-----\n\n_Figure 3: downloaded BMP image with embedded data_\n\n_Figure 4: downloaded BMP – closeup to highlight embedded data_\n\n###### Shellcode\n\nOnce extracted, the shellcode is a Cobalt Strike stager with the following configuration:\n\n|Type|Values|\n|---|---|\n|C2 server|download.google-images[.]ml|\n|GET URI|/kXe5|\n|User agent|Mozilla/5.0 (Windows NT 6.1; rv24.0) Gecko/20100101 Firefox/24.0|\n\n\n-----\n\n###### Message box\n\nIn some variants of Jolly Jellyfish, a message box is displayed. The samples containing this have\nnames such as ‘Browser_plugin.exe’, indicating that they are intended to be deployed using social\nengineering. The message box is intended to make the target think that a browser plugin was\nsuccessfully updated as shown below. This is further supported by several samples appearing to\nmasquerade as legitimate files, as described in the ‘Functionality (Defence evasion)’ section of this\nreport.\n\nThe hex message data is as follows:\n```\nE4 AF C0 C0 C6 F7 B2 E5 BC FE D2 D1 BE AD B3 C9 B9 A6 B8 FC D0 C2 A3 AC C7\nEB D6 D8 C6 F4 E4 AF C0 C0 C6 F7 A3 A1\n\n```\nThis decodes to simplified Chinese and will be displayed using the MessageBoxA API call.\n\n浏览器插件已经成功更新，请重启浏览器！\n\nThis approximately translates to:\n```\nThe browser plug-in has been successfully updated, please restart the\nbrowser!\n\n###### Defence evasion\n\n Shellcode obfuscation\n```\nIn some samples, the shellcode is XOR-encoded, using a fixed multi-byte key. The keys used in the\nanalysed samples are misgat_mg and mait_mg.\n\n###### Sandbox detection\nThis malware implements some basic anti-sandbox/anti-virtual machine (VM) techniques. This\nincludes checking the physical memory size of the machine exceeds 1GB and that the disk is more\nthan 1GB in size. It also checks that the number of logical processors exceeds zero, although it is\nunknown why this check occurs. If any of these checks fail it will exit.\n\n###### Anti-dynamic analysis\nThere are several sleep commands throughout the code, which slow down execution. This could be\nan attempt to prevent dynamic analysis solutions successfully detecting the malicious behaviour,\nalthough they are likely to be short to be effective.\n\nThere is a one second sleep between each API call involved in allocating and copying memory, as\nwell as various sleep commands with durations between 1-2 seconds throughout each of the\nanalysed samples.\n\n\n-----\n\n###### Masquerading as legitimate file \nSome variants of Jolly Jellyfish download and execute what are apparently legitimate files in addition\nto the shellcode. This may indicate that targets are tricked into executing these files, which\nmasquerade as legitimate applications or resources.\n\nExamples of downloaded, apparently legitimate, files are shown below:\n\n**Download URL** `http://37.61.205[.]212:8880/dow/Aili.pdf`\n**Description** `Chinese and English language form, shown in Figure 5`\n**Size** `103402 bytes`\n**MD5** `a465f18c7e50500c6b6f94741ef56b2f`\n**SHA-1** `b5053ceba7e45c956f601e77ed1ca4546f372221`\n**SHA-256** `17b4cf337cf4fa466a4a1bdc69795c2f96ef7b42464839dafbaf8502e28a3193`\n**Executed?** `No`\n```\n          https://monpass[.]mn/storage/uploads/download_files/Monpass.Client.Inst\n\n```\n**Download URL**\n```\n          all.exe\n          Apparently legitimate application from MonPass, a Mongolian Certificate\n\n```\n**Description**\n```\n          Authority (CA).\n\n```\n**Executed?** `Yes`\n\n|Download URL|http://37.61.205[.]212:8880/dow/Aili.pdf|\n|---|---|\n|Description|Chinese and English language form, shown in Figure 5|\n|Size|103402 bytes|\n|MD5|a465f18c7e50500c6b6f94741ef56b2f|\n|SHA-1|b5053ceba7e45c956f601e77ed1ca4546f372221|\n|SHA-256|17b4cf337cf4fa466a4a1bdc69795c2f96ef7b42464839dafbaf8502e28a3193|\n|Executed?|No|\n\n|Download URL|https://monpass[.]mn/storage/uploads/download_files/Monpass.Client.Inst all.exe|\n|---|---|\n|Description|Apparently legitimate application from MonPass, a Mongolian Certificate Authority (CA).|\n|Executed?|Yes|\n\n\n-----\n\n_Figure 5: PDF form downloaded by Jolly Jellyfish sample_\n\n\n-----\n\n##### Communications\n\nJolly Jellyfish uses a HTTP GET request to retrieve the obfuscated shellcode.\n\n##### Conclusion\n\nJolly Jellyfish is a low sophistication downloader containing some basic anti-dynamic analysis\nfunctionality. It contains easily signatured fixed strings and uses HTTP communications, which\npresent straightforward detection opportunities. Of particular note, however, is the use of\nsteganography to hide the downloaded shellcode in otherwise correctly formatted bitmap files.\n\nThe variation of functionality across different samples suggests that Jolly Jellyfish may often be\ndeployed using social engineering.\n\nThe common PDB path:\n```\nC:\\Users\\test\\Desktop\\fishmaster\\x64\\Release\\fishmaster.pdb\n\n```\nis also used in a different piece of malware that contains a Cobalt Strike Stager. This stager is\nconfigured to connect to the same domain as some Jolly Jellyfish variants.\n\n\n-----\n\n##### Detection\n\n###### Static strings\n\nEach of the analysed samples contain the string BidenHappyHappyHappy. This string doesn’t\nappear to have any practical functionality but can be used as an indicator to detect these binaries.\n\nSeveral samples also contain the PDB path\n```\nC:\\Users\\test\\Desktop\\fishmaster\\x64\\Release\\fishmaster.pdb\n\n###### Indicators of compromise\n\n Type Description Values\n\n```\nURL URL for http://download.google-images[.]ml:8880/downloa/37.bmp\ndownloading\nshellcode\n\nURL URL for http://download.google-images[.]ml:8880/download/x37.bmp\ndownloading\nshellcode\n\nURL URL for http://micsoftin[.]us:2086/dow/83.bmp\ndownloading\nshellcode\n\nURL URL for http://172.20.10[.]6/save.bmp\ndownloading\nshellcode\n\nNB: 172.20.10[.]6 is a private IP. This could be indicative of actor testing or local hosting for lateral\nmovement within a compromised network.\n\n|Type|Description|Values|\n|---|---|---|\n|URL|URL for downloading shellcode|http://download.google-images[.]ml:8880/downloa/37.bmp|\n|URL|URL for downloading shellcode|http://download.google-images[.]ml:8880/download/x37.bmp|\n|URL|URL for downloading shellcode|http://micsoftin[.]us:2086/dow/83.bmp|\n|URL|URL for downloading shellcode|http://172.20.10[.]6/save.bmp|\n\n\n-----\n\n###### Rules and signatures\n\n|Description|Detects the “Bidenhappyhappyhappy” string used by the Jolly Jellyfish malware|\n|---|---|\n|Precision|No false positives seen from Virus Total retrohunts.|\n|Rule type|YARA|\n|rule JollyJellyfish_unique_string_Bidenhappyhappyhappy { meta: author = \"NCSC\" description = \"Detects the “Bidenhappyhappyhappy” string used by the Jolly Jellyfish malware\" date = \"2021-12-15\" hash1 = \"e99d5a620a488133f4da24e1f8d2d5e68542b6f3\" hash2 = \"834e80f6fa9935fd3184c25e4e37b0a068a773ee\" hash3 = \"d28eacb1b4d2e9ef54f7dff09ca03a6866fc9184\" hash4 = \"ba5558d79dadc12bbbe07e3444441d51d5e5931e\" strings: $1 = \"Bidenhappyhappyhappy\" condition: uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x00004550 and all of them }||\n\n|Description|Detects the string displayed by the message box in some variants of Jolly Jellyfish|\n|---|---|\n|Precision|No false positives seen from Virus Total retrohunts.|\n|Rule type|YARA|\n|rule JollyJellyfish_unique_messagebox_display_string { meta: author = \"NCSC\" description = \"Detects the string displayed by the message box in some variants of Jolly Jellyfish\" date = \"2021-12-15\" hash1 = \"d28eacb1b4d2e9ef54f7dff09ca03a6866fc9184\" hash2 = \"834e80f6fa9935fd3184c25e4e37b0a068a773ee\" strings: $popuptext = {E4 AF C0 C0 C6 F7 B2 E5 BC FE D2 D1 BE AD B3 C9 B9 A6 B8 FC D0 C2 A3 AC C7 EB D6 D8 C6 F4 E4 AF C0 C0 C6 F7 A3 A1} condition: uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x00004550 and all of them }||\n\n\n-----\n\n|Description|Detects Jolly Jellyfish check for memory being greater than 1GB|\n|---|---|\n|Precision|No false positives seen from Virus Total retrohunts.|\n|Rule type|YARA|\n|rule JollyJellyfish_check_memory_greater_1gb { meta: author = \"NCSC\" description = \"Detects Jolly Jellyfish check for memory being greater than 1GB\" date = \"2021-12-15\" hash1 = \"e99d5a620a488133f4da24e1f8d2d5e68542b6f3\" hash2 = \"d28eacb1b4d2e9ef54f7dff09ca03a6866fc9184\" hash3 = \"834e80f6fa9935fd3184c25e4e37b0a068a773ee\" hash4 = \"ba5558d79dadc12bbbe07e3444441d51d5e5931e\" strings: $1 = {33 D2 48 8B 44 ?? 38 B9 00 04 00 00 48 F7 F1 33 D2 B9 00 04 00 00 48 F7 F1 89 44 ?? ?? 81 7C ?? ?? 00 04 00 00} $2 = {48 8B 44 ?? 38 48 C1 E8 14 ?? 00 04 00 00} condition: uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x00004550 and any of them }||\n\n|Description|Detects the Jolly Jellyfish PDB string|\n|---|---|\n|Precision|No non-malicious results, but also detects malware containing Cobalt Strike stager|\n|Rule type|YARA|\n|rule JollyJellyfish_pdb_string { meta: author = \"NCSC\" description = \"Detects the Jolly Jellyfish PDB string\" date = \"2021-12-15\" hash1 = \"e99d5a620a488133f4da24e1f8d2d5e68542b6f3\" hash2 = \"834e80f6fa9935fd3184c25e4e37b0a068a773ee\" hash3 = \"d28eacb1b4d2e9ef54f7dff09ca03a6866fc9184\" hash4 = \"ba5558d79dadc12bbbe07e3444441d51d5e5931e\" strings: $pdb = \"fishmaster.pdb\" condition: uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x00004550 and any of them }||\n\n\n-----\n\n|Description|Detects Jolly Jellyfish finding the start address of the shellcode in the downloaded data|\n|---|---|\n|Precision|No false positives seen from virus total retrohunts.|\n|Rule type|YARA|\n|rule JollyJellyfish_identify_shellcode_start_addr { meta: author = \"NCSC\" description = \"Detects Jolly Jellyfish finding the start address of the shellcode in the downloaded data\" date = \"2021-12-15\" hash1 = \"e99d5a620a488133f4da24e1f8d2d5e68542b6f3\" hash2 = \"d28eacb1b4d2e9ef54f7dff09ca03a6866fc9184\" hash3 = \"834e80f6fa9935fd3184c25e4e37b0a068a773ee\" hash4 = \"ba5558d79dadc12bbbe07e3444441d51d5e5931e\" strings: $1 = {48 89 84 24 ?? 00 00 00 48 8B 84 24 ?? 00 00 00 8B 40 0A 48 8B 4C 24 ?? 48 8D 44 01 03} $2 = {8B 43 0A 48 83 C0 03 48 03 D8} condition: uint16(0) == 0x5A4D and uint32(uint32(0x3c)) == 0x00004550 and any of them }||\n\n\n-----\n\n#### Credits Disclaimer\n\n\nSecureworks for sharing a copy of the\ndownloaded Bitmap file.\n\n\nThis report draws on information derived from\nNCSC and industry sources. Any NCSC\nfindings and recommendations made have not\nbeen provided with the intention of avoiding all\nrisks and following the recommendations will\nnot remove all such risk. Ownership of\ninformation risks remains with the relevant\nsystem owner at all times.\n\nThis information is exempt under the Freedom\nof Information Act 2000 (FOIA) and may be\nexempt under other UK information\nlegislation.\n\nRefer any FOIA queries to\nncscinfoleg@ncsc.gov.uk.\n\nAll material is UK Crown Copyright ©\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/jolly-jellyfish/NCSC-MAR-Jolly-Jellyfish.pdf"
    ],
    "report_names": [
        "NCSC-MAR-Jolly-Jellyfish.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1713319469,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1675957704,
    "ts_modification_date": 1675957704,
    "files": {
        "pdf": "https://archive.orkl.eu/a4eba6798499353eeb1112077408b484728aa4c4.pdf",
        "text": "https://archive.orkl.eu/a4eba6798499353eeb1112077408b484728aa4c4.txt",
        "img": "https://archive.orkl.eu/a4eba6798499353eeb1112077408b484728aa4c4.jpg"
    }
}