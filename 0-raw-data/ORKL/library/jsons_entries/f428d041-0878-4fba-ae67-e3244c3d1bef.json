{
    "id": "f428d041-0878-4fba-ae67-e3244c3d1bef",
    "created_at": "2023-01-12T15:03:08.879686Z",
    "updated_at": "2025-03-27T02:15:45.448031Z",
    "deleted_at": null,
    "sha1_hash": "11a84499eb313e34bf11122c8977728cb872a248",
    "title": "2018-04-17 - Decoding network data from a Gh0st RAT variant",
    "authors": "",
    "file_creation_date": "2022-10-02T12:18:55Z",
    "file_modification_date": "2022-10-02T12:18:55Z",
    "file_size": 412384,
    "plain_text": "# Decoding network data from a Gh0st RAT variant\n\n**[research.nccgroup.com/2018/04/17/decoding-network-data-from-a-gh0st-rat-variant/](https://research.nccgroup.com/2018/04/17/decoding-network-data-from-a-gh0st-rat-variant/)**\n\nApril 17, 2018\n\nDuring a forensic investigation in March 2018 we were able to retrieve some files which appeared to be\nlinked with a well-known group named Iron Tiger.\n\nFrom our research, we believe that the perpetrator hasn’t shown any advanced technical capabilities in\nthis attack. In fact, the main goal was to mine cryptocurrency. During the investigation we found several\ntools such as password dumpers, Monero cryptocurrency miners, portable executable (PE) injectors and a\nmodified version of Gh0st RAT. Even though Bitdefender and TrendMicro have published reports [1] [2]\ndescribing some of the tools used by the group, we were not able to find any references to this specific\nmodified version of Gh0st RAT. Therefore, the purpose of this blog is to briefly describe the modified Gh0st\nRAT version that is used by the group.\n\n## The malicious payload\n\nFirstly, a malicious executable file is executed which will drop a batch file (install.bat) and a cabinet file\n(data.cab) under a new folder in C:\\ProgramData with a random name. The cabinet file includes two files:\nthe malicious shellcode which is partially encrypted and a Dynamic-link library (DLL) which will execute the\nmalicious shellcode. The malicious executable file will then execute the batch file, which will decompress\nand execute the DLL file. Persistence is achieved by creating a new service or a new registry key,\ndepending on the privileges that the malware has.\n\nOnce the execution is passed to the shellcode, it will decrypt the rest of the encrypted data using a single\nbyte as the key in an eXclusive OR (XOR) loop. After decryption, the following interesting string is\nobserved:\n```\nMicrosoft.Windows.BNG|[C&C IP address]:443;|1;1;1;1;1;1;1;|00-24;|1\n\n```\n\n-----\n\nThe main goal of the shellcode is to load and execute the attacker s plugins in memory.\n\n## Modified Gh0st RAT\n\nWhile analysing the previous files, we found a folder named ‘Plugins’ with some interesting DLLs inside\nand two files which required a password upon execution (example in Figure 1).\n\nAfter reversing the binary, we found out that the password is not hardcoded. Instead, the password is\nbased on the current year and month. For example, the password for the month of March in 2018 is\n‘201803’.\n\nThe first file which is named ‘Noodles’ seems to be an old modified version of Gh0st RAT based on\ncompilation date and features. The second file named ‘Mozilla’ is the primary tool which was used for this\nattack. Below you can see how both panels look.\n\n\n-----\n\nCurrently, both tools can listen on any given ports but only ‘Mozilla’ can connect to a bind port. The\nsupported protocols include Secure Sockets Layer (SSL) and Transmission Control Protocol (TCP). One\nof the protocols in the list is named, according to the malware authors, ‘WINNET’ but this is not supported\nyet and an error message is displayed. This might suggest that this tool is still in development and there\nare plans to add additional functionality.\n\n\n-----\n\nAdditionally, analysis of the Mozilla tool identified a Program database (PDB) path inside the binary:\n\nK:\\Mozilla\\Mozillav6.0.x_dll\\WorkActive\\Release\\Mozilla.pdb\n\nThe tool heavily relies on plugins. When there is a new victim connection, the attacker can use the\nPluginManager to load new plugins to the infected machine.\n\nMost of the available plugins are based on the Gh0st RAT source code and a summary of them can be\nfound below:\n\n\n-----\n\n## Network communication\n\nThe network traffic between the victim and the attacker is encrypted using Rivest Cipher 4 (RC4). The key\nis unique for each request and is encrypted using ‘XOR’ and ‘AND’ instructions. The key is stored in the\nfirst 28 bytes of the request. We wrote a Python script that takes as input a network capture (PCAP) and\ndecrypts it, which can be found in our Github repository here: https://github.com/nccgroup/CyberDefence/tree/master/Scripts/gh0st_variant_c2\n\n\n-----\n\nFor example, below we can see the initial connection between a victim and the C2 server, where the\nmachine name is sent:\n\nData to server..\n```\n[i] Found key: C8410061440A01c762FA9000\n00000000: 0501570049004E00 2D00510047004F00 ..W.I.N.-.Q.G.O.\n00000010: 3400430051004E00 49004F004E003500 4.C.Q.N.I.O.N.5.\n\n```\nAnd below the distinctive start of a PE file is seen, as a plugin is transferred to the client.\n\nData to client..\n```\n[i] Found key: C841006804EC089c84EA9020\n00000000: 4D5A900003000000 04000000FFFF0000 MZ..............\n00000010: B800000000000000 4000000000000000 ........@.......\n00000020: 0000000000000000 0000000000000000 ................\n00000030: 0000000000000000 00000000F0000000 ................\n00000040: 0E1FBA0E00B409CD 21B8014CCD215468 ........!..L.!Th\n00000050: 69732070726F6772 616D2063616E6E6F is program canno\n00000060: 742062652072756E 20696E20444F5320 t be run in DOS\n00000070: 6D6F64652E0D0D0A 2400000000000000 mode....$.......\n\n## IOCs\n\n```\nCommand and Control (C&C) IPs:\n\n23.227.207.137\n89.249.65.194\n\nMalicious files directory:\n\nC:\\ProgramData\\HIDMgr\nC:\\ProgramData\\Rascon\nC:\\ProgramData\\TrkSvr\n\nMalicious service name:\n\nHIDMgr\nRasconMan\nTrkSvr\n\nRegistry key for persistence:\n\n‘rundll32.exe_malicious_DLL_path’ in ‘HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run’\n\nFile names and hashes:\n\n**Filename** **Hash(SHA-256)**\n\nMozilla.exe EE04B324F7E25B59D3412232A79D1878632D6817C3BB49500B214BF19AFA4E2C\n\nUpdateproxy.dll 0BA49FEB7784E6D33D821B36C5C669D09E58B6795ACA3EEBBF104B763B3B3C20\n\nTelnet.dll 33B7407E534B46BF8EC06D9F45ECD2D3C7D954340669E94CD7CEDCBAE5BAD2DD\n\n\n-----\n\n**Filename** **Hash(SHA-256)**\n\nSocks.dll 6160AF383794212B6AD8AB9D6D104BBE7AEFB22410F3AB8EA238F98DABFC48B7\n\nShell.dll C63B01C40038CA076072A35913F56D82E32FCEE3567650F3392B5C5DA0004548\n\nSession.dll D51EC4ACEAFA971E7ABD0CF4D27539A4212A448268EF1DB285CD9CE9024D6EB3\n\nScreen.dll BD8086DE44E16EFDD380E23E49C4058D956538B01E1AE999B679B6B76B643C7D\n\nPort.dll B44A9545B697B4D46D5B96862A6F19EA72F89FED279F56309B2F245AC8380BE0\n\nFile.dll F4DF97108F18654089CFB863F2A45AA41D17A3CE8A44CCCC474F281A20123436\n\nConEmu.exe D31D38403E039F5938AE8A5297F35EB5343BB9362D08499B1E07FAD3936CE6F7\n\nNoodles.exe A591D4D5B8D23FF12E44A301CE5D4D9BF966EBA0FC0068085B4B4EC3CE352963\n\n\nCoal.exe\n(Malicious\nexecutable)\n\nAbg.exe\n(Malicious\nexecutable)\n\n23d.exe\n(Malicious\nexecutable)\n\n89d.exe\n(Malicious\nexecutable)\n\n## References\n\n\nEEBFF21DEF49AF4E85C26523AF2AD659125A07A09DB50AC06BD3746483C89F9D\n\n97B9D7E16CD6B78A090E9FA7863BD9A57EA5BBE6AE443FA788603EEE5DA0BFC3\n\nB6C21C26AEF75AD709F6C9CFA84BFA15B7EE709588382CE4BC3544A04BCEB661\n\nDB9B9FA9EFA53662EC27F4B74B79E745F54B6C30C547A4E5BD2754E9F635F6DB\n\n\n**Published date: 17 April 2018**\n\n**Written by: Nikolaos Pantazopoulos**\n\n1.\n\nThank you for the research done on these security cameras and the app used. You saved me a lot\nof…\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-04-17 - Decoding network data from a Gh0st RAT variant.pdf"
    ],
    "report_names": [
        "2018-04-17 - Decoding network data from a Gh0st RAT variant.pdf"
    ],
    "threat_actors": [
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535788,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1664713135,
    "ts_modification_date": 1664713135,
    "files": {
        "pdf": "https://archive.orkl.eu/11a84499eb313e34bf11122c8977728cb872a248.pdf",
        "text": "https://archive.orkl.eu/11a84499eb313e34bf11122c8977728cb872a248.txt",
        "img": "https://archive.orkl.eu/11a84499eb313e34bf11122c8977728cb872a248.jpg"
    }
}