{
    "id": "5b5bde29-9fb4-4ec1-a5b5-82f0dda81d67",
    "created_at": "2023-01-12T14:59:37.39558Z",
    "updated_at": "2025-03-27T02:15:47.903471Z",
    "deleted_at": null,
    "sha1_hash": "45288bb0e9e5485da4410779c48fe3ccc6a4c8d5",
    "title": "2022-04-25 - New Core Impact Backdoor Delivered Via VMware Vulnerability",
    "authors": "",
    "file_creation_date": "2022-05-28T05:02:35Z",
    "file_modification_date": "2022-05-28T05:02:35Z",
    "file_size": 2078508,
    "plain_text": "# New Core Impact Backdoor Delivered Via VMWare Vulnerability\n\n**blog.morphisec.com/vmware-identity-manager-attack-backdoor**\n\nPosted by [Morphisec Labs on April 25, 2022](https://blog.morphisec.com/author/morphisec-labs)\n\n[Tweet](https://twitter.com/share)\n\nMorphisec is a world leader in preventing evasive polymorphic threats launched from zero-day exploits. On April 14 and 15, Morphisec\nidentified exploitation attempts for a week-old VMware Workspace ONE Access (formerly VMware Identity Manager) remote code execution\n[(RCE) vulnerability. BleepingComputer reports similar attempts have been seen in the wild. Due to indicators of a sophisticated Core Impact](https://www.bleepingcomputer.com/news/security/hackers-exploit-critical-vmware-cve-2022-22954-bug-patch-now/)\nbackdoor, Morphisec believes advanced persistent threat (APT) groups are behind these VMWare identity manager attack events. The tactics,\ntechniques, and procedures used in the attack are common among groups such as the Iranian linked Rocket Kitten.\n\nVMWare is a $30 billion cloud computing and virtualization platform used by 500,000 organizations worldwide. A malicious actor exploiting this\nRCE vulnerability potentially gains an unlimited attack surface. This means highest privileged access into any components of the virtualized\nhost and guest environment. Affected firms face significant security breaches, ransom, brand damage, and lawsuits.\n\nThis new vulnerability is a server-side template injection that affects an Apache Tomcat component, and as a result, the malicious command is\nexecuted on the hosting server. As part of the attack chain, Morphisec has identified and prevented PowerShell commands executed as child\nprocesses to the legitimate Tomcat prunsrv.exe process application. A malicious actor with network access can use this vulnerability to achieve\nfull remote code execution against VMware’s identity access management. Workspace ONE Access provides multi-factor authentication,\nconditional access, and single sign-on to SaaS, web, and native mobile apps.\n\nThis attack turned around remarkably fast:\n\nA patch for the initial vulnerability was released on April 6\nOn April 11 a proof of concept for the attack appeared\nOn April 13 exploits were identified in the wild\n\nAdversaries can use this attack to deploy ransomware or coin miners, as part of their initial access, lateral movement, or privilege escalation.\n[Morphisec research observed attackers already exploiting this vulnerability to launch reverse HTTPS backdoors—mainly Cobalt Strike,](https://blog.morphisec.com/how-to-stop-ransomware-breach-prevention-vs-cobalt-strike-backdoor)\nMetasploit, or Core Impact beacons. With privileged access, these types of attacks may be able to bypass typical defenses including antivirus\n(AV) and endpoint detection and response (EDR).\n\nMorphisec Labs has analyzed this new attack in detail below.\n\n\n-----\n\n_Morphisec console attack details_\n\n## Technical Analysis\n\n_Full attack chain_\n\nThe attacker gains initial access to an environment by exploiting a VMWare Identity Manager Service vulnerability. The attacker can then\ndeploy a PowerShell stager that downloads the next stage, which Morphisec Labs identified as the PowerTrash Loader. Finally, an advanced\npenetration testing framework—Core Impact—is injected into memory.\n\n## VMWare Identity Manager Vulnerabilities\n\n[The Morphisec blog post Log4j Exploit Hits Again: Vulnerable VMWare Horizon Servers at Risk showed how attackers previously exploited](https://blog.morphisec.com/log4j-exploit-hits-again-vulnerable-vmware-horizon-servers-at-risk)\nVMWare’s Horizon Tomcat service. Unfortunately, malice never sleeps. Threat actors are now exploiting another VMWare component, the\nVMWare Identity Manager service.\n\nSeveral vulnerabilities have recently been reported for this service:\n\n\nCVE[2022-](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22958)\n22958\n\n\nVMware Workspace ONE Access, Identity Manager, and vRealize Automation contain two remote code execution vulnerabilities\n(CVE-2022-22957 and CVE-2022-22958). A malicious actor with administrative access can trigger the deserialization of untrusted\ndata through malicious JDBC URI, which may result in remote code execution.\n\n\n-----\n\nCVE[2022-](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22957)\n22957\n\nCVE[2022-](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22954)\n22954\n\n\nVMware Workspace ONE Access, Identity Manager, and vRealize Automation contain two remote code execution vulnerabilities\n(CVE-2022-22957 and CVE-2022-22958). A malicious actor with administrative access can trigger the deserialization of untrusted\ndata through malicious JDBC URI, which may result in remote code execution.\n\nVMware Workspace ONE Access and Identity Manager contains a remote code execution vulnerability due to server-side template\ninjection. A malicious actor with network access can trigger a server-side template injection that may result in remote code\n**execution.**\n\n\nWhile CVE-2022-22957 and CVE-2022-22958 are RCE vulnerabilities, they require administrative access to the server. CVE-2022-22954\nhowever, doesn’t, and already has an open-source proof of concept in the wild.\n\n## Powershell Stager\n\nThe attacker exploited the service and ran the following PowerShell command:\n\n_Stager encoded in base64_\n\nWhich translates to:\n\n_Decoded stager_\n\nAs you can see at the end, this is an encoded command where each character is subtracted by one. When doing so we get the URL from\nwhich the next stage is downloaded:\n\n_Decoded #2 stager_\n\n## PowerTrash Loader\n\nThe PowerTrash Loader is a highly obfuscated PowerShell script with approximately 40,000 lines of code.\n\n_Snippet from the PowerTrash Loader_\n\nThis loader decompresses the deflated payload and reflectively loads it in memory, without leaving forensic evidence on the disk. We’ve\n[previously seen the PowerTrash Loader leading to JSSLoader.](https://blog.morphisec.com/the-evolution-of-the-fin7-jssloader)\n\nThis time the final payload was different—a Core Impact Agent.\n\n## Core Impact Agent\n\n\n-----\n\nCo e pact s a pe et at o test g a e o de e oped by Co e Secu ty s t ot e pe et at o test g a e o s, t ese a e t a ays\n[used with good intentions. TrendMicro reported a modified version of Core Impact was used in the Woolen-GoldFish campaign tied to the](https://documents.trendmicro.com/assets/wp/wp-operation-woolen-goldfish.pdf)\nRocket Kitten APT35 group.\n\nWe can extract the C2 address, client version, and communication encryption key located in an embedded string:\n\nC2 Server: 185.117.90[.]187\n\nClient Version: 7F F7 FF 83 (HEX)\n\n256-Bit Key:\ncd19dbaa04ea4b61ace6f8cdfe72dc99a6f807bcda39ceab2fefd1771d44ad288b76bc20eaf9ee26c9a175bb055f0f2eb800ae6010ddd7b509e061651\n(ASCII)\n\n## Additional Threat Relations\n\nA reverse look-up on the Stager server leads to a new web hosting server named ‘Stark Industries’ registered in London.\n\n_Stager server IP reverse lookup result_\n\n[The company was registered on February 2022 and is linked to a person named Ivan Neculiti:](https://suite.endole.co.uk/insight/company/13906017-stark-industries-solutions-ltd?page=people-contacts)\n\n_Ivan Neculiti identity in suite.endole.co.uk_\n\n[There is a dedicated profile page for him on hucksters.net which exposes spammers, fraudsters, and other bad actors.](https://hucksters.net/person/neculiti-ivan)\n\nIvan is infamous for owning web hosting companies used for malicious and illegal activities. Among them is pq[.]hosting which is easily\ncorrelated to stark-industries[.]solutions.\n\n\n-----\n\n_Co e at o_ _bet ee_ _t e_ _eb_ _ost g co_ _pa es_\n\n## Indicators of Compromise\n\nStage1 Serving URL:\n\nhxxp://138.124.184[.]220/work_443.bin_m2.ps1\n\nStage2 - work_443.bin_m2.ps1:\n\n746FFC3BB7FBE4AD229AF1ED9B6E1DB314880C0F9CB55AEC5F56DA79BCE2F79B\n\nStage3 - Core Impact:\n\n7BC14D231C92EEEB58197C9FCA5C8D029D7E5CF9FBFE257759F5C87DA38207D9\n\nC2 Server:\n\n185.117.90[.]187\n\n## Protect Yourself Against This VMWare Identity Manager Attack\n\nThe widespread use of VMWare identity access management combined with the unfettered remote access this attack provides is a recipe for\ndevastating breaches across industries. Anyone using VMWare’s identity access management should immediately apply the patches VMWare\nhas released. Organizations unable to immediately apply the patch(es) should consider virtual patching. VMWare customers should also\nreview their VMware architecture to ensure the affected components are not accidentally published on the internet, which dramatically\nincreases the exploitation risks.\n\nMorphisec customers are protected against these backdoor attacks and others like it. Morphisec’s MTD technology implements a virtual patch\nby creating a dynamic attack surface to prevent the successful deployment of CoreImpact, Cobalt Strike and Metasploit beacons. These\nbeacons are highly evasive and can bypass the AV, EDR, MDR, and XDR deployed on endpoints. Morphisec’s MTD technology provides early\nvisibility and prevention of vulnerability exploitation. It enables quick containment without creating false positive alerts.\n\nFor better risk management, organizations should adopt a preventative approach that proactively stops breaches before they infiltrate.\nMorphisec’s Moving Target Defense technology uses polymorphism against attackers to hide vulnerabilities from threat actors while reducing\nyour attack surface. To learn more, read Morphisec’s white paper: Zero Trust + Moving Target Defense: Stopping Ransomware, Zero-Day, and\nOther Advanced Threats Where NGAV and EDR Are Failing.\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-25 - New Core Impact Backdoor Delivered Via VMware Vulnerability.pdf"
    ],
    "report_names": [
        "2022-04-25 - New Core Impact Backdoor Delivered Via VMware Vulnerability.pdf"
    ],
    "threat_actors": [
        {
            "id": "e034b94b-9655-42c4-a72e-a58807dce299",
            "created_at": "2022-10-25T16:07:24.133537Z",
            "updated_at": "2025-03-27T02:02:10.118581Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Group 83",
                "NewsBeef",
                "Newscaster",
                "Operation Newscaster",
                "Operation Woolen-GoldFish",
                "Parastoo",
                "Rocket Kitten"
            ],
            "source_name": "ETDA:Rocket Kitten",
            "tools": [
                "CoreImpact (Modified)",
                "FireMalv",
                "Ghole",
                "Gholee"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8faa11f5-2a14-479c-9ea8-3779e6de9749",
            "created_at": "2022-10-25T15:50:23.814205Z",
            "updated_at": "2025-03-27T02:00:55.551798Z",
            "deleted_at": null,
            "main_name": "Ajax Security Team",
            "aliases": [
                "Ajax Security Team",
                "Operation Woolen-Goldfish",
                "AjaxTM",
                "Rocket Kitten",
                "Flying Kitten",
                "Operation Saffron Rose"
            ],
            "source_name": "MITRE:Ajax Security Team",
            "tools": [
                "sqlmap",
                "Havij"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af2a195b-fed2-4e2c-9443-13e9b08a02ae",
            "created_at": "2022-12-27T17:02:23.458269Z",
            "updated_at": "2025-03-27T02:02:10.056073Z",
            "deleted_at": null,
            "main_name": "Operation LiberalFace",
            "aliases": [
                "MirrorFace",
                "Operation LiberalFace"
            ],
            "source_name": "ETDA:Operation LiberalFace",
            "tools": [
                "LODEINFO",
                "MirrorStealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b0261705-df2e-4156-9839-16314250f88a",
            "created_at": "2023-01-06T13:46:38.373617Z",
            "updated_at": "2025-03-27T02:00:02.817313Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Operation Woolen-Goldfish",
                "Thamar Reservoir",
                "Timberworm",
                "TEMP.Beanie",
                "Operation Woolen Goldfish"
            ],
            "source_name": "MISPGALAXY:Rocket Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535577,
    "ts_updated_at": 1743041747,
    "ts_creation_date": 1653714155,
    "ts_modification_date": 1653714155,
    "files": {
        "pdf": "https://archive.orkl.eu/45288bb0e9e5485da4410779c48fe3ccc6a4c8d5.pdf",
        "text": "https://archive.orkl.eu/45288bb0e9e5485da4410779c48fe3ccc6a4c8d5.txt",
        "img": "https://archive.orkl.eu/45288bb0e9e5485da4410779c48fe3ccc6a4c8d5.jpg"
    }
}