{
    "id": "830eef3f-2ffc-40e8-b6c4-7dea504bbe83",
    "created_at": "2023-01-12T15:10:55.94863Z",
    "updated_at": "2025-03-27T02:13:38.722116Z",
    "deleted_at": null,
    "sha1_hash": "522daf44331ba9a9724c98c5bdceb83ee6be4bbe",
    "title": "2022-08-30 - SmokeLoader - Quick-Analysis",
    "authors": "",
    "file_creation_date": "2022-09-01T10:32:31Z",
    "file_modification_date": "2022-09-01T10:32:31Z",
    "file_size": 2269691,
    "plain_text": "# Quick-Analysis/SmokeLoader.md at main ¬∑ vc0RExor/Quick-Analysis ¬∑ GitHub\n\n**[github.com/vc0RExor/Quick-Analysis/blob/main/SmokeLoader/SmokeLoader.md](https://github.com/vc0RExor/Quick-Analysis/blob/main/SmokeLoader/SmokeLoader.md)**\n\nvc0RExor\n\n## _Overview\n\n_SmokeLoader is a malware that generally acts as a backdoor and is commonly_\n_used as a loader for other malware. Attributed to the criminal group Smoky_\n_Spider, a group that uses SmokeLoader and Sasfis, loader and downloader_\n_respectively. SmokeLoader has been used as a bot in infrastructures and_\n_contains strong evasion capabilities as well as Anti-Analysis, Anti-VM and Anti-_\n_DBG techniques._\n\n## _Technical Analysis\n\nSmokeLoader appears on systems usually through phishing, although it can be\nloaded by other PUP/PUA or malware. The main execution will revolve around\na document that will spawn the SmokeLoader which will run, in most of its\nversions, a version of itself in a suspended state to inject code, after which it\nwill execute an explorer.exe that it will inject again in order to perform the\nmalicious C&C actions or download other files using legitimate software\n\n\n-----\n\nThe samples that have been found have in most cases been detected as\npacked, due to the high level of entropy contained in their sections.\n\n\n-----\n\nAt the initial point, we see how it tries to load libraries in RunTime, something\nreally useful since it prevents us from being able to discern its intentions if we\nperform a basic static analysis, so it will obtain new functionalities during its\nexecution.\n\nIn some of the techniques used to hinder the analysis, such as code\nobfuscation, we find different hidden calls, as well as abuses of RET to reach\ncalls that we will not see statically.\n\n\n-----\n\nAs mentioned above, it fetches libraries during runtime and is dedicated to\nresolving APIs that it could use later on\n\n\n-----\n\nAt all times, it has control over what is running on the machine, as it\nsubsequently performs various Anti-Vm and Anti-dbg techniques, so having all\nrunning processes mapped is always a good technique.\n\n\n-----\n\nAfter this, it starts loading APIs that will serve it moments later, in which we will\nsee a routine that will be loading from memory and using LoadLibrary +\nGetProcAddress\n\n\n-----\n\nAPIs:\n```\nCreateFileA\n\nCreateWindowExA\n\nCreateProcessA\n\nWriteProcessMemory\n\nResumeThread\n\nDefWindowProcA\n\nNtWriteVirtualMemory\n\nRegisterClassExA\n\nGetStartupInfoA\n\nSetThreadContext\n\nGetCommandLineA\n\nPostMessageA\n\nVirtualAllocEx\n\nCloseHandle\n\nVirtualAlloc\n\nVirtualFree\n\nVirtualProtectEx\n\nExitProcess\n\nGetMessageExtraInfo\n\nWaitForSingleObject\n\nNtUnmapViewOfSection\n\nMessageBoxA\n\nReadProcessMemory\n\nGetThreadContext\n\nWriteFile\n\nGetModuleFileNameA\n\nGetFileAttributesA\n\nWinExec\n\nGetMessageA\n\n\n```\nOnce it has the libraries, APIs and processes controlled, it creates a process in\nsuspended state, for this it uses CreateProcessInternalA that will call\nCreateProcessInternalW entering 0x04 in dwCreationflags to create the\nprocess in suspended state.\n\n\n-----\n\nOnce the process is created in a suspended state, it proceeds to introduce the\nbinary inside the previously spawned process, which, through\nProcessHollowing, will unmap data from itself, to write the binary inside, this is\nusually done through ZwUnmapViewOfSection + VirtualAlloc +\nZwWriteVirtualMemory, once introduced into the memory of the process in\nsuspension, it will stop being suspended and will execute it, so the memory file\nwill be detonated.\n\n[ The binary extracted from memory, which will inject explorer.exe, is very\ninteresting, we will follow soon :) üïµÔ∏è ]\n\n## _IOC\n\n### _SHA256\n```\nEbdebba349aba676e9739df18c503ab8c16c7fa1b853fd183f0a005c0e4f68ae\n\nD618d086cdfc61b69e6d93a13cea06e98ac2ad7d846f044990f2ce8305fe8d1b\n\nEe8f0ff6b0ee6072a30d45c135228108d4c032807810006ec77f2bf72856e04a\n\n6b48d5999d04db6b4c7f91fa311bfff6caee938dd50095a7a5fb7f222987efa3\n\nB961d6795d7ceb3ea3cd00e037460958776a39747c8f03783d458b38daec8025\n\n02083f46860f1ad11e62b2b5f601a86406f7ee3c456e6699ee2912c5d1d89cb9\n\n059d615ce6dee655959d7feae7b70f3b7c806f3986deb1826d01a07aec5a39cf\n\n5318751b75d8c6152d90bbbf2864558626783f497443d4be1a003b64bc2acbc2\n\n79ae89733257378139cf3bdce3a30802818ca1a12bb2343e0b9d0f51f8af1f10\n\nF92523fa104575e0605f90ce4a75a95204bc8af656c27a04aa26782cb64d938d\n\n```\n\n-----\n\n### _IP\n```\n216.128.137.31\n\n8.209.71.53\n\n _Domains\nhost-file-host6[.]com\n\nhost-host-file8[.]com\n\nfiskahlilian16[.]top\n\npaishancho17[.]top\n\nydiannetter18[.]top\n\nazarehanelle19[.]top\n\nquericeriant20[.]top\n\nxpowebs[.]ga\n\nvenis[.]ml\n\ntootoo[.]ga\n\neyecosl[.]ga\n\nbullions[.]tk\n\nmizangs[.]tw\n\nmbologwuholing[.]co[.]ug\n\nquadoil[.]ru\n\n\n```\nü¶ñ [vc0=Rexor](https://github.com/vc0RExor) üïµÔ∏è\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-30 - SmokeLoader - Quick-Analysis.pdf"
    ],
    "report_names": [
        "2022-08-30 - SmokeLoader - Quick-Analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "058823d4-60c2-42ab-a3aa-4c10f0ff37c9",
            "created_at": "2022-10-25T16:07:24.57064Z",
            "updated_at": "2025-03-27T02:02:10.283753Z",
            "deleted_at": null,
            "main_name": "Smoky Spider",
            "aliases": [],
            "source_name": "ETDA:Smoky Spider",
            "tools": [
                "Dofoil",
                "Oficla",
                "Sasfis",
                "Sharik",
                "Smoke Loader",
                "SmokeLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "fdf30f70-537c-458d-82b2-54b4f09cea48",
            "created_at": "2023-01-06T13:46:39.119613Z",
            "updated_at": "2025-03-27T02:00:03.001129Z",
            "deleted_at": null,
            "main_name": "SMOKY SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:SMOKY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "38784d0b-7d2a-48bb-bac5-12f4eef96efc",
            "created_at": "2024-06-04T02:03:07.787775Z",
            "updated_at": "2025-03-27T02:05:17.329478Z",
            "deleted_at": null,
            "main_name": "GOLD ANDREW",
            "aliases": [
                "Smoky Spider "
            ],
            "source_name": "Secureworks:GOLD ANDREW",
            "tools": [
                "Smoke Loader"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536255,
    "ts_updated_at": 1743041618,
    "ts_creation_date": 1662028351,
    "ts_modification_date": 1662028351,
    "files": {
        "pdf": "https://archive.orkl.eu/522daf44331ba9a9724c98c5bdceb83ee6be4bbe.pdf",
        "text": "https://archive.orkl.eu/522daf44331ba9a9724c98c5bdceb83ee6be4bbe.txt",
        "img": "https://archive.orkl.eu/522daf44331ba9a9724c98c5bdceb83ee6be4bbe.jpg"
    }
}