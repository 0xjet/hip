{
    "id": "d6b8d9bd-1655-4e81-9153-2d9434715231",
    "created_at": "2023-01-12T15:07:03.155145Z",
    "updated_at": "2025-03-27T02:09:29.483621Z",
    "deleted_at": null,
    "sha1_hash": "493ce9fa2626e1d142a416525c4f74a37efb6fb6",
    "title": "2021-03-15 - Taurus Stealer's Evolution",
    "authors": "",
    "file_creation_date": "2022-05-28T18:29:48Z",
    "file_modification_date": "2022-05-28T18:29:48Z",
    "file_size": 3310410,
    "plain_text": "# Taurus Stealer's Evolution\n\n**blog.minerva-labs.com/taurus-stealers-evolution**\n\n[Tweet](https://twitter.com/share)\n\n\n-----\n\nRecently, we have seen a spike in events associated with Taurus stealer. The individual/s developing this threat have\nbeen actively improving the evasiveness of their loader since February 2021, which in turn made their payloads fully\nundetectable for almost a month.\n\n[Taurus AutoIt payload initial VirusTotal detection rates, taken from Nextron Systems’ Valhalla:](https://valhalla.nextron-systems.com/info/rule/MAL_Script_Autoit_Taurus_Dropper_Sep20_1)\n\n\nTaurus AutoIt payload initial VirusTotal detection rates, taken from Nextron Systems’ Valhalla\n\n\n(Nextron Systems)\n\nThe image depicts the latest Taurus payloads uploaded to VirusTotal and their initial positives rate, as can be seen in\nthe table, no more than one vendor blacklisted these payloads, whereas most of these samples have been completely\nignored by the industry’s top anti-virus engines.\n\n[Some great technical blogs have already been published about this malware family by Zscaler,](https://www.zscaler.com/blogs/security-research/taurus-new-stealer-town) [StrangerealIntel and](https://github.com/StrangerealIntel/CyberThreatIntel/blob/master/Additional%20Analysis/UnknownTA/2020-09-07/Analysis.md)\n[TrendMicro, that is why the scope of the article is mainly the changes made since these publications. The goal of this](https://www.trendmicro.com/en_us/research/21/b/finding-multi-step-obfuscated-malware.html)\ntechnical analysis is to help the security community detect this threat and prevent it.\n\n**LOLbins & 7zip’s SFX:**\n\n\n-----\n\nThe initial infection begins with a zip file, masquerading as legitimate software, which contains a malicious SFX binary.\nThe SFX binary drops several files to the user’s temp directory:\n\nDai.xlsm – a malicious AutoIt script.\nPuo.gif – an encrypted PE file.\nScoute.dll - AutoIt binary, stripped of its MZ magic bytes.\nDimagrato.accde – an obfuscated batch script.\n\nDimagrato.accde (batch script) is the next link in the chain, this small batch script was obfuscated to the size of 116\nKB.\n\nA snippet from Dimagrato.accde:\n\n\nA snippet from Dimagrato.accde\n\n\nAfter de-obfuscation:\n\n\n-----\n\nFirst, the script checks if the %userdomain% environment variable is equal to the string “DESKTOP-QO5QU33”, our\n[guess is that this is an emulation detection technique. It then creates the AutoIt interpreter binary by replacing the](https://www.autoitscript.com/site/)\nprefix of Scoute.dll with the magic bytes MZ, and the now-valid binary is renamed to “Ali.com”. Finally, Ali.com is\nexecuted with Dai.xlsm as its command line parameter.\n\n**The AutoIt Script:**\n\nThe main module of this attack is a highly obfuscated AutoIt script, it uses evasion techniques to avoid analysis and\nsandbox environments and then launches the actual stealer in-memory.\n\nThe malware will use various anti-sandboxing and anti-emulation techniques, beginning with computer name check\nand Microsoft Defender emulator file (aaa_TouchMeNot_.txt):\n\n\n-----\n\nThe malware will use various anti-sandboxing and anti-emulation techniques\n\n\n[Another interesting anti-emulation trick used by the malware through the windows API SetErrorMode:](http://joxeankoret.com/blog/2010/02/23/antiemulation-techniques-malware-tricks-ii/)\n\n\n-----\n\n[Taurus uses a computation based anti-analysis technique by calculating the sum of the Basel problem, deriving π from](https://en.wikipedia.org/wiki/Basel_problem)\nit (square root times six of the sum) and exiting if a number larger then π is the answer:\n\n\n-----\n\nTaurus uses a computation based anti-analysis technique by calculating the sum\nof the Basel problem,\n\nThe last self-terminating evasion technique is a DNS killswitch. The malware will ping a specific domain and will exit\nupon successful connection:\n\n\n-----\n\nAfter being completely sure it is executing in a “safe” environment, the malware will read the file Puo.gif and decrypt it\nin-memory, the result is a PE file that will be reflectively loaded. Yet again the malware tries to fool security products,\nby loading the file explorer.exe into its memory space (using the LoadLibraryExW API) and overwriting the shared\nsections created by Windows OS with the decrypted malware. This technique may be used to fool security products\nthat rely on the image linked to Windows section objects.\n\nProcess hacker module list shows explorer.exe at 0x5930000:\n\n\n-----\n\nTaursStealer Process hacker module list shows explorer.exe at\n0x5930000\n\nThe actual allocation is a private RWX section:\n\n**Conclusion:**\n\nOver the past months Taurus has increased its evasiveness significantly, mutating each time it is covered by a security\nvendor. We expect this trend to continue with the release of the blog and encourage further security research of this\nthreat, in favor of a robust prevention mechanism.\n\nThe infection process chain, as depicted by Minerva’s platform:\n\n\n-----\n\nThe Taurus Stealer infection process chain, as depicted by Minerva s platform\n\n\n**IOCs:**\n\n**Hashes:**\n\n61f3c3be1ae733d923f414205c0056a140fd9e279566bf6e83cf49931b445f67 (Dimagrato.accde)\n\na79b246d81ec3611228c4a545e02e83dd4196f8f4f470ca1f21470e87cfc76e8 (deobfuscated Dimagrato.accde)\n\n5cfa9d6c4be74da3960e0973f29fc0aaf60b423be548fb5b409df648e3b49788 (Dai.xlsm)\n\n46f2677e2c7a8d3207da130b8ab90233a5a28715593e717117690215e4fe6fc0 (decrypted PE Payload)\n\n2002fc160b41b29863e8c7a85c932b052eea8651560f74b3b77a4514c5431d99 (Pou.gif)\n\n**Domains:**\n\nlisayt15[.]top\n\nmorlisanem01[.]top\n\ndisayta09[.]top/download.php?file=lv.exe\n\nOsCvWtwAmcuANjreVoEpgBTcgNL[.]OsCvWtwAmcuANjreVoEpgBTcgNL\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-15 - Taurus Stealer's Evolution.pdf"
    ],
    "report_names": [
        "2021-03-15 - Taurus Stealer's Evolution.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536023,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653762588,
    "ts_modification_date": 1653762588,
    "files": {
        "pdf": "https://archive.orkl.eu/493ce9fa2626e1d142a416525c4f74a37efb6fb6.pdf",
        "text": "https://archive.orkl.eu/493ce9fa2626e1d142a416525c4f74a37efb6fb6.txt",
        "img": "https://archive.orkl.eu/493ce9fa2626e1d142a416525c4f74a37efb6fb6.jpg"
    }
}