{
    "id": "76481187-2abd-4251-93d1-07877230a821",
    "created_at": "2023-01-12T15:11:00.914562Z",
    "updated_at": "2025-03-27T02:06:15.533645Z",
    "deleted_at": null,
    "sha1_hash": "f85f2a5574dd0699d097614af136e43428e44eb9",
    "title": "2020-12-14 - Incident response playbook for responding to SolarWinds Orion compromise",
    "authors": "",
    "file_creation_date": "2022-05-28T15:50:02Z",
    "file_modification_date": "2022-05-28T15:50:02Z",
    "file_size": 462394,
    "plain_text": "# Incident response playbook for responding to SolarWinds Orion compromise\n\n**news.sophos.com/en-us/2020/12/14/solarwinds-playbook/**\n\nRoss McKerchar December 14, 2020\n\n_** We will continue to update this article with additional information as it becomes available. Check back here_\n_[and GitHub regularly for further updates. **](https://github.com/sophos-cybersecurity/solarwinds-threathunt)_\n\n_Last updated 2020-12-15T12:18Z – view the changelog below_\n\nFor security teams who have SolarWinds in their environment looking to initiate incident response, we’re\nproviding the following playbook, based upon our initial understanding of the threat, as an aid to help\nyou investigate any potential attack. The information presented may not be complete or eliminate all threats,\nbut we expect will be effective based on our experience. As more information becomes available about the\nthreat, recommended steps may change or be updated.\n\n## Example threat model\n\nThis response process may need to be customized for your environment and is based upon the following\nassumptions:\n\n1. Ability to establish when the vulnerable component was introduced into the environment and log\n\ncoverage for that period.\n2. Assume adversary had access to all accounts and credentials utilized by SolarWinds Orion server\n\nand the capability to assume the identity of any administrative or related accounts.\n3. Assume adversary had the capability and network access to maintain a C2 channel\n\nto SolarWinds Orion server.\n4. Ability to determine that no accounts used by SolarWinds, nor accounts used to access\n\nthe SolarWinds Orion server had full domain administrative rights.\n\n\n-----\n\n5. Ability to determine that no active malicious activity occurred relating to the vulnerable\n\ncomponent based upon currently available IOCs and detections.\n\n_If you find evidence of malicious activity or if you are not able to arrive at some of the baseline conclusions_\n_described here, Sophos recommends initiating your full incident response procedures or reaching out for_\n_external assistance._\n\n## Detection and analysis\n\n Hunt for impacted SolarWinds instances\n\n### Endpoint queries\n\n**Sophos EDR/Osquery:** [Detection queries](https://github.com/sophos-cybersecurity/solarwinds-threathunt)\n\n**Sophos Intercept X:**\n\nSophos Application Control detects all versions of SolarWinds Orion as “SolarWinds MSP Agent”. Application\n[Control is an optional setting – read the Help Guide for instructions on how to enable it, and add SolarWinds](https://docs.sophos.com/central/Customer/help/en-us/central/Customer/tasks/ConfigureAppControl.html)\nto the list of apps you want to block.\n\nLabs detections: List of [detections and IOCs](https://github.com/sophos-cybersecurity/solarwinds-threathunt/blob/master/iocs.csv)\n\n**Manual (example):**\n\nPS C:\\Windows\\system32> Get-FileHash C:\\Orion\\Solarwinds.Orion.Core.Businesslayer.dll | Format-List\n\nAlgorithm: SHA256\n\nHash: CE77D116A074DAB7A22A0FD4F2C1AB475F16EEC42E1DED3C0B0AA8211FE858D6\n\nPath: C:\\Orion\\Solarwinds.Orion.Core.Businesslayer.dll\n\n### Network queries\n\nSolarWinds can be detected via network monitoring by looking for call-homes made by its updating service.\n[The following Zeek IDS searches may also help: SIEM Searches.](https://github.com/sophos-cybersecurity/solarwinds-threathunt/blob/master/splunk-searches.md)\n\n_Note: You may only see outbound connection from your main SolarWinds instance not pollers._\n\n## Identify malicious SolarWinds components\n\n### Endpoint indicators\n\nWarning: check your configuration for exclusions.\nSee [https://twitter.com/ffforward/status/1338785034375999491](https://twitter.com/ffforward/status/1338785034375999491)\n\n**Sophos Intercept X / Central Endpoint Protection:**\n\nSophosLabs contains both detections for the malicious component and the additional signature that indicate\nactive exploitation. Sophos has also blocked all associated IP and domain indicators for its\ncustomers. See GitHub for detection names.\n\n\n-----\n\n**Sophos EDR/OSquery:** [Detection queries](https://github.com/sophos-cybersecurity/solarwinds-threathunt)\n\n### Network indicators\n\nSophos has also blocked all associated IP and domain indicators for its XG and SG customers. If you have\n[additional network telemetry the following searches may also be of use: SIEM Searches](https://github.com/sophos-cybersecurity/solarwinds-threathunt/blob/master/splunk-searches.md)\n\n_Note: The attacks communicate to C2 via TLS so a file hash hit is unlikely unless you intercept TLS._\n\n## Prepare for forensics\n\nIf possible, snapshot all affected hosts with impacted versions of Orion installed.\n\nEnsure that snapshotting processes also capture memory.\n\nVMware: https://docs.vmware.com/en/VMware[vSphere/6.0/com.vmware.vsphere.html.hostclient.doc/GUID-A0D8E8E7-629B-466D-A50C-](https://docs.vmware.com/en/VMware-vSphere/6.0/com.vmware.vsphere.html.hostclient.doc/GUID-A0D8E8E7-629B-466D-A50C-38705ACA7613.html)\n38705ACA7613.html\nHyper-V: [https://support.citrix.com/article/CTX126393](https://support.citrix.com/article/CTX126393)\n\nA lightweight forensic acquisition can also be performed using the “Forensic snapshot” feature of Sophos\nEDR.\n\n## Scope potentially compromised accounts\n\nPotentially impacted accounts are:\n\n1. All accounts SolarWinds used for network monitoring, this includes Windows local accounts, domain\n\naccounts, SNMP, SSH, etc.\n2. All other accounts used on the affected SolarWinds Orion Servers. These include all administrative\n\nlogins (e.g. EventCode 4624) to the server and any local or service accounts. (e.g local SQL database\naccount.)\n\nThe following table can be used to document all potentially impacted accounts:\n\n\n**Username** **Desc** **Protocol** **Domain** **Domain**\n**Admin**\n\n\n**Server**\n**admin/root**\n\n\n**Scope** **Notes**\n\n\n(fully-qualified\nusername/UPN)\n\n\nBrief\noverview\nof what\nit’s used\nby\n\n\nWindows/KRB/NTLM\n| SNMP | SSH etc\n\n\n(y/n) (y/n) What\nhosts this\nis\napplicable\nto\n\n\n## Identify high-value attack paths for potentially compromised accounts\n\nFor all potentially compromised accounts listed above, identify other high-value systems (e.g. domain\ncontrollers, Active Directory Federation Services, and Azure Active Directory Connect servers) to which they\nhad access.\n\n1. Evaluate local system authentication logs for anomalous activity from compromised accounts.\n[2. Bloodhound can also be used to map out access of any potentially impacted accounts.](https://github.com/BloodHoundAD/BloodHound)\n\n\n-----\n\nIf servers or accounts involved in federated authentication (e.g. ADFS servers) were potentially impacted,\nrefer to [Microsoft’s customer guidance and develop an appropriate additional containment strategy.](https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/)\n\n## Containment and eradication\n\nWarning: these steps assume a desire to preserve the environment for further forensic investigation and may\nhave an impact on production environments.\n\n1. Isolate all SolarWinds Orion instances from the network:\n\n1. Instant isolation can be performed at the host level using such controls as Sophos EDR via\n\nSophos Central.\n2. Host-based isolation should be backed up by network–based isolation. Systems should be\n\nmigrated to an isolated non-routable VLAN with console access only (migrating to a\nVLAN helps preserve network state for future forensics).\n2. Perform credential reset or disable and recreate all potentially impacted accounts:\n\n1. Important: Ensure that no fresh or reset accounts are used to access\n\nany compromised infrastructure.\n3. Rebuild fresh monitoring servers from known-good sources ready for release of Orion platform version\n\n[2020.2.1 HF 2, which is planned for release on Tuesday, December 15, 2020.](https://www.solarwinds.com/securityadvisory)\n4. Consider taking forensic snapshots and rebuilding additional exposed hosts, including:\n\n1. Any hosts running the SolarWinds agent.\n2. Any hosts for which potentially compromised accounts had access rights.\n\n## Changelog\n\n2020-12-15T12:18Z Added warning about checking your configurations for exclusions\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-14 - Incident response playbook for responding to SolarWinds Orion compromise.pdf"
    ],
    "report_names": [
        "2020-12-14 - Incident response playbook for responding to SolarWinds Orion compromise.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536260,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653753002,
    "ts_modification_date": 1653753002,
    "files": {
        "pdf": "https://archive.orkl.eu/f85f2a5574dd0699d097614af136e43428e44eb9.pdf",
        "text": "https://archive.orkl.eu/f85f2a5574dd0699d097614af136e43428e44eb9.txt",
        "img": "https://archive.orkl.eu/f85f2a5574dd0699d097614af136e43428e44eb9.jpg"
    }
}