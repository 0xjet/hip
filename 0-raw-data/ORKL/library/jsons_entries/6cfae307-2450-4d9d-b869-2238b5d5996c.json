{
    "id": "6cfae307-2450-4d9d-b869-2238b5d5996c",
    "created_at": "2023-01-12T15:07:26.410526Z",
    "updated_at": "2025-03-27T02:16:53.056357Z",
    "deleted_at": null,
    "sha1_hash": "5f1cc73fd5574507b4ad7f5dc705ccb8fb005b9a",
    "title": "2020-08-27 - An Old Bot’s Nasty New Tricks- Exploring Qbot’s Latest Attack Methods",
    "authors": "",
    "file_creation_date": "2022-05-28T03:10:41Z",
    "file_modification_date": "2022-05-28T03:10:41Z",
    "file_size": 2143024,
    "plain_text": "# An Old Bot’s Nasty New Tricks: Exploring Qbot’s Latest Attack Methods\n\n**research.checkpoint.com/2020/exploring-qbots-latest-attack-methods/**\n\nAugust 27, 2020\n**Research By: Alex Ilgayev**\n\n## Introduction\n\n\nAugust 27, 2020\n\n\n**The notorious banking trojan Qbot has been in business for more than a decade. The malware, which has also been dubbed Qakbot and**\n**Pinkslipbot, was discovered in 2008 and is known for collecting browsing data and stealing banking credentials and other financial information**\nfrom victims. It is highly structured, multi-layered, and is being continuously developed with new features to extend its capabilities. .These new\n‘tricks’ mean that despite its age, Qbot is still a dangerous and persistent threat to organizations. It has become the malware equivalent of a\nSwiss Army knife, capable of:\n\nStealing information from infected machines, including passwords, emails, credit card details and more.\nInstalling other malware on infected machines, including ransomware\nAllowing the Bot controller to connect to the victim’s computer (even when the victim is logged in) to make banking transactions from the\nvictim’s IP address\nHijacking users’ legitimate email threads from their Outlook client and using those threads to try and infect other users’ PCs\n\nA prominent campaign using QBot ran from March to the end of June this year.  We assumed that the campaign was stopped to allow those\nbehind QBot to conduct further malware development, but we did not imagine that it would return so quickly.\n\n[Towards the end of July, one of today’s most serious cyber threats, the Emotet Trojan, returned to full activity and launched multiple malspam](https://blog.checkpoint.com/2020/08/07/julys-most-wanted-malware-emotet-strikes-again-after-five-month-absence/)\ncampaigns, impacting 5% of organizations globally. Some of these campaigns included installing an updated version of Qbot on victims’ PCs.\nA few days later, we identified a newer Qbot sample [dropped by latest Emotet campaign, which led us discovering a renewed command and](https://twitter.com/_CPResearch_/status/1289195232718880770)\ncontrol infrastructure and brand new malware techniques distributed through Emotet’s infection process.\n\nIf that wasn’t enough for us, Qbot’s malspam campaign resumed earlier in August, spreading globally and infecting new targets. One of Qbot’s\nnew tricks is particularly nasty, as once a machine is infected, it activates a special ‘email collector module’ which extracts all email threads\nfrom the victim’s Outlook client, and uploads it to a hardcoded remote server. These stolen emails are then utilized for future malspam\ncampaigns, making it easier for users to be tricked into clicking on infected attachments because the spam email appears to continue an\nexisting legitimate email conversation. Check Point’s researchers have seen examples of targeted, hijacked email threads with subjects\nrelated to Covid-19, tax payment reminders, and job recruitments.\n\nB d i ibilit t f th tt k d i t US d E b d i ti i **Fi** **1**\n\n\n-----\n\n**Figure 1 – Attacked organizations by country**\n\nAmong these, the most targeted industries were in the government, military, and manufacturing sectors.\n\n**Figure 2 – Attacked Organizations by industry**\n\nAfter a thorough analysis of these new QBot samples, we will share our knowledge and insights about the following topics:\n\nQbot’s infection process – hijacked email threads and VBS downloaders.\nIts payload functionality and version break down.\nC&C communication protocol and module fetching.\nHow a victim becomes a potential bot-proxy, and various methods that the Proxy module exposes.\n\n## Infection Chain\n\n\n-----\n\nQBot’s infection chain is described in the following flow-chart and will be discussed in the next sections:\n\n**Figure 3 – Infection chain diagram**\n\n### Malicious Email\n\nThe initial infection chain starts by sending specially crafted emails to the target organizations. The method is less sophisticated than spearphishing techniques but has additional attributes which add to its credibility. One of these is called “Hijacked Email Threads” – capturing\narchived email conversations and replying to the sender with the malicious content. Those conversations could be captured using Qbot’s Email\nCollector module which we will describe later.\n\n[We can see in Figure 4, Figure 5, and Figure 6, examples of such methods from samples submitted by @malware_traffic in their blog:](https://twitter.com/malware_traffic)\n\n**Figure 4 – Example of COVID-19 related email thread**\n\n\n-----\n\n**Figure 5 – Example of email thread for tax payment reminder**\n\n\n-----\n\n**gu e 6** a p e o e a t ead o job ec u t e t\n\nEach of these emails contains a URL to a ZIP with a malicious VBS – Visual Basic Script file.\n\nDuring our tracking of the malspam campaign, we have seen hundreds of different URLs for malicious ZIP dropping when most of them were\ncompromised WordPress sites.\n\n### VBS Infection\n\nThe VBS based infection method is rather new for the malware, and is being used since April 2020. In previous campaigns, the infection chain\nstarted with a Word document containing malicious macros.\n\nWhile the previous macros had simple obfuscation and string decoding, the VBS file contains several more advanced methods:\n\n**File Size – The file size is larger than 35MB, padded with** `NULL bytes. Big files are usually dismissed by various sandboxes due to`\nperformance limitations.\n\n**Sleep Timer – The script delays its execution by calling the Sleep API. This is another method for avoiding sandboxes.**\n\n**Obfuscation – The script contains multiple obfuscation methods such as those described in Figure 7.**\n\n**Figure 7 – VBS obfuscation methods**\n\n**Encryption – The VBS file downloads the Qbot payload from one of 6 possible hardcoded encrypted URLs. These URLs are encrypted by a**\ncustom XOR encryption 3 times with different keys that are built dynamically. We created an extraction script that can be accessed in\n**Appendix B.**\n\nIn order to support detection and hunting for additional malicious VBS files, We wrote a YARA rule which can be observed in Appendix A.\n\nSimilar to the old infection method, the VBS file downloads and executes the Qbot payload.\n\n## Qbot Payload\n\n### Version Analysis\n\nIn the course of our analysis, Qbot’s operators frequently upgraded its versions and encouraged us to track and analyze the changes in each\nand every version. The fact that the developers left a version tag marked in the samples, allowed us to perform this analysis easier.\n\nFor example, let’s have a look at the version tag as it shown in the unpacked sample below:\n\n\n-----\n\n**Figure 8 – Sample’s major and minor version**\n\nFrom that, we can deduct that the initial payload version is `325/5, while the main payload version is` `325/7 . (The major version is read as a`\nhex value)\n\nOver the last few months, we tracked the different versions of Qbot and identified some of the differences in each version, as can be seen in\nthe following table.\n\n\n**Major** **Minor** **Payload**\n**Minor**\n\n\n**Version**\n**Timestamp**\n\n\n**Notes**\n\n\n324 44 8 Jan 22, 2020 First version seen for major version 324.\n\n324 353 53 Mar 3, 2020\n\n324 375 65 Mar 13, 2020\n\n324 379 70 Mar 20, 2020 Added command 35 supporting hVNC module.\n\n324 383 74 Apr 1, 2020\n\n324 385 75 Apr 1, 2020\n\n324 388 79 Apr 8, 2020 Added command 10 – terminate process by name.\n\n324 390 127 Apr 10, 2020\n\n324 393 136 Apr 29, 2020 JS Updater resource is no longer included. JS Update commands has been\nrespectively adjusted.\n\n324 399 141 May 7, 2020 Added long list of blacklisted analysis programs part of anti-VM method.\n\n324 401 142 May 28, 2020\n\n325 5 7 July 29, 2020 Introduced new anti-analysis techniques.\nAdded anti-VM checks on server-side.\n\n325 7 13 July 31, 2020\n\n325 8 14 August 3, 2020\n\n325 35 42 August 7, 2020\n\n325 37 43 August 11, 2020 Last known version up to the writing of this article.\n\nThe date mentioned for each sample is based on the executable compilation time attribute. That field can be changed via timestomping, but\nwe suspect that it wasn’t forged in these cases.\n\nWe also tracked the timestamps of the main payload, and seen that the compilation time was consistently minutes apart from the initial\npayload’s:\n\n**Figure 9 – Comparing sample-to-payload compilation time**\n\n### Decryption Schemes\n\n\n-----\n\ne a a e p e e ts se e a e c ypt o sc e es to co cea ts u ct o a ty a d data o t e ct s, a d t us e do s o de to\nsuccessfully analyze the malware and its components, we had to automate the decryption process for all the variants.\n\nThe following table shows the different decryption and decoding methods:\n\n**Encrypted Data** **Algorithm** **Key Source**\n\nNetwork Data Base64 + RC4 `KEY = SHA1(ENCRYPTED[0:16] +`\n```\n                                        \"jHxastDcds)oMc=jvh7wdUhxcsdt2\")\n\n```\nPayload (Resource “307”) RC4 + Custom `KEY = ENCRYPTED[0:20]`\nCompression\n\nJavascript Updater File RC4 + Custom `KEY = ENCRYPTED[0:20]`\nCompression\n\nBot List (Resource “311”) and Initial Configuration RC4 `KEY = ENCRYPTED[0:20]`\n(Resource “308”)\n\nConfiguration “.dat” File, Web-Inject File, Hooking RC4 `KEY = SHA1(EXE_NAME)`\nModule\n\nStolen Information “.dll” File RC4 `srand(CRC32(BOT_ID))`\n```\n                                        KEY = RANDOM_STRING_32\n\n### Initial Payload\n\n```\nQbot’s initial payload has been covered extensively by fellow malware researchers. The latest versions have implemented several typical\nmalware components to reduce its visibility and toughen its analysis:\n\n**Packer – The executable has been reconstructed using a packer.**\n\n**Random Directory Name – Creating a working directory with randomized directory and file names to avoid file signatures. Directory location**\nis `%APPDATA%\\Microsoft . Working directory example can be observed at Figure 11.`\n\n**String Encryption – Containing encrypted strings using XOR encryption (applies also to other modules).**\n\n**Dynamic Import Table – Import table built dynamically based on encrypted strings (applies also to other modules).**\n\n**Anti-VM and Anti-Debug Techniques:**\n\nLatest versions are looking for VM-related artifacts on server-side. victim computer configuration is being enumerated and sent to the C2.\nBased on that information, the server decides whether is safe to “push” modules to the victim.\nLooking for “VMWare” port existence\nLooking for VM and analysis related processes. The latest versions also adds a long list of blacklisted analysis programs:\n```\nFiddler.exe;samp1e.exe;sample.exe;runsample.exe;lordpe.exe;regshot.exe;Autoruns.exe;dsniff.exe;VBoxTray.exe;HashMyFiles\nCFF\nExplorer.exe;dumpcap.exe;Wireshark.exe;idaq.exe;idaq64.exe;TPAutoConnect.exe;ResourceHacker.exe;vmacthlp.exe;OLLYDBG.EXE\nvision-agent-nai.exe;bds-vision-apis.exe; bds-vision-agentapp.exe;MultiAnalysis_v1.0.294.exe;x32dbg.exe;VBoxTray.exe;VBoxService.exe;Tcpview.exe\n\n```\nLooking for VM related device drivers. Examples:\n\n**Figure 10 – Device driver Anti-VM technique**\n\nLooking for a VM through `CPUID instruction`\nForcing exceptions to check if debugger is present\nChecking for sandbox signatures\n\n**P** **i t** A hi i i t th h i t l d t k h d l\n\n\n-----\n\ne e e t e a a e dec des t s sa e to u o t e ta geted syste, t dec ypts ts esou ce 30 as e p a ed abo e, jects t to e y\ncreated process `explorer.exe, calls a loader procedure which loads the DLL and calls the` `DllEntryPoint of the main payload.`\n\n### Main Payload\n\nThe main payload has multiple roles:\n\nCreating and maintaining the configuration of the malware.\nCreating and maintaining the messaging mechanisms – Named pipes, events, and custom Windows messages.\nInstalling and managing new modules – new feature.\nCreating and maintaining a proper communication channel with the C&C server.\nExecuting commands through a custom thread queue mechanism.\n\nThe payload has several more internal modules that we won’t elaborate on in this article such as – lateral movement capabilities, certificates\nharvesting, spam bot, and more.\n\nThe malware constructs its configuration out of several embedded resources that are unpacked and decrypted on runtime. The resources are:\n\n“308” – Initial configuration data.\n“311” – List of 150 bots IP addresses and ports for building a communication tunnel.\n\nThe working directory, as we can see in Figure 11, is an important part of the Qbot’s functionality, and is also used as a synchronization\nmethod between the modules.\n\n**Figure 11 – Example for Qbot’s working directory**\n\nQbot’s configuration files (end with `.dat ) and stolen information files (end with` `.dll ) are the most crucial. These files are accessed and`\nloaded by all of its modules.\n\n**Figure 12 – Configuration file**\n\n**Figure 13 – Stolen information file**\n\nOne of the questions we were asking ourselves at this point of the research was where can we find the real “banking” logic. Older versions of\nQbot contained multiple malicious modules as embedded resources, but recent versions were rather “clean”.\n\nTo understand that, we had to dive deeper into the communication protocol and find methods to fetch the malicious modules.\n\n\n-----\n\n## Communication Module\n\nResource “311”, as we stated previously, contains a list of 150 IP addresses of other bots for the victim to communicate with. Each of these\nbots will forward the traffic to the real C&C server or to a second-tier proxy as we will show later. This method is an efficient way of hiding the\nC&C IP address.\n\nAll the following messages are sent via `POST method to the next URL:` `https://<BOT_IP>:<BOT_PORT>/t3 and are encrypted with a`\nrandom initialization value. To make it easier understanding the logic, we will show only the decrypted network data.\n\nThe C&C communication data is sent in JSON format, where each property is identified by unique numerical ID. As we can see later in sample\nmessages, most important JSON property is its message code which holds the key `8 . We were able to map the next unique message codes:`\n\n**Victim → C&C:**\n```\n1 – Request the next command from C&C.\n2 – Ack for a command given by C&C.\n4 – Computer configuration and process enumeration.\n7 – Report of stolen information.\n8 – Open ports message.\n9 – Keep-alive message.\n\n```\n**C&C → Victim:**\n```\n5 – Server Ack.\n6 – Command to execute.\n\n```\nThe program holds two parallel networking loops – Keep-alive and report session, and Command Execution Session.\n\n### Keep-alive and Report Session\n\nThis session is pretty simple. The program alternates between keep-alive message to stolen information report message. For each such\nmessage, it will receive a server ack. These messages will look as follows:\n\n**Keep-alive Message**\n```\n// Victim -> C&C\n{\n  \"8\": 9, // MSG code\n  \"1\": 17, // Network protocol version\n  \"2\": \"powqdc619830\" // Victim BOT ID\n}\n\n```\n**Report Stolen Information Message**\n\nTakes the encrypted `.dll file of the stolen information, and sends it.`\n```\n// Victim -> C&C\n{\n  \"8\": 7, // MSG code\n  \"1\": 17, // Network protocol version\n  \"2\": \"powqdc619830\", // Victim BOT ID\n  \"3\": \"spx145\", // Bot group\n  \"6\": 223,\n  \"7\": 4763,\n  \"36\": \"617c...icR67==\" // Base64 encoded and encrypted information\n}\n\n```\n**Keep-alive and Report Response**\n```\n// C&C -> Victim\n{\n  \"8\": 5, // MSG code\n  \"16\": 270544960, // Victim IP address\n  \"39\": \"mzJzbJU\", // Random data\n  \"38\": 1\n}\n\n### Command Execution Session\n\n```\n\n-----\n\ne a a e equest e co a ds pe od ca y a d e ecute t e acco d g to t e o o g co a d tab e e tab e co ta s t e\nappropriate command ID and its handler.\n\n**Figure 14 – Qbot’s command table**\n\nThe command request message will have the next structure:\n```\n{\n  \"8\": 1, // MSG code\n  \"1\": 17, // Network protocol version\n  \"2\": \"powqdc619830\", // Victim BOT ID\n  \"3\": \"b\", // Bot group\n  \"4\": 804, // Payload major version\n  \"5\": 141,  // Payload minor vesion\n  \"10\": \"1582872269\", // Timestamp\n  \"6\": 6210,\n  \"7\": 6278,\n  \"14\": \"U3HphEKFiQcKFFe0LUVZNDO9vsJ9zdEf09\"\n}\n\n```\nA typical response would look like the following:\n```\n{\n  \"8\": 6, // MSG code\n  \"15\": \"...\",\n  \"16\": 270544960, // Victim IP address\n  \"18\": 252,\n  \"19\": 31, // command ID to execute\n  \"20\": [\"TVqQAAM...=\"], // command payload\n  \"39\": \"<RANDOM_STRING>\" // Random data\n}\n\n### Module Fetching\n\n```\nDuring the research we were able to map several downloaded modules, some of which were newly added as we could see in version break\ndown.\n\nWe noticed that whenever a new Bot ID is being “registered” by the C&C server, on the next command request it will receive the next modules\nto download and install:\n\n**Executable Update – Updates the current executable with a newer version or newer bot list. The C&C periodically pushes updates to all of its**\nvictims.\n\n**Email Collector Module – Extracts all e-mail threads from the victim’s Outlook client by using** `MAPI32.dll API, and uploads it to a`\nhardcoded remote server. These stolen e-mails will be utilized for the malspam to come later.\n\n\n-----\n\n**Figure 15 – Email collector module**\n\n**Hooking Module – The module injects itself to all running processes, and hooks relevant API functions. Sample hooking table:**\n\n**Figure 16 – Hooking module**\n\n**Web-Inject File – The file provides the injector module with a list of websites and JavaScript code that will be injected if the victim visits any of**\nthese websites.\n\nWe can see the results of visiting one of the actor’s targets – Chase Bank.\n\n**Figure 17 – HTML source code example for an injected target**\n\n**Password Grabber Module – a large module that downloads Mimikatz and tries to harvest passwords.**\n\n**Figure 18 – Password grabber module**\n\n\n-----\n\n**C** **ug** o s co t o g t e ct ac e t oug a e ote C co ect o at s, a e te a ope ato ca pe o ba\ntransactions without the user’s knowledge, even while he is logged into his computer. The module shares a high percentage of code with\nsimilar modules like TrickBot’s hVNC.\n\n**Figure 19 – Hidden VNC plugin**\n\n**JS Updater Loader – Decrypts and writes a Javascript updater script. Until recently, the script came as an encrypted resource inside the**\npayload. Because the script contains encrypted hardcoded URLs, the new method makes it easier for the operator to push updated domains to\nthe victims.\n\nWe wrote a Python script for ease URL extraction from a given script which can be observed in Appendix C.\n\n**Figure 20 – JS updater script example**\n\n**Cookie Grabber Module – targets popular browsers: IE, Edge, Chrome, and Firefox.**\n\n**Figure 21 – Cookie grabber module**\n\nWe can identify these modules through a traffic capture program:\n\n\n-----\n\n**Figure 22 – Downloaded modules in Fiddler**\n\nOnce the victim has been infected, their computer is compromised, and they are also a potential threat to other computers in the local network\nbecause of Qbot’s lateral movement capabilities. The malware then checks whether the victim can also be a potential bot as part of Qbot’s\ninfrastructure.\n\n## From a Victim to a Bot\n\n[McAfee has published a great article 3 years ago in which they covered important details regarding the bot proxy module. To understand the](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/mcafee-discovers-pinkslipbot-exploiting-infected-machines-as-control-servers-releases-free-tool-to-detect-disable-trojan/)\ncomplete infection chain process we felt there is more to discover regarding that module, and ways of fetching it.\n\nTo reach that goal, we started analyzing Qbot’s efforts of converting an innocent victim machine into an active bot, and being part of the C&C\ninfrastructure. To do so, the malware does the following:\n\nExecute shell commands to allow incoming connections in the host firewall.\nSending crafted UPnP commands to allow port forwarding.\nWhenever it creates the opened ports list, the program verifies whether the incoming connection is really allowed by sending the next\nmessage to a remote bot and waiting for a connection.\n\nURL – `https://<BOT_IP>:<BOT_PORT>/bot_serv`\nSample payload:\n```\n         cmd=1&msg=J3zeJrBLh2sGU4ql0EIr9MncSBCnK&ports=443,995,993,465,990,22,2222,2078,2083,2087,1194,8443,20,21,\n\n```\nThe remote bot tries to connect using the specified ports to the victim. If the victim receives the data they expected ( msg variable), then\nit’s a sign of a successful incoming connection.\nRemove the port listening.\n\nWhen the program finishes verifying its potential ports, it forms message code `8 and sends it to the C&C server:`\n\n\n-----\n\n```\n  \"8\": 8, // MSG code\n  \"1\": 17, // Network protocol version\n  \"2\": \"jnugfv895664\", // Victim BOT ID\n  \"4\": 3,\n  \"5\": 111,\n  \"55\": 270544960, // External IP of the potential bot\n  \"56\": [443, 995, 993, 465, 990, 22, 2222, 2078, 2083, 2087, 1194, 8443, 20, 21, 53, 80, 3389, 6881, 6882, 6883, 32100, 32101,\n32102, 32103, 50000, 50001, 50002, 50003, 50010, 61200, 61201, 61202] // Potential ports\n}\n\n```\nWhen the program does this specific process, we could observe that on the next command execution request, we will receive a proxy module\ninstallation with the relevant port to listen:\n```\n{\n  \"8\": 6, // MSG code\n          ...\n  \"19\": 25, // command ID\n  \"20\": [\"TVqQAAM...=\", \"prt=443\", \"n=jnugfv895664\"], // command payload\n          ...\n}\n\n```\nWe can visualize the process with the next diagram, and observe it through a traffic capture program:\n\n**Figure 23 – Network flow for proxy module download**\n\n**Figure 24 – Downloaded proxy module in Fiddler**\n\n### Analyzing Proxy Module\n\nThe proxy module is loaded by `rundll32.exe, and copied into its working folder –` `C:\\ProgramData\\FilesystemMonitor\\ . If it is given`\n```\nSYSTEM privileges, it creates a new service named fsmon, otherwise updates CurrentVersion\\Run registry value.\n\n```\nMost of the module’s codebase is taken from the following open-source libraries:\n\n\n-----\n\n`bcu` o equests\n```\n   OpenSSL 1.0.2r 26 Feb 2019 – Used for certificate creation, and signature validation.\n   miniupnp – For port opening.\n\n```\nIt also contains 3 hard-coded IP addresses of the second-tier proxy server.\n\nThe module hasn’t changed a lot since McAfee’s publication 3 years ago. The changes we could find were:\n\nThe service name, description, working folder, window name, and executable name has been changed. For example, the service name\nwas changed from `hwmon to` `fsmon .`\nOpenSSL version has been upgraded from `1.0.2f to` `1.0.2r .`\nUpdated Tier 2 Proxy servers.\n\nOne rather interesting feature of the proxy module is its control API. The threat group behind Qbot has developed a control API to the proxy\nwhich is independent of the malicious payload update mechanism. That API is also unique, mainly because it receives control messages by\npushing and not by pulling, which could expose the bots to external actors’ control.\n\nThe protocol is rather simple and can be observed in the next diagram:\n\n**Figure 25 – Network flow for proxy module control API**\n\nThe signature is being verified against the hardcoded public key of the actor. Hence, unless we possess the private key, the protocol is\nextremely hard to break.\n\n## Conclusion\n\nThis article analyzes two aspects of the threat – the campaign that leads to the infection of the victim, and the complex multi-layered malware\nwhich is constantly evolving. The article also covers several miscellaneous topics regarding its version history in the past year, decryption\nmethods, communication samples, proxy server control API, and more.\n\nThese days Qbot is much more dangerous than it was previously – it has active malspam campaign which infects organizations, and it\nmanages to use a “3rd party” infection infrastructure like Emotet’s to spread the threat even further. It seems like the threat group behind Qbot\nis evolving its techniques through the years, and Check Point Research hopes that the information in this article will help the researchers\naround the globe to mitigate and potentially stop Qbot’s activity.\n\nCheck Point **[SandBlast Agent protects against such attacks, and is capable of preventing them from the very first step.](https://www.checkpoint.com/products/advanced-endpoint-protection/)**\n\n## IOC\n\n\n-----\n\na y Qbot a d S sa p es e e a a y ed du g t e esea c e e attac g t e ece t sa p es a d odu es o /06/ 0 0\n\n### Hashes\n```\n9001DF2C853B4BA118433DD83C17617E7AA368B1 – VBS Dropper\n449F2B10320115E98B182204A4376DDC669E1369 – Qbot Sample SPX145\nF85A63CB462B8FD60DA35807C63CD13226907901 – Mail Collector Module Loader [Decrypted]\nB4BC69FF502AECB4BBC2FB9A3DFC0CA8CF99BA9E – Javascript Updater Loader [Decrypted]\n1AAA14A50C3C3F65269265C30D8AA05AD8695B1B – Javascript Updater [Decrypted]\n577522512506487C63A372BBDA77BE966C23CBD1 – Hooking Module Loader [Decrypted]\n75107AEE398EED78532652B462B77AE6FB576198 – Cookie Grabber Module [Decrypted]\n674685F3EC24C72458EDC11CF4F135E445B4185B – Password Grabber Module [Decrpyted]\nBECD8F2D6289B51981F07D5FF52916104D764DD5 – hVNC Module [Decrpyted]\n18E8971B2DE8EA3F8BB7E1462E414DA936425D4E – Proxy Module Loader [Decrypted]\n4C96D2BCE0E12F8591999D4E00498BCDB8A116DE – Proxy Module\n\n Domains and IPs\n\n```\n**ZIP File URL**\n```\nhxxps://factory-hot[.]com/bafmxby/CcdEhoQGHq.zip\n\n```\n\n**VBS Dropper URLs**\n```\nhxxp://kiesow-auto[.]de/foojapfsyds/5555555.png\nhxxp://test[.]africanamericangolfersdigest[.]com/kkmthjsvf/5555555.png\nhxxp://frankiptv[.]com/liehyidqtu/5555555.png\n\n```\n\n**Web-Inject URLs**\n```\nhxxps://fortinet-cloud[.]com/wbj/br/content/chase/tom/ajax.js\nhxxps://fortinet-cloud[.]com/wbj/br/content/key/tom/ajax.js\nhxxps://fortinet-cloud[.]com/wbj/br/content/schwab/tom/schw.js\nhxxps://fortinet-cloud[.]com/wbj/br/content/bbt/tom/bbt.js\nhxxps://fortinet-cloud[.]com/wbj/att/js/AMAZON.js\nhxxps://fortinet-cloud[.]com/wbj/crt/uadmin/inj_src/usa/amex2019/script.js\nhxxps://fortinet-cloud[.]com/wbj/crt/uadmin/inj_src/usa/costco/costco.min.js\nhxxps://fortinet-cloud[.]com/wbj/crt/uadmin/inj_src/usa/verizon/script.js\n\n```\n\n**Mail Collector Remote Server**\n```\nhxxps://82.118.22[.]125/bgate\n\n```\n\n**Mimikatz URL Download**\n```\nhxxps://onedrive.live[.]com/download.aspx?\ncid=CE32720D26AED2D5&authKey=%21AHHhrhk9od5OCBU&resid=CE32720D26AED2D5%21111&ithint=%2Eps1\n\n```\n**Tier 2 Proxy Servers**\n```\n46.228.199.235:443\n93.88.75.176:443\n207.244.112.112:443\n\n```\n**Javascript Updater URLs**\n```\nhxxp://backup.justthebooks[.]com/datacollectionservice.php3\nhxxp://asn.crs.com[.]pa/datacollectionservice.php3\n\n```\n\n**Bot List**\n\n\n-----\n\n```\n156.213.80.140:443\n189.160.203.110:443\n71.114.39.220:443\n189.236.166.167:443\n193.248.44.2:2222\n206.51.202.106:50003\n24.152.219.253:995\n2.50.47.97:2222\n108.49.221.180:443\n207.246.75.201:443\n80.240.26.178:443\n199.247.16.80:443\n207.255.161.8:2222\n69.92.54.95:995\n199.247.22.145:443\n2.50.171.142:443\n24.110.14.40:3389\n79.101.130.104:995\n94.52.160.116:443\n172.243.155.62:443\n188.192.75.8:443\n175.111.128.234:443\n74.129.18.56:443\n36.77.151.211:443\n203.45.104.33:443\n118.160.162.77:443\n86.126.97.183:2222\n185.246.9.69:995\n140.82.21.191:443\n66.208.105.6:443\n206.183.190.53:993\n5.12.111.213:443\n72.177.157.217:995\n98.210.41.34:443\n98.242.36.86:443\n199.116.241.147:443\n49.144.81.46:8443\n75.110.250.89:995\n219.76.148.142:443\n70.174.3.241:443\n71.205.158.156:443\n78.96.192.26:443\n108.190.151.108:2222\n81.133.234.36:2222\n12.5.37.3:995\n210.61.141.92:443\n173.70.165.101:995\n5.13.84.186:995\n68.46.142.48:443\n188.27.6.170:443\n188.173.70.18:443\n86.124.13.101:443\n5.13.74.26:443\n68.190.152.98:443\n96.56.237.174:990\n175.143.12.8:443\n79.113.224.85:443\n2.51.240.61:995\n95.76.27.89:443\n5.12.243.211:443\n24.183.39.93:443\n86.124.228.254:443\n5.193.178.241:2078\n2.88.186.229:443\n108.227.161.27:995\n188.192.75.8:995\n98.32.60.217:443\n176.223.35.19:2222\n24.42.14.241:443\n\n```\n\n-----\n\n```\n68.225.56.31:443\n191.84.11.112:443\n72.204.242.138:50001\n173.22.120.11:2222\n64.121.114.87:443\n68.60.221.169:465\n92.17.167.87:2222\n47.138.200.85:443\n71.187.7.239:443\n151.205.102.42:443\n72.179.13.59:443\n172.113.74.96:443\n5.193.61.212:2222\n47.28.135.155:443\n188.26.243.186:443\n41.228.206.99:443\n117.218.208.239:443\n203.122.7.82:443\n39.36.61.58:995\n49.207.105.25:443\n59.124.10.133:443\n89.44.196.211:443\n79.117.129.171:21\n24.110.96.149:443\n184.90.139.176:2222\n82.79.67.68:443\n86.153.98.35:2222\n101.108.4.251:443\n209.182.122.217:443\n89.32.220.79:443\n104.50.141.139:995\n85.204.189.105:443\n94.10.81.239:443\n211.24.72.253:443\n110.142.205.182:443\n86.124.105.88:443\n72.90.243.117:0\n41.225.231.43:443\n87.65.204.240:995\n62.121.123.57:443\n47.153.115.154:990\n66.30.92.147:443\n49.191.4.245:443\n47.180.66.10:443\n97.93.211.17:443\n65.100.247.6:2083\n65.131.43.76:995\n45.45.51.182:2222\n98.219.77.197:443\n166.62.180.194:2078\n72.16.212.108:995\n73.217.4.42:443\n76.187.8.160:443\n67.182.188.217:443\n37.182.238.170:2222\n117.216.227.70:443\n74.222.204.82:443\n89.137.77.237:443\n82.77.169.118:2222\n188.27.36.190:443\n108.39.93.45:443\n72.181.9.163:443\n58.233.220.182:443\n73.137.187.150:443\n97.127.144.203:2222\n103.76.160.110:443\n37.156.243.67:995\n67.246.16.250:995\n182.185.7.220:995\n\n```\n\n-----\n\n### Other IOC\n\n**Proxy Service Name**\n```\nfsmon\n\n```\n\n**Proxy Service Display name**\n```\nFilesystem Monitor\n\n```\n\n**Proxy File Paths**\n```\nC:\\ProgramData\\FilesystemMonitor\\fsmonitor.dll\nC:\\ProgramData\\FilesystemMonitor\\fsmonitor.ini\n\n```\n\n**Proxy Executable Command Line**\n```\nC:\\Windows\\SysWOW64\\rundll32.exe \"C:\\ProgramData\\FilesystemMonitor\\fsmonitor.dll\",FsMonServerMainNT\nC:\\Windows\\SysWOW64\\rundll32.exe \"C:\\ProgramData\\FilesystemMonitor\\fsmonitor.dll\",#1\n\n```\n\n**Proxy RSA Public Key**\n```\n-----BEGIN RSA PUBLIC KEY----MIIBCgKCAQEA4zJC+AO8v7U9WGOdqeqMn9CPrdgoz//B+f/xxb4UnSNM1NJ1RwTG\nN2jf6JRRD2gZz9735DU4I9FlIDEiRDdNn4OxX76L5eKe2GF4/etZ23DfuomMNXVw\nqwYcO8A7zjzG0+ybQH35eNoYJMJDwPOBWb/nHBlPNWXoyv7u8EzScENMBpfKWuMW\nUgmV08dulHPPyi9fjSsY3DLo5zNE6A8UEk2e2R2UkmiDbENOARgsfwHosyqEcBGc\nPk/+EismU1rsabaQV/sHw1zQQ9vAH+27d/T13hCuIgq1B3vRYFIrPkJYAdaxOwto\nAHn0rjeAN4tEIdDQ10RCriEmnNEBfxA9BwIDAQAB\n-----END RSA PUBLIC KEY----\n## Appendix\n\n### Appendix A: YARA Rule for VBS Hunting\nrule qbot_vbs\n{\n  meta:\n    description = \"Catches QBot VBS files\"\n    author = \"Alex Ilgayev\"\n    date = \"2020-06-07\"\n  strings:\n    $s3 = \"ms.Send\"\n    $s4 = \"for i=1 to 6\"\n    $s5 = \"if ms.readyState = 4 Then\"\n    $s6 = \"if len(ms.responseBody) <> 0 then\"\n    $s7 = /if left\\(ms.responseText, \\w*?\\) = \\\"MZ\\\" then/\n  condition:\n    filesize > 20MB and $s3 and $s4 and $s5 and $s6 and $s7\n}\n\n Appendix B: VBS URL Extraction Script\n\n```\n\n-----\n\n```\nThis script is for research purposes, and far from production ready (missing exception handling and more).\n\"\"\"\nimport re\nimport os\nimport sys\ndef remove_additions(lines):\n  \"\"\"Removes stub calculations. \n  Example:\n  IZLmoJg = 277 + 15 + 23 + 468 - 345 - 18 - 471 - 15 + 617\n  Will be replaced with:\n  IZLmoJg = 551\n  Args:\n    lines (list): List of lines.\n  Returns:\n    list: List of modified lines.\n  \"\"\"\n  pattern = r'(([0-9]{1,15} [\\+,\\-] )+[0-9]{1,15})'\n  new_file = []\n  for line in lines:\n    line = line.strip()\n    res = re.search(pattern, line)\n    if res:\n      new_line = re.sub(pattern, lambda x:str(eval(x.group(1))), line)\n    else:\n      new_line = line\n    new_file.append(new_line)\n  return new_file\ndef remove_chr(lines):\n  \"\"\"Replaces \"chr(*)\" with their respective characters.\n  Args:\n    lines (list): List of lines.\n  Returns:\n    list: List of modified lines.\n  \"\"\"\n  pattern = r'[c,C]hr\\((\\d?\\d?\\d?)\\)'\n  new_file = []\n  for line in lines:\n    line = line.strip()\n    res = re.search(pattern, line)\n    if res:\n      new_line = re.sub(pattern, lambda match: '\\\"' + str(chr(int(match.group(1)))) + '\\\"', line)\n    else:\n      new_line = line\n    new_file.append(new_line)\n  return new_file\ndef remove_replace(lines):\n  \"\"\"Replaces \"replace(*)\" with its respective string.\n  Args:\n    lines (list): List of lines.\n  Returns:\n    list: List of modified lines.\n  \"\"\"\n  pattern = r'replace\\(\\\"(.*)\\\"\\, \\\"(.*)\\\"\\, \\\"(.*)\\\"\\)'\n  new_file = []\n  for line in lines:\n    line = line.strip()\n    res = re.search(pattern, line)\n    if res:\n      new_line = re.sub(pattern, \n        lambda match: '\\\"' + match.group(1).replace(match.group(2), match.group(3)) + '\\\"'\n     ,line)\n    else:\n      new_line = line\n     new file append(new line)\n\n```\n\n-----\n\n```\ndef remove_concat(lines):\n  \"\"\"Replaces the VB concatenation sign \"&\" with the result string.\n  Args:\n    lines (list): List of lines.\n  Returns:\n    list: List of modified lines.\n  \"\"\"\n  pattern = r'\\\"(.*)\\\"\\&\\\"(.*)\\\"'\n  new_file = []\n  for line in lines:\n    line = line.strip()\n    res = re.search(pattern, line)\n    if res:\n      new_line = re.sub(pattern, \n        lambda match: '\\\"' + match.group(1) + match.group(2) + '\\\"'\n     ,line)\n    else:\n      new_line = line\n    new_file.append(new_line)\n  return new_file\ndef remove_trailing_zeros(lines):\n  \"\"\"Removes all trailing NULL bytes from a file.\n  Args:\n    lines (list): List of lines.\n  Returns:\n    list: List of modified lines.\n  \"\"\"\n  new_file = []\n  for line in lines:\n    if len(line) > 0 and line[0] == '\\x00':\n      continue\n    new_file.append(line)\n  return new_file\ndef deobfuscate_file(fpath_in, fpath_out):\n  \"\"\"Converts Qbot VBS script into it's deobfuscated form.\n  Main changes are:\n  - removing stub calculations\n  - converting \"chr(*)\" into their respective characters.\n  - converting \"replace(*)\" into its respective string.\n  - converting VB concatenations (\"&\") into the final string.\n  - removing trailing NULL bytes.\n  Args:\n    fpath_in (str): Input VBS file path.\n    fpath_out (str): Output file path.\n  \"\"\"\n  try:\n    with open(fpath_in, 'r') as f_in:\n      in_data = f_in.read()\n  except:\n    return None\n  lines = in_data.split('\\n')\n  lines = remove_additions(lines)\n  lines = remove_chr(lines)\n  lines = remove_replace(lines)\n  for _ in range(100):\n    lines = remove_concat(lines)\n  lines = remove_trailing_zeros(lines)\n  new_file_joined = '\\n'.join(lines)\n  try:\n    with open(fpath_out, 'w') as f_out:\n      f_out.write(new_file_joined)\n  except:\n    return None\ndef decrypt_data(enc_str, keys):\n  \"\"\"Decrypts long blob of text data.\n  decryption method is looking for patterns of decimal numbers\n\n```\n\n-----\n\n```\n  do that with three different keys.\n  Arguments:\n    enc_str {string} -- encrypted data\n    key1 {int} -- first key\n    key2 {int} -- second key\n    key3 {int} -- third key\n  \"\"\"\n  def _decrypt_data_inner(str_param, key_param):\n    \"\"\"Helper method. actual decryption.\n    \"\"\"\n    numbers = \"\"\n    ret_decrypted = \"\"\n    f = True\n    for i in range(len(str_param)):\n      if '0' <= str_param[i] <= '9':\n        numbers = numbers + str_param[i]\n        f = True\n      else:\n        if f:\n          try:\n            enc_ch = int(numbers)\n          except:\n            break\n          dec_ch = enc_ch ^ key_param\n          ret_decrypted = ret_decrypted + chr(dec_ch)\n        numbers = \"\"\n        f = False\n    return ret_decrypted\n  key1 = keys[0]\n  key2 = keys[1]\n  key3 = keys[2]\n  enc_str = _decrypt_data_inner(enc_str, key1)\n  enc_str = _decrypt_data_inner(enc_str, key2)\n  return _decrypt_data_inner(enc_str, key3)\nclass qbot_vbs(object):\n  \"\"\"Encapsulates qbot VBS artifacts.\n  These artifacts are used for extraction.\n  \"\"\"\n  num_urls = 0\n  enc_str = None\n  key_str = None\n  seed = 0\n  key_idxs = [None, None, None]\n  def __init__(self, data):\n    self.data = data\n    self.lines = data.split('\\n')\n  def _extract_number_urls(self):\n    \"\"\"Extracts number of encrypted urls.\n    \"\"\"\n    # sample:\n    # number of urls: for i=1 to 6\n    pattern = r'[F,f]or i=1 to (\\d+)'\n    res = re.search(pattern, '\\n'.join(self.lines))\n    self.num_urls = int(res.group(1))\n  def _extract_enc_str(self):\n    \"\"\"Extracts the string which has the encrypted data.\n    should be the biggest line in the script.\n    \"\"\"\n    max_len = 0\n    max_idx = -1\n    for i, line in enumerate(self.lines):\n      if len(line) > max_len and line[0] != '\\x00':\n        max_len = len(line)\n        max_idx = i\n    # removing variable name.\n    res = re.search(r'^\\w+ = \\\"(.*)\\\"$', self.lines[max_idx])\n    self.enc_str = res.group(1)\n  def _extract_key_str(self):\n    \"\"\"Extracts the string which the key is based upon.\n    should be called after `extract_enc_str()`.\n    should be the second biggest line after encrypted string.\n    \"\"\"\n    second_max_len = 0\n     second max idx = 1\n\n```\n\n-----\n\n```\n    for i, line in enumerate(self.lines):\n      if len(line) > second_max_len and len(line) < max_len and line[0] != '\\x00':\n        second_max_len = len(line)\n        second_max_idx = i\n    # removing variable name.\n    res = re.search(r'^\\w+ = \\\"(.*)\\\"$', self.lines[second_max_idx])\n    self.key_str = res.group(1)\n  def _extract_seed_and_key_indexes(self):\n    \"\"\"Helper function for key extraction.\n    \"\"\"\n    def _find_variables(var1_name, var2_name):\n      \"\"\"Finds variables values for two vars.\n      for example:\n      DgZlWOk = 8\n      jRryhge = 4\n      \"\"\"\n      pattern1 = fr'^{var1_name} = (\\d+)$'\n      pattern2 = fr'^{var2_name} = (\\d+)$'\n      var1_value = None\n      var2_value = None\n      for line in self.lines:\n        res = re.search(pattern1, line)\n        if res:\n          var1_value = res.group(1)\n        res = re.search(pattern2, line)\n        if res:\n          var2_value = res.group(1)\n      return var1_value, var2_value\n    def _extract_key_indexes(lines):\n      # we have 6 'Mid' encounters:\n      # yaGlYs = Mid(xHAaMv, 10, 2)\n      # RLquKjB = Asc(Mid(HIbAriX, seSclZ, 1))\n      # three times.\n      # the second is not interesting for us.\n      text = '\\n'.join(lines)\n      res = re.findall(r'Mid\\(\\w+\\, (\\w+)\\, \\w+\\)', text)\n      # the key creation order is reversed to their using. (first key3 is set and so on)\n      self.key_idxs[0] = int(res[4])\n      self.key_idxs[1] = int(res[2])\n      self.key_idxs[2] = int(res[0])\n    # sample line:\n    # For uLRYNs = 0 To 2387414 Step 1\n    pattern1 = r' (238\\d\\d\\d\\d) '\n    # sample line:\n    # YLTCm = YLTCm + DgZlWOk - jRryhge\n    pattern2 = r'^(\\w+) = (\\1) \\+ (\\w+) - (\\w+)$'\n    for i, line in enumerate(self.lines):\n      res = re.search(pattern1, line)\n      if res:\n        num = int(res.group(1))\n        _extract_key_indexes(self.lines[i+1:])\n        for inner_line in self.lines[i+1:i+10]:\n          res = re.search(pattern2, inner_line)\n          if res:\n            first_param = res.group(3)\n            second_param = res.group(4)\n            first_value, second_value = _find_variables(first_param, second_param)\n            num += 1\n            num *= (int(first_value) - int(second_value))\n            self.seed = num\n            return\n  def extract_keys(self):\n    \"\"\"Main extraction method.\n    Extracts keys for the URL decryption.\n    Returns:\n      list: List of 3 keys.\n    \"\"\"\n\n```\n\n-----\n\n```\n    vbs._extract_enc_str()\n    vbs._extract_key_str()\n    vbs._extract_seed_and_key_indexes()\n    seed = self.seed * 999999\n    str_seed = str(seed)\n    idx = int(str_seed[self.key_idxs[2] - 1:self.key_idxs[2] + 1])\n    key3 = ord(self.key_str[idx - 1])\n    idx = int(str_seed[self.key_idxs[1] - 1:self.key_idxs[1] + 1])\n    key2 = ord(self.key_str[idx - 1])\n    idx = int(str_seed[self.key_idxs[0] - 1:self.key_idxs[0] + 1])\n    key1 = ord(self.key_str[idx - 1])\n    return key1, key2, key3\nif __name__ == \"__main__\":\n  if len(sys.argv) != 2:\n    print(f\"Usage: python {os.path.basename(__file__)} <fpath_in>\")\n    exit(1)\n  fname_tmp = 'tmp'\n  deobfuscate_file(sys.argv[1], fname_tmp)\n  if not os.path.exists(fname_tmp):\n    print(\"Failed de-obfuscation script.\")\n    exit(0)\n  with open(fname_tmp) as f:\n    data = f.read()\n  os.remove(fname_tmp)\n  vbs = qbot_vbs(data)\n  keys = vbs.extract_keys()\n  dec = decrypt_data(vbs.enc_str, keys).strip('\\ufeff').split('_______')\n  for i in range(vbs.num_urls):\n    url = dec[i]\n    url = url.split('?')[0].strip()\n    print(url)\n\n### Appendix C: JavaScript Updater URL Extraction Script\n\n```\n\n-----\n\n```\nimport os\ndef extract_urls_from_js_updater(js_data):\n  \"\"\"Extracts update URLs out of given Qbot Javascript updater.\n  Args:\n    js_data (str or bytes): Javascript code content.\n  Returns:\n    list: Returns list of extracted URLs or None if falied.\n  \"\"\"\n  try:\n    if isinstance(js_data, bytes):\n      js_data = js_data.decode('ascii')\n  except:\n    return None\n  arrays = []\n  # var WcrApaqyDNEBJYsFkiXPVzHCeKGmnxd = [30,209...19];\n  # encrypted urls\n  pattern = re.compile(r\"^\\s*var [a-zA-Z0-9]+\\s?=\\s?\\[(([0-9]+,)+)([0-9]+)\\];$\")\n  for line in js_data.splitlines():\n    match = pattern.match(line)\n    if match:\n      array = match.group(1) + match.group(3)\n      arrays.append(array)\n  if not len(arrays) == 2:\n    return None\n  suffix = 'datacollectionservice.php3'\n  # encrypted text\n  base_values = [int(c) for c in arrays[0].split(\",\")]\n  # key\n  xor_values = [int(c) for c in arrays[1].split(\",\")]\n  res = \"\"\n  for i in range(len(base_values)):\n    res += chr(base_values[i] ^ xor_values[i % len(xor_values)])\n  servers = res.split(\";\")\n  urls = ['https://' + server + '/' + suffix for server in servers]\n  return urls\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-27 - An Old Bot’s Nasty New Tricks- Exploring Qbot’s Latest Attack Methods.pdf"
    ],
    "report_names": [
        "2020-08-27 - An Old Bot’s Nasty New Tricks- Exploring Qbot’s Latest Attack Methods.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536046,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1653707441,
    "ts_modification_date": 1653707441,
    "files": {
        "pdf": "https://archive.orkl.eu/5f1cc73fd5574507b4ad7f5dc705ccb8fb005b9a.pdf",
        "text": "https://archive.orkl.eu/5f1cc73fd5574507b4ad7f5dc705ccb8fb005b9a.txt",
        "img": "https://archive.orkl.eu/5f1cc73fd5574507b4ad7f5dc705ccb8fb005b9a.jpg"
    }
}