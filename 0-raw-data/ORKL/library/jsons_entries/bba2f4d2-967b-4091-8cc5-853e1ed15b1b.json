{
    "id": "bba2f4d2-967b-4091-8cc5-853e1ed15b1b",
    "created_at": "2023-01-12T14:59:40.405016Z",
    "updated_at": "2025-03-27T02:16:39.978412Z",
    "deleted_at": null,
    "sha1_hash": "bb7f068f8965e152d02f94be4180a3dcabc4b50d",
    "title": "2022-01-13 - Threat Thursday- Jupyter Infostealer is a Master of Disguise",
    "authors": "",
    "file_creation_date": "2022-05-28T23:20:04Z",
    "file_modification_date": "2022-05-28T23:20:04Z",
    "file_size": 7392116,
    "plain_text": "# Threat Thursday: Jupyter Infostealer is a Master of Disguise\n\n**[blogs.blackberry.com/en/2022/01/threat-thursday-jupyter-infostealer-is-a-master-of-disguise](https://blogs.blackberry.com/en/2022/01/threat-thursday-jupyter-infostealer-is-a-master-of-disguise)**\n\nThe BlackBerry Research & Intelligence Team\n\n### Summary\n\nJupyter infostealer is a master of deception, a highly modular malware that hides deep\nwithin legitimate installer packages. Once executed, it can receive further malicious\ncomponents via its command-and control (C2) server to enhance its capabilities. These\ncomponents can include executables and malicious PowerShell scripts.\n\nOne of the downloads is an information stealing module, designed to scoop up victim\ncredentials like their computer name, user admin rights, workgroup, browser password\ndatabase, and other useful information. It also targets popular browsers such as Google\nChrome™, Microsoft Edge®, Opera, Brave, and Mozilla Firefox. Upon finding one of these\nbrowsers installed, it gathers and exfiltrates sensitive user data stored within these\nbrowsers, such as login data (usernames and passwords), cookies, and web data, including\n“autofill” information such as the user’s name, home address, and email address.\n\n\n-----\n\nIt also targets a large number of crypto wallets, including Atomic Wallet, MyMonero Wallet,\nand Ethereum Wallet, and additionally seeks to access several Remote Access Applications\nincluding OpenVPN and Remote Desktop Protocol (RDP).\n\nThis malware is particularly noxious, as it does not target specific organizations or business\nverticals, and it does not have a set goal or agenda. It targets all victims who inadvertently\nfall for its ploys.\n\n### Discovery and Execution\n\nWhen Jupyter was first discovered at the end of 2020, it initially bundled itself with\nlegitimate executables. When executed, it revealed an obfuscated PowerShell script hidden\nwithin. Throughout 2021, this threat group has focused its development efforts on\nincreasing levels of stealth and obfuscation, including loading the Dynamic-Link Library\n(.DLL) of Jupyter reflectively into memory rather than writing the file to disk.\n\nIn its current form, Jupyter now tends to be bundled in large Windows® installer packages\n(.MSI), often exceeding 100 MB in size. These packages are still bundled with legitimate\napplications, and also signed with valid digital certificates to further hide their intentions.\n\nOn installation, the package will load and attempt to install the bundled legitimate\napplication. However, deep within the code of these Trojan installers resides a relatively\nsmall, heavily obfuscated and encrypted PowerShell script that will run in the background.\n\n### Operating System\n\n Risk & Impact\n\n Technical Analysis\n\n**Many Faces, Many Names, Many labels**\n\n\n-----\n\nOver a short period of time, Jupyter has masqueraded as many different applications and\ninstallers. The malware has also changed its core file extension to .MSI, and it uses\ndifferent operations to execute its obfuscated PowerShell script.\n\nThis flexibility has led various security research organizations to label the malware family\ndifferently, based on Jupyter’s core module naming functions, or downloaded components.\n[Previous names include Polazert,](https://malpedia.caad.fkie.fraunhofer.de/details/win.solarmarker) [Yellow Cockatoo, and more recently](https://otx.alienvault.com/pulse/5fcab7a1accb28c015a5717d)\n[SolarMarker/Deimos. The malware has since abandoned the Indicators of Compromise](https://thehackernews.com/2021/08/solarmarker-infostealer-malware-once.html)\n(IoCs) that were the basis of these naming conventions, to thwart easy identification.\n\n### Infection Vector\n\nJupyter’s initial infection vector can vary widely. Typically, Jupyter is hosted on fake\ndownloader websites that masquerade as legitimate hosts. These sites typically offer a free\ndownload for a PDF book or a simple application. These can either be visited by a victim\nunintentionally, or via a link in a malicious email.\n\n_Figure 1: Jupyter samples are often signed with digital certificates to appear trustworthy_\n\nJupyter is often bundled with freeware applications and signed with un-revoked digital\ncertificates as shown in Figure 1, making the download appear more legitimate.\n\nIn previous iterations, Jupyter had moved away from using Windows Portable Executables\n(.EXE files) in favor of large Windows Installer Packages (.MSI). This is likely because MSI\nis a file type that is less likely to be scanned by some antivirus (AV) programs, and because\nlarge files (beyond 100 MB) are less likely to be inspected by automated sandbox routines\nand other automated AV scanning solutions.\n\n### Installation\n\n\n-----\n\nOn execution, the Windows installer package will display an installer pop-up for the\nintended legitimate application, as shown in Figure 2, while loading its data and silently\nrunning in the background.\n\n_Figure 2: Trojanized MSI files appear to install the desired application as expected_\n\nOver the past campaign, Jupyter has used a wide range of methods to deploy itself.\nTypically, the malware contains two core files – an executable and a Windows PowerShell\ncontaining the malicious code – though it is not limited to this arrangement.\n\nSome variants of Jupyter have also deployed a temporary file (.TMP) into the victim’s\n_%AppData%\\Roaming\\Temp\\ directory, and they have dropped an additional Microsoft_\nPowerShell (.PS1) file, as shown in Figure 3, to generate the typical content of Jupyter’s\ncore malicious PowerShell script.\n\n_Figure 3: Contents of Jupyter MSI installer_\n\n\n-----\n\n### PowerShell\n\nAll samples of Jupyter have heavily relied on PowerShell. The malware uses PowerShell\nboth to obfuscate its malicious code, and to execute that code without it ever writing itself to\ndisk on the victim’s machine.\n\nIt avoids writing itself to disk by loading the DLL of Jupyter reflectively into memory.\nNormally, DLLs are injected into a process from a file that is written to disk. Reflective DLL\ninjection is a technique that forcefully injects code into a victim process from memory rather\nthan disk.\n\nAs the fully un-obfuscated malware does not reside on disk, it requires a persistence\nmechanism to be created, such as registry keys that reload the malware when the victim\nmachine is started up. This makes Jupyter DLL difficult to both detect and analyze, unless\ndumped from memory.\n\n_Figure 4: Breakdown of Jupyter PowerShell_\n\nJupyter’s core PowerShell typically can be broken down into six different steps or\ncomponents, as shown in Figure 4 and the table below. Each step facilitates a specific goal,\nfunction, or ability. Though a lot of samples of Jupyter follow the same steps, variations are\npresent in Jupyter’s PowerShell code, and some samples have been noted to operate in\nslightly different ways to achieve the same ends.\n\n\n-----\n\n**Step** **Description/Functionality**\n\n\n**Obfuscated**\n**DLL**\n\n**Deobfuscated**\n**Routine**\n\n**Added to**\n**Startup**\n\n**Decoy File**\n**Creation**\n\n**DLL**\n**Reflection**\n\n**Added to**\n**Registry**\n\n\nThis is the obfuscated variable that contains the core code of Jupyter\nDLL\n\nThis is the routine where the code from “Obfuscated DLL” is passed to\ndeobfuscate the malicious core code of Jupyter. Jupyter is often\nencoded in Base64 and XOR’d.\n\nJupyter adds itself to startup to force re-execution of the malware, as a\npersistence mechanism.\n\nThe malware hides itself in a commonly found directory within the\nvictim’s %AppData%\\Roaming\\ folder. It drops a random number of\n“junk files” to hide the presence of one functional, malicious file. The\nmalware randomizes the number of junk files created, often ranging\nbetween 100 and 300, in most variants of the PowerShell code.\n\nThe malware executes reflectively, to prevent the DLL from being\ndropped onto the user’s device.\n\nFor further persistence, the malware adds a Registry Key to the victim\nmachine.\n\n\nNot all samples of Jupyter observed over its recent campaign have the same behavior.\nSome deploy their decoy files in different directories. Others opt not to XOR their DLL’s\ncode, while still encoding themselves with Base64.\n\n### Decoy\n\nTo thwart analysis, one of the first actions of Jupyter’s PowerShell is to create hundreds of\nrandomized “junk files” as decoys, as shown in Figure 5, while leaving a single file as the\ncore component of the malware. These decoys are files that are created by the malware\nthat serve no malicious use or purpose except to hide the single malicious file within their\nmidst.\n\n\n-----\n\n_Figure 5: Decoy Files dropped by Jupyter_\n\nPreviously observed iterations of Jupyter would drop their core .DLL to disk. Though this\nploy is still used by Jupyter, it does not deploy the DLL directly to disk anymore. The\ndeobfuscated version of the malware is now only loaded into memory.\n\nWith each execution of the PowerShell script, the malware will generate a new directory for\nits randomized set of decoy files and core malware component. Over the course of this\nrecent campaign, Jupyter has deployed itself in three distinct locations on a victim device:\n\n_%AppData%\\Roaming\\Adobe\\ [Random 15 Char directory]\\_\n_%AppData%\\Roaming\\Microsoft\\ [Random 15 Char directory]\\_\n_%AppData%\\Roaming\\Nvidia\\ [Random 15 Char directory]\\_\n\n### Persistence\n\nOn execution, Jupyter will silently run its PowerShell script. This script can be modified to\ndisplay its true intentions for analysis, as displayed in the image below.\n\n\n-----\n\n_Figure 6: Persistence-based mechanisms via registry keys_\n\nThe sample used for this analysis of Jupyter creates a new directory in the folder\n_C:\\Users\\%Admin%\\AppData\\Roaming\\Microsoft. In this example, the directory was named_\nkNPqHZeEjTuJAXRY, as seen in Figure 6. These locations are randomized by the malware\nand a new one is generated per execution.\n\nThe malware will add an additional shortcut file to the Windows\\Start Menu directory via\n_%AppData%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup. This also uses a_\nrandomized name derived from a variable in its PowerShell code. This shortcut is deployed\nby the malware as a persistence mechanism, so it will execute the file on startup, as shown\nin Figure 7.\n\n\n-----\n\n_Figure 7: Example of Jupyter sample startup shortcut_\n\nJupyter also generates two different registry keys during the execution of its PowerShell\ncode. The first key is added to the victim’s machine in the following location, as seen in\nFigure 7: Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Classes\\%.cwvynlbszymn%\n\nThis final part of the registry key is also randomized; each time the malware is executed, it\nwill generate a new randomized sequence. This key points to the second registry key\ngenerated by the malware, as shown in Figure 8.\n\n_Figure 8: RegKey added by Jupyter_\n\nThe data within the second registry key added by Jupyter contains a PowerShell command\nthat will re-execute the malware, as shown in Figure 9. This is used as a further persistence\nmechanism by the malware.\n\n\n-----\n\n_Figure 9: Core registry key re-executing Jupyter_\n\nOnce located, the contents of this registry key can be further analyzed and inspected. Like\nits initial PowerShell script, its intentions are to deobfuscate the malware’s main DLL and\nload it reflectively into memory.\n\nThis PowerShell command, as shown in Figure 10, is a truncated version of the original\nPowerShell code. Its purpose is to re-run, or execute the malware, on startup. This code is\nnotably smaller in size, as it omits previously achieved steps and functionality, such as\ndeploying the decoy files and adding registry keys.\n\n_Figure 10: PowerShell contents of registry keys_\n\n### Core DLL\n\nThe core DLL related to Jupyter is .NET-compiled. Previous iterations of this DLL contained\nlabelled functions, and it was not obfuscated, which gave clear indications of the malware’s\nintentions. In late 2021, newer iterations and versions of the malware became more\nsophisticated. The malware no longer uses identifiable labels for its functions, adding\nfurther obfuscation to its code’s contents. Despite this evolution, the functionality of this\n“core module” remains largely the same.\n\n\n-----\n\n_Figure 11: Differences between versions of Jupyter_\n\nThe initial functionality of this module is to establish contact with the malware’s C2\ninfrastructure. The malware achieves this using the .NET WebRequest provider to send\nPOST requests to a hard-coded IP address located within each sample of Jupyter.\n\nDuring analysis, we noted that the C2 infrastructure for Jupyter appears to remain offline\nuntil it is required. The malware continues running in the background and awaits its\ninfrastructure coming online. It will check for the availability of the C2 at regular intervals\nuntil successful connection is achieved.\n\nThe request to the C2 contains RSA-encrypted data, including a hard-coded RSA key as\nseen in Figure 12, that is used for future communications. Jupyter also uses Advance\nEncryption Standard (AES) encryption for its communications.\n\nAES is a commonly used symmetric block cipher. Jupyter uses this encryption standard on\nits communication to prevent packet interception and inspection when communication,\ndeployment of modules, and exfiltration of data is occurring between the malware core\nmodule and the C2.\n\n\n-----\n\n_Figure 12: Contents of Jupyter’s “configuration” function_\n\nIf a successful connection is achieved, the core module begins its reconnaissance of the\nvictim’s device to locate information such as:\n\nMachine name\nWindows version\nCPU architecture (x86/x64)\nUser’s admin rights\nWorkgroup\nDNS\nProtocol version\nMachine status (idle/active)\n\nJupyter contains a “ping” function that will attempt to send this information, along with\nfollowing:\n\nVersion ID of the malware (version)\nA unique hash derived from the victim device hardware (hwid)\nA Base64 unique identifier hash per communication (uniq_hash)\n\nOnce communication has been established with its C2, Jupyter’s modular design allows the\nthreat to receive further malicious components to enhance its capabilities, as seen in Figure\n13. These components can include executables and further malicious PowerShell scripts.\n\n\n-----\n\n_Figure 13: C2 activity and download of additional components_\n\n### Versions\n\nEach sample of Jupyter has a “Version ID” (shown in Figure 12) that is used in C2\ncommunication. A newly discovered Version ID often signifies a change, update, or the\naddition of further capabilities to the core malware module. Different variations of Jupyter\ncan largely be identified by characteristics of these Version IDs.\n\n**OC-1:**\n\nPowershell payload seen embedded in MSI sample as .txt file\n\n.TXT file is dropped to the AppData folder\n\nCommand to use the payload embedded in MSI launch action\n\nCommand reads .TXT file from AppData and decodes further commands\n\nXORed\n\n**OC-8:**\n\nBase64 at the beginning\n\nWscript\n\n\n-----\n\nAppData\\Adobe folder\n\nImports user32.dll\n\nGet-Process\n\nDefines two functions\n\nReflective loading of Base64 DLL\n\nNo XOR\n\n**OC-9:**\n\nBase64 at the beginning\n\nWScript\n\nAppData\\Adobe folder\n\nImports user32.dll\n\nGet-Process\n\nDefines two functions\n\nReflective loading of Base64 DLL\n\nXORed\n\n**3d8:**\n\nBase64 at the beginning\n\nWscript\n\n\n-----\n\nAppData\\Adobe folder\n\nImports user32.dll, this is further hidden in a sub obfuscated PowerShell command\n\nGet-Process\n\nDefines two functions\n\nReflective loading of Base64 DLL\n\nXORed\n\n_Table 1: Jupyter versions_\n\n### Modules\n\nOnce Jupyter has finished creating persistence, it begins checking a hard-coded C2 for the\nnext module to download. Throughout our research, we observed a variety of different\nmodules served by the C2. On examining this main Jupyter module and the capabilities of\nthe code, it is possible to rename the obfuscated functions to estimate their name prior to\nobfuscation:\n\n_Figure 14 – Original function names versus renamed functions based on capabilities_\n\nOne of the downloaded components is an information-stealing module, which includes a\nPowerShell script and payload. The payload is decoded by the PowerShell script and then\nreflectively loaded into memory.\n\n### Infostealer Module:\n\n\n-----\n\nThis module uses several functions to extract information from various sources on a victim’s\ncomputer. One of the functions used is the Data Protection API (DPAPI). Within this API, a\nclass called ProtectedData contains two wrappers: “Protect” and “Unprotect.” The\ninfostealing module makes use of the “Unprotect” wrapper, which is passed a byte array of\nencrypted data and returns a byte array of decrypted data.\n\nAs seen in Figure 15, the Unprotect wrapper is called via the method\n“a01e73a94eb4d2952c37caa645a74.”\n\n_Figure 15 – Extraction of Chrome password database and encryption key for database_\n\nThe Chrome JSON configuration is stored in the local AppData directory in a file called\n“Local State,” which is parsed using a class starting with “a5f8…” Within this configuration is\nan entry called “os_crypt,” which has a further entry called “encrypted_key.” The\n“encrypted_key” is used to encrypt saved login data.\n\nThe infostealer module uses a utility class “a01e…” to read this encrypted key, and a static\nclass function starting with “a671…” to call DPAPI Unprotect. As the key is prefixed with\nDPAPI signature bytes, a loop runs five times to omit this. Once the “encrypted_key” is\nformatted, it is then stored in a class field called “aes_key.” Further to this, a randomly\nnamed copy of the Chrome “Login Data” file is written to the temporary directory in\nWindows, which is then stored in the class field “pwds_db” and deleted from the temporary\ndirectory.\n\nThere is no decryption of the stored Chrome login data taking place in the function shown in\nFigure 15; the relevant data is read and stored into class member fields “aes_key” and\n“pwds_db.” The “pwds_db” and “aes_key” values are collected and converted to Base64.\nThis indicates the malware authors are opting to perform credential decryption following\ndata exfiltration. This makes sense from an efficiency perspective, as they have everything\nnecessary to decrypt the login data after stealing the Chrome information.\n\nThe infostealer module targets the following browsers:\n\nGoogle Chrome\nMicrosoft Edge\nOpera\n\n\n-----\n\nBrave\nMozilla Firefox\n\nIt also gathers the following browser data:\n\nLogin data (usernames/passwords)\nCookies\nWeb data (Autofill information such as names, addresses, emails)\n\n_Figure 16: Decrypting Firefox data_\n\n\n-----\n\n_Figure 17: Decrpyting Chrome data_\n\nJupyter targets the following crypto wallets:\n\nAtomic Wallet\nGuarda Wallet\nSimplEOS Wallet\nNEON Wallet\nWasabi Wallet\nMyMonero Wallet\nJaxx Wallet\nElectrum Wallet\nEthereum Wallet\nExodus Wallet\nGreenAddress Wallet\nCoin Wallet\nBither Wallet\nCoinomi Wallet\nLedger Live Hardware wallet\nTrinity Hardware wallet\nScatter Hardware wallet\nWildcard any file matching: *wallet*.dat\nWildcard any file matching: *.wallet\n\n\n-----\n\nRemote Access Applications Targeted:\n\nOpenVPN\nRemote Desktop Protocol (RDP)\n\n### Conclusion\n\nAt the close of 2021, Jupyter saw rapid enhancements to prior iterations. This made the\nnewer versions of malware harder to detect, scan and prevent, leading to a rise in devices\naffected by the malware.\n\nNow that Jupyter is being bundled with legitimate, signed software, this ploy makes it\ndifficult to detect the threat before it has been deployed onto a victim system. As the\nmalware executes via DLL reflection, it gives little indication that it is running silently in the\nbackground. Once on a victim system, Jupyter will use multiple persistence mechanisms,\nand it will even install the legitimate software it’s bundled with to further deceive the victim.\n\nTo further conceal its activities, Jupyter’s C2 infrastructure tends to remain offline for large\nperiods of time, operating in short bursts of activity rather than constant communication.\n\nThe modular nature of the malware keeps its core-module compact. Jupyter largely focuses\non stealing information, deploying various modules to obtain passwords, credentials, and\nother data. However, the malware is not just limited to these activities. Once it gains a\nfoothold on the system, it can download a wide variety of components, making it an\nextremely dangerous piece of malware.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research and Intelligence Team\nto catch the threat described in this document:\n\nimport \"pe\"\n\nimport \"dotnet\"\n\nrule Mal_Infostealer_EXE_Jupyter_Cert_36ff\n\n{\nmeta:\n\ndescription = \"Detects Jupter executables by certificate OOO Sistema (36ff)\"\n\nauthor = \"BlackBerry Research & Intelligence Team\"\n\ndate = \"2021-10-14\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\ncondition:\n\nuint16(0) == 0x5a4d and\n\nfor any i in (0 pe number of signatures) : (\n\n\n-----\n\npe.signatures[i].issuer contains Certum Extended Validation Code Signing CA\nSHA2\" and\npe.signatures[i].serial == \"36:ff:67:4e:b3:05:e9:9c:35:56:5f:a3:01:d5:c4:b0\" //\nSerial variable must be lowercase\n)\n}\n\nrule Mal_Infostealer_MSI_EXE_Jupyter_Certificate\n{\nmeta:\ndescription = \"Detects Jupter by certificate\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2021-11-04\"\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n// MSI Installer\n_$msi = { D0 CF 11 E0 A1 B1 1A E1 }_\n\n// MSI Strings\n_$a1 = \"EMCO MSI Package Builder\"_\n\n// PowerShell execution strings\n_$b1 = \"powershell-ExecutionPolicy bypass -command \\\"iex([\\\\_\n\n[]IO.File[\\\\]]::ReadAllText('[CurrentUserProfileFolder]\" nocase\n_$b2 = \"powershell-ep bypass -file \\\"[AppDataFolder]\" nocase_\n_$b3 = /powershell-ep bypass -windowstyle hidden -command \\\"\\$xp=\\'\\_\n\n[AppDataFolder\\].{0,256}\\.{0,256}\\'/ nocase\n_$b4 = /powershell-ep bypass -windowstyle hidden -command \\\"\\$p=\\'\\_\n\n[AppDataFolder\\].{0,256}\\.{0,256}\\'/ nocase\n_$b5 = /powershell-ExecutionPolicy bypass -command \\\"iex\\(\\[\\\\\\[\\]IO.File\\_\n\n[\\\\\\]\\]::ReadAllText\\(\\'\\[CurrentUserProfileFolder\\].{1,256}\\..{1,256}\\'\\)\\)/ nocase\n\n// Certificate Name\n_$c1 = \"OOO ENDI\"_\n_$c2 = \"OOO MVS\"_\n_$c3 = \"OOO LEVELAP\"_\n_$c4 = \"Soto Manufacturing SRL\"_\n_$c5 = \"Decapolis Consulting Inc.\"_\n\n// Co-signers\n_$f1 = \"SSL.com EV Root Certification Authority RSA R2\"_\n_$f2 = \"SSL.com EV Code Signing Intermediate CA RSA R3\"_\n_$f3 = \"DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1\"_\n_$f4 = \"DigiCert Trusted Root G40\"_\n\ncondition:\n($msi at 0 or uint16(0) == 0x5a4d) and\nall of ($a*) and\n\n1 of ($b*) and\n\n\n-----\n\n1 of ($c ) and\n2 of ($f*)\n}\n\nrule Mal_Infostealer_MSI_Jupyter_Embedded_PowerShell\n{\nmeta:\ndescription = \"Detects Jupter by a specific PowerShell command present in the MSI\nInstaller\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2021-10-14\"\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n// MSI Installer\n_$msi = { D0 CF 11 E0 A1 B1 1A E1 }_\n\n// Embedded PowerShell Command\n_$x1 = /powershell-ep bypass -windowstyle hidden -command \\\"\\$xp=\\'\\_\n\n[AppDataFolder\\]pd\\w*\\.(log|txt)\\';\\$xk=\\'[a-zA-Z]{52}\\';\\$xb=\\[\\\\\\[\\]System\\.Convert\\\n\n[\\\\\\]\\]::FromBase64String\\(\\[\\\\\\[\\]System\\.IO\\.File\\[\\\\\\]\\]::ReadAllText\\(\\$xp\\)\\);remove-item\n\\$xp;for\\(\\$i=0;\\$i -lt \\$xb.count;\\)\\[\\\\\\{\\]for\\(\\$j=0;\\$j -lt \\$xk\\.length;\\$j\\+\\+\\)\\[\\\\\\{\\]\\$xb\\[\\\\\\\n\n[\\]\\$i\\[\\\\\\]\\]=\\$xb\\[\\\\\\[\\]\\$i\\[\\\\\\]\\] -bxor \\$xk\\[\\\\\\[\\]\\$j\\[\\\\\\]\\];\\$i\\+\\+;if\\(\\$i -ge \\$xb.count\\)\\[\\\\\\\n{\\]\\$j=\\$xk\\.length;\\[\\\\\\}\\]\\[\\\\\\}\\]\\[\\\\\\}\\];\\$xb=\\[\\\\\\[\\]System.Text.Encoding\\\n\n[\\\\\\]\\]::UTF8\\.GetString\\(\\$xb\\);iex \\$xb;/ nocase\n\ncondition:\n_$msi at 0 and_\nall of ($x*)\n}\n\nrule Mal_Infostealer_PowerShell_Jupyter_Updated_Samples\n{\nmeta:\ndescription = \"Detects Jupter powershell via common strings\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2021-11-04\"\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n_$c1 = /\\.[T|t][O|o][L|l][O|o][W|w][E|e][R|r]\\(\\)\\)?;[I|i][E|e][X|x]/_\n_$c2 = \"get-random -minimum 50000 -maximum 200000\" nocase_\n_$c3 = \"ReaDALlBYTES\" nocase_\n_$c4 = /createshortcut\\_\n(\\$env\\:appdata\\+'\\\\m\\'\\+\\'icr\\'\\+\\'oso\\'\\+\\'ft\\'\\+\\'\\\\w\\'\\+\\'ind\\'\\+\\'ow\\'\\+\\'s\\\\\\'\\+\\'st\\'\\+\\'art\\'\\+\\'\nme\\'\\+\\'nu\\'\\+\\'\\\\pr\\'\\+\\'ogr\\'\\+\\'ams\\\\\\'\\+\\'st\\'\\+\\'art\\'\\+\\'up\\'\\+\\'\\\\.{29}\\.lnk\\'\\)/ nocase\n\n\n-----\n\ncondition:\nall of ($c*)\n}\n\nrule Mal_Infostealer_Win32_Jupyter_Main_Module\n{\nmeta:\ndescription = \"Detects Jupter main module\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2021-11-23\"\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n_$g1 = { 68 00 74 00 74 00 70 00 3A 00 2F 00 2F 00 } // h.t.t.p.:././._\n_$g2 = { 5C 00 41 00 50 00 50 00 44 00 41 00 54 00 41 00 5C 00 52 00 4F 00 41 00_\n4D 00 49 00 4E 00 47 } // \\.A.P.P.D.A.T.A.\\.R.O.A.M.I.N.G\n_$g3 = { 63 00 68 00 61 00 6E 00 67 00 65 00 5F 00 73 00 74 00 61 00 74 00 75 00_\n73 } // c.h.a.n.g.e._.s.t.a.t.u.s\n_$g4 = { 50 00 4F 00 53 00 54 } // P.O.S.T_\n_$g5 = { 69 00 73 00 5F 00 73 00 75 00 63 00 63 00 65 00 73 00 73 } //_\ni.s._.s.u.c.c.e.s.s\n_$g6 = { 75 00 73 00 65 00 72 00 70 00 72 00 6F 00 66 00 69 00 6C 00 65 } //_\nu.s.e.r.p.r.o.f.i.l.e\n_$g7 = { 44 00 45 00 53 00 4B 00 54 00 4F 00 50 00 2D } // D.E.S.K.T.O.P.-_\n_$g8 = { 4C 00 41 00 50 00 54 00 4F 00 50 00 2D } // L.A.P.T.O.P.-_\n_$g9 = { 78 00 38 00 36} // x.8.6_\n_$g10 = { 78 00 36 00 34 } // x.6.4_\n_$g11 = { 41 00 64 00 6D 00 69 00 6E } // A.d.m.i.n_\n_$g12 = { 56 00 69 00 73 00 74 00 61 } // V.i.s.t.a_\n_$g13 = { 64 00 6E 00 73 } // d.n.s_\n_$g14 = { 64 00 7A 00 6B 00 61 00 62 72 } // d.z.k.a.b.r_\n_$g15 = { 78 00 7A 00 6B 00 61 00 62 00 73 00 72 } // x.z.k.a.b.s.r_\n_$g16 = { 64 00 7A 00 6B 00 61 00 62 00 73 00 72 } // d.z.k.a.b.s.r_\n\n// Version Strings\n_$h1 = { 4F 00 43 00 2D } // O.C.-_\n_$h2 = { 4E 00 56 00 2D } // N.V.-_\n_$h3 = { 53 00 50 00 2D } // S.P.-_\n_$h4 = { 49 00 4E 00 2D } // I.N.-_\n\n_$i = \"System.Net\"_\n\ncondition:\n10 of ($g*) and\n1 of ($h*) and\n(pe.imports(\"mscoree.dll\", \"_CorDllMain\") or $i) // DotNet\n}\n\n\n-----\n\nrule Mal_Infostealer_Win32_Jupyter_InfoStealer_Module\n{\nmeta:\ndescription = \"Detects Jupter infostealer module\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2021-11-08\"\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n_$d1 = \"WebRequest\" nocase_\n_$d2 = \"HttpWebRequest\" nocase_\n_$d3 = \"WebResponse\" nocase_\n_$d4 = \"GetResponseStream\" nocase_\n_$d5 = \"GetResponse\" nocase_\n_$d6 = \"IsInRole\" nocase_\n_$d7 = \"get_UTF8\" nocase_\n_$d8 = \"FromBase64String\" nocase_\n_$d9 = \"get_OSVersion\" nocase_\n_$d10 = \"GetFiles\" nocase_\n_$d11 = \"GetExtension\" nocase_\n_$d12 = \"get_Current\" nocase_\n_$d13 = \"GetEnumerator\" nocase_\n\n_$j1 = { 6C 6F 67 69 6E 73 } // logins_\n_$j2 = { 43 00 6F 00 6F 00 6B 00 69 00 65 00 73 } // C.o.o.k.i.e.s_\n_$j3 = { 00 6C 00 6F 00 67 00 69 00 6E 00 73 00 2E 00 6A 00 73 00 6F 00 6E 00 } //_\n.l.o.g.i.n.s...j.s.o.n.\n_$j4 = { 00 63 00 6F 00 6F 00 6B 00 69 00 65 00 73 00 2E 00 73 00 71 00 6C 00 69_\n00 74 00 65 00 } // .c.o.o.k.i.e.s...s.q.l.i.t.e.\n\ncondition:\n// DotNet\npe.imports(\"mscoree.dll\", \"_CorDllMain\") and\n12 of ($d*) and\n2 of ($j*)\n}\n\nrule Mal_Infostealer_Win32_Jupyter_Download_and_Execute_Module\n{\nmeta:\ndescription = \"Detects Jupter download and execute module. Research has shown it\ndownloading SolarDelphi / JupyterStealer.\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2021-11-09\"\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\n\n-----\n\nstrings:\n_$e1 = { 68 00 74 00 74 00 70 00 3A 00 2F 00 2F 00 }_\n_$e2 = { 47 00 45 00 54 00 00 3D 63 00 3A 00 5C 00 77 00 69 00 6E 00 64 00 6F 00_\n77 00 73 00 5C 00 73 00 79 00 73 00 74 00 65 00 6D 00 33 00 32 00 5C 00 77 00 69 00\n6E 00 76 00 65 00 72 00 2E 00 65 00 78 00 65 }\n_$e3 = { 00 2F 00 67 00 65 00 74 00 2F 00 }_\n_$e4 = \"FromBase64String\"_\n_$e5 = \"get_UTF8\"_\n_$e6 = \"WebResponse\"_\n_$e7 = \"GetResponse\"_\n_$e8 = \"Invoke\"_\n\ncondition:\n// DotNet\npe.imports(\"mscoree.dll\", \"_CorDllMain\") and\ndotnet.version == \"v4.0.30319\" and\ndotnet.assembly.version.major == 0 and\ndotnet.assembly.version.minor == 0 and\nall of ($e*)\n}\n\n### Indicators of Compromise (IoCs)\n\n**SHA256:**\n\ndd8e1e321ce70472f9f0681c6e2dc078e7d066d89bc63ca4ae1ac53bee8daac2\na772d35e54bcd6790ea99f8723d56872891ef5691ed502a82babc618d2e8a452\n0adfbce8a09d9f977e5fe90ccefc9612d1d742d980fe8dc889e10a5778592e4d\n0e673eb418c87268aa3bcb262e8e03a3f719a95a8e118ba99515c57c9aa02d38\n10221ceffbc7d7e59b17b1968d0fa01c8124efa70d1d5a486e53211e4754a22d\n13d34fbf591c2cbf38e60ec3c6d185546e206be61dd58923edc23c4b125ff2f0\n161b6f4bc07567c0c6e2e394454a66b8aac2f73212a6cf6c0c82b9fdbdb3fcce\n1e7914f799371cbc8560bc52203d3531bb20cb4f6092158c76a4842dbf85dabc\n2a051324620943464749234c9b49def385b9f6dd7c30f4caa4d98b3af035bd8f\n3303926a6468dab25286a65bb9f3e5883a8938e6501031b3b85e21f182d1ed0d\n341881d11fd748a81c8cee584dc42392a564aeb839faf7afa136004701e656c1\n38c833c34998c9f4d9266f920c0f0862d986cb434740f99175e32f3f49275eb5\n\n**C2 IP:**\n\n146.70.24[.]229\n23.29.115[.]175\n92.204.160[.]110\n146.70.41[.]157\n37.221.114[.]23\n188.241.83[.]61\n69.46.15[.]151\n\n**C2 Identifier/Version:**\n\n\n-----\n\nNV 5\nOC-11\nOC-1\nOC-2\nJ13\nJ15\nJ16\nIN-10\nNV-1\nNV-4\nNV-6\nOC-3\nOC-7\nOC-8\nOC-9\nOC-W1\nSP-10\nSP-13\nSP-17\nSP-18\nSP-W2\n\n**Certificate #1:**\n\nSerial: 36 FF 67 4E B3 05 E9 9C 35 56 5F A3 01 D5 C4 B0\nName: OOO Sistema\nValid from: 01:51 PM 12/02/2020\nValid to: 01:51 PM 12/02/2021\nThumbprint: C301843CA390AED52C4C6D59EF3D125400F186FB\n\n**Certificate #2:**\n\nSerial: 5B A9 00 D7 A7 61 EE 27 C2 79 98 C8 B9 B4 FA 70\nName: OOO LEVELAP\nValid from: 11:53 AM 09/14/2021\nValid to: 11:53 AM 09/14/2022\nThumbprint: EDEBF26E6CAD49A8F48A11EFF6BFC13266FF6872\n\n**Certificate #3:**\n\nSerial: 6F E7 21 C3 DD BD 27 74 D0 3D CE A4 4A 26 A7 8A\nName: OOO ENDI\nValid from: 08:17 PM 09/29/2021\nValid to: 08:17 PM 09/29/2022\nThumbprint: BC346A6BF6B6D53A69A742A4245A43320980B1C0\n\n**Certificate #4:**\n\nSerial: 7B 44 65 51 DE 53 1A 37 D3 A0 EB FB 8F 0B 6E 01\nName: OOO MVS\nValid from: 08:19 PM 10/01/2021\nValid to: 08:19 PM 10/01/2022\nThumbprint: 691718CA7F85C0D5B89250D685EB52A808A321E5\n\n\n-----\n\n**Certificate #5:**\n\nSerial: 06 48 7A 92 B1 D9 12 B7 9F 22 91 C0 D3 82 0F 2C\nName: Soto Manufacturing SRL\nValid from: 12:00 AM 10/04/2021\nValid to: 11:59 PM 08/04/2023\nThumbprint: AEE8241A17357D5713C451406BA4D3FBDCC1E25F\n\n**Certificate #6:**\n\nSerial: 0A 54 C6 04 87 D8 38 4E DC E9 81 81 4B E7 67 CB\nName: Decapolis Consulting Inc.\nValid from: 12:00 AM 10/31/2021\nValid to: 11:59 PM 10/24/2022\nThumbprint: BB800B7DE9E457D670303AF12E1940C732CC5975\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you providing around-the-clock\nsupport, where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n## About The BlackBerry Research & Intelligence Team\n\n\n-----\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-13 - Threat Thursday- Jupyter Infostealer is a Master of Disguise.pdf"
    ],
    "report_names": [
        "2022-01-13 - Threat Thursday- Jupyter Infostealer is a Master of Disguise.pdf"
    ],
    "threat_actors": [
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535580,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653780004,
    "ts_modification_date": 1653780004,
    "files": {
        "pdf": "https://archive.orkl.eu/bb7f068f8965e152d02f94be4180a3dcabc4b50d.pdf",
        "text": "https://archive.orkl.eu/bb7f068f8965e152d02f94be4180a3dcabc4b50d.txt",
        "img": "https://archive.orkl.eu/bb7f068f8965e152d02f94be4180a3dcabc4b50d.jpg"
    }
}