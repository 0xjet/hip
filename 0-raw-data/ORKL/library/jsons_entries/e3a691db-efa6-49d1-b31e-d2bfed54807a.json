{
    "id": "e3a691db-efa6-49d1-b31e-d2bfed54807a",
    "created_at": "2023-01-12T15:10:08.002831Z",
    "updated_at": "2025-03-27T02:17:11.361955Z",
    "deleted_at": null,
    "sha1_hash": "43267e398b44040a578b9c14544cb94bc1709d70",
    "title": "2018-05-01 - Lojack Becomes a Double-Agent",
    "authors": "",
    "file_creation_date": "2022-05-28T21:56:41Z",
    "file_modification_date": "2022-05-28T21:56:41Z",
    "file_size": 491445,
    "plain_text": "# Lojack Becomes a Double-Agent\n\n**[asert.arbornetworks.com/lojack-becomes-a-double-agent/](https://asert.arbornetworks.com/lojack-becomes-a-double-agent/)**\n\n\n-----\n\nLojack Becomes a Double-Agent\n\n\nby [ASERT Team on May 1st, 2018](https://www.netscout.com/blog/asert/asert-team)\n\n## Executive Summary\n\nASERT recently discovered Lojack agents containing malicious C2s. These hijacked agents\npointed to suspected Fancy Bear (a.k.a. APT28, Pawn Storm) domains. The InfoSec\ncommunity and the U.S. government have both attributed Fancy Bear activity to Russian\nespionage activity. Fancy Bear actors typically choose geopolitical targets, such as\ngovernments and international organizations. They also target industries that do business\nwith such organizations, such as defense contractors. Lojack, formally known as\nComputrace, is a legitimate laptop recovery solution used by a number of companies to\nprotect their assets should they be stolen. Lojack makes an excellent double-agent due to\nappearing as legit software while natively allowing remote code execution. Although the\ninitial intrusion vector for this activity remains unknown, Fancy Bear often utilizes phishing\nemail to deliver payloads.  NOTE: Arbor APS enterprise security products detect and block\n_on all activity noted in this report._\n\n## Key Findings\n\nASERT researchers identified Lojack agents containing command and control (C2)\ndomains likely associated with Fancy Bear operations.\n\n\n-----\n\nProof of concept in using Lojack as a backdoor or intrusion vector date back to 2014.\nIts continued use suggest attackers could have used it in long-running operations.\nInitially, the Lojack agents containing rogue C2 had low Anti-Virus (AV) detection which\nincreased the probability of infection and subsequent successful C2 communication.\nThe distribution mechanism for the malicious Lojack samples remains unknown.\nHowever, Fancy Bear commonly uses phishing to deliver malware payloads as seen\nwith [Sedupload in late 2017.](https://www.jigsawsecurityenterprise.com/post/2017/11/01/malicious-documents-targeting-security-professionals)\n\n## UPDATE\n\n**May 3, 2018 – After the disclosure of the malicious Lojack binaries, many Anti-**\nVirus vendors have been quick to respond in properly marking samples as\n\"malware\" and \"DoubleAgent\", rather than \"Riskware\" or \"unsafe\" (Figure 2).\n**May 4th 2018 – UPDATE FROM ABSOLUTE SOFTWARE:**\n\n_\"The analysis of the samples provided by Arbor shows all were based on an_\n_illicitly modified old version of the LoJack agent from 2008 and no_\n_customers or partners have been impacted. For customers who wish to_\n_confirm no legacy agents are present in their environment, we have_\n_published an advisory with steps to verify all installed agents are legitimate_\n_copies of the LoJack product._\n**May 9th 2018 – Disclaimer:**\n\nPrior reports have misidentified LoJack instead of Absolute LoJack for\nLaptops, also known as Computrace. LoJack for Laptops and Computrace\nare products of Absolute, not LoJack or CalAmp.\n\n## Lojack Summary\n\nAbsolute Software, the creator of Lojack, says on its website\n[(https://www.absolutelojack.com/) that the agent can locate and lock a device remotely.](https://www.absolutelojack.com/)\nAdditionally, it can delete files, making it an effective laptop theft recovery and data wiping\nplatform. Lojack can survive hard drive replacements and operating system (OS) reimaging. The agent achieves this persistence through a modular design as noted by Vitaliy\nKamlyuk, Sergey Belov, and Anibal Sacco in a presentation at Blackhat, 2014 (Figure 1):\n\n\n-----\n\nFigure 1:\n\nLojack persistence mechanism (Paraphrased from https://www.blackhat.com/docs/us14/materials/us-14-Kamluk-Computrace-B…).\n\nThe aforementioned researchers suggest the binary modification of the \"small agent\" is\ntrivial. The Lojack agent protects the hardcoded C2 URL using a single byte XOR key;\nhowever, according to researchers it blindly trusts the configuration content. Once an\nattacker properly modifies this value then the double-agent is ready to go. This is not the\nonly aspect that makes Lojack an appealing target. Attackers are also concerned about AV\ndetection. Looking on VirusTotal, some anti-virus vendors flag Lojack executables as\n”unsafe”, but as noted as of May 3, many AV now flag the binaries as malware and\nDoubleAgent (Figure 2).\n\nFigure 2: Virustotal AV Report of cf45ec807321d12f8df35fa434591460\n\n\n-----\n\nOriginally, the low AV detection, allowed the attacker to hide in plain sight, an effective\ndouble-agent. The attacker simply needs to stand up a rogue C2 server that simulates the\nLojack communication protocols. Finally, Lojack’s “small agent” allows for memory reads and\nwrites which grant it remote backdoor functionality when coupled with a rogue C2 server.\n\n## Lojack Double-Agent\n\nASERT has identified five Lojack agents (rpcnetp.exe) pointing to 4 different suspected\ndomains. Fancy Bear has been tied to three of the domains in the past.\n\n\n**Hash** **Compilation**\n**Time**\n\nf1df1a795eb784f7bfc3ba9a7e3b00ac 2008-04-01\n19:35:07\n\n6eaa1ff5f33df3169c209f98cc5012d0 2008-04-01\n19:35:07\n\nf3c6e16f0dd2b0e55a7dad365c3877d4 2008-04-01\n19:35:07\n\ncf45ec807321d12f8df35fa434591460 2008-04-01\n19:35:07\n\nf391556d9f89499fa8ee757cb3472710 2008-04-01\n19:35:07\n\n_Table 1: Lojack Double-Agents on VirusTotal_\n\n## Binary Comparisons\n\n\n**Size in**\n**Bytes**\n\n\n**Rogue C2 Servers** **AV**\n**Detection**\n**on VT**\n\n\n17,408 sysanalyticweb[.]com 2/67\n\n17,408 sysanalyticweb[.]com 4/66\n\n17,408 elaxo[.]org 3/62\n\n17,408 ikmtrust[.]com 2/64\n\n17,408 lxwo[.]org 9/65\n\n\nASERT believes all these binaries are rpcnetp.exe (small agent) due to the following\ncharacteristics:\n\nSize matching: [17,408 bytes](https://www.blackhat.com/docs/us-14/materials/us-14-Kamluk-Computrace-Backdoor-Revisited-WP.pdf)\nYara match on either:\n\n“TagId” and “rpcnetp.exe”\nSet of op codes\nMatching export function “rpcnetp” in the binaries.\n\nAfter confirming the stage of the Lojack agent, binary comparison analysis confirmed that\nthey were legitimate Lojack samples. The comparison also highlighted that the attacker did\nnot graft additional functionality into the binary. ASERT used the presence of\nsearch.namequery[.]com in the binary and the yara rule to identify legitimate Lojack\nsamples. Lojack’s Absolute Software Corp. owns search.namequery[.]com; we have no\n\n\n-----\n\nevidence the legitimate site has been used for nefarious purposes. NOTE: All samples, both\nrogue and the two “clean” samples (below), matched 100% based on Diaphora’s function\nmatching algorithm. “Clean” Samples:\n\n1. e78e3b0171b189074d2539c7baaa0719\n2. ac1a85d3ca1b6265cad4ed41b696f9b7\n\nOnly the presence of the rogue C2's make the samples in Table1 malicious. The attackers\nare merely hijacking the communication used by Lojack, thereby granting themselves\nbackdoor access to machines running the software.\n\n## Fancy Bear Attribution\n\nASERT assesses with moderate confidence that the rogue Lojack agents are attributed to\nFancy Bear based on shared infrastructure with previous operations. The following domains,\nextracted from the rogue Lojack agents trace back to Fancy Bear operations:\n\n1. elaxo[.]org\n2. ikmtrust[.]com\n3. lxwo[.]org\n4. sysanalyticweb[.]com (Figure 3 & Figure 4)\n\n[Researchers from Jigsaw Security, based on leads from Talos in late 2017, traced the](https://www.jigsawsecurityenterprise.com/single-post/2017/11/01/Malicious-Documents-Targeting-Security-Professionals)\ndomains elaxo[.]org and ikmtrust[.]com and the tool Sedupload, to a Fancy Bear operation.\n[The domain lxwo[.]org appeared in a blog post from Threat Intel Recon that resolved to an IP](https://threatreconblog.com/2017/02/03/apt28-malicious-document/)\naddress within a document attributed to Fancy Bear. The rogue Lojack samples containing\nthe sysanalyticweb[.]com domains were only recently spotted in the wild (April 2018).\nDespite the hijack of this software being a publicly known tactic, there are many similarities in\nthe binary comparisons (above) and infrastructure analysis (below) that increase the\nprobability it is the same actor(s):\n\nAll the listed domains are associated with the same Lojack agent utilizing the same\ncompile time.\nThe domains in question all contain nonsensical Registrant information where the actor\ntends to copy/paste the same information in multiple fields.\nEach domain includes a Registrant Name (often a nonsensical word), but additionally\nincludes a similar word in the Registrant Organization field.\n\nThis is interesting because that is a field that is often skipped when a Registrant\nName is present, but this actor(s) regularly utilizes both fields\n\n\n-----\n\nFigure 3. XORed C2 Server - NETSCOUT\n\nFigure 4. Live (April 2018) C2 - NETSCOUT\n\n## Conclusion & Recommendations\n\n\n-----\n\nHijacking legitimate software is a common enough tactic for malicious actors. A key factor\nmaking this activity so devious is the malicious Lojack samples were simply labeled \"unsafe”,\n\"suspicious\", or \"DangerousObject\", rather than malware. As a result, rogue Lojack samples\ncould fly under the radar and give attackers a stealthy backdoor into victim systems. ASERT\nrecommends scanning for rogue Lojack agents using the Yara signature listed in the\nAppendix (below) and blocking the domains contained within this blog.\n\n## Appendix: Yara Signature\n```\nrule ComputraceAgent\n{\n meta:\n   description = \"Absolute Computrace Agent Executable\"\n   thread_level = 3\n   in_the_wild = true\n strings:\n   $a = {D1 E0 F5 8B 4D 0C 83 D1 00 8B EC FF 33 83 C3 04}\n   $mz = {4d 5a}\n   $b1 = {72 70 63 6E 65 74 70 2E 65 78 65 00 72 70 63 6E 65 74 70 00}\n   $b2 = {54 61 67 49 64 00}\n condition:\n   ($mz at 0 ) and ($a or ($b1 and $b2))\n}\n\n```\n_Code Snippet 1: Yara signature to detect computrace/Lojack agent (Retrieved from_\n_[https://www.blackhat.com/docs/us-14/materials/us-14-Kamlyuk-Kamluk-Comp…)](https://www.blackhat.com/docs/us-14/materials/us-14-Kamlyuk-Kamluk-Computrace-Backdoor-Revisited.pdf)_\n\nPosted In\n\nAdvanced Persistent Threats\nMalware\n\n## Subscribe\n\n_Sign up now to receive the latest notifications and updates from NETSCOUT's ASERT._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-01 - Lojack Becomes a Double-Agent.pdf"
    ],
    "report_names": [
        "2018-05-01 - Lojack Becomes a Double-Agent.pdf"
    ],
    "threat_actors": [
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536208,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653775001,
    "ts_modification_date": 1653775001,
    "files": {
        "pdf": "https://archive.orkl.eu/43267e398b44040a578b9c14544cb94bc1709d70.pdf",
        "text": "https://archive.orkl.eu/43267e398b44040a578b9c14544cb94bc1709d70.txt",
        "img": "https://archive.orkl.eu/43267e398b44040a578b9c14544cb94bc1709d70.jpg"
    }
}