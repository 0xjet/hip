{
    "id": "7b594726-a6f2-4d8d-b156-f4bcdfdf3b9e",
    "created_at": "2023-01-12T15:01:13.745859Z",
    "updated_at": "2025-03-27T02:05:42.174512Z",
    "deleted_at": null,
    "sha1_hash": "0aff04a6841f361f6e1aed25513303c7ebec21bd",
    "title": "2020-06-17 - ATT&CK® Deep Dive- Process Injection",
    "authors": "",
    "file_creation_date": "2022-05-28T17:00:35Z",
    "file_modification_date": "2022-05-28T17:00:35Z",
    "file_size": 163352,
    "plain_text": "# ATT&CK® Deep Dive: Process Injection\n\n**[redcanary.com/resources/webinars/deep-dive-process-injection/](https://redcanary.com/resources/webinars/deep-dive-process-injection/)**\n\n[Demo](https://redcanary.com/demo)\nShare\n\n[Resources •](https://redcanary.com/resources/) [Webinars](https://redcanary.com/resources/?type=webinars)\n\nMITRE ATT&CK\n\n[Erika Noerenberg•](https://redcanary.com/guest-author) [Matt Graeber•](https://redcanary.com/authors/matt-graeber) [Adam Pennington•](https://redcanary.com/guest-author) [David Kaplan•](https://redcanary.com/guest-author)\n\nWATCH ON-DEMAND\n\nWHY FOCUS ON PROCESS INJECTION?\n\n\n-----\n\nProcess Injection encompasses a wide array of malicious behaviors that offer adversaries\nan inconspicuous method of evading defensive controls, elevating their privilege level, or\notherwise executing arbitrary code. It’s so broad that in the next ATT&CK release, MITRE is\nrecategorizing the technique into 11 sub-techniques.\n\nAs such, this is the perfect time for an in-depth, technical conversation exploring the ways\nthat adversaries leverage Process Injection, what malicious process injection looks like, and\nhow you can detect it.\n\n[See highlight clips from the Process Injection webinar.](https://redcanary.com/blog/process-injection-primer/)\n\n**01:25** **Panelist Introduction**\n\n**02:10** **What Red Canary Does**\n\n**02:35** **Process Injection Definition**\n\n**02:48 “Process injection is a way of running arbitrary code in another process’s memory**\nspace.” – Adam\n\n**03:30** **Why Leverage Process Injection**\n\n**03:50 “It can be a very good way to evade defenders and defensive controls that are**\nfocused around specific tools.” – Adam\n\n**04:55** **Sub-techniques of Process Injection**\n\n**05:20 “Process injection, which is a fairly broad technique, has been broken out into 11**\ndifferent sub-techniques which are more specific techniques or ways of actually doing\nprocess injection.” – Adam\n\n**05:45** **Webinar Agenda**\n\n**07:11** **Portable Executable Injection**\n\n**08:09 “The ability to inject that into another process and then invoking it by spawning a new**\nthread.” – Matt\n\n**09:40 “This technique offers an attacker particular flexibility in that it facilitates direct**\ninjection into their target.” – Matt\n\n**10:57 Ramnit**\n\n**11:15 “In the case of Ramnit, it injects a traditional DLL into a browser process.” – Matt**\n\n**13:55** **Observing PE Injection**\n\n\n-----\n\n**14:14 What are the absolute minimum requirements an attacker has imposed in order to**\nsuccessfully carry out the attack technique?” – Matt\n\n**17:05** **Detecting PE Injection**\n\n**18:15 “Since they’re already writing their own position-independent code, there’s no hard**\nrequirement that they must write a PE header into the memory space of another process,\nbut a lot of malware does.” – Matt\n\n**21:30** **Thread Local Storage**\n\n**22:29 “Although it is kind of uncommon, it can be a successful anti-analysis technique**\nbecause typically analysis is going to start at the entry point of the PE, and this malware is\ngoing to get executed before that is reached.” – Erika\n\n**22:52** **Ursnif**\n\n**23:05 “It’s often spread via malicious Office documents” – Erika**\n\n**23:23** **Observing Malicious TLS Callbacks**\n\n**23:29 “Within the PE header itself, there is a TLS directory which contains information**\nabout TLS data objects. These thread local storage objects basically allow each thread to\nhave its own static data area for custom variables, or custom thread initialization routines\nthat they want to employ.” – Erika\n\n**28:29** **Detecting Malicious TLS Callbacks**\n\n**29:22 “We talked about some of the APIs that are used by this technique, you can**\nobviously detect the usage of those, but the usage of any one of those by itself is not going\nto indicate malicious activity.” – Erika\n\n**30:38** **Process Hollowing**\n\n**31:00 “It allows an attacker to carve out the executable section of a legitimate or benign**\nprocess and replace it with their own payload.” – David\n\n**33:42** **Process Hollowing: Generalized Technique**\n\n**36:05 “Once the attacker has obtained the PE address, the third step is to perform the**\nhollowing itself.” – David\n\n**41:55** **Trickbot**\n\n**42:32 “What’s interesting for us as technical defenders is that we use a number of varied**\ntechniques taking shape.” – David\n\n\n-----\n\n**43:52** **Process Hollowing: Trickbot**\n\n**45:30 “They create a section that describes their unpacked code. This is created within the**\noriginator process, meaning within the malware process itself. They create a new section\nthat describes the unpacked code to inject or make resident within the hollowed process.” –\nDavid\n\n**47:52** **Detecting Process Hollowing**\n\n**51:12 “It’s difficult to get a robust detection at scale.” – David**\n\n**52:16** **Linux**\n\n**57:09 “We only had these three Linux-only techniques in ATT&CK today.” – Adam**\n\n**57:26** **MacOS**\n\n**57:38 “Injection isn’t seen in malware on the Mac platform, and there are a few reasons for**\nthat. The most prevalent being that it is much harder than getting the user to click on\nsomething and type in their password.” – Erika\n\n**01:00:52** **Mitigating Process Injection**\n\n**1:01:02 “There is no specific mitigation against all forms of process injection.” – Matt**\n\n**01:04:05** **Questions & Answers**\n\nWe will be following up with questions and answers in a blog post soon.\n\nMeet the Experts\n\n[Adam Pennington](https://redcanary.com/guest-author/)\n\nMITRE ATT&CK\n\nDownload the report\n\nAll 2021 Threat Detection Report content is fully available through this website. If you prefer\nto download a PDF, just fill out this form and let us know what email to send it to.\n\n**Thanks for your interest!**\n\nCheck your inbox, the 2021 Threat Detection Report is headed your way.\n\nOur website uses cookies to provide you with a better browsing experience. More\n[information can be found in our Privacy Policy](https://redcanary.com/privacy-policy)\n\n\n-----\n\nX\nPrivacy & Cookies Policy\n\n**Privacy Overview**\n\nThis website uses cookies to improve your experience while you navigate through the\nwebsite. Out of these cookies, the cookies that are categorized as necessary are stored on\nyour browser as they are essential for the working of basic functionalities of the website. We\nalso use third-party cookies that help us analyze and understand how you use this website.\nThese cookies will be stored in your browser only with your consent. You also have the\noption to opt-out of these cookies. But opting out of some of these cookies may have an\neffect on your browsing experience.\n\nNecessary cookies are absolutely essential for the website to function properly. This category\nonly includes cookies that ensures basic functionalities and security features of the website.\nThese cookies do not store any personal information.\n\nAny cookies that may not be particularly necessary for the website to function and is used\nspecifically to collect user personal data via analytics, ads, other embedded contents are\ntermed as non-necessary cookies. It is mandatory to procure user consent prior to running\nthese cookies on your website.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-17 - ATT&CK® Deep Dive- Process Injection.pdf"
    ],
    "report_names": [
        "2020-06-17 - ATT&CK® Deep Dive- Process Injection.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535673,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653757235,
    "ts_modification_date": 1653757235,
    "files": {
        "pdf": "https://archive.orkl.eu/0aff04a6841f361f6e1aed25513303c7ebec21bd.pdf",
        "text": "https://archive.orkl.eu/0aff04a6841f361f6e1aed25513303c7ebec21bd.txt",
        "img": "https://archive.orkl.eu/0aff04a6841f361f6e1aed25513303c7ebec21bd.jpg"
    }
}