{
    "id": "97b9d699-a949-4231-aad8-70be7169e448",
    "created_at": "2023-05-06T02:08:31.815831Z",
    "updated_at": "2025-03-27T02:15:35.514119Z",
    "deleted_at": null,
    "sha1_hash": "fe6a8b2730c9a303eb8126f2bb001d08acbbd00c",
    "title": "2023-03-29 - Spyware vendors use 0-days and n-days against popular platforms",
    "authors": "",
    "file_creation_date": "2023-05-05T02:01:18Z",
    "file_modification_date": "2023-05-05T02:01:18Z",
    "file_size": 276598,
    "plain_text": "# Spyware vendors use 0-days and n-days against popular platforms\n\n**[blog.google/threat-analysis-group/spyware-vendors-use-0-days-and-n-days-against-popular-platforms/](https://blog.google/threat-analysis-group/spyware-vendors-use-0-days-and-n-days-against-popular-platforms/)**\n\nClement Lecigne March 29, 2023\n\nThreat Analysis Group\n\nGoogle’s Threat Analysis Group (TAG) tracks actors involved in information operations (IO),\ngovernment backed attacks and financially motivated abuse. For years, TAG has been\n[tracking the activities of commercial spyware vendors to protect users. Today, we actively](https://blog.google/threat-analysis-group/italian-spyware-vendor-targets-users-in-italy-and-kazakhstan/)\ntrack more than 30 vendors with varying levels of sophistication and public exposure selling\nexploits or surveillance capabilities to government backed actors. These vendors are\nenabling the proliferation of dangerous hacking tools, arming governments that would not be\nable to develop these capabilities in-house. While use of surveillance technologies may be\nlegal under national or international laws, they are often found to be used by governments to\ntarget dissidents, journalists, human rights workers and opposition party politicians.\n\nIn this blog, we’re sharing details about two distinct campaigns we’ve recently discovered\nwhich used various 0-day exploits against Android, iOS and Chrome and were both limited\nand highly targeted. The 0-day exploits were used alongside n-day exploits and took\nadvantage of the large time gap between the fix release and when it was fully deployed on\nend-user devices. Our findings underscore the extent to which commercial surveillance\nvendors have proliferated capabilities historically only used by governments with the\ntechnical expertise to develop and operationalize exploits.\n\n## Campaign #1 - Your missed parcel included 0-days (CVE-2022-42856; CVE- 2022-4135)\n\nIn November 2022, TAG discovered exploit chains with 0-days affecting Android and iOS that\nwere delivered via bit.ly links sent over SMS to users located in Italy, Malaysia and\nKazakhstan. When clicked, the links redirected visitors to pages hosting exploits for either\nAndroid or iOS then redirected them to legitimate websites such as the page to track\nshipments for Italian-based shipment and logistics company BRT or a popular Malaysian\nnews website.\n\nImage of a screenshot from one of the malicious websites\nAn example screenshot from one of the malicious websites\n\n**iOS Exploit Chain**\n\n\n-----\n\nThe iOS exploit chain targeted versions prior to 15.1 and contained the following exploits,\nincluding one 0-day:\n\n[CVE-2022-42856, a WebKit remote code execution exploiting a type confusion issue](https://support.apple.com/en-gb/HT213597)\nwithin the JIT compiler (0-day at time of exploitation).\n[The exploit used a PAC bypass technique which was fixed in March 2022 when Apple](https://bugs.webkit.org/show_bug.cgi?id=237867)\nremoved DYLD_INTERPOSE from WebKit. The exact same technique was used in\n[Cytrox exploits as described by Citizenlab in their blog about Predator. The](https://citizenlab.ca/2021/12/pegasus-vs-predator-dissidents-doubly-infected-iphone-reveals-cytrox-mercenary-spyware/)\n“make_bogus_transform” function is part of the PAC bypass and is present in both\nexploits.\n\nExtract from CitizenLab report mentioning the “make_bogus_transform” function\nExtract from CitizenLab report mentioning the “make_bogus_transform” function\n\n[CVE-2021-30900, a sandbox escape and privilege escalation bug in AGXAccelerator,](https://support.apple.com/en-us/HT212872)\n[fixed by Apple in 15.1. The bug was previously described in an exploit for](https://github.com/singi/oob_timestamp)\noob_timestamp published on Github in 2020.\n\nscreenshot of code\nDescription of CVE-2021-30900 on an exploit for oob_timestamp (CVE-2020-3837)\n\nThe final payload was a simple stager that pings back the GPS location of the device and\ngives the attacker the ability to install an .IPA file (iOS application archive) onto the affected\ndevice.\n\n**Android Exploit Chain**\n\nThe Android exploit chain targeted users on phones with an ARM GPU running Chrome\nversions prior to 106. It consisted of three exploits, including one 0-day:\n\n[CVE-2022-3723, a type confusion vulnerability in Chrome, found by Avast in the wild](https://chromereleases.googleblog.com/2022/10/stable-channel-update-for-desktop_27.html)\n[and fixed in October 2022 in version 107.0.5304.87.](https://chromereleases.googleblog.com/2022/10/stable-channel-update-for-desktop_27.html)\n[CVE-2022-4135, a Chrome GPU sandbox bypass only affecting Android (0-day at time](https://chromereleases.googleblog.com/2022/11/stable-channel-update-for-desktop_24.html)\nof exploitation), fixed in November 2022. Sergei Glazunov from Project Zero helped\n[analyze the exploit and wrote a root cause analysis for this bug.](https://googleprojectzero.github.io/0days-in-the-wild//0day-RCAs/2022/CVE-2022-4135.html)\n[CVE-2022-38181, a privilege escalation bug fixed by ARM in August 2022. It is unclear](https://nvd.nist.gov/vuln/detail/CVE-2022-38181)\nif attackers had an exploit for this vulnerability before it was reported to ARM.\n\nIt’s worth noting users were redirected to Chrome using Intent Redirection if they were\ncoming from a Samsung Internet Browser. In the past, we have seen attackers redirect users\nfrom Chrome to Samsung Internet Browser, similar to [CVE-2022-2856, but in this case the](https://chromereleases.googleblog.com/2022/08/stable-channel-update-for-desktop_16.html)\nredirection occurred the other way. We were unable to obtain the final payload for this exploit\nchain.\n\n\n-----\n\nWhen ARM released a fix for CVE-2022-38181, patches were not immediately incorporated\nby vendors, resulting in the bugs exploitation. This was recently highlighted by blog posts\nfrom [Project Zero and](https://googleprojectzero.blogspot.com/2022/11/mind-the-gap.html) [Github Security Lab.](https://github.blog/2023-01-23-pwning-the-all-google-phone-with-a-non-google-bug/)\n\nNote, Pixel devices with the 2023-01-05 security update are protected against both exploit\nchains in this blog. Chrome users updated to at least version 108.0.5359 are also protected.\n\n**Related IOCs**\n\nhttps://cdn.cutlink[.]site/p/uu6ekt - landing page\nhttps://api.cutlink[.]site/api/s/N0NBL8/ - Android exploit chain\nhttps://api.cutlink[.]site/api/s/3PU970/ - iOS exploit chain\nhttps://imjustarandomsite.3utilities[.]com - exploit delivery server\n\n## Campaign #2 - Complete exploit chain against Samsung Internet Browser (CVE-2022-4262; CVE-2023-0266)\n\nIn December 2022, TAG discovered a complete exploit chain consisting of multiple 0-days\nand n-days targeting the latest version of Samsung Internet Browser. The exploits were\ndelivered in one-time links sent via SMS to devices located in the United Arab Emirates\n(UAE).\n\nThe link directed users to a landing page identical to the one TAG examined in the Heliconia\nframework developed by commercial spyware vendor Variston. The exploit chain ultimately\ndelivered a fully featured Android spyware suite written in C++ that includes libraries for\ndecrypting and capturing data from various chat and browser applications. The actor using\nthe exploit chain to target UAE users may be a customer or partner of Variston, or otherwise\nworking closely with the spyware vendor.\n\nThe exploit chain TAG recovered was delivered to the latest version of Samsung’s Browser,\nwhich runs on Chromium 102 and does not include recent mitigations. If they had been in\nplace, the attackers would have needed additional vulnerabilities to bypass the mitigations.\nThe exploit chain consisted of multiple 0-days and n-days:\n\n[CVE-2022-4262, a type confusion vulnerability in Chrome fixed in December 2022 (0-](https://chromereleases.googleblog.com/2022/12/stable-channel-update-for-desktop.html)\n[day at time of exploitation) - similar to CVE-2022-1134.](https://github.blog/2022-06-29-the-chromium-super-inline-cache-type-confusion/)\n[CVE-2022-3038, a sandbox escape in Chrome fixed in August 2022, in version 105](https://chromereleases.googleblog.com/2022/08/stable-channel-update-for-desktop_30.html)\n[and found by Sergei Glazunov in June 2022.](https://bugs.chromium.org/p/chromium/issues/detail?id=1340253)\n[CVE-2022-22706, a vulnerability in Mali GPU Kernel Driver fixed by ARM in January](https://nvd.nist.gov/vuln/detail/CVE-2022-22706)\n2022 and marked as being used in the wild. At the time of delivery, the latest Samsung\nfirmware had not included a fix for this vulnerability. This vulnerability grants the\nattacker system access.\n\n\n-----\n\n[CVE-2023-0266, a race condition vulnerability in the Linux kernel sound subsystem](https://nvd.nist.gov/vuln/detail/CVE-2023-0266)\nreachable from the system user and that gives the attacker kernel read and write\naccess (0-day at time of exploitation).\n\nThe exploit chain also took advantage of multiple kernel information leak 0-days when\nexploiting CVE-2022-22706 and CVE-2023-0266. Google reported these vulnerabilities to\nARM and Samsung. CVE-2023-26083 was reserved for the information leak in Mali.\n\nNote, Samsung fixed CVE-2022-4262 and CVE-2022-3038 in Samsung’s Browser after\nversion 19.0.6 released at the end of December 2022.\n\n**Related IOCs**\n\nwww.sufficeconfigure[.]com - landing page and exploit delivery\nwww.anglesyen[.]org - malware C2\nThe following Android system properties might indicate signs of exploitation\n\nsys.brand.note\nsys.brand.notes\nsys.brand.doc\nThe following directory on the phone might indicate signs of infection\n\n/data/local/tmp/dropbox\n\n## Protecting our users\n\nTo protect our users, Google has reported these vulnerabilities to the vendors. We would be\nremiss if we did not acknowledge the quick response and patching of these vulnerabilities by\nGoogle’s Chrome, Pixel and Android teams, as well as by Apple. We would also like to\nacknowledge and thank the Amnesty Security Lab for their help uncovering the second\ncampaign detailed in this blog.\n\nThese campaigns continue to underscore the importance of patching, as users wouldn’t be\nimpacted by these exploit chains if they were running a fully updated device. Intermediate\nmitigations like PAC, [V8 sandbox and](https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/edit#) [MiraclePTR have a real impact on exploit developers,](https://docs.google.com/document/d/1pnnOAIz_DMWDI4oIOFoMAqLnf_MZ2GsrJNb_dbQ3ZBg/edit)\nas they would have needed additional bugs to bypass these mitigations.\n\n## Conclusion\n\nThese campaigns are a reminder that the commercial spyware industry continues to thrive.\nEven smaller surveillance vendors have access to 0-days, and vendors stockpiling and using\n0-day vulnerabilities in secret pose a severe risk to the Internet. These campaigns may also\nindicate that exploits and techniques are being shared between surveillance vendors,\nenabling the proliferation of dangerous hacking tools. We remain committed to updating the\ncommunity, and taking steps to protect users, as we uncover these campaigns.\n\n\n-----\n\nPOSTED IN:\n\n[Threat Analysis Group](https://blog.google/threat-analysis-group/%20)\n\nRelated stories\n\nThreat Analysis Group\n**TAG Bulletin: Q1 2023**\n\nThreat Analysis Group shares their Q1 2023 bulletin.\n\nBy Shane Huntley\n\nMay 01, 2023\nThreat Analysis Group\n**Ukraine remains Russia’s biggest cyber focus in 2023**\n\nGoogle's Threat Analysis Group shares first quarter cyber updates on the threat\nlandscape from the war in Ukraine.\n\nBy Billy Leonard\n\nApr 19, 2023\nThreat Analysis Group\n**How we’re protecting users from government-backed attacks from North Korea**\n\nGoogle's Threat Analysis Group shares information on ARCHIPELAGO as well as the\nwork to stop government-backed attackers.\n\nBy Adam Weidemann\n\nApr 05, 2023\nThreat Analysis Group\n**Magniber ransomware actors used a variant of Microsoft SmartScreen bypass**\n\nNew research from Threat Analysis Group on Magniber's exploitation of Microsoft 0day vulnerability.\n\nBy Benoit Sevens\n\nMar 14, 2023\n\n\n-----\n\nThreat Analysis Group\n**Fog of war: how the Ukraine conflict transformed the cyber threat landscape**\n\nBy Shane Huntley\n\nFeb 16, 2023\nThreat Analysis Group\n**Over 50,000 instances of DRAGONBRIDGE activity disrupted in 2022**\n\nAn update on TAG's work to disrupt the information operation network\nDRAGONBRIDGE.\n\nBy Zak Butler Jonas Taege\n\nJan 26, 2023\n.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-29 - Spyware vendors use 0-days and n-days against popular platforms.pdf"
    ],
    "report_names": [
        "2023-03-29 - Spyware vendors use 0-days and n-days against popular platforms.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a90ae795-3c01-4419-8365-07b68df72661",
            "created_at": "2024-07-02T02:00:04.158227Z",
            "updated_at": "2025-03-27T02:00:03.394622Z",
            "deleted_at": null,
            "main_name": "Dragonbridge",
            "aliases": [
                "Spamouflage Dragon"
            ],
            "source_name": "MISPGALAXY:Dragonbridge",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1683338911,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1683252078,
    "ts_modification_date": 1683252078,
    "files": {
        "pdf": "https://archive.orkl.eu/fe6a8b2730c9a303eb8126f2bb001d08acbbd00c.pdf",
        "text": "https://archive.orkl.eu/fe6a8b2730c9a303eb8126f2bb001d08acbbd00c.txt",
        "img": "https://archive.orkl.eu/fe6a8b2730c9a303eb8126f2bb001d08acbbd00c.jpg"
    }
}