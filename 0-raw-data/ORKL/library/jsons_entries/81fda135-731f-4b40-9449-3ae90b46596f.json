{
    "id": "81fda135-731f-4b40-9449-3ae90b46596f",
    "created_at": "2023-01-12T15:05:22.030946Z",
    "updated_at": "2025-03-27T02:05:37.996201Z",
    "deleted_at": null,
    "sha1_hash": "e69a4fa16dd2d3b196094f0c3a6d589b508ebbea",
    "title": "2012-08-16 - The Shamoon Attacks",
    "authors": "",
    "file_creation_date": "2022-05-28T18:18:51Z",
    "file_modification_date": "2022-05-28T18:18:51Z",
    "file_size": 141675,
    "plain_text": "# The Shamoon Attacks\n\n**[web.archive.org/web/20120818235442/https://www.symantec.com/connect/blogs/shamoon-attacks](https://web.archive.org/web/20120818235442/https://www.symantec.com/connect/blogs/shamoon-attacks)**\n\n[Updated: 16 Aug 2012 | Translations available: 日本語](https://web.archive.org/web/20120818235442/https:/www.symantec.com/connect/blogs/shamoon)\n\n[Symantec Security Response](https://web.archive.org/web/20120818235442/https:/www.symantec.com/connect/user/symantec-security-response)\nSymantec Employee\n\n+2 2 Votes\nLogin to vote\n\n[Tweet](https://web.archive.org/web/20120818235442/https://twitter.com/share)\nW32.Disttrack is a new threat that is being used in specific targeted attacks against at least\none organization in the energy sector. It is a destructive malware that corrupts files on a\ncompromised computer and overwrites the MBR (Master Boot Record) in an effort to render\na computer unusable.\n\nW32.Disttrack consists of several components:\n\n1. Dropper—the main component and source of the original infection. It drops a number\n\nof other modules.\n2. Wiper—this module is responsible for the destructive functionality of the threat.\n3. Reporter—this module is responsible for reporting infection information back to the\n\nattacker.\n\n## Dropper Component\n\nThe Dropper component performs the following actions:\n\nCopies itself to %System%\\trksvr.exe\n\n\n-----\n\nDrops the following files embedded into resources:\n\nA 64-bit version of the dropper component: %System%\\trksrv.exe (contained in\nthe “X509” resource)\nReporter component: %System%\\netinit.exe (contained in the \"PKCS7\" resource)\nWiper component: %System%\\[NAME SELECTED FROM LIST].exe (contained\nin the \"PKCS12\" resource)\n**Note: The name of the component is selected from the following list:**\n\ncaclsrv\ncertutl\nclean\nctrl\ndfrag\ndnslookup\ndvdquery\nevent\nextract\nfindfile\nfsutl\ngpget\niissrv\nipsecure\nmsinit\nntx\nntdsutl\nntfrsutil\nntnw\npower\nrdsadmin\nregsys\nrouteman\nrrasrv\nsacses\nsfmsc\nsigver\nsmbinit\nwcscript\nCopies itself to the following network shares:\n\nADMIN$\nC$\\\\WINDOWS\nD$\\\\WINDOWS\nE$\\\\WINDOWS\nCreates a task to execute itself\n\n\n-----\n\nCreates the following service to start itself whenever Windows starts:\n\n**Service name: TrkSvr**\n**Display name: Distributed Link Tracking Server**\n**Image path: %System%\\trksvr.exe**\n\n## Wiper Component\n\nThe Wiper component includes the following functionality:\n\nDeletes an existing driver from the following location and overwrites it with another\nlegitimate driver:\n\n_%System%\\drivers\\drdisk.sys_\nThe device driver is a clean disk driver that enables user-mode applications to\nread and write to disk sectors. The driver is used to overwrite the computer’s\nMBR but may be used for legitimate purposes.\nThe file is digitally signed\nExecutes the following commands that collect file names, which will be overwritten and\nwrites them to f1.inf and f2.inf:\n\nFiles from the f1.inf and f2.inf will be overwritten with the JPEG image shown below.\nOverwritten files are thus rendered useless.\n\n\n-----\n\n**_Figure 1. Image used to overwrite files_**\n\nFinally, the component will overwrite the MBR so that the compromised computer can\nno longer start\n\nThe following string that points to the location of debug symbols was left in the Wiper\ncomponent of this threat and gives an idea of where the component was located on the\ndeveloper’s computer:\nC:\\Shamoon\\ArabianGulf\\wiper\\release\\wiper.pdb\n\n## Reporter Component\n\nThe Reporter component is responsible for sending infection information back to the\nattacker. Information is sent as a HTTP GET request and is structured as follows:\n\nhttp://[DOMAIN]/ajax_modal/modal/data.asp?mydata=[MYDATA]&uid=[UID]&state=[STATE]\n\nThe following data is sent to the attacker:\n\n[DOMAIN]—a domain name\n\n[MYDATA]—a number that specifies how many files were overwritten\n\n[UID]—the IP address of the compromised computer\n\n\n-----\n\n[STATE]—a random number\n\nThreats with such destructive payloads are unusual and are not typical of targeted attacks.\nSymantec Security Response is continuing to analyze this threat and will post more\ninformation as it becomes available. Symantec customers are protected from this threat,\n[which our security products detect as W32.Disttrack.](https://web.archive.org/web/20120818235442/http://www.symantec.com/security_response/writeup.jsp?docid=2012-081608-0202-99&om_rssid=sr-mixed30days)\n\nBlog Entry Filed Under:\n\n[Security,](https://web.archive.org/web/20120818235442/https:/www.symantec.com/connect/communities/security) [Security Response,](https://web.archive.org/web/20120818235442/https:/www.symantec.com/connect/symantec-blogs/security-response) [Endpoint Protection (AntiVirus),](https://web.archive.org/web/20120818235442/https:/www.symantec.com/connect/products/endpoint-protection-antivirus) [W32.Disttrack](https://web.archive.org/web/20120818235442/https:/www.symantec.com/connect/blog-tags/w32disttrack)\n\n[Symantec Security Response's blog](https://web.archive.org/web/20120818235442/https:/www.symantec.com/connect/blog/1017241)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-08-16 - The Shamoon Attacks.pdf"
    ],
    "report_names": [
        "2012-08-16 - The Shamoon Attacks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535922,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653761931,
    "ts_modification_date": 1653761931,
    "files": {
        "pdf": "https://archive.orkl.eu/e69a4fa16dd2d3b196094f0c3a6d589b508ebbea.pdf",
        "text": "https://archive.orkl.eu/e69a4fa16dd2d3b196094f0c3a6d589b508ebbea.txt",
        "img": "https://archive.orkl.eu/e69a4fa16dd2d3b196094f0c3a6d589b508ebbea.jpg"
    }
}