{
    "id": "524632e5-5310-4f28-966c-54d1212c0681",
    "created_at": "2022-10-25T16:48:19.097357Z",
    "updated_at": "2025-03-27T02:09:15.357992Z",
    "deleted_at": null,
    "sha1_hash": "2bf418f3786cd274b9031a2297313f044054bdfd",
    "title": "El Machete",
    "authors": "Kaspersky",
    "file_creation_date": "2014-08-20T17:01:28Z",
    "file_modification_date": "2014-08-20T17:01:28Z",
    "file_size": 1117158,
    "plain_text": "## Introduction\n\nSome time ago, a Kaspersky Lab customer in Latin America contacted us to say he had visited China and\n\nsuspected his machine was infected with an unknown, undetected malware. While assisting the customer,\n\nwe found a very interesting file in the system that is completely unrelated to China and contained no\n\nChinese coding traces. At first look, it pretends to be a Java related application but after a quick analysis, it\n\nwas obvious this was something more than just a simple Java file. It was a targeted attack we are calling\n\n\"Machete\".\n\n## What is \"Machete\"?\n\n\"Machete\" is a targeted attack campaign with Spanish speaking roots. We believe this campaign started in\n\n2010 and was renewed with an improved infrastructure in 2012. The operation may be still \"active\".\n\nThe malware is capable of the following cyber-espionage operations:\n\nLogging keystrokes\n\nCapturing audio from the computer's microphone\n\nCapturing screenshots\n\nCapturing geolocation data\n\nTaking photos from the computer's web camera\n\nCopying files to a remote server\n\nCopying files to a special USB device if inserted\n\nHijjacking the clipboard and capturing information from the target machine\n\n## Targets of \"Machete\"\n\n\n-----\n\nMost of the victims are located in, Venezuela, Ecuador, Colombia, Peru, Russia, Cuba, and Spain, among\n\nothers. In some cases, such as Russia, the target appears to be an embassy from one of the countries of\n\nthis list.\n\nTargets include high-level profiles, including intelligence services, military, embassies and government\n\ninstitutions.\n\n\n-----\n\nThe malware is distributed via social engineering techniques, which includes spear-phishing emails and\n\ninfections via Web by a fake Blog website. We have found no evidence of of exploits targeting zero-day\n\nvulnerabilities. Both the attackers and the victims appear to be Spanish-speaking.\n\nDuring this investigation, we also discovered many other the files installing this cyber-espionage tool in\n\nwhat appears to be a dedicated a spear phishing campaign. These files display a PowerPoint presentation\n\nthat installs the malware on the target system once the file is opened. These are the names of the\n\nPowerPoint attachments:\n\nHermosa XXX.pps.rar\n\nSuntzu.rar\n\nEl arte de la guerra.rar\n\nHot brazilian XXX.rar\n\nThese files are in reality Nullsoft Installer self-extracting archives and have compilation dates going back\n\nto 2008.\n\nA consequence of the embedded Python code inside the executables is that these installers include all the\n\nnecessary Python libraries as well as the PowerPoint file shown to the victim during the installation. The\n\nresult is extremely large files, over 3MB.\n\nHere are some screnshots of the mentioned files:\n\n\n-----\n\nA technical relevant fact about this campaign is the use of Python embedded into Windows executables of\n\nthe malware. This is very unusual and does not have any advantage for the attackers except ease of coding.\n\nThere is no multi-platform support as the code is heavily Windows-oriented (use of libraries). However,\n\nwe discovered several clues that the attackers prepared the infrastructure for Mac OS X and Unix victims\n\nas well. In addition to Windows components, we also found a mobile (Android) component.\n\n\n-----\n\nside and in the Python code.\n\n## Indicators of Compromise\n\n### Web infections\n\nThe following code snippets were found into the HTML of websites used to infect victims:\n\nNote: Thanks to Tyler Hudak from Korelogic who noticed that the above HTML is copy pasted from\n\n[SET, The Social Engineering Toolkit.](https://www.trustedsec.com/downloads/social-engineer-toolkit/)\n\nAlso the following link to one known infection artifact:\n\n_hxxp://name.domain.org/nickname/set/Signed_Update.jar_\n\n### Domains\n\n\n-----\n\nconsidered extremely suspicious\n\n_java.serveblog.net_\n\n_agaliarept.com_\n\n_frejabe.com_\n\n_grannegral.com_\n\n_plushbr.com_\n\n_xmailliwx.com_\n\n_blogwhereyou.com (sinkholed by Kaspersky Lab)_\n\n_grannegral.com (sinkholed by Kaspersky Lab)_\n\n### Infection artifacts\n\n**MD5** **Filename**\n61d33dc5b257a18eb6514e473c1495fe AwgXuBV31pGV.eXe\nb5ada760476ba9a815ca56f12a11d557 EL ARTE DE LA GUERRA.exe\nd6c112d951cb48cab37e5d7ebed2420b Hermosa XXX.rar\ndf2889df7ac209e7b696733aa6b52af5 Hermosa XXX.pps.rar\ne486eddffd13bed33e68d6d8d4052270 Hermosa XXX.pps.rar\ne9b2499b92279669a09fef798af7f45b Suntzu.rar\nf7e23b876fc887052ac8e2558f0d6c38 Hot Brazilian XXX.rar\nb26d1aec219ce45b2e80769368310471 Signed_Update.jar\n\n### Traces on infected machines\n\nCreates the file Java Update.lnk pointing to appdata/Jre6/java.exe\n\nMalware is installed in appdata/ MicroDes/\n\nRunning processes Creates Task Microsoft_up\n\n## Human part of \"Machete\"\n\n### Language\n\nThe first evidence is the language used, both for the victims and attackers, is Spanish.\n\nThe victims are all Spanish speaking according to the filenames of the stolen documents.\n\nThe language is also Spanish for the operators of the campaign, we can find all the server side code written\n\nin this language: reportes, ingresar, peso, etc.\n\n\n-----\n\nThe \"Machete\" discovery shows there are many regional players in the world of targeted attacks.\n\nUnfortunately, such attacks became a part of the cyber arsenal of many nations located over the world. We\n\ncan be sure there are other parallel targeted attacks running now in Latin America and other regions.\n\nKaspersky Lab products detect malicious samples related to this targeted attack as Trojan\n**Spy.Python.Ragua.**\n\n**_Note: A full analysis of the Machete attacks is available to the Kaspersky Intelligent_**\n\n**_[Services customers. Contact: intelreports@kaspersky.com](mailto:intelreports@kaspersky.com)_**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/badlir1w3z6fowjb0xj9too0mf11ls4e",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.08.20.El_Machete/El_Machete.pdf"
    ],
    "report_names": [
        "El_Machete"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "edc11896-f4f1-4132-9c38-d073ccdcf5b6",
            "created_at": "2022-10-25T16:07:23.576476Z",
            "updated_at": "2025-03-27T02:02:09.873658Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "ATK 97",
                "Operation HpReact",
                "TAG-NS1",
                "TEMP.Andromeda"
            ],
            "source_name": "ETDA:El Machete",
            "tools": [
                "El Machete",
                "ForeIT",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Pyark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba4f277c-c3da-45e6-a2fb-4ed556dbae64",
            "created_at": "2023-01-06T13:46:38.605117Z",
            "updated_at": "2025-03-27T02:00:02.871423Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "G0095",
                "machete-apt"
            ],
            "source_name": "MISPGALAXY:El Machete",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041355,
    "ts_creation_date": 1408554088,
    "ts_modification_date": 1408554088,
    "files": {
        "pdf": "https://archive.orkl.eu/2bf418f3786cd274b9031a2297313f044054bdfd.pdf",
        "text": "https://archive.orkl.eu/2bf418f3786cd274b9031a2297313f044054bdfd.txt",
        "img": "https://archive.orkl.eu/2bf418f3786cd274b9031a2297313f044054bdfd.jpg"
    }
}