{
    "id": "608ecc42-7bd6-471b-b7f7-73c7408fbba1",
    "created_at": "2023-01-12T15:02:28.900683Z",
    "updated_at": "2025-03-27T02:06:10.593869Z",
    "deleted_at": null,
    "sha1_hash": "aca5b3328f5f23b6d7f186a64f3b9befeb1956b4",
    "title": "2022-02-18 - PseudoManuscrypt Being Distributed in the Same Method as Cryptbot",
    "authors": "",
    "file_creation_date": "2022-05-28T23:21:56Z",
    "file_modification_date": "2022-05-28T23:21:56Z",
    "file_size": 1638644,
    "plain_text": "# PseudoManuscrypt Being Distributed in the Same Method as Cryptbot\n\n**asec.ahnlab.com/en/31683/**\n\nFebruary 18, 2022\n\nThe ASEC analysis team has discovered that PseudoManuscrypt malware was being\ndistributed in Korea since May 2021. Introduced in the previous ASEC blog,\nPseudoManuscrypt is disguised as an installer that is similar to a form of Cryptbot, and is\nbeing distributed. Not only is its file form similar to Cryptbot, but it is also distributed via\nmalicious sites exposed on the top search page when users search commercial softwarerelated illegal programs such as Crack and Keygen.\n\nThe team has confirmed the executable file path below in the logs collected by AhnLab’s\nASD (AhnLab Smart Defense) infrastructure, and it appears that the user was trying to\ndownload a Windows validation program from a malicious site.\n\n**Executable File Path**\n\n…\\downloads\\60b63e_kmsauto-net-201\\kmsauto-net-2016-v154-windows-10-activatorportable\\60b63e21e82a660b63e21e_setup_v18.2.9\\main_setup_x86x64.exe\n\n\n-----\n\nLog Detection Graph\nSuch a distribution method targets random users, and it has been confirmed that numerous\nPCs in Korea were infected. The figure above is a graph of the number of logs that were\ndetected since the start of distribution (May 2021) up till now. The green graph shows the\nnumber of infected PCs, and the red graph shows the number of detected files. You can see\nthat on average, around 30 PCs were consistently being infected every day.\n\nPseudoManuscrypt operation flow\nThe top-level file disguised as an illegal program is in the form of NSIS (Nullsoft Scriptable\nInstall System) Installer, and it creates the “setup_installer.exe” file to execute it.\n“Setup_installer.exe” is in the form of 7z SFX, and it creates a Loader file, various malware,\nand numerous dll files. The dll files are all normal files, and they are libraries needed to\nexecute the Loader file. Loader executes the various malware that was created together, and\nthis process is the same as the execution process of Cryptbot. Other than\nPseudoManuscrypt, malware executed by Loader includes SmokeLoader, Glupteba, etc.,\nand PseudoManuscrypt is in the form of 7z SFX. Finally, PseudoManuscrypt creates\ninstall.dll (Loader that performs decoding) and install.dat (Encoded shellcode) in the\n%TEMP% path. It then creates and executes a shortcut file called “install.dll.lnk” to operate a\ncertain function inside the install.dll file.\n\n\n-----\n\n**Property of install.dll.lnk**\n\nC:\\Windows\\system32\\rUNdlL32.eXe “%TEMP%\\install.dll”,install\n\nPseudoManuscrypt execution flow (2)\nThe install.dll file decodes the install.dat file to execute it in the memory. The install.dat file\ncontains a shellcode and pe data that is encoded and compressed, and the shellcode\ndecodes the encoded and compressed pe data and executes it. The pe data then performs\nthe actual malicious behavior and decodes additional data inside to create it with the tmp\nextension, which is then registered to service. Details about pe data are explained below.\n\n\n-----\n\nCommand line scan\n\nThe called pe data first checks if the name of the currently running process is svchost.exe. In\nthis case, the current process was run as rundll32.exe by the shortcut file.\n\nMachineGuid value\nWhen it is not a svchost.exe process, it creates a certain registry key and saves malicious\ndata. For the name of the created registry, it uses the MachineGuid value that exists in the\nHKLM\\SOFTWARE\\Microsfot\\Cryptography registry. MachineGuid is a HardwareID value,\nwhere each PC has a unique value. It uses this characteristic to create the registry key\nname.\n\n\n-----\n\nMachineGuid value is encoded via the Global string, and the encoded MachineGuid value\nis used to create a registry key in the path below. The encoded “install.dat” data is then\nsaved to the registry key.\n\n– HKLM\\SOFTWARE\\Classes\\CLSID\\MachineGuid(“Global”):1 – Encoded “install.dat”\n\nRunning service scan\nAfter it creates the registry key, it checks the process id of services that include “-k netsvcs”\nin their arguments, then injects the decoded “install.dat” in the process. It then deletes the\n“install.dat” file that exists in the %TEMP% path, and the injected process references the\nencoded “install.dat” data that was saved to the registry key.\n\nThe injected svchost.exe goes through the same process and scans the command line. It\nchecks if the name of the current process is svchost.exe and if netsvcs is included in the\nargument, it executes two threads.\n\n\n-----\n\nThe threat that is first executed performs the feature of registering a certain file to service\nwhen the process is terminated. It first brings down the priority of process termination to the\nlowest and configures the control handler.\n\nControl handler function\n\nThe function that is added to the control handler is as shown above, and it checks the\nreceived control signals. The function scans for the following control signal values: 5 and 6. If\nthe signal value is 5 (When the user logs off), it reconfigures the priority of process\ntermination and the control handler, and if the signal value is 6 (When the system shuts\ndown), it executes a function that creates a malicious service. The malicious service is\ncreated via the process below.\n\nAfter creating the SYSTEM\\\\CurrentControlSet\\\\Services\\\\AppService[a-z] registry, it\nconfigures this service registry as shown below.\n\n– Start : 0x02 (Starts automatically when the system starts)\n\n– imagepath : %SystemRoot%\\System32\\svchostexe -k AppService\n\nThe name of the created service and the file that is executed via the service are configured\nas follows:\n\n– SYSTEM\\\\CurrentControlSet\\\\ServicesAppService[a-z]\\\\Parameters:servicedll =\n%System%\\Encoded string.tmp\n\n– SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost:AppService\n=AppService[a-z]\n\n\n-----\n\nCreated service\nThe file that is to be registered to the service decodes the data that exists in a certain\nlocation and creates it with the tmp extension in the System path. The created tmp file acts\nas a Loader that decodes and executes the encoded “install.dat” data existing in a certain\nregistry key. It appears that this process serves the purpose of performing continuous\nmalicious behaviors even when the user PC is shut down and restarted.\n\nAdding an exclusion to Windows Defender\nAfter the service is created, the System folder is excluded from Windows Defender scans,\nand the first thread is terminated.\n\nCreating process\n\n\n-----\n\nThe second thread that is executed is the %System%\\svchost.exe -k SystemNetworkService\ncommand, which performs the function of creating a process and injecting the decoded\n“install.dat” data.\n\nThe injected svchost.exe goes through the same process to scan the command line, and if\nit’s svchost.exe run by the SystemNetworkService argument, it performs the actual malicious\nbehavior. It steals various user credentials including the data below via this process and\nsends them to the attacker’s server.\n\nVPN connection information\nClipboard data\nAudio data\nList of shared network folders\nInformation of processes that accept TCP and UDP ports\nFile version information of the running process\nC2 : email.yg9[.]me\n\nIn addition to the malicious features above, it can also access the C2 server under the\nattacker’s command and perform various malicious behaviors such as file download, screen\ncapture, and execution of keylogger and cmd commands.\n\nAs this malware is disguised as an illegal software installer and is distributed to random\nindividuals via malicious sites, users must be careful not to download relevant programs. As\nmalicious files can also be registered to service and perform continuous malicious behaviors\nwithout the user knowing, periodic PC maintenance is necessary.\n\n**[File Detection]**\n\nTrojan/Win.Generic.R420870 (2021.05.16.01)\nMalware/Win.Generic.R421780 (2021.05.21.03)\nTrojan/Win.Generic.C4512227 (2021.06.04.01)\nTrojan/Win.Generic.C4512246 (2021.06.04.01)\nTrojan/Win.Generic.R421722 (2021.08.17.03)\nTrojan/Win.Generic.R436809 (2021.08.17.03)\nTrojan/Win.Generic.R436811 (2021.08.17.03)\nTrojan/Bin.Encoded (2022.01.28.02)\n\n**[IOC Info]**\n\n1fecb6eb98e8ee72bb5f006dd79c6f2f\n5de2818ced29a1fedb9b24c1044ebd45\n58efaf6fa04a8d7201ab19170785ce85\n839e9e4d6289eba53e40916283f73ca6\n89c8e5a1e24f05ede53b1cab721c53d8\n5e6df381ce1c9102799350b7033e41df\n\n\n-----\n\na29e7bbe6dee4eea95afa3f2e3a1705a\n8ae40c8418b2c36b58d2a43153544ddd\nemail.yg9[.]me\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:PseudoManuscrypt](https://asec.ahnlab.com/tag/pseudomanuscrypt/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-18 - PseudoManuscrypt Being Distributed in the Same Method as Cryptbot.pdf"
    ],
    "report_names": [
        "2022-02-18 - PseudoManuscrypt Being Distributed in the Same Method as Cryptbot.pdf"
    ],
    "threat_actors": [
        {
            "id": "4c4e1108-8c11-48e3-91e3-95c24042f3a5",
            "created_at": "2022-10-25T16:07:24.329539Z",
            "updated_at": "2025-03-27T02:02:10.17315Z",
            "deleted_at": null,
            "main_name": "ToddyCat",
            "aliases": [
                "Operation Stayin’ Alive"
            ],
            "source_name": "ETDA:ToddyCat",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "Cuthead",
                "FRP",
                "Fast Reverse Proxy",
                "Impacket",
                "Krong",
                "LoFiSe",
                "Ngrok",
                "PcExter",
                "PsExec",
                "Samurai",
                "SinoChopper",
                "SoftEther VPN",
                "TomBerBil",
                "WAExp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "60d96824-1767-4b97-a6c7-7e9527458007",
            "created_at": "2023-01-06T13:46:39.378701Z",
            "updated_at": "2025-03-27T02:00:03.068436Z",
            "deleted_at": null,
            "main_name": "ToddyCat",
            "aliases": [
                "Websiic"
            ],
            "source_name": "MISPGALAXY:ToddyCat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535748,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653780116,
    "ts_modification_date": 1653780116,
    "files": {
        "pdf": "https://archive.orkl.eu/aca5b3328f5f23b6d7f186a64f3b9befeb1956b4.pdf",
        "text": "https://archive.orkl.eu/aca5b3328f5f23b6d7f186a64f3b9befeb1956b4.txt",
        "img": "https://archive.orkl.eu/aca5b3328f5f23b6d7f186a64f3b9befeb1956b4.jpg"
    }
}