{
    "id": "108f944d-7663-4464-bcac-a82a8530a19f",
    "created_at": "2023-01-12T14:59:02.280491Z",
    "updated_at": "2025-03-27T02:05:31.27434Z",
    "deleted_at": null,
    "sha1_hash": "19f01d387f23194fa59cb29cbd7f8a24da7dfeb0",
    "title": "2021-09-14 - Deep-dive Analysis of S.O.V.A. Android Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-27T23:05:49Z",
    "file_modification_date": "2022-05-27T23:05:49Z",
    "file_size": 1875955,
    "plain_text": "# Deep-dive Analysis of S.O.V.A. Android Banking Trojan\n\n**[blog.cyble.com/2021/09/14/deep-dive-analysis-of-s-o-v-a-android-banking-trojan/](https://blog.cyble.com/2021/09/14/deep-dive-analysis-of-s-o-v-a-android-banking-trojan/)**\n\nSeptember 14, 2021\n\nCyble Research Labs came across a blog post on the darkweb regarding an Android Banking Trojan\nnamed S.O.V.A during our routine threat hunting exercise. The post was made by an unknown Threat Actor\n(TA) as an advertisement on the XSS.is forum. The TA also mentions that the trojan is under\ndevelopment. Figure 1 shows the post by Threat Actor (TA) on the XSS.is forum.\n\n_Figure 1: Screenshot from S.O.V.A. blog in XSS.is forum_\nAccording to the post, S.O.V.A. (“owl” in Russian) is a new Android banking trojan under active\ndevelopment. The TA has also mentioned that the trojan currently works on Android version 7 – 11. The\nTA plans to upgrade the bot to work on Android 12 as well.\n\nThe TA is planning incorporate Distributed Denial of Service (DDoS), Man in the Middle (MiTM) and\nransomware functionalities into S.O.V.A. The features in the current version of\nS.O.V.A. malware are listed below:\n\n1. Standard data available in the device\n\n1. Send SMS\n\n1. Send inject PUSH\n\n1. Send a cookie PUSH\n\n1. Send U.S.S.D.\n\n1. Standard Injections\n\n1. 3-Stage Injections\n\n\n-----\n\n1. Cookie Injections (Session Grabber)\n\n1. Automatic Injections\n\n1. Credit Card Injections have a CC check for validity. The victim will not be able to enter incorrect data.\n\n1. Covert SMS Interception\n\n1. Covert PUSH Interception\n\n1. Keylogger\n\n1. Delete Application\n\nThe TA is also planning to add the following features in future variants:\n\n1. Automatic 3-stage Injections\n\n1. Automatic Cookie Injections\n\n1. Complete Normal Clipper\n\n1. DDOS\n\n1. GIF Accessibility\n\n1. Improving Panel Performance\n\n1. Mini Ransomware with Card Insertion\n\n1. Interception of Internet packets (packet capture, “MITM”)\n\n1. Normal PUSH Notifications\n\n1. Many Injections\n\n1. V.N.C.\n\n1. Interception of 2FA\n\n## Technical Analysis\n\n### APK Metadata Information\n\n**APK File Info**\n\nApp Name: Flash Player\nPackage Name: com.adobe.flashplayer\n\nSHA256 Hash: 8a6889610a18296e812fabd0a4ceb8b75caadc5cec1b39e8173c3e0093fd3a57\n\nThe figure below shows the metadata information of the sample\n\n\n-----\n\n_Figure 2: APK Metadata Information_\nThe malware sample is disguising itself as Adobe Flash player as shown in the above figure,\n\n### Manifest File Description\n\nThe fake Flash Player app requests 21 different permissions, of which the T.A. can abuse 12. The\ndangerous permissions requested by the malware are listed below.\n\n**Permission Name** **Description**\n\n**READ_CONTACTS** Access to phone contacts\n\n**READ_EXTERNAL_STORAGE** Access device external storage\n\n**WRITE_EXTERNAL_STORAGE** Modify device external storage\n\n**READ_PHONE_STATE** Access phone state and information\n\n**RECORD_AUDIO** Allows to record audio using device microphone\n\n**CALL_PHONE** Perform call without user intervention\n\n**READ_CALL_LOG** Access user’s call logs\n\n**READ_SMS** Access user’s SMSs stored in the device\n\n**RECEIVE_MMS** Fetch and process M.M.S. messages\n\n**RECEIVE_SMS** Fetch and process SMS messages\n\n**SEND_SMS** Allows the app to send SMS messages\n\n**SYSTEM_ALERT_WINDOW** Allows to display system-alerts over other apps\n\n**WRITE_SMS** Modify or Delete SMSs stored in Database\n\n_Table 1: APK Permission List_\n\nUpon inspecting the Android components declared in the manifest, we identified the activity class that\nis initiated on starting the app from the icon. The declaration of the activity is shown in Figure 3.\n\n\n-----\n\n_Figure 3: Launcher activity declared in Manifest file_\nWe also observed that the permissions, activity classes, and services declared in the manifest file allows\nthe malware to replace the Messages app on the device. Upon receiving permission to act as the\ndefault messaging app, the S.O.V.A. trojan will be able to handle, send and receive SMS and\nM.M.S. messages from the infected device. Refer to Figure 4.\n\n_Figure 4: Declaration of the permission, service, receiver for receiving SMSs and MMSs_\nThe S.O.V.A. malware has also declared permissions to handle device notifications in the Android manifest\nfile. It abuses this capability to read and modify notifications received on the device. Upon enabling this,\nthe banking trojan will be able to intercept all notifications such as OTPs, personal messages, etc.\nThe permission declaration is shown in the figure below.\n\n_Figure 5: Manifest declaration for Notification listener_\nThe figure below shows that the malware requests\nthe user for the BIND_ACCESSIBILITY_PERMISSION. This permission allows apps to access a powerful\nservice running on the Android device called Accessibility Service.\n\n\n-----\n\n_Figure 6: Manifest declaration for BindAccessibility service_\n**Accessibility Service is a background service running in the device which is used to aid users with**\n[disabilities. Malware such as Banking trojans,](https://blog.cyble.com/2021/07/30/aberebot-on-the-rise-new-banking-trojan-targeting-users-through-phishing/) [Remote Access Trojans (R.A.T.s) and Spyware abuse this](https://blog.cyble.com/2021/07/28/a-deep-dive-analysis-of-a-fake-coronapp-targeting-android-users-from-colombia/)\nservice to intercept and monitor all activities happening on the device screen. Examples of this are the\nability to intercept the credentials being entered on another app.\n\n### Initial Stage Behavior\n\nThe figure below shows the various activities performed by S.O.V.A. malware.\n\n_Figure 7: Flow diagram of S.O.V.A. malware’s Initial Stage behavior_\nThe three stages shown in Figure 7 are:\n\n1. Prior to launch, the malware does not have any permission : No Notification listener permission and\n\nno other dangerous permissions\n\n1. Once the victim starts the app, the malware requests the user to enable Accessibility permission:\n\nUpon enabling the Accessibility permission, the malware enables all the requested permissions,\nhides the icon from user’s home screen, requests the victim to make the fake Flash player as the\ndefault messaging app, and blocks the victim from accessing the malicious app’s Settings page. This\nis done to restrict the user from modifying the malware’s capabilities such as permissions.\n\n### Source Code Analysis\n\n\n-----\n\nThe S.O.V.A. malware has created a background service called, RequestService, which communicates\nwith the Command and Control (C&C) server and performs malicious activities based on the commands\nreceived from the server as shown below.\n\n_Figure 8: Code_\n\n_where C&C commands are verified_\nThe commands from the C&C server are:\n\n**Command** **Description**\n\nstartddos Initiate DDoS\n\nstealer Steal Session Cookie of an app\n\nhidensms Hide received SMS from notification\n\nstarthidenpush Hide push notifications\n\ndelbot Delete the bot from device\n\ngetlog Upload key logged data\n\n\n-----\n\nstartkeylog Clears old key log and initiate\n\nscaninject Update targeted application list\n\nstopkeylog Stop keylogging\n\nopeninject Open WebView with the URL from C&C\n\nstophidenpush Stop hiding push notifications\n\nsendpush Display Push notification to start WebView Injection\n\nstophidensms Stop hiding received SMSs\n\nstopddos Stop DDoS\n\nstopscan Stop scan for new app targets\n\nstealerpush Same as sendpush command\n\nsendsms Send SMS message\n\n_Table 2: S.O.V.A. Malware Commands List_\n\nThe S.O.V.A. malware creates listeners for events on the device, such as boot complete, SMS received,\netc. The malware communicates with the C&C server whenever these listeners are triggered. The malware\nalso sends the details of the event along with the data as shown in code in Figure 9.\n\n_Figure 9: Code to Upload data based on Events_\nS.O.V.A. malware constantly monitors the device screen for targeted applications. The targeted\napplications are stored in the packageList.txt file in the assets folder. The below figure shows the file with\nthe list of targeted apps.\n\n\n-----\n\n_Figure 10: Subset of Targeted App list in_\n\n_packageList.txt_\nWhenever the user opens a target application, the malware creates an overlay using the WebView with the\nlink provided by C&C server.\n\nThe targeted apps include banking apps, cryptocurrency apps etc. The TA can also add new apps to\ntarget based on their requirements.\n\nThe malware uses Accessibility to monitor the victim’s device screen. The code used by the malware to\nmonitor the screen for targeted apps is shown in the figure below.\n\n\n-----\n\n_Figure 11: Code to monitor device screen and start the overlay_\nThe below figure shows the code create overlay screen over the targeted application.\n\n_Figure 12: Code to create overlay using WebVIew and to steal the cookie_\n\n\n-----\n\nIn the overlay screen, the victim will be displayed a fake login page of the targeted application. Upon login,\nthe malware steals the cookies using the CookieManager and CookieSyncManager features, the code\nfor which is shown in Figure 12. The trojan also has the capability to send SMS messages to the number\nprovided by the C&C server. The code to send SMSs is shown in the below figure.\n\n_Figure 13: Code to send_\n\n_SMS messages based on C&C command_\nThe trojan registers a service for monitoring the clipboard changes. The code used by the malware for\nclipboard monitoring is shown in figure 14.\n\n_Figure 14: Code to Capture Clipboard Contents_\nThe S.O.V.A. malware also has the capability to perform DDoS attacks on a specific public\nserver which is provided as a command from C&C server. The target of the DDoS attacks is shared by the\nTA.\n\nThe malware hides the C&C server URL using Base64 encoding as shown in the below figure.\n\n_Figure 15: C&C URL encoded using_\n\n_Base64_\nC&C Server URL: hxxp://a0545193.xsph[.]ru\n\n\n-----\n\nThe C&C endpoint methods used by the S.O.V.A. malware:\n\n/api – Main API endpoint method\n/keylog.php – Keylog stealing method\n/testpost.php – send stolen cookies\n\n/logpost.php – send logs\n\nThe below code shows the C&C endpoint methods used by the malware\n\n_Figure 16: Code with C&C Endpoint methods_\nWe also observed that the malware author is planning include Telegram\n[as C&C. This behavior is similar to the recent Banking Trojan called Aberebot. The code below](https://blog.cyble.com/2021/07/30/aberebot-on-the-rise-new-banking-trojan-targeting-users-through-phishing/)\nshows the Telegram API URL included in the malware.\n\n_Figure 17: Telegram API URL in Malware’s code_\n\nThe targeted application list in assets/packageList.txt is shown below.\n\n**Targeted Application List**\n\ncom.google.android.apps.authenticator2\n\ncom.bankaustria.android.olb\n\ncom.cibc.android.mobi\n\ncom.rbc.mobile.android\n\ncz.airbank.android\n\ncom.kutxabank.android\n\nes.lacaixa.mobile.android.newwapicon\n\ncom.mtel.androidbea\n\njp.co.aeonbank.android.passbook\n\ncom.barclays.ke.mobile.android.ui\n\n\n-----\n\nnz.co.anz.android.mobilebanking\n\nalior.bankingapp.android\n\nwit.android.bcpBankingApp.millenniumPL\n\ncom.idamobile.android.hcb\n\nru.rosbank.android\n\ncom.vkontakte.android\n\nru.taxovichkof.android\n\nhr.asseco.android.jimba.mUCI.ro\n\nmay.maybank.android\n\ncom.amazon.mShop.android.shopping\n\nru.alfabank.mobile.android\n\ncom.idamob.tinkoff.android\n\nru.vtb24.mobilebanking.android\n\ncom.akbank.android.apps.akbank_direkt\n\ncom.akbank.android.apps.akbank_direkt_tablet\n\ncom.akbank.android.apps.akbank_direkt_tablet_20\n\ncom.ykb.android\n\ncom.ykb.android.mobilonay\n\ncom.ykb.androidtablet\n\nbiz.mobinex.android.apps.cep_sifrematik\n\ncom.matriksmobile.android.ziraatTrader\n\nde.comdirect.android\n\nde.fiducia.smartphone.android.banking.vr\n\nfr.creditagricole.androidapp\n\ncom.boursorama.android.clients\n\ncom.caisseepargne.android.mobilebanking\n\nfr.lcl.android.customerarea\n\ncom.paypal.android.p2pmobile\n\ncom.usaa.mobile.android.usaa\n\ncom.chase.sig.android\n\n\n-----\n\ncom.grppl.android.shell.BOS\n\ncom.rbs.mobile.android.natwestoffshore\n\ncom.rbs.mobile.android.natwest\n\ncom.rbs.mobile.android.natwestbandc\n\ncom.rbs.mobile.android.rbs\n\ncom.rbs.mobile.android.rbsbandc\n\ncom.rbs.mobile.android.ubr\n\ncom.grppl.android.shell.halifax\n\ncom.grppl.android.shell.CMBlloydsTSB73\n\ncom.barclays.android.barclaysmobilebanking\n\ncom.unionbank.ecommerce.mobile.android\n\nau.com.ingdirect.android\n\ncom.cba.android.netbank\n\ncom.anz.android.gomoney\n\ncom.anz.android\n\nde.fiducia.smartphone.android.banking.vr\n\nit.volksbank.android\n\nde.fiducia.smartphone.android.securego.vr\n\ncom.starfinanz.smob.android.sfinanzstatus\n\ncom.starfinanz.mobile.android.pushtan\n\ncom.starfinanz.smob.android.sfinanzstatus.tablet\n\ncom.starfinanz.smob.android.sbanking\n\ncom.palatine.android.mobilebanking.prod\n\nes.cm.android\n\nes.cm.android.tablet\n\ncom.bestbuy.android\n\ncom.latuabancaperandroid\n\ncom.latuabanca_tabperandroid\n\nit.copergmps.rt.pf.android.sp.bmps\n\ncom.ykb.android\n\n\n-----\n\naib.ibank.android\n\ncom.jpm.sig.android\n\npinacleMobileiPhoneApp.android\n\ncom.fuib.android.spot.online\n\ncom.ukrsibbank.client.android\n\nru.alfabank.mobile.ua.android\n\nua.aval.dbo.client.android\n\nua.com.cs.ifobs.mobile.android.otp\n\nua.com.cs.ifobs.mobile.android.pivd\n\nio.getdelta.android\n\ncom.coinbase.android\n\npiuk.blockchain.android\n\ncom.thunkable.android.santoshmehta364.UNOCOIN_LIVE\n\ncom.thunkable.android.manirana54.LocalBitCoins\n\ncom.thunkable.android.manirana54.LocalBitCoins_unblock\n\ncom.citizensbank.androidapp\n\ncom.navyfederal.android\n\n_Table 3: Targeted Application List_\n\n## Conclusion\n\nAccording to our research, there is a substantial increase in the amount of Android Banking\nTrojans emerging of late. We have also observed that the malware authors are incorporating\nnew technology to steal information and money from victims. S.O.V.A. is the latest example of this shift in\ntrends.\n\nS.O.V.A. malware uses the same techniques used by other Android Banking Trojans such as Aberebot,\nCerberus etc. Alongside being a Banking Trojan, the new trojan offers the capability to\nperform DDoS attacks, cookie stealing, hiding notifications etc,. The author has mentioned that they plan\nto incorporate other dangerous features such as ransomware.\n\nThese trojans can be avoided by following some basic cyber hygiene practices on mobile devices.\n\n## Our Recommendations \n\nWe have listed some of the essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n1. If you find this malware in your device, uninstall using adb **uninstall or perform a factory reset.**\n\n\n-----\n\n1. Use the shared IoCs to monitor and block the malware infection.\n\n1. Keep your anti-virus software updated to detect and remove malicious software.\n\n1. Keep your Operating System and applications updated to the latest versions.\n\n1. Use strong passwords and enable two-factor authentication.\n\n1. Download and install software only from registered app stores.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\nDefense Evasion [T1406](https://attack.mitre.org/techniques/T1406) Obfuscated Files or Information\n\nCredential Access [T1414](https://attack.mitre.org/techniques/T1414/) Capture Clipboard Data\n\n\nDiscovery [T1421](https://attack.mitre.org/techniques/T1421)\n\n[T1430](https://attack.mitre.org/techniques/T1421%22%20%EF%BF%BDHYPERLINK%20%22https://attack.mitre.org/techniques/T1430)\n\n[T1424](https://attack.mitre.org/techniques/T1424)\n\nCollection [T1507](https://attack.mitre.org/techniques/T1507)\n\n[T1412](https://attack.mitre.org/techniques/T1412/)\n\n[T1432](https://attack.mitre.org/techniques/T1432/)\n\n[T1429](https://attack.mitre.org/techniques/T1429)\n\nCommand and Control [T1571](https://attack.mitre.org/techniques/T1571)\n\n[T1573](https://attack.mitre.org/techniques/T1573)\n\n\nSystem Network Connections Discovery\n\nLocation Tracking\n\nProcess Discovery\n\nNetwork Information Discovery\n\nCapture SMS Messages\n\nAccess Contact List\n\nCapture Audio\n\nNon-Standard Port\n\nEncrypted Channel\n\n\nImpact [T1447](https://attack.mitre.org/techniques/T1447) Delete Device Data\n\n## Indicators of Compromise (IoCs): \n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\n8a6889610a18296e812fabd0a4ceb8b75caadc5cec1b39e8173c3e0093fd3a57 SHA256 Hash of the\nAPK sample\n\nefb92fb17348eb10ba3a93ab004422c30bcf8ae72f302872e9ef3263c47133a7 SHA256 Hash of the\nsecond APK\nsample\n\n795b279f312a773f7f556a978387f1b682f93470db4c1b5f9cd6ca2cab1399b6 SHA256 Hash of the\nthird APK\nsample\n\ndd8a5a1a8632d661f152f435b7afba825e474ec0d03d1c5ef8669fdc2b484165 SHA256 Hash of\nthe fourth APK\nsample\n\nhxxp://a0545193.xsph[.]ru URL C&C URL\n\n\n-----\n\nhxxp://l8j1nsk3j5h1msal973nk37[.]fun URL C&C URL of\nanother\nsample\n\n## About Us\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves from](https://cyble.com/)\ncybercrimes and exposure in the Darkweb. Its prime focus is to provide organizations with real-time\nvisibility to their digital risk footprint. Backed by Y Combinator as part of the 2021 winter cohort, Cyble has\nalso been recognized by Forbes as one of the top 20 Best Cybersecurity Start-ups To Watch In 2020.\nHeadquartered in Alpharetta, Georgia, and with offices in Australia, Singapore, and India, Cyble has a\nglobal presence. To learn more about Cyble, visit [www.cyble.com.](https://cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-14 - Deep-dive Analysis of S.O.V.A. Android Banking Trojan.pdf"
    ],
    "report_names": [
        "2021-09-14 - Deep-dive Analysis of S.O.V.A. Android Banking Trojan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535542,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1653692749,
    "ts_modification_date": 1653692749,
    "files": {
        "pdf": "https://archive.orkl.eu/19f01d387f23194fa59cb29cbd7f8a24da7dfeb0.pdf",
        "text": "https://archive.orkl.eu/19f01d387f23194fa59cb29cbd7f8a24da7dfeb0.txt",
        "img": "https://archive.orkl.eu/19f01d387f23194fa59cb29cbd7f8a24da7dfeb0.jpg"
    }
}