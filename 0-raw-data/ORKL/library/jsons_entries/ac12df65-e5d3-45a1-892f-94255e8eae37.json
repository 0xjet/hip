{
    "id": "ac12df65-e5d3-45a1-892f-94255e8eae37",
    "created_at": "2023-01-12T15:08:04.157962Z",
    "updated_at": "2025-03-27T02:09:29.602457Z",
    "deleted_at": null,
    "sha1_hash": "3adc133bdd8b5a837436b3cd5003630b6b9c7633",
    "title": "2019-11-27 - Threat Spotlight- Machete Info-Stealer",
    "authors": "",
    "file_creation_date": "2022-05-28T15:42:26Z",
    "file_modification_date": "2022-05-28T15:42:26Z",
    "file_size": 637138,
    "plain_text": "# Threat Spotlight: Machete Info-Stealer\n\n**[threatvector.cylance.com/en_us/home/threat-spotlight-machete-info-stealer.html](https://threatvector.cylance.com/en_us/home/threat-spotlight-machete-info-stealer.html)**\n\nAdam Martin\n\n[RESEARCH & INTELLIGENCE / 11.27.19 /](https://threatvector.cylance.com/en/category/research-and-intelligence) [Adam Martin](https://threatvector.cylance.com/en/author/adam-martin)\n\n## Introduction\n\nMachete is an info-stealing malware that can harvest user credentials, chat logs, screenshots,\nwebcam pictures, geolocation, and perform keylogging. It can also copy files to a USB device and\ntake control of the clipboard to exfiltrate information.\n\nMachete is typically distributed via social engineering techniques and malicious websites. The user\nis enticed into opening the original executable under the premise that they are opening a\nPowerPoint presentation. This is in fact a Nullsoft installer SFX.\n\nThe Powerpoint can range from illicit images to cleverly crafted images that are meant to represent\ngovernment/ military documentation. The most common names being: \"Hermosa xxx,pps,rar\",\n\"Suntzu.rar\", and \"Hot brazilian XXX.rar\". Based on language found within the file along with open\nsource information the intended targets appear to be Spanish speaking nations across Latin\nAmerica. The payload is typically packaged as part of a PowerPoint presentation with Nullsoft\ninstaller SFX. The executables within the SFX are compiled using Python.\n\n## Technical Analysis\n\n### Static Analysis Pre/Post SFX Extraction\n\nThe original executable is disguised as a document; however, it is an SFX Nullsoft installation file:\n\n_Figure 1: Original SFX disguised as a document_\n\n\n-----\n\nOnce extracted, the following folders are opened in the working directory, which also contains\nNullSoft SFX files:\n\n_Figure 2: Phase 2 of SFX_\n\n_Figure 3: Phase 3 of SFX_\n\nThe fourth extraction creates a folder containing a PowerPoint presentation file and another SFX\nfile disguised as a Java executable:\n\n_Figure 4: Phase 4 of extraction, revealing two files_\n\nThe JavaAlq.exe file contains a multitude of java executables along with a series of Python\nlibraries:\n\n_Figure 5: JavaAlq.exe post-extraction_\n\nEach of the Java executables contained within the original JavaAlq.exe is compiled with a Python\nscript. Each one contains a large volume of Python libraries necessary for the executable to be\ncompiled and run. These Java executables all contain a payload component:\n\n_Figure 6: Python-script resource section found in each Java executable_\n\nThe raw script can be extracted from the executables using a Py2Exe Binary Editor:\n\n_Figure 7: Java.exe PythonScript being dumped_\n\nOnce this Python script has been dumped it needs to be converted into a Python file using an\nopen source Python script extractor:\n\n_Figure 8: PythonScript extractor_\n\nThe final step involved in producing the malicious script is to decompile the Python script. This is\ndone with Easy Python Decompiler:\n\n_Figure 9: Decompiled PythonScript for Java.exe_\n\n\n-----\n\n## Malicious Payloads\n\n### Java.exe\n\nThe keylogging functionality contained within the payload of Java.exe is shown in Figure 10. The\nstandard ascii keys are listed with their key IDs. The hook for the keyboard is also set within this\nscript:\n\n_Figure 10: Key IDs used to log keystrokes_\n\n_Figure 11: Keyboard hook set_\n\nEvidence of connection to the remote server contained within java.exe is shown in Figure 12:\n\n_Figure 12: FTP connection to remote server 2_\n\n## Document Type Check JavaUE.exe\n\nContained within the payload of JavaUE.exe is a document type check of a target directory:\n\n_Figure 13: Checking for document extension types in the target directory_\n\n## JavaK.exe Payload Script\n\nFigure 14 illustrates the webcam information being sent to a remote server. Interestingly, it sets the\nresolution at which to capture information to a low resolution in order to expedite exfiltration of\nimages:\n\n_Figure 14: Webcam exfiltration_\n\n## JavaTM.exe Payload Script\n\nJavaS.exe is run as the last process. It terminates the rest of the spawned processes then deletes\nthem from the victim machine:\n\n_Figure 15: Deletion of Java files and termination of processes_\n\n## Dynamic Analysis\n\n\n-----\n\nWhen the script is executed, a series of files are created along with the Java labelled executables.\nA crypo.cipher.AES Python file is dropped which is used to encrypt the exfiltrated data sent to the\nFTP server. It is also used to assign an encrypted unique identifier to each victim machine. The\nother files installed are Python libraries necessary for the executable to run its payload. The\nsystem information text file is created to record data from the victim machine.\n\n## Conclusion\n\nBlackberry Cylance uses artificial intelligence-based agents trained for threat detection on millions\nof both safe and unsafe files. Our automated security agents block Machete based on countless\nfile attributes and malicious behaviors instead of relying on a specific file signature.\n\nBlackberry Cylance, which offers a [predictive advantage over zero-day threats, is trained on and](https://threatvector.cylance.com/en_us/home/cylance-vs-future-threats-the-predictive-advantage.html)\neffective against both new and legacy cyberattacks. If you are a Blackberry Cylance customer\nusing CylancePROTECTÂ®, you are protected from Machete by our machine learning models.\n\nFor more information, visit [https://www.cylance.com.](https://www.cylance.com/)\n\n## APPENDIX\n\n### Indicators of Compromise (IoCs)\n\n**Indicator** **Type** **Description**\n\n\nC:\\Windows\\system32\\cmd.exe /c SCHTASKS /create /ST 00:00:01\n/SC MINUTE /MO 60 /TR\n\"\\\"C:\\Users\\%USERNAME%\\AppData\\Roaming/MicroDes/JavaH.exe\"\\\"\n/TN Microsoft_up, null\".\n\n\nCommandline\n\n\nScheduled\ntask used to\nlaunch\nJavaH.exe\nas a service\n\n\nC:\\Users\\%USERNAME%\\AppData\\Roaming\\java Path Install folder\n\nC:\\Users\\%USERNAME%\\AppData\\Roaming\\Bin\\Jre6\\ Path Install folder\n\nC:\\Users\\%USERNAME%\\AppData\\Roaming\\MicroDes Path Install folder\n\ncaso.txt File Present in\ninstall folder\n\nJava.exe File Present in\ninstall folder\n\nJavaD.exe File Present in\ninstall folder\n\n\n-----\n\nJavaH.exe File Present in\ninstall folder\n\nJavaK.exe File Present in\ninstall folder\n\nJavaS.exe File Present in\ninstall folder\n\nJavaTM.exe File Present in\ninstall folder\n\nJavaUe.exe File Present in\ninstall folder\n\nJavaAlq.exe File Present in\ninstall folder\n\nUjavap.exe File Present in\ninstall folder\n\n## File Information\n\n**SHA256** **bf25b330975dc700be3f1f6b1b3362e34eb84b89725d4936d893cdd4f1499e69**\n\n**Type** Win32 EXE NullSoft SFX\n\n**Size** 4830 KB\n\n**Timestamp** 2008-08-16 20:26:10 (Time-stomped)\n\n**ITW names** Machete, Trojan/Spy.Python.Ragua\n\nAdam Martin\n\n## About Adam Martin\n\nThreat Researcher at BlackBerry Cylance\n\n\n-----\n\nAdam Martin is currently working as a Threat Researcher in Cork, Ireland, having graduated from\nCork Institute of Technology in summer 2019. Adam completed an internship with BlackBerry\nCylance in his third year of college and was lucky enough to be kept on afterwards!\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-27 - Threat Spotlight- Machete Info-Stealer.pdf"
    ],
    "report_names": [
        "2019-11-27 - Threat Spotlight- Machete Info-Stealer.pdf"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536084,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653752546,
    "ts_modification_date": 1653752546,
    "files": {
        "pdf": "https://archive.orkl.eu/3adc133bdd8b5a837436b3cd5003630b6b9c7633.pdf",
        "text": "https://archive.orkl.eu/3adc133bdd8b5a837436b3cd5003630b6b9c7633.txt",
        "img": "https://archive.orkl.eu/3adc133bdd8b5a837436b3cd5003630b6b9c7633.jpg"
    }
}