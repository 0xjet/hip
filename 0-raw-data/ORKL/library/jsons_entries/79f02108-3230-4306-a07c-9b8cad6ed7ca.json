{
    "id": "79f02108-3230-4306-a07c-9b8cad6ed7ca",
    "created_at": "2022-10-25T16:48:12.529051Z",
    "updated_at": "2025-03-27T02:05:38.050979Z",
    "deleted_at": null,
    "sha1_hash": "55c50d77a6fb747a80a98b0b10a03c1eec7183a5",
    "title": "CALIBRI 60PT BOLD CAPITALIZED LEFT",
    "authors": "",
    "file_creation_date": "2019-03-19T17:27:39Z",
    "file_modification_date": "2019-03-19T17:27:39Z",
    "file_size": 11647368,
    "plain_text": "## A Diet of Poisoned Fruit:\n#### Designing Implants & OT Payloads for ICS Embedded Devices\n\n###### Jos Wetzels, Marina Krotofil\n\n\n-----\n\n#### Marina Krotofil\n###### @marmusha\n\n • Senior Security Engineer\n\n • Specializing on offensive security\n of Critical Infrastructures\n\n • Focus: Physical Damage or how\n to make somethings go bad, crash or blow up by means of cyber-attacks\n\n\n-----\n\n#### Jos Wetzels\n###### @s4mvartaka\n\n • Principal Consultant &\n Security Researcher\n\n • Focus: Embedded Systems\n Security (ICS, Automotive,    IoT, …)\n\n • (previously) Security Researcher\n @ University of Twente on protection of critical\n\n\n-----\n\n### AGENDA\n\n###### 1. Introduction\n\n 2. Cyber-Physical Attack Lifecycle\n\n 3. Implants\n\n 4. OT Payloads\n\n 5. Conclusion\n\n\n-----\n\n### Here is a Plant. What is Your Plan?\n\n\n-----\n\n### Two Common View on Cyber-Physical Attacks\n\n##### • “Trivial! Look at the state of ICS\n security!”\n\n • “Borderline impossible! These\n\nhttps://image.shutterstock.com/image-illustration/six-nine-matter-perspectives260nw-1024980271.jpg\n\n##### processes are extremely complex & engineered for safety!”\n\n\nhttps://image.shutterstock.com/image-illustration/six-nine-matter-perspectives-\n260nw-1024980271.jpg\n\n\n-----\n\n### (does not exist!)\n\n\n-----\n\n### Attacks with Strategic and Long Lasting Effect\n\n###### • Attacks with strategic, lasting damage will be process specific\n & require good process comprehension\n\n • Wil require attacker to develop detailed ‘damage scenario’\n\n  What causes a pipeline to explode?  What causes the right pipeline to explode?\n  What causes the right pipeline to explode at the right\n moment?\n\n\n###### process specific\n\n ’\n\n right\n\n\n-----\n\n### Industrial Control Systems (ICS)\n\n###### Computer science\n (IT security)\n\n Engineering (OT security)\n\n Attacker Physical\n\n\n###### Computer science\n (IT security)\n\n Engineering (OT security)\n\n\n-----\n\n### IT Security vs. OT Security\n\n###### ICS security\n\n IT security OT security\n\n (cyber-security -> (causing impact on the\n taking over the operations -> process and\n infrastructure) equipment)\n Attack payload\n#### Marina & Jos\n\n\n-----\n\n### Industrial Plants Work on Control Loop\n\n###### Process\n\n### Concept\n\n\nD feed\n\n63.6\n\n63.4\n\n63.2\n\n63\n\n\nD Feed\n\n3750\n\n3700\n\n3650\n\n3600\n\n\n-----\n\n### Industrial Network Architecture\n\n\n###### Field\n\n\n-----\n\n### Physical Process and Control Equipment\n\nhttps://vecer.mk/files/article/2017/05/02/485749-saudiska-arabija-ja-kupi-najgolemata-naftena-rafinerija-vo-sad.jpg http://www.jfwhite.com/Collateral/Images/English-US/Galleries/middleboro9115kvbreakers.jpg https://www.roboticsbusinessreview.com/wp-content/uploads/2016/05/jaguar-factory.jpg\n\n\nhttps://www.roboticsbusinessreview.com/wp-content/uploads/2016/05/jaguar-factory.jpg\n\n\n-----\n\n### Physical Process and Control Equipment\n\n\nhttp://www.jfwhite.com/Collateral/Images/English-US/Galleries/middleboro9115kvbreakers.jpg https://www.roboticsbusinessreview.com/wp-content/uploads/2016/05/jaguar-factory.jpg\n\n\n#### PHYSICAL\n\n\n-----\n\n### Security vs. Safety\n\n###### Security incident\n\n Threats Hazards\n Time Incident\n\n Security infridgementsLayers of security Layers of safetySafety measures\n\n|Col1|Col2|Col3|Col4|Col5|Security incident|Col7|\n|---|---|---|---|---|---|---|\n||||||Incident||\n||||||||\n||||||||\n|Security infridgements Layers of security protections|||||||\n\n|Col1|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|Safety measures Layers of safety protections|||||\n\n\n###### Time\n\n\n-----\n\n### Hazards and Layers of Safety Protections\n\n\n-----\n\n### Designing Cyber-Physical Payload\n\n\n###### Evil Motivation\n\n\nhttps://cdn5.vectorstock.com/i/1000x1000/32/14/skulland-crossbones-with-binary-code-vector-20603214.jpg\n\n\n###### Cyber-physical\n Payload\n\nhttps://cdn5.vectorstock.com/i/1000x1000/32/14/skull-\nand-crossbones-with-binary-code-vector-20603214.jpg\n\n\n-----\n\n### AGENDA\n\n###### 1. Introduction\n\n 2. Cyber-Physical Attack Lifecycle\n\n 3. Implants\n\n 4. OT Payloads\n\n 5. Conclusion\n\n\n-----\n\n### Cyber-Physical Attack Development Lifecycle\n\n###### • If you know how attackers work, you can figure out\n how to stop them\n • Attack lifecycle is a common method to describe a\n process of conducting cyber attacks\n\n\n-----\n\n### Cyber-Physical Attack Development Lifecycle\n\n\n###### Obtaining\n Feedback\n\n\n###### Access Discovery Control Damage Cleanup\n\n\n###### Preventing\n Response\n\n Cleanup\n\n\n-----\n\n# How Does This Fit into Other Attack Frameworks?\n\n\n-----\n\n### Lockheed Martin, the Cyber Kill Chain®\n\n#### You are here\n\n\n-----\n\n### Mandiant Attack Lifecycle\n\n\n#### You are here\n\n\n-----\n\n### SANS Industrial Control System Cyber Kill Chain\n\n\n-----\n\n### ICS MITRE ATT&CK™\n\n###### Otis Alexander. Modeling Adversarial Behavior against ICS, S4’19\n\n**Persistence** **Privilege Escalation** **Defense Evasion** **Operator Evasion** **Credential Access** **Discovery** **Lateral Movement** **Execution** **Command and Control** **Disruption** **Destruction**\n\nValid Accounts Rootkit Network Sniffing Exploitation of Vulnerability Connection Proxy Module Firmware\n\nModule Firmware Exploitation of Vulnerability File Deletion Block Serial Comm Port Brute Force Device Information Default Credentials Scripting Commonly Used Port Spoof Command Message\n\nExternal Remote Service Modify Event Log Modify I/O Image Default Credentials Control Process Valid Accounts Graphical User Interface Block Command Message\n\nModify Control Logic Alternate Modes of Operation Modify Reporting Settings Exploitation of Vulnerability Role Identification External Remote Service Command-Line Interface Modify I/O Image\n\nModify System Settings Masquerading Modify Reporting Message Credential Dumping Location Identification Modify Control Logic Modify System Settings Exploitation of Vulnerability\n\nNetwork Connection\nMemory Residence Modify System Settings Block Reporting Message Man in the Middle Modify Reporting Settings\n\nEnumeration\n\nSystem Firmware Spoof Reporting Message Serial Connection Enumeration Alternate Modes of Operation Modify Reporting Message\n\nModify Tag I/O Module Enumeration Block Reporting Message\n\nModify Control Logic Remote System Discovery Spoof Reporting Message\n\nModify Physical Device Display Network Service Scanning Modify Tag\n\nModify HMI/Historian\n\nModify Control Logic\nReporting\n\nModify Parameter Device Shutdown\n\nModify Parameter\n\nSystem Firmware\n\nModify Command Message\n\nBlock Serial Comm Port\n\nModify System Settings\n\n###### We don’t know\n\nAlternate Modes of Operation\n\nMasquerading\n###### where we are in this model just yet )\n\n|Persistence|Privilege Escalation|Defense Evasion|Operator Evasion|Credential Access|Discovery|Lateral Movement|Execution|Command and Control|Disruption|Destruction|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Valid Accounts||Rootkit||Network Sniffing||Exploitation of Vulnerability||Connection Proxy|Module Firmware||\n|Module Firmware|Exploitation of Vulnerability|File Deletion|Block Serial Comm Port|Brute Force|Device Information|Default Credentials|Scripting|Commonly Used Port|Spoof Command Message||\n|External Remote Service||Modify Event Log|Modify I/O Image|Default Credentials|Control Process|Valid Accounts|Graphical User Interface||Block Command Message||\n|Modify Control Logic||Alternate Modes of Operation|Modify Reporting Settings|Exploitation of Vulnerability|Role Identification|External Remote Service|Command-Line Interface||Modify I/O Image||\n|Modify System Settings||Masquerading|Modify Reporting Message|Credential Dumping|Location Identification|Modify Control Logic|Modify System Settings||Exploitation of Vulnerability||\n|Memory Residence||Modify System Settings|Block Reporting Message||Network Connection Enumeration||Man in the Middle||Modify Reporting Settings||\n|System Firmware|||Spoof Reporting Message||Serial Connection Enumeration||Alternate Modes of Operation||Modify Reporting Message||\n||||Modify Tag||I/O Module Enumeration||||Block Reporting Message||\n||||Modify Control Logic||Remote System Discovery||||Spoof Reporting Message||\n||||Modify Physical Device Display||Network Service Scanning||||Modify Tag||\n||||Modify HMI/Historian Reporting||||||Modify Control Logic||\n||||Modify Parameter||||||Device Shutdown||\n||||||||||Modify Parameter||\n||||||||||System Firmware||\n||||||||||Modify Command Message||\n||||||||||Block Serial Comm Port||\n||||||||||Modify System Settings||\n||||||||||Alternate Modes of Operation||\n||||||||||Masquerading||\n\n\n###### Otis Alexander. Modeling Adversarial Behavior against ICS, S4’19\n\n**Command and Control** **Disruption** **Destruction**\n\nConnection Proxy Module Firmware\n\nCommonly Used Port Spoof Command Message\n\nBlock Command Message\n\nModify I/O Image\n\nExploitation of Vulnerability\n\nModify Reporting Settings\n\nModify Reporting Message\n\nBlock Reporting Message\n\nSpoof Reporting Message\n\nModify Tag\n\nModify Control Logic\n\nDevice Shutdown\n\nModify Parameter\n\nSystem Firmware\n\nModify Command Message\n\nBlock Serial Comm Port\n\nModify System Settings\n\nAlternate Modes of Operation\n\nMasquerading\n\n\n-----\n\n# Overview of Stages\n\n\n-----\n\n### Access\n\n###### • Target facility\n\n • Discovery\n • Access to needed assets\n • Attack execution\n • Trusted 3[rd] party (staging target)\n\n • Access to target facility\n • Access to needed assets\n • Process comprehension\n • Non-targeted/Opportunistic\n\n\n###### Access\n\n Target facility\n\n Trusted 3rd\n party\n\n\n-----\n\n### Targeting\n\n###### • There are few known cases of strategic targeting\n\n • Target might be also selected as best suitable\n certain criteria\n\n • Collateral victim\n\n • Opportunistic\n\n\n-----\n\n### Venezuela, 2019\n\n###### • Suspected cyber-attack on Guri hydroelectric power plant\n • Produces 80% of country’s electricity\n • Details of plant’s upgrade are publicly available, including\n possible remote access\n\n\n-----\n\n### Venezuela, 2019\n\n\n\n##### • Produces 80% of country’s electricity\n • Details of plant’s upgrade are publicly available,\n includible possible remote access\n\n\n-----\n\n### Ukraine, 2016\n\n###### • INDUSTROYER malware was deployed to shutdown electricity\n distribution at Pivnichna substation\n • There is no strong indications that victim substation was strategic\n target\n • Details of substation upgrade are publicly available\n\n\n-----\n\n###### • INDUSTROYER malware work was used to shutdown electricity\n distribution at Pivnichna substation\n • There is no strong indications that victim substation was strategic\n target\n • Details of substation upgrade are publicly available\n\n\n###### Details of substation upgrade are publicly available\n\n\n##### malware\n\nhttps://w3.siemens.com/smartgrid/global/en/products-systems-\nsolutions/protection/distance-protection/pages/7sa63.aspx\n\n\n-----\n\n### Saudi Arabia, 2017\n\n###### • TRITON malware targeted Safety Instrumented Systems at\n petrochemical plant\n • There is no strong indication that TRITON victim was\n strategic target\n • Affected site could have been used as live drill and testing\n platform before attacking strategic target\n\n\n-----\n\n### Saudi Arabia, 2017\n\n\n\n###### • There is no strong indication that TRITON victim was\n strategic target\n • Affected site could have been used as live drill and testing\n platform before attacking strategic target\n\n\n-----\n\n### Role of OSINT in Targeting\n\n###### • The Internet is full of proprietary and confidential\n\n\n###### industrial documentation.\n • Discovering helpful information about certain\n industrial facility may provoke targeting\n\n\n-----\n\n### Role of OSINT in Targeting\n\n\n###### The Internet is full of proprietary and confidential\n industrial documentation.  Discovering helpful information about certain\n industrial facility may provoke targeting\n\n\n\n###### • The Internet is full of proprietary and confidential\n industrial documentation.\n • Discovering helpful information about certain\n industrial facility may provoke targeting\n\n\n###### The Internet is full of proprietary and confidential\n industrial documentation.  Discovering helpful information about certain\n industrial facility may provoke targeting\n\n\n\n###### • The Internet is full of proprietary and confidential\n industrial documentation.\n • Discovering helpful information about certain\n industrial facility may provoke targeting\n\n\n-----\n\n### Targeting 3[rd] parties (supply chain)\n\n###### • Getting access to into target facilities\n\n • Getting access to needed assets/equipment,\n E.g. through maintenance support contracts\n\n • Obtaining information related to target or\n potential victims\n Engineering/networking/config documentation User application (control logic), etc.\n\n\n-----\n\n|National Advisories on the Threat|Col2|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n\n\n###### https://www.ncsc.gov.uk/news/ho stile-state-actors-compromising\n\n-----\n\n|National Advisories on the Threat|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n||||||\n||||||\n||||||\n||||||\n||||||\n\n\n###### https://www.us-cert.gov/ncas/alerts/TA18-074A\n\n\n###### https://www.ncsc.gov.uk/news/ho stile-state-actors-compromising\n\n###### https://www.us-cert.gov/ncas/alerts/TA18-074A\n\n\n###### stile-state-actors-compromising-\n\n\n-----\n\n### Data Exposure is Penalizable in Regulated Facilities\n\n###### • NERC CIP-003-3 standard\n • Sensitive utility’s network\n infrastructure data were exposed via server of third- party service provider\n\n\n-----\n\n### Role of Access Stage\n\n###### • Access stage largely defines the selection\n of damage scenario\n\n • Access driven\n E.g., obtained access to specific equipment\n via 3[rd] party remote maintenance contract Did not manage to access Safety Systems\n\n • Information driven\n E.g., obtained specific information about\n unhealthy state or repairs of equipment\n\n\n-----\n\n### Discovery\n\n###### • Network reconnaissance\n\n • Majority of this stage is similar to traditional IT\n recon process/attack life cycle, tools may differ\n • Information enumeration\n • Process comprehension\n\n • Understanding exactly what the process is doing,\n how it is built, configured and programmed\n\n\n###### Discovery\n\n Network Infrastructure Reconnaissance\n\n Process Comprehension\n\n\n-----\n\n### Discovery\n\n\n###### Discovery\n\n Network Infrastructure Reconnaissance\n\n Process Comprehension\n\n\n-----\n\n-----\n\n# Case Study: Water Treatment Plant\n\n\n-----\n\n### Use Case: Killing UF Filter in Water Treatment Facility\n\n###### Acknowledgement: Sridhar Adepu and Prof. Aditya Mathur, SUTD, Singapore for conducting an experiment for this talk\n\n\n###### https://itrust.sutd.edu.sg/testbeds/secure-water-treatment-swat/\n\n\n-----\n\n### Use Case: Killing UF Filter in Water Treatment Facility\n\n###### • Water treatment process consists of multiple stages, including\n several stages of filtering\n\n • Water filters are expensive\n • When broken, water supply is interrupted\n\n\n-----\n\n### UF Filtering: HMI Screen\n\n\n-----\n\n### UF Filtering: PI&D Diagram\n\n\n-----\n\n### UF Backwash: HMI and PI&D Diagram\n\n\n-----\n\n### How Do We Pull This off?\n\n###### • There are tree conditions which can trigger backwash\n process, each guided by a state machine\n\n • Preset timer (every 30 minutes)\n • UF filter differential pressure (DP) ≥ 40 kPa\n • Plant shutdown\n\n\n-----\n\n### How Do We Pull This off?\n\n###### • There are tree conditions which can trigger backwash process,\n each guided by a state machine\n\n • Preset timer (every 30 minutes)\n • UF filter differential pressure (DP) ≥ 40 kPa\n • Plant shutdown\n\n\n###### There are tree conditions which can trigger backwash process,\n\n\n-----\n\n### How Do We Pull This off?\n\n\n\n###### • UF filter differential pressure (DP) ≥ 40 kPa\n • Plant shutdown\n\n\n-----\n\n### One Possible Attack Execution Scenario\n\n|Stage 6|PLC6|Col3|\n|---|---|---|\n||||\n||||\n\n\n###### Pressure in UF membrane will increase. HOW MUCH?\n\n\n-----\n\n### Control Stage of Process Comprehension\n\n###### • Average UF filter DP is ≈ 12-13 kPa\n • Max DP is 98 kPa, reached in 8 sec\n • Process recovery (return to normal) is 5 sec\n • Note, this data still does not tell us whether this pressure kills\n the UF filter and how quickly\n\n\n-----\n\n### Control Stage of Process Comprehension\n\n###### • Average UF filter DP is ≈ 12-13 kPa\n • Max DP is 98 kPa, reached in 8 sec\n • Process recovery (return to normal) is 5 sec\n • Note, this data still does not tell us whether this pressure kills\n the UF filter and how quickly\n\n\n###### Note, this data still does not tell us whether this pressure kills\n\n\n-----\n\n### Damage\n\n###### • Requires subject-matter knowledge\n (engineering)\n • Cant take several forms\n\n • Explosions (of course!)\n • Equipment breakage\n • Pollution\n • Product Out of Specification\n • Increased production costs, etc.\n\n\nhttps://img.izismile.com/img/img5/20120306/640/chemical_plant_accident_in_germany_640_04.jpg\n\n\n###### Obtaining\n Feedback\n\n\nhttps://img.izismile.com/img/img5/20120306/640/chemical_plant_accident_in_germany_640_04.jpg\n\n###### Preventing\n Response\n\n\n###### Damage\n\n\n-----\n\n### Attack Design != Implementation Success\n\n###### FIT401 Spoofed value\n PLC5\n Attckr\n PLC4\n Reverse Osmosis\n 1.1 UV401 filtering OFF\n 1.1 FIT401 Spoofing to 0.4\n Attckr 2.1 AIT502\n LIT401\n Spoof to Low\n\n Flow meter ORP meter\n Tank Pump\n FIT401 AIT502\n T401 P401 De-Chlorinator\n UV401\n\n\n###### PLC5\n\n Reverse Osmosis filtering\n\n 2.1 AIT502 Spoof to Low\n\n ORP meter\n AIT502\n\n\n-----\n\n### Cleanup\n\n###### • In traditional hacking it is possible to execute the\n entire attack without being ever detected\n\n • In process control it is not an option because of\n physical effect\n\n • Create forensic footprint of what the investigators\n should identify as cause of the incident/accident\n E.g. time attack to process troubleshooting\n\n\n-----\n\n# Why Implant?\n\n\n-----\n\n## Implant\n\n “Hardware or software modification designed to gain unauthorized control\n over specific system functionality.”\n\n\n## ”\n\n\n-----\n\n## OT Payload\n\n “Digital implementation of (part of) a\n cyber-physical attack”\n\n\n-----\n\n### Why Implant\n\n###### • Why not just modify control logic / change setpoints / send malicious command?\n\n • For more complicated attacks\n\n • Coordination, Feedback, Speed, Low-level functionality access\n\n • Many scenarios possible without implants\n\n • Eg. Ukraine 2015 & 2016\n\n\n-----\n\n# Where to Implant?\n\n\n-----\n\n### Where to Implant?\n\n\n### Where to Implant?\n\n\n-----\n\n### Network Equipment\n\n###### Manipulating OT traffic\n\n Observing & learning OT traffic\n\n\n### Network Equipment\n\n###### Dropping traffic to cause loss of\n Manipulating\n control / view by\n OT traffic\n suppressing alarm or signal\n\n\n-----\n\n### Process & Safety Controllers\n\n###### Measure attack progress\n\n Manipulate IO\n\n\n###### Suppress condition monitoring alerts\n Measure attack progress Prevent Safety\n Response\n\n\n-----\n\n### Field Devices\n\n###### Spoofing sensor data at high speed\n\n\n###### Overriding digital safety mechanisms\n\n\n-----\n\n# How to Implant?\n\n\n-----\n\n### We want smooth native code execution\n\n##### • Need access to low-level, privileged functionality\n\n###### • Memory-/Port-Mapped IO (MMIO/PMIO)\n • Kernel memory objects\n • Logic runtime memory\n • Persistence mechanisms\n\n##### • Ideally via silent hot-patching\n\n###### • No reboots, no service restarts, no process upsets\n\n\n-----\n\n### Implant Delivery Vectors\n\n\n-----\n\n### PLC 101 - Architecture\n\n#### Modular Standalone\n###### Power Supply, CPU, I/O, Comms, …\n\n\n-----\n\n### PLC 101 - Backplane\n\n#### Inter-Module Databus\n###### Multibus, P-Bus, VMEbus, X-Bus, STD-32, PCIe, …\n\n\n-----\n\n### PLC 101 – CPU Module Internals\n\n\n-----\n\n### PLC 101 – Boot Sequence\n\n\n-----\n\n### PLC 101 – Logic Program Execution\n\n\n-----\n\n### PLC 101 - Scan Cycle\n\n\n-----\n\n### Implant Access\n\n\n-----\n\n### Implant Installation\n\n###### Escalate Disable Relocate Ensure\n Set Hooks Go Resident\n Privileges* Diagnostics Implant Persistence*\n\n Implant stability Eg. modify firmware or stored logic in flash\n\n\n###### Set Hooks Go Resident\n\n\n-----\n\n### Implant Design Considerations\n\n\n###### Active Implant\n\n\n###### Dormant\n Implant\n\n\n###### Persistence\n\n\n\n###### • Includes OT\n payload\n\n • Limits\n detection / network forensics exposure\n\n\n\n###### • OT payload\n delivered later\n\n • Limits\n forensics exposure\n\n\n\n###### • Complicated\n by code signing\n\n • Need ability\n write to flash & enough space\n\n\n###### Memory Residence\n\n • No reboot\n survival\n\n • Limits\n forensics exposure\n\n\n-----\n\n### We want scalability\n\n###### • Target different vendors’ systems\n with similar implant functionality\n\n • But limited number of players out\n there\n\n • Eg. construct arsenal of generic\n templates for key DCS & safety controllers\n\n • One time upfront investment no\n\n\n-----\n\n### Complication: Heterogeneity\n\n###### Processor OS Runtime\n\n IO Memory Security\n\n\n###### Runtime\n\n\n-----\n\n### Complication: In-House vs Commercial\n\n\n###### Proprietary Runtime\n\n\n-----\n\n### Example: Triconex SIS\n\n###### • In-House OS + Runtime, different processors & OS variants\n between versions of same product\n\n\n###### Triconex MP 9 (3006)\n\n\n###### Triconex MP 10 (3008)\n\n\n###### Triconex MP 11 (3009)\n\n\n###### Triconex MP\n\n\n-----\n\n### Counter-Example: Rise of Commercial RTOSes & Runtimes\n\n\n-----\n\n### Complication: Resource Constraints\n\n\n\n###### • MPC860, 50 MHz\n • 6 MB Flash\n • 16 MB DRAM\n • 32 KB SRAM\n\n\n### You better enjoy\n\n\n###### Will need to fit implant in there\n\n • Signals processing? Malicious\n logic? Comms? Often stretched by normal\n\n\n\n###### •\n •\n •\n •\n\n\n###### functionality already\n\n\n### programming…\n\n###### • ARM9, 14 MHz\n\n • 512 KB Boot Flash\n\n • 8 MB RW Flash\n\n\n-----\n\n### Complication: Security Engineering\n\n###### Domain &\n Firmware & Logic\n Privilege Sandboxing\n Signing\n Separation\n\n Exploit Programming\n\n\n-----\n\n# Case Study: TRITON\n\n\n-----\n\n### TRITON / Trisis / HatMan (2017)\n\n\n-----\n\n### TRITON Attack Overview\n\n\n-----\n\n### TRITON injects ‘dormant’ implant into Triconex controller memory “Your wish is\n\n\n###### “Your wish is my command”\n\n\n-----\n\n### Why not just modify firmware?\n\n###### Firmware Download (FC 0x50: unauthenticated, unsigned)\n\n Controller reboots into download mode,\n logic execution interrupted!\n\n Logic Append (FC 0x01: unauthenticated, unsigned)\n\n New logic appended to circular linked\n\n\n###### Controller reboots into download mode,\n logic execution interrupted!\n\n\n###### Logic Append (FC 0x01: unauthenticated, unsigned)\n\n\n-----\n\n### Implant Installation\n\n###### • Safety program executed\n in user mode\n\n • Need supervisor to flush\n icache & apply mods\n\n • Privilege level set in PPC\n MSR register, NW for user\n\n R i S i P i il\n\n\n-----\n\n### Stage 2: Privilege Escalation\n\n###### • Exploit syscall 0x13 (SOE Status) to modify MSR\n while in supervisor mode, set saved MSR bit\n\n • No memory permissions, can write anywhere in\n user mode, including kernel globals. Exploit write-what-where.\n\n Escalate Disable Relocate Ensure\n Set Hooks Go Resident\n Privileges* Diagnostics Implant Persistence*\n\n\n###### Set Hooks Go Resident\n\n\n-----\n\n### Stage 2: Disable RAM Check\n\n\n###### Originally conditional branch\n\n\n-----\n\n### Stage 2: Relocate Implant\n\n###### Ensures Residence Even with full logic wipe\n\n Escalate Disable Relocate Ensure\n Set Hooks Go Resident\n Privileges* Diagnostics Implant Persistence*\n\n\n-----\n\n### Stage 2: Modify Network Command Handler\n\n###### • Entry 0x1D (Get MP Status)\n\n • Allows for network comms\n\n|Disable Diagnostics|Relocate Implant|\n|---|---|\n\n\n###### Set Hooks Go Resident\n\n\n-----\n\n### Stage 3: Implant\n\n\n-----\n\n### Stage 3: Implant\n\n\n-----\n\n### Stage 4: OT Payload\n\n##### • Once implant is injected we have dormant ‘god mode’\n\n###### • Arbitrary supervisor RWX over network\n\n##### • Deliver OT payload at later moment\n\n • Not recovered from incident, but we can speculate …\n\n\n-----\n\n### AGENDA\n\n###### 1. Introduction\n\n 2. Cyber-Physical Attack Lifecycle\n\n 3. Implants\n\n 4. OT Payloads\n\n 5. Conclusion\n\n\n-----\n\n### Damage Stage\n\n###### 1\n\n Manipulate the\n process\n\n Direct Indirect\n\n Manipulation\n Deceive controller/ of actuators operator about process state (e.g. spoof sensor)\n\n\n###### 3\n\n\n###### 1\n\n\n###### Modify operational /\n safety limits\n\n\n###### 1\n\n\n###### process\n state\n\n\n###### 2\n Prevent response\n\n Control / Safety System\n\n Modify Blind about operational / process\n\n\n-----\n\n# I/O Manipulation\n\n\n-----\n\n### I/O Manipulation\n\n##### • Simple concept, non-trivial execution\n\n • Many different approaches\n\n###### • Depends on how IO image tables are populated, how IO is\n wired to chip executing logic\n\n • Different technical ways to achieve same goal\n\n\n-----\n\n###### • Memory Breakpoint\n • Patch Instructions\n • Change Memory Permissions\n\n\n### I/O Manipulation\n\n###### Change Memory Permissions\n\n\n-----\n\n### I/O Manipulation\n\n\n###### Hook bus handler routines\n\n\n-----\n\n### Complication: Field Device Limitations\n\n###### • Cyber limitations might be placed on theoretically feasible\n functionality for protective reasons*\n\n • Valve closing speed\n • Non-digitally alterable VFD skip frequences\n\n • Prevents IO manipulation from achieving desired result\n\n • Overcoming this requires implanting field device\n • Patch out limitations / sanity checks\n\n\n-----\n\n# Alarm Suppression\n\n\n-----\n\n### Alarm Suppression\n\n##### • Again: simple concept, non-trivial execution\n\n###### • We want to prevent an outgoing alarm being raised or\n incoming alarm being acted upon\n\n##### • Might require very different approaches\n\n###### • Alarm raised with dedicated protocol message\n • Alarm signal via IO\n • Alarm bit in flag accompanying read PV\n\n\n-----\n\n### Alarm Propagation\n\n\n###### Goal: catalyst\n deactivation\n\n Alarm\n\n Safety\n Alarm\n shutdown\n\n\n-----\n\n### Hiding Alarms\n\n\n-----\n\n### Suppressing Alarms\n\n\n### Suppressing Alarms\n\n\n-----\n\n### Example: Simple water tank level alarm\n\n###### Safety program resides in memory as code modify\n\n\n-----\n\n### Finding Instructions to Patch\n\n\n-----\n\n### Hot-Patching Safety Program\n\n\n-----\n\n### Alarm Suppression\n\n\n-----\n\n# Alarm Relaxation & Tightening\n\n\n-----\n\n### Why relax or tighten instead of suppress?\n\n##### • Don’t prevent alarm from being raised but change\n conditions\n\n###### • Limits, deadband, priority\n\n##### • Relax: Stealth during scheduled testing\n\n • Tighten: Cause hard-to-resolve alarm storms\n\n\n-----\n\n### Hook functionality that decides whether to raise alarm\n\n##### • Can be data (limit, priority, deadband): overwrite in RAM\n\n###### • Make sure to spoof values when queried!\n\n##### • Or code (alarm logic): patch instructions\n\n\n-----\n\n# Implant Communication\n\n\n-----\n\n###### moisture, …\n\n\n-----\n\n### Expectation vs Reality\n\n###### Might not see much electronic\n\n\n###### These can be in completely different parts of the process,\n on different networks\n\n\n-----\n\n### Process state change detection\n\n###### Non-Parametric Cumulative Sum (NCUSUM)\n\n\n-----\n\n### AGENDA\n\n###### 1. Introduction\n\n 2. Cyber-Physical Attack Lifecycle\n\n 3. Implants\n\n 4. OT Payloads\n\n 5. Conclusion\n\n\n-----\n\n### Conclusion\n\n#### Marina Jos\n\n\n###### tion\n\n\n###### tion\n\n\n###### tion\n\n\n#### Jos\n\n###### Attack Integration\n & Testing\n\n\n-----\n\n### Appreciation\n\n##### • Sridhar Adepu & Prof. Aditya Mathur\n\n • Jason Larsen\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://troopers.de/downloads/troopers19/TROOPERS19_NGI_IoT_diet_poisoned_fruit.pdf"
    ],
    "report_names": [
        "TROOPERS19_NGI_IoT_diet_poisoned_fruit.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1553016459,
    "ts_modification_date": 1553016459,
    "files": {
        "pdf": "https://archive.orkl.eu/55c50d77a6fb747a80a98b0b10a03c1eec7183a5.pdf",
        "text": "https://archive.orkl.eu/55c50d77a6fb747a80a98b0b10a03c1eec7183a5.txt",
        "img": "https://archive.orkl.eu/55c50d77a6fb747a80a98b0b10a03c1eec7183a5.jpg"
    }
}