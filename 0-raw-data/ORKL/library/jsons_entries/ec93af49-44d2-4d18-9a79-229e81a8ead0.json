{
    "id": "ec93af49-44d2-4d18-9a79-229e81a8ead0",
    "created_at": "2023-01-12T14:59:33.236534Z",
    "updated_at": "2025-03-27T02:06:11.141612Z",
    "deleted_at": null,
    "sha1_hash": "8ebd45f2a272d5b0ce1c16e52138d2c13bc2006c",
    "title": "2022-01-20 - Fallout from Log4Shell-related Vietnamese Cryptocurrency Exchange Attack- KYC Data for Sale on Dark Web",
    "authors": "",
    "file_creation_date": "2022-05-28T19:19:58Z",
    "file_modification_date": "2022-05-28T19:19:58Z",
    "file_size": 2545007,
    "plain_text": "# Fallout from Log4Shell-related Vietnamese Cryptocurrency Exchange Attack: KYC Data for Sale on Dark Web\n\n**cadosecurity.com/fallout-from-log4shell-related-vietnamese-cryptocurrency-exchange-attack-kyc-data-for-sale-on-dark-**\nweb\n\nJanuary 20, 2022\n\nBlog\n\nJanuary 20, 2022\n\n**Introduction**\n\nSince its discovery at the end of 2021, Log4Shell – a zero-day vulnerability affecting\nApache’s Log4j logging library – has been actively exploited to infect vulnerable hosts with\n[malware. We previously reported on a novel strain of ransomware, named Khonsari, that](https://www.cadosecurity.com/analysis-of-novel-khonsari-ransomware-deployed-by-the-log4shell-vulnerability/)\ntargeted Windows Servers vulnerable to Log4Shell.\n\nIn this report we’ll look at a published account of the compromise of a Vietnamese\n[cryptocurrency exchange, named Onus, where the attackers exploited the Log4Shell](https://goonus.io/)\nvulnerability to steal customer data and advertise it for sale on a popular hacking forum.\n\n\n-----\n\nSpecifically, we discovered a user offering a 9 TB database of information, including\nextremely valuable Know Your Customer (KYC) images and video, along with names, phone\nnumbers and email addresses.\n\n**Know Your Customer (KYC)**\n\nKnow Your Customer (KYC) refers to a set of guidelines for financial institutions and\ndecentralized finance (DeFi) services alike to combat money laundering and other fraudulent\nactivities. Generally, KYC involves identifying a customer through a formal identification\nprocedure. Copies of official state-issued identification, such as passports or driving licences,\nare typically requested by the financial institution when a customer applies for a financial\nproduct. Examples of such products include personal loans and credit cards.\n\nNaturally, this data is extremely valuable to hackers, as it allows them to impersonate\nanother individual when making an application for a financial product. The funds raised from\nthis could then be used to finance other criminal endeavours. Since this information is\nintended to reliably identify an individual, it could also be used in more targeted attacks. An\nattacker could suspect that an individual is likely to use Onus, find their KYC data in the\nleaked database and leverage that to conduct spear-phishing and other social engineering\nattacks.\n\n**Attack Overview**\n\n[We first learned about the attack on Onus via a report published by CyStack – Onus’ security](https://cystack.net/research/the-attack-on-onus-a-real-life-case-of-the-log4shell-vulnerability)\npartner – in late December 2021.\n\n[According to the report, Onus had deployed payment software developed by Cyclos, which](https://www.cyclos.org/)\ncontained a version of Log4j vulnerable to Log4Shell. Despite following advice to patch the\nvulnerability shortly after it had been disclosed, attackers still managed to exploit the\nLog4Shell vulnerability before a patch was issued. They then used shell commands to\nretrieve AWS credentials which, in turn, allowed them to compromise and subsequently\ndelete the contents of S3 buckets containing customer data.This resulted in a leak of\npersonal data from some 2 million Onus customers, including eKnow Your Customer\ninformation (eKYC) and password hashes.\n\nDue to the nature of cryptocurrency exchanges, owners often have to collect highly-sensitive\ninformation from their customers in order to comply with regulatory requirements. This\ninformation typically includes passport scans and even photographs of the customers\nthemselves which, as we’ll demonstrate, is highly sought after in underground marketplaces.\n\n**Analysis of Malicious Payload**\n\n[As Cystack reported, a file named kworker(masquerading as a legitimate Linux process) was](https://www.virustotal.com/gui/file/d9e6eaeaacb3feb6e32482301f918f19727466e13bc0bef5323a1c86f42a8ca2/detection)\ninstalled on the vulnerable host. This payload served as a backdoor to the host, allowing the\nattackers to establish Command and Control (C2) communication and exfiltrate the customer\n\n\n-----\n\ndata. The file was uploaded to VirusTotal on December 26, 2021 by a user in Vietnam and, at\nthe time of writing, has few detections.\n\nWe downloaded and analysed this payload and our findings are largely the same as\nCyStack’s. The capabilities of this malware are covered in their original report but to\nsummarise:\n\nAfter execution, the malware creates an SSH connection to the host\n45[.]147[.]230[.]219 over port 81. A username of “peter” and a password of “kim” is\nused for authentication.\nA SOCKS connection is also created as a backup in the event that SSH is unavailable.\nThe same credentials are used.\nStdout and stderr of the compromised machine is relayed back to the C2 server and\ncommands are received by the compromised host.\n\n\n-----\n\n_C Pseudocode of the malware’s main() function_\n**Stolen Data from AWS S3 Buckets for Sale**\n\nAfter hearing about the attack on Onus, researchers from Cado Security searched through\npopular hacking forums to see if evidence of data stolen in this attack could be found.\n\nOn one such forum, we found a user named blackblock1234 advertising a 9 TB (!) database\nof data stolen from a Vietnamese cryptocurrency exchange. The user mentions that the\ndataset includes names, phone numbers, and email addresses, along with eKYC\n\n\n-----\n\ndocumentation such as images and videos. The source code of the exchange itself is also\nsaid to be included.\n\n_Post advertising 9TB of Vietnamese Crypto Exchange data on RAIDforums_\n\nAnother user named vndcio started a similar thread in RAIDforum’s Leaks Market subforum.\nUnfortunately, a cached version of the original post could not be retrieved. However, we can\nsee the content of the original post quoted in a subsequent reply.\n\n_Quoted reply to vndcio’s original post_\n\n\n-----\n\nAs can be seen from the above, the vndcio user advertises similar data and provides a\nscreenshot where the directory structure of the leaked files is shown.\n\nSubsequent posts demonstrate the interest that this leak generated, with several users\nrequesting pricing information.\n\n_Pricing request for vndcio leak_\n\n_Additional pricing requests_\n\nAt the time of writing, the only threads posted by both the blackblock1234 and vndcio users\nwere the ones advertising this data leak. Both users joined RAIDforums at the end of\nDecember 2021 just prior to the release of CyStack’s report This suggests that the accounts\n\n\n-----\n\nwere created solely to advertise the data stolen in this particular attack.\n\n**Recommendations**\n\nGiven that this attack relied on the presence of Log4Shell in the target environment, the\nprimary recommendation would be to upgrade Log4j to version 2.3.1, which includes a\nsecurity fix for this vulnerability.\n\nAdmins should also review permissions for AWS resources in their organisation. In this case,\nthe attackers were able to easily pivot to S3 buckets after exploiting Log4Shell due to the\n_AmazonS3FullAccess permission having been granted to a compromised access key. This_\npermission should be used sparingly and the principle of least privilege applied.\n\nMonitoring of AWS infrastructure should also be established, with system logs from cloud\nresources forwarded to a SIEM with automated alerting in place. The SIEM should alert\nadmins to any unexpected access to S3 buckets from web-facing infrastructure, providing an\nadditional layer of security on top of access token permissions. Similarly, outbound\nconnections from AWS resources should be monitored for connections to unknown IP\naddresses, with domain/IP whitelisting established as necessary.\n\nSince this attack depended on the execution of malware served via exploitation of Log4Shell,\na final recommendation would be to enable application whitelisting on cloud servers. This\n[can be achieved using SELinux on Linux servers and is an effective mitigation against](http://selinuxproject.org/page/Main_Page)\nmalware attacks, as the malware itself is prevented from executing.\n\n**Indicators of Compromise**\n\n**Filename** **SHA256**\n\nkworker d9e6eaeaacb3feb6e32482301f918f19727466e13bc0bef5323a1c86f42a8ca2\n\n**IP Address**\n\n45[.]147[.]230[.]219\n\nFor tips and best practices for performing cloud incident response investigations, check out\nour playbooks:\n\n**About Cado Security**\n\nCado Security provides the cloud investigation platform that empowers security teams to\nrespond to threats at cloud speed. By automating data capture and processing across cloud\nand container environments, Cado Response effortlessly delivers forensic-level detail and\nunprecedented context to simplify cloud investigation and response. Backed by Blossom\n\n\n-----\n\nCapital and Ten Eleven Ventures, Cado Security has offices in the United States and United\n[Kingdom. For more information, please visit https://www.cadosecurity.com/ or follow us on](https://www.cadosecurity.com/)\nTwitter [@cadosecurity.](https://twitter.com/CadoSecurity)\n\n[Prev Post](https://www.cadosecurity.com/technical-indicators-of-ukrainian-website-defacements/) [Next Post](https://www.cadosecurity.com/grace-cassy-joins-the-cado-security-board-of-advisors/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-20 - Fallout from Log4Shell-related Vietnamese Cryptocurrency Exchange Attack- KYC Data for Sale on Dark Web.pdf"
    ],
    "report_names": [
        "2022-01-20 - Fallout from Log4Shell-related Vietnamese Cryptocurrency Exchange Attack- KYC Data for Sale on Dark Web.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535573,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1653765598,
    "ts_modification_date": 1653765598,
    "files": {
        "pdf": "https://archive.orkl.eu/8ebd45f2a272d5b0ce1c16e52138d2c13bc2006c.pdf",
        "text": "https://archive.orkl.eu/8ebd45f2a272d5b0ce1c16e52138d2c13bc2006c.txt",
        "img": "https://archive.orkl.eu/8ebd45f2a272d5b0ce1c16e52138d2c13bc2006c.jpg"
    }
}