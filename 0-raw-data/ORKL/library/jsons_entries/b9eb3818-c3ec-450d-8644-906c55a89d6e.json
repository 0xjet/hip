{
    "id": "b9eb3818-c3ec-450d-8644-906c55a89d6e",
    "created_at": "2023-01-12T15:05:08.203096Z",
    "updated_at": "2025-03-27T02:16:59.153078Z",
    "deleted_at": null,
    "sha1_hash": "842935ee4e8380c6c6a929875a134056c7eaf271",
    "title": "2017-05-09 - Persirai- New Internet of Things (IoT) Botnet Targets IP Cameras",
    "authors": "",
    "file_creation_date": "2022-05-29T01:38:23Z",
    "file_modification_date": "2022-05-29T01:38:23Z",
    "file_size": 138874,
    "plain_text": "# Persirai: New IoT Botnet Targets IP Cameras\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/persirai-new-internet-things-iot-botnet-targets-ip-cameras/](http://blog.trendmicro.com/trendlabs-security-intelligence/persirai-new-internet-things-iot-botnet-targets-ip-cameras/)**\n\nMay 9, 2017\n\nCyber Threats\n\nA new IoT botnet called Persirai has been discovered targeting over 1,000 IP Camera\nmodels based on various Original Equipment Manufacturer (OEM) products.\n\nBy: Tim Yeh, Dove Chiu, Kenney Lu May 09, 2017 Read time: ( words)\n\n_Updated on May 10, 2017, 6:52 PM (UTC-7): We updated the source code and made_\n_changes to Figures 4 and 6._\n\nA new Internet of Things (IoT) botnet called Persirai (Detected by Trend Micro\nas [ELF_PERSIRAI.A) has been discovered targeting over 1,000 Internet Protocol (IP)](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ELF_PERSIRAI.A)\nCamera models based on various Original Equipment Manufacturer (OEM) products. This\ndevelopment comes on the heels of Mirai—an open-source backdoor malware that caused\nsome of the most notable incidents of 2016 via Distributed Denial-of-Service (DDoS) attacks\nthat [compromised IoT devices such as Digital Video Recorders (DVRs) and CCTV cameras](http://blog.trendmicro.com/trendlabs-security-intelligence/mirai-widens-distribution-new-trojan-scans-ports/)\n—as well as the Hajime botnet.\n\nWe detected approximately 120,000 IP cameras that are vulnerable to ELF_PERSIRAI.A via\n[Shodan. Many of these vulnerable users are unaware that their IP Cameras are exposed to](https://www.shodan.io/)\nthe internet.\n\n\n-----\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/04/persirai-map-01-1-1024x655.jpg)\n\n_Figure 1: The number of vulnerable IP Cameras as of April 26, 2017 (derived from Shodan_\n_data)_\n\nThis makes it significantly easier for the perpetrators behind the malware to gain access to\nthe IP Camera web interface via TCP Port 81.\n\n**Behavior and Analysis**\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/04/figure-1-01-1024x699.jpg)\n\n_Figure 2: Infection Flow of ELF_PERSIRAI.A_\n\nIP Cameras typically use Universal Plug and Play (UPnP), which are network protocols that\nallow devices to open a port on the router and act like a server, making them highly visible\ntargets for IoT malware.\n\nAfter logging into the vulnerable interface, the attacker can perform a command injection to\nforce the IP Camera to connect to a download site via the following command:\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/05/persirai-source-code-2.jpg)\n\nThe download site will then respond with the following commands:\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/05/persirai-source-code-1.jpg)\n\nThese commands will download and execute malicious shell script from the domain\n_ntp.gtpnet.ir T_\n\nhe wificam.sh will download and execute the following samples, which will be deleted after\nexecution:\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/05/persirai-source-code.jpg)\n\nAfter the samples are downloaded and executed, the malware deletes itself and will only run\nin memory. It will also block the zero-day exploit by pointing ftpupdate.sh and ftpupload.sh to\n/dev/null to prevent other attackers from targeting the victim’s IP Camera. However, once the\ncamera is rebooted, it will again be vulnerable to the exploit.\n\nThe affected IP Camera will report to the C&C servers:\n\nload[.]gtpnet[.]ir\nntp[.]gtpnet[.]ir\n185[.]62[.]189[.]232\n95[.]85[.]38[.]103\n\n\n-----\n\nAfter receiving commands from the server, the IP Camera will then start automatically\n[attacking other IP Cameras by exploiting a zero-day vulnerability that was made public a few](https://pierrekim.github.io/blog/2017-03-08-camera-goahead-0day.html)\nmonths ago. Attackers exploiting this vulnerability will be able to get the password file from\nthe user, providing them the means to do command injections regardless of password\nstrength.\n\nA sample of the payload is shown below:\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/04/persirai-sample-payload.jpg)\n\n_Figure 3: ELF_PERSIRAI.A sample payload_\n\nThe IP Camera will then receive a command from the C&C server, instructing it to perform a\nDDoS attack on other computers via User Datagram Protocol (UDP) floods. Notably, Persirai\ncan perform User Datagram Protocol (UDP) DDoS attack with SSDP packets without\nspoofing IP address.\n\nThe backdoor protocol can be seen below:\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/05/persirai-protocol.jpg)\n\n_Figure 4: C&C server backdoor protocol_\n\nThe red portions indicate communication from C&C server to the victim’s IP camera. It\ncontains the attack commands and DDoS target IP and port.\n\n[Figure 5](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/08/figure5_persirai.jpg)\n\n_Figure 5: Special characters used by Persirai_\n\nC&C servers we discovered were found to be using the IR country code. We also found\nsome special Persian characters which the malware author used.\n\nThe IP Camera manufacturer for the sample we used claimed that the latest firmware\naddressed the vulnerability, so we tried updating the firmware of the IP Camera. However,\nthe firmware indicates that it is already using the latest version.\n\n[Figure 1](http://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/05/persirai-update.jpg)\n\n_Figure 6: IP Camera firmware_\n\n**Conclusion and Mitigation**\n\nAside from being the first malware that brought IoT security into the limelight, we also noted\nhow Mirai’s open-source nature gave it the potential to act as the core template upon which\nfuture IoT-centric malware will be built upon.\n\n\n-----\n\nAs the Internet of Things gains traction with ordinary users, cybercriminals may choose to\nmove away from Network Time Protocol (NTP) and Domain Name System (DNS) servers for\nDDoS attacks, instead concentrating on vulnerable devices—an issue compounded by users\nthat practice lax security measures.\n\nA large number of these attacks were caused by the use of the default password in the\ndevice interface. Thus, users should change their default password as soon as possible and\nuse a strong password for their devices.\n\nHowever, as seen in the presence of the password-stealing vulnerability mentioned above, a\nstrong password alone does not guarantee device security. IP Camera owners should also\nimplement other steps to ensure that their devices are protected from external attacks. In\naddition to using a strong password, users should also disable UPnP on their routers to\nprevent devices within the network from opening ports to the external Internet without any\nwarning.\n\nThe burden of IoT security does not rest on the user alone—it's also dependent on the\nvendors themselves, as they should be the ones responsible for making sure that their\ndevices are secure and always updated. In line with this, users should make sure that their\ndevices are always updated with the latest firmware to minimize the chance of vulnerability\nexploits.\n\n**Trend Micro Solutions**\n\nIn addition to the best practices mentioned above, users can look into solutions such as\n[Trend Micro™ Security and](http://blog.trendmicro.com/en_us/forHome/products.html) [Trend Micro Internet Security, which offer effective protection for](http://blog.trendmicro.com/en_us/forHome/products/internet-security.html)\nthreat’s to IoT devices using security features that can detect malware at the endpoint level.\nConnected devices are protected by security solutions such as Trend Micro Home Network\nSecurity, which can check internet traffic between the router and all connected devices. In\naddition, enterprises can monitor all ports and network protocols to detect advanced threats\nand protect from targeted attacks via [Trend Micro™ Deep Discovery™ Inspector .](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/inspector.html)\n\n[Deep Discovery Inspector protects customers from this threat via these DDI Rules:](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html)\n\nDDI beta rule 3664: \"IP Camera Remote Code Execution - HTTP (Request)”\nDDI beta rule 3665: \"IP Camera Authentication Bypass - HTTP (Request)\"\n\n[Users with Trend Micro Home Network Security are protected via the following signatures:](http://shop.trendmicro-apac.com/homenetworksecurity/)\n\n1133578 WEB GoAhead system.ini Information Disclosure Vulnerability -1 (CVE-20175674)\n1133642 WEB GoAhead system.ini Information Disclosure Vulnerability -2 (CVE-20175674)\n1133641 WEB Shell Spawning Attempt via telnetd -1.u\n\n\n-----\n\nThe Yara rule for detection is provided below:\n\nrule Persirai { meta: description = \"Detects Persirai Botnet Malware\" author = \"Tim Yeh\"\nreference = \"Internal Research\" date = \"2017-04-21\" hash1 =\n\"f736948bb4575c10a3175f0078a2b5d36cce1aa4cd635307d03c826e305a7489\" hash2\n= \"e0b5c9f874f260c840766eb23c1f69828545d7820f959c8601c41c024044f02c\" hash3\n= \"35317971e346e5b2a8401b2e66b9e62e371ce9532f816cb313216c3647973c32\"\nhash4 = \"ff5db7bdb4de17a77bd4a552f50f0e5488281cedc934fc3707833f90484ef66c\"\nhash5 =\n\"ec2c39f1dfb75e7b33daceaeda4dbadb8efd9015a9b7e41d595bb28d2cd0180f\" strings:\n$x1 = \"ftpupload.sh\" fullword ascii $x2 = \"/dev/misc/watchdog\" fullword ascii $x3 =\n\"/dev/watchdog\" ascii $x4 = \":52869/picsdesc.xml\" fullword ascii $x5 =\n\"npxXoudifFeEgGaACScs\" fullword ascii $s1 = \"ftptest.cgi\" fullword ascii $s2 =\n\"set_ftp.cgi\" fullword ascii $s3 = \"2580e538f3723927f1ea2fdb8d57b99e9cc37ced1\"\nfullword ascii $s4 = \"023ea8c671c0abf77241886465200cf81b1a2bf5e\" fullword ascii\ncondition: uint16(0) == 0x457f and filesize < 300KB and ( ( 1 of ($x*) and 1 of ($s*) ) or\n2 of ($s*) ) }\n\nRelated SHA256 Hashes detected as ELF_PERSIRAI.A:\n\nd00b79a0b47ae38b2d6fbbf994a2075bc70dc88142536f283e8447ed03917e45\nf974695ae560c6f035e089271ee33a84bebeb940be510ab5066ee958932e310a\naf4aa29d6e3fce9206b0d21b09b7bc40c3a2128bc5eb02ff239ed2f3549532bb\naa443f81cbba72e1692246b5647a9278040400a86afc8e171f54577dc9324f61\n4a5ff1def77deb11ddecd10f96e4a1de69291f2f879cd83186c6b3fc20bb009a\n44620a09441305f592fb65d606958611f90e85b62b7ef7149e613d794df3a778\na58769740a750a8b265df65a5b143a06972af2e7d82c5040d908e71474cbaf92\n7d7aaa8c9a36324a2c5e9b0a3440344502f28b90776baa6b8dac7ac88a83aef0\n4a5d00f91a5bb2b6b89ccdabc6c13eab97ede5848275513ded7dfd5803b1074b\n264e5a7ce9ca7ce7a495ccb02e8f268290fcb1b3e1b05f87d3214b26b0ea9adc\nff5db7bdb4de17a77bd4a552f50f0e5488281cedc934fc3707833f90484ef66c\nec2c39f1dfb75e7b33daceaeda4dbadb8efd9015a9b7e41d595bb28d2cd0180f\nf736948bb4575c10a3175f0078a2b5d36cce1aa4cd635307d03c826e305a7489\ne0b5c9f874f260c840766eb23c1f69828545d7820f959c8601c41c024044f02c\n35317971e346e5b2a8401b2e66b9e62e371ce9532f816cb313216c3647973c32\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-09 - Persirai- New Internet of Things (IoT) Botnet Targets IP Cameras.pdf"
    ],
    "report_names": [
        "2017-05-09 - Persirai- New Internet of Things (IoT) Botnet Targets IP Cameras.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535908,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653788303,
    "ts_modification_date": 1653788303,
    "files": {
        "pdf": "https://archive.orkl.eu/842935ee4e8380c6c6a929875a134056c7eaf271.pdf",
        "text": "https://archive.orkl.eu/842935ee4e8380c6c6a929875a134056c7eaf271.txt",
        "img": "https://archive.orkl.eu/842935ee4e8380c6c6a929875a134056c7eaf271.jpg"
    }
}