{
    "id": "af933517-dcbc-4ece-88c1-e3973f98347c",
    "created_at": "2023-01-12T15:01:53.421882Z",
    "updated_at": "2025-03-27T02:09:18.68948Z",
    "deleted_at": null,
    "sha1_hash": "651a918df3666a349b75933e8994b7920b0f267b",
    "title": "2022-01-21 - Emotet Spam Abuses Unconventional IP Address Formats to Spread Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T03:49:07Z",
    "file_modification_date": "2022-05-28T03:49:07Z",
    "file_size": 497280,
    "plain_text": "# Emotet Spam Abuses Unconventional IP Address Formats to Spread Malware\n\n**[trendmicro.com/en_us/research/22/a/emotet-spam-abuses-unconventional-ip-address-formats-spread-malware.html](https://www.trendmicro.com/en_us/research/22/a/emotet-spam-abuses-unconventional-ip-address-formats-spread-malware.html)**\n\nJanuary 21, 2022\n\n[We observed Emotet spam campaigns using hexadecimal and octal representations of IP addresses, likely to evade detection](https://www.trendmicro.com/en_us/research/21/c/emotet-one-month-after-the-takedown.html)\nvia pattern matching. Both routines use social engineering techniques to trick users into enabling document macros and\nautomate malware execution. Upon receiving these standards, operating systems (OS) automatically convert the values to the\ndotted decimal quad representation to initiate the request from the remote servers. Users and businesses are cautioned to\ndetect, block, and enable the relevant security measures to prevent compromise using Emotet for second stage delivery of\nmalware such as TrickBot and Cobalt Strike.\n\nRoutine using hexadecimal IP addresses\n\nThe samples we found start with an email-attached document using Excel 4.0 Macros, a dated feature used to automate\n[repetitive tasks in Excel that malicious actors have abused to deliver malware. Abuse of the feature in this case allows the](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/analysis-suspicious-very-hidden-formula-on-excel-4-0-macro-sheet)\nmalware to execute once the document is opened using the auto_open macro.\n\nFigure 1. Attached document in the emails lures users into enabling the macros\n[The URL is obfuscated with carets and the host contains a hexadecimal representation of the IP address. Using CyberChef,](https://gchq.github.io/CyberChef/)\nwe converted the hexadecimal numbers to find the more commonly used dotted decimal equivalent, 193[.]42[.]36[.]245.\n\n\n-----\n\nFigure 2. Using carets for obfuscation\n\nFigure 3. Converting the hexadecimal numbers to\n\ndotted decimal representation\nOnce executed, the macro invokes cmd.exe > mshta.exe with the URL containing the hex representation of the IP address as\nan argument, which will download and execute an HTML application (HTA) code from the remote host.\n\nFigure 4. Downloading and executing an HTA code\n\nRoutine using octal IP addresses\n\nMuch like the hexadecimal representation sample, the document also uses Excel 4.0 Macros to run the malware once the\ndocument is opened and enabled. The URL is also obfuscated with carets but the IP contains an octal representation. We also\nused CyberChef to decode this IP address into a dotted quad format, 46[.]105[.]81[.]76.\n\nFigure 5. Using similar techniques with\n\nthe hex decimal routine but with octal representation for obfuscation\n\nFigure 6. Converting the octal numbers to dotted\n\ndecimal representation\n\n\n-----\n\nAs observed in the process tree, once executed, the macro also invokes cmd.exe mshta.exe with the URL as an argument to\ndownload and execute an HTA code from the remote host.\n\nFigure 7. Downloading and executing an HTA file\nConclusion\n\nTraces of Emotet were observed as arbitrarily dropping Cobalt Strike beacons between November and December 2021. Earlier\nthis year, however, operators became noticeably selective on which targets the beacons were dropped. Evasion techniques\nlike these could be considered evidence of attackers continuing to innovate to thwart pattern-based detection solutions.\n\nMoreover, the unconventional use of hexadecimal and octal IP addresses may result in evading current solutions reliant on\npattern matching. But in the same vein, the unusual technique in the command lines can be used as a detection opportunity,\nwith security teams using filters as leverage that can be enabled to treat such IP addresses as suspicious and associate them\nwith malware.\n\nIndicators of compromise (IOCs)\n\nSHA256 Description Detections\n\n\ne492f31ca20d99888b2434dcb4d9af1f93ed4c485b9bd2bc550ce8ae8021b9cd Hexadecimal\nIP address\nsample\n\n3e9701129f13f13f7b873f55dc3d43d04cbd1dd3f85814270bb1b177394926b5 Octal IP\naddress\nsample\n\nURLs\n\n193[.]42[.]36[.]245\n\n46[.]105[.]81[.]76\n\nMalware\n\n\nTrojan.XF.HIDDBOOK.SMTH\n\nTrojan.XF.EMOTET.SMYXBLAA\n\n\nWe found waves of Emotet spam campaigns using unconventional IP addresses to evade detection.\n\nBy: Ian Kenefick January 21, 2022 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-21 - Emotet Spam Abuses Unconventional IP Address Formats to Spread Malware.pdf"
    ],
    "report_names": [
        "2022-01-21 - Emotet Spam Abuses Unconventional IP Address Formats to Spread Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535713,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653709747,
    "ts_modification_date": 1653709747,
    "files": {
        "pdf": "https://archive.orkl.eu/651a918df3666a349b75933e8994b7920b0f267b.pdf",
        "text": "https://archive.orkl.eu/651a918df3666a349b75933e8994b7920b0f267b.txt",
        "img": "https://archive.orkl.eu/651a918df3666a349b75933e8994b7920b0f267b.jpg"
    }
}