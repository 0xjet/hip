{
    "id": "d84e504d-945a-4bf1-a5e9-2a421d19db17",
    "created_at": "2023-01-12T15:05:25.32072Z",
    "updated_at": "2025-03-27T02:05:45.03275Z",
    "deleted_at": null,
    "sha1_hash": "14f7b0ba4b625aa32a543872409b65003cb340f3",
    "title": "2017-04-04 - ATMitch- remote administration of ATMs",
    "authors": "",
    "file_creation_date": "2022-05-28T01:55:25Z",
    "file_modification_date": "2022-05-28T01:55:25Z",
    "file_size": 266294,
    "plain_text": "# ATMitch: remote administration of ATMs\n\n**[securelist.com/blog/sas/77918/atmitch-remote-administration-of-atms/](https://securelist.com/blog/sas/77918/atmitch-remote-administration-of-atms/)**\n\nAuthors\n\n[Sergey Golovanov](https://securelist.com/author/sergeygo/)\n\n[In February 2017, we published research on fileless attacks against enterprise networks. We](https://securelist.com/fileless-attacks-against-enterprise-networks/77403/)\ndescribed the data collected during incident response in several financial institutions around\nthe world, exploring how attackers moved through enterprise networks leaving no traces on\nthe hard drives. The goal of these attackers was money, and the best way to cash out and\nleave no record of transactions is through the remote administration of ATMs. This second\npaper is about the methods and techniques that were used by the attackers in the second\nstage of their attacks against financial organizations – basically enabling remote\nadministration of ATMs.\n\nIn June 2016, Kaspersky Lab received a report from a Russian bank that had been the victim\nof a targeted attack. During the heist, the criminals were able to gain control of the ATMs and\nupload malware to them. After cashing out, the malware was removed. The bank’s forensics\nspecialists were unable to recover the malicious executables because of the fragmentation of\na hard drive after the attack, but they were able to restore the malware’s logs and some file\nnames.\n\n\n-----\n\nThe bank s forensic team were able, after careful forensic analysis of the ATM s hard drive,\nto recover the following files containing logs:\n\n_C:\\Windows\\Temp\\kl.txt_\n_C:\\logfile.txt_\n\nIn addition, they were able to find the names of two deleted executables. Unfortunately, they\nwere not able to recover any of the contents:\n\n_C:\\ATM\\!A.EXE_\n_C:\\ATM\\IJ.EXE_\n\nWithin the log files, the following pieces of plain text were found:\n\n_[Date – Time]_\n\n_[%d %m %Y – %H : %M : %S] > Entering process dispense._\n\n_[%d %m %Y – %H : %M : %S] > Items from parameters converted successfully. 4 40_\n\n_[%d %m %Y – %H : %M : %S] > Unlocking dispenser, result is 0_\n\n_[%d %m %Y – %H : %M : %S] > Catch some money, bitch! 4000000_\n\n_[%d %m %Y – %H : %M : %S] > Dispense success, code is 0_\n\nAs mentioned in the previous paper, based on the information from the log file we created a\nYARA rule to find a sample, in this case: MD5 cef6c2aa78ff69d894903e41a3308452. And\nwe’ve found one. This sample was uploaded twice (from Kazakhstan and Russia) as “tv.dll”.\n\nThe malware, which we have dubbed ATMitch, is fairly straightforward. Once remotely\ninstalled and executed via Remote Desktop Connection (RDP) access to the ATM from\nwithin the bank, the malware looks for the “command.txt” file that should be located in the\nsame directory as the malware and created by the attacker. If found, the malware reads the\none character content from the file and executes the respective command:\n\n_‘O’ – Open dispenser_\n_‘D’ – Dispense_\n_‘I’ – Init XFS_\n_‘U’ – Unlock XFS_\n_‘S’ – Setup_\n_‘E’ – Exit_\n_‘G’ – Get Dispenser id_\n_‘L’ – Set Dispenser id_\n_‘C’ – Cancel_\n\nAfter execution, ATMitch writes the results of this command to the log file and removes\n“command.txt” from the ATM’s hard drive.\n\n\n-----\n\nThe sample tv.dll successfully retrieved in this case does not try to conceal itself within the\nsystem.\n\n_The malware’s command parser_\n\nThe malware uses the standard XFS library to control the ATM. It should be noted that it\nworks on every ATM that supports the XFS library (which is the vast majority).\n\nUnfortunately, we were unable to retrieve the executables (!A.exe and IJ.exe, located in\nC:\\ATM) from the ATM; only the file names were found as artefacts during the forensic\nanalysis. We assume that these are the installer and uninstaller of the malware. It should\n\n\n-----\n\nalso be noted that tv.dll contained one Russian-language resource.\n\nKaspersky Lab continues to monitor and track these kinds of threats and reiterates the need\nfor allowlisting in ATMs as well as the use of [anti-APT solutions in banking networks.](https://www.kaspersky.com/advert/enterprise-security/anti-targeted-attacks?redef=1&THRU&reseller=gl_slpost_pro_ona_smm__onl_b2b_securelist_lnk____kata___)\n\n[APT](https://securelist.com/tag/apt/)\n[ATM](https://securelist.com/tag/atm/)\n[Financial malware](https://securelist.com/tag/financial-malware/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\n[Sergey Golovanov](https://securelist.com/author/sergeygo/)\n\nATMitch: remote administration of ATMs\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-04 - ATMitch- remote administration of ATMs.pdf"
    ],
    "report_names": [
        "2017-04-04 - ATMitch- remote administration of ATMs.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535925,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1653702925,
    "ts_modification_date": 1653702925,
    "files": {
        "pdf": "https://archive.orkl.eu/14f7b0ba4b625aa32a543872409b65003cb340f3.pdf",
        "text": "https://archive.orkl.eu/14f7b0ba4b625aa32a543872409b65003cb340f3.txt",
        "img": "https://archive.orkl.eu/14f7b0ba4b625aa32a543872409b65003cb340f3.jpg"
    }
}