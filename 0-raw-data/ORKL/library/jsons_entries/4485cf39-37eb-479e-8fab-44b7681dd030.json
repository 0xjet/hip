{
    "id": "4485cf39-37eb-479e-8fab-44b7681dd030",
    "created_at": "2023-11-01T02:04:40.067692Z",
    "updated_at": "2025-03-27T02:17:05.693955Z",
    "deleted_at": null,
    "sha1_hash": "5247780681d6c50b9969160fdd0b9cdff8e0f06f",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-07-10T19:31:51Z",
    "file_modification_date": "2017-07-10T19:31:51Z",
    "file_size": 1480089,
    "plain_text": "### TLP: White\n# Analysis of the Cyber Attack on the Ukrainian Power Grid\n### Defense Use Case\n\n March 18, 2016\n\n\n-----\n\n#### Table of Contents\n\nPreface: Analysis of the Cyber Attack on the Ukrainian Power Grid .......................................................................... iii\n\nSummary of Incidents ...................................................................................................................................................... 1\n\nSummary of Information and Reporting ......................................................................................................................... 2\n\nAttacker Tactics Techniques and Procedures Description ........................................................................................... 4\n\nICS Cyber Kill Chain Mapping ........................................................................................................................................ 7\n\nICS Cyber Kill Chain Mapping – Stage 1 .................................................................................................................... 8\n\nICS Cyber Kill Chain Mapping – Stage 2 .................................................................................................................. 10\n\nDefense Lessons Learned – Passive and Active Defenses .......................................................................................... 14\n\nRecommendations ...................................................................................................................................................... 21\n\nImplications and Conclusion ....................................................................................................................................... 23\n\nAppendix Information Evaluation .............................................................................................................................. 25\n\n**E‐ISAC | Analysis of the Cyber Attack on the Ukrainian Power Grid | March 18 2016**\n\n\n-----\n\n#### Preface\n\n##### Analysis of the Cyber Attack on the Ukrainian Power Grid\nThis is an analysis by a joint team to provide a lessons learned community resource from the cyber attack on the\nUkrainian power grid. The document is being released as Traffic Light Protocol: White (TLP: White) and may be\ndistributed without restriction, subject to copyright controls. This document, the Defense Use Case (DUC),\nsummarizes important learning points and presents several mitigation ideas based on publicly available\ninformation on ICS incidents in Ukraine. The E‐ISAC and SANS are providing a summary of the available information\ncompiled from multiple publicly available sources as well as analysis performed by the SANS team in relation to\nthis event.[1 ] This document provides specific mitigation concepts for power system Supervisory Control and Data\nAcquisition (SCADA) defense, as well as a general learning opportunity for ICS defenders.\n\nAuthors, working with the E‐ISAC:\n_Robert M. Lee, SANS_\n_Michael J. Assante, SANS_\n_Tim Conway, SANS_\n\n1 The SANS investigation into this incident should not be confused with the U.S. interagency team investigation or any other organization\nor company’s efforts to include the E‐ISAC’s past reporting. SANS ICS team has been analyzing the data on their own since December 25,\n2015, and has provided its analysis to the wider community. This document is provided to E‐ISAC and the North American electricity\nsector to benefit its members and the larger critical infrastructure community.\n\n**E‐ISAC | Analysis of the Cyber Attack on the Ukrainian Power Grid | March 18, 2016**\niii\n\n\n-----\n\n#### Summary of Incidents\n\nOn December 23, 2015, the Ukrainian Kyivoblenergo, a regional electricity distribution company, reported service\noutages to customers. The outages were due to a third party’s illegal entry into the company’s computer and\nSCADA systems: Starting at approximately 3:35 p.m. local time, seven 110 kV and 23 35 kV substations were\ndisconnected for three hours. Later statements indicated that the cyber attack impacted additional portions of\nthe distribution grid and forced operators to switch to manual mode.[2, 3 ]The event was elaborated on by the\nUkrainian news media, who conducted interviews and determined that a foreign attacker remotely controlled the\nSCADA distribution management system.[4 ] The outages were originally thought to have affected approximately\n80,000 customers, based on the Kyivoblenergo’s update to customers. However, later it was revealed that three\ndifferent distribution oblenergos (a term used to describe an energy company) were attacked, resulting in several\noutages that caused approximately 225,000 customers to lose power across various areas.[5, 6]\n\nShortly after the attack, Ukrainian government officials claimed the outages were caused by a cyber attack, and\nthat Russian security services were responsible for the incidents.[7 ]Following these claims, investigators in Ukraine,\nas well as private companies and the U.S. government, performed analysis and offered assistance to determine\nthe root cause of the outage.[8 ]Both the E‐ISAC and SANS ICS team was involved in various efforts and analyses in\nrelation to this case since December 25, 2015, working with trusted members and organizations in the\ncommunity.\n\nThis joint report consolidates the open source information, clarifying important details surrounding the attack,\noffering lessons learned, and recommending approaches to help the ICS community repel similar attacks. This\nreport does not focus on attribution of the attack.\n\n2 https://ics.sans.org/blog/2016/01/09/confirmation-of-a-coordinated-attack-on-the-ukrainian-power-grid\n[3 http://news.finance.ua/ua/news/-/366136/hakery-atakuvaly-prykarpattyaoblenergo-znestrumyvshy-polovynu-regionu-na-6-](http://news.finance.ua/ua/news/-/366136/hakery-atakuvaly-prykarpattyaoblenergo-znestrumyvshy-polovynu-regionu-na-6-godyn)\n[godyn](http://news.finance.ua/ua/news/-/366136/hakery-atakuvaly-prykarpattyaoblenergo-znestrumyvshy-polovynu-regionu-na-6-godyn)\n[4 http://ru.tsn.ua/ukrayina/iz-za-hakerskoy-ataki-obestochilo-polovinu-ivano-frankovskoy-oblasti-550406.html](http://ru.tsn.ua/ukrayina/iz-za-hakerskoy-ataki-obestochilo-polovinu-ivano-frankovskoy-oblasti-550406.html)\n[5 http://www.oe.if.ua/showarticle.php?id=3413](http://www.oe.if.ua/showarticle.php?id=3413)\n[6 https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-01](https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-01)\n[7 http://www.ukrinform.net/rubric-crime/1937899-russian-hackers-plan-energy-subversion-in-ukraine.html](http://www.ukrinform.net/rubric-crime/1937899-russian-hackers-plan-energy-subversion-in-ukraine.html)\n[8 https://www.rbc.ua/rus/news/pravitelstva-ssha-ukrainy-rassmotryat-otchet-1454113214.html](https://www.rbc.ua/rus/news/pravitelstva-ssha-ukrainy-rassmotryat-otchet-1454113214.html)\n\n**E‐ISAC | Analysis of the Cyber Attack on the Ukrainian Power Grid | March 18, 2016**\n1\n\n\n-----\n\n#### Summary of Information and Reporting\n\n##### Background\nOn December 24, 2015, TSN (a Ukrainian news outlet) released the report “Due to a Hacker Attack Half of the\nIvano‐Frankivsk Region is De‐Energized.”[10 ] Numerous reporting agencies and independent bloggers from the\nWashington Post, SANS Institute, New York Times, ARS Technica, BBC, Wired, CNN, Fox News, and the E‐ISAC\nReport have followed up on the initial TSN report.[11 ] These subsequent reports have collectively provided details\nof a cyber attack that targeted the Ukrainian electric system. The U.S. Department of Homeland Security (DHS)\nissued a formal report on February 25, 2016, titled IR‐ALERT‐H‐16‐056‐01.[12 ] Based on the DHS report, three\nUkrainian oblenergos experienced coordinated cyber attacks that were executed within 30 minutes of each other.\nThe attack impacted 225,000 customers and required the oblenergos to move to manual operations in response\nto the attack.\n\nThe oblenergos were reportedly able to restore service quickly after an outage window lasting several hours.[13 ]\n\nThe DHS report states that, while electrical service was restored, the impacted oblenergos continue to operate\ntheir distribution systems in an operationally constrained mode. Within the Ukrainian electrical system, these\nattacks were directed at the regional distribution level, as shown in Figure 1.\n\nFigure 1: Electric System Overview\n\n[9 http://ru.tsn.ua/ukrayina/iz-za-hakerskoy-ataki-obestochilo-polovinu-ivano-frankovskoy-oblasti-550406.html](http://ru.tsn.ua/ukrayina/iz-za-hakerskoy-ataki-obestochilo-polovinu-ivano-frankovskoy-oblasti-550406.html)\n10 E‐ISAC: Mitigating Adversarial Manipulation of Industrial Control Systems as Evidenced by Recent International Events, February 9, 2016\n(TLP=RED)\n[11 https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-](https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-)\n\n12 https://www.washingtonpost.com/world/national-security/russian-hackers-suspected-in-attack-that-blacked-out-parts-ofukraine/2016/01/05/4056a4dc-b3de-11e5-a842-0feb51d1d124_story.html\n\n**E‐ISAC | Analysis of the Cyber Attack on the Ukrainian Power Grid | March 18, 2016**\n2\n\n\n-----\n\nSee the Appendix for an evaluation of the credibility and amount of technical information that is publicly available.\n\n**Keeping Perspective**\nThe cyber attacks in Ukraine are the first publicly acknowledged incidents to result in power outages. As future\nattacks may occur, it is important to scope the impacts of the incident. Power outages should be measured in\nscale (number of customers and amount of electricity infrastructure involved) and in duration to full restoration.\nThe Ukrainian incidents affected up to 225,000 customers in three different distribution‐level service territories\nand lasted for several hours. These incidents should be rated on a macro scale as low in terms of power system\nimpacts as the outage affected a very small number of overall power consumers in Ukraine and the duration was\nlimited. In contrast, it is likely that the impacted companies rate these incidents as high or critical to the reliability\nof their systems and business operations.\n\n\n-----\n\n#### Attacker Tactics Techniques and Procedures Description\n\nDirect attribution is unnecessary to learn from this attack and to consider mitigation strategies; it is only necessary\nto use the mental model of how the cyber actor works to understand the capabilities and general profile against\nwhich one is defending. The motive and sophistication of this power grid attack is consistent with a highly\nstructured and resourced actor. This actor was co‐adaptive and demonstrated varying tactics and techniques to\nmatch the defenses and environment of the three impacted targets. The mitigation section of this document\nprovides mitigation concepts related to the attack and how to develop a more lasting mitigation strategy by\nanticipating future attacks.\n\n**Capability**\nThe attackers demonstrated a variety of capabilities, including spear phishing emails, variants of the BlackEnergy\n3 malware, and the manipulation of Microsoft Office documents that contained the malware to gain a foothold\ninto the Information Technology (IT) networks of the electricity companies.[14 ]They demonstrated the capability to\ngain a foothold and harvest credentials and information to gain access to the ICS network. Additionally, the\nattackers showed expertise, not only in network connected infrastructure; such as Uninterruptable Power\nSupplies (UPSs), but also in operating the ICSs through supervisory control system; such as the Human Machine\nInterface (HMI), as shown in Figure 2.\n\nFigure 2: Control & Operate: SCADA Hijacking Techniques\n\nFinally, the adversaries demonstrated the capability and willingness to target field devices at substations, write\ncustom malicious firmware, and render the devices, such as serial‐to‐ethernet convertors, inoperable and\n\n13 For a discussion around the history of the BlackEnergy 3 malware and Sandworm team see the SANS ICS webcast with iSight here:\n[https://www.sans.org/webcasts/analysis-sandworm-team-ukraine-101597](https://www.sans.org/webcasts/analysis-sandworm-team-ukraine-101597)\n\n\n-----\n\n**Attacker Tactics Techniques and Procedures Description**\n\nunrecoverable.[15 ]In one case, the attackers also used telephone systems to generate thousands of calls to the\nenergy company’s call center to deny access to customers reporting outages. However, the strongest capability\nof the attackers was not in their choice of tools or in their expertise, but in their capability to perform long‐term\nreconnaissance operations required to learn the environment and execute a highly synchronized, multistage,\nmultisite attack.\n\nThe following is a consolidated list of the technical components used by the attackers, graphically depicted in\nFigure 3:\n\n    - Spear phishing to gain access to the business networks of the oblenergos\n\n  - Identification of BlackEnergy 3 at each of the impacted oblenergos\n\n  - Theft of credentials from the business networks\n\n    - The use of virtual private networks (VPNs) to enter the ICS network\n\n    - The use of existing remote access tools within the environment or issuing commands directly\nfrom a remote station similar to an operator HMI\n\n  - Serial‐to‐ethernet communications devices impacted at a firmware level[16]\n\n    - The use of a modified KillDisk to erase the master boot record of impacted organization systems as\nwell as the targeted deletion of some logs[17]\n\n  - Utilizing UPS systems to impact connected load with a scheduled service outage\n\n  - Telephone denial‐of‐service attack on the call center\n\nFigure 3: Ukraine Attack Consolidated Technical Components\n\nAt various points in the public reporting on the attack, organizations have indicated that BlackEnergy 3 and KillDisk\nitself could be directly responsible for the outage. One of the items specifically highlighted to support this theory\n\n[14 http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886](http://mpe.kmu.gov.ua/minugol/control/uk/publish/article%3Bjsessionid%3DCE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886)\n&cat_id=35109\n\n15 To learn about serial to ethernet converters and the types of vulnerabilities that exist to them see DigitalBond’s Basecamp report here:\n[http://www.digitalbond.com/blog/2015/10/30/basecamp](http://www.digitalbond.com/blog/2015/10/30/basecamp)\n\n[16 http://www.symantec.com/connect/blogs/destructive-disakil-malware-linked-ukraine-power-outages-also-used-against-media-](http://www.symantec.com/connect/blogs/destructive-disakil-malware-linked-ukraine-power-outages-also-used-against-media-organizations)\n[organizations](http://www.symantec.com/connect/blogs/destructive-disakil-malware-linked-ukraine-power-outages-also-used-against-media-organizations)\n\n\n-----\n\n**Attacker Tactics Techniques and Procedures Description**\n\nwas that KillDisk deleted a process on Windows systems linked to serial‐to‐ethernet communications.[18 ]Regardless\nof the impact of the SCADA network environment, neither BlackEnergy 3 nor KillDisk contained the required\ncomponents to cause the outage. The outages were caused by the use of the control systems and their software\nthrough direct interaction by the adversary. All other tools and technology, such as BlackEnergy 3 and KillDisk,\nwere used to enable the attack or delay restoration efforts.\n\n**Opportunities**\nMultiple opportunities existed for the adversary to execute its attack. External to the oblenergos and prior to the\nattack, there was a variety of open‐source information available; including a detailed list of types of infrastructure\nsuch as Remote Terminal Unit (RTU) vendors and versions posted online by ICS vendors.[19 ] The VPNs into the ICS\nfrom the business network appear to lack two‐factor authentication. Additionally, the firewall allowed the\nadversary to remote admin out of the environment by utilizing a remote access capability native to the systems.\nIn addition, based on media reporting, there did not appear to be any resident capability to continually monitor\nthe ICS network and search for abnormalities and threats through active defense measures; like network security\nmonitoring. These vulnerabilities would have provided the adversary the opportunity to persist within the\nenvironment for six months or more to conduct reconnaissance on the environment and subsequently execute\nthe attack.[20]\n\nBased on the details provided in the DHS report, the adversary used a consistent attack approach on all three\nimpacted targets. The adversary also used consistent tactics to impact field controllable elements and irreparably\ndamage field devices.\n\nWhy these oblenergos were targeted remains an open debate. Based on the public reporting, it is unknown if the\ntargets were selected based on common technologies in use, system architectures, reconnaissance operations, or\nservice territories. Opportunity‐based considerations for selecting a specific target may focus on an attacker’s\nconfidence and ability to cause an ICS effect. Some example decision factors could include:\n\n    - Targets with common systems and configurations\n\n  - Multiple systems with common centralized control points\n\n  - ICS impact duration estimates (e.g., long term or short term)\n\n  - Existing capabilities required to achieve desired results\n\n  - Risk level of performing the operation and being discovered\n\n  - Achieved access and ability to move and act within the environment\n\n[17http://www.eset.com/int/about/press/articles/malware/article/eset-finds-connection-between-cyber-espionage-and-electricity-outage-](http://www.eset.com/int/about/press/articles/malware/article/eset-finds-connection-between-cyber-espionage-and-electricity-outage-in-ukraine/)\n[in-ukraine/](http://www.eset.com/int/about/press/articles/malware/article/eset-finds-connection-between-cyber-espionage-and-electricity-outage-in-ukraine/)\n\n[18 http://galcomcomp.com/index.php/ru/nashi-proekty/15-proekt3-material-ru](http://galcomcomp.com/index.php/ru/nashi-proekty/15-proekt3-material-ru)\n\n[19 http://mobile.reuters.com/article/idUSKCN0VL18E](http://mobile.reuters.com/article/idUSKCN0VL18E)\n\n\n-----\n\n#### ICS Cyber Kill Chain Mapping\n\nThe ICS Cyber Kill Chain was published by SANS in 2015 by Michael Assante and Robert M. Lee as an adaptation\nof the traditional cyber kill chain developed by Lockheed Martin analysts as it applied to ICSs.[21 ] The ICS Cyber Kill\nChain details the steps an adversary must follow to perform a high‐confidence attack on the ICS process and/or\ncause physical damage to equipment in a predictable and controllable way, as displayed in Figure 4.\n\nFigure 4: The ICS Cyber Kill Chain with Stage 1 Highlighted\n\nThe attack on the Ukrainian power grid followed the ICS Cyber Kill Chain completely throughout Stage 1 and Stage\n2. The attack gained access to each level of the ICS, as shown in Figure 5, with the ICS Cyber Kill Chain plotted\nalongside a segmentation/hierarchy model (e.g., modified Purdue Model). Completing Stage 1 entails a successful\ncyber intrusion or breach into an ICS system, but is not characterized as an ICS attack. Completion of Stage 2\ncompleted the ICS Kill Chain, resulting in a successful cyber attack that led to an impact on the operations of the\nICS. The next section includes a discussion of the two stages using currently available information from the attack.\n\n[20 https://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297](https://www.sans.org/reading-room/whitepapers/ICS/industrial-control-system-cyber-kill-chain-36297)\n\n\n-----\n\n**ICS Cyber Kill Chain Mapping**\n\nFigure 5: Ukraine Cyber Attack ICS Cyber Kill Chain and Purdue Model Mapping[22]\n\n**ICS Cyber Kill Chain Mapping – Stage 1**\nThe first step in Stage 1 is Reconnaissance. There were no reports of observed reconnaissance having taken place\nprior to targeting the energy companies. However, an analysis of the three impacted organizations shows they\nwere particularly interesting targets due to the levels of automation in their distribution system; enabling the\nremote opening of breakers in a number of substations. Additionally, the targeting and final attack plan for the\nelectricity companies in general were highly coordinated, which indicates that reconnaissance took place at some\npoint. This was very unlikely to have been an opportunistic attack.\n\nThe second step is Weaponization and/or Targeting. Targeting would normally take place when no weaponization\nis needed; such as directly accessing internet connected devices. In this attack, it does not appear that targeting\nof specific infrastructure was necessary to gain access. Instead, the adversaries weaponized Microsoft Office\ndocuments (Excel and Word) by embedding BlackEnergy 3 within the documents.[23 ] Samples of Excel and other\noffice documents have been recovered from the broader access campaign that targeted a multitude of\norganizations in Ukraine; including Office documents used in the specific attack against the three electricity\ncompanies.[24, 25]\n\n21 Note, the exact architectures of the impacted utilities are not represented in the figure. The Purdue Model is a standard way of viewing\ndifferent zones of a well‐constructed ICS.\n[22 https://securelist.com/blog/research/73440/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/](https://securelist.com/blog/research/73440/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/)\n[23 https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-281-01B](https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-281-01B)\n24 Those looking for Indicators of Compromise for the word document, command and control servers, and the malware should\nlook to E‐ ISAC, ICS‐CERT, and iSight private reporting as well as public reporting from Kaspersky Labs, ESET, and CYS Centrum\nreference: [https://cys-centrum.com/ru/news/black_energy_2_3 and](https://cys-centrum.com/ru/news/black_energy_2_3) https://securelist.com/blog/research/73440/blackenergyapt-attacks-in-ukraine-employ-spearphishing-with-word-documents/\n\n\n-----\n\n**ICS Cyber Kill Chain Mapping**\n\nDuring the cyber intrusion stage of Delivery, Exploit, and Install, the malicious Office documents were delivered\nvia email to individuals in the administrative or IT network of the electricity companies. When these documents\nwere opened, a popup was displayed to users to encourage them to enable the macros in the document as shown\nin Figure 6.[26 ]Enabling the macros allowed the malware to Exploit Office macro functionality to install BlackEnergy\n3 on the victim system and was not an exploit of a vulnerability through exploit code. There was no observed\nexploit code in this incident. The theme of using available functionality in the system was present throughout the\nadversary’s kill chain.\n\nFigure 6: A Sample of a BlackEnergy 3 Infected Microsoft Office Document[27]\n\nUpon the Install step, the BlackEnergy 3 malware connected to command and control (C2) IP addresses to enable\ncommunication by the adversary with the malware and the infected systems. These pathways allowed the\nadversary to gather information from the environment and enable access. The attackers appear to have gained\naccess more than six months prior to December 23, 2015, when the power outage occurred.[28 ] One of their first\nactions happened when the network was to harvest credentials, escalate privileges, and move laterally throughout\nthe environment (e.g., target directory service infrastructure to directly manipulate and control the authentication\nand authorization system). At this point, the adversary completed all actions to establish persistent access to the\ntargets. While the initial footholds were used to harvest legitimate credentials for pivoting and systematic\ntakeover of IT systems and remote connections, it is likely that the attackers moved quickly away from their initial\nfootholds and vulnerable C2s in an effort to blend into the target’s systems as authorized users. With this\ninformation, the attackers would be able to identify VPN connections and avenues from the business network into\nthe ICS network. Using native connections and commands allows the attackers to discover the remainder of the\nsystems and extract data necessary to formulate a plan for Stage 2.\n\n25 For a detailed understanding of the infected Microsoft Office documents and the malicious payload see Kaspersky Lab’s write‐up here:\nhttps://securelist.com/blog/research/73440/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/\n26 https://securelist.com/blog/research/73440/blackenergy‐apt‐attacks‐in‐ukraine‐employ‐spearphishing‐with‐word‐documents/\n\n27 [http://politicalpistachio.blogspot.com/2016/01/russian-hackers-take-down-power-grid-in.html](http://politicalpistachio.blogspot.com/2016/01/russian-hackers-take-down-power-grid-in.html)\n\n\n-----\n\n**ICS Cyber Kill Chain Mapping**\n\nUsing the stolen credentials, the adversary was able to pivot\n\n**Speculation**\n\ninto the network segments where SCADA dispatch workstations\n\nThere was not enough publicly available\n\nand servers existed. Upon entry into the network, the actions\n\ninformation to determine how diversified\n\nof the adversaries were consistent in theme but different in\n\nthe adversary’s attack was to include how\n\ntechnical minutia between the three impacted oblenergoss. In\n\nmany different types of devices were\n\nat least one of the oblenergos, the attackers discovered a\n\nimpacted at the firmware level. However,\n\nnetwork connected to a UPS and reconfigured it so that when\n\nthrough publicly available information about\n\nthe attacker caused a power outage, it was followed by an\n\nthe Ukrainian networks, as well as\n\nevent that would also impact the power in the energy\n\nknowledge of similar electric distribution\n\ncompany’s buildings or data centers/closets.\n\nsystems, it is likely that there was a diverse\nhardware and software environment.\n\nThere is not sufficient information available to identify if any\ninformation was exfiltrated from the environment, but the\n\nIt is suspected that the administrative and\n\nadversary demonstrated a capability in Stage 2 that indicates\n\nICS networks contained multiple OS versions\n\ninternal discovery was performed. This reconnaissance would\n\nsuch as Windows XP and Windows 7,\n\nhave needed to include discovering field devices such as the\n\nmultiple types of RTUs and gateways, and\n\nserial‐to‐ethernet devices used to interpret commands from\n\nvarious industrial switches.\n\nthe  SCADA  network  to  the  substation  control  systems.\nAdditionally, the three oblenergos used different distribution\nmanagement systems (DMSs), and the attackers would have needed to perform some network reconnaissance\nagainst these systems and find specific targets to execute their highly coordinated attack.[29]\n\n**ICS Cyber Kill Chain Mapping – Stage 2**\nIn most cases, the **Develop** stage occurs in the adversary’s networks, thereby limiting any available forensic\ninformation, but the attack that follows this stage can reveal a lot about the adversarial process. In the Attack\nDevelopment and Tuning Stage of Stage 2, the attackers executed the Develop step in at least two ways. First,\nthey learned how to interact with the three distinct DMS environments using the native control present in the\nsystem and operator screens. Second, and more importantly, they developed malicious firmware for the serial‐\nto‐ethernet devices.[30]\n\nCurrently available information indicates that the malicious firmware was consistent amongst devices and\nuploaded within short periods of each other to multiple sites. Therefore, the malicious uploads of firmware was\nlikely developed prior to the attack for quick and predictable execution.\n\nE‐ISAC and the SANS ICS team assess with high confidence that, during the Validation Stage of Stage 2, the\nadversary did **Test** their capabilities prior to their deployment. It is possible that the adversaries were able to\nexecute this with pure luck, but it is highly unlikely and inconsistent with the professionalism observed throughout\nthe rest of the attack. The adversaries likely had systems in their organization that they were able to evaluate and\ntest their firmware against prior to executing on December 23rd.\n\n28 The three different DMS vendors were discoverable via open‐source searching. The names of the vendors are being withheld as it is not\nimportant to the discussion of the attack. There were no exploits leveraged against these vendors but they were simply abused with direct\naccess.\n[29http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886](http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886&cat_id=35109)\n[&cat_id=35109](http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886&cat_id=35109)\n\n\n-----\n\n**ICS Cyber Kill Chain Mapping**\n\nDuring the ICS Attack Stage, the adversaries used native software to Deliver themselves into the environment for\ndirect interaction with the ICS components. They achieved this using existing remote administration tools on the\noperator workstations. The threat actors also continued to use the VPN access into the IT environment.[31]\n\nIn final preparation for the attack, the adversaries completed the **Install/Modify** stage by installing malicious\nsoftware identified as a modified or customized KillDisk across the environment. While it is likely the attackers\nthen ensured their modifications to the UPS were ready for the attack, there was not sufficient forensic evidence\navailable to prove this. The last act of modification was for the adversaries to take control of the operator\nworkstations and thereby lock the operators out of their systems. Figure 7 shows the static analysis of the KillDisk\nAPI imports following the event.\n\nFigure 7: Static Analysis of KillDisk Identifying API Imports[32]\n\nFinally, to complete the ICS Cyber Kill Chain and to Execute the ICS Attack, the adversaries used the HMIs in the\nSCADA environment to open the breakers. At least 27 substations (the total number is probably higher) were\ntaken offline across the three energy companies, impacting roughly 225,000 customers.[33, 34 ]Simultaneously, the\n\n[30http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886&c](http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886&cat_id=35109)\n[at_id=35109](http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886&cat_id=35109)\n\n31 This image was provided by Jake Williams of Rendition InfoSec. It is included here to note that KillDisk would not run properly in a\nmalware sandbox for analysis. Static analysis was required to fully investigate the malware sample.\n[32 http://money.cnn.com/2016/01/18/technology/ukraine-hack-russia/](http://money.cnn.com/2016/01/18/technology/ukraine-hack-russia/)\n33 In analysis of the impact observhttp://money.cnn.com/2016/01/18/technology/ukraine-hack-russia/ed and on the available\ninformation on the Ukrainian distribution grid it is assessed with medium confidence that the public number of disconnected substations,\n27, is a low number.\n\n\n-----\n\n**ICS Cyber Kill Chain Mapping**\n\nattackers uploaded the malicious firmware to the serial‐to‐ethernet gateway devices. This ensured that even if\nthe operator workstations were recovered, remote commands could not be issued to bring the substations back\nonline (We have characterized the firmware attacks against field communication devices as “blowing the\nbridges”).\n\nDuring this same period, the attackers also leveraged a remote telephonic denial of service on the energy\ncompany’s call center with thousands of calls to ensure that impacted customers could not report outages.\nInitially, it seemed that this attack was to keep customers from informing the operators of how extensive the\noutages were; however, in review of the entirety of the evidence, it is more likely that the denial of service was\nexecuted to frustrate the customers since they could not contact customer support or gain clarity regarding the\noutage. The entire attack from March 2015 – December 23, 2015 is graphically depicted below in Figure 8.\n\nFigure 8: ICS Kill Chain Mapping Chart\n\n\n-----\n\n**ICS Cyber Kill Chain Mapping**\n\nIt is extremely important to note that neither BlackEnergy 3, unreported backdoors, KillDisk, nor the malicious\nfirmware uploads alone were responsible for the outage. Each was simply a component of the cyber attack for\nthe purposes of access and delay of restoration. For example, on some systems, KillDisk made the Windows\nsystems inoperable by manipulating or deleting the master boot record, but on other systems it just deleted logs\nand system events.[35, 36 ]The actual cause of the outage was the manipulation of the ICS itself and the loss of control\ndue to direct interactive operations by the adversary. The loss of view into the system through the wiping of the\nSCADA network systems simply delayed restoration efforts.\n\nIn summary, Stage 2 consisted of the following attack elements:\n\n - **Supporting attacks:**\n\n   - Schedule disconnects for UPS systems\n\n   - Telephonic floods against at least one oblenergos’ customer support line\n\n - **Primary attack: SCADA hijack with malicious operation to open breakers**\n\n - **Amplifying attacks:**\n\n   - KillDisk wiping of workstations, servers, and an HMI card inside of an RTU\n\n   - Firmware attacks against Serial‐to‐Ethernet devices at substations\n\n34 [https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-01](https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-01)\n\n[35 https://ics.sans.org/blog/2016/01/01/potential-sample-of-malware-from-the-ukrainian-cyber-attack-uncovered](https://ics.sans.org/blog/2016/01/01/potential-sample-of-malware-from-the-ukrainian-cyber-attack-uncovered)\n\n\n-----\n\n#### Defense Lessons Learned – Passive and Active Defenses\n\nWe reviewed the mitigation strategies provided through the DHS ICS‐CERT Alert and considered how an adversary\nmay alter the next attack based on the mitigation taken by a target. We support many of the mitigation\nrecommendations provided to date. However, it is likely that the adversary will modify attack approaches in\nfollow‐on campaigns and these mitigation strategies may not be sufficient. In the following section, we discuss\nmitigations for the attack that took place to extract defense lessons learned. In addition, we discuss future\npotential attacker methodologies and provide recommendations that could disrupt similar adversary’s operations.\nThe mitigations will focus on recommendations for **Architecture, Passive Defense,** and **Active Defense**\nmethodologies along the Sliding Scale of Cyber Security, shown in Figure 9.[37]\n\nFigure 9: The Sliding Scale of Cyber Security\n\n##### Spear Phishing\n\n**Ukraine Attack**\nIn the attack, the adversary delivered a targeted email with a malicious attachment that appeared to come from\na trusted source to specific individuals within the organizations. Initial mitigation recommendations would point\nto end‐user awareness training and ongoing phishing testing. Efforts to prevent malware have often\nrecommended application whitelisting, which can be effective in ICS environments if the ICS vendor approves of\nthe use. However, based on the details of this attack, application whitelisting would have had a limited role\ncontained to the execution of initial dropper infections in network segments with infected workstations (e.g.,\nusers that received and activated infected spear phish emails) where application whitelisting may be more\nchallenging to implement. It is important to note that application whitelisting would not have deterred or\nprevented the second stage ICS attacks that impacted the Ukrainian oblenergos. In at least one instance, the\nattacker used a remote rogue client and approved OS‐level remote admin features for other components of the\nattack.\n\n**The Next Attack**\nThe adversary may conduct follow‐on attacks that pursue alternative forms of social engineering campaigns, like\ntargeting the organization through large‐scale phishing campaigns, using water‐holing attacks, or conducting\ndirect‐call campaigns to users or the help desk. They could also leverage technical exploits not requiring social\nengineering of personnel.\n\n[36 https://www.sans.org/reading-room/whitepapers/analyst/sliding-scale-cyber-security-36240](https://www.sans.org/reading-room/whitepapers/analyst/sliding-scale-cyber-security-36240)\n\n\n-----\n\n**Defense Lessons Learned – Passive and Active Defenses**\n\n**Opportunities to Disrupt**\nThe adversary will likely modify attacks to respond to increases or changes in the target’s defenses. Defenders\nneed to develop anticipatory responses to attack effects. Since the social engineering components of attacks\ntargeted email and internet accessible cyber assets, these assets and the networks they reside on are untrusted\ncontested territory. Communication with these untrusted areas should be segmented, monitored, and controlled.\nOperate under the assumption that the environment is accessible by the adversary and ensure appropriate\ndefenses are in place to protect the operations and control environment from the adversary‐controlled business\ncyber assets (while some organizations inherently trust their business systems and networks, additional\nenforcement and scrutiny of these systems is necessary). Consider using sandboxing technology to evaluate\ndocuments and emails coming into the network, using proxy systems to control outbound and inbound\ncommunication paths, and limiting workstations to communicate only through the proxy devices by implementing\nperimeter egress access controls.\n\n##### Credential Theft\n\n**Ukraine Attack**\nIn the attack, the adversary appears to have used BlackEnergy 3 to establish a foothold and utilize keystroke\nloggers to perform credential theft. As an initial mitigation approach, we recommend that organizations obtain\nthe YARA rules for the latest IOCs. By using the YARA forensic tool, organizations can search for BlackEnergy 3\ninfections and then utilize antimalware removal tools to eliminate the malware from the infected assets.\nDefenders should be mindful of the time it takes to detect an infected host as the intruder may have already\nmoved inside the network and secured additional methods to interact and communicate with the infected\nnetwork. Organizations should change user and shared user passwords (ensure that these steps are approved by\noperations and the vendor, and tested for impacts to operations and existing security controls).\n\n**The Next Attack**\nAdversaries with persistent access will simply use a different remote access Trojan, an updated version of\nBlackEnergy 3, or an alternate mode of credential attacks. To detect and mitigate adversary movement\nthroughout an environment and account manipulation, mitigation efforts should be focused on directory (e.g.,\nActive Directory, Domain, eDirectory, and LDAP) segmentation with organizational unit trust models. This\napproach would allow early detection and prevent some basic attacker approaches.\n\n**Opportunities to Disrupt**\nMonitor user account behavior, network and system communication, and directory‐level activity with a focus on\nidentifying abnormalities. Implement alarm capabilities with different priority‐level alarms based on the risk of\nthe systems associated with the alarms. It is important to note that YARA is a forensics tool and is not a continuous\nmonitoring solution.\n\n##### Data Exfiltration\n\n**Ukraine Attack**\nAfter the attackers achieved the necessary freedom of movement and action in the IT infrastructure, they began\nexfiltrating the necessary information and discovering the hosts and devices to devise an attack concept to hijack\nthe SCADA DMS to open breakers and cause a power outage. They followed this with destructive attacks against\nworkstations, servers, and embedded devices that provide industrial communications in their distribution\nsubstations. The mitigation recommendation here is to understand where this type of information exists inside\nyour business network and ICSs. Minimizing where the information resides and controlling access is a priority for\nan ICS dependent organization.\n\n\n-----\n\n**Defense Lessons Learned – Passive and Active Defenses**\n\n**The Next Attack**\nAttackers may look deeper into the ICS configuration and settings or controller and protection/safety logic. Ensure\nto maintain a vaulted copy of known good project files, control and safety logic, and firmware. Also using file\nintegrity checkers to monitor access or sample loaded files for changes.\n\n**Opportunities to Disrupt**\nRealize that attackers may be able to develop additional attack approaches as they have learned a system and\nmay have stolen information that allows for the development of more powerful future attacks. Defenders should\nexamine their detection and response capabilities. Decision makers should review their restoration plans for\nattacks with the potential to go deeper into the ICS and could result in damaged equipment. Identify new\nconnections leaving the environment and previously unseen encrypted communications. Network Security\nMonitoring (NSM) is a great active defense method of detecting exfiltration and ending an adversary’s attack path\nbefore it disrupts the ICS.\n\n##### VPN Access\n\n**Ukraine Attack**\nMitigation guidance based on the attacker approach used in this campaign recommends using two‐factor\nauthentication with user tokens to strengthen authentication.\n\n**The Next Attack**\nAttackers may begin looking for existing point‐to‐point VPN implementations at trusted third party networks or\nthrough remote support employee connections where split tunneling is enabled. The immediate mitigation\nrecommendation is to implement trusted jump host or intermediary systems with Network Access Control (NAC)\nenforcement. Additionally, a VPN configuration approach that disables split tunneling should be enforced.\n\nOpportunities to Disrupt: Defenders are reminded that having remote access through a trusted\nconnection is advantageous for an attacker. Begin by asking why each trusted communication path exists,\nevaluate the risk, and eliminate each path that does not have an identified need that outweighs the risk of\nhaving an attack path. For those communication paths that must remain, consider implementing time of use\naccess for users. Implement the ability to disconnect these paths in an automated way after a defined period of\ntime after access in granted, and a method to disconnect manually if needed. From a passive defense\nperspective, force choke points in the environment by ensuring that the remote VPNs enter into the\nenvironment through a dedicated remote access DMZ. This ensures that traffic and connections can be\nmonitored by active defenders using techniques such as network security monitoring to identify abnormalities\nin duration of connections, number of connections, and time the connections occur.\n\n##### Workstation Remote Access\n\n**Ukraine Attack**\nBased on the details provided, the adversaries used the organizations’ workstations remotely (while the attacker\nwas physically remote, logically they were local to the host) to conduct Stage 2 of the attack. Mitigation\nrecommendations focus on disabling remote access at the host and at the perimeter firewall.\n\n\n-----\n\n**Defense Lessons Learned – Passive and Active Defenses**\n\n**The Next Attack**\nAdversaries may modify attack approaches to load additional remote access tools, utilize remote shell capabilities,\nand tunnel communications over authorized perimeter firewall communications. In response to this modified\nattack approach, mitigation efforts should focus on host based application aware firewalls, application\nwhitelisting, and configuration management efforts to identify changes in the operation of an asset. Application\nwhitelisting, if installed on the operator HMI to prevent installation of unauthorized remote access software, will\nnot aid in the prevention of authorized software. Also, keep in mind that specific control system vendors may not\napprove of the whitelisting software.\n\n**Opportunities to Disrupt**\nAs a defender prepares for a cyber asset within a trusted environment that may be compromised and remotely\ncontrolled, they must consider approaches to quickly move to a conservative operations environment where the\nability to issue control signals from untrusted assets is paused. Proper architecture would dictate the ability to\nsegment or disable activities such as remote connections, and unnecessary outbound communications, while\nconducting active defense mechanisms; such as incident response prior to restoring operational control\ncapabilities to known good assets.\n\n##### Control and Operate\n\n**Ukraine Attack**\nAs the attackers utilized the operator HMI’s, they operated numerous sites under the control of the dispatcher.\nMitigation approaches for this specific action would focus on application level logic requiring confirmation from\nthe operator, or implement Area of Responsibility (AoR) limitations that only allow an operator to effect certain\ncomponents of a system. For example: If an entity implemented AoR on one operator workstation that provided\neast breaker control, and a second operator workstation that provided West breaker control, then an adversary\npositioned on one workstation would be limited to the AoR allowed on that specific workstation. Some vendor\nsystems allow for Username determined AoR, Workstation determined AoR, and/or an intersection model that\ncombines username and workstation identifier in AoR authorization. There are variations amongst vendor systems\nin how authentication is handled within the local workstation, directory, or at the application.\n\n**The Next Attack**\nWhen an attacker identifies a workstation with application security controls in place that limits their capabilities,\nthey may modify their attack to control the system directly by issuing or injecting control commands. Mitigation\nstrategies for this approach would focus on communication path authentication or protocol authentication that\nwould require commands to be issued from an authorized asset. Monitoring communication sessions between\nhosts can lead to early detection and investigation of suspicious communications.\n\n**Opportunities to Disrupt**\nPreparing for adversarial utilization of cyber assets, or communication paths to control and operate elements of\nan ICS system, requires system defenders to develop a response approach that eliminates entire sections of cyber\nasset elements and networks in an effort to inhibit automated control and activate manual operations only. As\nadversaries learn the environment, they may issue test commands and interact with the SCADA environment\nwithout the intention to disrupt it. For mitigation purposes, defenders must talk to operators and ask about\nabnormal occurrences, and from a passive defense perspective, ensure that logs are collected not only from the\nhost but also from the SCADA applications. Additionally, implement a log aggregation architecture that replicates\nlog files from assets into a log correlation system. Finally, have active defenders routinely review these logs in\nconjunction with other monitoring activity throughout the ICS to identify abnormalities.\n\n\n-----\n\n**Defense Lessons Learned – Passive and Active Defenses**\n\n##### Tools and Technology impacts\n\n**Ukraine Attack**\nThe attackers used multiple approaches to impact communication tools, operator technology for restoration\nefforts, and facility infrastructure essential to many operator activities. Therefore, mitigation recommendations\nare varied. Items to focus on are:\n\n  - Establishing filtering and response capabilities at telecom providers to activate during an ongoing TDoS\nattack\n\n  - Disable remote management of field devices when they are not required.\n\n  - Disconnect building control infrastructure systems from the ICS network.\n\n  - Consider the number of spares required for embedded systems to regain required communication or\ncontrol/protection.\n\n**The Next Attack**\nA subsequent attack may progress from resource consumption to a more direct communication path outage that\naffects communication capabilities. To mitigate this approach, defenders need to establish alternate\ncommunications infrastructure for essential service capabilities.\n\nAfter an attacker identifies increased security requirements for field device management, they may attempt to\nestablish direct access to a field device through a local asset with connectivity or physical presence at the site for\ndirect firmware manipulation. Mitigation strategies for this attack approach focus on electronic and physical\naccess controls and the development of a rapid response capability during an attack or incident.\n\n**Opportunities to Disrupt**\nA determined adversary can impact remote assets either electronically or physically. A defender should develop\nstrong recovery and restoration approaches to replace mission‐critical cyber asset components. One option is to\nrely on inventory and mutual aid assistance from trusted peer organizations and/or suppliers. In cases where\nspecific assets are not immediately recoverable, it is necessary to develop the ability to operate the larger system\nwith operational islands that can be recovered in a timely manner.\n\nDefenders should have access to and visibility of the ICSs to be able to identify abnormal behavior around field\ndevice interaction. For example, uploading firmware outside of a scheduled downtime should be quickly\nobservable. Firmware modifications over the network cause spikes in network traffic that active defenders should\nbe consistently looking for. See Figure 10 for an example of a malicious firmware update to an industrial network\nswitch. Even without knowing the baseline of normal activity, which defenders should have, it can be trivial to\nspot firmware updates in network data.\n\n\n-----\n\n**Defense Lessons Learned – Passive and Active Defenses**\n\nFigure 10: Sample Network I/O Data from a Malicious Firmware Update to an Industrial Ethernet Switch[38]\n\n##### Respond and Restore\n\n**Ukraine Attack**\nThe cyber attacks performed against three Ukrainian oblenergos were well planned and highly coordinated. The\nattacks consisted of several major elements with both enabling and supporting attack segments. The attackers\nwere remote and interacted with multiple locations within each of their targets to include central and regional\nfacilities. Distribution utilities traditionally have both central business and engineering office(s) and a number of\nbranch facilities used to support line crew, meter reading, bill payment, and distributed supervisory control\noperations. Certain types of cyber attacks designed to maliciously take over and operate a SCADA DMS may be\nbest performed in a distributed fashion at the lowest or most direct level (from a local dispatch and SCADA server\nout to the substations that are being monitored and controlled). Preparing for a high‐tempo, multifaceted attack\nis not easy and it requires careful plan review, testing, integrated defense, and operations exercises. Rehearsing\nsteps to more quickly sever or prevent remote access, to safely separate the ICSs from connected networks, or to\ncontain and isolate suspicious hosts is critical.\n\n**The Next Attack**\nThe next attack may purposefully differ in its approach to throw off or defeat the defender’s plans and\nexpectations. It is critical that defenders exercise and train against different scenarios and be aware that attackers\nare co‐adaptive and creative. It is vital to develop capabilities with flexibility in mind.\n\n**Opportunities to Disrupt/Restore**\nOperations personnel must be involved in planning for restoration from a successful Stage 2 ICS attack. Concepts\nto consider from an electric operations and engineering perspective include the following and are graphically\ndepicted in Figure 11:\n\n  - Cyber contingency analysis: Continuous analysis and preparing the system for the next event.\n\n  - Cyber failure planning: Modeling and testing cyber system response to network and asset outages.\n\n  - Cyber conservative operations: Intentionally eliminating planned and unplanned changes as well as\nstopping any potentially impactful processes.\n\n38 For a good discussion on exploits and malicious firmware updates for industrial ethernet switches see the research by Eireann Leverett,\nColin Cassidy, and Robert M. Lee in the DEFCON presentation “Switches Get Stitches” here:\n[https://www.youtube.com/watch?v=yaY3rtA37Uc](http://www.youtube.com/watch?v=yaY3rtA37Uc)\n\n\n-----\n\n**Defense Lessons Learned – Passive and Active Defenses**\n\n- Cyber load shed: Eliminating unnecessary network segments, communications, and cyber assets that are\nnot operationally necessary.\n\n- Cyber Root Cause Analysis (RCA) : RCA forensics to determine how an impactful event occurred and ensure\nit is contained.\n\n- Cyber Blackstart: Cyber asset base configurations and bare metal build capability to restore the cyber\nsystem to a critical service state.\n\n- Cyber mutual aid: Ability to utilize information sharing and analysis centers (ISACs), peer utilities, law\nenforcement and intelligence agencies, as well as contractors and vendors to respond to large‐scale\nevents.\n\nFigure 11: Summary of the opportunities to disrupt the attack\n\n\n-----\n\n#### Recommendations\n\n##### Architecture\nRecommendations:\n\n  - Properly segment networks from each other.\n\n  - Ensure logging is enabled on devices that support it, including both IT and Operational Technology (OT)\nassets.\n\n  - Ensure that network architecture, such as switches, are managed and have the ability to capture data\nfrom the environment to support Passive and Active Defense mechanisms.\n\n  - Make backups of critical software installers and include an MD5 and SHA256 digital hash of the\ninstallers.\n\n  - Collect and vault backup project files from the network.\n\n  - Test the tools and technologies that passive and active defense mechanisms will need (such as digital\nimaging software) on the environment to ensure that it will not negatively impact systems.\n\n  - Prioritize and patch known vulnerabilities based on the most critical assets in the organization.\n\n  - Limit remote connections only to personnel that need them. When personnel need remote access,\nensure that if they do not need control that they do not have access to control elements. Use two‐form\nauthentication on the remote connections.\n\n  - Consider use of a system event monitoring system, configured and monitored specifically for high‐value\nICS/SCADA systems.\n\n##### Passive Defense\nRecommendations:\n\n  - Application whitelisting can help limit adversary initial infection vectors and should be used when not\ntoo invasive to the ICSs.\n\n  - DMZs and properly tuned firewalls between network segments will give visibility into the environment\nand allow defenders the time required to identify intrusions.\n\n  - Establish a central logging and data aggregation point to allow forensic evidence to be collected and\nmade available to defenders.\n\n  - Implement alarm package priorities for abnormal cyber events within the control system.\n\n  - Enforce a password reset policy in the event of a compromise especially for VPNs and administrative\naccounts.\n\n  - Utilize up‐to‐date antivirus or endpoint security technologies to allow for the denial of known malware.\n\n  - Configure an intrusion detection system so that rules can be quickly deployed to search for intruders.\n\n\n-----\n\n##### Active Defense\nRecommendations:\n\n  - Train defenders to hunt for odd communications leaving the networked environment such as new IP\ncommunications.\n\n  - Perform network security monitoring to continuously search through the networked environment for\nabnormalities.\n\n  - Plan and train to incident response plans that incorporate both the IT and OT network personnel.\n\n  - Consider active defense models for security operations such as the active cyber defense cycle.\n\n  - Ensure that personnel performing analysis have access to technologies such as sandboxes to quickly\nanalyze incoming phishing emails or odd files and extract indicators of compromise (IOCs) to search for\ninfected systems.\n\n  - Use backup and recovery tools to take digital images from a few of the systems in the supervisory\nenvironment such as HMIs and data historian systems every 6‐12 months. This will allow a baseline of\nactivity to be built and make the images available for scanning with new IOCs such as new YARA rules\non emerging threats.\n\n  - Train defenders on using tools such as YARA to scan digital images and evidence collected from the\nenvironment but do not perform the scans in the production environment itself.\n\nGood architecture and passive defense practices build a defensible ICS; active defense processes establish a\ndefended ICS environment. Countering flexible and persistent human adversaries requires properly trained and\nequipped human defenders.\n\n\n-----\n\n#### Implications and Conclusion\n\n##### Implications for Defenders\nThe remote cyber attacks directed against Ukraine’s electricity infrastructure were bold and successful. The cyber\noperation was highly synchronized and the adversary was willing to maliciously operate a SCADA system to cause\npower outages, followed by destructive attacks to disable SCADA and communications to the field. The destructive\nelement is the first time the world has seen this type of attack against OT systems in a nation’s critical\ninfrastructure. This is an escalation from past destructive attacks that impacted general‐purpose computers and\nservers (e.g., Saudi Aramco, RasGas, Sands Casino, and Sony Pictures). Several lines were crossed in the conduct\nof these attacks as the targets can be described as solely civilian infrastructure. Historic attacks, such as Stuxnet,\nwhich included destruction of equipment in the OT environment, could be argued as being surgically targeted\nagainst a military target.\n\nInfrastructure defenders must be ready to confront highly targeted and directed attacks that include their own\nICSs being used against them, combined with amplifying attacks to deny communication infrastructure and future\nuse of their ICSs. The elements analyzed in the attack indicated that there was a specific sequence to the misuse\nof the ICSs, including preventing further defender use of the ICSs to restore the system. This means that the\nattacker “burned the bridges” behind them by destroying equipment and wiping devices to prevent automated\nrecovery of the system. The attacks highlight the need to develop active cyber defenses, capable and well‐\nexercised incident response plans, and resilient operations plans to survive a sophisticated attack and restore the\nsystem.\n\nNothing about the attack in Ukraine was inherently specific to Ukrainian infrastructure. The impact of a similar\nattack may be different in other nations, but the attack methodology, Tactics, Techniques, and Procedures (TTPs)\nobserved are employable in infrastructures around the world.\n\n##### Conclusion\nWe have identified five themes for defenders to focus on as they consider what this attack means for their\norganization:\n\n**Theme 1**\nAs defenders of ICSs, consider the sequence of events taken by the adversary in the months leading up to\nDecember 23, 2015 when this cyber operation targeting Ukrainian electricity infrastructure was planned and\ndeveloped. The operation relied upon intrusions that appear to have come from a broader access campaign\nconducted in the spring of 2015. In a prolonged attack campaign, there are likely numerous opportunities to detect\nand defend the targeted system. The two‐stage ICS cyber kill chain helps note that in an ICS environment, there\nis an increased window for the detection and identification of the most concerning attack types.\n\n**Theme 2**\nThe cyber attacks were conducted within minutes of each other against three oblenergos, resulting in power\noutages affecting approximately 225,000 customers for a few hours. While the total number of customers across\nthree service territories does not add up to a significant number of customers or load across Ukraine, there may\nbe significance in target selection or specific loads. One critical element of this particular attack was its coordinated\nnature affecting three target entities and the thoroughness of the adversary sequence of events in achieving their\ngoals. Important opportunities for defenders to disrupt the adversary’s sequence of events were identified.\n\n**Theme 3**\nThe cyber attacks were mislabeled as solely linked to BlackEnergy 3 and KillDisk. BlackEnergy 3 was simply a tool\nused in Stage 1 of the attacks and KillDisk was an amplifying tool used in Stage 2 of the attacks. BlackEnergy 3\n\n\n-----\n\nmalware was used to gain initial footholds into a multitude of organizations within Ukraine and not just the three\nimpacted oblenergos. It is unknown if the adversary had planned to use this access campaign to enable their\noperation or if achieving access was the motivation leading to the development of a concept to attack the power\nsystem.\n\nExcessive focus on the specific malware used in this attack places defenders into a mindset in which they are\nsimply waiting for guidance on the specific attack components so they can eliminate them. This attack could have\nbeen enabled by a variety of approaches to gain access and utilize existing assets within a target environment.\nRegardless of the initial attack vector, the ICS tools and environment were ultimately used to achieve the desired\neffect, not the BlackEnergy 3 malware.\n\n**Theme 4**\nThe attack concept had to be able to work across multiple SCADA DMS implementations and target common\nsusceptible elements, such as storage overwrites for Windows‐based operating system workstations and servers.\nThe attackers likely developed destructive firmware overwrite techniques after discovering accessible embedded\nsystems. There was likely a significant amount of unobservable adversarial testing performed prior to introducing\nthe attack into the environment. Many capabilities were demonstrated throughout this attack, and they all\nprovide specific lessons learned for defenders to take action on.\n\n**Theme 5**\nInformation sharing is key in the identification of a coordinated attack and directing appropriate response actions.\nWithin the Ukraine, an organization with the ability to enable appropriate information sharing and provide\nincident response guidance should be pursued. In the United States and other countries with established\ninformation sharing mechanisms, such as ISACs (Information Sharing and Analysis Centers), the focus should be\non maintaining and improving the information provided by asset owners and operators. This increased data\nsharing will enhance situation awareness within the sector, which will in turn lead to earlier attack detection and\nfacilitate incident response.\n\nIn many ways, the Ukrainian oblenergos and their staff, as well as the involved Ukrainian government members\ndeserve congratulations. This attack was a world first in many ways, and the Ukrainian response was impressive\nwith all aspects considered.\n\nAs the investigation and analysis of technical data continues and more information regarding this attack surfaces,\nthe authors of this DUC will update this report where appropriate in an effort to maintain the most accurate and\nbeneficial guidance document possible for ICS defenders. The E‐ISAC will continue to provide credible reporting\nand guidance as well.\n\n\n-----\n\n#### Appendix Information Evaluation\n\n##### Credibility: 5[39]\nThe claims by the Ukrainian government that outages in the service territory of the targeted electricity companies\nwere caused by a series of cyber attacks have been confirmed. The claim was originally met with private skepticism\nby the SANS ICS team as ICS organizations frequently have reliability issues and incorrectly blame cyber\nmechanisms such as malware found on the network that is unrelated to the outage. Early reporting on incidents\nis often rushed and stressful which leads to inaccurate claims. However, in the Ukrainian case, there is a large\namount of evidence available; including malware samples, interviews with operators present during the incident,\nand confirmation by multiple private companies involved in the incident. Lastly, the U.S. government has since\nalso confirmed the attacks due to their own investigation.\n\nThe most recent report released from DHS ICS‐CERT[40 ] cites direct interviews with “operations and information\ntechnology staff and leadership at six Ukrainian organizations with first‐hand experience of the event.” Based on\nthe information provided in the report,[41 ] the U.S. delegation interviewed and considered information from the\nthree impacted organizations as well as others. The format of the interviews, and asset owner and operator\ndiscussions, indicated that “the team was not able to independently review technical evidence of the cyber‐attack.\nHowever, a significant number of independent reports from the team’s interviews as well as documentary findings\ncorroborate the events…”.[42 ] However, a large amount of technical information was made available to the larger\ncommunity including indicators of compromise, malware samples, technical information about the ICS itself and\nits components, and some samples of logs from the SCADA environment.[43 ] The majority of sources to date have\nrelied upon initial attempts by Ukrainian power entities to inform customers about the cause of the outage and\nsources derived from interviews with impacted entities. The DHS report does not attempt to assign attacker\nattribution and neither will this DUC.\n\n##### Amount of Technical Information Available: 4[44]\nA score of 4 has been assigned for the technical information available due to the fact that malware samples,\nobservable ICS impacts, technical indicators of compromise, and first hand interviews were available. The\ninvestigation also included a joint working group between the Ukrainian government, impacted oblenergos, and\nU.S. government representatives starting on January 18, 2016.[45 ]This amount of information was sufficient to\nconfirm the attacks.\n\nHowever, it should be noted that there may be pieces of information missing due to the lack of visibility in various\nparts of the ICS network. As an example, packet captures from the network during the attack and field device\n\n38 Credibility of the information is rated in a scale from [0] Cannot be determined, [1] Improbable, [2] Doubtful, [3] Possibly true, [4]\nProbably true, [5] Confirmed\n\n[39 https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-01](https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-01)\n\n40 SANS ICS team members have been able to view technical data in both public and non‐government private channels to confirm the\nexistence of forensic data and the core components of the analysis based off of the data.\n\n41 https://ics-cert.us-cert.gov/alerts/IR-ALERT-H-16-056-01\n42 It should be noted that many in the community would like access to internal forensic logs of the impacted oblenergos. This is an\nunderstandable request but it is extremely rare for impacted organizations to make such information publicly available. SANS ICS team\nmembers have been able to view technical data in both public and non‐government private channels to confirm the existence of forensic\ndata and the core components of the analysis based off of the data.\n44 Amount of Technical Information Available is an analyst’s evaluation and description of the details available to deconstruct the attack\nprovided with a rating scale from [0] No specifics, [1] high‐level summary only, [2] Some details, [3] Many details, [4] Extensive details, [5]\nComprehensive details with supporting evidence\n[45http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=24508688](http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886&cat_id=35109)\n[6&cat_id=35109](http://mpe.kmu.gov.ua/minugol/control/uk/publish/article;jsessionid=CE1C739AA046FF6BA00FE8E8A4D857F3.app1?art_id=245086886&cat_id=35109)\n\n\n-----\n\nlogging were not available. With this information even more about the technical minutia of the attack would be\navailable. The amount of information available as well as the willingness by the impacted oblenergos and\nUkrainian government to share that information publicly was the most seen to date for a confirmed intentional\ncyber attack that impacted the operations of an ICS.\n\nWhen considering the technical information provided, the authors of this DUC have considered the larger public\nreporting of electricity customer outages within Ukraine as a component of the validation and evidence necessary\nto demonstrate the attacker effects to the electricity system. The official public alert by DHS corroborates prior\nreporting and is based on interviews and information exchanged with the impacted organizations.\n\n\n-----\n\n##### National Security Archive, \n\n Suite 701, Gelman Library, The George Washington University, \n\n 2130 H Street, NW, Washington, D.C., 20037, \n\n Phone: 202/994‐7000, Fax: 202/994‐7005, nsarchiv@gwu.edu\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://nsarchive.gwu.edu/sites/default/files/documents/3891751/SANS-and-Electricity-Information-Sharing-and.pdf"
    ],
    "report_names": [
        "SANS-and-Electricity-Information-Sharing-and.pdf"
    ],
    "threat_actors": [
        {
            "id": "6dbdb9e4-3569-404a-8a25-e8ce65994281",
            "created_at": "2023-01-06T13:46:38.380071Z",
            "updated_at": "2025-03-27T02:00:02.818889Z",
            "deleted_at": null,
            "main_name": "Sands Casino",
            "aliases": [],
            "source_name": "MISPGALAXY:Sands Casino",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1698804280,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1499715111,
    "ts_modification_date": 1499715111,
    "files": {
        "pdf": "https://archive.orkl.eu/5247780681d6c50b9969160fdd0b9cdff8e0f06f.pdf",
        "text": "https://archive.orkl.eu/5247780681d6c50b9969160fdd0b9cdff8e0f06f.txt",
        "img": "https://archive.orkl.eu/5247780681d6c50b9969160fdd0b9cdff8e0f06f.jpg"
    }
}