{
    "id": "515ef0b7-9f56-41d2-9ec6-c5fade729565",
    "created_at": "2023-01-12T15:00:37.983386Z",
    "updated_at": "2025-03-27T02:09:07.918741Z",
    "deleted_at": null,
    "sha1_hash": "c4dc72f068a431dcf83a80c2f5c979f66c7b2f73",
    "title": "2022-05-19 - Threat Update- AcidRain Wiper",
    "authors": "",
    "file_creation_date": "2022-06-01T12:23:50Z",
    "file_modification_date": "2022-06-01T12:23:50Z",
    "file_size": 1978419,
    "plain_text": "# Threat Update: AcidRain Wiper\n\n**[splunk.com/en_us/blog/security/threat-update-acidrain-wiper.html](https://www.splunk.com/en_us/blog/security/threat-update-acidrain-wiper.html)**\n\nMay 19, 2022\n\nBy [Splunk Threat Research Team May 19, 2022](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)\n\n[The Splunk Threat Research Team has addressed a new malicious payload named AcidRain.](https://www.sentinelone.com/labs/acidrain-a-modem-wiper-rains-down-on-europe/)\nThis payload, deployed in the ongoing conflict zone of Eastern Europe, is designed to wipe\n[modem or router devices (CPEs). These devices provide internet connectivity and are usually](https://en.wikipedia.org/wiki/Customer-premises_equipment)\nbased on specific architectures such as Microprocessor without Interlocked Pipeline Stages\n\n\n-----\n\n[(MIPS), a type of processor architecture prevalent in CPEs which are devices designed to do](https://en.wikipedia.org/wiki/MIPS_architecture)\nspecific functions unlike computer desktops or servers. This payload has been designed to\ndestroy these types of devices, which are commonly used in commercial and residential\ninfrastructure.\n\nTargeting MIPS devices also indicates the interest of actors in affecting targets (CPEs) in large\namounts to cause massive damage and harm to commercial and residential infrastructure. It is\n[being said that this payload targeted Satellite Modems affecting](https://www.bleepingcomputer.com/news/security/viasat-confirms-satellite-modems-were-wiped-with-acidrain-malware/) [5800 Wind Turbines. Targeting](https://www.reuters.com/business/energy/satellite-outage-knocks-out-control-enercon-wind-turbines-2022-02-28/)\nCPEs is not new and it's always a factor in very large DDoS campaigns as they usually provide\nconnectivity and can be used in an aggregate manner in order to produce large attacks. The\nsame can be said about destroying them, neutralizing anything dependent on connectivity and\naffecting related services. Most of these devices are of civilian use in nature and its destruction\naffects civilian livelihood as well.\n\nAcidRain is MIPS compile elf binary targeting modem or router devices to destroy or wipe data.\n\n## Initial Checking\n\nAt first this payload will execute fork() function and if a “dev/null” file exists; if this event check\nfails, it will either exit or close its execution. Else it will create a process session using setsid()\nfunction and duplicate its file descriptor. Below is the code screenshot of how this initial checking\nwas made by AcidRain malware.\n\n## Skipping Common Linux Directory\n\nIt has a function that will be executed to enumerate and skip some non-standard directory in the\ncompromised host. If the directory it found is not in the list of folder names shown in the\nscreenshot below, that folder path will be passed on to the function that we renamed as\nrecursive_wiper() to be processed.\n\n\n-----\n\nThe recursive_wiper() function will enumerate all the directories and files on the said chosen\ndirectory. If during enumeration it found a regular file (DT_REG) or symbolic link (DT_LNK) it will\noverwrite it with initialized data with size of 0x8000 bytes. If it is another directory, it will traverse\nall the files on that folder path, wipe it, then delete that directory using rmdir() function.\n\n\n-----\n\n## Admin Checks\n\nBefore the admin checking, it will allocate a mem buffer using malloc() function with a size of\n0x40000 that will be used to wipe all the files it will find.\n\nThen It will check if the login user in the compromised host is root or not using the getuid()\nfunction. it will execute the mw_wipe_non_common_lnx_dir() that was discussed earlier and a\nseries of functions to wipe or destroy device files related to the router or modem, then reboot the\nsystem. Below is the screenshot of its code. How it checks if the user is admin and wipes files\nand storage device files related to router or modem.\n\n\n-----\n\nBelow is the table of the function we renamed during our analysis and what device files it tries to\ndestroy or to wipe that are related to either router's flash memory, sd/mmc memory card and\nblock devices .\n\n**Function name** **Targeted Device File**\n\n**mw_wipe_dev_sd()** **/dev/sda until /dev/sdzz**\n\n\n-----\n\nmw_wipe_dev_block_mtdblocks() /dev/mtdblock*\n/dev/block/mtdblock*\n\nmw_wipe_dev_block_mmcblk() /dev/mmcblk*\n/dev/block/mmcblk*\n\nmw_wipe_dev_mtd() /dev/mtd*\n\nmw_wipe_dev_loop() /dev/loop*\n\n## Wiper Feature\n\nFor overwriting or wiping device storage files, it has 2 functions to do it. One is overwriting those\ndevice files with a data buffer with a maximum 0x40000 initialized bytes buffer as seen in the\nscreenshot below (left). For “/dev/mtd*”, it will use a series of ioctl commands to erase its data\nnamely MEMUNLOCK, MEMERASE, MEMLOCK and MEMWRITEOOB. The code showing how\nAcidRain malware does it is shown below too (right).\n\n\n-----\n\nBelow are the screenshots showing our test of how it overwrites or wipes the /dev/mtdblock0\ndevice file during running its payload.\n\nThe first one is the strace logs showing how it writes to /dev/mtdblock0 device storage file with its\ninitialized buffer that wipes that files.\n\nThe next one is the hex view snippet of some of the device storage files after the execution of\nthe AcidRain malware wiper.\n\n\n-----\n\n## Detections\n\nBelow is the detection made for AcidRain malware in a ubuntu linux machine with the use of\nqemu-mips emulator.\n\n### Linux High Frequency Of File Deletion In Etc Folder\n\nThis analytic looks for a high frequency of file deletion relative to process name and process id\n/etc/ folder.\n\n\n-----\n\n```\n| tstats security_content_summariesonly values(Filesystem.file_name) as\ndeletedFileNames values(Filesystem.file_path) as deletedFilePath dc(Filesystem.file_path)\nas numOfDelFilePath count min(_time) as firstTime max(_time) as lastTime \n FROM datamodel=Endpoint.Filesystem \n where Filesystem.action=deleted Filesystem.file_path = \"/etc/*\" \n by _time span=1h Filesystem.dest Filesystem.process_guid Filesystem.action \n | `drop_dm_object_name(Filesystem)` \n |rename process_guid as proc_guid \n |join proc_guid, _time [\n | tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where\nProcesses.parent_process_name != unknown \n NOT (Processes.parent_process_name IN (\"/usr/bin/dpkg\", \"*usr/bin/python*\",\n\"*/usr/bin/apt-*\", \"/bin/rm\", \"*splunkd\", \"/usr/bin/mandb\")) \n by _time span=1h Processes.process_id Processes.process_name Processes.process\nProcesses.dest Processes.parent_process_name Processes.parent_process\nProcesses.process_path Processes.process_guid \n | `drop_dm_object_name(Processes)` \n |rename process_guid as proc_guid \n | fields _time dest user parent_process_name parent_process process_name process_path\nprocess proc_guid registry_path registry_value_name registry_value_data registry_key_name\naction] \n | table process_name process proc_guid action _time deletedFileNames deletedFilePath\nnumOfDelFilePath parent_process_name parent_process process_path dest user\n | where numOfDelFilePath >= 200\n\n```\n**Linux Deletion Of Cron Jobs**\n\nThis analytic looks for a deletion of cron jobs in a linux machine. can be related to an attacker,\nthreat actor or malware to disable scheduled cron jobs that might be related to security or to\nevade some detections or a good indicator for malware that is trying to wipe or delete several\n\n\n-----\n\nfiles on the compromised host like the AcidRain malware.\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as\nlastTime FROM datamodel=Endpoint.Filesystem \n where Filesystem.action=deleted Filesystem.file_path =\"/etc/cron.*\" \n by _time span=1h Filesystem.file_name Filesystem.file_path Filesystem.dest\nFilesystem.process_guid Filesystem.action\n | `drop_dm_object_name(Filesystem)` \n |rename process_guid as proc_guid \n |join proc_guid, _time [\n | tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where\nProcesses.parent_process_name != unknown \n by _time span=1h Processes.process_id Processes.process_name Processes.process\nProcesses.dest Processes.parent_process_name Processes.parent_process\nProcesses.process_path Processes.process_guid \n | `drop_dm_object_name(Processes)` \n |rename process_guid as proc_guid \n | fields _time dest user parent_process_name parent_process process_name process_path\nprocess proc_guid registry_path registry_value_name registry_value_data registry_key_name\naction] \n | table process_name process proc_guid file_name file_path action _time\nparent_process_name parent_process process_path dest user\n\n## Linux Deletion of Init Daemon Script\n\n```\nThis analytic looks for a deletion of init daemon script in a linux machine.daemon script that is\nplaced in /etc/init.d/ is a directory that can start and stop some daemon services in linux\nmachines.This TTP can be also a good indicator of a malware trying to wipe or delete several\nfiles like AcidRain malware.\n\n\n-----\n\n```\n| tstats security_content_summariesonly count min(_time) as firstTime max(_time) as\nlastTime FROM datamodel=Endpoint.Filesystem \n where Filesystem.action=deleted Filesystem.file_path IN ( \"/etc/init.d/*\") \n by _time span=1h Filesystem.file_name Filesystem.file_path Filesystem.dest\nFilesystem.process_guid Filesystem.action\n | `drop_dm_object_name(Filesystem)` \n |rename process_guid as proc_guid \n |join proc_guid, _time [\n | tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where\nProcesses.parent_process_name != unknown \n by _time span=1h Processes.process_id Processes.process_name Processes.process\nProcesses.dest Processes.parent_process_name Processes.parent_process\nProcesses.process_path Processes.process_guid \n | `drop_dm_object_name(Processes)` \n |rename process_guid as proc_guid \n | fields _time dest user parent_process_name parent_process process_name process_path\nprocess proc_guid registry_path registry_value_name registry_value_data registry_key_name\naction] \n | table process_name process proc_guid file_name file_path action _time\nparent_process_name parent_process process_path dest user\n\n## Linux Deletion of SSL Certificate\n\n```\nThis analytic looks for a deletion of ssl certificate in a linux machine. attacker may delete or\nmodify ssl certificate to impair some security features or act as defense evasion in a\ncompromised linux machine. This Anomaly can be also a good indicator of a malware trying to\n\n\n-----\n\nwipe or delete several files in a compromised host as part of its destructive payload like what\nAcidRain malware does in linux or router machines.\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as\nlastTime FROM datamodel=Endpoint.Filesystem \n where Filesystem.action=deleted Filesystem.file_path = \"/etc/ssl/certs/*\"\nFilesystem.file_path IN (\"*.pem\", \"*.crt\")\n by _time span=1h Filesystem.file_name Filesystem.file_path Filesystem.dest\nFilesystem.process_guid Filesystem.action\n | `drop_dm_object_name(Filesystem)` \n |rename process_guid as proc_guid \n |join proc_guid, _time [\n | tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where\nProcesses.parent_process_name != unknown \n by _time span=1h Processes.process_id Processes.process_name Processes.process\nProcesses.dest Processes.parent_process_name Processes.parent_process\nProcesses.process_path Processes.process_guid \n | `drop_dm_object_name(Processes)` \n |rename process_guid as proc_guid \n | fields _time dest user parent_process_name parent_process process_name process_path\nprocess proc_guid registry_path registry_value_name registry_value_data registry_key_name\naction] \n | table process_name process proc_guid file_name file_path action _time\nparent_process_name parent_process process_path dest user \n\n## Linux Deletion of SSH Key\n\n```\n\n-----\n\nThis analytic looks for a deletion of ssh key in a linux machine.This Anomaly can be also a good\nindicator of a malware trying to wipe or delete several files in a compromised host as part of its\ndestructive payload like what AcidRain malware does in linux or router machines.\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as\nlastTime FROM datamodel=Endpoint.Filesystem \n where Filesystem.action=deleted Filesystem.file_path = \"/etc/ssh/*\" AND\nFilesystem.file_path = \"~/.ssh/*\" by _time span=1h Filesystem.file_name\nFilesystem.file_path Filesystem.dest Filesystem.process_guid Filesystem.action\n | `drop_dm_object_name(Filesystem)` \n |rename process_guid as proc_guid \n |join proc_guid, _time [\n | tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where\nProcesses.parent_process_name != unknown \n by _time span=1h Processes.process_id Processes.process_name Processes.process\nProcesses.dest Processes.parent_process_name Processes.parent_process\nProcesses.process_path Processes.process_guid \n | `drop_dm_object_name(Processes)` \n |rename process_guid as proc_guid \n | fields _time dest user parent_process_name parent_process process_name process_path\nprocess proc_guid registry_path registry_value_name registry_value_data registry_key_name\naction] \n | table process_name process proc_guid file_name file_path action _time\nparent_process_name parent_process process_path dest user\n\n## Linux Deletion of Services\n\n```\nThis analytic looks for the deletion of services in a linux machine, attacker may delete or modify\nservices to impair some security features or act as defense evasion in a compromised linux\nmachine. This TTP can be also a good indicator of a malware trying to wipe or delete several\n\n\n-----\n\nfiles in a compromised host as part of its destructive payload like what AcidRain malware does\nin linux or router machines.\n```\n| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as\nlastTime FROM datamodel=Endpoint.Filesystem \n where Filesystem.action=deleted Filesystem.file_path IN ( \"/etc/systemd/*\",\n\"/usr/lib/systemd/*\") Filesystem.file_path = \"*.service\" \n by _time span=1h Filesystem.file_name Filesystem.file_path Filesystem.dest\nFilesystem.process_guid Filesystem.action\n | `drop_dm_object_name(Filesystem)` \n |rename process_guid as proc_guid \n |join proc_guid, _time [\n | tstats `security_content_summariesonly` count FROM datamodel=Endpoint.Processes where\nProcesses.parent_process_name != unknown \n by _time span=1h Processes.process_id Processes.process_name Processes.process\nProcesses.dest Processes.parent_process_name Processes.parent_process\nProcesses.process_path Processes.process_guid \n | `drop_dm_object_name(Processes)` \n |rename process_guid as proc_guid \n | fields _time dest user parent_process_name parent_process process_name process_path\nprocess proc_guid registry_path registry_value_name registry_value_data registry_key_name\naction] \n | table process_name process proc_guid file_name file_path action _time\nparent_process_name parent_process process_path dest user\n\n```\n**Name** **Technique ID** **Tactic** **Description**\n\n\n-----\n\nLinux High Frequency\nOf File Deletion In Etc\nFolder(New)\n\nLinux Deletion Of Init\nDaemon Script(New)\n\nLinux Deletion of SSL\nCertificate(New)\n\nLinux deletion Of SSH\nKey(New)\n\nLinux Deletion Of\nServices(New)\n\nLinux Deletion Of Cron\nJobs(New)\n\n### IOC:\n\n\n[T1485,T1070.004](https://attack.mitre.org/techniques/T1485) Defense\nEvasion,\nImpact\n\n[T1485,T1070.004](https://attack.mitre.org/techniques/T1485) Defense\nEvasion,\nImpact\n\n[T1485,T1070.004](https://attack.mitre.org/techniques/T1485) Defense\nEvasion,\nImpact\n\n[T1485,T1070.004](https://attack.mitre.org/techniques/T1485) Defense\nEvasion,\nImpact\n\n[T1485,T1070.004](https://attack.mitre.org/techniques/T1485) Defense\nEvasion,\nImpact\n\n[T1485,T1070.004](https://attack.mitre.org/techniques/T1485) Defense\nEvasion,\nImpact\n\n\nThis analytic looks for a high\nfrequency of file deletion relative to\nprocess name and process id /etc/\nfolder.\n\nThis analytic looks for deletion of init\ndaemon script in a linux machine.\n\nThis analytic looks for deletion of ssl\ncertificate in a linux machine.\n\nThis analytic looks for a deletion of\nssh key in a linux machine.\n\nThis analytic looks for a deletion of\nservices in a linux machine.\n\nThis analytic looks for a deletion of\ncron jobs in a linux machine.\n\n\n**Filename** **Size** Sha256\n\n\nacid_rain.elf 22656\nbytes\n(22\nKiB)\n\n## Mitigation\n\n\n9b4dfaca873961174ba935fddaf696145afe7bbf5734509f95feb54f3584fd9a\n\n\nMitigating these types of payloads can be very difficult. Due to their simplicity and small footprint,\nmany of these devices do not have the ability to implement centralized logging that may allow\ndefenders to detect attacks. In many instances, due to lack of standardization, many of these\ndevices have unpatched vulnerabilities or libraries that are waiting to be exploited by malicious\nactors.\n\n\n-----\n\nConsidering that many of these devices may be used by personnel working from home for\nenterprises or even military, it is necessary to understand that these vulnerabilities expose such\nperimeters to attack and that if it is not possible to monitor, upgrade or even verify integrity of\nthese devices, the best course of action is to replace them with devices that allow integrity\nverification and monitoring.\n\nDiscarding these devices may be needed as infection may indeed survive reboot or reset. Even\nif devices are not affected by this payload, an advanced adversary will find ways of targeting\nthem due to the large amount of resources they can provide once compromised. Please follow\nthe following links for specific information on hardening security.\n\n[CISA Home Network Security Guide (ST15-002)](https://www.cisa.gov/uscert/ncas/tips/ST15-002)\n[CISA Securing Network Infrastructure Devices (ST18-001)](https://www.cisa.gov/uscert/ncas/tips/ST18-001)\nNSA - [Protecting VSAT Communications](https://media.defense.gov/2022/May/10/2002993519/-1/-1/0/CSA_PROTECTING_VSAT_COMMUNICATIONS_05102022.PDF)\n\n## Learn More\n\n[You can find the latest content about security analytic stories on GitHub and in Splunkbase.](https://github.com/splunk/security-content/releases/tag/v3.12.0)\n[Splunk Security Essentials also has all these detections available via push update. In the](https://splunkbase.splunk.com/app/3435/)\nupcoming weeks, the Splunk Threat Research Team will be releasing a more detailed blog post\non this analytic story. Stay tuned!\n\nFor a full list of security content, check out the [release notes on](https://docs.splunk.com/Documentation/ESSOC/3.21.0/RN/Enhancements) [Splunk Docs.](https://docs.splunk.com/Documentation/ESSOC)\n\n## Feedback\n\nAny feedback or requests? Feel free to put in an issue on GitHub and we’ll follow up.\nAlternatively, join us on the [Slack channel #security-research. Follow these instructions If you](https://splunk-usergroups.slack.com/)\nneed an invitation to our Splunk user groups on Slack.\n\nWe would like to thank the following for their contributions to this post.\n\nTeoderick Contreras\nRod Soto\nJose Hernandez\nPatrick Barreiss\nLou Stella\nMauricio Velazco\nMichael Haag\nBhavin Patel\nEric McGinnis\n\n\n-----\n\nPosted by\n\n**[Splunk Threat Research Team](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)**\n\nThe Splunk Threat Research Team is an active part of a customer’s overall defense strategy by\nenhancing Splunk security offerings with verified research and security content such as use\ncases, detection searches, and playbooks. We help security teams around the globe strengthen\noperations by providing tactical guidance and insights to detect, investigate and respond against\nthe latest threats. The Splunk Threat Research Team focuses on understanding how threats,\nactors, and vulnerabilities work, and the team replicates attacks which are stored as datasets in\nthe [Attack Data repository.](https://github.com/splunk/attack_data/)\n\nOur goal is to provide security teams with research they can leverage in their day to day\noperations and to become the industry standard for SIEM detections. We are a team of industryrecognized experts who are encouraged to improve the security industry by sharing our work\nwith the community via conference talks, open-sourcing projects, and writing white papers or\nblogs. You will also find us presenting our research at conferences such as Defcon, Blackhat,\nRSA, and many more.\n\n[Read more Splunk Security Content.](https://github.com/splunk/security_content)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-19 - Threat Update- AcidRain Wiper.pdf"
    ],
    "report_names": [
        "2022-05-19 - Threat Update- AcidRain Wiper.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535637,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1654086230,
    "ts_modification_date": 1654086230,
    "files": {
        "pdf": "https://archive.orkl.eu/c4dc72f068a431dcf83a80c2f5c979f66c7b2f73.pdf",
        "text": "https://archive.orkl.eu/c4dc72f068a431dcf83a80c2f5c979f66c7b2f73.txt",
        "img": "https://archive.orkl.eu/c4dc72f068a431dcf83a80c2f5c979f66c7b2f73.jpg"
    }
}