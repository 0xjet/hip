{
    "id": "5c5a04c8-6784-4d23-9e38-97272b303bf6",
    "created_at": "2022-10-25T16:48:23.191159Z",
    "updated_at": "2025-03-27T02:16:08.447485Z",
    "deleted_at": null,
    "sha1_hash": "b6d1d7e93428e9ee1d8ce9ca8d21cad84c983077",
    "title": "Double the Infection, Double the Fun",
    "authors": "",
    "file_creation_date": "2018-10-16T02:01:57Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 225922,
    "plain_text": "# Double the Infection, Double the Fun\n\n**[asert.arbornetworks.com/double-the-infection-double-the-fun/](https://asert.arbornetworks.com/double-the-infection-double-the-fun/)**\n\n[ASERT team on August 30, 2018.](https://asert.arbornetworks.com/author/asert-team/)\n\n# Executive Summary\n\nCobalt Group (aka TEMP.Metastrike), active since at least late 2016, have been suspected\nin attacks across dozens of countries. The group primarily targets financial organizations,\noften with the use of ATM malware. Researchers also believe they are responsible for a\nseries of attacks on the SWIFT banking system which costs millions in damages to the\nimpacted entities.\n\nOn August 13, ASERT observed the financially-motivated hacking group actively pushing a\nnew campaign. We believe the targeted institutions for the ongoing campaign are located\nin eastern Europe and Russia. The active campaigns utilize spear phishing messages to\ngain entry. The emails appear to come from a financial vendor or partner, increasing the\nlikelihood of infection. The group uses tools that can bypass Window’s defenses.\n\n**_NOTE: Arbor APS enterprise security products detect and block all activity noted in this_**\n_report._\n\n# Key Findings\n\nRecent campaigns masquerade as other financial institutions or a financial\nsupplier/partner domain to trick potential victims into trusting the messages.\nTwo phishing targets found.\n\nNS Bank (Russia)\nBanca Comercială Carpatica / Patria Bank (Romania)\nOne phishing email contains two malicious URLs.\n\nThe first one is a weaponized Word document. The document contains\nobfuscated VBA scripts as opposed to known CVEs used in parallel to this\ncampaign.\nThe second one is a binary with a jpg extension.\nThe binaries analyzed contained two unique C2 servers we believe are owned and\noperated by the Cobalt hacking Group.\n\n# Details\n\n## Cobalt Group Connection\n\n\n-----\n\nactive campaigns to Cobalt Group. The first sample, a JavaScript backdoor, shares\nfunctionality with previous versions of a similar backdoor. The second binary,\nCobInt/COOLPANTS, is a reconnaissance backdoor as noted by security researchers.\n\n### JavaScript Backdoor\n\nThe JavaScript Backdoor is believed to be a stager for additional payloads. This stager,\npreviously analyzed by security researchers from Group-IB, and the JavaScript Backdoor\nASERT analyzed exhibits similar functionality as noted below:\n\nRegistry key settings for persistence\nLaunched in an SCT (a scriptlet COM object) called via regsvr32.exe\n\nAn AppLocker by-pass technique (squiblydoo).\nUse of RC4 to encrypt traffic\nSame type of system information collected\nThe C2 command names show striking similarity\nThe C2 communication structure is also closely aligned between the two samples\n\n### CobInt/COOLPANTS\n\nThe second binary identified by security researchers, dubbed “Recon (CobInt) backdoor”,\nmatched a new sample ASERT identified. A number of binaries came to light after the\ninitial findings of the CobInt backdoor. The following are a few of these binaries, including\nthe new sample identified by ASERT researchers (Figure 1):\n\nSample: 10d044bc5b8ae607501304e61b2efecb\n\nSecurity Researchers identify a “patient zero” binary and called it CobInt.\n\nListed in a recent report as a tool used by Cobalt Group\n\nSample: d017bf9f6039445bfefd95a853b2e4c4\n\nAn found a sample on July 9, 2018 and called it COOLPANTS.\nAppears to be an evolution of CobInt due to similarities in the binary when\ncross-referenced\n\n28 of the 57 functions matched using Diaphora, a tool that compares\nbinary functions\nC2 tied to Cobalt Group [reporting: hxxps://apstore[.]info](https://www.proofpoint.com/us/daily-ruleset-update-summary-20180706)\n\nNew Sample: 616199072a11d95373b3c38626ad4c93\n\nFound by ASERT August 13 2018th\nVery similar to COOLPANTS when cross-referencing the binaries:\n\nAll 48 functions under “Best Match” tab in Diaphora\nSame compilation time as COOLPANTS: 2018-06-13 20:44:15\nC2: rietumu[.]me.\n\nThe sample evolution supports the theory that rietumu[.]me belongs to\nthe Cobalt hacking group.\n\n\n-----\n\nFigure 1. CobInt/COOLPANTS\n\n## Phish & Infrastructure Analysis\n\nAfter inspecting the domain, rietumu[.]me, ASERT uncovered the email address\nsolisariana[@]protonmail[.]com. Pivoting on the email leads to five additional domains\neach with a creation date of: 2018-08-01.\n\n1. compass[.]plus\n2. eucentalbank[.]com\n3. europecentalbank[.]com\n4. inter-kassa[.]com\n5. unibank[.]credit\n\nHunting for samples associated with inter-kassa[.]com leads to a phishing email uploaded\nto VirusTotal, d3ac921038773c9b59fa6b229baa6469 (Figure 2). At the time of analysis,\nVirusTotal scored the phishing email with a 0, indicating nothing malicious was identified\nby the anti-virus engines.\n\nFigure 2. Phishing Email Header\n\nMost of the email content appears benign except for a link embedded in the message. The\nname “Interkassa” appears to be a payment processing system which makes it a prime\nmasquerading target for attackers as noted in the tactics employed by the Cobalt Group\n\n\n-----\n\n1. hxxps://download.outlook-368[.]com/Document00591674.doc\n\n1. Live on August 14, 2018\n2. hxxp://sepa-europa[.]eu/transactions/id02082018.jpg\n\n1. Not live at time of analysis but a sample matching the full URL was uploaded\n\nto VirusTotal.\n\n## Document Infection Chain\n\n### Payload Stager: Part One\n\nThe document from the embedded URL in the phishing email, Document00591674.doc\n(61e3207a3ea674c2ae012f44f2f5618b), renders a VBA infested word document which\ncontinues the infection cycle once macros are enabled. NOTE: The document requires\nuser permission and/or a policy enabled that allows Macros to run for a successful\nlaunch.\n\nThe VBA script pieces together a cmd.exe command that launches cmstp.exe with an INF\nfile (figure 3) allowing to potentially by-pass AppLocker. The INF file then beacons to\ndownload.outlook-368[.]com to download a remote payload that cmstp.exe will execute.\n\nFigure 3. INF File\n\nThe file, info.txt, downloaded from download.outlook-368[.]com is an XML file with an\nembedded scriptlet tag. The XML’s content includes a registration section allowing it to\nbe used as a SCT/COM object (Figure 4).\n\n\n-----\n\nFigure 4. COM Object\n\n“cmstp.exe” executes the SCT file, which subsequently drops and launches the JavaScript\nbackdoor dropper binary, 31385.txt (e368365bece9fb5b0bc8de1209bab694), disguised\nas a text file. For the dropped binary, Cobalt Group makes use of another system provided\nbinary to add a layer of stealth and bypass possible protections like AppLocker by\nlaunching it using regsvr32.exe (Figure 5). This is consistent with TTPs for this actor.\n\nFigure 5. regsvr32 launching the 31385.txt\n\nThe DLL file, 31385.txt, masquerading as a text file, is the last stage in the infection chain.\nThe DLL drops the final obfuscated embedded file and launches it using regsvr32.exe\nbefore deleting itself (Figure 6).\n\nFigure 6. Final Obfuscated Script\n\nThe above script (Figure 6) is launched using regsvr32.exe:\n\nREgSvr32 /S /N /U\n/I:”C:/Users/zgSpbU9Lu/AppData/Roaming/7F235861DB0B0024C3.txt” sCRObJ\n\nThe script ensures persistence by modifying the registry key UserInitMprLoginScript with\n\n\n-----\n\nScRObJ\n\nDe-obfuscating the final script renders the C2 along with the RC4 key. This is the\nJavaScript backdoor “more_eggs” which has been analyzed by other researchers over the\npast few years (Figure 7).\n\nFigure 7. De-Obfuscated JavaScript Backdoor – “More_eggs”\n\n#### Backdoor “more_eggs” commands:\n\n1. d&exec – Downloads and executes a PE file.\n2. more_eggs – Downloads an update for itself.\n3. gtfo – Delete itself and related registry entries.\n4. more_onion – Executes the “new” copy of itself.\n5. vai_x – Executes a command via cmd.\n\n**NOTE: Commands 1 – 4 match the commands described in other public reporting.**\nCommand 5 differs in name only; what it does remains the same. The public report shows\n“more_power” as the name of the fifth command.\n\n\n-----\n\nFigure 8: Execution Flow\n\n## JPEG Infection Chain\n\n### File Execution\n\nThe second URL identified in the phishing email, hxxp://sepaeuropa[.]eu/transactions/id02082018.jpg, acts as a red-herring; id02082018.jpg,\n9a87da405a53eaf32f8a24d3abb085af – UPX unpacked, is an executable rather than an\n\n\n-----\n\nmemory with another executable.\n\nThis overwritten binary loads a resource and jumps to the executable code contained in it.\nThe unpacked binary will fail when LoadResource is called if it’s not running in the context\nof the original binary (Figure 9).\n\nFigure 9: LoadResource()\n\nThe loaded shellcode first deobfuscates itself before beaconing to the C2 server for\nadditional payloads or scripts.\n\nFigure 10: C2 Server\n\nAt the time of analysis, the C2 server did not respond; however, there is another binary\nwith the same C2 found in ASERT’s malware zoo which bears a striking resemblance to\nCobInt.\n\n### Full Circle\n\nThe binary, 452903fc857fb98f4339d7ce1884099, makes use of the C2 ibfseed[.]com.\nComparing this binary to another CobInt (616199072a11d95373b3c38626ad4c93)\nsample using Diaphora, ASERT determined this to be another CobInt/COOLPANTS\nsample. We believe this binary is tied to Cobalt Group using the same methodology and\nbinary comparisons as the previously discussed malware samples.\n\n# Romanian Target Spotted\n\n\n-----\n\nWorking closely with Intel471, one of our Threat Intelligence partners, we found an\nadditional Cobalt Group phishing campaign targeting carpatica[.]ro by masquerading as\nSingle Euro Payments Area (SEPA). “carpatica[.]ro” belongs to Banca Comercială\nCarpatica, a bank in Romania that merged with Patria Bank in 2017.\n\nFigure 11: Romanian Bank Phish Header\n\n## Cobalt Group Connection\n\nThe phishing email uncovered by Intel471 downloads\n9270ac1e013a3b33c44666a66795d0c0. The downloaded file shares the same PDB\nstring as 1999a718fb9bcf3c5b3e41bf88be9067. That sample connects to rietumu[.]me,\nwhich ASERT identified as belonging to Cobalt Group (Figure 12).\n\nFigure 12: Cobalt Phish Connection\n\n# Summary\n\n\n-----\n\nemail with two separate C2s makes this email peculiar. One could speculate that this\nwould increase the infection odds. The actor tries to hide the infection by using\nregsvr32.exe and cmstp.exe, which are both known for by-passing AppLocker\n(configuration dependent). ASERT believes Cobalt Group will continue targeting financial\norganizations in Eastern Europe and Russia based on the observables in this campaign\nand their normal modus operandi. ASERT also recommends that employees are trained to\nspot phishing emails and, where possible, closely inspect emails for look-alike domains\nthat might contain malicious attachments or links.\n\n# IOCs\n\n10D044BC5B8AE607501304E61B2EFECB – CobInt\n\nd017bf9f6039445bfefd95a853b2e4c4 – COOLPANTS\n\n616199072a11d95373b3c38626ad4c93 – Coblnt/COOLPANTS (ASERT Sample)\n\nd3ac921038773c9b59fa6b229baa6469 – Email\n\n61e3207a3ea674c2ae012f44f2f5618b – Document00591674.doc\n\ne368365bece9fb5b0bc8de1209bab694 – DLL File\n\n3452903fc857fb98f4339d7ce1884099 – CobInt/COOLPANTS (ASERT Sample)\n\n9a87da405a53eaf32f8a24d3abb085af – id02082018.jpg (UPX Unpacked)\n\nf3bb3e2c03f3976c107de88b43a22655 – id02082018.jpg (UPX Packed)\n\na3b705ce3d677361a7a9b2b0bdf04a04 – Email (carpatica) attachment\n\neb93c912e4d3ecf52615b198c44771f4 – Email (carpatica)\n\n9270ac1e013a3b33c44666a66795d0c0 – Email (carpatica)Downloaded\n\n1999a718fb9bcf3c5b3e41bf88be9067\n\nhxxps://help-desc-me[.]com\n\nhxxps://apstore[.]info\n\nhxxps://rietumu[.]me\n\nhxxps://ww3.cloudfront[.]org[.]kz\n\nhxxp://download.outlook-368[.]com\n\nhxxps://ibfseed[.]com\n\ncompass[.]plus\n\n[ ]\n\n\n-----\n\ninter-kassa[.]com\n\nunibank[.]credit\n\nsepacloud[.]eu\n\nsepa-cloud[.]com\n\n[Posted in Uncategorized](https://asert.arbornetworks.com/category/uncategorized/)\nComments Off on Double the Infection, Double the Fun\n\nComments are closed.\n\n[Tunneling Under the Sands »](https://asert.arbornetworks.com/tunneling-under-the-sands/)\n[« Introducing NETSCOUT’s Threat Intelligence Report](https://asert.arbornetworks.com/introducing-netscouts-threat-intelligence-report/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.08.30.Cobalt_Group_Fun/Double%20the%20Infection%20Double%20the%20Fun.pdf"
    ],
    "report_names": [
        "Double the Infection Double the Fun"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041768,
    "ts_creation_date": 1539655317,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/b6d1d7e93428e9ee1d8ce9ca8d21cad84c983077.pdf",
        "text": "https://archive.orkl.eu/b6d1d7e93428e9ee1d8ce9ca8d21cad84c983077.txt",
        "img": "https://archive.orkl.eu/b6d1d7e93428e9ee1d8ce9ca8d21cad84c983077.jpg"
    }
}