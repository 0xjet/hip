{
    "id": "da85c09a-11dd-49c1-8941-e75102a9ffb0",
    "created_at": "2023-01-12T15:03:53.590747Z",
    "updated_at": "2025-03-27T02:05:17.936027Z",
    "deleted_at": null,
    "sha1_hash": "b1b4643dbadf6f0149a16ed1c0656a6dd0a4b457",
    "title": "2020-03-23 - KPOT Deployed via AutoIt Script",
    "authors": "",
    "file_creation_date": "2022-05-28T19:53:27Z",
    "file_modification_date": "2022-05-28T19:53:27Z",
    "file_size": 235974,
    "plain_text": "# SANS ISC: InfoSec Handlers Diary Blog - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training InfoSec Handlers Diary Blog\n\n**isc.sans.edu/diary/25934**\n\n**Published: 2020-03-23**\n\n**Last Updated: 2020-03-23 18:31:52 UTC**\n\n**by** [Didier Stevens (Version: 1)](https://isc.sans.edu/handler_list.html#didier-stevens)\n\nI have other samples like the malware I covered in yesterday's diary entry.\n\nAll with the same body and attachment, it's just the sender that varies. The PowerShell\nscripts are the same and download from show1[.]website. Like I wrote yesterday, three files\nare downloaded:\n\n[1. A legitimate, signed AutoIt interpreter (this is not malware)](https://www.virustotal.com/gui/file/237d1bca6e056df5bb16a1216a434634109478f882d3b1d58344c801d184f95d/detection)\n[2. A heavily obfuscated AutoIt script, that is encoded as a PEM certificate](https://www.virustotal.com/gui/file/3d6fdcf27f2f439532ab83510d951cff428cc7f31637d455d937fb3cb079d6f9/detection)\n3. An [encrypted EXE: KPOT info stealer](https://www.virustotal.com/gui/file/f41fbd380e418e75476d8c377a4956451989e926c702eea86f821da5891f8612/detection)\n\nThe PowerShell script uses certutil to BASE64-decode the \"certificate\" to the AutoIt script,\nand then lauches the AutoIt interpreter with the script as argument.\n\n[The AutoIt script contains process hollowing shellcode (known as frenchy shellcode), that](http://www.peppermalware.com/2019/07/analysis-of-frenchy-shellcode.html)\ndecrypts the encrypted PE file as guest and uses 32-bit dllhost.exe as host (as process\nhollowing host, not as dll host).\n\nThe PH shellcode contains mutex name \"frenchy_shellcode_06\", but this name is\nrandomized by the AutoIt script before it is injected and executed.\n\nAs the decrypted KPOT EXE is never written to disk, it was unknown by VirusTotal. I did\n[submit it today.](https://www.virustotal.com/gui/file/3fd4aa339bdfee23684ff495d884aa842165e61af85fd09411abfd64b9780146/detection)\n\nKPOT is an infostealer, as can be guessed from the strings found inside the executable:\n\n\n-----\n\nMore interesting strings are simply XOR-encoded (1-byte key).\n\nLike the C2:\n\nAnd the targets:\n\n\n-----\n\nUsually, I explain in detail my analysis steps, so that you can reproduce them. I will do this\ntoo for this executable in one or more upcoming diary entries.\n\nDidier Stevens\n\nSenior handler\n\nMicrosoft MVP\n\n[blog.DidierStevens.com](http://blog.didierstevens.com/) [DidierStevensLabs.com](http://didierstevenslabs.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-23 - KPOT Deployed via AutoIt Script.pdf"
    ],
    "report_names": [
        "2020-03-23 - KPOT Deployed via AutoIt Script.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535833,
    "ts_updated_at": 1743041117,
    "ts_creation_date": 1653767607,
    "ts_modification_date": 1653767607,
    "files": {
        "pdf": "https://archive.orkl.eu/b1b4643dbadf6f0149a16ed1c0656a6dd0a4b457.pdf",
        "text": "https://archive.orkl.eu/b1b4643dbadf6f0149a16ed1c0656a6dd0a4b457.txt",
        "img": "https://archive.orkl.eu/b1b4643dbadf6f0149a16ed1c0656a6dd0a4b457.jpg"
    }
}