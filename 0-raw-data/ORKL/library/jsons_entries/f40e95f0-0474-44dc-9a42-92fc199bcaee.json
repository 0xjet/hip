{
    "id": "f40e95f0-0474-44dc-9a42-92fc199bcaee",
    "created_at": "2023-02-21T02:06:28.150119Z",
    "updated_at": "2025-03-27T02:09:07.850042Z",
    "deleted_at": null,
    "sha1_hash": "e5f00b962f311586280d3781653203e7de381979",
    "title": "2022-02-20 - Targeted process injection - Linux",
    "authors": "",
    "file_creation_date": "2023-02-20T08:28:24Z",
    "file_modification_date": "2023-02-20T08:28:24Z",
    "file_size": 545815,
    "plain_text": "# Targeted process injection – Linux\n\n**[cybersecuritynotepad.com/index.php/2022/02/20/targeted-process-injection-linux](https://www.cybersecuritynotepad.com/index.php/2022/02/20/targeted-process-injection-linux/)**\n\n20 February 2022\n\nIn this post I will cover briefly how to modify the memory of running process in real-time.\nThe example chosen for this demonstration is simple. The main purpose is to show the\napproach rather than make it look sophisticated. However, you can take it as far as you wish,\ndepending on your objectives. In future posts, I will cover additional scenarios and also will\nadd more weaponised examples.\n\nOne important question that needs answering is why would somebody want to directly inject\ninformation/data into the running process. Imagine the following scenario, post compromise\nyou have SSH access to the Linux server. At this stage you can escalate privileges or stay on\nthe system as low privileged user. For privilege escalation traditional methods such as\nmisconfigured permissions, cron jobs, unpatched software and other issues could be used.\nThose techniques and methods are well known to offensive, defensive and forensic teams. As\nsoon as you follow the usual script, your presence will be detected and the access may be\nremoved. In those types of scenarios, you can be creative and that’s when this technique may\ncome in handy.\n\nFor the demo, I used the “nano” text editor. The user “user2” who is a standard system user\nwith limited privileges opened a text file “myfile.txt” and started typing text into the file just\nlike a typical user would.\n\n\n-----\n\nAs you can see the text CHANGEME text appears in the left terminal and in the right\nterminal the process 1227 is attached to the “gdb” debugger.\n\nNext we identify the area where the text is in the process memory. In this case it is on the\nheap.\n\nWe are only interested in the heap because this is where the text is that the user “user2”\nwrote within “nano” text editor.\n```\nheap start address 0x56399993e000\n\nheap end address 0x563999a04000\n\n```\nWhen searching memory it is never easy to find specific information without some trial and\nerror approach. In this case, after spending a while examining the memory I knew\nimmediately where I should look for the desired information. I simplified the process for you\nso that you can see the results rather than trying to find the needle in the haystack. As you\ncan see now, I found the memory address where the string “CHANGEME” sits and replaced it\nwith the string “LIVEDEMO”. After completing that task I detached the process 1227 from\nthe debugger.\n```\n0x5639999dea10 = CHANGEME (string)\n\n```\n\n-----\n\nNow you can see above that in the left terminal, the “CHANGEME” string is still there as\nbefore. It looks to the user “user2” as if nothing has changed because the text has not been\nrefreshed. However, in memory the change has been made and, if the user saved the file or\neven copied the first line “CHANGEME” into the clipboard they would get “LIVEDEMO”\nstring when pasting from the clipboard or saving the file “myfile.txt”. I have added short\ndescriptions to the left terminal so that you can see what happened.\n\nThe final screenshot shows that even if on user’s screen nothing changes, the memory\naddress shown below has been modified:\n```\n0x5639999dea10\n\n```\n\n-----\n\nThe above address no longer stored the string CHANGEME but LIVEDEMO . After saving\nthe text file and reopening it the user “user2” will see the modified string “LIVEDEMO”\nconfirming that the injection into the live memory within the heap space has been successful.\n\nAs you can see, it is not that difficult to get it done. In fact, it is easier than you may think.\nImagine what would happen, if you changed just one byte in the right place and at the right\ntime to disable security controls. Going one step further, you can execute the code without\nleaving forensic artifacts, as long as you know what you are doing.\n\nPublished\n[Categorised as Research Tagged debugger,](https://www.cybersecuritynotepad.com/index.php/category/research/) [gdb,](https://www.cybersecuritynotepad.com/index.php/tag/gdb/) [injection,](https://www.cybersecuritynotepad.com/index.php/tag/injection/) [Linux,](https://www.cybersecuritynotepad.com/index.php/tag/linux/) [memory,](https://www.cybersecuritynotepad.com/index.php/tag/memory/) [process](https://www.cybersecuritynotepad.com/index.php/tag/process/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Linux/Process Injection/2022-02-20 - Targeted process injection - Linux.pdf"
    ],
    "report_names": [
        "2022-02-20 - Targeted process injection - Linux.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1676945188,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1676881704,
    "ts_modification_date": 1676881704,
    "files": {
        "pdf": "https://archive.orkl.eu/e5f00b962f311586280d3781653203e7de381979.pdf",
        "text": "https://archive.orkl.eu/e5f00b962f311586280d3781653203e7de381979.txt",
        "img": "https://archive.orkl.eu/e5f00b962f311586280d3781653203e7de381979.jpg"
    }
}