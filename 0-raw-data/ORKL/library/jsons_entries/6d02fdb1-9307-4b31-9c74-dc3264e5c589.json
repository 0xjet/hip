{
    "id": "6d02fdb1-9307-4b31-9c74-dc3264e5c589",
    "created_at": "2023-01-12T15:05:18.679082Z",
    "updated_at": "2025-03-27T02:05:24.389468Z",
    "deleted_at": null,
    "sha1_hash": "ba8af4b6f9f82a96fa86a4ea6b4f97fdad6dc1cb",
    "title": "2022-06-27 - GlowSand",
    "authors": "",
    "file_creation_date": "2022-07-02T23:18:27Z",
    "file_modification_date": "2022-07-02T23:18:27Z",
    "file_size": 2812394,
    "plain_text": "# GlowSand\n\n**inquest.net/blog/2022/06/27/glowsand**\n\nWithout doubt, one of the hottest and most stressful regions on the planet currently is\nEastern Europe. The military conflict that has been ongoing for more than 4 months has\nunfortunately claimed many victims and is fueling an economic and food crisis in several\nnations spanning across the globe. This far reaching tension also bleeds into cyberspace.\n\n\n-----\n\nThe tools used by threat actors aimed at Ukraine and neighboring countries are constantly\nchanging. In many cases, the context of successful attacks is the use of documents in email\nattachments. We will consider some of the novelties of attackers that target Ukrainian\ngovernment organizations. When these tools shattered like grains of sand, we named it\nGlowSand.\nThe first document, the analysis of which we would like to provide, we discovered on June 25\nin InQuest Labs.\n\nFile Type Office Open XML document\n\nSha 256 [a93ff0e6c42aa3f011a53108dc9b224dc85d9e0930f81e3b3010801089126e4e](https://labs.inquest.net/dfi/sha256/a93ff0e6c42aa3f011a53108dc9b224dc85d9e0930f81e3b3010801089126e4e)\n\nWhen the document is opened, the user will receive the following table, appearing to be a\nmilitary payroll.\n\n\n-----\n\nFigure 1: File\n\nContent\nPayroll allegedly intended for military unit A4267, which is a real military unit which is located\nin the west of Ukraine. Detection on VirusTotal is very shallow.\n\n\n-----\n\nFigure 2: VirusTotal Detection\n\nFigure 3: External Relationship\nThe image shows that the document contains the download address of the further payload.\nThe malware download server is configured in such a way that it only allows downloading\nfiles for Ukrainian IP addresses.\n\n**hxxp://enforce.interdependent23.vipertos[.]ru/DESKTOP-**\n**STA1AO7/salmon/salmon.udb**\n\nWith the right client setup, we were able to get 4 files.\n\nFile Type Office Open XML document\n\nsha 256 [1a1ac565ba08ac51eb6ef27d0fe47a03372112f476ad3008f6ead30dbdcee565](https://labs.inquest.net/dfi/sha256/1a1ac565ba08ac51eb6ef27d0fe47a03372112f476ad3008f6ead30dbdcee565)\n\n\n-----\n\nFile Type Office Open XML document\n\nsha 256 [6c1799a8141219b8933cdee57b27dfbf2561e48c3e4ec77ead685330e9c8aa23](https://labs.inquest.net/dfi/sha256/6c1799a8141219b8933cdee57b27dfbf2561e48c3e4ec77ead685330e9c8aa23)\n\nFile Type Office Open XML document\n\nSha 256 [c9939f994e25e1e935f101ee8bc4ce033aad8bea96d192dc700deb1d04ef7c66](https://labs.inquest.net/dfi/sha256/c9939f994e25e1e935f101ee8bc4ce033aad8bea96d192dc700deb1d04ef7c66)\n\n\nFile\nType\n\n\nOffice Open XML document\n\n\nsha256 [c850c872318328777441a6916d1994b714ad2c40104d9a7ebb9cfb0e537a3737](https://labs.inquest.net/dfi/sha256/c850c872318328777441a6916d1994b714ad2c40104d9a7ebb9cfb0e537a3737)\n\nAfter loading one of these files, the first stage document starts the next stage. We noticed\nthat the payload changes every few hours. We were able to find one such shift. In total, we\nwere able to obtain 3 document files.\n\nFigure 4: Malicous Macro\nThe obfuscated macro is decoded at runtime and is divided into two parts. The first part\ncreates a file in the directory “C:\\Users\\Admin\\deprive.pdf” This file shows extremely low\nVirusTotal detection at the time of analysis.\n\n\n-----\n\nFigure 5: Deprive.pdf VT Detection\n\nFile Type Java Script\n\nSha 256 [6e7e381a1f7c739e4961957c1984b9eb8c0dee6cf7f15cd0a35c129d1147b013](https://www.virustotal.com/gui/file/6e7e381a1f7c739e4961957c1984b9eb8c0dee6cf7f15cd0a35c129d1147b013)\n\nFigure 6: Part 1 Deobfuscated\nThis code creates a new task in Task Scheduler called “HotStart”; and every 5 minutes will\nrun the script “C:\\Users\\Admin\\deprive.pdf”. Thus, the attacker has achieved persistence on\nthe target host.\n\nFigure 7: Part 2 Deobfuscated\nWith a request txxp://ip-api.com/csv/delicious71.kolopartor[.]ru?fields=query The script gets\nthe IP address of the domain.\n\n\n-----\n\nhxxp://143.244.131[.]123\nhxxp://141.164.45[.]200\n\nNext, the following data is sent to the remote server.\n\n**%userprofile%**\n\n**%systemdrive%**\n\n**%computername%**\n\nIf the threat actors are interested in the system on which they were able to execute this code,\nthey will later send further code to deploy the infrastructure.\n\n>The actor constantly changes their tools to either low detection or lightweight recon of\nsystem information before retrieving the main payload. This is clearly seen in the following\n.lnk file.\n\nFile Type .lnk file\n\nSha 256 [d965892ede4f74fa62248b381160ed6f0cd9158bf4788de40b57815f9108bc15](https://www.virustotal.com/gui/file/d965892ede4f74fa62248b381160ed6f0cd9158bf4788de40b57815f9108bc15)\n\nA file containing a link to hxxp://a0681546.xsph[.]ru/death/quickly.xml launches when the file\nis opened. The server on which this quickly.xml is located is also configured in such a way\nthat it responds to requests with Ukrainian IP addresses.\n\nFigure 8: quickly.xml\n\nThe next-stage payload retrieved from hxxp://zvonishu[.]ru/get.php is geofenced to deliver\nonly to Ukrainian based systems. This domain is less than a month old and was created on\n2022-05-25 and currently hosted on IP 95.179.216[.]77. Pivoting via reverse DNS we’re able\nto identify the following likely related and also recently registered domains:\n\nakashito[.]ru 2022-05-18\n\nbilitora[.]ru 2022-02-28\n\nbillyhot[.]ru 2022-02-28\n\nbilotrast[.]ru 2022-06-05\n\ndodortar[.]ru 2022-02-28\n\ndogvilla[.]ru 2022-04-29\n\nfingerso[.]ru 2022-05-26\n\n\n-----\n\nginyou[.]ru 2022-05-20\nhikortaf[.]ru 2022-02-28\n\nhitmomas[.]ru 2022-05-20\n\nkopratiso[.]ru 2022-02-28\n\nkudrashi[.]ru 2022-05-18\n\nmigrotu[.]ru 2022-05-26\n\nmilotraf[.]ru 2022-04-29\n\nmitlight[.]ru 2022-05-20\n\nnikotod[.]ru 2022-04-14\n\nnitikora[.]ru 2022-02-28\n\nqiwardos[.]ru 2022-02-28\n\nvosemart[.]ru 2022-05-20\n\nzvonishu[.]ru 2022-05-26\nThe next-stage payload takes a screenshot and gathers identifying machine information to\npost back to the same server and assuming conditions are met, downloads the next stage of\nthe malware:\n\nFigure 9: System Enumeration\nDeep File Inspection provide an opportunity to empower your operations and overcome the\nlimitations inherent with other malware prevention solutions. To illuminate the security gap\n[your organization faces, InQuest has developed the Email Security Assessment to test the](https://inquest.net/email-security-assessment)\nefficacy of typical mail providers’ security controls.\n\n## IoCs:\n\n\n-----\n\na93ff0e6c42aa3f011a53108dc9b224dc85d9e0930f81e3b3010801089126e4e\n1a1ac565ba08ac51eb6ef27d0fe47a03372112f476ad3008f6ead30dbdcee565\n\n6c1799a8141219b8933cdee57b27dfbf2561e48c3e4ec77ead685330e9c8aa23\n\nc9939f994e25e1e935f101ee8bc4ce033aad8bea96d192dc700deb1d04ef7c66\n\nc850c872318328777441a6916d1994b714ad2c40104d9a7ebb9cfb0e537a3737\n\nd965892ede4f74fa62248b381160ed6f0cd9158bf4788de40b57815f9108bc15\n\n6e7e381a1f7c739e4961957c1984b9eb8c0dee6cf7f15cd0a35c129d1147b013\n\nalphabet.fake39.vipertos[.]ru\n\nalphabet.fake42.vipertos[.]ru\n\nalphabet.fake64.vipertos[.]ru\n\nalphabet.fake84.vipertos[.]ru\n\nalphabet.fake89.vipertos[.]ru\n\nclaim.goat19.vipertos[.]ru\n\nclaim.goat57.vipertos[.]ru\n\nfake39.vipertos[.]ru\n\nfake42.vipertos[.]ru\n\nfake64.vipertos[.]ru\n\nfake84.vipertos[.]ru\n\nfake89.vipertos[.]ru\n\nfancied.intense37.vipertos[.]ru\n\ngoat19.vipertos[.]ru\n\ngoat57.vipertos[.]ru\n\nintense37.vipertos[.]ru\n\nkasimov.vipertos[.]ru\n\nnecessary42.vipertos[.]ru\n\npreview.necessary42.vipertos[.]ru\n\nwww.vipertos[.]ru\n\nxml.vipertos[.]ru\n\nTags\n\n[threat-hunting\nin-the-wild\nthreat-intel](https://inquest.net/taxonomy/term/2)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-27 - GlowSand.pdf"
    ],
    "report_names": [
        "2022-06-27 - GlowSand.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535918,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1656803907,
    "ts_modification_date": 1656803907,
    "files": {
        "pdf": "https://archive.orkl.eu/ba8af4b6f9f82a96fa86a4ea6b4f97fdad6dc1cb.pdf",
        "text": "https://archive.orkl.eu/ba8af4b6f9f82a96fa86a4ea6b4f97fdad6dc1cb.txt",
        "img": "https://archive.orkl.eu/ba8af4b6f9f82a96fa86a4ea6b4f97fdad6dc1cb.jpg"
    }
}