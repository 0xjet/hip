{
    "id": "5010409f-00c3-49ae-b5d5-05b0d9165358",
    "created_at": "2022-10-25T16:48:16.828522Z",
    "updated_at": "2025-03-27T02:16:37.197534Z",
    "deleted_at": null,
    "sha1_hash": "b262e09517bd3bf9abb0c19c20ef8fddb2b0012d",
    "title": "2020-03-30 - The 'Spy Cloud' Operation Geumseong121 group carries out the APT attack disguising the evidence of North Korean defection",
    "authors": "",
    "file_creation_date": "2020-03-30T16:29:05Z",
    "file_modification_date": "2020-03-30T16:29:05Z",
    "file_size": 1217106,
    "plain_text": "# The 'Spy Cloud' Operation: Geumseong121 group\n\n\n# carries out the APT attack disguising the evidence\n\n\n# of North Korean defection\n\n\n## The Background of 'Operation Spy Cloud' APT Campaign\n\n\nESRC (ESTsecurity Security Response Center) researchers identified the new APT campaign\n\n\ncarried out by the state-sponsored group named 'Geumseong121' in early March 2020.\n\n\n'Geumseong121', a North Korean threat group has been conducting the state-sponsored\n\n\nespionage activities in the cyberspace of South Korea for years, mainly targeting those who\n\n\n-----\n\nare engaged in unification, foreign affairs, or national security, the leaders of the organizations\n\n\nspecializing in North Korean issues, and North Korean refugees.\n\n\nESRC analyzed the recently discovered campaign based on Indicators of compromise (IoC)\n\ndata and pieces of evidence collected by threat intelligence multi-channel sensors including\n\n\nthe ESTsecurity’s security solution ALYac.\n\n\nThe report titled “The stealthy mobile APT attack carried out by Geumseong121 APT hacking\n\n\ngroup” published in November last year, reveals that the group has attempted to perform\n\n\ncyber-attacks targeting a wide range of devices including computers as well as mobile devices.\n\nIn particular, the group infiltrated an unspecified website and exploited it as a command\n\ncontrol (C2) server in the 'Operation Dragon Messenger' campaign. Also, we observe the\n\n\nevolution of the attack strategies in the web servers, which have been built by the group using\n\n\nits design, for use in the newly discovered attack.\n\n\nMoreover, the use of trust-based attack tactics such as Google Play Store or YouTube is\n\n\ndistinguished from the existing attack strategies that have been used by most threat actors.\n\n\nThe APT campaign used the advanced spear-phishing techniques with the bait file containing\n\n\nevidence of North Korean defectors to trick email recipients into believing they received an\n\n\nemail from a trusted source.\n\n\nESRC named the Geumseong 121 group’s APT campaign as 'Operation Spy Cloud' based on\n\n\nthe use of Google Drive and PickCloud service.\n\n\n## APT attack vector: spear phishing tactics and processes\n\n\nThe group of attackers behind the 'Operation Spy Cloud' make full use of and derive benefit\n\n\nfrom a spear-phishing technique that enables the direct and stealthy access to the attack\n\n\ntargets.\n\n\n-----\n\nThe spear-phishing email used in the attack contains a malicious link, which tricks users to click\n\n\nto download the file attaching the malicious MS Word DOC document.\n\n\nBased on the samples we collected, the campaign's decoy documents used the file formats\n\n\nDOC, XLS, and HWP, the Korean government standard word processor format, targeting the\n\n\nusers in South Korea.\n\n\n\n[Figure 1] Attack flow of 'Operation Spy Cloud'\n\n\nThe attacker attempted to distribute the file by using a URL link instead of attaching the file\n\n\nconsidering that a security solution could capture emails where a malware threat is detected in\n\n\nan attachment and block the email before delivery. This allows attackers to modify or delete\n\n\nfiles as needed, to evade detection and minimize the footprint.\n\n\n-----\n\nESRC has identified some file download links used in the attack, which were not active any\n\n\nlonger during the analysis process because the attackers had already removed the files.\n\n\nThe analysis result of the malicious DOC Word file used for the attack reveals that the\n\n\nshellcode is combined with the obfuscated malicious VBA macro.\n\n\nWhen executing the shellcode, it connects to the Google Drive set as the command control\n\n\n(C2) server, executes the EXE malicious module, and attempts to leak computer information to\n\n\nthe pCloud.\n\n\n## In-depth analysis of the tactics and tools used in 'Operation Spy Cloud'\n\n\nWhen a malicious DOC document is executed, a fake screen appears as if a certain image\n\n\narea is not displaying properly as follows, with the phrase saying that 'This picture is not\n\n\nautomatically downloaded from the Internet to protect personal information.' on the top of\n\n\nthe document.\n\n\nThe attackers trick users into believing that the image is not displayed properly due to the\n\n\nprivacy protection and clicking the [Enable Content] button.\n\n\n\n[Figure 2] Malicious document disguised as a file related to North Korean refugees\n\n\n-----\n\nThe following VBA macro functions are included in the DOC document, and the malicious\n\n\nfunction is activated when the [Enable Content] button is executed.\n\n\nIn the first stage, it uses the 'CreateMutex' function to declare the mutex as 'm_mtn' value to\n\n\navoid duplicate execution.\n\n\nOption Explicit\n\n\nPrivate Declare PtrSafe Function CreateMutex Lib \"kernel32\" Alias \"CreateMutexA\" (ByVal\n\n\nlpMutexAttributes As Long, ByVal bInitialOwner As Long, ByVal lpName As String) As Long\n\n\nPrivate m_mt As Long\n\n\nPrivate Sub ghjkjhgyujx()\n\n\nm_mt = CreateMutex(0, 1, \"m_mtn\")\n\n\nDim er As Long: er = Err.LastDllError\n\n\nIf er <> 0 Then\n\n\nApplication.DisplayAlerts = False\n\n\nApplication.Quit\n\n\nElse\n\n\nEnd If\n\n\nEnd Sub\n\n\n-----\n\nThen, the producer checks for the file name of a specific foreign security program using Mid\n\nfunction in the string list, and if it does not exist, continues the decoding routine. Therefore, it\n\n\ncan be used as ‘kill switch’ depending on the conditions.\n\n\n\n- c:\\windows\\avp.exe\n\n\n\n- c:\\windows\\kavsvc.exe\n\n\n\n- c:\\windows\\clisve.exe\n\n\nsen_str = pQFqnD5h\n2WOGfbmNyi*IKP7JX9A)dcLelj(kETogHs.#wxBU+13rv&6VtC,uYz=Z0RS8aM4\n\n\n\n[Figure 3] Function to check for a specific security program\n\n\n-----\n\nNext, it registers the registry key to modify the macro security settings as follows:\n\n\nIt replaces the\n\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Office\\(Version)\\Word\\Security\\AccessVBOM\n\nvalue with '1', which allows secure access to the VBA project object model in developer macro\n\nsettings. It also declares a specific encoding string to decode the obfuscated shellcode listed at\n\n\nthe bottom of the macro function.\n\n\n\n[Figure 4] Registering the registry key and shellcode decoding string declaration\n\n\n-----\n\nstr_on = abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\n\n&*(),.#+=\n\n\nstr_en = 7JX9A)dwxBU+13rv&tC,uYz=Z0RS8aM4FqnD5h\n\n2WpQOGfbmNKPcLelj(kogHs.#yi*IET6V\n\n\nThe 72 byte-string is replaced with a string that is symmetrical at each position and\n\n\nrearranged. The shellcode is one of the key areas in the following macro functions.\n\n\n\n[Figure 5] Encoded shellcode area\n\n\n-----\n\nThe analysis of the shellcode identifies the command attempting to connect to a specific\n\n\nGoogle Drive, which is used as a command control (C2) server. In this case, a security\n\n\ndetection system could determine it as a normal connection.\n\n\n\n[Figure 6] Access to Google Drive, the C2 server using the shellcode command\n\n\nGoogle Drive includes a file named 'invoice.sca' disguised as an invoice file.\n\n\nThe last modified time of the file is on the afternoon of March 10, 2020, and the file is\n\n\nencrypted with XOR algorithm. The owner who shared the file is using the Gmail account\n\n\n'godlemessy@gamil.com'. The analysis result shows that it was the G-mail account used by\n\n\nthe group behind the campaign, which has often seen in similar threat cases previously.\n\n\n-----\n\n[Figure 7] Attacker information and payload registered in Google Drive\n\n\nThe 'invoice.sca' file (0xbf 0x7a 0x79 0x51 4 bytes) is XOR-encrypted in iterative decoding\n\n\nscheme, then the malicious module inside will appear.\n\n|File Name|Time Stamp (UTC)|MD5|\n|---|---|---|\n|invoice.sca (decode)|2020-03-02 23:32:17|392647675E8DFCD2602B4FFE38A19E2B|\n\n\n-----\n\n[Figure 8] Comparison of payload decoding\n\n\nThe decoded malicious code communicates to the cloud server using pCloud access token\n\n\ndata, steal the system information, and installs the additional backdoors according to the\n\n\nattacker's intention. The main functions of the spy module are not much different from the\n\n\ntools used by the 'Guemseong 121' group.\n\n\n-----\n\n[Figure 9] Access token for pCloud communication\n\n\nThe information such as the json file containing the account history and the email address\n\n\nthat the attacker used, and when the attacker signed up for the service have been identified\n\nby browsing the account of the attacker who registered the cloud service based on the API.\n\n\n\"registered\": \"Wed, 10 Apr 2019 06:40:53 +0000\",\n\n\n\"email\": \"kpsa-press@daum.net\",\n\n\nThe information reveals that the attacker registered the cloud service on April 10, 2019, and\n\n\nsigned up with the Daum/kakao account 'kpsa-press@daum.net'.\n\n\n-----\n\n[Figure 10] json file information used for registration of cloud service\n\n\nESRC has released an email address similar to 'kpsa-press@daum.net' in the report titled\n\n\n'Geumseong121's APT attack impersonating the Ministry of Unification, distribute malware to\n\n\nGoogle Drive' in April 2019.\n\n\nThe previously discovered email address 'kpsapress@gmail.com' was using the domain of\n\n\nGoogle Gmail instead of Daum/kakao account.\n\n\nThe Gmail's recovery email is set as 'kps·······@d···.net', which is similar to the account 'kpsa\n\npress@daum.net'.\n\n\n-----\n\n[Figure 11] Analysis of Google Account Recovery\n\n\nHowever, TTPs (Tactics, Techniques, and Procedures) and the final payload are exactly the\n\n\nsame as the materials that were used for 'Operation Spy Cloud'.\n\n\nThe research findings so far suggest that the 'Geumseong 121' group is using the same\n\n\nstrategies and technologies in the same way as it was in its previous attacks.\n\n\n## Similarity comparison analysis of 'Spy Cloud' and 'Geumseong 121' attack\n\n\n## cases\n\n\n-----\n\nESRC released the threat intelligence report 'Operation Printing Paper 3', in which in-depth\n\n\ndata and Indicator (IoC) data ensuring that the same group is behind the 'Operation Spy\n\n\nCloud' APT attack are included, on Threat Inside service on March 13, 2020.\n\n\n\n[Figure 12] The latest threat intelligence report cover page of the same APT group\n\n\n-----\n\nESRC has analyzed multiple attack traces of 'Operation Spy Cloud' quite comprehensively,\n\n\nfinding out that the 'Guemseong 121' group's cyber operation activities and threat indicators\n\n\nare strongly connected.\n\n\nSeveral e-mail accounts and subscription information of Internet cloud service used by\n\n\nattackers are the same exactly, some of which have been changed or revoked.\n\n\nIn particular, Google Gmail accounts found in DOC malicious documents were recycled as\n\n\nthey were used in HWP malicious documents, and several HWP post script techniques used in\n\n\nvulnerability attacks also overlapped.\n\n\nMoreover, not only Windows-based malicious files but also Android-based smartphone attack\n\n\nmethods have been found in the 'Operation Spy Cloud' campaign.\n\n\n\n[Figure 13] Comparative analysis of 'Guemseong 121' attack cases\n\n\n-----\n\nThe same technique has been used for most PostScripts of the HWP malicious document file.\n\n\nThe similarity is very high in variable declaration, etc., and the same post scripts are used in\n\n\nsome cases. New techniques have been introduced to evade detection of security solutions in\n\n\nsome variants.\n\n\n-----\n\n[Figure 14] Comparison of postscript techniques used in malicious hwp documents\n\n\n-----\n\nThe comparative analysis of the functions of the final payload binary files generated when the\n\n\nvulnerability in the hwp document is triggered indicates that they consist of the same\n\n\ncommands. Also, cloud services such as Dropbox and pCloud have been used as command\n\n\ncontrol (C2) servers for information leaks.\n\n\n-----\n\n[Figure 15] Comparison of final binary functions installed as a hwp document file\n\n\nAs we have seen so far, the 'Geumseong 121' group has been continuously carrying out the\n\n\nmultiple threat activities targeting against South Korea.\n\n\n-----\n\nESRC analyzed many hacking tools and strategies used by the 'Guemseong 121' group to\n\n\nconfirm that the group has carried out cyber reconnaissance on a daily basis.\n\n\nAs cyber criminals become increasingly sophisticated and cyber security threats continue to\n\n\nrise and government-supported cyber operations emerge as a threat to national security,\n\n\nthreat intelligence-based response and cooperation in cybersecurity is urgently needed.\n\n\nWe will provide you with more detailed information related to our research containing the\n\n\nthreat cases and Indicators of Compromise (IoC) information of the 'Geumseong 121' group\n\n\non the 'Threat Inside' service.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.03.30_Spy_Cloud_Operation/Operation%20Spy%20Cloud_eng.pdf",
        "https://blog.alyac.co.kr/attachment/cfile8.uf@9977CF405E81A09B1C4CE2.pdf",
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-30 - The 'Spy Cloud' Operation Geumseong121 group carries out the APT attack disguising the evidence of North Korean defection.pdf"
    ],
    "report_names": [
        "Operation Spy Cloud_eng",
        "cfile8.uf@9977CF405E81A09B1C4CE2.pdf",
        "2020-03-30 - The 'Spy Cloud' Operation Geumseong121 group carries out the APT attack disguising the evidence of North Korean defection.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1585585745,
    "ts_modification_date": 1585585745,
    "files": {
        "pdf": "https://archive.orkl.eu/b262e09517bd3bf9abb0c19c20ef8fddb2b0012d.pdf",
        "text": "https://archive.orkl.eu/b262e09517bd3bf9abb0c19c20ef8fddb2b0012d.txt",
        "img": "https://archive.orkl.eu/b262e09517bd3bf9abb0c19c20ef8fddb2b0012d.jpg"
    }
}