{
    "id": "b448dfe6-7331-47bc-a2d8-d6d544476f1a",
    "created_at": "2022-10-25T16:48:23.96675Z",
    "updated_at": "2025-03-27T02:16:20.882425Z",
    "deleted_at": null,
    "sha1_hash": "a91289e835991b389e01254492d0fe84aeb21752",
    "title": "Turla group update Neuron malware",
    "authors": "NCSC",
    "file_creation_date": "2018-01-16T17:04:32Z",
    "file_modification_date": "2018-01-16T17:04:32Z",
    "file_size": 616712,
    "plain_text": "### TLP WHITE\n\n\n# Turla group update Neuron malware \n\n#### Version 1.0\n\n Reference: NCSC-Ops/04-18\n\n 18 January 2018\n\n  Crown Copyright 2018\n\n\n### TLP WHITE\n\nPage 1 of 8\n\n\n-----\n\n### TLP WHITE\n\n## About this Document\n\nThis NCSC report provides new intelligence on the Neuron malware, a tool used by\nthe Turla group to target the UK. It contains IOCs and signatures for detection and\nnetwork monitoring.\n\n## Handling of the Report\n\nInformation in this report has been given a Traffic Light Protocol (TLP) of WHITE,\nwhich means it can be shared within and beyond the CiSP community with no handling\nrestrictions.\n\n## Disclaimer\n\nThis report draws on reported information, as well as information derived from industry\nsources.\n\n### TLP WHITE\n\nPage 2 of 8\n\n\n-----\n\n### TLP WHITE\n\n Contents\n\nAbout this Document ........................................................................................................................... 1\n\nHandling of the Report ......................................................................................................................... 2\n\nDisclaimer .............................................................................................................................................. 2\n\nIntroduction ............................................................................................................................................ 4\n\nSummary of changes ....................................................................................................................... 4\n\nNeuron Updates ................................................................................................................................... 5\n\nLoader ................................................................................................................................................ 5\n\nPayload .............................................................................................................................................. 6\n\nEncryption ...................................................................................................................................... 6\n\nCommunications ........................................................................................................................... 6\n\nAssociated Files ............................................................................................................................... 6\n\nNeuron Yara ...................................................................................................................................... 7\n\n### TLP WHITE\n\nPage 3 of 8\n\n\n-----\n\n### TLP WHITE\n\n## Introduction\n\nIn November 2017, the NCSC released an advisory highlighting the Turla Group’s use\nof the tools Neuron and Nautilus.[1]\n\nSince then, the NCSC has identified a new version of the Neuron malware. The new\nversion has been modified to evade previous detection methods.\n\nNeuron operates on Microsoft Windows platforms, primarily targeting mail servers and\nweb servers. The NCSC has observed this tool being used by the Turla group to\nmaintain persistent network access and to conduct network operations.\n\nThe compile times contained within these new binaries show that the actor\nimplemented the required modifications to Neuron approximately five days after public\nreleases by the NCSC and other vendors.\n\nThis NCSC report provides new intelligence on the Neuron malware, a tool used by\nthe Turla group to target the UK. It contains IOCs and signatures for to be used for\nnetwork monitoring and detection.\n\nThe files analysed in this report are available on VirusTotal.\n\n### Summary of changes to Neuron malware\n\n  - The .NET payload is loaded in-memory as opposed to being dropped to disk;\n\n  - Communications have been modified to avoid detection;\n\n  - Some encryption methods have replaced RC4 with AES;\n\n  - The modifications are sufficient to avoid previously released signatures &\n\nIOCs.\n\n1 https://share.cisp.org.uk/docs/DOC-6912\n\n### TLP WHITE\n\nPage 4 of 8\n\n\n-----\n\n### TLP WHITE\n\n Neuron Updates\n\nA sample of Neuron was recently uploaded to VirusTotal. This sample appears to be\nan updated version of Neuron. Changes have primarily been made to the dropper and\nloading mechanisms.\n\nThe PDB string embedded within the binary supports the assumption that this is a\nnewer version by referring to itself as “neuron2”.\n\nD:\\Develop\\sps\\neuron2\\x64\\Release\\dcomnet.pdb\n\nThis sample contains sufficient modifications to frustrate detection, allowing Turla\noperations to continue.\n\n### Loader\n\nWith previous versions of Neuron, a native dropper was utilised to write the main\npayload to disk, establish persistence and ensure execution. This latest version uses\na native x64 loader to execute the .NET payload in-memory. The payload is encrypted\nwithin the loader, which ensures the payload never touches disk in plaintext. This\nmodification has likely been made to evade detection during disk scans performed by\nanti-virus products, however anti-virus products that scan memory will still likely be\nable to detect the payload running.\n\nThe loader has the required exports to enable the configuration as a service, therefore\nit's believed this will be the method used for persistence.\n\nThe loader can also specify which endpoints (HTTP(S) or pipe) to listen on by passing\nthem to the .NET executable as arguments. In this sample the endpoints specified are\ndifferent to previous versions:\n\n  - http://*:80/OWA/OAB/\n\n  - https://*:443/OWA/OAB/\n\nIf no arguments are provided the payload will use the following defaults for HTTP(S)\nor pipes:\n\n  - http://*:80/W3SVC/\n\n  - https://*:443/W3SVC/\n\n  - pipe://*/Winsock2/baseapi_http\n\nError handling has been added to the new payload. If the webserver encounters an\nexception it will attempt to use the default values above, if another exception occurs\nthen the payload will revert to using the default HTTP (port 80) value.\n\n### TLP WHITE\n\nPage 5 of 8\n\n\n-----\n\n### TLP WHITE\n\n Payload\n\nThe main payload is still a .NET executable, but several modifications have been made\nto its operation which are described below\n\n#### Encryption\n\nPrevious versions of Neuron used RC4 for the encryption of data stored on disk or\nsent over the network. Portions of the updated Neuron service have been migrated to\nAES, however, some components still rely on the RC4 implementation, such as\nencrypting command information.\n\nThe actors have configured multiple hardcoded encryption keys rather than using one\nfor everything. For example, one is used for normal communication between nodes,\nand another is used if the node is proxying a request. These modifications are likely\nimplemented to make detection and decryption by network defenders more difficult.\n\n#### Communications\n\nThe communication between clients and servers has also changed to avoid detection.\nThe server expects a POST request, but rather than using the previous pre-defined\nparameter names (cid, cadata etc.), the new function loops through each parameter\nlooking for certain characters within that parameter’s value to determine what\nfunctionality should be performed. This will allow the parameter names to be randomly\ngenerated and/or regularly changed, making it more difficult for network defenders to\nreliably detect communications.\n\nAs an example, the following characters are looked for (in the order shown) to\ndetermine which functionality should be performed:\n```\n Character Functionality\n # Set the AES salt\n ( and ) Return list of storage files\n ( Get and return defined storage file\n ) Add specified storage file to local storage (write to disk)\n - Send RSA encrypted encryption key (machine GUID)\n _ Proxy request through to another address\n, but not _ Perform specified command and return result\n\n### Associated Files\n\n TLP WHITE\n\n```\nPage 6 of 8\n\n|Character|Functionality|\n|---|---|\n|#|Set the AES salt|\n|( and )|Return list of storage files|\n|(|Get and return defined storage file|\n|)|Add specified storage file to local storage (write to disk)|\n|-|Send RSA encrypted encryption key (machine GUID)|\n|_|Proxy request through to another address|\n|, but not _|Perform specified command and return result|\n\n\n-----\n\n### TLP WHITE\n\n|Name|dcomnet.dll|\n|---|---|\n|Description|Neuron2 Loader (x64)|\n|MD5|60bcc6bc746078d81a9cd15cd4f199bb|\n|SHA1|c9fc7ce10aba20894ef914d2073021a48995db17|\n|SHA256|51616b207fde2ff1360a1364ff58270e0d46cf87a4c0c21b374a834dd9676927|\n|Size|170496|\n|Compile Time|28 Nov 2017 06:25:24|\n\n```\n Compile Time 28 Nov 2017 04:44:26\n\n### Neuron Yara\n\n```\n|Name|neuron2.exe|\n|---|---|\n|Description|Neuron2 Payload|\n|MD5|d891c9374ccb2a4cae2274170e8644d8|\n|SHA1|2fb145c64263006a95a0771b57e967977f63954d|\n|SHA256|83d8922e7a8212f1a2a9015973e668d7999b90e7000c31f57be83803747df015|\n|Size|59392|\n|Compile Time|28 Nov 2017 04:44:26|\n\n```\nrule neuron2_loader_strings {\n meta:\n  description = \"Rule for detection of Neuron2 based on strings within the loader\"\n  author = \"NCSC\"\n  hash = \"51616b207fde2ff1360a1364ff58270e0d46cf87a4c0c21b374a834dd9676927\"\n strings:\n  $ = \"dcom_api\" ascii\n  $ = \"http://*:80/OWA/OAB/\" ascii\n  $ = \"https://*:443/OWA/OAB/\" ascii\n  $ = \"dcomnetsrv.cpp\" wide\n  $ = \"dcomnet.dll\" ascii\n  $ = \"D:\\\\Develop\\\\sps\\\\neuron2\\\\x64\\\\Release\\\\dcomnet.pdb\" ascii\n condition:\n  (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and 2 of them\n}\n\n```\n\n### TLP WHITE\n\nPage 7 of 8\n\n\n-----\n\n### TLP WHITE\n\n```\nrule neuron2_decryption_routine {\n meta:\n  description = \"Rule for detection of Neuron2 based on the routine used to decrypt the\npayload\"\n  author = \"NCSC\"\n  hash = \"51616b207fde2ff1360a1364ff58270e0d46cf87a4c0c21b374a834dd9676927\"\n strings:\n  $ = {81 FA FF 00 00 00 0F B6 C2 0F 46 C2 0F B6 0C 04 48 03 CF 0F B6 D1 8A 0C 14 8D 50\n01 43 32 0C 13 41 88 0A 49 FF C2 49 83 E9 01}\n condition:\n  (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and all of them\n}\n\n```\n```\nrule neuron2_dotnet_strings {\n meta:\n  description = \"Rule for detection of the .NET payload for Neuron2 based on strings\nused\"\n  author = \"NCSC\"\n  hash = \"83d8922e7a8212f1a2a9015973e668d7999b90e7000c31f57be83803747df015\"\n strings:\n  $dotnetMagic = \"BSJB\" ascii\n  $s1 = \"http://*:80/W3SVC/\" wide\n  $s2 = \"https://*:443/W3SVC/\" wide\n  $s3 = \"neuron2.exe\" ascii\n  $s4 = \"D:\\\\Develop\\\\sps\\\\neuron2\\\\neuron2\\\\obj\\\\Release\\\\neuron2.pdb\" ascii\n condition:\n  (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $dotnetMagic and 2 of\n($s*)\n}\n\n```\n\n### TLP WHITE\n\nPage 8 of 8\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/o72u9tsw4zifxmktac4oreizhlud67ga",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.01.18.Turla_group_update_Neuron_malware/Turla%20Neuron%20Malware%20Update.pdf"
    ],
    "report_names": [
        "NCSC_Turla-Neuron-Malware-Update(01-18-2018)",
        "Turla Neuron Malware Update"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1516122272,
    "ts_modification_date": 1516122272,
    "files": {
        "pdf": "https://archive.orkl.eu/a91289e835991b389e01254492d0fe84aeb21752.pdf",
        "text": "https://archive.orkl.eu/a91289e835991b389e01254492d0fe84aeb21752.txt",
        "img": "https://archive.orkl.eu/a91289e835991b389e01254492d0fe84aeb21752.jpg"
    }
}