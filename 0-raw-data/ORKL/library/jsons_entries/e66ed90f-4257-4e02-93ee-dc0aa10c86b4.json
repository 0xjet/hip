{
    "id": "e66ed90f-4257-4e02-93ee-dc0aa10c86b4",
    "created_at": "2022-10-25T16:48:23.452787Z",
    "updated_at": "2025-03-27T02:15:59.33793Z",
    "deleted_at": null,
    "sha1_hash": "7754aeaf57ff3119805fe672c91fffbe1b54ea9a",
    "title": "Microsoft Word - Netwalker-Report-Final.docx",
    "authors": "",
    "file_creation_date": "2020-06-24T19:13:18Z",
    "file_modification_date": "2020-06-24T19:13:18Z",
    "file_size": 2898786,
    "plain_text": "## RANSOMWARE\n\n### PUBLISHED 10 JUNE 2020\n\nThis report is provided for situational awareness and network defense purposes only. DO NOT conduct searches\non, communicate with, or engage any individuals, organizations, or network addresses identified in this report.\nDoing so may put you or your employer at risk and jeopardize any ongoing investigation efforts.\n\nCopyright 2020\n\n\n# CSIT-20081\n\n## TECHNICAL ANALYSIS OF THE NETWALKER\n RANSOMWARE\n\n### PUBLISHED 10 JUNE 2020\n\n\n0\n\n\n-----\n\n## TECHNICAL ANALYSIS OF THE NETWALKER\n RANSOMWARE\n\n### KEY POINTS\n\n  - _NetWalker is ransomware written in C++ and advertised as a Ransomware-as-a-Service (RaaS)_\non forums by a user known to be part of a group designated as CIRCUS SPIDER.\n\n  - NetWalker uses a combination of ChaCha and Elliptic Curve Cryptography (ECC) with\nCurve25519 to encrypt files.\n\n  - The ransomware is controlled by a JSON configuration that is stored encrypted using RC4 in the\nmalware’s resource directory named 31337.\n\n  - NetWalker encrypts files on the local system, mapped network shares and enumerates the\nnetwork for additional shares, attempting to access them using the security tokens from all\nlogged-in users on the victim’s system.\n\n  - Processes that have file handles open to files that are targeted for encryption are terminated by\nNetWalker to encrypt as many files as possible.\n\n  - CIRCUS SPIDER initially provided victims with contact information via email, and around March\n2020 the group set up a ransom portal on the TOR network.\n\nThe NetWalker ransomware is being developed and maintained by a Russian-speaking actor designated\nas CIRCUS SPIDER. Initially discovered in September 2019 and having a compilation timestamp dating\nback to 28 August 2019, NetWalker has been found to be used in Big Game Hunting (BGH)-style\noperations while also being distributed via spam. CIRCUS SPIDER is advertising NetWalker as being a\nclosed-affiliate program, and verifies applicants before they are being accepted as an affiliate. The\nrequirements range from providing proof of previous revenue in similar affiliates programs, experience\nin the field and what type of industry the applicant is targeting.\n\nThe ransom amount, paid in Bitcoin, is configured by the affiliates and have been observed to range\nbetween USD $1,000 in spam campaigns up to USD $3 million in BGH campaigns. Affiliates that are\ntargeting corporations have been observed to base their ransom on the corporation’s revenue, such as\n$100,000 per $10 million in revenue. As of 12 May 2020, CIRCUS SPIDER is threatening to leak data that\nwas exfiltrated during the breach phase similar to TWISTED SPIDER and PINCHY SPIDER.\n\n### TECHNICAL ANALYSIS\n\n#### Initialization and Configuration\n\nNetWalker does not make use of any anti-debugging or anti-sandbox techniques. The only anti-analysis\ntechnique is the usage of dynamic imports. NetWalker resolves all the required imports by hash using\n32-bit Cycle Redundancy Check (CRC32). If NetWalker is unable to load any of the required libraries, it\nsleeps for 1 millisecond and exits. However, if the malware fails to resolve a function (which is unlikely\nto occur unless there was a programming error), it continues execution until the required function is\ncalled, which will cause an exception and crash the program.\n\n1\n\nCopyright 2020\n\n\n-----\n\nNetWalker does not run on systems that are configured with the Russian, Ukrainian, Belarusian or\nKazakh keyboard layouts. This check is commonly observed in malware, likely to reduce the risk of\nprosecution by law enforcements in the aforementioned countries. It is worth noting that malware\nauthors usually include detection for more Eastern European countries. Early versions of NetWalker did\nnot implement language detection, making it possible to encrypt files on, for example, systems set up\nfor Russian-language users.\n\nThere is no persistence mechanism, which means that if NetWalker process is terminated, it will not\nrestart. Therefore, the victim or operator would have to restart the process.\n\n##### Configuration\n\nThe malware stores its configuration in the resource directory 1337 and with the name 31337. The\nconfiguration is stored encrypted using RC4 where the key length and the key itself is the first bytes in\nthe resource data as shown in Figure 1.\n```\n00000000 04 00 00 00 2B 7E 43 2D CF E6 0E 9C 5C 7F 62 CA \n00000010 B8 36 35 21 CC FD B5 91 81 6B 74 D0 08 02 B0 34 \n00000020 E0 80 69 0F DF 87 35 D0 84 C9 4D 30 4F 80 D5 E7 \n00000030 D4 ED C6 1A 2E 74 77 C2 D3 A5 DC 24 B0 A1 D9 A9 \n00000040 10 7A 5D 56 1F 12 03 37 DF 72 3C D1 6D F1 D3 50 \n<...truncated...>\nRC4 key length\nRC4 key\nEncrypted configuration\n\n```\n\n##### Figure 1. Encrypted NetWalker Configuration\n\n\nNetWalker decrypts and parses the configuration that is in the JavaScript Object Notation (JSON) format.\nA truncated example is shown in Figure 2. A non-truncated configuration is included in Appendix A and a\nreference table describing all of the known JSON keys is included in Appendix B.\n```\n{\n  \"lfile\": \"{id}-Readme.txt\",\n  \"spsz\": 15360,\n  \"lend\": \"SGkhDQpZb3VyIGZpb<...snip...>gaW5wdXQgZm9ybToNCg0Ke2NvZGV9\",\n  \"namesz\": 8,\n  \"thr\": 1500,\n  \"mpk\": <redacted>,\n  \"pers\": false,\n  \"unlocker\": {\n    \"ignore\": {\n      \"pspath\": [\"*:\\\\windows*\", <...snip...> \"*\\\\Program\nFile*\\\\Fortinet\"],\n      \"use\": true,\n      \"prc\": [\"psexec.exe\", <...snip...> \"FCHelper64.exe\"]\n    },\n     \"use\": true\n    },\n  \"idsz\": 6,\n\n```\n2\n\nCopyright 2020\n\n\n-----\n\n```\n  \"mode\": 0,\n  \"net\": {\n    \"ignore\": {\n      \"use\": true,\n      \"disk\": true,\n      \"share\": [\"ipc$\", \"admin$\"]\n    },\n    \"use\": true\n  },\n  \"kill\": {\n    \"use\": true,\n    \"svcwait\": 0,\n    \"svc\": [\"Lotus*\", \"veeam*\", <...snip...> \"acrsch2svc*\"],\n    \"prc\": [\"nslsvice.exe\", \"pg*\", <...snip...> \"agntsvc.exe\"],\n    \"task\": [\"reboot\", \"restart\", \"shutdown\", \"logoff\", \"back\"]\n    },\n  \"white\": {\n    \"path\": [\"*system volume information\",\n<...snip...>\"\\\\\\\\*\\\\users\\\\*\\\\appdata\\\\*\\\\microsoft\"],\n    \"ext\": [\"msp\", \"exe\", <...snip...> \"themepack\"],\n    \"file\": [\"ntuser.dat*\", <...snip...> \"bootfont.bin\"]\n  },\n  \"onion2\":\n\"rnfdsgm6wb6j6su5txkekw4u4y47kp2eatvu7d6xhyn5cs4lt4pdrqqd[.]onion\",\n  \"onion1\":\n\"pb36hu4spl6cyjdfhing7h3pw6dhpk32ifemawkujj4gp33ejzdq3did[.]onion\"\n }\n\n```\n\n##### Figure 2. NetWalker Configuration\n\n\n##### Generate Infection Identifier\n\nHaving resolved all the required functions as well as decrypted and parsed the configuration, NetWalker\ngathers information about the system and generates a unique infection identifier (ID) for the victim’s\nsystem.\n\nNetWalker uses HMAC-SHA256 to calculate a hash from the gathered system information. The pseudocode shown in Figure 3 outlines the process of how NetWalker generates an infection ID. The infection\nID is used as the file extension for encrypted files, for the ransom note name and a registry key\ndescribed in the Key Recovery Blob Generation section. The length of the infection ID is defined by the\n```\nnamesz (for the encrypted file extension) and idsz (for the ransom note file name) entries in the\n\n```\nNetWalker configuration.\n```\nfrom Crypto.Cipher import XOR\nimport hashlib\nimport base64\ndef get_infection_id_from_hmac(cfg):\n  cfg_pub_key = base64_decode(cfg.mpk)\n  xored_pub_key = XOR.new('\\x36').encrypt(cfg_pub_key)\n  s = hashlib.sha256(xored_pub_key).digest()\n\n```\n3\n\nCopyright 2020\n\n\n-----\n\n```\n  s.update(GetComputerNameExW())\n  hw_profile = GetCurrentHwProfileW()\n  s.update(hw_profile.GUID)\n  # Undocked profile / Docked profile\n  s.update(hw_profile.docked_profile_string) \n  s256_hash = s.final()\n  xored_hash = XOR.new('\\x5C').encrypt(s256_hash)\n  final_hash = hashlib.sha256(xored_hash + s256_hash).hexdigest()\n  return final_hash[:cfg.namesz]\n\n```\n\n##### Figure 3. NetWalker Infection Identifier HMAC Pseudo-Code\n\n\n#### UAC Bypass\n\nNetWalker attempts to bypass Windows User Access Control (UAC). This feature is controlled in the\nNetWalker configuration using the JSON key pers. If enabled, NetWalker determines if the victim’s\nsystem is older than Windows 8.1. If it is not, no bypass attempt is made. If the victim system is running\nWindows 8.1 or newer, NetWalker sets a registry key\n```\nHKCU\\Software\\Classes\\exefile\\shell\\command\\open with the value being the file path to the\n\n```\nNetWalker executable. This path is read when the Windows Activation Client (slui.exe) is executed\nand the file pointed by the registry key value is consequently executed by the Windows Activation\nClient. As the slui.exe is running with high integrity, NetWalker is also executed with high integrity.\nThis technique is patched in the latest version of Windows 10.\n\nHowever, if the operating system is prior to Windows 7, NetWalker uses the registry key path\n```\nHKCU\\Software\\Classes\\mscfile\\shell\\command\\open. Instead of the Windows Activation\n\n```\nClient, NetWalker executes the Windows Event Viewer (eventvwr.exe). Similar to the Windows\nActivation Client, the Windows Event Viewer reads a file path from the registry key and executes it with\nthe same integrity as itself, resulting in elevated privileges. This technique works is exploitable from\nWindows 7 up to Windows 10 Creators Update build 15007.\n\nNetWalker removes the registry key after attempting the bypass, and if the malware was successful in\nelevating its privileges, the malware terminates its old instance. Otherwise, the malware continues its\nexecution with the current integrity.\n\n#### NetWalker Operation\n\nNetWalker attempts to encrypt as many files as possible by killing not only tasks, services, and processes\nthat are blacklisted, but also target processes that have open file handles to targeted files. This section\ndescribes the execution of the NetWalker ransomware.\n\nHaving initialized, NetWalker acquires the SeImpersonatePrivilege and SeDebugPrivilege to\nitself. These privileges are required in order to access other processes and to be able to impersonate the\nlogged in user when accessing remote file shares in order to encrypt files.\n\n4\n\nCopyright 2020\n\n\n-----\n\nIf the UAC bypass feature in enabled in the NetWalker configuration, the malware creates a mutex that\ncorresponds to the infection ID to ensure that only one instance of NetWalker is running at once. If the\nUAC bypass feature is disabled, it allows multiple instances of the malware to be run at the same time\non the victim’s system.\n\nBefore encrypting any files, NetWalker deletes the shadow copies from the system by executing\n```\nC:\\Windows\\system32\\vssadmin.exe delete shadows /all /quiet. The Windows system\n\n```\npath is retrieved by calling GetSystemDirectoryW.\n\nNetWalker includes functionality to terminate services, tasks and processes. This is configurable in the\nmalware configuration key kill. An example of a configuration block is shown in Figure 4.\n```\n\"kill\": {\n    \"use\": true,\n    \"task\": [\"reboot\", \"restart\", \"shutdown\", \"logoff\", \"back\"],\n    \"svcwait\": 0,\n    \"svc\": [\"Lotus*\", \"veeam*\", \"stc_endpt_svc\", \"acrsch2svc*\"],\n    \"prc\": [\"nslsvice.exe\", \"pg*\", \"infopath.exe\", \"agntsvc.exe\"]\n}\n\n```\n\n##### Figure 4. NetWalker Termination of Tasks, Processes and Services\n\n\nNetWalker creates an individual thread to handle each of these tasks. However, only the thread tasked\nwith terminating services exits after it has performed its tasks. The two remaining threads are run in a\ncontinuous loop and sleep 10 milliseconds (process termination thread) and 60 seconds (task\ntermination thread) in order to prevent tasks and processes from interfering with the file encryption\nprocess.\n\nIn order to ensure that services are given enough time to terminate, NetWalker uses the configuration\nkey kill.svcwait to sleep the number of seconds configured before continuing execution.\n\nNetWalker uses multiple threads to simultaneously encrypt files across multiple drives and directories.\nThe maximum number of threads used to encrypt files at any one time is determined by the\nconfiguration key thr and has been observed to range between 1,000 and 1,500, depending on the\noperator’s choice.\n\nIn order to keep track of the running threads, NetWalker spawns a thread which continuously tracks all\nthe running threads in order to allow new threads to execute when a previous thread has finished.\n\nBefore starting to encrypt files, NetWalker iterates over all the running process on the victim’s system\nand calculates a CRC32 checksum of the process name in order to compare it to BE037055\n(explorer.exe). NetWalker gathers the user security tokens from every running instance of\n```\nexplorer.exe in an attempt to authenticate to network shares. This is described in more detail in\n\n```\n_Encrypt Remote Files via Token Impersonation._\n\nNetWalker goes through three encryption phases that target files depending on their storage location\nand if the files are currently in use.\n\n5\n\nCopyright 2020\n\n\n-----\n\n##### Encrypt Local and Remote Files on Mapped Network Shares\n\nFirst, NetWalker retrieves all local drives and mapped network drives by calling\n```\nGetLogicalDriveStringsW. NetWalker creates a new encryption thread for each drive and the\n\n```\nthreads iterates the contents of the drive and creates a new thread for each file and sub-directory, this\nis to encrypt as many files as possible, as fast as possible.\n\nNetWalker operates in a blacklist fashion, in that it encrypts every file that does not match any of the\nentries in the blacklist. The malware’s blacklist includes file paths, extensions and filenames that are\nchecked before attempting to encrypt a file. In the event that NetWalker is unable to open a file handle\nto a given file due to it being locked by another process, NetWalker saves the file path to a list that is\nused at a later stage after the initial encryption process has been completed. The purpose and usage of\nthis list is described in the Unlock and Encrypt Locked Files section.\n\n##### Encrypt Remote Files via Token Impersonation\n\nIn the event that NetWalker is not able to access a mapped network share, the malware attempts to\naccess it using the security tokens previously gathered from the explorer.exe processes. This enables\nNetWalker to encrypt files that the currently logged-in user does not have permission to modify. In\norder to impersonate a logged-on user using the gathered tokens, NetWalker uses the Windows API\n```\nImpersonateLoggedOnUser. \n\n```\nNetWalker is able to discover and mount new shares if the net feature is enabled in the configuration\n(net.use). NetWalker calls WNetOpenEnumW with the RESOURCE_GLOBALNET flag set that enumerates\nresources across the network. In an attempt to gain access to each of the enumerated resources,\nNetWalker uses the security tokens that it previously gathered. This feature not only puts mapped file\nshares on a victim’s system at risk, but also shares that the victim and logged-in users have access to.\n\n##### Unlock and Encrypt Locked Files\n\nTerminating blacklisted processes is a common technique used by ransomware families in order to\nencrypt as many files as possible, such as databases. However, NetWalker takes this technique to the\nnext level. During the encryption process, NetWalker maintains a list of file paths that it was unable to\nopen. After completing the encryption of files on a victim’s system and network shares, NetWalker\niterates over the list of locked files and looks up the process that has an open handle to each of the files.\nIf the process is not blacklisted in the unlocker.ignore.prc or resides in a file path listed in\n```\nunlocker.ignore.pspath, NetWalker attempts to gain access to the process and terminate it, after\n\n```\nwhich NetWalker launches an encryption thread to encrypt the unlocked file.\n\nAn example of the blacklisted processes and process paths are listed in Table 1, taken from the analyzed\nsample’s configuration.\n\n**STRING** **TYPE** **DESCRIPTION**\n\n`*:\\\\windows*` Process path Windows executables\n\n`*:\\\\winnt*` Process path Windows executables\n\n`*:\\\\program file*\\\\vmwar*` Process path Processes related to VMware\n\n`*\\\\Program File*\\\\Fortinet` Process path Processes related to Fortinet endpoint\nprotection\n\n6\n\nCopyright 2020\n\n|STRING|TYPE|DESCRIPTION|\n|---|---|---|\n|*:\\\\windows*|Process path|Windows executables|\n|*:\\\\winnt*|Process path|Windows executables|\n|*:\\\\program file*\\\\vmwar*|Process path|Processes related to VMware|\n|*\\\\Program File*\\\\Fortinet|Process path|Processes related to Fortinet endpoint protection|\n\n\n-----\n\n`FCHelper64.exe` Process Fortinet Helper\n\n##### Table 1. NetWalker Process and Path Blacklist\n\n#### Cryptography\n\nNetWalker uses a combination of symmetric (ChaCha) and asymmetric (Curve25519) algorithms to\nencrypt files and protect the host specific private key while being stored in the Windows registry. Every\nfile is encrypted with its own ChaCha key and nonce. The ChaCha key material and Curve25519 key-pair\ngeneration is further described in this section.\n\n##### Generating Host-Specific Curve25519 Key Pair\n\nNetWalker generates a Curve25519 private key (priv0) by calling RtlRandomEx (RtlRandom for\nWindows XP and earlier) 32 times, reading one byte after each call. The malware uses the current\nsystem time as a seed, which, when RtlRandom is called, can be brute forced to recover the\nCurve25519 private key given the timestamp of the initial infection.\n\nHowever, with the introduction of RtlRandomEx in Windows Vista that improves the generation of\npseudo-random values, it is no longer possible to replicate random numbers given only a static seed.\nInstead of relying on a single seed, RtlRandomEx relies on the input seed and a 256-byte lookup table\nthat is initialized when ntdll.dll is loaded, i.e., when the NetWalker process is first launched. This\nlookup table is populated by calling RtlRandomEx, using the process cookie as a seed. The process\ncookie is according to the reactOS source code[1] a product of XORing multiple values, which by\nthemselves are not easily predictable (such as the processors KeSystemCalls, InteruptTime and\nsystem time), let alone the result. Thus, attacking the cryptographical implementation in NetWalker is\nlikely not feasible in a reasonable amount of time.\n\nNetWalker uses the private key (priv0) to derive a public key (pub0) that the malware uses to encrypt\nthe shared secrets derived to encrypt files. The shared secret derivation is described in the Deriving\n_Curve25519 Shared Secrets section._\n\n##### Deriving Curve25519 Shared Secrets\n\nNetWalker derives a new shared secret each time that the malware encrypts data, providing an\nindividual key for every encryption call, including file encryption. The input for the derivation is a\nCurve25519 public key, either the operator supplied key from the NetWalker configuration key mpk or\n```\npub0 (described in the previous section).\n\n```\n1\n\nhttps[:]//github[.]com/mirror/reactos/blob/c6d2b35ffc91e09f50dfb214ea58237509329d6b/reactos/ntoskrnl/ps/query.c#L793\n\n7\n\nCopyright 2020\n\n|psexec.exe|Process|PsExec Windows utility|\n|---|---|---|\n|system|Process|Windows System process|\n|forti*.exe|Process|Process related to Fortinet endpoint protection|\n|fmon.exe|Process|Fortinet real-time monitor|\n|fcaptmon.exe|Process|Fortinet sandbox agent|\n|FCHelper64.exe|Process|Fortinet Helper|\n\n\n-----\n\nTo encrypt a file, NetWalker generates a new Curve25519 key pair (priv1 and pub1) using the same\nschema as for generating the host-specific key pair, however, the newly generated key pair is only used\nfor one encryption operation (e.g. a single file), equivalent to a session key pair. NetWalker uses the\ngenerated private key (priv1) together with the host-specific public key (pub0) key to derive a 32-byte\nshared secret, used as the ChaCha encryption key.\n\nNetWalker hashes the shared secret using SHA256 and increments the first byte of the hash by one. The\nfirst 8 bytes of the modified hash is used as the ChaCha nonce. The reason for modifying only the first\nbyte of the SHA256 hash may be an attempt to throw off analysts.\n\n##### Key Recovery Blob Generation\n\nNetWalker uses the infection ID to store information in the Windows registry. The ransomware initially\nattempts to read the data from two different registry locations; HKLM\\Software\\<INFECTION ID>\nand HKCU\\Software\\<INFECTION ID>. These registry keys, if previously created by an earlier\nNetWalker instance, hold the host-specific Curve25519 key pair (public key; pub0 and private key;\n```\npriv0). The private key priv0 (which is required to decrypt files) is encrypted with ChaCha using a key\n\n```\nderived from the operator supplied public key (mpk) and a public key pubr derived from a generated\nkey pair (pubr, privr). The encryption schema is described in the Encryption _and Hashing section._\n\nIf none of the registry keys exists, NetWalker generates a new host-specific Curve25519 key pair as\npreviously described. An example of a key recovery blob stored in the registry is shown in Figure 4. The\n```\npub0 key is written to the registry in order for NetWalker to restart and encrypting files using the same\n\n```\nhost-specific public key.\n```\n000000 60 7F 1E 52 8E AC E9 7D 72 0D D6 AB 1D 2D DE A8 `..R.¬é}r.Ö«.-Þ¨ \n000010 59 55 55 E9 52 EF 86 22 95 EA E5 7C 9D E0 45 1C YUUéRï.\".êå|.àE.\n000020 23 4E 73 53 01 AF 4B A6 77 83 67 56 FA D4 F5 E4 #NsS.¯K¦w.gVúÔõä \n000030 1C A4 52 36 32 9A 95 60 BF 43 14 A1 09 43 D7 17 .¤R62..`¿C.¡.C×.\n000040 D2 54 F3 0A B8 2D AD 56 BD 63 CA 27 C8 FB BB 88 ÒTó.¸-.V½cÊ'Èû».\n000050 84 9C 55 1F C6 AD 81 62 3C 5F 9B 29 FD 0E 6C AA ..U.Æ..b<_.)ý.lª\n000060 56 63 6B 9F DA 5A 59 68 23 BB 40 15 F6 61 41 4F Vck.ÚZYh#»@.öaAO \n000070 D0 37 54 AF E7 25 EC 5C 89 70 93 EB 76 4A D5 4A Ð7T¯ç%ì\\.p.ëvJÕJ \n00008C 2F 71 A2 2E 6E 08 2D A5 D3 7D 92 8C       /q¢.n.-¥Ó}..\nHost-specific public Curve25519 key (pub0)\nCRC32 sum of pub0\nOne-time public Curve25519 key (pubr)\nChaCha nonce\nHMAC-SHA256 from ChaCha encryption\nChaCha Encrypted data (priv0)\n\n```\n\n##### Figure 4. Example NetWalker Key Recovery Blob Stored in the Registry\n\n\nAfter the key recovery blob is written to the Windows registry, NetWalker wipes the priv0 key from\nmemory by overwriting it with null bytes to prevent recovery of the priv0 from a memory dump of the\nNetWalker process. The priv0 key can only be decrypted with a key derived using the actor-controlled\nprivate key, corresponding to the mpk public key, and the one-time public key stored in the registry\n```\npubr. \n\n```\n8\n\nCopyright 2020\n\n\n-----\n\n##### Ransom-Note Generation\n\nThe key recovery blob is included in the ransom note where it is part of what is referred to as User\n```\ncode. The User code is a text blob that the victim needs to submit to the operators in order to\n\n```\nauthenticate to the ransom portal. The ransom portal is described in the Ransom portal section. The\n```\nUser code contains, in addition to the data stored in the Windows registry (excluding pub0), the\n\n```\nlength of the infection ID and the infection ID itself, the length and template string for the ransom note\nfilename. The operators use this information to provide the victim with a decrypter, tailored to the\nvictim’s environment. An example of the unencrypted User code is illustrated in Figure 5.\n```\n002D8A00 23 4E 73 53 01 AF 4B A6 77 83 67 56 FA D4 F5 E4 #NsS.¯K¦w.gVúÔõä \n002D8A10 1C A4 52 36 32 9A 95 60 BF 43 14 A1 09 43 D7 17 .¤R62..`¿C.¡.C×. \n002D8A20 D2 54 F3 0A B8 2D AD 56 BD 63 CA 27 C8 FB BB 88 ÒTó.¸-.V½cÊ'Èû». \n002D8A30 84 9C 55 1F C6 AD 81 62 3C 5F 9B 29 FD 0E 6C AA ..U.Æ..b<_.)ý.lª \n002D8A40 56 63 6B 9F DA 5A 59 68 23 BB 40 15 F6 61 41 4F Vck.ÚZYh#»@.öaAO \n002D8A50 D0 37 54 AF E7 25 EC 5C 89 70 93 EB 76 4A D5 4A Ð7T¯ç%ì\\.p.ëvJÕJ \n002D8A60 2F 71 A2 2E 6E 08 2D A5 D3 7D 92 8C 06 00 00 00 /q¢.n.-¥Ó}...... \n002D8A70 65 37 36 37 34 38 0F 00 00 00 7B 69 64 7D 2D 52 e76748....{id}-R \n002D8A80 65 61 64 6D 65 2E 74 78 74            eadme.txt \nKey recovery blob stored in the Windows registry (excl. pub0)\nLength of the infection ID (from the NetWalker configuration field idsz)\nInfection ID\nLength of ransom note file name template string\nRansom note file name template string\n\n```\n\n##### Figure 5. NetWalker Unencrypted User Code Inner Layer\n\n\nThe User code blob is encrypted using the same encryption scheme as when encrypting files and\nproduces the blob shown in Figure 6.\n```\n002DBC08 DD A3 E6 0A 15 35 1B 23 77 9E C8 FF CF 89 FA 8B Ý£æ..5.#w.ÈÿÏ.ú. \n002DBC18 06 4F 6B DC 5B B3 45 91 0B 17 C7 5E A9 D5 A5 91 .OkÜ[³E...Ç^©Õ¥. \n002DBC28 F7 9E 2D B3 F2 78 02 1A F5 03 4E 63 6D 6F 57 61 ÷.-³òx..õ.NcmoWa \n002DBC38 AB C5 4E 2F F7 50 56 F7 40 56 13 05 65 10 12 BA «ÅN/÷PV÷@V..e..º \n002DBC48 2D AB A7 31 4A 86 36 07 XX XX XX XX 23 4E 73 53 -«§1J.6.....#NsS \n002DBC58 71 2A 22 0D 70 5B 0D 4B D1 1D FD DD 38 5C 1E 54 q*\".p[.KÑ.ýÝ8\\.T \n002DBC68 DD 57 03 0E 65 81 4F F5 6D 63 06 A4 F2 1F 1E 73 ÝW..e.Oõmc.¤ò..s \n002DBC78 01 0F 19 67 91 55 35 D0 82 00 E9 7B 0C F1 FA 08 ...g.U5Ð..é{.ñú. \n002DBC88 02 D8 09 59 AC 77 66 78 0A 68 08 C8 CD EC 3F 9D .Ø.Y¬wfx.h.ÈÍì?. \n002DBC98 CA A7 B6 B8 37 B2 5F 76 CF 3D 97 F1 58 48 CF 8C Ê§¶¸7²_vÏ=.ñXHÏ. \n002DBCA8 B9 19 12 93 C9 ED FC 88 39 E5 B7 48 16 58 79 B7 ¹...Éíü.9å·H.Xy· \n002DBCB8 F3 24 61 F9 D9 94 32 5C 72 B8 07 3C 08 5C 66 66 ó$aùÙ.2\\r¸.<.\\ff \n002DBCC8 9D 1C 44 6C F8 35 AE 04 FD 56 6A E6 D9 4E EC A8 ..Dlø5®.ýVjæÙNì¨ \n002DBCD8 4C AE 04 E6 EB 85 46 FC 57            L®.æë.FüW \nChaCha nonce\nHMAC-SHA256 Hash from the ChaCha Encryption\nOne-time public key (pub1)\nCRC32 of the NetWalker configuration public key (campaign-specific censored)\nCRC32 of the host-specific public key (pub0)\nEncrypted User Code (Inner Layer)\n\n```\n\n##### Figure 6. NetWalker Encrypted User Code\n\n\n9\n\n\nCopyright 2020\n\n\n-----\n\nNetWalker encodes the encrypted User code using Base64 and writes it at the end of the ransom note\n(as highlighted in Figure 7) that it drops in every directory after encrypting a file.\n```\nHi!\nYour files are encrypted by Netwalker.\nAll encrypted files for this computer has extension: .e76748\n-If for some reason you read this text before the encryption ended,\nthis can be understood by the fact that the computer slows down,\nand your heart rate has increased due to the ability to turn it off,\nthen we recommend that you move away from the computer and accept that you\nhave been compromised.\nRebooting/shutdown will cause you to lose files without the possibility of\nrecovery.\n-Our encryption algorithms are very strong and your files are very well\nprotected,\nthe only way to get your files back is to cooperate with us and get the\ndecrypter program.\nDo not try to recover your files without a decrypter program, you may damage\nthem and then they will be impossible to recover.\nFor us this is just business and to prove to you our seriousness, we will\ndecrypt you one file for free.\nJust open our website, upload the encrypted file and get the decrypted file\nfor free.\n-Steps to get access on our website:\n1.Download and install tor-browser: https://torproject[.]org/\n2.Open our website:\npb36hu4spl6cyjdfhing7h3pw6dhpk32ifemawkujj4gp33ejzdq3did[.]onion\nIf the website is not available, open another one:\nrnfdsgm6wb6j6su5txkekw4u4y47kp2eatvu7d6xhyn5cs4lt4pdrqqd[.]onion\n3.Put your personal code in the input form:\n{VICTIM INFORMATION REDACTED}\n\n```\n\n##### Figure 7. NetWalker Ransom Note\n\n\n##### Encryption and Hashing\n\nIn addition to encrypting the data with ChaCha, NetWalker uses HMAC-SHA256 to ensure both integrity\nand authenticity of the encrypted data. NetWalker does not use a Windows API for the HMAC\ncalculation but has implemented it by hand. A Python implementation of the encryption function is\nshown in Figure 8.\n\n10\n\nCopyright 2020\n\n\n-----\n\n```\nimport hashlib\nfrom chacha import ChaCha # See footnote[2]\nfrom Crypto.Cipher import XOR\ndef encrypt_data(key, iv, in_data):\n  cc = ChaCha(key, iv[:8] rounds=8)\n  x_key = XOR.new('\\x36').encrypt(key)\n  digest = hashlib.sha256(key + x_key + in_data).digest()\n  enc_data = cc.encrypt(in_data)\n  x_key = XOR.new('\\x5C').encrypt(key)\n  final = hashlib.sha256(digest + enc_data + x_key + digest).hexdigest()\n  return final, enc_data\n\n```\n\n##### Figure 8. NetWalker Encryption Implementation\n\n\n##### Encryption of Files\n\nNetWalker supports three different encryption modes that determine how the ransomware encrypts\nthe targeted file. The operator uses the configuration key mode that can be either 0, 1 or 2. When the\nmodes 1 or 2 are specified in the configuration, they instruct NetWalker to only use one encryption\nmode while 0 is dynamic. The modes are described in Table 2.\n\n|MODE|DESCRIPTION|\n|---|---|\n|0|Encrypt three chunks of the file, the chunk size is defined by the configuration key spsz.|\n|1|Encrypt one chunk of the file at the start of the file. The chunk size is defined by spsz.|\n|2|Encrypt the full file.|\n\n\n##### Table 2. NetWalker Encryption Modes\n\n\nBefore NetWalker attempts to open a file for encryption, it sets the FILE_ATTRIBUTE_ARCHIVE\nattribute of the file. This attribute, according to the Microsoft documentation is designed to be used to\nmark a file for backup. After a file has been backed up, the attribute is cleared. However, it is unknown if\nthis flag is effectively used by any backup software.\n\nHaving opened a file, NetWalker reads the last four bytes of the file and compares them to the CRC32\nchecksum of the public key (mpk) in the NetWalker configuration. NetWalker uses this marker to\nindicate that a file is already encrypted.\n\nIf the encryption mode is configured as 0, NetWalker determines how to encrypt the file depending on\nthe file size. However, if the file size is less 239 bytes, which is a limit that is hardcoded in the malware,\nNetWalker ignores the file and continues with the next file. The determination of the encryption mode\nbased on the file size is described in Table 3.\n\n2 https[:]//www.seanet[.]com/~bugbee/crypto/chacha/chacha.py\n\n11\n\nCopyright 2020\n\n\n-----\n\n`239 <= File size < spsz` Encryption mode 2\n\n##### Table 3. NetWalker Encryption Modes\n\nIn encryption mode 0, NetWalker encrypts the start, middle and end of a file. In order to determine the\noffset of the middle chunk, NetWalker uses the formula shown in Figure 9.\n\n|FILE SIZE|DESCRIPTION|\n|---|---|\n|File size > spsz * 5|Encryption mode 0|\n|spz <= File size <= spsz * 5|Encryption mode 1|\n|239 <= File size < spsz|Encryption mode 2|\n\n```\noffset = (((file_size / 2) – 1) / spsz) * spsz)\n\n```\n\n##### Figure 9. NetWalker Chunk Offset Calculation\n\n\nThe malware saves the original file name information in the format shown in Figure 10. NetWalker\nencrypts the file information with ChaCha using the same key material that was used to encrypt the file\ncontents.\n```\n00601D70 06 00 00 00 65 37 36 37 34 38 0B 00 00 00 74 00 ....e76748....t. \n00601D80 65 00 73 00 74 00 69 00 6E 00 67 00 2E 00 74 00 e.s.t.i.n.g...t. \n00601D90 78 00 74 00           x.t. \nInfection ID Length\nInfection ID\nOriginal File Name Length\nOriginal File Name\n\n```\n\n##### Figure 10. NetWalker Unencrypted Original File Information of Encrypted File\n\n\n##### (Inner Layer)\n\n\nIn addition to original file information, NetWalker appends additional fields as illustrated in Figure 11.\nThese additional fields include all the information needed by the operators to be able to decrypt the file\nsuccessfully.\n```\n0060BDA8 8E 77 1A 44 A2 75 A8 9A 56 E5 A0 79 21 7E 57 CF .w.D¢u¨.Vå y!~WÏ \n0060BDB8 52 BE 67 26 0C 51 4C ED 8C EA F9 BB F7 F7 3F 97 R¾g&.QLí.êù»÷÷?. \n0060BDC8 1E EE 10 2A 24 00 00 00 A7 D3 93 56 58 78 81 62 .î.*$...§Ó.VXx.b \n0060BDD8 32 23 3D CA D3 58 1D ED 95 B3 2F 02 FB 00 65 65 2#=ÊÓX.í.³/.û.ee \n0060BDE8 DD B1 83 63 C5 CF A1 93 83 0B C0 D0 EA D2 10 6C Ý±.cÅÏ¡...ÀÐêÒ.l \n0060BDF8 A3 80 90 61 09 6F BE 23 C5 79 5E 15 3D 15 9C 34 £..a.o¾#Åy^.=..4 \n0060BE08 0B 9E BB 13 10 66 D5 F2 83 0B C0 D0 EA D2 10 6C ..»..fÕò..ÀÐêÒ.l \n0060BE18 A3 80 90 61 09 6F BE 23 C5 79 5E 15 3D 15 9C 34 £..a.o¾#Åy^.=..4 \n0060BE28 0B 9E BB 13 10 66 D5 F2 83 0B C0 D0 EA D2 10 6C ..»..fÕò..ÀÐêÒ.l \n0060BE38 A3 80 90 61 09 6F BE 23 C5 79 5E 15 3D 15 9C 34 £..a.o¾#Åy^.=..4 \n0060BE48 0B 9E BB 13 10 66 D5 F2 C4 C7 A4 D9 4E A0 BE 76 ..»..fÕòÄÇ¤ÙN ¾v \n0060BE58 00 00 00 00 00 3C 00 00 23 4E 73 53 01 AF 4B A6 .....<..#NsS.¯K¦ \n0060BE68 77 83 67 56 FA D4 F5 E4 1C A4 52 36 32 9A 95 60 w.gVúÔõä.¤R62..` \n0060BE78 BF 43 14 A1 09 43 D7 17 D2 54 F3 0A B8 2D AD 56 ¿C.¡.C×.ÒTó.¸-.V \n0060BE88 BD 63 CA 27 C8 FB BB 88 84 9C 55 1F C6 AD 81 62 ½cÊ'Èû»...U.Æ..b \n0060BE98 3C 5F 9B 29 FD 0E 6C AA 56 63 6B 9F DA 5A 59 68 <_.)ý.lªVck.ÚZYh \n0060BEA8 23 BB 40 15 F6 61 41 4F D0 37 54 AF E7 25 EC 5C #»@.öaAOÐ7T¯ç%ì\\ \n0060BEB8 89 70 93 EB 76 4A D5 4A 2F 71 A2 2E 6E 08 2D A5 .p.ëvJÕJ/q¢.n.-¥ \n\n```\n12\n\nCopyright 2020\n\n\n-----\n\n```\n0060BEC8 D3 7D 92 8C 83 2F 4F 14 5F 02 05 93 90 C0 9A 32 Ó}.../O._....À.2 \n0060BED8 78 43 3D 64 C9 D7 FA 52 EC 87 E4 B1 F4 1E 1B 24 xC=dÉ×úRì.ä±ô..$ \n0060BEE8 3B 9E AA 16 XX XX XX XX ;.ª..... \nOriginal File Information (Inner Layer, Encrypted)\nSize of Encrypted File Information\nHMAC-SHA256 Hash of Encrypted File Information\nHMAC-SHA256 Hashes of the Three Encrypted Chunks\nChaCha Nonce\nEncryption Mode\nChunk size (spsz)\nKey Recovery Blob\nOne-time Curve25519 public key (pub1)\nCRC32 of the configuration public key (mpk, campaign-specific censored)\n\n```\n\n##### Figure 11. NetWalker Encrypted File Footer\n\n\nThe Key Recovery Blob contains the information needed by the operators to decrypt the hostspecific private key in order to decrypt the file contents.\n\nNetWalker appends the file footer to the encrypted file and restores the modified timestamp of the\nencrypted file to what it was before the file was encrypted as well as changing the file extension to the\ninfection ID.\n\n#### Ransom Portal\n\nCIRCUS SPIDER has set up a ransom portal accessible through the Tor network on\n```\nrnfdsgm6wb6j6su5txkekw4u4y47kp2eatvu7d6xhyn5cs4lt4pdrqqd[.]onion and\npb36hu4spl6cyjdfhing7h3pw6dhpk32ifemawkujj4gp33ejzdq3did[.]onion. Upon visiting the\n\n```\nransom portal, the victim is asked to submit the User code from the ransom note. Alternatively, the\nvictim can supply a User key as shown in Figure 12. However, this key is only generated once the\nvictim has activated the portal as illustrated in Figure 13.\n\n13\n\nCopyright 2020\n\n\n-----\n\n##### Figure 12. NetWalker Ransom Portal Landing Page\n\n\n##### Figure 13. NetWalker Ransom Portal Main Page\n\n\nThe main portal page shows a countdown, ransom amount and the Bitcoin wallet address to where the\nransom is expected to be paid. The victim has seven days from the time that the portal is activated\nbefore the ransom demand is doubled.\n\nCIRCUS SPIDER offers free decryption of three files that are either images or Microsoft Word documents\nas proof that decryption of the files are indeed possible before paying any ransom as illustrated in Figure\n14.\n\n14\n\nCopyright 2020\n\n\n-----\n\nCrowdStrike Intelligence has been able to verify that the operators are able to decrypt encrypted files\nusing the free decryption tool. Figure 15 shows NetWalker’s frequently asked questions (FAQ) page on\nthe ransom portal.\n\n15\n\nCopyright 2020\n\n\n##### Figure 14. NetWalker Ransom Portal; Free Decryption \n\nCrowdStrike Intelligence has been able to verify that the operators are able to decrypt encrypted files\nusing the free decryption tool. Figure 15 shows NetWalker’s frequently asked questions (FAQ) page on\n\n\n-----\n\n##### Figure 15. NetWalker Ransom Portal; FAQ Page\n\n\n##### Figure 15. NetWalker Ransom Portal; FAQ Page\n\n\nCIRCUS SPIDER offers the victim the opportunity to get in touch with the operators through a chat form\nas shown in Figure 16. This is similar to other ransomware operations such as REvil, Maze and\nDopperPaymer.\n\n16\n\nCopyright 2020\n\n\n-----\n\n##### Figure 16. NetWalker Ransom Portal; Operator Chat\n\n\nAfter the victim has successfully paid the ransom, the decrypter is available on the portal main page as\nillustrated in Figure 17.\n\n\n##### Figure 17. NetWalker Ransom Portal Main Page After Payment\n\n\n17\n\n\nCopyright 2020\n\n\n-----\n\n#### Leak Site\n\nThe ransom portal also provides information about their leak site in which CIRCUS SPIDER is publishing\ndata that has been exfiltrated from the victim’s network. The leak site includes a countdown to when\nthe data will be published (if the ransom is not paid) and a link from where the data archive can be\ndownloaded along with the archive password. The post includes several screenshots that show a\npreview of files that have been exfiltrated during the breach. This information is provided regardless of\nwhether the countdown has expired or not, likely aimed to intimidate the victim to pay the ransom. A\nscreenshot of the leak site main page is illustrated in Figure 18.\n\n\n##### Figure 18. NetWalker Leak Site Main Page\n\n\n#### Decrypter\n\nThe decrypter is supplied to the victim in a ZIP archive that includes two files; an executable and a text\nfile, as shown in Figure 19.\n\n\n##### Figure 19. NetWalker Decrypter Archive Contents\n\n\nThe text file includes instructions on how to use the decrypter as shown in Figure 20.\n```\nThis decrypt file for COMPUTER(S): code_XXYYZZ\nRun decrypt.exe on PC which you want decrypt. Click \"Auto decrypt\" -> click\n\"delete crypter note file\" -> click \"decrypt\".\nThe program will automatically decrypt all files on an encrypted PC.\nThe decryption program will fit all encrypted PCs.\n\n```\nCopyright 2020\n\n\n18\n\n\n-----\n\n```\nAfter running the decryption in automatic or manual mode, the program can be\nclosed only when the close button becomes active,\nnever kill the process, if you kill the process your files will be damaged\nand they will not be able to recover.\nIf you want to decrypt the entire network at once, use the following command:\npsexec <params> \"decrypt.exe\" /S /D\n/s - silent mode.\n/d - delete lending(optional, not work without /s).\nThe program exit code will indicate the number of decrypted files.\n\n```\n\n##### Figure 20. NetWalker Decrypter Instructions\n\n\nThe decrypt.exe is the decrypter itself and comes with a graphical user interface in which the victim\ncan choose to automatically decrypt all the encrypted files recursively. The user interface is illustrated in\nFigure 21.\n\n\n##### Figure 21. NetWalker Decrypter User Interface\n\n\n### CONCLUSION\n\nCIRCUS SPIDER has demonstrated that they are a capable threat group with active development of their\nmalware and ransomware affiliate service, advertising payouts of over a million dollars per breach. The\nauthor shows attention to detail as NetWalker not only terminates per-configured applications, but also\napplications which prevent a target file from being encrypted.\n\nCIRCUS SPIDER claims that their entire operation is automated in which a victim will automatically be\nprovided with a decryptor after the ransom amount has been paid to the operator-controlled Bitcoin\nwallet. This also includes the leak site where data is automatically published when the countdown timer\nexpires, providing CIRCUS SPIDER with time to focus on improving their service rather than handling\nexfiltrated data and verifying ransom payments.\n\n19\n\nCopyright 2020\n\n\n-----\n\n### TACTICS, TECHNIQUES, AND PROCEDURES\n\nThe following TTPs may be used to characterize the NetWalker activity described in this Tipper:\n\n  - Uses ChaCha and Curve25519 encryption algorithms to encrypt file contents\n\n  - Stores the host-specific private key encrypted in the Windows registry\n\n  - Encrypts files on the local file system along with mapped and non-mapped network shares\n\n  - Encrypts all files that are not blacklisted in the NetWalker configuration\n\n  - Uses token impersonation in order to access network shares\n\n  - Uses a ransom portal on the TOR network to communicate with their victims\n\n  - Utilize data extortion to further pressure victims into paying a ransom\n\n#### Host Indicators of Attack\n\nThe tables below detail files belonging to the NetWalker ransomware including SHA256 hash and build\ntime.\n\n##### Executables\n\n**SHA256 HASH** **BUILD TIME (UTC)**\n\n`cf80fd95183ce1305becf6ea91d4ccfa0d87d923499d0893932` 2020-04-13 11:40:39\n```\n 4d63c0ed22dc4\n\n```\n`eb1470786fda58fc8291e099c7fcd5d36a04de85d1f6fe8683c` 2020-04-13 11:40:39\n```\n 1950b7119314e\n\n```\n`ee531cd7011cb5c2625d40892b70cf7e3860dbb92648391068e` 2020-03-26 15:20:15\n```\n 1f340e5d6c47f\n\n```\n`f2215e1a848bc5a5d172745201ea428b1d16fee7c814c5c5180` 2020-03-26 15:20:15\n```\n a94a134592e86\n\n```\n`4a4c435cb63270787529355b7f48c3af14a7b3c466eafdf99fc` 2020-03-26 15:20:15\n```\n 3b9f35a83acc7\n\n```\n`c68fa4e70bb109d5e1270ebab3f1d64a3ad50a083f7f82e1411` 2020-03-26 15:20:15\n```\n 56bdcb5f4ae16\n\n```\n`70e06890fa6619d761ef7bd890f4576fbd5371f06fcc8d12adb` 2020-03-26 15:20:15\n```\n 42dcb051a8490\n\n```\n`adf29a219ba2d948dd856ee7abaa51babaa30e11ad3ca56b58e` 2020-03-17 08:24:17\n```\n 66336c3c2369f\n\n```\n`15a4cd4a7baca3961fb0113164434c535af85cedd54744e14a4` 2020-03-01 12:46:56\n```\n d4d7b106dd060\n\n```\n`a1115fa0c74f51d35063f8d3caf1d49156ab78872c3723d5e58` 2020-03-01 12:46:56\n```\n 5a4ee8e4f8370\n\n```\n`d950a94534129202aa308f22d6c3d33f71af884d5556671a2b7` 2020-03-01 12:46:56\n```\n f6ba8994cc995\n\n```\n`b2dc53aca54c595ad4dabf625f8da49d839a1370686bfcd46cc` 2020-03-01 12:46:56\n```\n c12b3a6e8fa77\n\n```\n`55a32decdd9625245bf064c832962bf2271bff8bb5b8d8fb1bc` 2020-03-01 12:46:56\n```\n 6ec06dae4aea6\n\n```\n20\n\nCopyright 2020\n\n|SHA256 HASH|BUILD TIME (UTC)|\n|---|---|\n|cf80fd95183ce1305becf6ea91d4ccfa0d87d923499d0893932 4d63c0ed22dc4|2020-04-13 11:40:39|\n|eb1470786fda58fc8291e099c7fcd5d36a04de85d1f6fe8683c 1950b7119314e|2020-04-13 11:40:39|\n|ee531cd7011cb5c2625d40892b70cf7e3860dbb92648391068e 1f340e5d6c47f|2020-03-26 15:20:15|\n|f2215e1a848bc5a5d172745201ea428b1d16fee7c814c5c5180 a94a134592e86|2020-03-26 15:20:15|\n|4a4c435cb63270787529355b7f48c3af14a7b3c466eafdf99fc 3b9f35a83acc7|2020-03-26 15:20:15|\n|c68fa4e70bb109d5e1270ebab3f1d64a3ad50a083f7f82e1411 56bdcb5f4ae16|2020-03-26 15:20:15|\n|70e06890fa6619d761ef7bd890f4576fbd5371f06fcc8d12adb 42dcb051a8490|2020-03-26 15:20:15|\n|adf29a219ba2d948dd856ee7abaa51babaa30e11ad3ca56b58e 66336c3c2369f|2020-03-17 08:24:17|\n|15a4cd4a7baca3961fb0113164434c535af85cedd54744e14a4 d4d7b106dd060|2020-03-01 12:46:56|\n|a1115fa0c74f51d35063f8d3caf1d49156ab78872c3723d5e58 5a4ee8e4f8370|2020-03-01 12:46:56|\n|d950a94534129202aa308f22d6c3d33f71af884d5556671a2b7 f6ba8994cc995|2020-03-01 12:46:56|\n|b2dc53aca54c595ad4dabf625f8da49d839a1370686bfcd46cc c12b3a6e8fa77|2020-03-01 12:46:56|\n|55a32decdd9625245bf064c832962bf2271bff8bb5b8d8fb1bc 6ec06dae4aea6|2020-03-01 12:46:56|\n\n\n-----\n\n|b67bc1d9c7fe0672a79076e1546827e0642901cd62f7795d7a4 03bc3ba4a7117|2020-03-01 12:46:56|\n|---|---|\n|ce6fae0451e342c3280eeeedc487be09d15607b11f1d736798f 7260d309fb55b|2020-03-01 12:46:56|\n|07b89f41b347d639953fdbc0d98093670fc2d6ec50bad5c3521 65ddeca8ae9ad|2020-03-01 12:46:56|\n|48eebda6ff2c95ae27983149e3b7537e00905ab932b3bbf09e1 7956325a2c172|2020-03-01 12:46:56|\n|3f16af6271ed0cde4589012505e34a1ea3219ef39446829ace9 4d24391ba3993|2020-03-01 12:46:56|\n\n\n##### File System\n\nThe presence of one or more of the following files may indicate a NetWalker infection.\n\n**FILE PATH** **DESCRIPTION**\n\n`[A-F0-9]{5,8}-ReadMe.txt` Ransom note\n\n##### Registry\n\n**KEY** **VALUE(s)** **DATA**\n\n`HKCU\\Software\\[A-F0-9]{5,8}` `[A-F0-9]{5,8}` Store the key recovery blob\n(encrypted host-specific private key)\n\n`HKLM\\Software\\[A-F0-9]{5,8}` `[A-F0-9]{5,8}` Store the key recovery blob\n(encrypted host-specific private key)\n\n#### YARA Rules\n```\nrule CrowdStrike_CSIT_20081_01 : circus_spider netwalker ransomware \n{\n  meta:\n    copyright = \"(c) 2020 CrowdStrike Inc.\"\n    description = \"Detects the NetWalker ransomware\"\n    reports = \"CSIT-20081\"\n    version = \"202004281747\"\n    last_modified = \"2020-04-28\"\n    malware_family = \"NetWalker\"\n  strings:\n    $salsaconst = \"expand 32-byte kexpand 16-byte k\"\n    $ins_getapi = { 55 8B EC A1 ?? ?? ?? ?? 5D C3 }\n    $ins_crc32 = { 25 20 83 B8 ED 33 D0 }\n    $ins_push1337 = { 68 39 05 00 00 68 69 7A 00 00 }\n    $ins_rc4 = { 8B 45 ( E? |F? ) 83 C0 01 33 D2 B9 00 01 00 00 F7 F1 89\n55 }\n    $ins_c25519 = { 6A 00 68 41 DB 01 00 }\n  condition:\n    3 of them\n}\nrule CrowdStrike_CSIT_20081_02 : circus_spider netwalker ransomware \n\n```\n21\n\nCopyright 2020\n\n|FILE PATH|DESCRIPTION|\n|---|---|\n|[A-F0-9]{5,8}-ReadMe.txt|Ransom note|\n\n|KEY|VALUE(s)|DATA|\n|---|---|---|\n|HKCU\\Software\\[A-F0-9]{5,8}|[A-F0-9]{5,8}|Store the key recovery blob (encrypted host-specific private key)|\n|HKLM\\Software\\[A-F0-9]{5,8}|[A-F0-9]{5,8}|Store the key recovery blob (encrypted host-specific private key)|\n\n\n-----\n\n```\n{\n  meta:\n    copyright = \"(c) 2020 CrowdStrike Inc.\"\n    description = \"Detects the NetWalker ransomware\"\n    reports = \"CSIT-20081\"\n    version = \"202004281748\"\n    last_modified = \"2020-04-28\"\n    malware_family = \"NetWalker\"\n  strings:\n    $ = \"namesz\"  fullword\n    $ = \"crmask\"  fullword\n    $ = \"idsz\"   fullword\n    $ = \"lend\"   fullword\n    $ = \"lfile\"  fullword\n    $ = \"mpk\"   fullword\n    $ = \"namesz\"  fullword\n    $ = \"pspath\"  fullword\n    $ = \"rwsz\"   fullword\n    $ = \"spsz\"   fullword\n    $ = \"svcwait\" fullword\n    $ = \"unlocker\" fullword\n    $ = \"onion1\"  fullword\n  condition:\n    10 of them\n}\n\n#### Network Artifacts\n\n##### Infrastructure for NetWalker Ransomware\n\n```\n**INFRASTRUCTURE** **CONNECTION TYPE DESCRIPTION**\n\n`rnfdsgm6wb6j6su5txkekw4u4y47kp2e` HTTPS\n```\n atvu7d6xhyn5cs4lt4pdrqqd[.]onion\n\n```\n`pb36hu4spl6cyjdfhing7h3pw6dhpk32` HTTPS\n```\n ifemawkujj4gp33ejzdq3did[.]onion\n\n```\nCopyright 2020\n\n|INFRASTRUCTURE|CONNECTION TYPE|DESCRIPTION|\n|---|---|---|\n|rnfdsgm6wb6j6su5txkekw4u4y47kp2e atvu7d6xhyn5cs4lt4pdrqqd[.]onion|HTTPS|Ransom portal on TOR|\n|pb36hu4spl6cyjdfhing7h3pw6dhpk32 ifemawkujj4gp33ejzdq3did[.]onion|HTTPS|Ransom portal on TOR|\n\n\n22\n\n\n-----\n\n#### ATT&CK Framework\n\nThe following table maps reported NetWalker ransomware TTPs to the ATT&CK framework.\n\n**TACTIC** **TECHNIQUE** **OBSERVABLE**\n\n**EXECUTION** **T1059: Command Line Interface** NetWalker deletes the systems’ shadow\ncopies before encrypting files\n\n**PRIVILEGE** **T1134: Access Token Manipulation** NetWalker uses token manipulation to access\n**ESCALATION** **T1088: Bypass User Account Control** network shares.\n\nNetWalker features UAC bypass using the\nWindows Event Viewer and the Windows\nActivation Client\n\n**DISCOVERY** **T1083: File and Directory Discovery** NetWalker walks the system file system and\n\nnetwork shares in order to encrypt files\n\n**T1135: Network Share Discovery**\n\n**IMPACT** **T1486: Data Encrypted for Impact** NetWalker encrypts files that does not match\nits configured whitelist\n\nCopyright 2020\n\n|TACTIC|TECHNIQUE|OBSERVABLE|\n|---|---|---|\n|EXECUTION|T1059: Command Line Interface|NetWalker deletes the systems’ shadow copies before encrypting files|\n|PRIVILEGE ESCALATION|T1134: Access Token Manipulation T1088: Bypass User Account Control|NetWalker uses token manipulation to access network shares. NetWalker features UAC bypass using the Windows Event Viewer and the Windows Activation Client|\n|DISCOVERY|T1083: File and Directory Discovery T1135: Network Share Discovery|NetWalker walks the system file system and network shares in order to encrypt files|\n|IMPACT|T1486: Data Encrypted for Impact|NetWalker encrypts files that does not match its configured whitelist|\n\n\n23\n\n\n-----\n\n### APPENDIX A\n\n|JSON KEY|TYPE|DECRIPTION|\n|---|---|---|\n|lfile|String|Ransom note template string|\n|spsz|Integer|Encryption chunk size|\n|lend|String|Ransom note template (Base64 encoded)|\n|namesz|Integer|Length of the infection ID to be used in the file extension of encrypted files|\n|thr|Integer|Maximum number of concurrent encryption threads|\n|mpk|String|The operator’s ECC public key|\n|pers|Boolean|Attempt UAC bypass|\n|unlocker|Dictionary|Defines operation of the file unlocker|\n|unlocker.use|Boolean|Use the unlocker feature to unlock locked files|\n|unlocker.ignore|Dictionary|Includes processes and file paths to be ignored by the unlocker|\n|unlocker.ignore.pspath|List|List of paths to ignore|\n|unlocker.ignore.use|Boolean|Use the unlocker whitelist|\n|unlocker.prc|List|List of processes to ignore|\n|idsz|Integer|Length of the infection ID|\n|mode|Integer|Unknown|\n|net|Dictionary|Defines behavior of share enumeration|\n|net.use|Boolean|Enable or disable encryption of enumerated network shares|\n|net.ignore.use|Boolean|Use whitelist|\n|net.ignore.share|List|Whitelisted file shares|\n|net.ignore.disk|Boolean|Unknown|\n|kill|Dictionary|Defines behavior for terminating tasks, processes and services|\n|kill.use|Boolean|Enable or disable the termination feature|\n|kill.svcwait|Integer|Number of seconds to wait for the service termination thread to complete before continuing execution|\n|kill.svc|List|List of services to terminate|\n|kill.prc|List|List of processes to terminate|\n|kill.task|List|List of tasks to terminate|\n|white|Dictionary|File encryption whitelist|\n|white.path|List|List of whitelisted file paths|\n\n\n24\n\n\nCopyright 2020\n\n\n-----\n\n`onion2` String Address of the ransom portal on TOR\n\nCopyright 2020\n\n|white.ext|List|List of whitelisted file extensions|\n|---|---|---|\n|white.file|List|List of whitelisted file names|\n|onion1|String|Address of the ransom portal on TOR|\n|onion2|String|Address of the ransom portal on TOR|\n\n\n25\n\n\n-----\n\n### APPENDIX B\n\n#### NetWalker Configuration\n```\n{\n    \"lfile\": \"{id}-Readme.txt\",\n    \"spsz\": 15360,\n    \"lend\":\n\"SGkhDQpZb3VyIGZpbGVzIGFyZSBlbmNyeXB0ZWQgYnkgTmV0d2Fsa2VyLg0KQWxsIGVuY3J5cHRl\nZCBmaWxlcyBmb3IgdGhpcyBjb21wdXRlciBoYXMgZXh0ZW5zaW9uOiAue2lkfQ0KDQotLQ0KSWYgZ\nm9yIHNvbWUgcmVhc29uIHlvdSByZWFkIHRoaXMgdGV4dCBiZWZvcmUgdGhlIGVuY3J5cHRpb24gZW\n5kZWQsDQp0aGlzIGNhbiBiZSB1bmRlcnN0b29kIGJ5IHRoZSBmYWN0IHRoYXQgdGhlIGNvbXB1dGV\nyIHNsb3dzIGRvd24sDQphbmQgeW91ciBoZWFydCByYXRlIGhhcyBpbmNyZWFzZWQgZHVlIHRvIHRo\nZSBhYmlsaXR5IHRvIHR1cm4gaXQgb2ZmLA0KdGhlbiB3ZSByZWNvbW1lbmQgdGhhdCB5b3UgbW92Z\nSBhd2F5IGZyb20gdGhlIGNvbXB1dGVyIGFuZCBhY2NlcHQgdGhhdCB5b3UgaGF2ZSBiZWVuIGNvbX\nByb21pc2VkLg0KUmVib290aW5nL3NodXRkb3duIHdpbGwgY2F1c2UgeW91IHRvIGxvc2UgZmlsZXM\ngd2l0aG91dCB0aGUgcG9zc2liaWxpdHkgb2YgcmVjb3ZlcnkuDQoNCi0tDQpPdXIgIGVuY3J5cHRp\nb24gYWxnb3JpdGhtcyBhcmUgdmVyeSBzdHJvbmcgYW5kIHlvdXIgZmlsZXMgYXJlIHZlcnkgd2Vsb\nCBwcm90ZWN0ZWQsDQp0aGUgb25seSB3YXkgdG8gZ2V0IHlvdXIgZmlsZXMgYmFjayBpcyB0byBjb2\n9wZXJhdGUgd2l0aCB1cyBhbmQgZ2V0IHRoZSBkZWNyeXB0ZXIgcHJvZ3JhbS4NCg0KRG8gbm90IHR\nyeSB0byByZWNvdmVyIHlvdXIgZmlsZXMgd2l0aG91dCBhIGRlY3J5cHRlciBwcm9ncmFtLCB5b3Ug\nbWF5IGRhbWFnZSB0aGVtIGFuZCB0aGVuIHRoZXkgd2lsbCBiZSBpbXBvc3NpYmxlIHRvIHJlY292Z\nXIuDQoNCkZvciB1cyB0aGlzIGlzIGp1c3QgYnVzaW5lc3MgYW5kIHRvIHByb3ZlIHRvIHlvdSBvdX\nIgc2VyaW91c25lc3MsIHdlIHdpbGwgZGVjcnlwdCB5b3Ugb25lIGZpbGUgZm9yIGZyZWUuDQpKdXN\n0IG9wZW4gb3VyIHdlYnNpdGUsIHVwbG9hZCB0aGUgZW5jcnlwdGVkIGZpbGUgYW5kIGdldCB0aGUg\nZGVjcnlwdGVkIGZpbGUgZm9yIGZyZWUuDQoNCi0tDQoNClN0ZXBzIHRvIGdldCBhY2Nlc3Mgb24gb\n3VyIHdlYnNpdGU6DQoNCjEuRG93bmxvYWQgYW5kIGluc3RhbGwgdG9yLWJyb3dzZXI6IGh0dHBzOi\n8vdG9ycHJvamVjdC5vcmcvDQoNCjIuT3BlbiBvdXIgd2Vic2l0ZToge29uaW9uMX0NCklmIHRoZSB\n3ZWJzaXRlIGlzIG5vdCBhdmFpbGFibGUsIG9wZW4gYW5vdGhlciBvbmU6IHtvbmlvbjJ9DQoNCjMu\nUHV0IHlvdXIgcGVyc29uYWwgY29kZSBpbiB0aGUgaW5wdXQgZm9ybToNCg0Ke2NvZGV9\",\n    \"namesz\": 8,\n    \"thr\": 1500,\n    \"mpk\": \"<redacted>\",\n    \"pers\": false,\n    \"unlocker\": {\n       \"ignore\": {\n           \"pspath\": [\"*:\\\\windows*\", \"*:\\\\winnt*\", \"*:\\\\program\nfile*\\\\vmwar*\", \"*\\\\Program File*\\\\Fortinet\"],\n           \"use\": true,\n           \"prc\": [\"psexec.exe\", \"system\", \"forti*.exe\", \"fmon.exe\",\n\"fcaptmon.exe\", \"FCHelper64.exe\"]\n       },\n       \"use\": true\n    },\n    \"idsz\": 6,\n    \"mode\": 0,\n    \"net\": {\n       \"ignore\": {\n           \"use\": true,\n           \"disk\": true,\n           \"share\": [\"ipc$\", \"admin$\"]\n       },\n       \"use\": true\n\n```\n26\n\nCopyright 2020\n\n\n-----\n\n```\n    },\n    \"kill\": {\n       \"use\": true,\n       \"svcwait\": 0,\n       \"svc\": [\"Lotus*\", \"veeam*\", \"cbvscserv*\", \"hMailServer\",\n\"backup*\", \"*backup*\", \"apach*\", \"firebird*\", \"ibmiasrw\", \"IBM Domino*\",\n\"Simply Accounting Database Connection Manager\", \"IASJet\", \"QB*\", \"*sql*\",\n\"sql*\", \"QuickBooksDB*\", \"IISADMIN\", \"omsad\", \"dc*32\", \"server\nAdministrator\", \"wbengine\", \"mr2kserv\", \"MSExchange*\", \"ShadowProtectSvc\",\n\"SP*4\", \"teamviewer\", \"MMS\", \"AcronisAgent\", \"ARSM\", \"AcrSch2Svc\",\n\"vsnapvss\", \"SPXService\", \"StorageCraft ImageManager\", \"wrsvc\",\n\"stc_endpt_svc\", \"acrsch2svc*\"],\n       \"prc\": [\"nslsvice.exe\", \"pg*\", \"nservice.exe\", \"cbvscserv*\",\n\"ntrtscan.exe\", \"cbservi*\", \"hMailServer*\", \"IBM*\", \"bes10*\", \"black*\",\n\"apach*\", \"bd2*\", \"db*\", \"ba*\", \"be*\", \"QB*\", \"oracle*\", \"wbengine*\", \"vee*\",\n\"postg*\", \"sage*\", \"sap*\", \"b1*\", \"fdlaunch*\", \"msmdsrv*\", \"report*\",\n\"msdtssr*\", \"coldfus*\", \"cfdot*\", \"swag*\", \"swstrtr*\", \"jetty.exe\",\n\"wrsa.exe\", \"team*\", \"agent*\", \"store.exe\", \"sql*\", \"sqbcoreservice.exe\",\n\"thunderbird.exe\", \"ocssd.exe\", \"encsvc.exe\", \"excel.exe\", \"synctime.exe\",\n\"mspub.exe\", \"ocautoupds.exe\", \"thebat.exe\", \"dbeng50.exe\", \"*sql*\",\n\"mydesktopservice.exe\", \"onenote.exe\", \"outlook.exe\", \"powerpnt.exe\",\n\"msaccess.exe\", \"tbirdconfig.exe\", \"wordpad.exe\", \"ocomm.exe\", \"dbsnmp.exe\",\n\"thebat64.exe\", \"winword.exe\", \"oracle.exe\", \"xfssvccon.exe\",\n\"firefoxconfig.exe\", \"visio.exe\", \"mydesktopqos.exe\", \"infopath.exe\",\n\"agntsvc.exe\"],\n       \"task\": [\"reboot\", \"restart\", \"shutdown\", \"logoff\", \"back\"]\n    },\n    \"white\": {\n       \"path\": [\"*system volume information\", \"*windows.old\",\n\"*:\\\\users\\\\*\\\\*temp\", \"*msocache\", \"*:\\\\winnt\", \"*$windows.~ws\",\n\"*perflogs\", \"*boot\", \"*:\\\\windows\", \"*:\\\\program file*\\\\vmware\",\n\"\\\\\\\\*\\\\users\\\\*\\\\*temp\", \"\\\\\\\\*\\\\winnt\", \"\\\\\\\\*\\\\windows\", \"*\\\\program\nfile*\\\\vmware\", \"*appdata*microsoft\", \"*appdata*packages\",\n\"*microsoft\\\\provisioning\", \"*dvd maker\", \"*Internet Explorer\", \"*Mozilla\",\n\"*Mozilla*\", \"*Old Firefox data\", \"*\\\\program file*\\\\windows media*\",\n\"*\\\\program file*\\\\windows portable*\", \"*windows defender\", \"*\\\\program\nfile*\\\\windows nt\", \"*\\\\program file*\\\\windows photo*\", \"*\\\\program\nfile*\\\\windows side*\", \"*\\\\program file*\\\\windowspowershell\", \"*\\\\program\nfile*\\\\cuass*\", \"*\\\\program file*\\\\microsoft games\", \"*\\\\program\nfile*\\\\common files\\\\system\", \"*\\\\program file*\\\\common files\\\\*shared\",\n\"*\\\\program file*\\\\common files\\\\reference ass*\", \"*\\\\windows\\\\cache*\",\n\"*temporary internet*\", \"*media player\",\n\"*:\\\\users\\\\*\\\\appdata\\\\*\\\\microsoft\",\n\"\\\\\\\\*\\\\users\\\\*\\\\appdata\\\\*\\\\microsoft\"],\n       \"ext\": [\"msp\", \"exe\", \"sys\", \"msc\", \"mod\", \"clb\", \"mui\",\n\"regtrans-ms\", \"theme\", \"hta\", \"shs\", \"nomedia\", \"diagpkg\", \"cab\", \"ics\",\n\"msstyles\", \"cur\", \"drv\", \"icns\", \"diagcfg\", \"dll\", \"ocx\", \"lnk\", \"ico\",\n\"idx\", \"ps1\", \"mpa\", \"cpl\", \"icl\", \"msu\", \"msi\", \"nls\", \"scr\", \"adv\", \"386\",\n\"com\", \"hlp\", \"rom\", \"lock\", \"386\", \"wpx\", \"ani\", \"prf\", \"rtp\", \"ldf\", \"key\",\n\"diagcab\", \"cmd\", \"spl\", \"deskthemepack\", \"bat\", \"themepack\"],\n       \"file\": [\"ntuser.dat*\", \"iconcache.db\", \"gdipfont*.dat\",\n\"ntuser.ini\", \"usrclass.dat\", \"usrclass.dat*\", \"boot.ini\", \"bootmgr\",\n\"bootnxt\", \"desktop.ini\", \"ntuser.dat\", \"autorun.inf\", \"ntldr\", \"thumbs.db\",\n\"bootsect.bak\", \"bootfont.bin\"]\n\n```\n27\n\nCopyright 2020\n\n\n-----\n\n```\n    },\n    \"onion2\":\n\"rnfdsgm6wb6j6su5txkekw4u4y47kp2eatvu7d6xhyn5cs4lt4pdrqqd[.]onion\",\n    \"onion1\":\n\"pb36hu4spl6cyjdfhing7h3pw6dhpk32ifemawkujj4gp33ejzdq3did[.]onion\"\n }\n\n```\nCopyright 2020\n\n\n28\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://go.crowdstrike.com/rs/281-OBQ-266/images/ReportCSIT-20081e.pdf"
    ],
    "report_names": [
        "ReportCSIT-20081e.pdf"
    ],
    "threat_actors": [
        {
            "id": "53201ab8-30d2-4722-816e-f914604e78df",
            "created_at": "2022-10-25T16:07:23.466825Z",
            "updated_at": "2025-03-27T02:02:09.817805Z",
            "deleted_at": null,
            "main_name": "Circus Spider",
            "aliases": [],
            "source_name": "ETDA:Circus Spider",
            "tools": [
                "Koko Ransomware",
                "MailTo",
                "NetWalker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "373d61cc-32a0-4c0c-b48b-ff9e3f1357ac",
            "created_at": "2023-01-06T13:46:39.222456Z",
            "updated_at": "2025-03-27T02:00:03.024584Z",
            "deleted_at": null,
            "main_name": "CIRCUS SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:CIRCUS SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8610b0d9-a6af-4010-818f-28671efc5d5e",
            "created_at": "2023-01-06T13:46:38.897477Z",
            "updated_at": "2025-03-27T02:00:02.945669Z",
            "deleted_at": null,
            "main_name": "PINCHY SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:PINCHY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c84bbd2e-003d-4c43-8a46-d777455db2c7",
            "created_at": "2022-10-25T15:50:23.701006Z",
            "updated_at": "2025-03-27T02:00:55.527357Z",
            "deleted_at": null,
            "main_name": "GOLD SOUTHFIELD",
            "aliases": [
                "GOLD SOUTHFIELD",
                "Pinchy Spider"
            ],
            "source_name": "MITRE:GOLD SOUTHFIELD",
            "tools": [
                "ConnectWise",
                "REvil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e9f85280-337c-4321-b872-0919f8ef64a6",
            "created_at": "2022-10-25T16:07:24.261761Z",
            "updated_at": "2025-03-27T02:02:10.153781Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Gold Village",
                "Maze Team",
                "TA2101",
                "Twisted Spider"
            ],
            "source_name": "ETDA:TA2101",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BokBot",
                "Buran",
                "ChaCha",
                "Cobalt Strike",
                "CobaltStrike",
                "Egregor",
                "IceID",
                "IcedID",
                "Mimikatz",
                "PsExec",
                "SharpHound",
                "VegaLocker",
                "WinSCP",
                "cobeacon",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9df68733-9bcd-43b1-88f1-24b110fa3d56",
            "created_at": "2022-10-25T16:07:24.051993Z",
            "updated_at": "2025-03-27T02:02:10.091553Z",
            "deleted_at": null,
            "main_name": "Pinchy Spider",
            "aliases": [
                "Gold Garden",
                "Gold Southfield",
                "Pinchy Spider"
            ],
            "source_name": "ETDA:Pinchy Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "GandCrab",
                "GrandCrab",
                "REvil",
                "Sodin",
                "Sodinokibi",
                "VIDAR",
                "Vidar Stealer",
                "certutil",
                "certutil.exe",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041759,
    "ts_creation_date": 1593025998,
    "ts_modification_date": 1593025998,
    "files": {
        "pdf": "https://archive.orkl.eu/7754aeaf57ff3119805fe672c91fffbe1b54ea9a.pdf",
        "text": "https://archive.orkl.eu/7754aeaf57ff3119805fe672c91fffbe1b54ea9a.txt",
        "img": "https://archive.orkl.eu/7754aeaf57ff3119805fe672c91fffbe1b54ea9a.jpg"
    }
}