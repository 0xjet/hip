{
    "id": "3baa247a-3ece-4007-bd44-2993dc07c4dc",
    "created_at": "2023-01-12T15:10:59.56774Z",
    "updated_at": "2025-03-27T02:15:37.897194Z",
    "deleted_at": null,
    "sha1_hash": "5f235d494d98ac20d98eca24d5548b50f35da03b",
    "title": "2022-01-28 - Log4j Exploit Hits Again- Vulnerable Unifi Network Application (Ubiquiti) at Risk",
    "authors": "",
    "file_creation_date": "2022-05-28T05:01:54Z",
    "file_modification_date": "2022-05-28T05:01:54Z",
    "file_size": 1016346,
    "plain_text": "# Log4j Exploit Hits Again: Vulnerable Unifi Network Application (Ubiquiti) at Risk\n\n**[blog.morphisec.com/log4j-exploit-targets-vulnerable-unifi-network-applications](https://blog.morphisec.com/log4j-exploit-targets-vulnerable-unifi-network-applications)**\n\n## Breach Prevention Blog\n\nCybersecurity news, threat research, and more from the leader in making breach prevention\neasy\n\nPosted by [Morphisec Labs on January 28, 2022](https://blog.morphisec.com/author/morphisec-labs)\n\n[Tweet](https://twitter.com/share)\n\n\n-----\n\nAs a continuation to our previously published blog post on VMWare Horizon being targeted\nthrough the Log4j vulnerability, we have now identified Unifi Network applications being\ntargeted in a similar way on a number of occasions. Based on prevention logs from\nMorphisec, the first appearance of successful exploitation occurred on January 20, 2022.\nMorphisec expertise comes from being the best breach prevention software, using Moving\nTarget Defense, that stops ransomware and other advanced attacks that today’s NGAV and\nEDR solutions are unable to stop, in a timely and cost-efficient manner.\n\nThe uniqueness of the attack is that the C2 is correlated to a previous SolarWind attack as\nreported by [CrowdStrike.](https://www.crowdstrike.com/blog/how-falcon-complete-stopped-a-solarwinds-serv-u-exploit-campaign/)\n\nNot surprisingly, a POC for the exploitation of Unifi Network was released a month prior (24th\nof December), and we, therefore, expected to see this type of targeted exploitation in the\nwild.\n\n\n-----\n\n## Technical Details\n\n[The unifi vulnerability was first posted by @sprocket_ed.](https://twitter.com/sprocket_ed)\n\n[RCE in Unifi Network Application using #log4j/#log4shell. (CVE-2021-44228) Going to](https://twitter.com/hashtag/log4j?src=hash&ref_src=twsrc%5Etfw)\n[be automating this and writing a blog article soon. pic.twitter.com/cPXjK1Agpw](https://t.co/cPXjK1Agpw)\n\n[— ed (@sprocket_ed) December 21, 2021](https://twitter.com/sprocket_ed/status/1473301038832701441?ref_src=twsrc%5Etfw)\n\nLog4j Vulnerability (Log4Shell) on Ubiquiti UniFi\n\nUbiquiti normal execution command line:\n\n\n-----\n\n-Dfile.encoding=UTF-8\n\n-Djava.awt.headless=true\n\n-Dapple.awt.UIElement=true\n\n-Dunifi.core.enabled=false\n\n-Xmx1024M\n\n-Xrs\n\n-XX:+ExitOnOutOfMemoryError\n\n-XX:+CrashOnOutOfMemoryError\n\n-XX:ErrorFile=C:\\Users\\Administrator\\Ubiquiti UniFi\\logs\\hs_err_pid%p.log\n\n-jar\n\nC:\\Users\\Administrator\\Ubiquiti UniFi\\lib\\ace.jar\n\nstart\n\n(We recommend identifying powershell execution as a child process to this command-line\nexecution statement)\n\nFull research:\n\n[https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi](https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi)\n\nPOC:\n\n[https://github.com/puzzlepeaches/Log4jUnifi](https://github.com/puzzlepeaches/Log4jUnifi)\n\nIn most cases, unifi applications (by ubiquiti ) are deployed with the highest privilege levels.\n\n\n-----\n\n## Powershell Reverse TCP to CobaltStrike\n\nWe have identified in-memory cobalt beacon dropped by the following base64 encoded\nreverse tcp powershell script which were communicating with 179.60.150[.]32:\n\nOrigin:\n\nhttps://github.com/ivan-sincek/powershell-reversetcp/blob/master/src/prompt/powershell_reverse_tcp_prompt.ps1\n\nWe found that the C2 used in the attack was previously noted as part of the SolarWind\n[supply chain attack, Cobalt beacon C2, and was attributed to TA505 aka GRACEFUL](https://attack.mitre.org/groups/G0092/)\nSPIDER, a well known financially motivated threat actor group. These attacks are often\nmotivated by opportunities to sell sensitive data or perpetrate ransomware demands to\n[prevent exposure. TA505, the name given by Proofpoint, has been in the cybercrime](https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter)\nbusiness for at least five years. This is the group behind the infamous Dridex banking trojan\nand Locky ransomware, delivered through malicious email campaigns via Necurs botnet.\nOther malware associated with TA505 includes Philadelphia and GlobeImposter ransomware\nfamilies. More on TA505 [here.](https://blog.morphisec.com/explosive-new-mirrorblast-campaign-targets-financial-companies)\n\nThese types of attacks underscore how traditional security solutions are failing to detect and\nprevent the latest threats, which have become far more frequent and sophisticated. With the\naverage ransomware attack now occurring every few seconds, and ransoms costing\norganizations millions, security teams should explore ways to augment or replace current\nsolutions that are no longer adequate. Leading analysts, such as Gartner, are pointing to\nMoving Target Defense as a way to detect and prevent attacks that are now bypassing next\n\n\n-----\n\ngeneration antivirus (NGAV) and endpoint detection and response (EDR) solutions.\nMorphisec offers Moving Target Defense for endpoints and Windows or Linux servers. CLICK\n[HERE for more information. Firms should also consider Incident Response (IR) services, to](https://www.morphisec.com/incident-response-services)\nnot only respond to Indicators of Compromise (IOCs) but also assess security postures for\nweaknesses and provide recommendations to improve defenses. Morphisec offers IR\nservices that leverage our deep Moving Target Defense expertise and technology. CLICK\nHERE for more information.\n\nRelated tweet on C2:\n\nBunch of Cobalt Strike C2 on the same range running with default configs.\n\n179.60.150.]25/ptj\n179.60.150.]26/g.pixel\n179.60.150.]27/cx\n179.60.150.]29/ca\n179.60.150.]30/en_US/all.js\n179.60.150.]32/cm\n\n[— ♠ Michael Koczwara (@MichalKoczwara) August 12, 2021](https://twitter.com/MichalKoczwara/status/1425745034822004738?ref_src=twsrc%5Etfw)\n\n### Indicators of Compromise (IOCs)\n\nC2 179.60.150[.]32\n\n\nObserved\nVulnerable\nJars\n\n\n2275247244f03091373f51d613939f5a96c48481c60832d443c112611142ceba\n\n5e53ee9c3299a60b313bdfa3d8b8aaafae67d70eb565a7999e42139d51614462\n\ncccd16f0c8e1f490f9cf8b0a42d61b52185f0e44e66e098c4f116b3e19f75b1c\n\n079089176ad528393c0641a630d90ca90a353a3c1765fb052e8c43ed45a29506\n\n\n-----\n\n### Subscribe to our blog\n\nStay in the loop with industry insight, cyber security trends, and cyber attack information and\ncompany updates.\n\n### Search Our Site\n\n Recent Posts\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-28 - Log4j Exploit Hits Again- Vulnerable Unifi Network Application (Ubiquiti) at Risk.pdf"
    ],
    "report_names": [
        "2022-01-28 - Log4j Exploit Hits Again- Vulnerable Unifi Network Application (Ubiquiti) at Risk.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536259,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1653714114,
    "ts_modification_date": 1653714114,
    "files": {
        "pdf": "https://archive.orkl.eu/5f235d494d98ac20d98eca24d5548b50f35da03b.pdf",
        "text": "https://archive.orkl.eu/5f235d494d98ac20d98eca24d5548b50f35da03b.txt",
        "img": "https://archive.orkl.eu/5f235d494d98ac20d98eca24d5548b50f35da03b.jpg"
    }
}