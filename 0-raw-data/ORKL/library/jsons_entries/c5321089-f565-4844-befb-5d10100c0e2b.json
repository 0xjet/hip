{
    "id": "c5321089-f565-4844-befb-5d10100c0e2b",
    "created_at": "2023-01-12T15:09:16.207022Z",
    "updated_at": "2025-03-27T02:06:15.80741Z",
    "deleted_at": null,
    "sha1_hash": "dff00d19db80b2b27500c103b8a031faf0cc5154",
    "title": "2022-08-17 - IRATA",
    "authors": "",
    "file_creation_date": "2022-09-12T12:00:37Z",
    "file_modification_date": "2022-09-12T12:00:37Z",
    "file_size": 1038726,
    "plain_text": "# IRATA - One Cert Cyber ​​Security\n\n**onecert.ir/portal/blog/irata**\n\n17 Aug 2022\nVirus Lab\n[Malware](https://onecert.ir/portal/blog/category/18/malware)\n\nAs opposed to previously spotted attacks such as the Flubot Trojan that steals sensitive data\nfrom devices by injecting code and displaying overlay screens, the malicious applications\npresented in this research rely on social engineering to lure victims into handing over their\ncredit cards details. The modus operandi is always the same. The victims receive a\nlegitimate-looking SMS with a link to a phishing page that is impersonating government\nservices, and lures them to download a malicious Android application and then pay a small\nfee for the service. The malicious application not only collects the victim’s credit card\nnumbers, but also gains access to their 2FA authentication SMS, and turn the victim’s device\ninto a bot capable of spreading similar phishing SMS to other potential victims.\n\nThis article describes technical details about how these campaigns are constructed, their\nbusiness model, and how they became so successful despite utilizing unsophisticated tools.\nIn addition, the investigation shows that due to the attackers’ own low OPSEC (operations\nsecurity) level, the victims’ data is not protected and is freely accessible to third parties.\n\nThe attackers are still thriving and continue to update their malicious applications and\nunderlying infrastructure on almost a daily basis.\n\n## Infection Chain\n\n\n-----\n\nFigure 1: The infection chain\n\nThe attack starts with a phishing SMS message. In many cases, it’s a message from an\nelectronic judicial notification system that notifies the victim that a new complaint was opened\nagainst them. The seriousness of such an issue might explain why the campaign has gone\nmalware. When official government messages are involved, most citizens do not think twice\nbefore clicking the links.\n\n\n-----\n\nFigure 2: Examples of phishing SMS sent to the Iranian citizens\n\nThe SMS contains a fake notification from the Iranian Judiciary about a new file/complaint\nand suggests clicks on the link to review the full complaint. The link from the SMS leads to a\nphishing site which usually mimics an official government site. The user is notified of the\ncomplaint filed against them, and personal information is requested in order to proceed to the\nelectronic system and avoid visiting the offline branch due to COVID limitations.\n\n\n-----\n\nFigure 3: The phishing site notifies the victim about the complaint against them\n\nAfter entering personal information, the victim is redirected to a page to download a\nmalicious .apk file. Once installed, the Android application shows a fake login page for the\nSana (Iranian electronic judicial notification system) authentication service requesting the\nvictim’s mobile phone number and national identity number. It also notifies the victim that\nthey need to pay a fee to proceed. It is only a small amount (20,000, or sometimes 50,000\nIranian Rials – around $1), which reduces the suspicion and makes the operation look more\nlegitimate.\n\n\n-----\n\nFigure 4: phishing page collecting credit card details\n\nAfter entering the details, the victim is redirected to a payment page. Similar to most phishing\npages, after credit card data is submitted the site shows a “payment error” message, but the\nmoney is already gone. Of course, the sum of 20,000 Iranian Rials is not the attackers’\nultimate goal. The attacker has the victim’s credit information, and the Android application –\nthe backdoor still installed on the victim’s device – can facilitate additional theft whenever a\n2FA bypass or additional verification is required from the credit card company.\n\n**These Android backdoor capabilities include:**\n\n**SMS stealing.\n\nImmediately after the installation of the fake app, all the victim’s SMS**\nmessages are uploaded to the attacker’s server.\n\n**Hiding to maintain persistence.\n\nAfter the credit card information is sent to the threat**\nactor, the application can hide its icon, making it challenging for the victim to control or\nuninstall the app.\n\n**Bypass 2FA.\n\nHaving access to both the credit card details and SMS on the victim’s**\ndevice, the attackers can proceed with unauthorized withdrawals from the victim’s bank\naccounts, hijacking the 2FA authentication (one-time password).\n\n\n-----\n\n**Botnet Capabilities.\n\nThe malware can communicate with the C&C server via FCM**\n(Firebase Cloud Messaging) which allows the attacker to execute additional commands\non the victim’s device, such as stealing contacts and sending SMS messages.\n\n**Wormability.\n\nThe app can send SMS messages to a list of potential victims, using a**\ncustom message and a list of phone numbers both retrieved from the C&C server. This\nallows the actors to distribute phishing messages from the phone numbers of typical\nusers instead of from a centralized place and not be limited to a small set of phone\nnumbers that could be easily blocked. This means that technically, there are no\n“malicious” numbers that can be blocked by the telecommunication companies or\ntraced back to the attacker.\n\nThe following technical analysis explains in more detail how these backdoor features are\nimplemented.\n\n## Technical analysis\n\n Android Package\n\nThe typical malicious Android application from this campaign is built using Basic for Android\n[(b4a), an open-source project from Anywhere Software that helps develop native Android](https://www.b4x.com/b4a.html)\napps.\n\nThe malware requires some permissions to perform its malicious activity, including access to\nSMS and contacts and Internet connectivity. It also needs some permissions defined by\nGoogle Firebase: the `RECEIVE is used to receive push notifications and`\nthe `BIND_GET_INSTALL_REFERRER_SERVICE is used by Firebase to recognize from where`\nthe app was installed.\n\nFigure 5: Android manifest for the example malicious application\n\n\n-----\n\n(460c91b46c4520ab6a6447d3458e283321c0f446cfd23eb248912356430e678d)\n\nWhen it is first launched, the app requests 4 permissions: `PERMISSION_RECEIVE_SMS,`\n```\nPERMISSION_READ_SMS, PERMISSION_SEND_SMS, PERMISSION_READ_CONTACTS .\n\n## SMS and 2FA theft\n\n```\nIn addition to retrieving and uploading the SMS messages to the server, as soon as the\napplication is installed and the permission to access SMS is granted, the malware monitors\nnew SMS messages and sends them to the C&C server. For this purpose, they use the\nfollowing receiver:\n\nFigure 6: Part of the malware Android manifest describing the SMS receiver\n\nThe newly received SMS message body and the sender number are sent in plaintext as\nparameters of a GET request to the C&C server:\n\n\n-----\n\nFigure 7: The malware sends the newly received SMS & Download Contact to the C&C\n\nIn some of the later versions of the malware, there is a code that can send an additional\nparameter: the flag `isbank indicating that the SMS came from any bank. This simple check`\nis done by matching the body with a predefined list of words related to “bank” in the Persian\nlanguage.\n\n## Botnet C&C communication\n\nThe devices with the installed malware send the output of all the operations to the panel, and\nreceive the commands to run from the C&C using FCM (Firebase Cloud Messaging).\n\nFigure 8: Firebase configuration from the malware sample\n\nThe malware uses FCM topic messaging which allows it to broadcast a message to multiple\ndevices that have opted into a particular topic. The topic used in each specific sample is\nthe `port value.`\n\n## Conclusion\n\nThis research provides an example of a monetarily successful campaign that exploits social\nengineering and causes major financial loss to its victims, despite the low quality and\ntechnical simplicity of its tools. This campaign may also cause data leaks from the victims’\nphones and the stolen information is easily accessible online.\n\nThere are a few key reasons why this operation is financially successful and attracts a lot of\nattention:\n\nIt causes an SMS “storm” as multiple botnets operated by different people constantly\ndistribute the phishing links across numerous lists of contacts.\nLure themes contain a wide range of topics, including sensitive ones such as\ncomplaints and arrest warnings from the Iranian Judiciary service, and cause the\npotential victims to focus on the lure message and not on their security.\n\n\n-----\n\nStealing 2FA dynamic codes allows the actors to slowly but steadily withdraw\nsignificant amounts of money from the victims’ accounts, even in cases when due to\nthe bank limitations each distinct operation might garner only tens of dollars.\n\nIRATA botnets use the phone numbers of the existing infected devices, and the phishing\ndomains constantly change. This makes it harder, if not impossible, to block phishing SMS\nmessages on the level of the telecommunications company, or even trace them back to the\nattackers. Together with the easy adoption of the “botnet as a service” business model, it\nshould come as no surprise that the number of such applications for Android and the number\nof people selling them is growing. At this time, the only scalable and long-term solution for\nthis problem seems to be raising security awareness among the general public.\n\n**To see samples and IOC, refer to the links below.**\n\n[https://bazaar.abuse.ch/browse/tag/IRATA/](https://bazaar.abuse.ch/browse/tag/IRATA/)\n\n[https://threatfox.abuse.ch/browse/malware/apk.irata/](https://threatfox.abuse.ch/browse/malware/apk.irata/)\n\nhttps://www.virustotal.com/gui/collection/40a007fa13122d99dfce3bdb931611de37bb6b055fe\nc6d6d2e3daac17618db65\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-17 - IRATA.pdf"
    ],
    "report_names": [
        "2022-08-17 - IRATA.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536156,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1662984037,
    "ts_modification_date": 1662984037,
    "files": {
        "pdf": "https://archive.orkl.eu/dff00d19db80b2b27500c103b8a031faf0cc5154.pdf",
        "text": "https://archive.orkl.eu/dff00d19db80b2b27500c103b8a031faf0cc5154.txt",
        "img": "https://archive.orkl.eu/dff00d19db80b2b27500c103b8a031faf0cc5154.jpg"
    }
}