{
    "id": "985b6a93-d031-46c1-a101-c1d9662d4960",
    "created_at": "2022-10-25T16:48:16.94311Z",
    "updated_at": "2025-03-27T02:14:11.697103Z",
    "deleted_at": null,
    "sha1_hash": "ba3b8e6a764ce36c0826bbc39a5012caf7048ecb",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-02-21T08:54:09Z",
    "file_modification_date": "2018-02-21T08:54:09Z",
    "file_size": 368561,
    "plain_text": "( ) ( // /\n[INFORMATION)](https://www.arbornetworks.com/office-contact-information)\n\n\n# Musical Chairs Playing Tetris\n\n###### Sean Sabo (https://www.arbornetworks.com/blog/asert/author/ssabo/) on February 15, 2018. (https://www.arbornetworks.com/blog/asert/2018/02/)\n\n February 20, 2018: This blog has been amended since it was originally published on February 15, 2018. This version removes the association with the APT group responsible for the Night Dragon campaign that we had incorrectly made. We thank the research team at Palo Alto Networks (https://www.paloaltonetworks.com/threat-research) for graciously bringing this to our attention.\n### Introduction\n\n###### ASERT has discovered new command-and-control infrastructure controlled by the actors behind the Musical Chairs campaign. The actors are known for the longevity of their C2 domains, reusing them long after they have been identi�ed, and for making use of a popular opened sourced RAT called Gh0st.  Uniquely in our observation, they have even embedded a fully-functional version of the game Tetris that will launch only when a special condition is meet.\n### Key Findings\n\n###### ASERT has discovered a new domain associated with the actors behind the Musical Chairs campaign. This long-standing actor is known for maintaining static command-and- control infrastructure such as domains for long periods of time, even when they have been discovered and widely publicized in the community. With moderate con�dence, ASERT expects this domain to be used in new intrusions.\n\n Multiple (http://malware-unplugged.blogspot.com/2015/01/hunting-and- decrypting-communications.html) articles (https://www.sans.org/reading- room/whitepapers/detection/gh0st-dshell-decoding-undocumented-protocols- 37032) have been written about Gh0st over the years, including this one discussing the Musical Chairs campaign\n\n\n-----\n\n( ) ( // /\n\n###### details from that report, ASERT has identifINFORMATION)ied a new sample and more interestingly, a new domain that we have associated with the corresponding actor.\n\n (https://www.arbornetworks.com/blog/asert/wp- content/uploads/2018/02/domain_tools_etybh_com.png) The sample appears to be delivered via an email according to artifacts provided by malware-tra�c-analysis (http://www.malware-tra�c- analysis.net/2018/01/04/index.html), which is consistent with documented tactics for this group (https://researchcenter.paloaltonetworks.com/2015/09/musical- chairs-multi-year-campaign-involving-new-variant-of-gh0st-malware/). Gh0st variants are proli�c as they can be found in a popular open-source source code repository – this blog provides the basis for our association with the actor.\n### Analysis\n\n###### Malware\n\n\n-----\n\n( ) ( // /\n\n###### to identify this variant): INFORMATION)\n\n (https://www.arbornetworks.com/blog/asert/wp- content/uploads/2018/02/gh0st_pcap.png) Some other behavior of interest observed while reviewing this actor’s specimen is they appear to be moving away from BAT and JS �les as part of the infection process[i] to using DLL side loading. This is just one sample though, so take this for what it is.  As part of the DLL side-loading, they make use of a signed executable to load a DLL which in turn is used to launch the actual Gh0st DLL. They are not the only malware authors who use this trick. The observed functionality in this sample maps directly to public documentation for Gh0st, so this blog will not rehash that.\n\n Association No. 1\n\n Starting with the known C2 servers for this group, we can check to see if the new domain has any ties to them. Two of their C2s were registered back in 2013 and the campaign has been around even longer than that per Known Domains\n yourbroiler[.]com meitanjiaoyiwang[.]com\n\n New Domain\n etybh[.]com\n\n Looking at DomainTools, we learn that all three share the same IP, 45.34.148.126, and the same registrar, Jiangsu Bangning Science & Technology Co. LTD.\n\n\n-----\n\n[INFORMATION)](https://www.arbornetworks.com/office-contact-information)\n\n\n###### (https://www.arbornetworks.com/blog/asert/wp- content/uploads/2018/02/musical_chairs_CNCs.png) The newest domain, etybh[.]com, was registered in December of 2017. Looking at PassiveTotal, all three domains appeared to have switched from 98.126.223.218 to 45.34.148.146 sometime in the middle of January 2018. This is our �rst clue that they are related.\n\n Association No. 2\n\n This one comes from looking at behavior when the �le is attached to a debugger. First, let us back up a step. Observing behaviors of our suspected Musical Chairs Gh0st sample via a sandbox, we see that it creates a folder called “Win32Tetris”. Let’s see if there are any other Gh0st samples that do this as well. Taking a look through ASERT’s malware corpus we �nd this sample, 11fe12bbb479b4562c1f21a74e09b233ed41c41b7c4c0cad73692�4672fb86a, which also creates that folder. Using clues left by another researcher[ii], we can con�rm that this more recent sample is from the Musical Chairs group due to the C2 and some other characteristics we’ll go over. The most promising correlation is that this sample’s C2 is www.yourbroiler[.]com which is a known C2 for this actor. Next, we �nd similarities from a di�erent dropped �le called C:\\microsoft\\lib\\ki\\vv.js whose content reads as such:\n\n\n-----\n\n[INFORMATION)](https://www.arbornetworks.com/office-contact-information)\n\n\n###### (https://www.arbornetworks.com/blog/asert/wp- content/uploads/2018/02/vv_js_snippet.png) The content is similar to samples identi�ed back in 2015[iii], which also used rundll32 to call a mystart method. And, �nally, this sample makes use of the same mutex tied to this actor’s Gh0st variant: dafewewrw. To summarize the pivot sample\n\n**Property** **Value**\n\nLoad the dll via a script file called C:\\microsoft\\lib\\ki\\vv.js\n\nDomain www.yourbroiler[.]com\n\nMutex dafewewrw\n\n###### Now that we have con�rmed that this sample appears to be a Musical Chairs actor Gh0st variant, let’s work the pivot (going to refer to this sample as the “pivot” sample). The pivot sample, when attached to a debugger, will launch what appears to be a fully functional Tetris game (very friendly of them to provide us reverse engineers with a short break):\n\n\n-----\n\n[INFORMATION)](https://www.arbornetworks.com/office-contact-information)\n\n\n-----\n\n( ) ( // /\n\n###### The latest sample (the one tied to the new domain, etybh[.]com) also exhibits thisINFORMATION) same behavior when attached to the debugger. To play the game make sure to not hide the PEB. For what it is worth, after checking out one of the prior samples from 2015[iv], it exhibited similar behavior; just not a Tetris game.\n\n##### (https://www.arb\n\n###### (https://www.arbornetworks.com/blog/asert/wp- content/uploads/2018/02/spy_lite.png)\n\n Association No. 3\n\n The �nal observation is the fact that the payload dropped on the �le system as RasTls.dat is in fact an obfuscated DLL �le. When looking at the DLL properties the mystart function is exported. Again, mystart is the exported DLL function which the samples back in 2015 called.\n\n\n##### (https://www.arb\n\n\n-----\n\n[INFORMATION)](https://www.arbornetworks.com/office-contact-information)\n\n\n###### (https://www.arbornetworks.com/blog/asert/wp- content/uploads/2018/02/dll_properties.png)\n\n### Conclusion\n\n###### While it should not surprise us when a long-standing actor switches things up, this speci�c actor is known for not really changing much. The use of a di�erent Gh0st variant in addition to the new domain may be indicative of additional changes coming or the actor may be just keeping up with the times. Given previously observed behavior, it is likely that this indicator will be used in the campaign for the foreseeable future and ASERT is making it available to enable visibility for the broader security research community.\n [i] https://researchcenter.paloaltonetworks.com/2015/09/musical-chairs-multi- year-campaign-involving-new-variant-of-gh0st-malware/\n [ii] https://researchcenter.paloaltonetworks.com/2015/09/musical-chairs-multi- year-campaign-involving-new-variant-of-gh0st-malware/\n [iii] https://researchcenter.paloaltonetworks.com/2015/09/musical-chairs-multi- year-campaign-involving-new-variant-of-gh0st-malware/\n [iv] Hash: 50f08f0b23fe1123b298cb5158c1ad5a8244ce272ea463a1e4858d12719b337f\n\nShare this:\n\n\n**[Sh](javascript:void(0);)** **[Share 11](https://www.facebook.com/sharer/sharer.php?app_id=249643311490&kid_directed_site=0&sdk=joey&u=https%3A%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fmusical-chairs-playing-tetris%2F&display=popup&ref=plugin&src=share_button)**\n\n\n[Tweet](https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fmusical-chairs-playing-tetris%2F&ref_src=twsrc%5Etfw&text=Musical%20Chairs%20Playing%20Tetris&tw_p=tweetbutton&url=https%3A%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fmusical-chairs-playing-tetris%2F) [b](https://www.reddit.com/submit?url=https%3A%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fmusical-chairs-playing-tetris%2F&title=Musical%20Chairs%20Playing%20Tetris) it\n\n\n-----\n\n( ) ( // /\n\n**[2&url=https%3A%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fmusical-chairs-playing-](https://www.arbornetworks.com/office-contact-information)**\n\n[INFORMATION)](https://www.pinterest.com/pin/create/button/?guid=ZyTZub6joY3d-2&url=https%3A%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fmusical-chairs-playing-tetris%2F&media=%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fwp-content%2Fuploads%2F2018%2F02%2Fdomain_tools_etybh_com-300x242.png&description=Musical%20Chairs%20Playing%20Tetris)\n\n**tetris%2F&media=%2F%2Fwww.arbornetworks.com%2Fblog%2Fasert%2Fwp-**\n\n\n**content%2Fuploads%2F2018%2F02%2Fdomain_tools_etybh_com-300x242.png&description=Musical%20Chairs%20Playing%20Tetris)**\n\n###### Posted in analysis (https://www.arbornetworks.com/blog/asert/category/analysis/), Malware (https://www.arbornetworks.com/blog/asert/category/malware/) | No Comments (https://www.arbornetworks.com/blog/asert/musical-chairs- playing-tetris/#respond)\n\n Leave a Reply\n\nYour email address will not be published. Required �elds are marked *\n\n**Comment**\n\n**Name ***\n\n**Email ***\n\n**Website**\n\nPOST COMMENT\n\n« The ARC of Satori\n[(https://www.arbornetworks.com/blog/asert/the-](https://www.arbornetworks.com/blog/asert/the-arc-of-satori/)\narc-of-satori/)\n\n#### SUBSCRIBE TO THIS BLOG\n\n\nFIRST NAME\n\n\nLAST NAME\n\n\nCOMPANY\n\n\n-----\n\nEMAIL\n\n\n( ) ( // /\n[INFORMATION)](https://www.arbornetworks.com/office-contact-information)\n\n|SUBSCRIBE|Col2|\n|---|---|\n\n\n###### ASERT\n Arbor’s Security Engineering & Response Team (ASERT) delivers world-class network security research and analysis for the bene�t of today’s enterprise and network operators. ASERT engineers and researchers are part of an elite group of institutions that are referred to as ‘super remediators’ and represent the best in information security.\n\n Show more\n\n Tag Cloud\n\n[\"End of Internet\" (https://www.arbornetworks.com/blog/asert/tag/end-of-internet/)](https://www.arbornetworks.com/blog/asert/tag/end-of-internet/) Analysis\n\n(https://www.arbornetworks.com/blog/asert/tag/analysis/) [Antiy (https://www.arbornetworks.com/blog/asert/tag/antiy/)](https://www.arbornetworks.com/blog/asert/tag/antiy/) APT\n\n(https://www.arbornetworks.com/blog/asert/tag/apt/) Arbor Networks - DDoS Experts\n(https://www.arbornetworks.com/blog/asert/tag/arbor-networks-ddos-experts/)\n[Armageddon (https://www.arbornetworks.com/blog/asert/tag/armageddon/)](https://www.arbornetworks.com/blog/asert/tag/armageddon/) Banking Trojans\n\n(https://www.arbornetworks.com/blog/asert/tag/banking-trojans/) BGP\n(https://www.arbornetworks.com/blog/asert/tag/bgp/) Bot\n\n(https://www.arbornetworks.com/blog/asert/tag/bot/) Botnet\n#### (https://www.arbornetworks.com/blog/asert/tag/botnet/) Botnets\n(https://www.arbornetworks.com/blog/asert/tag/botnets/) Buhtrap\n\n(https://www.arbornetworks.com/blog/asert/tag/buhtrap/) [CAC (https://www.arbornetworks.com/blog/asert/tag/cac/)](https://www.arbornetworks.com/blog/asert/tag/cac/) China\n(https://www.arbornetworks.com/blog/asert/tag/china/) Crypto\n(https://www.arbornetworks.com/blog/asert/tag/crypto/) [CSAC (https://www.arbornetworks.com/blog/asert/tag/csac/)](https://www.arbornetworks.com/blog/asert/tag/csac/)\n\n[Danny McPherson (https://www.arbornetworks.com/blog/asert/tag/danny-mcpherson/)](https://www.arbornetworks.com/blog/asert/tag/danny-mcpherson/) ddos\n## (https://www.arbornetworks.com/blog/asert/tag/ddo\n\n[Denial-of-service attack (https://www.arbornetworks.com/blog/asert/tag/denial-of-service-attack/)](https://www.arbornetworks.com/blog/asert/tag/denial-of-service-attack/) Dirt\nJumper (https://www.arbornetworks.com/blog/asert/tag/dirt-jumper/) DNS\n(https://www.arbornetworks.com/blog/asert/tag/dns/) down\n(https://www.arbornetworks.com/blog/asert/tag/down/) Facebook\n(https://www.arbornetworks.com/blog/asert/tag/facebook/) Financial Sector\n\n(https://www.arbornetworks.com/blog/asert/tag/�nancial-sector/) Google\n##### (https://www.arbornetworks.com/blog/asert/tag/google/) Halloween\n\n(https://www.arbornetworks.com/blog/asert/tag/halloween/) hijack\n(https://www.arbornetworks.com/blog/asert/tag/hijack/) internet\n(https://www.arbornetworks.com/blog/asert/tag/internet/) Internet Protocol\n\n[(https://www arbornetworks com/blog/asert/tag/internet-protocol/) Internet service](https://www.arbornetworks.com/blog/asert/tag/internet-service-provider/)\n\n\n-----\n\n( ) ( // /\n\n#### (https://www.arbornetworks.com/blog/asert/tag/internet-INFORMATION) service-provider/) Internet tra�c (https://www.arbornetworks.com/blog/asert/tag/internet- tra�c/) IPv4 (https://www.arbornetworks.com/blog/asert/tag/ipv4/) IPv6\n(https://www.arbornetworks.com/blog/asert/tag/ipv6/) Iran\n(https://www.arbornetworks.com/blog/asert/tag/iran/) malware\n(https://www.arbornetworks.com/blog/asert/tag/malware-2/) network\n\n(https://www.arbornetworks.com/blog/asert/tag/network/) outage\n###### (https://www.arbornetworks.com/blog/asert/tag/outage/) peering\n(https://www.arbornetworks.com/blog/asert/tag/peering/) Russia\n(https://www.arbornetworks.com/blog/asert/tag/russia/) Security\n##### (https://www.arbornetworks.com/blog/asert/tag/security/) Streaming media\n\n(https://www.arbornetworks.com/blog/asert/tag/streaming-media/) tra�c\n(https://www.arbornetworks.com/blog/asert/tag/tra�c/) Ukraine\n\n(https://www.arbornetworks.com/blog/asert/tag/ukraine/) Wikileaks\n[(https://www.arbornetworks.com/blog/asert/tag/wikileaks/)](https://www.arbornetworks.com/blog/asert/tag/youtube/) YouTube\n###### (https://www.arbornetworks.com/blog/asert/tag/youtube/)\n\n[© 2018 ARBOR NETWORKS, INC (HTTPS://WWW.ARBORNETWORKS.COM) . ALL RIGHTS RESERVED.](https://www.arbornetworks.com/)\n\n[(http://arbor.link/ntctwww) Website (http://arbor.link/ntctwww) |](http://arbor.link/ntctwww)\n\n**[Blog (http://arbor.link/ntctblog)](http://arbor.link/ntctblog)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.02.20.musical-chairs-playing-tetris/Musical%20Chairs%20Playing%20Tetris.pdf"
    ],
    "report_names": [
        "Musical Chairs Playing Tetris"
    ],
    "threat_actors": [
        {
            "id": "ea844ee6-eb12-42c0-8426-11395fe81e6f",
            "created_at": "2022-10-25T15:50:23.300796Z",
            "updated_at": "2025-03-27T02:00:55.434471Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "Night Dragon"
            ],
            "source_name": "MITRE:Night Dragon",
            "tools": [
                "at",
                "gsecdump",
                "zwShell",
                "PsExec",
                "ASPXSpy",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "09a8f8fe-e907-47b4-8709-a97717dde3cc",
            "created_at": "2022-10-25T16:07:23.90252Z",
            "updated_at": "2025-03-27T02:02:10.020919Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [],
            "source_name": "ETDA:Night Dragon",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Cain & Abel",
                "gsecdump",
                "zwShell"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "020794ec-7315-47de-818c-2032c362fd15",
            "created_at": "2023-01-06T13:46:38.306576Z",
            "updated_at": "2025-03-27T02:00:02.800515Z",
            "deleted_at": null,
            "main_name": "Night Dragon",
            "aliases": [
                "G0014"
            ],
            "source_name": "MISPGALAXY:Night Dragon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041651,
    "ts_creation_date": 1519203249,
    "ts_modification_date": 1519203249,
    "files": {
        "pdf": "https://archive.orkl.eu/ba3b8e6a764ce36c0826bbc39a5012caf7048ecb.pdf",
        "text": "https://archive.orkl.eu/ba3b8e6a764ce36c0826bbc39a5012caf7048ecb.txt",
        "img": "https://archive.orkl.eu/ba3b8e6a764ce36c0826bbc39a5012caf7048ecb.jpg"
    }
}