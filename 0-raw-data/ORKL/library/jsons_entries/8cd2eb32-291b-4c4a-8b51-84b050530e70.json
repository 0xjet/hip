{
    "id": "8cd2eb32-291b-4c4a-8b51-84b050530e70",
    "created_at": "2023-01-12T15:07:47.646496Z",
    "updated_at": "2025-03-27T02:14:12.255164Z",
    "deleted_at": null,
    "sha1_hash": "8153da7b1eb8b335dce8e346c4969dc2359635f1",
    "title": "2020-12-02 - IcedID Stealer Man-in-the-browser Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T18:10:03Z",
    "file_modification_date": "2022-05-28T18:10:03Z",
    "file_size": 490515,
    "plain_text": "# IcedID Stealer Man-in-the-browser Banking Trojan\n\n**[blog.cyberint.com/icedid-stealer-man-in-the-browser-banking-trojan](https://blog.cyberint.com/icedid-stealer-man-in-the-browser-banking-trojan)**\n\nDecember 2, 2020\n\n## Executive Summary\n\nIcedID stealer (Also known as BokBot) was first discovered at the end of 2017, believed to\nbe a resurgence of the NeverQuest banking Trojan. It is a modular banking trojan that uses\nman-in-the-browser (MitB) attacks to steal banking credentials, payment card information\nand other financial data.\n\nThe stealer possesses relatively sophisticated functionality and capabilities such as web\ninjects, a large remote access trojan (RAT) arsenal and a VNC module for remote control.\nAdditionally, the use of steganography to hide configuration data along with anti-VM\ndetection and anti-debugging techniques complicate detection and analysis.\n\nIcedID’s typical range of targets includes the customers of banks and telecommunications\norganizations worldwide leading to impacts including brand abuse, funds theft and customer\ndata breaches.\n\nCyberint have recently observed an ongoing campaign targeting users in the APAC region\nwith an apparent focus on the Philippines and Japan.\n\nThe IcedID stealer is traditionally delivered by a malspam lure, with Microsoft Word\nattachments weaponized with malicious Macros, based on Emotet.\n\nWhile the majority of recently detected lure documents were written in English and targeted a\nwide range of users, localized campaigns have also been reported. One such recent\nexample targeted users located in Japan with lure documents in Japanese, likely indicating\nthat the threat actor behind this threat is relatively sophisticated and may focus on specific\ngeographies as potential targets, adjusting their arsenal accordingly.\n\n\n-----\n\nWhilst it is not possible to attribute IcedID to a specific group, past indications suggest a\npotential link to the following threat actors:\n\nLunar Spider\nTA2101\n\n## Delivery\n\nAs a generic malspam campaign that utilizes Emotet as the delivery mechanism, the lures\nare comprised from a generic subject (quotation/request/Document/report) being sent to the\ntargeted user.\n\nThe email contains an attached ZIP folder protected by a password provided within the email\nbody. At the next stage, once the user extracts the document file from the ZIP folder, they will\nbe requested to ‘Enable Content’ (Figure 1) within Microsoft Word, leading to malicious\nMacro code being executed whilst decoy content (Figure 2) is displayed.\n\nFigure 1 – Prompt to relax security controls\n\n\n-----\n\nFigure 2 – Decoy document content\n\nDocument metadata detected as Russian\n\n\n-----\n\nThreat actor email address, used for the file creation\n\nOnce executed, the macro will write a variety of files to the drive, used for the download and\ndecryption of the latest IcedID trojan, including an up-to-date configuration file containing a\nlist of target bank and telecommunication organizations. In some cases, this was observed\nas a DLL file, where in others it was a steganographically obfuscated PNG file (Figure 3).\n\nFigure 3 – PNG Configuration Payload\n\nAlthough surfaced in 2017, many iterations of this trojan have been well-investigated by\nnumerous security researchers globally, but for the past year (circa January 2020), several\nnew techniques were added in order to detect and evade sandboxes, and to generally hide\nthe execution process taking place.\n\n\n-----\n\nIt was also noticed that the malware creates a new folder with a random name, where it\nsaves a downloaded configuration in encrypted form (Figure 4).\n\nFigure 4 – Download directory\n\nInside the %TEMP% folder, it drops some non-malicious helper elements: sqlite32.dll (that\nwill be used for reading SQLite browser databases found in web browsers), and a certificate\nthat will be used for intercepting traffic (Figure 5).\n\nFigure 5 – Temp directory\n\n## Infection\n\nOnce infected, the IcedID trojan, known as a banking Trojan, steals data related to banking\ntransactions by injecting implants into browsers, API hooks and a ‘Man-in-the-Browser’\n(MitB)[1] attack to manipulate visited webpages.\n\nAs observed (Figure 6) in the memory of an infected host, the svchost process contains\nstrings that reveal the configuration of these ‘web-injects’, that being modular HTML and\nJavaScript code elements that are injected into the webpage of a targeted brand to steal\ndata.\n\n\n-----\n\nFigure 6 – Web-inject strings found in memory\n\nFigure 7 – Mozilla Firefox Web-inject\n\nFigure 8 – Injected code snippet executed on the client side (Example code available via\nGitHub[2])\n\n\n-----\n\nThe core bot that runs inside the memory of the svchost process observes other processes\nrunning on the system and injects implants into browsers, for example as seen in Mozilla\nFirefox (Figure 7).\n\nThe IcedID module running inside the browser’s memory is responsible for applying the webinjects and installing malicious JavaScript into targeted webpages causing them to be\nexecuted on the client side (Figure 8).\n\n## C2\n\nThe hooked scripts, loaded from modified browser DLLs, communicate with the main bot\nprocess residing inside the svchost process. The main bot coordinates the work of all the\ninjected components and exfiltrates stolen data to the C2 server.\n\nIn order to properly hide and encrypt its communication processes, all C2 communications\nare made over HTTPS using the trojan’s own certificate (Figure 9).\n\n## Recommendations\n\nNotify customer care of the ongoing threat in case of funds loss.\nCyberint recommends that customers educate their end-users and always check for\nunusual browser behaviors that may lead to account compromise or funds theft.\nPhishing awareness to the end-users is advised.\nUsage of a modern, updated AV solution is advised.\nMFA should be enabled on all of the end-user accounts.\n\n## Indicators Of Compromise\n\n### Targeted Brands/Organizations\n\nBased on strings extracted from IcedID samples, the following brands and/or organizations\nappear to be targeted:\n\n```\nDollar Bank\n\n```\n\n-----\n\n```\neBay\n\n```\n\n### IcedID Samples\n\nThe following SHA256 hashes relate to recently observed IcedID malware samples:\n\n\n-----\n\n```\n6297e0fa6229c7f329f66227656bbf99d1329aaa48341c2f750c78f1937ac952\n\n```\n\n### Command & Control Infrastructure\n\n\n-----\n\nThe following command and control (C2) IP addresses have recently been observed as\nIcedID infrastructure:\n```\n   149.154.64.179\n   178.250.156.74\n   178.250.157.144\n   185.219.43.85\n   185.98.87.6\n   193.109.79.219\n   193.201.126.18\n   194.61.2.224\n   45.12.4.206\n   45.128.206.80\n   45.129.237.168\n   45.150.64.102\n   45.150.64.57\n   45.8.124.36\n   45.89.67.169\n   5.253.61.235\n   62.109.14.179\n   80.85.158.53\n   83.166.242.27\n   93.189.41.223\n\n```\nReferences\n\n[1] https://blog.malwarebytes.com/threat-analysis/2019/12/new-version-of-icedid-trojan-usessteganographic-payloads/\n\n## MITRE ATT&CK\n\nThe following techniques have been observed in recent IcedID campaigns:\n\n**Technique** **Tactic**\n\nT1027 – Obfuscated Files or Information Defense Evasion\n\nT1027.002 – Software Packing Defense Evasion\n\nT1027.003 – Steganography Defense Evasion\n\nT1047 – Windows Management Instrumentation Execution\n\nT1053.005 – Scheduled Task/Job: Scheduled Task Execution, Persistence,\nPrivilege Escalation\n\n\n-----\n\nT1059.005 – Command and Scripting Interpreter: Visual\nBasic\n\n\nExecution\n\n\nT1069 – Permission Groups Discovery Discovery\n\nT1071.001 – Application Layer Protocol: Web Protocols Command & Control\n\nT1082 – System Information Discovery Discovery\n\nT1087.002 – Account Discovery: Domain Account Discovery\n\nT1105 – Ingress Tool Transfer Command & Control\n\nT1106 – Native API Execution\n\n\nT1137.001 – Office Application Startup: Office Template\nMacros\n\n\nPersistence\n\n\nT1185 – Man in the Browser Collection\n\nT1204.002 – User Execution: Malicious File Execution\n\nT1218.007 – Signed Binary Proxy Execution: Msiexec Defense Evasion\n\nT1529 – System Shutdown/Reboot Impact\n\n\nT1547.001 – Boot or Logon Autostart Execution: Registry\nRun Keys / Startup Folder\n\n\nPersistence, Privilege\nEscalation\n\n\nT1553.002 – Subvert Trust Controls: Code Signing Defense Evasion\n\n\nT1555.003 – Credentials from Password Stores:\nCredentials from Web Browsers\n\nT1573.002 – Encrypted Channel: Asymmetric\nCryptography\n\n\nCredential Access\n\nInitial Access\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-02 - IcedID Stealer Man-in-the-browser Banking Trojan.pdf"
    ],
    "report_names": [
        "2020-12-02 - IcedID Stealer Man-in-the-browser Banking Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "475ea823-9e47-4098-b235-0900bc1a5362",
            "created_at": "2022-10-25T16:07:24.506596Z",
            "updated_at": "2025-03-27T02:02:10.263346Z",
            "deleted_at": null,
            "main_name": "Lunar Spider",
            "aliases": [
                "Gold SwathMore"
            ],
            "source_name": "ETDA:Lunar Spider",
            "tools": [
                "BokBot",
                "IceID",
                "IcedID",
                "NeverQuest",
                "Vawtrak",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c2385aea-d30b-4dbc-844d-fef465cf3ea9",
            "created_at": "2023-01-06T13:46:38.916521Z",
            "updated_at": "2025-03-27T02:00:02.950071Z",
            "deleted_at": null,
            "main_name": "LUNAR SPIDER",
            "aliases": [
                "GOLD SWATHMORE"
            ],
            "source_name": "MISPGALAXY:LUNAR SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e9f85280-337c-4321-b872-0919f8ef64a6",
            "created_at": "2022-10-25T16:07:24.261761Z",
            "updated_at": "2025-03-27T02:02:10.153781Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Gold Village",
                "Maze Team",
                "TA2101",
                "Twisted Spider"
            ],
            "source_name": "ETDA:TA2101",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BokBot",
                "Buran",
                "ChaCha",
                "Cobalt Strike",
                "CobaltStrike",
                "Egregor",
                "IceID",
                "IcedID",
                "Mimikatz",
                "PsExec",
                "SharpHound",
                "VegaLocker",
                "WinSCP",
                "cobeacon",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7cfe3bc9-7a6c-4ee1-a635-5ea7b947147f",
            "created_at": "2024-06-19T02:03:08.122318Z",
            "updated_at": "2025-03-27T02:05:17.398805Z",
            "deleted_at": null,
            "main_name": "GOLD SWATHMORE",
            "aliases": [
                "Lunar Spider "
            ],
            "source_name": "Secureworks:GOLD SWATHMORE",
            "tools": [
                " GlobeImposter",
                " Gozi",
                " Gozi Trojan",
                " IcedID",
                " Latrodectus",
                " TrickBot",
                " TrickBot",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536067,
    "ts_updated_at": 1743041652,
    "ts_creation_date": 1653761403,
    "ts_modification_date": 1653761403,
    "files": {
        "pdf": "https://archive.orkl.eu/8153da7b1eb8b335dce8e346c4969dc2359635f1.pdf",
        "text": "https://archive.orkl.eu/8153da7b1eb8b335dce8e346c4969dc2359635f1.txt",
        "img": "https://archive.orkl.eu/8153da7b1eb8b335dce8e346c4969dc2359635f1.jpg"
    }
}