{
    "id": "cad03186-f7f2-4f44-9d34-d47ab677090b",
    "created_at": "2023-01-12T15:09:41.349387Z",
    "updated_at": "2025-03-27T02:09:18.450948Z",
    "deleted_at": null,
    "sha1_hash": "c9ef1de84e72f6bc84922ba70e198f2a19bdf5dd",
    "title": "2020-12-08 - Egregor ransomware- Maze’s heir apparent",
    "authors": "",
    "file_creation_date": "2022-05-28T01:22:26Z",
    "file_modification_date": "2022-05-28T01:22:26Z",
    "file_size": 335696,
    "plain_text": "# Egregor ransomware: Maze’s heir apparent\n\n**[news.sophos.com/en-us/2020/12/08/egregor-ransomware-mazes-heir-apparent/](https://news.sophos.com/en-us/2020/12/08/egregor-ransomware-mazes-heir-apparent/)**\n\nSean Gallagher December 8, 2020\n\n[In September, a new ransomware brand emerged just as the Maze ransomware gang began](https://news.sophos.com/en-us/2020/05/12/maze-ransomware-1-year-counting/)\nshuttering its operation. Named Egregor (from an occult term derived from the Greek word\nἑγρήγορος, “wakeful”—a term used to refer to an angel-like spirit or group mind), the\nransomware leverages data stolen during the attack to extort the victim for payment,\nfollowing a trail blazed by Maze.\n\nEgregor’s ransom note tells its victims “soon mass media, your partners and clients WILL\nKNOW about your PROBLEM…If you do not contact us in the next 3 DAYS we will begin\nDATA publication.”\n\nLike Maze, Egregor uses the ChaCha and RSA encryption algorithms to encrypt victims’\nfiles. Also like Maze, Egregor is suspected to be a ransomware-as-a-service operation—\ndependent on affiliates who receive payment for dropping the malware on victims’ networks.\n\nBut Egregor’s code is not a derivative of the malware used by Maze; rather, it is a variant of a\nransomware family known as Sekhmet. Sekhmet’s operators started publishing data from\nvictims in March 2020, but their “Sekhmet Leaks” website is no longer accessible, and only\nsix victims were publicly exposed by the ring before the site went down—which coincided\nwith the launch of the Egregor site. It’s not clear if the creators of Egregor and Sekhmet are\nthe same, but Egregor’s ransomware is clearly derived from the Sekhmet malware.\n\n\n-----\n\nWe first detected Egregor in September during an attack against a customer. As of\nNovember 25, the ring has posted details on over 130 victims on its Tor hidden services\n(.onion) website. The alleged victims of these attacks are diverse, both in terms of location\nand organization type—they include schools, manufacturers, logistics organizations, financial\ninstitutions, and technology companies. The Egregor gang specifically called out two gaming\ncompanies—Crytek and Ubisoft—in a “press release” in October.\n\nThe Egregor website, a Tor hidden service, includes “release notes,” or press releases, on\nhigh-profile victims. The game developers Crytek and Ubisoft were reportedly hit by Egregor\nin October.\n\n\n-----\n\nThe Egregor “Hall of Shame” is a listing of victims who failed to pay the demanded ransom\nfor data, with links to .zip compressed folders of data stolen from them. The Egregor\noperators claim to sell stolen data that they do not publish publicly.\n\n## The spirit descends\n\nCommodity malware is the vehicle most commonly associated with Egregor. Some of the\nattacks we’ve tracked were linked with Qbot malware activity, though it was not clear how\nlong Qbot had been present on the victims’ networks. Qbot (also known as Qakbot) deploys\nfrom a malicious document file attached to an e-mail message. Earlier this year, ZDNet\n[reported that Qbot’s operators engaged in “thread hijacking,” sending the maldocs as replies](https://www.zdnet.com/article/your-email-threads-are-now-being-hijacked-by-qbot-trojan/)\nto ongoing email threads in order to dupe targets into opening the malicious attachments.\n\nEgregor has no way to spread itself, so it requires the attackers to move laterally themselves,\nusing built-in Windows capabilities and other exploitation tools. In some cases, Cobalt Strike\nexploitation tools have been detected as part of Egregor attacks. The attacker(s) used these\n\n\n-----\n\ntools to execute scripts, gather information about other systems on the network, extract\nadditional credentials, and spread the ransomware. In one case, the Cobalt Strike agent was\nused to create an RDP connection to other machines on the targeted network, and copy the\nEgregor executable to them—copying the files to the directory C:\\perflogs.\n\nIn the same attack, another malware called SystemBC—a Tor network proxy—was used to\ncreate an obfuscated backchannel for data exfiltration and attack communications. The use\nof Cobalt Strike, SystemBC and the C:\\perflogs directory in this case match the behavior\nseen in a [Ryuk attack we investigated in September 2020. (We’ve also seen Cobalt Strike](https://news.sophos.com/en-us/2020/10/14/inside-a-new-ryuk-ransomware-attack/)\ntools used in connection with earlier Sekhmet attacks.)\n\nAfter exfiltrating data, the attackers launch the ransomware. The approach to launching the\nransomware varied across the incidents we examined; in some cases, it was launched by a\nscript, and in others it was configured as a scheduled Windows task.\n\nAs with Sekhmet, the Egregor ransomware itself is not an executable, but a dynamic link\nlibrary (DLL) that is executed using Windows’ rundll32.exe utility. To evade sandbox\ndetection, the DLL will only execute when given a password as a command line parameter,\nalong with a flag for the type of the attack to be executed. We’ve seen three different\npasswords used in attacks we investigated, in addition to other parameters:\n```\nrundll32.exe C:\\Windows\\sed.dll,DllRegisterServer -passegregor1313 --full\nrundll32.exe /i C:\\WINDOWS\\b.dll DllRegisterServer -passegregor9999 --full --fast=256\nrundll32.exe C:\\perflogs\\clang.dll,DllRegisterServer -peguard6\n\n```\nThe DLL is a two-stage package. The first stage is an unpacker that verifies the password is\ncorrect by checking against its SHA256 value. The second stage is the actual decrypted\nransomware DLL, which contains the ransom note format, along with a hardcoded RSA key\nand list of files and process names to kill or terminate. There’s also a number of “spaghetti”\nfunctions included for the purpose of deterring analysis of the code.\n\n## Paying the piper\n\nOnce Egregor executes, it encrypts a wide variety of data files, including images, videos,\ndocuments, SQL and other database-related files, Web pages, JavaScript files, and\nexecutables. Encrypted files have their names appended with an extension made up of\nrandom characters. As with Sekhmet, the ransomware drops a ransom demand in a text file\nnamed RECOVER-FILES.txt:\n\n\n-----\n\nA\n\nredacted Egregor ransom note. A text block at the end of the message identifies the victim to\nthe Egregor actors.\nThe “special technical block” at the end of the ransom note is unique to the victim. Following\nthe note’s instructions to connect via a Tor browser or via a public internet to the Egregor\nweb portal, which instructs victims to upload their RECOVER-FILES.txt file.\n\n\n-----\n\nFrom there, victims can engage with Egregor’s “customer service” organization to receive the\nransom demand and negotiate payment.\n\n## More of the same\n\nThe use of crafted spam messages with malicious attachments, commodity malware and\nexploitation tools, and exfiltration of data for extortion purposes have become common\ntactics as ransomware developers have shifted to an “as-a-service” model. These threats\nrequire a defense in depth to prevent theft and encryption of data, including educating\nemployees on the tactics that might trick them into executing the malware that gives\nransomware attackers their foothold on the network.\n\n\n-----\n\nGiven that the group behind Egregor claims to sell stolen data if ransoms are not paid, it s\nnot enough to have good backups of organizational data as a mitigation for ransomware.\nOrganizations need to assume that their data has been breached if they suffer an Egregor\n(or any other ransomware) attack. Blocking common exfiltration routes for data—such as\npreventing Tor connections—can make stealing data more difficult, but the best defense is to\ndeny attackers access through email attachment malware and other common entry points.\n\nMalware protection throughout the organization can help prevent commodity malware\nattacks such as Qbot, and lateral spread through tools such as Cobalt Strike. (Sophos\ndetects Egregor in multiple ways, and also detects Cobalt Strike and Qbot, as noted in the\nindicators of compromise posted on SophosLabs’ GitHub.)\n\n## Acknowledgments\n\n**SophosLabs would like to acknowledge the contributions of Anand Aijan, Gabor**\n**Szappanos, and Mark Loman to this report, as well as Peter Mackenzie, Syed**\n**Shahram, Bill Kearney, and Sergio Bestulic of Sophos MTR’s Rapid Response team.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-08 - Egregor ransomware- Maze’s heir apparent.pdf"
    ],
    "report_names": [
        "2020-12-08 - Egregor ransomware- Maze’s heir apparent.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536181,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653700946,
    "ts_modification_date": 1653700946,
    "files": {
        "pdf": "https://archive.orkl.eu/c9ef1de84e72f6bc84922ba70e198f2a19bdf5dd.pdf",
        "text": "https://archive.orkl.eu/c9ef1de84e72f6bc84922ba70e198f2a19bdf5dd.txt",
        "img": "https://archive.orkl.eu/c9ef1de84e72f6bc84922ba70e198f2a19bdf5dd.jpg"
    }
}