{
    "id": "b3b5a0e9-3c7c-4dd6-9a54-a9e2a19abfe0",
    "created_at": "2023-01-12T15:06:38.771564Z",
    "updated_at": "2025-03-27T02:16:37.199181Z",
    "deleted_at": null,
    "sha1_hash": "084afd71d1242f51ffa13cdb03166b1299937283",
    "title": "2018-10-03 - APT37- Final1stspy Reaping the FreeMilk",
    "authors": "",
    "file_creation_date": "2022-05-28T18:28:51Z",
    "file_modification_date": "2022-05-28T18:28:51Z",
    "file_size": 694868,
    "plain_text": "# APT37: Final1stspy Reaping the FreeMilk\n\n**intezer.com/apt37-final1stspy-reaping-the-freemilk/**\n\nWritten by Jay Rosenberg - 3 October 2018\n\n## Get Free Account\n\nJoin Now\n\n\nOctober 3, 2018\n\n\nResearchers at Palo Alto Networks recently published a report regarding the\n[NOKKI malware, which has shared code with KONNI and, although not in the report by](https://researchcenter.paloaltonetworks.com/2018/09/unit42-new-konni-malware-attacking-eurasia-southeast-asia/)\nPalo Alto, [KimJongRAT (discovered by Paul Rascagnères of Cisco Talos in 2013), and](https://malware.lu/assets/files/articles/RAP003_KimJongRAT-Stealer_Analysis.1.0.pdf)\nanother report on how there is evidence of the NOKKI malware connecting to the North\nKorean threat actor known as APT37, Reaper, or Group123.\n\nNew report by [@PaloAltoNtwks on](https://twitter.com/PaloAltoNtwks?ref_src=twsrc%5Etfw) [#NOKKI malware with similarities to #KONNI also](https://twitter.com/hashtag/NOKKI?src=hash&ref_src=twsrc%5Etfw)\n[has code relations to #KimJongRAT in a report from 2013 by](https://twitter.com/hashtag/KimJongRAT?src=hash&ref_src=twsrc%5Etfw) [@r00tbsd](https://twitter.com/r00tbsd?ref_src=twsrc%5Etfw)\n[https://t.co/Rc0T8a4o6h](https://t.co/Rc0T8a4o6h) [pic.twitter.com/QkjiaQJ2wF](https://t.co/QkjiaQJ2wF)\n\n[— Jay Rosenberg (@jaytezer) September 28, 2018](https://twitter.com/jaytezer/status/1045670058704478208?ref_src=twsrc%5Etfw)\n\nThe malicious document related to NOKKI, using VBScript, downloads a newly discovered\nmalware named Final1stspy, due to the PDB string inside. As noted by Palo Alto Networks,\nFinal1stspy comes in 2 components, the EXE named “LoadDll” with the sole purpose of\nloading up a DLL payload, internally named “hadowexecute.” After collecting information\n\n\n-----\n\nabout the infected computer, the end result is that the DOGCALL malware, also known as\nROKRAT, is downloaded as the final payload, thus being one of the links between NOKKI\n**and APT37.**\n\n## LINKS THROUGH CODE REUSE\n\nThe DLL payload component under the hash that was listed in the report was not available\non VirusTotal. We created some YARA signatures from the code of “LoadDll” and did a hunt\nvia VirusTotal. Since the EXE component shares code with the DLL, the YARA hunt led us\nto find an earlier version of the DLL component of Final1stspy with 2/67 detections,\ncompilation timestamp of May 21, 2018, and first upload to VirusTotal date of July 11, 2018.\nThis is an earlier version than described in the Palo Alto report. After obtaining the\nhadowexecute DLL component, we checked to see if there was any code reuse in the\n[Intezer Analyze™ system.](https://analyze.intezer.com/#/files/2011b9aa61d280ca9397398434af94ec26ddb6ab51f5db269f1799b46cf65a76)\n\n[Intezer Analyze™](https://analyze.intezer.com/#/files/2011b9aa61d280ca9397398434af94ec26ddb6ab51f5db269f1799b46cf65a76)\n\nWe see that there is some code shared between the EXE component of Final1stspy and\nother code that has been seen before in the FreeMilk campaign which utilized ROKRAT.\n\nLet’s see the shared code between ROKRAT and Final1stspy by doing comparison of these\nfunctions in IDA. If you take a look, there is an identical match between them.\n\n\n-----\n\n(ROKRAT & Final1stspy hadowexecute function comparison)\n\nThis function is unique code that has only been seen before in Group123’s ROKRAT and\nthe DLL component of Final1stspy. The identical function gathers information about the\noperating system and stores it in the same format.\n\n## CONCLUSION\n\nThe evidence in Group123 being the threat actor involved here does not only lie in the final\ndelivered payload, but in the code itself. This code reuse provides more evidence towards\nthe relationship of KimJongRAT, KONNI, NOKKI, Final1stspy, ROKRAT, and APT37.\n\n\n-----\n\n## IoCs\n\nFinal1stspy\n\n2011b9aa61d280ca9397398434af94ec26ddb6ab51f5db269f1799b46cf65a76 (DLL)\n\n0669c71740134323793429d10518576b42941f9eee0def6057ed9a4ba87a3a9a (DLL)\n\nfb94a5e30de7afd1d9072ccedd90a249374f687f16170e1986d6fd43c143fb3a (EXE)\n\nGroup 123 (FreeMilk / ROKRAT Samples)\n\n99c1b4887d96cb94f32b280c1039b3a7e39ad996859ffa6dd011cf3cca4f1ba5\n\n01045aeea5198cbc893066d7e496f1362c56a154f093d1a8107cecad8d4e4df2\n\n26ad5f8889d10dc45dcf1d3c626416eb604f5fe4a7268e044f17a3ab6ff14e53\n\n65ec544841dbe666d20de086495158128ddffb8b076ddb801a3f2dc250481135\n\n7f35521cdbaa4e86143656ff9c52cef8d1e5e5f8245860c205364138f82c54df\n\nef40f7ddff404d1193e025081780e32f88883fa4dd496f4189084d772a435cb2\n\n**Jay Rosenberg**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-10-03 - APT37- Final1stspy Reaping the FreeMilk.pdf"
    ],
    "report_names": [
        "2018-10-03 - APT37- Final1stspy Reaping the FreeMilk.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43c8747-c898-448a-88a9-76bff88e91b5",
            "created_at": "2024-02-02T02:00:04.058535Z",
            "updated_at": "2025-03-27T02:00:03.302832Z",
            "deleted_at": null,
            "main_name": "Opal Sleet",
            "aliases": [
                "OSMIUM",
                "Konni",
                "Vedalia"
            ],
            "source_name": "MISPGALAXY:Opal Sleet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b9458777-d970-4e89-b2d2-e532140a390f",
            "created_at": "2024-05-01T02:03:08.140328Z",
            "updated_at": "2025-03-27T02:05:17.41728Z",
            "deleted_at": null,
            "main_name": "NICKEL JUNIPER",
            "aliases": [
                "OSMIUM ",
                "Opal Sleet ",
                "Konni"
            ],
            "source_name": "Secureworks:NICKEL JUNIPER",
            "tools": [
                "KONNI"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535998,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653762531,
    "ts_modification_date": 1653762531,
    "files": {
        "pdf": "https://archive.orkl.eu/084afd71d1242f51ffa13cdb03166b1299937283.pdf",
        "text": "https://archive.orkl.eu/084afd71d1242f51ffa13cdb03166b1299937283.txt",
        "img": "https://archive.orkl.eu/084afd71d1242f51ffa13cdb03166b1299937283.jpg"
    }
}