{
    "id": "13f2e693-9497-4156-a892-c16b5f849108",
    "created_at": "2022-10-25T16:48:23.80099Z",
    "updated_at": "2025-03-27T02:16:03.271902Z",
    "deleted_at": null,
    "sha1_hash": "3108aea5c7ef8c8a6d3633612c4f0231b1cec25b",
    "title": "Apt Group Sends Spear Phishing Emails To Indian Government Officials",
    "authors": "FireEye",
    "file_creation_date": "2016-12-31T07:02:04Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 356460,
    "plain_text": "# G oup Se ds Spea s g a s o d a Government Officials\n\n**www.fireeye.com** [/blog/threat-research/2016/06/apt_group_sends_spea.html](https://www.fireeye.com/blog/threat-research/2016/06/apt_group_sends_spea.html)\n\n**Introduction**\nOn May 18, 2016, FireEye Labs observed a suspected Pakistan-based APT group sending spear phishing emails to\nIndian government officials. This threat actor has been active for several years and conducting suspected\nintelligence collection operations against South Asian political and military targets.\n\nThis group frequently uses a toolset that consists of a downloader and modular framework that uses plugins to\nenhance functionality, ranging from keystroke logging to targeting USB devices. We initially reported on this threat\ngroup and their UPDATESEE malware in our FireEye Intelligence Center in February 2016. Proofpoint also\n[discussed the threat actors, whom they call Transparent Tribe, in a March blog post.](https://www.proofpoint.com/us/threat-insight/post/Operation-Transparent-Tribe)\n\nIn this latest incident, the group registered a fake news domain, timesofindiaa[.]in, on May 18, 2016, and then used\nit to send spear phishing emails to Indian government officials on the same day. The emails referenced the Indian\n[Government’s 7th Central Pay Commission (CPC). These Commissions periodically review the pay structure for](http://zeenews.india.com/business/news/economy/7th-pay-commission-govt-employees-likely-to-get-huge-pay-checks-by-june-july-2016_1880390.html)\nIndian government and military personnel, a topic that would be of interest to government employees.\n\n**Malware Delivery Method**\nIn all emails sent to these government officials, the actor used the same attachment: a malicious Microsoft Word\n[document that exploited the CVE-2012-0158 vulnerability to drop a malicious payload.](https://technet.microsoft.com/en-us/library/security/ms12-027.aspx)\n\nIn previous incidents involving this threat actor, we observed them using malicious documents hosted on websites\nabout the Indian Army, instead of sending these documents directly as an email attachment.\n\nThe email (Figure 1) pretends to be from an employee working at Times of India (TOI) and requests the recipient to\nopen the attachment associated with the 7th Pay Commission. Only one of the recipient email addresses was\npublicly listed on a website, suggesting that the actor harvested the other non-public addressees through other\nmeans.\n\n**Figure 1: Contents of the Email**\n\nA review of the email header data from the spear phishing messages showed that the threat actors sent the emails\nusing the same infrastructure they have used in the past.\n\n\n-----\n\n[Despite being an older vulnerability, many threat actors continue to leverage CVE-2012-0158 to exploit Microsoft](https://technet.microsoft.com/en-us/library/security/ms12-027.aspx)\nWord. This exploit file made use of the same shellcode that we have observed this actor use across a number of\nspear phishing incidents.\n\n**Figure 2: Exploit Shellcode used to Locate and Decode Payload**\n\n\n-----\n\nbeginning and ending file markers 0xBABABABA and 0xBBBBBBBB, respectively. After decoding is complete, the\nshellcode proceeds to save the executable payload into %temp%\\svchost.exe and calls WinExec to execute the\npayload. After the payload is launched, the shellcode runs the following commands to prevent Microsoft Word from\nshowing a recovery dialog:\n\nLastly, the shellcode overwrites the malicious file with a decoy document related to the Indian defense forces’ pay\nscale / matrix (Figure 3), displays it to the user and terminates the exploited instance of Microsoft Word.\n\n**Figure 3: Decoy Document related to 7th Pay Commission**\n\nThe decoy document's metadata (Figure 4) suggests that it was created fairly recently by the user “Bhopal”.\n\n\n-----\n\n**Figure 4: Metadata of the Document**\n\nThe payload is a backdoor that we call the Breach Remote Administration Tool (BreachRAT) written in C++. We had\nnot previously observed this payload used by these threat actors. The malware name is derived from the hardcoded\nPDB path found in the RAT: C:\\Work\\Breach Remote Administration Tool\\Release\\Client.pdb. This RAT\ncommunicates with 5.189.145.248, a command and control (C2) IP address that this group has used previously with\nother malware, including DarkComet and NJRAT.\n\nThe following is a brief summary of the activities performed by the dropped payload:\n\n1. Decrypts resource 1337 using a hard-coded 14-byte key \"MjEh92jHaZZOl3\". The encryption/decryption routine\n(refer to Figure 5) can be summarized as follows:\n\n\n-----\n\n**Figure 5: Encryption/ Decryption Function**\n\nGenerate an array of integers from 0x00 to 0xff\n\nScrambles the state of the table using the given key\n\nEncrypts or decrypts a string using the scrambled table from (b).\n\nA python script, which can be used for decrypting this resource, is provided in the appendix below.\n\n2. The decrypted resource contains the C2 server’s IP address as well as the mutex name.\n\n3. If the mutex does not exist and a Windows Startup Registry key with name “System Update” does not exist, the\nmalware performs its initialization routine by:\n\nCopying itself to the path %PROGRAMDATA%\\svchost.exe\n\nSets the Windows Startup Registry key with the name “System Update” which points to the above dropped\n\n\n-----\n\nover port 10500. Once a successful connection is made, the malware tries to fetch a response from the server\nthrough its custom protocol.\n\n5. Once data is received, the malware skips over the received bytes until the start byte 0x99 is found in the server\nresponse. The start byte is followed by a DWORD representing the size of the following data string.\n\n6. The data string is encrypted with the above-mentioned encryption scheme with the hard-coded key\n“AjN28AcMaNX”.\n\n7. The data string can contain various commands sent by the C2 server. These commands and their string\narguments are expected to be in Unicode. The following commands are accepted by the malware:\n\n**Conclusion**\nAs with previous spear-phishing attacks seen conducted by this group, topics related to Indian Government and\nMilitary Affairs are still being used as the lure theme in these attacks and we observed that this group is still actively\nexpanding their toolkit. It comes as no surprise that cyber attacks against the Indian government continue, given the\nhistorically tense relations in the region.\n\n**Appendix**\n\n**Encryption / Decryption algorithm translated into Python**\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/5hn3fparz8n2bmjpwzvxbds7gcnb7kum"
    ],
    "report_names": [
        "Fireeye_Spear-Phishing-Indian-Government-Officials(06-03-2016)"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "66fc98f4-8978-401e-9b73-81c3d5f1e44c",
            "created_at": "2024-05-01T02:03:08.050109Z",
            "updated_at": "2025-03-27T02:05:17.327953Z",
            "deleted_at": null,
            "main_name": "COPPER FIELDSTONE",
            "aliases": [
                "Gorgon Group",
                "Green Havildar ",
                "Mythic Leopard ",
                "Operation C-Major ",
                "Operation Transparent Tribe ",
                "Pasty Draco ",
                "ProjectM ",
                "Storm-0156 ",
                "APT36 "
            ],
            "source_name": "Secureworks:COPPER FIELDSTONE",
            "tools": [
                " DarkComet",
                " LuminosityLink",
                " Peppy",
                " njRAT",
                "Crimson RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041763,
    "ts_creation_date": 1483167724,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/3108aea5c7ef8c8a6d3633612c4f0231b1cec25b.pdf",
        "text": "https://archive.orkl.eu/3108aea5c7ef8c8a6d3633612c4f0231b1cec25b.txt",
        "img": "https://archive.orkl.eu/3108aea5c7ef8c8a6d3633612c4f0231b1cec25b.jpg"
    }
}