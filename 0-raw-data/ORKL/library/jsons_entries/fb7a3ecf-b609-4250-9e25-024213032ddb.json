{
    "id": "fb7a3ecf-b609-4250-9e25-024213032ddb",
    "created_at": "2023-01-12T15:02:00.338885Z",
    "updated_at": "2025-03-27T02:05:19.232357Z",
    "deleted_at": null,
    "sha1_hash": "3497ce24e6ea643c3ad7c34f134dd52d170442b8",
    "title": "2020-05-17 - CrowdStrike Falcon Detects Kernel Attacks Exploiting Vulnerable Dell Driver (CVE-2021-21551)",
    "authors": "",
    "file_creation_date": "2022-05-28T21:44:53Z",
    "file_modification_date": "2022-05-28T21:44:53Z",
    "file_size": 2208723,
    "plain_text": "# CrowdStrike Detects Dell Driver Vulnerability CVE-2021- 21551\n\n**[crowdstrike.com/blog/crowdstrike-falcon-detects-dell-driver-vulnerability-cve-2021-21551/](https://www.crowdstrike.com/blog/crowdstrike-falcon-detects-dell-driver-vulnerability-cve-2021-21551/)**\n\nSatoshi Tanda May 17, 2021\n\n[Vulnerabilities in the kernel mode component have serious implications on endpoint security.](https://www.crowdstrike.com/cybersecurity-101/endpoint-security/)\nOperating systems and independent software vendors have been improving the security of\ncode for years, but what happens if an endpoint is still using a kernel mode driver designed\nand implemented 10 years ago?\n\n**[CrowdStrike reached out to Dell reporting a driver vulnerability (CVE-2021-21551)](https://www.dell.com/support/kbdoc/ro-ro/000186019/dsa-2021-088-dell-client-platform-security-update-for-dell-driver-insufficient-access-control-vulnerability)**\n**affecting the dbutil_2_3.sys kernel mode driver found in Dell’s system update software**\n**used to update the BIOS. After establishing communication and receiving confirmation on**\nthe vulnerability, Dell publicly disclosed the issue on May 4, 2021, in a coordinated effort with\nother security researchers who reported the same issue to minimize disruptions for\npotentially impacted endpoints.\n\nWhat makes this vulnerability stand out in dbutil_2_3.sys is that drivers are legitimately\nsigned and can remain unpatched “in the wild” for years, significantly increasing the attack\nsurface for adversaries.\n\n\n-----\n\nWith a CVSS base score of 8.8, its potential weaponization could impact Dell enterprise\nsystems around the world for years. While Dell has released a security bulletin\nacknowledging the 10-year driver issue, CrowdStrike Falcon® customers are protected\n**against an attempt to exploit it.**\n\n## User Land Is Good, Kernel Mode Is King\n\n[Adversaries are constantly updating their tactics and techniques to maximize their efficiency](https://adversary.crowdstrike.com/)\nin compromising targets while flying below the defenders’ radar. The DSA-2021-088 (CVE2021-21551) vulnerability could potentially be one such tool that once added to the\nadversary’s toolset would allow for kernel-mode privilege escalation.\n\nVulnerabilities in kernel drivers can be the holy grail of adversarial tactics as they enable\nprivilege escalation to the point where adversaries can make system changes ranging from\ndeactivating security measures to stealing user credentials and pivoting laterally across the\ninfrastructure.\n\n## The Dell Driver Vulnerability\n\nDSA-2021-088 pertains to the vulnerability in Dell’s dbutil_2_3.sys kernel mode driver. This\ndriver is used by Dell’s system update software to update BIOS, for example, and is\nembedded into, extracted from and loaded by the BIOS update executables, such as\nLatitudeXXXX.exe.\n\nThe issue with this driver is that it exposes multiple IOCTLs that let non-administrators\nperform operations that would typically require administrator privileges. As such, it allows\nlocal privilege escalation (LPE).\n\nSome examples include but are not limited to:\n\n0x9B0C1EC8 and 0x9B0C1EC4 allow arbitrary kernel memory write and read\n0x9B0C1F44 and 0x9B0C1F40 allow arbitrary physical memory write and read\n0x9B0C1F80, 0x9B0C1F84, 0x9B0C1F88, 0x9B0C1F8C and a few others allow\naccess to arbitrary IO ports\n\nAll of these are LPEs for non-administrators. While there is no publicly available exploit of\nwhich we are aware as of this writing, some of these vulnerabilities are exploitable in\npractice. Below is an example exploitation of 0x9B0C1EC4 reading contents of kernel\nmemory address from a non-administrator user.\n\n\n-----\n\nFigure 1. Reading kernel memory from non-administrator by exploiting DBUtil_2_3 (Click to enlarge)\n\nAdding to the complexity of the issue, this driver can be automatically loaded if the endpoint\nhas already installed Dell’s system update programs and has been configured to check\nupdates automatically. This means that an attacker would not need to drop the\ndbutil_2_3.sys file, elevate itself to the administrator and load the driver. All it would take is to\nexecute a program that issues IOCTL as non-administrator, which is substantially harder to\ndetect compared with the former scenario.\n\n## CrowdStrike’s Protection\n\nThe CrowdStrike Falcon platform provides visibility into these issues and has protected\nendpoints from exploitation of vulnerable drivers through Additional User-Mode Data\n[(AUMD). For more information on this, read Detecting and Preventing Kernel Attacks, which](https://www.crowdstrike.com/blog/how-to-detect-and-prevent-kernel-attacks-with-crowdstrike/)\nprovides details on CrowdStrike coverage and additional examples.\n\nSpecifically for DSA-2021-088 (CVE-2021-21551), we provide — for endpoints with Falcon\n6.18 and above — visibility against some of the above IOCTLs that are most likely to be\nabused in the real world. If one of those IOCTLs is exploited, it would show up in the Falcon\nHost UI as a high-severity detection as shown below, even if an attacker avoided the driver\ninstallation steps outlined above.\n\n\n-----\n\nFigure 2. Detecting exploitation of IOCTL (Click to enlarge)\n\nIn addition to the protections against IOCTLs, Falcon provides users with access to Event\nSearch, which can identify with this query how widely the vulnerable driver is loaded within\nthe organization.\n```\nevent_simpleName=DriverLoad SHA256HashData IN\n(0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5,\n87e38e7aeaaaa96efe1a74f59fca8371de93544b7af22862eb0e574cec49c7c3) | dedup aid\n\n```\nFalcon users can also query processes that initiated the loading of the driver and/or issued\nsome of the vulnerable IOCTLs that might warrant deeper investigation, through\nDriverLoaded and UmppcDetectInfo events as follows:\n```\nevent_simpleName=ProcessRollup2\n  [ search event_simpleName=DriverLoad SHA256HashData IN\n(0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5,\n87e38e7aeaaaa96efe1a74f59fca8371de93544b7af22862eb0e574cec49c7c3)\n  | where isnotnull(RpcClientProcessId_decimal)\n  | rename RpcClientProcessId_decimal as TargetProcessId\n  | fields TargetProcessId, aid\n  ]\nevent_simpleName=ProcessRollup2\n  [ search event_simpleName=UmppcDetectInfo DeviceName=\"\\\\Device\\\\DBUtil_2_3\"\n  | rename ContextProcessId as TargetProcessId\n  | fields TargetProcessId, aid\n  ]\n\n```\nCrowdStrike will monitor the active exploitation of the driver and enhance detection as we\nobserve more cases in the wild. In the meantime, we strongly recommend making an\ninventory of the hosts that load the driver and remediate the issue according to the guide\nprovided by Dell.\n\nWe would like to thank Dell for addressing the issue, as well as all community members who\nhelped Dell to make the fix happen.\n\n### References:\n\nDSA-2021-088: Dell Client Platform Security Update for an Insufficient Access Control\nVulnerability in the Dell dbutil Driver\nAdditional Information Regarding DSA-2021-088: Dell Client Platform Security Update\nfor an Insufficient Access Control Vulnerability in the Dell dbutil Driver\n\n**Additional Resources**\n\n_[Learn more about the CrowdStrike Falcon® platform by visiting the product webpage.](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)_\n_Learn more about CrowdStrike endpoint detection and response by visiting the Falcon_\n_[Insight™ webpage.](https://go.crowdstrike.com/try-falcon-prevent.html)_\n\n\n-----\n\n_See how you can continuously monitor and assess the vulnerabilities in your_\n_[environment with Falcon Spotlight.](https://www.crowdstrike.com/endpoint-security-products/falcon-spotlight-vulnerability-management/)_\n_[Test CrowdStrike next-gen AV for yourself. Start your free trial of Falcon Prevent™](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_today._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-17 - CrowdStrike Falcon Detects Kernel Attacks Exploiting Vulnerable Dell Driver (CVE-2021-21551).pdf"
    ],
    "report_names": [
        "2020-05-17 - CrowdStrike Falcon Detects Kernel Attacks Exploiting Vulnerable Dell Driver (CVE-2021-21551).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535720,
    "ts_updated_at": 1743041119,
    "ts_creation_date": 1653774293,
    "ts_modification_date": 1653774293,
    "files": {
        "pdf": "https://archive.orkl.eu/3497ce24e6ea643c3ad7c34f134dd52d170442b8.pdf",
        "text": "https://archive.orkl.eu/3497ce24e6ea643c3ad7c34f134dd52d170442b8.txt",
        "img": "https://archive.orkl.eu/3497ce24e6ea643c3ad7c34f134dd52d170442b8.jpg"
    }
}