{
    "id": "617d6623-509b-4e1a-b92b-e4e7b8d178da",
    "created_at": "2023-01-12T15:04:42.343527Z",
    "updated_at": "2025-03-27T02:17:23.366247Z",
    "deleted_at": null,
    "sha1_hash": "3425796c94d66924d3b49a0bf5e2b74535ff08df",
    "title": "2019-08-05 - Catching lateral movement in internal emails",
    "authors": "",
    "file_creation_date": "2022-05-28T17:32:21Z",
    "file_modification_date": "2022-05-28T17:32:21Z",
    "file_size": 1625665,
    "plain_text": "# Catching lateral movement in internal emails\n\n**[blog.reversinglabs.com/blog/catching-lateral-movement-in-internal-emails](https://blog.reversinglabs.com/blog/catching-lateral-movement-in-internal-emails)**\n\n[Threat Research | August 5, 2019](https://blog.reversinglabs.com/blog/tag/threat-research)\n\nBlog Author\n[Tomislav Peričin, Chief Software Architect & Co-Founder at ReversingLabs. Read More...](https://blog.reversinglabs.com/blog/author/tomislav-peri%C4%8Din)\n\n\n-----\n\nEmail-based attacks are the most prominent threat vector that organizations see today. Like\nany other form of communication, emails get exploited to become carriers for a wide variety\nof attacks. Securing email nowadays means worrying about malicious attachments, links\nleading to malware, links leading to phishing sites, and business email compromise attacks.\n\nDue to their nature, those attacks are commonly perceived as threats external to the\norganization. However, when the organization is already compromised, internal emails can\nbecome a tool used by the attacker to move laterally through the organization. In some\ncases, they are the stealthiest choice, as some organizations only perform security checks\nagainst incoming emails.\n\nThe following analysis is a reconstruction of an attack on a manufacturing company with ties\nto aerospace and defense industries.\n\nYosi and Idan both work for a compromised manufacturing company. Yosi, a mechanical\nengineer, is sending an email to Idan. He is notifying his colleague about changes to their\nhelpdesk software. The email contains a short message about the documentation that he’s\nattached.\n\n\n-----\n\nWhen run through an automated language translation service, the message reads something\nlike this.\n\n\n-----\n\nSounds quite convincing. Since Idan trusts his coworker Yosi, he feels comfortable opening\nthe attachment. There’s no reason for Idan to suspect that Yosi isn’t the one sending him the\nemail. The email is sent from Yosi’s email address; it has the same reply-to address. Even if\nIdan put in the extra effort to inspect the email headers, all he would see is that the email\nwas routed through the internal mail server.\n\nHowever, that attachment is not a RAR archive despite its file extension. In reality, it is an\nACE archive - a format that WinRAR knows how to open. Within WinRAR, the ACE format\nsupport is provided by a freeware library made by the WinACE authors.\n\nThat library has recently been found to be affected by a path traversal vulnerability - an issue\nthat allows an attacker to place a file in an arbitrary folder on the system. This vulnerability\ncan be used to place an executable file in just the right place for it to launch the next time the\nmachine powers up. That is exactly what the attachment is trying to do.\n\nReversingLabs A1000 visualizes the email headers and allows analysts to browse email\ncontents. Email attachments - when they are an archive - are extracted and displayed in a\nview similar to one of an archive manager. The image below shows the contents of the ACE\n\n\n-----\n\narchive Yosi sent to Idan.\n\nThe documentation that Yosi promised to Idan is certainly there. There’s lots of it, and it is\nused to cover the fact that Yosi is not who he claims to be. The first folder in the list of files is\nan indication that the attached ACE archive is exploiting the path traversal vulnerability [assigned CVE-2018-20250.](https://nvd.nist.gov/vuln/detail/CVE-2018-20250)\n\nFollowing the folder path all the way down, it is easy to see where the following executable\nfile is going to be extracted to.\n\nNot only is the executable installed to the startup location, but it is also clear that this attack\nis a highly personalized one. The path traversal only works because the absolute paths are\nhardcoded to point to the user-specific startup folder. That makes the attack viable only for\nthe machine of the intended email recipient, Idan.\n\nAt this point, it is clear that the attacker has compromised the organization. That Yosi’s\ncredentials are in the hands of the attacker. That the recon phase of the attack has been\ncompleted, and that the attacker is interested in moving laterally through the organization. It\nis more than likely that the next target, Idan, has access or information that the attacker is\nultimately after.\n\n\n-----\n\nThe malicious executable the attacker expects to have successfully planted on Idan s\nmachine reveals more about the who and the why.\n\nWhile \"Agent\" is not a particularly interesting or indicative threat name produced by our\nsystem, it is a starting point. It means that the threat itself isn’t particularly unique, and that it\nshares at least some of the commonality with previously discovered trojans. This is where\nfunctional code similarity can help. There is exactly one more file in the ReversingLabs cloud\nsystem similar to the one we’re looking at.\n\nThat file has been classified as RisingSun Trojan by McAfee. The [report which McAfee’s](https://www.mcafee.com/enterprise/en-us/assets/reports/rp-operation-sharpshooter.pdf)\nAdvanced Threat Research team published on the Operation Sharpshooter describes what\nwe’ve seen so far perfectly - an advanced attacker targeting the defense sector.\n\n\n-----\n\nThe suspicion that the attacks are connected is further supported by URLs extracted from\nthe relevant executable. They seem to follow the same pattern as described in McAfee’s\nreport.\n\nA look at the executable hex dump also reveals a few striking similarities between the\nattacks.\n\nThe email Yosi sent to Idan may very well be an indication of new activity for this APT actor.\nWhile the infection techniques seem to have evolved since McAfee published their report in\nDecember 2018, the methods of operation remained similar. The list of targets the actor is\ninterested in has apparently been expanded to a new region as well - Israel.\n\nScouring the web for additional information based on what’s been discovered at this point\n[reveals one more report published by the FireEye Threat Research team. They go into the](https://www.fireeye.com/blog/threat-research/2019/03/winrar-zero-day-abused-in-multiple-campaigns.html)\nanalysis of this same email, so it is recommended to read their report as a follow-up to our\ndiscussion here.\n\nEmail is an important threat-carrying vector. Securing an organization's email infrastructure\nmandates checking all emails received by the organization, whether they are coming from\nthe outside or from within. The ReversingLabs Titanium platform enables such deep\ninspection with its elastic file processing capabilities. With our platform, the possibility of\n\n\n-----\n\nchecking every email message the organization sees becomes the norm. Deploying such a\ncapability within an organization could make the difference between catching the lateral\nemail movement and missing it altogether.\n\n**IOC:**\nMIME - 5b5d7d74db59c520b72be1e328563a1ee864e8931a0ae7487d753ee3e166de1c\n\n**URL:**\nhttp://www[.]alahbabgroup[.]com/bakala/verify.php\nhttp://www[.]khuyay[.]org/odin_backup/public/loggoff.php\nhttp://103[.]225[.]168[.]159/admin/verify.php\nhttp://47[.]91[.]56[.]21/verify.php\n\n[Read our prior blog in the series on Ransomware in exotic email attachments.](https://blog.reversinglabs.com/blog/ransomware-in-exotic-email-attachments)\n\n## MORE BLOG ARTICLES\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-05 - Catching lateral movement in internal emails.pdf"
    ],
    "report_names": [
        "2019-08-05 - Catching lateral movement in internal emails.pdf"
    ],
    "threat_actors": [
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a13b5ca4-fb52-44a9-aa5a-595eca6789ed",
            "created_at": "2022-10-25T15:50:23.4331Z",
            "updated_at": "2025-03-27T02:00:55.46701Z",
            "deleted_at": null,
            "main_name": "Sharpshooter",
            "aliases": [
                "Sharpshooter"
            ],
            "source_name": "MITRE:Sharpshooter",
            "tools": [
                "Rising Sun"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "874ada20-4ca8-4997-9f2e-e3933742d09c",
            "created_at": "2023-01-06T13:46:38.857642Z",
            "updated_at": "2025-03-27T02:00:02.936711Z",
            "deleted_at": null,
            "main_name": "Operation Sharpshooter",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Sharpshooter",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535882,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653759141,
    "ts_modification_date": 1653759141,
    "files": {
        "pdf": "https://archive.orkl.eu/3425796c94d66924d3b49a0bf5e2b74535ff08df.pdf",
        "text": "https://archive.orkl.eu/3425796c94d66924d3b49a0bf5e2b74535ff08df.txt",
        "img": "https://archive.orkl.eu/3425796c94d66924d3b49a0bf5e2b74535ff08df.jpg"
    }
}