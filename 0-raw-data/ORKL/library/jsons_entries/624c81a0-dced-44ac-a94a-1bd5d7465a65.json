{
    "id": "624c81a0-dced-44ac-a94a-1bd5d7465a65",
    "created_at": "2023-01-12T15:02:52.199272Z",
    "updated_at": "2025-03-27T02:14:38.937539Z",
    "deleted_at": null,
    "sha1_hash": "75e1b23e4f1012b41f51ba0c66df129e08b58469",
    "title": "2022-02-16 - Meet Kraken- A New Golang Botnet in Development",
    "authors": "",
    "file_creation_date": "2022-05-28T19:33:02Z",
    "file_modification_date": "2022-05-28T19:33:02Z",
    "file_size": 4584510,
    "plain_text": "# Meet Kraken: A New Golang Botnet in Development\n\n**[zerofox.com/blog/meet-kraken-a-new-golang-botnet-in-development/](https://www.zerofox.com/blog/meet-kraken-a-new-golang-botnet-in-development/)**\n\nFebruary 16, 2022\n\n[BLOG](https://www.zerofox.com/blog/)\n\nFebruary 16, 2022 | by [Stephan Simon](https://www.zerofox.com/blog/author/stephan-simon/)\n\n\n-----\n\n9 minute read\n\n**_February 22, 2022 Editor’s Note: Since conducting his initial research, ZeroFox_**\n**_Intelligence Researcher Stephan Simon has uncovered additional details about the_**\n**_operators and the botnet. Updates have been published_** **_[here.](https://www.zerofox.com/blog/quick-update-kraken-completes-its-rebrand-to-anubis/)_**\n\nIn late October 2021, ZeroFox Intelligence discovered a previously unknown botnet called\nKraken. Though still under active development, Kraken already features the ability to\ndownload and execute secondary payloads, run shell commands, and take screenshots of\nthe victim’s system. It currently makes use of SmokeLoader—a piece of malware used to\ninstall other malicious software—to spread, quickly gaining hundreds of bots each time a\nnew command and control server is deployed. Despite having the same name, it should not\nbe confused with the Kraken botnet from 2008 as they have little else in common.\n\n## Details\n\nSince October 2021, ZeroFox Intelligence has been tracking Kraken – a previously unknown\nbotnet targeting Windows that is currently under active development. Although the bot is\nsimple in functionality, the author has been experimenting with new features while altering\nothers. Current iterations of Kraken feature the ability to:\n\nMaintain persistence\nCollect information about the host for registration (varies per version)\nDownload and execute files\nRun shell commands\n\n\n-----\n\nSteal various cryptocurrency wallets\nTake screenshots\n\n## “Open Source” Beginnings\n\nEarly versions of Kraken were based on code uploaded to GitHub on October 10, 2021. The\nproject only had two commits, and the source code pre-dated any binaries ZeroFox observed\nin the wild. It is not currently known if the GitHub profile belongs to the botnet’s operator or if\nthe operator simply used the code to kickstart their development.\n\n**Figure 1. GitHub repository page for an early version of Kraken**\n\n_Source: ZeroFox Intelligence_\n\n## Observed Infection Vector\n\nThanks to a tip by [@abuse_ch, ZeroFox learned that Kraken originally spread in self-](https://twitter.com/abuse_ch)\nextracting RAR SFX files downloaded by SmokeLoader. These SFX files contained a UPXpacked version of Kraken, RedLine Stealer, and another binary used to delete Kraken.\nCurrent versions of Kraken are now downloaded by SmokeLoader directly. Kraken binaries\nare still UPX-packed but are now further protected by the Themida packer as well.\n\n**Figure 2. Screenshot of a Kraken SFX archive’s contents**\n\n_Source: ZeroFox Intelligence_\n\n## Installation and Persistence\n\n\n-----\n\nDuring Kraken s installation phase, it attempts to move itself into %AppData%\\Microsoft. The\nfile name is hardcoded, though the author has changed it a few times. ZeroFox has observed\nfile names such as taskhost.exe, Registry.exe, and Windows Defender GEO.exe.\n\nTo stay hidden, Kraken runs the following two commands:\n\n1. powershell -Command Add-MpPreference -ExclusionPath %APPDATA%\\Microsoft\n2. attrib +S +H %APPDATA%\\Microsoft\\<EXE_NAME>\n\nThe PowerShell command tells Microsoft Defender not to scan Kraken’s installation directory,\nwhile the attrib command is used to hide the copied EXE file from an Explorer window that\nhas not enabled the “Show hidden files, folders, and drives” option.\n\nKraken also makes use of the Windows Run registry key to ensure it starts every time the\nvictim logs in.\n\n**Figure 3. Kraken’s Run key persistence**\n\n_Source: ZeroFox Intelligence_\nA mix of fake and real information is stored in a new registry key under\nHKEY_CURRENT_USER\\Software; it is all currently unused after saving it during the\ninstallation. The name of the key is another hardcoded value, though it has also changed\noccasionally. Early versions of Kraken observed by ZeroFox created a key with the name\n“Networking Service” or some slight variation, such as “Networking5 Servic1e” and\n“Netrworking5r Servirc1er”.\n\n**Figure 4. Kraken registry information**\n\n_Source: ZeroFox Intelligence_\nAside from the hard-coded name for the registry key, the following information shown in\n**Figure 4 has remained the same in every version ZeroFox has encountered in the wild:**\n\nID – obfuscated UUID\nINSTALL – installation timestamp\n\n\n-----\n\nLAST – empty\nNAME – obfuscated binary and Run key name (minus file extension)\nREMASTER – always “nil”\nVERSION – always “0.5.6”\n\n## Features\n\nKraken’s feature set is simplistic for a botnet. Although not present in earlier builds, the bot is\ncapable of collecting information about the infected host and sending it back to the command\nand control (C2) server during registration. The information collected seems to vary from\nbuild to build, though ZeroFox has observed the following being collected:\n\nHostname\nUsername\nBuild ID (TEST_BUILD_ + the timestamp of the first run)\nCPU details\nGPU details\nOperating system and version\n\nThe botnet also features the ability to download and execute files. Originally, Kraken\ncontained separate but similar functions for downloading files for different situations, such as\nupdating the bot itself, executing secondary payloads, and receiving files through direct\nsocket connection. These functions have since been combined into one, while the redundant\nfunctions were removed.\n\nKraken’s operators are able to run shell commands on infected hosts from the dashboard as\nwell, returning the results back to the C2 server.\n\nSSH brute-forcing functionality was added to some builds but was quickly removed. This\nfunction was hardcoded to attempt logging in as the root user of a given target and assumed\na server would be listening on the default port. ZeroFox did not see any evidence of this\nfeature being used, likely explaining its quick removal.\n\nUpon execution, Kraken immediately takes a screenshot to send to the C2. A “ScreenShot”\ncommand also exists if the operator decides to take screenshots of the victim’s system on\ndemand.\n\nThe most recent feature addition is the ability to steal various cryptocurrency wallets from the\nfollowing locations:\n\n%AppData%\\Zcash\n%AppData%\\Armory\n%AppData%\\bytecoin\n%AppData%\\Electrum\\wallets\n%AppData%\\Ethereum\\keystore\n\n\n-----\n\n%AppData%\\Exodus\\exodus.wallet\n%AppData%\\Guarda\\Local Storage\\leveldb\n%AppData%\\atomic\\Local Storage\\leveldb\n%AppData%\\com.liberty.jaxx\\IndexedDB\\file__0.indexeddb.leveldb\n\nCurrently supported commands are:\n\nPosition – Unknown\nScreenShot – take a screenshot\nSHELL – run a Windows shell command with cmd\nUPLOAD – download and execute an EXE\n\n**Figure 5. Original regular expressions used to parse received commands**\n\n_Source: ZeroFox Intelligence_\n\n\n-----\n\n## Dashboards\n\nMultiple versions of the administration panel or dashboard have been created since October\n2021. While the original code found on GitHub did include a server, it did not have a webbased interface for interacting with the botnet.\n\n## Kraken Panel\n\nThe initial panel, aptly named “Kraken Panel,” was simple in terms of features. It offered\nbasic statistics, links to download payloads, an option to upload new payloads, and a way to\ninteract with a specific number of bots. This version did not appear to allow the operator(s) to\nchoose which victims to interact with.\n\n**Figure 6. English-translated version of the Kraken C2 panel**\n\n_Source: ZeroFox Intelligence_\n\n\n-----\n\n## Anubis Panel\n\nThe current version of the C2 has undergone a total redesign—complete with a new\nname, Anubis. The Anubis Panel provides far more information to the operator(s) than the\noriginal Kraken Panel. In addition to the previously provided statistics, it is now possible to\nview command history and information about the victim.\n\n**Figure 7. Dashboard for the Anubis Panel**\n\n_Source: ZeroFox Intelligence_\nA later update to the Anubis Panel added the ability for the operator(s) to be more selective\nwhen choosing targets for commands. In previous versions, the operator(s) could only\nchoose the number of victims to target with the command. With this update, targets can be\nchosen individually or by group using their external IP or geographic location.\n\n**Figure 8. Selecting a victim by external IP to run a shell command**\n\n_Source: ZeroFox Intelligence_\nThe Anubis Panel also allows the operator(s) to view task and command history via the\ndashboard and TASK page. The TASK page shows information such as the ID generated for\nthe task, the command being sent, how many victims the command should be sent to, the\n\n\n-----\n\ntargeted geolocation, and a timestamp of when the task was initiated.\n\nInitially, every task investigated by ZeroFox resulted in a version of RedLine Stealer being\ndownloaded and executed on the victim’s machine. Some shell commands were observed\nas well, though these were only used to download more RedLine payloads using curl.\n\n**Figure 9. TASK page showing command history**\n\n_Source: ZeroFox Intelligence_\nAs the operator(s) behind Kraken continued to expand and gather more victims, ZeroFox\nbegan observing other generic information stealers and cryptocurrency miners being\ndeployed. As of this writing, the botnet appears to be collecting around USD 3,000 every\nmonth.\n\n**Figure 10. Mining statistics from the cryptocurrency mining pool Ethermine**\n\n_Source: ZeroFox Intelligence_\n\n## Recommendations\n\nEnsure antivirus and intrusion detection software is up to date with all patches and rule\nsets.\nEnable two-factor authentication for all organizational accounts to help mitigate\nphishing and credential stuffing attacks.\nMaintain regularly scheduled backup routines, including off-site storage and integrity\nchecks.\nAvoid opening unsolicited attachments and never click suspicious links.\n\n\n-----\n\nLog and monitor all administrative actions as much as possible. Alert on any suspicious\nactivity.\nReview network logs for potential signs of compromise and data egress.\n\n## Conclusion\n\nWhile in development, Kraken C2s seem to disappear often. ZeroFox has observed\ndwindling activity for a server on multiple occasions, only for another to appear a short time\nlater using either a new port or a completely new IP. By using SmokeLoader to spread,\nKraken quickly gains hundreds of new bots each time the operator changes the C2.\nMonitoring commands sent to Kraken victims from October 2021 through December 2021\nrevealed that the operator had focused entirely on pushing information stealers – specifically\nRedLine Stealer. It is currently unknown what the operator intends to do with the stolen\ncredentials that have been collected or what the end goal is for creating this new botnet.\n\n## MITRE ATT&CK\n\n**ID** **Description**\n\n[T1027.002](https://attack.mitre.org/techniques/T1027/002/) Obfuscated Files or Information: Software Packing\n\n[T1033](https://attack.mitre.org/techniques/T1033/) System Owner/User Discovery\n\n[T1047](https://attack.mitre.org/techniques/T1047/) Windows Management Instrumentation\n\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/) Command and Scripting Interpreter: PowerShell\n\n[T1059.003](https://attack.mitre.org/techniques/T1059/003/) Command and Scripting Interpreter: Windows Command Shell\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information Discovery\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture\n\n[T1132.001](https://attack.mitre.org/techniques/T1132/001/) Data Encoding: Standard Encoding\n\n[T1547.001](https://attack.mitre.org/techniques/T1547/001/) Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder\n\n[T1571](https://attack.mitre.org/techniques/T1571/) Non-Standard Port\n\n## IOCs\n\n65.21.105.85\n91.206.14.151\n95.181.152.184\n185.112.83.22\n185.112.83.96\n\n\n-----\n\n185.206.212.165\n213.226.71.125\n1d772f707ce74473996c377477ad718bba495fe7cd022d5b802aaf32c853f115\nd742a33692a77f5caef5ea175957c98b56c2dc255144784ad3bade0a0d50d088\nddf039c3d6395139fd7f31b0a796a444f385c582ca978779aae7314b19940812\ndcaaef3509bc75155789058d79f025f14166386cec833c2c154ca34cfea26c52\n54d36e5dce2e546070dc0571c8b3e166d6df62296fa0609a325ace23b7105335\n095c223b94656622c81cb9386aefa59e168756c3e200457e98c00b609e0bb170\n0f0cabb24d8cc93e5aed340cfc492c4008509f1e84311d61721a4375260a0911\n2ced68e4425d31cca494557c29a76dfc3081f594ff01549e41d2f8a08923ef61\n3215decffc40b3257ebeb9b6e5c81c45e298a020f33ef90c9418c153c6071b36\nef3e0845b289f1d3b5b234b0507c554dfdd23a5b77f36d433489129ea722c6bb\n7c76ca5eb757df4362fabb8cff1deaa92ebc31a17786c89bde55bc53ada43864\n48c2f53f1eeb669fadb3eec46f7f3d4572e819c7bb2d39f22d22713a30cc1846\n43f46a66c821e143d77f9311b24314b5c5eeccfedbb3fbf1cd484c9e4f537a5d\n8c4294e3154675cd926ab6b772dbbe0e7a49cae16f4a37d908e1ca6748251c43\n\n**Tags:** [Botnet,](https://www.zerofox.com/topic/botnet/) [Cybersecurity,](https://www.zerofox.com/topic/cybersecurity/) [Threat Intelligence](https://www.zerofox.com/topic/threat-intelligence/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-16 - Meet Kraken- A New Golang Botnet in Development.pdf"
    ],
    "report_names": [
        "2022-02-16 - Meet Kraken- A New Golang Botnet in Development.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535772,
    "ts_updated_at": 1743041678,
    "ts_creation_date": 1653766382,
    "ts_modification_date": 1653766382,
    "files": {
        "pdf": "https://archive.orkl.eu/75e1b23e4f1012b41f51ba0c66df129e08b58469.pdf",
        "text": "https://archive.orkl.eu/75e1b23e4f1012b41f51ba0c66df129e08b58469.txt",
        "img": "https://archive.orkl.eu/75e1b23e4f1012b41f51ba0c66df129e08b58469.jpg"
    }
}