{
    "id": "7693597d-88cf-4b35-a340-5479229e4938",
    "created_at": "2023-01-12T15:10:54.445321Z",
    "updated_at": "2025-03-27T02:06:09.380738Z",
    "deleted_at": null,
    "sha1_hash": "9719e72d9352e2291d916616608c535b40d64e96",
    "title": "2022-10-08 - Nimbo-C2 - A new C2 Framework",
    "authors": "",
    "file_creation_date": "2022-10-23T13:13:27Z",
    "file_modification_date": "2022-10-23T13:13:27Z",
    "file_size": 318060,
    "plain_text": "# itaymigdal/Nimbo-C2\n\n**github.com/itaymigdal/Nimbo-C2**\n\nitaymigdal\n\n## Nimbo-C2\n\n### Nimbo-C2 About Features Installation\n Easy Way Easier Way\n\n\n-----\n\n### Usage\n Main Window Agent Window Credits TODO\n Modules Misc\n\n## About\n\n### Nimbo-C2 is yet another (simple and lightweight) C2 framework.\n\n Nimbo-C2 agent currently supports Windows x64 only. It's written in Nim, with some usage of .NET (by dynamically loading the CLR to the process). Nim is powerful, but interacting with Windows is much easier and robust using Powershell, hence this combination is made.\n\n All server components are written in Python:\n\n HTTP listener that manages the agents. Builder that generates the agent payloads. Nimbo-C2 is the interactive C2 component that rule'em all!\n\n I developed Nimbo-C2 in the past several months mainly at the late evenings while working at my day job and waking up at nights to my boy, in order to learn and maybe contribute my part to the cyber community ðŸ’ª.\n\n\n-----\n\n### My work wouldn t be possible without the previous great work done by others, listed under credits.\n\n## Features\n\n### Build EXE, DLL payloads. Packing payloads using UPX and obfuscate the PE section names ( UPX0, UPX1 ) to make detection and unpacking harder. Encrypted HTTP communication (AES in CBC mode, key hardcoded in the agent and configurable by the config.jsonc ). Auto-completion in the C2 Console for convenient interaction. In-memory Powershell commands execution. File download and upload commands. Built-in discovery commands. Screenshot taking and clipboard stealing. Memory evasion techniques like NTDLL unhooking, ETW & AMSI patching. LSASS and SAM hives dumping. Shellcode injection. Persistence capabilities. UAC bypass methods. And more !\n\n## Installation\n\n Easy Way\n\n### 1. Clone the repository and cd in\n```\ngit clone https://github.com/itaymigdal/Nimbo-C2\n\ncd Nimbo-C2\n\n 1. Build the docker image\ndocker build -t nimbo-dependencies .\n\n 1. cd again into the source files and run the docker image interactively, expose port 80\n and mount Nimbo-C2 directory to the container (so you can easily access all project files, modify config.jsonc, download and upload files from agents, etc.). For Linux replace ${pwd} with $(pwd) .\ncd Nimbo-C2\n\ndocker run -it --rm -p 80:80 -v ${pwd}:/Nimbo-C2 -w /Nimbo-C2 nimbo-dependencies\n\n## Easier Way\n\n```\n\n-----\n\n```\ngit clone https://github.com/itaymigdal/Nimbo C2\n\ncd Nimbo-C2/Nimbo-C2\n\ndocker run -it --rm -p 80:80 -v ${pwd}:/Nimbo-C2 -w /Nimbo-C2 itaymigdal/nimbodependencies\n\n## Usage\n\n### First, edit config.jsonc for your needs.\n\n Then run with: python3 Nimbo-C2.py\n\n Use the help command for each screen, and tab completion.\n\n## Main Window\nNimbo-C2 > help\n\n  --== Agent ==-\n  agent list          -> list active agents\n\n  agent interact <agent-id>   -> interact with the agent\n\n  agent remove <agent-id>    -> remove agent data\n\n  --== Builder ==-\n  build exe           -> build exe agent (-h for help)\n\n  build dll           -> build dll agent (-h for help)\n\n  --== Listener ==-\n  listener start        -> start the listener\n\n  listener stop         -> stop the listener\n\n  listener status        -> print the listener status\n\n  --== General ==-\n  cls              -> clear the screen\n\n  help             -> print this help message\n\n  exit             -> exit Nimbo-C2\n\n Agent Window\n\n```\n\n-----\n\n```\nNimbo 2 [d337c406] > help\n\n  --== Send Commands ==-\n  cmd <shell-command>          -> execute a shell command\n\n  iex <powershell-scriptblock>      -> execute in-memory powershell command\n\n  --== File Stuff ==-\n  download <remote-file>         -> download a file from the agent (wrap\npath with quotes)\n\n  upload <loal-file> <remote-path>    -> upload a file to the agent (wrap paths\nwith quotes)\n\n  --== Discovery Stuff ==-\n  pstree                 -> show process tree\n\n  checksec                -> check for security products\n\n  --== Collection Stuff ==-\n  clipboard               -> retrieve clipboard\n\n  screenshot               -> retrieve screenshot\n\n  --== Post Exploitation Stuff ==-\n  lsass <method>             -> dump lsass.exe [methods: \ndirect,comsvcs] (elevation required)\n\n  sam                  -> dump sam,security,system hives using\nreg.exe (elevation required)\n\n  shellc <raw-shellcode-file> <pid>   -> inject shellcode to remote process\n\n  --== Evasion Stuff ==-\n  unhook                 -> unhook ntdll.dll\n\n  amsi                  -> patch amsi out of the current process\n\n  etw                  -> patch etw out of the current process\n\n  --== Persistence Stuff ==-\n  persist run <command> <key-name>    -> set run key (will try first hklm, then\nhkcu)\n\n  persist spe <command> <process-name>  -> persist using silent process exit\ntechnique (elevation required)\n\n  --== Privesc Stuff ==-\n  uac fodhelper <command> <keep/die>   -> elevate session using the fodhelper\nuac bypass technique\n\n  uac sdclt <command> <keep/die>     -> elevate session using the sdclt uac\nbypass technique\n\n  --== Interaction stuff ==-\n  msgbox <title> <text>         -> pop a message box (blocking! waits for\nenter press)\n\n  speak <text>              -> speak using sapi.spvoice com interface\n\n  --== Communication Stuff ==-\n  sleep <sleep-time> <jitter-%>     -> change sleep time interval and jitter\n\n  clear                 -> clear pending commands\n\n```\n\n-----\n\n```\n  collect                > recollect agent data\n\n  kill                  -> kill the agent (persistence will still\ntake place)\n\n  --== General ==-\n  show                  -> show agent details\n\n  back                  -> back to main screen\n\n  cls                  -> clear the screen\n\n  help                  -> print this help message\n\n  exit                  -> exit Nimbo-C2\n\n## Credits\n\n### OffensiveNim - Great resource that taught me a lot about leveraging Nim for implant tasks. Some of Nimbo-C2 agent capabilities are basically wrappers around OffensiveNim modified examples. Python-Prompt-Toolkit-3 - Awsome library for developing python CLI applications. Developed the Nimbo-C2 interactive console using this. ascii-image-converter - For the awsome Nimbo ascii art. All those random people from Github & Stackoverflow that I copy & pasted their code ðŸ˜˜.\n\n## TODO\n\n Modules\n\n### Improve Unhooking and patching by using syscalls. Run .NET assemblies. Migrate to another process (Meterpreter-like). Getsystem. Collect installed software. Zip & exfiltrate folder. Find sensitive files by keywords / regex search.\n\n## Misc\n\n### Develop Proxy awareness for the agent. Add option to sign PE agent with digital signature. Some very nice Github projects do that to lower detection. Support shellcode payload type. Support more packers.\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-08 - Nimbo-C2 - A new C2 Framework.pdf"
    ],
    "report_names": [
        "2022-10-08 - Nimbo-C2 - A new C2 Framework.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536254,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1666530807,
    "ts_modification_date": 1666530807,
    "files": {
        "pdf": "https://archive.orkl.eu/9719e72d9352e2291d916616608c535b40d64e96.pdf",
        "text": "https://archive.orkl.eu/9719e72d9352e2291d916616608c535b40d64e96.txt",
        "img": "https://archive.orkl.eu/9719e72d9352e2291d916616608c535b40d64e96.jpg"
    }
}