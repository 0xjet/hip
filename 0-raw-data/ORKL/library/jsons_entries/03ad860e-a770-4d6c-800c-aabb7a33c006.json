{
    "id": "03ad860e-a770-4d6c-800c-aabb7a33c006",
    "created_at": "2023-01-12T15:01:03.548671Z",
    "updated_at": "2025-03-27T02:15:06.982193Z",
    "deleted_at": null,
    "sha1_hash": "80783d0f0c8b8e610235eac40f1ab3bc7371c386",
    "title": "2020-08-10 - Gorgon APT targeting MSME sector in India",
    "authors": "",
    "file_creation_date": "2022-05-27T22:33:08Z",
    "file_modification_date": "2022-05-27T22:33:08Z",
    "file_size": 1478603,
    "plain_text": "# Gorgon APT targeting MSME sector in India\n\n**seqrite.com/blog/gorgon-apt-targeting-msme-sector-in-india/**\n\nPavankumar Chaudhari August 10, 2020\n\n10 August 2020\nWritten by [Pavankumar Chaudhari](https://www.seqrite.com/blog/author/pavankumar/)\n\n[APT,](https://www.seqrite.com/blog/category/cybersecurity/apt/) [Cybersecurity,](https://www.seqrite.com/blog/category/cybersecurity/) [Uncategorized](https://www.seqrite.com/blog/category/uncategorized/)\n\nEstimated reading time: 5 minutes\nFrom the past few months, we have been monitoring cyber-threats on MSME [Micro, Small and\n**Medium Enterprises] sector within India. MSME sector is considered to be the backbone of the**\nIndian economy. MSME employs around 40% of the country’s workforce, contributing nearly 45%\nto manufacturing output and 40% of exports. Staring at a major financial resource crunch, MSME’s\nare worst affected due to the ongoing COVID-19 pandemic.\n\nWe observed one similar wave on MSME in late April 2020 — it was a phishing campaign luring\nvictims with COVID-19 themed maldocs. From this campaign, one prominent file was:\n\nFileName face mask order.doc\n\nMD5 4FC5BA9426E9191AAB4E694E7E703E13\n\nSHA-1 B5EBAF2F5AF220FE1B1DE5433C2E39FF16B0C0B4\n\nSHA-256 2022D9CC42ED2838DAA442561107C29297BDDB88B36222345C10B39164E66819\n\nPrevalence 300+\n\n\n-----\n\nFigure 1:\n\nTrend for Gorgon APT sample\n\n## Technical Details\n\nVictims received an email with attached zip “face mask order.zip” which contained the\naforementioned maldoc responsible to drop malware into the victim machine. The attack begins\nafter opening “face mask order.doc”. This RTF is weaponized with exploit which triggers CVE2017-11882 vulnerability to execute arbitrary code.\n\nFigure 2: Process Infection Chain\n\n## CVE-2017-11882 Analysis:\n\nMalicious rtf document contains two malicious ole objects.\n\n\n-----\n\nFigure 3: RTF Objects\nThe tools extracts the ole objects from RTF file. OLE object (#0) is a VBScript file (i.e.\nServerCrypted.vbs script) and object (#2) contains Equation Editor Exploit and command to\nexecute file “CmD.exe /C cscript %tmp%\\ServerCrypted.vbs”.\n\nThe OLE object (#0) is an executable file (i.e. ServerCrypted.vbs script) as shown in figure 4.\n\n\n-----\n\nFigure 4: Embedded VBScript\nThe class name for this object (#2) is Equation.3 the exploit (CVE-2017-11882) as shown in the\nbelow image.\n\n\n-----\n\nFigure 5:\n\nRTF contents\nIt also contains the command to run ServerCrypted.vbs script as shown in below figure 6.\n\nFigure 6:\n\nRTF contents\nCVE-2017-11882 is present in the Microsoft Office Equation Editor (EQNEDT32.EXE) component.\nThe attacker can successfully exploit a stack buffer overflow vulnerability in the equation editor\ncomponent of MS Office and execute arbitrary code. The root cause of this vulnerability is copy\nunbounded string of FONT name defined within a FONT record structure of Equation Editor OLE\nobject data.\n\nThe below figure shows the stack buffer overflow scenario while copying the font name into a\nlocally created buffer.\n\n\n-----\n\nFigure 7: Stack buffer overflow scenario\nIn this case, the function will return “back” to 0x430c12, which is the address of WinExec, and the\nargument is the “font name” and command which the attacker wants to execute.\n\nFigure 8: Return address, overwritten with WinExec\n\n\n-----\n\n## VBScript Analysis:\n\nAfter successful exploitation, cmd.exe is executed with commands:\n\n_“/c cscript %tmp%\\ServerCrypted.vbs >> AC”_\n\nThis command creates a cscript.exe process to execute code in ServerCrypted.vbs. VBScript file\nwas already dropped in %temp% folder by WinWord process. Below Figure shows the VBScript\ncode. As shown in figure 9 and figure 10, actors used some AV-vendors names in function names,\nvariable names, and strings. This VBScript is responsible to execute two processes, cmd.exe and\npowershell.exe. Figure 10 shows the obfuscated PowerShell script.\n\nFigure 9: Contents of ServerCrypted.vbs\n\n\n-----\n\nFigure 10: Contents of ServerCrypted.vbs\n\n## PowerShell Analysis:\n\nFigure 11 shows the de-obfuscated PowerShell script.\n\nAs shown below, the script downloads two files with a .jpg extension. First file “15882060891.jpg”\nis a PowerShell script which contains encoded injector DLL written in C#, as shown in figure 12.\nThis DLL is loaded in-memory by PowerShell. In this script, actors used some interesting names of\nclass and function of injector DLL like FlorianRoth and Cyb3rOps. Florian Roth is a well-known\nsecurity researcher and CTO of [Nextron Systems. Cyb3rOps is his twitter handle name. The](https://www.nextron-systems.com/)\nsecond file which is downloaded by PowerShell is “15882060892.jpg”, is an encoded agent tesla\npayload. This payload is injected in Windows native binary RegAsm.exe.\n\nFigure 11: Decoded PowerShell script\nBelow is encoded data of hxxp://www[.]m9c[.]net/uploads/15882060891.jpg. This is a PowerShell\ncode and encoded injector DLL data.\n\n\n-----\n\nFigure 12: Contents of 15882060891.jpg\nAfter decoding PE header of injector DLL can be seen.\n\nFigure 13: Decoded data of 15882060891.jpg\nBelow figure shows contents of hxxp://www[.]m9c[.]net/uploads/15882060892.jpg. It is the\nencoded data of the final payload.\n\n\n-----\n\nFigure 14: Contents of 15882060892.jpg\n\n## Final Payload – Agent Tesla:\n\nBelow figure shows injected Agent Tesla payload in RegAsm.exe.\n\nFigure 15: Injected payload\nAgent Tesla is a well-known keylogger and infostealer written in DotNet. This malware steals\ninformation from a variety of applications like Web Browsers, Email Clients, FTP Clients,\nMessenger applications, VPN clients, etc. and can also take screenshots of the system. All stolen\n\n\n-----\n\ndata is exfiltrated over SMTP.\n\nWe have already explored and analysed Agent Tesla in our last couple of blogs:\n\nhttps://www.seqrite.com/blog/advance-campaign-targeting-manufacturing-and-export-sectors-inindia/\n\n[https://www.seqrite.com/blog/coronavirus-themed-campaign/](https://www.seqrite.com/blog/coronavirus-themed-campaign/)\n\n## Conclusion\n\nMost TTPs shared above, have been seen on several occasions in the last few years. Looking at\nmalware, C2 and technique execution, Quick Heal correlates this campaign on MSME sector to\nGorgon group [a.k.a. Subaat]. All members of the Gorgon cyber-criminal group purport to have\nPakistan-based interests/connections. Recently, [another Gorgon campaign was uncovered a few](https://www.seqrite.com/blog/advance-campaign-targeting-manufacturing-and-export-sectors-in-india/)\nmonths back which used the same commodity malware RATs to accomplish their objective.\n\nGiven the global impact of COVID-19, threat actors will likely continue to use COVID-19-themed\nemails to deliver malware broadly in support of their objectives. Considering this trend, we\nencourage Micro, Small and Medium Enterprises to apply extra scrutiny to COVID-19-related\nemails containing attachments. Though large organizations, critical government infrastructures,\nand others have somewhat built resilience to such cyber threats; but MSME still needs to cover-up\nand remain extra vigilant with a robust strategy to mitigate risks.\n\n## Threat Protection\n\nOur Seqrite and Quick Heal line of products protect against top cyber threats including Microsoft\nOffice Memory Corruption Vulnerability (CVE-2017-11882) and variants of Agent Tesla RAT. Our\nadvanced signature-less behaviour-based detection successfully blocks Agent Tesla variants.\n\nQuick Heal advises users to exercise ample caution and avoid opening attachments & clicking on\nweb links in unsolicited emails. Users should also keep their Operating System updated and have\na full-fledged security solution installed on all devices.\n\nWhile organizations with appropriate spam filtering, proper system administration, and up-to-date\nWindows hosts have a much lower risk of infection, we further encourage organizations to validate\n[the installation of the Microsoft patch for CVE 2017-11882.](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)\n\nQuick Heal’s research team is proactively monitoring all campaigns targeting MSME’s and working\nrelentlessly to ensure the safety of our customers\n\n**Subject matter experts:**\n\nKalpesh Mantri\nBajrang Mane\nPavankumar Chaudhari\n\n\n-----\n\nPavankumar is associated with Quick Heal Technologies as a Technical Lead (Research and\nDevelopment) and is also a part of Vulnerability Research and Analysis Team....\n\n[Articles by Pavankumar Chaudhari »](https://www.seqrite.com/blog/author/pavankumar/)\n\n### No Comments\n\nLeave a Reply.Your email address will not be published.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-10 - Gorgon APT targeting MSME sector in India.pdf"
    ],
    "report_names": [
        "2020-08-10 - Gorgon APT targeting MSME sector in India.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6c4e4b91-1f98-49e2-90e6-435cea8d3d53",
            "created_at": "2022-10-25T16:07:23.693797Z",
            "updated_at": "2025-03-27T02:02:09.924056Z",
            "deleted_at": null,
            "main_name": "Gorgon Group",
            "aliases": [
                "ATK 92",
                "Pasty Draco",
                "Subaat",
                "TAG-CR5"
            ],
            "source_name": "ETDA:Gorgon Group",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Atros2.CKPN",
                "Bladabindi",
                "CinaRAT",
                "Crimson RAT",
                "ForeIT",
                "Jorik",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "MSIL",
                "MSIL/Crimson",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Origin Logger",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "SEEDOOR",
                "Scarimson",
                "Socmer",
                "Yggdrasil",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "66fc98f4-8978-401e-9b73-81c3d5f1e44c",
            "created_at": "2024-05-01T02:03:08.050109Z",
            "updated_at": "2025-03-27T02:05:17.327953Z",
            "deleted_at": null,
            "main_name": "COPPER FIELDSTONE",
            "aliases": [
                "Gorgon Group",
                "Green Havildar ",
                "Mythic Leopard ",
                "Operation C-Major ",
                "Operation Transparent Tribe ",
                "Pasty Draco ",
                "ProjectM ",
                "Storm-0156 ",
                "APT36 "
            ],
            "source_name": "Secureworks:COPPER FIELDSTONE",
            "tools": [
                " DarkComet",
                " LuminosityLink",
                " Peppy",
                " njRAT",
                "Crimson RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "18278778-fa63-4a9a-8988-4d266b8c5c1a",
            "created_at": "2023-01-06T13:46:38.769816Z",
            "updated_at": "2025-03-27T02:00:02.914024Z",
            "deleted_at": null,
            "main_name": "The Gorgon Group",
            "aliases": [
                "ATK92",
                "G0078",
                "Pasty Gemini",
                "Gorgon Group",
                "Subaat"
            ],
            "source_name": "MISPGALAXY:The Gorgon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "97fdaf9f-cae1-4ccc-abe2-76e5cbc0febd",
            "created_at": "2022-10-25T15:50:23.296989Z",
            "updated_at": "2025-03-27T02:00:55.432751Z",
            "deleted_at": null,
            "main_name": "Gorgon Group",
            "aliases": [
                "Gorgon Group"
            ],
            "source_name": "MITRE:Gorgon Group",
            "tools": [
                "NanoCore",
                "QuasarRAT",
                "Remcos",
                "njRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535663,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1653690788,
    "ts_modification_date": 1653690788,
    "files": {
        "pdf": "https://archive.orkl.eu/80783d0f0c8b8e610235eac40f1ab3bc7371c386.pdf",
        "text": "https://archive.orkl.eu/80783d0f0c8b8e610235eac40f1ab3bc7371c386.txt",
        "img": "https://archive.orkl.eu/80783d0f0c8b8e610235eac40f1ab3bc7371c386.jpg"
    }
}