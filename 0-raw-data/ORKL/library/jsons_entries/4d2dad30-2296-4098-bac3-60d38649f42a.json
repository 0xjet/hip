{
    "id": "4d2dad30-2296-4098-bac3-60d38649f42a",
    "created_at": "2023-01-12T15:02:21.0509Z",
    "updated_at": "2025-03-27T02:05:53.054605Z",
    "deleted_at": null,
    "sha1_hash": "cde943e6990f8f3aa7c19ac52ac293d0d75f55dc",
    "title": "2022-03-29 - Verblecon- Sophisticated New Loader Used in Low-level Attacks",
    "authors": "",
    "file_creation_date": "2022-05-28T23:24:05Z",
    "file_modification_date": "2022-05-28T23:24:05Z",
    "file_size": 265276,
    "plain_text": "# Verblecon: Sophisticated New Loader Used in Low-level Attacks\n\n**symantec-enterprise-blogs.security.com/blogs/threat-intelligence/verblecon-sophisticated-malware-cryptocurrency-**\nmining-discord\n\nAn unknown attacker is using a complex and powerful new malware loader in relatively\nunsophisticated and low-reward attacks, indicating they may not realize the potential\ncapabilities of the malware they are deploying.\n\nThe malware, Trojan.Verblecon, is being used in attacks that appear to have installing\ncryptocurrency miners on infected machines as their end goal. There are some indications\nthe attacker may also be interested in stealing access tokens for chat app Discord. However,\nthe capabilities of this malware indicate that it could be highly dangerous if leveraged in\nransomware or espionage campaigns.\n\n[Verblecon was first spotted by analysts from Symantec, a division of Broadcom Software, in](https://software.broadcom.com/)\nJanuary 2022. This blog will detail the capabilities of the malware.\n\n## Technical breakdown\n\nThe malware is loaded as a server-side polymorphic JAR file. The fact that the file is\npolymorphic means that, due to encryption and obfuscation, the code of the malware\npayload looks different each time it is downloaded. Attackers generally pack malware in this\nway in an effort to evade detection by security software.\n\n\n-----\n\nThe malware samples analyzed by Symantec were fully obfuscated, in the code flow, strings,\n[and symbols. The samples themselves may be based on publicly available code.](https://github.com/zettabithf/LiteHTTP)\n\nOnce started, the malware checks its command-line arguments. It requires at least one\ncommand-line argument to execute, which could be the infection or campaign ID initially e.g.\n\n_\"CSIDL_SYSTEM_DRIVE\\program files\\java\\jre1.8.0_301\\bin\\javaw.exe\" -jar_\n_\"CSIDL_PROFILE\\appdata\\local\\temp\\rpvbh.jar\" masonkhonsari_\n\n_and_\n\n_\"CSIDL_SYSTEM_DRIVE\\program files\\java\\jre1.8.0_301\\bin\\javaw.exe\" -jar_\n_\"CSIDL_PROFILE\\appdata\\local\\temp\\rpvbh.jar\" 923ec15ffa4474ca7bf200bfb90e782d_\n\nAdditionally, it also attempts to determine if its own process is being debugged by checking\nfor the following Java command-line arguments:\n\n\"-xbootclasspath\"\n\"-xdebug\"\n\"-agentlib\"\n\"-javaagent:\"\n\"-xrun:\"\n\"-verbose\"\n\"-agentpath:\"\n\nNext, it attempts to detect if it is being opened in a virtual or sandbox environment, which\nwould indicate it is likely being opened on a security researcherâ€™s machine.\n\nFirst, it checks for the following directories:\n\n\"%ProgramFiles(X86)%\\VMware\\VMware Tools\"\n\"%ProgramFiles(X86)%\\Oracle\\VirtualBox Guest Additions\"\n\nIt also obtains the machine MAC address and attempts to check for the following prefixes,\nwhich may indicate the file is being opened on a virtual machine:\n\n\"00:05:69\"\n\"00:0C:29\"\n\"00:1C:14\"\n\"00:50:56\"\n\"08:00:27\"\n\"00:16:3E\"\n\"00:1C:42\"\n\"0A:00:27\"\n\n\n-----\n\nFollowing those checks, it executes the following command to obtain a list of running\nprocesses:\n\ntasklist.exe /fo csv /nh\n\nIt then appears to check these processes against a set list:\n\n\"vboxservice.exe\"\n\"vboxtray.exe\"\n\"xenservice.exe\"\n\"vmtoolsd.exe\"\n\"vmwaretray.exe\"\n\"vmwareuser.exe\"\n\"vgauthservice.exe\"\n\"vmacthlp.exe\"\n\"vmsrvc.exe\"\n\"vmusrvc.exe\"\n\"prl_cc.exe\"\n\"prl_tools.exe\"\n\"qemu-ga.exe\"\n\"vmcomputeagent.exe\"\n\"sandboxie\"\n\"vdagent\"\n\"vdservice\"\n\"fiddler\"\n\"joeboxserver.exe\"\n\"joeboxcontrol.exe\"\n\"blnsvr.exe\"\n\nIt then also checks for the following files:\n\n\"%Windows%\\system32\\windanr.exe\"\n\"%Windows%\\system32\\drivers\\VBoxMouse.sys\"\n\"%Windows%\\system32\\drivers\\VBoxGuest.sys\"\n\"%Windows%\\system32\\drivers\\VBoxSF.sys\"\n\"%Windows%\\system32\\drivers\\VBoxVideo.sys\"\n\"%Windows%\\system32\\vboxdisp.dll\"\n\"%Windows%\\system32\\vboxhook.dll\"\n\"%Windows%\\system32\\vboxmrxnp.dll\"\n\"%Windows%\\system32\\vboxogl.dll\"\n\"%Windows%\\system32\\vboxoglarrayspu.dll\"\n\"%Windows%\\system32\\vboxoglcrutil.dll\"\n\"%Windows%\\system32\\vboxoglerrorspu.dll\"\n\"%Windows%\\system32\\vboxoglfeedbackspu.dll\"\n\n\n-----\n\n%Windows%\\system32\\vboxoglpackspu.dll\n\"%Windows%\\system32\\vboxoglpassthroughspu.dll\"\n\"%Windows%\\system32\\vboxservice.exe\"\n\"%Windows%\\system32\\vboxtray.exe\"\n\"%Windows%\\system32\\VBoxControl.exe\"\n\"%Windows%\\system32\\Drivers\\Vmmouse.sys\"\n\"%Windows%\\system32\\Drivers\\vm3dgl.dll\"\n\"%Windows%\\system32\\Drivers\\vmdum.dll\"\n\"%Windows%\\system32\\Drivers\\vm3dver.dll\"\n\"%Windows%\\system32\\Drivers\\vmtray.dll\"\n\"%Windows%\\system32\\Drivers\\VMToolsHook.dll\"\n\"%Windows%\\system32\\Drivers\\vmmousever.dll\"\n\"%Windows%\\system32\\Drivers\\vmhgfs.dll\"\n\"%Windows%\\system32\\Drivers\\vmGuestLib.dll\"\n\"%Windows%\\system32\\Drivers\\VmGuestLibJava.dll\"\n\"%Windows%\\system32\\Driversvmhgfs.dll\"\n\"[java.lang.System.getProperty(\"user.home\")]\\Desktop\\moutonheart.wav\"\n\nNext, it appears to check the user name against the following:\n\njava.lang.System.getProperty(\"user.name\") == \"WDAGUtilityAccount\"\njava.lang.System.getProperty(\"user.name\").startsWith(\"hal-\")\n\nThen it executes the following command:\n\nreg query \"HKU\\S-1-5-19\"\n\nIt is unclear how the output is processed, however, there are some strings that could be\nrelated to this or other registry checks:\n\n\"HARDWARE\\ACPI\\DSDT\\\"\n\"HARDWARE\\ACPI\\FADT\\\"\n\"HARDWARE\\ACPI\\RSDT\\\"\n\"SOFTWARE\\Oracle\\\"\n\"SYSTEM\\ControlSet001\\Services\\\"\n\"SYSTEM\\ControlSet001\\Services\\\"\n\"SOFTWARE\\Microsoft\\Virtual Machine\\Guest\\\"\n\"SOFTWARE\\VMware, Inc.\\\"\n\"SOFTWARE\\\"\n\"VBOX__\"\n\"VBOX__\"\n\"VirtualBox Guest Additions\"\n\"VBoxGuest\"\n\"VBoxMouse\"\n\n\n-----\n\nVBoxService\n\"VBoxSF\"\n\"VBoxVideo\"\n\"Parameters\"\n\"VMware Tools\"\n\"Wine\"\n\nIf satisfied with these checks, it may copy itself as one of the following files:\n\n\"%ProgramData%[INFECTION_ID][INFECTION_ID].jar\"\n\"%ALL_USERS_HOME%[INFECTION_ID][INFECTION_ID].jar\"\n\"%LOCALAPPDATA%[INFECTION_ID][INFECTION_ID].jar\"\n\nAnd then create one of the following files to use as a loadpoint:\n\n\"%HOMEPATH%\\Library\\LaunchAgents[INFECTION_ID].plist\"\n\"%Windows%\\System32\\Tasks[INFECTION_ID]\"\n\n[INFECTION_ID] is computed as follows:\n\nhashlib.md5(b\"%PROCESSOR_IDENTIFIER%%COMPUTERNAME%\n\n[USER_NAME]\").hexdigest()\n\nThen it periodically attempts to connect to the following URLs:\n\n\"hxxps://gaymers[.]ax/\"\n\"hxxp://[DGA_NAME][.]tk/\"\n\n[DGA_NAME] is apparently generated using the following method:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-29 - Verblecon- Sophisticated New Loader Used in Low-level Attacks.pdf"
    ],
    "report_names": [
        "2022-03-29 - Verblecon- Sophisticated New Loader Used in Low-level Attacks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535741,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653780245,
    "ts_modification_date": 1653780245,
    "files": {
        "pdf": "https://archive.orkl.eu/cde943e6990f8f3aa7c19ac52ac293d0d75f55dc.pdf",
        "text": "https://archive.orkl.eu/cde943e6990f8f3aa7c19ac52ac293d0d75f55dc.txt",
        "img": "https://archive.orkl.eu/cde943e6990f8f3aa7c19ac52ac293d0d75f55dc.jpg"
    }
}