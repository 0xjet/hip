{
    "id": "dab6158f-8a93-434d-93f5-21114ed7ab72",
    "created_at": "2022-10-25T16:48:18.435391Z",
    "updated_at": "2025-03-27T02:09:29.85312Z",
    "deleted_at": null,
    "sha1_hash": "fbb158883a1e50c6c53c8c2989700551cdff7c63",
    "title": "Kerberos Golden Ticket Protection",
    "authors": "",
    "file_creation_date": "2016-04-26T15:28:17Z",
    "file_modification_date": "2016-04-26T15:28:17Z",
    "file_size": 1073958,
    "plain_text": "## CERT-EU Security Whitepaper 2014-007\n\n# Kerberos Golden Ticket Protection\n\n## Mitigating Pass-the-Ticket on Active Directory\n\n### Miguel SORIA-MACHADO, Didzis ABOLINS, Ciprian BOLDEA, Krzysztof SOCHA ver. 1.4 April 26, 2016\n\n TLP: white\n\n\n-----\n\n## 1 Introduction\n\nKerberos authentication protocol is the preferred authentication mechanism used by\nWindows in a domain-based environment, and interoperates with Kerberos implementations supported by other operating systems. While the pass-the-hash (PtH) technique\nis still used by Advanced Persistent Threats (APT), the equivalent technique misusing the\nKerberos protocol, known as pass-the-ticket (PtT), is increasing[1].\n\nThe Kerberos protocol, invented by MIT and used by multiple operating systems, relies\non a secret key in order to protect the authentication. If the server that stores the secret\nkey is hacked, it may be possible for a malicious actor to generate credentials to appear\nto be other users.\n\nA recent release of Mimikatz[2] provides a proof of concept of this pass-the-ticket attack\ncalled the golden ticket. Before the golden ticket is possible, the malicious actor must\nfirst hack the system with the secret key (Active Directory, the domain controller),\nthen hack to become a full system administrator on the same domain controller. The\nadversary uses this access to steal the secret key, effectively a golden-ticket that enables\nthe adversary to impersonate anybody in a Windows-domain based environment until\nthe Kerberos secret key is reset.\n\nThis white-paper provides the required steps to prevent and block attacks based on the\ngolden-ticket.\n\nThe tests mentioned in this document were done in a Windows 7 and Windows Server\n2008R2 environment. New security controls have been put in place in Windows 8.1\nand 2012R2 which mitigate the risks described in this paper. See [4] for further details.\nHowever, CERT-EU strongly recommends putting in place the controls described in this\npaper.\n\n## 2 The Golden Ticket\n\n### 2.1 What is a Golden Ticket\n\nMimikatz is a tool used by security researchers for pen-testing and studies purposes. It\nis publicly available and can potentially also be used with malicious intent.\n\nAfter an adversary hacks a system and then hacks to obtain full administrator privileges,\nthe tool can dump Windows credentials, like NT hashes and Kerberos tickets, from\nmemory and perform pass-the-hash and pass-the-ticket attacks. A recent release of\nMimikatz includes a new feature called golden ticket. If the adversary is able to hack to\ngain full administrator privileges on a Windows Domain Controller this feature allows\ncreating a special Kerberos TGT ticket which has the following properties[3]:\n\n1Refer to [1] for more details about credential theft attacks, like pass-the-hash or pass-the-ticket. You\ncan also find a short explanation in Annex A – Definitions and Annex B – Introduction to pass-the-ticket.\n[2January 2014, http://blog.gentilkiwi.com/securite/mimikatz/golden-ticket-kerberos (French)](http://blog.gentilkiwi.com/securite/mimikatz/golden-ticket-kerberos)\n3Refer to Annex B – Introduction to pass-the-ticket for a short explanation of this type of attack.\n\n1\n\n\n-----\n\n  - the golden ticket is a method to arbitrarily generate Kerberos TGT tickets for\n**any user of the target domain[4]. Therefore, it can be used to impersonate any-**\n**body, Domain Administrators accounts are the most interesting but potentially**\nany legitimate user can be impersonated;\n\n  - golden tickets can be created off-line. Therefore, one does not need to be connected to the domain once you have collected all the data required to create the\nticket (see next section);\n\n  - the golden ticket is valid for an arbitrary lifetime, Mimikatz default is 10 years\n**– or until a Domain Administrator resets the Kerberos key used to generate**\n**the TGT. This is the current setting implemented by Mimikatz but it should be**\npossible to create tickets of any lifetime at anytime (arbitrary start, renewal and\nend time is possible);\n\n  - Kerberos lifetime policy (default renewal lifetime 10h and total lifetime is 7\ndays) does not have any impact on the golden ticket. Indeed, KDC validates\nTGT tickets based on the lifetime settings embedded in the protected core of the\nticket and not on the policy set on the Domain Controller. Nevertheless, even if\nsuch control is in place, it cannot be used to block golden tickets. The attacker\ncan generate any ticket with the appropriate lifetime in line with the local policy\nand so bypass the control;\n\n  - once created, the golden ticket can be replayed with pass-the-ticket attack technique. This will allow the adversary accessing other resources available to the\nimpersonated user;\n\n  - as any pass-the-ticket, there is no need of privilege access to replay and use the\ngolden ticket;\n\n  - resetting the password of the impersonated account does not make the golden\n**ticket invalid;**\n\n  - resetting the Kerberos secret key does make all golden tickets invalid.\n\n  - Windows event logs does not distinguish the use of legitimate TGT ticket versus\na golden ticket, so there is no universal rule to detect the use of a golden ticket;\n\nFigure 1: Example of a golden ticket with life time until 2024\n\n### 2.2 Requirements for Golden Ticket\n\nThis is the list of items required to create the golden ticket:\n\n  - the NT hash of the domain KRBTGT account:\n\n4NT hash is derived from the password.\n\n2\n\n\n-----\n\nThis hash is the secret key used for Kerberos and is only hosted in the Active\nDirectory of the Domain Controller. Therefore, the adversary must have both\n**compromised the Domain Controller and elevated privilege to get full ad-**\n**ministrator privileges first. This can be achieved with lateral movements like**\ndescribed in Annex B – Introduction to pass-the- ticket. Example of a KRBTGT\nhash:\n```\n   KRBTGT:502:NO PASSWORD*********************:a54932c2b0560e12386a0214767fbd5c:::\n\n```\n  - the targeted domain account name, usually a domain admin;\n\n  - the domain name, this is trivial to obtain once the attacker has access to a host\nin the domain;\n\n  - the domain’s SID:\n\nThis can be obtained from a domain user SID or sysinternals’ psGetsid.exe.\n\n## 3 Countermeasures against the Golden Ticket\n\n### 3.1 Prevention by Protecting the DC and Sensitive Accounts\n\nThe main requirement to create a golden ticket is NT hash of the KRBTGT account which\nimplies having full administrator access to the Domain Controller. This may be achieved\nby stealing sensitive domain accounts and do lateral movements with pass-the-hash or\npass-the-tickets attacks as explained in Annex B – Introduction to pass-the-ticket.\n\nMicrosoft has released a white paper that provides the controls to put in place to protect your domain against credential-theft-based attacks. The proposed countermeasures may require a re-engineering of your Domain Controller and its management but\nwe strongly recommend implementing them. Indeed, pass-the-[credential] attacks are\nalways used in APTs and Domain Controller is one of their main targets.\n\nSee [1] Mitigating Pass-the-Hash (PtH) Attacks and Other Credential Theft Techniques\nfor the full list of controls.\n\n### 3.2 Containment by Resetting Twice the KRBTGT Account Pass- word\n\nAs mentioned earlier, resetting the password of the impersonated user does not block\nthe usage of the related golden ticket. However, resetting twice the built-in Key Distribution Service account (KRBTGT) password will make invalid any golden tickets created\nwith the previously stolen KRBTGT hash as well as all other Kerberos tickets.\n\n3\n\n\n-----\n\n**3.2.1** **Reasoning**\n\nThe following simplified steps describe the Kerberos protocol when requesting access\nto a resource:\n\n1. The requestor authenticates to the KDC. If the authentication is successful, the\nKDC creates the TGT ticket and encrypts the core of the TGT ticket with the NT\nhash of KRBTGT account before sending it back to the requestor. Note that this\nstep is optional if a valid TGT ticket is already in memory (SSO feature) of the\nrequestor host;\n2. The TGT ticket does not provide direct access to a resource. The requestor send\nfirst the TGT ticket to the KDC to request a Service Ticket for the specific resource\n(ex, remote host);\n3. The KDC decrypts the core of TGT ticket with its hash, if the KDC fails to decrypt\nwith the hash, it will try with the former hashes stored in the Active Directory\n(i.e. the password history feature);\n4. The KDC validates the content before creating and issuing the related Service\nTicket (ST) to the requestor; If this latter step succeed, the requestor will send\nthe ST to the resource to be accessed (ex, to the remote host of step 2);\n\nConsequently, changing the KRBTGT account password[5] will make the step-2 fail. In\naddition, as the KDC retries with former hashes, the golden ticket will be invalid only\nif the whole history of password is reset, 2 by default.\n\n**3.2.2** **Impact**\n\nChanging the KRBTGT account hash may have an impact on the availability of legitimate\nsession used by account in the target domain. The exact impact level will depend\non the criticality of the related users, services and application. If done as part of the\nrecovery from a domain controller administrator-level compromise, the impact should\nbe no different from other steps (such as resetting user and service accounts). Here are\nsome examples:\n\n  - End-users including smart-card users will be automatically requested to authenticate to receive a new valid ticket. This might create some load on the Domain\ncontroller;\n\n  - Services and applications that require manual startup with a password and use\nKerberos may stop working properly until next manual restart.\n\nConsequently, it is recommended to do a first assessment before resetting the KRBTGT\naccount password.\n\n**3.2.3** **How to Reset KRBTGT Account Password**\n\nThe following instructions depicts the way to reset the KRBTGT account password in a\nDomain Controller (Windows Server 2008):\n\n5NT hash is derived from the password.\n\n4\n\n\n-----\n\n1. Open Active Directory Users and Computers on you Domain Controller;\n2. Select Advanced Features in View menu;\n3. Select Users in the target domain and find the KRBTGT user account;\n4. Right-click the account, and then click “Reset password”;\n5. Uncheck all options and enter the new password twice;\n6. Redo step 4 and 5 to reset the password a second time.\n\nFigure 2: Reset password window\n\nAlternatively, it is possible to use KRBTGT Account Password Reset Scripts from Microsoft[6] to reset KRBTGT password across all writable domain controllers that minimizes\nthe hassle to do it by hand on each one, and possibly minimizing the availability impact.\nAlso, it allows to follow a step-by-step list and to validate results.\n\n### 3.3 Eradication by Recovering the Domain Controller\n\nAs the domain controller is accessed to extract the required NT hash of the KRBTGT\naccount, the usual procedure to recover from compromised Active Directory applies\nhere.\n\nCERT-EU recommends following your recovery procedure. We also recommend to read\nMicrosoft guideline [3] Chapter 3 - Recovering from Active Directory Attacks.\n\n[6https://blogs.microsoft.com/cybertrust/2015/02/11/krbtgt-account-password-reset-scripts-now-available-for-customer](https://blogs.microsoft.com/cybertrust/2015/02/11/krbtgt-account-password-reset-scripts-now-available-for-customers/)\n\n5\n\n\n-----\n\n### 3.4 Detection\n\n**3.4.1** **Security Events when Using a Valid Golden Ticket**\n\nAs any pass-the-ticket attack, the attacker replays the golden ticket in a standard Kerberos protocol. Therefore, there is no clear indication of such attack in Windows logs.\nStill there might be some anomalies if the golded ticket is not properly prepared. Such\nanomalies were observed in the Account Domain field in following events : Event ID:\n```\n4624 (Account Logon), Event ID: 4672 (Admin Logon), Event ID: 4634 (Account Lo\n```\ngoff).\n\nAccount Domain might be <3 eo.oe ~ ANSSI E>, a FQDN, blank, or other value, while\nin fact it should be short domain name. The string <3 eo.oe ~ ANSSI E> is hardcoded\nin the source code of the tool generating the ticket and can be modified. For instance\nin Mimikatz 2.0 alpha (x86) release Kiwi en C, in the file:\n```\n/mimikatz/modules/kerberos/kuhl_m_kerberos.c:589\n\n```\nwe can find:\n```\nRtlInitUnicodeString(&validationInfo.LogonDomainName, L\"<3 eo.oe ~ ANSSI E>\");\n\n```\nWhile such indicators may be looked for when investigating potential cases of golden\nticket use, they are not guranteed to be present. For example Kerberos tickets forged\nusing Mimikatz January 2016 update, no longer include a domain anomaly since the\nnetbios domain name is placed in the domain component of the Kerberos ticket [6].\n\n**3.4.2** **Detecting a Golden Ticket Based on Lifetime**\n\nThe method presented in [5] is looking for Ticket Granting Tickets (TGT) which have\na duration (lifetime) that is different from the value set per domain.\n\n**3.4.3** **Windows Security Event after Resetting KRBTGT Password**\n\nThe following Event ID: 4769 (A Kerberos service ticket was requested) is generated\non the Domain Control when using a golden ticket after the double reset of the KRBTGT\npassword. The status code 0x1f indicates a failed attempt with the following reason:\n```\n0x1F: Integrity check on decrypted field failed\n\n```\nUnfortunately, there is no additional information like the username linked to the TGT\nticket or the resource that was requested. Consequently, the monitoring of this event is\nvery limited and cannot be used efficiently to detect a potential use of a golden ticket.\n\nNevertheless, this type of error should be rare and might be worth to monitor and\ninvestigate.\n```\nEvent id: 4769 - A Kerberos service ticket was requested.\nAccount Information:\n - Account Name:\n - Account Domain:\n - Logon GUID: {00000000-0000-0000-0000-000000000000}\n\n```\n6\n\n\n-----\n\n```\nService Information:\n - Service Name:\n - Service ID: NULL SID\nNetwork Information:\n - Client Address: ::ffff:192.168.89.101\n - Client Port: 49278\nAdditional Information:\n - Ticket Options: 0x40810000\n - Ticket Encryption Type: 0xffffffff\n - Failure Code: 0x1f\n - Transited Services: Client address is the source IP address from where the ticket was used. In some\n\n```\ncircumstance, we have seen events with the same error code but without any IP address.\n\n## 4 Conclusion\n\nIf an adversary is able to compromise and gain full administrative privileges on a domain controller, then the adversary has a significant degree of control over the domain\nand can take many malicious actions. If this type of compromise is not properly contained then the golden ticket is a real threat and is a dangerous asset in APTs:\n\n  - The adversary can use the technique to impersonate anybody in the domain and\ngain access to sensitive resources;\n\n  - They also retain privilege access in the domain after a first eradicated wave of\nattack. Indeed, if during a first eradicated wave of attack, the adversary was able\nto get a copy of the Active Directory and this latter has not been properly reset\nas explained in this paper, this same entity can immediately get privileged access\nin a second wave of attack. Only a simple but successful spear-phishing attempt\nagainst one internal workstation would be enough to gain again full control in a\ndomain. There is no need of a privilege account on the local host to perform a\npass-the-ticket attack.\n\nWe recommend the following guideline to protect against this type of attack:\n\n  - Prevention by protecting the DC and sensitive accounts (section 3.1);\n\n  - Containment by resetting twice the KRBTGT account password (section 3.2);\n\n  - Potentially detect the attack by monitoring event 4769 with error code 0x1f (section 3.4.2). However, this event may lead to false-positives;\n\n## 5 Annex A – Definitions\n\n**Pass-the-hash : is a hacking technique that allows an attacker to authenticate to a**\nremote server/service by using the previously stolen underlying NTLM and/or\nLanMan hash of a user’s password, instead of requiring the associated plaintext\npassword as is normally the case.\n**Pass-the-ticket :** similar to Pass-the-hash but with Kerberos tickets instead of\nNTLM/LanMan hashes;\n\n7\n\n\n-----\n\n**Credentials : the identity and the related secret (authenticator) that can be used to**\nproof someone identity. Consequently, a type of credential is not limited to plaintext passwords but it can be a Windows NTLM hash or a Kerberos Ticket depending on the Windows Authentication protocol that is used. In some circumstances,\nWindows caches the credentials to provide the single-sign-on feature. This paper will focus on Kerberos ticket called Ticket-Granting-Tickets (TGT). See [1] for\nmore details about Windows Credential types (table 4) and caching.\n**TGT and ST tickets : Ticket-Granting-Tickets (TGT) and Service Tickets are part**\nof the Kerberos protocol, refer to section 3.2.1. for a short description of these\ntickets. For more details about Kerberos and related tickets see [2].\n**KDC : Key Distribution Center.**\n**Key Distribution Service account (KRBTGT) : this is a built-in account in the Do-**\nmain Controller used by the KDC. This account has a hash which is used to create\nKerberos tickets.\n\n## 6 Annex B – Introduction to Pass-the-Ticket\n\nThe golden ticket exploits the pass-the-ticket technique. We provide below a short\nintroduction to pass-the-ticket.\n\nPass-the-[Kerberos]-ticket is a similar attack than pass-the-hash attack. In both cases,\nthe attack is a 2-steps-based scenario:\n\n1. Capture the credential from memory of a compromised host, the Kerberos ticket\n(TGT or ST) in this case. This scenario requires 1.1. having control on a compromised host in the target network. This is usually obtained via spear phishing.\n1.2. having high privileges or sedebug privileges on the compromised host. A\nlocal privilege escalation vulnerability can be used for this if the compromised\nuser does not have such privileges yet. This privilege will allow the attack to access the memory (ie, LSAss process) and extract the credentials. The attacker can\nthen take any credential that is stored in memory. The most interesting ones are\nprivileged accounts of your domain like help-desk or domain admin account.\n2. Replay the ticket to access resources: Once the credential is stolen, the attacker\ncan use it to access another resource like another host or server (ex, Exchange\nemail accounts). This is called lateral movement. The advantage of this attack\nis that the attacker can capture a credential and use it latter on with specialized\ntools like Mimikatz.\n\nIt is important to note that those credentials, including domain admins one, are cached\nin memory of the workstation where they connected to or run commands, for instance\nwhen doing RDP or runas commands. Therefore if these privileged accounts are connected to an infected machine, their credentials are exposed. Usually, APTs will target\nother workstation where it can obtain higher and higher privilege accounts until they\nget the credential of a domain admin account. The final step of the attack will be to\naccess the Domain Controller and get a copy of the entire Active Directory.\n\nThe following picture presents the typical scenario of an APT with lateral movement:\n\n8\n\n\n-----\n\nFigure 3: Typical lateral movements in APTs\n\nYou can find more details about pass-the-hash(-ticket) and credential theft from memory in [1]. This document published by Microsoft provides as well counter-measures to\nprotect your environment against such attack scenarios.\n\n## 7 Annex C – References\n\n[1] [http://www.microsoft.com/en-us/download/details.aspx?id=36036](http://www.microsoft.com/en-us/download/details.aspx?id=36036) Mitigating\nPass-the-Hash (PtH) Attacks and Other Credential Theft, Version 1 and 2\n\n[2] [http://technet.microsoft.com/en-us/library/cc739058(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc739058(v=ws.10).aspx) Kerberos\nAuthentication Technical Reference\n\n[[3] http://technet.microsoft.com/en-us/library/bb727066.aspx#ECAA Chapter 3 - Re-](http://technet.microsoft.com/en-us/library/bb727066.aspx#ECAA)\ncovering from Active Directory Attacks\n\n[[4] http://technet.microsoft.com/en-us/library/dn408190.aspx Credential Protection](http://technet.microsoft.com/en-us/library/dn408190.aspx)\nand Management\n\n[[5] https://gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285](https://gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285)\n\n[[6] https://adsecurity.org/?p=1515#DetectingForgedKerberosTickets](https://adsecurity.org/?p=1515#DetectingForgedKerberosTickets)\n\n9\n\n\n-----\n\n## 8 Annex D - Additional Details\n\n### 8.1 How to Create a Golden Ticket\n\nThis is an example of how to create a golden ticket with Mimikatz for the account\n```\nmyadmin and save it in myadmin-golden.kiribi file. The attacker can then safe the file\n\n```\nand load it back in memory on any compromised host in the target domain whenever\nhe wants[7]:\n```\nmimikatz # kerberos::golden /admin:myadmin /domain:corp\n /sid:S-1-5-21-2976932740-3244455291-537790045 /KRBTGT:a54932c2b0560e12386a0214767fbd5c\n /ticket:myadmin-golden.kiribi\n\n```\nHere is the related profile of the just that was created. As you can see the lifetime is of\n10 years. Notice the renewal lifetime is longer than the actual lifetime of the ticket, this\nshould avoid the need to constantly renew the ticket and make it usable at any time\nbefore the end time:\n```\nmimikatz # kerberos::tgt\nKeberos TGT of current session :\n      Start/End/MaxRenew: 3/18/2014 11:26:45 PM ; 3/18/2024 11:26:45 PM ; 3/18/2034\n   11:26:45 PM\n      Service Name (02) : KRBTGT ; corp ; @ corp\n      Target Name (--) : @ corp\n      Client Name (01) : myadmin ; @ corp\n      Flags 40e00000 : pre_authent ; initial ; renewable ; forwardable ;\n      Session Key (17) : cb a6 e3 97 9a b3 d2 0e f6 6d cf 4f 72 95 ff 2f\n      Ticket (00 - 17) : [...]\n(NULL session key means allowtgtsessionkey is not set to 1)\n\n```\nThe following screen shot provides an example simulating the usage of the golden\nticket[8] 6 years after its creation. The picture does not show the load in memory, this\nwas done with the following command:\n```\nmimikatz # kerberos::tgt ticket:myadmin-golden.kiribi\n\n### 8.2 Additional Events Generated by a Golden Ticket\n\n```\nThe following section depicts the events that are recorded on the DC and target host\nwhile using a golden ticket. The test scenario was as follows:\n\n  - The golden ticket was created for myadmin user who is part of the domain admin\ngroup.\n\n  - The attacker used the ticket from a workstation called user-ws (192.168.89.101)\nto connect to a workstation call admin-ws (192.168.86.102).\n\n7The KRBTGT NTLM hash is not directly accessible on the AD but tools are available to extract the\n[required files and all hashes, like combining ntdsutil and NTDSXtract 1.0 (http://www.ntdsxtract.](http://www.ntdsxtract.com/)\n[com/).](http://www.ntdsxtract.com/)\n8We used Mimikatz to upload the golden ticket in memory. The ticket is then automatically used by\nthe Windows command (net use here) thanks to the single sign-on feature of Windows. Note also that\nprivilege was escalated in this example (NT SYSTEM), but a normal account would have been enough to\nload the ticket in memory.\n\n10\n\n\n-----\n\nFigure 4: Example of golden ticket usage\n\n11\n\n\n-----\n\n  - The domain name is corp\n\nThe command column shows the instructions run on user-ws that generated the event.\n\n**8.2.1** **Domain Controller Events**\n\nWe see on the Domain Controller that a Kerberos service ticket was requested to access the admin-ws host from the IP address of the user-ws machine (192.168.86.101\n– event-id 4769). However, there is no indication that this is a golden ticket, a legitimate use of myadmin account will create a similar entry in the security log.\n\nNotice that there is no event-id 4768 (Kerberos TGT request). This is in line with the\nfact that the golden ticket was created off-line.\n```\nCommand: net use \\\\admin-ws\nDate: 03/18/2020\nTime: 14:11:12\nEvent: 4769\nEvent Content:\n  - TargetUserName = myadmin@corp\n  - TargetDomainName = corp\n  - ServiceName = ADMIN-WS$\n  - ServiceSid = S-1-5-21-2976932740-3244455291-537790045-1107\n  - TicketOptions = 0x40810000\n  - TicketEncryptionType = 0x00000012\n  - IpAddress = ::ffff:192.168.89.101 IpPort = 49407\n  - Status = 0x00000000\n  - LogonGuid = {B757831E-D810-CDCC-C1C2-804BB3A2FB2C}\n  - TransmittedServices = \n```\n**8.2.2** **Target Host Events (admin-ws)**\n\nWe see two events related to accounts successfully logged on the target machine\n(event-id 4624). As on the DC, none of them indicate it is a golden ticket:\n```\nCommand: net use \\\\admin-ws\nDate: 03/18/2020\nTime: 14:11:12\nEvent: 4624\nEvent Content:\n  - SubjectUserSid = S-1-0-0 SubjectUserName = - SubjectDomainName = - SubjectLogonId =\n   0x0000000000000000\n  - TargetUserSid = S-1-5-21-2976932740-3244455291-537790045-500 TargetUserName = myadmin\n   TargetDomainName = corp\n  - TargetLogonId = 0x000000000051f916\n  - LogonType = 3 LogonProcessName = Kerberos AuthenticationPackageName = Kerberos\n  - WorkstationName =\n  - LogonGuid = {A0706C8D-9BC6-F4D5-1226-FA2A48BB58D9} TransmittedServices = - LmPackageName\n   = - KeyLength = 0 ProcessId = 0x0000000000000000 ProcessName =   - IpAddress = 192.168.89.101 IpPort = 49406\nCommand: net use \\\\admin-ws\nDate: 03/18/2020\nTime: 14:11:12\n\n```\n12\n\n\n-----\n\n```\nEvent: 4672\nEvent Content:\n  - SubjectUserSid = S-1-5-21-2976932740-3244455291-537790045-500 SubjectUserName = myadmin\n  - SubjectDomainName =\n  - SubjectLogonId = 0x000000000051f916\n  - PrivilegeList = SeSecurityPrivilege SeBackupPrivilege SeRestorePrivilege\n   SeTakeOwnershipPrivilege SeDebugPrivilege SeSystemEnvironmentPrivilege\n   SeLoadDriverPrivilege SeImpersonatePrivilege\nCommand: psexec \\\\admin-ws cmd\nDate: 03/18/2020\nTime: 14:11:39\nEvent: 4624\nEvent Content:\n  - SubjectUserSid = S-1-0-0 SubjectUserName = - SubjectDomainName = - SubjectLogonId =\n   0x0000000000000000\n  - TargetUserSid = S-1-5-21-2976932740-3244455291-537790045-500 TargetUserName = myadmin\n   TargetDomainName = corp\n  - TargetLogonId = 0x00000000005204ad\n  - LogonType = 3 LogonProcessName = Kerberos AuthenticationPackageName = Kerberos\n  - WorkstationName =\n  - LogonGuid = {B504E2E8-3007-1C03-F480-011559C08D34} TransmittedServices = - LmPackageName\n   = - KeyLength = 0 ProcessId = 0x0000000000000000 ProcessName =   - IpAddress = 192.168.89.101 IpPort = 49409\nCommand: psexec \\\\admin-ws cmd\nDate: 03/18/2020\nTime: 14:11:39\nEvent: 4672\nEvent Content:\n  - SubjectUserSid = S-1-5-21-2976932740-3244455291-537790045-500 SubjectUserName = myadmin\n   SubjectDomainName =\n  - SubjectLogonId = 0x00000000005204ad\n  - PrivilegeList = SeSecurityPrivilege SeBackupPrivilege SeRestorePrivilege\n   SeTakeOwnershipPrivilege SeDebugPrivilege SeSystemEnvironmentPrivilege\n   SeLoadDriverPrivilege SeImpersonatePrivilege\n\n```\n13\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://cert.europa.eu/static/WhitePapers/UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf"
    ],
    "report_names": [
        "UPDATED%20-%20CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1461684497,
    "ts_modification_date": 1461684497,
    "files": {
        "pdf": "https://archive.orkl.eu/fbb158883a1e50c6c53c8c2989700551cdff7c63.pdf",
        "text": "https://archive.orkl.eu/fbb158883a1e50c6c53c8c2989700551cdff7c63.txt",
        "img": "https://archive.orkl.eu/fbb158883a1e50c6c53c8c2989700551cdff7c63.jpg"
    }
}