{
    "id": "27238cfe-696c-43a4-985f-cc64efbadcd7",
    "created_at": "2022-10-25T16:48:17.832287Z",
    "updated_at": "2025-03-27T02:05:51.33007Z",
    "deleted_at": null,
    "sha1_hash": "320d643a7e17a109c0c76ecfb4346aba619d0f59",
    "title": "ÇëÊäÈëÎÄµµ±êÌâ",
    "authors": "",
    "file_creation_date": "2018-10-12T16:03:34Z",
    "file_modification_date": "2018-10-12T16:03:34Z",
    "file_size": 923316,
    "plain_text": "## NuggetPhantom Analysis Report\n\n**■ Doc. No.:** **■ Confidentiality:** CONFIDENTIAL\n\n**■ Issue:** 4.1 **■ Date** 2018-10-08\n\n**© 2018 NSFOCUS**\n\n\n-----\n\n**■ Copyright © 2018 NSFOCUS Technologies, Inc. All rights reserved.**\n\nUnless otherwise stated, NSFOCUS Technologies, Inc. holds the copyright for the content of this document,\nincluding but not limited to the layout, figures, photos, methods, and procedures, which are protected under the\nintellectual property and copyright laws. No part of this publication may be reproduced or quoted, in any form\nor by any means, without prior written permission of NSFOCUS Technologies, Inc.\n\n**■ Change History**\n\n**Date** **Issue** **Description** **Prepared/Modified**\n**By**\n\nInitial draft. Wang Zhongshi\n2018-09-10 1.0\n\nAdjusted the document structure. Wang Zhongshi\n2018-09-20 3.0\n\n\nModified the description of the cryptomining\n2018-10-08 4.1\nmodule and added IP addresses of the latest mining\npools.\n\n\nWang Zhongshi\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n### Contents\n\n###### 1 Overview ......................................................................................................................................... 1\n\n1.1 Executive Summary ......................................................................................................................................... 1\n\n1.2 Kill Chain ......................................................................................................................................................... 1\n\n1.3 Scope of Impact ................................................................................................................................................ 2\n\n1.4 Development of the Hacking Organization ...................................................................................................... 3\n\n###### 2 Sample Analysis ............................................................................................................................ 4\n\n2.1 High Level of Modularization .......................................................................................................................... 4\n\n2.2 Careful Deployment to Evade Detection .......................................................................................................... 4\n\n2.3 Flexible Configuration to Hide True Identity ................................................................................................... 7\n\n2.4 Sacrifice of Present Gains to Remain Unnoticed ........................................................................................... 10\n\n2.5 All Covet, All Lose ......................................................................................................................................... 12\n\n###### 3 Attacker Location ........................................................................................................................ 14\n\n 4 Conclusion .................................................................................................................................... 15\n\n A IoC Output................................................................................................................................... 16\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n### Overview\n# 1\n\n#### 1.1 Executive Summary\n\nIn a recent emergency response activity, NSFOCUS Threat Intelligence center (NTI)\ndiscovered a security event that featured NuggetPhantom, a modularized malware toolkit.\nAccording to our observation, the organization behind this event made its debut at the end of\n2016 in the blue screen of death (BSOD) event that targeted Tianyi Campus clients, and was\nagain involved in another security event that leveraged Tianyi Campus clients to mine\ncryptocurrency at the end of 2017.\n\nHaving captured and analyzed malware carriers frequently used by this organization, we\nbelieve that its malware toolkit has been highly modularized and so delivers high flexibility.\nThis toolkit not only features anti-antivirus techniques but also employs many concealment\napproaches, as demonstrated in its capability of defeating security devices that work based on\nbehavior detection and traffic analysis.\n\nAs for target selection, this organization, as a disciple of the principle of \"man is the measure\nof security\", took its first step by identifying less professional users according to the security\nof their devices. Then it attempted to attack these users by exploiting an N-day\nvulnerability with EternalBlue. Besides, to better hide itself and evade detection, the\norganization tried to lower the impact of malware on users at the expense of financial gains.\n\n#### 1.2 Kill Chain\n\nAfter finding that the operating system on a user's computer contains the EternalBlue\nvulnerability, the attacker exploits this vulnerability to send Eternal_Blue_Payload to the\nvictim computer. Next, this payload drops all modules, which subsequently access the\ndownload server to obtain their respective encrypted files and then dynamically decrypt them\nin memory before executing related malicious functions. Following is a flowchart of the entire\nattack process.\n\nC i ht © NSFOCUS 1 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\nObviously, this attack procedure is fully consistent with the classic kill chain:\n\n **Reconnaissance: Through scanning and open-source data, the attacker finds a large**\nnumber of computers on the Internet that still contain the EternalBlue vulnerability.\n\n **Weaponization: The attacker crafts payloads specific to these vulnerable computers.**\n\n **Delivery: The attacker loads the malware with all its modules to his/her own server.**\n\n **Exploitation: The attacker exploits the EternalBlue vulnerability to attack targets one by**\none by executing the downloader exploit payload.\n\n **Installation: The downloader exploit payload downloads malware and instructs it to**\ndeploy its own modules.\n\n **Command and Control: The malware communicates with the attacker's command and**\ncontrol (C&C) server to obtain instructions and cryptomining configurations.\n\n **Actions on Objective: The malware mines cryptocurrency and conducts distributed**\ndenial-of-service (DDoS) attacks.\n\n#### 1.3 Scope of Impact\n\nThe domain *.woeswm.com, which is associated with the IP address 60.132.11.86\n(98.126.200.58 after escaping) of the core C&C server used in this campaign, is found to have\ninitiated 18,933 domain resolution requests since June 20, 2018 to one DNS server under our\nobservation. From this number, we can infer that no less than 100,000 devices have been\ninfected around the world.\n\nC i ht © NSFOCUS 2 V4 1 (2018 10 08)\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n#### 1.4 Development of the Hacking Organization\n\nA look into sample behaviors and modules reused by the captured samples finds that the\nBSOD event of Tianyi Campus clients at the end of 2016, the event of Tianyi Campus clients\nplanted with a cryptomining program at the end of 2017, and this event all point to the same\norganization. The following table lists the development of this organization based on these\nthree events.\n\n**Time** End of 2016 End of 2017 Present\n\n**Compatibility** Poor Good Good\n\n**Degree of**            - Having modules loosely Fully modularized\n\ncoupled\n\n**Modularization**\n\n**Encryption Method**           - Custom encryption Standard encryption\nalgorithm algorithm\n\n**Malicious Function**            - Cryptomining and Cryptomining\ninvalid traffic generating and DDoS launching\n\n**Stealth Capability** Low Medium High\n\n**Attack Method** Planted into Tianyi Planted into Tianyi Exploitation of the\nCampus clients Campus clients EternalBlue\n\nvulnerability\n\n**Target Group** College students' PCs College students' PCs Neglected devices\n\nFor the success of its hacking activities, the organization began to test malware modules in\n2016. However, at the beta test stage, the compatibility issue of the rootkit driver, a key\ncomponent of the malware, caused a large number of computers running Windows 10 to be\nlocked up with BSOD, thus exposing its traces and leading to the failure of the planned\ncampaign.\n\nTo avoid detection, the organization lay low over a long period of time subsequently. In mid2017, it began to reengineer the driver to follow the then trend by attempting some smallscale cryptomining activities. At the end of 2017, the organization staged a comeback by\nplanting the malware again in vulnerable Tianyi Campus clients. This time, its activities went\nunnoticed thanks to the enhanced compatibility of the rootkit driver. However, due to design\nflaws in its malicious functional modules, the cryptomining program consumed a large\namount of computing resources, showing itself to users and ending up with failure.\n\nIn the wake of this event, the organization went into hibernation again until July 2018, when it\nbegan to turn back to cryptomining. This time, the organization made its activities more\ndifficult to detect by sacrificing two-thirds of gains from bot machines. In addition, based on a\ngood understanding of Chinese users' distrust of downloaded software, it chose to use an\nefficient and mature exploit EternalBlue to plant malware into large quantities of unpatched\ncomputers around the world. Its target also switched from college students who may have\nknowledge in the related field to neglected computing devices. Such a switch was obviously a\nresult of deep consideration. We believe that the organization, after constantly learning from\npast experience, has grown into a middle to high-end hacking organization, which is made up\nof different roles with properly assigned duties to achieve defined objectives according to the\nhacking trend.\n\nC i ht © NSFOCUS 3 V4 1 (2018 10 08)\n\n|Time|End of 2016|End of 2017|Present|\n|---|---|---|---|\n|Compatibility|Poor|Good|Good|\n|Degree of Modularization|-|Having modules loosely coupled|Fully modularized|\n|Encryption Method|-|Custom encryption algorithm|Standard encryption algorithm|\n|Malicious Function|-|Cryptomining and invalid traffic generating|Cryptomining and DDoS launching|\n|Stealth Capability|Low|Medium|High|\n|Attack Method|Planted into Tianyi Campus clients|Planted into Tianyi Campus clients|Exploitation of the EternalBlue vulnerability|\n|Target Group|College students' PCs|College students' PCs|Neglected devices|\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n### Sample Analysis\n# 2\n\n#### 2.1 High Level of Modularization\n\nThis malware toolkit has been highly modularized and so the tools can be flexibly configured.\nIn terms of functionality, the toolkit consists of three types of modules for deployment,\ndownload, and function implementation respectively.\n\nThe deployment module initializes malicious configurations and loads the rootkit driver for\nthe purpose of hiding the malware. The download module obtains, loads, and calls functional\nmodules from the C&C server to fulfill attacker-specified tasks.\n\nThanks to modularization, the toolkit delivers high flexibility for attack task deployment. In\nother words, the attacker can call different functional modules for different purposes. This\nmakes it rather difficult for us to have a holistic view of the attacker from a single attack\nevent.\n\nThe following sections analyze the three modules briefly to profile the attacker in the\ntechnical aspect.\n\n#### 2.2 Careful Deployment to Evade Detection\n\nThe first file planted in victim computers is the deployment module, which employs the\nfollowing techniques and methods to hide the malware's malicious behavior and static\nsignature, thereby evading analysis and detection:\n\n **Execution upon restart: Through MSI configuration, the sample can execute malicious**\nactivities only after users manually restart their computers. Such a design is for the\npurpose of bypassing behavior-based detection in sandbox environments.\n\n **Code protection: The sample uses VMProtect to protect service programs planted in**\nvictim computers to evade static analysis and antivirus software's detection on the one\nhand and to make manual sample analysis more difficult on the other hand.\n\nC i ht © NSFOCUS 4 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n **File name check: The sample checks its own file name to see whether it is the same as**\nthe hardcoded one as expected. If not, no malicious behavior will be performed. This can\nhelp evade analysis by some sandboxes.\n\n **Drop during execution: To evade static analysis, the sample dynamically decompresses**\nand drops files and at the same time employs the process hollowing technique to inject\ncode.\n\nC i ht © NSFOCUS 5 V4 1 (2018 10 08)\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n **Driver-level hiding: By loading a driver to hook IRP_MJ_CREATE and inject**\nservice.exe and regedit.exe, the sample hides service program files and registry keys,\nthus making it more difficult to detect and remove the malware and extract a sample.\n\nWe associated this rootkit driver with another rootkit driver, which was found in the\nBSOD event of Tianyi Campus clients at the end of 2016. Furthermore, the rootkit driver\nused in the cryptomining event of Tianyi Campus clients shared the same certificate and\nPDB file and so was deemed to be an update of the one used in 2016. On this ground, we\ninferred that the three events were launched by the same organization.\n\n **Vulnerability blocking: The sample, by using the IPSec function of netsch.exe, runs the**\nfollowing command lines to block ports 135, 139, and 445 to prevent other scanning\nsources from exploiting the same vulnerability to compromise devices and contend for\ncomputing resources:\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add policy name=qianye\n\nC i ht © NSFOCUS 6 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filterlist name=Filter1\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filter filterlist=Filter1\n\nsrcaddr=any dstaddr=Me dstport=445 protocol=TCP'\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filter filterlist=Filter1\n\nsrcaddr=any dstaddr=Me dstport=135 protocol=TCP\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filter filterlist=Filter1\n\nsrcaddr=any dstaddr=Me dstport=139 protocol=TCP\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filter filterlist=Filter1\n\nsrcaddr=any dstaddr=Me dstport=445 protocol=UDP\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filter filterlist=Filter1\n\nsrcaddr=any dstaddr=Me dstport=139 protocol=UDP\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filter filterlist=Filter1\n\nsrcaddr=any dstaddr=Me dstport=135 protocol=UDP\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add filteraction\n\nname=FilteraAtion1 action=block\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static add rule name=Rule1\n\npolicy=qianye filterlist=Filter1 filteraction=FilteraAtion1\n\n− \"C:\\WINDOWS\\system32\\netsh.exe\" ipsec static set policy name=qianye assign=y\n\nUnder protection of the preceding mechanisms, the deployment module injects\ninject_downloader.dll into a child process, which seems to be launched by service.exe and is\nactually not, and then drops and loads the download module in this child process.\n\n#### 2.3 Flexible Configuration to Hide True Identity\n\nThe download module obtains files and configurations of malware modules. The following\nfigure illustrates its communication logic.\n\nC i ht © NSFOCUS 7 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\nThis module not only keeps a traditional C&C address pool to prepare for the situation where\na server may fail but also uses a special hiding method to prevent users from blocking\ncommunication with C&C servers and defeat threat intelligence platforms that can associate\nIP addresses resolved from domain names with samples. This method is called \"address\nescaping\", whose working principle is quite simple:\n\nThe attacker first specifies a public server to query the domain name of a C&C server. After\nobtaining the network address X (60.132.11.86), the mechanism subtracts the magic value\n(0x305DA) from the hexadecimal representation of X before getting Y (98.126.200.58), the\nreal IP address of the C&C server. The download module communicates with Y to obtain\nmodules necessary for performing the task in question.\n\nC i ht © NSFOCUS 8 V4 1 (2018 10 08)\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\nIn this process, the IP address directly resolved from the domain name of the C&C server is\nnot actually used for communication. Therefore, infected computers cannot stop\ncommunicating with the C&C server by blocking this IP address. In addition, victims cannot\nblock access to the public DNS server for fear of affecting normal business. As a result,\nmalicious traffic is successfully exchanged between victim computers and the C&C server.\n\nThe sample compresses and encrypts the communication, which, after decryption, reads as\nfollows:\n```\n           888$30$20180618$6$CpuGad$http://Up.Vohjtk.Com/RetGad/CpuGad/2018\n           0618.6/MsGad.PNG|$http://Up.Vohjtk.Com/RetGad/CpuGad/20180618.6/\n           MsRun.PNG|$|http://98.126.36.26:443/BuyGad/CoreRA07.PNG?RAT2018R\n           A07?1?1?6?6#0#1#|http://Ae.Eqwauemt.Com/BuyGad/CoreRD09.PNG?RAT2\n           018RD09?1?1?6?6#1#0#|http://Up.Vohjtk.Com/BuyGad/CoreE011.PNG?CP\n           U2018E011?1?1?6?6#1#0#|$5633c2d7ee994d04$$3$0$1$1$1$223.39.186.1\n           23#7.255.184.172#157.129.241.108#157.129.236.128#157.129.219.175\n           #157.129.212.103#147.88.219.209#119.125.74.121#69.187.163.188#$2\n           018-01-01 00:00:06$\n\n```\nClearly, the sample uses this function to access a lot of URLs to download different\nmodules, which will be decompressed and dropped locally to perform various malicious\nfunctions. Which modules are to be dropped is totally up to the attacker. Their programs take\nthe form of executables or scripts. At the same time, the sample obtains some IP addresses and\nescapes them into real ones using the aforementioned address escaping method. Then the\nsample encrypts and stores these addresses in the registry and uses them as C&C servers of\nthe cryptomining module to obtain the latest configuration information of the latter.\n\nFollowing are real IP addresses obtained through address escaping:\n\n 5.34.183.123\n\n 45.249.181.172\n\n 195.123.238.108\n\n 195.123.233.128\n\n 195.123.216.175\n\n 195.123.209.103\n\n 185.82.216.209\n\nC i ht © NSFOCUS 9 V4 1 (2018 10 08)\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n 157.119.71.121\n\n 107.181.160.188\n\n 154.48.241.199\n\n 137.175.66.15\n\n#### 2.4 Sacrifice of Present Gains to Remain Unnoticed\n\nThe cryptomining module is decompressed and executed by inject_loader.dll. Unlike other\ncryptomining programs, this module employs some special tactics to enhance flexibility and\nsecrecy:\n\n **Dynamic configuration: The sample accesses C&C servers listed in the registry to**\nobtain configuration information of the cryptomining module in real time, including the\nalgorithm type, mining pool addresses, and online wallet user names. Users can hardly\nblock such cryptomining behavior by blacklisting known mining pool addresses.\n\n **Controlled resource usage: By setting cryptomining parameters, the attacker keeps the**\nCPU usage by the cryptomining module at a relatively low level (25%) to prevent users\nfrom detecting it because of a sudden drop of computer performance.\n\nAccording to our observation, C&C servers of the cryptomining module have issued the\nfollowing configuration information, where Wk is a fixed string of characters, which,\ntogether with the attacker-specified offset, constitutes an online wallet user name. The offset,\nif not configured, is 1000 by default.\n\n**Mining Pool Address** **Online Wallet User Name** **Password**\n\n98.126.80.90:15912 Wk+1000 X\n\nC i ht © NSFOCUS 10 V4 1 (2018 10 08)\n\n|Mining Pool Address|Online Wallet User Name|Password|\n|---|---|---|\n|98.126.80.90:15912|Wk+1000|X|\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n**Mining Pool Address** **Online Wallet User Name** **Password**\n\n98.126.80.91:15912 Wk+1000 X\n\n98.126.1.26:15912 Wk+1000 X\n\n98.126.1.27:15917 Wk+1000 X\n\n154.48.241.199:15912 Wk+1000 X\n\nThe IP addresses listed in the table are all verified to be mining pools set up by the attacker by\nusing a leased virtual private server (VPS). These mining pool nodes are not configured with\ngains query interfaces that are common with public mining pools. Therefore, the attacker\nneeds to log in to the server to query current gains by remote means such as remote desktop\nconnection (available on port 55588).\n\nThis ensures that other users cannot get more information about the attacker, such as his/her\ntotal gains, Monero wallet addresses, and the number of miners, through mining pool\naddresses, user names, and passwords disclosed in network traffic.\n\nHowever, as the major functionality of the cryptomining module was reengineered from that\nof XMRIG, the traffic generated is also in plaintext so that users can detect related sessions\nand generate alerts on and block each new mining pool address.\n\nC i ht © NSFOCUS 11 V4 1 (2018 10 08)\n\n|Mining Pool Address|Online Wallet User Name|Password|\n|---|---|---|\n|98.126.80.91:15912|Wk+1000|X|\n|98.126.1.26:15912|Wk+1000|X|\n|98.126.1.27:15917|Wk+1000|X|\n|154.48.241.199:15912|Wk+1000|X|\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\nThe cryptomining module's deployment process and coupling with the download module\nindicate that it plays a lead role in this attack. At this stage, the attacker mainly aims to\npersistently use victims' computing resources to mine cryptocurrency for personal gains.\n\n#### 2.5 All Covet, All Lose\n\nBesides the cryptomining module that stars in this attack, we find an additional module for\nlaunching DDoS attacks. This module is also decompressed and executed locally by\ninject_loader.dll. It accesses the attacker-specified C&C server to download an independently\nrunning EXE file to perform the assumed function.\n\nDifferent from the cryptomining module that is tightly coupled with the download module\nthrough C&C configuration, the DDoS module has its configuration information directly\nhardcoded into a binary file so as to be executed independently of other modules without\nneeding any injection. For this reason, we determine that this module plays a secondary role\nin this attack. Such a design results from the attacker's desire to maximize the value of bots by\nusing their computing resources to mine cryptocurrency on the one hand and using their\nbandwidth resources to conduct DDoS attacks for additional gains on the other hand.\n\nUnluckily, this module is not protected with any technique. Even worse, real IP addresses of\nits C&C servers are not masked by means of address escaping, but hardcoded into a binary\nfile. In fact, it was due to this module that we were able to track down the attacker and make\nbreakthroughs in our analysis.\n\nObserving the communication process, we found that this module used the same compression\nand encryption algorithms and keys as other modules. Obviously, they were written by the\nsame author. Considering the difference between this module and other modules described in\npreceding sections in security and its hardcoded information, we concluded that it was a beta\ntest version that implemented malicious functions without any protection mechanism.\n\nC i ht © NSFOCUS 12 V4 1 (2018 10 08)\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\nThis module can initiate the following types of DDoS attacks:\n\nC i ht © NSFOCUS 13 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n### Attacker Location\n# 3\n\nAccording to NTI, the IP address of the major C&C server used in these attacks is located in\nthe USA.\n\nThe result returned by NTI in response to our search reveals that names appearing on web\npages hosted at this IP address comply with the Chinese naming convention (scanning result\nof July 16, 2018, the same date when the malicious sample was released). Therefore, a\nconclusion can be drawn that this organization has long targeted victims in China.\n\n(In the preceding figure, the parts masked indicate other hacking activities that the attacker\nengaged in. Those who are interested in such information can go to nti.nsfocus.com to check\nit out.)\n\nC i ht © NSFOCUS 14 V4 1 (2018 10 08)\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n### Conclusion\n# 4\n\nFrom the preceding analysis, we can draw the following conclusions:\n\n **Vulnerability: The EternalBlue vulnerability, as a critical one disclosed in early 2017,**\nhas been exploited by very efficient toolkits and has attracted a wide range of scanning\nsources. Up to now, hackers' zeal for it has not abated as there are still a large number of\nunpatched Windows devices worldwide.\n\n **Tools: Programs and tools used for malicious purposes are undergoing a major change in**\ntheir structure. Traditionally, all necessary functions are built into a package and used as\na whole. Now, they have functions modularized for higher flexibility. For one campaign,\nan attacker needs only to plant a controlled loader program that seldom carries out\nmalicious activities but requests necessary modules in real time. Functional modules can\nbe loaded or uninstalled depending on the information collection progress, the purpose of\nthe task, and the trend of the hacking industry. Security devices analyze attacks only after\nthey actually happen. Such a reactive process makes it difficult to get a whole picture of\nevents no matter how extensive and intensive the analysis is.\n\n **Industry: Cryptomining is usually considered a hacking industry that has a low entry**\nbarrier and does not require a high skill set. Therefore, antagonistic techniques seem to\nbe lacking in related malware. However, the case in question reveals that hacking\norganizations lured by the lucrative business are generous with their spending on all sorts\nof technical means against security products. This partly explains why the cryptomining\ndetection rate is dropping currently. A lower detection rate does not mean that fewer such\nevents have happened, but they are increasingly difficult to detect and perceive.\n\n **Organization: Full-fledged hacking organizations active in China focus more on**\nconcealment and persistence of their malicious behavior. Their purpose has turned from\ntrying to control users' total resources to parasitizing users' computers without users'\nknowledge. For the purpose of persistence, they are even willing to sacrifice some gains.\n\nC i ht © NSFOCUS 15 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n### IoC Output\n# A\n\nNTI specifies the following format for the output of indicators of compromise (IoC):\n```\n            {\n              \"report_name\":\"NuggetPhantom\",\n              \"alias\":\"\",\n              \"brief\":\"An modularized RAT for XMRminer and DDoS\",\n              \"created_time\":\"2018-07-16\",\n              \"update_time\":\"2018-07-16,\n              \"keywords\":[\"RAT\",\"MINER\",\"DDoS\"],\n              \"tag\":\"NuggetPhantom\",\n              \"ref\":[\"\"],\n              \"info_extract\":\n                {\n                \"date\":\"\",\n                \"hash\":\n                  [\n                    {\"value\":\" 4209ae0cb569efab29ca9d2d7f4a211b\",\"filename\":\"\n            MsHIDPARSEApp.dll\",\"date\":\"2018-06-12\",\"relation\":{\"domain\":[\"\n            Vohjtk.Com\",\"Eqwauemt.Com\"],\"ip\":[\"98.126.200.58\",\"98.126.36.26\",\"5.34.\n            183.123\",\"45.249.181.172\",\"195.123.238.108\",\"195.123.216.175\",\"195.123.\n            209.103\",\"185.82.216.209\",\"157.119.71.121\",\"107.181.160.188\",\"154.48.24\n            1.199\",\"137.175.66.15\"],\"vul\":[\"CVE-2017-0143\",\"CVE-2017-0144\",\"CVE            2017-0145\",\"CVE-2017-0146\",\"CVE-2017-0147\",\"CVE-2017            0148\"],\"email\":[\"\"],\"date\":\"\"}},\n                  ],\n                \"domain\":\n                  [\n                    {\"value\":\"Eqwauemt.com\",\"type\":[\"Malware\"],\"date\":\"2018            06-12\",\"relation\":{\"ip\":[\"104.18.36.142\"],\"email\":[\"\"],\"date\":\"2018-06            12\"}},\n                    {\"value\":\"Vohjtk.com\",\"type\":[\"Malware\"],\"date\":\"2018-06            12\",\"relation\":{\"ip\":[\"104.27.165.31\"],\"email\":[\"\"],\"date\":\"2018-06            12\"}}\n                    ],\n                \"ip\":\n                  [\n                {\"value\":\"98.126.200.58\",\"type\":[\"C&C\",\"Malware\"],\"date\":\"2018            06-12\"},\n            {\"value\":\"98.126.36.26\",\"type\":[\"C&C\",\"Malware\",\"DDoS\",\"Botnets\"],\"date\n            \":\"2018-06-12\"},\n                    {\"value\":\"5.34.183.123\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"45.249.181.172\",\"type\":[\"C&C\"],\"date\":\"2018-06\n```\nC i ht © NSFOCUS 16 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n```\n            12\"},\n                    {\"value\":\"195.123.238.108\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"195.123.216.175\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"195.123.209.103\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"185.82.216.209\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"157.119.71.121\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"107.181.160.188\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"154.48.241.199\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"},\n                    {\"value\":\"137.175.66.15\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"}\n                    {\"value\":\"98.126.80.90\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"}\n                    {\"value\":\"98.126.80.91\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"}\n                    {\"value\":\"154.48.241.199\",\"type\":[\"C&C\"],\"date\":\"2018-06            12\"}\n                  ]\n                }\n            }\n\n```\nC i ht © NSFOCUS 17 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----\n\n**NuggetPhantom Analysis Report**\n\n### References\n# B\n\n https://nti.nsfocus.com/ip?query=98.126.200.58&type=all\n\nC i ht © NSFOCUS 1 V4 1 (2018 10 08)\n\n\n**NuggetPhantom Analysis Report**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://staging.nsfocusglobal.com/wp-content/uploads/2018/10/NuggetPhantom-Analysis-Report-V4.1.pdf"
    ],
    "report_names": [
        "NuggetPhantom-Analysis-Report-V4.1.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1539360214,
    "ts_modification_date": 1539360214,
    "files": {
        "pdf": "https://archive.orkl.eu/320d643a7e17a109c0c76ecfb4346aba619d0f59.pdf",
        "text": "https://archive.orkl.eu/320d643a7e17a109c0c76ecfb4346aba619d0f59.txt",
        "img": "https://archive.orkl.eu/320d643a7e17a109c0c76ecfb4346aba619d0f59.jpg"
    }
}