{
    "id": "141b5e5c-13de-453d-bd34-404b39c626b6",
    "created_at": "2022-10-25T16:48:23.039289Z",
    "updated_at": "2025-03-27T02:06:13.838537Z",
    "deleted_at": null,
    "sha1_hash": "891959666596264d8f2bd7b309e8321b67d86844",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-01-11T08:44:25Z",
    "file_modification_date": "2018-01-11T08:44:25Z",
    "file_size": 1335310,
    "plain_text": "(https://securingtomorrow.mcafee.com/)\n\n    \n\n# Malicious Document Targets Pyeongchang Olympics\n\n\n#### \n\n\n[By Ryan Sherstobito� (https://securingtomorrow.mcafee.com/author/ryan-sherstobito�/) and Jessica Saavedra-Morales](https://securingtomorrow.mcafee.com/author/ryan-sherstobitoff/)\n\n(https://securingtomorrow.mcafee.com/author/jessica-saavedra-morales/) on Jan 06, 2018\n(https://securingtomorrow.mcafee.com/2018/01/)\n\nMcAfee Advanced Threat Research analysts have discovered a campaign targeting organizations involved with the\n\nPyeongchang Olympics.\n\nAttached in an email was a malicious Microsoft Word document with the original �le name 농식품부, 평창 동계올림픽 대비 축산\n\n악취 방지대책 관련기관 회의 개최.doc (“Organized by Ministry of Agriculture and Forestry and Pyeongchang Winter Olympics”).\n\nThe primary target of the email was icehockey@pyeongchang2018.com, with several organizations in South Korea on the\n\nBCC line. The majority of these organizations had some association with the Olympics, either in providing infrastructure or\nin a supporting role. The attackers appear to be casting a wide net with this campaign.\n\nThe campaign to target Pyeongchang Olympics began December 22, 2017 with the most recent activity appearing\n\nDecember 28. The attackers originally embedded an implant into the malicious document as a hypertext application (HTA)\n�le, and then quickly moved to hide it in an image on a remote server and used obfuscated Visual Basic macros to launch\nthe decoder script. They also wrote custom PowerShell code to decode the hidden image and reveal the implant.\n\n### Analysis\n\nThe malicious document was submitted from South Korea to Virus Total on December 29 at 09:04, a day after the original\n\nemail was sent to the target list. The email was sent from the IP address 43.249.39.152, in Singapore, on December 28 at\n23:34. The attacker spoofed the message to appear to be from info@nctc.go.kr, which is the National Counter-Terrorism\nCenter (NCTC) in South Korea. The timing is interesting because the NCTC was in the process of conducting physical\n\nantiterror drills in the region in preparation for the Olympic Games. The spoofed source of this email suggests the\nmessage is legitimate and increases the chances that victims will treat it as such.\n\n\n-----\n\nSingapore. The message was sent from a Post�x email server and originated from the hostname ospf1 apac\nsg.stickyadstv.com. When the user opens the document, text in Korean tells the victim to enable content to allow the\ndocument to be opened in their version of Word.\n\nThe malicious document with instructions to enable content.\n\nThe enable content message.\n\nThe document contains an obfuscated Visual Basic macro:\n\n\n-----\n\nVisual Basic macro.\n\nThe malicious document launches a PowerShell script when the user clicks “Enable Content.” The document was created\n\non December 27 at 15:52 by the author “John.”\n\nThe malicious document launches the following PowerShell script:\n\nManually executing the PowerShell script at the command line.\n\nThe script downloads and reads an image �le from a remote location and carves out a hidden PowerShell implant script\n\nembedded within the image �le to execute.\n\nThe attackers used the open-source tool Invoke-PSImage, released December 20, to embed the PowerShell script into the\n\nimage �le. The steganography tool works by embedding the bytes of a script into the pixels of the image �le, giving the\n\nattacker the ability to hide malicious PowerShell code in a visible image on a remote server. The following script can be\n\n\n-----\n\nThe initial PowerShell script.\n\nThe image that contains the hidden PowerShell code.\n\nTo verify the usage of steganography, we employed the tool StegExpose to check the �le:\n\nThe result con�rms the presence of hidden data in our �le.\n\nOnce the script runs, it passes the decoded script from the image �le to the Windows command line in a variable $x, which\nuses cmd.exe to execute the obfuscated script and run it via PowerShell.\n\n&&set xmd=echo iex (ls env:tjdm).value ^| powershell -noni -noex -execut bypass -nopro�le -wind hidden   – &&\n\ncmd  /C%xmd%\n\nThe extracted script is heavily disguised, using a combination of string-format operator obfuscation and other string-based\n\nobfuscation techniques.\n\nThe obfuscated PowerShell implant script.\n\nThe attacker’s objective is to make analysis di�cult and to evade detection technologies that rely on pattern matching.\nBecause the obfuscation makes use of native functions in PowerShell, the script can run in an obfuscated state and work\n\n\n-----\n\nObfuscated control servers.\n\nWhen we deobfuscate the control server URLs, the implant establishes a connection to the following site over SSL:\n\nhxxps://www.thlsystems.for�rst.cz:443/components/com_tags/views/login/process.php.\n\nBased on our analysis, this implant establishes an encrypted channel to the attacker’s server, likely giving the attacker the\n\nability to execute commands on the victim’s machine and to install additional malware. Ultimately this PowerShell implant\n\nwill be set to automatically start daily at 2 am via a scheduled task (shown below). The view.hta contains the same\n\nPowerShell-based implant and establishes a remote connection over SSL to\nhxxps://200.122.181.63:443/components/com_tags/views/news.php.\n\nC:\\Windows\\system32\\schtasks.exe” /Create /F /SC DAILY /ST 14:00 /TN “MS Remoute Update” /TR\n\nC:\\Users\\Ops03\\AppData\\Local\\view.hta\n\nThe contents of view.hta.\n\nDuring our research, we discovered a cached Apache server log for the IP address 81.31.47.101, which is shared hosting.\n\nThis log contained information for the control server thlsystems.for�rst.cz, which showed an IP address from South Korea\nconnecting to the speci�c URL paths contained in the PowerShell implants. This indicates that the implant was active in\n\nSouth Korea and targets were likely being infected.\n\nApache server log from December 29, 2017.\n\nWhile investigating thlsystems.for�rst.cz we discovered that the webpage belongs to a legitimate entity, suggesting this is a\n\ncompromised server being used as both an encrypted backchannel for the attacker and the distribution of implants. The\n\nserver also hosts a copy of the obfuscated PowerShell implant.\n\n\n-----\n\nThe implant establishes an encrypted channel to the following URL path:\n\nhxxps://www.thlsystems.for�rst.cz:443/components/com_tags/views/admin/get.php\n\nAn image from December 30, 2017.\n\nWhen investigating the IP address from the PowerShell implant 200.122.181.63 we found a server in Costa Rica that\nresolves to mafra.go.kr.jeojang.ga. The domain jeojang.ga was registered via Freenom, a free anonymous domain\n\nprovider. It appears the attacker is using parts of a domain that belong to the South Korean Ministry of Agriculture and\nForestry, which is in line with the attached document name in the email, but this domain has nothing to do with this\ngovernment agency.\n\nA version of the malicious document from December 22 embedded the PowerShell implant directly into the Word\n\ndocument in the form of an HTA �le. McAfee Advanced Threat Research analysts discovered another document that was\nhosted at this domain; its original title is 위험 경보 (전국야생조류 분변 고병원성 AI(H5N6형) 검출).docx, which also appears to\ncome from the Ministry of Agriculture and Forestry. This document was created on December 22 by the same author,\n\n“John.” The document does not contain macros, rather OLE streams for the embedded HTA �les. When the Koreanlanguage docx icon is clicked, it launches the embedded HTA �le Error733.hta. This �le contains the same script code to\n\nlaunch the PowerShell implant as in the view.hta example.\n\n\n-----\n\nAn earlier malicious document that relies on OLE streams.\n\n### Conclusion\n\nThe basic method in this case, an in-memory implant using PowerShell along with obfuscation to avoid detection, is a\n\ncommon and increasing popular �leless technique used in cyberattacks. We have not previously seen this kind of attack\ntargeting victims in South Korea.\n\nThe use of the steganography tool shows how quickly the adversary has adapted to new tools. On December 20, the tool\n\nInvoke-PSImage was released to the public and within seven days was tested and deployed in a campaign targeting\norganizations involved in the 2018 Pyeongchang Olympics.\n\nWith the upcoming Olympics, we expect to see an increase in cyberattacks using Olympics-related themes. In similar past\ncases, the victims were targeted for their passwords and �nancial information. In this case the adversary is targeting the\n\norganizations involved in the Winter Olympics by using several techniques to make it more tempting to open the\nweaponized document:\n\nSpoofed email address from South Korea’s National Counter-Terrorism Council\nUse of Korean language\n\nAsking users to open the content because the document is in protected mode\nPartial use of the original South Korean Ministry of Agriculture and Forestry domain in a registered fake domain for\n\nmalicious intent\n\nThe Advanced Threat Research team has discovered an increase in the use of weaponized Word documents against South\nKorean targets in place of the traditional use of weaponized documents exploiting vulnerabilities in the Hangul word\nprocessor software.\n\n\n-----\n\nSHA-1\n\nc388b693d10e2b84af52ab2c29eb9328e47c3c16\n8ad0a56e3db1e2cd730031bdcae2dbba3f7aba9c\n\nIPs\n\n200.122.181.63\n\nDomains\n\nthlsystems.for�rst.cz\nmafra.go.kr.jeojang.ga\n\n Previous Article (https://securingtomorrow.mcafee.com/consumer/family-safety/2018-resolution-lose-weight-tech\nsafety-guilt/)\n\n[Next Article  (https://securingtomorrow.mcafee.com/consumer/mcafee-ces-solutions-partnerships/)](https://securingtomorrow.mcafee.com/consumer/mcafee-ces-solutions-partnerships/)\n\n[ Categories: McAfee Labs (https://securingtomorrow.mcafee.com/category/mcafee-labs/)](https://securingtomorrow.mcafee.com/category/mcafee-labs/)\n[ Tags:  cybersecurity (https://securingtomorrow.mcafee.com/tag/cybersecurity/), endpoint protection](https://securingtomorrow.mcafee.com/tag/cybersecurity/)\n(https://securingtomorrow.mcafee.com/tag/endpoint-protection/), malware\n\n(https://securingtomorrow.mcafee.com/tag/malware/)\n\n## Leave a reply\n\nFacebook Comments (0) Comments (0) G+ Comments\n\n\n**0 Comments** Sort by\n\nAdd a comment...\n\n[Facebook Comments Plugin](https://developers.facebook.com/products/social-plugins/comments/?utm_campaign=social_plugins&utm_medium=offsite_pages&utm_source=comments_plugin)\n\n## Newsletter Sign Up\n\nFirst Name\n\nLast name\n\n\n**Oldest**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.01.06.malicious-document-targets-pyeongchang-olympics/Malicious%20Document%20Targets%20Pyeongchang%20Olympics%20_%20McAfee%20Blogs.pdf"
    ],
    "report_names": [
        "Malicious Document Targets Pyeongchang Olympics _ McAfee Blogs"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041173,
    "ts_creation_date": 1515660265,
    "ts_modification_date": 1515660265,
    "files": {
        "pdf": "https://archive.orkl.eu/891959666596264d8f2bd7b309e8321b67d86844.pdf",
        "text": "https://archive.orkl.eu/891959666596264d8f2bd7b309e8321b67d86844.txt",
        "img": "https://archive.orkl.eu/891959666596264d8f2bd7b309e8321b67d86844.jpg"
    }
}