{
    "id": "778ac809-686a-4094-957a-aa9c82b47d17",
    "created_at": "2022-10-25T16:48:20.225136Z",
    "updated_at": "2025-03-27T02:10:13.087882Z",
    "deleted_at": null,
    "sha1_hash": "f516eade0319946e52c88ee6f44b01aa8e832fd2",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-03-24T14:01:33Z",
    "file_modification_date": "2020-03-24T14:01:33Z",
    "file_size": 2875312,
    "plain_text": "[About TrendLabs Security Intelligence Blog](https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/)\n\nSearch:\n\nGo to…\n\n[Home](http://blog.trendmicro.com/trendlabs-security-intelligence/)\nCategories\n\n[Home  »  Malware  »  Operation Poisoned News: Hong Kong Users Targeted With Mobile Malware via Local News Links](https://blog.trendmicro.com/trendlabs-security-intelligence/)\n\n# Operation Poisoned News: Hong Kong Users Targeted With Mobile Malware via Local News Links\n\n[Posted on:March 24, 2020 at 5:01 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2020/03/)\n[Posted in:Malware, Mobile](https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/)\nAuthor:\n[Trend Micro](https://blog.trendmicro.com/trendlabs-security-intelligence/author/trend-micro/)\n\n0\n\n**_By Elliot Cao, Joseph C. Chen, William Gamazo Sanchez, Lilang Wu, and Ecular Xu_**\n\nA recently discovered watering hole attack has been targeting iOS users in Hong Kong. The campaign uses links posted on multiple forums that supposedly\nlead to various news stories. While these links lead users to the actual news sites, they also use a hidden iframe to load and execute malicious code. The\nmalicious code contains exploits that target vulnerabilities present in iOS 12.1 and 12.2. Users that click on these links with at-risk devices will download a\nnew iOS malware variant, which we have called lightSpy (detected as IOS_LightSpy.A).\n\nThe malware variant is a modular backdoor that allows the threat actor to remotely execute shell command and manipulate files on the affected device. This\nwould an allow an attacker to spy on a user’s device, as well as take full control of it. It contains different modules for exfiltrating data from the infected\ndevice, which includes:\n\nConnected WiFi history\nContacts\nGPS location\nHardware information\niOS keychain\nPhone call history\nSafari and Chrome browser history\nSMS messages\n\nInformation about the user’s network environment is also exfiltrated from the target device:\n\nAvailable WiFi network\nLocal network IP addresses\n\nMessenger applications are also specifically targeted for data exfiltration. Among the apps specifically targeted are:\n\nTelegram\nQQ\nWeChat\n\nOur research also uncovered a similar campaign aimed at Android devices in 2019. Links to malicious .APK files were found on various public Hong Kongrelated Telegram channels. These messages claimed they were for various legitimate apps, but they led to malicious apps that could exfiltrate device\ninformation, contacts, and SMS messages. We called this Android malware family dmsSpy (variants of of dmsSpy are detected as AndroidOS_dmsSpy.A.).\n\nThe design and functionality of operation suggests that the campaign isn’t meant to target victims but aims to compromise as many mobile devices as\n\n\nGo to…\n\n\n-----\n\n**_Distribution: Poisoned News and Watering Holes_**\n\nOn February 19, we identified a watering hole attack targeting iOS users. The URLs used led to a malicious website created by the attacker, which in turn\ncontained three iframes that pointed to different sites. The only visible iframe leads to a legitimate news site, which makes people believe they are visiting the\nsaid site. One invisible iframe was used for website analytics; the other led to a site hosting the main script of the iOS exploits. The screenshot below shows\nthe code of these three iframes:\n\n_Figure 1. HTML code of malicious website, with three iframes_\n\nLinks to these malicious sites were posted on four different forums, all known to be popular with Hong Kong residents. These forums also provide their users\nwith an app, so that their readers can easily visit it on their mobile devices. Poisoned News posted its links in the general discussion sections of the said\nforums. The post would include the headline of a given news story, any accompanying images, and the (fake) link to the news site.\n\nThe articles were posted by newly registered accounts on the forums in question, which leads us to believe that these posts were not made by users resharing\nlinks that they thought were legitimate. The topics used as lures were either sex-related, clickbait-type headlines, or news related to the COVID-19 disease.\nWe do not believe that these topics were targeted at any users specifically; instead they targeted the users of the sites as a whole.\n\n_Figure 2. List of news topics posted by the campaign_\n\n_Figure 3 Forum post with the link to malicious site_\n\n\n-----\n\nthese links were distributed.\n\n_Figure 4. Copied news page with iframe with malicious exploit_\n\nThese attacks continued into March 20, with forum posts that supposedly linked to a schedule for protests in Hong Kong. The link would instead lead to the\nsame infection chain as in the earlier cases.\n\n_Figure 5. Link to malicious site claiming to be a schedule_\n\n**_Infection Chain_**\n\nThe exploit used in this attack affects iOS 12.1 and 12.2. It targets a variety of iPhone models, from the iPhone 6S up to the iPhone X, as seen in the code\nsnippet below:\n\n_Figure 6. Code checking for target devices_\n\nThe full exploit chain involves a silently patched Safari bug (which works on multiple recent iOS versions) and a customized kernel exploit. Once the Safari\nbrowser renders the exploit, it targets a bug (which Apple silently patched in newer iOS versions), leading to the exploitation of a known kernel vulnerability\nto gain root privileges. The kernel bug is connected to [CVE-2019-8605. The silently patched Safari bug does not have an associated CVE, although](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8605) other\nresearchers mentioned a history of failed patches related to this particular issue.\n\nOnce the device is compromised, the attacker installs an undocumented and sophisticated spyware for maintaining control over the device and exfiltrate\ninformation. The spyware used a modular design with multiple capabilities, including the following:\n\nModules update\nRemote command dispatch per module\nComplete shell command module\n\nMany of this spyware’s modules were designed explicitly for data exfiltration; for example, modules that steal information from Telegram and Wechat are\nboth included. The figure below shows the infection chain and the various modules it uses.\n\n\n-----\n\n_Figure 7. Diagram of lightSpy’s infection chain_\n\nWe chose to give this new threat the name lightSpy, from the name of the module manager, which is light. We also note that a decoded configuration file that\nthe launchctl module uses includes a URL that points to a /androidmm/light location, which suggests that an Android version of this threat exists as well.\n\nOne more note: The file payload.dylib is signed with the legitimate Apple developer certificate, and was only done so on November 29, 2019. This places a\ndefinite timestamp on the start of this campaign’s activity.\n\n**_Overview of Malicious Behavior of lightSpy_**\n\nThis section of the blog post provides a short overview of lightSpy and its associated payloads (space constraints limit the details we can provide). However,\nwe provided more technical details in the technical brief.\n\nWhen the kernel exploit is triggered, payload.dylib proceeds to download multiple modules, as seen in the code below:\n\n\n-----\n\n_Figure 8. Downloaded modules_\n\nSome of these modules are associated with startup and loading. For example, launchctl is a tool used to load or unload daemons/agents, and it does this\nusing ircbin.plist as an argument. This daemon, in turn, executes irc_loader, but (as the name implies) it is just a loader for the main malware module, light. It\ndoes, however, contain the hardcoded location of the C&C server.\n\nThe light module serves as the main control for the malware, and is capable of loading and updating the other modules. The remaining modules are designed\nto extract and exfiltrate different types of data, as seen in the following list:\n\ndylib – acquires and uploads basic information such as iPhone hardware information, contacts, text messages, and call history\nShellCommandaaa – executes shell commands on the affected device; any results are serialized and uploaded to a specified server\nKeyChain – steals and uploads information contained in the Apple KeyChain\nScreenaaa – scans for and pings devices on the same network subnet as the affected device; the ping’s results are uploaded to the attackers\nSoftInfoaaa – acquires the list of apps and processes on the device\nFileManage – performs file system operations on the device\nWifiList – acquires the saved Wi-Fi information (saved networks, history, etc.).\nbrowser – acquires the browser history from both Chrome and Safari.\nLocationaaa – gets the user’s location.\nios_wechat – acquires information related to WeChat, including: account information, contacts, groups, messages, and files.\nios_qq – similar to the ios_wechatmodule, but for QQ.\nios_telegram – similar to the previous two modules, but for Telegram.\n\nTaken together, this threat allows the threat actor to thoroughly compromise an affected device and acquire much of what a user would consider confidential\ninformation. Several chat apps popular in the Hong Kong market were particularly targeted here, suggesting that these were the threat actor’s goals.\n\n**_Overview of dmsSpy_**\n\nAs noted earlier in this blog post, there is an Android counterpart to lightSpy which we have called dmsSpy. These variants were distributed in public\nTelegram channels disguised as various apps in 2019. While the links were already invalid during our research, we were able to obtain a sample of one of the\nvariants.\n\nOur sample was advertised as a calendar app containing protest schedules in Hong Kong. It contains many features that we frequently see in malicious apps,\nsuch as requests for sensitive permissions, and the transmission of sensitive information to a C&C server. This includes seemingly safe information such as\nthe device model used, but includes more sensitive information such as contacts, text messages, the user’s location, and the names of stored files. dmsSpy also\nregisters a receiver for reading newly received SMS messages, as well as dialing USSD codes.\n\nWe were able to obtain more information about dmsSpy because the threat actors behind it erroneously left the debug mode of their web framework activated.\nThis allowed us a peek of the APIs used by the server. It suggest further capabilities we did not see in our sample, including screenshots and the ability to\ninstall APK files onto the device.\n\n\n-----\n\nWe believe that these attacks are related. dmsSpy s download and command-and-control servers used the same domain name (hkrevolution[.]club) as one of\nthe watering holes used by the iOS component of Poisoned News. (They did use differing subdomains, however). As a result, we believe that this particular\nAndroid threat is operated by the same group of threat actors, and is connected to, Poisoned News.\n\n**_Vendor statements_**\n\nWe reached out to the various vendors mentioned in this blog post. Tencent had this to say:\n\nThis report by Trend Micro is a great reminder of why it’s important to keep the operating system on computers and mobile devices up to date.\nThe vulnerabilities documented in the report, which affected the Safari web browser in iOS 12.1 and 12.2, were fixed in subsequent updates to\niOS.\n\nA very tiny percentage of our WeChat and QQ users were still running the older versions of iOS that contained the vulnerability. We have already\nissued a reminder to these users to update their devices to the latest version of iOS as soon as possible.\n\nTencent takes data security extremely seriously and will continue to strive to ensure that our products and services are built on robust, secure\nplatforms designed to keep user data safe.\n\nApple has also been notified of this research through Trend Micro’s Zero Day Initiative (ZDI). We also reached out to Telegram on our findings and have not\nreceived a response at the time of publication.\n\n**_Best practices and solutions_**\n\nSeveral steps could have been taken by users to mitigate against this threat. For iOS users, the most important would be to keep their iOS version updated.\nUpdates that would have resolved this problem have been available for more than a year, meaning that a user who had kept their device on the latest update\nwould have been safe from the vulnerability that this threat exploits.\n\nFor Android users, the samples we obtained were distributed via links in Telegram channels, outside of the Google Play store. We strongly recommend that\nusers avoid installing apps from outside trusted app stores, as apps distributed in this manner are frequently laden with malicious code.\n\nUsers can also install security solutions, such as the [Trend Micro™ Mobile Security for iOS and](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html) [Trend Micro™ Mobile Security for Android™ (also](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html)\navailable on [Google Play) solutions, that can block malicious apps. End users can also benefit from their multilayered security capabilities that secure the](https://play.google.com/store/apps/details?id=com.trendmicro.tmmspersonal)\ndevice owner’s data and privacy, and features that protect them from ransomware, fraudulent websites, and identity theft.\n\nFor organizations, the [Trend Micro™ Mobile Security for Enterprise suite provides device, compliance and application management, data protection, and](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\nconfiguration provisioning. The suite also protects devices from attacks that exploit vulnerabilities, prevents unauthorized access to apps and detects and\nblocks malware and fraudulent websites. [Trend Micro’s Mobile App Reputation Service (MARS) covers Android and iOS threats using leading sandbox](https://mars.trendmicro.com/)\nand [machine learning technologies to protect users against malware, zero-day and known exploits, privacy leaks, and application vulnerability.](https://www.trendmicro.com/vinfo/us/security/definition/machine-learning)\n\nIndicators of compromise and full technical details of this attack may be found in the accompanying [technical brief.](https://documents.trendmicro.com/assets/Tech-Brief-Operation-Poisoned-News-Hong-Kong-Users-Targeted-with-Mobile-Malware-via-Local-News-Links.pdf)\n\n## Related Posts:\n\n**[Anubis Android Malware Returns with Over 17,000 Samples](https://blog.trendmicro.com/trendlabs-security-intelligence/anubis-android-malware-returns-with-over-17000-samples/)**\n**[Malicious Optimizer and Utility Android Apps on Google Play Communicate with Trojans that Install Malware, Perform Mobile Ad Fraud](https://blog.trendmicro.com/trendlabs-security-intelligence/malicious-apps-on-google-play-communicate-with-trojans-install-malware-perform-mobile-ad-fraud/)**\n**[Dissecting Geost: Exposing the Anatomy of the Android Trojan Targeting Russian Banks](https://blog.trendmicro.com/trendlabs-security-intelligence/dissecting-geost-exposing-the-anatomy-of-the-android-trojan-targeting-russian-banks/)**\n**Fake Photo Beautification Apps on Google Play can Read SMS Verification Code to Trigger Wireless Application Protocol (WAP)/Carrier**\n**Billing**\n\n\nLearn how to protect Enterprises, Small Businesses, and Home Users from ransomware:\n\n[ENTERPRISE](http://www.trendmicro.com/us/security-intelligence/enterprise-ransomware/index.html) » [SMALL BUSINESS](http://www.trendmicro.com/us/security-intelligence/small-business-ransomware/index.html) » [HOME](http://www.trendmicro.com/us/home/consumer-ransomware/index.html) »\n\n\nTags: [androiddmsSpyiOSlightSpyOperation Poisoned News](https://blog.trendmicro.com/trendlabs-security-intelligence/tag/android/)\n\n\n-----\n\n Recommend\n\n\nt Tweet f Share **Sort by Best**\n\n\n### Start the discussion…\n\n\n**LOG IN WITH** **OR SIGN UP WITH DISQUS**\n\n\nName\n\n\nBe the first to comment.\n\n✉ **Subscribe** d **[Add Disqus to your siteAdd DisqusAdd](https://disqus.com/)**\n\n⚠ **D** **[N t S ll M D t](https://disqus.com/data-sharing-settings/)**\n\n## Security Predictions for 2020\n\nCybersecurity in 2020 will be viewed through many lenses — from differing attacker motivations and cybercriminal arsenal to technological\ndevelopments and global threat intelligence — only so defenders can keep up with the broad range of threats.\n[Read our security predictions for 2020.](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2020)\n\n## Business Process Compromise\n\nAttackers are starting to invest in long-term operations that target specific processes enterprises rely on. They scout for vulnerable practices, susceptible\nsystems and operational loopholes that they can leverage or abuse. To learn more, [read our Security 101: Business Process Compromise.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-business-process-compromise)\n\n## Recent Posts\n\n[Operation Poisoned News: Hong Kong Users Targeted With Mobile Malware via Local News Links](https://blog.trendmicro.com/trendlabs-security-intelligence/operation-poisoned-news-hong-kong-users-targeted-with-mobile-malware-via-local-news-links/)\n[OpenSMTPD Vulnerability (CVE-2020-8794) Can Lead to Root Privilege Escalation and Remote Code Execution](https://blog.trendmicro.com/trendlabs-security-intelligence/opensmtpd-vulnerability-cve-2020-8794-can-lead-to-root-privilege-escalation-and-remote-code-execution/)\n[Operation Overtrap Targets Japanese Online Banking Users Via Bottle Exploit Kit and Brand-New Cinobi Banking Trojan](https://blog.trendmicro.com/trendlabs-security-intelligence/operation-overtrap-targets-japanese-online-banking-users-via-bottle-exploit-kit-and-brand-new-cinobi-banking-trojan/)\n[March Patch Tuesday: LNK, Microsoft Word Vulnerabilities Get Fixes, SMBv3 Patch Follows](https://blog.trendmicro.com/trendlabs-security-intelligence/march-patch-tuesday-lnk-microsoft-word-vulnerabilities-get-fixes/)\n[Busting Ghostcat: An Analysis of the Apache Tomcat Vulnerability (CVE-2020-1938 and CNVD-2020-10487)](https://blog.trendmicro.com/trendlabs-security-intelligence/busting-ghostcat-an-analysis-of-the-apache-tomcat-vulnerability-cve-2020-1938-and-cnvd-2020-10487/)\n\n## Popular Posts\n\n[LokiBot Impersonates Popular Game Launcher and Drops Compiled C# Code File](https://blog.trendmicro.com/trendlabs-security-intelligence/lokibot-impersonates-popular-game-launcher-and-drops-compiled-c-code-file/)\n\n[Misconfigured Container Abused to Deliver Cryptocurrency-mining Malware](https://blog.trendmicro.com/trendlabs-security-intelligence/misconfigured-container-abused-to-deliver-cryptocurrency-mining-malware/)\n\n[Dissecting Geost: Exposing the Anatomy of the Android Trojan Targeting Russian Banks](https://blog.trendmicro.com/trendlabs-security-intelligence/dissecting-geost-exposing-the-anatomy-of-the-android-trojan-targeting-russian-banks/)\n\n[Outlaw Updates Kit to Kill Older Miner Versions, Targets More Systems](https://blog.trendmicro.com/trendlabs-security-intelligence/outlaw-updates-kit-to-kill-older-miner-versions-targets-more-systems/)\n\n[February Patch Tuesday: Fixes for Critical LNK, RDP, Trident Vulnerabilities](https://blog.trendmicro.com/trendlabs-security-intelligence/february-patch-tuesday-fixes-for-critical-lnk-rdp-trident-vulnerabilities/)\n\n## Stay Updated\n\nEmail Subscription\n\n\nYour email here\n\n\n[Home and Home Office](http://www.trendmicro.com/us/home/index.html)\n|\n[For Business](http://www.trendmicro.com/us/business/index.html)\n|\n[Security Intelligence](http://www.trendmicro.com/us/security-intelligence/index.html)\n|\n[About Trend Micro](http://www.trendmicro.com/us/about-us/index.html)\n\n\nYour email here\n\nSubscribe\n\n\n-----\n\nEurope, Middle East, & Africa Region (EMEA): [France, Deutschland / Österreich / Schweiz, Italia, Россия, España, United Kingdom / Ireland](http://www.trendmicro.fr/)\n\n[Privacy Statement](http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html)\n[Legal Policies](http://www.trendmicro.com/us/about-us/legal-policies/index.html)\n\nCopyright © 2020 Trend Micro Incorporated. All rights reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.03.24_Operation_Poisoned_News/Operation%20Poisoned%20News_%20Hong%20Kong%20Users%20Targeted%20With%20Mobile%20Malware%20via%20Local%20News%20Links%20-%20TrendLabs%20Security%20Intelligence%20Blog.pdf"
    ],
    "report_names": [
        "Operation Poisoned News_ Hong Kong Users Targeted With Mobile Malware via Local News Links - TrendLabs Security Intelligence Blog"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "741d58a1-0fc0-41a8-9681-106a06c07e61",
            "created_at": "2022-10-25T16:07:23.983046Z",
            "updated_at": "2025-03-27T02:02:10.062384Z",
            "deleted_at": null,
            "main_name": "Operation Poisoned News",
            "aliases": [
                "Operation Poisoned News",
                "TwoSail Junk"
            ],
            "source_name": "ETDA:Operation Poisoned News",
            "tools": [
                "dmsSpy",
                "lightSpy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3703894e-cf68-4c1e-a71a-e8fd2ef76747",
            "created_at": "2023-11-08T02:00:07.166789Z",
            "updated_at": "2025-03-27T02:00:03.205354Z",
            "deleted_at": null,
            "main_name": "TwoSail Junk",
            "aliases": [
                "Operation Poisoned News"
            ],
            "source_name": "MISPGALAXY:TwoSail Junk",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041413,
    "ts_creation_date": 1585058493,
    "ts_modification_date": 1585058493,
    "files": {
        "pdf": "https://archive.orkl.eu/f516eade0319946e52c88ee6f44b01aa8e832fd2.pdf",
        "text": "https://archive.orkl.eu/f516eade0319946e52c88ee6f44b01aa8e832fd2.txt",
        "img": "https://archive.orkl.eu/f516eade0319946e52c88ee6f44b01aa8e832fd2.jpg"
    }
}