{
    "id": "e8db9295-0d56-474a-bdc4-8877e39cbe82",
    "created_at": "2023-01-12T15:09:00.243391Z",
    "updated_at": "2025-03-27T02:16:26.351547Z",
    "deleted_at": null,
    "sha1_hash": "3504359c4acfdadb4716e0cd1795dae4807c5bdc",
    "title": "2022-04-01 - Complete dissection of an APK with a suspicious C2 Server",
    "authors": "",
    "file_creation_date": "2022-07-02T23:16:26Z",
    "file_modification_date": "2022-07-02T23:16:26Z",
    "file_size": 1789036,
    "plain_text": "# Complete dissection of an APK with a suspicious C2 Server\n\n**[lab52.io/blog/complete-dissection-of-an-apk-with-a-suspicious-c2-server/](https://lab52.io/blog/complete-dissection-of-an-apk-with-a-suspicious-c2-server/)**\n\n[During our analysis of the Penquin-related infrastructure we reported in our previous post,](https://lab52.io/blog/looking-for-penquins-in-the-wild/)\nwe paid special attention to the malicious binaries contacting these IP addresses, since as\nwe showed in the analysis, they had been used as C2 of other threats used by Turla.\n\nOne threat that makes contact with the 82.146.35[.]240 address in particular caught our\nattention, as it was the only one that contacts against that IP and it was an Spyware for\nAndroid devices.\n\nSo in this report, we want to share our analysis on the capabilities of this piece of malware,\nalthough the attribution to Turla does not seem possible given its threat capabilities.\n\n**Name: Process Manager**\n\n**Package: com.remote.app**\n\n**Hash: e0eacd72afe39de3b327a164f9c69a78c9c0f672d3ad202271772d816db4fad8 (sha-**\n256)\n\n**Size: 0.37 MB**\n\n**Target SDK: Android 14 – Android 21**\n\nOn the Android device, the application is displayed with a gear-shaped icon.\n\n\n-----\n\nWhen the application is run, a warning appears about the permissions granted to the\napplication. These include screen unlock attemps, lock the screen, set the device global\nproxy, set screen lock password expiration, set storage encryption and disable cameras.\n\n\n-----\n\nThe icon is then removed and the application runs in the background, showing in the\nnotification bar.\n\nAs mentioned in the previous section, the malware requests different permissions from the\nuser. However, the number of permissions requested by the application amounts to 18:\n\n**PERMISSIONS** **DESCRIPTION**\n\n**ACCESS_COARSE_LOCATION** Access to the phone location.\n\n**ACCESS_FINE_LOCATION** Access to the location based on GPS.\n\n\n-----\n\n**PERMISSIONS** **DESCRIPTION**\n\n**ACCESS_NETWORK_STATE** View the status of all networks.\n\n**ACCESS_WIFI_STATE** View WIFI information.\n\n**CAMERA** Take pictures and videos from the camera\n\n**FOREGROUND_SERVICE** Allows to put in foreground\n\n**INTERNET** Allows to create internet sockets\n\n**MODIFY_AUDIO_SETTINGS** Allows to modify audio settings\n\n**REAL_CALL_LOG** Allows to read a telephone call\n\n**READ_CONTACTS** Allows to read contacts information\n\n**READ_EXTERNAL_STORAGE** Allows to read external storage devices\n\n**WRITE_EXTERNAL_STORAGE** Allows to write to the Memory Card\n\n**READ_PHONE_STATE** Allows to read phone status and its id\n\n**READ_SMS** Allows to read SMS stored on the SIM card\n\n**RECEIVE_BOOT_COMPLETED** Allows to start the app when the device is turned on\n\n**RECORD_AUDIO** Access to the audio recorder\n\n**SEND_SMS** Allows to send sms\n\n**WAKE_LOG** Prevents the device from locking/hibernating\n\nIn addition, the manifest displays additional information about the application configuration.\n\n**_android:allowBackup=true: Allows the application data to be added to the backup._**\n**_android:exported=true: Can share info with other apps and be accessed by the_**\ndevice.\n**_android_secret_code: In the manifest is the secret code that can allow access to_**\nhidden content.\n\nAs you can see in the image, the com.remote.app package contains 21 classes.15 of them\nare named after the first letters of the alphabet and then there are the DeviceAdmin,\nMainActivity, MainService, MyReceiver, NotificationListener and ServiceReceiver classes\n(the R class is generated by the JADX software).\n\n\n-----\n\nThe MainService class is the main class and therefore it is the first one to be executed in the\napplication. This class has a main function OnCreate, it creates a notification channel called\n“Battery Level Service” where it will be executed.\n\nNext, the MainActiviy class is invoked, which using DeviceAdmin configures the device with\nadministration permissions.\n\n\n-----\n\nOnce the application is configured, each of the tasks that steal information from the device\nare executed. Classes a, b, f, g, i, j, k, l, m, n, o and NotificationListener implement functions\nthat steal information from the device and add it to a JSON.\n\nIn the Class a, the malware adds information about the installed packages to the JSON. For\neach of them it provides the package name, the application name, the version and its\nnumber.\n\nIn the Class b, the malware adds information about the calls made from the device to the\nJSON. For each call it shows the number, name (contact), duration, date and type. The type\nis a number corresponding to the following table:\n\n**NUMBER** **TYPE**\n\n1 Incoming\n\n2 Outgoing\n\n3 Missed\n\n4 Voice Message\n\n5 Refused\n\n6 Blacklist\n\n\n-----\n\nSimilarly, the Class f adds to the JSON information about the contact list. Indicating the\nnumber and name of each one.\n\nWe continue with the Class g that collects all the files in the device, saving in the JSON the\nname and the buffer of each one of them. In case a file cannot be accessed it also indicates\nit with “Access Denied”.\n\nIn addition, it also lists the directories, indicating the name and path.\n\n\n-----\n\nThis Class i implements functions related to a location listener (When the location is\nchanged, it is enabled or disabled), then adds in the JSON the location information with each\nchange: The altitude, latitude, longitude, precision and even the speed at which the device is\nmoving.\n\nThe Class j returns adds to the JSON the clipboard information each time the clipboard is\nupdated. To do so, it uses a listener that is configured in the MainService Class.\n\nThe Class k implements a timer that launches task l and deletes the generated temporary\nfile every x seconds. Afterwards, Class l records the audio from the device, extracts it in an\n.mp3 format in cacheDir and then adds a buffer of the file and the name to the JSON.\n\n\n-----\n\nThe Class m adds information about the permissions a user has on each package to the\nJSON. It goes through the entire list of packages on the device and checks what permissions\neach package is requesting.\n\nThe Class n adds to the JSON conversations of all contacts thanks to (content://mms_sms/conversations?simple=true) and of addresses of all contacts (content://mms-_\n_sms/canonical-addresses). It also has a function that sends a text message in case the_\ncontact is not found.\n\nThe Class o collects information from Wifis scanned by the device. For each of them it adds\nto the JSON its SSID and BSSID number.\n\n\n-----\n\nFinally, NotificationListener Class collects information about notifications. When a\nnotification is opened, it stores in the JSON the name of the app, the content and the time it\nhas been open.\n\nOnce all the information has been collected in JSON format, the application contacts the C2\n(82.146.35[.]240) and identifies the device by its model, version, id and manufacturer.\n\nLater, it will send the information it has stolen to the same server.\n\nTo launch each of the tasks the malware has its own commands that are defined in Class e\nand are launched (in their entirety) with Class d. In the following table you can see the\nrelationship of these commands with each task.\n\n**COMMAND** **FUNCTION** **RELATED CLASS**\n\n0xLO Location i\n\n0xCL Call List b\n\n0xMI Audio Recorder l\n\n0xFI File Information g\n\n0xSM SMS Information n\n\n0xPM/0xGP Package Permissions m\n\n\n-----\n\n**COMMAND** **FUNCTION** **RELATED CLASS**\n\n0xCO Contact List f\n\n0xIN Package Information a\n\n0xWI Wifi Information o\n\n0xNO Notifications NotificationListener\n\nFinally, among one of the communications made by the malware, we noticed that it tried to\ndownload an application called Rozdhan using a goo.gl shorter.\n\nThe application is on Google Play and is used to earn money, has a referral system that is\nabused by the malware. The attacker installs it on the device and makes a profit.\n\n**IOCs**\n\n82[.]146.35.240 C2\n\ne0eacd72afe39de3b327a164f9c69a78c9c0f672d3ad202271772d816db4fad8 SHA256\n\n51ab555404b7215af887df3146ead5e44603be9765d39c533c21b5737a88f176 SHA256\n\nhxxps://videos-share-rozdhan[.]firebaseio.com URL\n\n\n-----\n\n**IOCs**\n\nhxxp://ylink[.]cc/fqCV3 URL\n\nhxxp://d3hdbjtb1686tn.cloudfront[.]net/gpsdk.html URL\n\nhxxp://da.anythinktech[.]com URL\n\nakankdev2017@gmail[.]com EMAIL\nSRC\n\nCustomers with Lab52’s APT intelligence private feed service already have more tools and\nmeans of detection for this campaign.\n\nIn case of having threat hunting service or being client of S2Grupo CERT, this intelligence\nhas already been applied.\n\nIf you need more information about Lab52’s private APT intelligence feed service, you can\n[contact us through the following link](https://lab52.io/contact)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-01 - Complete dissection of an APK with a suspicious C2 Server.pdf"
    ],
    "report_names": [
        "2022-04-01 - Complete dissection of an APK with a suspicious C2 Server.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536140,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1656803786,
    "ts_modification_date": 1656803786,
    "files": {
        "pdf": "https://archive.orkl.eu/3504359c4acfdadb4716e0cd1795dae4807c5bdc.pdf",
        "text": "https://archive.orkl.eu/3504359c4acfdadb4716e0cd1795dae4807c5bdc.txt",
        "img": "https://archive.orkl.eu/3504359c4acfdadb4716e0cd1795dae4807c5bdc.jpg"
    }
}