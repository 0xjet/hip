{
    "id": "9469d6e1-0ff4-4a72-9d8a-3071b60dc1a4",
    "created_at": "2022-10-25T16:48:13.34517Z",
    "updated_at": "2025-03-27T02:09:29.623405Z",
    "deleted_at": null,
    "sha1_hash": "25acd571cd2683221a8b929e401f68154a0eede8",
    "title": "IsaacWiper Continues Trend of Wiper Attacks Against Ukraine",
    "authors": "",
    "file_creation_date": "2022-03-23T18:27:26Z",
    "file_modification_date": "2022-04-22T09:16:07Z",
    "file_size": 1234352,
    "plain_text": "### MALWARE/\n\n TOOLS\n\n PROFILE\n\n## By Insikt Group®\n\nMarch 24, 2022\n\n# IsaacWiper Continues  Trend of Wiper Attacks\n\n\n-----\n\n_This report is a technical overview of the IsaacWiper malware reported_ **Background**\n_by ESET on March 1, 2022. The malware was primarily delivered to Ukrainian_\n_organizations coincident with the Russian invasion of Ukraine. It is intended for_\n\nIn a [report released on March 1, 2022, ESET researchers](https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/)\n\n_those looking for a high-level overview of the malware’s tactics, techniques, and_\n_procedures (TTPs) and mitigations._ identified a new destructive malware that had been affecting\n\na Ukrainian government network since February 24, 2022. This\n\n#### Executive Summary malware, dubbed IsaacWiper, is distinct from the HermeticWiper\n\nmalware previously reported. ESET stated that they observed\n\nFollowing recent wiper attacks against Ukrainian\n\nIsaacWiper deployed at a Ukrainian organization that was not\n\norganizations involving the WhisperGate and HermeticWiper\n\npreviously affected by HermeticWiper, although they are still\n\nmalware, a new destructive wiper, IsaacWiper, was observed on\n\nassessing any links between IsaacWiper and HermeticWiper.\n\nFebruary 24, 2022. Although no direct attribution for IsaacWiper\n\nFurthermore, they are unable to attribute this malware to any\n\nor the other wiper malware found targeting Ukraine has been\n\nknown threat actors due to a lack of significant code similarities\n\nmade by researchers, the timing of these destructive attacks in\n\nwith known malware. One day after IsaacWiper was initially\n\nconjunction with tensions and kinetic conflict in Ukraine suggests\n\ndeployed, the threat actors deployed a second version that\n\nthey are Russian in origin.\n\nincluded debug log output, indicating that the malware was not\nworking as intended.\n\n#### Key Findings\n\n    - IsaacWiper is a destructive malware that overwrites all **Technical Analysis**\n\nphysical disks and logical volumes on a victim’s machine.\n\nIt is not known what method was used for initial access to the\n\n    - There is no code overlap between IsaacWiper, Ukrainian government network that IsaacWiper was discovered\n\nHermeticWiper, or WhisperGate. IsaacWiper achieves a on. ESET researchers suggested it is likely that a tool such as\nsimilar outcome by different means. Impacket was used for lateral movement within the network and\n\nthat RemCom RAT was deployed on several systems at the same\ntime as IsaacWiper.\n\n##### IsaacWiper\n\nIsaacWiper is a data destruction malware compiled with\nVisual Studio 2015 and written in a combination of C, C++, and\nassembly languages. ESET has [observed it being deployed as](https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/)\nboth an EXE and a DLL from the %programdata% or c:\\windows\\\n_System32 directories with at least 5 filenames: clean.exe, cl.exe,_\n_cl64.dll, cld.dll, and cll.dll. For DLL samples, the original filename_\nis Cleaner.dll. ESET noted that the earliest known PE compilation\ntimestamp for IsaacWiper is from October 19, 2021.\n\nRecorded Future analyzed a DLL sample of IsaacWiper with\ndebug log capabilities. An example of the debug log output from\na system with multiple physical and logical drives connected is\nprovided in FIgure 1 below.\n\n\n-----\n\n_Figure 1: Example contents of IsaacWiper’s log file (Source: Recorded Future)_\n\nThe DLL samples contain a single export function called\n_Start@4 that would typically be launched using a command\nsimilar to rundll32 <DLL_File>, #1. The wiper starts by creating\na log file for its debug messages at %programdata%\\log.txt. It\nthen enumerates all physical disks on the system by creating a\nhandle to \\\\PhysicalDrive<N>, where N starts at 0 and continues\nuntil an invalid handle is returned (indicating that the physical\ndrive does not exist). Next, it determines the operating system’s\nsystem directory by calling the GetWindowsDirectoryW API\nfunction. The drive letter for the system directory is extracted\nand then used to create a handle for \\\\.\\<DriveLetter>:. An input/\noutput control (IOCTL) call is then made to the drive’s handle\nfor [IOCTL_STORAGE_DEVICE_NUMBER via DeviceIoControl, as](https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-ioctl_storage_get_device_number)\nshown in Figure 2 below.\n\n_Figure 2: IOCTL call to retrieve a physical drive’s type and device num ber (Source: Recorded Future)_\n\n\nThis IOCTL call returns a [STORAGE_DEVICE_NUMBER](https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ns-winioctl-storage_device_number)\nstructure that provides the type, number, and partition number (if\napplicable) for a particular device. The device type is compared\nwith the constant FILE_DEVICE_DISK to ensure that it is a device\nthat contains partitions or can present itself as a disk before\nextracting the deviceNumber and storing it in a structure for\nlater use.\n\n[Afterwards, the wiper makes another IOCTL call (IOCTL_](https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-ioctl_disk_get_drive_geometry_ex)\n[DISK_GET_DRIVE_GEOMETRY_EX) to a handle for each physical](https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-ioctl_disk_get_drive_geometry_ex)\ndrive to retrieve the size of the disk. The disk’s size is stored in\na structure representing the disk, as shown in Figure 3 below.\n\nAfter enumerating the physical drives, the malware identifies\nthe victim’s logical drives with a call to GetLogicalDrives. For\neach logical drive, a handle is created for the file path pattern\n\\\\.\\<DriveLetter>:, and then an IOCTL call is made with a control\ncode of IOCTL_STORAGE_GET_DEVICE_NUMBER with each\nlogical drive’s handle.\n\nAfter identifying all physical and logical drives, the wiper\nerases each of them. All physical drives (other than the one\ncontaining the OS) are wiped in a separate thread. Each thread\n[makes an IOCTL call for control code FSCTL_LOCK_VOLUME to](https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-fsctl_lock_volume)\nensure the disk can only be used through a single handle. The\n[wiper then generates random data using the Mersenne Twister](https://www.sciencedirect.com/topics/computer-science/mersenne-twister)\npseudo-random number generator (PRNG) and subsequently\nwrites it to the physical drive in 64 KB (0x10000 bytes)\nincrements, as shown in Figure 4 below. This process continues\nuntil the WriteFile call fails, and then the volume is unlocked with\n[an IOCTL call for control code FSCTL_UNLOCK_VOLUME and the](https://docs.microsoft.com/en-us/windows/win32/api/winioctl/ni-winioctl-fsctl_unlock_volume)\nthread terminates.\n\n\n-----\n\n_Figure 4: Physical drive overwrite with random data generated by the Mersenne Twister PRNG (Source: Recorded Future)_\n\nIn our observations, the loop terminates with an error code\n5 (“Access is denied”) on the last call to WriteFile. Subsequent\nattempts to access the file systems contained on those disks\nresult in the user receiving a pop-up alert that it must be\nformatted, as shown in Figures 5 and 6.\n\n\n-----\n\n_Figure 5: Overwritten disk is unrecognized by Windows (Source: Recorded Future)_\n\n_Figure 6: Error message when attempting to access an overwritten disk (Source: Recorded Future)_\n\nThe wiper repeats this process for all the logical drives (with\nthe exception of the logical drive containing the OS). A thread is\ncreated for each logical drive and it calls the same erase function\nused to overwrite the physical drives.\n\nOnce the logical drives are overwritten, the wiper moves\non to the physical drive containing the OS. This process also\nleverages the same erasing function used in the previous 2 steps.\nThe first 64 KB random chunks are written over the physical drive\n16 times before the WriteFile API call fails with error code 5\n(“Access is denied”). The Master Boot Record (MBR) of a physical\ndrive is located in the first sector and is typically 512 KB, since\nthe wiper’s 16 overwrites start at the beginning of the disk and\nrepresent the first 1 MB of the physical drive they effectively\noverwrites the drive’s MBR.\n\n\nFinally, the wiper begins erasing the logical drive containing\nthe OS. The same disk erase function used on all the other\nphysical and logical drives is tried again; however, this time the\nIOCTL call for control code FSCTL_LOCK_VOLUME fails, and\nsubsequent writes to the drive’s file handle also result in an\n“Access is denied” error again. This is likely due to the physical\ndrive already being overwritten until access was denied in the\nprevious step.\n\nAfterwards, the wiper spawns a new thread to fill the\nremaining free space on the OS’s logical drive with random\ndata. It creates a hidden directory under the C drive in the\nfollowing format “Tmd<unique value>.tmp”, and also creates\na temporary filename in the hidden directory using a similar\nnaming convention (“Tmf<unique value>.tmp”). Random data\nis then repeatedly generated with the Mersenne Twister PRNG\nalgorithm and written to a temporary file until the disk runs out\nof space, as shown in Figure 7 below.\n\nWhile that thread to fill the logical disk is running, the wiper’s\nmain thread recursively iterates through all files on the system\nlogical drive. Each file is fully overwritten with random data in\n64 KB increments.\n\nUpon completion all drives and data on the system have been\noverwritten. When rebooting the system, a victim is presented\nwith an error message similar to the one shown in Figure 8.\n\n\n_Figure 7: Code to generate a temporary file used to fill the disk with random data (Source: Recorded Future)_\n\n\n-----\n\n_Figure 8: Failed boot attempt after IsaacWiper infection (Source: Re corded Future)_\n\n#### Mitigations\n\nAlthough there are no hard indicators of an IsaacWiper\ninfection In log data, indications of the deployment of IsaacWiper\nand other wipers have certain generic indicators that defenders\ncan monitor for.\n\nOn Windows systems, [alerts such as “Suspicious remote](https://msrc-blog.microsoft.com/2022/02/28/analysis-resources-cyber-threat-activity-ukraine/#updated-malware-details)\nactivity”, “Suspicious access to LSASS service”, and “Microsoft\nDefender Antivirus tampering” can provide early indications of an\nattack using TTPs similar to those used deploying HermeticWiper\nand IsaacWiper.\n\nMicrosoft also [suggests watching for phishing campaigns](https://msrc-blog.microsoft.com/2022/02/28/analysis-resources-cyber-threat-activity-ukraine/#updated-malware-details)\nusing Ukrainian-associated ruses. The following domains are\nexamples cited by Microsoft used in wiper attacks on Ukrainian\norganizations:\n\n  - help-for-ukraine[.]eu\n\n  - tokenukraine[.]com\n\n  - ukrainesolidarity[.]org\n\n  - ukraine-solidarity[.]com\n\n  - saveukraine[.]today\n\n  - supportukraine[.]today\n\nWiper programs in general seek to destroy data within the\ntarget system or against a targeted device. Potential targets can\nmitigate the impact of a successful wiper attack by instituting\nregular backup policies. These attacks can be further mitigated\nby creating a disaster recovery plan in order to make backup\ndata highly available and reduce downtime after an attack.\n\n\n#### Outlook\n\nBased on our analysis, IsaacWiper does not share code\nwith either of the previous wipers observed attacking Ukraine\n(WhisperGate and HermeticWiper); however, attack objectives\nand targeting methodologies associated with IsaacWiper are\nsimilar to those observed with WhisperGate and HermeticWiper.\nWhile there is currently no definitive attribution related to the\ncreators of IsaacWiper or the threat actors that have carried out\nattacks using IsaacWiper, this data further demonstrates that\nUkranian entities are at increased risk of targeting in wiperrelated attacks.\n\n\n-----\n\n#### Appendix A: YARA Rules\n\n```\nimport \"pe\"\nrule MAL_IsaacWiper {\n  meta:\n    author = \"CNANCE, Insikt Group, Recorded Future\"\n    date = \"2022-03-08\"\n    description = \"Detects IsaacWiper destructive malware\"\n    version = \"1.0\"\n    reference = \"https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targetingukraine/\"\n    hash = \"13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033\"\n    hash = \"7bcd4ec18fc4a56db30e0aaebd44e2988f98f7b5d8c14f6689f650b4f11e16c0\"\n    RF_MALWARE = \"IsaacWiper\"\n    RF_MALWARE_ID = \"lzQ5GL\"\n  strings:\n      /*\n        6d5473f8 6a 00      PUSH    0x0\n        6d5473fa 6a 00      PUSH    0x0\n        6d5473fc 6a 03      PUSH    0x3\n        6d5473fe 6a 00      PUSH    0x0\n        6d547400 6a 03      PUSH    0x3\n        6d547402 68 00 00    PUSH    0x80000000\n             00 80\n        6d547407 8d 45 cc    LEA    hCDrive=>str_\\\\\\\\.\\\\C:,[EBP + -0x34]\n        6d54740a 50       PUSH    hCDrive\n        6d54740b ff d7      CALL    EDI=>KERNEL32.DLL::CreateFileW\n        6d54740d 8b f0      MOV    ESI,hCDrive\n        6d54740f 83 fe ff    CMP    ESI,-0x1\n        6d547412 0f 84 c6    JZ     LAB_6d5474de\n             00 00 00\n        6d547418 6a 00      PUSH    0x0\n        6d54741a 8d 45 e4    LEA    hCDrive=>bytesReturned,[EBP + -0x1c]\n        6d54741d c7 45 e4    MOV    dword ptr [EBP + bytesReturned],0x0\n             00 00 00 00\n        6d547424 50       PUSH    hCDrive\n        6d547425 6a 0c      PUSH    12\n        6d547427 8d 45 ac    LEA    hCDrive=>storageDeviceNumber,[EBP + -0x54]\n        6d54742a 50       PUSH    hCDrive\n        6d54742b 6a 00      PUSH    0x0\n        6d54742d 6a 00      PUSH    0x0\n        6d54742f 68 80 10    PUSH    IOCTL_STORAGE_GET_DEVICE_NUMBER\n             2d 00\n        6d547434 56       PUSH    ESI\n        6d547435 ff 15 00    CALL    dword ptr [->KERNEL32.DLL::DeviceIoControl]   = 00034520\n             60 56 6d\n        6d54743b 83 f8 01    CMP    retVal,0x1\n\n```\n\n-----\n\n```\n        6d54743e 0f 94 c3    SETZ    BL\n        6d547441 75 0d      JNZ    LAB_6d547450\n        6d547443 33 c0      XOR    retVal,retVal\n        6d547445 83 7d ac 07   CMP    dword ptr [EBP + storageDeviceNumber.DeviceTyp\n        6d547449 0f 44 45 b0   CMOVZ   retVal,dword ptr [EBP + storageDeviceNumber.De\n        6d54744d 89 45 fc    MOV    dword ptr [EBP + deviceNumber],retVal\n\n```\n```\n                   LAB_6d547450                  XREF[1]:   6d547441(j)\n\n```\n```\n        6d547450 56       PUSH    ESI\n        6d547451 ff 15 10    CALL    dword ptr [->KERNEL32.DLL::CloseHandle]     = 00034566\n             60 56 6d\n        6d547457 84 db      TEST    BL,BL\n        6d547459 eb 02      JMP    LAB_6d54745d\n\n```\n```\n                   LAB_6d54745b                  XREF[1]:   6d54736c(j)\n\n```\n```\n        6d54745b 84 c9      TEST    diskStructParam,diskStructParam\n\n```\n```\n                   LAB_6d54745d                  XREF[1]:   6d547459(j)\n\n```\n```\n        6d54745d 0f 84 7b    JZ     LAB_6d5474de\n             00 00 00\n        6d547463 8b 5d fc    MOV    EBX,dword ptr [EBP + deviceNumber]\n        6d547466 8b d3      MOV    otherDiskStructParam,EBX\n        6d547468 8b 4d e0    MOV    diskStructParam,dword ptr [EBP + diskStructPar\n        6d54746b 6a 01      PUSH    0x1\n\n```\n\n6d54746d e8 de 9b    CALL    get_DiskGeometry                 undefined4\n\n```\nget_DiskGeometry(Disk\n             ff ff\n    */\n\n```\n```\n    $physical_drive_check = { 6a 00 6a 00 6a 03 6a 00 6a 03 68 00 00 00 80 8d ?? cc 50 ff d? 8b f0 83 fe\nff 0f 84 ?? ?? ?? ?? 6a 00 8d ?? e4 c7 4? ?? 00 00 00 00 50 6a 0c 8d ?? ac 50 6a 00 6a 00 68 80 10 2d 00 56\nff 15 ?? ?? ?? ?? 83 f8 01 0f 94 ?? 75 ?? 33 c0 83 7? ?? 07 0f 44 4? ?? 89 4? ?? 56 ff 15 ?? ?? ?? ?? 84 db\n\n```\n```\neb ?? 84 c9 0f 84 ?? ?? ?? ?? 8b 5? ?? 8b d3 8b 4? ?? 6a 01 e8 }\n  condition:\n\n```\nuint16(0) == 0x5a4d // PE file\n\nand filesize > 170KB\n```\n    and pe.imphash() == \"a4b162717c197e11b76a4d9bc58ea25d\"\n    and pe.exports(\"_start@4\")\n    and pe.imports(\"kernel32.dll\", \"DeviceIoControl\")\n    and $physical_drive_check\n}\n\n```\n\n-----\n\n#### Appendix B: IOCs\n\nIsaacWiper Sample (SHA256):\n\n```\n13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033\n0c61e11f4b056f9866f41c8d5b7f89f8892e44dbeaa0e03bd65a4cf81ce4dcb7\n\n```\n\n-----\n\nAbout Insikt Group[®]\n\nInsikt Group is Recorded Future’s threat research division, comprising analysts and\n\nsecurity researchers with deep government, law enforcement, military, and intelligence\n\nagency experience. Their mission is to produce intelligence on a range of cyber and\n\ngeopolitical threats that reduces risk for clients, enables tangible outcomes, and prevents\n\nbusiness disruption. Coverage areas include research on state-sponsored threat groups;\n\nfinancially-motivated threat actors on the darknet and criminal underground; newly\n\nemerging malware and attacker infrastructure; strategic geopolitics; and influence\n\noperations.\n\nAbout Recorded Future\n\nRecorded Future is the world’s largest intelligence company. The Recorded\n\nFuture Intelligence Platform provides the most complete coverage across adversaries,\n\ninfrastructure, and targets. By combining persistent and pervasive automated data\n\ncollection and analytics with human analysis, Recorded Future provides real-time visibility\n\ninto the vast digital landscape and empowers clients to take proactive action to disrupt\n\nadversaries and keep their people, systems, and infrastructure safe. Headquartered in\n\nBoston with offices and employees around the world, Recorded Future works with more\n\nthan 1,300 businesses and government organizations across 60 countries.\n\nLearn more at recordedfuture.com and follow us on Twitter at @RecordedFuture.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://go.recordedfuture.com/hubfs/reports/mtp-2022-0324.pdf"
    ],
    "report_names": [
        "mtp-2022-0324.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1648060046,
    "ts_modification_date": 1650618967,
    "files": {
        "pdf": "https://archive.orkl.eu/25acd571cd2683221a8b929e401f68154a0eede8.pdf",
        "text": "https://archive.orkl.eu/25acd571cd2683221a8b929e401f68154a0eede8.txt",
        "img": "https://archive.orkl.eu/25acd571cd2683221a8b929e401f68154a0eede8.jpg"
    }
}