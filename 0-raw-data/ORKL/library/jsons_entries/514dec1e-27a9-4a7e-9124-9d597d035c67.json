{
    "id": "514dec1e-27a9-4a7e-9124-9d597d035c67",
    "created_at": "2022-10-25T16:48:16.537232Z",
    "updated_at": "2025-03-27T02:05:29.793545Z",
    "deleted_at": null,
    "sha1_hash": "875abf02dad2a434d708e495ffc8afe4b2500aae",
    "title": "TR-12 - Analysis of a PlugX malware variant used for targeted attacks",
    "authors": "CIRCL",
    "file_creation_date": "2013-03-29T10:25:52Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 360736,
    "plain_text": "# Analysis Report (TLP:WHITE) Analysis of a PlugX variant (PlugX version 7.0)\n\n### Conducted by CIRCL - Computer Incident Response Center Luxembourg Team CIRCL\n\n March 29, 2013\n\nDocument version: 1.0\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n## Contents\n\n**1** **Scope of work** **3**\n\n**2** **Analyzed samples** **3**\n2.1 Limitations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n2.2 Sharing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n**3** **Executive summary** **6**\n\n**4** **Analysis** **6**\n4.1 Techniques used . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n4.2 Execution process . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n4.2.1 Diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n4.2.2 Explanation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n4.3 Implemented commands . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n4.4 Command details . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n4.4.1 Option . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n4.4.2 Disk . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n4.4.3 Screen . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n4.4.4 Process . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n4.4.5 Service . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n4.4.6 Shell . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n4.4.7 Telnet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.4.8 RegEdit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.4.9 Nethood . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.4.10 Portmap . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.4.11 SQL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.4.12 Netstat . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.4.13 Keylogger . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.5 Other notable commands and functions . . . . . . . . . . . . . . . . . . . . . . . 13\n4.5.1 log . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n4.6 Persistency . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n4.7 Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15\n4.8 Network and domain information . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\n4.8.1 Network . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16\n4.8.2 Domain . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n4.9 Current version and history of PlugX . . . . . . . . . . . . . . . . . . . . . . . . . 18\n\n**A Appendix** **18**\nA.1 Indicators of Compromise (IOC) . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\nA.1.1 Pipes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\nA.1.2 Files and directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\nA.1.3 Registry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\nA.1.4 Network (hostname and destination IP addresses) . . . . . . . . . . . . . 19\nA.2 References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\nA.3 VirusTotal results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n\nPage 2 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n## 1 Scope of work\n\nThis report is the analysis of a Remote Access Tool (RAT) which we call a variant of Plugx[1].\nPlugx is an interesting piece of malware for several reasons:\n\n  - It demonstrates the attack principle of the fastest/cheapest path of attack[2] by abusing\nperfectly valid signed binaries to perform the attack\n\n  - It features ways to defeat other protection mechanisms like UAC[3]\n\n  - In contrast to many other pieces of malware, the author[4] shows the ability to write good\ncode, especially doing logging the right way to improve the piece of software\n\n  - It appears to be modularized and easily extensible\n\n## 2 Analyzed samples\n\n  - Sample A - Stage 1 of Malware\n\n**– Description**\n\n      - Hash found in a malware database\n\n**– Original filename**\n\n      - update.exe\n\n**– Hashes**\n\n      - MD5: f1f48360f95e1b43e9fba0fec5a2afb8\n\n      - SHA1: 70ceb467db7b0161d22e4545479f747417b9705a\n\n      - SHA-256: 2bc5ce39dd9afe2157448d3f6d8cb9c549ed39543d159616e38480b9e6c11c49\n\n**– Filetype**\n\n      - PE32 executable (GUI) Intel 80386, for MS Windows, RAR self-extracting archive\n\n**– Filesize**\n\n      - 370702 Bytes (326KB)\n\n**– Compile time**\n\n      - Sat Jun 9 15:19:49 2012\n\n  - Sample B - Valid, signed McAfee binary\n\n**– Description**\n\n      - File dropped by Sample A\n\n**– Original filename**\n\n      - mcvsmap.exe\n\n**– Hashes**\n\n1Known variant names: Gulpix, Korplug\n[2http://satoss.uni.lu/seminars/srm/pdfs/2012-Alexandre-Dulaunoy.pdf](http://satoss.uni.lu/seminars/srm/pdfs/2012-Alexandre-Dulaunoy.pdf)\n[3http://msdn.microsoft.com/en-us/library/windows/desktop/bb756996.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb756996.aspx)\n4For better readability we do not distinguish between a single author or a group of authors. Hence the\nexpression is a synonym for ”the authors”\n\nPage 3 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n      - MD5: 4e1e0b8b0673937415599bf2f24c44ad\n\n      - SHA1: 9224de3af2a246011c6294f64f27206d165317ba\n\n      - SHA-256: ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096\n\n**– Filetype**\n\n      - PE32 executable (GUI) Intel 80386, for MS Windows\n\n**– Filesize**\n\n      - 262672 Bytes (257K)\n\n**– Compile time**\n\n      - Fri May 8 17:59:52 2009\n\n**– Authenticode[5]** verification\n\n1 Verified : Signed\n2 Signers :\n3 McAfee, Inc .\n4 VeriSign Class 3 Code Signing 2004 CA\n5 Class 3 Public Primary Certification Authority\n6 Signing date : 5:24 PM 5/8/2009\n7 Publisher : McAfee, Inc .\n8 Description : McAfee VirusMap Reporting module\n9 Product : McAfee VirusScan API\n10 Version : 13,11,0,0\n11 File version : 13,11,102,0\n12 Strong Name: Unsigned\n13 Original Name: McVsMap.EXE\n14 Internal Name: McVsMap\n15 Copyright : Copyright ￿2008 McAfee, Inc .\n16 Comments: n/a\n17 MD5: 4e1e0b8b0673937415599bf2f24c44ad\n18 SHA1: 9224de3af2a246011c6294f64f27206d165317ba\n19 SHA256: ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096\n\n  - Sample C - DLL to be loaded by Sample B, loads Sample D\n\n**– Description**\n\n      - File dropped by Sample A\n\n**– Original filename**\n\n      - McUtil.DLL\n\n**– Hashes**\n\n      - MD5: ad4a646b38a482cc07d5b09b4fffd3b3\n\n      - SHA1: ae0f9bf2740d00c5d485827eb32aca33feaa3a90\n\n      - SHA-256: 0a99238e1ebebc47d7a89b2ccddfae537479f7f77322b5d4941315d3f7e5ca48\n\n**– Filetype**\n\n      - PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n**– Filesize**\n\n      - 49152 Bytes (48K)\n\n[5http://msdn.microsoft.com/en-us/library/ms537359%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms537359%28v=vs.85%29.aspx)\n\nPage 4 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n**– Compile time**\n\n      - Wed Mar 13 02:52:28 2013\n\n  - Sample D - Malicious payload to be loaded by Sample C\n\n**– Description**\n\n      - File dropped by Sample A\n\n**– Original filename**\n\n     - McUtil.DLL.PPT\n\n**– Hashes**\n\n      - MD5: 545bb4365a9b7cdb6d22844ebeedda93\n\n      - SHA1: a267f1183b4ff843d68a63264846abf78cc71d1f\n\n      - SHA-256: d4fe890a08d4dd44b58a3b85b2a7e89536338099c1c42a9b7e85f4007b0a37b7\n\n**– Filetype**\n\n      - pure code (IA32) without headers\n\n**– Filesize**\n\n      - 124820 Bytes (122K)\n\n**– Compile time**\n\n      - unknown (pure code)\n\n  - Sample E - Stage 2 of Malware\n\n**– Description**\n\n      - Extracted malware from memory\n\n**– Original filename**\n\n      - dump00C60000.bin\n\n**– Hashes**\n\n      - MD5: 65ceb039e7b4731a165cfee081e220af\n\n      - SHA1: b49766187971e3070644a9de2054bc93241b2263\n\n      - SHA-256: deeac56026f3804968348c8afa5b7aba10900aeabee05751c0fcac2b88cff71e\n\n**– Filetype**\n\n      - PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n**– Filesize**\n\n      - 176128 Bytes (172K)\n\n**– Compile time**\n\n      - Mon Nov 26 04:46:01 2012\n\n - Sample F - UAC circumvention\n\n**– Description**\n\n       - File temporarily created on filesystem\n\n**– Original filename**\n\nPage 5 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n     - UAC.TMP\n\n**– Hashes**\n\n      - MD5: 52df5c2c07433e2a8f054c2347acb3b4\n\n      - SHA1: 8051474c1fc0d8f404a42ea32eca1699e54f02e1\n\n      - SHA-256: dc09091e5d0ce03c6144748f17bd636f2f0b2ca56f88b550c1d48860596dbdb1\n\n**– Filetype**\n\n      - PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n**– Filesize**\n\n      - 2560 Bytes (2.5K)\n\n**– Compile time**\n\n      - Thu Mar 29 08:03:43 2012\n\n### 2.1 Limitations\n\nThis work has been done with utmost care, following best practices in software reversing, forensic\ninvestigations and/or information gathering. However, the work is only covering small aspects\n(based on the indicators given, lacking full context) and not an exhaustive analysis, and hence\nthe report is as-is, not giving any guarantees of completeness or claiming absolute accuracy.\nThis work is provided for information only.\n\n### 2.2 Sharing\n\nThe document is classified as TLP:WHITE, CIRCL authorizes everyone to share this analysis\nreport as-is without modification.\n\n## 3 Executive summary\n\nThe analyzed malicious software is an exhaustive Remote Access Tool (RAT) that defeats several\nprotection methods of modern Windows operating systems, including execution of signed code\nand defeating UAC in Windows 7. It comes with a multitude of functionalities that are well\nimplemented.\n\n## 4 Analysis\n\n### 4.1 Techniques used\n\nThe analysis has been done using a mixed-approach of dynamic analysis and static analysis in\norder to overcome some of the obfuscation and encryptions used by the malware. Some of the\ntechniques might have also an impact on the interpretation of the malware. Unfortunately, when\nwe started this investigation, the IP address is no longer accepting connections on the given ports\nwhen tested on 2013-03-26. An interaction following the protocol of this malware is therefore no\nlonger possible.\n\nPage 6 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n### 4.2 Execution process\n\n**4.2.1** **Diagram**\n\n.\nSample A.\n\n.drops .drops .drops\n\n. .loads . .loads .\nSample B Sample C Sample D\n\n.into .into\n\n.execution\n\n.decryption\n\n.\nSample E\n\n.Windows 7 : defeat UAC\n\n.execution .inject\n\n.Legend\n\n.\n\n.kill .svchost.exe .inject . Sample F Signed\n\ncode\n\n. Neutral\n\n.execution code\n\n.\n\n.\nMalicious\n\n. code\nmsiexec.exe\n\n**4.2.2** **Explanation**\n\nSample A is a self-extracting archive which contains three files, Sample B, Sample C and Sample\nD. It is assumed that Sample A is a part of another attack vector, like PDF or Office document\nattacks where the user just opens a crafted document which exploits the document reader, drops\nand opens both a readable document and a malicious file like Sample A.\n\n1 Type = Rar\n2 Solid = −\n\nPage 7 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n3 Blocks = 3\n4 Multivolume = −\n5 Volumes = 1\n6\n7 Date Time Attr Size Compressed Name\n8 −−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−\n9 2009−05−14 00:56:12 . . . .A 262672 119784 mcvsmap. exe\n10 2013−03−13 09:52:28 . . . .A 49152 20285 McUtil .DLL\n11 2013−03−13 14:56:12 . . . .A 124820 124820 McUtil .DLL.PPT\n12 −−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−\n13 436644 264889 3 f i l e s, 0 folders\n\nExecuting the self-extracting archive extracts the files and runs mcvsmap.exe (Sample B). Sample\nB is a valid signed file that the author of the malware took from a software bundle from McAfee.\nSample B, when executed, attempts to load a file McUtil.DLL from the same directory, which\nusually is another component of McAfee. The malware author instead bundled the valid McAfee\nfile Sample B with a custom DLL (Sample C). Since the file will be loaded without hesitation\n(there are no protection mechanisms implemented; neither does McAfee check if the imported\nfile meets any conditions nor is any protection implemented for loading unsigned libraries in\nsigned code), the signed Sample B jumps into the beginning of the code section of Sample C (via\nPush/Return):\n\nAt the target location the following code is executed:\n\n1 read_execute_file ()\n2 {\n3 NumberOfBytesRead = GetModuleFileNameW(hModule, &filename, 0x2000u) ;\n4 lstrcatW(&filename, L\".PPT\" ) ;\n5 hFile_mcutil . d l l . ppt = CreateFileW(&filename, GENERIC_READ, 1u, 0, OPEN_EXISTING, 0,\n0) ;\n6 `if ( hFile_mcutil . d l l . ppt == −1 )`\n7 {\n8 result = GetLastError () ;\n9 }\n10 `else`\n11 {\n12 buffer = VirtualAlloc (0, 0x100000u, MEM_COMMIT, PAGE_EXECUTE_READWRITE) ;\n13 `if (` buffer && ReadFile ( hFile_mcutil . d l l . ppt, buffer, 0x100000u, &NumberOfBytesRead\n, 0) )\n14 {\n15 CloseHandle ( hFile_mcutil . d l l . ppt) ;\n16 buffer () ;\n17 Sleep (0xFFFFFFFF) ;\n18 Sleep (0xFFFFFFFF) ;\n19 Sleep (0xFFFFFFFF) ;\n20 result = 0;\n21 }\n22 `else`\n23 {\n24 result = GetLastError () ;\n\nPage 8 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n25 }\n26 }\n27 `return` result ;\n28 }\n\nThe code retrieves the filename of itself (line 3), which is McUtil.DLL, and appends .PPT (line\n4). A handle to the filename McUtil.DLL.PPT is created in line 5. In line 12 an exectuable\nmemory region is created, which is filled with the content of the file McUtil.DLL.PPT (line 13).\nAfter closing the handle to the file (line 15), the memory region is called (line 16). The next\nscreenshot shows that the memory contains only pure code without any overhead like MZ/PE\nheaders. The entropy of this file is 7.997904 bits per byte:\n\nThe code, when executed, reveals the first hint about what we found:\n\nIt decompresses and decrypts itself, using the Microsoft API call RtlDecompressBuffer and the\ncustom decryption routine:\n\nPage 9 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n1 int crypt ( unsigned int a1, int a2, int a3, int a4)\n2 {\n3 `if ( a4 > 0 )`\n4 {\n5 v10 = a3 − a2 ;\n6 `do`\n7 {\n8 a1 = a1 + (a1 >> 3) − 0x11111111 ;\n9 a1 = a1 + (a1 >> 5) − 0x22222222 ;\n10 a1 += 0x44444444 − (a1 << 9) ;\n11 a1 += 0x33333333 − (a1 << 7) ;\n12 v7 = *(v10 + a2++) ^ (a1 + a1 + a1 + a1) ;\n13 v8 = a4−− == 1;\n14 *(a2 − 1) = v7 ;\n15 }\n16 `while (` ! v8 ) ;\n17 }\n18 `return 0;`\n19 }\n\nThe decrypted and decompressed file is not written onto disk, it always remains in memory.\nSample E is the extracted version of this memory segment. At this point it can be mentioned\nthat neither the encrypted Sample D nor the decrypted memory segment Sample E are detected\nby Virus scanners.\nAfter some initialisation work like adjusting tokens (SeDebugPrivilege, SeTcbPrivileg[6], to act as\npart of the operating system), a new process is started, the original svchost.exe from Microsoft,\nand the code from Sample E is injected into the memory of that process. In a next step,\nsvchost.exe is instructed to execute the original msiexec.exe from Microsoft, where also memory\nis injected like it has been done for svchost.exe. Special conditions apply when run under Window\n7, which is protected by User Account Control (UAC). UAC is supposed to protect the user better\nfrom running malware by requesting the administator for approval before running a potentially\ndangerous application. In the environment of Windows 7, the malware drops temporarily file\nSample F, which it uses to evade or defeat the UAC mechanism. After killing the parent processes,\nonly two processes are left: svchost and msiexec. Both are verified binaries, none of the includes\na malicious DLL.\n\nNevertheless, they both contain the malicious code. At this point in time the malware is already\ntalking to the C&C, no user interaction was required, all standard security mechanisms were\ndefeated.\n\n### 4.3 Implemented commands\n\nThe analysis of Sample B revealed the commands as shown in the table below:\n\n6http://technet.microsoft.com/en-us/library/bb457125.aspx\n\nPage 10 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\nTable 1: Implemented commands\nSource file Internal command subcommand Description\n\n0x2000 lock workstation\n0x2001 shutdown workstation (forced)\n\nXPlugOption.cpp Option 0x2002 reboot workstation\n\n0x2003 shutdown workstation (graceful)\n0x2005 show messagebox\n\n0x3000 enumerate drives\n0x3001 find file\n0x3002 find file recursively\n0x300A create directory\n\nXPlugDisk.cpp Disk 0x3004 read file\n\n0x3007 write file\n0x300D file copy/rename/delete/move\n0x300C create process on hidden desktop\n0x300E get expanded environment string\n\n0x4000 Remote Desktop capabilities\n0x4004 send mouse event\n\nXPlugScreen.cpp Screen\n\n0x4005 send keyboard event\n0x4006 send CTRL-Alt-Delete\n0x4100 take screenshot\n\n0x5000 create process\n\nXPlugProcess.cpp Process 0x5001 enumerate processes\n\n0x5002 kill process\n\n0x6000 query service config\n0x6001 change service config (forced)\n\nXPlugService.cpp Service 0x6002 start service\n\n0x6003 control service\n0x6004 delete service\nXPlugShell.cpp Shell 0x7002 start a cmd shell\nXPlugTelnet.cpp Telnet 0x7100 start telnet server\n\n0x9000 enumerate keys\n0x9001 create key\n0x9002 delete key\n0x9003 copy key\n\nXPlugRegedit.cpp RegEdit\n\n0x9004 enumerate values\n0x9005 set value\n0x9006 delete value\n0x9007 get value\nXPlugNethood.cpp Nethood 0xA000 enumerate network resources\nXPlugPortMap.cpp Portmap 0xB000 starts port mapping\n\n0xC000 get data source information\n\nXPlugSQL.cpp SQL 0xC001 get driver description\n\n0xC002 execute statement\n\n0xD000 get TCP table\n\nXPlugNetstat.cpp Netstat 0xD001 get UDP table\n\n0xD002 set TCP entry\nXPlugKeyLogger.cpp Keylogger 0xE000 starts key logger thread\n\nPage 11 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n|Source file|Internal command|subcommand|Description|\n|---|---|---|---|\n|XPlugOption.cpp|Option|0x2000 0x2001 0x2002 0x2003 0x2005|lock workstation shutdown workstation (forced) reboot workstation shutdown workstation (graceful) show messagebox|\n|XPlugDisk.cpp|Disk|0x3000 0x3001 0x3002 0x300A 0x3004 0x3007 0x300D 0x300C 0x300E|enumerate drives find file find file recursively create directory read file write file file copy/rename/delete/move create process on hidden desktop get expanded environment string|\n|XPlugScreen.cpp|Screen|0x4000 0x4004 0x4005 0x4006 0x4100|Remote Desktop capabilities send mouse event send keyboard event send CTRL-Alt-Delete take screenshot|\n|XPlugProcess.cpp|Process|0x5000 0x5001 0x5002|create process enumerate processes kill process|\n|XPlugService.cpp|Service|0x6000 0x6001 0x6002 0x6003 0x6004|query service config change service config (forced) start service control service delete service|\n|XPlugShell.cpp|Shell|0x7002|start a cmd shell|\n|XPlugTelnet.cpp|Telnet|0x7100|start telnet server|\n|XPlugRegedit.cpp|RegEdit|0x9000 0x9001 0x9002 0x9003 0x9004 0x9005 0x9006 0x9007|enumerate keys create key delete key copy key enumerate values set value delete value get value|\n|XPlugNethood.cpp|Nethood|0xA000|enumerate network resources|\n|XPlugPortMap.cpp|Portmap|0xB000|starts port mapping|\n|XPlugSQL.cpp|SQL|0xC000 0xC001 0xC002|get data source information get driver description execute statement|\n|XPlugNetstat.cpp|Netstat|0xD000 0xD001 0xD002|get TCP table get UDP table set TCP entry|\n|XPlugKeyLogger.cpp|Keylogger|0xE000|starts key logger thread|\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n### 4.4 Command details\n\n**4.4.1** **Option**\n\nXPlugOption implements commands to lock the workstation, shut it down or reboot it. In\naddition, XPlugOption can create a thread that calls MessageBoxW() in order to present a\nmessage box to the user.\n\n**4.4.2** **Disk**\n\nXPlugDisk is used to enumerate connected disk drives and can be used to find and manipulate\nfiles and directories. In addition, XPlugDisk can be used to create a process, optionally on a\nhidden Windows desktop with the name ”HH”, as the code below illustrates:\n\n1 `if ( a1−>hidden )`\n2 {\n3 hDesktop = CreateDesktopW(L\"HH\", 0, 0, 0, 0x10000000u, 0) ;\n4 `if (` ! hDesktop )\n5 log ( `\"XPlugDisk.cpp\", 665, 0) ;`\n6 }\n7 hidden = a1−>hidden ;\n8 StartupInfo . lpDesktop = ( hidden != 0 ? L\"HH\" : 0) ;\n9 StartupInfo . cb = 68;\n10 StartupInfo . dwFlags = 1;\n11 StartupInfo .wShowWindow = hidden == 0;\n12 `if ( CreateProcessW (0, &a1−>commandline,` 0, 0, 0, 0, 0, 0, &StartupInfo, &\nProcessInformation ) )\n13 {\n14 . . .\n15 }\n\n**4.4.3** **Screen**\n\nXPlugScreen is not only taking screenshots, it is also implementing remote desktop capabilities.\nIt is able to capture the screen (internal command: ScreenT1) and can send mouse and keyboard\nevents (internal command: ScreenT2).\n\n**4.4.4** **Process**\n\nXPlugProcess implements three commands and is able to enumerate, create and kill processes.\n\n**4.4.5** **Service**\n\nIn the module XPlugService commands are available related to Windows services. Code is\nimplemented to query service configurations, change service configuration, start, control and\ndelete services.\n\n**4.4.6** **Shell**\n\nA remote shell for the attacker is created in the module XPlugShell, by creating an asynchronous\nset of pipes (\\pipe\\a and \\pipe\\b) for cmd.exe and the console attached to it (AttachConsole()).\n\nPage 12 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n**4.4.7** **Telnet**\n\ncmd.exe /Q is executed in the module XPlugTelnet in order to start a telnet server on the\nattacked machine.\n\n**4.4.8** **RegEdit**\n\nXPlugRegedit implements a set of commands to process the Windows registry. It is able to\nenumerate, create, delete and copy keys. It is also able to enumerate, set, delete and get values\nfrom the registry.\n\n**4.4.9** **Nethood**\n\nXPlugNethood is the module to enumerate network resources like network shares.\n\n**4.4.10** **Portmap**\n\nXPlugPortMap indicates that it performs some port mapping, however, the code is not understood, yet.\n\n**4.4.11** **SQL**\n\nXPlugSQL implements three functions to query SQL servers: a function to get data source\ninformation, a function to get the driver description and a function to execute SQL statements.\n\n**4.4.12** **Netstat**\n\nXPlugNetstat gets the TCP and UDP connection table and is able to set TCP table entries.\n\n**4.4.13** **Keylogger**\n\nThe keylogger implemented in XPlugKeyLogger catches Window titles, date, time and logs\nentered keys into the file\n\n1 C:\\Documents and Settings \\All Users\\VirusMap\\NvSmart . hlp\n\nIt has the format following the example below:\n\n1 2013−03−26 09:40:57 | C:\\Program Files \\Mozilla Firefox\\ f i r e f o x . exe − Mozilla Firefox\n2 www. google .com\n3\n4 2013−03−26 09:47:49 | C:\\WINDOWS\\system32\\notepad . exe | Untitled − Notepad\n5 This i s not a password\n6\n7 2013−03−26 09:48:06 | C:\\WINDOWS\\Explorer .EXE | C:\\Documents and Settings \\All Users\\\nVirusMap\n\n### 4.5 Other notable commands and functions\n\n**4.5.1** **log**\n\nThis function is called almost everywhere when the author expects that a functions returns an\nerror, at 1036 places. This is obviously done to ensure code quality.\n\nPage 13 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n1 write_log (LPCWSTR lpBuffer )\n2 {\n3 ExpandEnvironmentStringsW(L\"%ALLUSERSPROFILE%\", &path_to_bug . log, 0x800u) ;\n4 // %ALLUSERSPROFILE%\\SxS\\bug . log\n5 lstrcatW(&path_to_bug . log, L\"\\\\SxS\" ) ;\n6 CreateDirectoryW(&path_to_bug . log, 0) ;\n7 SetFileAttributesW(&path_to_bug . log, 6u) ;\n8 lstrcatW(&path_to_bug . log, L\"\\\\bug.log\" ) ;\n9 result = CreateFileW(&path_to_bug . log, 0x40000000u, 1u, 0, 4u, 2u, 0) ;\n10 `if (` result != −1 )\n11 {\n12 `if (` SetFilePointer ( result, 0, 0, 2u) != −1 )\n13 {\n14 GetLocalTime(&SystemTime) ;\n15 NumberOfBytesWritten = wsprintfW(\n16 &Buffer,\n17 L\"%4.4d-%2.2d-%2.2d %2.2d:%2.2d:%2.2d: \",\n18 SystemTime . wYear,\n19 SystemTime .wMonth,\n20 SystemTime .wDay,\n21 SystemTime .wHour,\n22 SystemTime . wMinute,\n23 SystemTime . wSecond) ;\n24 `if ( WriteFile ( result, &Buffer, 2 * NumberOfBytesWritten, &NumberOfBytesWritten,`\n\n0) )\n25 {\n26 len = lstrlenW ( lpBuffer ) ;\n27 WriteFile ( result, lpBuffer, 2 * len, &len, 0) ;\n28 }\n29 }\n30 result = CloseHandle ( result ) ;\n31 }\n32 `return` result ;\n33 }\n\nExample log file entries from file\n\n1 %ALLUSERSPROFILE%\\SxS\\bug . log\n\n1 2013−03−25 11:43:28: f i l e : XSetting . h, l ine : 57, error : [1300]Not a l l p r iv il eg es\nreferenced are assigned to the c a l l e r .\n2 2013−03−25 11:51:12: f i l e : XInstallUAC . cpp, l ine : 162, error : [ 5 ] Access i s denied .\n3 2013−03−25 13:59:45: f i l e : XRTL. cpp, l ine : 186, error : [1300]Not a l l p r iv il eg es\nreferenced are assigned to the c a l l e r .\n4 2013−03−25 14:07:12: f i l e : XRTL. cpp, l ine : 186, error : [123]The filename, directory\nname, or volume label syntax i s incorrect .\n5 2013−03−25 14:07:12: f i l e : XSetting . h, l ine : 58, error : [ 3 ] The system cannot find the\npath specified .\n6 2013−03−25 14:21:12: f i l e : dllmain . cpp, l i ne : 47, error : [1300]Not a l l pr iv il eg es\nreferenced are assigned to the c a l l e r .\n7 2013−03−25 17:31:58: f i l e : XInstall . cpp, li ne : 451, error : [ 5 ] Access i s denied .\n8 2013−03−25 17:37:00: f i l e : XSoTcpHttp . cpp, l i ne : 646, error : [12029]*\n\nIn addition an exception filter is installed to fetch the circumstances of otherwise not caught\nerrors:\n\n1 TopLevelExceptionFilter ( struct_a1_30 *a1)\n2 {\n3 . . .\n4 `if ( wsprintfA (`\n5 &OutputString,\n\nPage 14 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n6 `\"EName:%s,EAddr:0x%p,ECode:0x%p,EAX:%p,EBX:%p,ECX:%p,EDX:%p,ESI:%p,EDI:%p,EBP`\n```\n          :%p,ESP:%p,EIP:%p\\r\\n\",\n\n```\n7 &String1,\n8 a1−>ECode[ 3 ],\n9 *a1−>ECode,\n10 v6−>reg_eax,\n11 v6−>reg_ebx,\n12 v6−>reg_ecx,\n13 v6−>reg_edx,\n14 v6−>reg_esi,\n15 v6−>reg_edi,\n16 v6−>reg_ebp,\n17 v6−>reg_esp,\n18 v6−>reg_eip ) >= 256 )\n19 log ( `\"XException.cpp\", 39, 0) ;`\n20 call_write_log(&OutputString ) ;\n21 call_OutputDebugStringA(&OutputString ) ;\n22 . . .\n23 }\n\n### 4.6 Persistency\n\nThe three files Sample B, C and D are copied into the directory\n\n1 C:\\Documents and Settings \\All Users\\VirusMap\n\nrespectively in\n\n1 C:\\ProgramData\\VirusMap (C:\\ Users\\All Users\\VirusMap)\n\nAfter that, a new registry entry is set:\n\n1 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nwhich calls mcvsmap.exe (Sample B) after login.\nAnother option is the installation as a service in\n\n1 HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\ Services \\VirusMap\n\nThe key ”Imagepath” calls the same binary mcvsmap.exe (Sample B).\n\n### 4.7 Control\n\nThe attacked computer uses TCP and UDP to connect to port 443 on help.yahoo-upgrade.com\n(122.199.194.197). Unfortunately, the machine at that IP address doesn’t seem to reply to our\nrequests anymore on 2013-03-26.\nThe Passive DNS showed some other associated domains and hostnames with this IP address:\n\n1 help . yahoo−upgrade .com\n2 support . yahoo−upgrade .com\n3 update . ayuisyahooapis .com\n4 support . ayuisyahooapis .com\n5 update . trendmicrosoft . co . in\n\nIt’s highly probable that theses hostnames were also used for other campaigns. You might use\nthese as additional indicators for the detection of potential infections.\n\nPage 15 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n### 4.8 Network and domain information\n\n**4.8.1** **Network**\n\nThe IP address is located in the ASN 17877 and the ISP is not a known bulletproof hoster as\nyou can see on its historical[7] BGP ranking evolution.\n\n1 inetnum : 122.199.128.0 − 122.199.255.255\n2 netname : VAAN\n3 descr : NexG\n4 descr : 5F SeoulAcademy B/D, 967−6 Daechi−Dong, Gangnam−Gu, 135−280\n5 descr : ************************************************\n6 descr : Allocated to KRNIC Member.\n7 descr : I f you would l i k e to find assignment\n8 descr : information in detail please re f e r to\n9 descr : the KRNIC Whois Database at :\n10 descr : `\"http://whois.nic.or.kr/english/index.html\"`\n11 descr : ************************************************\n12 country : KR\n13 admin−c : SL1625−AP\n14 tech−c : SL1625−AP\n15 remarks : www. nexg . net\n16 status : ALLOCATED PORTABLE\n17 mnt−by : MNT−KRNIC−AP\n18 mnt−lower : MNT−KRNIC−AP\n19 changed : hm−changed@apnic . net 20060606\n20 source : APNIC\n21\n22 person : Sanguk Lee\n23 nic−hdl : SL1625−AP\n24 e−mail : ip@nexg . net\n25 address : 5F SeoulAcademy B/D, 967−6 Daechi−Dong, Gangnam−Gu, 135−280\n26 phone : +82−2−538−7060\n27 fax−no : +82−2−571−8998\n28 country : KR\n29 changed : hostmaster@nida . or . kr 20050105\n\n[7http://bgpranking.circl.lu/asn_details?asn=17877](http://bgpranking.circl.lu/asn_details?asn=17877)\n\nPage 16 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n30 mnt−by : MNT−KRNIC−AP\n31 source : APNIC\n32\n33 inetnum : 122.199.128.0 − 122.199.255.255\n34 netname : VAAN−KR\n35 descr : NexG\n36 country : KR\n37 admin−c : LS151−KR\n38 tech−c : LS151−KR\n39 status : ALLOCATED PORTABLE\n40 mnt−by : MNT−KRNIC−AP\n41 mnt−i r t : IRT−KRNIC−KR\n42 remarks : This information has been partially mirrored by APNIC from\n43 remarks : KRNIC. To obtain more s p e c i f i c information, please use the\n44 remarks : KRNIC whois server at whois . krnic . net .\n45 changed : hostmaster@nic . or . kr\n46 source : KRNIC\n\n**4.8.2** **Domain**\n\n1 Domain Name: YAHOO−UPGRADE.COM\n2 Registrar : JIANGSU BANGNING SCIENCE & TECHNOLOGY CO. LTD\n3 Whois Server : whois .55 hl .com\n4 Referral URL: http ://www.55 hl .com\n5 Name Server : DNS5.4CUN.COM\n6 Name Server : DNS6.4CUN.COM\n7 Status : ok\n8 Updated Date : 08−aug−2012\n9 Creation Date : 18− jul −2011\n10 Expiration Date : 18−jul −2013\n11\n12 >>> Last update of whois database : Wed, 27 Mar 2013 22:36:13 UTC <<<\n13\n14 Domain Name: yahoo−upgrade .com\n15\n16 Registrant Contact :\n17 yahoo\n18 yahoo yahoo whiteyoo_123@yahoo .com\n19 telephone : +48.56756756756\n20 fax : +48.56732453453\n21 yahoo yahoo yahoo 345345\n22 CA\n23\n24 Administrative Contact :\n25 yahoo yahoo whiteyoo_123@yahoo .com\n26 telephone : +48.56756756756\n27 fax : +48.56732453453\n28 yahoo yahoo yahoo 345345\n29 CA\n30\n31 Technical Contact :\n32 yahoo yahoo whiteyoo_123@yahoo .com\n33 telephone : +48.56756756756\n34 fax : +48.56732453453\n35 yahoo yahoo yahoo 345345\n36 CA\n37\n38 Billing Contact :\n39 yahoo yahoo whiteyoo_123@yahoo .com\n40 telephone : +48.56756756756\n\nPage 17 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n41 fax : +48.56732453453\n42 yahoo yahoo yahoo 345345\n43 CA\n\n### 4.9 Current version and history of PlugX\n\nA version string can be found in this binary:\n\n1 d:\\work\\plug7 .0(mcvsmap) ( fking )ǰ() \\ shellcode \\ shellcode \\XPlug . h\n\nThis could mean PlugX, version 7.0 codename fking, build for mcvsmap. References can be\nfound on the internet for previous versions of this malware family:\n\n1 d:\\work\\plug4 .0( nvsmart) ( sxl )\\ shellcode \\ shellcode \\XPlug . h\n2 d:\\work\\plug3 .1( icesword )\\ shellcode \\ shellcode \\XPlug . h\n3 d:\\work\\Plug3 .0( Gf)UDP\\ Shell6 \\Release\\ Shell6 . pdb\n4 i :\\work\\plug2 . 0() \\ shellcode \\ shellcode \\XPlug . h\n\n## A Appendix\n\n### A.1 Indicators of Compromise (IOC)\n\nThis section summarizes the known indicators of compromise. The list might not be exhaustive,\nbut the existence of any or all of the following indicators might help to discover an infection.\n\n**A.1.1** **Pipes**\n\n1 \\PIPE\\a$PID\n2 \\PIPE\\b$PID\n3 \\PIPE\\RUN_AS_USER($PID)\n\n(where $PID is the process ID of the active malicious process)\n\n**A.1.2** **Files and directories**\n\n   - Static files (dropped files)\n\n**– update.exe**\n\n1 MD5: f1f48360f95e1b43e9fba0fec5a2afb8\n2 SHA1: 70ceb467db7b0161d22e4545479f747417b9705a\n3 SHA−256: 2bc5ce39dd9afe2157448d3f6d8cb9c549ed39543d159616e38480b9e6c11c49\n\n**– mcvsmap.exe**\n\n1 MD5: 4e1e0b8b0673937415599bf2f24c44ad\n2 SHA1: 9224de3af2a246011c6294f64f27206d165317ba\n3 SHA−256: ae16e10e621d6610a3f7f2c7122f9d1263700ba02d1b90e42798decb2fe84096\n\n**– McUtil.DLL**\n\n1 MD5: ad4a646b38a482cc07d5b09b4fffd3b3\n2 SHA1: ae0f9bf2740d00c5d485827eb32aca33feaa3a90\n3 SHA−256: 0a99238e1ebebc47d7a89b2ccddfae537479f7f77322b5d4941315d3f7e5ca48\n\nPage 18 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n**– McUtil.DLL.PPT**\n\n1 MD5: 545bb4365a9b7cdb6d22844ebeedda93\n2 SHA1: a267f1183b4ff843d68a63264846abf78cc71d1f\n3 SHA−256: d4fe890a08d4dd44b58a3b85b2a7e89536338099c1c42a9b7e85f4007b0a37b7\n\n**– UAC.TMP**\n\n1 MD5: 52df5c2c07433e2a8f054c2347acb3b4\n2 SHA1: 8051474 c1fc0d8f404a42ea32eca1699e54f02e1\n3 SHA−256: dc09091e5d0ce03c6144748f17bd636f2f0b2ca56f88b550c1d48860596dbdb1\n\nFiles and/or directories might be hidden and carry the system flag\n\n1 C:\\ProgramData\\VirusMap (Windows 7)\n2 C:\\ Users\\All Users\\VirusMap (Windows 7)\n3 C:\\Documents and Settings \\All Users\\VirusMap (Windows XP)\n4 %ALLUSERSPROFILE%\\SxS\\bug . log\n5 C:\\Documents and Settings \\All Users\\VirusMap\\NvSmart . hlp\n\n**A.1.3** **Registry**\n\n1 HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\ Services \\VirusMap and a key referencing Sample\n\nB\n2 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run and a key referencing\n\nSample B\n\n**A.1.4** **Network (hostname and destination IP addresses)**\n\n1 help . yahoo−upgrade .com\n2 122.199.194.197\n\n### A.2 References\n\n  - WHITE PAPER: PLUG X - PAYLOAD EXTRACTION\n\n**[– http://www.contextis.com/files/PlugX_-_Payload_Extraction_March_2013_1.](http://www.contextis.com/files/PlugX_-_Payload_Extraction_March_2013_1.pdf)**\n```\n      pdf\n\n```\n**[– Context Information Security - http://www.contextis.com/](http://www.contextis.com/)**\n\n**– Published 2013-03-22**\n\n  - An Analysis of PlugX\n\n**[– http://lastline.com/blog.php](http://lastline.com/blog.php)**\n\n**[– Lastline - http://www.lastline.com/](http://www.lastline.com/)**\n\n**– no publication date found**\n\n  - PlugX is becoming mature\n\n**[– http://www.securelist.com/en/blog/208193974/PlugX_is_becoming_mature](http://www.securelist.com/en/blog/208193974/PlugX_is_becoming_mature)**\n\n**[– Kaspersky Lab - http://www.kaspersky.com/](http://www.kaspersky.com/)**\n\nPage 19 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n**– Published 2012-11-27**\n\n  - Unplugging PlugX Capabilities\n\n**[– http://blog.trendmicro.com/trendlabs-security-intelligence/unplugging-plugx-capabilities](http://blog.trendmicro.com/trendlabs-security-intelligence/unplugging-plugx-capabilities/)**\n\n**[– TrendMicro - http://www.trendmicro.eu/](http://www.trendmicro.eu/)**\n\n**– Published 2012-09-17**\n\n - Tracking down the author of the PlugX RAT\n\n**[– http://labs.alienvault.com/labs/index.php/2012/tracking-down-the-author-of-the-plugx-rat](http://labs.alienvault.com/labs/index.php/2012/tracking-down-the-author-of-the-plugx-rat/)**\n\n**[– AlienVault - http://labs.alienvault.com](http://labs.alienvault.com)**\n\n**– Published 2012-09-13**\n\n### A.3 VirusTotal results\n\n - Sample A\n\n1 MicroWorld−eScan : Trojan . Agent .AZDK\n2 nProtect : Trojan . Agent .AZDK\n3 McAfee : RDN/Generic BackDoor ! gq\n4 Malwarebytes : Trojan . Dropper .CH\n5 Symantec : WS. Reputation .1\n6 Norman: Agent .APIJH\n7 TrendMicro−HouseCall : BKDR_POISON.PQ\n8 Avast : Win32: Gulpix−B [ Trj ]\n9 Kaspersky : Backdoor .Win32. Gulpix . bo\n10 BitDefender : Trojan . Agent .AZDK\n11 Agnitum : Backdoor . Gulpix ! EFaRR6zLtc4\n12 ViRobot : Backdoor .Win32.A. Gulpix .370702.B\n13 Comodo: UnclassifiedMalware\n14 F−Secure : Trojan . Agent .AZDK\n15 DrWeb: Trojan . Click2 .52215\n16 VIPRE: Trojan .Win32. Generic !BT\n17 AntiVir : TR/Agent . azdk .3\n18 TrendMicro : BKDR_POISON.PQ\n19 McAfee−GW−Edition : RDN/Generic BackDoor ! gq\n20 Sophos : Troj/Agent−AATT\n21 Kingsoft : Win32. Hack . Gulpix . ( kcloud )\n22 Microsoft : Backdoor :Win32/Plugx .A\n23 GData: Trojan . Agent .AZDK\n24 AhnLab−V3: Backdoor/Win32. Gulpix\n25 Ikarus : Backdoor .Win32. Gulpix\n26 Fortinet : W32/Gulpix .BO! tr . bdr\n27 AVG: Agent4 .AKAP\n28 Panda : Trj/CI .A\n29 Scanned : 2013−03−21 04:01:12 − 45 scans − 28 detections (62.0%)\n\n - Sample B (mcvsmap.exe)\n\n1 Scanned : 2013−03−21 13:29:45 − 44 scans − 0 detections (0.0%)\n\n - Sample C (McUtil.DLL)\n\nPage 20 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----\n\nCIRCL - Computer Incident Response Center LuxembourgCIRCL - Computer Incident Response Center Luxembourg March 29, 2013\n\n1 MicroWorld−eScan : Trojan . Agent .AZDK\n2 nProtect : Trojan . Agent .AZDK\n3 McAfee : RDN/Generic BackDoor ! gt\n4 Malwarebytes : Backdoor . Gulpix\n5 Symantec : WS. Reputation .1\n6 Norman: Agent .APIJH\n7 TrendMicro−HouseCall : TROJ_GEN.RCBCRCJ\n8 Avast : Win32: Gulpix−B [ Trj ]\n9 Kaspersky : Backdoor .Win32. Gulpix . bo\n10 BitDefender : Trojan . Agent .AZDK\n11 Agnitum : Backdoor . Gulpix ! EFaRR6zLtc4\n12 Comodo: UnclassifiedMalware\n13 F−Secure : Trojan . Agent .AZDK\n14 DrWeb: Trojan . Click2 .52215\n15 VIPRE: Trojan .Win32. Generic !BT\n16 AntiVir : TR/Agent . azdk .2\n17 TrendMicro : TROJ_GEN.RCBCRCJ\n18 McAfee−GW−Edition : RDN/Generic BackDoor ! gt\n19 Sophos : Troj/Agent−AATT\n20 Microsoft : Backdoor :Win32/Plugx .A\n21 GData: Trojan . Agent .AZDK\n22 Commtouch: W32/Backdoor .IYCB−5867\n23 Ikarus : Backdoor .Win32. Gulpix\n24 Fortinet : W32/Gulpix .BO! tr . bdr\n25 AVG: Agent4 .AKAP\n26 Panda : Trj/CI .A\n27 Scanned : 2013−03−21 13:46:10 − 44 scans − 26 detections (59.0%)\n\n - Sample D (McUtil.DLL.PPT)\n\n1 Not uploaded to VirusTotal .\n\n - Sample E\n\n1 Not uploaded to VirusTotal .\n\n - Sample F (UAC.TMP)\n\n1 Panda : Suspicious f i l e\n2 Scanned : 2012−09−20 02:33:55 − 43 scans − 1 detections (2.0%)\n\nPage 21 of 21 CIRCL - Computer Incident Response Center Luxembourg\nc/o smile - ”security made in Lëtzebuerg” GIE\n41, avenue de la gare, L-1611 Luxembourg\n(+352) 247 88444 - info@circl.lu – www.circl.lu\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "http://circl.lu/assets/files/tr-12/tr-12-circl-plugx-analysis-v1.pdf",
        "https://app.box.com/s/90qhti3jwdmthbz7fd1l49n9y2cp8ffq",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.03.28.TR-12_PlugX_malware/tr-12-circl-plugx-analysis-v1.pdf",
        "https://circl.lu/assets/files/tr-12/tr-12-circl-plugx-analysis-v1.pdf"
    ],
    "report_names": [
        "tr-12-circl-plugx-analysis-v1.pdf",
        "tr-12-circl-plugx-analysis-v1"
    ],
    "threat_actors": [
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1364552752,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/875abf02dad2a434d708e495ffc8afe4b2500aae.pdf",
        "text": "https://archive.orkl.eu/875abf02dad2a434d708e495ffc8afe4b2500aae.txt",
        "img": "https://archive.orkl.eu/875abf02dad2a434d708e495ffc8afe4b2500aae.jpg"
    }
}