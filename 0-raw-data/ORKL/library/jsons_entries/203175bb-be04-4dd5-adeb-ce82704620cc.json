{
    "id": "203175bb-be04-4dd5-adeb-ce82704620cc",
    "created_at": "2023-01-12T15:10:28.03593Z",
    "updated_at": "2025-03-27T02:09:18.571285Z",
    "deleted_at": null,
    "sha1_hash": "c945b7db9726e7988df271e53da9fcf83d090ab3",
    "title": "2021-08-16 - A Deep-dive Analysis of LOCKBIT 2.0",
    "authors": "",
    "file_creation_date": "2022-05-27T23:05:25Z",
    "file_modification_date": "2022-05-27T23:05:25Z",
    "file_size": 1421925,
    "plain_text": "# A Deep-dive Analysis of LOCKBIT 2.0\n\n**blog.cyble.com/2021/08/16/a-deep-dive-analysis-of-lockbit-2-0/**\n\nAugust 16, 2021\n\nThe LOCKBIT 2.0 ransomware group has been highly active in the past few months. The Threat Actors\n(TAs) linked to this ransomware use a Ransomware-as-a-Service (RaaS) business model. LOCKBIT\n2.0 developers customize ransomware variants as per their affiliates’ needs. They also offer various panels and\nattack statistics to provide victim management capabilities to their affiliates.\n\nThe malware uses the double extortion technique to compel victims into paying ransoms. Through this technique,\nattackers exfiltrate the victim’s data, after which they proceed to encrypt the data on the victim’s system. Data\nencryption is followed by the TAs demand ransom in exchange for a decryptor. If the victim refuses or cannot pay\nthe ransom, the TA threatens to leak the data. This ransomware was previously known as ABCD ransomware as\nthe file extension used for encrypting files was .abcd. Now the extension used by this ransomware is .lockbit.\n\nFigure 1 shows the LOCKBIT 2.0 ransomware gang hosting a blog in the TOR network. This\nblog, in particular, is used by the TA to share the list of victims and screenshots of the sample data exfiltrated by\nthe attackers from affected systems.\n\n_Figure 1: LOCKBIT 2.0 Blog_\n\n_displaying Victim companies_\nLike other recently emerging RaaS gangs, LOCKBIT 2.0 also has an affiliate program to attract\npotential affiliates. Figure 2 shows the affiliate program page.\n\n\n-----\n\n_Figure 2: Affiliate Program_\n\n_of LOCKBIT 2.0_\nLockBit is trying to position itself as the fastest encryptor compared to its competitor, RaaS gangs. They have\nlisted the time spent on encryption for datasets of 100GB, 10TB, etc. Figure 3 shows the comparison of LOCKBIT\n2.0 with other ransomware gangs.\n\n_Figure 3: LOCKBIT_\n\n_2.0 Comparing itself with other Ransomware Gangs_\nAdditionally, this ransomware gang does not function in countries formerly a part of the Soviet Union. This gang\nalso uses tools such as StealBIT, Metasploit Framework, and Cobalt Strike.\n\n\n-----\n\nStealBIT is an information stealer used by the gang for data exfiltration. Metasploit Framework and Cobalt Strike\nare penetration testing tools used to emulate targeted attacks on sophisticated networks.\n\nFigure 4 shows the post in detail.\n\n_Figure 4: Additional affiliate details_\n\n_shared by the LOCKBIT 2.0_\n\n## Technical Analysis\n\nOur static analysis of the ransomware shows that the malware file is a Windows x86\narchitecture Graphical User Interface (GUI) executable compiled on 2021-07-26 13:04:01, as shown in Figure 5.\n\n_Figure 5: Static information_\n\n_About LOCKBIT 2.0 Ransomware_\n\n\n-----\n\nCyble Research Labs has also found that the malware uses only a few libraries, shown in Figure 6.\n\n_Figure 6: Libraries Used by_\n\n_Ransomware_\nFurthermore, only a few Application Programming Interfaces (APIs) were present in the ransomware import\ntable, as shown in Figure 7.\n\n_Figure 7: Import Table APIs_\n\n_List_\nFigure 8 shows that the ransomware has encrypted user document files and appended them with\na .lockbit extension while also changing the icon of all encrypted files. Additionally, the ransomware also drops\na ransom note in several folders.\n\n_Figure 8: Encrypted Files and Ransom_\n\n_Note dropped by ransomware_\nFigure 9 shows the content of the ransom note, which instructs the victims on how they can contact\nthe ransomware gang.\n\n_Figure 9: Content of ransom_\n\n_note_\n\n\n-----\n\nThe ransomware also changes the desktop background, showing additional ransomware gang information, as\nshown below.\n\n_Figure 10: LOCKBIT 2.0_\n\n_Changing Desktop Background_\nTo get further insights into the ransomware, we checked which string symbols were present in the malware.\n\nFigure 11 shows the details of the initial strings which are present in the malware. These strings indicate that the\nmalware can query connected systems in the Active Directory\nDomain using the Lightweight Directory Access Protocol (LDAP). In query strings, CN stands for Common\nName, OU stands for Organization Unit, and DC stands for Domain Component. This information could be used\nfor discovering other linked networks and systems.\n\n_Figure 11: Setting LDAP parameters for_\n\n_Microsoft Active Directory_\nAs seen in Figure 12, the ransomware could use PowerShell commands to query the DC to get the list\nof computers. Once the list is received, malware could invoke the GPUpdate command remotely on the listed\nsystems.\n\n\n-----\n\n_Figure 12: PowerShell_\n\n_command for searching computers in the network_\nAdditionally, the ransomware checks for additional mounted hard drives, network shared drives, shared folders of\nVMs, and deletes the running process using taskkill.exe shown in Figure 12.\n\nFigure 13 depicts the policy updates that ransomware can push in the active directory environment to other\nconnected systems. To evade detection, the ransomware can disable Windows Defender on running systems and\nremote systems as well.\n\n_Figure 13: Windows_\n\n_Defender Policies are changed by the ransomware_\nWhile running the ransomware, we observed that it injects itself in dllhost.exe, as shown in Figure 14.\n\n_Figure 14: Ransomware infecting dllhost.exe_\n\nThe ransomware adds its execution folder to the Path of the System variables, as shown in Figure 15.\n\n\n-----\n\n_Figure 15: Malware Added_\n\n_its Present Working Directory in System Path_\nFigure 16 shows the ransomware looking for various running services like backup services, database-related\napplications, and other applications shown in Figure 15. If any service is found running in the system,\nthe ransomware kills it. The ransomware uses OpenSCManager and OpenServiceA, as shown in Figure 16.\n\n_Figure 16: Ransomware_\n\n_searching for Services_\nAn additional list of services searched by the ransomware is shown in the table below.\n\nDefWatch RTVscan tomcat6\n\nccEvtMgr sqlbrowser zhudongfangyu\n\nSavRoam SQLADHLP vmware-usbarbitator64\n\nSqlservr QBIDPService vmware-converter\n\nsqlagent Intuit.QuickBooks.FCS dbsrv12\n\nsqladhlp QBCFMonitorService dbeng8\n\nCulserver msmdsrv MSSQL$MICROSOFT##WID\n\nMSSQL$KAV_CS_ADMIN_KIT MSSQLServerADHelper100 msftesql-Exchange\n\nSQLAgent$KAV_CS_ADMIN_KIT MSSQL$SBSMONITORING MSSQL$SHAREPOINT\n\nMSSQLFDLauncher$SHAREPOINT SQLAgent$SBSMONITORING SQLAgent$SHAREPOINT\n\nMSSQL$VEEAMSQL2012 QBFCService QBVSS\n\nSQLAgent$VEEAMSQL2012 YooBackup YooIT\n\nSQLBrowser vss SQL\n\nSQLWriter svc$ PDVFSService\n\nFishbowlMySQL MSSQL memtas\n\nMSSQL$MICROSOFT##WID MSSQL$ mepocs\n\nMySQL57 sophos veeam\n\n\n-----\n\nMSSQL$MICROSOFT##SSEE backup MSSQLFDLauncher$SBSMONITORING\n\nThe ransomware creates a shared folder for VMWare to spread to other systems, as shown in Figure 17.\n\n_Figure 17: Ransomware_\n\n_creating VMWare shared folder and Dropping Sample_\nThe encryption operation of the LOCKBIT 2.0 is similar to what we have observed in other ransomware\ngroups. The flow of operation is shown below.\n\n_Figure 18: Common_\n\n_Encryption Operation_\n\n## Conclusion \n\nLOCKBIT 2.0 is a highly sophisticated form of ransomware that uses various state-of-the-art techniques to\nperform ransomware operations. Current and potential LOCKBIT 2.0 victims’ range across multiple domains, from\nIT, services to banks. Our research indicates that affiliates of the group drop this ransomware inside an already\n\n\n-----\n\ncompromised network.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against attackers.\nWe recommend that our readers follow the suggestions given below:\n\nUse strong passwords and enforce multi-factor authentication wherever possible.\nTurn on the automatic software update feature on your computer, mobile, and other connected devices\nwherever possible and pragmatic.\n\nUse a reputed anti-virus and internet security software package on your connected devices.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\nConduct regular backup practices and keep those backups offline or in a separate network.\n\n## Indicators of Compromise (IoCs): \n\n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\n0545f842ca2eb77bcac0fd17d6d0a8c607d7dbc8669709f3096e5c1828e1c049 Hash SHA-256\n\n## About Us \n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves from cybercrimes](https://cyble.com/)\nand exposure in the Darkweb. Its prime focus is to provide organizations with real-time visibility to their digital risk\nfootprint. Backed by Y Combinator as part of the 2021 winter cohort, Cyble has also been recognized by Forbes\nas one of the top 20 Best Cybersecurity Start-ups To Watch In 2020. Headquartered in Alpharetta, Georgia, and\nwith offices in Australia, Singapore, and India, Cyble has a global presence. To learn more about Cyble,\nvisit [www.cyble.com.](https://cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-16 - A Deep-dive Analysis of LOCKBIT 2.0.pdf"
    ],
    "report_names": [
        "2021-08-16 - A Deep-dive Analysis of LOCKBIT 2.0.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536228,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653692725,
    "ts_modification_date": 1653692725,
    "files": {
        "pdf": "https://archive.orkl.eu/c945b7db9726e7988df271e53da9fcf83d090ab3.pdf",
        "text": "https://archive.orkl.eu/c945b7db9726e7988df271e53da9fcf83d090ab3.txt",
        "img": "https://archive.orkl.eu/c945b7db9726e7988df271e53da9fcf83d090ab3.jpg"
    }
}