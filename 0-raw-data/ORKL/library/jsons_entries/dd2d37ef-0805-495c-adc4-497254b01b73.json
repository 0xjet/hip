{
    "id": "dd2d37ef-0805-495c-adc4-497254b01b73",
    "created_at": "2023-01-12T15:10:51.835393Z",
    "updated_at": "2025-03-27T02:06:02.622886Z",
    "deleted_at": null,
    "sha1_hash": "2166dd59d30851945edff2613b5a7f508fe9aa84",
    "title": "2020-09-17 - Maze ransomware now encrypts via virtual machines to evade detection",
    "authors": "",
    "file_creation_date": "2022-05-27T02:00:45Z",
    "file_modification_date": "2022-05-27T02:00:45Z",
    "file_size": 457629,
    "plain_text": "# Maze ransomware now encrypts via virtual machines to evade detection\n\n**[bleepingcomputer.com/news/security/maze-ransomware-now-encrypts-via-virtual-machines-to-evade-detection/](https://www.bleepingcomputer.com/news/security/maze-ransomware-now-encrypts-via-virtual-machines-to-evade-detection/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nSeptember 17, 2020\n02:24 PM\n6\n\nThe Maze ransomware operators have adopted a tactic previously used by the Ragnar\nLocker gang; to encrypt a computer from within a virtual machine.\n\nIn May, we [previously reported that Ragnar Locker was seen encrypting files through](https://www.bleepingcomputer.com/news/security/ransomware-encrypts-from-virtual-machines-to-evade-antivirus/)\nVirtualBox Windows XP virtual machines to bypass security software on the host.\n\nThe virtual machine would mount a host's drives as remote shares and then run the\nransomware in the virtual machine to encrypt the share's files.\n\nAs the virtual machine is not running any security software and is mounting the host's\ndrives, the host's security software could not detect the malware and block it.\n\n## Maze now uses virtual machines to encrypt computers\n\n\n-----\n\n[While performing an incident response for one of their customers, Sophos discovered Maze](https://news.sophos.com/en-us/2020/09/17/maze-attackers-adopt-ragnar-locker-virtual-machine-technique/)\nhad attempted to deploy their ransomware twice but were blocked by Sophos' Intercept X\nfeature.\n\nFor the first two attempts, the Maze attacker attempted to launch various ransomware\nexecutables using scheduled tasks named 'Windows Update Security,' or 'Windows Update\nSecurity Patches,' or 'Google Chrome Security Update.'\n\nAfter the two failed attacks, Sophos' Peter Mackenzie told BleepingComputer that the Maze\nthreat actors tried a tactic previously used by the Ragnar Locker ransomware.\n\nIn their third attack, Maze deployed an MSI file that installed the VirtualBox VM software on\nthe server along with a customized Windows 7 virtual machine.\n\nOnce the virtual machine was started, like the previous Ragnar Locker attacks, a batch file\ncalled startup_vrun.bat batch file would be executed that preps the machine with the Maze\nexecutables.\n\n**Batch file to launch Maze ransomware on VM**\nThe machine is then shut down, and once restarted again, will launch vrun.exe to encrypt\nthe host's files.\n\n\n-----\n\nAs the virtual machine is performing the encryption on the host s mounted drives, security\nsoftware could not detect the behavior and stop it.\n\nThe SophosLabs researchers note that this is an expensive attack method in terms of disk\nsize compared to Ragnar Locker's previous attacks.\n\nAs Ragnar Locker's VM attack utilized Windows XP, the total footprint was only 404 MB in\nsize. As Maze used Windows 7, the footprint was much larger at a total of 2.6 GB.\n\nThis attack illustrates how ransomware operations monitor the tactics of their competitors\nand adopt them as necessary.\n\n[It should also be noted that Ragnar Locker is part of the 'Maze Cartel,' so it is possible that](https://www.bleepingcomputer.com/news/security/maze-ransomware-adds-ragnar-locker-to-its-extortion-cartel/)\nRagnar offered help to Maze in this attack method.\n\n### Related Articles:\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n[Hive ransomware ports its Linux VMware ESXi encryptor to Rust](https://www.bleepingcomputer.com/news/security/hive-ransomware-ports-its-linux-vmware-esxi-encryptor-to-rust/)\n\n[Windows 11 KB5014019 breaks Trend Micro ransomware protection](https://www.bleepingcomputer.com/news/security/windows-11-kb5014019-breaks-trend-micro-ransomware-protection/)\n\n[Industrial Spy data extortion market gets into the ransomware game](https://www.bleepingcomputer.com/news/security/industrial-spy-data-extortion-market-gets-into-the-ransomware-game/)\n\n[SpiceJet airline passengers stranded after ransomware attack](https://www.bleepingcomputer.com/news/security/spicejet-airline-passengers-stranded-after-ransomware-attack/)\n\n[Maze](https://www.bleepingcomputer.com/tag/maze/)\n[Ragnar Locker](https://www.bleepingcomputer.com/tag/ragnar-locker/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[Virtual Machine](https://www.bleepingcomputer.com/tag/virtual-machine/)\n[VirtualBox](https://www.bleepingcomputer.com/tag/virtualbox/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/ransomware-attack-at-german-hospital-leads-to-death-of-patient/)\n[Next Article](https://www.bleepingcomputer.com/news/google/google-chromes-new-feature-will-automatically-group-your-tabs/)\n\n### Comments\n\n\n-----\n\n[zakish7 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1178515/zakish7/)\n\nThis wouldn't work if sharing was disabled in VM's settings right?\n\n[qwertyanon - 1 year ago](https://www.bleepingcomputer.com/forums/u/1178528/qwertyanon/)\n\nprobably not, we should ask them to disable it when they launch the vm. :p\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nIt's a customized VM installation. They control the settings.\n\n\n-----\n\n[zakish7 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1178515/zakish7/)\n\nAppreciate the reply -- my bad, didn't notice the payload was an entire VM :)\n\n[testa - 1 year ago](https://www.bleepingcomputer.com/forums/u/1051973/testa/)\n\nSo the way to protect from VM attacks is to disable virtualization in BIOS right if you\ndon't use VM?\n\nMaybe anti-virus could be implemented to read contents inside VM disks. 7-zip can\nread them and extract just fine unless encrypted\n\n[jasonanwe - 1 year ago](https://www.bleepingcomputer.com/forums/u/1178627/jasonanwe/)\n\nDisable Windows (MSI) Installer via GPO (i.e., Enable 'Turn off Windows Installer').\nThen only those with admin rights can install (and no one should be primarily working\nfrom an ID with admin rights). Guide:\n[https://www.top-password.com/blog/turn-off-windows-installer-to-block-msi-package/](https://www.top-password.com/blog/turn-off-windows-installer-to-block-msi-package/)\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\n\n-----\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-17 - Maze ransomware now encrypts via virtual machines to evade detection.pdf"
    ],
    "report_names": [
        "2020-09-17 - Maze ransomware now encrypts via virtual machines to evade detection.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536251,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653616845,
    "ts_modification_date": 1653616845,
    "files": {
        "pdf": "https://archive.orkl.eu/2166dd59d30851945edff2613b5a7f508fe9aa84.pdf",
        "text": "https://archive.orkl.eu/2166dd59d30851945edff2613b5a7f508fe9aa84.txt",
        "img": "https://archive.orkl.eu/2166dd59d30851945edff2613b5a7f508fe9aa84.jpg"
    }
}