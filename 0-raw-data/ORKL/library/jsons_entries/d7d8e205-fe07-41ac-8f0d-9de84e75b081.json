{
    "id": "d7d8e205-fe07-41ac-8f0d-9de84e75b081",
    "created_at": "2023-01-12T15:05:27.815964Z",
    "updated_at": "2025-03-27T02:09:50.964092Z",
    "deleted_at": null,
    "sha1_hash": "148396d4ec31474839aec4b9eab1a7111394ddde",
    "title": "2019-12-11 - A -Project.exe- that should have stayed in a drawer - MZRevenge - MaMo434376",
    "authors": "",
    "file_creation_date": "2022-05-28T01:28:17Z",
    "file_modification_date": "2022-05-28T01:28:17Z",
    "file_size": 660238,
    "plain_text": "# A \"Project.exe\" that should have stayed in a drawer - MZRevenge / MaMo434376\n\n**[dissectingmalwa.re/a-projectexe-that-should-have-stayed-in-a-drawer-mzrevenge-mamo434376.html](https://dissectingmalwa.re/a-projectexe-that-should-have-stayed-in-a-drawer-mzrevenge-mamo434376.html)**\n\n#### Wed 11 December 2019 in Ransomware\n\n I first read about this strain on Twitter but it didn't seem like a big thing. Turns out I Was wrong: In the last 3 days I collected over 35 samples :O\n\n Searching for \"Project.exe\" on AnyRun yields more than a healthy list of results all matching this strain.\n\n\n-----\n\n#### Oh would you look at that: Looks like we have a Borland Delphi application here ðŸ§\n\n Yep, it's that ugly it definitely is Deplhi :D And the criminals seem to have a very strong opinion about the Land of the Free but no arguments to back it up (since the rest of the form is empty).\n\n The other strain uses a similar Form Window but actually displays its name in there (but they saved on the Window Title).\n\n\n-----\n\n#### MZ Revenge and MaMo add these extensions to encrypted files respectively: .MZ173801 and .MaMo434376. It seems to drop the Ransomnotes into the Library Folders, once into %appdata%\\Microsoft\\Windows\\Recent and into the root of every (unmounted) storage device.\n\n\n-----\n\n#### TIL: The MZP Magic tells you that the PE was built in Pascal. Therefore the error message is different as well, normally you would expect to see This program cannot be run in DOS mode here.\n\n Because loading a Delphi executable into IDA or Ghidra can be very painful to look at I'll try out a tool I haven't used before. It is called \"Interactive Delphi Reconstructor\" (IDR in short) and the setup is trivial. Just clone the Git Repository and download the Knowledge Base files linked at the bottom and extract + paste them into the source folder.\n\n For those playing along at home it should look something like this after the auto-analysis finished:\n\n Looking at the Strings tab I noticed this weird GUID {43826d1e-e718-42ee-bc55- a1e261c37bfe}. I'll have to investigate further to say for sure, but looking at this Document for the CIA Vault7 Leaks this might be part of an UAC bypass.\n\n I also grabbed the extension list the ransomware uses. It will target the following extensions:\n```\n.txt;.doc;.docx;.intex;.pdf;.zip;.rar;.onetoc;.css;.lnk;.xlsx;.ppt;.pptx;.odt;.jpg;.bm\nzip;.ace;.arj;.bz2;.myi;.cab;.gzip;.lzh;.tar;.uue;.xz;.z;.001;.mpg;.odg;.core;.crproj;\n\n As suspected by @Hildakrypt on Twitter the creators of the turkish KesLan Ransomware might also have built MZ Revenge / MaMo.\n\n```\n\n-----\n\n#### The #KesLan and #MZREVENGE #Ransomware authors are the same person, the canonical name is #MaMo434376 (as refered in the code) cc @BleepinComputer @demonslay335 @GrujaRS @raby_mr @Amigo_A_ pic.twitter.com/HQCuTWgJoH\n\n â€” HILDACRYPT (@HILDAKRYPT) December 11, 2019\n\n Update 15.12.2019:\n\n A new Version of this strain was found to be appending .aes to encrypted files. This time there is no ransomnote though, so let's see if this is a malfunction or intentional.\n\n The Any.Run Analysis can be found here.\n\n Visually this sample resembles the look of the \"MZ Revenge 1.0\" strain with an empty Form and the red DX icon.\n\n## MITRE ATT&CK\n\n#### T1215 --> Kernel Modules and Extensions --> Persistence\n\n T1045 --> Software Packing --> Defense Evasion\n\n T1056 --> Input Capture --> Credential Access\n\n T1012 --> Query Registry --> Discovery\n\n T1124 --> System Time Discovery --> Discovery\n\n T1083 --> File and Directory Discovery --> Discovery\n\n\n-----\n\n#### T1076 --> Remote Desktop Protocol --> Lateral Movement\n\n T1056 --> Input Capture --> Collection\n\n T1115 --> Clipboard Data --> Collection\n\n## IOCs\n\n### MZRevenge / MaMo434376\n\n\n-----\n\n```\n MZ Revenge 1.0 :\n7a92a80e742dbcb0d30948dbf6c4d7a6236a5692c5864a1276cfc84d5c71e375\n00c84efdebc555191ec91999a7f85c4ab0a6e7236dc477c7e4eb487152211336\na90c73a86a2771f6bff2cfc34d5798b71603da49105342a0a00324b7b6c63018\n6907a7689375a06c4f3d5c9d99074c9242342c0e813e669a03a07899740dcfa8\nf9cb03dbec628694f81c015b6799e3305f4941dab95d6f67343ef2c2dd2fb891\n734a6461eed16f83a355d22ecea28c993ef350a9ea925e2a68caea404f1c0a42\nbe880ab3f9b4f9cd967fdca899446241e962b3de8c938ed58b69d419b1b6168a\n62b129f041cb6b3ebf16f084295f6ffb818db67254eaadeadc906e3d2aecc415\n75b6e08e9a0ec989d4936dbbca7dc4ae5cf05ee0f4a7bc4ebccbf5bc81ac9518\n32c666ae39cced01978d43a878b4708cb4f4e7051c6d22f9a11c35ce6176151d\n184a63ae5c09e4963fc915f9957302ec5b0bd52b2e86049f45a75613f8d9f552\n00144748f68a6fe3a7cd98539043698a49fd1e020a6465d5f6e07542712ec014\nd8cff0354008b6fd2ea362d33609099eaedc13c5c7c759e2ad9ad998e0b00cda\n56ee5c88648365f5269e1ab0d6b00634f7d9fd9f08c91a45c7cb601d5073feb4\n3e0c4925102b2b4f1d93193000907c30731163b0e756d37c2a3b4dda1f938794\nca15b28914dc22461fbf8f213047673de7a0434d7ca0d8b796c1a6038f169e23\n265e0746692b5301156e4bbd19a9aa62961e333f04fc26d71a64f7739705ee7b\na90c73a86a2771f6bff2cfc34d5798b71603da49105342a0a00324b7b6c63018\n859c4b2306ea6a20fdbc4cdbdb28aa500e9928e57ae2ba13fbfb729cc465b6b0\nec70974046fbbd1461ef4b181f8a08270ffaede196c02f1e25e6c7807c29db6a\n45d7884b61a6b38356ee18b3814fae0e88715ac004e9df4417d47522203e2a89\n648cec145362a52c89c155bf5034eaedee9dd8c90e458dd8c0e1a25ad96e577e\n13bcd9a3c09560357b1decc640971f2cc8c1ac58275c317c4266751aefafd29b\nd95bd4077537edd5922861977ab3be873532ff2717b0dba916abc9465481cb0e\nb02ee036ac32a3b7425a57ff1cf68f2fc46a5f2d7bdea6be78efd574f9761c53\n9f28d3d3b8f6078c98d5831a3f1996c28fc14209f2240cc87bf70d20ffac371f\n1d5a8d924766f8aba0839ca747b0076b8b3718544c43e9ed32afd33f7fdd3c73\n4af2825b70fa4006d56a1faf40062e4a614dfa3de79a197bc268cd708709d4ec\n3f35a62f5e2fcb8f74d3aecae7de4bd9834c9400d33a716b74bbe28cf156f142\n0b7974582bb4e9c7de0c04618f307e7cbb4bba644c99f165be54117abeb32d43\n91d490cabd6776df1bcf26fa17cf9a13663bd79c1b5087ea718248f602d8df0e\n\"MaMo434376\":\n3276ab52336b9bc944717cfee706301326addf339891092fb0697d7b93960fa4\n10e37630cb1d050911f0c6c094d9c8218622887695960e35f98a596a2ed4de8d\nbbfa50b69c3ce9274f8c207dc6eb9caee6e55481440dfde23b85e9aa891ae53d\n02101d26f1ac2b3a9188489e4d2f4eeef648916c6a346d3318c36c2622754cbc\nbbb26303554c109d62b6f340045c04083ce04d5b6d94ac3a221223187a977072\nd7d908991970c971bcc0239654e437c22a987160422c70a838a016c5770caa72\nVersion 2: \n70733389c89b4358f04575226a8ce60c4511018c98731a2ff7f556c29447e4a4\n\n### Registry Keys\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\n--> DisableTaskMgr = 1\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\n--> UNCAsIntranet = 0\n\n```\n\n-----\n\n### E-Mail Addresses\n```\nhelpdesk_mz@aol[.]com\n\n Ransomnote V1\nATTENTION!\nDon*t worry, you can return all your files!\nAll your files like photos, databases, documents and other important are encrypted\nwith strongest encryption and unique key.\nThe only method of recovering files is to purchase decrypt tool and unique key for\nyou.\nThis software will decrypt all your encrypted files.\nWhat guarantees you have?\nYou can send one of your encrypted file from your PC and we decrypt it for free.\nBut we can decrypt only 1 file for free. File must not contain valuable information.\nPrice of private key and decrypt software is $300.\nDiscount 50% available if you contact us first 72 hours, thats price for you is $150.\nPlease note that you*ll never restore your data without payment.\nCheck your e-mail \"Spam\" or \"Junk\" folder if you don*t get answer more than 6 hours.\ne-mail address to send your file and To get this software you need write on my email:\nhelpdesk_mz@aol.com\nYour Decryption Key (DO NOT WIPE OR CHANGE THIS SWITCH!) :\n[redacted]\n\n Ransomnote V2\n---> MZ REVENGE 1.0 <--Dont worry, some of your files have extension .MZ173801 and they are encrypted.\nIn confirmatiom, that we have private decryption key,\nWe can provide test decryption for 1 file (png,jpg,bmp,gif).\nIts a business, if we cant provide full decryption, other people wont trust us.\nThere is no way to decrypt your files without our help.\nDont trust anyone. Even your cat.\nMain mail: helpdesk_mz@aol.com\nDont change decryption key below!!!\nMZ DECRYPTION KEY:\n[redacted]\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-11 - A -Project.exe- that should have stayed in a drawer - MZRevenge - MaMo434376.pdf"
    ],
    "report_names": [
        "2019-12-11 - A -Project.exe- that should have stayed in a drawer - MZRevenge - MaMo434376.pdf"
    ],
    "threat_actors": [
        {
            "id": "23dfc9f5-1862-4510-a6ae-53d8e51f17b1",
            "created_at": "2024-05-01T02:03:08.146025Z",
            "updated_at": "2025-03-27T02:05:17.420497Z",
            "deleted_at": null,
            "main_name": "PLATINUM TERMINAL",
            "aliases": [
                "Longhorn ",
                "The Lamberts ",
                "Vault7 ",
                "APT-C-39 "
            ],
            "source_name": "Secureworks:PLATINUM TERMINAL",
            "tools": [
                " Assassin",
                " Marble Framework",
                "AfterMidnight"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535927,
    "ts_updated_at": 1743041390,
    "ts_creation_date": 1653701297,
    "ts_modification_date": 1653701297,
    "files": {
        "pdf": "https://archive.orkl.eu/148396d4ec31474839aec4b9eab1a7111394ddde.pdf",
        "text": "https://archive.orkl.eu/148396d4ec31474839aec4b9eab1a7111394ddde.txt",
        "img": "https://archive.orkl.eu/148396d4ec31474839aec4b9eab1a7111394ddde.jpg"
    }
}