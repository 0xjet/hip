{
    "id": "678cb087-e899-4992-a110-ab18bdeba9b4",
    "created_at": "2023-01-12T14:58:55.887402Z",
    "updated_at": "2025-03-27T02:15:37.949136Z",
    "deleted_at": null,
    "sha1_hash": "a3973cc973112dad1156e5de2b8bda63abb36121",
    "title": "2018-03-07 - Leaked Ammyy Admin Source Code Turned into Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:50:47Z",
    "file_modification_date": "2022-05-28T19:50:47Z",
    "file_size": 948287,
    "plain_text": "# Leaked Ammyy Admin Source Code Turned into Malware\n\n**[proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat](https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat)**\n\n\nMarch 7, 2018\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nLeaked Ammyy Admin Source Code Turned into Malware\n\n\n-----\n\nMarch 07, 2018 Proofpoint Staff\n\n**Overview**\n\nProofpoint researchers have discovered a previously undocumented remote access Trojan (RAT) called\n[FlawedAmmyy that has been used since the beginning of 2016 in both highly targeted email attacks as well as](https://www.proofpoint.com/us/email-visibility)\nmassive, multi-million message campaigns. Narrow attacks targeted the Automotive industry among others,\n[while the large malicious spam campaigns appear to be associated with threat actor TA505, an actor](https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter)\nresponsible for many large-scale attacks since at least 2014.\n\n**Delivery Analysis**\n\n_March 5, 2018_\n\nFlawedAmmyy Admin appeared most recently as the payload in massive email campaigns on March 5 and 6,\n2018. The messages in these campaigns contained zipped .url attachments and both the messages and the\ndelivery suggest they were sent by threat actor TA505, known for sending large-scale Dridex, Locky, and\nGlobeImposter campaigns, among others, over the last four years.\n\nFor example, on March 5, the messages were sent from addresses spoofing the recipient’s own domain with\nsubjects such as “Receipt No 1234567” (random digits, and first word could also be “Bill” or “Invoice”) and\nmatching attachments \"Receipt 1234567.zip\". The attachments were ZIP archives containing \".url\" files with\nnames such as \"B123456789012.url\". Again, these were apparently random digits (Figure 1).\n\n\n-----\n\n_Figure 1: Sample email from March 5, 2018, Ammyy Admin malware campaign_\n\n_Figure 2: Contents of the .url file_\n\nThe .url files are interpreted by Microsoft Windows as “Internet Shortcut” files [1], examples of which can be\nfound in the “Favorites” folder on Windows operating systems. This type of file can be created manually [2];\nthey are intended to serve as links to internet sites, launching the default browser automatically. However, in\nthis case the attacker specified the URL to be a “file://” network share instead of the typical http:// link. As a\nresult, the system downloads and executes a JavaScript file over the SMB protocol rather than launching a\nweb browser if the user clicks “Open” on the warning dialog shown in Figure 3.\n\n\n-----\n\n`\n\n_Figure 3: Warning dialog displayed after double-clicking the .url file_\n\nThis JavaScript in turn downloads Quant Loader, which, in this case, fetched the FlawedAmmyy RAT as the\nfinal payload. The use of “.url” files and SMB protocol downloads is unusual, and this is the first time we have\nseen these methods combined.\n\n_March 1, 2018_\n\nThe FlawedAmmyy RAT previously appeared on March 1 in a narrowly targeted attack. Emails contained an\nattachment 0103_022.doc (Figure 4), which used macros to download the FlawedAmmyy malware directly.\nThis sample used the same command and control (C&C) address as the sample from the massive campaign\non March 5.\n\n\n-----\n\n_Figure 4: Screenshot of the document attachment from March 1, 2018, FlawedAmmyy campaign_\n\n_January 16, 2018_\n\n[We also observed this RAT in a narrowly targeted attack that included the automotive industry. Emails](https://www.proofpoint.com/us/threat-reference/malware)\ncontained the attachment 16.01.2018.doc which used macros to download the FlawedAmmyy RAT directly.\n\n**Malware Analysis**\n\nFlawedAmmyy is based on leaked source code for Version 3 of the Ammyy Admin remote desktop software.\nAs such FlawedAmmyy contains the functionality of the leaked version, including:\n\nRemote Desktop control\nFile system manager\nProxy support\nAudio Chat\n\n_Figure 5: Strings from the analyzed January 16 sample contain references to the leaked Ammyy Admin Version_\n_3_\n\n\n-----\n\n_Figure 6: Snippet of Ammyy Admin Version 3 source code, file TrMain.cpp_\n\nThe FlawedAmmyy C&C protocol occurs over port 443 with HTTP. In the initial handshake, sent by the client to\nthe server, the first byte is always “=”, followed by 35 obfuscated and SEAL-encrypted bytes. After a server\nresponse (0x2d00), the infected client sends the second packet. This packet has a 5-byte header that includes\nthe length of the rest of the packet (0x78). The body of this packet contains cleartext key-value pairs:\n\n_Figure 7: Screenshot of FlawedAmmyy C&C protocol from Wireshark_\n\n_Table 1: Explanation of the key-value pairs sent by the infected client in the second packet_\n\n**Parameter** **Explanation** **Example Value**\n\n\nid 8 digit number, the first digit always being ‘5’ and the remaining 7\nchosen at random on initialization of the malware\n\n\n53466221\n\n\nos Operating system 7 SP1 x86\n\npriv Privilege Admin\n\ncred Username DOMAIN\\Username1\n\npcname Computer name Computer3\n\navname Antivirus product name obtained via WMI query Windows Defender\n\n\n-----\n\ncard 1 if a usable smart-card is inserted into a reader, 0 otherwise 1\n\n\nbuild_time Malware build time, obtained at runtime by reading the PE timestamp\nfield from its file on disk\n\n**Conclusion**\n\n\n14-01-2018 6:34:27\n\n20-02-2018 16:43:10\n\n\nAmmyy Admin is a popular remote access tool used by businesses and consumers to handle remote control\nand diagnostics on Microsoft Windows machines. However, leaked source code for Version 3 of Ammyy Admin\nhas emerged as a Remote Access Trojan called FlawedAmmyy appearing in a variety of malicious campaigns.\nFor infected individuals, this means that attackers potentially have complete access to their PCs, giving threat\nactors the ability to access a variety of services, steal files and credentials, and much more. We have seen\nFlawedAmmyy in both massive campaigns, potentially creating a large base of compromised computers, as\nwell as targeted campaigns that create opportunities for actors to steal customer data, proprietary information,\nand more.\n\n**References**\n\n[1] [https://msdn.microsoft.com/en-us/library/windows/desktop/bb776784(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/bb776784(v=vs.85).aspx)\n\n[2] [https://forums.asp.net/t/1563309.aspx?How+to+create+InternetShortcut+url+](https://forums.asp.net/t/1563309.aspx?How+to+create+InternetShortcut+url+)\n\n**Indicators of Compromise (IOCs)**\n\n_March 5 campaign:_\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\n18436342cab7f1d078354e86cb749b1de388dcb4d1e22c959de91619947dfd63 SHA256 bill 0256853.zip\n\nd82ca606007be9c988a5f961315c3eed1b12725c6a39aa13888e693dc3b9a975 SHA256 B123177432431.url\n\nfile[:]//buyviagraoverthecounterusabb[.]net/documents/B123456789012.js URL SMB URL\ncontained in the\nInternet Shortcut\n\n8903d514549aa9568c7fea0123758b954b9703c301b5e4941acb33cccd0d7c57 SHA256 B37348362793.js\n(downloaded over\nSMB)\n\nhxxp://chimachinenow[.]com/kjdhc783 URL JS Payload\nExample\n\nhxxp://highlandfamily[.]org/kjdhc783 URL JS Payload\nExample\n\n\n-----\n\nhxxp://intra[.]cfecgcaquitaine[.]com/kjdhc783 URL JS Payload\nExample\n\nhxxp://motifahsap[.]com/kjdhc783 URL JS Payload\nExample\n\nhxxp://sittalhaphedver[.]com/p66/kjdhc783 URL JS Payload\nExample\n\n2b53466eebd2c65f81004c567df9025ce68017241e421abcf33799bd3e827900 SHA256 Quant Loader\n\nhxxp://wassronledorhad[.]in/q2/index.php SHA256 Quant Loader C&C\n\nhxxp://balzantruck[.]com/45rt.exe SHA256 Quant Loader\nPayload\n(FlawedAmmyy)\n\n0d100ff26a764c65f283742b9ec9014f4fd64df4f1e586b57f3cdce6eadeedcd SHA256 FlawedAmmyy\n\n179.60.146[.]3:443 IP:Port FlawedAmmyy\nC&C\n\n_March 1 campaign:_\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\n9a7fb98dd4c83f1b4995b9b358fa236969e826e4cb84f63f4f9881387bc88ccf SHA256 Macro MHT\ndocument\nExample\n\nhxxp://185.176.221[.]54/chrome.exe SHA256 Payload\ndownload\n\nb0ad80bf5e28e81ad8a7b13eec9c5c206f412870814d492b78f7ce4d574413d2 SHA256 FlawedAmmyy\n\n179.60.146[.]3:443 IP:Port C&C\n\n_January 16 campaign:_\n\n**IOC** **IOC Type** **Description**\n\ncafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541 SHA256 FlawedAmmyy\n\n194.165.16.11[:]443 IP:Port C&C\n\n\n-----\n\nAdditional samples on Virustotal:\n\n**IOC** **IOC Type** **Description**\n\n404d3d65430fbbdadedb206a29e6158c66a8efa2edccb7e648c1dd017de47572 SHA256 FlawedAmmyy\n\ncc0205845562e017ff8b3aafb17de167529d113fc680e07ee9d8753d81487b2f SHA256 FlawedAmmyy\n\n790e7dc8b2544f1c76ff95e56315fee7ef3fe623975c37d049cc47f82f18e4f2 SHA256 FlawedAmmyy\n\n2d19c42f753dcee5b46344f352c11a1c645f0b77e205c218c985bd1eb988c7ce SHA256 FlawedAmmyy\n\n6e701670350b4aea3d2ead4b929317b0a6d835aa4c0331b25d65ecbfbf8cb500 SHA256 FlawedAmmyy\n\n3cd39abdbeb171d713ee8367ab60909f72da865dbb3bd858e4f6d31fd9c930d0 SHA256 FlawedAmmyy\n\n1f5d31d41ebb417d161bc49d1c50533fcbff523bb583883b10b14974a3de8984 SHA256 FlawedAmmyy\n\n6877ac35a3085d6c10fa48655cf9c2399bd96c3924273515eaf89b511bbe356a SHA256 FlawedAmmyy\n\n059c0588902be3e8a5d747df9e91f65cc50d908540bdeb08acf15242cc9a25b5 SHA256 FlawedAmmyy\n\nc8b202e5a737b8b5902e852de730dbd170893f146ab9bbc9c06b0d93a7625e85 SHA256 FlawedAmmyy\n\n927fa5fea13f8f3c28e307ffea127fb3511b32024349b39bbaee63fac8dcded7 SHA256 FlawedAmmyy\n\n6048a55de1350238dfc0dd6ebed12ddfeb0a1f3788c1dc772801170756bf15c7 SHA256 FlawedAmmyy\n\nadfdead4419c134f0ab2951f22cfd4d5a1d83c0abfe328ae456321fccf241eb6 SHA256 FlawedAmmyy\n\n022f662903c6626fb81e844f7761f6f1cbaa6339e391468b5fbfb6d0a1ebf8cb SHA256 FlawedAmmyy\n\n3f5f5050adcf0d0894db64940299ac07994c4501b361dce179e3d45d9d155adf SHA256 FlawedAmmyy\n\ncafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541 SHA256 FlawedAmmyy\n\nList of code-signing Certificates used:\n\n**Subject Name** **Serial Number**\n\nCYBASICS LTD 00 BB AE 27 7A C3 D9 CF 3F 85 00 86 A3 14 E7 0A D7\n\nCYBASICS LTD 7F 6B 67 8E 66 DD 35 D6 58 9D 9B B2 0F C3 BA 0B\n\n\n-----\n\nAdFuture Ltd 25 43 BF D0 26 6A 5C ED A6 63 9A 2A 49 15 75 3A\n\nLLC \"ASTER-AYTI\" 10 88 E7 1C 82 F9 BB 73 74 7C 6D 0B 75 E0 5F 17\n\nAtrast, OOO 00 A0 71 DB B3 2B 9D E4 F8 D2 17 39 44 C3 C2 39 F9\n\n**ET and ETPRO Suricata/Snort Coverage**\n\n2025408 | Win32/FlawedAmmyy RAT CnC Checkin\n\n2024452 | ET TROJAN Quant Loader v1.45 Download Request\n\n2023203 | ET TROJAN Quant Loader Download Request\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-07 - Leaked Ammyy Admin Source Code Turned into Malware.pdf"
    ],
    "report_names": [
        "2018-03-07 - Leaked Ammyy Admin Source Code Turned into Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535535,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1653767447,
    "ts_modification_date": 1653767447,
    "files": {
        "pdf": "https://archive.orkl.eu/a3973cc973112dad1156e5de2b8bda63abb36121.pdf",
        "text": "https://archive.orkl.eu/a3973cc973112dad1156e5de2b8bda63abb36121.txt",
        "img": "https://archive.orkl.eu/a3973cc973112dad1156e5de2b8bda63abb36121.jpg"
    }
}