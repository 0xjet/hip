{
    "id": "d6a7f7b0-91b2-4363-9c2a-c46ca30a5f22",
    "created_at": "2023-01-12T15:03:02.294038Z",
    "updated_at": "2025-03-27T02:15:38.082387Z",
    "deleted_at": null,
    "sha1_hash": "f97772a6650ad326399d6f381499e4705cf7d6a5",
    "title": "2018-07-19 - TA505 Abusing SettingContent-ms within PDF files to Distribute FlawedAmmyy RAT",
    "authors": "",
    "file_creation_date": "2022-05-28T19:51:05Z",
    "file_modification_date": "2022-05-28T19:51:05Z",
    "file_size": 1664804,
    "plain_text": "# TA505 Abusing SettingContent-ms within PDF files to Distribute FlawedAmmyy RAT\n\n**[proofpoint.com/us/threat-insight/post/ta505-abusing-settingcontent-ms-within-pdf-files-distribute-flawedammyy-rat](https://www.proofpoint.com/us/threat-insight/post/ta505-abusing-settingcontent-ms-within-pdf-files-distribute-flawedammyy-rat)**\n\nJuly 19, 2018\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nTA505 Abusing SettingContent-ms within PDF files to Distribute FlawedAmmyy RAT\n\n\n-----\n\nJuly 19, 2018 Proofpoint Staff\n\n**Overview**\n\nThreat actors regularly introduce novel vectors for distributing malware and especially prize those that\nallow code and command execution with minimal user interaction. Colleagues at SpecterOps recently\npublished research[1] on abuse of the SettingContent-ms file format. Crafted SettingContent-ms files can\nbe used to bypass certain Windows 10 defenses such as Attack Surface Reduction (ASR) and detection\nof OLE-embedded dangerous file formats. Specifically, this file format currently allows execution of\ncommands such as cmd.exe and PowerShell without prompts or user interaction.\n\nSince the original publication of this approach, Proofpoint researchers have observed a number of actors\n-- “early adopters” -- abusing this file format by embedding it inside Microsoft Word and PDF documents.\nWhile the combination of the technique with the Microsoft Word container was described in the initial\nresearch, embedding inside PDFs has not been documented and likely originated with another source.\n\n**Campaign Description**\n\nWe first observed an actor embedding SettingContent-ms inside a PDF on June 18. However, on July 16\nwe observed a particularly large campaign with hundreds of thousands of messages attempting to deliver\nPDF attachments with an embedded SettingContent-ms file. The messages in the campaign used a\nsimple lure asking the user to open the attached PDF (Figure 1).\n\n\n-----\n\n_Figure 1: Example message used to deliver the malicious PDF_\n\nWhen opened, Adobe Reader displays a warning prompt, asking the user if they want to open the file,\nsince it is attempting to run the embedded “downl.SettingContent-ms” via JavaScript. Note that this\nprompt would be displayed for any file format embedded within a PDF, and is not caused by the\nSettingContent-ms file itself (Figure 2).\n\n\n-----\n\n_Figure 2: Adobe Reader presenting the user with a prompt to open the SettingContent-ms file_\n\nIf the intended victim clicks the “OK” prompt to open the file, Windows would then run the SettingContentms file and the PowerShell command contained within the “DeepLink” element (Figure 3), which leads to\nthe download and execution of the FlawedAmmyy RAT.\n\n_Figure 3: The SettingContent-ms file that contains the malicious PowerShell command_\n\n**Attribution**\n\nThis campaign is noteworthy because we attribute it with high confidence to a financially motivated actor\nwe refer to as TA505 [3,4]. TA505 tends to operate at very large scale and sets trends among financially\nmotivated actors because of their reach and campaign volumes. Our attribution is based on email\nmessages, as well as payload and other identifying characteristics.\n\n**Conclusion**\n\nWhether well established (like TA505) or newer to the space, attackers are quick to adopt new\ntechniques and approaches when malware authors and researchers publish new proofs of concept.\nWhile not all new approaches gain traction, some may become regular elements through which threat\nactors rotate as they seek new means of distributing malware or stealing credentials for financial gain. In\nthis case, we see TA505 acting as an early adopter, adapting the abuse of SettingContent-ms files to a\nPDF-based attack delivered at significant scale. We will continue to monitor ways in which threat actors\nuse this approach in the weeks to come.\n\n**References**\n\n[1] [https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39](https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39)\n\n[2] https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turnedflawedammyy-rat\n\n\n-----\n\n[3] [https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter](https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter)\n\n[4] [https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times](https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times)\n\n**Indicators of Compromise (IOCs)**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\n0a4f3f9acc61b85183108a31a306115fe34b571240da70920f0a1425fc32c3de SHA256 PDF\nAttachment\n\n61b1dc4d69730dd83f7ef38dd01012fd3487a4db9eb52b024209967093ae180d SHA256 FlawedAmmyy\nLoader\n\n56f1ab4b108cafcbada89f5ca52ed7cdaf51c6da0368a08830ca8e590d793498 SHA256 FlawedAmmyy\nRAT\n\nhxxp://169.239.128[.]164/tov URL URL used to\ndownload\nFlawedAmmyy\nLoader\n\nhxxp://169.239.128[.]164/sd87f67ds5gs7d5fs7df URL URL used to\ndownload the\n2nd Stage\nFlawedAmmyy\nRAT\n\n\n169.239.128[.]150:443 IP +\nPort\n\n**ET and ETPRO Suricata/Snort/ClamAV Signatures**\n\n2025408 || ET TROJAN Win32/FlawedAmmyy RAT CnC Checkin\n\nSubscribe to the Proofpoint Blog\n\n\nFlawedAmmyy\nRAT C&C\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-19 - TA505 Abusing SettingContent-ms within PDF files to Distribute FlawedAmmyy RAT.pdf"
    ],
    "report_names": [
        "2018-07-19 - TA505 Abusing SettingContent-ms within PDF files to Distribute FlawedAmmyy RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535782,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653767465,
    "ts_modification_date": 1653767465,
    "files": {
        "pdf": "https://archive.orkl.eu/f97772a6650ad326399d6f381499e4705cf7d6a5.pdf",
        "text": "https://archive.orkl.eu/f97772a6650ad326399d6f381499e4705cf7d6a5.txt",
        "img": "https://archive.orkl.eu/f97772a6650ad326399d6f381499e4705cf7d6a5.jpg"
    }
}