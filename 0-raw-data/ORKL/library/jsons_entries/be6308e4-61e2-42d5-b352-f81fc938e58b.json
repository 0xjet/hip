{
    "id": "be6308e4-61e2-42d5-b352-f81fc938e58b",
    "created_at": "2023-01-12T15:05:13.810525Z",
    "updated_at": "2025-03-27T02:09:24.526418Z",
    "deleted_at": null,
    "sha1_hash": "2a9854870dea6158570d605280e08cceb93a9919",
    "title": "2021-10-18 - Karma Ransomware - An Emerging Threat With A Hint of Nemty Pedigree",
    "authors": "",
    "file_creation_date": "2022-05-28T23:34:37Z",
    "file_modification_date": "2022-05-28T23:34:37Z",
    "file_size": 1716556,
    "plain_text": "# Karma Ransomware | An Emerging Threat With A Hint of Nemty Pedigree\n\n**[sentinelone.com/labs/karma-ransomware-an-emerging-threat-with-a-hint-of-nemty-pedigree/](https://www.sentinelone.com/labs/karma-ransomware-an-emerging-threat-with-a-hint-of-nemty-pedigree/)**\n\nAntonis Terefos\n\nKarma is a relatively new ransomware threat actor, having first been observed in June of\n2021. The group has targeted numerous organizations across different industries. Reports of\na group with the same name from 2016 are not related to the actors currently using the\nname. An initial technical analysis of a single sample related to Karma was published by\n[researchers from Cyble in August.](https://blog.cyble.com/2021/08/24/a-deep-dive-analysis-of-karma-ransomware/)\n\nIn this post, we take a deeper dive, focusing on the evolution of Karma through multiple\nversions of the malware appearing through June 2021. In addition, we explore the links\nbetween Karma and other well known malware families such as NEMTY and JSWorm and\noffer an expanded list of technical indicators for threat hunters and defenders.\n\n## Initial Sample Analysis\n\nKarma’s development has been fairly rapid and regular with updated variants and\nimprovements, oftentimes building multiple versions on the same day. The first few Karma\nsamples our team observed were:\n\nSample 1: `d9ede4f71e26f4ccd1cb96ae9e7a4f625f8b97c9`\n\nSample 2: `a9367f36c1d2d0eb179fd27814a7ab2deba70197`\n\nSample 3: `9c733872f22c79b35c0e12fa93509d0326c3ec7f`\n\n\n-----\n\nSample 1 was compiled on 18th, June 2021 and Samples 2 and 3 the following day on the\n19th, a few minutes apart. Basic configuration between these samples is similar, though\nthere are some slight differences such as PDB paths.\n\nAfter Sample 1, we see more of the core features appear, including the writing of the ransom\nnote. Upon execution, these payloads would enumerate all local drives (A to Z), and encrypt\nfiles where possible.\n\nFurther hunting revealed a number of other related samples all compiled within a few days of\neach other. The following table illustrates compilation timestamps and payload size across\nversions of Karma compiled in a single week. Note how the payload size decreases as the\nauthors’ iterate.\n\n\n-----\n\nRansom Note is not Created in Sample 1.\nAlso, the list of excluded extensions is somewhat larger in Sample 1 than in both Samples 2\nand 3, and the list of extensions is further reduced from Sample 5 onwards to only exclude\n“.exe”, “.ini”, “.dll”, “.url” and “.lnk”.\n\n\n-----\n\nThe list of excluded extensions is reduced as the malware authors iterate\n\n## Encryption Details\n\n[From Sample 2 onwards, the malware calls CreateIoCompletionPort, which is used for](https://docs.microsoft.com/en-us/windows/win32/fileio/createiocompletionport)\ncommunication between the main thread and a sub thread(s) handling the encryption\nprocess. This specific call is key in managing efficiency of the encryption process\n(parallelization in this case).\n\nIndividual files are encrypted by way of a random Chacha20 key. Once files are encrypted,\nthe malware will encrypt the random Chacha20 key with the public ECC key and embed it in\nthe encrypted file.\n\n\n-----\n\nChacha Encryption\n\nAcross Samples 2 to 5, the author removed the `CreateIoCompletionPort call, instead`\nopting to create a new thread to manage enumeration and encryption per drive. We also\nnote the “KARMA” mutex created to prevent the malware from running more than once.\nRansom note names have also been updated to “KARMA-ENCRYPTED.txt”.\n\nDiving in deeper, some samples show that the ChaCha20 algorithm has been swapped out\nfor Salsa20. The asymmetric algorithm (for ECC) has been swapped from Secp256k1 to\nSect233r1. Some updates around execution began to appear during this time as well, such\nas support for command line parameters.\n\nA few changes were noted in Samples 6 and 7. The main difference is the newly included\nbackground image. The file “background.jpg” is written to %TEMP% and set as the Desktop\nimage/wallpaper for the logged in user.\n\n\n-----\n\nDesktop image change and message\n\n## Malware Similarity Analysis\n\nFrom our analysis, we see similarities between JSWorm and the associated permutations of\nthat ransomware family such as NEMTY, Nefilim, and GangBang. Specifically, the Karma\ncode analyzed bears close similarity to the GangBang or Milihpen variants that appeared\naround January 2021.\n\n\n-----\n\nSome high-level similarities are visible in the configurations.\nWe can see deeper relationships when we conduct a bindiff on Karma and GangBang\nsamples. The following image shows how similar the `main() functions are:`\n\nThe `main() function & argument processing in Gangbang (left) and Karma`\n\n## Victim Communication\n\nThe main body of the ransom note text hasn’t changed since the first sample and still\ncontains mistakes. The ransom notes are base64-encoded in the binary and dropped on the\nvictim machine with the filename “KARMA-AGREE.txt” or, in later samples, “KARMAENCRYPTED.txt”.\n\n\n-----\n\n```\nYour network has been breached by Karma ransomware group.\nWe have extracted valuable or sensitive data from your network and encrypted the data\non your systems.\nDecryption is only possible with a private key that only we posses.\nOur group's only aim is to financially benefit from our brief acquaintance,this is a\nguarantee that we will do what we promise.\nScamming is just bad for business in this line of work.\nContact us to negotiate the terms of reversing the damage we have done and deleting\nthe data we have downloaded.\nWe advise you not to use any data recovery tools without leaving copies of the\ninitial encrypted file.\nYou are risking irreversibly damaging the file by doing this.\nIf we are not contacted or if we do not reach an agreement we will leak your data to\njournalists and publish it on our website.\nhttp://3nvzqyo6l4wkrzumzu5aod7zbosq4ipgf7ifgj3hsvbcr5vcasordvqd.onion/\nIf a ransom is payed we will provide the decryption key and proof that we deleted you\ndata.\nWhen you contact us we will provide you proof that we can decrypt your files and that\nwe have downloaded your data.\nHow to contact us:\n{[email protected]}\n{[email protected]}\n{[email protected]}\n\n```\nEach sample observed offers three contact emails, one for each of the mail providers\nonionmail, tutanota, and protonmail. In each sample, the contact emails are unique,\nsuggesting they are specific communication channels per victim. The notes contain no other\nunique ID or victim identifier as sometimes seen in notes used by other ransomware groups.\n\nIn common with other operators, however, the Karma ransom demand threatens to leak\nvictim data if the victim does not pay. The address of a common leaks site where the data will\nbe published is also given in the note. This website page appears to have been authored in\nMay 2021 using WordPress.\n\n\n-----\n\nThe Karma Ransomware Group’s Onion Page\n\n## Conclusion\n\nKarma is a young and hungry ransomware operation. They are aggressive in their targeting,\nand show no reluctance in following through with their threats. The apparent similarities to\nthe JSWorm family are also highly notable as it could be an indicator of the group being\nmore than they appear. The rapid iteration over recent months suggests the actor is investing\nin development and aims to be around for the foreseeable future. SentinelLabs continues to\nfollow and analyze the development of Karma ransomware.\n\n## Indicators of Compromise\n\n**SHA1s**\n\n**Karma Ransomware**\n\nSample 1: d9ede4f71e26f4ccd1cb96ae9e7a4f625f8b97c9\n\nSample 2: a9367f36c1d2d0eb179fd27814a7ab2deba70197\n\nSample 3: 9c733872f22c79b35c0e12fa93509d0326c3ec7f\n\nSample 4: c4cd4da94a2a1130c0b9b1bf05552e06312fbd14\n\nSample 5: bb088c5bcd5001554d28442bbdb144b90b163cc5\n\nSample 6: 5ff1cd5b07e6c78ed7311b9c43ffaa589208c60b\n\nSample 7: 08f1ef785d59b4822811efbc06a94df16b72fea3\n\nSample 8: b396affd40f38c5be6ec2fc18550bbfc913fc7ea\n\n**Gangbang Sample**\n\nac091ce1281a16f9d7766a7853108c612f058c09\n\n\n-----\n\n**Karma Desktop image**\n%TEMP%/background.jpg\n7b8c45769981344668ce09d48ace78fae50d71bc\n\n**Victim Blog (TOR)**\nhttp[:]//3nvzqyo6l4wkrzumzu5aod7zbosq4ipgf7ifgj3hsvbcr5vcasordvqd[.]onion/\n\n**Ransom Note Email Addresses**\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n[[email protected]](https://www.sentinelone.com/cdn-cgi/l/email-protection)\n\n**MITRE ATT&CK**\n[T1485 Data Destruction](https://attack.mitre.org/techniques/T1485/)\n[T1486 Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486/)\n[T1012 Query Registry](https://attack.mitre.org/techniques/T1012/)\n[T1082 System Information Discovery](https://attack.mitre.org/techniques/T1082/)\n[T1120 Peripheral Device Discovery](https://attack.mitre.org/techniques/T1120/)\n[T1204 User Execution](https://attack.mitre.org/techniques/T1204/)\n[T1204.002 User Execution: Malicious File](https://attack.mitre.org/techniques/T1204/002/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-18 - Karma Ransomware - An Emerging Threat With A Hint of Nemty Pedigree.pdf"
    ],
    "report_names": [
        "2021-10-18 - Karma Ransomware - An Emerging Threat With A Hint of Nemty Pedigree.pdf"
    ],
    "threat_actors": [
        {
            "id": "20c759c2-cd02-45bb-85c6-41bde9e6a7cf",
            "created_at": "2024-01-18T02:02:34.189827Z",
            "updated_at": "2025-03-27T02:02:09.937024Z",
            "deleted_at": null,
            "main_name": "HomeLand Justice",
            "aliases": [
                "Karma",
                "Storm-842",
                "Void Manticore"
            ],
            "source_name": "ETDA:HomeLand Justice",
            "tools": [
                "BABYWIPER",
                "BiBi Wiper",
                "BiBi-Linux Wiper",
                "BiBi-Windows Wiper",
                "Cl Wiper",
                "LowEraser",
                "No-Justice Wiper",
                "Plink",
                "PuTTY Link",
                "RevSocks",
                "W2K Res Kit"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535913,
    "ts_updated_at": 1743041364,
    "ts_creation_date": 1653780877,
    "ts_modification_date": 1653780877,
    "files": {
        "pdf": "https://archive.orkl.eu/2a9854870dea6158570d605280e08cceb93a9919.pdf",
        "text": "https://archive.orkl.eu/2a9854870dea6158570d605280e08cceb93a9919.txt",
        "img": "https://archive.orkl.eu/2a9854870dea6158570d605280e08cceb93a9919.jpg"
    }
}