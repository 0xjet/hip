{
    "id": "47f7abe5-30ea-4ea6-9de5-eb4d3d3b2dac",
    "created_at": "2023-01-12T15:07:35.409801Z",
    "updated_at": "2025-03-27T02:12:03.877699Z",
    "deleted_at": null,
    "sha1_hash": "b041b8245380d5fd53233b77e3ed1a6ecc940025",
    "title": "2021-03-02 - Multiple Security Updates Released for Exchange Server – updated March 8, 2021",
    "authors": "",
    "file_creation_date": "2022-05-28T23:09:42Z",
    "file_modification_date": "2022-05-28T23:09:42Z",
    "file_size": 102453,
    "plain_text": "# On-Premises Exchange Server Vulnerabilities Resource Center – updated March 25, 2021\n\n**[msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server](https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server)**\n\n**[MSRC / By](https://msrc-blog.microsoft.com/category/msrc/)** **[MSRC Team / March 2, 2021](https://msrc-blog.microsoft.com/author/sebastian-fernandez/)**\n\nOn March 2nd, we released several security updates for Microsoft Exchange Server to\naddress vulnerabilities that are being used in ongoing attacks. Due to the critical nature of\nthese vulnerabilities, we recommend that customers protect their organizations by\napplying the patches immediately to affected systems.\n\nThe vulnerabilities affect Exchange Server versions 2013, 2016, and 2019, while Exchange\nServer 2010 is also being updated for defense-in-depth purposes. Exchange Online is\nnot affected.\n\nThese vulnerabilities are being exploited as part of an attack chain. The initial attack requires\nthe ability to make an untrusted connection to the Exchange server, but other portions of the\nattack can be triggered if the attacker already has access or gets access through other\nmeans. This means that mitigations such as restricting untrusted connections or setting up a\nVPN will only protect against the initial portion of the attack to change the attack surface or\npartially mitigate, and that patching is the only way to mitigate completely.\n\nSince these patches were released, we have published several articles and blog posts\nhelping customers understand these vulnerabilities, and their exploitation patterns, and\nshared detailed guidance on how the malicious actors are exploiting these vulnerabilities and\ntargeting customers. We are aware that there is a lot of detail to understand and are adding\nthis summary of Microsoft’s guidance for security incident responders and Exchange\nadministrators on what steps to take to secure their Exchange environments.\n\nOrganizations should review and digest the entirety of this guidance before taking action, as\nthe specific order of actions taken to achieve the response objectives is situational and\ndepends on the outcomes of the investigation.\n\n## Executive Summary and Background Information\n\nMicrosoft continues to investigate the extent of the recent Exchange Server on-premises\nattacks. Our goal is to provide the latest threat intelligence, Indicators of Compromise (IOC)s,\nand guidance across our products and solutions to help the community respond, harden\ninfrastructure, and begin to recover from this unprecedented attack. As new information\n[becomes available, we will make updates to this article at https://aka.ms/ExchangeVulns](https://aka.ms/ExchangeVulns)\n\n\n-----\n\nMarch 25, 2021 – Analyzing attacks taking advantage of the Exchange Server\nvulnerabilities\n[March 25, 2021 – Web Shell Threat Hunting with Azure Sentinel](https://techcommunity.microsoft.com/t5/azure-sentinel/web-shell-threat-hunting-with-azure-sentinel/ba-p/2234968)\nMarch 18, 2021 – Automatic on-premises Exchange Server mitigation now in Microsoft\nDefender Antivirus\nMarch 16, 2021 – Guidance for responders: Investigating and remediating on-premises\nExchange Server vulnerabilities\n[March 15, 2021 –One-Click Microsoft Exchange On-premises Mitigation Tool](https://aka.ms/eomt)\nMarch 8, 2021 – [March 8 Exchange Team Blog](https://techcommunity.microsoft.com/t5/exchange-team-blog/march-2021-exchange-server-security-updates-for-older-cumulative/ba-p/2192020)\nMarch 5, 2021 – [Microsoft Exchange Server Vulnerabilities Mitigations](https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/)\nMarch 2, 2021 – [Microsoft Security Blog: Hafnium Targeting Exchange](https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/)\nMarch 2, 2021 – [Microsoft on the Issues](https://blogs.microsoft.com/on-the-issues/2021/03/02/new-nation-state-cyberattacks/)\nMarch 2, 2021 – [Exchange Team Blog](https://techcommunity.microsoft.com/t5/exchange-team-blog/released-march-2021-exchange-server-security-updates/ba-p/2175901)\n\n**Overview of the Attack and Exploitation**\n\nMicrosoft originally followed the adversary group HAFNIUM launching targeted attacks\nagainst specific organizations. Recently other adversary groups have started targeting these\nvulnerabilities, and we expect that these attacks will continue to increase as attackers\ninvestigate and automate exploitation of these vulnerabilities. Not all these footholds are\nbeing utilized immediately, and some were likely put in place for future exploitation. A\ndetailed overview is available here: HAFNIUM targeting Exchange Servers with 0-day\n_exploits – Microsoft Security_\n\nWhile some adversary groups are installing web shells as broadly as possible for future use,\nsome are also conducting further operations on compromised servers and attempting to\nmove laterally into organizations’ environments to establish deeper persistence. This\ndocument provides instructions to remediate web shells and determine the initial ingress of\nan adversary.\n\nOrganizations that have detected or suspect more advanced post exploitation activities, such\nas credential dumps, lateral movement, and installation of further malware/ransomware,\nshould consider enlisting the services of cybersecurity response professionals. Investigating\nand remediating post-exploitation across an IT environment is beyond the scope of this blog,\nbut we want organizations to understand where we recommend they begin their\ninvestigations based on the patterns of behavior we’ve seen associated with exploitation of\nthese vulnerabilities.\n\n**Recommended Response Steps**\n\nSuccessful response requires being able to communicate without the attacker eavesdropping\non your communications. Until you have achieved assurance of the privacy of your\ncommunications on your current infrastructure, use completely isolated identities and\n\n\n-----\n\ncommunication resources to coordinate your response and discuss topics that could\npotentially tip off the attacker to your investigation.\n\nSuccessful response should consist of the following steps:\n\n1. Deploy updates to affected Exchange Servers.\n\n1. Investigate for exploitation or indicators of persistence.\n\n1. Remediate any identified exploitation or persistence and investigate your environment\n\nfor indicators of lateral movement or further compromise.\n\nMicrosoft recommends that you update and investigate in parallel, but if you must prioritize\none, prioritize updating and mitigation of the vulnerability.\n\n**It is imperative that you update or mitigate your affected Exchange deployments**\n**immediately. These vulnerabilities are being actively exploited by multiple adversary groups.**\nFor the highest assurance, block access to vulnerable Exchange servers from untrusted\nnetworks until your Exchange servers are patched or mitigated. If you have not yet patched,\nand have not applied the mitigations referenced below, a one-click tool, the Exchange Onpremises Mitigation Tool is now our recommended path to mitigate until you can patch.\n\nIf you are an experienced IT professional or incident responder, review our Guidance for\nResponders post for more detailed recommendations that will be continually updated when\nMicrosoft has new information about responding to these attacks.\n\n**Deploy updates to affected Exchange Servers**\n\nIf you do not have an inventory of servers in your environments that run Exchange, you can\n[use the nmap script Microsoft has provided to scan your networks for vulnerable Exchange](https://github.com/microsoft/CSS-Exchange/blob/main/Security/http-vuln-cve2021-26855.nse)\n[deployments. For the Exchange servers in your environment, immediately apply updates for](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-march-2-2021-kb5000871-9800a6bb-0a21-4ee7-b9da-fa85b3e1d23b)\nthe version of Exchange you are running. While these Security Updates do not apply to\nExchange Online / Office 365, if you are in Hybrid mode you need to apply them to your onpremises Exchange Server, even if it is used for management purposes only. You do not\nneed to re-run (Hybrid Configuration Wizard) HCW if you are using it. The high-level\nsummary of our patching guidance is:\n\n**Exchange Online is not affected.**\n**Exchange 2003 and 2007 are no longer supported but are not believed to be affected**\nby the March 2021 vulnerabilities. You must upgrade to a supported version of\nExchange to ensure that you are able to secure your deployment against vulnerabilities\nfixed in current versions of Microsoft Exchange and future fixes for security issues.\n**[Exchange 2010 is only impacted by CVE-2021-26857, which is not the first step in the](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26857)**\nattack chain. Organizations should apply the update and then follow the guidance\nbelow to investigate for potential exploitation and persistence.\n\n\n-----\n\n**Exchange 2013, 2016, and 2019 are impacted. Immediately deploy the updates or**\napply mitigations described below. For help identifying which updates you need to get\nfrom your current CU version to a version with the latest security patches follow this\nguidance: Released: March 2021 Exchange Server Security Updates – Microsoft Tech\n[Community. You can use the linked Health Checker script here to help you identify](https://github.com/dpaulson45/HealthChecker#download)\nexactly which CUs are needed for your deployment. Microsoft has also released\nadditional Security Updates for select older Exchange CUs to accelerate their path to\npatched for these vulnerabilities.\n\n**Mitigations: If for some reason you cannot update your Exchange servers immediately, we**\nhave released instructions for how to mitigate these vulnerabilities through reconfiguration.\nWe recognize that applying the latest patches to Exchange servers may take time and\nplanning, especially if organizations are not on recent versions and/or associated cumulative\nand security patches. We recommend prioritizing installing the patches on Exchange Servers\nthat are externally facing first, but all affected Exchange Servers should be updated urgently.\nThe Mitigations suggested are not substitutes for installing the updates and will impact\nsome Exchange functionality while in place. Detailed guidance on applying the alternate\nmitigations is provided here:Microsoft Exchange Server Vulnerabilities Mitigations – March\n_2021._\n\nApplying the update or the alternative mitigation techniques will not evict an adversary who\nhas already compromised your environment. The remainder of this document shares\nguidance to help you determine whether your Exchange servers were exploited before\nmitigating the issue and how to remediate some types of attacks.\n\n**Investigate for exploitation, persistence, or evidence of lateral movement**\n\nIn addition to protecting your Exchange servers from exploitation, you should assess to\nensure that the vulnerabilities were not exploited before you got them to a protected state.\n\n1. Analyze the Exchange product logs for evidence of exploitation. Microsoft\n\nreleased detailed steps here including scripts to help automate: Scan Exchange log\n_files for indicators of compromise. If you choose to use the script provided, you will_\nhave an option to scan some or all of your Exchange servers at the same time.\n\n1. Scan for known web shells. The Microsoft Defender team has included security\n\nintelligence for known malware related to these vulnerabilities in the latest version of\nthe [Microsoft Safety Scanner. Run this Safety Scanner on every Exchange server in](https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/safety-scanner-download)\nyour environment. If you need assistance, detailed guidance can be found here: CSSExchange/Defender-MSERT-Guidance.md at main · microsoft/CSS-Exchange · GitHub\n\nFor Microsoft Defender and Microsoft Defender for Endpoint customers, please make sure\nyou are on the latest security intelligence patch: Latest security intelligence patches for\n\n\n-----\n\n_Microsoft Defender Antivirus and other Microsoft antimalware – Microsoft Security_\n_Intelligence_\n\n1. Use the Microsoft IOC feed for newly observed indicators. To aid defenders in\n\ninvestigating these attacks where Microsoft security products and tooling may not be\ndeployed, we are releasing a feed of observed indicators of compromise (IOCs). The\nfeed of malware hashes and known malicious file paths observed in related attacks is\navailable in both JSON and CSV formats at the below GitHub links. This information is\nbeing shared as TLP:WHITE (free for all to use)\n\n**[CSV format](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/MSTICIoCs-ExchangeServerVulnerabilitiesDisclosedMarch2021.csv)**\n**[JSON format](https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample%20Data/Feeds/MSTICIoCs-ExchangeServerVulnerabilitiesDisclosedMarch2021.json)**\n\n1. Leverage other organizational security capabilities in addition to these tools. The\n\ntools above make the threat intelligence that Microsoft has been accumulating related\nto exploitation of these vulnerabilities available to all organizations. Your organization\nmay also have its own security controls, and we recommend that you increase your\nvigilance on signals from Exchange servers in your current security controls too.\n\n**Remediate any identified exploitation or persistence**\n\nIf you find any evidence of exploitation (e.g., in Exchange application logs), ensure you are\nretaining the logs, and use the details such as timestamps and source IPs to drive further\ninvestigation.\n\nIf you find known bad files using your endpoint security solution, the Microsoft IOC feed, or\nthe Microsoft Safety Scanner, take the following actions:\n\n1. Remediate and quarantine them for further investigation unless they are expected\n\ncustomizations in your environment.\n\n1. Search your IIS logs to identify whether or not the files identified as malicious have\n\nbeen accessed.\n\n1. Consider submitting suspected malicious files to Microsoft for analysis following this\n\n[guidance: Submit files for analysis by Microsoft – Windows security | Microsoft Docs](https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/submission-guide)\nand include the string “ExchangeMarchCVE” in the Additional Information text box of\nthe submission form.\n\nAs part of hunting and scanning, if you find evidence of exploitation of the Unified Messaging\nRCE (CVE-2021-26857), you should delete potential uncleaned exploit files in\n%ExchangeInstallPath%\\UnifiedMessaging\\voicemail\n\n\n-----\n\nIf you find any evidence of external access to a suspect file identified above, use this\ninformation to drive further investigation on impacted servers and across your environment.\nOur blog post on the Hafnium attack goes into details for folks who need additional details for\nIOC’s, File Hashes, etc.: HAFNIUM targeting Exchange Servers with 0-day exploits –\nMicrosoft Security\n\nIf any of your security detections or the investigation tools results lead you to suspect that\nyour Exchange servers have been compromised and an attacker has actively engaged in\nyour environment, execute your Security Incident Response plans, and consider engaging\nexperienced Incident Response assistance. It is particularly critical if you suspect that your\nExchange environment is compromised by a persistent adversary that you coordinate your\nresponse using alternative communications channels as mentioned earlier in this document.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-02 - Multiple Security Updates Released for Exchange Server – updated March 8, 2021.pdf"
    ],
    "report_names": [
        "2021-03-02 - Multiple Security Updates Released for Exchange Server – updated March 8, 2021.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536055,
    "ts_updated_at": 1743041523,
    "ts_creation_date": 1653779382,
    "ts_modification_date": 1653779382,
    "files": {
        "pdf": "https://archive.orkl.eu/b041b8245380d5fd53233b77e3ed1a6ecc940025.pdf",
        "text": "https://archive.orkl.eu/b041b8245380d5fd53233b77e3ed1a6ecc940025.txt",
        "img": "https://archive.orkl.eu/b041b8245380d5fd53233b77e3ed1a6ecc940025.jpg"
    }
}