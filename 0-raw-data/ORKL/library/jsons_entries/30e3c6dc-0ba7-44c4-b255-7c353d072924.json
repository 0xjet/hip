{
    "id": "30e3c6dc-0ba7-44c4-b255-7c353d072924",
    "created_at": "2023-01-12T15:01:24.210125Z",
    "updated_at": "2025-03-27T02:05:29.861683Z",
    "deleted_at": null,
    "sha1_hash": "aa78833eb9484a95c64510bdaa46dcb5755ae809",
    "title": "2021-01-23 - Deep Dive Into SectopRat",
    "authors": "",
    "file_creation_date": "2022-05-25T14:18:43Z",
    "file_modification_date": "2022-05-25T14:18:43Z",
    "file_size": 949989,
    "plain_text": "# Deep Dive Into SectopRat\n\n**[vxhive.blogspot.com/2021/01/deep-dive-into-sectoprat.html](https://vxhive.blogspot.com/2021/01/deep-dive-into-sectoprat.html)**\n\nHello World, In this Article we will gonna look through a newly version of SectopRat Its\n[written in Dotnet So It wasn't so hard. Thanks for @Arkbird and JAMESWT For Their](https://twitter.com/Arkbird_SOLG/status/1348288375904722945)\nOriginal Tweets.\n\n## Quick Introduction:\n\n[SectopRat is a RAT Tool was Firstly Discovered by MalwareHunterTeam in November](https://twitter.com/malwrhunterteam/status/1195288774957244416)\n15,2019 It has capabilities like connecting to C2 Server, Profiling the System, Steal Browser\nHistory From Browsers like Chrome and Firefox, It Sends Stolen User Data in a Json File.\n\n## In Depth Reversing:\n\nSectop Weapozies WMI (Windows Management Instrumentation) in Order to Collect System\nInformation.\n\nHere it Gets OS Name and Version:\n\nSectop Has a Class named \"GetSystemInfo\" that Implements most of its System Profiling.\n\n\n-----\n\nIt Collects:\n. OS Name and Version\n. Graphics Card Name and Vram Size\n. CPU Version and Number Of Cores\n. Physical Memory Size\n. Mac Address\n\nOther Things It Collects Like Screen Resolution:\n\nSectop Also Steals Browser History From Browsers like Chrome and FireFox.\n\n\n-----\n\nHere it Opens \"%LocalAppData%\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\"\nwhich Contains the websites u visited, usernames and emails u used while browsing these\nsites.\n\nHere They Learnt a Lesson From Their Past Sample They Actually Learnt How To Use\nEnvironment Variables xD Since in Earlier Samples The Browser Paths were Hardcoded in\nthe Binary which actually limited this Functionality.\n\nThey Used This Regex In Order to Filter and Get the Info They Need:\n\n(\"(http|ftp|https):\\\\/\\\\/([\\\\w\\\\-_]+(?:(?:\\\\.[\\\\w\\\\-_]+)+))([\\\\w\\\\-\\\\.,@?\n^=%&amp;:/~\\\\+#]*[\\\\w\\\\-\\\\@?^=%&amp;/~\\\\+#])?\")\n\nSectop Has a Function Called \"BrowserLogging\" Which Basically Sends To The C2 Server The\nActions It Do On Browsers\n\nExample Here It Starts Chrome using Command Line Parameters Shown And Then sends to\nServer That it gonna Start Google Chrome using cmd:\n\n\n-----\n\nAs We Said it Also Steals Info from FireFox\n\nAccording To [Mozilla Zine:](http://kb.mozillazine.org/Profile_folder)\n\nMozilla applications store a user's personal information in a unique profile. The first time you\nstart any Mozilla application, it will automatically create a default profile; additional profiles\n[can be created using the Profile Manager. The settings which form a profile are stored in files](http://kb.mozillazine.org/Profile_Manager)\nwithin a special folder on your computer â€” this is the profile folder. The installation\ndirectory also includes a \"profile\" folder but this folder contains program defaults, not your\nuser profile data.\n\nSo It Bassicly Retrieves the content of this file and then send data to server saying that its\nfetching the user profile !.\n\nThe C2 Connection Is TCP/IP Connection\n\n\n-----\n\nIt Connects To IP 54.194.254.16 on Port 15647\n\nFor Encrypting The Sended Data It Uses AES\n\nSectop C2 Commands Depends on Packet Types\n\n\n-----\n\nThese Packet Types Are Then Handled by Another Function \"HandlePackets\"\n\nSo Let's Go Step By Step :)\n\nStartStream = Creates a New Desktop Session with Name \"sdfsddfg\":\n\nIt First Checks if its already Created So It Just Opens It Else It Creates It.\n\n\n-----\n\nAlso It Starts Chrome using cmd.exe /C start chrome.exe about:blank --new-window\nCreating New Window and Starts FireFox using /C start firefox.exe --newwindow https://github.com\n\nI Don't Have Any Idea Why He Does That With FireFox this opens on the main page of\ngithub Fuck I got bored from this dumb code xD.\n\nStop Stream = Stops The Desktop Session\n\nDoMouseEvent = Emulates Mouse Presses\n\nDoKeyboardEvent = Emulates Keyboard Presses\n\nStartBrowser = Handled By InitBrowser Function It Takes in a Parameter and does a switch\ncase on it:\n\nSo Bassicly Here It Runs The Calls The Functions That Steal the Browser Data\n\nCase 4 it Starts Internet Explorer Its Hidden and Executed in the Desktop Session It Created\n\n\n-----\n\nDiskonect = Shuts Down The C2 Connection\n\nSetCodecInfo = He Forgetted Handling it xD\n\nCaptureInit = Starts A Socket on Local Host on Port 80 (I Swear He is 12)\n\nSetPubIp = Changes C2 Server IP\n\nSectop Sends the Connection Type Info For The C2 as Json Typical Thing For Most RATs So\nIt Can Be Viewed in the Server GUI:\n\nBotName = UserName\nBuildID = Its Set to \"Build 1\"\n\n\n-----\n\nBotOS = Operating System\nURLData = User Visited URLs\nUIP = Public IP Address\n\n## IOC's:\n\n**Hashes:**\n\nMD5: AC617590F4295B4E4808C488CD19E9F9\n\nSHA1: 03572EBD5C37D0839BE360B46FBEED26A4A5F78E\n\nSHA256:\n0C2C45EE6F09774E00325A951F21DD4D515B0C62B63AC8FF1712E0DD2F73B262\n\n**C2:**\n\n[54.194.254.16:15647 (Ireland Dublin, Leinster)](https://www.virustotal.com/gui/ip-address/54.194.254.16)\n[172.217.12.238:80 (United States)](https://www.virustotal.com/gui/ip-address/172.217.12.238)\n\n## Other:\n\nPDB Path: d:\\arechsoftret1\\hhfghg\\obj\\x86\\release\\hjghjg.pdb\n\n## References:\n\nhttps://www.gdatasoftware.com/blog/2019/11/35548-new-sectoprat-remote-accessmalware-utilizes-second-desktop-to-control-browsers (Analysis for an old Sample)\n\n## Deep Dive Into HERMES Ransomware\n\n Intro to Malware Traffic Analysis\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-23 - Deep Dive Into SectopRat.pdf"
    ],
    "report_names": [
        "2021-01-23 - Deep Dive Into SectopRat.pdf"
    ],
    "threat_actors": [
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535684,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653488323,
    "ts_modification_date": 1653488323,
    "files": {
        "pdf": "https://archive.orkl.eu/aa78833eb9484a95c64510bdaa46dcb5755ae809.pdf",
        "text": "https://archive.orkl.eu/aa78833eb9484a95c64510bdaa46dcb5755ae809.txt",
        "img": "https://archive.orkl.eu/aa78833eb9484a95c64510bdaa46dcb5755ae809.jpg"
    }
}