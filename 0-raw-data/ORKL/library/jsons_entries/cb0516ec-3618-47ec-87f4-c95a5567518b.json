{
    "id": "cb0516ec-3618-47ec-87f4-c95a5567518b",
    "created_at": "2023-01-12T15:02:12.211471Z",
    "updated_at": "2025-03-27T02:16:25.748967Z",
    "deleted_at": null,
    "sha1_hash": "46c062c5bd3a4ef5c7042d91dc31dcce40d96c2d",
    "title": "2022-10-13 - BianLian Ransomware Encrypts Files in the Blink of an Eye",
    "authors": "",
    "file_creation_date": "2022-11-28T18:53:50Z",
    "file_modification_date": "2022-11-28T18:53:50Z",
    "file_size": 1962688,
    "plain_text": "# BianLian Ransomware Encrypts Files in the Blink of an Eye\n\n**[blogs.blackberry.com/en/2022/10/bianlian-ransomware-encrypts-files-in-the-blink-of-an-eye](https://blogs.blackberry.com/en/2022/10/bianlian-ransomware-encrypts-files-in-the-blink-of-an-eye)**\n\nThe BlackBerry Research & Intelligence Team\n\nMinutes make the difference to defenders in responding to a ransomware attack on a\nvictim’s network. BianLian ransomware raises the cybercriminal bar by encrypting files with\nexceptional speed.\n\nThreat actors built the new BianLian ransomware in the Go programming language (aka\nGolang). Despite the large size of files created in Go, threat actors are turning to this\n[“exotic” programming language more often for a variety of reasons, particularly its robust](https://blogs.blackberry.com/en/2021/07/old-dogs-new-tricks-attackers-adopt-exotic-programming-languages)\nsupport for concurrency. This is the ability for various malicious functions to run\nindependently of each other, which speeds up the attack.\n\nIn addition to an overview of the BianLian ransomware, this post also highlights some of the\nunique aspects of Golang that makes it an increasingly popular choice for malware authors.\n\n### Operating System\n\n\n-----\n\n### Risk & Impact\n\n What is BianLian?\n\n[Bian Lian is an ancient dramatic art that originates in China. Artists move about the stage in](https://en.wikipedia.org/wiki/Bian_lian)\nbrightly colored outfits and colored masks. The performers are so quick to change the\nmasks that, with the swipe of a fan or the blink of an eye, their costume’s face completely\nchanges. We can now add a new meaning to the term “Bian Lian,” because a ransomware\ngroup took the name and made it their own.\n\nResearch from [Cyble found that this threat group targets many different industry sectors.](https://blog.cyble.com/2022/08/18/bianlian-new-ransomware-variant-on-the-rise/)\nTheir targets have historically included manufacturing, education, healthcare, professional\nservices, energy, banking, financial services, and insurance (BFSI), and the entertainment\nindustry.\n\nAs of September 20, 2022, the group’s leak site includes 23 victims. BlackBerry researchers\nanalyzed the list of victims and determined that this group targets corporations rather than\nspecific countries. The listed victims have varied origins, including the United States,\nAustralia, and the United Kingdom.\n\nWhy do these operators target English-speaking countries? It’s likely the threat actor is\nfinancially motivated rather than politically or geographically orientated. And at this point,\nthe group has not claimed any affiliation with any nation state or agenda.\n\nBianLian ransomware shares its name with a malicious Android package (APK) application\nthat was previously hosted on the Google Play™ store, but it has since been removed. This\n[malicious application was also dubbed “BianLian” by ThreatFabric.](https://www.threatfabric.com/blogs/bianlian_from_rags_to_riches_the_malware_dropper_that_had_a_dream.html)\n\nThis identically named malware used a dropper from the Google Play store to install a\n[malicious file from the infamous Anubis Banker Trojan. From there, the threat actor would](https://www.bleepingcomputer.com/news/security/anubis-android-malware-returns-to-target-394-financial-apps/)\nuse a messaging service to deliver command-and-control (C2) commands and steal user\ncredentials. At the time of writing, no one has claimed any relation between these two\nmalware families aside from the name they’ve been given.\n\n\n-----\n\n### Go For Speed in Malware\n\n[BianLian ransomware is written in Golang. As we discussed in a recent whitepaper, Golang](https://blogs.blackberry.com/en/2021/07/old-dogs-new-tricks-attackers-adopt-exotic-programming-languages)\nis an open-source programming language designed by Google employees. The language’s\nofficial first release was in March 2012, and it quickly became a mainstay language for large\nindustry organizations such as Apple, Google, and IBM.\n\nGolang comes with a large standard library, garbage collection cleanup, and concurrency\nsupport. Concurrency means that multiple computations can take place at the same time\n[through a process called multithreading. To enable this, Go uses “Goroutines\", which allow](https://golangbot.com/goroutines/)\nfor asynchronous execution of functions or methods independently from each other. This\nconcurrency allows for quicker encryption of the target system.\n\nGo can compile code for Windows®, Linux®, and OS X®. This feature makes it possible for\nmalware authors to create threats that impact all the major operating systems, if they\nchoose to.\n\nGo libraries are statically linked, which means all the necessary libraries are included in the\ncompiled binary. In languages where this is not the case, developers will either include the\nlibraries separately from the main executable, or they will have to hope that the target\nmachine has the needed libraries already installed on their machine. Including these\nlibraries makes for a larger file that is harder to distribute, but larger files might also be\nignored by antivirus (AV) engines that are trying to optimize for speed.\n\n### Technical Analysis of BianLian Ransomware\n\nThe sample we will be analyzing in this post is named anabolic.exe (SHA256:\n46d340eaf6b78207e24b6011422f1a5b4a566e493d72365c6a1cace11c36b28b). This file is\na 64-bit executable compiled with Golang version 1.18.3.\n\nWhen a Golang program is built, it generates a BuildID. A BuildID in Golang is a unique\nrepresentation of the file and its contents. The BuildID is in the first 32 kb of the binary file,\nthough the exact position can vary depending on the operating system it’s compiled for. The\nfile in focus here is a portable executable (PE) file.\n\nLooking closer, a BuildID is comprised of a hash of the filenames and the contents of the\napplication, and it is segmented into two parts: actionID and ContentID. The actionID is a\nhash of the inputs that produced the packages or binary, and the contentID is the hash of\nthe action output. This action output is the binary itself. The buildID of anabolic.exe is\nshown below in Figure 1.\n\n_Figure 1: Build ID from_\n_46d340eaf6b78207e24b6011422f1a5b4a566e493d72365c6a1cace11c36b28b_\n\n\n-----\n\nThe command used to compile the program is also stored in the binary. To compile a\nprogram with Go, you use the “Go build” command. This command compiles all the\npackages and dependencies necessary for the application.\n\nFor the sample we’re analyzing in this blog, this build path was given two arguments, shown\nbelow in Figure 2. The argument commands given are gcflags and trimpath. -Gcflags\nrelates to flags passed to the compiler, and -trimpath removes all absolute file system paths\nfrom the executable. This is an attempt to remove user path directories.\n\nIt’s useful to note the last part of the path here: “crypt22.” This can mark iterations of\ndevelopment from the actor, as this number has changed between samples in the wild.\n\n_Figure 2: Crypt project path_\n\nThe author packaged all the ransomware's functionalities into a common package. A\npackage is a collection of source files in the same directory that are compiled together.\n[Static analysis of the strings in pestudio provides us with an idea of what the sample’s](https://www.winitor.com/)\ncapabilities are.\n\nFrom this information, we can see it will likely rename files, and it can also chunk files into\nsmaller blocks for processing, query drive information, and check file extensions. Project\npathing for this functionality is shown in Figure 3.\n\n\n-----\n\n_Figure 3. Common package functions_\n\nUpon execution of the file, the application searches the host machine for all possible drive\n[names. To do this, the ransomware uses GetDriveTypeW from the kernell32 library. This](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getdrivetypew)\n[functionality is accessed via the GetProcAddress API call, which retrieves the address of](https://learn.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress)\nthe function. The purpose of this action is to ensure that the ransomware can encrypt all\nconnected or potential media. The call starts from “A:\\\\” and checks all the way to “Z:\\\\.”\n\nDebugger output demonstrating a snippet of this activity is shown in Figure 4.\n\n_Figure 4. GetDriveTypeW call with drives_\n\nOnce all the drives are populated, the threat begins its ransom process. The ransomware\n[encrypts files using the standard library crypto package in Go. These packages are open-](https://pkg.go.dev/crypto)\nsource libraries used to provide cryptographic functionality, like the base CryptoAPI\nprovided in Windows environments.\n\n### BianLian Ransomware Note and Demands\n\n\n-----\n\nThe ransomware drops a .TXT file into the directory where the file was run, named Look at\nthis instruction.txt.” The ransom note is shown in its entirety in Figure 5.\n\nThis text file contains information regarding how to contact the threat actor to restore your\ndata. To contact the threat actors, victims can either download the peer-to-peer encrypted\nchat service application Tox messenger, or they can email the group directly.\n\nThe threat actor gives their victims 10 days before publicly releasing their stolen data on the\noperator’s “.onion” site. The note does not indicate how much money the threat actors want\nfor payment.\n\n_Figure 5. BianLian ransom note_\n\nFrom here, this process is repeated in multiple threads to ensure a speedy encryption.\n\nThe ransomware targets any drive found on the system, including mounted drives, and\nencrypts anything that is not an executable, driver, or text file. These exclusions are meant\nto avoid encrypting either the ransom note, or anything that might cause the system to\nmalfunction. The excluded files types are located within their directories by using\n[FindFirstFileW and](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-findfirstfilew) [FindNextFileW. The lpFindFileData return value holds the information](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-findnextfilew)\non the directory found, and FindNextFileW is used to step through the files returned with\nFindFirstFileW.\n\nThe files are cut into small chunks and the encryption is multithreaded to increase the\nspeed of this operation. Figure 6 shows a snapshot of the read/write execution steps the\nransomware takes to encrypt the files on the system. The output shows the read/write\nlength of the buffer at 16 bytes, which is kept consistent throughout the execution of the file.\nAfter encryption, filenames are appended with a “.bianlian” extension and closed.\n\n\n-----\n\n_Figure 6. Ransomware read/write procmon_\n\nWe did not observe any network interaction in this sample. This means the threat actor\ncould have deployed the sample directly on the system with remote access.\n\n[As highlighted by cybersecurity services firm called [redacted], it is likely the BianLian threat](https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/)\ngroup’s initial access is gained via the ProxyShell vulnerability chain or a SonicWall VPN\nfirmware vulnerability. From here, the threat actor moves laterally to find targets of interest,\nescalates their privileges, and deploys the BianLian ransomware. Then, using dropped\ncopies of WinSCP and 7-Zip to archive and transfer chosen files, data is extracted and sent\nback to the threat actor. Additionally, threat operators might install backdoors on the\nsystems to maintain access to the infected system.\n\n### Conclusion\n\nBianLian is a relatively new threat actor that targets a wide range of industries. As they are\nlikely financially motivated, they will continue their efforts to exploit systems and networks\nthey gain access to. Their Golang-based ransomware utilizes goroutines and encrypts files\nin chunks to quickly ransom an infected system. The threat actor targets multiple industries\nin multiple countries. Their deployment method is manual infiltration of the system, and they\nuse living-off-the-land (LotL) binaries to explore the networks and systems themselves.\nOnce they find all the information they want, they deploy their ransomware.\n\n### Who is Targeted by BianLian Ransomware?\n\nTo date, this ransomware group has targeted the following industries: professional services,\nmanufacturing, healthcare, energy, media, banks, and education sectors. Their targets thus\nfar reside in the United States, Australia, and the United Kingdom. There is no indication\nthat they are necessarily limited to these industries or countries.\n\n### Mitigation Tips\n\n\n-----\n\n**File Carving** [(D3-FC) – Use the file carving technique to examine files sent over the](https://d3fend.mitre.org/technique/d3f:FileCarving/)\nnetwork.\n\n**File Access Pattern Analysis** [(D3-FAPA) – Identify the way an application accesses files;](https://d3fend.mitre.org/technique/d3f:FileAccessPatternAnalysis/)\ntarget could be the multiple read/writes on files that ransomware employs.\n\n**Remote Terminal Session Detection** [(D3-RTSD) – Detect unauthored remote sessions](https://d3fend.mitre.org/technique/d3f:RemoteTerminalSessionDetection/)\nthrough network traffic.\n\n**File Creation Analysis** [(D3-FCA) – Ransomware creates ransom notes; this behavior can](https://d3fend.mitre.org/technique/d3f:FileCreationAnalysis/)\nbe detected.\n\n### YARA Rule for BianLian Ransomware\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\nrule BianLian_Go_Ransomware{\n\nmeta:\n\ndescription = \"Detects BianLian ransomware\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2022-09-13\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to the\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n\n$s1 = \"trimpath=/home/jack/Projects/project1/\"\n\n$s2 = \"common.BuildPath\"\n\n$s3 = \"common.GetBlocksAmount\"\n\n$s4 = \"common.GetDrives\"\n\n$s5 = \"common.GetBlockSize\"\n\n$s6 = \"common.FileRename\"\n\n$s7 = \"common.GetFileExtension\"\n\n$s8 = \"exec.(*Cmd).Start.func1\"\n\n$s9 = \"exec.(*Cmd).Start.func2\"\n\n$s10 = \"exec.(*Cmd).Start.func3\"\n\n$s11 = \"CryptBlocks\"\n\ncondition:\n\nuint16(0) == 0x5a4d and all of them\n\n}\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n46d340eaf6b78207e24b6011422f1a5b4a566e493d72365c6a1cace11c36b28b\n\n117a057829cd9abb5fba20d3ab479fc92ed64c647fdc1b7cd4e0f44609d770ea\n\n1fd07b8d1728e416f897bef4f1471126f9b18ef108eb952f4b75050da22e8e43\n\neaf5e26c5e73f3db82cd07ea45e4d244ccb3ec3397ab5263a1a74add7bbcb6e2\n\ncbab4614a2cdd65eb619a4dd0b5e726f0a94483212945f110694098194f77095\n\n### References\n\n_[Redacted blog: https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/](https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/)_\n\n_[Cyble: https://blog.cyble.com/2022/08/18/bianlian-new-ransomware-variant-on-the-rise/](https://blog.cyble.com/2022/08/18/bianlian-new-ransomware-variant-on-the-rise/)_\n_[Go.dev documentation: https://go.dev/src/cmd/go/internal/work/buildid.go](https://go.dev/src/cmd/go/internal/work/buildid.go)_\n\n_[Go Routines: https://golangbot.com/goroutines/](https://golangbot.com/goroutines/)_\n\n_[Go.dev Crypto Documentation: https://pkg.go.dev/crypto](https://pkg.go.dev/crypto)_\n\n_[Microsoft Documentation: https://learn.microsoft.com/en-us/](https://learn.microsoft.com/en-us/)_\n\n_ThreatFabric:_\n_https://www.threatfabric.com/blogs/bianlian_from_rags_to_riches_the_malware_dropper_th_\n_at_had_a_dream.html_\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n**Related Reading**\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-13 - BianLian Ransomware Encrypts Files in the Blink of an Eye.pdf"
    ],
    "report_names": [
        "2022-10-13 - BianLian Ransomware Encrypts Files in the Blink of an Eye.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535732,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1669661630,
    "ts_modification_date": 1669661630,
    "files": {
        "pdf": "https://archive.orkl.eu/46c062c5bd3a4ef5c7042d91dc31dcce40d96c2d.pdf",
        "text": "https://archive.orkl.eu/46c062c5bd3a4ef5c7042d91dc31dcce40d96c2d.txt",
        "img": "https://archive.orkl.eu/46c062c5bd3a4ef5c7042d91dc31dcce40d96c2d.jpg"
    }
}