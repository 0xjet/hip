{
    "id": "82161b2d-2cf8-4378-8ddf-2b1c004b29c1",
    "created_at": "2023-01-12T15:07:44.119108Z",
    "updated_at": "2025-03-27T02:09:17.91972Z",
    "deleted_at": null,
    "sha1_hash": "4d5ddc5169f1ff0fe2a593319e2e59fc1820b94e",
    "title": "2020-08-20 - Revealing REvil Ransomware With DomainTools and Maltego",
    "authors": "",
    "file_creation_date": "2022-05-27T19:07:37Z",
    "file_modification_date": "2022-05-27T19:07:37Z",
    "file_size": 173051,
    "plain_text": "# Revealing REvil Ransomware With DomainTools and Maltego\n\n**[domaintools.com/resources/blog/revealing-revil-ransomware-with-domaintools-and-maltego](https://www.domaintools.com/resources/blog/revealing-revil-ransomware-with-domaintools-and-maltego)**\n\n## Looking at a Recent REvil (AKA Sodinokibi) Ransomware Indicator Set in Maltego Using the DomainTools Transforms\n\n[According to a recent report by Symantec Enterprise Security, the REvil ransomware](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sodinokibi-ransomware-cobalt-strike-pos)\noperators have been seen leveraging Cobalt Strike and scanning for vulnerable Point-ofSale systems. The attackers are utilizing a mixture of AWS CloudFront for C2 and Pastebin\nfor storing their payloads. Leveraging legitimate services here makes it difficult for incident\nresponders to react as any number of things may rapidly shift as infrastructure can be\nquickly spun up, torn down, and modified on cloud services with a host of modern\nconfiguration management tooling. However, the report included three IP addresses that\ncan be investigated to provide more insight. With ransomware on the rise again, it’s\nimportant to do proper due diligence to see what else one can discover behind this single\ninstance. I’ll do so by leveraging the DomainTools data set and Maltego to visually map out\nmy research.\n\nFirst, the domains and IP addresses released in the report were:\n\n102.129.224[.]148\n\n\n-----\n\n23.81.143[.]21\n\n5.101.0[.]202\n\nd2zblloliromfu.cloudfront[.]net\n\nAlthough not directly mentioned in the report, it is helpful to time gate when this attack\noccurred to limit the scope of research. Since cloud services can shift at any moment (and\nindeed that CloudFront address for instance has had hundreds of allocations since January\n2020), placing a barrier around the research will help separate signals from noise. As this\nreport was released in late June 2020, I’m going to assume that the attacks took place after\nApril of 2020. The reason I’m choosing this date is due to a bit of domain knowledge as a\n[security professional: there are multiple reports that came out during the height of COVID-](https://www.microsoft.com/security/blog/2020/04/01/microsoft-works-with-healthcare-organizations-to-protect-from-popular-ransomware-during-covid-19-crisis-heres-what-to-do/)\n19 that indicated the group behind REvil were leveraging COVID-19-themed lures and\nattacking medical infrastructure with great effect. I can make an educated guess that at\nleast one associate has shifted their targets now that the effectiveness of those lures is\ndrying up.\n\n[An additional note before I begin: REvil samples usually contain thousands of domains](https://blog.intel471.com/2020/03/31/revil-ransomware-as-a-service-an-analysis-of-a-ransomware-affiliate-operation/)\nused for C2, many unregistered and suspected decoys. The group is advanced in that there\nare a swath of methods used for exploiting victims and moving laterally in victim’s networks\nwith more than a dozen tools used to do so. They adapt their techniques for each\norganization they attack and evolve with each unique campaign. If you are looking to track\nREvil beyond understanding a single campaign event then I would suggest reading KPN’s\n[excellent write-up on tracking the group across hundreds of individual campaigns. If you are](https://www.kpn.com/security-blogs/Tracking-REvil.htm)\nlooking for a write-up of how a singular sample works I cannot recommend McAfee’s\nanalysis enough.\n\n### Investigating with Iris and Maltego\n\nSo to start, I’ll import these four entities from the report into Maltego. The paste function\ndoes a good job here of figuring out what types of entities these are.\n\n\n-----\n\nFrom there I’ll run a reverse lookup, marked under the DomainTools Iris transforms as “IP\nAddress to Domain” to get several domains to begin our searching.\n\nFrom a quick look at the entity details brought in from the Iris transforms I noticed that the\ndomains in the CN TLD are all from 2016 and before. Since I’m time gating our investigation\nI’ll take a look at just the doomvoid[.]com domain then. Running that through the Farsight\n\n\n-----\n\nPassive DNS transform, I get a number of suspicious domains that fall within the time\nconstraints.\n\nThe fact that this domain is running its own nameservers is suspicious enough with how\noften nameservers are now used for C2 signaling. The vedit-setfacl is interesting as that\nreferences in setfacl a Linux command used to set file access control lists and seems an\nodd error or perhaps a command mistype that ended up being picked up by a recursive\nresolver’s passive DNS sensor. Outside of those, both the abelian-don and mil-monstrous\nsubdomains seem the most suspicious. Polling Farsight again for A records linked to those\nsubdomains, I get two new IP addresses for this investigation.\n\n\n-----\n\nOut of those two new addresses, the only one that returns any additional context in our time\nframe is the 5[.]101[.]0[.]206 address which I can pull a domain vila[.]website from using the\nIris Investigate transform once again. This site, registered in May of 2020 through reg.ru\nhad a DomainTools Risk score of 93 out of 99 with a high chance of malware. This\nalgorithm takes into account nearby domains, infrastructure this domain sits on, and its\nhistory to determine the likelihood of its potential for maliciousness. 93 is considered a very\nhigh likelihood from the DomainTools machine learning classifiers. This may be in part due\nto the IP addresses associated existing on the Petersburg Internet Network, a Russiabased ISP located in Saint Petersburg from which malicious traffic has been observed in\nthe past. Knowing that the REvil group is suspected to be Russia based, the high likelihood\nof malicious traffic from this network, and our timeframe I can do a search for all Farsight\nPassive DNS query sets in that time frame for a[.]vila[.]website and I’ll get back four IPs in\ntotal.\n\n\n-----\n\n5.8.54[.]52\n\n5.101.0[.]206\n\n5.8.55[.]43\n\n5.101.6[.]227\n\nFrom here, outside of these IP addresses being on the same network as our original\nindicators, unfortunately, I cannot do much more to tie these to additional indicators or past\nreports. From this point, I can see that all of the IPs were likely linked during the same\ntimeframe, but all there is left to do is monitor for maliciousness.\n\nWith each REvil associate and attack being well contained and with some instances being\nhosted on constantly shifting cloud infrastructure it’s important to become adept at mapping\nout an attack as quickly as possible in some visual form that can be passed along to\nleadership. Leveraging Maltego, the Iris Investigate transform, and other transforms at my\ndisposal I can rapidly build out a report in Maltego for export.\n\nLearn more about streamlined incident response with DomainTools and Maltego:\n\n[Learn More](https://www.domaintools.com/products/integrations/maltego/?utm_source=Blog&utm_campaign=revealing-revil-ransomware-with-domaintools-and-maltego)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-20 - Revealing REvil Ransomware With DomainTools and Maltego.pdf"
    ],
    "report_names": [
        "2020-08-20 - Revealing REvil Ransomware With DomainTools and Maltego.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536064,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653678457,
    "ts_modification_date": 1653678457,
    "files": {
        "pdf": "https://archive.orkl.eu/4d5ddc5169f1ff0fe2a593319e2e59fc1820b94e.pdf",
        "text": "https://archive.orkl.eu/4d5ddc5169f1ff0fe2a593319e2e59fc1820b94e.txt",
        "img": "https://archive.orkl.eu/4d5ddc5169f1ff0fe2a593319e2e59fc1820b94e.jpg"
    }
}