{
    "id": "deb7105d-7e0a-4aca-b27f-68370fff81c0",
    "created_at": "2023-01-12T15:10:32.717144Z",
    "updated_at": "2025-03-27T02:05:54.536792Z",
    "deleted_at": null,
    "sha1_hash": "a0ac6947b0b38eacd92a503a1656f690a9827881",
    "title": "2020-02-04 - Borr Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T17:07:24Z",
    "file_modification_date": "2022-05-28T17:07:24Z",
    "file_size": 1175496,
    "plain_text": "# Borr Malware – Telegraph\n\n**telegra.ph/Borr-Malware-02-04**\n\n## Borr Malware\n\n[https://t.me/onek1lo_blogFebruary 04, 2020](https://t.me/onek1lo_blog)\n\n## Borr Malware\n\n[https://t.me/onek1lo_blog](https://t.me/onek1lo_blog)\n\nПродажник: [https://lolzteam.online/threads/1327287/](https://lolzteam.online/threads/1327287/)\n\nСемпл: [https://twitter.com/ViriBack/status/1222704498923032576](https://twitter.com/ViriBack/status/1222704498923032576)\n\n### Реверс\n\nДля начала откроем файл в ExeInfoPe.\n\n\nFebruary 4, 2020\n\nИсходный семпл\n\n\nDotNet файл, накрытый SmartAssembly. Первым делом попытаемся скормить его\nDe4dot.\n\n\n-----\n\nРезультат не порадовал, чистого файла мы не получили. Придется смотреть вручную.\nОткрываем файл в DnSpy, переходим в .cctor\n\n.cctor\n\nНичего интересного в этих методах я не нашел. Но зато меня привлек файл в ресурсах,\nочень похожий на шифрованный бинарник.\n\n\n-----\n\nЗначит, в каком то куске кода он будет расшифрован и подгружен. Пропускаем методы\n(ставим брекпоинт в конце .cctor), шагаем и смотрим модули\n\n\n-----\n\nПодгрузилась Dll (1thzpxouagh). Сохраняем ее и открываем в DnSpy.\n\nОказывается, стиллер накрыт криптом из SmartAssembly + RunPE. Стаб использует\nRunPE, а значит скорее всего в ресурсах нативный файл.\n\n\n-----\n\nСмотрим ресурсы, видим шифрованный файл. В самом коде все главные методы без\nобфускации. Написать декриптор будет просто.\n\n\n-----\n\nПишем декриптор\nПосле расшифровки получаем чистый билд. Откроем его в ExeInfoPE.\n\n\nЧистый билд\n\n\n-----\n\nФайл нативен, и это правда. Но несовсем. Данный софт использует технологию _CRL-_\n_Hosting. Грубо говоря, перед нами сейчас нативная обертка DotNet файла._\n\nС точки зрения написания малвари кажется, что этот способ сокрытия кода наиболее\nэффективен. Однако это не панацея. В процессе работы будет подгружен .net модуль,\nкоторый легко сдампить.\n\nВ нашем случае все еще проще. Стиллер работает какое-то время, а значит можно\nдаже не искать нужные брекпоинты - просто запускаем приложение в дебаггере, ждем\nнесколько секунд и ставим паузу. Net модуль загружен, можно дампить.\n\nЛично я испльзовал x32dbg и ExtremeDumper.\n\nДампим, дампим, дампим...\nЧто делаем? Правильно.\n\n\n-----\n\nПоследний\n\nрывок\nНеизвестный обфускатор. Ничего страшного, открываем в DnSpy и видим мод\nконфузера.\n\n\n-----\n\nШо, опять?\n\nСтавим брекпоинт на Main, чекаем переменные.\n\n\n-----\n\nСохраняем, открываем, уже лучше. Однако строки и методы все равно\nобфусцированны.\n\nТеперь пришло время заюзать спец тулзы для конфузера. В конце концов имеем\nчистые сурсы.\n\n\n-----\n\n### Анализ кода\n\nПервое что бросается в глаза - конфиг передается открытым текстом. Неужели так\nсложно было сделать банальный XOR+base64? Просто несерьезно.\n\n\n-----\n\nЛоадер дропает EXE со статичным именем в TEMP. Привет рантайм.\n\nДалее меня привлек конфиг. Как я понял, при запуске стиллер проверяет,\nдействительна ли лицензия, и если все ок то продолжает работу. Как по мне это не\nсамый лучший подход. Что если сервер/ip забанят? Как этот запрос в сеть скажется на\nрантайме, учитывая что все билды будут стучать на этот хост?\n\n\n-----\n\nКстати, вот _[сюда стучит софт при запуске.](http://92.63.197.188/Auth/index.php)_\n\nСбор данных с браузера осуществляется с помощью дроченого SqliteHandler.\n\n\n-----\n\nЯ не знаю почему все юзают CryptUnprotectData, когда есть\nSystem.Security.Cryptography.ProtectedData\n\nСтиллер outlook в наглую спизжен с моих сурсов. Даже не оптимизировали по\nнормальному.\n\n\n-----\n\nМожно было бы добавить больше FTP.\n\nЛог собирается на диске, причем папка дропа статична. Снова рантайм.\n\n\n-----\n\nИ самое большое огорчение - граббер. Софт/панель не предусматривают возможность\nдобавления собственных путей сбора файлов.\n\nВ топике было написано о обходе WindowsDefender, но где этот обход находится я так\nи не нашел. _[Детект чистого файла.](https://cyberscan.org/results.php?id=10uZhNgjOC&__cf_chl_jschl_tk__=e974ba64090ec6d23ca5f12e95c3f5db928db78e-1580828700-0-Ac0ob_ln-Uz-Qp1hNItCdex-BaJOIWeMY8Sv3HTJ5vWn2X-C9c54nm6yxOdVdMOwwysXiQ1Snts2rdKSzVjtM13HKN0x4FWoJgly7s0d-iJsg62432jtEKCFp9IyhE_B8PWfDvicccRaiesYEA7N8EQkrlASABTVM5icRhyaLayfRKRKIjnIMfPzhHUI2aInkyFaMO7c2EcjwMMSP9bAPwg0gKfRWdeVUSAMKeDg2hMsz2QrwjFRRdTOTCOTTMNvfwrVoQFnslIRdORSZG6Ggy4ONVS4kGTTTdZX-ohiDFdxmkhGhBsQa3pvOqiogGtPVClerHZ9y17zEf06g5AWYX-3Aoxr8po0atTVAyb2BZWR)_\n\nСоздается впечптление что софт написан на похуй. Ни многопоточности, ни каких то\nдругих фишек - абсолютно дефолтный стиллер с дефолтными методами с гитхаба.\n\nНа этом желание копать дальше пропало - все это я уже видел.\n\n### Панель\n\nВ командах (?) Borr и Krown один и тот же web кодер, поэтому их панели похожи.\n\n\n-----\n\nBorr\n\nKrown\n\n\n-----\n\nНастройки граббера\n\nПоиск по логам\nНужно отдать должное, панель в этом софте выглядит круто. Но настройки конфига\nскудноваты (имхо).\n\n### Итог\n\n**Borr Stealer - салат из правленных исходников с гитхаба с минимумом новизны и**\nщепоткой конфузера.\n\n-Путей сбора файлов мало\n\n\n-----\n\n-При этом добалять свои пути невозможно\n\n-Судя по стилю написания кода, создается впечатление, что софт написан не малваркодером, а фрилансером за еду\n\nКак по мне, данный продукт не соответствует цене (30$ в неделю без крипта).\nЕдинственное что понравилось - обфускация (было интересно реверсить) и панель.\n\n[Исходник](https://github.com/onek1lo/Borr-Stealer)\n\n[Бинарники (onek1lo)](https://anonfile.com/53406bVfn2/BINS_rar)\n\n[Блог](https://t.me/onek1lo_blog)\n\n\n-----",
    "language": "RU",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-04 - Borr Malware.pdf"
    ],
    "report_names": [
        "2020-02-04 - Borr Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536232,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653757644,
    "ts_modification_date": 1653757644,
    "files": {
        "pdf": "https://archive.orkl.eu/a0ac6947b0b38eacd92a503a1656f690a9827881.pdf",
        "text": "https://archive.orkl.eu/a0ac6947b0b38eacd92a503a1656f690a9827881.txt",
        "img": "https://archive.orkl.eu/a0ac6947b0b38eacd92a503a1656f690a9827881.jpg"
    }
}