{
    "id": "db4a222a-4063-4131-9f05-d7d9d4b03faa",
    "created_at": "2023-01-12T15:04:27.615661Z",
    "updated_at": "2025-03-27T02:06:15.405597Z",
    "deleted_at": null,
    "sha1_hash": "cd77541759630143a455f7e7cbcd7b623fe698ed",
    "title": "2022-01-24 - Analysis and Impact of LockBit Ransomware’s First Linux and VMware ESXi Variant",
    "authors": "",
    "file_creation_date": "2022-05-27T23:01:17Z",
    "file_modification_date": "2022-05-27T23:01:17Z",
    "file_size": 1078802,
    "plain_text": "# Analysis and Impact of LockBit Ransomware’s First Linux and VMware ESXi Variant\n\n**trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-**\nvariant.html\n\nJanuary 24, 2022\n\n[In our monitoring of the LockBit ransomware’s intrusion set, we found an announcement for](https://www.trendmicro.com/vinfo/us/security/definition/ransomware)\nLockBit Linux-ESXi Locker version 1.0 on October 2021 in the underground forum \"RAMP,\"\nwhere potential affiliates can find it. This signifies the LockBit ransomware group’s efforts to\nexpand its targets to Linux hosts. Since October, we have been seeing samples of this\nvariant in the wild.\n\nThis variant could have a big impact on victim organizations because of how ESXi, VMware’s\nhypervisor helps in managing servers.\n\nAnalysis of the variant\n\nLockbit Linux-ESXi Locker version 1.0 uses a combination of Advanced Encryption Standard\n(AES) and elliptic-curve cryptography (ECC) algorithms for data encryption. From our\nanalysis, we can see that this version of LockBit can accept parameters, as detailed in\nFigure 1.\n\n\n-----\n\nFigure 1. Parameters accepted by the Linux-ESXi version of LockBit\nThis version of the ransomware has logging capabilities and can log the following\ninformation:\n\nProcessor information\nVolumes in the system\nVirtual machines (VMs) for skipping\nTotal files\nTotal VMs\nEncrypted files\nEncrypted VMs\nTotal encrypted size\nTime spent for encryption\n\nThis variant also contains commands necessary for encrypting VM images hosted on ESXi\nservers, as listed in Table 1.\n\n**Command** **Description**\n\n\n**vm-support --listvms**\n\n\nObtain a list of all registered and\nrunning VMs\n\n\n**esxcli vm process list** Get a list of running VMs\n\n**esxcli vm process kill --type  force --world-id** Power off the VM from the list\n\n**esxcli storage filesystem list** Check the status of data storage\n\n**/sbin/vmdumper %d suspend_v** Suspend VM\n\n**vim-cmd hostsvc/enable_ssh** Enable SSH\n\n\n-----\n\n**vim-cmd**\n**hostsvc/autostartmanager/enable_autostart**\n**false**\n\n\nDisable autostart\n\n\n**vim-cmd hostsvc/hostsummary grep cpuModel** Determine ESXi CPU model\n\nTable 1. Commands for encrypting VM images hosted on ESXi servers\n\nThe ransom note is typical of LockBit attacks. It advertises the speed of [LockBit 2.0, lists](https://www.trendmicro.com/en_us/research/21/h/lockbit-resurfaces-with-version-2-0-ransomware-detections-in-chi.html)\ndown the leak sites where the LockBit group threatens to publish stolen information, and\nends with a recruitment ad for potential insiders enticing them with “millions of dollars” in\nexchange for access to valuable company data.\n\n\n-----\n\nFigure 2. A ransom note of the Linux-ESXi version of LockBit\nLockBit's operators typically threaten to publish data they stole from their victims on their leak\nsite once their targeted organizations have failed to comply with their ransom demands.\n\n\n-----\n\nFigure 3. A screenshot of LockBit 2.0’s leak site\nImpact of the variant\n\n[The release of this variant is in line with how modern ransomware groups have been shifting](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/modern-ransomwares-double-extortion-tactics-and-how-to-protect-enterprises-against-them)\ntheir efforts to target and encrypt Linux hosts such as ESXi servers. An ESXi server typically\nhosts multiple VMs, which in turn hold important data or services for an organization. The\nsuccessful encryption by ransomware of ESXi servers could therefore have a large impact\n[on targeted companies. This trend was spearheaded by ransomware families like REvil and](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-revil)\n[DarkSide.](https://www.trendmicro.com/en_us/research/21/e/what-we-know-about-darkside-ransomware-and-the-us-pipeline-attac.html)\n\nRecommendations\n\nESXi offers organizations an easier way to manage their servers. But ransomware operators\nare also mirroring the transition of organizations to platforms such as ESXi. This\ndevelopment adds LockBit to the list of ransomware families capable of targeting Linux hosts\nin general and the ESXi platform in particular.\n\nWhile Linux versions are typically harder to detect, implementing security best practices can\nstill help organizations minimize the possibility of a successful attack. In the case of LockBit,\nkeeping systems up to date can prevent intrusions. This is because LockBit has been known\n\n\n-----\n\nto use access credentials stolen from vulnerable servers and sold in the cybercriminal\n[underground. VMware also provides recommendations for enhancing the security of ESXi.](https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-E9B71B85-FBA3-447C-8A60-DEE2AE1A405A.html)\n\nOrganizations should also consider the following steps to mitigate ransomware threats:\n\nDeploy cross-layered detection and response solutions. Find solutions that can\nanticipate and respond to ransomware activities, techniques, and movements before\nthe threat culminates. [Trend Micro Vision One™, for example, helps detect and block](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nransomware components to stop attacks before they can affect an enterprise.\nCreate a playbook for attack prevention and recovery. Both an incident response\n(IR) [playbook and IR](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final) [frameworks help organizations plan for different attacks.](https://www.cynet.com/incident-response/incident-response-sans-the-6-steps-in-depth/)\n[Conduct attack simulations. Expose employees to realistic cyberattack simulations that](https://www.nytimes.com/2021/06/03/us/politics/ransomware-cybersecurity-infrastructure.html)\ncan help decision-makers, security personnel, and IR teams identify and\nprepare for potential security gaps and attacks.\n\n**Indicators of compromise (IOCs)**\n\nSHA256\n\nf3a1576837ed56bcf79ff486aadf36e78d624853e9409ec1823a6f46fd0143ea\n67df6effa1d1d0690c0a7580598f6d05057c99014fcbfe9c225faae59b9a3224\nee3e03f4510a1a325a06a17060a89da7ae5f9b805e4fe3a8c78327b9ecae84df\n\nYARA rule:\n\n\n-----\n\nrule Linux_Lockbit_Jan2022 {\n\nmeta:\n\ndescription = \"Detects a Linux version of Lockbit ransomware\"\n\nauthor = \"TrendMicro Research\"\n\ndate = \"2022-01-24\"\n\nhash1 =\n\"038ff8b2fef16f8ee9d70e6c219c5f380afe1a21761791e8cbda21fa4d09fdb4\"\n\nstrings:\n\n$xor_string_1 = \"LockBit Linux/ESXi locker V:\" xor(0x01-0xff)\n\n$xor_string_2 = \"LockBit 2.0 the world's fastest ransomware since 2019\"\nxor(0x01-0xff)\n\n$xor_string_3 = \"Tox ID LockBitSupp\" xor(0x01-0xff)\n\ncondition:\n\nuint16(0) == 0x457f and filesize < 300KB and\n\nfilesize > 200KB and any of them\n\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-24 - Analysis and Impact of LockBit Ransomware’s First Linux and VMware ESXi Variant.pdf"
    ],
    "report_names": [
        "2022-01-24 - Analysis and Impact of LockBit Ransomware’s First Linux and VMware ESXi Variant.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535867,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653692477,
    "ts_modification_date": 1653692477,
    "files": {
        "pdf": "https://archive.orkl.eu/cd77541759630143a455f7e7cbcd7b623fe698ed.pdf",
        "text": "https://archive.orkl.eu/cd77541759630143a455f7e7cbcd7b623fe698ed.txt",
        "img": "https://archive.orkl.eu/cd77541759630143a455f7e7cbcd7b623fe698ed.jpg"
    }
}