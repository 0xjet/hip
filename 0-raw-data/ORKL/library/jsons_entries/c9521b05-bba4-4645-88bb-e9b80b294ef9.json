{
    "id": "c9521b05-bba4-4645-88bb-e9b80b294ef9",
    "created_at": "2023-01-12T15:01:06.411379Z",
    "updated_at": "2025-03-27T02:13:58.307251Z",
    "deleted_at": null,
    "sha1_hash": "0113aa5b4749908643340075e3c402518e776743",
    "title": "2022-06-06 - SVCReady- A New Loader Gets Ready",
    "authors": "",
    "file_creation_date": "2022-06-13T04:04:20Z",
    "file_modification_date": "2022-06-13T04:04:20Z",
    "file_size": 2803399,
    "plain_text": "# Recent Posts\n\n**[threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/](https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/)**\n\n[HP Threat Research Blog • SVCReady: A New Loader Gets Ready](https://threatresearch.ext.hp.com/blog/)\n\n## SVCReady: A New Loader Gets Ready\n\n\nJune 6, 2022\n\n\nSince the end of April 2022, we have observed new malicious spam campaigns spreading a\npreviously unknown malware family called SVCReady. The malware is notable for the\nunusual way it is delivered to target PCs – using shellcode hidden in the properties of\nMicrosoft Office documents – and because it is likely in an early stage of development, given\nthat its authors updated the malware several times in May. In this report, we share a closer\nlook at the infection chain of the new SVCReady campaigns, the malware’s features, its\nchanges over time, and possible links with TA551.\n\n\n-----\n\nFigure 1 – SVCReady sample isolated by HP Wolf Security in April 2022.\n\n## Infection Chain\n\nBased on HP Wolf Security telemetry, the first sighting of this new campaign was on 22 April\n2022. The attackers sent Microsoft Word document (.doc) attachments to targets via email.\nAs in many other malware campaigns, the documents contain Visual Basic for Applications\n(VBA) AutoOpen macros that are used to execute malicious code. But unlike other Office\nmalware, the document does not use PowerShell or MSHTA to download further payloads\nfrom the web. Instead, the VBA macro runs shellcode stored in the properties of the\ndocument, which then drops and runs SVCReady malware.\n\n\n-----\n\nFigure 2 – Document properties containing shellcode, namely a series of nop instructions as\nrepresented by 0x90 values.\n\n## VBA Macro and Shellcode\n\nFirst, two Windows API functions are defined in the VBA code: SetTimer and VirtualProtect.\n\nFigure 3 – Windows API function definitions.\n\nNext the shellcode, which is located in the document properties, is loaded into a variable.\nDifferent shellcode is loaded depending on if the architecture of the system is 32 bit or 64 bit.\n\nFigure 4 – Loading shellcode into a variable.\n\nThe shellcode, now in a variable, is then stored in memory so that it can be assigned\nexecutable access rights by calling VirtualProtect. After giving executable access rights to\nthe shellcode, SetTimer is called. The SetTimer API can be passed a callback function as an\n\n\n-----\n\nargument, which is simply a pointer in memory. In this case, the attackers pass the address\nof the shellcode, thus executing it.\n\nFigure 5 – Change of shellcode protection and execution.\n\nAt this point, the execution of the VBA macros ends, and the shellcode takes over the next\nsteps of the infection. First, a dynamic link library (DLL) is dropped into the %TEMP%\ndirectory. Next, the shellcode copies rundll32.exe from the Window system directory into the\n%TEMP% directory. At this point, rundll32.exe is renamed, presumably to evade detection. A\ndetection opportunity here is to alert on the execution of Windows owned binaries outside\ntheir standard directories.\n\nOnce both files are in the %TEMP% directory, the renamed copy of rundll32.exe is run with\nthe DLL and a function name as arguments. This execution launches SVCReady.\n\nFigure 6 – Rundll32.exe executing the malware.\n\nThis infection chain relies on shellcode stored in an Office document, a technique not often\n[seen in malware campaigns. However, we have seen one other campaign that used this](https://bazaar.abuse.ch/sample/46b94af2c99c24074676ccd88b0c4e7e07016bff97aa8c763a5226034350714f/)\ntechnique in mid-April to distribute Ursnif.\n\n## The Downloader\n\nThe DLL started via rundll32.exe acts as a downloader, with additional functionalities for\ncollecting information about the infected system and communicating with a command and\ncontrol (C2) server. As soon as the downloader runs, it reports to the C2 server and\nimmediately starts gathering information.\n\n\n-----\n\nFigure 7 – C2 traffic of downloader, showing a status update (“Starting: success”).\n\n## Information Gathering\n\nThe malware collects system information including the username, computer name, time zone\nand whether the computer is joined to a domain. It is also queries the Registry, specifically\nthe HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System key, for the details\nabout the computer’s manufacturer, BIOS and firmware. Additionally, it collects lists of\nrunning processes and installed software. The malware gathers this information through\nWindows API calls rather than Windows Management Instrumentation (WMI) queries. All the\ninformation is formatted as JSON and sent to the C2 server through an HTTP POST request.\n\nFigure 8 – Sending system information to the C2 server.\n\n\n-----\n\n## Command and Control\n\nCommunication with the C2 server occurs via HTTP, but the data itself is encrypted using the\nRC4 cipher. Interestingly, RC4 encryption was not implemented in the first malware samples\nwe analyzed at the end of April 2022. This suggests that the C2 encryption was only added\nduring May and that the malware is being actively developed. After unpacking the sample,\nthe RC4 key can be extracted from memory. The attackers change the RC4 key for each\ncampaign.\n\nFigure 9 – The RC4 key used to encrypt the malware’s network communication, shown in\nmemory.\n\nThe RC4 key in Figure 9 corresponds to the campaign from 30 May:\n\nRC4 key – 0v89u6y089ut934uc0t8934uct08934uc0t89u54y895689vuh489cu389ct45\nSVCReady DLL –\n16851d915aaddf29fa2069b79d50fe3a81ecaafd28cde5b77cb531fe5a4e6742\n\n## Persistence\n\nAfter exfiltrating information about the infected PC, the malware tries to achieve persistence\non the system. The malware’s authors probably intended to copy the malware DLL to the\nRoaming directory, giving it a unique name based on a freshly generated UUID. But it seems\nthey failed to implement this correctly because rundll32.exe is copied to the Roaming\ndirectory instead of the SVCReady DLL. The malware creates a scheduled task called\n_RecoveryExTask that runs the file copied to Roaming with rundll32.exe and a function name_\nwhen the system starts.\n\n\n-----\n\nFigure 10 – Definition of the scheduled task.\n\nBut because of the error, rundll32.exe is executed with rundll32.exe, meaning the malware\ndoes not start after the system is rebooted.\n\nAt this point, the malware creates a new registry key that may be useful for building a\nsignature to detect the malware: HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\\n_{E6D34FFC-AD32-4d6a-934C-D387FA873A19}_\n\nFigure 11 – Registry key created by the malware.\n\nAfter completing a task, the malware sends a status message to the C2 server. These status\nmessages are always in JSON format. For example, the status message after creating the\nscheduled task looks like this:\n\nFigure 12 – JSON status.\n\n## More Information Gathering\n\nOnce the persistence phase is completed, another information gathering phase follows. This\ntime, the SVCReady takes a screenshot and sends it to the C2 server.\n\n\n-----\n\nFigure 13 – Sending screenshot to C2.\n\nThe malware then runs the systeminfo.exe process. The malware extracts the osinfo section\nfrom it and sends it to the C2 server. The information collected is identical to that gathered in\nthe earlier information gathering phase. It is possible that the malware makes this redundant\nquery in case the first queries via Windows API and registry key fail or perhaps the developer\nwas experimenting with different methods of gathering information.\n\nAn example output looks like this:\n\n\n-----\n\nFigure 14 – osinfo output.\n\n## Virtual Machine Detection\n\nFinally, the malware makes two WMI queries that are used to determine whether its runtime\nenvironment is virtualized or not:\n\n_Select AccessState from Win32_USBControllerDevice_\n\n_select * from CIM_ComputerSystem_\n\nThis stage is called checkvm.\n\n\n-----\n\nFigure 15 – Checking USB controllers to see if it is running inside a virtual machine (VM).\n\nThe result of this evaluation is then communicated back to the C2, ending the initial phase of\nthe malware. For example, if a VM is detected:\n\n_{“method”:”log”,params”:{“logs”:[“USB Status 2 VM DETECTED “],”stage”:”usbstatus-ban”}}_\n\nThe malware then enters a sleep stage for 30 minutes.\n\n\n-----\n\nFigure 16 – Malware going to sleep.\n\n## Beaconing activity\n\nSVCReady beacons to its C2 server every five minutes. The beacon only contains the status\nof the malware. Once the six consecutive sleep instructions have elapsed, the malware\nvalidates the last domains received via an HTTP request and then asks for new tasks. The\nAPI nodes of the malware gate are structured as follows:\n\n**Purpose** **API Node**\n\nValidate domain /xl/gate/check\n\nShare information /xl/gate\n\nRequest tasks /xl/gate/task\n\nFigure 17 – C2 response to task request.\n\nThe response can include a list of domains and a command for the malware, for example:\n\n_{“domains”:[“galmerts[.]art”,”kikipi[.]art”,”kokoroklo[.]su”],”command”:”nop”}_\n\nOther functionalities of the malware are:\n\nDownload a file to the infected client\n\n\n-----\n\nTake a screenshot\nRun a shell command\nCheck if it is running in a virtual machine\nCollect system information (a short and a “normal” version)\nCheck the USB status, i.e. the number of devices plugged-in\nEstablish persistence through a scheduled task\nRun a file\nRun a file using RunPeNative in memory\n\n## Follow-up Malware\n\n[In the campaign on 26 April, RedLine Stealer was delivered as a follow-up payload after the](https://malpedia.caad.fkie.fraunhofer.de/details/win.redline_stealer)\ninitial infection with SVCReady. At that time the C2 communication format was not encrypted.\nIt may be that this campaign was a test by SVCReady’s operators. At the time of writing, we\nhave not yet received any further malware payloads since then. Below are the indicators of\ncompromise (IOCs) for the malware campaign on 26 April:\n\nWord documents:\n\nfa5747e42c4574f854cd0083b05064466e75d243da93008b9f0dcac5cf31f208\ne09c98b677264fc0de36a9fd99a2711455fe79699ca958938dd12b5bd2c66bad\nc0795d7a7f2c5fdb7615ee5826e8453bef832f36282d6229ec07caf49842f4bc\n\nDLL:\n\nd3e69a33913507c80742a2d7a59c889efe7aa8f52beef8d172764e049e03ead5\n\nC2 domain:\n\nmuelgadr[.]top\n\nDownload URL:\n\nhxxp://wikidreamers[.]com/exe/install.exe\n\nPayload:\n\nRedLine Stealer –\n6e1137447376815e733c74ab67f202be0d7c769837a0aaac044a9b2696a8fa89\n\n## File name and document similarities to TA551\n\nWe identified similarities between the file names of the documents used to deliver\nSVCReady and those used in TA551 campaigns (Figure 18). TA551 activity was last seen at\nthe end of January 2022.\n\n\n-----\n\nFigure 18 – List of past TA551 threats.\n\nWe also found similarities between the lure images used in SVCReady and TA551\ncampaigns.\n\nFigure 19 – Malicious document containing a social engineering image, April 2022 campaign.\n\nWe maintain a database of about 20,000 images extracted from malicious documents, which\n[we use to find visually similar images using perceptual hash algorithms. Figure 20 shows the](https://threatresearch.ext.hp.com/spot-the-difference-tracking-malware-campaigns-using-visually-similar-images/)\nimage extracted from a document that drops SVCReady.\n\n\n-----\n\nFigure 20 – Extracted image from SVCReady document.\n\nSearching our database revealed three documents used to deliver Ursnif that contained the\nsame image, all from May 2021:\n\n2021-05-10:\ne6afaabd1e4a2c7adeedca6ee0ed095271a53a293162e3cf7ed52d570279258e\n2021-05-12:\n02e62eeb73ac0c0fa55cc203fbee23420a848cf991106eca3f75e8863a0cb4e5\n2021-05-21:\nf21289980710dcbb525d70a2be6aa1dc3118150386c0b2196cc5f23e637b87f5\n\nA closer analysis of these documents found that information was also stored in the document\nproperties that was subsequently used by malicious macros. However, the VBA code is\nsignificantly different and used MSHTA to download and run the follow-up malware from the\nweb. The malware was downloaded from the following URLs:\n\nhxxp://192.186.183[.]130/ts/909t5HXsDn4QMY6OB0I8tfpOT0N4FPGKuw~~/40PRbElUJTVQYhwM4WoZD6MyfeLT3GeSA~~/\nhxxp://144.168.197[.]36/ts/KS8qyPL1yA-fh8c8BXwFfnOGiWotKKIvqQ~~/t6q4Lknm9TM1FiPi5sCy2xtzZ27J7KabQ~~/\n\nUrsnif payload hashes:\n\n2848bfc05bcfaa5704ff4c44ab86b23c69aa386a39ad4bb393f3287bd884f8cc\n18d7206e9fa38d5844d3b0ec46576ace8a36091e77477f86a9a43724aa6a2309\n\n\n-----\n\nFurther, our search found two more images that weren t identical, but still very similar.\n\nFigure 21 – Similar document images from 2019 and 2020.\n\nThe difference with this image is that the text is part of the image, whereas in the other\ncampaign, the text and the background were separate element in the document. Notably, the\ntext is identical, including grammatical errors. These two documents were observed in 2019\nand 2020 in campaigns that distributed Ursnif and IcedID respectively:\n\n2019-02-04:\n3dab8a906b30e1371b9aab1895cd5aef75294b747b7291d5c308bb19fbc5db10\n2020-03-16:\ne47945f9cc50bb911242f9a69fc4177ed3dcc8e04dbfec0a1d36ff8699541ab5\n\nBoth campaigns can be traced back to TA551 based on the domains used to host the\nmalware:\n\ngou20lclair[.]band\nglquaoy[.]com\n\nComparing the images used in malware documents provides no certainty that the same\nthreat actor is behind them, since it is possible that we are seeing the artifacts left by two\ndifferent attackers who are using the same tools. However, our findings show that similar\ntemplates and potentially document builders are being used by the actors behind the TA551\nand SVCReady campaigns.\n\n## Naming the Campaigns\n\n[The malware family analyzed in this report corresponds to IDS rules published by Proofpoint,](https://www.proofpoint.com/us/daily-ruleset-update-summary-20220525)\nwhich names it SVCReady. To avoid confusion, we are tracking the malware by the same\nname.\n\n## Conclusion\n\n\n-----\n\nSince the end of April 2022, we have been seeing new malicious spam campaigns spreading\na previously unknown malware family, called SVCReady. Notably, the malware is dropped by\nshellcode that is stored in the properties of a Word document. SVCReady is under active\ndevelopment. We have tracked several changes since the first campaign in April 2022. The\nmalware also has bugs, notably in its persistence feature and duplication in the\nreconnaissance data it collects. This, as well as the low frequency and volume of the\ncampaigns, suggests that the malware is in the early stages of development.\n\n## Indicators of Compromise\n\nDocuments\n\n501D971E548139153C64037D07B4E3FEA2C1735A37774531C88CFA95BA660EC3\n\n99DF2CC2535C82B84BA23384DF290D7506242532123D8414C1CFC61967072C28\n\nC6C080A63DD038D11CD6E724D2DE31108CABE7B6E38F674FE8189696886582AF\n\nD270E1CA349DAA668E0807BE65ECA75CC739008A39E283F922A8728C22663417\n\n6C9FD23D88239D819E0B494E589B665C4E7921ED9B9DD0BBD1610D71230BCF81\n\nF47514C680135C7D4285F2284D5621245463F55A901C38F171DCE445695AC533\n\n9F7124303F1C957F7E02F275F3501CBAA6E0645A6D78B50617A97761DC611CFF\n\n4C1DD6A893F86A150E003118148C655044D06E8300678CF6BF3CC3107B91B66C\n\nFCB325D21D1100269731553015D6D0F85143DAE2BFA6CBAF49AC6DA29F1F732E\n\n939863285773B17623F0F027FAAE8B994BF5FC1AFB182C63A026431C71CD3885\n\n65A650DD353EA767EF68CF4627436977E6D55102D699B2E8B8DE491DA5C0A5EB\n\n134D0B10BAC1404FA1DA83C96C08E0882500819DAAD5F49E9E83C92F2A624B3E\n\nF2FADD7A8B88DA62228DAB8981638B5C9F5512A57A0441B57C2B3A29B0A96012\n\n0D55564A2BED4FF06BC8B1DAAB98E2032C39536DAA31878E16FED29BC987A4D1\n\nA8EED171FDCB2A872865620FC2234E0B07201D927ABCB65344846F6D4A7B75F5\n\nC24266CC16D65F0B8D72BB7DF80A6B2FFE343429A764AFB9FB0A9C20D53AB9AF\n\n50FBE350CC660361B919F5E464DA6D6170F35EF497327AE5DEFC7805E76D5568\n\nC362D9EEFAFB44D4116B4DFABD5945E974C8A010221705E021490EFBF34BC3A3\n68617985E8AB455316C18172723FBD2748DE58008714C4CB3F7C6F19D326F135\n\n65E551F7093299A9A20EAF536197C19ABBDD51B95B9570EDAC4950D7C951AD92\n\nD8AEC5539973927EB07A23BA4DE3780D28C2DD2D6DBBC697562A44B30CD3B03F\n\nCA61DE1E2442C16C280EB7264D6B7F79EC92CDC10D1C202EFB028DA5F242F83A\n\n74652EAE27C9F5A5C397EACC76DAF768B3E601F106E8539C7D855712AB185E40\n\n0224B906741F248D8BCEDAEF423B58FFB1B4577EC06711293F7065B12AE71788\n\nFDABB1F5B7691F03B2D89FEB8B0D4E3FD036F9B4E718269CAD8741C7E4D14072\n\nFD799D99F7E84436F8AF16D94EE7B2F1D08CA3CEE746E1CF9B36E2139D676E4C\n\n4A2E76B57DE10C687716A1D7A295910CC5C0D04F5D10D4F4C53AE1BDE45A251C\n\n9122092980BC0ED9C9B008C5456CC18656C41798585B8819F1D6F2620CAC3CF3\n\n391D134B792FB660426F183755AD00DBD737F521CFF1F9A12D402CD714D34645\n\nB67120F25963D36560CBB86B35E864F608536ABEF7C3377F46997D65BAD13CAA\n\n5170461322CB1A79ABB84FEED75B7F871B6F1594562E7724C45D7BB98F97C86B\n\n4B8627B5896A0656E801A95B16068F84660F1460A247E712651E0945EB4309CB\n\n\n-----\n\n95E328A549247F900DA5747F7E2057DEF121D2EDA82CFD7E926A6955C797D317\nAFA40C3157F2704ABA4838A7308B53A4853176AF86982CE2999AA4DF3AC7BB9C\n00FD57B32A3DF737C274D2184663DE4EDC22A4E003419C1B10B262E66995EE23\n5B7FBEC223DEB714DC7A4037348936A27D86B061CB2120213D5A69849CC9B588\nFA6F5695AC2530B486FDD6FE8096AAAF65081BC092AB874545628C61E1403919\nC86A477579188305132DAB40700D06FFF9E26B5CE627233FB9D20DA1DFC74B47\n748352146AB86EA1A32DFED0B0D5FAC0EFC52728BCCD79476B74FB73517EFB21\n\nDLLs\n08e427c92010a8a282c894cf5a77a874e09c08e283a66f1905c131871cc4d273\n16851d915aaddf29fa2069b79d50fe3a81ecaafd28cde5b77cb531fe5a4e6742\n1d3217d7818e05db29f7c4437d41ea20f75978f67bc2b4419225542b190432fb\n235720bec0797367013cbdc1fe9bbdde1c5d325235920a1a3e9499485fb72dba\n39c955c9e906075c11948edd79ffc6d6fcc5b5e3ac336231f52c3b03e718371e\n5e932751c4dea799d69e1b4f02291dc6b06200dd4562b7ae1b6ac96693165cea\nd3e69a33913507c80742a2d7a59c889efe7aa8f52beef8d172764e049e03ead5\nf690f484c1883571a8bbf19313025a1264d3e10f570380f7aca3cc92135e1d2e\n\nDomains\nmuelgadr[.]top\nwikidreamers[.]com\ngalmerts[.]art\nmarualosa[.]top\nkikipi[.]art\nkokoroklo[.]su\n\nTags\n\n[loader](https://threatresearch.ext.hp.com/blog/?post-tag=loader) [svcready](https://threatresearch.ext.hp.com/blog/?post-tag=svcready)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-06 - SVCReady- A New Loader Gets Ready.pdf"
    ],
    "report_names": [
        "2022-06-06 - SVCReady- A New Loader Gets Ready.pdf"
    ],
    "threat_actors": [
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "90f216f2-4897-46fc-bb76-3acae9d112ca",
            "created_at": "2023-01-06T13:46:39.248936Z",
            "updated_at": "2025-03-27T02:00:03.031127Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "Shakthak",
                "TA551",
                "ATK236",
                "G0127",
                "Monster Libra"
            ],
            "source_name": "MISPGALAXY:GOLD CABIN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "40b623c7-b621-48db-b55b-dd4f6746fbc6",
            "created_at": "2024-06-19T02:03:08.017681Z",
            "updated_at": "2025-03-27T02:05:17.342829Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "TA551 ",
                "Shathak"
            ],
            "source_name": "Secureworks:GOLD CABIN",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535666,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1655093060,
    "ts_modification_date": 1655093060,
    "files": {
        "pdf": "https://archive.orkl.eu/0113aa5b4749908643340075e3c402518e776743.pdf",
        "text": "https://archive.orkl.eu/0113aa5b4749908643340075e3c402518e776743.txt",
        "img": "https://archive.orkl.eu/0113aa5b4749908643340075e3c402518e776743.jpg"
    }
}