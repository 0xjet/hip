{
    "id": "7ffdab60-f1e4-4d9a-b854-9194b2249840",
    "created_at": "2023-01-12T15:06:13.588756Z",
    "updated_at": "2025-03-27T02:05:51.36437Z",
    "deleted_at": null,
    "sha1_hash": "d1e0f9eb6d41a0373b1c1ad901e396292a1f7097",
    "title": "2022-08-19 - Analyzing Attack Data and Trends Targeting Ukrainian Domains",
    "authors": "",
    "file_creation_date": "2022-09-01T10:15:08Z",
    "file_modification_date": "2022-09-01T10:15:08Z",
    "file_size": 1317246,
    "plain_text": "# Analyzing Attack Data and Trends Targeting Ukrainian Domains\n\n**[wordfence.com/blog/2022/08/analyzing-attack-data-and-trends-targeting-ukrainian-domains](https://www.wordfence.com/blog/2022/08/analyzing-attack-data-and-trends-targeting-ukrainian-domains)**\n\nAugust 19, 2022\n\n[Topher Tebow](https://www.wordfence.com/blog/author/wftopher/)\n\nAugust 19, 2022\n\nAs we continue to monitor the cyber situation in Ukraine, the data we are seeing shows\nsome interesting trends. Not only has the volume of attacks continued rising throughout the\nwar in Ukraine, the types of attacks have been varied. A common tactic of cyber criminals is\nto run automated exploit attempts, hitting as many possible targets as they can to see what\ngets a result. The data we have analyzed shows that this tactic is being used against\nUkrainian websites. This is in contrast to a targeted approach where threat actors go after\nspecific individuals or organizations, using gathered intelligence to make at least an\neducated guess at the type of vulnerabilities that may be exploitable.\n\n## Data Shows a Variety of Attack Types\n\n\n-----\n\nIn the past 30 days, we have seen 16 attack types that triggered more than 85 different\nfirewall rules across protected websites with .ua top-level domains. These rules blocked\nmore than 9.8 million attack attempts on these websites, with the top five attack types\naccounting for more than 9.7 million of those attempts.\n\nIn order to demonstrate the top five attack types, we are going to follow a single threat actor\nwho has been observed attempting each of these attack types throughout the last 30 days.\nCombining the originating IP addresses associated with the attack attempts with the useragent that was used and other commonalities, we can say with a high degree of certainty\nthat the demonstrated attack attempts were work of the same threat actor.\n\n### Known Malicious IP Addresses\n\nThe largest category of blocked attack attempts were due to use of a known malicious IP\naddress. These IP addresses are maintained by the Wordfence blocklist, with new addresses\nadded when they become maliciously engaged, and removed when they are no longer being\nused maliciously. When we see activity from an IP address on the blocklist, it is immediately\nblocked, however we do track the request that was received from the attacking server.\n\n\n-----\n\nThe top IP addresses we have blocked using known malicious IP addresses were often seen\nattempting to upload spam content to websites, however it was also common to see file\nupload and information disclosure attempts as well. Here we see a simple POST request that\nuses URL encoding along with base64 encoding to obfuscate a command to be run.\n\nThe decoded payload will simply display `XO_Sp3ctra to alert the malicious actor that the`\naffected system will allow commands to be run by them.\n\n\n-----\n\nWhen we look at the top known malicious IP addresses blocked worldwide, the top 15 are IP\naddresses within Russia. This does not match what we are seeing in Ukraine, where the top\nattacking IP addresses vary in location across North America, Europe, and Asia, with only\nthree in Russia. However, there is a similarity. The IP address in 15th position worldwide for\nmost initiated exploit attempts is in 4th position for blocked attacks against .ua domains. The\nIP address, `152.89.196.102, is part of an ASN belonging to Chang Way Technologies Co.`\nLimited. The IP itself is located in Russia, but assigned to a company named Starcrecium\nLimited, which is based in Cyprus and has been used to conduct attacks of this type in the\npast. This IP has been blocked 78,438 times on .ua websites, with a total of 3,803,734\nblocked attack attempts worldwide.\n\nWhen you consider the fact that we logged malicious activity from almost 2.1 million\nindividual IP addresses in this time, and the 15th worldwide ranked IP was ranked 4th\nagainst an area as small as Ukraine, the number of blocked attacks becomes very\nsignificant. Additionally, there were three IP addresses that ranked higher in Ukraine, but did\nnot even make the top 20 worldwide, showing that while there are threat actors who are not\nfocusing heavily on Ukraine, others are very focused on Ukrainian websites. What we are\nseeing from the IP addresses targeting Ukrainian websites more heavily is similar to what we\nsee here, with information gathering and uploading spam content being the two main goals\nof the attack attempts.\n\nOne thing to keep in mind here is the fact that all .ua sites get our real-time threat\nintelligence, which is typically reserved for Wordfence Premium, Care, and Response\ncustomers, so it is not possible to get a true comparison between the websites in Ukraine\nand the rest of the world. IP addresses are added to the blocklist for many reasons, including\nthe attack types we outlined above. Often these addresses are blocked for simple malicious\nbehavior, such as searching for the existence of specific files on a website. More complex\nbehavior like searching for the ability to run commands on the server will also lead to an IP\nbeing added to the blocklist.\n\n### Known Malicious User-Agents\n\nOne way that we block attacks is by tracking known malicious user-agents. This was the\nsecond-largest category our firewall blocked on .ua domains. When we see a user-agent\nstring that is consistently being used in malicious events, like the user-agent below, we add it\nto a firewall rule.\n\n\n-----\n\nUser-agent strings can be set to an arbitrary value, so blocking user-agents is not sufficient\nto maintain security on its own. Nonetheless, tracking and blocking consistently malicious\nuser-agents still allows us to block millions of additional attacks a day and provides us with a\ngreat degree of visibility into attacks that are less targeted at specific vulnerabilities. Many\nthreat actors consistently use a given user-agent string, so this also allows us to block a\nlarge number of credential stuffing attacks on the first attempt, rather than after a certain\nthreshold of failed logins.\n\nThere are many reasons a user-agent will be blocked by the Wordfence firewall, but always\nfor consistent malicious activity. For instance, the user-agent here has been tracked in\nnumerous types of attack attempts without consistent legitimate activity or false positives\nbeing detected. It is frequently found looking for configuration files, such as the aws.yml file\nin this example. Keep in mind that the fact that the actor is searching for this file does not\nautomatically mean it exists on the server. However, if the file does exist and can be read by\na would-be attacker, the data contained in the file would tell them a lot about the Amazon\nWeb Services server configuration being used. This could lead to the discovery of\nvulnerabilities or other details that could help a malicious actor damage a website or server.\n\nSimilarly, information about the server could be discovered no matter who the server provider\nis if a file that returns configuration information, such as a info.php or server_info.php file can\nbe discovered and accessed. Knowing the web server version, PHP version, and other\ncritical details can add up to a vulnerability discovery that makes it easy for a malicious actor\nto access a website.\n\n\n-----\n\nIn addition to searching for configuration files, and other malicious activities, we also see an\nattacker using this specific user-agent attempting to upload malicious files to the servers they\nare trying to compromise. The following shows an attacker using the same known malicious\nuser-agent attempting to upload a zip file, which, if successful, unzips to install a file named\nsp3ctra_XO.php on the server. When we said there were clues that these attack attempts\nwere being perpetrated by the same threat actor, you can see here what one of those clues\nare with the sp3ctra_XO.php filename variation of the `XO_Sp3ctra output seen earlier.`\n\nOver the past 30 days, we have observed this user-agent string used in more than 1.3 million\nattack attempts against Ukrainian websites. This makes it the largest attacking user-agent\nthat is not immediately recognizable as an unusual user-agent. The only user-agent string\nthat had more tracked attack attempts is `wp_is_mobile . These user-agent strings are`\namong the dozens that have been observed over time to be consistently associated only with\nmalicious activity.\n\n\n-----\n\nThe user-agent we are following here was logged in 1,115,824,706 attack attempts\nworldwide in the same time frame, making this a very common malicious user-agent string.\nWith this being a prolific user-agent in attacks around the world, it is no surprise that it is\nbeing seen in regular attack attempts on Ukrainian websites. Whether specifically targeted,\nor just a victim of circumstance, Ukrainian websites are seeing an increase in attacks. This is\nlikely due to heightened activity from threat actors globally.\n\n### Directory Traversal\n\nThe next largest category of attack attempts we have been blocking targeting .ua domains\nwas directory traversal. This relies on a malicious actor getting into the site files wherever\nthey can, often through a plugin or theme vulnerability, and trying to access files outside of\nthe original file’s directory structure. We are primarily seeing this used in much the same way\nas the information disclosure attacks, as a way to access the wp-config.php file that\npotentially provides database credentials. Other uses for this type of attack can also include\nthe ability to get a list of system users, or access other sensitive data stored on the server.\n\nIn this example, the malicious actor attempted to download the site’s wp-config.php file by\naccessing the file structure through a download.php file in the twentyeleven theme folder,\nand moving up the directory structure to the WordPress root, where the wp-config.php file is\nlocated. This is seen in the request by adding `?file=..%2F..%2F..%2Fwp-config.php .`\nThis tells the server to look for a wp-config. php file that is three directories higher than the\ncurrent directory.\n\nThis type of attack is often a guessing game for the malicious actor, as the path they are\nattempting to traverse may not even exist, but when it does, it can result in stolen data or\ndamage to a website or system. The fact that the twentyeleven theme was used here does\nnot necessarily indicate that the theme was vulnerable, or even installed on the site, only that\nthe malicious actor was attempting to use it as a jumping off point while trying to find a\nvulnerable download.php file that could be used for directory traversal.\n\n### Information Disclosure\n\n\n-----\n\nInformation disclosure attacks are the fourth-largest attack type we blocked against .ua\ndomains. The primary way we have observed threat actors attempting to exploit this type of\nvulnerability is through GET requests to a website, using common backup filenames, as\nseen in the example below. Unfortunately, due to the insecure practice of system\nadministrators appending filenames with .bak as a method of making a backup of a file prior\nto modifying the contents, threat actors are likely to successfully access sensitive files by\nsimply attempting to request critical files in known locations, with the .bak extension added.\nWhen successful, the contents of the file will be returned to the threat actor.\n\nThis is a fairly straightforward attack type, where the request simply returns the contents of\nthe requested file. If a malicious actor can obtain the contents of a site’s wp-config.php file,\neven an outdated version of the file, they may be able to obtain the site’s database\ncredentials. With access to a site’s database credentials, an attacker could gain full database\naccess granted they have access to the database to log in with the stolen credentials. This\nwould then give the attacker the ability to add malicious users, change a site’s content, and\neven collect useful information to be used in future attacks against the site or its users.\n\n### File Upload\n\nFile upload rounds out the top five categories of attack attempts we have been blocking\ntargeting .ua domains. In these attempts, malicious actors try to get their own files uploaded\nto the server the website is hosted on. This serves a number of purposes, from defacing a\nwebsite, to creating backdoors, and even distributing malware.\n\nThe example here is only one of the many types of upload attacks we have blocked. A\nmalicious actor can use this POST request to upload a file to a vulnerable website that\nallows them to upload any file of their choosing. This can ultimately lead to remote code\nexecution and full server compromise.\n\n\n-----\n\nThe POST request in this case includes the contents of a common PHP file uploader named\nbala.php. This code provides a simple script to select and upload any file the malicious actor\nchooses. If the upload is successful they will see a message stating `eXploiting Done but`\nif it fails they message will read `Failed to Upload . The script also returns some general`\ninformation about the system that is being accessed, including the name of the system and\nthe operating system being used.\n\nAnother important thing to note about this request is that it attempts to utilize the\nIoptimization plugin as an entry point. Ioptimization is a known malicious plugin that offers\nbackdoor functionality, but was not actually installed in the site in question. This indicates\nthat the threat actor was trying to find and take over sites that had been previously\ncompromised by a different attacker.\n\n\n-----\n\nThe fact that file uploads are the most common blocked attack type is not at all surprising.\nFile uploads can be used to distribute malware payloads, store spam content to be displayed\nin other locations, and install shells on the infected system, among a number of other\nmalicious activities. If a malicious actor can upload an executable file to a site, it generally\ngives them full control of the infected site and a foothold to taking over the server hosting that\nsite. It can also help them remain anonymous by allowing them to send out further attacks\nfrom the newly infected site.\n\n## Conclusion\n\nIn this post, we continued our analysis of the cyber attacks targeting Ukrainian websites.\nWhile there has been an increase in the number of attacks being blocked since the start of\nRussia’s invasion of Ukraine, the attacks do not appear to be focused. Known malicious IP\naddresses were the most common reason we blocked attacks in the last 30 days, however,\ninformation stealing and spam were the most common end goals for the observed attack\nattempts.\n\nIf you believe your site has been compromised as a result of a vulnerability, we offer Incident\n[Response services via Wordfence Care. If you need your site cleaned immediately,](https://www.wordfence.com/products/wordfence-care/)\n[Wordfence Response offers the same service with 24/7/365 availability and a 1-hour](https://www.wordfence.com/products/wordfence-response/)\nresponse time. Both of these products include hands-on support in case you need further\nassistance.\n\n## Comments\n\n\n-----\n\n4 Comments\n\nIryna\n\nAugust 19, 2022\n\n8:28 am\n\n[Reply](https://www.wordfence.com/blog/2022/08/analyzing-attack-data-and-trends-targeting-ukrainian-domains/?replytocom=169652#respond)\nInteresting article. However, it is \"war in Ukraine\", not \"the conflict in Ukraine\". Also,\nplease fix \"the Ukraine\", \"Ukraine\" without an article is grammatically correct.\n\nTopher Tebow\n\nAugust 19, 2022\n\n10:16 am\n\n[Reply](https://www.wordfence.com/blog/2022/08/analyzing-attack-data-and-trends-targeting-ukrainian-domains/?replytocom=169654#respond)\nThank you for pointing those out. We have made the changes you suggested.\n\n:))\n\nAugust 23, 2022\n\n1:09 am\n\n[Reply](https://www.wordfence.com/blog/2022/08/analyzing-attack-data-and-trends-targeting-ukrainian-domains/?replytocom=169657#respond)\nin this picture\n\nhttps://www.wordfence.com/wp-content/uploads/2022/08/Blocked-IP-Example-1.png\n\nhacker use alfa shell exploit\n\n\n-----\n\nTopher Tebow\n\nAugust 24, 2022\n\n4:38 pm\n\n[Reply](https://www.wordfence.com/blog/2022/08/analyzing-attack-data-and-trends-targeting-ukrainian-domains/?replytocom=169659#respond)\nCorrect, that is what the malicious actor was attempting to use in that example.\nAlfa is a fairly common and effective shell, but also well known to us so it is\neasily detected and blocked. Fortunately, in the instance used here, the bad\nactor was using a known malicious IP address, so they didn't even get the\nopportunity to determine if the shell was in place. (Spoiler: it wasn't)\n\nAll comments are moderated before being published. Inappropriate or off-topic comments\nmay not be approved.\n\n### Breaking WordPress Security Research in your inbox as it happens.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-19 - Analyzing Attack Data and Trends Targeting Ukrainian Domains.pdf"
    ],
    "report_names": [
        "2022-08-19 - Analyzing Attack Data and Trends Targeting Ukrainian Domains.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535973,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1662027308,
    "ts_modification_date": 1662027308,
    "files": {
        "pdf": "https://archive.orkl.eu/d1e0f9eb6d41a0373b1c1ad901e396292a1f7097.pdf",
        "text": "https://archive.orkl.eu/d1e0f9eb6d41a0373b1c1ad901e396292a1f7097.txt",
        "img": "https://archive.orkl.eu/d1e0f9eb6d41a0373b1c1ad901e396292a1f7097.jpg"
    }
}