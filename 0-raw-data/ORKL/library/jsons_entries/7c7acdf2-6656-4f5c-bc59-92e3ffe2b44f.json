{
    "id": "7c7acdf2-6656-4f5c-bc59-92e3ffe2b44f",
    "created_at": "2023-01-12T15:07:38.599733Z",
    "updated_at": "2025-03-27T02:09:30.907313Z",
    "deleted_at": null,
    "sha1_hash": "effbe19feb600acc29b5af50bb2c888e356b65f0",
    "title": "2017-02-02 - Oops, they did it again- APT Targets Russia and Belarus with ZeroT and PlugX",
    "authors": "",
    "file_creation_date": "2022-05-28T02:49:20Z",
    "file_modification_date": "2022-05-28T02:49:20Z",
    "file_size": 2141127,
    "plain_text": "# Oops, they did it again: APT Targets Russia and Belarus with ZeroT and PlugX\n\n**[proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx](https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx)**\n\nFebruary 2, 2017\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nOops, they did it again: APT Targets Russia and Belarus with ZeroT and PlugX\n\n\n-----\n\nFebruary 02, 2017 Darien Huss, Pierre T, Axel F and Proofpoint Staff\n\n**Overview**\n\nAlthough state-sponsored attacks against the United States by Chinese threat actors have decreased\ndramatically since the signing of the US-China Cyber Agreement in 2016, Proofpoint researchers have continued\n[to observe advanced persistent threat (APT) activity associated with Chinese actors targeting other regions. We](https://www.proofpoint.com/us/threat-reference/advanced-persistent-threat)\nhave previously written about related activity [2][3] in which a particular China-based attack group used PlugX\nand NetTraveler Trojans for espionage in Europe, Russia, Mongolia, Belarus, and other neighboring countries.\nMost recently, we have observed the same group targeting military and aerospace interests in Russia and\nBelarus. Since the summer of 2016, this group began using a new downloader known as ZeroT to install the\nPlugX remote access Trojan (RAT) and added Microsoft Compiled HTML Help (.chm) as one of the initial\ndroppers delivered in spear-phishing emails.\n\nThis blog details the function of the new malware, provides delivery details for elements of the APT activity, and\ndescribes additional changes in tactics, techniques, and procedures (TTPs) associated with this group.\n\n**Delivery**\n\nIn previous campaigns, the group used spear-phishing emails with Microsoft Word document attachments\nutilizing CVE-2012-0158, or URLs linking to RAR-compressed executables. Although some of these patterns of\nbehavior still continue, in June 2016 we observed the attackers using a new type of dropper to deliver a\npreviously unknown malware we named \"ZeroT\". Specifically, the CHM file 20160621.chm (SHA256:\n4ef91c17b1415609a2394d2c6c353318a2503900e400aab25ab96c9fe7dc92ff) dropped the first known sample of\nZeroT.\n\nThe proprietary Microsoft HTML Help file format (.chm) is used for software documentation and may consist of\nHTML pages and other compressed files. This particular CHM contained an HTM file and an executable file. The\nHTM file contained the text displayed to the user and referenced the executable svchost.exe (SHA256:\nd1c4a51064aeec4c11a8f90f80a3b60a36c07cce2dde0756c114e477d63ce375). Thus, opening the CHM has the\neffect of running the executable (the UAC dialog is shown in Figure 1).\n\n\n-----\n\n_Figure 1: The dropper file 20160621.chm with a Russian-language lure pretends to be from the “Defense_\n_Industry of Russia in the 21st Century”; user must accept the UAC warning before malware executes._\n\n_Figure 2: Listing of the files in the CHM file and their partial contents_\n\nAttackers also continued to send spear-phishing emails with Microsoft Word attachments utilizing CVE-20120158 to exploit the client. These documents were built with MNKit, described in detail here [6][7]. For example,\nthe email with subject “Федеральная целевая программа 2017-2020 гг.” (translated from Russian: “Federal\n\n\n-----\n\nTarget Program 2017 2020 gg. ) contained an attachment 2017 2020.doc and was sent to a potential victim in\nan aerospace company in December 2016.\n\n_Figure 3: Email sent to potential victim in aerospace company contained a MNKit-generated CVE-2012-0158_\n_exploit document_\n\nThroughout the second half of 2016 we also found many RAR archives and RAR SFX (self-extracting\nexecutables) of ZeroT; example names are listed in the table below. Several refer to Commonwealth of\nIndependent States (CIS), a regional organization that includes nine out of the fifteen former Soviet Republics,\nincluding Russia and Belarus [5].\n\n**Filename** **Translation**\n\n\nИзменения в списке аффилированных лиц по\nсостоянию на 21.06.2016 г.scr\n\nУВЕДОМЛЕНИЕ О\nКОНФИДЕНЦИАЛЬНОСТИ.rar\n\nПОВЕСТКА ДНЯ 72-го заседания\nЭкономического совета Содружества\nНезависимых Государств.rar\n\n\nChanges in the list of affiliates as of 06.21.2016 g.scr\n\nNOTICE of CONFIDENTIALITY.rar\n\nAGENDA OF THE DAY for 72-nd meeting of the\nEconomic Council of the Commonwealth of Independent\nStates.rar\n\n\nПроекты.scr Projects.scr\n\n\n-----\n\nПлан.scr Plan.scr\n\n08_11_2016 СНГ.7z 08_11_2016 CIS.7z\n\n_Table 1: Examples of RAR compressed executables or simply .scr executables of ZeroT_\n\n**Analysis**\n\nThis section provides an analysis of ZeroT, its delivery and obfuscation techniques.\n\n**UAC Bypass and Sideloading**\n\nThroughout our investigation, many of the analyzed ZeroT RAR SFX samples (e.g.\n67693ddb6236d3ef790059409ae240212c47acfd8c1c76d65c3ef19096fdf43b) contained a file named Go.exe\nwhich performs Windows UAC bypass. This executable contains a PDB path indicating its purpose of bypassing\nUAC (Fig. 4).\n\n_Figure 4: PDB path containing Chinese characters translating to “Desktop”_\n\nThis executable is obfuscated using the same technique that is reused in the sideload DLL and the ZeroT\npayload (described later). When run, Go.exe modifies the registry key shown in Figure 5 to perform the UAC\nbypass by exploiting Event Viewer [1].\n\n_Figure 5: Modified registry key to execute Zlh.exe exploiting a UAC bypass vulnerability in eventvwr.exe_\n\nIt then executes eventvwr.exe which proceeds to execute Zlh.exe using the UAC bypass vulnerability (Fig. 6).\n\n_Figure 6: Zlh.exe is executed via the eventvwr.exe UAC bypass vulnerability_\n\n[Zlh.exe is a legitimate, signed Norman Safeground AS application, which is used to sideload a malicious](https://en.wikipedia.org/wiki/Norman_Safeground)\nnflogger.dll DLL.The encrypted ZeroT payload is usually named NO.2.mui. The sideloaded DLL does not always\nuse the same vulnerable executable, but it is always similar in functionality. Usually the DLL is not packed, but\n[we have observed instances compressed by UPX. This malicious DLL is usually obfuscated with the same junk](https://upx.github.io/)\ncode: dummy API calls inserted in between real instructions (Fig. 7). The same obfuscation can be found in\nmultiple functions in ZeroT itself.\n\n\n-----\n\n_Figure 7: Dummy API calls for obfuscation_\n\nThis DLL has no other noticeable characteristics, as it functions like a typical malicious sideload. After loading\nthe encrypted payload in memory, it transfers the execution to a shellcode that is located at the beginning of the\nfile. Even if the process is similar for the PlugX RAT sideloaded later, the shellcode and obfuscation have nothing\nin common. Once loaded in memory, the ZeroT shellcode does not present any kind of obfuscation, unlike that\nfor PlugX. This shellcode is charged with unpacking the encrypted and compressed payload. As in the new\nPlugX dropper detailed below, this is done using RC4 and RtlDecompressBuffer. As in PlugX samples, the PE\nheader of ZeroT has been tampered with, specifically the “MZ” and “PE” constants (Fig. 8). On some PlugX\nversions, either “GULP” or “XV” are common as tags replacing the “MZ” constant.\n\n_Figure 8 : Altered ZeroT PE Header_\n\n**ZeroT Command and Control Protocol**\n\nZeroT communicates with its command and control (C&C) over HTTP. A fake User-Agent is used in all the\nrequests made by this malware: “Mozilla/6.0 (compatible; MSIE 10.0; Windows NT 6.2; Tzcdrnt/6.0)”, with\n“Tzcdrnt” possibly being a typo of “Trident.” In all the samples we observed, ZeroT first beacons to index.php\nexpecting an RC4-encrypted response using a static key: “(*^GF(9042&*” (Fig. 9).\n\n\n-----\n\n_Figure 9: ZeroT initial beacon over HTTP requesting URL configuration_\n\nIn the decrypted initial server response (Fig. 10,11), ZeroT expects several URLs including a location to POST\nsystem information prefixed with “w:” and a download location for any stage 2 payloads denoted with an “r:”\nprefix.\n\n_Figure 10: Decrypted tassnews[.]net index.php response containing several URLs_\n\nNext, ZeroT uses HTTP POST beacons to transmit information about the infected system to the C&C. The first\nbeacon contains the following data: “Cn=%s&La=%s&” where Cn is the computername and La is the local IP\naddress (Fig. 11). While the first beacon is transmitted in cleartext it is probable that this behavior was\nunintentional as subsequent POST beacons in the loop are encrypted. The first POST beacon is followed by\nanother in the following format (Fig. 11,12):\n“Lg=%d&Pv=%d&Bu=%%s&Cn=%s&Cu=%s&Dn=%s&Ki=%s&La=%s&Me=%s&Os=%s&Ov=%s&Pt=%s&Fl=%%d”\nthat is RC4-encrypted with the following key: “s2-18rg1-41g3j_.;”. This POST sends basic fingerprinting data\nincluding computer name, system language, domain information and Windows versioning.\n\nFigure 11: Initial plaintext POST beacon\n\n\n-----\n\nFigure 12: RC4 encrypted POST beacon\n\nThe final piece of ZeroT’s C&C protocol is to retrieve any stage-2 payloads. In the initial samples of ZeroT, the\n_tassnews[.]net C&C was used to distribute plain, non-encoded PE payloads (Fig. 13). Although we were not able_\nto retrieve all the payloads that may have existed at this C&C, the ones we did observe were RAR SFX archives\nused to deliver PlugX.\n\nFigure 13: ZeroT downloading non-encoded PlugX Stage 2\n\nThe ZeroT samples communicating to versig[.]net functioned differently from samples using tassnews[.]net\nwhere Bitmap (BMP) [8] URLs (Figure 14) were provided as a stage 2 payload instead of EXEs (Fig. 14).\n\n_Figure 14: Decrypted versig[.]net index.php response with F.bmp stage 2_\n\nThe BMPs used for stage 2 in all the instances we analyzed looked like normal images (Fig. 15, 16) which\nindicated a form of steganography is being used that minimizes changes to the appearance of the image.\n\n\n-----\n\n_Figure 15: F.bmp image containing stage 2 hidden using steganography_\n\n_Analysis of the F.bmp image revealed that it is indeed using Least Significant Bit (LSB) Steganography [9,10], a_\ncommonly used form of steganography that embeds data in an image without significantly affecting its\nappearance.\n\n**Analysis of ZeroT’s Bitmap LSB Steganography**\n\nZeroT uses a single, large function for the custom LSB algorithm that occurs as the first function in the samples\nwe analyzed. It may selectively choose to extract one, two, three, or four bits per pixel byte depending on the\nsize of the embedded payload and the image being used, meaning it is capable of 1-, 2-, 3-, and 4-bit LSB (Fig.\n16).\n\n\n-----\n\n_Figure 16: Diagram depicting portions of ZeroT’s LSB steganography algorithm_\n\nThe first step in the algorithm extracts the width and height from the image. A 24-bit depth Bitmap is assumed\nwhile calculating the size of memory needed (3*Width*Height) to store all the pixels in the image, which is\nallocated using malloc. Next, because Bitmaps are padded to 32-bit boundaries, ZeroT will check to see if any\npadding exists by AND’ing 3*Width. If that value is not zero, then it is subtracted from four which is then used as\nthe padding.\n\nThe following step in the algorithm is to assemble the bitmap row by row. Technically what occurs is as follows:\niteratively 3*Width bytes, beginning at the hardcoded offset of 54, are copied to the end of the previously\nallocated memory (malloc’d 3*Width*Height). Padding is then skipped, if any exists, followed by the next 3*Width\nbytes until all rows of pixels are copied.\n\n\n-----\n\nNext, starting at offset 10 of the assembled bitmap, ZeroT extracts a 32 bit value from 32 bytes using 1 bit LSB\nthat is used to indicate the size of the embedded stage 2 payload. The stage 2 file extension is then extracted\nstarting at offset nine and working its way backwards until a period is found (e.g., “.exe”).\n\nFinally, ZeroT checks various values such as the image length against the needed bits to complete the length of\nthe extracted payload [8*len(extracted payload)]. Depending on the result, ZeroT will decide to use 1-, 2-, 3-, or\n4-bit LSB. Lastly, once each bit is extracted, all the bits will be compiled into bytes to form the extracted stage 2\npayload.\n\n**Stage 2 Payloads**\n\nUntil the end of 2016, PlugX payloads were delivered as RAR SFX archives and used one of the usual sideload\nexecutables such as fsguidll.exe. ZeroT sets up the persistence for these samples, adding a new service to run\nPlugX during system startup (Fig 17).\n\n_Figure 17: ZeroT configures PlugX service to run during startup_\n\nOf interest, a recent ZeroT sample (SHA256:\na9519d2624a842d2c9060b64bb78ee1c400fea9e43d4436371a67cbf90e611b8) downloaded a much smaller\nBMP payload (SHA256: 25de9c3f7bf1f0be7eb84cf90efb643d5d51ce1742da8bcc4c7db0eec79a221f). This was\nan example where the stage 2 payload was distributed using a custom dropper instead of RAR SFX. This\ndropper loads the resources (Fig. 18), decrypts them using the MD5 hash of a command line argument as the\nRC4 key (note: crypto API is used instead of the custom RC4 implementation) and decompresses it with LZNT1\nvia the RtlDecompressBuffer API. There are three Resource items contained in the payload that would\neventually decrypt to: “fsguidll.exe”, “fslapi.dll”, and “flsapi.dll.gui.” Unfortunately, when the payload extracted\nfrom the BMP is executed, no command line argument is provided so none of the resources are properly\ndecrypted and decompressed. Based on the file names and size of fslapi.dll.gui, it is very likely that PlugX is the\nintended stage 2 payload.\n\n_Figure 18: Resources loaded by the custom dropper_\n\n\n-----\n\nFinally, in all other cases where a stage 2 payload was successfully retrieved, PlugX was delivered. None of the\nPlugX samples that we analyzed were issued from new builders (internal version 20141028), and therefore they\ndo not present any kind of new techniques. The extracted PlugX configurations are provided in Appendices A\nand B [11].\n\n**Infrastructure Links**\n\nIn addition to their similar TTPs, ZeroT infrastructure has been continuously shared with NetTraveler and both\nmalware families share the same C&C domains.\n\nThe C&C domain www.tassnews[.]net was used by initial samples of ZeroT in June 2016. It was\nconcurrently used by NetTraveler (example SHA256:\nb43cbc905088c08ee3b71b6e053f91f2c79d71556462eae1c13f1cc8eb5bec72) as well as long prior [3]\nThe C&C domain www.riaru[.]net was observed used by at least one sample of ZeroT (SHA256:\nfc2d47d91ad8517a4a974c4570b346b41646fac333d219d2f1282c96b4571478). This domain was\npreviously tied to NetTraveler as well [3]\nThe C&C domain www.versig[.]net is used by many samples of ZeroT from September 2016 to January\n2017. This domain was also used by many NetTraveler samples as well (example SHA256:\n0d6d789d603d6d9ba68131592fd595c4d82c0288be309876d27a53466158b312) in the time frame from\nOctober 2016 to January 2017\n\nThe PlugX samples downloaded by ZeroT exhibit infrastructure connections to PlugX samples described in our\n2015 blog about this group, “In Pursuit of Optical Fibers and Troop Intel: Targeted Attack Distributes PlugX in\nRussia”. Specifically:\n\nThe C&C domain dicemention[.]com was configured (or not removed from) in the PlugX (SHA256:\n3149fb0ddd89b77ecfb797c4ab4676c63d157a6b22ba4c8f98e8478c24104dfa) downloaded by ZeroT\n(SHA256: d1c4a51064aeec4c11a8f90f80a3b60a36c07cce2dde0756c114e477d63ce375). This domain\nwas also used by PlugX samples described in the 2015 blog\n\nNote also an interesting connection: the hostname www.riaru[.]net resolved to IP 103.200.31[.]110 which also\nresponded for yandax[.]net. One of the PlugX C&Cs (www[.].micrnet[.]net) resolved to 103.229.28[.]133 which\nalso resolved to yandcx[.]com.\n\n_Figure 19: Illustration of infrastructure connections on a limited set of samples_\n\n**Conclusion**\n\n\n-----\n\nThis APT activity represents both a change in TTPs as well as the introduction of new malware known as ZeroT\nby a Chinese state-sponsored attack group that we have previously associated with multiple campaigns.\nProofpoint researchers have predicted that APT activity will continue to increase in the coming year and we will\ncontinue to track developments among state-sponsored actors.\n\n**References**\n\n[1] [https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/](https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/)\n\n[2] [https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia](https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia)\n\n[3] [https://www.proofpoint.com/us/threat-insight/post/nettraveler-apt-targets-russian-european-interests](https://www.proofpoint.com/us/threat-insight/post/nettraveler-apt-targets-russian-european-interests)\n\n[4] [https://en.wikipedia.org/wiki/Microsoft_Compiled_HTML_Help](https://en.wikipedia.org/wiki/Microsoft_Compiled_HTML_Help)\n\n[5] [https://en.wikipedia.org/wiki/Commonwealth_of_Independent_States](https://en.wikipedia.org/wiki/Commonwealth_of_Independent_States)\n\n[6] http://researchcenter.paloaltonetworks.com/2016/06/unit42-recent-mnkit-exploit-activity-reveals-somecommon-threads/\n\n[7] https://www.sophos.com/en-us/medialibrary/PDFs/technical%20papers/sophos-office-exploit-generatorsszappanos.pdf\n\n[8] [https://en.wikipedia.org/wiki/BMP_file_format](https://en.wikipedia.org/wiki/BMP_file_format)\n\n[9] [https://en.wikipedia.org/wiki/Least_significant_bit](https://en.wikipedia.org/wiki/Least_significant_bit)\n\n[10] [http://www.aaronmiller.in/thesis/](http://www.aaronmiller.in/thesis/)\n\n[11] [https://github.com/arbor-jjones/volatility_plugins](https://github.com/arbor-jjones/volatility_plugins)\n\n**Indicators of Compromise (IOCs)**\n\n_RAR / 7-Zip archives_\n\n38566230e5f19d2fd151eaf1744ef2aef946e17873924b91bbeaede0fbfb38cf\n\nee81c939eec30bf9351c9246ecfdc39a2fed78be08cc9923d48781f6c9bd7097\n\nec3405e058b3be958a1d3db410dd438fba7b8a8c28355939c2319e2e2a338462\n\nf2b6f7e0fcf4611cb25f9a24f002ba104ee5cf84528769b2ab82c63ba4476168\n\n_CHM droppers_\n\n4ef91c17b1415609a2394d2c6c353318a2503900e400aab25ab96c9fe7dc92ff\n\nee2e2937128dac91a11e9bf55babc1a8387eb16cebe676142c885b2fc18669b2\n\n74dd52aeac83cc01c348528a9bcb20bbc34622b156f40654153e41817083ba1d\n\n_Word Exploit documents_\n\n9dd730f615824a7992a67400fce754df6eaa770f643ad7e425ff252324671b58\n\n_ZeroT_\n\n09061c603a32ac99b664f7434febfc8c1f9fd7b6469be289bb130a635a6c47c0\n\n\n-----\n\n1e25a8bd1ac2df82d4f6d280af0ecd57d5e4aef88298a2f14414df76db54bcc4\n\n399693f48a457d77530ab88d4763cbd9d3f73606bd860adc0638f36b811bf343\n\n3be2e226cd477138d03428f6046a216103ba9fa5597ec407e542ab2f86c37425\n\n67693ddb6236d3ef790059409ae240212c47acfd8c1c76d65c3ef19096fdf43b\n\n74eb592ef7f5967b14794acdc916686e061a43169f06e5be4dca70811b9815df\n\na16078c6d09fcfc9d6ff7a91e39e6d72e2d6d6ab6080930e1e2169ec002b37d3\n\na685cf4dca6a58213e67d041bba637dca9cb3ea6bb9ad3eae3ba85229118bce0\n\na9519d2624a842d2c9060b64bb78ee1c400fea9e43d4436371a67cbf90e611b8\n\naa7810862ef43d4ef6bec463266b7eb169dbf3f7f953ef955e380e4269137267\n\nb7ee556d1d1b83c5ce6b0c903244c1d3b79654cb950105b2c03996cdd4a70be8\n\nc15255b9a55e7a025cf36aca85eb6cc48571d0b997a93d4dfa4eacb49001cc8d\n\nc5d022f0815aeaa27afb8f1efbce2771d95914be881d288b0841713dbbbeda1a\n\nd1c4a51064aeec4c11a8f90f80a3b60a36c07cce2dde0756c114e477d63ce375\n\nfc2d47d91ad8517a4a974c4570b346b41646fac333d219d2f1282c96b4571478\n\n97016593c53c7eeecd9d3a2788199f6473899ca8f07fafcd4173464f38ee0ab4\n\nPlugX:\n\nb185401a8562614ef42a84bc29f6c21aca31b7811c2c0e680f455b061229a77f\n\n3149fb0ddd89b77ecfb797c4ab4676c63d157a6b22ba4c8f98e8478c24104dfa\n\n07343a069dd2340a63bc04ba2e5c6fad4f9e3cf8a6226eb2a82eb4edc4926f67\n\n_ZeroT C&C_\n\nwww.tassnews[.]net\n\nwww.versig[.]net\n\nwww.riaru[.]net\n\n_PlugX C&C_\n\nwww.micrnet[.]net\n\nwww.dicemention[.]com\n\n_Likely Related C&C_\n\nwww.rumiany[.]com\n\nwww.yandcx[.]com\n\n**ET and ETPRO Suricata/Snort Coverage**\n\n\n-----\n\n2810326,ETPRO TROJAN PlugX Related Checkin\n\n2821027,ETPRO TROJAN APT.ZeroT CnC Beacon Fake User-Agent\n\n2821028,ETPRO TROJAN APT.ZeroT CnC Beacon HTTP POST\n\n2824640,ETPRO TROJAN APT.ZeroT CnC Beacon\n\n2824641,ETPRO TROJAN APT.ZeroT Receiving Config\n\n**Appendix A: Example PlugX Configuration**\n\nSample hash: 07343a069dd2340a63bc04ba2e5c6fad4f9e3cf8a6226eb2a82eb4edc4926f67\n\nPlugX Config (0x36a4 bytes):\n\nHide Dll: 0\n\nKeylogger: -1\n\nSleep1: 167772160\n\nSleep2: 0\n\nCnc: www.micrnet[.]net:80 (HTTP / UDP)\n\nCnc: www.micrnet[.]net:80 (TCP / HTTP)\n\nCnc: www.micrnet[.]net:80 (UDP)\n\nCnc: www.micrnet[.]net:443 (HTTP / UDP)\n\nCnc: www.micrnet[.]net:443 (TCP / HTTP)\n\nCnc: www.micrnet[.]net:443 (UDP)\n\nCnc: www.micrnet[.]net:53 (HTTP / UDP)\n\nCnc: www.micrnet[.]net:53 (TCP / HTTP)\n\nCnc: www.micrnet[.]net:53 (UDP)\n\nPersistence: Run key\n\nInstall Folder: %AUTO%\\TCMyXfeFAd\n\nService Name: pQwEPnz\n\nService Display Name: pQwEPnz\n\nService Desc: Windows pQwEPnz Service\n\nReg Hive: HKCU\n\nReg Key: Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nReg Value: mJqyCsNGBsge\n\nInjection: 1\n\n\n-----\n\nInject Process: %windir%\\explorer.exe\n\nInject Process: %ProgramFiles(x86)%\\Windows Media Player\\wmplayer.exe\n\nInject Process: %windir%\\system32\\svchost.exe\n\nUac Bypass Injection: 1\n\nUac Bypass Inject: %windir%\\explorer.exe\n\nUac Bypass Inject: %windir%\\system32\\rundll32.exe\n\nUac Bypass Inject: %windir%\\system32\\dllhost.exe\n\nUac Bypass Inject: %windir%\\system32\\msiexec.exe\n\nPlugx Auth Str: TEST\n\nCnc Auth Str: DuICS\n\nMutex: Global\\WtMKAPYYxoWMoWW\n\nScreenshots: 0\n\nScreenshots Sec: 10\n\nScreenshots Zoom: 50\n\nScreenshots Bits: 16\n\nScreenshots Qual: 50\n\nScreenshots Keep: 3\n\nScreenshot Folder: %AUTO%\\FS\\screen\n\nEnable Tcp P2P: 1\n\nTcp P2P Port: 1357\n\nEnable Udp P2P: 1\n\nUdp P2P Port: 1357\n\nEnable Icmp P2P: 1\n\nIcmp P2P Port: 1357\n\nEnable Ipproto P2P: 1\n\nIpproto P2P Port: 1357\n\nEnable P2P Scan: 1\n\nP2P Start Scan1: 0.0.0.0\n\nP2P Start Scan2: 0.0.0.0\n\nP2P Start Scan3: 0.0.0.0\n\n\n-----\n\nP2P Start Scan4: 0.0.0.0\n\nP2P End Scan1: 0.0.0.0\n\nP2P End Scan2: 0.0.0.0\n\nP2P End Scan3: 0.0.0.0\n\nP2P End Scan4: 0.0.0.0\n\nMac Disable: 00:00:00:00:00:00\n\n**Appendix B: Example PlugX Configuration**\n\nSample hash: 3149fb0ddd89b77ecfb797c4ab4676c63d157a6b22ba4c8f98e8478c24104dfa\n\nProcess: fsguidll.exe (3980)\n\nPlugX Config (0x36a4 bytes):\n\nHide Dll: 0\n\nKeylogger: -1\n\nSleep1: 167772160\n\nSleep2: 0\n\nCnc: www.dicemention[.]com:80 (HTTP / UDP)\n\nCnc: www.dicemention[.]com:443 (HTTP / UDP)\n\nCnc: www.dicemention[.]com:25 (HTTP / UDP)\n\nCnc: www.dicemention[.]com:80 (TCP / HTTP)\n\nCnc: www.dicemention[.]com:443 (TCP / HTTP)\n\nCnc: www.dicemention[.]com:25 (TCP / HTTP)\n\nCnc: www.dicemention[.]com:80 (UDP)\n\nCnc: www.dicemention[.]com:443 (UDP)\n\nCnc: www.dicemention[.]com:25 (UDP)\n\nPersistence: Service + Run Key\n\nInstall Folder: %AUTO%\\IZBpIciif\n\nService Name: yAjUgUdMGHuvGaZ\n\nService Display Name: yAjUgUdMGHuvGaZ\n\nService Desc: Windows yAjUgUdMGHuvGaZ Service\n\nReg Hive: HKCU\n\nReg Key: Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n-----\n\nReg Value: RqdFqFSYaBx\n\nInjection: 1\n\nInject Process: %windir%\\system32\\svchost.exe\n\nInject Process: %windir%\\explorer.exe\n\nInject Process: %ProgramFiles%\\Internet Explorer\\iexplore.exe\n\nInject Process: %ProgramFiles(x86)%\\Windows Media Player\\wmplayer.exe\n\nUac Bypass Injection: 1\n\nUac Bypass Inject: %windir%\\system32\\msiexec.exe\n\nUac Bypass Inject: %windir%\\explorer.exe\n\nUac Bypass Inject: %windir%\\system32\\rundll32.exe\n\nUac Bypass Inject: %windir%\\system32\\dllhost.exe\n\nPlugx Auth Str: TEST\n\nCnc Auth Str: NBz\n\nMutex: Global\\ksMoQGOTIBJXumYclXtcsAnx\n\nScreenshots: 0\n\nScreenshots Sec: 10\n\nScreenshots Zoom: 50\n\nScreenshots Bits: 16\n\nScreenshots Qual: 50\n\nScreenshots Keep: 3\n\nScreenshot Folder: %AUTO%\\FS\\screen\n\nEnable Tcp P2P: 1\n\nTcp P2P Port: 1357\n\nEnable Udp P2P: 1\n\nUdp P2P Port: 1357\n\nEnable Icmp P2P: 1\n\nIcmp P2P Port: 1357\n\nEnable Ipproto P2P: 1\n\nIpproto P2P Port: 1357\n\nEnable P2P Scan: 1\n\n\n-----\n\nP2P Start Scan1: 0.0.0.0\n\nP2P Start Scan2: 0.0.0.0\n\nP2P Start Scan3: 0.0.0.0\n\nP2P Start Scan4: 0.0.0.0\n\nP2P End Scan1: 0.0.0.0\n\nP2P End Scan2: 0.0.0.0\n\nP2P End Scan3: 0.0.0.0\n\nP2P End Scan4: 0.0.0.0\n\nMac Disable: 00:00:00:00:00:00\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-02 - Oops, they did it again- APT Targets Russia and Belarus with ZeroT and PlugX.pdf"
    ],
    "report_names": [
        "2017-02-02 - Oops, they did it again- APT Targets Russia and Belarus with ZeroT and PlugX.pdf"
    ],
    "threat_actors": [
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "254f2fab-5834-4d90-9205-d80e63d6d867",
            "created_at": "2023-01-06T13:46:38.31544Z",
            "updated_at": "2025-03-27T02:00:02.802896Z",
            "deleted_at": null,
            "main_name": "APT21",
            "aliases": [
                "HAMMER PANDA",
                "TEMP.Zhenbao",
                "NetTraveler"
            ],
            "source_name": "MISPGALAXY:APT21",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536058,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653706160,
    "ts_modification_date": 1653706160,
    "files": {
        "pdf": "https://archive.orkl.eu/effbe19feb600acc29b5af50bb2c888e356b65f0.pdf",
        "text": "https://archive.orkl.eu/effbe19feb600acc29b5af50bb2c888e356b65f0.txt",
        "img": "https://archive.orkl.eu/effbe19feb600acc29b5af50bb2c888e356b65f0.jpg"
    }
}