{
    "id": "4d8e0bba-38d6-439c-acd7-f1d0abfdae78",
    "created_at": "2022-10-25T16:48:10.848787Z",
    "updated_at": "2025-03-27T02:13:29.328158Z",
    "deleted_at": null,
    "sha1_hash": "fa8ae2c7faf9566649c2f8e5f6c8251c6e490bad",
    "title": "The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits",
    "authors": "",
    "file_creation_date": "2020-08-13T21:17:19Z",
    "file_modification_date": "2020-08-13T21:17:19Z",
    "file_size": 2180512,
    "plain_text": "# The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits\n#### Appendix\n\n\n-----\n\n## Introduction\n\nWe have discovered an unusual infection related to Xcode developer projects. Upon further investigation,\nwe learned that a developer’s Xcode project at large contained the source malware — which leads to a\nrabbit hole of malicious payloads. Most notably, we found two zero-day exploits: one is used to steal\n[cookies via a flaw in the behavior of Data Vaults; another is used to abuse the development version of](https://support.apple.com/en-ph/guide/security/sece3bee0835/web)\nSafari. The malware has the capability to hijack Safari and inject various Javascript payloads.\n\nThis scenario is quite unusual; in this case, malicious code is injected into local Xcode projects so that\nwhen the project is built, the malicious code is run. This poses a risk for Xcode developers in particular.\nThe threat escalates when affected developers share their projects via platforms such as GitHub, leading\nto a supply-chain-like attack for users who rely on these repositories as dependencies in their own\nprojects. We have also identified this threat in other sources including VirusTotal and Github, which\nindicates this threat is at large.\n\nIn this technical brief, we will discuss our investigation into this attack which includes the hidden Mach-o\nexecutable, its Applescript payload functions along with the three zero-day exploits we discovered, and\nthe JS payloads it injects to exfiltrate and manipulate data from browsers.\n\n## Initial Entry\n\nXcode is an integrated development environment (IDE) used in macOS for developing Apple-related\nsoftware and is available for free from the Mac AppStore. Since its release, plenty of developers have\nused Xcode for their Apple software needs.\n\nFigure 1. A sample Xcode project and its contents\n\n\n-----\n\nWhen creating a project in Xcode, a project file (.xcodeproj) is generated that contains the code and\nresources to be built together. Inside the project, schema files that contain how each part is mapped are\nalso generated.\n\nFor this incident, we initially traced an infected project’s Xcode work data files and found that a reference\nto another folder was listed instead of to the main folder this workspace has.\n\nFigure 2. Modified workdata string\n\nWe were able to identify a hidden folder located in one of the .xcodeproj files for the project. The hidden\nfolder contains the following:\n\n##### 1. xcassets – Mach-O file malware 2. Assets.xcassets – shell script to call the Mach-O malware\n\nFigure 3. Hidden contents of project\n\nIn one of the project files (.pbxproj), a reference to Assets.xcassets was found. Once the project is built\nand compiled, we suspect that the malicious code is executed.\n\nFigure 4. Reference to hidden contents\n\nIn our testing, executing the Mach-O xcassets shows that it drops the following files in the folder\n~/Library/Caches/GameKit/. Note that the symbol ~ indicates the current user.\n\n##### • .domain – refers to the file containing the target command and control (C&C) server address\n • .report – refers to the file containing the file path and app bundle dropped; its use will be discussed in the next section\n • <number>.jpg – refers to the screenshot of the current desktop; a new screenshot is taken approximately every minute and the filename for the screenshot changed in increments of one. Once a new screenshot is taken, the previous one is deleted.\n • Pods – is a copy of the Mach-O xcasset\n\n\n-----\n\nFigure 5. List of initial dropped files using a file event monitor tool\n\nFigure 6. Contents of hidden files .report and .domain\n\nFigure 7. Contents of the GameKit folder containing the visible dropped files (screenshot and Pods)\n\nIt also drops several application bundles containing a suspicious main.scpt in the current user’s\nApplication Scripts folder, including xcode.app:\n\n\n-----\n\nFigure 8. Dropped app bundles and the malicious AppleScript file\n\nThese dropped app bundles make use of a Mach-O wrapper (applet) to execute the main payload\nmain.scpt. As we can see from the screenshot above, the malware also drops a bundle that masquerades\nas the legitimate Xcode.app but runs the malicious payload in the same way instead.\n\nBy delving deeper into the xcassets Mach-O file, we found that its main purpose is to communicate with\nthe server in order to download and run its main payload, main.scpt. All malicious fake apps are\ngenerated by main.scpt. More details on how this payload works shall be discussed in the following\nsections.\n\n\n-----\n\nFigure 9. TCP stream contents\n\nThe above is the TCP stream output for communication with the IP address 46.101.126.33, which\ncontains its assigned domain, adobestats.com. It is encrypted using RC4 as traced while debugging.\n\n\n-----\n\n## Main Payload\n\nFigure 10. Contents of dropped app bundle Xcode.app found in the Application Scripts folder\n\nFurther checks on main.scpt show that it is compiled as a run-only binary script and can't be decompiled\nwith static methods. After investigating the C&C server, we were able to obtain a plaintext AppleScript\nversion.\n\nChecking this reveals that it holds a lot of functions and calls that are responsible for the observed\ninfection behavior:\n\nFigure 11. List of names for dropped app bundles\n\nA hardcoded list of names to assign dropped app bundles containing the same payload main.scpt is\npresent, which matches dropped bundles found in our testing. The domains adobestats[.]com and\nflixprice[.]com are also listed for use for C&C communication.\n\n\n-----\n\nFigure 12. Code snippet for checking system information\n\nThis code first pings to check if connection is established, then sends the following basic system\ninformation of the infected user:\n\n##### 1. MacOS Version 2. System Language 3. IOPlatformSerialNumber 4. Firewall States 5. SIP Enabled Status\n\nIt then proceeds to kill the running processes listed:\n\n##### 1. com.apple.core 2. com.oracle.java 3. agentd 4. operad 5. edged 6. firefoxd 7. yandexd 8. avatard 9. braved\n\nA majority of these processes are for installed browsers, and their significance is related to the data\nexfiltration features that will be discussed in the next sections.\n\n\n-----\n\nFigure 13. Screenshot of browser-related functions in main.scpt\n\nAs observed in this figure showing the browser-related code, the payload AppleScript file contains various\ncalls to different modules by calling the executor function boot (moduleName, background). This function\ndownloads the module’s AppleScript code from the following to-be-constructed URL:\n\n##### • https://\" & domain & \"/agent/scripts/\" & moduleName & \".applescript  \n\nThis is compiled into a Mac app package through the command osacompile, similarly constructed as:\n\n_osacompile -x -o xcode.app main.applescript_\n\nThe osacompile command is powerful. The parameterized command “osacompile -x -o test\nmain.applescript” will only generate a binary AppleScript file, while “osacompile -x -o xcode.app\nmain.applescript” will generate a completed app folder.\n\nThe package name is based on the input module name and mapping to an installed well-known\napplication name. Furthermore, it replaces the app’s corresponding icon file and \"Info.plist\" to make the\n\n\n-----\n\nfake app look like a real, normal app, and thereby making it hard to distinguish without further\ninvestigation.\n\nFigure 14. Screenshot of a newly generated app by the malware\n\nFigure 15. Code snippet for loading\n\n\n-----\n\nIf the creation of the fake app package is successful, it will then execute the fake app package.\n\nIn the main call stack, the following functions/modules will be called:\n\nFigure 16. Screenshot of calls for the identified payload applescript modules\n\nFinally, it uses the creation timestamp of ~/Library/Caches.GameKit/.report as a reference point to check\nif it should execute its more notable modules, replicator and pods_infect, for injecting the malicious code\ninto local and Cocoapods-packaged Xcode projects respectively.\n\nThe timestamp from .report is compared to the current time taken on the machine. The replicator and\npods_infect functions will be executed 12 hours (43,200 seconds) after the Applescript execution.\n\n\n-----\n\nFigure 17. Code for delay of running replicator and pods_infect\n\n### Payload Modules\n\nBelow is a summary list of the modules identified that we obtained by tracing downloads for each module\nbefore they were compiled:\n\n|Module|Feature|\n|---|---|\n|payloader|Checks last installed module and re-installs entry Mach-O malware (originally called Pods), C&C communication|\n|replicator|Injects local Xcode projects with malicious code|\n|pods_infect|Injects local repository of Xcode Cocoapods projects source-controlled by git|\n|safari_remote|Uses exploit to create fake version from server|\n|safari_update|Updates safari to version 13|\n|safari_cookie|Uses exploit to read Safari cookie data|\n|safari_killer|Checks if safari_remote is already executed, kills running safari process|\n|safari_recover|Checks SIP, replaces safari with malicious one in dock using dockutil|\n|chrome_remote|Downloads backdoor masquerading as browser from server; uses exploit to hijack actual browser|\n|chrome_data|Downloads python script from server; collects credit card and user login data|\n|firefox_remote|Downloads backdoor masquerading as browser from server; uses exploit to hijack actual browser|\n|opera_remote|Downloads backdoor masquerading as browser from server; uses exploit to hijack actual browser|\n|opera_data|Downloads python script from server; collects credit card and user login data|\n|yandex_remote|Downloads backdoor masquerading as browser from server; uses exploit to hijack actual browser|\n|brave_remote|Downloads backdoor masquerading as browser from server; uses exploit to hijack actual browser|\n|edge_remote|Downloads backdoor masquerading as browser from server; uses exploit to hijack actual browser|\n\n\n-----\n\n|360_remote|Downloads backdoor masquerading as browser from server; uses exploit to hijack actual browser|\n|---|---|\n|notes|Collects saved data from notes.app|\n|evernote|Obtains saved accounts from user's Evernote|\n|contacts|Obtains saved contacts from user's QQ/WeChat)/Telegram/Skype|\n|telegram|Obtains local app directory data from user's Telegram|\n|telegram_lite|Obtains local app directory from user's Telegram Lite|\n|skype_session|Collects saved local source Skype directory and Skype session data and sends to server|\n|force_allow_screen_skype|Opens dialog to prompt user to enable security and privacy system preferences|\n|wechat_files|Collects local app directory data from user's WeChat|\n|force_allow_screen_wechat|Displays prompt to make request permission for WeChat screen recording|\n|firewall_off|Turns off firewall via user input|\n|updates_off|Turns off system updates via user input|\n|screen|Re-downloads entry Mach-O Pods, takes a screenshot of current desktop using chkdsk.app/copy of screen.applescript posing as donor app every ~2 minutes (if Catalina) or takes a screenshot via screen capture shell command every ~30 seconds (if Mojave or lower)|\n|encrypter|Performs AES CBC encrypting on files under ~/Documents, ~/Downloads, and ~/Desktop with fixed key and renames to <filename>.enc. Only files with sizes less than 500MB are encrypted.|\n|decrypter|The opposite of encrypter module; finds all *.enc files under ~/Documents, ~/Downloads, and ~/Desktop folder, then performs AES CBC decryption with the same fixed key used in encrypter module|\n|ransom_block|Gets active process list and kills certain critical processes in an infinite loop|\n|ransom_ui|Sends request to server to get ransom note, then shows the ransom note to victim user|\n|exec|(old/commented out) Executes command from server and sends logged files under /Library/Containers, /Library/Group Containers, /Library/Application Support (new) Executes command from server then searches for directories with name containing substring \"evernote\", uploads result to server|\n|finder|Searches for files in Desktop, Documents, Downloads, Dropbox, and WeChat source directory based on server query (including Xcode projects); uploads folders excluding git files to server|\n|finder_app|Executes module payload as Finder app; enumerates all hidden directories in system except inside Pictures and Applications folders|\n|remove_old|Removes ~/Library/Frameworks.app, ~/Library/CoreFramework, and ~/Library/LaunchAgents/com.apple.core.launchd.plist|\n|uploader|In ~/Documents, ~/Desktop, ~/Downloads folder, searches all Xcode project source code folder, compresses them to zip package, and uploads to server. Zip files containing Xcode project source code are uploaded to server as well.|\n|uploader_folder|Compresses whole ~/Desktop folder excluding all .git folders to zip file and uploads to server. If total data size in ~/Desktop folder excluding .git folders is greater than 200MB, then the module will do nothing.|\n|cleaner|Removes ~/Library/LaunchAgents/com.apple.core.accountsd.plist and /Library/Application Support/com.apple.frameworks|\n\n\n-----\n\n|reboot|Shows fake message to user saying that a system update requires a reboot of the operating system|\n|---|---|\n|remote.ssh|Checks if remote login via Secure Socket Shell (SSH) is enabled on the victim’s machine; if not, it will enable remote login by calling command 'do shell script \"sudo launchctl load -w /System/Library/LaunchDaemons/ssh.plist\" with administrator privileges', which needs user authentication. After that, it tries to find or generate SSH key and upload private key file to server, so the attacker can remotely connect via SSH to the victim machine at any time with the private SSH key without inputting username and password.|\n|rnd|Calls ransom_ui.applescript, ransom_block.applescript; before the calling of these two modules, the calling to encryptor module and sleep 600 seconds was being commented now|\n|test|Incomplete script file for testing purpose|\n|bootstrap|original/plaintext version of main.scpt; already discussed as main.scpt|\n|demo|Kills malicious planted Safari dev version (Safari for WebKit development) and relaunches malicious Safari|\n|demo1|Shows a dialog as a blackmail/ransom note to let user contact specified QQ ID, then launches QQ|\n|demo2|Shows dialog containing only string \"demo2\"|\n\n\nWe will now discuss the more notable modules that we believe makes this malware distinct from the rest.\n\n### replicator\n\nThe \"replicator\" module will first download the latest shell script \"Assets.xcassets\" and Mach-O file\n\"xcassets\" from server as preparation for Xcode project infection.\n\nFigure 18. Code for downloading latest copy of module\n\nAfter, it sets the home folder of current login as top folder for searching Xcode projects. If the username is\n\"vladbookpro\", the top folder will be set as ~/Downloads/infect, which suggests that \"vladbookpro\" is the\nusername of the malware author and this logic is to control the infection scope on their own machine.\n\n\n-----\n\nFigure 19. Code mentioning vladbookpro username\n\nIt enumerates all .xcodeproj folders under the top target folder except Pods.xcodeproj, which might be the\nproject name developed by the malware author. If keyword \"3F708E50247A0EB6004066FD\" or\n\"162E3FD122D63A22006D904C\" can be found in project file, the infection process will be skipped to\navoid multiple infections. According to the FORCED_STRATEGY value, it decides whether to infect\nduring the build phase part or build rule part. In the script we have, FORCED_STRATEGY is initialized\nwith empty string, so the script will decide by getting a random number.\n\nFigure 20. Code for strategy selection\n\n\n-----\n\nFigure 21. Payload for build phase infection\n\nFigure 22. Payload for build rule infection\n\nBesides infection on Xcode project directory, it also finds and infects any Xcode projects compressed in\nzip files. To handle zip files, it also downloads a 7za binary from server.\n\nFigure 23. Code for downloading 7za binary\n\n\n-----\n\n### pods_infect\n\nThe pods_infect module is for infecting iOS Xcode projects using CocoaPods packages. It starts by\nenumerating the CocoaPods \"target_integrator.rb\" file under \"/Library/Ruby/Gems\" folder.\n\nFigure 24. Code for enumerating file\n\nTo avoid multiple infections, it checks if the target ruby script file contains the two server domain names.\nAs a matter of fact, however, in following infection logic, none of these two keywords are added to the\nscript file.\n\nFigure 25. Code to avoid multiple infections\n\nAs infection logic, for the current target Xcode project which uses CocoaPods, the code gets\ntarget.user_project_path. It downloads a shell script file \"build.sh\" and Mach-O file \"project.xworkspace\"\nfrom a malicious server and puts these files in a hidden folder .git under the target Xcode project folder.\n\nFigure 26. Code for infection\n\nThe downloaded Mach-O file is exactly the same one downloaded by the replicator module, while the\nshell script file is also quite similar with the one used in the replicator module.\n\n\n-----\n\nFigure 27. Code for added files\n\n### safari_update\n\nThis module downloads a Safari update package from the server, which is named either\nSafari131Mojave.pkg or Safari1304Mojave.pkg. The version chosen is based on the currently installed\nSafari version. The two packages are update packages from Apple with valid code signatures. After it is\ndownloaded, it proceeds to install the Safari update package.\n\n## Data Vault vulnerability used for Safari cookie theft\n\nmacOS protects the Safari cookie file ~/Library/Cookies/Cookies.binarycookies with the System Integrity\nProtection (SIP) feature.\n\nFigure 28. Protection of the Safari cookie file\n\nHowever, we found a bypass method when analyzing the malware’s safari_cookie module. It is a zeroday vulnerability exploitation that is at large. Based on our analysis, the malware tries to steal the safari\ncookie file by using this vulnerability.\n\nFigure 29. Code to acquire Safari cookie file\n\n[This vulnerability is related to how the operating system handles Data Vaults. The behavior is similar to](https://support.apple.com/en-ph/guide/security/sece3bee0835/web)\nwhat would happen if Full Disk Access was granted. Also, the malware checks if TCP port 22 is open on\nthe victim’s system. If not, it will execute the following AppleScript:\n\n\n-----\n\nFigure 30. AppleScript code\n\nRegarding the root cause, we think the SSHD process must have the privilege to read all disks. It will then\nspawn another SCP process to read the restricted file successfully. Both the SSHD and SCP processes\nare running with the common user ID 501. Since the use of port 22 is required for the SSHD and SCP\nprocesses, another way might be implemented in the future to leverage the same exploit if this port is not\navailable.\n\nFigure 31. Relevant code of safari_cookie module\n\nNote that for this vulnerability to be exploited, the user must have administrator privileges or a separate\nsandbox escape vulnerability would be needed. Alternately, the SSHD process can be opened by the\nuser themselves for ease of use.\n\n\n-----\n\n## Safari for WebKit Development zero-day (safari_remote)\n\n### Creating a Fake Safari app\n\nThe purpose of the safari_remote module is to download safari.zip and run-safari-dev.py from the C&C\nserver. It then compiles a fake Safari app with the safari-dev.py and changes all the references from the\nnormal safari.app to the fakeSafari.app — such as the icon, info.plist, item in the dock, and its respective\nitem in the system Launchpad. Functionally, this means that the fake Safari browser runs instead of the\nlegitimate version of Safari.\n\nIn this module's script, the following lines exist:\n\nFigure 32. Safari version-checking code\n\nWe believe that this is the reason that the safari_remote module has a separate module for updating\nSafari to version 13: that is, it needs to leverage the Safari WebKit.\n\nFigure 33. Code for downloading malicious Safari frameworks\n\nNotably, the downloaded safari.zip contains frameworks for Safari.\n\n\n-----\n\nFigure 34. Contents of downloaded file\n\nThis is done so that when the infected user wants to open the normal Safari browser, the fake one will get\nexecuted instead. The downloaded safari.zip also tries to kill instances of the normal Safari browser, and\nthen launch the fake one.\n\nIn the file named WebCore in the zip, a string related to the malware server can be found.\n\nFigure 35. Code related to malware server\n\nThe content of the fake Safari.app is the run-safari-dev.py file, which launches the system process\n/Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment after setting the necessary\nenvironment variables.\n\nWhen a developer opens the process\n/Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment, a dialog like the following\nappears:\n\n\n-----\n\nFigure 36. Access request dialog box\n\nOnly when the user enters the correct password would the SafariForWebKitDevelopment then be\nlaunched.\n\nHowever, we found a bypass method when analyzing this, which we believe is a zero-day exploit in use\nat large. The malware tries to use the un-sandboxed Safari to perform malicious operations without user\napproval. Below is our proof of concept:\n\nFigure 37. Proof of concept for malicious code\n\n### Dylib Hijacking\n\nThe environment variables set in the run-safari-dev.py are DYLD_FRAMEWORK_PATH and\nDYLD_LIBRARY_PATH, which point to the Release folder inside the downloaded safari.zip. The\nsafari.zip contains the fake WebCore.framework. Therefore, when the SafariForWebkitDevelopment is\nlaunched, the crafted frameworks will be loaded.\n\n\n-----\n\nFigure 38. Code for loading malicious framework\n\n## JavaScript Payload Injection in Browser Webpages\n\nWe can get the code snippet from the WebCore binary by searching the following string:\n\nFigure 39. Code for loading Javascript\n\nThe code reference to the string is inside the function:\n\n_WebCore::Document::dispatchWindowLoadEvent(WebCore::Document *this)_\n\nThis means that it will request a malicious Javascript from the malicious server with the following\nparameters:\n\n\n-----\n\n##### • user: current username (base64 encoded)\n • url: current page URL that the user is accessing (base64 encoded) \n • title: current page title that the user is accessing \n\nAfter, it will inject the malicious JavaScript code into the current Safari page. Note that the\nSafariForWebkitDevelopment is not sandboxed for developer usage. This means that the JS payload can\ndo anything without the browser sandbox restriction.\n\nAfter further investigation on the C&C server that relays this JS payload for injecting as Universal CrossSite Scripting (UXSS), we can say that it also injects this on other popular browsers that the infected user\nhas installed. We were able to both uncover the rest of the files stored here and identify its browser\nhijacking capabilities. Below is a summary of the routines we have identified:\n\n##### • Manipulates browser results\n • Manipulates and replace found bitcoin and other cryptocurrency addresses\n • Replaces the Chrome download link with a link to an old version package\n • Steals Google, Yandex, Amocrm, SIPmarket, Paypal, and Apple ID credentials\n • Steals credit card data linked in the Apple Store\n • Prevents the user from changing password but can also record the new password if it is changed\n\n  - Takes screenshots of certain accessed sites\n\n\n-----\n\nFigure 40. Screenshot of agentd.php found in the server, including descriptions of the various JS\n\npayloads for browser injection\n\nHere the payload is used to steal the AppleID account and password. When trying to sign in with an\nApple ID, the following can be seen:\n\nFigure 41. URL of AppleID login site\n\nWe obtained the payload from the C&C server as follows:\n\n\n-----\n\nFigures 42 and 43. Downloaded payload from malicious server\n\n\n-----\n\nFigures 44 and 45. JavaScript to decode payload\n\nThe initial payload contains an encoding routine. By reversing this for decoding, we were able to identify\nthree different kinds of code to inject, depending on the sites that the user accesses. Since these are\nquite long, we will only be highlighting notable sections for each part.\n\n\n-----\n\nDecoded payload part 1:\n\nFigure 46. Decoded Javascript payload, part 1\n\nThis decoded Javascript payload sends user agent and cookie information along with a specified base64\nURL.\n\nAside from this part containing a similar code as part 1, this second part primarily focuses on exfiltrating\ncryptocurrency and other payment-related accounts by tracing transactions.\n\n\n-----\n\nFigures 47 and 48. Decoded Javascript payload, part 2\n\nIt also collects security credentials from the App store:\n\n\n-----\n\nFigures 49-51. Decoded Javascript payload, part 2\n\nBelow are sections of the code related to cryptocurrency:\n\n\n-----\n\n-----\n\nFigures 52-55. Cryptocurrency-related code snippets\n\nInjected code for taking other credentials for certain sites are also present. Meanwhile, certain sites, if\nmatched on access, will cause the payload to not perform anything at all:\n\n\n-----\n\nFigures 56-58. Code for information theft\n\nMeanwhile, for the third part it attempts to obtain AppleID credentials.\n\n\n-----\n\n-----\n\nFigures 59-61. Code to steal AppleID\n\n\n-----\n\n## Impact and Evidence of Compromised Projects and Users\n\n[We have found two Xcode projects infected by the malware from researching online. One happened on](https://github.com/ragulSimpragma/twitterTask/commit/7afdcd360d3547be6027fd9b0fdc40e28bbe8cfc)\n[July 13](https://github.com/ragulSimpragma/twitterTask/commit/7afdcd360d3547be6027fd9b0fdc40e28bbe8cfc) [and the other on July 31. Fortunately, these projects are not too relevant for other users to](https://github.com/yimao009/MVC-MVP-MVVM/commit/2cace311311b52d3113a198ad235de073d2fc22a)\ndownload and integrate these into their own projects. Still, this proves how dangerous the XCSSET\nmalware could be for developers.\n\nFigure 62. Added malware to the compromised project in the latest commit\n\nFrom our investigation of the C&C server, we were able to obtain the list of victim IP addresses that were\ncollected by the malware authors. Out of the 380 entries, users from China are the highest with 152,\nfollowed by users from India with 103.\n\n\n-----\n\n## Conclusion\n\nWith the OS X development landscape rapidly growing and improving – as proven by news on the latest\nBig Sur update, for instance – it’s no surprise that malware actors now also leverage both aspiring and\nseasoned developers alike for their own benefit. Project owners should continue to triple-check the\nintegrity of their projects in order to definitely nip unwarranted problems such as a malware infection in\nthe future.\n\n### MITRE TTP Matrix\n\nMapped MITRE Matrix for XCSSET using the MITRE ATT&CK® Navigator. Tactics, techniques, and\nprocedures (TTPs) highlighted in red are observed behaviors while those in orange are behaviors that\n\nmight happen based on its capabilities.\n\n\n-----\n\n|Indicators of Compromise|Col2|Col3|\n|---|---|---|\n|SHA256|Filenam e|Detection|\n|6fa938770e83ef2e177e8adf4a2ea3d2d5b26107c30f9d85c3d1a55 7db2aed41|main.sc pt|TrojanSpy.MacOS.XCSS ET.A|\n|7e5343362fceeae3f44c7ca640571a1b148364c4ba296ab6f8d264f c2c62cb61|main.sc pt|TrojanSpy.MacOS.XCSS ET.A|\n|857dc86528d0ec8f5938680e6f89d846541a41d62f71d003b74b0c5 5d645cda7|main.sc pt|TrojanSpy.MacOS.XCSS ET.A|\n|6614978ab256f922d7b6dbd7cc15c6136819f4bcfb5a0fead480561f 0df54ca6|xcasset s|TrojanSpy.MacOS.XCSS ET.A|\n|ac3467a04eeb552d92651af1187bdc795100ea77a7a1ac755b4681 c654b54692|xcasset s|TrojanSpy.MacOS.XCSS ET.a|\n|d11a549e6bc913c78673f4e142e577f372311404766be8a3153792 de9f00f6c1|xcasset s|TrojanSpy.MacOS.XCSS ET.A|\n|532837d19b6446a64cb8b199c9406fd46aa94c3fe41111a373426b9ce59f 56f9|speedd|Backdoor.MacOS.XCSSET.A|\n|4f78afd616bfefaa780771e69a71915e67ee6dbcdc1bc98587e219e120f3e a0d|firefoxd|Backdoor.MacOS.XCSSET.A|\n|819ba3c3ef77d00eae1afa8d2db055813190c3d133de2c2c837699a0988 d6493|operad|Backdoor.MacOS.XCSSET.A|\n|73f203b5e37cf34e51f7bf457b0db8e4d2524f81e41102da7a26f5590ab3 2cd9|yandexd|Backdoor.MacOS.XCSSET.A|\n|ccc2e6de03c0f3315b9e8e05967fcc791d063a392277f063980d3a1b39db 2079|edged|Backdoor.MacOS.XCSSET.A|\n|6622887a849b503b120cfef8cd76cd2631a5d0978116444a9cb92b1493e 42c29|braved|Backdoor.MacOS.XCSSET.A|\n|32fa0cdb46f204fc370c86c3e93fa01e5f5cb5a460407333c24dc79953206 443|agentd|Backdoor.MacOS.XCSSET.A|\n|924a89866ea55ee932dabb304f851187d97806ab60865a04ccd91a0d1b9 92246|agentd- kill|Backdoor.MacOS.XCSSET.A|\n|af3a2c0d14cc51cc8615da4d99f33110f95b7091111d20bdba40c91ef759 b4d7|agentd- log|Backdoor.MacOS.XCSSET.A|\n|534f453238cfc4bb13fda70ed2cda701f3fb52b5d81de9d8d00da74bc97ec 7f6|dskwalp|Trojan.MacOS.XCSSET.A|\n|172eb05a2f72cb89e38be3ac91fd13929ee536073d1fe576bc8b8d8d6ec6 c262|chkdsk|Trojan.MacOS.XCSSET.A|\n|a238ed8a801e48300169afae7d27b5e49a946661ed91fab4f792e99243fb c28d|Pods_sh ad|Trojan.MacOS.XCSSET.A|\n\n\n**IP/Domain** **WRS Action**\n\n|IP/Domain|WRS Action|\n|---|---|\n|https://adobestats.com/|Block and Categorized as C&C Server|\n|https://flixprice.com/|Block and Categorized as C&C Server|\n|46.101.126.33|Block and Categorized as C&C Server|\n\n\n-----\n\n**TREND MICRO[TM] RESEARCH**\n\nTrend Micro, a global leader in cybersecurity, helps to make the world safe for exchanging digital information.\n\nTrend Micro Research is powered by experts who are passionate about discovering new threats, sharing key insights, and\nsupporting efforts to stop cybercriminals. Our global team helps identify millions of threats daily, leads the industry in\nvulnerability disclosures, and publishes innovative research on new threats techniques. We continually work to anticipate new\nthreats and deliver thought-provoking research.\n\n**www.trendmicro.com**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://documents.trendmicro.com/assets/pdf/XCSSET_Technical_Brief.pdf"
    ],
    "report_names": [
        "XCSSET_Technical_Brief.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041609,
    "ts_creation_date": 1597353439,
    "ts_modification_date": 1597353439,
    "files": {
        "pdf": "https://archive.orkl.eu/fa8ae2c7faf9566649c2f8e5f6c8251c6e490bad.pdf",
        "text": "https://archive.orkl.eu/fa8ae2c7faf9566649c2f8e5f6c8251c6e490bad.txt",
        "img": "https://archive.orkl.eu/fa8ae2c7faf9566649c2f8e5f6c8251c6e490bad.jpg"
    }
}