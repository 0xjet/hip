{
    "id": "3577c05f-71f2-444d-91c1-67f10c9075d0",
    "created_at": "2023-01-12T15:00:48.144407Z",
    "updated_at": "2025-03-27T02:05:42.698085Z",
    "deleted_at": null,
    "sha1_hash": "d4e0eb3d44044923a533e803557218fecbbc602e",
    "title": "2021-10-18 - Alert (AA21-291A)- BlackMatter Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-29T01:07:21Z",
    "file_modification_date": "2022-05-29T01:07:21Z",
    "file_size": 151601,
    "plain_text": "# BlackMatter Ransomware\n\n**us-cert.cisa.gov/ncas/alerts/aa21-291a**\n\n## Summary\n\n**_Actions You Can Take Now to Protect Against BlackMatter Ransomware_**\n\n_• Implement and enforce backup and restoration policies and procedures._\n\n- Use _[strong, unique passwords.](https://us-cert.cisa.gov/ncas/tips/ST04-002)_\n\n- Use _[multi-factor authentication.](https://us-cert.cisa.gov/ncas/tips/ST05-012)_\n\n_• Implement network segmentation and traversal monitoring._\n\n**_Note: this advisory uses the MITRE Adversarial Tactics, Techniques, and Common_**\n_[Knowledge (ATT&CK®) framework, version 9. See the ATT&CK for Enterprise for all](https://attack.mitre.org/versions/v9/techniques/enterprise/)_\n_referenced threat actor tactics and techniques._\n\nThis joint Cybersecurity Advisory was developed by the Cybersecurity and Infrastructure\nSecurity Agency (CISA), the Federal Bureau of Investigation (FBI), and the National Security\nAgency (NSA) to provide information on BlackMatter ransomware. Since July 2021,\nBlackMatter ransomware has targeted multiple U.S. critical infrastructure entities, including\ntwo U.S. Food and Agriculture Sector organizations.\n\nThis advisory provides information on cyber actor tactics, techniques, and procedures (TTPs)\nobtained from a sample of BlackMatter ransomware analyzed in a sandbox environment as\nwell from trusted third-party reporting. Using embedded, previously compromised\ncredentials, BlackMatter leverages the Lightweight Directory Access Protocol (LDAP) and\nServer Message Block (SMB) protocol to access the Active Directory (AD) to discover all\nhosts on the network. BlackMatter then remotely encrypts the hosts and shared drives as\nthey are found.\n\nRansomware attacks against critical infrastructure entities could directly affect consumer\naccess to critical infrastructure services; therefore, CISA, the FBI, and NSA urge all\norganizations, including critical infrastructure organizations, to implement the\nrecommendations listed in the Mitigations section of this joint advisory. These mitigations will\nhelp organizations reduce the risk of compromise from BlackMatter ransomware attacks.\n\n[Click here for a PDF version of this report.](https://us-cert.cisa.gov/sites/default/files/publications/Joint-CISA-FBI-NSA_CSA_AA21-291A_BlackMatter_Ransomware.pdf)\n\n## Technical Details\n\n**Overview**\n\n\n-----\n\nFirst seen in July 2021, BlackMatter is ransomware-as-a-service (Raas) tool that allows the\nransomware's developers to profit from cybercriminal affiliates (i.e., BlackMatter actors) who\ndeploy it against victims. BlackMatter is a possible rebrand of DarkSide, a RaaS which was\nactive from September 2020 through May 2021. BlackMatter actors have attacked numerous\nU.S.-based organizations and have demanded ransom payments ranging from $80,000 to\n$15,000,000 in Bitcoin and Monero.\n\n**Tactics, Techniques, and Procedures**\n\nThis advisory provides information on cyber actor TTPs obtained from the following sample\nof BlackMatter ransomware, which was analyzed in a sandbox environment, as well as from\ntrusted third parties: SHA-256:\n\n`706f3eec328e91ff7f66c8f0a2fb9b556325c153a329a2062dc85879c540839d . (Note:` click\nhere to see the sample’s page on VirusTotal.)\n\nThe BlackMatter variant uses embedded admin or user credentials that were previously\ncompromised and `NtQuerySystemInformation and` `EnumServicesStatusExW to`\nenumerate running processes and services, respectively. BlackMatter then uses the\nembedded credentials in the LDAP and SMB protocol to discover all hosts in the AD and the\n```\nsrvsvc.NetShareEnumAll Microsoft Remote Procedure Call (MSRPC) function to\n\n```\nenumerate each host for accessible shares. Notably, this variant of BlackMatter leverages\nthe embedded credentials and SMB protocol to remotely encrypt, from the original\ncompromised host, all discovered shares’ contents, including `ADMIN$,` `C$,` `SYSVOL, and`\n```\nNETLOGON .\n\n```\nBlackMatter actors use a separate encryption binary for Linux-based machines and routinely\nencrypt ESXi virtual machines. Rather than encrypting backup systems, BlackMatter actors\nwipe or reformat backup data stores and appliances.\n\nTable 1 maps BlackMatter’s capabilities to the MITRE ATT&CK for Enterprise framework,\nbased on the analyzed variant and trusted third-party reporting.\n\n_Table 1: Black Matter Actors and Ransomware TTPs_\n\n**Tactic** **Technique** **Procedure**\n\n\nPersistence\n\n[[TA0003]](https://attack.mitre.org/versions/v9/tactics/TA0003/)\n\n\nExternal Remote Services\n\n[[T1133]](https://attack.mitre.org/versions/v9/techniques/T1133/)\n\n\nBlackMatter leverages legitimate remote\nmonitoring and management software and\nremote desktop software, often by setting\nup trial accounts, to maintain persistence\non victim networks.\n\n\n-----\n\n**Tactic** **Technique** **Procedure**\n\n\nCredential\nAccess\n\n[[TA0006]](https://attack.mitre.org/versions/v9/tactics/TA0006/)\n\nDiscovery\n\n[[TA0007]](https://attack.mitre.org/versions/v9/tactics/TA0007/)\n\nProcess\nDiscovery\n\n[[T1057]](https://attack.mitre.org/techniques/T1057)\n\nSystem\nService\nDiscovery\n\n[[T1007]](https://attack.mitre.org/versions/v9/techniques/T1007/)\n\nLateral\nMovement\n\n[[TA0008]](https://attack.mitre.org/versions/v9/tactics/TA0008/)\n\nExfiltration\n\n[[TA0010]](https://attack.mitre.org/versions/v9/tactics/TA0010/)\n\nImpact\n\n[[TA0040]](https://attack.mitre.org/versions/v9/tactics/TA0040/)\n\nDisk Wipe\n\n[[T1561]](https://attack.mitre.org/versions/v9/techniques/T1561/)\n\n\nOS Credential Dumping:\n[LSASS Memory [T1003.001]](https://attack.mitre.org/versions/v9/techniques/T1003/001/)\n\nRemote System Discovery\n\n[[T1018]](https://attack.mitre.org/versions/v9/techniques/T1018/)\n\nBlackMatter uses\n```\nNtQuerySystemInformation\n\n```\nto enumerate running\nprocesses.\n\nBlackMatter uses\n```\nEnumServicesStatusExW to\n\n```\nenumerate running services on\nthe network.\n\nRemote Services:\nSMB/Windows Admin Shares\n\n[[T1021.002]](https://attack.mitre.org/versions/v9/techniques/T1021/002/)\n\nExfiltration Over Web Service\n\n[[T1567]](https://attack.mitre.org/versions/v9/techniques/T1567/)\n\nData Encrypted for Impact\n\n[[T1486]](https://attack.mitre.org/versions/v9/techniques/T1486/)\n\nBlackMatter may wipe backup\nsystems.\n\n\nBlackMatter harvests credentials from\nLocal Security Authority Subsystem\nService (LSASS) memory using procmon.\n\nBlackMatter leverages LDAP and SMB\nprotocol to discover all hosts in the AD.\n\nBlackMatter uses\n```\nsrvsvc.NetShareEnumAll MSRPC\n\n```\nfunction to enumerate and SMB to connect\nto all discovered shares, including\n```\nADMIN$, C$, SYSVOL, and NETLOGON .\n\n```\nBlackMatter attempts to exfiltrate data for\nextortion.\n\nBlackMatter remotely encrypts shares via\nSMB protocol and drops a ransomware\nnote in each directory.\n\n\n## Detection Signatures\n\nThe following Snort signatures may be used for detecting network activity associated with\nBlackMatter activity.\n\nIntrusion Detection System Rule:\n\n\n-----\n\n```\nalert tcp any any -> any 445 ( msg: BlackMatter remote encryption attempt ;\n content:\"|01 00 00 00 00 00 05 00 01 00|\"; content:\"|2e 00 52 00 45 00 41\n00 44 00 4d 00 45 00 2e 00 74 00|\"; distance:100; detection_filter: track\nby_src, count 4, seconds 1; priority:1; sid:11111111111; )\n\n```\nInline Intrusion Prevention System Rule:\n```\nalert tcp any any -> any 445 ( msg:\"BlackMatter remote encryption attempt\";\n content:\"|01 00 00 00 00 00 05 00 01 00|\"; content:\"|2e 00 52 00 45 00 41\n00 44 00 4d 00 45 00 2e 00 74 00|\"; distance:100; priority:1; sid:10000001;\n)\nrate_filter gen_id 1, sig_id 10000001, track by_src, count 4, seconds 1,\nnew_action reject, timeout 86400\n\n## Mitigations\n\n```\nCISA, the FBI, and NSA urge network defenders, especially for critical infrastructure\norganizations, to apply the following mitigations to reduce the risk of compromise by\nBlackMatter ransomware:\n\n**Implement Detection Signatures**\n\n**Implement the detection signatures identified above. These signatures will identify**\nand block placement of the ransom note on the first share that is encrypted,\nsubsequently blocking additional SMB traffic from the encryptor system for 24 hours.\n\n**Use Strong Passwords**\n\n**Require all accounts with password logins (e.g., service account, admin**\n**accounts, and domain admin accounts.) to have** **[strong, unique passwords.](https://www.us-cert.cisa.gov/ncas/tips/ST04-002)**\nPasswords should not be reused across multiple accounts or stored on the system\nwhere an adversary may have access. Note: devices with local administrative\naccounts should implement a password policy that requires strong, unique passwords\nfor each individual administrative account.\n\n**Implement Multi-Factor Authentication**\n\n**[Require multi-factor authentication for all services to the extent possible, particularly](https://us-cert.cisa.gov/ncas/tips/ST05-012)**\nfor webmail, virtual private networks, and accounts that access critical systems.\n\n**Patch and Update Systems**\n\n**Keep all operating systems and software up to date. Timely patching is one of the**\nmost efficient and cost-effective steps an organization can take to minimize its\nexposure to cybersecurity threats.\n\n**Limit Access to Resources over the Network**\n\n\n-----\n\n**Remove unnecessary access to administrative shares, especially** `ADMIN$ and`\n```\n   C$ . If ADMIN$ and C$ are deemed operationally necessary, restrict privileges to\n\n```\nonly the necessary service or user accounts and perform continuous monitoring for\nanomalous activity.\n**Use a host-based firewall to only allow connections to administrative shares via SMB**\nfrom a limited set of administrator machines.\n\n**Implement Network Segmentation and Traversal Monitoring**\n\nAdversaries use system and network discovery techniques for network and system visibility\nand mapping. To limit an adversary from learning the organization’s enterprise environment,\nlimit common system and network discovery techniques by taking the following actions.\n\n**Segment networks to prevent the spread of ransomware. Network segmentation can**\nhelp prevent the spread of ransomware by controlling traffic flows between—and\naccess to—various subnetworks and by restricting adversary lateral movement.\n**Identify, detect, and investigate abnormal activity and potential traversal of the**\n**indicated ransomware with a networking monitoring tool. To aid in detecting the**\nransomware, implement a tool that logs and reports all network traffic, including lateral\nmovement activity on a network. Endpoint detection and response (EDR) tools are\nparticularly useful for detecting lateral connections as they have insight into common\nand uncommon network connections for each host.\n\n**Use Admin Disabling Tools to Support Identity and Privileged Access Management**\n\nIf BlackMatter uses compromised credentials during non-business hours, the compromise\nmay not be detected. Given that there has been an observed increase in ransomware\nattacks during non-business hours, especially holidays and weekends, CISA, the FBI, and\nNSA recommend organizations:\n\n**Implement time-based access for accounts set at the admin-level and higher. For**\nexample, the [Just-in-Time (JIT) access method provisions privileged access when](https://www.cyberark.com/what-is/just-in-time-access/#:~:text=JIT%20Access%20Explained%20Using%20the%20just-in-time%20%28JIT%29%20access,system%20in%20order%20to%20perform%20a%20necessary%20task)\nneeded and can support enforcement of the principle of least privilege (as well as the\nZero Trust model). This is a process where a network-wide policy is set in place to\nautomatically disable admin accounts at the AD level when the account is not in direct\nneed. When the account is needed, individual users submit their requests through an\nautomated process that enables access to a system, but only for a set timeframe to\nsupport task completion.\n**Disable command-line and scripting activities and permissions. Privilege**\nescalation and lateral movement often depend on software utilities that run from the\ncommand line. If threat actors are not able to run these tools, they will have difficulty\nescalating privileges and/or moving laterally.\n\n**Implement and Enforce Backup and Restoration Policies and Procedures**\n\n\n-----\n\n**Maintain offline backups of data, and regularly maintain backup and restoration. This**\npractice will ensure the organization will not be severely interrupted, have irretrievable\ndata, or be held up by a ransom demand.\n**Ensure all backup data is** **[encrypted, immutable (i.e., cannot be altered or deleted)](https://www.dataversity.net/how-to-survive-a-ransomware-attack-five-backup-best-practices/)**\nand covers the entire organization’s data infrastructure.\n\nCISA, the FBI, and NSA urge critical infrastructure organizations to apply the following\nadditional mitigations to reduce the risk of credential compromise.\n\n**Disable the storage of clear text passwords in LSASS memory.**\n**Consider disabling or limiting New Technology Local Area Network Manager**\n**(NTLM) and WDigest Authentication.**\n**Implement Credential Guard for Windows 10 and Server 2016 (Refer to Microsoft:**\nManage Windows Defender Credential Guard for more information). For Windows\nServer 2012R2, enable Protected Process Light for Local Security Authority (LSA).\n**Minimize the AD attack surface to reduce malicious ticket-granting activity. Malicious**\nactivity such as “Kerberoasting” takes advantage of Kerberos’ Ticket Granting service\nand can be used to obtain hashed credentials that attackers attempt to crack.\n\nSet a [strong password policy for service accounts.](https://www.us-cert.cisa.gov/ncas/tips/ST04-002)\nAudit Domain Controllers to log successful Kerberos Ticket-Granting Service\nrequests and ensure the events are monitored for anomalous activity.\n\nRefer to the CISA-Multi-State information and Sharing Center (MS-ISAC) Joint Ransomware\nGuide for general mitigations to prepare for and reduce the risk of compromise by\nransomware attacks.\n\n**Note: critical infrastructure organizations with industrial control systems/operational**\ntechnology networks should review joint CISA-FBI Cybersecurity Advisory AA21-131A:\n[DarkSide Ransomware: Best Practices for Preventing Business Disruption from](https://us-cert.cisa.gov/ncas/alerts/aa21-131a)\nRansomware Attacks for more mitigations, including mitigations to reduce the risk of severe\nbusiness or functional degradation should their entity fall victim to a ransomware attack.\n\n## Responding to Ransomware Attacks\n\nIf a ransomware incident occurs at your organization, CISA, the FBI, and NSA recommend:\n\n**Following the Ransomware Response Checklist on p. 11 of the** CISA-Multi-State\nInformation Sharing and Analysis Center (MS-ISAC) Joint Ransomware Guide.\n**Scanning backups. If possible, scan backup data with an antivirus program to check**\nthat it is free of malware.\n**Reporting incidents immediately to the FBI at a** [local FBI Field Office, CISA at](https://www.fbi.gov/contact-us/field-offices) uscert.cisa.gov/report, or the U.S. Secret Service at a [U.S. Secret Service Field Office.](http://www.secretservice.gov/contact/field-offices/)\n\n\n-----\n\n**Applying incident response best practices found in the joint Advisory, Technical**\nApproaches to Uncovering and Remediating Malicious Activity, developed by CISA and\nthe cybersecurity authorities of Australia, Canada, New Zealand, and the United\nKingdom.\n\n**Note: CISA, the FBI, and NSA strongly discourage paying a ransom to criminal actors.**\nPaying a ransom may embolden adversaries to target additional organizations, encourage\nother criminal actors to engage in the distribution of ransomware, and/or may fund illicit\nactivities. Paying the ransom also does not guarantee that a victim’s files will be recovered.\n\n## Resources\n\nFor more information and resources on protecting against and responding to\nransomware, refer to [StopRansomware.gov, a centralized, whole-of-government](https://www.cisa.gov/stopransomware/)\nwebpage providing ransomware resources and alerts.\nCISA’s [Ransomware Readiness Assessment (RRA) is a no-cost self-assessment](https://github.com/cisagov/cset/releases/tag/v10.3.0.0)\nbased on a tiered set of practices to help organizations better assess how well they are\nequipped to defend and recover from a ransomware incident.\n[CISA offers a range of no-cost cyber hygiene services to help critical infrastructure](https://www.cisa.gov/cyber-hygiene-services)\norganizations assess, identify, and reduce their exposure to threats, including\nransomware. By requesting these services, organizations of any size could find ways to\nreduce their risk and mitigate attack vectors.\n\n## Contact Information\n\n[Victims of ransomware should report it immediately to CISA at us-cert.cisa.gov/report, a](https://us-cert.cisa.gov/report) local\nFBI Field Office, or [U.S. Secret Service Field Office. When available, please include the](http://www.secretservice.gov/contact/field-offices/)\nfollowing information regarding the incident: date, time, and location of the incident; type of\nactivity; number of people affected; type of equipment used for the activity; the name of the\nsubmitting company or organization; and a designated point of contact. For NSA client\nrequirements or general cybersecurity inquiries, contact the NSA Cybersecurity\n[Requirements Center at 410-854-4200 or Cybersecurity_Requests@nsa.gov.](http://10.10.0.46/mailto:Cybersecurity_Requests@nsa.gov)\n\nThis document was developed by CISA, the FBI, and NSA in furtherance of their respective\ncybersecurity missions, including their responsibilities to develop and issue cybersecurity\nspecifications and mitigations.\n\n**Note: the information you have accessed is being provided “as is” for informational purposes**\nonly. CISA, the FBI, and NSA do not endorse any commercial product or service, including\nany subjects of analysis. Any reference to specific commercial products, processes, or\nservices by service mark, trademark, manufacturer, or otherwise, does not constitute or imply\ntheir endorsement, recommendation, or favoring by CISA, the FBI, or NSA.\n\n## Revisions\n\n\n-----\n\nOctober 18, 2021: Initial Version\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/alerts/aa21-291a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-18 - Alert (AA21-291A)- BlackMatter Ransomware.pdf"
    ],
    "report_names": [
        "2021-10-18 - Alert (AA21-291A)- BlackMatter Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535648,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653786441,
    "ts_modification_date": 1653786441,
    "files": {
        "pdf": "https://archive.orkl.eu/d4e0eb3d44044923a533e803557218fecbbc602e.pdf",
        "text": "https://archive.orkl.eu/d4e0eb3d44044923a533e803557218fecbbc602e.txt",
        "img": "https://archive.orkl.eu/d4e0eb3d44044923a533e803557218fecbbc602e.jpg"
    }
}