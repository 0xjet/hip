{
    "id": "2da7c38e-6050-454d-8ea4-299d8cb8c746",
    "created_at": "2023-12-12T02:06:22.195925Z",
    "updated_at": "2025-03-27T02:10:19.344389Z",
    "deleted_at": null,
    "sha1_hash": "ef854d3ab06b7acc16e2ab04a760468966d07805",
    "title": "AeroBlade on the Hunt Targeting the U.S. Aerospace Industry",
    "authors": "Blackberry",
    "file_creation_date": "2023-12-11T02:49:44Z",
    "file_modification_date": "2023-12-11T02:49:44Z",
    "file_size": 2431560,
    "plain_text": "# AeroBlade on the Hunt Targeting the U.S. Aerospace Industry\n\n**[blogs.blackberry.com/en/2023/11/aeroblade-on-the-hunt-targeting-us-aerospace-industry](https://blogs.blackberry.com/en/2023/11/aeroblade-on-the-hunt-targeting-us-aerospace-industry)**\n\nDmitry Bestuzhev, The BlackBerry Research & Intelligence Team\n\n### Summary\n\nBlackBerry has uncovered a previously unknown threat actor targeting an aerospace organization in\nthe United States, with the apparent goal of conducting commercial and competitive cyber espionage.\nThe [BlackBerry Threat Research and Intelligence team is tracking this threat actor as AeroBlade. The](https://blogs.blackberry.com/en/author/the-blackberry-research-and-intelligence-team)\nactor used spear-phishing as a delivery mechanism: A weaponized document, sent as an email\nattachment, contains an embedded remote template injection technique and a malicious VBA macro\ncode, to deliver the next stage to the final payload execution.\n\nEvidence suggests that the attacker’s network infrastructure and weaponization became operational\naround September 2022. BlackBerry assesses with medium to high confidence that the offensive\nphase of the attack occurred in July 2023. The attacker improved its toolset during that time, making it\nstealthier, while the network infrastructure remained the same.\n\nGiven the final payload functionality and the subject of the attack, BlackBerry assesses with medium\nto high confidence that the goal of this attack was commercial cyber espionage.\n\n### Brief MITRE ATT&CK Information®\n\n#### Tactic Technique\n\n Initial Access T1566.001\n\n Execution T1204.002, T1059.005, T1203, T1559.002, T1559.001, T1106, T1059.003\n\n Defense Evasion T1027, T1140, T1221, T1036.005, T1027.001,\n\n Persistence T1137.001, T1053.005\n\n Command-and- T1071.001, T1001, T1573.001, T1105 Control\n\n Exfiltration T1041, T1029\n\n|Tactic|Technique|\n|---|---|\n|Initial Access|T1566.001|\n|Execution|T1204.002, T1059.005, T1203, T1559.002, T1559.001, T1106, T1059.003|\n|Defense Evasion|T1027, T1140, T1221, T1036.005, T1027.001,|\n|Persistence|T1137.001, T1053.005|\n|Command-and- Control|T1071.001, T1001, T1573.001, T1105|\n\n\n-----\n\n#### Discovery T1083, T1082, T1033, T1016\n\n### Weaponization and Technical Overview\n\n#### Weapons MS Office documents, PE 64\n\n Attack Vector Spear-phishing\n\n Network Infrastructure C2 server on port 443\n\n Targets Aerospace industry in the United States\n\n### Technical Analysis\n\n**Context**\n\nThe BlackBerry Threat Research and Intelligence team recently uncovered two campaigns by a\npreviously unknown threat actor, which we have named AeroBlade, targeting an aerospace industry\ncompany in the U.S. We found two phases of the attack chain. The initial attack was conducted in\nSeptember 2022, and based on our technical analysis, we have concluded this was a “testing” stage.\nThe second attack occurred in July 2023.\n\nThere are certain similarities between both campaigns:\n\nBoth lure documents were named “[redacted].docx.”\nThe final payload is a reverse shell.\nThe command-and-control (C2) server IP address is the same.\n\nThere are also some interesting differences between the two campaigns:\n\nThe final payload of the 2023 attack is stealthier and uses more obfuscation and anti-analysis\ntechniques.\nThe 2023 campaign's final payload includes an option to list directories from infected victims.\n\nDuring an attack, a malicious Microsoft Word document called [redacted].docx is delivered via email\nspear-phishing, which, when executed manually by the user, employs a remote template injection to\ndownload a second stage file called “[redacted].dotm”. This file in turn executes \"item3.xml\", which\ncreates a reverse shell connecting to \"redacted[.]redacted[.]com\" over port 443.\n\n|Weapons|MS Office documents, PE 64|\n|---|---|\n|Attack Vector|Spear-phishing|\n|Network Infrastructure|C2 server on port 443|\n|Targets|Aerospace industry in the United States|\n\n\n-----\n\n_Figure 1 — AeroBlade execution chain_\n\n### Attack Vector\n\n**First Stage**\n\nThe first stage of the infection is a targeted email that has a malicious document attachment with the\nfilename [redacted].docx. When opened, the document displays text in a deliberately scrambled font,\nalong with a “lure” message asking the potential victim to click it to enable the content in MS Office.\n\nThe docx document employs remote template injection, MITRE ATT&CK technique [T1221, to](https://attack.mitre.org/techniques/T1221/)\ndownload the second stage of the infection.\n\n\n-----\n\n_Figure 2 — The malicious document displays text in a scrambled font, along with a visual lure asking_\n_the user to click it to enable content_\n\n_Figure 3 — The “fixed” document that appears once the victim clicks the lure message to manually_\n_enable content_\n\nThe next-stage information is saved in an XML (eXtensible Markup Language) file inside a .dotm file.\nA .dotm file is a document template created by Microsoft Word, containing the default layout, settings,\nand macros for a document.\n\n_Figure 4 — Next stage parameter in the OLE file_\n\nhxxp://[redacted].106.27. [redacted]/[redacted][.]dotm\n\nOnce the victim opens the file and executes it by manually clicking the “Enable Content” lure\nmessage, the [redacted].dotm document discretely drops a new file to the system, and opens it. The\nnewly downloaded document is readable, leading the victim to believe that the file initially received by\nemail is legitimate. In fact, it’s a classic cyber bait-and-switch, performed invisibly right under the\nvictim’s nose.\n\n\n-----\n\n_Figure 5 — A second document is discretely downloaded and opened in place of the original_\n_malicious document_\n\nIt’s interesting to note that the body of the first-stage document contains an executable library that\nruns with the help of the second stage — we’ll take a closer look at this executable library a little later\non in this report.\n\n_Figure 6 — Location of the executable library in the file list in the [redacted].docx document_\n\n### Second Stage\n\nThe second stage of execution is the OLE document which contains the macro. The macro runs the\nlibrary included in the first-stage document.\n\n\n-----\n\n_Figure 7 — A macro that runs a malicious PE file_\n\nThe second-stage macro also copies the OLE document ([redacted].docx) to a hard-coded file name\nat a specific path:\n\n**C:\\Users\\user\\AppData\\Local\\Temp\\[redacted].zip**\n\nThe final execution stage will be an executable file run on the system using the macro.\n\n### Payload\n\nThe final payload is a DLL that acts as a reverse shell that connects to a hard-coded C2 server.\nReverse shells allow attackers to open ports to the target machines, forcing communication and\nenabling a complete takeover of the device. It is therefore a severe security threat.\n\nThe DLL is also capable of listing all directories found on the now-infected system. It is a heavily\nobfuscated executable which implements complex techniques, such as:\n\nAnti-disassembly techniques to make analysis harder\nAPI hashing to hide its usage of Windows functions; The hash function used is [Murmur.](https://greenrobot.org/what-is-murmur-and-what-is-murmur-3a-and-murmer3f/)\nCustom encoding for each string used\nMultiple checks are implemented to avoid the malware running on an automated environment\nsuch as a sandbox; This impedes analysis.\n\nFor anti-disassembly, the executable contains control flow obfuscation, usage of data between code,\nand dead code-executed instructions that do not affect the malware. Dead code is a section in the\nsource code of a program which is executed, but whose result is never used in any other computation.\nThese techniques are all added to make analysis harder for defenders.\n\n\n-----\n\n_Figure 8 — Example of data between code, control flow obfuscation, and use of dead code_\n\n_Figure 9 — Usage of_ _[evil byte, a common technique to defeat the way disassembler tools work](https://medium.com/swlh/assembly-wrapping-a-new-technique-for-anti-disassembly-c144eb90e036)_\n\n_Figure 10 — Fixed evil byte showing real code execution_\n\nThe executable also implements techniques that causes the malware to skip execution on automated\nsystems, such as sandboxes or antivirus (AV) emulators. These techniques include:\n\nComparing the position of the mouse cursor using the GetCursorPos() function\nComparing time elapsed on execution using the function GetTickCount()\nChecking to see if the number of processors is less than two, using the NumberOfProcessors\nfrom the Process Environment Block (PEB) structure\nChecking physical memory size using the function GlobalMemoryStatusEx()\n\n_Figure 11 — Checking number of processors used by the victim’s machine_\n\n\n-----\n\n_Figure 12 — Checking available physical memory on the victim’s machine_\n\nAfter passing all those checks, the malicious DLL executes the following sequence:\n\nDecrypts embedded static configuration containing the C2 server information for it to connect to\nCollects system information from the infected machine\nSets persistence to survive upon system reboot\nFinally, it connects to the C2 server, transmitting all its collected information, and spawning a\nreverse shell, while also sending a list of directories found on the infected system.\n\n_Figure 13 — Static configuration_\n\nStatic configuration is AES encrypted, and once decrypted, contains the following structure:\n\nFirst DWORD: 0x154, unknown usage, static config size is hard-coded at 72 bytes\nSecond DWORD: 0x1BB, connects to TCP port 443\n16-byte string “Pa$$w0rd” seems to be a password to connect to the C2, but it is not used in\npractice\nC2 server points to: redacted[.]redacted[.]com\n\n\n-----\n\n_Figure 14 — Example of information collected from infected system_\n\nBot-collected data structure is as follows:\n\nOffset 0x3: hard-coded unknown 16 bytes computed by custom unknown encode functions\nOffset 0x13: username using function GetUserNameA()\nOffset 0x43: computer name using function GetComputerNameA()\nOffset 0x73: file name being executed using function GetModuleFileNameA()\nOffset 0x178: IPV4 addresses using function GetAdaptersInfo()\nOffset0x1b8: MAC addresses using function GetAdaptersInfo()\n\nPersistence is achieved via Windows Task Scheduler, where a task named “WinUpdate2” is created\nto run every day at 10:10 AM. Task Scheduler functions are abused by using its COM object via the\nCoCreateInstance() function.\n\n\n-----\n\n_Figure 15 — Persistence is established through Windows Task Scheduler_\n\n### Reverse Shell\n\nFinally, the reverse shell is executed in a stealthy way. First, it gets the default standard handle by\ncalling GetStdHandle(), then the ComSpec variable is retrieved using the GetEnvironmentVariableW()\nfunction, which by default is set to “C:\\Windows\\system32\\cmd.exe”. After that, a pipe is created\nusing CreatePipe(), and CreateProcessW() is executed, creating “cmd.exe.”\n\n_Figure 16 — cmd.exe CreateProcess_\n\nBesides the reverse shell, the final payload can collect a complete list of directories on the victim’s\nsystem by using the function GetLogicalDeviceStringsW(), looping through the list of files using\nFindFirstFileA()/FindNextFileA(), and then comparing with “..” to see if a given file is actually a\ndirectory.\n\n_Figure 17 — String comparison with directories_\n\nDuring our investigations, we found two samples from mid-2022: \"5[redacted sha-256]7\" and\n\"5[redacted sha-256]8\", which is also a reverse shell with a hard-coded C2 at \"[redacted][.]165\" —\nthe same IP address that the C2 server from the 2023 samples are pointing to. Both samples were\n\n\n-----\n\ntargeting the aerospace industry.\n\nWhile the 2022 samples are obfuscated, unlike the 2023 samples, they do not contain stealthier\nfunctions such as API hashing, anti-analysis techniques, or encrypted static configuration. They also\ndon’t include the capability to list directories, nor are they able to send information to a remote server.\n\n### Network Infrastructure\n\n#### IP Domain Name\n\n [redacted].217 hxxp://[redacted].217/[redacted][.]dotm\n\n hxxp://[redacted].217/[redacted]\n\n [redacted].195 redacted.redacted.com\n\n [redacted].165 redacted.redacted.com\n\n### Targets and Attribution\n\nBased on the content of the lure message, an aerospace company in the United States was the\nintended target for both campaigns.\n\nThe development of this threat group's toolkit indicates that the operator has been active for at least\none year. Exactly who is behind these two campaigns remains unknown.\n\n### Conclusions\n\nGiven the relatively sophisticated technical capabilities this threat actor deployed and the victim's\ntimelines, we conclude with a high degree of confidence that this was a commercial cyberespionage\ncampaign. Its purpose was most likely to gain visibility over the internal resources of its target in order\nto weigh its susceptibility to a future ransom demand.\n\nBased on the threat actor’s operations timelines — September 2022 and then July 2023 — we can\nsurmise that this shows the group’s interest in the target remained consistent between the first and\nsecond campaign, as evidenced by the increased complexity of the second campaign compared to\nthe first. During the time that elapsed between the two campaigns we observed, the threat actor put\nconsiderable effort into developing additional resources to ensure they could secure access to the\nsought-after information, and that they could exfiltrate it successfully.\n\n### APPENDIX 1 – Referential Indicators of Compromise (IoCs)\n\n|IP|Domain Name|\n|---|---|\n|[redacted].217|hxxp://[redacted].217/[redacted][.]dotm hxxp://[redacted].217/[redacted]|\n|[redacted].195|redacted.redacted.com|\n|[redacted].165|redacted.redacted.com|\n\n\n-----\n\n#### Second Stage\n\n Sha 265\n MD5\n\n Sha 265\n MD5\n\n Sha 256\n MD5\n\n\n#### 16bd34c3f00288e46d8e3fdb67916aa7c68d8a0622f2c76c57112dae36c76875\n 885B04081BD89F5E23CBC59723052601\n\n 6d515dafef42a5648754de3c0fa6adfcb8b57af1c1d69e629b0d840dab7f91ec\n 62D3FF36EC8A721488E512E1C94B2744\n\n abc348d3cc40521afc165aa6dc2d66fd9e654d91e3d66461724ac9490030697f\n A04D2C0AA0A798047161118B5D5816AA\n\n\n**_Disclaimer: The private version of this report is available upon request. It includes but is not limited_**\n_to, the complete and contextual MITRE ATT&CK mapping, MITRE D3FEND™ countermeasures,®_\n_Attack Flow by MITRE, and other threat detection content for tooling, network traffic, complete IoCs_\n_list, Yara rules, Sigma rules, and system behavior. Please email us at_ **_[cti@blackberry.com for more](mailto:%20cti@blackberry.com)_**\n_information._\n\n_For similar articles and news delivered straight to your inbox,_ _subscribe to the_ **_[BlackBerry Blog.](https://blogs.blackberry.com/en/home#:~:text=Sign%20up%20to%20get%20the%20latest%20from%20BlackBerry%20Blogs%20straight%20to%20your%20inbox.)_**\n\n**Related Reading**\n\n## About Dmitry Bestuzhev\n\n[Dmitry Bestuzhev is Senior Director, CTI (Cyber Threat Intelligence) at BlackBerry.](https://www.linkedin.com/in/bestuzhev/)\n\nPrior to BlackBerry, Dmitry was Head of Kaspersky's Global Research and Analysis Team for Latin\nAmerica, where he oversaw the company's experts' anti-malware development work in the region.\nDmitry has more than 20 years of experience in IT security across a wide variety of roles. His field of\nexpertise covers everything from traditional online fraud to targeted high-profile attacks on financial\nand governmental institutions. His main focus in research is on producing Threat Intelligence reports\non financially motivated targeted attacks.\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing\nintelligence analysis for the benefit of defenders and the organizations they serve.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/d4eigscymt12dg8lsnevf48duihx5bwz"
    ],
    "report_names": [
        "Blackberry_AeroBlade-Targeting-US-Aerospace-Industry(11-30-2023)"
    ],
    "threat_actors": [
        {
            "id": "b2d90939-4491-40e6-9ba1-7f97f6908af9",
            "created_at": "2024-01-18T02:02:33.896267Z",
            "updated_at": "2025-03-27T02:02:09.72341Z",
            "deleted_at": null,
            "main_name": "AeroBlade",
            "aliases": [],
            "source_name": "ETDA:AeroBlade",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e7501832-edc8-4dff-a979-17cdc3091f82",
            "created_at": "2023-12-08T02:00:05.738096Z",
            "updated_at": "2025-03-27T02:00:03.263469Z",
            "deleted_at": null,
            "main_name": "AeroBlade",
            "aliases": [],
            "source_name": "MISPGALAXY:AeroBlade",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1702346782,
    "ts_updated_at": 1743041419,
    "ts_creation_date": 1702262984,
    "ts_modification_date": 1702262984,
    "files": {
        "pdf": "https://archive.orkl.eu/ef854d3ab06b7acc16e2ab04a760468966d07805.pdf",
        "text": "https://archive.orkl.eu/ef854d3ab06b7acc16e2ab04a760468966d07805.txt",
        "img": "https://archive.orkl.eu/ef854d3ab06b7acc16e2ab04a760468966d07805.jpg"
    }
}