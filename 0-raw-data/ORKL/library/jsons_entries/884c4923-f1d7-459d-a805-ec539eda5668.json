{
    "id": "884c4923-f1d7-459d-a805-ec539eda5668",
    "created_at": "2023-01-12T15:06:48.639606Z",
    "updated_at": "2025-03-27T02:17:27.702747Z",
    "deleted_at": null,
    "sha1_hash": "4059bddc1b5236652b6f90d306de6298f0a374db",
    "title": "2017-12-15 - Introducing the Adversary Playbook- First up, OilRig",
    "authors": "",
    "file_creation_date": "2022-05-28T17:06:37Z",
    "file_modification_date": "2022-05-28T17:06:37Z",
    "file_size": 318079,
    "plain_text": "# Introducing the Adversary Playbook: First up, OilRig\n\n**[unit42.paloaltonetworks.com/unit42-introducing-the-adversary-playbook-first-up-oilrig/](https://unit42.paloaltonetworks.com/unit42-introducing-the-adversary-playbook-first-up-oilrig/)**\n\nRyan Olson December 15, 2017\n\nBy [Ryan Olson](https://unit42.paloaltonetworks.com/author/ryan-olson/)\n\nDecember 15, 2017 at 1:00 PM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [OilRig,](https://unit42.paloaltonetworks.com/tag/oilrig/) [playbook,](https://unit42.paloaltonetworks.com/tag/playbook/) [tools](https://unit42.paloaltonetworks.com/tag/tools/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-introducing-the-adversary-playbook-first-up-oilrig/)\n\nOver the past few years, we’ve been tossing around the idea of an “Adversary Playbook.”\nThe idea is rather straightforward: just as we create offensive and defensive playbooks for\nsports, our adversaries also have offensive playbooks that they execute to compromise\norganizations. They may not write them down, but they exist. This year at Palo Alto\nNetwork’s Ignite conference I [spoke about how defenders could create a copy of an](https://www.youtube.com/watch?v=RcWDmLF34wo)\nadversary’s playbook through observation and data sharing, and then use that playbook to\nbetter defend their network with defensive playbooks.\n\nUnit 42 has been working to refine the concept of the Adversary Playbook over the last few\nmonths. In this blog, I will explain how we’ve structured the content and will release the\nPlaybook for the OilRig intrusion set.\n\n\n-----\n\nWhat is a Playbook?\nThe goal of the Playbook is to organize the tools, techniques, and procedures that an\nadversary uses into a structured format, which can be shared with others, and built upon. To\nachieve this goal, we didn’t want to develop a proprietary structure that would be exclusive to\nPalo Alto Networks. Instead, we identified two frameworks that would enable us to not only\nstructure our data, but also enable us to share it with others.\n\n**FrameworkDescription**\n\n**[STIX 2.0](https://oasis-open.github.io/cti-documentation/stix/intro)** Structured Threat Information Expression (STIX™) is a language and\nserialization format used to exchange cyber threat intelligence (CTI).\n\n**[ATT&CK](https://attack.mitre.org/wiki/Main_Page)** MITRE’s Adversarial Tactics, Techniques, and Common Knowledge\n(ATT&CK™) is a curated knowledge base and model for cyber adversary\nbehavior, reflecting the various phases of an adversary’s lifecycle and the\nplatforms they are known to target. ATT&CK is useful for understanding\nsecurity risk against known adversary behavior, for planning security\nimprovements, and verifying defenses work as expected.\n\nSTIX 2.0 is the latest iteration of the STIX format. It has been re-designed to simplify the\ncreation of documents and uses JSON rather than XML. STIX 2.0 provides a list of objects to\nrepresent types of information typically generated for cyber threat intelligence (CTI). For\ninstance, STIX includes objects for intrusion sets, malware, and indicators, among others.\nSTIX standardizes the information and attributes stored within objects based on the object\ntype, as well as the relationships available between the various object types. The\nstandardized objects and their relationships between each other allows this intelligence to be\nsharable and easily consumable without having to write complicated parsing tools.\nMITRE’s ATT&CK framework provide names, descriptions, and links to examples of the highlevel tactics adversaries’ use during an operation, as well as the techniques the adversary\nuses to achieve them. For example, the ATT&CK framework has a tactic called ‘Launch’ that\nrefers to an adversary attempting to penetrate a network. One technique associated with this\ntactic is called “Spear phishing messages with malicious attachments”, which describes how\nthe adversary would launch an attack on the network. This provides common definitions and\nunderstandings of how a specific goal is accomplished by attackers.\n[To meld these frameworks together, we looked at how Mitre mapped their ATT&CK data to](https://github.com/mitre/cti)\nSTIX 2.0 and then chose appropriate objects for additional Playbook components.\n\n**STIX 2.0 Object** **Playbook Component**\n\n**Intrusion Set** Adversary\n\n**Report** Playbook\n\n**Report** Play\n\n**Campaign** Campaign\n\n\n-----\n\n**Kill-Chain-Phase** ATT&CK Tactic\n\n**Attack-Pattern** ATT&CK Technique\n\n**Indicator** Indicator\n\n**Malware** Adversary Malware\n\n**Tool** Adversary Tool\n\n_Adversary STIX 2.0 to Playbook Object Mapping_\n\nWith these mappings defined, we began mapping the activities of a particular adversary into\nthe ATT&CK framework and storing the data and indicators in STIX JSON. The first\nadversary we choose to target is OilRig, a group that we’ve published multiple reports on in\nthe last 18 months.\n\nOverview of OilRig\nOilRig is a threat group operating primarily in the Middle East by targeting organizations in\nthis region that are in a variety of different industries; however, this group has occasionally\ntargeted organizations outside of the Middle East as well. It also appears OilRig carries out\nsupply chain attacks, where the threat group leverages the trust relationship between\norganizations to attack their primary targets.\nOilRig is an active and organized threat group, which is evident based on their systematic\ntargeting of specific organizations that appear to be carefully chosen for strategic purposes.\nAttacks attributed to this group primarily rely on social engineering to exploit the human\nrather than software vulnerabilities; however, on occasion this group has used recently\npatched vulnerabilities in the delivery phase of their attacks. The lack of software\nvulnerability exploitation does not necessarily suggest a lack of sophistication, as OilRig has\nshown maturity in other aspects of their operations. Such maturities involve:\n\nOrganized evasion testing used during the development of their tools.\nUse of custom DNS Tunneling protocols for command and control (C2) and data\nexfiltration.\nCustom web-shells and backdoors used to persistently access servers.\n\nOilRig relies on stolen account credentials for lateral movement. After OilRig gains access to\na system, they use credential dumping tools, such as Mimikatz, to steal credentials to\naccounts logged into the compromised system. The group uses these credentials to access\nand to move laterally to other systems on the network. After obtaining credentials from a\nsystem, operators in this group prefer to use tools other than their backdoors to access the\ncompromised systems, such as remote desktop and putty. OilRig also uses phishing sites to\nharvest credentials to individuals at targeted organizations to gain access to internet\naccessible resources, such as Outlook Web Access.\n**Previous reports on OilRig**\n\n\n-----\n\nThe OilRig Playbook and Viewer\n[The OilRig Playbook is available here. It contains data on three campaigns conducted by](https://raw.githubusercontent.com/pan-unit42/playbook_viewer/master/playbook_json/oilrig.json)\nOilRig spanning from May of 2016 to September of 2017. This includes 123 indicators that\nmap to 19 different ATT&CK Techniques. This isn’t everything we’ve learned about OilRig,\nbut it’s a starting point that we want to share with other members of the threat intelligence\ncommunity.\nIn an ideal world, readers would download the JSON file and load it into their threat\nintelligence system. Unfortunately, there are few tools which can handle STIX 2 content at\nthe moment, and none that would display the entire Playbook at once. To help remedy this,\nwe’re also releasing a simple tool to view the Playbook through a web interface. A\nscreenshot of the viewer is below, and you can access the live version of it here: https://panunit42.github.io/playbook_viewer/\n\n_OilRig Playbook Viewed through Playbook Viewer_\n\nTo start using the viewer, click on a Playbook in the left column. This reads the Playbook\nSTIX JSON out of our GitHub repository and parses out the dated campaigns. You can then\nview specific campaigns by clicking on their date ranges, which will populate the attack life\ncycle phases in the bottom section.\n\nIf you click on a specific technique, the viewer displays a dialog (below) that includes a link to\nthe relevant ATT&CK description as well as the STIX indicator patterns that indicate that\ntechnique. It’s important to note that not every STIX indicator in the Playbook is indicative of\nmalicious activity but simply that the behavior is present.\n\n\n-----\n\n_Indicators of an ATT&CK Technique in the Playbook Viewer_\n\nFinal Thoughts\nWe believe that publishing Playbooks in this format will enable others to better evaluate how\nthey can defend against a specific adversary. This is a living project, and we\nintend to publish Playbooks for many of the adversaries we are currently tracking over the\ncourse of 2018, so please keep an eye out for updates through our blog.\nIf you have feedback on the Adversary Playbook, please leave a comment on this blog.\nThanks to the following organizations and individuals for their efforts to enable this project:\n\nRobert Falcone and Bryan Lee (Unit 42) for pulling together the details on OilRig and\nworking on the Playbook Viewer\nMitre for releasing ATT&CK and expanding its scope.\nThe [OASIS CTI Committee for all of their work to make STIX 2.0](https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=cti)\nThe members of the [Cyber Threat Alliance for building a community of security vendors](https://www.cyberthreatalliance.org/)\nwho share intelligence through automated means.\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-15 - Introducing the Adversary Playbook- First up, OilRig.pdf"
    ],
    "report_names": [
        "2017-12-15 - Introducing the Adversary Playbook- First up, OilRig.pdf"
    ],
    "threat_actors": [
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536008,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653757597,
    "ts_modification_date": 1653757597,
    "files": {
        "pdf": "https://archive.orkl.eu/4059bddc1b5236652b6f90d306de6298f0a374db.pdf",
        "text": "https://archive.orkl.eu/4059bddc1b5236652b6f90d306de6298f0a374db.txt",
        "img": "https://archive.orkl.eu/4059bddc1b5236652b6f90d306de6298f0a374db.jpg"
    }
}