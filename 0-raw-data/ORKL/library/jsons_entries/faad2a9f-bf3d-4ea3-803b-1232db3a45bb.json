{
    "id": "faad2a9f-bf3d-4ea3-803b-1232db3a45bb",
    "created_at": "2023-01-12T15:10:24.669203Z",
    "updated_at": "2025-03-27T02:05:27.493703Z",
    "deleted_at": null,
    "sha1_hash": "3efb8420147ff88365ece6078cdf974ec77a9bad",
    "title": "2019-05-07 - MegaCortex Ransomware Spotted Attacking Enterprise Networks",
    "authors": "",
    "file_creation_date": "2022-05-28T23:51:46Z",
    "file_modification_date": "2022-05-28T23:51:46Z",
    "file_size": 502648,
    "plain_text": "# MegaCortex Ransomware Spotted Attacking Enterprise Networks\n\n**trendmicro.com/vinfo/pl/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-**\nenterprise-networks\n\nA new ransomware called MegaCortex (Trend\n\n[Micro detects this as RANSOM.WIN32.CORTEX.SM) has been reportedly deployed against](https://www.zdnet.com/article/sudden-surge-of-megacortex-ransomware-infections-detected/)\nlarge corporate networks and workstations in the United States, Canada and parts of\n[Europe. Cybersecurity firm Sophos first reported a sharp spike in MegaCortex activity last](https://news.sophos.com/en-us/2019/05/03/megacortex-ransomware-wants-to-be-the-one/)\nFriday noting that 47 attacks were stopped within 48 hours, which is two-thirds of all known\nincidents involving this ransomware. This recent surge isn’t the earliest encounter with the\nransomware — the first known sample was uploaded on January in the public sharing site\nVirusTotal.\n\n## How MegaCortex works\n\nAt least one victim reported that the attack originated from compromised domain controllers\ninside the enterprise network, but it isn’t clear how the ransomware distributors gained\naccess to the networks.\n\nAfter gaining access to the domain controller, the attackers configured it to distribute a batch\nfile, a renamed PsExec, and winnit.exe, which is one of the main executables of the\nmalware, to the rest of the computers on the network. After this step, they run the batch file\nremotely. This file will terminate Windows processes as well as stop and disable services that\nwill interfere with the ransomware's routines.\n\n\n-----\n\n_Figure 1. Infection chain of MegaCortex_\n\n\n-----\n\nThe batch file then executes winnit.exe, the core malware file, during a specific time frame\nand with specific Base64 argument. If executed properly, the malware will search files for\nencryption and drop a ransom note. It will also extract a randomly-named DLL and execute it\nwith rundll32.exe. This DLL is the component that will encrypt the computer’s files. It will first\ncheck if the file is accessible. If not, it will simply log the files. If it is accessible, the file will be\nencrypted, the child DLL process will be terminated after a set number of file encryption\nattempts, and the cycle will start again.\n\nWhen encrypting the victim’s files, the ransomware will append the extension .aes128ctr.\nAccording to Sophos, the ransomware will also generate a file with a .tsv extension and drop\nit in the hard drive. The MegaCortex actors' ransom note instructs the users to submit this file\nto them because it contains encrypted session keys needed for decryption. The ransom note\nitself is a .txt file that doesn’t ask for the usual cryptocurrency payment, instead it demands\nthat victims buy the actor’s software.\n\n[In addition to the main payload, the malware also drops secondary components that security](https://www.bleepingcomputer.com/news/security/new-megacortex-ransomware-found-targeting-business-networks/)\nresearchers have identified as the Rietspoof malware, a delivery system used to drop\nmultiple payloads onto a device.\n\n## Defending against ransomware\n\n[Users and businesses are recommended to adopt best practices to defend against](https://www.trendmicro.com/vinfo/pl/security/news/cybercrime-and-digital-threats/best-practices-ransomware/)\n[ransomware: Regularly back up files, keep the system and applications updated, enforce the](https://www.trendmicro.com/vinfo/pl/security/news/virtualization-and-cloud/best-practices-backing-up-data)\n[principle of least privilege, and implement defense in depth — arraying security at each layer](https://www.trendmicro.com/vinfo/pl/security/news/cybercrime-and-digital-threats/best-practices-securing-sysadmin-tools)\n[of a company’s online perimeters, from gateways,](https://blog.trendmicro.com/trendlabs-security-intelligence/ransomware-arrival-methods/) [networks,](https://blog.trendmicro.com/trendlabs-security-intelligence/network-solutions-ransomware-stopping-containing-spread/) [endpoints, and](https://blog.trendmicro.com/trendlabs-security-intelligence/how-endpoint-solutions-can-protect-businesses-against-ransomware/) [servers.](https://blog.trendmicro.com/trendlabs-security-intelligence/last-key-ring-server-solutions-ransomware/)\n\n## Trend Micro Ransomware Solutions\n\nEnterprises can benefit from a multilayered approach to best mitigate the risks brought by\n[ransomware. At the endpoint level, Trend Micro Smart Protection Suites deliver several](https://www.trendmicro.com/us/business/complete-user-protection/index.html#smart-protection-demos)\ncapabilities like high-fidelity machine learning, behavior monitoring and application control,\nand vulnerability shielding that minimize the impact of this threat. Trend Micro Deep\nDiscovery Inspector detects and blocks ransomware on networks, while Trend Micro™ Deep\nSecurity™ stops ransomware from reaching enterprise servers — whether physical, virtual,\n[or in the cloud. Trend Micro™ Deep Security™,](https://www.trendmicro.com/us/enterprise/cloud-solutions/deep-security/index.html) [Vulnerability Protection, and TippingPoint](https://www.trendmicro.com/us/enterprise/product-security/vulnerability-protection/)\n[provide virtual patching that protects endpoints from threats that exploit unpatched](https://www.trendmicro.com/en_us/business/capabilities/intrusion-prevention.html?cm_re=10_19_17-_-2d_Capabilities-_-IntrusionPrevention)\nvulnerabilities to deliver ransomware.\n\nEmail and web gateway solutions such as Trend Micro™ Deep Discovery™ Email\nInspector and [InterScan™ Web Security prevent ransomware from ever reaching end users.](https://www.trendmicro.com/us/enterprise/web-security/index.html)\nTrend Micro’s [Cloud App Security (CAS) can help enhance the security of Office 365 apps](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)\nand other cloud services by using cutting-edge sandbox malware analysis for ransomware\nand other advanced threats.\n\n\n-----\n\nThese solutions are powered by Trend Micro [XGen™ security, which provides a cross-](https://www.trendmicro.com/en_us/business/products/all-solutions.html)\ngenerational blend of threat defense techniques against a full range of threats for data\ncenters, [cloud environments,](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security-for-cloud.html) [networks, and](https://www.trendmicro.com/en_us/business/products/network.html) [endpoints. Smart, optimized, and connected,](https://www.trendmicro.com/en_us/business/products/user-protection.html)\nXGen™ powers Trend Micro’s suite of security solutions: Hybrid Cloud Security, User\nProtection, and Network Defense.\n\n**_Updated as of May 15, 2019 9:30AM: Added image and information about MegaCortex_**\n**_infection chain_**\nHIDE\n\n**Like it? Add this infographic to your site:**\n1. Click on the box below.  2. Press Ctrl+A to select all.  3. Press Ctrl+C to copy.  4. Paste\nthe code into your page (Ctrl+V).\n\nImage will appear the same size as you see above.\n\n[Opublikowany w Cybercrime & Digital Threats,](https://www.trendmicro.com/vinfo/pl/security/news/cybercrime-and-digital-threats) [Ransomware](https://www.trendmicro.com/vinfo/pl/security/news/ransomware)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-07 - MegaCortex Ransomware Spotted Attacking Enterprise Networks.pdf"
    ],
    "report_names": [
        "2019-05-07 - MegaCortex Ransomware Spotted Attacking Enterprise Networks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536224,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1653781906,
    "ts_modification_date": 1653781906,
    "files": {
        "pdf": "https://archive.orkl.eu/3efb8420147ff88365ece6078cdf974ec77a9bad.pdf",
        "text": "https://archive.orkl.eu/3efb8420147ff88365ece6078cdf974ec77a9bad.txt",
        "img": "https://archive.orkl.eu/3efb8420147ff88365ece6078cdf974ec77a9bad.jpg"
    }
}