{
    "id": "c31ae5f1-9e88-441b-89aa-3a56cc80a62a",
    "created_at": "2023-01-12T15:08:49.199089Z",
    "updated_at": "2025-03-27T02:13:12.198498Z",
    "deleted_at": null,
    "sha1_hash": "52432b0fea7af84c4a5b37456803e2a434c75915",
    "title": "2021-05-07 - Connecting the Bots Hancitor fuels Cuba Ransomware Operations",
    "authors": "",
    "file_creation_date": "2022-05-28T19:38:27Z",
    "file_modification_date": "2022-05-28T19:38:27Z",
    "file_size": 4421606,
    "plain_text": "# Connecting the Bots\n\n**blog.group-ib.com/hancitor-cuba-ransomware**\n\n07.05.2021\n\nHancitor fuels Cuba Ransomware Operations\n\nOleg Skulkin\n\n\n-----\n\nSenior Digital Forensic analyst at Group-IB\n\nSemyon Rogachev\n\nMalware analyst at Group-IB\n\nThe Hancitor downloader has been around for quite some time already. It is known since at\nleast 2016 for dropping Pony and Vawtrak. As a loader, it has been used to download other\nmalware families, such as Ficker stealer and NetSupport RAT, to compromised hosts. Its\noperators also showed interest in post exploitation activities, deploying Cobalt Strike Beacon\non the hosts located in Active Directory environments. After a few unremarkable and quiet\nyears, Hancitor resurfaced again — it decided to join the Big Game Hunting.\n\nHancitor became another commodity malware which partnered with ransomware gangs to\nhelp them gain initial access to target networks – the increasing trend outlined by Group-IB\nresearchers in the recent Ransomware Uncovered 2020/2021 report.\n\nGroup-IB Threat Intelligence & Attribution team found that Hancitor is being actively used by\nthe threat actors to deploy Cuba ransomware. Cuba ransomware has been active since at\nleast January 2020. Its operators have a DLS site, where they post exfiltrated data from their\nvictims who refused to pay the ransom. As of April 28, the site mentioned nine companies\nprimarily from aviation, financial, education and manufacturing industries. Hancitor's deep\n[interest in Big Game Hunting is further supported by Jason Reaves's earlier findings about](https://medium.com/walmartglobaltech/man1-moskal-hancitor-and-a-side-of-ransomware-d77b4d991618)\nHancitor's association with the Zeppelin ransomware.\n\nThe blog post examines a typical Hancitor and Cuba kill chain, the threat actors' TTPs,\ndetailed recommendations, and mitigation techniques.\n\nUsually, Hancitor is distributed via spam campaigns. Such emails are disguised to look like\nDocuSign notifications:\n\n\n-----\n\nFigure 1. An example of spam email content\n\nClicking the malicious link obviously leads to downloading a weaponized document. As\nalways, the document contains instructions on how to remove \"protection\":\n\nFigure 2. The contents of weaponized document\n\nIn recent campaigns, if the content is enabled, the macros extracts and drops Hancitor DLL\nto C:\\Users\\%username%\\AppData\\Roaming\\Microsoft\\Word, and runs it via rundll32.exe.\n\nSuch behavior is easy detectable by host-based defenses as winword.exe should not\nnormally start rundll32.exe:\n\n\n-----\n\nFigure 3. Group-IB Threat Hunting Framework Huntpoint detecting abnormal activity caused\nby Hancitor\n\nData received from C2 server is base64-encoded and XORed with 0x7A. After decoding and\ndecrypting, the received command is checked. The command should be presented as one of\nthe following symbols: «b», «e», «l», «n», «r». If it's supported, Hancitor does one of the\nfollowing actions:\n\nOne of the most common payloads delivered by Hancitor these days is Ficker stealer, which\nis actively advertised on various underground forums and is capable of extracting data from\nvarious web-browsers, mail clients, cryptocurrency wallets, etc. However, Cobalt Strike\nusage deserves more attention.\n\nDuring the post-exploitation phase, the threat actors rely mostly on Cobalt Strike, leveraging\nits capabilities on various stages of attack lifecycle.\n\nFrom execution perspective, just like many other ransomware operators, they used jump\n_psexec and jump psexec_psh, and relied heavily on SMB Beacons, commonly using generic_\npipe names. In some cases, they also used less common techniques, such as WMI and\nWinRM to execute the Beacon stagers on remote hosts.\n\nAs Cobalt Strike has credential dumping capabilities, the threat actors leverage mimikatz's\n_sekurlsa::logonpasswords. At the same time, in some cases they use a separate binary to_\nrun mimikatz on some hosts. This tool is also used for enabling lateral movement capability\nwith obtained hashes and mimikatz's sekurlsa::pth.\n\nThe Beacon's capabilities were also used to scan the compromised network. In addition, the\ngroup leveraged some custom tools for network reconnaissance. The first tool is called\nNetping – it's a simple scanner capable of collecting information about alive hosts in the\nnetwork and saving it into a text file, the other tool, Protoping, to collect information about\navailable network shares. Built-in tools were also abused. For example, adversary used net\n_view command to collect information about the hosts in the network and nltest utility to collect_\ninformation about the compromised domain.\n\n\n-----\n\nBesides Cobalt Strike s capabilities to run the Beacon stagers on remote hosts, the attackers\nused Remote Desktop Protocol to move laterally. They have a batch script called rdp.bat in\ntheir arsenal, which is used to enable RDP connections and add corresponding firewall rule\n[on the target host. Similar scripts were observed to be used by ProLock and](https://www.group-ib.com/blog/prolock) [Egregor](https://www.group-ib.com/whitepapers/egregor-ransomware.html)\noperators.\n\nFicker stealer wasn't the only publicly advertised tool in the threat actors' arsenal. Another\ntool, which is becoming more and more popular among various ransomware operators –\n_SystemBC. Such additional backdoors allowed the attackers to download and execute_\nadditional payloads even if Cobalt Strike activity was detected and blocked.\n\nThe approach to ransomware deployment is quite trivial, but still effective. Like many others,\nthe threat actors usually leveraged PsExec for deployment.\n\nThe exfiltrated data is published on a dedicated Cuba DLS (Data Leak Site).\n\nAs of April 28, the website offers to download data for free from 9 mainly US companies from\nthe aviation, financial, education, manufacturing, and logistics companies which refused to\npay the ransom. The actual number of victims is expected to be higher.\n\nAn interesting feature of the site is that it also includes the paid content section:\n\n\n-----\n\nFigure 4. Paid content featured on Cuba's DLS\n\nCuba ransomware samples that Group-IB DFIR team observed wasn't very sophisticated,\nand even didn't have Windows Shadow Copies removing functionality, so the threat actors\nhad to have additional scripting capabilities.\n\nFiles are encrypted using ChaCha20 with 12-bytes length IV. The keys are encrypted with\nRSA-4096 algorithm. The RSA implementation is likely copied from the following repository:\n[https://github.com/wolfSSL/wolfssl.](https://github.com/wolfSSL/wolfssl)\n\nAccording to Group-IB TI&A, the group behind ransomware deployments is Balbesi. Despite\nthe fact the group is leveraging quite common techniques in their operations, their attacks\nare still quite effective and affects organizations from various sectors, including financial,\npharmaceutical, educational, industrial, professional services and software development,\nfocusing mainly on Europe and USA.\n\nBelow you can find both MITRE ATT&CK mapping and corresponding mitigations list.\n\n\n-----\n\n[Learn more about Group-IB's Threat Hunting Framework and](https://www.group-ib.com/threat-hunting-framework.html) [cyber education programs on](https://www.group-ib.com/cyber-education.html)\nour [website.](https://www.group-ib.com/)\nThe authors would like to thank Nikita Rostovcev and Anton Baranov from Group-IB Threat\nIntelligence & Attribution Team for their valuable contributions to this report.\n\nShare\n\nReceive insights on the latest cybercrime trends\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-07 - Connecting the Bots Hancitor fuels Cuba Ransomware Operations.pdf"
    ],
    "report_names": [
        "2021-05-07 - Connecting the Bots Hancitor fuels Cuba Ransomware Operations.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1f6ae238-765f-4495-9d54-6a7883d7a319",
            "created_at": "2022-10-25T16:07:24.573456Z",
            "updated_at": "2025-03-27T02:02:10.284644Z",
            "deleted_at": null,
            "main_name": "TA511",
            "aliases": [
                "MAN1",
                "Moskalvzapoe"
            ],
            "source_name": "ETDA:TA511",
            "tools": [
                "Agentemis",
                "Chanitor",
                "Cobalt Strike",
                "CobaltStrike",
                "Ficker Stealer",
                "Hancitor",
                "NetSupport",
                "NetSupport Manager",
                "NetSupport Manager RAT",
                "NetSupport RAT",
                "NetSupportManager RAT",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "542cf9d0-9c68-428c-aff8-81b6f59dc985",
            "created_at": "2023-02-15T02:01:49.554105Z",
            "updated_at": "2025-03-27T02:00:03.110991Z",
            "deleted_at": null,
            "main_name": "Moskalvzapoe",
            "aliases": [
                "MAN1",
                "TA511"
            ],
            "source_name": "MISPGALAXY:Moskalvzapoe",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536129,
    "ts_updated_at": 1743041592,
    "ts_creation_date": 1653766707,
    "ts_modification_date": 1653766707,
    "files": {
        "pdf": "https://archive.orkl.eu/52432b0fea7af84c4a5b37456803e2a434c75915.pdf",
        "text": "https://archive.orkl.eu/52432b0fea7af84c4a5b37456803e2a434c75915.txt",
        "img": "https://archive.orkl.eu/52432b0fea7af84c4a5b37456803e2a434c75915.jpg"
    }
}