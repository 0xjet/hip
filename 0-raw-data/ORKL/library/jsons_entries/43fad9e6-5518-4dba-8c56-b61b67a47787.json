{
    "id": "43fad9e6-5518-4dba-8c56-b61b67a47787",
    "created_at": "2023-01-12T15:07:15.533698Z",
    "updated_at": "2025-03-27T02:05:51.609828Z",
    "deleted_at": null,
    "sha1_hash": "228ce74d3eca567a1cdedfda695b2448a7d919d5",
    "title": "2022-07-14 - The Trojan Horse Malware & Password “Cracking” Ecosystem Targeting Industrial Operators",
    "authors": "",
    "file_creation_date": "2022-08-18T03:20:45Z",
    "file_modification_date": "2022-08-18T03:20:45Z",
    "file_size": 1301451,
    "plain_text": "# The Trojan Horse Malware & Password “Cracking” Ecosystem Targeting Industrial Operators\n\n**[dragos.com/blog/the-trojan-horse-malware-password-cracking-ecosystem-targeting-industrial-operators/](https://www.dragos.com/blog/the-trojan-horse-malware-password-cracking-ecosystem-targeting-industrial-operators/)**\n\nBlog Post\n\nBy Sam Hanson\n\n\nJuly 14, 2022\n\n\n-----\n\n07.14.22\n\nThe internet brings endless possibilities for scammers and cyber criminals to make money\nillegitimately. The usual suspects – ransomware, business email compromise, internet\nfraud, and phishing are well known to the information security community. However, during\na routine vulnerability assessment, Dragos researchers uncovered a smaller in scale\ntechnique targeting industrial engineers and operators.\n\n## The Story of Troy and the Password “Cracking” Trojan Horse\n\nMultiple accounts across a variety of social media websites are advertising Programmable\nLogic Controller (PLC), Human-Machine Interface (HMI), and project file password cracking\nsoftware. Buyers can retrieve forgotten passwords by running an executable provided by\nthe seller that targets a specific industrial system.\n\nAn advertisement like this raises the question, “Who would buy this?” Any information\nsecurity professional would caution against downloading and running software from an\nuntrusted party. Take the following as an example: an engineer named Troy just got\npromoted to senior engineer when his old colleague, Hector, retired after serving 30 years\nat an electric utility. Troy needs to update some ladder logic Hector wrote on Automation\nDirect’s DirectLogic 06 PLC. After firing up the PLC programming software, DirectSOFT, a\npassword prompt pops up.\n\nTroy doesn’t know the password, and Hector left a few months ago and is now vacationing\non a boat without service indefinitely. Troy looks for answers online, and seeing an\nadvertisement for PLC password cracking software, decides to give it a go. Cassandra,\n\n\n-----\n\nTroy s security-conscience coworker, warns against introducing this unnecessary risk into\ntheir OT environment. But Troy insists this is a time-sensitive task. He purchases the\nsoftware and runs it on his engineering workstation.\n\nTroy successfully recovers the PLC password, but a couple of minutes later he discovers\nthe engineering workstation system is acting strange.\n\n## Password Retrieval and a Sality Malware Infection\n\nTroy called in Dragos to reverse engineer the password “cracking” software and determined\nit did not crack the password at all, rather, it exploited a vulnerability in the firmware which\nallowed it to retrieve the password on command. Further, the software was a malware\ndropper, infecting the machine with the Sality malware and turning the host into a peer in\nSality’s peer-to-peer botnet.\n\nThe Exploit\n\nDragos researchers confirmed the password retrieval exploit embedded in the malware\ndropper successfully recovers Automation Direct’s DirectLogic 06 PLC password over a\nserial connection. From a user’s perspective, they simply need to have a connection from\nthe Windows machine to the PLC, then specify the COM port to communicate over and\nclick the “READPASS” button. A second or two later, the password is shown to the user as\nseen in Figure 1.\n\nFigure 1: Demonstration of password “cracking” software as seen by a user.\n[Previous research targeting DirectLogic PLCs has resulted in successful cracking](https://www.rapid7.com/db/modules/auxiliary/scanner/scada/koyo_login/)\ntechniques. However, Dragos found that this exploit does not crack a scrambled version of\nthe password as historically seen in popular exploitation frameworks. Instead, a specific\nbyte sequence is sent by the malware dropper to a COM port.\n\nFigure 2: Serial response from PLC containing password after exploitation\n\n\n-----\n\nCapturing the serial traffic sent by the exploit allowed Dragos researchers to recreate it\noutside of the malware dropper. The malware contains a serial-only version of the exploit,\nrequiring the user to have a direct serial connection from an Engineering Workstation\n(EWS) to the PLC. Dragos researchers were able to successfully recreate the exploit over\nEthernet, increasing the severity of this vulnerability significantly. This vulnerability was\nassigned CVE-2022-2003 and was responsibly disclosed to Automation Direct. They have\n[released a firmware update to fix this issue [source: ICS-CERT Advisory (ICSA-22-167-03),](https://www.cisa.gov/uscert/ics/advisories/icsa-22-167-02)\n[ICS-CERT Advisory (ICSA-22-167-02)].](https://www.cisa.gov/uscert/ics/advisories/icsa-22-167-03)\n\nFigure 3: User Datagram Protocol (UDP)response from the PLC containing password after\nexploitation.\nThe Sality Malware\n\nSality is a peer-to-peer botnet for distributed computing tasks such as password cracking\nand cryptocurrency mining. A Sality infection could risk remote access to an EWS by an\nunknown adversary. Dragos assesses with moderate confidence the adversary, while\nhaving the capability to disrupt industrial processes, has financial motivation and may not\ndirectly impact Operational Technology (OT) processes.\n\nSality employs process injection and file infection to maintain persistence on the host. It\nabuses Window’s autorun functionality to spread copies of itself over Universal Serial Bus\n(USB), network shares, and external storage drives. This specific sample of Sality also\ndrops clipboard hijacking malware that, every half second, checks the clipboard for a\ncryptocurrency address format. If seen, the hijacker replaces the address with one owned\nby the threat actor. This in-real-time hijacking is an effective way to steal cryptocurrency\nfrom users wanting to transfer funds and increases our confidence that the adversary is\nfinancially motivated.\n\nTo remain undetected, Sality drops a kernel driver and starts a service to identify any\npotential security products such as antivirus systems or firewalls and terminates them.\nAccording to various reports online, Sality is able to conduct Internet Protocol (IP) filtering\n\n\n-----\n\nagainst antivirus-related URLs and will drop any outgoing packets containing specific\nkeywords [known to be connected to antivirus vendor websites. This could have regulatory](https://www.vx-underground.org/archive/Symantec/sality-story-of-peer-to-peer-11-en.pdf)\nimplications – since Sality blocks any outgoing connections, antivirus systems will not be\n[able to receive updates violating reliability standard CIP-007-6. While Sality makes several](https://www.nerc.com/pa/Stand/Reliability%20Standards/CIP-007-6.pdf)\nattempts to stay hidden, it is quite clear that an infection is taking place. Central Processing\nUnit (CPU) levels spikes to 100% and multiple Windows Defender alerts were triggered.\n\nThe Password “Cracking” Ecosystem\n\nAutomation Direct is far from the only vendor affected. In fact, Dragos is aware that this\nspecific threat actor advertises “cracking” software for several PLCs, HMIs, and project files\nlisted in the following table:\n\n**Vendor and Asset** **System Type**\n\nAutomation Direct DirectLogic 06 PLC\n\nOmron CP1H PLC\n\nOmron C200HX PLC\n\nOmron C200H PLC\n\nOmron CPM2* PLC\n\nOmron CPM1A PLC\n\nOmron CQM1H PLC\n\nSiemens S7-200 PLC\n\nSiemens S7-200 Project File (*.mwp)\n\nSiemens LOGO! 0AB6 PLC\n\nABB Codesys Project File (*.pro)\n\nDelta Automation DVP, ES, EX, SS2, EC Series PLC\n\nFuji Electric POD UG HMI\n\nFuji Electric Hakko HMI\n\nMitsubishi Electric FX Series (3U and 3G) PLC\n\nMitsubishi Electric Q02 Series PLC\n\nMitsubishi Electric GT 1020 Series HMI\n\nMitsubishi Electric GOT F930 HMI\n\n\n-----\n\nMitsubishi Electric GOT F940 HMI\n\nMitsubishi Electric GOT 1055 HMI\n\nPro-Face GP Pro-Face HMI\n\nPro-Face GP Project File (*.prw)\n\nVigor VB PLC\n\nVigor VH PLC\n\nWeintek HMI\n\nAllen Bradley MicroLogix 1000 PLC\n\nPanasonic NAIS F P0 PLC\n\nFatek FBe and FBs Series PLC\n\nIDEC Corporation HG2S-FF HMI\n\nLG K80S PLC\n\nLG K120S PLC\n\nDragos only tested the DirectLogic-targeting malware. However, initial dynamic analysis of\na couple of other samples indicate they also contain malware. In general, it appears there is\nan ecosystem for this type of software. Several websites and multiple social media\naccounts exist all touting their password “crackers.”\n\n\n-----\n\nFigure 4: Example advertisements for password “cracking” software.\n\n\n-----\n\nFigure 5: Example\n\nadvertisement for password “cracking” software.\n\n## Conclusion\n\nTrojanized software is a common delivery technique for malware and has been proven\n[effective for gaining initial access to a network. While, in our fictitious example, Troy had a](https://www.dragos.com/blog/industry-news/preventing-initial-access-in-industrial-environments/)\nlegitimate reason for downloading the password “cracking” software, doing so from an\nunknown actor introduced significant and unnecessary risk into the OT environment. If an\n[engineer needs to recover a lost password, contact Dragos or the respective vendor for](https://www.dragos.com/contact/)\ninstructions and guidance. As the adage goes, if it’s too good to be true, then it probably is.\n\n\n-----\n\n### Understanding initial access techniques\n\nGet the full analysis of initial access techniques, the threat groups that used them, and a\nseries of defensive recommendations to protect against breach.\n\n[Download Whitepaper](https://urldefense.com/v3/__https://click.smartsheet.com/f/a/CEMjQ7BWh_Q2cXOy6OW8Ow**A/AARF7wA*/RgRkJGOlP0RkaHR0cHM6Ly9odWIuZHJhZ29zLmNvbS9ob3ctZHJhZ29zLWFjdGl2aXR5LWdyb3Vwcy1vYnRhaW4taW5pdGlhbC1hY2Nlc3MtaW50by1pbmR1c3RyaWFsLWVudmlyb25tZW50c1cDc3BjQgpiPqXeQWIbiBkUUhRjc3RhdWZmZXJAZHJhZ29zLmNvbVgEAAAAAA**A__;fn5-fn4!!ObtO0C2TD-k!XhJWpx6ABb0BH-I-CgLECNXAJagDL7Hpd4ajYrUVXgXIK_kVVxQQgcFUoc7UwmND%24)\n\n### Read next blog post\n\n[Blog](https://www.dragos.com/resources/?_block_resources_resource_type_filter=post)\n\n\n### 10 Questions to Ask Suppliers as Part of Third-Party Security Reviews\n\n07.12.22\n\n### View more Blog Posts\n\n Ready to put your insights into action?\n\nTake the next steps and contact our team today.\n\n[CONTACT US TODAY](https://www.dragos.com/blog/the-trojan-horse-malware-password-cracking-ecosystem-targeting-industrial-operators/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-14 - The Trojan Horse Malware & Password “Cracking” Ecosystem Targeting Industrial Operators.pdf"
    ],
    "report_names": [
        "2022-07-14 - The Trojan Horse Malware & Password “Cracking” Ecosystem Targeting Industrial Operators.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536035,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1660792845,
    "ts_modification_date": 1660792845,
    "files": {
        "pdf": "https://archive.orkl.eu/228ce74d3eca567a1cdedfda695b2448a7d919d5.pdf",
        "text": "https://archive.orkl.eu/228ce74d3eca567a1cdedfda695b2448a7d919d5.txt",
        "img": "https://archive.orkl.eu/228ce74d3eca567a1cdedfda695b2448a7d919d5.jpg"
    }
}