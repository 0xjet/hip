{
    "id": "f289505b-2ff0-4ce5-bbf8-dcd7dbf2ad74",
    "created_at": "2023-01-12T15:10:15.81462Z",
    "updated_at": "2025-03-27T02:17:27.608147Z",
    "deleted_at": null,
    "sha1_hash": "1cba452912b12b26338ba8bd91a4e66b3b059ec7",
    "title": "2016-05-26 - The OilRig Campaign- Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T00:33:30Z",
    "file_modification_date": "2022-05-28T00:33:30Z",
    "file_size": 742728,
    "plain_text": "# The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor\n\n**[unit42.paloaltonetworks.com/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/](https://unit42.paloaltonetworks.com/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/)**\n\nRobert Falcone, Bryan Lee May 26, 2016\n\nBy [Robert Falcone and](https://unit42.paloaltonetworks.com/author/robertfalcone/) [Bryan Lee](https://unit42.paloaltonetworks.com/author/bryanlee/)\n\nMay 26, 2016 at 2:05 PM\n\n[Category: Financial Services,](https://unit42.paloaltonetworks.com/category/financial-services/) [Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [Helminth,](https://unit42.paloaltonetworks.com/tag/helminth/) [OilRig,](https://unit42.paloaltonetworks.com/tag/oilrig/) [OilRig attacks,](https://unit42.paloaltonetworks.com/tag/oilrig-attacks/) [Powershell,](https://unit42.paloaltonetworks.com/tag/powershell/) [Saudi Arabia,](https://unit42.paloaltonetworks.com/tag/saudi-arabia/) [VBScript,](https://unit42.paloaltonetworks.com/tag/vbscript/)\n[WildFire,](https://unit42.paloaltonetworks.com/tag/wildfire/) [Windows](https://unit42.paloaltonetworks.com/tag/windows/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/)\n\nIn May 2016, Unit 42 observed targeted attacks primarily focused on financial institutions and\ntechnology organizations within Saudi Arabia. Artifacts identified within the malware samples\nrelated to these attacks also suggest the targeting of the defense industry in Saudi Arabia,\nwhich appears to be related to an earlier wave of attacks carried out in the fall of 2015. We\nhave grouped these two waves of attacks into a campaign we have named ‘OilRig’.\n\nIn recent OilRig attacks, the threat actors purport to be legitimate service providers offering\nservice and technical troubleshooting as a social engineering theme in their spear-phishing\nattacks. Earlier OilRig attacks appear to use fake job offers as a social engineering theme.\nThe campaign appears highly targeted and delivers a backdoor we have called ‘Helminth’.\nOver the course of the attack campaign, we have observed two different variations of the\nHelminth backdoor, one written in VBScript and PowerShell that was delivered via a macro\nwithin Excel spreadsheets and the other a standalone Windows executable.\n\n### Clayslide: Excel Macros Install Helminth Script\n\nIn May 2016, Unit 42 began researching attacks that used spear-phishing emails with\nattachments, specifically malicious Excel spreadsheets sent to financial organizations within\nSaudi Arabia. We observed spear-phishing emails sent between May 4 and May 12 of this\nyear that delivered these malicious Excel spreadsheets, which we are tracking as ‘Clayslide’.\nClaySlide documents contain malicious macros that display decoy content within the\nspreadsheet and installs a variant of a Helminth backdoor. FireEye also reported on these\nattacks in a May 22 [blog post.](https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html)\n\n\n-----\n\nThe macro within Clayslide samples installs the Helminth script, which is composed of a\nVBScript called ‘update.vbs’ and a PowersShell script called ‘dns.ps1’. The purpose of the\nVBScript is to send network beacons to its command and control server using HTTP\nrequests and will either download a file or run a batch script provided within the HTTP\nresponse. The VBScript also uploads the output of the provided batch scripts to the\ncommand and control (C2) server, which provides threat actors a functional remote shell to\nthe system.\n\nThe PowerShell script has similar capabilities to the VBScript, but instead of using HTTP for\ncommunications it uses a series of DNS queries to send and receive data from the server.\nThis communication channel relies on the C2 server responding to DNS queries with IP\naddresses that the PowerShell script will parse treat as data to construct a batch script to\nexecute on the system. The script specifically looks for the IP address “33.33.x.x” to mark the\nbeginning of the batch script transfer. The script will continue sending additional DNS\nrequests and use the octets of the resolving IP addresses as characters to write to the batch\nscript. The script continues to write data to the batch script until it receives the IP address\n“35.35.35.35”, which notifies the script to stop saving data to the file and to run the batch\nscript.\n\nPlease reference the Appendix for more detailed information on the Clayslide delivery\ndocuments and the Helminth script variant.\n\n### Discovery of Executable Helminth Variant\n\nAdditional samples were discovered in WildFire exhibiting the same DNS-based C2 behavior\nas the script variant of Helminth; however, many of these samples were found to be\nWindows executable, instead of the previously observed VBScript and PowerShell\ncombination. These samples were found to contain the same functionality as the previously\nmentioned Helminth samples. Figure 1 shows the code within the VBScript version of\nHelminth checking resolving IP addresses for the 35.35.35.35 IP address to stop appending\ndata to a batch script before executing it, while Figure 2 shows the same functionality within\nthe executable version of the Trojan.\n\n_Figure 1 Helminth dns.ps1 PowerShell script looking for 35.35.35.35 IP address_\n\n\n-----\n\n_Figure 2 Helminth executable looking for the 35.35.35.35 IP address_\n\nThis suggests that the threat actors developed the executable variant of Helminth as a\nstandalone option whose installation does not rely on a macro within an Excel spreadsheet.\nThis also suggests that the threat actors purposely used the same communication methods\nacross both variants with the intention to use the same command and control server\napplication. This variant of the Trojan is also where we obtained its name, as several of these\npayloads had the following debug symbol path that suggests the malware author called this\nproject ‘Helminth’:\n\n_E:\\Projects\\hlm updated\\Helminth\\Release\\Helminth.pdb_\n\nPlease reference the Appendix for additional details on the Helminth executable variant.\n\n### Delivery of Windows Executable Helminth Variant\n\n\n-----\n\nUnit 42 does not have detailed targeting information associated with attacks delivering the\nexecutable variant of the Helminth Trojan, however, we found a Zip archive created in August\n2015 that may have been used by the threat actors to deliver the Helminth Trojan. This Zip\nfile was hosted at the following location:\n\n_hxxp://minfosecu.doosan[.]com/data/joboffer.zip_\n\nThe Zip archive is encrypted with an unknown password, but we know it contains two files\nnamed joboffer.chm and thumb.db. The thumb.db file in the archive has the same name and\nfile size (368128 bytes) as a dropper Trojan we track as ‘HerHer’ (SHA256:\nfb424443ad3e27ef535574cf7e67fbf9054949c48ec19be0b9ddfbfc733f9b07) that installs a\nknown Helminth executable sample. The joboffer.chm file is a compiled HTML file that we\nbelieve loads and executes the ‘thumb.db’ file as a payload, but we cannot be absolutely\nsure as we do not have the password required to extract the files from the archive.\n\nThe decoy opened by the Helminth sample installed by ‘thumb.db’ (seen in Figure 3) is a\ndialog box associated with HTML help, which further strengthens our theory that the\njoboffer.chm ran the sample. This decoy suggests that the threat actors wanted to open the\nHTML help dialog after installing the Helminth Trojan, as the joboffer.chm file is effectively a\nstandalone HTML file. We believe that the threat actors employed social engineering to\nunderplay the situation and provide a different legitimate job offer if the victim responded with\nconcerns of malicious activity.\n\n_Figure 3 A Helminth sample displays this dialog box if provided 'w' on the command line_\n\n\n-----\n\nThe executable variant of Helminth is installed with a dropper Trojan that we are tracking as\nthe HerHer Trojan. This Trojan has two objectives: installing embedded Trojans and\ndisplaying either a fake error prompt or a fake “trubleshooting\" (the malware author\nmisspelled this word in each sample) utility. Figure 4 is an example of the fake error prompt\ndisplayed by the HerHer Trojan.\n\n_Figure 4 Fake Error Prompt Displayed by the HerHer Trojan_\n\nThe Helminth executable variant is very similar in functionality to its script-based counterpart,\nas it also communicates with its C2 server using both HTTP and DNS queries. The major\ndifference in capabilities between the two variants is that the executable version comes with\na module that Helminth uses to log keystrokes and the clipboard contents to exfiltrate to the\nC2 server.\n\nHelminth executable samples send artifacts within network beacons to its C2 server that the\nTrojan refers to as a ‘Group’ and ‘Name’. We extracted the group and name values from the\nHelminth executable samples to determine their purpose. It appears that the group values\nhardcoded into the malware is associated with the targeted organization, as several are\nSaudi Arabian organizations within the telecommunications and defense industries. This\nsuggests that the threat actors are not only focused on financial organizations, as their target\nset could include other industries as well.\n\nThe name values hardcoded into the Helminth samples are also interesting, as a majority of\nthe names are related to famous philosophers, such as ‘Plato’ (Greek philosopher), ‘Arasto’\n(Persian and Urdu for Greek philosopher Aristotle), and ‘ALAfghani’ (Jamal ad-Din alAfghani, Islamic Philosopher). Other name values embedded in samples contain other\nPersian words, such as ‘Nafti’ (ﻧﻔﺘﯽ) that translates to ‘oily’, which led us to name this\ncampaign OilRig).\n\n### Helminth Infrastructure\n\nExamining the known infrastructure of the collected sample set of Helminth provides several\ninteresting findings in regards to the adversary’s tactics. The variants leveraging malicious\nmacros embedded in Excel documents all share the same command and control server of\n\n\n-----\n\ngo0gie[.]com. The executable variants, on the other hand, used a variety of domains:\n\n_checkgoogle[.]org_\n_mydomain1110[.]com_\n_kernel[.]ws_\n_mydomain1607[.]com_\n_mydomain1609[.]com_\n\n_Figure 5 Helminth C2 Infrastructure_\n\nEach sample of the weaponized Excel document variant used a unique command and\ncontrol domain to retrieve a bot ID, using the following format:\n\n_00000000<base 36 of a random number smaller than 46655>30.go0gie[.]com_\n\nEach of these domains, however, resolved to the same IP address of 5.39.112.87. This IP is\nobserved as the resolution for two domains in use by the portable executable variants,\nkernel[ ]ws and mydomain1110[ ]com Judging by compile timestamps of the executables\n\n\n-----\n\nand last saved timestamps of the weaponized documents, it is likely the adversary is\nrecycling a previously created C2 server at 5.39.112.87 for the newer macro based variant.\nThe other C2 domains and IPs observed in use by the previous portable executable samples\ndid not have shared infrastructure with the newer macro variants, although there is tactical\noverlap via the naming scheme of the domains.\n\nHistorical WHOIS data reveals additional findings, potentially alluding to an Iranian-based\noperator. From a timeline perspective, a new domain was registered almost in consecutive\nmonths, beginning in July 2015. Each of the domains's WHOIS data contained registrant\ninformation that was either reused, or was closely related to previously used information. For\nexample, the domains mydomain1607[.]com and mydomain1609[.]com used the exact same\nregistrant information. The email address edmundj@chmail[.]ir and the geolocation of\nTehran, Iran, being of note. Kernel[.]ws and checkgoogle[.]org used very similar email\naddresses, andre_serkisian@yahoo[.]com and andre.serkisian@chmail[.]ir, respectively. The\nregistrant information for kernel[.]ws also provided a geolocation of Tehran, IR and the email\nprovider for the address used in checkgoogle[.]org was the same used for\nmydomain1607[.]com and mydomain1609[.]com, chmail.ir. The mydomain1110[.]com domain\ndid not appear to reuse any of the previously observed WHOIS data artifacts, but did still\ngive a geolocation of Tehran in addition to the use of an email address linked to other\ndomains thematically similar to the know command and control domains and are potentially\nrelated.\n\nAlthough there is heavy use of Iranian-based artifacts within the WHOIS registrant\ninformation, it is important to remember that this data is easily falsified. At face value,\nhowever, taking into account the registrant information and the use of Persian language in\nthe samples are compelling indicators that the operators may indeed be based out of Iran.\n\n### Conclusion\n\nWhile researching the OilRig campaign, we have seen two waves of targeted attacks on\nSaudi Arabian organizations in which a group of threat actors delivered the Helminth Trojan\nas a payload. The two waves of attacks used separate variants of the Helminth Trojan,\nspecifically a script and executable variant of the Trojan.\n\nThe two variants of Helminth use almost identical command and control protocols, which\nallows the threat actors to maintain consistent infrastructure throughout the campaign to\nmanage the compromised hosts, regardless of the Helminth variant used in the attack.\n\nThe two variants of Helminth do require different delivery methods, with the script variant\nrelying on an Excel spreadsheet for delivery, while the executable variant is more traditional\nin the fact that it can be installed without a delivery document. We speculate that the\nexecutable variant involves threat actors socially engineering the victim into running the\n\n\n-----\n\npayload, rather than installing the payload as the result of successful exploitation of a\nvulnerability. The multiple delivery methods suggest this threat group is capable of adapting\ntheir procedures to suit the current operation in the overarching campaign.\n\nPalo Alto Networks customers are protected from the Helminth Trojan and can gather\nadditional information using the following tools:\n\nWildFire detection of all known samples as malicious\nAll Helminth C2 domains have DNS signatures created and are identified as malicious\nin PAN-DB.\nAutoFocus tags [Clayslide,](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Clayslide) [Helminth and](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Helminth) [HerHerDropper.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.HerHerDropper)\n\n### Appendix\n\n**Clayslide Delivery Documents**\n\nAt first, Clayslide spreadsheets display a worksheet called “Incompatible” that contains\ninstructions for the user to manually enable macros (as seen in Figure 6), as macros are\ndisabled in Excel by default. This is an attempt to trick the user into running the embedded\nmacro to install the Trojan, which does not require any vulnerability exploitation. Figure 6\nshows the “Protected View” alert in Excel informing the user that there is an embedded\nmacro that may cause harm to the system.\n\n_Figure 6 Clayslide spreadsheet showing the Incompatible worksheet with instructions to_\n_enable macros and Excel displaying its Protected View alert message_\n\nBefore the user can enable the macros in accordance with the instructions displayed in the\nspreadsheet, the user must click the red bar displayed by Protected View and click the “Edit\nAnyway” button, as seen in 7.\n\n\n-----\n\n_Figure 7 Protected View further mentioning the potential danger with editing the spreadsheet_\n_in the ClaySlide sample_\n\nAfter clicking the “Edit Anyway” button, Excel displays another security warning bar alerting\nthat the spreadsheet contains macros, as seen in Figure 8. The “Enable Content” button\nmentioned within the instructions displayed within the Clayslide spreadsheet is now\npresented to the user.\n\n_Figure 8 Excel security warning with the Enable Content button mentioned in Incompatible_\n_worksheet_\n\nIf the user clicks the “Enable Content” button, the macro hides the “Incompatible” worksheet\nand makes hidden worksheets visible that displays decoy content to minimize the victim’s\nsuspicions of malicious behavior taking place. Figure 9 below shows the decoy content\ndisplayed by macros within a Clayslide sample, specifically showing the status of internal\nnetwork IP addresses that fit with the service provider social engineering theme used\nthroughout the attack campaign. Figure 9 also shows that the “Incompatible” worksheet is no\nlonger visible, as the decoy content is displayed in a worksheet called “Sheet1”.\n\n\n-----\n\n_Figure 9 Decoy content displayed after enabling macros within a Clayslide sample_\n\nAfter displaying the decoy content, the macro begins installing the script variant of the\nHelminth Trojan to the system. The process used by the macro to install this variant of\nHelminth begins with the creation of the following files and folders:\n\n%PUBLIC%\\Libraries\\update.vbs\n%PUBLIC%\\Libraries\\dns.ps1\n%PUBLIC%\\Libraries\\up\n%PUBLIC%\\Libraries\\dn\n%PUBLIC%\\Libraries\\tp\n\nThe malicious macro finishes the installation process by creating a scheduled task that is\nresponsible for running the two scripts at regular intervals, as the scripts themselves do not\nhave the ability to continually run after the initial execution. The following code snippet within\nthe macro creates a scheduled task named “GoogleUpdateTaskMachineUI” that will run the\nupdate.vbs script every three minutes:\n\n\n-----\n\nwss.Run schtasks /create /F /sc minute /mo 3 /tn & Chr(34) &\n\"GoogleUpdateTaskMachineUI\" & Chr(34) & \" /tr \" &\nwss.ExpandEnvironmentStrings(\"%PUBLIC%\") & \"\\Libraries\\update.vbs\", 0\n\n## Helminth Script Variant\n\nThe script variant of the Helminth Trojan consists of a VBScript and PowerShell script named\nupdate.vbs and dns.ps1. We aptly named this variant the script version, as we found another\nversion of this Trojan that we will discuss later in this Appendix. The update.vbs script is\nresponsible for reaching out to its command and control (C2) server using HTTP requests to\nthe following two URLs:\n\nhxxp://go0gIe.com/sysupdate.aspx?req=<random number>%5Cdwn&m=d\n\nhxxp://go0gIe.com/sysupdate.aspx?req=<random number>%5Cbat&m=d\n\nThe C2 server will respond to the HTTP requests to the “bat&m=d” URL with a batch script\nthat update.vbs will save to the “dn” folder and execute. The output of the downloaded batch\nscript is saved to a text file in the “up” folder and uploaded to the C2 server via an HTTP\nPOST request to the following URL:\n\nhxxp://go0gIe.com/sysupdate.aspx?req=<random number>%5Cupl&m=u\n\nPalo Alto Networks WildFire observed commands provided by the C2 server for the known\nHelminth samples. The commands, as seen below, show that the threat actors are\nattempting to do initial information gathering on the system, including available user\naccounts, username, computer name, running tasks, services, network services and if\nremote desktop is enabled.\n\nwhoami & hostname & ipconfig /all & net user /domain 2>&1 & net group /domain 2>&1 & net\ngroup \"domain admins\" /domain 2>&1 & net group \"Exchange Trusted Subsystem\" /domain\n2>&1 & net accounts /domain 2>&1 & net user 2>&1 & net localgroup administrators 2>&1 &\nnetstat -an 2>&1 & tasklist 2>&1 & sc query 2>&1 & systeminfo 2>&1 & reg query\n\"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" 2>&1\n\nThe update.vbs concludes by running the dns.ps1 PowerShell script. The dns.ps1 script is\nalso responsible for communicating with the C2 server, but it uses DNS queries to send data\nto the server. The DNS queries sent by this script are queries to subdomains on the same\ndomain as the C2 server, which contains system information or the contents of files from the\nsystem. The subdomain of the DNS request that acts as the initial C2 beacon has the\nfollowing structure:\n\n00000000<base 36 of a random number smaller than 46655>30\n\n\n-----\n\nThe dns.ps1 script checks the response to this DNS query and uses the first octet of the\nresolving IP address as an identifier for the compromised system. The script then uses this\nidentifier in a follow up DNS request to a subdomain with the following structure:\n\n00<identifier>00000<base36 of a random number smaller than 46655>30\n\nThe C2 server will respond to these DNS queries with IP addresses that the script will parse\nand eventually treat as data to construct a batch script to execute on the system. The script\nspecifically looks for the IP address “33.33.x.x” to mark the beginning of the batch script\ntransfer. Upon receipt of this IP address, the script uses the last two octets of this IP address\nas a filename for the batch file that it saves to the “tp” folder that was initially created by the\nmacro. Once the batch file name is obtained, the script will continue sending additional DNS\nrequests and use the octets of the resolving IP addresses as characters to write to the batch\nscript. The script continues writing characters to the batch script until it receives the IP\naddress “35.35.35.35” that notifies the script to stop saving data to the file and to run the\nbatch script.\n\nThe output of the downloaded batch file is saved to “%PUBLIC%\\Libraries\\tp\\<batch\nfilename>.txt”. The script will then upload the output of this batch file by including the data in\na sequence of DNS queries. The exfiltrates the output of the batch script by splitting up the\ndata within the text file into chunks up to 23 bytes and sends the data within a series of DNS\nqueries that have the following structure:\n\n00<identifier><filename of batch file without its extension><base36 of sequence number>\n<base36 of a random number smaller than 46655><up to 23 bytes of data from batch script\noutput>\n\nBoth the update.vbs and dns.ps1 both provide a fully functional remote shell to the actors,\nwhich allow the actor to carry out any activities on the compromised system they wish.\n\n## Helminth Executable Variant\n\nThe executable variant of Helminth is installed with a Trojan that we are tracking as the\nHerHer Trojan. The HerHer Trojan saves several files to the file system upon execution to\ninstall the Helminth Trojan to the system.\n\n%APPDATA%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Certificate\nManagment.lnk\n%APPDATA%\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Certificate.ico\n%APPDATA%\\Roaming\\Microsoft Temperary\\adbmanager.exe\n%APPDATA%\\Roaming\\Microsoft Temperary\\adbtray.exe\n%APPDATA%\\Local\\Temp\\acro\\Users\\config.txt\n%PUBLIC%\\Libraries\\~Windows\\wintrust.hlm\n\n\n-----\n\nThe Certificate Managment.lnk shortcut uses the Certificate.ico file for its icon, as seen in\nFigure 10.\n\n_Figure 10 Icon file used_\n\nAdditionally, it has a comment of ‘herher’, which is basis of the dropper’s name. Helminth\nrelies on the following shortcut for persistence, as it runs the Trojan each time the system\nstarts using the following command line:\n\n\"C:\\Users\\Rick James\\AppData\\Roaming\\Microsoft Temperary\\adbmanager.exe\" q 1\n\nThe ‘adbmanager.exe’ and ‘adbtray.exe’ files are the actual Helminth Trojan, both of which\nare the same executable. The reason for two different filenames is currently unknown. The\nHelminth Trojan requires arguments on the command-line to execute properly (‘q’ in the\nanalyzed sample as seen in the ‘Certificate Managment.lnk’ shortcut), one of which will run\nthe Trojan’s functional code and the other can open a dialog box as a decoy.\n\nThe Helminth Trojan begins by creating a mutex named ‘[username]ver4.1’ and writes its\nembedded configuration as ciphertext to the following file:\n\n%APPDATA%\\Local\\Temp\\acro\\Users\\config.txt\n\nThe Trojan will later decrypt the contents of this file using the RC4 algorithm, using the MD5\nhash of ‘f246b23d-c2d6-45f2-b268-dec30d9adaad’ as the key. We decrypted the\nconfiguration file dropped by Helminth and found the structure of the configuration file is\n‘IsAlive,[sleep interval]\\r\\n[C2 domain]’. For example, one Helminth sample had the following\ndata within the “config.txt” file:\n\nIsAlive,30\ncheckgoogle.org\n\nThe Helminth executable variant is able to run batch scripts provided by the C2 server, which\nis very similar to the script version of this Trojan. The executable variant has one additional\ncapability that is not present in the script version, which involves the ability to log keystrokes\nvia a supplemental keylogger module.\n\n\n-----\n\nHelminth loads its keylogger module of the Trojan by loading the wintrust.hlm file dropped by\nthe HerHer Trojan as a DLL and calling its exported function named ‘Initialize’. The keylogger\nthat creates a window named ‘kk’ to monitor both the clipboard and keystrokes and to save\nthe data in cleartext to the file ‘%TEMP%/acro/Users/[GUID from CoCreateGuid]kk.tmp’. The\nkeylogger saves the keystrokes and the name of the Window visible while the keys were\ntyped to this file in the following structure:\n\n####T####[Window Name]####ET####\n\n[logged keystrokes]\n\nThe wintrust.hlm keylogger logs the contents of the clipboard to the same file, but the\nclipboard contents do not follow a header that specifies the window name like the other\nlogged keystrokes. The clipboard contents are logged to the file in the following format:\n\n<<< Clipboard ---> [contents of clipboard]>>>\n\n## Helminth Exe C2 Communications\n\nThe Helminth executable is able to communicate with its C2 server via HTTP and via DNS\nqueries in very similar ways to the Helminth script variant. In fact, the DNS beacons follow\nthe same structure and sequence as the script variant of Helminth discussed in the previous\nsection. The main difference between the beacons sent from the two variants of Helminth is\nthe data included within the beacon, as the script variant does not send any system\ninformation within the beacons, whereas the executable version sends system and malware\nspecific information within both the HTTP and DNS beacons.\n\nHelminth executables include the system and malware information within HTTP beacons in\nthe “Cookie” field of the request. Helminth structures the beacon data as follows:\n\nFunction=F1; ID=[MD5 of Computer and Username]; Group=[Hardcoded in Malware];\nName=[Hardcoded in Malware]; Service=0;\n\nThe Trojan will encrypt this data using RC4 and the MD5 hash of “f246b23d-c2d6-45f2-b268dec30d9adaad” as the key and encode the encrypted data using base64. Figure 11 shows a\nHelminth HTTP beacon with the Cookie field containing the base64 data.\n\n_Figure 11 Helminth HTTP C2 beacon_\n\nHelminth sends data within DNS beacons differently than the HTTP beacons and includes\nadditional information as well. The data within the DNS beacons follows the structure:\n\n\n-----\n\n<path of folder containing keylogger module>\n<path of folder containing key logs and batch script output files>\n<group name hardcoded in malware>\n<name hardcoded in malware>\n<computer name>\n<user name>\n<sleep interval>\n<C2 domain>\n\nThe Trojan does not encrypt the data sent via DNS beacons, rather it converts the ASCII\ncharacters into their hexadecimal values and includes these values in cleartext. The DNS\nbeacons sent from the Helminth executable have the following structure, which is very similar\nto the script version:\n\n00<identifier>01<sequence number><up to 24 hexadecimal values of the ASCII data>\n\nFigure 12 shows an example of the DNS beacons sent from a Helminth executable.\n\n_Figure 12 Helminth DNS C2 beacon_\n\nThe encoded data within the DNS beacons displayed in Figure 12 decode to the following:\n\nC:\\Users\\Public\\Libraries\\~Windows\\\nC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Users\\\n\n[redacted company name]\nPlato\n\n[Computer Name redacted]\nAdministrator\n30\nkernel.ws\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-05-26 - The OilRig Campaign- Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor.pdf"
    ],
    "report_names": [
        "2016-05-26 - The OilRig Campaign- Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536215,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1653698010,
    "ts_modification_date": 1653698010,
    "files": {
        "pdf": "https://archive.orkl.eu/1cba452912b12b26338ba8bd91a4e66b3b059ec7.pdf",
        "text": "https://archive.orkl.eu/1cba452912b12b26338ba8bd91a4e66b3b059ec7.txt",
        "img": "https://archive.orkl.eu/1cba452912b12b26338ba8bd91a4e66b3b059ec7.jpg"
    }
}