{
    "id": "6df6af45-ed97-4e97-8a2c-cc5080f6ade4",
    "created_at": "2023-06-05T02:06:22.824743Z",
    "updated_at": "2025-03-27T02:16:25.951816Z",
    "deleted_at": null,
    "sha1_hash": "8e47de015433118ce328193f81baefff90e74de6",
    "title": "2023-02-08 - Play Store App Serves Coper Via GitHub",
    "authors": "",
    "file_creation_date": "2023-06-04T12:51:17Z",
    "file_modification_date": "2023-06-04T12:51:17Z",
    "file_size": 1424285,
    "plain_text": "# Play Store App Serves Coper Via GitHub\n\n**[labs.k7computing.com/index.php/play-store-app-serves-coper-via-github/](https://labs.k7computing.com/index.php/play-store-app-serves-coper-via-github/)**\n\nBy Baran S February 8, 2023\n\n[We at K7 Labs recently came across this twitter post about Coper, a banking Trojan. The](https://twitter.com/Threatlabz/status/1617579712062324737)\nmain infection vector of Coper was found on the official Google Play Store where it posed\nas UniFile manager – PDF viewer app with 10,000+ downloads as shown in Figure 1.\n\nFigure 1: UniFile manager – PDF viewer from Google Play Store\nOnce launched, this app requests the user to enable unknown apps source as shown in\nFigure 2.\n\n\n-----\n\nFigure 2: Enable unknown apps source popup\nWhen the user enables “Allow from this source”, this application downloads malicious\nCoper malware file com.lastcarn_PlayMarket.apk and saves it to the device download\nfolder as PlayMarketUpdate.apk.\n\nFrom the ADB Logcat report we noticed that the malware file\n“com.lastcarn_PlayMarket.apk” gets downloaded from a GitHub repository as shown in\nFigure 3.\n\n\n-----\n\nFigure 3: ADB Logcat shows malware sample download URL\nFigure 4 shows that the repository was created by Johmeffer. At the time of writing this\nblog the GitHub repository was still live.\n\nFigure 4: GitHub repository where the malware sample was hosted\nIn this blog, we will be analyzing the package “com.lastcarn” corresponding to the\ncom.lastcarn_PlayMarket.apk which has been downloaded from the above mentioned\nGitHub repository as shown in Figure 5.\n\nFigure 5: Malicious APK downloaded from GitHub\n\n\n-----\n\nOnce the Coper malware is installed on the device, the app disguises itself as a Play\nMarket” which frequently brings up the Accessibility Service setting option on the device,\nas shown in Figure 6, until the user eventually allows this app to have the Accessibility\nService enabled.\n\nFigure 6: Request for Accessibility Service\nOnce the permissions are granted, this malicious apk decrypts the malicious payload file\ncalled “cermb” from the app’s assets folder to an executable dex format named\n‘cermb.dex’ and loads the decrypted file as shown in Figure 7.\n\nFigure 7: The logcat image shows the cermb.dex file execution at runtime\n\n### String Decryption\n\nTo evade detection, all the strings within the class, cermb.dex are encrypted with RC4 key\n“Pyae9UJ8swZDJz2KI“. Figure 8 shows the decryption routine used by the malware.\n\n\n-----\n\nFigure 8: Decryption routine\nThe Trojan then attempts to intercept SMS messages and aborts the new SMSReceived\nbroadcast to the victim; as per the bot command “EXC_SMSRCV” as shown in Figure 9.\n\n\n-----\n\nFigure 9: Intercept SMS messages\nAfter abusing the Android Accessibility Service, this Trojan acts as a keylogger to steal the\nvictims’ keystroke information from the device.\n\nFigure 10: Keylogger functionality\nFigure 11 shows the hard-coded C2 domains embedded in Coper malware.\n\nFigure 11: Encrypted and Decrypted C2 Domains\nThe list of Bot commands used by Coper malware are\n\n\n-----\n\nbot_smarts_ver\nclose_activity_injects\ninjects_delay\nkeylogger_delay\nkeylogger_enabled\nlast_keylog_send\nlock_on\nsmart_inject\nsmarts_attempts\nsms\nuninstall_apps\nurl\nvnc_start\nvnc_stop\nwrite_settings\nEXC_SMSRCV\n\nAt K7, we protect all our customers from such threats. Do ensure that you protect your\nmobile devices with a reputable security product like K7 Mobile Security and scan your\ndevices with it. Also keep your security product and devices updated and patched for the\nlatest vulnerabilities to stay safe from such threats.\n\n## IoCs\n\n**Package Name** **Hash** **Detection**\n**Name**\n\ncom.readerall.yanerslite C41D025AE669F65A3E89C50C80587AF8 Trojan (\n0001140e1 )\n\ncom.lastcarn 3ACD48E20CDC01D9F5A9BC760077F938 Trojan (\n005572801 )\n\nCermb.dex 6301EC14BD42288212694C2A9B63D2AB Trojan (\n0059e6071 )\n\n### C2\n\nhttps://countnatbt[.]site/YWRhZjAxNGM1YjFh/\nhttps://mix3etbt[.]website/YWRhZjAxNGM1YjFh/\nhttps://btcountates[.]fun/YWRhZjAxNGM1YjFh/\nhttps://3countbt[.]pw/YWRhZjAxNGM1YjFh/\nhttps://vat-app[.]su/YWRhZjAxNGM1YjFh/\n\n\n-----\n\nhttps://alleggro[.]pw/YWRhZjAxNGM1YjFh/\nhttps://raw[.]githubusercontent[.]com/johmeffer/bpm/main/com.lastcarn_PlayMarket.apk\nhttps://github[.]com/alinamslnkv/561/commits?author=alinamslnkv\n\n### MITRE ATT&CK\n\n**Tactics** **Techniques**\n\nDefense Evasion Application Discovery,\n\nObfuscated Files or Information\n\nCredential Access Capture SMS Messages,\n\nAccess Stored Application Data\n\nDiscovery System Network Configuration Discovery,\n\nApplication Discovery,\n\nSystem Information Discovery\n\nCollection Screen Capture,\n\nCapture SMS Messages,\n\nAccess Stored Application Data\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-08 - Play Store App Serves Coper Via GitHub.pdf"
    ],
    "report_names": [
        "2023-02-08 - Play Store App Serves Coper Via GitHub.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1685930782,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1685883077,
    "ts_modification_date": 1685883077,
    "files": {
        "pdf": "https://archive.orkl.eu/8e47de015433118ce328193f81baefff90e74de6.pdf",
        "text": "https://archive.orkl.eu/8e47de015433118ce328193f81baefff90e74de6.txt",
        "img": "https://archive.orkl.eu/8e47de015433118ce328193f81baefff90e74de6.jpg"
    }
}