{
    "id": "5019b17a-6ba3-441d-9c30-4e4ea1d8c00e",
    "created_at": "2023-01-12T15:04:25.203958Z",
    "updated_at": "2025-03-27T02:11:19.264827Z",
    "deleted_at": null,
    "sha1_hash": "890ddcd3dac8fbccf378ccaeb92b0c9a88d4273b",
    "title": "2021-03-31 - Bahamut Possibly Responsible for Multi-Stage Infection Chain Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T15:53:11Z",
    "file_modification_date": "2022-05-28T15:53:11Z",
    "file_size": 1936431,
    "plain_text": "# Bahamut Possibly Responsible for Multi-Stage Infection Chain Campaign\n\n**[anomali.com/blog/bahamut-possibly-responsible-for-multi-stage-infection-chain-campaign](https://www.anomali.com/blog/bahamut-possibly-responsible-for-multi-stage-infection-chain-campaign)**\n\nResearch | March 31, 2021\n\nby Anomali Threat Research\n\n\n-----\n\nAuthored by: Gage Mele, Tara Gould, Winston Marydasan, and Yury Polozov\n\n## Key Findings\n\nAnomali Threat Research discovered cyberthreat actors distributing malicious\ndocuments exploiting a vulnerability (CVE-2017-8570) during a multi-stage infection\nchain to install a Visual Basic (VB) executable on target machines.\nThis exploitation creates a backdoor that appears to only retrieve an infected\nmachine’s username, possibly indicating reconnaissance activity.\nWe assess with low confidence, based on limited technical intelligence and targeting\nconsistent with previously observed activity, that the advanced persistent threat (APT)\ncyberespionage group known as Bahamut may be responsible for this campaign.\nBahamut is a “group for hire” and typically targets entities and individuals in the Middle\nEast and South Asia with spearphishing messages and fake applications as the initial\ninfection vector.\n\n## Overview\n\nBased on a discovery in mid-February 2021, Anomali Threat Research assesses with low\nconfidence that the APT cyberespionage group-for-hire Bahamut has been conducting\nmalicious activity against multiple targets since at least June 4, 2020. While researching\nmalicious files, our researchers analyzed a .docx file (List1.docx) that contained a shared\nbundled component with another .docx file that was communicating via template injection\nwith lobertica.info, a domain previously attributed to Bahamut.[1] Further analysis of this file\nand the infection chain it follows is provided in subsequent sections below.\n\n\n-----\n\nThe header dates of a template injection domain (lobertica.info/fefus/template.dot)\ncontacted by Screeshot from NACTA Website.docx (including “Screeshot” spelling error)\nindicated malicious activity dating back to at least June 4, 2020. The title of the document\nmay be a reference to Pakistan’s National Counter Terrorism Authority (NACTA), which\nwould be consistent with Bahamut’s previous targeting and geographical location. The June\ntimeframe also aligns with Pakistan’s virtual meeting with the Financial Action Task Force\n(Groupe d'Action Financière) held on June 24, 2020, which resulted in keeping Pakistan on\nthe financial grey list for terrorism funding.[2] Additionally, in June 2020, between the 9 andth\n15, the United Arab Emirates (UAE) and Pakistan conducted repatriation flights forth\nPakistani nationals in the UAE. And, as of June 29, the UAE suspended passengers from\nPakistan, until more COVID-19-related facilities could be created.[3] While the timing may be\ncoincidental, sophisticated threat actors such as Bahamut are known to use real-world\nevents as themes for targeted cyber campaigns. Historically, in December 2016, Bahamut\nreportedly targeted human rights activists in the Middle East with spearphishing attacks to\ndeliver Android-based malware, this persisted through 2018, with the targeting of entities\nand individuals in Egypt, Iran, India, Pakistan, Palestine, Qatar, Tunisia, and the UAE.[4]\n\n## Details\n\nAnomali Threat Research identified malicious .docx files that exploit a remote code\nexecution (RCE) vulnerability (CVE-2017-8570). The activity apparently began in June 2020\nand continued through at least mid-February 2021. The actors used at least three files with\ngeneric names: List1.docx, List for Approval.docx, and report.doc, and one appearing\nto employ a NACTA theme with a typo: Screeshot from NACTA Website.docx. (Figure 1)\n\n**_Figure 1 – Infection Chain_**\n\n\n-----\n\n## Technical Analysis\n\nThreat actors distributed .docx files with the objective of dropping a rich text format (RTF)\nfile that began the infection process for additional malicious activity. Analysis of the .docx\nrevealed a multi-step infection process.\n\nThe graphic below displays the connection between the malicious files and actor\ninfrastructure (see Figure 2). The .xml file at the top is shown as the bundled component\nthat is contained inside other .docx files. The .docx files used template injection to download\na file from a malicious domain. Next, we observed an .rtf file being dropped that contained\nmultiple files with the objective to drop VB executables. The final layer in the chart shows\nthe IP addresses we observed communicating with the malicious files.\n\n**_Figure 2 – Malicious Infrastructure_**\n\n\n-----\n\n**_Figure 3 – Self Signed Certificate on 185.175.158.227_**\n\nFigure 3 above shows a self-signed certificate on the IP 185.175.158.227, a method\nBahamut has used in the previous activity.[5] Bahamut has also been reported to have a\npreference for utilizing the marketing email service MailKing.[6] The alignment of these data\npoints, while not conclusive, further supports the assessment that this activity may be\nrelated to Bahamut.\n\n\n### DOCX Analysis\n\n**Analyzed file – List1.docx**\n\n**MD5 – 3df18ecd55f8e267be39f6f757bcd5f0**\n\nThe analyzed document is a .docx file with an embedded RTF object from\n**memoadvicr.com/kodec/report.doc (see Figure 4). The external target is placed in the**\n‘webSettings.xml.rels’ file, which will download the RTF file. As shown in Figure 4 the\ndropped file is called report.doc, which will be analyzed in the subsequent section.\n\n**_Figure 4 – Embedded RTF Object_**\n\n### RTF Analysis\n\n**Analyzed File – report.doc**\n\n**MD5 – 9dc1cdba6d5838f7984de89521f18ae8**\n\nThe analyzed document is an RTF file downloaded from a .docx file containing an\nobfuscated .sct file that exploits CVE-2017-8570 (RCE). Exploitation of the vulnerability\nallows execution of the .sct file that in-turn executes other files dumped from the RTF.\nFilenames contained in the RTF (shown in Figures 5-6) include: eisghfgh321.tmp, d.tmp,\n**E.sct.**\n\n\n-----\n\n**_Figure 5 – OLE Package File Information for .tmp Files_**\n\n**_Figure 6 – OLE Package File Information for. sct File_**\n\nThe obfuscated .sct file contents were mixed with unwanted comments and confusing\nvariable names to inhibit static analysis. (Figure 7). But, once reconstructed with\ncomprehendible variable names and stripped of random strings, we were able to construct\na more comprehensible version of this .sct file (Figure 8).\n\n\n-----\n\n**_Figure 7 – Obfuscated .sct File Contents_**\n\n\n-----\n\n**_Figure 8 – Beautified. sct File Contents_**\n\nWith a better understanding of the .sct file, we determined that the script checks the\nexistence of the dropped file within the %temp% folder of the victim machine. This is the file\nthat dropped during the exploitation of the CVE-2017-8570.\n\nNext, the function routine readBinary reads the data in eisghfgh321.tmp and the script\nreplaces the first two bytes with MZ and substitutes the last two zero bytes until\n**eisghfgh321.tmp is molded into dwmm.exe. The executable is then dropped in the**\n%PUBLIC% folder on an infected machine.\n\nThe script again checks for the existence of this malicious executable in %PUBLIC% folder\nand, if it exists, the winword.exe process is killed to close the initially opened decoy\ndocument. Lastly, the executable - written in VB - functions as a backdoor on an infected\nmachine. After decompiling the code, we found that the POST payload, dwmm.exe, is\ngenerated on-the-fly and dropped while communicating with the actor’s C2 via a POST\nrequest to the actor’s Command and Control (C2) server (see Figure 9).\n\n\n-----\n\n**_Figure 9 – dxmm.exe POST Request_**\n\nAnalysis of the POST request shows that it will send back the username that was found\nlocated between “pt” and “tion,” as shown in Figure 10 below with brutal serving as the\nusername.\n\n**_Figure 10 – dxmm.exe POST Request Information_**\n\n## Conclusion\n\nBahamut is a sophisticated APT group that utilizes anti-analysis techniques and multi-stage\ninfection chains. Additionally, like many other APT groups, they employ social engineering\nand user interaction for the initial infection through spearphishing emails and messages.\nWhile we have identified many consistencies between this most recently discovered\ncampaign and previously reported activity attributed to Bahamut, and the targeting appears\nto be consistent with Bahamut’s assessed interests, due to the lack of enough unique\nindicators of compromise or tactics, techniques, and procedures (TTPs) we can only assess\nwith “low confidence” that Bahamut may be behind this activity. We will continue monitoring\nthis group for additional malicious activity and provide details when appropriate.\n\n## MITRE TTPs\n\nApplication Layer Protocol - T1071\n\nCommand and Scripting Interpreter: Visual Basic - T1059.005\n\nData Staged: Local Data Staging - T1074.001\n\nDeobfuscate/Decode Files or Information - T1140\n\nMasquerading - T1036\n\nObtain Capabilities: Vulnerabilities - T1588.006\n\nPhishing - T1566\n\nPhishing: Spearphishing Attachment - T1566.001\n\nSystem Information Discovery - T1082\n\nTemplate Injection - T1221\n\nUser Execution - T1204\n\nUser Execution: Malicious File - T1204.002\n\n\n-----\n\n## Endnotes\n\n[1] BlackBerry Research and Intelligence Team, “Bahamut: Hack-for-Hire Masters of\n\nPhishing, Fake, News, and Fake Apps,” BlackBerry, accessed March 9, 2021, published\nOctober 2020, https://www.blackberry.com/us/en/pdfviewer?file=/content/dam/blackberrycom/asset/enterprise/pdf/direct/report-spark-bahamut.pdf, 81.\n\n\n\n[2] “Pakistan’s case not taken up ate FATF meeting: FO,” Dawn, accessed March 9, 2021,\n\npublished June 27, 2020, https://www.dawn.com/news/1565473; “Pakistan needs legislation\nto meet three outstanding FATF benchmarks: Report,” Hindustan Times, accessed March 9,\n2021, published March 2, 2021, https://www.hindustantimes.com/world-news/pakistanneeds-legislation-to-meet-three-outstanding-fatf-benchmarks-report101614669450193.html.\n\n[3] “Coronavirus: more repatriation flights from UAE to Pakistan announces,” The National,\n\naccessed March 10, 2021, published June 9, 2020,\nhttps://www.thenationalnews.com/lifestyle/travel/coronavirus-more-repatriation-flights-fromuae-to-pakistan-announced-1.1030914; “UAE suspends receiving passengers from\nPakistan as of June 29 over COVID fears,” Reuters, accessed March 10, 2021, published\nJune 28, 2020, https://www.reuters.com/article/us-health-coronavirus-emiratespakistan/uae-suspends-receiving-passengers-from-pakistan-as-of-june-29-over-covid-fearsidUSKBN23Z0RM.\n\n\n\n[4] Collin Anderson, “Bahamut, Pursuing a Cyber Espionage Actor in the Middle East,\n\n_Bellingcat, accessed March 9, 2021, published June 21, 2017,_\nhttps://www.bellingcat.com/news/mena/2017/06/12/bahamut-pursuing-cyber-espionageactor-middle-east/; Warren Mercer, et al., “Advanced Mobile Malware Campaign in India\nuses Malicious MDM - Part 2,” Cisco Talos Blog, accessed March 10, 2021, published July\n25, 2018, https://blog.talosintelligence.com/2018/07/Mobile-Malware-Campaign-usesMalicious-MDM-Part2.html;\nhttps://www.thaicert.or.th/downloads/files/A_Threat_Actor_Encyclopedia.pdf, 35; BlackBerry\nResearch and Intelligence Team, “Bahamut: Hack-for-Hire Masters of Phishing, Fake,\nNews, and Fake Apps,” BlackBerry, 5; Taha Karim, “IN THE TRAILS OF WINDSHIFT APT,”\nDarkMatter, accessed March 10, 2021, published August 2018,\nhttps://gsec.hitb.org/materials/sg2018/D1%20COMMSEC%20%20In%20the%20Trails%20of%20WINDSHIFT%20APT%20-%20Taha%20Karim.pdf, 13.\n\n[5] BlackBerry Research and Intelligence Team, “Bahamut: Hack-for-Hire Masters of\n\nPhishing, Fake, News, and Fake Apps,” BlackBerry, 49.\n\n\n\n[6] Ibid.\n\n## IOCs\n\n\n-----\n\n**Domains and URLs**\nhttp://lobertica.info\nhttp://lobertica.info/fefus/\nhttp://lobertica.info/fefus/report.doc\nhttp://lobertica.info/fefus/template.dot\nhttp://lobertica.info/msoll/igtxpres.zip\nhttp://zovwelle.com\nhttp://zovwelle.com/opregftyro/ijkbfumnbvc.php\nhttp://memoadvicr.com\nhttp://memoadvicr.com/kodec/report.doc\nhttp://memoadvicr.com/dvsec/report.doc\nhttp://fastfiterzone.com/sdjfbjsgdlfvfd/gfdbvgfgggh.php\n\n**EXEs**\n04e05054e9e4f1c6cba9292fcad9e06f\n61639f301c4cdadfd6c4a696375bdc99\n\n### Files\n\n**.docx**\n\n68d0e326e18bd7ec50db011f9c119e25\n\nde1f5c8223505f7e8c64a4b852614b14\n\n3df18ecd55f8e267be39f6f757bcd5f0\n\n**RTF**\n\n9dc1cdba6d5838f7984de89521f18ae8\n\n**Scriplet**\n\nd3e989f44fe3065ec501fe7f0fc33c3e\n\n**Bundled**\n\n11eb560d256383859b8135cfbbf98e30\n\n**IPs**\n\n185.183.161.125\n\n185.175.158.227\n\n208.91.197.54\n\n194.120.24.116\n\n93.184.220.29\n\n194.67.93.17\n\n\n-----\n\nTopics: Research\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-31 - Bahamut Possibly Responsible for Multi-Stage Infection Chain Campaign.pdf"
    ],
    "report_names": [
        "2021-03-31 - Bahamut Possibly Responsible for Multi-Stage Infection Chain Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "732bfd4b-8c15-42a5-ac4b-14a9a4b902e9",
            "created_at": "2022-10-25T16:07:23.38079Z",
            "updated_at": "2025-03-27T02:02:09.771357Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "ETDA:Bahamut",
            "tools": [
                "Bahamut",
                "DownPaper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f99641e0-2688-47b0-97bc-7410659d49a0",
            "created_at": "2023-01-06T13:46:38.802141Z",
            "updated_at": "2025-03-27T02:00:02.922907Z",
            "deleted_at": null,
            "main_name": "Bahamut",
            "aliases": [],
            "source_name": "MISPGALAXY:Bahamut",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6bd4ed50-e116-494c-bb70-9587876663f1",
            "created_at": "2023-01-06T13:46:39.004062Z",
            "updated_at": "2025-03-27T02:00:02.974882Z",
            "deleted_at": null,
            "main_name": "WindShift",
            "aliases": [
                "Windy Phoenix"
            ],
            "source_name": "MISPGALAXY:WindShift",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ada9e5d3-1cb2-4b70-a3c8-96808c304ac8",
            "created_at": "2022-10-25T15:50:23.6515Z",
            "updated_at": "2025-03-27T02:00:55.513513Z",
            "deleted_at": null,
            "main_name": "Windshift",
            "aliases": [
                "Windshift",
                "Bahamut"
            ],
            "source_name": "MITRE:Windshift",
            "tools": [
                "WindTail"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "68f12936-2361-4720-87e1-b79a4fdbf1a0",
            "created_at": "2022-10-25T16:07:24.409855Z",
            "updated_at": "2025-03-27T02:02:10.21199Z",
            "deleted_at": null,
            "main_name": "WindShift",
            "aliases": [
                "Windy Phoenix"
            ],
            "source_name": "ETDA:WindShift",
            "tools": [
                "WindTail"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535865,
    "ts_updated_at": 1743041479,
    "ts_creation_date": 1653753191,
    "ts_modification_date": 1653753191,
    "files": {
        "pdf": "https://archive.orkl.eu/890ddcd3dac8fbccf378ccaeb92b0c9a88d4273b.pdf",
        "text": "https://archive.orkl.eu/890ddcd3dac8fbccf378ccaeb92b0c9a88d4273b.txt",
        "img": "https://archive.orkl.eu/890ddcd3dac8fbccf378ccaeb92b0c9a88d4273b.jpg"
    }
}