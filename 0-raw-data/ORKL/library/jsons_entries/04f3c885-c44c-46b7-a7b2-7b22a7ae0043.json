{
    "id": "04f3c885-c44c-46b7-a7b2-7b22a7ae0043",
    "created_at": "2023-01-12T15:10:55.025126Z",
    "updated_at": "2025-03-27T02:16:59.171124Z",
    "deleted_at": null,
    "sha1_hash": "04f157c2878298ecf7af144d5c9c190b82174948",
    "title": "2020-10-20 - Katana- a new variant of the Mirai botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T04:58:43Z",
    "file_modification_date": "2022-05-28T04:58:43Z",
    "file_size": 548253,
    "plain_text": "# Katana: a new variant of the Mirai botnet\n\n**prod-blog.avira.com/katana-a-new-variant-of-the-mirai-botnet**\n\nOctober 20, 2020\n\nAvira’s IoT research team has recently identified a new variant of the Mirai botnet. It has been named Katana, after the\nJapanese sword.\n\nAlthough the Katana botnet is still in development, it already has modules such as layer 7 DDoS, different encryption\nkeys for each source, fast self-replication, and secure C&C. There are indications that katana may be associated with\nan HTTP banking botnet in the future.\n\n[We’ve previously looked at how Mirai, an IoT botnet, has evolved since its source code became public. A recent](https://www.avira.com/en/blog/how-is-the-mirai-variant-infecting-the-iot-landscape)\n[analysis of IoT attacks and malware trends shows that Mirai’s evolution continues. For example, variants of Mirai can](https://www.avira.com/en/blog/malware-threat-report-q2-2020-statistics-and-trends)\n[be bought, sold, or sourced via YouTube channels, in this case, VegaSec. These, and other changes, enable unskilled](https://www.youtube.com/channel/UC6ZLky15GgnkPOl7Co50jPg/featured)\nattackers to create malicious botnets, resulting in an increase in attacks.\n\n## Analysis\n\nThe Katana botnet attempts to exploit old vulnerabilities via Remote Code Execution/Command Injection vulnerabilities\nsuch as LinkSys and GPON home routers. For the last two weeks, a surge of malware binaries has been captured by\nour honeypot, and it was this that encouraged us to have a closer look.\n\nAlthough Katana uses old exploits (we assume it is in the testing/development stage), it still attracted our attention\nbecause:\n\nIt is actively infecting hundreds of devices daily,\nThere are interesting features associated with this botnet\n\nOver a period of time, the botnet is being downloaded with different IPs. The figures below show how it is downloaded:\n\n**05-10-2020**\n\n**08-10-2020**\n\n**12-10-2020**\n\nDuring our analysis, we found that the botnet runs as a single instance by binding different ports, i.e.,\n**53168, 57913, 59690, 62471, and 63749. One such example is shown below:**\n\nThe botnet tries to manipulate\nthe watchdog and prevents\nthe device from restarting. The\nfigure below shows as follow:\n\n\n-----\n\nIn short, Katana retains several Mirai features. These include running a single instance, random process name,\nmanipulating the watchdog to prevent the device from restarting, and DDoS commands. The botnet also configures the\n**iptables to drop access to port 37215 of an affected device.**\n\nSimilar to Mirai, the botnet also supports DDoS commands:\n\nattack_app_http\n\nattack_get_opt_int\n\nattack_get_opt_ip\n\nattack_get_opt_str\n\nattack_gre_eth\n\nattack_gre_ip\n\nattack_init\n\nattack_kill_all\n\nattack_method_http\n\nattack_method_std\n\nattack_method_tcpack\n\nattack_method_tcpstomp\n\nattack_method_udpgeneric\n\nattack_method_udpplain\n\nattack_method_udpvse\n\nattack_ongoing\n\nattack_parse\n\nattack_start\n\nattack_tcp_ack\n\nattack_tcp_stomp\n\n\n-----\n\nattack_tcp_syn\n\nattack_udp_dns\n\nattack_udp_generic\n\n**attack_udp_ovhhex**\n\nattack_udp_plain\n\n**attack_udp_stdhex**\n\nattack_udp_vse\n\n**_attack_app_http suggests that the botnet is in fact an http botnet. Furthermore, the functions (highlighted bold above)_**\napparently are new commands that this new botnet leverages for its attack.\n\n## Network Analysis\n\nLike Mirai, this new botnet targets home routers like GPON and LinkSys via Remote Code Execution/Command\nInjection vulnerabilities.\n\nDuring our analysis, we discovered that it is possible to bypass authentication by simply appending “?images” to any\nURL of the device that requires authentication. In this way, an intruder can manage the device. Traffic below shows how\nthis happens:\n\nDuring our analysis, we observed that there is a binary CGI executable (tmUnblock.cgi) found in some LinkSys routers.\nThis has multiple security holes that permit various attacks on the router. The malware tries to exploit the router via a\nvulnerable CGI script, as shown below:\n\nThe authentication is base64 encoded that is decoded as login: password.\n\nThe botnet also tries to exploit different devices that use the RealTek SDK with miniigd deamon, which is vulnerable\nto OS command Injection in the UPnP SOAP Interface. Traffic is shown below:\n\n\n-----\n\nThe Katana botnet also tries to communicate to its following C2 servers:\n\n100cnc[.]r4000[.]net\n1280x1024cnc[.]r4000.net\n\nAt this time, the Katana botnet is actively infecting hundreds of devices each day. The following are the top 3 as per our\nstats until now.\n\nDSL-7740C DLink\nDOCSIS 3.1 Wireless Gateway\nDell PowerConnect 6224 Switch\n\n## Conclusion\n\nIt is important to safeguard IoT endpoints installed in consumer environments. The industry needs to start adopting best\npractices to improve device security to ensure that their IoT devices are reliable products and are regularly patched.\n\nThe Avira IoT Research team monitors such new malware families or variants and provide detections for them.\nIntegrating [Avira SafeThings and](https://oem.avira.com/en/solutions/software-development-kits) [anti-malware technologies can help protect customers from such attacks.](https://oem.avira.com/en/solutions/software-development-kits)\n\n## IoCs\n\n**Sha256** **Target Architecture** **Debugging**\n**Info**\n\n1a8f57c659393b6153d1db58863e2ed99e4505ac89c3cdc5064fc0468a6af740 Intel 80386 stripped\n\n20e5d75056aad8120a3d5bd70910387c02f3bfad5ff7a2f414a223c632927be3 Intel 80386 stripped\n\n4625702c98b9db0fafa1f82647288ccb3afd1e640d3b74199a475e60298ccaba Renesas SH stripped\n\n4ecdc38a758773baa1813d8960bb5bf9d4b574526eb6ce09ff04041ad913632c ARM with debug_info\n\n607d0a502c0659f31640440fbde3c7ad0c73e208b8e961b0ec038514d0d0b555 ARM with debug_info\n\n738e80232501dcae0e5ff8dc50a30cc1350f555294b637167dfe1f88cb58b7c1 Motorola m68k statically linked\n\n\n8aa7c90ddbaa213f12d4e3bfe2c37cf2593e09008493024a609e5a55cd5abdef PowerPC or cisco\n4500\n\n\nstripped\n\n\n9751b5d280c6f7b4ee084ecd7ad51e3dc36cfecbfa837acc388d608d39885b12 x86-64 stripped\n\nbe59eaf0ab86c8dd6cad03e772550edf4342fdb63762a8cb44dee3f421bd206c ARM with debug_info\n\nd8dd74cf72ff9ef46e2453f4da442a235493e95eb65ff0ff87c60b9dc93ad0d5 ARM with debug_info\n\ne18c367fe9fb480067173e557606ea7165a9347977311bebcb1d8e05a141f0ed Intel 80386 stripped\n\nfb6b1d45a0393d609c8d0de355717585ee32eac7495ecb65ddcf0eefcbae05d1 ARM with debug_info\n\n05666fef3489f9860b795493128da03eaea4d86f4bd6eef614e5ec575169ba20 x86-64 stripped\n\n\n-----\n\n17712da0934af383baa501ee6f23bea4489707b70d155c807f96e7acc0cbd003 PowerPC or cisco\n4500\n\n\nstripped\n\n\n203fed7435fb3f8428e57c798b17f30c4eba7b649c0ebf842cbba39499817739 Renesas SH stripped\n\n2e809192edf97c96eef0005d5fddbfe14ac1d1a4e9c868c29990849432190310 ARM with debug_info\n\n34ed813148775b3aa0d817fc383d77117972d3055fe813387f7371a50c2dc135 Intel 80386 stripped\n\n37336a15c1757b0f5ddc4ec9cb581e0d333968c5885169871d5b7d80b736cafd ARM with debug_info\n\n41e608eaa115b8a9bb326d208592b2657a5978b96ad83c44c66dd0062d589351 ARM with debug_info\n\n47eddc780e2378a48d5874b9b9e367284f78929dad1dc1a06daf6b99cc1c0466 Renesas SH stripped\n\n7691f6540c8fb964c5c6aeeee7bd7c8120654d27a474d74be03620164e70a7b7 MIPS stripped\n\n7af99a666c01aee840f86f89bf9e978553c2f104ba53b63099b3eb060068130c x86-64 stripped\n\n7f7630859e53161ee167b7ed7c23bc0367307638900dd5a1f9d495683047aa97 Intel 80386 stripped\n\n86ef3b56079c51266e90e1c139675a4e62005612275b97f61cee168a2e47b189 Intel 80386 stripped\n\n9c0c968f5a5277598bc7cfbfab419805c96a587d5a560492f02423f0567b9bae Intel 80386 stripped\n\nb06dc2342230b7ad67d9f18589bca482263c0a0ef4876cc141e3afcc09a47dc8 Motorola m68k statically linked\n\ncf168849329fdc05bebe2fc256de7c2afaf9a31c54696e47f2b42c42276acd2d Intel 80386 stripped\n\n\ne7bbc103496c541b25754d1e3d69dd61f5462c7a49243b65c3c2c12f8a9785f1 PowerPC or cisco\n4500\n\n\nstripped\n\n\nef2f9458b49cf85cf9e807f6dca0c19c78923f71308b6dd61fff971c89cb0f34 Intel 80386 stripped\n\nf109945be0837375bf78a2cee25e20d1167c2add57d0f1aeb982375f672b4352 MIPS stripped\n\nff4206109cdaa560eedfeec302616bfc5818ea16adb4e600b3c5007d3fe12501 Motorola m68k statically linked\n\n1adc1afc26772698e2d0894b25aa16dc3ce9dd70418acb65dda5d12d7e9da31c Motorola m68k statically linked\n\n289a20c1d4685c3080ef2c9154dc6340572e4475454e919364e756d1609fee17 MIPS stripped\n\n37f27fbbac1836d0289bc90bb56c32492b77a4af885e26f065211003ab0c60bd ARM with debug_info\n\n6240c85359cc9b97b6e8db08bf5ddab61a19c6ba04970bd3feb6b5792a6ee6c1 MIPS stripped\n\n7440ee28417403cd69d3e1489866330bcc96079c157bb737004ee0d54c81d254 x86-64 stripped\n\n\n96a4771ed0bf8802057e654e02d524acea5eb042c41287db5eb8acd4092b47c5 PowerPC or cisco\n4500\n\n\nstripped\n\n\n9b5be5ce331e1300b36b6929901d8bfccd2fdaa44382b9ef3695779d5fa21b06 Intel 80386 stripped\n\nb9c7a0d43e4d49393669392fdeab45da0991b690d5f03d73f27ce9e17463fb87 Intel 80386 stripped\n\nd18330c627f034226bfa2fcd5a38748496c3ae9b9877aadd763ead65a7c1bbd3 Intel 80386 stripped\n\nda308d1b3d8123ca2f3ebfe1115158a2e2c1a184aa608ff72c192fc333bb3d9c Renesas SH stripped\n\ne2a40a2b24850d78e694868f3cafb541374662501c37cac02888eebf98c128ed ARM with debug_info\n\nLike what you read?\nStay up to date with our monthly Technology Insights blog newsletter\n\n[Subscribe now](https://share.hsforms.com/1xXK1OhBFTNaGCMmYEk6kCw2xt4r?utm_source=avira.com&utm_medium=blog)\n\n\n-----\n\n[This post is also available in: GermanFrenchItalian](https://www.avira.com/de/blog/katana-eine-neue-variante-des-botnets-mirai)\n\nAvira Protection Labs\n\nProtection Lab is the heart of Avira’s threat detection and protection unit. The researchers at work in the Labs are some\nof the most qualified and skilled anti-malware researchers in the security industry. They conduct highly advance\nresearch to provide the best detection and protection to nearly a billion people world-wide.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-20 - Katana- a new variant of the Mirai botnet.pdf"
    ],
    "report_names": [
        "2020-10-20 - Katana- a new variant of the Mirai botnet.pdf"
    ],
    "threat_actors": [
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536255,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653713923,
    "ts_modification_date": 1653713923,
    "files": {
        "pdf": "https://archive.orkl.eu/04f157c2878298ecf7af144d5c9c190b82174948.pdf",
        "text": "https://archive.orkl.eu/04f157c2878298ecf7af144d5c9c190b82174948.txt",
        "img": "https://archive.orkl.eu/04f157c2878298ecf7af144d5c9c190b82174948.jpg"
    }
}