{
    "id": "c6763d82-af80-41c1-8a82-a5bec17999e7",
    "created_at": "2023-01-12T15:06:32.57177Z",
    "updated_at": "2025-03-27T02:09:39.358896Z",
    "deleted_at": null,
    "sha1_hash": "f897a0489223cc9b333f465d6943ba835f743bde",
    "title": "2017-04-24 - XPan, I am your father",
    "authors": "",
    "file_creation_date": "2022-05-28T03:24:51Z",
    "file_modification_date": "2022-05-28T03:24:51Z",
    "file_size": 980864,
    "plain_text": "# XPan, I am your father\n\n**[securelist.com/blog/research/78110/xpan-i-am-your-father/](https://securelist.com/blog/research/78110/xpan-i-am-your-father/)**\n\nAuthors\n\nAnton Ivanov\n\n[Fabio Assolini](https://securelist.com/author/fabioa/)\n\nFedor Sinitsyn\n\n[Santiago Pontiroli](https://securelist.com/author/santiago/)\n\n## .one ransomware decrypted\n\n[While we have previously written on the now infamous XPan ransomware family, some of it’s](https://securelist.com/teamxrat-brazilian-cybercrime-meets-ransomware/76153/)\nvariants are still affecting users primarily located in Brazil. Harvesting victims via weakly\nprotected RDP (remote desktop protocol) connections, criminals are manually installing the\nransomware and encrypting any files which can be found on the system.\n\n\n-----\n\nInterestingly, this XPan variant is not necessarily new in the malware ecosystem. However,\nsomeone has chosen to keep on infecting victims with it, encouraging security researchers to\nhunt for samples related to the increasing number of incident reports. This sample is what\ncould be considered as the “father” of other XPan ransomware variants. A considerable\namount of indicators within the source code depict the early origins of this sample.\n\n_“Recupere seus arquivos aqui.txt” loosely translated to “recover your files here” is a phrase_\n_that not many Brazilian users are eager to see in their desktops._\n\nThe ransomware author left a message for Kaspersky in other versions and has done the\nsame in this one, with traces to the NMoreira “CrypterApp.cpp” there’s a clear link between\ndifferent variants among this malware family.\n\n_NMoreira, XPan, TeamXRat, different names but same author._\n\nEven though many Brazilian-Portuguese strings are present upon initial analysis, there were\na couple that caught our attention. Firstly, the ransomware uses a batch file which will pass a\ncommand line parameter to an invoked executable file, this parameter is “eusoudejesus”\nwhich means “I’m from Jesus”. Developers tend to leave tiny breadcrumbs of their\npersonality behind in each one of their creations, and in this sample we found many of them.\n\n\n-----\n\n_A brief religious reference found in this XPan variant._\n\nSecondly, a reference to a Brazilian celebrity is done, albeit indirectly. “Computador da Xuxa”\nwas a toy computer sold in Brazil during the nineties, however it’s also a popular expression\nwhich is used to make fun of very old computers with limited power.\n\n\n-----\n\n_This is what cybercriminals think of your encrypted computer: just a toy they can control._\n\n“Muito bichado” equals to finding a lot of problems in these type of systems, in this case\nmeaning that the environment in which is XPan is executing is not playing fair and the\nexecution is quite buggy.\n\n\n-----\n\nLastly, we have the ransomware note demanding the victim to send an email to the account\n‘one@proxy.tg’. Considering that the extension for all the encrypted files in this variant is\n**‘.one’ this seems like a pretty straightforward naming convention for the criminals’**\ncampaigns.\n\n_The rescue note in Portuguese._\n\nUpon closer inspection, we discovered that this sample is nearly identical to another version\nof Xpan which used to be distributed back in November 2016 and used the extension\n“.__AiraCropEncrypted!”. Every bit of executable code remains the same, which is quite\nsurprising, because since that time there were several newer versions of this malware with\nan updated encryption algorithm. Both samples have the same PE timestamp dating back to\nthe 31st of October 2016.\n\nThe only difference between the two is the configuration block which contains the following\ninformation:\n\nlist of target file extensions;\nransom notes;\ncommands to execute before and after encryption;\nthe public RSA key of the criminals.\n\n\n-----\n\n_The decrypted configuration block of Xpan that uses the extension “.one”._\n\nThe file encryption algorithm also remains the same. For each target file the malware\ngenerates a new unique 255-byte random string S (which contains the substring “NMoreira”),\nturns it into a 256-bit key using the API CryptDeriveKey, and proceeds to encrypt the file\ncontain using AES-256 in CBC mode with zero IV. The string S will be encrypted using the\ncriminals’ RSA public key from the configuration block and stored in the beginning of the\nencrypted file.\n\nAccording to one of the victims that contacted us, criminals were asking for 0.3 bitcoin to\nprovide the recovery key, using the same approach as they did with before: the user sends a\nmessage to a mailbox with his unique ID and patiently awaits for further instructions.\n\nThe victims so far are small and medium businesses in Brazil: ranging from a dentist clinic to\na driving school, demonstrating once again that ransomware makes no distinctions and\neveryone is at risk. As long as there are victims, assisting them and providing decryption\ntools whenever possible is necessary, no matter the ransomware family or when it was\ncreated.\n\n## Victims: we can help\n\nThis time luck is on the victims’ side! Upon thorough investigation and reverse engineering of\nthe sample of “.one” version of Xpan, we discovered that the criminals used a vulnerable\ncryptographic algorithm implementation. It allowed us to break encryption as with the\n[previously described Xpan version.](https://securelist.com/teamxrat-brazilian-cybercrime-meets-ransomware/76153/)\n\nWe successfully helped a driving school and a dentist clinic to recover their files for free and\nas usual we encourage victims of this ransomware to not pay the ransom and to contact our\n[technical support for assistance in decryption.](http://support.kaspersky.com/)\n\n\n-----\n\nBrazilian cybercriminals are focusing their efforts in creating new and local ransomware\nfamilies, attacking small companies and unprotected users. We believe this is the next step\nin the ransomware fight: going from global scale attacks to a more localized scenario, where\nlocal cybercriminals will create new families from scratch, in their own language, and\nresorting to RaaS (Ransomware-as-a-service) as a way to monetize their attacks.\n\n## MD5 reference\n\ndd7033bc36615c0fe0be7413457dccbf – Trojan-Ransom.Win32.Xpan.e (encrypted file\nextension: “.one”)\n\n54217c1ea3e1d4d3dc024fc740a47757 – Trojan-Ransom.Win32.Xpan.d (encrypted file\nextension: “.__AiraCropEncrypted!”)\n\n[Brazil](https://securelist.com/tag/brazil/)\n[RaaS](https://securelist.com/tag/raas/)\n[Ransomware](https://securelist.com/tag/ransomware/)\n[RDP](https://securelist.com/tag/rdp/)\n[TeamXRat](https://securelist.com/tag/teamxrat/)\n[Trojan](https://securelist.com/tag/trojan/)\n\nAuthors\n\nAnton Ivanov\n\n[Fabio Assolini](https://securelist.com/author/fabioa/)\n\nFedor Sinitsyn\n\n[Santiago Pontiroli](https://securelist.com/author/santiago/)\n\nXPan, I am your father\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-24 - XPan, I am your father.pdf"
    ],
    "report_names": [
        "2017-04-24 - XPan, I am your father.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4e98dd18-e285-4e15-a810-4962bed803e9",
            "created_at": "2023-01-06T13:46:38.492471Z",
            "updated_at": "2025-03-27T02:00:02.847392Z",
            "deleted_at": null,
            "main_name": "TeamXRat",
            "aliases": [
                "CorporacaoXRat",
                "CorporationXRat"
            ],
            "source_name": "MISPGALAXY:TeamXRat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2dfaa730-7079-494c-b2f0-3ff8f3598a51",
            "created_at": "2022-10-25T16:07:23.474746Z",
            "updated_at": "2025-03-27T02:02:09.822683Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "ATK 67",
                "Cobalt Gang",
                "Cobalt Spider",
                "Gold Kingswood",
                "Mule Libra",
                "TAG-CR3"
            ],
            "source_name": "ETDA:Cobalt Group",
            "tools": [
                "ATMRipper",
                "ATMSpitter",
                "Agentemis",
                "AmmyyRAT",
                "AtNow",
                "COOLPANTS",
                "CobInt",
                "Cobalt Strike",
                "CobaltStrike",
                "Cyst Downloader",
                "Fareit",
                "FlawedAmmyy",
                "Formbook",
                "Little Pig",
                "Metasploit Stager",
                "Mimikatz",
                "More_eggs",
                "NSIS",
                "Nullsoft Scriptable Install System",
                "Pony Loader",
                "Ripper ATM",
                "SDelete",
                "Siplog",
                "SoftPerfect Network Scanner",
                "SpicyOmelette",
                "Taurus Builder",
                "Taurus Builder Kit",
                "Taurus Loader",
                "Terra Loader",
                "ThreatKit",
                "VenomKit",
                "cobeacon",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c11abba0-f5e8-4017-a4ee-acb1a7c8c242",
            "created_at": "2022-10-25T15:50:23.744036Z",
            "updated_at": "2025-03-27T02:00:55.537114Z",
            "deleted_at": null,
            "main_name": "Cobalt Group",
            "aliases": [
                "Cobalt Group",
                "GOLD KINGSWOOD",
                "Cobalt Gang",
                "Cobalt Spider"
            ],
            "source_name": "MITRE:Cobalt Group",
            "tools": [
                "Mimikatz",
                "More_eggs",
                "SpicyOmelette",
                "SDelete",
                "Cobalt Strike",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535992,
    "ts_updated_at": 1743041379,
    "ts_creation_date": 1653708291,
    "ts_modification_date": 1653708291,
    "files": {
        "pdf": "https://archive.orkl.eu/f897a0489223cc9b333f465d6943ba835f743bde.pdf",
        "text": "https://archive.orkl.eu/f897a0489223cc9b333f465d6943ba835f743bde.txt",
        "img": "https://archive.orkl.eu/f897a0489223cc9b333f465d6943ba835f743bde.jpg"
    }
}