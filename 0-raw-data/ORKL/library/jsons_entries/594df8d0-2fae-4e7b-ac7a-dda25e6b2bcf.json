{
    "id": "594df8d0-2fae-4e7b-ac7a-dda25e6b2bcf",
    "created_at": "2023-01-12T15:04:46.451539Z",
    "updated_at": "2025-03-27T02:05:39.543208Z",
    "deleted_at": null,
    "sha1_hash": "0305a8f52b29fbd8794add8d012daec73954830d",
    "title": "2022-04-29 - Using EPSS to Predict Threats and Secure Your Network",
    "authors": "",
    "file_creation_date": "2022-05-28T17:45:40Z",
    "file_modification_date": "2022-05-28T17:45:40Z",
    "file_size": 635189,
    "plain_text": "# Using EPSS to Predict Threats and Secure Your Network\n\n**[fortinet.com/blog/threat-research/predict-threats-and-secure-networks-with-epss](https://www.fortinet.com/blog/threat-research/predict-threats-and-secure-networks-with-epss)**\n\nApril 29, 2022\n\nIn the world of cybersecurity and threat intelligence, understanding what threats you might\nface next is critical to effectively securing your network. The Common Vulnerability Scoring\nSystem (CVSS) has been a valuable tool in this fight because it highlights how exploitable\ndifferent vulnerabilities are. And now, EPSS (Exploit Prediction Scoring System) can\nsupplement CVSS by providing dynamic insight into the likelihood that a vulnerability will be\nexploited. It produces a probability score of a rational number between 0.0 and 1.0, and the\nhigher the score, the greater the probability that a vulnerability will be exploited.\n\nIn this blog, I will review the CVSS scoring system used worldwide to prioritize software\nvulnerabilities. I will also highlight best practices for using CVSS at its full potential, which,\nunfortunately, few companies leverage.\n\n\n-----\n\nI will then introduce EPSS, a new score that can predict the likelihood of exploitation of\nsoftware vulnerabilities, and describe how it should be used in conjunction with CVSS to\nprioritize vulnerability patching. I will also illustrate why EPSS is more dynamic than CVSS\nusing a popular vulnerability published last year that affected the library Log4j.\n\nFinally, I will describe how Fortinet supports the calculation of EPSS scores by providing the\ndaily telemetry data needed to establish the “Ground Truth” for the probabilistic training of the\nmodel.\n\n## Intro to CVSS\n\nThe Common Vulnerability Scoring System (CVSS) is an open framework for communicating\nthe characteristics and severity of software vulnerabilities. CVSS is owned and managed by\nFIRST.Org, Inc. (FIRST), a US-based non-profit organization. Its mission is to assist\ncomputer security incident response teams worldwide. The official CVSS documentation can\n[be found at https://www.first.org/cvss/.](https://www.first.org/cvss/)\n\nTwo common uses of CVSS are calculating a CVSS rating, or score, that attempts to provide\na standardized measurement of the severity of vulnerabilities discovered on one's systems\nand as a factor in the prioritization of vulnerability remediation activities. While this is an\ninvaluable tool for threat assessment, the only public entity that produces consistent and\nreliable CVSS scores is the NVD Database, which is widely adopted as a reference source\nfor many private and public companies worldwide.\n\nLet's take a deeper look at how the CVSS operates and how those scores are computed.\nMost security practitioners forget that CVSS consists of three metric groups: Base, Temporal,\nand Environmental. By examining these different metrics, you will better understand how\nCVSS works and its value to researchers and developers.\n\nFigure 1: CVSS Metric Groups\n\nThe Base group represents the intrinsic qualities of a vulnerability that are constant over time\nand across user environments. These are broken down into two main groups: Exploitability\nmetrics, such as how complex an attack must be to exploit a vulnerability and whether the\nuser has to participate in the attack, and Impact metrics that address issues like\nconfidentiality, integrity, and availability. The Temporal group reflects the characteristics of a\nvulnerability that change over time, such as the maturity of available exploitation code and\nthe effort required for remediation. And the Environmental group looks at the characteristics\nof a vulnerability that are unique to a user's environment.\n\nThe Base metrics produce a severity score ranging from 0 to 10, 10 being the most severe.\nThis score can then be modified by combining the Temporal and Environmental metrics. For\nexample, a vulnerability that might have a severe impact on a device may be downgraded\n\n\n-----\n\nbecause the exploit required to take advantage of this vulnerability is just too complex to be\nwidely distributed. However, while this method was the authors' original intent for the CVSS\nscores, most companies only use the Base Score.\n\nFigure 2: CVSS Metrics and Equations\n\nGenerally, the Base (always available from NVD) and Temporal metrics are specified by\nvulnerability bulletin analysts, security product vendors, or application vendors because they\ntypically possess the most accurate information about the characteristics of a vulnerability.\nEnd-user organizations specify environmental metrics because they can best assess the\npotential impact of a vulnerability within their own computing environment.\n\nThe scores are computed in sequence. The Base Score is used to calculate the Temporal\nScore, and the Temporal Score is used to calculate the Environmental Score (see Figure 2\n[and the calculator here: https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator).](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)\n\nTemporal metrics are very hard to track because it is a manual-intensive process and\nrequires analysts to be constantly aware of exploit availability and maturity, remediations\navailable, and the reliability of available information.\n\nScoring CVSS metrics also produces a vector string, a textual representation of the metric\nvalues used to score the vulnerability. This vector string is a specifically formatted text string\nthat contains each value assigned to each metric and should always be displayed with the\nvulnerability score.\n\nBecause of its complexity, especially the need for analysts to be constantly aware of a wide\nvariety of threat data, CVSS cannot be used at its full capacity by the majority of the\ncommunity. Instead, it needs to be combined with data-driven threat information, like EPSS,\nto better prioritize vulnerability remediation efforts.\n\n## Introduction to EPSS\n\n[The Exploit Prediction Scoring System (EPSS https://www.first.org/epss) is an open, data-](https://www.first.org/epss)\ndriven effort for estimating the likelihood (probability) that a software vulnerability will be\nexploited in the wild. Its goal is to assist network defenders in better prioritizing vulnerability\nremediation efforts in conjunction with an existing CVSS score.\n\nAs explained above, while other industry standards such as CVSS have been helpful in\ncapturing the innate characteristics of a vulnerability and providing measures of severity, they\nare often limited in their ability to predict the likelihood of a threat occurring. EPSS fills that\ngap because it uses current threat information from the CVE database\n[(https://www.cve.org/ResourcesSupport/FAQs ) combined with real-world exploit data for its](https://www.cve.org/ResourcesSupport/FAQs)\npredictions. EPSS then produces a probability score of between 0 and 1 (0 and 100%). The\nhigher the score, the greater the probability that a vulnerability will be exploited in the next 30\ndays\n\n\n-----\n\nEPSS currently collects information from multiple data sources, usually daily, to score\nthreats. These sources include, but are not limited to, the following:\n\nMITRE’s [CVE List - Only CVEs in the “published” state are scored](https://www.cve.org/Downloads)\nText-based “Tags” derived from the CVE description and other sources talking about\nthe vulnerability\nCount of how many days a CVE has been published\nCount of how many references are listed in the CVE\nPublished Exploit code in any of: Metasploit, ExploitDB, and/or Github\nSecurity Scanners: Jaeles, Intrigue, Nuclei, sn1per\n[CVSS v3 vectors in the base score (not the score or any subscores), as published in](https://www.first.org/cvss/)\n[the National Vulnerability Database (NVD)](https://nvd.nist.gov/vuln)\nCPE (vendor) information, as published in NVD\nGround Truth: Daily observations of exploitation-in-the-wild activity from AlienVault and\n**Fortinet.**\n\nThe process that generates this score is based on machine learning. A simplified\nrepresentation is found in the image below:\n\nFigure 3: Representation of score generation through machine learning\n\nAs can be seen, any EPSS deployment must first go through a training phase, where it is\ngiven historical vulnerability data and daily exploitation activity to develop and refine its\npredictive model. Once established, the predictive model can then be used in combination\nwith vulnerability metadata on a daily basis to predict future exploitation activity.\n\nThe resulting EPSS score can be used for such things as prioritizing which software to patch\nbased on a threshold, with the advantage of requiring organizations to patch fewer\nvulnerabilities compared to using a patching strategy based solely on a CVSS ranking. There\nis too much math involved to describe the process here, but you can go to this site to learn\n[more (https://www.first.org/epss/model). But the takeaway is that organizations that properly](https://www.first.org/epss/model)\ndeploy and train EPSS will need to patch fewer vulnerabilities than they would have using\nthe classic CVSS strategy while maintaining the same level of protection.\n\nYou are warned, though. EPSS should never be treated as a risk score. Other factors, such\nas how accessible vulnerable assets are to attackers, the type of weakness a vulnerability\npresents, the asset's purpose and value, etc., are all factors to consider when prioritizing\nwhich vulnerabilities should be addressed. Fortunately, those factors are typically contained\nin the string vector of the CVSS score.\n\n## Practical Example: Log4j\n\n\n-----\n\nI will now demonstrate how EPSS tracked the probability of exploitation for the infamous\nLog4j vulnerability that took the Internet by surprise this last December. The following\nannotated chart shows how the EPSS score evolved over time based on specific events that\naffected the dependent variables of the model.\n\nFigure 4: Log4Shell through the eyes of EPSS\n\nThe official CVE, CVE-2021-44228 was published on December 10th, 2021. The NVD entry\n[is available here (https://nvd.nist.gov/vuln/detail/CVE-2021-44228).](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)\n\nFigure 5: NVD Analysis\n\nSecurity analysts provided the initial CVSS scores for v2 and v3 on the 13 of December,th\nwith a Base score of 10.0 (critical). That has not changed as of the writing of this blog.\n\nFigure 6: NVD Analysis\n\n\nEPSS published its daily scores on the morning of December 11 . Even before the CVSSth\nscore was assigned on the 13, it predicted the likelihood of exploitation at 0.355. In terms ofth\nall other vulnerabilities scored on that day, Log4j scored higher than 96.8% of all CVEs.\n\nYou can see how the EPSS score changed over time based on variations of the 1,164\nvariables of the model. The last change was when Metasploit added the module\n“exploit/multi/http/log4shell_header_injection”. That pushed its score to 0.944, the highest it\nreceived.\n\nOnce again, it is important to note that the CVSS base score has not changed, so\norganizations that relied solely on that score would not have detected this spike in risk. And\nwhile, technically, the temporal CVSS score should have changed to reflect this difference,\nthere are no public tracking services for the temporal component.\n\nThe chart below shows our Fortinet telemetry following the release of the CVE-2021-44228\non 9 December 2021. We began receiving telemetry on 10 December 2021 when our IPS\nengines were set to passively monitor the CVE.\n\nThe spike in detecting this signature on 13 December caused our IPS engine to be upgraded\nto blocking action, ensuring that our customers were automatically protected. You can see\nthe very fast growth spike, reaching a peak of 31 million events on 15 December 2021,\nfollowed by a second wave and a sudden decrease from 29 December 2021.\n\nFigure 7: Log4j events\n\nYou can also observe that the vulnerability spread fast across the globe, reaching a peak of\n207 of the 248 countries listed in our database (this list contains official countries and small\nindependent areas, etc., as well).\n\n\n-----\n\nThere are a few important observations about this chart: The first is that it represents a\nvolumetric count of all the FortiGate firewalls in our network reporting this threat telemetry.\nAnd second, we can’t confirm whether these FortiGates were fronting an actual application\npowered by Log4j. This means that we can’t be sure that of those counts, how many could\nhave been successful attempts of exploitation. However, we can clearly see the massive\njump on 14 December, followed by a small trail of activity.\n\nWe can compare the EPSS scores and the volume of detections together by normalizing the\nmagnitude, showing that the EPSS score started at 0.355 on 10 December, indicating that\nthere was a 35% chance in the next 30 days of exploitation of the vulnerability, and looking at\nthat time frame we can see that the subsequent activity ranged from 40,000 events to 31\nmillion events.\n\nFigure 8: EPSS scores and detection volume\n\nLess intuitive is that when EPSS finally reached its maximum score of 94%, the exploitation\nvolume had already subsided. However, this is perfectly fine because the EPSS score does\nnot attempt to predict the volume of events but rather the binary decision of whether or not it\nwill be exploited.\n\nThe reader may also notice the sudden drop in volume on the last day of December. This is\nquite common. We often see this when attackers see diminishing returns on a campaign and\nswitch to exploit other vulnerabilities. In fact, we can see this using another comparative plot,\nshown below. As the orange RCE (remote code execution) was decreasing in popularity,\nanother one in green—which was a DOS vulnerability (denial of service)—initiated\nconsiderable activity, which then faded out around the 6th of January 2022.\n\nFigure 9: All Log4j Vulnerabilties\n\nIn conclusion, organizations should consider EPSS as \"pre-threat intel.\" Of course, if they\nhave intel that something is being exploited (via their own telemetry sensors or OSINT), then\nthey should use that as an indication of activity in the wild. But for those without any\nevidence of exploitation or that lack threat intel, then EPSS is a great fit.\n\n## How to use both CVSS and EPSS for prioritization?\n\nAny given company should have a database of vulnerabilities reported daily by their security\nvendors. For each vulnerability discovered, they can extract the CVE score (the base score,\nas mentioned before, is available for free from NVD, and paid vendors provide the\ntemporal/environmental scores) and the EPSS score (via a simple API). They can then be\nplotted with a scatter plot layout, as shown below.\n\nFigure 10: EPSS score compared to CVSS Base Score (NVD)\n\n\n-----\n\nThe X-axis represents the CVSS version 3.1 score (1 to 10), and the Y-axis represents the\nEPSS score (0 to 1.0). The color of the dots indicates how many vulnerabilities are\nconcentrated in the same spot, so darker colors indicate more, and lighter colors indicate\nless.\n\nVulnerabilities in the bottom left represent those that have both a lower probability of being\nexploited and would incur a lower severity impact to the information system. They can\ntherefore be deprioritized.\n\nVulnerabilities in the upper right quadrant, on the other hand, are the most critical kinds of\nvulnerabilities as they are both more likely to be exploited and could fully compromise the\ninformation system. They should therefore be patched first.\n\nThe best strategy to remediate those vulnerabilities is to rank them from the top right to the\nbottom left, following the blue line. The defender can now spend fewer resources while\npatching more vulnerabilities that are much more likely to be exploited.\n\n## Summary\n\nThis quick table shows the key feature points of CVSS vs. EPSS.\n\n**CVSS** **EPSS**\n\n**Score Range** 0 to 10 0 to 100%\n\n\n**Score**\n**Meaning**\n\n\nSeverity of a vulnerability Probability of a vulnerability to  be\nexploited in the next 30 days\n\n\n**Maintainer** FIRST ORG FIRST ORG\n\n\n**Dependencies** Security analysts to compute\nbase, temporal, and\nenvironmental score\n\n**Update** Base scores are provided by\nNVD when a new vulnerability\nis published (plus a few\nadjustments for errata)\n\n\nA variety of sources, including  the\nCVSS base score from NVD\n\nScores are updated daily via an\nML-based prediction pipeline\n\n\n-----\n\n**Human**\n**Annotation**\n**Required**\n\n\nYes, by CNA/NVD Indirectly, because the machine\nlearning extracts factors from a\nvariety of database sources\nmaintained by the community\n\n\n## How does Fortinet contribute to EPSS?\n\nThe ground truth of EPSS is derived from daily observations of exploitation-in-the-wild\nactivity provided by AlienVault and Fortinet.\n\nFor each vulnerability, FortiGuard Labs provides the daily count of detections (anonymized)\nfrom our network of FortiGates distributed around the world. This is critical information for\nbuilding an accurate machine learning predictor for the exploitability score.\n\nFortiGuard Labs also contributes to the codebase of the EPSS API in the official FIRST\nrepository.\n\nFortiGuard Labs is Driving the Future of CybersecurityFortiGuard Labs has been active in\nthe threat intelligence industry since its founding. We contributed to developing the\nSTIX/TAXII protocols with MITRE and OASIS, starting back in 2012. In 2014, we co-founded\nthe [Cyber Threat Alliance, which focuses on threat intelligence and information sharing. In](https://www.cyberthreatalliance.org/)\n2018, we began to work with the World Economic Forum’s [Centre for Cybersecurity on a](https://www.weforum.org/platforms/the-centre-for-cybersecurity)\n[series of threat intelligence projects, including the Cybercrime ATLAS. And for the last couple](https://www.fortinet.com/blog/industry-trends/combating-cybercrime-collaboration?utm_source=blog&utm_medium=blog&utm_campaign=ATLAS)\nof years, FortiGuard Labs has been working with MITRE on a variety of projects to increase\nthe awareness and capabilities of defenders, particularly as a leading contributor to MITRE\n[Engenuity Center for Threat-Informed Defense.](https://ctid.mitre-engenuity.org/)\n\nFortiGuard Labs has also been working with the Center for Threat-Informed Defense and its\nmembers on a project called ATT&CK Sightings Ecosystem, which includes the “2021\nATT&CK Sightings Report.” As quoted in the report, this effort “created a picture of common\nadversary behavior, including which techniques adversaries use, how their use changes over\ntime, and how adversaries sequence techniques. Defenders can use this information to\ncreate a threat-informed defense against what they are most likely to see, not just the latest\ncyber threat headlines.”\n\nFortinet also provided data sets to help train the model for the Exploit Prediction Scoring\nSystem (EPSS) project and FortiGuard Labs has been an active participant. EPSS is an\nopen model for predicting the likelihood that a vulnerability will be exploited in the wild.\nCoupled with the TTP (tactics, techniques, and procedures) data we are providing through\nthe Threat intelligence Insider, we’re building the future of cybersecurity protections and\ndecision making.\n\n**References:**\n\n\n-----\n\n[https://www.first.org/epss/model](https://www.first.org/epss/model)\n\n[https://www.first.org/epss/articles/log4shell](https://www.first.org/epss/articles/log4shell)\n\n[https://www.first.org/epss/articles/prob_percentile_bins](https://www.first.org/epss/articles/prob_percentile_bins)\n\n[https://www.first.org/epss/user-guide](https://www.first.org/epss/user-guide)\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[and the FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-29 - Using EPSS to Predict Threats and Secure Your Network.pdf"
    ],
    "report_names": [
        "2022-04-29 - Using EPSS to Predict Threats and Secure Your Network.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535886,
    "ts_updated_at": 1743041139,
    "ts_creation_date": 1653759940,
    "ts_modification_date": 1653759940,
    "files": {
        "pdf": "https://archive.orkl.eu/0305a8f52b29fbd8794add8d012daec73954830d.pdf",
        "text": "https://archive.orkl.eu/0305a8f52b29fbd8794add8d012daec73954830d.txt",
        "img": "https://archive.orkl.eu/0305a8f52b29fbd8794add8d012daec73954830d.jpg"
    }
}