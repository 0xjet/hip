{
    "id": "0f07ddee-41d4-4597-80f4-7b595fbaa6c1",
    "created_at": "2023-01-12T15:01:43.987632Z",
    "updated_at": "2025-03-27T02:17:05.73073Z",
    "deleted_at": null,
    "sha1_hash": "9dde2e74ac98e8f34156184878686d5f8a87bbd8",
    "title": "2016-11-17 - It’s Parliamentary - KeyBoy and the targeting of the Tibetan Community",
    "authors": "",
    "file_creation_date": "2022-05-28T02:47:47Z",
    "file_modification_date": "2022-05-28T02:47:47Z",
    "file_size": 1072186,
    "plain_text": "# It’s Parliamentary KeyBoy and the targeting of the Tibetan Community\n\n**citizenlab.ca/2016/11/parliament-keyboy/**\n\nNovember 17, 2016\n\n[Research](https://citizenlab.ca/category/research/)\n\n\n-----\n\n[Targeted Threats](https://citizenlab.ca/category/research/targeted-threats/)\nBy [Adam Hulcoop,](https://citizenlab.ca/author/adam-hulcoop/) [Matt Brooks,](https://citizenlab.ca/author/mattbrooks/) [Etienne Maynier,](https://citizenlab.ca/author/etiennemaynier/) [John Scott-Railton, and](https://citizenlab.ca/author/jsrailton/) [Masashi Crete-Nishihata](https://citizenlab.ca/author/masashi/)\nNovember 17, 2016\n[Download this report](https://tspace.library.utoronto.ca/bitstream/1807/96989/1/Report%2383--keyboy.pdf)\n\n## Key Findings\n\nIn this report we track a malware operation targeting members of the Tibetan Parliament over\nAugust and October 2016.\nThe operation uses known and patched exploits to deliver a custom backdoor known as KeyBoy.\nWe analyze multiple versions of KeyBoy revealing a development cycle focused on avoiding basic\nantivirus detection.\nThis operation is another example of a threat actor using “just enough” technical sophistication to\nexploit a target.\n\n## Introduction\n\nThe Tibetan community has been targeted for over a decade by espionage operations that use malware\nto infiltrate communications and gather information. They are often targeted simultaneously with other\n[ethnic minorities and religious groups in China. Examples as early as 2008 document malware](https://isc.sans.edu/diary/Overview+of+cyber+attacks+against+Tibetan+communities/4177)\noperations against Tibetan non-governmental organizations (NGOs) that also targeted Falun Gong and\nUyghur groups. More recently in 2016, Arbor Networks reported on connected malware operations\n[continuing to target these same groups, which the Communist Party of China perceives as a threat to its](https://www.arbornetworks.com/blog/asert/wp-content/uploads/2016/04/ASERT-Threat-Intelligence-Report-2016-03-The-Four-Element-Sword-Engagement.pdf)\npower.\n\nThese types of operations have multiple components, each with their own associated costs to the\noperator. There is the exploit code and malware used to gain access to systems, the infrastructure that\nprovides command and control to the malware operator, and the human elements – developers who\ncreate the malware, operators who deploy it, and analysts who extract value from the stolen information.\n\nWe anticipate that operators will attempt to balance the amount of information they expect to gather with\nthe operational costs and risks of deploying different strategies and technologies. For example, in\ndeploying a particular malware implant against a target the operator will balance the likelihood and cost\n\n\n-----\n\nof discovery with the perceived value of extracting information from that target. If a toolkit is exposed\ninadvertently, the target may increase defenses and the operator will have to spend more time and\nresources on development.\n\nCivil society groups, due to their generally limited technical capacity and lack of security expertise and\ncountermeasures, shift the risk/reward ratio in ways favourable to the malware operator. For example,\nwe have observed frequent reuse of older (patched) exploits in malware operations against the Tibetan\ncommunity. Up-to-date operating systems and software would block these threats, but the operators\nhave probably discovered through experience that the their targets have unpatched systems and a\ngeneral lack of security controls beyond antivirus programs. The continued use of old exploits is a cost\nreduction strategy: since they still work, there is little need to use more expensive exploits.\n\nMoreover, many of the malware defenses used by the Tibetan diaspora involve individuals recognizing\nsigns of a malicious email, such as exhortations to open attachments. This kind of behavioral strategy\n[pushes the operators to change their social engineering tactics, but does not provide pressure to](https://citizenlab.ca/2016/03/shifting-tactics/)\nradically change their toolkits. This situation is different from a technical-indicator based institutional\nsecurity environment. In practice, minimal code changes sufficient to bypass signature-based security\ncontrols such as antivirus may be all that are necessary.\n\nThis report analyzes an operation targeting members of the Tibetan Parliament. The actors used a new\n[version of “KeyBoy,” a custom backdoor first disclosed by researchers at Rapid7 in June 2013. Their](https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india)\nwork outlined the capabilities of the backdoor, and exposed the protocols and algorithms used to hide\nthe network communication and configuration data.\n\nWe observed operations in August and October 2016, shortly after an order in June to demolish the\n[Larung Gar Buddhist Academy and days before organized protests on October 19 around the same](https://en.wikipedia.org/wiki/Larung_Gar_Buddhist_Academy)\nissue. These operations involved highly targeted email lures with repurposed content and attachments\nthat contained an updated version of KeyBoy. We assess that KeyBoy is the product of a development\ncycle that is iterated only as much as necessary to ensure the survival of the implant against antivirus\ndetection and basic security controls.\n\nThis report is divided into two parts:\n\n**Part 1: The Parliamentarian Operation Analyzes an operation targeting the members of the Tibetan**\nParliament by repurposing legitimate content, and documents implanted with Keyboy.\n\n**Part 2: KeyBoy – Tracking Evolution Examines the KeyBoy development cycle revealing a focus on**\navoiding basic antivirus detection.\n\nTo assist other researchers, we include appendices and indicators of compromise that detail the KeyBoy\nsamples we analyzed and provide an in-depth analysis of some features of the most recent implant.\n\n## Part 1: The Parliamentarian Operation\n\nIn August and October 2016 we observed a malware operation targeting members of the Tibetan\nParliament (the highest legislative organ of the Tibetan government in exile, formally known as Central\nTibetan Administration). We collected two emails sent to Parliamentarians that rapidly repurposed\nlegitimate content in an attempt to entice recipients to open malicious documents. The first attempt\n[leveraged an old vulnerability in the parsing of Rich-text-format ( .rtf ) files (CVE-2012-0158). The](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-0158)\n\n\n-----\n\nsecond attempt used a newer, but also patched, `.rtf vulnerability (CVE-2015-1641). Both attempts`\nused versions of KeyBoy and shared the same command and control infrastructure as well as other\nconfiguration details.\n\n## Attempt 1\n\nOn August 25, 2016, members of the Tibetan Parliament received an email with information on an\nupcoming conference relevant to the Tibetan community. This email had the same subject and\nattachment as a legitimate message sent to the same recipients just 15 hours prior, but in this case the\nattachment was crafted to exploit a frequently targeted vulnerability in Microsoft Office. The\naccompanying malware was a backdoor implant designed to surveil the computers of the\nParliamentarians. This malicious attachment used the original, legitimate filename as a decoy (see:\n**Figure 1).**\n\nFigure 1: Email lure containing malicious document. Note the use of letters ‘r n’ in an attempt to appear\nas ‘m’ in the sender address.\nThis level of targeting and re-use of a legitimate document sent only hours before shows that the actors\nbehind the operation are closely watching the Tibetan community, and may have already compromised\nthe communications of one or more of the Parliamentarians.\n\n**Document name:** `theme of the conference.doc`\n\n**MD5:** `8307e444cad98b1b59568ad2eba5f201`\n\nOpening the attachment (an apparently blank document) in Microsoft Word would result in the infection\nof the target system with the KeyBoy implant.\n\n### The Infection Chain\n\nThe email attachment is a `.rtf document containing a dropper, delivered using an exploit designed to`\n[leverage CVE-2012-0158, a vulnerability in the way that Microsoft Word handles](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158) `.rtf files. Over the`\npast four years, this vulnerability has been consistently used in malware campaigns against the Tibetan\ncommunity despite having been patched since April 2012.\n\nIf the exploit is successful, the following infection chain (see: Figure 2) is observed on the system.\n\n\n-----\n\nFigure 2: Process chain after exploit is successful\nThe files in this infection chain are outlined below. The exploit launches an executable ‘dropper’\ncomponent which is responsible for placing the malware payload and its configuration file on disk, and\nfinally for launching the main malware code.\n\nNote that the dropper and the final (DLL) payload were compiled within seconds of each other.\n\n**Name:** `dw20.exe`\n**Size:** `256512 bytes`\n**Compile Time:** `09 May 2016 08:41:26 UTC`\n**MD5:** `0b4d45db323f68b465ae052d3a872068`\n**SHA256:** `5f24a5ee9ecfd4a8e5f967ffcf24580a83942cd7b09d310b9525962ed2614a49`\n**Purpose: dropper binary, used to install and execute the main implant**\n\n**Name:** `wab32res.exe`\n**Size:** `46080 bytes`\n**Compile Time:** `13 April 2008 18:30:52 UTC`\n**MD5:** `8f08609e4e0b3d26814b3073a42df415`\n**SHA256:** `58105e9772f6befbc319c147a97faded4fbacf839947b34fe3695ae72771da5d`\n**Purpose: legitimate Microsoft Windows Address Book executable, used to load final payload**\n\n**Name:** `wab32res.dll`\n**Size:** `138240 bytes`\n**Compile Time:** `09 May 2016 08:41:05 UTC`\n**MD5:** `495adb1b9777002ecfe22aaf52fcee93`\n**SHA256:** `9a55577d357922711ab0821bf5379289293c8517ae1d94d48c389f306af57a04`\n**Purpose: malware payload, launched by wab32res.exe via DLL search order hijacking**\n\nNext, the dropper places a renamed copy of the legitimate Windows Address Book executable, along\nwith the malware binary, `wab32res.dll, in the Local Application Data directory. Notably, the dropper`\nmodifies the timestamps of the configuration file and the payload to match those of the\n```\n\\Microsoft\\SystemCertificates\\My\\ directory within the user’s Local Application Data directory.\n\n```\nOnce these files are written to disk, the dropper starts the Windows Address Book executable which\nloads and executes the malicious `wab32res.dll file via` [DLL search-order hijacking.](https://www.fireeye.com/blog/threat-research/2010/07/malware-persistence-windows-registry.html)\n\n## Attempt 2\n\nOn October 11, 2016, the Tibetan Parliamentarians received an email with content repurposed from a\nTibetan activism campaign protesting the demolition of a Buddhist monastery in Tibet. The email was\nsent from the same email address as the previous attempt ( tibetanparliarnent[@]yahoo.com ) and\n\n\n-----\n\n[appears to copy content from the Facebook page of a Tibetan NGO promoting the campaign. The](https://www.facebook.com/events/190950044675347/)\nmessage urges recipients to open an attached `.rtf file with further details on the campaign (see:`\n**Figure 3).**\n\nFigure 3: Email lure used in second attempt\n**Document name:** `urgent action larung gar buddhist academy.rtf`\n\n**MD5:** `913b82ff8f090670fc6387e3a7bea12d`\n\nOpening the attachment (an apparently blank document) in Microsoft Word would, similar to the first\nattempt, result in the infection of the target system with the KeyBoy implant.\n\n### The Infection Chain\n\nThe `.rtf document attached to the malicious email was designed to exploit a more recent`\n[vulnerability: CVE-2015-1641. If successful, this exploit launches a newer version of the same malware](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1641)\nused in the August attempt outlined above, using a similar infection chain.\n\n**Name: n/a**\n\n**Size:** `262144 bytes`\n\n**Compile Time:** `29 September 2016 00:46:11 UTC`\n\n**MD5:** `23d284245e53ae4fe05c517d807ffccf`\n\n**SHA256:** `542c85fda8df8510c1b66a122e459aac8c0919f1fe9fa2c43fd87899cffa05bf`\n\n**Purpose:dropper binary, used to install and execute the main implant**\n\n**Name:** `wab32res.exe`\n\n**Size:** `46080 bytes`\n\n**Compile Time:** `13 April 2008 18:30:52 UTC`\n\n**MD5:** `8f08609e4e0b3d26814b3073a42df415`\n\n**SHA256:** `58105e9772f6befbc319c147a97faded4fbacf839947b34fe3695ae72771da5d`\n\n**Purpose:legitimate Microsoft Windows Address Book executable, used to load final payload**\n\n**Name:** `wab32res.dll`\n\n**Size:** `143872 bytes`\n\n**Compile Time:** `29 September 2016 00:21:34 UTC`\n\n\n-----\n\n**MD5:** `087bffa8a570079948310dc9731c5709`\n**SHA256:** `5da2f14c382d7cac8dfa6c86e528a646a81f0b40cfee9611c8cfb4b5d589aa88`\n**Purpose:malware payload, launched by wab32res.exe via DLL search order hijacking**\n\nAs with the first attempt, the resulting dropper installs the malware payload into the `Local`\n```\nApplication Data directory as wab32res.dll and subsequently launches it using the same method\n\n```\nof DLL search-order hijacking against the legitimate Windows Address Book executable.\n\n## A Note on Vulnerabilities\n\nThe two `.rtf vulnerabilities targeted in these exploitation attempts, CVE-2012-0158 and` CVE-20151641, are among a set of four `.rtf vulnerabilities discussed in recent reporting from researchers at`\nArbor Networks.\n\nThe researchers describe the presumed existence of an exploit document ‘builder’ designed to\nselectively weaponize `.rtf files using four older, patched, vulnerabilities: CVE-2012-0158,` CVE-2012[1856, CVE-2015-1641, and](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1641) [CVE-2015-1770.](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2015-1770)\n\nThe Arbor report describes the ongoing use of these four vulnerabilities in a series of espionage\ncampaigns against not only Tibetan groups, but also others related to Hong Kong, Taiwan, and Uyghur\ninterests. While we have not connected the campaign targeting the Tibetan Parliamentarians to the\ncampaigns described by Arbor, the continual pairing of these older `.rtf vulnerabilities with malware`\noperations against the Tibetan community is noteworthy.\n\n## The Malware\n\nThe malware samples deployed in both of these operations are updated versions of the KeyBoy\n[backdoor first discussed in 2013 by Rapid7. KeyBoy provides basic backdoor functionality, allowing the](https://community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-targeted-attacks-against-vietnam-and-india)\noperators to select from various capabilities used to surveil and steal information from the victim\nmachine.\n\nKeyBoy functionality:\n\nGather system information, including details of the operating system, processor, disk, memory,\ndisplay, and uptime (see: Figure 4)\nUpload files to the victim computer\nDownload files from the victim computer\nBrowse the file system, including gathering details about attached drives\nExecute commands and applications\nLaunch interactive shell\n\n\n-----\n\nFigure 4: Format strings illustrating some of the system information obtained by KeyBoy from an\ninfected machine\nThese updated versions of KeyBoy make use of an encoded configuration file to store their command\nand control (C2) information along with other required settings. In both cases, the dropper wrote this\nconfiguration file in the user’s Local Application Data directory as `win32res.dat . After analyzing these`\nmalware samples, we were able to decode the following configuration parameters, presented in Table 1\n\n\n**Line** **Description** **First sample**\n\n\n**Second**\n**sample**\n\n\nLine\n1\n\nLine\n2\n\nLine\n3\n\nLine\n4\n\nLine\n5\n\nLine\n6\n\nLine\n7\n\nLine\n8\n\nLine\n9\n\n\nIdentity code, used to ensure config was correctly\ndecoded\n\n\n9876543210 9876543210\n\n\nC2 Server #1 (hostname/ip) 45.125.12[.]147 45.125.12[.]147\n\nC2 Server #2 (hostname/ip) 103.40.102[.]233 45.125.12[.]147\n\nC2 Server #3 (hostname/ip) 45.125.12[.]147 45.125.12[.]147\n\nPort used with C2 Server #1 443 443\n\nPort used with C2 Server #2 443 443\n\nPort used with C2 Server #3 443 443\n\nPassword for operator login tibetwoman tibetwoman\n\nCampaign ID, transmitted to C2 during login NNNN NNNN\n\n\n-----\n\n**Table 1: Decoded configuration parameters from both KeyBoy samples observed in the Parliamentarian**\noperation\n\nA full description of the new algorithm used by KeyBoy to decode its configuration file is presented in\nAppendix A.\n\nOnce the KeyBoy DLL has been executed, it validates that a particular string value (likely identifying the\nKeyBoy version) is set in the Windows Registry.\n\n\n**Second**\n**sample**\n\n\n**Key**\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\nSettings\\Zonemap\\Ver\n\n\n**First**\n**sample**\n\n\n20160509 agewkassif\n\n\nAdditionally, these versions of KeyBoy ensure persistence by setting the `wab32res.exe file to be`\nloaded upon login via exploiting the Winlogon Shell key, which in turn loads the malicious\n```\nwab32res.dll file by the aforementioned DLL search-order hijacking method.\n\n```\n**Key** **Value**\n\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon\\Shell\n\n\nexplorer.exe, “C:\\users\\\n<user>\\AppData\\Local\\wab32res.exe”\n\n\nThe backdoor then sends a login beacon to the C2 server which, once decoded, looks like:\n```\n*a*\nUSER-PC\n192.168.100.101\nNNNN\n2016/09/13 16:11:56\n20160509\n\n```\nThese values are described as follows in Table 2:\n\n**Value from Example** **Description**\n\n*a* Data header code for initial check-in beacon\n\nUSER-PC %computername% of victim PC\n\n192.168.100.101 IP address of victim PC\n\nNNNN Campaign ID from the KeyBoy configuration file\n\n2016/09/13 16:11:56 Timestamp of local PC\n\n20160509 Internal version identifier\n\n**Table 2: Descriptions of the login beacon values**\n\n\n-----\n\nThis login data, as well as all other communication between backdoor and command and control server,\nis transmitted using an encoding mechanism based on principles from modular arithmetic. We describe\n[this network communication encoding in detail in this supplementary document.](https://citizenlab.ca/wp-content/uploads/2016/11/keyboy-network-comm.pdf)\n\nAs can be seen in the login event example above, when sending data to the C2, the KeyBoy implant\nuses a series of header ‘codes’ to specify the type of data which is being transmitted, described in Table\n**3:**\n\n**Header code** **Data being transmitted**\n\n*l* Heartbeat / Keepalive\n\n*a* Initial check-in beacon\n\n*s* System information (drive info, system specifications, interface info)\n\n*d* Data from remote commands and shell\n\n*f* Data relating to interactions via File Manager\n\n*g* Ready to initiate file download\n\n*h* Ready to initiate file upload or update\n\n**Table 3: KeyBoy header codes for sending data to the C2 server**\n\n## The Infrastructure\n\nThe command and control (C2) servers used in the Tibetan Parliament operation were extracted from\nthe KeyBoy configuration files:\n\n\nC2 Host: 45.125.12[.]147 Desc: Royal Network\nTechnology Co\n\nNo relevant data or passive DNS\ninformation was available\n\nC2 Host: 103.40.102[.]233 Desc: Dragon Network\nInt’l Co. Ltd\n\n\nCity: Hong\nKong\n\n\nCity:\nGuangzhou\n\n\nCountry:\nChina\n\n\nCountry: Hong\nKong\n\n\n-----\n\nDomain: tibetvoices[.]com\n\nHost First\nSeen:\n\n127.0.0.1 201609-29\n\n103.40.102[.]233 201607-15\n\n112.10.117[.]47 201605-25\n\n\nLast Seen:\n\nCurrent as of\npublication\n\n2016-09-28\n\n2016-05-26\n\n\nWe uncovered very little information about the command and control (C2) infrastructure used in this\noperation. The configuration files referenced hard-coded IP addresses for the C2 servers, as opposed to\nusing domain names as was seen in prior KeyBoy campaigns.\n\nPassive DNS analysis revealed one domain, `tibetvoices[.]com, which was briefly pointed to one of`\nthe C2 server IP addresses found in the KeyBoy configuration file used in the first attempt against the\nParliamentarians. This domain was created in May 2016 (around the time that the KeyBoy sample used\nin the first attempt was compiled) and was pointed to IP address `103.40.102[.]233 from July 15 to`\nSeptember 28. Subsequently, this domain was pointed to `127.0.0.1, effectively taking it offline.`\n\n[This behavioural tactic was previously mentioned in relation to KeyBoy in a 2013 blog post by Cisco.](http://blogs.cisco.com/security/scope-of-keyboy-targeted-malware-attacks)\nCisco hypothesized that the actors behind KeyBoy may have been nullifying the DNS records when an\nactive campaign was not underway, in an attempt to stay “below the radar”. This tactic allows the\nmalware operator to ensure that no command and control traffic will be sent out from the infected\nsystem, thus preventing detection via network monitoring.\n\nThis tactic, however plausible, would not apply to the KeyBoy samples we analyzed, as the C2\nconfiguration relied upon hard coded IP addresses and did not directly reference the\n```\ntibetvoices[.]com domain. It is possible that a different campaign was launched which used this\n\n```\ndomain, but we were unable to find any evidence of such a campaign.\n\nOur analysis provides a cursory look at some of the capabilities and implementation details of the\nKeyBoy backdoor as used during a malware operation targeting Tibetan Parliamentarians. These\nversions of KeyBoy differed from the one first described by Rapid7 in several ways, many of which will\nbe described in the sections to follow.\n\nDuring our research into this operation we were able to uncover two additional samples of KeyBoy\nwhich were likely used in previous malware campaigns. These samples were contained in exploit\ndocuments containing distinct lure content, one having a Tibetan nexus, the other an Indian nexus.\n\nIn Part 2 we present a brief overview of the observable evolution of KeyBoy based upon all of the\nsamples we obtained.\n\n## Part 2: KeyBoy – Tracking Evolution\n\n\n-----\n\nPeriodic updates are common in the world of software development. Features are added and removed,\nbugs are patched, and code is written to execute more efficiently. The same holds true for malicious\nsoftware, but with the additional requirement that the development cycle must always satisfy the\noperational need for covertness. To be effective, malicious software designed for surveillance must\nremain undetected. Malware developers are in a constant struggle to avoid the security controls that\nprotect target systems.\n\nWe believe the 2013, 2015, and 2016 KeyBoy samples provide evidence of a development effort\nfocused on changing components that would be used by researchers to develop detection signatures.\nThis section outlines how we came to this conclusion.\n\nIn building our KeyBoy chronology, we collected several samples and examined three data points from\neach:\n\nThe compile time of the KeyBoy binary\nA string observed in the KeyBoy binary we refer to as the ‘version identifier’\nElapsed time between compile time and the time of first exposure\n\nAnalysis of these data points gave us a moderate to high level of confidence that the binary compile\ntimes provided a reliable estimate of the true development timeline.\n\n## An Evolving Implant\n\nIn an effort to understand its evolution, we compared the code of several versions of KeyBoy as\nidentified by their ‘version identifier’ strings, shown in Table 4:\n\n**Version Identifier** **Notes**\n\nProxy 20130401 Reported by Rapid7 in relation to an Indian nexus\n\nProxy 20130401 Reported by Rapid7 in relation to a Vietnamese nexus\n\nP_20150313 Discovered via hunting; carried Indian lure content\n\n20151108 Discovered via hunting; carried Tibetan lure content\n\n20160509 First sample of the Parliamentarian operation from August 2016\n\n20160509 An alternate sample, using different configuration data\n\nagewkassif Second sample of the Parliamentarian operation from October 2016\n\n**Table 4: Version identifier strings analyzed**\n\nThe ‘version identifier’ is a particular string that appeared in every KeyBoy sample we studied. It is\ntransmitted to the command and control server as part of the login data packet, and, in recent versions,\nthis identifier is written to the Windows registry in a key named ‘Ver’. With the exception of the newest\n(chronologically speaking) KeyBoy version we discovered, this identifier always contained a date-like\ncomponent which matched the compile date of the KeyBoy binary in every case. In the newest sample,\nthe developers replaced this date-like string with a seemingly random set of letters.\n\n\n-----\n\nA timeline depicting these KeyBoy versions, along with some important characteristics, is shown in\nFigure 5.\n\nFigure 5: The timeline of KeyBoy’s evolution\n\n## Noteworthy Modifications\n\nThis section describes some of the most significant changes observed across the KeyBoy versions.\nEach of these components would have been an ideal target for signature-based identification, using\neither static string or network packet-based detection mechanisms.\n\n### Header Code Evolution\n\nOf the changes we identified one stands out as being an immediate target for an effective antivirus\nsignature – the evolution of header codes used during communication between the implant and\ncommand and control server. As shown in Table 5, these codes changed substantially after the 2013\nKeyBoy samples were examined and publically documented by Rapid7. It is reasonable to hypothesize\nthat this significant change in format was in response to the publication of Rapid7’s research.\n\n**2013** **Early 2015** **Late 2015** **2016**\n\n$login$ #l# *a* *l*\n\n$sysinfo$ #s# *s* *a*\n\n$shell$ #e# *d* *s*\n\n$fileManager$ #f# *f* *d*\n\n$fileDownload$ #D# *g* *f*\n\n$fileUpload$ #U# *h* *g*\n\n\n-----\n\n**2013** **Early 2015** **Late 2015** **2016**\n\n*h*\n\n**Table 5: Header codes used by KeyBoy during C2 communication**\n\nIn addition, modifying these codes produced a downstream change in the appearance of the network\ncommunication traffic produced by an active KeyBoy infection. This change would likely have rendered\nexisting network based signatures ineffective.\n\n### Configuration File Changes\n\nAnother major change we first observed in version `P_20150313 is the complete redesign of the`\nalgorithm used to encode the KeyBoy configuration file. In the 2013 samples described by Rapid7, this\nconfiguration file was encoded using a simplified static-key based algorithm. This newer encoding\nalgorithm is significantly more involved, removing the use of a static encryption key in favour of a\ndynamically constructed lookup table. We provide a detailed explanation of this new algorithm in\nAppendix A.\n\n### Persistence Changes\n\nThe method used by the implant for maintaining persistence was also changed several times. The\nearlier versions used a Windows service to ensure the malware stayed persistent, moving to a more\ncommonly seen tactic of setting the `Run key in the Windows registry in the early 2015 sample. This`\nmethod changed again in late 2015 when the implant migrated from the Run key to using a less\nfrequently observed registry key: `Winlogon\\Shell . This key stores the list of executables which are to`\nbe run once a Windows GUI session is created, and typically holds only the standard user shell,\n```\nexplorer.exe .\n\n### String Obfuscation\n\n```\nIn another modification, first observed in the most recent October 11 Parliamentarian operation (version\n```\nagewkassif ), the developer(s) of KeyBoy began using a string obfuscation routine in order to hide\n\n```\nmany of the critical values referenced within the malware. This introduction of string obfuscation also\nsuggests a development change aimed at evading detection. The header codes, filename references,\nand all of the operator commands were obfuscated and only decoded during execution of the KeyBoy\nDLL. Figure 6 shows a sampling of these strings, after decoding.\n\n\n-----\n\nFigure 6: Header code and command strings after being decoded at run-time\n\n### Evidence of Modularity\n\nFinally, there were numerous changes observed that could suggest that KeyBoy was being deployed\nusing a modular or component based mechanism. The `GetUp export which is linked to the browser`\ncredential theft capability seems to be present in some samples and not others, even for versions within\nthe same development stage. As well, the inconsistent use of a dropper binary during infection is further\nevidence supporting the modular component theory.\n\n### Additional Details\n\nBeyond the main modifications outlined above, numerous smaller changes were also observed, many of\nwhich are described in Table 6 below.\n\n**Version**\n**Identifier** **Key Changes**\n\n\nProxy\n20130401\n\n\nPersistence handled via Windows service\nOne sample contained the ‘GetUP’ export, the other did not\nUsed full word header codes encapsulated by $ symbols, such as $login$\n\n\nP_20150313 Adopts new algorithm for config file encoding\nRetained browser credential theft module\nMoved to persistence via Run key\nHeader codes shift to #-encapsulation\nDeployed without use of dropper binary\n\n\n-----\n\n**Version**\n**Identifier** **Key Changes**\n\n20151108 Continues use of new config encoding algorithm\nMigrated to use of WinLogon key for persistence\nInstallation now conducted via VBS scripts\nAdopted multi-byte strings internally and in C2 communication\nHeader codes move to *-encapsulation\n64 bit version distributed inside 32 bit payload\nNo evidence of browser credential module\nDeployed using dropper binary\n\n20160509 Continues use of new config encoding algorithm\nAdded AutoUpdate/Upload & Execute function\nDeployed using dropper binary\nHeader codes retain *-encapsulation, new ‘keep-alive’ code, *l*\nExecution via DLL search-order hijacking of legitimate Windows application\nVBS script traces still present, but no longer used\nNo 64bit version embedded\n\nagewkassif Functionally identical to 20160509 sample\nContinues use of new config encoding algorithm\nRemoved date string from version identifier\nAdded static string obfuscation code. Strings used for C2 commands, header\ncodes, and more are now decoded at runtime\n\n**Table 6: Changes observed between successive versions of KeyBoy**\n\nAdditional technical details relating to several of the KeyBoy samples described in this section are\nprovided in Appendix B.\n\n## Connecting KeyBoy to Other Operations\n\n[In their Operation Tropic Trooper report, Trend Micro documented the behaviour and functionality of an](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-operation-tropic-trooper.pdf)\nespionage toolkit with several design similarities to those observed in the various components of\nKeyBoy. Trend Micro specifically noted that the 2013 versions of KeyBoy used the same algorithm for\nencoding their configuration files as was observed in the Operation Tropic Trooper malware.\n\nThis connection may offer another explanation for the significant change in the configuration file\nencoding algorithm we described in relation to KeyBoy. If KeyBoy is a single component of a larger\nespionage toolkit, the developers may have realized that this older, static-key based, configuration\nencoding algorithm was inadvertently providing a link between disparate components of their malware\nsuite.\n\n## A Note on Samples\n\nWe were not able to locate a large sample set for KeyBoy. Though we discussed the development\ntimeline, we have limited insight into the victims targeted by each of these samples. We cannot conclude\n[that all are being deployed by the same group. We provide YARA signatures and encourage anyone](https://github.com/citizenlab/malware-indicators/blob/master/201611_KeyBoy/keyboy.yar)\nwho can provide additional samples or context to contact us.\n\n\n-----\n\n## Recent Tibetan Protests\n\n[The harm of malware operations against the Tibetan community is well-documented, and this latest](https://targetedthreats.net/)\ncampaign is no exception. Examining the lure content sent to the Tibetan Parliamentarians sheds light\non the oppression faced by the Tibetan community. On October 19, over 180 Tibetan groups protested\nthe ongoing demolitions of the Larung Gar Buddhist Academy, the largest Tibetan Buddhist institute in\nthe world.\n\n[The demolitions stem from an order issued by Chinese authorities in June 2016, according to a joint](https://freetibet.org/news-media/na/over-180-tibet-groups-condemn-larung-gar-demolitions-joint-statement)\nstatement issued by Tibet groups on the date of protest. According to the same joint statement, the\norder from Chinese authorities said the community was in need of “ideological guidance” from the\nChinese state. In conjunction with the demolitions, residents are being forcefully removed from Larung\n[Gar. To date, the forced removals have led to to the suicide of three resident nuns.](http://tchrd.org/nuns-continue-suicide-protest-against-demolition-of-buddhist-institute/)\n\nThe Communist Party of China views the Tibetan movement as a threat to its rule, alongside Uyghur,\nFalun Gong, advocates for an independent Taiwan and Hong Kong, and members of the democracy\nmovement. Surveilling the highest governing body of the Central Tibetan Administration aligns with the\noverall interests of the government of China. However, connecting the malware development ecosystem\nand the flow of stolen information to a state-actor is an elusive task. With the data available we are\nunable to conclusively connect the Parliamentarian Operation to any specific actor or nation-state.\n\n## Conclusions\n\n[Recent Citizen Lab reports have documented a trend away from the use of attachment-based malware](https://citizenlab.ca/2016/03/shifting-tactics/)\noperations targeting the Tibetan Diaspora. These changes may reflect malware operators shifting tactics\nin response to changes in the community, including education campaigns encouraging Tibetans not to\nuse email attachments, or perhaps also by more sophisticated attachment scanning by popular email\nproviders.\n\nThe operation against the Tibetan Parliamentarians illustrates the continued use of malicious\nattachments in the form of documents bearing exploits. These exploits, while older, were used to deliver\na malware payload which shows signs of a systematic technical adaptation designed to reduce the\nlikelihood of signature based detection.\n\nThe developers of KeyBoy have made the minimum necessary technical changes required to avoid\ndetection by signature-based antivirus, and yet retained “old” exploits because they likely continue to\nwork their targets.\n\nFor a community lacking an adequate level of human and financial resources, deployment of\ncommercial (i.e.: non-free) antivirus solutions, updated releases of common office productivity software,\nand even software patches may be out of reach. Under such conditions, the use of exploits against\n[older, patched, vulnerabilities becomes yet another iteration of an actor using “just enough”](https://www.johnscottrailton.com/security-for-the-high-risk-user/)\nsophistication to successfully exploit a target.\n\nThe operation against the Parliamentarians yields a clear example of this tactic. When the August\noperation failed to fully compromise the target group, the operators redeployed in October using a\nslightly newer, but still well-known and patched, exploit.\n\n\n-----\n\nAs we observe the evolution of strategies levied against the Tibetan Diaspora, the constant cat-andmouse game embroiling this community becomes evident. While some behavioural adaptations have\nshown promise in reducing the threat, the operation against the Tibetan Parliament underscores the\nneed for continued diligence and security awareness.\n\n## Acknowledgments\n\nSpecial thanks to Tibet Action Institute. Additional thanks to Jakub Dalek, PassiveTotal, VirusTotal, and\nTNG.\n\n## Appendix A: Decoding KeyBoy Config\n\nRecent versions of KeyBoy maintain encoded configuration data inside a file stored on disk. In the\n```\n20160509 sample used in the Tibetan Parliament campaign, this file was named wab32res.dat . The\n\n```\nconfiguration file contains a 16 byte header followed by a number of bytes which are encoded using a\nnovel algorithm. The 16 byte header stores an ascii character representation of the hexadecimal values\ncorresponding to the size (in bytes) of the decoded config data, followed by the number of bytes\ncontaining encoded configuration data.\n\nThe sample under examination contained the following header, and Figure 7 shows the raw\nconfiguration file:\n\nSize of config (in bytes) once decoded Number of bytes in encoded config\n\n0x00 0x00 0x00 0x5B 0x00 0x00 0x00 0x4B\n\nFigure 7: Configuration file for sample under examination\nThe configuration file used by this malware is encoded using what appears to be a custom schema.\nWhile some earlier versions of this backdoor used more simplified encoding techniques for the\nconfiguration data, newer versions have adopted a more involved algorithm.\n\nAt the heart of the decoding function is the use of a dynamically constructed lookup table containing\nsequences of bytes which represent the ASCII characters for the cleartext configuration data.\n\n\n-----\n\nFigure 8: Construction of the base lookup table\nAt the outset of the decoding function, a base lookup table is created containing 256 entries. This initial\ntable can be thought of as an identity matrix, where, for each index, the lookup table contains the index\nas the stored value (see: Figure 8). For example:\n\nLookupTable[0x0] → 0x0\n\nLookupTable[0x1] → 0x1\n\n⋮ ⋮\n\nLookupTable[0xFF] → 0xFF\n\nDuring the decoding of the configuration file, this table is expanded dynamically. Each iteration of the\nalgorithm will populate the lookup table sequentially, beginning with index 0x102 (since the table index\n0x101 is reserved).\n\n## Algorithm Walkthrough\n\nThe algorithm has three basic steps:\n\n1. Obtain an index by decoding a value from the configuration file\n2. Find the value in the lookup table corresponding to this index, and place this result in the memory\n\nbuffer holding decoded configuration data\n3. Generate a new value and insert it into the lookup table at the next available index\n\n### Step 1\n\nThis step requires the algorithm to obtain an index value from the configuration file. In order to obtain\nthis index, a decoding function evaluates the data in the configuration file not as successive bytes, but\nas a series of integers calculated by considering consecutive sequences of 9-bit binary values.\n\n**Figure 9 provides a visual representation of this process. We can see that the first few indices being**\ncalculated by this decoder are hexadecimal values 0x100, 0x39, 0x38, and 0x37. The first value, 0x100,\nis a ‘marker’ which denotes the beginning of the configuration data. The values 0x39, 0x38, and 0x37\nare the first three indices used to obtain data from the lookup table.\n\n\n-----\n\nFigure 9: Step 1 in KeyBoy decoding algorithm. Indices are obtained by viewing the data in 9-bit\n‘windows’\n\n### Step 2\n\nAs mentioned above, the first 256 entries in the lookup table are created as an identity matrix, and thus\nthe result of lookups for 0x39,0x38,0x37 would be:\n```\nLookupTable[ 0x39 ] = 0x39 => “9” (ascii)\nLookupTable[ 0x38 ] = 0x38 => “8” (ascii)\nLookupTable[ 0x37 ] = 0x37 => “7” (ascii)\n\n```\nThese values are then stored in memory as decoded bytes of configuration data.\n\n### Step 3\n\nAfter each iteration of calculating an index (step 1) and then obtaining the corresponding value from the\nlookup table (step 2), the algorithm will create a new entry in the lookup table at the next available index.\nThe format of this new lookup table entry is simply the concatenation of the results of the previous\nlookup with the first byte of the current lookup (see: Figure 10).\n\n\n-----\n\nFigure 10: Steps 2 & 3 in the KeyBoy configuration decoding algorithm\nSo, again using the same example bytes along with Figures 9 and 10 above, if the current iteration of\nthe algorithm decoded the value 0x34 in step 1, and thus retrieved the value 0x34 = ‘4’ in step 2, the\nnewly formed lookup table entry would be:\n```\nLookupTable[ 0x106 ] = [0x35,0x34] => “54”\n\n```\nThus, if at some future point in the decoding process the index 0x106 was obtained in step 1, the output\nto the configuration data would be the two bytes [0x35,0x34] which have ascii representation “54”. This\nprovides a method of data compression to the configuration file.\n\nA Python script was created for the purpose of automating this configuration file decoding process. The\noutput of this script when run against the configuration file used by the first of the two Parliamentarian\noperation samples yielded the following data:\n```\nIdentity Code: 9876543210\nC2 Host/IP #1: 45.125.12.147\nC2 Host/IP #2: 103.40.102.233\nC2 Host/IP #3: 45.125.12.147\nC2 Port #1: 443\n\n```\n\n-----\n\n```\nC2 Port #2: 443\nC2 Port #3: 443\nPassword: tibetwoman\nCampaign ID: NNNN\n\n## Appendix B: KeyBoy Samples\n\n### Version: P_20150313\n\n```\n**Exploit Document:** `05b5cf94f07fee666eb086c91182ad25`\n\n**Payload:** `0c7e55509e0b6d4277b3facf864af018`\n\n**DLL Exports**\n\n```\nEmbedding 0x1000bfb0\n\n```\n```\nGetUP 0x1000c940\n\n```\n```\nSSSS 0x1000bc60\n\n```\n```\nStartWork 0x1000c570\n\n```\n```\nSvcMain 0x1000c430\n\n```\n\n**Installation**\n\nThis sample was discovered inside a malicious PowerPoint slide show which carried lure content\nconsistent with an Indian-nexus, and which was uploaded to VirusTotal in April 2015 using the filename\n\n`athirappalli.pps .` [Athirappilly is a village in India known for its wildlife and waterfalls. The visual](https://en.wikipedia.org/wiki/Athirappilly)\ncontents of the slide show are images of waterfalls, presumably from this village. This malicious `.pps`\nfile was weaponized using (closely related to CVE-2014-4114 aka Sandworm, which we have previously\n[observed this exploit used against the Tibetan community) to execute the following embedded DLL:](https://citizenlab.ca/2015/06/targeted-attacks-against-tibetan-and-hong-kong-groups-exploiting-cve-2014-4114/)\n\n**Name:** `SystemCertificates.ocx`\n\n**Size:** `495616 bytes`\n\n**Compile Time:** `13 Mar 2015 03:05:34 UTC`\n\n**MD5:** `0c7e55509e0b6d4277b3facf864af018`\n\n**SHA256:** `5395f709ef1ca64c57be367f9795b66b5775b6e73f57089386a85925cc0ec596`\n\n**Persistence**\n\nThis DLL maintains persistence by setting the following registry entry in the\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key: SystemCertificates → \"cmd /c\nstart Run dll32.exe %APPDATA%\\Microsoft\\SystemCertificates\\SystemCertificates.ocx,\nSSSS\n\n```\nThis registry key is set via the Sandworm exploit, as the execution of an `.inf file containing the`\nfollowing instructions are triggered:\n\n```\nCopyFiles = RxCopy\n\n```\n```\nAddReg = RxStart\n\n```\n```\n[RxCopy]\n..\\..\\Roaming\\Microsoft\\SystemCertificates\\SystemCertificates.ocx, contact.pdf\n\n```\n\n-----\n\n```\n[RxStart]\nHKCU,Software\\Microsoft\\Windows\\CurrentVersion\\Run,SystemCertificates,,\"cmd /c start\nRundll32.exe %APPDATA%\\Microsoft\\SystemCertificates\\SystemCertificates.ocx, SSSS\"\n\n```\nIn comparison with the prior generation of KeyBoy examined by Rapid7, this mechanism represents a\nchange to registry based persistence from the previously used Windows service.\n\n**Configuration**\n\nUsing the algorithm presented in Appendix A, we were able to decode the configuration file used by this\nsample. Once decoded, the following information was obtained:\n```\nIdentity Code: IJUDHSDJFKJDE\nC2 Host/IP #1: www.about.jkub[.]com\nC2 Host/IP #2: www.eleven.mypop3[.]org\nC2 Host/IP #3: www.backus.myftp[.]name\nC2 Port #1:80\nC2 Port #2:80\nC2 Port #3:443\nPassword:wariii\nCampaign ID:war\n\n```\n**Infrastructure**\n\nC2 Host: www.about.jkub[.]com Desc: Dynamic DNS provided by\nchangeip.com\n\n\nHost First\nSeen:\n\n175.213.49[.]6 2016-1025\n\n45.32.47[.]148 2016-0926\n\n157.7.84[.]81 2015-0407\n\n\nLast Seen:\n\nCurrent as of\npublication\n\n2016-10-24\n\n2015-04-21\n\n\nC2 Host: www.eleven.mypop3[.]org Desc: Dynamic DNS provided by\nchangeip.com\n\n\n-----\n\nHost First\nSeen:\n\n175.213.49[.]6 2016-1025\n\n45.32.47[.]148 2016-0926\n\n\nLast Seen:\n\nCurrent as of\npublication\n\n2016-10-24\n\n\nC2 Host: www.backus.myftp[.]name Desc: Dynamic DNS\n\nHost First Seen: Last Seen:\n\n192.241.149[.]43 2015-05-05 Current as of publication\n\n### Version: 20151108\n\n**Exploit Document:** `8846d109b457a2ee44ddbf54d1cf7944`\n\n**Dropper:** `8846d109b457a2ee44ddbf54d1cf7944`\n\n**Payload:** `c5b5f01ba24d6c02636388809f44472e`\n\n**Embedded 64bit:** `371bc132499f455f06fa80696db0df27`\n\n**Payload DLL Exports**\n\n```\nInstall 0x100085a0\n\n```\n```\nSSSS 0x100081e0\n\n```\n```\nStartWork 0x100086a0\n\n```\n```\nSvcMain 0x10008fb0\n\n```\n```\ncfsUpdate 0x10008cb0\n\n```\n**Installation**\n\nThis `.rtf document, also exploiting CVE-2012-0158, was submitted to VirusTotal in March 2016. The`\nexploit triggers the execution of an embedded dropper, similar to the method observed in our initial\nsample described in Part 1.\n\nThis dropper creates three files on disk, each in the %localappdata% folder:\n\n1. cfs.dat – KeyBoy configuration file\n2. cfsupdate.dal – KeyBoy payload DLL\n3. desk.vbs – Windows script used for installation\n\nThe Windows script file, desk.vbs, contained the following content:\n\n\n-----\n\nThe dropper executes this script file which subsequently launches the KeyBoy backdoor and sets\npersistence as described below.\n\nAlso noteworthy in this sample was the fact that this payload inspected the architecture of the victim PC\nto determine if it was 64 bit capable. If so, a 64 bit version of the payload was decoded from the data\nsection of the cfsupdate.dat file using an XOR operation having key 0x90. This is very similar to the\n[method described by Trend Micro in their report on the TROJ_YAHOYAH malware.](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-operation-tropic-trooper.pdf)\n\nInterestingly, the 64-bit module was packed using a known freeware binary packer. This is in contrast to\nthe 32-bit versions of KeyBoy, none of which contained any binary protections whatsoever. Upon\nunpacking, the 64-bit version of this KeyBoy code was functionally identical to the 32-bit version.\n\n**Leftover Code**\n\nFurther illustrating the continued development and connections between samples are the leftover\nremnants from `20151108 existing in the` `20160509 Parliamentarian sample. The Parliamentarian`\ndropper contained references to the `Desk.vbs script described above, yet this file and related content`\nwas not deployed or otherwise used in the `20160509 version.`\n\n**Persistence**\n\nPersistence is achieved through the WinLogon\\Shell registry key, and is installed by the dropper’s\nexecution of the Install export from the KeyBoy DLL. This export creates the file\n```\n%localappdata%\\Desktop.ini as shown below, and installs it by launching the Windows regini.exe\n\n```\ncommand:\n```\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\nshell = explorer.exe,C:\\Windows\\system32\\rundll32.exe \"%LOCALAPPDATA%\\cfs.dal\"\ncfsUpdate\n\n```\n**Configuration**\n\nThe configuration file used by this version of KeyBoy is written to disk as %localappdata%\\cfs.dat\nby the dropper, similar to the behaviour of our `20160509 sample. This configuration file uses the newer`\nencoding method outlined above and in Appendix A. Once decoded, the following information was\nobtained:\n```\nIdentity Code: 9876543210\nC2 Host/IP #1: 103.242.134[.]243\nC2 Host/IP #2: 103.242.134[.]243\nC2 Host/IP #3: 103.242.134[.]243\nC2 Port #1: 443\nC2 Port #2: 1234\nC2 Port #3: 1234\nPassword: password8888\nCampaign ID: MyUser\n\n```\n**Possible Targeting**\n\n\n-----\n\nThis malicious document embedded an empty decoy document to hide the exploitation of the\n[vulnerability. We found however another interesting sample with the exact same payload but with a](https://malwr.com/analysis/MmZjNjMyZjYxNWRiNDJhYzg0YzY5ZTQxYjYxNWM2NDE/)\ndecoy document presenting a petition to release a Tibetan activist:\n\n**Infrastructure**\n\nThis sample communicates with the following command and control server:\n\n**C2 Host:** `103.242.134[.]243`\n\n**City:** `Hanshan`\n\n**Country:** `China`\n\n### Version: 20160509 (alternate)\n\n**Exploit Document:** `beadf21b923600554b0ce54df42e78f5`\n\n**Dropper:** `0b4d45db323f68b465ae052d3a872068`\n\n**Payload:** `495adb1b9777002ecfe22aaf52fcee93`\n\n**Payload DLL Exports**\n\n```\nSSSS 0x100080b0\n\n```\n```\nSvcMain 0x10008b80\n\n```\n```\ncfsUpdate 0x10008880\n\n```\nDuring our research we encountered another sample of the `20160509 version of KeyBoy. This sample`\nwas also found to be deployed using the CVE-2012-0158 vulnerability. The malware payload was\nidentical to our first Parliamentary sample outlined in Part 1, however the configuration file in this\nalternate sample was different.\n\n**Configuration**\n```\nIdentity Code: 9876543210\nC2 Host/IP #1: 116.193.154[.]69\nC2 Host/IP #2: 116.193.154[.]69\nC2 Host/IP #3: 116.193.154[.]69\n\n```\n\n-----\n\n```\nC2 Port #1:443\nC2 Port #2:80\nC2 Port #3:443\nPassword:8888\nCampaign ID:8888\n\n```\n**Possible Targeting**\n\nThe exploit document carrying this alternate KeyBoy configuration also used a decoy document which\nwas displayed to the user after the exploit launched. This decoy carries content with a Tibetan nexus.\n\n**Infrastructure**\n\n```\nCNAME: 116-193-154-69.pacswitch.net\n\n```\n\n## Appendix D: IOCs and Links\n\n**KeyBoy binaries**\n```\nagewkassif: 087bffa8a570079948310dc9731c5709\n20160509: 495adb1b9777002ecfe22aaf52fcee93\nP_20150313: 0c7e55509e0b6d4277b3facf864af018\n20151108 (32bit): c5b5f01ba24d6c02636388809f44472e\n20151108 (64bit): 371bc132499f455f06fa80696db0df27\n\n```\n**Droppers**\n```\n0b4d45db323f68b465ae052d3a872068\n23d284245e53ae4fe05c517d807ffccf\n98977426d544bd145979f65f0322ae30\n\n```\n**Exploit Documents**\n```\n8307e444cad98b1b59568ad2eba5f201 (used in August Parliamentary campaign)\n913b82ff8f090670fc6387e3a7bea12d (used in October Parliamentary campaign)\n05b5cf94f07fee666eb086c91182ad25\n8846d109b457a2ee44ddbf54d1cf7944\nbeadf21b923600554b0ce54df42e78f5\n\n```\n**C2 Hosts**\n```\nwww.about.jkub[.]com\nwww.eleven.mypop3[.]org\nwww.backus.myftp[.]name\ntibetvoices[.]com\n103.242.134[.]243\n116.193.154[.]69\n103.40.102[.]233\n45.125.12[.]147\n\n## Resources\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-11-17 - It’s Parliamentary - KeyBoy and the targeting of the Tibetan Community.pdf"
    ],
    "report_names": [
        "2016-11-17 - It’s Parliamentary - KeyBoy and the targeting of the Tibetan Community.pdf"
    ],
    "threat_actors": [
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535703,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653706067,
    "ts_modification_date": 1653706067,
    "files": {
        "pdf": "https://archive.orkl.eu/9dde2e74ac98e8f34156184878686d5f8a87bbd8.pdf",
        "text": "https://archive.orkl.eu/9dde2e74ac98e8f34156184878686d5f8a87bbd8.txt",
        "img": "https://archive.orkl.eu/9dde2e74ac98e8f34156184878686d5f8a87bbd8.jpg"
    }
}