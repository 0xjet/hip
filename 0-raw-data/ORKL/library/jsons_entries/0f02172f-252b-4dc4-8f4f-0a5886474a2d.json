{
    "id": "0f02172f-252b-4dc4-8f4f-0a5886474a2d",
    "created_at": "2023-01-12T15:01:25.605614Z",
    "updated_at": "2025-03-27T02:05:52.362667Z",
    "deleted_at": null,
    "sha1_hash": "b46a054c0c8d1b7ab7ddff4d97ffcc53c51a671f",
    "title": "2021-10-27 - Portable Executable File Infecting Malware Is Increasingly Found in OT Networks",
    "authors": "",
    "file_creation_date": "2022-05-28T17:46:12Z",
    "file_modification_date": "2022-05-28T17:46:12Z",
    "file_size": 1494374,
    "plain_text": "# Portable Executable File Infecting Malware Is Increasingly Found in OT Networks\n\n**mandiant.com/resources/pe-file-infecting-malware-ot**\n\nBlog\n\nKen Proska, Corey Hildebrandt, Daniel Kapellmann Zafra, Nathan Brubaker\n\nOct 27, 2021\n\n9 mins read\n\nOperational Technology\n\nThreat Research\n\nMalware\n\n\n-----\n\nWhile researching files associated with a range of operational technology (OT) original\nequipment manufacturers (OEM), Mandiant Threat Intelligence uncovered a large number of\nlegitimate portable executable (PE) binaries affected by various types of PE infecting\nmalware. The infected files include binaries associated with programmable logical controllers\n(PLC), OLE for process control (OPC) communications, human-machine interface (HMI)\napplications, and other OT functions supported by Windows-based devices at levels 2 and 3\nof the Purdue Model.\n\nA PE is a file format developed by Microsoft used for executables (.EXE, .SCR) and dynamic\nlink libraries (.DLL). A PE file infector is a malware family that propagates by appending or\nwrapping malicious code into other PE files on an infected system. PE infectors are not\nparticularly complex and can be detected by most antivirus products. However, this has not\nstopped such malware from spreading to OT networks where slight deviations in\nperformance or system conditions may result in adverse outcomes.\n\nFor this blog post, we examined 1,200 infected files associated with ten OEMs in a known\nmalware analysis platform from 2010 through 2021. These malicious executables contain\ninfected versions of legitimate PE files as indicated by valid embedded certificates from the\nvendors. Although we have no indications that this activity is targeting OT systems, our\nresearch highlights that actors can often succeed in crossing the OT security perimeter even\nwith simple tactics.\n\nTo gain access to comprehensive coverage of OT and IT threat actor activity, check out\n[Mandiant Advantage Free and Fusion cyber threat intelligence offerings.](https://www.mandiant.com/advantage/threat-intelligence/subscribe)\n\n## PE Infecting Malware Is Increasingly Observed in OT Binaries Since 2010\n\nMandiant hunted for infected samples and uncovered over 1200 infected PEs associated\nwith ten OT OEMs tested in an online malware analysis sandbox from 2010 through 2021.\nThe list of OEMs included Siemens, Emerson, Schneider Electric, Rockwell Automation/Allen\nBradley, ABB, Schweitzer Engineering, Honeywell, GE Fanuc, Kepware, and Invensys. In\n2010, only three PEs were tested on the platform, but that number increased to 526 PEs in\nthe first six months of 2021 alone. While we are not able to definitively state the reason for\nthis significant increase, there are a few possible explanations.\n\nSince 2010, awareness of security in OT networks has dramatically increased. As a\nresult, OT security teams increasingly deploy anti-virus measures to Windows-based\nsystems and test more suspicious files, some of which include the identified PE\ninfectors.\nIT-OT convergence has led to increasing connectivity of OT networks, potentially\nresulting in increased exposure to IT malware like PE infectors.\nLimited use of anti-virus and other security measures in OT has allowed the malware to\nspread and persist over the last decade\n\n\n-----\n\nOT defenders are increasingly using known malware analysis platforms to review\nsoftware from Windows-based systems in OT.\n\nFigure 1 shows the upward trend of infected OEM OT executables between 2010 and mid2021. Mandiant does not have enough information to explain the sudden drop in observed\ncases during 2019. However, given the observable trend, we believe it may be related to\nmodifications in the malware analysis repository we queried.\n\nFigure 1: Number of infected OT executables over time\nThe trend highlighted in Figure 1 is consistent with the fact that the OT security community is\nrelatively new and began to develop mainly after the Stuxnet incident in 2011. We have\nobserved similar growth in other areas, such as information sharing for OT vulnerabilities.\nWe also highlight that the number of infections we present only includes analysis of\nexecutables from ten major OEMs in one known malware analysis platform, however, the\nnumber of actual infections across the industry is likely much higher.\n\n\n-----\n\n[Download a copy of our sample of infected files. We note that in some cases automated](https://www.mandiant.com/media/12851/download)\nanalysis was unable to determine the specific malware and the list may include a small\nnumber of other types of malware posing as OT software.\n\n## PE Infectors Can Propagate Easily Without Targeting Specific Victims\n\nMandiant has no information to indicate that any of the PE infectors we uncovered were\nspecifically targeting OT systems. Due to the worm-like nature of many PE infectors, there\nare multiple scenarios and attack vectors in which OT assets can become infected, most\noften without being specifically targeted. Table 1 provides a non-exhaustive list of examples.\n\nTable 1: Threat vector analysis\nPE infectors often propagate by scanning filesystems, memory, local drives, network shares,\nand portable media for clean PE files and, once located, alter the clean PE by appending\nmalicious code. For example, when the malware finds a file such as “EventViewer.exe”, a\nlegitimate Honeywell software used to view security alarms, it appends itself to the\nexecutable but keeps the original name and the program functionality. Procedures used to\nexecute this vary in complexity among different families and variants of PE infectors. Table 2\npresents a random sample of infected OT OEM binaries we uncovered.\n\n\n-----\n\nTable 2: Sample of infected OT OEM binaries\nPE infected malware introduced in OT environments can propagate quickly where protection\nlevels are consistent throughout systems and networks. For example, if the initial infection\nvector is through portable media due to a lack of implementation of scanning and sanitization\ncontrols, then asset owners will likely see infections across systems where portable media is\nshared.\n\n## Different PE Infectors Vary in Capabilities\n\nThere are multiple types of PE infectors with various capabilities. Our analysis of a subset of\nidentified malicious files indicates the following functions are common across most families:\n\nCommand and Control (C2)\n\nProvides threat actors with the ability to issue commands, download additional\nmalicious resources, and exfiltrate data from infected systems\nPeer-to-Peer (P2P) Botnet Communication\n\nAbility to send/receive C2 domains/Ips via infected peers\nAnti-Debugging/Anti-VM\n\nPayload encryption to obscure analysis and detection\n\n\n-----\n\nSystem Modification\n\nPrimarily used to propagate across the system, inject malicious code into\nprocesses, alter files across the system, create/delete files, disable security\nfunctions, and provide persistence\n\nTable 3 includes a subset of the most observed PE infecting malware families we identified in\nOT files. Variants may include functionality not mentioned and payloads modified by threat\nactors.\n\n\n-----\n\nTable 3: Examples of PE infecting malware families\n\n## PE Infector Outbreaks Can Have Serious Implications for OT Systems\n\n\n-----\n\nWhile largely common in IT networks, PE infector outbreaks may have serious implications\nfor OT systems and networks. When PE infectors are not detected and remediated in a\ntimely manner, they can rapidly spread across networks. Widespread infections introduce\nunexpected conditions to systems and networks where performance and stability are crucial\nfor their intended functions.\n\nAt the network level, systems impacted by PE infecting malware can egress large\namounts of erroneous traffic associated with capabilities of the malware, such as C2\nbeaconing, P2P botnet communication, and file share enumeration. PE infectors may\nalso result in adverse impacts on performance of older networking equipment, which is\ncommonly benchmarked with expected normal conditions through factory acceptance\ntesting (FAT) and site acceptance testing (SAT) by the OEM.\nAt the host level, PE infecting malware can cause performance issues for assets. The\nmethods used by the PE infectors to propagate and persist can cause spikes in\nresource utilization, such as disk I/O, memory, and CPU performance.\n\nThis can impact legacy systems with limited resources and assets with specific\nfunctions such as historians, where disk and memory I/O performance is critical.\nBinaries used by the OS and OEM software can also become corrupted or\ndegraded as the malware propagates and alters files across the system.\n\nWhile in most cases, PE infecting malware in OT environments can be considered a\nnuisance, it highlights the existence of weaknesses that threat actors can take advantage of.\nOur observations of OT related software executables impacted by PE infecting malware\nimply that OT systems and networks can be compromised with overly simplistic tactics.\n\nAlthough the PE infecting malware families we observed were not likely targeting OT\nsystems or networks, more complex malware with similar PE infecting capabilities may be\njust as effective at penetrating the OT perimeter. One example is the case of LOCKLOAD\n(aka FREELOADER), a malware family with PE infecting capability which we have observed\nbeing used to operate and collect information from air-gapped systems. In addition to its PE\ninfecting ability, LOCKLOAD can exfiltrate stolen files off a victim's system, execute\npropagate commands and collect files from infected offline systems. It also propagates to\noffline systems when opening files from compromised USB drives.\n\n## Prevention, Detection, and Remediation for PE Infectors in OT Environments\n\nMandiant provides the following recommendations for prevention, detection, and remediation\nof PE infectors in OT environments. For support reach out to Mandiant OT Consulting.\n\n_Prevention_\n\nDefenders should prioritize prevention for PE infecting malware to decrease the risk of\ninfections spreading to critical assets.\n\n\n-----\n\nPerform periodic backups for critical assets and ensure backups are tested. The\nbackups should be stored offline and periodically tested.\nDevelop policies and procedures for identifying, controlling, and authorizing use of\nportable media such as laptops, USB, and CDs:\n\nSanitize or scan portable media with up-to-date anti-virus using a heuristicsbased engine prior to connecting to OT assets.\nEvaluate portable media and data entering the OT environment from untrusted\nsources and have external parties use controlled and authorized portable media.\nEnsure OT assets do not have direct network access or mapped network shares to IT\nassets unless absolutely required. Properly segment or airgap critical safety assets\nfrom larger networks and monitor network traffic for anomalies to and from these\nassets.\nMonitor vendors' and contractors' use of OT systems, including for example portable\nmedia, or work orders.\nWhere feasible:\n\nDisable USB ports for devices where their use is not needed and, if possible,\nutilize port-blockers.\nInstall application whitelisting on OT assets or portable media used with OT\nassets (e.g., maintenance laptops and test equipment).\nImplement device control on OT assets to ensure only approved portable media\nis used.\n\n_Detection_\n\nPE infecting malware and files affected by PE infectors often have high detection rates by\nanti-virus engines. However, OT systems may be unable to use anti-virus or endpoint\nprotection because of constraints such as service-level agreements (SLA). Defenders should\nprioritize detection of this threat prior to entering the OT environment. This can be achieved\nby scanning devices and data brought into the OT environment with updated anti-virus or\nsanitizing it prior to use.\n\nDetecting the presence of PE infecting malware can be difficult on assets where traditional\nanti-virus or endpoint protection is not used. This is because the infected PE files may have\nthe ability to run the legitimate code even after being infected, leaving very few userobservable indicators. We suggest defenders review network traffic to and from systems that\ncould be used to support C2 capabilities (e.g., systems at Purdue level 2 and 3). Identifying\nsuspicious beaconing or C2 activity from these assets can also help in identifying infected\nsystem in the environment.\n\n_Remediation_\n\nRemediating an infection caused by PE infecting malware can be complicated due to the\nself-replicating nature and methods used to propagate and persist throughout a system.\nDeleting infected files is not recommended as this can cause loss of important files used by\n\n\n-----\n\nthe OS or OT applications. Mandiant recommends reverting to known good backups for\nremediating infected assets. However, reversion to backups requires consideration of the\nfollowing factors:\n\nIs there a backup available for the affected asset(s)?\nWere there any changes made to the asset (e.g., configuration, project files, setpoint,\ntags, etc.) since the last backup was captured?\nWhat was the infection vector?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-27 - Portable Executable File Infecting Malware Is Increasingly Found in OT Networks.pdf"
    ],
    "report_names": [
        "2021-10-27 - Portable Executable File Infecting Malware Is Increasingly Found in OT Networks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535685,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1653759972,
    "ts_modification_date": 1653759972,
    "files": {
        "pdf": "https://archive.orkl.eu/b46a054c0c8d1b7ab7ddff4d97ffcc53c51a671f.pdf",
        "text": "https://archive.orkl.eu/b46a054c0c8d1b7ab7ddff4d97ffcc53c51a671f.txt",
        "img": "https://archive.orkl.eu/b46a054c0c8d1b7ab7ddff4d97ffcc53c51a671f.jpg"
    }
}