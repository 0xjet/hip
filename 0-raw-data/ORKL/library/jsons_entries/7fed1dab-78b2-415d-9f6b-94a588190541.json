{
    "id": "7fed1dab-78b2-415d-9f6b-94a588190541",
    "created_at": "2023-01-12T15:10:04.687368Z",
    "updated_at": "2025-03-27T02:13:16.604552Z",
    "deleted_at": null,
    "sha1_hash": "12d2ba890ed05dfa82021d12e459552fa43e4721",
    "title": "2021-12-20 - Log4j vulnerability now used to install Dridex banking malware",
    "authors": "",
    "file_creation_date": "2022-05-27T02:10:07Z",
    "file_modification_date": "2022-05-27T02:10:07Z",
    "file_size": 1501260,
    "plain_text": "# Log4j vulnerability now used to install Dridex banking malware\n\n**[bleepingcomputer.com/news/security/log4j-vulnerability-now-used-to-install-dridex-banking-malware/](https://www.bleepingcomputer.com/news/security/log4j-vulnerability-now-used-to-install-dridex-banking-malware/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nDecember 20, 2021\n11:33 AM\n0\n\nThreat actors now exploit the critical Apache Log4j vulnerability named Log4Shell to infect\nvulnerable devices with the notorious Dridex banking trojan or Meterpreter.\n\nThe Dridex malware is a banking trojan originally developed to steal online banking\ncredentials from victims. However, over time, the malware has evolved to be a loader that\ndownloads various modules that can be used to perform different malicious behavior, such\nas installing additional payloads, spreading to other devices, taking screenshots, and more.\n\nDridex infections are also known to lead to ransomware attacks from operations believed to\nbe linked to the Evil Corp hacking group. These ransomware infections include BitPaymer,\nDoppelPaymer, and possibly other limited-use ransomware variants.\n\n\n-----\n\n## Log4j exploited to install Dridex and Meterpreter\n\nToday, the cybersecurity research group Cryptolaemus warned that the Log4j vulnerability is\nnow exploited to infect Windows devices with the Dridex Trojan and Linux devices with\nMeterpreter.\n\n[Cryptolaemus member Joseph Roosen told BleepingComputer that the threat actors use the](https://twitter.com/JRoosen)\n[Log4j RMI (Remote Method Invocation) exploit variant to force vulnerable devices to load](https://www.bleepingcomputer.com/news/security/log4j-attackers-switch-to-injecting-monero-miners-via-rmi/)\nand execute a Java class from an attacker-controlled remote server.\n\n**Log4j RMI exploit to execute Dridex loader**\n\n_Source: BleepingComputer_\n\n\n-----\n\nWhen executed, the Java class will first attempt to download and launch an HTA file from\nvarious URLs, which will install the Dridex trojan. If it cannot execute the Windows\ncommands, it will assume the device is running Linux/Unix and download and execute a\nPython script to install Meterpreter.\n\nRunning Meterpreter on a Linux box will provide the threat actors with a remote shell that\nthey can use to deploy further payloads or execute commands.\n\nThe Dridex threat actors are known for using racial and religious slurs in their file names and\nURLs, which BleepingComputer has redacted from the images below.\n\n**Decompiled Java class executed by Log4j exploit**\n\n_Source: BleepingComputer_\nOn Windows, the Java class will download an HTA file and open it, which will cause a VBS\nfile to be created in the C:\\ProgramData folder. This VBS file acts as the main downloader for\nDridex and has been seen previously in other Dridex email campaigns.\n\n\n-----\n\n**HTA file downloaded by Java class**\n\n_Source: BleepingComputer_\nWhen executed, the VBS file will check if the user is part of a Windows domain by checking\nvarious environment variables. If the user is part of a domain, the VBS file will download the\nDridex DLL and execute it using Rundll32.exe, as shown below.\n\n\n-----\n\n**Rundll loading the Dridex**\n\n**DLL in Windows**\n\n_Source: BleepingComputer_\nAs previously said, if the original Java class exploit is unable to launch the Windows\ncommands, it will assume the operating is a Unix/Linux device and download an 'm.py'\npython script instead.\n\n\n-----\n\n**m.py python script executed on Linux devices**\n\n_Source: BleepingComputer_\nThe above script contains a base64 encoded script that will be executed to install\nMeterpreter, a pentesting tool that provides a reverse shell back to the threat actors.\n\n**Deobfuscated script installing Meterpreter**\n\n_Source: BleepingComputer_\nUsing Meterpreter, the threat actors can connect to the compromised Linux server and\nremotely execute commands to spread further on the network, steal data, or deploy\nransomware.\n\n\n-----\n\nWith Log4j exploited by threat actors to install a wide range of malware, it comes as no\nsurprise that the more active malware operations would begin to target the vulnerability.\n\nWe should expect to see other malware operations begin to utilize the vulnerability to\ncompromise servers and internal corporate networks. Therefore, it is strongly advised that all\norganizations scan for vulnerable applications that use Log4j and update them to the latest\nversions.\n\nThis includes updating Log4j to the latest version, now version 2.17, released this Saturday\nto fix a new denial of service vulnerability.\n\nThere are many Log4j scanners available that can be used to find vulnerable applications,\n[including a new local scanner from the Profero security.](https://github.com/proferosec/log4jScanner)\n\n### Related Articles:\n\n[New ERMAC 2.0 Android malware steals accounts, wallets from 467 apps](https://www.bleepingcomputer.com/news/security/new-ermac-20-android-malware-steals-accounts-wallets-from-467-apps/)\n\n[Lazarus hackers target VMware servers with Log4Shell exploits](https://www.bleepingcomputer.com/news/security/lazarus-hackers-target-vmware-servers-with-log4shell-exploits/)\n\n[Log4j: List of vulnerable products and vendor advisories](https://www.bleepingcomputer.com/news/security/log4j-list-of-vulnerable-products-and-vendor-advisories/)\n\n[Public interest in Log4Shell fades but attack surface remains](https://www.bleepingcomputer.com/news/security/public-interest-in-log4shell-fades-but-attack-surface-remains/)\n\n[Microsoft disrupts Zloader malware in global operation](https://www.bleepingcomputer.com/news/security/microsoft-disrupts-zloader-malware-in-global-operation/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-20 - Log4j vulnerability now used to install Dridex banking malware.pdf"
    ],
    "report_names": [
        "2021-12-20 - Log4j vulnerability now used to install Dridex banking malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b296f34c-c424-41da-98bf-90312a5df8ef",
            "created_at": "2024-06-19T02:03:08.027585Z",
            "updated_at": "2025-03-27T02:05:17.350153Z",
            "deleted_at": null,
            "main_name": "GOLD DRAKE",
            "aliases": [
                "Indrik Spider ",
                "Evil Corp"
            ],
            "source_name": "Secureworks:GOLD DRAKE",
            "tools": [
                " Cobalt Strike",
                " Covenant",
                " Donut",
                " Dridex",
                " Hades",
                " Koadic",
                " LockBit",
                " Macaw Locker",
                " Mimikatz",
                " Payload.Bin",
                " Phoenix CryptoLocker",
                " PowerSploit",
                " Powershell Empire",
                " SocGholish",
                " WastedLocker",
                "BitPaymer"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536204,
    "ts_updated_at": 1743041596,
    "ts_creation_date": 1653617407,
    "ts_modification_date": 1653617407,
    "files": {
        "pdf": "https://archive.orkl.eu/12d2ba890ed05dfa82021d12e459552fa43e4721.pdf",
        "text": "https://archive.orkl.eu/12d2ba890ed05dfa82021d12e459552fa43e4721.txt",
        "img": "https://archive.orkl.eu/12d2ba890ed05dfa82021d12e459552fa43e4721.jpg"
    }
}