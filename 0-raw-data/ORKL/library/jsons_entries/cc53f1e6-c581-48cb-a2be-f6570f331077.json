{
    "id": "cc53f1e6-c581-48cb-a2be-f6570f331077",
    "created_at": "2023-01-12T15:04:33.893805Z",
    "updated_at": "2025-03-27T02:05:43.754325Z",
    "deleted_at": null,
    "sha1_hash": "a492de96d0b3dcccf2d71f27afde726e0c788387",
    "title": "2021-06-22 - Darkside RaaS in Linux version",
    "authors": "",
    "file_creation_date": "2022-05-27T22:17:13Z",
    "file_modification_date": "2022-05-27T22:17:13Z",
    "file_size": 1490606,
    "plain_text": "# Darkside RaaS in Linux version\n\n**[cybersecurity.att.com/blogs/labs-research/darkside-raas-in-linux-version](https://cybersecurity.att.com/blogs/labs-research/darkside-raas-in-linux-version)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nJune 22, 2021 | [Ofer Caspi](https://cybersecurity.att.com/blogs/author/ofer-caspi)\n\n## Executive summary\n\nAT&T Alien Labs recently analyzed the Linux version of the Darkside ransomware, one of the\nmost active ransomware in the last quarter. Shortly after hitting Colonial Pipeline, Darkside\ndevelopers announced they would be closing operations.\n\n**Key Points:**\n\nUnlike common Linux ransomwares which mostly zip files with a password, Darkside\nencrypts files using crypto libraries. This likely makes recovery impossible without the\nencryption key, if properly implemented.\n\n## Background\n\nLinux and UNIX servers have always been a preferred option for servers and data centers,\nlikely due to the small attack surface of the servers, tight configurations, and lack of user\ninteraction. However, they are often set up and then forgotten, left without detection or\n\n\n-----\n\nprotection mechanisms. This makes them very attractive to attackers. By infecting\nunprotected virtualization servers, attackers can perform devastating attacks on companies,\ntaking down all the services of a company with a single infection.\n\nFirst discovered in August 2020, Darkside is a group that operates ransomware as a service\n(RaaS), and attacks by their network of affiliates have infected many companies worldwide.\nThe most high profile infection happened when a Darkside affiliate hit the network of one of\nthe major oil pipeline companies in the US, Colonial Pipeline, causing the company to shut\ndown operations for days. After this attack — likely due to the fact that it drew unwanted\nlevels of attention to the group globally — the malware authors announced publicly the\nclosure of their service. Nevertheless, there is evidence that the group has completed a\nLinux version of its malware that is targeting ESXi, servers hosting VMware virtual machines.\nTo this point, the authors announced the Darkside 2.0 version with Linux capabilities on\nMarch 9, 2021 in the XSS Forum:\n\nFigure 1. Example of Linux version features and information announced by malware authors\non XSS Forum.\n\n## Analysis\n\nUnlike the Windows version of the malware that targets any Windows endpoint, Darkside\nLinux version is mostly targeting ESXi servers. Its default configuration includes the root path\nof ESX server machines. Targeted extensions are 'vmdk', 'log', 'vmem', 'vmsn' that are used\nin ESX servers for saving virtual machines information, data, and logs.\n\nThe malware is quite informative and prints to the screen most of the actions it performs,\nwhich is an uncommon behavior for malware. This could imply that the malware is being\ndeployed manually. The malware is written in C++ and it’s also using several open-source\nlibraries that were imported and compiled with the malware code into one binary. Some of\n\n\n-----\n\n[these libraries are: crypto++ used for encryption,](https://www.cryptopp.com/) [boost used for logging purposes, and](https://www.boost.org/doc/libs/1_63_0/libs/log/doc/html/index.html)\n[curl used for HTTP requests. The use of these libraries enables the final binary to be a](https://github.com/curl/curl)\n2.7MB file size. For example, to communicate with an infected machine with its Command\nand Control (C&C), the malware uses libcurl functions that were compiled with the rest of the\ncode.\n\nIn addition, the malware supports command line parameters during execution to replace\nalmost, if not all, of the default configuration variables.\n\nFigure 2. Parameters supported by the malware.\n\nThe malware also supports shutting down virtual machines by executing the esxcli\ncommands, a special console on ESX servers that allows it to interact with virtual machines\nfrom the command line.\n\nFigure 3. Abusing esxcli command.\n\nWhen executed, the malware prints its configuration to the terminal. This includes the root\npath to encrypt, RSA key information, targeted file extensions to encrypt, C2 addresses, and\nmore, as seen in figure 4.\n\n\n-----\n\nFigure 4. Darkside configuration.\n\nThe C&C addresses are encrypted using a rotated XOR key, which will be decrypted when\nthe malware is executed. The decrypted addresses can be found in Appendix A:\n\nFigure 5. Decryption loop to extract C&C.\n\nFigure 6. Malware XOR key.\n\nThe malware will then count the files to be encrypted, and it collects information from the\ninfected machine, sending it to the C&C server after encryption. The exfiltrated information\nincludes: user name, OS version, hostname, build, and more:\n\n\n-----\n\nFigure 7. Collecting system information.\n\nFigure 8 shows an example of the information collected from an infected machine.\n\nFigure 8. Example of collected system information.\n\nThe malware will loop through the files to be encrypted and then encrypt them using\nChaCha20 with the RSA 4096 key taken from the configuration. After encryption, the\nmalware will add a tail at the end of the encrypted file that includes a constant and the cipher,\nas seen in figure 9.\n\n\n-----\n\nFigure 9. Adding header after successful encryption\n\nAfter encryption, the malware creates a ransom note in each folder where files were\nencrypted.\n\nFigure 10. Ransom note\n\n## Recommended actions\n\n\n-----\n\n1. Keep software up to date with security updates.\n2. Carefully monitor and manage suspicious emails.\n3. Use a backup system to backup server files.\n4. Install Antivirus and/or endpoint detection and response (EDR) in all endpoints.\n5. Make sure two-factor authentication is enabled in all services.\n\n## Conclusion\n\nRansomwares remains one of the biggest threats to companies globally, especially when it\ncomes to virtual machine servers that may contain multiple machines that are primary targets\nfor Darkside malware.\n\nDarkside will search files on the main folder of the infected server and encrypt any file that\nmatches its configuration limits. It will also collect information from the system and send it to\nits C&C.\n\n## Detection methods\n\nThe following associated detection methods are in use by AT&T Alien Labs. They can be\nused by readers to tune or deploy detections in their own environments or for aiding\nadditional research.\n\n\nYARA RULES\n\n\n-----\n\n```\nrule Darkside_linux\n{\n meta:\n    description = \"darkside ransomware linux version\"\n    author = \"Alienvault Labs\"\n    copyright = \"Alienvault Inc. 2021\"\n strings:\n    $s1 = \"[END] Remove Self\"\n    $s2 = \"[CFG] Landing URL#[\"\n    $s3 = \"Welcome to DarkSide\"\n    $dec_loop = {0F B6 02 84 C0 74 1C 0F B6 B1 DF A7 89 00 40 38 F0 74 10 48 83\nC1 01 31 F0 48 83 F9 20 88 02 49 0F 44 C8}\n  condition:\n    uint32(0) == 0x464C457F and all of them\n}\n\n```\n\n## Associated Indicators of Compromise (IOCs)\n\nThe following technical indicators are associated with the reported intelligence. A list of\n[indicators is also available in the OTX Pulse. Please note, the pulse may include other](https://otx.alienvault.com/pulse/60d0afbc395c24edefb33bb9)\nactivities related but out of the scope of the report.\n\nTYPE INDICATOR D\n\nDOMAIN http://catsdegree[.]com/ C\n\nDOMAIN http://temisleyes[.]com/ C\n\nDOMAIN http://securebestapp20[.]com C\n\nSHA256 9cc3c217e3790f3247a0c0d3d18d6917701571a8526159e942d0fffb848acffb D\nv\n\n\n-----\n\nSHA256 984ce69083f2865ce90b48569291982e786980aeef83345953276adfcbbeece8 D\nv\n\nSHA256 c93e6237abf041bc2530ccb510dd016ef1cc6847d43bf023351dce2a96fdc33b D\nv\n\n## Mapped to MITRE ATT&CK\n\n**The findings of this report are mapped to the following** **[MITRE ATT&CK Matrix](https://attack.mitre.org/)**\n**techniques:**\n\nTA0043: Reconnaissance\n\nTA1592: Gather Victim Host Information\nTA0042: Resource Development\n\nT1583: Acquire Infrastructure\nT1587: Develop Capabilities\nTA0040: Impact\n\nT1486: Data Encrypted for Impact\nTA0005: Defense Evasion\n\nT1027: Obfuscated Files or Information\nTA0007: Discovery\n\nT1083: File and Directory Discovery\nTA0009: Collection\n\nT1005: Data from Local System\nTA0011: Command and Control\n\nT1001: Data Obfuscation\nT1041: Exfiltration Over C2 Channel\n\n### Share this with others\n\nTags: [malware,](https://cybersecurity.att.com/blogs/tag/malware) [alien labs,](https://cybersecurity.att.com/blogs/tag/alien+labs) [otx,](https://cybersecurity.att.com/blogs/tag/otx) [ransomware,](https://cybersecurity.att.com/blogs/tag/ransomware) [labs,](https://cybersecurity.att.com/blogs/tag/labs) [linux,](https://cybersecurity.att.com/blogs/tag/linux) [threats,](https://cybersecurity.att.com/blogs/tag/threats) [analysis,](https://cybersecurity.att.com/blogs/tag/analysis) [darkside raas](https://cybersecurity.att.com/blogs/tag/darkside+raas)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-22 - Darkside RaaS in Linux version.pdf"
    ],
    "report_names": [
        "2021-06-22 - Darkside RaaS in Linux version.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535873,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653689833,
    "ts_modification_date": 1653689833,
    "files": {
        "pdf": "https://archive.orkl.eu/a492de96d0b3dcccf2d71f27afde726e0c788387.pdf",
        "text": "https://archive.orkl.eu/a492de96d0b3dcccf2d71f27afde726e0c788387.txt",
        "img": "https://archive.orkl.eu/a492de96d0b3dcccf2d71f27afde726e0c788387.jpg"
    }
}