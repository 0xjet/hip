{
    "id": "ddfca0c9-5934-462e-9e91-d5edf7d04496",
    "created_at": "2023-01-12T14:58:59.228888Z",
    "updated_at": "2025-03-27T02:09:29.429779Z",
    "deleted_at": null,
    "sha1_hash": "29112314351c8ec851eebc6c21c5ea4a4918bd1e",
    "title": "2022-03-25 - Conti Ransomware Attacks Persist With an Updated Version Despite Leaks",
    "authors": "",
    "file_creation_date": "2022-05-28T19:57:11Z",
    "file_modification_date": "2022-05-28T19:57:11Z",
    "file_size": 637302,
    "plain_text": "# Despite Leaks, Conti Ransomware Attacks Persist\n\n**[zscaler.com/blogs/security-research/conti-ransomware-attacks-persist-updated-version-despite-leaks](https://www.zscaler.com/blogs/security-research/conti-ransomware-attacks-persist-updated-version-despite-leaks)**\n\nIn late January 2022, ThreatLabz identified an updated version of Conti ransomware as part\nof the global ransomware tracking efforts. This update was released prior to the massive\nleak of [Conti source code and chat logs on Februrary 27, 2022. The leaks were published](https://twitter.com/ContiLeaks)\nby a Ukrainian researcher after the invasion of Ukraine. However, since these leaks were\npublished, the Conti gang has continued to attack organizations and conduct business as\nusual. While two versions of Conti source code have been leaked, the most recent\nransomware code has not yet been leaked. This blog will highlight the most recent changes\nto the ransomware and how Conti improved file encryption, introduced techniques to better\nevade security software, and streamlined the ransom payment process.\n\n## Technical Analysis\n\nThe most recent Conti update introduced a number of new features and changes to the\nransomware code. Some of these modifications include new command-line arguments that\nare highlighted in bold in Table 1.\n\n\n**Command-Line**\n**Argument**\n\n\n**Description**\n\n\n-log Previously used to log ransomware actions; this functionality has\nbeen removed, but the command-line switch remains an artifact from\nthe previous version\n\n\n-----\n\n-path Start encryption using the specified path as the root directory\n\n-size Size parameter for large file encryption\n\n-mode Encryption mode local (disks) or net (network shares); the all and\n_backups options were removed_\n\n**-user** **Log in to Windows Safe Mode as the specified user**\n\n**-pass** **Log in to Windows Safe Mode as the user with the**\n**corresponding password**\n\n**-safeboot** **Force reboot the system and launch Conti in Windows Safe**\n**Mode**\n\n\n**-**\n**disablesafeboot**\n\n\n**Disable Windows Safe Mode and reboot the system (used after**\n**file encryption occurs in Windows Safe Mode)**\n\n\n-nomutex Previously used to prevent the creation of a mutex; currently unused\n\nTable 1. Conti command-line arguments updated in January 2022\n\nThe functionality for the command-line arguments -log and -nomutex was removed. The\nnew command-line parameters that were added are related to features that enable Conti to\nreboot the system in Windows Safe Mode with networking enabled and then start file\nencryption. By booting in Safe Mode, Conti can maximize the number of files that are\nencrypted, because business applications such as databases are likely not running.\nTherefore, those applications will not have open file handles that could prevent file\nencryption. In addition, many security software applications (e.g., antivirus programs) will\nnot be loaded by default when the system is running in Safe Mode. The ability to encrypt\nfiles in Windows Safe Mode is a feature that has been observed in other ransomware\n[families including REvil and](https://www.bleepingcomputer.com/news/security/revil-ransomware-has-a-new-windows-safe-mode-encryption-mode/) [BlackMatter.](https://chuongdong.com/reverse%20engineering/2021/09/05/BlackMatterRansomware/#safe-mode-reboot)\n\nIf the -safeboot command-line argument is provided together with the -user and -pass\nparameters, Conti will use these values to automatically log in with the specified credentials\nwhen the system is rebooted into Safe Mode. This is performed by setting the registry\nvalues under HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\n_NT\\CurrentVersion\\Winlogon to the following:_\n\n\n-----\n\n```\nAutoAdminLogon 1\nDefaultUserName = <username>\nDefaultDomainName = <computer_name or domain_name>\nDefaultPassword = <password>\n\n```\nThe -user argument is expected to be in the format: <domain_name>\\<username>.\n\nIf the -safeboot command-line argument is passed by itself (without the -user and -pass\nparameters), Conti will search for users that have administrator privileges by searching for\nthe security identifier (SID) prefix S-1-5-21 with the relative identifier (RID) -500.\n\nIf Conti is able to locate an administrator account, Conti will execute the commandcmd.exe\n**/c net user <admin> /active:yes to make sure the account is enabled. Conti will then**\nattempt to change the password for this account to an empty string by executing the\ncommand cmd.exe /c net user <admin> \"\". The corresponding registry values will then be\nset to automatically log in as the administrator in Safe Mode when the system is rebooted.\nFigure 1 shows example registry values set after an administrator account has been set up\nto automatically log in.\n\nFigure 1. Example Windows registry modifications made by Conti to automatically log in as\nan administrator\n\n\n-----\n\nIn order to execute Conti when the system is booted into Safe Mode, a registry value is\ncreated under\n_HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce with_\nthe name *conti and the value <path_to_conti_executable> -disablesafeboot.\n\nConti then executes the command bcedit.exe /set {current} safeboot network and forces\na system reboot by calling the Windows API function ExitWindowsEx(). This will launch\nWindows in Safe Mode with networking enabled as shown in Figure 2. The network mode is\nenabled, so that Conti can still be used to encrypt files on network shares.\n\nFigure 2. Conti booting Windows into Safe Mode with networking enabled to encrypt files\n\nAfter Conti has completed file encryption in Safe Mode, it executes the command\n**bcedit.exe /deletevalue {current} safeboot and reboots the system. Conti's file encryption**\nalgorithms remain the same as previous versions with a per file random 256-bit ChaCha\nsymmetric key. Each file's ChaCha key is protected by a hardcoded victim-specific 4,096-bit\nRSA public key.\n\nThe new Conti update also added the ability to change desktop wallpaper by writing an\nembedded PNG file to C:\\ProgramData\\conti.png. An example of the Conti wallpaper image\nis shown in Figure 3.\n\n\n-----\n\nFigure 3. Conti PNG image used to set the victim’s desktop wallpaper after file encryption\n\nThe feature to change the wallpaper after file encryption is very common among\nransomware families to further attract the attention of victims.\n\nIn order to hinder malware analysis, Conti dynamically resolves most Windows API\nfunctions by using a hash algorithm. In the previous version of Conti, the hash algorithm\nwas Murmur2, while the latest version now uses Murmur3. This produces different hash\nvalues for all API functions that are used by Conti, which may evade security software that\nsearches for the corresponding hash values.\n\nConti also updated the encrypted file extensions to include uppercase and lowercase\ncharacters and numbers. The following file extension examples have been observed in\nrecent Conti samples:\n\n.ZG7Ak\n.wjzPe\n.LvOYK\n.C5eFx\n.fgM9X\n\nThis encrypted file extension modification may be designed to bypass endpoint security\nsoftware that could identify the previous Conti ransomware pattern that used five uppercase\nletters.\n\nConti also updated the ransom note and TOR hidden service URL. An example of a recent\nConti ransom note is shown below:\n\n\n-----\n\n```\nAll of your files are currently encrypted by CONTI strain. If you don t know who we\nare - just \"Google it.\"\nAs you already know, all of your data has been encrypted by our software. \nIt cannot be recovered by any means without contacting our team directly.\nDON'T TRY TO RECOVER your data by yourselves. Any attempt to recover your data\n(including the usage of the additional recovery software) can damage your files.\nHowever,\nif you want to try - we recommend choosing the data of the lowest value.\nDON'T TRY TO IGNORE us. We've downloaded a pack of your internal data and are ready\nto publish it on our news website if you do not respond. \nSo it will be better for both sides if you contact us as soon as possible.\nDON'T TRY TO CONTACT feds or any recovery companies. \nWe have our informants in these structures, so any of your complaints will be\nimmediately directed to us. \nSo if you will hire any recovery company for negotiations or send requests to the\npolice/FBI/investigators, we will consider this as a hostile intent and initiate the\npublication of whole compromised data immediately.\nTo prove that we REALLY CAN get your data back - we offer you to decrypt two random\nfiles completely free of charge.\nYou can contact our team directly for further instructions through our website :\nTOR VERSION :\n(you should download and install TOR browser first https://torproject[.]org)\nhttp://contirec7nchr45rx6ympez5rj...vaeywhvoj3wad[.]onion/<victim_path>\nYOU SHOULD BE AWARE!\nWe will speak only with an authorized person. It can be the CEO, top management,\netc. \nIn case you are not such a person - DON'T CONTACT US! Your decisions and action can\nresult in serious harm to your company! \nInform your supervisors and stay calm!\n\n```\nThe new Conti ransom note is streamlined with a direct link to a victim-specific chat portal.\nPrior versions required a victim to access the portal and then upload their ransom note,\nwhich contained a unique identifier.\n\nThe latest Conti portal contains a landing page that instructs the user to follow the\ninstructions in the README.txt file that is written to disk after file encryption. It no longer\nsupports a victim uploading the ransom note to authenticate as shown in Figure 4.\n\n\n-----\n\nFigure 4. Updated Conti ransom portal landing page\n\n## Conclusion\n\nIn January 2022, Conti introduced new features to bring feature parity with other\nransomware families including the ability to encrypt files in Windows Safe Mode and change\nthe desktop wallpaper. Despite the group's source code and chat logs being leaked online\nin February 2022, Conti continues to conduct ransomware attacks against large\norganizations. ThreatLabz expects the Conti gang to further update the malware and\npotentially rebrand as the source code leaks have damaged their reputation and may lead\nto other criminal groups forking the code.\n\n## Zscaler Cloud Sandbox Detection\n\n\n-----\n\nIn addition to sandbox detections, Zscaler’s multilayered cloud security platform detects\nindicators related to the campaign at various levels with the following threat names:\n\n[Win32.Ransom.Conti](https://threatlibrary.zscaler.com/threats/2f275c0f-a8d4-4820-966f-a131f37214ea)\n\n[Win64.Ransom.Conti](https://threatlibrary.zscaler.com/threats/215301be-0480-4db6-8ed4-317aaf007563)\n\n## Indicators of Compromise\n\nSHA256 Description\n\nfca8d48afa7e5535fb71fd22225e86602d47dcfa5a4924fcbc33aecd9c945847 Conti\nransomware\n\n16cc7519945bace49ef729e69db7d19e00252f2bd559903e1631c8878c2360f4 Conti\nransomware\n\ne6818bf8c6d20501485fc0cc644d33fcea4bd9a3b45c5d61e98317bda5c080c4 Conti\nransomware\n\n182f94d26de58b8b02ddf7223f95d153b5e907fa103c34ed76cae2c816f865f0 Conti\nransomware\n\ne950c625a94ce9e609778fcc86325530774e45572ff58ebc6549e2627941b5cc Conti\nransomware\n\n\n-----\n\n**About ThreatLabz**\nThreatLabz is the security research arm of Zscaler. This world-class team is responsible for\nhunting new threats and ensuring that the thousands of organizations using the global\nZscaler platform are always protected. In addition to malware research and behavioral\nanalysis, team members are involved in the research and development of new prototype\nmodules for advanced threat protection on the Zscaler platform, and regularly conduct\ninternal security audits to ensure that Zscaler products and infrastructure meet security\ncompliance standards. ThreatLabz regularly publishes in-depth analyses of new and\n[emerging threats on its portal, research.zscaler.com.](https://research.zscaler.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-25 - Conti Ransomware Attacks Persist With an Updated Version Despite Leaks.pdf"
    ],
    "report_names": [
        "2022-03-25 - Conti Ransomware Attacks Persist With an Updated Version Despite Leaks.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535539,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653767831,
    "ts_modification_date": 1653767831,
    "files": {
        "pdf": "https://archive.orkl.eu/29112314351c8ec851eebc6c21c5ea4a4918bd1e.pdf",
        "text": "https://archive.orkl.eu/29112314351c8ec851eebc6c21c5ea4a4918bd1e.txt",
        "img": "https://archive.orkl.eu/29112314351c8ec851eebc6c21c5ea4a4918bd1e.jpg"
    }
}