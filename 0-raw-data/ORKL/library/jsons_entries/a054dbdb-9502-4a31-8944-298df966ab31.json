{
    "id": "a054dbdb-9502-4a31-8944-298df966ab31",
    "created_at": "2022-10-25T16:48:20.216949Z",
    "updated_at": "2025-03-27T02:17:05.525873Z",
    "deleted_at": null,
    "sha1_hash": "7baa3b39f072e82717aa554f3434863f7e9edd1f",
    "title": "ELISE: Security Through Obesity",
    "authors": "PWC",
    "file_creation_date": "2016-04-11T03:34:17Z",
    "file_modification_date": "2016-04-11T03:34:17Z",
    "file_size": 1222910,
    "plain_text": "### Keeping CISOs and CIO’s confident about cyber security related issues including threat detection, data protection, breach readiness, security architecture, digital solutions and network security monitoring.\n\n ELISE: Security Through Obesity\n\n23 December 2015\n\n[@michael_yip](https://twitter.com/michael_yip)\n\nBy Michael Yip\n\n## Executive Summary \n\nTaiwan has long been subjected to persistent targeting from espionage motivated threat actors. This blog presents our analysis of one of the latest\nmalware variants targeting individuals in Taiwan, which exhibits some interesting characteristics that can be useful for detecting and defending\nagainst the threat – including the creation of an obese file, weighing in at 500MB, as part of its execution.\n\n## Malware Analysis\n\nThe sample which caught our attention for this analysis is a PowerPoint slideshow file named台灣學生網路援交觀察.pps (translation:\n“Observations on cyber compensated dating among Taiwanese students”). The sample was submitted to VirusTotal on 3rd December 2015 from\nTaiwan and at the time was only detected by 3 out of 54 antivirus vendors as malicious. An exploit for CVE­2014­4114 is also detected and tagged by\nVirusTotal.\n\n**Figure 1: The sample is a PowerPoint file with exploit for CVE­2014­4114 embedded.**\n\n## The initial lure\n\nThe figures below show some of the slides from the slideshow. All the contents in the slideshow are written in Traditional Chinese, which is typically\nused in provinces in Southern China such as Guangdong and Hong Kong, as well as Taiwan. Since the topic of the slideshow relates explicitly to\nTaiwanese and the submission was from Taiwan, we assess the attacker was likely targeting Taiwanese individuals.\n\n**Figure 2: The lure document is a Powerpoint (.pps) slideshow on “Observations into cyber compensated dating (援交) among Taiwanese**\n**students”.**\n\nGiven the use of a malicious document as the initial lure, the delivery method in this campaign is almost certainly spear­phishing.\n\n\n-----\n\nfiles are dropped into the %TEMP% directory: hlwyss.jpg and hlwyss.inf.\n\nBy examining the file header (as shown in Figure 3) of hlwyss.jpg, we can see that the file is in fact a MS­DOS executable:\n\n**Figure 3: File header of hlwyss.jpg shows it's an MS­DOS executable.**\n\n[The hlwyss.inf is an INF file which specifies file system operations required to install the malware (as shown in Figure 4). The use of an](https://msdn.microsoft.com/en-us/library/windows/desktop/aa376858(v=vs.85).aspx)\n\nembedded INF file for malware installation is consistent with the Metasploit implantation of CVE­2014­4114, better known as the ‘Sandworm’\n[vulnerability.](http://www.rapid7.com/db/modules/exploit/windows/fileformat/ms14_060_sandworm)\n\n**Figure 4: Contents of the hlwyss.inf which shows the renaming of hlwyss.jpg to hlwyss.dll and installation of the RunOnce key for malware**\n**execution.**\n\n\n-----\n\n## Installation and execution\n\n[On examining logs produced during execution by ProcessMonitor, we find that aside from following the instructions outlined in the INF file, the](https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx)\nmalware proceeds to perform additional operations to complete its installation. In particular, the malware replicates itself in the\n%AppData%\\Roaming\\Programs folder and names its cloned copy ‘Syncmgr.dll’ (see Figure 5).\n\n**Figure 5: As part of the installation, another DLL called Syncmgr.dll is also created.**\n\nTo ensure persistence on future restarts a Run key is also installed, however, the Run key points to the newly created Syncmgr.dll rather than the\n\noriginal hlwyss.dll.\n\n**Figure 6: Run and RunOnce keys installed to ensure malware execution on boot up.**\n\nPlanting the malware in the user’s AppData\\Roaming folder is also a sign that the attacker was likely to be targeting corporate users as corporate\n\nusers often possess roaming user profiles, a Windows feature that allows users to access their customised Windows environment from different\nmachines.\n\nAs Syncmgr.dll is the main malicious payload, we took a closer look at the file. The malware was compiled on 24th November 2015 and it is a\n\n32­bit DLL. This shows that the sample is recent and indicates the threat actor is currently active.\n\nExamining the PE structure of Syncmgr.dll shows a hidden executable embedded as one of the resources:\n\n**Figure 7: Executable embedded in resource.**\n\n[Once SyncManager.dll is executed, an iexplore.exe process is spawned:](https://digital-forensics.sans.org/media/poster_2014_find_evil.pdf)\n\n**Figure 8: A malicious iexplore.exe process spawned.**\n\n\n-----\n\n**Figure 9: Malware injected into iexplore.exe.**\n\n[By visualising the ProcessMonitor logs in ProcDOT, we see that two more files are created by the malware: WEB2013BW6.DAT and](http://www.procdot.com/faqs.htm)\n60HGBC00.DAT.\n\n\n-----\n\nBy comparing the code constructs between the embedded resource ASDASDASDASDSAD and WEB2013BW6.DAT, we see that they contain the\n\nidentical code, as shown below:\n\n**Figure 11: The embedded resource (left) and WEB2013BW6.DAT have similar code constructs.**\n\nHowever, WEB2013BW6.DAT is over 500MB in size which is significantly larger than ASDASDASDASDSAD which is only 51KB in size:\n\n**Figure 12: Dropped files in AppData\\Roaming\\Programs folder.**\n\nAn examination into the PE structure of WEB2013BW6.DAT shows that a significant amount of junk characters are appended to the foot of the file:\n\n**Figure 13: Padding towards the end of WEB2013BW6.DAT.**\n\nBased on its contents, the .DAT file is likely a component responsible for network communication. ProcMon logs also show that only once the\niexplore.exe process is spawned, that the .DAT file is loaded into the process. Our current hypothesis is that this is component of the malware\n\noften triggers antivirus signatures, and its huge size is an effort by the authors to evade detection.\n\n## Network communications\n\nOnce the malware is executed, a HTTP GET request is sent to showip[.]net in an attempt to find out the victim’s external IP address.\n\n\n-----\n\n**Figure 14: HTTP GET request to showip[.]net.**\n\nAfter obtaining the IP address, the malware then sends out a HTTP GET request to one of three command & control (C2) servers configured in the\nmalware, such as ustar5.PassAs[.]us. The full HTTP headers are as shown in the figure below:\n\n**Figure 15: Network traffic to ustar5.PassAs[.]us generated after the malware is executed.**\n\nThere are two interesting aspects to the observed HTTP traffic. Firstly, the user­agent is hardcoded in the malware and as shown in the above figures,\nthe same user­agent is used in both GET requests. Secondly, the victim IP is stored as the SHO value in the cookie field in the HTTP GET request to\nthe C2 server. Both characteristics are useful for detection the presence of this particular malware.\n\nThe malware is configured to use the following hosts for c2 servers:\n\n**Domain** **IP** **Last seen**\n\n**ustar5.PassAs[.]us** 203.124.14[.]241 03/12/2015\n\n103.193.150[.]33 15/12/2015\n\n**dnt5b.myfw[.]us** 127.0.0.1 15/12/2015\n\n**­** 203.124.14[.]241 ­\n\nAs the malware attempts to establish contact with each of the designated C2 server, the malware also logs the errors in a .tmp log file stored in the\n\n%TEMP% directory:\n\n**Figure 16: Log file generated by the malware during execution logging failed attempts at establishing contact with configured C2s.**\n\n\n-----\n\n## Functionalities\n\nBy examining the code constructs in the malware, we found evidence of the following functions:\n\nFile upload – upload file to server\nFile download – download file to victim machine\nRemote shell – spawn remote shell\nFile system reconnaissance – obtain file metadata data\nProcess enumeration – enumerate running processes\n\nSome of these functionalities are visible in the ASCII strings from the embedded payload ASDASDASDASDSAD:\n\n**Figure 17: Strings from the malware show hints on the functionalities offered by the malware.**\n\n## Association with LOTUS BLOSSOM\n\n\n-----\n\nHowever, network infrastructure is not the only method for attribution. Other useful methods include common tools and techniques used by threat\nactors, as well as any other behavioural patterns in the modus operandi associated with specific threat actors.\n\n[In this case, we believe the sample analysed is associated with the ‘Lotus Blossom’ threat actor based on the following characteristics which are also](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/%20and%20https://media.blackhat.com/us-13/US-13-Yarochkin-In-Depth-Analysis-of-Escalated-APT-Attacks-Slides.pdf)\nseen in other samples associated with the actor:\n\nThe use of Microsoft Office document with content in Traditional Chinese as initial lure and exploit;\nThe targeting of Taiwanese individuals (Taiwan is often the target of the Lotus Blossom group) ;\nThe malware is written in C++ (like most other malware used by the Lotus Blossom threat actor);\n\nThe mention of Loader.dll (a filename referenced in other Elise samples);\n\nThe use of dynamic DNS domains, including use of the same providers;\nThe fixed user­agent Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1) ;\n\nMutex string Global\\{7BDACDEE­8BF6­4664­B946­D00FCFF1FFBA};\n\nThe format of the configuration for the C2 servers (e.g. Server1=%s) ; and;\n\nThe presence of a JSON­like string within the malware matching the following regular expression: \\{\\\"r\\\":\\\"[0­9]\n\n{12}\\\",\\\"l\\\":\\\"[0­9]{12}\\\",\\\"u\\\":\\\"[0­9]{7}\\\",\\\"m\\\":\\\"[0­9]{12}\\\"\\}.\n\nThese relationships are displayed graphically in the Maltego graph below:\n\n**Figure 18: Some overlapping features among related samples, including the sample analysed in this blog­**\n**c205fc5ab1c722bbe66a4cb6aff41190.**\n\n## Conclusion\n\nTaiwan has long been heavily targeted by espionage threat actors and ‘Lotus Blossom’ is one of the most active threat actors currently targeting the\ncountry. The analysis presented in this blog provides an overview of one of their latest malware variants and new network infrastructure associated\nwith the group. The compile time of the sample shows that the malware was compiled in November which indicates that the group is still actively\ntargeting Taiwanese victims.\n\n## Recommendation\n\nTo help detect the presence of the malware described in this blog, we have included both network and host based signatures in the Appendix.\n\n## Further Information\n\nWe specialise in providing the services required to help clients resist, detect and respond to advanced cyber attacks. This includes crisis events such\nas data breaches, economic espionage and targeted intrusions, including those commonly referred to as APTs. If you would like more information on\n\nf th th t di d i thi l t l f l f t g t i t h b ili g th ti t llig @ k\n\n\n-----\n\nMichael Yip | Cyber Threat Detection & Response\n\n+44 (0)20 78043900\n\n[@michael_yip](https://twitter.com/michael_yip)\n\n**Appendix**\nFile descriptions\nBelow table shows the metadata of the file(s) referenced in this blog:\n\n**Sample 1**\n\n**Filename** 台灣學生網路援交觀察.pps\n\n**Filesize (bytes)** 24,1504\n\n**MD5** c205fc5ab1c722bbe66a4cb6aff41190\n\n**Last saved** 2015­12­03 03:45:11\n\n**Architecture Type** ­\n\n**Packer** None\n\n**Comments** This is the initial lure document.\n\n**Sample 2**\n\n**Filename** SyncMgr.dll/hlwyss.dll\n\n**Filesize (bytes)** 156,976\n\n**MD5** 353fc24939bb5db003097a8dd3c0ee7b\n\n**File PE Compile Time** 2015­11­24 04:57:52\n\n**Architecture Type** 32­bit\n\n**Packer** None\n\n**Comments** This is the Elise variant.\n\n**Sample 3**\n\n**Filename** hlwyss.inf\n\n**Filesize (bytes)** 1,136\n\n**MD5** bc179ebf3ca089dc9f3596beea38ab27\n\n**File PE Compile Time** ­\n\n**Architecture Type** ­\n\n**Packer** None\n\n**Comments** This is the INF file used as part of the exploit code.\n\n**Sample 4**\n\n\n-----\n\n**Filesize (kilobytes)** 512,051\n\n**MD5** 3940a839c8f933cbdc17a50d164186fa\n\n**File PE Compile Time** ­\n\n**Architecture Type** ­\n\n**Packer** None\n\n**Comments** This is the malware packed with junk code.\n\n**Sample 5**\n\n**Filename** 60HGBC00.DAT\n\n**Filesize (bytes)** 1292\n\n**MD5** 6fcdc554b71db3f0b46c7722c2a08285\n\n**File PE Compile Time** ­\n\n**Architecture Type** ­\n\n**Packer** None\n\n**Comments** This is an encrypted file object.\n\nIndicators\nBelow are the network indicators referenced in this blog:\n\n**Domain** ustar5.PassAs[.]us\n\n**Domain** dnt5b.myfw[.]us\n\n**IP** 203.124.14[.]241\n\n**IP** 103.193.150[.]33\n\nDetection signatures\nYara\nrule Lightserver_variant_B : Red_Salamander\n\n{\n\nmeta:\n\ndescription = \"Elise lightserver variant.\"\n\nauthor = \"PwC Cyber Threat Operations :: @michael_yip\"\n\nversion = \"1.0\"\n\ncreated = \"2015­12­16\"\n\nexemplar_md5 = \"c205fc5ab1c722bbe66a4cb6aff41190\"\n\ni\n\n\n-----\n\n{12}\\ \\}/\n\n$mutant1 = \"Global\\\\{7BDACDEE­8BF6­4664­B946­D00FCFF1FFBA}\"\n\n$mutant2 = \"{5947BACD­63BF­4e73­95D7­0C8A98AB95F2}\"\n\n$serv1 = \"Server1=%s\"\n\n$serv2 = \"Server2=%s\"\n\n$serv3 = \"Server3=%s\"\n\ncondition:\n\nuint16(0) == 0x5A4D and ($json or $mutant1 or $mutant2 or all of ($serv*))\n\n}\n\nimport \"pe\"\n\nrule Elise_lstudio_variant_B_resource\n\n{\n\nmeta:\n\ndescription = \"Elise lightserver variant.\"\n\nauthor = \"PwC Cyber Threat Operations :: @michael_yip\"\n\nversion = \"1.0\"\n\ncreated = \"2015­12­16\"\n\nexemplar_md5 = \"c205fc5ab1c722bbe66a4cb6aff41190\"\n\ncondition:\n\nuint16(0) == 0x5A4D and for any i in (0..pe.number_of_resources ­ 1) : (pe.resources[i].type_string\n== \"A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00A\\x00S\\x00D\\x00S\\x00A\\x00D\\x00\")\n\n}\n\n[« Why 2015 was the tipping point for cybersecurity | Main | The concept of ‘cyber’ in a criminal world »](http://pwc.blogs.com/cyber_security_updates/2015/12/why-2015-was-the-tipping-point-for-cybersecurity.html)\n\n**Comments**\n\n**Verify your Comment**\n\n**Previewing your Comment**\n\nPosted by: |\nThis is only a preview. Your comment has not yet been posted.\n\nPost Edit\n\nYour comment could not be posted. Error type:\n[Your comment has been saved. Comments are moderated and will not appear until approved by the author. Post another comment](javascript:void 0;)\nThe letters and numbers you entered did not match the image. Please try again.\nAs a final step before posting your comment, enter the letters and numbers you see in the image below. This prevents automated programs from\nposting comments.\nH i bl di hi i ? Vi l\n\n|Post|Edit|\n|---|---|\n\n\nEdit\n\n\n-----\n\nContinue\n\n© 2012­2016 PwC. All rights reserved. PwC refers to the PwC network and/or one or more of its member firms, each of which is a separate legal\n[entity. Please see www.pwc.com/structure for further details.](http://www.pwc.com/gx/en/about/corporate-governance/network-structure.html)\n[Privacy Statement](http://www.pwc.co.uk/who-we-are/privacy-statement.html)\n[Cookies info](http://www.pwc.co.uk/who-we-are/cookies.html)\n[Legal Disclaimer](http://www.pwc.co.uk/who-we-are/legal-disclaimer.html)\n[Provision of Services](http://www.pwc.co.uk/who-we-are/provision-of-services.html)\n[Diversity](http://www.pwc.co.uk/who-we-are/corporate-sustainability/encouraging-diversity.html)\n\n\nContinue\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/xjjieg8w489osjfp4jk7vgum37a6ibro"
    ],
    "report_names": [
        "PWC_ELISE- Security-Through-Obesity(Dec-23-15)"
    ],
    "threat_actors": [
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2fa14cf4-969f-48bc-b68e-a8e7eedc6e98",
            "created_at": "2022-10-25T15:50:23.538608Z",
            "updated_at": "2025-03-27T02:00:55.495551Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "Lotus Blossom",
                "DRAGONFISH",
                "Spring Dragon",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "MITRE:Lotus Blossom",
            "tools": [
                "Elise"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1460345657,
    "ts_modification_date": 1460345657,
    "files": {
        "pdf": "https://archive.orkl.eu/7baa3b39f072e82717aa554f3434863f7e9edd1f.pdf",
        "text": "https://archive.orkl.eu/7baa3b39f072e82717aa554f3434863f7e9edd1f.txt",
        "img": "https://archive.orkl.eu/7baa3b39f072e82717aa554f3434863f7e9edd1f.jpg"
    }
}