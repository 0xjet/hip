{
    "id": "c591c2ad-578e-4fda-bbfe-d53e7636525e",
    "created_at": "2023-01-12T15:03:02.787542Z",
    "updated_at": "2025-03-27T02:05:32.40475Z",
    "deleted_at": null,
    "sha1_hash": "37867370393cc5e9cde37a39435fae22fb004d14",
    "title": "2022-05-02 - AsyncRAT Activity",
    "authors": "",
    "file_creation_date": "2022-05-29T00:53:50Z",
    "file_modification_date": "2022-05-29T00:53:50Z",
    "file_size": 779732,
    "plain_text": "# AsyncRAT Activity\n\n**esentire.com/blog/asyncrat-activity**\n\n[Adversaries don’t work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with](https://www.esentire.com/what-we-do/security-operations-center)\nElite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to\nthreats within minutes.\n\nWe have discovered some of the most dangerous threats and nation state attacks in our\nspace – including the Kaseya MSP breach and the more_eggs malware.\n\nOur Security Operations Centers are supported with Threat Intelligence, Tactical Threat\nResponse and Advanced Threat Analytics driven by our Threat Response Unit – the TRU\nteam.\n\nIn TRU Positives, eSentire’s Threat Response Unit (TRU) provides a summary of a recent\nthreat investigation. We outline how we responded to the confirmed threat and what\nrecommendations we have going forward.\n\n**Here’s the latest from our TRU Team…**\n\n## What did we find?\n\nAsyncRAT impacting a customer in the insurance industry.\n\n\n-----\n\nAsyncRAT is an open-source remote access trojan with varying capabilities including\nremote access, file exfiltration, and keylogging.\neSentire has observed an increase in this threat throughout March and April 2022.\n\n_Figure 1 AsyncRAT's_\n\n_features. Source: GitHub_\nIn this incident, AsyncRAT was delivered via an email containing several layers of files\nto evade email filtering defenses.\n\nThe first layer, a randomly named HTML file was retrieved by the user and\nopened in their browser. The user was prompted to download an embedded ISO\n[file, a defense evasion technique known as HTML smuggling.](https://attack.mitre.org/techniques/T1027/006/)\nThe ISO file was mounted by the victim, revealing an embedded VBS script file.\nThe VBS file was clicked by the user, resulting in PowerShell execution to retrieve\na script from a remote host.\n\n_Figure 2 PowerShell Dropper_\n\n\n-----\n\n[The PowerShell script functionality is similar to what is described here. In summary, the](https://blog.talosintelligence.com/2022/04/asyncrat-3losh-update.html)\nscript:\n\nCreates a working directory under\nC:\\ProgramData\\BQIZGZEFZTIRALVAQROZSD\\.\nWrites helper scripts to the working directory, most named after the directory\nitself.\nCreates a scheduled task called 'BQIZGZEFZTIRALVAQROZSD' to persist on the\ndevice.\nDecodes two embedded binaries. The files are hex encoded and interlaced with\n“+” symbols.\nInjects the AsyncRAT payload into aspnet_compiler.exe.\n\n## How did we find it?\n\nOur Machine Learning PowerShell classifier detected the attempt to retrieve the\nsecond stage PowerShell script.\nOur 24/7 SOC cyber analysts were alerted and investigated.\n\n## What did we do?\n\nOur SOC cyber analysts investigated and confirmed that the activity is malicious.\nIsolated the host on the customer’s behalf to contain this incident in accordance with\nthe customer’s business policies.\n\n## What can you learn from this TRU positive?\n\nAsyncRAT is an open-source project. Successful delivery and infection of AsyncRAT\nrequires layers of obfuscation and code injection.\n\n[We covered this infection chain previously.](https://www.esentire.com/blog/suspected-asyncrat-delivered-via-iso-files-using-html-smuggling-technique)\nThe infection chain requires the user to follow several steps to grant the adversary\ncode execution capabilities. Unfortunately, mounting ISOs or executing scripting files in\nWindows is trivial and similar infection chains are increasingly common.\nLayers of embedded files may thwart email filtering. The malicious payload is only\nretrieved when the user has completed several manual steps.\n\n## Recommendations from our Threat Response Unit (TRU) Team:\n\nAttacks such as this rely on user execution. Using phishing and security awareness\ntraining, increase your employees’ awareness of:\n\nEmail-based attacks (e.g., business email compromise (BEC) attacks),\nparticularly those delivering HTML or ISO files.\nUnknown ISO or script files (VBS, JS). These file types pose a risk and shouldn’t\nbe opened.\n\n\n-----\n\nCreate new Open With parameters for script files (.js, .jse, .hta, .vbs) so they open\nwith notepad.exe. This setting is found in the Group Policy Management Console under\nUser Configuration > Preferences > Control Panel Settings > Folder Options.\n\nBy default, these script files are executed automatically using Windows Script\nHost (wscript.exe) or Microsoft HTML Application host (mshta.exe) when doubleclicked by a user.\nISO files are mounted as a drive when double-clicked by users by default, consider\n[deregistering this file extension in Windows File Explorer.](https://insights.sei.cmu.edu/blog/the-dangers-of-vhd-and-vhdx-files/)\n\n## Ask Yourself...\n\n1. Are your users sufficiently aware of techniques bypassing email filtering?\n2. What level of visibility do you have across your network, endpoint, and overall\n\nenvironment to detect malicious behavior at scale?\n3. Can you respond to remote access malware in a timely manner?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-02 - AsyncRAT Activity.pdf"
    ],
    "report_names": [
        "2022-05-02 - AsyncRAT Activity.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535782,
    "ts_updated_at": 1743041132,
    "ts_creation_date": 1653785630,
    "ts_modification_date": 1653785630,
    "files": {
        "pdf": "https://archive.orkl.eu/37867370393cc5e9cde37a39435fae22fb004d14.pdf",
        "text": "https://archive.orkl.eu/37867370393cc5e9cde37a39435fae22fb004d14.txt",
        "img": "https://archive.orkl.eu/37867370393cc5e9cde37a39435fae22fb004d14.jpg"
    }
}