{
    "id": "66458bb2-b083-4c31-b89c-deb2f55a3f20",
    "created_at": "2023-01-12T15:08:50.5047Z",
    "updated_at": "2025-03-27T02:05:55.969296Z",
    "deleted_at": null,
    "sha1_hash": "76e9d59785d57aa01b44604af7a0a40184262935",
    "title": "2014-06-09 - ZeuS.Maple Variant Targets Canadian Online Banking Customers",
    "authors": "",
    "file_creation_date": "2022-05-28T21:44:32Z",
    "file_modification_date": "2022-05-28T21:44:32Z",
    "file_size": 2470573,
    "plain_text": "# New ZeuS.Maple Variant Targets Canadian Online Banking Customers\n\n**[securityintelligence.com/zeus-maple-variant-targets-canadian-online-banking-customers/](https://securityintelligence.com/zeus-maple-variant-targets-canadian-online-banking-customers/)**\n\n[Home&nbsp/](https://securityintelligence.com/) [Banking & Finance](https://securityintelligence.com/category/topics/banking-financial-services-industry/)\nZeuS.Maple Variant Targets Canadian Online Banking Customers\n\n\nJune 9, 2014\n\n\n-----\n\n[Banking & Finance June 9, 2014](https://securityintelligence.com/category/topics/banking-financial-services-industry/)\nBy [Dana Tamir 5 min read](https://securityintelligence.com/author/dana-tamir/)\nEver since the ZeuS cyber crime toolkit source code leaked in 2011, malware authors have\nused its cogent malware development tools for generating new custom versions of the\nTrojan; examples include the ICE-IX and Citadel variants. Trusteer security research team\nidentified a series of attacks carried out by a new ZeuS variant since January 2014. Seeing\nthat this variant mainly targets customers of Canadian banks, IBM Trusteer security research\nteam has named it “ZeuS.Maple.”\n\nTrusteer researcher Avidan Avraham, who conducted a thorough analysis on the new\nvariant, explains that ZeuS.Maple is a heavily modified version of ZeuS 2.0.8.9. It\nimplements unique browser re-patching techniques (browser patching is a method of stealing\ninformation from browser sessions; re-patching ensures the patch stays in place), an\nalternative naming generation algorithm, different anti-debugging and new anti-VM\ncapabilities. It uses an encrypted configuration stored in the Windows registry, and in order to\nremain stealthy, ZeuS.Maple distribution in the wild is limited and controlled.\n\nAvraham adds that the enhancements introduced in ZeuS.Maple are improvements of known\nZeuS capabilities, but they don’t really add new functionality. This is why it is interesting that\nthe malware author designated this variant as ZeuS version 3.3.6.0 (as seen in the\nconfiguration).\n\n## Dissimulating the Executable in a New Installation Path\n\nMost of the ZeuS-based Trojans generate a randomly named executable file and place it in a\nnewly created folder under a randomly generated name; this makes it difficult to detect the\nfile in the file system. ZeuS.Maple takes a different approach for naming the newly generated\n\n\n-----\n\nfile: First it enumerates the %APPDATA% directory and chooses an existing folder for its\ndropped executable location. It then generates a file name from the combination of the\ndirectory name and a hard-coded string (a few string options exist). The new executable file\nis then dropped in the selected directory.\n\nFor example:\n\nIf the selected directory is c:\\users\\user\\appdata\\roaming\\microsoft\\\n\nAnd the hard-coded string is: ‘win’\n\nThe result will be: c:\\users\\user\\appdata\\roaming\\microsoft\\winmicrosoft.exe\n\nThis technique of dissimulating the malicious executable within existing system paths makes\nthe file look legitimate and enables it to stay stealthy.\n\nThe code used for the dissimulation is shown in Figure 1:\n\n\n-----\n\nAn additional piece of code found in ZeuS.Maple generates an ordinary ZeuS file name\nusing Windows’ GetTickCount (a Windows function used by ZeuS to generate a random file\nname); however, it doesn’t write it to disk. It could be a leftover action from ZeuS source\ncode.\n\n\n-----\n\n## Barriers for Malware Researchers: Anti-VM, Anti-Debugging\n\nMalware researchers will often try to run the malware in a synthetic environment and debug it\nto understand how it operates. ZeuS 2.0 variants are already designed with anti-debugging\nfeatures that make the malware analysis more difficult. In most cases, the variants use wellknown packers that can be easily identified with common tools. ZeuS.Maple uses a unique\npacker that is written in Visual Basic, which is notoriously complex to debug and makes the\nanalysis more difficult.\n\n[In addition, to prevent malware researchers from debugging the malware, ZeuS.Maple](https://securityintelligence.com/new-mobile-security-threats-malware/)\nchecks the value of two known Windows flags: PEB!IsDebuggedFlag and\nPEB!NtGlobalFlags. The code section that checks the flag value seems to be absent at first\nglance, but ZeuS.Maple unpacks this code section right before it uses it. In order to enable\ndebug mode, we had to manipulate the flag value checks during runtime.\n\nThe screenshot below shows the obfuscated code prior to the unpacking function at\nunk_710:\n\n\n-----\n\nAfter the call at unk_710 is completed, the code is readable and executable — see below. It\nis clear that this code section looks for flags inside the PEB and raises an exception if the\nprocess is being debugged.\n\n\n-----\n\nThe new anti-VM capabilities that were added to this variant of ZeuS are not so impressive:\nThe malware simply checks if VMware Tools is installed on the machine (VMware Tools is a\nfree, optional suite of utilities that enhance the performance of the virtual machine’s guest\noperating system and improves management of the virtual machine). To bypass this check,\nmalware researchers can simply uninstall VMware Tools.\n\n## Browser Patching and Web-Injection\n\nZeuS.Maple uses browser patching to implement Web-injection functionality, which facilitates\n[information stealing and financial fraud. Browser patching on its own isn’t new to ZeuS;](https://www.ibm.com/security/solutions/operation-incident-response)\nhowever, ZeuS.Maple is the only variant that also re-patches the browser in order to protect\nits patches and ensure that they stay in place.\n\nIn the figure below, the code repeatedly goes over some function addresses and writes the\npatched function over the function address.\n\n\n-----\n\nImportant patch list on Internet Explorer:\n\n## The Encrypted Configuration\n\nLike other ZeuS variants, ZeuS.Maple’s configuration is stored in the Windows registry.\nHowever, unlike other variants, it uses the executable name, or a GUID format string, as the\nname for the registry key (instead of the regular generated name). The data is encrypted with\nAES-128 instead of RC4 which is commonly used with other ZeuS variants. However this\nisn’t unique since AES-128 has been previously used with other variants. After decrypting\nthe malware configuration, we’ve noticed that the ZeuS version ID is 3.3.6.0, which indicates\nthat this is a brand new variant of ZeuS, as previously mentioned.\n\nAs for the targets, the main targets include 14 leading financial institutions located in\nCanada. In addition, it contains some “universal” attacks on URLs that consist of generic\nstrings for e-commerce targets.\n\nA sample of the financial institutions targeted as seen in the configuration (shown in IBM\nTrusteer’s format):\n\n\n-----\n\nIn addition to the listed financial institutions, ZeuS.Maple targets general e-commerce\ntransactions but looks for URLs that contain strings like: ‘order,’ ‘cart,’ ‘account activity’ and\nmore:\n\n\n-----\n\n## Command and Control Communication\n\nZeuS.Maple uses nginx-based C&C. Each server has the .in DNS suffix, and the\ncommunication is directed to the /www/ folder. The ‘.in’ suffix should be an indicator of the\nlocation of the server (India); however, when looking up the server details, we see it is\nlocated in Russia. The domain is registered under a fake name and address.\n\nThe latest active sample we analyzed communicated with C&C\nb1estchooseweearesame2014.in/www/ – this resolved to the IP address 62.76.190.115 –\n\nThe server IP address seems to be registered to a Russian Internet service provider.\n\n## Conclusion\n\nThe base code of ZeuS 2.0 remains a central source for malware authors as it continues to\nenable the evolution of the ZeuS malware family. The ZeuS.Maple variant provides an\ninteresting example of new and improved methods used by malware developers to bypass\nautomated security controls as well as human malware researchers\n\n\n-----\n\nWe expect this trend to continue as we find more sophisticated, stealthy variants of ZeuS\ntargeting specific geographical regions.\n\n[Read the white paper: Accelerating growth and digital adoption with seamless identity trust](https://www.ibm.com/account/reg/us-en/signup?formid=urx-33205)\n\n[Dana Tamir](https://securityintelligence.com/author/dana-tamir/)\nDirector of Enterprise Security at Trusteer, an IBM Company\n\nDana Tamir is Director of Enterprise Security at Trusteer, an IBM Company. In her role she\nleads activities related to enterprise advanced threat protection ...\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-06-09 - ZeuS.Maple Variant Targets Canadian Online Banking Customers.pdf"
    ],
    "report_names": [
        "2014-06-09 - ZeuS.Maple Variant Targets Canadian Online Banking Customers.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536130,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1653774272,
    "ts_modification_date": 1653774272,
    "files": {
        "pdf": "https://archive.orkl.eu/76e9d59785d57aa01b44604af7a0a40184262935.pdf",
        "text": "https://archive.orkl.eu/76e9d59785d57aa01b44604af7a0a40184262935.txt",
        "img": "https://archive.orkl.eu/76e9d59785d57aa01b44604af7a0a40184262935.jpg"
    }
}