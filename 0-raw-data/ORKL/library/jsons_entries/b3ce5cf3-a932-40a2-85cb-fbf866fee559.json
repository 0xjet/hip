{
    "id": "b3ce5cf3-a932-40a2-85cb-fbf866fee559",
    "created_at": "2023-01-12T15:02:00.976913Z",
    "updated_at": "2025-03-27T02:06:05.880163Z",
    "deleted_at": null,
    "sha1_hash": "1e36ef40c2ee4c28c2b6c1f549796703267f8539",
    "title": "2012-04-18 - DarkMegi rootkit - sample (distributed via Blackhole)",
    "authors": "",
    "file_creation_date": "2022-05-28T17:27:16Z",
    "file_modification_date": "2022-05-28T17:27:16Z",
    "file_size": 615692,
    "plain_text": "# DarkMegi rootkit - sample (distributed via Blackhole)\n\n**[contagiodump.blogspot.com/2012/04/this-is-darkmegie-rootkit-sample-kindly.html](http://contagiodump.blogspot.com/2012/04/this-is-darkmegie-rootkit-sample-kindly.html)**\n\nUpdate April 20, 2012 Kimberly wrote an excellent analysis of this sample. Please go to\n[Stopmalvertising to read](http://stopmalvertising.com/rootkits/analysis-of-darkmegi-aka-npcdark.html)\n\nThis is a \"DarkMegie\" rootkit sample, kindly donated by Hendrik Adrian. Just like described in\nthe McAfee article \"Darkmegi: This is Not the Rootkit Youâ€™re Looking For\" by Craig\nSchmugar, it is anything but quiet and stealthy. In fact, it makes so many system changes\nthat it is hard to cover it all in a quick post.\n\nIndeed, it drops the rootkit components in drivers with the incredible padding to 25MB and\ngenerates a lot of traffic. Unfortunately, I did not have time yet to sort out the mess and\npurpose of all files that this malware creates so I am just posting it here along with sandbox\nresults for you to analyze. If you write a detailed analysis, please share, I will link to.\n\n**File information**\n\n\n-----\n\nSize: 77312\nMD5: 6C8F9658A390C24A9F4551DC15063927\n\n**Download**\n\n[Download (email me if you need the password scheme)](http://www.mediafire.com/?799tdntibvw2nu1)\n[Download the modified / created files and analysis data](http://www.mediafire.com/?71gd6nv5y5cy7x5)\n[Download pcap](http://www.mediafire.com/?71gd6nv5y5cy7x5)\n\n**Malware system changes**\n\n**Sample analysis -by** **[Stopmalvertising](http://stopmalvertising.com/rootkits/analysis-of-darkmegi-aka-npcdark.html)**\n\nC:\\Windows\\System32\\drivers\\com32.sys        9728\n4399b8a60977814197feae67c02a7ac2\nC:\\Windows\\System32\\drivers\\RCX50E3.tmp    26224256\n9f32c51764f579512810b7ab3de1a91a\nC:\\Windows\\System32\\drivers\\com32.sys       26224256\ndd313b92f60bb66d3d613bc49c1ef35e\nC:\\Windows\\System32\\com32.dl              45056\n25cfb72df8a30cbb7e6ee852bc31c50f\nC:\\Windows\\System32\\RCX5B11.tmp          31506432\n2f00e0927c07bc44d9b79ccbe567f398\nC:\\Windows\\System32\\del043.bat             86\n1a1e7855edc0afa6624080d60da8bf44\n\n**[You can download the full detailed sandbox report here](http://www.mediafire.com/view/?gtpsz1b7iot308h)**\n**Traffic**\nIt is as active as a click fraud or DDoS bot but does not fit these categories.\nI am not quite sure what it is doing, please look and us know :)\n\n\n-----\n\nSome of the traffic\n\n[process 8] 65.55.253.27 192.168.254.192 GET\n/c.gif?evt=br&rid=4571d83250544049bfc2ee88060f6bc8\n&exa=&cts=1334748967640&expac=&fk=W&gp=P&optkey=de\n\n\n-----\n\nfault&clid=23A3C63D37E16EEA2397C50633E16E45&cp=def\nault&di=340&pi=7317&ps=95101&mk=en-us&pn=US+HPMSFT\n3Wdefault&pid=6901517&su=http%3A%2F%2Fwww.msn.com%\n2Fdefaultwpe3w.aspx&pageid=690151710&ce=1&hl=cplus\n&cm=head%3Ecb1\n\n[process 8] 65.54.81.211 192.168.254.192 GET\n/i/87/DEC3F3D671E6CC76B09340612A38.jpg\n\n[process 8] 207.46.193.176 192.168.254.192 GET\n\n/action/MSN_Homepage_Remessaging_111808/nc?a=1\n\n[process 8] 207.46.193.176 192.168.254.192 none\n\n[process 8] 208.44.23.25 192.168.254.192 none\n\n[process 8] 208.44.23.25 192.168.254.192 GET\n\n/b?c1=2&c2=3000001&c7=http%3A%2F%2Fwww.msn.com%2F%\n3Focid%3Diehp&c9=&rn=1334748958175\n\n[process 8] 65.55.239.146 192.168.254.192 GET\n/c.gif?udc=true&di=340&pi=7317&ps=95101&lng=en-us&\ntp=http%3A%2F%2Fwww.msn.com%2Fdefaultwpe3w.aspx&ri\nd=4571d83250544049bfc2ee88060f6bc8&rnd=13347489581\n76&rf=&scr=1024x768\n\n[process 8] 65.55.239.146 192.168.254.192 GET\n/c.gif?udc=true&di=340&pi=7317&ps=95101&lng=en-us&\ntp=http%3A%2F%2Fwww.msn.com%2Fdefaultwpe3w.aspx&ri\nd=4571d83250544049bfc2ee88060f6bc8&rnd=13347489581\n76&rf=&scr=1024x768&MUID=23A3C63D37E16EEA2397C5063\n3E16E45&cb=1cd1d576b2f13a0\n\n[process 8] 65.54.81.211 192.168.254.192 GET\n/i/5E/4B835E56AC3C8535DB16275B4BAF4.jpg\n\n[process 8] 65.54.80.242 192.168.254.192 GET\n/i/BB/756A1C963A72E4AFBC36501B512725.jpg\n\n[process 8] 65.54.81.211 192.168.254.192 GET\n/i/E2/F757C6DFF15796123FA81CF7DCCF.jpg\n\n[process 8] 65.55.239.146 192.168.254.192 GET\n/c.gif?udc=true&di=340&pi=7317&ps=95101&lng=en-us&\ntp=http%3A%2F%2Fwww.msn.com%2Fdefaultwpe3w.aspx&ri\n\n\n-----\n\nd=4571d83250544049bfc2ee88060f6bc8&rnd=13347489581\n76&rf=&scr=1024x768&RedC=c.msn.com&MXFR=23A3C63D37\n\nE16EEA2397C50633E16E45\n\n[process 8] 65.55.239.146 192.168.254.192 none\n\n[process 8] 23.66.231.58 192.168.254.192 GET\n/qsonhs.aspx?form=MSN005&q=\n\n[process 8] 23.66.231.58 192.168.254.192 none\n\n[process 8] 65.54.81.185 192.168.254.192 GET\n\n/CIS/77/000/000/000/028/440.swf?fd=www.msn.com\n\n[process 8] 65.54.81.185 192.168.254.192 GET\n/CIS/18/000/000/000/024/175.jpg\n**Automatic scans**\n\n[Virustotal](https://www.virustotal.com/file/a2c176ef3cc343194207e33acc19d5f8cb083a3c387a0404bd8f9d6bd29cfd6f/analysis/)\nSHA256:   a2c176ef3cc343194207e33acc19d5f8cb083a3c387a0404bd8f9d6bd29cfd6f\nSHA1:   c1af1fa6937097762824d0db039777ff35577727\nMD5:   6c8f9658a390c24a9f4551dc15063927\nFile size:   75.5 KB ( 77312 bytes )\nFile name:   DarkMegiSample\nFile type:   Win32 EXE\nTags:   yoda yodaprot\nDetection ratio:   34 / 42\nAnalysis date:   2012-04-17 08:22:42 UTC ( 1 day, 3 hours ago )\nMore details\nAntivirus   Result   Update\nAhnLab-V3   Dropper/Rootkit.77312   20120417\nAntiVir   HEUR/Crypted   20120417\nAntiy-AVL   Trojan/Win32.Agent.gen   20120417\nAvast   Win32:Malware-gen   20120417\nAVG   PSW.Agent.ASED   20120417\nBitDefender   Trojan.Generic.KDV.503006   20120417\nByteHero   -   20120417\nCAT-QuickHeal   TrojanSpy.Agent.bwtk   20120417\nClamAV   PUA.Packed.YodaProt   20120417\nCommtouch   W32/Heuristic-210!Eldorado   20120417\nComodo   TrojWare.Win32.TrojanDownloader.Agent.accn   20120417\nDrWeb   Trojan.PWS.Gamania.34539   20120417\nEmsisoft   Trojan.SuspectCRC!IK   20120417\n\n\n-----\n\neSafe   Suspicious File   20120415\neTrust-Vet   -   20120417\nF-Prot   W32/Heuristic-210!Eldorado   20120416\nF-Secure   Trojan.Generic.KDV.503006   20120417\nFortinet   W32/Agent.BWTK!tr   20120417\nGData   Trojan.Generic.KDV.503006   20120417\nIkarus   Trojan.SuspectCRC   20120417\nJiangmin   TrojanSpy.Agent.uzc   20120417\nK7AntiVirus   Riskware   20120416\nKaspersky   Trojan-Spy.Win32.Agent.bwtk   20120417\nMcAfee   Artemis!6C8F9658A390   20120416\nMcAfee-GW-Edition   -   20120417\nMicrosoft   Trojan:Win32/Meredrop   20120417\nNOD32   a variant of Win32/CsNowDown.C   20120417\nNorman   W32/Troj_Generic.ASBJ   20120416\nnProtect   Trojan/W32.Agent.77312.VC   20120417\nPanda   Generic Trojan   20120416\nPCTools   Downloader.Darkmegi   20120417\nSophos   Mal/Packer   20120417\nSUPERAntiSpyware   -   20120402\nSymantec   Downloader.Darkmegi   20120417\nTrendMicro   Cryp_Yodap   20120417\nTrendMicro-HouseCall   Cryp_Yodap   20120417\nVBA32   TrojanSpy.Agent.bwtk   20120416\nVIPRE   Trojan-Spy.Win32.Agent\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-04-18 - DarkMegi rootkit - sample (distributed via Blackhole).pdf"
    ],
    "report_names": [
        "2012-04-18 - DarkMegi rootkit - sample (distributed via Blackhole).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535720,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653758836,
    "ts_modification_date": 1653758836,
    "files": {
        "pdf": "https://archive.orkl.eu/1e36ef40c2ee4c28c2b6c1f549796703267f8539.pdf",
        "text": "https://archive.orkl.eu/1e36ef40c2ee4c28c2b6c1f549796703267f8539.txt",
        "img": "https://archive.orkl.eu/1e36ef40c2ee4c28c2b6c1f549796703267f8539.jpg"
    }
}