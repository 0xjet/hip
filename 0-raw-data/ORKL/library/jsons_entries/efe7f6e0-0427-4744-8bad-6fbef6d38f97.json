{
    "id": "efe7f6e0-0427-4744-8bad-6fbef6d38f97",
    "created_at": "2022-10-25T16:48:18.503576Z",
    "updated_at": "2025-03-27T02:16:25.56056Z",
    "deleted_at": null,
    "sha1_hash": "c19c3cf6fc7f11ece1d8db1f0eaf19dd9017d91a",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-10-08T08:55:51Z",
    "file_modification_date": "2020-10-08T08:55:51Z",
    "file_size": 3508160,
    "plain_text": "# APT-C-23 group evolves its Android spyware\n\n**[welivesecurity.com/2020/09/30/aptc23-group-evolves-its-android-spyware](https://www.welivesecurity.com/2020/09/30/aptc23-group-evolves-its-android-spyware/)**\n\nSeptember 30, 2020\n\nESET researchers uncover a new version of Android spyware used by the APT-C-23\nthreat group against targets in the Middle East\n\n[Lukas Stefanko](https://www.welivesecurity.com/author/lstefanko/)\n30 Sep 2020 - 11:30AM\n\nWe have discovered a previously unreported version of Android spyware used by APT-C23, a threat group also known as Two-tailed Scorpion and mainly targeting the Middle\nEast. ESET products detect the malware as Android/SpyC23.A.\n\nThe APT-C-23 group is known to have used both Windows and Android components in\nits operations, with the Android components first described in 2017. In the same year,\nmultiple analyses of APT-C-23’s mobile malware were published.\n\nCompared to the versions documented in 2017, Android/SpyC23.A has extended spying\nfunctionality, including reading notifications from messaging apps, call recording and\nscreen recording, and new stealth features, such as dismissing notifications from built-in\nAndroid security apps. One of the ways the spyware is distributed is via a fake Android\napp store, using well-known apps as a lure.\n\n## Timeline and discovery\n\nThe group’s activities were first described by Qihoo 360 Technology in March 2017\n[under the name Two-tailed Scorpion. In the same year, Palo Alto Networks, Lookout and](https://apt.360.cn/orgDetail/27)\n[Trend Micro described other versions of the mobile malware, naming them VAMP,](https://unit42.paloaltonetworks.com/unit42-targeted-attacks-middle-east-using-kasperagent-micropsia/)\n[FrozenCell and GnatSpy, respectively. Lookout published an analysis of another version](https://blog.lookout.com/frozencell-mobile-threat)\n[of the malware, named Desert Scorpion, in April 2018, and at the beginning of 2020,](https://blog.lookout.com/desert-scorpion-google-play)\n[Check Point Research reported new mobile malware attacks attributed to the APT-C-23](https://research.checkpoint.com/2020/hamas-android-malware-on-idf-soldiers-this-is-how-it-happened/)\ngroup.\n\n[In April 2020, @malwrhunterteam tweeted about a new Android malware sample.](https://twitter.com/malwrhunterteam/status/1250735356015714305)\nAccording to the VirusTotal service, no security vendor besides ESET detected the\nsample at the time. In cooperation with @malwrhunterteam, we recognized the malware\n\n\n-----\n\nto be part of the APT-C-23 arsenal.\n\n_Figure 1. VirusTotal detection rate for one of the newly discovered samples_\n\n[In June, 2020, @malwrhunterteam tweeted about another little-detected Android](https://twitter.com/malwrhunterteam/status/1270715368139452416)\nmalware sample, which turned out to be connected to the sample from April. A deeper\nanalysis showed that both the April and June discoveries were both variants of the same\nnew Android malware used by the APT-C-23 group.\n\nFigure 2 shows the timeline of these events.\n\n_Figure 2. Timeline of previously documented APT-C-23 mobile malware and ESET’s 2020_\n\n_investigation_\n\n## Distribution\n\nThanks to information from @malwrhunterteam, we identified a fake Android app store\nused to distribute the malware. At the time of analysis, the “DigitalApps” store, pictured\nin Figure 3, contained both malicious and clean items. The non-malicious items would\nredirect users to another unofficial Android app store, serving legitimate apps. The\nmalware was hidden in apps posing as AndroidUpdate, Threema and Telegram. The\nlatter two of these lures also downloaded the impersonated apps with full functionality\nalong with the malware. This mechanism is described in detail in the Functionality\nsection.\n\n\n-----\n\n_Figure 3. The fake app store serving APT-C-23 spyware_\n\nInterestingly, the downloads were limited by needing to enter a six-digit coupon code, as\nseen in Figure 4. This may be a way to prevent those not targeted by the group from\ninstalling the malware, and hence keep a lower profile. Although we didn’t have a\ncoupon code, downloading the app wasn’t such a problem – all that was needed was to\nappend “/download” to the URL.\n\n\n-----\n\n_Figure 4. The fake app store requiring a coupon code for downloading malware_\n\nThis fake app store is likely just one of the distribution methods used by the threat\ngroup. Our telemetry from 2020 showed samples impersonating apps that were not a\npart of this fake app store.\n\n## ESET telemetry data\n\nAccording to ESET telemetry and VirusTotal data, Android/SpyC23.A has been in the\nwild since May 2019.\n\nIn June 2020, ESET systems blocked this spyware on client devices in Israel. The\ndetected malware samples were disguised as the messaging app “WeMessage”, shown in\nFigure 5.\n\nWhile there is a legitimate messaging app called weMessage on Google Play, as seen in\nFigure 6, the malicious app uses entirely different graphics and doesn’t seem to\nimpersonate the legitimate app other than by appropriating its name. In our research,\nwe haven’t found another app using the same or similar interface as the malicious\nWeMessage app, so it’s possible that the attackers created custom graphics.\n\nWe don’t know how this particular version of the spyware was distributed – the\nmalicious WeMessage app wasn’t offered in the aforementioned fake app store.\n\n\n-----\n\n_Figure 5. Graphics used by the malicious WeMessage app_\n\n\n-----\n\n_Figure 6. The legitimate weMessage app on Google Play_\n\n## Functionality\n\nBased on our research, the malware mainly impersonates messaging apps. The attackers\nmight have chosen this guise to justify the various permissions requested by the\nmalware.\n\n### Installation and permissions\n\n\n-----\n\nBefore installation, Android/SpyC23.A requests a number of invasive permissions,\nincluding taking pictures and videos, recording audio, reading and modifying contacts,\nand reading and sending SMS.\n\nAfter installation, the malware requests a series of additional, sensitive permissions,\nusing social engineering-like techniques to fool technically inexperienced users. These\nadditional permission requests are disguised as security and privacy features:\n\nUnder the guise of “Messages Encryption”, the app requests permission to read the\nuser’s notifications\nUnder the guise of “Private Messages”, the app requests permission to turn off Play\nProtect\nUnder the guise of “Private Video Chat”, the app requests permission to record the\nuser’s screen\n\nThese steps are shown in the video below.\n\n\n-----\n\n-----\n\nAfter the malware is initialized, in most cases, victims are requested to manually install\nthe legitimate app used as a lure (e.g. Threema), which is stored in the malware’s\nresources. While the legitimate app is being installed, the malware hides its presence on\nthe affected device. This way, the victims end up with a functioning app they intended to\ndownload and spyware silently running in the background. In some cases (e.g.\nWeMessage, AndroidUpdate) the downloaded apps did not have any real functionality,\nand only served as bait for installing the spyware.\n\nWhen first launched, the malware starts to communicate with its Command and Control\n(C&C) server. It registers the new victim and sends the victim’s device information to the\nC&C.\n\n## Capabilities\n\nBased on the commands received, Android/SpyC23.A can perform the following actions:\n\nTake pictures\nRecord audio\nRestart Wi-Fi\nExfiltrate call logs\nExfiltrate all SMS messages\nExfiltrate all contacts\nDownload files to device\nDelete files from device\nSteal files with particular extensions (pdf, doc, docx, ppt, pptx, xls, xlsx, txt, text,\njpg, jpeg, png)\nUninstall any app installed on the device\nSteal APK installers of apps installed on device\nHide its icon\nGet credit balance of SIM on device (it can get a balance by making a call to three\ndifferent cellular operators: Jawwal, Wataniya, Etisalat)\n\nThe following features are new in Android/SpyC23.A compared to the previously\ndocumented versions:\n\nRecord screen and take screenshots\nRecord incoming and outgoing calls in WhatsApp\nMake a call while creating a black screen overlay activity (to hide call activity)\nRead text of notifications from selected messaging and social media apps:\nWhatsApp, Facebook, Telegram, Instagram, Skype, Messenger, Viber, imo\n\n\n-----\n\nDismiss notifications from built-in security apps on some Android devices:\n\nSecurityLogAgent notifications on Samsung devices (package name contains\n“securitylogagent”)\nSamsung notifications (package name contains “samsung.android”)\nMIUI Security notifications on Xiaomi devices (package name contains\n“com.miui.securitycenter”)\nPhone Manager on Huawei devices (package name contains\n“huawei.systemmanager”)\nDismiss its own notifications (an unusual feature, possibly used in case of errors or\nwarnings displayed by the malware)\n\n## C&C communication\n\nBesides spying capabilities, the malware’s C&C communication has also undergone an\nupdate. In older versions, the C&C in use was hardcoded and either available in plain\ntext or trivially obfuscated, and thus easier to identify. In the updated version, the C&C is\nwell hidden using various techniques and can be remotely changed by the attacker.\n\nIn this section, we will describe how Android/SpyC23.A retrieves its C&C server.\n\nThe malware uses a native library with three functions. Two of them return opening and\nclosing HTML tags for the title and the third one returns an encrypted string.\n\n_Figure 7. Returned strings from the native library_\n\nThe encrypted string serves two purposes: the first part – before the hyphen (“-”) – is\nused as part of the password to encrypt files extracted from the affected device. The\nsecond part is first decoded (base64) and then decrypted (AES). The decrypted string\nmight, for example, suggest a Facebook profile page for the C&C, but it is still\nobfuscated.\n\n_Figure 8. Decrypted but still obfuscated URL_\n\nSome of the substrings in this string are replaced based on a simple substitution table\nand then the domain part of the apparent URL is replaced.\n\n_Figure 9. Decrypted and deobfuscated URL_\n\n\n-----\n\nFrom this URL, the malware parses the HTML for its title tag.\n\n_Figure 10. Parsing website title to retrieve the C&C server_\n\nThe last step is to replace the first space for a dash and the second one for a dot. With\nthat, obtaining the C&C is done. Such a process allows the malware operators to change\ntheir C&C server dynamically.\n\n_Figure 11. C&C communication_\n\nThe malware’s live C&C servers typically pose as websites under maintenance, all using\nthe same logo, shown in Figure 12.\n\n\n-----\n\n_Figure 12. The malware’s C&C server_\n\n## Conclusion\n\nOur research shows that the APT-C-23 group is still active, enhancing its mobile toolset\nand running new operations. Android/SpyC23.A – the group’s newest spyware version –\nfeatures several improvements making it more dangerous to victims.\n\nTo prevent falling victim to spyware, we advise Android users to only install apps from\nthe official Google Play Store. In cases where privacy concerns, access issues or other\nrestrictions prevent users from following this advice, users should take extra care when\ndownloading apps from unofficial sources. We recommend scrutinizing the app’s\ndeveloper, double-checking the permissions requested, and using a trustworthy and upto-date mobile security solution.\n\n_For any inquiries, contact us at threatintel@eset.com._\n\n## Indicators of Compromise (IoCs)\n\n### ESET detection name\n\nAndroid/SpyC23.A\n\n### Hashes\n\n\n-----\n\n9e78e0647e56374cf9f429dc3ce412171d0b999e\n344f1a9dc7f8abd88d1c94f4323646829d80c555\n56f321518401528278e0e79fac8c12a57d9fa545\n9e1399fede12ce876cdb7c6fdc2742c75b1add9a\n6f251160c9b08f56681ea9256f8ecf3c3bcc66f8\n91c12c134d4943654af5d6c23043e9962cff83c2\n78dd3c98a2074a8d7b5d74030a170f5a1b0b57d4\n1c89cea8953f5f72339b14716cef2bd11c7ecf9a\ne79849c9d3dc87ff6820c3f08ab90e6aeb9cc216\n\n### C&Cs\n\nhttps://linda-gaytan[.]website\nhttps://cecilia-gilbert[.]com\nhttps://david-gardiner[.]website\nhttps://javan-demsky[.]website\n\n### Distribution URL\n\nhttps://digital-apps[.]store\n\n## MITRE ATT&CK techniques\n\n_[This table was built using version 7 of the ATT&CK framework.](https://attack.mitre.org/versions/v7/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\nExecution\n\nPersistence\n\nDefense\nEvasion\n\n\n[T1444](https://attack.mitre.org/versions/v7/techniques/T1444/) Masquerade\nas Legitimate\nApplication\n\n[T1476](https://attack.mitre.org/versions/v7/techniques/T1476/) Deliver Malicious App\nvia Other\nMeans\n\n\nAndroid/SpyC23.A impersonates a legitimate chat\napplication.\n\nSpyC23.A can be downloaded from a malicious alternative app store.\n\n\n[T1575](https://attack.mitre.org/versions/v7/techniques/T1575) Native Code SpyC23.A uses a native method to retrieve an encrypted string to obtain its C&C.\n\n\n[T1402](https://attack.mitre.org/versions/v7/techniques/T1402/) Broadcast\nReceivers\n\n[T1508](https://attack.mitre.org/versions/v7/techniques/T1508) Suppress\nApplication\nIcon\n\n\nSpyC23.A listens for the BOOT_COMPLETED\nbroadcast, ensuring that the app's functionality will\nbe activated every time the device starts.\n\nSpyC23.A hides its icon.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nDiscovery\n\nCollection\n\nCommand\nand\nControl\n\nExfiltration\n\n\n[T1418](https://attack.mitre.org/versions/v7/techniques/T1418) Application\nDiscovery\n\n[T1420](https://attack.mitre.org/versions/v7/techniques/T1420) File and Directory\nDiscovery\n\n[T1426](https://attack.mitre.org/versions/v7/techniques/T1426/) System Information\nDiscovery\n\n[T1433](https://attack.mitre.org/versions/v7/techniques/T1433) Access Call\nLog\n\n[T1432](https://attack.mitre.org/versions/v7/techniques/T1432) Access Contact List\n\n[T1517](https://attack.mitre.org/versions/v7/techniques/T1517) Access\nNotifications\n\n[T1429](https://attack.mitre.org/versions/v7/techniques/T1429) Capture\nAudio\n\n[T1512](https://attack.mitre.org/versions/v7/techniques/T1512) Capture\nCamera\n\n[T1412](https://attack.mitre.org/techniques/T1412) Capture\nSMS\nMessages\n\n[T1533](https://attack.mitre.org/versions/v7/techniques/T1533) Data from\nLocal\nSystem\n\n[T1513](https://attack.mitre.org/versions/v7/techniques/T1513) Screen\nCapture\n\n[T1438](https://attack.mitre.org/versions/v7/techniques/T1438) Alternative\nNetwork\nMediums\n\n[T1437](https://attack.mitre.org/versions/v7/techniques/T1437/) Standard Application Layer Protocol\n\n[T1544](https://attack.mitre.org/versions/v7/techniques/T1544) Remote File\nCopy\n\n[T1532](https://attack.mitre.org/versions/v7/techniques/T1532) Data\nEncrypted\n\n\nSpyC23.A retrieves a list of installed apps.\n\nSpyC23.A retrieves the content of the external storage directory.\n\nSpyC23.A retrieves details about the device.\n\nSpyC23.A exfiltrates call log history.\n\nSpyC23.A exfiltrates the victim’s contact list.\n\nSpyC23.A exfiltrates messages from messaging\nand social media apps.\n\nSpyC23.A can record surroundings and calls.\n\nSpyC23.A can take pictures from the front or rear\ncameras.\n\nSpyC23.A can exfiltrate sent and received SMS\nmessages.\n\nSpyC23.A steals files with particular extensions\nfrom external media.\n\nSpyC23.A can take screenshots.\n\nSpyC23.A can use SMS to receive C&C\nmessages.\n\nSpyC23.A communicates with C&C using HTTPS\nand Firebase Cloud Messaging (FCM).\n\nSpyC23.A can download attacker-specified files.\n\nExtracted data is transmitted in password-protected\nZIP files.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nImpact [T1447](https://attack.mitre.org/versions/v7/techniques/T1447) Delete Device Data\n\n[Lukas Stefanko](https://www.welivesecurity.com/author/lstefanko/)\n30 Sep 2020 - 11:30AM\n\n### Newsletter\n\n Discussion\n\n\nSpyC23.A can delete attacker-specified files from\nthe device.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.09.30.APT%E2%80%91C%E2%80%9123_Android/APT%E2%80%91C%E2%80%9123%20group%20evolves%20its%20Android%20spyware%20_%20WeLiveSecurity.pdf"
    ],
    "report_names": [
        "APT‑C‑23 group evolves its Android spyware _ WeLiveSecurity"
    ],
    "threat_actors": [
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b1979c55-037a-415f-b0a3-cab7933f5cd4",
            "created_at": "2024-04-24T02:00:49.561432Z",
            "updated_at": "2025-03-27T02:00:55.493381Z",
            "deleted_at": null,
            "main_name": "APT-C-23",
            "aliases": [
                "APT-C-23",
                "Arid Viper",
                "Desert Falcon",
                "TAG-63",
                "Grey Karkadann",
                "Big Bang APT",
                "Two-tailed Scorpion"
            ],
            "source_name": "MITRE:APT-C-23",
            "tools": [
                "Micropsia"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "77c08a4a-b3f9-43ee-9d84-04ba572b7564",
            "created_at": "2024-05-01T02:03:07.927023Z",
            "updated_at": "2025-03-27T02:05:17.248836Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SHADYSIDE",
            "aliases": [
                "Arid Viper ",
                "Desert Falcon ",
                "APT-C-23 "
            ],
            "source_name": "Secureworks:ALUMINUM SHADYSIDE",
            "tools": [
                " SpyC23",
                "Micropsia"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1602147351,
    "ts_modification_date": 1602147351,
    "files": {
        "pdf": "https://archive.orkl.eu/c19c3cf6fc7f11ece1d8db1f0eaf19dd9017d91a.pdf",
        "text": "https://archive.orkl.eu/c19c3cf6fc7f11ece1d8db1f0eaf19dd9017d91a.txt",
        "img": "https://archive.orkl.eu/c19c3cf6fc7f11ece1d8db1f0eaf19dd9017d91a.jpg"
    }
}