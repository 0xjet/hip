{
    "id": "ba91a2c2-df3d-4f3a-a269-9900a442c945",
    "created_at": "2023-01-12T14:58:53.356321Z",
    "updated_at": "2025-03-27T02:09:07.879298Z",
    "deleted_at": null,
    "sha1_hash": "21da667b749a60f6c41b4596b618cd9b6bd92296",
    "title": "2020-07-28 - Mirai Botnet Exploit Weaponized to Attack IoT Devices via CVE-2020-5902",
    "authors": "",
    "file_creation_date": "2022-05-28T15:56:51Z",
    "file_modification_date": "2022-05-28T15:56:51Z",
    "file_size": 131998,
    "plain_text": "# Mirai Botnet Attack IoT Devices via CVE-2020-5902\n\n**blog.trendmicro.com/trendlabs-security-intelligence/mirai-botnet-exploit-weaponized-to-attack-iot-devices-via-cve-**\n2020-5902/\n\nJuly 28, 2020\n\n_Update as of 10:00 A.M. PST, July 30, 2020: Our continued analysis of the malware sample_\n_showed adjustments to the details involving the URI and Shodan scan parameters. We made_\n_the necessary changes in this post. We would like to thank F5 Networks for reaching out to_\n_us to clarify these details._\n\n[Following the initial disclosure of two F5 BIG-IP vulnerabilities on the first week of July, we](https://support.f5.com/csp/article/K52145254)\ncontinued monitoring and analyzing the vulnerabilities and other related activities to further\n[understand their severities. Based on the workaround published for CVE-2020-5902, we](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5902)\n[found an internet of things (IoT) Mirai botnet downloader (detected by Trend Micro](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/internet-of-things/securing-routers-against-mirai-home-network-attacks)\nas [Trojan.SH.MIRAI.BOI) that can be added to new malware variants to scan for exposed](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/trojan.sh.mirai.boi)\nBig-IP boxes for intrusion and deliver the malicious payload.\n\nThe samples we found also try to exploit recently disclosed and potentially unpatched\nvulnerabilities in commonly used devices and software. System administrators and\nindividuals using the related devices are advised to patch their respective tools immediately.\n\n**Routine**\n\n\n-----\n\n[As previously reported, the security bug involves a remote code execution (RCE)](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/vulnerabilities-and-exploits/patch-now-f5-vulnerability-with-cvss-10-severity-score)\nvulnerability in the management interface of BIG-IP known as the Traffic Management User\n[Interface (TMUI). After analyzing the published information, we noticed from the mitigation](https://github.com/f5devcentral/f5-azure-saca/commits/master/SACAv2/STIG/bigipstig.sh)\nrule in Apache httpd that a possible way to exploit this vulnerability involves a HTTP GET\nrequest containing semicolon character in the URI. In a Linux command line, a semi-colon\nsignals to the interpreter that a command line has finished, and it is a character the\nvulnerability needs to be triggered. To further our analysis, we tested if an IoT botnet author\ncan add a scanning capability to existing and/or new malware variants via this Yara rule:\n\nYara rule to check for malware Figure 1. Yara rule to check for malware\nWhile the rule used for testing seems simple, it allowed us a broad range of malware,\nPython, or Ruby proofs of concept (PoC) to check against. From the disclosure date of July\n1, we found the first sample of an ELF file compiled to an MIPS architecture on July 11 that\nidentified two addresses: hxxp[:]//79[.]124[.]8[.]24/bins/ (identified as the disease vector) and\nhxxp[:]//78[.]142[.]18[.]20 (identified as the command and control (C&C) server). A common\npattern with IoT malware like Mirai is finding different files hosted in one domain with different\nextensions meant to attack different architectures. Upon checking the host, we found the\nfollowing files:\n\nTable 1. Files hosted in the C&C\n\n**Hash** **File**\n\nacb930a41abdc4b055e2e3806aad85068be8d85e0e0610be35e784bfd7cf5b0e fetch.sh\n\n037859323285e0bbbc054f43b642c48f2826924149cb1c494cbbf1fc8707f942 sora.arm5\n\n55c4675a84c1ee40e67209dfde25a5d1c1979454ec2120047026d94f64d57744 sora.arm6\n\n03254e6240c35f7d787ca5175ffc36818185e62bdfc4d88d5b342451a747156d sora.arm7\n\n204cbad52dde24ab3df41c58021d8039910bf7ea07645e70780c2dbd66f7e90b sora.m68k\n\n3f8e65988b8e2909f0ea5605f655348efb87565566808c29d136001239b7dfa9 sora.mips\n\n15b2ee07246684f93b996b41578ff32332f4f2a60ef3626df9dc740405e45751 sora.mpsl\n\n0ca27c002e3f905dddf9083c9b2f8b3c0ba8fb0976c6a06180f623c6acc6d8ca sora.ppc\n\necc1e3f8332de94d830ed97cd07867b90a405bc9cc1b8deccec51badb4a2707c sora.sh4\n\ne71aca778ea1753973b23e6aa29d1445f93dc15e531c706b6165502d6cf0bfa4 sora.x86\n\nLooking into the IP addresses further, we learned that since June, it had already been used\nto deploy IoT malware, including other Mirai variants.\n\n\n-----\n\nThe [SORA file names have been previously identified as a Mirai variant that can be used for](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/sora-and-unstable-2-mirai-variants-target-video-surveillance-storage-systems)\nbrute-force attacks and the abuse of other vulnerabilities for RCE and unauthorized control\nand management of devices. Meanwhile, fetch.sh is a shell script with the following content:\n\nfetch.sh shellscript Figure 2. fetch.sh shellscript\nfetch.sh connects to http[:]//79[.]124[.]8[.]24/bins/sora.{architecture} to download and execute\nthe applicable malicious binary named “sysctl”. Simultaneously, fetch.sh also creates cron\njobs to enable automatic execution of the downloaded binary.\n\nCreating cron jobs Figure 3. Creating cron jobs\nThe script uses the iptables tool to drop any packets to popularly used transmission control\nprotocol (TCP) ports such as default ports for Telnet, Secure Shell (SSH), and the device\nweb panel (HTTP). This may have two different implications:\n\nNo other malware will have direct access to exposed services in the infected device\nThe device owner will not be able to access the management interface\n\n[This is also reminiscent of implications cited in our recent research paper for the control of](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/internet-of-things/caught-in-the-crossfire-defending-devices-from-battling-botnets)\nIoT devices currently connected.\n\nBy analyzing the x86 sample of this botnet, we realized its attempts at exploiting vulnerable\nBIG-IP boxes as it sends a GET request to the victim port 443/TCP (HTTPS):\n\nGET request for exploit of CVE-2020-5902 Figure 4. GET request for exploit of CVE-20205902\nGiven the severity of the flaw, a simple GET request with a “command” parameter to\ntmshCmd.jsp would be enough to remotely execute a command in an infected device if the\nID path is correctly prepended to it.\n\n**Other exploits abused**\n\nWe also found, upon checking the variant further, that it tries to exploit recently disclosed and\ndiscovered vulnerabilities in randomly generated targets. Here is the full list of exploits used\nby this variant:\n\nTable 2. Other exploits used by other samples\n\n\n**Device** **Vulnerability**\n\nApache Kylin 3.0.1 Command Injection\nVulnerability\n\nAruba ClearPass Policy Manager 6.7.0 Unauthenticated\nRemote Command\nExecution\n\n\n**CVE**\n**Identification**\n\nCVE-20201956\n\nCVE-20207115\n\n\n-----\n\nBig-IP 15.0.0 < 15.1.0.3 / 14.1.0 < 14.1.2.5 /\n13.1.0 < 13.1.3.3 / 12.1.0 < 12.1.5.1 / 11.6.1 <\n11.6.5.1\n\n\nTMUI Remote Code\nExecution\n\n\nCVE-20205902\n\n\nComtrend VR-3033 Command Injection CVE-202010173\n\n\nHP LinuxKI 6.01 Remote Command\nInjection\n\nTenda AC15 AC1900 Remote Code\nExecution\n\nNexus Repository Manager 3 Remote Code\nExecution\n\nNetlink GPON Router 1.0.11 Remote Code\nExecution\n\nNetgear R7000 Router Remote Code\nExecution\n\nSickbeard 0.1 Remote Command\nInjection\n\n**Conclusion and security recommendations**\n\n\nCVE-20207209\n\nCVE-202010987\n\nCVE-2020–\n10204\n\nN/A\n\nN/A\n\nN/A\n\n\nF5 Networks caters to a number of enterprises for networking devices, with BIG-IP as one of\nthe most popular products in use by governments and companies, especially given the\nabrupt work-from-home arrangements today. It affects a wide range of products and\nversions, including the most recently released ones close to the vulnerability’s disclosure\ndate. With CVE-2020-5902 receiving a rating of 10 in the Common Vulnerability Scoring\nSystem (CVSS) v3.0 vulnerability scale, the vulnerability also indicates that the security gap\nitself is easy to abuse online and automate. Moreover, it does not require credentials or\nadvanced coding skills to exploit.\n\n[That said, F5 has already published an informative and detailed mitigation procedure in order](https://support.f5.com/csp/article/K52145254)\nto deny requests containing a semi-colon. To add, while the default settings do not expose\nthe management interface to the public, our Shodan scan showed approximately 7,000\nexposed hosts online (considering the ones listening on ports 443 and 8443 only). By\n“exposed” we mean “accessible from the Internet”, but not with certainty that the said hosts\nare vulnerable.\n\nRecognizing the severity of the security flaw, the Department of Defense’s Cyber Command\nissued a [tweet three days after the disclosure, advising immediate remediation of the](https://twitter.com/CNMF_CyberAlert/status/1279151966178902016)\nvulnerability. Given the vulnerability’s disclosure date and the number of days it took for an\nexploit to be at large (10 days), it appears as if the malicious actors are paying close\n\n\n-----\n\nattention to the most recent disclosures and reports to come up with their own exploits. While\nsome of these vulnerabilities were only discussed in blog posts and not announced as\npublicly available exploit codes, these cybercriminals are aware of two things: first,\nmanufacturers have yet to come up with the corresponding patches, and second, system\nadministrators have yet to download and implement the released fixes in the equivalent\nduration.\n\nSystem administrators and security teams can protect IoT devices from these types of\nthreats with some of these best practices:\n\nEnsure that IoT devices’ firmware run on the latest versions by constantly monitoring\nmanufacturers’ releases.\nUse a virtual private network (VPN) to prevent exposing any management interfaces\ndirectly to the internet.\nEmploy network segmentation to limit the spread of infections and customize the\nsecurity settings of devices.\nEnsure that there is a network traffic monitoring and detection system with a good Web\nApplication Firewall (WAF) in place. This is to track baseline and abnormal ranges of\nusage to protect management interfaces that are accessible online.\nInstall a multilayered protection system that can detect, block, and prevent threats such\nas brute-force attacks that abuse security flaws like these for entry.\n\nConnected devices can also be protected by security software such as the Trend Micro™\nHome Network Security and [Trend Micro™ Home Network Security SDK solutions, which](https://blog.trendmicro.com/en_us/business/products/iot/home-network-security-sdk.html)\ncan check internet traffic between the router and all connected devices as well as help users\nasses for vulnerabilities.\n\n**Indicators of Compromise (IOCs)**\n\n[Please see the complete list of IoCs here.](https://documents.trendmicro.com/assets/IoCs_Appendix_Mirai-Botnet-Exploit-Weaponized-to-Attack-IoT-Devices-via-CVE-2020-5902.pdf)\n\nExploits & Vulnerabilities\n\nBased on the workaround published for CVE-2020-5902, we found a Mirai botnet\ndownloader that can be added to new malware variants to scan for exposed Big-IP boxes for\nintrusion and deliver the malicious payload.\n\nBy: Fernando Merces, Augusto Remillano II, Jemimah Molina July 28, 2020 Read time: (\nwords)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-28 - Mirai Botnet Exploit Weaponized to Attack IoT Devices via CVE-2020-5902.pdf"
    ],
    "report_names": [
        "2020-07-28 - Mirai Botnet Exploit Weaponized to Attack IoT Devices via CVE-2020-5902.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "acd789fa-d488-47f3-b9cc-fdb18b1fa375",
            "created_at": "2023-01-06T13:46:39.332092Z",
            "updated_at": "2025-03-27T02:00:03.053179Z",
            "deleted_at": null,
            "main_name": "HAZY TIGER",
            "aliases": [
                "Orange Yali",
                "TA397",
                "T-APT-17",
                "APT-C-08"
            ],
            "source_name": "MISPGALAXY:HAZY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535533,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653753411,
    "ts_modification_date": 1653753411,
    "files": {
        "pdf": "https://archive.orkl.eu/21da667b749a60f6c41b4596b618cd9b6bd92296.pdf",
        "text": "https://archive.orkl.eu/21da667b749a60f6c41b4596b618cd9b6bd92296.txt",
        "img": "https://archive.orkl.eu/21da667b749a60f6c41b4596b618cd9b6bd92296.jpg"
    }
}