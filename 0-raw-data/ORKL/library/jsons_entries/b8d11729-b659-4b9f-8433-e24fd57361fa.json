{
    "id": "b8d11729-b659-4b9f-8433-e24fd57361fa",
    "created_at": "2023-01-12T15:09:00.092269Z",
    "updated_at": "2025-03-27T02:06:11.039268Z",
    "deleted_at": null,
    "sha1_hash": "271ccf7d1fe6280cc914b55a7ae6568bd41e3911",
    "title": "2018-05-11 - Attackers Exploit DLL Hijacking to Bypass SmartScreen",
    "authors": "",
    "file_creation_date": "2022-05-28T17:44:54Z",
    "file_modification_date": "2022-05-28T17:44:54Z",
    "file_size": 178410,
    "plain_text": "# Attackers Exploit DLL Hijacking to Bypass SmartScreen\n\n**[socprime.com/en/news/attackers-exploit-dll-hijacking-to-bypass-smartscreen/](https://socprime.com/en/news/attackers-exploit-dll-hijacking-to-bypass-smartscreen/)**\n\nMay 11, 2018\n\nDelaware, USA – May 11, 2018 – DLL Hijacking technique has long been known remaining\neffective enough to bypass some of the security solutions, so attackers used it in new\n[malware. ElvenPath analyzed banking trojan N40, used in a recent campaign against](http://blog.en.elevenpaths.com/2018/05/new-report-malware-attacks-chilean.html)\n[Chilean banks. This malware is the evolved Brazilian banking trojan used in attacks last fall.](https://blog.talosintelligence.com/2017/09/brazilbanking.html)\nAdversaries can use it to gain access to an infected system, steal credentials and valuable\ndata, as well as to replace bitcoin wallet in victim’s clipboard. Trojan uses unusual techniques\nto avoid detection by security tools. To bypass Windows SmartScreen, the first stage\nmalware drops the legitimate WMnat.exe file to the attacked system, then saves to the same\nfolder shfolder.dll, which in fact is N40 trojan renamed and signed with a digital certificate\npurchased in the Black market. After that, the downloader runs WMnat.exe that loads trojan\ninto memory, and Windows SmartScreen only detects execution of a legitimate application.\nMalware bypasses many signature-based anti-virus solutions, uses real-time string decoding\ntechniques to hide in system memory and uses non-standard ports to communicate with\nCommand & Control servers.\n\nThe researchers did not mention how the attackers spread N40 banking trojan but noted that\nthreat actors behind this campaign are successful, and this evolved malware is efficient\nagainst standard solutions used in the banking sector. To detect exploiting of DLL Hijacking\n\n\n-----\n\n[technique, you can use ArcSight with File Hash Analytics use case, which can quickly find](https://my.socprime.com/en/integrations/file-hash-analytics-arcsight)\nfiles with the same name, but different hashes.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-11 - Attackers Exploit DLL Hijacking to Bypass SmartScreen.pdf"
    ],
    "report_names": [
        "2018-05-11 - Attackers Exploit DLL Hijacking to Bypass SmartScreen.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536140,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1653759894,
    "ts_modification_date": 1653759894,
    "files": {
        "pdf": "https://archive.orkl.eu/271ccf7d1fe6280cc914b55a7ae6568bd41e3911.pdf",
        "text": "https://archive.orkl.eu/271ccf7d1fe6280cc914b55a7ae6568bd41e3911.txt",
        "img": "https://archive.orkl.eu/271ccf7d1fe6280cc914b55a7ae6568bd41e3911.jpg"
    }
}