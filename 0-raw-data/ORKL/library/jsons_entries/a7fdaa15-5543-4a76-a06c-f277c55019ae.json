{
    "id": "a7fdaa15-5543-4a76-a06c-f277c55019ae",
    "created_at": "2023-01-12T15:02:45.062317Z",
    "updated_at": "2025-03-27T02:05:56.121771Z",
    "deleted_at": null,
    "sha1_hash": "77b1d8139187aa218935aa3e0091feea3cfa92a3",
    "title": "2021-07-04 - Babuk Ransomware- The Builder",
    "authors": "",
    "file_creation_date": "2022-05-28T17:55:07Z",
    "file_modification_date": "2022-05-28T17:55:07Z",
    "file_size": 1418433,
    "plain_text": "# Babuk Ransomware: The Builder\n\n**[marcoramilli.com/2021/07/05/babuk-ransomware-the-builder/](https://marcoramilli.com/2021/07/05/babuk-ransomware-the-builder/)**\n\nView all posts by marcoramilli July 5, 2021\n\nOn April 2021, one of the most known Ransomware Gang called Babuk, decided to change the\nway they ask for ransom: no more double extortion, no more file encryption but just data\nexfiltration and a later announcement in case of no deal with the victim. It’s a nice move forward\nfor a Ransomware Gang that, as far as I know, followed the Maze Group double extortion\n[paradigm since 2019. This is what reported on BleepingComputer (HERE) on April.](https://www.bleepingcomputer.com/news/security/babuk-quits-ransomware-encryption-focuses-on-data-theft-extortion/)\n\n“Babuk changes direction, we no longer encrypt information on networks, we will get to\nyou and take your data, we will notify you about it if you do not get in touch we make an\nannouncement” – Babuk ransomware\n\n_Babuk Ransomware Gang_\n\nAt the end of April, Babuk gang decided to definitely close their malicious operations making\ntheir Babuk Ransomware opensource, but so far no code was shared to the community.\n\nMany Babuk ransomware where disclosed and analyzed during the following weeks, but when I\nsaw this (reference follows) sample called “builder” with static signatures that reminded me the\nBabuk Ransomware, I decided to take a closer look checking if it definitely was the Babuk\nbuilder.\n\nOne-Time\nMonthly\n\n**Make a one-time donation**\n\n**Make a monthly donation**\n\nChoose an amount\n\n$1.00\n$5.00\n$10.00\n$5.00\n$15.00\n$100.00\n\n\n-----\n\nIf you think this content is helpful, please consider to make a little donation. It would help me in\nbuilding and writing additional contributions to community. By donation you will contribute to\ncommunity as well. Thank you !\n\nIf you think this content is helpful, please consider to make a little donation. It would help me in\nbuilding and writing additional contributions to community. By donation you will contribute to\ncommunity as well. Thank you !\n\n[DonateDonate monthly](https://subscribe.wordpress.com/memberships/?blog=155480246&plan=10519&lang=en_US&pid=10095&redirect=https%3A%2F%2Fmarcoramilli.com%2F2021%2F07%2F05%2Fbabuk-ransomware-the-builder)\n\n**Builder Analysis**\n\nSo, let’s take a closer look to this sample called `builder matching signature from Babuk`\nRansomware. Sha256:\n```\n4fa565cc2ebfe97b996786facdb454e4328a28792e27e80e8b46fe24b44781af, from the time\n\n```\nof the analysis, the sample is recognized as malicious from 8 (over 68) AV vendors. I believe it\nis a nice starting point to investigate our building chain ;).\n\nBabukRansomwareBuilder on VT\n\nGiven Name builder.bin\n\nSHA256 4fa565cc2ebfe97b996786facdb454e4328a28792e27e80e8b46fe24b44781af\n\nTechnology Microsoft C/C++\n\nBehavior Ransomware Builder\n\nThe sample appears to be not packed. It means that on building chain the attacker need to use\nan external packer. It might underline a non sophisticated developer chain, in other words, the\ndeveloper may have no expertise building packers or he/she decided to use external\nobfuscators/packers during the delivery phase of the derivated artifacts. The `builder is a CLI`\nutility asking for a folder. Once you give a folder name it firstly check if the folder exists, and if it\ndoesn’t, the sample creates it. It later builds up the pair keys by using elliptic curve algorithm\nwith a randomly generated 256 key size.\n\n\n-----\n\nPrivate and Public Elliptic Curve Keys\n\nRandom Key Generation For Elliptic Curve 32×8 (256) Key\nAfter the key generation phase the builder saves such a keys inside the given folder in two\nseparated files : `kp.curve25519 and` `ks.curve25519 which are public and secret`\nparameters for the Montgomery curve. The builder then checks for components in the current\nfolder in order to build the output samples. The needed components are:\n```\n   note.txt : a simple text file wrapping ransom note.\n   e_esxi.out, e_nas_x86.out, e_nas_arm.out, e_win.bin : specific encryption\n\n```\npayloads for different targets (ESXI, NAS and Windows Machines)\n\n\n-----\n\n```\n   d_esxi.out, d_nas_x86.out, d_nas_arm.out, d_win.bin : specific decryption\n\n```\npayloads for different targets (ESXI, NAS and Windows Machines)\n\nThe following image shows the main builder function in where it looks for external files\n(representing payloads) and saves them on local hard drive ready to be implemented into the\nvictims system.\n\n\n-----\n\nBabuk main building function\n\n\n-----\n\nThe ransomware generation is a simple process. It firstly takes the external payload and it later\nstarts a `lstrcp (which is dynamically loaded) to copy the exernal payload to files,`\nimplementing the final ransomware. The following image shows the main saving function.\n\nMain Saving Function\nThe following images show the variables wrapping out the file name (on the left) and the result\nof the “stringCopy” function (on the right) before saving them to the hard drive.\n\nOnce the building function terminates its run the user (actually the attacker) finds the given\nfolder full of ransomware ready to be deployed to victims. The following image shows the built\nransomware which happens to be ready to be spread on `Windows system,` `Linux systems`\non `ESX and specific` `NAS within ARM core.`\n\n\n-----\n\nFinal Built Folder\n\n**Conclusion**\n\nBabuk Builder looks like to be a quite simple piece of code. But even if it’s a simple code it\nholds some interesting characteristics which could be helpful to compare to future builders. For\nexample the loading sections and the way the builder uses the `lstrcp function to copy the`\nloaded payloads. The main building loop and the used algorithm to generate key-pairs.\n\n**Name** **Sha256**\n\nd_esxi.out a7a832dd999f4d147087231731ac040be03a26859cfc03f948b092b5a8c259d6\n\nd_nas_arm.out fa2b76dde88f2306b280586b5cf40671f4f08b83e9e095f7d52608e6ed1dd7bf\n\nd_nas_x86.out 45b26897e7d81f2e1905cbb3d227a94bc7991f14a4a24f4aa4752083602be41e\n\nd_win.exe 0221b06e7aa462206039db6366bee9b31838d736dff9145ee54811e2abee7128\n\ne_esxi.out 1afd6bbf62fa0906da0fc4ebd55bf7339aeb3d8beb539df9be4d016efabf3a12\n\ne_nas_arm.out 1a3b213f0303ff5f676df39217abae197f8af689de4c884cd0acc96aedb1a328\n\ne_nas_x86.out af2727be8ff8eb40b4e6eb0ba3c3d0594e4e902e698875a0ef4e3a4ef06f2a86\n\ne_win.exe 3d554fe3ed824df5bb625bcff4ddde834866164088358ddabc4e5aec8a6562b0\n\nBabuk Builder IoC\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-04 - Babuk Ransomware- The Builder.pdf"
    ],
    "report_names": [
        "2021-07-04 - Babuk Ransomware- The Builder.pdf"
    ],
    "threat_actors": [
        {
            "id": "b584b10a-7d54-4d05-9e21-b223563df7b8",
            "created_at": "2022-10-25T16:07:24.181589Z",
            "updated_at": "2025-03-27T02:02:10.134233Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "ETDA:SideCopy",
            "tools": [
                "ActionRAT",
                "AllaKore",
                "Allakore RAT",
                "AresRAT",
                "Bladabindi",
                "CetaRAT",
                "DetaRAT",
                "EpicenterRAT",
                "Jorik",
                "Lilith",
                "Lilith RAT",
                "MargulasRAT",
                "ReverseRAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "187a0668-a968-4cf0-8bfd-4bc97c02f6dc",
            "created_at": "2022-10-27T08:27:12.955905Z",
            "updated_at": "2025-03-27T02:00:55.41311Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [
                "SideCopy"
            ],
            "source_name": "MITRE:SideCopy",
            "tools": [
                "AuTo Stealer",
                "Action RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a4f0e383-f447-4cd6-80e3-ffc073ed4e00",
            "created_at": "2023-01-06T13:46:39.30167Z",
            "updated_at": "2025-03-27T02:00:03.045082Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "MISPGALAXY:SideCopy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535765,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653760507,
    "ts_modification_date": 1653760507,
    "files": {
        "pdf": "https://archive.orkl.eu/77b1d8139187aa218935aa3e0091feea3cfa92a3.pdf",
        "text": "https://archive.orkl.eu/77b1d8139187aa218935aa3e0091feea3cfa92a3.txt",
        "img": "https://archive.orkl.eu/77b1d8139187aa218935aa3e0091feea3cfa92a3.jpg"
    }
}