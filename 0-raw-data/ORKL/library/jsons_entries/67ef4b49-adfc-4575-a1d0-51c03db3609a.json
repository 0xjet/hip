{
    "id": "67ef4b49-adfc-4575-a1d0-51c03db3609a",
    "created_at": "2023-01-12T15:01:01.258651Z",
    "updated_at": "2025-03-27T02:06:05.477325Z",
    "deleted_at": null,
    "sha1_hash": "b3ea07fdfd338070060c3a243f4b5083ab551544",
    "title": "2015-03-04 - And you get a POS malware name...and you get a POS malware name....and you get a POS malware name....",
    "authors": "",
    "file_creation_date": "2022-05-28T04:55:17Z",
    "file_modification_date": "2022-05-28T04:55:17Z",
    "file_size": 1080282,
    "plain_text": "# And you get a POS malware name...and you get a POS malware name....and you get a POS malware name....\n\n**[brimorlabsblog.com/2015/03/and-you-get-pos-malware-nameand-you-get.html](https://www.brimorlabsblog.com/2015/03/and-you-get-pos-malware-nameand-you-get.html)**\n\nThis morning I woke up to find Trend Micro/Trend Labs had a new post on an \"old\nundetected PoS malware\" which they have called \"PwnPOS\". I was interested at first, but\nthis looks like just another case of randomly assigning names to malware and/or threat\nactors. Unfortunately for the folks at Trend, who usually put out pretty good work, the scraper\nin question (which is an executable file that I have personally seen with many names, but we\nwill refer to it as \"wnhelp.exe\") is old. Very, very old. In fact, the date/time stamp embedded\ninto the file itself is from 2010.\n\n\n-----\n\n_wnhelp as seen in PEStudio 8.46_\n\nThe scraper is very basic, it looks through memory looking for Track data, and when it finds\nmatching data, it saves it to a file \"perfb419.dat\" which is under the Windows/System32\nfolder. There are sometimes legitimate files with similar names under this path, no doubt it\nwas an effort for the attackers to try to make the data blend in.\n\n_Example of \"track\" data collected in perfb419.dat._\n\nThe scraper itself does not have an active exfiltration mechanism, so either an additional\nfile(s) is needed to exfil the collected data or the attacker(s) can remotely access the system\nand send the file out (email, ftp, file sharing site, etc). wnhelp uses a \"service\" persistence\nmechanism in order to stay running on the machine, so looking at just CurrentVersion/Run in\n\n\n-----\n\nthe Registry will not allow you to detect the file. The service is named Windows Media\n[Help\", and the information that is collected from the Live Response Collection using](http://www.brimorlabsblog.com/2015/01/gui-logging-compression-and-encryption.html)\n[SysInternals autorunsc is listed below:](https://technet.microsoft.com/en-us/sysinternals/bb963902.aspx)\n\n_wnhelp embedded under the \"Windows Media Help\" service_\n\nThe exfiltration methods listed in the Trend article \"might\" be new, but I cannot be certain as I\npersonally do not have access to those files (yet, I am working on that). I am leery of how\nnew these files may be though, simply based on the liberties that Trend appears to have\ntaken with the original wnhelp file. Additionally, of all the files listed in the Trend post, the\nmost recent compile time is listed as 2012, with most of the compile times dating back to\n2010. None of these files appear to be \"new\" at all.\n\n**Not \"new\" or \"under the radar\"**\n\nBack in 2013, the wnhelp sample was uploaded to malwr, among other sites, to use their\nautomated malware analysis tool.\n\n_malwr results from 2013_\n\n\n-----\n\nAdditionally, a Google search for the md5 hash (c86327222d873fb4e12900a5cadcb849)\nshows that, at the very least, a user of the domain \"systemexplorer.net\" posed a question\nabout wnhelp back in 2012. I did not dig through all of the results, but 83 search results, with\nseveral entries on the first page relating to \"malware\" in one form or another, is hardly flying\n\"under the radar\".\n\n_systemexplorer.net query of wnhelp from 2012_\n\nUPDATE (March 6, 2015): As [@maldr0id pointed out, the wnhelp file was submitted to](https://twitter.com/maldr0id)\n[virustotal back on October 2, 2012, with a 3/42 detection ratio. Interestingly enough, Trend](https://www.virustotal.com/en/file/088f40a7a52635ff19e80c62883977d94dd5835e85739e19504f7437d296760b/analysis/1349186931/)\nMicro was one of the three that detected the file as malicious. The same file was uploaded\n[to virustotal on February 16 2011 At that time it had a 0/43 detection ratio](https://www.virustotal.com/en/file/088f40a7a52635ff19e80c62883977d94dd5835e85739e19504f7437d296760b/analysis/1297865517/)\n\n\n-----\n\n_virustotal results of scraper file, performed on October 2, 2012_\n\n_virustotal results of scraper file, performed on February 16, 2011_\n\nIn the Trend post, the author stated \"PwnPOS is one of those perfect examples of malware\n_thatâ€™s able to fly under the radar all these years\". As you can see from just the examples that_\nare listed above, that statement is simply not true. It does highlight the importance of\nunderstanding \"what\" is running within your POS environment. It also highlights the fact of\nregularly checking systems within your POS environment to make sure that they are running\nproperly and there is nothing \"else\" (malicious or otherwise) running on those systems.\n\n\n-----\n\nSeveral month ago I came across a domain that was hosting this (and other) samples of\nPOS malware. I collected all of the samples and files on the domain. The owners of the\ndomain let the registration lapse a few months ago, at which time I purchased it and redirected it to \"fbi.gov\" (my own way of \"getting back\" at bad actors). If you are interested\n[please feel free to contact me, I will share some of the files with you (I cannot share them all,](http://www.brimorlabs.com/contact/)\nas some of the files contained information that I legally cannot share).\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-03-04 - And you get a POS malware name...and you get a POS malware name....and you get a POS malware name.....pdf"
    ],
    "report_names": [
        "2015-03-04 - And you get a POS malware name...and you get a POS malware name....and you get a POS malware name.....pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535661,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653713717,
    "ts_modification_date": 1653713717,
    "files": {
        "pdf": "https://archive.orkl.eu/b3ea07fdfd338070060c3a243f4b5083ab551544.pdf",
        "text": "https://archive.orkl.eu/b3ea07fdfd338070060c3a243f4b5083ab551544.txt",
        "img": "https://archive.orkl.eu/b3ea07fdfd338070060c3a243f4b5083ab551544.jpg"
    }
}