{
    "id": "bed9e348-b88e-4093-81ea-6a22d0b18886",
    "created_at": "2023-01-12T15:05:24.120409Z",
    "updated_at": "2025-03-27T02:17:05.616901Z",
    "deleted_at": null,
    "sha1_hash": "cd89d9151a61b94b539861359ab73bcd95533ae0",
    "title": "2021-03-30 - Ares Malware- The Grandson of the Kronos Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T19:57:05Z",
    "file_modification_date": "2022-05-28T19:57:05Z",
    "file_size": 850128,
    "plain_text": "# Technical Analysis\n\n**[zscaler.com/blogs/security-research/ares-malware-grandson-kronos-banking-trojan](https://www.zscaler.com/blogs/security-research/ares-malware-grandson-kronos-banking-trojan)**\n\n_Kronos is a banking trojan that first emerged in 2014 and marketed in underground forums as_\na crimeware kit to conduct credit card, identity theft, and wire fraud. In September 2018, a\n[new Kronos variant named Osiris introduced several new features including TOR for](https://www.proofpoint.com/us/threat-insight/post/kronos-reborn)\ncommand and control (C2) communications. The last update to Osiris appears to have been\naround mid-2019. In February 2021, Zscaler ThreatLabz identified a new Kronos variant that\nsurfaced via [spam campaigns to German speakers, which calls itself Ares. In Greek](https://blog.morphisec.com/long-live-osiris-banking-trojan-targets-german-ip-addresses)\nmythology, Ares is the son of Zeus and grandson of Kronos. Thus, the naming convention\nappears to refer to this new malware variant as the third generation of Kronos. Ares\nstill appears to be in development alongside an information stealer that harvests credentials\nfrom various applications including VPN clients, web browsers, and the malware can exfiltrate\narbitrary files and cryptocurrency wallets.\n\nThe threat actor behind this new variant continues to use both Osiris and Ares in parallel. In\nthis blog post, we will examine these new malware developments and campaigns.\n\n## DarkCrypter\n\nRecent samples of Osiris and Ares have been protected by a malware packer written in C++\nthat calls itself DarkCrypter. The packer contains the PDB path\nd:\\scm\\Italy\\dopplegang\\DarkCrypter\\Bin\\Clean.pdb. The code is not related to\n[the commercial packer, DarkCrypter, that has been cracked and leaked online. Interestingly,](https://github.com/0x4xLEAKR/DarkCrypter)\nthe packer shares code with Kronos and Osiris including the string encryption algorithm.\nWhen the string table is decrypted, the first 41 entries are identical to older Kronos variants\nwith eight new string additions (shown below) to detect sandbox environments:\n\n\n-----\n\n```\natcuf32.dll\numengx86.dll\nsandboxie.dll\nlibctc_sandbox.dll\natcuf64.dll\nantimalware_provider32.dll\nantimalware_provider64.dll\nlibctc_onexecute.dll\n\n```\nIf the anti-analysis checks pass, the packer proceeds to the next step. There are at least two\nvariants of the packer.\n\nThe first variant decrypts the next-stage payload using Blowfish. However, the decryption\nprocess uses a non-standard Blowfish key size. Typically, Blowfish key sizes are between 4\nbytes and 56 bytes. However, the Blowfish decryption implementation in DarkCrypter\nsupports a hardcoded key size that is 288 bytes (although only the first 72 bytes are\neffectively used). This may be designed to break cryptographic libraries that implement\nBlowfish and follow the standard, where the maximum key size is limited to 56 bytes. The\nBlowfish key is located by computing a djb2 hash of each section name in the PE header.\nThe code compares the resulting hash value with two hardcoded values that map to the\nsection names .text (0xb80c0d8) and .sjdata (0xecae6faa).\n\nThe second variant of the DarkCrypter packer embeds the second-stage payload in a\ncompressed format rather than an encrypted Blowfish format. The compression algorithm is\nidentical to that found in Ares, and components related to Ares, including a packer\nthat impersonates a bitmap image header.\n\n## Modified UPX Packer\n\nThe threat actor has also experimented with modifying UPX headers, which has well known\nsection names. The modifications that have been made by the threat actor replace the UPX\nsection names (UPX0, UPX1, ...) with standard section names like .text, .data, and .rdata.\nThis breaks compatibility with the command-line UPX decompression tool, although the file\ncan still be decompressed and executed. An example of the file header modifications are\nshown below in Figure 1 on the left, with the alterations highlighted in red.\n\n\n-----\n\nFigure 1. Modified and Restored UPX Headers\n\nThese changes can easily be restored to the original UPX section names as shown on the\nright in Figure 1. The UPX command-line utility can then be used to statically unpack this\nbinary, producing the final executable payload.\n\n## BMPack\n\nThe threat actor has also been using another packer that Zscaler ThreatLabZ has dubbed\nBMPack. This packer has been utilized to pack both Osiris and Ares payloads. BMPack first\ndecrypts embedded data using an XOR-based algorithm, followed by RC4. After the\ndecryption stage, the file appears to be a bitmap image as shown in Figure 2.\n\nFigure 2. Fake Bitmap Image Used to Unpack Osiris and Ares Malware Payloads\n\n\n-----\n\nHowever, a closer inspection reveals that the data is not actually a bitmap image, but has a\nspecific sequence of data structures. By reverse engineering the packer, the format of the\ndata structures can be determined, which consist of three DWORD values that represent the\ncompressed size (red), uncompressed size (green), next offset (blue), followed by the\ncompressed data (orange). An example of the first data structure is shown below in Figure 3.\n\nFigure 3. Format of BMPack Data Structures\n\nEach decompressed structure holds a different section of a PE file that is reconstructed and\nstitched together by a custom loader, and executed.\n\n## Ares Malware\n\nAres is being actively developed and the malware author continues to create and test new\nplugins and web injects. In the most recent Ares samples, there is an embedded DLL module\nthat is compressed within the binary. The module contains an export that is designed to\nestablish persistence. The code first copies itself to the location\n%APPDATA%\\Adobe\\AdobeNotificationUpdates.exe. It then creates a scheduled task named\n_AdobeNotificationUpdates that is designed to execute Ares every two hours (with an_\nexpiration date of 2050-05-02 12:05:00). Similar persistence code is also found in many\nDarkCrypter samples.\n\nThe Ares persistence module has the same compilation prefix as other modules in its PDB\npath D:\\scm\\Italy\\ares\\source_ob\\Release\\startup.pdb. Ares attempts to locate an export\nname with the hash value F4S4G3S4U7C6P2P7, which maps to the\nstring [[email protected]@[email protected]. Once the address of this function is located, Ares](https://www.zscaler.com/cdn-cgi/l/email-protection)\nexecutes the module.\n\nAres uses the same function hashing algorithm as Kronos, which consists of calculating a\nCRC64 hash, converting the digest to uppercase hexadecimal characters. The result is then\nmapped to an alphanumeric value as shown in the Python code below:\n\n\n-----\n\n```\ndigest hexdigest(crc64(function_name)).upper()\nout = \"\"\nfor i in range(len(digest)):\n if i & 1 != 0:\n  val = ord(digest[i]) % 9 + ord('0')\n else:\n  val = ord(digest[i]) % 25 + ord('A')\n out += chr(val)\nreturn out\n\n```\nAres contains most of the same code as its predecessors: Kronos and Osiris. However, there\nare several notable differences between Osiris and Ares, especially with respect to the C2\ncommunications. Most Ares samples currently do not communicate with C2 servers over\nTOR. It is not quite clear, why most Ares samples have the TOR component removed, but it\nmay be to reduce the malware's file size and evade corporate firewalls that block TOR\nnetwork traffic. However, without TOR, the C2 servers are more vulnerable to takedown\nattempts. Some Ares samples attempt to address this limitation by hardcoding a large\nnumber of C2 URLs in the binary. Zscaler ThreatLabz has observed one Ares sample with\n[101 hardcoded C2 URLs.](https://pastebin.com/XU6YfvWG)\n\nAres has also slightly modified the bot ID generation code, replacing the string Kronos with\nthe string Ares as shown in Figure 4.\n\nFigure 4. Comparison Between Kronos and Ares Bot ID Generation\n\nAres uses the HTTP query string parameters shown in Table 1. The HTTP request that sends\nthe report.zip file is unique to Ares and discussed in more detail below.\n\nQuery String Description\n\na=0 Send log data\n\na=1 Download web injects\n\na=2 Send keylogger data\n\n\n-----\n\na=3 Send report.zip file created by Ares Stealer\n\na=4 Request new commands\n\nTable 1. Ares Query String Parameters\n\n### Ares Commands\n\nAres supports many of the same commands as Kronos and Osiris. However, some of the\ncommands have been modified and the malware uninstall command (0x1) was removed.\nThere are four modified commands that are supported by Ares as shown below in Table 2.\n\nCommand Number Description\n\n0x3 Set registry value name MSE to 0\n\n0x4 Set registry value name MSE to 1\n\n0x6 Download, decompress, map Ares Stealer into memory, and execute\n\n0xC Download, decompress, map module into memory, and execute\n\nTable 2. New Commands Introduced By Ares\n\nThe commands 0x3 and 0x4 attempt to set a registry value name MSE to zero and one,\nrespectively, under the registry key\nHKEY_CURRENT_USER\\Software\\Microsoft\\CurrentVersion. However, this registry key\ndoes not exist and both functions will fail. This is likely an oversight by the malware author\nwho accidentally left out Windows in this registry path between Microsoft and CurrentVersion.\nThe registry value is not referenced elsewhere in Ares, so it may hint at a future use.\n\nOne of the most significant modifications is the command 0x6 that downloads,\ndecompresses, and maps a PE file into memory, and executes it. Command 0x6 specifically\nsearches for an export name with the hash value C3E0Q6R7F1H2G5A4, which maps to the\nstring CollectInfo. The code passes two string parameters to the CollectInfo export. The first\nstring is a pattern provided by the C2 server and the second is hardcoded to the string\n%APPDATA%\\Google\\report.zip. Zscaler ThreatLabZ has observed this Ares command\nbeing used to download a file from the URL\nhttp://mydynamite.dynv6[.]net/panel/upload/stealer.dll. The first four bytes of the response are\nthe uncompressed file size. The file is decompressed using the same compression algorithm\nas BMPack.\n\n\n-----\n\nAres has code artifacts from the development of command 0x6. Samples contain an\nunreferenced function that attempts to open a file located at\nd:\\scm\\Italy\\ares\\source_ob\\Binaries\\Release\\KittyDll.dll.cmp. The file is decompressed and\nmapped into memory using the same process as command 0x6. After the file is mapped, the\nexport CollectInfo is called with the parameters: %userprofile%Documents|*.txt|5 and NULL.\nThe purpose of these fields will be described in the next section. Note that there is a\nmissing backslash character between %userprofile% and Documents. This string serves as a\ndirectory path, and without the backslash the path is invalid.\n\nZscaler ThreatLabZ has also identified Ares samples that contain another unreferenced\nfunction that loads a VNC plugin by attempting to open a file located at\nd:\\scm\\Italy\\ares\\\\source_ob\\Binaries\\Release\\vnc.dll.cmp. Similar to the stealer plugin, the\nfile is decompressed, mapped into memory, and the export MakeItStart is called. The\nMakeItStart export name is resolved similar to the other Ares functions using the same\nCRC64-based hash algorithm and comparing the result with F0U5R4R6Q8H1P3E5. Ares\nthen will terminate the VNC plugin by mapping the export name MakeItStop using the same\nprocess and comparing the result with the hash value C6P3T6Q8H1P3E5A8.\n\nThe command 0xC is the most recent modification to Ares and only found in newer samples.\n\n## Ares Stealer\n\nAres Stealer is downloaded by Ares and invoked via the export name CollectInfo. The\nmalware is written in C++ and uses the Boost and Curl libraries. Ares Stealer has compilation\nartifacts showing that the Boost library was compiled in the directory\nd:\\scm\\Italy\\tools\\boost_1_74_0\\boost. This directory prefix is identical to the DarkCrypter’s\nPDB path and the location where the Ares unreferenced test functions attempt to load plugins\nfrom. This artifact along with the shared compression code suggests that the malware author\nlikely has developed DarkCrypter, BMPack, Ares, and Ares Stealer.\n\nThe Ares Stealer export CollectInfo takes two parameters: a pipe-delimited string and a\nfilename string. The pipe-delimited string takes three arguments, which are used by the\nstealer’s file grabber feature. The first parameter is the directory in which to start the file\nenumeration process, the second parameter is a search pattern, and the last parameter is the\ndirectory search depth. The filename string is used to store the results of the extraction,\nwhich are added to a zip file.\n\nAn example command string observed from an Ares C2 server is %userprofile%|pass*.txt|5.\nThis command will search a victim’s user profile directory up to five levels deep for text files\nthat have the prefix pass.\n\nAres Stealer collects detailed system information and harvests credentials for numerous\napplications including FTP clients, VPN clients, web browsers, instant messengers, and email\nclients. It can also steal files, cryptocurrency wallets, cookies, and credit cards.\n\n\n-----\n\nThe stealer will attempt to extract information from the following applications:\n\nFTP clients\n\nFilezilla\n\nVPN clients\n\nNordVPN\nOpenVPN\nProtonVPN\n\nWeb browsers\n\nMozilla Firefox\nGoogle Chrome\nMicrosoft Edge\nMicrosoft Internet Explorer\nChromium\nCyberfox\nBlackHawk\nComodo IceDragon\nCometBird\nSeaMonkey\nPale Moon\nWaterfox\nMail.ru Atom\nChromodo\nUran\nCocCoc\nNichrome\nSputnik\nK-Meleon\nMaxthon 3\n360 Browser\nAmigo\nComodo Dragon\nOrbitum\nQIP Surf\nLiebao\nCoowon\nCatalina Group Citrio\nFenrir Sleipnir\nElements\n\n\n-----\n\nKometa\nChedot\nCentBrowser\n7 Star\nIridium\nMapleStudio ChromePlus\nTorch\nYandex Browser\nEpic Privacy Browser\nOpera\nBrave Browser\nVivaldi\nBlisk\n\nCryptocurrency wallet applications\n\nCoinomi\nGuarda\nAtomic Wallet\nElectrum\nEthereum\nExodus\nBytecoin\nArmory\nZcash\nBitcoin\nLitecoin\n\nInstant messenger clients\n\nPidgin\n\nEmail clients\n\nOutlook\n\n## Osiris\n\nThe Osiris version that has been used by this threat actor contains a number of new features\nsince the original version that appeared in April 2018. These updates were introduced around\nmid-2019 and include the following changes:\n\nNew beacon request format that includes information about the compromised system\nZlib compression to reduce the size of requests and responses (including web injects)\nAbility to deploy TeamViewer on a compromised host\n\n\n-----\n\n[Ability to steal a victim s Outlook contacts via Nirsoft s OutlookAddressBookView utility](https://www.nirsoft.net/utils/outlook_address_book_view.html)\nSend spam emails to a victim’s contact list\nNew remote access capabilities\n\nThe threat actor has an Osiris C2 server that is located at\nhttp://ylnfkeznzg7o4xjf[.]onion/kpanel/connect.php, which has been instructing infected\nsystems to steal and exfiltrate web browser and email credentials. The web browser\nharvesting command downloads a sqlite3 library from\nhttp://qqkzfkax24p4elax[.]onion/kpanel/upload/sqlite3.dll, which is a dependency to extract\nGoogle Chrome passwords. A second module for harvesting Firefox credentials from a 64-bit\nsystem is downloaded from http://qqkzfkax24p4elax[.]onion/kpanel/upload/ffc64.exe.\n\nThe C2 is also serving a web inject configuration file, which targets clients at German\nfinancial institutions with the URL patterns shown below:\n\n**set_url https://*commerzbank.de* GPI**\n\n**set_url https://*.de/*/entry* GPI**\n\n**set_url https://*.de/banking-*/portal?* GPI**\n\n**set_url https://*.de/banking-*/portal;* GPI**\n\n**set_url https://*.de/portal/portal* GPI**\n\n**set_url https://*.de/privatkunden/* GPI**\n\n**set_url https://*.de*abmelden* GPI**\n\n**set_url https://*.de/de/home* GPI**\n\n**set_url https://*.de/en/home* GPI**\n\n**set_url https://*.de/fi/home* GPI**\n\n**set_url https://*banking.sparda.de* GPI**\n\n**set_url https://*banking.sparda-* GPI**\n\n**set_url https://*banking.sparda.de/wps/loggedout.jsp GPI**\n\n**set_url https://*meine.deutsche-bank.de/trxm/db* GPI**\n\n**set_url https://*banking.berliner-bank.de/trxm* GPI**\n\n**set_url https://*meine.norisbank.de/trxm/noris* GPI**\n\n**set url https://*targobank.de* GPI**\n\n\n-----\n\nWhen a victim browses to a website that matches one of these patterns, JavaScript code will\nbe injected from the threat actor’s domain https://securebankingapp[.]com/.\n\n[The full list of web injects for this Osiris instance is shown here.](https://pastebin.com/tTxmjA1K)\n\nThe threat actor has another active Osiris C2 server located at\nhttp://qqkzfkax24p4elax[.]onion/kpanel/connect.php. This C2 server is also serving\ncommands to exfiltrate credentials, but the web inject configuration file is blank. However, the\nC2 server is also providing commands to extract a victim’s email contact list using Nirsoft’s\nOutlookAddressBookView, which is downloaded from the following locations:\n\nhttp://qqkzfkax24p4elax[.]onion/kpanel/upload/oabv32.exe (32-bit)\n\nhttp://qqkzfkax24p4elax[.]onion/kpanel/upload/oabv64.exe (64-bit)\n\n## Conclusion\n\nAres is a new fork of the Kronos banking trojan that appears to be in the early stages of\ndevelopment. The code contains several bugs and unreferenced code segments that are\nlikely used for debugging purposes. The threat actor has invested significant resources in\nbuilding DarkCrypter, BMPack, Ares, and Ares Stealer. Therefore, activity related to this\nthreat is likely to increase as the malware continues to mature.\n\n## Detections\n\nZscaler’s multilayered cloud security platform detects indicators at various levels, as shown\nbelow:\n\n[Win32.Banker.Kronos](https://threatlibrary.zscaler.com/threats/80d2bbe9-8d98-4043-8c07-df1f16f03097)\n\n[Win32.Banker.Kronos.LZ](https://threatlibrary.zscaler.com/threats/e34fc3c7-bde3-4844-ba45-d25e09513b52)\n\n## MITRE ATT&CK Table\n\nTactic Technique\n\nT0011 Command and Control\n\nT1053 Scheduled Task/Job\n\nT1078 Valid Accounts\n\n\n-----\n\nT1087 Account Discovery\n\nT1090 Proxy\n\nT1185 Man in the Browser\n\nT1219 Remote Access Software\n\nT1497 Virtualization/Sandbox Evasion\n\nT1552 Unsecured Credentials\n\nT1573 Encrypted Channel\n\nT1592 Gather Victim Host Information\n\n## Indicators of Compromise (IOCs)\n\nThe following IOCs can be used to detect Osiris and Ares infections.\n\n### Samples\n\nSHA256 Hash Module\nName\n\nda767e6faf97d73997f397eae71b372a549dd6331bf8ec0ebd398ef8cfe9a47e Osiris\nsample\n\n5e7642e945bd05ecea77921cb3464b6da8db59e5ff38240608e3cbb44b07fb1d Osiris\nsample\n\n7498e37c332d55c14247ae4b675e726336a8683900d8fd1da412905567d2de4a Ares\nsample\n\ne5d624b7060c0e885abe11a0973a43a355c9930fc6912ff5eac83d1a9eec9c29 Ares\nsample\n\n\n-----\n\n035793d479c4229693fc6dcceaa639cd51ae89334b43e552b9c47a6dea68ce30 Ares\nsample with\nembedded\nStartup\nmodule\n\n94b084ea925990742f4eaaada1eef9a42c13066bf4f4c7a3b12a1509e32ff9e6 Ares\nStealer\nsample\n\n09897c6ef88b9e9bc20917a2b47ec86ff2b727a2923678f5e2df6bb6437d3312 Ares VNC\nplugin\n\n896cebf465257f60347e58ffd7ec61629cf530956ef9b00e94f8b40ef9b30581 DarkCrypter\nwith\nsecondstage\nBMPack\nand Osiris\nsample\n\n956ae36f40d0d847daa00d7964906e7e9d1671d0f3f2e7d257d5a8d324388c31 DarkCrypter\nsample with\nencrypted\nAres\npayload\n\n6c5dac9043b2f112543f3eca6503d4bcc70d762b47d75dcb85f9767c603de56f DarkCrypter\nsample with\ncompressed\nAres TOR\npayload\n\nb3348405cd0fa66661b46bc6cbab97b55708be26a2ed7a745e1632b46d1b3f41 DarkCrypter\nsample with\nencrypted\nAres\npayload\n\n4044abad9a846e203f131c65b1f84bb2b79f94000d1d7be6c6d6a8e27ac76940 BMPack\nsample with\nOsiris\npayload\n\n### Network Indicators\n\n\n-----\n\nDomain / IP Address Description\n\nhttp://ylnfkeznzg7o4xjf[.]onion/kpanel/connect.php Osiris C2 URL\n\nhttp://m3r7ifpzkdix4rf5[.]onion/kpanel/connect.php Osiris C2 URL\n\nhttp://qqkzfkax24p4elax[.]onion/kpanel/connect.php Osiris C2 URL\n\nhttps://securebankingapp[.]com Osiris web inject domain\n\nhttp://vbyrduc537l5po3w[.]onion/panel/connect.php Ares C2 URL\n\nhttp://wifoweijijfoiwjweoi[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiiqefmiir[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiilefmjim[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiieeelkif[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiiofelkkq[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiihfelikh[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiiffdkijh[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiigedliji[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiirfdmjks[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://ddkiitefkkju[.]xyz/panel/connect.php Ares C2 URL\n\nhttp://mydynamite.dynv6[.]net/panel/connect.php Ares C2 URL\n\nhttp://cabletv[.]top/panel/connect.php Ares C2 URL\n\n\n-----\n\n### Yara rules\n\nThese rules are valid on unpacked Kronos, Osiris, and Ares binaries.\n\n\n-----\n\n```\nrule kronos_string_decryption\n{\n strings: \n  $ = {6a 1e 5f f7 f7 8b 45 08 8d 3c 1e 8a 04 38 8a ?? ?? ?? ?? ?? 32 c2}  \n  $ = {55 8b ec 51 8b 4d 08 c1 e1 04 8b ?? ?? ?? ?? ?? 8a}\n condition: \n  all of them\n}\nrule kronos_api_strings\n{\n strings:\n  $ = \"D7T1H5F0F5A4C6S3\"\n  $ = \"H2G3F4F0F5A4D5E6\"\n  $ = \"X1U5U8H8F5A4C8C5\"\n  $ = \"E3D7R6B3R4H5F3R7\"\n  $ = \"X8D3U3P7S6Q3S5R1\"\n  $ = \"X8D3T6Q6U3S3A6R1\"\n  $ = \"R6G2D2R3A5E3C4U5\"\n  $ = \"H7Y6G2R3A5F4D3S8\"\n  $ = \"P7Y3Q5P0Y8C2Y6F6\"\n  $ = \"R6Y7B3C6E7E6T7U7\"\n  $ = \"G2F3G6A6R3F1P6G2\"\n  $ = \"S3H8T8Y5F5B5B0X0\"\n  $ = \"C8G2T3U3B1H3T5B5\"\n  $ = \"C4R7A2P4X3B1H5A4\"\n  $ = \"R3Q7T7Q2R6S1Y3R5\"\n  $ = \"E3C3A2Y3C4U6S5F5\"\n  $ = \"F3P7Y6P3U3E2U5F3\"\n  $ = \"E5X0A4Q4F0Y0D6E2\"\n  $ = \"X2R0A4Q4F0Y0D6F3\"\n  $ = \"H1G7R4Y7D1E6R5F8\"\n  $ = \"G3C3R4H7R5T8E5R8\"\n  $ = \"F6H5P7T4F6D6Y6D4\"\n  $ = \"E3C7U2Y3C3R6R5D5\"\n  $ = \"F5E8X5G3Q6T7E6T3\"\n  $ = \"E1U3D5F7R2Y5S0H4\"\n  $ = \"H3Y5C8Y2D4U8Y4S3\"\n  $ = \"U0U6H1T2F6S1P2Y5\"\n  $ = \"D5R3T8D5D3H0B4E2\"\n  $ = \"D5B6G6R4A6H1P7A3\"\n  $ = \"F1Q3D0H4H3T6U1X5\"\n  $ = \"A4T6P1G7D6G0F3S5\"\n  $ = \"C7G5T6P7U5B1H0F5\"\n  $ = \"X2C7E3U6F3A7Y1D5\"\n  $ = \"P4Y7T7R7R8X3E3A3\"\n  $ = \"C5Y7R2R2H1R7A1B2\"\n  $ = \"S4A3E3S3S4T1T3D1\"\n  $ = \"B4Y2H7F8A2T3G4H3\"\n  $ = \"B5D6X4H5G6S3R2B5\"\n  $ = \"B6F6X4A8R5D3A7C6\"\n  $ = \"C6P7E6P7A1R5Q4R7\"\n  $ = \"R8S7D7S8H6Y4T6B7\"\n  $ = \"U0S3T3D3U5F5B4E8\"\n  $ = \"F6C3U4P4X3B1H3T5\"\n\n```\n\n-----\n\n```\n  $ T2F2T3U2H5B1C1A7 \n  $ = \"T0E0H4U0X3A3D4D8\"\n  $ = \"C5R4X4H7R5T7A5R6\"\n  $ = \"D3S0A7R4F6C8F2R5\"\n  $ = \"Y1C1B6A7H3C0E7E7\"\n  $ = \"H2E7A5B8Q6G3S7Y3\"\n  $ = \"D3Q5F2F3R5Y5Y8S2\"\n  $ = \"Y2C3G8R5R3A5F5B4\"\n  $ = \"F1D2B6A5T3X2C8R1\"\n  $ = \"G5D3P2G0F6G2H8E6\"\n  $ = \"Y6Q6P2G0E5E6G2H8\"\n  $ = \"Y7D3F3S7X2S4F2X3\"\n  $ = \"X7D0E3R2R4Q0E4D3\"\n condition:\n  25 of them\n}\n\n### Snort rules\nalert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:\"Zscaler TROJAN Ares Command\nBeacon\"; flow:established,to_server; content:\"POST\"; http_method;\ncontent:\"/connect.php?a=\"; http_uri; classtype:trojan-activity; rev:1;)\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-30 - Ares Malware- The Grandson of the Kronos Banking Trojan.pdf"
    ],
    "report_names": [
        "2021-03-30 - Ares Malware- The Grandson of the Kronos Banking Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535924,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653767825,
    "ts_modification_date": 1653767825,
    "files": {
        "pdf": "https://archive.orkl.eu/cd89d9151a61b94b539861359ab73bcd95533ae0.pdf",
        "text": "https://archive.orkl.eu/cd89d9151a61b94b539861359ab73bcd95533ae0.txt",
        "img": "https://archive.orkl.eu/cd89d9151a61b94b539861359ab73bcd95533ae0.jpg"
    }
}