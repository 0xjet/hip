{
    "id": "415303b5-d39f-4c1b-b61b-574f7369f529",
    "created_at": "2023-01-12T15:06:58.568902Z",
    "updated_at": "2025-03-27T02:05:38.159213Z",
    "deleted_at": null,
    "sha1_hash": "11495e01171b2f4605f16844e5936e94e547595c",
    "title": "2020-01-30 - Trickbot Trojan Leveraging a New Windows 10 UAC Bypass",
    "authors": "",
    "file_creation_date": "2022-05-28T17:09:22Z",
    "file_modification_date": "2022-05-28T17:09:22Z",
    "file_size": 1358897,
    "plain_text": "# Trickbot Trojan Leveraging a New Windows 10 UAC Bypass\n\n**[blog.morphisec.com/trickbot-uses-a-new-windows-10-uac-bypass](https://blog.morphisec.com/trickbot-uses-a-new-windows-10-uac-bypass)**\n\n[Tweet](https://twitter.com/share)\n\nThe Trickbot trojan is one of the most advanced malware delivery vehicles currently in use.\nAttackers have leveraged it to deliver a wide variety of malicious code, in many different\nmethods. Just yesterday, [Bleeping Computer reported that news articles from President](https://www.bleepingcomputer.com/news/security/malware-tries-to-trump-security-software-with-potus-impeachment/)\n\n\n-----\n\nTrump s impeachment trial have been used to hide Trickbot from antivirus scanners.\n\nOn almost a daily basis, malicious actors reinvent Trickbot and work to find new pathways to\ndeliver the trojan onto user machines. This is what makes Trickbot among the most\nadvanced malware delivery vehicles; the constant evolution of methodologies used for\ndelivery.\n\nThe latest revision, which the Morphisec Labs team detected in new samples, leverages the\n_[Windows 10 WSReset UAC Bypass to circumvent user account control and deliver its](https://www.activecyber.us/activelabs/windows-uac-bypass)_\npayload onto user machines.\n\n## The Trickbot Trojan and Windows 10\n\nThe WSReset UAC Bypass process begins with Trickbot checking to see if the system it’s on\nis running Windows 7 or Windows 10. If it is running under Windows 7, it will utilize the\n[CMSTPLUA UAC bypass (the same one as in previous samples). It’s only when the system](https://msitpros.com/?p=3960)\nis running Windows 10 that Trickbot uses the WSReset UAC Bypass.\n\n_Figure 1 OS version check._\n\n_Figure 2 If Windows 10 - utilize WSReset UAC Bypass._\n\n\n-----\n\nThe WSReset UAC Bypass, discovered in March 2019, allows Trickbot authors to take\nadvantage of the WSReset.exe process. The WSReset.exe process is a Microsoft signed\nexecutable that is used to reset Windows Store settings, according to its manifest file. What’s\nmost important here, though, is that the ‘autoElevate’ property is set to “true.” This is what\nallows the WSReset UAC Bypass to be used for privilege escalation.\n\n_Figure 3 WSReset manifest._\n\nTrickbot decrypts its strings in order to use the WSReset UAC Bypass, such as the registry\npath and the command to execute.\n\n\n-----\n\n_Figure 4 Trickbot command preparation._\n\nNext, Trickbot uses “reg.exe” in order to add the relevant keys that allows it to utilize the\nWSReset UAC Bypass.\n\n_Figure 5 Using reg.exe to add relevant keys._\n\n_Figure 6 Registry before WSReset execution._\n\n\n-----\n\nThe final step in this bypass is to execute WSReset.exe, which will cause Trickbot to run with\nelevated privileges without a UAC prompt. Trickbot does that using ‘ShellExecuteExW’ API.\nThis final executable allows Trickbot to deliver its payload onto workstations and other\nendpoints.\n\n_Figure 7 WSReset.exe execution._\n\n## Morphisec Secures Your Endpoints Against the Trickbot MALWARE\n\nThe Morphisec Unified Threat Prevention Platform blocks Trickbot before it is able to execute\nits process, including the WSReset UAC Bypass, through the power of moving target\ndefense. By morphing the application memory structures on endpoints, we take away the\nattackers’ ability to accurately target our customers’ critical systems. This protects\nworkstations, servers, VDIs, and cloud workloads against this and other damaging attacks.\n\nIOC: (SHA-1)\n\n- b9cc1b651f579ff1afb11427f0ec1c882afde710\n\n- 24263d91575bb825c33e3fd27f35bc7bd611cee3\n\n- 864d3e3f7ad0f144f8d838ea9638d4c264c5c063\n\n\n-----\n\n- f33c057d652aa70c5f1332e14c0b8d9c77a5aa1c\n\n- b1f7f71b5f7fee1cf38e2591e50cb181f7bd5353\n\n- 6de843fb12f456b0ea42876d82f39fe35b5cf6ca\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-30 - Trickbot Trojan Leveraging a New Windows 10 UAC Bypass.pdf"
    ],
    "report_names": [
        "2020-01-30 - Trickbot Trojan Leveraging a New Windows 10 UAC Bypass.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536018,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1653757762,
    "ts_modification_date": 1653757762,
    "files": {
        "pdf": "https://archive.orkl.eu/11495e01171b2f4605f16844e5936e94e547595c.pdf",
        "text": "https://archive.orkl.eu/11495e01171b2f4605f16844e5936e94e547595c.txt",
        "img": "https://archive.orkl.eu/11495e01171b2f4605f16844e5936e94e547595c.jpg"
    }
}