{
    "id": "89772517-bbd6-492c-984e-e9c6f67e4c73",
    "created_at": "2023-01-12T14:59:22.535507Z",
    "updated_at": "2025-03-27T02:06:04.11174Z",
    "deleted_at": null,
    "sha1_hash": "76aca6a22977add964fe8c9b58d8a78b95b01c1e",
    "title": "2019-07-01 - Robbinhood Malware Analysis with Radare2",
    "authors": "",
    "file_creation_date": "2022-05-28T17:37:32Z",
    "file_modification_date": "2022-05-28T17:37:32Z",
    "file_size": 514422,
    "plain_text": "# Robbinhood Malware Analysis with Radare2\n\n**goggleheadedhacker.com/blog/post/12**\n\nJacob Pimental July 1, 2019\n\n### 01 July 2019\n\nThis article will provide an overview of how we can extract function names from Windows\nGoLang binaries to make reversing easier and to give a brief analysis on the Robbinhood\nRansomware that attacked Baltimore recently. GoLang is a programming language designed\naround multi-threaded applications. The difficulty in reversing GoLang binaries is that all\nlibraries are statically linked which means there will be a large number of functions in the\napplication, most of which are not even used during execution. For example, in a normal\nHello World compiled GoLang binary, radare2 detects 1800 functions.\n\nThe gopclntab section in a GoLang program contains a table of function locations along with\ntheir names. Radare2 is able to parse out this table and label every function accordingly,\nhowever this only works on binaries compiled for Linux. When it comes to Windows,\nRadare2 is not able to find the gopclntab and we are left with thousands of unlabeled\nfunctions with no clue as to what they do. I decided to learn how the gopclntab works and\ncreate a parser using r2pipe to label all functions.\n\n## Gopclntab\n\n\n-----\n\nThe gopclntab section always seems to start with the bytes 0xfbffffff, and after that contains\nthe size of the table. The next 8 bytes contains the location of the first function, then the\noffset of that function from the start of the table. If you go to that offset from the start of the\ntable you’ll get the offset for the name of the function.\n\nUsing this table we can get all of the function information for the binary. I created a small\npython script that uses r2pipe to parse this table and rename/create the necessary functions.\n[You can get the script on my gitHub. There is also a really in-depth article you can read](http://github.com/JacobPimental/r2-gohelper)\n[about the gopclntab here.](http://lekstu.ga/posts/pclntab-function-recovery/)\n\n## Robbinhood\n\nIn May, Baltimore was hit by a ransomware known as Robbinhood, that took out multiple\nservices. The ransomware itself was written in GoLang, so I thought this would be a good\nopportunity to become familiar with GoLang reversing and analyze the sample.\n\nWhen reversing a GoLang binary, the main function will be located at main.main. Seeking to\nthat function in radare2, we can see the binary trying to open the file\n“C:\\Windows\\Temp\\pub.key”. Strings in a GoLang binary are not null-terminated like most Ctype programming languages. Instead, they have a variable that contains the length of the\nstring.\n\nIf the file “pub.key” does not exist, the program throws an error and exits. If it does exist, the\nprogram will get a list of drives that the computer has access to and run the function\n_main.CoolMaker. The CoolMaker function spawns multiple processes of “cmd.exe” to run the_\nservice control manager in order to to shut down any endpoint agents or antivirus on the\ninfected host.\n\n\n-----\n\nAfter the CoolMaker function has been called, Robbinhood will spawn 4 processes of the\nfunction main.main.func1, which appears to be where the actual encryption occurs. The\nfunction calls another function, main.doit, which creates an encryption key based on the\n“pub.key” file found at the start of execution. These processes will then recursively walk\nthrough the file system and encrypt any files it finds.\n\nThe program also logs the encrypted files names to four different log files, rf_l, rf_s, ro_l,\n_ro_s. Both of the rf_* files log the names of the files the program deems “interesting”. The_\nro_* logs contain all other filenames. Both sets of logs are separated into large file sizes (rf_l,\nro_l), and small file sizes (rf_s, ro_s). These logs are deleted as soon as execution is\ncompleted.\n\n\n-----\n\nThe dropped ransom note is contained in the binary as a base64 encoded string. The\ndifferent aspects of the note, such as payment amount and user id are defined by different\nvariables in the note to make them easily interchangeable depending on who the victim is.\nFor example, the wallet id is defined in the ransom note as “#WALLAD#” and is replaced by\nthe string “14yos7dpe4bx3imnoGVUcMsNBwU1hLutfj”. I did check to see if any payments\nhad been made to the bitcoin wallet address and it looks like Jack Young was true to his\nword and the city didn’t pay the ransom at all.\n\n\n-----\n\nOverall, this was not a very advanced Ransomware. It is very loud due to the fact that it is\nshutting down multiple Endpoint agents and AV. It also did not have the ability to spread at\nall. Every infected computer had to be targeted individually for it to cause real damage.\n\nHowever, this was a fun sample to analyze and taught me a lot about GoLang reversing. As\nalways, if you have any questions or comments on this, or any of my other articles, feel free\nto reach out to me on my [Twitter and](http://twitter.com/jacob_pimental) [Linkedin.](http://www.linkedin.com/in/jacobpimental/)\n\nThanks for reading and happy reversing!\n\n**Tutorial, Radare2, Malware Analysis, Malware, Linux, Windows, Scripting, Automation,**\n**r2pipe, GoLang**\n\n## More Content Like This:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-01 - Robbinhood Malware Analysis with Radare2.pdf"
    ],
    "report_names": [
        "2019-07-01 - Robbinhood Malware Analysis with Radare2.pdf"
    ],
    "threat_actors": [
        {
            "id": "e568e9d7-ae94-4ce5-9039-4fd17c731c1d",
            "created_at": "2022-10-25T15:50:23.491763Z",
            "updated_at": "2025-03-27T02:00:55.483586Z",
            "deleted_at": null,
            "main_name": "Blue Mockingbird",
            "aliases": [
                "Blue Mockingbird"
            ],
            "source_name": "MITRE:Blue Mockingbird",
            "tools": [
                "FRP",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535562,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1653759452,
    "ts_modification_date": 1653759452,
    "files": {
        "pdf": "https://archive.orkl.eu/76aca6a22977add964fe8c9b58d8a78b95b01c1e.pdf",
        "text": "https://archive.orkl.eu/76aca6a22977add964fe8c9b58d8a78b95b01c1e.txt",
        "img": "https://archive.orkl.eu/76aca6a22977add964fe8c9b58d8a78b95b01c1e.jpg"
    }
}