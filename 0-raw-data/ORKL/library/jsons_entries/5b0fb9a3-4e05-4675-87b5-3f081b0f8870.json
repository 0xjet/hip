{
    "id": "5b0fb9a3-4e05-4675-87b5-3f081b0f8870",
    "created_at": "2023-01-12T15:10:37.516656Z",
    "updated_at": "2025-03-27T02:10:04.368325Z",
    "deleted_at": null,
    "sha1_hash": "e0c2c2768da99a7f74eeae8fe998e327711975a7",
    "title": "2022-05-26 - Rapidly evolving IoT malware EnemyBot now targeting Content Management System servers and Android devices",
    "authors": "",
    "file_creation_date": "2022-06-01T12:26:14Z",
    "file_modification_date": "2022-06-01T12:26:14Z",
    "file_size": 927728,
    "plain_text": "# Rapidly evolving IoT malware EnemyBot now targeting Content Management System servers and Android devices\n\n**[cybersecurity.att.com/blogs/labs-research/rapidly-evolving-iot-malware-enemybot-now-targeting-content-management-system-servers](https://cybersecurity.att.com/blogs/labs-research/rapidly-evolving-iot-malware-enemybot-now-targeting-content-management-system-servers)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nMay 26, 2022 | [Ofer Caspi](https://cybersecurity.att.com/blogs/author/ofer-caspi)\n\n## Executive summary\n\nAT&T Alien Labs™ has been tracking a new IoT botnet dubbed “EnemyBot”, which is believed to be\ndistributed by threat actor Keksec. During our investigations, Alien Labs has discovered that EnemyBot is\nexpanding its capabilities, exploiting recently identified vulnerabilities (2022), and now targeting IoT devices,\nweb servers, Android devices and content management system (CMS) servers. In addition, the malware base\nsource code can now be found online on Github, making it widely accessible.\n\n## Key takeaways:\n\nEnemyBot’s base source code can be found on Github, making it available to anyone who wants to\nleverage the malware in their attacks.\nThe malware is rapidly adopting one-day vulnerabilities as part of its exploitation capabilities.\nServices such as VMware Workspace ONE, Adobe ColdFusion, WordPress, PHP Scriptcase and more\nare being targeted as well as IoT and Android devices.\nThe threat group behind EnemyBot, Keksec, is well-resourced and has the ability to update and add\nnew capabilities to its arsenal of malware on a daily basis (see below for more detail on Keksec)\n\n## Background\n\n\n-----\n\nFirst discovered by [Securonix in March 2022 and later detailed in an in-depth analysis by Fortinet, EnemyBot](https://www.securonix.com/blog/detecting-the-enemybot-botnet-advisory/)\nis a new malware distributed by the threat actor “Keksec” targeting Linux machines and IoT devices.\n\n[According to the malware Github’s repository, EnemyBot derives its source code from multiple botnets to a](https://github.com/freakanonymous/enemy)\npowerful and more adjustable malware. The original botnet code that EnemyBot is using includes: Mirai,\nQbot, and Zbot. In addition, the malware includes custom development (see figure 1).\n\nFigure 1. EnemyBot page on Github.\n\nThe Keksec threat group is reported to have formed back in 2016 by a number of experienced botnet actors.\n[In November 2021, researchers from Qihoo 360 described in detail the threat actor’s activity in a presentation,](https://vblocalhost.com/uploads/VB2021-Jin-Tu.pdf)\nattributing to the Keksec the development of botnets for different platforms including Windows and Linux:\n\nLinux based botnets: Tsunami and Gafgyt\nWindows based botnets: DarkIRC, DarkHTTP\nDual systems: Necro (developed in Python)\n\n## Source code analysis\n\n\n-----\n\nThe developer of the Github page on EnemyBot self describes as a full time malware dev, that is also\navailable for contract work. The individual states their workplace as “Kek security,” implying a potential\nrelationship with the broader Keksec group (see figure 2).\n\nFigure 2. EnemyBot developer description.\n\nThe malware repository on Github contains four main sections:\n\n### cc7.py\n\nThis module is a Python script file that downloads all dependencies and compiles the malware into different\nOS architectures including x86, ARM, macOS, OpenBSD, PowerPC, MIPS, and more (see figure 3)\n\nFigure 3. Compiling malware source code to macOS executable.\n\nOnce compilation is complete, the script then creates a batch file ‘update.sh’ which is used by the bot as a\ndownloader that is then delivered to any identified vulnerable targets to spread the malware.\n\nFigure 4. Generated `update.sh` file to spread EnemyBot on different architectures.\n\n\n-----\n\n### enemy.c\n\nThis is the main bot source code. Though it is missing the main exploitation function, it includes all other\nfunctionality of the malware and the attacks the bot supports by mixing the various botnet source codes as\nmentioned above (Mirai, Qbot, and Zbot) — mainly Mirai and Qbot (see figure 5).\n\nFigure 5. EnemyBot source code.\n\n### hide.c\n\nThis module is compiled and manually executed to encode / decode the malware’s strings by the attacker to\nhide strings in binary. For that, the malware is using a simple swap table, in which each char is replaced with\na corresponding char in the table (see in figure 6).\n\nFigure 6. String decode.\n\n### servertor.c\n\nFigure 7 shows the command-and-control component (C&C) botnet controller. C&C will be executed on a\ndedicated machine that is controlled by the attacker. It can control and send commands to infected machines.\n(figure 7)\n\n\n-----\n\nFigure 7. C&C component.\n\n## New variant analysis\n\nMost of EnemyBot functionality relates to the malware’s spreading capabilities, as well as its ability to scan\npublic-facing assets and look for vulnerable devices. However, the malware also has DDoS capabilities and\ncan receive commands to download and execute new code (modules) from its operators that give the\nmalware more functionality.\n\nIn new variants of EnemyBot, the malware added a webscan function containing a total of 24 exploits to\nattack vulnerabilities of different devices and web servers (see figure 8).\n\nFigure 8. EnemyBot calls for a new function “webscan_xywz”.\n\nTo perform these functions, the malware randomly scans IP addresses and when it gets a response via\nSYN/ACK, EnemyBot then scans for vulnerabilities on the remote server by executing multiple exploits.\n\nThe first exploit is for the Log4j vulnerability discovered last year as CVE-2021-44228 and CVE-2021-45046:\n\n\n-----\n\nFigure 9. Exploiting the Log4J vulnerability.\n\nThe malware also can adopt new vulnerabilities within days of those vulnerabilities being discovered. Some\nexamples are Razer Sila (April 2022) which was published without a CVE (see figure 10) and a remote code\nexecution (RCE) vulnerability impacting VMWare Workspace ONE with CVE-2022-22954 the same month\n(see figure 11).\n\nFigure 10. Exploiting vulnerability in Razar Sila.\n\n\n-----\n\nFigure 11. Exploiting vulnerability in VMWare Workspace ONE.\n\nEnemyBot has also begun targeting content management systems (e.g. Wordpress) by searching for\nvulnerabilities in various plugins, such as “Video Synchro PDF” (see figure 12).\n\nFigure 12. EnemyBot targeting WordPress servers.\n\nIn the example shown in figure 12, notice that the malware elevates a local file inclusion (LFI) vulnerability into\n[a RCE by injecting malicious code into the ‘/proc/self/environ’. This method is not new and was described in](https://www.exploit-db.com/papers/12886)\n2009. The malware uses LFI to call ‘environ’ and passes the shell command in the user agent http header.\n\nAnother example of how the malware uses this method is shown in figure 13. In this example the malware is\nexploiting a vulnerability in DBltek GoIP.\n\n\n-----\n\nFigure 13. Executing shell command through LFI vulnerability in DBltek.\n\nIn case an Android device is connected through USB, or Android emulator running on the machine,\nEnemyBot will try to infect it by executing shell command. (figure 14)\n\nFigure 14. EnemyBot \"adb_infect\" function to attack Android devices.\n\nAfter infection, EnemyBot will wait for further commands from its C&C. However, in parallel it will also further\npropogate by scanning for additional vulnerable devices. Alien Labs has listed below the commands the bot\ncan receive from its C&C (accurate as of the publishing of this article).\n\nCommand Action\n\nSH Execute shell command\n\nPING Ping to server, wait for command\n\n\n-----\n\nLDSERVER Change loader server for payload.\n\nTCPON Turn on sniffer.\n\nRSHELL Create a reverse shell on an infected machine.\n\nTCPOFF Turn off sniffer.\n\nUDP Start UDP flood attack.\n\nTCP Start TCP flood attack.\n\nHTTP Start HTTP flood attack.\n\nHOLD Start TCP connection flooder.\n\nTLS Start TLS attack, start handshake without closing the socket.\n\nSTD Start non spoofed UDP flooder.\n\nDNS Start DNS flooder.\n\nSCANNER ON | OFF Start/Stop scanner - scan and infect vulnerable devices.\n\nOVH Start DDos attack on OVH.\n\nBLACKNURSE Start ICMP flooder.\n\nSTOP Stop ongoing attacks. kill child processes\n\nARK Start targeted attack on ARK: Survivor Evolved video game server.\n\nADNS Receive targets list from C&C and start DNS attack.\n\nASSDP Start SSDP flood attack.\n\nWe have also listed the current vulnerabilities EnemyBot uses. As mentioned, some of them have not been\nassigned a CVE yet. (As of the publishing of this article.)\n\n**CVE Number** **Affected devices**\n\nCVE-2021-44228, CVE-2021-45046 Log4J RCE\n\n\n-----\n\nCVE-2022-1388 F5 BIG IP RCE\n\n\nNo CVE (vulnerability published on\n2022-02)\n\n\nAdobe ColdFusion 11 RCE\n\n\nCVE-2020-7961 Liferay Portal - Java Unmarshalling via JSONWS RCE\n\n\nNo CVE (vulnerability published on\n2022-04)\n\n\nPHP Scriptcase 9.7 RCE\n\n\nCVE-2021-4039 Zyxel NWA-1100-NH Command injection\n\n\nNo CVE (vulnerability published on\n2022-04)\n\n\nRazar Sila - Command injection\n\n\nCVE-2022-22947 Spring Cloud Gateway - Code injection vulnerability\n\nCVE-2022-22954 VMWare Workspace One RCE\n\nCVE-2021-36356, CVE-2021-35064 Kramer VIAware RCE\n\n\nNo CVE (vulnerability published on\n2022-03)\n\nNo CVE (vulnerability published on\n2022-02)\n\nNo CVE(vulnerability published on\n2022-03)\n\nNo CVE(vulnerability published on\n2022-03)\n\n\nWordPress Video Synchro PDF plugin LFI\n\nDbltek GoIP LFI\n\nWordPress Cab Fare Calculator plugin LFI\n\nArcheevo 5.0 LFI\n\n\nCVE-2018-16763 Fuel CMS 1.4.1 RCE\n\nCVE-2020-5902 F5 BigIP RCE\n\n\nNo CVE (vulnerability published on\n2019)\n\nNo CVE (vulnerability published on\n2017)\n\n\nThinkPHP 5.X RCE\n\nNetgear DGN1000 1.1.00.48 ‘Setup.cgi’ RCE\n\n\nCVE-2022-25075 TOTOLink A3000RU command injection vulnerability\n\n\n-----\n\nCVE-2015-2051 D-Link devices - HNAP SOAPAction - Header command injection\nvulnerability\n\nCVE-2014-9118 ZHOME < S3.0.501 RCE\n\nCVE-2017-18368 Zyxel P660HN - unauthenticated command injection\n\nCVE-2020-17456 Seowon SLR 120 router RCE\n\nCVE-2018-10823 D-Link DWR command injection in various models\n\n## Recommended actions\n\n1. Maintain minimal exposure to the Internet on Linux servers and IoT devices and use a properly\n\nconfigured firewall.\n2. Enable automatic updates to ensure your software has the latest security updates.\n3. Monitor network traffic, outbound port scans, and unreasonable bandwidth usage.\n\n## Conclusion\n\nKeksec’s EnemyBot appears to be just starting to spread, however due to the authors’ rapid updates, this\nbotnet has the potential to become a major threat for IoT devices and web servers. The malware can quickly\nadopt one-day vulnerabilities (within days of a published proof of concept). This indicates that the Keksec\ngroup is well resourced and that the group has developed the malware to take advantage of vulnerabilities\nbefore they are patched, thus increasing the speed and scale at which it can spread.\n\n## Detection methods\n\nThe following associated detection methods are in use by Alien Labs. They can be used by readers to tune or\ndeploy detections in their own environments or for aiding additional research.\n\nSURICATA IDS SIGNATURES\n\nLog4j sids: 2018202, 2018203, 2034647, 2034648, 2034649, 2034650, 2034651, 2034652, 2034653,\n2034654, 2034655, 2034656, 2034657, 2034658, 2034659, 2034660, 2034661, 2034662, 2034663,\n2034664, 2034665, 2034666, 2034667, 2034668, 2034671, 2034672, 2034673, 2034674, 2034676,\n2034699, 2034700, 2034701, 2034702, 2034703, 2034706, 2034707, 2034708, 2034709, 2034710,\n2034711, 2034712, 2034713, 2034714, 2034715, 2034716, 2034717, 2034723, 2034743, 2034744,\n2034747, 2034748, 2034749, 2034750, 2034751, 2034755, 2034757, 2034758, 2034759, 2034760,\n2034761, 2034762, 2034763, 2034764, 2034765, 2034766, 2034767, 2034768, 2034781, 2034782,\n2034783, 2034784, 2034785, 2034786, 2034787, 2034788, 2034789, 2034790, 2034791, 2034792,\n2034793, 2034794, 2034795, 2034796, 2034797, 2034798, 2034799, 2034800, 2034801, 2034802,\n2034803, 2034804, 2034805, 2034806, 2034807, 2034808, 2034809, 2034810, 2034811, 2034819,\n2034820, 2034831, 2034834, 2034835, 2034836, 2034839, 2034886, 2034887, 2034888, 2034889,\n2034890, 2838340, 2847596, 4002714, 4002715\n\n\n-----\n\n4001913: AV EXPLOIT LifeRay RCE (CVE-2020-7961)\n\n4001943: AV EXPLOIT Liferay Portal Java Unmarshalling RCE (CVE-2020-7961)\n\n4002589: AV EXPLOIT LifeRay Remote Code Execution - update-column (CVE-2020-7961)\n\n2031318: ET CURRENT_EVENTS 401TRG Liferay RCE (CVE-2020-7961)\n\n2031592: ET WEB_SPECIFIC_APPS Liferay Unauthenticated RCE via JSONWS Inbound (CVE-20207961)\n\n2035955: ET EXPLOIT Razer Sila Router - Command Injection Attempt Inbound (No CVE)\n\n2035956: ET EXPLOIT Razer Sila Router - LFI Attempt Inbound (No CVE)\n\n2035380: ET EXPLOIT VMware Spring Cloud Gateway Code Injection (CVE-2022-2294) (set)\n\n2035381: ET EXPLOIT VMware Spring Cloud Gateway Code Injection (CVE-2022-2294)\n\n2035876: ET EXPLOIT VMWare Server-side Template Injection RCE (CVE-2022-22954)\n\n2035875: ET EXPLOIT VMWare Server-side Template Injection RCE (CVE-2022-22954)\n\n2035874: ET EXPLOIT VMWare Server-side Template Injection RCE (CVE-2022-22954)\n\n2036416: ET EXPLOIT Possible VMware Workspace ONE Access RCE via Server-Side Template Injection\nInbound (CVE-2022-22954)\n\n4002364: AV EXPLOIT Fuel CMS RCE (CVE-2018-16763)\n\n2030469: ET EXPLOIT F5 TMUI RCE vulnerability CVE-2020-5902 Attempt M1\n\n2030483: ET EXPLOIT F5 TMUI RCE vulnerability CVE-2020-5902 Attempt M2\n\n2836503: ETPRO EXPLOIT Attempted THINKPHP < 5.2.x RCE Inbound\n\n2836504: ETPRO EXPLOIT Attempted THINKPHP < 5.2.x RCE Outbound\n\n2836633: ETPRO EXPLOIT BlackSquid Failed ThinkPHP Payload Inbound\n\n2026731: ET WEB_SERVER ThinkPHP RCE Exploitation Attempt\n\n2024916: ET EXPLOIT Netgear DGN Remote Command Execution\n\n2029215: ET EXPLOIT Netgear DGN1000/DGN2200 Unauthenticated Command Execution Outbound\n\n2034576: ET EXPLOIT Netgear DGN Remote Code Execution\n\n2035746: ET EXPLOIT Totolink - Command Injection Attempt Inbound (CVE-2022-25075)\n\n4001488: AV TROJAN Mirai Outbound Exploit Scan, D-Link HNAP RCE (CVE-2015-2051)\n\n2034491: ET EXPLOIT D-Link HNAP SOAPAction Command Injection (CVE-2015-2051)\n\n\n-----\n\n4000095: AV EXPLOIT Unauthenticated Command Injection (ZyXEL P660HN-T v1)\n\n4002327: AV TROJAN Mirai faulty Zyxel exploit attempt\n\n2027092: ET EXPLOIT Possible ZyXEL P660HN-T v1 RCE\n\n4002226: AV EXPLOIT Seowon Router RCE (CVE-2020-17456)\n\n2035950: ET EXPLOIT SEOWON INTECH SLC-130/SLR-120S RCE Inbound M1 (CVE-2020-17456)\n\n2035951: ET EXPLOIT SEOWON INTECH SLC-130/SLR-120S RCE Inbound M2 (CVE-2020-17456)\n\n2035953: ET EXPLOIT D-Link DWR Command Injection Inbound (CVE-2018-10823)\n\nAGENT SIGNATURES\n\nJava Process Spawning Scripting Process\n\nJava Process Spawning WMIC\n\nJava Process Spawning Scripting Process via Commandline (For Jenkins servers)\n\nSuspicious process executed by Jenkins Groovy scripts (For Jenkins servers)\n\nSuspicious command executed by a Java listening process (For Linux servers)\n\n## Associated indicators (IOCs)\n\nThe following technical indicators are associated with the reported intelligence. A list of indicators is also\n[available in the OTX Pulse. Please note, the pulse may include other activities related but out of the scope of](https://otx.alienvault.com/pulse/6256ce1dcbcd4dc9ed5cff00)\nthe report.\n\nTYPE INDICATOR DESCRIPTION\n\n\nIP\nADDRESS\n\n\n80.94.92[.]38 Malware C&C\n\n\nSHA256 7c0fe3841af72d55b55bc248167665da5a9036c972acb9a9ac0a7a21db016cc6 Malware hash\n\nSHA256 2abf6060c8a61d7379adfb8218b56003765c1a1e701b346556ca5d53068892a5 Malware hash\n\nSHA256 7785efeeb495ab10414e1f7e4850d248eddce6be91738d515e8b90d344ed820d Malware hash\n\nSHA256 8e711f38a80a396bd4dacef1dc9ff6c8e32b9b6d37075cea2bbef6973deb9e68 Malware hash\n\n\n-----\n\nSHA256 31a9c513a5292912720a4bcc6bd4918fc7afcd4a0b60ef9822f5c7bd861c19b8 Malware hash\n\nSHA256 139e1b14d3062881849eb2dcfe10b96ee3acdbd1387de82e73da7d3d921ed806 Malware hash\n\nSHA256 4bd6e530db1c7ed7610398efa249f9c236d7863b40606d779519ac4ccb89767f Malware hash\n\nSHA256 7a2a5da50e87bb413375ecf12b0be71aea4e21120c0c2447d678ef73c88b3ba0 Malware hash\n\nSHA256 ab203b50226f252c6b3ce2dd57b16c3a22033cd62a42076d09c9b104f67a3bc9 Malware hash\n\nSHA256 70674c30ed3cf8fc1f8a2b9ecc2e15022f55ab9634d70ea3ba5e2e96cc1e00a0 Malware hash\n\nSHA256 f4f9252eac23bbadcbd3cf1d1cada375cb839020ccb0a4e1c49c86a07ce40e1e Malware hash\n\nSHA256 6a7242683122a3d4507bb0f0b6e7abf8acef4b5ab8ecf11c4b0ebdbded83e7aa Malware hash\n\nSHA256 b63e841ded736bca23097e91f1f04d44a3f3fdd98878e9ef2a015a09950775c8 Malware hash\n\nSHA256 4869c3d443bae76b20758f297eb3110e316396e17d95511483b99df5e7689fa0 Malware hash\n\nSHA256 cdf2c0c68b5f8f20af448142fd89f5980c9570033fe2e9793a15fdfdadac1281 Malware hash\n\n## Mapped to MITRE ATT&CK\n\n### The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques:\n\nTA0001: Initial Access:\n\nT1190: Exploit Public-Facing Application\nTA0008: Lateral Movement:\n\nT1210: Exploitation of Remote Services\nT1021: Remote Services\nTA0011: Command and Control\n\nT1132: Data Encoding\nT1001: Data Obfuscation\nT1030: Proxy:\n\n003: Multi-hop Proxy\n\n### Share this with others\n\nTags: [malware,](https://cybersecurity.att.com/blogs/tag/malware) [malware hunting,](https://cybersecurity.att.com/blogs/tag/malware+hunting) [otx,](https://cybersecurity.att.com/blogs/tag/otx) [enemybot](https://cybersecurity.att.com/blogs/tag/enemybot)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-26 - Rapidly evolving IoT malware EnemyBot now targeting Content Management System servers and Android devices.pdf"
    ],
    "report_names": [
        "2022-05-26 - Rapidly evolving IoT malware EnemyBot now targeting Content Management System servers and Android devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a270f6c-2c13-4abf-861e-7d44dcfa5ceb",
            "created_at": "2023-11-03T02:00:07.794425Z",
            "updated_at": "2025-03-27T02:00:03.146871Z",
            "deleted_at": null,
            "main_name": "Keksec",
            "aliases": [],
            "source_name": "MISPGALAXY:Keksec",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536237,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1654086374,
    "ts_modification_date": 1654086374,
    "files": {
        "pdf": "https://archive.orkl.eu/e0c2c2768da99a7f74eeae8fe998e327711975a7.pdf",
        "text": "https://archive.orkl.eu/e0c2c2768da99a7f74eeae8fe998e327711975a7.txt",
        "img": "https://archive.orkl.eu/e0c2c2768da99a7f74eeae8fe998e327711975a7.jpg"
    }
}