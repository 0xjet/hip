{
    "id": "228b757f-fc1c-46a3-abd6-1c5e8d519217",
    "created_at": "2023-01-12T15:06:19.909673Z",
    "updated_at": "2025-03-27T02:17:00.082389Z",
    "deleted_at": null,
    "sha1_hash": "df77c66a3236f5bc01bed00572cbe8a319c8ba8b",
    "title": "2022-08-22 - A Tale of PivNoxy and Chinoxy Puppeteer",
    "authors": "",
    "file_creation_date": "2022-09-01T10:22:20Z",
    "file_modification_date": "2022-09-01T10:22:20Z",
    "file_size": 400167,
    "plain_text": "# A Tale of PivNoxy and Chinoxy Puppeteer\n\n**[fortinet.com/blog/threat-research/pivnoxy-and-chinoxy-puppeteer-analysis](https://www.fortinet.com/blog/threat-research/pivnoxy-and-chinoxy-puppeteer-analysis)**\n\nAugust 22, 2022\n\nRecently, a simple and short email with a suspicious RTF attachment that had been sent to a\ntelecommunications agency in South Asia caught the attention of FortiGuard Labs. The email\nwas disguised as having come from a Pakistan government division and delivered the\nPivNoxy malware.\n\n**Affected Platforms: Windows**\n\n**Impacted Parties: Windows users**\n\n**Impact: Controls victim’s machine and collects sensitive information**\n\n**Severity Level: Medium**\n\nThis blog describes how the attack works, suggests who the threat actor behind the\noperation might be, and details the techniques used by the attacker.\n\n## Attack Overview\n\n\n-----\n\nThe attack started with a simple email that included a bare document as an attachment:\n\nFigure 1. Spearphishing email used in the attack\n\nThe attached doc file is in RTF format. It was generated using a tool called Royal Road, a\nphishing “weaponizer” believed to be used by several Asia-based APT threat actors. Also\nreferred to as 8.t RTF exploit builder, Royal Road allows APT groups to create RTF files with\nembedded objects that can exploit vulnerabilities in Microsoft Word to infect targets. Some of\nthe known vulnerabilities that Royal Road supports include:\n\n[CVE-2017-11882 (Microsoft Office Memory Corruption Vulnerability)](https://msrc.microsoft.com/update-guide/en-en/vulnerability/CVE-2017-11882)\n[CVE-2018-0802 (Microsoft Office Memory Corruption Vulnerability)](https://msrc.microsoft.com/update-guide/en-en/vulnerability/CVE-2018-0802)\n[CVE-2018-0798 (Microsoft Office Memory Corruption Vulnerability)](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2018-0798)\n\nOpening the email attachment, “Please help to CHECK.doc,” opens a decoy Word\ndocument. And at the same time, it exploits CVE-2018-0798 in the background. CVE-20180798 is a Remote Code Execution (RCE) vulnerability in Microsoft’s Equation Editor\n(EQNEDT32). Microsoft released a fix for it on January 9, 2018. The fact that attackers are\nstill targeting this vulnerability highlights that not all organizations deploy critical patches or\nupgrade to the latest software. The truth is that older vulnerabilities are still commonly and\nsuccessfully being exploited.\n\nFigure 2. Decoy Word file used in the attack. Note that gibberish displayed in the document\nmay be a result of the language not being supported by our test machine.\n\nOnce executed, the malicious document drops three files:\n\n_C:\\\\ProgramData\\Cannon\\Cannondriver.exe_\n_C:\\\\ProgramData\\Cannon\\LBTServ.dll_\n_C:\\\\ProgramData\\Cannon\\Microsoft.BT_\n\nDespite the deceptive file name, the Cannondriver.exe file is a legitimate Logitech file,\nLBTWizGi.exe, with the description, “Logitech Bluetooth Wizard Host Process.” The\nCannondriver.exe is even digitally signed by a certificate issued to Logitech.\n\nFigure 3. Legitimate version of Cannondriver.exe\n\nOn the other hand, the LBTServ.dll file is not digitally signed. This is where it gets interesting.\n[“Cannondriver.exe” is vulnerable to a DLL Search Order Hijacking attack that LBTServ.dll](https://attack.mitre.org/techniques/T1574/001/)\ntakes advantage of. Take note that the “LBTServ.dll” sample used in this attack has a\ncompilation time of Sun July 18 02:04:24 2021 GMT. This means that this group created this\nvariant well before they needed to use it. It suggests they were either ready to attack their\n\n\n-----\n\ntarget almost a year before or had started stockpiling an arsenal of malware ready to go at a\nmoment’s notice. Recent Chinoxy samples that stayed under the radar, but were uncovered\nduring our investigation, have similar compile times.\n\nFigure 4. DLL Search Order Hijacking inside Cannondriver.exe\n\nThe figure above is part of the code found in Cannondriver.exe. Basically, it calls the export\nnamed LGBT_Launch, which is found in LBTServ.dll.\n\nFigure 5. Inside LBTServ.dll\n\nAfter Cannondriver.exe loads the fake LBTServ.dll and calls the LGBT_Launch function, the\nmalicious function loads the other dropped file, Microsoft.BT, into memory and proceeds to\ndecrypt it. The attack chain is similar to that used by the Chinoxy backdoor, which also uses\nCannondriver.exe to load a malicious LBTServ.dll to deliver its payload.\n\nHowever, this current variant sent to the telecommunication agency in South Asia delivers\nthe final payload a bit differently than its predecessors. Instead of LBTServ.dll containing the\nfinal payload, it loads a shellcode from a separate file and injects itself into svchost.exe. It\nthen contacts instructor[.]giize[.]com, a dynamic DNS redirecting the connection to the\nattacker’s IP where the payload is hosted. Unfortunately, a remote file was not available at\nthe time of this investigation. Luckily, a [tweet by nao_sec identified PoisonIvy malware as the](https://twitter.com/nao_sec/status/1524727770252988416)\npayload.\n\nFigure 6. Tweet by nao_sec on May 12, 2022\n\nPoisonIvy is a Remote Access Trojan (RAT) that has been around for over a decade. Also\nknown as Pivy, the RAT is distributed in underground forums and allows an attacker to take\ncontrol of a compromised machine and perform reconnaissance activities through its GUI.\n\nFortiGuard Labs previously released a blog series detailing how PoisonIvy works:\n\nThe PoisonIvy RAT variant covered in those blogs performs lateral movement. As such, a\nsingle infection by PoisonIvy can lead to information being lifted from a wide range of\nmachines in the affected organization.\n\n## The Quest to Reveal the Attacker’s Identify\n\nAlthough PoisonIvy is known to have been used in targeted attacks, it’s not an easy task to\nidentify the attacker behind the operation targeting the telecommunication organization in\nSouth Asia. This is due to the number of reported threat actors that use the RAT and its wide\navailability.\n\n\n-----\n\nOur curiosity about the attacker led to another LBTServ.dll (SHA2:\n719f25e1fea12c8dc573e7161458ce7a5b6683dee3a49bb21a3ec838d0b35dd3), that was\nsubmitted to VirusTotal from France in January 2022. This file is dropped by a file with SHA2:\ncdf417e67b0aaf798ac7c0f9ccb8b5b21f09b408ee6748beea5e03e76902e7fe.\n\nOur analysis revealed that the file behaves similarly to the one in the email sent to the\ntargeted agency. It creates a folder (c:\\windows\\tasks) and drops config and PE files into it. A\ndropped executable file, unio.exe, is identical to the legitimate signed Logitech file disguised\nas Cannondriver.exe, described earlier in this blog. The unio.exe loads one of the other\ndropped files in the attack we are investigating, LBTServ.dll. In this case, LBTServ.dll\ncontains the full backdoor payload instead of loading a shellcode to download it. This\nLBTServ.dll file also takes advantage of DLL Search Order Hijacking, has eight fake exports,\nand has a malicious export also named LGBT_Launch. This led us to believe that both\nattacks most likely came from the threat actor but in a different campaign that likely occurred\nin January 2022 based on the file submission date to VirusTotal.\n\nMore interestingly, the compilation time of\n719f25e1fea12c8dc573e7161458ce7a5b6683dee3a49bb21a3ec838d0b35dd3 is “2016-0709 12:49:34 UTC” while the compilation time of its dropper (SHA2:\ncdf417e67b0aaf798ac7c0f9ccb8b5b21f09b408ee6748beea5e03e76902e7fe) is about 29\nseconds later, at 2016-07-09 13:18:11 UTC. These indicate this attacker group has been\nactive since at least mid-2016.\n\n## A Tale of PivNoxy and Chinoxy Puppeter\n\nWe will now look at a partial history of the techniques used by this threat actor. Specifically,\nwe will focus on their use of a file best described as the Logitech Bluetooth Wizard Host\nProcess. This legitimately signed file contains a DLL Search Order hijacking vulnerability.\nThe APT group takes advantage of this vulnerability by creating their own malicious\n“LBTServ.dll” file to be loaded whenever the real Logitech process is executed. Over time,\nthis malicious DLL has evolved to use different techniques. The attack chain usually starts\nwith an email containing an attachment. The attachment itself contains an executable that,\nwhen executed, drops the malicious DLL, the legitimate Logitech executable, and any\nassociated files used by the malware.\n\nBelow is a timeline of dropper malware used by the threat actor utilizing the technique\ndescribed above to deliver Chinoxy, PivNoxy, and recent Chinoxy variants.\n\nFigure 7. Sample timeline of dropper malware based on file compilation time Note: Q1, Q2,\nQ3, and Q4 refer to January to March, April to June, July to September, and October to\nDecember, respectively.\n\n\n-----\n\nAs seen in the timeline, in Q3 of 2021, the threat actor switched their arsenal from PivNoxy\nto a new variant of Chinoxy, which decrypts and loads shellcode from a file and downloads\nthe next payload. The switch from Chinoxy to PivNoxy occurred sometime in Q2 2020.\n\nFortiGuard Labs has documented that from the middle of 2016 to the end of 2018,\n“LBTServ.dll” was consistently used by the variant known as Chinoxy. In this form, the\nmalicious DLL loads an external configuration file named “k1.ini.”\n\nFigure 8. The configuration file used by Chinoxy\n\nThis configuration file typically contains a base64 string, which turns out to be the C2 server\nused by Chinoxy.\n\nFigure 9. Base64 decoded value from the Chinoxy configuration file\n\nThe “Remark” field contains the approximate date of the attack. This Chinoxy DLL sample\n(SHA2: 719f25e1fea12c8dc573e7161458ce7a5b6683dee3a49bb21a3ec838d0b35dd3),\naccording to its metadata, was compiled on Sat Jul 09 12:49:34 2016 GMT. The main\ndropper (SHA2:\ncdf417e67b0aaf798ac7c0f9ccb8b5b21f09b408ee6748beea5e03e76902e7fe) itself was\ncompiled on 2016-07-09 13:18:11 GMT. The turnaround time appears to have only been a\nfew days. Chinoxy operated as a backdoor and collected data from the infected computers. It\nis interesting to note that the same C2 server was used for over two years. Our telemetry\nindicates that an overwhelming majority of the traffic to this server originated from India.\n\nThings stayed relatively quiet until the end of 2020 and beginning of 2021 when the group\n[decided to return. Operation Nightscout started targeting gamers in Southeast Asia.](https://www.welivesecurity.com/2021/02/01/operation-nightscout-supply-chain-attack-online-gaming-asia/)\nNoxPlayer is an Android emulator and, like many programs, contacts servers to check for\nupdates. Instead of delivering their malware through email attachments, however, the APT\ngroup changed tactics and somehow compromised the update chain of NoxPlayer. A fake\nupdate package was sent to Southeast Asian gamers.\n\nSimilar to the Chinoxy case, this PivNoxy variant (SHA2:\n5c2a6b11d876c5bad520ff9e79be44dfbb05ee6a6ff300e8427deab35085bef6) uses a fake\nupdate package to unpack several files, including files that abuse the same DLL Search\nOrder Hijacking technique used against Logitech. However, in this case, “LBTServ.dll” was\nused to deliver malware more powerful than the previous iteration, with PivNoxy delivering\nthe PoisonIvy RAT through the malicious DLL. While other vendors report infected computers\nwere gamers from Southeast Asia, our telemetry suggests more infected gamers originated\nfrom Mexico.\n\nAt this point, this threat actor once again decided to go quiet. But fast forward to May 2022,\nand the spearphishing email disguised to come from a governmental division of Pakistan\nwas sent to a telecommunication organization in South Asia. And this time, it attempted to\n\n\n-----\n\ndeliver a new Chinoxy malware variant.\n\n## Regional Interest\n\nThe dropper malware covered earlier in this blog (SHA2:\ncdf417e67b0aaf798ac7c0f9ccb8b5b21f09b408ee6748beea5e03e76902e7fe) reaches out to\ngoog1eupdate[.]com. Based on FortiGuard telemetry gathered over the past six months,\nalmost 70% of the connections to the domain were made from Mexico, followed by 22% from\nIndia. Chinoxy variants also used this domain from 2016 to 2018.\n\nWe also found three similar samples connect to frontbeauty[.]dynamic-dns[.]net,\nbeautygirl[.]dynamic-dns[.]net, and 784kjsuj[.]dynamic-dns[.]net. Over the same past six\nmonths, all access to the three domains was made from India. As they are dynamic DNS, not\nall connections can be considered related to the threat actor. However, a [Bitdefender report](https://www.bitdefender.com/files/News/CaseStudies/study/379/Bitdefender-Whitepaper-Chinese-APT.pdf)\npublished in November 2020 references the domain “goog1eupdate[.]com” as part of the\nIOCs for an APT group that uses the FunnyDream backdoor as part of their toolset and who\nprimarily targeted South-Eastern Asia. Access to another C2 address, “mfaupdate[.]com”,\nwas mainly observed from Mexico and India, while “ru[.]mst[.]dns-cloud[.]net” was primarily\n[accessed from Israel and Ukraine. According to security researcher Sebastien Larinier,](https://twitter.com/Sebdraven/status/1239853425594155008)\nru[.]mst[.]dns-cloud[.]net was used by a threat actor who targeted Kirghizstan. Further, a\n[research blog released by NTT Security lists another C2 server, “eofficeupdating[.]com“, as](https://insight-jp.nttsecurity.com/post/102glv5/pandas-new-arsenal-part-3-smanager)\nbeing used by this threat actor as a C2 server for Smanager malware, which was used\nagainst Vietnam. NTT Security attributed Smanager to an unknown Panda group. Panda is\n[typically part of the monikers used by Chinese threat actors, such as Deep Panda and](https://www.fortinet.com/blog/threat-research/deep-panda-log4shell-fire-chili-rootkits)\n[Goblin Panda.](https://www.fortinet.com/blog/threat-research/cta-security-playbook--goblin-panda)\n\nThis evidence indicates that the threat group we are after has a particular interest not only in\nSouth-East Asia but also in South and Central Asia and potentially Mexico. Or at the least,\nthey have a relationship with an attacker with interests there.\n\n## Conclusion\n\nThe attack against a telecommunications agency in South Asia began with a simple email\nthat initially appeared to be a standard malicious spam email message. However, the\nattached Word doc was weaponized using a malicious tool, Royal Road, and is equipped\nwith an exploit for an Equation Editor vulnerability (CVE-2018-0798). While a payload was\nunavailable at the time of the investigation, OSINT research points to the Poison Ivy RAT,\nwhich FortiGuard Labs has previously highlighted.\n\nBased on our analysis, Asian organizations, and potentially some in Mexico, were a\nreconnaissance target of a threat actor that we believe was also involved in Operation\nNightScout in 2021. This threat actor, who uses Chinoxy and PivNoxy in their arsenal, has\nbeen active since at least mid-2016.\n\n\n-----\n\n## Fortinet Protections\n\nThe following (AV) signatures detect the samples mentioned in this blog:\n\n**Older Chinoxy variants**\n\nW32/Chinoxy.AP!tr\nW32/Chinoxy.Z!tr\nW32/Generic.AC.433BE8\nW32/PossibleThreat\n\n**PivNoxy**\n\nW32/Kryptik.HHBQ!tr\nW32/Injector.KR!tr\nW32/Rekvex.IY!tr\nW32/PossibleThreat\n\n**Newer Chinoxy variants**\n\nW32/ERUG!tr\nW32/PossibleThreat\n\n**Older Chinoxy dropper**\n\nW32/Chinoxy.AA!tr\nW32/Agent.BJWZYI!tr\nW32/Daws.DIGU!tr\nW32/Daws.EKFE!tr\nW32/Daws.EQVO!tr\nW32/Generic.AC.433BE8\nW32/Kryptik.GQMK!tr\nW32/RENOS.SM1!tr\nW32/Zuguo.A!tr\nRTF/CVE_2017_11882.A!exploit\n\n**PivNoxy dropper**\n\nW32/Agent.SMC!tr\nW32/Generik.CIJIXOM!tr\nW32/Injector.KR!tr\nW32/Injector.SMC!tr\nW32/Kryptik.HHBQ!tr\nW32/Rekvex.IY!tr\nW32/Rekvex.JOHUGYE!tr\nW32/Rekvex JOHUGYE!tr\n\n\n-----\n\nW32/RENOS.SM1!tr\nW32/Zuguo.A!tr\n\n**Newer Chinoxy dropper**\n\nW32/Agent.ADWJ!tr\nW32/ERUG!tr\nW32/PossibleThreat\nMalicious_Behavior.SB\n\nAll network-based URIs are blocked by the WebFiltering client.\n\nFortinet has multiple solutions designed to help train users to understand and detect phishing\nthreats:\n\nThe [FortiPhish Phishing Simulation Service uses real-world simulations to help organizations](https://www.fortinet.com/products/phishing-simulation)\ntest user awareness and vigilance to phishing threats and to train and reinforce proper\npractices when users encounter targeted phishing attacks.\n\nIn addition to these protections, we suggest that organizations also have their end users go\nthrough our FREE [NSE training:](https://training.fortinet.com/?utm_source=blog&utm_campaign=nse-institute) [NSE 1 – Information Security Awareness. It includes a](https://training.fortinet.com/local/staticpage/view.php?page=nse_1&utm_source=blog&utm_campaign=nse-1)\nmodule on Internet threats designed to help end users learn how to identify and protect\nthemselves from various types of phishing attacks.\n\n## IOCs\n\n### File IOCs\n\n**Older Chinoxy variants**\n\n719f25e1fea12c8dc573e7161458ce7a5b6683dee3a49bb21a3ec838d0b35dd3\n75f7b6197d648eaa8263d23c8f9aa9224038259d25df073803929d6582ea27b1\na33dcbd2ccf291ebd465bfcd6a9be10b3d6c0d89fa5ee0038a2e41fbd6c0397d\n5137bc35b042c0ea2ad56f3b0e03191e840cce9e9dadb470d6a7a018f3a1a4fb\nb0ad5af44a0a07a2408e9a6b4e4a27e366aa64350ff60f398d1b8086172034f6\na8c21cb9dea1c9bc62adcc6de4a73c7971ea797ab4fdb93320532647625e22ba\n6f7f142089b1d2e48880f59362c7c50e5d193166bdd5e4b27318133e8fe27b2c\n399563e798edd4a9e1a89209b1b350a4e1197786c23c0986a1a965446e7d5474\na8c21cb9dea1c9bc62adcc6de4a73c7971ea797ab4fdb93320532647625e22ba\n\n**PivNoxy**\n\na638cce32a01f63febe2d21b02ef9f6f6c6c59e2107a043eb2ae547ff9a1d776\n8ceb84e33db56092618f763771630b0759d7122d5df5afaeb4c1ebc9e72ed7f1\n\n\n-----\n\na4cbae07c1d674d41c1297be4e0c19b2f138c2ef29db16b5edc528026dc4e717\n6ab62f7cd1c4a00c200cd130afa7352bb6e536e324cb9ead13e01e54146bb112\naf7d3f46c32f4040dbfb6f85d6db1471e29c4a9290654d3f44351e316f05fba5\na557eed41c5e021209c7e3a3eada10abf43e2bfabf930552b6cb7a4b7568b971\nd49c0d6113a9928486e35a7013d9c09a52743bd8fe84712e27c54fcac9b9e31e\n53c7ab494527a8118f89ba99dea51b223f98e368e687f42d31925945b0282e87\n\n**Newer Chinoxy variants**\n\nc8934c7b3187e48b1ee44fc2c8e1c3ab19850efc1e45383442cfe4b9b4a06d01\nd59278ff54d30176263deadcb7d21ba6f9b7eb1139e3dcd6f7ea534183f96c92\n\n**Chinoxy dropper**\n\ncdf417e67b0aaf798ac7c0f9ccb8b5b21f09b408ee6748beea5e03e76902e7fe\nf8a8ccfa6426f27da75649dbef26213aae6137f726d29232e45e4183391016bf\n9f93a50cadd762d36788ce1c8d5deb2d26e109f717f3e2d4d5c8f0d3344de725\na8f1e7eccae75e840b1d6982b06ee322ceaed65ade23a10d17c8414e5a522110\n6a8ba940d40be935ffc623b5fadfdb4537c1787fedf5889021b0ceb65dfa809d\n59ea7516b2a028e5cad938534099f45b5d28f7cfa32d268a8bdcbe5f6320b5a6\n07a37e52533bf26f5d506c69e748f479de5dcd416103f8d7a4a06c948e1051ad\n152f95a5bdf549c5ca789d0dd99d635ee69cca6fe464ced5b39d0316707a4914\n947760b4f688863708741457297d74810ad45e20e2c02d91b54b056716803777\n3f21e0b3ef80fd9393c6e187311a78aee22738f510ed227397249157b131b890\n3c9d802f617aab4c6973cef74d2509fea00ee8454681c40df09a4734946e5125\n82f8cf41aa720e268ee0c6e43cd52512ea4a2f98a51844071e0faaf1eb13ce62\n\n**PivNoxy dropper**\n\n2bebd0989d1d8c6bb681217399281640521d61ce207f358a4340377898ed44c5\n6485d76e645d2f7e27a20d072f07c282583f21ec42801de588193d01b591a957\n8dfda79f7848a41f0a8f7a68096fcb6783ace3f3430ae3d7d05fed1ad4533fe0\n86c563a8630150934ae7468e074f81914d26b978c32571ce9f4d9b349dc03349\n72a7341805713327f09f881bc7184610ed28101bfbda93fd829d0d52978c22eb\n4d9af80dad6dcdfe37931094c42296d53ef6d98b633db32503d7972fd7e0e3f6\ne537b6eb903d9bb9b3cb0e63f9fddf2afa0875af7558b5bec3c98cebf1452e01\nc25ae716a651c7c846871275bfde7188224628e3380fd6f256aacba1cb15ad61\n289ce24d873986d607ab8e43f499be562fa4925d2b5be16bb31ce68a00b4020a\nf229239ed7665338961eec60a17bcca0fed1eb957b0e751dd991ce664140d79c\n5c2a6b11d876c5bad520ff9e79be44dfbb05ee6a6ff300e8427deab35085bef6\n\n**Newer Chinoxy dropper**\n\nab49e15c0a0e4f977748faae36255889c2239cde847ed49304881c123b9a0e99\n8d7d259ac375171c59ac81ba9a16949ac7277c8ed3841c229ce48def0358c96e\n\n\n-----\n\na8d92ace0ea438759428877a32cd92f73790d86d0e3384317c04a9ae4ed30c55\nc44be5ed5c4bec2be72ce9737bde5a2d48fe5fb0ea235ddc61ba447b26642949\nd863f559ba323625f20721e910bf920ee73a5303f6edadbec2aa670b640e01c8\nf309b42845ca3e36e0bb6ec68f424a11ff8f77642afc3bd4425118dc0d2514e0\n\n**Network IOCs**\n\ngoog1eupdate[.]com\nmyhost[.]camdvr[.]org\nmfaupdate[.]com\neofficeupdating[.]com\n58[.]64[.]184[.]201\ncdn[.]cloudistcdn[.]com\nq.cloudistcdn.com\nbeautygirl[.]dynamic-dns[.]net\n784kjsuj[.]dynamic-dns[.]net\nfrontbeauty[.]dynamic-dns[.]net\ninstructor[.]giize[.]com\n\n## MITRE\n\n**Resource**\n**Development**\n\n**T1854.004** Compromise Infrastructure: Server\n\n**Initial Access**\n\n**T1566.001** Phishing: Spearphishing Attachment\n\n**T1195.002** Phishing: Compromise Software Supply Chain\n\n**Execution**\n\n**T1203** Exploitation for Client Execution\n\n**T1053.005** Scheduled Task/Job: Scheduled Task\n\n**T1201.002** User Execution: Malicious File\n\n\n-----\n\n**T1543.003** Create or Modify System Process: Windows Service\n\n**Persistence**\n\n**T1574.001** Hijack Execution Flow: DLL Search Order Hijacking\n\n**T1053.005** Scheduled Task/Job: Scheduled Task\n\n**T1547.001** Boot or Logon Autostart Execution: Registry Run Keys/Startup\nFolder\n\n**T1547.014** Boot or Logon Autostart Execution: Active Setup\n\n**Privilege Escalation**\n\n**T1574.001** Hijack Execution Flow: DLL Search Order Hijacking\n\n**T1055.001** Process Injection: Dynamic-link Library Injection\n\n**T1053.005** Scheduled Task/Job: Scheduled Task\n\n**T1547.001** Boot or Logon Autostart Execution: Registry Run Keys/Startup\nFolder\n\n**T1547.014** Boot or Logon Autostart Execution: Active Setup\n\n**Defense Evasion**\n\n**T1140** Deobfuscate/Decode Files or Information\n\n**T1574.001** Hijack Execution Flow: DLL Search Order Hijacking\n\n**T1055.001** Process Injection: Dynamic-link Library Injection\n\n**T1112** Modify Registry\n\n\n-----\n\n**T1027** Obfuscated Files or Information\n\n**Credential Access**\n\n**T1056.001** Input Capture: Keylogging\n\n**Discovery**\n\n**T1010** Application Window Discovery\n\n**Collection**\n\n**T1005** Data from Local System\n\n**T1074.001** Data Staged: Local Data Staging\n\n**T1056.001** Input Capture: Keylogging\n\n**Command and**\n**Control**\n\n**T1573.001** Encrypted Channel: Symmetric Cryptography\n\n**T1105** Ingress Tool Transfer\n\n**Exfiltration**\n\n**T1041** Exfiltration Over C2 Channel\n\n[The FortiGuard Labs has released a new playbook on the threat malware family known as](https://www.fortiguard.com/playbook/malware-chinoxy-pivnoxy)\n“Chinoxy” and “PivNoxy” as part of our role in the Cyber Threat Alliance. For more\ninformation regarding this series of adversary playbooks being created by CTA members,\n[please visit the Cyber Threat Alliance Playbook Whitepaper.](https://www.cyberthreatalliance.org/wp-content/uploads/2018/04/CTA_Adversary-Playbook-Principles_White-Paper.pdf)\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[and the FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-22 - A Tale of PivNoxy and Chinoxy Puppeteer.pdf"
    ],
    "report_names": [
        "2022-08-22 - A Tale of PivNoxy and Chinoxy Puppeteer.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "068b67c8-604c-4272-b808-350413fa9ee3",
            "created_at": "2022-10-25T16:07:23.975708Z",
            "updated_at": "2025-03-27T02:02:10.058689Z",
            "deleted_at": null,
            "main_name": "Operation NightScout",
            "aliases": [],
            "source_name": "ETDA:Operation NightScout",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7a9a7873-8e41-40ae-9d06-b27c92bb54e4",
            "created_at": "2022-10-25T16:47:55.568362Z",
            "updated_at": "2025-03-27T02:05:17.264615Z",
            "deleted_at": null,
            "main_name": "BRONZE FIRESTONE",
            "aliases": [
                "C0d0s0",
                "Deep Panda ",
                "Pupa ",
                "TG-3551 ",
                "APT19 "
            ],
            "source_name": "Secureworks:BRONZE FIRESTONE",
            "tools": [
                " Alice's Rabbit Hole",
                " Briba",
                " Cobalt Strike",
                " Derusbi",
                " PlugX",
                " PoisonIvy",
                " Powershell Empire",
                " Zuguo",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b98eb1ec-dc8b-4aea-b112-9e485408dd14",
            "created_at": "2022-10-25T16:07:23.649308Z",
            "updated_at": "2025-03-27T02:02:09.906895Z",
            "deleted_at": null,
            "main_name": "FunnyDream",
            "aliases": [
                "Bronze Edgewood",
                "Red Hariasa",
                "TAG-16"
            ],
            "source_name": "ETDA:FunnyDream",
            "tools": [
                "Chinoxy",
                "Filepak",
                "FilepakMonitor",
                "FunnyDream",
                "Keyrecord",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Md_client",
                "PCShare",
                "ScreenCap",
                "TcpBridge",
                "Tcp_transfer",
                "ccf32"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "64ca1755-3883-4173-8e0a-6e5cf92faafd",
            "created_at": "2022-10-25T15:50:23.636456Z",
            "updated_at": "2025-03-27T02:00:55.51077Z",
            "deleted_at": null,
            "main_name": "Deep Panda",
            "aliases": [
                "Deep Panda",
                "Shell Crew",
                "KungFu Kittens",
                "PinkPanther",
                "Black Vine"
            ],
            "source_name": "MITRE:Deep Panda",
            "tools": [
                "Mivast",
                "StreamEx",
                "Sakula",
                "Tasklist",
                "Derusbi"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b5550c4e-943a-45ea-bf67-875b989ee4c4",
            "created_at": "2022-10-25T16:07:23.675771Z",
            "updated_at": "2025-03-27T02:02:09.918749Z",
            "deleted_at": null,
            "main_name": "Gelsemium",
            "aliases": [
                "Operation NightScout",
                "Operation TooHash"
            ],
            "source_name": "ETDA:Gelsemium",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agentemis",
                "BadPotato",
                "CHINACHOPPER",
                "China Chopper",
                "Chrommme",
                "Cobalt Strike",
                "CobaltStrike",
                "FireWood",
                "Gelsemine",
                "Gelsenicine",
                "Gelsevirine",
                "JuicyPotato",
                "OwlProxy",
                "Owowa",
                "SAMRID",
                "SessionManager",
                "SinoChopper",
                "SpoolFool",
                "SweetPotato",
                "WolfsBane",
                "cobeacon",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2c7ecb0e-337c-478f-95d4-7dbe9ba44c39",
            "created_at": "2022-10-25T16:07:23.690871Z",
            "updated_at": "2025-03-27T02:02:09.921431Z",
            "deleted_at": null,
            "main_name": "Goblin Panda",
            "aliases": [
                "1937CN",
                "Conimes",
                "Cycldek",
                "Goblin Panda"
            ],
            "source_name": "ETDA:Goblin Panda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "BackDoor-FBZT!52D84425CDF2",
                "BlueCore",
                "BrowsingHistoryView",
                "ChromePass",
                "CoreLoader",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "DropPhone",
                "FoundCore",
                "HDoor",
                "HTTPTunnel",
                "JsonCookies",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NBTscan",
                "NewCore RAT",
                "PlugX",
                "ProcDump",
                "PsExec",
                "QCRat",
                "RainyDay",
                "RedCore",
                "RedDelta",
                "RoyalRoad",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Win32.Staser.ytq",
                "USBCulprit",
                "Win32/Zegost.BW",
                "Xamtrav",
                "ZeGhost",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0639667a-fb3f-43d9-a38c-6c123fd19c7f",
            "created_at": "2022-10-25T16:07:23.335869Z",
            "updated_at": "2025-03-27T02:02:09.743237Z",
            "deleted_at": null,
            "main_name": "APT 19",
            "aliases": [
                "APT 19",
                "Bronze Firestone",
                "C0d0so0",
                "Codoso",
                "Deep Panda",
                "Operation Kingslayer",
                "Red Pegasus",
                "Sunshop Group",
                "TG-3551"
            ],
            "source_name": "ETDA:APT 19",
            "tools": [
                "Agentemis",
                "C0d0so0",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "EmPyre",
                "EmpireProject",
                "Fire Chili",
                "PowerShell Empire",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7d553b83-a7b2-431f-9bc9-08da59f3c4ea",
            "created_at": "2023-01-06T13:46:39.444946Z",
            "updated_at": "2025-03-27T02:00:03.093712Z",
            "deleted_at": null,
            "main_name": "GOBLIN PANDA",
            "aliases": [
                "Conimes",
                "Cycldek"
            ],
            "source_name": "MISPGALAXY:GOBLIN PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535979,
    "ts_updated_at": 1743041820,
    "ts_creation_date": 1662027740,
    "ts_modification_date": 1662027740,
    "files": {
        "pdf": "https://archive.orkl.eu/df77c66a3236f5bc01bed00572cbe8a319c8ba8b.pdf",
        "text": "https://archive.orkl.eu/df77c66a3236f5bc01bed00572cbe8a319c8ba8b.txt",
        "img": "https://archive.orkl.eu/df77c66a3236f5bc01bed00572cbe8a319c8ba8b.jpg"
    }
}