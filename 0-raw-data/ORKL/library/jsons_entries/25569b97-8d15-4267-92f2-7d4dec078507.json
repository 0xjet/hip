{
    "id": "25569b97-8d15-4267-92f2-7d4dec078507",
    "created_at": "2023-06-05T02:07:35.14581Z",
    "updated_at": "2025-03-27T02:05:58.70335Z",
    "deleted_at": null,
    "sha1_hash": "0d19d21a750fea8cff4be64a8cd566775cf795ac",
    "title": "2023-05-03 - UnpacMe Weekly- New Version of IcedId Loader",
    "authors": "",
    "file_creation_date": "2023-06-04T12:26:29Z",
    "file_modification_date": "2023-06-04T12:26:29Z",
    "file_size": 232919,
    "plain_text": "# UnpacMe Weekly: New Version of IcedId Loader\n\n**[blog.unpac.me/2023/05/03/unpacme-weekly-new-version-of-icedid-loader](https://blog.unpac.me/2023/05/03/unpacme-weekly-new-version-of-icedid-loader)**\n\nSean Wilson May 3, 2023\n\n[Sean Wilson](https://blog.unpac.me/author/sean/)\nMay 3, 2023\n\n3 min read\n\n## Highlights\n\n[Added support for newly observed version of IcedId Core Loader Fork and](https://www.unpac.me/results/6fff8dc0-4fe5-413c-a52f-05267118550b?ref=blog.unpac.me#/) IcedId\nLoader Fork\n[Nullmixer SEO search result poisoning delivering LegionLoader](https://www.unpac.me/results/4e4d4e5d-e399-4ac9-96d4-9aea5fd1b93d?ref=blog.unpac.me#/)\nString search: Performance improvements and bug fixes\n\n## New Features\n\n[This week we continued work on improving our new string search feature. Based on your](https://blog.unpac.me/2023/04/25/unpacme-weekly-search-everything/)\nfeedback and bug reports, we've made several improvements to the overall speed and\n[stability of search. In addition to search we also pushed some changes to Yara Hunt to](https://www.unpac.me/yara/search?ref=blog.unpac.me)\nimprove the overall scan performance of Yara scans.\n\n## Threat Spotlight: New IcedID Loader Fork\n\nOn April 30, 2023 we observed a new version of the previously forked IcedID loader and\n[core loader. The initial fork of these components was detailed by Proofpoint in March 2023.](https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid?ref=blog.unpac.me)\nThis new fork contains some significant updates to both components.\n\n\n-----\n\n**Forked Loader Updates**\n```\n   b40076de066f06cfd29f43ae69d1e8c1627021a06bf2edff654626671acfb752\n\n```\nThe loader configuration file is no longer encrypted using a simple XOR algorithm with\na 64-byte key.\nThe new load configuration file encryption algorithm is the same custom algorithm\n[previously used by the core loader detailed in the mwcfg module](https://github.com/c3rb3ru5d3d53c/mwcfg?ref=blog.unpac.me) [icedid_peloader.py](https://github.com/c3rb3ru5d3d53c/mwcfg-modules/blob/f1064aea63d11b5069a1839cf2b9d10d43cee1aa/icedid/peloader/icedid_peloader.py?ref=blog.unpac.me)\n\n**Forked Core Loader Updates**\n```\n   27483870f4df637c7532e41c61e2ee1b6734b28bf511855b68c61abad031c8c8\n\n```\nThe IcedID bot is now embedded directly in the core loader instead of being delivered\nin a separate .datfile.\nWith the bot embedded in the core loader the command line parameter -```\n   tidu=\"license.dat\" is no longer required when launching loader.\n\n```\nThe embedded bot continues to use the same custom headerless “pe” format detailed\nby [Malwarebytes in 2019.](https://www.malwarebytes.com/blog/news/2019/12/new-version-of-icedid-trojan-uses-steganographic-payloads?ref=blog.unpac.me)\nThe bot \"pe\" sections are split between .text `.rdata and .data sections in the core`\nloader (one section in each).\nThe core loader combines these disparate sections into a single blob of data which is\nthen decrypted using XOR with a hard coded 32-byte ascii key\n```\n   zzfersksximkogxswguwqvngtjkvvzjy.\n\n```\nThe decrypted blob is then passed through the same custom decryption routine used\n[by previous version of the core loader as detailed in the mwcfg module](https://github.com/c3rb3ru5d3d53c/mwcfg?ref=blog.unpac.me)\n[icedid_peloader.py](https://github.com/c3rb3ru5d3d53c/mwcfg-modules/blob/f1064aea63d11b5069a1839cf2b9d10d43cee1aa/icedid/peloader/icedid_peloader.py?ref=blog.unpac.me)\nOnce decrypted the plaintext blob is then loaded into memory using the custom IcedId\n“pe” loader.\nThe PDB path in the new core loader fork E:\\source\\anubis\\int```\n   bot\\x64\\Release\\int-bot.pdb indicates that this new version is internally referred to\n\n```\nas `int-bot`.\n\n## Weekly Threat Hunting\n\nAs in recent weeks, we continue to see an almost even distribution between Downloaders,\n_InfoStealers, and Remote Access Trojans (RATs). Analysis of the top user submitted files_\n[shows a near identical trend as last week with the top threats being AgentTesla,](https://www.unpac.me/results/87b376b3-0dcb-4338-8b41-47c9175b8628?ref=blog.unpac.me#/) _[Amadey,](https://www.unpac.me/results/8b57b323-6501-44eb-bae3-73d783e4744b?ref=blog.unpac.me#/)_\n[SmokeLoader, and](https://www.unpac.me/results/6f8e1479-af08-49e2-914b-d8ba27bddd69?ref=blog.unpac.me#/) _[SnakeKeylogger. One notable change was an overall drop in submitted](https://www.unpac.me/results/84cc9978-4f3a-406d-be8e-d5642bb548cc?ref=blog.unpac.me#/)_\n_[FormBook samples.](https://www.unpac.me/results/70ff27ed-f102-4e69-8d9d-e09a7bbfca50?ref=blog.unpac.me#/)_\n\n[Continued analysis of .NET based malware families confirmed some of our suspicions last](https://blog.unpac.me/2023/04/25/unpacme-weekly-search-everything/)\n[week regarding the use of XorStringsNET. We have been tracking samples from additional](https://github.com/dr4k0nia/XorStringsNET?ref=blog.unpac.me)\n[.NET malware families such as RedLine Stealer and XWorm leveraging the tool for an](https://www.unpac.me/results/0fe69b7a-1fe7-4d34-a2f3-0c18994eabc8?ref=blog.unpac.me#/)\nadditional layer of obfuscation.\n\n\n-----\n\n[Over the past week, monitoring of the UnpacMe Threat Feed has corroborated our](https://www.unpac.me/feed?ref=blog.unpac.me)\nsuspicions regarding the increase of AgentTesla samples. We are seeing that over 80% of\n[submitted AgentTesla samples are using the XORStringsNET string encryption. We expect](https://www.unpac.me/results/8a77cc81-6f13-4f1b-b380-b62752d15e6d?ref=blog.unpac.me#/)\nthat over the next couple of weeks we will likely see an increase in several .NET malware\nfamilies that leverage the tool, as it gains popularity among less-skilled threat actors.\n\nLast Week's Top Submitted Threats\n\n## Threat Coverage\n\nWe've added and improved coverage for the following malware families.\n\nIcedId Fork(s) - A new fork of the previously forked IcedId first [observed by ProofPoint](https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid?ref=blog.unpac.me)\n[in 2023. New versions of the forked loader and](https://www.unpac.me/results/e8819691-d52c-40c3-b03d-884a73fca74a?ref=blog.unpac.me) [forked core loader were first observed](https://www.unpac.me/results/77728a43-a8c3-4018-8d53-8835d30c168d?ref=blog.unpac.me)\nby [UnpacMe on April 30, 2023. This new fork contains significant changes from the](https://www.unpac.me/?ref=blog.unpac.me#/)\nprevious version including a new custom decryption algorithm used by the core loader,\nand the inclusion of the bot in the core loader rather than deployed via separate .dat\nfiles. We have added a configuration extractors for both the forked loader and forked\ncore loader.\n\n\n-----\n\n[LegionLoader - LegionLoader (aka Satacom) a downloader and cryptocurrency stealer](https://www.unpac.me/results/4e4d4e5d-e399-4ac9-96d4-9aea5fd1b93d?ref=blog.unpac.me)\n[primarily distributed via the Nullmixer pay-per-install service. Nullmixer uses SEO to](https://securelist.com/nullmixer-oodles-of-trojans-in-a-single-dropper/107498/?ref=blog.unpac.me)\npoison search results with high ranked links to their malware for common search terms\nsuch as \"free pdfs\" and \"cracked software\". We've added a new configuration extractor\nfor LegionLoader to extract the command-and-control (C2) and encrypted strings.\n\nAs always, if you have any feedback or issues please let us know.\n\nHappy Unpacking!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-03 - UnpacMe Weekly- New Version of IcedId Loader.pdf"
    ],
    "report_names": [
        "2023-05-03 - UnpacMe Weekly- New Version of IcedId Loader.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1685930855,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1685881589,
    "ts_modification_date": 1685881589,
    "files": {
        "pdf": "https://archive.orkl.eu/0d19d21a750fea8cff4be64a8cd566775cf795ac.pdf",
        "text": "https://archive.orkl.eu/0d19d21a750fea8cff4be64a8cd566775cf795ac.txt",
        "img": "https://archive.orkl.eu/0d19d21a750fea8cff4be64a8cd566775cf795ac.jpg"
    }
}