{
    "id": "81e7db11-d41c-4def-8d1b-b24157ff86fe",
    "created_at": "2023-01-12T15:10:10.249512Z",
    "updated_at": "2025-03-27T02:06:02.044514Z",
    "deleted_at": null,
    "sha1_hash": "21a1843d6a633a1a09afb8ec24ce1b0c6fcbb675",
    "title": "2021-09-30 - Credential Harvesting at Scale Without Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:57:27Z",
    "file_modification_date": "2022-05-28T19:57:27Z",
    "file_size": 2121668,
    "plain_text": "# Credential Harvesting at Scale Without Malware\n\n**unit42.paloaltonetworks.com/credential-harvesting/**\n\nBrady Stout September 30, 2021\n\nBy [Brady Stout](https://unit42.paloaltonetworks.com/author/brady-stout/)\n\nSeptember 30, 2021 at 3:00 PM\n\n[Category: Ransomware,](https://unit42.paloaltonetworks.com/category/ransomware/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Business Email Compromise,](https://unit42.paloaltonetworks.com/tag/business-email-compromise/) [Cybercrime](https://unit42.paloaltonetworks.com/tag/cybercrime/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/credential-harvesting/)\n\n## Executive Summary\n\nWhile ransomware and ransomware-as-a-service (RaaS) attacks have dominated much of\nthe cybersecurity community’s discussions over the past several months, criminals and\nhackers continue to compromise corporate, business and personal emails for financial gain.\nThese scams, business email compromise (BEC) and personal email account compromise\n(EAC), continue to be the most pervasive and costly reported cyberthreats to users daily. In\nits latest [annual report, the Federal Bureau of Investigation (FBI) identified that BEC and](https://www.ic3.gov/Media/PDF/AnnualReport/2020_IC3Report.pdf)\nEAC accounted for at least $1.86 billion in losses within the U.S. in 2020, a 5% increase over\nlosses reported in 2019. BEC and EAC accounted for 45% of all 2020 reported cybercrime\nlosses in the U.S., and individuals over 60 years of age accounted for 11% of the reported\nvictims\n\n\n-----\n\n[By rough comparison, the largest known ransomware payoff to date is $40 million. The 2021](https://www.bloomberg.com/news/articles/2021-05-20/cna-financial-paid-40-million-in-ransom-after-march-cyberattack)\n[Unit 42 Ransomware Threat Report found that the average ransomware demand was](https://start.paloaltonetworks.com/unit-42-ransomware-threat-report)\n$847,344 in 2020, while the average ransom paid by victims was $312,493. In the first half of\n[2021, the average ransom paid climbed 82% to $570,000. These figures for average ransom](https://www.paloaltonetworks.com/blog/2021/08/ransomware-crisis/)\npaid are conservative in that they only include direct monetary losses in paid ransoms. They\ndo not include the losses associated with a company losing revenue while being forced to\noperate in a degraded state during an attack, and do not include resources spent\ninvestigating the breaches; they only include known attacks. Depending upon the nature of\nthe attack and potential data breach, a company can choose not to report a ransomware\nattack. Ultimately, this choice makes it challenging for the cybersecurity and law enforcement\ncommunities to determine the full scope of these crimes.\n\nOne thing that all of these attacks – BEC, EAC and ransomware – have in common is that\nthey require privileged access to targets’ networks or accounts. For most actors going\nagainst targets with average-to-below-average cyber defenses, masquerading as a\nlegitimate user or correspondent to get into a network or account remains the easiest and\nmost cost-effective way to gain clandestine access while maintaining a low risk of discovery.\nAs advanced persistent threats (APTs) have shown and the United States and United\nKingdom governments have observed, by using legitimate credentials and publicly available\ntechniques, malicious actors can “evade defenses and collect and exfiltrate various\ninformation in the networks.” While the APTs are successfully meeting their campaign goals\nwith brute force credential attacks, criminals, in many cases, are simply asking their unwitting\nvictims to hand over their credentials.\n\n[Palo Alto Networks Next-Generation Firewall customers are protected with the Advanced](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\n[URL Filtering security subscription and credential phishing prevention feature. In addition,](https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/url-filtering/prevent-credential-phishing.html)\n[Next-Generation Firewall customers are protected using the DNS Security subscription with](https://www.paloaltonetworks.com/network-security/dns-security.html)\n[its automatic malicious domain blocking and proactive detection capabilities.](https://unit42.paloaltonetworks.com/proactive-detector/)\n\nOrganizations can learn more about preventing email-based attacks such as credential\n[harvesting with a Business Email Compromise (BEC) Readiness Assessment.](https://www.paloaltonetworks.com/bec-readiness-assessment)\n\n## Evolving Techniques for Email Credential Harvesting\n\nThe lucrative nature of BEC/EAC scams drives criminals to continually modify and upgrade\ntheir tactics to defeat protections. One of the newer techniques integrates spear phishing,\ncustom webpages and the complex cloud single sign-on ecosystem to trick users into\nunwittingly divulging their credentials. A prevalent tactic uses seemingly benign webpages\nthat, once opened, closely mimic legitimate login screens for popular and often used services\nsuch as:\n\nOffice 365 and Outlook (login[.]microsoftonline[.]com)\nOutlook and Hotmail (login[.]live[.]com)\nDropbox (www[.]dropbox[.]com/login)\n\n\n-----\n\nZimbra (mail[.]zimbra[.]com)\n\n(Dropbox said in a statement, “This activity does not involve Dropbox's service. This\ndemonstrates the increasing complexity of relying on customers to discern real from fake,\nand while this doesn't involve our service, we are always working with our trusted partners to\nbe proactive and improve where and how customers are exposed to our brand and protect it\naccordingly.”)\n\nWhen scammers use this tactic, it usually starts with a baited email enticing the recipient to\nopen the attachment or click on the link to a webpage. The emails usually focus on some\nsegment of business operations (including finance, human resources, logistics and general\noffice operations) and point to an attachment or link related to topics requiring user action.\nThese topics include remittances, invoices, outstanding payments, requests for quotes\n(RFQ), purchase confirmation, shipment status, voice mails or fax delivery via email, to name\na few. To make the email seem more legitimate, some criminals integrate specific information\nabout the target in meaningful ways, including within the subject of the email. Some recent\nemail subjects include:\n\nOneDrive Document to {username}\n{Company Name} New FaxMail Received {DD/MM/YYYY}\n{Company Name} New FaxMail Received {DDMMYYYY}\n{username} 1 voice message received {M/D/YYYY}\nVNotes transmitted to {username}\nMailbox Verification for {email address}\n\nOnce opened, the email presents the user with what appears to be a typical login page. In an\nattempt to lower suspicion, scammers often highlight the need for heightened security or that\nthe service logged the user out. In some cases, the pages are sent with the user’s email\naddress already included (again in an attempt to enhance the legitimacy of the request) and\nsimply ask for the password. These misleading login screens have alerts such as:\n\nYou need to sign in with your email to ensure you are the rightful recipient of the\nprotected file. File is protected by [insert security vendor] for Mail Servers.\nTo read the document, please enter with the valid email credentials that this file was\nsent to.\nBecause you're accessing sensitive info, you need to verify your password.\nAuthentication needed because you're accessing a sensitive document.\nThis device is not recognized. For security, [company name] want [sic] to make sure it's\nreally you.\nYour email account {username} has been signed out, click ok to sign in.\nPlease log in to your account to view secured files\nYou have been logged out! Please enter your correct Email and password!\nGet to your documents from anywhere by signing into Office.\n“Your password is security to view your fax message.\n\n\n-----\n\nFigure 1a. Example of a malicious login request impersonating Microsoft, requiring\ncredentials for document access.\n\n\n-----\n\nFigure 1b. Example of a malicious login request impersonating SharePoint, requiring\ncredentials for document access.\n\n\n-----\n\nFigure 1c. Example of a malicious login request impersonating Microsoft, requiring\ncredentials for document access.\nScammers are also adding clever tactics to further deceive users. In some instances, they\nare custom building their “login” templates to match the look and feel of the corporate email\nsystems used by the specific companies they are targeting. In others, they are automatically\ndetecting the affiliated company based on the domain portion of the user’s email address\nand then integrating that company’s logo into a fraudulent webpage.\n\nFigure 2. Example of JavaScript used to identify an organization from a victim’s email\naddress and then incorporate its logo into followup pages.\n\n\n-----\n\nIn addition, many criminals are adding logic into their code to ensure that credentials are\naccurately entered by the user. An incorrectly formatted email address or blank password will\ngenerate an error directing the user to retry. Some criminals are also automatically\nresponding to the first correctly formatted attempt with \"Incorrect password please try again.\"\nThese techniques increase the likelihood of criminals receiving valid passwords and\npotentially reduces the suspicion of cautious users who perhaps first enter bogus credentials\nto see if the request is legitimate.\n\nFigure 3. Example of JavaScript used to validate credentials.\nSuppose scammers believe that their chances of getting a user to open a file attachment are\ntoo low or that they can create a somewhat believable fully qualified domain name. In that\ncase, they can also simply point the user to a website on a legitimate hosting service where\nthe above techniques are incorporated within a hosted page. Some of the recent malicious\nwebsites a user could mistakenly navigate to include:\n\nexcel-client-login[.]azurewebsites[.]net\nexcel-docs-storage[.]us-south[.]cf[.]appdomain[.]cloud\nmicrosoftvoicemessage-office365voicemessage-releaseandlistentov[.]s3[.]eude[.]cloud-object-storage[.]appdomain[.]cloud\nonline-access-app[.]azurewebsites[.]net\nredirect-office365[.]web[.]app\n\nOnce a user enters and submits credentials, the web browser sends the information in an\nHTTP post request to a URL most often ending in *.php. As a hypertext processor, PHP\nenables the scammer to easily capture any received credentials, decode them and store\nthem within a database. In addition, while the web domains enabling these scams can be\npurchased and maintained by criminals, we see significant use of previously compromised\nand coopted legitimate domains to meet these scammers’ needs.\n\n\n-----\n\nThis malicious use of coopted legitimate infrastructure poses two primary challenges for\nnetwork defenders. First, identifying the traffic as malicious is difficult due to it taking place\nbetween two potentially trusted networks. Second, blocking the legitimate domain, once\nidentified as hosting malicious activities, is often not possible, as it would also block the\ndomain’s legitimate and often required content. For these reasons as well as the zero cost,\nhackers are increasingly relying on coopted infrastructure to meet their desired ends.\n\nTo help keep users from becoming suspicious when they fail to log in to a fake site,\nscammers commonly incorporate one of the following:\n\nRedirection to the legitimate site the user believes they are logging in to, which – if\nalready logged in – will take them directly into their account, thereby increasing their\nsense of the request’s legitimacy.\nA “service unavailable error” recommending they try again later.\nA “file not found” error.\nA “scanned file locked” error and “redirecting back to your account,” which then\nredirects the user back to their legitimate inbox.\nGeneric content.\nContent custom-crafted for the phishing attempt.\n\nOnce criminals have valid user credentials, they are one step closer to defrauding a\ncompany or user of their money. Using the harvested credentials, a criminal will conduct an\ninitial reconnaissance of the user’s documents, transactions and correspondence. Armed\nwith this information, a criminal is now better informed to be able to: identify additional\ntargets of value, understand normal business processes and approval chains, leverage the\nuser’s documents or shared file access to create custom phishing documents, and use the\naccount for financial gain or to pivot into more lucrative environments by masquerading as\nthe account user.\n\n## Conclusion\n\nMalicious tactics such as those described above can be very challenging for an enterprise or\nuser to detect. In addition, most cybersecurity products will often not automatically detect\nthese activities as malicious due to scammers using exact copies of legitimate webpages in\ntheir scams and not incorporating trojans, spyware, keyloggers or other malware into their\nharvesting attempts. Unit 42 researchers recommend the following to mitigate the risk of\nemail compromise posed by the above tactics:\n\nImplement multi-factor authentication for all business and personal accounts.\nContinually update and train users on the evolving tactics and social engineering used\nin BEC/personal EAC scams.\nIncorporate the [Zero Trust mindset, “Never trust, always verify.”](https://www.paloaltonetworks.com/cyberpedia/what-is-a-zero-trust-architecture)\nEnsure users and administrators understand that even if a file successfully passes a\nvirus scan, it could still have a malicious purpose.\n\n\n-----\n\nEnsure users understand which services are single sign-on and the legitimate URLs for\naccessing those accounts.\nChange passwords regularly, use one complex password per account and use a\npassword manager to keep track of credentials.\n\n[Palo Alto Networks Next-Generation Firewall customers are protected with the Advanced](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\n[URL Filtering security subscription and credential phishing prevention feature. In addition,](https://docs.paloaltonetworks.com/pan-os/10-0/pan-os-admin/url-filtering/prevent-credential-phishing.html)\n[Next-Generation Firewall customers are protected using the DNS Security subscription with](https://www.paloaltonetworks.com/network-security/dns-security.html)\n[its automatic malicious domain blocking and proactive detection capabilities.](https://unit42.paloaltonetworks.com/proactive-detector/)\n\nOrganizations can learn more about preventing email-based attacks such as credential\n[harvesting with a Business Email Compromise (BEC) Readiness Assessment.](https://www.paloaltonetworks.com/bec-readiness-assessment)\n\n### Hashes of Generic JavaScripts/HTML Used in These Techniques\n\n**Example of Basic JavaScript**\n\ne431d360ace31e17596b7017e1a11009aa3a02000d319919a266136ec11be479\n\n**Example of “+my_slice” and Re-Direction After Two Attempts**\n\n3ed082d4de4fe1d4155cb605276eecee07d11888c6cf45ffb7d9f00c6bc036b1\n\n**Example of “+my_slice” Repurposed by Actor Potentially Located in Southeast Asia**\n\nb920ac8eb9b1ac92e64fdd2df083dc7a84bca3dedcb42fd2b3959f76711607f7\n\n**Example that Prevents Shortcuts (Such as Ctrl-S) Using JavaScript KeyCodes**\n\n58ebf83741da3805955edfcf83f2b1af56a320d76954c243991fed92faeebe63\n\n### Additional Resources\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-30 - Credential Harvesting at Scale Without Malware.pdf"
    ],
    "report_names": [
        "2021-09-30 - Credential Harvesting at Scale Without Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536210,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653767847,
    "ts_modification_date": 1653767847,
    "files": {
        "pdf": "https://archive.orkl.eu/21a1843d6a633a1a09afb8ec24ce1b0c6fcbb675.pdf",
        "text": "https://archive.orkl.eu/21a1843d6a633a1a09afb8ec24ce1b0c6fcbb675.txt",
        "img": "https://archive.orkl.eu/21a1843d6a633a1a09afb8ec24ce1b0c6fcbb675.jpg"
    }
}