{
    "id": "5515d326-f2e4-48ef-8faa-cbc37880e8a9",
    "created_at": "2023-01-12T15:00:36.554609Z",
    "updated_at": "2025-03-27T02:08:52.120274Z",
    "deleted_at": null,
    "sha1_hash": "35a02c8d62da93f7f8e9fe0383584a22d63d6e95",
    "title": "2021-04-06 - Janeleiro, the time traveler- A new old banking trojan in Brazil",
    "authors": "",
    "file_creation_date": "2022-05-28T16:47:10Z",
    "file_modification_date": "2022-05-28T16:47:10Z",
    "file_size": 669706,
    "plain_text": "# Janeleiro, the time traveler: A new old banking trojan in Brazil\n\n**[welivesecurity.com/2021/04/06/janeleiro-time-traveler-new-old-banking-trojan-brazil/](https://www.welivesecurity.com/2021/04/06/janeleiro-time-traveler-new-old-banking-trojan-brazil/)**\n\nESET Research uncovers a new threat that targets organizations operating in various sectors in Brazil\n\n\nApril 6, 2021\n\n\n_UPDATE (April 6, 2021):th_\n\n_Although we have not received any official response from GitHub, when we checked April 6 at around 18:00 UTC, theth_\n_malicious repositories used by Janeleiro had been taken down._\n\nESET Research has been tracking a newly discovered banking trojan that has been targeting corporate users in Brazil\nsince 2019 across many verticals affecting sectors such as engineering, healthcare, retail, manufacturing, finance,\ntransportation, and government.\n\nThis new threat, which we’ve named Janeleiro, attempts to deceive its victims with pop-up windows designed to look\nlike the websites of some of the biggest banks in Brazil. These pop-ups contain fake forms, aiming to trick the\nmalware’s victims into entering their banking credentials and personal information that the malware captures and\nexfiltrates to its C&C servers. Janeleiro follows exactly the same blueprint for the core implementation of this technique\n[as some of the most prominent malware families targeting the region: Casbaneiro,](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/) [Grandoreiro,](https://www.welivesecurity.com/2020/04/28/grandoreiro-how-engorged-can-exe-get/) [Mekotio,](https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/) [Amavaldo,](https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/)\n[and Vadokrist, among others.](https://www.welivesecurity.com/2021/01/21/vadokrist-wolf-sheeps-clothing/)\n\nIn contrast to those well-known malware families, Janeleiro is written in Visual Basic .NET, a big deviation from the\nfavored Delphi programming language that threat actors in the region have been using for years. Janeleiro has been\nevolving towards the objective of giving more control to the operators to manipulate and adjust its fake pop-up windows\nbased on what they need to pull off the attack, send mouse clicks and keystrokes, and recording user input and the\nscreen in real time. The nature of these types of attack is not characterized by their automation capabilities, but rather\nby the hands-on approach: in many cases the operator must adjust the windows via commands in real time\n\n\n-----\n\nThe operators seem comfortable using GitHub to store their modules, administering their organization page, and\nuploading new repositories every day where they store the files with the lists of C&C servers that the trojans retrieve to\nconnect to their operators. Having your malware depend on a single source is an interesting move – but what if we told\nyou that the newest version of Janeleiro only lives for one day?\n\n## Target: Brazil\n\nBased on our telemetry data, we can affirm that this malware targets only corporate users. Malicious emails are sent to\ncompanies in Brazil and, even though we do not think these are targeted attacks, they seem to be sent in small\nbatches. According to our telemetry, the affected sectors are engineering, healthcare, retail, manufacturing, finance,\ntransportation and government.\n\nAn example of a phishing email is shown in Figure 1: a false notification regarding an unpaid invoice. It contains a link\nthat leads to a compromised server. The retrieved page simply redirects to the download of a ZIP archive hosted in\nAzure. Some other emails sent by these attackers don’t have a redirection via a compromised server but lead directly to\nthe ZIP archive.\n\n_Figure 1. Example of a malicious email_\n\nThe servers that host these ZIP archives with Janeleiro have URLs that follow the same convention as other URLs that\nwe saw delivering other banking trojan families (see the Indicators of Compromise section). In some cases, these URLs\nhave distributed both Janeleiro and other Delphi bankers at different times. This suggests that either the various\ncriminal groups share the same provider for sending spam emails and for hosting their malware, or that they are the\nsame group. We have not yet determined which hypothesis is correct.\n\nAn overview of the attack is shown in Figure 2.\n\n\n-----\n\n_Figure 2. Janeleiro attack overview (simplified)_\n\nThe ZIP archive contains an MSI installer that loads the main trojan DLL. Using an MSI installer is a favored technique\nof several malware families in the region. Janeleiro retrieves the computer’s public IP address and uses a web service\nto attempt to geolocate it. If the returned country code value does not match BR, the malware exits. If the geolocation\ncheck passes, Janeleiro gathers information of the compromised machine, including:\n\nCurrent date and time\nMachine name and username\nOS full name and architecture\nMalware version\nRegion name obtained when geolocating the computer\n\nThe information is uploaded to a website with the purpose of tracking successful attacks. After that, Janeleiro retrieves\nthe IP addresses of the C&C servers from a GitHub organization page apparently created by the criminals. Then it is\nready to start its core functionality and wait for commands from an operator.\n\n[In 2020 ESET published a white paper detailing findings about interconnectivity of the most prominent Latin American](https://www.welivesecurity.com/2020/10/01/latam-financial-cybercrime-competitors-crime-sharing-ttps/)\n[families of banking trojans including Casbaneiro,](https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/) [Grandoreiro,](https://www.welivesecurity.com/2020/04/28/grandoreiro-how-engorged-can-exe-get/) [Amavaldo among others. The similarities described in](https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/)\nthat paper are in the implementation of the trojan’s core: notifying the operator when there is an active window with an\ninteresting name or title based on a predefined keyword list, and using a fake pop-up window to trick potential victims\ninto thinking they are entering sensitive information on a legitimate website. This process is illustrated by the flowchart\nin Figure 3.\n\n_Figure 3. Typical core implementation of banking trojans from Latin America_\n\n\n-----\n\nJaneleiro follows the exact blueprint for its core implementation as eleven other malware families that target Brazil. As\nshown in Figure 4, we can see some of the fake pop-up windows created by Janeleiro.\n\n_Figure 4. Fake pop-up windows used by Janeleiro_\n\n## Janeleiro in action\n\nJaneleiro begins enumerating windows and checking their titles to find interesting keywords (as shown in Figure 5) that\nwould indicate that the user is visiting the website of a banking entity of interest, especially those that are supported by\nits implementation of fake pop-up windows.\n\n_Figure 5. List of keywords that Janeleiro searches for in window titles_\n\nWhen one of the keywords is found, Janeleiro immediately attempts to retrieve the addresses of its C&C servers from\nGitHub and connects to them. These fake pop-up windows are dynamically created on demand and controlled by the\nattacker via commands to the malware, as they go through several stages to trick the user while the attacker, in real\ntime, receives screen captures, the logged keystrokes and information that is entered in the fake forms.\n\n\n-----\n\nThe fact that threat actors abuse GitHub is nothing new; however, Janeleiro does it in quite interesting ways: the\noperators have created a GitHub organization page that they rename every day in the form SLK<dd/mm/yyyy> where\n<dd/mm/yyyy> is the current date.\n\nA screenshot of the GitHub organization page as it looked on 15 March 2021 is shown in Figure 6.\n\n_Figure 6. GitHub organization page with repositories used by the operators of Janeleiro_\n\nDaily, the operator novoescritorio1-alberto creates a new repository following this naming format. The purpose of the\nrepository is to contain a file that has the list of IP addresses for Janeleiro’s C&C servers where it connects to report to\nits operators, to receive commands and to exfiltrate information in real time.\n\nA screenshot showing one of the repositories in the GitHub organization page attributed to Janeleiro’s operators is\nshown in Figure 7, including the username of the account that does the commits.\n\n_Figure 7. Main branch with the SLK file for Janeleiro version 3_\n\nA screenshot of the secondary branch in the repository is shown in Figure 8.\n\n\n-----\n\n_Figure 8. SLK branch with the SLK file for Janeleiro version 2_\n\nWe have notified GitHub of this activity but at the time of writing no actions have been taken against the organization\npage nor the account that creates the repository with new C&C server addresses.\n\nIn the newest version of Janeleiro, version 0.0.3, the developers introduced an interesting encryption/decryption feature\nusing an open-source library called EncryptDecryptUtils. The new procedure for decryption is shown in Figure 9.\n\n_Figure 9. Procedure for decryption implemented by Janeleiro version 0.0.3_\n\nTo decrypt a string, Janeleiro encrypts the string resulting from the current date and the result is then used as a\npassphrase and salt value to create a new key for decryption. This has an extremely important effect: the newest\n**version of Janeleiro can only decrypt its strings on one intended day. That could be the same day the strings were**\nencrypted or one day in the future; on any other day, the decryption fails.\n\nThis is also true for the contents of the SLK file in the main branch: the encrypted and base 64 encoded list of C&C\nservers as shown in shown in Figure 10.\n\n_Figure 10. Contents of the SLK file in the main branch._\n\nThe contents are encrypted with the same procedure: when Janeleiro decrypts the contents of the file it must be on one\nspecific date – the current date – to work as intended.\n\n\n-----\n\n## Evolution of Janeleiro\n\nJaneleiro has an internal version value (as shown in Figure 11) that can be used by the attackers to identify which\nversion of their malware successfully compromised a machine. As of March 2021, we have identified four versions, but\nwith two of them sharing the same internal version number.\n\n_Figure 11. Configuration values used by version 0.0.2A from 2020_\n\nWhile in 2021 we have seen versions 0.0.2 and 0.0.3, we were interested in finding a missing key piece in the evolution\nof Janeleiro: version 0.0.1, which should have been in existence in late 2019 or early 2020. To our surprise we found\nversion 0.0.4 samples instead dating to 2019. These new samples of the trojan were deployed by a DLL loader\ncomponent in tandem with a password stealer, which means the group behind Janeleiro has other tools in their arsenal.\n\nAn overview of Janeleiro’s versions from 2019 through 2021 is shown in Figure 12.\n\n_Figure 12. Janeleiro’s strange evolution timeline, based in the internal version of the malware_\n\nThe inconsistency in the timeline and internal versioning of the malware suggests that it was under development as far\nback as 2018, and in 2020 they decided to switch to a previous version of their code and to improve that and refine its\ncommand processing for the operator to have better control of the trojan during the attack.\n\n## Breaker and keeper of traditions\n\nWhile Janeleiro follows the same blueprint for the core implementation of its fake pop-up windows, along with other\n[malware families that ESET has documented in the region, it sets itself apart from those malware families in several](https://www.welivesecurity.com/2020/10/01/latam-financial-cybercrime-competitors-crime-sharing-ttps/)\nways:\n\n**It is written in Visual Basic .NET: The curious case of Brazil is that it is mostly targeted by banking trojans**\ndeveloped in Delphi – the programming language of choice for several threat actors that are apparently working\ntogether sharing tools and infrastructure. Janeleiro’s preference for VB.NET is a notable deviation from what\nappears to be the norm for the region.\n**No binary obfuscation: While Janeleiro does make use of light obfuscation by generating random names for its**\nclasses, modules, method names, parameters, and string encryption, it does not employ packers to make\ndetection and analysis harder. Other trojans such as Grandoreiro, Mekotio, Ousaban, Vadokrist and Guildma\nmake heavy use of Themida and binary padding techniques.\n\n\n-----\n\n**No custom encryption algorithms: Janeleiro s developers rely on cryptographic functions provided by the .NET**\nFramework as well as open-source projects for string encryption/decryption, with a preference for AES and RSA\nalgorithms. Trojans such as Casbaneiro, Grandoreiro, Amavaldo, Mispadu, and Guildma, among others, use\ncustom encryption algorithms, including obfuscation techniques using string tables.\n**Simple method of execution: The MSI installer does not deploy other components besides the main trojan DLL**\nor execute further instructions other than load and execute one of the exports of the DLL that installs itself in the\nsystem. We have found no samples of an MSI installer executing obfuscated scripts, unpacking support tools, or\ncomponents for DLL side-loading, which is popular with other malware families in the region.\n**No defense against security software: Some of the biggest banks in Brazil require a security module to be**\ninstalled by their customers before allowing them access to their bank accounts online; for example, Warsaw antifraud software. It’s often the case that LATAM banking trojans try to find out if such software is installed in the\ncompromised machine and report it to the attackers. Some malware families such as Grandoreiro and Guildma\nattempt to disable it in Windows Firewall or disable its driver.\n**Uses code from NjRAT: Janeleiro is far from being another incarnation of the well-known NjRAT, but it does use**\nNjRAT’s SocketClient and Remote Desktop capture functions, as well as other miscellaneous functions. NjRAT is\nnot commonly used – at least by LATAM baking trojans – perhaps because of their preference to use custom[made trojans in Delphi. However, among other malware, NjRAT has been used in Operation Spalax, a campaign](https://www.welivesecurity.com/2021/01/12/operation-spalax-targeted-malware-attacks-colombia/)\nthat targets Colombia specifically.\n\n## Commands\n\nCommands with parameters are received from the C&C server in encrypted form with the same algorithm used to\nencrypt strings (see section Appendix A). A typical command format is like this:\n%CommandName%%PredefinedSeparatorKeyword%%Parameters%.\n\nAfter decryption the command is split into an array of strings; each part of the command is separated by a predefined\nkeyword hardcoded in the malware’s configuration – all versions we analyzed use |’meio’|, which separates the\ncommand name and each parameter.\n\nFigure 13 shows how Janeleiro checks the name of the command and executes the requested action.\n\n_Figure 13. Example of Version 0.0.2B processing command startinfo_\n\nWhen Janeleiro sends data back to the operator, it does it in a similar format:\n%CommandName%%PredefinedSeparatorKeyword%%Encoded data%.\n\nThe majority of Janeleiro’s commands are for controlling windows, the mouse and keyboard, and its fake pop-up\nwindows. As the development evolved from Version 0.0.2A to 0.0.3, more commands were added that offered the\noperator a more refined control:\n\nCommands to control specific window\nEnumerate and send information about windows (title, class, handle)\nAdjust specific window size, minimize, maximize\nDimensions of the screen\nKill all chrome.exe processes, and restart chrome.exe with arguments –disable-gpu\n\n\n-----\n\nCapture the screen in real time\nKeylogging in real time\nSend keys and mouse clicks\nDisplay or close a specific fake pop-up window\nShow or close a specific fake pop-up window\nMiscellaneous commands such as: send date and time, disconnect socket, terminate own process\n\n## Conclusion\n\nThe experimental nature of Janeleiro, going back and forth between different versions, tell us about an actor who is still\ntrying to find the right way to do it but is no less experienced than the competition: Janeleiro follows the unique blueprint\nfor the core implementation of the fake pop-up windows as many LATAM banking trojans, this does not seem to be a\ncoincidence or inspiration: this actor employs and distributes Janeleiro sharing the same infrastructure as some of the\nmost prominent of these active malware families. As we continue to track the activities of this actor, time will tell what\nnew developments they will come up with in the future.\n\n_For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com._\n\n_Special thanks to Johnatan Camargo Zacarias from Itaú bank for his help with the investigation._\n\n## Indicators of Compromise (IoCs)\n\n[A comprehensive list of Indicators of Compromise (IoCs) and samples can be found in our GitHub repository.](https://github.com/eset/malware-ioc/tree/master/janeleiro)\n\n### SHA-1 hashes\n\n**Version 0.0.4**\n\n**SHA-1** **Description** **ESET detection name**\n\nCF117E5CA26594F497E0F15106518FEE52B88D8D MSI file MSIL/TrojanDownloader.Agent.FSC\n\nD16AC192499192F06A3903192A4AA57A28CCCA5A Console.exe loader MSIL/TrojanDownloader.Agent.FSC\n\n462D6AD77860D3D523D2CAFBC227F012952E513C MSIL/Kryptik.TBD\n\n0A5BBEC328FDD4E8B2379AF770DF8B180411B05D LoadDllMSI.dll loader MSIL/TrojanDownloader.Agent.FSC\n\n0AA349050B7EF173BFA34B92687554E81EEB28FF System.Logins.Initial.dll MSIL/Agent.TIX\n\n5B19E2D1950ADD701864D5F0F18A1111AAABEA28\n\n186E590239083A5B54971CAB66A58301230164C2 System.Modules.Initial.dll\n\nE1B2FD94F16237379E4CAD6832A6FCE7F543DC40 System.Modules.Initial.dll MSIL/Janeleiro.A\n\n4061B2FBEB7F1026E54EE928867169D1B001B7A5\n\n**Version 0.0.2A**\n\n**SHA-1** **Description** **ESET detection name**\n\n8674E61B421A905DA8B866A194680D08D27D77AE Main Trojan Loader MSIL/Agent.AAI\n\n2E5F7D5F680152E738B8910E694651D48126382A MSIL/Janeleiro.A\n\n06E4F11A2A6EF8284C6AAC5A924D186410257650 Main Trojan MSIL/Agent.AAI\n\n**Version 0.0.2B**\n\n\n-----\n\n**SHA-1** **Description** **ESET detection name**\n\n291A5F0DF18CC68FA0DA1B7F401EAD17C9FBDD7F MSI file MSIL/Janeleiro.A\n\nFB246A5A1105B83DFA8032394759DBC23AB81529\n\n6F6FF405F6DA50B517E82FF9D1A546D8F13EC3F7 Main trojan\n\n742E0AEDC8970D47F16F5549A6B61D839485DE3C\n\n**Version 0.0.3**\n\n**SHA-1** **Description** **ESET detection name**\n\n455FAF2A741C28BA1EFCE8635AC0FCE935C080FF MSI file MSIL/Janeleiro.A\n\nD71EB97FC1F5FE50D608518D2820CB96F2A3376F\n\n158DA5AB85BFAC471DC2B2EE66FD99AEF7432DBB Main trojan\n\n6BFAEFCC0930DA5A2BAEC19723C8C835A003D1EC\n\n### Download URLs\n\n_In the following <NNNNNNNNNNN> is a random number between 10000000000 and 90000000000._\n\n**_Downloading only Janeleiro_**\n\nhttps://recuperaglobaldanfeonline.eastus.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNNN>\nhttps://protocolo-faturamento-servico.brazilsouth.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://acessoriapremierfantasiafaturas.eastus.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\n\n**_Downloading Janeleiro and other Delphi banking trojans_**\n\nhttps://portalrotulosfechamento.eastus.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://servicosemitidosglobalnfe.southcentralus.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://emissaocomprovanteatrasado.eastus.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\n\n**_Downloading Delphi bankers_**\n\nhttps://emitidasfaturasfevereiro.brazilsouth.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://dinamicoscontratosvencidos.brazilsouth.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://arquivosemitidoscomsucesso.eastus.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://fatura-digital-arquiv-lo.brazilsouth.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://nota-eletronica-servicos.brazilsouth.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\nhttps://eletronicadanfe.brazilsouth.cloudapp.azure[.]com/nfedown.php?dw=<NNNNNNNNNN>\n\n### C&C servers\n\nThese are the IP addresses of the C&C servers where Janeleiro connects to report, receive commands and send data:\n\n52.204.58[.]11\n35.174.60[.]172\n\nThese are the tracking URLs where Janeleiro sends information about the compromised system during installation:\n\nhttp://tasoofile.us-east-1.elasticbeanstalk[.]com/count\nhttp://slkvemnemim.us-east-1.elasticbeanstalk[.]com/count\nhttp://checa-env.cf3tefmhmr.eu-north-1.elasticbeanstalk[.]com/cnt/\n\nThese are the URLs used by System.Logins.dll to exfiltrate the harvested data:\n\n\n-----\n\nhttp://comunicador.duckdns[.]org/catalista/emails/checkuser.php\nhttp://comunicador.duckdns[.]org/catalista/lixo/index.php\n\nIPs associated with the domain:\n\n178.79.178[.]203\n138.197.101[.]4\n\n## MITRE ATT&CK techniques\n\n_[Note: This table was built using version 8 of the MITRE ATT&CK framework.](https://attack.mitre.org/versions/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nResource\nDevelopment\n\n\n[T1584.004](https://attack.mitre.org/versions/v8/techniques/T1584/004/) Compromise Infrastructure: Server In some cases, malicious emails sent\nto targets contain links to a\ncompromised server that redirects to\nthe download of Janeleiro.\n\n\nInitial Access [T1566.002](https://attack.mitre.org/versions/v8/techniques/T1566/002/) Phishing: Spearphishing Link Attackers send malicious emails that\nhave a download link for Janeleiro\nmalware.\n\nExecution [T1204.001](https://attack.mitre.org/versions/v8/techniques/T1204/001/) User Execution: Malicious Link Phishing emails sent by the attackers\ncontain a link to download a ZIP\narchive that holds an MSI installer with\nJaneleiro malware.\n\n\nPersistence [T1547.001](https://attack.mitre.org/versions/v8/techniques/T1547/001/) Boot or Logon Autostart Execution:\nRegistry Run Keys / Startup Folder\n\n\nJaneleiro achieves persistence by\nadding itself to the Run registry key (in\nv0.0.3 of the malware).\n\n\n[T1547.009](https://attack.mitre.org/versions/v8/techniques/T1547/009/) Boot or Logon\nAutostart\nExecution:\nShortcut\nModification\n\n\nJaneleiro creates a LNK file for\npersistence (in v0.0.4, v0.0.2A and\nv0.0.2B of the malware).\n\n\nDefense\nEvasion\n\nCredential\nAccess\n\n\n[T1140](https://attack.mitre.org/versions/v8/techniques/T1140/) Deobfuscate/Decode Files or Information Janeleiro v0.0.2B is obfuscated and\nits strings are RSA-encrypted. Version\n0.0.3 uses AES for string encryption.\n\n\n[T1555.003](https://attack.mitre.org/versions/v8/techniques/T1555/003/) Credentials from Password Stores:\nCredentials from Web Browsers\n\n\nJaneleiro v0.0.4 can download a DLL\nthat steals passwords from Chrome,\nFirefox and Opera browsers.\n\n\n[T1552.001](https://attack.mitre.org/versions/v8/techniques/T1552/001/) Unsecured\nCredentials:\nCredentials In\nFiles\n\n\nJaneleiro v0.0.4 can download a DLL that\nobtains passwords stored in files from\nseveral applications such as FileZilla,\nPidgin and Thunderbird.\n\n\nDiscovery [T1087.003](https://attack.mitre.org/versions/v8/techniques/T1087/003/) Account Discovery: Email Account Janeleiro v0.0.4 can download a DLL\nthat collects Gmail addresses.\n\n\n[T1010](https://attack.mitre.org/versions/v8/techniques/T1010/) Application\nWindow\nDiscovery\n\n[T1082](https://attack.mitre.org/versions/v8/techniques/T1082/) System\nInformation\nDiscovery\n\n[T1033](https://attack.mitre.org/versions/v8/techniques/T1033/) System\nOwner/User\nDiscovery\n\n\nJaneleiro collects information about open\nwindows so the attacker can decide to\ninject pop-ups.\n\nJaneleiro collects information from the\nvictim’s machine, such as username, OS\nand architecture.\n\nJaneleiro collects the username from the\nvictim’s machine.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1124](https://attack.mitre.org/versions/v8/techniques/T1124/) System Time\nDiscovery\n\n\nJaneleiro collects current date and time\nwhen the victim is compromised.\n\n\nCollection [T1115](https://attack.mitre.org/versions/v8/techniques/T1115/) Clipboard Data Janeleiro uses a clipboard event\nhandler to access clipboard data.\n\n\n[T1056.001](https://attack.mitre.org/versions/v8/techniques/T1056/001/) Input Capture:\nKeylogging\n\n\nJaneleiro can perform keylogging.\n\n\n[T1113](https://attack.mitre.org/versions/v8/techniques/T1113/) Screen Capture Janeleiro can capture screenshots of the\nvictim’s desktop.\n\n\n[T1056.002](https://attack.mitre.org/versions/v8/techniques/T1056/002/) Input Capture:\nGUI Input\nCapture\n\n\nJaneleiro displays fake forms on top of\nbanking sites to intercept credentials from\nvictims.\n\n\nCommand\nand Control\n\n\n[T1095](https://attack.mitre.org/versions/v8/techniques/T1095/) Non-Application Layer Protocol Janeleiro uses TCP for C&C\ncommunications.\n\n\n[T1102.001](https://attack.mitre.org/versions/v8/techniques/T1102/001/) Web Service:\nDead Drop\nResolver\n\n\nJaneleiro uses GitHub repositories to\nstore C&C information.\n\n\nExfiltration [T1041](https://attack.mitre.org/versions/v8/techniques/T1041/) Exfiltration Over C2 Channel Janeleiro exfiltrates data over the\nsame channel used for C&C.\n\n## Appendix A: Overview of Janeleiro’s malware family\n\nHere is each incarnation we have found of Janeleiro from 2019 until March 2021.\n\n### Version 0.0.4\n\nPeriod of activity: 2019 – Possibly still active.\nThe first version of Janeleiro – that we know of – came in the form of an MSI installer and at least two variants:\n\nVariant 1: MSI installer loads a DLL called LoadDllMSI.dll internally\nVariant 2: MSI installer executes Console.exe, which checks privileges and loads an embedded DLL\nassembly called LoadSystem.dll.\n\nBoth LoadDllMSI.dll and LoadSystem.dll perform the same tasks:\n\nCreate an installation folder\nDownload and store two modules: Logins.Initial.dll and System.Modules.Initial.dll. The two modules are\ndownloaded from a GitHub account that, at the time of writing, has been closed.\nCreate several Shortcuts in strategic places\nLog the successful compromise of the system to a tracking website\n\n**System.Logins: It is a password stealer for Google Chrome, FileZilla, Mozilla Firefox, Opera, Pidgin, and Mozilla**\nThunderbird. Additionally, it harvests email information from Gmail. All the information is exfiltrated to two websites.\nVersion 0.0.4 is the only one that is deployed with this malicious tool.\n\n**System.Modules: Janeleiro’s main trojan, implemented as a Windows Forms application compiled as DLL. This**\nversion had the capacity to dynamically create fake pop-up windows using several Forms for several banking entities,\nincluding banks operating in Mexico, but it is unknown if this version was distributed in Mexico at any point.\n\nThis version used two GitHub organization pages to download the IP addresses of its C&C servers: the names of the\npages are generated by encrypting the current date with SLK as suffix as shown in Figure 14.\n\n\n-----\n\n_Figure 14. Version 0.0.4 attempts to read file in a GitHub repository that contains the encrypted list of C&C servers_\n\nAt the time of writing, we believe that the operators have abandoned this version of the malware. We couldn’t find any\nactive GitHub pages by following the name generation algorithm used by Janeleiro.\n\nMany commands for the trojan were left unimplemented, some were implemented and other discarded in newer\nversions used in 2020 and 2021.\n\n### Version 0.0.2A\n\nPeriod of activity: 2020 – Unknown.\nInternal Malware Version: 0.0.2\n\nThe MSI installer loads a DLL that borrows from LoadSystem installation and persistence procedures but unpacks the\nembedded main trojan DLL from its resources. The main trojan was implemented as a Windows Forms application\ncompiled as DLL.\n\nThis version of Janeleiro only uses one Form to create the fake pop-up windows with more commands supported by the\noperator but with fewer targets: Mexican banking entities were discarded. All of the images used to cover the screen\nand trick the user are for Brazilian banks.\n\nThis version also appears to have been abandoned and cannot contact its C&C servers by retrieving the IP lists from a\nGitHub page. It uses the same algorithm as Version 0.0.4 with the same key vhpjzqqtpo, suggesting that the operators\nwhere using the same GitHub page as for Version 0.0.4. Figure 15 shows the code that attempts to retrieve the list from\nGitHub.\n\n\n-----\n\n_Figure 15. Version 0.0.2A attempts to download a new list of C&C servers from a repository on a GitHub organization page_\n\n### Version 0.0.2B\n\nPeriod of activity: 2021 – Still active.\nInternal Malware Version: 0.0.2\n\nNew characteristics of this version:\n\nImplemented as a Windows Presentation Foundation application\nMajor restructuration of the code combining the loader code with the main trojan\nGeolocation of the compromised machine\nImplementation of clipboard hijacking to replace bitcoin addresses\nExpanded set of supported commands\nStrings encrypted/decrypted with the RSA algorithm\n\nFigure 16 shows the implementation of clipboard hijacking by Janeleiro; when a bitcoin address is found, it randomly\npicks one from its own list of bitcoin addresses and replaces it.\n\n_Figure 16. Janeleiro’s implementation of clipboard hijacking_\n\n\n-----\n\nIn this version a simplified procedure was implemented to retrieve the addresses of its C&C servers from a GitHub\norganization page; the name scheme this time is a simple concatenation of SLK with the current date time without the\nslashes, as shown in Figure 17.\n\n_Figure 17. Version 0.0.2B procedure to retrieve its list of C&C servers. We have decrypted some strings for clarity._\n\nThe code attempts to download the contents of a file in a secondary branch. The file contains, in plaintext, the list of the\nC&C IP addresses and ports. At the time of writing, the GitHub organization pages can be found using the procedure as\nthey continue to operate with this recent version of Janeleiro.\n\n### Version 0.0.3\n\nPeriod of activity: Since March 2021 – Still active.\nInternal Malware Version: 0.0.3\n\nNew characteristics of this version:\n\nImplemented as a Windows Forms application\nA recombination of Version 0.0.2A and 0.0.2B code and technique implementations\nNew persistence method using Windows Registry Run Key\nExpanded set of supported commands\nUses AES algorithm to encrypt/decrypt its strings\n\nThis version uses the same procedure as Version 0.0.2B to get the C&C servers from the GitHub organization page,\nwith the difference that it uses the main branch within the repository and the list is encrypted and encoded with base64\nas shown in Figure 18.\n\nFigure 18. Main repository containing an encrypted list of C&C servers\n\nThis procedure is also used when decrypting the list of C&C servers, therefore there must exist a repository containing\nthe file in the main branch, with the encrypted list intended for that day. Otherwise this version cannot contact the\noperators as decryption will fail.\n\n## Appendix B: Third-party tools used by Janeleiro\n\nJaneleiro uses several third-party, open-source libraries for various purposes:\n\n**Tool** **Description** **Used by**\n\n\nFody Used to load every other third-party tool, or trojan component, such as\nLoadSystem in version 0.0.4.\n\n\nAll versions\nincluding\nSystem.Logins\n\n\n-----\n\n**Tool** **Description** **Used by**\n\nMimekit, Mailkit, Used to collect emails and login information. System.Logins\nXnet,\nBouncyCastle,\nuPREC\n\nSharpClipboard Version 0.0.2B\n\nUsed for clipboard hijacking: when the user copies a bitcoin address, Version 0.0.3\nJaneleiro replaces it with one randomly chosen from a list of its own.\n\nInterestingly, the Janeleiro developers don’t seem to have downloaded\nSharpClipboard’s source code to compile their own version: they obtained a\ncompiled copy from another GitHub repository; we don’t believe that user is in\nany way related to the development of this threat.\n\nSharpVectors Used to load SVG images contained in resources. These images are logos of Version 0.0.2B\nseveral banks used by the fake pop-up windows. Version 0.0.3\n\nNewtonsoft JSON Used to parse the data returned by the geoPlugin web service. Version 0.0.2B\n\nVersion 0.0.3\n\n\nEncryptDecryptUtils Used to encrypt and decrypt its strings. Functions were modified to contain\nthe key, so it’s not present in the trojan’s code.\n\n6 Apr 2021 - 11:30AM\n\n\nVersion 0.0.3\n\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-06 - Janeleiro, the time traveler- A new old banking trojan in Brazil.pdf"
    ],
    "report_names": [
        "2021-04-06 - Janeleiro, the time traveler- A new old banking trojan in Brazil.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "64d750e4-67db-4461-bae2-6e75bfced852",
            "created_at": "2022-10-25T16:07:24.01415Z",
            "updated_at": "2025-03-27T02:02:10.077988Z",
            "deleted_at": null,
            "main_name": "Operation Spalax",
            "aliases": [],
            "source_name": "ETDA:Operation Spalax",
            "tools": [
                "AsyncRAT",
                "Bladabindi",
                "Jorik",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Socmer",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535636,
    "ts_updated_at": 1743041332,
    "ts_creation_date": 1653756430,
    "ts_modification_date": 1653756430,
    "files": {
        "pdf": "https://archive.orkl.eu/35a02c8d62da93f7f8e9fe0383584a22d63d6e95.pdf",
        "text": "https://archive.orkl.eu/35a02c8d62da93f7f8e9fe0383584a22d63d6e95.txt",
        "img": "https://archive.orkl.eu/35a02c8d62da93f7f8e9fe0383584a22d63d6e95.jpg"
    }
}