{
    "id": "e5846c37-a5d7-45f3-9cf1-a301c172a7db",
    "created_at": "2023-01-12T15:04:45.027953Z",
    "updated_at": "2025-03-27T02:15:47.831212Z",
    "deleted_at": null,
    "sha1_hash": "7179be20ccd05bac5d29b6bdbcbe9c6c6db65aca",
    "title": "2022-03-23 - New JSSLoader Trojan Delivered Through XLL Files",
    "authors": "",
    "file_creation_date": "2022-05-27T22:56:00Z",
    "file_modification_date": "2022-05-27T22:56:00Z",
    "file_size": 2479078,
    "plain_text": "# New JSSLoader Trojan Delivered Through XLL Files\n\n**[blog.morphisec.com/new-jssloader-trojan-delivered-through-xll-files](https://blog.morphisec.com/new-jssloader-trojan-delivered-through-xll-files)**\n\nPosted by [Hido Cohen on March 23, 2022](https://blog.morphisec.com/author/hido-cohen)\n\n[Tweet](https://twitter.com/share)\n\n[Morphisec Labs has observed a new wave of JSSLoader infections this year. We’ve tracked](https://blog.morphisec.com/the-evolution-of-the-fin7-jssloader)\nJSSLoader activity since December 2020 and published a thorough report on the Russian\ncriminal hacking group FIN7’s JSSLoader: [The Evolution of the FIN7 JSSLoader. JSSLoader](https://www.morphisec.com/hubfs/eBooks_and_Whitepapers/FIN7%20JSSLOADER%20FINAL%20WEB.pdf)\n\n\n-----\n\nis a small, very capable .NET remote access trojan (RAT). Its capabilities include data\nexfiltration, persistence, auto-updating, additional payload delivery, and more.\n\nAttackers are now using .XLL files to deliver a new, obfuscated version of JSSLoader. We\nexplain how this new malware variant utilizes the Excel add-ins feature to load the malware\nand inspect the changes inside.\n\n## Infection Chain\n\nFigure 1: From .xll file to JSSLoader\n\nThis infection chain is similar to other XLL infections. The victim receives a malicious\nattachment, either an XLM or XLL file, inside an email. Once the attachment is downloaded\nand executed, Excel loads and executes the malicious code inside the .xll file, which then\ndownloads the payload from a remote server. The payload is a new, similar variant of\nJSSLoader.\n\n\n-----\n\n## XLL Excel Add-in\n\nThe first stage of the malware responsible for downloading JSSLoader into an infected\nmachine uses an Excel add-in file, denoted by an XLL file extension. Because the file isn’t\nsigned, a popup displays for the user before executing:\n\nFigure 2: Microsoft security popup\n\nEach XLL file must implement and export the xlAutoOpen function. This function is called by\nExcel whenever an XLL is activated. In our case, the malicious activity is located at the end\nof xlAutoOpen:\n\nFigure 3: Malicious code inside xlAutoOpen\n\nBefore exiting from the function, the malware loads itself, the .XLL file, into memory (not\nrelevant to the attack) and calls the mw_download_and_execute function.\n\nThis function is responsible for downloading the payload from a remote server. An attacker\nuses a different User-Agent between samples to help avoid network signature-based security\nsolutions.\n\n\n-----\n\nFigure 4: User Agent changes between samples\n\nOnce downloaded, the XLL file creates a temp file with a DNA prefix using a\nGetTempFileNameW API call and executes it as a new process.\n\nFigure 5: Temporary file creation\n\n## New Obfuscation Layer\n\nLook carefully at the dropped sample and compare it with a JSSLoader sample. They share\nthe exact same execution flow. So, what's different? This variant introduces a new layer of\nstring obfuscation, renaming all functions and variables names.\n\n\n-----\n\nFigure 6: Comparison of Samples\n\nIn order to evade static threat scanners, this variant has a simple string decoding\nmechanism:\n\n\n-----\n\nFigure 7: New variant’s string obfuscation\n\nThis version appears focused on breaking the string-based YARA rules used in the wild. It\ndoes so by splitting the strings into substrings and concatenating them at runtime.\n\n\n-----\n\nFigure 8: Strings obfuscation comparison\n\n## This New Malware Variant Evades Traditional Security\n\nMorphisec Labs will continue to monitor the evolution of JSSLoader and its delivery methods.\nAlthough it didn't present new capabilities, this new JSSLoader variant is a worry. Especially\nfor organizations relying on their next-generation antivirus (NGAV) or endpoint detection and\nresponse (EDR) to stop it. Most NGAV and EDR solutions won’t detect day zero .XLL files\nhiding a JSSLoader. It can take days or weeks before signatures are deployed, all while\nattackers have free reign inside your network.\n\nHowever, Morphisec’s Moving Target Defense (MTD) technology instantly stops these and\nother unknown and zero-day attacks. It uses system polymorphism to unpredictably hide\napplication targets, operating system targets, and other critical asset targets from\nadversaries. This leads to a dramatically reduced attack surface.\n\nGartner analysts have called Moving Target Defense a “game changer.” MTD can uniquely\ndetect and stop ransomware, zero-day, and other advanced attacks that bypass NGAV, EDR,\nand other defenses. Learn more about Moving Target Defense and why Gartner cited this\n[technology in its report: Emerging Trends and Technologies Impact Radar for Security.](https://engage.morphisec.com/gartner-emerging-technologies-trends-security-moving-target-defense)\n\n### Indicators of Compromise (IOCs)\n\n\n-----\n\nXLLs d42dfbeba20624a190cf903d28ac5ef5e6ff0f5c120e0f8e14909fec30871134\n\na8da877ebc4bdefbbe1b5454c448880f36ffad46d6d50083d586eee2da5a31ab\n\n8783eb00acb3196a270c9be1e06d4841bf1686c7f7fc6e009d6172daf0172fc6\n\n7a234d1a2415834290a3a9c7274aadb7253dcfe24edb10b22f1a4a33fd027a08\n\nc6224a579fcef3b67c02dabe55cc486a476e10f7ab9181a91c839fa3de0876fd\n\n8b76c48088a56532f73389933737af0cbe7a404e639ec51136090c7d8c8207c9\n\nJSSLoader 48053356188dd419c6212e8adb1d5156460339f07838f2c00357cfd1b4a05278\n\nda480b19c68c2dee819f7b06dbfdba0637fea2c165f3190c2a4994570c3dae2a\n\n910b6f3087b1d5342a2681376c367b53e30cf21dd9409fb1000ffb60893a7051\n\nde099bf0297de8e2fad37acc55c6b0456d1fd98a6fc1fbc381759e82a4e207c3\n\nee8f394d9e192c453d47a0c57261a03921dcbb97248a67427cb6fc6d8833c8a0\n\na29c97cb43cd16fad9276e161017ae654eb9cc989081c7584f8f14a3795deb0e\n\n154186b5e0f5fae753a1f90c93a7150927bd03017e55f44abf21a5a08b7ec4ba\n\n38700a77355cdcc7804c53fa95072cd44835ac775fb6d16f8bd345e8ab13d353\n\n576560ada2906c22ca777ac51ed6f2b99086b94bbe44d86b82abe7d77736ba6a\n\n9419a0087f6fc8bccf318d7a2c9f9e709c81df651ab6ba65c10f28c4a34257a7\n\ncd6ad1e880396edc3cdcceba996dd424e96f4961e4884aee52717069537553e8\n\n33e8b5ea7a0900f2d4b56369fda2d29a06a586ddc0c9fd85fc17ea967f83f45d\n\n1af5f9b2b22282891adb17fb9283b47b7ba7a9439fef22cfba0320155dff3ae9\n\nDomains physiciansofficenews[.]com\n\nthechinastyle[.]com\n\ndivorceradio[.]com\n\n\n-----\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-23 - New JSSLoader Trojan Delivered Through XLL Files.pdf"
    ],
    "report_names": [
        "2022-03-23 - New JSSLoader Trojan Delivered Through XLL Files.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535885,
    "ts_updated_at": 1743041747,
    "ts_creation_date": 1653692160,
    "ts_modification_date": 1653692160,
    "files": {
        "pdf": "https://archive.orkl.eu/7179be20ccd05bac5d29b6bdbcbe9c6c6db65aca.pdf",
        "text": "https://archive.orkl.eu/7179be20ccd05bac5d29b6bdbcbe9c6c6db65aca.txt",
        "img": "https://archive.orkl.eu/7179be20ccd05bac5d29b6bdbcbe9c6c6db65aca.jpg"
    }
}