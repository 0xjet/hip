{
    "id": "f340dc71-1db6-4728-9e5f-ba45e10df0a6",
    "created_at": "2022-10-25T16:48:19.906879Z",
    "updated_at": "2025-03-27T02:13:29.113705Z",
    "deleted_at": null,
    "sha1_hash": "c3cd4cdd06ff5b16a71e70b7553ccf9f8e6b7398",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-04-10T13:20:09Z",
    "file_modification_date": "2019-04-10T13:20:09Z",
    "file_size": 108113,
    "plain_text": "# Project TajMahal – a sophisticated new APT framework\n\n**securelist.com/project-tajmahal/90240**\n\nBy AMR\n\n## Executive summary\n\n‘TajMahal’ is a previously unknown and technically sophisticated APT framework discovered by Kaspersky\nLab in the autumn of 2018. This full-blown spying framework consists of two packages named ‘Tokyo’ and\n‘Yokohama’. It includes backdoors, loaders, orchestrators, C2 communicators, audio recorders, keyloggers,\nscreen and webcam grabbers, documents and cryptography key stealers, and even its own file indexer for\nthe victim’s machine. We discovered up to 80 malicious modules stored in its encrypted Virtual File System,\none of the highest numbers of plugins we’ve ever seen for an APT toolset.\n\nJust to highlight its capabilities, TajMahal is able to steal data from a CD burnt by a victim as well as from\nthe printer queue. It can also request to steal a particular file from a previously seen USB stick; next time\nthe USB is connected to the computer, the file will be stolen.\n\nTajMahal has been developed and used for at least the past five years. The first known ‘legit’ sample\ntimestamp is from August 2013, and the last one is from April 2018. The first confirmed date when TajMahal\nsamples were seen on a victim’s machine is August 2014.\n\nMore details about TajMahal are available to customers of the Kaspersky Intelligence Reporting service\n[(contact intelreports@kaspersky.com).](mailto:intelreports@kaspersky.com)\n\n## Technical details\n\nWe have discovered two different types of TajMahal packages, self-named Tokyo and Yokohama. The\ntargeted systems found by Kaspersky Lab were infected with both packages. This suggests that Tokyo was\nused as first stage infection, deploying the fully-functional Yokohama package on interesting victims, and\nthen left in for backup purposes. The packages share the same code base, we identified the following\ninteresting features:\n\nCapable of stealing documents sent to the printer queue.\nData gathered for victim recon includes the backup list for Apple mobile devices.\nTakes screenshots when recording VoiceIP app audio.\nSteals written CD images.\nCapable of stealing files previously seen on removable drives once they are available again.\nSteals Internet Explorer, Netscape Navigator, FireFox and RealNetworks cookies.\nIf deleted from Frontend file or related registry values, it will reappear after reboot with a new name\nand startup type.\n\n## Victims\n\nSo far we have detected a single victim based on our telemetry – a diplomatic entity from a country in\nCentral Asia.\n\n## Conclusion\n\n\n-----\n\nThe TajMahal framework is an intriguing discovery that s of great interest, not least for its high level of\ntechnical sophistication, which is beyond any doubt. The huge amount of plugins that implement a number\nof features is something we have never before seen in any other APT activity. For example, it has its own\nindexer, emergency C2s, is capable of stealing specific files from external drives when they become\navailable again, etc.\n\nThe question is, why go to all that trouble for just one victim? A likely hypothesis is that there are other\nvictims we haven’t found yet. This theory is reinforced by the fact that we couldn’t see how one of the files\nin the VFS was used by the malware, opening the door to the possibility of additional versions of the\nmalware that have yet to be detected.\n\nKaspersky Lab products detect the TajMahal APT samples as HEUR:Trojan.Multi.Chaperone.gen\n\n## Appendix I – Indicators of compromise\n\nA full set of IOCs and Yara rules is available to customers of Kaspersky Intelligence Reporting service –\n[contact intelreports@kaspersky.com](mailto:intelreports@kaspersky.com)\n\n**Domains and IPs**\n\n104.200.30.125\n\n50.56.240.153\n\nrahasn.webhop.org\n\nrahasn.akamake.net\n\nrahasn.homewealth.biz\n\n**File Hashes**\n\n22d142f11cf2a30ea4953e1fffb0fa7e\n\n2317d65da4639f4246de200650a70753\n\n27612cb03c89158225ca201721ea1aad\n\n412956675fbc3f8c51f438c1abc100eb\n\n490a140093b5870a47edc29f33542fd2\n\n51a7068640af42c3a7c1b94f1c11ab9d\n\n533340c54bd25256873b3dca34d7f74e\n\n684eca6b62d69ce899a3ec3bb04d0a5b\n\n69a19abf5ba56ee07cdd3425b07cf8bf\n\n\n-----\n\n6cfd131fef548fcd60fbcdb59317df8e\n\n72dc98449b45a7f1ccdef27d51e31e91\n\n7c733607a0932b1b9a9e27cd6ab55fe0\n\n7d5265e814843b24fcb3787768129040\n\n80c37e062aa4c94697f287352acf2e9d\n\n815f1f8a7bc1e6f94cb5c416e381a110\n\na43d3b31575846fa4c3992b4143a06da\n\n08e82dc7bae524884b7dc2134942aadb\n\n7bcd736a2394fc49f3e27b3987cce640\n\n57314359df11ffdf476f809671ec0275\n\nb72737b464e50aa3664321e8e001ff32\n\nce8ce92fb6565181572dce00d69c24f8\n\n5985087678414143d33ffc6e8863b887\n\n84730a6e426fbd3cf6b821c59674c8a0\n\nd5377dc1821c935302c065ad8432c0d2\n\nd8f1356bebda9e77f480a6a60eab36bb\n\n92f8e3f0f1f7cc49fad797a62a169acd\n\n9003cfaac523e94d5479dc6a10575e60\n\ndf91b86189adb0a11c47ce2405878fa1\n\ne17bd40f5b5005f4a0c61f9e79a9d8c2\n\nc1e7850da5604e081b9647b58248d7e8\n\n99828721ac1a0e32e4582c3f615d6e57\n\nf559c87b4a14a4be1bd84df6553aaf56\n\nb9c208ea8115232bfd9ec2c62f32d6b8\n\n\n-----\n\n061089d8cb0ca58e660ce2e433a689b3\n\n0e9afd3a870906ebf34a0b66d8b07435\n\n9c115e9a81d25f9d88e7aaa4313d9a8f\n\n520ee02668a1c7b7c262708e12b1ba6b\n\n7bfba2c69bed6b160261bdbf2b826401\n\n77a745b07d9c453650dd7f683b02b3ed\n\n3a771efb7ba2cd0df247ab570e1408b2\n\n0969b2b399a8d4cd2d751824d0d842b4\n\nfc53f2cd780cd3a01a4299b8445f8511\n\n4e39620afca6f60bb30e031ddc5a4330\n\nbfe3f6a79cad5b9c642bb56f8037c43b\n\n3dfebce4703f30eed713d795b90538b5\n\n9793afcea43110610757bd3b800de517\n\n36db24006e2b492cafb75f2663f241b2\n\n21feb6aa15e02bb0cddbd544605aabad\n\n21feb6aa15e02bb0cddbd544605aabad\n\n649ef1dd4a5411d3afcf108d57ff87af\n\n320b2f1d9551b5d1df4fb19bd9ab253a\n\n3d75c72144d873b3c1c4977fbafe9184\n\nb9cf4301b7b186a75e82a04e87b30fe4\n\nb4e67706103c3b8ee148394ebee3f268\n\n7bfbd72441e1f2ed48fbc0f33be00f24\n\ncdb303f61a47720c7a8c5086e6b2a743\n\n2a6f7ec77ab6bd4297e7b15ae06e2e61\n\n\n-----\n\n8403a28e0bffa9cc085e7b662d0d5412\n\n3ffd2915d285ad748202469d4a04e1f5\n\n04078ef95a70a04e95bda06cc7bec3fa\n\n235d427f94630575a4ea4bff180ecf5d\n\n8035a8a143765551ca7db4bc5efb5dfd\n\ncacaa3bf3b2801956318251db5e90f3c\n\n1aadf739782afcae6d1c3e4d1f315cbd\n\nc3e255888211d74cc6e3fb66b69bbffb\n\nd9e9f22988d43d73d79db6ee178d70a4\n\n16ab79fb2fd92db0b1f38bedb2f02ed8\n\n8da15a97eaf69ff7ee184fc446f19cf1\n\nffc7305cb24c1955f9625e525d58aeee\n\nc0e72eb4c9f897410c795c1b360090ef\n\n9ad6fa6fdedb2df8055b3d30bd6f64f1\n\n44619a88a6cff63523163c6a4cf375dd\n\na571660c9cf1696a2f4689b2007a12c7\n\n81229c1e272218eeda14892fa8425883\n\n0ac48cfa2ff8351365e99c1d26e082ad\n\n## Appendix II – Additional technical details\n\nThe following table provides the full list of files stored in the VFS with a short description describing what\nthe plugins do:\n\n**nn** **Name** **Short description**\n\n\n00\n\n01\n\n\ncs64.dll\n\ncs32.dll\n\n\nC2 communication and command processing. WatchPoints document stealer.\n\n\n-----\n\n02\n\n03\n\n04\n\n06\n\n07\n\n08\n\n\nli64.dll\n\nli32.dll\n\nad64.dll\n\nad32.dll\n\nle64.dll\n\nle32.dll\n\n\nLocalInfo. Collects a large amount of information, titled “TAJ MAHAL”\n\nAudioRecorder. Microphone, Voice IP applications.\n\nOpen source-based LAME mp3 encoder (“Mar 27 2014”) used by AudioRecorder plugins\n(adXX.dll).\n\n\n09 dd.m MP3 file is sent by AudioRecorder (adXX.dll) when cache is cleared.\n\n\n10\n\n11\n\n\nme64.dll\n\nme32.dll\n\n\nAudioRecorder for Windows Metro applications.\n\nInjects ma32.dll into “wwahost.exe” or “audacity.exe”.\n\n\n12 ma32.dll AudioRecorder for Windows COM.\n\nHooks IAudioClient, IAudioRenderClient, IMMDevice.\n\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n05\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n\nams_api64.dll\n\nams_api32.dll\n\nex64.dll\n\nex32.dll\n\nfe64.dll\n\nfe32.dll\n\npd64.dll\n\npd32.dll\n\nlibpng64.dll\n\nlibpng32.dll\n\nrs64.dll\n\nrs32.dll\n\nix32.dll\n\nix64.dll\n\nobj32.bin\n\nobj32.bin\n\nobj64.bin\n\nsc64.dll\n\nsc32.dll\n\nsg64.dll\n\nsg32.dll\n\n\nHandy wrapper around API of exXX.dll, pdXX.dll, sgXX.dll.\n\nOrchestrator. Update/install/uninstall, selects target processes and loads plugins.\n\nTemplate of “Yokohama” Frontend module; is used for reinstalling.\n\nProvides API to access configuration settings, working files, egress queue.\n\nOpen source “libpng” library version 1.5.8 (February 1, 2012). Used by Screenshoter plugin\n(ssXX.dll).\n\nReinstaller/Injector.\n\nLoadLibrary call template dll is used by Reinstaller/Injector plugin (rsXX.dll) for injecting\nLoadLibrary call into running processes.\n\nShellcode template is used by Reinstaller/Injector (rsXX.dll) and AudioRecorder4MetroApp\n(meXX.dll) for injecting into running processes. Both versions of “obj32.bin” are the same; it\nseems to be stored twice by mistake.\n\nUtility library. Provides API for cryptography, file, registry, memory management operations\nand so on.\n\nLibrary for managing egress queue (files and messages prepared to send to CC).\n\n\n-----\n\n33\n\n34\n\n35\n\n36\n\n37\n\n38\n\n\nst64.dll\n\nst32.dll\n\nzip64.dll\n\nzip32.dll\n\nzlib64.dll\n\nzlib32.dll\n\n\nSuicideWatcher. Watches uninstall time, checks time diff (local time vs internet time).\n\nOpen source “XZip/XUnzip” library by Info-Zip + Lucian Wischik + Hans Dietrich. Is used by\nIndexer (inXX.dll) and C2 communication (csXX.dll) plugins.\n\nOpen source “zlib” version 1.2.3 used by libpngXX.dll for compressing screenshots\n(ssXX.dll).\n\n\n39 il32.dll IM-Stealer. Steals conversation content from chat windows of instant messaging\napplications.\n\n\n40\n\n55\n\n41\n\n42\n\n43\n\n44\n\n46\n\n47\n\n48\n\n49\n\n50\n\n51\n\n52\n\n53\n\n56\n\n45\n\n54\n\n57\n\n58\n\n59\n\n60\n\n61\n\n62\n\n63\n\n64\n\n\nin32.dll\n\nin64.dll\n\nisys9core_64.dll\n\nisyspdf6_64.dll\n\nisyspdfl_64.dll\n\nisysdc_64.dll\n\nisys9.key\n\nisys.cwd\n\nisys.elx\n\nisys9_32.dll\n\nisys9core_32.dll\n\nisyspdf6_32.dll\n\nisyspdfl_32.dll\n\nisysdc_32.dll\n\nisys9_64.dll\n\nsqlite3_64.dll\n\nsqlite3_32.dll\n\ntn32.dll\n\ntn64.dll\n\nfreeimage_32.dll\n\nfreeimageplus_32.dll\n\nfreeimage_64.dll\n\nfreeimageplus_64.dll\n\nku64.dll\n\nku32.dll\n\n\nIndexer. Indexes files on victim drives, user profiles, removable drives.\n\nBuilt index files are zipped (by zipXX.dll) and put in send queue.\n\nProprietary “ISYS Search Software” components are used by Indexer plugin.\n\nLicensee_ID1 “Q5GXU H5W67 23B4W SCQFD 4G7HV 9GSLW”\n\nLicensee_ID2 “objectviewer.exe”\n\nOpen source “sqlite” library. Used by “ISYS Search”.\n\nThumbnailer. Makes and prepares to send thumbnails of found picture files.\n\nFreeImage open source library supports popular graphics image formats (ver 3.15.4 201210-27) (http://freeimage.sourceforge.net). Is used by Thumbnailer (tnXX.dll) plugin.\n\nKeylogger & clipboard monitor.\n\n\n-----\n\n65\n\n66\n\n67\n\n68\n\n69\n\n70\n\n71\n\n72\n\n73\n\n74\n\n75\n\n76\n\n\npm64.dll\n\npm32.dll\n\nrc64.dll\n\nrc32.dll\n\nrn64.dll\n\nrn32.dll\n\nss64.dll\n\nss32.dll\n\nvm32.dll\n\nvm64.dll\n\nwc64.dll\n\nwc32.dll\n\n\nSteals printed documents from spooler queue.\n\nThis is done by enabling the “KeepPrintedJobs” attribute for each configured printer stored\nin Windows Registry:\n\nkey: “SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print\\\\Printers”\n\nvalue: “Attributes”\n\nEgressSender. Sends files from output queue to C2.\n\nDaily “ClientRecon” (ComputerName, OS information, MacAddress, WirelessNetwork keys,\nconnected Apple devices, Apple mobile devices backups list, IE version, SecurityCenterIn‐\nfo (AV, Firewalls and AntiSpyware products), Hardware info, Installed soft including Metro\nApps, Users, Autoruns).\n\nCheck and send to C2 if something changed.\n\nScreenshoter. Periodic low resolution screenshots. High resolution screenshots of speci‐\nfied process windows and when recording VoiceIP application audio. See “ss_pr” &\n“ss_wt_nm” cfg vars.\n\nSteal documents from fixed and removable drives. Watch CDBurnArea and steals written\nCD images.\n\nPeriodically makes webcamera snapshots.\n\n\n77 default.cfg Default configuration settings file.\n\n78 runin.bin List of processes names and associated plugins should be run inside these processes.\n\n79 morph.dat Configuration file stores path of work folders and registry keys.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.04.10.Project_TajMahal/Project%20TajMahal.pdf"
    ],
    "report_names": [
        "Project TajMahal"
    ],
    "threat_actors": [
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041609,
    "ts_creation_date": 1554902409,
    "ts_modification_date": 1554902409,
    "files": {
        "pdf": "https://archive.orkl.eu/c3cd4cdd06ff5b16a71e70b7553ccf9f8e6b7398.pdf",
        "text": "https://archive.orkl.eu/c3cd4cdd06ff5b16a71e70b7553ccf9f8e6b7398.txt",
        "img": "https://archive.orkl.eu/c3cd4cdd06ff5b16a71e70b7553ccf9f8e6b7398.jpg"
    }
}