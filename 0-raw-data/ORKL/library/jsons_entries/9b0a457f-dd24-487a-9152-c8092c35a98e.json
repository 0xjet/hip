{
    "id": "9b0a457f-dd24-487a-9152-c8092c35a98e",
    "created_at": "2023-01-12T15:06:10.273974Z",
    "updated_at": "2025-03-27T02:14:34.157949Z",
    "deleted_at": null,
    "sha1_hash": "455204ed99cad95b3b73bd2542300bccb96f767d",
    "title": "2021-09-08 - TeamTNT with new campaign aka “Chimaera”",
    "authors": "",
    "file_creation_date": "2022-05-27T22:17:20Z",
    "file_modification_date": "2022-05-27T22:17:20Z",
    "file_size": 2544099,
    "plain_text": "# TeamTNT with new campaign aka “Chimaera”\n\n**[cybersecurity.att.com/blogs/labs-research/teamtnt-with-new-campaign-aka-chimaera](https://cybersecurity.att.com/blogs/labs-research/teamtnt-with-new-campaign-aka-chimaera)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nSeptember 8, 2021 | [Ofer Caspi](https://cybersecurity.att.com/blogs/author/ofer-caspi)\n\n## Executive summary\n\nAT&T Alien Labs™ has discovered a new campaign by threat group TeamTNT that is targeting multiple\noperating systems and applications. The campaign uses multiple shell/batch scripts, new open source tools,\na cryptocurrency miner, the TeamTNT IRC bot, and more.\n\nAlien Labs research indicates the command and control (C&C) server used in this newly discovered\ncampaign contains infection statistics that suggest TeamTNT has been running this campaign since July 25,\n2021, and that it is responsible for thousands of infections globally.\n\n## Key takeaways:\n\nTeamTNT is using new, open source tools to steal usernames and passwords from infected machines.\nThe group is targeting various operating systems including: Windows, different Linux distributions\nincluding Alpine (used for containers), AWS, Docker, and Kubernetes.\nThe campaign has been active for approximately one month and is responsible for thousands of\ninfections globally.\nAs of August 30, 2021, many malware samples still have zero antivirus (AV) detections and others\nhave low detection rates.\n\n## Background\n\n\n-----\n\nTeamTNT has been one of the most active threat groups since mid 2020. Their activity typically uses open\nsource tools for malicious activity. A partial list of imported tools contains:\n\nMasscan and port scanner to search for new infection candidates\n[libprocesshider for executing their bot directly from memory](https://github.com/gianlucaborello/libprocesshider)\n7z to decompress downloaded files\n[b374k shell which is a php web administrator that can be used to control infected systems](https://github.com/b374k/b374k)\nLazagne, an open-source tool for multiple web operating systems, which is used to collect stored\ncredentials from numerous applications\n\n[Several recent publications, such the one by TrendMicro, have described in detail TeamTNT campaigns,](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/teamtnt-activities-probed?utm_source=trendmicroresearch&utm_medium=smk&utm_campaign=0721_teamtnt)\n[including the tools and techniques they use. One of the most recent findings (June 4, 2021) came from Palo](https://unit42.paloaltonetworks.com/teamtnt-operations-cloud-environments/)\nAlto researchers who discovered the TeamTNT Chimaera repository. In July 2021, TeamTNT began running\nthe Chimaera campaign using new tools, and they began publishing infection statistics publicly on their\nwebsite for the first time (Figures 1, 2).\n\nAs of the publishing of this report, many of the samples analyzed by Alien Labs have zero or low detection\non [VirusTotal. However, defenders can be proactive in hardening their systems. For example, due to the](https://www.virustotal.com/gui/file/caeb6eb1ee40fc4ac1da020a9a7542cffe55d29339306f6adf2d1e20e638538a/detection)\nrecent, high profile attacks on Kubernetes — including those executed by TeamTNT — the National\nSecurity Agency (NSA) and the Cybersecurity and Infrastructure Security Agency (CISA)\n[published “Kubernetes Hardening Guidance” in August of this year. Defenders should reference this guide to](https://www.nsa.gov/Press-Room/News-Highlights/Article/Article/2716980/nsa-cisa-release-kubernetes-hardening-guidance/)\nunderstand how to better defend against attacks like those used by TeamTNT.\n\n\n-----\n\nFigure 1. TeamTNT C&C website showing infection statistics\n\n\n-----\n\nFigure 2. TeamTNT C&C website showing Chimaera campaign statistics\n\n## Analysis of components used in the “Chimaera” campaign\n\n### New credentials stealer (“Lazagne” component)\n\nThe malicious script starts its activity by modifying the bash history file. This hides any future commands\nexecuted from users using the “history” command on Linux.\n\nThe script then installs its dependencies (‘curl’, ‘bash’, ‘wget’, ‘pip’, ‘py3-pip’, ‘python3-pip’). As seen in figure\n3, supported operating systems include different Linux distributions, such as Alpine Linux which is typically\nused in containers.\n\n\n-----\n\nFigure 3. The first stage of the Lazagne component.\n\nOnce the malware is finished with its “pre-setup,” it downloads the second phase of the attack from its C&C,\nwhich includes another bash script (‘run.sh’) along with the Lazagne project, as seen in figure 4.\n\n\n-----\n\nFigure 4. Second stage of the Lazagne component (‘run.sh’).\n\nLazagne is an open-source project available for different operating systems (Windows, Linux, and MacOS).\nIts developer describes the Lazagne tool as an application that can be used to retrieve multiple passwords\nstored on a local machine. Due to its capabilities, the tool has been added as a post exploitation module to\nthe [pupy project.](https://github.com/n1nj4sec/pupy/)\n\nIt supports a wide range of programs, such as browsers (Chrome, Firefox, Opera, etc.), Sysadmin programs\n(such as CoreFTP, Putty, OpenSSH, etc. ), Wifi password, mail programs, databases, etc. The full list of\n[supported programs can be found on the Lazagne page on Github.](https://github.com/AlessandroZ/LaZagne)\n\nIn this phase two of the attack, the second malicious script executes the Lazagne tool, saves its output into\n“laZagne.out.txt,” and uploads it to the C&C using the curl command. At the end of the execution, the\nmalware deletes any file that has been downloaded.\n\n### Windows component – Set up a cryptocurrency miner\n\nFor Windows operating systems, the attackers use a malicious script that downloads all the tools required\nfor unpacking and executing the Xmrig miner. This includes the 7z tool for decompressing downloaded files\nand Nssm to add the miner as a service. (See figure 5.)\n\n\n-----\n\nFigure 5. Windows module\n\nThe malware will setup the miner and then the miner will persist it in the system in two ways: 1) by adding\nitself as a service if the malware gains admin privileges or 2) by adding the batch file to the startup folder.\n(See figure 6.)\n\nFigure 6. Windows module - persistence\n\n### Kubernetes root payload component\n\nThis component is mainly responsible for installing a cryptocurrency miner on infected devices, allowing the\nattacker to connect remotely to the system using SSH. (See figure 7)\n\n\n-----\n\nFigure 7. Kubernetes root payload\n\nThe malicious script uses the following steps to achieve its goal:\n\nDisabling or uninstalling security products on infected machines, such as Aegis Authenticator, quartz,\nand Alibaba services (AliSecGuard, AliYunDun, AliNet etc.). (Figures 8, 9)\nAdding the attacker’s RSA-key to the list of known SSH host (allowing the attacker to connect the\nmachine through SSH without the need of user/password in the system).\nInstalling missing required tools for crypto mining.\nModifying the host file.\nSetting up the XMRig crypto miner.\nAdding persistence for the XMR miner.\nRemoving itself.\n\n\n-----\n\nFigure 8. Stopping security services\n\nFigure 9. Decoded shell script\n\n### TeamTNT IRC bot\n\nAs [described previously this year by Lacework, TeamTNT includes ZiggyStartux in their IRC bot. Now, the](https://www.lacework.com/blog/teamtnt-builds-botnet-from-chinese-cloud-servers/)\nbot has extended its availability to “Unix Shell & Command Function” (See figure 10).\n\n\n-----\n\nFigure 10. IRC Bot available commands\n\n### TeamTNT AWS stealer\n\nSimilar to the other TeamTNT components, the AWS stealer (see figure 11) first installs missing\ndependencies. It then collects information from infected devices and stores the informaiton in a temporary\nfile “/var/tmp/TeamTNT_AWS_STEALER.txt”.\n\nFigure 11. AWS stealer\n\nThis information includes:\n\nAWS default region\nAWS access key Id\nAWS secret access key\nAWS session token\nAWS user credentials\nAWS root credentials\nShared credentials file\nContainer credential relative URI\n\nWhen finished, the malware uploads all of the stored information to its C&C using curl command, and then it\ncleans up its traces.\n\n## Conclusion\n\nAT&T Alien Labs has discovered new malicious files distributed by the threat actor TeamTNT. As researches\nhave observed of TeamTNT in older campaigns, they are focusing on stealing cloud systems credentials,\nusing infected systems for cryptocurrency mining, and abusing victim’s machines to search and spread to\nother vulnerable systems. The use of open-source tools like Lazagne allows TeamTNT to stay below the\nradar for a while, making it more difficult for anti-virus companies to detect.\n\n## Recommended actions\n\n1. Keep your software with the latest security updates.\n2. Keep minimal exposure to the Internet on Linux servers and IoT devices and use a properly configured\n\nfirewall.\n3. Monitor network traffic, outbound port scans, and unreasonable bandwidth usage.\n\n\n-----\n\n### Detection methods\n\nThe following associated detection methods are in use by Alien Labs. They can be used by readers to tune\nor deploy detections in their own environments or for aiding additional research.\n\nSURICATA IDS SIGNATURES\n\nAV TROJAN TeamTNT AWS Credential Exfiltration\n\nAV TROJAN TeamTNT CnC Beacon\n\nAV TROJAN TeamTNT CoinMiner Payload Download to clean up other Coinminers\n\nAV TROJAN TeamTNT Mining Worm Credential Exfiltration\n\nAV TROJAN TeamTNT CoinMiner Downloader\n\nAV TROJAN TeamTNT IRC Bot Joining Channel\n\nET TROJAN Observed TrojanSpy.SH.HADGLIDER.A Exfil Domain in DNS Query\n\nTDR / MTDR CORRELATION RULES\n\nCrypto mining Docker container\n\n## Appendix B. Associated indicators (IOCs)\n\nThe following technical indicators are associated with the reported intelligence. A list of indicators is also\n[available in the OTX Pulse. Please note, the pulse may include other activities related but out of the scope](https://otx.alienvault.com/pulse/612cee5478a71671876c27c8)\nof the report.\n\nTYPE INDICATOR DESCRIPTION\n\nDOMAIN chimaera[.]cc C&C\n\n\nIP\nAddress\n\n\n85.214.149[.]236 C&C\n\n\nSHA256 caeb6eb1ee40fc4ac1da020a9a7542cffe55d29339306f6adf2d1e20e638538a Credentials\nstealer,\nLazagne\ncomponent\n\n\n-----\n\nSHA256 220737c1ee400061e886eab23471f98dba38fa8e0098a018ea75d479dceece05 Malware hash\n\nSHA256 b6f0203ddf24cd04489cbbed24059d84504a2ba904659681ad05b7d2c130d4b5 TeamTNT IRC\nbot\n\nSHA256 fa9b38a2bd1acfd6b1b24af27cb82ea5620502d7e9cb8a913dceb897f2bcf87c SSH lan spread\n\nSHA256 721d15556bd3c22f3b4c6240ff9c6d58bfa60b73b3793fa8cdc64b9e89521c5b Malware hash\n\nSHA256 95809d96f85e1571a3120c7c09a7f34fa84cb5902ad5172398dc2bb0ff1dd24a TeamTNT IRC\nbot\n\nSHA256 0ae5c1ddf91f8d5e64d58eb5395bf2216cc86d462255868e98cfb70a5a21813f Kubernetes root\nPayLoad\n\nSHA256 f82ea98d1dc5d14817c80937b91b381e9cd29d82367a2dfbde60cfb073ea4316 Kubernetes root\nPayLoad\n\nSHA256 2d85b47cdb87a81d5fbac6000b8ee89daa1d8a3c8fbb5d2bce7a840dd348ff1d Kubernetes\nsetup script\n\nSHA256 a4000315471cf197c0552aeec0e7afbe0a935b86ff9afe5b1443812d3f7185fa Malware hash\n\nSHA256 af2cf9af17f6db338ba3079b312f182593bad19fab9075a77698f162ce127758 AWS stealer\n\nSHA256 1b72088fc6d780da95465f80ab26ba094d89232ff30a41b1b0113c355cfffa57 Malware hash\n\nSHA256 3cc54142b5f88d03fb0552a655e32e94f366c9e3bb387404c6f381cfea506867 SSH lan spread\n\nSHA256 a46c870d1667a3ee31d2ba8969c9024bdb521ae8aad2079b672ce8416d85e8df TeamTNT IRC\nbot\n\nSHA256 7bb1bd97dc93f0acf22eff6a5cbd9be685d18c8dbc982a24219928159c916c69 Windows\ncomponent\n(Cryptocurrency\nminer setup)\n\n## Appendix C. Mapped to MITRE ATT&CK\n\n[The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques:](https://attack.mitre.org/)\n\nTA0001: Initial Access\n\nT1078: Valid accounts\n\n\n-----\n\nTA0002: Execution\n\nT1569: System Services\nT1059: Command and Scripting Interpreter\n\nT1059.004: Unix Shell\nT1059.003: Windows Command Shell\nTA0003: Persistence\n\nT1547: Boot or Logon Autostart Execution\nT1053: Scheduled Task/Job\nTA0005: Defense Evasion\n\nT1564: Hide Artifacts\nTA0006: Credential Access\n\nT1212: Exploitation for Credential Access\nT1528: Steal Application Access Token\nT1555: Credentials from Password Stores\nTA0008: Lateral Movement\n\nT1210: Exploitation of Remote Services\nTA0010: Exfiltration\n\nT1041: Exfiltration Over C2 Channel\n\nT1020: Automated Exfiltration\nTA0011: Command and Control\n\nT1219: Remote Access Software\nTA0040: Impact\n\nT1496: Resource Hijacking\n\n## Appendix D. Reporting context\n\n[Alien Labs rates sources based on the Intelligence source and information reliability rating system to assess](https://www.first.org/global/sigs/cti/curriculum/source-evaluation)\nthe reliability of the source and the assessed level of confidence we place on the information distributed.\nThe following chart contains the range of possibilities, and the selection applied to this report can be found\non Page 1.\n\n### Source Reliability\n\nRATING DESCRIPTION\n\nA - Reliable No doubt about the source's authenticity, trustworthiness, or competency. History of\ncomplete reliability.\n\n\nB - Usually\nReliable\n\n\nMinor doubts. History of mostly valid information.\n\n\nC - Fairly Reliable Doubts. Provided valid information in the past.\n\n\nD - Not Usually\nReliable\n\n\nSignificant doubts. Provided valid information in the past.\n\n\n-----\n\nE - Unreliable Lacks authenticity, trustworthiness, and competency. History of invalid information.\n\n\nF - Reliability\nUnknown\n\n\nInsufficient information to evaluate reliability. May or may not be reliable.\n\n\n### Information Reliability\n\nRATING DESCRIPTION\n\n1 - Confirmed Logical, consistent with other relevant information, confirmed by independent\nsources.\n\n2 - Probably True Logical, consistent with other relevant information, not confirmed.\n\n3 - Possibly True Reasonably logical, agrees with some relevant information, not confirmed.\n\n4 - Doubtfully True Not logical but possible, no other information on the subject, not confirmed.\n\n5 - Improbable Not logical, contradicted by other relevant information.\n\n\n6 - Cannot be\njudged\n\n\nThe validity of the information can not be determined.\n\n\n### Share this with others\n\nTags: [malware,](https://cybersecurity.att.com/blogs/tag/malware) [alien labs,](https://cybersecurity.att.com/blogs/tag/alien+labs) [teamtnt,](https://cybersecurity.att.com/blogs/tag/teamtnt) [chimaera](https://cybersecurity.att.com/blogs/tag/chimaera)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-08 - TeamTNT with new campaign aka “Chimaera”.pdf"
    ],
    "report_names": [
        "2021-09-08 - TeamTNT with new campaign aka “Chimaera”.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535970,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653689840,
    "ts_modification_date": 1653689840,
    "files": {
        "pdf": "https://archive.orkl.eu/455204ed99cad95b3b73bd2542300bccb96f767d.pdf",
        "text": "https://archive.orkl.eu/455204ed99cad95b3b73bd2542300bccb96f767d.txt",
        "img": "https://archive.orkl.eu/455204ed99cad95b3b73bd2542300bccb96f767d.jpg"
    }
}