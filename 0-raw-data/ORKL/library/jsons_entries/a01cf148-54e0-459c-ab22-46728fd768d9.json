{
    "id": "a01cf148-54e0-459c-ab22-46728fd768d9",
    "created_at": "2023-01-12T15:07:23.988275Z",
    "updated_at": "2025-03-27T02:06:07.562655Z",
    "deleted_at": null,
    "sha1_hash": "2d02c4954c92c0ff57cd2a9ccbd5327c41187cf7",
    "title": "2016-09-07 - The Missing Piece – Sophisticated OS X Backdoor Discovered",
    "authors": "",
    "file_creation_date": "2022-05-28T17:08:57Z",
    "file_modification_date": "2022-05-28T17:08:57Z",
    "file_size": 1051826,
    "plain_text": "# The Missing Piece – Sophisticated OS X Backdoor Discovered\n\n**[securelist.com/blog/research/75990/the-missing-piece-sophisticated-os-x-backdoor-discovered/](https://securelist.com/blog/research/75990/the-missing-piece-sophisticated-os-x-backdoor-discovered/)**\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n[Malware descriptions](https://securelist.com/category/malware-descriptions/)\n\n07 Sep 2016\n\nminute read\n\n\n-----\n\nAuthors\n\n## In a nutshell\n\n\nStefan Ortloff\n\n\nBackdoor.OSX.Mokes.a is the most recently discovered OS X variant of a crossplatform backdoor which is able to operate on all major operating systems\n(Windows,Linux,OS X). Please see also our analysis on the Windows and Linux\nvariants.\nThis malware family is able to steal various types of data from the victim’s machine\n(Screenshots, Audio-/Video-Captures, Office-Documents, Keystrokes)\nThe backdoor is also able to execute arbitrary commands on the victim’s computer\nTo communicate it’s using strong AES-256-CBC encryption\n\n## Background\n\nBack in January this year we found a new family of cross-platform backdoors for desktop\nenvironments. After the discovery of the binaries for Linux and Windows systems, we have\nnow finally come across the OS X version of Mokes.A. It is written in C++ using Qt, a crossplatform application framework, and is statically linked to OpenSSL. This leads to a filesize of\napprox. 14MB. Let’s have a look into this very fresh sample.\n\n## “Unpacked” Backdoor.OSX.Mokes.a\n\n\n-----\n\nIts filename was unpacked when we got our hands on it, but we re assuming that in-thewild it comes packed, just like its Linux variant.\n\n### Startup\n\nWhen executed for the first time, the malware copies itself to the first available of the\nfollowing locations, in this order:\n\n$HOME/Library/App Store/storeuserd\n$HOME/Library/com.apple.spotlight/SpotlightHelper\n$HOME/Library/Dock/com.apple.dock.cache\n$HOME/Library/Skype/SkypeHelper\n$HOME/Library/Dropbox/DropboxCache\n$HOME/Library/Google/Chrome/nacld\n$HOME/Library/Firefox/Profiles/profiled\n\nCorresponding to that location, it creates a plist-file to achieve persistence on the system:\n\nAfter that it’s time to establish a first connection with its C&C server using HTTP on TCP port\n80:\n\n\n-----\n\nThe User-Agent string is hardcoded in the binary and the server replies to this “heartbeat”\nrequest with “text/html” content of 208 bytes in length. Then the binary establishes an\nencrypted connection on TCP port 443 using the AES-256-CBC algorithm.\n\n### Backdoor functionality\n\nIts next task is to setup the backdoor features:\n\n**Capturing Audio**\n\n\n-----\n\n**Monitoring Removable Storage**\n\n**Capturing Screen (every 30 sec.)**\n\n**Scanning the file system for Office documents (xls, xlsx, doc, docx)**\n\nThe attacker controlling the C&C server is also able to define own file filters to enhance the\nmonitoring of the file system as well as executing arbitrary commands on the system.\n\n\n-----\n\nJust like on other platforms, the malware creates several temporary files containing the\ncollected data if the C&C server is not available.\n\n$TMPDIR/ss0-DDMMyy-HHmmss-nnn.sst (Screenshots)\n$TMPDIR/aa0-DDMMyy-HHmmss-nnn.aat (Audiocaptures)\n$TMPDIR/kk0-DDMMyy-HHmmss-nnn.kkt (Keylogs)\n$TMPDIR/dd0-DDMMyy-HHmmss-nnn.ddt (Arbitrary Data)\n\nDDMMyy = date: 070916 = 2016-09-07\nHHmmss = time: 154411 = 15:44:11\nnnn = milliseconds\n\nIf the environment variable $TMPDIR is not defined, “/tmp/” is used as the location\n[(http://doc.qt.io/qt-4.8/qdir.html#tempPath).](http://doc.qt.io/qt-4.8/qdir.html#tempPath)\n\n### Hints from the author\n\nThe author of this malware again left some references to the corresponding source files:\n\n### Detection\n\nWe detect this type of malware as HEUR:Backdoor.OSX.Mokes.a\n\n## IOCs\n\n**Hash:**\n\n664e0a048f61a76145b55d1f1a5714606953d69edccec5228017eb546049dc8c\n\n\n-----\n\n**Files:**\n$HOME/LibraryApp Store/storeuserd\n$HOME/Library/com.apple.spotlight/SpotlightHelper\n$HOME/Library/Dock/com.apple.dock.cache\n$HOME/Library/Skype/SkypeHelper\n$HOME/Library/Dropbox/DropboxCache\n$HOME/Library/Google/Chrome/nacld\n$HOME/Library/Firefox/Profiles/profiled\n$HOME/Library/LaunchAgents/$filename.plist\n$TMPDIR/ss*-$date-$time-$ms.sst\n$TMPDIR/aa*-$date-$time-$ms.aat\n$TMPDIR/kk*-$date-$time-$ms.kkt\n$TMPDIR/dd*-$date-$time-$ms.ddt\n\n**Hosts:**\n158.69.241[.]141\njikenick12and67[.]com\ncameforcameand33212[.]com\n\n**User-Agent:**\nMozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like\nGecko) Version/7.0.3 Safari/7046A194A\n\n[Apple MacOS](https://securelist.com/tag/apple-macos/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Linux](https://securelist.com/tag/linux/)\n[Microsoft Windows](https://securelist.com/tag/microsoft-windows/)\n[Non-Windows Malware](https://securelist.com/tag/non-windows-malware/)\n\nAuthors\n\nStefan Ortloff\n\nThe Missing Piece – Sophisticated OS X Backdoor Discovered\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\nFrom the same authors\n\n\n-----\n\n### New wave of Mirai attacking home routers\n\n Beware of Backdoored Linux Mint ISOs\n\n\n-----\n\n### From Linux to Windows – New Family of Cross-Platform Desktop Backdoors Discovered\n\n Shellshock and its early adopters\n\n Spammy Facebook friends from the neighborhood\n\n\n-----\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-09-07 - The Missing Piece – Sophisticated OS X Backdoor Discovered.pdf"
    ],
    "report_names": [
        "2016-09-07 - The Missing Piece – Sophisticated OS X Backdoor Discovered.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536043,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653757737,
    "ts_modification_date": 1653757737,
    "files": {
        "pdf": "https://archive.orkl.eu/2d02c4954c92c0ff57cd2a9ccbd5327c41187cf7.pdf",
        "text": "https://archive.orkl.eu/2d02c4954c92c0ff57cd2a9ccbd5327c41187cf7.txt",
        "img": "https://archive.orkl.eu/2d02c4954c92c0ff57cd2a9ccbd5327c41187cf7.jpg"
    }
}